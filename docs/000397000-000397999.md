# StackOverflow 问答 000397000-000397999

# svn - 提交更多文件作为预提交挂钩是否安全？

> ID：397001
> 
> 赞同：1
> 
> 时间：2008-12-29T02:23:07.467
> 
> 标签：svn

当我们在 Subversion 中将文件从一个分支复制到另一个分支时，我想自动提交数据库。`svn commmit`假设我们在非常特定的情况下使用它作为预提交钩子的一部分是否安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T03:48:18.543

即使它是安全的，它也可能不会产生您期望的效果。

当您进行预提交时，新事务已经创建，但尚未提交。您可以访问该信息来完成您的工作，但额外的信息`svn commit`会创建一个尚未提交的单独事务。

该新交易不会看到您当前交易中的任何更改，因为它尚未最终确定。

您可能需要运行一些自定义脚本来为您执行此操作，可能是您构建系统的一部分。

此外，您需要一个工作副本来提交，您没有`pre-commit`在服务器上运行挂钩的地方。您也许可以用共享的工作副本拼凑一些东西，并希望没有两个人会导致`pre-commit`挂钩同时运行，但同样，您可能最好使用自定义脚本解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T03:26:54.093

提交本身在 SVN 中是安全的。如果您在提交时您的版本已过时，则该操作将被拒绝。当然，在 SVN 中提交二进制文件使您无法进行一些基于 svn 的冲突解决，这很可悲...

你应该担心的是svn update。您说您想将数据库存储在 SVN 中。当用户使用他们的数据文件时，我不知道 MySQL、Oracle 和 MS-SQL 都不喜欢它......你可以这样做，但数据库配置文件也应该存储在 SVN 中。也许还有日志。当然 - 当您执行更新时，RDBMS 不应该运行。相当大惊小怪，不是吗？

您还可以使用 SVN 命令锁定文件以禁止其他用户修改。

考虑到这一切——也许还有比将二进制数据库文件存储在面向文本的版本控制系统中更适合您的解决方案？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T03:03:00.523

这听起来像是一个可疑的提议 - 无论您使用哪种 VCS（版本控制系统）。与以往一样，详细地说，“这取决于”。

第一个问题是“提交数据库”是什么意思？大概，您正在考虑存储在单个文件中的数据库，并且您会将文件作为二进制数据块进行简单的提交。这假设没有其他人在使用数据库。主 DBMS 提供了一些工具来确保数据库的一致备份，即使它当时正在使用中。如果您的 DBMS 有一个服务器正在运行，那么如果您悄悄地让 VCS 进行签入，它可能会变得相当不高兴。典型的 VCS 将删除当前提取的文件并将其替换为新版本（例如，如果其中有要扩展的关键字）。您必须确保没有在 DBMS 文件中扩展关键字。当数据库增长并占用多个空间时会发生什么？

我更倾向于确保有数据库的备份，然后进行版本控制。但这在很大程度上取决于您的 DBMS 以备份设施（和恢复设施——我假设目的是能够在需要时恢复数据库）的方式提供什么。

最后，对于大多数系统来说，数据库的内容并不是特别重要；至关重要的往往是数据的架构——表、列、索引、约束、存储过程、视图、权限……实际的数据行通常意义不大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T04:02:25.893

即使它是安全的，听起来也会让你的用户感到困惑。他们要求 X 承诺，X+Y 承诺。对于不知道发生了什么的人来说，这是一个秘诀。特别是当您尝试添加新的团队成员时。

我还想指出，即使这工作正常，对我来说这听起来像是 VCS 操作的边缘条件。多年来，我学会了不要在没有充分理由的情况下将我的工具推向边缘。边缘条件是错误容易出现的地方，我担心将来可能会发生一些变化以打破这种情况。

# time-management - 学习编程最大的浪费时间是什么？

> ID：397002
> 
> 赞同：22
> 
> 时间：2008-12-29T02:23:34.270
> 
> 标签：time-management

过去，我在自学编程方面有过几次错误的开端。我已经阅读了几本书（主要是 C 和 Python），最后只是学习了语法，却没有觉得我可以坐下来真正为自己编写一个程序。当我尝试在 Codeplex 或 Sourceforge 上查看项目的源代码树时，我似乎永远不知道从哪里开始阅读代码——依赖关系似乎是四面八方的。

我觉得好像我没有像“在街上”那样学习编程，所以我想我会采取不同的方法来询问新手应该如何学习如何编码。如果您必须重新学习编程，您*不会*做哪些事情？你花时间做什么，你现在知道浪费了你数周或数月？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-29T02:35:23.167

我看到初学者浪费数周或数月的时间是**在键盘上打字**。计算机的响应速度非常快，并且会在编辑-编译-运行周期中愉快**地消耗您数小时的时间。**如果您正在学习，您将节省很多时间

*   在您**使用计算机之前，您可以在纸上计划好您的设计**。无论您选择哪种设计方法，或者您从未听说过一种设计方法，都没有关系。**只需在您的大脑全神贯注且不受计算机干扰的情况**下写下一个计划。

*   当代码无法编译或无法产生正确答案时，如果您无法在五分钟内修复它，请**远离计算机**。去想想发生了什么。 **打印出您的代码并在上面乱涂乱画，**直到您相信它是正确的。

这些只是帮助实现在**编写代码之前要考虑**的简单但困难的旧建议的工具。

我在学习的时候，**从计算中心**到我家步行 15 分钟，解决了无数问题。可悲的是，对于现代 PC，我们没有 15 分钟 :-) 如果你无论如何都能学会接受它，你将成为一个更好的程序员，更快。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-29T02:38:28.827

我当然不会从查看“真正的”软件项目开始。就像你说的，很难知道从哪里开始。这在很大程度上是因为大型项目更多的是关于它们的大规模设计，而不是关于单个算法或程序流程。一方面，您可能正在查看具有多线程等的复杂 GUI 应用程序。实际上没有任何地方可以“开始”查看代码。

学习编程的最好方法是有一个你想要（需要）解决的问题，然后去解决它。但最重要的是，编写代码。当你阅读编程书籍时，做所有的练习。确保你做对了。没有什么可以替代编写代码。不能代替拧紧然后修复它。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-12-29T03:51:01.253

Stack Over F.. wait no, heh.

The biggest time-sinks for me are generally in respect to "**finding the best answer**." I often find that I will run into a problem that I know how to solve but feel that there is a better solution and go on the hunt for it. It is only hours/days later that I come to my senses and realize that I have 7 instances of Firefox, each containing at least 5 tabs sprawled out across 46" of monitor space that I realize that I've been caught in the black hole that is the pursuit of endless knowledge.

My advice to you, and myself for that matter, is to become comfortable with notion of *refractoring*. Essentially what this means (incase you are are not familiar with the term) is you come up with a solution for a problem and go with it, even if there is quite likely a better way of doing it. Once you have finished the problem, or even the program, you can then revisit your methodology, study it, and figure out where you can make changes to improve it.

This concept has always been hard for me to follow. In college I preferred to to write a paper once, print, and turn it in. Writing code can be thought of very similarly to writing a paper. Simply putting the pen to the pad and pushing out whats on your mind may work - but when you look back over it with a fresh pair of eyes you will, without question, see something you will wish you had done differently.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-12-29T02:38:58.013

我刚刚注意到您谈到阅读其他人项目的源代码树。 **阅读别人的代码是个好主意**，但你必须**更有选择性地阅读**。很多开源代码很难阅读，也不是你应该模仿的东西。因此，**请避免阅读您尊敬的程序员未推荐的任何代码**。

提示：Jon Bentley、Brian Kernighan、Rob Pike 和 PJ Plauger，他们都是我尊敬的程序员，*发表*了很多值得一读的代码。在书中。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-29T02:30:28.700

学习如何编程的唯一方法是编写更多代码。阅读书籍很棒，但编写/修复代码是最好的学习方式。不做就学不到任何东西。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-29T02:37:20.480

您可能还想看看[这本书，*如何设计程序*](http://www.htdp.org/)，以获得更多关于设计的观点而不是语法细节。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-29T02:41:18.820

我所做的唯一浪费了数周或数月的事情就是担心我的设计是否是实施特定解决方案的最佳方式。我现在知道这被称为“过早的优化”，我们都在某种程度上受到了它的影响。学习编程的正确方法是解决一个问题，衡量你的解决方案以确保它表现得足够好，然后继续研究下一个问题。一段时间后你会遇到一堆你已经解决的问题，但更重要的是，你会了解一门编程语言。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-29T04:10:16.033

这里有很好的建议，在其他帖子中。以下是我的想法：

1) 学习打字，原因在Steve Yegge的[这篇文章中解释过。](http://steve-yegge.blogspot.com/2008/09/programmings-dirtiest-little-secret.html)这将比你想象的更有帮助。

2）阅读代码通常被认为是一项艰巨的任务。因此，最好是获得一个开源项目，编译它，然后开始更改它并以这种方式学习，而不是阅读和尝试理解。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-29T04:45:50.860

我能理解你的情况。通读书籍，即使很多也不会让你成为程序员。您需要做的是开始编程。

在我看来，实际上编程很像游泳，即使你只知道一点语法和更少的编码技术，无论如何都要开始编码。制作一个小型应用程序、一个家庭清单、一个费用目录、一个日期表、一个 CD 编目器，任何你喜欢的东西。

我们的想法是深入了解它的本质。一旦你开始编程，你就会遇到现实世界的问题，你解决问题的能力会随着你与这些问题的斗争而发展。这就是你每天如何成为更好的程序员的方式。

所以进入它的深处，然后直接游过去......这就是你成功的方式。

祝你好运

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-29T04:46:45.913

我认为这个问题对于不同的人会有截然不同的答案。

对于我自己，我曾经尝试过 C++（我大约 10 岁，并且已经编程了一段时间），使用的是单击和拖动 UI 构建器。我认为这是一个错误，我应该直接使用 C 和指针等。因为我就是这样的人。

在你的情况下，听起来你想被某人引导到正确的道路上，并且对自己跳进去做某事感到有点胆怯。（你已经读了几本书，现在你在问什么*不该*做。）

我会告诉你我是怎么学到的：通过做很多有趣的、相对较短的项目，难度稳步增长。我从 QBasic 开始（我认为它仍然是一个很棒的学习工具），在那里我开发了我的大部分编程技能。从那时起，它们当然得到了扩展和改进，但在那些日子里，我已经能够进行良好的设计。

您可以从事的项目类型取决于您的兴趣；如果您有数学倾向，您可能想尝试使用素数生成器或将 3D 点投影到屏幕上；如果您对游戏设计感兴趣，那么您可以尝试克隆 pong（简单）或扫雷（更难）；或者，如果您更喜欢黑客，您可能想要制作一个简单的聊天程序或文件加密软件。

自己做这些项目，不要担心你是否以“正确”的方式做事。只要你让它发挥作用，你就学到了很多东西。在你完成一个项目一段时间后，你可能想重新审视它并尝试把它做得更好，或者只是看看其他人是如何做到这一点的。

考虑到你似乎想要被引导的方式，也许你应该给自己找一个导师。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-29T02:55:49.460

不要学习如何使用指针以及如何手动管理内存。你提到了**C**，我花了很多时间试图修复由混合 *x 和 &x 引起的错误。这是邪恶的...

找到一些要解决的问题，写下或画出解决问题的算法的草图，然后试着写出来。要么使用**Python**（这对初学者更友好），要么只使用**C**和静态分配的内存。并使用书籍/教程。他们提供了多种带有解决方案的练习，因此您可以将自己的练习与他们进行比较并查看其他方法。

一旦您觉得您实际上可以编写一些简单的东西，请查看一些面向对象设计的书籍/教程。这不是世界上最好的，但它可能会变得很直观。如果不是，请检查函数式编程（如 LISP、Scheme 或 Haskell 语言）或逻辑编程（如 Prolog）。也许那些会更适合你。

还有——找个伴侣。一个你可以谈论编码、代码维护和设计的人。这样的人，比一本书还值钱。

*致所有 C 爱好者：* C 语言真的很棒。它允许将内存使用优化到 Python 或 Ruby 等高级语言中不可能实现的程度。编译的代码也非常快，是 RTOS 或现代 3D 游戏引擎的唯一选择。但这对初学者来说不是一个好的切入点，这就是我所相信的。

哦，祝你好运！不要羞于问！如果你不问，答案就更难找到了。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-29T04:32:48.627

假设您有不错的数学技能，请尝试[http://projecteuler.net/](http://projecteuler.net/)它提出了一系列需要解决的越来越难的问题，这些问题应该可以通过编写短程序来解决。这应该让您有解决特定问题的经验，而不会迷失在开源项目的细节中。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-29T03:03:23.143

I think you should stop thinking you've wasted time so far-- instead I think you're education is just incomplete, and you've taken a step you're not really ready for. It sounds like the books you've read are useful, you're learning the intricacies of the language. It sounds like you're just not accustomed to the tools you'd use then to package that code together so it runs. Some books cover that focus on topics like language syntax, design patterns, algorithms and data structures will never mention the tools you need to actual apply that information. These books are great but if its all you've touched I think it would explain your situation.

What development environment are you using? If you're developing for windows you really should be proficient with creating projects, adding code, running and debugging in Visual Studio. You can download Visual Studio Express for free from Microsoft.

I recommend looking for tutorial like books that actually step you through the UI of development environment you are using. Look for actual screenshots with dropdown menus. Look at what the tutorials walk you through, and if its something you don't know how to do consider buying that book. Preferably it will have code you can copy'n'paste in, not code you write yourself.

I personally don't like these books as I can anticipate how to do new things in VS based on how I'd do other things. But if you're training is incomplete from a tools-usage perspective this could move you in the right direction.

It is probably harder to find these types of tutorial books for Python or C development. There is an overabundance of them for .Net development though.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-29T02:30:38.280

在基本的语言语法之后，您需要学习设计。这很难。 [这本书](http://homepage.mac.com/s_lott/books/oodesign.html)可能会有所帮助。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-29T03:55:27.407

作为一个只做了 6 个月的程序员的人，我可能不是帮助你前进的最佳人选，但由于不久前我几乎一无所知，所以我的脑海里很新鲜。

当我开始我目前的工作时，编程不会成为我工作描述的一部分，但是当有机会做一些编程的时候，我不能放弃它。

[我花了大约 1 个月的时间在About.com 的 Delphi 部分](http://delphi.about.com/)做教程。尽管人们对 about.com 不屑一顾，但**Zarko Gajic 的**教程易于理解且易于遵循。一旦我掌握了语言和 IDE 的基本知识，我就直接进入了一个项目，该项目为一个名为“Adept”的程序导出会计数据。花了我一段时间，但我到了那里......

对我来说最大的帮助是进行个人项目。[我为一个名为Soldat](http://soldat.pl)的蹩脚 2D 游戏用 Java 开发了一个 IRC 机器人。通过规划和编写自己的项目，我学到了很多东西。

现在我对 Delphi Pascal、SQL、C# 和 Java 非常熟悉。我认为，一旦你掌握了一种 OOP 语言的窍门，你就可以学习另一种语言的语法，而且它会更容易掌握。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-29T06:52:53.523

也许从一个小的现有项目开始，并在其中找到一些东西来处理它所做的一些核心部分 - 然后使用调试器，逐步完成它并从你要求它为你做那件事的那一刻开始跟随它正在做的事情.

这可以通过多种方式帮助您。当代码尝试完成其请求时，您开始更好地掌握代码所涉及的所有各种事物。此外，您还学习了许多开发人员似乎缺乏的宝贵调试技术 - 虽然您通常可以通过重复 printf() （或等效）调用最终发现问题所在，但如果您可以调试，则可以解决一个数量级的问题快点。

我发现从概念上讲，抽象地理解编程的一个很好的心理模型是数据流模式。当用户操作数据时，它是如何被程序改变以进行消化和存储的？它是如何转变为以对他们有意义的形式重新呈现给用户的？从根本上说，代码是关于数据的转换，所有代码都可以分解为各种大小的结构，其目的是以一种或另一种方式改变数据，围绕程序员对数据的期望之间的不匹配形成错误，多高编码人员使用的库处理数据，以及数据实际到达的方式。使用调试器跟踪代码可以帮助您通过观察发生的变化来充分理解这种转换。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-29T13:40:52.217

您应该阅读 Mike clark 的文章：我是[如何学习 Ruby](http://clarkware.com/cgi/blosxom/2005/03/18)的。本质上，他使用 Ruby 的测试框架来测试语言的不同元素。

我使用这种技术来学习 python，它非常非常有帮助。我不仅学习了语言，而且在练习结束时我非常精通 Python 的测试框架。一旦你掌握了基础知识，你就可以开始阅读代码，然后着手构建一些更大的项目。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-29T02:27:13.107

标准答案是做某事；选择一种简单的语言来做这件事很好，但不是必需的。更多的是在你自己的脑海中解决问题，修复它，因为它不起作用，这真的教会了你。对我来说，当我尝试我从未完成但总是从中学习的永恒梦想项目（游戏）时，总是会发生这种情况。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-29T02:28:55.367

我认为我会避免的事情是在孤立的片段中学习一门语言，这些片段并没有真正联系在一起，而只是教授特定语言的各个方面。正如其他人所说，真正困难和重要的是学习设计。我认为最好的方法是通过一个教程来引导你创建一个实际的应用程序，并在此过程中教授设计。通过这种方式，您可以了解做出某些决定的原因，并了解如何完成实现设计选择所需的内容。

例如，我发现[使用 Rails 进行敏捷 Web 开发](http://www.pragprog.com/titles/rails2/agile-web-development-with-rails)是学习 Ruby on Rails 的一种非常简单的方法，比简单地阅读 Ruby 手册或什至在零散的网络教程中摸索要好得多。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-29T02:48:25.310

我要避免的另一件事是孤立地开发代码，也就是说，在我进行过程中不要让人们看到它。从导师那里获得反馈将帮助您在做出选择和正确使用语言习语方面保持正确的轨道。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-12-29T02:53:54.253

找到你生活中的一个问题，或者你觉得做的事情可能更有效率，然后写一个小解决方案。它可能只是一个脚本，但当您开始看到有用的工作成果时，您会对自己的能力更有信心。当您对使用该解决方案感兴趣时，您也会更有动力完成它。从简单的小项目开始，然后逐渐转向更大的项目。

当您从事一个小项目时，请专注于以质量构建一切。我认为有些程序员会忽略这一点，他们认为如果他们的软件包含大量功能，但通常这些功能做得不好或不可用，他们的软件会更令人印象深刻。如果您专注于为实际问题构建高质量的解决方案，您将成为一名出色的程序员。

祝你好运！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-12-29T03:01:18.437

处理您已经知道如何部分解决的项目/问题

# c# - 非常简单的代码中的类、结构或接口成员声明中的标记“while”无效

> ID：397019
> 
> 赞同：8
> 
> 时间：2008-12-29T02:38:20.103
> 
> 标签：c#, loops, while-loop

我不确定问题出在哪里，但是当我尝试在代码中使用 while 语句时，我不断收到此错误。

> 类、结构或接口成员声明中的标记“while”无效

我想使用 while 循环在语句为真时不断更新某些内容。

我的其余代码相当长，但每当我输入语法时：

```
while(a<b)
{
//do whatever i want it to do here
} 
```

它立即给了我编译器错误。不太确定是什么问题。我在 Form1.cs 文件下的 C# windows 应用程序中执行此操作，并带有所有其他事件处理程序（用于按钮等）。谢谢！

* * *

我不知道必须将循环放在一个方法中（对 c# 来说是相当新的），但我尝试了它并没有返回任何错误。谢谢大家的帮助！

以前，我只是在程序的主类中有循环。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-29T02:40:31.317

基于该错误，听起来编译器认为此代码是直接在类/结构/接口声明的主体中键入的。语句 while/if/for/etc ... 必须出现在方法中。

尝试将此代码移动到解决问题的方法中。如果它在一个方法中，你可能有一个不匹配的括号问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T02:39:55.437

这段时间没有什么问题，问题在于它上面的东西。检查评论或类似内容中是否存在不匹配的大括号和分号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-22T08:47:38.010

C# 不允许将代码直接写入类；只允许将数据成员和函数成员直接写入类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-05T14:52:32.867

如果你有标点符号问题，你也可以得到这个，我今天在我错过了一个简单的括号时得到了它：

```
public static string GetPasswordForEnvironment) 
```

本来应该：

```
public static string GetPasswordForEnvironment() 
```

但是错误出现在函数后面的第一个“if”语句中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-12T18:40:08.850

C# 不提供直接在类中编写 for、while 或 foreach 类型的循环语句。这些语句应该在用户定义的方法、主方法或构造函数中。

```
 class Array
{
    public static void main(string[] args)
    {
        int[] n = new int[10]; /* n is an array of 10 integers */

        /* initialize elements of array n */
        for (int i = 0; i < 10; i++)
        {
            n[i] = i + 100;
        }

        /* output each array element's value */
        foreach (int j in n)
        {
            int i = j - 100;
            Console.WriteLine("Element[{0}] = {1}", i, j);
        }
    }

} 
```

# c# - SQL Server 中多态树的数据架构和查询

> ID：397031
> 
> 赞同：3
> 
> 时间：2008-12-29T02:44:03.040
> 
> 标签：c#, sql, recursion, polymorphism

在我的职业生涯中，我遇到过几次这个问题，并且从来没有对这个解决方案感到非常满意，并且在我在 ASP.Net MVC、C#、SQL Server 2008 中做的一个项目中再次遇到了这个问题：

想象一下，我有一个 Person 类型（类）。我还有扩展 Person 的类型 Mother 和 Father。父亲和母亲非常相似：他们都有一个名为“Children”的属性，它是一个 Person 类型的集合。“人”可以用基本的 Person 类、Mother 类或 Father 类来表示。从这个例子你可以看到我有继承（is-a）和关联（has-a）关系。

我想使用这些 OO 类型在 SQL Server 中构建和存储家谱。我想我想要这 3 张表：Person、Mother 和 Father。每个对象在 Person 中都有一个条目，如果合适的话，可能还有在 Mother 或 Father 中的条目（与 Person 有 FK 关系）。此外，我将需要一些人行横道表来存储母亲记录与任何子记录之间的关系，与父亲相同。

这听起来像是一个很好的存储策略吗？

你将如何有效地查询这个深度和广泛的家谱？

我被挂断的问题是在树中返回和给定节点的数据的多态性。如果这只是 Person 对象的树，我会使用[Recursive Common Table Expression](http://msdn.microsoft.com/en-us/library/ms186243.aspx)。但是对于任何给定节点，可能会返回 3 种不同形状的数据，我想将其映射到 C# 中的 3 种 OO 类型之一。我显然可以在 C# 或存储过程中进行递归，但我对过去此类解决方案的性能不太满意。另外，如何自然地插入记录？由于 SQL Server 中的 FK 关系强制，我过去总是必须以正确的顺序插入（人，然后是父亲或母亲）。

是否有一个框架可以为我处理这种类型的 ORM？

**编辑：**

为了清楚起见，我需要的解决方案是检索整个家谱以进行显示，并能够向家谱添加和编辑节点。我认为最好的解决方案是在一棵深树中的一个查询中执行此操作。我要问的是如何设计模式、存储和检索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T02:50:06.603

我能给出充分答案的唯一部分是关于 ORM 框架。[NHibernate](http://www.hibernate.org/343.html)非常擅长处理表继承。例如，如果您使映射正确，它将为您保存的每个母亲或父亲保存一个 Person 实体。

查看[继承映射](http://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-14T20:48:58.427

你不需要为一个人设置一个母亲和一个父亲，你只需要为每个人关联2个父母。识别具有“性别”属性的人，男性将自动成为父亲，女性将自动成为母亲。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-29T13:46:01.687

我不明白你的具体情况有多难。如果父亲和母亲的代码没有不同的行为，则不需要单独的类。您甚至可能根本不需要对 person 进行子类化。

如果确实发现您确实需要一个超类和两个子类，并且您希望表格图具有一定的可读性（而不是对平面表格中的每个原始属性进行 GUID），您可以在其中包含子类 A 和子类 B 数据它们各自的表具有外键关系到具有超类型数据的表。

如果 Has-A 关系依赖于子类型，您可以将其作为列放在适当的子类表中，并带有对 person 的外键约束。

我错过了什么吗？如果您描述实施此解决方案时面临的问题，也许会有所帮助。

# python - 令人困惑的 [...] Python 中的列表：它是什么？

> ID：397034
> 
> 赞同：17
> 
> 时间：2008-12-29T02:46:31.320
> 
> 标签：python, recursion, list, recursive-datastructures

所以我在 Python 中编写了一个简单的二叉树并遇到了 [...]

我不认为这与 Ellipsis 对象有关，它似乎与无限循环有关（由于 Python 的浅拷贝？）。但是，这个无限循环的来源以及为什么在访问时扩展时它没有得到扩展是我完全不知道的

 `````
>>> a
[[[[[], [], 8, 3], [[], [], 3, 2], 6, 3], [], 1, 4], [[], [], -4, 2], 0, 0]
>>> Keys(a)#With a+b
[0, 1, 6, 8, 3, -4]
>>> Keys(a)#With [a,b]
[8, [...], [...], 3, [...], [...], 6, [...], [...], 1, [...], [...], -4, [...], [...], 0, [...], [...]]
>>> Keys(a)[1]#??
[8, [...], [...], 3, [...], [...], 6, [...], [...], 1, [...], [...], -4, [...], [...], 0, [...], [...], 8, [...], [...], 3, [...], [...], 6, [...], [...], 1, [...], [...], -4, [...], [...], 0, [...], [...]] 
````  `使用 a+b 的版本

```
def Keys(x,y=[]):
    if len(x):y+=[x[2]]+Keys(x[0],y)+Keys(x[1],y)#Though it seems I was using y=y[:]+, this actually outputs an ugly mess
    return y 
```

使用 [a,b] 的版本

```
def Keys(x,y=[]):
    if len(x):y+=[x[2],Keys(x[0],y),Keys(x[1],y)]
    return y 
```

那么究竟是什么[...]？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-29T03:02:35.953

It can also appear if you have a circular structure with a list pointing to itself. Like this:

```
>>> a = [1,2]
>>> a.append(a)
>>> a
[1, 2, [...]]
>>> 
```

Since python can't print out the structure (it would be an infinite loop) it uses the ellipsis to show that there is recursion in the structure.

* * *

I'm not quite sure if the question was what what going on or how to fix it, but I'll try to correct the functions above.

In both of them, you first make two recursive calls, which add data to the list `y`, and then AGAIN append the returned data to `y`. This means the same data will be present several times in the result.

Either just collect all the data without adding to any `y`, with something like

```
return [x[2]]+keys(x[0])+keys(x[1]) 
```

or just do the appending in the calls, with something like

```
y += [x[2]]
keys(x[0], y) #Add left children to y...
keys(x[1], y) #Add right children to y...
return y 
```

(Of course, both these snippets need handling for empty lists etc)

@Abgan also noted that you really don't want `y=[]` in the initializer.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-29T03:08:33.070

I believe, that your 'tree' contains itself, therefore it contains cycles.

Try this code:

```
   a = [1,2,3,4]
   print a
   a.append(a)
   print a

```

The first print outputs:

```
  [1,2,3,4]

```

while the second:

```
  [1,2,3,4, [...]]

```

The reason is using

```
 def Keys(x,y=[]):

```

This is wrong and evil. List is a mutable object, and when used as a default parameter, it is preserved between function calls. So each y += "anything" operation adds to the same list (in all function calls, and since the function is recursive...)

* * *

See the [Effbot](http://effbot.org/zone/default-values.htm) or [Devshed](http://www.devshed.com/c/a/Python/Python-Parameters-Functions-and-Arguments/) for more details on mutable objects passed as default values for functions.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-29T03:03:22.253

I don't understand your code above, but the [...] I think is the Python interpreter skipping infinite data structures. For example:

```
>>> a = [0, 1]
>>> a[0] = a
>>> a
[[...], 1] 
```

It looks like your tree structure is becoming looped.

The answers about slice objects are beside the point.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-29T03:15:38.203

> I don't believe this to be related to the Ellipsis object, more it seems to have something to do with an infinity loop (due to Python's shallow copy?). The source of this infinity loop and why it doesn't get expanded while expanding when accessed is something I'm completely lost to, however

Look at the following code:

```
>>> a = [0]
>>> a.append(a)
>>> print a
[0, [...]] 
```

How is Python supposed to print a? It is a list that contains a zero and a reference to itself. Hence it is a list that contains a zero and a reference to a list

```
[0, [...]] 
```

which in turn contains a zero and a reference to a list

```
[0, [0, [...]]] 
```

which in turn contains a zero and a reference to a list, and so on, recursively:

```
[0, [0, [0, [...]]]]
[0, [0, [0, [0, [...]]]]]
[0, [0, [0, [0, [0, [...]]]]]]
... 
```

There is nothing wrong with the recursive data structure itself. The only problem is that it cannot be *displayed*, for this would imply an infinite recursion. Hence Python stops at the first recursion step and deals with the infinity issue printing only the ellipsis, as was pointed out in previous answers.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-10T17:47:02.917

如果您使用 PrettyPrinter，输出将是不言自明的

```
>>> l = [1,2,3,4]
>>> l[0]=l
>>> l
[[...], 2, 3, 4]
>>> pp = pprint.PrettyPrinter(indent = 4)
>>> pp.pprint(l)
[<Recursion on list with id=70327632>, 2, 3, 4]
>>> id(l)
70327632 
```

换句话说，它就像

![在此处输入图像描述](https://i.stack.imgur.com/v2TY7.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-29T02:56:36.480

编辑：如上所述，这不是 Ellipsis 对象，而是循环列表的结果。我在这里开枪了。如果您在一些实际代码中而不是输出中找到省略号，那么了解省略号对象是一个很好的后置知识。

* * *

Python 中的 Ellipsis 对象用于扩展切片表示法。它没有在当前的 Python 核心库中使用，但可供开发人员在自己的库中定义。例如，NumPy（或 SciPy）使用 this 作为其数组对象的一部分。您需要查看 tree() 的文档以准确了解 Ellipsis 在此对象中的行为方式。

来自[Python 文档](http://www.python.org/doc/2.5.2/lib/bltin-ellipsis-object.html)：

> 3.11.8 省略号对象
> 
> 此对象由扩展切片表示法使用（请参阅 Python 参考手册）。它不支持特殊操作。只有一个省略号对象，名为 Ellipsis（内置名称）。
> 
> 它被写为省略号。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-29T03:46:18.393

Ok, so in points:

1.  You're creating infinite data structure:

    ```
    def Keys(x,y=[])
    ```

    will use the same 'y' in each call. This just isn't correct.
2.  The `print` statement, however, is clever enough not to print an infinite data, but to mark self-reference with a [...] (known as *Ellipsis*)

3.  The Python will allow you to address such structure correctly, so you can write

    ```
    a.keys()[1][1][1]
    ```

    and so on. Why shouldn't you?
4.  The `y = y[:]` statement simply copies the list y. Can be done more soundly with `y = list(y)`

Try using the following code:

```
def Keys(x,y=None):
    if y is None:
        y = []
    if len(x):
        y += [x[2], Keys(x[0],y), Keys(x[1],y)]
    return y

```

But still I guess that it can bite you. You're still using the same variable y (I mean the same object) in three places in one expression:

```
 y += [x[2], Keys(x[0], y), Keys(x[1], y)] 
```

Is that what you really want to achieve? Or maybe you should try:

```
def mKeys(x,y=None):
    if y is None:
        y = []
    if len(x):
       z = [x[2], mKeys(x[0], y), mKeys(x[1],y)]
       return z
   return []

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-29T06:20:54.913

对于两个版本的功能 Keys 的区别，请注意以下区别：

```
y+=[x[2]]+Keys(x[0],y)+Keys(x[1],y) 
```

该语句右侧的值是一个列表，其中包含 x[2]，加上 ELEMENTS OF Keys(x[0],y) 和 ELEMENTS OF Keys(x[1],y)

```
y+=[x[2],Keys(x[0],y),Keys(x[1],y)] 
```

该语句右侧的值是一个包含 x[2]、加上 LIST Keys(x[2],y) 和 LIST Keys(x[1],y) 的列表。

所以使用 [a,b] 的版本会导致 y 包含它自己作为它的元素。

其他一些注意事项：

1.  由于在 python 中，默认值对象在定义函数时创建一次，所以第一个版本不会像示例所示那样工作。它将包含一些密钥的多个副本。简而言之很难解释，但是您可以通过在每次调用 Keys 时打印 x、y 的值来获得一些想法。

    这可以通过在我的机器上使用 python 2.5.2 运行该函数来确认。

2.  另外因为默认值在函数定义时只定义一次，即使函数第一次正常工作，当用不同的 a 调用时它也不会工作，因为第一个二叉树中的键将保留在 y 中。

    您可以通过两次调用 Keys(a) 或在两个不同的列表上调用它来看到这一点。

3.  此问题不需要第二个参数。函数可以是这样的：

    def Keys(a): if a = []: return [] else: return [a[2]]+Keys(a[0])+Keys(a[1])

    定义一个递归函数基本上包含两部分，解决子问题和合并结果。在您的代码中，组合结果部分重复了两次：一次通过将它们累积在 y 中，一次通过将列表相加。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-23T16:35:28.607

问题是因为列表元素之一正在引用列表本身。因此，如果尝试打印所有元素，那么它将永远不会结束。

**插图：**

```
x = range(3)
x.append(x)
x[3][3][3][3][3][0] = 5
print x 
```

输出：

```
[5, 1, 2, [...]] 
```

`x[3]`是指`x`自己。也一样`x[3][3]`。

这可以在 [这里更好地可视化](http://pythontutor.com/visualize.html#code=x%20%3D%20range%283%29%0Ax.append%28x%29%0Ax%5B3%5D%5B3%5D%5B3%5D%5B3%5D%5B3%5D%5B0%5D%20%3D%205%0Aprint%20x&cumulative=false&heapPrimitives=false&mode=edit&origin=opt-frontend.js&py=2&rawInputLstJSON=%5B%5D&textReferences=false)

# ajax - Ajax Toolkit ReorderList Two components with the same id 'componentid' can't be added to the applicaiton

> ID：397051
> 
> 赞同：0
> 
> 时间：2008-12-29T03:00:03.540
> 
> 标签：ajax, toolkit, reorderlist

Line 3655 Char 59 Ajax Toolkit ReorderList Two components with the same id 'componentid' can't be added to the applicaiton. When using with a database to update a simple list it works fine until it is being used very fast dragging multiple things reasonably fast. This occurs in IE, Firefox and Chrome. It appears to be something that allows the same id to be created at a guess though it is in the bowls of the Ajax toolkit somewhere. Does anyone have the answer - else I'm off to painstakingly debug the toolkit code.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-02T07:29:04.337

Ended up implementing using Jquery plugin. Works much nicer and cleaner than the the MS Ajax toolkit ReorderList. This was not happening on the asp.net at there was no database attached

# ruby-on-rails - 在 Rails 中，如何在功能测试中存根 render 方法？

> ID：397052
> 
> 赞同：2
> 
> 时间：2008-12-29T03:01:18.217
> 
> 标签：ruby-on-rails, ruby

我正在为 rails 中的控制器编写一些功能测试，使用 mocha 进行模拟/存根。

有没有办法防止模板在测试过程中被渲染，这样我就可以只测试控制器中的代码了？

看起来 rspec 提供了类似的东西，但我没有使用 rspec。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T12:50:15.097

最明显的解决方案似乎有效：

```
@controller.expects(:render) 
```

我可以发誓我昨晚试过了，但没有运气。但今天早上它就像一个魅力。我一定忽略了一个错字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T13:27:41.837

看起来这里不需要使用存根。如果要确保呈现给定模板，请使用[`assert_template`](http://apidock.com/rails/ActionController/Assertions/ResponseAssertions/assert_template)和/或[`assert_response`](http://apidock.com/rails/ActionController/Assertions/ResponseAssertions/assert_response). 您还可以手动声明响应对象的状态，或者使用[`assert_select`](http://apidock.com/rails/ActionController/Assertions/SelectorAssertions/assert_select).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T05:33:49.080

会[`render_to_string`](http://api.rubyonrails.org/classes/ActionController/Base.html#M000513)做你需要的吗？

# c++ - 从 vc++ 调用存储在堆中的代码

> ID：397064
> 
> 赞同：11
> 
> 时间：2008-12-29T03:10:41.583
> 
> 标签：c++, pointers, assembly, function-pointers, opcode

想象一下我正在做这样的事情：

```
void *p = malloc (1000);
*((char*)p) = some_opcode;
*((char*)p+1) = another_opcode; // for the sake of the example: the opcodes are ok

....
etc... 
```

如何定义一个函数指针来调用 p ，就好像它是一个函数一样？（我正在使用 VC++ 2008 express）。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-29T03:52:15.510

实际上， malloc 可能不会削减它。在 Windows 上，您可能需要调用类似 [VirtualAlloc]( [http://msdn.microsoft.com/en-us/library/aa366887(VS.85).aspx)](http://msdn.microsoft.com/en-us/library/aa366887(VS.85).aspx))的方法来获取可执行的内存页面。

从小处着手：

```
void main(void)
{
    char* p = (char*)VirtualAlloc(NULL, 4096, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    p[0] = (char)0xC3;  // ret

    typedef void (*functype)();
    functype func = (functype)p;
    (*func)();
} 
```

更好地使用您的代码的下一步是保留 EBP 寄存器。这留作练习。:-)

写完之后，我用 malloc 运行它，它也工作了。这可能是因为我在 Windows 2000 Server 上运行管理员帐户。其他版本的 Windows 实际上可能需要 VirtualAlloc 调用。谁知道。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-29T05:20:30.137

评论空间不够。Joe_Muc 是正确的。您不应该将代码填充到由`malloc`or获得的内存中`new`。如果您更改 Windows 分配的页面的页面属性，您将遇到问题。

这不是问题，因为使用 VirtualAlloc() 和相关的 WIn32 API 非常简单：调用VirtualAlloc [(](http://msdn.microsoft.com/en-us/library/aa366887.aspx) ) 并将`flProtect``[PAGE_EXECUTE_READWRITE][2]`

请注意，您可能应该进行三个分配，一个保护页面，您的代码需要的页面，然后是另一个保护页面。这将为您提供一些免受不良代码影响的保护。

[还使用结构化异常处理](http://msdn.microsoft.com/en-us/library/ms680657(VS.85).aspx)包装对生成代码的调用。

接下来，Windows X86 ABI（调用约定）没有很好的文档记录（我知道，我看过）。[这里](http://www.agner.org/optimize/calling_conventions.pdf)有一些信息，[这里](http://support.microsoft.com/kb/100832)，[这里](http://msdn.microsoft.com/en-us/library/aa235439(VS.60).aspx) 了解事情如何工作的最好方法是查看编译器生成的代码。[使用开关](http://msdn.microsoft.com/en-us/library/367y26c6(VS.80).aspx)很容易做到这一点（其中有四个）。[`\FA`](http://msdn.microsoft.com/en-us/library/367y26c6(VS.80).aspx)

[您可以在此处](http://msdn.microsoft.com/en-us/library/ms794533.aspx)找到 64 位调用约定。

此外，您仍然可以[在此处获得 Microsoft 的 Macro Assembler MASM](http://www.microsoft.com/downloads/details.aspx?familyid=7A1C9DA0-0510-44A2-B042-7EF370530C64&displaylang=en)。我建议在 MASM 中编写您的机器代码并查看其输出，然后让您的机器代码生成器执行类似的操作。

[英特尔](http://www.intel.com/products/processor/manuals/index.htm)和[AMD 的](http://www.amd.com/us-en/Processors/TechnicalResources/0,,30_182_739_15343,00.html)处理器手册是很好的参考资料——如果你没有它们，请获取它们。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-29T03:14:15.743

如果您有正确的操作码，调用可以像转换为函数指针并调用它一样简单。

```
typedef void (*voidFunc)();

char *p = malloc (1000);
p[0] = some_opcode;
p[1] = another_opcode; // for the sake of the example: the opcodes are ok
p[n] = // return opcode...

((voidFunc)p)(); 
```

请注意，除非您将页面标记为可执行，否则您的处理器可能不会让您执行在堆上生成的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-12T22:28:43.797

我目前也在研究执行生成的代码，虽然这里的答案并没有准确地告诉我我需要什么，但你们让我走上了正确的轨道。

如果您需要在 POSIX 系统（Linux、BSD 等）上将页面标记为可执行，请查看[mmap(2) 函数](http://linux.die.net/man/2/mmap)。

# asp.net - Need suggestion for ASP.Net in-memory queue

> ID：397073
> 
> 赞同：1
> 
> 时间：2008-12-29T03:19:16.340
> 
> 标签：asp.net, httphandler

I've a requirement of creating a HttpHandler that will serve an image file (simple static file) and also it'll insert a record in the SQL Server table. (e.g [http://site/some.img](http://site/some.img), where some.img being a HttpHandler) I need an in-memory object (like Generic List object) that I can add items to on each request (I also have to consider a few hundreds or thousands requests per second) and I should be able unload this in-memory object to sql table using SqlBulkCopy.

List --> DataTable --> SqlBulkCopy

I thought of using the Cache object. Create a Generic List object and save it in the HttpContext.Cache and insert every time a new Item to it. This will NOT work as the CacheItemRemovedCallback would fire right away when the HttpHandler tries to add a new item. I can't use Cache object as in-memory queue.

Anybody can suggest anything? Would I be able to scale in the future if the load is more?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T12:44:10.100

当您将某些内容添加到队列时，为什么 CacheItemRemovedCalledback 会触发？这对我来说没有意义......即使这确实火了，也不需要在这里*做*任何事情。也许我误解了你的要求？

我以这种方式非常成功地使用了 Cache 对象。这就是它的设计目的，并且可以很好地扩展。我存储了一个哈希表，在每个应用程序页面请求上都可以访问它，并根据需要进行更新/清除。

选项二……你真的需要排队吗？如果您只想直接写入数据库，SQL Server 也可以很好地扩展。使用共享连接对象和/或连接池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T12:43:12.740

仅使用通用列表来存储请求并使用不同的线程来执行 SqlBulkCopy 怎么样？

这样将请求存储在列表中不会阻塞响应太久，后台线程将能够在自己的时间更新 Sql，每 5 分钟一次。

您甚至可以通过在 CacheItemRemovedCallback 上执行工作来使后台线程基于 Cache 机制。

只需插入一些移除时间为 5 分钟的对象，然后在处理工作结束时重新插入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T15:01:37.577

You can create a conditional requirement within the callback to ensure you are working on a cache entry that has been hit from an expiration instead of a remove/replace (in VB since I had it handy):

```
Private Shared Sub CacheRemovalCallbackFunction(ByVal cacheKey As String, ByVal cacheObject As Object, ByVal removalReason As Web.Caching.CacheItemRemovedReason)
    Select Case removalReason
        Case Web.Caching.CacheItemRemovedReason.Expired, Web.Caching.CacheItemRemovedReason.DependencyChanged, Web.Caching.CacheItemRemovedReason.Underused
        ' By leaving off Web.Caching.CacheItemRemovedReason.Removed, this will exclude items that are replaced or removed explicitly (Cache.Remove) '
    End Select
End Sub 
```

**Edit** Here it is in C# if you need it:

```
private static void CacheRemovalCallbackFunction(string cacheKey, object cacheObject, System.Web.Caching.CacheItemRemovedReason removalReason)
{
    switch(removalReason)
    {
        case System.Web.Caching.CacheItemRemovedReason.DependencyChanged:
        case System.Web.Caching.CacheItemRemovedReason.Expired:
        case System.Web.Caching.CacheItemRemovedReason.Underused:
            // This excludes the option System.Web.Caching.CacheItemRemovedReason.Removed, which is triggered when you overwrite a cache item or remove it explicitly (e.g., HttpRuntime.Cache.Remove(key))
            break;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T19:56:44.127

感谢 Alex 和 Bryan 的建议。

Bryan：当我尝试为第二个请求替换 Cache 中的 List 对象时（现在，count 应该是 2），当我用新的 Cache 对象替换当前的 Cache 对象时，CacheItemRemovedCalledback 会被触发。最初，我也认为这是一种奇怪的行为，所以我必须更深入地研究它。另外，对于第二个建议，我将尝试插入记录（使用 Cached SqlConnection 对象）并查看在进行压力测试时获得的性能。我怀疑我会得到很棒的数字，因为它是 I/O 操作。

在您提出建议的同时，我将继续挖掘最佳解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T06:12:05.013

为了扩展我之前的评论......我得到的图片你正在错误地考虑缓存。如果您有一个对象存储在缓存中，比如一个哈希表，那么该哈希表中的任何更新/存储都将被持久化，而无需您显式修改缓存的内容。您只需将 Hashtable 添加到缓存中一次，无论是在应用程序启动时还是在第一次请求时。

如果您担心批量复制和页面请求更新同时发生，那么我建议您简单地拥有两个缓存列表。有一个是随着页面请求进入而更新的列表，还有一个用于批量复制操作的列表。当一个大容量复制完成后，交换列表并重复。这类似于视频游戏或视频应用程序的双缓冲视频 RAM。

# c++ - What is the difference between exit() and abort()?

> ID：397075
> 
> 赞同：138
> 
> 时间：2008-12-29T03:21:37.177
> 
> 标签：c++, c, error-handling, exit, abort

In C and C++, what is the difference between `exit()` and `abort()`? I am trying to end my program after an error (not an exception).

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2008-12-29T03:27:45.370

[`abort()`](http://en.cppreference.com/w/c/program/abort) exits your program without calling functions registered using [`atexit()`](http://en.cppreference.com/w/c/program/atexit) first, and without calling objects' destructors first. [`exit()`](http://en.cppreference.com/w/c/program/exit) does both before exiting your program. It does not call destructors for automatic objects though. So

```
A a;
void test() { 
    static A b;
    A c;
    exit(0);
} 
```

Will destruct `a` and `b` properly, but will not call destructors of `c`. `abort()` wouldn't call destructors of neither objects. As this is unfortunate, the C++ Standard describes an alternative mechanism which ensures properly termination:

> Objects with automatic storage duration are all destroyed in a program whose function `main()` contains no automatic objects and executes the call to `exit()`. Control can be transferred directly to such a `main()` by throwing an exception that is caught in `main()`.

```
struct exit_exception { 
   int c; 
   exit_exception(int c):c(c) { } 
};

int main() {
    try {
        // put all code in here
    } catch(exit_exception& e) {
        exit(e.c);
    }
} 
```

Instead of calling `exit()`, arrange that code `throw exit_exception(exit_code);` instead.

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-12-29T03:25:24.830

**abort** sends a SIGABRT signal, **exit** just closes the application performing normal cleanup.

You can handle an **abort** signal however you want, but the default behavior is to close the application as well with an error code.

**abort** will not perform object destruction of your static and global members, but **exit** will.

Of course though when the application is completely closed the operating system will free up any unfreed memory and other resources.

In both **abort** and **exit** program termination (assuming you didn't override the default behavior), the return code will be returned to the parent process that started your application.

See the following example:

```
SomeClassType someobject;

void myProgramIsTerminating1(void)
{
  cout<<"exit function 1"<<endl;
}

void myProgramIsTerminating2(void)
{
  cout<<"exit function 2"<<endl;
}

int main(int argc, char**argv)
{
  atexit (myProgramIsTerminating1);
  atexit (myProgramIsTerminating2);
  //abort();
  return 0;
} 
```

Comments:

*   If **abort** is uncommented: nothing is printed and the destructor of someobject will not be called.

*   If **abort** is commented like above: someobject destructor will be called you will get the following output:

> exit function 2
> exit function 1

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-29T03:32:22.773

The following things happen when a program calls `exit`():

*   Functions registered by the `atexit` function are executed
*   All open streams are flushed and closed, files created by `tmpfile` are removed
*   The program terminates with the specified exit code to the host

The `abort`() function sends the `SIGABRT` signal to the current process, if it is not caught the program is terminated with no guarantee that open streams are flushed/closed or that temporary files created via `tmpfile` are removed, `atexit` registered functions are not called, and a non-zero exit status is returned to the host.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-29T03:29:00.813

`abort` sends the `SIGABRT` signal. `abort` does not return to the caller. The default handler for the `SIGABRT` signal closes the application. `stdio` file streams are flushed, then closed. Destructors for C++ class instances are not, however (not sure on this one -- perhaps results are undefined?).

`exit` has its own callbacks, set with `atexit`. If callbacks are specified (or only one), they are called in the order reverse of their registration order (like a stack), then the program exits. As with `abort`, `exit` does not return to the caller. `stdio` file streams are flushed, then closed. Also, destructors for C++ class instances are called.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-29T03:29:10.657

From the exit() manual page:

> The exit() function causes normal process termination and the value of status & 0377 is returned to the parent.

From the abort() manual page:

> The abort() first unblocks the SIGABRT signal, and then raises that signal for the calling process. This results in the abnormal termination of the process unless the SIGABRT signal is caught and the signal handler does not return.

# c# - .Net XmlSerializer：将 CDATA 反序列化为内部文本

> ID：397085
> 
> 赞同：6
> 
> 时间：2008-12-29T03:32:22.443
> 
> 标签：c#, .net, xml-serialization, cdata

我在使用标准 .Net XmlSerializer 进行 CDATA 反序列化时遇到问题。

**更新**：我从外部系统获取 XML，我无法影响它的格式，因此我无法将 CData 包含在单独的属性元素中。

序列化给出了这个：

```
<?xml version="1.0" encoding="utf-16"?>
<MyClass xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><![CDATA[Hello, world!]]></MyClass> 
```

反序列化不会将对象恢复到其原始状态。

这是正在序列化的类：

```
public class MyClass
{
    string _data;

    [XmlIgnore]
    public string Data
    {
        get { return _data; }
        set { _data = value; }
    }

    [XmlAnyElement]
    public XmlCDataSection CData
    {
        get { return new XmlDataDocument().CreateCDataSection(Data); }
        set { Data = value.Value; }
    }
} 
```

这是失败的测试：

```
[Test]
public void CData_as_inner_text_test()
{
    MyClass item = new MyClass();

    item.Data = "Hello, world!";

    XmlSerializer serializer = new XmlSerializer(item.GetType());
    string serialized;

    using (StringWriter sw = new StringWriter())
    {
        serializer.Serialize(sw, item);
        serialized = sw.GetStringBuilder().ToString();
    }

    MyClass deserialized;

    using (StringReader sr = new StringReader(serialized))
    {
        deserialized = (MyClass)serializer.Deserialize(sr);
    }

    Assert.AreEqual(item.Data, deserialized.Data); // For some reason, deserialized.Data == null
} 
```

我在这里发现了同样的问题，但没有答案： [XmlSerializer、XmlAnyElement 和 CDATA](http://bytes.com/groups/net-xml/179323-xmlserializer-xmlanyelement-cdata)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-29T10:35:31.687

CData 属性最终为空，因为 CDATA 部分的内容最终在 Data 属性中，它被忽略...

```
<MyClass><![CDATA[Hello, world!]]></MyClass> 
```

绝对等同于：

```
<MyClass>Hello, world!</MyClass> 
```

您不应该关心外部应用程序是否将 MyClass 的内容写入 CData。同样，外部应用程序不应该关心你如何写出来。

IOW，这应该是你所需要的：

```
public class MyClass
{
    string _data;

    [XmlText]
    public string Data
    {
        get { return _data; }
        set { _data = value; }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-31T21:01:12.087

首先声明一个属性为 XmlCDataSection

```
public XmlCDataSection ProjectXml { get; set; } 
```

在这种情况下 projectXml 是一个字符串 xml

```
ProjectXml = new XmlDocument().CreateCDataSection(projectXml); 
```

当您序列化您的消息时，您将拥有漂亮的格式（注意）

```
<?xml version="1.0" encoding="utf-16"?>
<MessageBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xsi:type="Message_ProjectStatusChanged">
  <ID>131</ID>
  <HandlerName>Plugin</HandlerName>
  <NumRetries>0</NumRetries>
  <TriggerXml><![CDATA[<?xml version="1.0" encoding="utf-8"?><TmData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="9.0.0" Date="2012-01-31T15:46:02.6003105" Format="1" AppVersion="10.2.0" Culture="en-US" UserID="0" UserRole=""><PROJECT></PROJECT></TmData>]]></TriggerXml>
  <MessageCreatedDate>2012-01-31T20:28:52.4843092Z</MessageCreatedDate>
  <MessageStatus>0</MessageStatus>
  <ProjectId>0</ProjectId>
  <UserGUID>8CDF581E44F54E8BAD60A4FAA8418070</UserGUID>
  <ProjectGUID>5E82456F42DC46DEBA07F114F647E969</ProjectGUID>
  <PriorStatus>0</PriorStatus>
  <NewStatus>3</NewStatus>
  <ActionDate>0001-01-01T00:00:00</ActionDate>
</MessageBase> 
```

# sql - 来自 Joel Spolsky 文章的 SQL 问题

> ID：397089
> 
> 赞同：12
> 
> 时间：2008-12-29T03:34:18.290
> 
> 标签：sql, query-optimization

来自 Joel Spolsky 关于泄漏抽象的[文章：](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)

> [C] 某些 SQL 查询比其他逻辑等效查询慢数千倍。一个著名的例子是，如果你指定“where a=b and b=c and a=c”，一些 SQL 服务器会比只指定“where a=b and b=c”快得多，即使结果集也是如此。是一样的。

有谁知道这件事的细节？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-29T03:59:33.280

显然，a = b 和 b = c => a = c - 这与传递闭包有关。Joel 的观点是某些 SQL 服务器在优化查询方面很差，因此某些 SQL 查询可能会像示例中那样使用“额外”限定符编写。

在这个例子中，请记住上面的 a、b 和 c 经常引用不同的表，并且像 a=b 这样的操作是作为连接执行的。假设表 a 中的条目数为 1000，b 为 500，c 为 20。然后 a、b 的连接需要 1000x500 行比较（这是我的愚蠢示例；实际上可能有更好的连接算法可以降低复杂性很多），并且 b,c 需要 500x20 比较。优化编译器将确定应首先执行 b,c 的连接，然后应在 a = b 上连接结果，因为 b=c 的预期行数较少。(b=c) 和 (a=b) 总共有大约 500x20 + 500x1000 的比较。之后，必须在返回的行之间计算交集（我猜也是通过连接，但不确定）。

假设 Sql 服务器可以有一个逻辑推理模块，该模块也可以推断这意味着 a = c。然后它可能会执行 b,c 的连接，然后执行 a,c 的连接（这也是一个假设情况）。这将进行 500x20 + 1000x20 比较，然后进行交集计算。如果预期 #(a=c) 较小（由于一些领域知识），那么第二个查询会快很多。

总的来说，我的答案已经变得太长了，但这意味着 SQL 查询优化不是一件容易的事，这就是为什么一些 SQL 服务器可能做得不好的原因。

更多信息可以在[http://en.wikipedia.org/wiki/Query_optimizer](http://en.wikipedia.org/wiki/Query_optimizer)或从一些期望的数据库中找到。

但从哲学上讲，SQL（作为一种抽象）旨在隐藏实现的所有方面。它本来是声明性的（SQL 服务器本身可以使用 sql 查询优化技术来重新表述查询以提高效率）。但在现实世界中并非如此——数据库查询通常必须由人工重写以提高效率。

总的来说，这篇文章的重点是一个抽象只能这么好，没有一个抽象是完美的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-29T15:21:59.267

这是一个更简单的解释，所有内容都在一个表中。

假设 A 和 C 都被索引，但 B 没有。如果优化器无法意识到 A = C，那么它必须对两个 WHERE 条件都使用非索引 B。

但是，如果您随后告诉服务器 a=c，它可以首先有效地应用该过滤器并大大减少工作集的大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T03:56:55.047

我认为“确定”这个词是这里的操作术语。为了让优化器真正理解 a=c，它必须解析 a 的相等性并将其连接到传递关系中的“c”，以便推断出这种关系。

我认为在未来，SQL 优化器可能会变得如此聪明（如果他们还没有的话），所以 IMO 这并不是 Joel 的真正一般性声明。

# asp.net - Date in Dropdown list box

> ID：397094
> 
> 赞同：2
> 
> 时间：2008-12-29T03:49:51.443
> 
> 标签：asp.net, vb.net

I have 3 drop down list having Date,Month ,Year.So when Updating I want this 3 Field to be a single Datafield in Sql Database. Iam using Asp.Net 2.0 Version(VB.Net).(Now these 3 Dropdown list values are saved as 3 Datafields in sql Database)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T03:53:35.773

为什么不使用日期/时间选择器呢？在我看来，这比你自己的日、月和年的三元组更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T03:53:28.800

I take it you're using a SqlCommand for this? Here's some sample, non-compiling code which I'll whip up for you here:

```
Dim cmd as SqlCommand("update tableX set dt = @var where ID = 1");
cmd.Parameters.AddWithValue("@var", new DateTime(CInt(day.SelectedValue), CInt(month.SelectedValue, CInt(year.SelectedValue)));

cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-29T19:31:23.230

加入价值观：

月+“/”+日+“/”+年

并使用 DateTime.Parse() 或 DateTime.TryParse() 将它们转换为日期。如果您担心文化的日期格式，请传入 CultureInfo 对象。根据需要添加您自己的验证。

[http://msdn.microsoft.com/en-us/library/1k1skd40.aspx](http://msdn.microsoft.com/en-us/library/1k1skd40.aspx)

并非万无一失，但它可能满足您的要求。

# java - 如何制作 Java.awt.Robot 类型的 unicode 字符？（是否可以？）

> ID：397113
> 
> 赞同：12
> 
> 时间：2008-12-29T04:07:14.200
> 
> 标签：java, unicode, automation

我们有一个用户提供的可能包含 unicode 字符的字符串，我们希望机器人输入该字符串。

如何将字符串转换为机器人将使用的键码？
你是怎么做到的，所以它也是独立于 java 版本的（1.3 -> 1.6）？

我们为“ascii”字符工作的是

```
//char c = nextChar();
//char c = 'a'; // this works, and so does 'A'
char c = 'á'; // this doesn't, and neither does 'Ă'
Robot robot = new Robot();
KeyStroke key = KeyStroke.getKeyStroke("pressed " + Character.toUpperCase(c) );
if( null != key ) {
  // should only have to worry about case with standard characters
  if (Character.isUpperCase(c))
  {
    robot.keyPress(KeyEvent.VK_SHIFT);
  }

  robot.keyPress(key.getKeyCode());
  robot.keyRelease(key.getKeyCode());

  if (Character.isUpperCase(c))
  {
    robot.keyRelease(KeyEvent.VK_SHIFT);
  }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-02-23T14:19:35.440

基于 javamonkey79 的代码，我创建了以下代码片段，它应该适用于所有 Unicode 值......

```
public static void pressUnicode(Robot r, int key_code)
{
    r.keyPress(KeyEvent.VK_ALT);

    for(int i = 3; i >= 0; --i)
    {
        // extracts a single decade of the key-code and adds
        // an offset to get the required VK_NUMPAD key-code
        int numpad_kc = key_code / (int) (Math.pow(10, i)) % 10 + KeyEvent.VK_NUMPAD0;

        r.keyPress(numpad_kc);
        r.keyRelease(numpad_kc);
    }

    r.keyRelease(KeyEvent.VK_ALT);
} 
```

这会自动遍历 unicode 键码的每个十年，将其映射到相应的 VK_NUMPAD 等效项并相应地按下/释放键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T04:57:54.020

[KeyEvent](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/event/KeyEvent.html)类在 JRE 1.5 中没有许多 unicode 类的直接映射。如果您在 Windows 机器上运行它，您可能需要编写一个自定义处理程序来执行以下操作：

```
Robot robot = new Robot();
char curChar = 'Ã';

// -- isUnicode( char ) should be pretty easy to figure out
if ( isUnicode( curChar ) ) {
   // -- this is an example, exact key combinations will vary
   robot.keyPress( KeyEvent.VK_ALT );

   robot.keyPress( KeyEvent.VK_NUMBER_SIGN );
   robot.keyRelease( KeyEvent.VK_NUMBER_SIGN );

   // -- have to apply some logic to know what sequence
   robot.keyPress( KeyEvent.VK_0 );
   robot.keyRelease( KeyEvent.VK_0 );
   robot.keyPress( KeyEvent.VK_1 );
   robot.keyRelease( KeyEvent.VK_1 );
   robot.keyPress( KeyEvent.VK_9 );
   robot.keyRelease( KeyEvent.VK_9 );
   robot.keyPress( KeyEvent.VK_5 );
   robot.keyRelease( KeyEvent.VK_5 );

   robot.keyRelease( KeyEvent.VK_ALT );
} 
```

例如，弄清楚它们的组合键是什么，然后将它们映射到某种对象（可能是 HashMap？）以供以后查找和执行。

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-06T22:16:49.737

我认为这有点晚了，但是...

```
Robot robot = new Robot();

   robot.keyPress( KeyEvent.VK_DEAD_ACUTE);

   robot.keyPress( KeyEvent.VK_A );
   robot.keyRelease( KeyEvent.VK_A );

   robot.keyRelease( KeyEvent.VK_DEAD_ACUTE ); 
```

只需输入“á”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-20T19:20:49.987

我在解决模拟问题时找到的最佳方法

```
import java.awt.AWTException;
import java.awt.Robot;

public class MyRobot {

    public static void typeString(String s)
        {
            try {
            Robot robik = new Robot();
            byte[] bytes = s.getBytes();
            for (byte b : bytes)
            {
                int code = b;
                // keycode only handles [A-Z] (which is ASCII decimal [65-90])
                if (code > 96 && code < 123) code = code - 32;
                robik.delay(40);
                robik.keyPress(code);
                robik.keyRelease(code);
            }
        } catch (AWTException e){

    }
  }

} 
```

[http://www.devdaily.com/java/java-robot-class-example-mouse-keystroke](http://www.devdaily.com/java/java-robot-class-example-mouse-keystroke) \

# wpf - WPF Image 在运行时动态更改图像源

> ID：397117
> 
> 赞同：26
> 
> 时间：2008-12-29T04:12:22.940
> 
> 标签：wpf, image, dynamic, execution

我有一个带有标题的窗口。当用户从下拉列表中选择一个选项时，标题图像可以改变。问题是当图像加载时，它是模糊的、拉伸的和像素化的。这些是我正在使用的 PNG 文件，它们在动态设置源之前看起来不错。

这是我用来更改图像源的代码。

```
string strUri2 = String.Format(@"pack://application:,,,/MyAssembly;component/resources/main titles/{0}", CurrenSelection.TitleImage);
Stream iconStream2 = App.GetResourceStream(new Uri(strUri2)).Stream;
imgTitle.Source = HelperFunctions.returnImage(iconStream2); 
```

这里是辅助函数。

```
 public static BitmapImage returnImage(Stream iconStream)
    {
        Bitmap brush = new Bitmap(iconStream);
        System.Drawing.Image img = brush.GetThumbnailImage(brush.Height, brush.Width, null, System.IntPtr.Zero);
        var imgbrush = new BitmapImage();
        imgbrush.BeginInit();
        imgbrush.StreamSource = ConvertImageToMemoryStream(img);
        imgbrush.CreateOptions = BitmapCreateOptions.PreservePixelFormat;
        imgbrush.EndInit();
        var ib = new ImageBrush(imgbrush);
        return imgbrush;
    }

    public static MemoryStream ConvertImageToMemoryStream(System.Drawing.Image img)
    {
        var ms = new MemoryStream();
        img.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
        return ms;
    } 
```

和 XAML

```
 <Image x:Name="imgTitle" HorizontalAlignment="Left" VerticalAlignment="Bottom" Grid.Column="1" Grid.Row="1" Stretch="None" d:IsLocked="False"/> 
```

对于参考：

```
xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-29T08:51:09.133

我能想到两件事：

首先，尝试加载图像：

```
string strUri2 = String.Format(@"pack://application:,,,/MyAseemby;component/resources/main titles/{0}", CurrenSelection.TitleImage);
imgTitle.Source = new BitmapImage(new Uri(strUri2)); 
```

可能问题在于 WinForm 的图像大小调整，如果图像被拉伸，将图像控件上的 Stretch 设置为“Uniform”或“UnfirofmToFill”。

第二种选择可能是图像未与像素网格对齐，您可以在我的博客[http://www.nbdtech.com/blog/archive/2008/11/20/blurred-images-in-上阅读相关内容wpf.aspx](http://www.nbdtech.com/blog/archive/2008/11/20/blurred-images-in-wpf.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-09-11T21:25:23.113

嘿，这个有点难看，但它只有一行：

```
imgTitle.Source = new BitmapImage(new Uri(@"pack://application:,,,/YourAssembly;component/your_image.png")); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-19T05:08:41.513

这就是它对我的完美工作方式。在窗口资源中添加图像。

```
 <Image x:Key="delImg" >
    <Image.Source>
     <BitmapImage UriSource="Images/delitem.gif"></BitmapImage>
    </Image.Source>
   </Image> 
```

然后代码是这样的。

```
Image img = new Image()

img.Source = ((Image)this.Resources["delImg"]).Source; 
```

“this”指的是 Window 对象

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-09-18T20:07:07.463

```
Me.imgAddNew.Source = New System.Windows.Media.Imaging.BitmapImage(New Uri("/SPMS;component/Images/Cancel__Red-64.png", UriKind.Relative)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-03-08T16:23:55.660

像我一样-> 工作是：

`string strUri2 = Directory.GetCurrentDirectory()+@"/Images/ok_progress.png"; image1.Source = new BitmapImage(new Uri(strUri2));`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-29T06:04:48.177

在图像上尝试 Stretch="UniformToFill"

# .net - 在 Windows 窗体中加载与显示事件

> ID：397121
> 
> 赞同：32
> 
> 时间：2008-12-29T04:26:01.510
> 
> 标签：.net, winforms, events, .net-2.0

希望我只是遗漏了一些明显的东西，但我试图弄清楚[Windows Forms](http://en.wikipedia.org/wiki/Windows_Forms)中的 Load 和 Shown 事件之间的差异。

传统上，我只使用了 Load（或者实际上是 OnLoad，因为我认为重写一个方法比依赖设计器在自己身上关联一个事件更干净），因为它在所有版本的 .NET 中都可用。.NET 2.0 引入了 Shown 事件。

现在，如果您在 MSDN 文档中查看这些描述（“加载：在第一次显示表单之前发生。”，“显示：在第一次显示表单时发生。”）*听起来*像 Load 事件应该发生，然后表单应该变得可见，然后应该发生 Shown 事件；两者的结合使您可以在表格可见之前和之后执行一些任务。有道理，对吧？

然而，实验表明 Shown 事件总是发生*在*Load 事件之前，每当我尝试它时（并且两者都发生在表单变得可见之前）。然而，每当我发现一个页面讨论这些事件的触发顺序时，他们总是列出首先触发的 Load 事件。

我只是疯了，还是我错过了什么？（如果它们确实几乎同时发生，那么为什么首先添加 Shown 事件？）

（我目前在显示表单之前和之后做某事的解决方案是将 OnLoad 用于“显示前”的内容，并为“显示后”的内容启动一个短时间的一次性计时器。它工作正常且可靠，但是这有点难看，我希望有一个更清洁的解决方案。但看起来 Shown 事件不是它。）

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-29T14:25:06.527

避免使用 MessageBox.Show() 来调试它。它泵出一个消息循环，扰乱了正常的事件流。*Load*事件由 Windows 发送 WM_SHOWWINDOW 消息触发，就在窗口变得可见之前。没有关于“您的窗口现在已完全显示”的 Windows 通知，因此 WF 设计者想出了一个技巧来生成*Shown*事件。他们使用 Control.BeginInvoke()，确保一旦程序再次空闲并重新进入消息循环，就会调用 OnShown() 方法。

这个技巧还有很多其他用途，特别是当您必须延迟执行由事件启动的代码时。但是，在您的情况下，它会因为您使用 MessageBox.Show() 而分崩离析。它的消息循环调度使用 BeginInvoke() 注册的委托，导致 Shown 事件在窗口显示*之前运行。*

除了 MessageBox 之外，还有许多其他方法可以获取诊断信息。Debug.Print() 和 Console.WriteLine() 很方便，它们的输出进入[Visual Studio 输出窗口](http://msdn.microsoft.com/en-us/library/3hk6fby3.aspx)，而不会对正常的事件触发序列产生任何不利影响。一个简单的[断点](http://msdn.microsoft.com/en-us/library/ktf38f66(v=vs.80).aspx)也可以创造奇迹。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-08-14T15:44:17.600

这是我追踪的事件顺序。可能这将帮助其他人决定他们想如何调用或设置他们的自定义事件处理

> # 追踪的事件
> 
> 表格 - 客户大小已更改：2010 年 8 月 14 日上午 10:40:28
> 表格 - 添加了控件 - 按钮 1：2010 年 8 月 14 日上午 10:40:29
> 表格 - 构造函数：2010 年 8 月 14 日上午 10:40:29
> 表单 - 句柄已创建：2010 年 8 月 14 日上午 10:40:29
> 表单 - 无效：2010 年 8 月 14 日上午 10:40:29
> 表单 - 表单加载事件：2010 年 8 月 14 日上午 10:40:29
> 表单 -已加载：2010 年 8 月 14 日上午 10:40:29
> 表单 - 创建控件：2010 年 8 月 14 日上午 10:40:29
> 表单 - OnActivated ：2010 年 8 月 14 日上午 10:40:29
> 表单 - 显示：8/ 2010 年 14 月 10:40:29 AM
> 表格 - OnPaint：2010 年 8 月 14 日上午 10:40:29
> 表格 - 无效：2010 年 8 月 14 日上午 10:40:29
> 表格 - OnPaint：2010 年 8 月 14 日 10：上午 40:29

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-29T08:33:16.253

`Shown`事件发生在事件之后`Load`。主要区别不在于表单的*可见性*，而在于其*状态*（宽度、高度等）。

为了澄清，这里有一个例子。考虑一个具有默认大小`100, 200`和 a`WindowState`的表单`Maximized`。在`Load`事件处理程序中，大小将为`100, 200`. 但在`Shown`事件处理程序中，尺寸将是您的*屏幕尺寸*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-29T05:54:03.470

好的，我想我已经弄清楚了现在到底发生了什么，以及我的困惑来自哪里（尽管不是*为什么*它会这样）。看起来 Shown 事件实际上发生*在*Load 事件中。

鉴于此代码：

```
 protected override OnLoad(EventArgs e)
{
    MessageBox.Show("Enter Load");
    base.OnLoad(e);
    MessageBox.Show("Exit Load");
}

protected override OnShown(EventArgs e)
{
    MessageBox.Show("Enter Shown");
    base.OnShown(e);
    MessageBox.Show("Exit Shown");
} 
```

然后消息按以下顺序显示：

1.  输入负载
2.  输入显示
3.  出口显示
4.  退出负载

Visible 属性在所有四种情况下都为 True，但在这些情况下，表单*都不*是在屏幕上实际可见（绘制）。

真正奇怪的是，如果我注释掉“Exit Load”消息框，那么在“Enter Shown”消息出现**之前，表单***就会*出现在屏幕上。它似乎是在基本 OnLoad 调用之后执行的代码，它确实以某种方式反对。

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T04:31:12.123

我肯定知道的一件事是在 InitializeComponent 上的所有内容都完成并且表单显示之后执行显示的事件，并且显示您应该根据其他对象的位置将移动对象的代码放在表单上

用一个空项目做一个快速测试：

```
Public Class Form1

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    MsgBox("load") 'form is still visible = false
End Sub

Private Sub Form1_Shown(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Shown
    MsgBox("shown") ' form is now visible = true
End Sub
End Class 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-29T04:50:04.770

我刚刚在 Shown 之前检查并加载了火灾。

你的方法显然有问题。

# python - 在 Python 中读取 .lnk 文件的目标？

> ID：397125
> 
> 赞同：37
> 
> 时间：2008-12-29T04:31:27.707
> 
> 标签：python, directory, shortcut, target, lnk

我正在尝试`.lnk`从 Python 读取快捷方式 ( ) 文件的目标文件/目录。有没有不头痛的方法呢？规格超出了我的想象。我不介意使用仅限 Windows 的 API。

`"(My) Videos"`我的最终目标是在 Windows XP 和 Vista 上找到该文件夹​​。在 XP 上，默认情况下，它是 at `%HOMEPATH%\My Documents\My Videos`，而在 Vista 上，它是`%HOMEPATH%\Videos`. 但是，用户可以重新定位此文件夹。在这种情况下，该`%HOMEPATH%\Videos`文件夹不再存在并被替换为`%HOMEPATH%\Videos.lnk`指向新文件夹的`"My Videos"`文件夹。我想要它的绝对位置。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-20T22:59:37.977

**使用 Python 创建快捷方式（通过 WSH）**

```
import sys
import win32com.client 

shell = win32com.client.Dispatch("WScript.Shell")
shortcut = shell.CreateShortCut("t:\\test.lnk")
shortcut.Targetpath = "t:\\ftemp"
shortcut.save() 
```

**使用 Python 读取快捷方式的目标（通过 WSH）**

```
import sys
import win32com.client 

shell = win32com.client.Dispatch("WScript.Shell")
shortcut = shell.CreateShortCut("t:\\test.lnk")
print(shortcut.Targetpath) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-03-09T21:55:13.263

我知道这是一个较旧的线程，但我觉得没有太多关于使用原始问题中所述的链接规范的方法的信息。

我的快捷方式目标实现无法使用 win32com 模块，经过大量搜索后，决定提出我自己的。在我的限制下，似乎没有其他东西可以完成我所需要的。希望这会帮助其他处于同样情况的人。

它使用微软为[MS-SHLLINK](http://msdn.microsoft.com/en-us/library/dd871305.aspx)提供的二进制结构。

```
import struct

path = 'myfile.txt.lnk'    
target = ''

with open(path, 'rb') as stream:
    content = stream.read()
    # skip first 20 bytes (HeaderSize and LinkCLSID)
    # read the LinkFlags structure (4 bytes)
    lflags = struct.unpack('I', content[0x14:0x18])[0]
    position = 0x18
    # if the HasLinkTargetIDList bit is set then skip the stored IDList 
    # structure and header
    if (lflags & 0x01) == 1:
        position = struct.unpack('H', content[0x4C:0x4E])[0] + 0x4E
    last_pos = position
    position += 0x04
    # get how long the file information is (LinkInfoSize)
    length = struct.unpack('I', content[last_pos:position])[0]
    # skip 12 bytes (LinkInfoHeaderSize, LinkInfoFlags, and VolumeIDOffset)
    position += 0x0C
    # go to the LocalBasePath position
    lbpos = struct.unpack('I', content[position:position+0x04])[0]
    position = last_pos + lbpos
    # read the string at the given position of the determined length
    size= (length + last_pos) - position - 0x02
    temp = struct.unpack('c' * size, content[position:position+size])
    target = ''.join([chr(ord(a)) for a in temp]) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-29T04:53:05.620

或者，您可以尝试使用[SHGetFolderPath()](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx)。以下代码可能有效，但我现在不在 Windows 机器上，因此无法对其进行测试。

```
import ctypes

shell32 = ctypes.windll.shell32

# allocate MAX_PATH bytes in buffer
video_folder_path = ctypes.create_string_buffer(260)

# 0xE is CSIDL_MYVIDEO
# 0 is SHGFP_TYPE_CURRENT
# If you want a Unicode path, use SHGetFolderPathW instead
if shell32.SHGetFolderPathA(None, 0xE, None, 0, video_folder_path) >= 0:
    # success, video_folder_path now contains the correct path
else:
    # error 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-29T04:44:23.003

基本上直接调用Windows API。这是谷歌搜索后发现的一个很好的例子：

```
import os, sys
import pythoncom
from win32com.shell import shell, shellcon

shortcut = pythoncom.CoCreateInstance (
  shell.CLSID_ShellLink,
  None,
  pythoncom.CLSCTX_INPROC_SERVER,
  shell.IID_IShellLink
)
desktop_path = shell.SHGetFolderPath (0, shellcon.CSIDL_DESKTOP, 0, 0)
shortcut_path = os.path.join (desktop_path, "python.lnk")
persist_file = shortcut.QueryInterface (pythoncom.IID_IPersistFile)
persist_file.Load (shortcut_path)

shortcut.SetDescription ("Updated Python %s" % sys.version)
mydocs_path = shell.SHGetFolderPath (0, shellcon.CSIDL_PERSONAL, 0, 0)
shortcut.SetWorkingDirectory (mydocs_path)

persist_file.Save (shortcut_path, 0) 
```

这是来自[http://timgolden.me.uk/python/win32_how_do_i/create-a-shortcut.html](http://timgolden.me.uk/python/win32_how_do_i/create-a-shortcut.html)。

您可以搜索“python ishelllink”以获取其他示例。

此外，API 参考也有帮助：http: [//msdn.microsoft.com/en-us/library/bb774950 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb774950(VS.85).aspx)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-04-19T00:37:09.843

我也意识到这个问题很老，但我发现答案与我的情况最相关。

像 Jared 的回答一样，我也无法使用 win32com 模块。所以 Jared 对[MS-SHLLINK](https://msdn.microsoft.com/en-us/library/dd871305.aspx)二进制结构的使用让我获得了成功。我需要在 Windows 和 Linux 上读取快捷方式，其中快捷方式是由 Windows 在 samba 共享上创建的。Jared 的实现不太适合我，我想只是因为我在快捷方式格式上遇到了一些不同的变化。但是，它给了我需要的开始（感谢 Jared）。

因此，这里有一个名为 MSShortcut 的类，它扩展了 Jared 的方法。但是，由于使用了Python3.4中添加的一些pathlib特性，实现只有Python3.4及以上

```
#!/usr/bin/python3

# Link Format from MS: https://msdn.microsoft.com/en-us/library/dd871305.aspx
# Need to be able to read shortcut target from .lnk file on linux or windows.
# Original inspiration from: http://stackoverflow.com/questions/397125/reading-the-target-of-a-lnk-file-in-python

from pathlib import Path, PureWindowsPath
import struct, sys, warnings

if sys.hexversion < 0x03040000:
    warnings.warn("'{}' module requires python3.4 version or above".format(__file__), ImportWarning)

# doc says class id = 
#    00021401-0000-0000-C000-000000000046
# requiredCLSID = b'\x00\x02\x14\x01\x00\x00\x00\x00\xC0\x00\x00\x00\x00\x00\x00\x46'
# Actually Getting: 
requiredCLSID   = b'\x01\x14\x02\x00\x00\x00\x00\x00\xC0\x00\x00\x00\x00\x00\x00\x46'  # puzzling

class ShortCutError(RuntimeError):
    pass

class MSShortcut():
    """
    interface to Microsoft Shortcut Objects.  Purpose:
    - I need to be able to get the target from a samba shared on a linux machine
    - Also need to get access from a Windows machine.
    - Need to support several forms of the shortcut, as they seem be created differently depending on the 
      creating machine.
    - Included some 'flag' types in external interface to help test differences in shortcut types

    Args:
        scPath (str): path to shortcut

    Limitations:
        - There are some omitted object properties in the implementation. 
          Only implemented / tested enough to recover the shortcut target information. Recognized omissions:
          - LinkTargetIDList
          - VolumeId structure (if captured later, should be a separate class object to hold info)
          - Only captured environment block from extra data 
        - I don't know how or when some of the shortcut information is used, only captured what I recognized, 
          so there may be bugs related to use of the information
        - NO shortcut update support (though might be nice)
        - Implementation requires python 3.4 or greater
        - Tested only with Unicode data on a 64bit little endian machine, did not consider potential endian issues

    Not Debugged:
        - localBasePath - didn't check if parsed correctly or not.
        - commonPathSuffix
        - commonNetworkRelativeLink

    """

    def __init__(self, scPath):
        """
        Parse and keep shortcut properties on creation
        """
        self.scPath = Path(scPath)

        self._clsid = None
        self._lnkFlags = None
        self._lnkInfoFlags = None
        self._localBasePath = None
        self._commonPathSuffix = None
        self._commonNetworkRelativeLink = None
        self._name = None
        self._relativePath = None
        self._workingDir = None
        self._commandLineArgs = None
        self._iconLocation = None
        self._envTarget = None

        self._ParseLnkFile(self.scPath)  

    @property
    def clsid(self): 
        return self._clsid

    @property
    def lnkFlags(self): 
        return self._lnkFlags

    @property
    def lnkInfoFlags(self): 
        return self._lnkInfoFlags

    @property
    def localBasePath(self): 
        return self._localBasePath

    @property
    def commonPathSuffix(self): 
        return self._commonPathSuffix

    @property
    def commonNetworkRelativeLink(self): 
        return self._commonNetworkRelativeLink

    @property
    def name(self): 
        return self._name    

    @property
    def relativePath(self): 
        return self._relativePath    

    @property
    def workingDir(self): 
        return self._workingDir    

    @property
    def commandLineArgs(self): 
        return self._commandLineArgs    

    @property
    def iconLocation(self): 
        return self._iconLocation    

    @property
    def envTarget(self): 
        return self._envTarget    

    @property
    def targetPath(self):
        """
        Args:
            woAnchor (bool): remove the anchor (\\server\path or drive:) from returned path.

        Returns:
            a libpath PureWindowsPath object for combined workingDir/relative path
            or the envTarget

        Raises:
            ShortCutError when no target path found in Shortcut
        """
        target = None
        if self.workingDir:
            target = PureWindowsPath(self.workingDir)
            if self.relativePath:
                target = target / PureWindowsPath(self.relativePath)
            else: target = None

        if not target and self.envTarget:
            target = PureWindowsPath(self.envTarget)

        if not target:
            raise ShortCutError("Unable to retrieve target path from MS Shortcut: shortcut = {}"
                               .format(str(self.scPath)))  

        return target    

    @property
    def targetPathWOAnchor(self):
        tp = self.targetPath
        return tp.relative_to(tp.anchor)

    def _ParseLnkFile(self, lnkPath):        
        with lnkPath.open('rb') as f:
            content = f.read()

            # verify size  (4 bytes)
            hdrSize = struct.unpack('I', content[0x00:0x04])[0]
            if hdrSize != 0x4C:
                raise ShortCutError("MS Shortcut HeaderSize = {}, but required to be = {}: shortcut = {}"
                                   .format(hdrSize, 0x4C, str(lnkPath)))

            # verify LinkCLSID id (16 bytes)            
            self._clsid = bytes(struct.unpack('B'*16, content[0x04:0x14]))
            if self._clsid != requiredCLSID:
                raise ShortCutError("MS Shortcut ClassID = {}, but required to be = {}: shortcut = {}"
                                   .format(self._clsid, requiredCLSID, str(lnkPath)))        

            # read the LinkFlags structure (4 bytes)
            self._lnkFlags = struct.unpack('I', content[0x14:0x18])[0]
            #logger.debug("lnkFlags=0x%0.8x" % self._lnkFlags)
            position = 0x4C

            # if HasLinkTargetIDList bit, then position to skip the stored IDList structure and header
            if (self._lnkFlags & 0x01):
                idListSize = struct.unpack('H', content[position:position+0x02])[0]
                position += idListSize + 2

            # if HasLinkInfo, then process the linkinfo structure  
            if (self._lnkFlags & 0x02):
                (linkInfoSize, linkInfoHdrSize, self._linkInfoFlags, 
                 volIdOffset, localBasePathOffset, 
                 cmnNetRelativeLinkOffset, cmnPathSuffixOffset) = struct.unpack('IIIIIII', content[position:position+28])

                # check for optional offsets
                localBasePathOffsetUnicode = None
                cmnPathSuffixOffsetUnicode = None
                if linkInfoHdrSize >= 0x24:
                    (localBasePathOffsetUnicode, cmnPathSuffixOffsetUnicode) = struct.unpack('II', content[position+28:position+36])

                #logger.debug("0x%0.8X" % linkInfoSize)
                #logger.debug("0x%0.8X" % linkInfoHdrSize)
                #logger.debug("0x%0.8X" % self._linkInfoFlags)
                #logger.debug("0x%0.8X" % volIdOffset)
                #logger.debug("0x%0.8X" % localBasePathOffset)
                #logger.debug("0x%0.8X" % cmnNetRelativeLinkOffset)
                #logger.debug("0x%0.8X" % cmnPathSuffixOffset)
                #logger.debug("0x%0.8X" % localBasePathOffsetUnicode)
                #logger.debug("0x%0.8X" % cmnPathSuffixOffsetUnicode)

                # if info has a localBasePath
                if (self._linkInfoFlags & 0x01):
                    bpPosition = position + localBasePathOffset

                    # not debugged - don't know if this works or not
                    self._localBasePath = UnpackZ('z', content[bpPosition:])[0].decode('ascii')
                    #logger.debug("localBasePath: {}".format(self._localBasePath))

                    if localBasePathOffsetUnicode:
                        bpPosition = position + localBasePathOffsetUnicode
                        self._localBasePath = UnpackUnicodeZ('z', content[bpPosition:])[0]
                        self._localBasePath = self._localBasePath.decode('utf-16')               
                        #logger.debug("localBasePathUnicode: {}".format(self._localBasePath))

                # get common Path Suffix
                cmnSuffixPosition = position + cmnPathSuffixOffset               
                self._commonPathSuffix = UnpackZ('z', content[cmnSuffixPosition:])[0].decode('ascii')
                #logger.debug("commonPathSuffix: {}".format(self._commonPathSuffix))
                if cmnPathSuffixOffsetUnicode:
                    cmnSuffixPosition = position + cmnPathSuffixOffsetUnicode
                    self._commonPathSuffix = UnpackUnicodeZ('z', content[cmnSuffixPosition:])[0]
                    self._commonPathSuffix = self._commonPathSuffix.decode('utf-16')               
                    #logger.debug("commonPathSuffix: {}".format(self._commonPathSuffix))

                # check for CommonNetworkRelativeLink
                if (self._linkInfoFlags & 0x02):
                    relPosition = position + cmnNetRelativeLinkOffset
                    self._commonNetworkRelativeLink = CommonNetworkRelativeLink(content, relPosition)

                position += linkInfoSize 

            # If HasName
            if (self._lnkFlags & 0x04):
                (position, self._name) = self.readStringObj(content, position)
                #logger.debug("name: {}".format(self._name))     

            # get relative path string
            if (self._lnkFlags & 0x08):
                (position, self._relativePath) = self.readStringObj(content, position)
                #logger.debug("relPath='{}'".format(self._relativePath))

            # get working dir string
            if (self._lnkFlags & 0x10):
                (position, self._workingDir) = self.readStringObj(content, position)
                #logger.debug("workingDir='{}'".format(self._workingDir))

            # get command line arguments
            if (self._lnkFlags & 0x20):
                (position, self._commandLineArgs) = self.readStringObj(content, position)
                #logger.debug("commandLineArgs='{}'".format(self._commandLineArgs))

            # get icon location
            if (self._lnkFlags & 0x40):
                (position, self._iconLocation) = self.readStringObj(content, position)
                #logger.debug("iconLocation='{}'".format(self._iconLocation))

            # look for environment properties             
            if (self._lnkFlags & 0x200):
                while True:
                    size = struct.unpack('I', content[position:position+4])[0]
                    #logger.debug("blksize=%d" % size)
                    if size==0: break

                    signature = struct.unpack('I', content[position+4:position+8])[0]
                    #logger.debug("signature=0x%0.8x" % signature)     

                    # EnvironmentVariableDataBlock          
                    if signature == 0xA0000001:  

                        if (self._lnkFlags & 0x80): # unicode
                            self._envTarget = UnpackUnicodeZ('z', content[position+268:])[0]
                            self._envTarget = self._envTarget.decode('utf-16')
                        else:
                            self._envTarget = UnpackZ('z', content[position+8:])[0].decode('ascii')

                        #logger.debug("envTarget='{}'".format(self._envTarget))

                    position += size

    def readStringObj(self, scContent, position):
        """ 
        returns:
            tuple: (newPosition, string)
        """
        strg = ''
        size = struct.unpack('H', scContent[position:position+2])[0]
        #logger.debug("workingDirSize={}".format(size))
        if (self._lnkFlags & 0x80): # unicode
            size *= 2
            strg = struct.unpack(str(size)+'s', scContent[position+2:position+2+size])[0]
            strg = strg.decode('utf-16')               
        else:
            strg = struct.unpack(str(size)+'s', scContent[position+2:position+2+size])[0].decode('ascii')
        #logger.debug("strg='{}'".format(strg))
        position += size + 2 # 2 bytes to account for CountCharacters field

        return (position, strg)

class CommonNetworkRelativeLink():

    def __init__(self, scContent, linkContentPos):

        self._networkProviderType = None
        self._deviceName = None
        self._netName = None

        (linkSize, flags, netNameOffset, 
         devNameOffset, self._networkProviderType) = struct.unpack('IIIII', scContent[linkContentPos:linkContentPos+20])

        #logger.debug("netnameOffset = {}".format(netNameOffset))
        if netNameOffset > 0x014:
            (netNameOffsetUnicode, devNameOffsetUnicode) = struct.unpack('II', scContent[linkContentPos+20:linkContentPos+28])
            #logger.debug("netnameOffsetUnicode = {}".format(netNameOffsetUnicode))
            self._netName = UnpackUnicodeZ('z', scContent[linkContentPos+netNameOffsetUnicode:])[0]
            self._netName = self._netName.decode('utf-16')  
            self._deviceName = UnpackUnicodeZ('z', scContent[linkContentPos+devNameOffsetUnicode:])[0]
            self._deviceName = self._deviceName.decode('utf-16')               
        else:
            self._netName = UnpackZ('z', scContent[linkContentPos+netNameOffset:])[0].decode('ascii')
            self._deviceName = UnpackZ('z', scContent[linkContentPos+devNameOffset:])[0].decode('ascii')

    @property    
    def deviceName(self):
        return self._deviceName

    @property    
    def netName(self):
        return self._netName

    @property    
    def networkProviderType(self):
        return self._networkProviderType

def UnpackZ (fmt, buf) :
    """
    Unpack Null Terminated String
    """
    #logger.debug(bytes(buf))

    while True :
        pos = fmt.find ('z')
        if pos < 0 :
            break
        z_start = struct.calcsize (fmt[:pos])
        z_len = buf[z_start:].find(b'\0')
        #logger.debug(z_len)
        fmt = '%s%dsx%s' % (fmt[:pos], z_len, fmt[pos+1:])
        #logger.debug("fmt='{}', len={}".format(fmt, z_len))
    fmtlen = struct.calcsize(fmt)
    return struct.unpack (fmt, buf[0:fmtlen])

def UnpackUnicodeZ (fmt, buf) :
    """
    Unpack Null Terminated String
    """
    #logger.debug(bytes(buf))
    while True :
        pos = fmt.find ('z')
        if pos < 0 :
            break
        z_start = struct.calcsize (fmt[:pos])
        # look for null bytes by pairs
        z_len = 0
        for i in range(z_start,len(buf),2):
            if buf[i:i+2] == b'\0\0':
                z_len = i-z_start
                break

        fmt = '%s%dsxx%s' % (fmt[:pos], z_len, fmt[pos+1:])
       # logger.debug("fmt='{}', len={}".format(fmt, z_len))
    fmtlen = struct.calcsize(fmt)
    return struct.unpack (fmt, buf[0:fmtlen]) 
```

我希望这对其他人也有帮助。谢谢

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-06-18T21:14:22.560

我真的不喜欢任何可用的答案，因为我不想继续导入越来越多的库，而且我的测试机器上的“shell”选项参差不齐。我选择读取“.lnk”，然后使用正则表达式读出路径。出于我的目的，我正在寻找最近打开的 pdf 文件，然后阅读这些文件的内容：

```
# Example file path to the shortcut
shortcut = "shortcutFileName.lnk"

# Open the lnk file using the ISO-8859-1 encoder to avoid errors for special characters
lnkFile = open(shortcut, 'r', encoding = "ISO-8859-1")

# Use a regular expression to parse out the pdf file on C:\
filePath = re.findall("C:.*?pdf", lnkFile.read(), flags=re.DOTALL)

# Close File
lnkFile.close()

# Read the pdf at the lnk Target
pdfFile = open(tmpFilePath[0], 'rb') 
```

### 评论：

显然这适用于`pdf`但需要相应地指定其他文件扩展名。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-08T02:48:53.783

打开“.exe”文件很容易。在这里，我们也将为此使用该`os`模块。您只需创建一个快捷方式`.lnk`并将其存储在您选择的任何文件夹中。然后，在任何 Python 文件中，首先导入`os`模块（已经安装，只需导入）。然后，使用一个变量，比如`path`，并为其分配一个包含`.lnk`文件位置的字符串值。只需创建所需应用程序的快捷方式。最后，我们将使用`os.startfile()` 打开我们的快捷方式。

要记住的要点：

1.  该位置应在双引号内。
2.  最重要的是，打开属性。然后，在此之下，打开“详细信息”。在那里，您可以获得快捷方式的确切名称。最后请用“.lnk”写下那个名字。

现在，您已完成该过程。我希望它对你有帮助。如需更多帮助，我将在底部留下我的代码。

```
import os

path = "C:\\Users\\hello\\OneDrive\\Desktop\\Shortcuts\\OneNote for Windows 10.lnk"

os.startfile(path) 
```

在我的代码中，我用作`path`变量，并为 OneNote 创建了一个快捷方式。在路径中，我定义了 OneNote 快捷方式的位置。所以当我使用时`os.startfile(path)`，`os`模块将打开我在变量路径中定义的快捷方式文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-23T08:05:51.473

这项工作可以在没有任何模块的情况下完成，这样做将返回具有快捷方式文件目标的 ab 字符串。基本上你所做的就是以读取二进制模式（`rb`模式）打开文件。这是完成此任务的代码：

```
with open('programs.lnk - Copy','rb') as f:
    destination=f.read() 
```

我目前正在使用 python 3.9.2，如果您遇到此问题，请告诉我，我会尝试修复它。

# c++ - 从 Excel 向应用程序发送命令？通讯？

> ID：397128
> 
> 赞同：1
> 
> 时间：2008-12-29T04:35:25.673
> 
> 标签：c++, excel, com, real-time-data

我编写了一个设备控制器（rs232）并且它正在成功使用，但是用户希望从 Excel 中查看数据并控制设备（或者可能通过我的程序进行通信）。我放弃了 DDE 作为一个选项，并发现 RTD (IRtdServer) 可能是一个好的开始（尽管无法从实时数据客户端将数据发送回“服务器”）。

我为 RTD 部分找到了这些资源：http: [//support.microsoft.com/](http://support.microsoft.com/?id=327215) ?id=327215 和 [http://support.microsoft.com/?id=327215](http://support.microsoft.com/?id=327215)

这是一个多线程应用程序，我已经添加了在 com 端口上拥有多个侦听器的功能，以便我可以更新多个客户端。我将COM接口添加到EXE。

但是在那之后我需要的是某种方式来控制我的应用程序/通过 Excel 中的应用程序到设备的代理命令。

最好的方法是什么？

也许是另一个 COM 接口并从 VBA 或其他东西调用它？我不熟悉使用 Excel 中的脚本，所以也许有人可以提供示例代码或链接来显示 COM 对象的代码和随附的 VB(A?) 代码？

请记住，这是一个非托管 C++ 应用程序，现在无法转换为托管或 C#。也欢迎使用 C# 的替代方案，但这是一个长期的重写。

谢谢

编辑我有另一种方法可以将 COM 支持添加到现有的 EXE 中。我认为添加双向通信更灵活（跨平台 - 可能是 boost 或 corba，或者只是基于我自己的消息协议的直接 IP）

一个（或两个）COM 服务器可以封装该通信通道——不管它是什么。这并没有真正影响我的问题——我仍然想知道从 Excel 控制外部 EXE 的选项。

编辑不必向客户推出 .NET 也是一大优势。其中许多设备都在相当旧的 PC 上，并且可能带有 NT 或 XP，我不喜欢将我的安装/安装包从 700KB 增加到荒谬的 .NET 安装大小......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T04:52:55.513

**选项1：**

创建一个小型 COM 服务器 - 确保其接口适合使用 Excel 中内置的 Visual Basic 引擎编写脚本。（例如使用简单类型和 BSTRS）。

编写 Excel VB 宏以 (1) 将您自己的工具栏添加到 excel 和 (2) 调用您的 COM 服务器。

您还可以将按钮和其他 UI 元素添加到工作表并将它们连接到 VB 宏。

**选项#2：**

我意识到您不想使用 C# - 但是使用 Visual Studio Tools for Office (VSTO) 在 C# 中自动化办公和与 COM 对象对话真的非常容易。你真的应该考虑这个选项 - 如果做得正确，它不应该意味着重写你现有的任何代码。只需使用 C# 和 VSTO 作为 Excel 和 RTD 服务器之间的桥梁。与 VB 一样，直接将 Excel 中的 UI 元素连接到 C#，然后连接到您的 RTD 服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T04:53:21.610

从 VBA 调用 COM 对象很简单。这个[SO Question 和 my answer](https://stackoverflow.com/questions/170070/what-are-the-differences-between-using-the-new-keyword-and-calling-createobject#170084)提供了一个如何创建 COM 对象的示例。调用暴露的方法正如你所期望的那样：

```
object.ExposedMethod(optional params...); 
```

# php - PHP从另一个文件中的函数返回

> ID：397142
> 
> 赞同：0
> 
> 时间：2008-12-29T04:50:38.450
> 
> 标签：php, return

我有一个名为 User 的类，带有静态函数 loginRequired()，如果用户已登录，则返回 false，如果用户已注销，则返回 true。它还将一个错误附加到我创建的错误类中，告诉使用该站点的人他们必须登录才能查看内容。

我们的想法是，对于需要用户登录的每个功能的顶部，我们编写以下代码：

```
if(User::loginRequired()) return; 
```

它将输出错误并立即从函数返回。但是，我宁愿这样做：

```
User::loginRequired(); 
```

并从 loginRequired 函数内部的调用函数返回......但是因为 loginRequired() 位于单独文件中的单独类中，所以这不起作用。是否可以在 loginRequired() 中从调用 loginRequired() 的函数返回？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T05:06:09.057

我不确定您是否可以完全按照自己的意愿做，但是，您可能想看看使用[exceptions](http://us2.php.net/exceptions)。这将允许您在 User::loginRequired 函数中引发异常并在更高级别捕获它。您还可以查看使用[exit()](http://us3.php.net/exit) PHP 函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T05:19:54.303

我看到许多开源应用程序处理这个问题的方式是通过一个`require_login()`函数在用户未登录时执行重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T05:31:14.390

实际页面中的内容是动态的吗？我的意思是，我是否需要进行身份验证才能看到登录页面以外的任何内容，还是在我登录时看到一些东西，而在我没有登录时看到其他东西等等？因为如果服务器的整个目录/部分都在登录屏幕后面，您可以在目录的 .htaccess 文件中添加一些内容，以重定向未登录的任何人等。

另一方面，您可以将保存登录状态的文件包含在用户正在查看的任何页面/脚本中，包含的文件仅返回登录状态而不是其全部内容。这在示例 5 下的[包含](http://us2.php.net/include/)中进行了介绍，“include() 和 return() 语句”。如果你这样做，你可以使用三元条件，如：

```
$logged_in = (include('userlogin.php') == TRUE) ? TRUE : FALSE; 
```

然后在每个受保护的函数中都有类似的内容：

```
global $logged_in; 
```

您仍然坚持使用包含整个函数的 IF 子句，但至少您拥有登录状态。如果你想摆脱函数内部的 IF，你总是可以使调用函数成为有条件的。像：

```
$content = ($logged_in == TRUE) ? some_function() : redirect_User(); 
```

话又说回来，我两个月前才开始学习这些东西，但仍然不了解类和对象，所以我可能会离谱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T17:05:58.620

OT：如果您描述的目的是唯一的，我会考虑将方法的名称更改为 isLoggedIn()。一个名为 loginRequired() 的方法会更好地保护机密内容。

# hibernate - Grails eager fetch 不会检索所有数据

> ID：397145
> 
> 赞同：2
> 
> 时间：2008-12-29T04:52:55.497
> 
> 标签：hibernate, grails

我有域类：

```
class Person {
    static hasMany = [ items: Item ]
    static fetchMode = [ items: 'eager'  ]
    String name
    Set items
}
class Item {
    static belongsTo = [ owner: Person ]
    String name
} 
```

如果我留`static fetchMode = [ items: 'eager' ]`在原地，那么调用`getItems()`只会返回大约 10% 的项目。如果我删除 fetchMode，则`getItems()`返回所有项目。知道为什么 Eager fetch 会导致检索不到所有存储的数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T02:05:09.253

据[grails.org 报道](http://jira.grails.org/browse/GRAILS-995)， 2011 年 2 月，这已被确定为 Grails 1.04 中的一个[错误](http://www.blueleftistconstructor.com/2011/10/12/grails-broken-list-on-domain-object-fetchmode-eager-wait-no-join/)。截至 2012 年 7 月，该错误被列为已关闭，因此问题应该得到解决。

# python - 为什么 Python 没有多行注释？

> ID：397148
> 
> 赞同：274
> 
> 时间：2008-12-29T04:53:17.070
> 
> 标签：python, comments, multiline

好的，我知道三引号字符串可以用作多行注释。例如，

```
"""Hello, I am a 
   multiline comment""" 
```

和

```
'''Hello, I am a 
   multiline comment''' 
```

但从技术上讲，这些是字符串，对吗？

我已经用谷歌搜索并阅读了 Python 样式指南，但我无法找到关于为什么没有正式实现多行、/* */ 注释类型的技术答案。我使用三引号没有问题，但我有点好奇是什么导致了这个设计决定。

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2008-12-29T05:06:00.727

我怀疑你会得到比“Guido 觉得不需要多行注释”更好的答案。

Guido 曾在[推特](https://twitter.com/gvanrossum/status/112670605505077248)上发表过这样的评论：

> Python 提示：您可以使用多行字符串作为多行注释。除非用作文档字符串，否则它们不会生成任何代码！:-)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-12-29T15:44:08.537

多行注释很容易被破坏。如果您在一个简单的计算器程序中有以下内容怎么办？

```
operation = ''
print("Pick an operation:  +-*/")
# Get user input here 
```

尝试用多行注释来评论它：

```
/*
operation = ''
print("Pick an operation:  +-*/")
# Get user input here
*/ 
```

糟糕，您的字符串包含结束注释分隔符。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-12-29T14:16:05.953

三引号文本不应被视为多行注释；按照惯例，它们是[docstrings](http://www.python.org/dev/peps/pep-0257/#rationale)。他们应该描述你的代码做什么以及如何使用它，而不是像注释掉代码块这样的事情。

根据 Guido 的说法，[Python 中的多行注释只是连续的单行注释](http://www.python.org/dev/peps/pep-0008/)（搜索“块注释”）。

为了注释代码块，我有时使用以下模式：

```
if False:
    # A bunch of code 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2008-12-29T05:04:11.167

这可能会回到核心概念，即应该有一种明显的方式来完成一项任务。额外的注释样式会增加不必要的复杂性，并可能降低可读性。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-29T05:05:00.450

好吧，三引号用作文档字符串中的多行注释。并且 # 注释用作内联注释，人们习惯了它。

大多数脚本语言也没有多行注释。也许这就是原因？

参见[PEP 0008](http://www.python.org/dev/peps/pep-0008/)，*注释部分*

看看你的 Python 编辑器是否提供了一些用于块注释的键盘快捷键。Emacs 和 Eclipse 都支持它，大概大多数像样的 IDE 都支持。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-29T16:18:23.820

来自[Python 之禅](http://www.python.org/dev/peps/pep-0020/)：

应该有一种——最好只有一种——明显的方法来做到这一点。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-04-06T20:02:59.407

要在[Pycharm](https://www.jetbrains.com/pycharm/help/commenting-and-uncommenting-blocks-of-code.html) IDE 中注释掉一段代码：

*   代码 | 带行注释的注释
*   Windows 或 Linux：`Ctrl`+`/`
*   操作系统：`Command`+`/`

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-29T16:27:01.320

就我个人而言，我在说 Java 时的评论风格就像

```
/*
 * My multi-line comment in Java
 */ 
```

所以如果你的风格是前面例子的典型风格，那么只有单行注释并不是一件坏事，因为相比之下你会有

```
#
# My multi-line comment in Python
# 
```

VB.NET 也是一种只有单行评论的语言，我个人觉得这很烦人，因为评论最终看起来不像是喜欢的评论，而更像是某种引用

```
'
' This is a VB.NET example
' 
```

单行注释最终比多行注释使用更少的字符，并且可能不太可能被正则表达式语句中的一些狡猾的字符转义？不过，我倾向于同意内德的观点。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-29T15:17:54.503

```
# This
# is
# a 
# multi-line
# comment 
```

在您的编辑器中使用注释块或搜索和替换 (s/^/#/g) 来实现此目的。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-11-15T09:54:37.933

我通过为我的文本编辑器 (TextPad) 下载一个宏来解决这个问题，它可以让我突出显示行，然后在每行的第一行插入 #。一个类似的宏删除了#。有些人可能会问为什么多行是必要的，但当您尝试“关闭”一段代码以进行调试时，它会派上用场。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-07-18T12:49:39.963

对于在 Python 中寻找多行注释的任何其他人 - 使用三引号格式可能会产生一些问题，因为我刚刚学会了艰难的方法。考虑一下：

```
this_dict = {
    'name': 'Bob',

"""
This is a multiline comment in the middle of a dictionary
"""

    'species': 'Cat'
} 
```

多行注释将被塞进下一个字符串，弄乱了 `'species'`键。最好只`#`用于评论。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-10-12T14:37:10.920

做一件事应该只有一种方法，这与使用多行字符串和单行字符串或 switch/case 以及不同形式的循环相矛盾。

多行注释是一个非常常见的功能，让我们面对现实吧，多行字符串注释是一种带有负面影响的 hack！我已经看到很多代码在使用多行注释技巧，甚至编辑器也使用它。

但我猜每种语言都有它的怪癖，开发者坚持从不修复它。我也知道 java 方面的这些怪癖，自 90 年代后期以来一直开放，永远不会被修复！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-29T05:35:39.730

假设它们只是被认为是不必要的。由于只需键入非常容易，因此`#a comment`多行注释可以只包含许多单行注释。

另一方面，对于[HTML ，更需要多线程。](http://en.wikipedia.org/wiki/HTML)继续打字更难`<!--comments like this-->`。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-29T05:38:01.223

这只是一个猜测..但是

因为它们是字符串，所以它们具有一些语义价值（编译器不会删除它们），因此将它们用作文档字符串是有意义的。它们实际上成为[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)的一部分，因此提取文档变得更容易。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-29T06:01:33.953

因为# 约定是一个常见的约定，并且对于多行注释确实没有什么可以用#-sign 注释做的。这是一个历史性的意外，就像`/* ... */`评论的祖先可以追溯到 PL/I，

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-29T16:28:12.333

此外，[多行注释是个婊子](http://en.wikipedia.org/wiki/Amores_perros)。很抱歉，但不管是哪种语言，除了调试目的之外，我不会将它们用于任何其他目的。假设你有这样的代码：

```
void someFunction()
{
    Something
    /*Some comments*/
    Something else
} 
```

然后你发现你的代码中有一些东西你不能用调试器修复，所以你开始手动调试它，用这些多行注释注释掉越来越小的代码块。这将给出函数：

```
void someFunction()
{ /*
    Something
   /* Comments */
   Something more*/
} 
```

这真的很烦人。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-10-04T01:45:06.883

**[使用IDLE](http://en.wikipedia.org/wiki/IDLE_%28Python%29)**的多行注释：

*   **Mac OS X**，在代码选择之后，使用 + 注释代码块`Ctrl`并`3`使用`Ctrl`+取消注释`4`。

*   **Windows**，在代码选择后，用`Ctrl`++注释代码块并使用`Alt`++取消注释。`3``Ctrl``At``4`

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2011-06-19T14:27:14.870

我记得读过一个人将他的多行评论放入三引号变量中：

```
x = '''
This is my
super-long mega-comment.
Wow there are a lot of lines
going on here!
''' 
```

这确实占用了一些内存，但它为您提供了多行注释功能，而且大多数编辑器会为您突出显示语法:)

通过简单地包装代码也很容易注释掉代码

```
x = ''' 
```

和

```
''' 
```

# c++ - 使用 memset 初始化指针元素的二维数组

> ID：397153
> 
> 赞同：1
> 
> 时间：2008-12-29T04:57:56.267
> 
> 标签：c++, arrays, memset

我有这些结构定义

```
typedef struct my_s {
   int x;
   int y;
} my_T;

typedef struct your_s {
    my_T * x;
} your_T;

your_T array[MAX_COL][MAX_ROW]; 
```

要将数组的指针初始化为 NULL，我可以这样做：

```
memset (array, 0, sizeof(array)) 
```

这对我来说不合适。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T05:06:06.467

最简单的是

```
your_T array[MAX_COL][MAX_ROW] = {{{0}}}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T05:08:22.657

```
typedef struct my_s {
   int x;
   int y;
} my_T;

typedef struct your_s {
    my_T * x;
} your_T;

your_T array[MAX_COL][MAX_ROW]; 
```

您不能使用 memset 将 your_T 的指针初始化为空，因为没有指定空指针的位模式全部由空位组成。但是你可以像这样创建你的数组：

```
your_T array[MAX_COL][MAX_ROW] = {{}}; 
```

元素将被默认初始化，这意味着对于指针，该指针将包含一个空指针值。如果您的阵列是全球性的，您甚至不必关心。这将默认发生。

# javascript - 内容宽度未知的 jCarousel

> ID：397184
> 
> 赞同：3
> 
> 时间：2008-12-29T05:29:52.130
> 
> 标签：javascript, jquery, jquery-plugins, jcarousel

我正在尝试为 jQuery 使用 jCarousel 插件，以便为我的网站用户提供可滚动（水平）的内容。

我提到的内容基本上是用户定义`<li>`的元素，其样式使它们具有标签的感觉和外观。所以基本上我正在尝试实现与 pageflakes.com 中的选项卡相同的效果。正如您可能想象的那样，用户正在自己创建选项卡并提供选项卡名称。

jCarousel 需要您为内容指定固定宽度，例如，它们的所有示例都基于具有固定高度和宽度的图像。但在我的情况下，我无法控制用户将他/她的标签命名为什么......这让我无法猜测总容器 div 的宽度。

我尝试使用一种愚蠢的方法，例如以编程方式猜测宽度，假设每个字母大约为 5 个像素，并将 5 乘以它们作为选项卡名称给出的单词的长度。即使在这种情况下，我也需要动态操作 css 文件，我不知道该怎么做，即使这样做是可行的..

任何解决方案表示赞赏...

```
<lu>
<li class='MyTab' id='578'>This is my tab</li>
<li class='MyTab' id='579'>of which I can</li>
<li class='MyTab' id='580'>never guess</li>
<li class='MyTab' id='581'><img src='img/bullet_key.png' /> The length of</li>
</lu> 
```

上面的 html 是通过 ajax_tabs_output.aspx 以编程方式生成的，加载到一个 javascript 数组中，而 jCarousel 负责其余的工作。

```
 function outputTabsArray() {
        $.ajax({
            url: 'ajax_tabs_output.aspx', 
            type: 'get', 
            data: 'q=array', 
            async: false, 
            success: function(out) 
                {
                    tabs_array = out;
                } 
            });
            }// end outputTabsArray

        function mycarousel_itemLoadCallback(carousel, state)
        {
            for (var i = carousel.first; i <= carousel.last; i++) {
                if (carousel.has(i)) {
                    continue;
                }

                if (i > tabs_array.length) {
                    break;
                }

                carousel.add(i, mycarousel_getItemHTML(tabs_array[i-1]));
            }
        };

        /**
         * Item html creation helper.
         */
        function mycarousel_getItemHTML(item)
        {
            return '<div class="MyTab" id="' + item.tab_id + "'>" + item.tab_name + '</div>';
        };

            $('#mycarousel').jcarousel({
                size: tabs_array.length,
                itemLoadCallback: {onBeforeAnimation: mycarousel_itemLoadCallback}
        }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-03T00:44:13.877

最接近您想要的可能是[jscrollhorizo​​ntalpane](http://plugins.jquery.com/project/jscrollhorizontalpane)。我从来没有使用过它，所以我不能保证它作为这个特定问题的解决方案的有效性。

如果您想尝试，这种小部件不应该很难制作。我将分解我将使用的近似方法：

**确保使用大量的包装纸。**

```
<div class="scrollable">
  <div class="window">
    <div class="space">
      <ul class="tabs">
        <li class="tab">...</li>
        <li class="tab">...</li>
        <li class="tab">...</li>
      </ul>
    </div>
  </div>
  <a href="#" class="left">&larr;</a>
  <a href="#" class="right">&rarr;</a>
</div> 
```

我们要做的是在“ *window* ”元素内来回移动“ *space* ”元素。这可以通过设置为“ *window* ”和 “ *space* ”然后将其转换为 using 来完成，但我将使用该属性。*`position:relative`*`position:absolute`*`left:-??px``scrollLeft`***

 *****添加一些CSS。**

```
.window {
  overflow : hidden;
  width : 100%;
}
.space {
  width : 999em;      /* lots of space for tabs */
  overflow : hidden;  /* clear floats */
}
.tabs {
  float : left;       /* shrink so we can determine tabs width */
}
.tab {
  float : left;       /* line tabs up */
} 
```

这只是该技术所需的基本内容。其中一些东西可以由 jQuery 应用，

**添加事件以调整窗口大小。**

```
$(window)
  .resize(function () {
    var sz = $('.window');
    var ul = sz.find('ul');
    if ( sz.width() < ul.width() ) {
      $('.scrollable a.left, .scrollable a.right').show();
    }
    else {
      $('.scrollable a.left, .scrollable a.right').hide();
    }
  })
  .trigger('resize'); 
```

**将事件添加到滚动按钮。**

```
$('.scrollable a.left').hover(
  function (e) {
    var sz = $('.window');
    sz.animate({ scrollLeft : 0 }, 1000, 'linear');
  },
  function (e) {
    $('.window').stop();
  });

$('.scrollable a.right').hover(
  function (e) {
    var sz = $('.window');
    var margin = sz.find('ul').width() - sz.width();
    sz.animate({ scrollLeft : margin }, 1000, 'linear');
  },
  function (e) {
    $('.window').stop();
  }); 
```

完毕！

宽度也可以通过遍历“ *tab* ”元素并求和 upp来计算`outerWidth`。如果您有完全控制权，这是不必要的，但对于完整的独立插件可能是更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T07:22:58.267

据我所知，您正在尝试让 JCarousel 做一些它从未设计过的事情。根据我在[JCarousel 网站](http://sorgalla.com/jcarousel/)上阅读的内容，它似乎是一个图像旋转器。

听起来你想要的是一个选项卡式界面。有关如何实现它的演示和文档，请参阅[JQuery UI 选项卡。](http://stilbuero.de/jquery/tabs_3/)

如果我完全错了，并且您正在寻找的只是有关如何执行正确的 CSS 选项卡的教程，请查看：

[http://unraveled.com/projects/css_tabs/](http://unraveled.com/projects/css_tabs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T07:47:56.923

苏维埃，

你其实很对！我试图让 JCarousel 做一些它不是为之设计的事情。

但是，我也不想使用选项卡插件或任何类似的东西，因为我需要完全控制我的输出。例如在需要时将更多元素注入选项卡，例如双击，加载和许多其他等。

实际上，我正在寻找一种方法来水平滚动 div 内的内容，左右箭头.. 更准确地说，我需要与[www.pageflakes.com中看到的选项卡完全相同的结构](http://www.pageflakes.com)

用户将能够通过单击链接（或任何其他元素）来创建选项卡，他们将能够内联编辑其名称，只要选项卡的数量超过 div 的长度，按钮就会可见允许它们在 div 内滑动，我会将事件绑定到它们的加载、单击和双击事件。

总而言之，除了滑动/滚动部分之外，我已准备好一切并可以正常工作。只有我必须从你们那里获得关于如何实现此功能的帮助..

亲切的问候，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T07:11:06.747

您要查找的不是选项卡，而是可拖动的面板。可以在此处找到一个示例，称为[JQuery Portlets](http://host.sonspring.com/portlets/)。可以在[此处](http://sonspring.com/journal/jquery-portlets)找到有关 Portlet 的相关博客条目。

您可能还想查看[JQuery UI](http://ui.jquery.com/)的 Draggable、Droppable 和 Sortable 插件。

# php - 在共享主机上安装 PHP 扩展

> ID：397185
> 
> 赞同：8
> 
> 时间：2008-12-29T05:29:56.747
> 
> 标签：php

我需要在我的网站上启用[mcrypt](http://au2.php.net/manual/en/book.mcrypt.php)功能，除非我在共享主机（运行 linux）上并且显然无权访问该`php.ini`文件。似乎确实有安装 PEAR 模块的选项，但搜索告诉我 mcrypt 不可用。除了乞求技术支持来帮助我，我有什么办法可以做到这一点？

* * *

更新：再看看，看起来我可以使用该`dl()`函数在运行时动态加载库。由于我只在一个地方使用 mcrypt 函数，因此我可能会侥幸成功，因为性能损失（我假设有影响）应该是最小的。现在唯一的问题是如何获取`libmcrypt.so`文件？

* * *

另一个更新：我已经从 Sourceforge 下载了 libmcrypt.tar.bz2 文件并运行`./configure`, `make`，然后将该`libmcrypt.so.4.4.8`文件复制到我的主目录（as `libmcrypt.so`）中，但现在我找不到将它放在哪里以便`dl()`函数找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T05:49:42.403

MCrypt Sourceforge 页面应该有它 [http://mcrypt.sourceforge.net/](http://mcrypt.sourceforge.net/)
要编译它：

```
wget http://superb-east.dl.sourceforge.net/sourceforge/mcrypt/libmcrypt-2.5.8.tar.gz
tar -xzvf libmcrypt-2.5.8.tar.gz
cd libmcrypt-2.5.8
./configure
make
sudo make install 
```

编辑：你能用直接路径引用它吗？
你试过什么？

Edit2：您似乎只能从 php.ini 中设置的扩展目录加载模块，并且不能使用 ini_set 覆盖 extensions_dir，因此您必须说服主机安装它，或者如果它们允许您拥有自己的 php。 ini （许多通常在 [username]/php.ini 中执行）然后您可以在其中设置 extensions_dir 并使用它加载模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T05:58:58.577

最好的方法是告诉您的 ISP 包括 mcrypt 支持。即使您捆绑您自己的 PHP 扩展并使用 dl() 加载它，也不能保证它在 PHP 升级后会正常工作，因为 PHP 有时对版本号非常挑剔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T06:19:55.383

`dl()`也无济于事，因为它仅从某些路径加载库，并且出于安全原因，这些路径通常只能由系统管理员写入。

我非常怀疑是否有一种方法可以在未经主机同意的情况下使用二进制库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-30T23:02:29.923

5.2.5 之前的 PHP 版本允许您在 dl() 函数中使用路径，以便您可以轻松地在共享环境中加载库。

这在 5.2.5 中出于“安全”原因而更改，据我所知，您唯一的选择是让系统管理员将模块添加到 extensions_dir。

[这个问题在 bugs.PHP.net 中有描述](http://bugs.php.net/bug.php?id=44037)

# c# - 如何在 Windows 窗体应用程序中显示矢量图形 (SVG)？

> ID：397189
> 
> 赞同：10
> 
> 时间：2008-12-29T05:34:46.567
> 
> 标签：c#, .net, winforms

**有没有办法（最好是控件）在 Windows 窗体应用程序中显示矢量图形（最好是 SVG）？**

[我猜想用WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)很容易做到这一点，但我宁愿不必迁移项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T09:05:40.400

[GDI+](http://msdn.microsoft.com/en-us/library/7f4d4txw(VS.71).aspx)和 Graphics 类可以做矢量图形。

对于 SVG，您可以尝试将其加载到[WebBrowser 控件](http://ms-help://MS.VSCC.v90/MS.MSDNQTR.v90.en/dv_fxmclictl/html/12667861-5b5b-46bc-8fb5-675e25264c9f.htm)中...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-20T10:28:08.250

您不必迁移项目即可使用 WPF。Windows 窗体项目可以嵌入 WPF 控件。查看*[SVGImage 控件](http://www.codeproject.com/Articles/92434/SVGImage-Control)*。

# asp.net - 如何使用 ActiveRecord 在 Asp.net 中创建自定义验证器

> ID：397191
> 
> 赞同：1
> 
> 时间：2008-12-29T05:35:18.767
> 
> 标签：asp.net, asp.net-mvc, validation, customvalidator

我想创建自定义验证器来检查多个表中存在的字段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T00:24:09.740

最好的方法是使用[Castle 验证器组件](http://hammett.castleproject.org/?p=114)

请参阅：[简单的服务器端验证](http://blogs.taiga.nl/martijn/archive/2008/11/26/validation-in-asp.net-mvc-part-1-basic-server-side-validation.aspx)和[自定义服务器端验证](http://blogs.taiga.nl/martijn/archive/2008/11/27/validation-in-asp.net-mvc-part-2-custom-server-side-validation.aspx)

# visual-c++ - 当版本之间存在已知问题时，为什么 Windows 并排 (winSxS) 安装自动升级策略？

> ID：397196
> 
> 赞同：1
> 
> 时间：2008-12-29T05:39:37.197
> 
> 标签：visual-c++, msvcrt, side-by-side

我们有一个使用 MSVC 2K5、SP1（版本 762 msvcrt80）编译的应用程序

一切都很好，直到有人在同一台机器上安装 .Net3.0SP1，同时安装了 msvcrt80 版本 1433 和自动升级策略。

现在我们到处都是随机崩溃和不满意的客户。

我知道我们可以调整清单文件以强制使用特定版本，但我只发现了复制自动生成的细节并手动修改它的非常丑陋的方式。对于要修复的大量应用程序，这尤其令人不快

我们可以摆脱 winSxS 目录中愚蠢的“升级”策略吗？是否有一个选项/标志只为特定版本编译并且仍然自动生成清单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T08:01:02.887

查找为您的特定 CRT 版本生成的清单。然后在应用程序的主文件中添加一个编译指示：

```
#pragma comment(linker,"/manifestdependency:\"type='win32' "            \
        "name='" __LIBRARIES_ASSEMBLY_NAME_PREFIX ".CRT' "              \
        "version='" _CRT_ASSEMBLY_VERSION "' "                          \
        "processorArchitecture='x86' "                                  \
        "publicKeyToken='" _VC_ASSEMBLY_PUBLICKEYTOKEN "'\"") 
```

# ms-word - CommandBars.FindControl 引发异常

> ID：397210
> 
> 赞同：0
> 
> 时间：2008-12-29T05:54:21.440
> 
> 标签：ms-word, vsto, add-in

我正在尝试在 VSTO Word 插件中使用 CommandBars 对象的 FindControl 方法来获取*命令*栏对象代码如下

```
 private void WireContextMenu(string MenuID,string Tag, string ID, ref Office.CommandBarButton Control)
    {
        try
        {
            object missing = System.Type.Missing;

            Control = (Office.CommandBarButton)this.Application.CommandBars[MenuID].FindControl((object)Office.MsoControlType.msoControlButton, ID, Tag, missing, missing);
            if (Control == null)
            {
                Control = (Office.CommandBarButton)this.Application.CommandBars[MenuID].Controls.Add(Office.MsoControlType.msoControlButton, ID, missing, missing, missing);
                Control.Caption = "Biolit Markup Selection";
                Control.Tag = Tag;
            }

            Control.Click += new Microsoft.Office.Core._CommandBarButtonEvents_ClickEventHandler(this.cb_Click);
        }
        catch (Exception Ex)
        {
        }
    } 
```

FindControl 方法抛出类型不匹配异常（-2147352571）任何想法都是正确的方法，无论如何将项目添加到 word 的右键菜单，然后确保如果它已经存在则不要添加它谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:51:42.803

您正在使用 Missing where Missing is not allowed 作为参数参考：[链接文本](http://msdn.microsoft.com/en-us/library/system.type.missing.aspx) [http://msdn.microsoft.com/en-us/library/system.type.missing.aspx](http://msdn.microsoft.com/en-us/library/system.type.missing.aspx)

使用这样的代码：

```
 object type = MsoControlType.msoControlPopup;
        object id = 1;
        object tag = null;
        object visible = 1;
        object recusive = false;
        //object missing = System.Type.Missing;

        CommandBarControl barControl = popParent.FindControl(type, id, tag, visible, recusive); 
```

# design-patterns - 应该有多少种类型来实现存储库模式？

> ID：397214
> 
> 赞同：2
> 
> 时间：2008-12-29T06:00:56.233
> 
> 标签：design-patterns, oop, repository-pattern

我正在尝试在存储图片的实例中使用存储库模式。

我所做的是将实际图片保存在磁盘上的目录中，但保存有关图片的数据以及哪些图片与数据库中的哪些对象一起使用。我想知道是否应该使用 2 个接口进行存储，例如`IStorePicRepo`和`IStorePicDataRepo`或有 1 个接口并在 1 个类中实现它。在我看来，它不应该由同一个类实现，因为我们正在处理 2 种不同的存储机制。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T09:16:49.707

这里没有灵丹妙药。

但我可能最终会得到以下设计：

IBinaryDataService：用于将数据一般保存为二进制格式。要保存的对象必须具有帮助将其写入 OutputStream 的方法。也应该有一种方便的方法将其加载到原始对象中。

IDataIndexService：用于数据属性/标签的索引，也有助于搜索。与您描述的图片数据密切对应。

IPicRepo：仅向客户端公开的接口。客户应该使用这个，并且永远不知道上述两个服务。

FileSystemBinaryDataServiceImpl：上面IBinaryDataService的实现。

DbDataIndexServiceImpl：上面IDataIndexService的实现。

PicRepoImpl：上面IPicRepo的实现。使用 spring 注入 FileSystemBinaryDataServiceImpl 和 DbDataIndexServiceImpl 作为依赖项。

如果您愿意，可以进行额外的扩展：

IPersistentModel：可以持久化的对象的表示。有方法 write(OutputStream)、read(inputStream) 和 getAttributes():Map

PicModel：上面IPersistentModel的实现。

PS。这只是一般的高级概述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T06:21:02.993

我不太了解 Repository 模式，但我不会在我的标识符名称中将 Repository 缩写为 Repo。缩写。迷惑我。

# java - 我想学Struts，有什么好的网站或书籍吗？

> ID：397226
> 
> 赞同：4
> 
> 时间：2008-12-29T06:21:06.473
> 
> 标签：java, struts

我想为abc学习它。

我想知道struts 1和struts 2有什么区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T06:27:52.997

查看这本免费书籍：

*   [雅加达 Struts Live](http://www.theserverside.com/tt/books/sourcebeat/JakartaStrutsLive/index.tss)

此外，您还可以[在这里](http://www.roseindia.net/struts/)找到一些很好的基本代码示例。

对于 Struts 1 与 Struts 2 的比较，请[查看](http://www.java-samples.com/showtutorial.php?tutorialid=200)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-16T04:17:52.890

个人观点。[Jakarta Struts For Dummies](http://www.dummies.com/store/product/Jakarta-Struts-For-Dummies.productCd-0764559575.html)真的是新手的一件艺术品。

它使从 jsp/servlet 到 struts 的转变变得如此容易；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T23:28:39.133

我也推荐struts 2。

我也推荐[Struts 2 in Action一书。](https://rads.stackoverflow.com/amzn/click/com/193398807X)

[Struts 2 Apache 网站](http://struts.apache.org/2.x/docs/home.html)提供了很好的参考资料和大量教程，一旦您开始远离本书。使用该网站，如果可以的话，避免使用 RoseIndia。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T17:14:39.170

我对 Struts1 和 Struts2 有一些经验。首先，Struts1 和 2 是不同的，因为 Struts2 不是 Struts1 的直接演进，而是来自另一个名为[WebWork](http://en.wikipedia.org/wiki/WebWork)的框架。MVC 模式（动作类等）仍有一些相似之处。验证和配置 XML 文件更改。Struts2 将 Dojo 工具包用于它的许多 JavaScript 功能。恕我直言，Struts2 比 Struts1 有更多的功能和改进，尽管它可能没有像 Struts1 那样广泛使用，至少现在还没有......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T08:19:01.413

具体的书我没有读过，但总体上对 Manning 书有很好的体验，所以我会推荐[Struts 2 in Action](http://www.manning.com/dbrown/)。

另外，我通常建议直接从 Struts 2 开始，因为它比 1.x 版本有一些优势。但是，如果您使用的是 Eclipse，我不知道 Struts 2 有任何插件。这对于新用户来说可能是个问题。对于 Netbeans 有[this](https://nbstruts2support.dev.java.net/)，但我自己没有使用过。对于 Struts 1.x，Eclipse 和 Netbeans 都有成熟的插件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-19T12:57:14.983

迄今为止最好的 abc 教程[Struts 2](http://www.tutorialspoint.com/struts_2/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-14T13:29:06.197

我个人推荐struts in action，如果你喜欢在线学习这些可以是一个很好的参考[http://www.mkyong.com/tutorials/struts-tutorials/](http://www.mkyong.com/tutorials/struts-tutorials/)

# asp.net - 灵活的设计 - 可定制的实体模型、UI 和工作流程

> ID：397227
> 
> 赞同：0
> 
> 时间：2008-12-29T06:21:27.813
> 
> 标签：asp.net, entity-framework, customization

我想在我正在构建的软件中实现以下几个方面： 1\. 可定制的实体模型 2\. 可定制的 UI 3\. 可定制的工作流程

我已经考虑过实现这一目标的方法，我希望您对此进行审查并提出建议：

1.  实体对象应该是普通对象，并且只保存数据
2.  使用框架（如 NHibernate？）分离实体模型和数据库模式。这将允许轻松修改实体对象。
3.  获取/修改实体的业务逻辑必须足够细化，以便它们可以作为工作流的一部分被调用。
4.  业务对象不应保持任何状态，因此将仅包含静态方法
5.  工作流将根据一个/多个实体的“状态”决定要调用业务对象/对象上的哪些方法。
6.  工作流应该获得处理的结果，然后将业务对象传递到适当的 UI 屏幕。
7.  UI 屏幕必须包含有关如何显示给定实体的说明。UI 可能必须根据一组 UI 指令动态生成。（如 XUL）

    *   您如何看待这种方法？
    *   建议哪些现有框架（如 NHiberante、Window Workflow）适合此模型，这样我就不会花时间编写这些框架
    *   还建议是否有任何 asp.net 框架可以基于一组 UI 指令（如 Mozilla XUL）生成动态 asp.net ajax 页面？

我最近一直在探索 Apache Ofbiz，并对其自定义应用程序大部分区域的能力印象深刻：UI、工作流、实体。是否有任何用 C#/.Net 开发的类似（不一定是 ERP 系统）应用程序提供类似级别的定制？我正在寻找用 C# 开发的在 UI、工作流和实体模型方面高度可定制的应用程序示例

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T06:41:51.453

Ive built large dynamic generated forms before with workflow, but everything was done in with in-house code.

An ORM isnt going to help you with dynamic forms, since you have to specify the table to entity field mappings. Since in your case their dynamic, it doesnt make sense.

Theres two ways that i see how to store the data:

1) EAV (Entity Attribute Value) table - dynamic fields, but pain for reports and not very efficient but sometimes its the only way to go

2) Generate the DB tables on the fly as the user designs the forms

As for the GUI check this out , havent used it yet. It's Microsoft's answer to a Ruby on Rails type environment that generates "scaffolding" ie. GUI screens based on your database table.

**ASP.NET Dynamic Data**

[http://msdn.microsoft.com/en-us/library/cc488546.aspx](http://msdn.microsoft.com/en-us/library/cc488546.aspx)

I havent seen anything you are looking for in another project.

You can look into XForm engines, but it seems kinda immature.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T07:43:05.997

能不能把要求说清楚。

应用程序的用户是否会构建一些表单并定义其工作流程？每个单独的实体是否都包含一组基本属性？

您可以使用“Page.Parse”动态创建 asp.net 代码。使用任何方法（例如 XSLT）创建 asp.net 代码并将其解析到页面中。示例：http: [//www.codeproject.com/KB/XML/xmlxsltransformer.aspx](http://www.codeproject.com/KB/XML/xmlxsltransformer.aspx)

# java - Grails值得吗？

> ID：397228
> 
> 赞同：88
> 
> 时间：2008-12-29T06:25:36.853
> 
> 标签：java, grails

这是一半的咆哮，一半的问题。

值得使用 Grails 吗？我正在尝试开发一个相对简单的数据库驱动的 Web 应用程序。我的专长是 Java，所以自然而然地，Grails 似乎是一个不错的选择。起初我想使用 Spring、JPA 和 Hibernate，但我以前使用过，并且遇到过各种繁琐的配置和编码工作。Grails 宣称自己解决了这个问题。

我对 Grails 最大的失望是所有的小事情都不起作用。我的意思是它不像人们直觉认为的那样有效。边缘非常粗糙。我经常遇到问题。有时是因为我缺乏对 Grails 的理解——有时我发现了合法的 Grails 错误。

一个主要问题是缺乏良好的 Eclipse 集成。有一个 Groovy 和 Grails 插件，但除了语法高亮之外，它并没有做太多的事情。从 Java 调用 Groovy 以及反之，[配置](http://brainflush.wordpress.com/2008/05/03/grails-and-eclipse-not-so-groovy/)起来非常痛苦。没有良好的 IDE 支持是一大遗憾。

发生的事情是我坐下来尝试开发我的 Web 应用程序。一天结束时，我意识到我花了大约 85% 的时间来调试与 Grails 相关的问题。如果不是 Eclipse 问题，那么它就是[急切加载](https://stackoverflow.com/questions/397145/grails-eager-fetch-doesnt-retrieve-all-data)、[在视图中获取、](https://stackoverflow.com/questions/396703/how-to-reference-a-grails-domain-class-fields-from-outside-of-the-grails-contro)一对多[关系](https://stackoverflow.com/questions/396667/in-grails-need-to-define-a-set-for-one-to-many-relationship)、[奇怪的空文件错误行为](https://stackoverflow.com/questions/396514/after-grails-clean-i-cant-run-app)、[奇怪的属性/getter 错误](https://stackoverflow.com/questions/395586/grails-getsomethingint-i-method-doesnt-comiple)——它会一直持续下去。这只是我今天遇到的问题的一个示例。我上一次与 Grails 的讨论产生了一大堆不同的问题。

我有时想知道这是否值得。我很好奇其他人是否经历过这种情况。真的有人使用 Grails 来高效地开发 Web 应用程序吗？我应该考虑其他用于快速 Web 开发的框架吗？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-12-29T08:02:59.763

我们有一个由 12 人组成的团队，他们都是经验丰富的高级 Java 开发人员，他们从 0.6B 开始学习 Grails，而且我们都仍在从事基于 Grails 的项目。我不会心甘情愿地回到 Java，我们都松了一口气，因为我们已经打破了如何使用 Grails 应用程序快速到达某个地方的问题。

这是一场斗争，这并不容易，并且有/有挫败感。

尽管如此，鉴于我们不断的努力，我们很快就交付了一些东西。有一些错误，许多都有解决方法。

我听说过几个擅长 Java 的开发人员试图深入研究 Grails 项目的复杂咒语。我们避开了所有 Java，转而使用纯 Grails 和 Groovy。我们确保从简单开始，尽可能以可管理和实用的方式构建复杂性。我们不敢深入研究，希望我们的 Java 知识足以支撑我们。

我们最终创造了一个巨大而复杂的东西，它运行得非常好，而且比编写纯 Java/Spring/Hibernate 版本快得多；那就是没有像样的 IDE 支持，而且在错误方面的情况比今天要糟糕得多。

关于 Eclipse 支持，唯一真正用于 Grails/Groovy 的 IDE 是 Intellij - Eclipse 支持远远落后，遗憾的是：我是 Eclipse 爱好者，远非 Intellij 转换 - Grails/Groovy 支持将其他一切都吹走尽管。

是的，与 Spring 相比，Grails 可能还不成熟。或休眠。我敢打赌，在他们存在的最初 1.5 年里，他们同样充满了问题。

既然如此，那么您有责任，注意将复杂性保持在最低限度，仔细测试（在我们看来）并逐渐谨慎地建立复杂性。

一旦在堆栈中涉及 Spring/Hibernate，Java 就没有快速的代码解决方案。Grails 所体现的复杂性反映了 Spring/Hibernate 自身的复杂性。如果你觉得你的时间最好花在纯 Java 上，我不会反对。我仍然有我的 WTF，但现在陡峭的学习曲线已经过去，我想我会更多地坚持使用 Grails。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-12-29T20:34:44.270

我非常喜欢编写 Grails 应用程序，原因有两个：

*   我不必使用 Java
*   我可以使用 Java

我认为在熟悉 grails 之后，他的工作会非常快速而优雅地完成。

这么多的好处。不利的一面是性能，它在两个方面打击了我：部署和测试驱动开发。

我没有设法在单个（租用的）服务器上运行超过 3 个 grails 应用程序，因为我很快就达到了内存和性能限制。包含的框架太多了。

另外，grails 的测试运行者不值这个名字。当我运行单元测试时，它们应该在瞬间完成，而不是 10 到 20 秒。所以我发现自己一直在用纯 Java 编写业务逻辑，因为我可以更快地测试它。但我想这可以通过更好地集成到 IDE（eclipse）中来解决。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-29T14:46:17.670

我认为 Spring 对 Grails 的支持将是一个巨大的推动力。如果有人可以在网络上将其移过 CRUD，那就是那些人。

我也认为它正在达到临界质量。有几本新书将在 2009 年上市。我认为这些将有助于提高采用率。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-05T14:52:38.077

我完全同意原始海报的观点。

我们是一家 Java + Spring 商店，并借此机会试用了 Grails。我们首先创建了一个非常小的测试应用程序，结果证明它非常简单并且运行良好。我们在这里遇到的主要问题是由于我们对 Groovy 和 Grails 缺乏了解。

在这次成功（信心提升）之后，我们决定尝试一个稍微大一点的项目。这是一次更加痛苦的经历。正如其他人所提到的，我们发现了各种表面上没有立即显现的错误和问题。应用程序重启周期变得非常痛苦，除非你有很好的测试覆盖率，否则进行任何形式的重构都是一场噩梦。

真正令人沮丧的是代码失败而没有一条错误消息！它只是不起作用，你不知道为什么？

我喜欢 JMS、Quartz 和 Remoting 等插件的易用性。消除了许多乏味的 XML。

尽管我们也遇到了一些问题，但我几乎喜欢 GORM 的简单性。

我不喜欢 Groovy 类型松散的特性，而且您必须运行应用程序才能捕获一堆错误，这让我想起了 PHP 或 Rails。

归根结底，我们问自己是否有可能使用 Grails 编写一个复杂的可管理软件......

我们有一个即将投入生产的 Grails 应用程序......所以我们拭目以待。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-04T04:42:00.263

我在 Ruby on Rails 方面的经验比我在 Java 世界中的任何经验都多，所以我从不同的角度进入。总的来说，Grails*比*Rails 更粗糙，部分原因是它的不成熟，部分原因是它依赖于两个极其复杂的底层框架（Spring 和 Hibernate）。Rails 还有一个更大的社区。

但是，Groovy 作为一门语言已经取得了长足的进步，使用起来很愉快。由于在 Groovy 1.6 中所做的改进，Grails 比 JRuby on Rails 快了很多，并且您通过 GPath 获得了非常好的 XML 支持。使用 JVM 可以获得很多不错的功能（例如并发性和大量线程安全代码），但不必纠结于 Java（我不太关心的一种语言），所以我真的有很难说服自己在 MRI 上使用任何东西。

不过，我必须承认，Python 看起来很诱人。

至于你的 Eclipse 问题，我无能为力。我使用 Vim 和 Emacs，主要是因为我无法忍受使用 IDE。不过，对于像 Groovy、Ruby 和 Python 这样的动态语言，我认为 IDE 并没有真正带来任何真正的好处，因为实际上没有任何地方可以生成代码，也不需要编译。也许尝试在没有 IDE 的情况下工作一段时间，看看事情是否更顺利？

所以，是的，我认为 Grails 是值得的。他们在让事情尽可能快地工作方面做得非常出色，而且 Grails 和 Groovy 团队都非常非常敬业。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-27T06:24:02.743

我们在 web 层使用 grails + 在服务层使用带有 hibernate 和 spring 的 java。它是经典的三层（网络、逻辑、数据），其中网络是 grails，逻辑是用 java 实现的。与 java 中的惯例一样，我们使用 bean 对象来表示不同层之间的数据。

它工作得很好，它是我们案例的最佳解决方案，因为 bean 对象已经存在，以及数据库结构。根据我们的经验，我认为 grails 作为 Web 表示层具有很大的价值，但我会坚持使用 java 来编写业务规则并持久化应用程序数据——因为 grails “是”java，所有 grails-java 集成都很漂亮直截了当。

我们使用 eclipse 来开发 grails 应用程序，它的集成很差，正如人们在这里所说的那样。但是，作为其他开发人员的建议，我们从命令行运行 grails 应用程序，并且只使用 eclipse 来保存源文件，并且它工作得很好，因为应用程序是即时更新的。

除了在表示层之外，我还觉得在其他地方使用 grails 不是很舒服。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-10T00:15:02.430

我完全和你在一起！Grails 的边缘仍然感觉如此粗糙，以至于将它与 Rails 进行比较几乎是一个笑话。如果至少错误报告好一点。但我想这也可能是由于它在幕后使用了大量的库。一个词：堆栈跟踪！我也不喜欢 model->db 方法（Rails 有 db->model）。脚手架也留下了很大的改进空间。然后“不需要重新启动”也不能像宣传的那样工作。（我不确定更糟糕的是什么 - 必须一直重启，或者有时会发现重启后会消失的奇怪行为）并且不要让我开始使用 GORM。（如果需要几个小时才能找到一个简单的 SQL 方法，您就会开始怀疑整个 ORM 是否真的可以节省您的时间）也许只要它很简单。

我的意思是：当您来自 java 世界时，它仍然是框架的更好选择之一。（那里有很多无用的废话，自称是一个 Web 框架）......它有潜力。我只是希望它不会建立在这么多其他复杂的东西之上。

无论如何-让我们希望这些事情得到解决。目前我正潜伏在[playframework.org](http://www.playframework.org/)上，它看起来也非常漂亮和有前途。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-19T15:51:09.887

我发现 Grails 的最大优势是我不必再关心数据库了——模式是自动创建/更新的，并且持久性主要为我完成（不再编写 SQL 查询）。这是一个巨大的解脱。另一件相当不错的事情是，一旦您确定了控制器和视图的模板，添加新的域对象非常快。尽管我怀疑您至少会对您的视图进行持续的更改，将它们重新安装到现有的视图中。

至于 IDE - IntelliJ 似乎是最好的选择，但我很高兴使用 Netbeans 6.5。我使用 MyEclipse 进行所有其他开发，但 Netbeans 现在有了更好的 Grails 支持。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-29T20:08:54.477

当他们完成 eclipse 插件时，这将是值得的。我说的越早越好。在这种情况发生之前，试图向我的老板推销 groovy 并不容易。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-26T21:12:24.880

我刚刚开始在一个新项目中使用 grails……不必编写任何 xml 文件，但仍然拥有 Spring 的强大功能，Hibernate 真的很棒。

虽然在 IDE 中使用 IntellijIDEA，但我实际上是通过 IDE 发现了 Grails（不过我可能有偏见，我*讨厌*eclipse）。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-30T13:44:40.167

在开始使用 Grails 之前，我是 Eclipse 用户。很快就很明显这不会削减它。所以我尝试了 Intellij 和 NetBeans。就 Groovy 和 Grails 而言，当时 Intellij 更好。但是，NetBeans 是免费的，这对我来说已经足够好了。从那时起，这三个人都发布了新版本或新插件。由于 Intellij 的成本，我仍在使用 NetBeans。随着 Spring Source 对 G2One 的收购，期望之一是 Eclipse 中对 Groovy 和 Grails 的更多支持。这对于提高采用率是必要的。

将 Grails 用于新项目非常棒。不再需要如此多的 Enterprise Java 包袱。我可以想象尝试移植某些东西会很困难，因为在您了解框架的优势和劣势之前，很难有效地利用它。承诺在 Grails 1.1 中对 JSP 的支持会变得更容易，我不知道在尝试探索新框架的同时使用 beta 版本是否是个好主意。测试还经历了新版本的重大修订。如果时间允许，您可以考虑等待，因为 1.1 版本应该很快就会发布。

如果您有机会在从头开始一个项目时在不同的 IDE 中尝试 Grails，我想您会以不同的眼光看待它。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-15T23:38:43.467

完全。Java 框架如此之多，以至于为新手设置了相当高的标准，这证明了 Grails 能够在如此拥挤的空间中脱颖而出。

它仍然有一些锋利的边缘，但它们被磨平只是时间问题，底层项目非常值得。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-07-21T11:30:00.123

Grails 可能对于您的应用程序类型来说太大了（基于它在第一次初始化时创建的大量文件以及它所占用的资源）。如果您正在寻找简单的东西，Grails 可能不是您想要的。如果您正在寻找简单且有效的东西，那么到目前为止，我认为 django 可以很好地完成您的工作。看看从[它的教程](http://docs.djangoproject.com/en/dev/intro/tutorial01/)创建一个 CRUD 应用程序是多么简单（它需要多少文件） 。从这里开始，您的应用程序可以（相对）轻松地随着您的需求和要求的增长而扩展。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-19T17:19:34.933

我不确定他们是否能够正确地制作 Grails。正确地说，我的意思是解决所有细节（小细节和大细节），这些细节最终使它变得脆弱和脆弱。我什至不确定背后是否有一个真正的开发团队（意味着超过 2 人）。

每次我迭代我的 Grails 项目的一个特性，试图改进某些东西时，它都是相同的工作流程：一切都崩溃了，然后是一百个“谷歌”测试周期，然后你会发现你做不到的原因你想要什么，你做别的事情。

最后，您会感到沮丧，因为您甚至不想触摸任何运行的东西。还有不好的东西，你扔掉它们！

我正在考虑通过 JRuby 切换到 Rails。这可能是两全其美的：一个强大的 Web 框架，一个活跃的大型社区，一个专门的开发团队，一个不基于像 Spring 或 Hibernate 这样有问题的复杂框架的平台，一个快速而雄心勃勃的发布周期。还有 JRuby，因为坦率地说，我背包里有这么多 Java 资产，我不能把它们扔掉。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-07-09T08:31:06.477

如果您的专业知识如您所说的那样是Java。你应该看看[Play Framework——](http://www.playframework.org/)它是一个受 Ruby on Rails 启发的 web 框架，开发周期非常短——只需保存你的 Java 源文件并更新你的 web 浏览器。如果你想尝试另一种语言，Play Framework 有一个模块可以让你改用 Scala。

我喜欢 Play Framework，因为它易于理解且性能良好。如果需要，您还可以将 JPA 和 Hibernate 用于 ORM 层。

# html - 如何在浏览标签中设置默认位置

> ID：397237
> 
> 赞同：1
> 
> 时间：2008-12-29T06:34:39.800
> 
> 标签：html, jsp, jsp-tags

我在 j2ee 中做项目。我使用浏览按钮。我每次都需要从项目文件夹中的文件夹中获取图像/文件。我希望将项目的文件夹名称设置为浏览按钮的默认位置。怎么做？

我在 jsp 页面中使用以下代码：

并调用 servlet 中的值：

String image= (String) request.getParameter("img");

浏览时，显示整个路径，但只有图像的名称作为 sevlet 中的值传递。如何获取整个路径？或者如何在浏览时将我的项目文件夹设置为默认位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T18:13:09.670

如果这是呈现标准

```
<input type="file".../> 
```

然后***您无法控制***默认目录。

使用 Flash 可以获得更多控制（文件类型预设、单个/多个文件选择等）

我不确定 Java Applets 是否有更多的访问/选项，希望有人可以提供建议。

PS。对于标准输入标签，浏览器会记住您上次使用的位置，因此如果您从同一目录上传多个文件，您只需导航一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-23T00:39:12.680

我实际上用一个有趣的技巧解决了这个问题。就是这样...

`include file`创建一个名为的外部 vbscript `vbshelper.inc`，其中包含以下代码：

```
function stuffKeys(x)
     Set wshShell = CreateObject("WScript.Shell")
    wshShell.Sendkeys(x)
end function 
```

* * *

在您的 HTML 代码标题中，将以下行作为您的第一个`< Script`> 元素...

`< Script type="text/VBScript src="vbshelper.inc">`

稍后，在您的 HTML 代码中，创建这样的按钮...

`< input type="File" id="srcFile" onchange="go_do_something()" onclick="stuffkeys(' C:\Temp\*.txt~')">`

请注意 C in 之前的空格和 .txt 之后`' C:\Temp*.txt~'`的波浪号。`~`

# javascript - 使用 Javascript 预览 SVG？

> ID：397238
> 
> 赞同：3
> 
> 时间：2008-12-29T06:35:28.863
> 
> 标签：javascript, svg, preview

有没有一种简单的方法可以使用 javascript 在页面内呈现 SVG？我想要做的是设置一个大的文本区域，用户可以在其中键入 SVG 并单击在页面上呈现它的按钮。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T06:48:23.547

[您可以使用 DOM在 HTML](https://developer.mozilla.org/en/SVG_In_HTML_Introduction)中创建SVG 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T10:08:14.580

代码示例（已输入，未验证）：

```
<textarea id="输入"></textarea>
<button onclick="fPreview()">预览</button>
<div id="输出"></div>

<script type="text/javascript">
函数 fPreview() {
    var oInput = document.getElementById("input");
    var oOutput = document.getElementById("输出");
    // 清理预览区域
    如果（oOutput.firstChild）
        oOutput.removeChild(oOutput.firstChild);
    // 将文本解析为 DOM 并在预览中显示
    var oSVGInput = new DOMParser().parseFromString(oInput.value, "text/xml");
    如果（oSVGInput.documentElement）
        oOutput.appendChild(document.importNode(oSVGInput.documentElement));
    别的
        oOutput.appendChild("未知错误");
}
</脚本>

```

# vb.net - 如何使用 OLEDB 或 ADO 连接获取 Access DB 的“扩展属性”

> ID：397248
> 
> 赞同：1
> 
> 时间：2008-12-29T06:50:17.723
> 
> 标签：vb.net, ms-access

我正在尝试使用 vb.net 访问 MS-Access DB 扩展属性，例如作者、所有者、上次修改日期、上次访问日期等。

请帮我解决这个问题...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T08:18:37.920

您可以访问/创建/修改不同类型的属性。

**在数据库级别**

1.  其中一些特定于 Access 数据库对象/Access mdb 文件，只能通过 JET 引擎/DAO 数据库对象进行管理。请参阅 VBA/Access 帮助中的“createProperty”方法。
2.  一些属性可以通过 ADOX 对象在数据库级别使用，并且可以通过 ADO 连接访问，只要连接提供程序提供这些属性： dateModified 和 dateCreated 应该在 table\view\proc 级别可用。
3.  操作 DAO 记录集（不是 ADO 记录集）时，一些额外的属性在记录集级别可用，如“lastUpdated”或“lastModified”。

**在文件级别**

4.  其中一些是特定于文件系统对象的，可在 VB 中使用。它们仅在文件级别可用
5.  您可以通过 DSOfile 对象在文件\文档级别管理\定义扩展属性（请 google 了解更多详细信息）。这样的对象将允许您根据需要添加任意数量的属性，例如“标题”、“作者”、“主题”等。

因此，根据您需要访问的属性类型，这些属性可能无法通过 ADO 连接获得。

# regex - Unicode 正则表达式；无效的 XML 字符

> ID：397250
> 
> 赞同：47
> 
> 时间：2008-12-29T06:51:44.070
> 
> 标签：regex, unicode, pcre

有效 XML 字符的列表是众所周知的，如规范所定义的那样：

```
#x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF] 
```

我的问题是，是否可以通过使用 Unicode 通用类别，在不实际硬编码代码点的情况下为此（或其逆）创建 PCRE 正则表达式。逆可能类似于 [\p{Cc}\p{Cs}\p{Cn}]，除了不正确地覆盖换行符和制表符并遗漏了一些其他无效字符。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-06-07T08:30:38.443

我知道这并不完全是您问题的答案，但在这里提供它会有所帮助：

**匹配有效**XML 字符的正则表达式：

```
[\u0009\u000a\u000d\u0020-\uD7FF\uE000-\uFFFD] 
```

因此，要从 XML 中删除**无效**字符，您需要执行类似的操作

```
// filters control characters but allows only properly-formed surrogate sequences
private static Regex _invalidXMLChars = new Regex(
    @"(?<![\uD800-\uDBFF])[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x9F\uFEFF\uFFFE\uFFFF]",
    RegexOptions.Compiled);

/// <summary>
/// removes any unusual unicode characters that can't be encoded into XML
/// </summary>
public static string RemoveInvalidXMLChars(string text)
{
    if (string.IsNullOrEmpty(text)) return "";
    return _invalidXMLChars.Replace(text, "");
} 
```

我有我们常驻的正则表达式/XML 天才，[他在 4,400 多个赞成的帖子](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)中，检查了这个，他在上面签字。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-29T07:32:07.593

[对于在UTF-16](http://en.wikipedia.org/wiki/Utf-16)内部存储代码点的系统，通常对 0xFFFF 以上的代码点使用代理对 (xD800-xDFFF)，在这些系统中，您必须验证您是否真的可以使用例如 \u12345 或必须将其指定为代理对。（我刚刚发现在 C# 中，您可以使用[\u1234（16 位）和 \U00001234（32 位）](http://msdn.microsoft.com/en-us/library/aa664669(VS.71).aspx)）

根据[微软](http://msdn.microsoft.com/en-us/library/ew7hbz7k(VS.71).aspx)的说法， “W3C 建议不允许在元素或属性名称中使用代理字符。” 在搜索 W3s 网站时，我发现了可能感兴趣的[C079](http://www.w3.org/TR/charmod/#C078)和[C078 。](http://www.w3.org/TR/charmod/#C079)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-02-19T16:57:22.077

我在java中试过这个并且它有效：

```
private String filterContent(String content) {
    return content.replaceAll("[^\\u0009\\u000a\\u000d\\u0020-\\uD7FF\\uE000-\\uFFFD]", "");
} 
```

谢谢杰夫。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-05-14T07:45:57.063

如果 xml 中存在十六进制代码，上述解决方案对我不起作用。例如

`<element>&#x8;</element>`

以下代码会中断：

```
string xmlFormat = "<element>{0}</element>";
string invalid = " &#x8;";
string xml = string.Format(xmlFormat, invalid);
xml = Regex.Replace(xml, @"[\x01-\x08\x0B\x0C\x0E\x0F\u0000-\u0008\u000B\u000C\u000E-\u001F]", "");
XDocument.Parse(xml); 
```

它返回：

> **XmlException** : ''，十六进制值 0x08，是无效字符。第 1 行，第 14 位。

以下是改进的正则表达式并修复了上述问题：

> &#x([0-8BCEFbcef]|1[0-9A-Fa-f]);|[\x01-\x08\x0B\x0C\x0E\x0F\u0000-\u0008\u000B\u000C\u000E-\ u001F]

这是前 300 个 unicode 字符的**单元测试**，并验证仅删除了无效字符：

```
[Fact]
        public void validate_that_RemoveInvalidData_only_remove_all_invalid_data()
        {
            string xmlFormat = "<element>{0}</element>";
            string[] allAscii = (Enumerable.Range('\x1', 300).Select(x => ((char)x).ToString()).ToArray());
            string[] allAsciiInHexCode = (Enumerable.Range('\x1', 300).Select(x => "&#x" + (x).ToString("X") + ";").ToArray());
            string[] allAsciiInHexCodeLoweCase = (Enumerable.Range('\x1', 300).Select(x => "&#x" + (x).ToString("x") + ";").ToArray());

            bool hasParserError = false;
            IXmlSanitizer sanitizer = new XmlSanitizer();

            foreach (var test in allAscii.Concat(allAsciiInHexCode).Concat(allAsciiInHexCodeLoweCase))
            {
                bool shouldBeRemoved = false;
                string xml = string.Format(xmlFormat, test);
                try
                {
                    XDocument.Parse(xml);
                    shouldBeRemoved = false;
                }
                catch (Exception e)
                {
                    if (test != "<" && test != "&") //these char are taken care of automatically by my convertor so don't need to test. You might need to add these.
                    {
                        shouldBeRemoved = true;
                    }
                }
                int xmlCurrentLength = xml.Length;
                int xmlLengthAfterSanitize = Regex.Replace(xml, @"&#x([0-8BCEF]|1[0-9A-F]);|[\u0000-\u0008\u000B\u000C\u000E-\u001F]", "").Length;
                if ((shouldBeRemoved && xmlCurrentLength == xmlLengthAfterSanitize) //it wasn't properly Removed
                    ||(!shouldBeRemoved && xmlCurrentLength != xmlLengthAfterSanitize)) //it was removed but shouldn't have been
                {
                    hasParserError = true;
                    Console.WriteLine(test + xml);
                }
            }
            Assert.Equal(false, hasParserError);
        } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-20T19:59:00.540

使用[XmlConvert.IsXmlChar 方法](https://msdn.microsoft.com/en-us/library/system.xml.xmlconvert.isxmlchar%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396)删除 C# 中不正确的 XML 字符的另一种方法（自 .NET Framework 4.0 起可用）

```
public static string RemoveInvalidXmlChars(string content)
{
   return new string(content.Where(ch => System.Xml.XmlConvert.IsXmlChar(ch)).ToArray());
} 
```

或者您可以检查所有字符是否都是 XML 有效的。

```
public static bool CheckValidXmlChars(string content)
{
   return content.All(ch => System.Xml.XmlConvert.IsXmlChar(ch));
} 
```

.Net 小提琴 - [https://dotnetfiddle.net/v1TNus](https://dotnetfiddle.net/v1TNus)

例如，垂直制表符 (\v) 对 XML 无效，它是有效的 UTF-8，但不是有效的 XML 1.0，甚至许多库（包括 libxml2）都错过了它并默默地输出无效的 XML。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-03T11:45:49.057

在 PHP 中，正则表达式如下所示：

```
protected function isStringValid($string)
{
    $regex = '/[^\x{9}\x{a}\x{d}\x{20}-\x{D7FF}\x{E000}-\x{FFFD}\x{10000}-\x{10FFFF}]+/u';

    return (preg_match($regex, $string, $matches) === 0);
} 
```

[这将处理xml 规范](https://en.wikipedia.org/wiki/Valid_characters_in_XML#XML_1.0)中的所有 3 个范围：

```
#x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF] 
```

# .net - .NET 字符串与流 - 内存配置文件和特征

> ID：397253
> 
> 赞同：7
> 
> 时间：2008-12-29T06:53:43.427
> 
> 标签：.net, string, memory, memory-management, stream

我需要从数据库 (nvarchar) 中提取大型 Unicode 文本字符串（例如 200Mb）并存储在内存中进行处理。即我需要随机访问字符串的所有部分。

从严格以内存为中心的角度来看，使用 System.IO.MemoryStream 与 System.String 作为我的内存表示的优缺点是什么。

我正在尝试研究的一些因素是：

*   这些对象如何在 [假设的] 高度碎片化的低内存环境中发挥作用
*   不变性
*   内存中的实际大小（如果流是 UTF8，我们是否将大小减半）
*   还有一个我没有想过的对象吗？

我正在寻找关于这些点的清晰和建议，以及我没有想到的任何其他内存考虑？

*注意：处理这些字符串可能有更好的方法，但此时我只是询问存储此类对象的内存考虑。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T09:32:22.173

> 从严格以内存为中心的角度来看，使用 System.IO.MemoryStream 与 System.String 作为我的内存表示的优缺点是什么。
> 
> 我正在尝试研究的一些因素是：
> 
> *   这些对象如何在 [假设的] 高度碎片化的低内存环境中发挥作用

IMO，MemoryStream 仅在编码很简单（例如 ASCII、ISO-8859-X 等）时才有用。如果编码是 UTF-8**并且**您有非 ASCII 字符，那么处理将变得更加困难。当然，MemoryStream 几乎肯定会消耗更少的内存，但除此之外没有太大区别。在底层，一个 MemoryStream 使用一个字节数组，它也需要在连续的内存块中分配。

> *   内存中的实际大小（如果流是 UTF8，我们是否将大小减半）

对，对于纯 ASCII 字符，MemoryStream 将消耗等效字符串消耗的一半。

> *   还有一个我没有想过的对象吗？

```
List<byte> // has a nicer interface for processing 
```

字符串如何存储在数据库中？varchar 还是 nvarchar？

问候，

安德烈亚斯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-29T09:42:15.630

字符串与流的内存相当无关紧要。字符串是 utf-16，因此*可能*涉及的倍数很小，但由于涉及的卷，您可能最好将数据写入暂存文件。

要从数据库中读取数据，请使用流技术；即使用 IDataReader (ExecuteReader)，它处于顺序模式，并读取字节/字符块。不要试图阅读整列。

此外，对于 SQL Server 2008，您可能希望查看文件流类型。

例子：

*   [读取](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/fcd173f1db2951f1)大块/块
*   [写](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/314e7e3782e59a93)大块/块

# c# - .NET 中 Windows 服务的进程内 WMI 提供程序

> ID：397256
> 
> 赞同：2
> 
> 时间：2008-12-29T07:01:47.843
> 
> 标签：c#, .net, windows-services, wmi

您如何编写一个进程内 WMI 提供程序作为用 .NET 编写的 Windows 服务的一部分？

我编写了一个将解耦托管模型用作独立应用程序的提供程序，但无法弄清楚如何获得使用 Hosting Model = ManagementHostingModel.NetworkService 工作的 Windows 服务。

这是我正在使用的提供者类型：

```
 [ManagementEntity]
public class Stuff
{
    private readonly string _id;

    public Stuff( string id )
    {
        _id = id;
    }

    [ManagementKey]
    public string Id
    {
        get { return _id; }
    }

    [ManagementProbe]
    public DateTime Time
    {
        get { return DateTime.UtcNow; }
    }

    [ManagementEnumerator]
    public static IEnumerable Enumerate()
    {
        for ( int i = 0; i < 5; i++ )
        {
            yield return new Stuff( i.ToString() );
        }
    }
} 
```

我使用以下方式注册：

```
InstrumentationManager.RegisterType(typeof (Stuff)); 
```

每次我在尝试读取属性值时尝试访问 WMI 类时，都会抛出一些奇怪的异常。

似乎必须有一些非常简单的东西我忽略了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T01:26:54.023

我唯一缺少的是必须在 GAC 中安装进程内提供程序。有关更多详细信息，请参阅[本文](http://msdn.microsoft.com/en-us/library/cc268228.aspx)。

# wpf - 强制 TextBlock 在 WPF ListBox 中换行

> ID：397257
> 
> 赞同：96
> 
> 时间：2008-12-29T07:01:49.450
> 
> 标签：wpf, listbox, word-wrap, textblock

我有一个显示消息的 WPF 列表框。它包含左侧的头像，用户名和消息垂直堆叠在头像的右侧。布局很好，直到消息文本应该自动换行，但是我在列表框上得到了一个水平滚动条。

我用谷歌搜索并找到了类似问题的解决方案，但没有一个有效。

```
<ListBox HorizontalContentAlignment="Stretch"  ItemsSource="{Binding Path=FriendsTimeline}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <Border BorderBrush="DarkBlue" BorderThickness="3" CornerRadius="2" Margin="3" >
                    <Image Height="32" Width="32"  Source="{Binding Path=User.ProfileImageUrl}"/>
                </Border>
                <StackPanel Orientation="Vertical">
                    <TextBlock Text="{Binding Path=User.UserName}"/>
                    <TextBlock Text="{Binding Path=Text}" TextWrapping="WrapWithOverflow"/> <!-- This is the textblock I'm having issues with. -->
                </StackPanel>
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-12-29T07:35:24.950

的内容`TextBlock`可以使用 property 进行包装`TextWrapping`。而不是`StackPanel`，使用`DockPanel`/ `Grid`。还有一件事 - 将`ScrollViewer.HorizontalScrollBarVisibility`属性设置`Disabled`为`ListBox`.

根据马特的评论更新`Hidden`为。`Disabled`谢谢马特。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-29T07:23:14.787

问题可能不在 ListBox 中。如果其中一个父控件提供了足够的空间，则 TextBlock 不会换行，因此它不需要换行。这可能是由 ScrollViewer 控件引起的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-11T15:21:10.327

如果您想阻止 TextBlock 增长，并且希望它刚好适合列表框的大小，您应该明确设置它的宽度。

为了动态改变它，它意味着不是一个固定值，但你需要将它绑定到它在可视化树中正确的父元素。你可以有这样的东西：

```
<ListBox ItemsSource="{Binding MyItems}" Name="MyListBox">

  <ListBox.Resources>
    <Style TargetType="ListBoxItem">
      <Setter Property="Width" 
              Value="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ScrollContentPresenter}, Path=ActualWidth}" />
    </Style>
  </ListBox.Resources>

  <ListBox.ItemTemplate>
    <DataTemplate>
      <TextBlock Text="{Binding Title}" TextWrapping="Wrap" />
    </DataTemplate>
  </ListBox.ItemTemplate>

</ListBox> 
```

如果它不起作用，请尝试使用Visual Studio 中的*Live Visual Tree找到正确的元素（必须绑定到什么）。*

# java - 何时使用指针，何时不使用？

> ID：397263
> 
> 赞同：28
> 
> 时间：2008-12-29T07:04:47.790
> 
> 标签：java, c++, pointers

我习惯于进行 Java 编程，在这种情况下，您在编程时不必真正考虑指针。但是，目前我正在用 C++ 编写程序。在创建具有其他类成员的类时，什么时候应该使用指针，什么时候不应该使用？例如，我什么时候想这样做：

```
class Foo {
    Bar b;
} 
```

与此相反：

```
class Foo {
    Bar* b;
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-12-29T07:11:00.740

从避免指针开始。

在以下情况下使用它们：

*   您想使用[Pimpl 成语](http://en.wikipedia.org/wiki/Opaque_pointer)或[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。
*   `Bar`实例实际上是由程序的其他部分管理的，而类`Foo`只需要能够访问它。
*   您想推迟`Bar`对象的构造（即，您想在构造*之后*`Foo`创建它）。
*   在你的业务逻辑中，`Bar`对象可能根本不存在；您也`null`可以在 Java 中使用。但是，也请查看[boost::optional](http://www.boost.org/doc/libs/1_37_0/libs/optional/doc/html/index.html)。
*   `Bar`实际上是一个基类，并且您需要实例是多态的。
*   您碰巧使用的工具包更喜欢将 GUI 小部件呈现为指针。示例可能包括（但当然不限于）[wxWidgets](http://www.wxwidgets.org/)和[GLUI](http://www.cs.unc.edu/~rademach/glui/)。

在任何这些情况下 (*)，首先使用智能指针，例如[boost::shared_ptr](http://www.boost.org/doc/libs/release/libs/smart_ptr/shared_ptr.htm)。否则，您迟早可能会忘记释放内存。一旦您知道自己在做什么，请逐案考虑哪种指针类型最好。

(*) 任何情况——可能除了关于 GUI 小部件的项目符号；在这种情况下，您的工具包很可能也会为您管理资源

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-29T07:15:20.967

```
class Foo {
    Bar b;
} 
```

b*包含*在 Foo 中。如果 Foo 对象结束生命周期， b 也会自动结束生命周期。这就是模型组合。上面的 b 表示对象本身，而不仅仅是像 Java 中那样指向它的指针。因此，如果 b 超出范围，对象将结束生命周期。

```
class Foo {
    Bar * b;
} 
```

这里，b 指向的对象被Foo 对象*使用*或*引用。*如果 Foo 对象的生命周期结束，则 b 指向的对象可能会继续存在，这取决于具体情况。这可用于对聚合和一般关系进行建模。例如，该对象可以与其他 Foo 对象共享。

指针大致就是 Java 中的引用。他们也可以什么都没有。如果指针不指向任何内容，则它是空指针。

与指针类似的是引用。C++ 中的引用必须被初始化并且只能指向一个（有效的）对象，该对象的引用已被初始化。因此，引用不能保持价值，这可能意味着“什么都没有”，就像`null`在 Java 中一样。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-29T07:13:03.733

在第一个示例中，Bar 对象的内存将在您构造 Foo 对象时自动分配。在第二种情况下，您需要自己分配内存。所以你必须打电话：

```
Foo *foo = new Foo();
foo->b = new Bar(); 
```

如果 Bar 对象很大并且您不想将它与 Foo 对象捆绑在一起，这可能是可取的。当 Bar 对象的构造独立于 Foo 对象的创建时也是可取的。在这种情况下，b 对象被“注入”到 foo 中：

```
Foo *foo = new Foo();
foo->b = b_ptr; 
```

其中 b_ptr 在其他地方构造，并将指针传递给 foo。

对于较小的对象，这是危险的，因为您可能会忘记分配内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T07:10:29.510

在不同的条件下两者都可以。例如，如果在构造 Foo 类的对象时知道如何构造 b，那么第一个就可以了。但如果你不这样做，唯一的选择就是使用第二个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T20:19:52.210

您需要进行一些汇编编程并很好地了解内存布局。C 只是一个跨平台程序集，与 Java 或其他语言不同。要正确使用它，应该了解底层细节。

所做的所有评论都是有效的，但是对于像您这样从高级语言跳到 C 语言的人来说，拥有这种经验将是有益的。有了正确的理解，你就不会再问这样的问题了。

# 3dsmax - 如何通过 Maxscript 以编程方式更改 3dsmax 透视窗口的 F OV？

> ID：397274
> 
> 赞同：4
> 
> 时间：2008-12-29T07:21:34.447
> 
> 标签：3dsmax, maxscript

我需要访问透视视口的 FOV 属性。这与与目标和自由相机关联的 FOV 属性不同。

要以非编程方式访问 FOV 属性，请右键单击视口名称（每个视口的左上角），转到配置并在“透视用户视图”下更改 FOV。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T20:33:42.963

在 3ds Max 2008 及更高版本中，您可以使用

```
 viewport.setFOV 50.0 
```

修改当前活动视口的视野。

查看 MaxScript 帮助中的“访问活动视口信息、类型和变换”

所以：

```
Utility FieldOfView "Field of View"
(
    slider fov "Field of View" pos:[17,43] width:128 height:44 range:[25,100,viewport.GetFOV()] type:#float

    on fov changed val do
    (
        viewport.setFOV val
    )
) 
```

将创建通常的小实用程序，用于调整当前活动视口的视野。

mk:@MSITStore:C:\Program%20Files\Autodesk\3ds%20Max%202009\help\maxscript.chm::/Accessing_Active_Viewport_Info_Type_and_Transforms.htm

# xml - XML-Schema 中的自定义日期格式

> ID：397281
> 
> 赞同：2
> 
> 时间：2008-12-29T07:27:20.583
> 
> 标签：xml, datetime, xsd

我正在创建一个 xml 架构，并且我想支持自定义日期格式：
Thu Dec 11 14:17:20 2008

目前我正在使用以下模式类型：

```
<xs:simpleType name="Date_Type">
    <xs:restriction base="xs:token">
        <xs:pattern value="(Sun|Mon|Tue|Wed|Thu|Fri|Sat) (Jan|Feb|Mar|Apr|May|June|Jul|Aug|Sep|Oct|Nov|Dec) [0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2} [0-9]{4}"/>
    </xs:restriction>
</xs:simpleType> 
```

使用 XML 模式是否有更简单（更优雅）的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T14:28:44.163

带有模式的 XML 旨在存储数据；正如其他人指出的那样，已经有一种存储日期的标准方法。看起来您想要存储格式化数据，就像原来的那样，它混合了模型和视图。

这样做可能会很好，但最终您可能想要执行类似 XSLT 过滤器的操作，该过滤器可以挑选出日期在两个给定日期之间的项目。那你就麻烦了。

# xml - 在java中解析一个动态获取路径的XML文件

> ID：397283
> 
> 赞同：0
> 
> 时间：2008-12-29T07:30:45.427
> 
> 标签：xml, directory, parsing, load, java-io

我在 C:/proj/test_xml/Test.java 中有一个类测试。给定 parser.parse("test.xml"); 我需要一种方法来解析 test.xml，无论它是在当前目录、proj 还是在 C:/ 中，此外，该解决方案不应使用 java.io

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T10:26:29.707

我不确定我是否理解你的问题，但我假设你想在不同的位置搜索一个文件，有限数量的任意目录。最后一个要求听起来特别糟糕……为什么不使用 java.io？（我）想到的最简单的解决方案实际上是：

```
String[] filenames = { "c://a.pdf", "c://airu//a.pdf" };
File f = null;
boolean found = false;
for (String filename : filenames)
{
    f = new File(filename);
    found = f.exists(); 
    if (found) break;
}
if (!found) 
{
    throw new RuntimeException("file nowhere to be found");
}
System.out.println("file " + f.getName() + " found"); 
```

请尝试为您的问题（编辑）添加一些细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T10:51:31.980

尝试循环，直到解析不再抛出 IOException：

```
String filename="test.xml";
int tries=3;
while( tries-->0 ) {
    try {
        parser.parse(filename);
        break;
    } catch( FileNotFoundException e ) {
        // FileNotFound expected
        filename="../"+filename;
    }
} 
```

如果尝试 == 0，则根本找不到文件。对于 DOM 解析器，需要保留 parser.parse() 返回的 Document 对象。

# wpf - 通过 XAML 在 WPF 中的 I18N 和 L10N

> ID：397292
> 
> 赞同：4
> 
> 时间：2008-12-29T07:44:41.687
> 
> 标签：wpf, xaml, .net-3.5, localization, internationalization

如果有人知道如何**仅通过 XAML 在 WPF 中进行国际化和本地化**。我已经使用资源管理器类完成了 WPF .cs 文件。 ***如果有人可以指导我并给我代码示例，我会非常喜欢。***

提前致谢，

干杯... Karthikeyan Manickam。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T13:58:21.920

尝试查看[http://www.microsoft.com/uk/remix08/agenda.aspx](http://www.microsoft.com/uk/remix08/agenda.aspx)。特别是选择“第二天”-> *Internationalizing WPF And Silverlight Applications*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-30T19:29:23.763

使用本地化工具。我们使用 Sisulizer [http://www.sisulizer.com](http://www.sisulizer.com)

它可以轻松制作本地化的 XAML 文件和附属程序集文件。无需修改您现有的 XAML 文件。

# python - Windows的快速文件/目录扫描方法？

> ID：397293
> 
> 赞同：3
> 
> 时间：2008-12-29T07:47:11.930
> 
> 标签：python, windows

我正在寻找一种高性能的方法或库来扫描磁盘上或给定目录中的所有文件并获取它们的基本统计信息——文件名、大小和修改日期。

我编写了一个 python 程序，它使用`os.walk`with`os.path.getsize`来获取文件列表，它工作正常，但不是特别快。我注意到我下载的一个免费软件程序比我的程序更快地完成了相同的扫描。

加快文件扫描的任何想法？这是我的 python 代码，但请记住，如果有更好的选择，我根本没有与 os.walk 结婚并且非常愿意使用其他 API（包括 Windows 原生 API）。

```
for root, dirs, files in os.walk(top, topdown=False):
    for name in files:
        ... 
```

我还应该注意，我意识到 python 代码可能无法加快速度。我对提供更快速度的任何本机 API 特别感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T11:21:56.100

好吧，我希望这将是大量 I/O 绑定任务。因此，python 方面的优化将非常无效；我能想到的唯一优化是访问/列出文件的一些不同方式，以减少从文件系统的实际读取。这当然需要对文件系统有深入的了解，而我没有，而且我不希望 python 的开发人员在实现时具备`os.walk`.

产生一个命令提示符，然后发出 'dir' 并解析结果怎么样？这可能有点矫枉过正，但幸运的是，'dir' 正在为此类优化做出一些努力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T11:36:25.743

似乎 os.walk 在 python 2.5 中得到了[相当大的改进](http://mail.python.org/pipermail/python-list/2006-October/408667.html)，所以您可以检查您是否正在运行该版本。

除此之外，[有人已经将 os.walk 的速度与 ls 进行了比较，](http://randomfoo.net/blog/id/4214)并注意到后者的明显进步，但不在一个实际上证明使用它的范围内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T16:48:42.027

您可能想查看一些 Python 版本控制系统（如 Mercurial 或 Bazaar）的代码。他们花了很多时间想出快速遍历目录树并检测更改（或“查找有关文件的基本统计信息”）的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-31T19:29:49.397

在 Ben Hoyt 的 github 上使用 scandir python 模块（以前称为 betterwalk）。

[http://github.com/benhoyt/scandir](http://github.com/benhoyt/scandir)

它比 python walk 快得多，但使用相同的语法。只需导入 scandir 并将 os.walk() 更改为 scandir.walk()。而已。这是在python中遍历目录和文件的最快方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T19:33:44.923

我想知道您是否想对 I/O 操作进行分组。

例如，如果您正在遍历包含数千个文件的密集目录树，您可以尝试遍历整个目录树并存储所有文件位置，然后遍历（内存中）位置并获取文件统计信息。

如果您的操作系统将这两个数据存储在不同的位置（目录结构在一个位置，文件统计信息在另一个位置），那么这可能是一个重要的优化。

无论如何，这是我在进一步挖掘之前会尝试的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-29T12:38:38.660

当您查看 的代码时`os.walk`，您会发现没有多少脂肪需要修剪。

比如下面的只是比os.walk快一毛。

```
import os
import stat

listdir= os.listdir
pathjoin= os.path.join
fstat= os.stat
is_dir= stat.S_ISDIR
is_reg= stat.S_ISREG
def yieldFiles( path ):
    for f in listdir(path):
        nm= pathjoin( path, f )
        s= fstat( nm ).st_mode
        if is_dir( s ):
            for sub in yieldFiles( nm ):
                yield sub
        elif is_reg( s ):
            yield f
        else:
            pass # ignore these 
```

因此，开销必须在`os`模块本身中。您将不得不求助于直接调用 Windows API。

查看[Python for Windows Extensions](http://python.net/crew/mhammond/win32/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-09-14T07:42:06.400

Python 3.5 刚刚引入[`os.scandir`](https://docs.python.org/dev/library/os.html#os.scandir)（参见[PEP-0471](https://www.python.org/dev/peps/pep-0471/#abstract)），它避免了许多非必需的系统调用，例如`stat()`并`GetFileAttributes()`提供了一个明显更快的文件系统迭代器。

`os.walk()`现在将使用`os.scandir()`它的迭代器来实现，因此在继续使用`os.walk()`.

* * *

示例用法：

```
for entry in os.scandir(path):
   if not entry.name.startswith('.') and entry.is_file():
       print(entry.name) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T00:00:04.650

This is only partial help, more like pointers; however:

I believe you need to do the following:

```
fp = open("C:/$MFT", "rb") 
```

using an account that includes SYSTEM permissions, because even as an admin, you can't open the "Master File Table" (kind of an inode table) of an NTFS filesystem. After you succeed in that, then you'll just have to locate information on the web that explains the structure of each file record (I believe it's commonly 1024 bytes per on-disk file, which includes the file's primary pathname) and off you go for super-high speeds of disk structure reading.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-29T08:01:08.690

os.path 模块也有目录树遍历功能。我从来没有在它上面运行过任何类型的基准测试，但你可以试一试。但是，我不确定是否有比 Python 中的 os.walk/os.path.walk 更快的方法。

# javascript - JavaScript 中的数组是如何工作的？（即没有起始尺寸大小）

> ID：397301
> 
> 赞同：8
> 
> 时间：2008-12-29T07:56:35.407
> 
> 标签：javascript, arrays

前几天晚上我正在阅读[这篇](https://stackoverflow.com/questions/392397/arrays-whats-the-point)关于 Array 内部工作原理的帖子，并从发布的答案中学到了很多东西，尤其是[Jonathan Holland](https://stackoverflow.com/questions/392397/arrays-whats-the-point#392426)的答案。

因此，您事先为数组指定大小的原因是需要事先保留空间，以便数组中的元素将在内存中彼此相邻放置，从而提供 O(1) 访问时间，因为`pointer + offset`遍历。

* * *

但是在 JavaScript 中，你可以像这样初始化一个数组：

```
var anArray = []; //Initialize an empty array, without a dimension 
```

所以我的问题是，由于在 JavaScript 中您可以在不事先指定维度的情况下初始化数组，**由于事先未指定内存位置的“数量”，如何为数组分配内存以仍然提供 O(1) 访问时间？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T14:19:05.510

唔。您应该区分数组和关联数组。

数组：

```
A=[0,1,4,9,16]; 
```

关联数组：

```
B={a:'ha',b:27,c:30}; 
```

前者有长度，后者没有。当我在 javascript shell 中运行它时，我得到：

```
js>A=[0,1,4,9,16];
0,1,4,9,16
js>A instanceof Array
true
js>A.length
5
js>B={a:'ha',b:27,c:30};
[object Object]
js>B instanceof Array
false
js>B.length
js> 
```

Javascript 中的数组如何“工作”取决于实现。（Firefox 和 Microsoft 以及 Opera 和 Google Chrome 都会使用不同的方法）我的猜测是它们（数组，而不是关联数组）使用 STL 的[std::vector](http://www.sgi.com/tech/stl/Vector.html)之类的东西。你的问题：

> 由于事先未指定内存位置的“数量”，如何为数组分配内存以仍然提供 O(1) 访问时间？

更符合 std::vector （或类似的可调整大小的数组）的工作方式。它会根据需要重新分配给更大的数组。最后的插入需要*分摊*的O(1) 时间，即如果在 N 很大的地方插入 N 个元素，则总时间需要 N*O(1)。那些必须调整数组大小的单独插入可能需要更长的时间，但平均需要 O(1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T08:04:27.763

Javascript 中的数组是“假的”。它们被实现为哈希映射。所以在最坏的情况下，它们的访问时间不是 O(1)。它们还需要更多内存，您可以使用任何字符串作为数组索引。你觉得这很奇怪吗？这是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T13:57:00.903

据我了解，是这样的：

JavaScript 中有两种不同的东西：数组和对象。它们都充当哈希表，尽管底层实现特定于每个运行时。两者的区别在于 Array 具有隐式`length`属性，而对象则没有。否则，您可以对它们都使用`[]`or语法。`.`是的，这意味着对象可以具有数字属性，而数组可以具有字符串索引。没问题。尽管`length`在使用此类技巧或稀疏数组时，该属性可能不是您所期望的。**只有当数组不是**稀疏的并且索引从 0 开始时，您才应该依赖它。

至于性能 - 抱歉，这不是您期望的 O(1)。如前所述 - 它实际上是特定于实现的。但在一般情况下，不可能确保哈希表中的所有操作都有 O(1) 性能。也就是说，我希望体面的实现应该对标准情况进行相当多的优化，这将使大多数情况下的性能非常接近 O(1)。但无论如何——在 JavaScript 中存储大量数据并不是一个明智的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T15:43:14.233

As [Jason](https://stackoverflow.com/questions/397301/how-do-arrays-in-javascript-work-ie-without-a-starting-dimension-size#397796) said, unless it is explicitly specified by the ECMAScript standard (unlikely), it is implementation dependent. The article shown by Feet shows that IE's implementation was poor (until IE8?), which is confirmed by [JavaScript loop performance](http://www.robertnyman.com/2008/04/11/javascript-loop-performance/ "JavaScript loop performance").

Other JS engines probably takes a more pragmatic approach. For example, they can do like in Lua, having a true array part and an associative array part: if the array is dense, it lives in the true array (which can still be extended at the cost of re-allocation), and you can still have sparse high indices living in the associative part.

Thus you have the best of two worlds, speed of access to dense parts and low memory use for sparse parts.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-09T20:56:36.907

你甚至可以这样做：

`var asocArray = {key: 'val', 0: 'one', 1: 'two'}`

和

`var array = []; array['key'] = 'val'; array[0] = 'one'; array[1] = 'two';`

循环时，您可以使用循环以相同的方式使用它们`for i in object`，而不是将其用于 asocArray 并将`for var i=0; i<array.length; i++`循环用于“数组”。这里唯一的区别是，如果您期望“数组”中的索引是 a`typeof i === 'number'`或`(i).constructor === Number`那么它只会在“`for var i=0; i<array.length; i++`循环”中；`for i in object`循环使所有键（甚至索引）a `String`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T08:12:31.380

在 PHP 中也是如此。我来自 PHP/Javascript 背景，当我转向其他语言时，维度化数组真的让我受益匪浅。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-29T08:49:33.710

javascript 没有真正的数组。元素在定义时分配。

它是一种灵活的工具。您可以将 用于多种用途，但作为通用工具不如专用数组高效。

# linux - 如何让 Windows Flash 游戏在 Linux 上运行？

> ID：397302
> 
> 赞同：0
> 
> 时间：2008-12-29T07:58:59.020
> 
> 标签：linux, flash, adobe-director, olpc

我有一些适用于 Windows 的教育类 Flash 游戏（合法购买），我希望我的女儿能够在她的[OLPC](http://laptop.org)上使用这些游戏。

我知道有些用户已经能够通过使用 wine 在 Linux 下运行它们，但这在 OLPC 上确实不是一个选项，因为他们需要驱动器中的 cd 才能运行，而 OLPC 没有 cd 驱动器。

游戏从 cd 安装，然后从 exe 文件运行。他们需要在使用时将 cd 放在驱动器中。

我已经看到有一些 Flash 反编译器可用，所以我在想是否可以反编译游戏然后为 Linux 重新编译它？

### 更新

经过一些进一步的研究和实验，我离运行游戏更近了一点。

原来这个exe是一个投影仪（用Director制作的），它所做的只是在一个子目录中运行一个dxr文件。我可以直接在 flash player 中打开这个文件，但它只是初始菜单，您可以从中选择各种活动。

问题是当您选择一个活动时，您会收到类似“无法找到文件：“\SUBDIR\ACTIVITY””的错误。

活动的子目录与菜单的子目录处于同一级别。所以我尝试制作一个只运行菜单的[存根电影](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14431)，并从根目录启动它（与原始投影仪相同）。我运行菜单很好，但它仍然为活动提供相同的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T08:24:50.093

这可能取决于您所说的“Windows Flash”游戏是什么意思。Flash 内容通常以 SWF 形式存在，它与平台无关，可以在任何操作系统上播放（理论上——Linux flash 播放器的实际质量一直不一致）。因此，如果您可以找到这些游戏的 SWF 内容，那么只需将它们复制到您想要的位置即可。

但是，如果这些游戏通常是从 CD 上执行的，那么可能还有更多内容。如果 CD 似乎包含 EXE 格式的游戏内容，那么您可能正在查看投影仪文件。投影仪基本上是一个 EXE，它将 Flash 播放器和要播放的 SWF 内容包装在一起，为您提供可以在未安装 Flash 的系统上运行的内容的 EXE。如果这是您所拥有的，那么将该 EXE 复制到目标系统并在 wine 下运行它可能会起作用。但是，投影机中可能有某种逻辑，以防止它在 CD 驱动器之外运行。我不确定可以用它做什么。我相信有一些工具可以从投影仪中提取 SWF 内容，但我不能保证其中任何一个。（这可能也违反了您购买游戏的许可证，因为那是值得的。）

最后，以上所有内容都是假设这些游戏作为直接从 CD 上运行的东西而存在。如果这些是具有安装/卸载功能的东西，那么即使部分是在 Flash 中开发的，让它们在 linux 下工作可能与任何其他应用程序没有什么不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T08:22:13.967

查看 OLPC wiki 寻求帮助。

他们有[这个](http://wiki.laptop.org/go/Adobe_Flash)页面用于安装 Adob​​e Flash Player，这可能是最好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T18:11:21.267

游戏从 EXE 运行的更新信息的新答案。在这种情况下，听起来您的问题不是在 Linux 上运行这些游戏，而是在没有 CD 的情况下运行它们。

至于重新编译的可能性，如果游戏是从 CD*安装*的，那么即使游戏的内容是 Flash，听起来容器也是一个常规的可安装 Windows 应用程序。（除非它是一个 Adob​​e AIR 应用程序，但我假设你已经提到过。）在这种情况下，重新编译 Flash 内容不会做任何事情，因为 CD 检查肯定是 win 应用程序逻辑的一部分，而不是从 Flash 内部完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T18:09:41.393

尝试制作磁盘的iso映像并将其安装在虚拟驱动器上，然后尝试在wine下运行它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-17T09:22:58.240

安装wine，然后是swift flash player。这是 swf 文件的最佳方式。

# silverlight - 如何在 Silverlight 中制作“滚动”效果？

> ID：397311
> 
> 赞同：1
> 
> 时间：2008-12-29T08:06:56.040
> 
> 标签：silverlight

我发现 Resolution Randomizer ( [http://resolutionrandomizer.pop.us/ecard.aspx](http://resolutionrandomizer.pop.us/ecard.aspx) ) 非常有趣。当您单击“随机化”按钮时，它具有滚动效果。

我对 Silverlight 很陌生，我想知道它是如何实现的。我想为我的项目添加一些类似的效果。有人有一些我可以参考的脚本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T18:51:53.557

Nikhil 的网站已关闭。只是让所有人都知道。您可以使用谷歌的缓存链接访问这些东西：http://74.125.113.132/search?q=cache: [ssbXtQS7bEUJ :www.nikhilk.net/Silverlight-Effects-In-Depth.aspx+SilverlightFX&hl=en&ct=clnk&cd=3&gl =tt&client=firefox-a](http://74.125.113.132/search?q=cache:ssbXtQS7bEUJ:www.nikhilk.net/Silverlight-Effects-In-Depth.aspx+SilverlightFX&hl=en&ct=clnk&cd=3&gl=tt&client=firefox-a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T00:06:31.410

您可以查看 Nikhil Kothari 的 SilverlightFX 项目，它提供了一些非常强大的效果和过渡声明。就获得滚动效果而言，您可能想要创建一个包含整个滚动视觉效果的 ContentControl，并使用 FX 的 Move 动画和一个在到达动画结束时减慢的缓动效果。移动动画将沿着视口移动整个视觉。

[Nikhil 的文章解释了 FX 效果和过渡](http://www.nikhilk.net/Silverlight-Effects-Transitions.aspx)

# javascript - JavaScript 中的帧位置

> ID：397320
> 
> 赞同：1
> 
> 时间：2008-12-29T08:12:59.023
> 
> 标签：javascript, popup, frame, mouse-position

我有一个基于框架的网页，有 3 个框架。topliner，左侧的导航和右下方的内容框架。

现在，我想在用户右键单击内容框架时显示一个弹出菜单。因为 div-container 不能跳出框架，所以我的想法是，将整个框架页面放入一个新的 iframe 中。在那个页面中，我可以有第二个 iframe，它是我的弹出菜单。

所以现在，我有这个布局：

```
<html> (start-page)
  <iframe  (real content)
    <frameset 
      top-frame
      navigation-frame
      content-frame
    >
  >
  <iframe> (my popup-menu, positioned absolutelly and hidden by default)
</html> 
```

在我的内容框架中，我将一个“onmouseover”事件分配给了正文标签。此事件应在当前鼠标位置打开弹出 iframe。这正是我的问题：如何让鼠标坐标相对于顶级网站（我的草稿中的起始页）？

目前我正在使用这个 mouseDown 功能（现在只在 IE 中工作 - 但让它在 FF & Co 中工作应该不是问题......）

```
function mouseDown(e)
{
  if (window.event.button === 2 || window.event.which === 3) 
  {
    top.popupFrame.style.left = event.screenX + "px";
    top.popupFrame.style.top = event.screenY + "px";
    top.popupFrame.style.display = "";
    return false;
  }    
} 
```

如您所见，“event.screenX”和“screenY” - 变量不是我可以使用的变量，因为它们与主页无关。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T14:33:58.210

你说它是一个企业应用程序——你必须支持所有主流浏览器，还是 IE 就足够了？

我问这个是因为 IE 的功能完全符合您的需要：

```
window.createPopup(...) 
```

[http://msdn.microsoft.com/en-us/library/ms536392(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536392(VS.85).aspx)

即使在浏览器窗口之外，也可以看到弹出窗口！:-)

要显示它，请使用接受位置和大小参数的 .show(...) 方法（有关详细信息，请参阅 MSDN）。好消息是，您还可以传递对相对于该位置的页面元素的引用，因此您可以轻松地相对于某个页面元素、某个框架、某个浏览器窗口甚至相对于桌面定位弹出窗口.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T09:08:04.063

如果您只打算支持 IE - 您可以通过调用 window.showModalDialog 尝试使用新的模式窗口。您可以将新窗口放置在屏幕上的任何位置。

一般来说，使用新窗口和模态窗口有很多缺点......

顺便说一句 - FF 3 及更高版本还[支持 window.showModalDialog](https://developer.mozilla.org/en/DOM/window.showModalDialog)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T10:09:52.970

我强烈建议您使用 css 将您的框架集切换到标准 DIV 布局。[这是设置许多不同 css 布局](http://blog.html.it/layoutgala/)的一个很好的起点。

我知道这可能不是您想听到的，但是除了您当前面临的弹出菜单问题之外，框架还有很多缺点。例如：

*   框架很难或不可能正确添加书签，因为框架集通常是地址中唯一可见的页面。
*   通过在新的浏览器窗口中加载链接很容易打破框架集。这意味着用户可能会丢失导航或迷路。
*   它们不会在移动设备和纯文本浏览器上正常降级。css 布局的一大优点是即使没有打开任何样式，它们仍然可以使用。

# jquery-plugins - JQuery 插件网站

> ID：397321
> 
> 赞同：0
> 
> 时间：2008-12-29T08:13:06.247
> 
> 标签：jquery-plugins

有没有列出所有公开可用的 JQuery 插件的网站？

另外，这些插件通常是开源的还是有些人会向你收费才能下载它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T08:20:44.767

插件列表可在[http://plugins.jquery.com/获得](http://plugins.jquery.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T08:25:07.813

JQuery 插件是不可编译的，因为它们是标准的 .js javascript 文件。我从未见过任何花钱的公开可用的 JQuery 插件。我想这是可能的，但分发要么是出于对客户的善意，要么是对源代码进行严重混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T08:53:12.530

大多数 jQuery 插件都是开源的，拥有自由许可证，就像 jQuery 本身一样。

# visual-studio-2008 - 删除视觉工作室中的区域

> ID：397332
> 
> 赞同：1
> 
> 时间：2008-12-29T08:32:56.707
> 
> 标签：visual-studio-2008

当区域之间存在层次结构时，Ctrl ML 不会切换 vb.net (2008) 中的所有区域。我不喜欢地区。有没有办法扩展所有区域或永久删除它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-09T19:56:35.683

在 VB.Net 中，进行搜索和替换并选择使用隐藏和使用正则表达式：

代替：

```
^.*\#(end)*(:Wh)*region.*\n 
```

和：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T08:51:03.783

James Nies 声称“NArrange 也可以用作从源代码中删除区域的工具”。

> 直到现在我才想到它，但 NArrange 也可以用作从源代码中去除区域的工具。
> 
> 如果您要为类型定义一个空元素声明，请参见下文，那么 NArrange 将只解析成员并将它们写回。它不会对任何东西进行排序，而只会剥离区域并清理成员之间的空白。

```
 <Element Type="Type" Id="DefaultType">
     <Elements>
         <Element>
              <Elements />
         </Element>
     </Elements>
 </Element> 
```

> 但是，这不会删除在成员中定义的区域。

来源：[http ://www.codeproject.com/KB/codegen/narrange.aspx?msg=2579903#xx2579903xx](http://www.codeproject.com/KB/codegen/narrange.aspx?msg=2579903#xx2579903xx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T08:44:20.037

没有在嵌套轮廓中扩展所有轮廓，Cntrl-M，L是扩展所有轮廓（或cntrl-m，cntrl-m扩展1个区域）的东西。VB.NET 没有像 C# 那样切换大纲模式的选项。

# python - 使用外部 GUI 库在 Autodesk Maya 中制作用户界面

> ID：397337
> 
> 赞同：7
> 
> 时间：2008-12-29T08:41:12.807
> 
> 标签：python, scripting, wxpython, wxwidgets, maya

我在 Autodesk Maya 中开发工具。我构建的许多工具都有简单的窗口 GUI 供动画师和建模师使用。这些 GUI 通常包含您通常希望在任何基本窗口中看到的内容；标签、列表、菜单、按钮、文本字段等。但是，您可以使用可用工具构建的 UI 的复杂性受到限制，特别是可用小部件的类型。

我有兴趣使用一些更高级的 wxPython 小部件，例如 ListView（网格）、Tree 等。这将涉及使用完整的 wxFrame（窗口）来显示整个 UI，这实际上意味着该窗口将不再与玛雅联系在一起。不是破坏交易，但这意味着当 Maya 最小化时，窗口不会效仿。

我以前用 tkinter 作为测试尝试过这样的事情，但发现它需要一个 MainLoop 才能在自己的线程中运行。这是合乎逻辑的，但在我的情况下，它与 Maya 自己的线程冲突，基本上使 Maya 挂起，直到窗口关闭。这是因为 Maya 在主 Maya GUI 共享的单个线程中运行所有脚本，无论是 MEL 还是 Python。这是为了防止一个脚本在另一个脚本尝试对同一对象执行操作时删除一个对象。

wxPython 有同样的“mainloop”方法。我想知道是否有任何方法可以让它在 Maya 中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T02:48:01.443

我不确定这是否密切相关，但一些谷歌搜索发现 PyQt 在 Maya 中非常流行。[您可以在此处](http://www.highend3d.com/boards/lofiversion/index.php/t236041.html)或[此处](http://www.highend3d.com/boards/index.php?showtopic=242116)尝试通过 Maya 创建新线程循环并在其中执行的技术（[此处使用源代码解释）。](http://groups.google.com/group/xsi_list/msg/dd500eb2420f3417?)似乎 Maya 包含一个模块，用于设置一个新的线程对象，其中包含一个 QApplication：

```
def initializePumpThread():
    global pumpedThread
    global app
    if pumpedThread == None:
        app = QtGui.QApplication(sys.argv)
        pumpedThread = threading.Thread(target = pumpQt, args = ())
        pumpedThread.start() 
```

然后设置一个函数来处理 Qt 事件：

```
def pumpQt():
    global app
    def processor():
        app.processEvents()
    while 1:
        time.sleep(0.01)
        utils.executeDeferred( processor ) 
```

你也可以用 wxPython 做类似的事情。（utils.executeDeferred 是 Maya 函数。）请务必查看wxPython wiki 上的如何创建[非阻塞 GUI 。](http://wiki.wxpython.org/Non-Blocking%20Gui)您需要设置一个事件循环，而不是 processEvents()，并检查上面的（希望重命名？）pumpQt 函数中的“待处理”事件。（wxPython 源代码有一个MainLoop 的[Python 实现](http://cvs.wxwidgets.org/viewcvs.cgi/wxWidgets/wxPython/samples/mainloop/mainloop.py)。）可能这应该通过 app.Yield() 函数来完成，但我不确定。

```
def pumpWx():
    global app
    def processor():
        app.Yield(True)
    while 1:
        time.sleep(0.01)
        utils.executeDeferred( processor )

def initializePumpThread():
    global pumpedThread
    global app
    if pumpedThread == None:
        app = wx.App(False)
        pumpedThread = threading.Thread(target = pumpWx, args = ())
        pumpedThread.start() 
```

wxPython 文档[表明 SafeYield()](http://www.wxpython.org/docs/api/wx-module.html#SafeYield)是首选。同样，这似乎是第一步，但我不确定它会起作用，而不仅仅是可怕的崩溃。[（在wxPython 邮件列表中](http://www.nabble.com/app.MainLoop-vs.-Pending-Dispatch-td17921845.html)有一些关于您想要做什么的讨论，但它来自 wx 之前的几个小版本。）在各种论坛中也有一些迹象表明这种技术会导致键盘输入问题。您也可以尝试这样做：

```
def processor():
  while app.Pending(): app.Dispatch() 
```

处理当前事件列表。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T19:41:38.260

我不知道是否有办法绕过 gui 的主循环，因为需要它来处理所有事件链和重绘队列。

但是有几种进程间通信方式，如管道或信号量。也许将您的 Maya 扩展拆分为实际插件、紧密集成到 Maya 以及​​用于 gui 的单独应用程序是一种选择。这两者可以使用这种方式在插件和gui之间进行通信和交换模型信息。但是，我不确定我是否真的可以推荐这种方法，因为它使应用程序非常复杂。

你可以看看 IPython，一个交互式 Python shell，它的开发团队已经努力将它与 wxPython 集成。他们有一些方法可以中断事件循环并连接到它来做自己的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-14T21:18:00.333

最好的方法是用你需要的东西创建一个 QWidget，并通过 C++ API 在 MPxCommand 中使用它。这样，您还有机会通过 scriptedPanel 将完整的自定义编辑器注入 Maya。

但是，如果您必须使用 Python，那么 pyQt 就是您要走的路。

# haskell - 相互递归——有人可以帮助解释这段代码是如何工作的吗？

> ID：397341
> 
> 赞同：5
> 
> 时间：2008-12-29T08:44:49.350
> 
> 标签：haskell, recursion

我正在阅读“A Gentle Introduction to Haskell”，并在早期使用了这个示例，该示例在 GHC 中运行良好，但在我的大脑中却非常糟糕：

```
initial                 = 0
next resp               = resp
process req             = req+1

reqs                    = client initial resps
resps                   = server reqs

server          (req:reqs)   = process req : server reqs
client initial ~(resp:resps) = initial : client (next resp) resps 
```

和调用代码：
`take 10 reqs`

我看到它的方式是`reqs`被调用，产生一个调用`client`args 0 和`resps`. 因此`resps`现在不需要被调用......这又会`reqs`再次调用？这一切似乎都是无限的......如果有人能详细说明它是如何工作的，我将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-29T15:12:29.723

我发现手动计算小型 Haskell 程序的行为通常是值得的。评估规则非常简单。要记住的关键是 Haskell*是非严格的*（也就是*惰性*的）：表达式仅在需要时才被计算。懒惰是看似无限的定义可以产生有用结果的原因。在这种情况下， using`take`意味着我们只需要无限列表的前 10 个元素`reqs`：它们就是我们“需要”的全部。

实际上，“需要”通常由模式匹配驱动。例如，列表表达式通常会被评估到我们可以区分函数应用之前`[]`和之前的点。`(x:xs)`（请注意，在`~`pattern 之前的 ' ' ，就像在 的定义中一样`client`，使它变得惰性（或*无可辩驳*）：惰性模式在强制整个表达式之前不会强制其参数。）

记住的`take`是：

```
take 0 _      = []
take n (x:xs) = x : take (n-1) xs 
```

评价`take 10 reqs`如下：

```
take 10 reqs 
      -- definition of reqs
    = take 10 (client initial resps)
      -- definition of client [Note: the pattern match is lazy]
    = take 10 (initial : (\ resp:resps' -> client (next resp) resps') 
                             resps)
      -- definition of take
    = initial : take 9 ((\ resp:resps' -> client (next resp) resps') 
                            resps)
      -- definition of initial
    = 0 : take 9 ((\ resp:resps' -> client (next resp) resps') 
                      resps)
      -- definition of resps
    = 0 : take 9 ((\ resp:resps' -> client (next resp) resps') 
                      (server reqs))
      -- definition of reqs
    = 0 : take 9 ((\ resp:resps' -> client (next resp) resps') 
                      (server (client initial resps)))
      -- definition of client
    = 0 : take 9 ((\ resp:resps' -> client (next resp) resps') 
                      (server (initial : {- elided... -}))
      -- definition of server
    = 0 : take 9 ((\ resp:resps' -> client (next resp) resps') 
                      (process initial : server {-...-}))
      -- beta reduction 
    = 0 : take 9 (client (next (process initial)) (server {-...-})
      -- definition of client 
    = 0 : take 9 (next (process initial) : {-...-})
      -- definition of take 
    = 0 : next (process initial) : take 8 {-...-}
      -- definition of next 
    = 0 : process initial : take 8 {-...-}
      -- definition of process 
    = 0 : initial+1 : take 8 {-...-}
      -- definition of initial 
    = 0 : 1 : take 8 {-...-}
      -- and so on... 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-29T10:20:07.363

理解这段代码需要两个技巧：

*   区分“定义”，它可能是无限的（如自然数集：）`naturals = (1 : map '\n->n+1' naturals`，或已处理请求的列表）和“减少”，这是将实际数据映射到这些定义的过程
*   看看这个客户端-服务器应用程序的结构：它只是一对相互交谈的进程：“客户端-服务器”是一个坏名字，真的：它应该被称为“wallace-gromit”或“foo-bar”，或者说话的哲学家或其他什么，但它是对称的：两方是同行。

正如[Jon](https://stackoverflow.com/questions/397341/mutual-recursion-can-someone-help-explain-how-this-code-works#397352)已经说过的那样，减少以一种懒惰的方式工作（又名“按需调用”）：`take 2 naturals`不会首先评估完整的自然集，而只是取第一个，并将其添加到`take 1 (map '\n->n+1' naturals)`，这将减少为 [1,( 1+1) ] = [1,2]。

现在客户端服务器应用程序的结构是这样的（在我看来）：

*   `server`是一种使用`process`函数从请求列表中创建响应列表的方法
*   `client`是一种基于响应创建请求并将该请求的响应附加到响应列表的方法。

如果仔细观察，您会发现两者都是“从 y:ys 创建 x:xs 的一种方式”。所以我们可以均匀地称它们为`wallace`和`gromit`。

现在很容易理解是否`client`只使用响应列表来调用：

```
someresponses = wallace 0 [1,8,9]    -- would reduce to 0,1,8,9
tworesponses  = take 2 someresponses -- [0,1] 
```

如果响应不是字面上已知的，而是由 产生的`gromit`，我们可以说

```
gromitsfirstgrunt = 0
otherresponses = wallace gromitsfirstgrunt (gromit otherresponses)
twootherresponses = take 2 otherresponses -- reduces to [0, take 1 (wallace (gromit ( (next 0):...) )]
                                          -- reduces to [0, take 1 (wallace (gromit ( 0:... ) )  ) ]
                                          -- reduces to [0, take 1 (wallace (1: gromit (...)  )  ) ]
                                          -- reduces to [0, take 1 (1 : wallace (gromit (...)  ) ) ]
                                          -- reduces to [0, 1 ] 
```

两个对等方之一需要“开始”讨论，因此提供给`wallace`.

还要注意 : 模式之前的 ~`gromit`这告诉 Haskell 不需要减少 list 参数的内容 - 如果它看到它是一个列表，那就足够了。[在有关 Haskell](http://en.wikibooks.org/wiki/Haskell/Laziness_revisited)的 wikibook 中有一个很好的主题（查找“惰性模式匹配”）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-29T08:57:07.780

自从我使用 Haskell 已经有一段时间了，但我很确定它是惰性评估的，这意味着它只计算它实际需要的东西。所以虽然 reqs 是无限递归的，因为`take 10 reqs`只需要返回列表的前 10 个元素，这就是实际计算的所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T21:19:12.993

它看起来像很好的混淆。如果您仔细阅读，您会发现它很简单：

下一个？这是身份

服务器？它只是 map 过程，即 map '\n->n+1'

客户？如何写 0 的方式很晦涩：服务器客户端，例如 0 : map '\n->n+1' [0: map '\n->n+1' [0:...]]

# cocoa-touch - 使用 UIImage 作为应用程序图标

> ID：397346
> 
> 赞同：1
> 
> 时间：2008-12-29T08:51:27.433
> 
> 标签：cocoa-touch

是否可以在代码中将图像设置为 iPhone 应用程序唯一图标，而不是添加 PNG 格式的图像文件并命名`Icon.png`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T13:19:41.637

a) 不，不适用于开发人员应用程序。另请注意，Apple 的预加载应用程序可以明显更改 Default.png（请参阅 Notes 应用程序），但我们其他人无法做到这一点。

b) 应用程序图标也可以是 jpeg 并且可以任意命名 - 您只需要在 Info.plist 中适当地设置它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T12:08:38.440

这是您将添加到 Info.plist 中的示例：

```
<key>CFBundleIconFile</key>
<string>app.png</string> 
```

这（以及其他相关选项）在[iPhone Application Programming Guide](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/chapter_3_section_4.html#//apple_ref/doc/uid/TP40007072-CH7-SW16)中有详细记录。

*注意：您可能需要一个 Apple 开发者帐户才能看到该链接*。

# asp.net - 如何在 ASP.NET 中创建子域并重定向到它们？

> ID：397355
> 
> 赞同：1
> 
> 时间：2008-12-29T09:02:23.073
> 
> 标签：asp.net, dns, response.redirect

如何在 ASP.NET 中创建子域？我的主页上的链接很少（Home.aspx）示例：Link1 和 Link2

我需要创建两个子域 link1.example.com 和 link2.example.com 并重定向到它们。我将使用 Response.Redirect 进行导航。

问题：文件是否需要驻留在不同的目录中？我可以在 localhost 上测试或模拟这个例子吗？

对这个新手 ASP.NET 程序员的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T15:21:43.653

根据您实际尝试通过这些重定向完成的任务，这可能很有用。如果您只是尝试从单个 Web 应用程序处理多个子域，则可以完全使用基于 IIS 的服务器在 ASP.NET 之外使用 ISAPI 重写工具托管单个 Web 应用程序来伪造此子域行为，例如Ionics Isapi 重写过滤器 ( [http://www.codeplex.com/IIRF](http://www.codeplex.com/IIRF) )，假设您能够将 ISAPI 过滤器添加到您的托管环境。

由于 ISAPI 过滤器在 ASP.NET 知道请求之前就已处理，因此您可以仅从一个 Web 应用程序托管多个子域（和完整域）。不幸的是，在 ASP.NET 内置 Web 服务器 (Cassini) 中模拟这种类型的重定向是不可能的，因为它不使用 ISAPI。此方法确实允许您测试最终子域的功能，但仅限于最终重定向位置；您也无法真正测试 Cassini 中的原始域映射，因为 Windows 主机文件不允许使用端口规则。

如果您将单个应用程序设置为具有处理所有所需子域的功能的页面，您可以简单地将子域的请求重定向到所需位置的单个应用程序中。这可以像在单个应用程序中处理新子域的所有逻辑的页面文件夹一样简单。以下是 Ionics 的一些示例重写规则，它们会将各种子域的请求发送到您的单个 Web 项目中的最终位置：

```
RewriteCond %{HTTP_Host} ^(?~new-sub-domain.yourdomain.com).*$ [I]
RewriteRule ^(.*)$ http://www.yourdomain.com/new-sub-domain$1 [I,R=302]
RewriteCond %{HTTP_Host} ^(?~another-new-sub-domain.yourdomain.com).*$ [I]
RewriteRule ^(.*)$ http://www.yourdomain.com/another-new-sub-domain$1 [I,R=302]
# '#' is a comment marker in the rewrite files
# [I] at the end means case-insensitive
# [L] at the end  means last rule (sending the request on but hiding the forward from the end user)
# [R] at the end  means an official redirect and can be used instead of [L] (the end user will then see a new request, such as a 301 redirect using [R=301]) 
```

这将导致对新子域的所有请求都转到您现有项目中的目录（分别为 /new-sub-domain/ 和 /another-new-sub-domain/）；可以修改它以将它们发送到该项目中您想要的任何位置。

虽然这种方法允许您从单个应用程序托管多个子域（可能还有几个完整的域），但 ASP.NET Web 服务器 (Cassini) 中对重定向/重写的限制将限制您测试这些最终的功能位置（例如，“/new-sub-domain/”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T09:20:26.033

您需要从您的域提供商（从您购买域名的地方）设置域和子域，而不是从您的 ASP.NET 网站。

在本地，您无法对此进行测试，因为您只能作为开发 Web 服务器访问[http://localhost 。](http://localhost)

# c# - 开发多语言windows应用程序C#

> ID：397356
> 
> 赞同：5
> 
> 时间：2008-12-29T09:02:44.650
> 
> 标签：c#, winforms, internationalization, multilingual

我在询问 C# 中用于支持 Windows 窗体中的多语言界面的常用技术

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T09:10:34.103

我在这里所说的一切：

[几年内将桌面应用程序国际化……我们现在应该做什么？](https://stackoverflow.com/questions/270829/internationalizing-desktop-app-within-a-couple-years-what-should-we-do-now)

适用于这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T09:29:49.650

我还建议查看这个工具：[Multilizer](http://www.multilizer.com/)。我一直在我的 CBuilder/Delphi 项目中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T09:08:24.780

您应该使用资源文件。例如，检查[这个 msdn 链接](http://msdn.microsoft.com/en-us/library/t18274tk.aspx)。

# wpf - 如何在日历控件的代码中将控件模板加载到资源字典中

> ID：397369
> 
> 赞同：1
> 
> 时间：2008-12-29T09:16:50.627
> 
> 标签：wpf, templates, calendar

我有一个 WPF 日历控件，并且当天的模板有一个名为

```
cal.DayTemplate = 
```

我创建了一个字典文件，其中包含我的日历当天的控制模板

但我不确定如何将其加载到`DayTemplate`属性中。

我已将我的字典添加到`Application.Resources`in`App.xaml`

我的`x:Key`控制模板是`x:Key="DayTemplate"`

所以我虽然加载它这会工作

```
cal.DayTemplate = new DataTemplate("DayTemplate"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T09:19:48.373

编辑：哎呀。自从我不得不这样做以来已经有一段时间了。

我相信你想要：

```
cal.DayTemplate = (DataTemplate)Application.Current.FindResource("DayTemplate"); 
```

看看这是否有效。

# design-patterns - Models, Factories and Repositories

> ID：397371
> 
> 赞同：3
> 
> 时间：2008-12-29T09:18:38.050
> 
> 标签：design-patterns, model

I'm porting our old Active-Record based API over to a new structure to make unit testing easier etc. We are using the repository pattern for our data access and StructureMap for dependency injection.

I'm struggling a little now with how to structure everything. Using our 'Product' class as an example, we previously had our model, repository and factory parts all built into the product object, for example to load, edit and save a product we could something like (simplified):-

```
Dim p As New Product
If(p.Load(1))
   p.Name = "New Name"
   p.Save()
End If 
```

And to get a collection of objects we had a Shared(static) method on the object which acted as a basic factory

```
Dim arrProds = Product.GetProducts() 
```

After looking at a few examples, in our new structure we now have an IProductRepository, IProductService (which is the factory) and Product model class. So, something like this

```
Dim prodSvc = ObjectFactory.GetInstance(Of IProductService)
Dim prod = prodSvc.GetProduct(1) //Prod is an Instance of 'Product'
prod.Name = "New Name"
prodSvc.Save(prod) 
```

However, the Product class has the ability to load related data, for example

```
Dim arrRelatedProds = prod.RelatedProducts 
```

Which inside the Product class looks like this

```
Class Product
    Function RelatedProducts() As IList(Of Product)
        // prodSvc is an instance of IProductService which is passed into the 
        // Product class in the constructor (or via Dependency Injection)
        Return Me.prodSvc.GetRelatedProducts(Me.ProductID)
    End Function
End Class 
```

I don't like this because it's difficult to test and because I don't like the fact that my 'Model' class (Product) calls the IProductService class directly.

Does anyone have any suggestions about a better way to structure all this?

Cheers

James

**EDIT** Probably the wrong time of year to ask this! Is there any clarification I can add to make this question answerable??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T10:43:16.817

I don't know if it's better or worse, but one way to structure it is to get rid of all smartness from your entity/data transfer object `Product`, and put everything including `Create`, `Retreive`, `RetreiveAll`, `Save`, `GetRelatedProducts`, etc. into `IProductService`. It would make your `Product` code simpler, and you don't have to worry which class does what.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T11:31:21.243

When using the repository pattern instead of active record, don't reference to the repository in the domain object (product). It's not impossible, but you save yourself a lot of trouble when you don't. The best thing you can do is using an ORM that supports lazy loading. Personally I use NHibernate for that. Make your repository dependent on your domain objects, but the domain objects independent of the repository. The best thing to do is not to inject anything at all in your domain objects.

# gdi - 如何通过 StretchDIBits 模仿缩略图周围的阴影？

> ID：397383
> 
> 赞同：0
> 
> 时间：2008-12-29T09:27:19.233
> 
> 标签：gdi, shadow, stretchdibits, alphablending

我现在正在编写一个图像查看器，它用于查看缩略图。由于它很丑，我决定画阴影圆形缩略图。

有背景色。我正在使用 StretchDIBits 在缩略图的位置绘制阴影图像。然而，它覆盖了背景颜色真的很烦人......当背景是白色时，它看起来很完美。但如果背景不是白色的，它有一个白色的边框。

所以我使用 AlphaBlend，首先将阴影图像绘制到 DC 上，然后使用 AlphaBlend 到背景上。但是，我仍然可以看到白色边框。

不管背景是什么，有什么理由要生成完美的阴影。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T09:35:44.380

您确定阴影位图包含 alpha 通道的 alpha 值吗？Iow：你是如何创建阴影位图的：你是通过模糊透明目标或白色目标上的正方形来做到这一点的吗？如果是第一个，阴影位图包含一个 Alpha 通道并且应该与背景很好地融合。如果是第二个，您的阴影位图包含白色片段，因此会将白色与背景混合。

# sql - MySQL 查找小计

> ID：397384
> 
> 赞同：1
> 
> 时间：2008-12-29T09:27:46.423
> 
> 标签：sql, mysql, group-by, aggregate, subtotal

编辑：

有人告诉我，让你们阅读意味着我得到的关注更少。我很抱歉。这是一个更简单的版本：

比尔从一家商店买了价值 100 美元的物品。

他想退回足够多的物品，以准确地拿回 30 美元。

商店有一个退货系统，可以帮助他做到这一点。

这是他扫描物品后的数据：

```
 item ¦   price ¦

socks             4.00
cheap tv         22.00
book on tape      9.00
book on paper     7.00
party hats        3.00
picture frame    10.00
hammer            5.00
juicer           16.00
mysql guide      24.00

total items  ¦ total price ¦
            9   100.00

Option 1
===============
item ¦          price ¦
cheap tv        22.00
party hats       3.00
hammer           5.00
===============

Option 2
===============
item ¦          price ¦

socks            4.00
picture frame   10.00
juicer          16.00
===============

Option 3
===============
item ¦          price ¦

book on tape    9.00
hammer          5.00
juicer         16.00 
```

我可能错过了一些选择，因为这一切都是我编造的。

所以，最大的问题是：

有没有办法（可能使用 GROUP BY）有一个查询可以返回任何可能的项目组合？

谢谢！

一种

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T09:48:46.537

您要求的所有子集总和正好为 30 美元。

这听起来很像[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)和[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)，所以我强烈怀疑你可以用一个简单的查询来做到这一点。您可能不得不求助于 T-SQL，但即使这样也可能看起来很难看。

我认为编程是通往这里的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T10:37:55.283

如果项目的数量足够小，您可以使用 SQL 强制执行此操作。这可能是一个快速编写的解决方案，但您可能想做一些更聪明的事情。听起来像是NP完全的“[背包问题”。](http://en.wikipedia.org/wiki/Knapsack_problem)

如果项目数量很大，您将需要深入研究动态规划算法。你必须问问自己这对你的申请有多重要。

如果项目的数量相对较少，您可以强制执行此操作。查找 1,2 或 3 个匹配项的组合的蛮力 SQL 语句（这是您所要求的）如下。如果这不令人满意，那么 SQL 可能不是这项工作的正确工具。

```
SELECT
   i1.id AS id1,
   NULL AS id2,
   NULL AS id3,
   i1.amount
FROM
   items i1
UNION ALL
SELECT
   i1.id AS id1,
   i2.id AS id2,
   i3.id AS id3,
   i1.amount + i2.amount AS total
FROM
   items i1,
   items i2
WHERE
   i1.amount + i2.amount = 30 AND
   i1.id <> i2.id AND
   i1.id <> i3.id
UNION ALL
SELECT
   i1.id AS id1,
   i2.id AS id2,
   i3.id AS id3,
   i1.amount + i2.amount + i3.amount AS total
FROM
   items i1,
   items i2,
   items i3
WHERE
   i1.amount + i2.amount + i3.amount = 30 AND
   i1.id <> i2.id AND
   i1.id <> i3.id AND
   i2.id <> i3.id 
```

在 Oracle 中，您将使用 CUBE 函数将其转换为通用版本，不确定 MySQL 是否等效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T09:40:01.627

我不认为 group by 可以做到。

我想不出比使用您选择的编程语言或使用存储过程查找/尝试所有排列更好的方法。

如果你有超过 30 美元的物品，你可以省略它们。

如果您想要通过某些标准获得“最佳”选项，将会有一些改进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T11:31:31.150

这个问题实际上是P/NP。例如，如果没有强力搜索，您可能无法找到最合适的商品价格，并且如果您的客户商店很大 - 您会发现该搜索非常持久。

您可以使用一些可以给您很好猜测的现有算法，但恐怕它们都是非SQL的。

我建议对您的问题进行近似：

创建过程/查询以找到最适合所需价格的一篇文章，然后再次调用它以获得新的更改。不完美，但会完成工作。

# .net - 如何对winforms应用程序进行单元测试

> ID：397386
> 
> 赞同：4
> 
> 时间：2008-12-29T09:29:21.023
> 
> 标签：.net, winforms, unit-testing

多亏了 ASP.NET MVC 框架，对 Web 应用程序进行单元测试成为可能。但是如何对 Windows 窗体应用程序进行单元测试呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T09:35:28.547

一种方法是为 Winforms 应用程序使用模型视图演示器 (MVP) 模式。如果您已经使用过 MVC，那么很容易适应

> 具体来说，将 MVC 的视图部分切得尽可能薄，使其只是实际 UI 组件周围的皮肤，使其完全被动。控制器，现在称为“演示者”，负责与系统其余部分的所有交互。

阅读一些很棒的文章。

[丹布内亚-点击阅读](http://danbunea.blogspot.com/2005/11/model-view-presenter-is-testing_27.html)

[杰里米·米勒 - 点击阅读](http://codebetter.com/blogs/jeremy.miller/articles/129546.aspx)

快乐编码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T09:38:06.043

典型的模式似乎是 MVP 模式。测试将针对模拟表单执行。

我也一直在试验可模拟的输入抽象并在测试时显示表单。只要弹出窗口不碍事，就很容易在表单中填写值。

最后，最有价值的路径可能是分解出可单元测试的代码，并为 UI 使用一些 UI 测试框架。

# javascript - Firefox 扩展如何在 3D 中使用整个屏幕（例如 CoolIris）？

> ID：397390
> 
> 赞同：3
> 
> 时间：2008-12-29T09:33:05.727
> 
> 标签：javascript, firefox, add-in, google-chrome, cooliris

我知道可以在 Javascript 和 Chrome 中创建[Firefox 插件。](http://www.mozilla.com/en-US/)

它们如何运行[CoolIris](http://www.cooliris.com/)等高级图形应用程序？

[![替代文字](https://i.stack.imgur.com/CqFWU.png)](https://i.stack.imgur.com/CqFWU.png)
[（来源：[cooliris.com](http://www.cooliris.com/static/images/product/slider1.png)）]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T10:27:48.690

Cooliris 在其支持的平台上使用利用图形加速的本机编译代码。

如果您使用 Flash，您可以获得全屏 GUI，但会通知用户（尝试全屏观看 YouTube 视频），并且用户无法做任何其他事情，例如使用键盘打字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T10:13:37.830

*“Firefox 插件可以用 Javascript 创建*”，这可能是真的 *“所有 Firefox 插件都是使用 javascript 创建的”*可能不是真的

Javascript 不是您创建 Firefox 插件的唯一方法，就像 Google 工具栏可能不是使用 javascript 创建的一样。Cooloris 使用的不仅仅是 javascript。Coolliris 可能会使用 javascript 或其他方式[删除](http://en.wikipedia.org/wiki/Web_scraping)Content，并使用自定义插件（或 Adob​​e Flash 之类的东西）来运行高级图形。

不过我可能是错的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T06:28:42.960

您必须使用 XPCOM 并编写本机代码。

# c# - 在 C# 中使用 DS 创建“一体化”函数

> ID：397396
> 
> 赞同：0
> 
> 时间：2008-12-29T09:41:11.687
> 
> 标签：c#, asp.net, design-patterns

在我的 Web 应用程序中，我使用了来自同一提供商的多个 asmx（Web 服务），他们有一个用于此，另一个用于那个，但都需要一个带有身份验证的 SOAP 标头。

添加身份验证很简单：

```
public static SoCredentialsHeader AttachCredentialHeader()
{
    SoCredentialsHeader ch = new SoCredentialsHeader();
    ch.AuthenticationType = SoAuthenticationType.CRM5;
    ch.UserId = "myUsername";
    ch.Secret = apUtilities.CalculateCredentialsSecret(
        SoAuthenticationType.CRM5, apUtilities.GetDays(), "myUsername", "myPassword");
    return ch;
} 
```

问题是这个 SoCredentialsHeader 来自一个网络服务（派生），我需要向其他网络服务添加相同的代码，例如：

```
public static wsContact.SoCredentialsHeader AttachContactCredentialHeader()
{
    wsContact.SoCredentialsHeader ch = new wsContact.SoCredentialsHeader();
    ch.AuthenticationType = wsContact.SoAuthenticationType.CRM5;
    ch.UserId = "myUsername";
    ch.Secret = apUtilities.CalculateCredentialsSecret(
        wsContact.SoAuthenticationType.CRM5, apUtilities.GetDays(), "myUsername", "myPassword");
    return ch;
}

public static wsDiary.SoCredentialsHeader AttachDiaryCredentialHeader()
{
    wsDiary.SoCredentialsHeader ch = new wsDiary.SoCredentialsHeader();
    ch.AuthenticationType = wsDiary.SoAuthenticationType.CRM5;
    ch.UserId = "myUsername";
    ch.Secret = apUtilities.CalculateCredentialsSecret(
        wsDiary.SoAuthenticationType.CRM5, apUtilities.GetDays(), "myUsername", "myPassword");
    return ch;
} 
```

有没有办法实现设计模式以便只使用一个功能但适合所有 web 服务？

有时我看到**T**字母，是这样的吗？如果是，我该如何完成这样的功能？

PS 我可以传递一个枚举并使用一个开关来检查枚举名称并应用正确的 Header 但每次我需要添加一个新的 WebService 时，我都需要添加枚举和代码，我正在寻找一种先进的技术.

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T04:49:44.113

在 VS 解决方案的任何位置创建一个名为whatever.tt 的文件（诀窍是.tt 扩展名）并粘贴以下代码：

```
using System;

namespace Whatever
{
    public static class Howdy
    {
<# 
    string[] webServices = new string[] {"wsContact", "wsDiary"};
    foreach (string wsName in webServices)
    {
#>
    public static <#=wsName#>.SoCredentialsHeader AttachContactCredentialHeader()
    {
        <#=wsName#>.SoCredentialsHeader ch = new <#=wsName#>.SoCredentialsHeader();
        ch.AuthenticationType = <#=wsName#>.SoAuthenticationType.CRM5;
        ch.UserId = "myUsername";
        ch.Secret = apUtilities.CalculateCredentialsSecret(<#=wsName#>.SoAuthenticationType.CRM5,
                apUtilities.GetDays(), "myUsername", "myPassword");
        return ch;
    }
    }       
<# } #>
} 
```

然后看着一个whatever.cs神奇地出现在所需的代码片段中。这些被称为在VS中生成代码的T4模板。

你会想把它们变成部分类或扩展方法或其他东西。上面的代码不会“按原样”运行，但你明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T10:06:24.210

我不知道这是否是您想要考虑的事情，因为它肯定有它的缺点，但是 - 因为最终这些（varoius SoCredentialsHeader 类）都是不同命名空间中相同类定义的副本，所以有一点点重构你可以简单地拥有一个类和一个方法。

将 SoCredentialsHeader 类定义复制到您自己的项目中，添加对它的引用并从所有 Web 服务的代理中删除该类定义。在代理代码文件的顶部添加一个 using 语句，它不会区分。

基本上，您告诉它对所有 Web 服务使用相同的类定义（您的）。

明显的缺点是，每当您更新和 Web 服务引用时，您都必须重复此练习（并且假设所有服务都继续使用相同的定义），但我们一直在类似的场景中这样做，并且它工作得很好我们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T03:59:00.830

我会尝试使用通用方法，然后使用反射来设置属性：

```
public static T AttachDiaryCredentialHeader<T>() where T: class
{
    T ch = new T();
    Type objType = ch.GetType();
    PropertyInfo userId = objType.GetProperty("UserId");
    authType.SetValue(ch, "myUsername", null)
    //And so on for the other properties...
    return ch;
} 
```

恕我直言，这有点 hacky，我会将它们分开，除非像上一篇文章提到的那样，您绝对确定这些服务的定义将保持不变。对其中一个的一个小改动将打破这一点。

# c++ - 从基类调用虚函数

> ID：397404
> 
> 赞同：64
> 
> 时间：2008-12-29T09:48:23.060
> 
> 标签：c++, polymorphism, virtual

假设我们有：

```
 Class Base
{   
    virtual void f(){g();};
    virtual void g(){//Do some Base related code;}
};

Class Derived : public Base
{   
    virtual void f(){Base::f();};
    virtual void g(){//Do some Derived related code};
};

int main()
{
    Base *pBase = new Derived;
    pBase->f();
    return 0;  
} 
```

`g()`将从哪个调用`Base::f()`？`Base::g()`还是`Derived::g()`？

谢谢...

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-29T09:52:41.680

将调用派生类的 g。如果要调用基中的函数，请调用

```
Base::g(); 
```

反而。如果您想调用派生版本，但仍希望调用基本版本，请安排 g 的派生版本在其第一条语句中调用基本版本：

```
virtual void g() {
    Base::g();
    // some work related to derived
} 
```

模板方法设计模式中使用了来自基类的函数可以调用虚方法并将控制权转移到派生类的事实。对于 C++，它更广为人知的是[Non-Virtual-Interface](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Non-Virtual_Interface)。它在 C++ 标准库中也被广泛使用（例如，C++ 流缓冲区具有`pub...`调用执行实际工作的虚函数的函数。例如`pubseekoff`调用 protected `seekoff`）。我在这个答案中写了一个例子：[你如何验证对象的内部状态？](https://stackoverflow.com/questions/343605/how-do-you-validate-an-objects-internal-state#343628)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-19T04:18:01.497

它是 Derived::g，除非你在 Base 的构造函数中调用 g。因为在构造 Derived 对象之前调用了 Base 构造函数，所以在逻辑上无法调用 Derived::g，因为它可能会操作尚未构造的变量，因此会调用 Base::g。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-28T20:56:32.187

pBase 是一个指向基址的指针。pBase = new Derived 返回一个指向 Derived - Derived is-a Base 的指针。

所以 pBase = new Derived 是有效的。

pBase 引用了一个 Base，因此它会将 Derived 视为一个 Base。

pBase->f() 将调用 Derive::f();

然后我们在代码中看到：

Derive::f() --> Base::f() --> g() - 但是哪个 g??

好吧，它调用 Derive::g() 因为那是 pBase “指向”的 g。

答案：派生::g()

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-29T19:20:54.527

嗯......我不确定这应该编译。以下，

```
Base *pBase = new Derived; 
```

无效，除非您有：

```
Class Derived : public Base 
```

是要你的意思吗？如果这是你的意思，

```
pBase->f(); 
```

然后调用堆栈将如下所示：

```
Derived::f()
    Base::f()
        Derived::g() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T10:15:35.330

由于您已将 g() 定义为虚拟，因此将在类的 vtable 中查找最派生的 g() 并调用，无论您的代码当前正在访问它的类型如何。

请参阅[有关虚函数的 C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/virtual-functions.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T07:30:04.977

实际运行您的代码表明调用了 Derived::g() 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-29T10:06:30.340

我认为您试图发明[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-23T01:51:19.850

将调用派生类的方法。

这是因为在具有虚函数的类和覆盖这些函数的类中包含了虚表。*（这也称为动态分派。）*这是真正发生的事情：创建`Base`一个 vtable 并创建一个 vtable `Derived`，因为每个类只有一个 vtable。因为`pBase`正在调用一个虚函数并被覆盖，所以调用了一个指向 vtable 的指针`Derived`。调用它`d_ptr`，也称为 vpointer：

```
int main()
{
    Base *pBase = new Derived;
    pBase->d_ptr->f();
    return 0;  
} 
```

现在 d_ptr 调用`Derived::f()`，调用`Base::f()`，然后查看 vtable 以查看`g()`要使用的内容。因为 vpointer 只知道`g()`in `Derived`，所以我们使用的就是那个。因此，`Derived::g()`被称为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-03T09:58:25.213

如果在成员函数中，将调用派生类的 g()。

如果在构造函数或析构函数中，将调用基类的 g()。

[https://www.geeksforgeeks.org/calling-virtual-methods-in-constructordestructor-in-cpp/](https://www.geeksforgeeks.org/calling-virtual-methods-in-constructordestructor-in-cpp/)

```
// calling virtual methods in constructor/destructor
#include<iostream> 
using namespace std; 

class dog 
{ 
public: 
    dog()  
    { 
        cout<< "Constructor called" <<endl; 
        bark() ; 
    } 

    ~dog() 
    {  
        bark();  
    } 

    virtual void bark() 
    {  
        cout<< "Virtual method called" <<endl;  
    } 

    void seeCat()  
    {  
        bark();  
    } 
}; 

class Yellowdog : public dog 
{ 
public: 
        Yellowdog()  
        { 
            cout<< "Derived class Constructor called" <<endl;  
        } 
        void bark()  
        { 
            cout<< "Derived class Virtual method called" <<endl;  
        } 
}; 

int main() 
{ 
    Yellowdog d; 
    d.seeCat(); 
} 
```

输出：

```
Constructor called
Virtual method called
Derived class Constructor called
Derived class Virtual method called
Virtual method called 
```

# mysql - 数据库设计问题

> ID：397410
> 
> 赞同：4
> 
> 时间：2008-12-29T09:52:43.050
> 
> 标签：mysql, database, financial

我以原始形式（csv 和二进制）积累了相当多的数据——准确地说是几个月每天 4GB。

我决定加入文明世界并使用数据库来访问数据，我想知道正确的布局是什么；格式非常简单：每次报价几行（出价、要价、时间戳等）x 高达 50 万/天 x 数百种金融工具 x 月数据。

在商品硬件（2 x 1GB RAID 0 SATA，核心 2 @ 2.7GHz）上运行有一个带有 MYISAM 的 MySQL 服务器（我理解这将是此类使用的正确引擎）

**数据库的正确布局是什么？表格/索引应该是什么样子？这种情况的一般建议是什么？你会预测什么会让我在此过程中陷入陷阱？**

编辑：我的常见用法是提取特定日期和仪器的时间序列信息的简单查询，例如

```
SELECT (ask + bid) / 2
  WHERE instrument='GOOG'
  AND date = '01-06-2008'
  ORDER BY timeStamp; 
```

编辑：我试图将我的所有数据填充到一个由 timeStamp 索引的表中，但它太慢了 - 因此我认为它需要一个更复杂的方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T10:04:54.010

您并没有真正说出您的背景以及您对编程和[数据库设计](http://en.wikipedia.org/wiki/Database_design)的了解程度。听起来你应该做一些阅读。从概念上讲，尽管您的设计相当简单。您的描述仅确定了两个实体：

*   金融工具；和
*   引用。

所以你需要然后识别属性。

金融工具：

*   安全码;
*   市场;
*   等等

引用：

*   时间戳；
*   金融工具；
*   竞标价格; 和
*   问价格。

对金融工具的引用就是所谓的[外键](http://en.wikipedia.org/wiki/Foreign_key)。每个表还需要一个[主键](http://databases.about.com/cs/administration/g/primarykey.htm)，可能只是一个自增字段。

概念上相当简单。

```
CREATE TABLE instrument (
  id BIGINT NOT NULL AUTO_INCREMENT,
  code CHAR(4),
  company_name VARCHAR(100),
  PRIMARY KEY (id)
);

CREATE TABLE quote (
  id BIGINT NOT NULL AUTO_INCREMENT,
  intrument_id BIGINT NOT NULL,
  dt DATETIME NOT NULL,
  bid NUMERIC(8,3),
  ask NUMERIC(8,3),
  PRIMARY KEY (id)
)

CREATE INDEX instrument_idx1 ON instrument (code);

CREATE INDEX quote_idx1 ON quote (instrument_id, dt);

SELECT (bid + ask) / 2
FROM instrument i
JOIN quote q ON i.id = q.instrument_id
WHERE i.code = 'GOOG'
AND q.dt >= '01-06-2008' AND q.dt < '02-06-2008' 
```

如果您的数据集足够大，您可能希望在表中包含 (bid + ask) / 2，这样您就不必即时计算。

好的，这就是标准化视图。在此之后，您可能需要开始进行性能优化。考虑这个关于[在 MySQL 中存储数十亿行的](https://stackoverflow.com/questions/365380/large-primary-key-1-billion-rows-mysql-innodb)问题。分区是 MySQL 5.1+ 的一个特性（相当新）。

但是要问自己的另一个问题是：您需要存储所有这些数据吗？我问这个的原因是我以前从事在线经纪工作，我们只在一个非常有限的窗口中存储所有交易，交易将是比报价更小的数据集，你似乎想要的。

存储数十亿行数据是一个严重的问题，您确实需要认真的帮助来解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T10:10:47.010

您需要做的是阅读[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)。如果你觉得那篇文章太多，你应该简单地浏览一下[第三范式](http://www.google.com/search?hl=en&rlz=1C1GGLS_nbNO293NO303&q=third+normal+form+tutorial&btnG=Search)教程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T10:45:31.103

当在报价级别存储数据时，许多金融数据库至少按工具对数据进行分区，因为很少需要跨工具运行查询。所以每个仪器一张桌子是正常的。有些更进一步，还按日期进行分区，为每个仪器/日期组合提供一个表格。如果跨日期查询是常态，这会使查询变得更加困难。

所以有两个选择：

1.  每个工具都有一个刻度表，时间戳上有一个聚集索引
2.  每个工具/日期的刻度表，时间戳上有一个聚集索引

这是访问速度和查询方便性之间的基本权衡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T14:41:44.403

或者也许考虑一个星型模式、维度和事实。Ralph Kimball 有一些[好东西](https://rads.stackoverflow.com/amzn/click/com/0471200247)可以告诉你如何去做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T02:42:47.770

Dani，我多年来一直在与 Tick by Tick data 合作，并且很乐意在这方面进行合作。在 Hotmail 给我发电子邮件给 IanTebbutt。（顺便说一句，我已经检查过了，没有办法在 StackOverflow 上发送私人电子邮件，而 Jeff 似乎反对它[被拒绝，](http://stackoverflow.uservoice.com/pages/general/suggestions/99462-allow-private-messages "没有私信")。）

简而言之，我发现按日期和仪器进行分区效果很好。您可以选择使用 InstrumentX_YYDD 之类的模式将仪器 X 的一个月数据放入一组表中。然后在访问数据时，您至少需要一个表名生成器，但更可能是一个 sql 生成器，它可以决定使用哪个表，或者可能使用联合来查看多个表。

无论您如何看待这些数据量都不容易处理。这接近于 DataWarehouse 领域，并且有很多方法可以剥去那只猫的皮。就像我说的，很高兴合作 - 我可能已经解决了一半的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T15:19:17.073

只是一些一般性的观察：

*   不要使用`TIMESTAMP`列，因为它是根据`INSERT`时间自动设置的。由于您正在导入数据，这不是您想要的。
*   如果使用 MySQL`DATETIME`列类型，则可以在其上使用 MySQL[日期和时间函数](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html)。
*   MyISAM 不支持`FOREIGN KEY`约束并默默地忽略它们。
*   索引，索引，索引。确保将它们放在将用于查找的列上。但是，如果您有包含大量文本的列，您可能希望对它们使用[`FULLTEXT`搜索](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)。
*   如果你打算把它变成一个带有`INSERT`s 和`SELECT`查询的实时数据库，考虑使用带有事务和行级锁定的 InnoDB ( [`SELECT ... FOR UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html))

# c# - C# 中高度可定制的应用程序（如 Apache Ofbiz）

> ID：397412
> 
> 赞同：2
> 
> 时间：2008-12-29T09:56:40.173
> 
> 标签：c#, architecture

我最近一直在探索 Apache Ofbiz，并对其自定义应用程序大部分区域的能力印象深刻：UI、工作流、实体。

是否有任何用 C#/.Net 开发的类似（不一定是 ERP 系统）应用程序提供类似级别的定制？

我正在寻找用 C# 开发的在 UI、工作流和实体模型方面高度可定制的应用程序示例

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T09:26:45.443

这并不完全符合您的要求，但请查看[托管可扩展性框架 (MEF)](http://www.codeplex.com/MEF)，这是一个用于 C# 中可定制应用程序的好工具包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T11:23:26.503

我实际上在开发这样一个应用程序，它叫做 Synergi (www.synergi.com)。工作流和 UI 基本上在数据库中描述并在客户端呈现（ASP.net）。如果您想了解更多信息，请联系我或公司。:)

# delphi - 将 tdbgrid 的部分复制到剪贴板？

> ID：397413
> 
> 赞同：2
> 
> 时间：2008-12-29T09:57:11.933
> 
> 标签：delphi, clipboard

有什么方法可以轻松地将 Delphi 2007 中的 TDBGrid 中的行选择复制到剪贴板？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T13:15:42.877

这个方法来自我们内部的库单元..

```
procedure BuildListFromDBGrid(DBGrid: TDBGrid; const FieldName: String; Strings :TStrings);
var
  i: Integer;
begin
  Strings.Clear();
  with DBGrid do
     begin
        Strings.BeginUpdate(); // If assocated with a UI control (Listbox, etc), this will prevent any flickering
        DataSource.DataSet.DisableControls();
        try
          for i := 0 to (SelectedRows.Count - 1) do
             begin
               Datasource.DataSet.GotoBookmark(Pointer(SelectedRows[i]));
               Strings.Add(DataSource.DataSet.FieldByName(FieldName).AsString);
             end;
        finally
           DataSource.DataSet.EnableControls();
           Strings.EndUpdate();
        end;
     end;
end; 
```

要将所选项目的列表添加到剪贴板，请将 Clipbrd 添加到您的 uses 子句并调用过程..

```
var
  SelectedItems :TStringList;
begin
  SelectedItems := TStringList.Create();
  try
    BuildListFromDBGrid(MyDBGrid, 'InvoiceID', SelectedItems);
    Clipboard.AsText := SelectedItems.Text;
  finally
    SelectedItems.Free();
  end;
end; 
```

当然，您可以修改上述方法或创建一个新方法，直接将所选项目添加到剪贴板（例如，多个字段，以特殊格式等）

# c# - 关于 IndexOf 过度执行的问题

> ID：397415
> 
> 赞同：1
> 
> 时间：2008-12-29T09:57:58.687
> 
> 标签：c#, collections, indexof

我在 C# 中有一个优先级队列实现，我想添加一个 .IndexOf 方法。

但是，由于优先级队列并不真正关心值本身的顺序（也就是说，如果我只是抓取所有值，而忽略它们的优先级，它们根本就不一定有任何顺序），只有它们的优先级，我对优先级队列的泛型 T 没有任何标准，也就是说，我没有指定它们需要具有某种内在顺序或*可比性*。

因此，当我开始实施时，我遇到了`.IndexOf(T value)`一个小问题。

有什么/我应该如何实施的标准吗？我最初的想法只是用来`EqualityComparer<T>.Default`判断我是否找到了`value`，但是现在有很多类似的类型。

例如，这是我想出的覆盖我的基础的东西，但这似乎有点过分了：

*   `public Int32 IndexOf(T value)`（内部调用其他之一`ClassThatImplementsInterface.Default`）
*   `public Int32 IndexOf(T value, IComparer<T> comparer)`
*   `public Int32 IndexOf(T value, IEqualityComparer<T> comparer)`
*   `public Int32 IndexOf(T value, IEquatable<T> comparer)`
*   `public Int32 IndexOf(T value, Predicate<T> predicate)`

你做什么工作？将其标记为主观和维基，因为这更像是民意调查而不是其他任何事情。

在重新阅读我自己的问题时，我想我可以只使用没有比较器的问题，然后添加谓词版本，这样这个类的用户几乎可以调用任何东西。

另请注意，我也可以`pq[index]`获取同时包含优先级和值本身的项目，因此我也可以完全不使用 IndexOf，但我也希望有方法可以*更改值的优先级X 优先级 P*，这将需要某种形式的 IndexOf/search 内部。因此，我还想避免所有这些方法的无数次重载。

* * *

**对评论的回应**：是的，优先级队列是基于堆的。

基本上，这两个类是这样定义的：

```
public class Heap<T> : IEnumerable<T>, ICloneable { ... }
public class PriorityQueue<T> : Heap<PriorityQueueElement<T>> { ... } 
```

PriorityQueueElement 是一个简单的不可变结构，具有 Priority 和 Value 属性。

**Response to forthcoming comment**: Since the priority queue is based on a heap, an "interesting property" is that by changing the priority of a value through its index means that afterwards, the value won't necessarily be at that index. I intend to just document this as in some cases I foresee a need for independent locate/change-priority operations.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T10:08:47.480

I would make the comparison an optional constructor parameter; this is comparable to how things like `Dictionary<,>`, `SortedList<,>` etc allow you to specify the comparison mechanism.

是否接受 an`IComparer<T>`或 an`IEqualityComparer<T>`取决于您是要对数据进行排序，还是只寻找相等匹配；如果匹配，那么您将需要类似`IEqualityComparer<T>`. 不幸的是，由于 this 有 2 个方法 (`GetHashCode()`和`Equals()`)，因此没有直接的委托版本，除了`Predicate<T>`or `Func<T,T,bool>`。

对于默认构造函数，我会传入`[Equality]Comparer<T>.Default`.

# .net - 如何在没有登录窗口会话的情况下运行 GUI 应用程序？

> ID：397417
> 
> 赞同：1
> 
> 时间：2008-12-29T09:59:05.223
> 
> 标签：.net, user-interface, windows-services

我的目标是注销当前会话，然后删除正在运行的本地用户配置文件。而且我已经有一项服务可以删除配置文件。

我的问题是，用户不知道后台服务以及谁可能关闭机器或过早重新登录。

这个想法是该服务将显示一些弹出窗口，并且在后台作业完成之前不会显示“欢迎使用 Windows”。

我已经阅读了一些无需登录即可运行 GUI 应用程序的技巧，但我找不到如何操作。

如何在 Windows XP 和 Vista 上完成？

我老板的另一个想法是“关闭并安装 Windows 更新”，但执行我们的应用程序而不是补丁安装程序。那时如何安装我的应用程序挂钩？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T04:52:54.863

我认为如果您在 Vista 以外的系统上运行，您将需要替换 GINA dll。这将为您提供登录过程的适当挂钩以执行您的工作。

在 Vista 中，您根本无法做到这一点，因为 GINA 被替换为凭据提供程序，用户注销时不会查询这些凭据提供程序。

此外，如果有人通过终端服务或通过另一个对 LogonUser 的调用登录机器，我在您的问题中没有提到任何内容。在用户注销时删除配置文件是一个坏主意，因为他们可能会多次登录，因此您必须考虑到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T12:51:55.623

您可以将用户添加到“Guests”组吗？我相信这会阻止配置文件在他们的会话之外持续存在，尽管这可能是 poledit 中的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T03:07:53.150

我从未尝试过这样的事情，但我认为您应该能够将弹出应用程序放在您在组策略中定义的注销脚本中（使用 gpedit.msc）。

我很想知道这是否对你有用，以便我自己的启迪，所以让我们知道。

# scripting-language - 何时使用脚本语言？

> ID：397418
> 
> 赞同：28
> 
> 时间：2008-12-29T10:01:48.087
> 
> 标签：scripting-language

什么时候应该使用脚本语言而不是像 C++ 这样更冗长的编译语言。C# 还是 Java？

为了让这个问题更有趣，让我们回答这样的问题：

**当...空白...时，您应该使用脚本语言**

**当你需要 A 时，使用脚本语言 X。**

**当您需要 B 时，请使用脚本语言 Y。**

**当您需要 C 时，请使用脚本语言 Z。**

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-29T10:07:08.217

当开发速度比执行速度更重要时，您应该使用脚本语言。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-29T11:03:39.913

添加脚本语言作为大型编译系统的**组件**是一种常见模式：系统的编译部分针对执行速度进行了优化，但更难修改（因为必须编译和重新加载），而系统的脚本部分该系统针对灵活性进行了优化，运行速度较慢，但​​任何人都可以使用文本编辑器快速轻松地进行修改。

如果您想让应用程序的部分功能易于定制，您将使用此模式。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-29T10:25:24.530

这有点宗教问题。我将脚本语言用于临时任务，例如：

*   在万行日志中查找特定项目
*   生成性能图
*   数据缩减 - 将文本文件转换为所需的格式
*   从数据库中获取特定的数据子集并将其打包为文本文件

所有这些也可以用编译语言来完成，但对我来说，用脚本语言来完成它们更快更容易（我使用 ruby​​，但 PERL 和 python 就可以了）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-29T11:18:40.147

我倾向于使用脚本语言进行快速原型设计、实验和数据处理。例如，如果我有一堆文本文件需要预处理并作为一次性操作构建到数据库装置中，我通常会编写脚本。

然而，如今，“脚本”和“编译”之间的界限变得越来越模糊，出现了像 groovy 和 ruby​​ 这样的语言。对于上面提到的任务，我将使用 ruby​​，但我也将使用它来构建一个带有 rails 的生产 webapp。我将用 java 编写桌面应用程序，但 groovy 也允许我融入脚本。即使在用 C/C++ 编写时，我发现一个有用的模式是嵌入特定领域的脚本语言（例如 tcl，虽然我不太喜欢那种语言）。

我认为语言的实际选择是一种宗教选择，尽管有一些显而易见的权衡（例如可读性 - perl 很有用，但太容易编写神秘的脚本。在某些方面它是“只写”语言 ：-）。在过去，我使用过 bash+awk+sed、一些 perl、ruby 等……对于一次性任务，这主要取决于您和您团队的其他成员对什么感到满意。这些天我有意识地选择使用 ruby​​，即使我在 bash/awk/sed 中做同样的事情会更快一些，但这只是为了通过在其中做尽可能多的任务来提高我的 ruby​​ 技能。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-29T14:28:49.750

这是我的层次结构：

尝试使用 grep。

如果你不能用 grep 做到这一点，请使用 sed。

如果 sed 不够强大，请使用 awk。

如果 awk 不够强大（或开始变得非常难看），请使用 C、C++ 或您选择的其他成熟的通用编程语言。

请注意，在 awk 和 C 之间没有“脚本语言”。这是故意的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-29T10:35:48.020

我发现脚本语言在有适合该语言优势的特定任务时非常有用（例如，使用 perl 进行字符串处理，使用 ruby​​ 进行 Web 开发等等）。特别是对于 Web 开发脚本语言具有更快地向您显示代码更改结果的特性。

在某些情况下，您将编译语言与脚本语言混合在一起——比如在某些游戏中。当您可以在脚本语言中比在编译语言中更快、更清晰、更简单地表达少量行为时，这样做很有用。例如，C++ 是一种表达能力很强的语言——但它的开发成本比 lua 高。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-29T14:22:45.440

我认为何时使用脚本语言没有一般规则。脚本语言很容易开发，但有时很难维护，尤其是当脚本应该在不同平台（操作系统）下运行时。

脚本语言的优点当然是：

*   您可以让用户（或客户）自己更改脚本中的某些内容。
*   它很容易开发——大多数脚本语言都不是类型安全的，这使得在小型应用程序中开发变得更加容易，当然
*   但是 - 它是独立于平台的......

反派是：

*   它是开源的 - 每个人都可以看到您的代码，并且可以在他们自己的竞争产品中使用您的知识...
*   它在运行时缓慢...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-29T10:50:55.103

我使用脚本语言来挖掘数据并将它们作为 cron 作业提供给数据库。它更容易，因为我可以在 unix 中使用 windows 调度程序或 crontab 轻松设置它们，并且由于 perl 中的一些关键特性（如 regex），我发现它更容易编写。

加上 CPAN 提供给我的数百万个模块......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-29T14:10:19.240

当交互操作很重要时使用脚本语言，例如命令行外壳，或者您正在导出功能供其他用户在简单操作中使用。（他们不应该编译；脚本就足够了）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-15T21:41:50.133

如果您打算编写一次或保持简单，请使用脚本语言。一旦您的项目变得更大，强类型语言会更好。想想看，一个大型项目花费了多少时间进行初始开发与集成和维护。您是否愿意维护大量脚本或强制类型行为的强类型语言？

# c++ - 谁能给我一个使用 CreateHatchBrush 的样本

> ID：397420
> 
> 赞同：0
> 
> 时间：2008-12-29T10:04:34.057
> 
> 标签：c++, gdi, thumbnails

我想在我的软件中围绕缩略图绘制阴影。似乎 CreateHatchBrush 可以提供帮助，但我不知道如何使用它，任何人都可以提供 C++ 中的示例吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T15:49:58.603

我没有示例，但有一些关于 Windows 中画笔一般用法的提示。

`CreateHatchBrush()`返回一个句柄。您需要使用该句柄使该笔刷成为您用于渲染的设备上下文中的当前笔刷。调用设备上下文的`SetObject`函数（普通 Windows GDI 调用版本）：

```
HDC myDC = GetDC (hWnd); //pass your window handle here or NULL for the entire screen  
HBRUSH hatchBrush = CreateHatchBrush (HS_DIAGCROSS, RGB (255,128,0));  
HBRUSH oldBrush = SelectObject (myDC, hatchBrush);  
//draw something here  
SelectObject (myDC, oldBrush); //restore previous brush  
ReleaseDC (myDC); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T00:51:30.723

最简单的选择是使用[GDI+](http://msdn.microsoft.com/en-us/library/ms533798(VS.85).aspx)来执行此操作。这是一个快速而肮脏的阴影渲染示例：

```
void Render( HDC hdc )
{
    Graphics gr( hdc );
    Image image( L"sample.jpg" );
    const int SHADOW_OFFSET = 7;

    //
    // draw shadow
    //
    SolidBrush shadow( Color( 190, 190, 190 ) );
    Rect rc( 50, 50, image.GetWidth(), image.GetHeight() );
    rc.Offset( SHADOW_OFFSET, SHADOW_OFFSET );
    gr.FillRectangle( &shadow, rc );

    //
    // draw the image
    //
    gr.DrawImage( &image, 50, 50, image.GetWidth(), image.GetHeight() );

    //
    // draw a border
    //
    Pen border( Color( 0, 0, 0 ), 1 );
    rc.Offset( -SHADOW_OFFSET, -SHADOW_OFFSET );
    gr.DrawRectangle( &border, rc );
} 
```

希望这可以帮助！

# functional-programming - 何时使用函数式编程语言？

> ID：397425
> 
> 赞同：97
> 
> 时间：2008-12-29T10:07:13.850
> 
> 标签：functional-programming, language-agnostic

在哪些情况下我应该选择使用函数式编程语言而不是更冗长的面向对象语言，如 C++、C# 或 Java？

我了解什么是函数式编程，但我真正不了解的是对于哪些类型的问题它是完美的解决方案？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-12-29T20:17:54.460

我自己对此进行了一些研究，并认为我可以将 CONCURRENCY 添加到使用函数式语言的原因列表中。看到在不久的将来处理器速度将无法提高使用相同的 cpu 技术。建筑的物理特性不允许这样做。

这就是并发处理的用武之地。

不幸的是，由于数据之间的相互依赖性，大多数 OOP 语言不能同时利用多个处理器。

在纯函数式编程语言中，计算机可以同时运行两个（或更多）函数，因为这些函数不会改变外部状态信息。

这是一篇关于函数式编程的[优秀文章](http://www.defmacro.org/ramblings/fp.html)，您可能会喜欢。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-12-29T10:20:19.640

在我看来，函数式语言主要有两个好处：游戏 AI 和数学计算。它在游戏 AI 中很好，因为它有很好的列表操作（至少在 Lisp 和 Scheme 中），并且因为它的语法而适用于数学计算。Scheme、Lisp 和 Haskell 的语法使数学计算易于阅读。我要补充的最后一件事是函数式语言是非常有趣的语言。我的 Scheme 课程是我玩得最开心的课程之一。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-29T14:02:51.330

我的一个朋友引用他的一位大学教授的话如下：

> 在顶部绘制一个带有数据类型的网格，在左侧绘制对这些数据类型的操作。如果你垂直分割网格，你就是在做 OO；如果你水平切割网格，你正在做 FP。

我的回答是，FP 是一种完全可行的编程方法，其应用范围与 OO 一样广泛。与任何编程语言选择讨论一样，我认为更重要的问题是：

1.  你有时间花时间学习一种新的符号和一种新的思维方式吗？
2.  您正在考虑哪种语言具有足够丰富的库，您不会陷入重新发明一些轮子的困境？

至于第一个问题，如果您这样做主要是为了学习价值，我建议您查看[Haskell](http://www.haskell.org/)，因为支持材料（书籍、文章、活跃的社区等）的范围很广

至于第二个问题，Haskell 有很多库（虽然有些比其他的更成熟），但[Scala](http://www.scala-lang.org/)（一种运行在 JVM 上的混合 OO 函数式语言）具有可以更逐步过渡到函数式风格的优点，并且您可以使用全系列的 Java 可访问库。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-29T14:17:06.467

实际上，您在 PP 中可以做的所有事情都可以在 FP 中完成，反之亦然。这只是另一种编码方式——对问题的另一种看法和解决问题的不同方法。

但是，因为使用 FP 的人不多，所以问题更多在于缺乏好的库、可移植性/可维护性（因为维护者比 Scheme 更容易理解用 C++ 编写的东西），以及缺乏文档和社区。我知道有一些文档，但是，将其与 C++、C# 或 Java 进行比较，您就会明白我的意思。

但是，如果你真的想做 FP，你甚至可以在 C++ 和 C# 中使用这种风格。当然，如果你使用标准库，它不会是 100% 的 FP。不幸的是，我认为 C# 没有针对函数式编程进行优化，它可能会产生很多性能问题。

这更像是一个主观的帖子，我对 FP 的看法。这不是一个严格的声明。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-29T10:25:47.510

虽然这是一个相当主观的问题，但我想补充一点，函数式语言被大量用于解析[特定领域的语言](http://en.wikipedia.org/wiki/Domain-specific_language)；函数性质非常适合语法分析。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-29T11:25:42.240

函数式语言在很多情况下都很好。它取决于特定功能语言的库。

您将如何回答“何时使用面向对象的编程语言？”这个问题？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-29T14:50:47.117

据我所见，这更多的是品味问题而不是功能问题（不是双关语）。任何一种语言风格都没有任何东西可以使其在特定任务中天生更好或更差。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-29T15:14:42.997

一般来说，使用最容易表达问题解决方案的语言。对于函数式编程，这是一个问题的解决方案很容易用*函数*表示的时候，因此得名。一般适用于数学运算、人工智能、模式匹配；一般来说，任何可以分解为一组规则的东西，必须应用这些规则才能得到答案。只有在充分分析了您的问题之后，您才能真正确定要使用的“最佳”语言。这就是伪代码派上用场的地方。如果您发现自己编写的伪代码看起来像 FP，请使用 FP。

当然，所有完整的编程语言在功能上都是等效的，所以就可以解决的问题而言，选择哪一种并不重要。主要影响将是编码效率和准确性，以及易于维护。

另请注意，可以通过巧妙设计的 API 在 OO 语言中模仿 FP。例如，我见过许多使用方法链来模拟 FP DSL 的 Java 库（JMock 就是一个例子）。然后你会看到如下结构：

`logger.expects(once()).method("error") .with( and(stringContains(action),stringContains(cause)) );`

这实质上构建了一个函数，该函数被评估以确定模拟对象上的某些调用序列是否正确。[（示例从http://www.jmock.org/yoga.html](http://www.jmock.org/yoga.html)窃取）

在其他 OO 语言中，另一种类似 FP 的语法是使用闭包，例如在 Ruby 中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-12-31T22:08:58.257

我认为以前的帖子是正确的，这里是一个简短的列表，函数式编程是以下问题的完美解决方案：

*   无状态处理
*   包括 ML（机器学习）在内的数学方程
*   不可变进程
*   当您需要可扩展的并发性时

# c# - XSD类生成嵌套表问题

> ID：397426
> 
> 赞同：5
> 
> 时间：2008-12-29T10:07:17.903
> 
> 标签：c#, xml, .net-2.0, xsd

目前，我在从具有重复元素的 xsd 生成类文件时遇到问题。我在 VS2005 SP1 中使用自定义工具“MsDatasetGenerator”，从 xsd 为 c# 创建一个类型化的数据集。我正在尝试通过此架构解析 xml

```
 <?xml version="1.0" encoding=\"utf-8\"?>
<xs:schema id="XSDobject" targetNamespace="http://tempuri.org/XSDobject.xsd" elementFormDefault="qualified" xmlns="http://tempuri.org/XSDobject.xsd" xmlns:mstns="http://tempuri.org/XSDobject.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="order">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="contact">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="name" type="xs:string" />
                            <xs:element name="phone" type="xs:string" />
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
                <xs:element name="buyer">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="contact">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="name" type="xs:string" />
                                        <xs:element name="phone" type="xs:string" />
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

但是我收到以下错误“<strong>同一个表'contact'不能是两个嵌套关系中的子表。”</p>

XSD 可以正确编译，但它是无法处理重复表的类型化数据集。现在我也测试了 xsd.exe 工具，但它似乎生成与 msdatasetgenerator 相同的代码。我还尝试了一些第三方代码生成器工具，例如 XSD2Code、CodeXS、AltovaXmlSpy，但我也无法让它与嵌套元素一起使用。

或者，我可以在输入和输出处使用 xslt 转换来解决问题，但这会花费我很多性能。

所以现在我问是否有人可以帮助我为VS2005提供一个好的解决方案，或者知道可以处理这个问题的好的xsd类生成器。如果它作为数组或列表工作，它不一定是类型化的数据集，只要它易于序列化和反序列化它也是完美的。

在此先感谢弗雷格尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T10:58:06.087

我有同样的问题.. 如果性能不是问题，您可以使用 XSLT 重命名具有相同名称的“子”表，（即结果名称是表名及其父级的串联）：

```
 ...
  <xsl:template match="*">
     <xsl:param name="parentElm">
       <xsl:value-of select="name(..)" />
     </xsl:param>
     <xsl:choose>
       <xsl:when test="local-name() = 'Contact'">
         <xsl:element name="{concat('Contact',$parentElm)}">
           <xsl:apply-templates select="@* | node()" />
         </xsl:element>
       </xsl:when> <xsl:otherwise>
         <xsl:element name="{local-name()}">
           <xsl:copy-of select="@*" />
           <xsl:apply-templates select="@* | node()" />
         </xsl:element>
       </xsl:otherwise>
     </xsl:choose>   </xsl:template> ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T10:20:58.253

我建议对模式项进行简单的重命名，并使用分组（如下所示）或 xsd 包含（如果您需要其他模式的这种复杂类型）。如果您对名称没有硬性要求，这应该可以解决问题。

根据经验，我认为可能工具不适用于您示例中的重复命名。

像这样的东西可能会奏效：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="XSDobject" targetNamespace="http://tempuri.org/XSDobject.xsd" elementFormDefault="qualified" xmlns="http://tempuri.org/XSDobject.xsd" xmlns:mstns="http://tempuri.org/XSDobject.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:group name="Contact">
    <xs:sequence>
      <xs:element name="name" type="xs:string" />
      <xs:element name="phone" type="xs:string" />
    </xs:sequence>
  </xs:group>
  <xs:element name="order">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="OrderContact">
          <xs:complexType>
            <xs:sequence>
              <xs:group ref="Contact"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="buyer">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="BuyerContact">
                <xs:complexType>
                  <xs:sequence>
                    <xs:group ref="Contact"/>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T20:23:58.660

也许您可以使用 xsd:import / xsd:include 将 xsd 拆分为几个文件，然后使用 xsd.exe 编译每个文件。我认为您可以指定名称空间以在使用 xsd.exe 时生成代码。

几年前我曾从 xsd:sa 生成类，出于某种原因，我决定使用 xsdobjgen.exe 而不是 xsd.exe。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-08T16:04:57.103

Look at my solution for this item.

[The same table 'name' cannot be the child table in two nested relations](https://stackoverflow.com/questions/17925858/the-same-table-name-cannot-be-the-child-table-in-two-nested-relations/17927316#17927316)

I suggest using 'ref' in your schema to refer to the 'duplicate' elements.

# cocoa - 将 FTP 与 NSURL 一起使用

> ID：397430
> 
> 赞同：0
> 
> 时间：2008-12-29T10:11:10.143
> 
> 标签：cocoa, macos

我想编写一个使用 ftp 下载文件的可可应用程序。我读到了具有“NSURLHandle FTP 属性键”的 NSURL 类。我想知道如何利用这些常量为 ftp 站点提供用户名和密码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T13:13:47.780

NSURLHandle 已被弃用并且已经有一段时间了。请改用 NSURLConnection 或 NSURLDownload。使用如下 URL 创建这些对象之一：

[ftp://user:password@ftp.example.com/foo/bar.zip](ftp://user:password@ftp.example.com/foo/bar.zip)

或者，实现身份验证委托方法并传入标准 URL：

[ftp://ftp.example.com/foo/bar.zip](ftp://ftp.example.com/foo/bar.zip)

如果您需要做比下载文件更复杂的事情，我建议您查看提供完整 FTP 连接支持的[ConnectionKit 。](http://opensource.utr-software.com/connection/download.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T10:13:31.480

您是否尝试在 URL 中插入用户名和密码？喜欢：

```
ftp://user:pass@ftp.somewhere.com/path/to/file 
```

如果没有，您可能会在文档中找到您需要的[内容](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html)。

# database - 图形用户界面编程。数据库和表同步

> ID：397433
> 
> 赞同：1
> 
> 时间：2008-12-29T10:13:37.923
> 
> 标签：database, user-interface

我在几个桌面应用程序上工作过，这些应用程序使用表来对数据库表中的信息进行分组。但是保持这些信息的更新让我破解了不同的解决方案，比如一个工作线程，它每 X 秒更新一个执行查询的表，或者只是一个刷新视图的按钮。我什至见过一个使用鼠标移动事件刷新表格的应用程序。所以我的问题是，这是你的首选方法。有没有一种“完美”的方法可以让我在大学里睡觉？感谢回复的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T11:23:46.393

你想达到什么目的？
它是某种实时监控应用程序，例如股票交易、工厂监控软件，还是您想要自动更新的某些 CRUD 应用程序中的网格？

如果这是一个**crud 应用程序**，那么我要做的第一件事就是检查要求：

*   你的用户真的有必要一直自动更新信息吗？
*   您的用户是否一直在看显示器？
*   为什么？也许您可以实施某种可以减少检查频率的警报系统？

如果您真的需要您描述的方法，那么您做得很好 - 您可以使用计时器或其他一些事件（按钮，鼠标移动，...）来刷新数据。当然，随着用户数量的增加，不断的重新查询将成为性能问题。

如果它是具有大量数据的**实时监控软件**，那么您不应该将数据库放在系统中心。您应该拥有客户端通过 TCP（或某些类似协议）连接到的中央服务。中央服务应保持系统的最新状态（可能还有一些历史记录）。客户端可以附加到服务，服务应该在有新数据时通知客户端，以避免不断轮询。数据库应该用作应用程序用于分析过去事件的日志，而不是用于实时显示。

**编辑 ：**

关于 Andrej 的回答：我不确定这是否能解决您的问题。观察者模式通常通过订阅/通知机制来实现，这样数据源可以在数据发生变化时通知所有的观察者。问题是 RDBMS 通常没有可以通知您有关数据更改的机制。即使有，也不现实，因为短时间内可能会发生大量变化。想想几秒钟内的数十或数百个更新 - RDBMS 应该多久通知客户一次更改？如果有数百个网络慢的客户端怎么办？当您拥有多个用户时，事情就会变得复杂。

数据绑定正在进行中 - 您不能将网格直接绑定到数据库中的表。您首先需要将应用程序的数据放入可以绑定到 GUI 的某个对象（数据集、列表、...）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T13:05:10.463

一些编程语言/框架已经内置了对数据绑定的支持。数据绑定将同步视图（表组件）和数据（数据库表）。

例如，Flex 内置了绑定，javafx 也有，对于常规 java，您可以使用 jgoodies 绑定，或 oracle 的 adf 数据控件和数据绑定。

如果您的语言没有标准的绑定解决方案，那么看看现有的如何实现可能会很有用，例如 jgoodies 绑定（它是开源的）。

顺便说一句，大多数绑定框架都基于一些默认的设计模式，例如观察者模式：视图组件需要订阅自己以了解数据的更新。

编辑：

关于数据库更改的好点。这有点难。从技术上讲，应该可以使用触发器来通知客户。例如，在 Oracle 中，触发器可以使用高级队列在消息队列上发布数据更改事件消息，感兴趣的客户端可以侦听该消息。不过，我在实践中还没有看到这一点。您通常不想将有关 gui 客户端的知识放入您的数据库中。

最好有一个使用轮询定期更新的数据收集。该数据集合将使用绑定绑定到视图组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T10:16:41.397

*Perfect*特定于您的需求，但许多网站只要您对单元格进行更新，就会简单地更新表格。这会产生大量流量。也许您可以使用例如事务对更新进行排队，然后在用户关闭给定表、按*保存*或超时到期时提交？

我认为这完全取决于您的特定应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T12:31:05.323

最简单的方法是使用一些可配置的计时器线程来更新查询（假设超时不是每秒都发生）。您还可以显示最新数据收集的时间戳，并为需要当前数据的用户提供刷新按钮。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T16:03:21.227

Very helpful Andrej. Databindings seem like the easy way to go when you've got the chance of using them.

Oh yeah, the observer pattern:

> software design pattern in which an object maintains a list of its dependents and notifies them automatically of any state changes, usually by calling one of their methods. It is mainly used to implement distributed event handling systems.

I find it very handy the way C# declares new events using delegates.

Thanks for your very good answers.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-29T10:51:00.047

这对于 Web 应用程序来说很酷。但是我们谈论的是一个桌面应用程序，即使在空闲时，它也应该不断地从数据库中更新它的信息。这更像是一个设计问题，而不是编程问题。

# .net - 程序集中的类列表

> ID：397435
> 
> 赞同：5
> 
> 时间：2008-12-29T10:15:24.830
> 
> 标签：.net, vb.net, reflection, .net-assembly

我有一个 DLL 程序集，其中有各种类。每个班级大约有 50-100 名成员和 4-5 个职能部门。如何使用 VB.NET 程序创建所有类及其各自成员的列表？

我需要向用户展示使用特定类执行操作。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-29T10:25:32.300

假设您已将程序集加载到 thisAsm 中（在本例中，我正在使用正在执行的程序集），

这将为您提供所有非抽象类：

```
Assembly thisAsm = Assembly.GetExecutingAssembly();
List<Type> types = thisAsm.GetTypes().Where(t => t.IsClass && !t.IsAbstract).ToList(); 
```

这将为您提供所有实现特定接口的类。

（例如，如果您只需要获取实现 IYourInterface 的类，那么）

```
Assembly thisAsm = Assembly.GetExecutingAssembly();
List<Type> types = thisAsm.GetTypes().Where
            (t => ((typeof(IYourInterface).IsAssignableFrom(t) 
                 && t.IsClass && !t.IsAbstract))).ToList(); 
```

获得此项目列表后，您可以通过对类型列表的每个成员调用 GetProperties() 和 GetMethods() 来显示每种类型的成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T10:20:33.183

请参阅[System.Reflection.Assembly.GetTypes()](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettypes.aspx)和 [System.Type.GetMembers()的文档](http://msdn.microsoft.com/en-us/library/system.type.getmembers.aspx)

--larsw

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-04T09:01:52.233

您可以在 VB.net中获取从[Form](http://msdn.microsoft.com/en-us/library/system.windows.forms.form%28v=vs.110%29.aspx "表单类")继承的所有类型：

```
Dim thisAsm As Assembly = Assembly.GetExecutingAssembly()
Dim types As List(Of Type) = thisAsm.GetTypes().Where(Function(t) t.BaseType = GetType(Form)).ToList() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-04T09:18:00.533

这是基于@amazedsaint 答案的 vb.net 版本：

```
Dim thisAsm As Assembly = Assembly.GetExecutingAssembly()
Dim types As List(Of Type) = thisAsm
    .GetTypes()
    .Where(Function(t) t.IsClass AndAlso Not t.IsAbstract).ToList()

Dim thisAsm As Assembly = Assembly.GetExecutingAssembly()
Dim types As List(Of Type) = thisAsm
    .GetTypes()
    .Where(Function(t) ((GetType(IYourInterface).IsAssignableFrom(t) AndAlso t.IsClass AndAlso Not t.IsAbstract))).ToList() 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-29T10:18:29.833

网上有很多例子。这是[一个](http://dotnetguts.blogspot.com/2008/12/reflection-in-c-list-of-class-name.html)（虽然在[C#中）。](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)

# url - 如何在 Java 运行时在类路径中添加 XML 文件？

> ID：397440
> 
> 赞同：2
> 
> 时间：2008-12-29T10:18:05.277
> 
> 标签：url, runtime, classpath, relative-path

我不确定是否可以使用 URLClassLoader。此外，只有 XML 的相对路径是已知的。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T14:41:19.897

如果你的意思是读入一个已经在类路径中的 XML 文件，以便你可以使用你喜欢的任何库来解析它，最紧凑的方法是使用`ClassLoader`：

```
InputStream is = ClassLoader.getResourceAsStream();
// use the input stream however you want
is.close() 
```

见[http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html)

# c# - 在 Visual Studio 中引用项目“只读”？

> ID：397448
> 
> 赞同：5
> 
> 时间：2008-12-29T10:23:46.263
> 
> 标签：c#, .net, visual-studio-2008, dll

我在 VS2008 的两个解决方案中有两个应用程序共享一个公共 dll，dll 代码作为项目包含在第一个应用程序解决方案中。

是否可以允许第二种解决方案“只读”引用 dll 项目？

我希望打开第二个解决方案的人能够在调试期间进入 dll 但不能更改代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T10:39:17.810

我会简单地针对 dll+pdb 构建。pdb 足以单步执行代码，而无需对其进行编辑。您可以在项目属性中启用 pdb（调试符号）作为输出。

对于加载 pdb 文件，Shawn Burke[在此处](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)的演练（针对 .NET 框架本身，但同样的概念适用，只是从不同的位置）应该可以帮助您入门。

# asp.net - ASP.NET/DataList：通过单击列表元素进行客户端回发

> ID：397449
> 
> 赞同：1
> 
> 时间：2008-12-29T10:23:47.310
> 
> 标签：asp.net, javascript, dhtml, client-side, datalist

我有一个显示一组元素的 DataList 控件。当用户单击列表中的元素时（例如，列表元素的根中的任何位置），任何人都可以指出我如何添加一些客户端功能以提交/执行回发的正确方向。我已经通过添加隐藏的 LinkBut​​ton 并将其连接起来看到了一些示例 - 但我还没有让它正常工作。

干杯，

--larsw

* * *

感谢您的帮助 - 我选择了 jQuery 方法。你知道我是否可以从 lambda 函数（针对所选项目）调用隐藏的 asp:LinkBut​​ton 以便进行回发？

~~您的代码示例中有一个小错字（以防其他人阅读此线程）：我必须在 jQuery 选择器中添加一个 #；' **#** <%= DataList1.ClientID %> td'~~

--larsw

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T11:12:11.177

没有“客户端回发”之类的东西，这是一个错误的陈述。回发*意味着*提交到服务器（或外部服务器）。

您真正需要的是向您的页面添加一些 AJAX 方法。这可以通过以下几种方式完成：

*   更新面板
*   纯 MS AJAX
*   MS AJAX 和 jQuery 的混合（或其他 JavaScript 库，我建议使用 jQuery，因为它在 VS 2008 中得到支持）

**更新面板方法**

如果您有一个非常沉重的页面，这并不是最好的主意。如果您想了解更多有关注意事项的信息，请查看我写的博客文章 - [http://www.aaron-powell.com/blog.aspx?id=1195](http://www.aaron-powell.com/blog.aspx?id=1195)。

简单地说，如果您不了解限制是什么，UpdatePanels 可能是一个危险的选择。

**MS AJAX 和/或 jQuery**

这是我对你应该做什么的建议。使用 jQuery 定位 DOM 中要放置客户端事件的所有元素，例如：

```
$('#<%= DataList1.ClientID %> span').click(function () { alert('You want something here'); }); 
```

David Ward 有一些关于将 jQuery 与 ASP.NET/ASP.NET AJAX 结合使用的好帖子 - [http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)和[http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

**注意：**如果您要使用 AJAX 实现，您将*无法*访问页面的控件集合，这将是静态方法交互，因此请注意，如果您要更新页面的多个部分，则需要编写 JavaScript方法来做到这一点。

# java - 基于 Java 的 Webmail 解决方案

> ID：397457
> 
> 赞同：2
> 
> 时间：2008-12-29T10:28:01.263
> 
> 标签：java, webmail

我需要在我的 java web 应用程序中提供电子邮件发送和接收功能。将其视为提供嵌入在应用程序中的轻量级 IMAP 客户端。

有没有提供类似功能的基于 java 的开源库/项目/webmail 解决方案？

请注意，我不希望仍然从我的应用程序外部的电子邮件服务器检索电子邮件，我只需要提供一个接口（与我的应用程序的其余部分匹配）并且可以从应用程序内部访问，以执行常见的电子邮件阅读和发送电子邮件等操作。

问候，

-迪帕克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T10:54:22.770

根据我的经验，“规范的”Java IMAP 解决方案是[JavaMail](http://java.sun.com/products/javamail/)。是的，现在也是开源的：[https ://maven-repository.dev.java.net/nonav/repository/javax.mail/java-sources/](https://maven-repository.dev.java.net/nonav/repository/javax.mail/java-sources/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T14:12:47.513

看这里：[Java 中的开源 Web 邮件客户端](http://java-sources.org/open-source/web-mail)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-11T07:27:54.620

**使用 java/j2ee 开发的带有聊天模块的 Webmail 系统（基于 AJAX）**

欲了解更多信息，请访问：http: [//jtechnoprojects.blogspot.com/p/webmail-system-with-chating-ajax-based.html](http://jtechnoprojects.blogspot.com/p/webmail-system-with-chating-ajax-based.html)

Demo Webmail System 是一个像 gmail 一样功能齐全的 webmail 系统，它提供了所有的 webmail 功能。

它还包括提供直观聊天功能的 gmail、yahoo 等聊天模块。它对学校、学院、大学和其他组织很有用。

**网络邮件系统功能：**

与任何其他网络邮件系统一样的所有基本功能。

*   撰写，转发，带附件转发，回复，带附件回复，删除，移动到文件夹，标记为已读，标记为未读，标记为垃圾邮件等...
*   直观的聊天模块
*   综合通讯录
*   基于 AJAX 的附件支持，如 gmail
*   通过创建文件夹管理邮件
*   完全基于 AJAX 的应用程序

**使用的技术：**

*   JAVA（Java 邮件 API、多线程）、JSP、Servlet、ZK

*   HMailserver 电子邮件服务器

*   mysql数据库

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T10:39:50.507

快速搜索“java IMAP 库”给了我 [http://www.chilkatsoft.com/java-imap.asp](http://www.chilkatsoft.com/java-imap.asp)

看起来所有的梦想，我知道你有，都成真了:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-10-09T18:17:41.843

用JAVA开发的带有聊天模块的网络邮件系统：[http ://www.jtechnosoft.com/ZkMail/](http://www.jtechnosoft.com/ZkMail/)

# asp.net - asp:RangeValidator on DateTime with format dd/MMM/yyyy

> ID：397465
> 
> 赞同：1
> 
> 时间：2008-12-29T10:36:17.270
> 
> 标签：asp.net, rangevalidator

Is it possible to use the ASP.Net Range validator when the format string is dd/MMM/yyyy?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T12:59:01.740

Why don't you use Regular Expression validator?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T11:17:51.133

No. I think it should be a valid date (without the formatting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T13:09:02.297

ASP.net auto detects the culture info of the client. This info is used to resolve formatting like dates, currency etc.

You can override this with code (something like):

```
Thread.CurrentThread.CurrentCulture = 
    CultureInfo.CreateSpecificCulture("en-GB");
Thread.CurrentThread.CurrentUICulture =
    new CultureInfo("en-GB"); 
```

Or globally in the web.config:

```
<globalization requestEncoding="utf-8" responseEncoding="utf-8"
    culture="en-GB" uiCulture="en-GB" /> 
```

Of course this could have negative/positive side effects on the rest of your application, as it would affect other numbers/dates, but perhaps this is your intent anyway.

# asp.net-mvc - Html.Encode() 不对空格进行编码

> ID：397477
> 
> 赞同：2
> 
> 时间：2008-12-29T10:49:40.830
> 
> 标签：asp.net-mvc, encoding

在我的 asp.net-mvc 网站中，我有一个字段通常有一个字符串（来自数据库），但有时可能不包含任何内容。因为 IE 不知道如何处理 css “empty-cells” 标签，所以空的表格单元格需要用   填充。
我想

```
Html.Encode(" "); 
```

会为我解决这个问题，但显然，它只是返回“”。我可以按如下方式实现这个逻辑

```
Html.Encode(theString).Equals("")?" ":Html.Encode(theString);

```

也可以使用非速记方式，但坦率地说，这两种选择都很难看。难道没有一种更易读、更紧凑的方式来放置可选空间吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T00:12:37.240

`" "`转换为`"\xA0"`然后无条件地转换结果可能更简单`Html.Encode`：

```
s = (string.IsNullOrEmpty(s) || s.Trim()=="") ? "\xA0" : s;
Html.Encode(s); 
```

十六进制`00A0`标识不间断空格的 Unicode 字符，这就是为什么`&#xA0;`与`&nbsp;`.

如果您对数据库有任何控制权，则可以将空字段或单空格字段转换为此`"\xA0"`值，这将完全消除该条件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T11:18:53.003

HTML 中的空格编码只是一个空格。nbsp 可能看起来像一个空格，但具有不同的语义，“不间断”意味着禁止换行。

解决方案：每当我发现功能缺失或出现意外行为（例如 asp:Label 和 HyperLink 不进行 HTML 编码）时，我都会编写自己的实用程序类，按照我说的做 ;)

```
public class MyHtml
{
    public static string Encode(string s)
    {
        if (string.IsNullOrEmpty(s) || s.Trim()=="")
            return "& nbsp;";
        return Html.Encode(s);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T10:54:37.170

你必须找到一种不同的方法来填充你的空单元格。HTML 将空格字符编码为自身是完全有效的。如果您需要它是其他东西，您可以使用 URL 转义或滚动您自己的方法来生成内容。

# c++ - 具有任意值类型的 C++ 关联数组

> ID：397483
> 
> 赞同：8
> 
> 时间：2008-12-29T10:52:22.947
> 
> 标签：c++, arrays, stl, boost

在 C++ 中为每个键创建一个具有任意值类型的关联数组的最佳方法是什么？

目前我的计划是创建一个“值”类，其中包含我期望的类型的成员变量。例如：

```
class Value {

    int iValue;
    Value(int v) { iValue = v; }

    std::string sValue;
    Value(std::string v) { sValue = v; }

    SomeClass *cValue;
    Value(SomeClass *v) { cValue = c; }

};

std::map<std::string, Value> table; 
```

这样做的一个缺点是您在访问“值”时必须知道类型。IE：

```
table["something"] = Value(5);
SomeClass *s = table["something"].cValue;  // broken pointer 
```

此外，放入 Value 中的类型越多，数组就越臃肿。

有更好的建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-29T11:02:15.593

[boost::variant](http://www.boost.org/doc/libs/1_37_0/doc/html/variant.html)似乎正是您正在寻找的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-29T10:58:30.813

你的方法基本上是朝着正确的方向发展的。你*必须*知道你输入的类型。您可以使用`boost::any`并且可以将任何内容放入地图中，只要您知道自己放入了什么：

```
std::map<std::string, boost::any> table;
table["hello"] = 10;
std::cout << boost::any_cast<int>(table["hello"]); // outputs 10 
```

一些答案建议使用`boost::variant`来解决这个问题。但它不会让您在地图中存储任意类型的值（如您所愿）。您必须事先知道可能的类型集。鉴于此，您可以更轻松地执行上述操作：

```
typedef boost::variant<int, std::string, void*> variant_type;
std::map<std::string, variant_type> table;
table["hello"] = 10;
// outputs 10\. we don't have to know the type last assigned to the variant
// but the variant keeps track of it internally.
std::cout << table["hello"]; 
```

这是有效的，因为为此目的`boost::variant`重载。`operator<<`重要的是要理解，如果你想保存当前包含在变体中的内容，你仍然必须知道类型，就像下面的`boost::any`例子一样：

```
typedef boost::variant<int, std::string, void*> variant_type;
std::map<std::string, variant_type> table;
table["hello"] = "bar";
std::string value = boost::get<std::string>(table["hello"]); 
```

变量的赋值顺序是代码控制流的运行时属性，但任何变量使用的类型都是在编译时确定的。所以如果你想从变量中获取值，你必须知道它的类型。另一种方法是使用访问，如变体文档所述。它之所以起作用，是因为该变体存储了一个代码，该代码告诉它上次分配给它的类型。基于此，它*在运行时*决定它使用哪个访问者的重载。`boost::variant`相当大并且不完全符合标准，虽然`boost::any`符合标准但即使对于小类型也使用动态内存（所以它比较慢。变体可以将堆栈用于小类型）。所以你必须权衡你使用的东西。

如果您确实想将仅在它们做某事的方式上有所不同的对象放入其中，那么多态是一种更好的方法。您可以拥有一个从中派生的基类：

```
std::map< std::string, boost::shared_ptr<Base> > table;
table["hello"] = boost::shared_ptr<Base>(new Apple(...));
table["hello"]->print(); 
```

这基本上需要这个类布局：

```
class Base {
public:
    virtual ~Base() { }
    // derived classes implement this:
    virtual void print() = 0;
};

class Apple : public Base {
public:
    virtual void print() {
        // print us out.
    }
}; 
```

即[`boost::shared_ptr`](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)所谓的智能指针。如果您将它们从地图中删除，并且没有其他东西再引用它们，它将自动删除您的对象。理论上，您也可以使用普通指针，但使用智能指针将大大提高安全性。阅读我链接到的 shared_ptr 手册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T10:56:04.623

`Value`使用`IntValue`,等进行子类化`StringValue`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-29T11:00:49.637

你可以使用联合与 std::map 吗？

Boost::variant 提供无类型变量。

或者，您可以将所有值数据成员设为私有，并提供在未设置时返回错误（或抛出）的访问器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T11:01:13.880

一个直接的优化是使用 a `union`，因为你总是只有一个值作为键。

更完整的解决方案是将一些运行时类型信息封装到接口中。主要是“这是哪种类型？” 和“我如何比较平等的价值观？” 然后使用它的实现作为关键。

# visual-studio-2008 - VPC 访问主机上文件的最佳方式是什么

> ID：397485
> 
> 赞同：1
> 
> 时间：2008-12-29T10:54:26.233
> 
> 标签：visual-studio-2008, permissions, caspol, vpc

我在 Virtual PC 2007 SP1 中运行 Vista64 作为 Win XP 的主机。我想将我的文件存储在主机上，然后从虚拟 PC 访问它们。

我通过环回适配器上的网络共享访问主机上的文件。每个人都对共享具有读取权限，并且在 VPC 中，共享映射到 U:\ 驱动器号。

当我尝试在 Visual Studio 2008 中运行 Web 项目时，它不会构建并在尝试加载引用的 dll 时抛出异常。“未能授予最低权限请求。” 错误代码：0x80131417

这似乎是代码访问问题，因此我针对 1.1 和 2.0 框架运行了以下命令。

```
CasPol.exe -m -ag 1.2 -url file://U:\* FullTrust 
```

现在，当我尝试调试 Web 应用程序时，Visual Studio 会挂起。我怎样才能使这项工作或它是一个失败的事业？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T17:52:14.627

我这里的设置完全相同。

您是否从操作菜单中安装了“虚拟机添加”？

这将为您提供设置共享文件夹的选项（在设置中）。这会将 VPC 上的网络驱动器映射到主机上的文件夹，从而避免网络环回和共享权限。

# java - 有没有类似 python 的交互式 REPL 模式，但对于 Java ？

> ID：397488
> 
> 赞同：92
> 
> 时间：2008-12-29T10:56:11.520
> 
> 标签：java, read-eval-print-loop

有没有类似 python 的交互式 REPL 模式，但对于 Java ？这样我就可以，例如，`InetAddress.getAllByName( localHostName )`在一个窗口中输入，并立即得到结果，而无需所有这些 public static void nightmare() 东西？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-12-29T11:04:14.607

**编辑** 从 Java 9 开始就有[JShell](https://en.wikipedia.org/wiki/JShell)

*原始答案如下*

您还可以使用[Groovy 控制台](http://www.groovy-lang.org/groovyconsole.html)。它是一个交互式控制台，您可以在其中做您想做的事。由于 Groovy 还包括来自核心 Java 平台的类，因此您也可以使用这些类。

它看起来像这样：

![Groovy 的截图](https://i.imgur.com/plVxKmI.gif)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-08-14T17:03:07.573

Eclipse 有一个特性可以做到这一点，尽管它不是一个循环。它被称为“剪贴簿页面”。我假设这个类比应该是你有一个剪贴簿，你可以在其中收集一些代码片段。

无论如何，要使其工作，请在 Eclipse 中打开一个项目（您的剪贴簿页面将与一个项目相关联——当项目拥有东西时，Eclipse 喜欢它）。

然后：

1.  在项目导航器窗口中，选择项目中某处存在的文件夹。
2.  选择菜单文件 -> 新建 -> 其他，或按 Control-N。
3.  选择 Java -> Java 运行/调试 -> 剪贴簿页面。
4.  点击“下一步”，然后给它一个文件名，然后点击“完成”。

现在你有一个剪贴簿页面。键入一些代码，例如：

`System.out.println(System.getProperties());`

然后用鼠标选择文本，然后按 Control-U 或从上下文菜单中选择“执行”。代码将运行，输出将出现在控制台上。

您还可以键入表达式，选择它，然后从上下文菜单中选择显示。它将评估表达式并打印其类型。例如，运行 Display on`1 + 2`将打印`(int) 3`.

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2010-04-14T08:58:31.560

> BeanShell 是一个小型、免费、可嵌入的 Java 源解释器，具有对象脚本语言功能，用 Java 编写。BeanShell 动态执行标准 Java 语法，并使用常见的脚本便利性对其进行扩展，例如松散类型、命令和方法闭包，如 Perl 和 JavaScript 中的那些。您可以交互式地使用 BeanShell 进行 Java 实验和调试，以及以新的方式扩展您的应用程序。脚本 Java 适用于各种应用程序，包括快速原型设计、用户脚本扩展、规则引擎、配置、测试、动态部署、嵌入式系统，甚至 Java 教育。

[http://www.beanshell.org/](http://www.beanshell.org/)

[http://www.beanshell.org/manual/syntax.html#Standard_Java_Syntax](http://www.beanshell.org/manual/syntax.html#Standard_Java_Syntax)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-09-06T10:22:51.140

您可以使用 Eclipse 剪贴簿页面。

在 Eclipse 中创建一个剪贴簿页面。在您的项目中，新建-> 其他-> 剪贴簿页面。

在文件中，输入一些文本，选择它并按 ctrl-U，然后就可以了。

要管理您的导入，请在页面中右键单击并选择 Set Imports，您可以在其中选择导入包或单个类。这是持久的，并与页面一起保存。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-05-16T21:16:30.347

老问题，但现在有一个更好的答案（2013 年 5 月）——java-REPL！它可以在[github](https://github.com/albertlatacz/java-repl)上获得，也可以在[java-repl 网站上](http://www.javarepl.com/console.html)实时获得，以进行快速的一次性测试。

如果您获取 git hub 代码并运行`ant`以生成工件，您可以使用以下小脚本使其易于使用：

```
#!/bin/sh
java -jar /home/rdahlgren/scripts/javarepl-dev.build.jar 
```

自从找到这个项目以来，我可能每天使用它 5 次。享受！

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-10-08T22:02:34.277

似乎还没有人提到 Java (6, 7) 提供了一个名为`jrunscript`. 它与语言无关（因此可以与 Jython、JRuby 等一起使用）。它默认为默认捆绑的 JavaScript (Rhino)，并且与其他语言一样，您可以访问类路径上所有可用的包/对象。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-05-06T07:58:08.353

# 它是 OpenJDK 9 的一部分！

一个名为**JShell**（由 Oracle 开发）的 REPL 已作为 JDK 9 的一部分发布。

只需下载 JDK 9，然后启动`bin/jshell`.

[![JShell 的屏幕截图](https://i.stack.imgur.com/byh1H.png)](https://i.stack.imgur.com/byh1H.png)

## 资源

*   [blogs.oracle.com：JShell 内部](https://blogs.oracle.com/java/jshell)
*   [DZone：Java 9（第 2 部分）：JShell 一步一步](https://dzone.com/articles/java-9-tutorial-part-2-jshell-easy-step-by-step)
*   OpenJDK 项目[库拉](http://openjdk.java.net/projects/kulla/)
*   Java 增强提案，[JEP 222：jshell：Java Shell（读取-评估-打印循环）](http://openjdk.java.net/jeps/222)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-12-29T11:00:13.960

[Jython](http://www.jython.org/Project/ "杰通")是一个 python 实现，它允许您检查 Java 对象并与之交互。

```
>>> from java.net import *
>>> InetAddress.getAllByName("google.com")
array(java.net.InetAddress,[google.com/209.85.171.100, 
                            google.com/74.125.45.100,
                            google.com/74.125.67.100]) 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-12-29T12:09:47.410

作为 Groovy 的替代品，请尝试 Beanshell：[http ://www.beanshell.org/](http://www.beanshell.org/)

它更像 Java，并允许您直接使用 Java 语法。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2013-11-21T13:53:07.113

[Albert Latacz](https://github.com/albertlatacz)的 Java-REPL运行良好。

您可以在此处直接从浏览器尝试： [http ://www.javarepl.com/term.html](http://www.javarepl.com/term.html)

源代码在这里可用，它有一个不错的 Intelli-J 插件。

[https://github.com/albertlatacz/java-repl](https://github.com/albertlatacz/java-repl)

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-12-29T11:11:19.523

Clojure 提供了一个可以使用的 REPL。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-12-29T11:09:48.387

[groovy 控制台](http://groovy.codehaus.org/Groovy+Console)允许您这样做。它实际上是为了尝试和测试 groovy 代码，但由于 groovy 是 Java 的超集，它也允许使用普通的 Java 代码。

我刚刚在控制台中输入了这个：

```
InetAddress.getAllByName('localhost') 
```

并按 CTRL-R，然后它返回：

```
groovy> InetAddress.getAllByName('localhost')

Result: [localhost/127.0.0.1] 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2008-12-29T13:49:34.040

[Scala](http://www.scala-lang.org/)还提供了一个交互式控制台。通过完全限定 InetAddress，我能够使用它来获得问题中表达式的结果，如下所示：

```
java.net.InetAddress.getAllByName("localhost") 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2013-04-12T02:48:30.030

虽然[JRuby](https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby)、[BeanShell](http://www.beanshell.org/)、[Julian Fleischer 的 REPL](http://www.scravy.de/blog/2012-02-27/a-read-eval-print-loop-for-java.htm)都在那里，但[Albert Latacz 的 REPL](https://github.com/albertlatacz/java-repl)似乎是最新的和活跃的。

尝试使用简单的类定义，效果很好。

```
$ java -jar javarepl.jar
Welcome to JavaREPL version 56 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_17)
Type in expression to evaluate.
Type :help for more options.

java> public class Test {
    | public static void execute(String [] s) {
    |  System.out.println(54353 + s[0]);
    | }}

java> Test.execute(new String [] {"234343"});
54353234343

java> System.exit(0); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-03-30T15:36:31.737

对于可以访问 Mathematica 的人，JLink 允许您使用 Mathematica 代码访问 Java 和脚本：

```
Needs["JLink`"]
LoadJavaClass["java.net.InetAddress"]
InetAddress`getAllByName["localhost"] 
```

按 Shift-Enter 进行评估，你得到

```
{<<JavaObject[java.net.Inet4Address>>} 
```

然后您可以使用 Mathematica 的 Map 函数调用`toString`返回的对象：

```
#@toString[]& /@ % 
```

得到结果（或使用不那么晦涩的语法，`Map[Function[obj, obj@toString[]], %]`）：

```
{"localhost/127.0.0.1"} 
```

如果您开始认真对待这一点，您将需要阅读位于[http://reference.wolfram.com/mathematica/JLink/tutorial/Overview.html](http://reference.wolfram.com/mathematica/JLink/tutorial/Overview.html)的 Todd Gayley 的教程。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-04-14T13:56:14.100

如果您已经知道 Groovy（我假设您知道，因为您提到了 Groovy 控制台），那么只需使用 Groovy 发行版中包含的 groovysh 或 groovyConsole。如果您有要导入的自定义 jar，您可以编写一个批处理文件来启动 groovysh/groovyConsole，并将这些文件添加到类路径中。你也可以这样做

```
this.class.classLoader.rootLoader.addURL(new URL("file:///path to file")) 
```

从外壳内加载其他罐子。

几年前我曾经使用 Jython 来满足您的要求。作为构建脚本的一部分，我生成了一个自定义 jython.bat 和 .py 文件，其中包含我正在处理的项目的完整类路径。这样，当我启动 Jython 时，它就会拥有所有可用的代码，并且它会启动 Spring 让我在实时系统中处理事情。你可以用 Groovy、JRuby、BeanShell 等做同样的事情。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-09-09T01:34:07.237

您可以使用 jruby [http://kenai.com/projects/jruby/pages/CallingJavaFromJRuby编写 java 脚本](http://kenai.com/projects/jruby/pages/CallingJavaFromJRuby)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-10-08T20:52:14.377

是的，有：[http ://www.scravy.de/blog/2012-02-27/a-read-eval-print-loop-for-java.htm](http://www.scravy.de/blog/2012-02-27/a-read-eval-print-loop-for-java.htm)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-29T10:57:47.693

大多数 IDE 都有一个类似于“即时模式”的窗口，可以让您即时评估 Java 代码。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-10-23T01:11:10.753

您可以看看[BlueJ](http://www.bluej.org/)，它是一个交互式 Java 开发环境，用于教授 OOP，而不是像 Eclipse 或 NetBeans 那样的完整 IDE。无论如何，玩起来很有趣。

[您可以在YouTube](http://www.youtube.com/watch?v=aqQefkprf3s)上的一系列 Java 教程中看到它的实际应用。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-04-29T20:24:45.433

[DrJava](http://drjava.org/)是一个包含 REPL 窗格的教育 IDE。

还有一个 Eclipse 插件，但它对我不起作用。我想它只是有一段时间没有更新了。所以我通常做的是为“如果我这样做会发生什么”问题打开一个 DrJava 窗口。

EclipseShell 可能也不错，但我还没有使用它。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2012-03-01T03:22:04.367

[豆壳 2](http://code.google.com/p/beanshell2/)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-10-31T18:22:59.930

有一个名为[DrJava](http://www.drjava.org/%E2%80%8E)的简单 IDE ，它有一个交互控制台。它完全按照我的预期工作。只需加载一个文件并开始与其中的对象进行交互。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2016-02-05T19:12:11.077

有一个在线 REPL：[http ://www.javarepl.com/console.html](http://www.javarepl.com/console.html)

输入更多以达到字符限制...

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-06-30T09:17:10.960

对于 java 8，有 nudge4j。见[https://github.com/lorenzoongithub/nudge4j](https://github.com/lorenzoongithub/nudge4j)

[![nudge4j java repl](https://i.stack.imgur.com/cS6SN.jpg)](https://i.stack.imgur.com/cS6SN.jpg)

...而且美妙之处在于您可以从浏览器中试用您的应用程序

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2016-08-12T08:52:05.607

[JPad](http://jpad.io)​​ 是一个带有内置 REPL 的 java 暂存器：

```
C:\>jpad
       _ _____          _
      | |  __ \        | |
      | | |__) |_ _  __| |
  _   | |  ___/ _` |/ _` |
 | |__| | |  | (_| | (_| |
  \____/|_|   \__,_|\__,_|

Anything you type is evaluated as java.
The code is continuously appended until you call \clear.
Other Available Commands:
\exit - exit
\clear (n) - clear past java statements
\history - display all past java statements
\help - display this help

j>2+2
4
j>Math.sin(100.1)
-0.4177477
j> 
```

它也很聪明地转储集合、列表、地图等，并允许将它们呈现为表格或图表：

[![在此处输入图像描述](https://i.stack.imgur.com/NFKu9.png)](https://i.stack.imgur.com/NFKu9.png)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2017-09-14T12:55:17.983

Java 9 提供了 JShell。

```
jshell> println( "Print me!")
jshell> Print me! 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2010-04-14T17:58:55.150

Jython、[JIRB](http://docs.codehaus.org/display/JRUBY/The+JRuby+Tutorial+Part+1.5+-+Using+JIRB+to+Check+Java+Behaviour) for JRuby、Groovy (groovyconsole et al) 和 Beanshell 都是可行的选择。

我用过`InteractiveConsole`Jython，它在应用程序中运行良好。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-12-25T05:41:15.390

自 2018 年 9 月发布的 JDK 11 以来，该`java`命令允许启动单个 java 源代码文件。请参阅错误报告[8192920](https://bugs.java.com/bugdatabase/view_bug.do?bug_id=JDK-8192920)和[JEP 330](https://openjdk.java.net/jeps/330)

# ruby-on-rails - 铁路图生成器因“NoMethodError”而失败

> ID：397489
> 
> 赞同：1
> 
> 时间：2008-12-29T10:56:36.590
> 
> 标签：ruby-on-rails, ruby

在对我正在修补的 rails 应用程序进行了一些修改后，railroad 停止了工作。详细的输出提供了一些线索。我想知道其他人是否遇到过这个问题，以及是否有一些解决这个问题的建议。是数据建模错误吗？是铁路的问题吗？错误日志如下...

```
railroad -vM Loading application environment
Loading application classes
Generating models diagram

...[snip]...

    Processing Person
        Processing model association authorships
        Processing model association person_image
        Processing model association publications
/usr/lib/ruby/gems/1.8/gems/activerecord-2.1.2/lib/active_record/reflection.rb:224:in `derive_class_name': You have a nil object when you didn't expect it! (NoMethodError)
The error occurred while evaluating nil.class_name
    from /usr/lib/ruby/gems/1.8/gems/activerecord-2.1.2/lib/active_record/reflection.rb:106:in `class_name'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:134:in `process_association'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:102:in `process_class'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:101:in `each'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:101:in `process_class'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:27:in `generate'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:26:in `each'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/models_diagram.rb:26:in `generate'
    from /usr/lib/ruby/gems/1.8/gems/railroad-0.5.0/bin/railroad:47
    from /usr/bin/railroad:19:in `load'
    from /usr/bin/railroad:19 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T11:56:54.393

我想说你的 Person 模型中有一个流浪的“has_many”或“belongs_to”或其他关联调用......

我猜你的模型看起来像

```
class Person
  has_many :authorships
  has_many :images
  has_many :publications
  has_many #with nothing after it
  # the rest
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T19:04:46.163

您可能有一个 has_many :through 关联指定错误，例如

人 has_many :publications, :through => ..., :source => ...

确保你有源代码！

# silverlight - silverlight mediaelement RTSP

> ID：397494
> 
> 赞同：2
> 
> 时间：2008-12-29T10:59:07.613
> 
> 标签：silverlight, mediaelement, rtsp

据我所知，即使在版本 2 中，silverlight 也仅支持通过 http 进行流式传输，据我了解，mms 已转换为 http，因此您无法流式传输 RSTP（我已尝试对此进行测试并得到网络错误，除非我流式传输 http）。

有谁知道 Silverlight 是否支持 RSTP，或者是否支持以及如何支持？

谢谢

磷

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-02T15:02:20.033

Silverlight 3 通过使用 MediaStreamSource 支持 RTSP 上的流式传输。不是通过 .Source 连接您的 MediaElement，而是使用 .SetSource 并将其指向您的 MediaStreamSource 实现。

MediaStreamSource 用于允许 Silverlight 处理当前不受支持的格式，例如 MP3、MP4 等。

为通常的挣扎和大量的互联网搜索做好准备，因为没有很多文档或样本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T18:40:58.997

不，AFAIK 没有任何支持 RSTP 的计划。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-06T13:43:25.027

如前所述，没有原生支持，但通过 MediaStreamSource API，您几乎可以做任何与协议和编解码器相关的事情。这些人在 SL 中实现了 RTSP。我用它取得了一些成功，但没有积极使用它。 [http://www.streamcoders.com/](http://www.streamcoders.com/)

# perl - 如何将文件创建时间与 Perl 中的当前时间进行比较？

> ID：397495
> 
> 赞同：5
> 
> 时间：2008-12-29T11:00:02.073
> 
> 标签：perl, file, time

我想比较 Perl 中的当前时间和文件创建时间，但两者的格式不同。本地时间是这种格式：

```
22116291110813630 
```

和文件创建时间是

```
Today, December 29, 2008, 2:38:37 PM 
```

我如何比较哪个更大以及它们的区别？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-29T18:31:43.550

它甚至比使用 stat() 和 time()/localtime() 更容易。

```
my $diff = -M $filename; 
```

-M 操作符返回文件的“年龄”（程序启动后的天数）。它记录在[-X 函数](http://perldoc.perl.org/functions/-X.html)下或`perldoc -f -X`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-29T11:21:58.970

如果要比较值，您可能希望使用从[`localtime`](http://perldoc.perl.org/functions/localtime.html)标量上下文中获得的数字以及可以从中获得的 inode 更改时间[`stat`](http://perldoc.perl.org/functions/stat.html)：

```
 ($dev,$ino,$mode,$nlink,$uid,$gid,$rdev,$size,
                  $atime,$mtime,$ctime,$blksize,$blocks)
                      = stat($filename); 
```

在哪里：

```
                 0 文件系统的开发设备号
                 1 ino inode 编号
                 2模式文件模式（类型和权限）
                 3 nlink 文件的（硬）链接数
                 4 uid 数字 文件所有者的用户 ID
                 5 gid 文件所有者的数字组 ID
                 6 rdev 设备标识符（仅限特殊文件）
                 7 size 文件的总大小，以字节为单位
                 8 atime 自纪元以来的最后一次访问时间（以秒为单位）
                 9 mtime 自纪元以来的最后修改时间（以秒为单位）
                10 ctime 自纪元以来的 inode 更改时间（以秒为单位） (*)
                11 blksize 文件系统 I/O 的首选块大小
                12 块 实际分配的块数

```

所以你想要第 9 场：

```
 $mtime = ( stat $filename )[9];
$current_time = time;

$diff = $current_time - $mtime; 

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-29T11:17:43.177

`localtime`返回列表上下文中的值列表。请参阅本地时间[文档](http://perldoc.perl.org/functions/localtime.html)或[perlcheat](http://perldoc.perl.org/perlcheat.html)。在您的示例中，看起来所有这些都混合在一起。在标量上下文中，它返回一个格式化的字符串，如`Mon Dec 29 03:16:33 2008`. 在大多数平台上，文件 inode 更改时间将以`stat`自某个时期以来的秒数返回。您应该能够直接将其与`time()`( *not* `localtime()` ) 的结果进行比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T16:37:01.270

这两个功能要感谢jimtut的回答。fileage 以整数形式打印文件从创建时开始的秒数，非常适合在 shell 中使用。fileage 是上述问题的答案，而 dataage 打印的文件内容与我一直在寻找的答案相同，我相信这些都会很有用。

```
function fileage {
  perl -e 'printf "%i\n", 60 * 60 * 24 * -C "'"${1:?Must provide a file name}"'"'
}

function dataage {
  perl -e 'printf "%i\n", 60 * 60 * 24 * -M "'"${1:?Must provide a file name}"'"'
} 
```

# java - 如何用Java设计游戏的界面

> ID：397500
> 
> 赞同：1
> 
> 时间：2008-12-29T11:01:33.990
> 
> 标签：java, swing, 2d

我们是一个设计师和程序员的团队。我这个程序员，对各种设计都束手无策，所以游戏的用户界面必须由设计师来创造。我们正在考虑一个主屏幕，角色四处走动，顶部的小小地图，库存部分等。

所有这些东西都必须以看起来漂亮的方式设计，即漂亮的图形/按钮/颜色等。我假设设计师将在 photoshop/illustrator 中创建此界面的轮廓，然后将文件发送给我。 png 或 .jpeg 格式，我会在程序中实现它，确保按钮都可以正常工作，等等。

我的问题是，这是正确的方法吗？他应该以 .png/.jpeg 格式向我发送界面布局，还是只向我发送按钮，我必须在 java 中手动编写界面的其余部分，将按钮/图标放在需要的位置等。如果那么，我该怎么做呢？任何这样做的类/框架？

任何指导方针都会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T11:10:57.963

看看这个：

[http://www.cs.qub.ac.uk/~P.Hanna/CSC207/lectures/lectures.htm](http://www.cs.qub.ac.uk/~P.Hanna/CSC207/lectures/lectures.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T11:23:29.513

这真的取决于一些事情..它是用于 J2ME 还是您正在考虑将其用于桌面 (OpenGL/JOGL)？

对于 J2ME，您必须真正了解如何为内存受限的设备制作游戏。J2ME 带有自己的 GameCanvas 和 Sprite 相关类，您可以使用它们。我建议您通过 google 或购买一本书来阅读 J2ME 游戏开发。虽然有用于 J2ME 环境的 3D 库，但我从未对它印象深刻。

对于基于桌面的游戏，我建议对基于 2D 或 3D 的游戏使用某种形式的基于加速硬件的库。学习曲线有点陡峭，但从长远来看会更好。有很多库可以帮助您入门（例如 Jogl 和 JAva3D）您应该考虑使用一些称为场景图的库，这将帮助您为开始提供良好的基础。再次陡峭的学习曲线，但更容易维护和开发。

关于您的设计/实现问题，您似乎在这方面没有太多经验。一般图形设计师/UI交互设计师会更好地了解如何为游戏提供界面。他们通常会开发某种模拟，您将实施它，将与用户一起进行测试，反馈将决定您从那里去哪里。如果您没有某种形式的交互设计师，您或您的设计师将需要阅读它。通过界面进行交互，尤其是对于游戏而言，并不是一件容易的事情，它可以成就或毁掉你的游戏。

但是，如果您没有这方面的经验，那么在进入实施阶段之前，您似乎绝对应该阅读一些游戏架构。它将帮助您理解一些理论并打下基础，然后再继续构建不可避免地被证明是完全错误的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T13:30:40.100

您已经描述了[JavaFX](http://javafx.com/)的主要用例之一。至少已经有[一种视觉设计工具](http://www.reportmill.com/jfx/)适用于它。我还在[这个博客](http://learnjavafx.typepad.com/)上看到了一些文章，这些文章解决了从平面设计师那里获取视觉资产并在应用程序中使用它们的想法。

而且，当然，您可以随时使用 Java 进行繁重的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T11:11:25.093

设计师还必须学习一些关于游戏开发的知识，如何生成在不同分辨率下都能正常工作的纹理，如果它是一个平台游戏，如何创建适合动画的精灵等等。

回答您的问题时，他可能需要同时做这两个（向您发送按钮、精灵等以及全局视图以查看它们是如何组合在一起的）。

我建议你们都检查[http://www.gamedev.net/reference/](http://www.gamedev.net/reference/)和[http://www.gamasutra.com](http://www.gamasutra.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T08:43:37.963

我建议您查看已经执行此操作的 java 游戏，以了解如何完成此操作的示例。例如

[http://sourceforge.net/projects/freecol/#item3rd-2](http://sourceforge.net/projects/freecol/#item3rd-2)

[http://sourceforge.net/projects/megamek/#item3rd-2](http://sourceforge.net/projects/megamek/#item3rd-2)

[http://sourceforge.net/project/screenshots.php?group_id=1111](http://sourceforge.net/project/screenshots.php?group_id=1111)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-29T11:06:21.217

想出一些奇怪的 XML 格式来完全描述接口并让他创建它。:)

# vb.net - .Net 列表框/组合框

> ID：397507
> 
> 赞同：2
> 
> 时间：2008-12-29T11:05:14.183
> 
> 标签：vb.net

如果您知道组合/列表中的最大行数，我只是想与你们核实一下。我知道 VB6 有 32k 的限制——我无法通过快速的谷歌搜索找到任何可以确认的东西，所以我想我会把它扔给专家。

干杯，戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T12:03:19.387

.NET 组合框和 .NET 列表框中的最大项目数应为 2,147,483,647 左右。

但是使用包含许多项目的组合框可能不是解决此问题的最佳方法，因为很难在组合框列表中找到并选择正确的项目。

或许使用单选列表框，以及带有通配符搜索的连接编辑字段可能是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T21:58:38.750

它的设计仅限于可用内存或 2^32-1 个项目。但是，在 ListBox 的 Vista 实现中存在一个错误。一旦超过 65535 + 一页的项目，滚动它就会变得很糟糕。65565 项当我快速检查时。这个错误也适用于 ComboBox，下拉列表是一个 ListBox 控件。

这个错误很少被测试，这可能是它没有在 Vista SP1 中得到修复的一个原因。没有人设计一个期望用户能够从这么多选择中选择一个项目的 UI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T22:22:24.397

尝试使用一系列组合框来缩小用户的搜索范围，例如第一个可能是项目 AZ，然后它会根据第一个中的选择填写第二个。

根据数据类型，您可以通过多个组合进行分类

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T02:28:44.647

[似乎马特汉密尔顿删除了他的（第一次发布）答案，我评论了其他人现在提到的最大项目数（2 ^ 32 - 1）]

我赞同将大量项目放在任何类型的列表中可能不是一个好主意 UI 或其他方式的观点，但如果您真的必须显示大量项目，请不要忘记包装项目的添加使用`BeginUpdate`and`EndUpdate`以防止在调用该`EndUpdate`方法之前绘制项目。

# language-features - 我应该使用哪种语言进行实时应用

> ID：397511
> 
> 赞同：2
> 
> 时间：2008-12-29T11:07:05.710
> 
> 标签：language-features, real-time

我将开发实时应用程序，它将接收股票市场数据并进行一些处理，然后传播到客户端应用程序。我决定在服务器和客户端之间划分计算，服务器将进行基本计算，然后将基本数据发送到计算最终变量的客户端。

我决定使用 C# 开发客户端应用程序（仅限 GUI）和使用 C++ 计算最终变量的组件（称为：变量计算器）。在 C++ 中开发“变量计算器”的目的是为了模块化。例如，如果我发现变量计算在客户端需要更多时间，我可以在服务器端使用相同的模块。

此外，我将使用标准 C++ 开发服务器端。

注意：服务器应处理一组消息并在不到一秒的时间内将其发送给客户端 最大消息数出现在市场开始时 100,000 条消息

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T12:04:49.930

我不同意“实时”是一个模糊的定义。更有可能的是，人们只是不明白这是什么意思。实时是指系统的响应时间与现实世界的系统相同。您实际上可以让系统比实时更快，从而导致类似于让系统比实时慢的问题。

因此，我不相信您在参考“实时”应用程序时要求使用语言，就像对于真正快速的应用程序一样。

查看[语言枪战](http://shootout.alioth.debian.org/)，看看在最接近您的设计空间的各种测试中什么做得最好；但是，我的直觉答案是使用 C。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-29T12:08:54.133

曾在投资银行工作近30年。我写过很多这样的应用程序。您需要解决的潜在问题可能不是实时性能，而是延迟和吞吐量。

在这种情况下，延迟是关于减少网络延迟，语言选择不是很相关。

吞吐量是关于长时间维持的大处理能力，而性能是关于短时间内非常大的处理能力。尽管在这种情况下语言选择比延迟更重要，但它通常并不像您想象的那么重要。

在这两者中，通常最好先设计尽可能低的延迟。吞吐量问题可以通过各种技巧在以后的开发中解决，但摆脱现有设计中的高延迟要困难得多。

所以我会在客户端和服务器上都使用 C#，至少在概念验证方面是这样。没有必要引入额外的复杂性（另一种语言）来解决可能不重要的问题。

**编辑**：我注意到您编辑了您的问题，说服务器需要在不超过 1 秒的时间内处理多达 100K 条消息。我怀疑您是否可以通过软件来实现这一点，但您可能可以通过使用[软件和硬件的组合来实现](http://www.wallstreetandtech.com/data-latency/showArticle.jhtml?articleID=208403423)。

如果您确实需要这种级别的低延迟（并且我在 30 年的业务中从未需要它），那么语言选择并不像拥有非常高的带宽以及超级优化和并行化一样重要算法。但我首先会质疑要求看他们真正的意思——我敢打赌这不是他们所说的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-29T12:17:58.827

您必须使用的实时约束到底是什么？微秒、毫秒、秒？

它真的需要实时，还是仅仅需要高性能？

假设它确实需要实时，那么语言不太可能是系统中最重要的东西，而且您很可能会受到运行时环境的其余部分的限制。例如：您使用的库、网络堆栈、网络协议、操作系统、CPU 架构、内存、缓存等。

综上所述，C 语言可能会给您提供易用性和了解底层系统在做什么的最佳组合。如果你非常了解 C++，那么它也适合与严格的编码标准一起使用。如果它具有极高的性能，或者具有极高的可预测性要求，那么您可能需要使用汇编代码，但这不太可能，而且编译器可能比您对 CPU 管道有更好的理解，而且它对于超过几千行代码的任何事情都是不切实际的。

当然，如果您只需要相对较快的速度，那么我不认为实时性应该是您在选择语言时的首要考虑因素，而是合适的库和工具的可用性、开发人员团队的经验、对应用程序的适用性等将是更重要的考虑因素。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-29T11:39:47.733

如今，什么是“实时”应用程序的定义相当模糊。您的实时限制可能是数微秒，具体取决于应用程序，您对语言、操作系统和工具的选择都取决于这些因素。

在这种情况下，我不明白为什么您也不应该在服务器端使用 C#。也许有你没有提到的限制，但从你所说的来看，我认为没有理由在你的问题中引入第二语言。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-29T11:37:21.983

如今，当涉及到不需要大量处理能力的客户端/服务器应用程序时，语言选择 imo 的重要性不如它使用的语言那么重要。只要您知道如何构建良好的体系结构，Java、C#、C/C++ 的性能类似（显然本地语言会有一些优势）。我会考虑易用性和每种语言可用的有用库的数量来做出决定。我不知道您的计算究竟需要什么或您正在处理什么库存信息，但请查看库和 GUI 开发工具，然后从那里开始......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-08T09:13:43.847

Scala、Erlang 或 Java。但我强烈建议使用 Scala，因为它有很好的语法和高可扩展性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-29T12:35:29.087

我会看看 Erlang ！他们的架构似乎非常适合这样的应用程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-29T12:19:20.307

您可以查看[Adaptive Communications Environment](http://www.cs.wustl.edu/~schmidt/ACE.html)，这是一个可移植的服务器框架，用于用 C++ 编写高性能服务器。 [这篇 Stackoverflow 帖子](https://stackoverflow.com/questions/383371/what-is-the-best-way-to-implement-a-cross-platform-multi-threaded-server-in-cc#383400)有一系列链接来描述它并散布到各种资源。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-29T12:31:55.943

Dan 的直觉回答是错误的，看看他发布的网站就很清楚现在 C++（gnu/intel 实现）如何优于 C 实现

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-29T14:57:13.530

如果您真的想要低延迟和高吞吐量，我建议您删除服务器内的任何数据处理（计算）。如果您真的想要/需要不在客户端上进行计算，我会设置另一台服务器来提供派生数据的补充数据流。也就是说，您的计算值基于原始/原始 Feed。

你在说什么类型的计算？

您打算如何处理网络和网络堆栈中的吞吐量？你有延迟测量工具/嗅探器/endace卡吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-29T15:47:36.050

我也实现过这样的系统，我觉得RoadWarrior其实总结的很好。

这是消息队列的绝佳应用领域，如果您利用良好的底层 MQ 技术，我相信您几乎可以在任何编程语言甚至更高级别的解释语言中满足您的吞吐量要求。

# java - 将 ResultSet 中的特定记录分配给变量

> ID：397524
> 
> 赞同：1
> 
> 时间：2008-12-29T11:12:33.733
> 
> 标签：java, jdbc, resultset

我想从数据库中检索一组记录，执行 rs.next() 然后将其结果分配给一个变量以传递给将使用此记录的方法，就像我不分配它一样到一个变量并将其传递给一个方法有没有办法做到这一点？我正在使用 JAVA (1.5)

* * *

谢谢你的所有答案

我不想将整个结果集传递给一个方法，只传递当前行，但据我了解，这是不可能的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T11:55:25.877

不，不支持开箱即用，但也许以下想法可能对您有所帮助：

```
ResultSetMetaData meta = rs.getMetaData();
while (rs.next()) {
  Map<String,Object> row = new HashMap<String,Object>();
  for (int i = 1; i <= meta.getColumnCount(); ++i) {
    row.put(meta.getColumnName(i), rs.getObject(i));
  }
  processRow(row);
} 
```

问题是，您需要从`row`-map 中转换值，`processRow()`并且它不适用于所有类型/驱动程序组合（BLOB，...）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T11:24:06.533

您想将*rs.next()*的结果分配给变量吗？

恐怕你不能那样做。您可以从该 rs 获得引用并以其他方法处理它（与不将其分配给 var 的方式相同）

当您将 rs 作为参数传递给您已经在做的方法时。

```
while( rs.next() ) { 
    list.add( createFrom( rs ) );
}

...

public Object createFrom( ResultSet rs ) {  // Here rs is a copy of the reference in the while above. 
} 
```

我答对了你的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T11:26:20.413

我想我现在明白你了。:)

不，不可能那样做。`ResultSet`每次调用时都会更改其内部状态，因此`ResultSet.next()`存储对它的引用不会让您到任何地方。您必须将所需的数据提取到某个自定义对象中并存储。

```
CustomData cd = new CustomData();
cd.setString1(rs.getString(1));
cd.setInt1(rs.getInt(2));
... 
```

然后，您可以存储`cd`变量并继续处理您的`ResultSet`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-29T12:42:34.473

在处理结果集时，我经常发现 List> 数据结构非常有用。

# c# - 在 C# 中添加不可见的图像水印？

> ID：397537
> 
> 赞同：6
> 
> 时间：2008-12-29T11:21:31.267
> 
> 标签：c#, .net, image, watermark, invisible

我想通过 C# 代码在我的 JPEG 图片中插入多个不可见的水印。这意味着我需要一个 .NET 库来完成这项工作，而不是一些外部批处理应用程序。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T11:26:30.553

在图片中存储“不可见”数据被称为“隐写术”。谷歌搜索“steganography .net”[将这篇文章](http://www.devx.com/dotnet/Article/22667/0/page/1)列为热门文章 - 可能证明是有用的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-29T11:25:10.120

有一个图像魔法库到 c# 的端口，它可以轻松地为您执行该操作......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T11:50:35.183

这样做的目的是什么？是否可以让您识别从您的网站获取的 JPG？

> 评论中的回应：“是的，我想通过使用一些强大且不可见的水印来保护我的图片。半可见的网站徽标不是一种选择......”

这个问题正是上面讨论隐写术中描述的问题，与图像的鲁棒性有关。

任何像你描述的水印都可以用来识别整个图像的直接副本，但是在我看来，如果它甚至在编辑器中打开并再次保存，那么压缩影响的变化就有可能水印。此外，如果有人要窃取您的图像并对其进行更广泛的处理 - 修补色彩平衡，稍微裁剪它等等，任何不可见的水印似乎都不太可能足够强大以生存并保持可识别性。

不幸的是，我在这里没有解决方案，但问题本身远非微不足道。可能值得寻找其他方法，您可能可以与水印并行使用（可能是自定义元数据？防止图像被轻松保存？）以使您的图像更难被盗或降低它们的价值，如果它们是...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T11:36:14.370

devx.com 上的这篇文章包含一个库 (Stego)，其中包含您可以使用的源代码：

[保守秘密：.NET 的隐写术](http://www.devx.com/dotnet/Article/22667)

> 实现该 API 后，在 .bmp 文件中隐藏一条消息很简单：

```
 ICoverFile cover = new BMPCoverFile("cover.bmp");
   cover.CreateStegoFile("stego.bmp","Hello","MyPwd"); 
```

> 同样，您可以轻松地提取消息：

```
 IStegoFile stego = new 
      BMPStegoFile("stego.bmp","MyPwd");
   Console.WriteLine(stego.HiddenMessage); 
```

*更新：哦，对不起。马特链接到同一篇文章......在写这个答案时没有看到。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T11:57:21.600

如果这是您正在开发的重要应用程序，为什么不尝试付费服务呢？

[Digimarc](https://www.digimarc.com/)和[Signumtech](http://www.signumtech.com/)可以使用他们的 SDK 为您提供这种支持。

# wpf - 如何将 RadioButtons 绑定到枚举？

> ID：397556
> 
> 赞同：449
> 
> 时间：2008-12-29T11:35:00.847
> 
> 标签：wpf, data-binding, enums, radio-button

我有一个这样的枚举：

```
public enum MyLovelyEnum
{
    FirstSelection,
    TheOtherSelection,
    YetAnotherOne
}; 
```

我的 DataContext 中有一个属性：

```
public MyLovelyEnum VeryLovelyEnum { get; set; } 
```

我的 WPF 客户端中有三个 RadioButtons。

```
<RadioButton Margin="3">First Selection</RadioButton>
<RadioButton Margin="3">The Other Selection</RadioButton>
<RadioButton Margin="3">Yet Another one</RadioButton> 
```

现在如何将 RadioButtons 绑定到属性以进行正确的双向绑定？

* * *

## 回答 #1

> 赞同：606
> 
> 时间：2010-05-25T22:07:39.183

您可以进一步简化接受的答案。您可以显式传入枚举值而不是字符串表示，而不是在 xaml 中将枚举作为字符串输入并在转换器中做更多的工作，并且正如 CrimsonX 评论的那样，错误会在编译时而不是运行时抛出：

## ConverterParameter={x:静态本地：YourEnumType.Enum1}

```
<StackPanel>
    <StackPanel.Resources>          
        <local:ComparisonConverter x:Key="ComparisonConverter" />          
    </StackPanel.Resources>
    <RadioButton IsChecked="{Binding Path=YourEnumProperty, Converter={StaticResource ComparisonConverter}, ConverterParameter={x:Static local:YourEnumType.Enum1}}" />
    <RadioButton IsChecked="{Binding Path=YourEnumProperty, Converter={StaticResource ComparisonConverter}, ConverterParameter={x:Static local:YourEnumType.Enum2}}" />
</StackPanel> 
```

然后简化转换器：

```
public class ComparisonConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return value?.Equals(parameter);
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return value?.Equals(true) == true ? parameter : Binding.DoNothing;
    }
} 
```

* * *

### 编辑（2010 年 12 月 16 日）：

感谢 anon[建议](https://stackoverflow.com/a/3636821/3195477)返回 Binding.DoNothing 而不是 DependencyProperty.UnsetValue。

* * *

### 注意 - 同一容器中的多组 RadioButtons（2011 年 2 月 17 日）：

在 xaml 中，如果单选按钮共享相同的父容器，则选择一个将取消选择该容器内的所有其他按钮（即使它们绑定到不同的属性）。因此，请尝试将绑定到公共属性的 RadioButton 组合在它们自己的容器中，例如堆栈面板。如果您的相关 RadioButtons 无法共享单个父容器，则将每个 RadioButton 的 GroupName 属性设置为一个公共值以对它们进行逻辑分组。

* * *

### 编辑（2011 年 4 月 5 日）：

简化 ConvertBack 的 if-else 以使用三元运算符。

* * *

### 注意 - 嵌套在类中的枚举类型（2011 年 4 月 28 日）：

如果您的枚举类型嵌套在一个类中（而不是直接在命名空间中），您可以使用“+”语法来访问 XAML 中的枚举，如问题的（未标记）答案中所述：

*ConverterParameter={x:静态本地：**YourClass+** YourNestedEnumType.Enum1}*

然而，由于这个[Microsoft Connect 问题](https://connect.microsoft.com/VisualStudio/feedback/details/361509/xaml-designer-cannot-handle-typename-with-nested-classes)，VS2010 中的设计器将不再加载说明`"Type 'local:YourClass+YourNestedEnumType' was not found."`，但项目确实编译并运行成功。当然，如果您能够将枚举类型直接移动到命名空间，则可以避免此问题。

* * *

### 编辑（2012 年 1 月 27 日）：

如果使用枚举标志，转换器将如下所示：

```
public class EnumToBooleanConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return ((Enum)value).HasFlag((Enum)parameter);
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return value.Equals(true) ? parameter : Binding.DoNothing;
    }
} 
```

* * *

### 编辑（2015 年 5 月 7 日）：

在 Nullable Enum 的情况下（在问题中**没有**问，但在某些情况下可能需要，例如 ORM 从 DB 返回 null 或在程序逻辑中未提供值可能有意义的时候） ，请记住在 Convert 方法中添加初始 null 检查并返回适当的 bool 值，通常为 false（如果您不希望选择任何单选按钮），如下所示：

```
 public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (value == null) {
            return false; // or return parameter.Equals(YourEnumType.SomeDefaultValue);
        }
        return value.Equals(parameter);
    } 
```

* * *

### 注意 - NullReferenceException（2018 年 10 月 10 日）：

更新了示例以消除引发 NullReferenceException 的可能性。`IsChecked` 是一个可为空的类型，因此返回 `Nullable` 似乎是一个合理的解决方案。

* * *

## 回答 #2

> 赞同：413
> 
> 时间：2009-01-02T13:36:50.543

您可以使用更通用的转换器

```
public class EnumBooleanConverter : IValueConverter
{
  #region IValueConverter Members
  public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    string parameterString = parameter as string;
    if (parameterString == null)
      return DependencyProperty.UnsetValue;

    if (Enum.IsDefined(value.GetType(), value) == false)
      return DependencyProperty.UnsetValue;

    object parameterValue = Enum.Parse(value.GetType(), parameterString);

    return parameterValue.Equals(value);
  }

  public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    string parameterString = parameter as string;
    if (parameterString == null)
        return DependencyProperty.UnsetValue;

    return Enum.Parse(targetType, parameterString);
  }
  #endregion
} 
```

在您使用的 XAML 部分中：

```
<Grid>
    <Grid.Resources>
      <l:EnumBooleanConverter x:Key="enumBooleanConverter" />
    </Grid.Resources>
    <StackPanel >
      <RadioButton IsChecked="{Binding Path=VeryLovelyEnum, Converter={StaticResource enumBooleanConverter}, ConverterParameter=FirstSelection}">first selection</RadioButton>
      <RadioButton IsChecked="{Binding Path=VeryLovelyEnum, Converter={StaticResource enumBooleanConverter}, ConverterParameter=TheOtherSelection}">the other selection</RadioButton>
      <RadioButton IsChecked="{Binding Path=VeryLovelyEnum, Converter={StaticResource enumBooleanConverter}, ConverterParameter=YetAnotherOne}">yet another one</RadioButton>
    </StackPanel>
</Grid> 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2010-09-03T14:40:26.620

对于 EnumToBooleanConverter 答案：对于单选按钮 IsChecked 值变为 false 的情况，请考虑返回 Binding.DoNothing 而不是返回 DependencyProperty.UnsetValue。前者表示存在问题（并且可能向用户显示红色矩形或类似的验证指示符），而后者只是表示不应该做任何事情，这正是这种情况下想要做的。

[http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.convertback.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.convertback.aspx) [http://msdn.microsoft.com/en-us/library/system.windows.data.binding .donthing.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.donothing.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-29T11:51:53.187

我会在 ListBox 中使用 RadioButtons，然后绑定到 SelectedValue。

这是关于该主题的较旧线程，但基本思想应该相同：[http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/323d067a-efef-4c9f-8d99-fecf45522395/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/323d067a-efef-4c9f-8d99-fecf45522395/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-18T06:04:05.560

对于 UWP 来说，这并不是那么简单：您必须跳过一个额外的箍来将字段值作为参数传递。

**示例 1**

适用于 WPF 和 UWP。

```
<MyControl>
    <MyControl.MyProperty>
        <Binding Converter="{StaticResource EnumToBooleanConverter}" Path="AnotherProperty">
            <Binding.ConverterParameter>
                <MyLibrary:MyEnum>Field</MyLibrary:MyEnum>
            </Binding.ConverterParameter>
        </MyControl>
    </MyControl.MyProperty>
</MyControl> 
```

**示例 2**

适用于 WPF 和 UWP。

```
...
<MyLibrary:MyEnum x:Key="MyEnumField">Field</MyLibrary:MyEnum>
...

<MyControl MyProperty="{Binding AnotherProperty, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={StaticResource MyEnumField}}"/> 
```

**示例 3**

仅对 WPF 有效！

```
<MyControl MyProperty="{Binding AnotherProperty, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static MyLibrary:MyEnum.Field}}"/> 
```

UWP 不支持`x:Static`，所以*示例 3*是不可能的；假设您使用*Example 1*，结果是更冗长的代码。*示例 2*稍好一些，但仍不理想。

**解决方案**

```
public abstract class EnumToBooleanConverter<TEnum> : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, string language)
    {
        var Parameter = parameter as string;

        if (Parameter == null)
            return DependencyProperty.UnsetValue;

        if (Enum.IsDefined(typeof(TEnum), value) == false)
            return DependencyProperty.UnsetValue;

        return Enum.Parse(typeof(TEnum), Parameter).Equals(value);
    }

    public object ConvertBack(object value, Type targetType, object parameter, string language)
    {
        var Parameter = parameter as string;
        return Parameter == null ? DependencyProperty.UnsetValue : Enum.Parse(typeof(TEnum), Parameter);
    }
} 
```

然后，对于您希望支持的每种类型，定义一个将枚举类型装箱的转换器。

```
public class MyEnumToBooleanConverter : EnumToBooleanConverter<MyEnum>
{
    //Nothing to do!
} 
```

必须将其装箱的原因是因为似乎无法在方法中引用类型`ConvertBack`；拳击会解决这个问题。如果您使用前两个示例中的任何一个，您可以只引用参数类型，从而无需从装箱类继承；如果您希望在一行中完成所有操作并且尽可能不冗长，则后一种解决方案是理想的。

用法类似于*示例 2*，但实际上不那么冗长。

```
<MyControl MyProperty="{Binding AnotherProperty, Converter={StaticResource MyEnumToBooleanConverter}, ConverterParameter=Field}"/> 
```

缺点是您必须为您希望支持的每种类型定义一个转换器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-02T19:22:34.150

我创建了一个新类来处理将 RadioButtons 和 CheckBoxes 绑定到枚举。它适用于标记枚举（具有多个复选框选择）和非标记枚举用于单选复选框或单选按钮。它也根本不需要 ValueConverters。

起初这可能看起来更复杂，但是，一旦你将这个类复制到你的项目中，它就完成了。它是通用的，因此它可以很容易地用于任何枚举。

```
public class EnumSelection<T> : INotifyPropertyChanged where T : struct, IComparable, IFormattable, IConvertible
{
  private T value; // stored value of the Enum
  private bool isFlagged; // Enum uses flags?
  private bool canDeselect; // Can be deselected? (Radio buttons cannot deselect, checkboxes can)
  private T blankValue; // what is considered the "blank" value if it can be deselected?

  public EnumSelection(T value) : this(value, false, default(T)) { }
  public EnumSelection(T value, bool canDeselect) : this(value, canDeselect, default(T)) { }
  public EnumSelection(T value, T blankValue) : this(value, true, blankValue) { }
  public EnumSelection(T value, bool canDeselect, T blankValue)
  {
    if (!typeof(T).IsEnum) throw new ArgumentException($"{nameof(T)} must be an enum type"); // I really wish there was a way to constrain generic types to enums...
    isFlagged = typeof(T).IsDefined(typeof(FlagsAttribute), false);

    this.value = value;
    this.canDeselect = canDeselect;
    this.blankValue = blankValue;
  }

  public T Value
  {
    get { return value; }
    set 
    {
      if (this.value.Equals(value)) return;
      this.value = value;
      OnPropertyChanged();
      OnPropertyChanged("Item[]"); // Notify that the indexer property has changed
    }
  }

  [IndexerName("Item")]
  public bool this[T key]
  {
    get
    {
      int iKey = (int)(object)key;
      return isFlagged ? ((int)(object)value & iKey) == iKey : value.Equals(key);
    }
    set
    {
      if (isFlagged)
      {
        int iValue = (int)(object)this.value;
        int iKey = (int)(object)key;

        if (((iValue & iKey) == iKey) == value) return;

        if (value)
          Value = (T)(object)(iValue | iKey);
        else
          Value = (T)(object)(iValue & ~iKey);
      }
      else
      {
        if (this.value.Equals(key) == value) return;
        if (!value && !canDeselect) return;

        Value = value ? key : blankValue;
      }
    }
  }

  public event PropertyChangedEventHandler PropertyChanged;

  private void OnPropertyChanged([CallerMemberName] string propertyName = "")
  {
    PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
  }
} 
```

至于如何使用它，假设您有一个用于手动或自动运行任务的枚举，并且可以安排在一周中的任何一天，以及一些可选选项......

```
public enum StartTask
{
  Manual,
  Automatic
}

[Flags()]
public enum DayOfWeek
{
  Sunday = 1 << 0,
  Monday = 1 << 1,
  Tuesday = 1 << 2,
  Wednesday = 1 << 3,
  Thursday = 1 << 4,
  Friday = 1 << 5,
  Saturday = 1 << 6
}

public enum AdditionalOptions
{
  None = 0,
  OptionA,
  OptionB
} 
```

现在，使用这个类是多么容易：

```
public class MyViewModel : ViewModelBase
{
  public MyViewModel()
  {
    StartUp = new EnumSelection<StartTask>(StartTask.Manual);
    Days = new EnumSelection<DayOfWeek>(default(DayOfWeek));
    Options = new EnumSelection<AdditionalOptions>(AdditionalOptions.None, true, AdditionalOptions.None);
  }

  public EnumSelection<StartTask> StartUp { get; private set; }
  public EnumSelection<DayOfWeek> Days { get; private set; }
  public EnumSelection<AdditionalOptions> Options { get; private set; }
} 
```

下面是用这个类绑定复选框和单选按钮是多么容易：

```
<StackPanel Orientation="Vertical">
  <StackPanel Orientation="Horizontal">
    <!-- Using RadioButtons for exactly 1 selection behavior -->
    <RadioButton IsChecked="{Binding StartUp[Manual]}">Manual</RadioButton>
    <RadioButton IsChecked="{Binding StartUp[Automatic]}">Automatic</RadioButton>
  </StackPanel>
  <StackPanel Orientation="Horizontal">
    <!-- Using CheckBoxes for 0 or Many selection behavior -->
    <CheckBox IsChecked="{Binding Days[Sunday]}">Sunday</CheckBox>
    <CheckBox IsChecked="{Binding Days[Monday]}">Monday</CheckBox>
    <CheckBox IsChecked="{Binding Days[Tuesday]}">Tuesday</CheckBox>
    <CheckBox IsChecked="{Binding Days[Wednesday]}">Wednesday</CheckBox>
    <CheckBox IsChecked="{Binding Days[Thursday]}">Thursday</CheckBox>
    <CheckBox IsChecked="{Binding Days[Friday]}">Friday</CheckBox>
    <CheckBox IsChecked="{Binding Days[Saturday]}">Saturday</CheckBox>
  </StackPanel>
  <StackPanel Orientation="Horizontal">
    <!-- Using CheckBoxes for 0 or 1 selection behavior -->
    <CheckBox IsChecked="{Binding Options[OptionA]}">Option A</CheckBox>
    <CheckBox IsChecked="{Binding Options[OptionB]}">Option B</CheckBox>
  </StackPanel>
</StackPanel> 
```

1.  加载 UI 时，将选择“手动”单选按钮，您可以在“手动”或“自动”之间更改选择，但必须始终选择其中之一。
2.  一周中的每一天都将被取消选中，但可以选中或取消选中任意数量的日期。
3.  “选项 A”和“选项 B”最初都将被取消选中。您可以选中一个或另一个，选中一个将取消选中另一个（类似于 RadioButtons），但现在您也可以取消选中它们（使用 WPF 的 RadioButton 无法做到这一点，这就是此处使用 CheckBox 的原因）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-25T18:41:48.627

这也适用于**复选框**。

```
public class EnumToBoolConverter:IValueConverter
{
    private int val;
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        int intParam = (int)parameter;
        val = (int)value;

        return ((intParam & val) != 0);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        val ^= (int)parameter;
        return Enum.Parse(targetType, val.ToString());
    }
} 
```

将单个枚举绑定到多个复选框。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-05T08:04:36.570

您可以动态创建单选按钮，`ListBox`可以帮助您做到这一点，无需转换器，非常简单。

具体步骤如下：

*   创建一个 ListBox 并将列表框的 ItemsSource 设置为枚举`MyLovelyEnum`并将 ListBox 的 SelectedItem 绑定到`VeryLovelyEnum`属性。
*   然后将创建每个 ListBoxItem 的单选按钮。

*   **第 1 步**：将枚举添加到 Window、UserControl 或 Grid 等的静态资源中。

```
 <Window.Resources>
        <ObjectDataProvider MethodName="GetValues"
                            ObjectType="{x:Type system:Enum}"
                            x:Key="MyLovelyEnum">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="local:MyLovelyEnum" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources> 
```

*   **第 2 步**：使用列表框并将其中`Control Template`的每个项目填充为单选按钮

```
 <ListBox ItemsSource="{Binding Source={StaticResource MyLovelyEnum}}" SelectedItem="{Binding VeryLovelyEnum, Mode=TwoWay}" >
        <ListBox.Resources>
            <Style TargetType="{x:Type ListBoxItem}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <RadioButton
                                Content="{TemplateBinding ContentPresenter.Content}"
                                IsChecked="{Binding Path=IsSelected,
                                RelativeSource={RelativeSource TemplatedParent},
                                Mode=TwoWay}" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ListBox.Resources>
    </ListBox> 
```

优点是：如果有一天您的枚举类发生更改，则无需更新 GUI（XAML 文件）。

**参考资料：** [https ://brianlagunas.com/a-better-way-to-data-bind-enums-in-wpf/](https://brianlagunas.com/a-better-way-to-data-bind-enums-in-wpf/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-17T21:47:39.137

`ViewModel`处理此问题的一种方法是在您的类中具有单独的 bool 属性。以下是我处理这种情况的方法：

**视图模型：**

```
public enum MyLovelyEnum { FirstSelection, TheOtherSelection, YetAnotherOne };
private MyLovelyEnum CurrentSelection;

public bool FirstSelectionProperty
{
    get
    {
        return CurrentSelection == MyLovelyEnum.FirstSelection;
    }
    set
    {
        if (value)
            CurrentSelection = MyLovelyEnum.FirstSelection;
    }
}

public bool TheOtherSelectionProperty
{
    get
    {
        return CurrentSelection == MyLovelyEnum.TheOtherSelection;
    }
    set
    {
        if (value)
            CurrentSelection = MyLovelyEnum.TheOtherSelection;
    }
}

public bool YetAnotherOneSelectionProperty
{
    get
    {
        return CurrentSelection == MyLovelyEnum.YetAnotherOne;
    }
    set
    {
        if (value)
            CurrentSelection = MyLovelyEnum.YetAnotherOne;
    }
} 
```

**XAML：**

```
<RadioButton IsChecked="{Binding SimilaritySort, Mode=TwoWay}">Similarity</RadioButton>
<RadioButton IsChecked="{Binding DateInsertedSort, Mode=TwoWay}">Date Inserted</RadioButton>
<RadioButton IsChecked="{Binding DateOfQuestionSort, Mode=TwoWay}">Date of Question</RadioButton>
<RadioButton IsChecked="{Binding DateModifiedSort, Mode=TwoWay}">Date Modified</RadioButton> 
```

它不像其他一些解决方案那样健壮或动态，但好的是它非常独立，不需要创建自定义转换器或类似的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-11T10:06:56.957

基于 Scott 的 EnumToBooleanConverter。我注意到 ConvertBack 方法不适用于带有标志代码的枚举。

我试过以下代码：

```
public class EnumHasFlagToBooleanConverter : IValueConverter
    {
        private object _obj;
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            _obj = value;
            return ((Enum)value).HasFlag((Enum)parameter);
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            if (value.Equals(true))
            {
                if (((Enum)_obj).HasFlag((Enum)parameter))
                {
                    // Do nothing
                    return Binding.DoNothing;
                }
                else
                {
                    int i = (int)_obj;
                    int ii = (int)parameter;
                    int newInt = i+ii;
                    return (NavigationProjectDates)newInt;
                }
            }
            else
            {
                if (((Enum)_obj).HasFlag((Enum)parameter))
                {
                    int i = (int)_obj;
                    int ii = (int)parameter;
                    int newInt = i-ii;
                    return (NavigationProjectDates)newInt;

                }
                else
                {
                    // do nothing
                    return Binding.DoNothing;
                }
            }
        }
    } 
```

我唯一不能开始工作的就是从`int`to进行强制转换，`targetType`所以我将它硬编码为`NavigationProjectDates`我使用的枚举。而且，`targetType == NavigationProjectDates`...

* * *

编辑更通用的标志枚举转换器：

```
    公共类FlagsEnumToBooleanConverter：IValueConverter {
        私人 int _flags=0;
        public object Convert(object value, Type targetType, object parameter, string language) {
            如果（值 == 空）返回假；
            _flags = (int) 值；
            类型 t = value.GetType();
            对象 o = Enum.ToObject(t, 参数);
            return ((Enum)value).HasFlag((Enum)o);
        }

        public object ConvertBack(object value, Type targetType, object parameter, string language)
        {
            if (value?.Equals(true) ?? false) {
                _flags = _flags | (int) 参数；
            }
            别的 {
                _flags = _flags & ~(int) 参数；
            }
            返回_flags；
        }
    }

```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-19T02:36:24.067

使用 Nullable 的 UWP 的双向绑定解决方案：

C#部分：

```
public class EnumConverter : IValueConverter
{
    public Type EnumType { get; set; }
    public object Convert(object value, Type targetType, object parameter, string lang)
    {
        if (parameter is string enumString)
        {
            if (!Enum.IsDefined(EnumType, value)) throw new ArgumentException("value must be an Enum!");
            var enumValue = Enum.Parse(EnumType, enumString);
            return enumValue.Equals(value);
        }
        return value.Equals(Enum.ToObject(EnumType,parameter));
    }

    public object ConvertBack(object value, Type targetType, object parameter, string lang)
    {
        if (parameter is string enumString)
            return value?.Equals(true) == true ? Enum.Parse(EnumType, enumString) : null;
        return value?.Equals(true) == true ? Enum.ToObject(EnumType, parameter) : null;
    }
} 
```

这里的`null`值充当 Binding.DoNothing。

```
private YourEnum? _yourEnum = YourEnum.YourDefaultValue; //put a default value here
public YourEnum? YourProperty
{
    get => _yourEnum;
    set{
        if (value == null) return;
        _yourEnum = value;
    }
} 
```

Xaml 部分：

```
...
<Page.Resources>
    <ResourceDictionary>
        <helper:EnumConverter x:Key="YourConverter" EnumType="yournamespace:YourEnum" />
    </ResourceDictionary>
</Page.Resources>
...
<RadioButton GroupName="YourGroupName" IsChecked="{Binding Converter={StaticResource YourConverter}, Mode=TwoWay, Path=YourProperty, ConverterParameter=YourEnumString}">
    First way (parameter of type string)
</RadioButton>
<RadioButton GroupName="LineWidth">
    <RadioButton.IsChecked>
        <Binding
            Converter="{StaticResource PenWidthConverter}"
            Mode="TwoWay"   Path="PenWidth">
            <Binding.ConverterParameter>
                <yournamespace:YourEnum>YourEnumString</yournamespace:YourEnum>
            </Binding.ConverterParameter>
        </Binding>
    </RadioButton.IsChecked>
    Second way (parameter of type YourEnum (actually it was converted to int when passed to converter))
</RadioButton> 
```

# php - 如何制作文本输入字段

> ID：397558
> 
> 赞同：0
> 
> 时间：2008-12-29T11:35:38.583
> 
> 标签：php, javascript

如何创建一个文本输入字段，该字段接受输入字符并将其显示在另一个地方，一个字符一个字符地作为类型输入它们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T11:42:57.510

像这样的东西：

```
<input type="text" id="textField" />
<br />
<span id="textOutput"></span>

<script type="text/javascript">

    var input = document.getElementById("textField");
    var output = document.getElementById("textOutput");

    // sorry, it's better to use "onkeyup" event
    // to avoid the problem described in a post below
    input.onkeyup = function(){
        output.innerText = input.value;
    };
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T11:40:20.510

您可以先查看此站点中编辑字段的源代码。预览会在您键入时更新。

# asp.net - 搜索引擎站点地图 Asp.Net

> ID：397562
> 
> 赞同：0
> 
> 时间：2008-12-29T11:36:33.763
> 
> 标签：asp.net, .net-3.5, seo, sitemap

如果可能的话，谁能告诉我如何使用 asp.net 实现搜索引擎站点地图。我的网站的内容经常过期并且有新的东西进来，这就是为什么每当搜索引擎爬虫访问我的网站时我都希望它更新。

我遇到了[http://weblogs.asp.net/bleroy/archive/2005/12/02/432188.aspx](http://weblogs.asp.net/bleroy/archive/2005/12/02/432188.aspx)，它告诉我微软一年前发布了一个库，它可以完全满足我的需求。我在任何地方都找不到它。它是否已成为 ASP.Net 3.5 平台的一部分？

有没有其他更好的框架或库可以用于同样的目的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T14:57:31.237

You should develop a dynamic site map. Most of the open blog platforms support that feature you can inspire from them. You can develop for yourself. There is no need for external library.

This ([http://www.stilx.com/sitemap.axd](http://www.stilx.com/sitemap.axd)) is open blog ([BlogEngine.NET](http://www.dotnetblogengine.net/)). Because It's open source you can look up the sitemap sources.

# php - 拖放，编辑器

> ID：397563
> 
> 赞同：2
> 
> 时间：2008-12-29T11:37:06.243
> 
> 标签：php, javascript, ajax

如何制作像 wufoo.com 表单编辑器中的拖放编辑器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T12:39:55.537

通常客户端应用程序是使用某种**客户端框架构建的**。比较流行的是（排名不分先后）：

*   [GWT](http://code.google.com/webtoolkit/)
*   [小唯](http://developer.yahoo.com/yui/)
*   [jQuery](http://jquery.com/)

从检查这些开始，也许尝试一两个教程，这应该会让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T12:36:05.407

对于客户端 Web 应用程序，您始终可以查看源代码。

请注意不要 100% 复制它，只需将其用作知识的来源，并利用您的想象力来创造新的东西。

# cocoa - 如何给 NSWindow 一个特定的背景颜色

> ID：397572
> 
> 赞同：19
> 
> 时间：2008-12-29T11:43:54.277
> 
> 标签：cocoa, interface-builder

我正在编写一个具有 NSWindow 的可可应用程序。我想将窗口的背景颜色更改为特定颜色。但检查器中的窗口属性仅提供“纹理窗口”选项。如何根据需要制作窗口的颜色？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-30T00:50:34.113

尝试使用窗口实例上的颜色调用实例方法 setBackgroundColor:。名字里有什么.. ;)

像这样：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {
    // Option 1
    [self.window setBackgroundColor: NSColor.whiteColor];
    // Option 2 - using dot syntax
    self.window.backgroundColor = NSColor.whiteColor;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-10-20T13:52:47.650

更改窗口背景的最简单方法是直接在 .xib 文件中设置它。

根本没有代码：

1.  选择您的窗口（NSWindow 类应出现在 Class 字段中）
2.  单击用户定义的运行时属性下的 [+] 按钮
3.  输入“backgroundColor”并选择颜色

![XCode 中的窗口属性](https://i.stack.imgur.com/ujnjA.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-29T16:07:03.577

只要你只想改变内容区域的背景颜色，而不是框架和工具栏，你就不需要子类化`NSWindow`. 您需要做的是子类`NSView`化并让您的自定义视图绘制您想要的颜色，然后将该类的一个实例设置为窗口的内容视图。

或者，您可以设置无边框`NSImageView`或`NSColorWell`作为内容视图，但我不确定 Apple 是否意味着那些拥有子视图。如果没有，您必须将窗口留空。

也就是说，您应该确定自定义背景颜色是合适的*。*几乎总是这样，您应该坚持使用 Aqua 或 HUD 外观。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T12:07:49.940

您必须继承 NSWindow 才能更改背景，然后覆盖实现

```
- (id)initWithContentRect:(NSRect)contentRect
                styleMask:(NSUInteger)styleMask
                  backing:(NSBackingStoreType)bufferingType
                    defer:(BOOL)flag 
```

例如，参见 Mat Gemmell 的 HUDWindow：[http ://mattgemmell.com/2006/03/12/hudwindow](http://mattgemmell.com/2006/03/12/hudwindow)

# java - 我应该使用哪个 Java 异常？

> ID：397581
> 
> 赞同：4
> 
> 时间：2008-12-29T11:52:59.407
> 
> 标签：java, exception

假设我是一个完全懒惰的流浪汉，我不想投资我自己的异常类所需的几十次击键（实际上，使用哪个并不完全重要）。但是，为了假装我在这里遵循良好的做法，我想要一个最适合我情况的预先存在的做法。

**问题：**当我的类的构造函数在其参数中接收到在我在其他地方构建的给定列表中找不到的对象时，我需要抛出异常。

哪个异常类适合抛出？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-29T11:55:32.273

`IllegalArgumentException`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-29T12:03:16.157

准确度获胜者： [java.lang.IllegalArgumentException](http://java.sun.com/javase/6/docs/api/java/lang/IllegalArgumentException.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-29T14:33:33.657

IllegalArgumentException 确实是这里的答案，但我想说你的设计有问题。本质上，您的类不变量依赖于某些外部对象的状态，这是违反封装的。在不知道*其他*对象的情况下，无法确定对构造函数的调用是否会成功，这会导致 API 令人困惑且容易被滥用。

`static final`如果您引用的列表是不可修改的列表（请参阅 参考资料）并包含在相关类中，则此问题会有所缓解`java.util.Collections.unmodifiableList()`，但我仍然不太喜欢它。如果可能，最好将可接受的参数值封装在 中`enum`，这将完全消除对异常的需要。我通常不喜欢构造函数抛出的异常。如果必须抛出异常，请改用工厂方法。

如果您没有可用的选项来消除对外部列表的需求，您可能需要重新考虑您的设计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T15:51:14.870

如果您不担心类的数量会激增，您可以`IllegalArgumentException`针对这种情况进行扩展。

```
 public class InvalidInstance extends IllegalArgumentException{
    private String[] parameter;

    public InvalidInstance (String[] param){
        this.parameter = param;
    }

    public String getMessage()
    String msg = "YOUR_MESSAGE";
    /* I think a string as "The currente object is
       invalid for parameter "+cycle for over parameter;*/
    msg += super.geTMessage();
    return msg;
}

public Constructor(parameter1,...){
    String[] param = new String[number_parameters]
    if...
    throws new InvalidInstance(param);
} 
```

这样，您可以记录所有运行异常的参数。

这段代码读起来不是很漂亮：如果你喜欢结构化的代码，你可以使用。一个简单`IllegalArgumentException`的更常见:)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-29T12:04:43.080

以防万一你没有得到它，IllegalArgumentException :)

# ruby-on-rails - 如何阅读 Rails 示例项目的源代码？

> ID：397601
> 
> 赞同：2
> 
> 时间：2008-12-29T12:04:08.513
> 
> 标签：ruby-on-rails

推荐阅读示例项目的源代码，例如 Beast 和 Bort，作为学习 Rails 的好方法。但是我发现自己在阅读这些项目的源代码时迷失了方向，因为包含的插件可能会在没有任何提示的情况下引入一些奇怪的代码，例如`"require"`或`"include"`。你能分享一下你阅读rails代码的经验吗？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T17:54:29.460

在学习使用 Rails 时，要了解的最重要的事情之一是它如何加载您编写的代码。假设您在 app/controllers/demo/sub 目录中有一个 HelloController。如果您生成了这个控制器，它将具有正确的名称 Demo::Sub::HelloController。

当你的路由告诉 Rails 寻找“demo/sub/hello”时，它会被翻译成控制器的全名（Demo::Sub::HelloController），rails 会尝试调用它。Ruby 找不到这个类并调用 const_missing 使 Rails 将名称转换为文件，在本例中为 demo/sub/hello_controller（:: = /，除 first = _ 之外的大写字母，在下划线方法下查找 Inflections）。然后 Rails 需要这个文件并检查正确的类定义。

Rails 在 ruby​​ 的加载路径中添加了几个目录（app/controllers、app/models、app/helpers、lib、vendor），并且这些目录中的任何一个中的 demo/sub/hello_controller.rb 都可以满足要求。但是不在应用程序/控制器中的控制器需要特别注意那里的视图。

此外，这适用于命名空间，只有它会查找目录。因此引用 Demo::Sub 将查找 demo/sub 目录。这使您可以放弃类的标准定义，因此您可以

```
class Demo::Sub::HelloController < ActionController::Base

end 
```

代替

```
module Demo
  module Sub
    class HelloController < ActionController::Base

    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T12:43:41.757

Rails 代码主要是 ruby​​ 代码。精通 ruby​​，阅读 rails 代码完全没有问题。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T18:32:35.357

1.  开发一个简单的 Rails 项目，直到您掌握了基本的 Rails 内容。因为一旦您了解标准 Rails，您将更快地识别插件功能
2.  更好地了解 ruby​​，因为 Rails 是用它编写的。例如，有一本书叫 Ruby for Rails，这是一个很好的起点。
3.  我喜欢先从上到下查看测试（集成、控制器、模型）

# xml - 是否有库可以在 erlang 中执行 xslt 转换？

> ID：397604
> 
> 赞同：7
> 
> 时间：2008-12-29T12:06:09.083
> 
> 标签：xml, xslt, erlang

我对 erlang 真的很陌生，我想知道如何操作 xml。

我找到[了 erlsom](http://sourceforge.net/projects/erlsom)，但我需要对 xml 进行一些简单的转换。

我正在寻找一个 xslt（甚至是 1.0）库，但我没有找到任何东西并减少了自己在 DOM 上手动进行转换，或者任何你可以调用的结构来表示 erlang 中的 xml-tree。不用说结果是我用来获得可以通过一堆行的 xslt 实现的结果的不雅致的代码。

您知道可以为我指明正确方向的代码库、示例或文档吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-29T14:04:58.813

[http://erlang.org/doc/apps/xmerl/xmerl_xs_examples.html](http://erlang.org/doc/apps/xmerl/xmerl_xs_examples.html)

[http://erlang.org/user.html#sablotron-1.0 - 通过 WayBackMachine - 向下滚动页面](http://web.archive.org/web/20101123100410/http://erlang.org/user.html#sablotron-1.0)

[https://github.com/hyperthunk/erlxsl](https://github.com/hyperthunk/erlxsl)

# linux - 如何让用户以 root 权限运行脚本？

> ID：397612
> 
> 赞同：7
> 
> 时间：2008-12-29T12:09:28.953
> 
> 标签：linux, security, scripting, ubuntu, passwords

考虑到[SUID shell 脚本的危险](http://www.drdobbs.com/dangers-of-suid-shell-scripts/199101190)，是否有更安全的方法可以在 Linux 中为具有 root 权限的脚本（bash、PHP）提供无密码访问权限？

(Ubuntu 8.10)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-29T12:33:56.813

![替代文字](https://imgs.xkcd.com/comics/sandwich.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-29T12:10:50.650

你可以考虑[sudo](http://www.gratisoft.us/sudo/)。

虽然不是“无密码”，但它不需要为用户提供 root 密码。它还可以提供脚本使用的审计跟踪。

*编辑：根据克里斯的评论，对于某些命令，有一个选项根本不需要密码，有关详细信息，请参见[此处](http://www.gratisoft.us/sudo/man/sudoers.html#nopasswd_and_passwd)。还可以设置不过度提示输入密码，即一次输入密码可以在一段时间内用于多个命令。*

顺便说一句，sudo 是内置在 Ubuntu 中的，并且与 Gnome 很好地集成在一起。当 ubuntu 提示您输入密码以执行特权操作时，这就是 sudo 的底层。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-30T02:49:21.063

如果您使用 sudo 路线，请务必查看 sudoers 手册页的“[防止壳逃逸](http://www.sudo.ws/sudo/man/sudoers.html#preventing_shell_escapes)”部分。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-29T12:11:20.977

我会推荐[sudo](http://www.sudo.ws/)。确保适当收紧`sudoers`文件；是的，您可以允许在不请求密码的情况下执行某些命令。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-29T12:32:05.663

从安全的角度来看，将 sudo 配置为让普通用户以提升的权限运行 shell 脚本并不比让脚本 suid root 更好。所有的陷阱仍然存在。相反，您应该编写一个适当的程序来进行广泛的安全检查。需要考虑的几点：

*   不要用C写它，你会用双脚射击自己。*   检查所有输入。*   尽快放弃特权。*   保持简短。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-29T12:23:45.243

由于已经提到了*sudo ，您可能需要考虑各种沙盒环境，具体取决于您的需要——例如，*[监狱](http://en.wikipedia.org/wiki/Jail_(computer_security))或类似环境。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-30T09:10:21.310

为了提高安全性，请考虑是否可以作为具有所需访问权限的特殊用户或组执行操作。然后，您可以为该用户或组创建脚本 setuid/setgid。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T14:59:02.963

对于真正重量级的解决方案，请考虑 MAC（强制访问控制）系统，例如 SELinux、AppArmor、TrustedBSD 等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-23T11:21:10.960

如果用例是在 VirtualBox 下运行的机器并且安全性不是真正的问题，那么您只需要一个挡光板来防止自己在脚上开枪，然后呢？（那么安全论点就没有意义了，因为由于 VirtualBox 通过 NAT 隔离它的方式，机器是否被一个无论如何都看不到的外人破坏并不重要。）

# .net - 如何调试“意外的调试信息初始化错误 - '无法在运行时找到所需的导出。'”

> ID：397628
> 
> 赞同：0
> 
> 时间：2008-12-29T12:25:27.907
> 
> 标签：.net, visual-studio, debugging

我在尝试使用 Visual Studio 2008 构建的所有项目（包括全新的空模板）上都收到此错误消息：

> 意外的调试信息初始化错误——“无法在运行时找到所需的导出。”

[编译器错误 CS0040](http://msdn.microsoft.com/en-us/library/d82598t0.aspx)的错误帮助不是很有帮助：

> 使用 /debug 编译器选项时可能会发生此错误，这表明编译器无法写入 .pdb 文件。此错误的可能解决方法包括重新安装 Visual Studio、确保编译器对文件或目录具有写入权限，或者不使用 /debug 进行编译。

我可以在预期的 {bin,obj}\Debug 目录中手动创建文件，以管理员身份运行 Studio 没有帮助，卸载 3.5 框架和 Visual Studio 2008 并重新安装它们各自的 Service Pack，我我仍然收到错误。

`/debug`从命令行中删除所有开关显然会删除所示的错误消息，但不是进一步开发的选择。

我该如何进一步调试呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T13:01:41.267

最后，我使用[Sysinternals Suite中的](http://technet.microsoft.com/en-us/sysinternals/0e18b180-9b7a-4c49-8120-c47c5a693683.aspx)[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)来查看编译器正在执行的操作。通过从 Visual Studio 2008 命令提示符开始并在进程监视器中过滤，我很好地了解了编译器在做什么。`csc.exe``Process Name is "csc.exe"`

受到“无法在运行时找到所需的导出”消息的“启发”，我搜索了丢失的 DLL，实际上发现它`csc.exe`正在尝试访问`Windows\Microsoft.NET\Framework\v2.0.50727\diasymreader.dll`但失败了。从另一个安装中获取该 DLL 为我修复了该错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T12:44:32.720

这听起来像是您以某种方式安装了不匹配的 VS/.NET DLL 版本，或者我见过几次发生的一些奇怪的“半 3.0 半 3.5”错误状态；您可以到处检查版本，但最简单的方法可能是铺好机器:(

# sql - 添加日期不超过一个月

> ID：397631
> 
> 赞同：2
> 
> 时间：2008-12-29T12:29:01.723
> 
> 标签：sql, oracle, function, date, math

我希望有人能在这方面帮助我。

我想将一个月添加到数据库日期，但我想在最后的那些日子里防止两个跳过一个月。

例如我可能有：

2009 年 1 月 31 日

我想得到

2009 年 2 月 28 日

并不是

2009 年 3 月 2 日

下一个日期是

2009 年 3 月 28 日

2009 年 6 月 28 日

等等

在 oracle 中是否有已经执行这种操作的函数？

**编辑**

是的。我想每个月将所有具有某种状态的记录复制到下一个（因此用户不必每月再次输入 2,000 行）

我可以获取所有记录并手动更新日期（以一种命令式的方式），但我宁愿让 SQL 完成这项工作。

就像是：

```
insert into the_table 
select f1,f2,f3, f_date + 30 /* sort of ... :S */  from the_Table where date > ? 
```

但问题出现在最后一天。

在我必须编写这样的代码之前有什么想法吗？

```
for each record in 
   createObject( record )
   object.date + date blabala
   if( date > 29 and if februrary and the moon and the stars etc etc 9 

end 

update....  et 
```

**编辑：2**

添加几个月就可以了。

现在我只有这个：

```
insert into my_table
select f1, add_months( f2, 1 ) from my_table where status = etc etc 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-29T13:14:07.450

Oracle 有一个内置函数[ADD_MONTHS](http://download.oracle.com/docs/cd/B10501_01/server.920/a96540/functions5a.htm)正是这样做的：

```
SQL> select add_months(date '2008-01-31',1) from dual;

ADD_MONTHS(
-----------
29-FEB-2008

SQL> select add_months(date '2008-02-29',1) from dual;

ADD_MONTHS(
-----------
31-MAR-2008 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T12:40:10.640

我认为您正在寻找 LAST_DAY：

[http://download.oracle.com/docs/cd/B28359_01/olap.111/b28126/dml_functions_2006.htm](http://download.oracle.com/docs/cd/B28359_01/olap.111/b28126/dml_functions_2006.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T13:15:33.143

我刚刚做了： select add_months(TO_DATE('30-DEC-08'), 2) from dual

并得到了 28-FEB-2009

无需使用 LAST_DAY。如果你走这条路，你可以创建一个函数： 1\. 获取日期 2\. 将日期更改为每月的第一天。3\. 增加一个月。4\. 将日期更改为该月的 LAST_DAY。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T12:42:18.730

我想你必须自己写，我的建议是首先用这种方法评估“本月的最后一天”：

*   加一个月（不是30天，一个月！）
*   查找本月的第一天（应该很容易）
*   减去一天

然后将其与您的“加 x 天”值进行比较，并选择最低的值（我理解从 1 月 31 日到 2 月 28 日的跳跃背后的逻辑，但我不明白从 2 月 28 日到 28 日的跳跃-三月）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T12:46:30.563

听起来您想要当月加一（12 月有适当的展期）

以及该月的最后一天和当天的最小值。

# .net - .NET 的 FindBugs

> ID：397641
> 
> 赞同：17
> 
> 时间：2008-12-29T12:34:14.503
> 
> 标签：.net, static-analysis, findbugs

在 Java 中是一个名为[FindBugs](http://findbugs.sourceforge.net/)的好工具。.Net中有类似的东西吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-29T12:47:09.110

[FxCop](http://code.msdn.microsoft.com/codeanalysis/Release/ProjectReleases.aspx?ReleaseId=553)和[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)将提供使用建议。

对于实际的错误，也许是[PEX](http://research.microsoft.com/projects/Pex/)？也有一个[PDC 视频](http://channel9.msdn.com/pdc2008/TL51/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-12T23:39:15.380

这是[Wikipedia List](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#.NET)，[CodeRush](http://www.devexpress.com/Products/CodeRush/)是用于 .NET 的好工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-11T12:14:54.677

试试[PVS-Studio](http://www.viva64.com/en/pvs-studio/)真的很棒，能发现很多隐晦的 bug。缺点是它是商业产品并且可能很昂贵。

# django - FastCGI、Lighttpd 接口错误/操作错误

> ID：397646
> 
> 赞同：0
> 
> 时间：2008-12-29T12:37:04.000
> 
> 标签：django, fastcgi, lighttpd

我在使用 FastCGI 运行我的 Django 应用程序时遇到接口错误/操作错误。在检查访问日志（lighttpd）时，我发现这些错误弹出，这些错误通常与关闭某些数据库连接或其他有关。浏览器显示两件事之一 - 未处理的异常或连接终止失败消息。刷新页面一次（通常）后，错误似乎消失了。我怎样才能防止这种情况发生？该系统确实以一种不稳定的方式运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T18:04:42.570

出现此问题可能有 2 个原因。1\. 并非 urls.py 中提到的所有 URL 都正确反转。2\. 这是困难的部分 - 在项目中的某个地方导入失败。它可能正在导入一个不存在的方法。

我遇到了同样的问题，我发现有很多像第二点提到的那样的进口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-16T18:43:47.303

I faced the same problem, and wrote my own solution after finding nothing from the web. Please check my blogpost here: [Simple Python Utility to check all Imports in your project](http://nandakishore.posterous.com/simple-djangopython-utility-to-check-all-the "Simple Python Utility to check all Imports in your project")

Ofcourse this will only help you to get to the solution of the original issue pretty quickly and not the actual solution for your problem by itself.

# wcf - 数据合约和 BAL 中的属性重复

> ID：397652
> 
> 赞同：1
> 
> 时间：2008-12-29T12:40:27.953
> 
> 标签：wcf, silverlight, contract

我有一个 Silverlight 项目，它使用数据协定将数据传递给 WCF 服务。然后，WCF 方法调用同样具有相同属性的 BAL 类。有什么办法可以避免这种属性的重复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T13:20:32.477

查克，

根据您的情况，这可能对您有用。您可以在 Visual Studio 中的项目之间共享项目。添加新项目（在您的情况下为 C# 类）时，只需将该项目添加为链接项目。通过这样做，该类将仅存在于一个位置。几个月前我写了一篇关于这个的博客文章。

我希望这有帮助！

[http://www.pagebrooks.com/archive/2008/10/11/sharing-code-between-.net-and-silverlight-platforms.aspx](http://www.pagebrooks.com/archive/2008/10/11/sharing-code-between-.net-and-silverlight-platforms.aspx)

# java - 在文件中添加逗号

> ID：397667
> 
> 赞同：2
> 
> 时间：2008-12-29T12:48:40.543
> 
> 标签：java

这是我在这个论坛上的第一个问题......我有一个文件，其中包含许多数据字段（数字和字符）。我想用一组分隔符长度来分隔文件，如 2、5、1、9、6 等。

（*或者：我有一个字段长度列表，例如 2、5、1、9、6，我想在每个字段之后的源字符串（副本）中插入逗号分隔符。*）

例如，如果我的文件是这样的：

```
9483trdcvge245621jde 
```

然后我需要在 2,5,1,9,6 等处插入逗号，输出将是：

```
94,83trd,c,vge245621,jde, 
```

我需要在**JAVA中执行此操作**

请帮我解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T12:58:16.547

```
if (myString.equals("9483trdcvge245621jde")) {
        myString = "94,83trd,c,vge245621,jde";
    } 
```

开玩笑的;-)

我想像这样的事情......

```
private static final int[] pos = {2, 5, 1, 9, 6};
private static final String DIV = ",";

public static String parse(String str) {
    int start = 0;
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < pos.length; i++) {
        if (i > 0) { 
            sb.append(DIV);
        }
        int end = start + pos[i];
        if (end <= str.length()) {
            sb.append(str.substring(start, end));
            start = end;
        } else {
            sb.append(str.substring(start));
        }

    }
    return sb.toString();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T13:04:10.607

以 StringBuilder 的形式读入文件，然后使用类似这样的东西

```
StringBuilder sb = new StringBuilder(file); //The string builder
while (/*the string builder isn't finished*/)
{
  int position = ;//The position you want the comma at 2 or 4 or whatever
  sb.insert(position, ",");
} 
```

根据需要循环多次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T14:52:13.680

I think i would do it this way

*   `str` being the input string
*   `pos` being the lengths of the parts after which we should put a comma

Code:

```
public static String partition(String str, int[] pos) {
    int oldPos = 0;
    StringBuilder builder = new StringBuilder(str.length() + pos.length);
    for(int len : pos) {
        builder.append(str.substring(oldPos, oldPos+len)).append(',');
        oldPos += len;
    }
    builder.append(str.substring(oldPos)).append(',');
    return builder.toString();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T12:58:04.613

我想我不明白这个问题。逐行读取文件，然后在字符串中插入逗号。

```
String newString = line.substring(0, firstComma) + "," + line.substring(firstComma + 1); 
```

当然，这是非常低效的，可以通过多种方式进行优化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T12:58:21.633

假设您拥有所有这些，因为`Strings`您可以使用 String.substring(start, end)。然后只需将`+`子字符串和逗号附加在一起。

```
String data = "9483trdcvge245621jde";
String result = "";

result += data.substring(0,2) + ",";
result += data.substring(2, 7) + ",";
result += data.substring(7, 8) + ","; 
```

ETC...

**注意：**使用`+`这样的附加字符串非常慢，因为它每次都会重新分配和移动数据。`String`如果速度是一个问题，有更快的连接 s 的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-29T13:35:09.967

```
String newString = "";
int[] positions = { 2, 5, 1, 9, 6 }; //etc
for (int i = 0; i > positions.length; i++) {
    String tempString = "";
    if (i == positions.length) { //for the last item
      tempString = oldString.substring(0, positions[i]);
    }
    else { //every item except the last item
      tempString = oldString.substring(0, positions[i]) + ",";
    }
    oldString = oldString.substring(positions[i]);
    newString += tempString;
} 
```

将位置存储在数组中。遍历，将分隔字符串添加到新字符串中，然后将它们从旧字符串中删除。这可能不是最好的方法，但它是我将如何做到的。:P

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-29T15:11:14.233

Here's one solution:

```
package com.foo;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class Commafy {

    public static final String SEPARATOR = ",";

    private static void fail(String message) {
        System.err.println(message);
        System.exit(1);
    }

    private static int[] argsAsInts(String[] args) {
        if (args.length < 2) {
            fail("argument list of file name followed by field lengths is required");
        }
        int[] result = new int[args.length - 1];
        for (int i = 1; i < args.length; ++i) {
            try {
                result[i - 1] = Integer.parseInt(args[i]);
            } catch (NumberFormatException nfe) {
                fail("can't convert argument \"" + args[i] + "\" to integer");
            }
        }
        return result;
    }

    private static int[] partialSums(int[] lengths) {
        int[] result = new int[lengths.length];
        int start = 0;
        for (int i = 0; i < lengths.length; ++i) {
            result[i] = start;
            start += lengths[i];
        }
        return result;
    }

    private static int[] fieldsEndAt(int[] lengths, int[] starts) {
        int[] result = new int[lengths.length];
        for (int i = 0; i < lengths.length; ++i) {
            result[i] = starts[i] + lengths[i];
        }
        return result;
    }

    private static void process(
        String fileName, int[] starts, int[] ends
    ) throws IOException {
        BufferedReader br = new BufferedReader(
            new FileReader(fileName)
        );
        final int MIN_LENGTH = ends[ends.length - 1];
        String line = br.readLine();
        while (line != null) {
            if (line.length() < MIN_LENGTH) {
                System.err.println("short input line \"" + line +"\" skipped");
            } else {
                StringBuilder sb = new StringBuilder();
                String separate = "";
                for (int i = 0; i < starts.length; ++i) {
                    sb.append(separate).append(line.substring(starts[i], ends[i]));
                    separate = SEPARATOR;
                }
                System.out.println(sb.toString());
            }
            line = br.readLine();
        }
        br.close();
    }

    public static void main(String[] args) {
        int[] lengths = argsAsInts(args);
        int[] starts = partialSums(lengths);
        int[] ends = fieldsEndAt(lengths, starts);
        try {
            process(args[0], starts, ends);
        } catch (IOException e) {
            fail("I/O Exception while processing input");
        }
    }

} 
```

Given a data file named `data/fixedlengthdata.text` containing:

```
9483trdcvge245621jde
9483trdcvge245621jdelong
9483trdcvge245621
9483trdcvge245621jde 
```

and run with arguments of:

```
data/fixedlengthdata.text 2 5 1 9 3 
```

it produces output of:

```
94,83trd,c,vge245621,jde
94,83trd,c,vge245621,jde
short input line "9483trdcvge245621" skipped
94,83trd,c,vge245621,jde 
```

(where the third line above goes to stderr, of course.)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-29T19:31:14.693

这可能是我见过的最奇怪的要求，但无论如何......

伪代码

```
Collection<Integer> indexes; // initialized with indexes to add commas at 
StringBuilder bldr = new StringBuilder();

for (int i = 0; i < inString.length(); i++){

     bldr.append(inString.charAt(i));

     if (indexes.contains(i))
         bldr.append(",");

}

return bldr.toString(); 
```

# javascript - 使用 JQuery 处理切换的 onclick

> ID：397677
> 
> 赞同：1
> 
> 时间：2008-12-29T12:59:29.320
> 
> 标签：javascript, jquery, html

我有一段文本，我希望显示被截断，但单击它会展开以显示其余部分。再次单击应将其截断。

我试图使用 onclick 事件按如下方式处理此问题（**警告**：请勿在未阅读以下内容的情况下运行以下代码...）：

```
<span id='blah' onclick='showAllComment("this is a long comment to see it all", 9, true )'>this is a...</span>

<script>
function showAllComment( comment, shortCommentLen, showFullComment )
{
    alert( $("#blah").html() );

    if( showFullComment )
    {
        $("#blah").html( comment );
        $("#blah").click( showAllComment( comment, shortCommentLen, false ) );
    }
    else
    {
        $("#blah").html( comment.substring( 0, shortCommentLen ) + "..." );
        $("#blah").click( showAllComment( comment, shortCommentLen, true ) );
    }
}
</script> 
```

但正如您将看到的，它反复调用自己，您必须结束浏览器任务（因此在运行此代码时要小心！！！！）

任何人都可以建议为什么会发生这种情况，以及如何解决它。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T13:06:04.050

这是因为您正在递归调用该`showAllComment`函数

尝试做这样的事情：

```
function showAllComment( comment, shortCommentLen, showFullComment )
{
    alert( $("#blah").html() );

    if( showFullComment )
    {
        $("#blah").html( comment );
        $("#blah").click( function () { showAllComment(comment, shortCommentLen, false);} );
    }
    else
    {
        $("#blah").html( comment.substring( 0, shortCommentLen ) + "..." );
        $("#blah").click( function () {showAllComment( comment, shortCommentLen, true );} );
    }
} 
```

这样，您将调用封闭在匿名函数中，因此仅在单击`#bla`元素后才会执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T14:54:07.827

未启用 javascript 的用户将无法阅读评论。更好的方法是将整个注释包含在 中，`span`并在页面加载时使 javascript 截断它：

javascript:

```
$(function() {
    $(".blah").each( function() {
        var shortCommentLen = 9;
        var comment = $(this).html();                   
        $(this).html(shortComment(comment, shortCommentLen));
        $(this).toggle(
            function() { $(this).html(comment); },
            function() { $(this).html(shortComment(comment, shortCommentLen)); }
        );

        function shortComment(comment, shortCommentLen) {
            return comment.substring( 0, shortCommentLen ) + "...";
        }
    });
}); 
```

html:

```
<span class='blah'>this is a long comment to see it all</span> 
```

`toggle(fn1, fn2)`单击该元素时，该功能在两个功能之间交替。

# jquery - SimpleModal 调整容器大小

> ID：397684
> 
> 赞同：9
> 
> 时间：2008-12-29T13:03:19.423
> 
> 标签：jquery, ajax, model, resize

我用过[SimpleModal](http://www.ericmmartin.com/projects/simplemodal/)。现在的问题是模式对话框的大小调整。我有一个确认对话框，按是后它基本上很小。

第二个是`my.php`它包含大量数据。我正在使用附加现有模型的概念。如何调整内容的大小？

我的 JavaScript 片段有：

```
$(document).ready(function () {
    $('#confirmbutton, #confirmDialog a.confirm').click(function (e) {
        e.preventDefault();

        confirm("Continue to the SimpleModal project page?", function () {
        window.location.href = 'http://localdata/';
        });
    });
});

function confirm(message, callback) {
    $('#confirm').modal({
        close:false,
        position: ["20%",],
        overlayId:'confirmModalOverlay',
        containerId:'confirmModalContainer',
        onShow: function (dialog) {
            dialog.data.find('.message').append(message);

            // If the user clicks "yes"
            dialog.data.find('.yes').click(function () {
                // Call the callback
                // $.modal.close();

                $.get("my.php", function (data) {
                    /* Sample response:
                     *   <div id="title">My title</div>
                     *   <div id="message">My message</div>
                     *
                    */

                    var resp = $("<div/>").append(data);
                    var title = resp.find("#title").html(),
                    message = resp.find("#message").html();
                    dialog.data.find(".header span").html(title);
                    dialog.data.find(".message").html(message);
                    dialog.data.find(".buttons .yes").hide();
                    dialog.data.find(".buttons .no").hide();

                    //dialog.data.find(".buttons .no").html("Close");

                    // No need to call the callback or $.modal.close()
                });// End for click
            });//End for on show
        } //End for modal
    }); //Close for modal
} 
```

我的 CSS：

```
confirmModalContainer {height:700px; width:700px; font-family:'Trebuchet MS', Verdana, Arial; font-size:16px; text-align:left; background:#fff; border:2px solid #336699;} 
```

如何修改 SimpleModal 容器大小？在 Ajax 通话中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-08-02T18:13:48.437

就这样做吧……

```
$("#simplemodal-container").css('height', 'auto'); //To reset the container.
$(window).trigger('resize.simplemodal');           //To refresh the modal dialog. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T01:52:42.010

我想提出一个更简单、更灵活的解决方案：

访问[http://www.ericmmartin.com/simplemodal-test/](http://www.ericmmartin.com/simplemodal-test/)，在 Firebug 中运行以下代码，然后单击对话框中的“按钮”来调整它的大小。

```
// Inject a CSS class into the document
$('head style[type=text/css]').append('.wide{width:750px !important;}');

$('#modalContentTest').modal({
  onShow:function(dialog){
    dialog.data.find('.animate').click(function(){

      // You can put this code in your "my.php" callback

      dialog.container.addClass('wide');

      /*
      // OR set the width explicitly
      // (make sure you remove the addClass line if you want to use this)
      dialog.container.width(700);
      */

      /*
        Force SimpleModal to reposition the 
        dialog by triggering its resize event
      */
      $(window).trigger('resize.simplemodal');

    }); //end click
  } // end onShow
}); // end modal 
```

使用这种方法，您不必定义新的 CSS 来重新居中对话框，并且可以让 SimpleModal 处理浏览器的不一致问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T06:13:22.567

您可以通过添加和删除 modalContainer 元素的类来实现。

[Fog Creek Copilot](https://www.copilot.com/)使用 SimpleModal，具有正常和宽两种尺寸。如果您转到 Copilot 并单击“登录”，您将看到正常大小。现在，放入 Firebug 的控制台

```
>> $('.modalContainer').addClass('wide') 
```

你应该看到容器变宽了。要在您的网站上进行这项工作，您所要做的就是为您想要的所有尺寸定义类，并动态添加和删除它们。

# language-agnostic - 如何显示浮点数或双精度数的二进制表示？

> ID：397692
> 
> 赞同：41
> 
> 时间：2008-12-29T13:08:54.293
> 
> 标签：language-agnostic, floating-point

我想显示浮点数的二进制（或十六进制）表示。我知道如何手动转换（使用[这里](http://en.wikipedia.org/wiki/Floating_point#Implementation_in_actual_computers:_IEEE_floating-point)的方法），但我有兴趣查看执行相同操作的代码示例。

虽然我对 C++ 和 Java 解决方案特别感兴趣，但我想知道是否有任何语言使它特别容易，所以我让这种**语言不可知**。我很想看到其他语言的一些解决方案。

**编辑：**我已经很好地覆盖了 C、C++、C# 和 Java。是否有任何替代语言专家想要添加到列表中？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-29T13:14:47.107

C/C++ 很简单。

```
union ufloat {
  float f;
  unsigned u;
};

ufloat u1;
u1.f = 0.3f; 
```

然后你就输出`u1.u`. 您可以调整[此实现](http://www.daniweb.com/code/snippet87.html)。

双打一样容易。

```
union udouble {
  double d;
  unsigned long u;
} 
```

因为双打是 64 位的。

Java 更简单一些：使用[Float.floatToRawIntBits()](http://java.sun.com/javase/6/docs/api/java/lang/Float.html#floatToRawIntBits(float))结合[Integer.toBinaryString()](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html#toBinaryString(int))和[Double.doubleToRawLongBits](http://java.sun.com/javase/6/docs/api/java/lang/Double.html#doubleToRawLongBits(double))结合[Long.toBinaryString()](http://java.sun.com/javase/6/docs/api/java/lang/Long.html#toBinaryString(long))。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-02-15T20:34:45.283

在 C 中：

```
int fl = *(int*)&floatVar; 
```

`&floatVar`将获得地址内存然后`(int*)`将是指向该地址内存的指针，最后是 * 以获取 int 中浮点数的 4 个字节的值。然后你可以 printf 二进制格式或十六进制格式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-29T13:26:03.073

Java：谷歌搜索在[Sun 的论坛上找到了这个链接](http://forums.sun.com/thread.jspa?threadID=5286264)

具体来说（我自己没有尝试过）

```
long binary = Double.doubleToLongBits(3.14159);
String strBinary = Long.toBinaryString(binary); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-29T13:40:36.897

在 .NET（包括 C#）中，您可以`BitConverter`接受多种类型，允许访问原始二进制文件；要获得十六进制，`ToString("x2")`是最常见的选项（可能包含在实用方法中）：

```
 byte[] raw = BitConverter.GetBytes(123.45);
    StringBuilder sb = new StringBuilder(raw.Length * 2);
    foreach (byte b in raw)
    {
        sb.Append(b.ToString("x2"));
    }
    Console.WriteLine(sb); 
```

奇怪的是，base-64 有一个 1 行转换 ( `Convert.ToBase64String`)，但是 base-16 需要更多的努力。除非您引用 Microsoft.VisualBasic，否则在这种情况下：

```
long tmp = BitConverter.DoubleToInt64Bits(123.45);
string hex = Microsoft.VisualBasic.Conversion.Hex(tmp); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-29T15:04:29.333

我是这样做的：

```
/*
@(#)File:           $RCSfile: dumpdblflt.c,v $
@(#)Version:        $Revision: 1.1 $
@(#)Last changed:   $Date: 2007/09/05 22:23:33 $
@(#)Purpose:        Print C double and float data in bytes etc.
@(#)Author:         J Leffler
@(#)Copyright:      (C) JLSS 2007
@(#)Product:        :PRODUCT:
*/

/*TABSTOP=4*/

#include <stdio.h>
#include "imageprt.h"

#ifndef lint
/* Prevent over-aggressive optimizers from eliminating ID string */
extern const char jlss_id_dumpdblflt_c[];
const char jlss_id_dumpdblflt_c[] = "@(#)$Id: dumpdblflt.c,v 1.1 2007/09/05 22:23:33 jleffler Exp $";
#endif /* lint */

union u_double
{
    double  dbl;
    char    data[sizeof(double)];
};

union u_float
{
    float   flt;
    char    data[sizeof(float)];
};

static void dump_float(union u_float f)
{
    int exp;
    long mant;

    printf("32-bit float: sign: %d, ", (f.data[0] & 0x80) >> 7);
    exp = ((f.data[0] & 0x7F) << 1) | ((f.data[1] & 0x80) >> 7);
    printf("expt: %4d (unbiassed %5d), ", exp, exp - 127);
    mant = ((((f.data[1] & 0x7F) << 8) | (f.data[2] & 0xFF)) << 8) | (f.data[3] & 0xFF);
    printf("mant: %16ld (0x%06lX)\n", mant, mant);
}

static void dump_double(union u_double d)
{
    int exp;
    long long mant;

    printf("64-bit float: sign: %d, ", (d.data[0] & 0x80) >> 7);
    exp = ((d.data[0] & 0x7F) << 4) | ((d.data[1] & 0xF0) >> 4);
    printf("expt: %4d (unbiassed %5d), ", exp, exp - 1023);
    mant = ((((d.data[1] & 0x0F) << 8) | (d.data[2] & 0xFF)) << 8) |
              (d.data[3] & 0xFF);
    mant = (mant << 32) | ((((((d.data[4] & 0xFF) << 8) |
              (d.data[5] & 0xFF)) << 8) | (d.data[6] & 0xFF)) << 8) |
              (d.data[7] & 0xFF);
    printf("mant: %16lld (0x%013llX)\n", mant, mant);
}

static void print_value(double v)
{
    union u_double d;
    union u_float  f;

    f.flt = v;
    d.dbl = v;

    printf("SPARC: float/double of %g\n", v);
    image_print(stdout, 0, f.data, sizeof(f.data));
    image_print(stdout, 0, d.data, sizeof(d.data));
    dump_float(f);
    dump_double(d);
}

int main(void)
{
    print_value(+1.0);
    print_value(+2.0);
    print_value(+3.0);
    print_value( 0.0);
    print_value(-3.0);
    print_value(+3.1415926535897932);
    print_value(+1e126);
    return(0);
} 
```

在 SUN UltraSPARC 上运行，我得到：

```
SPARC: float/double of 1
0x0000: 3F 80 00 00                                       ?...
0x0000: 3F F0 00 00 00 00 00 00                           ?.......
32-bit float: sign: 0, expt:  127 (unbiassed     0), mant:                0 (0x000000)
64-bit float: sign: 0, expt: 1023 (unbiassed     0), mant:                0 (0x0000000000000)
SPARC: float/double of 2
0x0000: 40 00 00 00                                       @...
0x0000: 40 00 00 00 00 00 00 00                           @.......
32-bit float: sign: 0, expt:  128 (unbiassed     1), mant:                0 (0x000000)
64-bit float: sign: 0, expt: 1024 (unbiassed     1), mant:                0 (0x0000000000000)
SPARC: float/double of 3
0x0000: 40 40 00 00                                       @@..
0x0000: 40 08 00 00 00 00 00 00                           @.......
32-bit float: sign: 0, expt:  128 (unbiassed     1), mant:          4194304 (0x400000)
64-bit float: sign: 0, expt: 1024 (unbiassed     1), mant: 2251799813685248 (0x8000000000000)
SPARC: float/double of 0
0x0000: 00 00 00 00                                       ....
0x0000: 00 00 00 00 00 00 00 00                           ........
32-bit float: sign: 0, expt:    0 (unbiassed  -127), mant:                0 (0x000000)
64-bit float: sign: 0, expt:    0 (unbiassed -1023), mant:                0 (0x0000000000000)
SPARC: float/double of -3
0x0000: C0 40 00 00                                       .@..
0x0000: C0 08 00 00 00 00 00 00                           ........
32-bit float: sign: 1, expt:  128 (unbiassed     1), mant:          4194304 (0x400000)
64-bit float: sign: 1, expt: 1024 (unbiassed     1), mant: 2251799813685248 (0x8000000000000)
SPARC: float/double of 3.14159
0x0000: 40 49 0F DB                                       @I..
0x0000: 40 09 21 FB 54 44 2D 18                           @.!.TD-.
32-bit float: sign: 0, expt:  128 (unbiassed     1), mant:          4788187 (0x490FDB)
64-bit float: sign: 0, expt: 1024 (unbiassed     1), mant: 2570638124657944 (0x921FB54442D18)
SPARC: float/double of 1e+126
0x0000: 7F 80 00 00                                       ....
0x0000: 5A 17 A2 EC C4 14 A0 3F                           Z......?
32-bit float: sign: 0, expt:  255 (unbiassed   128), mant:                0 (0x000000)
64-bit float: sign: 0, expt: 1441 (unbiassed   418), mant:      -1005281217 (0xFFFFFFFFC414A03F) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-05-25T14:46:41.990

显然没有人愿意提及获得*十六进制指数符号*是多么微不足道，所以这里是：

```
#include <iostream>
#include <cstdio>

using namespace std;

int main()
{
    // C++11 manipulator
    cout << 23.0f << " : " << std::hexfloat << 23.0f << endl;
    // C equivalent solution
    printf("23.0 in hexadecimal is: %A\n", 23.0f);
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-29T13:43:47.360

好吧 Float 和 Double 类（在 Java 中）都有一个 toHexString('float') 方法，所以这几乎可以用于十六进制转换

```
Double.toHexString(42344);
Float.toHexString(42344); 
```

非常简单！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-11-20T11:16:11.530

我不得不考虑在这里发布一段时间，因为这可能会激发其他编码人员用 C 做坏事。我还是决定发布它，但请记住：不要在没有适当文档的情况下将这种代码写到任何严肃的应用程序中，即使那样三思而后行。

除了免责声明，我们开始吧。

首先编写一个函数来打印例如二进制格式的长无符号变量：

```
void printbin(unsigned long x, int n)
{
  if (--n) printbin(x>>1, n);
  putchar("01"[x&1]);
} 
```

不幸的是，我们不能直接使用这个函数来打印我们的浮点变量，所以我们不得不稍微修改一下。对于读过Carmack 的Quake[的 Inverse Square Root技巧的人来说，这个 hack 可能看起来很熟悉。](http://www.codemaestro.com/reviews/9)这个想法是为我们的浮点变量设置一个值，然后为我们的长整数变量获取相同的位掩码。因此，我们获取 f 的内存地址，将其转换为 long* 值，并使用该指针将 f 的位掩码作为 long 无符号。如果您要将此值打印为无符号长，结果将是一团糟，但这些位与原始浮点值中的位相同，因此并不重要。

```
int main(void)
{
  long unsigned lu;
  float f = -1.1f;

  lu = *(long*)&f;
  printbin(lu, 32);
  printf("\n");
  return 0;
} 
```

如果您认为这种语法很糟糕，那么您是对的。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-11-20T22:14:05.893

在 Haskell 中，没有可访问的浮点的内部表示。但是您可以对多种格式进行二进制序列化，包括 Float 和 Double。以下解决方案对于具有 Data.Binary 实例支持的任何类型都是通用的：

```
module BinarySerial where

import Data.Bits
import Data.Binary
import qualified Data.ByteString.Lazy as B

elemToBits :: (Bits a) => a -> [Bool]
elemToBits a = map (testBit a) [0..7]

listToBits :: (Bits a) => [a] -> [Bool]
listToBits a = reverse $ concat $ map elemToBits a

rawBits :: (Binary a) => a -> [Bool]
rawBits a = listToBits $ B.unpack $ encode a 
```

可以使用 rawBits 进行转换：

```
rawBits (3.14::Float) 
```

但是，如果您需要以这种方式访问​​浮点值，您可能做错了什么。真正的问题可能是*如何访问浮点数的指数和有效位？*答案是Prelude 中的[指数](http://haskell.org/ghc/docs/6.12.1/html/libraries/base-4.2.0.0/Prelude.html#v%3Aexponent)和有效数：

```
significand 3.14
0.785

exponent 3.14
2 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-08-29T03:31:23.617

**Python：**

代码：

```
import struct

def float2bin(number, hexdecimal=False, single=False):
    bytes = struct.pack('>f' if single else '>d', number)
    func, length = (hex, 2) if hexdecimal else (bin, 8)
    byte2bin = lambda byte: func(ord(byte))[2:].rjust(length, '0')
    return ''.join(map(byte2bin, bytes)) 
```

样本：

```
>>> float2bin(1.0)
'0011111111110000000000000000000000000000000000000000000000000000'
>>> float2bin(-1.0)
'1011111111110000000000000000000000000000000000000000000000000000'
>>> float2bin(1.0, True)
'3ff0000000000000'
>>> float2bin(1.0, True, True)
'3f800000'
>>> float2bin(-1.0, True)
'bff0000000000000' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-04-11T09:16:15.530

您可以使用 C# 中的此类代码轻松地将 float 变量转换为 int 变量（或将 double 转换为 long）：

```
float f = ...;   
unsafe
{
    int i = *(int*)&f;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-08-10T07:47:38.693

为了将来参考，C++ 2a 引入了一个新的函数模板`bit_cast`来完成这项工作。

```
template< class To, class From >
constexpr To bit_cast(const From& from) noexcept; 
```

我们可以简单地调用，

```
float f = 3.14;
std::bit_cast<int>(f); 
```

有关更多详细信息，请参阅[https://en.cppreference.com/w/cpp/numeric/bit_cast](https://en.cppreference.com/w/cpp/numeric/bit_cast)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-29T14:35:28.580

在 C++ 中，您可以通过以下方式显示它的二进制表示：

```
template <class T>
std::bitset<sizeof(T)*8> binary_representation(const T& f)
{
   typedef unsigned long TempType;
   assert(sizeof(T)<=sizeof(TempType));
   return std::bitset<sizeof(T)*8>(*(reinterpret_cast<const TempType*>(&f)));
} 
```

这里的限制是由于 bitset long 参数是 unsigned long 的事实，所以它可以使用 float，您可以使用 bitset 和扩展该断言之外的其他东西。

顺便说一句，cletus 建议在您需要“unsingned long long”来覆盖双精度的意义上失败了，无论如何您需要显示二进制（1 或 0）表示的东西。

# javascript - 覆盖在 iframe 中加载的外部页面的 getFocus

> ID：397694
> 
> 赞同：1
> 
> 时间：2008-12-29T13:09:48.973
> 
> 标签：javascript, jquery, iframe, focus

我在 iframe 中有多个页面，其中一个似乎正在获得焦点，因为页面（自行）滚动到那个特定的 iframe。

有没有办法覆盖这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T13:25:29.610

可以覆盖 iFrame onFocus 事件以设置焦点优先级。但是，要小心，因为它有时不适用于 Mozilla。另外，我更喜欢使用 Div 并在 Div 中显示 HTML。

# ajax - 使用 ASP.NET MVC 和 AJAX 进行实时搜索

> ID：397704
> 
> 赞同：6
> 
> 时间：2008-12-29T13:19:36.847
> 
> 标签：ajax, asp.net-mvc, livesearch

我希望在我的 MVC 应用程序中实现与此站点类似的实时搜索，当您输入一个问题并出现与[http://www.krop.com/上的搜索相似或类似的结果时](http://www.krop.com/)

我有所有的搜索代码和结果更新。我只需要知道如何将 AJAX 添加到 MVC 框架（我知道这个站点是使用它构建的），以便在我输入时更新结果。

我让这一切都在正常的 ASP.NET Forms 应用程序中工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-01T08:49:03.757

你需要做的是附加到 Jquery onchage 事件处理程序，然后调用 jquery 的一些 ajax 方法（$.load、$.ajax 等...）和来自指定控制器的信息。asp.net mvc 控制器可以返回 json 结果，以便您以后可以在 javascript 代码中对其进行操作。

如果您有任何其他问题，请继续询问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T14:22:26.627

默认情况下，ASP.NET MVC 站点将提供 AJAX 和 JQuery。

Mike Bosch 的[博客](http://weblogs.asp.net/mikebosch/archive/2008/02/15/asp-net-mvc-submitting-ajax-form-with-jquery.aspx)可以为您提供一些建议

# mysql - 是否可以将多个行和表中的字符串连接到一个结果列中？

> ID：397708
> 
> 赞同：9
> 
> 时间：2008-12-29T13:24:25.213
> 
> 标签：mysql, database-design, select, join

我正在尝试编写一个 MySQL 查询，该查询从表“项目”中检索一条记录，该记录与表“标签”具有一对多关系。我的应用程序使用 4 个表来执行此操作：

```
Projects - the projects table
Entities - entity table; references several application resources
Tags - tags table
Tag_entity - links tags to entities 
```

是否可以以将表“标签”中的多个值连接到一个结果列中的方式编写查询？我宁愿这样做而不使用子查询。

表格说明：

```
 -------------
                                     | Tag_Entity  |
 -------------       ----------      | ----------- |      -------
| Projects    |     | Entities |     | - id        |     | Tags  |
| ----------- |     | -------- |     | - tag_id    |     | ----- |
| - id        | --> | - id     | --> | - entity_id | --> | id    |
| - entity_id |      ----------       -------------      | name  |
 -------------                                            ------- 
```

期望的结果：

```
Projects.id   Entities.id   Tags.name (concatenated)
1             5             'foo','bar','etc' 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-29T13:42:35.693

见[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

例子：

```
mysql> SELECT * FROM blah;
+----+-----+-----------+
| K  | grp | name      |
+----+-----+-----------+
|  1 |   1 | foo       |
|  2 |   1 | bar       |
|  3 |   2 | hydrogen  |
|  4 |   4 | dasher    |
|  5 |   2 | helium    |
|  6 |   2 | lithium   |
|  7 |   4 | dancer    |
|  8 |   3 | winken    |
|  9 |   4 | prancer   |
| 10 |   2 | beryllium |
| 11 |   1 | baz       |
| 12 |   3 | blinken   |
| 13 |   4 | vixen     |
| 14 |   1 | quux      |
| 15 |   4 | comet     |
| 16 |   2 | boron     |
| 17 |   4 | cupid     |
| 18 |   4 | donner    |
| 19 |   4 | blitzen   |
| 20 |   3 | nod       |
| 21 |   4 | rudolph   |
+----+-----+-----------+
21 rows in set (0.00 sec)

mysql> SELECT grp, GROUP_CONCAT(name ORDER BY K) FROM blah GROUP BY grp;
+-----+----------------------------------------------------------------+
| grp | GROUP_CONCAT(name ORDER BY K)                                  |
+-----+----------------------------------------------------------------+
|   1 | foo,bar,baz,quux                                               |
|   2 | hydrogen,helium,lithium,beryllium,boron                        |
|   3 | winken,blinken,nod                                             |
|   4 | dasher,dancer,prancer,vixen,comet,cupid,donner,blitzen,rudolph |
+-----+----------------------------------------------------------------+
4 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T13:29:37.997

我不知道它是否适用于 MySQL，但在 SQL Server 中，您可以使用一个技巧：

```
DECLARE @csv varchar(max)
SET @csv = ''
SELECT @csv = @csv + ',' + foo.SomeColumn
FROM   [FOO] foo
WHERE  foo.SomeId = @SomeId 
```

然后在主选择

```
SELECT ..., @csv AS [Tags]
FROM ... 
```

`SELECT @csv = @csv + ',' + foo.SomeColumn`line的结果是`@csv`源表中所有匹配记录的逗号分隔列表（在谓词之后）。

值得在 MySQL 中尝试吗？

# java - JavaCC 中的 NULL 令牌

> ID：397713
> 
> 赞同：3
> 
> 时间：2008-12-29T13:28:52.040
> 
> 标签：java, parsing, javacc

我的 JavaCC 解析器中的 token < NULL: "null" > 有奇怪的问题。表达方式如

```
String IsNullClause():
{
      String res = "";
}
{
     <IS> {res += " IS ";}
     [<NOT> {res += " NOT ";} ]
     <NULL> {res += " NULL ";}

{
    return res;
}
} 
```

解析器看不到 NULL 令牌并抛出“null”预期的异常。如果我将令牌定义更改为 < NULL: "null_val" > 或其他内容，它可以正常工作。这是我的错误还是 JavaCC 不接受“null”作为令牌值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T17:11:57.283

JavaCC 包中有示例 Java 语言语法，其标记定义如下：

`< NULL: "null" >`

所以我很确定 JavaCC 可以处理空令牌。

您确定在 NULL 匹配“null”之前没有声明任何令牌吗？令牌按照声明的顺序匹配。您可以尝试在一开始就声明 NULL。

# c# - C# 中的后台智能传输服务

> ID：397718
> 
> 赞同：6
> 
> 时间：2008-12-29T13:32:22.000
> 
> 标签：c#, upload, download, file-transfer, microsoft-bits

有人在 c# 中成功使用它，还是有更好的替代方法？还有任何我可以查看并获得良好感觉的好的工作项目吗？我遇到的大多数项目都是 C++ 并且正在寻找 C# 项目

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-29T14:01:36.997

是的，我们在一个工具中使用它，让客户将日志、转储等上传到我们的客户支持部门。您可以通过 PInvoke/COMInterop 直接使用它，但我建议看一下[SharpBITS.NET](http://www.codeplex.com/sharpbits)，它很好地包装了 BITS 接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-01-08T01:20:19.003

我是 Microsoft BITS 团队的 PM——我们有一个新的[docs.microsoft.com页面，其中讨论了使用 BITS 和 C#，以及](https://docs.microsoft.com/en-us/windows/desktop/Bits/bits-dot-net)[GitHub 上](https://github.com/microsoft/bits-manager)的全新 C#/WPF 示例。

# javascript - jQuery：调用表格单元格的子元素

> ID：397721
> 
> 赞同：1
> 
> 时间：2008-12-29T13:34:18.627
> 
> 标签：javascript, jquery, dhtml

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T13:51:35.363

为什么不将 JavaScript 代码从`href`属性中移出并移到 click 事件中呢？jQuery 是用来编写不显眼的 JavaScript 的。

编辑：

不，但实际上，考虑删除那些隐藏的链接以支持不显眼的 JavaScript。以下是重写了 Corey 示例的相关部分：

JS：

```
 $(document).ready(function() {
    $('table td').click(function(event) {
      alert($(this).html())
    })
  }) 
```

HTML：

```
<table border="1">
  <tr>
    <td>a1</td>
    <td>a2</td>
  </tr>
  <tr>
    <td>b1</td>
    <td>b2</td>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T14:47:26.000

```
<html>
<head></head>
<body>
<table border=1>
    <tr>
        <td>a1<a href=# onclick='alert("a1")' /></td>
        <td>a2<a href=# onclick='alert("a2")' /></td>
    </tr>
    <tr>
        <td>b1<a href=# onclick='alert("b1")' /></td>
        <td>b2<a href=# onclick='alert("b2")' /></td>
    </tr>
</table>
<script src="scripts/jquery-1.2.6.min.js" ></script>
<script>
    $(function(){
        $('table td').click(function(){ $(this).find('a').click()});
    })
</script>
</body>
</html> 
```

我在上面的那个剪辑上工作得很好。*但是，请查看您的 jQuery 选择器前面有一个 # ，除非您的表的id*为“表”，否则它将失败。

话虽如此，可能有比隐藏嵌入了javascript的标签更好的方法来做你想做的事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T15:00:12.900

如果您想避免添加 onclick，这将是一种解决方法：

```
$('#table td').click(function() { 
    $(this).find('a').each(function(){ window.location = this.href; });
}); 
```

# ruby - 如何以编程方式重命名 iTunes 库中的电影和电视节目文件，以实现 XBMC 兼容性？

> ID：397723
> 
> 赞同：1
> 
> 时间：2008-12-29T13:35:28.327
> 
> 标签：ruby, applescript, itunes, xbmc

我在 iTunes 中有一系列电影和电视节目，我想将它们重命名为与[XBMC 兼容的命名约定](http://xbmc.org/wiki/?title=TV_Shows)，而不会破坏 iTunes 中的链接。

所有必要的元数据（季号、节目名称、剧集号等）似乎都在 iTunes 管理的 XML 文件中，剧集名称是当前文件名。因此，以编程方式重命名文件似乎相当简单，但我如何同时保持 iTunes 资料库正常呢？重写 XML 文件以指向新的文件名就足够了吗？

如果我可以避免它（生命太短），我宁愿不进入applescript，但是如果这样做更容易，我可能会看它。否则，我理想情况下希望在 ruby​​ 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T13:57:12.417

不确定你是否在 Windows 机器上，但老实说，如果你能写一点 Javascript，[iTunes COM API](http://developer.apple.com/sdk/itunescomsdk.html)就很容易使用。

下面是它的外观示例。（这未经测试，因此仅用作参考。）

```
var    ITTrackKindFile  = 1;
var iTunesApp = WScript.CreateObject("iTunes.Application");
var deletedTracks = 0;
var mainLibrary = iTunesApp.LibraryPlaylist;
var tracks = mainLibrary.Tracks;
var numTracks = tracks.Count;
var i;
var    RenameTarget;

while (i > 0)
{
    var currTrack = tracks.Item(numTracks);

    // is this a file track?
    if (currTrack.Kind == ITTrackKindFile)
    {
            RenameTarget = "Stuff from other properties"
        currTrack.Name = RenameTarget; //
    }
    numTracks++;
} 
```

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T13:58:26.113

在 Windows 上，Apple[为 Windows SDK 提供了运行良好的 iTunes COM](http://developer.apple.com/sdk/)。它是使用 COM 接口创建的，因此它适用于几乎所有适用于 Windows 的语言。它提供了重命名曲目和播放列表的方法。我用它来用我的图书馆做各种各样的事情。

我不知道 MAC 上有什么可用的，但我相信 AppleScript 是访问可用内容的最佳本地方式。有一个名为[“EyeTunes”](http://code.google.com/p/eyetunes/)的项目提供了一个 Cocoa 框架。有一个专门介绍 Applescript 的网站（[“Doug's AppleScripts for iTunes”](http://dougscripts.com/itunes/itinfo/downloadfaq.php)）。这是一个展示如何[从 perl 访问 iTunes](http://kobesearch.cpan.org/htdocs/Mac-iTunes/Mac/iTunes/AppleScript.pm.html)的站点。

如果您想同时重命名文件和 iTunes 名称，那么最好更改曲目名称，从库中删除文件，重命名文件，然后重新添加曲目。您需要保留上次播放、播放次数等信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-24T20:31:27.020

晚了，但我在 OS X 上需要完全相同的 Plex。

我的解决方案是编写一个 Python 脚本，通过 AppleScript 桥向 iTunes 查询其电视节目，从每个轨道的位置属性获取文件路径，然后创建指向原始文件的符号链接，使用 iTunes 元数据为链接提供适合的名称Plex/XBMC 等

优点是您可以使用不同的命名方案轻松创建多组链接，例如*My Name Is Earl S01E10.m4v*或*My Name Is Earl 01x10 White Lie Christmas.m4v*

脚本的核心是（`track`appscript桥提供的参考在哪里）：

```
def trackInfo(track):
"""returns tuple (filename, filepath, show)

track is iTunes playlist track from appscript bridge,

filename is of format "Showname 01x02 Episode Name.avi" where 
01 is the season number, 02 the episode number and the extension
will match that of filepath.

filepath is the UNIX path to the original file.
"""
try:
    path = track.location().path
except CommandError:
    return None, None, None
ext = os.path.splitext(path)[1]
name = "%s %02dx%02d %s%s" % (track.show(), track.season_number(), 
                                track.episode_number(), track.name(), ext)
return name, path, track.show() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-05T22:33:37.717

我使用 identify2 for mac 来重命名我的节目 - 效果很好！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T22:55:06.673

[在http://www.epnamer.com/](http://www.epnamer.com/)上查看 EpNamer 。它需要 .NET，但正是您正在寻找的东西，而 XBMC 也正是我使用它的目的。

您也可以考虑使用 Media Companion，因为您最有可能使用 XBMC 的库功能，您可以在此处阅读：

[http://xbmc.org/forum/showthread.php?p=217769](http://xbmc.org/forum/showthread.php?p=217769)

它会为每个电影和电视节目制作 .nfo 和 .tbn 文件，您已经获得了 XBMC 将在上网获取信息之前抓取的文件。

享受！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T23:24:22.670

使用 iTunes xml 文件的另一种方法是使用[plist](http://rubyforge.org/projects/plist/)模块。

# cocoa - 将图像添加到 NSPersistentDocument

> ID：397731
> 
> 赞同：0
> 
> 时间：2008-12-29T13:42:17.317
> 
> 标签：cocoa, core-data

我有子类 NSPersistentDocument 类。我想在文档中添加图像。我有一个图像井。如何将其设置为 .jpg 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T16:10:12.760

加载 JPEG 文件并`NSImage`使用属性语法 ( ) 将结果设置为文档的属性`self.image = [[[NSImage alloc] initWithContentsOfFile:…] autorelease]`。同时，在您的 nib 中，将图像视图的`value`绑定绑定到文档的`image`属性。

# c# - 问题：使用 VS2005 在 C# 中进行全球化

> ID：397736
> 
> 赞同：1
> 
> 时间：2008-12-29T13:46:26.527
> 
> 标签：c#

我想全球化我的应用程序。我创建了一个小表单，询问用户他们的语言。我有很多问题：

问题1：

在 program.cs 中

```
new SplashScreen(_tempAL);
new LangForm(_lang);
Application.Run(new Form1(_tempAL, _lang)); 
```

我希望应用程序在用户单击 LangForm 中的 OK 之前不要调用 Form1 。有关 LangForm 的更多解释：

```
 public LangForm(char _langChar)
    {
        InitializeComponent();
        _ch = _langChar;
        this.TopMost = true;

        this.Show();

    }

    private void _btnOk_Click(object sender, EventArgs e)
    {
        string _langStr = _cbLang.SelectedText;
        switch (_langStr)
        {
            case "English":
                _ch = 'E';
                this.Hide();
                break;
            case "Arabic":
                _ch = 'A';
                this.Hide();
                break;
            case "Frensh":
                _ch ='F';
                this.Hide();
                break;
        }
        _pressedOk = true;
    }

    private void _btnCancel_Click(object sender, EventArgs e)
    {
        this.Close();
        Application.Exit();
    } 
```

现在，当我调试时，应用程序调用 LangForm，然后调用 Form1，因此显示了两个表单。我希望 Form1 等到用户在 LangForm 中单击 Ok。

问题2：

我应该什么时候检查语言？不允许签入“initializeComponent()”，所以我应该在这个函数之后检查，然后根据语言设置控件位置。

问题3：

在应用程序过程中，我会在每个“MessageBox.Show("");”之前显示一些消息 我应该检查语言，或者有另一种方法可以设置语言一次。

问题4：

我已经搜索了 MessageBox 的接口，因为实际上我想更改它的布局。如何找到 MessageBox 的模板？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T13:52:08.480

要阻止直到表单关闭，`.ShowDialog()`请使用`LangForm`. 然后，我将在此表单关闭和创建新表单*之间*`Thread.CurrentThread.CurrentCulture`设置区域性 ( and `Thread.CurrentThread.CurrentUICulture`) 。完成此操作后，来自 resx 的任何内容都应该正确加载。

 *要更改`MsgBox`（超出规范）的布局，您必须编写自己的（它不支持这一点）。

就像是：

```
[STAThread]
static void Main() {
    Application.EnableVisualStyles();

    // find the culture we want to use
    bool cont;
    string languageCode;
    using (LangForm lang = new LangForm()) {
        cont = lang.ShowDialog() == DialogResult.OK;
        languageCode = lang.LanguageCode; // "en-US", etc
    }
    if (!cont) return;

    // set the culture against the UI thread
    Thread.CurrentThread.CurrentCulture =
        Thread.CurrentThread.CurrentUICulture =
            CultureInfo.GetCultureInfo(languageCode);

    // show the main UI
    using (MainForm main = new MainForm()) {
        Application.Run(main);
    }
} 
```

请注意，使用官方文化代码将更容易使用诸如`CultureInfo`; 如果您想使用自己的候选清单，请使用枚举，并在某处编写方法：

```
public static string GetCultureCode(MyCulture culture) {
    switch(culture) {
        case MyCulture.French: return "fr-FR";
        case MyCulture.English: return "en-GB";
        //...
        default: throw new NotSupportedException("Unexpected culture: " + culture);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T14:09:47.713

将语言选择表单显示为对话框。使您的 Program.cs 文件如下所示：

```
[STAThread]
static void Main() {
  Application.EnableVisualStyles();
  Application.SetCompatibleTextRenderingDefault(false);
  if (DialogResult.OK == new LangForm().ShowDialog()) {
    Application.Run(new Form1());
  }
} 
```

将此行添加到您的 _btnOK 点击处理程序：

```
this.DialogResult = DialogResult.OK; 
```

# php - PHP 中的 32 到 64 位“陷阱”

> ID：397738
> 
> 赞同：5
> 
> 时间：2008-12-29T13:48:23.747
> 
> 标签：php, 32bit-64bit

上周末，我为我的网站更改了虚拟主机。我使用的主机服务器是 32 位操作系统，而我移动到的主机服务器是 64 位。出乎意料的是，我的一些 PHP 脚本开始给出不正确的结果。

在我的例子中，<< 和 >>（位移）操作是罪魁祸首。我最终不得不用 0xFFFFFFFF 掩盖结果，然后如果结果为负，则更改结果以使其像以前一样工作。

我应该在我的 PHP 脚本中寻找任何其他可能的问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T14:37:49.747

它是一种高级语言，因此任何与位无关的（按位运算符、位移位）都是相同的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-29T18:24:48.447

整数可能是 64 位而不是 32 位。在一些奇怪的[情况下](http://www.mysqlperformanceblog.com/2007/01/09/mysql-automatic-data-truncation-can-backfire/)，这可能会导致问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-23T23:41:04.810

位操作需要特别小心才能在系统/架构之间进行移植。

在 C 中，<< 和 >> 操作可以通过使用*无符号*变量来实现可移植性，这消除了负数的一/二补码规则。

作为一般规则，不要使用固定长度的掩码进行位操作（如 & 和 |）。这些是依赖于架构的。

> 例如。重置最后 4 位：掩码 0xF0 将适用于 8 位架构，但不适用于 16 位。结果会有所不同（16 位可能有其他未包含在掩码中的位设置）。
> 
> 要克服这个问题，请使用 ~ 运算符。掩码 ~0xF 等价于 0xF0，但适用于*任何*架构。除最后 4 位外的所有位都将被重置

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-12T13:53:47.493

strtotime 在 64 位上表现不同。来自 PHP.net：

笔记：

时间戳的有效范围通常是从 1901 年 12 月 13 日星期五 20:45:54 UTC 到 2038 年 1 月 19 日星期二 03:14:07 UTC。（这些日期对应于 32 位有符号整数的最小值和最大值。）此外，并非所有平台都支持负时间戳，因此您的日期范围可能限制为不早于 Unix 纪元。这意味着例如 1970 年 1 月 1 日之前的日期将不适用于 Windows、某些 Linux 发行版和一些其他操作系统。PHP 5.1.0 和更新的版本克服了这个限制。

对于 64 位版本的 PHP，时间戳的有效范围实际上是无限的，因为 64 位可以在任一方向上代表大约 2930 亿年。

We had code that was doing strtotime('0000-00-00') and expected the result to be false, when we moved to 64 bit we got back a negative integer.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-23T23:25:16.497

当您依赖 32 位二进制数据表示时，您会看到唯一的问题。主要是因为 PHP 使用有符号整数，您会在散列、密钥生成等方面看到问题......当使用 (int) 显式转换为 int 时，数字 > 2^32 将换行，因为它们不会在 64 位环境中换行当然，除非它们 > 2^64。

4 与 8 位示例：

十进制值问题：

```
 0010 >> 1 =      0001   [ 1 dec ]
0000 0010 >> 1 = 0000 0001   [ 1 dec ] 
```

这些都产生相同的结果（十进制），但是：

```
 0100 << 1 =      1000   [ -8 dec ]
0000 0100 << 1 = 0000 1000   [ 16 dec ] 
```

包装问题：

```
 1000 << 1 =      0000   [  0 dec ]
0000 1000 << 1 = 0001 0000   [ 32 dec ] 
```

所有整数/浮点运算都将被视为 64 位值，因此如果您的最终结果依赖于 32 位块，您将不得不对此进行补偿。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T07:11:28.150

提高到64位会影响浮点除法的结果；因此，如果您的代码执行了一些愚蠢的操作，例如将浮点除法的结果与硬编码常量进行比较，那么预计它会中断。

# sql-server - MSSqlSM 工作室反应真的很慢

> ID：397741
> 
> 赞同：2
> 
> 时间：2008-12-29T13:50:59.343
> 
> 标签：sql-server, ssms

我的 Microsoft SQL Server Management Studio 很慢。慢，我的意思是> 1分钟来渲染上下文菜单-慢。所有其他事情都很好。与数据库本身的连接并不慢（我的应用程序工作得很好，而且我猜上下文菜单不需要连接到数据库）..

有人知道我应该检查什么来解决这个问题吗？

**- 编辑 -**

*   cpu 3%左右
*   免费公羊的演出
*   仅在对象资源管理器中的表上单击鼠标右键，仅此而已
*   数据库是远程的
*   这是SSMS的完整版
*   没有系统记录错误
*   重装没有效果

**更新**

我安装了 Toad for SQL，一切都非常顺利。实际上，我发现它比 MSSql 对我来说更有效率。这不是我的问题的真正答案，但它肯定是一个解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-01T04:54:25.130

您连接到的所有 SQL Server 是否都会发生这种行为，或者只是少数几个？如果它只是某些特定的，它可能是一个非常慢的 SQL Server - 要获取任何上下文菜单或列表数据库，它必须对远程服务器执行一些查询以收集信息，如果它们响应速度慢，SSMS 将也。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:57:20.027

您是否安装了任何加载项/插件？这些可能是问题的根源。

# c# - 带有计时器的 .NET Windows 服务停止响应

> ID：397744
> 
> 赞同：18
> 
> 时间：2008-12-29T13:55:16.680
> 
> 标签：c#, windows-services, timer

我有一个用 C# 编写的 Windows 服务。它内部有一个计时器，它会定期触发一些功能。所以我的服务的骨架：

```
public partial class ArchiveService : ServiceBase
{
    Timer tickTack;
    int interval = 10;
    ...

    protected override void OnStart(string[] args)
    {
        tickTack = new Timer(1000 * interval);

        tickTack.Elapsed += new ElapsedEventHandler(tickTack_Elapsed);
        tickTack.Start();
    }

    protected override void OnStop()
    {            
        tickTack.Stop();
    }    

    private void tickTack_Elapsed(object sender, ElapsedEventArgs e)
    {
        ...
    }
} 
```

它工作一段时间（如 10-15 天）然后停止。我的意思是服务显示为正在运行，但它没有做任何事情。我做了一些记录，问题可能出在计时器上，因为在间隔之后它不会调用 tickTack_Elapsed 函数。

我正在考虑在没有计时器的情况下重写它，使用无限循环，它会在我设置的时间内停止处理。这也不是一个优雅的解决方案，我认为它可能会对内存产生一些副作用。

Timer 是从 System.Timers 命名空间中使用的，环境是 Windows 2003。我在不同服务器上的两个不同服务中使用了这种方法，但两者都产生了这种行为（这就是为什么我认为它以某种方式连接到我的代码或框架本身）。

有人经历过这种行为吗？有什么问题？

* * *

### 编辑：

我编辑了这两个服务。一个人到处都有很好的尝试捕获和更多的日志记录。第二个定期进行计时器娱乐。自他们以来，他们都没有停止过，所以如果这种情况再持续一周，我将结束这个问题。到目前为止，谢谢大家。

* * *

### 编辑：

我关闭了这个问题，因为什么都没发生。我的意思是我做了一些更改，但是这些更改与这件事并不真正相关，并且从那时起这两个服务都运行没有任何问题。请将其标记为“因不再相关而关闭”。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-29T14:39:01.023

定时器中未处理的异常被吞下，它们默默地杀死定时器

将计时器代码的主体包装在 try-catch 块中

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-29T14:03:02.000

我以前在计时器和循环服务中都看到过这一点。通常情况是，捕获到的异常会停止计时器或循环线程，但不会将其作为异常恢复的一部分重新启动。

对于您的其他观点...我认为计时器没有任何“优雅”之处。对我来说，在代码中看到循环操作比计时器方法更直接。但优雅是主观的。

内存问题？如果你写得好，就不会。如果您的 Thread.Sleep() 设置不正确，可能是处理器负担。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-29T18:30:03.880

[http://support.microsoft.com/kb/842793](http://support.microsoft.com/kb/842793)

这是一个在框架中多次出现的已知错误。

最著名的解决方法：不要使用计时器。我通过执行一个愚蠢的“while (true)”循环使这个错误变得无效。

您的里程可能会有所不同，因此请使用您的操作系统/框架位组合进行验证。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-29T14:07:21.460

有趣的问题。如果它真的只是时间相关（即不是例外），那么我想知道你是否可以简单地定期回收计时器 - 即

```
private void tickTack_Elapsed(object sender, ElapsedEventArgs e)
{
    CheckForRecycle();
    // ... actual code
}

private void CheckForRecycle()
{
    lock(someLock) {
        if(++tickCount > MAX_TICKS) {
            tickCount = 0;
            tickTack.Stop();
            // re-create timer
            tickTack = new Timer(...);
            tickTack.Elapsed += ...
            tickTack.Start();
        }
    }
} 
```

您可能可以将其中的大块与`OnStart`/ `OnStop`etc 合并以减少重复。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-07-07T08:42:41.733

就像许多受访者指出的那样，异常被定时器吞没了。在我的 Windows 服务中，我使用 System.Threading.Timer。它具有 Change(...) 方法，可让您启动/停止该计时器。可能出现异常的地方可能是重入问题 - 如果 tickTack_Elapsed 执行时间长于计时器周期。通常我这样写定时器循环：

```
 void TimeLoop(object arg)
    {
        stopTimer();

        //Do some stuff

        startTimer();
    } 
```

你也可以`lock(...)`用你的主循环来防止重入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T14:02:53.810

你检查过错误日志吗？也许你不知何故用完了计时器。也许您可以在初始化 ArchiveService 并跳过 OnStart 内容时只创建一个计时器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-29T14:05:06.177

我在几个项目中和你完全一样，但没有遇到问题。

您在 tickTac_Elapsed 中是否有可能导致此问题的代码？就像一个永远不会结束的循环或一些停止计时器的错误，使用线程并等待这些结束等等？

# c# - 我应该把我的第一个方法放在哪里

> ID：397753
> 
> 赞同：0
> 
> 时间：2008-12-29T14:01:59.897
> 
> 标签：c#, oop, methods

我需要添加一个方法来计算工人工资和他的上等工资的加权和。我想要这样的东西：

```
class CompanyFinanse
{
      public decimal WeightedSumOfWorkerSalaryAndSuperior(Worker WorkerA, Worker Superior)
      {
           return WorkerA.Salary + Superior.Salary * 2;
      }
} 
```

这是一个好的设计还是我应该把这个方法放在其他地方？我只是盯着设计项目并考虑一种好的、面向对象的方法来组织类中的方法。所以我想从 OOP 开始。需要最佳实践！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T14:13:45.707

我要么把它放在工人阶级里，要么在金融库里有一个静态函数。我不认为 Finance 对象真的有意义，我认为它更像是一组业务规则，而不是任何东西，所以它是静态的。

```
public class Worker {
     public Worker Superior {get;set;}
     public readonly decimal WeightedSalary {
         get {
              return (Superior.Salary * 2) + (this.Salary)
         }
     }
     public decimal Salary {get;set;}
} 
```

或者

```
public static class Finance {
     public static decimal WeightedSumOfWorkerSalaryAndSuperior(Worker WorkerA, Worker Superior) {
         return WorkerA.Salary + Superior.Salary * 2; }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-29T14:06:48.063

为了使您的设计是面向对象的，您应该从考虑整个应用程序的目的开始。如果您的应用程序中只有一种方法（加权和），那么就没有太多的设计可以继续了。

如果这是一个金融应用程序，也许你可以有一个 Salary 类，其中包含工人的薪水和一些实用函数。

对于您指出的方法，如果 Worker 类有对其上级的引用，您可以将此方法作为 Worker 类的一部分。

如果没有更多关于申请目的的信息，很难给出好的指导。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T15:21:48.207

因此，在不了解您的域的更多信息的情况下，可能无法为您提供有关“最佳实践”的完整答案，但我可以告诉您，尽早考虑实施细节可能会让您陷入灾难。

如果您像我一样，那么您会被告知良好的 OOD/OOP 非常详细，并且涉及[BDUF](http://en.wikipedia.org/wiki/BDUF)。直到在我职业生涯的后期，我才发现这就是许多项目在以后变得非常难以维护**的原因。**假设项目可能如何工作，而不是让设计从代码的实际使用方式中自然出现。

简单地说：你需要做[BDD](http://en.wikipedia.org/wiki/Behavior_driven_development) / [TDD](http://en.wikipedia.org/wiki/Test-driven_development)（行为/测试驱动开发）。

1.  从勾勒出粗略的领域模型开始，但要避免过多的细节。
2.  选择您想开始使用的功能区域。最好在模型的顶部，或者用户将与之交互的模型顶部。
3.  集体讨论该单元应具有的预期功能并列出清单。
4.  在该单元上启动 TDD 循环，然后在进行时积极重构。

你最终会得到的正是你所需要的，而不是你不需要的（大多数时候）。您获得了拥有完整测试覆盖率的额外好处，因此您可以在以后重构而不用担心破坏东西:)

我知道我在这里没有给你任何代码，但那是因为我给你的任何东西都可能是错误的，然后你就会被它困住。只有您知道代码实际上将如何被使用，并且您应该从以这种方式编写代码开始。TDD 专注于代码的外观，然后您可以随时填写实现细节。

对此的完整解释超出了本文的范围，但网上有无数可用资源以及许多书籍是开始 TDD 实践的极好资源。这两个家伙应该让你有一个好的开始。

*   [马丁·福勒](http://martinfowler.com/)
*   [肯特贝克](http://www.threeriversinstitute.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T17:12:18.873

跟进brien的回答，我建议查看[CRC卡](http://en.wikipedia.org/wiki/Class-Responsibility-Collaboration_card)（Class-Responsibility-Collaboration）的实践。有许多信息来源，包括：

*   [Cal Poly 的本教程](http://users.csc.calpoly.edu/~dbutler/tutorials/winter96/crc_b/)，
*   敏捷建模网站上的[这个方向，以及](http://www.agilemodeling.com/artifacts/crcModel.htm)
*   [*CRC Card Book*](https://rads.stackoverflow.com/amzn/click/com/0201895358)，它讨论了这种做法及其在多种语言中的使用。

了解哪个类应该“拥有”特定行为（和/或哪些类应该协作实现给定的用例）通常是一种自上而下的讨论，由系统为其用户所做的整体设计驱动.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-03T09:44:20.230

很容易找出您的代码是否需要改进。您的代码段中有**代码气味**。你应该解决这个问题。

最好为该方法提供非常明确的名称。但它太长了。听起来，如果您将该方法保留在此类中`Finanse`，则不可避免地必须在方法名称中使用所有这些词来了解该方法的用途。

它基本上意味着这个方法可能不属于这个类。

解决这种代码异味的一种方法是查看如果我们在其他类上有方法，是否可以获得更短的方法名称。我看到你有`Worker`和`Salary`课。

假设这些是剩下的唯一课程并且您不想添加更多课程，我会将其放在`Salary`. `Salary`知道如何在给定另一个工资（在这种情况下为高级工资）作为输入的情况下计算加权工资。现在，方法名称不需要超过两个单词。

@Shawn 的答案是解决此代码异味的一种变体。（我认为您可以将其称为“长方法名称”代码气味）

# c# - 使用 .NET 技术录制屏幕视频

> ID：397754
> 
> 赞同：22
> 
> 时间：2008-12-29T14:02:24.763
> 
> 标签：c#, .net, video, capture, video-capture

有没有办法使用 .NET 技术记录屏幕，无论是桌面还是窗口。

我的目标是免费的。我喜欢小型、低 cpu 使用率和简单的想法，但如果他们创造出更好的最终产品，我会考虑其他选择。

简而言之，我知道如何在 C# 中截取屏幕截图，但是如何将屏幕或屏幕区域录制为视频？

非常感谢您的想法和时间！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-29T14:25:51.753

不需要第三方 DLL。这个简单的方法将当前屏幕图像捕获到 .NET Bitmap 对象中。

```
 private Image CaptureScreen()
    {
        Rectangle screenSize = Screen.PrimaryScreen.Bounds;
        Bitmap target = new Bitmap(screenSize.Width,screenSize.Height);
        using(Graphics g = Graphics.FromImage(target))
        {
            g.CopyFromScreen(0,0,0,0,new Size(screenSize.Width,screenSize.Height));
        }
        return target;
    } 
```

我相信您可以弄清楚如何捕获屏幕的一小部分，如果需要的话:-)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T07:08:45.650

您可以使用 Windows 媒体编码器 SDK 构建 ac# 应用程序来录制屏幕。有内置选项可以记录整个桌面、特定窗口或屏幕的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T14:08:25.377

有一个 dll 可以做到这一点。不记得它的名字了，但是它被[Jing](http://www.jingproject.com/)用过。我的一个朋友使用该 dll 在短短几分钟内实现了一个屏幕录像机，仅用于测试。查看 Jing，您可能会找到他们使用的 dll。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-10T07:43:03.303

您可以使用 Media Encoder SDK，但它在 Windows 7 上不受支持。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2015-11-26T06:41:20.340

你可以试试这个开源实用程序：ScreenRecord ( [http://screenrecord.codeplex.com/](http://screenrecord.codeplex.com/) ) 它基于 AForge.NET

# c# - 如何在 C#/.NET 中从另一个位图中减去一个位图？

> ID：397759
> 
> 赞同：6
> 
> 时间：2008-12-29T14:03:43.217
> 
> 标签：c#, .net, image, subtraction

我有两个位图，由算法的不同变体产生。我想通过从另一个中减去一个来创建第三个位图以显示差异。

如何在 .NET 中做到这一点？我查看了 Graphics 类及其所有选项，包括 ImageAttributes 类，我预感它涉及颜色矩阵或重映射表功能。

有没有人有一些示例代码的链接，或者可以指出我正确的方向？谷歌搜索并没有透露太多信息，除非我的 google-fu 今天让我失望了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T14:11:30.160

真正的问题是，你想展示什么不同？如果您只需要对 RGB 颜色值进行操作，我认为最好的办法是扫描两个位图并使用 GetPixel 比较颜色值，然后使用 SetPixel 生成您的“差异”位图。也许您只是想减去这些值并将它们用作第三个位图的新颜色值。或者，也许您想计算出光度并使用它。更好的是，如果您有三个指标进行比较，请将每个指标分配给颜色的 RG 和 B 分量。我以前用这种方法进行分形着色。

还有其他方法，但是使用这种方法，您只能发挥自己的想象力。这可能不是最快的方法，但在这种情况下听起来并不需要性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T14:12:45.913

看看这个项目。它是安德鲁·基里洛夫制造的运动检测器。他实现了几个过滤器来获取两张图片之间的差异，并使用它来计算运动。它做得非常好，并且很容易在您自己的应用程序中修改和使用。

[http://www.codeproject.com/KB/audio-video/Motion_Detection.aspx](http://www.codeproject.com/KB/audio-video/Motion_Detection.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T15:22:42.247

这可以通过调用**BitBlt** API 函数来完成。这是一些示例代码：

[http://www.codeproject.com/KB/GDI-plus/Bitblt_wrapper_class.aspx](http://www.codeproject.com/KB/GDI-plus/Bitblt_wrapper_class.aspx)

该示例使用 SRCCOPY 光栅操作码；要获得两个位图之间的差异，您需要使用 SRCPAINT 或其他东西（GOOGLE 应该提供代码列表）。

GetPixel 和 SetPixel（在 Bitmap 类上）速度慢得令人难以置信。使用 LockBits 会快得多，但您仍然需要编写自己的代码。

更新：这是一个更好的链接：

[http://www.pinvoke.net/default.aspx/gdi32.BitBlt](http://www.pinvoke.net/default.aspx/gdi32.BitBlt)

并包括所有可能的三元光栅操作（SRCPAINT 或 SRCAND 可能是您正在寻找的。）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T14:14:24.240

首先，定义减法；-p 您希望答案是什么样的？

执行此操作的最佳性能方法可能是`LockBits`- 它应该比大量调用要快得多`GetPixel`，但您需要自己解码字节。如果它只是像 32bpp ARGB 之类的东西，这很容易，但对于一些更复杂的情况则很棘手。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T14:18:48.880

我在某处读到，[Adobe Pixel Bender](http://labs.adobe.com/technologies/pixelbender/)中使用的语言受到了微软曾经做过的事情的启发。不记得我在哪里读到的。我的想法是，也许微软的“东西”被包装成.Net 项目可以使用的东西。仅减去两个图像就过大了，但无论如何。

# c# - C#：Dictionary 的 [string] 索引器返回什么？

> ID：397760
> 
> 赞同：24
> 
> 时间：2008-12-29T14:03:59.970
> 
> 标签：c#, dictionary

当字典中不存在键时，`[string]`索引器返回什么？`Dictionary`我是 C# 新手，似乎找不到像 Javadocs 一样好的参考。

我得到`null`，还是我得到一个例外？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-29T14:10:50.190

如果您指的是 a 的索引器`Dictionary<string,SomeType>`，那么您应该会看到一个异常 ( `KeyNotFoundException`)。如果您不希望它出错：

```
SomeType value;
if(dict.TryGetValue(key, out value)) {
   // key existed; value is set
} else {
   // key not found; value is default(SomeType)
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-29T14:09:09.353

与以往一样，[文档](http://msdn.microsoft.com/en-us/library/9tee9ht2.aspx)是找出答案的方法。

在例外情况下：

```
KeyNotFoundException
检索到属性，但集合中不存在键

```

（顺便说一句，我假设你的意思是`Dictionary<TKey,TValue>`。）

请注意，这与[非通用 Hashtable 行为](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.item.aspx)不同。

要在不知道键是否存在时尝试获取键的值，请使用[TryGetValue](http://msdn.microsoft.com/en-us/library/bb347013.aspx)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-01T08:11:40.133

我想你可以试试

```
dict.ContainsKey(someKey) 
```

检查字典是否包含密钥。

谢谢

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-29T14:18:40.317

作为 using 的替代方法`TryGetValue`，您可以先检查密钥是否存在 using`dict.ContainsKey(key)`从而消除在确定您是否真的需要之前声明值的需要。

# common-lisp - 如何使用 lisp 格式函数用零填充参数？

> ID：397765
> 
> 赞同：6
> 
> 时间：2008-12-29T14:06:05.160
> 
> 标签：common-lisp

我正在玩 lisp 的格式功能，但我遇到了一个障碍，因为虽然我可以让它写出很好地对齐的数字列表，但我似乎无法让它为零填充它：

```
(defun inc (a) (+ 1 a))
(dotimes (i 10)
  (format t "~3@:D ~:*~R~%" (inc i))) 
```

这会产生以下输出：

```
+1: one
+2: two
+3: three
+4: four
+5: five
+6: six
+7: seven
+8: eight
+9: nine
+10: ten 
```

有谁知道如何让它被零填充？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-29T14:18:31.703

示例取自[关于 FORMAT 的 PCL 章节](http://www.gigamonkeys.com/book/a-few-format-recipes.html)：

```
(format nil "~12d" 1000000)    ==> "     1000000"
(format nil "~12,'0d" 1000000) ==> "000001000000" 
```

# orm - 带有 SQL 后端的 Lisp OODB - 或良好的 ORM

> ID：397785
> 
> 赞同：2
> 
> 时间：2008-12-29T14:14:50.387
> 
> 标签：orm, lisp

有没有在 SQL 数据库之上实现的好的 Lisp OODB，或者好的 Lisp ORM 解决方案？我想要 RDMS 的管理功能和对 IT 的熟悉度，但仍然获得 OO 的强大功能。有什么建议吗？最先进的技术，至少在非商业解决方案方面，在过去几年似乎没有太大进步。

我宁愿不必自己破解 CLSQL 来添加诸如事务支持、多重继承或延迟加载之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T15:24:36.127

Try [cl-perec](http://common-lisp.net/project/cl-perec/).

# javascript - 为什么 \w 只匹配 javascript 正则表达式中的英文单词？

> ID：397788
> 
> 赞同：10
> 
> 时间：2008-12-29T14:17:13.393
> 
> 标签：javascript, regex, hebrew

我正在尝试使用 javascript 代码在某些文本中查找 URL。问题是，我使用的正则表达式使用 \w 来匹配 URL 中的字母和数字，但它不匹配非英语字符（在我的情况下 - 希伯来字母）。

那么我可以用什么代替 \w 来匹配所有语言的所有字母？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-29T14:22:06.237

因为`\w`只匹配 ASCII 字符 48-57 ('0'-'9')、67-90 ('A'-'Z') 和 97-122 ('a'-'z')。希伯来语字符和其他特殊外语字符（例如，变音符号-o 或波浪号-n）不在该范围内。

与其匹配外语字符（它们有很多，在许多不同的 ASCII 范围内），不如寻找描述单词的字符 - 空格、引号和其他标点符号。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-30T13:33:53.790

定义通常称为 JavaScript 的编程语言的 ECMA 262 v3 标准规定`\w`应该等价于 [a-zA-Z0-9_] 并且`\d`应该等价于 [0-9]。`\s`另一方面，根据标准匹配 ASCII 和 Unicode 空白。

JavaScript 也不支持`\p`匹配 Unicode 事物的语法，因此没有很好的方法来做到这一点。您可以将所有希伯来语字符与：

```
[\u0590-\u05FF] 
```

这只是匹配希伯来语块中的任何代码点。

您可以匹配任何 ASCII 单词字符或任何希伯来字符：

```
[\w\u0590-\u05FF] 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-09-16T06:33:19.930

我认为您正在寻找这个正则表达式：

```
^[אבגדהוזחטיכלמנסעפצקרשתץףןםa-zA-z0-9\s\.\-_\\\/]+$ 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-16T09:26:50.053

我刚刚找到了尚未提及的[XRegExp ，我对它印象深刻。](http://xregexp.com/)它是一种替代的正则表达式实现，有一个[unicode 插件](http://xregexp.com/plugins/)，并在 MIT 许可下获得许可。

根据该网站，要匹配 unicode 字符，您将使用这样的代码：

```
var unicodeWord = XRegExp("^\\p{L}+$");

unicodeWord.test("Русский"); // true
unicodeWord.test("日本語"); // true
unicodeWord.test("العربية"); // true 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-26T16:02:40.617

试试这个 \p{L} unicode regex to Letters

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-29T14:22:33.210

看看[http://www.regular-expressions.info/refunicode.html](http://www.regular-expressions.info/refunicode.html)。

看起来没有 \w 等效于 unicode，但您可以匹配单个 unicode 字母，因此您可以创建它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-29T14:22:51.650

检查[this SO Question about JavaScript and Unicode](https://stackoverflow.com/questions/280712/javascript-unicode) out。看起来 Jan Goyvaerts 的回答为您提供了一些希望。

编辑：但是似乎所有浏览器都不支持 \p ...无论如何。该问题应包含有用的信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T14:50:20.360

请注意，W3C 指定 URI（作为 URL 的超集）仅允许使用 US-ASCII 字符。通常所有其他字符都应该用百分号表示：

> 在本地或区域环境中，随着技术的进步，用户可能会受益于能够使用更广泛的字符；本规范未定义此类使用。如果方案或引用 URI 的协议元素允许这种表示，则可以在 URI 中使用百分比编码的八位字节（第 2.1 节）来表示 US-ASCII 编码字符集范围之外的字符。这样的定义应该指定用于在对 URI 进行百分比编码之前将这些字符映射到八位字节的字符编码。// [URI：通用语法](http://labs.apache.org/webarch/uri/rfc/rfc3986.html#generic-syntax)

当您在浏览器中打开带有非 ASCII 字符的 URL 时，通常会发生这种情况，它们会被转换为 %AB 表示法，而后者又**是**US-ASCII。

如果可以影响材料的创建方式，最好的选择是在创建过程中将 URL 置于 urlencode() 类型函数中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-29T14:21:14.070

也许 \S （非空白）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-29T15:36:38.053

如果您是生成其中包含非英文字母的 URL 的人，您可能需要重新考虑。

如果我正确解释了 W3C，[则 URL 可能只包含 latin alphabet 中的单词字符](http://labs.apache.org/webarch/uri/rfc/rfc3986.html#transcription)。

# oracle - 如何检测 LAN 上的主机？

> ID：397789
> 
> 赞同：2
> 
> 时间：2008-12-29T14:17:49.007
> 
> 标签：oracle, lan, network-scan

为了帮助用户，我希望我的代码能够在 LAN 上发现 Oracle 数据库。我想通过首先检测所有主机，然后检查每个主机以查看它是否正在侦听 Oracle 的默认端口来做到这一点。

任何想法如何去做？最好用Java，但任何语言或算法都可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T15:31:43.383

你在使用 DHCP 吗？如果是这样，您的 DHCP 服务器会列出已发出的租约。这应该可以为您提供 LAN 上的主机列表。然后尝试在每台主机上打开到 Oracle 端口的连接，看看它是否接受连接。

用半打左右的代码来实现一个 shell 脚本应该很简单。对于这样的事情，Java 似乎有点矫枉过正。遍历lease文件，从每个lease中获取IP，telnet到Oracle端口；如果它连接，断开连接并将 IP 打印到标准输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T14:32:40.193

如果您想保持平台独立，并且除非您可以访问某种列出主机的数据库，否则获取列表的唯一方法是尝试本地网络中的每个 IP 地址 - 不妨尝试连接到他们每个人的Oracle端口。

这种方法有很多问题：

*   只会搜索本地网络，这可能只是局域网的一小部分（如果大公司有很多子网）
*   可能需要很长时间（你肯定想减少连接尝试的超时时间，但如果有人将他的 LAN 配置为 A 类网络，它仍然需要很长时间）
*   可以触发各种警报，例如桌面用户的个人防火墙和入侵检测系统 - 因为您所做的事情与试图利用 Oracle 服务器中的安全漏洞的人所做的事情完全相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T14:26:20.363

如果您正在寻找一个工具[Loo@Lan](http://www.lookatlan.com/)可以为您做这件事。不幸的是，没有可用的资源...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T14:59:47.550

正如 brazzy 指出的那样，扫描主机可能会导致问题，特别是如果您的扫描仪中有错误。

更好的方法可能是让数据库的所有者在某个地方注册它们，例如在本地 DNS 服务中（或者 Oracle 是否支持 zeroconf？），或者只是在某个 Intranet 网页或 wiki 上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T01:07:02.753

您最好将 SID 名称/地址注册到具有固定地址的某些服务器（可能使用简单的 Web 服务），然后从那里查询列表。另一种方法是通过扫描一个或多个子网的暴力破解（@brazzy 解释），但这并不是一件好事。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-30T14:32:49.537

所有这些聪明的答案都是许多公司不使用默认端口的原因。你知道，为每个数据库使用不同的端口是完全可能的。

# ajax - 如何从提供者 Web 部件调用 Ajax OnClick 到消费者 Web 部件

> ID：397815
> 
> 赞同：0
> 
> 时间：2008-12-29T14:26:43.887
> 
> 标签：ajax, connection, invoke

我试图通过在单独的 Web 部件上调用按钮 onclick 方法来管理 ajax 连接，以强制消费者进行部分回发。

Web 部分 A（提供者）调用 Web 部分 B（消费者）上的方法

Web 部分 A

类型 t = myButton.GetType(); 对象[] p = 新对象[1]; p[0] = EventArgs.Empty；MethodInfo m = t.GetMethod("OnClick", BindingFlags.NonPublic | BindingFlags.Instance); m.Invoke(myButton, p);

Web 部分 B

public void btnHidden_​​Click(object sender, EventArgs e) { Label1.Text = "隐藏按钮：" + DateTime.Now.ToString(); }

当我使用反射时，我得到了关于 HiddenButton 的正确信息。但是，我无法调用“OnClick”事件。btnHidden_​​Click 不执行。当我从 WebPart B 调用到 WebPart B 时，它工作正常，但不是从不同的 webpart。

似乎没有太多关于这种行为的信息。有什么建议么？

谢谢。

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T04:30:45.703

由于 Web 部件应该尽可能松耦合，因此我将使用 Web 部件连接基础结构和订阅者模式来处理这个问题。

连接部件之间的通信是通过接口完成的。该接口可以包括订阅和取消订阅方法。建立连接后，消费者部分可以订阅任何 UpdatePanel 控件，当提供者中的选定项目发生更改时，它需要更新。然后，当所选项目发生更改时，提供者部分可以遍历其订阅者并调用 UpdatePanel 上的 Update 方法以强制异步回发。

我自己没有尝试过，但我能看到的唯一缺点是您可能必须对 Update 的调用进行排队，因为任何异步回发的触发都会取消当前正在进行的任何其他异步回发。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T04:40:11.250

使用 JavaScript 解决这个问题非常容易。我不想说 Web 部件不好（尽管我从未使用过它们），但我会说，如果你能够将最微小的 JS 编程到 Web 部件中，那么代码就是：

```
document.getElementById('ElID').onclick(); 
```

祝你好运！

# perl - 为什么升级到 Intrepid Ibex Ubuntu 后找不到 Perl 模块？

> ID：397817
> 
> 赞同：3
> 
> 时间：2008-12-29T14:28:35.473
> 
> 标签：perl, ubuntu, module

我昨天升级到 Ubuntu Intrepid Ibex，突然我安装的一些 Perl 模块（在 Hardy Heron 上）都不见了！

我收到通常的“无法在@INC 中找到模块”错误。是否有任何 CPAN 存储库发生了变化或 Intrepid 发生了什么变化？谷歌根本没有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T17:09:02.843

标准解决方案是在升级 Perl**之前**使用 CPAN.pm 生成一个“自动捆绑” 。搜索[autobundle 会](https://stackoverflow.com/search?q=autobundle)产生一些现有 SO 问题的链接，这些问题讨论 Perl 模块管理，还有一些看起来应该提供更多信息。[CPAN.pm 手册](http://search.cpan.org/perldoc?CPAN)涉及自动捆绑，但没有包含太多细节。

由于您已经升级了 Perl，因此安装模块的一种解决方案是生成一个自动捆绑文件，并使用生成文件中的条目作为指南来编写包含模块条目的自定义自动捆绑文件（仅）。自动捆绑文件格式只是[POD](http://search.cpan.org/perldoc?perlpod)，所以这应该很容易做到。

将来您可能应该养成在升级 Perl 之前生成自动捆绑包的习惯。这不是一个完美的解决方案，autobundle 将包含核心模块的条目，在实际构建之前必须删除这些条目，但至少您将拥有已安装 Perl 模块的快照，以便您可以修复 Perl 安装升级后。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-29T17:23:08.743

您的 Perl 安装已从版本 5.8 更改为 5.10。`cpan`由于您需要的许多模块都位于特定于 perl 版本的目录中，因此您可能需要使用 CPAN 工具（例如命令）重新安装。

但是由于您使用的是 Ubuntu，请记住许多 CPAN 库也通过 Ubuntu 包管理器分发，并且 CPAN 包安装到与 Ubuntu 安装它们不同的位置（这对用户是透明的，因为两者都是在`@INC`路径中）。

我建议在 Ubuntu 软件包可用时使用它们，因为当中央软件包服务器上发布新软件包时，它们将由软件包管理器 (APT) 更新。名称格式略有不同。以下是从不同来源安装相同软件包的两种方法：

`$ cpan List::MoreUtils # installs latest from CPAN`

`$ sudo apt-get install liblist-moreutils-perl # installs latest from Ubuntu universe`

后者的优点是它会被更新`sudo apt-get update`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-29T15:03:44.140

Perl 在 Intrepid 上发生了变化。

在升级之前，您有 Perl 5.8，现在您有 5.10。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T15:17:38.217

可能使用 /usr/lib/perl5/5.10.* 而不是 /usr/lib/perl5/5.8.8，因为 Perl 版本已更改

# caching - 适用于 Windows 的 MS Velocity 与 Memcached？

> ID：397824
> 
> 赞同：33
> 
> 时间：2008-12-29T14:34:04.217
> 
> 标签：caching, memcached, appfabric, distributed-caching

我一直在关注微软最近将 Velocity 推广为一种分布式缓存解决方案，它将与 Memcached 之类的产品竞争。

[一段时间](https://stackoverflow.com/questions/8896/memcached-on-windows-x64)以来，我一直在寻找适用于 Windows 的64 位版本的 Memcached，但没有运气，而且由于我正在处理的 ASP.Net MVC 项目的所有内容都是 64 位的，因此使用除 64 位之外的任何东西都没有任何意义.

现在我们已经在 Beta 版中使用 ASP.NET MVC 对冲我们的赌注（希望很快会是 RTM），但是 StackOverflow 似乎并没有做得太糟糕，所以我对此的担忧有限。但是 Velocity 仍然是一个非常未知的数量，并且在很长一段时间内仍将是 Beta（或 CTP）——但它*确实有*64 位！

在这种情况下，有没有人有相关的经验或观点可以提供？我们是否应该为 Velocity 等待时间——它是否足以与 Memcached 这样的巨头竞争，还是我们应该花时间尝试让 64 位版本的 Memcached 运行？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-31T21:59:57.123

我们最近对 Velocity 和 Memcached 进行了相当多的比较。简而言之，我们发现 Velocity 比 Memcached 慢 3 到 5 倍，而且（更重要的是）它目前不支持多获取操作。所以目前，我建议使用 Memcached。另外，我们学到的另一个教训是分布式缓存中最慢的操作是序列化和反序列化（至少在 ASP.NET 中）。进程内 ASP.NET 缓存的速度要快几个数量级。因此，您必须更加谨慎地选择缓存策略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T19:24:04.350

如果您不介意为许可证付费，您可以[使用 Scale Out State Server，我在此处对类似问题的回答中谈到了这一点](https://stackoverflow.com/questions/488748/scaling-up-the-asp-net-session-state-server/488767#488767)。它们有 32 位和 64 位版本。

**编辑：**尽管产品的名称，它处理会话状态和分布式缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T14:39:45.253

如果我没记错的话，Memcached 有一些开源库，所以如果你想走 64 位路线，你可以不只是重新编译吗？

我在 Velocity 刚到货时对其进行了评估，但得出的结论是在那个阶段它有点不发达。能够在非 Windows 服务器上运行 memcached 也是一个好处。

# c# - 有人用 mantis connect 来提交带有附件的问题吗？

> ID：397836
> 
> 赞同：1
> 
> 时间：2008-12-29T14:47:03.597
> 
> 标签：c#, web-services, attachment, mantis

我在使用 mantis connect 向 mantis 添加附件时遇到问题。我可以将文件附加到问题中，但是当我下载例如图像时，当我尝试打开图像时它总是给我一个错误。

我有很多方法可以将文件读取到字节数组中，但总是没有成功。

有没有人使用 mantisconnect 提交附件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:30:01.913

也许您遇到了在 1.1.7 中修复的错误：[mc_issue_attachment_add 损坏附件](http://www.mantisbt.org/bugs/view.php?id=10235)

# visual-studio - 总和 IIF 表达式

> ID：397837
> 
> 赞同：0
> 
> 时间：2008-12-29T14:47:04.470
> 
> 标签：visual-studio, reporting, aggregate, iif

我试图在 Visual Studio 中对表达式求和，但一直收到 #error 但不知道为什么我第一次尝试对表达式求和，以前只在一个字段上做过。有什么建议么！！！

```
 =IIf(Fields!STATUS.value = "Completed" AND Fields!DONOTINVOICE.value = True, Fields!ORDERCOST.Value, "") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T15:06:59.673

The value of the IIf() will evaluate to a string ("") when your condition is false. You can't sum a string. Try using 0 instead.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T15:13:09.723

Do you mean like this, just tried that and dosent sum anything just get 0 :(

=Sum(IIf(Fields!STATUS.value = "Completed" AND Fields!DONOTINVOICE.value = 1, Fields!ORDERCOST.Value, 0))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-14T07:17:54.703

```
=Sum(IIf(Fields!STATUS.value = "Completed" AND Fields!DONOTINVOICE.value = 1.0, Fields!ORDERCOST.Value, 0.0)) 
```

您必须在值的末尾使用“.0”：这确保您的 if 表达式的返回值不是字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T09:21:47.403

Ok couldnt figure out the sum on an expression so ive just used a case statement in a new dataset to build the sum feature. Example below, this is in an inner query and i have done a sum in the main bit. Just incase anyone else gets this issue this is how i resolved it.

CASE WHEN TBL_REPAIR_ORDER.STATUS = 'Completed' AND TBL_REPAIR_ORDER.DONOTINVOICE = 1 THEN TBL_REPAIR_ORDER.ORDERCOST ELSE 0 END AS Completed

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-16T16:59:30.660

对于 Visual Studio，将 包装`IIf`在`Cdbl`：

```
=SUM(CDbl(IIf(Fields!STATUS.value = "Completed" AND Fields!DONOTINVOICE.value = True, Fields!ORDERCOST.Value, 0))) 
```

# visual-studio - Visual Studio 中是否存在用于“国际设置”的 API？

> ID：397839
> 
> 赞同：0
> 
> 时间：2008-12-29T14:48:37.040
> 
> 标签：visual-studio, vsx, extensibility

我正在研究 Visual Studio 可扩展性，我需要从代码中设置“shell”语言。换句话说，我正在寻找一个 API 来做同样的事情，你可以使用*工具 -> 选项... -> 环境 -> 国际设置*属性页面“手动”做。
到目前为止，我没有找到任何参考：欢迎提示和建议。;-)
提前致谢。

编辑：为了澄清一点问题，我需要设置 Visual Studio 本身的当前语言（实际上是独立的 Visual Studio Shell）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T16:07:04.887

这是你要找的吗？

[http://support.microsoft.com/kb/914356](http://support.microsoft.com/kb/914356)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T16:17:57.780

是的，在 win32 api 新闻组上提问（这是一个常见问题解答）

新闻：//comp.os.ms-windows.programmer.win32

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T20:34:59.837

我在这里发布我们（我和我的同事）搜索的当前结果。
我们在[http://msdn.microsoft.com/en-us/library/ms165643.aspx](http://msdn.microsoft.com/en-us/library/ms165643.aspx)找到了一些东西。
特别是，您*可以*使用
`DTE.Properties("Environment", "International")`

# iphone - iPhone中是否有任何系统级后台队列进程？

> ID：397846
> 
> 赞同：4
> 
> 时间：2008-12-29T14:55:48.260
> 
> 标签：iphone, cocoa-touch, background-process

我需要保存一个大文件，有时需要很长时间才能完成，用户可能只是关闭应用程序。我想知道 iPhone SDK 是否可以接管未完成的大任务。

看来 iPhone 自己的邮件系统可以做后台发送。我准备了一封电子邮件，点击发送，然后立即关闭邮件应用程序。在主页，几秒钟后，我听到了声音，电子邮件已送达。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T14:57:56.023

你运气不好。只允许苹果自己的应用程序在后台运行。但是我认为当用户关闭应用程序时，您的应用程序需要一些时间来完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T15:09:33.753

正如 PEZ 所说，您不能在后台运行该应用程序。但是，您可以分离一个线程来执行任务，然后至少用户可以继续在您的应用程序中执行其他操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T02:23:47.747

如果我没记错的话，你的应用程序在用户按下主页按钮和 iPhone 操作系统之间有 5 秒的时间，如果你没有完成的话。

# c# - 制作winform切换标签

> ID：397851
> 
> 赞同：5
> 
> 时间：2008-12-29T14:58:23.853
> 
> 标签：c#, winforms, visual-studio-2008, tabs

我正在使用 Visual Studio 2008 在 C# 中制作一个 winform。

目前，我有一个 tabcontrol，包含 2 个选项卡。在第一个中，有一个按钮。当我单击它时，我必须被带到第二个选项卡。

问题是，我不知道怎么做。我尝试过调试，查看各种属性并弄乱它们，但没有发现任何帮助。

这里有人知道如何解决这个问题吗？

额外信息：我的变量名为 tabControl1、textTab 和 logTab。

我在 textTab 中，单击那里的按钮，我想被带到 logTab。基本上就是这样。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-29T15:02:19.777

你试过这个吗？

```
tabControl1.SelectedTab = logTab; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-29T15:02:54.627

您可以设置选项卡控件的 SelectedIndex 属性或 SelectedTab 属性来切换选项卡。

# java - Java 验证框架

> ID：397852
> 
> 赞同：10
> 
> 时间：2008-12-29T14:59:27.330
> 
> 标签：java, validation, frameworks

我曾经遇到过一个 Java 验证框架，您在其中编写了一个方法来保护数据类型的完整性，并且对该数据类型的任何 CRUD 操作都会自动调用此方法。

有谁知道这个框架是什么？我只是想避免对附加到数据类型的每个 CRUD 方法进行重复验证。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-07-21T22:01:30.557

这是 Java 验证库/框架的巨大列表 - [http://java-source.net/open-source/validation](http://java-source.net/open-source/validation)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-29T17:31:59.863

Apache Commons 有一个[验证](http://commons.apache.org/validator/)框架。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-21T22:06:12.943

您是否使用 Hibernate 进行持久化？如果你是，有[Hibernate Validator](http://www.hibernate.org/subprojects/validator.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-29T17:33:12.437

[Spring](http://www.springsource.com/download/community?project=Spring%20Framework)有一个非常好的验证和绑定 API。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-28T19:21:48.393

根据 adref 的回答，Hibernate Validator 是 JSR-303 的实现。如果您有兴趣，这里有一篇有用的文章可以帮助您入门：

[http://java.dzone.com/articles/bean-validation-and-jsr-303](http://java.dzone.com/articles/bean-validation-and-jsr-303)

# asp.net - 在asp.net页面和弹出页面之间发送数据？

> ID：397864
> 
> 赞同：2
> 
> 时间：2008-12-29T15:06:16.460
> 
> 标签：asp.net, .net-2.0, asp.net-2.0

asp.net 页面和弹出页面之间有哪些不同的通信方式？查询字符串等。哪个最安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T15:09:37.013

如果您正在谈论一个实际的弹出页面，您正在使用来自 javascript 的 window.open。您将查询字符串和 Javascript 作为在它们之间传递信息的唯一真正可用选项。

至于这个的“安全”。用户将能够通过查询字符串查看任何内容，JavaScript 可以移动值，但它们将存在于其他页面上。但是你可以传递一些像 excrypted 值这样的东西来使事情更安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T15:34:46.480

您说的是弹出窗口和 ASP.NET 主页面之间的“通信”。首先，我假设弹出窗口也是一个 ASP.NET 页面，因此从主页到弹出窗口的通信与从一系列页面中的一个页面到下一个页面的通信没有什么不同。也就是说，您可以在会话中存储然后使用数据（如果加载主页时数据可用），通过查询字符串等。除非数据是敏感的，否则到目前为止最简单的方法是在其中包含一个变量对由适当参数替换的弹出窗口的调用。这是一个示例图片链接：

```
<img style='cursor:hand;' alt="Open Note" onclick="javascript:window.open('NoteEdit.aspx?T=3&UID=<%#NoteUID%>', 'Note', 'HEIGHT=400,WIDTH=420');" src="images/Note.gif" /> 
```

注意“NoteUID”替换参数。

更有趣的问题是如何将信息传递回弹出的窗口。为此，请从以下 javascript 开始：

```
<script type="text/javascript">
    function OpenHRAResults()
    {
        opener.location.href="<%#DestName%>";
        window.close();
    }
</script> 
```

这是从我重新打开特定页面的代码中获取的，但是您可以猜到，您可以使用“打开器”窗口（弹出窗口的窗口）执行各种操作。

希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T15:10:18.947

几种方法

*   查询字符串（window.open('/users/123'..)
*   Javascript (window.opener)
*   HTTP POST（通过javascript打开一个弹出窗口，将表单目标设置为它的名称作为目标并发布）
*   会话或其他服务器端方法

在回答安全考虑时，我会说查询字符串与服务器端安全性相结合是要走的路。打开通过查询字符串传递信息的弹出窗口，然后验证登录用户是否有权访问该用户。一些特定的要求会要求对查询字符串数据进行加密。

对于删除操作，我可能会使用回发来避免“我的索引蜘蛛删除所有用户”之类的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T16:37:17.133

我们尽量避免使用查询字符串，因为有时它们太方便了。在这些情况下，我们总是加密查询字符串。有几种方法可以做到这一点 - 一种方法的示例：

[http://www.codeproject.com/kb/web-security/querystringencryptionnet.aspx](http://www.codeproject.com/kb/web-security/querystringencryptionnet.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T16:44:16.587

您不需要将真实数据发送到弹出窗口。只需在开启页面上创建一个 GUID。在 asp.net 中创建一个类，它代表您需要在弹出页面和开启页面之间发送的所有数据。例如 popupdata 将序列化的类存储在 Session 中，GUID 为名称 Session[Guid] = class object Session[Guid] = popupdata;

使用 fi ~/popupwindow.aspx?PageID=Guid 打开弹出窗口再次调用 Session[Guid] 检索会话对象（Guid 来自 PageID 查询字符串。

所以在弹出页面调用popupdata data = (popupdata)Session[Guid];

然后对数据做任何你喜欢的事情。

如果弹出窗口上的数据发生更改，您可以再次将其存储在 Session 变量中并将其发送回开启者...

非常安全，因为没有数据发送到客户端。

# java - 从 C 到 Java 的随机生成器端口？

> ID：397867
> 
> 赞同：19
> 
> 时间：2008-12-29T15:08:42.757
> 
> 标签：java, c, random, porting

George Marsaglia 编写了一个出色的随机数生成器，它非常快速、简单，并且比 Mersenne Twister 的周期要长得多。这是带有描述的代码：

[好的 C 随机数生成器](http://school.anhb.uwa.edu.au/personalpages/kwessen/shared/Marsaglia03.html)

我想将 CMWC4096 代码移植到 Java，但它使用了几种无符号数据类型，所以我不确定如何正确执行此操作。这是完整的 C 代码：

```
/* choose random initial c<809430660 and */
/* 4096 random 32-bit integers for Q[]   */
static unsigned long Q[4096],c=362436;

unsigned long CMWC4096(void) {
    unsigned long long t, a=18782LL;
    static unsigned long i=4095;
    unsigned long x,r=0xfffffffe;
    i = (i+1) & 4095;
    t = a*Q[i] + c;
    c = (t>>32);
    x = t + c;
    if (x < c) {
        x++;
        c++;
    }
    return (Q[i] = r - x);
} 
```

任何人都可以将它移植到Java吗？当您只有可用的签名号码时，这是如何工作的？

**编辑：**感谢大家的快速回答！对于前 1 亿个数字，此 java 代码似乎产生与 C 代码相同的结果。它比 Java 的 java.util.Random 快 3 倍。

```
public class ComplimentaryMultiplyWithCarryRandom {

    /**
     * Choose 4096 random 32-bit integers
     */
    private long[] Q;

    /**
     * choose random initial c<809430660
     */
    private long c = 362436;

    private int i;

    public ComplimentaryMultiplyWithCarryRandom() {
        Random r = new Random(1);
        Q = new long[4096];

        // TODO initialize with real random 32bit values
        for (int i = 0; i < 4096; ++i) {
            long v = r.nextInt();
            v -= Integer.MIN_VALUE;
            Q[i] = v;
        }
        i = 4095;
    }

    int next() {
        i = (i + 1) & 4095;
        long t = 18782 * Q[i] + c;
        c = t >>> 32;
        long x = (t + c) & 0xffffffffL;
        if (x < c) {
            ++x;
            ++c;
        }

        long v = 0xfffffffeL - x;
        Q[i] = v;
        return (int) v;
    }
} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-29T16:05:53.483

大多数时候不需要使用更大的数字类型来模拟 Java 中的无符号类型。

对于加法、减法、乘法、左移、逻辑运算、相等和强制转换为较小的数字类型，无论操作数是有符号还是无符号，结果都是相同的，被视为位模式。

为了转移到正确的使用 >> 有符号， >>> 无符号。

对于将签名转换为更大的类型，只需执行此操作。

用于从较小类型到长期使用的无符号转换，并且对于较小类型使用 long 类型的掩码。例如，从短到长：s & 0xffffL。

对于从较小类型到 int 的无符号转换，使用 & 带有 int 类型的掩码。例如，字节到 int：b & 0xff。

否则，请在 int 案例中使用并在顶部应用强制转换。例如，字节到短：（短）（b & 0xff）。

对于比较运算符 < 等和除法，最简单的方法是转换为更大的类型并在那里进行操作。但也存在其他选项，例如在添加适当的偏移量后进行比较。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-29T15:48:54.067

> 任何人都可以将它移植到Java吗？当您只有可用的签名号码时，这是如何工作的？

无压力！`a=18782`所以最大`t`的可能不够大，不会导致有符号和无符号的问题。您必须将使用 Q 的结果“升级”为等于 32 位无符号数的值，然后才能在任何地方使用它。例如，如果 Q 是一个`int`（32 位有符号），那么您必须在`t=a*Q[i]+c`语句中使用它之前执行此操作，例如

```
t=a*(((long)Q[i])&0xffffffffL)+c 
```

其中这个 (((long)Q[i])&0xffffffffL) 业务将 Q[i] 提升为 64 位 # 并确保其高 32 位为 0。（编辑：注意：你需要 0xffffffffL。如果你使用 0xffffffff，Java 会做错事，它似乎会“优化”自己以适应错误的答案，如果 Q[i] 的高位为 1，你会得到一个负数。 )

您应该能够通过在 C++ 和 Java 中运行算法来比较输出来验证这一点。

编辑：这是一个镜头。我尝试在 C++ 和 Java 中运行它 N=100000; 他们都匹配。抱歉，如果我使用了糟糕的 Java 习惯用法，我对 Java 还是很陌生。

C++：

```
// marsaglia2003.cpp 

#include <stdio.h>
#include <stdlib.h> // for atoi

class m2003
{
    enum {c0=362436, sz=4096, mask=4095};
    unsigned long Q[sz];
    unsigned long c;
    short i;

public:
    m2003()
    {
        // a real program would seed this with a good random seed
        // i'm just putting in something that makes the output interesting
        for (int j = 0; j < sz; ++j)
            Q[j] = j + (j << 16);
        i = 4095;
        c = c0;
    }

    unsigned long next()
    {
        unsigned long long t, a=18782LL;
        unsigned long x;
        unsigned long r=0xfffffffe;
        i = (i+1)&mask;
        t=a*Q[i]+c;
        c=(unsigned long)(t>>32);
        x=(unsigned long)t + c;
        if (x<c)
        {
            x++;
            c++;
        }
        return (Q[i]=r-x);
    }
};

int main(int argc, char *argv[])
{
    m2003 generator;
    int n = 100;
    if (argc > 1)
        n = atoi(argv[1]);

    for (int i = 0; i < n; ++i)
    {
        printf("%08x\n", generator.next());
    }
    return 0;
} 
```

java：（比编译的 C++ 慢，但匹配 N=100000）

```
// Marsaglia2003.java

import java.util.*;

class Marsaglia2003
{
    final static private int sz=4096;
    final static private int mask=4095;
    final private int[] Q = new int[sz];
    private int c=362436;
    private int i=sz-1;

    public Marsaglia2003()
    {
        // a real program would seed this with a good random seed
        // i'm just putting in something that makes the output interesting
        for (int j = 0; j < sz; ++j)
            Q[j] = j + (j << 16);
    }

  public int next() 
    // note: returns a SIGNED 32-bit number.
    // if you want to use as unsigned, cast to a (long), 
    // then AND it with 0xffffffffL
    {
        long t, a=18782;
        int x;
        int r=0xfffffffe;
        i = (i+1)&mask;
        long Qi = ((long)Q[i]) & 0xffffffffL; // treat as unsigned 32-bit
        t=a*Qi+c;
        c=(int)(t>>32); 
           // because "a" is relatively small this result is also small

        x=((int)t) + c;
        if (x<c && x>=0) // tweak to treat x as unsigned
        {
            x++;
            c++;
        }
        return (Q[i]=r-x);
    }

    public static void main(String args[])
    {
        Marsaglia2003 m2003 = new Marsaglia2003();

        int n = 100;
        if (args.length > 0)
            n = Integer.parseInt(args[0]);
        for (int i = 0; i < n; ++i)
        {
            System.out.printf("%08x\n", m2003.next());
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-29T15:42:04.360

如果您在 Java 中实现 RNG，最好[继承 java.util.Random](http://java.sun.com/javase/6/docs/api/java/util/Random.html)类并覆盖受保护的[next(int)](http://java.sun.com/javase/6/docs/api/java/util/Random.html#next(int))方法（然后您的 RNG 是 java.util.Random 的直接替代品）。next(int) 方法关注随机生成的位，而不是这些位可能代表的值。java.util.Random 的其他（公共）方法使用这些位来构造不同类型的随机值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-29T15:16:59.387

为了解决 Java 缺乏无符号类型的问题，您通常将数字存储在更大的变量类型中（因此shorts 升级为int，int 升级为long）。由于您在这里使用长变量，因此您将不得不升级到 BigInteger，这可能会破坏您从算法中获得的任何速度增益。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T15:16:55.987

只要值不会溢出，您就可以使用带符号的数字……例如，java 中的 long 是一个 64 位有符号整数。但是，此算法的意图似乎是使用 64 位无符号值，如果是这样，我认为您对基本类型会不走运。

您可以使用 java 类库 ( [BigInteger](http://java.sun.com/j2se/1.4.2/docs/api/java/math/BigInteger.html) ) 中提供的多精度整数。或者，您可以将自己的 64 位无符号类型实现为包含两个 java long 的 Object，以表示最不重要和最重要的单词（但您必须自己在类中实现基本算术运算）。

# c# - 调用外部 mvc 控制器

> ID：397877
> 
> 赞同：2
> 
> 时间：2008-12-29T15:12:10.690
> 
> 标签：c#, asp.net-mvc

我想知道它是否可能以及如何执行以下操作，我有一个基本的 MVC 应用程序（ASP.Net），我已经对其进行了修改以供我使用。现在应用程序已经很好地处理了身份验证，但我需要在另一个应用程序中使用此身份验证。

在不创建 web 服务的情况下，我是否可以调用应用程序 authcontroller ，如果是这样，如何

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T15:22:46.177

您不能直接在另一个应用程序中调用控制器，因为它位于单独的 AppDomain 中。如果您只想重用现有代码，您可以将其重构为一个单独的程序集（库项目），将该程序集包含在您的新应用程序中，然后从您的登录控制器中引用它。如果您尝试进行单点登录，那么您可能需要查看现有的 SSO 解决方案，例如[JA-SIG CAS 2.0](http://www.ja-sig.org/products/cas/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T15:29:09.673

身份验证是一个横切关注点，不应嵌入到单个用例/控制器中。AOP 爱好者会说它应该被封装在一个方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T15:43:17.960

哇，伙计们慢下来，我还在开始 MVC 及其所有相关细节，单点登录看起来很有希望，我不想走那条路甚至重构代码并将其包含在第二个项目中的原因是因为它的方式太简单了一个专案。

# sql-server - SQL Server 身份验证还是集成安全性？

> ID：397884
> 
> 赞同：2
> 
> 时间：2008-12-29T15:16:51.463
> 
> 标签：sql-server, integrated-security

我们有一些企业 Intranet 用户使用 WinForms 应用程序在带有 SQL Server 的系统上工作。设置了集成安全性，允许所有用户更新和删除权限，其中应用程序安全性限制了表更新的方式和位置。

但是，一些用户是拥有 SQL 查询工具的高级用户，可以直接访问数据库以构建报告。但是，通过集成安全性，它们在不应具有的表上具有默认更新权限，因为应用程序将规则应用于更新。

这是一个更适合为应用程序提供中央 SQL 身份验证登录的示例，而用户获得集成安全性的只读权限？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T15:33:28.590

正如 Jon 提到的，存储过程将为您提供对直接表修改的保护。还有其他选择。您可以使用 SQL Server 的“应用程序角色”（通过 sp_setapprole proc）。这使您可以继续为每个人使用单独的 ID，但仅在应用程序连接时（通过前端）提升用户的权限。

使用共享 ID 的一个主要缺点是您无法跟踪谁在向服务器提交 SQL，但如果它们都是内部的，您可以获取机器名称。

不过，还有其他事情值得关注。听起来好像您的用户可以连接到数据库并随意运行查询。由于直接连接的 SQL 会话中的用户行为，您将面临应用程序停机的重大风险。如果您可以成功，您可能希望尝试创建一个报告数据库，该数据库在您的业务可以容忍的时间间隔（即每天）进行更新。高温高压

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-29T15:23:42.180

我从您提出问题的方式推测您的应用程序直接执行 sql 语句。如果您可以重构它以使其执行存储过程，您可以授予该过程的 exec 权限并拒绝直接更新表。不过，这可能是不可能的，具体取决于您的应用程序的功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-29T15:27:46.620

sql 身份验证是一种选择。存储过程是另一个。但是，构建更精细的角色以仅将适当的权限分配给适当的用户类型是您真正应该关注的地方。

*此外*，我真的会完全避免让这些用户直接访问数据库。撇开安全原因不谈，对于不精通 SQL 的用户来说，意外执行一个查询会占用您的数据库服务器并创建有效的拒绝服务并不需要太多。即使是专业人士有时也会不小心做到这一点。

相反，让他们访问报告服务或分析服务类型的解决方案，或使用复制让他们访问数据的克隆。这样，您的生产系统就会受到保护。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T15:24:54.270

我个人会通过存储过程进行所有应用程序数据访问。我会将集成安全设置为仅允许用户运行 SP 而不能直接操作数据。

可以向数据库管理员授予高级访问权限，以便在需要时直接操作数据。

基于组的权限将为您提供更大的访问权限灵活性，并在使用集成安全性控制这些权限时减少管理负担。

# hardware-infrastructure - hardware infrastructure for public web application

> ID：397894
> 
> 赞同：1
> 
> 时间：2008-12-29T15:21:19.207
> 
> 标签：hardware-infrastructure

I'd like to start a free budget/personal finance site and will need plenty of horsepower and storage. I'm definitely a nubee, so how does one get started in terms of hardware infrastructure? Do I need to get a dedicated IP from my ISP and obtain my own servers? Do I go with amazon or Sql Server Data Services/Azure or something like that? Is the latter services free or a discount offering available to non-profit/free services such as the budget/personal finance site I'm looking to start?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T15:32:31.523

If you don't mind writing your web application in python, then I's suggest using [Google App Engine](http://code.google.com/appengine/). See: [What Is Google App Engine?](http://code.google.com/appengine/docs/whatisgoogleappengine.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T15:49:42.660

当我对网站有新想法时，我喜欢做的是找到一个便宜的托管解决方案（每月 10 美元）。这让我可以测试这个想法，看看这个网站是否会成功。如果失败，我并没有浪费太多钱，如果成功，我可以升级到更好的托管（专用服务器）。

有许多可用的托管选项，其中一些具有出色的工具，例如在线 SQL Server 管理工作室。如果您准备处理防火墙问题、备份、存储等，您的另一个选择是自己托管。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T17:42:09.233

There's really two ways to answer this question, what differentiates them is budget.

One is to properly design this solution, prototype it, benchmark the prototype, extrapolate anticipated user load, add overhead and scale accordingly. This takes time, costs but gives you a supportable solution that serves your customers well.

The other is to just give something, anything a go and fix the problems as they come along. This is quicker and cheaper but might be a headache for a while and might p*** off your customers.

Basically it comes down to budget.

Best of luck.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T15:37:22.717

Whether it is feasible to DIY varies a lot by country...if you have a decent broadband connection with a fixed IP this can be the cheapest route to play around with first, especially if you need an awful lot of storage.

Note however that many fast broadband connections are only fast for downloads - when you're running a server, the speed your users will see is the upload speed, which is usually a lot less. Also, you'll need to do your own admin and backup etc.

Apart from this most hosting options have a price tag on top, varying from virtual hosts (sharing a real machine), to colocation (your machine in somebody's data center), to cloud services like amazon et al (which have a good scaling ability)- and you will need to shop around for the software stack and hardware features you really need.

# c++ - 如何在 C++ 中创建列表？

> ID：397895
> 
> 赞同：29
> 
> 时间：2008-12-29T15:21:43.417
> 
> 标签：c++, list, stl, linked-list

如何在 C++ 中创建列表？我需要它来创建一个链表。我该怎么做呢？有没有我可以学习的好教程或示例？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-12-29T15:51:56.180

我认为你知道 C++ 已经有一个链表类，并且你想实现你自己的，因为你想学习如何去做。

一、阅读[为什么我们使用数组而不是其他数据结构？](https://stackoverflow.com/questions/392397/arrays-whats-the-point)，其中包含基本数据结构的一个很好的答案。然后考虑如何在 C++ 中对它们进行建模：

```
struct Node {
    int data;
    Node * next;
}; 
```

基本上这就是实现列表所需的全部内容！（一个*非常*简单的）。然而它没有抽象，你必须手动链接项目：

```
Node a={1}, b={20, &a}, c={35, &b} d={42, &c}; 
```

现在，您有一个节点链表，全部分配在堆栈上：

```
d -> c -> b -> a
42   35   20   1 
```

下一步是编写一个`List`指向起始节点的包装类，并允许根据需要添加节点，跟踪列表的头部（以下非常简化）：

```
class List {
    struct Node {
        int data;
        Node * next;
    };

    Node * head;

public:
    List() {
        head = NULL;
    }

    ~List() {
        while(head != NULL) {
            Node * n = head->next;
            delete head;
            head = n;
        }
    }

    void add(int value) {
        Node * n = new Node;
        n->data = value;
        n->next = head;
        head = n;
    }

    // ...
}; 
```

下一步是使 List 成为模板，以便您可以填充其他值（不仅是整数）。

如果您熟悉智能指针，则可以将使用的原始指针替换为智能指针。我经常发现人们向初学者推荐智能指针。但在我看来，您应该首先了解为什么需要智能指针，然后再使用它们。但这需要您首先了解原始指针。否则，你会使用一些神奇的工具，却不知道你为什么需要它。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-29T15:23:41.010

你真的应该使用[标准的 List 类](http://en.cppreference.com/w/cpp/container/list)。当然，除非这是一个家庭作业问题，或者您想知道 STL 是如何实现列表的。

你会通过谷歌找到很多简单的教程，比如[这个](http://www.mochima.com/tutorials/STL.html)。如果您想知道链表是​​如何“在幕后”工作的，请尝试搜索 C 列表示例/教程而不是 C++。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-29T15:33:06.280

如果要使用`std::list`，则需要传递一个类型参数：

```
list<int> intList;  
list<int>* intListPtr = new list<int>; 
```

如果您想了解列表的工作原理，我建议您搜索一些 C/C++ 教程以了解该主题。下一步将学习足够的 C++ 来创建一个列表类，最后是一个列表模板类。

如果您有更多问题，请在此处提问。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-29T15:23:56.753

为什么要重新发明轮子。只需使用 STL 列表容器。

```
#include <list>

// in some function, you now do...
std::list<int> mylist; // integer list 
```

[更多信息...](http://www.sgi.com/tech/stl/List.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T15:38:12.713

我猜这是一个家庭作业问题，所以你可能想去[这里](http://www.fortunecity.com/skyscraper/false/780/linklist.html)。它有一个解释链表的教程，给出了很好的伪代码，还有一个可以下载的 C++ 实现。

我建议在盲目使用实现之前通读解释并理解伪代码。如果您想继续学习 CS，这是一个您真正应该深入了解的主题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T17:00:09.087

提升 ptr_list

[http://www.boost.org/doc/libs/1_37_0/libs/ptr_container/doc/ptr_list.html](http://www.boost.org/doc/libs/1_37_0/libs/ptr_container/doc/ptr_list.html)

高温高压

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-07T20:44:01.847

**使用C++ 模板**创建列表

 **IE

```
template <class T> struct Node 
{
    T data;
    Node * next;
};

template <class T> class List 
{
    Node<T> *head,*tail;

    public: 
        void push(T const&);  // push element 
        void pop();           // pop element 
        bool empty()          // return true if empty. 
}; 
```

然后你可以编写如下代码：

```
List<MyClass>; 
```

该类型`T`在运行时不是动态的。它仅适用于编译时。

有关完整示例[，请单击此处](https://stackoverflow.com/questions/2079296/c-templates-linkedlist)。

有关 C++ 模板教程[，请单击此处](https://www.tutorialspoint.com/cplusplus/cpp_templates.htm)。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-12-29T15:25:44.783

我们已经进入21世纪了！！不要试图实现已经存在的数据结构。尝试使用现有的数据结构。

使用 STL 或 Boost 库

# c# - What is the best method to find the newest last modified time of a folder of files?

> ID：397900
> 
> 赞同：3
> 
> 时间：2008-12-29T15:22:15.787
> 
> 标签：c#, vb.net, .net, directoryinfo

I have a folder with subfolders of files. I would like to get the newest filename by modified time. Is there a more efficient way of finding this short of looping through each folder and file to find it?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T15:38:16.597

depends on how you want to do it. do you want you software to start and then look for it or continuously run and keep track of it?

in the last case its good to make use of the FileSystemWatcher class.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T15:50:38.913

使用`FileSystemWatcher`对象。

```
Dim folderToWatch As New FileSystemWatcher
folderToWatch.Path = "C:\FoldertoWatch\"
AddHandler folderToWatch.Created, AddressOf folderToWatch_Created
folderToWatch.EnableRaisingEvents = True
folderToWatch.IncludeSubdirectories = True
Console.ReadLine() 
```

然后，只需创建一个处理程序（此处称为 folderToWatch_Created）并执行以下操作：

```
Console.WriteLine("File {0} was just created.", e.Name) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T16:05:23.190

假设您只需要在加载应用程序后知道此信息，则使用 FileSystemWatcher 将起作用。否则你仍然需要循环。像这样的东西会起作用（并且不使用递归）：

```
Stack<DirectoryInfo> dirs = new Stack<DirectoryInfo>();
FileInfo mostRecent = null;

dirs.Push(new DirectoryInfo("C:\\TEMP"));

while (dirs.Count > 0) {
    DirectoryInfo current = dirs.Pop();

    Array.ForEach(current.GetFiles(), delegate(FileInfo f)
    {
        if (mostRecent == null || mostRecent.LastWriteTime < f.LastWriteTime)
            mostRecent = f;
    });

    Array.ForEach(current.GetDirectories(), delegate(DirectoryInfo d)
    {
        dirs.Push(d);
    });
}

Console.Write("Most recent: {0}", mostRecent.FullName); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T17:41:50.077

如果你喜欢 Linq，你可以使用 linq 来反对以你想要的方式查询你的文件系统。[这里](http://weblogs.asp.net/jaycentdrysdale/archive/2008/02/15/file-system-search-via-linq-to-objects.aspx)给出了一个示例，您可以在大约 4 行代码中玩耍并获得您想要的东西。确保您的应用程序对文件夹具有适当的访问权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T15:49:38.183

如果您安装了[PowerShell](http://www.microsoft.com/technet/scriptcenter/hubs/msh.mspx)，则命令为

```
dir -r | select Name, LastWriteTime | sort LastWriteTime -DESC | select -first 1 
```

这样，脚本可以根据需要运行，您可以将名称（或完整路径）传回系统进行处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-10T10:54:24.743

```
void Main()
{
    string startDirectory = @"c:\temp";
    var dir = new DirectoryInfo(startDirectory);

    FileInfo mostRecentlyEditedFile =
        (from file in dir.GetFiles("*.*", SearchOption.AllDirectories)
         orderby file.LastWriteTime descending
         select file).ToList().First();

    Console.Write(@"{0}\{1}", 
        mostRecentlyEditedFile.DirectoryName, 
        mostRecentlyEditedFile.Name);
} 
```

# sharepoint - SharePoint 任务列表中的“任务组”字段有什么用？

> ID：397918
> 
> 赞同：3
> 
> 时间：2008-12-29T15:27:07.010
> 
> 标签：sharepoint

有人能告诉我如何在标准 SharePoint 任务列表中使用“任务组”字段吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T17:50:18.983

我相信它是一个“支持”类型的专栏。默认情况下它并没有真正显示在任何地方，但在使用一种类型的视图期间会被过滤掉。

他们选择的命名约定不是很直观。基本上，当您将任务分配给用户帐户时，此字段为空白。但是，如果您将任务分配给“组”，即 Active Directory 安全组，SharePoint 将自动填充此字段。

当 SharePoint 访问者查看任务列表并选择“我的组”视图时，将评估该字段，例如“访问者是否是该组的成员，如果是，则显示任务”。高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-23T12:24:09.820

在您的视图标记中，当您在 SharePoint 设计器中打开它时，将其添加到`<Where>`标记

```
<Membership Type="CurrentUserGroups">
<FieldRef Name="AssignedTo"/>
</Membership> 
```

并保存，它将完美运行

# javascript - Loading HTML controls from JSON in jQuery (that is, reverse of Ajax serialiseArray)

> ID：397926
> 
> 赞同：3
> 
> 时间：2008-12-29T15:32:37.653
> 
> 标签：javascript, jquery, asp.net-mvc, ajax, json

I would like to take a set of controls (INPUT, SELECT, TEXTAREA) which are contained within a DIV and send their values as JSON via Ajax to a server. This is easy enough with jQuery's [serializeArray](http://docs.jquery.com/Ajax/serializeArray).

However I then want the server to respond with the same structure of JSON that was sent and re-load the control values using the provided JSON. I can't find anything in the jQuery documentation that would make this a simple operation.

Am I missing something or do I need to build this myself?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T18:29:23.633

为什么不让服务器以相同的方式发送回：controlname:value 结构，然后在 jQuery 中读取它并使用类似的东西：

```
$("*[name='" + controlname + "']").val( value); 
```

或者更简单：controlID:value

```
$("#" + controlID).val( value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T16:17:52.120

表单控件未绑定到 JSON 数据。

JSON 数据可以用于任何目的，因此您必须构建一个函数来获取 JSON 结果并自己摆弄表单元素。

表单太复杂了，不能指望 jQuery 原生地处理这个问题。在过去，我编写了框架来从基于 XML/JSON 的定义构建表单并使用它们来处理数据传输。自己做并不是那么难，但这不是内置的。

我快速浏览了这些插件，也没有注意到有什么特别的功能，尽管这听起来确实是个好主意。这听起来更像是通过[Ext.js](http://extjs.com/)支持的东西。

# openmoko - Turn off screensaver while openmoko app is running

> ID：397927
> 
> 赞同：0
> 
> 时间：2008-12-29T15:32:59.837
> 
> 标签：openmoko

In openmoko (stable hybrid release, SHR), how do you programatically turn-off the screensaver (the dimmed/blank screen after a few seconds of inactivity) just while your app is running?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T19:01:03.600

在 X 中，您可以运行

```
xset s off 
```

关闭屏幕保护程序。同样，gnome/freedesktop 公开了一个 DBUS API 来控制和禁止屏幕保护程序模式。我不知道 OpenMoko 是否支持 freedesktop 规范，但如果支持，您应该可以直接使用 DBUS。[你可以在这里](http://svn.gnome.org/viewvc/totem/trunk/lib//totem-scrsaver.c?view=markup)看到 Totem 是如何做到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-10T15:42:02.410

FSORaw 是一个包装器，您可以在外部使用它来声明显示器等资源。这将防止屏幕空白。但是，如果它是您自己的应用程序，我建议您在您的软件中声明相同的显示资源。

[更多关于 fsoraw 和资源](http://wiki.openmoko.org/wiki/FSO_Resources#Display)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T12:36:06.163

可以通过[freesmartphone](http://freesmartphone.org/)的 D-BUS API 做到这一点，也可以防止挂起。

```
mdbus -s org.freesmartphone.ousaged /org/freesmartphone/Usage org.freesmartphone.Usage.SetResourcePolicy CPU auto
mdbus -s org.freesmartphone.ousaged /org/freesmartphone/Usage org.freesmartphone.Usage.SetResourcePolicy Display auto 
```

将 auto 替换为启用或禁用。

‏您可以在以下位置找到此 D-BUS 方法的文档[http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Usage.html;hb=HEAD#GetResourcePolicy](http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Usage.html;hb=HEAD#GetResourcePolicy)

# java - Taking contact list from hotmail gmail yahoo in java?

> ID：397933
> 
> 赞同：12
> 
> 时间：2008-12-29T15:35:13.313
> 
> 标签：java, gmail, yahoo, contacts, hotmail

most of social networks does this. when you register one of them for example twitter it says why dont you invite your friends from hotmail or yahoo or gmail. and expect us to give our credentials and send those mails. I want to implement same feature in java.

I tried [http://code.google.com/p/contactlistimporter](http://code.google.com/p/contactlistimporter) but it has a problem with hotmal.

can you suggest me nice another library ?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-29T23:53:38.003

这些电子邮件提供商中的每一个都有自己的 API：

*   GMail：[Google 联系人数据 API](https://developers.google.com/google-apps/contacts/v3/?hl=en) - [Google 联系人 API 3.0 版](https://developers.google.com/google-apps/contacts/v3/)
*   雅虎！邮件：[雅虎！地址簿 API](http://developer.yahoo.com/addressbook/) -[开发人员指南](http://developer.yahoo.com/addressbook/guide/)
*   Hotmail：[Windows Live 联系人 API 测试版](http://msdn.microsoft.com/en-us/library/bb463989.aspx)- [API 参考](http://msdn.microsoft.com/en-us/library/bb463979.aspx)

通常有 Java 示例可用于开始您的工作。我一直在使用 Google Data API 成功下载了我的 GMail 联系人和 Google Docs&Spreadsheets。

似乎有您所要求的商业 Java 库。他们之中有一些是：

*   来自 Malasian [Octazen的](http://www.octazen.com/)[联系人 Importer](http://www.octazen.com/product_abi.php) ，总共支持 30 多个网络邮件（价格为 234 美元），而您正在寻找的版本将花费 88[美元](http://www.octazen.com/store.php)。
*   另一个来自 Indian [Improsys的](http://www.improsys.com)[Contacts Importer](http://www.improsys.com/jcon/index.jsp)支持较少的“*网络*”和 Java 版本，[售价 550 美元](http://www.improsys.com/importer.htm)。

 *我不知道有任何开源 Java 库提供对所有这三个电子邮件提供商的一般访问权限。有一个用于 PHP 的[Open Inviter](http://phpclasses.burina.net/browse/package/4927.html)，它支持 10 多个*网络*（如果您提到的三大网络完全可以考虑的话）。

此外，[Plaxo](http://www.plaxo.com)已经启动了一项名为[Portable Contacts](http://portablecontacts.net/)的工作（并且[草案规范](http://portablecontacts.net/draft-spec.html)看起来很有希望），但这还处于非常早期的阶段。无论如何，我不会使用便携式联系人来解决您的问题，而且这在接下来的 6 个月内也不会发生。这是他们在备份人们的地址簿、围绕它创建一个更自然的网络以及在来自谷歌、Facebook 和 MySpace 的激烈竞争中总体上提升数据可移植性方面所做的事情。

除此之外，我认为在撰写本文时没有任何可行的方法。否则我会找到它。;-)

干杯!
松兹拉

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-10-15T16:30:43.003

尝试这个：

socialauth 是一个 java 库，允许从 Google、Yahoo 或 Hotmail 导入联系人。[http://code.google.com/p/socialauth/](http://code.google.com/p/socialauth/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-29T18:43:28.410

你为什么不看@ OpenSocial API？

1.  [开放社交](http://code.google.com/apis/opensocial/)

2.  [开始使用 Opensocial](http://code.google.com/p/opensocial-java-client/wiki/GettingStarted)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T19:19:18.977

大多数网络邮件提供商都提供导出联系人以进行备份的选项。

您的应用程序需要询问用户的凭据，然后它可以获取联系人备份（我想它具有或多或少的通用 URL）并解析它。

它很可能是某种形式的 xml 或广泛使用的书本格式，这两种格式都是机器可读的。

编辑：

对于 Gmail 的 url `http://mail.google.com/mail/contacts/data/export`，它接受各种参数来定义导出文件的格式（gmail csv、vcard、...）和导出联系人的范围。

要使用它，您的应用程序必须充当 http 客户端，并且首先必须使用用户的凭据登录。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-29T18:34:27.990

您可能必须自己截屏，这是一场噩梦。几年前我为 Hotmail 写了一篇文章，在 Hotmail 所做的更改 6 个月 b/c 后崩溃了。然后我的修复也坏了。

# delphi - 在 Delphi 中写入事件日志

> ID：397934
> 
> 赞同：9
> 
> 时间：2008-12-29T15:35:33.077
> 
> 标签：delphi

如何让应用程序将调试文本写入 Delphi IDE (Borland Developer Studio 2006) 中的事件日志窗口？

如何改变文本的颜色？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-29T15:37:40.967

[OutputDebugString](http://msdn.microsoft.com/en-us/library/aa363362(VS.85).aspx) ('Hello,World');

我认为您可能需要将 Windows 添加到您的“使用”列表中。不是100％确定...

据我所知，文本颜色无法更改：这是 Delphi IDE 的一个功能，它在线程启动/停止、DLL 加载/卸载的窗口中添加了额外的消息，并带有它们自己的特定颜色。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-29T15:59:33.327

是的，您可以使用`OutputDebugString`.

如果您想获得更强大的功能来控制和管理调试输出，例如突出显示过滤器，您应该使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)。

注意：当您在 Delphi IDE 中运行应用程序时，DebugView 无法捕获调试日志。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-30T11:56:55.513

```
procedure Write2EventLog(Source,Msg: string);
var h: THandle;
    ss: array [0..0] of pchar;
begin
    ss[0] := pchar(Msg);
    h := RegisterEventSource(nil,  // uses local computer
             pchar(Source));          // source name
    if h <> 0 then
      ReportEvent(h,           // event log handle
            EVENTLOG_ERROR_TYPE,  // event type
            0,                    // category zero
            0,        // event identifier
            nil,                 // no user security identifier
            1,                    // one substitution string
            0,                    // no data
            @ss,     // pointer to string array
            nil);                // pointer to data
    DeregisterEventSource(h);
end; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T11:54:59.310

除了已经说过的（即`OutputDebugString`使用 DebugView 而不是内置的日志查看器），您可以通过选项更改日志视图中消息的颜色。到达那里的最简单方法是右键单击日志窗格并从上下文菜单中选择“属性”。在将出现的选项卡上，您可以从“颜色”部分设置用于“输出调试字符串”的颜色。显然，这将改变通过发出的所有消息的颜色`OutputDebugString`- 它不允许单独着色。为此，您最好使用 DebugView 的过滤器。

# c# - ASP.net 中的 foreach 嵌套 runat="server"

> ID：397944
> 
> 赞同：1
> 
> 时间：2008-12-29T15:41:58.230
> 
> 标签：c#, asp.net

对于以下代码：

```
<% foreach (Entities.Core.Location loc in locations){ %>
<div class="place_meta">
<img src="~/static/images/stars/star_25_sml.gif" runat="server" class="star_rating"/>
</div>
<% }; %> 
```

我想显示显示的每个位置对象的星级图像。但是，仅显示第一个位置对象的星级。对于其余部分，图像标签变为`<img class="star_rating" />`

我是否遗漏了语法中允许在 aspx 页面上的 foreach 中使用 runat=server 进行控件的任何内容？这是 ASP.net 2.0。

我可能会调用代码隐藏或显示类中的函数来绝对映射 URL，但我很好奇是否有解决此问题的方法。

只是为了澄清，每个位置对象的图像路径可能不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T15:59:09.537

不能在内联循环中使用服务器控件，因为 ASP.NET 需要能够唯一标识每个控件来处理它。for... 循环可以防止这种情况。最简单和最干净的方法是使用 Repeater 控件并将您的集合绑定到它（在代码隐藏中）。在绑定事件处理程序中设置 URL 属性，并在绑定时维护一个计数器变量，以检查您是否在第一项。

编辑：我对此进行了更多尝试，发现如果您分配一个 ID 属性，所有循环实例都会获得相同的 ID，但 ASP.NET 仅识别找到的第一个控件。这将是一种仅在第一个实例上设置属性的非常肮脏的方式。请不要写这样的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T16:00:25.523

除非您使用 MVC，否则您可能会发现中继器控件在这种情况下更有用。

如果我没记错的话，您可以使用数据源（在本例中是您的*位置*），然后循环遍历并设置每个图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T16:05:41.427

我不知道你的代码是否应该工作，但这个是 ;-)

```
<asp:Image ImageUrl="~/static/images/stars/star_25_sml.gif" runat="server" class="star_rating" /> 
```

也许这就是你正在寻找的东西。

编辑：查看您的代码`System.Web.UI.HtmlControls.HtmlImage`可以看到该`src`属性在（第一次）处理后被删除。这可能是您的代码只能正确获取第一个 URI 的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T15:53:49.470

我将删除该`runat="server"`属性并使用相对路径（或完整路径）而不是使用波浪号来引用图像。

**编辑：** FWIW，@miies 的想法符合 ASP.NET 范式，并且是我切换到 ASP.NET MVC 的一个例子。

# c# - 禁用输出转义的 XSLT 转换问题

> ID：397955
> 
> 赞同：1
> 
> 时间：2008-12-29T15:47:32.570
> 
> 标签：c#, xslt, escaping

我有一个xml，我在这样的评论下存储了一些html

```
 <root> 
   <node>
     <!-- 
            <a href="mailto:some@one.com"> Mail me </a>
      -->
</node>
</root> 
```

现在在我的 Transform Xslt 代码中，我给出了指向节点的 XPathNavigator，在 xslt 中，我将注释值作为参数传递。

假设 $href 是`<a href="mailto:some@one.com"> Mail me </a>`

在 xslt 我正在做`<xsl:value-of select="$href" disable-output-escaping="yes">`

但是 $href 仍然逃脱了 xslt 转换的结果与 < >

有谁知道它有什么问题，在这方面的任何帮助都会非常受欢迎。

谢谢问候阿泽姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T05:54:29.117

当评论的一部分时，节点失去了它的特殊含义——因此“href”不是一个节点，所以你不能用它来选择东西。

您可以选择这样的评论：

```
<xsl:template match="/">
<xsl:value-of select="/root/node/comment()" disable-output-escaping="yes"/>
</xsl:template> 
```

这将根据您的 XML 输入生成：

```
cristi:tmp diciu$ xsltproc test.xsl test.xml 
<?xml version="1.0"?>

        <a href="mailto:some@one.com"> Mail me </a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:27:50.127

正如 diciu 所提到的，一旦评论了里面的文本就不再是 XML 解析的。

该问题的一种解决方案是使用两遍方法。第一遍取出注释`<a href=""></a>`节点并将其放入普通 XML，第二遍用您想要的输出丰富数据：`<a href="">Your Text Here</a>`.

第二种单通道方法是通过正则表达式（或者在我们的例子中只是从 XML 中提取）从评论（在本例中为电子邮件地址）中提取您需要的文本，然后围绕它创建所需的标记.

```
<xsl:template match="ahrefmail/comment()">
    <xsl:element name="a">
        <xsl:attribute name="href" select="../../mail"/>
        <xsl:attribute name="class" select="'text'"/>
        <xsl:text>Mail Me!</xsl:text>
    </xsl:element>
</xsl:template> 
```

这假设您已经有一个[身份模板](http://www.xmlplease.com/xsltidentity)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-30T06:58:44.477

我确实试过你刚才说的没有用我使用的xml是

```
<?xml version="1.0" ?>
  <root>
    <institution id="1">
        <data>
        <ahrefmail>
            <!--
        <a href='mailto:ibank@abibbankuk.com' class='text'></a>
             -->
        </ahrefmail>

        <mail>
            ibank@abibbankuk.com
        </mail>
        </data>
    </institution>

    <institution id="2">
        <data>
        <ahrefmail>
            <!--
        <a href='mailto:ibank@abibbankuk2.com' class='text'></a>
        -->
        </ahrefmail>

        <mail>
            ibank@abibbankuk2.com
        </mail>
        </data>
    </institution>

</root> 
```

在 xslt 我正在做

其中 $id 作为参数传递 == 1 ahrefmail 节点仍然使用 lt & gt 进行转义

谢谢问候阿泽姆

# sharepoint - 如何更改现有 SharePoint 列表的 ListTemplateID？

> ID：397956
> 
> 赞同：1
> 
> 时间：2008-12-29T15:47:33.583
> 
> 标签：sharepoint

我在站点集合中有几个列表，它们当前正在使用 ListTemplateID 101 (DocumentLibary)。我想将事件处理程序附加到这些列表中，但是如果我将事件附加到列表 101，则站点集合中的所有文档库都将获得此事件处理程序。

我不想以编程方式将事件处理程序附加到这些列表中。

我想知道，您如何更改现有列表的 ListTemplateID？

谢谢你，
基思

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T12:49:52.637

如果列表已经创建，那么不幸的是，您只能以编程方式附加事件处理程序或使用自定义工具手动附加它们。

创建列表后，ListTemplateID 将存储在数据库中，并且不支持更改它的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T19:15:52.697

我怀疑你能做到这一点。它肯定会比仅将事件处理程序附加到现有列表更多的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T20:57:02.710

如果您只想将事件处理程序附加到某些列表并且不想以编程方式执行此操作，您可以使用来自[Brian Wilson的](http://blogs.msdn.com/brianwilson/archive/2007/03/18/event-handlers-part-3-register-event-handlers-plus-free-site-settings-manage-event-handlers-add-on.aspx)[SharePoint Server 2007 - 自定义站点管理应用程序](http://www.codeplex.com/SPSCustomAdmin/Release/ProjectReleases.aspx?ReleaseId=3024)。

它为网站设置添加了一个新的菜单条目。在那里，您可以选择要将事件处理程序附加到的站点、列表或内容类型，还可以定义应该触发处理程序的事件。

我希望这能帮助你解决你的问题。

# asp.net-mvc - RhinoCommons UnitOfWork 问题与 ASP.Net MVC

> ID：397975
> 
> 赞同：0
> 
> 时间：2008-12-29T15:58:12.923
> 
> 标签：asp.net-mvc, unit-of-work, rhino-commons

我正在玩 RhinoCommons 和 NHibernate，我对 UnitOfWork 模式有疑问。

对不起，如果这是一个 n00b 问题。

UnitOfWork 是否应该在最高级别（即控制器）启动？或者在控制器调用的服务模块中说？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-03T17:34:02.203

使用 UnitOfWorkApplication。 [方法如下](http://lunaverse.wordpress.com/2008/07/13/rhino-commons-with-ms-mvc/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T01:13:39.403

我认为 UnitOfWork 必须是一个服务设施，而不是控制器职责的一部分。

# http - 物理分离安全和非安全 Web 请求

> ID：397978
> 
> 赞同：1
> 
> 时间：2008-12-29T15:59:16.323
> 
> 标签：http, architecture, web-applications, https

我们一直在做一些研究，将我们的 Web 应用程序的安全和非安全部分物理隔离为两个应用程序。所有“http”请求将由一个服务器（或集群）提供服务，所有“https”请求将由另一台服务器（或集群）提供服务。

我们正在研究这个的部分原因是应用程序的生存能力。由于应用程序的安全部分是创收的，例如，我们可以拥有一个更大和/或更强大的集群来服务请求。相反，当我们升级安全应用程序中的硬件时，它可以重新用于为非安全站点提供服务——基本上延长了服务器的寿命。

有没有人使用过这种方法？去年，我们向（知名的）供应商提交了一份 RFP 以进行架构评估，这是推荐的可能途径之一。虽然我看到了潜在的好处，但我担心维护、部署、版本控制等问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T16:13:29.990

根据您的应用程序的架构方式，在我看来，如果您使用虚拟化/负载平衡，您可以获得与付费区域的资源保证和隔离相同的好处，同时还能够动态突发资源以处理负载峰值任一区域。您当前的提案允许您保证资源并确定资源的优先级，但这可能会导致其中一些资源闲置。

另外，通过配置管理负载会更容易，因为这将是一个纯粹的部署问题，并且是一个完全独立的问题。您还将更加独立于硬件升级路径，因为您只需将虚拟机添加/分配到新硬件。

# c# - 每次按下按钮都会增加数组值？

> ID：397980
> 
> 赞同：0
> 
> 时间：2008-12-29T15:59:33.340
> 
> 标签：c#, arrays, events, increment, calculator

我正在用 C# 构建一个计算器。我不确定每次按下按钮时最好的方法是让它在数组中增加一个数字。这是我当前的按钮事件处理程序方法之一：

```
 //Assign button '2' to 2 with array address of 1
    private void num2_Click(object sender, EventArgs e)
    {
        numbers[1] = 2;
        lblUpdate(1);
    } 
```

我希望每次按下此按钮时，numbers[1] 都会增加 2。现在，无论按下按钮多少次，它都会被设置为 2。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T16:02:14.583

数字[1] += 2;

这应该够了吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-29T16:02:40.310

```
numbers[1] += 2; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-29T16:02:54.177

数字[1] += 2;

# sql-server-2005 - 如何通过批量更新更改字符串数据？

> ID：397998
> 
> 赞同：1
> 
> 时间：2008-12-29T16:06:23.030
> 
> 标签：sql-server-2005, tsql

我在 t-sql 中有一个表 (T1)，其中一列 (C1) 包含近 30,000 行数据。每列包含 MSA123、MSA245、MSA299 等值。我需要运行更新脚本，以便字符串的 MSA 部分更改为 CMA。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T16:10:04.320

```
update t1
set c1 = replace(c1,"MSA","CMA")
where c1 like "MSA%" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T16:15:56.257

我面前没有 SQL Server，但我相信这会起作用：

```
UPDATE T1 SET C1 = REPLACE(C1, 'MSA', 'CMA'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T16:09:32.197

您可以使用[REPLACE](http://msdn.microsoft.com/en-us/library/ms186862.aspx)功能来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T16:12:24.703

除了 fall888 发布的内容之外，如果该表/列中还有其他值，您可以在 where 子句中使用 LIKE 运算符来确保只更新您关心的记录：

```
... WHERE [C1] LIKE 'MSA[0-9][0-9][0-9]' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T20:10:27.687

虽然替换似乎有效，但当您需要将 M 替换为 C 以用于 MSA 而不是用于 MCA 时会发生什么？或者，如果您现在在数据中有 MSAD 和 MSA，并且您不希望更改（或 CMSA）。您是否确定是否有任何您不想替换的数据被替换？

正确的答案是永远不要以这种方式存储数据。数据库设计的第一条规则是每个字段只存储一条信息。你应该有一个相关的表。随着时间的推移，它会更容易维护。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T20:25:35.863

我不得不不同意 HLGEM 的帖子。虽然第一个范式在 EF Codd 的原始愿景中谈论原子性是正确的（这是 1NF 恕我直言的最具争议的方面），但原始请求并不一定意味着没有相关的表或该值不是原子的。

MSA123 可能是相关对象的自然键，该公司可能只是决定重命名其产品线。可以正确地说，如果使用人工 ID，那么即使更新自然键也不需要更新那么多行，但如果这是您的意思，那么我认为人工键绝对不是第一条规则数据库设计。它们有它们的优点，但它们也有许多缺点，我不会在这里讨论，但是在谷歌上搜索一下就会引起关于是否使用人工主键的相当大的争议。

至于最初的要求，其他人已经确定了，REPLACE 是要走的路。*********``