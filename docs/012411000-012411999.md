# StackOverflow 问答 12411000-12411999

# asp.net-mvc - 为正在使用的每种类型的服务器创建一个单独的 DbCompiledModel

> ID：12411000
> 
> 赞同：1
> 
> 时间：2012-09-13T16:44:07.917
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在从 Microsoft 的教程中学习 ASP.NET MVC：

[http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/accessing-your-model's-data-from-a-controller](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/accessing-your-model%27s-data-from-a-controller)

在上面提到的链接中，添加一个名为`MoviesController`我的控制器时出现此错误：

“无法检索 'MvcMovie.Models.Movie' 的元数据。不支持使用相同的 DbCompiledModel 针对不同类型的数据库服务器创建上下文。相反，为正在使用的每种类型的服务器创建一个单独的 DbCompiledModel”

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:56:30.740

我会看看[这个帖子](https://stackoverflow.com/questions/12410673/using-the-same-dbcompiledmodel-to-create-contexts-against-different-types-of-dat)。

使用 SQL CE 时，控制器创建似乎存在问题

# php - PHP/JQuery 重定向

> ID：12411005
> 
> 赞同：0
> 
> 时间：2012-09-13T16:44:34.067
> 
> 标签：php, jquery, html, redirect, post

我有一个 3 页的注册网站。当用户在第一页上选择三个选项之一时，他们可以提交并移至第二页。他们在那里填写信息并单击提交，这应该会将他们带到第三页。问题是单击第一页和第二页上的提交后的 jquery 重定向代码不起作用。这是第一页中的代码：

```
<?php
session_start();
$errors = false;
$message="";
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    if (!isset($_POST['Reg_type']) || !preg_match('/^[123]$/', $_POST['Reg_type'])) {
        $message = "Please select an option";
        $errors = true;
    }
    if (!$errors) {
        $_SESSION["regtype"]=$_POST["Reg_type"];
        header("Location: Registration_2.php");
        exit;
    }
}
?>
<div id="form_page1">
<form id="frmtype1" name="frmtype1" method="post">
<input type="radio" name="Reg_type" value="1"/> option1 <br/>
<input type="radio" name="Reg_type" value="2"/> option2 <br/>
<input type="radio" name="Reg_type" value="3"/> option3 <br/>
<input type="submit" name="Submit" value="Submit" />
<?php
if($errors)
echo $message;
?> 
```

我正在尝试将该 php 代码转换为 javascript，这就是我所拥有的：

```
<script>
$(document).ready(function(e) {
    $("form").submit(function() {
        var data= $(this).serialize();
        alert(data);
        $.post("/Registration_1.php",$("#form_page1").serialize());
            window.location.replace("http://www.google.com"); //just for testing purposes
    });
});
</script> 
```

但由于某种原因，jquery 的东西不起作用，所以我必须改用 php。谁能告诉我问题是什么？post 方法的第一个参数必须是您要访问的页面 (Registration_2.php) 还是您要从中获取数据的页面？希望如果第一页的 jquery 代码被修复，它可以修复第二页。在过去的 3 个小时里，我一直在工作/研究这个问题，但无济于事。请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:49:08.320

为什么选择如此复杂的解决方案？

表格一：

```
<form action="form2.php"  method="post">
  <input type="submit" >
</form> 
```

表格 2：

```
<form action="form3.php"  method="post">
  <input type="submit"> 
</form> 
```

等等等等

# html - Soundcloud：同时播放多个曲目 - HTML5 小部件

> ID：12411006
> 
> 赞同：8
> 
> 时间：2012-09-13T16:44:34.627
> 
> 标签：html, widget, soundcloud

我正在尝试基于 Soundcloud 创建一个简单的多轨播放器，显示多个轨道并同时开始播放它们。

我在这里找到了一个类似的原型（基于 Flash 小部件）：[http](http://sessian.com/10/)
://sessian.com/10/按两个不同的“播放”按钮，可以同时播放两个曲目。

似乎使用 HTML5 小部件是不可能的，一次只能播放一首曲目。这里的快速示例：http: [//jsfiddle.net/ftwJr/7/](http://jsfiddle.net/ftwJr/7/)

html:

```
<iframe id="widget" src='http://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/43315398&auto_play=true' width="100%"></iframe>
<iframe id="widget2" width="100%" src='http://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/4331538'></iframe> 
```

JavaScript：

```
(function() {
    var iframe = document.querySelector('#widget');
    var widget = SC.Widget(iframe);
    widget.bind(SC.Widget.Events.PLAY, function(eventData) {
        alert('Playing 1...');
    });
    widget.bind(SC.Widget.Events.PAUSE, function(eventData) {
        alert('PAUSE 1...');
    });

    var iframe2 = document.querySelector('#widget2');
    var widget2 = SC.Widget(iframe2);
    widget2.bind(SC.Widget.Events.PLAY, function(eventData) {
        alert('Playing 2...');
    });
    widget2.bind(SC.Widget.Events.PAUSE, function(eventData) {
        alert('PAUSE 2...');
    });
}()); 
```

按“播放”会将暂停事件传递到另一个窗口。在不同的浏览器选项卡中也是如此。

有没有办法允许使用 HTML5 小部件同时播放多个？（现有的 SC 初始化选项，或拥有两个不同 SC 实例的方法，或...）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:30:57.367

澄清一下：[flash 和 HTML5 小部件的 API](http://developers.soundcloud.com/docs/widget#parameters)支持`single_active`这个用例的参数。

# facebook - 需要帮助识别将访问者引至我们主页的 facebook 应用

> ID：12411008
> 
> 赞同：1
> 
> 时间：2012-09-13T16:44:39.877
> 
> 标签：facebook, google-analytics

我们今天从我认为是身份不明的 Facebook 应用程序中获得了很多访问。页面网址包括：

```
/?fb_source=canvasbookmark&count=0
/?fb_source=search&ref=ts
/?fb_source=canvasbookmark_more&count=0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=3_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=6_0
/?fb_source=bookmark_seeall&ref=bookmarks
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=16_0
/?fb_source=appcenter_request
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=2_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=8_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=14_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=17_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=5_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=7_0
/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=9_0
/?fb_source=bookmark_favorites&ref=bookmarks&count=0&fb_bmpos=9_0 
```

我们没有创建这个应用程序。有什么方法可以识别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:02:38.957

如果它有“书签”引用，则意味着该应用程序被配置为移动或画布应用程序。

如果它是一个画布应用程序，这些可能是对您的服务器的 POST 请求，而不是 GET 请求。POST 请求将包含一个`signed_request`参数，其中包含您应用的一些变量

您可以`signed_request`使用 Facebook 开发者网站上的 Echo 工具查看其中的内容：`https://developers.facebook.com/tools/echo?signed_request=SIGNED_REQUEST_HERE`- 我不确定它是否会向您显示应用 ID，但它可能会提供足够的其他相关信息来查看人们正在尝试加载的应用

# java - 在 Windows 7 上安装和导入 javafx

> ID：12411010
> 
> 赞同：7
> 
> 时间：2012-09-13T16:44:46.120
> 
> 标签：java, javafx

我已经安装了 jdk1.7.0_07 并更改了 PATH 但我仍然无法导入 javafx，我应该做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T22:31:20.483

确保 /jre/lib/jfxrt.jar 在您的编译路径上。

例如对于 win7 上的 64 位 jdk7u6 版本，jfxrt.jar 位于此处：

```
C:\Program Files\Java\jdk1.7.0_06\jre\lib\jfxrt.jar 
```

jfxrt.jar 是故意为 jdk1.7.0_06 离开 java 运行时路径的，直到 JavaFX 和其余 java 基础设施之间的进一步测试完成。这意味着非 JavaFX 程序不可能受到可能由 JavaFX 引起的兼容性问题的影响。迄今为止，我从未遇到任何兼容性问题——我相信这只是 Oracle 在这方面的谨慎举措。

在未来的版本中，jfxrt.jar 应该被添加到 Java 的默认编译和运行时类路径中，并且下面的一些信息应该是不相关的。您可以跟踪[将 jfxrt.jar 添加到默认 java 运行时](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7166330)的请求。

**从命令行编译和运行 JavaFX 程序**

下面的示例是一个名为的 JavaFX 应用程序类`javafxsamples.AudioPlaylist`

如果您从命令行编译，请使用以下命令进行编译：

```
javac -cp ".;C:\Program Files\Java\jdk1.7.0_06\jre\lib\jfxrt.jar" javafxsamples/AudioPlaylist.java 
```

要从命令行运行，您可以使用：

```
java -cp ".;C:\Program Files\Java\jdk1.7.0_06\jre\lib\jfxrt.jar" javafxsamples.AudioPlaylist 
```

不过，建议您使用 javafxpackager 打包您的应用程序，而不是手动将 jfxrt.jar 添加到您的类路径中（javafxpackager 打包的应用程序将嵌入一个启动器，它会为您找到 jfxrt.jar 并将其添加到类路径中）。

```
javafxpackager -createjar -nocss2bin -appclass javafxsamples.AudioPlaylist -srcdir . -outfile AudioPlaylist.jar 
```

之后，您无需在类路径上指定 jfxrt.jar 位置即可运行应用程序：

```
java -jar AudioPlaylist.jar 
```

**使用 IDE 编译和运行 JavaFX 程序**

*NetBeans*

[如果您使用的是 NetBeans 7.2+，您可以创建一个 JavaFX 项目类型，当您将 jdk1.7.0_07 设置为您的平台](http://netbeans.org/kb/docs/java/javafx-setup.html)时，它应该会自动找到 JavaFX jfxrt.jar 并将其放在项目的类路径中。

*蚀*

如果您使用的是[e(fx)clipse](http://efxclipse.org/) ，请确保您使用的是最新版本 (0.0.14+)，该版本具有更好的检测 JavaFX 的功能。

*主意*

Intellij Idea 11.1.3 会自动将 jre lib 目录中的所有文件添加到它的项目类路径中，因此您不应该遇到编译错误。请注意，Idea 的行为在这方面是错误的，它不应该真的这样做，但最终你会得到能够从 idea 编译和运行 JavaFX 类的预期行为。

**使用 maven 构建 JavaFX 程序**

*   使 jfxrt.jar 成为您的 maven 项目的系统依赖项，以便将其放在路径上。
*   使用 maven antrunner 执行 javafx ant 任务进行部署打包。

[这个maven 项目](http://code.google.com/p/willow-browser/source/browse/pom.xml)中提供了一个使用 maven 打包 JavaFX 的示例。

* * *

即使您使用 IDE 或 Maven 进行构建，仍然建议您使用 javafx ant 任务或 javafxpackager 实用程序打包您的应用程序以进行交付，因为这应该为您的应用程序提供最强大的部署解决方案。

# android - 由于将上下文传递给可序列化类而导致崩溃

> ID：12411012
> 
> 赞同：1
> 
> 时间：2012-09-13T16:44:48.733
> 
> 标签：android

> **可能重复：**
> [从我的应用程序加载 Web broser 时出现可序列化的崩溃错误](https://stackoverflow.com/questions/12408386/serializable-crash-error-when-loading-web-broser-from-my-application)

当我尝试通过单击界面上的按钮从我的应用程序中打开 Web 浏览器时导致崩溃的代码下方

**MainTest.java**

```
package com.heeere.androiddnssd.discovery;

import android.app.Activity;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class MainTest extends Activity {

    private Discovery discovery; 

    /** Called when the activity is first created. */

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if ( savedInstanceState == null)
            discovery = new Discovery(this);
        else
            discovery = (Discovery) savedInstanceState.getSerializable("discovery");
        setContentView(R.layout.main);
        Button b = (Button)this.findViewById(R.id.button);
        b.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.google.com"));
                startActivity(browserIntent);
            }
        });
    }

    @Override
    protected void onSaveInstanceState(final Bundle outState) {
        outState.putSerializable("discovery", discovery);
        super.onSaveInstanceState(outState);
    }
} 
```

**发现.java**

```
package com.heeere.androiddnssd.discovery;

import java.io.Serializable;

public class Discovery implements Serializable {

    private static final long serialVersionUID = 637576886455091135L;
    private MainTest maintest;
    //android.os.Handler handler = new android.os.Handler();

    public Discovery (MainTest maintest) {
        this.maintest = maintest;
    }

} 
```

现在，如果我从 Discovery 的构造函数中删除 MainTest Class 类型，该错误将消失。**所以这就是坠机的原因。**

如何在不从 Discovery 的构造函数中删除 MainTest 类类型的情况下解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T10:48:39.560

问题是由于在创建相关对象时将主要活动传递给可序列化类。在我们的例子中，在创建对象时`MainTest`将对象传递给对象。`Discovery`解决方案：创建另一个包含所有发现数据（可序列化数据）的可序列化类。

# java - 用于文件读取的 Java 模型视图控制器

> ID：12411014
> 
> 赞同：0
> 
> 时间：2012-09-13T16:44:54.833
> 
> 标签：java, model-view-controller, model, controller

我在设计一个读取文本文档并将统计信息写入文本文件的小程序时遇到了很多麻烦。我们必须使用我们还没有学过的模型-视图-控制器格式！

基本上，模型类表示来自文本文件的文本，我需要将其存储在字符串或字符串数​​组中。它还必须有方法来报告单词的数量和类似的东西。视图类需要有缓冲读取器和写入器。控件类创建对象并调用 printResults() 方法。

所以我从我的控制类开始，有类似的东西：

```
Model model = new Model();
View view = new View( model );

view.writeFile(); 
```

我有一种感觉，这是不正确的。如何让我的模型类表示一个文本文档，并将其发送到视图类以读取它，然后让视图类调用模型类中的方法来写入统计信息？有更好的方法还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:00:12.240

您的模型非常有意义。您正在使用 View 类将数据移入和移出模型，我想这是合理的。通常，视图比这更直观。我认为视图将是一些显示文本文件的窗口。也许这可能是 GUI 的一部分，允许用户选择要打开的文件和我们正在保存的文件。

控制器通常是您的程序响应用户输入的地方。但是如果您不需要为这个项目构建 UI，那么您对“视图”和“控制器”的解释听起来不错。如果这个程序是用 Swing 编写的，那么你的控制器仍然会按照你描述的那样做。但它会响应用户单击保存按钮或文件打开按钮来执行这些操作。

如果您不熟悉 Model-View-Controller 设计模式，您可能应该阅读它。例如，请参阅[Oracle 关于 MVC 的 technetwork 文章。](http://www.oracle.com/technetwork/articles/javase/index-142890.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T15:12:18.153

```
 How do I make my view and model classes aware of each other
 without having to declare a view object in the model class and
 a model object in the view class? 
```

- 这是控制器的工作。通常，您会在 Controller 类中使用它们的“setter”和“getter”创建一个 Model 和 View 字段。然后在主程序类中，您将创建 View 和 Model 对象并将它们设置为 Controller 类的字段。这样，每次你想在 View 和 Model 之间传递数据时，你只需使用 Controller 中的相应字段调用每个方法的方法。

例如，假设您想将用户输入的数字加倍并显示它。在 Controller 对象的实现中，您调用 View 的方法来获取用户输入并将其作为参数传递给 Model 的方法。然后，您将返回的值或模型方法的数字加倍，并将其传递回视图或以任何所需方式显示结果的方法。

# php - 如何格式化 Web 服务响应以供 Perl 读取？

> ID：12411020
> 
> 赞同：0
> 
> 时间：2012-09-13T16:45:17.277
> 
> 标签：php, web-services, perl, httpresponse

我正在使用 Perl 从我构建的 Web 服务中请求一些信息（纯文本）。使用浏览器访问时，信息显示完美。但是，我是使用 Perl 处理响应的新手。我成功地做了一些数据库操作，我的问题是在 Perl 中处理响应，而不是 PHP。

我如何必须对响应进行编码或格式化才能成功处理它并在 Perl 中输出相同的纯文本？

编辑：

需要考虑的关键点

*   我正在使用 CakePHP 2.x（稳定版）。
*   ***$response->content***带来了整个HTML 文件（包括 JavaScript 和整个包）。我只想在 Perl 脚本中显示纯文本。
*   Perl 脚本在检查***$response->is_success***时失败并直接***打印“出现问题”；***.

我的 php 脚本运行良好

PHP代码：

```
<?php
$this->layout = 'ajax';
$this->autoRender = false;
// Some database handling here with no problem...
echo "Plain text with info from database";
?> 
```

Perl代码：

```
#!/usr/local/bin/perl
require LWP::UserAgent;
require HTTP::Request;
my $request = HTTP::Request->new(GET => $url);
my $userAgent = LWP::UserAgent->new;
$userAgent->timeout(3);
$userAgent->env_proxy;
my $response = $userAgent->request($request);
if ($response->is_success) {
    print "Success!\n";
    #should print plain text AS IS
}
else {
    print "something went wrong...\n";
    die $response->status_line;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:49:49.960

检查后`$response->is_success`，你应该可以只取返回值

```
$response->decoded_content 
```

并以您认为合适的方式处理它。

# shopify - 在 Shopify 中自动标记客户

> ID：12411023
> 
> 赞同：0
> 
> 时间：2012-09-13T16:45:36.970
> 
> 标签：shopify

我似乎找不到任何关于是否可以使用 Liquid 或 Shopify API 将标签分配给登录客户的文档。

我知道我可以手动将标签添加到现有客户，但我真的希望有一种更有效的方法来解决它 - 例如创建一个按钮/链接，将特定客户标签分配给已登录客户的客户资料他们点击它 - 可以这么说，让他们标记自己。

我知道`{% assign %}`Liquid 中有这个功能，但它似乎无法影响诸如`{{ customer.tags }}`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:27:58.543

似乎很容易。如果客户选择标记自己，请将标签发送到您的应用程序，您可以在其中使用 API 更新客户标签。您可以为此使用 Ajax。检查控制台...我很快在客户身上设置了一些标签，假设电话到达时带有标签，一切正常。

```
c = Customer.first
=> #<ShopifyAPI::Customer:0x000001012dafa8 @attributes={"accepts_marketing"=>true, "created_at"=>"2012-06-08T22:15:47-04:00", "email"=>"ding@dong.com", "first_name"=>"d", "id"=>92898480, "last_name"=>"dong", "last_order_id"=>nil, "note"=>nil, "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "updated_at"=>"2012-06-08T22:21:22-04:00", "tags"=>"", "last_order_name"=>nil, "addresses"=>[#<ShopifyAPI::Address:0x000001012d77b8 @attributes={"address1"=>"1330 14th Street", "address2"=>"", "city"=>"Santa Monica", "company"=>"dong incorporated", "country"=>"Canada", "first_name"=>"d", "id"=>128540200, "last_name"=>"dong", "phone"=>"3103950840", "province"=>"", "zip"=>"90404", "name"=>"d dong", "province_code"=>nil, "country_code"=>"CA", "default"=>true}, prefix_options{}, persistedfalse]}, prefix_options{}, persistedtrue

>> c.tags = "Holy Roller, Vagrant Snafu"
=> "Holy Roller, Vagrant Snafu"
>> c.save!
=> true
>> c = Customer.first
=> #<ShopifyAPI::Customer:0x00000101339968 @attributes={"accepts_marketing"=>true, "created_at"=>"2012-06-08T22:15:47-04:00", "email"=>"ding@dong.com", "first_name"=>"d", "id"=>92898480, "last_name"=>"dong", "last_order_id"=>nil, "note"=>nil, "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "updated_at"=>"2012-09-13T14:23:39-04:00", "tags"=>"Holy Roller, Vagrant Snafu", "last_order_name"=>nil, "addresses"=>[#<ShopifyAPI::Address:0x000001013372d0 @attributes={"address1"=>"1330 14th Street", "address2"=>"", "city"=>"Santa Monica", "company"=>"dong incorporated", "country"=>"Canada", "first_name"=>"d", "id"=>128540200, "last_name"=>"dong", "phone"=>"3103950840", "province"=>"", "zip"=>"90404", "name"=>"d dong", "province_code"=>nil, "country_code"=>"CA", "default"=>true}, prefix_options{}, persistedfalse]}, prefix_options{}, persistedtrue
>> c.tags
=> "Holy Roller, Vagrant Snafu" 
```

因此，您似乎可以很快设置一些东西来让客户标记自己。

# java - 按下硬件菜单时不显示选项

> ID：12411029
> 
> 赞同：0
> 
> 时间：2012-09-13T16:46:05.677
> 
> 标签：java, android

我有 2 台设备在测试我的应用程序，一台 Galaxy Nexus 和一台 Desire HD（有硬件按钮）

我正在实现这样的菜单

```
@Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case R.id.feedback:

                Intent i = new Intent(Intent.ACTION_SEND);
                i.setType("message/rfc822");
                i.putExtra(Intent.EXTRA_EMAIL  , new String[]{"test@gmail.com"});
                i.putExtra(Intent.EXTRA_SUBJECT, " feedback");
                i.putExtra(Intent.EXTRA_TEXT   , "");
                try {
                    startActivity(Intent.createChooser(i, "Send mail..."));
                } catch (android.content.ActivityNotFoundException ex) {
                    Toast.makeText(MainActivity.this, "There are no email clients installed.", Toast.LENGTH_SHORT).show();
                }
                return true;
            case R.id.about:
                Toast.makeText(MainActivity.this, "There are no email clients installed.", Toast.LENGTH_SHORT).show();
                return true;
            default:
                return true;
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    } 
```

在 Galaxy nexus 上，操作栏菜单按钮出现，它使菜单膨胀，一切正常。在操作栏中的 Desire HD 上，菜单按钮不显示，因为我有硬件按钮，但如果我按下硬件菜单按钮，则没有任何反应。

我怎样才能解决这个问题？

编辑：这是我的 xml

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/feedback"
          android:icon="@drawable/ic_launcher"
          android:title="Feedback"
          android:showAsAction="never"/>
    <item android:id="@+id/about"
          android:icon="@drawable/ic_launcher"
          android:title="About" />
</menu> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:03:22.577

> 我可以对其进行硬编码以执行默认操作吗？

我仍然不确定为什么会发生这种情况，但这里是如何拦截菜单按钮并打开菜单。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if(keyCode == KeyEvent.KEYCODE_MENU) {
        openOptionsMenu();
        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

# php - 如何使这个 preg_match 不区分大小写？

> ID：12411037
> 
> 赞同：67
> 
> 时间：2012-09-13T16:46:46.013
> 
> 标签：php, regex

考虑：

```
preg_match("#(.{100}$keywords.{100})#", strip_tags($description), $matches); 
```

我试图在每边只显示 100 个字符，中间是搜索字符串。

此代码确实有效，但区分大小写。如何使它不区分大小写？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-09-13T16:48:31.083

只需**`i`**在分隔符后添加修饰符`#`：

```
preg_match("#(.{100}$keywords.{100})#i", strip_tags($description), $matches); 
```

如果**`i`**设置了修饰符，则模式中的字母匹配大小写字母。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-08-13T02:27:36.680

另外一个选项：

```
<?php
$n = preg_match('/(?i)we/', 'Wednesday');
echo $n; 
```

[https://php.net/regexp.reference.internal-options](https://php.net/regexp.reference.internal-options)

# java - Maven scm:add 给出错误

> ID：12411040
> 
> 赞同：1
> 
> 时间：2012-09-13T16:46:50.240
> 
> 标签：java, svn, maven, plugins, commit

我尝试在 SVN 中提交一些由 maven 生成的文件。

```
scm:add -Dmessage="Database SQL's hinzugefuegt" -Dincludes="./src/main/resources/database.sql" 
```

我收到以下错误

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-scm-plugin:1.8:add (default-cli) on project GEM: Cannot run add command : Exception while executing SCM command. You must provide at least one file/directory to add -> [Help 1] 
```

问题出在哪里？

* * *

编辑：我改变了目录`-Dincludes="${base.dir}/src/main/resources/database.sql"`

现在我得到这个错误：

```
Server certificate verification failed: issuer is not trusted (https://svn.msg.de) 
```

我在[这里](https://stackoverflow.com/questions/3147660/server-certificate-verification-failed-issuer-is-not-trusted "这里")找到了 一个解决方案，但我对服务器没有权限。我只能配置詹金斯。也许你知道我如何嵌入**`--trust-server-cert`**到我的插件中

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-13T17:05:08.320

从 Maven`scm` [页面](http://maven.apache.org/scm/plugins/usage.html)：

> **这些文件应由外部 scm 客户端预先添加。**

这意味着您需要在执行命令之前执行任`svn add`一命令或打开 tortoise SVN（或等效项）并单击`Add`（参见屏幕截图）`mvn scm:add`。

![在此处输入图像描述](../Images/09242032f0a95cfc1d1179c35ef0c451.png)

# vim - 切换到 Vim 时如何将窗口指定为最大高度？

> ID：12411042
> 
> 赞同：0
> 
> 时间：2012-09-13T16:47:13.970
> 
> 标签：vim, keyboard-shortcuts

现在，当我打开一个新窗口时，我会这样做`<ctrl> w n`，然后用`<ctrl> w _`.

同样，在切换窗口时，我会一直这样做`<ctrl> w <arrow-key>`，直到获得所需的窗口，然后`<ctrl> w _`再次将其设置为最大尺寸。

当我切换到它时，如何使窗口始终调整到最大高度？有没有更好的方法或更好的击键集来完成我的要求？

我对 Vim 还很陌生，因此感谢您提供任何帮助和建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:53:32.410

您要求所谓的*Rolodex 模式*：

```
:autocmd VimEnter * set winheight=999 
```

这使得当前窗口占据了大部分屏幕。有关详细信息，请参阅`:help 'winheight'`

# javascript - 扩展 Ext.data.NodeInterface

> ID：12411043
> 
> 赞同：0
> 
> 时间：2012-09-13T16:47:15.607
> 
> 标签：javascript, class, extjs4, prototypal-inheritance

我想在树面板中添加一个自定义对象作为树节点。它将被用作

```
var complex_object = {....}
myTree.getRootNode().appendChild(new MyNode(complex_object)); 
```

为了实现这样的功能，我发现`Ext.data.NodeInterface`它为树节点提供了一个通用接口。所以我试图扩展它。这是它的完成方式。

```
var MYNS = {
       TreeNode: new Ext.Class({
        protocol : "",
        displayName : "",
        extend: 'Ext.data.NodeInterface',
        constructor : function(line) {
            this.protocol = get_protocol(line);
            this.displayName = get_display_name(line);
            var configObj = {
                id : this.protocol + "-" + this.displayName,
                text : this.displayName,
                leaf : true,
                iconCls : protocol+"-user"
            };
            this.callParent([configObj]);
        }
    })
} 
```

事实证明，这不会创建任何扩展类`Ext.data.NodeInterface`. 但是，它创建的对象 bud 无法从其父项中发挥作用。

```
 var a = new MYNS.TreeNode(...);
 a.appendChild(); // throws error 
```

我做错了吗？如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:55:48.740

`Ext.data.NodeInterface``Ext.data.Model`是一个“工厂”，用于用所需的属性/功能装饰类的原型。

> 此类用作一组方法，应用于模型的原型，以使用 Node API 来装饰它。这意味着与树一起使用的模型将具有模型上可用的所有与树相关的方法。

这是你将如何使用它：

```
Ext.define('app.MyModel', {
    extend: 'Ext.data.Model',

    fields: [ /*...*/ ],

    /*...*/
});

Ext.data.NodeInterface.decorate('app.MyModel'); // String will be resolved to Class object internally

var obj = Ext.ModelManager.create(parent, 'app.MyModel');
obj.appendChild(/*...*/); 
```

中心方法是`Ext.data.NodeInterface#decorate`- 请参阅[文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.NodeInterface-static-method-decorate)- 它在内部促进`#getPrototypeBody`。这些都是静态方法。您可以覆盖`getPrototypeBody`以操纵类定义。对于其他 Ext 类来获取更改，您宁愿**重写** `Ext.data.NodeInterface`而不是**扩展**它。

**但是，另一种方法是通过扩展`Ext.data.Model`**来添加所需的功能- 这实际上可能是满足您要求的更直接的方法。

# synchronization - Microsoft Sync for Ado.Net - 效率，如何提高？

> ID：12411045
> 
> 赞同：1
> 
> 时间：2012-09-13T16:47:16.040
> 
> 标签：synchronization, compact-framework, microsoft-sync-framework

今天我终于设法运行客户端（Windows移动设备） - wcf - sql server 2008同步（经过很多问题，主要是MS部分）

我做了测试。对于 24 000 条记录，快照的平均时间大约需要 1 分 20 秒。这是我下载 Microsoft Sync for ADO.NET 修复程序之后的时间。

我还发现，50 秒后，数据库文件终于开始增长，大约需要 25 秒。

框架在前 50 秒内做什么？加载和序列化数据？

在某些页面上，我找到了关于代理序列化的文章，它可以减少传输的数据量。

您知道同步过程是否会从中受益吗？（我的意思是在修补程序后用于 Ado.net 的 MS Sync？）

我能做些什么来加快这个过程吗？在我看来 24000 的 1:24 是两倍多...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:06:10.580

设备的同步框架有两个主要问题：

1.  它通过 ADO.NET 数据集交换数据
2.  在客户端设置客户端数据库以支持“初始”同步时需要大量开销。
3.  SQL CE 在插入时非常慢。

您提到的热修复尽可能地解决了＃3，因此您无能为力。

数字 2 是同步框架的一部分，恐怕没有什么可做的。

至于 #1，这就是 50 秒中的大部分时间（可能是 30 秒左右？）被使用的地方：当客户端收到数据集时，它必须在之前反序列化整个流（其中流由极其冗长的 XML 组成）可以开始处理。对于大型数据集（超过 10,000 行），这可能需要很长时间，并且一旦可用堆内存被最大化，甚至可能（并且最终）会导致 Memory Crunch 场景。

您引用的序列化代理方法将大大减少正在交换的响应流的大小（在我的测试中，在某些情况下它几乎小了 90%）。这肯定会在一定程度上缩短响应时间，尤其是在网络连接吞吐量有限的情况下。但是，在一天结束时，您无法绕过这样一个事实，即必须先将流反序列化为 DataSet，然后才能开始客户端处理。

总而言之：是的，代理序列化方法将减少正在传输的数据量，并且您可能会实现一些改进，但多少将取决于以下因素：

*   数据集的大小
*   可用设备内存量
*   设备处理器速度和可用性

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T01:41:40.070

同步时会发生三件事：1\. 它需要枚举已发生的更改

1.  它需要将其发送到目的地

2.  它需要应用它

对于枚举，数据库的大小会有很大的影响。即使没有更改，您也会为此检查带来一些性能损失。

请参阅：[用于设备的 ADO .NET 的同步服务：通过跳过不需要同步的表来提高性能](http://blogs.msdn.com/b/sync/archive/2011/03/02/synchronization-services-for-ado-net-for-devices-improving-performance-by-skipping-tables-that-don-t-need-synchronization.aspx)

对于项目 #2，数据集序列化是瓶颈。您可能会选择使用数据集代理甚至压缩，但是您会在执行代理和压缩时受到打击，您可能看不到巨大的性能改进。

请参阅：[同步框架基于 WCF 的离线场景同步 - 使用自定义数据集序列化](http://jtabadero.wordpress.com/2010/03/08/sync-framework-wcf-based-synchronization-for-offline-scenario-%E2%80%93-using-custom-dataset-serialization/)

对于第 1 项和第 2 项，您可以应用与数据库相同的性能调整，例如通过过滤、调整索引等仅同步您需要的行...

毕竟，Sync Fx 应用程序就像任何其他数据库应用程序一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:56:26.960

如果您使用的是 SyncFx 2.1 库（SynchOrchestrator 不是 SyncAgent），那么 SyncFx 将已经在使用 DataSet Surrogate 序列化 - 它是内置的。

为避免与 DataSet 相关的内存不足问题，您可以查看批处理以找到限制每次同步可以发送的记录数的方法。这可以在某种程度上使用任一 SyncFx 库来完成，但 2.1 库比 1.0 库更具确定性*。

> *确定性：2.1 库允许您指定最大字节数，SyncFx 将在适合该限制的最后一个完整行自动切断内容。我相信，对于 1.0 库，进行批处理的唯一方法是指定最大行数，并希望（或仔细计算）数据不会超过您想要达到的限制。

# powershell - 通过 PowerShell 远程连接到 Exchange 服务器时出错

> ID：12411046
> 
> 赞同：1
> 
> 时间：2012-09-13T16:47:24.080
> 
> 标签：powershell, exchange-server, powershell-2.0, powershell-remoting

我正在尝试使用 PowerShell 远程连接到我的 Exchange 服务器。Exchange 服务器位于其自己的专用 Exchange 林中。我正在尝试在没有 Exchange 服务器的林中打开连接。

这就是我的 PowerShell 脚本中的内容：

```
$powershell_url = "http://exhange_server_url.com/PowerShell/"
$session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri $powershell_url -Authentication Kerberos 
```

当我运行这个脚本时，我得到这个错误：

> [exhange_server_url.com] 连接到远程服务器失败并显示以下错误消息：WinRM 客户端无法处理请求。服务器不支持客户端请求的身份验证机制，或者在服务配置中禁用了未加密的流量。验证服务配置中的未加密流量设置或指定服务器支持的身份验证机制之一。要使用 Kerberos，请将计算机名称指定为远程目标。还要验证客户端计算机和目标计算机是否已加入域。要使用 Basic，请将计算机名称指定为远程目标，指定 Basic 身份验证并提供用户名和密码。服务器报告的可能的身份验证机制：有关更多信息，请参阅 about_Remote_Troubleshooting 帮助主题。+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportExc eption + FullyQualifiedErrorId : PSSessionOpenFailed

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:54:00.510

您是否确保您的帐户已启用远程交换？

这是一个了解更多信息的网站：[Technet 文章](http://technet.microsoft.com/en-us/library/dd298084.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T19:03:21.113

这就是我最终做的事情：

```
$credentials = new-object -typename System.Management.Automation.PSCredential -argumentlist "DOMAIN\Administrator","password"
#connect with remote cas server
$powershell_url = "http://cas-server/PowerShell/"
$session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri $powershell_url  -credential $credentials -Authentication Kerberos 
```

# codeigniter - codeigniter - APPPATH 在控制器之后返回路径

> ID：12411047
> 
> 赞同：1
> 
> 时间：2012-09-13T16:47:25.620
> 
> 标签：codeigniter

我在整理应用程序中的路径时遇到问题。

我正在使用 APPPATH 函数在我的数据库中读取/写入图像的字符串路径。问题是APPPATH将功能放在控制器之后

这是我获取CSS的功能

```
<link rel="stylesheet" type="text/css" href="<?php echo '../' . APPPATH.'_data/css/style.css'; ?>" /> 
```

当我去`http://localhost/project/index.php/home`它的工作伟大的CSS链接到`http://localhost/project/application/_data/css/style.css`哪个是正确的

但后来我有了另一个控制器

```
http://localhost/project/index.php/member/index/1 
```

css 文件路径必须是

```
href="<?php echo '../../../' . APPPATH."_data/css/style.css"; ?>" 
```

因为否则我到 css 的链接去

```
http://localhost/project/index.php/member/application/_data/css/style.css 
```

我正在使用一个简单的模板结构，其中我的页眉/内容/页脚位于视图的包含子文件夹中，并且我正在向内容发送数据。很标准的东西。我只是不明白为什么 APPPATH 不起作用，就好像在调用它时它给了我到 APPLICATION 文件夹的 PATH，而不管使用的类是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:09:24.980

`APPPATH`真的是系统文件，而不是前端资产。它是您的应用程序文件夹的路径，这就是它的用途。`../relative/paths`很少在 Codeigniter 中很好地工作，因为它们是相对于当前 URL（而不是视图文件）的。这真的是你陷入的一团糟。

简单的解决方案是`base_url()`改用，但如果你想要更短的路径，这就是我使用的：

```
define('BASE_URI', str_replace('index.php', '', $_SERVER['SCRIPT_NAME'])); 
```

在大多数情况下，结果将为`/`，但这将说明子目录中的 CI 安装。对你来说，它应该返回`/project/`。

不建议将 CSS 和图像等静态文件混合到应用程序文件中。大多数人创建一个名为`assets`or的目录`public`来存储它们。

```
<link rel="stylesheet" href="<?php echo BASE_URI.'public/css/style.css'; ?>" />
<link rel="stylesheet" href="<?php echo base_url().'assets/css/style.css'; ?>" /> 
```

如果您确实需要将资产存储在您的应用程序文件夹中，那么只需删除所有相对路径。您不需要它们，因为它们`APPPATH`是绝对的：

```
<link rel="stylesheet" href="<?php echo APPPATH.'_data/css/style.css'; ?>" /> 
```

这应该在任何地方都有效。

# c# - 由于编组托管委托而导致内存泄漏？

> ID：12411048
> 
> 赞同：1
> 
> 时间：2012-09-13T16:47:26.247
> 
> 标签：c#, c++

我似乎在一些已经生产一段时间的代码中遇到了内存泄漏（我看到我的进程在 PerfMon 中的 Process\Private Bytes 计数器随着时间的推移而上升）。请注意，除了泄漏之外，代码可以正常工作。似乎负责的代码如下（如果我删除处理传递给非托管代码的委托的代码，泄漏就会消失）：

```
private MyDelegate _myDelegate = null;
private GCHandle _myHandle;

public MyClass()
{
    _myDelegate = new MyDelegate(target);
    _myHandle = GCHandle.Alloc(_myDelegate);

    if (NativeCalls.UnmanagedFunctionCall(_myDelegate))
    {
        ...
    }
}

public void Dispose()
{
    GC.SuppressFinalize(this);
    Dispose(true);
}

~MyClass()
{
    Dispose(false);
}

protected void Dispose(bool disposing)
{
    ...
    if (_myHandle.IsAllocated)
    {
        _myHandle.Free();
    }
    ...
}

.... 
```

测试代码只是在循环中创建和处置 MyClass 的实例。

所以基本上我们有一个委托，我们在类构造函数中传递给非托管代码，我们包装在一个 GCHandle 中以防止它被过早收集并在非托管代码尝试使用它时导致某种访问冲突。使用 WinDbg 并在进程开始之后比较堆的快照时，我可以看到一个正在上升。我最终追查到：

```
0:005> !heap -p -a 0bd779c8
address 0bd779c8 found in
_HEAP @ 400000
  HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
    0bd779a0 000c 0000  [00]   0bd779c8    00024 - (busy)
    Trace: 09c3
    59aba6a7 verifier!AVrfpDphNormalHeapAllocate+0x000000d7
    59ab8f6e verifier!AVrfDebugPageHeapAllocate+0x0000030e
    77260d06 ntdll!RtlDebugAllocateHeap+0x00000030
    7721ae7e ntdll!RtlpAllocateHeap+0x000000c4
    771c3cee ntdll!RtlAllocateHeap+0x0000023a
    59accb62 verifier!AVrfpRtlAllocateHeap+0x00000092
    7004691a clr!EEHeapAlloc+0x000000cb
    70047f46 clr!CExecutionEngine::ClrHeapAlloc+0x0000004a
    70047f15 clr!ClrHeapAlloc+0x00000023
    7004fd84 clr!operator new+0x00000038
    701392d1 clr!UMEntryThunk::CreateUMEntryThunk+0x0000000f
    70139473 clr!MarshalNative::GetFunctionPointerForDelegateInternal+0x000000d6
    6acd8448 mscorlib_ni+0x00238448 
```

在我看来，当调用 GetFunctionPointerForDelegateInternal() 并且它没有被释放时正在发生分配，因此托管委托对象可能永远不会被垃圾收集，因此我的泄漏？但是我正在释放我的 GCHandle，所以我在这里缺少什么？

注意：我什至尝试清空我的非托管调用，所以基本上它什么都不做，并且泄漏仍然发生，这告诉我托管方面有问题。

更新：我接受了删除对 Marshal.GetFunctionPointerForDelegate() 的调用并更改我的 p/invoke 以直接传递委托并让编组器为我处理它的建议，但是泄漏仍然发生。

更新：我更新了 Dispose() 代码，我原来的帖子有一些错别字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:54:17.717

只需使用委托参数而不是`IntPtr`. marshaler 会为你做所有这些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:57:40.520

据我所知，**委托**是 C# 中的函数指针列表。将它传递给 C++ 中的函数指针参数让我觉得会有问题。您应该考虑添加一个本机函数来报告状态并将这个函数汇集在 C# 中的单独线程或后台工作程序中。这样您就不再需要传递委托了。

# ruby-on-rails-3 - 以自定义形式渲染：部分来自 DB 的随机对象

> ID：12411052
> 
> 赞同：0
> 
> 时间：2012-09-13T16:47:45.067
> 
> 标签：ruby-on-rails-3, partial-views

我正在尝试从数据库中渲染一个随机对象。步骤：1\. `generate button`（主页）-> 2.调用`rand_task`（控制器）-> 3\. `_rand_show.html.erb`（表单）

问题：它现在崩溃了，但有一次它起作用了。（我知道在编码中没有这样的事情，但我无法看到问题......）主要：

```
<%= form_for(:task, :url => {:action =>'rand_task', :id => 'random'}) do |f|%>
<%= render(:partial => "rand_show", :locals => {:f => f}) %></p> 
<%end%> 
```

控制器：

```
def rand_task
  @task = Task.order('RANDOM()').first
end 
```

形式：

```
<%= form_for(@task) do |f| %>
  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name, :disabled=>true %>

  <div class="field">
    <%= f.label :category %><br />
    <%= f.text_field :category, :disabled=>true %>
  </div>
  <div class="actions">
    <%= f.submit "generate"%>
  </div>
<% end %> 
```

服务器：

```
Started GET "/" for 127.0.0.1 at 2012-09-13 19:35:56 +0300
Processing by TasksController#main as HTML
  Rendered tasks/_rand_show.html.erb (0.8ms)
  Rendered tasks/main.html.erb within layouts/application (1.6ms)
Completed 500 Internal Server Error in 4ms

ActionView::Template::Error (undefined method `model_name' for NilClass:Class):
    1: <%= form_for(@task) do |f| %>
    2:   <div class="field">
    3:     <%= f.label :name %><br />
    4:     <%= f.text_field :name, :disabled=>true %>
  app/views/tasks/_rand_show.html.erb:1:in `_app_views_tasks__rand_show_html_erb__183960888__627313568'
  app/views/tasks/main.html.erb:2:in `block in _app_views_tasks_main_html_erb__298912262__627495408'
  app/views/tasks/main.html.erb:1:in `_app_views_tasks_main_html_erb__298912262__627495408' 
```

**如果我放置一个`<%= form_for(@task _=Task.new_ ) do |f| %>`而不是删除它，它会起作用，但仅适用于一次**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:54:08.987

这个错误告诉你 @task 对象在这种情况下是 nil 。您需要确保“任务”表中有记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:14:19.357

已修复：对于要访问的局部变量，在我的情况下，您需要将表添加到 config/routes.rb`resources :tasks`

编辑：服务器重启后问题仍然存在。

# c# - C#.NET，回发发生在事件处理程序执行之前？

> ID：12411058
> 
> 赞同：1
> 
> 时间：2012-09-13T16:48:03.320
> 
> 标签：c#, asp.net, sql

在我的网页中，我有一个在 Page_Load 方法中创建的 gridview，它从数据库表中检索一些值。我还有一个按钮，单击该按钮会导致事件处理程序从表中添加/删除行。目前，当我按下按钮时，事件处理程序会运行，但在发生另一个回发之前，gridview 不会更新。

对我来说，这似乎意味着回发发生在事件处理程序执行之前。它是否正确？如果是这样，我怎样才能使按下按钮更新表格，然后重新加载gridview？我想我可以在事件处理程序中重新创建 gridview 数据源，但这似乎是解决问题的一种非常低效的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:49:32.597

那是对的。`Control Events`事后处理`Page Load`。

查看有关来自 MSDN的[文档。](http://msdn.microsoft.com/en-us/library/ms178472%28v=vs.100%29.aspx)`Page Lifecycle`

有助于您理解这一点的方法是在`Page_Load`方法和`Button Click`事件处理程序的代码中设置断点，然后单击按钮并查看每个断点何时被命中。

对于您的`Gridview`，您必须再次调用您的绑定代码，以便在回发后显示您的更改。最好的方法是使用绑定代码创建一个方法，并从事件处理程序中调用它。

# html - HTML 5 视频支持

> ID：12411059
> 
> 赞同：0
> 
> 时间：2012-09-13T16:48:13.823
> 
> 标签：html, web, html5-video

我希望用户上传视频，然后我想使用 HTML 5 显示它们，但它们不能在 Mozilla & Opera & IE 中工作，而且我也不能在线将视频转换为不同的格式，所以我该如何继续。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:50:52.423

我建议您使用为您处理渲染的 API。我使用[mediaelementjs](http://mediaelementjs.com/)，并取得了巨大的成功。

就使用的格式而言，在浏览器和设备支持下，这里有一个很好的细分：

[http://mediaelementjs.com/](http://mediaelementjs.com/)

基本上 h.264 应该是你所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:56:20.463

您可以下载和安装许多视频转换器。我最成功的一个是手刹，尽管它们都运作良好。我唯一遇到的问题是 IE，当然，哪个手刹似乎可以解决……直到昨晚我用手刹转换了一个视频，但在 IE 中不起作用。

但是您必须将视频转换为正确的格式才能在网络上播放。在那之后，你应该对任何浏览器都没有问题，除了如预期的那样，IE 似乎需要一些似乎没有人拥有的魔法仙尘。

# android - setadapter 后获取 ListView 高度

> ID：12411060
> 
> 赞同：4
> 
> 时间：2012-09-13T16:48:16.923
> 
> 标签：android, android-listview

好吧，我试图在更改数据后获取我的列表视图高度，但它总是返回先前的高度，而不是实际高度。

因此，当我设置 setadapter 时，它会获得旧值。例如：

```
 ActualHeight = 100
 Change data (filter) -> NewHeight = 60
 ListView.GetHeight still returns 100.

 Again

 ActualHeight = 60
 Change data (filter) -> NewHeight = 20
 ListView.GetHeight still returns 60. 
```

我正在使用的代码是：

```
 int width, height = 0;

                    EditText edt_search;
                    ListView lv_marca;

                    List<Marca>  list_marca        = new ArrayList<Marca>();
                    List<Marca>  list_marca_search = new ArrayList<Marca>();

                    String text = edt_search.getText().toString(); 

                    list_marca_search.clear();

                    if(text.startsWith(".")){
                        text = text.replace(".", "");
                        for (Marca m : list_marca) {
                            if (String.valueOf(m.getCd_marca()).equals(text)){
                                list_marca_search.add(m);
                            }
                        }
                    } else {
                        for (Marca m : lista_marca) {
                            if (m.getDs_marca().contains(text)){
                                list_marca_search.add(m);
                            }
                        }
                    }

                    ArrayAdapter<Marca> adapter_marca = new CustomAdapter_Marca(MyDialog.this, R.layout.layout_consulta_estoque_marca_lista, list_marca_search);

                    lv_marca.setAdapter(adapter_marca);

                    int height_window  = getWindowManager().getDefaultDisplay().getHeight();
                    height             = lv_marca.getHeight() + getSupportActionBar().getHeight();

                    if (height >= height_window) {
                        height = (int) (height_window * 0.95);
                    }

                    getWindow().setLayout(width, height); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-14T11:28:54.397

好的，我找到了解决方案。

当我在 ListView 中更改 SetAdapter 时，我得到表示一行的测量高度，并乘以行号加上分隔线高度也乘以行号。

这是我如何做的一个例子，我不知道是否是更好的方法，但它完美无缺^^：

```
 ListView lv_marca; 

    lv_marca.setAdapter(adapter_marca);

    int list_height = getListViewHeight(lv_marca);

    private int getListViewHeight(ListView list) {
          ListAdapter adapter = list.getAdapter();

          int listviewHeight = 0;

          list.measure(MeasureSpec.makeMeasureSpec(MeasureSpec.UNSPECIFIED, MeasureSpec.UNSPECIFIED), 
                       MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));

          listviewHeight = list.getMeasuredHeight() * adapter.getCount() + (adapter.getCount() * list.getDividerHeight());

          return listviewHeight;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:20:18.623

您必须`OnHierarchyChangeListener`在列表视图中添加一个，以便在将子项添加到列表或从列表中删除时获得列表视图的新高度值：

```
lv_marca.setOnHierarchyChangeListener(new ViewGroup.OnHierarchyChangeListener() 
{
    @Override
    public void onChildViewRemoved(View parent, View child) 
    {
        // This will give you the height when your new adapter contains 
        // lesser number of items than the previous one
        int heightAfterItemRemoved=parent.getHeight();
        Log.i("list_view_height_change","Height after removing item : "+heightAfterItemRemoved);
    }

    @Override
    public void onChildViewAdded(View parent, View child) 
    {
        // This will give you the height when your new adapter contains 
        // greater number of items than the previous one
        int heightAfterItemAdded=parent.getHeight();
        Log.i("list_view_height_change","Height after adding item : "+heightAfterItemAdded);                
    }
}); 
```

有一个问题 - 这仅在您的列表视图的“layout_height”属性设置为“wrap_content”时才有效。在这种情况下，列表视图的高度会随着项目的添加或删除而增加或减少。当列表视图被完全填满时，列表视图的高度达到最大值。如果您向列表视图添加更多项目，它将溢出并可以滚动，但高度值不会改变，因为它已经占据了其父视图中的最大允许高度。

如果您将 'layout_height' 设置为 'fill_parent' 或 'match_parent'，则列表视图将从一开始就占据其父视图中允许的最大高度，因此，向其中删除或添加项目不会导致其高度发生任何变化.

# c - 如何将返回码传递给 at_exit 函数

> ID：12411062
> 
> 赞同：2
> 
> 时间：2012-09-13T16:48:18.513
> 
> 标签：c, linux, exit, glibc, exit-code

是否有一种“内置”方法可以知道传递给`exit`安装的退出处理程序内部的退出代码`atexit`？

例如，如果调用`exit(EXIT_FAILURE)`，我的处理程序将执行与调用不同的操作`exit(EXIT_SUCCESS)`。

我可以用一个全局变量来解决这个问题，但这会否定`exit`在我的程序中无论在哪里调用的舒适性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:53:52.287

`atexit`没有。但是您可以使用以下[`on_exit`](http://www.gnu.org/software/libc/manual/html_mono/libc.html#Cleanups-on-Exit)功能：

> 函数：int on_exit (void (*function)(int status, void *arg), void *arg)
> 
> 这个函数是atexit 的一个更强大的变体。它接受两个参数，一个函数函数和一个任意指针 arg。在正常程序终止时，使用两个参数调用该函数：传递给 exit 的状态值和 arg。
> 
> 此函数包含在 GNU C 库中只是为了与 SunOS 兼容，其他实现可能不支持。

好吧，你必须使用 gnu libc ...

# jquery - 如何通过类名查找元素

> ID：12411064
> 
> 赞同：0
> 
> 时间：2012-09-13T16:48:22.617
> 
> 标签：jquery

我正在尝试做一个循环来使用类选择器检查所有元素。

我有

html

```
<div class='label'>aaaa</div>
<div class='label'>bbbb</div>
<div class='label'>cccc</div>
<div class='label'>dddd</div>

 var pre=$('.label')

    pre.each(function(e){
        console.log(e);
    }) 
```

但它不显示元素（aaaa，bbbb ..等）。

我该怎么做呢？非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:48:57.960

```
var pre = $('.label');

pre.each(function(i, el){
    console.log( el );
    // OR
    console.log( this ); // will give you the element

    // suppose to get text
    console.log( $(el).text() ); // or $(this).text()
}); 
```

***[演示](http://jsfiddle.net/WYAS4/2/)***

`.each()`is的第一个参数`index`和第二个参数是`value` *(here your target element)*。

阅读更多关于***[`.each()`](http://api.jquery.com/each)***.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:51:17.790

为了回答，`.each`jQuery中的方法在调用时传递了两个值（在上下文中）：

```
.each(function(index,value){
}); 
```

所以我只`e`在你的每个函数中提供你只要求索引参数。您需要提供两个参数来获取实际的元素或值。

但是，当迭代元素时，交互函数的上下文也会传递给元素。所以：

```
$('.label').each(function(index,element){
  // element == this
}); 
```

因此，如果您不想提供第二个参数，您可以`this`在函数中引用。

# javascript - d3.js les miserables 矩阵不显示

> ID：12411069
> 
> 赞同：1
> 
> 时间：2012-09-13T16:48:48.477
> 
> 标签：javascript, json, d3.js

我让自己有点卡住了，我需要你的帮助...我已经尝试了*les miserables*的示例，其中包含一个[新的 json 文件，用于我在主题检测中正在做的项目，但是使用](https://www.dropbox.com/s/5mdv7jtkw32rnf5/miserables.json)[这个文件](https://www.dropbox.com/s/9sqrik7y66h6v84/miserablesok.json) 时屏幕上什么都没有工作正常！我是 javascript 新手，我似乎无法找到问题所在......如果有人知道为什么矩阵不会显示......

现在我在控制台中看到以下错误：

> 未捕获的类型错误：无法读取未定义的属性“z”

有人知道那是什么意思吗？

# java - 带有调用缺失方法的未调用方法的 Java 编译类

> ID：12411070
> 
> 赞同：0
> 
> 时间：2012-09-13T16:48:50.310
> 
> 标签：java, methods

我必须做一个特定类的补丁，我们称之为 Foo。我修复了这个问题，对其进行了测试，并将编译后的 Foo 类发布到一个补丁文件夹，然后发布到一个 QA 服务器。问题是，我忘记了我对 Foo 中的方法进行了更改。该方法从另一个不在服务器当前版本中的类（称为 Widget）中调用一个新方法。Foo 中的方法当前未在服务器上的代码中的任何位置调用。

概括：

将 Foo 的编译版本发布到服务器，该版本具有未调用的公共方法，该方法调用该服务器上不存在的 Widget 中的方法。

这会破坏什么吗？我在 QA 上测试了代码，一切似乎都很好。

请注意，我知道不建议以这种方式进行修补；我们实际上正在升级项目的构建和部署机制，以避免出现此类问题。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:52:24.403

如果您不调用或尝试加载您的方法（使用反射），则没有理由中断。

*编辑：我完全不确定使用反射实例化方法会破坏某些东西。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:52:10.770

不，它不会破坏任何东西。实际上，有几个框架，你可以只使用其中的一部分，而不包括所有的依赖 jar，它工作得很好。

# android - Eclipse 中的 Android SDK 首选项

> ID：12411071
> 
> 赞同：0
> 
> 时间：2012-09-13T16:48:55.863
> 
> 标签：android, sdk, adt

我最近将我的 android adt 更新到了 adt 20。但我现在面临一个问题。它是说 android sdk 的位置尚未在首选项中设置。我在 android sdk 管理器中更新并安装了许多插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:51:02.547

**窗口 -> 首选项 -> Android -> SDK 位置**

在您的计算机中设置 Android SDK 的路径。

# facebook - 电子邮件活动中的 Facebook 发送按钮

> ID：12411076
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:49:12.720
> 
> 标签：facebook, plugins, social

我正在运行一个电子邮件活动，我想在电子邮件中嵌入一个 facebook 按钮，它使用 facebook 发送功能。这将向他们的朋友发送一个指向基于网络的电子邮件版本的链接。这可能来自电子邮件本身吗？

谢谢汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T09:39:47.443

[发送对话框](https://developers.facebook.com/docs/reference/dialogs/send/)可以直接通过 URL 调用，不需要嵌入任何 JS。

所以这可能是你最好的方法——在你的电子邮件中放一个简单的链接到包含适当参数的对话框（或者如果你发送 HTML 电子邮件，让它成为一个按钮）。然后由用户单击该链接/按钮以在浏览器窗口中打开对话框，如果他们还没有登录 Facebook，然后将消息发送给他们的朋友。

（当使用调用对话框的直接 URL 版本时，您必须提供 redirect_uri 参数 - 只需将其指向您正在发送活动电子邮件的网站，页面显示“感谢您与朋友分享我们的网站“ 或者其他的东西。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:44:41.430

可能不是。当前的发送插件和发送对话框都依赖于 JavaScript。大多数电子邮件客户端不支持 JavaScript。即使邮件客户端确实支持它，他们的防病毒或垃圾邮件过滤器也会破坏您的邮件。

您可以尝试使用旧`sharer.php`方法，但该方法已被弃用一段时间，并且似乎正在被禁用。

# iphone - iOS - 升级到 Xcode 4.5 后出现链接器错误，可能与 Core Plot 相关

> ID：12411077
> 
> 赞同：17
> 
> 时间：2012-09-13T16:49:13.917
> 
> 标签：iphone, ios, xcode, linker, core-plot

我刚刚升级`Xcode 4.5GM`并整理了我的 iPhone 项目中的一些屏幕，以应对 iPhone 5 上额外的屏幕尺寸。该项目的目标是`iOS 5.1`，我刚来为我的手机构建它，我收到了这个链接器错误：

> 文件是通用的（2 个切片），但不包含一个（n）armv7s 切片：/Users/JonathanW/Documents/MyXcode/myApp/myApp/CorePlot/libCorePlot-CocoaTouch.a 用于架构 armv7s

我`Core Plot 1.0`在我的项目中使用静态库，直到现在还没有任何问题。环顾四周，我可以看到与构建体系结构设置有关的类似错误，但不知道从哪里开始。该项目在模拟器中运行良好（`iOS 5.1`和`iOS 6`）。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-13T16:53:26.960

从外观上看，您需要使用 Xcode 4.5GM 重建 libCorePlot 库，以便该库的 ARMV7S 构建。似乎它正在尝试使用您使用旧 Xcode 构建的版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-02T14:53:34.443

我还在我的项目中使用 Core Plot 1.0 静态库。我能够通过将***Build Active Architectures Only***设置为***Yes***来解决这个问题。 *Build Active Architectures Only*位于 Xcode中 Target 的*Build Settings*的*Architecture*部分。

 *我下载了似乎不完整的 Core Plot 1.0 zip 文件，因此我无法重建库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-13T16:57:59.900

它在模拟器中工作，因为模拟器将始终使用 i386 架构。新的 SDK 并没有改变这一点。改变的是 iPhone 5 的出现，它使用了新的架构 (armv7s)。您的应用程序的项目自动将 armv7s 添加为有效架构，但该库可能是在不知情的情况下编译的。因此，您启用 arm7s 的应用程序会尝试链接在没有 armv7s 的情况下构建的库并失败。

要修复它，您只需要访问生成库的项目即可。修改目标上的“有效架构”设置以包含 armv7s，然后重新构建。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-30T16:20:58.483

我已经为此苦苦挣扎了好几天，终于通过创建一个新的静态库成功地让它工作了。

我通过此处的说明使用了 Mercurial 源代码控制系统：[使用 Mecurial 创建静态库](http://plusangel.wordpress.com/2012/02/18/core-plot-and-arc/)和此处找到的 wiki 中的“Core-Plot 静态库安装”：[如何进行 Core-Plot 的静态库安装](http://code.google.com/p/core-plot/wiki/UsingCorePlotInApplications)

我是为像我这样经验不足的人发布的，因为这很简单并且可以自我解释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T16:54:20.543

你做了清洁和重建吗？还要检查架构中是否有 armv6 和 armv7。您可能需要重新编译目标并将库重新添加到目标

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-21T12:15:05.383

将 CorePlot 项目上的编译器从 Apple LLVM Compiler 4.1 切换到 LLVM GCC 4.2

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-04T11:37:01.760

简单地我编译了 core-plot 库并从这个链接[http://code.google.com/p/core-plot/wiki/UsingCorePlotInApplications](http://code.google.com/p/core-plot/wiki/UsingCorePlotInApplications)
安装了依赖项目 ，每件事都像一个魅力（我的项目现在支持 armv7和 armv7s 没有任何问题），此外我仍然将 Build Active Architecture Only 设置为 NO ，以确保支持所有架构

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-13T10:25:51.153

您只需从有效架构列表中删除 armv7s。

只需执行以下操作。- 从项目导航器中选择您的项目 - 从目标列表中选择您的目标 - 选择构建设置选项卡 - 找到“有效架构”设置。它应该说 armv7 armv7s。删除 armv7s，您的有效架构中将只有 armv7。现在您的项目将正确编译。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-22T17:29:56.377

**修复使用 Xcode 5 时 Core Plot 的链接器错误**

我多年来一直在使用 Core Plot，并且收到一堆关于 armv7s 不支持更新的“CorePlotHeader”文件夹中的某些文件的“Apple Mach-O Linker Warning”错误（删除了我项目中当前的文件夹并拖动了新的文件夹到我的项目中）以反映 CorePlot_1.4 的更改。我还删除了旧的“libCorePlot-CocoaTouch.a”库并将其放入我的 Frameworks 文件夹中。在模拟器中一切正常，但我无法在装有 iOS 7.0.2 的 iPad 4 上构建。

这是我发现在调试时唯一有效的东西（在存档等时似乎有效）：

1）做我上面提到的一切，将Build Active Architectures设置为No，然后清理

2) 您可能会收到有关不支持架构“arm64”的错误，因此请从构建设置中的“有效架构”部分中删除“arm64”

3) 调试时右键单击 Products 文件夹中的“MyApp.app”文件，您可能会看到旧的“libCorePlot-CocoaTouch.a”（如果修改日期早于 2013 年 9 月 28 日）与您的应用程序一起编译。

4）删除该库并将新库复制到构建文件夹中，清理然后重建

这适用于“静态库安装”方法，尚未使用“依赖项目安装”方法进行测试

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-23T04:48:48.603

我在 Xcode 4.4 中为 iOS 6.1 使用 Core Plot 1.0 静态库。使用 iOS 7.0 更新到 Xcode 4.5 后，我遇到了与您相同的问题。

为了修复它，我删除了项目中的 CorePlotHeaders 文件夹和 libCorePlot-CocoaTouch.a。如果您在 Xcode 中删除它，请选择“移动到垃圾箱”选项。

[然后我从https://code.google.com/p/core-plot/downloads/list](https://code.google.com/p/core-plot/downloads/list)下载 CorePlot_1.4.zip ，然后我从[https://code.google.com/p/core-](https://code.google.com/p/core-plot/wiki/UsingCorePlotInApplications)遵循静态库安装[情节/维基/UsingCorePlotInApplications](https://code.google.com/p/core-plot/wiki/UsingCorePlotInApplications)

希望能帮助到你*

# visual-studio-2010 - Visual Studio 2012 中的黑白图标

> ID：12411079
> 
> 赞同：4
> 
> 时间：2012-09-13T16:49:28.360
> 
> 标签：visual-studio-2010, visual-studio-2012, windows-forms-designer, toolbox

通常，Visual Studio Toolbox 中控件的图标文件 (ico/bmp/png) 会作为资源文件嵌入到程序集中。System.Windows.Forms.dll 似乎有彩色的图标文件，它们适用于 VS2010 及更低版本。VS2012 从哪里加载工具箱控件的黑白图标？

此外，是否有关于如何为 VS2012 创建这些图标集的指南，因为这些图标在 VS2012 的浅色和深色主题中都应该看起来不错。

谢谢！

-达特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:03:26.160

这并不像为每个颜色主题创建一些图标那么简单。图标实际上是由字形构建的，并且在运行时根据主题调整颜色。查看[Visual Studio Dark Theme](http://blogs.msdn.com/b/visualstudio/archive/2012/05/29/visual-studio-dark-theme.aspx)博客文章，其中团队讨论了主题图标，以了解他们采用的方法。

引用重要的细节：

> 我们所有的 Visual Studio 11 图标都作为矢量图形文件保存在图标存储库中

要回答您可能遇到的后续问题，我不确定矢量图形的存储位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T12:02:12.267

在我寻求[取消使用 Visual Studio](http://vsip.codeplex.com)的过程中，我发现 HTML（MVC 和 Web 窗体）和 Win 窗体的基本工具箱图标作为位图资源存储在许多非托管 DLL 中。WPF 和其他文件主要以 PNG 和 ICO 文件的形式存储在较新的托管 DLL 中。托管资源是直接嵌入文件以及序列化位图、PNG、图标、图像列表流和二进制流的组合。

查看这些文件以获取大多数工具箱图像

```
\Microsoft Visual Studio 11.0\Common7\IDE\1033\Microsoft.VisualStudio.Windows.FormsUI.dll
\Microsoft Visual Studio 11.0\Common7\Packages\htmled.dll

```

至于如何修改颜色，看起来 Visual Studio 将白色替换为黑色，同时将白色/灰色的阴影更改为较暗的对应物，同时保留其余颜色。在过去的几年里，他们在 SDK 中包含了一个样式指南文档。我还没有找到 2012 年的文件，他们的[MSDN 链接](http://msdn.microsoft.com/en-us/library/bb166159%28v=vs.110%29.aspx)仍然指向 2010 年的文档。

# asp.net - 在 ASP.NET 中保存以备后用功能

> ID：12411081
> 
> 赞同：0
> 
> 时间：2012-09-13T16:49:28.500
> 
> 标签：asp.net, database

我想知道将**保存以备后用，添加到工作场所**功能到我的网站的最佳方式。我能想到的唯一方法（我知道）是将项目、媒体和演员的 ID 存储在我的数据库中。每次用户按下 Save 后，将项目的 id 存储在我数据库的新表中。

# javascript - Javascript 数组字面量操作：这行代码是做什么的？

> ID：12411084
> 
> 赞同：3
> 
> 时间：2012-09-13T16:49:34.957
> 
> 标签：javascript, literals

下面一行的目的和结果是什么？

```
var arr = arr || []; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T16:50:38.663

它声明变量“arr”并将其值设置为另一个已经存在的变量（可能在某个外部范围内），除非该变量不是“真实的”，在这种情况下，“arr”被设置为引用一个新的空数组.

因此，如果已经存在的 "arr" 的值是`null`, `0`, `false`, or `""`, or is `undefined`，那么本地 "arr" 将是一个空数组。否则，它将具有与外部“arr”相同的值。

你通常会在这样的情况下看到：

```
var arr;

function whatever() {
  var arr = arr || [];
  ...
} 
```

有时人们会这样做：

```
function questionable( arr ) {
  var arr = arr || []; 
```

在这种情况下，`var`是不必要的。

这一切都有效，因为`||`JavaScript 中的运算符与其他类 C 语言中的表亲明显不同。在 JavaScript 中，`||`表达式的值**并不**强制为布尔值。相反，它是其左侧操作数或右侧操作数的值。它*确实*检查这些值以确定它们是否“真实”，但布尔强制是内部的。如果左边是“truthy”，那么`||`表达式的值就是那个值；否则，它是右侧的值。当左侧是“真实的”时，右侧根本不被评估。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T16:50:56.590

实例化if is ***falsy***`new`的一个实例。`Array``arr`

 ** * *

在 C# 中，这种模式称为“空值合并操作”。如果您熟悉 C#，您将执行以下操作：

```
string foo = bar ?? String.Empty 
```

这是[关于该主题的详尽帖子](https://stackoverflow.com/questions/476436/null-coalescing-operator-for-javascript)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T16:55:17.407

基本上在 Javascript 和其他语言（例如 Perl）中，`||`通常用作短路运算符。如果您有一个变量需要分配 5 个其他变量之一的值，以首先定义的为准，您可以尝试以下操作：

```
a = b || c || d || e || f; 
```

这将评估`b`. 如果它的值为`true`，那么`a`将被赋值`b`，仅此而已。如果`b`发现是`false`，则搜索将传播到`c`。通常需要将变量与自身进行比较以检查是否分配新值。这就是它的`a = a || b`作用。如果是 Perl，您可以将其缩短为`a ||= b`.*

# objective-c - 自定义移动 Facebook 登录按钮？

> ID：12411088
> 
> 赞同：0
> 
> 时间：2012-09-13T16:49:49.377
> 
> 标签：objective-c, ios, facebook

我成功地为 web 定制了登录按钮，但我该如何为 iOS 做呢？我一直在寻找，但找不到任何东西。

我目前正在使用 Facebook SDK 3.0，它实现起来相当容易，但 FBLoginView 按钮的设计却显得很突兀。我正在尝试用一个动画按钮来掩盖它，并向前触摸它背后真正的 Facebook 按钮。

Apple 会在提交后拒绝这种变通方法吗？必须有一个更简单的方法，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:48:56.500

[“如何自定义 FBLoginVIew？”的可能重复项？检查问题和答案](https://stackoverflow.com/questions/12280850/how-to-customize-fbloginview)

据我所知，目前还没有关于 Facebook 登录视图自定义被拒绝的报告

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T12:13:40.653

Yes, you can change it by using below code.

```
 for (id obj in loginview.subviews)
{
    if ([obj isKindOfClass:[UIButton class]])
    {
        UIButton * loginButton =  obj;
        [loginButton setBackgroundColor:[UIColor blueColor]];
        UIImage *loginImage = [UIImage imageNamed:@"facebook_btn~ipad.png"];
        [loginButton setBackgroundImage:loginImage forState:UIControlStateNormal];
        [loginButton setBackgroundImage:nil forState:UIControlStateSelected];
        [loginButton setBackgroundImage:nil forState:UIControlStateHighlighted];
        [loginButton sizeToFit];
    }
    if ([obj isKindOfClass:[UILabel class]])
    {
        UILabel * loginLabel =  obj;
        loginLabel.text = @"Login with facebook";
        loginLabel.textAlignment = NSTextAlignmentCenter;
        loginLabel.frame = CGRectMake(0, 30, 600, 30);
        //loginLabel.text. = [UIFont fontWithName:@"Default" size:30.0];
        [loginLabel setFont:[UIFont boldSystemFontOfSize:27]];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-17T16:37:49.907

请阅读 Facebook SDK 中的 README 文件。您必须在 info.plist 中添加 Row - FacebookBundleName 并将其命名为您的捆绑包。然后，使用此名称将包添加到您的项目并放入名为“lang.lproj”的文件夹中：例如：en.lproj - it.lproj - fr.lproj - es.lproj.... 进入这个文件夹，你必须添加 Localizable.strings 文件，然后您可以本地化很多短语，例如：

```
"FBLV:LogOutButton" = "Log Out";
"FBLV:LogInButton" = "Log In";
"FBLV:LoggedInAs" = "Logged in as: %@";
"FBLV:LoggedInUsingFacebook" = "Logged in using Facebook";
"FBLV:LogOutAction" = "Log Out";
"FBLV:CancelAction" = "Cancel"; 
```

希望对你有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-06T09:34:30.763

```
//Add the normal button then add your own image and tittle and give the action the button and use the below code in the button action.
NSMutableDictionary *fbResultData;
 FBSDKLoginManager *login = [[FBSDKLoginManager alloc] init];
    [login
     logInWithReadPermissions: @[@"public_profile", @"email", @"user_friends"]
     fromViewController:self
     handler:^(FBSDKLoginManagerLoginResult *result, NSError *error) {
         if (error) {
             NSLog(@"Process error");
         } else if (result.isCancelled) {
             NSLog(@"Cancelled");
         } else {
             NSLog(@"Logged in");

             if ([FBSDKAccessToken currentAccessToken])
             {

                 [[[FBSDKGraphRequest alloc] initWithGraphPath:@"me?fields=id,name,age_range,birthday,devices,email,gender,last_name,family,friends,location,picture" parameters:nil]
                  startWithCompletionHandler:^(FBSDKGraphRequestConnection *connection, id result, NSError *error) {
                      if (!error) {

                          NSString * accessToken = [[FBSDKAccessToken currentAccessToken] tokenString];
                          NSLog(@"fetched user:%@ ,%@", result,accessToken);

                          fbResultData =[[NSMutableDictionary alloc]init];

                          if ([result objectForKey:@"email"]) {
                              [fbResultData setObject:[result objectForKey:@"email"] forKey:@"email"];
                          }
                          if ([result objectForKey:@"gender"]) {
                              [fbResultData setObject:[result objectForKey:@"gender"] forKey:@"gender"];
                          }
                          if ([result objectForKey:@"name"]) {
                              NSArray *arrName;
                              arrName=[[result objectForKey:@"name"] componentsSeparatedByString:@" "];

                              [fbResultData setObject:[arrName objectAtIndex:0] forKey:@"name"];
                          }
                          if ([result objectForKey:@"last_name"]) {
                              [fbResultData setObject:[result objectForKey:@"last_name"] forKey:@"last_name"];
                          }
                          if ([result objectForKey:@"id"]) {
                              [fbResultData setObject:[result objectForKey:@"id"] forKey:@"id"];
                          }

                          FBSDKGraphRequest *request = [[FBSDKGraphRequest alloc]
                                                        initWithGraphPath:[NSString stringWithFormat:@"me/picture?type=large&redirect=false"]
                                                        parameters:nil
                                                        HTTPMethod:@"GET"];
                          [request startWithCompletionHandler:^(FBSDKGraphRequestConnection *connection,
                                                                id result,
                                                                NSError *error) {
                              if (!error){

                                  if ([[result objectForKey:@"data"] objectForKey:@"url"]) {
                                      [fbResultData setObject:[[result objectForKey:@"data"] objectForKey:@"url"] forKey:@"picture"];
                                  }

                                  //You get all detail here in fbResultData
                                  NSLog(@"Final data of FB login********%@",fbResultData);

                                  self.fullNameTextField.text = [fbResultData objectForKey:@"name"];
                                  self.lastNameTextField.text = [fbResultData objectForKey:@"last_name"];
                                  [_customFaceBookButton setImage:[UIImage imageNamed:@"fb_connected"] forState:UIControlStateNormal];

                              } }];
                      }
                      else {
                          NSLog(@"result: %@",[error description]);
                          AlertView *alert = [[AlertView alloc] initWithTitle:NSLocalizedString(@"Error", nil) message:[error description] delegate:nil cancelButtonTitle:NSLocalizedString(@"DISMISS", nil) otherButtonTitle:nil];
                          [alert showInView:self.view.window];
                      }
                  }];
             }
             else{
                 [[FBSDKLoginManager new] logOut];
                  [_customFaceBookButton setImage:[UIImage imageNamed:@"fb_connected"] forState:UIControlStateNormal];
             }
         }
     }]; 
```

# delphi - 为什么这个 MergeSort 实现不稳定？

> ID：12411091
> 
> 赞同：0
> 
> 时间：2012-09-13T16:49:56.340
> 
> 标签：delphi, sorting, stability

我在网上找到了几个归并排序算法，并将这个粘贴在一起。它携带索引以保留元素之前所在的信息。但事实证明，当我输入一个在每个元素处具有相同值的数组时，索引会被打乱。我需要使用另一种合并方法吗？

```
procedure TMSortNode.MergeSort(values, indices: TMValueArrayPtr; L, R: Integer);
var
  i, j, k, m : Integer;

begin
If (l < r) Then
begin
m:= (r+l) div 2;

MergeSort(values, indices, l, m );
MergeSort(values, indices, m+1, r );

For i:= l To m Do
begin
  FValueBuffer[i]:= values^[i];
  FIndexBuffer[i]:= indices^[i];
end;
i:= l;

For j:= m+1 To r Do
begin
  FValueBuffer[r+m+1-j]:= values^[j];
  FIndexBuffer[r+m+1-j]:= indices^[j];
end;
j:= r;

For k:= l To r Do
begin
  If (FValueBuffer[i] <= FValueBuffer[j]) Then
  begin
    values^[k]:= FValueBuffer[i];
    indices^[k]:= FIndexBuffer[i];
    inc(i);
  end
  else
  begin
    values^[k]:= FValueBuffer[j];
    indices^[k]:= FIndexBuffer[j];
    dec(j);
     end;
    end;
  end;
end; 
```

编辑：

这是正确的稳定合并部分：

```
length := r-l+1;
For i:= 0 To length-1 Do
begin
  FValueBuffer[i]:= values^[l+i];
  FIndexBuffer[i]:= indices^[l+i];
end;

j := 0;
k := m-l+1;

for i := 0 to length-1 do
if k < length then
  begin
  if j <= m-l then
  begin
    if FValueBuffer[j] > FValueBuffer[k] then begin
      values^[l+i] := FValueBuffer[k];
      indices^[l+i] := FIndexBuffer[k];
      inc(k)
    end else begin
      values^[l+i] := FValueBuffer[j];
      indices^[l+i] := FIndexBuffer[j];
      inc(j);
    end;
  end
  else
  begin //only upper Entrys left
    values^[i+l] := FValueBuffer[k];
    indices^[i+l] := FIndexBuffer[k];
    inc(k);
  end;
end else begin //only superior Entrys left
  values^[i+l] := FValueBuffer[j];
  indices^[i+l] := FIndexBuffer[j];
  inc(j);
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:14:23.783

尝试

如果 (FValueBuffer[i] **<=** FValueBuffer[j]) 那么 ...

（为保持稳定，我们不必交换相等的物品）

编辑：

另一个问题：标准合并看起来像：

1.  当左右部分都包含未处理的项目时，将最小的项目移动到新位置
2.  移动其余未处理部分（如果存在）

例子：

```
procedure Merge(var c, d: array of Integer; l, m, r: Integer);
 var
   i, j, k: Integer;
 begin
   i := l;
   j := m;
   k := l;
   while (i < m) and (j <= r) do
     if c[i] <= c[j] then begin
       d[k] := c[i];
       Inc(k);
       Inc(i);
     end
     else begin
       d[k] := c[j];
       Inc(k);
       Inc(j);
     end;
   while i < m do begin
     d[k] := c[i];
     Inc(k);
     Inc(i);
   end;
   while k <= r do begin
     d[k] := c[j];
     Inc(k);
     Inc(j);
   end;
  end; 
```

但是您的第一个变体超出了左右部分边界（为避免这种情况，可以使用具有额外价值的哨兵项目 - 它需要额外的努力和位置）。

貌似第二个版本考虑到了这个问题

# delphi - 未能在模块 DLL 中找到 RegisterModule 入口点... - 这是怎么回事？

> ID：12411093
> 
> 赞同：0
> 
> 时间：2012-09-13T16:50:01.387
> 
> 标签：delphi, windows-7, iis-7.5, isapi, isapi-extension

我有一个用 Delphi XE 编写的 ISAPI 模块（**本机 - 没有 ASP.net 等）。**尝试在 Win 7 64 企业台式机上的 IIS 7.5 上运行它。

应用程序池、网站等配置正确，ISAPI 模块被允许执行，经典管道、32 位等 - 已多次执行这些操作。

**相同的模块在 Win 2008 R2 服务器上运行良好，它也用于在我的 Win 7 桌面 IIS 7.5 上运行。**

但是我的硬盘上周坏了，我得到了一个新的 Win 7 安装 - 标准公司范围的 Win 7 Enterprise 映像（与我之前的 Win 7 64 安装不同）。

现在启动模块时，浏览器会挂起，然后返回“HTTP 错误 503。服务不可用”。在 IIS 中，我看到我的应用程序池在错误发生后停止 - 我知道这意味着 Web 应用程序中发生了严重错误。

在 Windows 事件日志中，我发现了这条消息：

“未能在模块 DLL G:\Mikey.dll 中找到 RegisterModule 入口点。数据为错误。”

在 DLL dpr 中调用 application.run 后，一些调试字符串向我显示了错误表面。

这里发生了什么？我怎样才能解决这个问题？我的开发工作需要这个部署。

请 - DLL 已获得执行代码的正确权限，并且应用程序池已正确配置 - 我的大量初始化代码在调用 application.run**之前**在 DLL 中执行- 所以这不是一个简单的配置或权限问题 - 503 错误并且事件日志条目也表明了这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:41:08.700

我找到了我的问题的线索@

[http://forums.iis.net/p/1162012/1921878.aspx](http://forums.iis.net/p/1162012/1921878.aspx)

**

> 回复：混乱的站点配置；事件日志 2009 年 10 月 22 日晚上 8:48 中的“未能找到 RegisterModule ...”错误 从模块列表中删除 aspnet_isapi.dll - 它是 ISAPI 扩展，而不是模块。Anil Ruia 高级软件设计工程师 IIS 核心服务器

**

意识到当我最初安装 IIS 时，我没有看到 CGI/ISAPI 限制小程序并以不同的方式许可我的 dll。

后来我发现我必须专门安装 ISAPI 支持——当我这样做时，我再次以正确的方式许可了我的 DLL，并删除了原始模块条目（或者我是这么认为的）。

此页面提示我 - 我的 dll 可能注册/许可不正确，并且 IIS 将其作为模块运行，而不是扩展 - 因此：““找不到 RegisterModule”。

由于这是全新的部署，我只是卸载了所有 IIS 模块和功能，确保没有遗留旧的配置文件并清理注册表。

然后我重新安装了包含 ISAPI 限制功能的 IIS，并根据需要注册/许可了我的 ISAPI 模块，并设置了应用程序池和网站。现在一切都很好。

谢谢你 Anil Ruia（无论你在哪里......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-14T16:50:45.527

我在使用 Perl 模块时遇到了这个错误。我不得不从 applicationHost.config 禁用它。我发现如果您只是使用编辑器编辑 %Windir%\system32\inetsrv\config\applicationHost.config ，即使文件被正确写入，即使您重新启动 IIS，更改也不会反映在 IIS 上。唯一的方法是遵循本指南 [https://technet.microsoft.com/en-us/library/cc735153(v=ws.10).aspx](https://technet.microsoft.com/en-us/library/cc735153(v=ws.10).aspx)。您基本上需要从提升的命令提示符启动“记事本”来编辑 applicationHost.config。这就是我解决这个问题的方法。

# asp.net - ArgumentException 返回序列化为 JSON 的 LINQ 结果

> ID：12411095
> 
> 赞同：0
> 
> 时间：2012-09-13T16:50:07.437
> 
> 标签：asp.net, json, asmx

我正在尝试从 ASMX Web 服务返回序列化为 JSON 的 LINQ 结果。据我所知，这应该可以工作，所以我必须遗漏一些东西。

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string GetCitiesForAffiliate(string aff)
    {
        XDocument centerXml = XDocument.Load(HttpContext.Current.Server.MapPath("~/App_Data/Centers.xml"));
        var query = (from center in centerXml.Descendants("Center")
                     where center.Element("ServiceArea").Value == aff
                     orderby center.Element("City") ascending
                     select new { 
                         City = center.Element("City") 
                     }).Distinct();

        JavaScriptSerializer serializer = new JavaScriptSerializer();
        string json = serializer.Serialize(query);

        return json;
    } 
```

serializer.Serialize(query) 行抛出 ArgumentException:`At least one object must implement IComparable.`我认为问题可能是我选择了一个匿名对象，但键入该对象并没有这样做。我确定我只是错过了一些愚蠢的东西吗？

有趣的是，这个以前的版本运行良好：

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string GetCitiesForAffiliate(string aff)
    {
        TextFileReader reader1 = new TextFileReader(HttpContext.Current.Server.MapPath("~/App_Data/Centers.csv"), ",");
        var query = (from cols in reader1
                     where cols[3].Equals(aff)
                     orderby cols[2] ascending
                     select new { City = cols[2] }).Distinct();

        JavaScriptSerializer serializer = new JavaScriptSerializer();
        string json = serializer.Serialize(query);

        return json;
    } 
```

TextFileReader 对象来自[此 CodeProject 项目](http://www.codeproject.com/Articles/30075/LINQ-to-Text-or-CSV-Files-Part-1)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:00:50.617

看起来惰性查询执行让您受益。LINQ 直到最后一刻才执行您的查询。在这种情况下，它在序列化线上。问题出在您的查询中，而不是序列化程序中。

问题看起来像当您通过取回一个 XElement 对象（它似乎没有实现 IComparable）并试图比较它们时崩溃。

我会先做你的选择，然后订购结果。

```
var query = (from center in centerXml.Descendants("Center")
                     where center.Element("ServiceArea").Value == aff
                     select new { 
                         City = center.Element("City") //may need a .ToString() here to get the city name out
                     }).Distinct().OrderBy(x => x.City); 
```

# sql-server-2000 - 将记录从一个数据库移动到另一个数据库并跟踪新的身份列

> ID：12411096
> 
> 赞同：0
> 
> 时间：2012-09-13T16:50:07.650
> 
> 标签：sql-server-2000, etl

我有 2 个具有相同架构的 sql server 2000 数据库。

我必须将给定表中的行子集从数据库 A 移动到数据库 B。我还必须将所有相关行从其他表移动到数据库 B。

这是一个简化的例子

让我们假设在每个数据库中都有以下表格：作者、书籍、奖项、销售额。

假设这些表中的每一个都有一个标识列，即 PK。这些列被命名为 AuthorID、BookID、AwardID、SaleID。

我需要将“Stephen King”从数据库 A 中的 Authors 表移动到数据库 B。假设数据库 A 中的 Stephen King 记录的 AuthorID 为 12。我还必须使用 FK 移动 Books 表中的所有行AuthorID 为 12。与奖项和销售表相同。

当数据库 B 是全新的时，我已经编写了代码来使用“SET IDENTITY_INSERT”命令来处理这个问题。因此，Stephen King 最终在每个表中都使用了相同的 AuthorID。

现在的问题是工作人员一直在忙着向B数据库添加新记录，我不能简单地将记录从A数据库迁移到B数据库而不发生PK冲突。我别无选择，只能让数据库 B 为迁移的记录分配新的 PK 值并跟踪它们，以便当相关记录出现时，使用正确的 FK。

在这个简化的示例中，我有 4 个表需要编写代码。

在我的现实生活示例中，我有 46 张桌子。

我不期待手动编码。

我可以购买任何现有的工具来简化此过程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:55:56.367

一种简单的解决方案是将源数据库中的所有 PK 和 FK 更改为负数。然后您可以将它们插入到新数据库中而不会发生冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:14:05.787

如果您可以在表上识别出一组完全不同的字段，您可以创建一个可以在两个系统上强制执行的唯一约束，那么您也可以使用它来比较两个系统以确保数据相同。如果没有一种方法来唯一地识别两个系统之间的数据，就不会有任何功能性的方法来在它们之间迁移数据。

# javascript - 在不同桌面分辨率下以相同大小显示图像

> ID：12411101
> 
> 赞同：2
> 
> 时间：2012-09-13T16:50:32.390
> 
> 标签：javascript, jquery, html, css

我需要显示一张信用卡大小的卡片图像，它必须在所有桌面分辨率上都具有相同的大小，这意味着它需要以与物理卡相同的宽度和高度显示图像。

我研究了将物理 mm 转换为 px 并调整图像大小是多么容易，但这比最初想象的要复杂得多。

有人有想法么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:53:26.940

使用`mm`（作为毫米）而不是`px`CSS 宽度和高度。据我所知，CSS支持这一点。然而，在[本](http://htmlhelp.com/reference/css/units.html)文档中，指出“绝对长度单位高度依赖于输出介质，因此不如相对单位有用。”。但它尽可能接近精确，恕我直言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:47:04.390

我不确定这是否是一个跨浏览器的解决方案，但它应该适用于大多数浏览器。

HTML：

```
<img id="image" src="img.jpg" /> 
```

CSS：

```
#image {
    height:inherit;
    width:inherit;
} 
```

这应该使您的图像具有与父 DIV 相同的宽度和高度。因此，您的图像必须包含在具有图像确切高度和宽度的 div 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T07:22:56.230

谢谢大家，我在调查后怀疑这是不可能的。以毫米为单位的尺寸似乎不能始终如一地工作，所以我可能不得不承认失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-02T09:07:19.323

您现在可以使用[视口单位](https://developer.mozilla.org/en/docs/Web/CSS/length)，例如 vw、vh、vmin、vmax：

```
img{
   width: 2vw;
   height: 2vw;
} 
```

现在，如果您以任何分辨率查看图像，这将是相同的。

*   vh - 视口高度的 1/100。
*   vw - 视口宽度的 1/100。
*   vmin - 视口高度和宽度之间最小值的 1/100。
*   vmax - 视口高度和宽度之间最大值的 1/100。

另请参阅，[我可以使用视口单位吗](http://caniuse.com/#feat=viewport-units)

# django - 让 django url 使用参数

> ID：12411102
> 
> 赞同：0
> 
> 时间：2012-09-13T16:50:34.100
> 
> 标签：django, url, views

我使用的是外部数据库而不是 ORM。我正在编写一个测试应用程序，当提交测试时，我希望用户被重定向到一个 URL，该 URL 将他们的测试 ID 附加到 url 并且页面应该显示他们的测试结果。例如，“http://domain/testplatform/123”，其中 123 是来自外部数据库的测试 ID。db 还保存该测试 ID 的所有测试结果，我在模板中获取并使用这些值。但我无法让应用程序将测试 ID 附加到 URL。这是我的代码。

网址.py

```
from testplatform import views
...
(r'^testplatform/(\d+)/$', views.testcriteria, 'testsubmit'),
(r'^testplatform/$', views.testcriteria),
... 
```

这一点，r'^testplatform/(\d+)$'。是我想将 testsubmit 中的值附加到 URL 的地方。r'^testplatform/$' 将用户带到我创建的表单，他们填写该表单以启动测试。

视图.py

```
from django.core.context_processors import csrf
from django.shortcuts import render_to_response
from testplatform.test_db import tests
...
def testcriteria(request):

  if request.method == 'POST':
    form = TestCriteriaForm(request.POST)
    if form.is_valid():
      ...
      cd = form.cleaned_data
      t_testname = cd['testname']
      ...
      sql = tests()
      testsubmitid = sql.tbl_test_name(t_testname)
      ...

      testsubmit = dict(testsubmitid=testsubmitid, testcriteria=testcriteria)
      testsubmit.update(csrf(request))
      return render_to_response('testsubmitted.html',testsubmit) 
```

我已经确认我从 testsubmitid 获得了一个值——这将返回测试 ID。testcriteria 值来自外部数据库的另一个查询，该数据库包含有关已测试内容的信息。

但是，当我提交表单时，页面只是指向 testsubmitted.html，但 url 只是“http://domain/testplatform”

我应该为结果页面创建一个新视图并使用类似的东西将用户重定向到结果页面吗？

```
 return HttpResponseRedirect(reverse("testresults.views.results", args=testsubmit)) 
```

谁能帮我告诉我为什么这不起作用？

谢谢 - 奥利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:15:53.987

我不知道您为什么会收到该特定错误，因为您没有提供回溯。您还没有显示任何可以重定向到的代码`/testplatform/123`，所以我对此无能为力。但肯定有一个错误：该视图没有为 ID 提供参数。您可能需要执行以下操作：

```
def testcriteria(request, submit_id=None): 
```

# append - jQuery 在 $.each() 期间追加元素

> ID：12411106
> 
> 赞同：2
> 
> 时间：2012-09-13T16:50:49.207
> 
> 标签：append, jquery

我正在尝试在 jQuery`$.each()`循环中重复附加一个在闭包之外定义的元素，请参阅 - [http://jsfiddle.net/benedict_w/8Pczs/](http://jsfiddle.net/benedict_w/8Pczs/)

有人可以解释为什么该元素只附加在循环的最后一次迭代中吗？

例如

```
<ul>
    <li>blah</li>
    <li>blah</li>
    <li>blah</li>
</ul> 
```

使用以下jQuery：

```
var remove = $('<a href="#">remove</a>');
$('li').each(function(){
    $(this).append(remove);       
});​ 
```

生产商：

```
<ul>
    <li>blah</li>
    <li>blah</li>
    <li>blah <a href="#">remove</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T16:51:43.717

您每次都附加*相同的元素。*
每个追加都会将其移动到下一个`<li>`。

每次迭代都需要`clone()`元素（或只是重新创建它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:53:42.160

```
$('<a href="#">remove</a>').appendTo('li'); 
```

这将为每个元素添加一个新元素，`li`同时避免不必要的循环和 jQuery 对象创建。

> 但是，如果有多个目标元素，则会在第一个目标之后为每个目标创建插入元素的克隆副本，并返回新集合（原始元素加上克隆）。

[http://api.jquery.com/appendTo/](http://api.jquery.com/appendTo/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:52:48.183

您不需要克隆要插入的元素。根据定义[`append()`](http://api.jquery.com/append/)

```
$('li').append('<a href="#">remove</a>'); 
//will append an <a> to every <li> in the "set of matched elements" 
```

[演示](http://jsfiddle.net/mrobin/LwfPg/1/)

**更新**：如果你确实需要`each()`迭代器来做其他事情，为什么不在闭包内定义你的元素呢？

```
$('li').each(function(){
    var remove = $('<a href="#">remove</a>');
    $(this).append(remove);       
    //do other things
});​ 
```

**更新 2**：只是从我从 OP 的评论中学到的内容中保持最新的答案

因为在您的问题中，您引用了一个独特的元素（在闭包之外定义）。其中，在第一次迭代时附加到 DOM。下次您尝试将相同的元素附加到 DOM 中的另一个节点时。jQuery 认识到这一点，因此将其从其位置分离，创建另一个文档片段，然后将其附加到 DOM 中的新目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T16:54:53.630

将变量“remove”定义为纯文本，即

```
var remove = '<a href="#">remove</a>'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T16:55:39.060

```
var remo[enter link description here][1]ve = $( 
```

正在弄乱你的代码。它正在附加元素，因为它正在发生..只需将其作为字符串而不是选择器传递或克隆对象..应该为您完成工作，，

```
var remove = '<a href="#">remove</a>' ;
$('li').each(function(){
    $(this).append(remove);       
});​ 
```

您也可以使用 appendTo 来避免迭代

```
$('<a href="#">remove</a>').appendTo('li'); 
```

检查更新的[小提琴](http://jsfiddle.net/benedict_w/8Pczs/)

# performance - 小数的加法比大数的加法快吗？

> ID：12411113
> 
> 赞同：2
> 
> 时间：2012-09-13T16:51:13.267
> 
> 标签：performance, automated-tests, benchmarking

在 c# 聊天中一直在讨论这个问题。原来的问题是这样的：

> 计算例如 (Int32) 5+5 比 1234723847+32489237 快吗？

我最初的想法是在二进制级别进行优化以忽略填充零，因此较小的数字会更快。

所以，我测试了它。如果你有兴趣，这里是程序。如果没有，请直接跳到结果。

```
Stopwatch sw = new Stopwatch();
Int64 c = 0;
long msDifferential = 0;     //
int reps = 10; //number of times to run the entire program
for (int j = 0; j < reps; j++)
{            
    sw.Start();  //                
    sw.Stop();   // Just in case there's any kind of overhead for the first Start()
    sw.Reset();  //

    sw.Start();  //One hundred million additions of "small" numbers
    for (Int64 i = 0, k = 1; i < 100000000; i++, k++)
    {   
        c = i + k;
    }
    sw.Stop();

    long tickssmall = sw.ElapsedTicks;       
    long mssmall = sw.ElapsedMilliseconds;

    sw.Reset();

    sw.Start();  //One hundred million additions of "big" numbers
    for (Int64 i = 100000000000000000, k = 100000000000000001; i < 100000000100000000; i++, k++)
    {
        c = i + k;
    }
    sw.Stop();

    long ticksbig = sw.ElapsedTicks;
    long msbig = sw.ElapsedMilliseconds;

    //total differentials for additions
    ticksDifferential += ticksbig - tickssmall;   
    msDifferential += msbig - mssmall;                
}

//average differentials per 100000000 additions
long averageDifferentialTicks = ticksDifferential / reps;
long averageDifferentialMs = msDifferential / reps;

//average differentials per addition
long unitAverageDifferentialTicks = averageDifferentialTicks / 100000000;
long unitAverageDifferentialMs = averageDifferentialMs / 100000000;

System.IO.File.AppendAllText(@"C:\Users\phillip.schmidt\My Documents\AdditionTimer.txt", "Average Differential (Ticks): " + unitAverageDifferentialTicks.ToString() + ", ");
System.IO.File.AppendAllText(@"C:\Users\phillip.schmidt\My Documents\AdditionTimer.txt", "Average Differential (Milliseconds): " + unitAverageDifferentialMs.ToString()); 
```

* * *

## 结果

**调试模式**

*   平均单位差：2.17 纳秒

**发布模式（已启用优化）**

*   平均单位差：0.001 纳秒

**发布模式（已禁用优化）**

*   平均单位差：0.01 纳秒

因此，在调试模式下，“大”数字每次相加比“小”数字加起来要长约 2.17 纳秒。但是，在发布模式下，差异几乎没有那么显着。

* * *

## 问题

所以我有几个后续问题：

1.  哪种模式最适合我的目的？（调试、发布、发布（无选择））
2.  我的结果准确吗？如果是这样，速度差异的原因是什么？
3.  为什么调试模式的差异如此之大？
4.  还有什么我应该考虑的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:32:23.463

特定优化的效果将取决于您的编译器。您应该查看每种情况下生成的汇编代码并比较生成的 CPU 指令。在 CPU 级别上，如果生成相同的指令，性能应该不会因您添加的值而有任何差异。CPU 有一个时钟信号，如果在相同大小的操作数上执行相同的指令，则无论操作数的位是 1 还是 0，简单的算术运算都将采用相同数量的时钟滴答。内存效应可能会影响性能，但这里的数据足够小，这可能无关紧要。在反汇编中，您可以检查您的变量是否最终出现在寄存器中。如果不，有人可能想知道，如果只有几个变量对较大数据起重要作用的影响（如缓存命中/未命中、物理内存访问等）在这里也很重要。它们可能会，因为您的 CPU 每秒能够进行数十亿次算术运算，但 RAM 是一个速度较慢的外部设备。无论如何，这种影响是随机的，而不取决于您添加的值是大还是小。流水线停顿、指令重新排序等也应如此。在一系列实验中，在不同时间执行，平均时间应该在误差范围内相同（您在发布模式下获得的差异肯定属于这一类）。因为您的 CPU 每秒能够进行数十亿次算术运算，但 RAM 是一个速度较慢的外部设备。无论如何，这种影响是随机的，而不取决于您添加的值是大还是小。流水线停顿、指令重新排序等也应如此。在一系列实验中，在不同时间执行，平均时间应该在误差范围内相同（您在发布模式下获得的差异肯定属于这一类）。因为您的 CPU 每秒能够进行数十亿次算术运算，但 RAM 是一个速度较慢的外部设备。无论如何，这种影响是随机的，而不取决于您添加的值是大还是小。流水线停顿、指令重新排序等也应如此。在一系列实验中，在不同时间执行，平均时间应该在误差范围内相同（您在发布模式下获得的差异肯定属于这一类）。

我看到可能存在差异的一种可能性是编译器不是直接通过 64 位指令而是使用多个 32 位指令来处理 64 位数字。在这种情况下，一个聪明的编译器可能会注意到你在某个循环中使用的值永远不会超过 32 位数字的限制，并发出只对单个 32 位值而不是组成两个 32 位值的指令。 64 位值。看看拆卸可以揭示是否是这种情况。

# android - 要创建一个包含视图的片段，必须始终覆盖 Fragment 类

> ID：12411121
> 
> 赞同：0
> 
> 时间：2012-09-13T16:51:48.707
> 
> 标签：android, android-fragments

当以编程方式创建一个包含视图的片段时，必须始终扩展片段类并覆盖 OnCreateView 方法。有没有另一种更简单的方法来做到这一点（比如创建一个片段并将其传递给视图 ID 或其他东西）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:40:38.910

似乎是真的，它需要创建分离的类扩展一个片段。但是您仍然可以将 viewId 作为参数传递。系统要求能够在必要时重新实例化片段。我会这样做：

```
import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class ViewFragment extends Fragment {

    public static final ViewFragment newInstance(int contentId) {
        Bundle args = new Bundle();
        args.putInt("contentId", contentId);
        ViewFragment fragment = new ViewFragment();
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        Bundle args = getArguments();
        int contentId = args.getInt("contentId");
        return inflater.inflate(contentId, container, false);
    }
} 
```

# c# - 如何使用正则表达式从文档中去除打印控制代码（PCL 类型）

> ID：12411129
> 
> 赞同：0
> 
> 时间：2012-09-13T16:52:25.523
> 
> 标签：c#, .net, regex, printer-control-language

我有一个 PCL 文件的存档。我想制作一个控制台应用程序，它可以读取文件，删除所有打印控制代码，并将代码写入单独的文件，让文档的其余部分保持一致。我想我可以用 regex() 来做到这一点，但我不确定如何处理这项任务。我选择的语言是 C#。您可以提供的任何建议将不胜感激。

我已经取得了进展

```
 public static string RemoveBetween(string s, char begin, char end)
    {
        Regex regex = new Regex(string.Format("\\{0}.*?{1}", begin, end));
        return regex.Replace(s, string.Empty);
    }

    public static string[] getPclCodes(string line)
    {
        string pattern = "\\x1B.*?H";
        string[] pclCodes = Regex.Split(line, pattern);

        return pclCodes;
    } 
```

但代码返回为空字符串。我可以将它们从 PCL 中剥离出来并编写一个 txt 文件，但我也需要这些代码。我在 RemoveBetween 之前调用了 getPclCodes。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T09:43:50.400

如果我理解正确。这应该可以解决问题。我修改了您的方法以接受您希望由模式扫描的行和对 MatchCollection 的引用。这样，您可以在拆分行之前简单地将引用分配给匹配项。

```
 public static string[] getPclCodes(string line, out MatchCollection codes)
    {
        string pattern = "\\x1B.*?H";

        Regex regex = new Regex(pattern);
        codes = regex.Matches(line);

        string[] pclCodes = Regex.Split(line, pattern);

        return pclCodes;
    } 
```

所以现在，在你的 main 或者你称之为 getPclCodes 的地方，你可以做这样的事情。

```
 MatchCollection matches;
        string[] codes = getPclCodes(codeString, out matches);

        foreach (Match match in matches)
            Console.WriteLine(match.Value); 
```

我确信有更好的方法，但这再次有效......如果我们在同一页面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-28T08:10:17.843

OP 大概想要 C#，但如果其他人只是想要使用 GNU sed，这可行：

```
sed 's/\x1B[^][@A-Z^\\]*[][@A-Z^\\]//g' 
```

工作原理：在每一行中查找并删除任何以 ESC ( `\x1B`) 开头并一直持续到 64-94 位 ASCII 字符（即 AZ 或任何一个`@[\]^`）的字符序列。尾随`g`意味着重复，直到没有进一步的匹配。

# sockets - 接收整个 UDP 数据报，不管大小？

> ID：12411131
> 
> 赞同：6
> 
> 时间：2012-09-13T16:52:32.583
> 
> 标签：sockets, udp, posix

考虑通过套接字发送的 100 个字节。对于 TCP 套接字，如果我`recv()`以 50 的长度调用，我会得到前 50 个字节，如果我再次调用它，我会得到第二个 50 个字节。使用 UDP 套接字，如果我`recvfrom()`以 50 的长度调用，我会得到前 50 个字节，但无法检索第二个 50 个字节——后续调用`recvfrom()`阻塞，直到收到下一个数据报。

这是否意味着，如果我想接收整个 UDP 数据报，无论大小，我都必须分配一个 64k 的缓冲区（UDP 允许的最大值）？如果我`connect()`的 UDP 套接字，这会改变行为吗？或者在 UDP 上运行的协议通常需要一个已知的最大数据包大小，应该用于缓冲区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:34:39.947

大多数理智的基于 UDP 的协议不会通过[MTU](http://en.wikipedia.org/wiki/Maximum_transmission_unit)较少的 IP 和 UDP 标头来避免[IP 碎片](http://en.wikipedia.org/wiki/IP_fragmentation)。例如，对于大于 512 字节的消息，DNS 切换到 TCP。因此，除非您的网络使用巨型帧，否则使用 1472 字节的缓冲区（1500 以太网 MTU - 20 用于不带选项的 IP 标头 - 8 UDP 标头）可能是安全的。这当然取决于 UDP 之上的应用程序协议。

如果您真的很偏执（或使用未知协议），您可以使用`MSG_PEEK`和`MSG_TRUNC`标志来首先计算大小，然后分配足够大的缓冲区（请参阅 参考资料[`recv(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/recvmsg.2.html)）。

# jquery - 使用 toggleClass 使用 jquery cookie.js 设置 cookie

> ID：12411133
> 
> 赞同：0
> 
> 时间：2012-09-13T16:52:33.077
> 
> 标签：jquery, cookies, closest, toggleclass

我有一组缩略图的以下 html，我使用图标 (icon-heart) 通过将图标的颜色更改为红色并添加 class="Favorite" 来设置图像的收藏夹：

```
 <div class="selectFav">
 <a href="slide.jpg" data-rel="prettyPhoto[Gallery]"  title="Slide"><img  src="slide.jpg" alt="Slide"  width="124" height="124"/></a>
 <ul class="icon">
 <li>   <div class="icon-heart"></div> </li>
 <li>   <div class="icon-camera"></div> </li>
 </ul>
</div> 
```

CSS：

```
 .flag{
 color:red;
 } 
```

当单个拇指设置为收藏夹时，我想使用查询 cookie.js 设置 cookie。问题是，当我尝试设置 cookie 时，我将所有 icon-heart 图标设置为收藏夹，而不仅仅是那个特定 selectFav 的图标

```
$(".icon-heart").on('click', function() {
$(this).toggleClass('flag').closest('.selectFav').addClass('Favorite');
}); 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:12:33.870

我为你做了这个作为例子：

**现场演示：**

[http://jsfiddle.net/oscarj24/GUUjr/1/](http://jsfiddle.net/oscarj24/GUUjr/1/)

*   这将帮助您了解如何管理 cookie。

**指示：**

*   只是`click`你在第一时间想要的心（那些心会消失）然后按`Run`你想要的时间按钮，看看之前的心仍然消失了饼干的原因。

*   您可以单击`Kill the cookie`按钮重新开始一切。请阅读代码注释以获得更好的理解。

# fonts - 如何让 ClickOnce 应用程序知道新字体？

> ID：12411135
> 
> 赞同：0
> 
> 时间：2012-09-13T16:52:35.570
> 
> 标签：fonts, devexpress, clickonce

作为序言，我需要使用： * ClickOnce 部署 * 条形码字体 * 使用“FontName”但无法访问 Font 对象的 DevExpress 控件，阻止我使用 PrivateFontCollection。* 字体必须静默安装并在安装后立即运行。

DevExpress 中阻止我使用 PFC 的部分是 RichEditControl 中的 CharacterProperties 对象。他们的支持网站已经有一张以“抱歉，我们无法使其与 PrivateFontCollection 一起使用”结尾的票证。

我从许多来源阅读并不断发现 ClickOnce 在安装时无法立即使用字体。我正在使用 P/Invoke 安装字体，因为我无法使用 PFC。我创建了一个完全独立的控制台应用程序来安装这个字体，并且字体显示在 Word 中，但它没有显示在我的 ClickOnce 应用程序中，即使我在 Word 之后打开它。我可以通过正常的 Windows 单击方法手动安装字体，它会同时显示在 Word 和 ClickOnce 中。

我用 System.Drawing.Font 验证了它对整个应用程序不可用，而不仅仅是一个挑剔的供应商控制：

```
Font fontTester = new Font(fontName, 12, FontStyle.Regular, GraphicsUnit.Pixel);
if (fontTester.Name == fontName) 
```

“名称”值更改为“Microsoft Sans-Serif”，就好像字体不可用一样。

如何在不重新启动/注销的情况下让字体显示在 ClickOnce 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:19:33.683

我不确定您是否可以通过将字体放入 Windows 目录以传统方式安装字体 - ClickOnce 沙箱会阻止您执行此类操作。

但是您可以使用代码动态添加字体，但仅限于当前用户。

这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/system.drawing.text.privatefontcollection.addfontfile.aspx)显示了 System.Drawing.Text 命名空间上的 AddFontFile 方法，这里有关于这个问题的进一步讨论[（](http://www.pcreview.co.uk/forums/clickonce-deployment-include-font-t2893983.html)忽略错误地说不可能的人）

编辑：看起来它可能是你的命名空间。请参阅[C# - 阅读和预览字体](https://stackoverflow.com/questions/1187212/c-sharp-read-preview-font)

我会尝试以某种方式从您的应用程序中列出字体，看看它们是否可以被阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T21:17:22.457

控制台应用程序中的 P/Invoke 方法不起作用，我没有时间弄清楚原因，但是使用带有 Shell.Application 的 VBScript 可以。

```
Const FONTS = &H14&

Set objShell = CreateObject("Shell.Application")
Set objFolder = objShell.Namespace(FONTS)
objFolder.CopyHere "\\server\Fonts\barcodefont.ttf" 
```

我实际上是从这个开始的，但无论出于何种原因它都不起作用，所以我转向了其他方法，包括控制台应用程序。

# javascript - javascript模式对话框

> ID：12411136
> 
> 赞同：2
> 
> 时间：2012-09-13T16:52:44.193
> 
> 标签：javascript, html, css, modal-dialog

我是 Javascript 的初学者。刚想学习模态对话框但遇到一些问题，代码如下：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN">
<html>

<head>
<title>Click here to show the overlay</title>
<style>
#overlay {
     visibility: hidden;
     position: fixed;
     left: 0;
     top: 0;
     width: 100%;
     height: 100%;
     text-align:center;
     z-index: 200;
     background-image:url(maskBG.png);
}

#overlay div {
     width:300px;
     margin: 100px auto;
     background-color: #fff;
     border:1px solid #000;
     padding:15px;
     text-align:center;
}
</style>

<script>
function overlay(){

el = document.getElementById("overlay");
el.style.visibility = (el.style.visibility == "visible") ? "hidden" : "visible";

}
</script>

</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">

<p align="center"><a href='#' onclick='overlay()'>Click here to show the overlay</a></p>

<p align="center">this is my text... this is my text... this is my text...&nbsp;this 
is my text... this is my text...&nbsp;this is my text...this is my text... this 
is my text... this is my text... this is my text...</p>

<p align="center"><b>this is my text... this is my text... this is my text...&nbsp;this 
is my text... t</b></p>

<div id="overlay">
<div>
<p>Content you want the user to see goes here.</p>
</div>
</div>

</body>

</html> 
```

这是一个非常简单的代码。我的问题是为什么在第二层弹出后第一层不可点击？我会认为因为第二层停留在第一层之上并且阻挡了第一层。但是为什么我可以点击“链接”来触发函数overlay()呢？第二层的可见性是隐藏的，但它仍然停留在第一层的顶部，对吗？该函数甚至没有改变 z-index。我想不通，为什么。

另一个问题是，现在我怎样才能解除第二层并回到第一层？一些简单的代码表示赞赏。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:01:17.957

您无法在覆盖下方单击的原因是因为有一个底层。它的背景是透明的，但都一样。

请参阅[http://jsfiddle.net/CSLD2/1/](http://jsfiddle.net/CSLD2/1/)以获得更好的说明。

要关闭图层，只需插入某种类型的关闭按钮并让其 onclick 事件将图层设置为不可见。您也可以考虑使用某种成熟的覆盖库，因为它已经针对不可预测的 HTML 条件进行了测试。

# .htaccess - 使用 .htaccess 重定向时，如何测试 REQUEST_URI 是什么？

> ID：12411140
> 
> 赞同：1
> 
> 时间：2012-09-13T16:53:05.517
> 
> 标签：.htaccess, mod-rewrite

我正在尝试在这里做一些非常简单的事情，但它正在踢我的屁股哈哈。我有我的网站，今天早上我得到了一个 SSL 证书。我希望我的用户被重定向到安全站点，但我只需要我网站的某个部分的证书，所以我不想担心其他任何地方。证书是`domain.com`没有的`www.domain.com`。我需要证书的网站部​​分，所有页面都在`apps`目录中。例如`domain.com/apps/login.php`. 这是我在 .htaccess 文件中放入的内容。

```
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/apps/.*$
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://domain\.com%{REQUEST_URI} [R=301,L] 
```

现在我将解释我认为这应该做什么，并且我想被告知我错在哪里哈哈。

*   `RewriteEngin On`- 允许重定向
*   `RewriteCond %{REQUEST_URI} ^/apps/.*$`- 检查用户是否在应用程序目录中
*   `RewriteCond %{HTTPS} !=on`- 检查用户是否已经在使用 https://
*   `RewriteRule ^(.*)$ https://domain\.com%{REQUEST_URI} [R=301,L]`- 重定向

这部分有效。当我输入时，`www.domain.com/apps/login.php`它会重定向到`https://domain.com/apps/login.php`. 完美的。但如果我只是输入`www.domain.com`它会重定向到`https://domain.com`. 所以看来我的线`RewriteCond %{REQUEST_URI} ^/apps/.*$`坏了。我需要放什么才能使它仅在`apps`目录中时才重定向到安全站点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:56:47.203

在我看来，您的规则应该有效，但无论如何您都不需要`RewriteCond %{REQUEST_URI}`测试。只需包含`^apps`在`RewriteRule`：

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^apps/(.*)$ https://domain.com/apps/$1 [R=301,L,NC] 
```

# c# - 拉丁文、中文、西里尔文等的子字符串 UTF-8

> ID：12411142
> 
> 赞同：5
> 
> 时间：2012-09-13T16:53:24.667
> 
> 标签：c#, .net, utf-8

在 Windows Phone 上，我想将任何给定的字符串子串成相当于 100 个 ASCII 字符的长度。

String.Length 显然没用，因为中文字符串每个字符使用 3 个字节，丹麦字符串每个字符使用 2 或 4 个字节，俄语字符串每个字符使用 4 个字节。

唯一可用的编码是 UTF-8 和 UTF-16。那我该怎么办？

这个想法是这样的：

```
private static string UnicodeSubstring(string text, int length)
{
    var bytes = Encoding.UTF8.GetBytes(text);

    return Encoding.UTF8.GetString(bytes, 0, Math.Min(bytes.Length, length));
} 
```

但是长度需要可以正确地除以每个字符使用的字节数，所以**最后一个**字符总是正确呈现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:59:56.407

一种选择是简单地遍历字符串，计算每个字符的字节数。

如果您知道不需要处理 BMP 之外的字符，这相当简单：

```
public string SubstringWithinUtf8Limit(string text, int byteLimit)
{
    int byteCount = 0;
    char[] buffer = new char[1];
    for (int i = 0; i < text.Length; i++)
    {
        buffer[0] = text[i];
        byteCount += Encoding.UTF8.GetByteCount(buffer);
        if (byteCount > byteLimit)
        {
            // Couldn't add this character. Return its index
            return text.Substring(0, i);
        }
    }
    return text;
} 
```

如果您必须处理代理对，它会变得有点棘手:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:03:18.563

一种选择是简单地将“字符”（包括代理对，如果您需要支持它们）添加到结果字符串，并查看它是否被转换为您想要的正确数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-09T16:23:11.140

虽然这是一个非常古老的问题，但我相信正确的方法是使用[`System.Globalization.StringInfo`](https://docs.microsoft.com/en-us/dotnet/api/system.globalization.stringinfo?view=netframework-1.1)类的[`StringInfo.SubstringByTextElements`Method](https://docs.microsoft.com/en-us/dotnet/api/system.globalization.stringinfo.substringbytextelements?view=netframework-4.8&viewFallbackFrom=netframework-1.1)。这样做的主要优点是 .NET 文档保证`net461`及更高版本，[来电者注意事项](https://docs.microsoft.com/en-us/dotnet/api/system.globalization.stringinfo?view=netframework-1.1#notes-to-callers)`StringInfo`保证符合 Unicode 标准版本 8.0.0：

> # 来电者须知
> 
> 在内部，StringInfo 类的方法调用 CharUnicodeInfo 类的方法来确定字符类别。从 .NET Framework 4.6.2 开始，字符分类基于 Unicode 标准，版本 8.0.0。对于 .NET Framework 4 到 .NET Framework 4.6.1，它基于 Unicode 标准，版本 6.3.0。在 .NET Core 中，它基于 Unicode 标准，版本 8.0.0。

现在，您如何实际调用 SubstringByTextElements，因为 Microsoft Docs 上没有关于如何调用它的示例？

在`StringInfo`课堂上，有一条注释说：

> *   通过调用该`ParseCombiningCharacters`方法来检索包含每个文本元素的起始索引的数组。然后，您可以通过将这些索引传递给该`SubstringByTextElements`方法来检索单个文本元素。

所以：

1.  调用 ParseCombinigCharacters 以获取每个文本元素的起始索引
2.  使用第一步提供的索引调用 SubstringByTextElements。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T17:11:19.043

一个想法是检查最后一个字符是否是[Unicode Replace Character](http://www.fileformat.info/info/unicode/char/fffd/index.htm)，并删除一个字符，直到它正确呈现。

```
private static string UnicodeSubstring(string text, int length)
{
    var bytes = Encoding.UTF8.GetBytes(text);
    var result = Encoding.UTF8.GetString(bytes, 0, Math.Min(bytes.Length, length));

    while ('\uFFFD' == result[result.Length - 1])
    {
        result = result.Substring(0, result.Length - 1);
    }

    return result;
} 
```

# django - 为 Django 管理页面定义自定义 CSS 时，“全部”是什么意思

> ID：12411143
> 
> 赞同：2
> 
> 时间：2012-09-13T16:53:25.377
> 
> 标签：django, django-admin

django 文档表明可以将[自定义 css 添加到管理页面，如下所示](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-media-definitions)：

```
class ArticleAdmin(admin.ModelAdmin):
    class Media:
        css = {
            "all": ("my_styles.css",)
        }
        js = ("my_code.js",) 
```

但是，它并没有解释 css 声明中的“全部”是什么意思。这是什么意思，还有其他值或配置可以用来代替“全部”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:56:54.030

`all`适用于所有类型的媒体声明，它们是：

> 'aural'、'braille'、'embossed'、'handheld'、'print'、'projection'、'screen'、'tty' 和 'tv'

.

因此，如果您想要手持设备的特定样式：

```
class ArticleAdmin(admin.ModelAdmin):
    class Media:
        css = {
            "handheld": ("my_handheld_styles.css",)
            "all": ("my_styles.css",)
        }
        js = ("my_code.js",) 
```

[https://docs.djangoproject.com/en/1.0/topics/forms/media/#css](https://docs.djangoproject.com/en/1.0/topics/forms/media/#css)

# google-app-engine - 应用引擎数据存储 - 搜索实体列表

> ID：12411146
> 
> 赞同：0
> 
> 时间：2012-09-13T16:53:28.177
> 
> 标签：google-app-engine

我从应用引擎中的数据存储区中提取了一个实体列表。列表中的每个实体都有一个“名称”属性。有没有一种快速的方法可以在实体列表中搜索特定名称？

而不是遍历每一个并检查 name 属性

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:02:48.087

如果您有可以匹配的属性，您可以直接拉出您正在寻找的实体

```
q = Person.all()
q.filter("name =", target_last_name)
result = q.get() 
```

但据我所知，如果您不针对特定属性进行查询，则必须遍历结果列表。

但是，此链接讨论了执行此操作的有效方法：

[在 Python 中搜索对象列表](https://stackoverflow.com/questions/598398/searching-a-list-of-objects-in-python)

例如

```
 [x for x in myList if x.n == 30] 
```

# php - 如何在下拉列表中发布所有选项

> ID：12411147
> 
> 赞同：0
> 
> 时间：2012-09-13T16:53:30.797
> 
> 标签：php, javascript, html

我已经将这两个下拉列表编码在一起。一个是国家，一个是空的。当您单击一个国家并按添加时，该国家将移至空白下拉列表。您可以根据需要多次执行此操作。

但是在提交表单时，我无法访问第二个下拉列表的发布数据。这是我的代码：

JavaScript：

```
function moveData(dir) {
var sF = document.getElementById(((dir == "back")?"destinationSelect":"sourceSelect"));
var dF = document.getElementById(((dir == "back")?"sourceSelect":"destinationSelect"));
if(sF.length == 0 || sF.selectedIndex == -1) return;
while (sF.selectedIndex != -1) {
    dF.options[dF.length] = new Option(sF.options[sF.selectedIndex].text, sF.options[sF.selectedIndex].value);
    sF.options[sF.selectedIndex] = null;
}
} 
```

HTML：

```
<select name="sourceSelect[]" id="sourceSelect" size="5"  ondblclick="moveData(); return false;">
<optgroup label="North America">
    <option value="NORTHAMERICA_UNITEDSTATES">United States</option>
    <option value="NORTHAMERICA_BAHAMAS">Bahamas</option>
    <option value="NORTHAMERICA_BARBADOS">Barbados</option>
    <option value="NORTHAMERICA_BELIZE">Belize</option>
    <option value="NORTHAMERICA_CANADA">Canada</option>
    <option value="NORTHAMERICA_COSTARICA">Costa Rica</option>
    <option value="NORTHAMERICA_CUBA">Cuba</option>
</select>   

<input type="submit" name="forward" id="button" value=">>>>" onclick="moveData(); return false;"/>
<input type="submit" name="back" id="button" value="<<<<" onclick="moveData('back'); return false;"/>

<select name="destinationSelect[]" id="destinationSelect" size="5" ondblclick="moveData('back'); return false;"> 
```

所以，是的，我不确定如何在表单提交时发布第二个下拉列表，或者我需要输入什么才能看到它。像 echo $_POST['destinationSelect[]'] 不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:56:30.713

`select`提交表单时不会发送元素中可用的值，仅发送**选定**的值。

我在这里看到两个选择：

1.  在第二个框中添加项目并自动选择它。丑陋，但它有效，除非用户“取消选择”这些项目。不过，我不希望你这样做。
2.  创建隐藏字段以保存项目的值。当您将一个项目“移动”到第二个`select`时，您还将它添加到隐藏字段的值中。这个实现更好，因为不管用户是否弄乱了第二个`select`，它都可以工作（它将作为一个可视组件，但不会做实际工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:58:17.000

当您提交表单时，您需要选择第二个（已选择）字段中的所有项目；

```
 <input name="Submit" type="submit" value="submit"  onclick="selectAllOptions('destinationSelect');" /> 
```

然后是javascript；

```
function selectAllOptions(selStr)   {
    var selObj = document.getElementById(selStr);
    for (var i=0; i<selObj.options.length; i++) {
        selObj.options[i].selected = true;
    }
} 
```

否则他们在那里但没有被选中

# visual-studio-2010 - 带有 subString 变量的 Visual Studio 代码段

> ID：12411150
> 
> 赞同：1
> 
> 时间：2012-09-13T16:53:37.333
> 
> 标签：visual-studio-2010, code-snippets

我正在尝试设置一个环境以在 VS2010 中使用 SenchaTouch，并且我正在使用 Snippet Designer 编写一些 Snippets。我想知道是否有人可以解释我如何使变量成为字符串的一部分：例如：

```
Ext.define("NotesApp.controller.Notes", 
```

我希望用户能够编辑 Notes 名称和 NotesApp 名称但不更改“.controller”）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T05:49:45.473

经过一番研究，这比我想象的要容易（snippets basic），我第一次太懒了：

```
Ext.define("$appli$.controller.$control$", {

    extend: "Ext.app.Controller",
    config: {
        refs: {            
           // firstView: "firstView",
           // secondView: "secondView"
        },

    // Remainder of the controller’s code 

}); 
```

# javascript - Javascript Text Anti-alias - 没有字体可以吗？

> ID：12411152
> 
> 赞同：0
> 
> 时间：2012-09-13T16:53:42.623
> 
> 标签：javascript

我需要一种在网页上消除锯齿文本的方法。正常的解决方案（闪光灯和/或图像）已失效，因为：

*   我们需要 i(Phone/Pod/Pad) 功能（忘记闪光灯）
*   由于不相关的原因，图像需要是透明的，并且能够使用 PHP 即时创建。我已经成功地在 PHP 中创建了一个带有抗锯齿文本的透明 PNG——它看起来非常糟糕，因为 PHP 想要在纯色背景上创建文本，然后删除背景。

所以看起来 javascript 是我最好的选择，之前的 SO 问题（例如[HTML 页面中的 Anti-aliased font](https://stackoverflow.com/questions/661658/anti-aliased-font-in-html-page)）已经指出 typeface.js 作为选项。但是字体不会转换我的某些字体，因为它们受版权保护。*不管有没有版权，我需要一个解决方案*。我确实有可以在网络上查看的所有必要格式的字体（eot、svg、ttf、woff），但字体还需要为每种字体创建一个单独的 .js 文件，我不知道如何手动创建它。

由于 typeface.js 已经一年半没有更新了，而我上面作为示例列出的 SO 问题已有 3 年历史，我希望有一个更新的解决方案可能对我有用。

# php - jQuery .trigger() 单独菜单 我有一个 jQuery/AJAX 函数，当从 <select>菜单更改触发时将数据发布到 php 查询并返回结果。结果放置在 中，与我的表中的</select> 菜单位于同一行。当更改选择菜单时，该功能正常工作，但我也想在页面加载上触发此功能。我试过使用 .trigger(change); 在我的代码的末尾，但所做的只是将结果（在这种情况下为 2，

> ID：12411154
> 
> 赞同：0
> 
> 时间：2012-09-13T16:53:43.810
> 
> 标签：php, javascript, jquery, html

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:14:03.157

尝试使ajax同步：

```
async: false 
```

# java - groovy sql withbatch的问题

> ID：12411159
> 
> 赞同：0
> 
> 时间：2012-09-13T16:54:13.883
> 
> 标签：java, sql, groovy

我通常不会发布有关 API 的问题，但我完全被难住了。我正在尝试使用 groovy 的 withBatch() 方法，但它对我很不利。这是我正在尝试的：

```
connection.withBatch ('insert into SCHEMA.TABLE(VALUE,VALUE,VALUE,VALUE,VALUE,VALUE,VALUE,VALUE,VALUE,VALUE,VALUE,VALUE) values (?,?,?,?,?,?,?,?,?,?,?,?)') { ps ->
    for(def dom : domain.domainData)
    {
        def values = dom.collect {key, value -> value}
        ps.addBatch(values)
    } 
```

我不断得到这个：

> groovy.lang.MissingMethodException：没有方法签名：groovy.sql.Sql.withBatch() 适用于参数类型：(java.lang.String, ...updater.InsertAllService$_updateData_closure1) 值：[插入 SCHEMA.TABLE (值,值,值,值,值,值,值,值,值,值,值,值,值) 值 (?,?,?,?,?,?,?,?,?,?,?,? ), ...updater.InsertAllService$_updateData_closure1@74eb011d] 可能的解决方案：withBatch(groovy.lang.Closure), withBatch(int, groovy.lang.Closure), isWithinBatch()

（出于隐私原因，我不得不取出值和包名称）

我整个早上都在修补这个，尝试不同的东西（包括其他 withBatch 方法），但我一直收到同样的错误。有人看到我在做什么吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:37:19.087

什么版本的 Groovy？采用 String 和 Closure的`withBatch`变体仅在 Groovy 1.8 中引入，错误消息中的“可能的解决方案”表明您使用的是 Groovy 1.7。

# javascript - Jquery ajax 调用超时。

> ID：12411161
> 
> 赞同：1
> 
> 时间：2012-09-13T16:54:16.120
> 
> 标签：javascript, ajax, jquery

我对一组 url 进行了 ajax 调用以获取 html 内容。但是有些网址需要很长时间才能获取内容，我可以跳过那些花费超过 1 秒的网址。

```
 for (url in list) {
    $.ajax({
        'url': url,
        type: 'get',
        timeout: 1000,
        success: function () {
            //doSomething
        },
        complete: function () {
            //what to write?
        }
    });

} 
```

如果超时并执行完整的功能，你能帮我如何中止ajax调用吗？

让我知道我是否不清楚。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:05:25.860

首先，更改`$.ajax(function() {`为`$.ajax({`，因为您尝试使用的参数是一个对象，而不是一个函数。

由于您在选项对象中指定了超时，因此如果页面没有及时响应，`error`只要您指定一个，ajax 方法就会告诉您的函数。

```
$.ajax({
  'url': yourUrlHere,
  success: function(){ /*do stuff*/ },
  timeout: 1000,
  error: function(xhr, status, err){ 
    //status === 'timeout' if it took too long.
    //handle that however you want.
    console.log(status,err); 
  }
}); 
```

请参阅[此处](http://api.jquery.com/jQuery.ajax/)[的文档`$.ajax`](http://api.jquery.com/jQuery.ajax/)，因为它对该功能有很好的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:06:48.067

如果发生这种情况，您可以中止请求并继续下一个..

```
var ajaxRequests = null;
for(url in list){
    var newRequest = $.ajax({
    type: 'GET',
    url: url,
    data: '{}',
    dataType: 'json',
    beforeSend: function() {
        var r = ajaxRequest;
        if (r != null && r != undefined) {
            r.abort();
        }
    },
    success: function(result) {
        // what has to be done if the ajax request comes through
    },
    complete: function() {
        ajaxRequests = null;
    }
    ajaxReqs = newRequest;
} 
```

# php - jQuery 验证插件和服务器端 php 验证

> ID：12411162
> 
> 赞同：-3
> 
> 时间：2012-09-13T16:54:16.563
> 
> 标签：php, jquery, validation

我有一个关于 php 验证的问题，我有这个脚本

```
$(document).ready(function(){
// validate signup form on keyup and submit
var validator = $("#contactform").validate({
    rules: {
        email: {
            email: true,
            required: true,
            remote: { url: "test.php", type: "post" }
        }
    },
    messages: {
        email: {
            email: "Enter a valid email adress",
            required: "This input is required",
            remote: "Email adress is in use"
        }
    },
    // set this class to error-labels to indicate valid fields
    success: function(label) {
        label.addClass("checked");
    }
});
}); 
```

并且来自 test.php 的验证脚本是

```
define('__ROOT__', dirname(dirname(dirname(__FILE__)))); 
require_once (__ROOT__.'/config.php');

$email = mysql_real_escape_string($_POST['email']);
$SQL = $mysqli->query("SELECT * FROM users WHERE email='$email'");
    If($SQL->num_rows == 0) {
        echo 'true';
    } else {
        echo 'false';
    } 
```

如何使 php 文件的验证更复杂，例如：我想添加一个规则来检查电子邮件是否有效（以防万一有人没有激活 javascript）但是如果我尝试这样的验证如果电子邮件地址在数据库中，脚本不会返回错误消息

```
If(filter_var($email, FILTER_VALIDATE_EMAIL) == false) {
$SQL = $mysqli->query("SELECT * FROM users WHERE email='$email'");
    If($SQL->num_rows == 0) {
        echo 'true';
    } else {
        echo 'false';
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:25:42.020

`remote`使用`jquery.validate`. _ 检查您是否执行了以下操作：

**1)**确保您只使用 jQuery ***1.6.1***及更高版本。

**2)**使用“同步”选项进行远程执行（默认为异步）并将`async`选项设置为`false`.

**用法：**

```
$("#contactform").validate({
  rules: {
    email: {
      required: true,
      email: true,
      remote: { url:"check.php", async:false }
    }
  }
}); 
```

# c# - 将面包屑菜单添加到 Orchard CMS 1.5

> ID：12411168
> 
> 赞同：1
> 
> 时间：2012-09-13T16:54:26.220
> 
> 标签：c#, asp.net-mvc, orchardcms

使用 Orchard 1.5（据说它内置了对面包屑的支持）我对如何将面包屑添加到特定页面感到困惑。例如，我有一个 Bio 页面。我想在页面顶部添加一个面包屑，如下所示：

主页 > 简历 > John Doe

我是从“Bios”内容类型、左侧的导航选项还是在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T19:28:10.367

添加一个菜单小部件，将其配置为显示为面包屑。

# php - 使用端口 3307 连接到 MySql

> ID：12411171
> 
> 赞同：0
> 
> 时间：2012-09-13T16:54:29.933
> 
> 标签：php, mysql, ajax

我正在尝试使用端口 3307 上的以下脚本远程连接到 MySql 数据库

```
 $username="user";
   $password="pass";
   $database="db"; 
   mysql_connect('ccline.dyndns.info:3307',$username,$password);

   @mysql_select_db($database) or die( "Unable to select database"); 
```

但无法连接。我在使用 3306 的数据库上使用相同的脚本。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:58:25.300

连接到远程数据库需要做三件事：

*   在防火墙上打开端口 3306。服务器和客户端的防火墙必须打开 3306 端口！
*   在 my.cnf bind-address = 0.0.0.0 让mysql绑定到所有接口
*   数据库中有足够的权限以允许远程连接

虚拟所有托管公司关闭防火墙上的 3306 端口，不允许直接远程访问。即使他们这样做，您也不会获得连接到数据库的权限。

仅当远程数据库在您的 LAN 中，或者您使用具有 root 访问权限的 VPS 时，您才能进行配置以建立远程连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:59:32.573

第一：您错过了使用 mysqli_* 函数而不是 mysql_* 函数[有关更多信息，请查看此处](http://de3.php.net/manual/en/function.mysql-connect.php)

对于您的问题：我敢打赌，在您的 mysql_server **ccline.dyndns.info**上，端口 3306 / 3307 未打开......或者服务器配置为不监听不等于**localhost的请求**

因此，如果您在与 mysql 服务器相同的机器上使用 php-script，请通过**localhost:3307**连接.....

# c# - 诠释？和 int 比较在 Linq 问题中的 LEFT OUTER JOIN

> ID：12411172
> 
> 赞同：0
> 
> 时间：2012-09-13T16:54:34.953
> 
> 标签：c#, linq, linq-to-sql

我正在开发一个需要使用`Linq-To-Sql`. 我已经能够使用该`SqlMetal`工具创建我的 DataContext 并进行一些查询。但是现在我有一个我无法解决的问题。

我正在尝试制作`LEFT OUTER JOIN`如下：

```
MyDatabase db = new MyDatabase(...);

 var query = from p in db.ParentTable
             join t in db.ChildTable on new {A = p.child_ID, B = p.OtherID}
             equals new {A = t.ID, B = t.OtherID} into j1
             from c in j1.DefaultIfEmpty()
             select new
             {
                  ...
             }; 
```

`join`当我编写此查询时，在编译时会在单词中引发错误：

> join 子句中的表达式之一的类型不正确。调用“GroupJoin”时类型推断失败

`p.child_ID`我知道这个错误是由and `t.ID`since `p.child_ID`is`int?`和`t.ID`is之间的比较引起的`int`。但是，**我该如何解决这个问题？我怎样才能在`LEFT OUTER JOIN`没有这个错误的情况下执行？**

`p.child_ID`是`int?`因为此列标记`IS NULL`为`SQL`。

希望有人可以帮助我，在此先感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:28:43.250

您可以使用[GetValueOrDefault()](http://msdn.microsoft.com/en-us/library/72cec0e0.aspx)方法。它检索当前 Nullable 对象的值，或对象的默认值。

就您的示例而言：

```
var query = from p in db.ParentTable
            join t in db.ChildTable on new {A = p.child_ID.GetValueOrDefault(0), B = p.OtherID}
            equals new {A = t.ID, B = t.OtherID} into j1
            from c in j1.DefaultIfEmpty()
            select new
            {
                ...
            }; 
```

如果 p.child_ID 变为空，它将返回 0。希望这会有所帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T18:19:29.153

# vb.net - 运行时动态转换 vb.net

> ID：12411175
> 
> 赞同：3
> 
> 时间：2012-09-13T16:54:49.153
> 
> 标签：vb.net, casting, dynamictype

我想知道这是否可以，假设我的项目中有一个类，在某些时候我需要将一个对象强制转换为此类类型或其他类型，但我只能在运行时知道这一点，所以在设计时我可以做这样的事情吗？

```
Dim obj = 'will be assigned something of some type.
Dim typeObj As Type = Type.GetType("xxxx.Foo")
Dim fooVar As Foo = CTypeDynamic(obj, typeObj) 
```

这会像让我们说的那样工作吗：

```
Dim x As String = "3"
Dim n As Integer = CType(x, Integer) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T10:41:37.847

你的意思是在运行时创建一个类的实例吗？

```
 Dim obj As String = "AssemblyName.YourClassName"
    Dim typeObj As Type = Type.GetType(obj)
    Dim fooVar = Activator.CreateInstance(typeObj) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-26T15:56:43.817

我不知道VB是否有这样的关键字，在c#中我是这样解决的：

```
private static T PrivDynamicCast<T>(object obj)
{
   return (T)obj;
}

public static object DynamicCast(object obj, Type targetType)
{
   var dynamicCastMethod = typeof(XType).GetMethod("PrivDynamicCast", BindingFlags.NonPublic | BindingFlags.Static);
   var tipizedCasteMethod = dynamicCastMethod.MakeGenericMethod(targetType);
   return tipizedCasteMethod.Invoke(null, new[] { obj });
} 
```

您可以轻松地将其翻译成 VB。

# asp.net - ASP.Net 4.0 OnTextChanged 事件未在 ItemTemplate (ListView) 中触发

> ID：12411177
> 
> 赞同：0
> 
> 时间：2012-09-13T16:54:53.007
> 
> 标签：asp.net, vb.net, listview, .net-4.0, updatepanel

为什么我无法访问 OnTextChanged 事件？我已经在文本框中添加了 AutoPostBack="true"。已经尝试调试但仍未触发。

以下是示例代码：

**.ASPX 代码**

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
         <asp:ListView ID="ListView1" runat="server">
             <ItemTemplate>
                 <asp:TextBox ID="TextBox1" runat="server" OnTextChanged="TextBox1_TextChanged" AutoPostBack="true"></asp:TextBox>
             </ItemTemplate>
         </asp:ListView>
    </ContentTemplate>
</asp:UpdatePanel> 
```

**.VB 代码**

```
Protected Sub TextBox1_TextChanged(sender As Object, e As EventArgs)
    Dim TextBox1 As TextBox = DirectCast(sender, TextBox)
    Label1.Text = TextBox1.Text
End Sub 
```

我在这里缺少什么？

* * *

**解决了**

我在页面加载中绑定数据源。更改为 OnPreRender 后，它的工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:09:17.547

你确定是文本框有问题吗？Label1 也必须在更新面板中才能显示新值；当异步回发触发时，只有更新面板区域会更新。确保 Label1 位于设置了 UpdateMode="Always" 的 UpdatePanel 中。

检查在文本框的事件处理程序的标记中定义了 __doPostback 的 JavaScript（应该是 onblur，但可能是 onchange）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:57:47.373

页面上有 ScriptManager 吗？那将是我的一个想法。

# ubuntu - 使用主目录的 nfs 共享时如何使用 ldap？

> ID：12411180
> 
> 赞同：1
> 
> 时间：2012-09-13T16:55:03.880
> 
> 标签：ubuntu, ldap, nfs, home-directory

最近我在我的网络中设置了一个 ldap 服务器。我正在寻找将我所有的 linux 机器连接到它但是在我继续之前我需要弄清楚一些事情。

我计划为所有主文件夹安装一个 nfs 共享到我的 san，并希望将其命名为 /homes/，因此在创建 ldap 帐户时，我将为他们的主目录创建一个文件夹。

话虽如此，我是否必须将 san 附加到 ldap 以便我可以将该文件夹的所有者设置给用户，或者我应该让 root 拥有 /home/ 文件夹，但允许用户在里面 r/w/x 任何东西所以他们可以创造任何他们想要的东西吗？

如果我不将 nfs 连接到 ldap，我可以执行 chown 10000:100000 吗？如在用户和组 id 而不是名称中？

我还注意到，当我在我的 ubuntu 机器上创建本地帐户时，我得到了一个 dave 用户和一组 dave。这是约定还是 dave 的用户和一组用户就足够了？当涉及到 ldap 的结构以及如何设置主目录时，我无法找到关于标准实践的良好文档。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T10:50:38.893

I would certainly "set the owner of that folder to the user".

You will need to setup your ldap.conf and nssswitch to work with LDAP. Then, the users which will not be created on the linux machines, will have posix attributes within LDAP that will allow you to set the homeDirectory, the primary group (which certainly can be different than the user).

We do a lot of work with various organizations and have provided some information on [LDAP for Linux and Unix Clients](http://ldapwiki.willeke.com/wiki/LDAP%20for%20Linux%20and%20Unix%20Clients)

-jim

# sql - 将周日期部分编号转换为周内的日期（...的周）

> ID：12411185
> 
> 赞同：3
> 
> 时间：2012-09-13T16:55:24.203
> 
> 标签：sql, tsql, sql-server-2005, week-number, datepart

我试图弄清楚如何将一周的日期部分转换为该周的星期一。

我正在使用这个：

```
 datepart(ww, DateCompleted) as week 
```

按周对我们系统中的一组订单进行分组。我的目标是这样说而不是 37，我希望它返回第 37 周的星期一，即：2012 年 9 月 10 日。我可以通过定义每周每个数字来做到这一点，但我不想每周花太多时间打字，因为那里可能有更好的选择，我只是无法在 MySQL 之外的任何地方在线找到它和其他编程语言（我需要 T-SQL，或者任何可以在 sql server 2005 上工作的语言），我不知道如何使用它。感谢任何可以提供帮助的人。如果需要，我会尽可能多地回来查看以提供更多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:11:14.870

您可以结合[`DATEADD`](http://msdn.microsoft.com/en-us/library/ms186819.aspx)并[`DATEPART`](http://msdn.microsoft.com/en-us/library/ms174420)获得所提供日期的星期一：

```
DATEADD(day, (-1 * DATEPART(dw, datecompleted)) + 2, datecompleted) 
```

[在这里找到的](http://www.sqlfiddle.com/#!3/c9412/7/0)例子

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:09:54.237

当然，我在发布此内容后立即找到了解决方案，感谢任何寻找并尝试提供帮助的人。这是我找到的解决方案：

```
SET DATEFIRST 1
declare @wk int  set @wk = 1
declare @yr int  set @yr = 2007

select dateadd (week, @wk, dateadd (year, @yr-1900, 0)) - 4 -
     datepart(dw, dateadd (week, @wk, dateadd (year, @yr-1900, 0)) - 4) + 1 
```

在此链接中找到：

[http://social.msdn.microsoft.com/Forums/en/transactsql/thread/cf233caf-4ccd-4bca-add2-b5eb467f2dd4](http://social.msdn.microsoft.com/Forums/en/transactsql/thread/cf233caf-4ccd-4bca-add2-b5eb467f2dd4)

# ios - iOS 子类化 UIView - 如何从 ViewController 调用 UIButton 方法？

> ID：12411193
> 
> 赞同：0
> 
> 时间：2012-09-13T16:55:57.080
> 
> 标签：ios, uiview, methods, uibutton

我有一个自定义 UIView 用于显示弹出框（在 iPhone 上）。在弹出窗口中有一些 UIButtons，我需要从 ViewController 的类（不是 UIView 的类，而是显示 UIView 的视图）中调用方法。

我该如何正确设置？

位于自定义 UIView 类中的 UIView 按钮代码：

```
 UIButton *logoutButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [logoutButton setTitle:@"Logout" forState:UIControlStateNormal];
    [logoutButton setFrame:CGRectMake(0, 0, content.frame.size.width, 44)];
    [logoutButton addTarget:self.superview.superview action:@selector(logout) forControlEvents:UIControlEventTouchUpInside];
    [logoutButton setBackgroundImage:redImage forState:UIControlStateNormal];
    [logoutButton setBackgroundImage:redImageHighlight forState:UIControlStateHighlighted];
    [logoutButton setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
    [content addSubview:logoutButton]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:02:08.617

最好的方法是在你的 UIView 子类中使用委托模式来在你的注销按钮被按下时通知所有者。在视图控制器中创建视图实例时，将委托设置为 self。

[在http://enroyed.com/ios/delegation-pattern-in-objective-c-and-writing-custom-delegates/](http://enroyed.com/ios/delegation-pattern-in-objective-c-and-writing-custom-delegates/)中查看“编写自定义代表”

您*无法*以您在上面的代码中尝试执行的方式访问连接到超级视图的 ViewController。

或者，您可以发布通知。例如，发送一条应用程序范围的消息，表明应该执行注销。查看 NSNotificationCenter 了解如何执行此操作。

就像是：

```
[[NSNotificationCenter defaultCenter] postNotificationName:kShouldLogOutNotification object:nil]; 
```

编辑：您肯定希望在您的用例中使用委托。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:10:13.943

Ok so I do believe that creating a custom delegate is the PROPER way to handle this problem. However, I did discover that this method works correctly (not sure if it is "proper" though)

```
[logoutButton addTarget:self.superview action:@selector(logout) forControlEvents:UIControlEventTouchUpInside]; 
```

This seems to tell the button to use the class (ViewController) of it's superview (UIView). Again, not sure if this is the proper/correct way to call a method from the main view controller, but it works without a problem so it seems useable.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:06:44.153

这类事情通常是通过*委托*来完成的，这是 UIKit 中大量使用的设计模式。请参阅：[iOS 委托的目的是什么？](https://stackoverflow.com/questions/7052926/what-is-the-purpose-of-an-ios-delegate)

# haskell - 为什么 ghci 找不到 EIther b 的 Monad 实例

> ID：12411194
> 
> 赞同：1
> 
> 时间：2012-09-13T16:56:00.703
> 
> 标签：haskell, typeclass

所以，已经几个月了，我有点生疏了，但我似乎记得我`Either b`是一个`Monad`

```
Prelude Control.Monad Data.Either> return "Hello" :: Either String String

<interactive>:0:1:                                                       
    No instance for (Monad (Either String))                              
      arising from a use of `return'                                     
    Possible fix:                                                        
      add an instance declaration for (Monad (Either String))            
    In the expression: return "Hello" :: Either String String            
    In an equation for `it':                                             
        it = return "Hello" :: Either String String                      
Prelude> Right "Hi" == return "Hi"                                    

<interactive>:0:15:                                                   
    No instance for (Monad (Either a0))                               
      arising from a use of `return'                                  
    Possible fix: add an instance declaration for (Monad (Either a0)) 
    In the second argument of `(==)', namely `return "Hi"'            
    In the expression: Right "Hi" == return "Hi"                      
    In an equation for `it': it = Right "Hi" == return "Hi" 
```

所以我可能做错了什么，但我不确定是什么。我正在使用 GHC 7.2.2。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T18:05:38.370

从 开始[`base-4.6.0.0`](http://hackage.haskell.org/package/base-4.6.0.0)，`Monad`和的`Functor`实例在`Either e`中定义`Data.Either`并自动从`Prelude`.

以前，在[`base-4.3.*`](http://hackage.haskell.org/package/base-4.3.0.0)to[`base-4.5*`](http://hackage.haskell.org/package/base-4.5.0.0)中，实例是在 中定义的，`Control.Monad.Instances`并且不会自动可用。在此之前，部分与此同时，有一个

```
instance Error e => Monad (Either e) where
    ... 
```

在[`Control.Monad.Error`](http://hackage.haskell.org/packages/archive/mtl/1.1.1.1/doc/html/src/Control-Monad-Error.html)of[`mtl-1.*`](http://hackage.haskell.org/package/mtl-1.1.1.1)和 in[`Control.Monad.Trans.Error`](http://hackage.haskell.org/packages/archive/transformers/0.1.0.0/doc/html/src/Control-Monad-Trans-Error.html)从[`transformers`](http://hackage.haskell.org/package/transformers)包中定义。这些模块仍然有条件地提供实例（现在没有`Error`约束），如果它们与`base < 4.3`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T17:02:13.073

导入`Control.Monad.Trans.Error`或`Control.Monad.Error`. `Either a`monad 实例通常用于错误处理。

```
> return "Hello" :: (Either String String)
Right "Hello" 
```

# machine-learning - 进化计算可以成为强化学习的一种方法吗？

> ID：12411197
> 
> 赞同：13
> 
> 时间：2012-09-13T16:56:12.800
> 
> 标签：machine-learning, artificial-intelligence, reinforcement-learning, evolutionary-algorithm

什么是*进化计算*？它是一种强化学习的方法吗？还是一种单独的机器学习方法？或者可能没有？

请引用用于回答此问题的参考资料。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-08T16:02:32.960

有一些进化方法明确旨在解决强化学习问题。该子领域通常称为学习分类器系统 (LCS)，有时也称为基于遗传学的机器学习 (GBML)。

除此之外，我不确定您的问题是否有一个非常明确的答案。它基本上归结为“什么是机器学习？” 对于如何回答这个问题，我们都没有一致同意的标准。对于某些人来说，EC 可能是该子领域的一部分。对于其他人，它不是。我刚刚从书架上挑选了几本 ML 教科书，其中大约一半包含关于进化方法的材料。我怀疑 15 年前这个比例会更高，但时尚在改变，机器学习现在几乎是统计学的一个子领域。EC 方法不太适合这种模式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T19:24:31.043

进化计算或进化算法是优化算法，当应用于神经网络（如神经进化）时，当然可以归类为强化学习的一种形式，尽管它的工作方式与通常的强化学习算法有点不同。

通常，在诸如遗传算法或进化策略之类的进化算法中，您需要优化整个个体群体。对于这些个体中的每一个，质量函数用于确定他们的“适合度”（如“适者生存”），并为下一代选择最佳个体。然后，这些“父母”会被随机复制、修改、变异，甚至相互重新组合——在每种不同的算法中，这究竟是如何完成的有点不同。最后，那些新的突变和/或重组的父母形成了下一代的种群，这个过程再次开始，直到达到某种期望的质量，或者质量达到水平。

在神经进化的情况下，个体是神经网络，通过随机改变权重（而在经典神经网络中，权重根据非常精确的数学规则更新）甚至改变它们的拓扑结构和个体的质量而发生变异取决于他们在训练数据上的表现。

抱歉，这里没有严格的科学参考，但也许这仍然有助于澄清一些事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-14T15:57:45.550

强化学习 [1] 和进化计算 [2] 之间的主要区别在于，原始意义上的 RL 是应用于环境中的代理，学习策略（另见关于[强化学习](http://en.wikipedia.org/wiki/Reinforcement_learning)的维基百科文章），而 EC 更多的是一类搜索算法的通用术语，它使用“进化”启发的方法来优化搜索。我根本不会将 EC 归类为机器学习，而且我还没有找到这样的来源。

[1] 强化学习：介绍 - RS Sutton, AG Barto - 1998 - 剑桥大学出版社

[2] 什么是进化计算？- DB Fogel - 频谱，IEEE，2000

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-27T15:06:01.823

2017 年更新：答案是肯定的。[过去一个月在强化学习中下载次数最多的论文](https://arxiv.org/abs/1703.03864)，恰如其分地命名为“**进化策略作为强化学习的可扩展替代方案**”确实是城里的话题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T13:31:42.300

> 那么，进化计算在哪里？它是一种强化学习的方法吗？还是一种单独的机器学习方法？或者可能没有？

我认为 EC 和 ML 是截然不同的。但是，有一些很棒的应用程序可以结合使用。虽然这已经是一个小领域的研究很长一段时间了，但我觉得在结合 EC 和 ML 的领域有一些唾手可得的成果。我认为很多人没有耐心看透这些想法。

# c - For循环使我的程序崩溃？

> ID：12411200
> 
> 赞同：0
> 
> 时间：2012-09-13T16:56:22.530
> 
> 标签：c

无论出于何种原因，`for`循环`getLetters`都会导致崩溃。

我无法在其中挑选出特定的来源，也许有人可以提供帮助？

我想我可能做错了我的指针。我应该如何解决这个问题？

```
#include <stdio.h>
#include <string.h>
#include <time.h>

int main() {
    FILE *ifp;
    ifp = fopen("dictionary.txt", "r");
    int* lValues[26];
    int* lDist[26];
    int* lUsed[26];
    int*fRun = 0;
    int dictLen;
    int i;
    int bestValue;
    fscanf(ifp, "%d", &dictLen);
    char bestWord[7];
    char dictionary[dictLen][7];
    char* letters[7];
    char* userWord[7];

    //reads the dictionary into the array
    for (i = 0; i < dictLen; i++) {
        fscanf(ifp, "%s", &dictionary[i]);
    }

    distribution();
    values();

    while (i != 2) {

        getLetters();

        printf("Welcome to the Scrabble Practice Program!\n");
        printf("\nHere are your letters: %s \n", letters);
        printf("\nWhat would you like to do?\n");
        printf("\t1-Enter Word\n");
        printf("\t2-Quit\n\n");
        printf("User Selection:");
        scanf("%d", &i);
    }

    //fclose(ifp); not sure why, but this crashes the program

    return 0;
}

//Gets the user's set of letters
void getLetters() {
    char* letters[7];
    int* lDist[26];
    int* lUsed[26];
    int lCur;
    int i;

    srand(time(0));

    for (i = 0; i < 7; i++) {

        *letters[i] = 65 + rand()%26;
        lCur = (int)*letters[i] - 65;

        while (*lUsed[lCur] >= *lDist[lCur]){

            *letters[i] = 65 + rand()%26;
            lCur = (int)*letters[i] - 65;
        }

        *lUsed[lCur]++;
    }
}

//Sets the number of each letter available for distribution
void distribution() {
    int* lDist;

    //Number for A
    lDist[0] = 9;

    //Number for B
    lDist[1] = 2;

    //Number for C
    lDist[2] = 2;

    //Number for D
    lDist[3] = 4;

    //Number for E
    lDist[4] = 12;

    //Number for F
    lDist[5] = 2;

    //Number for G
    lDist[6] = 3;

    //Number for H
    lDist[7] = 2;

    //Number for I
    lDist[8] = 9;

    //Number for J
    lDist[9] = 1;

    //Number for K
    lDist[10] = 1;

    //Number for L
    lDist[11] = 4;

    //Number for M
    lDist[12] = 2;

    //Number for N
    lDist[13] = 6;

    //Number for O
    lDist[14] = 8;

    //Number for P
    lDist[15] = 2;

    //Number for Q
    lDist[16] = 1;

    //Number for R
    lDist[17] = 6;

    //Number for S
    lDist[18] = 4;

    //Number for T
    lDist[19] = 6;

    //Number for U
    lDist[20] = 4;

    //Number for V
    lDist[21] = 2;

    //Number for W
    lDist[22] = 2;

    //Number for X
    lDist[23] = 1;

    //Number for Y
    lDist[24] = 2;

    //Number for Z
    lDist[25] = 1;
}

//Sets the value of all of the letters
void values() {

    int* lValues;

    //Value of A
    lValues[0] = 1;

    //Value of B
    lValues[1] = 3;

    //Value of C
    lValues[2] = 3;

    //Value of D
    lValues[3] = 2;

    //Value of E
    lValues[4] = 1;

    //Value of F
    lValues[5] = 4;

    //Value of G
    lValues[6] = 2;

    //Value of H
    lValues[7] = 4;

    //Value of I
    lValues[8] = 1;

    //Value of J
    lValues[9] = 8;

    //Value of K
    lValues[10] = 5;

    //Value of L
    lValues[11] = 1;

    //Value of M
    lValues[12] = 3;

    //Value of N
    lValues[13] = 1;

    //Value of O
    lValues[14] = 1;

    //Value of P
    lValues[15] = 3;

    //Value of Q
    lValues[16] = 10;

    //Value of R
    lValues[17] = 1;

    //Value of S
    lValues[18] = 1;

    //Value of T
    lValues[19] = 1;

    //Value of U
    lValues[20] = 1;

    //Value of V
    lValues[21] = 4;

    //Value of W
    lValues[22] = 4;

    //Value of X
    lValues[23] = 8;

    //Value of Y
    lValues[24] = 4;

    //Value of Z
    lValues[25] = 10;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:59:56.187

```
*letters[i] = 65 + rand()%26; 
```

letter[i] 没有任何意义（未初始化），你可以得到`Access violation fault`.

更远

```
char* letters[7];
int* lDist[26];
int* lUsed[26]; 
```

所有这些都是`arrays of pointer`而不是基本类型的数组（即 int、char 等）。我想你可能想要

```
char letters[7];//Array of seven characters
int lDist[26];//Array of 26 ints
int lUsed[26];//Array of 26 ints 
```

并开始`*letters[i]`简单地称为`letters[i]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:00:14.953

函数中的每一个数组访问`getLetters`都可能导致一个问题：您声明了三个从未初始化的指针数组，因此每当您取消引用任何数组的元素时，您都会取消引用垃圾内存地址，有时会尝试写入该地址内存地址。

从您的代码中不清楚为什么需要*指针*数组。

为什么不简单：

```
char letters[7];
int lDist[26];
int lUsed[26]; 
```

并摆脱取消引用？

但即便如此，该功能也存在问题。你需要初始化你的数组值，至少`lDist`和`lUsed`. 您可以与 的元素进行比较，`lDist`但绝不会更改这些值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:10:03.380

上面的代码似乎没有按照您的意图进行。当你声明变量时

```
char* letters[7]; 
```

...您声明的是 7 `char *`s 的数组，而不是 7 `char`s。因此，当你说

```
*letters[i] = 65 + rand()%26; 
```

...您首先索引数组并检索 index 处的指针`i`。然后，您取消引用该指针并尝试在其中存储一个字符。问题是`letters`从未初始化，并且很可能充满垃圾：对于任何 value `i`，`letters[i]`将返回一个随机值。因此，当您尝试将其作为地址取消引用时，您正在索引其他人的内存，并且写入它会导致分段错误。

您似乎打算像这样声明`letters`（和`lDist`和`lUsed`）：

```
char letters[7];
int lDist[26];
int lUsed[26]; 
```

`char`这意味着一个长度为 7的 s 数组。然后您可以在不取消引用的情况下处理它们：

```
letters[i] = 65 + rand()%26; 
```

您也可以按照以下方式执行上述操作...</p>

```
*(letters + i) = 65 + rand()%26; 
```

......但你通常并不意味着将两者混合在一起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T16:59:19.017

`letters`,`lDist`并且`lUsed`是指针数组（未初始化）。为什么不使用数组来代替？

```
#include <stdlib.h>
#include <time.h>

void getLetters(void)
{
    char letters[7];
    int lDist[26];
    int lUsed[26];
    int lCur;
    int i;

    srand(time(NULL));

    for (i = 0; i < 7; i++) {
        letters[i] = 65 + rand() % 26;
        lCur = (int) letters[i] - 65;

        while (lUsed[lCur] >= lDist[lCur]) {
            letters[i] = 65 + rand() % 26;
            lCur = (int) letters[i] - 65;
        }

        lUsed[lCur]++;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T17:02:22.960

无需使用指针，使用普通数组即可，如下所示（我还为 lUsed 和 lDist 添加了初始化）：

```
void getLetters() {
    char letters[7];
    int lDist[26];
    int lUsed[26];
    int lCur;
    int i;

    srand(time(0));

    // initialize the arrays
    for (i=0;i<26;i++) {
        lUsed[i] = lDist[i] = 0;
    }

    for (i = 0; i < 7; i++) {

        letters[i] = 65 + rand()%26;
        lCur = (int)letters[i] - 65;

        while (lUsed[lCur] >= lDist[lCur]){

            letters[i] = 65 + rand()%26;
            lCur = (int)letters[i] - 65;

        }

        lUsed[lCur]++;

    }
} 
```

# url-rewriting - SignalR 重写规则导致 Chrome 退回到长轮询

> ID：12411206
> 
> 赞同：2
> 
> 时间：2012-09-13T16:56:54.293
> 
> 标签：url-rewriting, cross-domain, signalr, server-sent-events, signalr.client

从服务器[https://a.local](https://a.local)，我连接到 SignalR 连接：

```
/gateway/signalr/status (so https://a.local/gateway/signalr/status) 
```

然后会遇到处理跨域调用的 URL 重写规则。该规则将请求转换为：

```
https://b.local/signalr/status 
```

这工作正常并收到消息。但是，在 Chrome（和 FF）中，它尝试与传输服务器SentEvents 连接，超时然后回退到 longPolling。

使用测试页面时传输服务器SentEvents 确实连接

```
https://b.local/signalr/test.html 
```

所以我知道这种传输没有问题，只是重写规则有些奇怪。

我需要做些什么特别的事情才能让它工作吗？我是否需要以某种方式配置 IIS 以使 serverSentEvents 使用重写规则？

谢谢你的帮助。

# iphone - 应用因使用 libsqlite3.dylib 而被拒绝

> ID：12411208
> 
> 赞同：2
> 
> 时间：2012-09-13T16:57:11.947
> 
> 标签：iphone, app-store, submission

我可以使用 adhoc 分发和测试我的应用程序，但是当我在管理器中验证应用程序商店提交时（xcode 4.3.2 - 产品>存档>验证）我收到以下错误

*   您的应用包含非公共 API 使用
*   该应用程序引用了有效载荷/appname.app/libsqlite3.dylib 中的非公共符号：_dispatch_source_type_vm

我的应用程序使用 sqlite3 存储从 youtube 获取的数据，即视频标题和相应的图像 url（最多 10 条记录）

我已经删除并添加了 lib 文件，将部署目标设置为 4.0，请帮助

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-22T06:03:55.320

从 Apple 团队获得解决方案

*   Apple 的回应（DTS - 开发者技术支持）：

“您应该只链接到 libsqlite3.dylib 库。您不需要将其复制到您的应用程序中，因为 iOS 附带 SQLite3 库”。

*   解决方案：

从 xcode 中删除 libsqlite3.dylib 并将“-libsqlite3”添加到 Project > Build Settings 和 Target > Build Settings 下的“Other Linker Flags”。

* * *

验证成功，并将应用程序提交到应用商店进行审核...只是更新仅供参考 应用程序获得批准

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-13T00:10:33.340

正确的标志应该是“-lsqlite3”，因为 ls 语法是（参见 $man ld）：

-lx 此选项告诉链接器在库搜索路径中搜索 libx.dylib 或 libx.a。如果字符串 x 的形式为 yo，则在相同的位置搜索该文件， **但不会`lib' or appending`在文件名前添加 .a' 或 `.dylib'**。

如果你使用'-libsqlite3' 作为标志，你会得到“找不到库”链接器错误。

# 3d - 对非平面多边形进行三角剖分

> ID：12411209
> 
> 赞同：4
> 
> 时间：2012-09-13T16:57:12.750
> 
> 标签：3d, polygon, mesh, triangulation

我想对非平面多边形进行三角剖分（即顶点**不在**同一个 3D 平面上）。多边形由许多点（数百个）组成。三角形表面不必是光滑的。事实上，密度越大越好。

我最初的想法是：

*   NURBS
*   在“多边形内”生成附加点并应用 3D Delaunay 三角剖分。
*   只需将一个（或几个）更多顶点“放在中间”并将它们与轮廓顶点连接起来。

我不确定这些想法中的哪一个适用于我的情况，或者也许有更好的方法？

**更多细节**：即使轮廓上的点有数百个，它们也可以分为 3 到 10 个子集，这样每个子集都非常接近一条线。尽管如此，生成的线条仍然不在同一平面上。人们可以把它想象成一群鸟，它们以多边形的形式飞行，但不完全相同的垂直高度。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-21T12:30:39.313

我最终做了以下事情：

1.  将平面拟合到这些点。
2.  将点投影到平面拟合。
3.  将点变换到平面拟合的坐标系中，使得每个点都有一个二维坐标（x，y）和一个深度z
4.  计算点云的边界。
5.  在边界内生成额外的 2D 点（可以使用等距点或变形点，无论其密度如何）。
6.  在所有点（边界 + 生成点）上运行 2D Delaunay 三角剖分。
7.  根据边界深度值对生成的内部点的深度值进行插值。可以使用任何类型的插值 - 我使用了 MATLAB 的 triscatteredinterp() ，它工作得很好。
8.  使用 (3) 中的逆变换将所有点平移回来
9.  使用 (6) 中的三角剖分和 (8) 中获得的点。

你可以在这里看到结果： [http ://www.youtube.com/watch?v=4AqHxKsM7Iw&feature=g-upl](http://www.youtube.com/watch?v=4AqHxKsM7Iw&feature=g-upl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T08:55:09.987

您可能想看[看点云库](http://pointclouds.org/about.html)。其中，它可以进行表面重建。

# python - Python Gevent SocketIO内存泄漏断开连接未触发

> ID：12411215
> 
> 赞同：2
> 
> 时间：2012-09-13T16:57:27.470
> 
> 标签：python, socket.io, gevent

我已经为此苦苦挣扎了好几个小时了。这是一个非常简单的应用程序，类似于基本的聊天，除了服务器只向客户端发送消息。我的问题的基础是内存泄漏。我尝试将应用程序重构为更加无状态。我已按照[本指南](http://www.lshift.net/blog/2008/11/14/tracing-python-memory-leaks)跟踪内存泄漏。我无法理解这些图表。以后我可能会更深入。首先，我注意到断开连接没有触发，它确实进行了一些清理，例如杀死小绿灯。 **为什么断开连接不触发？**如果有人能给我一些见解，将不胜感激。

[https://gist.github.com/a53d1acc83b06b16d263](https://gist.github.com/a53d1acc83b06b16d263)

```
from gevent import monkey; monkey.patch_all()
import gevent
import redis
import json
import phpserialize

from socketio import socketio_manage
from socketio.server import SocketIOServer
from socketio.namespace import BaseNamespace
from socketio.mixins import BroadcastMixin, RoomsMixin

r = redis.StrictRedis(host='localhost', port=6379)

class ShoutsNamespace(BaseNamespace):

    def listener(self, room):
        r = redis.StrictRedis()
        r = r.pubsub()

        r.subscribe(room)

        for m in r.listen():
            if m['type'] == 'message':
                data = json.loads(m['data'])
                self.emit("shouts", data)

    def initialize(self):
        print 'Connected'

    def on_join(self, room):
        self.emit("shouts", json.loads(r.hget('ffxi.shouts', room)))
        self.spawn(self.listener, 'ffxi.shouts:'+room)
        return True

    def recv_disconnect(self):
        print 'Disconnected'
        self.disconnect(silent=True)

class PingNamespace(BaseNamespace):
    def on_ping(self, message):
        print message

class Application(object):
    def __init__(self):
        self.buffer = []

    def __call__(self, environ, start_response):
        path = environ['PATH_INFO'].strip('/')
        if path.startswith('static/'):
            try:
                data = open(path).read()
            except Exception:
                return not_found(start_response)

            if path.endswith(".js"):
                content_type = "text/javascript"
            elif path.endswith(".css"):
                content_type = "text/css"
            elif path.endswith(".swf"):
                content_type = "application/x-shockwave-flash"
            else:
                content_type = "text/html"

            start_response('200 OK', [('Content-Type', content_type)])
            return [data]

        if path.startswith("socket.io"):
            socketio_manage(environ, {'/ping': PingNamespace, '/shouts': ShoutsNamespace })
        else:
            return not_found(start_response)

def not_found(start_response):
    start_response('404 Not Found', [])
    return ['<h1>Not Found</h1>']

if __name__ == '__main__':
    SocketIOServer(('216.144.246.171', 443), Application(), resource="socket.io", policy_server=False, transports=['xhr-polling']).serve_forever() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T10:57:11.170

recv_disconnect 由用户触发，而不是服务器触发。您必须让用户断开连接（添加链接或按钮？）或使用“beforeunload”或“unload”等事件来调用它。在这两种情况下，您都需要调用 socket.disconnect()。

例子：

```
$(window).on('beforeunload',function(){socket.disconnect();}); 
```

希望这对您有所帮助。

最好的祝福，

安德烈亚斯

# javascript - 在 Knockout 中连接 CSS 名称

> ID：12411216
> 
> 赞同：5
> 
> 时间：2012-09-13T16:57:32.397
> 
> 标签：javascript, css, asp.net-mvc, knockout.js

我想知道如何为我的 Knockout ViewModel 中的项目应用使用 $data 连接的 css 类名称。

## 目标

当用户单击“Praise”按钮（我的 ViewModel 数组中的一个项目）时，我想将 css 类“feedbackItemIconPraise”应用于 LI。如果用户点击“批评”，我想申请“feedbackItemIconPraise”类。

我认为使用 $data 在 data-bind 属性中连接一个 css 类是可行的方法，但可能是错误的。

## 代码

我的 ViewModel 的相关部分：

```
var FeedbackViewModel = function () {
    var self = this;
    self.feedbackItemTypes = ['Praise', 'Criticism', 'Problem', 'Question'];
    self.selectedFeedbackType = ko.observable('Praise');
    self.updateSelected = function (param) {
        self.selectedFeedbackType(param);
    };
};

var feedbackViewModel = new FeedbackViewModel();

ko.applyBindings(feedbackViewModel, document.getElementById("feedbackModal")); 
```

我的视图显示的相关部分：

```
<div id="feedbackListContainer">
    <ul class="thumbnails" id="feedbackList" data-bind="foreach: feedbackItemTypes">
       <li class ="feedbackItem" data-bind="click: $parent.updateSelected, text:$data, attr:{id:'feedbackItem'+$data, title:$data}, css: {'feedbackItem-Highlighted':$data==$parent.selectedFeedbackType(), 'feedbackItemIcon'+$data: true}">
        </li>
        </ul>
</div> 
```

## 问题

我认为我错的是应用 CSS 类“'feedbackItemIcon' + $data”。我想我误解了 css 类的应用方式，以及这在 Knockout 中是否可行，或者与 Knockout 的工作方式不一致。当我尝试这样做时，我的所有文本都消失了，所以我认为我完全搞砸了语法。

将不胜感激一些见解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:20:40.460

您非常接近正确的解决方案。

```
'feedbackItemIcon'+$data: true 
```

你是对的。**这不起作用**，因为 Knockout 不会更新此表达式的左侧。

相反，我会简单地列出所有枚举值并编写如下内容：

```
css: {'feedbackItem-Highlighted':$data==$parent.selectedFeedbackType(), 'feedbackItemIconPraise': $data==$parent.selectedFeedbackType() && $data='Praise', 'feedbackItemIconCriticism': $data==$parent.selectedFeedbackType() && $data='Criticism', 'feedbackItemIconProblem': $data==$parent.selectedFeedbackType() && $data='Problem', 'feedbackItemIconQuestion': $data==$parent.selectedFeedbackType() && $data='Question' } 
```

我知道它看起来有点难看，而且似乎有点重复，但是 AFAIK，没有办法将模板项绑定到其值将在运行时更改的 CSS 类名。

仅供参考：您可能已经意识到这一点，但对于未来的访问者，这里是[指向 CSS 绑定的 Knockout 文档的链接](http://knockoutjs.com/documentation/css-binding.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T20:08:00.737

[在此处](https://github.com/SteveSanderson/knockout/wiki/Bindings---class)使用`class`自定义绑定，您可以通过不同的方式执行此操作：

```
<li class ="feedbackItem" data-bind="
    click: $parent.updateSelected,
    text: $data,
    attr: {id:'feedbackItem'+$data, title:$data},
    css: {'feedbackItem-Highlighted':$data==$parent.selectedFeedbackType()},
    class: 'feedbackItemIcon'+$data">
</li> 
```

此功能也将成为`css`即将推出的 2.2 版 Knockout 绑定的一部分。因此，您不必包含`class`自定义绑定。但是你不能包含两个`css`绑定。一种解决方法是只创建:`class`的别名。另一个是使用我的[key.subkey](https://github.com/mbest/knockout-key.subkey)插件，它允许这种绑定：`css``ko.bindingHandlers['class'] = ko.bindingHandlers.css`

```
<li class ="feedbackItem" data-bind="
    click: $parent.updateSelected,
    text: $data,
    attr: {id:'feedbackItem'+$data, title:$data},
    css.feedbackItem-Highlighted: $data==$parent.selectedFeedbackType(),
    css: 'feedbackItemIcon'+$data">
</li> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-16T15:39:30.553

这个答案显然迟到了，但我想提出另一种解决方案：

```
<li data-bind="attr: { 'class': ' feedbackItem ' 
                                + ($data==$parent.selectedFeedbackType() 
                                   ? ' feedbackItem-Highlighted ' : '')
                                + ' feedbackItemIcon'+$data
                     }">    </li> 
```

# c++ - 优化虚拟表查找

> ID：12411218
> 
> 赞同：5
> 
> 时间：2012-09-13T16:57:46.017
> 
> 标签：c++, compilation, compiler-optimization

使用下面的代码，编译器是否可以判断它`a`实际上是`B`虚拟表查找的一个实例并优化掉？

```
#include <iostream>

class A
{
  public:
    virtual void f()
    {
        std::cout << "A::f()" << std::endl;
    }
};

class B : public A
{
  public:
    void f()
    {
        std::cout << "B::f()" << std::endl;
    }
};

int main()
{
    B b;
    A* a = &b;
    a->f();

    return 0;
} 
```

Jonthan Seng 和 reima 回答后的附加问题：如果使用 gcc，是否有必要使用任何标志来强制它优化 vtable 查找？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:10:13.827

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-13T16:59:47.770

也许它可以——这将取决于编译器的智能和优化要求。

但是，这是一个电话。你为什么关心优化这个调用？而且，如果您确实关心，为什么不为这个电话选择正确的类型呢？

关于优化的所有问题的第一个答案是“为什么需要优化它？” 有一个性能工具报告说 50% 的应用程序时间是一个地方，并且问题得到了回答。“哦，但它效率低下”，最常见的回答会导致无法维护的代码很少优化实际上效率低下的代码。

# ruby-on-rails - Rails：不显示“ 无效”在errors.full_messages

> ID：12411226
> 
> 赞同：0
> 
> 时间：2012-09-13T16:58:21.773
> 
> 标签：ruby-on-rails, view, error-suppression

我只想显示属性的错误，而不是某个对象在视图中无效。我怎么能处理这个？

我目前使用这个：

```
<% if !@ozb_konto.errors.nil? && @ozb_konto.errors.any? %>
<div class="alert alert-error" id="error_explanation">
  <h3>Following errors occured:</h3>    
  <ul>
    <% @ozb_konto.errors.full_messages.each do |error| %>
      <li><%= error %></li>
    <% end %>
      </ul>
</div>
<% end %> 
```

这显示了所有类型的错误，这是正确的。但它也显示了`<model> is not valid`我想要抑制的错误。

我该如何处理？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:57:51.023

因为`full_messages`方法是：

```
def full_messages
  map { |attribute, message| full_message(attribute, message) }
end 
```

您可以将错误转换为哈希并根据需要输出：

```
@ozb_konto.errors.to_hash # => {:email=>["can't be blank"], :password=>["can't be blank"], :name=>["can't be blank"]} e.g 
```

# android - androidplot是否支持片段？

> ID：12411230
> 
> 赞同：0
> 
> 时间：2012-09-13T16:58:46.377
> 
> 标签：android, charts, androidplot

我需要在片段中使用 AndroidPlot 库，但它给了我一个错误。也许它不被android 4.x中的片段支持？

也许有人知道用什么更好地绘制简单的图表？

```
 09-13 16:54:19.098: E/AndroidRuntime(5114): FATAL EXCEPTION: main
09-13 16:54:19.098: E/AndroidRuntime(5114): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.plotfragment/com.example.plotfragment.MainActivity}: android.view.InflateException: Binary XML file line #14: Error inflating class com.androidplot.xy.XYPlot
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1955)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.ActivityThread.access$600(ActivityThread.java:122)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.os.Looper.loop(Looper.java:137)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.ActivityThread.main(ActivityThread.java:4340)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at java.lang.reflect.Method.invokeNative(Native Method)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at java.lang.reflect.Method.invoke(Method.java:511)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at dalvik.system.NativeStart.main(Native Method)
09-13 16:54:19.098: E/AndroidRuntime(5114): Caused by: android.view.InflateException: Binary XML file line #14: Error inflating class com.androidplot.xy.XYPlot
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:691)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:251)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.Activity.setContentView(Activity.java:1835)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at com.example.plotfragment.MainActivity.onCreate(MainActivity.java:11)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.Activity.performCreate(Activity.java:4465)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)
09-13 16:54:19.098: E/AndroidRuntime(5114):     ... 11 more
09-13 16:54:19.098: E/AndroidRuntime(5114): Caused by: java.lang.ClassNotFoundException: com.androidplot.xy.XYPlot
09-13 16:54:19.098: E/AndroidRuntime(5114):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.createView(LayoutInflater.java:552)
09-13 16:54:19.098: E/AndroidRuntime(5114):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:680) 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-03T15:48:58.603

Androidplot 适用于所有支持 Fragments (API 11+) 的平台上的 Fragment。鉴于上述错误，我的猜测是您可能没有将 Androidplot 核心库复制到您的 libs 目录中。

# r - 根据条件替换数据框中的行

> ID：12411231
> 
> 赞同：2
> 
> 时间：2012-09-13T16:58:49.783
> 
> 标签：r

我有以下数据框

```
 id f1 f2
1  a  1  3
2  b  3  5
3  c  4  7 
```

我想用一行替换所有 f1>3 的行 (id = x, f1 = 0, f2 = 0) 所以上面将映射到

```
 id f1 f2
1  a  1  3
2  b  3  5
3  x  0  0 
```

但是当我尝试

```
replace(x,which(x$f1>3),data.frame(id = 'x',f1=0,f2=0)) 
```

它没有做对，它给了

```
 id f1 f2
1  a  1  x
2  b  3  x
3  c  4  x
Warning message:
In `[<-.data.frame`(`*tmp*`, list, value = list(id = 1L, f1 = 0,  :
  provided 3 variables to replace 1 variables 
```

有人可以建议一种大规模执行此操作的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T17:03:38.907

像这样的东西：

```
 x[x$f1 > 3,] <- data.frame('x', 0, 0) 
```

应该做的伎俩！

* * *

根据@DWin 的评论，这不适用于因子`id`列。但是，使用相同的技术可以像这样工作：

```
levels(x$id) <- c(levels(x$id), 'x')
x[x$f1 > 3,] <- data.frame('x', 0, 0)
droplevels(x$id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:09:58.850

这是另一种方法（考虑到@DWin的评论）

```
dfrm <- data.frame(id=letters[1:3], f1=c(1,3,4), f2=c(3,5,7))

dfrm[dfrm$f1>3, -1] <- 0
levels(dfrm$id) <- c(levels(dfrm$id), 'x')
dfrm[,1]<- with(dfrm, replace(id, f1==0, 'x')) ; dfrm

     id f1 f2
  1  a  1  3
  2  b  3  5
  3  x  0  0 
```

使用更多数据：

```
set.seed(007); N <- 12
 f1 <- sample(1:9, N, replace=TRUE)
 f2 <- sample(1:9, N, replace=TRUE)
 dfrm2 <- data.frame(id=letters[1:N], f1=f1, f2=f2)

 dfrm2[dfrm2$f1>3, -1] <- 0
 levels(dfrm2$id) <- c(levels(dfrm2$id), 'x')
 dfrm2[,1]<- with(dfrm2, replace(id, f1==0, 'x')) ; dfrm2
   id f1 f2
1   x  0  0
2   x  0  0
3   c  2  5
4   d  1  1
5   e  3  6
6   x  0  0
7   x  0  0
8   x  0  0
9   i  2  6
10  x  0  0
11  k  2  9
12  l  3  9 
```

我删除了我以前的代码，因为它们对这个问题没有用。

# python - Django多表继承，如何知道模型的子类是哪个？

> ID：12411232
> 
> 赞同：16
> 
> 时间：2012-09-13T16:58:57.623
> 
> 标签：python, django, inheritance, subclass

我在 django 中遇到多表继承问题。

让我们以银行账户为例。

```
class account(models.Model):
    name = models……

class accounttypeA(account):
    balance = models.float…..

    def addToBalance(self, value):
        self.balance += value

class accounttypeB(account):
    balance = models.int…. # NOTE this

    def addToBalance(self, value):
        value = do_some_thing_with_value(value) # NOTE this
        self.balance += value 
```

现在，我想为帐户类型添加一个值，但我只有一个帐户对象，例如 acc=account.object.get(pk=29) 。那么，谁是 acc 的孩子？

Django 自动在 accounttypeA 和 accounttypeB 中创建一个 account_ptr_id 字段。所以，我的解决方案是：

```
child_class_list = ['accounttypeA', 'accounttypeB']

for cl in child_class_list:
    try:
        exec(“child = ” + str(cl) + “.objects.select_for_update().get(account_ptr_id=” +              str(acc.id) + “)”)
        logger.debug(“Child found and ready to use.”)
        return child
    except ObjectDoesNotExist:
        logger.debug(“Object does not exist, moving on…”) 
```

也许这是一个绘图板问题！:)

我希望我在我的例子中已经很清楚了。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-06T01:40:59.113

据我所知，没有 Django 内置的方法可以做到这一点。

但是，给定`acc=account.object.get(pk=29)`，您可以使用：

```
try:
    typeA = acc.accounttypeA
    # acc is typeA
except accounttypeA.DoesNotExist:
    # acc should be typeB if account only has typeA and typeB subclasses

try:
    typeB = acc.accounttypeB
    # acc is typeB
except accounttypeB.DoesNotExist:
    # acc should be typeA if account only has typeA and typeB subclasses 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-10T13:58:52.253

我的解决方案是基于[此](https://stackoverflow.com/a/13306529/253127)

```
class account(models.Model):
    name = models……

    def cast(self):
        """
        This method is quite handy, it converts "self" into its correct child class. For example:

        .. code-block:: python

           class Fruit(models.Model):
               name = models.CharField()

           class Apple(Fruit):
               pass

           fruit = Fruit.objects.get(name='Granny Smith')
           apple = fruit.cast()

        :return self: A casted child class of self
        """
        for name in dir(self):
            try:
                attr = getattr(self, name)
                if isinstance(attr, self.__class__) and type(attr) != type(self):                 
                    return attr
            except:
                pass

    @staticmethod
    def allPossibleAccountTypes():
        #this returns a list of all the subclasses of account (i.e. accounttypeA, accounttypeB etc)
        return [str(subClass).split('.')[-1][:-2] for subClass in account.__subclasses__()]

    def accountType(self):
        try:
            if type(self.cast()) == NoneType:
                #it is a child
                return self.__class__.__name__
            else:
                #it is a parent, i.e. an account
                return str(type(self.cast())).split('.')[-1][:-2]
        except:
            logger.exception()
    accountType.short_description = "Account type"

class accounttypeA(account):
    balance = models.float…..

    def addToBalance(self, value):
        self.balance += value

class accounttypeB(account):
    balance = models.int…. # NOTE this 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-30T11:30:54.973

Django 为类添加了`account`两个字段：`accounttypea`和`accounttypeb`. 如果你有`accounttypeB`pk=42 的对象，你可以像这样从父级访问：

```
account.objects.get(pk=42).accounttypeb
>>> <accounttypeB instance> 
```

您可以将 CharField 添加到具有实际子类型的父模型中，然后使用`getattr`，如果有很多子模型（它可能比很多`try .. except xxx.DoesNotExist`块更好）。

```
class account(models.Model):
    name = models……
    cls = CharField(...)  

    def ext(self):
        return getattr(self, self.cls.lower())

class accounttypeA(account):
    balance = models.float…..

    def addToBalance(self, value):
        self.balance += value

class accounttypeB(account):
    balance = models.int…. # NOTE this

    def addToBalance(self, value):
        value = do_some_thing_with_value(value) # NOTE this
        self.balance += value

# example
accounttypeB.objects.create(balance=10,  name='Vincent Law', cls="accounttypeB")  
accounttypeA.objects.create(balance=9.5, name='Re-l Mayer', cls="accounttypeA")  
for obj in account.objects.all():
    obj.ext().addToBalance(1.0) 
    print(obj.name, obj.cls) 
```

但是您必须使用`accounttypeA.objects.create(...)`and来创建模型`accounttypeB.objects.create(...)`- 否则这个技巧将不起作用。（[https://docs.djangoproject.com/en/1.5/topics/db/models/#multi-table-inheritance](https://docs.djangoproject.com/en/1.5/topics/db/models/#multi-table-inheritance)）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-11-05T08:24:46.897

您可以使用`hasattr()`以下方法：

```
if hasattr(account, 'accounttypea'):
   account.accounttypea.<somefield> = <some value>
   do something here....

elif hasattr(account, 'accounttypeb'):
   account.accounttypeb.<somefield> = <some value>
   do something here... 
```

它不是那么干燥但有效。:)

# c++ - 了解 C++ 中的多重继承

> ID：12411235
> 
> 赞同：2
> 
> 时间：2012-09-13T16:59:16.017
> 
> 标签：c++, multiple-inheritance, virtual-functions

我正在尝试使用多重继承来解决我正在开发的复杂层次结构。情况如下：

```
class A {
  virtual void foo();
}

class B {
  virtual void foo();
}

class C : public B {

}

class D : public A, public C {
  void foo() { ... }
}

class ClientClass {
  void method() {
    A *a = new D();
    a->foo();
  } 
```

我想知道的是：最终将`D`只有一个功能`foo()`吗？我正在考虑它，因为该方法在父母双方都是虚拟的，所以他们应该喜欢准直到同一个，但我只是因为我来自 Java 并且我觉得它在 C++ 中可能有所不同。我必须`foo()`两次声明虚函数，因为`ClientClass`不知道`B`或`C`只是`A`. 这是我想保留的要求。

编辑：即使两者都是纯虚拟的，同样的答案`foo()`是否适用`A`？`B`（例如`= 0`）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:00:45.943

D将有两个。它们可以在类中`A :: foo()`和`B :: foo()`类内访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:08:46.377

实际上， 的实现将同时`D::foo`覆盖两者。`A::foo``B::foo`

当然，这两个继承的函数仍然可用，可以用它们的全名来调用。但这与单继承情况没有什么不同。

关于`ClientClass`，你创建一个`D`对象，然后`foo`通过一个指针调用`A`. 因此`D::foo`将调用覆盖。

如果您想要不同版本的and`foo`覆盖（例如，因为它们不相关但碰巧以相同的方式调用），那么您将需要做一些工作：`A::foo``C::foo`

```
class A2 : public A
{
public:
    virtual void foo()
    {
        A_foo();
    }
    virtual void A_foo()
    {
        A::foo();
    }
};
class C2 : public C
{
public:
    virtual void foo()
    {
        C_foo();
    }
    virtual void C_foo()
    {
        C::foo();
    }
};
class  D: public A2, C2
{
public:
    virtual void A_foo()
    { /* ... */ }
    virtual void C_foo()
    { /* ... */ }
}; 
```

现在使用：

```
{
    A *a = new D;
    a->foo(); //will call A2::foo -> D::A_foo
    B *b = new D;
    b->foo(); //will call C2::foo -> D::C_foo
    D *d = new D;
    d->foo(); //error: ambiguous call!
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T17:33:25.063

该类`D`具有三个功能`foo`：`D::foo`和`B::foo`。`A::foo`

由于在和`foo`中都是虚函数，因此将不合格的函数调用动态分派给最派生的函数：`A``B`

```
void f(A & a) { a.foo(); }
void g(B & b) { b.foo(); }

int main()
{
    D d;
    f(d);       // calls d.D::foo();
    g(d);       // calls d.D::foo();

    d.foo();    // calls d.D::foo();
    d.B::foo(); // calls d.B::foo();
    d.A::foo(); // calls d.A::foo();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T17:02:00.937

您遇到了多重继承的经典问题，可能是最重要的一个建议非常有限地使用它（通过混合或接口/虚拟类的概念）。

请查看[SO](https://stackoverflow.com/questions/380529/multiple-inheritance?rq=1)的这篇文章，以获得更全面的解释和您拥有的各种替代方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T17:30:26.680

在这段代码中：

```
class ClientClass {
  void method() {
    A *a = new D();
    a->foo();
  } 
```

D 的 foo 将运行。你仍然可以使用 a->A::foo() 访问 A foo。请注意，您初始化“a”的方式无法到达 B foo()。但是每次你构建一个 D 实例时，它都会使用 D foo，因为这两个 foo 函数都被声明为虚拟的。

对于代码中的每个类，您都有一个函数表。每个对象的表由它的**类型**定义。这意味着`A * a = new D()`具有A表功能。如果一个函数前面有一个虚拟标志，这意味着如果一个派生类的实例被构建，它的表将包含一个指向派生类函数的指针。

这意味着在 ClinetClass 的代码中，“a”对象具有 A 函数表，其中 foo 函数包含指向 D foo 函数的指针。

只是要注意，如果 D 没有它自己的 foo 并且你会写

```
D * d =  new D();
d-> foo(); 
```

如果他不知道应该使用哪个 foo 函数，你会得到一个编译错误。

# c++ - 这是糟糕的 RAII 设计吗？

> ID：12411248
> 
> 赞同：4
> 
> 时间：2012-09-13T17:00:05.223
> 
> 标签：c++, constructor, raii

我来自 Java 背景，但之后我学习了 C++，并且已经使用它编程了几年（主要是调试和编写修复程序，而不是从头开始设计程序）。然而，我今天遇到了一个问题，坦率地说，我有点惊讶花了这么长时间才遇到它。

假设我有一个名为 Class1 的类，其头文件包含（以及其他代码）：

```
class Class1 {
    private:
        Class2 object;
} 
```

Class2 类没有指定默认构造函数。现在，在 Class1 构造函数中，我正在读取文件的二进制标头并使用从中解析的信息来初始化 Class2，如下面的伪代码所示：

```
Class1::Class1(std::string) {
    // Read some binary info from a file here

    // Parse that binary info

    object2 = Class2(info); 
```

在 Java 中，因为它没有使用 RAII 范式，所以这是完全合法的。但是，由于 C++ 使用 RAII，所以在我做的时候，对象 2 已经用它的默认构造函数初始化了`object2 = Class2(info);`。我不能只调用那个构造函数（在 Class1 头文件中），因为我还没有需要创建的信息`object`。但是，我不能只`object2`对构造函数进行本地化，因为我需要其他函数才能看到/使用它。

显然这行不通。这些东西的标准方法是什么？我实际上想过只是将 Class1 更改为具有 Class2 指针，如下所示：

```
class Class1 {
    private:
        Class2* objectPointer;
} 
```

然后调用`*objectPointer = Class2(info)`. 但是，在我的情况下，“Class2”是一个 ifstream，似乎该`operator=`函数已被删除并且不适用于任何一种方法。

所以......我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:06:33.150

因为你`object`不是`const`，这都是完全合法的。但是，如果要`objects`在初始化阶段进行初始化，则必须提供信息。你可以这样做

```
 Class1::Class1(std::string file_name) : object(InfoFromFile(file_name)) {} 
```

where`InfoFromFile()`可以是独立函数（在 .cc 文件中的匿名命名空间中声明），也可以是 .cc 的静态成员函数`Class1`。如果需要比 file_name 更多的信息来生成所需的信息`Class2`，您可以将其提供给该函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T17:05:56.507

如果“读取和解析”部分不需要构建对象，那么您可以将其移动到静态（或非成员）函数，并使用结果初始化成员：

```
Class1::Class1(std::string) :
    object2(read_class2_info(some_file))
{} 
```

如果由于某种原因您确实无法将文件读取与对象构造分开，并且`object2`以后无法重新分配，那么您将需要使用指针。要创建对象，您可以使用`new`：

```
objectPointer = new Class2(info); 
```

然而，为了避免自己搞乱[三法则](https://stackoverflow.com/questions/4172722)，你应该避免自己管理动态对象，而是使用智能指针：

```
std::unique_ptr<Class2> objectPointer;

objectPointer.reset(new Class2(info)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T17:05:37.100

我建议使用本地函数来执行读取二进制信息并直接在构造函数列表中初始化的位：

```
namespace {

InfoObject readInfo(std::string s)
{
// Read some binary info from a file here

// Parse that binary info
  return info;
}

}

Class1::Class1(std::string s)
: object(readInfo(s))
{
} 
```

当然，使用指针也是一种选择。这也是为什么这在 Java 中更自然地工作的原因（每个用户类型在内部都是一个指针）。不过，您可能想使用智能指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T17:06:44.287

我认为您必须`object`使用虚拟数据进行初始化，然后在解析后使用新数据对其进行更新。

像这样的东西：

```
Class1(std::string str)
 : object("some valid-but-meaningless data")
{
    // parse info
    object = Class2(info); 
```

如果这不好，您可能必须在静态因子方法中进行解析，然后将信息传递给构造函数（您很可能将其设为私有）。像这样的东西：

```
Class1(Info info)
 : object(info)
{
    // whatever else you want
}

static Class1 create(std::string)
{
    // parse info
    return Class1(info);
} 
```

编辑：我实际上更喜欢沃尔特的回答；在初始化中使用函数是个好主意。我只是把这个留在这里，你可以考虑一些替代的想法。

# asp.net-mvc - ASP.NET MVC 4 动作过滤器问题

> ID：12411249
> 
> 赞同：4
> 
> 时间：2012-09-13T17:00:07.443
> 
> 标签：asp.net-mvc

我想创建一个过滤器并将其放置在需要访问数据库的操作上。此过滤器将处理当前的工作单元，因此我不需要在一个操作中手动调用它一次或多次。我正在这样做：

```
 public class DisposeUnitOfWorkAttribute :FilterAttribute, IActionFilter
    {
        public Task<HttpResponseMessage> ExecuteActionFilterAsync(HttpActionContext actionContext, CancellationToken cancellationToken, Func<Task<HttpResponseMessage>> continuation)
        {
            IUnitOfWork currentUnitOfWork = UnitOfWork.Current;
            if (currentUnitOfWork != null)
            {
                currentUnitOfWork.Dispose();
            }
            return null;
        }

        public bool AllowMultiple
        {
            get { return false; }
        }
    }

    public class FilterConfig
    {
        public static void RegisterGlobalFilters(GlobalFilterCollection filters)
        {
            filters.Add(new DisposeUnitOfWorkAttribute());
            filters.Add(new HandleErrorAttribute());
        }
    }

        [DisposeUnitOfWork]
        public ViewResult Index()
        {            
            var user = _usersRepository.Get(x => x.Username == "jack").ToList();
            //UnitOfWork.Current.Dispose();
            return View();
        } 
```

我得到了例外：`The given filter instance must implement one or more of the following filter interfaces: IAuthorizationFilter, IActionFilter, IResultFilter, IExceptionFilter.`

我该如何纠正这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T15:28:17.620

从您的代码来看，您正在尝试将过滤器用作 Web API 过滤器，但将其添加到 FilterConfig.cs 中的错误过滤器集合（类似 MVC）

```
The given filter instance must implement one or more of the following filter interfaces: IAuthorizationFilter, IActionFilter, IResultFilter, IExceptionFilter. 
```

您应该将过滤器添加到 Web API 全局过滤器集合中，而不是在 WebApiConfig.cs 中：

```
 public static void Register(HttpConfiguration config)
    {
        // Add custom global filters

        // Handle validation errors
        config.Filters.Add(new DisposeUnitOfWorkAttribute()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T19:50:13.300

我猜你需要继承`ActionFilterAttribute`not FilterAttribute

```
public class DisposeUnitOfWorkAttribute : ActionFilterAttribute
{
   ...
} 
```

# mysql - MySQL - 一些 unicode 字符被破坏

> ID：12411252
> 
> 赞同：0
> 
> 时间：2012-09-13T17:00:15.210
> 
> 标签：mysql, post

我正在使用 POST 标头将数据发送到 Web 服务器。当数据包含非字母字符（例如，“Ą”）时，它会被破坏（数据包含 'Ä„' 而不是 'Ą'）。我在这张桌子上使用 utf8_unicode_ci 排序规则。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:02:13.907

检查您的网络服务器上的字符编码。

如果你包括它是什么类型的网络服务器，有人可以告诉你如何检查编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:03:53.193

您还需要在表中的特定字段上使用 unicode CHARSET（除了排序规则），如果该字段是在表字符集不是您要使用的 outf8 字符集时创建的。

因此，请检查字符集和排序规则的字段值。Charset 决定了实际的存储编码，而不是整理。排序规则与数据的排序方式有关。因此，如果没有正确存储，则问题出在字符集上，而不是排序规则上。

有关更多信息，请参阅此链接

[http://dev.mysql.com/doc/refman/5.0/en/charset-column.html](http://dev.mysql.com/doc/refman/5.0/en/charset-column.html)

`ALTER TABLE ... CONVERT TO CHARACTER SET`如果您需要更改字符集，请在此处了解语法规范。

[http://dev.mysql.com/doc/refman/5.0/en/alter-table.html](http://dev.mysql.com/doc/refman/5.0/en/alter-table.html)

# android - 通过 USB MIDI 将 8051 微控制器与安卓平板电脑连接

> ID：12411253
> 
> 赞同：0
> 
> 时间：2012-09-13T17:00:20.853
> 
> 标签：android, usb, 8051

我想通过 USB 将数字数据从我的 android 设备发送到 8051 微控制器（从平板电脑上的 otg 到 8051 板上的 USB MIDI），这会导致连接到 8051 的 LED 闪烁......但是当我尝试编写 USB 设备检测时代码它不起作用..我无法检测到 8051 MC。谁能告诉我我必须如何以及从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:17:57.660

没有更多细节很难确定。你有什么设备？它是某种形式的平板电脑，但您知道是否启用了主机模式吗？您对代码的了解程度如何？

如果您编写了一些代码来检测 USB 设备，那么我会使用 USB 鼠标之类的东西，看看会发生什么。运行`dmesg | grep usb`以查看插入各种设备时操作系统必须说什么。

如果代码报告了鼠标，则启用主机模式支持。如果没有，特别是如果操作系统仍然可以识别它并且您可以移动鼠标指针等，那么很有可能主机模式功能设置不正确。

如果是这种情况，那么请遵循[这个问题](https://stackoverflow.com/questions/11183792/android-usb-host-and-hidden-devices)

# android - 是否可以为设备上运行的 android/iOS 应用程序配置 adobe AIR？

> ID：12411262
> 
> 赞同：3
> 
> 时间：2012-09-13T17:01:07.387
> 
> 标签：android, actionscript-3, air, flash-builder

我在运行 Android ICS 4.0 的三星 Nexus S 手机上经历了几次间歇性系统崩溃，同时尝试在设备上测试/调试我的 AIR 应用程序（*我正在使用 AIR for Android 版本 3.3.0.365*）；Flash Builder 4.7 的移动应用程序的[标准调试测试](http://help.adobe.com/en_US/flashbuilder/using/WSe4e4b720da9dedb5-6caff02f136a645e895-7fff.html)没有显示任何错误，我的设备也没有`logcat`（除了将 Adob​​e AIR [我的应用程序运行] 确定为崩溃的原因）。

鉴于问题是间歇性的，并且似乎与任何特定的事件集不对应，我真的很想在应用程序在设备上运行时使用 Flash Builder 4.7 中的分析器，以便完整读取什么正在进行。

我已经在我的桌面上对应用程序进行了分析，并没有发现在 Android 上崩溃的明显潜在原因，所以现在我想知道以下问题：是否可以配置 Flash Builder 4.7 分析器来分析应用程序在运行时通过USB调试连接的移动设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T18:24:01.057

如果我没记错的话，您可以在其中一个配置文件中设置调试 IP。如果您填写您正在构建应用程序的机器的本地 IP，您将能够通过 wifi 网络使用分析器。我不确定它在 flash builder 中是否可以这样工作，但我使用了 flashdevelop。

# android - 在我的 Android 应用中拍照时，我从来没有得到 RESULT_OK，但照片就在那里

> ID：12411266
> 
> 赞同：1
> 
> 时间：2012-09-13T17:01:23.990
> 
> 标签：android

我有一个使用意图的 Android 应用程序。这是代码：

```
private static final int CAPTURE_IMAGE= 1;
[...]
Uri imageUri = helper.createImageDestinationUri(null, filename);
[...]
Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);
startActivityForResult(intent, CAPTURE_IMAGE); 
```

然后我在这里得到结果：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == CAPTURE_IMAGE) {
        if (requestCode == Activity.RESULT_OK) {

            Toast.makeText(this, "Image saved to:\n" +
                    data.getData(), Toast.LENGTH_LONG).show();
        }
        else {
            Toast.makeText(getApplicationContext(), "Error", Toast.LENGTH_SHORT).show();
        }
    }
} 
```

我拥有所有需要的权限。

**奇怪的是：** 最后图片总是在我的 SD 卡上，但我从来没有得到`RESULT_OK`结果。

那里有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:05:32.730

您正在检查 RESULT_OK 的 requestCode

```
if (requestCode == Activity.RESULT_OK) 
```

当你应该检查 resultCode

```
if (resultCode == Activity.RESULT_OK) 
```

# java - 如何使用 Java fx pdf 查看器？

> ID：12411270
> 
> 赞同：2
> 
> 时间：2012-09-13T17:01:46.387
> 
> 标签：java, javafx-2

有没有人推荐使用 javafx 查看 PDF 文件的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T21:54:58.783

试试[JPedalFX](http://www.idrsolutions.com/jpedalfx-viewer/)查看器，它提供了一个用于查看 PDF 文件的 JavaFX 组件。

或者

[在使用JPedal PDF to JavaFX 转换器](http://www.idrsolutions.com/convert-pdf-to-javafx/)查看之前，将 PDF 预转换为 JavaFX 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:28:02.957

两个独立的问题：PDF 和显示。

Java FX 是您的显示器。

如果您以 XML 开头并且喜欢编写样式表，则可以使用 XSL-FO 生成 PDF，或者如果您使用 iText 库，则可以使用 Java 代码来生成 PDF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T07:09:35.753

不知道这是否是您要查找的内容，此行仅在操作系统中打开 pdf 文件（因此未嵌入或其他任何内容，您需要安装一个可以处理 pdf 的程序，例如 Adob​​e Reader）：

```
Runtime.getRuntime().exec("rundll32 url.dll,FileProtocolHandler " + file.getAbsolutePath()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-25T06:44:18.063

stackoverflow.com 的以下线程讨论了为 javafx 应用程序开发 pdf 查看器的不同可能性。 [在 JavaFX 中显示 pdf](https://stackoverflow.com/questions/18207116/displaying-pdf-in-javafx)

可以为此实现尝试以下库：

```
OpenViewerFX – An Open Source JavaFX PDF Viewer: https://www.idrsolutions.com/openviewerfx/
PDF renderer with Java: https://java.net/projects/pdf-renderer
PDF.js
JPedalFX
SwingLabs 
```

# c# - SSO - 未找到 OpenID 端点

> ID：12411275
> 
> 赞同：4
> 
> 时间：2012-09-13T17:02:08.237
> 
> 标签：c#, asp.net-mvc, openid, single-sign-on, dotnetopenauth

我正在尝试让 SSO openid 与 dotnetopenauth 一起使用。

我有两个独立的项目，分别调试（都在本地主机上，但有两个不同的端口），一个作为提供者，一个作为依赖方。

依赖方正在运行`localhost:1903`。提供程序正在运行`localhost:3314`。

依赖方代码：

```
 public ActionResult Authenticate()
    {
        UriBuilder returnToBuilder = new UriBuilder(Request.Url);
        returnToBuilder.Path = "/OpenId/";
        returnToBuilder.Query = null;
        returnToBuilder.Fragment = null;

        Uri returnTo = returnToBuilder.Uri;
        returnToBuilder.Path = "/";
        Realm realm = returnToBuilder.Uri;
        realm = "http://localhost:3314/OpenId/";
        returnTo = new Uri("http://localhost:3314/OpenId/");
        var response = openid.GetResponse();

        if (response == null) {
            if (Request.QueryString["ReturnUrl"] != null && User.Identity.IsAuthenticated) {
            } else {
                string strIdentifier = "testidentifier";
                var request = openid.CreateRequest(
                    strIdentifier,
                    realm,
                    returnTo);

                var fetchRequest = new FetchRequest();
                request.AddExtension(fetchRequest);
                request.RedirectToProvider();
            }
        } else {
            switch (response.Status) {
                case AuthenticationStatus.Canceled:
                    //stuff got cancelled for some reason
                    break;
                case AuthenticationStatus.Failed:
                    //response.Exception.Message;
                    break;
                case AuthenticationStatus.Authenticated:
                    //a bunch of applying roles that i don't think we care about
                    break;
            }
        }

        return new EmptyResult();
    } 
```

提供者代码：

```
 public ActionResult Index()
    {
        IAuthenticationRequest iR = (IAuthenticationRequest)Request;

        if (iR.IsReturnUrlDiscoverable(ProviderEndpoint.Provider.Channel.WebRequestHandler) != RelyingPartyDiscoveryResult.Success) {
            iR.IsAuthenticated = false;
            return new EmptyResult();
        }

        if (iR.IsDirectedIdentity) {
            if (User.Identity.IsAuthenticated) {
                iR.LocalIdentifier = BuildIdentityUrl();
                iR.IsAuthenticated = true;
            } else {
                if (iR.Immediate || ImplicitAuth) {
                    iR.IsAuthenticated = false;
                } else {
                    if (!Request.Path.EndsWith("Login", StringComparison.OrdinalIgnoreCase)) {
                        return RedirectToAction("Login", "User");
                    }
                }
            }
        } else {
            string userOwningOpenIdUrl = ExtractUserName(iR.LocalIdentifier);

            iR.IsAuthenticated = userOwningOpenIdUrl == User.Identity.Name;

            if (!iR.IsAuthenticated.Value && !ImplicitAuth && !iR.Immediate) {
                if (!Request.Path.EndsWith("Login", StringComparison.OrdinalIgnoreCase)) {
                    return RedirectToAction("Login", "User");
                }
            }
        }

        if (iR.IsAuthenticated.Value) {
            var fetchRequest = iR.GetExtension<FetchRequest>();

            if (fetchRequest != null) {
                var fetchResponse = new FetchResponse();
                //roles and stuff

                iR.AddResponseExtension(fetchResponse);
            }
        }

        return new EmptyResult();
    } 
```

在方法上运行依赖方代码时出现错误`openid.CreateRequest`。我在我的提供程序代码上启用了调试，它永远不会受到影响。

研究错误，我发现了很多关于代理问题的建议，但这对我来说不应该是一个问题，因为我只去本地主机。

也许这是相当明显的事情，但我不知道我做错了什么。

在此先感谢您的帮助！

编辑：仅供参考，我从 DotNetOpenAuth 示例中获得了此代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T13:27:32.847

好吧，我最终手动浏览了源代码，并在某种程度上找出了问题所在。

事实证明，dumdum 有点正确——我的第一个问题是它确实需要一个 URI 作为标识符，所以一旦我将标识符更改为`http://localhost:3314/OpenId/`（即使这本身无效），我就克服了那个异常。

第二个问题是我忘记将信息添加到 web.config - 所以`localhost`没有被列入白名单并`CreateRequest`在那里失败。

在我解决了这两个问题之后，我的提供程序代码得到了很好的解决——我在那里遇到了其他错误，但这是我想象的一个单独的问题。

网络配置：

```
<configSections>
  <sectionGroup name="dotNetOpenAuth" type="DotNetOpenAuth.Configuration.DotNetOpenAuthSection, DotNetOpenAuth">
    <section name="openid" type="DotNetOpenAuth.Configuration.OpenIdElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
    <section name="oauth" type="DotNetOpenAuth.Configuration.OAuthElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
    <section name="messaging" type="DotNetOpenAuth.Configuration.MessagingElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
    <section name="reporting" type="DotNetOpenAuth.Configuration.ReportingElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
    </sectionGroup>
</configSections>

<dotNetOpenAuth>
<openid>
  <relyingParty>
    <security requireSsl="false">
      <!-- Uncomment the trustedProviders tag if your relying party should only accept positive assertions from a closed set of OpenID Providers. -->
      <!--<trustedProviders rejectAssertionsFromUntrustedProviders="true">
        <add endpoint="https://www.google.com/accounts/o8/ud" />
      </trustedProviders>-->
    </security>
    <behaviors>
      <!-- The following OPTIONAL behavior allows RPs to use SREG only, but be compatible
           with OPs that use Attribute Exchange (in various formats). -->
      <add type="DotNetOpenAuth.OpenId.RelyingParty.Behaviors.AXFetchAsSregTransform, DotNetOpenAuth"/>
      <!--<add type="DotNetOpenAuth.OpenId.RelyingParty.Behaviors.GsaIcamProfile, DotNetOpenAuth" />-->
    </behaviors>
    <!-- Uncomment the following to activate the sample custom store.  -->
    <!--<store type="OpenIdRelyingPartyWebForms.CustomStore, OpenIdRelyingPartyWebForms" />-->
  </relyingParty>
</openid>
<messaging>
  <untrustedWebRequest>
    <whitelistHosts>
      <!-- since this is a sample, and will often be used with localhost -->
      <add name="localhost"/>
    </whitelistHosts>
  </untrustedWebRequest>
</messaging>
<!-- Allow DotNetOpenAuth to publish usage statistics to library authors to improve the library. -->
<reporting enabled="true"/>
</dotNetOpenAuth> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:49:19.147

我不确定你是否和我有同样的问题，但是......对我来说，如果我输入类似“bob”的用户名，它会提示我输入 openid 后出现此错误。当我输入一个有效的开放 ID（例如 dumdum@yahoo.com）时，它就解决了这个问题。似乎需要对完全不可能的打开 id 的异常处理进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-15T05:42:41.747

我最近遇到了同样的问题，结果发现问题不在我的应用程序中，而是在 openID 服务器端。当调用 openID 服务器时，它返回 500 - 内部服务器错误并且我的应用程序抛出了协议异常 - 没有在线找到 OpenID 端点`openId.CreateRequest(Identifier.Parse(openIdServer))`。

我联系了 OpenID 服务器的管理员，他修复了内部服务器错误，一切正常（与错误一样）。

为什么 DotNetOpenAuth 会引发如此愚蠢的异常，这是一个问题......

# c# - 出现错误：Background.png 不是具有所需大小的有效 PNG 文件

> ID：12411285
> 
> 赞同：3
> 
> 时间：2012-09-13T17:02:21.187
> 
> 标签：c#, windows-phone-7, testing, marketplace

我正在使用测试套件测试 Windows Phone 7 应用程序，但收到与 background.png 尺寸相关的错误

运行测试套件时，它说：

```
Result            Test Name                          Test Description     
Failed       XAP Package Requirement        Validation of XAP file size and content files

                                Result Details
[ERROR] : Background.png is not a valid PNG file with the required size: 62 x 62 
```

但是，当我将尺寸更改为 62x62 时，它表示相同，但​​表示尺寸应为 173x173。因此，我想知道如何解决这个问题，因为我不记得更改任何与 background.png 文件相关的代码。

谢谢

@Gambit 感谢图标和背景设置为背景文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:28:44.970

在您的 WMAppManifest.xml 中，有一个名为`<IconPath>`. 这应该设置为 62 x 62（小图块）的 .png。

还有一个名为的条目`<PrimaryToken>`应该包含一个 . 这应该设置为 173 x 173（固定平铺）的 .png。

确保这两个 .png 都存在于您的项目中并且它们被正确引用。

# javascript - 在 Manifest V2 下的 Google Chrome 扩展程序中使用 YouTube 的 PlayerAPI - 有效，但会产生大量警告

> ID：12411290
> 
> 赞同：5
> 
> 时间：2012-09-13T17:02:33.247
> 
> 标签：javascript, iframe, google-chrome-extension, youtube-api, youtube-javascript-api

在 v2 下的 Google Chrome 扩展程序中使用 YouTube 的 Player API 时，我收到了一些非关键错误消息。

我的 content_security_policy 中有以下定义：

```
"content_security_policy": 
    "script-src 'self' https://www.youtube.com/player_api https://s.ytimg.com/yt/jsbin/www-widgetapi-vfl9Ni0ki.js; object-src 'self'" 
```

第一个引用 player_api 依赖于 widgetapi。如果您导航到 player_api url 并查看其内容，这一点就很清楚了：

```
if (!window['YT']) {var YT = {};}if (!YT.Player) {(function(){var s = 'https:' + '//s.ytimg.com/yt/jsbin/www-widgetapi-vflU5wlSl.js';var a = document.createElement('script');a.src = s;a.async = true;var b = document.getElementsByTagName('script')[0];b.parentNode.insertBefore(a, b);YT.embed_template = "\u003ciframe width=\"425\" height=\"344\" src=\"\" frameborder=\"0\" allowfullscreen\u003e\u003c\/iframe\u003e";})();} 
```

这一切都很好。我的内容安全策略有效，YouTube 视频加载成功。但是，在幕后，我看到了很多警告：

![在此处输入图像描述](../Images/670331c23b5c91e7dac18768d08b6ff3.png)

据我了解，无法删除或隐藏消息“不安全的 JavaScript 尝试使用 URL 访问框架...”。如果有人知道抑制此消息的方法，我将非常感兴趣！

不过，我对“无法将消息发布到...”错误一无所知。一个快速的谷歌出现了一些遇到类似问题的人，但我没有看到任何解决方案。小部件API 都被缩小了——很难看到实际发生了什么。

我应该收到这些错误吗？有没有办法减轻错误？甚至压制它们（因为它们似乎并没有真正破坏任何东西）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:46:00.300

无法将消息发布到[http://www.youtube.com](http://www.youtube.com)通过使用 $(window).load() 而不是 $(document).ready 包装 YTPlayer 实例化代码来解决。

未捕获的类型错误：无法调用 null 的方法“应用”通过提供 onReady、onStateChange 和 onError 的函数来解决。您不能为这些回调之一提供 null。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T12:48:51.827

我相信“不安全的 JavaScript 尝试...”消息是由于 Chrome/Chromium 中的这个错误：

[http://code.google.com/p/chromium/issues/detail?id=17325](http://code.google.com/p/chromium/issues/detail?id=17325)

..这可以防止在测试直接跨域通信时捕获此异常。

忽略该消息是安全的，但是（直到该错误得到修复）没有办法避免这些警告。

其他问题已经回答了。

# java - 不离开的 EJB 异常

> ID：12411293
> 
> 赞同：3
> 
> 时间：2012-09-13T17:02:40.173
> 
> 标签：java, jsf, ejb

我正在用 JSF、EJB 和 JPA 编写应用程序。

我的一个会话 bean 中有一个 authenticateUser 方法，它在登录成功时返回经过身份验证的用户对象。

问题是在多次运行我的应用程序后（没有次数规则），我遇到了一个 EJB 异常，上面写着“model.User 无法转换为 model.User”！为什么？这非常令人困惑。当这个 EJBException 发生时，我可以再次运行我的应用程序的唯一方法是重新启动我的 NetBeans。否则，无论我多么努力地尝试更改我的代码，它都不会工作，并且会显示相同的错误。

令我困惑的是，这种情况并非一直发生。我可以成功登录多次而不会遇到这种情况。但是当它来临时，它会徘徊并且不会离开，除非我重新启动。以前有没有人遇到过这个问题，如果有，我做错了什么吗？追踪起来有点困难，因为我的代码大部分时间都能正常工作，而且错误消息看起来有点愚蠢。

这是我的 authenticateUser 方法。如果您需要我的项目中的任何其他代码，请告诉我：

```
public boolean authenticateUser() {
        isUserAuthenticated = false;
        isAdmin = false;
        User foundUser = userEJB.authenticateUser(username, password);
        if (foundUser != null) {
            //User foundUser = (User) result.get(0);
            if (foundUser.getUsername().equalsIgnoreCase(username) && foundUser.getPassword().equals(password)) {
                if (foundUser.getBanned()) {
                    isBanned = true;
                    this.setLblUserAuthenticated("Unfortunately you are banned from entering the system.");

                } else {
                    isUserAuthenticated = true;
                    this.currentUser = foundUser;
                    this.currentUser.setFirstname(foundUser.getFirstname());
                    if (foundUser.getType().equals("admin")) {
                        isAdmin = true;
                    }
                    ExternalContext externalContext = FacesContext.getCurrentInstance().getExternalContext();
                    Map<String, Object> sessionMap = externalContext.getSessionMap();
                    sessionMap.put("user", currentUser);
                    return true;
                }

            } else if (foundUser.getUsername().equalsIgnoreCase(username) && !foundUser.getPassword().equals(password)) {
                this.setLblUserAuthenticated("Wrong password.");

                return false;
            }
        } else {
            this.setLblUserAuthenticated("No such user found");
            return false;
        }
        return false;
    } 
```

这是我得到的堆栈跟踪。

```
WARNING: EJB5184:A system exception occurred during an invocation on EJB UserEJB, method: public model.User bean.UserEJB.authenticateUser(java.lang.String,java.lang.String)
WARNING: javax.ejb.EJBException
    at com.sun.ejb.containers.BaseContainer.processSystemException(BaseContainer.java:5215)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5113)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4915)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy631.authenticateUser(Unknown Source)
    at bean.__EJB31_Generated__UserEJB__Intf____Bean__.authenticateUser(Unknown Source)
    at view.LoginManager.authenticateUser(LoginManager.java:37)
    at view.LoginManager$Proxy$_$$_WeldClientProxy.authenticateUser(LoginManager$Proxy$_$$_WeldClientProxy.java)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at org.jboss.weld.util.el.ForwardingMethodExpression.invoke(ForwardingMethodExpression.java:39)
    at org.jboss.weld.el.WeldMethodExpression.invoke(WeldMethodExpression.java:50)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIData.broadcast(UIData.java:1093)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.ClassCastException: model.User cannot be cast to model.User
    at bean.UserEJB.authenticateUser(UserEJB.java:83)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at org.jboss.weld.ejb.SessionBeanInterceptor.aroundInvoke(SessionBeanInterceptor.java:42)
    at sun.reflect.GeneratedMethodAccessor830.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.GeneratedMethodAccessor829.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:214)
    ... 48 more

WARNING: #{loginManager.authenticateUser}: javax.ejb.EJBException
javax.faces.FacesException: #{loginManager.authenticateUser}: javax.ejb.EJBException
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIData.broadcast(UIData.java:1093)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: javax.faces.el.EvaluationException: javax.ejb.EJBException
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    ... 32 more
Caused by: javax.ejb.EJBException
    at com.sun.ejb.containers.BaseContainer.processSystemException(BaseContainer.java:5215)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5113)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4915)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy631.authenticateUser(Unknown Source)
    at bean.__EJB31_Generated__UserEJB__Intf____Bean__.authenticateUser(Unknown Source)
    at view.LoginManager.authenticateUser(LoginManager.java:37)
    at view.LoginManager$Proxy$_$$_WeldClientProxy.authenticateUser(LoginManager$Proxy$_$$_WeldClientProxy.java)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at org.jboss.weld.util.el.ForwardingMethodExpression.invoke(ForwardingMethodExpression.java:39)
    at org.jboss.weld.el.WeldMethodExpression.invoke(WeldMethodExpression.java:50)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    ... 33 more
Caused by: java.lang.ClassCastException: model.User cannot be cast to model.User
    at bean.UserEJB.authenticateUser(UserEJB.java:83)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at org.jboss.weld.ejb.SessionBeanInterceptor.aroundInvoke(SessionBeanInterceptor.java:42)
    at sun.reflect.GeneratedMethodAccessor830.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.GeneratedMethodAccessor829.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:214)
    ... 48 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T05:35:36.343

它是您的应用程序服务器的类加载策略。您使用哪个应用程序服务器？参考应用服务器的类加载策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T13:07:44.110

我可能不确切知道这里发生了什么，但我通过这种方式解决了这个问题。发生 ClassCastException 是因为每次我登录时，由于未知原因，我的用户实体的两个实例被调用。所以我所做的就是在我的用户控制器类中合并所有处理用户的方法。我不知道为什么通过 authenticateUser 方法，要强制转换两个对象，但我想我们只需要使用一个控制器来为我们的应用程序调用实体。

# java - 将变量传递给 DocumentFilter

> ID：12411295
> 
> 赞同：2
> 
> 时间：2012-09-13T17:02:47.197
> 
> 标签：java, swing, jtextarea, documentfilter

我正在创建一个自定义`DocumentFilter`.

但是，我必须在几个不同的组件上使用它。它们之间的唯一区别是字符限制，可以通过更改单个变量来更改。

问题是，我如何将该变量传递给`DocumentFilter`?

这是我的自定义`DocumentFilter`类（大部分代码已删除）：

```
class DefaultDocFilter extends DocumentFilter
{   
    public void insertString(FilterBypass fb, int offs,
         String str, AttributeSet a) 
    {
        //do something with charLimit 
    }

    public void replace(FilterBypass fb, int offs, int length,
         String str, AttributeSet a)
    {
        //do something else with charLimit
    }
} 
```

主要代码中的实现：

```
int charLimit = 40;
doc = (AbstractDocument) JTextArea.getDocument();
doc.setDocumentFilter(new DefaultDocFilter()); 
```

我如何传递`charLimit`给`DefaultDocFilter?`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:05:40.577

将变量添加到您的子类。

```
class DefaultDocFilter extends DocumentFilter
{
    private final int charLimit;

    public DefaultDocFilter(int charLimit) {
        this.charLimit = charLimit;
    }

    public void insertString(FilterBypass fb, int offs,
         String str, AttributeSet a) 
    {
        //do something with charLimit 
    }

    public void replace(FilterBypass fb, int offs, int length,
         String str, AttributeSet a)
    {
        //do something else with charLimit
    }
} 
```

然后，当您添加文档过滤器时，只需使用您的限制构造一个新过滤器：

```
textField.getDocument().setDocumentFilter(new DefaultDocFilter(20)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T17:05:42.623

您可以简单地添加为成员变量：

```
class DefaultDocFilter extends DocumentFilter
{   
    private int charLimit = 40;

    public void insertString(FilterBypass fb, int offs,
         String str, AttributeSet a) 
    {
        //do something with charLimit 
    }

    public void replace(FilterBypass fb, int offs, int length,
         String str, AttributeSet a)
    {
        //do something else with charLimit
    }

    public int getCharLimit() {
        return charLimit;
    }

    public void setCharLimit(int charLimit) {
        this.charLimit = charLimit;
    }
} 
```

然后：

```
doc.setCharLimit(charLimit); 
```

# objective-c - 如何获得一个没有最后一个元素的旧 NSArray？

> ID：12411302
> 
> 赞同：0
> 
> 时间：2012-09-13T17:03:03.530
> 
> 标签：objective-c, arrays, nsarray

我的意思是简单地获取新数组，例如在 python 中：

```
lst[:-1] 
```

有没有办法在objc中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:05:59.813

您可以使用[-subArrayWithRange:](http://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/Classes/NSArray_Class/NSArray.html)。

```
[theOriginalArray subarrayWithRange:NSMakeRange(0, [theOriginalArray count]-1)] 
```

这相当于 Python 表达式`lst[0:lst-1]`，它是您的`lst[:-1]`.

# f# - 是否有必要“缓存”柯里化函数的部分函数？

> ID：12411307
> 
> 赞同：1
> 
> 时间：2012-09-13T17:03:35.600
> 
> 标签：f#, closures

例如，如果我定义`F x y`为柯里化函数并且在环境`(F x)`中使用了很多部分函数，`let binding`​​那么就性能而言，我是否应该始终将其用于命名函数？（例如，与缓存的 a 相比，`property`通常`object`不需要缓存 like ）`property``Array.Length`

```
 let Gofrom (board: int[][]) (color: int) (reelID, reelPosition) (direction: Direction) =
    let rec walkfrom x =
        match direction.Target x with
        | (a, _ | _, a) when a = -1 || a = board.Length -> x
        | a, b when board.[a].[b]= color -> walkfrom (a, b)
        | _ -> x
    walkfrom (reelID, reelPosition) 
```

对比

```
 let rec Gofrom (board: int[][]) (color: int) (reelID, reelPosition) (direction: Direction) =
        match direction.Target (reelID, reelPosition) with
        | (a, _ | _, a) when a = -1 || a = board.Length -> (reelID, reelPosition)
        | a, b when board.[a].[b]= color -> Gofrom board color (a, b) direction
        | _ -> (reelID, reelPosition) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:10:35.440

性能上应该没有区别，但我肯定会使用第一种形式，因为它明确了哪些参数在调用之间不会改变。

顺便说一句，这并不是真正的柯里化，因为您将代码重构为一个单独的函数（闭包）以避免传递 args。

# java - myString.split("\\s+") 的第一个数组位置的空格

> ID：12411312
> 
> 赞同：0
> 
> 时间：2012-09-13T17:03:50.250
> 
> 标签：java

所以我有一个字符串：

```
String myString = "[tab][space]this[space][tab]is[space]a[space][tab]string";
String[] mySplit = myString.split("\\s+");

System.out.println(mySplit.length);
for (String s : mySplit) 
    System.out.println(s); 
```

给我：

```
5
[whitespace] 
this
is
a
string 
```

为什么会这样以及如何阻止第一个位置被空白填充？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:05:45.550

你可以使用：

```
myString.trim().split("\\s+"); 
```

这应该在将字符串拆分为空格之前修剪掉任何前导或尾随空格。有关更多详细信息，请参阅[文档`trim`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#trim%28%29)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:14:01.363

方式`split()`已定义，如果输入字符串以分隔符开头，则返回的第一个段将为空。这可能有点违反直觉，但请考虑

```
String value = ",a,b,c";
String[] fields = value.split(","); 
```

你会想要取回四个元素。

如果您需要删除前导空格，请先使用`trim()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:16:54.517

发生的事情是 split 找到所有由您的正则表达式终止的子字符串，包括空字符串。它在字符串的开头找到“\t”，并将其解释为终止一个空字符串。因此，您的数组包含一个空字符串作为第一个元素。保罗的建议解决了这个问题。

有趣的是，如果您的字符串以空格结尾，split 将不会在您的数组中包含空字符串。

有关拆分，请参见[javadoc。](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T17:17:00.633

我认为您要执行此操作的功能是`trim()`.

**首先修剪字符串...**

```
String myString = "[tab][space]this[space][tab]is[space]a[space][tab]string";
String tempStr = myString.trim(); 
```

**现在使用 split()**

`tempStr.split("\\s+");`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T17:35:13.723

是的，您可以使用 trim() 方法，该方法用于删除前导和尾随空格。

# vb.net - WCF 中带有 List(Of Object) 的对象。添加到 Object 时，得到 NullReferenceException

> ID：12411313
> 
> 赞同：1
> 
> 时间：2012-09-13T17:03:50.393
> 
> 标签：vb.net, wcf, datacontract

我有一个 DataContract 如下：

```
<DataContract()> _
Public Class PrivateProfile
 ' This member is serialized.
<DataMember()> _
Public UserAccount As UserAccount
<DataMember()> _
Public ProfileName As String = ""
<DataMember()> _
Public Birthday As Date?
<DataMember()> _
Public Gender As Int16 = 0
<DataMember()> _
Public AboutMe As String = ""
<DataMember()> _
Public Locations As New List(Of Location)
<DataMember()> _
Public Contacts As New List(Of Contact)
End Class 
```

联系方式是：

```
<DataContract()> _
Public Class Contact

' This member is serialized.
<DataMember()> _
Public Value As String
<DataMember()> _
Public ContactTypes_ContactTypeId As Int16
<DataMember()> _
Public PrivatePs As New List(Of PrivateProfile)

End Class 
```

在客户端，我使用以下代码：

```
Dim svcProfile As New svcProfiles.ProfilesClient
.....

Dim pprofile As New svcProfiles.PrivateProfile
.....

Dim co As New svcProfiles.Contact

        co.Value = "34234234234"
        co.ContactTypes_ContactTypeId = 1

        pprofile.Contacts.Add(co) 
```

一旦我将联系人添加到个人资料（最后一行），我就会收到 NullReferenceException。联系人总是没什么，但我不知道为什么。

任何想法......谷歌搜索了很多......

**编辑：** 当我在 wcf 实现（服务器）端以相同的情况运行时，我遇到了同样的问题：

```
If pprofile.Contacts.Count > 0 Then 

    Dim co As New contracts.Contact 

    For Each co In pprofile.Contacts 

        Dim con As New ef.Contact()

        con.ContactTypes_ContactTypeId = co.ContactTypes_ContactTypeId 
        con.Value = co.Value 
        con.PrivatePs.Add(pp) 
        context.Add(con) 

    Next 

    context.SaveChanges() 

End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:27:17.880

我怀疑从您的服务生成的代理类不包括 New 关键字，只是设置了属性类型。您应该能够通过显式实例化调用代码来解决此问题：

```
Dim con As New ef.Contact()

con.ContactTypes_ContactTypeId = co.ContactTypes_ContactTypeId 
con.Value = co.Value 
con.PrivatePs = New PrivatePs()
con.PrivatePs.Add(pp) 
context.Add(con) 
```

如果您使用的是实体框架，您可能需要检查它们为导航属性生成的修复代码，以确保它们可以正确同步。

# wordpress - 使用 iPodTouch 通过 LAN 连接到 XAMPP webapp

> ID：12411314
> 
> 赞同：0
> 
> 时间：2012-09-13T17:03:51.627
> 
> 标签：wordpress, xampp, ipod-touch, lan, resolve

XAMPP 1.7.4 托管在 Win7 Pro 系统上

位于的 webapp`C:\xampp\htdocs\webapp\`是一个 index.html 文件。

我可以像这样在本地连接到站点`http://localhost/webapp/`

iPodTouch 能够通过 LAN 连接到主机，在 safari 浏览器中输入以下内容：

`http://192.168.0.11/`

解决为

`http://192.168.0.11/xampp/`

并加载 xampp 登录页面。

但是，如果我尝试像这样联系 webapp：

`http://192.168.0.11/webapp/`

地址解析为`http://localhost/webapp/`，浏览器无法打开页面，因为它无法连接到服务器。

`http://192.168.0.11:80/webapp/`也产生上述结果。我认为无论如何都不需要输入端口，因为我可以在第一个示例中访问 xampp 登录页面。

以上所有操作都是在以下情况下执行的：

httpd.conf 包括：

```
AllowOverride All
Order allow,deny
Allow from all 
```

httpd-xampp.conf 包括：

```
# New XAMPP security concept
#
<LocationMatch "^/(?i:(?:xampp|security|licenses|phpmyadmin|webalizer|server-status|server-info))">
Order deny,allow
#Deny from all
#Allow from 127.0.0.0/8
Allow from all
ErrorDocument 403 /error/HTTP_XAMPP_FORBIDDEN.html.var
</LocationMatch> 
```

webapp 的 .htaccess 包括：

```
Order deny,allow
Allow from all 
```

据推测，由于 localhost 的原因，webapp 地址的解析存在问题。

如何强制`http://192.168.0.11/webapp/`跨局域网加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T02:35:34.763

所以简单来说就是我这里只需要修改xampp的默认安装：

httpd-xampp.conf

```
# New XAMPP security concept
#
<LocationMatch "^/(?i:(?:xampp|security|licenses|phpmyadmin|webalizer|server-status|server-info))">
Order deny,allow
#Deny from all
#Allow from 127.0.0.0/8
Allow from all
ErrorDocument 403 /error/HTTP_XAMPP_FORBIDDEN.html.var
</LocationMatch> 
```

允许从任何 IP 访问

并修改 wp-admin > 设置 > 常规

WordPress 地址 (URL) 192.168.01.11/webapp/ 站点地址 (URL) 192.168.01.11/webapp/

最后

**清除浏览器缓存！**

由于浏览器的缓存，我花了几个小时进行修改而无法看到更改。

无需修改 httpd.conf、httpd-vhosts.conf、.htaccess 或任何主机文件

# jsf-2 - 如何动态禁用bean验证？

> ID：12411317
> 
> 赞同：0
> 
> 时间：2012-09-13T17:03:58.000
> 
> 标签：jsf-2, bean-validation

编辑用户数据时，我希望仅当密码不为空时才动态启用密码验证。我尝试过使用呈现密码组件的 ajax 请求，以使 validateBean 标记中的禁用属性变为动态。

我的 bean 有一个布尔属性 disabledValidation，它在执行与 ajax 请求关联的侦听器时更新。

我发现的第一个问题是，当用户编写其密码组件时，输入隐藏的密码被重新呈现（由于 ajax 标签）并且他写的内容丢失了。

除了与 ajax 标记关联的侦听器永远不会执行。

```
<h:inputSecret id="password" binding="#{password}" value="#{userBean.user.password}">
  <f:validateBean disabled="#{userBean.disabledValidation}">
    <f:ajax event="blur" render="@this" listener="#{userBean.enableValidationIfPasswordIsFilled}"/>
  </f:validateBean>
</h:inputSecret>
<h:message for="password" /> 
```

# vb.net - Linq 查询语法

> ID：12411319
> 
> 赞同：0
> 
> 时间：2012-09-13T17:04:02.400
> 
> 标签：vb.net, linq, entity-framework, inner-join

我有这个看起来不错的 linq 查询，尚未测试。但我想知道为什么我不能将 And 语句放在单独的行上。如果我尝试我得到和意外的令牌错误，并且由于保护级别工作查询而 c 和 b 变得无法访问

```
Dim result =
                From b In context.H_Beneficiary
                         Join e In context.Employees
                         On b.EmployeeId Equals (e.EmployeeId)
                         Join c In context.Companies
                         On e.AncillaryId Equals (c.CompanyId)
                         Where e.AncillaryId.Equals(iPerId) And c.AncillaryId.Equals(iCompanyId) And ((b.EndDate Is Nothing) Or (b.EndDate.Equals(DateTime.Today)))
                         Select b.EnterTime

            Return CDate(result)

        Return CDate(result) 
```

所需查询

```
 Dim result =
                From b In context.H_Beneficiary
                         Join e In context.Employees
                         On b.EmployeeId Equals (e.EmployeeId)
                         Join c In context.Companies
                         On e.AncillaryId Equals (c.CompanyId)
                         Where e.AncillaryId.Equals(iPerId)
                         And c.AncillaryId.Equals(iCompanyId)
                         And ((b.EndDate Is Nothing) Or (b.EndDate.Equals(DateTime.Today)))
                         Select b.EnterTime 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:06:59.440

似乎隐式续行不考虑“和”。只需在上一行上使用显式续行：

```
 From b In context.H_Beneficiary 
                 Join e In context.Employees 
                 On b.EmployeeId Equals (e.EmployeeId) 
                 Join c In context.Companies 
                 On e.AncillaryId Equals (c.CompanyId) 
                 Where e.AncillaryId.Equals(iPerId) _
                 And c.AncillaryId.Equals(iCompanyId) _
                 And ((b.EndDate Is Nothing) Or (b.EndDate.Equals(DateTime.Today))) 
                 Select b.EnterTime 
```

# java - java.util.Map 的 Java DataFlavor

> ID：12411324
> 
> 赞同：1
> 
> 时间：2012-09-13T17:04:37.430
> 
> 标签：java, drag-and-drop, awt

为 java.util.Map 构造 DataFlavor 的正确方法是什么

对于一个数组，我这样做：

```
DataFlavor[]{new DataFlavor(
                     DataFlavor.javaJVMLocalObjectMimeType + 
                     ";class=\"" + Foo[].class.getName() + "\"")} 
```

但不确定地图的等价物是什么。

澄清：

我想转让一个`Map<Foo, Bar>`，但我做不到`Map<Foo, Bar>.class`。

# android - 我无法在可扩展列表中选择子项

> ID：12411325
> 
> 赞同：1
> 
> 时间：2012-09-13T17:04:37.540
> 
> 标签：android, list, expandable

我让他们选择可扩展的孩子列表并获取信息。我还想为每个孩子实现一个数字选择器。但问题是孩子们不会选择，我也无法访问数字选择器按钮。我不使用任何侦听器，也不使用充气机访问 xml。不知道还能做什么。感谢所有的帮助。

代码主类

```
final ControlClientMenu adapt = new ControlClientMenu(ClientMenu.this, detalls);
        lstComandes = (ExpandableListView) findViewById(R.id.lstComandes); //Creo la lista
        lstComandes.setLongClickable(true);

        lstComandes.setOnGroupClickListener(new OnGroupClickListener() {
            @Override
            public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id) {
                parent.expandGroup(groupPosition);
                parent.collapseGroup(groupPosition);
                return false;
            }
        });
        lstComandes.setOnItemLongClickListener(new OnItemLongClickListener() {

            @Override
            public boolean onItemLongClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) 
            {
                id_comanda = id.get(arg2);
                return false;
            }

        });

        lstComandes.setAdapter(adapt); //Le asigano el XML
        registerForContextMenu(lstComandes); 
```

代码扩展适配器

```
public class ControlClientMenu extends BaseExpandableListAdapter
{
Context context;
DetallsComandes[] detalls;
private ArrayList<String> grupos = new ArrayList<String>();
private ArrayList<ArrayList<ArrayList<String>>> hijos = new ArrayList<ArrayList<ArrayList<String>>>();
private ArrayList<ArrayList<ArrayList<String>>> hijosU = new ArrayList<ArrayList<ArrayList<String>>>();

public ControlClientMenu(Context context, DetallsComandes[] detalls)
{
    this.context = context;
    this.detalls = detalls;
    cargarDatos();
}

public void cargarDatos() //Funcion para separar los grupos de los hijos
{
    for(int i = 0; i<detalls.length;i++)
    {
        Log.d("De", detalls[i].getComanda());
        grupos.add(detalls[i].getComanda());
        hijos.add(new ArrayList<ArrayList<String>>());
        hijosU.add(new ArrayList<ArrayList<String>>());
        Vector aux = detalls[i].getVecProducte();
        Vector aux2 = detalls[i].getVecPreu();
        Vector aux3 = detalls[i].getVecUnitats();
        for(int j = 0; j<aux.size(); j++)
        {
            Log.d("CONT", aux.get(j).toString()+"   "+aux2.get(j).toString());
            hijos.get(i).add(new ArrayList<String>());
            hijosU.get(i).add(new ArrayList<String>());
            hijos.get(i).get(j).add(aux.get(j).toString()+"   "+aux2.get(j).toString());
            hijosU.get(i).get(j).add(aux3.get(j).toString());
        }
    }
}

public ArrayList<String> getChild(int groupPosition, int childPosition)
{
    return hijos.get(groupPosition).get(childPosition);
}

public ArrayList<String> getChild1(int groupPosition, int childPosition,  ArrayList<ArrayList<ArrayList<String>>> hijosU)
{
    return hijosU.get(groupPosition).get(childPosition);
}

public long getChildId(int groupPosition, int childPosition)
{
    return childPosition;
}

public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) 
{
    String hijo = (String) ((ArrayList<String>)getChild(groupPosition, childPosition)).get(0);
    String hijo2 = (String) ((ArrayList<String>)getChild1(groupPosition, childPosition, hijosU)).get(0);
    if (convertView == null) 
    {
        LayoutInflater infalInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = infalInflater.inflate(R.layout.tabla_comanda_product_item, null);
    }
    TextView hijotxt = (TextView) convertView.findViewById(R.id.item_prod);
    TextView hijoU = (TextView) convertView.findViewById(R.id.txtUnitats);
    hijotxt.setText(hijo);
    hijoU.setText(hijo2);
    return convertView;
}

public int getChildrenCount(int groupPosition) 
{
    return hijos.get(groupPosition).size();
}

public String getGroup(int groupPosition)
{
    return grupos.get(groupPosition);
}

public int getGroupCount()
{
    return grupos.size();
}

public long getGroupId(int groupPosition)
{
    return groupPosition;
}

public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) 
{
    String group = (String)getGroup(groupPosition);

    if (convertView == null) {
        LayoutInflater infalInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = infalInflater.inflate(R.layout.tabla_comanda, null);
    }

    TextView grouptxt = (TextView) convertView.findViewById(R.id.lblComanda);
    grouptxt.setText(group);
    return convertView;
}

public boolean hasStableIds()
{
    return true;
}

public boolean isChildSelectable(int groupPosition, int childPosition) 
{
    return true;
}
} 
```

主要 XML

```
<TabHost
android:id="@android:id/tabhost"
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_weight="1" >
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <TabWidget
        android:id="@android:id/tabs"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </TabWidget>
    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >
            <LinearLayout
                android:id="@+id/tab1"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >
                <ExpandableListView android:id="@+id/lstComandes"
                                    android:layout_width="fill_parent"
                                    android:layout_height="wrap_content"
                                    android:layout_marginTop="10px"
                                    android:paddingTop="5px">
                </ExpandableListView>
            </LinearLayout>
     </FrameLayout>
 </LinearLayout>
</TabHost> 
```

可扩展组 XML

```
<?xml version="1.0" encoding="utf-8"?>
<!--VISTA DE LA EXPANDIBLELIST-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >
<LinearLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal">
    <!--CODIGO Y NOMBRE DEL CLIENTE-->
    <TextView android:id="@+id/lblComanda"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="italic"
        android:textSize="11dp"
        android:layout_marginLeft="53px"
        android:gravity="center_vertical"
        android:paddingTop="15px"
        android:paddingBottom="15px"/>
</LinearLayout>
<!--     <ListView android:id="@+id/lstProd" -->
<!--            android:layout_width="fill_parent" -->
<!--            android:layout_height="wrap_content" /> -->
<!--     <TextView android:id="@+id/lblTabla2" -->
<!--         android:layout_width="wrap_content" -->
<!--         android:layout_height="wrap_content"/> -->
</LinearLayout> 
```

可扩展子 XML

```
<?xml version="1.0" encoding="utf-8"?>
<!-- VISTA DE LOS SUBLISTA DE LA EXPANDIBLE LIST -->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal"
android:paddingTop="13px"
android:paddingBottom="15px"
android:paddingLeft="20px">
<!--PRODUCTO PRECIO SUBTOTAL-->
<TextView android:id="@+id/item_prod"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="left"/>
<!-- NUMBERPICKER -->
<LinearLayout android:gravity="right"
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="match_parent">
    <Button android:id="@+id/btnDown"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:text="@string/down"/>
    <TextView android:id="@+id/txtUnitats"
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content">
    </TextView>
    <Button android:id="@+id/btnUp"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:text="@string/up"/>
</LinearLayout>
</LinearLayout> 
```

对不起我的西班牙代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T12:54:52.517

在需要访问孩子的每种方法中，您都应该**切换**不同的组（假设您知道组的数量及其目的）。**示例**：

```
@Override
    public Object getChild(int groupPosition, int childPosition) {

        switch (groupPosition) {
            case GROUP_TYPE:
                return _list1.get(childPosition);
            case GROUP_TARIF:
                return _list2.get(childPosition);
            case GROUP_PROMO:
                return _list3.get(childPosition);
        }
        return null;
    } 
```

在 getChildView 中，您应该使用视图持有者，因为它确实更易于使用并附加到单元格。**示例**：

```
public class CellHolder {
    public CheckBox cellCheck;
    public TextView cellText;
} 
```

并将其用作单元格的标签：

@Override public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) {

```
 CellHolder cellHolder = null;
    if (convertView == null) {
        convertView = _inflater.inflate(R.layout.cell_layout, null);
        //
        cellHolder = new CellHolder();
        cellHolder.cellText = (TextView) convertView.findViewById(R.id.text_item);
        cellHolder.cellCheck = (CheckBox) convertView.findViewById(R.id.checkBox_item);
        cellHolder.cellCheck.setEnabled(false);
        convertView.setTag(filtreCellHolder);
    }
    else {
        cellHolder = (CellHolder) convertView.getTag();
    }
    switch (groupPosition) {
        case GROUP_TYPE:
            cellHolder.cellCheck.setChecked(_list1.get(childPosition).isInFiltre());
            cellHolder.cellText.setText(_list1.get(childPosition).getLibelle());
            break;
        case GROUP_TARIF:
            cellHolder.cellCheck.setChecked(_list2.get(childPosition).isInFiltre());
            cellHolder.cellText.setText(_list2.get(childPosition).text());
            break;
        case GROUP_PROMO:
            cellHolder.cellCheck.setChecked(_list3.get(childPosition).isInFiltre());
            cellHolder.cellText.setText(_list3.get(childPosition).getLibelle());
            break;
    }
    return convertView;
} 
```

你看到这个想法了吗。这样，您可以为每个组附加不同的细胞类型（如果需要）并有效地检索它。

现在要管理 OnClick，您可以使用方法**onChildClick**：

```
@Override
public boolean onChildClick(ExpandableListView parent, View v,
        int groupPosition, int childPosition, long id) {

    return super.onChildClick(parent, v, groupPosition, childPosition, id);
} 
```

希望它能以某种方式帮助你

# html - 文本区域上的 Internet Explorer 分页符

> ID：12411329
> 
> 赞同：1
> 
> 时间：2012-09-13T17:04:54.630
> 
> 标签：html, css, internet-explorer, print-preview

在我们的应用程序中，我们有一个表格控制表单字段的对齐方式（不好，我知道，但我无法更改）。客户报告说，他们不喜欢 Internet Explorer 在打印预览中插入分页符的方式，即字段标签（第一个`<td>`）与字段值（第二个）位于不同的页面上`<td`。

例如，对以下内容进行打印预览并放大（例如 200%）。

```
<html>
    <head>
        <title>Testing</title>
        <style>
            td {
                border: 1px solid black;
            }
        </style>       
    </head>
    <body>
        <table>
            <tr>
                <td>
                    First cell.
                </td>
                <td>
                    <textarea rows="30" cols="50">Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. Second cell. </textarea>
                </td>
            </tr>
        </table>
    </body>
</html> 
```

“第一个单元格”。display 出现在第 1 页，textarea 出现在第 2 页。请参阅[快照](http://imgur.com/a/hwiiD)。

有没有办法强制这两个`<td>`元素总是出现在同一页面上？

# json - 数据核 JSON

> ID：12411333
> 
> 赞同：2
> 
> 时间：2012-09-13T17:05:15.647
> 
> 标签：json, datanucleus

查看`Datanuclues JSON`代码清单，它似乎支持`Amazon S3`and `Google Storage`，但是我相信它不仅限于这两个“JSON”存储，所以我的问题是什么有资格成为`Datanuclues JSON`库的 JSON 存储？

我的意思是，是否有任何自定义“JSON 存储”的规范可以遵循？

此外，从文档中，还需要设置以下字段：

```
datanucleus.ConnectionURL=json:http://www.mydomain.com/somepath/
datanucleus.ConnectionUserName=
datanucleus.ConnectionPassword= 
```

为了自定义 JSON 存储的优势，

*   Datanucleus 如何将 and 传递`ConnectionUserName`到 `ConnectionPassword`store？
*   Http 响应 200、201、202、204、404 是唯一接受的响应吗？
*   `/{primary key}`允许在其中放入任何类型的 JSON 记录吗？或者什么样的实体可用于持久化？
*   对于存储在相对路径中的每个 JSON 文档，这里的“主键”是否唯一，例如`/Person/{primary key}`，主键是唯一的？

另外，我不太清楚 JDO 配置：

*   是`key="url"`吗`/{primary key(url?)}`？或其他类似的东西：`http://myapp.com/someurl/Person/{primary key}`？

# twitter-bootstrap - Twitter-bootstrap表如何仅获取外边界线而不是行间

> ID：12411334
> 
> 赞同：11
> 
> 时间：2012-09-13T17:05:15.027
> 
> 标签：twitter-bootstrap, css

我有

```
<table class="table table-condensed"> 
```

我曾经`table-bordered`在那里，但它给了我行之间的线条。我只想要整个表格外部的顶部、底部、左侧和右侧线，并且行之间没有线。

另外，我尝试先做一些小步骤，因此尝试按照此处的建议删除行之间的行 [Remove row lines in twitter bootstrap](https://stackoverflow.com/questions/8875367/remove-row-lines-bootstrap) and the solution given

```
table td {
    border-top: none;
} 
```

对我不起作用

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T23:23:14.950

我相信您的 CSS 没有被采纳，因为它不够具体。在 twitter 引导代码中定义边框的 css 是：

```
.table th, .table td { /*css*/ } 
```

但你的代码是

```
table td { /* css */} 
```

第一个被认为更具体，因为它使用类“.table”而不是 table 元素作为选择器，因此具有更高的优先级。

做了一个小 jsfiddle 来做你想做的事[http://jsfiddle.net/hajpoj/EfUAa/11/](http://jsfiddle.net/hajpoj/EfUAa/11/)

```
.table td, .table th {
    border: none;
}

table.table.table-condensed {
    border: 1px solid black;
} 
```

这是关于 css 特异性的一个很好的资源：

[http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

还要确保在引导文件之后加载您的 css 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-26T19:16:14.083

您可以将以下内容添加到您的 CSS 样式中：

```
<style>
.table{
outline-style: solid;
outline-width: 2px;
</style> 
```

希望能帮助到你。有关“大纲样式”的更多信息：[https](https://www.w3schools.com/cssref/pr_outline-style.asp) ://www.w3schools.com/cssref/pr_outline-style.asp 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-18T15:42:00.893

将 Bootstrap 类“border”添加到 table 标签并将类“border-0”添加到 th,td 标签

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-22T10:09:45.770

对于最近看到这个的其他人，您可以简单地将`border`类添加到您的表中，这应该给它外**边框**。

## 带外边框的表格

```
<table class="table">
    <thead class="table border">
        <tr>
            <th>Firstname</th>
            <th>Lastname</th>
            <th>Email</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>John</td>
            <td>Doe</td>
            <td>john@example.com</td>
        </tr>
        <tr>
            <td>Mary</td>
            <td>Moe</td>
            <td>mary@example.com</td>
        </tr>
    <tbody>
</table> 
```

* * *

## 没有边框的表格

`table-borderless`将产生一个**没有任何边界的表格，外部或内部**

```
<table class="table">
    <thead class="table table-borderless">
        <tr>
            <th>Firstname</th>
            <th>Lastname</th>
            <th>Email</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>John</td>
            <td>Doe</td>
            <td>john@example.com</td>
        </tr>
        <tr>
            <td>Mary</td>
            <td>Moe</td>
            <td>mary@example.com</td>
        </tr>
    <tbody>
</table> 
```

* * *

## 表有外边框，没有内边框

要生成仅具有外边框而没有内边框的表格，只需将`table-borderless`和`border`类添加到表格中，如下所示：

```
<table class="table">
    <thead class="table border table-borderless">
        <tr>
            <th>Firstname</th>
            <th>Lastname</th>
            <th>Email</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>John</td>
            <td>Doe</td>
            <td>john@example.com</td>
        </tr>
        <tr>
            <td>Mary</td>
            <td>Moe</td>
            <td>mary@example.com</td>
        </tr>
    <tbody>
</table> 
```

* * *

希望这可以帮助任何人，而不必使用 CSS 等。

# android - 制作 HTC 弹出窗口

> ID：12411335
> 
> 赞同：0
> 
> 时间：2012-09-13T17:05:19.423
> 
> 标签：android, android-layout, android-intent, android-emulator, android-widget

我有一部HTC手机。我看到这个弹出。这很酷，尤其是它的动画。有没有男孩告诉我它叫什么（我称之为 HTC 弹出窗口）以及如何做到这一点。我们有一个框架来做到这一点吗？

在此先感谢，（每个答案 1 个代表：D） ![在此处输入图像描述](../Images/251e82811cd63e013fb5d1011dfa2777.png)

如果图像未显示，请单击[此处。](https://lh6.googleusercontent.com/-tNS3yMfwDBY/UFITF_qU1bI/AAAAAAAAFgg/VK5Rbf-nuHo/s480/popup.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:15:55.097

我认为需要使用 QuickAction。[快速行动](http://www.londatiga.net/it/how-to-create-quickaction-dialog-in-android/)

# html - 在页脚中放置“开发人员：名称”或“设计：名称”

> ID：12411337
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:05:20.330
> 
> 标签：html, css

这是有经验的网页设计师的问题。

有人希望我为他们创建一个网站。我已经开发好了。但是有一个问题：他不想将典型的“按名称创建”放在页面底部，所以他告诉删除它。

现在我有一个问题。您是否将此单元（块）放置在您自己创建的站点上？这个单位怎么了？如果客户不想拥有它怎么办？我必须做什么？

我在与客户沟通方面并没有什么丰富的经验。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:13:07.203

在 HTML 源代码中将其添加为注释

```
<!--
# Site developed by: Yourname
--> 
```

或您的样式表：

```
/**
 * SiteName Stylesheet 
 *
 * @author YourName | email@domain.com
 */ 
```

# jquery - 获取 div 存储在数组 x,y 位置

> ID：12411338
> 
> 赞同：1
> 
> 时间：2012-09-13T17:05:22.780
> 
> 标签：jquery, position, offset, scrollto, scrolltop

我正在开发我的网站，我有一个按钮（位置：固定），每次单击它时，我都需要将页面滚动到下一个具有 class="picture" 的 div 并且首先位于 scrollTop().top 下方价值。我将带有 class="picture" 的 div 存储在 $pictures 数组中，但我不确定是否需要它......

```
$(document).ready(function()
{

  var $pictures = $('.picture');

  var i;

  $(window).scroll(function()
  {
    for(i in $pictures)
    {
      if($("html").scrollTop() > $pictures[i].offset().top)
      {
        alert(i);
      }
    }
  });
}); 
```

不幸的是，它不起作用。也许有人有更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:35:47.407

试试这个。除了被误导的`for-in`循环之外，您还需要计算`$(window).scrollTop()`而不是`$('html').scrollTop()`，它总是等于零。

```
$(document).ready(function() {
    var $pictures = $('.picture');

    $(window).scroll(function() {
        $pictures.each(function(i, el) {
            if ($(window).scrollTop() > $(this).offset().top) {
                console.log(i);
            };
        });
    });
});​ 
```

[http://jsfiddle.net/mblase75/Uysmz/](http://jsfiddle.net/mblase75/Uysmz/)

这将记录从屏幕上向上滚动的每张图片的索引号。或者，如果您只想要滚动到屏幕外的最后一张图片，您可以使用以下`.filter`函数：

```
$(document).ready(function() {
    var $pictures = $('.picture');

    $(window).scroll(function() {
        $justpast = $pictures.filter(function(i, el) {
            return ($(window).scrollTop() > $(this).offset().top);
        }).last();
        console.log($justpast.index());
    });
});​ 
```

[http://jsfiddle.net/mblase75/RuR6R/](http://jsfiddle.net/mblase75/RuR6R/)

# php - 禁用部分页面php的警告和通知

> ID：12411344
> 
> 赞同：1
> 
> 时间：2012-09-13T17:05:42.273
> 
> 标签：php, logging, error-handling, error-reporting, phpdocx

我们正在尝试添加 PHP 库 PHPDocx，以便通过我们的 php 应用程序动态制作 Microsoft Word 文档。但是，他们的代码通过了一些警告和通知，这些警告和通知正在炸毁我们的错误日志。我们`E_STRICT`为站点设置了错误报告，并希望将错误报告和日志记录更改为`E_ERROR`仅针对这些文件。不幸的是，我们的自定义模板系统（设置错误报告）是在任何需要或引用 PHPDocx 库之前加载的。

我尝试使用`error_reporting(E_ERROR)`and `ini_set('display_errors', 0)`，但我仍然收到写入错误日志的警告和通知。我不知道是不是因为我们所有的设置代码都先运行，但我想做的只是从 PHPDocx 文件中写入致命错误，但保留`E_STRICT`在网站的其余部分。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:16:53.887

如果它们出现的次数很少，您可以`@`在任何功能之前使用符号专门抑制它们。例如;

```
echo @$myunsetvariable; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T15:24:34.103

```
error_reporting(E_ALL ^ E_NOTICE ^ E_WARNING);
ini_set('display_errors', 1); 
```

# android - 第二次执行surfaceCreated方法时Camera为null

> ID：12411346
> 
> 赞同：1
> 
> 时间：2012-09-13T17:05:47.440
> 
> 标签：android, camera, nullpointerexception, surfaceview

当第二次调用 SurfaceHolder.Callback 的 surfaceCreated 方法时，相机对象出现问题，我的意思是：

我在我的活动中的 onResume 方法中创建了一个对象相机，这可以很好地显示预览显示，但是当我的活动暂停时，表面视图被破坏，我必须释放相机对象，然后如果我的活动进入 onresume android throws我的相机对象中有一个 nullPointerException。

我不确定为什么会发生这种情况，我将注释用于调试每个方法并查看会发生什么，显然一切都很好，只有在相机对象变为 null 的 surfaceCreated 方法中。

这是我的课：

```
public class CameraRecord implements SurfaceHolder.Callback{

public static final int BACK_CAMERA = 1;
public static final int FRONT_CAMERA = 2;
//private SurfaceView surface;
private SurfaceHolder holder;
private Camera camera;

public CameraRecord(SurfaceView surface){
//  this.surface = surface;
    holder = surface.getHolder();
    holder.addCallback(this);
    holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

    Log.e("CameraRecord","constructor");
}

public void openCamera(int wichCamera) throws Exception {

    if (wichCamera == BACK_CAMERA)
        camera = Camera.open();
    else {
        Camera.CameraInfo cameraInfo = new Camera.CameraInfo();
        int cameraCount = Camera.getNumberOfCameras();

        for (int i = 0; i < cameraCount; i++ ) {
            Camera.getCameraInfo(i, cameraInfo);
            if (cameraInfo.facing == Camera.CameraInfo.CAMERA_FACING_FRONT)
                try {
                    camera = Camera.open(i); 
                    Log.e("CameraRecord","camera is CAMERA_FACING_FRONT " + cameraInfo.toString());
                } catch (RuntimeException e) {
                    e.printStackTrace();
                }
        }
    }

    if (camera == null)
        Log.e("CameraRecord","openCamera camera is null");
    else
        Log.e("CameraRecord","openCamera camera is not null");

}

public void start() throws IOException {
    camera.startPreview();
}

public void stop() {
    camera.stopPreview();
    Log.e("CameraRecord","stop camera");
}

public void release() {
    camera.release();
    camera = null;
}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
    Log.e("CameraRecord", "surfaceChanged");
    try {
        start();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
//      if (holder == null)
//          Log.e("CameraRecord","holder is null");
//      else
//          Log.e("CameraRecord","holder is not null");

    try {
        if (camera == null)
            Log.e("CameraRecord","camera is null");
        else
            Log.e("CameraRecord","camera is not null");

        camera.setPreviewDisplay(holder);
//          start();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    Log.e("CameraRecord", "surfaceDestroyed");
    stop();
    release();
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-01T23:27:38.220

我遇到了同样的问题。我解决它的方法是在我释放相机的同时（在 onPause() 方法上）在 SurfaceHolder 中调用 removeCallbak() 方法。我想在你的例子中是

```
holder.removeCallback(this); 
```

这个想法是，不仅您在活动的 onPause() 方法上释放相机，而且还删除了 SurfaceHolder 上设置的回调。如果您不这样做，则会第二次出现错误，因为回调是针对您关联的第一个实例而不是第二个实例进行的。如果你也在 onPause() 上删除回调，你应该不会有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T13:06:19.697

我有这样的问题，在 AndroidManifest.xml 中添加这 3 行后，我的应用程序工作了

```
<uses-permission android:name="android.permission.CAMERA" />    
    <uses-feature android:name="android.hardware.camera" />
    <uses-feature android:name="android.hardware.camera.autofocus" /> 
```

也许它会帮助你:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-09T05:57:13.737

```
public void release() {
    camera.release();
    camera = null;
} 
```

这应该是：

```
public void release() {
   if(camera!=null) camera.release();
    camera = null;
} 
```

# c# - 将一些 C# 代码转换为托管或 C++/CLI 代码

> ID：12411349
> 
> 赞同：3
> 
> 时间：2012-09-13T17:05:57.630
> 
> 标签：c#, c++, c++-cli, reflector

我有一个现有的 C# 应用程序。我想要的是为 c# 应用程序的某些部分编写本机代码以提高速度，而另一部分使用 C# 应用程序，另一部分使用 C++/CLI 为 C# 应用程序提供接口。所以对于后面的部分，我需要将 C# 代码转换为 C++/CLI。

我想知道是否可以将我的 C# 代码转换为 C++/CLI 代码。也许将 .net 程序集转换为 C++/CLI 是获取特定代码的更好主意。我研究了反射器及其插件 CppCli。但是插件不再可用。所以我正在寻找任何方法来自动化这个。我会很感激任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:16:25.407

一般来说，C++/CLI 的运行时间与 C# 大致相同（两者都是托管的，并且可能会转换为相同的 IL）。如果您的应用程序的某个部分需要运行得更快，您可以编写一个 C++/CLI 层，以便您的 C# 应用程序可以与一些本机 C++ 互操作。如果您适当地编写本机 C++，这将更快。

编辑：正如 Ben Voigt 所指出的，C++/CLI 可能比 C# 更优化，但仍然不如编写良好的原生 C++ 快，因为它仍然是受管理的。

如果您希望在 C++/CLI 中包装一些本机代码，那么转换工具可能无论如何都不会以有用的方式构造它。你最好只手动编码互操作部分。

有[商业工具](http://www.tangiblesoftwaresolutions.com/Product_Details/CSharp_to_CPlusPlus_Converter_Details.html)可以做到这一点，但我认为你最好还是用手做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:10:25.290

您可能不必转换代码。

link.exe 是 C++ 编译器工具的一部分，它能够在同一个程序集中包含 C++ 和 C# 代码。C++ 位可以包含托管和非托管代码的混合。您首先必须使用 C# 编译器 (csc.exe) 的命令行开关将 C# 代码编译为 .net 模块，然后您可以使用 link.exe 将其编译为带有 C++ 代码的程序集。自从我创建了一个混合语言程序集以来已经有一段时间了，如果细节不是 100%，我们深表歉意，但是搜索上述术语，你会找到一种方法。

我似乎记得关键部分是记住 C++ 编译器比其他编译器更先进，因此可以使用 C#/VB 网络模块，但反过来不行。我发现编译成单个程序集而不是一个程序集引用另一个程序集的优点是单个程序集的每个部分内的类型可以相互交叉引用。通过在两个单独的程序集之间进行引用，类型感知关系必须是分层的。

C# 中还有[unsafe](http://msdn.microsoft.com/en-us/library/chfa2zb8%28v=vs.100%29.aspx)关键字，它允许在 C# 代码文件的各个部分中使用 C++ 风格的指针，并关闭数组边界检查。根据您的使用场景，这可能会或可能不重要。

就我个人而言，我发现在 C++ 编译器中运行一些计算密集型代码的速度比 C# 快 20 倍，在我使用 C++ 中可用的指针对其进行优化之后，这在我的案例中是值得的。

# c - 如何使用 API 并正确初始化 openssl？

> ID：12411350
> 
> 赞同：1
> 
> 时间：2012-09-13T17:05:57.860
> 
> 标签：c, api, ssl, encryption, openssl

# 如何使用 API 并正确初始化 openssl？

我必须让 opevpn 与称为 GOST 的俄罗斯加密标准一起工作。我知道[cryptocom](http://www.cryptocom.ru/opensource/openvpn.html)的现有产品提供了这个机会。我浏览了他们的网站，发现他们在演示版中使用了 openssl 0.9.8 版。我试过演示。它可以工作，但使用共享库和过时的 openssl 和 opevpn 版本。

到目前为止，实际的 openssl 版本是[1.0.1c](http://www.openssl.org/source/openssl-1.0.1c.tar.gz)，我想使用静态 libssl 和 libcripto（如果可能的话）。正如我在 openssl [changelog](http://www.openssl.org/news/changelog.html)中所读到的，从 1.0.0 版开始，库支持 GOST 加密（仅供参考，由**cryptocom**实现）。

* * *

## 我做了什么

我已经像这样下载并编译了 openssl-1.0.1c：

```
mkdir ~/test
cd ~/test
wget http://www.openssl.org/source/openssl-1.0.1c.tar.gz
...
tar xzf openssl-1.0.1c.tar.gz
cd openssl-1.0.1c
./config enable-gost -fPIC no-shared
...
make
... 
```

我已经编写了配置文件来启用 GOST 加密算法**~/test/openssl.cnf**

```
openssl_conf = openssl_def
[openssl_def]
engines = engine_section

[engine_section]
gost = gost_section

[gost_section]
engine_id = gost
default_algorithms = ALL
CRYPT_PARAMS = id-Gost28147-89-CryptoPro-A-ParamSet

# man ca(1SSL)
[ ca ]
default_ca  = CA_default

# man ca(1SSL)
[ CA_default ]
dir             = ./CA                    # Where everything is kept
certs           = $dir/certs              # Where the issued certs are kept
crl_dir         = $dir/crl                # Where the issued crl are kept
database        = $dir/index.txt          # database index file.
new_certs_dir   = $dir/newcerts           # default place for new certs.
certificate     = $dir/ca.pem             # The CA certificate
serial          = $dir/serial             # The current serial number
crlnumber       = $dir/crlnumber          # the current crl number
crl             = $dir/crl.pem            # The current CRL
private_key     = $dir/private/cakey.pem  # The private key
RANDFILE        = $dir/private/.rand      # private random number file
x509_extensions = usr_cert                # The extentions to add to the cert
name_opt        = ca_default              # Subject Name options
cert_opt        = ca_default              # Certificate field options
default_days    = 365                     # how long to certify for
default_crl_days= 30                      # how long before next CRL
default_md      = default                 # use public key default MD
preserve        = no                      # keep passed DN ordering
policy          = policy_match

# man ca(1SSL)
[ policy_match ]
countryName             = match
stateOrProvinceName     = match
organizationName        = match
organizationalUnitName  = optional
commonName              = supplied
emailAddress            = optional

# man req(1SSL)
[ req ]
default_bits        = 1024
distinguished_name  = req_distinguished_name
attributes          = req_attributes
x509_extensions     = v3_ca 
string_mask         = utf8only

# man req(1SSL)
[ req_distinguished_name ] 
countryName                     = Country Name (2 letter code)
countryName_default             = RU
countryName_min                 = 2
countryName_max                 = 2
stateOrProvinceName             = State or Province Name (full name)
stateOrProvinceName_default     = Moscow
localityName                    = Locality Name (eg, city)
localityName_default            = Moscow
0.organizationName              = Organization Name (eg, company)
0.organizationName_default      = Company Ltd
organizationalUnitName          = Organizational Unit Name (eg, section)
organizationalUnitName_default  = Organisation Unit
commonName                      = Common Name (e.g. server FQDN or YOUR name)
commonName_max                  = 64
emailAddress                    = Email Address
emailAddress_max                = 64

# man req(1SSL)
[ req_attributes ]
challengePassword     = A challenge password
challengePassword_min = 4
challengePassword_max = 20
unstructuredName      = An optional company name

# man x509v3_config(5SSL)
[ usr_cert ]
basicConstraints       = CA:FALSE
nsCertType             = client, email, objsign
keyUsage               = nonRepudiation, digitalSignature, keyEncipherment
nsComment              = "Some company OpenSSL Generated Certificate"
subjectKeyIdentifier   = hash
authorityKeyIdentifier = keyid,issuer

# man x509v3_config(5SSL)
[ v3_ca ]
subjectKeyIdentifier=hash
authorityKeyIdentifier=keyid:always,issuer
basicConstraints = CA:true 
```

然后我查看了支持的 TLS 密码：

```
OPENSSL_CONF=~/test/openssl.cnf ./apps/openssl ciphers -tls1
WARNING: can't open config file: /usr/local/ssl/openssl.cnf
ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:SRP-DSS-AES-256-CBC-SHA:SRP-RSA-AES-256-CBC-SHA:DHE-DSS-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA256:DHE-RSA-AES256-SHA:DHE-DSS-AES256-SHA:DHE-RSA-CAMELLIA256-SHA:DHE-DSS-CAMELLIA256-SHA:GOST2001-GOST89-GOST89:GOST94-GOST89-GOST89:ECDH-RSA-AES256-GCM-SHA384:ECDH-ECDSA-AES256-GCM-SHA384:ECDH-RSA-AES256-SHA384:ECDH-ECDSA-AES256-SHA384:ECDH-RSA-AES256-SHA:ECDH-ECDSA-AES256-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:CAMELLIA256-SHA:PSK-AES256-CBC-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:SRP-DSS-3DES-EDE-CBC-SHA:SRP-RSA-3DES-EDE-CBC-SHA:EDH-RSA-DES-CBC3-SHA:EDH-DSS-DES-CBC3-SHA:ECDH-RSA-DES-CBC3-SHA:ECDH-ECDSA-DES-CBC3-SHA:DES-CBC3-SHA:PSK-3DES-EDE-CBC-SHA:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:SRP-DSS-AES-128-CBC-SHA:SRP-RSA-AES-128-CBC-SHA:DHE-DSS-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-SHA256:DHE-DSS-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA:DHE-RSA-SEED-SHA:DHE-DSS-SEED-SHA:DHE-RSA-CAMELLIA128-SHA:DHE-DSS-CAMELLIA128-SHA:ECDH-RSA-AES128-GCM-SHA256:ECDH-ECDSA-AES128-GCM-SHA256:ECDH-RSA-AES128-SHA256:ECDH-ECDSA-AES128-SHA256:ECDH-RSA-AES128-SHA:ECDH-ECDSA-AES128-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:SEED-SHA:CAMELLIA128-SHA:IDEA-CBC-SHA:PSK-AES128-CBC-SHA:ECDHE-RSA-RC4-SHA:ECDHE-ECDSA-RC4-SHA:ECDH-RSA-RC4-SHA:ECDH-ECDSA-RC4-SHA:RC4-SHA:RC4-MD5:PSK-RC4-SHA:EDH-RSA-DES-CBC-SHA:EDH-DSS-DES-CBC-SHA:DES-CBC-SHA:EXP-EDH-RSA-DES-CBC-SHA:EXP-EDH-DSS-DES-CBC-SHA:EXP-DES-CBC-SHA:EXP-RC2-CBC-MD5:EXP-RC4-MD5 
```

并找到了 GOST。

* * *

## 我的问题是什么：

我想使用 openssl API（我的意思是 libcripto 和 libssl）获取 TLS 密码列表。我写了一个小程序，它输出 openssl 提供的 TLS 密码**~/test/test.c**：

```
#include <openssl/ssl.h>
#include <openssl/err.h>
#include <stdio.h>

void show_available_tls_ciphers (void)
{
  SSL_CTX *ctx;
  SSL *ssl;
  int i;
  const char *cipher_name;
  int priority = 0;

  ctx = SSL_CTX_new(TLSv1_method());
  if (!ctx) {
    ERR_print_errors_fp(stderr);    
    return;
  }

  ssl = SSL_new (ctx);
  if (!ssl) {
    ERR_print_errors_fp(stderr);
    SSL_CTX_free(ctx);
  }

  STACK_OF(SSL_CIPHER) *sk = SSL_get_ciphers(ssl);
  if(!sk) {
    ERR_print_errors_fp(stderr);
    SSL_CTX_free(ctx);
    SSL_free(ssl);
    return;
  }

  for(i=0; i< sk_SSL_CIPHER_num(sk); ++i) {
    printf("%s\n",sk_SSL_CIPHER_value(sk,i)->name);
  }

  printf ("\n");

  SSL_free (ssl);
  SSL_CTX_free (ctx);
}

int main(void) {
  CRYPTO_malloc_init();
  SSL_library_init();
  ERR_load_crypto_strings();

  OpenSSL_add_all_algorithms();
  ENGINE_load_builtin_engines();
  OpenSSL_add_ssl_algorithms();

  SSL_load_error_strings();
  show_available_tls_ciphers();
  return 0;
} 
```

编译成这样

```
cd ~/test
gcc test.c  -g -O0 -I~/test/openssl-1.0.1c/include -L~/test/openssl-1.0.1c -lssl -lcrypto -ldl 
```

但我的结果与`OPENSSL_CONF=~/test/openssl.cnf ./apps/openssl ciphers -tls11`上面的输出不同，不包括 GOST：

```
OPENSSL_CONF=~/test/openssl.cnf ./a.out
ECDHE-RSA-AES256-GCM-SHA384
ECDHE-ECDSA-AES256-GCM-SHA384
ECDHE-RSA-AES256-SHA384
ECDHE-ECDSA-AES256-SHA384
ECDHE-RSA-AES256-SHA
ECDHE-ECDSA-AES256-SHA
SRP-DSS-AES-256-CBC-SHA
SRP-RSA-AES-256-CBC-SHA
DHE-DSS-AES256-GCM-SHA384
DHE-RSA-AES256-GCM-SHA384
DHE-RSA-AES256-SHA256
DHE-DSS-AES256-SHA256
DHE-RSA-AES256-SHA
DHE-DSS-AES256-SHA
DHE-RSA-CAMELLIA256-SHA
DHE-DSS-CAMELLIA256-SHA
ECDH-RSA-AES256-GCM-SHA384
ECDH-ECDSA-AES256-GCM-SHA384
ECDH-RSA-AES256-SHA384
ECDH-ECDSA-AES256-SHA384
ECDH-RSA-AES256-SHA
ECDH-ECDSA-AES256-SHA
AES256-GCM-SHA384
AES256-SHA256
AES256-SHA
CAMELLIA256-SHA
PSK-AES256-CBC-SHA
ECDHE-RSA-DES-CBC3-SHA
ECDHE-ECDSA-DES-CBC3-SHA
SRP-DSS-3DES-EDE-CBC-SHA
SRP-RSA-3DES-EDE-CBC-SHA
EDH-RSA-DES-CBC3-SHA
EDH-DSS-DES-CBC3-SHA
ECDH-RSA-DES-CBC3-SHA
ECDH-ECDSA-DES-CBC3-SHA
DES-CBC3-SHA
PSK-3DES-EDE-CBC-SHA
ECDHE-RSA-AES128-GCM-SHA256
ECDHE-ECDSA-AES128-GCM-SHA256
ECDHE-RSA-AES128-SHA256
ECDHE-ECDSA-AES128-SHA256
ECDHE-RSA-AES128-SHA
ECDHE-ECDSA-AES128-SHA
SRP-DSS-AES-128-CBC-SHA
SRP-RSA-AES-128-CBC-SHA
DHE-DSS-AES128-GCM-SHA256
DHE-RSA-AES128-GCM-SHA256
DHE-RSA-AES128-SHA256
DHE-DSS-AES128-SHA256
DHE-RSA-AES128-SHA
DHE-DSS-AES128-SHA
DHE-RSA-SEED-SHA
DHE-DSS-SEED-SHA
DHE-RSA-CAMELLIA128-SHA
DHE-DSS-CAMELLIA128-SHA
ECDH-RSA-AES128-GCM-SHA256
ECDH-ECDSA-AES128-GCM-SHA256
ECDH-RSA-AES128-SHA256
ECDH-ECDSA-AES128-SHA256
ECDH-RSA-AES128-SHA
ECDH-ECDSA-AES128-SHA
AES128-GCM-SHA256
AES128-SHA256
AES128-SHA
SEED-SHA
CAMELLIA128-SHA
IDEA-CBC-SHA
PSK-AES128-CBC-SHA
ECDHE-RSA-RC4-SHA
ECDHE-ECDSA-RC4-SHA
ECDH-RSA-RC4-SHA
ECDH-ECDSA-RC4-SHA
RC4-SHA
RC4-MD5
PSK-RC4-SHA
EDH-RSA-DES-CBC-SHA
EDH-DSS-DES-CBC-SHA
DES-CBC-SHA
EXP-EDH-RSA-DES-CBC-SHA
EXP-EDH-DSS-DES-CBC-SHA
EXP-DES-CBC-SHA
EXP-RC2-CBC-MD5
EXP-RC4-MD5 
```

为了写这篇文章，我使用了 openssl-1.0.1c/apps/ciphers.c 文件中的代码和 openssl 初始化顺序。

为什么我在输出中看不到 GOST，`a.out`我做错了什么？我应该如何编写代码才能正确使用 openssl 以在我的测试程序的输出中查看 GOST？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:53:16.693

简而言之 - 你没有调用设置配置的东西。

查看您获取的 openssl 包中的 apps/open ssl.c 的来源（chipers.c 是基于您在“openssl ciphers”中运行的 $0 链接到它的代码）。

请注意以下内容：

```
 p=getenv("OPENSSL_CONF");
    if (p == NULL)
            p=getenv("SSLEAY_CONF");
    if (p == NULL)
            p=to_free=make_config_name();

    default_config_file=p; 
```

然后再往下：

```
 config=NCONF_new(NULL);
    i=NCONF_load(config,p,&errline);
    if (i == 0) ... 
```

这就是它吸收配置的方式。

德。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T08:00:17.760

您应该在第一条指令中调用它来加载默认配置：

```
OPENSSL_config(NULL); 
```

将加载所有密码，包括配置中的 gost。您也可以在加载配置后设置：

```
'#define CIPHER_LIST "GOST2001-NULL-GOST94"//GOST2001-GOST89-GOST89 (chose one)

SSL_CTX_set_cipher_list(ctx, CIPHER_LIST) 
```

你只会得到这个芯片。

# java - 使用 SSL 连接到 FTP 服务器的 Java 代码

> ID：12411363
> 
> 赞同：1
> 
> 时间：2012-09-13T17:06:48.033
> 
> 标签：java, ssl-certificate

我正在寻找使用 SSL 证书连接到 FTP 服务器的 Java 示例代码。我的项目文件夹中有所有需要的证书。我尝试了一些方法，但它不起作用。我们正在使用 Spring 批处理组件。任何帮助表示赞赏。谢谢

```
protected FTPSClient createFTPClient() throws Exception {
 FTPSClient client = new FTPSClient(protocol,true); 
 client.setNeedClientAuth(true);
 KeyStore ks = KeyStore.getInstance("JKS"); 
 FileInputStream fis = new FileInputStream(keyStoreFile);
 ks.load(fis, keyStorePassword.toCharArray());
 fis.close();
 KeyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory .getDefaultAlgorithm());
 kmf.init(ks, keyStorePassword.toCharArray());
 client.setKeyManager(kmf.getKeyManagers()[0]);
 return client; 
}

int reply; 
FTPSClient ftps = null;
try { 
  ftps = createFTPClient();
  ftps.addProtocolCommandListener(new PrintCommandListener(new PrintWriter(System.out)));       
  //ftps.setTrustManager(trustManager) 
  ftps.connect(host,portnumber);
  ...... 
```

我收到明文连接异常....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T12:21:29.963

我从这个不同的问题[425 error ftp over SSL in Java 中得到了这个](https://stackoverflow.com/questions/7196630/425-error-ftp-over-ssl-in-java)

```
ftps.setTrustManager(TrustManagerUtils.getAcceptAllTrustManager()); 
```

它可能会有所帮助。

# git - Git stash 没有完成申请

> ID：12411366
> 
> 赞同：0
> 
> 时间：2012-09-13T17:07:13.513
> 
> 标签：git, git-stash

在存储弹出后，我的 50 个文件中只有大约 5 个被更改。随着我回来的一些更改，我得到了一个奇怪的额外文件“Y4\004%C2%F8\037UU%BC”。

我的 IntelliJ 中确实有本地历史记录，所以我可能可以恢复其中的大部分，但是有没有办法从 git 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:48:38.627

所以我认为出于某种原因 git 在解析它的存储时遇到了麻烦。

这就是我绕过它的方式

```
git stash STASHNUMBER show -p > out.txt 
```

将 STASHNUMBER 替换为存储的编号，如果它位于存储堆栈的顶部，则将其排除在外。

然后

```
git apply out.txt 
```

如果您仍然遇到问题，您可以尝试更改 out.txt 以保存尽可能多的更改，然后再次尝试应用

# c++ - 标准计时时钟的 now() 调用的性能保证？

> ID：12411370
> 
> 赞同：2
> 
> 时间：2012-09-13T17:07:25.207
> 
> 标签：c++, performance, c++11, std, chrono

在 std::chrono 中实现每个时钟的 now() 静态函数所需的标准中是否有任何性能保证？

在 n3337 我读到（ 20.11.3 时钟要求 [time.clock.req] ）：

> 3 [注：给定时钟报告的持续时间与 SI 定义之间的相对差异是实施质量的衡量标准。——尾注]

这是否意味着它完全依赖于实现？还是我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:15:01.097

标准时钟的速度、精度、分辨率等都完全取决于实现。对时钟性能的这些方面没有任何要求。

我想大多数任何实现都将提供硬件提供的最佳速度和准确性。另一方面，分辨率似乎因实现而异，有些提供纳秒，有些提供相当低的分辨率。

# subdomain - 在子域中存储客户端文件（img、css、javascript）有什么好处？

> ID：12411372
> 
> 赞同：2
> 
> 时间：2012-09-13T17:07:32.027
> 
> 标签：subdomain, client-side

我注意到所有高流量网站都将其客户端文件（img、css、javascript 等）存储在子域或单独的域中。

例如，Tumblr 使用这样的子域，

```
<script type="text/javascript" language="javascript" src="https://secure.assets.tumblr.com/javascript/prototype_and_effects.js?024ec5b06b4396bc5c84d8624"></script> 
```

Facebook 使用一个单独的域`fbcdn.net`来存储他们的 css 文件，

```
<link rel="stylesheet" href="https://s-static.ak.fbcdn.net/rsrc.php/v2/y1/r/WWO883Qmw.css" /> 
```

Twitter 还使用一个单独的域，称为`twimg.com`

```
<link rel="stylesheet" href="https://si0.twimg.com/a/1347423426/t1/css/t1_core.bundle.css" type="text/css" media="screen" /> 
```

我相信他们这样做是因为在性能方面有好处。**具体有什么好处？**

另外，我正在建立一个人们可以登录和注销的网站。每个页面都有一些图像，3 到 4 个 css 文件和 3 到 4 个 javascript 文件。目前，我使用主域来存储这样的客户端文件，`www.example.com/css/mypage.css`

**如果我使用子域来存储它们，是否会对性能有任何好处？（考虑到我的网站没有那么多客户端文件）**

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:19:23.300

仅仅通过使用子域，您不会获得任何性能优势。专用于资产的子域通常是更大的性能改进策略的一部分。

例如：子域实际上可能指向与主网站不同的物理服务器，除了处理静态图像请求之外什么都不做。它甚至可以使用不同的服务器软件（比如 NGINX 或 lighttpd），其开销比传统的 apache 设置要少。

子域通常也指向像 Akamai 或 Amazon CloudFront 这样的 CDN。CDN 是在世界不同地区拥有数据中心的公司。当您从地理上更接近收件人的计算机提供静态文件时，您可以大大减少文件到达收件人所需的时间。

有时会设置一个完全不同的域来处理静态请求，例如 facebook。这也是为什么 facebook 域中有字母 CDN 的原因......因为它就是这样！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:19:37.847

子域本身没有任何好处。但是，在子域上允许 DNS 系统将您的请求发送到不同的服务器——甚至是使用 CDN 样式缓存的完全不同的服务器集（如 Gunner 所述）。托管静态内容有许多快速简便的方法，可以减轻动态内容服务器的负载。

EDIT: I noticed that nobody noted what CDN (Content Delivery Network) stands for.

# c# - Umbraco 4.8，文档保存发布

> ID：12411374
> 
> 赞同：1
> 
> 时间：2012-09-13T17:07:33.823
> 
> 标签：c#, razor, umbraco

Umbraco 4.8 在 umbraco.cms.businesslogic.web.Document.Publish 方法中有错误？我尝试编辑节点，保存并发布节点。我可以在 BackOffice 中查看节点已正确更改。在网页中，我使用 razor 渲染为 HTML。这个 cshtml 文件使用 umbrac.MacroEngines.DynamicNode。此节点版本返回旧值。然后，在 BackOffice 中，我尝试单击“Salve and Publish”，然后网页呈现正确的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:16:03.063

`DynamicNode`从`umbraco.config`缓存中访问节点的信息，它不直接访问数据库（参见[Node 和 Document 之间的区别](http://our.umbraco.org/wiki/reference/api-cheatsheet/difference-between-node-and-document)）。保存和发布不会自己更新缓存，还有一个额外的步骤。例子：

```
Document document = new Document(1234);
document.Text = "New Title";
document.Publish(User.GetUser(0));    
umbraco.library.UpdateDocumentCache(document.Id); 
```

有关详细信息，请参阅[发布和重新发布。](http://our.umbraco.org/wiki/reference/api-cheatsheet/publishing-and-republishing)

# php - 对实时应用程序使用恒定的 ajax 请求会给服务器/数据库带来压力吗？

> ID：12411378
> 
> 赞同：2
> 
> 时间：2012-09-13T17:07:42.870
> 
> 标签：php, javascript, mysql, ajax, real-time

好的，所以我试图构建类似于实时应用程序的东西（一旦添加就从数据库中获取新数据的东西），我能想出的唯一解决方案是不断使用 ajax 请求（通过 setInterval() javascript中的方法）每隔几秒钟检查一次新信息，但我很好奇这会给数据库或服务器带来什么样的压力。

做这样的事情会不会是矫枉过正，还是有更好的方法来构建实时应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:17:54.357

您的问题归结为两个选项，**`long polling`**或**`short polling`**. 在第一个选项中，**`AJAX`**向服务器发送请求。服务器搜索新的更新。如果找到，它会立即返回。否则它会休眠，比如说 0.5 秒，然后它会再次搜索更新。这会持续一段时间，然后发送数据数组中的任何内容。收到响应后，JS 可以采取适当的响应（如果有*一些*数据，也许可以使用它来操作**`DOM`**），并发送另一个请求，并且无限地继续下去。这有一个缺点，即它在服务器端消耗大量资源。但是，如果您希望新的更新几乎立即反映（例如在 Facebook 中），这可能是您最好的选择。

在第二个选项中，正如您提到的，服务器端的负载减少了。但反映更新所花费的时间可能会更长。另外，如果用户的网速很慢，也会增加延迟。更不用说，重复请求我浪费了用户带宽（尽管如果您设计您的网站以确保只发送最少的数据，这可以得到缓解）。Websockets API 可能很方便，但据我所知，并非所有浏览器都完全支持它，最新版本除外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:10:02.150

如果您可以将 HTML 5 用于您的应用程序，我会推荐 Web 套接字。

[http://www.websocket.org](http://www.websocket.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:10:22.553

更好的方法是使用 Web 套接字或类似方法。

例如，参见[棘轮](http://socketo.me/)。

# ios - iOS - 带有 facebook 的 AddThis SDK 看起来很糟糕

> ID：12411388
> 
> 赞同：0
> 
> 时间：2012-09-13T17:08:34.130
> 
> 标签：ios, facebook, addthis

使用此代码（我可以在他们的文档中找到的唯一相关代码）

```
[AddThisSDK shareURL:self.data.url
                  withService:@"facebook"
                        title:@"this is the title text"
                  description:@"the description"]; 
```

导致“发布到墙上”对话框出现以下问题：

1.  “说点什么……”字段是空的。我们可以预先填充吗？
2.  在“说点什么”字段下方，会显示一个“在 android 市场上可用”图标。这是 iOS，我不知道为什么会出现这种情况。
3.  “无标题文档”显示为链接标题，标题文本和描述在其下方。如何用更有用的东西替换“无标题文档”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T13:58:27.203

1.  “说点什么……”不能被覆盖，因为它是一个 FB 控件，他们不希望应用程序在未经用户同意的情况下发布内容。另一种方法是使用 FB API 直接发布到用户的墙上而不使用对话框。

2.  显示的图像是从您尝试共享的页面中提取的。确保您设置了正确的 Open Graph 标记。您可以使用此页面查看您的标签是否设置正确：

[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)

1.  不确定“无标题文档”问题，如果您还没有，请尝试演示应用程序并将其替换为您的变量，看看您是否得到相同的结果。

# javascript - 创建一个 Cookie，以记住页面是否应该加载响应式设计的移动或桌面布局

> ID：12411391
> 
> 赞同：0
> 
> 时间：2012-09-13T17:08:38.693
> 
> 标签：javascript, mobile, cookies, responsive-design

我创建了一个响应式设计，允许用户在移动和桌面布局之间切换。我唯一的问题是，如果用户想要查看桌面版本，然后单击另一个链接，或刷新页面，则再次加载移动版本。我想创建一个 cookie，以便它记住用户在每个页面加载时的偏好。

这是我正在使用的javascript：

```
$(document).ready(function () {
    $('.full_site').click(function() {
        $('body').removeClass('mobile');
        $('body').addClass('desktop');
        $('.views-row').each(function(i,e) {
            $('.content .body', e).insertAfter($('.content .loc-text', e));
        });
    });

    $('.mobile_site').click(function() {
        $('body').removeClass('desktop');
        $('body').addClass('mobile');
        $('.views-row').each(function(i,e) {
          $('.content .body', e).insertBefore($('.content .field-name-field-image-one', e));
        });

        $('.views-row').each(function(i,e) {
          $('.content .body', e).insertBefore($('.content .field-name-field-image', e));
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:28:51.867

以下是一个粗略的草稿，其中包含可帮助您完成整个过程的评论：

```
$(document).ready(function () {
    $('.full_site').click(function() {
        document.cookie = "type=full"; //set/update the cookie
        $('body').removeClass('mobile');
        $('body').addClass('desktop');
        $('.views-row').each(function(i,e) {
            $('.content .body', e).insertAfter($('.content .loc-text', e));
        });
    });

    $('.mobile_site').click(function() {
        document.cookie = "type=mobile"; //set/update cookie
        $('body').removeClass('desktop');
        $('body').addClass('mobile');
        $('.views-row').each(function(i,e) {
          $('.content .body', e).insertBefore($('.content .field-name-field-image-one', e));
        });

        $('.views-row').each(function(i,e) {
          $('.content .body', e).insertBefore($('.content .field-name-field-image', e));
        });
    });
   if(/*check to see what the cookie is...*/) 
     $(".mobile_site").trigger("click"); //trigger the mobile site
   else
     $(".full_site").trigger("click"); //trigger the full site
}); 
```

有关 cookie 的更多信息：[https ://developer.mozilla.org/en-US/docs/DOM/document.cookie](https://developer.mozilla.org/en-US/docs/DOM/document.cookie)

和：[http ://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

# objective-c - 将 nil 分配给传递给方法的成员变量

> ID：12411392
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:08:38.903
> 
> 标签：objective-c, instance-variables, local-variables

我想分配`nil`给一个对象，它是一个 ivar，作为参数传递给一个方法，就像这样。

```
- (int)trashObjectPassedIn:(Banana* banana) {
    banana = nil;

    return 42;
} 
```

当然，如果我这样称呼它：`[self trashObjectPassedIn:oldBanana];`oldBanana is untouched - 只分配了本地参数。

有什么方法可以分配`nil`给原始对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:13:59.070

我建议寻找一种替代方法。您的垃圾对象PassedIn 传递了对香蕉的*引用。*您可以将其设为 nil，但实际的香蕉不会发生任何事情。

如果您希望删除香蕉（并且您正在使用 ARC），那么您应该将*拥有*香蕉的属性或成员变量设为 nil。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:23:26.730

虽然这看起来很奇怪，但有一些（虽然不是很多）合理的理由这样做，您可以通过将指针传递给您的对象指针来做到这一点。这称为按引用传递，其中目标 c 通常是按值传递。你可以在任何接受 NSError 的方法中看到它在 Cocoa 中被使用，例如`save:`在`NSManagedObjectContext`. [这个答案](https://stackoverflow.com/questions/3331791/arguments-by-reference-in-objective-c)有更详细的描述

将方法声明更改为

```
- (int)trashObjectPassedIn:(Banana **)banana 
```

并通过调用传递值

```
int result = [self trashObjectPassedIn:&banana]; 
```

然后在方法内你可以设置值：

```
*banana = nil; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T20:56:37.667

假设您使用的是 ARC，并且您的实例变量是一个`strong`引用，请这样做：

```
- (int)trashObjectPassedIn:(Banana *__strong *)banana) 
{
    *banana = nil;
    return 42;
} 
```

这样可以防止对象泄漏。请注意，这不适用于`weak`引用。如果您不使用 ARC，我认为要使其正常和安全地工作要困难得多。

**编辑**：忘记显示如何调用它：您的实例变量`[self trashObjectPassedIn:&_myBanana]`在哪里。`_myBanana`

# audio - Phonegap - 听起来不工作

> ID：12411394
> 
> 赞同：0
> 
> 时间：2012-09-13T17:08:48.560
> 
> 标签：audio, cordova

我花了几个小时试图让我的 phonegap 应用程序与 mp3 文件一起工作。我已经测试了两个科尔多瓦版本（1.9 和 2.0）。我尝试过使用大于和小于 1MB 的文件。没有任何帮助。来自互联网的文件听起来很好：

```
my_media = new Media("http://www.example.com/test.mp3");
my_media.play(); 
```

但它不适用于本地文件：

```
my_media = new Media("/android_asset/www/sounds/test.mp3");
my_media.play(); 
```

Eclipse 中的 LogCat 抛出错误：

```
09-13 18:55:58.085: W/System.err(7525): java.io.FileNotFoundException: This file can not be opened as a file descriptor; it is probably compressed
09-13 18:55:58.085: W/System.err(7525):     at android.content.res.AssetManager.openAssetFd(Native Method)
09-13 18:55:58.101: W/System.err(7525):     at android.content.res.AssetManager.openFd(AssetManager.java:330)
09-13 18:55:58.101: W/System.err(7525):     at org.apache.cordova.AudioPlayer.startPlaying(AudioPlayer.java:223)
09-13 18:55:58.101: W/System.err(7525):     at org.apache.cordova.AudioHandler.startPlayingAudio(AudioHandler.java:227)
09-13 18:55:58.125: W/System.err(7525):     at org.apache.cordova.AudioHandler.execute(AudioHandler.java:75)
09-13 18:55:58.125: W/System.err(7525):     at org.apache.cordova.api.PluginManager$1.run(PluginManager.java:185)
09-13 18:55:58.125: W/System.err(7525):     at java.lang.Thread.run(Thread.java:1019) 
```

有没有人有任何建议我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:51:25.293

android 的基本概念之一是您的资产文件被压缩并且您不能直接访问它们。利用 ：

```
getAssets().open(mp3FileUrl) 
```

而是获取 mp3 文件的 InputStream

更新：因为您使用的是phonegap，所以我建议您首先将您需要的文件解压缩到您的数据目录，然后您可以直接使用它们。拆包使用：

```
window.resolveLocalFileSystemURI("file:///android_asset/www/foo.html", onResolveSuccess, onFail); 
```

然后他们用 phonegap 文件 API 复制它。你可以访问你的文件`/data/data/packagename/filename`

# python - Python：自定义 JSON 解码器的性能

> ID：12411395
> 
> 赞同：5
> 
> 时间：2012-09-13T17:08:48.953
> 
> 标签：python, json, python-3.x

我有一个应用程序，它使用标准 JSON 工具定期将 JSON 文件转储并加载到 Python 中。

早期，我们认为将加载的 JSON 数据作为对象而不是字典来处理要方便得多。这实际上归结为“点”成员访问的便利性，而不是`[]`字典键查找的符号。Javascript 的优点之一是字典查找和成员数据访问之间没有真正的区别（我猜这就是 JSON 特别适合 Javascript 的原因）。但在 Python 中，字典键和对象数据成员是不同的东西。

所以，我们的解决方案是只使用一个自定义 JSON 解码器，它使用一个`object_hook`函数来返回对象而不是字典。

我们从此过上了幸福的生活……直到现在，这个设计决定可能被证明是一个错误。您会看到，现在 JSON 转储文件变得相当大（> 400 MB）。据我所知，标准的 Python 3 JSON 工具使用本机代码进行实际解析，因此速度非常快。但是，如果您提供 custom `object_hook`，它仍然必须为每个解码的 JSON 对象执行解释的字节码 - 这严重减慢了速度。如果没有`object_hook`，解码整个 400 MB 文件只需大约 20 秒。但是有了钩子，需要半个多小时！

因此，在这一点上，我想到了 2 个选项，这两个选项都不是很令人愉快。一种是忘记使用“点”成员数据访问的便利性，而只使用 Python 字典。（这意味着要更改大量代码。）另一个是编写一个 C 扩展模块并将其用作`object_hook`，看看我们是否得到任何加速。

我想知道是否有一些我没有想到的更好的解决方案——也许是一种更简单的方法来获得“点”成员访问权限，同时仍然最初解码为 Python 字典。

有什么建议，解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:44:42.277

您可以尝试不使用 object_hook，而是让 json 返回一个字典，然后将该字典转储到一个命名元组中。

像这样的东西：

```
from collections import namedtuple
result = json.parse(data)
JsonData = namedtuple("JsonData", result.keys())
jsondata = JsonData(**result) 
```

我不知道那会是什么速度，但值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:41:10.110

使用本机 JSON 模块返回的 dict 并用提供点访问的对象包装它怎么样？

您可以执行以下操作：

```
class DictWrap(object):

def __init__(self, d):
    self.__d = d

def __getattr__(self, attr):
    try:
        return self.__d[attr]
    except KeyError:
        raise AttributeError

dw = DictWrap({"a": "foo", "b": "bar"})

print dw.a, dw.b // foo bar
print dw.c // AttributeError 
```

**编辑：**刚刚看到 Lennart Regebro 的答案，我会去的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T01:04:27.787

我取决于使用情况。

Lennart Regebro 解决方案非常适用于普通字典案例（这可能不适用于您的案例）。否则，您需要实现递归解决方案。但在这种情况下 - python 将为您的 json 中的每个字典创建一个类。

nemo 的解决方案更“懒惰”/“按需”，所以如果你不打算使用字典的每个字段，我会选择 nemo 的解决方案。但是为嵌套字典和数组修改它。

```
def __getattr__(self, attr):
  ...
  if isinstance(self.__d[attr], dict):
    return DictWrap(self.__d[attr])

  elif isinstance(self.__d[attr], list):
    return ListWrap(self.__d[attr])    # and create similar wrapper for List.
  ... 
```

普通字典的另一个解决方案是：

```
class JsonData(object):pass

data = JsonData()
data.__dict__.update(json.parse(data)) 
```

# ruby-on-rails - Rails 3\. 验证失败时保持表单中嵌套字段的数量

> ID：12411396
> 
> 赞同：1
> 
> 时间：2012-09-13T17:08:54.177
> 
> 标签：ruby-on-rails, ruby

我有一个表格，用于注册一个学生和 3 个紧急联系人。（emergency_contact 属于学生）。

所以，学生控制器...

```
def new
  @student = Student.new
   3.times {@student.emergency_contacts.build}
... 
```

假设用户填写了学生信息，并且只有一个紧急联系人。由于任何原因验证失败（可能没有输入学生姓名），**当重新显示表单时，输入第二个或第三个额外紧急联系人的字段消失了**。

当然，如果我`3.times {@member.caregivers.build}`在创建操作中也这样做，每次验证失败时我都会得到越来越多的附加字段。

***那么，即使在验证失败后，如何始终在表单中保留指定数量的嵌套模型？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:32:00.770

在您的创建操作中，您可以执行以下操作：

```
if @student.save
  ...
else
 (3 - @student.emergency_contacts.size).times { @student.emergency_contacts.build }
end 
```

希望能帮助到你。

# c++ - std::vector operator==: 值或参考比较？

> ID：12411399
> 
> 赞同：4
> 
> 时间：2012-09-13T17:09:08.280
> 
> 标签：c++, vector

因此，我试图在 codegolf 上的 C++ 中[何时为 x==x+2](https://codegolf.stackexchange.com/questions/7165/when-does-x-x2)提出一个解决方案，并提出这个片段只是为了意识到我不知道它是如何工作的。我不确定为什么这两个条件都评估为真。

有谁知道标记`line:`为真的行是因为 x==&x 还是因为 x+2 在 == 的左侧之前被评估？

```
#include <iostream>
#include <vector>

std::vector<int>& operator+ ( std::vector<int> &v, int val )
{
    v.push_back(val);
    return v;
}

int main()
{
    std::vector<int> x;
    std::vector<int> y = x + 2; // y is a copy of x, and x is [2]

    // how are both of these are true?
    std::cout << (x==y) << "\n";    // value comparison [2]==[2]
line:
    std::cout << (x==x+2) << "\n";  // reference comparison? &x == &(x+2)

    // not sure if this is relevant
    std::cout << (x+2==x) << "\n";  // also true

    return 0;
} 
```

似乎——因为向量似乎是按值比较的——如果 x 在 x+2 之前被评估，那么 x 将不等于 x+2（按值）。我可能遗漏了一些明显的东西。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:19:50.257

对于标准容器，`operator==`被重载为[`std::equal`](http://en.cppreference.com/w/cpp/algorithm/equal). 这反过来适用于迭代器并通过取消引用来应用比较，如`*it1 == *it2`. 因此，不需要副本。

表达式`x == x + 2`与 相同`operator==(x, x + 2)`。两个操作数都在函数调用之前进行评估，并且由于`x + 2`modifies `x`，两个操作数是相同的。因此等式成立。

`+`令人惊讶的是，您在重载 - 运算符时选择了非常规的设计选择。在任何协作项目中，这通常是不好的做法和禁忌。如果您绝对必须重载运算符，那么只有当它们按预期运行时，遵循已建立的语义并且不足为奇。-operator的通常行为`+`是按值返回一个新对象，并使操作数不受影响。像这样：

```
std::vector<int> operator+(std::vector<int> v, int n)
{
    v.push_back(n);
    return v;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T17:16:25.903

[std::vector 的相等比较](http://en.cppreference.com/w/cpp/container/vector/operator_cmp)执行字典比较，检查 和 的大小`lhs`是否`rhs`相同，然后逐个元素进行比较。

您的代码的问题是您分配`x+2`给`y`，并且您的加法运算符正在修改`lhs`, 充当`+=`运算符。

这里：

```
std::vector<int> y = x + 2; 
```

这会修改并从`x`复制分配。一个表现良好的人会像`y``x``operator+`

```
std::vector<int> operator+ ( std::vector<int> v, int val )
{
    v.push_back(val);
    return v;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T17:21:29.180

混淆源于 的非常规定义`+`。通常，它将返回其参数的修改副本，而参数本身保持不变。由于操作符的行为更像`+=`，修改其参数并返回对它的引用，这大致相当于：

```
x.push_back(2), x == x 
```

将修改后的向量与自身进行比较。

C++ 总是比较值，从不引用；如果要进行引用比较，则必须显式比较地址，`&x == &y`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T17:17:18.973

`std::vector::operator==()`是（通常？）一个函数，这是 C++03 中的一个序列点，这意味着它需要在调用它之前完全评估它的所有参数。

两个参数都解析为相同的参考（向量 x），因此很自然它会评估为真。

这是因为 operator+ 从不创建新对象，它只是修改一个对象。

事实上，它等价于以下代码：

```
std::vector<int> x;
x.push_back(2);
std::cout << (x==x) << "\n"; // this is no surprise 
```

# java - 使用java正则表达式

> ID：12411400
> 
> 赞同：0
> 
> 时间：2012-09-13T17:09:08.753
> 
> 标签：java, regex

我通过将所有空格替换为“_”来转换字符串，如果实际字符串中有“_”，我将其转换为“\_”。如果有一个像“this is test _string”这样的字符串，结果将是“this_is_test_\_string”，现在我想使用java regex来取回原始字符串“this is test _string”。是否可以使用 java regex 来实现？请帮帮我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:11:31.990

不，不可能取回原始字符串，因为您没有转义反斜杠，这使得它是否`"\\_"`来自`"_"`或不明确`"\\ "`。

如果你做了

1.  将所有出现的 替换`"\\"`为`"\\\\"`
2.  将所有出现的 替换`"_"`为`"\\_"`
3.  将所有出现的 替换`" "`为`"_"`

然后您可以通过在一次从左到右的传递中查找标记`"\\\\"`,来反转该过程。`"\\_"``"_"`

在 Java 中，第一个转换是

```
stringToEncode.replace("\\", "\\\\").replace("_", "\\_").replace(" ", "_") 
```

对偶是

```
String decode(String stringToDecode) {
  int n = stringToDecode.length();
  StringBuilder out = new StringBuilder(n);
  int decoded = 0;
  for (int i = 0; i < n; ++i) {
    switch (stringToDecode.charAt(i)) {
      case '\\':
        out.append(stringToDecode, decoded, i);
        decoded = ++i;
        break;
      case '_':
        out.append(stringToDecode, decoded, i).append(' ');
        decoded = i+1;
        break;
    }
  }
  return decoded != 0
      ? out.append(stringToDecode, decoded, n).toString()
      : stringToDecode;
} 
```

# postgresql - 从使用这些表中的值的表和函数中同时选择

> ID：12411406
> 
> 赞同：1
> 
> 时间：2012-09-13T17:09:35.043
> 
> 标签：postgresql, postgis

我有 3 张桌子：*闪电*、*电力线*、*桅杆*。

主要领域：

*   `lightnings.geo_belief`- 可能击中的椭圆。
*   `powerlines.geo_path`- 电力线路径的地理折线。
*   `masts.geo_coordinates`- 桅杆放置的地理点。

**任务**：

1.  计算击中电力线走廊的雷击（5000 米 - 其半径，并由函数生成为几何图形 `powerline_corridor()`）
2.  获取有关电力线桅杆的信息，最接近相应的闪电击中，并获取到的**距离**。`lightning.geo_ellipse``masts.geo_coordinates`

所以我可以选择闪电：

```
SELECT l.*
FROM lightnings l
JOIN ( SELECT geo_path, powerline_corridor(geo_path, 5000::smallint) AS geo_zone 
         FROM powerlines WHERE id=1)
   AS by_pl
   ON ST_Intersects(by_pl.geo_zone, l.geo_belief) 
```

我也有这个功能`namos_nearest_mast(powerlines.id, lightnings.geo_belief)`：

```
CREATE OR REPLACE FUNCTION public.namos_nearest_mast (
  powerline_id integer,
  geo public.geometry
)
RETURNS public.obj_powerline_masts AS
$body$
SELECT *
FROM obj_powerline_masts
WHERE powerline_id=$1
ORDER BY $2 <-> geo_coordinates ASC
LIMIT 1
$body$
LANGUAGE 'sql'; 
```

您不能提出好的选择解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:09:35.043

以下是我自己所做的一切：

```
SELECT 
    t.*,
    ROUND(st_distance(namos_transform_meters(m.geo_coordinates), namos_transform_meters(t.geo_belief))) AS dist_m
FROM obj_powerline_masts AS m
JOIN
  (
    SELECT 
    l.*,
    (SELECT id FROM nearest_mast(1, l.geo_belief)) AS mast_id
    FROM lightnings l
    JOIN (SELECT geo_path, powerline_corridor(geo_path, 5000::smallint) AS geo_zone FROM powerlines WHERE id=1) AS by_pl ON ST_Intersects(by_pl.geo_zone, l.geo_belief)
    LIMIT 50 OFFSET 50
  ) AS t
  ON t.mast_id=m.id 
```

但我不确定这是否是最佳解决方案。例如，在 PHP 中，我不能将 dataProviders 应用于此类查询（抽象例如使用分页），因为我们无法以微不足道的方式影响子查询。

# ios - 将二进制字符串附加到 NSMutableData

> ID：12411408
> 
> 赞同：0
> 
> 时间：2012-09-13T17:09:38.443
> 
> 标签：ios, nsmutabledata

我将如何去附加这个二进制字符串

**111000111000111111000111000111**

到`NSMutableData`包含`png` ( `NSMutableData *dataForPNGFile = UIImagePNGRepresentation(p.Image);`)的对象

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:27:49.367

您需要将字符串解析为`NSData`，然后附加它。

我不知道任何内置的东西，所以例如

```
NSMutableData *data = [NSMutableData dataWithLength(string.length+7)/8];
uint8_t *mutableBytes = (uint8_t *)data.mutableBytes;

for(NSUinteger index = 0; index < string.length; index++)
{
    unichar character = [string characterAtIndex:index];
    mutableBytes[index >> 3] <<= 1;
    if(character == '1') mutableBytes[index >> 3] |= 1;
}

if(string.length&7)
    mutableBytes[string.length >> 3] <<= (7 - (string.length&7)); 
```

因此假设您的源字符串只有 1 和 0，它是从最高有效位到最低有效位写入的，并且它是字节而不是面向字的。

此外，`UIImagePNGRepresentation`返回不可变数据，因此您需要获取该数据的可变副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:28:36.513

查看 NSMuteableData 方法 appendBytes:length：

正如@Tommy 所说，您必须将您的位转换为字节。

# php - url_to_absolute 查询

> ID：12411413
> 
> 赞同：0
> 
> 时间：2012-09-13T17:10:03.217
> 
> 标签：php

是的，我正在构建一个网络爬虫，我的代码中有一部分转换为绝对 URL，而不是 /macbookpro/ 到[http://www.apple.com/macbookpro](http://www.apple.com/macbookpro)。但是当我回显我的代码时，它只打印一个结果，这是它看到原因的第一个链接。我是否必须创建一个数组，因为当我这样做时，我回显了数组并列出了“数组”这个词

```
 <?php
require_once('simplehtmldom_1_5/simple_html_dom.php');
require_once('url_to_absolute/url_to_absolute.php');

          $URL = 'http://www.theqlick.com'; // change it for urls to grab  
// grabs the urls from URL 
          $file  = file_get_html($URL);
           foreach ($file->find('a') as $theelement) {
          $links = url_to_absolute($URL, $theelement->href);
        } 
  echo $links;
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:13:18.857

如果您正在尝试构建一个数组，`$links`您需要做

```
$links[] = url_to_absolute($URL, $theelement->href); 
```

现在，您正在`$links`用每个循环迭代覆盖 的值。

您还应该`$links = array();`在 foreach 循环之前的某处贴花。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:14:41.327

```
<?php
require_once('simplehtmldom_1_5/simple_html_dom.php');
require_once('url_to_absolute/url_to_absolute.php');

$links = Array();
$URL = 'http://www.theqlick.com'; // change it for urls to grab  
// grabs the urls from URL 
$file  = file_get_html($URL);
foreach ($file->find('a') as $theelement) {
   $links[] = url_to_absolute($URL, $theelement->href);
} 
print_r($links); 
```

所以你需要初始化数组，用 [] 添加它，最后使用适合实际打印出来的东西，比如 print_r。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:12:18.793

var_dump 您的数组，它为您提供对象的文本表示。它将向您显示数组及其元素。Echo 更多的是用于输出字符串。您可以循环您的数组并回显每个元素，但如果您只想查看它，var_dump 就是答案。

[http://www.php.net/manual/en/function.var-dump.php](http://www.php.net/manual/en/function.var-dump.php)

# android - How to specify path of AndroidManifest.xml file in ant target?

> ID：12411419
> 
> 赞同：3
> 
> 时间：2012-09-13T17:10:22.303
> 
> 标签：android, ant

I have created build.xml in build folder. I want to create .apk file using build script. I have used the required code from build.xml file stored under /android-sdks/tools/ant folder.

Now when I run debug target; I am getting "The system cannot find the file specified" error for target; since now it cannot find AndroidManifest.xml file under /build folder.

Can anybody tell me where can I specify path of AndroidManifest.xml for android specific ant targets?

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-26T15:41:09.240

恐怕你不能，至少（仍然）还不能。

`gettype.java`（参见例如[here](https://android.googlesource.com/platform/sdk/+/1ad2af8eb043d1b6c600a9487ae5130e567104d7/anttasks/src/com/android/ant/GetTypeTask.java)）不检查`manifest.file` *属性*，而只是一个内部*常量*：

```
 File manifest = new File(antProject.getBaseDir(), SdkConstants.FN_ANDROID_MANIFEST_XML); 
```

（另见[这篇关于使用同一代码库的多个变体的博客条目](http://blog.uncommons.org/2010/07/19/building-two-versions-of-the-same-android-app/)，他的清单文件也有同样的问题，需要复制它们来克服它。）

# c++ - C++ 应用程序中的控制台

> ID：12411420
> 
> 赞同：1
> 
> 时间：2012-09-13T17:10:24.127
> 
> 标签：c++

我想在我的 C++ 应用程序中实现一个控制台。以 ftp 为例。或者 (IIRC) sql，一旦你连接到服务器。

有人知道实现这个的库吗？理想情况下自动完成等？我对此的搜索只提出了“如何构建 C++ 控制台应用程序”，我确实知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:17:45.920

[GNU Readline](http://www.gnu.org/software/readline/)实现了您想要的功能。如果文件名自动完成不是您需要的排序，请使用[自定义自动完成](http://cc.byexamples.com/2008/06/16/gnu-readline-implement-custom-auto-complete/)例程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:09:38.757

对于 Windows：`AllocConsole()`用于将文本控制台附加到您的 GUI 应用程序以及`freopen( "CON", "w", stdout ) ;`重定向和`printf()`输出文本。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944(v=vs.85).aspx)

示例代码：

```
#include <stdio.h>
#include <stdlib.h>

// Function prototypes.
LRESULT CALLBACK WndProc( HWND hwnd, UINT message, WPARAM wparam, LPARAM lparam );
int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR szCmdLine, int iCmdShow );

// In a C++ Windows app, the starting point is WinMain().
int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR szCmdLine, int iCmdShow )          
{

  // these next few lines create and attach a console
  // to this process.  note that each process is only allowed one console.
  AllocConsole() ;

  freopen( "CON", "w", stdout ) ;

  printf("HELLO!!! I AM THE CONSOLE!\n" ) ;

  WNDCLASSEX wc = { 0 };
  wc.cbSize = sizeof( WNDCLASSEX ) ;
  wc.cbClsExtra = 0;  // ignore for now
  wc.cbWndExtra = 0;  // ignore for now
  wc.hbrBackground = (HBRUSH)GetStockObject( WHITE_BRUSH );
  wc.hCursor = LoadCursor( NULL, IDC_ARROW ); 
  wc.hIcon = LoadIcon( NULL, IDI_APPLICATION );
  wc.hInstance = hInstance;
  wc.lpfnWndProc = WndProc;
  wc.lpszClassName = TEXT(" ");
  wc.lpszMenuName = 0;
  wc.style = CS_HREDRAW | CS_VREDRAW; // Redraw the window

  RegisterClassEx( &wc );

  HWND hwnd = CreateWindowEx( 0, TEXT(" "), TEXT("window's title!"), WS_OVERLAPPEDWINDOW, 10, 10, 200, 200, NULL, NULL, hInstance, NULL );      

  ShowWindow(hwnd, iCmdShow );
  UpdateWindow(hwnd);

  MSG msg;

  while( GetMessage( &msg, NULL, 0, 0 ) )
  {
    TranslateMessage( &msg );
    DispatchMessage( &msg );
  }

  return msg.wParam;    // return from WinMain
}

LRESULT CALLBACK WndProc( HWND hwnd, UINT message, WPARAM wparam, LPARAM lparam )
{
  switch( message )
  {
  case WM_CREATE:
    // upon creation, let the speaker beep at 50Hz, for 10ms.
    Beep( 50, 10 );
    printf("HELLO!!! I AM THE CONSOLE!\n" ) ;
    return 0;
    break;

  case WM_PAINT:
    {
      // we would place our Windows painting code here.
      HDC hdc;
      PAINTSTRUCT ps;
      hdc = BeginPaint( hwnd, &ps );

      // draw a circle and a 2 squares
      Ellipse( hdc, 20, 20, 160, 160 );
      Rectangle( hdc, 50, 50, 90, 90 );
      Rectangle( hdc, 100, 50, 140, 90 );
      printf("HELLO!!! I AM THE CONSOLE!\n" ) ;

      EndPaint( hwnd, &ps );
    }
    return 0;
    break;

  case WM_LBUTTONDOWN:
    printf("STOP POKING MEEE!!!\n") ;
    break;

  case WM_DESTROY:
    PostQuitMessage( 0 ) ;
    return 0;
    break;

  }

  return DefWindowProc( hwnd, message, wparam, lparam );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:18:18.520

如果您还想自动完成，您可以查看[linenoise](https://github.com/antirez/linenoise)的示例（一种轻量级的 readline 替代方案）。

基本上你必须在一个循环中解析用户输入行。

一个非常基本的 CommadLineInterface 示例：

1.  在 while 循环中显示提示并读取输入，
2.  `parseLine()`打电话给类似的东西`\n`
3.  将 Line in Tokens 至少拆分`Space`（然后`;`）将第一个 String 作为 Command `cmd`，其余作为`args`.
4.  称呼`dispatch(cmd, args);`

# knockout.js - 将“with”绑定与命名模板一起使用时遇到问题

> ID：12411423
> 
> 赞同：0
> 
> 时间：2012-09-13T17:10:50.730
> 
> 标签：knockout.js

我是新来的淘汰赛。我有一个带有交易列表的视图模型。我在页面左侧显示了其中的几个字段。当用户将鼠标悬停在其中一个上时，我想在页面右侧显示 tade 的详细信息。我的视图模型看起来像这样

```
 var self = this;
    self.selectedTrade = ko.observable(null);
    self.trades = ko.observableArray();
    self.selectTrade = function (item) {
        self.selectedTrade(item);
    } 
```

当用户将鼠标悬停在左侧的某个项目上时，它会调用 selecttrade，因此 selectedTrade 有一个值。我有一个绑定到 selectedTrade 的右侧的 div。

```
<ul data-bind="template: {name: 'tradelist', foreach: trades}" />
<script id='tradelist' type="text/html">
 <li> <span data-bind="text: Cname, event: { mouseover: $root.selectTrade } "/>&nbsp <span data-bind="text: Cparty"/></li>
</script>
</div>
<div data-bind="template: {with: selectedTrade(), name: 'displayTradeTemplate' }" />

<script id='displayTradeTemplate' type="text/html">

  <table>
            <tr>
                <td>
                    Contract Name:
                </td>
                <td>
                    <span data-bind="text: Cname">
                    </span>
                </td>
            </tr>
</table> 
```

当我加载页面 javascript compains 时：Microsoft JScript 运行时错误：无法解析绑定。消息：语法错误：预期的标识符、字符串或数字；绑定值：模板：{with: selectedTrade(), name: 'displayTradeTemplate' }

任何人都知道该绑定有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:30:57.787

在该模板绑定中使用`data:`而不是`with:`

# android - Android 将设备坐标系转换为“用户”坐标系

> ID：12411430
> 
> 赞同：5
> 
> 时间：2012-09-13T17:11:28.147
> 
> 标签：android, orientation, sensors, android-sensors, rotational-matrices

我的问题类似于[在 android 中更改传感器坐标系](https://stackoverflow.com/questions/10762133/changing-sensor-coordinate-system-in-android)

无论设备方向如何，我都希望能够相互比较用户的动作。因此，当用户以纵向方向伸出手机并弯曲手臂时，加速度读数与他横向伸出手机然后向同一方向弯曲手臂时的加速度读数相同。

这就是我所说的“用户”坐标系。它与世界坐标系不同，因为用户面对的风向无关紧要。它与设备坐标不同，因为用户如何握住他的设备并不重要。

在我的应用程序中，可以在每次移动之前执行校准步骤，以便确定基础/静止方向矩阵。是否可能只是将第一个运动的矩阵乘以第二个运动的逆矩阵（然后再乘以新值？）

提到的问题中的答案似乎是正确的，但我需要更具体的解释，实际的代码示例将是理想的。

注意 remapCoordinateSystem 是不够的，它只接受直角。我需要能够以小的偏差工作，因为该设备被绑在手腕上，这可能并不总是与手臂成直角。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-24T06:58:32.093

I'm currently working on this issue, and I think this might help: [convert device coordinate system to world corrdinate system](https://stackoverflow.com/questions/11578636/acceleration-from-devices-coordinate-system-into-absolute-coordinate-system)

We can assume that for the most of the time, people use the phone standing or walking or sitting, which means the user coordinate system share the same z-axis(gravity)， and a fixed difference in degree between y-axis (user coordinate, front of user's face) and y-axis(world coordinate, north direction). The difference of degree can be obtained via [TYPE_MAGNETIC_FIELD sensor](http://developer.android.com/reference/android/hardware/Sensor.html#TYPE_MAGNETIC_FIELD). Thus we can transform from world coordinate to user coordinate.

What's about the user using the phone lying on the bed? I think for that kind of case, a pre-calibration is need by define y-axis of user coordinate, like a movement to tell the phone which direction is the front of user's face.

# python - 如果一个失败了，如何跳过课堂上的其余测试？

> ID：12411431
> 
> 赞同：32
> 
> 时间：2012-09-13T17:11:28.903
> 
> 标签：python, automated-tests, selenium-webdriver, pytest

我正在使用 Jenkins、Python、Selenium2(webdriver) 和 Py.test 框架为 Web 测试创建测试用例。

到目前为止，我正在按以下结构组织我的测试：

每个**类**都是**测试用例**，每个**`test_`方法**都是一个**测试步骤**。

当一切正常时，此设置工作得很好，但是当一个步骤崩溃时，其余的“测试步骤”就会发疯。在 的帮助下，我能够将失败包含在类（测试用例）中`teardown_class()`，但是我正在研究如何改进它。

如果其中一个方法失败，我需要以某种方式跳过（或 xfail）`test_`一个类中的其余方法，以便其余测试用例不会运行并标记为 FAILED（因为那将是误报）

谢谢！

**更新：**我没有寻找或回答“这是不好的做法”，因为这样称呼它是非常有争议的。（每个测试类都是独立的——这就足够了）。

**更新 2：**在每种测试方法中添加“if”条件不是一种选择 - 需要大量重复工作。我正在寻找的是（也许）有人知道如何使用类方法的[钩子。](http://pytest.org/latest/plugins.html#py-test-hook-reference)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-25T09:06:56.970

我喜欢一般的“测试步骤”想法。我将其称为“增量”测试，它在功能测试场景恕我直言中最有意义。

这是一个不依赖于 pytest 内部细节的实现（官方钩子扩展除外）。将此复制到您的`conftest.py`：

```
import pytest

def pytest_runtest_makereport(item, call):
    if "incremental" in item.keywords:
        if call.excinfo is not None:
            parent = item.parent
            parent._previousfailed = item

def pytest_runtest_setup(item):
    previousfailed = getattr(item.parent, "_previousfailed", None)
    if previousfailed is not None:
        pytest.xfail("previous test failed (%s)" % previousfailed.name) 
```

如果你现在有一个像这样的“test_step.py”：

```
import pytest

@pytest.mark.incremental
class TestUserHandling:
    def test_login(self):
        pass
    def test_modification(self):
        assert 0
    def test_deletion(self):
        pass 
```

然后运行它看起来像这样（使用 -rx 报告 xfail 原因）：

```
(1)hpk@t2:~/p/pytest/doc/en/example/teststep$ py.test -rx
============================= test session starts ==============================
platform linux2 -- Python 2.7.3 -- pytest-2.3.0.dev17
plugins: xdist, bugzilla, cache, oejskit, cli, pep8, cov, timeout
collected 3 items

test_step.py .Fx

=================================== FAILURES ===================================
______________________ TestUserHandling.test_modification ______________________

self = <test_step.TestUserHandling instance at 0x1e0d9e0>

    def test_modification(self):
>       assert 0
E       assert 0

test_step.py:8: AssertionError
=========================== short test summary info ============================
XFAIL test_step.py::TestUserHandling::()::test_deletion
  reason: previous test failed (test_modification)
================ 1 failed, 1 passed, 1 xfailed in 0.02 seconds ================= 
```

我在这里使用“xfail”，因为跳过是针对错误的环境或缺少依赖项、错误的解释器版本。

编辑：请注意，您的示例和我的示例都不能直接用于分布式测试。为此，pytest-xdist 插件需要开发一种方法来定义组/类，以将其整体发送到一个测试从属设备，而不是当前模式，后者通常将一个类的测试功能发送到不同的从属设备。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-06-19T14:24:22.143

*   如果您想在任何地方（不是在特定测试类中）**发生 N 次失败后停止测试执行，**`pytest --maxfail=N`那么命令行选项是可行的方法： [https ://docs.pytest.org/en/latest/usage.html#在第一次或第一次失败后停止](https://docs.pytest.org/en/latest/usage.html#stopping-after-the-first-or-n-failures)

*   如果您想**停止由多个步骤组成的测试，如果其中任何一个失败**，（并继续执行其他测试），您应该将所有步骤放在一个类中，并在该类上使用`@pytest.mark.incremental`装饰器并编辑您的 conftest。 py 以包含此处显示的代码 [https://docs.pytest.org/en/latest/example/simple.html#incremental-testing-test-steps](https://docs.pytest.org/en/latest/example/simple.html#incremental-testing-test-steps)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-08-09T09:50:23.307

该`pytest -x`选项将在第一次失败后停止测试： `pytest -vs -x test_sample.py`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-13T17:20:43.687

做你正在做的事情通常是不好的做法。每个测试都应尽可能独立于其他测试，而您完全依赖于其他测试的结果。

无论如何，阅读[文档](http://pytest.org/latest/skipping.html)似乎没有实现您想要的功能。（可能是因为它没有被认为有用）。

解决方法可能是调用自定义方法“失败”您的测试，该方法在类上设置一些条件，并使用“skipIf”装饰器标记每个测试：

```
class MyTestCase(unittest.TestCase):
    skip_all = False

   @pytest.mark.skipIf("MyTestCase.skip_all")
   def test_A(self):
        ...
        if failed:
            MyTestCase.skip_all = True
  @pytest.mark.skipIf("MyTestCase.skip_all")
  def test_B(self):
      ...
      if failed:
          MyTestCase.skip_all = True 
```

或者您可以在运行每个测试并最终调用`pytest.skip()`.

编辑：标记为`xfail`可以以相同的方式完成，但使用相应的函数调用。

可能，您可以编写一个装饰器，而不是为每个测试重写样板代码（这可能需要您的方法返回一个“标志”，说明它们是否失败）。

无论如何，我想指出，正如您所说，如果其中一个测试失败，那么同一测试用例中的其他失败测试应被视为误报......但您可以“手动”执行此操作。只需检查输出并发现误报。即使这可能很无聊。/容易出错。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-20T08:21:54.600

您可能想看看[pytest-dependency](https://github.com/RKrahl/pytest-dependency)。这是一个插件，如果其他一些测试失败，它允许您跳过一些测试。就您而言，gbonetti 讨论的增量测试似乎更相关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-11-01T21:14:34.013

根据[hpk42 的回答](https://stackoverflow.com/a/12579625/1222951)，这是我稍作修改的`incremental`标记，如果先前的测试*失败*（但如果它*xfailed*或它被*跳过*，则不会使测试用例 xfail ）。此代码必须添加到`conftest.py`：

```
import pytest

try:
    pytest.skip()
except BaseException as e:
    Skipped = type(e)

try:
    pytest.xfail()
except BaseException as e:
    XFailed = type(e)

def pytest_runtest_makereport(item, call):
    if "incremental" in item.keywords:
        if call.excinfo is not None:
            if call.excinfo.type in {Skipped, XFailed}:
                return

            parent = item.parent
            parent._previousfailed = item

def pytest_runtest_setup(item):
    previousfailed = getattr(item.parent, "_previousfailed", None)
    if previousfailed is not None:
        pytest.xfail("previous test failed (%s)" % previousfailed.name) 
```

然后必须将一组测试用例标记为`@pytest.mark.incremental`：

```
import pytest

@pytest.mark.incremental
class TestWhatever:
    def test_a(self):  # this will pass
        pass

    def test_b(self):  # this will be skipped
        pytest.skip()

    def test_c(self):  # this will fail
        assert False

    def test_d(self):  # this will xfail because test_c failed
        pass

    def test_e(self):  # this will xfail because test_c failed
        pass 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-24T18:41:01.080

**更新：**请查看@hpk42 答案。他的回答不那么突兀。

这就是我真正想要的：

```
from _pytest.runner import runtestprotocol
import pytest
from _pytest.mark import MarkInfo

def check_call_report(item, nextitem):
    """
    if test method fails then mark the rest of the test methods as 'skip'
    also if any of the methods is marked as 'pytest.mark.blocker' then
    interrupt further testing
    """
    reports = runtestprotocol(item, nextitem=nextitem)
    for report in reports:
        if report.when == "call":
            if report.outcome == "failed":
                for test_method in item.parent._collected[item.parent._collected.index(item):]:
                    test_method._request.applymarker(pytest.mark.skipif("True"))
                    if test_method.keywords.has_key('blocker') and isinstance(test_method.keywords.get('blocker'), MarkInfo):
                        item.session.shouldstop = "blocker issue has failed or was marked for skipping"
            break

def pytest_runtest_protocol(item, nextitem):
# add to the hook
    item.ihook.pytest_runtest_logstart(
        nodeid=item.nodeid, location=item.location,
    )
    check_call_report(item, nextitem)
    return True 
```

现在将它添加到`conftest.py`或作为**插件**解决了我的问题。
如果`blocker`测试失败，它也改进为停止测试。（意味着整个进一步的测试都是无用的）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-26T00:28:23.437

或者很简单，而不是从 cmd （或 tox 或任何地方）调用 py.test ，只需调用：

```
py.test --maxfail=1 
```

有关更多开关，请参见此处： [https ://pytest.org/latest/usage.html](https://pytest.org/latest/usage.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-27T16:03:23.637

为了补充[hpk42 的答案](https://stackoverflow.com/a/12579625/7262247)，您还可以使用[pytest-steps](https://smarie.github.io/python-pytest-steps/)执行增量测试，如果您希望在步骤之间共享某种增量状态/中间结果，这尤其可以帮助您。

使用这个包，您不需要将所有步骤放在一个类中（您可以，但不是必需的），只需用以下方式装饰您的“测试套件”功能`@test_steps`：

```
from pytest_steps import test_steps

def step_a():
    # perform this step ...
    print("step a")
    assert not False  # replace with your logic

def step_b():
    # perform this step
    print("step b")
    assert not False  # replace with your logic

@test_steps(step_a, step_b)
def test_suite_no_shared_results(test_step):
    # Execute the step
    test_step() 
```

`steps_data`如果您希望`StepsDataHolder`在您的步骤之间共享一个对象，您可以向您的测试函数添加一个参数。

```
import pytest
from pytest_steps import test_steps, StepsDataHolder

def step_a(steps_data):
    # perform this step ...
    print("step a")
    assert not False  # replace with your logic

    # intermediate results can be stored in steps_data
    steps_data.intermediate_a = 'some intermediate result created in step a'

def step_b(steps_data):
    # perform this step, leveraging the previous step's results
    print("step b")

    # you can leverage the results from previous steps... 
    # ... or pytest.skip if not relevant
    if len(steps_data.intermediate_a) < 5:
        pytest.skip("Step b should only be executed if the text is long enough")

    new_text = steps_data.intermediate_a + " ... augmented"  
    print(new_text)
    assert len(new_text) == 56

@test_steps(step_a, step_b)
def test_suite_with_shared_results(test_step, steps_data: StepsDataHolder):

    # Execute the step with access to the steps_data holder
    test_step(steps_data) 
```

最后，如果另一个使用失败，您可以自动跳过或失败一个步骤`@depends_on`，请查看[文档](https://smarie.github.io/python-pytest-steps/)以获取详细信息。

（顺便说一句，我是这个包的作者；））

# jsf - JSF 中的支持 bean 组织

> ID：12411434
> 
> 赞同：4
> 
> 时间：2012-09-13T17:11:51.213
> 
> 标签：jsf, architecture, jsf-1.2, managed-bean, backing-beans

我一直在考虑这个问题，但还没有提出如何在 JSF 项目中为表示层组织我的 bean/类的最佳实践。显然有很多因素在起作用，但我想讨论一下。以下是我目前的思路：

考虑一个包含视图页面（查看数据）和编辑页面（添加、更新、删除数据）的基本 JSF（不幸的是，仍然停留在 JSF 1.xx 上）。这是我组织项目的方式：

请求范围内的 BackingBean：

*   查看相关内容（保存状态、渲染逻辑等）。仅在一个请求中需要的东西
*   动作、动作侦听器和值更改侦听器。如果它们适用于多个视图，则可以将它们分离到自己的文件中。

会话范围的 BackingBean：

*   任何需要保留比一个请求更长的东西。数据库数据、SelectItems 等。
*   此 bean 被注入到请求 bean 中，并存储任何数据对象的实例

数据对象：

*   把数据对象做成bean似乎没有意义，所以分开存放。这将是诸如用户、书籍、汽车之类的东西，您将在页面上显示的任何对象。该对象还可以包含视图辅助方法，例如 getFormattedName() 等。

道：

*   处理与业务逻辑层的所有交互的非 bean 对象。它加载数据bean并准备提交等。我通常将其设为公共静态方法类。

转换器、验证器：

*   单独的文件

这似乎是您的普通 JSF 应用程序所需的全部内容。我已经阅读了这个： http: [//java.dzone.com/articles/making-distinctions-between](http://java.dzone.com/articles/making-distinctions-between)，以及这里的回复：[JSF backing bean structure (best practice)](https://stackoverflow.com/questions/746047/jsf-backing-bean-structure-best-practices)，但我从来没有觉得我们有一个完整的画面。BalusC 的回复很有帮助，但似乎并没有完全涵盖完整的应用程序。让我知道你的想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:25:06.543

我认为您通常走在正确的轨道上，但是我会做一些不同的事情：

1.  我会将您的 DAO 层拆分为两个单独的层，一个纯 DAO 层仅负责从各种来源（例如数据库调用、Web 服务调用、文件读取等）获取数据。然后，我将拥有一个业务逻辑层，其中包含对 DAO 调用的传递以及任何其他计算、算法或其他不特定于任何 JSF 视图的通用业务逻辑。

2.  在 MVC 模式中，您的 ManagedBean 扮演控制器的角色，因此也应该是表示逻辑（特定于操作视图或各种视图组件之间交互的逻辑）的存储库。它还将您的业务逻辑与事件行为联系起来。

3.  我不会为您的业务逻辑或 DAO 层使用公共静态方法。这不适合自动化单元测试，并且会阻止您的应用程序使用 CDI 或 Spring 等依赖注入框架。而是为您的 BO 和 DAO 创建一个接口，然后为此创建一个实现类。

4.  关于这一点，请使用 CDI 或 Spring 之类的依赖注入框架 :) 它将允许您自动将业务逻辑对象或 DAO 注入到您的 ManagedBeans 以及您的单元测试中。它还允许您交换实现或 DAO，而无需与应用程序的其他层中的代码进行任何耦合。

# ruby - ruby 中的多线程计算

> ID：12411435
> 
> 赞同：-2
> 
> 时间：2012-09-13T17:11:52.287
> 
> 标签：ruby, multithreading

我想创建一个脚本来计算多个线程中的数字。每个线程将计算 2 的幂，但第一个线程必须从 2 开始计算，第二个线程从 4 开始计算，第三个线程从 8 开始计算，在中间打印一些文本。

例子：

```
Im a thread and these are my results
2
4
8
Im a thread and these are my results
4
8
16
Im a thread and these are my results
8
16
32 
```

我的失败代码：

```
def loopa(s)
    3.times do
        puts s
        s=s**2
    end
end
threads=[]
num=2
until num == 8 do
    threads << Thread.new{ loopa(num) }
    num=num**2
end
threads.each { |x| puts "Im a thread and these are my results" ; x.join } 
```

我的失败结果：

```
Im a thread and these are my results
8
64
4096
8
64
4096
8
64
4096
Im a thread and these are my results
Im a thread and these are my results 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:50:25.397

我建议您阅读Pragmatic Programmer 的 ruby​​ 书的**“线程和进程”一章。**这是网上的[旧版本。](http://www.ruby-doc.org/docs/ProgrammingRuby/)名为“**创建 Ruby 线程**”的部分与您的问题特别相关。

要解决此问题，您需要将`Thread.new`行更改为：

```
threads << Thread.new(num){|n| loopa(n) } 
```

您的版本不起作用，因为`num`在线程之间共享，并且可能被另一个线程更改。通过块传递变量，块变量不再被共享。

**更多信息**

另外，你的数学有错误。输出值将是：

```
Thread 1: 2 4 16
Thread 2: 4 16 256
Thread 3: 6 36 1296 
```

永远不会达到“8”，因为`until`条件一看到“8”就退出。

如果您想要更清晰的输出，请将其用作以下内容`loopa`：

```
3.times do
    print "#{Thread.current}: #{s}\n"
    s=s**2
end 
```

这使您可以区分 3 个线程。请注意，最好使用`print`带有换行符终止的字符串的命令而不是`puts`不使用换行符的命令，因为后者将换行符作为单独的指令打印，这可能会被另一个线程中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:22:52.833

我觉得有必要发布一个数学上正确的版本：

```
def loopa(s)
  3.times do
      print "#{Thread.current}: #{s}\n"
      s *= 2
  end
end

threads=[]
num=2
while num <= 8 do
    threads << Thread.new(num){|n| loopa(n) }
    num *= 2
end

threads.each { |x| print "Im a thread and these are my results\n" ; x.join } 
```

**奖励 1：无线程解决方案（幼稚）**

```
power = 1
workers = 3
iterations = 3

(power ... power + workers).each do |pow|
  worker_pow = 2 ** pow
  puts "I'm a worker and these are my results"
  iterations.times do |inum|
    puts worker_pow
    worker_pow *= 2
  end
end 
```

**奖励 2：无线程解决方案（缓存）**

```
power = 1
workers = 3
iterations = 3

cache_size = workers + iterations - 1
# generate all the values upfront
cache = []
(power ... power+cache_size).each do |i|
  cache << 2**i
end

workers.times do |wnum|
  puts "I'm a worker and these are my results"
  # use a sliding-window to grab the part of the cache we want
  puts cache[wnum,3]
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:53:04.523

这是正常的。读你写的。首先，您运行 3 个异步线程，因此输出将采用各种线程输出组合。然后你写“我是一个线程，这些是我的结果”并加入每个线程。还要记住，Ruby 只有引用。因此，如果您传递`num`给线程然后更改它，它将在所有线程中更改。为了避免它写：

```
threads = (1..3).map do |i|
  puts "I'm starting thread no #{i}"
  Thread.new { loopa(2**i) }
end 
```

# ruby-on-rails - 如何转换长日期？

> ID：12411437
> 
> 赞同：2
> 
> 时间：2012-09-13T17:12:15.297
> 
> 标签：ruby-on-rails, ruby, date, datetime

我在 Rails 中有一个 long 值`134740800`，即自纪元以来的毫秒数。

如何将其转换为`mm-dd-yyyy`格式的日期？

我认为格式化将通过类似的方式完成，`strftime`但我似乎找不到将 long 转换为有效日期的正确方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:18:04.610

```
secs = 134740800/1000 # millisecs / 1000
t = Time.at(secs)
t.strftime("%m-%d-%Y") 
```

输出

```
"01-02-1970" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:14:23.843

试试这个：

```
require 'date'
DateTime.strptime("1318996912",'%s') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T17:15:19.863

我假设您的意思是自纪元以来的秒数。

```
Time.at seconds_since_epoch 
```

你也可以传递一个浮点数。如果您有毫秒，请先除以`1000.0`。然后，您可以调用`strftime`返回的`Time`对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T17:14:45.947

使用`Time.at`：

```
irb(main):003:0> Time.at(134740800)
=> Tue Apr 09 08:00:00 -0400 1974 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T18:08:41.783

这是一个建议……看看一些答案的运行速度通常是个好主意。这是一个简单的基准：

```
require 'benchmark'
require 'date'

SECS = 134740800
LOOPS = 1_000_000

puts Time.at(SECS).strftime('%m-%d-%Y')
puts Date.strptime(SECS.to_s, '%s').strftime('%m-%d-%Y')

Benchmark.bm(14) do |x|
  x.report('Time.at:') { LOOPS.times { Time.at(SECS) }}
  x.report('Date.strptime:') { LOOPS.times { Date.strptime(SECS.to_s, '%s') }}
end 
```

输出是：

```
04-09-1974
04-09-1974
                     user     system      total        real
Time.at:         0.370000   0.020000   0.390000 (  0.392761)
Date.strptime:   6.320000   0.050000   6.370000 (  6.373248) 
```

# objective-c - 保持从 xib 加载的自定义单元格内的按钮状态

> ID：12411446
> 
> 赞同：0
> 
> 时间：2012-09-13T17:12:57.623
> 
> 标签：objective-c, ios, uitableview

我有一个表格视图，其中包含从 xib 加载的自定义单元格，该单元格有一个按钮，当按下时更改它的图像我的问题是当我在视图之外上下滚动表格时，按钮重新加载它的默认图像

这是我的代码

对于表：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifer=@"LabelCell";
    TestTableCell *cell=[tableView dequeueReusableCellWithIdentifier:CellIdentifer];

   if (cell==nil) 
    {
       cell = [[TestTableCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifer];

        NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"TestTableCell" owner:nil options:nil];

        for (UIView *view in views) 
        {
            if([view isKindOfClass:[TestTableCell class]])
            {
                cell = (TestTableCell*)view;
            }
        }

    cell.selectionStyle=UITableViewCellSeparatorStyleNone;
    UIImage *cellbackground=[[UIImage imageNamed:@"cell-background.png"]resizableImageWithCapInsets:UIEdgeInsetsMake(5, 5, 5, 5)];
    cell.backgroundView=[[UIImageView alloc]initWithImage:cellbackground];

   }
    return  cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:15:41.970

您需要在数据模型中存储图像是否已被按下。UITableView 将在您滚动时将您的单元格重用于其他行，并且单元格内的所有内容都将被遗忘。

# graph - 查找无向、未加权图的顶点坐标

> ID：12411448
> 
> 赞同：1
> 
> 时间：2012-09-13T17:13:04.237
> 
> 标签：graph, coordinates, fractals, vertices, complex-networks

假设我有一个无向、未加权的图，带有“N”（比如说）个顶点。我试图找到图形顶点的坐标。

我似乎不明白，我们如何获得图形的坐标，而不提供任何功能。有没有我们采用的标准方法来获取图形的坐标？

我需要这些坐标，因为我想将它们用作 fd3 程序的输入参数（通过收集它们并放置在文件中并将该文件作为参数提供），以计算网络的分形维数（给定图形坐标）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:27:14.653

我会使用[集群生长方法](http://en.wikipedia.org/wiki/Fractal_dimension_on_networks#The_Cluster_Growing_Method)来获得系统的分形维数，而不是尝试使用盒子计数算法。当顶点与物理空间无关时，它更适合于任务。

# php - 使用 for(;;) 而不是 while() 循环的性能优势是什么？

> ID：12411454
> 
> 赞同：1
> 
> 时间：2012-09-13T17:13:23.087
> 
> 标签：php, for-loop

我正在浏览一个 php 包，发现了一行有趣的代码，我想对它有所了解。与其将表达式传递到 for 循环参数中，不如只写两个分号。

```
for (;;) {  // This is the line in question
  $this->output .= $this->a;
  $this->a       = $this->get();

  if ($this->a === $this->b) {
    break;
  }

  if (ord($this->a) <= self::ORD_LF) {
    throw new JSMinException('Unterminated string literal.');
  }

  if ($this->a === '\\') {
    $this->output .= $this->a;
    $this->a       = $this->get();
  }
} 
```

我知道 for 循环通常包含 3 个用分号分隔的表达式。所以这显然只是运行一个没有表达式的 for 循环，并依靠一个 break（第 6 行）来退出循环。

我想知道的是，**这种方法比传统方法有性能优势吗？** 在我看来，这可以很容易地重写为 while 循环，如下所示：

```
while($this->a !== $this->b){
  // Loop Contents
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:15:31.943

即使有，即使没有，我也不会为了轻微的性能提升而牺牲可读性。除非您的应用程序接近 Google 或 Facebook 的流量水平。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:20:58.073

根据 for、foreach 和 while 之间的基准测试结果，可以得出结论，在更多情况下具有更好的性能。看看这个链接。它可能会有所帮助：

[基准](http://www.phpbench.com/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-13T17:17:56.897

我认为这是一个非常糟糕的做法！我会像这样将你的 CPU 使用率提高到 100%。我认为一段时间更具可读性，您应该这样做。

总是像这样循环，该机器上的其他任务也有机会：

```
while($this->a !== $this->b){
  // Loop Contents
  sleep( $sometime );
} 
```

# sql - SQL 按 id 划分和分组

> ID：12411460
> 
> 赞同：0
> 
> 时间：2012-09-13T17:14:04.863
> 
> 标签：sql, sql-server, database, sql-server-2008

我在下面有以下查询。我正在尝试提取具有特定条件的记录数，然后除以按 cstmr_id 分组的记录总数。但是我遇到了一个错误。任何帮助，将不胜感激。此外，此语句是一个子查询，是更大的选择查询的一部分。我正在使用 SQL Server 2005

出现“'/' 附近的语法错误”错误

陈述：

```
((SELECT count(*) FROM cstmr WHERE active=1 AND cstmr_type LIKE '%dtr%' 
GROUP BY cstmr_id) 
/  --division sign here. dividing top query by bottom
(SELECT count(*) FROM cstmr WHERE cstmr_type LIKE '%dtr%'
GROUP BY cstmr_id) ) As cstmr_rate 
```

cstmr 表中的示例数据：

```
cstmr_id    cstmr_type    active
3423        dtr           1
1236        dtr           1
1842        dtr           1
8273        sys           2
9384        aod           1
3847        sys           2 
```

样本预期结果：

```
cstmr_id    cstmr_rate
3423        88.98
1236        25.21
1842        58.01 
```

基本伪代码

仅选择类型为“dtr”的活跃客户，然后除以客户总数。然后显示每个客户的这个派生比率。这是一个非常基本的方程，使用同一个表“cstr”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:16:16.167

```
;WITH x AS 
(
  SELECT cstmr_id, active, c = COUNT(*) 
   FROM dbo.cstmr WHERE cstmr_type LIKE '%dtr%'
   GROUP BY cstmr_id, active
), 
cr(cstmr_id, cstmr_rate) AS
(
  SELECT cstmr_id, 
   SUM(CASE active WHEN 1 THEN c ELSE 0 END)*1.0 / SUM(c) 
  FROM x GROUP BY cstmr_id
)
SELECT cr.cstmr_id, cr.cstmr_rate --, other columns
FROM cr
--INNER JOIN -- other tables from your larger query 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:21:14.833

看起来您缺少一个外部`SELECT`：

```
select -- You are missing this
(
    (SELECT cast(count(*) as decimal(10,2))
    FROM cstmr 
    WHERE active=1 AND cstmr_type LIKE '%dtr%' 
    GROUP BY cstmr_id) 
/  --division sign here. dividing top query by bottom
    (SELECT cast(count(*) as decimal(10,2))
    FROM cstmr 
    WHERE cstmr_type LIKE '%dtr%'
    GROUP BY cstmr_id) 
) As cstmr_rate 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:50:32.673

它可能不起作用，因为这两个查询返回的记录不止一条。SQL Server 不能将结果集除以结果集。

尝试使用连接来提取这些计数。

编辑

像这样的东西：

```
SELECT 
    c.cstmr_id,
    c1/c2 AS 'cstmr_rate'
FROM cstmr as c
JOIN (
    SELECT cstmr_id, count(*) AS 'c1'
    FROM cstmr 
    WHERE active=1 
    AND cstmr_type LIKE '%dtr%' 
    GROUP BY cstmr_id
    ) AS sub1 ON c.cstmr_id = sub1.cstmr_id
JOIN (
    SELECT cstmr_id, count(*) AS 'c2'
    FROM cstmr 
    WHERE cstmr_type LIKE '%dtr%'
    GROUP BY cstmr_id
    ) AS sub2 ON c.cstmr_id = sub2.cstmr_id 
```

编辑2

假设 active 为 1 或 0，这也可能有效：

```
SELECT
    cstmr_id,
    SUM(Active)/COUNT(*)  AS 'cstmr_rate'
FROM cstmr
GROUP BY cstmr_id 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T17:28:24.120

除了你的语法问题，还有更简单的方法来表达你想要的：

```
select count(distinct case when active = 1 then cstmr_id end)*1.0 / count(distinct cstmr_id)
from cstmr
where cstmr_type like '%dtr%' 
```

如果 cstmr_id 在 cstmr 表中没有重复，您可以进一步简化为：

```
select sum(case when active = 1 then 1.0 else 0.0 end) / count(*)
from cstmr
where cstmr_type like '%dtr%' 
```

甚至：

```
select avg(active*1.0)
from cstmr
where cstmr_type like '%dtr%' 
```

请注意，我还将整数转换为浮点数。正如您编写的那样，它产生的值不是 0 就是 1，因为 SQL Server 对整数进行整数运算。

# java - 获取 XML 节点的 localName

> ID：12411461
> 
> 赞同：0
> 
> 时间：2012-09-13T17:14:08.337
> 
> 标签：java, android, xml-parsing

我有一个看起来像的 xml

```
<Personnel>
  <Employee type="permanent">
        <Name>Seagull</Name>
        <Id>3674</Id>
        <Age>34</Age>
   </Employee>
  <Employee type="contract">
        <Name>Robin</Name>
        <Id>3675</Id>
        <Age>25</Age>
    </Employee>
  <Employee type="permanent">
        <Name>Crow</Name>
        <Id>3676</Id>
        <Age>28</Age>
    </Employee>
</Personnel> 
```

我正在尝试获取每个节点的名称，然后从那里获取值，但是当我执行以下操作时，我总是得到 null 或空字符串：

child.getLocalName().equals("永久")

它抛出异常，因为 child.getLocalName() 为 null 我在调试器中检查了孩子，我看到 localName = "permanent"

有谁熟悉这种奇怪的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:19:29.480

尝试可以尝试使用以下...

```
DOM Parser

SAX Parser

Pull Parser

JAXP AND JAXB

Castor 
```

**这是一段关于如何使用 DOM Parser 的代码......**

```
DocumentBuilderFactory odbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder odb =  odbf.newDocumentBuilder();
            InputSource is = new InputSource(new StringReader(xml));
            Document odoc = odb.parse(is);
            odoc.getDocumentElement().normalize ();    // normalize text representation
            System.out.println ("Root element of the doc is " + odoc.getDocumentElement().getNodeName());
            NodeList LOP = odoc.getElementsByTagName("locations");
            int totalPersons =LOP.getLength();
            System.out.println("Total nos of locations:"+totalPersons);

            for(int s=0; s<LOP.getLength() ; s++)
            {
                Node FPN =LOP.item(s);
                if(FPN.getNodeType() == Node.ELEMENT_NODE)
                    {

                    Element latlon = (Element)FPN;                                                                // Change 1

                    NodeList oNameList1 = latlon.getElementsByTagName("featured");                                       // Change 2
                    Element firstNameElement = (Element)oNameList1.item(0);
                    NodeList textNList1 = firstNameElement.getChildNodes();
                    //this.setLocationId(((Node)textNList1.item(0)).getNodeValue().trim());    // Change 3
                    featuredArr = changeToBoolean(((Node)textNList1.item(0)).getNodeValue().trim());                                    // value taken
                    System.out.println("#####The Parsed data#####");
                    System.out.println("featured : " + ((Node)textNList1.item(0)).getNodeValue().trim());            // Change 4
                    System.out.println("#####The Parsed data#####"); 
```

# python - django 教程 manage.py sql polls 不产生输出

> ID：12411462
> 
> 赞同：3
> 
> 时间：2012-09-13T17:14:18.150
> 
> 标签：python, django

现在已修复：问题是.. 模型中确实存在代码，它已正确保存，因为我已关闭并在一夜之间重新启动，并且代码已正确保存。但是，当我提交到 github 时，有人正确地注意到它丢失了。模型文件似乎是空的。我剪切，然后重新粘贴代码，保存并将其推回仓库。当我再次运行 manage.py sql polls 时，生成了正确的 sql。不知道问题是什么，它已正确保存到磁盘。感谢任何看过的人。

我只是在浏览 django 教程，我在 ubuntu 上安装了 django 1.4.1，使用 python 2.7，MySql 作为数据库。我已创建数据库并成功运行 syncdb 以创建默认表。

到目前为止一切正常，所有正确的目录似乎都已创建。我的模型没有拼写错误（在搜索答案后，我注意到本教程的先前版本包含拼写错误和其他错误）。我已经搜索了一段时间，之前发布的答案似乎没有解决我遇到的问题。

django 已正确安装，从终端我可以成功导入 django。

我在 INSTALLED_APPS 中添加了“民意调查”。

当我运行 python manage.py sql polls 时，它只是转到终端中的下一行，没有输出也没有错误。如果我运行 manage.py validate 我不会收到任何错误。

我可能是错的，但我相信当我运行 python manage.py startapp polls 时，它应该已将此应用程序的路径添加到 PYTHONPATH，这似乎没有发生。

但是，当我使用 sys.path.append(... 临时添加路径时，它就在那里，但这也不能解决问题。非常感谢您一直在寻找帮助。

谢谢

根据评论中的要求，这是项目的树结构

```
└── mysite
    ├── manage.py
    ├── mysite
    │   ├── __init__.py
    │   ├── __init__.pyc
    │   ├── settings.py
    │   ├── settings.pyc
    │   ├── urls.py
    │   ├── urls.pyc
    │   ├── wsgi.py
    │   └── wsgi.pyc
    └── polls
        ├── __init__.py
        ├── __init__.pyc
        ├── models.py
        ├── models.pyc
        ├── tests.py
        └── views.py 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T10:50:45.027

您的投票应用程序的 models.py 似乎没有模型，因此没有 sql 可以生成 [https://github.com/felbus/pythonbits/blob/master/django/mysite/polls/models.py](https://github.com/felbus/pythonbits/blob/master/django/mysite/polls/models.py)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-04T10:29:01.493

我遇到过同样的问题。但是，代码仍然存在（与提交期间丢失代码的情况不同）

为了解决这个问题，我将 projectname.polls 添加到 INSTALLED_APPS - 这解决了这个问题，python manage.py sql polls 给出了预期的输出。

澄清一下，在 INSTALLED_APPS 中添加 projectname.polls（无论您的项目名称是什么！），并在 manage.py args 中使用民意调查。（解决了我的问题，可能会解决你的问题！）

我使用 Python 2.7 (ActivePython)、PostGres 9.3 和 Django 1.5.5

# javascript - 过滤方法 jQuery

> ID：12411466
> 
> 赞同：0
> 
> 时间：2012-09-13T17:14:25.267
> 
> 标签：javascript, jquery, jquery-plugins, jquery-events

请帮我解决以下代码。我不明白。我必须在我的项目中使用这样的片段。

**`$('strong', this)`**<-这部分对我来说根本不清楚。

如果可能，请友好地逐行解释整个代码。

```
<ul>
   <li><strong>list</strong> item 1 -
      one strong tag
   </li>
   <li><strong>list</strong> item <strong>2</strong> -
      two <span>strong tags</span>
   </li>
   <li>list item 3</li>
   <li>list item 4</li>
   <li>list item 5</li>
   <li>list item 6</li>
</ul> 
```

JavaScript：

```
$('li').filter(function(index) {
  return $('strong', this).length == 1;
}).css('background-color', 'red'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:15:34.333

`$('strong', this)``$(target, context)`是带有格式的 jQuery 选择器。

根据您的代码：

`this`指`li`并`$('strong', li)`正在搜索该标签`<strong>`内的那个。`li`

这个语句也可以写成：

`$(this).find('strong')`从 jQuery 库代码中你会看到：

`$(target, context)`格式在内部实现

`$(context).find(target)`过程。

***[有关更多信息，请参见此处](http://api.jquery.com/jQuery/)***。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:39:01.520

代码基本上是使用 jQuery 获取 li 元素的列表`$('li')`（这将获取`<li> ... </li>`页面上的所有标签）然后用函数减少这个集合`.filter`，`filter`将函数作为参数，函数在列表中的每个元素上调用，如果它返回true，则从过滤器的列表中返回元素，如果它返回false，则忽略该项目。

在这种情况下，该函数调用过滤器当前决定检查的 li 标签`$('strong', this).length == 1`在哪里`this`，如其他答案中所述，它只是检查返回`<strong>..</strong>`当前 li 中的标签列表。如果当前 li 中不存在 strong，则 length 为 0，因此函数返回`false`，这意味着过滤器不会返回它生成的列表中的那个元素，然后它会移动到下一个 li。

这意味着代码的第一部分只是生成一个带有强标签的 li 列表，然后将其与将`css`所有这些标签着色为红色的函数链接起来。

希望有帮助。

# footer - 页脚未正确放置

> ID：12411474
> 
> 赞同：0
> 
> 时间：2012-09-13T17:14:54.810
> 
> 标签：footer

谁能帮我纠正网站页脚位置不正确的问题？

我有一个答案，但我不知道该怎么做。

我看到一个验证错误：第 569 行，第 6 列：元素“div”的结束标记未打开此外，双重使用 ID 存在问题。您有 2 个同名的 ID 页脚：第 551 行，第 12 列：此处首先定义 ID“页脚”第 563 行，第 12 列：已定义 ID“页脚”尝试解决这些问题。

该网站是 www.planestrainsautomobiles.co.uk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:23:50.850

在第 542 行中，您关闭了一个 too many `</div>`，就在之前：

```
<div class="cute_profiles_sprite"> 
```

所以你的页脚在你的主容器之外。删除`</div>`，它将起作用。`</div>`这就是为什么，顺便说一句，你在第 569 行有一个额外的。

此外，您不应该有 2 个具有相同 ID 的元素。ID 应该是唯一的。如果您需要重用它，请将其设为一个类，因此请尝试：

```
<div class="footer"> 
```

代替：

```
<div id="footer"> 
```

在这种情况下，您必须将`#footer`CSS 规则更改为`.footer`

# appharbor - 带有 AppHarbor 的 VPN

> ID：12411476
> 
> 赞同：1
> 
> 时间：2012-09-13T17:14:58.073
> 
> 标签：appharbor

我想将我的应用程序从 Rackspace 迁移到 AppHarbor，但我的应用程序依赖于只能通过 VPN 访问的数据库。我可以在 AppHarbor 的应用程序和安全的内部数据库之间建立 vpn 连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:51:08.373

您可以将数据库服务器限制为[AppHarbor 应用程序服务器使用的 IP 地址](http://support.appharbor.com/kb/tips-and-tricks/application-server-ips-ec2-configuration)集。

# wpf - 使用类继承时如何有条件地在自定义ListView的列表项中插入复选框？

> ID：12411478
> 
> 赞同：0
> 
> 时间：2012-09-13T17:15:01.423
> 
> 标签：wpf, listview, binding, controltemplate, contentcontrol

我尝试制作一个自定义的 ListView，如果具体的继承类希望这样，它会用一些东西和一个初始 Checkbox 填充每个列表项。目前没有显示复选框，所以我猜我的 ContentControl 代码在某种程度上是错误的。

```
<UserControl x:Class="local:MyListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="some/path/here">
<ListView>
<ListView.View>
    <GridView>
        <GridViewColumn>
            <GridViewColumn.CellTemplate>
                <DataTemplate>
                    <!-- Each list item: [Checkbox] Label -->
                    <StackPanel Orientation="Horizontal">
                        <!-- The code for the optional check box -->
                        <ContentControl>
                            <ContentControl.Style>
                                <Style TargetType="ContentControl">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsCheckable, RelativeSource={RelativeSource AncestorType=local:MyListView}}" 
                                                     Value="True">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <CheckBox IsChecked="{Binding Path=SomeProperty}" />
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ContentControl.Style>
                        </ContentControl>
                        <!-- The non-optional test label -->
                        <Label Content="Test Content" />
                    </StackPanel>
                </DataTemplate>
            </GridViewColumn.CellTemplate>
        </GridViewColumn>
    </ListView.View>
</ListView>
</UserControl> 
```

背后的代码：

```
abstract partial class MyListView {
    protected MyListView () {
        InitializeComponent();
    }

    protected abstract bool IsCheckable { get; }
}

// A checkbox should be displayed - but it's not...
public class MyListView1 : MyListView {
    protected bool IsCheckable { get { return true; } }
}

public class MyListView2 : MyListView {
    protected bool IsCheckable { get { return false; } }
} 
```

在检查输出窗口时，我发现了以下消息（我不知道如何使用）：

> System.Windows.Data 信息：10：无法使用绑定检索值，并且不存在有效的备用值；改用默认值。绑定表达式：路径=IsCheckable；DataItem='MyListView2' (名称=''); 目标元素是'ContentControl'（名称=''）；目标属性是“NoTarget”（类型“对象”）
> 
> System.Windows.Data 错误：39：BindingExpression 路径错误：在“对象”“MyListView2”（名称=“”）上找不到“IsCheckable”属性。绑定表达式：路径=IsCheckable；DataItem='MyListView2' (名称=''); 目标元素是'ContentControl'（名称=''）；目标属性是“NoTarget”（类型“对象”）
> 
> System.Windows.Data 信息：19：由于缺少信息，BindingExpression 无法检索值。绑定表达式：路径=IsCheckable；DataItem='MyListView2' (名称=''); 目标元素是'ContentControl'（名称=''）；目标属性是“NoTarget”（类型“对象”）
> 
> System.Windows.Data 信息：20：BindingExpression 无法从空数据项中检索值。当绑定被分离或绑定到没有值的 Nullable 类型时，可能会发生这种情况。绑定表达式：路径=IsCheckable；DataItem='MyListView2' (名称=''); 目标元素是'ContentControl'（名称=''）；目标属性是“NoTarget”（类型“对象”）

MyListView1 出现相同的错误消息。请注意，这个问题源于[旧帖子](https://stackoverflow.com/questions/12202294/how-to-conditionally-insert-a-checkbox-in-a-list-item-of-a-customized-listview?answertab=active#tab-top)的演变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:53:53.077

根据[msdn Binding Sources Overview：](http://msdn.microsoft.com/en-us/library/ms743643.aspx)

> 用作绑定的绑定源属性的属性必须是类的公共属性。不能出于绑定目的访问显式定义的接口属性，也不能访问没有基本实现的受保护、私有、内部或虚拟属性。

# android - 检查是否安装了某个应用程序并获取它的版本

> ID：12411479
> 
> 赞同：1
> 
> 时间：2012-09-13T17:15:02.723
> 
> 标签：android

我需要检查是否安装了某个应用程序（我通过它的包名称“com.domain.appname”知道它是什么），如果它没有安装，则显示一个 toast 消息。如果已安装，我需要获取其版本并显示带有版本的 toast 消息。是否可以？

另一个问题（[How to get a list of installed android applications and pick one to run](https://stackoverflow.com/questions/2695746/how-to-get-a-list-of-installed-android-applications-and-pick-one-to-run)）没有提到获取版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:19:05.980

您可以从 PackageManager 获取该信息。

```
private String getVersionName(String packageName) {
    String version = null;
    try {
        PackageInfo info = getPackageManager().getPackageInfo(packageName, PackageManager.GET_META_DATA);
        version = pInfo.versionName;
    } catch (Exception e) {
        e.printStackTrace();
    }
    return version;
} 
```

# php - PHP 下载脚本在 Mac 上创建不可读的 ZIP 文件

> ID：12411481
> 
> 赞同：1
> 
> 时间：2012-09-13T17:15:19.427
> 
> 标签：php, macos, download, zip

作为参考，我已经阅读并尝试了这些和其他几个线程中的答案：

[使用 php 创建和提供压缩文件](https://stackoverflow.com/questions/1436239/creating-and-serving-zipped-files-with-php)

[打开下载的 zip 文件会创建 cpgz 文件吗？](https://stackoverflow.com/questions/11495103/opening-downloaded-zip-file-creates-cpgz-file)

我的服务器上有一个 zip 文件。

1.  当我使用 Filezilla 将该 Zip 文件从我的服务器移动到我的 Mac 时，我可以正常打开它。

2.  当我使用此 PHP 代码将 Zip 文件下载到我的 Linux 机器时，它可以正常打开。

3.  当我使用此 PHP 代码使用 Safari 或 Firefox 将 Zip 文件下载到我的 Mac 时，我收到一条错误消息，提示“解压缩失败”或“存档结构已损坏”，或者我得到一个 .cpgz 文件 - 我相信表示计算机正在压缩文件，而不是解压缩文件。

这是我用来传递 zip 文件的 PHP 代码。

```
$zipname = "myfile.zip";
$zippath = "/path/to/" . $zipname;

      if ($downloadzip = fopen ($zippath, "r")) {
            $fsize = filesize($zippath);

            header("Content-type: application/zip");
            header("Content-Disposition: attachment; filename=\"".$zipname."\"");
            header("Content-length: $fsize");
            header('Content-Transfer-Encoding: binary');
            #header("Cache-control: private"); //use this to open files directly

            echo fpassthru($downloadzip); // deliver the zip file

        }
        fclose ($downloadzip); 
```

我发现了一些有效的标题。我真的不知道也不关心它为什么起作用，我只是很高兴它起作用了……我尝试了很多不同的东西，.htaccess 文件，php.ini / zlib 设置。

这是答案 [http://perishablepress.com/http-headers-file-downloads/](http://perishablepress.com/http-headers-file-downloads/)

```
$zipName = 'myfile.zip';
$zipPath = 'mydirectory/' . $zipName;

    if (file_exists($zipPath)) {

        header("Pragma: public");
        header("Expires: 0");
        header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
        header("Cache-Control: public");
        header("Content-Description: File Transfer");
        header("Content-type: application/octet-stream");
        header("Content-Disposition: attachment; filename=\"".$zipName."\"");
        header("Content-Transfer-Encoding: binary");
        header("Content-Length: ".filesize($zipPath));
        ob_end_flush();
        @readfile($zipPath);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-08-12T20:28:18.693

通常问题是由在您读出文件之前打印或回显到页面的额外字符引起的。即使是空格也会导致失败。要解决该问题，请`ob_end_clean();`在读取将清除输出缓冲区并关闭缓冲的文件之前调用。

但请记住，您可以有*嵌套*的输出缓冲区，这也会破坏您的下载（为[Vladamir](https://perishablepress.com/http-headers-file-downloads/comment-page-1/#comments)解决这个问题而欢呼）。因此，要在读取文件之前完全清除输出缓冲区，请运行此命令：

```
while (ob_get_level()) {
    ob_end_clean();
} 
```

这将清除您的整个缓冲区，并且您不会有任何额外的字符来搞乱您的下载。

对于那些感兴趣的人，我在下面粘贴了我的下载脚本。我的 zip 文件现在可以完美下载，到目前为止效果很好。

```
if (file_exists($zip_file_path)) {

        header("Pragma: public");
        header("Expires: 0");
        header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
        header("Cache-Control: public");
        header("Content-Description: File Transfer");
        //We can likely use the 'application/zip' type, but the octet-stream 'catch all' works just fine.  
        header("Content-type: application/octet-stream");
        header("Content-Disposition: attachment; filename='$zip_file_name'");
        header("Content-Transfer-Encoding: binary");
        header("Content-Length: ".filesize($zip_file_path));

        while (ob_get_level()) {
             ob_end_clean();
        }

        @readfile($zip_file_path);

        exit;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T23:29:53.313

这是有效的

```
$zipName = 'myfile.zip';
$zipPath = 'mydirectory/' . $zipName;

    if (file_exists($zipPath)) {

        header("Pragma: public");
        header("Expires: 0");
        header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
        header("Cache-Control: public");
        header("Content-Description: File Transfer");
        header("Content-type: application/octet-stream");
        header("Content-Disposition: attachment; filename=\"".$zipName."\"");
        header("Content-Transfer-Encoding: binary");
        header("Content-Length: ".filesize($zipPath));
        ob_end_flush();
        @readfile($zipPath);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:24:42.537

好吧，我假设您知道您的 $fsize 变量没有被写入该标题，因为它被引号括起来。你可以尝试这样的事情：

```
header('Cache-Control: public');
header('Content-Description: File Transfer');
header('Content-Disposition: attachment; filename=\"".$zipname."\"');
header('Content-Type: application/zip'); 
```

# javascript - 获取复选框的值

> ID：12411487
> 
> 赞同：1
> 
> 时间：2012-09-13T17:15:44.750
> 
> 标签：javascript, jquery, drupal-6

好的，我正在运行一个 javascript，它正在测试一堆以查看它们是否已更改，如果它们已更改，我需要查看是否选中了一个复选框。但是，出于某些原因，我没有使用表单来执行此操作。下面是表格显示的代码：

```
<table class="db-view-sku-table">
<thead>
    <tr>
        <th>Merge <br />Callouts</th>
        <th>Current Page</th>
        <th>Current Callout</th>
        <th>New Page</th>
        <th>New Callout</th>
        <th>MFG SKU</th>
        <th>Client SKU</th>
        <th>Description</th>
    </tr>
</thead>
<tbody>
    <tr class="odd changed_value">
      <td class="hidden db-sku-nid">192297</td>
      <td class="hidden db-co-nid">212300</td>
      <td class="merge"><input type="checkbox" name = "mergeme" class="checked" /></td>
      <td class="db-current-page"><a href="/node/212299" target="_blank">6</a></td>
      <td class="db-current-co">A</td>
      <td class="db-move-page"><input type="text" class="page-select" size="4" value="" /></td>
      <td class="db-move-co"><input type="text" class="co-select" size="4" value="A" /></td>
      <td class="db-sku"><a href="/plain/node/192297/edit" class="popup" title="Click to view global SKU details in popup window.">AAG794200</a></td>
      <td class="db-client-sku editable-text">AAG-794200</td>
      <td class="db-description">AT-A-GLANCE Sorbet Wkl/Mthly Plnr</td>
    </tr>
    <tr class="even changed_value">
      <td class="hidden db-sku-nid">97160</td>
      <td class="hidden db-co-nid">212301</td>
      <td class="merge"><input type="checkbox" name = "mergeme" class="checked" /></td>
      <td class="db-current-page"><a href="/node/212299" target="_blank">6</a></td>
      <td class="db-current-co">A</td>
      <td class="db-move-page"><input type="text" class="page-select" size="4" value="" /></td>
      <td class="db-move-co"><input type="text" class="co-select" size="4" value="A" /></td>
      <td class="db-sku"><a href="/plain/node/97160/edit" class="popup" title="Click to view global SKU details in popup window.">AAG76PN0105</a></td>
      <td class="db-client-sku editable-text">AAG-76PN0105</td>
      <td class="db-description">QUICKNOTES WKLY/MNTH, SPECIAL EDITION</td> 
```

按下保存按钮时的代码：

```
function setupMassSave() {
$('.save-button').click(function() {
    var merge = getMergeList();
    var skus = getSkuList();
    var pages = getPageList();
    var callouts = getCalloutList();
    var currco = getCurrCalloutList();
    $.ajax({
        url: '/skumove/save_all/' + merge + '/' + skus + '/' + pages + '/' + callouts + '/' + currco,
        cache: false,
        success: refreshView
    });
});
}

function getSkuList() {
var slist = [];
$('.changed_value').each(function(index) {
    if(!$(this).children('.merge').children('.checked').checked){ 
        slist.push($(this).children('.db-sku-nid').text());
    }
});
return slist;
}
function getMergeList() {
var mlist = [];
$('.changed_value').each(function(index) {
    if($(this).children('.merge').children('.checked').checked) { 
        mlist.push($(this).children('.db-sku-nid').text());
    }
});
return mlist;
} 
```

我唯一遇到的问题是这两个功能。他们其他 3 个函数工作正常并返回我需要的值。我知道问题出在 ('.merge').clicked 区域内。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:18:32.810

`.checked`是一个（布尔）vanilla JavaScript 属性，您尝试将其应用于 jQuery 对象。这就是为什么它不起作用。

代替

```
$(this).children('.merge').children('.checked').checked 
```

与

```
$(this).children('.merge').children('.checked')[0].checked 
```

或者

```
$(this).children('.merge').children('.checked').is(':checked') 
```

或者

```
$(this).children('.merge').children('.checked:checked').length 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:18:00.410

使用伪选择器 :checked 而不是类选择器 .checked

```
if($(this).children('.merge').children(':checked').length) { 
    mlist.push($(this).children('.db-sku-nid').text());
} 
```

# jquery - 根据 Ruby 中的 db 值在下拉列表中选择值

> ID：12411491
> 
> 赞同：0
> 
> 时间：2012-09-13T17:16:01.337
> 
> 标签：jquery, ruby-on-rails, ruby, sinatra

我有一个简单的 Sinatra 应用程序，您可以使用它来记录您在某个晚上喝的啤酒、它们的数量和类型。要编辑其中一个用户输入的夜晚，我有一个简单的表单，它反映了创建饮酒事件时输入的值：

```
<input type="text" value="<%= @beer.name %>" name="name"/>
<input type="text" value="<%= @beer.price %>" name="price"/> 
```

因此，从数据库值中填充值是一件好事。现在，如何选择下拉列表的值？

```
<select name="night">
    <option value="Monday">Monday</option>
    <option value="Tuesday">Tuesday</option>
    <option value="Wednesday">Wednesday</option>
    <option value="Thursday">Thursday</option>
    <option value="Friday">Friday</option>
    <option value="Saturday">Saturday</option>
    <option value="Sunday">Sunday</option>
  </select> 
```

我发现我可以使用内联 jquery 来做到这一点：

```
<script>
$(document).ready(function(){
$(".edit select[name=type] option").each(function(){
if ($(this).val() == "<%= @beer.type %>"){
  $(this).attr("selected", true );
}
});
$(".edit select[name=night] option").each(function(){
if ($(this).val() == "<%= @beer.night %>"){
  $(this).attr("selected", true );
}
});
});
</script> 
```

但我真的不想求助于内联 js。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:19:05.280

我会做这样的事情

```
<select name="night">
  <% ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"].each do |day| %>
    <option <%= 'selected="selected"' if day == @beer.night %> value="<%= day %>"><%= day %></option>
  <% end %>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:00:53.600

您可能希望从选择下拉框的简单 id 选择器开始，如下所示：

```
<select id="day">...</select>

Then create an external javascript file, call it whatever you like such as day_select_handler.js  and include it in your view.

<html>
<head>
  <script type="text/javascript" src="day_select_handler.js"></script>
</head>
... 
```

这样，当此页面加载时，将加载 javascript 文件。而且它不是内联的，也可以在其他页面中重复使用。

# ruby-on-rails - 如果引用的对象更改其属性，延迟作业 gem 将不起作用

> ID：12411493
> 
> 赞同：0
> 
> 时间：2012-09-13T17:16:12.757
> 
> 标签：ruby-on-rails, ruby, activerecord, gem

我面临一个非常有趣的问题。我已经测试了延迟作业 gem 4 次。我怀疑这是宝石的设计问题还是错误。我使用命令`rake jobs:work`创建工人来做延迟工作。

一旦我创建了一个 LongTask 记录，我还会做一个延迟作业，它将属性更改`minutes_delayed`为 2。

如果我不更新属性，gem 会完美运行。但是一旦我编辑了描述，gem 将无法正常工作，这意味着它不会执行延迟作业，但相关的延迟作业记录会在数据库中删除。

有趣的最终结果： ![在此处输入图像描述](../Images/17e94c01e4d826a09d10d69ade17416f.png)

它似乎引用了一个属性完全相同的对象，这张图片是在运行时间过去之前捕获的。 ![它似乎引用了一个具有完全相同属性的对象](../Images/c09d45431efbd080ff2e3ddb913050c7.png)

不过，这是在所有测试结束后捕获的。您可以看到 test4 的延迟作业记录已被删除，即使此延迟作业没有任何影响。 ![在此处输入图像描述](../Images/0b40ffb45bb1cc576899bd50fb5b97bc.png)

最终结果（仅执行 2 个作业）

```
[Worker(host:Jasonteki-MacBook-Air.local pid:1726)] Starting job worker
[Worker(host:Jasonteki-MacBook-Air.local pid:1726)] LongTask#set_delay_time_without_delay completed after 0.0343
[Worker(host:Jasonteki-MacBook-Air.local pid:1726)] 1 jobs processed at 16.6270 j/s, 0 failed ...
[Worker(host:Jasonteki-MacBook-Air.local pid:1726)] LongTask#set_delay_time_without_delay completed after 0.0105
[Worker(host:Jasonteki-MacBook-Air.local pid:1726)] 1 jobs processed at 51.4774 j/s, 0 failed ... 
```

模型中的代码：

```
 def set_delay_time(time)
    self.minutes_delayed = time
    # very important for this, otherwise cannot write the change into the database
    self.save
  end

  handle_asynchronously :set_delay_time, :run_at => Proc.new { 2.minutes.from_now } 
```

控制器中的代码：

```
 def create
    @long_task = LongTask.new(params[:long_task])

    respond_to do |format|
      if @long_task.save
        @long_task.set_delay_time(2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:24:51.193

如果没有看到您的代码，就无法确定，但很可能您的两个延迟作业都在处理对象的序列化副本，而不是从数据库中重新加载它们。

# php - Apache mod_rewrite 语法不起作用

> ID：12411495
> 
> 赞同：3
> 
> 时间：2012-09-13T17:16:18.750
> 
> 标签：php, apache, url, mod-rewrite

好的，伙计们，我遇到了一个让我发疯的问题。这是发生的事情：

我决定要重写我网站上的 URL。

它应该从此语法重写：

[http://www.sample.com/programming.php?name=something](http://www.sample.com/programming.php?name=something)

对此：

[http://www.sample.com/tutorials/programming/something.php](http://www.sample.com/tutorials/programming/something.php)

或（例如 2）：

[http://www.sample.com/other.php?name=test](http://www.sample.com/other.php?name=test)

对此：

[http://www.sample.com/tutorials/other/test.php](http://www.sample.com/tutorials/other/test.php)

所以我的 URL 语法是：

[http://www.sample.com/tutorials/](http://www.sample.com/tutorials/(name) (我的文件名)/(变量名).php

我尝试了以下代码：

```
RewriteEngine On
RewriteRule ^tutorials/programming/(.+)$ /programming.php?name=$1 [L]
RewriteRule ^tutorials/other/(.+)$ /other.php?name=$1 [L] 
```

但是，它没有正确地重写 URL。详细解释如下：

所以，当我访问我的原始网站时，它看起来像这样：

[http://www.sample.com/programming.php?name=something](http://www.sample.com/programming.php?name=something)

如果我访问此 URL：

[http://www.sample.com/tutorials/programming/something.php](http://www.sample.com/tutorials/programming/something.php)

我得到了我的网站 HTML，但没有我的 CSS 布局（仅显示 HTML）。此外，如果我单击非 CSS 站点上的任何其他链接，我会收到错误 404。请注意，index.php 站点的 URL 不是应有的：

[http://www.something.com/index.php](http://www.something.com/index.php)（正确的 index.php URL）

但它是这样的：

[http://www.sample.com/tutorials/programming/index.php](http://www.sample.com/tutorials/programming/index.php)（不存在）。

我已经在线阅读了 10 多个教程，请我的同事帮助我，但他的解决方案也没有奏效。所以，我想要完成的只是我的 URL 被重写，所以当用户在编程中选择一个教程时，我在地址栏中没有得到这个 URL：

[http://www.sample.com/programming.php?name=something](http://www.sample.com/programming.php?name=something)

但是这个 ：

[http://www.sample.com/tutorials/programming/something.php](http://www.sample.com/tutorials/programming/something.php)

这就是我想要的。

我试图尽可能详细。如果您需要更多详细信息，请告诉我。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:22:24.733

> 我得到了我的网站 HTML，但没有我的 CSS 布局（仅显示 HTML）。此外，如果我单击非 CSS 站点上的任何其他链接，我会收到错误 404。请注意，index.php 站点的 URL 不是应有的：

由于额外的斜线，您在页面内容中拥有的相对/绝对路径得到了不同的基础。当你有类似的东西`<img src="images/blah.gif">`时，相对基础来自浏览器看到的 URL（不是服务器内部重写的内容）。因此，如果浏览器看到：`http://www.sample.com/programming.php?name=something`，则 URI 是`/programming.php`URI base 是`/`。但是，如果浏览器看到`http://www.sample.com/tutorials/programming/something.php`，则 URI 是`/tutorials/programming/something.php`并且 URI 基变为`/tutorials/programming/`，我假设这不是您的 images/css/scripts/etc 所在的位置（因为该目录可能甚至不存在）。

您需要通过添加以下内容来更正所有页眉中的 URI 基数：

```
<base href="/"> 
```

或者将所有相对链接更改为绝对链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:22:51.737

> > 我得到了我的网站 HTML，但没有我的 CSS 布局（仅显示 HTML）

你是如何包含CSS的？你有没有在路上包含你的文件

../../css/file.css

或绝对模式

/css/file.css?

检查真正的问题是什么（我猜你的任务重写成功，例如我没有正确理解它）你能给我们真正的uri吗？

# delphi - TLoginCredentialService 使用示例

> ID：12411496
> 
> 赞同：10
> 
> 时间：2012-09-13T17:16:20.517
> 
> 标签：delphi, delphi-xe2

这个新类的文档页面（在 XE2 中引入）仅包含对 TObject 文档或占位符的引用[。](http://docwiki.embarcadero.com/Libraries/en/System.Classes.TLoginCredentialService)我可以看到这个类提供了一个 RegisterLoginHandler 方法和一个 UnRegisterLoginHandler 方法，它们使用了一个[TLoginCredentialEvent](http://docwiki.embarcadero.com/Libraries/en/System.Classes.TLoginCredentialService.TLoginCredentialEvent)类。这使用带有用户名和密码的[TLoginEvent对象。](http://docwiki.embarcadero.com/Libraries/en/Data.DBCommonTypes.TLoginEvent)

这个类的典型用例会是什么样子（源代码）？它是否在 Delphi Datasnap/Web 服务库的某个地方使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-10T13:53:19.607

我刚刚创建了一个如何使用它的小演示

点击[这里](http://Borrisholt.dk//TLoginCredentialService.zip "TLoginCredentialService 演示")下载代码

下面我将展示一些代码：

首先，我需要一个记录来保存凭证，以及它们的列表：

```
Type
  TCredential = record
    Username, Password, Domain: string;
    constructor Create(const aUsername, aPassword, aDomain: string);
    function AreEqual(const aUsername, aPassword, aDomain: string): Boolean;
  end;

  TCredentialList = class(TList<TCredential>)
  public
    function IsValidCredential(const aUsername, aPassword, aDomain: string): Boolean;
  end; 
```

然后我们需要定义一个我们称之为的上下文。那只是一个应用程序唯一的字符串，用于标识每个登录功能

```
const
  Context = 'TForm1'; 
```

在表单创建中，我创建我的列表并向其中添加虚拟数据

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  CredentialList := TCredentialList.Create;
  //Add Dummy data
  CredentialList.Add(TCredential.Create('AA', 'AA', 'DomainAA'));
  CredentialList.Add(TCredential.Create('BB', 'BB', 'DomainAA'));
  CredentialList.Add(TCredential.Create('CC', 'CC', 'DomainAA'));

  // Register your Login handler in a context.
  // This method is called when you try to login
  // by caling TLoginCredentialService.GetLoginCredentials();
  TLoginCredentialService.RegisterLoginHandler(Context, LoginCredentialEvent);
end; 
```

我在我的表单上放置了一个按钮，我打电话给 login ：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  // The actual call to login
  // First param is the context
  // Second Parameres is a callback function given to the event handler.
  TLoginCredentialService.GetLoginCredentials(Context,
    function { LoginFunc } (const Username, Password, Domain: string): Boolean
    begin
      //The actual user validation
      Result := CredentialList.IsValidCredential(Username, Password, Domain);
    end);
end; 
```

最后我只需要实现我的登录处理程序：

```
//This is the "onLogin" event handler.
//This is called durring a login attempt
//The purpose of this event handler are to call tha callBack function with correct information
//and handle the result
procedure TForm1.LoginCredentialEvent(Sender: TObject; Callback: TLoginCredentialService.TLoginEvent; var Success: Boolean);
begin
  //Call the callback
  Callback(Sender, LabeledEdit1.Text, LabeledEdit2.Text, LabeledEdit3.Text, Success);

  //Handle the success.
  if Success then
    Label1.Caption := 'Yes'
  else
    Label1.Caption := 'No';
end; 
```

希望这能回答问题。不要忘记在[此处下载完整代码](http://Borrisholt.dk//TLoginCredentialService.zip "TLoginCredentialService 演示")

# jquery - 在初始化时显示 Twitter 引导工具提示

> ID：12411500
> 
> 赞同：1
> 
> 时间：2012-09-13T17:16:29.240
> 
> 标签：jquery, ruby-on-rails, twitter-bootstrap

我基本上想在有人第一次到达页面时显示一个工具提示，但是在他们将鼠标悬停在它上面（或页面上的其他工具提示）之后，它又回到了默认的悬停行为。发生这种情况时似乎有一个错误，效果不佳。目前我使用 $('div#id').tooltip('show') 命令加载工具提示，但我似乎无法弄清楚如何将其恢复为默认悬停行为。更糟糕的是，如果我为特定的 div 编写一个悬停函数以在“显示”和“隐藏”之间切换，那么它是错误的。

你可以在这个网站上看到行为：[http](http://rework.herokuapp.com/organizations) ://rework.herokuapp.com/organizations ，在“它是如何工作的”部分下。

这是HTML代码：

```
<div class="row center works">

   <div class="of center"><img alt="Step 1" class="center step init" data-placement="bottom" id="step1" rel="tooltip" src="/assets/works/step1.png" data-original-title="People who are driven to find meaningful work apply to the ReWork Talent Pool."></div>

   <div class="of center"><img alt="Step 2" class="center step" data-placement="bottom" id="step2" rel="tooltip" src="/assets/works/step2.png" data-original-title="ReWork screens applicants for skills, experience, values, and accomplishments."></div>

   <div class="of center"><img alt="Step 3" class="center step" data-placement="bottom" id="step3" rel="tooltip" src="/assets/works/step3.png" data-original-title="You engage ReWork for a role you need filled, and ReWork hand-selects qualified candidates from the talent pool."></div>

   <div class="of center"><img alt="Step 4" class="center step" data-placement="bottom" id="step4" rel="tooltip" src="/assets/works/step4.png" data-original-title="You choose which candidates you want to meet, and make an offer if there’s a good fit."></div>

   <div class="of center"><img alt="Step 5" class="center step" data-placement="bottom" id="step5" rel="tooltip" src="/assets/works/step5.png" style="padding-bottom:13px" data-original-title="ReWork collects a fee when a successful hire is made."></div>

</div> 
```

jQuery：

```
 $('img#step1').load(function(){
      $('#step1').tooltip('show');
    });

    $('.step').hover(function() {
        $('#step1').removeClass('init');
        if ($(this).attr('id') != 'step1') {
            $('#step1').tooltip('hide');
        } else {
            $('#step1').tooltip('show');
        } 
```

该错误再次在网站上可见：[http](http://rework.herokuapp.com/organizations) ://rework.herokuapp.com/organizations在“如何工作”部分下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:23:54.283

你可以这样做：

```
$('.works .step').tooltip().eq(0).tooltip('show').tooltip('disable').one('mouseout', function() {
  $(this).tooltip('enable');
});​​​​​​​ 
```

**演示： http: [//jsfiddle.net/AtvBN/9/](http://jsfiddle.net/AtvBN/9/)**（用于页面的不同部分，但概念相同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-28T06:58:16.047

“.in”类负责显示工具提示标题。如果你想

> 当用户第一次点击页面时显示所有工具提示。

然后您可以简单地将类添加到所有工具提示元素中。像这样：

```
$('#step1').tooltip('show');//Initialize tooltip in any way you desire
$('[data-toggle="tooltip"]').find(".tooltip.fade").addClass("in"); 
```

如果你想

> 当用户第一次点击页面并设置工具提示默认行为时，删除所有默认显示工具提示。

你也可以这样做

```
$('#step1').tooltip('show');//Initialize tooltip in any way you desire
$('[data-toggle="tooltip"]').find(".tooltip.fade").removeClass("in"); 
```

这样它对我有用，希望它也对你有用。

# ios - 谁可以构建/创建临时发行版是否有限制？

> ID：12411505
> 
> 赞同：2
> 
> 时间：2012-09-13T17:16:54.517
> 
> 标签：ios, xcode

我绝对确定几个月前我在某处读到只有一个团队成员可以构建/创建一个用于临时分发的包。

但是现在我在任何地方都找不到任何参考，是我弄错了吗？

目前我正在我们公司内创建和分发构建，但即将去度假，因此试图找出在我离开时其他人这样做是否会有任何问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:23:56.770

给定一个配置文件，团队中的任何开发人员都可以签署和发布临时构建。然而...

> 只有团队代理和管理员可以创建分发配置文件

[https://developer.apple.com/library/ios/#recipes/ProvisioningPortal_Recipes/CreatingaDistributionProvisioningProfile/CreatingaDistributionProvisioningProfile.html](https://developer.apple.com/library/ios/#recipes/ProvisioningPortal_Recipes/CreatingaDistributionProvisioningProfile/CreatingaDistributionProvisioningProfile.html)

# git - Git 附加特定的子模块树

> ID：12411506
> 
> 赞同：0
> 
> 时间：2012-09-13T17:16:56.000
> 
> 标签：git, github

我目前已经[在这里](https://github.com/chriscct7/jigoshop/tree/dev/vendor)提交了 wordpress-tests 子模块。
Github告诉我附上的版本是子模块的最新版本：
wordpress-tests@d983429

但是，我希望附加到旧版本，例如
wordpress-tests @ 460b9c4

新版本的具体 Github 树 URL 为：
[https ://github.com/nb/wordpress-tests/tree/460b9c4ad9db7eea4710f151851060ae1921ea7c](https://github.com/nb/wordpress-tests/tree/460b9c4ad9db7eea4710f151851060ae1921ea7c)

如何将旧版本附加到我的程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T14:17:44.013

我花了一段时间才弄清楚，但基本上当你做 gitattributes 文件时，使用提交树。

# vb.net - Visual Basic 2008 对具有不同值的两个相关数组列表进行排序

> ID：12411508
> 
> 赞同：0
> 
> 时间：2012-09-13T17:17:00.103
> 
> 标签：vb.net, visual-studio-2008

我是 VB.Net 的新手，有作业问题，我找不到一个好的答案。我有一个程序，它从两个不同的文件中获取两个一维数组并对它们进行排序。我用 ArrayList 构建了我的数组（由于某种原因，我无法将我的文本文件加载到常规数组中）。

比如说我有以下两个字符串 ArrayLists：
Figurines contains Dog, Cat, Bird, Fish
价格包含 2000, 2500, 1500, 1000

我需要执行四种排序：对小雕像的升序和降序以及对价格的升序和降序。这就是问题所在。正常的显示应该是这样的：

```
公仔价格
     狗 2000
     猫 2500
     鸟 1500
     鱼 1000
```

如果我对小雕像 ArrayList (Figurines.Sort) 进行升序排序，则价格 ArrayList 必须与小雕像匹配。

```
公仔价格
     鸟 1500     
     猫 2500
     狗 2000
     鱼 1000
```

对一个数组进行排序没有问题，但是让依赖数组对其进行排序让我感到难过，而且我无法找到任何类似这样的资源。

这些文件的结构相似（一个字母，一个数字）但更长。这些需要在一维数组中，我不允许使用多维数组。我希望有人可以帮助我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:25:32.003

通常我建议将值放入二维数组中，排序，然后再次将它们拆分为单独的数组，但作为家庭作业，我想知道该项目的目标是否可能是让您自己实现排序算法然后随时对两个数组进行排序。（换句话说，这个解决方案可能不会让你取得好成绩。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:27:54.843

如果您将示例中的值写在八张纸上并手动排序，一次移动一张纸，您是否知道如何在代码中执行此操作？

# javascript - 使用 javascript 和 xml 进行验证

> ID：12411510
> 
> 赞同：0
> 
> 时间：2012-09-13T17:17:09.857
> 
> 标签：javascript, xml

我正在尝试将输入文本与 xml 标记进行比较以进行验证，但我遇到了一些麻烦。我的错误是 call() 函数中的条件（我认为）：

```
if (window.XMLHttpRequest){
     xmlhttp=new XMLHttpRequest();
}
else{
     xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","userPass.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;

function calling(){
    if(document.getElementById("userName").innerHTML==
      (xmlDoc.getElementsByTagName("user")[0].childNodes[0].nodeValue){
             alert("this is valid");
  }
}

<form name="input" action="userPass.xml" method="post">
        username <input type="text" id="userName" onchange="calling()" /><br/><br/>
        password <input type="password" id="password"/><br/><br/>
        <input type="submit" value="Submit" />
</form> 
```

感谢您花时间提供帮助-

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:28:27.913

我认为您在 if 语句的条件中缺少右括号。此外，您可能想要测试输入的 value 属性而不是 innerHTML。您的函数应如下所示：

```
function calling() {
    if (document.getElementById("userName").value == (xmlDoc.getElementsByTagName("user")[0].childNodes[0].nodeValue){ 
       alert("this is valid");
  }
} 
```

这是我的猜测。如果不知道您遇到了什么样的问题或服务器的响应是什么样的，我无法为您提供任何进一步的帮助。

# ruby-on-rails - 如何在 has_one 关系中默认创建对象的实例

> ID：12411512
> 
> 赞同：1
> 
> 时间：2012-09-13T17:17:11.187
> 
> 标签：ruby-on-rails, activerecord

是否有用于在 AR 关系中创建对象的 DSL，这与`:dependent => destroy`（换句话说，创建一个对象，使其始终存在）相反。比如说，我有以下内容：

```
class Item < ActiveRecord::Base
  #price
  has_one :price, :as => :pricable, :dependent => :destroy
  accepts_nested_attributes_for :price
  ....

class Price < ActiveRecord::Base
    belongs_to :pricable, :polymorphic => true
    attr_accessible :price, :price_comment 
```

我想我希望每次都创建一个价格，即使我们没有指定价格？是作为回调执行此操作的唯一（或最佳）选择，还是有办法通过 DSL（类似于`:denpendent => :destroy`）执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:19:37.780

不，因为这几乎没有用例。如果您的记录在没有关联记录的情况下无法存在，则您可能应该*阻止*记录被保存，而不是硬塞进某种伪空对象来代替它。

最接近的近似值是`before_save`回调：

```
class Item < ActiveRecord::Base
  has_one :price, :as => :pricable, :dependent => :destroy
  accepts_nested_attributes_for :price

  before_save :create_default_price

  def create_default_price
    self.price ||= create_price
  end

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:36:18.420

您应该只在创建时运行此代码一次，并在`create_price`此处使用便捷方法：

```
class Item < ActiveRecord::Base
  has_one :price, :as => :pricable, :dependent => :destroy

  accepts_nested_attributes_for :price

  after_validation :create_default_price, :on => :create

  def create_default_price
    self.create_price
  end
end 
```

# database - 使用 JUnit 测试文件中的多个方法

> ID：12411513
> 
> 赞同：0
> 
> 时间：2012-09-13T17:17:16.843
> 
> 标签：database, unit-testing, junit

我对 Java 和 JUnit 很陌生。我们在数据库中有大量要测试的过程，因此我们正在考虑如果可行的话，是否可以使用 JUnit 来测试它们。

需要测试的数据库过程/函数以及参数，预期的输出都将通过文件传递。我不确定 JUnit 是否会有所帮助，因为我们正在查看从文件中获取信息，为每个 proc 运行测试，然后提供一个输出，其中指定有多少失败以及错误消息。

根据我在阅读一些帖子和互联网搜索时的理解，似乎我需要一个带有 @Test 的单独方法来测试每个数据库过程，这意味着我们需要提前创建 Java 方法。但该测试将帮助对 Java 了解不多的数据库开发人员，只需在文件中指定要击败的 proc，其余的由 JUnit 框架处理。

这对 JUnit 是否可行，请提供任何建议？

# ruby-on-rails - ruby on rails enable 验证条件

> ID：12411520
> 
> 赞同：1
> 
> 时间：2012-09-13T17:17:35.543
> 
> 标签：ruby-on-rails, validation, if-statement, model

**post.rb**

```
 @allowed_post_types = [
    'type1',
    'type2',
    'type3',
    'type4'
  ]

  #validate post type
  validates :post_type, :presence => true, :inclusion=> { :in => @allowed_post_types }, :if => :valid_post_type?

  def valid_post_type?
    self.post_type != 'type5'
  end 
```

`validates :post_type`每当`:post_type`不是**type5**时，我如何启用代码行？

尝试了上述方法，但似乎不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:23:52.800

尝试：

```
validates :post_type, 
          :presence => true, 
          :inclusion=> { :in => @allowed_post_types }, 
          :if => lambda { |a| a[:post_type] != "type5" } 
```

# c++ - boost multi_index 修改成员和保留序列

> ID：12411528
> 
> 赞同：3
> 
> 时间：2012-09-13T17:18:22.333
> 
> 标签：c++, boost, boost-multi-index

我正在使用 boost::multi_index 容器。基本上它由一些数据加上如果数据集信息完整的信息组成（当将项目添加到容器中时，信息尚未完成）。容器已排序，因为我必须知道订单项已添加到容器中。

```
#include <boost/multi_index_container.hpp>    
#include <boost/multi_index/hashed_index.hpp>    
#include <boost/multi_index/ordered_index.hpp>    
#include <boost/multi_index/member.hpp>    
#include <boost/multi_index/composite_key.hpp>    
#include <boost/multi_index/sequenced_index.hpp>    
#include <boost/multi_index/key_extractors.hpp>    

struct indexed_struct    
{    
    unsigned int identifier;    
    unsigned int iterationFinished;    

    indexed_struct():    
        identifier(0), iterationFinished(0){}

    indexed_struct(unsigned int identifier, unsigned int iterationFinished):    
        identifier(identifier), iterationFinished(iterationFinished){}

    friend std::ostream& operator<<(std::ostream& os,const indexed_struct& c)    
    {    
        os<<c.identifier<<std::endl;    
        return os;    
    }
};

struct identifierTag {};    
struct finishedTag {};

typedef boost::multi_index::multi_index_container<    
    indexed_struct,    
        boost::multi_index::indexed_by<boost::multi_index::sequenced<>,    
            boost::multi_index::ordered_unique<boost::multi_index::tag<identifierTag>,    
            BOOST_MULTI_INDEX_MEMBER(indexed_struct, unsigned int, identifier)    
        >,    
        boost::multi_index::ordered_non_unique<boost::multi_index::tag<finishedTag>,    
            BOOST_MULTI_INDEX_MEMBER(indexed_struct, unsigned int, iterationFinished)    
        >    
    >    
> cmm_iteration_table;

void setFinished(cmm_iteration_table& table, unsigned int iteration)    
{    
    cmm_iteration_table::index<identifierTag>::type::iterator it;    
    it = table.get<identifierTag>().find(iteration);    
    indexed_struct mod(*it);    
    mod.iterationFinished = 1;    
    table.get<identifierTag>().replace(it, mod);

}

void main()    
{    
    cmm_iteration_table table;

    //add some items with iterationFinished set to 0    
    table.push_back(indexed_struct(30,0));    
    table.push_back(indexed_struct(20,0));    
    table.push_back(indexed_struct(40,0)); 

    //now set iterationFinished to 1 in a random order
    setFinished(table, 30);    
    setFinished(table, 40);    
    setFinished(table, 20);

    //try to get iterator for iterationFinished == 1 and sequenced
    //30-20-40 as added

    std::copy(table.get<finishedTag>().equal_range(1).first, table.get<finishedTag>().equal_range(1).second, std::ostream_iterator<indexed_struct>(std::cout)); //outputs 20,40,30 but 30, 20, 40 is intended

    std::copy(table.begin(), table.end(), std::ostream_iterator<indexed_struct>(std::cout)); //outputs 30,20,40, but would also output items where iterationFinished == 0

} 
```

我想获得一个迭代器对，迭代迭代完成设置为 1 的序列项。

第一个 std::copy 带有迭代完成标志的索引，但顺序不正确（意思是我希望订单作为推入容器的项目）

第二个 std::copy 给出了正确的顺序，但也会打印迭代完成 == 0 的项目。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:24:05.740

尝试使用`boost::filter_iterator`

像这样的东西：

```
struct is_finished 
{
    bool operator()(indexed_struct const& x) { return x.iterationFinished; }
};

typedef cmm_iteration_table::index<identifierTag>::type::iterator iterator_type;

iterator_type it, ite;    
it = table.get<identifierTag>().begin();
ite = table.get<identifierTag>().end();

typedef boost::filter_iterator<is_finished, iterator_type> filter_iter_t;
filter_iter_t f_it(is_finished(), it, ite), f_ite(is_finished(), ite, ite);

std::copy(f_it, f_ite, std::ostream_iterator<indexed_struct>(std::cout)); 
```

# wordpress - 自定义 wordpress 主题呼应画廊短代码

> ID：12411531
> 
> 赞同：0
> 
> 时间：2012-09-13T17:18:35.853
> 
> 标签：wordpress, wordpress-theming

所以我是一个初学者，试图制作一个自定义主题。在一个页面中，我想要一个画廊。上传图片，制作画廊都很好。

当我查看页面时，它只输出简码：

[画廊 orderby="post_date"]

我的 page.php 文件基本上有：

```
<?php $content = get_page( $page_id ) ?>

<div id='content' class='shadow'>
    <div id='innercontent'>
<!---page title-->
<?php echo "<h1>".$content->post_title."</h1><br>" ; ?>

<?php echo $content->post_content ?>
    </div>
</div>

<?php get_sidebar(); ?>

<?php get_footer(); ?> 
```

我真的不明白如何让它正确显示，任何指针将不胜感激。干杯，马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:46:42.690

get_page 返回原始页面数据。有几种方法可以做你想做的事：

**不好的方式：**

```
<?php $content = get_page( $page_id ) ?>

<div id='content' class='shadow'>
    <div id='innercontent'>
<!---page title-->
<?php echo "<h1>".$content->post_title."</h1><br>" ; ?>

<?php echo do_shortcode($content->post_content); ?>
    </div>
</div>

<?php get_sidebar(); ?>

<?php get_footer(); ?> 
```

do_shortcode() 呈现在给定字符串中找到的所有已注册短代码。在这种情况下，您的页面内容将在写入文档之前呈现所有短代码。我说这是“坏”的方式，只是因为它不遵循通常的 Wordpress 格式。这导致我们：

**更好的方法：**

```
<?php if(have_posts()) : while(have_posts()) : the_post(); ?>

<div id='content' class='shadow'>
    <div id='innercontent'>
<!---page title-->
<h1><?php the_title(); ?></h1><br>
<?php the_content(); ?>
    </div>
</div>
<?php endwhile;endif; ?>

<?php get_sidebar(); ?>

<?php get_footer(); ?> 
```

这就是所谓的“[循环](http://codex.wordpress.org/The_Loop)”。它几乎是所有 Wordpress 主题检索所有帖子或页面数据以及对数据库运行查询的标准。

我建议了解它，以及运行 Wordpress 查询以使用[WP Query](http://codex.wordpress.org/Class_Reference/WP_Query)修改循环。这涉及到 Wordpress 的一个更复杂的领域，但从长远来看，它将帮助您弄清楚如何收集您想要在您的主题中检索的所有帖子和页面，这些帖子和页面不是由 Wordpress 的全局变量提供的。

祝你好运。

# php - 如果php中的行数是奇数，如何省略结果数组的最后一行？

> ID：12411537
> 
> 赞同：1
> 
> 时间：2012-09-13T17:19:14.603
> 
> 标签：php

我有一个以下格式的mysql表

```
 -------------------------------------------------------------------------------------------------------------
    | event_id | event_type | machine    | user      |  timeStamp          | Shift   | Reason             | Count |
     -------------------------------------------------------------------------------------------------------------
    | 101      | Up         | Machine1   | operator1 | 2012-09-06 01:03:55 | Shift1  | Start of The shift | 1     |
    | 102      | Up         | Machine2   | operator2 | 2012-09-06 01:03:55 | Shift1  | Start of The shift | 1     |
    | 103      | Up         | Machine3   | operator3 | 2012-09-06 01:03:55 | Shift1  | Start of The shift | 1     |
    | 104      | Down       | Machine1   | operator1 | 2012-09-06 02:03:55 | Shift1  | Break Down         | 1     |
    | 101      | Up         | Machine1   | operator1 | 2012-09-06 02:33:55 | Shift1  | After BD           | 1     |
     ------------------------------------------------------------------------------------------------------------- 
```

通过传递以下查询。

```
 $data = mysql_query("select * from rpt_machine_log where (timestamp between date_sub(now(),INTERVAL 2 WEEK) and now() && (machine='machine$i') && (shift='Shift1') ) AND (reason='Start of The Shift' OR reason='End of Shift') ORDER BY 'even_id'") 
```

我得到以下输出

```
 -------------------------------------------------------------------------------------------------------------
    | event_id | event_type | machine    | user      |  timeStamp          | Shift   | Reason             | Count |
     -------------------------------------------------------------------------------------------------------------
    | 101      | Up         | Machine1   | operator1 | 2012-09-06 01:03:55 | Shift1  | Start of The shift | 1     |
    | 118      | Down       | Machine1   | operator1 | 2012-09-06 06:00:55 | Shift1  | End of The shift   | 1     |
    | 127      | Up         | Machine1   | operator1 | 2012-09-07 01:03:55 | Shift1  | Start of The shift | 1     |
    | 148      | Down       | Machine1   | operator1 | 2012-09-07 02:03:55 | Shift1  | End of The shift   | 1     |
     ------------------------------------------------------------------------------------------------------------- 
```

我通过找出班次结束和班次之星的差异来计算总班次时间，如下面的代码。

```
 while ($row = mysql_fetch_assoc($shifttime{$i})) 
            {
                if(isset($timestamp))
                {
                    $diff_shift_time{$i}= strtotime($row['timestamp']) - strtotime($timestamp);
                    $diff_shift_time_array{$i}[]=$diff_shift_time{$i};
                    unset($timestamp);
                }
                else
                {
                    $timestamp=$row['timestamp'];
                }
            }

            foreach ($diff_shift_time_array{$i} as &$value){
                $Total_shift_time{$i} += $value;
                } 
```

在某些情况下，查询的输出如下。

```
 -------------------------------------------------------------------------------------------------------------
    | event_id | event_type | machine    | user      |  timeStamp          | Shift   | Reason             | Count |
     -------------------------------------------------------------------------------------------------------------
    | 121      | Up         | Machine1   | operator1 | 2012-09-06 06:03:55 | Shift2  | Start of The shift | 1     |
    | 124      | Down       | Machine1   | operator1 | 2012-09-06 01:00:55 | Shift2  | End of The shift   | 1     |
    | 151      | Up         | Machine1   | operator1 | 2012-09-07 06:03:55 | Shift2  | Start of The shift | 1     |
     ------------------------------------------------------------------------------------------------------------- 
```

当我计算总班次时间时，我得到负值，因为我的结果表以 Up 事件结束。

由于计算是连续的 up 和 down( `so the no of rows of the resultant row should always be even`)，所以最后的 up 没有 down 事件来执行计算。

如果行数是奇数，我想删除表的最后一行。

我怎样才能实现它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:22:19.947

检查数组的大小以查看大小是否为奇数：

```
 if (sizeof($arr) % 2 == 1) { 
         // This array is odd sized.
         array_pop($arr); // Remove last element. 
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:29:44.393

尝试

```
 $count = mysql_num_rows($shifttime{$i});
 $remove_last = $count%2==0?false:true;
 $cur_key = 0;
 while ($row = mysql_fetch_assoc($shifttime{$i})) 
            {
                if(TRUE === $remove_last && $cur_key == ($count-1))
                      break;
                $cur_key++;

                if(isset($timestamp))
                {
                    $diff_shift_time{$i}= strtotime($row['timestamp']) - strtotime($timestamp);
                    $diff_shift_time_array{$i}[]=$diff_shift_time{$i};
                    unset($timestamp);
                }
                else
                {
                    $timestamp=$row['timestamp'];
                }
            } 
```

# javascript - 表格中的单元格总和

> ID：12411540
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:19:22.607
> 
> 标签：javascript

我有一个表格，我想将单元格添加在一起

```
 <table width="100%" border="0">
    <tr>
      <td id="a1">5</td>
      <td id="a2">8</td>
      <td id="a3"></td>
    </tr>
    <tr>
      <td id="b1"></td>
      <td id="b2"></td>
      <td id="b3"></td>
    </tr>
</table> 
```

假设我想添加 a1 和 a2 并在 a3 中显示总和，我怎么能在 javascript 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:24:36.390

只需通过它们的 ID 拉取 DOM 对象并获取数字内容并将它们相加。然后取你的新总和并填写第三个单元格中的内容。我也会按 ID 搜索。如果您关心可见输出，您可能需要考虑 NaN。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T19:02:11.673

我很确定它看起来像那样（在 Jage 的建议之后）：

```
v_a1 = parseInt(document.getElementById('a1').innerHtml);
v_a2 = parseInt(document.getElementById('a2').innerHtml);
document.getElementById('a3').innerHtml = ( v_a1 + v_a2 ); 
```

# javascript - 设置倒数计时器并遇到 IE 问题

> ID：12411546
> 
> 赞同：0
> 
> 时间：2012-09-13T17:19:42.753
> 
> 标签：javascript, jquery, internet-explorer

我已经设置了一个倒数计时器，间隔为 1 秒，增量/减量以毫秒为单位。

然后我搜索了能以分钟/秒为单位提供价值的东西。我想出了以下内容：

```
var timer = 130000;
var mins = Math.floor((timer % 36e5) / 6e4),
    secs = Math.floor((timer % 6e4) / 1000); 
```

上面的代码在 Safari、Chrome 和 Firefox 上运行没有问题。当我使用 Internet Explorer 时，它根本不起作用。

是否有另一种适用于所有浏览器的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:26:09.970

尝试删除指数。

```
var timer = 130000;
var mins = Math.floor((timer % 3600000) / 60000),
    secs = Math.floor((timer % 60000) / 1000); 
```

阅读有关***[指数符号](http://en.wikipedia.org/wiki/Scientific_notation)***的更多信息。

如果数字格式为指数符号`a x 10^n`，其中`1<= a < 10`和`n`是具有正值或负值的整数。

例如：

```
36e5
= 36 x 10^5
= 36 x 100000
= 3600000 
```

等等。

# java - Java 和 Bash 外壳

> ID：12411549
> 
> 赞同：0
> 
> 时间：2012-09-13T17:19:46.043
> 
> 标签：java, bash

我希望有人能给我一些建议。我正在用 java 运行一个程序，需要包含一个已经用 bash 编写的函数。老实说，我不确定从哪里开始。

我有一些文件，我用我的 java 程序处理了一些文件（我取出重复项、排序名称等）。我最终得到了其他文件的几个路径。

```
for(String go:parsun){
    pathed="/home/S/Data/"+go+"/Ana/lysis/"+go+"/file.vcf";
    System.out.println("Pathed: " + pathed);
 } 
```

我需要采用这些路径并将它们放入一个 bash 程序中，该程序获取文件的内容并对它们的内部进行一些数学运算。我在互联网上看到你可以做这样的事情来在 java 中运行一个 bash 脚本：

```
Process pro=Runtime.getRuntime().exec("shellfilepath");
BufferedReader read=new BufferedReader(new InputStreamReader(pro.getInputStream()); 
```

但我不确定我是否理解它是如何工作的，或者我将如何将我的文件路径传递给它。此外，另一个考虑因素是我必须稍微修改 bash 脚本以允许它采用这些路径。以前，路径是事先硬编码的。在这方面我还需要一些建议。

这是让 bash 和 Java 一起工作的最佳方式吗？还有其他技术吗？如果没有，有人可以帮助我了解如何使用运行时吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:23:49.667

你可以使用：

```
Process process = Runtime.getRuntime().exec("bash_command " + pathed); 
```

`pathed`文件名将作为参数传入`$1`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:47:13.520

以下看起来像是从 java 运行 shell 脚本的一个很好的介绍：http: [//obscuredclarity.blogspot.com/2011/07/executing-shell-script-from-java.html](http://obscuredclarity.blogspot.com/2011/07/executing-shell-script-from-java.html)

它展示了如何修改您的 shell 脚本以接受参数，以及如何使用`Runtime.exec()`来调用脚本并将参数传递给它。

另请参阅`Runtime`该类的 API：http: [//docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:24:52.097

`Runtime.exec(String)`是一种很好的方法，但是您需要注意脚本的路径是否包含空格。更好的方法是使用[`Runtime.exec(String[])`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#exec%28java.lang.String%5B%5D%29). 这将确保 Java 将您的脚本路径视为一个命令参数，而不是尝试将其拆分为空格。

```
Process process = Runtime.exec(new String[] {shellFilePath}); 
```

另外，请确保包含`#!/bin/bash`在脚本的顶部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T17:25:43.160

你有两个选择：

1.  从 Java 中的 bash 脚本重写逻辑。这将执行得更快且不那么脆弱，但是如果 bash 脚本庞大而复杂，或者没有人能够理解的遗留代码，那么它可能比您想要做的工作更多。
2.  `ProcessBuilder`使用;执行 bash 脚本 [您可以将命令行参数传递给它](https://stackoverflow.com/questions/2144165/execute-with-parameters)。这带来了一系列与两个进程之间的协调有关的问题。如果 bash 脚本不期望任何输入，事情会简单一些，但通常您需要启动脚本，在不同的线程上运行输入和输出处理程序，然后等待终止。如果你从来没有做过，这有点难以做到，尽管网络上有很好的例子。

# mysql - sql Join的聪明写法

> ID：12411551
> 
> 赞同：3
> 
> 时间：2012-09-13T17:19:51.717
> 
> 标签：mysql

我正在探索某人的代码，我发现了这个查询。这个查询正在使用连接获取数据。但是没有使用内连接，外连接，左或右。程序员只需编写此查询。

我发现这是编写查询的 SMART 方式，如果这个查询是正确的？

```
SELECT 
    a.*,b.*,c.*,d.*,e.* 
FROM  
    property_photos a,property_promotions b,properties c, communities d,cities e 
WHERE 
    a.property_id = b.property_id AND 
    a.property_id = c.id AND 
    (b.promotion_id =2 OR b.promotion_id =1) AND 
    a.mainphoto="Y" AND 
    d.id=c.community_id AND 
    e.id = c.city_id AND 
    a.featured_status = 1 
```

这个查询正确吗？

如果这个查询是正确的，我认为，这是编写查询的更好方法，因为它将节省大量磁盘空间，而不是使用左连接/右连接之类的单词，这会使查询变长

聪明的方式

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:21:35.513

是的，没关系。它与 INNER JOIN 相同。

笔记：

> 使用哪种语法？根据 ANSI SQL 规范，最好使用 INNER JOIN 语法。此外，虽然使用 WHERE 子句定义连接确实更简单，但使用显式连接语法可确保您永远不会忘记连接条件，并且它也会影响性能（在某些情况下）。

资料来源：[Sam's - MySQL 速成课程，第 139 页](http://www.techrepublic.com/i/tr/downloads/home/0672327120_chapter_15.pdf)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T17:21:48.710

是的，这称为**隐式** `JOIN`语法。一旦 ANSI-92 定义了**显式** `JOIN`语法，它就不再受欢迎，随着查询变得更加复杂，这种语法更容易阅读。

来自[维基百科](http://en.wikipedia.org/wiki/Join_%28SQL%29)：

SQL 指定了两种不同的语法方式来表达连接：“显式连接表示法”和“隐式连接表示法”。

“显式连接表示法”使用 JOIN 关键字指定要连接的表，使用 ON 关键字指定连接的谓词，如下例所示：

```
SELECT *
FROM employee
INNER JOIN department ON employee.DepartmentID = department.DepartmentID; 
```

“隐式连接表示法”只是在 SELECT 语句的 FROM 子句中列出要连接的表，并使用逗号分隔它们。因此它指定了一个交叉连接，并且 WHERE 子句可以应用额外的过滤谓词（其功能与显式表示法中的连接谓词相当）。

以下示例与上一个示例等效，但这次使用隐式连接表示法：

```
SELECT *
FROM employee, department
WHERE employee.DepartmentID = department.DepartmentID; 
```

# android - 定义的矩形区域中的Android drawText（）

> ID：12411552
> 
> 赞同：2
> 
> 时间：2012-09-13T17:20:02.273
> 
> 标签：android, android-canvas

我目前正在使用以下方法将一些文本绘制到 SurfaceView：

```
canvas.drawText("someText", 0, 0, paint); 
```

但是，如果文本超出屏幕宽度怎么办？是否可以定义一个可以绘制文本的区域？

所以现在当字符串的宽度超过矩形宽度时，文本将被格式化以适合上面的文本等等，例如。

```
"sometext"
"text carried"
"on" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:15:43.563

基于[这个答案](https://stackoverflow.com/questions/2336938/wrapping-long-text-on-an-android-canvas)，我相信这就是[Layout](http://developer.android.com/reference/android/text/Layout.html)子类的用途。根据文档：

> 管理屏幕上可视元素中的文本布局的基类。
> 
> 对于将要编辑的文本，请使用 DynamicLayout，它将随着文本的变化而更新。对于不会更改的文本，请使用 StaticLayout。

每个子类都有一个注释：

> 小部件使用它来控制文本布局。除非您正在实现自己的小部件或自定义显示对象，否则您不需要直接使用此类，或者想直接调用 Canvas.drawText()。

这听起来和你正在做的完全一样。

它基本上是一个替代品`canvas.drawText()`。它可以以这种方式使用：

```
TextPaint tPaint = new TextPaint(paint);
StaticLayout sLayout = new StaticLayout(sText, tPaint, mWidth, widthToFill, Layout.Alignment.ALIGN_CENTER, 1.2f, 1.0f, false);

canvas.save();
canvas.translate(posX, posY);
sLayout.draw(canvas);
canvas.restore(); 
```

# vb.net - 如何诊断 ContractFilter 不匹配？

> ID：12411554
> 
> 赞同：1
> 
> 时间：2012-09-13T17:20:08.197
> 
> 标签：vb.net, wcf, wsdl

我在 VB.NET 中编写了一个服务器，它使用提供程序 WSDL 来提供功能，然后托管我自己的 WSDL，以便他们可以与我通信。在测试中，它一直按预期工作；我可以使用 SOAP-UI 和 WCFTestClient 毫不费力地使用我的托管服务。

但是当我们的提供者尝试连接它时，他收到了这个错误：

> 由于 EndpointDispatcher 的 ContractFilter 不匹配，Yadadada 无法在接收方处理

它们对解决这个问题并不完全有帮助，我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:10:26.333

在一次又一次地辛勤工作之后，我意识到试图访问我的服务的提供者正在使用 ASMX Web 服务，而不是我编写的 WCF 服务。仍然对 WCF 有点生疏，我选择将工作重做为 ASMX 服务，因此我的问题得到了解决。

实习生的磨难和磨难。

# javascript - removeClass 功能无法正常工作

> ID：12411561
> 
> 赞同：1
> 
> 时间：2012-09-13T17:21:15.630
> 
> 标签：javascript, removeclass

我编写了允许用户通过单击来选择和取消选择 div 的函数。现在，我想做的是一个功能，一旦按下*a*，就会取消选择所有内容，但它只会取消选择我的*一些*div。这是代码：

```
var divs = document.getElementsByClassName('fuori');
for(i = 0, j = divs.length; i < j; i++){
 divs[i].addEventListener('click', function(){
    if(!hasClass(this, 'selected')){
    this.className = this.className + " selected";
} else {
    removeClass(this, 'selected');
}
});
} 
```

removeClass 函数是这个

```
function removeClass(ele,cls) {
    if (hasClass(ele,cls)) {
        var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
        ele.className=ele.className.replace(reg,' ');
    }
} 
```

这是取消全选

```
function deselectAll(){
    var selected = document.getElementsByClassName('selected');
    alert(selected.length);
    for (i = 0; i < selected.length; i++){
        removeClass(selected[i], 'selected');
    }
} 
```

通过单击来选择和取消选择可以无缝地工作，但是当我选择一些 div 并按*a*时，它不会取消选择每个 div，而只会取消选择其中的一些。

我该如何解决这个问题？为什么它不起作用？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:24:10.410

尝试更改该`for`循环：

```
for (var i = selected.length; --i >= 0; removeClass(selected[i], 'selected')); 
```

from 的返回值`getElementsByClassName()`是一个 NodeList，而不是一个数组，它是“活动的”。这意味着当您通过删除类来更改 DOM 时，您也在更改列表。

通过倒退，您可以避免问题。你也可以这样做：

```
while (selected.length) removeClass(selected[0], 'selected'); 
```

顺便说一句，您用来删除类的正则表达式可能更简单：

```
function removeClass(ele,cls) {
    var reg = new RegExp('\\b' + cls + '\\b', 'g');
    ele.className=ele.className.replace(reg,' ');
} 
```

在 JavaScript 正则表达式中，`\b`表示“单词边界”。也没有必要调用`hasClass()`，因为如果类字符串不存在，替换将不会做任何事情。

*编辑*——在评论中指出，这不适用于带有嵌入式连字符的类名，这是一种常见的约定。如果你需要处理这个问题，那么我认为这会起作用：

```
function removeClass(ele,cls) {
    var reg = new RegExp('\\b' + cls.replace(/-/g, '\\b-\\b') + '\\b', 'g');
    ele.className=ele.className.replace(reg,' ');
} 
```

或该主题的一些变化。

# c# - 未使用 NHibernate-Caching 选择集合

> ID：12411563
> 
> 赞同：0
> 
> 时间：2012-09-13T17:21:27.683
> 
> 标签：c#, nhibernate, fluent-nhibernate, second-level-cache

我有闲散的实体：

个人公司

然后，有一个实体 PersonCompany 在 Person 和 Company 之间建立关系

人的映射是：

```
public class PersonMap : SubclassMap<Person> {
    public PersonMap() {
        this.Table("Person");
        this.KeyColumn("Id");
        this.HasMany(x => x.PersonCompanys).AsSet().KeyColumn("PersonId").Fetch.Select().Inverse().Cascade.Delete();
    }
} 
```

公司：

```
public class CompanyMap : SubclassMap<Company> {
    public CompanyMap() {
        this.Table("Company");
        this.KeyColumn("Id");
        this.HasMany(x => x.PersonCompanys).AsSet().KeyColumn("CompanyId").Fetch.Select().Inverse().Cascade.None();
    }
} 
```

和个人公司：

```
public class PersonCompanyMap : ClassMap<PersonCompany> {
    public PersonCompanyMap() {
        this.Table("PersonCompany");

        this.Version(x => x.ObjectVersion);
        this.Id(x => x.Id).GeneratedBy.Assigned();
        this.References(x => x.Company).Column("CompanyId").Fetch.Select();
        this.References(x => x.Person).Column("PersonId").Fetch.Select();
    }
} 
```

SecondLevel-Caching 通常被激活，并且对于每个具有约定的实体。还有 PersonCompanys-Collection 的缓存：

```
public class CachableConventions : IClassConvention, IHasManyConvention, IHasManyToManyConvention {
    private static readonly Type[] notCachableTypes = new[] {typeof(Word), typeof(ActivityWord), typeof(DbVersion), typeof(Deleted), typeof(ExchangeSyncState), typeof(Synchronizer), typeof(SerialletterField)};

    public void Apply(IClassInstance instance) {
        if (Array.IndexOf(notCachableTypes, instance.EntityType) >= 0) {
            return;
        }
        instance.Cache.ReadWrite();
    }

    public void Apply(IManyToManyCollectionInstance instance) {
        if (Array.IndexOf(notCachableTypes, instance.ChildType) >= 0) {
            return;
        }
        instance.Cache.ReadWrite();
    }
    public void Apply(IOneToManyCollectionInstance instance) {
        if (Array.IndexOf(notCachableTypes, instance.ChildType) >= 0) {
            return;
        }
        instance.Cache.ReadWrite();
    }
} 
```

现在，我创建了一个新的 Person 并保存了一个新的 Company，然后我将 PersonCompany-Record 添加到 PersonCompanies-Collection。

当我选择创建的 Person 后，PersonCompanys-Collection 将为空。当我在没有 SecondLevel-Caching 的情况下执行相同操作时，PersonCompanys-Collection 包含创建的实体。

有人知道，这里会出什么问题吗？

**编辑 - 附加信息：**

此步骤导致问题：

1.  创建一个新的人`Session.Save(person)`
2.  加载这个人`person = Session.Get(person.Id)`
3.  从 Person with 获取 personCompany `personCompany = person.PersonCompany.FirstOrDefault()`（这将为空）
4.  创建一个新的 PersonCompany-Entry`Session.Save(new PersonCompany(Guid.NewGuid()) {Person = person}))`
5.  加载这个人`person = Session.Get(person.Id)`
6.  现在，`person.PersonCompany`返回一个空列表。

当我不执行第 3 步时，一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T11:06:00.270

1.  *见上*
2.  *见上*
3.  通过 personCompany = person.PersonCompany.FirstOrDefault() 从 Person 获取 personCompany（这将为空）

    *这会将集合初始化为空集合*

4.  使用 Session.Save(new PersonCompany(Guid.NewGuid()) {Person = person})) 创建一个新的 PersonCompany-Entry

    *将在数据库中创建 PersonCompany 记录*

5.  用 person = Session.Get(person.Id) 加载人

    *只会返回缓存的人对象，所以这基本上是“什么都不做”*

6.  现在， person.PersonCompany 返回一个空列表

由于该集合在步骤 3 中被初始化为空集合，因此它将仅返回该集合。nhibernate 不会发出另一个选择来确定是否发生了变化。如果会，它可能会丢弃本地更改或产生冲突，并且效率不高

做

*   `session.Clear();`作为步骤 3b**或**
*   `session.Refresh(person);`作为第 5 步

然后它按预期工作

# db2 - 如何从 DB2 表中选择注释？

> ID：12411574
> 
> 赞同：4
> 
> 时间：2012-09-13T17:22:03.377
> 
> 标签：db2

如何从我的 DB2 数据库中的表中查询表注释？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:30:43.300

查看*SYSCAT.TABLES*目录视图：

```
select remarks from syscat.tables where tabname = 'xyz' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-26T21:17:12.353

要检索 DB2 中对象的注释（或“备注”），请查看目录表。 [DB2 LUW 的 SYSCAT 目录表](http://www.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.sql.ref.doc/doc/r0011297.html)不同于[DB2 z/OS 中的 SYSIBM 目录表](https://www.ibm.com/support/knowledgecenter/SSEPEK_10.0.0/sqlref/src/tpc/db2z_catalogtablesintro.html)。

对于 LUW，以下命令将获得表级注释和列级注释：

```
select tabname, tabschema, remarks from syscat.tables where tabname='TABLENAME'
select tabname, tabschema, colname, remarks from syscat.columns where tabname='TABLENAME' 
```

对于 z/OS，请改用以下查询：

```
select name, creator, dbname, remarks from sysibm.systables where name='TABLENAME'
select name, tbcreator, tbname, remarks from sysibm.syscolumns where tbname='TABLENAME' 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-02-26T14:50:58.507

select colname,remarks from syscat.columns where tabname='T1'

这对你很有用。

# c# - 简单的会员提供者关系

> ID：12411576
> 
> 赞同：1
> 
> 时间：2012-09-13T17:22:18.010
> 
> 标签：c#, asp.net-mvc, relationship, entity-framework-5, simplemembership

在具有默认成员资格提供程序的 ASP.NET MVC 3 中，我将创建与

```
public virtual Guid UserGuid { get; set; }
public virtual MembershipUser User
{
    get
    {
        return Membership.GetUser(UserGuid);
    }
} 
```

在带有 Simple Membership Provider 的 ASP.NET MVC 4 中，与 SMP 兼容的 Membership.GetUser() 和类 MembershipUser 的等效方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T20:50:52.660

你需要网络安全类 [http://www.w3schools.com/aspnet/webpages_ref_websecurity.asp](http://www.w3schools.com/aspnet/webpages_ref_websecurity.asp)

# php - 在服务器上启用 PDO 会影响现有的生产应用程序

> ID：12411581
> 
> 赞同：0
> 
> 时间：2012-09-13T17:22:28.370
> 
> 标签：php, pdo

我有一个带有许多 PHP/MySQL 应用程序的服务器。我正在安装一个需要 PDO 才能运行的开源系统。

我目前没有启用 PDO，但可以在我的托管服务提供商的帮助下轻松做到这一点。

启用 PDO 是否会对我当前运行的 PHP 站点和应用程序产生任何影响或影响？

我看到了启用 PDO 的优势，并计划在未来利用它。新的操作系统系统很好地推动了我在安全方面朝着正确的方向前进。同时，我不能冒险打开 PDO 影响我当前的任何网站或应用程序——这将花费我的 HSP 大约 30-45 分钟来完成。

感谢您对这一步的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:25:02.283

如果您的其他站点/应用程序不利用/使用 PDO（例如在可配置为使用 PDO 或 MySQLi 或旧 mysql_ 的应用程序的情况下），那么它不会产生任何影响。我假设您现有的大多数应用程序尚未使用 PDO，或者它们当前无法正常工作？PDO 不会消除旧的 MYSQL_ 函数。

# nsis - NSIS如何将finish设置为true

> ID：12411582
> 
> 赞同：1
> 
> 时间：2012-09-13T17:22:28.030
> 
> 标签：nsis

我想让我的安装程序在完成安装后退出，而不要求用户单击“完成”。如何将完成设置为真？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:31:17.483

如果 instfiles 页面是最后一页，那么它由[AutocloseWindow](http://anders_k.users.sourceforge.net/public/NSIS/2.46/Manual.html#aautoclosewindow)属性控制，您也可以只调用`Quit`一个部分...

# java - 在 Rhino 中对图像进行 Base64 编码

> ID：12411586
> 
> 赞同：1
> 
> 时间：2012-09-13T17:22:55.480
> 
> 标签：java, javascript, base64, rhino

我正在尝试创建一个构建过程，它将对我的 CSS 文件中的图像进行 base64 编码。我在构建过程中使用 rhino，所以很自然的想法是在我完成 rhino 构建之后才这样做。

到目前为止，我已经完成了图像读取，但卡在了 Base64 部分……我在 JavaScript 中尝试的所有内容都对 byte[] 感到愤怒，而我在 Java 中尝试的所有内容都与 Rhino 有问题。

由于它的犀牛，我限制了我可以使用的库并且不能使用 apache commons。

有人有什么想法吗？

```
prodcss = prodcss.replace(/url\(['"]*([^"')]*)['"]*\)/g, function(match) {
    var path = "build/" + match.substring(4, match.length - 1);

    // Read the image to a byte[]
    var file = new java.io.File(path);
    var bufferedImage = javax.imageio.ImageIO.read(file);
    var raster = bufferedImage.getRaster();
    var data = raster.getDataBuffer().getData();

            var base64 = ''; // Whats the best way to accomplish this ...

    return "url(data:image/png;base64," + base64 + ")";
}); 
```

感谢帮助。

# iphone - 数据模型设计

> ID：12411589
> 
> 赞同：0
> 
> 时间：2012-09-13T17:23:07.543
> 
> 标签：iphone, objective-c, ios, uitableview, data-modeling

我在为我的 iOS 应用程序设计数据模型时有点卡住了。我使用[Parse](https://parse.com/)作为我的后端服务，它有两个数据类：`Songs`和`Ratings`（用户评分）。当我的应用程序启动时，我目前正在对 Parse 进行 5 个单独的查询，这些查询构成了我的 UITableView 的 5 个可能的数据源：

1.  mainQuery - 每日上传的歌曲
2.  topTracksOfTheWeek - 本周评分最高的歌曲
3.  本月热门曲目
4.  topTracksAllTime
5.  userRatedTracks - 用户评分的歌曲

Parse 可以很容易地向查询添加约束以返回所需的数据。但是，我还需要与`userRatedTracks`其他每个查询进行比较，并将其嵌入`userRating`到每个数据源中（如果每个轨道都存在）。（我在这里学会了如何有效地做到这一点：[Objective-c 中的高效循环](https://stackoverflow.com/questions/12397483/efficient-looping-in-objective-c)

我无法弄清楚如何优化或更改此设计以获得更好的性能。所有上述查询都在一个被调用的方法`getDataSource`中调用`viewDidLoad`，然后一个方法`assignDataSource`根据用户选择的数据源（`mainQuery`默认）设置表的数据源数组。理想情况下，应用程序启动`mainQuery`时在主线程中获取，填充表，而其他查询在后台线程中获取。但是，如果用户选择查看`topTracksOfTheWeek`. 何时`getDataSource`调用并且`topTracksOfTheWeek`查询没有优先级。

最简单的方法是在需要时延迟加载每个查询，但我担心与最初加载所有数据相比，这会阻碍应用程序的响应能力。

您可能会说，我是初学者。作为初学者，我发现设计模式非常令人沮丧，因为我总是认为有比我正在做的更好的方式来构建代码。有人对多数据源的设计有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:28:21.127

您是否将结果加载到核心数据中？您可以在后台 MOC 中加载/同步数据并保存到核心数据。当用户启动时，它会拉取本地结果，直到刷新新的解析结果并显示一个指示符，以便用户知道数据正在刷新。查看 Ray Wenderlichs 教程，它几乎完全符合您执行此操作所需的内容。甚至使用 Parse

[http://www.raywenderlich.com/15916/how-to-synchronize-core-data-with-a-web-service-part-1](http://www.raywenderlich.com/15916/how-to-synchronize-core-data-with-a-web-service-part-1)

# java - 处理 REST Web 服务 url 中单个查询参数的多个值并使用休眠条件处理它们

> ID：12411592
> 
> 赞同：3
> 
> 时间：2012-09-13T17:23:24.140
> 
> 标签：java, web-services, hibernate, rest, criteria

我有一个休息网络服务，它将接受“名称”并使用此名称从数据库中获取令牌并将令牌返回。其余网络服务的 url 将是：

```
http://localhost:8080/NameService/Tokens?name=Bob 
```

在serviceLayer中，我的方法如下：

```
@GET
@Path("Tokens")
@Produces("application/xml")
public JAXBElement<GetToken> getokenByName(@QueryParam("name") final String name ) {

    if(name!=null){
        // use hibernate criteria to fetch the records from db
        Criteria crit = getSession().createCriteria(getPersistentClass());
        crit.add(Restrictions.eq("name",name))
    }
} 
```

现在我们的需求发生了变化，客户端可以在请求中同时发送多个名称。例如，给我令牌 where name = "bob" or "brendon" or "aaron" 的 URL 可能是这样的：

```
http://localhost:8080/NameService/Tokens?name=Bob,Aaron,Brendon 
```

发送的姓名数量是可变的。它可以是 1 或 2 或 3 等等。关于如何通过调整上面显示的代码（适用于一个名称）来实现这种拆分并将它们作为服务层中的 OR 条件传递给休眠条件的任何想法？

一种方法可能是`StringUtils`使用分隔符（逗号）解析不同的名称，然后形成一个列表以及如何将列表中的名称添加到条件限制中。但不确定这是否有效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:45:56.607

实际上，最简单的方法是使用`split(",")`.

您还可以将查询参数设置为 a`List<String>`并传递如下参数：

```
http://localhost:8080/NameService/Tokens?name=Bob&name=Aaron&name=Brendon 
```

或者您也可以实现自己的[`StringReaderProvider`](http://jersey.java.net/nonav/apidocs/1.0.3/jersey/com/sun/jersey/spi/StringReaderProvider.html)并将其注册到球衣。

**对于您的评论：**您应该使用析取。

```
@GET
@Path("Tokens")
@Produces("application/xml")
public JAXBElement<GetToken> getokenByName(@QueryParam("name") final String names) {
    if (names != null) {
        Criteria crit = getSession().createCriteria(getPersistentClass());
        Disjunction disjunction = Restrictions.disjunction(); 
        for (String name: names.split(",")) {
            disjunction = disjunction.add(Restrictions.eq("name", name));
        } 
        crit.add(disjunction);
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:45:30.323

您拆分字符串的想法将起作用。您还可以查看一些 REST 服务在行业中是如何完成的。检查[linkedin人员搜索API](https://developer.linkedin.com/documents/people-search-api)

[`@Path`](http://jackson.codehaus.org/javadoc/jax-rs/1.0/javax/ws/rs/Path.html)使用正则表达式检查注释的灵活性。

# c# - WPF 等效于 Windows 窗体位置

> ID：12411594
> 
> 赞同：3
> 
> 时间：2012-09-13T17:23:34.160
> 
> 标签：c#, wpf, winforms, location

在 Windows 窗体中，我可以通过将`Location`属性设置为`Point`. 是否可以在 WPF 中做类似的事情？

目前我知道我可以设置 WPF 窗口`Left`和`Top`属性来重新定位它，但是是否可以通过给它坐标来设置位置，比如一个点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:28:32.473

你没看错，Winforms 中 Location 属性的唯一等价物是 WPF 中的 Left 和 Top 属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T17:32:26.850

`Point`如果您更喜欢使用对象，您始终可以创建自己的辅助方法。

```
public Point Location
{
  get
  {
    return new Point(Left, Top);
  }
  set
  {
    Left = value.X;
    Top = value.Y;
  }
} 
```

# .net - 从字符串末尾查找第一次出现

> ID：12411599
> 
> 赞同：0
> 
> 时间：2012-09-13T17:23:45.060
> 
> 标签：.net, regex

是否可以构建一个正则表达式来定位从字符串末尾开始的模式的第一次出现？

我想找到第一个关闭的 html 标记，该标记前面至少有 3 个普通的非 html 标记字符。

例如，以下字符串包含许多结束 html 标记。我想定位`ury.</`，因为它至少包含三个非 html 标记字符。

```
...to us the whole treasury.</span><br /><br /> </p></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:33:38.947

`</`要找到前导 3+“非标记”字符的最后一次出现，请使用正则表达式模式

```
[^<>]{3)<\/(?!.*[^<>]{3}<\/) 
```

它使用负前瞻`(?!.*[^<>]{3}<\/)`来确保前面不会再发生其他事件。

# php - PHP / MySQL 发布具有不同布局的内容

> ID：12411611
> 
> 赞同：0
> 
> 时间：2012-09-13T17:24:41.313
> 
> 标签：php, mysql, html, wysiwyg

我正在使用 PHP 和 MySQL 构建一个包含新闻管理系统的网站

该系统完美运行。基本上我将记录插入数据库，然后使用格式化的 .php 脚本输出它们，以便内容看起来不错。

**我的问题**：这样发布的新闻，每次只能以相同的方式输出，我的意思是，你可以输出这样的图像：

![图 1](../Images/e9c34b32ba49b116f092f9d3b4d6cd38.png)

然后所有新闻将具有与检索数据库记录的 .php 脚本相同的上述布局。

**我的问题**：是否有任何简单的方法/系统/任何东西，允许用户每次以不同的布局发布内容？也许是这样的：

![图 2](../Images/d1b5994dbd1f8f820cef88ecd02c7060.png)

我使用 WYSIWYG 编辑器来发布新闻……但这只允许用户更改字体颜色、对齐、左、右文本对齐、插入图像等等……

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:34:30.497

我会结合使用 php 条件和 css 样式：

一个简单的例子（使用三元运算符保持简短......）：

php:

```
$title_class = empty($date) ? '' : 'with_date';
echo "<h1 class='{$title_class}'>{$title}</h1>"
echo empty($date) ? '' : "<span class='date'>{$date}</span>";
// etc. 
```

CSS：

```
h1 {
  text-align: center;
}
h1.with_date {
  text-align: left;
  float: left;
}
.date {
  float: right;
}
// etc. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:27:42.157

您想将布局预加载到所见即所得吗？如果是这样，您可以简单地创建一个包含您的布局的新数据库表，并在用户创建新文章时将它们回显到所见即所得。

# apache - .htaccess 用于站点迁移

> ID：12411618
> 
> 赞同：1
> 
> 时间：2012-09-13T17:24:53.783
> 
> 标签：apache, .htaccess, mod-rewrite, rewrite

我们正在迁移到一个新的服务器结构，我需要一些有关 htaccess 的帮助。我是 php 程序员，但绝不是 apache 专家。

这是简单的解释：

*   我需要将 www.oldsite.com 的根目录重定向到根目录 www.newsite.com。

*   特定目录 www.oldsite/dir1 重定向到新站点上的子域，如 newdomain.newsite.com

*   其他一切 www.oldsite.com/whatever/ 需要转到 apps.newsite.com/whatever/

我现在拥有的是：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteRule / http://www.newsite.com [L,R=301]
RewriteRule (.*)dir1/ http://newdomain.newsite.com [L,R=301]
RewriteRule (.*)$ http://apps.newsite.com/$1 [L,R=301] 
```

但它没有像我想要的那样工作......

无论如何，任何和所有的帮助将不胜感激。

谢谢，-Orallo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:29:10.087

您的第一次重写导致了您的问题，基本上重定向了所有内容。

这应该做你想要的：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteRule ^/?$ http://www.newsite.com [L,R=301]
RewriteRule ^/?dir1/(.*) http://newdomain.newsite.com/$1 [L,R=301]
RewriteRule ^/?(.*)$ http://apps.newsite.com/$1 [L,R=301] 
```

我建议将这组重写规则放在该主机的实际 Apache conf 文件中并关闭`AllowOverride`，因为它会提供更好的性能。由于您实际上不再使用旧站点的 web 目录，因此没有理由让 Apache 服务器在该目录（以及可能仍然存在的任何其他子目录）中查找 .htaccess 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:29:16.263

使用 mod_alias，您可以将其放在 server/vhost 配置或 htaccess 文件中（**在 oldsite.com 的文档根目录中**）：

```
Redirect 301 /dir1 http://newdomain.newsite.com
RedirectMatch 301 ^/(.+)$ http://apps.newsite.com/$1
RedirectMatch 301 ^/$ http://www.newsite.com 
```

至于 mod_rewrite，您需要从重写规则中删除前导斜杠，因为您在 htaccess 文件中使用它们：

```
RewriteEngine On
RewriteBase /
RewriteRule ^$ http://www.newsite.com [L,R=301]
RewriteRule ^dir1/(.*) http://newdomain.newsite.com/$1 [L,R=301]
RewriteRule ^(.+)$ http://apps.newsite.com/$1 [L,R=301] 
```

# delphi - Delphi 7将参数从整数更改为shortint

> ID：12411623
> 
> 赞同：0
> 
> 时间：2012-09-13T17:25:14.377
> 
> 标签：delphi

我遇到一个问题，在 IDE 中关闭和重新打开文件会将我的数据集的参数 (tparam) 从整数更改为短整数。如果我将它们更改为整数，它似乎可以保存，但是一旦 lcosed 并重新打开它就会返回为 shortint。 **Delphi 有没有办法将参数从 Integer 更改为 Shortint**？

我在这里发现了一个类似的问题 [http://www.delphigroups.info/2/1/284088.html](http://www.delphigroups.info/2/1/284088.html)

这似乎是一个错误，但有**一些时尚的解决方法吗？**升级Delphi版本不是我现在可以做的。（第二次编辑中概述的复制步骤）

编辑：

如果将值类型更改为整数，只需在表单上放置一个带有参数的 sql 语句，就会发生这种情况。保存并重新打开值类型然后是shortint。

再次编辑：

在 Delphi 7 中，创建新应用程序。在表单上放置一个 TQuery。将 SQL 脚本编辑为类似于 'select * from table where id = :idnumber. 接下来编辑参数。选择 idnumber 并将 VALUE.TYPE 更改为 Integer。此时您可以保存文件并关闭。当您重新打开文件时。然后再次转到参数选择 idnumber 它将保持类型 ftInteger 但 value.type 将是 Shortint。这是我希望保留为整数的部分，但不幸的是正在转换为 shortint。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T20:39:14.620

我可以解释您所看到的行为，这不是错误。（顺便说一句，您的问题具有误导性。根据编辑和评论，您的实际问题是“Delphi 7 将 Parameter.Value.Type 从整数更改为短整数”，这根本不是一回事。）

您正在检查 的`Value.Type`，`Param.Value`它未存储在`.dfm`文件中。`Value.Type`当表单从 流入`dfm`并被`Value`读取时设置，或者`Value`在运行时设置。

我可以通过完全按照您的步骤来证明这一点：

将 TQuery 拖放到新的空白表单上。将一些 SQL 添加到`TQuery.SQL`. 我用过`SELECT Id FROM SomeTable WHERE Id = :id`。

在对话框出现时单击`...`，`TQuery.Params`然后单击`id`参数。`Parameter Editor`单击`Value`对象检查器中的 ，然后将 更改`Value.Type`为`Integer`。

保存项目和表单，然后关闭它们。重新打开项目，右键单击表单，然后`View as Text`从上下文菜单中选择。您将看到该组件的以下`Query1`内容：

```
object Query1: TQuery
  SQL.Strings = (
    'select id from sometable where id = :id')
  Left = 152
  Top = 80
  ParamData = <
    item
      DataType = ftInteger
      Name = 'id'
      ParamType = ptInput
      Value = 0
    end>
end 
```

请注意，在 中`ParamData`，没有`Value.Type`; 那是因为它是在`Value`读取时设置的，而不是在保存表单时存储的。

现在再次右键单击，然后选择`View as Form`。回到`Query1.Parameters`，编辑`Value`，并将其设置为一个高数字（我使用`123456789`）。

保存表单，然后`View as Text`再次保存。注意`Query1`信息：

```
object Query1: TQuery
  SQL.Strings = (
    'select id from sometable where id = :id')
  Left = 152
  Top = 80
  ParamData = <
    item
      DataType = ftInteger
      Name = 'id'
      ParamType = ptInput
      Value = '123456789'
    end>
end 
```

请注意，仍然没有存储`Value.Type`的 . 检查 Object Inspector 的`ValueType`，它现在说`String`，即使 Parameter.DataType 仍然是`ftInteger`。这是由 IDE 的流机制看到引号并相应地设置引起的`Value.Type`。

同样，它对您正在运行的应用程序没有影响。IDE中的`Value.Type`无关紧要。

有趣的旁注：看到上面提到的之后，如果再次将表单视为文本，请删除`Value.Type`属性周围的字符，然后再检查参数的 ，它变成了。这进一步表明它是在流式处理过程中设置的，并且在设计时没有任何意义。`String``'``Value``View as Form``Value.Type``Integer`

# c++ - 用于包装实际实现的 C++ 适配器类

> ID：12411625
> 
> 赞同：2
> 
> 时间：2012-09-13T17:25:16.103
> 
> 标签：c++

目标：“包装”IPC 通信总线的实际实现，以允许客户端与通用 API 接口，并允许将来可能替换底层 IPC 实现。

这是我想出的。注意：我是一名 C 人，正在转向 C++。有没有更好的方法来解决这个问题？

注意：我希望客户端仅与我的包装器/接口交互，并且不需要包含任何协议特定代码或设置包含路径以实现特定于头文件。

我已经浏览了设计模式。我想我想要一个适配器/包装器模式，但是 Interface_impl 的顺序：公共接口继承需要客户端为特定的实现设置包含路径。

接口/包装器是 UMSConnector，它调用实际的实现 UMSConnector_impl。

```
// "interface"
class UMSConnector {
public:
    static UMSConnector * instance(const string& name) {
        static UMSConnector *pInstance;
        if( ! pInstance ) {
            pInstance = new UMSConnector(name);
            return pInstance;
        }
        return pInstance;
    }

    // interface API to be implemented by UMSConnector_impl
    bool addEventHandler(string event);

private:
    class UMSConnector_impl;
    UMSConnector_impl *pImpl;
    Logger log;
    string name;

    UMSConnector(const string& name);
    ~UMSConnector();
    UMSConnector(UMSConnector const& ) {};  // copy constructor
    void operator=(const UMSConnector&) {};  // assignment constructor
};

UMSConnector::UMSConnector(const string& name)
             : name(name) {
  LOG_TRACE(log,"called");
  pImpl = new UMSConnector_impl();
}

UMSConnector::~UMSConnector() {
  LOG_TRACE(log,"called");
  delete pImpl;
  pImpl = NULL;
}

bool UMSConnector::addEventHandler(string event)
{
    if( pImpl ) {
        return pImpl->addEventHandler(event);
    }
    return false;
}

// "implementation"
class UMSConnector::UMSConnector_impl {
public:
    bool addEventHandler(const string& event);

private:
    Logger log;
};

bool UMSConnector::UMSConnector_impl::addEventHandler(const string& event)
{
  LOG_TRACE(log,"UMSConnector_impl::addEventHandler: event=%s",event.c_str());
  return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:38:43.953

您需要的成语是[PIMPL (pointer-to-implementation)](http://en.wikibooks.org/wiki/More_C++_Idioms/Handle_Body#Pointer_To_Implementation_.28pImpl.29)。只需将`UMSConnector::addEventHandler`实现设置为调用`pImpl->addEventHandler()`并将实现移动`UMSConnector::UMSConnector_impl`到`implementation.cpp`文件中并包含`implementation.h`在`interface.cpp`文件中即可。这应该可以按您的意愿工作。

# binary - 在第一个“1”之前设置所有位

> ID：12411632
> 
> 赞同：3
> 
> 时间：2012-09-13T17:25:48.527
> 
> 标签：binary, integer, bit-manipulation

假设一个 32 位无符号整数（可推广到任何大小的答案当然更好）。

该整数可以假定为 2 的幂，因此**只设置了一位**。我想设置整数中的所有位，除了那些低于设置位的位。因此（为简洁起见，使用 8 位整数）`00001000`将变为`11111000`.

这当然可以通过找到一个设置位然后遍历更高位并设置它们来完成。假设`highest_set`返回最高设置位的位置：

```
uint32_t f(uint32_t x)
{
  int n = highest_set(x);
  for (int i = 31; i != n; --i) {
      x |= 1 << i;
  }
  return x;
} 
```

然而，运行时间`f`确实取决于 的值`x`，我觉得有一种更聪明的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:29:29.353

从概念上讲，一个简单的事情是先取`x-1`然后用`0xffffffff`. 像 harold 在下面的评论中所做的那样编写它`~(x-1)`可以处理不同大小的整数，而无需更改您正在使用的 XORing。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:40:34.380

右移日志（值），或位掩码为 1，左移日志（值）。对于任何输入，这应该是具有相同运行时间的通用解决方案，但不能保证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:33:11.573

```
uint32_t f(uint32_t x)
{
  bool bitset=false; //C++
  for (int i =0; i<sizeof(int); i++) {
     if(bitset) //After the first 1
        {  x |= 1 << i; } 
      else
        {
          if(x&(1<<i))
            bitset=true; //if 1 found then the flag is raised
        }

  }
  return x;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T03:58:34.223

你只需要**取两个的补码**

```
x = -x; 
```

无论 x 是有符号还是无符号，它都有效

为什么？因为您所做的本质上**是将数字转换为 2 的补码的快速方法**

> 手动将二进制数转换为其二进制补码的捷径是*从最低有效位*(LSB) 开始，然后*复制所有零*（从 LSB 到最高有效位）直到达到第一个 1；然后复制那个 1，并**翻转所有剩余的位**
> 
> [https://en.wikipedia.org/wiki/Two%27s_complement#Working_from_LSB_towards_MSB](https://en.wikipedia.org/wiki/Two%27s_complement#Working_from_LSB_towards_MSB)

您只有**一位 set**，因此当您复制所有零位并反转剩余的零位时，您会得到其 2 的补码。您可以在示例中看到它：`00001000 = 8, 11111000 = -8`. 其他一些例子：

```
00010000 = 16, 11110000 = -16
00100000 = 32, 11100000 = -32
01000000 = 64, 11000000 = -64 
```

* * *

如果 x 是有*符号*类型，那么它很容易理解。在*无符号*类型的情况下，显然没有负值，因此它基于[C 标准如何定义无符号操作来工作](https://stackoverflow.com/q/8026694/995714)

> 涉及无符号操作数的计算永远不会溢出，因为无法由结果无符号整数类型表示的结果会以比结果类型可以表示的最大值大一的数字为模减少。

这只是[2 的补码的另一种定义](https://en.wikipedia.org/wiki/Two%27s_complement#Subtraction_from_2N)，因为*大于可以由结果类型*（即在这种情况下）表示的最大值的一个是 2 ^N。对无符号值求反总是会在 C 中产生其二进制补码，即使有符号类型是符号幅度或一个补码`UINT***N***_MAX + 1`

当然，`x = -(int32_t)x;`如果您想输入更多内容，也可以将其转换为有符号类型。你还有另一个解决方案

```
x = ~x + 1; // by 2's complement definition 
```

* * *

一个*易于理解*的解决方案

```
while (!(x & 0x80000000))
    x |= x << 1; 
```

这段代码不需要像上面的许多解决方案一样一直循环 32 次

# sql - Access 2007：从多个表中计数的查询

> ID：12411633
> 
> 赞同：0
> 
> 时间：2012-09-13T17:25:49.550
> 
> 标签：sql, ms-access-2007

我可能有十年没有使用 Access，所以如果这很简单，我很抱歉。我有三张桌子。表 1 - 用户信息 表 2 - 报告信息 表 3 - 更正信息。

表 2 和表 3 通过表 1 链接在一起。（表 2 使用表 1 的 id，表 3 使用表 1 的缩写名称）。

我需要一个查询，按日期计算每个用户的所有报告，并按日期按用户计算更正信息。

示例查询：

-用户-| -日期- | -表1计数- | -表2计数-

用户 1 | 2012 年 8 月 1 日 | 33 份报告 | 2 修正

用户 2 | 2012 年 8 月 1 日 | 4 份报告 | 0 修正

用户 1 | 2012 年 8 月 2 日 | 0 份报告 | 1 更正

（零表示未找到记录，但在另一个表中找到了该日期的记录）。

到目前为止，这是我对 SQL 的了解。

```
SELECT 
    tblUsers.userfullname, Count(txtReports.reportnumber) AS CountOfreportnumber,
    Count(tblRawData.reportnum) AS CountOfRawReport
FROM (tblUsers INNER JOIN txtReports ON tblUsers.userID = txtReports.userID) 
    INNER JOIN tblRawData ON tblUsers.userabbrev = tblRawData.username  
GROUP BY tblUsers.userfullname; 
```

但它给我的只是部分匹配，每列中的总数相同。

任何指针？

更新：示例数据：tblUsers：

```
userID,userfullname,userabbrev
850,Test ML,test-ml
817,Test RL,test-rl
872,Test LS,test-ls
1071,Test MF,test-mf
934,Test TF,test-tf
796,Test JK,test-jk
1073,TEST RA,test-ra
779,TEST AW,test-aw
852,TEST EP,test-ep
987,TEST MM,test-mm
938,TEST SS,test-ss
19,TEST MT,test-mt
1095,TEST JL,test-jl
780,TEST LN,test-ln
909,TEST JR,test-jr
290,TEST BY,test-by
892,TEST JC,test-jc
920,TEST TR,test-tr
894,TEST PW,test-pw
873,TEST JR,test-jr
827,TEST AC,test-ac
783,TEST RP,test-rp
829,TEST AP,test-ap 
```

txt报告

```
userID,reportdate,reportnumber
850,8/13/2012,823
817,8/13/2012,835
872,8/13/2012,841
872,8/13/2012,842
872,8/13/2012,850
1071,8/13/2012,862
934,8/13/2012,863
796,8/13/2012,800
796,8/13/2012,803
1073,8/13/2012,804
1073,8/13/2012,808
1073,8/13/2012,809
1073,8/13/2012,815
1073,8/13/2012,816
796,8/13/2012,817
779,8/13/2012,818
779,8/13/2012,819
779,8/13/2012,820
779,8/13/2012,821
779,8/13/2012,822
850,8/13/2012,824
850,8/13/2012,826
850,8/13/2012,827
852,8/13/2012,829
852,8/13/2012,830
850,8/13/2012,831
817,8/13/2012,832
817,8/13/2012,833
987,8/13/2012,834
1095,8/13/2012,836
850,8/13/2012,837
872,8/13/2012,839
852,8/13/2012,840
987,8/13/2012,843
852,8/13/2012,845
852,8/13/2012,846
850,8/13/2012,847
817,8/13/2012,848
938,8/13/2012,849
817,8/13/2012,851
850,8/13/2012,853
817,8/13/2012,854
19,8/13/2012,855
780,8/13/2012,856
780,8/13/2012,857
909,8/13/2012,858
1071,8/13/2012,859
19,8/13/2012,860
909,8/13/2012,861
290,8/13/2012,838
892,8/13/2012,844
987,8/13/2012,852
892,8/14/2012,864
872,8/14/2012,866
892,8/14/2012,869
872,8/14/2012,870
872,8/14/2012,871
872,8/14/2012,872
934,8/14/2012,880
850,8/14/2012,865
850,8/14/2012,867
850,8/14/2012,868
1095,8/14/2012,873
850,8/14/2012,874
817,8/14/2012,875
850,8/14/2012,876
1095,8/14/2012,877
852,8/14/2012,881
852,8/14/2012,882
1095,8/14/2012,885
920,8/14/2012,919
920,8/14/2012,922
19,8/14/2012,879
872,8/14/2012,878
894,8/15/2012,884
873,8/15/2012,886
827,8/15/2012,889
796,8/15/2012,891
796,8/15/2012,892
796,8/15/2012,893
852,8/15/2012,883
852,8/15/2012,887
852,8/15/2012,888
873,8/15/2012,890
783,8/15/2012,895
783,8/15/2012,896
852,8/15/2012,902
808,8/15/2012,904
872,8/15/2012,914
872,8/15/2012,915 
```

tblRawData

```
reportnum,username,reportdate
832,test-rl,08/13/12
837,test-mf,08/13/12
797,test-jk,08/13/12
811,test-ra,08/13/12
838,test-by,08/13/12
739,test-ra,08/13/12
817,test-jk,08/13/12
818,test-aw,08/13/12
819,test-aw,08/13/12
820,test-aw,08/13/12
821,test-aw,08/13/12
822,test-aw,08/13/12
852,test-mm,08/14/12
857,test-ln,08/14/12
753,test-ap,08/14/12
868,test-mf,08/14/12
745,test-ra,08/14/12
765,test-ra,08/14/12
748,test-ra,08/14/12
766,test-ra,08/14/12
794,test-ra,08/14/12
807,test-ra,08/14/12
812,test-ra,08/14/12
814,test-ra,08/14/12
815,test-ra,08/14/12
767,test-ra,08/14/12
768,test-ra,08/14/12
804,test-ra,08/14/12
873,test-jl,08/14/12
875,test-rl,08/14/12
837,test-mf,08/15/12
881,test-ep,08/15/12
883,test-ep,08/15/12
498,test-jr,08/15/12
887,test-ep,08/15/12
890,test-jr,08/15/12 
```

通过添加按日期过滤进行更新。

```
SELECT u.userfullname, nz(rd.rawcount,0) AS rawcount, nz(rp.rptcount,0) AS rptcount
FROM (tblUsers AS u LEFT JOIN (SELECT username, reportdate, count(reportnum) AS rawcount FROM tblRawData GROUP BY username, reportdate)  AS rd ON u.userabbrev = rd.username) LEFT JOIN (SELECT userID, reportdate, count(reportnumber) AS rptcount FROM txtReports GROUP BY userID, reportdate)  AS rp ON u.userID = rp.userID
WHERE (((rd.reportdate)>=[start date] And (rd.reportdate)<=[end date])) OR (((rp.reportdate)>=[start date] And (rp.reportdate)<=[end date])); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:29:19.807

尝试：

```
SELECT tblUsers.userfullname, tr.CountReport, td.CountRaw
FROM (tblUsers 
LEFT JOIN (
    SELECT r.userID, Count(r.reportnumber) AS CountReport
    FROM txtReports r
    GROUP BY r.userID)  AS tr 
ON tblUsers.userID = tr.userID) 
LEFT JOIN (
    SELECT tblRawData.username, Count(tblRawData.reportnum) AS CountRaw
    FROM tblRawData
    GROUP BY tblRawData.username)  AS td 
ON tblUsers.userabbrev = td.username 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:00:21.493

您需要获取每个表的计数，然后加入它们并显示它们，否则您将得到一团糟，并且您的计数都不正确。

```
SELECT u.userfullname, nz(rd.rawcount,0) AS rawcount, nz(rp.rptcount,0) AS rptcount 
FROM (tblUser AS u 
    LEFT JOIN (SELECT username, count(reportnum) AS rawcount FROM tblRawData GROUP BY username) AS rd 
    ON u.userabbrev = rd.username) 
    LEFT JOIN (SELECT userID, count(reportnumber) AS rptcount FROM txtReports GROUP BY userID) AS rp 
    ON u.userID = rp.userID
WHERE (Not p.Payments Is Null) OR (Not n.Notes Is Null); 
```

# php - 警告：simplexml_load_file()

> ID：12411634
> 
> 赞同：0
> 
> 时间：2012-09-13T17:25:50.057
> 
> 标签：php, simplexml

我有这个代码

```
<?php

$url = "_configurations/right_sidebar_links.xml";
$xml = simplexml_load_file($url);

foreach($xml->links as $links)
{
    echo "<li>";
    echo "<a href='".$links->url."'>";
    echo $links->name."</a></li>";
}

?> 
```

从另一个文件加载 xml 链接，它适用于没有任何奇怪字符的链接，但是当你输入带有奇怪字符的长链接时，它会给出一个错误说

```
Warning: simplexml_load_file() [function.simplexml-load-file]: _configurations/right_sidebar_links.xml:17: parser error : EntityRef: expecting ';' in .../includes/loadLinks.php on line 8 
```

任何帮助将非常感激。

这是链接的示例

[http://www.exampe.com/gp/product/B007RT6OZW/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B007RT6OZW&linkCode=as2&tag=backpaininfor-20](http://www.exampe.com/gp/product/B007RT6OZW/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B007RT6OZW&linkCode=as2&tag=backpaininfor-20)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:29:03.033

您的 XML 文件的内容无效。确保正确编码（即`&`is `&amp;`）和/或`CDATA`在必要时使用标签。

如果您在现代浏览器中打开 XML 文件，它们通常会为您提供关于错误在哪里（行和字符）的详细答案。

另外，请参阅[此 hack](https://stackoverflow.com/a/4540969/763468)

# batch-file - 在批处理文件中测试 ERRORLEVEL 不会返回预期结果

> ID：12411635
> 
> 赞同：0
> 
> 时间：2012-09-13T17:26:04.200
> 
> 标签：batch-file

我有一个 Windows 7 x64 系统，我想让一个批处理文件执行一个程序，然后测试进程的退出代码并根据该退出代码执行一些操作。例如：

```
@rem sets the process exit code to 1\. should print "success!" actually prints nothing
cmd /c exit 1
if NOT ERRORLEVEL 0 echo success!

@rem prints "success!" as expected
cmd /c exit 1
if errorlevel 1 echo success!

@rem prints "failure!" even though the exit code is 0
cmd /c exit 0
if errorlevel 1 echo failure!    

@rem prints "ERRORLEVEL=1" as expected
cmd /c exit 1
echo ERRORLEVEL=%ERRORLEVEL% 
```

我需要做什么才能从批处理文件中获得预期的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:05:54.903

`NOT ERRORLEVEL 0`不像你想象的那样工作

首先，它评估`ERRORLEVEL 0`
由于错误级别为**0 或更大**，因此评估为`TRUE`

然后它评估`NOT`
`NOT TRUE`is `FALSE`，这意味着您的第一条消息不会被打印。

第三个结果没有回应失败，所以我不知道你的系统出了什么问题。为了检查错误级别，我`echo ERRORLEVEL=%ERRORLEVEL%`在每个退出语句之后

# file-io - 如何在 VxWorks shell 中写入文件

> ID：12411640
> 
> 赞同：1
> 
> 时间：2012-09-13T17:26:37.743
> 
> 标签：file-io, vxworks

我正在尝试使用类似的东西在 VxWorks 中编写文件

```
saveFd = open("myfile.txt",0x102, 0777 )
oldFd = ioGlobalStdGet(1)
ioGlobalStdSet(1, saveFd)
d 0xfea00100, 4 
ioGlobalStdSet(1, oldFd) 
```

但我无法执行文件创建/写入。这是输出：

```
-> saveFd = open("myfile.txt",0x102, 0777 )
saveFd = 0x1fbfb040: value = -1 = 0xffffffff
-> ioGlobalStdSet(1, saveFd)
dvalue = -1 = 0xffffffff 
```

如何创建具有所需输出的文件？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T09:40:43.290

传递给“open”的“flags”参数有问题。正确的访问类型：

```
O_RDONLY (0)    (or READ)   - open for reading only.
O_WRONLY (1)    (or WRITE)  - open for writing only.
O_RDWR (2)  (or UPDATE) - open for reading and writing.
O_CREAT (0x0200)        - create a file. 
```

传递给 open 的标志应该“或”标志。像这样：

`O_CREAT | O_RDWR = 0x202`

使用此参数，您可能会得到类似这样的信息（如果您正确连接了主机 ftp）：

```
-> saveFd = open("myfile.txt",0x202,0777)
New symbol "saveFd" added to kernel symbol table.
saveFd = 0x8a9bf90: value = 5 = 0x5
-> 
```

（确保您在 ftp 主机服务器上授予了写入权限。）

# web-applications - Web 应用程序的 OAuth 实现

> ID：12411642
> 
> 赞同：0
> 
> 时间：2012-09-13T17:27:09.287
> 
> 标签：web-applications, architecture, login, oauth

设置是这样的：我有一个为组织构建的 Web 应用程序。这些组织可以有一个用户名和密码登录到他们的定制系统，或者他们可以有多个用户名和密码，在他们的系统中具有不同的权限。我们一直在我们自己的数据库中存储用户名和密码，但正在研究使用 OAuth，以便用户可以通过他们的 Twitter、Facebook、GMail 等凭据登录到他们的系统（这样我们就可以访问他们的个人资料、联系人等）所有用户都来到同一个登录页面。

**我的问题是这样的：**

使用 OAuth，我如何让他们以正确的权限登录到正确的系统？

他们会正常登录（使用我的网络应用程序的凭据），然后需要一个地方来指定“我想允许 Twitter 帐户“Example123”访问这个系统吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:55:03.430

当前数据库中的每个用户名和密码都将对应于未来数据库中每个服务提供商的用户 ID。例如：

```
user_id | group_id | username | password | twitter_user_id | facebook_user_id | google_user_id
1001    | 3003     | fred     | abc123   | aaaaaaaa        | bbbbbbbb         | ccccccc 
```

通过这样的结构，您可以继续使用现有的登录机制，并允许用户将他们的 facebook/twitter/etc 帐户链接到他们当前的登录名。我假设您的数据库中已经设置了某种形式的用户 ID 和组 ID，但如果没有，那么我认为这将是最简单的方法。

有很多不同的方法可以将现有帐户链接到用户的各种服务提供商帐户 - 您可以选择一种适合您现有结构并为您的用户提供最无缝体验的方法。您网站的一种可能的 oauth 流程，用户可以将新的服务提供商链接到他们的帐户，这可能是：

*   用户导航到您网站上的登录屏幕
*   用户使用其原始用户名和密码登录
*   用户选择服务提供商（例如 twitter）链接到他们的帐户
*   用户被重定向到推特
*   用户在 twitter oauth 屏幕上输入他们的 twitter 密码并同意允许您的网站访问您所说的任何您需要的信息
*   然后 twitter 将用户重定向回您的 oauth 回调页面
*   您获取返回的 twitter id（以及 twitter 返回的任何其他信息）并将其放在您的数据库中针对该用户
*   用户现在可以在未来仅使用 Twitter 登录

一旦用户启用了一个服务提供商，他们就可以通过两种方式访问​​同一个帐户。

除了上述过程，我建议添加一个审计跟踪，以便用户可以看到他们的帐户已采取的行动。这可能取决于您可用的时间，但它可能会为您提供许多痛苦的客户支持时间。您可以告诉用户的信息越多，赋予他们管理这些信息的权力越大，您自己进行的调查就越少，为他们解决用户问题所花费的时间就越少。

# python - 如何找到提供给 Python 的确切 CLI 命令？

> ID：12411643
> 
> 赞同：7
> 
> 时间：2012-09-13T17:27:08.990
> 
> 标签：python, shell, unix, command-line-arguments

我想从脚本内部找出——我用来启动它的确切命令。我尝试了以下方法：

```
#!/usr/bin/env python

import sys, os
print os.path.basename(sys.argv[0]), sys.argv[1:] 
```

但它会丢失信息：

```
$ 1.py -1 dfd  'gf g' "df df"
1.py ['-1', 'dfd', 'gf g', 'df df'] 
```

你看——它已经丢失了关于枯萎的信息，我在命令中使用了双引号、单引号或根本没有引号。

**编辑**：

这是我正在使用的。我脚本中的所有参数都有默认值，并且在 args 被解析后`argparse`：

```
args = parser.parse_args() 
```

我记录它们，或者如果有日志 - 覆盖它们：

```
logName = "." + (os.path.splitext(os.path.basename(sys.argv[0])))[0] + ".json"
if os.path.exists(logName):
    print "!!! I've found log", logName
    Args = bk_loads_json(logName)
    for arg in Args:
        exec('args.{0} = Args["{0}"]'.format(arg))
else:
    print "!!! the log of args is saved to", logName
    bk_saves_json(args.__dict__, logName) 
```

defuns提到：

```
def bk_saves_json(myCustomDct, flNm):
    "Takes dict, and writes it to the file."

    FlNm = open(flNm, 'w')
    tmpJsn = json.dumps(myCustomDct, sort_keys=True, indent=4)
    FlNm.write(tmpJsn)
    FlNm.close()

def bk_loads_json(flNm):
    "Takes file of the json and returns it as a dict."

    json_data=open(flNm)
    data = json.load(json_data)
    json_data.close()
    return data 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T17:29:45.817

您正在寻找的信息（包括引号的命令参数）不可用。

*shell* (bash)，而不是 python，读取和解释引号——当 python 或任何其他衍生程序看到参数时，引号被删除。（当然，引用的报价除外。）

### 更多详情

当您在 shell 中键入命令时，您使用引号告诉*shell*命令行上的哪些标记被视为单个参数。空格用于将命令行分解为单独的参数，引号用于覆盖它——*在*参数中包含空格而不是分隔参数。

然后，shell 派生可执行文件并将您的参数列表传递给它。任何未加引号的引号已经被 shell 在解析你的命令行时“用完”，所以它们在这个阶段实际上不再存在，你的命令（python）看不到它们。

* * *

顺便说一句，我想知道你为什么关心得到报价。我不得不说，乍一看似乎被误导了。如果您告诉我们您为什么需要它们，或许我们可以提供帮助？

### 编辑

针对下面 OP 的评论，这是一种输出原始命令行的方法——或者至少是一种功能等效的方法：

```
import pipes # or shlex if python3
print sys.argv[0], ' '.join( [pipes.quote(s) for s in sys.argv[1:]] ) 
```

它只是在所有参数周围添加引号。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-13T18:02:11.687

我建议使用：

```
import subprocess, sys
print subprocess.list2cmdline(sys.argv[1:]) 
```

用于将`list2cmdline`参数列表转换为可在 shell 中使用的单个字符串。从文档：

> 使用与 MS C 运行时相同的规则，将一系列参数转换为命令行字符串：
> 
> 1) 参数由空格分隔，空格可以是空格，也可以是制表符。
> 
> 2) 用双引号括起来的字符串被解释为单个参数，无论其中包含什么空格。带引号的字符串可以嵌入到参数中。
> 
> 3) 前面有反斜杠的双引号被解释为文字双引号。
> 
> 4) 反斜杠按字面意思解释，除非它们紧接在双引号之前。
> 
> 5) 如果反斜杠紧接在双引号之前，则每对反斜杠都被解释为文字反斜杠。如果反斜杠的数量是奇数，则最后一个反斜杠转义下一个双引号，如规则 3 中所述。

# android - 如何使按钮从微调器中检索信息并将其显示在文本视图中

> ID：12411644
> 
> 赞同：0
> 
> 时间：2012-09-13T17:27:10.563
> 
> 标签：android, android-widget

所以我正在为我的一个班级创建这个基于文本的小型游戏，但我不知道如何做到这一点：

我有一个包含怪物列表的微调器。“id@spinnerMonster” 还有一个按钮，上面写着“战斗！” “id@btnBattle”

我正在努力实现的目标：

当你选择一个怪物时，比如说Training Dummy，然后点击按钮，按钮会触发一个textView，上面写着“你已经杀死了（Spinner Monster Name）！”

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:06:42.290

尝试这个

```
btnBattle.setOnClickListener(new OnClickListener() {

       public void onClick(View v) 
       {
               String selectedItem =  spinnerMonster.getSelectedItem().toString();      
               textview_id.setText("You have killed "+ selectedItem);
       }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:36:48.150

好的，您需要使用 OnItemSelected 侦听器，然后 arg2 为您提供位置。请查看下面的代码以更好地理解，希望这会有所帮助：

```
spn.setOnItemSelectedListener(new OnItemSelectedListener() {

        public void onItemSelected(AdapterView<?> arg0, View arg1,int arg2, long arg3) {

        } 
```

使用 arg2 参数来选择项目。它返回一个整数值，它是微调器列表中项目的位置，现在你知道点击了什么，所以只需将 textView 设置为适当的 msg。如果您需要更详细的信息，请告诉我

# python - 从 Pandas 数据框中过滤仅为零的列

> ID：12411649
> 
> 赞同：9
> 
> 时间：2012-09-13T17:27:27.697
> 
> 标签：python, pandas

我有一个 Pandas 数据框，我想在其中过滤掉所有仅包含零的列。例如，在下面的数据框中，我想删除第 2 列：

```
 0      1      2      3      4
0   0.381  0.794  0.000  0.964  0.304
1   0.538  0.029  0.000  0.327  0.928
2   0.041  0.312  0.000  0.208  0.284
3   0.406  0.786  0.000  0.334  0.118
4   0.511  0.166  0.000  0.181  0.980 
```

我怎样才能做到这一点？我一直在尝试这样的事情：

```
df.filter(lambda x: x == 0) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T17:32:12.353

以下对我有用。它给出了一个序列，其中列名现在是索引，并且索引的值是 True/False，具体取决于列中的所有项目是否为 0。

```
import pandas, numpy as np
# Create DataFrame "df" like yours...

df.apply(lambda x: np.all(x == 0)) 
```

如果你想实际过滤掉 0 值：

```
df[df.columns[(df != 0).any()]] 
```

# php - 显示 mysql 复制从属状态

> ID：12411650
> 
> 赞同：2
> 
> 时间：2012-09-13T17:27:31.910
> 
> 标签：php, mysqli, database-replication

如何返回复制服务器状态？

尝试获取从属状态时没有返回任何内容？！

mysql: 5.1.63-0

# 代码

```
$result = Mysql::result("SHOW SLAVE STATUS");
$status = $result->fetch_assoc();
echo '<pre>';
echo 'result: ';
print_r($result);
echo 'status: ';
print_r($status);
echo '</pre>'; 
```

# 返回

```
result: mysqli_result Object
(
    [current_field] => 0
    [field_count] => 38
    [lengths] => 
    [num_rows] => 0
    [type] => 0
)
status: 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:29:39.277

您需要获取其中包含数据的行：

$row=$result->fetch_assoc()

然后 $row['Slave_IO_Running'] 和 $row ['Slave_SQL_Running'] 应该给你你需要的东西。两者都应该是的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-01T20:33:02.297

我遇到了同样的问题，结果我连接到主数据库句柄而不是从属数据库。您的 $result 显示 num_rows=0 所以问题不在于您如何获取该行；就是没有状态可以显示。

# javascript - 从 Ajax TabContainer 内部调用 JavaScript window.open() 时不起作用

> ID：12411654
> 
> 赞同：0
> 
> 时间：2012-09-13T17:27:47.120
> 
> 标签：javascript, ajaxcontroltoolkit

这是一段在页面没有任何 Ajax 时可以正常工作的代码块

```
if (sStat > "") {
    str2 = "Dist.aspx?statProducer="; str2 += document.all.txtHiddenStat.value;
    var distWindow;
    if (document.all.ddlWindows.value == "new") {
       distWindow = window.open(str2);
    }
    else {
        distWindow = window.open(str2, "PeriscopeView");
        distWindow.focus();
    }
    return false; 
```

输入收集在此 Ajax TabContainer 内的“advSearch”TabPanel 内的文本框中。搜索按钮在单击时会调用 doValidate() JavaScript 方法。上面的代码存在于该方法中。

```
<asp:ToolkitScriptManager ID="_toolkitScriptManager1" runat="server" EnablePageMethods="True">
</asp:ToolkitScriptManager>

<form id = "frmSearch" onsubmit="return(doValidate());" method="post" runat="server">
<asp:TabContainer ID="AdvOrBasicSearch" runat="server" ActiveTabIndex="0">
<div id="tabs_header">
    <span id="tab1" class="ajax_tab_active">
    <asp:TabPanel ID="basicSearch" runat="server" HeaderText="Basic Search">.../asp:TabPanel>                

    </span>
    <span id="tab2" class="ajax_tab_active">
    <asp:TabPanel ID="advSearch" runat="server" HeaderText="Advanced Search">...</asp:TabPanel>
    </span>
</div>
</asp:TabContainer>
</form> 
```

现在页面上正在使用 Ajax TabContainers，第二个窗口将打开，但它只是挂起/超时。

编辑

以为我会添加到这篇文章中，因为我一直在逐步检查代码以尝试找出问题所在。在该 JavaScript 块执行后，Visual Studio 将在“return false”代码行之后导航到具有以下标题的页面：

```
// Name:        MicrosoftAjax.debug.js
// Assembly:    AjaxControlToolkit
// Version:     4.1.60623.0
// FileVersion: 4.1.60623
// (c) 2010 CodePlex Foundation 
```

这是程序挂起的地方。我用了大约 5 分钟的时间逐步完成了此页面上正在执行的代码，并且看起来几乎 7000 多行代码中的每一行都将被调用。有没有办法让 TabContainer 跳过它在这里做的任何事情？

# linux - 如何找到我的进程是 CPU/内存或磁盘密集型的？

> ID：12411656
> 
> 赞同：0
> 
> 时间：2012-09-13T17:27:53.283
> 
> 标签：linux, ubuntu, amazon-ec2

我正在尝试扩展我的 ec2 实例，我必须选择我的进程是否需要更多 CPU/内存或 EBS 存储。

我怎么知道？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:00:21.120

SSH 到命令行并使用 top 命令。它将为您提供进程列表及其处理器/内存使用情况。您将看到您的内存和处理器使用率是否过高或不足。

```
$ top 
```

# java - 了解同步关键字的工作原理

> ID：12411659
> 
> 赞同：1
> 
> 时间：2012-09-13T17:28:03.660
> 
> 标签：java, synchronized

在下面的代码中，我期望只有两个线程之一进入`halt()`函数然后停止程序。但似乎两个线程都进入了`synchronized`halt() 函数。为什么会发生这种情况？？

```
package practice;

class NewThread implements Runnable {
  String name; // name of thread
  Thread t;
  boolean suspendFlag;

  NewThread(String threadname) {
    name = threadname;
    t = new Thread(this, name);
    System.out.println("New thread: " + t);
    suspendFlag = false;
    t.start(); // Start the thread
  }

  // This is the entry point for thread.
  public void run() {
    try {
      for(int i = 15; i > 0; i--) {
        System.out.println(name + ": " + i);
        Thread.sleep(200);
        Runtime r = Runtime.getRuntime();
        halt();
      }
    } catch (InterruptedException e) {
      System.out.println(name + " interrupted.");
    }
    System.out.println(name + " exiting.");
  }

  synchronized void halt() throws InterruptedException
  {
      System.out.println(name + " entered synchronized halt");
      Runtime r = Runtime.getRuntime();
      Thread.sleep(1000);
      r.halt(9);
      System.out.println(name + " exiting synchronized halt"); // This should never execute
  }
}

class Practice{
  public static void main(String args[]) {
    NewThread ob1 = new NewThread("One");
    NewThread ob2 = new NewThread("Two");

    // wait for threads to finish
    try {
      System.out.println("Waiting for threads to finish.");
      ob1.t.join();
      ob2.t.join();
    } catch (InterruptedException e) {
      System.out.println("Main thread Interrupted");
    }

    System.out.println("Main thread exiting."); // This should never execute
  }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:30:42.590

synchronized 不锁定一个方法，它锁定一个对象。

你有一个方法，但有两个对象。每个线程锁定自己的对象并调用halt()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:31:37.080

同步在每个对象上完成。如果您有 2 个对象，则 2 个线程可能会同时进入该`halt()`方法。您可以使方法静态以实现您想要的。通过使其成为静态，锁将被放置在对应的`Class`对象 ( `NewThreadOne.class`) 上，该对象在 的实例数量方面是唯一的`NewThreadOne`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:32:01.570

你已经用作`2 objects`他们`2 threads`的`monitor lock`......

所以你的代码工作正常，**每个线程都访问自己对象的锁来访问** `halt()`方法......

在`synchonized keyword`中，您**实现了对象的锁定，**线程通过该锁定可以访问`synchronized methods or atomic statements`该类中的......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T17:33:19.577

该`synchronized`方法是使用它来锁定。在您的情况下，您有 2 个不同的对象，因为您正在构建 2 个线程实例，因此您没有锁定同一个对象。为了获得您期望的同步行为，您需要制作`halt`方法`static`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T17:36:14.410

不建议在 java 同步块中使用 String 对象作为锁，因为字符串是不可变对象和文字字符串，而实习字符串存储在字符串池中。因此，如果代码的任何其他部分或任何第三方库使用与锁相同的字符串，那么它们都将被锁定在同一个对象上，尽管它们完全不相关，这可能导致意外行为和糟糕的性能。建议在 Java 中使用 new Object() 在同步块上进行同步，而不是 String 对象。

# android - Android - 如何从主活动打开关联文件到应用程序

> ID：12411660
> 
> 赞同：0
> 
> 时间：2012-09-13T17:28:07.867
> 
> 标签：android

> **可能重复：**
> [Android 意图过滤器：将应用与文件扩展名关联](https://stackoverflow.com/questions/3760276/android-intent-filter-associate-app-with-file-extension)

我已将扩展名为 .x 的 XML 文件关联到我的应用程序。我想单击 .x 文件，我的关联应用程序应该启动，并且我想从活动的 onCreate() 内部打开以某种方式传递的文件。有办法做到这一点吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:54:26.433

在您的清单中将此意图过滤器添加到您的活动中

```
<intent-filter>
 <action android:name="android.intent.action.VIEW" />
 <category android:name="android.intent.category.DEFAULT" />
 <data android:mimeType="application/xml" />
 <data android:pathPattern=".*\\.x" />
</intent-filter> 
```

在您的 onCreate 文件上传递为：

```
Uri uri = this.getIntent().getData();
if(uri!=null){
 Log.v(getClass().getSimpleName(), "importing uri:"+uri.toString());
} 
```

# python - typeerror 不支持 % 的操作数类型：“list”和“int”

> ID：12411661
> 
> 赞同：3
> 
> 时间：2012-09-13T17:28:14.907
> 
> 标签：python, list, int, typeerror

这是代码：

```
list = [2, 3, 5, 7, 11, 13]
list2 = [range(list[-1], 2000000)]
y =11
x = 1
v = list[-1]>= x
while list[-1] ** 2 < 2000000:
    y= y + 2
    prime = True
    while prime == True:    
        for x in list:
            if x * 2 < y:   
                if y % x == 0:
                    prime = False
                    break
        if prime == True:
            list.append(y)
            prime = False
print sum(list)

for u in list:
    for w in list2:
        if u * u < w:
            if w % u == 0:
                list2.pop(w)
print list
print sum(list) + sum(list2) 
```

如您所见，这是一个基本程序，它创建一个筛子，然后为它放入多达 200 万个数字。这是针对 Euler 项目的，我正在尝试在学习编程时测试我的技能。

现在，这篇文章标题为第 23 行的错误。为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T17:30:10.930

`range()`已经返回了一个列表，但你把它放到了一个新列表中：

```
list2 = [range(list[-1], 2000000)] 
```

这会产生一个包含列表的列表，然后`w`将其设置为完整范围。只需卸下那里的括号。

```
>>> [range(5)]
[[0, 1, 2, 3, 4]]
>>> range(5)
[0, 1, 2, 3, 4] 
```

# asp.net - ControlAdapter.LoadAdapterViewState 在 Control.LoadViewState 之前触发？

> ID：12411673
> 
> 赞同：2
> 
> 时间：2012-09-13T17:28:48.057
> 
> 标签：asp.net, adapter, viewstate, web-controls, html-select

我正在编写一个适配器，以便使用以下解决方案的组合`DropDownList`向内置添加 2 个功能：`DropDownLists`

1.  [选项组支持](https://stackoverflow.com/a/130046/295813)
2.  [跨回发的自定义属性的持久性](https://stackoverflow.com/a/3099755/295813)

如果`DropDownList`项目是在标记中声明的，这可以正常工作。但是，当动态添加项目时，我依赖于从中恢复的项目`ViewState`。

问题是它`ControlAdapter.LoadAdapterViewState`被称为**BEFORE** `Control.LoadViewState`，因此我无法将我的 OptionGroup/Custom 属性重新应用到 ，`Items`因为它们还不存在。

那么首先，**这种事件顺序背后的原因是什么？**

其次，**在生命周期中的其他什么地方我可以安全地将这些自定义属性设置回项目？** *注意：如果控件不会在页面上呈现（例如在向导中），则不能使用 PreRender，因为 ViewState 会丢失。*

# django - 保存扩展用户模型的问题

> ID：12411676
> 
> 赞同：0
> 
> 时间：2012-09-13T17:28:58.563
> 
> 标签：django, django-forms, django-views

在用户向 Django-Register 注册后，我在提交创建从 auth.User 扩展的用户配置文件的表单时遇到问题。

我收到错误消息：`Please correct the following fields:`来自模板中的一串代码：

```
{% if form.errors %}<p>Please correct the following fields:</p>{% endif %} 
```

这告诉我表单中是否有错误，其余的表单模板如下所示：

```
<div class='register_div'>
  {% if form.first_name.errors %}
    <p class='error'>{{ form.first_name.errors }}</p>
  {% endif %}
  <p>
    <label for='first_name'{% if form.first_name.errors %}class='error'{% endif %}>
      First Name:
    </label>
  </p>
  <p>{{ form.first_name }}</p>
</div> 
```

我的模型.py

```
class UserProfile(models.Model):
user = models.ForeignKey(User, unique=True)
role = models.CharField(max_length=14, choices=role, verbose_name='Role', blank=True, null=True)
job_description = models.TextField(max_length=100, verbose_name='Job Description', blank=True)

# Basic Information
first_name = models.CharField(max_length=30, verbose_name='First Name')
last_name = models.CharField(max_length=30, verbose_name='Last Name')
dob = models.DateField(verbose_name='Date of Birth')
stud_id = models.BigIntegerField(verbose_name='Student ID',)
mob_num = models.CharField(max_length=30, verbose_name='Mobile Number')
home_num = models.CharField(max_length=30, verbose_name='Home Number')
term_add = models.TextField(verbose_name='Term Time Address')
perm_add = models.TextField(verbose_name='Permanent Address')
au_status = models.NullBooleanField(verbose_name='Are you a member of the AU?')

# Next of Kin Details
nok_first_name = models.CharField(max_length=30, verbose_name='First Name (Next of Kin) ')
nok_last_name = models.CharField(max_length=30, verbose_name='Last Name (Next of Kin)')
relationship = models.CharField(max_length=30, verbose_name='Relationship (with Next of Kin)')
nok_mob_num = models.CharField(max_length=30, verbose_name='Mobile Number (Next of Kin)')
nok_home_num = models.CharField(max_length=30, verbose_name='Home Number (Next of Kin)')
nok_add = models.TextField(verbose_name='Address (Next of Kin)')

# Health and Safety
diet = models.TextField(verbose_name='Dietary Requirements', blank=True)
med_cond = models.TextField(verbose_name='Medical Conditions', blank=True)
fear = models.TextField(verbose_name='Greatest Fears', blank=True)
swim = models.NullBooleanField(verbose_name='Can you swim more than 100m?')

# Equipment:
sleeping_bag = models.NullBooleanField(verbose_name='Do you have a warm sleeping bag')
waterproof = models.NullBooleanField(verbose_name='Do you have waterproof clothing?')
shoes = models.NullBooleanField(verbose_name='Do you have a pair of climbing shoes?')
shoe_size = models.DecimalField(verbose_name='What is your athletic shoe size (in UK sizes)?', max_digits=3, decimal_places=1, blank=True, null=True)
harness = models.NullBooleanField(verbose_name='Do you have a harness?')
belay_device = models.NullBooleanField(verbose_name='Do you have a belay plate and a screwgate?')
helmet = models.NullBooleanField(verbose_name='Do you have a helmet?')
nut = models.NullBooleanField(verbose_name='Do you have a set of nuts?')
hex = models.NullBooleanField(verbose_name='Do you have a set of hexes?')

# Misc.:
minibus = models.NullBooleanField(verbose_name='Can you drive the SU minibus?') 
```

我的表格.py

```
class RegistrationForm(ModelForm):

# Basic Information
first_name = forms.RegexField(label='First Name', regex=r'^[A-Z][a-zA-Z\s]+$',
             error_messages = {'invalid': "A name starts with a capital letter,
                     and may contain only alphabetical characters."})
last_name = forms.RegexField(label='Last Name', regex=r'^[A-Z][a-zA-Z\s]+$',
        error_messages = {'invalid': "A name starts with a capital letter,
                    and may contain only alphabetical characters."} )

# Details
au_status = forms.TypedChoiceField(label='Are you a member of the AU?', required=False, choices=choices, coerce=int)

# Next of Kin Details
nok_first_name = forms.RegexField(label='First Name (Next of Kin)', regex=r'^[A-Z][a-zA-Z\s]+$',
              error_messages = {'invalid': "A name starts with a capital letter, 
                          and may contain only alphabetical characters."})
nok_last_name = forms.RegexField(label='Last Name (Next of Kin)',
                         regex=r'^[A-Z][a-zA-Z\s]+$',
                 error_messages = {'invalid': "A name starts with a capital
                         letter, and may contain only alphabetical characters."})

# Health and Safety
swim = forms.TypedChoiceField(label='Can you swim more than 100m?',
               required=False, choices=choices, coerce=int)

# Equipment:
sleeping_bag = forms.TypedChoiceField(label='Do you have a warm sleeping bag', required=False, choices=choices, coerce=int)
waterproof = forms.TypedChoiceField(label='Do you have waterproof clothing?', required=False, choices=choices, coerce=int)
shoes = forms.TypedChoiceField(label='Do you have a pair of climbing shoes?', required=False, choices=choices, coerce=int)
harness = forms.TypedChoiceField(label='Do you have a harness?', required=False, choices=choices, coerce=int)
belay_device = forms.TypedChoiceField(label='Do you have a belay plate and a screwgate?', required=False, choices=choices, coerce=int)
helmet = forms.TypedChoiceField(label='Do you have a helmet?', required=False, choices=choices, coerce=int)
nut = forms.TypedChoiceField(label='Do you have a set of nuts?', required=False, choices=choices, coerce=int)
hex = forms.TypedChoiceField(label='Do you have a set of hexes?', required=False, choices=choices, coerce=int)

# Misc.:
minibus = forms.TypedChoiceField(label='Can you drive the SU minibus?', required=False, choices=choices, coerce=int)

class Meta:
    model = UserProfile 
```

我的观点.py

```
def MemberRegistration(request):
if not request.user.is_authenticated():
    return HttpResponseRedirect('/accounts/login/')
if request.method == 'POST':
    form = RegistrationForm(request.POST)
    if form.is_valid():
        user = User.objects.get(username=request.user)
        profile = UserProfile(user=user)  
        profile.first_name      = form.cleaned_data['first_name']
        profile.last_name       = form.cleaned_data['last_name']
        profile.dob             = form.cleaned_data['dob']
        profile.stud_id         = form.cleaned_data['stud_id']
        profile.mob_num         = form.cleaned_data['mob_num']
        profile.home_num        = form.cleaned_data['home_num']
        profile.term_add        = form.cleaned_data['term_add']
        profile.perm_add        = form.cleaned_data['perm_add']
        profile.au_status       = form.cleaned_data['au_status']
        profile.nok_first_name  = form.cleaned_data['nok_first_name']
        profile.nok_last_name   = form.cleaned_data['nok_last_name']
        profile.relationship    = form.clenaed_data['relationship']
        profile.nok_mob_num     = form.cleaned_data['nok_mob_num']
        profile.nok_home_num    = form.cleaned_data['nok_home_num']
        profile.nok_add         = form.cleaned_data['nok_add']
        profile.diet            = form.cleaned_data['diet']
        profile.med_cond        = form.cleaned_data['med_cond']
        profile.fear            = form.cleaned_data['fear']
        profile.swim            = form.cleaned_data['swim']
        profile.sleeping_bag    = form.cleaned_data['sleeping_bag']
        profile.waterproof      = form.cleaned_data['waterproof']
        profile.shoes           = form.cleaned_data['shoes']
        profile.shoe_size       = form.cleaned_data['shoe_size']
        profile.harness         = form.cleaned_data['harness']
        profile.belay_device    = form.cleaned_data['belay_device']
        profile.helmet          = form.cleaned_data['helmet']
        profile.nut             = form.cleaned_data['nut']
        profile.hex             = form.cleaned_data['hex']
        profile.minibus         = form.cleaned_data['minibus']  
        profile.save()
        return render_to_response('base_profile.html', context_instance=RequestContext(request))
    else:
        return render_to_response('base_registration.html', {'form': form}, context_instance=RequestContext(request))
else:
    form = RegistrationForm()
    context = {'form': form}
    return render_to_response('base_registration.html', context, context_instance=RequestContext(request))` 
```

任何帮助深表感谢！如果有人能告诉我如何减少代码以及我发现过多的代码，那就太好了。感谢你的帮助 ：）

更新：

我知道错误是什么！[参考这个！](https://stackoverflow.com/questions/5516437/django-form-has-no-errors-but-form-is-valid-doesnt-validate?rq=1)我没有填写模型的用户字段。谁能帮我解决这个问题并减少我使用的代码量？

更新 2：

表格现在通过了，但总是有错误。

当我使用这个版本的views.py时，我得到`IntegrityError at /register/ - accounts_userprofile.first_name may not be NULL`了这条线`profile.save()`

```
`if form.is_valid():
        user = User.objects.get(username=request.user)
            user.first_name     = form.cleaned_data['first_name']
            user.last_name      = form.cleaned_data['last_name']
            user.save()
            profile = UserProfile(user=user,
            dob             = form.cleaned_data['dob'],
            stud_id         = form.cleaned_data['stud_id'],
            mob_num         = form.cleaned_data['mob_num'],
            home_num        = form.cleaned_data['home_num'],
            term_add        = form.cleaned_data['term_add'],
            perm_add        = form.cleaned_data['perm_add'],
            au_status       = form.cleaned_data['au_status'],
            nok_first_name  = form.cleaned_data['nok_first_name'],
            nok_last_name   = form.cleaned_data['nok_last_name'],
            relationship    = form.cleaned_data['relationship'],
            nok_mob_num     = form.cleaned_data['nok_mob_num'],
            nok_home_num    = form.cleaned_data['nok_home_num'],
            nok_add     = form.cleaned_data['nok_add'],
            diet            = form.cleaned_data['diet'],
            med_cond        = form.cleaned_data['med_cond'],
            fear            = form.cleaned_data['fear'],
            swim            = form.cleaned_data['swim'],
            sleeping_bag    = form.cleaned_data['sleeping_bag'],
            waterproof      = form.cleaned_data['waterproof'],
            shoes           = form.cleaned_data['shoes'],
            shoe_size       = form.cleaned_data['shoe_size'],
            harness         = form.cleaned_data['harness'],
            belay_device    = form.cleaned_data['belay_device'],
            helmet          = form.cleaned_data['helmet'],
            nut             = form.cleaned_data['nut'],
            hex             = form.cleaned_data['hex'],
            minibus         = form.cleaned_data['minibus'],
            )
           profile.save()` 
```

如果我改用这个版本的views.py：

```
if form.is_valid():
        profile = User.objects.get(username=request.user)

        for key in UserProfileForm.base_fields.keys():
            for val in form.cleaned_data.values():
                setattr(profile, key, val)

        profile.save()

        return render_to_response('base_profile.html', context_instance=RequestContext(request))` 
```

我被传递给 base_profile.html，只有 first_name 和 last_name 填充了 term_add/perm_add/nok_add/diet/med_cond/fears 字段。任何人都可以帮忙吗？对不起，我是个菜鸟>.<

我用于一次注册 User 和 UserProfile 的旧 views.py 看起来像这样：

```
def MemberRegistration(request):
if request.user.is_authenticated():
    return render_to_response('base_profile.html', context_instance=RequestContext(request))
if request.method == 'POST':
    form = RegistrationForm(request.POST)
    if form.is_valid():
        user = User.objects.create_user(username        = form.cleaned_data['username'],    
                                        email           = form.cleaned_data['email'],
                                        password        = form.cleaned_data['password'],
                                        )
        user.first_name = form.cleaned_data['first_name']
        user.last_name  = form.cleaned_data['last_name']
        member = user.save()
        member = Member(user=user,  first_name      = form.cleaned_data['first_name'],
                                    last_name       = form.cleaned_data['last_name'],
                                    date_of_birth   = form.cleaned_data['date_of_birth'],
                                    email           = form.cleaned_data['email'],
                                    student_id      = form.cleaned_data['student_id'],
                                    au_status       = form.cleaned_data['au_status'],
                                    mob_num         = form.cleaned_data['mob_num'],
                                    home_num        = form.cleaned_data['home_num'],
                                    term_time_add   = form.cleaned_data['term_time_add'],
                                    permanent_add   = form.cleaned_data['permanent_add'],
                                    diet            = form.cleaned_data['diet'],
                                    med_condition   = form.cleaned_data['med_condition'],
                                    fear            = form.cleaned_data['fear'],
                                    swim            = form.cleaned_data['swim'],
                                    sleeping_bag    = form.cleaned_data['sleeping_bag'],
                                    waterproof      = form.cleaned_data['waterproof'],
                                    shoes           = form.cleaned_data['shoes'],
                                    shoe_size       = form.cleaned_data['shoe_size'],
                                    harness         = form.cleaned_data['harness'],
                                    belay_device    = form.cleaned_data['belay_device'],
                                    helmet          = form.cleaned_data['helmet'],
                                    nuts_set        = form.cleaned_data['nuts_set'],
                                    hexes_set       = form.cleaned_data['hexes_set'],
                                    minibus_driver  = form.cleaned_data['minibus_driver'],
                                    )

        member.save()
        return render_to_response('base_profile.html', context_instance=RequestContext(request))
    else:
        return render_to_response('base_registration.html', {'form': form}, context_instance=RequestContext(request))
else:
    form = RegistrationForm()
    context = {'form': form}
    return render_to_response('base_registration.html', context, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:18:19.703

对于视图，您可以通过以下方式减少它：

```
if form.is_valid():
    profile = UserProfile(user=request.user)  # you already have the user in the request.

    for key, val in form.cleaned_data.values():
        setattr(profile, key, val)

    profile.save() 
```

在这里，您将遍历字典并将所有键和值设置为配置文件对象。请检查是否需要所有密钥，如果不需要，您将不得不以某种方式删除它们或尝试不同的方法，例如：

```
my_keys = ('key1', 'key2', 'key3', ...)
for key in my_keys:
    profile[key] = form.cleaned_data.get(key, "")

profile.save() 
```

你也应该使用模型形式：

```
class RegistrationForm(forms.ModelForm):
    class Meta:
        model = UserProfile
        exclude = ('user',) 
```

此外，来自 django 的用户模型已经有一个 first_name、last_name 字段，因此您无需再次添加这些字段。

我可以看到你的模型上也有很多字段，我建议你创建一个这样的模型：

```
class UserDetails(models.Model):
    user = models.ForeignKey(User)        

    name = models.CharField(max_length=255)
    value = models.CharField(max_length=255) 
```

这样，您可以以更灵活的方式保存所有详细信息等，而不是为用户提供大量字段。你可以让它变得更有趣，并添加一个类型和一个函数来转换它（例如，如果你需要这个值是一个整数）。

因此，例如，不要向`UserProfile`类中添加字段，`home_num`或者`diet` 您可以执行以下操作：

```
for key, value in form.cleaned_data.values():
    UserDetails(user=request.user, name=key, value=value).save() 
```

然后访问任何：

```
print request.user.user_details_set.all() 
```

它应该打印所有这些细节。我可以从这种方法中看到的唯一不好的事情是它`ModelForms`不会那么容易工作，但我向你保证迁移会更加零星:)

# javascript - 使用 Mongolab 的 Backbonejs

> ID：12411679
> 
> 赞同：2
> 
> 时间：2012-09-13T17:29:04.043
> 
> 标签：javascript, mongodb, backbone.js, mlab

我正在开发一些需要 ruby​​ 在后端连接到数据库的主干应用程序，仅此而已。我正在尝试为我的演示排除 ruby​​（我知道这对生产存在安全风险）

我在 AngularJS 网站上注意到他们有一个示例（[http://jsfiddle.net/api/post/library/pure/](http://jsfiddle.net/api/post/library/pure/)），它直接连接到没有后端语言的 mongolabs 服务。

```
// This is a module for cloud persistance in mongolab - https://mongolab.com
angular.module('mongolab', ['ngResource']).
    factory('Project', function($resource) {
      var Project = $resource('https://api.mongolab.com/api/1/databases' +
          '/angularjs/collections/projects/:id',
          { apiKey: '4f847ad3e4b08a2eed5f3b54' }, {
            update: { method: 'PUT' }
      }
  );

  Project.prototype.update = function(cb) {
    return Project.update({id: this._id.$oid},
        angular.extend({}, this, {_id:undefined}), cb);
  };

  Project.prototype.destroy = function(cb) {
    return Project.remove({id: this._id.$oid}, cb);
  };

  return Project;
}); 
```

这在骨干中可能吗？如果是这样，我该怎么做？我试图看看 AngularJS 是如何模拟它的，但我对骨干很陌生，不太了解他们是如何做到的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T08:18:03.403

AngularJS 示例是 Mongolab 的包装器，可以让您自己编写所有样板代码。归根结底，直接访问该服务所需要做的就是从 ajax 调用它：

```
$.ajax( { url: "https://api.mongolab.com/api/1/databases/
                     your_db/collections/your_collection?apiKey=your_key",
      data: JSON.stringify( { "your_field" : "your_data" } ),
      type: "POST",
      contentType: "application/json" } ); 
```

**编辑：**

[MongoLab 现在支持两因素身份验证](http://blog.mongolab.com/tag/security/)

# c# - “ASP.NET AJAX 服务器控件”和“ASP.NET 服务器控件”项目类型有什么区别？

> ID：12411683
> 
> 赞同：5
> 
> 时间：2012-09-13T17:29:11.157
> 
> 标签：c#, asp.net, custom-server-controls

“ASP.NET AJAX 服务器控件”和“ASP.NET 服务器控件”项目类型有什么区别？

一种项目类型是否比另一种具有优势？

是否有一些事情可以在一个而不是另一个中完成？

提前致谢。

编辑：我找到了这个链接： http: [//www.codeproject.com/Articles/22384/ASP-NET-AJAX-Controls-and-Extenders](http://www.codeproject.com/Articles/22384/ASP-NET-AJAX-Controls-and-Extenders)

这是该链接的引用，我认为它回答了我的问题：

> 乍一看，ASP.NET 服务器控件与其他两个控件的不同之处在于它不支持 AJAX。然而，这并不完全正确，在本教程的第一部分，我将演示仅基于服务器控件开发支持 AJAX 的控件可以走多远。虽然 ASP.NET 服务器控件不提供对 AJAX 脚本的直接访问，但它可以实现封装在其他控件（如 UpdatePanel 或 AJAX 扩展计时器控件）中的 AJAX 脚本，以提供 AJAX 功能。对于不太热衷于深入研究 JavaScript 的复杂性和陷阱的控件开发人员来说，Server Control 提供了一个出色而干净的开发路径。
> 
> AJAX 服务器控件和 AJAX 服务器控件扩展器与常规 ASP.NET 服务器控件的不同之处在于它们与 JavaScript 文件耦合，并允许在控件类的属性和 JavaScript 类的属性之间进行映射。当您需要其他 AJAX 服务器控件不提供的功能，或者只是想使用客户端脚本自定义控件以避免 ASP.NET 控件生命周期时，这是最佳选择。

编辑 2：我刚刚看到 Aghilas Yakoub 的答案具有相同的链接 :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:35:27.193

在项目方面，它们是相同的。唯一的区别在于默认创建的控件的初始样板代码。您完全可以自由地将 Ajax 控件添加到简单的服务器控件项目中，反之亦然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:28:24.827

`ASP.NET AJAX Server Control`为 ASP.NET 网页带来功能，例如：

1 重新渲染页面的一部分

2 部分页面更新

3 避免整页回发。

例如，您可以使用 Ajax Extender，这是一个附加到另一个 ASP.NET 控件以提供 Ajax 功能的控件。

链接非常有趣： http: [//www.codeproject.com/Articles/22384/ASP-NET-AJAX-Controls-and-Extenders](http://www.codeproject.com/Articles/22384/ASP-NET-AJAX-Controls-and-Extenders)

# android - android + scala + intellij sbt 在模拟器上返回警告和应用程序崩溃：bad class file magic (cafebabe) or version (0033.0000)

> ID：12411689
> 
> 赞同：2
> 
> 时间：2012-09-13T17:29:34.830
> 
> 标签：android, scala, ubuntu, intellij-idea, sbt

**我正在尝试让一个 hello world android 应用程序与 scala 和 intellij 一起工作尝试相同壮举的人必须熟悉以下步骤。当我使用 sbt 时，问题发生在最后**

请注意我使用的每个工具的版本。对于初学者，我使用的是 java 版本 1.7.0_07

- 下载并设置 android sdk。我已经下载了从 1.5 (API 3) 到 4.1 (API 16) 的所有版本。我不会对此进行进一步的详细介绍。已经有很多教程了。

我们将需要环境变量中的 android home 路径。所以让我们为当前用户设置一个持久的环境变量

```
gedit ~/.pam_environment 
```

现在附加这个：ANDROID_HOME= 例如

```
ANDROID_HOME=/home/pligor/android-sdks 
```

现在让我们使用 sbt 工具。我们宁愿手动安装 sbt。在链接中找到“Unix”部分： [https](https://github.com/harrah/xsbt/wiki/Getting-Started-Setup) ://github.com/harrah/xsbt/wiki/Getting-Started-Setup 并下载 sbt-launch.jar 并将其放入 ~/bin 目前这是版本 0.12.0然后创建一个 sbt 文件：

```
gedit ~/bin/sbt 
```

在里面写下这一行：

```
java -Xms512M -Xmx1536M -Xss1M -XX:+CMSClassUnloadingEnabled -XX:MaxPermSize=384M -jar `dirname $0`/sbt-launch.jar "$@" 
```

并使脚本可执行：

```
chmod u+x ~/bin/sbt 
```

现在你需要为 intellij 安装一个 sbt 插件。sbt-idea 版本 1.1.0：

```
gedit ~/.sbt/plugins/build.sbt 
```

在行内添加 append （记住每个 .sbt 文件用一个额外的空行分隔每个语句）：

```
addSbtPlugin("com.github.mpeltonen" % "sbt-idea" % "1.1.0") 
```

对于 github 模板，您需要 giter8 工具。所以执行：

卷曲[https://raw.github.com/n8han/conscript/master/setup.sh](https://raw.github.com/n8han/conscript/master/setup.sh) | 嘘

然后执行：

```
cs n8han/giter8 
```

现在我使用 g8 从 jberkel 获取一个 android 应用程序模板：

```
g8 jberkel/android-app 
```

有一些问题需要您设置。目前我将所有内容都保留为默认值。这意味着我使用 scala 版本 2.9.1 和 Android 2.3.3 (API 10) 和 scalatest_version 1.8.RC1。我不习惯使用 proguard，因为我以前没有使用过它，所以我将 useProguard 设置为 false。

运行 sbt 之前： android-plugin 目前兼容 0.11.3 版本的 sbt 我们需要做一个调整。所以在新的 android 应用程序的文件夹中执行：gedit project/build.properties 并插入这一行：sbt.version=0.11.3

在同一文件夹内执行： sbt 'gen-idea no-classifiers' compile

然后进入sbt交互模式控制台：sbt

在控制台内执行：android:package-debug

**而且我相信这些警告是问题开始的地方：** 故障处理：错误的类文件魔术（cafebabe）或版本（0033.0000）......同时解析my/android/project/R$id.class

现在您可以尝试启动一个 android 模拟器： android:emulator-start # 用于获取 avds 列表，例如 android:emulator-start android2_3_3

模拟器完全启动后，像这样执行 android 应用程序：android:start-emulator

在这一切之后，应用程序将崩溃！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T10:47:48.037

问题在于您的 Java 版本。切换回 Java 6，或者如果您不能，[https://stackoverflow.com/a/7705091/203487](https://stackoverflow.com/a/7705091/203487)可能会有所帮助。

“bad class file magic (cafebabe) or version (0033.0000)”表示生成的类文件的版本为 51，即 Java 7，因此很明显 dexer 和 ProGuard 都不能使用这些类文件。这里我不是在谈论最新的 ProGuard 版本，而是与 Android SDK 捆绑在一起的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:52:05.667

我只能谈谈我的设置，到目前为止这是成功的。

*   您将需要 Proguard 来创建`apk`合理大小的 s。
*   我使用 Scala `2.10-M6`，因为`2.8`它很旧并且有其怪癖，尤其是在 Android 上，并且`2.9`对 Proguard 非常慢。
*   这`keep class scala.collection.SeqLike { ...`很重要，否则该类被忽略，相反它有一个方法引用（[我发布了这个解决方法](https://groups.google.com/d/msg/scala-on-android/WvMgI6LYjHY/iboKz3uFUVAJ)）。
*   使用`Build.scala`了许多有趣的东西，比如 scalaz 或 libgdx，请随意修剪它们。许多 android 的东西都是从各种 g8 模板中破解出来的，感谢所有分享它们的人。

所以这是我的设置转储：

[项目/Build.scala](https://gist.github.com/3718270) [项目/plugins.sbt](https://gist.github.com/3718276)

我使用`sbt 0.11.3`和`Idea 11.1`。`sbt`我使用控制台编译，主要使用`android:start-device`命令，有时使用`android:emulator-start RomName`+ `android:start-emulator`。Idea 很好地附加到正在运行的 Android 进程。

我正在开发一个非密集图形的小游戏，到目前为止，我使用惯用的 Scala（甚至 Scalaz）而没有减速。所以没有必要仅仅为了Android而恢复到数组、vars和while循环:)

祝你好运！

# iphone - MPMoviePlayerController 播放背景

> ID：12411691
> 
> 赞同：1
> 
> 时间：2012-09-13T17:29:38.700
> 
> 标签：iphone, objective-c, ios, mpmovieplayercontroller, multitasking

我想用 MPMoviePlayerController 在后台播放视频的声音。过去的视频正在运行，但背景声音停止。我想继续声音和背景（在背景中只有声音）。info.plist 的背景模式设置为“音频”

```
 - (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];

    [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
    [self becomeFirstResponder];
}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    [[UIApplication sharedApplication] endReceivingRemoteControlEvents];
    [self resignFirstResponder];
}

- (void)Play_Video{
    [[AVAudioSession sharedInstance] setDelegate: self];
    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
    [[AVAudioSession sharedInstance] setActive: YES error: nil];

    self.movieController = [[MPMoviePlayerController alloc] init];

    self.movieController.view.frame = self.view.bounds;
    self.movieController.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleBottomMargin;
    self.movieController.backgroundView.backgroundColor = [UIColor clearColor];
    self.movieController.view.hidden = NO;
    self.movieController.controlStyle = MPMovieControlStyleEmbedded;
    [self.view addSubview:self.movieController.view];
    self.movieController.useApplicationAudioSession = NO;

    [UrlBlock VideoURL:url success:^(NSURL *URL) {

        if (self.movieController)
            self.movieController.contentURL = URL;
        else
            self.movieController = [[MPMoviePlayerController alloc] initWithContentURL:URL];

    } failure:^(NSError *error) {
        [self performSelectorOnMainThread:@selector(Alert:) withObject:error waitUntilDone:NO];
    }];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:40:18.127

这可能很明显，也许您只是没有将其粘贴，但是您是否覆盖了该`- (BOOL) canBecomeFirstResponder`方法？

IE

```
- (BOOL) canBecomeFirstResponder {
    return YES;
} 
```

# jsf-2 - 图片未更新

> ID：12411698
> 
> 赞同：1
> 
> 时间：2012-09-13T17:30:01.157
> 
> 标签：jsf-2, facelets

图像属性未更新。我正在使用 this.user.setImage(a) 来设置值，但它不起作用。我的托管 bean 是请求范围的。

1）这是我的bean。问题出在handleFileUpload函数中。

```
package com.bean;

import javax.faces.context.FacesContext;
import javax.faces.event.PhaseId;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.servlet.http.HttpSession;

import org.primefaces.event.FileUploadEvent;
import org.primefaces.model.UploadedFile;

import com.entity.User;

public class UserUpdateBean {
    User user;

    private EntityManager em;
    private UploadedFile uploadedFile;
    public UserUpdateBean(){
        EntityManagerFactory emf=Persistence.createEntityManagerFactory("FreeBird");
        em=emf.createEntityManager();
        FacesContext context = FacesContext.getCurrentInstance();
        HttpSession session = (HttpSession) context.getExternalContext().getSession(true);
        User s=(User) session.getAttribute("userdet");
        user = em.find(User.class,s.getEmail());
    }

    public void handleFileUpload(FileUploadEvent e) {  
        System.out.println("file handler called");
        uploadedFile = e.getFile();
        String fileName=uploadedFile.getFileName();
        fileName=fileName.substring(fileName.lastIndexOf("\\")+1);
        System.out.println(fileName);
        byte[] a = uploadedFile.getContents();
        PhaseId currentPhaseId = FacesContext.getCurrentInstance().getCurrentPhaseId();
        System.out.println("current phase id"+currentPhaseId);
        user.setImage(a);

    }   
public String update(){

    em.getTransaction().begin();
    em.persist(user);
    em.getTransaction().commit();
    System.out.println("updated successful");
    FacesContext context = FacesContext.getCurrentInstance();
    HttpSession session = (HttpSession) context.getExternalContext().getSession(true);
    session.setAttribute("userdet", user);
    return "success";

}
public User getUser() {
    return user;
}
public void setUser(User user) {
    this.user = user;
}

} 
```

2）这是我的 xml 页面。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">

<h:head></h:head>

    <h1> Main Content </h1>
    <h:form enctype="multipart/form-data">
    <h:panelGrid columns="2">
                    <h:outputText value="Profile Image"/>
                    <p:fileUpload fileUploadListener="#{userUpdateBean.handleFileUpload}"/>
                    <h:outputText value="Username: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.userName}" />
                    <h:outputText value="Firstname: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.firstName}" />
                    <h:outputText value="Lastname: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.lastName}" />
                    <h:outputText value="Password: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.password}" />
                    <h:outputText value="Date of Birth: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.birthDate}" >
                                <f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
                                </p:inputText>
                    <h:outputText value="Gender: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.gender}" />
                    <h:outputText value="Relationship: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.relationship}" />  
                    <h:outputText value="EmailID: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.email}" /> 
                    <h:outputText value="Contact No.: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.contactNo}" />
                    <h:outputText value="Street: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.street}" />
                    <h:outputText value="City: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.city}" />  
                    <h:outputText value="Pincode: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.pincode}" />   
                    <h:outputText value="State: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.state}" />
                    <h:outputText value="Country: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.country}" />       
                    <h:outputText value="Secondary School: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.secondarySchool}" />
                    <h:outputText value="High School: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.highSchool}" />
                    <h:outputText value="College: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.college}" />   
                    <h:outputText value="University: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.university}" />
                    <h:outputText value="Degree: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.degree}" />
                    <h:outputText value="Quote: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.quote}" />
                    <h:outputText value="About Me: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.aboutMe}" />   
                    <h:outputText value="Interest: " />
                    <p:inputText styleClass="outputLabel"
                                value="#{userUpdateBean.user.interest}" />                                                                                                                                                                                                                                                      
                    <h:outputText />
                    <h:outputText />
                    <h:commandButton value="Update" action="#{userUpdateBean.update}"/>
                    </h:panelGrid>
                    </h:form>

</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:00:19.990

您的问题是由这两个原因的组合引起的：

1.  bean 是请求范围的。
2.  `<p:fileUpload>`正在“高级模式”下运行（带有浏览、上传和取消按钮）。

一个请求范围的 bean 的生命周期正好是一个 HTTP 请求。`<p:fileUpload>`使用按钮帐户作为一个 HTTP 请求上传文件。将表单帐户作为另一个 HTTP 请求提交，并使用其自己的全新 bean 实例。在进行简单调试时，您应该已经注意到它`user.getImage()`是 null/empty 。`em.persist()`

为了让它工作，您需要将 bean 放在视图范围内。这样，只要您与同一个视图交互，bean 就会一直存在。

```
@ManagedBean
@ViewScoped
public class UserUpdateBean {} 
```

*（或者`<managed-bean-scope>view`在使用老式 XML 配置方法时）*

另一种方法是设置`<p:fileUpload>`为“简单模式”，这样它就只有一个浏览按钮，并且只有在您实际提交表单时才会上传。这样，上传的文件将在与提交表单时**相同的 HTTP 请求期间设置。**

```
<p:fileUpload ... mode="simple" /> 
```

### 也可以看看：

*   [如何选择合适的bean范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)

# iphone - 应用程序在大型数据存储上执行数据迁移时内存不足。我怎样才能在多次传递中做到这一点？

> ID：12411699
> 
> 赞同：0
> 
> 时间：2012-09-13T17:30:07.473
> 
> 标签：iphone, ios, core-data, core-data-migration

当我的应用程序尝试使用标准迁移将旧核心数据迁移到新存储时，如果核心数据存储很大，那么它会耗尽内存并崩溃。

我已经在几个地方看到它提到解决方案是在“多次传递”中进行，但苹果文档在解释这一点时并不太好：

[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreDataVersioning/Articles/vmCustomizing.html#//apple_ref/doc/uid/TP40004399-CH8-SW9](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreDataVersioning/Articles/vmCustomizing.html#//apple_ref/doc/uid/TP40004399-CH8-SW9)

这里的本教程要好得多，显示了代码，但我对这段代码的去向感到困惑：

[多遍核心数据迁移的示例或解释？](https://stackoverflow.com/questions/5995231/example-or-explanation-of-core-data-migration-with-multiple-passes)

这是我的代码：

```
- (NSManagedObjectContext *)managedObjectContext {

    if (managedObjectContext != nil) {
        return managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        managedObjectContext = [NSManagedObjectContext new];
        [managedObjectContext setPersistentStoreCoordinator: coordinator];
    }
    return managedObjectContext;
}

- (NSManagedObjectModel *)managedObjectModel {

    if (managedObjectModel != nil) {
        return managedObjectModel;
    }
    //managedObjectModel = [NSManagedObjectModel mergedModelFromBundles:nil];
    NSString *modelPath = [[NSBundle mainBundle] pathForResource:@"EntryDatabase" ofType:@"momd"];
    NSURL *modelURL = [NSURL fileURLWithPath:modelPath];
    managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];

    return managedObjectModel;
}

- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {

    if (persistentStoreCoordinator != nil) {
        return persistentStoreCoordinator;
    }

    NSString *storePath = [[self applicationDocumentsDirectory] stringByAppendingPathComponent:@"CoreDataStore.sqlite"];

    NSFileManager *fileManager = [NSFileManager defaultManager];

    // If the expected store doesn't exist, copy the default store.
    if (![fileManager fileExistsAtPath:storePath]) {

        NSString *defaultStorePath = [[NSBundle mainBundle] pathForResource:@"CoreDataStore" ofType:@"sqlite"];
        if (defaultStorePath) {
            NSError *error;
            [fileManager copyItemAtPath:defaultStorePath toPath:storePath error:&error];
            NSLog(@"Error");
        }
    }

    persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];

    NSURL *storeUrl = [NSURL fileURLWithPath:storePath];
    NSError *error;
    NSDictionary *pscOptions = [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                                [NSNumber numberWithBool:NO], NSInferMappingModelAutomaticallyOption,
                                nil];

    if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeUrl options:pscOptions error:&error]) {

        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }    

    return persistentStoreCoordinator;
} 
```

我不确定如何在我拥有的代码中实现多次传递 - 例如它应该去哪里。

# jquery - jQuery colorbox - 即使在关闭后也会被调用

> ID：12411702
> 
> 赞同：0
> 
> 时间：2012-09-13T17:30:12.540
> 
> 标签：jquery, colorbox

我面临一个奇怪的问题。检查复选框时，我确实需要显示一个弹出窗口。它工作正常，但即使在取消选中时也会出现相同的弹出窗口。

```
<af:objectImage id="agreementCheckBoxImg" source="/base/images/spacer.gif" styleClass="jqTransformCheckbox" onclick="displayPopup(this.id,'main\\\\:content\\\\:Popupregion\\\\:Popup','520px','260px');return false;"/>

<script type="text/javascript">    
    function displayPopup(buttonId,popId,width,height) {
        var eminputSelf = $("#main\\:content\\:check");
        if (eminputSelf.attr("checked") == true) { // check box condition works fine
            alert('returning do not show popup');
        } else {
            $('#'+needHelpId).colorbox({ open:true, title:'',innerWidth:interWidth, innerHeight:innerHeight,close:'shutdown', inline:true, href:popId , onOpen:function(){ $(popId ).show();}, onCleanup:function(){ $(popId ).hide();}});
        }
    }

</script> 
```

取消选中期间警报即将到来，但弹出窗口也即将到来。

请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:40:23.100

尝试使用：

```
if (eminputSelf.prop("checked") === true) { 
```

`prop()`返回布尔值并随着复选框状态的变化而变化，而`attr()`不会。

[http://api.jquery.com/prop/](http://api.jquery.com/prop/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:45:29.623

试试这个：

```
if (eminputSelf.is(":checked")) { // checked condition
  // existing code
} else {
  // existing code  
} 
```

祝你好运 ！！

# php - The Loop 中的第二个循环弄乱了帖子

> ID：12411703
> 
> 赞同：0
> 
> 时间：2012-09-13T17:30:25.647
> 
> 标签：php, wordpress, post, loops

在我的 Wordpress 帖子页面中，我添加了第二个循环来显示相关帖子。此循环位于显示帖子内容的主循环内。问题是添加第二个循环会弄乱页面上的所有内容。

评论来自不同的帖子，发表新评论会使您跳转到不同的页面等等。

显然，我没有在主循环中正确插入第二个循环。

这是我的代码：

```
<div id="entries">

    <?php if ( have_posts() ) while ( have_posts() ) : the_post(); ?>
        <div class="entry post postpage clearfix">
            <?php if (get_option('aggregate_integration_single_top') <> '' && get_option('aggregate_integrate_singletop_enable') == 'on') echo(get_option('aggregate_integration_single_top')); ?>

            <h1 class="title"><?php the_title(); ?></h1>

            <?php get_template_part('includes/postinfo','single'); ?>

            <?php the_content(); ?>

<!-- START SECOND LOOP -->
<div class="radarcont">

<?php
$category = get_the_category();
$current_category = $category[0]->term_id;
$qarr = array(
    'showposts' => '4',
    'cat' => $current_category,
    'tag' => 'pinned', // filtered tag
    'post__not_in' => array(get_the_ID())
);
$q = new WP_Query($qarr);
if($q->have_posts()) : while ($q->have_posts()) : $q->the_post();
    ?>
<div class="singleradar clearfix">
    <?php
    $thumb = '';
    $width = 130;
    $height = 75;
    $classtext = 'post-image';
    $titletext = get_the_title();
    $thumbnail = get_thumbnail($width,$height,$classtext,$titletext,$titletext,false,'Recent');
    $thumb = $thumbnail["thumb"];
    ?>

    <?php if($thumb <> '' && get_option('aggregate_thumbnails_index') == 'on') { ?>
    <div class="thumb">
        <a href="<?php the_permalink(); ?>">
            <?php print_thumbnail($thumb, $thumbnail["use_timthumb"], $titletext, $width, $height, $classtext); ?>
            <span class="overlaymed"></span>
        </a>
    </div>  <!-- end .post-thumbnail -->
    <?php } ?>

    <h3 class="title"><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
</div> <!-- end .block-post -->

<?php endwhile; endif;?>

</div> <!-- end .radarcont -->
<!-- END SECOND LOOP -->

        </div> <!-- end .entry -->          

        <?php if (get_option('aggregate_show_postcomments') == 'on') comments_template('', true); ?>

    <?php endwhile; // end of the loop. ?> 
```

**我怎样才能解决这个问题？**如何调整第二个循环，以免弄乱其余部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:41:24.863

循环完第二个循环后，您必须使用以下命令重置您的帖子数据：

```
wp_reset_postdata(); 
```

更多信息：[http ://codex.wordpress.org/Function_Reference/wp_reset_postdata](http://codex.wordpress.org/Function_Reference/wp_reset_postdata)

# android - Android - SharedPreferences 和 NullPointException

> ID：12411711
> 
> 赞同：0
> 
> 时间：2012-09-13T17:30:49.497
> 
> 标签：android, nullpointerexception, sharedpreferences

**编辑**：问题不在于 SharedPreference！这是我的 wav 数据。Android 仅支持 8 位和 16 位线性 PCM 波形格式。我使用了 32 位浮点数。

今天我通过 BugSense 收到了一个错误报告。由于 sharedPreferences，用户有 NullPointException。我第一次收到这个错误。

这是我的相关代码：

我设置 sharedPreference 的设置：

```
private void dialogSettings() {
    final Dialog dialog = new Dialog(this, R.style.dialog_style);
    dialog.setContentView(R.layout.dialog_settings);
    final CheckBox sound = (CheckBox) dialog.findViewById(R.id.checkBoxSound);
    final CheckBox vibration = (CheckBox) dialog.findViewById(R.id.checkBoxVibration);
    final SharedPreferences pref = getSharedPreferences("SETTINGS", 0);
    sound.setChecked(pref.getBoolean("SOUND", true));
    vibration.setChecked(pref.getBoolean("VIBRATION", true));
    Button buttonSave = (Button) dialog.findViewById(R.id.buttonSave);
    buttonSave.setOnClickListener(new OnClickListener() {       
        public void onClick(View v) {
            SharedPreferences.Editor editor = pref.edit();
            editor.putBoolean("SOUND", sound.isChecked());
            editor.putBoolean("VIBRATION", vibration.isChecked());
            editor.commit();
            dialog.dismiss();
        }
    });
    dialog.show();
} 
```

“SOUND”（其他活动）的使用：

```
private boolean SOUND;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.game_normal_layout);
    SharedPreferences pref = getSharedPreferences("SETTINGS", 0);
    SOUND = pref.getBoolean("SOUND", true); 
    ....
}

private void evaluateAnswer() {
    if(correct) {
        if(SOUND) {  // LINE 259
            ding.seekTo(0);
            ding.start();
        }
    ...
} 
```

这是例外：

```
java.lang.NullPointerException
at mindmApp.quiz.GameNormalActivity.evaluateAnswer(GameNormalActivity.java:259) 
```

因此，变量 SOUND 为空。但为什么？因为 SOUND = pref.getBoolean("SOUND", true) 它**必须**被初始化，或者不是？

谢谢大家的帮助，

最好的祝福！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:43:05.623

SOUND 不能为 null（布尔值是原始类型，可以未初始化，但不能为 null）。更可能的答案是“ding”为空。

# c++ - VS2010 未正确处理预处理器条件中的“包含”

> ID：12411712
> 
> 赞同：0
> 
> 时间：2012-09-13T17:30:56.903
> 
> 标签：c++, visual-studio-2010, compiler-construction

我有一个相当大的 VS2010 C++ 解决方案。解决方案中只有一个项目，因此项目之间没有相互依赖关系。问题是，当我从 GIT 中提取更新时，VS2010 有时不够聪明，无法重建受更新的新文件影响的翻译单元。这会导致可执行文件不可避免地以某种虚假方式崩溃。

这对我来说很痛苦，因为我不能相信部分构建，并且每当我在 git 中跳来跳去时都不得不进行完全重建，这会降低生产力。

注意：我没有以任何方式责怪 git，我只是指出我的过程以防万一。另请注意：当我构建时，我右键单击项目并选择“构建”。

有谁知道“调试”这个编译器的方法，知道为什么它没有注意到它需要重建依赖于更改的其他文件？

编辑：经过进一步调查，我可以排除我使用 GIT 的问题。我可以通过编辑包含在许多地方的头文件来重现这一点，保存它然后运行不想构建任何新文件的“构建”。

编辑2：问题似乎与#defines 有关。我有一个仅包含在另一个标头中的标头...并且仅在#defines 指定的某些条件下才包含在该标头中。所以我们有#if COND1 #elif COND2 #else < 有问题的问题标题#endif 并且已经损坏。如果我将包含从其他情况中取出，它会触发依赖项以正确编译！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:48:18.347

我既不知道 git 也不知道 VS2010，但是当我看到基于 make 的系统的这种行为时，通常是因为版本控制系统正在拉取文件并给它提交的时间（甚至是它的修改时间）当它被提交时）。然后构建系统认为“源”文件仍然比“目标”文件旧，并且无法重建内容。

看看你是否可以找到一个选项让 git 在它执行拉取时不修复文件时间。相反，您希望新提取的文件具有当前时间。

我怀疑这将为您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:43:21.597

如果问题是，正如您在 EDIT2 中所说，VS 的依赖检查器未检测到头文件，您可以使用以下技巧解决它：

*   `touch`获取 Windows 的和实用程序的副本`test`（例如从[GNUWin32 站点](http://gnuwin32.sourceforge.net/packages/coreutils.htm).
*   编写一个*预构建命令*，将修改时间从 utracked 标头复制到跟踪的标头，但前提是它较新：

就像是：

```
test.exe untracked.h -nt tracked.h && touch.exe -r untracked.h tracked.h 
```

PS：也许你可以使用 PowerShell 编写相同的想法，但我不知道如何。

# objective-c - 编写抽象类自定义初始化方法

> ID：12411714
> 
> 赞同：1
> 
> 时间：2012-09-13T17:31:03.510
> 
> 标签：objective-c, methods, initialization, abstract-class, class-method

在抽象类中，自定义的 init 方法如下所示：

```
- (id)init
{
    self = [super init];

    if (self)
    {
        //do some initialisations
    }

    return self;
} 
```

这在使用抽象类时会非常好用：完全没有问题。但是，在创建对象时，我更`Class *object = [Class new];`喜欢`Class *object = [[Class alloc]init];`. 在我的抽象类中使用这种方法的问题在于这不起作用：

```
+ (id)new
{
    id object = [super new];

    if (object)
    {
        //do some initialisations
    }

    return object;
} 
```

当试图访问对象的属性时，Xcode 会报错，说在 '__strong id' 类型的对象上找不到相应的属性。我猜那是因为编译器不知道我的对象有什么属性，因为它刚刚被创建。

有没有办法绕过这个限制？如果没有，我将只使用 init 方法，因为它工作得很好，但我只是对此感到好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:52:04.700

您不需要覆盖`new`. 根据文件，`new`...

> 分配接收类的新实例，向其发送初始化消息，并返回初始化对象。

所以你只需要重写`init`来执行你的初始化。然后，您可以根据自己的喜好通过`alloc/init`或自由创建实例。`new`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:54:33.143

```
+ (id)new
{
    return [[self alloc] init;
} 
```

请注意，`+`而不是`-`因为这是一个类方法。

除非你不需要写，因为 new 已经在 NSObject 中实现了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:01:46.883

我不会建议您使用的模式。创建自定义工厂方法初始化方法更具语义：

```
- (id) init
{
   // init code
}

- (id) initWithName:(NSString *)name
{
   // init code
}

+ (id) personWithName:(NSString *)name
{
    // add autorelease on non-ARC
    return [[super alloc] initWithName:name];
}

Person *person = [Person personWithName:@"Steve Jobs"]; 
```

请注意，它是一个类方法。

# haproxy - Haproxy 和新贵脚本

> ID：12411715
> 
> 赞同：1
> 
> 时间：2012-09-13T17:31:05.160
> 
> 标签：haproxy, upstart

我是 HA 代理和 Upstart 脚本的新手。我正在使用 HA 代理版本 1.4.18 2011/09/16。我正在尝试编写一个新贵脚本，以防 haproxy 死亡时保持 haproxy 存活。这就是我目前所拥有的：

script
if [ $(pgrep haproxy) ]; 然后
重启haproxy；
否则
启动 haproxy；
fi
end script

看起来像清晰的代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:23:59.493

如果你想让它成为最书呆子和单行脚本：

```
[ $(pgrep haproxy) ] && restart haproxy || start haproxy 
```

顺便说一句 .. 最简单和最好的方法是使用这样的 init.d 自定义脚本：http: [//mattiasgeniar.be/2010/11/04/a-custom-init-d-start-up-script -for-haproxy-start-stop-restart-reload-checkconfig/](http://mattiasgeniar.be/2010/11/04/a-custom-init-d-start-up-script-for-haproxy-start-stop-restart-reload-checkconfig/)

# ruby-on-rails - 您的 Gemfile 中存在错误，并且 Bundler 无法继续

> ID：12411717
> 
> 赞同：3
> 
> 时间：2012-09-13T17:31:12.310
> 
> 标签：ruby-on-rails, ruby, gem, bundler

将 Rails 升级到 3.2.8 后，在创建新应用程序时出现此错误：

```
/usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/lib/bundler/source.rb:271: uninitialized constant Bundler::GemInstaller (NameError)
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/lib/bundler/dsl.rb:21:in `initialize'
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/lib/bundler/dsl.rb:6:in `new'
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/lib/bundler/dsl.rb:6:in `evaluate'
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/lib/bundler/definition.rb:18:in `build'
   /usr/lib/ruby/vendor_ruby/bundler.rb:136:in `definition'
   /usr/lib/ruby/vendor_ruby/bundler/cli.rb:222:in `install'
   /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/task.rb:22:in `send'
   /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/task.rb:22:in `run'
   /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
   /usr/lib/ruby/vendor_ruby/bundler/vendor/thor.rb:246:in `dispatch'
   /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/base.rb:389:in `start'
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/bin/bundle:14
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/lib/bundler/friendly_errors.rb:4:in `with_friendly_errors'
   /usr/lib/ruby/gems/1.8/gems/bundler-1.2.0/bin/bundle:14

There was an error in your Gemfile, and Bundler cannot continue. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T09:56:19.137

我将捆绑器降级到 1.1.5 以“解决”这个问题：

```
gem uninstall bundler
gem install bundler -v 1.1.5 
```

# c# - 在c#中检查整数溢出而不抛出异常

> ID：12411722
> 
> 赞同：0
> 
> 时间：2012-09-13T17:31:19.947
> 
> 标签：c#, integer-overflow

如果我在 c# 中将 2 个正数相加，如果溢出不是应该导致异常的条件，那么检查整数溢出的最佳方法是什么？

我可以检查结果是否为负那么它是溢出吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:32:40.343

如果溢出正常，您*可以*检查是否为负数，但这并不能说明足够大的溢出。如果它溢出到足以再次变为正数，那么检查负数显然是行不通的。

但是对于两个正整数，检查负数就可以了。

# perl - 使用 Perl LWP 欺骗 IP

> ID：12411723
> 
> 赞同：5
> 
> 时间：2012-09-13T17:31:25.987
> 
> 标签：perl, testing, networking, ip, spoofing

我需要编写一小段代码来模拟来自不同源 IP 地址的流量，我想知道这是否可以通过使用 Perl 欺骗地址来完成？

我尝试了 Net::RAWIP 并且有效，但是我需要发送一些更复杂的 HTTP 流量（即 POST 数据）并且无法使用 RAWIP

使用 LWP，我尝试使用 ua->local_address 但得到以下响应：

```
Can't connect to 10.x.x.x:8080

LWP::Protocol::http::Socket: Cannot assign requested address at /usr/lib/perl5/site_perl/5.10.0/LWP/Protocol/http.pm line 51. 
```

这是我正在使用的代码：

```
#!/usr/bin/perl -w

use strict ;
use warnings ;
use LWP::UserAgent ;
use URI::URL ;

my $path = 'http://142.133.114.130:8080' ;
my $url = new URI::URL $path;
my $ua       = LWP::UserAgent->new();

$ua->local_address('10.121.132.112');
$ua->env_proxy ;
my $effing = 'blaj.jpg' ;
my $response = $ua->post( $url,
                        'Content-Type' => "multipart/form-data",
                        'Content' => [ userfile => ["$effing" ]],
                        'Connection' => 'keep-alive' ) ;
print $response->decoded_content(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:40:32.913

如果您从不属于您的地址发送，您将无法得到回复。这意味着您所能做的就是发送请求。你已经表明你可以发送，所以你只需要发送请求。这很容易。

```
use strict;
use warnings;

use HTTP::Request::Common qw( POST );

my $req = POST('http://www.example.org/',
   'Content-Type' => "multipart/form-data",
   'Content'      => [ userfile => [ $0 ]],
   'Connection'   => 'keep-alive',
);

print $req->as_string(); 
```

输出：

```
POST http://www.example.org/
Connection: keep-alive
Content-Length: 376
Content-Type: multipart/form-data; boundary=xYzZY

--xYzZY
Content-Disposition: form-data; name="userfile"; filename="x.pl"
Content-Type: text/plain

use strict;
use warnings;

use HTTP::Request::Common qw( POST );

my $req = POST('http://www.example.org/',
   'Content-Type' => "multipart/form-data",
   'Content'      => [ userfile => [ $0 ]],
   'Connection'   => 'keep-alive',
);

print $req->as_string();

--xYzZY-- 
```

# javascript - 将多维数组转换为javascript中的对象数组

> ID：12411724
> 
> 赞同：0
> 
> 时间：2012-09-13T17:31:29.827
> 
> 标签：javascript, jquery, arrays, object

我有一个多维数组 (retdata[R][C])，它基本上看起来像一个单元格电子表格。R代表行，C代表列。我想创建一个对象数组，以便获得以下内容

```
 [{retdata[1][1]:retdata[2][1],retdata[1][2]:retdata[2][2],retdata[1][3]:retdata[2][3]    }, 
  {retdata[1][1]:retdata[3][1],retdata[1][2]:retdata[3][2],retdata[1][3]:retdata[3][3]    },
  {retdata[1][1]:retdata[4][1],retdata[1][2]:retdata[4][2],retdata[1][3]:retdata[4][3]    }, 
 etc...
] 
```

结果数组应为：

```
 [{"Col1":"dataR2C1","Col2":"dataR2C2", "Col3":"dataR2C3"}, 
 {"Col1":"dataR3C1","Col2":"dataR3C2", "Col3":"dataR3C3"}, 
 {"Col1":"dataR4C1","Col2":"dataR4C2", "Col3":"dataR4C3"}, 
 etc...
] 
```

我尝试了多种选择，但均未成功。任何帮助将不胜感激。

这是我使用的一个示例，但它没有正确序列化对象。

```
 var TABLE = [];
                for (var i=2; i<=rows; i++) {
                    var ROW = {};                       
                    for (var j=1; j<=columns; j++){
                        name = retdata[1][j].toString;
                        value = retdata[i][j].toString;
                        ROW += {name: value}
                    }

                TABLE += ROW;   

                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:46:05.407

这就像一个 CSV 解析器，表的第一行是行对象的键。你的函数可以工作，但你需要更正你的数组索引：它们总是从 开始`0`，一直运行到`n-1`. 此外，您需要学习一点 JavaScript 语法：

*   *某些东西*`.toString`不会对该值调用 toString 函数，而是获取该函数（它只是一个对象）。
*   您根本不需要 toString - 在需要的地方，值会自动转换
*   您不能使用简单的运算符将键值对添加到对象。您需要使用括号表示法将值分配给对象的该属性。`+=`操作员会将值转换为字符串并将它们连接起来。
*   数组也是一样。您可以使用该`.push()`方法，或者仅分配给数字键 - javascript 数组对象将自动更新其长度。

```
var retdata = […];

var table = [],
    keys = retdata.shift(); // get & remove the first row
for (var i=0; i<retdata.length; i++) {
    var row = {};
    for (var j=0; j<retdata[i].length; j++)
        row[ keys[j] ] = retdata[i][j];
    table[i] = row;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T18:00:30.250

谢谢伯吉。这是我的最终解决方案：

```
 var TABLE = [];
                for (var i=2; i<=rows; i++) {
                    var ROW = {};                       
                    for (var j=1; j<=columns; j++){
                        ROW [retdata[1][j]] = retdata[i][j];
                    }
                TABLE[i]= ROW;  
                } 
```

哪个有效。转变没有按预期工作，但上面的代码正是我所需要的。谢谢！

# sharepoint - 如何让 MD5/digest 身份验证适用于不同的域？

> ID：12411727
> 
> 赞同：4
> 
> 时间：2012-09-13T17:31:47.210
> 
> 标签：sharepoint, iis, digest-authentication

我被要求在域 B 的服务器上设置一个 SharePoint 站点（在 2008 R2 的 IIS7 下运行），以便域 A 中的人可以使用 MD5/Digest 身份验证通过 HTTP 登录它。存在信任关系，因此 B 信任 A，这适用于 Kerberos 身份验证。我们已经为密码设置了可逆加密，并检查了域 B 用户可以使用 Digest 登录，但是我们无法获取它以便域 A 用户（与 SharePoint 服务器不在同一域中）可以使用 MD5/Digest 登录通过http。我们还与 WireShark 核对了浏览器本身的行为（它是 Server 2008 R2 附带的 IE 版本 - 我认为是 IE7，但我没有写下来）。

您能否告诉我如何正确设置它，或者提供指向 Microsoft 或其他合理权威文档的链接，该文档表明无法执行此操作？

（顺便说一下，我们使用的是 SharePoint Foundation（免费版））

我正在编辑一些更新的信息，以防其他人点击它，因为我希望有任何进一步的建议来添加，而不是复制它。

1) 我在两台服务器上设置 SharePoint，然后更改其中一台的域，将应用程序池用户留在原始域中。经过一番折腾（从原始域添加 DNS 后缀，摆弄 AAM），我发现我可以在两台服务器中使用摘要进行身份验证，对与服务器相同域中的用户进行身份验证 - 我不确定这是否是推荐的配置但我认为这是一个有趣的实验。所以这看起来像是 Windows 功能，而不是 SharePoint 功能。

2) 猜到了，我更改了搜索词，在[http://technet.microsoft.com/en-us/library/cc778868%28v=ws.10%29.aspx](http://technet.microsoft.com/en-us/library/cc778868%28v=ws.10%29.aspx)找到“Web 服务器必须是与用户帐户相同的森林。” 我认为我的设置对应于不同的森林，所以这看起来很像“这种行为是设计使然”的窗口功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T18:30:54.647

您是否尝试过以下适用于 SP2010 的 cmd 命令：stsadm -o setproperty -pn "peoplepicker -searchforests" -pv "forest:[currentDomainName],[Username],[Password];domain:[newTrustedDomainName],[Username],[ Password]" -url "[YourSiteUrl]" 如果需要，请确保您有备用访问映射。

一般来说，受信任的域应该不是问题，但是我不确定 MD5 ......

# c# - 如何在 LINQ 查询中指定自定义方法（C# 实体框架）

> ID：12411728
> 
> 赞同：3
> 
> 时间：2012-09-13T17:31:51.047
> 
> 标签：c#, linq, entity-framework, iqueryable

我已经定义了一个超类“有效性”，它定义了一个对象是“有效”的时间跨度（ValidFrom / ValidTo）。它还定义了一个函数，该函数对于给定的时间戳返回 true，当且仅当（当且仅当）一个（派生的）对象在此时有效。

```
public class Validity
{
    public int ValidityID { get; set; }

    public DateTime? ValidFrom { get; set; }
    public DateTime? ValidTo { get; set; }

    bool isValidAt(DateTime time)
    {
        return (ValidFrom == null || ValidFrom >= time)
            && (ValidTo == null || ValidTo < time);
    }
} 
```

现在我想编写一些在 LINQ 查询中检查 isValidAt 的函数。我想这可以通过 IQueriable 实现，但我不知道如何......以下代码片段是我希望以某种方式“工作”的（尤其是`where n.isValidAt(t)`）。那么，如何实现呢？

```
public class Node : Validity {
    public int NodeID { get; set; }

    public static getFirstNode(DateTime t)
    {
        MyContext db = new MyContext();
        var items = from n in db.Nodes
                     where n.isValidAt(t)
                     orderby n.NodeID descending
                     select n;
        return items.FirstOrDefault<Node>();
    }
} 
```

--- 工作解决方案 ---

我需要稍微调整一下 Zaid Masud 的解决方案，让它发挥作用。请注意，我必须删除`this`参数列表中的 （现在方法定义是`public static IQueryable<T> isValidAt<T>(IQueryable<T> query, DateTime time) where T : Validity`）。这是源代码：

```
public class Validity
{
    public int ValidityID { get; set; }

    public DateTime? ValidFrom { get; set; }
    public DateTime? ValidTo { get; set; }

    public static IQueryable<T> isValidAt<T>(IQueryable<T> query, DateTime time) where T : Validity
    {
        return query.Where<T>(c => (c.ValidFrom == null || c.ValidFrom >= time)
            && (c.ValidTo == null || c.ValidTo < time));
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:47:16.423

您需要将您的`bool isValidAt(DateTime time)`方法声明为受保护的，以便派生类可以访问它：

```
protected bool IsValidAt(DateTime time) 
```

但是，在您进行此编译后，我怀疑您的 LINQ to SQL 提供程序是否能够将查询转换为 SQL。您可能需要在 LINQ 查询中嵌入逻辑并编写如下内容：

```
var items = from n in db.Nodes
            where (n.ValidFrom == null || n.ValidFrom >= t) && (n.ValidTo == null || n.ValidTo < t)
            orderby n.NodeID descending
            select n; 
```

这将起作用，但更好的选择是创建以下类型的扩展方法：

```
public static class ValidityExtensions
{
    public static IQueryable<T> Valid<T>(this IQueryable<T> validities, DateTime time) where T : Validity
    {
        return validities.Where(v => (v.ValidFrom == null || ValidFrom >= time) && (v.ValidTo == null || v.ValidTo < time));
    }
} 
```

现在您可以按如下方式使用它：

```
var items = from n in db.Nodes.Valid(time)
            orderby n.NodeID descending
            select n; 
```

# mysql - 如何从 MYSQL 数据库中删除所有视图？

> ID：12411732
> 
> 赞同：2
> 
> 时间：2012-09-13T17:32:19.637
> 
> 标签：mysql, sql-drop

我的数据库有很多视图，不可能一一删除。

我想将它们全部删除，因为数据库不会刷新从中选择的视图中表的结构更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:39:10.177

如果您想在 MySQL 客户端中执行此操作，您可以使用 information_schema 动态生成 DDL 语句，将它们转储到 SQL 脚本，然后执行该脚本。

例子：

```
select concat('drop view ',table_schema,'.',table_name,';') as ddl 
into outfile '/tmp/drop_all_views.sql' 
from information_schema.views 
where table_schema = 'your_schema';

\. /tmp/drop_all_views.sql 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:32:19.637

在网上搜索后，我找到了一个 shell 脚本来删除所有表：[http ://www.cyberciti.biz/faq/how-do-i-empty-mysql-database/](http://www.cyberciti.biz/faq/how-do-i-empty-mysql-database/)

然后，我更改了该脚本以删除数据库的所有视图。这是最终结果：

```
#!/bin/bash
PREFIX=""
SUFFIX=""
HOST="localhost"
PORT="3306"

while getopts p:s:h:P: OPCAO; do
    case "${OPCAO}" in
      p) PREFIX="${OPTARG}" ;;
      s) SUFFIX="${OPTARG}" ;;
      h) HOST="${OPTARG}" ;;
      P) PORT="${OPTARG}" ;;
    esac
done

shift $((OPTIND-1))

MUSER="$1"
MPASS="$2"
MDB="$3"

# Detect paths
MYSQL=$(which mysql)
AWK=$(which awk)
GREP=$(which grep)

if [ $# -eq 0 ]
then
    echo "Usage: $0 [-h Host] [-P Port] [-p Prefix-View-Name] [-s Suffix-View-Name] {MySQL-User-Name} {MySQL-User-Password} {MySQL-Database-Name}"
    echo "Drops all views from a MySQL"
    exit 1
fi

TABLES=$($MYSQL -h $HOST -P $PORT -u $MUSER -p$MPASS $MDB -e "SELECT table_name FROM information_schema.views WHERE table_schema = '$MDB' AND table_name LIKE '$PREFIX%$SUFFIX';" | $AWK '{ print $1}')

for t in $TABLES
do
    echo "Deleting $t view from $MDB database..."
    $MYSQL -h $HOST -P $PORT -u $MUSER -p$MPASS $MDB -e "drop view $t"
done 
```

该解决方案仅适用于使用类 Unix 系统的用户。

为了调用脚本，我使用了：

```
./script.sh [-h host] [-P port] [-p prefixViewName] [-s suffixViewName] username password databaseName 
```

编辑：我改进了脚本以接受选项参数，例如主机、端口以及前缀和后缀，以过滤将删除哪些视图。

# commerce - 我可以使用 Microsoft Commerce 服务器、目录 API 和 Windows 服务应用程序吗

> ID：12411737
> 
> 赞同：0
> 
> 时间：2012-09-13T17:32:32.247
> 
> 标签：commerce, microsoft-commerce-server

我之前使用过“Microsoft Commerce server 2007”，并使用它的 Catalog API 在我的网站中获取产品数据。但是我有个需求做一个windows服务，使用commerce产品目录数据，但是不知道怎么调整这个服务的APP.Config来获取数据。

每次我尝试商业代码时，它都会返回 Null "CommerceContext.Current"== null

任何想法或示例配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:15:05.710

`CatalogContext`您需要在本地或代理模式下创建对象。有关详细信息，请参阅[如何创建 CatalogContext 对象](http://msdn.microsoft.com/en-us/library/ms944262%28v=cs.70%29.aspx)。

`CommerceContext.Current`仅在 ASP.NET Web 应用程序的上下文中运行时为非空。

# php - 你如何使用 PHP OpenPGP 库？

> ID：12411738
> 
> 赞同：20
> 
> 时间：2012-09-13T17:32:31.963
> 
> 标签：php, gnupg, openpgp

[gnupg](http://www.gnupg.org/) PGP 库有一个[PHP 扩展端口](http://www.php.net/manual/en/book.gnupg.php)。但是，我很难找到解释如何使用该库的[示例。](http://www.php.net/manual/en/gnupg.examples-clearsign.php)

您如何正确地为应用程序用户创建密钥，然后使用 GnuPG 库使用它们来加密/解密文本？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-17T18:46:00.443

看到这个 URL 它对你很有帮助。下载示例并尝试一下。

[https://github.com/singpolyma/openpgp-php](https://github.com/singpolyma/openpgp-php)

**或试试看：-**

您可以在 URL 上方下载**lib/openpgp.php**和**lib/openpgp_crypt_rsa.php文件。**

**示例/keygen.php**

```
<?php

require dirname(__FILE__).'/../lib/openpgp.php';
require dirname(__FILE__).'/../lib/openpgp_crypt_rsa.php';

$rsa = new Crypt_RSA();
$k = $rsa->createKey(512);
$rsa->loadKey($k['privatekey']);

$nkey = new OpenPGP_SecretKeyPacket(array(
   'n' => $rsa->modulus->toBytes(),
   'e' => $rsa->publicExponent->toBytes(),
   'd' => $rsa->exponent->toBytes(),
   'p' => $rsa->primes[1]->toBytes(),
   'q' => $rsa->primes[2]->toBytes(),
   'u' => $rsa->coefficients[2]->toBytes()
));

$uid = new OpenPGP_UserIDPacket('Test <test@example.com>');

$wkey = new OpenPGP_Crypt_RSA($nkey);
$m = $wkey->sign_key_userid(array($nkey, $uid));

print $m->to_bytes(); 
```

**例子/sign.php**

```
<?php

require dirname(__FILE__).'/../lib/openpgp.php';
require dirname(__FILE__).'/../lib/openpgp_crypt_rsa.php';

/* Parse secret key from STDIN, the key must not be password protected */
$wkey = OpenPGP_Message::parse(file_get_contents('php://stdin'));
$wkey = $wkey[0];

/* Create a new literal data packet */
$data = new OpenPGP_LiteralDataPacket('This is text.', array('format' => 'u', 'filename' => 'stuff.txt'));

/* Create a signer from the key */
$sign = new OpenPGP_Crypt_RSA($wkey);

/* The message is the signed data packet */
$m = $sign->sign($data);

/* Output the raw message bytes to STDOUT */
echo $m->to_bytes();

?> 
```

**示例/验证.php**

```
<?php

require dirname(__FILE__).'/../lib/openpgp.php';
require dirname(__FILE__).'/../lib/openpgp_crypt_rsa.php';

/* Parse public key from STDIN */
$wkey = OpenPGP_Message::parse(file_get_contents('php://stdin'));
$wkey = $wkey[0];

/* Parse signed message from file named "t" */
$m = OpenPGP_Message::parse(file_get_contents('t'));

/* Create a verifier for the key */
$verify = new OpenPGP_Crypt_RSA($wkey);

/* Dump verification information to STDOUT */
var_dump($verify->verify($m));

?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-20T17:35:35.073

它们是非常好的基于[PHP 扩展端口](https://www.php.net/manual/en/book.gnupg.php)的示例， 您是否有要求，我们将看一些示例

[在 PHP 中使用 GnuPG -- 完整教程](http://devzone.zend.com/1278/using-gnupg-with-php/)

## 例子

### 获取关键信息

```
putenv('GNUPGHOME=/home/sender/.gnupg');

// create new GnuPG object
$gpg = new gnupg();

// throw exception if error occurs
$gpg->seterrormode(gnupg::ERROR_EXCEPTION); 

// get list of keys containing string 'example'
try {
  $keys = $gpg->keyinfo('example');
  print_r($info);
} catch (Exception $e) {
  echo 'ERROR: ' . $e->getMessage();
} 
```

### 加密简单邮件

```
// set path to keyring directory
// set path to keyring directory
putenv('GNUPGHOME=/home/sender/.gnupg');

// create new GnuPG object
$gpg = new gnupg();

// throw exception if error occurs
$gpg->seterrormode(gnupg::ERROR_EXCEPTION); 

// recipient's email address
$recipient = 'dgar@example.org';

// plaintext message
$plaintext = 
"Dear Dave,\n
  The answer is 42.\n
John";

// find key matching email address
// encrypt plaintext message
// display and also write to file
try {
  $gpg->addencryptkey($recipient);
  $ciphertext = $gpg->encrypt($plaintext);
  echo '<pre>' . $ciphertext . '</pre>';
  file_put_contents('/tmp/ciphertext.gpg', $ciphertext);
} catch (Exception $e) {
  die('ERROR: ' . $e->getMessage());
} 
```

### 解密邮件

```
// set path to keyring directory
putenv('GNUPGHOME=/home/recipient/.gnupg');

// create new GnuPG object
$gpg = new gnupg();

// throw exception if error occurs
$gpg->seterrormode(gnupg::ERROR_EXCEPTION); 

// recipient's email address
$recipient = 'dgar@example.org';

// ciphertext message
$ciphertext = file_get_contents('/tmp/ciphertext.gpg');

// register secret key by providing passphrase
// decrypt ciphertext with secret key
// display plaintext message
try {
  $gpg->adddecryptkey($recipient, 'guessme');
  $plaintext = $gpg->decrypt($ciphertext);
  echo '<pre>' . $plaintext . '</pre>';
} catch (Exception $e) {
  die('ERROR: ' . $e->getMessage());
} 
```

您还应该查看示例

*   [http://www.developertutorials.com/pear-manual/package.encryption.crypt-gpg.examples.html](http://www.developertutorials.com/pear-manual/package.encryption.crypt-gpg.examples.html)
*   [http://oregonstate.edu/cws/docs/gpgwrap](http://oregonstate.edu/cws/docs/gpgwrap)
*   [http://www.phpclasses.org/package/1724-PHP-Encrypt-data-and-manipulate-keys-using-gnuPG.html](http://www.phpclasses.org/package/1724-PHP-Encrypt-data-and-manipulate-keys-using-gnuPG.html)

# eclipse - 在 Eclipse 快捷方式中最大化代码选项卡

> ID：12411750
> 
> 赞同：53
> 
> 时间：2012-09-13T17:33:20.450
> 
> 标签：eclipse, editor

是否有任何快捷方式可以最大化您在 Eclipse 中处理的选项卡？假设我正在处理部分代码，并且我想最大化选项卡而不是使用鼠标双击它，有人知道方法吗？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-09-13T17:47:47.527

`Ctrl``M`将最大化/恢复编辑器区域。

如果您无法记住所有快捷方式，那么只需学习`Ctrl``Shift``L`. 这将显示可用快捷方式的列表。

可以在外部站点上找到[更多快捷方式。](http://www.vogella.com/articles/EclipseShortcuts/article.html)

# objective-c - 如何在 for 循环中操作视图

> ID：12411758
> 
> 赞同：0
> 
> 时间：2012-09-13T17:33:48.137
> 
> 标签：objective-c, view, for-loop, nsthread

我想在`for`循环中操作视图。我在循环中操作视图`for`，然后在`for`循环结束后立即完成视图的操作。我尝试使用 GCD 等其他线程，但我注意到主线程中有一个视图。操作返回到主线程，并在`for`循环结束后被推迟。

我想要做的是在`for`循环中更新 UITextView 的文本。如果我不能`for`在另一个线程中操作循环，我该怎么做？还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:42:16.933

**解决方案 1：使用计时器**

为了逐步将文本添加到文本视图，您可以使用 NSTimer。

*要求*

在您的界面中 - 以下 ivars 或属性：

```
UITextView *textView;

NSNumber *currentIndex;

NSTimer *timer;

NSString *stringForTextView; 
```

假设创建了字符串并设置了 textview，您可以创建一个函数来创建计时器并将其启动：

```
- (void) updateTextViewButtonPressed
{

   timer = [NSTimer scheduledTimerWithTimeInterval:.5
                                     target:self
                                   selector:@selector(addTextToTextView)
                                   userInfo:nil
                                    repeats:YES];

}

- (void) addTextToTextView
{
    textView.text = [string substringToIndex:currentIndex.integerValue];
    currentIndex = [NSNumber numberWithInt:currentIndex.integerValue + 1];

    if(currentIndex.integerValue == string.length)
    {
        [_timer invalidate];
        timer = nil;
    }
} 
```

这是一个基本的工作实现，如果在类级别不存在，您可以更改它以将字符串作为 userInfo 传递给计时器。然后你可以在你的`addTextToTextView`选择器中使用`sender.userInfo`. 您还可以调整计时器间隔以及添加文本的准确方式。我以半秒和逐字符连接为例。

* * *

**解决方案 2：使用循环**

*要求*

```
NSString *string

UITextview *textView

- (void) updateTextViewButtonPressed
{
    // perform the actual loop on a background thread, so UI isn't blocked
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^()
                   {
                       for (int i = 0; i < string.length; i++)
                       {
                           // use main thread to update view
                           dispatch_async(dispatch_get_main_queue(), ^()
                                          {
                                              textView.text = [string substringToIndex:i];

                                          });

                           // delay
                           [NSThread sleepForTimeInterval:.5];
                       }
                   });

} 
```

# android - 生成清单文件时缺少意图过滤器标记

> ID：12411760
> 
> 赞同：0
> 
> 时间：2012-09-13T17:33:58.627
> 
> 标签：android, android-manifest, intentfilter

我新安装了eclipse和sdk，现在我注意到，每次我创建一个新的android项目时，新创建的项目中总是缺少以下几行，我必须手动附加它们

```
<intent-filter>
           <action android:name="android.intent.action.MAIN" />
           <category android:name="android.intent.category.LAUNCHER" />
</intent-filter> 
```

有没有办法让这些行在我每次创建新项目时自动生成，而不是手动添加它们？

# css - :before 带有属性选择器

> ID：12411761
> 
> 赞同：4
> 
> 时间：2012-09-13T17:34:16.780
> 
> 标签：css, forms, css-selectors

我有以下html表单

```
<div>
    <p>Field1</p>
    <input type="text" name="fld_one" id="fld_one" value="" />
</div>
<div>
    <p>Field2</p>
    <input type="text" name="fld_two" id="fld_two" required value="" />
</div> 
```

我想使用 CSS 来标记这样的必填字段

```
div input[required]:before { color: #f00; content: "*"; } 
```

但是，此 css 行不会在文档中进行可见更改。

作为参考，我可以使用以下内容修改所有必填字段：

```
div input[required] { background-color: #000; } 
```

TL;DR - :before 伪类可以与属性选择器一起使用吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:39:11.027

`:before`是伪元素，不是伪类。它可以与属性选择器一起使用，但在`input`某些浏览器中不能与元素一起使用，因为它是替换元素。（一些浏览器，因为它们是否应该工作[并没有很好的定义](http://www.w3.org/TR/CSS21/generate.html#before-after-content)，尽管大多数人倾向于“不”。）

属性选择器起作用的原因是因为您将样式应用于`input`元素本身，这在每个浏览器中都可以始终如一地工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T17:39:45.287

伪元素[不适用于`input`元素](https://stackoverflow.com/a/4574946/871050)，因为它们没有内容。

从[规格](https://www.w3.org/TR/CSS2/generate.html#before-after-content)：

> 作者使用 :before 和 :after 伪元素指定生成内容的样式和位置。正如它们的名字所表明的，:before 和 :after 伪元素指定了*元素的文档树内容*之前和之后的内容位置。'content' 属性与这些伪元素一起指定插入的内容。

输入元素在 DOM 中没有子节点，因此没有要插入的内容属性。

* * *

作为一种可能的解决方法，将星号应用于**标签**而不是输入元素

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T17:41:51.883

`:before`无效，`<input>`因为它没有“内容” - 请参阅：[CSS content generation before or after 'input' elements](https://stackoverflow.com/questions/4574912/css-content-generation-before-input-elements)以获得完整解释。

“传统”的做法是在`p`or上插入 * `label`（标签更具语义）。

# ruby-on-rails - ActiveRecord，多对多双向关系

> ID：12411762
> 
> 赞同：0
> 
> 时间：2012-09-13T17:34:22.450
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个问题，我希望有人可以向我解释。示例关系：

```
class User < ActiveRecord::Base
  has_many :issues
  has_many :tasks, through: :issues
end

class Issue < ActiveRecord::Base
  belongs_to :user
  belongs_to :task
end

class Task < ActiveRecord::Base
  has_many :issues
  has_many :users, through: :issues
end 
```

我将尝试通过关联创建一些模型：

```
user = User.create
task = user.tasks.new 
user.tasks # [#<Task id: nil, created_at: nil, updated_at: nil>]
task.users # [] 
```

问题 1\. 这是一种方式关联还是我做错了什么？

```
user.tasks.new.save     
 SQL (0.3ms)  INSERT INTO "tasks" ("created_at", "updated_at") ...

user.tasks.create    
SQL (0.4ms)  INSERT INTO "tasks" ("created_at", "updated_at") ..
SQL (0.4ms)  INSERT INTO "issues" ("created_at", "task_id", "updated_at", "user_id") ... 
```

问题2：为什么只有create方法添加记录到连接表？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:57:27.667

您正在用户和任务之间创建多对多关联。为了有一种方式关联，您需要编写

```
 class User < ActiveRecord::Base
   has_many :tasks
 end

 class Task < ActiveRecord::Base
   belongs_to :user
 end 
```

这将在用户和任务之间创建一对多的关联。

和

Active Record 的 create 方法更新数据库，但新方法只创建模型对象，如您在日志中看到的那样。

你需要在新建后调用保存

```
task = user.tasks.new 
user.save 
```

这实际上将用户连同任务一起保存

此链接将向您解释有关关联的更多信息

[http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# regex - emacs 交互式搜索 search-forward-regexp 的区别

> ID：12411770
> 
> 赞同：2
> 
> 时间：2012-09-13T17:34:54.067
> 
> 标签：regex, emacs

我有几个使用 Emacs 的交互式搜索可以正常工作的正则表达式。它们是“^\”。和“^#”。他们在行首搜索句点和哈希。

我正在尝试编写一个交互式函数，在一行上搜索这些正则表达式，但我失败了。我的功能是

```
(defun line-contains (regexp)
  "Return true if the current line contains the passed regular expression."
  (save-excursion
    (beginning-of-line)
    (search-forward-regexp regexp (point-at-eol) t))) 
```

当我打电话

```
((or (line-contains "^\.")
     (line-contains "^#")) 
```

在下一行

```
if ($default) 
```

即使在交互式搜索调用时该行与正则表达式不匹配，它也会返回 true。我不确定我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:56:08.210

您必须像这样转义字符串文字中的反斜杠

```
((or (line-contains "^\\.")
     (line-contains "^#")) 
```

# django - Solr 不会无缘无故地找到一些结果

> ID：12411772
> 
> 赞同：0
> 
> 时间：2012-09-13T17:34:59.313
> 
> 标签：django, search, solr, django-haystack

请看这个搜索：

[http://astrobin.com:8983/solr/select/?q=Avalon+Linear](http://astrobin.com:8983/solr/select/?q=Avalon+Linear)

在页面中，搜索`Avalon Linear`。注意文字是这样的： *... Avalon Linear FR Zeiss ...*

所以我想搜索`Avalon Linear FR`应该返回相同的结果，而不是什么都不返回！

[http://astrobin.com:8983/solr/select/?q=Avalon+Linear+FR](http://astrobin.com:8983/solr/select/?q=Avalon+Linear+FR)

好的，那为什么要搜索`Avalon Linear Zeiss`工作呢？

[http://astrobin.com:8983/solr/select/?q=Avalon+Linear+Zeiss](http://astrobin.com:8983/solr/select/?q=Avalon+Linear+Zeiss)

这个词有什么特别之处`FR`吗？如果它因为太短而被忽略，那么结果应该仍然存在。

其他搜索也会带来麻烦。拿着这个：

[http://astrobin.com:8983/solr/select/?q=TSAPO65Q](http://astrobin.com:8983/solr/select/?q=TSAPO65Q)

搜索页面`Teleskop-Service`。它在那里，但搜索`Teleskop-Service`没有结果：

[http://astrobin.com:8983/solr/select/?q=Teleskop-Service](http://astrobin.com:8983/solr/select/?q=Teleskop-Service)

顺便说一句，如果你还不够困惑，我的开发机器上没有这个问题，而只是在生产服务器上！据我所知，两个系统都运行相同的软件！

知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:43:59.813

我从 Solr 3.6.1 升级到 4.0.0-BETA 并重建了 schema，问题就解决了。

# sql - 对最近的行求和，按 id 分组

> ID：12411773
> 
> 赞同：1
> 
> 时间：2012-09-13T17:35:00.730
> 
> 标签：sql, postgresql, aggregate-functions

```
SELECT distinct on (prices.item_id) *
FROM prices
ORDER BY prices.item_id, prices.updated_at DESC 
```

上面的查询检索最近的价格，我如何获得所有当前价格的总和？

是否可以不使用子选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:51:17.777

使用子查询这很简单：

```
select sum(p.price)
from (select distinct on (p.item_id) p.*
      from prices p
      order by p.item_id, p.updated_at desc
     ) p 
```

如果您不介意重复的行，我认为以下方法可能有效：

```
select distinct on (p.item_id) sum(prices.price) over ()
from prices p
order by p.item_id, p.updated_at desc 
```

您也许可以为此添加一个限制子句以获得您想要的。顺便说一句，我会这样写：

```
select sum(p.price)
from (select p.*,
             row_number() over (partition by p.item_id order by updated_at desc) as seqnum
      from prices p
      order by p.item_id, p.updated_at desc
     ) p
where seqnum = 1 
```

ROW_NUMBER() 是标准 SQL。DISTINCT ON 子句特定于 Postgres。

# python - 如何在python中打印十进制值

> ID：12411778
> 
> 赞同：4
> 
> 时间：2012-09-13T17:35:20.650
> 
> 标签：python, decimal, floating-accuracy

```
print("enter start() to start the program")

def start():
    print("This script converts GBP into any currency based on the exchange rate...")
    print(" ") #enters a line
    exchangeRate = int(input("Enter the exchange rate (Eg: 0.80)"))
    print("how much would you like to convert???")                       
    gpb = int(input())
    print(gpb*exchangeRate) 
```

如果我将汇率设为 0.81 并输入 1 英镑，它总是返回 0。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:36:21.637

使用[`float()`](http://docs.python.org/library/functions.html#float)而不是[`int()`](http://docs.python.org/library/functions.html#int)与您的`input()`通话。IE，

```
 gpb = float(input()) 
```

否则如果用户输入`0.81`,[`int()`](http://docs.python.org/library/functions.html#int)将`0`在转换过程中将其截断。

通过使用[`float()`](http://docs.python.org/library/functions.html#float)，您将保留作为输入提供的十进制值，并且您的计算应该产生您期望的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T23:09:20.610

您将类型指定为 int .....当您将 1 乘以 0.81 时，这些是整数 (0,1,2,3,4,5,6,7,8...)，您得到 0.81...。整数的 .key 数字是点之前的数字，在这种情况下为零。所以就像前面的回答一样，只需更改变量的类型。

# php - 奇数日期（“Ymd”）结果

> ID：12411779
> 
> 赞同：1
> 
> 时间：2012-09-13T17:35:25.863
> 
> 标签：php, date

关于 php date() 函数，我有一些奇怪的结果。基本上我从一个字符串格式的 Mysql 数据库中获取一个日期，分为三个元素。这将是日、月、年（例如 2012 年 9 月 15 日）我最终会比较两个日期以查看它是否已过期。但问题是只有某些日期允许代码工作，而有些日期根本不工作（或允许 if 语句有效工作） 下面是我的代码，任何帮助都会很棒。

```
 $today = date("d-m-Y");

$expire = date("d-m-Y",strtotime($this->getData('date_day')."-".
$this->getData('date_month')."-".$this->getData('date_year'))) ;

 if ($expire < $today)
{
    echo 'expired';
}
else
{
    echo 'Not expired';
} 
```

我确定它很简单，但由于某种原因我无法解决它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:41:18.647

您需要比较 Unix 时间戳。

```
$today = time();

$expire = strtotime($this->getData('date_day')."-".
$this->getData('date_month')."-".$this->getData('date_year')) ;

if ($expire > $today)
{
    echo 'expired';
}
else
{
    echo 'Not expired';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:44:13.293

看起来`strtotime`应该是美国日期格式；您需要交换月份和日期以生成有效日期：

```
$today = date("d-m-Y");

$expire = date("d-m-Y",strtotime($this->getData('date_month')."-".
$this->getData('date_day')."-".$this->getData('date_year'))) ; 
```

另一方面，请参阅 Stephen305 的回答 - 这是解决您问题的更好方法。

# asp-classic - 使用 MSSQL 和经典 ASP 对项目进行分组

> ID：12411780
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:35:43.257
> 
> 标签：asp-classic

我有下表：

```
Name    Type    Color    Place
Ana     A       Blue     America
Sandra  A       Red      India
Mary    A       Red      America
Paige   B       Orange   Africa
Fox     B       White    Africa
John    C       Black    Mexico 
```

我想按类型和显示对项目进行分组，如下所示：

```
Type A
Ana - Blue - America
Sandra - Red - India
Mary - Red - America

Type B
Paige - Orange - Africa
Fox - White - Africa

Type C
John - Black - Mexico 
```

什么样的循环可以帮助我解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:40:16.540

只需选择您的记录，按类型排序，然后遍历记录集。

跟踪变量中的类型，每当类型发生变化时，在写出下一个类型之前添加一个换行符。

**编辑：**例如：

```
<%
    Dim strType

    do while not rs.EOF
        if strType <> rs("Type") then  ' <---- check if the types are different here
            Response.Write "Type " & rs("Type") & "<BR><BR>"
        end if

        ' your user records go here

        strType = rs("Type")  ' <---- set the strType variable before looping
        rs.MoveNext
   loop
%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:39:23.647

```
select Name, Color, Place 
from MyTable
order by Type 
```

然后在您的 ASP 代码中，当 Type 值与之前的 Type 不同（或者是第一行）时，打印出您的 Type 标题行。

# c++ - 从外部应用程序访问右键单击上下文菜单

> ID：12411782
> 
> 赞同：3
> 
> 时间：2012-09-13T17:35:50.733
> 
> 标签：c++, visual-studio-2008, mfc, contextmenu

在执行了一些 Google-fu 并搜索 Stack Overflow 之后，我一直无法找到一种方法来访问项目的右键菜单并读取数据或从中选择一个项目。我查找了 SendMessage 和 PostMessage 的方法

## 到目前为止我所做的：

[这](https://stackoverflow.com/questions/10668456/how-to-show-windows-explorer-context-right-click-menu)是这里的帖子示例，如果它不使用 Qt 并且可以在外部应用程序上工作，这正是我想要的。当我只想查看外部应用程序的右键菜单时，我所能找到的一切都是关于创建右键菜单。

我已经尝试使用 Spy++ 获取上下文菜单的句柄，但是只要我在 Spy++ 中选择“查找窗口”选项（这是意料之中的），菜单就会消失。

我能想到的唯一方法是使用[mouse_event](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646260%28v=vs.85%29.aspx)来显示框，但是我不知道从那里去哪里。我觉得这也将是非常低效的。

我正在处理一些遗留代码，所以我没有太多选择可以使用，如果可能的话，我不想使用 Visual Studio 2008 中不包含的库。

## 我正在尝试做的事情：

我正在寻找一种方法来访问外部应用程序中的右键单击上下文菜单并读取其中的数据，然后选择一个项目。我觉得这应该很简单，但我的研究能力欠佳。如果有人能指出我正确的方向，我将不胜感激。

感谢您的阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T08:47:51.390

获得上下文菜单的唯一方法是让应用程序显示它。否则不存在。（您作为示例提供的另一个问题是关于设计为可用的 Windows Shell 菜单）

当用户右键单击时，会发送一个窗口[WM_CONTEXTMENU](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647592%28v=vs.85%29.aspx)，因此您可以使用 SendMessage() 来调用菜单，或者如果失败，则只需发送右键单击。

经过一番谷歌搜索，我认为上下文菜单的类名是 #32768，因此您可以使用[FindWindowEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633500%28v=vs.85%29.aspx)查找具有匹配类名的子窗口句柄。

一旦有了窗口句柄，就可以使用[MN_GETHMENU](http://msdn.microsoft.com/en-us/library/ms632613%28VS.85%29.aspx)消息来获取菜单句柄。

# .net - 在 .NET 中存储业务价值的位置 - SQL Server 应用程序

> ID：12411787
> 
> 赞同：0
> 
> 时间：2012-09-13T17:36:23.350
> 
> 标签：.net, sql-server, design-patterns, application-design, web-application-design

这一直是开发人员之间的鸡与蛋问题。您在哪里存储应用程序规则中使用的业务值。（在 ASP.NET、窗口窗体或任何数据驱动的应用程序中）

我见过人们创建表来存储文本和值表示，然后将这些记录链接到代码中（通过 ID 或文本名称）。对我来说，这是最糟糕的方式：

*   您必须维护表并为每个表创建管理模块
*   您每次需要访问业务价值时都已阅读该表
*   如果没有预先填充数据库，您的应用程序将无法工作 -

大多数开发人员告诉我这是我不购买的“最佳实践”，因为与我将业务价值直接放在应用程序这样的方法相比，它并没有带来任何好处：

```
       公共枚举 SourceLocation
        {
            数据库 = 0,
            文件 = 1，
            用户输入 = 3        
        }

```

然后在来自/到数据库的 [Column] 上使用整数，该数据库直接转换为数据对象上的 Enum，因此逻辑可以直接说：

```
    if(DataObject.Column == SourceLocation.File)
       //从文件中读取

```

这解决了上述所有问题，但是当您在应用程序之外的数据库上运行报告时，您需要在 SQL 中转换这些值。

所以我仍然想知道是否还有开发人员使用的另一种“更好”的解决方案或模式。我的意思是每个数据驱动的应用程序都必须有一个解决这个问题的方法/设计，这个问题从一开始就存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:13:54.200

我不太确定我是否同意您的观点，将这些值存储在枚举中比将它们存储在某种外部数据源中为您提供的所有好处。

> 您必须维护表并为每个表创建管理模块

诚然，将值存储在外部数据源中确实会增加一些架构开销。但是，如果您使用任何类型的 ORM 来处理您的数据访问和代码生成，这将是一项非常小的工作。

我不确定您所说的“管理模块”是什么意思，但我假设您指的是存储库，而不是用户自己管理选项的界面。如果替代方法是将值放入枚举中，我不明白为什么需要后者，因为用户也无法自己管理这些值。

就“维护”表而言，您实际上不需要做更多的维护，而不是通过在枚举中添加或删除值。正如 JonH 指出的那样，枚举路由要求您重建和重新部署整个应用程序，而不是简单地从数据源中添加或删除行。对我来说，这是一个更大的维护负担。

> 您每次需要访问业务价值时都已阅读该表

不正确，因为我假设这些值是相当静态的，所以在应用程序启动时缓存这些值并完成它是非常简单的。

> 如果没有预填充数据库，您的应用程序将无法运行

所以呢？如果应用程序是数据驱动的，那么将要求部署和配置数据库是部署计划的一部分。在脚本中添加 2 或 3`INSERT`条语句会增加部署过程的复杂性吗？

> 这解决了上述所有问题，但是当您在应用程序之外的数据库上运行报告时，您需要在 SQL 中转换这些值。

最重要的是，这是在外部存储这些值的最令人信服的原因。鉴于这些值在报告中使用的事实意味着它们**在您的应用程序范围之外**具有意义。这意味着当其他地方需要它们时，您必须每次都复制这些知识。系统中的任何重复都会增加额外的维护负担，并增加在未来更新中引入错误的机会。

最后，枚举在数据绑定到 UI 元素方面往往更加困难。如果可以，他们不允许向用户显示“漂亮”的值名称。相反，它们显示为包含“UserStoredFile”和“PickAndChooseAnotherEnumValue”等项目的下拉框。除了将枚举值关联到单独的字符串（更多重复，请参见上一段）之外，没有办法克服枚举的这种限制。

虽然看起来没什么大不了的，但任何体面的开发人员都应该关心这样的小细节。关注整个用户体验很重要。很有可能，如果您不是特别注重细节，那么您的系统中除了 UI 之外可能还有很多其他地方也会出现问题。不可否认，最后一点更像是一种主观的肥皂盒类型的论点:)。

我同意您的观点，仅存储这些值并不能证明向您的应用程序添加数据库是合理的。但是，您会注意到我通常会说**external datasource**。您没有理由不能将您的应用程序设置为从 XML 或某些其他类型的外部配置文件中提取这些值。但是，如果您已经拥有数据库，则不妨将其全部保存在一个地方。

**编辑：**

使用这些对象非常简单，它们只是集合。它们比枚举更自然地进行数据绑定，我想在数据驱动的应用程序中这很重要：

```
// Bind a collection of SourceLocation to an ASP.net dropdown list
ddlSourceLocations.Datasource = GetSourceLocations();
ddlSourceLocations.DataTextField = "LocationName";
ddlSourceLocations.DataValueField = "LocationId";
ddlSourceLocations.DataBind(); 
```

当然，就像你提到的，这对于枚举来说当然不是不可能的，它通常不是那么好。

将这些“业务价值”通过枚举变成完整的对象还可以让您在未来拥有更大的灵活性，如果`SourceLocation`需要超越名称和 ID 的概念。

让我们想象一下，稍后将“IsRemote”属性添加到 SourceLocation，以表示该位置位于单独的机器上。 `SourceLocation`现在能够适应需要此属性的规则：

```
if(myDataObject.SourceLocation.IsRemote) {
    // If the location is remote, do something extra   
} 
```

您还可以`SourceLocation`通过此属性过滤集合，以防您有一些代码需要所有`IsRemote`为真的位置：

```
var remoteLocations = GetSourceLocations().Where(x => x.IsRemote); 
```

然而，枚举在某一方面确实比数据驱动对象具有明显的优势，那就是当它们被用作应用程序常量时。事实上，这就是一个枚举，一组常量。当静态值被实现为动态的、数据驱动的规则时，更难以有效地编写针对静态值的规则。

在您的具体示例中，这是正确的。您的所有规则实际上是“如果源位置 == 1，则执行此操作”。我永远不会想要一堆魔法整数漂浮在我的应用程序周围，所以我肯定会定义一个像上面那样的枚举。

这是否意味着在这种情况下我将只使用枚举并放弃将值持久保存在外部数据源中？不一定，这完全取决于特定值在系统上下文中的使用方式。在您的示例中，这些值似乎在整个域中具有重要意义，而不仅仅是单个应用程序。您将它们描述为“业务价值”，并提到它们用于其他应用程序，例如报告。对我来说，提供一个可以共享这些知识的中心位置是完全合适的，除了在枚举中定义它们之外，我还会保留它们。

你可能会说，“等等……这不是重复吗？这不是很糟糕吗？” 好吧，是的，但不亚于使用仅枚举路线，您仍然可以获得将业务价值设计为成熟领域对象的设计奖励。

# c# - 是否可以通过反射引用特定版本的程序集？

> ID：12411789
> 
> 赞同：1
> 
> 时间：2012-09-13T17:36:31.153
> 
> 标签：c#, reflection, .net-assembly, .net-4.5

我的一个同事前段时间写了一段相当有问题的代码，最终它被破坏了。这是简化的示例：

```
Assembly assembly = typeof(SmtpClient).Assembly;
Type _mailWriterType = assembly.GetType("System.Net.Mail.MailWriter"); //getting a reference to internal class

//create an instance of System.Net.Mail.MailWriter storing it into _mailWriter variable
//It's internal, but for now it still works

MethodInfo _sendMethod = typeof(MailMessage).GetMethod("Send",BindingFlags.Instance | BindingFlags.NonPublic);

//calling non-public method resulting in app crash
_sendMethod.Invoke(
    message,
    BindingFlags.Instance | BindingFlags.NonPublic,
    null,
    new object[] { _mailWriter, true },
    null); 
```

经过一番调查，结果发现在我的开发机器上确实有两个`MailMessage.Send`方法参数：

```
System.Net.Mime.BaseWriter writer
Boolean sendEnvelope 
```

然而，我们的 QA 工程师最近安装了 VisualStudio 2012，并安装了 .NET 4.5。因此，当 QA 人员尝试运行应用程序时，他们得到了`System.Reflection.TargetParameterCountException`. 而且，看起来`MailMessage.Send`在 .NET 4.5 中有第三个参数：

```
System.Net.Mime.BaseWriter writer
Boolean sendEnvelope
Boolean allowUnicode 
```

当然我们要重新实现这段代码来停止使用非公共接口。但是，我们的项目时间很紧，所以我们现在负担不起。

所以，这里有一个问题：有没有办法通过反射来引用旧版本（例如 .NET 4.0）的程序集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T07:46:34.963

`typeof(SmtpClient).Assembly`您可以使用 加载程序集，而不是加载程序集`Assembly.Load(AssemblyName)`。

`AssemblyName`完整地描述了程序集的唯一身份。例如：

```
ExampleAssembly, Version=1.0.0.0, Culture=en, PublicKeyToken=a5d015c7d5a0b012 
```

您可以在完整的程序集名称中指定版本信息。

[这](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyname.aspx)是带有更多示例的 MSDN 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T08:04:52.543

要具体，请执行此操作

```
var systemNet35 = Assembly.Load(
    @"System.Net, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL");

Type _mailWriterType = systemNet35.GetType("System.Net.Mail.MailWriter"); 
```

* * *

当然，这只适用于已安装的 .Net 3.5。

# java - 如何使用内部静态最终字段初始化 Java 枚举？

> ID：12411790
> 
> 赞同：5
> 
> 时间：2012-09-13T17:36:32.993
> 
> 标签：java, enums

我正在设计一个纯文本视频游戏，其中有两个不常见的角色，但在内心和性格上却非常相似。

我的问题是我不知道如何`enum`使用静态最终内部常量通过构造函数初始化常量。否则游戏很好。;)

这是困境：

1.  枚举常量必须定义在枚举的第一行，如果我没记错的话
2.  第一行不能引用后面的任何内容（即“在定义之前不能引用字段”）

我该如何解决这个catch-22？

以下是根据保密协议从游戏中发布的一些示例代码：

```
enum ValiantHeroWithPrincessSavingTendencies {

  SUPERMARIO(TYPICAL_QUOTE_FROM_MARIO), ZELDA(TYPICAL_QUOTE_FROM_ZELDA);

  private String aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive;

  public String getQuoteUnderStressfulCircumstances() {
    return aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive;
  }

  private ValiantHeroWithPrincessSavingTendencies(String quote) {
    aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive = quote;
  }

  private static final String TYPICAL_QUOTE_FROM_ZELDA = "Have at ya!";
  private static final String TYPICAL_QUOTE_FROM_MARIO = "We, wagliu'!";
} 
```

我正在尝试使用 TYPICAL_QUOTE_FROM_MARIO 初始化 SUPERMARIO，但我还没有定义 TYPICAL_QUOTE_FROM_MARIO。我认为在 SUPERMARIO 之前移动私有静态最终字段是非法的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T17:40:31.027

唯一可行的选择是 a) 将常量移动到另一个类或 b) 将常量直接放入值初始化程序中。

如果移动常量，则可以使该类成为枚举中的静态类：

```
enum ValiantHeroWithPrincessSavingTendencies {
  SUPERMARIO(Quotes.TYPICAL_QUOTE_FROM_MARIO),
  ZELDA(Quotes.TYPICAL_QUOTE_FROM_ZELDA);

  private String aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive;

  public String getQuoteUnderStressfulCircumstances() {
    return aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive;
  }

  private ValiantHeroWithPrincessSavingTendencies(String quote) {
    aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive = quote;
  }

  private static class Quotes {
    private static final String TYPICAL_QUOTE_FROM_ZELDA = "Have at ya!";
    private static final String TYPICAL_QUOTE_FROM_MARIO = "We, wagliu'!";
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-29T14:32:01.853

您可以通过类名访问它们：

```
enum ValiantHeroWithPrincessSavingTendencies {
    SUPERMARIO(ValiantHeroWithPrincessSavingTendencies.TYPICAL_QUOTE_FROM_MARIO),
    ZELDA(ValiantHeroWithPrincessSavingTendencies.TYPICAL_QUOTE_FROM_ZELDA);

    ...

    private static final String TYPICAL_QUOTE_FROM_ZELDA = "Have at ya!";
    private static final String TYPICAL_QUOTE_FROM_MARIO = "We, wagliu'!";
} 
```

它比布赖恩的解决方案更简单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:41:54.160

私有静态最终常量是枚举本地的；只需在实例定义中对它们进行编码。在那之后，可以从`aPreparedQuotePurportedToBeSpontaneousAlmostImpulsive`变量内部访问它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T17:48:59.587

你总是可以做一些像这样的hacky：

```
public enum Derp
{
    SOMETHING(),
    SOMETHINGELSE();

    private String herp;

    public static final String A = "derp", B = "derp2";

    public String getHerp()
    {
        return herp;
    }

    static
    {
        SOMETHING.herp = A;
        SOMETHINGELSE.herp = B;
    }
} 
```

# php - PHP 测试 SMTP 配置

> ID：12411791
> 
> 赞同：0
> 
> 时间：2012-09-13T17:36:45.143
> 
> 标签：php, email, smtp, phpmailer

使用 PHPMailer [http://phpmailer.worxware.com/index.php?pg=examples](http://phpmailer.worxware.com/index.php?pg=examples)如何在不发送电子邮件的情况下测试我的 SMTP 设置是否正常工作？

**编辑：**也许我应该让它更通用，只是问我如何使用 PHP 检查 SMTP 连接，而不发送电子邮件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T13:20:39.533

如果您使用的是 PHPMailer，您可以在发送之前使用 Connect() 方法，如果连接不正确，请检查错误。

```
 /**
  * Connect to the server specified on the port specified.
  * If the port is not specified use the default SMTP_PORT.
  * If tval is specified then a connection will try and be
  * established with the server for that number of seconds.
  * If tval is not specified the default is 30 seconds to
  * try on the connection.
  *
  * SMTP CODE SUCCESS: 220
  * SMTP CODE FAILURE: 421
  * @access public
  * @return bool
  */
  public function Connect($host, $port = 0, $tval = 30) {
    // set the error val to null so there is no confusion
    $this->error = null;

    // make sure we are __not__ connected
    if($this->connected()) {
      // already connected, generate error
      $this->error = array("error" => "Already connected to a server");
      return false;
    }

    if(empty($port)) {
      $port = $this->SMTP_PORT;
    }

    // connect to the smtp server
    $this->smtp_conn = @fsockopen($host,    // the host of the server
                                  $port,    // the port to use
                                  $errno,   // error number if any
                                  $errstr,  // error message if any
                                  $tval);   // give up after ? secs
    // verify we connected properly
    if(empty($this->smtp_conn)) {
      $this->error = array("error" => "Failed to connect to server",
                           "errno" => $errno,
                           "errstr" => $errstr);
      if($this->do_debug >= 1) {
        echo "SMTP -> ERROR: " . $this->error["error"] . ": $errstr ($errno)" . $this->CRLF . '<br />';
      }
      return false;
    }

    // SMTP server can take longer to respond, give longer timeout for first read
    // Windows does not have support for this timeout function
    if(substr(PHP_OS, 0, 3) != "WIN")
      socket_set_timeout($this->smtp_conn, $tval, 0);

    // get any announcement
    $announce = $this->get_lines();

    if($this->do_debug >= 2) {
      echo "SMTP -> FROM SERVER:" . $announce . $this->CRLF . '<br />';
    }

    return true;
  } 
```

（来自[PHPMailer SVN](http://phpmailer.svn.sourceforge.net/viewvc/phpmailer/phpmailer/trunk/class.smtp.php?revision=450&view=markup)）

# php - 在 Magento 中向客户网格添加列 - 数据未填充

> ID：12411795
> 
> 赞同：3
> 
> 时间：2012-09-13T17:36:58.593
> 
> 标签：php, magento, datagrid

尝试在 Magento v1.11 的管理客户网格中添加具有自定义属性的列

我已经像这样设置了这个模块：

**配置文件**

```
<?xml version="1.0"?>
<config>
    <modules>
        <WACI_AdminHtmlExt>
            <version>0.1.0</version>
        </WACI_AdminHtmlExt>
    </modules>
    <global>
        <blocks>
            <adminhtml>
                <rewrite>
                    <customer_grid>WACI_AdminHtmlExt_Block_Customer_Grid</customer_grid>
                </rewrite>
            </adminhtml>
        </blocks>
    </global>
</config> 
```

**WACI/AdminHtmlExt/Block/Customer/Grid.php**

```
<?php
/**
 * Adminhtml customer grid block
 *
 * @category   WACI
 * @package    WACI_AdminhtmlExt
 * @author     
 */

class WACI_AdminHtmlExt_Block_Customer_Grid extends Mage_Adminhtml_Block_Customer_Grid
{

    protected function _prepareCollection()
    {
        $collection = Mage::getResourceModel('customer/customer_collection')
            ->addNameToSelect()
            ->addAttributeToSelect('email')
            ->addAttributeToSelect('created_at')
            ->addAttributeToSelect('group_id')
            ->addAttributeToSelect('customer_id')
            ->joinAttribute('billing_postcode', 'customer_address/postcode', 'default_billing', null, 'left')
            ->joinAttribute('billing_city', 'customer_address/city', 'default_billing', null, 'left')
            ->joinAttribute('billing_telephone', 'customer_address/telephone', 'default_billing', null, 'left')
            ->joinAttribute('billing_region', 'customer_address/region', 'default_billing', null, 'left')
            ->joinAttribute('billing_country_id', 'customer_address/country_id', 'default_billing', null, 'left');

        $this->setCollection($collection);

        return parent::_prepareCollection();
    }

    protected function _prepareColumns()
    {
        $this->addColumn('entity_id', array(
            'header'    => Mage::helper('customer')->__('ID'),
            'width'     => '50px',
            'index'     => 'entity_id',
            'type'      => 'number',
        ));

       $this->addColumn('customer_id', array(
            'header'    => Mage::helper('customer')->__('Dynamics ID'),
            'width'     => '75px',
            'index'     => 'customer_id',
        ));

        //... rest of the function, removing a couple columns...

        return parent::_prepareColumns();
    }
} 
```

**Customer_Id**，在这种情况下是一个自定义属性（跟踪内部客户 ID）......不确定我是否需要添加逻辑才能正确呈现它？但它在管理员中显示得很好，否则。

我读过几篇文章，提到在这样的网格中为新字段添加渲染器 - 但同样许多人根本没有提到它。

不太确定从这里去哪里-

干杯

* * *

### 更新

只是为了澄清那些需要这个解决方案的人：

```
class WACI_AdminHtmlExt_Block_Customer_Grid extends Mage_Adminhtml_Block_Customer_Grid
{

    /*protected function _prepareCollection()
        {
            $collection = Mage::getResourceModel('customer/customer_collection')
                ->addNameToSelect()
                ->addAttributeToSelect('email')
                ->addAttributeToSelect('created_at')
                ->addAttributeToSelect('group_id')
                ->addAttributeToSelect('customer_id')
                ->joinAttribute('billing_postcode', 'customer_address/postcode', 'default_billing', null, 'left')
                ->joinAttribute('billing_city', 'customer_address/city', 'default_billing', null, 'left')
                ->joinAttribute('billing_telephone', 'customer_address/telephone', 'default_billing', null, 'left')
                ->joinAttribute('billing_region', 'customer_address/region', 'default_billing', null, 'left')
                ->joinAttribute('billing_country_id', 'customer_address/country_id', 'default_billing', null, 'left');

            $this->setCollection($collection);

            return parent::_prepareCollection();
    }*/

    public function setCollection($collection)
    {
        $collection->addAttributeToSelect('customer_id');                    
        parent::setCollection($collection);
    }

    protected function _prepareColumns()
    {

        $this->addColumn('customer_id', array(
            'header'    => Mage::helper('customer')->__('Dynamics ID'),
            'width'     => '75px',
            'index'     => 'customer_id',
        ));

        $this->addColumnsOrder('customer_id','entity_id');

        parent::_prepareColumns();

        $this->removeColumn('billing_country_id');

        return $this;
    }
} 
```

是我终于登陆了。跳过了`_prepareCollenctions()`通话。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:57:27.187

问题是您调用 parent::_prepareCollection() 的 return 语句与您正在扩展原始类的事实相结合。通过在您的类之后调用父类，您将使用原始对象替换您创建的集合对象。你真正需要调用的是你重载的类的父类，你可以这样做......

```
protected function _prepareCollection()
{
    $collection = Mage::getResourceModel('customer/customer_collection')
        ->addNameToSelect()
        ->addAttributeToSelect('email')
        ->addAttributeToSelect('created_at')
        ->addAttributeToSelect('group_id')
        ->addAttributeToSelect('customer_id')
        ->joinAttribute('billing_postcode', 'customer_address/postcode', 'default_billing', null, 'left')
        ->joinAttribute('billing_city', 'customer_address/city', 'default_billing', null, 'left')
        ->joinAttribute('billing_telephone', 'customer_address/telephone', 'default_billing', null, 'left')
        ->joinAttribute('billing_region', 'customer_address/region', 'default_billing', null, 'left')
        ->joinAttribute('billing_country_id', 'customer_address/country_id', 'default_billing', null, 'left');

    $this->setCollection($collection);

    return Mage_Adminhtml_Block_Widget_Grid::_prepareCollection();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:56:35.513

抱歉，我第一次回答时因为换行而误读了代码块。

`createBlock()`您的方法似乎没有返回有效对象。

# svn - 与 Perforce 的同步/解析过程等效的 svn 是什么？

> ID：12411796
> 
> 赞同：3
> 
> 时间：2012-09-13T17:37:07.580
> 
> 标签：svn, perforce

在 Perforce 中，您通常执行两步同步过程：
p4 sync
p4 resolve

同步将您的工作区同步到存储库并确定哪些文件存在冲突，并且解决步骤在本地合并和解决冲突，而不签入任何内容或以其他方式影响存储库。然后你可以运行你的回归，在你签入之前确保它仍然有效。

svn 相当于什么？我知道必须有办法做到这一点，但明显的谷歌搜索并没有给我任何答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T13:47:05.840

步骤是：

1.  用于[`svn update`](http://svnbook.red-bean.com/en/1.1/re28.html)将工作副本更新为 HEAD 或所需的修订版，或[`svn merge`](http://svnbook.red-bean.com/en/1.0/re16.html)将来自不同分支的更改合并到工作副本中。
2.  对于每个冲突的文件，svn 创建/修改另外四个文件：
    1.  `filename`: 原始文件被修改，带有指示冲突行的标记。
    2.  `filename.mine`: 原始文件。
    3.  `filename.rBASE`：更新前工作副本修订号 (BASE) 处的文件的未修改版本。
    4.  `filename.rNEW`：从更新文件的新版本。
3.  要解决冲突，请执行以下操作之一。每个都会删除之前创建的附加文件。
    1.  手动编辑每个文件（`filename`在上面的示例中）到所需的状态，然后调用[`svn resolved`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.resolved.html)以指示冲突已解决。
    2.  用于[`svn resolve`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.resolve.html)选择特定版本，“base”（`filename.rBASE`）、“working”（`filename`）、“mine-full”（`filename.mine`）或“theirs-full”（`filename.rNEW`）。
    3.  用于[`svn revert`](http://svnbook.red-bean.com/en/1.1/re25.html)撤消该文件的更新。
4.  用于[`svn commit`](http://svnbook.red-bean.com/en/1.1/re06.html)更新存储库。在解决所有冲突之前，这不会继续进行。

有关详细信息，请参阅[解决冲突（合并其他人的更改）](http://svnbook.red-bean.com/en/1.1/ch03s05.html#svn-ch-3-sect-5.4)。

# ruby-on-rails - 注释未使用祖先 gem 嵌套在 Rails 中

> ID：12411800
> 
> 赞同：1
> 
> 时间：2012-09-13T17:37:38.657
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

所以我使用祖先 gem 来嵌套评论，一切正常，回复、编辑、创建、删除。但由于某种原因，他们自己的评论不会嵌套在您正在回复的评论下 - 相反，它最终会出现在评论列表的末尾。

**代码**

**注意：**任务有很多类别，其中类别属于任务

**分类新方法**

```
 def new
    @task = Task.find(params[:task_id])
    @task.comments.new(:parent_id => params[:parent_id])
  end 
```

**评论助手**

```
module CommentsHelper
  def nested_comments(comments)
    comments.map do |comment, sub_comments|
      render(comment) + content_tag(:div, nested_comments(sub_comments), :class => 'nested_comments')
    end.join.html_safe
  end
end 
```

**意见表**

```
<%= form_for ([@task, @task.comments.build]) do |f| %>
    <%= f.text_area :comment %>
    <%= f.hidden_field :parent_id%>
    <%= f.submit %>
<% end %> 
```

当我回复或发布新评论时，这就是我在来源中得到的：

```
<div class="comment_23">

    <p>I am a comment</p>
    <div class="comment Info">
        Written by: Adam | 
        You can: <a href="/tasks/7/comments/new?parent_id=23">Reply To Comment</a> or
        <a href="/tasks/1/comments/23/edit">Edit Comment</a>  |
        <a href="/tasks/1/comments/23" data-method="delete" rel="nofollow">Delete Comment</a>
    </div>
</div>
<div class="nested_comments"></div><div class="comment_24">

    <p>I am another comment</p>
    <div class="comment Info">
        Written by: Adam | 
        You can: <a href="/tasks/7/comments/new?parent_id=24">Reply To Comment</a> or
        <a href="/tasks/1/comments/24/edit">Edit Comment</a>  |
        <a href="/tasks/1/comments/24" data-method="delete" rel="nofollow">Delete Comment</a>
    </div>
</div>
<div class="nested_comments"></div><div class="comment_25">

    <p>I am a reply to the first comment</p>
    <div class="comment Info">
        Written by: Adam | 
        You can: <a href="/tasks/7/comments/new?parent_id=25">Reply To Comment</a> or
        <a href="/tasks/1/comments/25/edit">Edit Comment</a>  |
        <a href="/tasks/1/comments/25" data-method="delete" rel="nofollow">Delete Comment</a>
    </div>
</div>
<div class="nested_comments"></div> 
```

为什么有空的nested_comments div？而我是一个测试是对我是一个评论的回复，那么为什么它不在嵌套评论 div 中呢？

# java - Spring 方法性能在图表上显示

> ID：12411801
> 
> 赞同：0
> 
> 时间：2012-09-13T17:37:39.077
> 
> 标签：java, performance, spring, testing

如果我想创建一些方法（假设正在进行一些计算）性能图，我想问我应该使用哪个工具或程序，可能类似于下面的 RRD 图表：

![在此处输入图像描述](../Images/6a8bd3e0c49f2cd31640e038d62a508d.png)

这将展示系统的性能和方法的执行时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:44:46.333

使用 Spring Insight，试试这个链接你会得到更多信息： [http ://static.springsource.com/projects/tc-server/2.0/devedition/htmlsingle/devedition.html](http://static.springsource.com/projects/tc-server/2.0/devedition/htmlsingle/devedition.html)

# google-chrome-extension - 从内容脚本检查 CSS

> ID：12411804
> 
> 赞同：0
> 
> 时间：2012-09-13T17:37:46.980
> 
> 标签：google-chrome-extension

我正在开发一个内容脚本，并且我知道我的 CSS 正在被注入。有用。但是我在检查器中看不到样式。我在 Mac 上使用 Chrome 21.0.1180.89。

在检查器中查看内容脚本样式是否有一些技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T05:14:07.597

您可以在检查器的“Computed Style”部分看到注入的 CSS。

# forms - Joomla 2.5，通过电子邮件发送联系人

> ID：12411805
> 
> 赞同：0
> 
> 时间：2012-09-13T17:37:49.687
> 
> 标签：forms, joomla, contacts

我有一个 Joomla 网站 (www.newingtonscouting.com)，我的客户需要一个页面，任何人都可以在其中向他们不知道姓名的多个联系人（侦察员）发送电子邮件。我已经在一个联系人类别中拥有这些联系人。

有没有办法做到这一点？当/如果将其交给客户进行维护时，我需要一些相对简单的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:49:55.077

您将无法使用标准的 Joomla 联系系统执行此操作，因为它仅支持向单个联系人发送电子邮件。您需要为此使用另一个扩展程序。以下是 JED 网站上的列表，您可以从中选择：

[http://extensions.joomla.org/extensions/contacts-and-feedback/contact-forms](http://extensions.joomla.org/extensions/contacts-and-feedback/contact-forms)

请记住，并非所有人都支持向多个联系人发送电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:56:26.677

您可以做一个插件来覆盖添加密件抄送字段的联系表单，但是仅仅让他们成为一个可以转发给他们的电子邮件地址不是更容易做和维护吗？

# android - 应用国家过滤器时的 Android google play 支持/不支持设备列表

> ID：12411809
> 
> 赞同：9
> 
> 时间：2012-09-13T17:38:10.577
> 
> 标签：android, google-play

我的应用程序发布在 Google play 中，国家过滤器为美国。所以该应用程序仅适用于美国国家。当我检查不支持的设备列表时，它显示了许多实际上应该支持该应用程序的设备。我在 Manifest 中添加了每个标签，以涵盖操作系统版本 1.6 及更高版本的几乎所有设备。那么为什么这些设备显示为不支持的设备？

美国国家不可用的设备是否在 Google play 的不支持列表中？

请确认。

我在清单中添加了以下标签。

```
<supports-screens android:smallScreens="true"
                  android:normalScreens="true"
                  android:largeScreens="true"
                  android:xlargeScreens="true"/>
<uses-feature android:name="android.hardware.bluetooth" />
<uses-feature android:name="android.hardware.camera" />
All permissions 
```

请找到我尝试将 aapt 转储标记到此 apk 时获得的信息

```
package: name='com.xx.xxxx' versionCode='1' versionName='1.0'
uses-permission:'android.permission.WRITE_EXTERNAL_STORAGE'
uses-permission:'android.permission.ACCESS_NETWORK_STATE'
uses-permission:'android.permission.CALL_PHONE'
sdkVersion:'4'
uses-permission:'android.permission.ACCESS_NETWORK_STATE'
uses-permission:'android.permission.CAMERA'
uses-feature:'android.hardware.camera'
uses-feature:'android.hardware.camera.autofocus'
application-label:'XXXXXX'
application-icon-120:'res/drawable-ldpi/appicon.png'
application-icon-160:'res/drawable-mdpi/appicon.png'
application-icon-240:'res/drawable-hdpi/appicon.png'
application: label='XXXXXXX' icon='res/drawable-mdpi/appicon.png'
application-debuggable
launchable-activity: name='com.xx.xxxx.xxx.xxx'  label='' icon=''
uses-permission:'android.permission.INTERNET'
uses-permission:'android.permission.READ_EXTERNAL_STORAGE'
uses-implied-permission:'android.permission.READ_EXTERNAL_STORAGE','requested WR
ITE_EXTERNAL_STORAGE'
uses-feature:'android.hardware.telephony'
uses-implied-feature:'android.hardware.telephony','requested a telephony-related
 permission or feature'
uses-feature:'android.hardware.touchscreen'
uses-implied-feature:'android.hardware.touchscreen','assumed you require a touch
 screen unless explicitly made optional'
main
other-activities
supports-screens: 'small' 'normal' 'large'
supports-any-density: 'true'
locales: '--_--'
densities: '120' '160' '240' 
```

由于清单设置而不受支持的设备：

```
Samsung:
Galaxy Tab(SHW-M180K)
Galaxy Tab(SMT-i9100)
Galaxy Tab 8.9(GT-P7300)
Galaxy Tab 8.9(GT-P7310)
Galaxy Tab 8.9(SGH-I957)
Galaxy Tab 10.1(GT-P7500)
Galaxy Tab 10.1(SC-01D)
Galaxy Tab 10.1(SCH-I905)
Galaxy Tab 10.1(SHW-M300W)
Galaxy Tab 10.1(SHW-M380K)
Galaxy Tab 10.1(SHW-M380S)
Galaxy Tab 10.1(SHW-M380W)
Galaxy Tab™ 7.7(SCH-I815)
Galaxy Tab 10.1v(p3)
Galaxy Tab2 10.1(espresso10wifi)
Galaxy Tab™ 10.1(SGH-T859)
Galaxy Tab 7.0 Plus(SGH-T869)
Galaxy Tab 2 7.0 WiFi (espressowifi)

Motorola:
MZ505(Graham)
MZ608(fleming)
MZ616(pasteur)
XOOM(stingray)
XOOM(umts_everest)
XOOM(umts_hubble)
XOOM(wifi_hubble)
XOOM(wingray)
XT303(silversmart_umts)
XT311(XT311)
XT316(XT316)
XT316(dominoq_umts)
XT317(XT317)
XT319(XT319)
XT320(tinboost_umts)
XT389(XT389)
XT389(argonmini_umts)
XT390(XT390)
XT550(ArgonSpin)
XT550(argonspin_umts)
Flyer(flyer)
G1(trout)

HTC:
HTC Desire C(golfu)
HTC Explorer A310b(pico)
HTC Flyer(express)
HTC_P515E(expresskt)
Puccini(puccinilte)
Touch Viva(opal) 
```

我是否需要在我的清单中添加任何东西，或者我可以省略 Google Play 不支持的设备列表吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T19:21:09.620

当前，您的应用程序需要设备支持电话（请注意与电话相关的“uses-feature”行）。出于这个原因，它在大量 Android 平板设备上不可用。

要声明电话不是应用程序的*必需*功能，请通过将此行添加到清单中将其设置为不需要：

```
<manifest>
...
<uses-feature android:name="android.hardware.telephony"
              android:required="false" /> 
```

也就是说，对于代码的任何部分使用电话（拨打电话等），通过隐藏/禁用相关功能等，确保它们能够对未安装该硬件的设备做出正确反应。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-19T14:44:40.043

FWIW，我不得不添加

```
<uses-feature android:name="android.hardware.camera.autofocus" android:required="false" /> 
```

获得 Galaxy Tab2 10.1 的支持。

# asp.net - Windows 2008 上的 Windows 身份验证提示输入凭据

> ID：12411811
> 
> 赞同：1
> 
> 时间：2012-09-13T17:38:20.450
> 
> 标签：asp.net, iis-6, windows-server-2008, windows-authentication

我们正在 Windows Server 2008 上建立一个 ASP.NET 4.0 网站。该网站使用**集成 Windows 身份验证**进行身份验证。（它不使用 ASP.NET 身份验证或授权。）

在 IIS 中，我们只启用了**Windows 身份验证。**

当我们使用 localhost 作为主机标头浏览到该站点时，该站点工作正常。当我们使用 FQDN 浏览它时，该站点会提示输入用户名/密码，但不接受有效输入的凭据。

一些需要注意的事项：

*   IE 确实启用了集成 Windows 身份验证
*   在 IE 的 Intranet 区域中输入具有 FQDN 的站点
*   我们已尝试将该网站添加到受信任的网站，但无济于事
*   我们确实将 AppPool 上的 Identity 从 ApplicationPoolIndentity 更改为 Network Service，但没有成功
*   我们验证了 IUSR 具有对目录和文件的读取和执行权限
*   我们已将 NTAuthenticationProviders 设置为 "NTLM" 和 "Negotiate,NTLM"

我们缺少什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:12:38.923

我们最终被告知，该服务器与我们相信的不在同一个域中，因此它无法针对 Active Directory 进行身份验证。（我们一直在使用本地帐户进行测试。）

# css - 从 http 切换到 https 会导致 CSS 问题

> ID：12411813
> 
> 赞同：2
> 
> 时间：2012-09-13T17:38:22.227
> 
> 标签：css, internet-explorer, google-chrome, https

我正在运行一个 OSCommerce/Wordpress 网站，在我签入 IE 和 Chrome 之前，该网站在 SSL 和页面更改方面一直运行良好。

使用这两种浏览器时，当我从常规页面转到安全页面时，我的一些 CSS 会发生变化。页面容器的宽度从 74.923em（或大约 960px）变为 1198px，但来源仍然说 74.923em。我的一些 H2 标签从我给它的样式更改为默认样式。

同样，这仅在我切换到安全页面时在 Chrome 和 IE 中发生，并且此后每个页面都保持更改，无论它是否安全。我链接 CSS 的方式有问题吗？页面的其余部分看起来相同，只是它已按容器的宽度展开。

Firefox、Safari 和 Opera 运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:19:01.150

这可能是因为[不安全的文件链接？](https://stackoverflow.com/questions/2725523/how-to-include-css-and-js-files-via-https-when-needed)

您不能从 https 引用 http 源。

# c# - 日期时间和通用时间

> ID：12411814
> 
> 赞同：0
> 
> 时间：2012-09-13T17:38:24.733
> 
> 标签：c#, .net, timezone

我对.net 的 DateTime 组件感到困惑。服务器以 UTC +4 运行，我的客户端位于不同的时区。所以服务器上的时间是UTC+4模式。我已经尝试将其转换为 UniversalTime 并在将其发送到客户端之前将其发送到 ToBinary 中，但在客户端机器上代码看起来像

```
if ((Program.license.EndDate.ToUniversalTime() 
    - DateTime.Now.ToUniversalTime()).TotalMinutes <= 5)
{ 
    //dosomething 
} 
```

仍然工作错误。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:47:50.930

您必须知道从客户端发送的 DateTime 的 DateType（本地、通用或未指定）。如果您尝试将 Unspecified 类型转换为通用类型，据我了解，它将作为本地时间处理。（如果我错了，请有人纠正我。）

服务器/客户端日期和时间的最佳实践是***始终***使用 UTC。在 .Net 中使用`DateTime.UtcNow`而不是`DateTime.Now.ToUniversalTime()`.

# powershell - Powershell 参数验证问题

> ID：12411815
> 
> 赞同：0
> 
> 时间：2012-09-13T17:38:30.223
> 
> 标签：powershell, parameters, arguments

我正在从另一个脚本中调用这样的 powershell 脚本。

```
function test_execute_sql_2_direct_query()
  {
    & C:\Server\Scripts\PowerShellDeploy\Execute-SQL-Command.ps1 -SERVER_NAME "myserver" -SQL_COMMAND_TYPE "input" -SQL_FILE ".\select.sql" -USER_NAME "username" -PASSWORD "password" -DATABASE "accounts"
  } 
```

当我调用该函数时，我从 Powershell 收到一条错误消息，上面写着“无法验证参数“查询”上的参数。参数为空或空......'

我不太明白为什么我会收到这条消息？Execute-SQL-Command 脚本没有名为“Query”的参数。很可能我错过了一些东西。

这是它的参数部分：

```
param(
[Parameter(
         HelpMessage="Server Name")]
[string]$SERVER_NAME = "",

[Parameter(
         HelpMessage="Database")]
[string]$DATABASE = "",

    [Parameter(
         HelpMessage="Path to .SQL File to run. Used in input file mode (not direct query mode)")]
[string]$SQL_FILE ="",  

    [Parameter(
         HelpMessage="Server Port (default = 1433)")]
[string]$SERVER_PORT = "1433",

    [Parameter(
         HelpMessage="Server Transport (default = tcp")]
[string]$TRANSPORT = "tcp", 

[Parameter(
         HelpMessage="Method of connecting to database <passthrough, credentialed>")]
[string]$CONNECT_METHOD = "passthrough",

[Parameter(
        HelpMessage="Username -- used only for credentialed login")]
[string]$USER_NAME = "username",

[Parameter(
        HelpMessage="Command type-- direct query or input file (.sql)")]
[string]$SQL_COMMAND_TYPE = "DIRECT_QUERY",

[Parameter(
        HelpMessage="SQL statement text type-- used in direct queries")]
[string]$SQL_STATEMENT = "",

[Parameter(
        HelpMessage="Password -- used only for credentialed login")]
[string]$PASSWORD = "pwd") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:03:57.663

这与用户错误有关——实际错误来自在 Execute-SQL-Command.ps1 中调用的一行——特别是 Invoke-Sqlcmd cmdlet。

# r - 确定 data.table 组成员的行索引

> ID：12411817
> 
> 赞同：7
> 
> 时间：2012-09-13T17:38:49.107
> 
> 标签：r, data.table

R 中的 data.table 包提供了以下选项：

> 其中： 'TRUE' 返回与 'i' 匹配的 'x' 的整数行号。

但是，我看不到`j`在使用 建立的组内获得“x”的整数行号的方法`by`。

例如，给定...

```
DT = data.table(x=rep(c("a","b","c"),each=3), y=c(1,3,6)) 
```

...我想知道每个 y 值的 DT 索引。

对我而言，价值在于我正在使用与另一个数据结构 (ADS) 并行的 data.table，我打算基于 data.table 的有效计算分组对其执行分组计算。

例如，假设 ADS 是一个向量，DT 中的每一行都有一个值：

```
ADS<-sample(100,nrow(DT)) 
```

作为一种解决方法，如果我首先向 data.table 添加一个新的序列列，我可以计算由 DT$y 组确定的 ADS 的组均值。

```
DT[,seqNum:=seq_len(nrow(DT))]
DT[,mean(ADS[seqNum]),by=y] 
```

这给出了我想要的结果，但代价是添加了一个新列。

我意识到在这个例子中我可以使用 tapply 得到相同的答案：

```
tapply(ADS,DT$y,mean) 
```

但是，我将无法获得 data.tables 高效分组的性能​​优势（尤其是在索引“by”列时）。

也许我忽略了一些语法？？？

也许这是添加到 data.table 的一个简单功能，我应该请求它（眨眼，眨眼）？？？

建议的语法：可选地将 '.which' 设置为组索引，允许编写：

```
DT[,mean(ADS[.which]),by=y,which=TRUE] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-06-14T14:41:43.283

从`data.table`1.8.3 开始可用，您可以`.I`在`j`a`data.table`中使用按组获取行索引...

```
DT[ , list( yidx = list(.I) ) , by = y ]
#   y  yidx
#1: 1 1,4,7
#2: 3 2,5,8
#3: 6 3,6,9 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T18:44:14.967

一个键控的 data.table 将被排序，以便组存储在连续的块中。在这种情况下，您可以使用`.N`来提取分组索引信息：

```
DT <- data.table(x=rep(c("a","b","c"),each=3), y=c(1,3,6))
setkey(DT, y)

ii <- DT[,.N, by=y]
ii[, start := cumsum(N) - N[1] + 1][,end := cumsum(N)][, N := NULL]
#    y start end
# 1: 1     1   3
# 2: 3     4   6
# 3: 6     7   9 
```

（就个人而言，我可能会像您建议的那样添加一个索引列`seqNum`。看起来更简单，我认为它不会对性能产生太大影响，除非您真的在突破极限。）

# javascript - 密码随机生成 MIT 库 javascript

> ID：12411821
> 
> 赞同：1
> 
> 时间：2012-09-13T17:39:01.427
> 
> 标签：javascript, security, random, cryptography, numbers

我正在寻找一个 MIT 许可的 javascript 库来生成加密随机数。我必须用来生成 AES 128 密钥，所以生成器必须是非常好的东西。不幸的是，我在 Internet 上找到的所有（严肃的）库都是 GPL 许可的，出于法律原因我不能使用它们。你知道一个可用的图书馆，它会是麻省理工学院许可的，或者更好的是，公共的？

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:46:31.730

你可能想看看[crypto-js——](http://code.google.com/p/crypto-js/)它是 BSD 许可的，我认为它很受尊重——已经存在了 3 年多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:57:37.633

这个问题非常类似于[Generate cryptographically strong pseudorandom numbers in Javascript?](https://security.stackexchange.com/questions/20029/generate-cryptographically-strong-pseudorandom-numbers-in-javascript) .

**浏览器中的 JavaScript：**

在 Firefox 和 Chrome 中，有一个实验性 API 可以做到这一点：[`window.crypto.getRandomValues`](https://developer.mozilla.org/en-US/docs/DOM/window.crypto.getRandomValues).

浏览器库中的其他库是有问题的，因为很难在浏览器中收集足够的熵。所以它们通常有很长的启动时间，或者可能会产生低质量的随机性。

一些随机数生成器库：

*   [seedrandom.js](http://davidbau.com/archives/2010/01/30/random_seeds_coded_hints_and_quintillions.html)（BSD 许可证）
*   [斯坦福 Javascript 加密库 (sjcl)](http://bitwiseshiftleft.github.com/sjcl/doc/symbols/sjcl.random.html)（双许可 BSD 和 GPL 2.0 或更高版本）
*   [clipperz / javascript-crypto-library](https://github.com/clipperz/javascript-crypto-library)（AGPL 许可证）

前两个可能满足您的许可证要求，因为 BSD 是许可许可证。为了完整起见，我已经包括了第三个。

**节点.js：**

[`crypto.randomBytes`](http://nodejs.org/api/crypto.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-29T15:09:56.737

自上次以来，[MSR JavaScript Cryptography Library](http://research.microsoft.com/en-us/downloads/29f9385d-da4c-479a-b2ea-2a7bb335d727/)已经发布，这正是我所需要的。

顺便说一句，现代浏览器现在原生支持一些加密（chrome 支持加密安全的伪随机数，IE11 的功能更多：http: [//msdn.microsoft.com/en-us/library/ie/dn302338%28v=vs .85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/dn302338%28v=vs.85%29.aspx)

# php - 对于连接速度较慢的人来说，下载使用 PHP 提供的大（ish）zip 会损坏

> ID：12411822
> 
> 赞同：4
> 
> 时间：2012-09-13T17:39:07.713
> 
> 标签：php, download, zip, shared-hosting, x-sendfile

我是新手，所以我会尽力解释我遇到的问题。如果有什么我遗漏或不清楚的地方，我会提前道歉。

我在我的根目录之外向事先经过验证的人提供了一个 81MB 的 zip 文件。我收到了有关下载损坏或无法完成下载的报告。如果我模拟慢速连接，我已经在我的机器上验证了这种情况。

我在运行 Apache-Coyote/1.1 的共享主机上。

我收到网络超时错误。我认为如果下载时间过长，我的主机可能会停止下载，但他们还没有验证任何一种方式。

我以为我可能遇到了内存限制或时间限制，所以我的主机安装了 apache 模块 XSendFile。我在验证后处理下载的文件中的标题是这样设置的：

```
<?php
set_time_limit(0);
$file = '/absolute/path/to/myzip/myzip.zip';

header("X-Sendfile: $file");
header("Content-type: application/zip");
header('Content-Disposition: attachment; filename="' . basename($file) . '"'); 
```

任何帮助或建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:47:23.453

我建议看看这个评论：

[http://www.php.net/manual/en/function.readfile.php#99406](http://www.php.net/manual/en/function.readfile.php#99406)

特别是，如果您使用的是 apache。如果不是，上面链接中的代码应该会有所帮助：

> 当我将非常大的文件发送给下载速度非常慢的客户端时，我开始遇到麻烦。在这些情况下，脚本会超时并且下载会因文件不完整而终止。我坚决反对禁用脚本超时——只要是解决编程问题的方法，你就做错了——所以我试图根据文件的大小来调整超时。但最终失败了，因为无法预测最终用户下载文件的速度，所以这实际上只是一个最好的猜测，所以不可避免地我们仍然会收到脚本超时的报告。
> 
> 然后我偶然发现了一个很棒的 Apache 模块，叫做 mod_xsendfile（[https://tn123.org/mod_xsendfile/](https://tn123.org/mod_xsendfile/)（二进制文件）或 [https://github.com/nmaier/mod_xsendfile](https://github.com/nmaier/mod_xsendfile)（源代码））。该模块主要监视输出缓冲区中是否存在特殊标头，当找到它们时，它会触发 apache 自行发送文件，就像用户直接请求文件一样。PHP 处理在此时停止，因此无论文件大小或客户端下载速度如何，都不会出现超时错误。并且终端客户端可以获得 Apache 发送文件的全部好处，例如准确的文件大小报告和下载状态栏。
> 
> 我最终得到的代码太长了，无法在此处发布，但通常使用 mod_xsendfile 模块（如果存在），如果不存在，则脚本回退到使用我最初发布的代码。[您可以在https://gist.github.com/854168](https://gist.github.com/854168)找到一些示例代码

**编辑**

只是为了参考将“分块”[链接到原始代码的代码](http://www.php.net/manual/en/function.readfile.php#88549)：

```
<?php 
function readfile_chunked ($filename,$type='array') { 
  $chunk_array=array(); 
  $chunksize = 1*(1024*1024); // how many bytes per chunk 
  $buffer = ''; 
  $handle = fopen($filename, 'rb'); 
  if ($handle === false) { 
   return false; 
  } 
  while (!feof($handle)) { 
      switch($type) 
      { 
          case'array': 
          // Returns Lines Array like file() 
          $lines[] = fgets($handle, $chunksize); 
          break; 
          case'string': 
          // Returns Lines String like file_get_contents() 
          $lines = fread($handle, $chunksize); 
          break; 
      } 
  } 
   fclose($handle); 
   return $lines; 
} 
?> 
```

# java - 使用什么数据结构来索引数据以进行部分 %infix% 搜索？

> ID：12411828
> 
> 赞同：8
> 
> 时间：2012-09-13T17:39:40.900
> 
> 标签：java, data-structures, indexing

想象一下，您有一个巨大的数据缓存，要通过 4 种方式进行搜索：

1.  完全符合
2.  字首％
3.  ％后缀
4.  %中缀%

我将[Trie](http://en.wikipedia.org/wiki/Trie)用于前 3 种类型的搜索，但除了顺序处理大量元素之外，我不知道如何处理第 4 种类型的搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:56:13.047

如果您的数据集很大，请使用像[Apache Solr](http://lucene.apache.org/solr/)这样的搜索平台，这样您就不会陷入性能混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:09:32.463

对于＃4，我在想如果您预先计算每个字符的出现次数，那么您可以在该表中查找在搜索字符串中至少有相同次数出现的字符。

该算法的效率可能取决于数据的性质和搜索字符串。在这里给出一些例子以获得更好的答案可能会很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:48:36.030

您可以为 2（键按正常顺序）和 3（键反向）构建可导航的地图或集合（例如 TreeMap 或 TreeSet）

对于选项 4，您可以构建一个集合，其中每个起始字母都有一个键。您可以根据您的要求简化此操作。这可能会导致使用更多空间，但会获得 O(log n) 查找时间。

# mysql - 确定存储过程中的数据库名称

> ID：12411833
> 
> 赞同：1
> 
> 时间：2012-09-13T17:39:56.050
> 
> 标签：mysql, stored-procedures

我在 Mysql 中创建了一个存储过程，我想知道是否有一个命令可以获取并存储该存储过程所在的数据库的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:42:22.857

DATABASE() 怎么样？

（此文字只是填充物）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-18T04:49:56.907

您的问题错了吗？..您的实际问题是您在数据库中创建了一个存储过程...而不是如何检索数据库中的过程？Ans: 要知道创建的程序：

```
mysql:\> show procedure status;  //to know the procedure name..sam4 function show function staus;
mysql:\> show use create procedure emptab.test1 //emptab is database name,test1 is the procedure.. 
```

# jquery - jqgrid编辑表单默认autocomplete="off"，如何改为autocomplete="on"

> ID：12411836
> 
> 赞同：2
> 
> 时间：2012-09-13T17:40:10.323
> 
> 标签：jquery, forms, jqgrid, autocomplete, autofill

最近我的 jqgrid 编辑表单没有 Google Chrome 和 Firefox 常见的自动填充功能。我发现 jqGrid 编辑表单正在呈现，每个表单都`<input>`具有以下属性：

```
autocomplete="off" 
```

在 JqGrid 中，我必须在网格定义中做什么才能删除此属性或将其设置为`autocomplete="on"`？

我在[ColModel 定义](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acolmodel_options)或[编辑表单选项](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing)中看不到任何关于它的内容。这里的任何帮助都会非常棒！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:54:31.097

我不相信[编辑 API](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing)中有任何东西可以在编辑表单中的字段上启用自动填充。尽管您可以在事件中使用 jQuery`afterShowForm`并在您希望的任何字段上设置自动完成属性。每个字段的 ID 与列模型中的名称相同。

```
afterShowForm : function (formid) {
    $('#name').attr('autocomplete', 'on');
} 
```

# informix - FOREACH I4GL SE

> ID：12411841
> 
> 赞同：1
> 
> 时间：2012-09-13T17:40:20.600
> 
> 标签：informix, 4gl

我试图让客户的姓氏，名字 - dob，我得到的所有东西都打印在同一个地方，知道吗？

```
 declare n_curs cursor for
              select unique pin,surname,given1,given2,dob from crcharge where
              chargenum in (select chargenum from crbookdd where book_no = rpt.book_no)
         order by surname,given1

            print ESC, "&l4E"

      foreach n_curs into t_pin, t_surname, t_given1, t_given2, t_dob
          if kick_new then
            print column 1, ESC, "&a0G", ESC, "&l3O", ESC, "&f4y3X",
                            ESC, "&l8D",ESC, "&l4E"
         end if
           let shtwrd_count = 0
        if shtwrd_count > 6 then
            let shtwrd[shtwrd_count] = t_shtwrd
            let shtwrd_count = shtwrd_count + 1
      Exit foreach
        end if
           print
           print  ESC,"&a6R", ESC, "&a3C",
                  upshift(t_surname) clipped, ",",
                  updown(t_given1) clipped," " ,
                  updown(t_given2) clipped,"-", t_dob clipped;

       end foreach 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:54:48.347

因为您的转义序列在 CR（回车）之后抑制了 LF（换行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T14:09:24.280

PRINT 语句后的分号表示“禁止换行”。因此，下一个 PRINT 语句在同一行继续。当这是您想要的效果时非常有用；否则，不好。

另外，作为一些建议，您应该参数化转义序列。如果您不这样做，那么当您需要更改打印机或终端类型时，生活将变得非常困难。创建命名效果并返回正确字符串的函数：

```
FUNCTION extra_bold()
    RETURN ESC, "&a6R"   -- Or whatever
END FUNCTION 
```

然后使用它们：

```
PRINT extra_bold(), info.field 
```

# javascript - jquery过滤方法使用

> ID：12411849
> 
> 赞同：-2
> 
> 时间：2012-09-13T17:40:37.203
> 
> 标签：javascript, javascript-events, jquery

下面的代码片段有什么用？我从 jQuery API 中提取了它。我不明白。

```
$("div").filter( $("#unique") ) 
```

请好心向我解释一下。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:42:41.453

它正在提取唯一一个`div`带有`id=unique`.

```
$('div').  // return all divs
   filter( $('#unique') ); // take the div with id=unique 
```

所以。此语句将返回您`div`with `id=unique`。

### 笔记

该语句也可以写为`$('div#unique')`或只是`$('#unique')`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:42:59.967

该`filter`方法使您能够从选择中仅过滤掉特定元素。假设您要选择所有`span`文本包含超过 3 个字符的 s。所以你会这样做：

```
$("span").filter(function() { return $(this).text().length > 3; }).click(...); 
```

该函数应检查某些条件并返回一个`boolean`. 如果它发送`true`该元素保留在选择中，否则丢弃。因此，对于您当前的问题，它会

# keyboard-shortcuts - SublimeText - 取消选择最后一个增量选择的元素？

> ID：12411850
> 
> 赞同：25
> 
> 时间：2012-09-13T17:40:56.160
> 
> 标签：keyboard-shortcuts, sublimetext2, sublimetext

我最近在 sublime text 中发现了非常有用的`ctrl`+功能。`D`仔细观察，它几乎与更复杂的重构工具一样适用于重命名。

一件事困扰着我。当我通过我的选择时，有时我选择了 10 个项目并超过了一个（例如，进入另一种方法）`ctrl`。`D`有没有办法反转方向并“取消选择最后一个选定的项目”？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-13T17:54:57.900

`ctrl`+`u`根据[sublimetext.com/docs](http://www.sublimetext.com/docs/2/multiple_selection_with_the_keyboard.html)并由我测试。

`ctrl`+ `k`, `ctrl`+`d`将跳过当前选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T01:19:37.380

您也可以在按住时取消选择任何内容`Alt`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-20T11:30:23.640

**对于 Mac：**

最后跳过：`cmd`+`u`

跳过当前：`cmd`+ `k`, `cmd`+`d`

不幸的是，当“选择循环”到达文档底部并再次从顶部开始时 - 功能丢失了。

# pyqt - 如何使 PyQt QSplitter 可见？

> ID：12411851
> 
> 赞同：0
> 
> 时间：2012-09-13T17:40:57.610
> 
> 标签：pyqt, qsplitter

我可以定义 QSplitter 对象的宽度/高度吗？我可以用适当的箭头使它可见吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:46:13.493

在我的 C++ 代码中，我使用 QSplitter::setHandleWidth()

调整高度可能需要调整容器本身的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-03T16:53:32.163

这是您如何覆盖 QSplitter 类以使拆分器具有一些图标以让用户知道他们可以调整小部件的大小，请参阅图像以获取输出。

[![在此处输入图像描述](../Images/691a296a5c9079f99a7a03cbfdb0b5b8.png)](https://i.stack.imgur.com/YgIWW.png)

```
from PyQt5.QtCore import *
from PyQt5.QtGui import *
from PyQt5.QtWidgets import *
import sys

class Handle(QWidget):
    def paintEvent(self, e=None):
        painter = QPainter(self)
        painter.setPen(Qt.NoPen)
        painter.setBrush(Qt.Dense6Pattern)
        painter.drawRect(self.rect())

class customSplitter(QSplitter):
    def addWidget(self, wdg):
        super().addWidget(wdg)
        self.width = self.handleWidth()
        l_handle = Handle()
        l_handle.setMaximumSize(self.width*2, self.width*10)
        layout = QHBoxLayout(self.handle(self.count()-1))
        layout.setSpacing(0)
        layout.setContentsMargins(0,0,0,0)
        layout.addWidget(l_handle)

class Window(QMainWindow):
    def setUI(self, MainWindow):
        self.splt_v = customSplitter(Qt.Vertical)
        self.splt_v.setHandleWidth(8)
        self.splt_v.addWidget(QGroupBox("Box 1"))
        self.splt_v.addWidget(QGroupBox("Box 2"))
        self.splt_v.addWidget(QGroupBox("Box 3"))

        self.wdg = QWidget()
        self.v_lt = QVBoxLayout(self.wdg)
        self.v_lt.addWidget(self.splt_v)

        self.spl_h = customSplitter()
        self.spl_h.addWidget(self.wdg)
        self.spl_h.addWidget(QGroupBox("Box 4"))
        self.spl_h.addWidget(QGroupBox("Box 5"))

        self.h_lt = QHBoxLayout()
        self.h_lt.addWidget(self.spl_h)
        self.w = QWidget()
        self.w.setLayout(self.h_lt)
        self.w.setGeometry(0,0,1280,720)
        self.w.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    MainWindow = QMainWindow()
    ui = Window()
    ui.setUI(MainWindow)
    sys.exit(app.exec_()) 
```

# php - 是否可以关闭 php 标签并在 foreach 循环中间重新打开它们？

> ID：12411857
> 
> 赞同：0
> 
> 时间：2012-09-13T17:41:22.510
> 
> 标签：php

我正在用 php 处理来自数据库的信息，并打算在 html 代码块中设置值：

```
$var = [function to grab multiple rows from database]($args);
foreach ($var as $row) {
echo "<p>$row[username]</p>";
} 
```

问题是 echo 语句中的代码不是简单的`<p></p>`，而是大约 50 行 html。是否可以在 foreach 循环中间关闭 php 标签，如下所示：

```
 $var = [function to grab multiple rows from database]($args);
    foreach ($var as $row) {
?>
<p> <?php echo "$row[username]";?> </p>
<?php
    }
?> 
```

如果没有，你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:46:59.010

**是**的，你可以这样做......

```
<?php
 foreach ($var as $row) {
?>
<p> <?php echo "$row[username]";?> </p>
<!--you can write any html you like-->
<?php
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:53:31.330

你也可以使用这个注解：

```
<?php foreach ($var as $row): ?>
    <p> <?=$row[username] ?> </p>
<?php endforeach; ?> 
```

PD：您不需要在回声中用引号包裹单个 var

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:55:45.420

我个人推荐以下样式（根据预期的安装环境，短标签的使用是可选的。见下文）

```
<? foreach ($var as $row) : ?>
    <p><?= $row[username] ?></p>
<? endforeach ?> 
```

`<?`仅当您在运行环境中完全控制 PHP 配置时才建议使用（例如，您自己运行软件的唯一安装）。

如果您要广泛分发您的软件（如 wordpress 等）并且需要绝对兼容性（例如，您的代码同时兼容 PHP 4 和 PHP 5，并且您的代码在各种 $5/月的共享帐户上运行等）然后强烈建议避免使用短标签。

`<?=`自 PHP 5.4 起得到普遍支持——但同样，如果您有用户在他们自己的服务器上安装您的代码，您不能指望他们有 PHP 5.4 可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T05:52:05.090

是的，这是可能的。您提供的代码示例将起作用。

PHP 甚至为我们提供了替代语法来提高可读性：

```
 $var = [function to grab multiple rows from database]($args);
    foreach ($var as $row) :
?>
<p> <?php echo "$row[username]";?> </p>
<?php
    endforeach;
?> 
```

# apache - URL 路径重写

> ID：12411860
> 
> 赞同：1
> 
> 时间：2012-09-13T17:41:38.057
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting, rewrite

也许这已经被回答过，我似乎无法得到任何工作。我是重写的新手。

我所拥有的是这个，[http://www.domain.com/path1/path2/path3/page](http://www.domain.com/path1/path2/path3/page)

我想要的是从 url 中只删除 path2，所以结果将是[http://www.domain.com/path1/path3/page](http://www.domain.com/path1/path3/page)

如何在不重定向的情况下实现这一目标？

这是我目前拥有的：

`RewriteRule ^/([A-Za-z0-9-]+)/([A-Za-z0-9-]+)/([A-Za-z0-9-]+)$ $1/$3 [L]`

这位于我的虚拟主机文件中。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:13:27.807

尝试更改您的正则表达式以解释第二个之后的所有内容`path`：

```
RewriteRule ^/([A-Za-z0-9-]+)/([A-Za-z0-9-]+)/(.+)$ /$1/$3 [L] 
```

另外，请确保打开重写引擎：

```
RewriteEngine on 
```

# objective-c - 当我尝试登录 Facebook 应用程序时，Facebook 应用程序没有返回到我的应用程序

> ID：12411861
> 
> 赞同：0
> 
> 时间：2012-09-13T17:41:39.870
> 
> 标签：objective-c, facebook

我制作了一个与 Facebook 集成的应用程序，它运行良好，但我遇到了问题。

测试 A - 完美运行

1.  登录 Facebook 应用程序；
2.  打开我的应用程序；
3.  拨打 Facebook 登录；

测试 B - 问题

1.  **在 Facebook 应用程序中**注销；****
***   打开我的应用程序；*   拨打 Facebook 登录；*   Facebook 应用程序要求我登录；*   登录成功 - 但 facebook 没有返回我的应用程序；**

 **谁能帮我？

Obs：我正在使用 Facebook SDK 3.0 和 iOS6 beta 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:45:20.227

听起来您还没有为您的应用程序实现 URL 方案。当您在 facebook 上注册您的应用程序时，它会提供一个 facebookid。像 fb1023098123 这样的东西。您必须在您的应用程序中将此 id 实现为 url 方案。

当 facebook 通过应用引用登录时，它会调用 facebook id url 以在设备上启动应用程序。没有它，设备不知道当 facebook 调用超链接时要启动什么应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:35:17.897

此外，请确保`- (BOOL) application:(UIApplication*)application openURL:(NSURL*)url sourceApplication:(NSString*)sourceApplication annotation:(id)annotation`按照 FB 文档中的详细说明覆盖该方法：

也就是说，在您的 App Delegate 类中，您应该具有以下内容：

```
- (BOOL) application:(UIApplication*)application openURL:(NSURL*)url sourceApplication:(NSString*)sourceApplication annotation:(id)annotation {
    // Do stuff here...
    return [facebook handleOpenURL:url];
} 
```**

# python - 在 python 中获得更精确的答案

> ID：12411863
> 
> 赞同：1
> 
> 时间：2012-09-13T17:41:45.083
> 
> 标签：python, numpy

我正在尝试用 python 实现一个简单的公式。在“RLSR”的情况下，有两种方法可以通过 C=k^-1*y 计算系数“C”，其中 k 是内核矩阵，y 是目标值向量。

第二种方法是使用核方法的特征值（w）和特征向量（v）并使用公式：

```
Sum(u(i)*<u(i),y> / w(i) ). 
```

要检查结果的答案，我正在检查 y=kc 与否！在第一种情况下没关系，但在后一种情况下不是。但问题是我在两种方法中的 c 向量看起来都一样。

**逆**算法的输出：

```
[ 19.49840251  18.82695226  20.08390355  15.01043404  14.79353281
  16.75316736  12.88504257  16.92127176  16.77292954  17.81827473
  20.90503787  17.09359467  18.76366701  18.14816903  20.03491117
  22.56668264  21.45176136  25.44051036  30.40312692  22.61466379
  22.86480382  19.34631818  17.0169598   19.85244414  16.63702471
  20.35280156  20.58093488  22.42058736  20.54935198  19.35541575
  20.39006958  19.74766081  20.41781019  22.33858797  17.57962283
  22.61915219  22.54823733  24.96292824  22.82888425  34.18952603
  20.7487537   24.82019935  22.40621769  21.15767304  27.58919263
  18.39293156  21.55455108  18.69532341] 
```

**第二（特征分解）**算法的输出：

```
[ 19.25280289  18.73927731  19.77184991  14.7650427   14.87364331
  16.2273648   12.29183797  16.52024239  16.66669961  17.59282615
  20.83059115  17.02815857  18.3635798   18.16931845  20.50528549
  22.67690164  21.40479524  25.54544     30.94618128  22.72992565
  23.06289609  17.6485592   15.2758427   19.50578691  16.45571607
  20.19960765  20.35352859  22.60091638  20.36586912  18.90760728
  20.57141151  19.43677153  20.43437031  22.39310576  17.72296978
  22.82139991  22.50744791  25.10496617  22.30462867  34.80540213
  20.77064617  25.18071618  22.5500315   20.71481252  27.91939784
  18.29868659  22.00800019  18.71266093] 
```

这就是我实现它的方式：假设我们有 48 个样本，K 的大小是 48x48 ，y 是 48x1

```
def cpu_compute(y,k):

    w, u=LA.eigh(k)
    uDoty=np.dot(u,y)
    temp=np.transpose(np.tile(w,(len(u),1)))
    div=np.divide(u,temp)

    r=np.tile(uDoty,(len(div),1))
    a=div*r.T
    c=sum(a)

    return c 
```

结果来自

```
print np.allclose(Y,np.dot(K,c)) 
```

是假的。

与真实结果的差异范数也是**3.13014997999**。

现在我不知道如何解决这个问题。我想也许可以通过更准确的答案来做一些事情。

感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:22:08.177

要使用 numpy 解决*kc = y*，请使用`numpy.linalg.solve`：

```
c = solve(k, y) 
```

这使用的算法比您尝试的方法更强大。

# php - 可插件应用的结构

> ID：12411869
> 
> 赞同：1
> 
> 时间：2012-09-13T17:42:04.957
> 
> 标签：php

我想用 PHP 编写应用程序并使其可插入。所以我想拥有一个包含基本功能和插件的核心，我会在需要时添加。（当我编写插件时，我的意思是不同文件中的代码，这是扩展功能）

如何制作这样的应用程序的结构？一些 MVC 框架（Zend、Nette）会有帮助吗？如何自动加载到菜单和/或目标页面？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:45:51.527

Zend Framework 2 和 Symfony 2 提供了适合您需求的依赖注入和服务。

服务就是您所说的插件，您可以将该服务/插件注入您需要的应​​用程序部分。

# c# - 通过 iframe 显示网页

> ID：12411874
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:42:40.337
> 
> 标签：c#, c++, iframe

我正在寻找一个非常简单的程序，它的唯一功能是显示我的网站。所以基本上该程序就像网站的 iframe。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:47:24.470

您不能使用 iFrame，因为它是一种浏览器技术。你必须使用如下的网络浏览器，我相信：

```
using System;
using System.Windows.Forms;

namespace WindowsFormsApplication10
{
    public partial class Form1 : Form
    {
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        // When the form loads, open this web page.
        webBrowser1.Navigate("http://www.dotnetperls.com/");
    }

    private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
    {
        // While the page has not yet loaded, set the text.
        this.Text = "Navigating";
    }

    private void webBrowser1_DocumentCompleted(object sender,
        WebBrowserDocumentCompletedEventArgs e)
    {
        // Better use the e parameter to get the url.
        // ... This makes the method more generic and reusable.
        this.Text = e.Url.ToString() + " loaded";
    }
    }
} 
```

参考。[http://www.dotnetperls.com/webbrowser](http://www.dotnetperls.com/webbrowser)

注意：示例在 C# 中。

看看这个 C++[什么是 C++ 项目的嵌入式浏览器？](https://stackoverflow.com/questions/835201/what-embedded-browser-for-c-project)

# jsp - EL 不被解释并且在生成的 HTML 输出中看起来很普通

> ID：12411877
> 
> 赞同：1
> 
> 时间：2012-09-13T17:42:41.697
> 
> 标签：jsp, struts, jstl, el

我正在使用 Struts1 和 JSP。我可以使用标签访问表单属性，`<bean:write>`但不能使用 JSTL 来访问。为什么不？我的表格是`DynaActionForm`.

该声明有效：

```
<bean:write name="myForm" property="origin"/> 
```

这不起作用，显示 ${myForm.map.origin} 普通香草：

```
<c:out value="${myForm.map.origin}"/> 
```

这也不起作用，显示 ${myForm.origin} 普通香草：

```
<c:out value="${myForm.origin}"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T19:15:55.910

如果 Servlet/JSP、JSTL 和/或 web.xml 版本不匹配，就会发生这种情况。在 Servlet 2.3/JSP 1.2 期间，EL 是 JSTL 1.0 的一部分。在 Servlet 2.4/JSP 2.0 期间，EL 从 JSTL 转移到 JSP，并且 JSTL 1.1 没有 EL。web.xml 版本声明指示当前使用的 Servlet/JSP 版本，并且必须由目标容器支持。

因此，如果您在 Servlet 2.4/JSP 2.0 上使用 JSTL 1.0，或者在 Servlet 2.3/JSP 1.2 上使用 JSTL 1.1，那么您将面临这个问题。此外，如果您在 Servlet 2.4/JSP 2.0 上使用 JSTL 1.1，但 web.xml 被声明为符合 Servlet 2.3（或不包含任何版本声明），那么您也将面临这个问题。

一切都在[我们的 JSTL wiki 页面](https://stackoverflow.com/tags/jstl/info)中进行了解释。您还可以在其中找到正确 JSTL 版本的下载链接以及正确版本特定 web.xml 声明的示例。

另一个可能的原因是您`<%@page isElIgnored="true"%>`在 JSP 顶部或`<jsp-config><el-ignored>true</el-ignored></jsp-config>`in 中有一个声明`web.xml`，但这是一个不容忽视的明显原因。

# c# - 应该在 ReaderWriterLockSlim 锁上调用 Dispose() 吗？

> ID：12411879
> 
> 赞同：2
> 
> 时间：2012-09-13T17:42:45.260
> 
> 标签：c#, multithreading

我从事的一个项目通过商业分析工具进行了分析。它将我们的 ReaderWriterLockSlim 实现标记为内存泄漏的潜在来源，因为我们没有调用 Dispose() 方法。

我从未见过在此锁上调用此方法：无论是在我处理过的代码中，还是在我从中学到的代码示例中。应该调用 Dispose() 吗？如果它在线程仍然需要它时被释放怎么办？这可能吗？

这是我们当前如何使用它的示例 - 没有 Dispose()：

```
 Public Class Test 
    {

    private ReaderWriterLockSlim _lookupLock = new ReaderWriterLockSlim();

            public IDictionary<int, SomeObject> GetAll()
            {
                _lookupLock.EnterWriteLock();
                try
                {
                    if (X == null || X.Count == 0)
                    {
                        Do Something...;
                    }
                }
                finally
                {
                    _lookupLock.ExitWriteLock();
                }

                return Something...;
            }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:03:31.207

它确实需要处理。

a`ReaderWriterLockSlim`主要用于保护静态资源，因此将是不需要处理的静态实例。

但是在您的情况下（`ReaderWriterLockSlim`每个实例一个），您需要创建您的 class`IDisposable`并处置`ReaderWriterLockSlim`.

或者也许更好的选择是使用普通锁（即监视器）来保护实例资源，而不是使用`ReaderWriterLockSlim`. 可能没有太大的性能差异，它使您的代码更简单，并且避免了您需要使您的类 IDisposable。

框架类如`ConcurrentDictionary`使用普通锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:47:40.130

在您的班级中，尝试从 IDisposable 继承。以此类声明为例。

将您的声明更改为此，当然，添加现有代码的其余部分。

```
Public Class Test : IDisposable
{

} 
```

我将如何声明它，示例如下。

```
public class WriteLock : IDisposable
{
   ReaderWriterLockSlim _rwlock;
   public WriteLock(ReaderWriterLockSlim rwlock ) 
   { 
      _rwlock = rwlock;
      _rwlock.EnterWriteLock(); 
   }
   public void Dispose()
   {
      _rwlock.ExitWriteLock(); 
   }
} 
```

# xml - 在 Force.com 平台上的 Public Restful Web 服务上响应 XML 数据

> ID：12411886
> 
> 赞同：0
> 
> 时间：2012-09-13T17:43:11.853
> 
> 标签：xml, web-services, rest, salesforce, force.com

我已经测试了以下代码

```
@RestResource(urlMapping='/myservice')

global class MyService {
    @HttpGet
    global static void doGet() {
        RestContext.response.addHeader('Content-Type', 'text/plain');
        String name = RestContext.request.params.get('name');

        RestContext.response.responseBody = Blob.valueOf('Hello '+name);
    }
} 
```

默认情况下，返回类型是 JSON。如何将响应格式更改为 XML。我尝试关注 RestContext.response..addHeader('Content-type','text/xml'); RestContext.response..responseBody=Blob.valueOf(''+newcase.Id+'');

但我仍然没有得到 XML 的响应

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:54:52.067

您必须将其设置`content-type`为**请求**而不是响应。

例如：

```
curl -H "Authorization: Bearer sessionId" -H "Content-Type: text/xml" -d @account.txt "https://instance.salesforce.com/services/apexrest/Account/" 
```

此外，您应该定义一个[XML 命名空间](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_xml_dom_document.htm)来引用您的方法使用的任何 Apex 命名空间。

注意`Content-Type`响应中的设置，使用`XML`.

> 某些参数和返回类型不能与 XML 一起用作请求的 Content-Type 或作为响应的接受格式，因此，具有这些参数或返回类型的方法不能与 XML 一起使用。

[更](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_rest_methods.htm)详细的信息

# c++ - 我们可以称程序中的潜在障碍吗

> ID：12411887
> 
> 赞同：1
> 
> 时间：2012-09-13T17:43:20.833
> 
> 标签：c++, c, multithreading, synchronization

我希望我的线程在障碍点停止，但我只想在需要障碍时停止。例如，在某个计时器间隔之后，我希望所有线程都形成一个屏障。有没有设置潜在障碍点的方法？例如在每个函数的开始。我想要这样的东西。

```
void some_function()
{
 potentially_barrier_wait;
 ......
} 
```

所以我只想`potentially_barrier_wait`在需要时调用屏障，否则`potentially_barrier_wait`什么也不做。这件事能不能圆满实施？这是否也适用于已经存在障碍的程序，还是会与它们竞争。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:04:52.657

取决于你所说的屏障的意思......如果你指的是简单的同步，你可以这样做：

在 Windows 上，创建一个事件 CreateEvent(0, false, 0, 0)。在您的线程中，对其执行 WaitForSingleObject 。在您的“控制”线程中， SetEvent 让它通过您的障碍。您可以使用它进行预设和自动释放等。

在 Linux 上，类似，但您可以使用 pthread_cond_timedwait 作为屏障，并使用 pthread_cond_signal 发出信号。

# asp.net - 通过 IE 中的客户端进行 ASP.NET 回发

> ID：12411888
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:43:31.750
> 
> 标签：asp.net, internet-explorer, postback, client-side

> **可能重复：**
> [使用 JavaScript 的 ASP.NET 回发](https://stackoverflow.com/questions/1305954/asp-net-postback-with-javascript)

我将使用 JavaScript 函数在我的 ASP.NET Web 应用程序中进行回发，我可以轻松地进行回发并在 Firefox 和 chrome 中调用服务器端函数，但在 IE 中没有运气！我已经测试了几种方法，是否可以在IE中进行这样的操作？有现场演示吗？任何样品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:51:43.777

尝试

__dopostback('<%button.UniqueID'%>');

# android - 解析 Web 服务 XML 并插入数据库的最快方法

> ID：12411890
> 
> 赞同：0
> 
> 时间：2012-09-13T17:43:44.930
> 
> 标签：android, android-sqlite

我已经为此苦苦挣扎了很长时间，经过长时间的研究，我认为是时候在这里发布这个问题了。所以这就是问题所在。我正在开发一个 Android 应用程序，它基本上是一个非常大的系统的数据库端口，用于快速咨询。所以我有一个必须通过 web 服务调用更新的 SQLite 数据库。

为此，我使用 SOAP 调用一些 Web 服务，并使用 SAXParser 解析响应。但问题就在这里。每个页面或更新都需要很长时间，因为解析 500 项 XML 并更新数据库需要大约 20 秒。这是一个问题，因为在最坏的情况下，应用程序将进行 2000 次 Web 服务调用。

我考虑过两种方法来进行 XML 解析。第一个（我们称之为 Approach1）是解析整个回调，将信息保存在对象数组中，然后通过事务更新 DB。第二个（Approach2）是在我解析 XML 时更新数据库。所以，每次我完成一个项目的解析，我都会做一个 BD 插入。

这是我使用的代码

## **方法1**

```
public class ContactsParser extends DefaultHandler
{
    private String foundData = "";
    private ContactObj[] contactObj;
    private int objectLength = 3000;
    private int totalContacts = 0;
    private long initiationTime;
    private Context dbContext;

    public void setObjectLength(int oLength){
        objectLength = oLength;
    }

    public void setContext(Context ctx) {
        dbContext = ctx;
    }

    public synchronized void parse(InputStream is) 
                throws ParserConfigurationException, SAXException, IOException
    {
        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();
        xr.setContentHandler(this);

        xr.parse(new InputSource(is));
    }

    @Override
    public void characters(char ch[], int start, int length)
    {
        foundData += new String(ch, start, length);
    }

    @Override
    public void startDocument() throws SAXException 
    {
        //Initialize the array of objects with the length of the Webservice page.
        totalContacts = 0;
        initiationTime = System.currentTimeMillis();
        contactObj = new ContactObj[objectLength];
    }

    @Override
    public void startElement(String namespaceURI, String localName,
                    String qName, Attributes atts) throws SAXException 
    {
        foundData = "";
        try{
            if (totalContacts == 0) {
            companiesObj[totalContacts] = new CompaniesObj();
            }               
        }
        catch (Exception e){
            // Catch error
        }
    }

    @Override
    public void endElement(String namespaceURI, String elementName, String qName)
            throws SAXException
    {
        if(qName.equals("contactItem")) {
        if (totalContacts < objectLength){
                contactObj[totalContacts] = new ContactObj();
        }

        /**
         *  <contactItem>
         *      <contactAtt1>value</contactAtt1>
         *      <contactAtt2>value</contactAtt2>
         *  </contactItem>
         */
        try {
            if(qName.equals("contactAtt1"))
            {
                contactObj[totalContacts].setContactAtt1(foundData);
            }
            else if(qName.equals("contactAtt2"))
            {
                contactObj[totalContacts].setContactAtt2(foundData);
            }
        catch(Exception e)
        {
            // catch error
        }
    }

    @Override
    public void endDocument() throws SAXException
    {
        try {
            //DBHelper is a class that performs all DB related processes.
            //getInstance sees if the instance of the object DBHelper.self exists. If not, it creates it.
            DBHelper.getInstance(dbContext).db.beginTransaction();
            for (int i = 0; i < totalContacts; i++){
                DBHelper.self.sqLiteConctacts.insertRow(contactObj[i]);
            }
            DBHelper.self.db.setTransactionSuccessful();
        } catch (Exception e){
            // catch this exception
        } finally {
        DBHelper.self.db.endTransaction();
        DBHelper.self.closeDB();
    }
        Logger.logMessage("Requried time to complete ContactParseing: "+(System.currentTimeMillis()-initiationTime));
        Logger.logMessage("Parsing ended of ContactParser:" + totalContacts);

    }
} 
```

这种方法具有使用事务进行更新的巨大优势，但代价是必须在进行更新之前解析整个文档。

## **方法2**

```
public class ContactsParseAndInsert extends DefaultHandler
{
    private String foundData = "";
    private int totalContacts = 0;
    private long initiationTime;
    private Context dbContext;

    // Contact attributes
    private String contactAtt1 = "";
    private String contactAtt2 = "";

    public void setContext(Context ctx) {
        dbContext = ctx;
    }

    public synchronized void parse(InputStream is) 
                throws ParserConfigurationException, SAXException, IOException
    {
        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();
        xr.setContentHandler(this);

        xr.parse(new InputSource(is));
    }

    @Override
    public void characters(char ch[], int start, int length)
    {
        foundData += new String(ch, start, length);
    }

    @Override
    public void startDocument() throws SAXException 
    {
        //Initialize the array of objects with the length of the Webservice page.
        totalContacts = 0;
        initializationTime = System.currentTimeMillis();
        DBHelper.getInstance(dbContext);
        Logger.logMessage("Parsing started of ContactParser With instant insert.");
    }

    @Override
    public void startElement(String namespaceURI, String localName,
                    String qName, Attributes atts) throws SAXException 
    {
        foundData = "";
    }

    @Override
    public void endElement(String namespaceURI, String elementName, String qName)
            throws SAXException
    {
        if(qName.equals("ContactItem")) {
            DBHelper.self.sqLiteConctacts.insertRow(contactAtt1, contactAtt2);
        }

        /**
         *  <companiesObj>
         *      <contactAtt1>value</contactAtt1>
         *      <contactAtt2>value</contactAtt2>
         *  </companiesObj>
         */
        try {
            if(qName.equals("contactAtt1"))
            {
                contactAtt1 = foundData;
            }
            else if(qName.equals("contactAtt2"))
            {
                contactAtt2 = foundData;
            }
        catch(Exception e)
        {
            // catch error
        }
    }

    @Override
    public void endDocument() throws SAXException
    {
        DBHelper.self.closeDB();
        Logger.logMessage("Requried time to complete ContactParseing: "+(System.currentTimeMillis()-initiationTime));
        Logger.logMessage("Parsing ended of ContactParser:" + totalContacts);
    }
} 
```

第二种方法的优点是我可以让 XML 随心所欲，而且不会有任何内存问题。但是这样就不可能有数据库事务。

另一件重要的事情是，所有这一切都发生在运行它自己的线程并通过 Messenger 与我的活动通信的服务中。

他们都正确地完成了工作，但我宁愿使用第二种方法。谁能告诉我如何加快速度？有人知道更好的方法吗？以下是我在日志中得到的结果。（所有那些 dalvikvm 的停顿让我有点担心）

```
09-13 12:31:42.653: I/MyFaultyApp(6477): Parsing started of ContactParser With instant insert.
09-13 12:31:42.653: I/MyFaultyApp(6477): --------------------------------------------------------
09-13 12:31:43.563: D/dalvikvm(6477): GC_CONCURRENT freed 418K, 29% free 2458K/3459K, paused 11ms+1ms, total 32ms
09-13 12:31:45.213: D/dalvikvm(6477): GC_CONCURRENT freed 427K, 30% free 2432K/3459K, paused 11ms+14ms, total 35ms
09-13 12:31:46.493: D/dalvikvm(6477): GC_CONCURRENT freed 389K, 30% free 2431K/3459K, paused 14ms+12ms, total 36ms
09-13 12:31:47.663: D/dalvikvm(6477): GC_CONCURRENT freed 411K, 30% free 2433K/3459K, paused 1ms+2ms, total 13ms
09-13 12:31:49.213: D/dalvikvm(6477): GC_CONCURRENT freed 420K, 30% free 2432K/3459K, paused 1ms+12ms, total 25ms
09-13 12:31:50.273: D/dalvikvm(6477): GC_CONCURRENT freed 415K, 30% free 2433K/3459K, paused 1ms+1ms, total 14ms
09-13 12:31:51.203: D/dalvikvm(6477): GC_CONCURRENT freed 410K, 30% free 2432K/3459K, paused 1ms+1ms, total 16ms
09-13 12:31:52.183: D/dalvikvm(6477): GC_CONCURRENT freed 415K, 30% free 2432K/3459K, paused 1ms+2ms, total 19ms
09-13 12:31:53.123: D/dalvikvm(6477): GC_CONCURRENT freed 399K, 30% free 2430K/3459K, paused 11ms+12ms, total 34ms
09-13 12:31:53.653: D/dalvikvm(6477): GC_CONCURRENT freed 392K, 30% free 2430K/3459K, paused 11ms+1ms, total 22ms
09-13 12:31:54.423: D/dalvikvm(6477): GC_CONCURRENT freed 407K, 30% free 2433K/3459K, paused 11ms+1ms, total 23ms
09-13 12:31:55.103: D/dalvikvm(6477): GC_CONCURRENT freed 408K, 30% free 2435K/3459K, paused 12ms+12ms, total 36ms
09-13 12:31:55.623: D/dalvikvm(6477): GC_CONCURRENT freed 413K, 30% free 2435K/3459K, paused 11ms+14ms, total 36ms
09-13 12:31:56.793: D/dalvikvm(6477): GC_CONCURRENT freed 410K, 30% free 2435K/3459K, paused 11ms+15ms, total 36ms
09-13 12:31:57.493: D/dalvikvm(6477): GC_CONCURRENT freed 416K, 30% free 2431K/3459K, paused 1ms+2ms, total 14ms
09-13 12:31:58.563: I/MyFaultyApp(6477): Requried time to complete ContactParseing: 15910
09-13 12:31:58.563: I/MyFaultyApp(6477): --------------------------------------------------------
09-13 12:31:58.563: I/MyFaultyApp(6477): Parsing ended of ContactParser:500
09-13 12:31:58.563: I/MyFaultyApp(6477): --------------------------------------------------------
09-13 12:31:58.573: D/dalvikvm(6477): GC_CONCURRENT freed 407K, 30% free 2439K/3459K, paused 13ms+3ms, total 28ms
09-13 12:32:00.503: I/MyFaultyApp(6477): Parsing started of ContactParser With instant insert.
09-13 12:32:00.503: I/MyFaultyApp(6477): --------------------------------------------------------
09-13 12:32:00.803: D/dalvikvm(6477): GC_CONCURRENT freed 399K, 29% free 2460K/3459K, paused 12ms+1ms, total 34ms
09-13 12:32:01.233: D/dalvikvm(6477): GC_CONCURRENT freed 440K, 30% free 2431K/3459K, paused 13ms+1ms, total 26ms
09-13 12:32:01.953: D/dalvikvm(6477): GC_CONCURRENT freed 404K, 30% free 2435K/3459K, paused 11ms+2ms, total 24ms
09-13 12:32:03.643: D/dalvikvm(6477): GC_CONCURRENT freed 413K, 30% free 2432K/3459K, paused 1ms+12ms, total 24ms
09-13 12:32:06.313: D/dalvikvm(6477): GC_CONCURRENT freed 386K, 29% free 2472K/3459K, paused 11ms+1ms, total 31ms
09-13 12:32:08.433: D/dalvikvm(6477): GC_CONCURRENT freed 457K, 30% free 2434K/3459K, paused 11ms+1ms, total 30ms
09-13 12:32:09.733: D/dalvikvm(6477): GC_CONCURRENT freed 423K, 30% free 2436K/3459K, paused 13ms+12ms, total 44ms
09-13 12:32:13.873: D/dalvikvm(6477): GC_CONCURRENT freed 405K, 30% free 2431K/3459K, paused 13ms+2ms, total 25ms
09-13 12:32:15.743: D/dalvikvm(6477): GC_CONCURRENT freed 411K, 30% free 2433K/3459K, paused 1ms+1ms, total 14ms
09-13 12:32:18.593: D/dalvikvm(6477): GC_CONCURRENT freed 412K, 30% free 2435K/3459K, paused 1ms+1ms, total 13ms
09-13 12:32:20.752: D/dalvikvm(6477): GC_CONCURRENT freed 386K, 29% free 2467K/3459K, paused 14ms+11ms, total 34ms
09-13 12:32:22.003: D/dalvikvm(6477): GC_CONCURRENT freed 445K, 30% free 2436K/3459K, paused 1ms+1ms, total 14ms
09-13 12:32:23.113: D/dalvikvm(6477): GC_CONCURRENT freed 421K, 30% free 2435K/3459K, paused 11ms+2ms, total 32ms
09-13 12:32:24.033: D/dalvikvm(6477): GC_CONCURRENT freed 385K, 30% free 2442K/3459K, paused 13ms+5ms, total 27ms
09-13 12:32:24.902: D/dalvikvm(6477): GC_CONCURRENT freed 415K, 30% free 2433K/3459K, paused 11ms+1ms, total 28ms
09-13 12:32:25.203: I/MyFaultyApp(6477): Requried time to complete ContactParseing: 24707
09-13 12:32:25.203: I/MyFaultyApp(6477): --------------------------------------------------------
09-13 12:32:25.203: I/MyFaultyApp(6477): Parsing ended of ContactParser:500
09-13 12:32:25.203: I/MyFaultyApp(6477): -------------------------------------------------------- 
```

谢谢你，很抱歉这么长的帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:33:47.630

使用这个家伙[XmlPullParser](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html)更可取。

# hibernate - IN子句中多列的休眠条件查询

> ID：12411894
> 
> 赞同：2
> 
> 时间：2012-09-13T17:44:09.307
> 
> 标签：hibernate

我有一个如下表代码（位置，代码，描述，开始日期，结束日期）

我需要使用 Hibernate 条件或分离条件的以下查询

SELECT location, code, description, start_date, end_date FROM CODES WHERE (location,code) in (('loc1','1'),('loc2','2'),('loc3','3'), ('loc4','4'),('loc5','5'))

我必须将位置和代码值作为参数传递（在运行时动态传递）。

如何使用 Hibernate 条件或分离条件获取上述查询

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:19:14.267

SQL 中的等效表达式是：

```
SELECT location, code, description, start_date, end_date 
FROM CODES 
WHERE (
    (location = 'loc1' AND code = '1') OR
    (location = 'loc2' AND code = '2') OR
    (location = 'loc3' AND code = '3') OR
    (location = 'loc4' AND code = '4') OR
    (location = 'loc5' AND code = '5')
) 
```

您可以按照[此说明](https://stackoverflow.com/questions/8126589/hibernate-criteria-restrictions-and-or-combination "Hibernate Criteria Restrictions AND / OR 组合")编写休眠条件。

# asynchronous - CUDA 流、纹理绑定和异步 memcpy

> ID：12411896
> 
> 赞同：3
> 
> 时间：2012-09-13T17:44:20.913
> 
> 标签：asynchronous, concurrency, cuda, textures

在 CUDA 中编写一些信号处理 我最近在优化它方面取得了巨大进展。通过使用 1D 纹理和调整我的访问模式，我设法获得了 10 倍的性能提升。（我之前尝试过从全局到共享内存的事务对齐预取，但后来发生的非统一访问模式搞砸了 warp→shared cache bank 关联（我认为））。

所以现在我面临的问题是 CUDA 纹理和绑定如何与异步 memcpy 交互。

考虑以下内核

```
texture<...> mytexture;

__global__ void mykernel(float *pOut)
{
    pOut[threadIdx.x] = tex1Dfetch(texture, threadIdx.x);
} 
```

内核在多个流中启动

```
extern void *sourcedata;

#define N_CUDA_STREAMS ...

cudaStream stream[N_CUDA_STREAMS];
void *d_pOut[N_CUDA_STREAMS];
void *d_texData[N_CUDA_STREAMS];

for(int k_stream = 0; k_stream < N_CUDA_STREAMS; k_stream++) {
    cudaStreamCreate(stream[k_stream]);

    cudaMalloc(&d_pOut[k_stream], ...);
    cudaMalloc(&d_texData[k_stream], ...);
}

/* ... */

for(int i_datablock; i_datablock < n_datablocks; i_datablock++) {
    int const k_stream = i_datablock % N_CUDA_STREAMS;
    cudaMemcpyAsync(d_texData[k_stream], (char*)sourcedata + i_datablock * blocksize, ..., stream[k_stream]);

    cudaBindTexture(0, &mytexture, d_texData[k_stream], ...);

    mykernel<<<..., stream[k_stream]>>>(d_pOut);
} 
```

现在我想知道的是，由于只有一个纹理引用，当我将缓冲区绑定到纹理而其他流的内核访问该纹理时会发生什么？`cudaBindStream`不采用流参数，所以我担心通过在运行内核异步访问所述纹理时将纹理绑定到另一个设备指针，我会将它们的访问转移到其他数据。

CUDA 文档没有说明这一点。如果必须解开它以允许并发访问，似乎我必须创建许多纹理引用并使用 switch 语句在它们之间进行选择，基于作为内核启动参数传递的流号。

不幸的是，CUDA 不允许在设备端放置纹理数组，即以下方法不起作用：

```
texture<...> texarray[N_CUDA_STREAMS]; 
```

分层纹理*不是一个选项*，因为我拥有的数据量仅适合未绑定到 CUDA 数组的普通 1D 纹理（请参阅 CUDA 4.2 C 编程指南中的表 F-2）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T18:42:36.090

事实上，你不能在不同的流中使用纹理时解除绑定。

由于流的数量不需要很大来隐藏异步 memcpys（2 已经可以），您可以使用 C++ 模板为每个流赋予其自己的纹理：

```
texture<float, 1, cudaReadModeElementType> mytexture1;
texture<float, 1, cudaReadModeElementType> mytexture2;

template<int TexSel> __device__ float myTex1Dfetch(int x);

template<> __device__ float myTex1Dfetch<1>(int x) { return tex1Dfetch(mytexture1, x); }
template<> __device__ float myTex1Dfetch<2>(int x) { return tex1Dfetch(mytexture2, x); }

template<int TexSel> __global__ void mykernel(float *pOut)
{
    pOut[threadIdx.x] = myTex1Dfetch<TexSel>(threadIdx.x);
}

int main(void)
{
    float *out_d[2];

    // ...

    mykernel<1><<<blocks, threads, stream[0]>>>(out_d[0]);
    mykernel<2><<<blocks, threads, stream[1]>>>(out_d[1]);

    // ...
} 
```

# python - 我可以在 python pandas csv 加载中对标题字段名称进行模糊匹配吗？

> ID：12411897
> 
> 赞同：1
> 
> 时间：2012-09-13T17:44:31.233
> 
> 标签：python, csv, pandas

几天前我有一个类似的问题已经解决了，但是现在，我的一些文件有一个非常相似的文件，但是标题在名称之前有一个空格，或者一个“。” 最后，它只是不起作用。

所以，我有这个*data1*：

```
 Year,Day,Hour,Min,Sec.,P1S1
 2003,  1, 0, 1,30.09, 0.295E+04
 2003,  1, 1, 0,11.84, 0.297E+04
 2003,  1, 2, 0, 8.26, 0.338E+04
 2003,  1, 3, 0, 4.69, 0.291E+04
 2003,  1, 4, 0, 1.11, 0.337E+04 
```

我可以阅读它（**注意“年”中的年之前需要一个空格，这是阅读文件所必需的！**）：

```
import pandas as pd

def parse(yr, doy, hr, min, sec):
    yr, doy, hr, min = [int(x) for x in [yr, doy, hr, min]]
    sec = float(sec)
    mu_sec = int((sec - int(sec)) * 1e6)
    sec = int(sec)
    dt = datetime(yr - 1, 12, 31)
    delta = timedelta(days=doy, hours=hr, minutes=min, seconds=sec, microseconds=mu_sec)

    return dt + delta

# notice the need of a space before Year in ' Year', that is needed to read the file!
pd.read_csv(data1, parse_dates=[[' Year','Day','Hour','Min','Sec.']], date_parser=parse, index_col=0) 
```

现在，如果我尝试对*data2*进行相同操作（请注意，现在在 Min 之后有一个“。”，在 data1 中不存在）：

```
 Year,Day,Hour,Min.,Sec.,P1S1
 2003,  1, 0, 0, 0.00, 0.261E+04
 2003,  1, 0, 5, 0.00, 0.281E+04
 2003,  1, 0,10, 0.00, 0.268E+04
 2003,  1, 0,15, 0.00, 0.305E+04 
```

当我做：

```
pd.read_csv(data2, parse_dates=[[' Year','Day','Hour','Min','Sec.']], date_parser=parse, index_col=0) 
```

我收到一个错误，因为 Python/Pandas 不期望那个 '.' 在'Min'之后，或者当我有一个在'Year'之前没有空格的文件时相同。或前 5 个标头字段名称中的任何其他细微差别。

所以，我的问题是，有什么方法可以让这更健壮吗？我知道前 5 个字段始终采用这种格式，只是标题中的名称发生了变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:23:13.100

如果您知道他们总是处于相同的位置，您可以说类似`parse_dates=[[0,1,2,3,4]]`.

# jenkins - Cloudbees动态参数

> ID：12411898
> 
> 赞同：0
> 
> 时间：2012-09-13T17:44:35.220
> 
> 标签：jenkins, cloudbees

有谁知道是否可以在 Cloudbees 的构建作业配置中添加动态参数？

我有一个具有“选择”构建参数的构建，但我希望该选择的值来自函数调用，而不是配置中的固定列表设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T08:16:14.843

CloudBees CI 平台上不允许使用动态参数插件，因为该插件允许用户在 master 上执行任意代码（填充参数列表）。我们（cloudbees）不允许用户在平台上拥有 RUN_SCRIPT 权限，这可能会给我们的多租户架构带来一些安全问题。

# mysql - 为什么 IFNULL 不从左连接移植？

> ID：12411899
> 
> 赞同：0
> 
> 时间：2012-09-13T17:44:40.247
> 
> 标签：mysql

基本上我希望一列在 null 时返回 0。我在嵌套语句中使用 ifnull，当我自己运行嵌套语句时，列返回 0，但是当我运行整个查询时，我再次得到 NULL。这是我的代码：

```
SELECT Text, Verbo, Objeto, mPosts FROM Posts
    LEFT JOIN (SELECT ID, IFNULL(COUNT(*),0) AS mPosts FROM `Posts` WHERE Date >= DATE_ADD(CURDATE(), INTERVAL -30 DAY) GROUP BY `Verbo`,`Objeto`) AS B ON Posts.ID = B.ID 
```

我可以将 IFNULL 移动到主 select 语句，但我不希望：

```
SELECT Text, Verbo, Objeto, IFNULL(mPosts,0) FROM Posts
    LEFT JOIN (SELECT ID, COUNT(*) AS mPosts FROM `Posts` WHERE Date >= DATE_ADD(CURDATE(), INTERVAL -30 DAY) GROUP BY `Verbo`,`Objeto`) AS B ON Posts.ID = B.ID 
```

为什么我不能在嵌套语句上做到这一点？可以以其他任何方式完成，以便我不必在主查询中使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:48:47.560

如果您正在获取`NULL`for `IFNULL(COUNT(*),0)`，那是因为 the`LEFT JOIN`与您的`ON`子句 of不匹配`Posts.ID = B.ID`，因此右表中的**所有**值都将是`NULL`。

所以是的，您需要转到`IFNULL`顶级`SELECT`子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:23:29.373

您必须`IFNULL`在外部查询上有。

内部`COUNT(*)`查询中没有返回 NULL，NULL 是由 LEFT JOIN 操作创建的，当左侧的行没有来自右侧行源的匹配行时。

此查询等效于您的查询：

```
SELECT a.Text
     , a.Verbo
     , a.Objeto
     , c.mPosts
  FROM `Posts` a
  LEFT
  JOIN ( SELECT b.ID
              , COUNT(*) AS mPosts
           FROM `Posts` b
          WHERE b.Date >= DATE_ADD(CURDATE(), INTERVAL -30 DAY)
          GROUP BY b.`Verbo`, b.`Objeto`
       ) c
    ON c.ID = a.ID 
```

* * *

重新格式化的查询使问题所在的位置更加明显。

您的内联视图（子查询）正在对两列执行`GROUP`BY，然后`ID`从包含在每个计数值中的某一行返回值。

（其他关系数据库会抛出“非聚合在选择列表中而不是分组依据”类型的异常，其中 MySQL 更自由，这既方便又诅咒。）

查询返回的结果集很奇怪。目前尚不清楚您希望在此处返回什么结果集。

“count”子查询中的行将仅与 COUNT() 的每个值中包含的一行匹配。（任何时候 COUNT(*) 大于 1，外部查询中都会有一行没有来自内联视图的匹配行...... GROUP BY 正在折叠所有的 ID 值包含的行直到包含的某一行的一个 ID 值。

我不愿提出任何建议，因为我不清楚您想要返回什么。

您可以做的一件事是从 WHERE 子句中删除谓词，而是在聚合中检查该条件，就像这样......

```
SELECT a.`Text`
     , a.`Verbo`
     , a.`Objeto`
     , c.`mPosts`
  FROM `Posts` a
  LEFT
  JOIN ( SELECT b.ID
              , SUM(IF b.`Date` >= DATE_ADD(CURDATE(), INTERVAL -30 DAY)) AS `mPosts`
           FROM `Posts` b
          GROUP BY b.`Verbo`, b.`Objeto`
       ) c
    ON c.ID = a.ID 
```

这可能会减少 NULL 值的数量，但它没有解决 LEFT JOIN 为左侧没有来自右侧匹配的任何行生成 NULL 的更基本问题。

# jquery - 只有 Twitter Bootstrap 的 Popover 需要什么？

> ID：12411903
> 
> 赞同：10
> 
> 时间：2012-09-13T17:44:51.403
> 
> 标签：jquery, twitter-bootstrap, popover

我知道我可以访问[http://twitter.github.com/bootstrap/customize.html#components](http://twitter.github.com/bootstrap/customize.html#components)并选择使弹出框工作所需的唯一组件。

我更新了`js`和`css`链接到下载的文件。我没有收到任何错误，但我也没有收到弹出框。

**原始问题：**
我想将弹出窗口添加到我的站点，但引导程序的标准 css 文件与我现有的样式冲突。从[http://twitter.github.com/bootstrap/1.4.0/bootstrap.min.css](http://twitter.github.com/bootstrap/1.4.0/bootstrap.min.css)，有人可以告诉我我需要哪些点点滴滴来制作弹出框吗？我使用 Firebug 来查看调用了哪些类，但我显然遗漏了一些东西。我不必使用 Boostrap 的 Popover，如果它们易于使用，我对其他插件持开放态度。

CSS

```
/* CSS Document */
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1010;
  display: none;
  padding: 5px;
}
.popover.top {
  margin-top: -5px;
}
.popover.right {
  margin-left: 5px;
}
.popover.bottom {
  margin-top: 5px;
}
.popover.left {
  margin-left: -5px;
}
.popover.top .arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid #000000;
}
.popover.right .arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-top: 5px solid transparent;
  border-bottom: 5px solid transparent;
  border-right: 5px solid #000000;
}
.popover.bottom .arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-bottom: 5px solid #000000;
}
.popover.left .arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-top: 5px solid transparent;
  border-bottom: 5px solid transparent;
  border-left: 5px solid #000000;
}
.popover .arrow {
  position: absolute;
  width: 0;
  height: 0;
}
.popover-inner {
  padding: 3px;
  width: 280px;
  overflow: hidden;
  background: #000000;
  background: rgba(0, 0, 0, 0.8);
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
  -moz-box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
  box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
}
.popover-title {
  padding: 9px 15px;
  line-height: 1;
  background-color: #f5f5f5;
  border-bottom: 1px solid #eee;
  -webkit-border-radius: 3px 3px 0 0;
  -moz-border-radius: 3px 3px 0 0;
  border-radius: 3px 3px 0 0;
}
.popover-content {
  padding: 14px;
  background-color: #ffffff;
  -webkit-border-radius: 0 0 3px 3px;
  -moz-border-radius: 0 0 3px 3px;
  border-radius: 0 0 3px 3px;
  -webkit-background-clip: padding-box;
  -moz-background-clip: padding-box;
  background-clip: padding-box;
}
.popover-content p, .popover-content ul, .popover-content ol {
  margin-bottom: 0;
}

.fade {
  -webkit-transition: opacity 0.15s linear;
  -moz-transition: opacity 0.15s linear;
  -ms-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
  opacity: 0;
}
.fade.in {
  opacity: 1;
}

h3 {
  /*    line-height: 27px;  */
  font-size: 18px;
}

p {
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    font-size: 13px;
    line-height: 18px;
    margin: 0 0 9px;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T18:49:51.187

您可以在 twitter 引导站点（[此处](http://getbootstrap.com/customize/)）上自定义您的下载。为了只为弹出框获取 css，只需选择它并取消选中其他所有内容，您将允许您下载仅在弹出框上使用的常规类和响应类。

# android - 只有主页按钮在我的应用程序中有效

> ID：12411904
> 
> 赞同：1
> 
> 时间：2012-09-13T17:45:02.723
> 
> 标签：android

默认情况下，在我的应用程序中，后退和菜单按钮不起作用，长按搜索按钮也不起作用。这只发生在我的应用程序中，它不适用于我想要的高清、模拟器或 Galaxy nexus（软件后退按钮）。

可能是什么问题呢？这只是发生在我身上吗？

要使后退按钮关闭我的应用程序，我必须对其进行硬编码

# vb.net - 在从该事件处理程序调用的子窗体中如何忽略 Windows 事件？

> ID：12411910
> 
> 赞同：0
> 
> 时间：2012-09-13T17:45:33.103
> 
> 标签：vb.net, winforms, fingerprint

我的具体问题是：如何在从该事件处理程序调用的子窗体中忽略 Windows 事件？

一些上下文：我的应用程序捕获一个指纹，并在针对数据库识别打印时提出下一个表单（secondForm）。我想忽略他们在 secondForm 启动时放入的任何打印件。问题是，当人们多次按下打印时，或者当他们的 secondForm 启动时，事件会排队直到 secondForm 关闭之后，所以我会多次调用那个人的事件处理程序。我已经尝试了很多解决这个问题的方法，包括调用作为委托打开 secondForm 的例程（这是否合适），在事件处理程序中放置一个全局布尔值等。如果我在 oncomplete 事件处理程序期间禁用指纹捕获，我的表单将永远不会出现。
我在这里遗漏了一些对你来说很明显的东西吗？非常感谢任何想法......

```
Imports DPFP.Capture ' DigitalPersona fingerprint reader library
' Simple example to capture a fingerprint from DigitalPersona fingerprint reader.
Public Class SimpleFP
Implements DPFP.Capture.EventHandler

Private mIgnore As Boolean
Public eventHandlerComplete As DPFP.Capture.EventHandler
Public WithEvents mCapture As DPFP.Capture.Capture

Private Sub WaitForFPrint_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Try
        ' set up finger print capture
        mCapture = New DPFP.Capture.Capture
        mCapture.EventHandler = Me
        mCapture.StartCapture()
    Catch ex As Exception
        MsgBox("Problem starting fingerprint reader: " & ex.Message)
    End Try
End Sub

Public Sub FPOnComplete(ByVal Capture As Object, ByVal sernum As String, ByVal sample As DPFP.Sample) _
    Implements DPFP.Capture.EventHandler.OnComplete

    'mCapture.StopCapture()  
    'This is what I want to do, but when I leave this in,  my secondForm won't stay up

    Dim s As String = displaySecondScreen(sample)

    showStatus(s)
    'mCapture.StartCapture()  
     'This is what I want to do, but when I leave this in,  my secondForm won't stay up
End Sub

' Put up second form. This is called from the fingerprint OnComplete event handler.
Private Function displaySecondScreen(ByVal sample As DPFP.Sample) As String

    Dim status As String = "OK"
    Try
        Dim x As DPFP.FeatureSet
        x = extractFeatures(sample)

        ' This is where I match the fp in my code, but I removed here to simplify
        If True Then

            Dim frm As New frmSecondForm
            frm.ShowDialog(Me)
            frm.Dispose()

        Else
            ' No fingerprint match - normal case
            status = "Fingerprint not recognized"
        End If
    Catch ex As Exception
        status = "Exception during fingerprint verification: " & ex.Message
    End Try
    Return status
End Function

' Made rudimentary for this example, but I thought some person new to dpfp  may be able to use this
Private Function extractFeatures(ByVal sample As DPFP.Sample) As DPFP.FeatureSet
    Dim extractor As New DPFP.Processing.FeatureExtraction()
    Dim feedback As New DPFP.Capture.CaptureFeedback()
    Dim features As New DPFP.FeatureSet()
    extractor.CreateFeatureSet(sample, DPFP.Processing.DataPurpose.Verification, feedback, features)
    If feedback = DPFP.Capture.CaptureFeedback.Good Then

    End If
    Return features
End Function

Private Sub debugOut(ByVal s As String)
    Console.WriteLine(s)
End Sub

' Display status on first form
Delegate Sub showStatusCallback(ByVal s As String)

Private Sub showStatus(ByVal s As String)
    If lblStatus.InvokeRequired Then
        Dim d As New showStatusCallback(AddressOf showStatus)
        Me.Invoke(d, New Object() {s})
    Else
        lblStatus.Text = s
    End If
End Sub

' ... followed by other implements dpfp eventhandlers not in use....
' .... 
```

结束类

# vim - Vim：如何使用 unix 命令输出作为文件名保存到？

> ID：12411913
> 
> 赞同：0
> 
> 时间：2012-09-13T17:45:49.763
> 
> 标签：vim, command

我想在保存时使用 unix 命令。命令返回文件路径。如下所示：

```
pseudo code
:w !command

# I name this command 'mami'
$ MAMI_DIR=~/work echo $MAMI_DIR/$(date "+%Y-%m-%d-%H-%M-%S").txt
#=> /Users/sane/work/2012-09-13-01-58-01.txt 
```

[https://gist.github.com/3713132](https://gist.github.com/3713132)

```
# my expectation
:w !mami
#=> to save /Users/sane/work/2012-09-13-01-58-01.txt
# or
:mami
#=> to save /Users/sane/work/2012-09-13-01-58-01.txt 
```

但我的 exec 只返回字符串或错误：

```
:w !mami
#=> This show only file path, /Users/sane/work/2012-09-13-01-58-01.txt and said "press key"
:w !$(MAMI_DIR=~/work echo $MAMI_DIR/$(date "+%Y-%m-%d-%H-%M-%S").txt)
#=> This return value 127 
```

我如何实现这一目标？这是 vim 脚本的领域吗？请给我建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:54:34.213

你可以做

```
:w `mami` 
```

达到你想要的。您实际上在做的是将输出管道传输到`mami`命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:49:58.947

做`mami`吧：

```
MAMI_DIR=~/work cat >$MAMI_DIR/$(date "+%Y-%m-%d-%H-%M-%S").txt 
```

接着`w !mami`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:52:54.637

你可以用反引号来做到这一点：

```
:w `mami` 
```

# mysql - 如何设置列值等于另一个表中的值？

> ID：12411917
> 
> 赞同：1
> 
> 时间：2012-09-13T17:46:03.690
> 
> 标签：mysql, database, sql-update

我试图弄清楚如何更新一个表中的一行，将列值设置为另一个表中的值。这是一个例子：

```
movies:

movie_id | movie_price

movies_attended:

attended_id | attended_movie_id | attended_movie_price 
```

现在，这是一个愚蠢的例子，但假设由于某种原因，movies_attended 中有一行没有正确的attended_movies_price，因此需要更新。

应该如何编写查询来更新movies_attended 表，设置movies_attended.attended_movie_price = movies.movi​​e_price？

我尝试了类似以下的方法，但没有奏效：

```
update movies_attended, movies 
set movies_attended.attended_movie_price = movies.movie_price 
where movies_attended.attended_movie_id = movies.movie_id 
AND attended_id = [the id of the row we want to update] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:01:19.590

当您说“它不起作用”时，您的意思是它报告了 0 行更新，还是该语句导致数据库引发异常？

您的示例语句似乎是以下形式：

```
UPDATE movies_attended a
  JOIN movies m
    ON a.attended_movie_id = m.movie_id
   SET a.attended_movie_price = m.movie_price
 WHERE a.attended_id = ? 
```

（我们通常更喜欢`JOIN ... ON ...`样式语法，而不是逗号连接运算符和 WHERE 子句中的连接谓词。）

我无法解释为什么该声明“不起作用”。

如果没有行满足谓词，这可能会报告 0 行受影响。如果要更改的行不需要任何更改，它还将报告 0 行受影响......也就是说，现有值`attended_movie_price`已经与分配给它的值匹配。

通常，在运行这样的更新语句之前，我先将其编写为 SELECT，然后查看返回的值......

通过用 替换`UPDATE`关键字`SELECT ... FROM`并删除`SET`子句：

```
SELECT m.movie_price          AS new_val
     , a.attended_movie_price AS old_val
     , a.attended_id
  FROM UPDATE movies_attended a
  JOIN movies m
    ON a.attended_movie_id = m.movie_id
 WHERE a.attended_id = ? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:54:44.603

这实际上是一个糟糕的数据库设计。您不需要两张表中的电影价格。

但是，如果你只需要这个，它会这样：

```
UPDATE movies_attended
INNER JOIN
movies
ON movies_attended.attended_movie_id = movies.movie_id
SET movies_attended.attended_movie_price = movie.movie_price 
```

# java - 线程“main”中的异常 java.lang.NullPointerException 无法写入类

> ID：12411920
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:46:15.937
> 
> 标签：java, nullpointerexception, bufferedwriter

**所以我有这个代码：**

```
package Firstpack;

import java.io.*;
import java.util.*;

public class Main {

    public static void menu() {
        System.out.println("Welcome");
        System.out.println("1\. Add a record ");
        System.out.println("2\. See all records ");
        System.out.println("3\. See a category");
        System.out.println("4\. Total spend(Year)");
        System.out.println("5\. Spend in a month");
        System.out.println("6\. Chose by index");
        System.out.println("7\. Exit ");

        System.out.print(">");
        Scanner in = new Scanner(System.in);
        int enteredInt = in.nextInt();
        in.close();

        switch (enteredInt) {
        case 1:
            recording();
            break;
        case 2:
            System.out.print(" You have chosen -> See all records");
            break;
        case 3:
            System.out.print(" You have chosen -> See a category");
            break;
        case 4:
            System.out.print(" You have chosen -> Total spend(Year)");
            break;
        case 5:
            System.out.print(" You have chosen -> Spend in a month");
            break;
        case 6:
            System.out.print(" You have chosen -> Chose by index");
            break;
        case 7:
            System.out.print(" Bye! ");
            break;
        default:
            menu();
        }

    }

    public static void recording() {
        System.out.println(" You have chosen -> Add a record");

        record rec = new record();
        Scanner in = new Scanner(System.in);

        System.out.print("Enter Amount > ");
        rec.amount = in.nextDouble();
        System.out.print("Enter Category > ");
        rec.category = in.next();
        System.out.print("Enter Details > ");
        rec.details = in.next();

        try {
            FileWriter fw = new FileWriter("findme.txt");
            BufferedWriter bw = new BufferedWriter(fw);

            bw.write(String.valueOf(rec.amount));
            bw.write(rec.category);
            bw.write(rec.details);

            bw.close();
            fw.close();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public static void main(String[] args) {
        menu();
    }
} 
```

它向我抛出了这个：

```
Exception in thread "main" java.lang.NullPointerException
    at java.io.Writer.write(Unknown Source)
    at Firstpack.Main.recording(Main.java:68)
    at Firstpack.Main.menu(Main.java:25)
    at Firstpack.Main.main(Main.java:82) 
```

我不知道如何解决这个问题。这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:22:57.043

问题是由于`in.close()`在您的菜单方法中调用。不仅`in.close()`关闭`Scanner`对象，而且它也恰好关闭`System.in`。当您输入 1 作为菜单选择时，您的`recording()`方法会被调用，该方法会创建一个`Scanner`尝试使用 now closed的新方法`System.in`。

这是一篇解决类似问题的帖子： [尝试编写一个方法来检查 JAVA 中的用户输入，获取 NoSuchElementException](https://stackoverflow.com/questions/12410173/trying-to-write-a-method-that-checks-user-input-in-java-getting-nosuchelementex)

# rest - 使用 Fiddler2 发布到 ASP.NET WebAPI

> ID：12411921
> 
> 赞同：0
> 
> 时间：2012-09-13T17:46:17.783
> 
> 标签：rest, post, asp.net-web-api, fiddler

我有一个类可以完全模拟我在数据库中的实体。我有一个存储过程，它接收新行的参数并返回表中的所有设置，这些设置又填充我的存储库。我可以在内存中的设置类型列表中看到 GET、PUT 和 DELETE 的结果。我首先注意到，即使我关闭 Visual Studio 并重新打开并运行项目，有时，列表仍处于以前的状态。它没有从数据库中重新填充，所以我不确定为什么首先...其次，与其他 HTTP 动词不同，我似乎无法让 Fiddler 的 POST 工作。我确实看到 Fiddler 的值显示在下面的代码中，但我收到错误：无效的 URI：无法确定 URI 的格式。如果我传递一个 ID，我会得到同样的错误。

这是我放入 Fiddler 的内容：

> POST 本地主机：54852/api/settings

请求标头

```
User-Agent: Fiddler
Content-type: application/x-www-form-urlencoded
Host: localhost:54852
Content-Length: 149 
```

请求正文

> ID=0&Category=Dried%20Goods&Sub_Category=Other&UnitSize=99&UnitOfMeasureID=999&Facings=true&Quantity=true&EverydayPrice=999.99&PromotionPrice=111.11

我的 SettingsController 中的 PostSetting 功能

```
 public HttpResponseMessage PostSetting(Setting item)
    {
        item = repository.Add(item);            
        var response = new HttpResponseMessage<Setting>(item) { StatusCode = HttpStatusCode.Created };
        string uri = Url.Route("DefaultApi", new { id = item.ID });
        response.Headers.Location = new Uri(uri);
        return response;
    } 
```

我是否应该创建一个从数据库获取 MAXID 的新过程，并将其用作上面创建新 ID 的行中的新 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T12:33:52.283

[您需要使用 Fiddler（现在是Telerik](http://telerik.com)产品）创建要测试的 Setting 类或项目的 JSON 表示，并使用 Composer 选项卡。

接下来，您将要对以下 URL 执行 POST：

http://[您的基本网址]/api/settings

并传递 JSON 格式的设置类。

你可以在这里看到一个例子：[ASP.NET Web API - Scott Hanselman](http://www.asp.net/vnext/overview/videos/aspnet-web-api)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-17T18:02:25.930

这是一个简短的视频，展示了如何轻松实现它

[从提琴手获取并发布到 webapi](https://youtu.be/u5f0ZYvvRRk)

![在此处输入图像描述](../Images/c77643b32b44f3ddc75779280a110f42.png)

# c - 在c中加载位图字体

> ID：12411925
> 
> 赞同：1
> 
> 时间：2012-09-13T17:46:38.823
> 
> 标签：c, data-structures

我正在研究一些位图字体。
这里的想法是给我 2 个文件
input.txt 和字体 .txt。我必须从 input.txt 文件中读取一个字符串并使用 font.txt 对其进行转换，并将相应的输出打印到另一个文件 output.txt。font.txt 中的每个字符由 16x8 的网格表示。例如：

```
"A"=  
0x00,  
0x00,  
0x10,  
0x38,  
0x6c,  
0xc6,  
0xc6,  
0xfe,  
0xc6,  
0xc6,  
0xc6,  
0xc6,  
0x00,  
0x00,  
0x00
0x00 
```

有人可以请告诉我如何将存储在文件中的上述格式加载到数据结构中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:57:11.377

看看[这个 SO 解决方案](https://stackoverflow.com/questions/3081289/how-to-read-a-line-from-a-text-file-in-c-c)，看看如何在 c 中逐行读取。

我假设您使用 ASCII 并且您的数组大小是恒定的。您可以简单地检查`"`每行开头的 , 在这种情况下，您可以假设它是您的字母的标识符，否则您将逐行读取值到 16x8 数组中，如果有，则在末尾删除 , 。

检查`"`可以简单地通过直接比较来完成，因为它是一个 ascii 字符。

```
if (myline[0] == 34) {...}; 
```

获取字母可以通过相同的方式完成：

```
char myletter = myline[1]; 
```

您还可以`scanf`用来解析格式化的行。此外，如果您必须使用 C++ 工作，它会让您的生活更轻松，因为您可以访问更高级别的方法。

# python - ftplib：被动和 NAT/地址转换

> ID：12411928
> 
> 赞同：3
> 
> 时间：2012-09-13T17:46:49.280
> 
> 标签：python, python-2.7, ftplib

有没有办法检测服务器在进入被动模式时返回其私有网络地址，并将其转换为公共地址？
我无权访问服务器。

```
>>> # Python 2.7.3rc2
>>> from ftplib import FTP_TLS
>>> ftps = FTP_TLS()
>>> ftps.set_debuglevel(2)
>>> ftps.connect("example.com", 123)
*get* '220 Welcome to Synchrony Gateway FTP server\r\n'
*resp* '220 Welcome to Synchrony Gateway FTP server'
'220 Welcome to Synchrony Gateway FTP server'

>>> ftps.auth()
*cmd* 'AUTH TLS'
*put* 'AUTH TLS\r\n'
*get* '234 Using authentication type TLS\r\n'
*resp* '234 Using authentication type TLS'
'234 Using authentication type TLS'

>>> ftps.login("foo", "***")
*cmd* 'AUTH TLS'
*put* 'AUTH TLS\r\n'
*get* '234 AUTH command OK, waiting handshake\r\n'
*resp* '234 AUTH command OK, waiting handshake'
*cmd* 'USER foo'
*put* 'USER foo\r\n'
*get* '331 Send password please\r\n'
*resp* '331 Send password please'
*cmd* 'PASS ************'
*put* 'PASS ************\r\n'
*get* '230 User logged in, proceed\r\n'
*resp* '230 User logged in, proceed'
'230 User logged in, proceed'

>>> ftps.prot_p()
*cmd* 'PBSZ 0'
*put* 'PBSZ 0\r\n'
*get* '200 Command okay\r\n'
*resp* '200 Command okay'
*cmd* 'PROT P'
*put* 'PROT P\r\n'
*get* '200 Command okay\r\n'
*resp* '200 Command okay'
'200 Command okay'

>>> ftps.set_pasv(True)
>>> ftps.retrlines("LIST")
*cmd* 'TYPE A'
*put* 'TYPE A\r\n'
*get* '200 Type set to A\r\n'
*resp* '200 Type set to A'
*cmd* 'PASV'
*put* 'PASV\r\n'
*get* '227 Entering Passive Mode (192,168,17,1,195,119)\r\n'
*resp* '227 Entering Passive Mode (192,168,17,1,195,119)' 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-02-12T16:57:01.373

我遇到了类似的问题。这是覆盖远程主机返回的本地 ip 的快速方法：

```
from ftplib import FTP, parse227, parse229
import socket
class MyFTP(FTP):
    def makepasv(self):
        if self.af == socket.AF_INET:
            host, port = parse227(self.sendcmd('PASV'))
        else:
            host, port = parse229(self.sendcmd('EPSV'), self.sock.getpeername())
        # We tweak this so we don't use the internal ip returned by the remote server.
        # old: `return host, port`
        return self.host, port 
```

请注意，您不能使用 super()，因为 FTP 是一个“旧式”python 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:51:40.757

将服务器配置为在外部 IP 上进入被动模式。

# git - Git 子模块 vs Nuget 包

> ID：12411929
> 
> 赞同：31
> 
> 时间：2012-09-13T17:46:58.723
> 
> 标签：git, nuget, git-submodules, nuget-package

我们的团队已经为我们大多数产品共享的一些核心 CRUD 功能试验了 git 子模块。我们还成功地将 Nuget 包（现在自托管）用于一些常见的实用程序。

我们的核心功能经常发生变化，以至于保持子模块正确提交被证明是我们所期望的更多的苦差事。我正在考虑将核心功能从子模块移动到 Nuget 包，但我想知道对包的频繁更新是否会在 Nuget 中更加痛苦。

在对我们的架构和流程进行这种略微侵入性的更改之前，是否有人对我可能遇到的其他挑战有任何经验和指导？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T04:56:43.387

与任何事情一样，这取决于。您是否考虑过使用单独的 CI 包存储库，其中对核心模块的每次提交都会生成一个 CI 包？

imo 最大的挑战是包版本控制~~，因为 NuGet 还没有完全支持 SemVer（例如预发布版本 + 内部版本号）~~。

**编辑：nuget.org 现在支持 SemVer 2.0 包版本。请参阅此规范：[https ://github.com/NuGet/Home/wiki/SemVer2-support-for-nuget.org-%28server-side%29](https://github.com/NuGet/Home/wiki/SemVer2-support-for-nuget.org-%28server-side%29)**

正确使用 SemVer。你通常不知道发布的版本号，所以你的 CI 包版本从最新的稳定版本继续。这样的 CI 包将被视为预发布。

例如：（`2.2.0-CI201209140650`这是 2012 年 9 月 14 日 06:50 为即将发布的 2.2.0 版本拍摄的 CI 版本）<-- 注意：此版本仍然可以更改，但总会有更新路径。

如果采用 SemVer v2.0.0，甚至可以采用下面的例子：`2.2.0-CI.2012.09.14.06.50`.

**重要提示：** nuget.org（以及任何其他 NuGet 服务器/服务，例如 MyGet 或 VSTS）不支持*仅通过构建元数据不同的*多个包版本！

使用这些约束（以及一些适当的 TeamCity 构建配置），这对我有用。简而言之，这些都是麻烦：

*   正确的**版本控制**
*   提醒选择正确的**包源**（将您的 CI pkgs 与预发行版和发行版分开，尽管从技术上讲，您的 CI 包被版本化为预发行版）
*   **如果预发布标签的字符串排序高于“CI”（例如“Alpha”）**，则从 CI pkg 升级到预发布可能会成为问题。**在这种情况下：卸载包“CI”，然后是安装包“Alpha”。**

 **希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2021-01-20T20:39:34.310

我更喜欢使用子模块而不是 Nuget 包来频繁更改内部库。原因如下：

*   **合并：**如果多个开发人员同时对同一个库进行更改，使用子模块，这些更改可以合并。对于 Nuget 包，显然没有合并的概念。

*   **更少的等待**：使用子模块，您推送，然后使用您需要使用子模块的任何 repo 拉取。通常需要几秒钟。使用 Nuget，您必须等待发布包，通常是在 CI 流程完成之后。

*   **版本冲突**：同样，如果多个开发人员同时进行更改，他们可能会将 Nuget 版本 # 增加到相同的版本，尽管他们的更改不同。要解决多少痛苦取决于您的 CI 流程。

*   **可以在“客户端”存储库中进行更改**：有时在处理将使用该库的客户端代码时，最容易充实库更改的细节。使用子模块，这是可能的。当然，这不能代替测试覆盖率。**

# tfs - 无法从 TFS 中删除工作区

> ID：12411932
> 
> 赞同：10
> 
> 时间：2012-09-13T17:47:01.550
> 
> 标签：tfs

我想将我的项目从 Visual Studio 2012 添加到我的 TFS 服务器，但它说路径已经映射到工作区 pc;administrator （这是一个*本地工作区*）。

我试过命令工具`tf`，但它说没有工作区，所以我不能删除有冲突的工作区。

我正在使用 Visual Studio 2012 运行 Windows 8。TFS 位于 Windows Server 2012 上。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T18:56:43.093

问题是当前项目位置（物理机上的文件夹）映射到不同的 TFS 服务器。要将其添加到源代码管理，您需要将其移动到与 TFS 服务器无关的物理位置。

**编辑** 要删除有问题的工作区：

1) 使用“团队”菜单连接到您不想映射到的 TFS 服务器

2) 使用 ctrl+q --> workspaces 访问工作区菜单

3）删除工作区

4) 再次使用“团队”菜单更改您想要映射到的 TFS 服务器

5) ctrl+q --> 工作区

6) 添加新工作区

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-05T22:31:42.003

尝试这些步骤中的任何一个。其中一些可能不适用于您。

清除“缓存的工作空间”并删除工作空间映射。

1.  在控制面板 > 用户 > 凭据管理器上删除指向 TFS 的 Windows 帐户和通用帐户。
    [加载 Visual Studio 时，如何更改用于连接到 Visual Studio Online (TFSPreview) 的默认凭据？](https://stackoverflow.com/questions/12407668/how-can-i-change-the-default-credentials-used-to-connect-to-tfspreview-when-load)

2.  在 IE 上，删除缓存的密码。
    [http://www.jayway.com/2012/12/17/changeing-tfs-credentials-in-visual-studio-2012/](http://www.jayway.com/2012/12/17/changing-tfs-credentials-in-visual-studio-2012/)

3.  删除存储的用户名/密码：http:
    [//blogs.msdn.com/b/visualstudioalm/archive/2012/08/29/clearing-the-credentials-for-connecting-to-a-team-foundation-server.aspx](http://blogs.msdn.com/b/visualstudioalm/archive/2012/08/29/clearing-the-credentials-for-connecting-to-a-team-foundation-server.aspx)

    > rundll32.exe keymgr.dll,KRShowKeyMgr

4.  删除工作区。在 VS2012 命令行上，运行以下命令：

    > tf.exe 工作区/删除工作区名称；所有者/服务器：服务器地址
    > [http://mycomputeradventures.blogspot.com/2012/01/removing-tfs-workspaces-from-old-users.html](http://mycomputeradventures.blogspot.com/2012/01/removing-tfs-workspaces-from-old-users.html)

5.  清除缓存的工作空间映射。在 VS2012 命令行上，运行以下命令：

    > tf.exe 工作区 /remove:* （或 /s:http//oldserver:8080）
    > [http://blogs.msdn.com/b/buckh/archive/2006/09/12/path-is-already-mapped-在工作区.aspx](http://blogs.msdn.com/b/buckh/archive/2006/09/12/path-is-already-mapped-in-workspace.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-08T08:36:25.223

如果你使用 Visual Studio 2012 去

`C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\4.0\Cache`

或者如果是 Visual Studio 2013 去

```
C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\5.0\Cache 
```

删除它下面的所有东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-04T15:54:17.700

最简单的方法是转到您的 AppData 并删除 TFS 缓存（取决于版本 3.0 或 4.0）

C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\3.0\Cache 或 C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\4.0\Cache

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-06-25T15:41:44.883

1.  首先，我们将从 VS 2015 Developer 命令提示符中检查工作区列表，

    Ex - tf 工作区/所有者：*

2.  现在我们将从 VS 2017 Developer 命令提示符获取 xml 格式，该命令提示符将具有特定工作区的“所有者 ID”，

    示例 1 - tf.exe 工作区 /owner:* /computer:ComputerName /collection: [https://YOUR-TFS-URL.visualstudio.com](https://YOUR-TFS-URL.visualstudio.com) /format:xml

3.  我们现在可以删除特定用户的工作区，

    示例 1- Tf 工作区 /delete ComputerName;email@email.com /server:" [https://URL.visualstudio.com](https://URL.visualstudio.com) "

    或者

    示例 2 - Tf 工作区 /delete ComputerName;1e178c77-bb8b-6f05-bf99
    /server: [https://URL.visualstudio.com](https://URL.visualstudio.com)

    （其中 1e178c77-bb8b-6f05-bf99 是您从步骤 2 XML 格式获得的工作空间的 ID）

4.  我们将再次检查 VS 2015 Developer 命令提示符中的工作区列表，

    Ex - tf 工作区/所有者：*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-12T09:57:59.253

好吧，我找不到麻烦的工作区，这促使我将本地代码文件夹复制到另一个名称，然后我创建了一个映射该文件夹的新工作区。

接下来，我使用 Add Source Control 通过 VS 2012 将新解决方案添加到 TFS。

# xml - linq to xml 根据子值选择父属性

> ID：12411934
> 
> 赞同：1
> 
> 时间：2012-09-13T17:47:08.603
> 
> 标签：xml, linq

我正在尝试根据 SdkMessageProcessingStepImageId 的值选择 SdkMessageProcessingStepId 属性，请参见下面的 xml，但我很挣扎。

```
<SdkMessageProcessingStep Name="Plugins.OnPreCreateUpdateCar: Update of new_car" SdkMessageProcessingStepId="{00c19595-76fd-e111-9528-005056af005a}">
  <PluginTypeName>Plugins.OnPreCreateUpdateCar, Plugins, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f59c17e3653dba0</PluginTypeName>
  <PrimaryEntity>new_car</PrimaryEntity>
  <AsyncAutoDelete>0</AsyncAutoDelete>
  <InvocationSource>1</InvocationSource>
  <Mode>0</Mode>
  <Rank>1</Rank>
  <SdkMessageId>{20bebb1b-ea3e-db11-86a7-000a3a5473e8}</SdkMessageId>
  <EventHandlerTypeCode>4602</EventHandlerTypeCode>
  <Stage>20</Stage>
  <IsCustomizable>1</IsCustomizable>
  <IsHidden>0</IsHidden>
  <SupportedDeployment>0</SupportedDeployment>
  <SdkMessageProcessingStepImages>
    <SdkMessageProcessingStepImage Name="PreImageCar">
      <SdkMessageProcessingStepImageId>{e3c5bcb1-76fd-e111-9528-005056af005a}</SdkMessageProcessingStepImageId>
      <EntityAlias>PreImageCar</EntityAlias>
      <ImageType>0</ImageType>
      <MessagePropertyName>Target</MessagePropertyName>
      <IsCustomizable>1</IsCustomizable>
    </SdkMessageProcessingStepImage>
  </SdkMessageProcessingStepImages>
</SdkMessageProcessingStep> 
```

我尝试了各种方法，例如两个查询、连接，但似乎没有任何效果。最后我选择了一个完全不同的解决方案，但是知道如何在一个查询中执行此操作会很方便。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:27:55.597

我不确定你想要达到什么目的。但也许这会有所帮助：

```
 XElement xmlTree = XElement.Load(source);

 string[] result = xmlTree.Descendants("SdkMessageProcessingStepImageId")
                .Where(element => element.Value == "{e3c5bcb1-76fd-e111-9528-005056af005a}")
                .Select(element => element.Parent.Parent.Parent)
                .Attributes()
                .Where(attribute => attribute.Name == "SdkMessageProcessingStepId")
                .Select(attribute => attribute.Value)
                .ToArray(); 
```

结果：

```
{00c19595-76fd-e111-9528-005056af005a} 
```

# c - pred 和 pwrite 没有定义？

> ID：12411942
> 
> 赞同：5
> 
> 时间：2012-09-13T17:47:30.233
> 
> 标签：c, linux, atomic, glibc, unistd.h

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T17:50:28.927

You need to define `_XOPEN_SOURCE 500` ***before*** your includes:

```
#define _XOPEN_SOURCE 500

#include<unistd.h> 
```

Otherwise, the `unistd.h` header won't see the macro definition.

# jquery - 在 img submit 上提交之前验证至少一个复选框

> ID：12411945
> 
> 赞同：1
> 
> 时间：2012-09-13T17:47:40.573
> 
> 标签：jquery

如何使用 2 个警报验证以下代码？

第一项检查是至少选择了 1 个复选框 - 如果没有，请提醒消息“请选择至少 1 个复选框！”。第二个应该提醒“你确定要删除吗？” 并提交：

脚本：

```
<script type="text/javascript">
 $(document).ready(function() {

$("#delete").click(function() 
{   
    if (confirm('Are you sure you want to delete?')) {
                $('#form_test').submit();
    }
});

 });
</script> 
```

HTML：

```
<a id="delete" href="#">Delete Images</a>

<form id="form_test" method='post' action=''>
    <input type="checkbox" name="remove[]" />
     <input type="checkbox" name="remove[]" />
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:49:58.850

```
$("#delete").click(function() {   
 var exists = $('input[type=checkbox][name^=remove]:checked').length;
    if( !exists ) {
         alert('Please select at least 1 checkbox!');
    } else if(confirm('Are you sure you want to delete?')) {
         $('#form_test').submit();
    }
}); 
```

***[演示](http://jsfiddle.net/Dpwct/1/)***

* * *

## 笔记

新版本的 jQuery 已弃用`:checkbox`选择器。***[不推荐使用的项目列表](http://api.jquery.com/category/deprecated/)***。

### 回复***[@Blender的评论](https://stackoverflow.com/questions/12411945/validate-at-least-one-checkbox-before-submit-on-img-submit/12411969#comment16682124_12411969)***

从关于我***[的 jQuery 文档中`:checkbox`](http://api.jquery.com/checkbox-selector/)***我发现了这个：

> $(':checkbox') 等价于 $('[type=checkbox]')。与其他伪类选择器（以“：”开头的选择器）一样。
> 
> 建议在它前面加上标签名称或其他选择器；否则，将隐含通用选择器 ("*")。
> 
> 换句话说，裸 $(':checkbox') 等价于 $('*:checkbox')，所以应该使用 $('input:checkbox') 来代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:56:07.620

你可以试试这个：

```
$("#delete").click(function() {   
 var exists = $('input[type=checkbox]:checked').length;
     if( !exists ) {
         alert('Please Select any checkbox');
    } else {
      if (confirm('Are you sure you want to delete?')) {
         $('#form_test').submit();
       }
    }
});​ 
```

[这是工作小提琴](http://jsfiddle.net/Dpwct/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:50:40.390

你可以使用`length`属性。

```
$("#delete").click(function() {
    if (!$('input[type=checkbox]:checked').length) {
        alert('Please select at least 1 checkbox!')
    }   
    else if (confirm('Are you sure you want to delete?')) {
        $('#form').submit();
    }
}); 
```

# java - ODFToolkit - 重新计算所有公式

> ID：12411955
> 
> 赞同：0
> 
> 时间：2012-09-13T17:48:42.980
> 
> 标签：java, cell, odf, odftoolkit

我有两个文件：

*   `1.ods`在`C:\`
*   `2.ods`在`Z:\`

在我输入的`1.ods`单元格中，保存，关闭。`A1``10`

在`2.ods`- 单元格中`A1`，我输入了公式：`='file:///Z:/1.ods'#$Sheet1.A1`，保存，关闭。

现在我想在单元格中的值更改时（当然在保存之后）使用 API 以编程方式重新计算单元格中的`2.ods`值。`A1``odftoolkit``1.ods``A1`

有一种获取计算值的方法：`Cell#getDisplayText`但这不适用于外部依赖项。我还没有找到任何与 Open/LibreOffice 快捷方式相同的 API 方法`Ctrl+Shift+F9`。

如何仅使用`odftoolkit`API 刷新/重新计算上述值？

（这是因为我有 7000 个 ods 文件，我不想手动重新计算，然后做我需要做的事情）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:06:42.043

看起来 odftoolkit 目前没有提供执行此操作的功能。

# java - [Java]Arrays and Collections 测试，意外结果？

> ID：12411961
> 
> 赞同：3
> 
> 时间：2012-09-13T17:48:59.900
> 
> 标签：java, arrays, collections

可能有数百个关于 Java 集合与数组的问题，但这是我真的没想到的。

我正在为我的游戏开发一个服务器，为了在客户端和服务器之间进行通信，你需要发送数据包（显然），所以我做了一些测试，我可以最好地使用哪个 Collection（或数组）来处理它们，HashMap、ArrayList 和一个PacketHandler 数组。结果出乎我的意料，因为 ArrayList 获胜。

数据包处理结构就像字典的使用（PacketHandler 的索引），因为数组是字典使用的最原始形式，我认为它比 ArrayList 更容易执行。有人可以解释一下为什么会这样吗？

我的测试

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Random;

public class Main {
  /**
   * Packet handler interface.
   */
  private interface PacketHandler {
    void handle();
  }

  /**
   * A dummy packet handler.
   */
  private class DummyPacketHandler implements PacketHandler {
    @Override
    public void handle() { }
  }

  public Main() {
    Random r = new Random();
    PacketHandler[] handlers = new PacketHandler[256];
    HashMap<Integer, PacketHandler> m = new HashMap<Integer, PacketHandler>();
    ArrayList<PacketHandler> list = new ArrayList<PacketHandler>();

    // packet handler initialization
    for (int i = 0; i < 255; i++) {
      DummyPacketHandler p = new DummyPacketHandler();
      handlers[i] = p;
      m.put(new Integer(i), p);
      list.add(p);
    }

    // array
    long time = System.currentTimeMillis();
    for (int i = 0; i < 10000000; i++)
      handlers[r.nextInt(255)].handle();
    System.out.println((System.currentTimeMillis() - time));

    // hashmap
    time = System.currentTimeMillis();
    for (int i = 0; i < 10000000; i++)
      m.get(new Integer(r.nextInt(255))).handle();
    System.out.println((System.currentTimeMillis() - time));

    // arraylist
    time = System.currentTimeMillis();
    for (int i = 0; i < 10000000; i++)
      list.get(r.nextInt(255)).handle();
    System.out.println((System.currentTimeMillis() - time));
  }

  public static void main(String[] args) {
    new Main();
  }
} 
```

**我觉得问题已经解决了，谢谢大家**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:53:29.273

较短的答案是 ArrayList 第一次优化得稍微多一些，但从长远来看仍然较慢。

JVM 在完全预热之前如何以及何时优化代码并不总是显而易见的，并且可以根据您的命令行选项在版本之间进行更改。

真正有趣的是当你重复测试时你会得到什么。在这里有所不同的原因是代码是在后台分阶段编译的，因为您希望在代码已经与从一开始就立即运行的速度一样快的情况下进行测试。

* * *

您可以做一些事情来使您的基准测试更具可重复性。

*   提前生成随机数，它们不是测试的一部分，但会减慢你的速度。
*   将每个循环放在一个单独的方法中。第一个循环触发整个方法被编译为更好或更坏。
*   重复测试 5 到 10 次，*忽略第一次*。
*   使用 System.nanoTime() 而不是 currentTimeMillis() 在这里可能没有任何区别，但这是一个好习惯。
*   尽可能使用自动装箱，以便它使用整数缓存或 Integer.valueOf(n) 来做同样的事情。`new Integer(n)`将始终创建一个对象。
*   确保您的内部循环执行某些操作，否则 JIT 很可能会将其优化为无。;)

.

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Random;

public class Main {

    /**
     * Packet handler interface.
     */
    private interface PacketHandler {
        void handle();
    }

    /**
     * A dummy packet handler.
     */
    static class DummyPacketHandler implements PacketHandler {

        @Override
        public void handle() {
        }

    }

    public static void main(String[] args) {
        Random r = new Random();

        PacketHandler[] handlers = new PacketHandler[256];
        HashMap<Integer, PacketHandler> m = new HashMap<Integer, PacketHandler>();
        ArrayList<PacketHandler> list = new ArrayList<PacketHandler>();

        // packet handler initialization
        for (int i = 0; i < 256; i++) {
            DummyPacketHandler p = new DummyPacketHandler();
            handlers[i] = p;
            m.put(new Integer(i), p);
            list.add(p);
        }

        int runs = 10000000;
        int[] handlerToUse = new int[runs];
        for (int i = 0; i < runs; i++)
            handlerToUse[i] = r.nextInt(256);

        for (int i = 0; i < 5; i++) {
            testArray(handlers, runs, handlerToUse);
            testHashMap(m, runs, handlerToUse);
            testArrayList(list, runs, handlerToUse);
            System.out.println();
        }
    }

    private static void testArray(PacketHandler[] handlers, int runs, int[] handlerToUse) {
        // array
        long time = System.nanoTime();
        for (int i = 0; i < runs; i++)
            handlers[handlerToUse[i]].handle();
        System.out.print((System.nanoTime() - time)/1e6+" ");
    }

    private static void testHashMap(HashMap<Integer, PacketHandler> m, int runs, int[] handlerToUse) {
        // hashmap
        long time = System.nanoTime();
        for (int i = 0; i < runs; i++)
            m.get(handlerToUse[i]).handle();
        System.out.print((System.nanoTime() - time)/1e6+" ");
    }

    private static void testArrayList(ArrayList<PacketHandler> list, int runs, int[] handlerToUse) {
        // arraylist
        long time = System.nanoTime();
        for (int i = 0; i < runs; i++)
            list.get(handlerToUse[i]).handle();
        System.out.print((System.nanoTime() - time)/1e6+" ");
    }
} 
```

打印`array HashMap ArrayList`

```
24.62537 263.185092 24.19565 
28.997305 206.956117 23.437585 
19.422327 224.894738 21.191718 
14.154433 194.014725 16.927638 
13.897081 163.383876 16.678818 
```

代码热身后，数组会稍微快一些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:54:16.240

您的基准测试至少存在一些问题：

*   您直接在 main 中运行测试，这意味着当您编译 main 方法时，JIT 编译器还没有时间优化所有代码，因为它还没有运行它
*   map 方法每次都会创建一个新的整数，这是不公平的：使用`m.get(r.nextInt(255)).handle();`允许使用 Integer 缓存
*   您需要多次运行测试才能得出结论
*   您没有使用您在循环中执行的操作的结果，因此允许 JIT 简单地忽略它们
*   监控 GC，因为它可能总是同时运行并偏向一个循环的结果，并`System.gc()`在每个循环之间添加一个调用。

但在做所有这些之前，请阅读[这篇文章](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java);-)

稍微调整一下代码后，我得到了以下结果：

```
Array: 116
Map: 139
List: 117 
```

因此数组和列表在编译后几乎相同，而 map 稍微慢一些。

代码：

公共类主要{

```
/**
 * Packet handler interface.
 */
private interface PacketHandler {

    int handle();
}

/**
 * A dummy packet handler.
 */
private class DummyPacketHandler implements PacketHandler {

    @Override
    public int handle() {
        return 123;
    }
}

public Main() {
    Random r = new Random();

    PacketHandler[] handlers = new PacketHandler[256];
    HashMap<Integer, PacketHandler> m = new HashMap<Integer, PacketHandler>();
    ArrayList<PacketHandler> list = new ArrayList<PacketHandler>();

    // packet handler initialization
    for (int i = 0; i < 255; i++) {
        DummyPacketHandler p = new DummyPacketHandler();
        handlers[i] = p;
        m.put(new Integer(i), p);
        list.add(p);
    }

    long sum = 0;
    runArray(handlers, r, 20000);
    runMap(m, r, 20000);
    runList(list, r, 20000);

    // array
    long time = System.nanoTime();
    sum += runArray(handlers, r, 10000000);
    System.out.println("Array: " + (System.nanoTime() - time) / 1000000);

    // hashmap
    time = System.nanoTime();
    sum += runMap(m, r, 10000000);
    System.out.println("Map: " + (System.nanoTime() - time) / 1000000);

    // arraylist
    time = System.nanoTime();
    sum += runList(list, r, 10000000);
    System.out.println("List: " + (System.nanoTime() - time) / 1000000);

    System.out.println(sum);
}

public static void main(String[] args) {
    new Main();
}

private long runArray(PacketHandler[] handlers, Random r, int loops) {
    long sum = 0;
    for (int i = 0; i < loops; i++)
        sum += handlers[r.nextInt(255)].handle();
    return sum;
}

private long runMap(HashMap<Integer, PacketHandler> m, Random r, int loops) {
    long sum = 0;
    for (int i = 0; i < loops; i++)
        sum += m.get(new Integer(r.nextInt(255))).handle();
    return sum;
}

private long runList(List<PacketHandler> list, Random r, int loops) {
    long sum = 0;
    for (int i = 0; i < loops; i++)
        sum += list.get(r.nextInt(255)).handle();
    return sum;
} 
```

}

# firefox - 无法运行 Firefox 扩展

> ID：12411962
> 
> 赞同：0
> 
> 时间：2012-09-13T17:49:06.270
> 
> 标签：firefox, firefox-addon

我是 Firefox 扩展开发的新手，友好地说这是第一天，为了开始 Firefox 扩展开发，我遵循了以下文章：[如何开发 Firefox 扩展](https://blog.mozilla.org/addons/2009/01/28/how-to-develop-a-firefox-extension/)。

如果我从上面给出的链接教程下载示例并尝试安装，它会完美安装，但是当我更新该示例时（只需将其名称更新为新的扩展名，在所有文件中都是必需的），然后安装，我收到以下消息：“无法安装 X，因为它与 Firefox 15.0.1 不兼容。” （其中 X 是我的扩展名）。

奇怪的行为相同的代码一个安装正常，另一个给出错误。

知道哪里出了问题，是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T07:07:47.240

问题是您忘记调整兼容性范围，`install.rdf`所以`em:maxVersion`仍然在说`3.1b2`（意思是 Firefox 3.1b2 - 一个相当旧的版本）。`15.*`如果您想支持当前稳定的 Firefox 版本或者`16.*`如果您想支持当前的 beta 版本，您应该将其更改为。您还可以更改`em:minVersion`为更有意义的内容：我怀疑您是否会验证您的扩展是否仍然适用于 Firefox 2.0。

至于为什么不更改扩展 ID 会安装扩展，这就更复杂了。首先，兼容性范围有一个软覆盖机制，允许扩展作者更改兼容版本范围而无需发布新版本。[在这种特殊情况下，Firefox 将通过请求此地址](https://versioncheck.addons.mozilla.org/update/VersionCheck.php?reqVersion=2&id=linktargetfinder@robertnyman.com&version=1.0&maxAppVersion=3.1b2&status=userEnabled&appID=%7Bec8030f7-c20a-464f-9b0e-13a3a9e97384%7D&appVersion=15.0.1&appOS=WINNT&appABI=x86-msvc&locale=en-US&currentAppVersion=15.0.1&updateType=97&compatMode=normal)或类似地址来检查扩展更新。更新服务器告诉它 1.0 版仍然是最新的，但会调整`maxVersion`到 Firefox 8.0 - 这个值将覆盖`install.rdf`.

但这不是故事的结局。[Firefox 10 中](https://wiki.mozilla.org/Features/Add-ons/Add-ons_Default_to_Compatible)的兼容性检查机制发生了显着变化，现在默认假设是该插件与较新版本兼容，即使在任何地方都没有明确指定。要求是扩展不[选择退出宽松的兼容性检查](https://developer.mozilla.org/en-US/docs/Install_Manifests#strictCompatibility)，不包含二进制组件并且至少与 Firefox 4 兼容。由于软覆盖，原始扩展与 Firefox 8 兼容，具有不同的扩展 ID但是它只与 Firefox 3.1b2 兼容（它不托管在[addons.mozilla.org](https://addons.mozilla.org/)上，因此更新服务器不知道它），这意味着宽松的兼容性检查不适用于它。

*供参考*：上一段中描述的行为由`extensions.strictCompatibility`,`extensions.minCompatibleAppVersion`和`extensions.minCompatiblePlatformVersion`首选项控制。

# php - Magento - 隐藏在类别页面上使用占位符的产品

> ID：12411965
> 
> 赞同：1
> 
> 时间：2012-09-13T17:49:33.470
> 
> 标签：php, magento

我添加了以下代码，它似乎使用占位符“隐藏”了产品。我怎样才能使它完全跳过该产品。

原因是在 50 个网格上。主页上只有 3 个有图像。然后只有 3 会显示并让用户转到下一页查看更多内容。

```
 <?php foreach ($_productCollection as $_product): ?>
    <?php $small_image = $this->helper('catalog/image')->init($_product, 'small_image'); ?>
        <?php if(!strpos($small_image,'placeholder/small_image')){ ?> 
```

# c++ - C++ 中堆栈、静态和堆内存的最大内存

> ID：12411966
> 
> 赞同：1
> 
> 时间：2012-09-13T17:49:37.003
> 
> 标签：c++, memory, heap-memory, stack-memory

我正在尝试在 C++ 中找到可以在堆栈、全局和堆内存上分配的最大内存。我在具有 32 GB 内存的 Linux 系统和具有 2 GB RAM 的 Mac 上尝试这个程序。

```
/* test to determine the maximum memory that could be allocated for static, heap and stack memory  */

#include <iostream>
using namespace std;

//static/global
long double a[200000000];

int main()
{
//stack
long double b[999999999];

//heap
long double *c = new long double[3999999999];
cout << "Sizeof(long double) = " << sizeof(long double) << " bytes\n";
cout << "Allocated Global (Static) size of a = " << (double)((sizeof(a))/(double)(1024*1024*1024)) << " Gbytes \n";
cout << "Allocated Stack size of b = " << (double)((sizeof(b))/(double)(1024*1024*1024)) << " Gbytes \n";
cout << "Allocated Heap Size of c = " << (double)((3999999999 * sizeof(long double))/(double)(1024*1024*1024)) << " Gbytes \n";

delete[] c;

return 0;

} 
```

结果（两者）：

```
Sizeof(long double) = 16 bytes
Allocated Global (Static) size of a = 2.98023 Gbytes 
Allocated Stack size of b = 14.9012 Gbytes 
Allocated Heap Size of c = 59.6046 Gbytes 
```

我正在使用 GCC 4.2.1。我的问题是：

为什么我的程序正在运行？我预计由于堆栈耗尽（Linux 中为 16 MB，Mac 中为 8 MB），程序应该会抛出一个错误。我看到了这个主题中提出的许多问题中的一些，但我无法从那里给出的答案中解决我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:59:45.627

Linux overcommits，这意味着它可以允许进程比系统上可用的内存更多，但直到该内存被进程实际使用时，才会为进程分配实际内存（物理主内存或磁盘上的交换空间） . 我的猜测是 Mac OS X 以类似的方式工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:14:24.553

在某些系统上，您可以分配适合地址空间的任意数量的内存。当您开始实际使用该内存时，问题就开始了。

发生的情况是操作系统为进程保留了一个虚拟地址范围，没有将其映射到任何物理地址，甚至没有检查是否有足够的物理内存（包括交换）来支持该地址范围。当进程尝试访问新分配的页面时，映射仅以逐页方式发生。这称为*内存过度使用*。

尝试访问`sysconf(_SC_PAGESIZE)`巨大数组的每个字节，看看会发生什么。

# android - 如何设置 textview 以显示多于 1 行的数据库值？

> ID：12411967
> 
> 赞同：1
> 
> 时间：2012-09-13T17:49:39.727
> 
> 标签：android, database, textview

我有一个多行的编辑文本（保存超过 1 行文本）确实我想在 textview 中显示插入到我的数据库中的它的值。PS：我知道是这样的：

```
 android.R.layout.simple_list_item_1, list); 
```

但据我所知，它只显示一行或类似的东西，我对 android 编程有点陌生，所以如果你能简化你的答案，我会更好地理解。而且我不知道它是否也可以在文本视图中显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:54:09.537

我希望它有效，试试看

```
 <TextView
    android:id="@+id/txtview"
    android:layout_height="fill_parent"
    android:layout_width="wrap_content"
    android:maxLines="4"
    android:lines="4" /> 
```

# ios - 在 iOS 6 中启用自动布局，同时保持向后兼容 iOS 5

> ID：12411980
> 
> 赞同：153
> 
> 时间：2012-09-13T17:50:56.270
> 
> 标签：ios, ios5, backwards-compatibility, ios6, autolayout

什么是利用 iOS 6 新的自动布局功能的最佳方式，同时仍然提供与早期版本 iOS 上的旧设备的兼容性？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-09-21T20:20:20.677

可以在每个 .storyboard 或 .xib 文件上启用或禁用自动布局。只需选择特定文件并使用 Xcode 中的文件检查器修改“使用自动布局”属性：

![文件检查器中的自动布局属性](../Images/fb196877194efd905c8217cdc30c57fa.png)

使用启用自动布局的接口文件并将部署目标设置为 6.0 之前的 iOS 版本会导致编译错误，例如：

> MainStoryboard.storyboard:3 中的错误：6.0 之前的 iOS 版本上的自动布局

在项目中使用自动布局并仍然保持与 iOS4-5 的兼容性的选项之一是创建两个[目标](https://developer.apple.com/library/ios/#featuredarticles/XcodeConcepts/Concept-Targets.html)：一个用于部署目标 iOS 6.0，一个用于早期 iOS 版本，例如：

![在此处输入图像描述](../Images/625879bc41245e4d4ed0b573743460c6.png)

您也可以为每个故事板和 XIB 文件创建两个版本，并使用 6.0 目标启用的自动布局，另一个使用旧目标，例如：

![在此处输入图像描述](../Images/188f6e0b120f9268e84ad6a13914fd2f.png)

然后将 MainStoryBoardAutoSize 添加到 iOS6 目标的 Build 阶段，将另一个文件添加到 iOS4 目标。[您可以在此处](http://hariniachala.blogspot.hu/2012/01/creating-multiple-targets-in-ios.html)了解有关使用多个目标的更多信息。

> 编辑：正如[marchinram 的回答](https://stackoverflow.com/a/12592651/131183)所指出的，如果您从代码中加载情节提要文件并且不使用 Xcode 中的“主情节提要”设置来设置初始情节提要，则可以使用单个目标。

对我来说，维护多个目标和接口文件所增加的复杂性的成本似乎超过了使用自动布局的好处。除了一些特殊情况，如果需要 iOS4-5 兼容性，您可能最好使用普通的旧自动调整大小（或代码中的 layoutSubViews）。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-09-25T23:40:32.880

你真的需要两个目标吗？我让它像这样工作，我有 2 个故事板，就像 Imre Kelényi 说的，一个启用了自动布局，另一个没有，然后在应用程序委托中，我只需检查他们使用的版本并选择正确的故事板：

```
#import "AppDelegate.h"

#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v) ([[[UIDevice currentDevice] systemVersion] compare:(v) options:NSNumericSearch] != NSOrderedAscending)

@interface AppDelegate ()
    @property (strong, nonatomic) UIViewController *initialViewController;
@end

@implementation AppDelegate

@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    UIStoryboard *mainStoryboard = nil;
    if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"6.0")) {
        mainStoryboard = [UIStoryboard storyboardWithName:@"iPhone_iOS6" bundle:nil];
    } else {
        mainStoryboard = [UIStoryboard storyboardWithName:@"iPhone_iOS5" bundle:nil];
    }

    self.initialViewController = [mainStoryboard instantiateInitialViewController];
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.window.rootViewController = self.initialViewController;
    [self.window makeKeyAndVisible];

    return YES;
}

@end 
```

有 2 个目标也可以，但对我来说似乎有点矫枉过正

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-04T18:04:48.973

如果布局差异不大，使用[Springs 和 Struts](https://stackoverflow.com/questions/12526019/update-storyboard-to-ios-6-with-back-compatibility)来定位元素会容易很多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-17T12:03:19.460

受@marchinram 的一个目标想法的启发，这是我最终想出的解决方案。两个故事板，一个用于支柱和弹簧，一个用于自动布局。在目标摘要中，我将自动布局故事板设置为默认值。然后，在 appDelegate 中，我检查是否需要加载 6.0 之前的 struts-and-springs 故事板：

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    Class cls = NSClassFromString (@"NSLayoutConstraint");
    if (cls == nil) {
        NSString *mainStoryboardName = nil;
        if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
            mainStoryboardName = @"MainStoryboard_iPad_StrutsAndSprings";
        } else {
            mainStoryboardName = @"MainStoryboard_iPhone_StrutsAndSprings";
        }
        UIStoryboard *mainStoryboard = [UIStoryboard storyboardWithName:mainStoryboardName bundle:nil];

        UIViewController *initialViewController = [mainStoryboard instantiateInitialViewController];
        self.window.rootViewController = initialViewController;
        [self.window makeKeyAndVisible];
    } 
```

另外，我将 struts-and-springs 故事板的部署目标设置为 iOS 5.1，将自动布局故事板的部署目标设置为 Project SDK(iOS 6.0)。

我真的很想在加载故事板的默认值之前在 willFinishLaunchingWithOptions 中进行切换：但这会导致“NSInvalidUnarchiveOperationException”，原因是：“无论我尝试什么，都无法实例化名为 NSLayoutConstraint 的类”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-13T03:04:37.713

尝试使用 RRAutoLayout：[https](https://github.com/RolandasRazma/RRAutoLayout) ://github.com/RolandasRazma/RRAutoLayout 这是 iOS6 AutoLayout backport 到 iOS5。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-02T09:06:54.893

我发现将 Xibs 主视图大小设置为 Freeform，然后使用 Autosizing 就可以了。无需在代码中处理视图问题。

# php - 登录后根据用户名重定向用户

> ID：12411981
> 
> 赞同：0
> 
> 时间：2012-09-13T17:51:15.390
> 
> 标签：php, wordpress, login

使用 WordPress - 我想检查谁刚刚登录，如果他们是 UsernameX，则重定向到 PageX，如果他们是管理员，则重定向到 /wp-admin/，所有其他人重定向到 home_url()；

这是我的代码：

```
function my_login_redirect($redirect_to, $request, $user){
    if(in_array('student',$user->user_login)) {
        return home_url("/students/");
    } else {
        if(in_array('administrator', $user->roles)){
            return home_url("/wp-admin/");
        } else {
            return home_url();
        }
    }
}
add_filter("login_redirect", "my_login_redirect", 10, 3); 
```

但是它似乎不起作用 - 特别是对 user_login 的检查。有没有更好的工作方式来做到这一点？

* * *

**答案/正确代码**- 感谢@soju：

```
function my_login_redirect($redirect_to, $request, $user){
    if($user->first_name == 'student')) {
        return home_url("/students/");
    } else {
        if(in_array('administrator', $user->roles)){
            return home_url("/wp-admin/");
        } else {
            return home_url();
        }
    }
}
add_filter("login_redirect", "my_login_redirect", 10, 3); 
```

这意味着使用用户的名字作为 $user 不包含用户名，但如果您愿意，您可以使用 $user 返回的 ID 来获取它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:59:29.613

这一行：

```
if(in_array('student',$user->user_login)) { 
```

不正确，`$user->user_login`不存在且不是数组。

编辑：[http ://codex.wordpress.org/Class_Reference/WP_User](http://codex.wordpress.org/Class_Reference/WP_User)

# ruby-on-rails - HABTM 查询，返回没有关联的记录

> ID：12411983
> 
> 赞同：2
> 
> 时间：2012-09-13T17:51:23.273
> 
> 标签：ruby-on-rails

我在两个表点和标签之间有 HABTM 关系。我可以使用以下查询找到具有给定标签集的所有点：

```
ids = [2, 3, 4, 8]
s = Spot.all(:include => 'tags', :conditions => ["tags.id in (?)", ids]) 
```

我如何找到所有没有标签的景点？我知道我可能需要对标签进行计数，但我不知道该怎么做。就像是：

```
s = Spot.all(:include => 'tags', :conditions => "tags.count = 0") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T18:28:27.430

您将需要一个左连接并找到那些`spots_tags.spot_id`为 NULL 的：

```
s = Spot.joins('LEFT JOIN spots_tags ON spots.id = spots_tags.spot_id').
         where('spots_tags.spot_id IS NULL').all 
```

您也可以使用 group by 和 count 来执行此操作，但是该查询的构建和理解会稍微复杂一些。

# python - Python 比较列表和字典值

> ID：12411987
> 
> 赞同：1
> 
> 时间：2012-09-13T17:51:34.497
> 
> 标签：python, list, python-2.7

**更新以试图更清楚**

我有三个字典列表，我想根据一个值将它们合并为一个。

列表看起来像这样。他们可以拥有多少个字典。

```
unplanned = [{'service__name': u'Email', 'service_sum': 4}, {'service__name': u'Peoplesoft', 'service_sum': 2}]
planned = [{'service__name': u'Email', 'service_sum': 2}, {'service__name': u'Gopher', 'service_sum': 2}, {'service__name': u'Peoplesoft', 'service_sum': 4}]
emerg = [{'service__name': u'Internet', 'service_sum': 1}] 
```

我想获取 3 个列表并创建一个新列表，其中包含所有 3 个列表中的名称和按设定顺序排列的值或 0。所以我在想这样的事情。

```
[(Email, (4, 2, 0)), (Peoplesoft, (2, 4, 0)), Gopher, (0, 2, 0)), Internet, (0, 0, 1))] 
```

我想我应该创建一个 service__name 的列表来与每个列表进行比较，所以我这样做了，但我不确定如何将 3 个列表与这个列表进行比较。我认为 izip_longest 会起作用，但不知道如何实现它。我正在使用 2.7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:58:18.687

只需使用字典，然后将其转换为列表：

```
some_list = [{'service__name': u'Email', 'service_sum': 4}, {'service__name': u'Email', 'service_sum': 1}, {'service__name': u'Network', 'service_sum': 0}]

def combine(list):
   combined = {}
   for item in list:
      if item['service__name'] not in combined:
         combined[item['service__name']] = []
      combined[item['service__name']].append(item['service_sum'])
   return combined.items()

combine(some_list)  # [(u'Email', [4, 1]), (u'Network', [0])]
combine(unplanned)
combine(emerg + planned)
..... 
```

这是使用 defaultdict 的函数版本：

```
def combine(list):
   from collections import defaultdict
   combined = defaultdict(list)
   for item in list:
      combined[item['service__name']].append(item['service_sum'])
   return combined.items() 
```

更简洁一些，但有一个不必要的导入，如果函数定义发生更改，将来可能会出现一些其他问题（请参阅注释）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:57:59.410

似乎您可以执行以下操作：

```
output = []
for dicts in zip(unplanned,planned,emerg):
    output.append(('Email',tuple(d['service_sum'] if d['service__name'] == 'Email' else 0 for d in dicts))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T06:39:48.407

试试下面的代码。你可以给变量更好的名字，因为你更了解上下文。

```
def convert(unplanned, planned, emerg):
    chain = (unplanned, planned, emerg)
    names = map(lambda lst: [d['service__name'] for d in lst], chain)
    sums = map(lambda lst: [d['service_sum'] for d in lst], chain)
    ds = [dict(zip(n, s)) for n,s in zip(names, sums)]
    unique_names = set([])
    unique_names = reduce(unique_names.union,names)
    results = []
    for n in unique_names:
        s = []
        for i in range(3):
            s.append(ds[i].get(n,0))
        results.append((n, tuple(s)))

    return results

print convert(unplanned, planned, emerg) 
```

我机器上的输出是

```
[(u'Internet', (0, 0, 1)), (u'Peoplesoft', (2, 4, 0)), (u'Email', (4, 2, 0)), (u'Gopher', (0, 2, 0))] 
```

# oracle - 为什么检查 PL/SQL 中的空关联数组失败？

> ID：12411991
> 
> 赞同：15
> 
> 时间：2012-09-13T17:51:43.610
> 
> 标签：oracle, plsql, oracle11g, associative-array

我有一个由表列的一种行类型创建的关联数组。

举个例子，它是这样的（表名不同，但结构相同）：

这是表的 DDL

```
CREATE TABLE employees
  (
     id     NUMBER,
     name   VARCHAR2(240),
     salary NUMBER
  ); 
```

这是我的程序正在执行的操作：

```
DECLARE
    TYPE table_of_emp
      IS TABLE OF employees%ROWTYPE INDEX BY BINARY_INTEGER;
    emp TABLE_OF_EMP;
BEGIN
    IF emp IS NULL THEN
      dbms_output.Put_line('Null associative array');
    ELSE
      dbms_output.Put_line('Not null');
    END IF;
END; 
```

我认为这*应该*导致打印“空关联数组”。但是，`if`条件失败，执行跳转到 else 部分。

现在，如果我输入一个`for`循环来打印集合值

```
DECLARE
    TYPE table_of_emp
      IS TABLE OF employees%ROWTYPE INDEX BY BINARY_INTEGER;
    emp TABLE_OF_EMP;
BEGIN
    IF emp IS NULL THEN
      dbms_output.Put_line('Null associative array');
    ELSE
      dbms_output.Put_line('Not null');

      FOR i IN emp.first..emp.last LOOP
          dbms_output.Put_line('Emp name: '
                               || Emp(i).name);
      END LOOP;
    END IF;
END; 
```

然后程序单元引发异常，引用 for 循环行

> ORA-06502: PL/SQL: 数字或值错误

我认为这是因为空关联数组。是否由于空关联数组而引发错误？

那么为什么第一次检查失败呢？我究竟做错了什么？

数据库服务器为 Oracle 11g EE（版本 11.2.0.3.0 64 位）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-13T19:04:21.970

*我认为这应该导致打印“空关联数组”。*这种假设对于关联数组是错误的。它们在声明时存在，但为空。这对于其他类型的 PL/SQL 集合是正确的：

> 在您初始化它之前，**嵌套表**或**可变数组**在原子上是空的；集合本身是空的，而不是它的元素。要初始化嵌套表或可变数组，请使用构造函数，即与集合类型同名的系统定义函数。此函数从传递给它的元素构造集合。
> 
> 您必须为每个可变数组和嵌套表变量显式调用构造函数。**关联数组**，第三种集合，不使用构造函数。只要允许函数调用，就允许构造函数调用。[初始化和引用集合](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/collections.htm#i20453)

比较：

```
SQL> declare
  2      type varchar2_100_aa is table of varchar2(100) index by binary_integer;
  3      test varchar2_100_aa;
  4  begin
  5      test(1) := 'Hello';
  6      dbms_output.put_line(test(1));
  7  end;
  8  /
Hello

PL/SQL procedure successfully completed.

SQL> declare
  2      type varchar2_100_va is varray(100) of varchar2(100);
  3      test varchar2_100_va;
  4  begin
  5      test(1) := 'Hello';
  6      dbms_output.put_line(test(1));
  7  end;
  8  /
declare
*
ERROR at line 1:
ORA-06531: Reference to uninitialized collection
ORA-06512: at line 5 
```

变量数组正确完成：

```
SQL> declare
  2      type varchar2_100_va is varray(10) of varchar2(100);
  3      test varchar2_100_va;
  4  begin
  5      test := varchar2_100_va(); -- not needed on associative array
  6      test.extend; -- not needed on associative array
  7      test(1) := 'Hello';
  8      dbms_output.put_line(test(1));
  9  end;
 10  /
Hello

PL/SQL procedure successfully completed. 
```

因为关联数组为空`first`且`last`为空，这就是为什么您的第二个示例导致`ORA-06502: PL/SQL: Numeric or value error`：

```
SQL> declare
  2      type varchar2_100_aa is table of varchar2(100) index by binary_integer;
  3      test varchar2_100_aa;
  4  begin
  5      dbms_output.put_line(test.count);
  6      dbms_output.put_line(coalesce(to_char(test.first), 'NULL'));
  7      dbms_output.put_line(coalesce(to_char(test.last), 'NULL'));
  8      test(1) := 'Hello';
  9      dbms_output.new_line;
 10      dbms_output.put_line(test.count);
 11      dbms_output.put_line(coalesce(to_char(test.first), 'NULL'));
 12      dbms_output.put_line(coalesce(to_char(test.last), 'NULL'));
 13  end;
 14  /
0
NULL
NULL

1
1
1

PL/SQL procedure successfully completed. 
```

**编辑**还请注意，关联数组可以是稀疏的。`first`循环和之间的数字`last`将为任何稀疏的集合引发异常。而是像这样使用`first`和[`next`](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/collections.htm#autoId19)：（`Last`并`prev`循环另一个方向。）

```
SQL> declare
  2      type varchar2_100_aa is table of varchar2(100) index by binary_integer;
  3      test varchar2_100_aa;
  4      i binary_integer;
  5  begin
  6      test(1) := 'Hello';
  7      test(100) := 'Good bye';
  8      dbms_output.put_line(test.count);
  9      dbms_output.put_line(coalesce(to_char(test.first), 'NULL'));
 10      dbms_output.put_line(coalesce(to_char(test.last), 'NULL'));
 11      dbms_output.new_line;
 12  --
 13      i := test.first;
 14      while (i is not null) loop
 15          dbms_output.put_line(to_char(i, '999')  || ' - ' || test(i));
 16          i := test.next(i);
 17      end loop;
 18  end;
 19  /
2
1
100

   1 - Hello
 100 - Good bye

PL/SQL procedure successfully completed. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T18:02:51.907

我不会回答为什么第一次检查失败。我从来没有想过做这样的事情，并且很惊讶它不会引发错误。

正如您所指出的，您在循环中引发异常的原因是索引`emp.first`不存在。

与其检查空值，不如检查该索引是否存在。您可以使用以下`.exists(i)`语法：

```
if not emp.exists(emp.first) then
   dbms_output.put_line('Nothing in here.');
end if; 
```

# java - Java 数字签名 - java.security.ProviderException

> ID：12411992
> 
> 赞同：3
> 
> 时间：2012-09-13T17:51:44.127
> 
> 标签：java, random, digital-signature

我正在尝试对我使用oracle 的[本教程的文件进行数字签名。](http://docs.oracle.com/javase/tutorial/security/apisign/index.html)

这一切在我的本地机器上运行得很好，但是当我尝试在没有鼠标、键盘等的 Web 服务器上运行它时。我设法只签署一个文件，并且每一次尝试都会导致以下异常发生：

```
java.security.ProviderException: nextBytes() failed 
```

这恰好在执行 sign 函数时发生：

```
byte[] realSig = dsa.sign(); 
```

从我目前所了解到的情况来看，这可能是由于耗尽了生成随机序列所需的熵池造成的。在没有输入设备的服务器上，它的填充速度不够快。如果情况确实如此，一种解决方案可能是将随机种子的来源从 dev/random 更改为 dev/urandom，但据说出于安全原因这并不好。

所以问题是：这真的是我的问题的原因吗？如果是这样，强制Java使用dev/urandom的方法是什么？或者有没有更好的方法来处理这个？

编辑：正如这里有人提到的，但在我回复之前已经删除了他的答案，添加以下代码解决了这个问题：

```
if (System.getProperty("java.security.egd") == null) {
   System.setProperty("java.security.egd", "file:///dev/urandom");
} 
```

它可能不是最好的解决方案，但足以签署和验证文件。

# jquery - 显示/隐藏多个元素

> ID：12411996
> 
> 赞同：1
> 
> 时间：2012-09-13T17:52:03.917
> 
> 标签：jquery, dom

必须根据一些逻辑检查来控制一些 dom 元素的可见性——我真的很想在 jquery 中这样的东西：

```
$('.FirstPanel').visible = (condition == 1 || othercondition == true);
$('.SecondPanel').visible = (condition > 3 || othercondition == false);
$('.ThirdPanel').visible = (condition < 3 || stillanothercondition = 'asdf');
etc 
```

当然，我可以使用 if 或 switch 语句和调用来表达上面的代码`$('.FirstPanel').hide()`……但它需要很多倍的代码行数。

```
if(condition == 1 || othercondition == true) {
    $('.FirstPanel').show();
    $('.SecondPanel').hide();
    $('.ThirdPanel').hide();
} else if (condition > 3 || othercondition == false) {
    $('.FirstPanel').hide();
    $('.SecondPanel').show();
    $('.ThirdPanel').hide();
} etc 
```

我觉得我错过了一些明显的东西。谢谢

* * *

2012.09.24 更新

感谢大家的回答 - 切换方法是票（见下面 Michaël Witrant 接受的答案）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:58:04.247

```
$('.FirstPanel').toggle(condition == 1 || othercondition == true);
$('.SecondPanel').toggle(condition > 3 || othercondition == false);
$('.ThirdPanel').toggle(condition < 3 || stillanothercondition = 'asdf'); 
```

[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:55:26.600

尝试类似：

```
$(".element").css("display", function() { value = (condition == 1 || othercondition == true); if (value) { return 'block'; /*or 'inline' or 'inline-block'*/ } 
return 'none'; }); 
```