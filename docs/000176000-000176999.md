# StackOverflow 问答 000176000-000176999

# python - Python 列表与数组 - 何时使用？

> ID：176011
> 
> 赞同：420
> 
> 时间：2008-10-06T20:17:43.470
> 
> 标签：python, arrays, list

如果您正在创建一维数组，您可以将其实现为列表，或者使用标准库中的“数组”模块。我一直将列表用于一维数组。

我想改用数组模块的原因或情况是什么？

是为了性能和内存优化，还是我遗漏了一些明显的东西？

* * *

## 回答 #1

> 赞同：479
> 
> 时间：2008-10-06T23:11:06.897

基本上，Python 列表非常灵活，可以保存完全异构的任意数据，并且可以在[摊销的常数时间内](http://en.wikipedia.org/wiki/Dynamic_array#Geometric_expansion_and_amortized_cost)非常有效地附加它们。如果您需要高效且轻松地缩小和增加列表，那么它们就是您的最佳选择。但是它们**比 C 数组使用更多的空间**，部分原因是列表中的每个项目都需要构造一个单独的 Python 对象，即使对于可以用简单的 C 类型（例如`float`或`uint64_t`）表示的数据也是如此。

`array.array`另一方面，类型只是 C 数组的一个薄包装器。它只能保存同质数据（也就是说，都是相同类型的），因此它只使用`sizeof(one object) * length`字节的内存。大多数情况下，当您需要将 C 数组公开给扩展或系统调用（例如，`ioctl`或`fctnl`）时，您应该使用它。

`array.array`在 Python 2.x ( )中表示**可变**字符串也是一种合理的方式。`array('B', bytes)`但是，Python 2.6+ 和 3.x 提供了一个可变*字节*字符串作为[`bytearray`](https://docs.python.org/3/library/stdtypes.html#bytearray).

但是，如果您想对同质的数值数据数组进行**数学运算**，那么最好使用 NumPy，它可以自动对复杂的多维数组进行矢量化操作。

**长话短说**：`array.array`当您出于*数学以外*的原因需要同质 C 数据数组时很有用。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-10-06T20:24:38.823

对于几乎所有情况，普通列表都是正确的选择。arrays 模块更像是 C 数组的薄包装器，它为您提供了一种强类型容器（请参阅[docs](http://docs.python.org/library/array.html#module-array)），可以访问更多类似 C 的类型，例如有符号/无符号短或双精度，它们不是内置的一部分-输入类型。我会说只有当你真的需要它时才使用数组模块，在所有其他情况下坚持使用列表。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2008-10-07T14:00:40.390

如果您不知道为什么要使用它，数组模块是您可能不需要的东西之一（请注意，我并不是要以居高临下的方式这么说！） . 大多数时候，数组模块用于与 C 代码接口。为了更直接地回答您关于性能的问题：

在某些用途上，数组比列表更有效。如果您需要分配一个您知道不会更改的数组，那么数组可以更快并且使用更少的内存。GvR 有一个[优化轶事](http://www.python.org/doc/essays/list2str/)，其中数组模块成为赢家（长读，但值得）。

另一方面，列表比数组消耗更多内存的部分原因是，当所有分配的元素都被使用时，python 会分配一些额外的元素。这意味着将项目附加到列表更快。因此，如果您计划添加项目，列表是您的最佳选择。

TL；DR 如果您有特殊的优化需求或者您需要与 C 代码交互（并且不能使用[pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)），我只会使用数组。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-01-30T20:18:07.667

> 这是一个权衡！

每个人的优点：

### 列表

*   灵活的
*   可以是异质的

### 数组（例如：numpy 数组）

*   统一值数组
*   同质
*   紧凑（尺寸）
*   高效（功能和速度）
*   方便的

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-06T20:22:50.527

我的理解是数组的存储效率更高（即作为连续的内存块与指向 Python 对象的指针），但我不知道有任何性能优势。此外，对于数组，您必须存储相同类型的原语，而列表可以存储任何内容。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-07T13:47:01.980

标准库数组对于二进制 I/O 很有用，例如将整数列表转换为字符串以写入波形文件。也就是说，正如许多人已经指出的那样，如果您要进行任何实际工作，那么您应该考虑使用 NumPy。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-06T20:30:54.347

如果您要使用数组，请考虑使用 numpy 或 scipy 包，它们为您提供了更多灵活性的数组。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2020-06-16T01:38:23.290

关于性能，这里有一些比较 python 列表、数组和 numpy 数组的数字（所有这些都在 2017 Macbook Pro 上使用 Python 3.7）。最终结果是 python 列表对于这些操作是最快的。

```
# Python list with append()
np.mean(timeit.repeat(setup="a = []", stmt="a.append(1.0)", number=1000, repeat=5000)) * 1000
# 0.054 +/- 0.025 msec

# Python array with append()
np.mean(timeit.repeat(setup="import array; a = array.array('f')", stmt="a.append(1.0)", number=1000, repeat=5000)) * 1000
# 0.104 +/- 0.025 msec

# Numpy array with append()
np.mean(timeit.repeat(setup="import numpy as np; a = np.array([])", stmt="np.append(a, [1.0])", number=1000, repeat=5000)) * 1000
# 5.183 +/- 0.950 msec

# Python list using +=
np.mean(timeit.repeat(setup="a = []", stmt="a += [1.0]", number=1000, repeat=5000)) * 1000
# 0.062 +/- 0.021 msec

# Python array using += 
np.mean(timeit.repeat(setup="import array; a = array.array('f')", stmt="a += array.array('f', [1.0]) ", number=1000, repeat=5000)) * 1000
# 0.289 +/- 0.043 msec

# Python list using extend()
np.mean(timeit.repeat(setup="a = []", stmt="a.extend([1.0])", number=1000, repeat=5000)) * 1000
# 0.083 +/- 0.020 msec

# Python array using extend()
np.mean(timeit.repeat(setup="import array; a = array.array('f')", stmt="a.extend([1.0]) ", number=1000, repeat=5000)) * 1000
# 0.169 +/- 0.034 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-06T20:25:05.013

数组只能用于特定类型，而列表可以用于任何对象。

数组也只能是一种类型的数据，而列表可以有各种对象类型的条目。

数组对于一些数值计算也更有效。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-09-10T13:26:59.783

这个答案将总结几乎所有关于何时使用 List 和 Array 的查询：

1.  这两种数据类型之间的主要区别在于您可以对它们执行的操作。例如，您可以将一个数组除以 3，它将数组的每个元素除以 3。列表不能这样做。

2.  该列表是python语法的一部分，因此不需要声明它，而您必须在使用它之前声明数组。

3.  您可以将不同数据类型的值存储在列表中（异构），而在 Array 中您只能存储相同数据类型的值（同类）。

4.  数组功能丰富且速度快，与列表相比，它广泛用于算术运算和存储大量数据。

5.  与列表相比，数组占用的内存更少。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-17T00:46:44.200

numpy 数组和列表之间的一个重要区别是数组切片是原始数组的视图。这意味着数据不会被复制，对视图的任何修改都将反映在源数组中。

# php - 你有什么建议用 php 设置共享服务器

> ID：176013
> 
> 赞同：8
> 
> 时间：2008-10-06T20:18:49.490
> 
> 标签：php, apache, lighttpd, shared-hosting

从安全/性能的角度来看，您建议使用 php 设置共享服务器是什么？

*   Apache mod_php（你如何保护它？除了 safe_mode，因为它不会在 PHP6 中）
*   Apache CGI + suexec
*   Lighttpd 并为每个用户生成一个 FastCGI

LE：我对使用已经制作好的控制面板不感兴趣，因为我正在尝试编写自己的控制面板，所以我想知道自己设置它的最佳方法是什么。我正在考虑使用 Lighttpd 并为每个托管用户生成一个 fastcgi，使 fcgi 进程在他的凭据下运行（在 lighttpd wiki 上有一个教程）。这会有点安全，但这会影响性能（每个 fcgi 需要大量用户/内存）以至于它不是一个可行的解决方案吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-08T11:11:16.067

就个人而言，虽然 Lighttpd 还可以，但如果您最终使用轻量级 Web 服务器 + FastCGI 解决方案，我会选择 Nginx + FastCGI。我已经运行了基准测试并阅读了所有代码，并且 Nginx 在负载下速度更快/更稳定一个数量级——非常好。

但是，这不是你问的。从本质上讲，我会说在您列出的三个选项中存在一系列安全/可扩展性与速度权衡，您只需要决定您想要的位置。如果您是共享托管服务提供商，不信任的用户安装了天知道的 PHP 应用程序，您将更倾向于安全性，如果在更受信任的用户之间共享，您可能更倾向于性能。以下是我的想法：

**CGI + suexec：**就共享托管环境中的用户/站点数量而言，这是迄今为止最安全、最高效/可扩展的。进程只在请求进来时才被派生，内存只被使用。当然，CGI 派生使得这对于单个脚本的执行时间来说是最慢的。慢多少？好吧，您必须进行基准测试，但通常如果人们正在运行长时间运行的应用程序（例如，像 WordPress 这样的应用程序，加载其库并在每个请求上初始化需要 0.25-0.5 秒），那么 CGI 生成惩罚开始看起来很漂亮在上下文中可以忽略不计。

**FastCGI：**这里的问题（无论您的网络服务器是 Apache、Lighttpd 还是 Nginx 都无关紧要）是弄清楚您让每个用户运行多少个 FCGI 子进程，因为每个进程占用的内存等于 PHP 解释器的大小（在 Linux 中，当然不是所有的都是有线的，但我离题了）。而且，与 mod_php 不同，这些进程不会在用户之间共享，因此您必须限制每个用户。例如，Dreamhost 为他们的客户将这个上限限制为 3 - 现在，对于一个运行网站的客户，该网站每秒获得超过 2-5 次页面浏览量，这实际上非常糟糕，因为这些请求只会堆积起来，网站就会挂起。*现在，当我在专用*服务器上运行应用程序时，我喜欢带有轻量级网络服务器的 FastCGI*服务器/集群，当我可以为应用程序提供数百个 FCGI 子级时（当然，所有这些都具有 webserver privs，à la Apache/prefork + mod_php）。但是，我认为共享主机没有意义，您必须为每个用户分配/限制 FCGI 子代。*

 ***Apache + mod_php：**最不安全，因为一切都使用 webserver privs 运行，但是您的实时 PHP 进程池是共享的，因此它在性能方面是最好的。从开发人员的角度来看，我不能容忍 php_safe 模式，从系统管理员的角度来看，这实际上只是一种安全错觉（它可以减轻愚蠢的用户，但不能防止实际攻击）所以我实际上宁愿使用 CGI 如果我的其他选项必须包括 safe_mode。

Dreamhost 确实是一种混合，默认情况下他们使用 Apache CGI + suexec，但是如果他们愿意，允许他们的更多（小）百分比的老练用户选择使用 FCGI，这取决于上限和他们自己对内存使用情况的监控. 与默认情况下为每个人启用 FCGI 相比，这节省了大量内存资源。

如果您在谈论标准的商业共享主机，另一个问题是，Apache 功能齐全，具有几乎任何东西的模块（包括您可能想要的 mod_security 之类的东西），并且您的用户会喜欢它，因为他们所有的 .htaccess 配置都可以工作等等——当他们去安装 Drupal 或 WordPress 或其他任何东西时，你会遇到任何其他问题的支持头痛（如果我们谈论的是内部用户，那么问题就小得多了）。

就个人而言，我建议保持简单的开始并使用 CGI + suexec 以获得最佳的安全性和可扩展性。如果您的用户想要 FCGI 或 mod_php，并且您有一个很好的渠道可以与他们进行建议/交流，他们会提出要求，但是对于您来说，这两者中的任何一个都是更令人头疼的问题，对他们来说只有边际性能改进，所以我的建议最初是不做其中任何一个，但如果他们吵着要做出回应。

我很同情做一些“有趣”的事情，比如 Lighttpd + FCGI 而不是标准的 Apache + CGI + suexec，但我内心深处我真的不能推荐它。

如果您正在运行多台服务器，那么您最终可能会将 CGI 放在一些服务器上，而将其他一些服务器放在其他服务器上供高级用户使用。并且一定要 cron grep 所有 www 目录，例如旧版本的 phpBB！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T12:08:34.160

我推荐[Suhosin](http://www.hardened-php.net/suhosin/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T14:58:54.643

关于 PHP + FastCGI 和安全性，请查看[这篇博文](http://blog.stuartherbert.com/php/2008/10/07/can-you-secure-a-shared-server-with-php-fastcgi/)。

> 保护共享托管服务器的挑战是如何保护网站免受来自外部和内部的攻击。PHP 有内置功能可以提供帮助，但最终它不是解决问题的地方。
> 
> 我已经写过许多可行的解决方案，但是我一次又一次地被要求查看的一个选项是使用 PHP + FastCGI。人们相信使用 FastCGI 将克服 Apache 的 suexec 或 mod_suphp 的性能问题，因为 FastCGI 进程在页面视图之间持续存在。
> 
> 但在我们查看性能之前，第一个问题是：首先我们如何让 PHP 和 FastCGI 作为不同用户在一个 Web 服务器上运行？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T20:56:07.667

我已经使用[InterWorx](http://www.interworx.com/)大约一年了，印象非常深刻。它维护一个带有 chroot 脚本的 LAMP 服务器以确保安全。

我也使用过[Ensim](http://www.ensim.com/)，但没有发现它友好、快速并且没有那么多功能。再加上它的成本要高得多。

# iis-6 - 什么时候在 IIS6 上设置“索引此资源”？

> ID：176031
> 
> 赞同：6
> 
> 时间：2008-10-06T20:22:31.230
> 
> 标签：iis-6

在为网站设置 IIS6 属性的主目录时，默认情况下会选中“索引此资源”选项。

微软的网站说：

> 授予此权限以允许 Microsoft 索引服务将此文件夹包含在网站的全文索引中。当您授予此权限时，用户可以对此资源执行查询。

有人可以给我更多信息，说明您何时会选中此选项吗？用户会对该资源执行什么样的查询？为网站设置此设置为开/关的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-04-27T09:55:12.793

Windows 索引服务不断地从指定目录下的文件（安装了相应的 IFilter）中提取内容，并构建索引目录，以方便高效快速的搜索。

当您在 IIS 6 上设置“索引此资源”并且 Windows 索引服务正在运行时，该服务会将网站/虚拟目录/目录/子目录的实际物理路径添加到 Web 目录中要索引的目录列表中，并服务开始索引文件。

有多种方式可以通过编程方式与 Windows 索引服务交互以搜索索引文件/内容；例如 OLE DB Provider、Query Helper & [Others](http://msdn.microsoft.com/en-us/library/ms690384%28v=VS.85%29.aspx#_idxs_query_helper_api) ...。

**将选项设置为打开：**何时

*   自定义搜索将通过 Windows 索引服务执行
*   网站/目录包含将被搜索的文件。

**设置选项关闭：**何时

*   自定义搜索不会使用 Windows 索引服务。

Windows 索引服务不断索引已打开该选项的站点/目录的内容，这可能会导致性能问题。建议在不使用 Microsoft 索引服务的站点上关闭该选项。

*注意：Windows 索引服务在 Windows Server 2003 上默认禁用。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T20:04:59.173

这是为了使用用于驱动搜索的索引服务。我想没有人再用这个了。它对高清非常密集。检查是否在您的服务器上启用了索引服务。我们会默认禁用。

如果你打开索引服务 mmc 将会有一个系统和一个 web 范围。选中此框会将网站添加到 Web 范围。如果您正在编写自己的搜索算法，您将编写针对 Web 范围的搜索查询。由于是 2008 年，您将使用 Google。

# sql-server-2008 - 如何为 SQL Server 2008 Reporting Service 报告注册 Web 参考？

> ID：176038
> 
> 赞同：1
> 
> 时间：2008-10-06T20:23:41.977
> 
> 标签：sql-server-2008, ssrs-2008

我正在尝试通过我的 Visual Studio 2008 应用程序中的 Web 服务访问报告服务。如何/在哪里可以找到我的 WSDL？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T20:24:50.040

[以下示例显示了 Reporting Services 管理 WSDL 文件的 URL 格式：](http://msdn.microsoft.com/en-us/library/ms154052.aspx)

[http://server/reportserver/ReportService2005.asmx?wsdl](http://server/reportserver/ReportService2005.asmx?wsdl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:49:32.790

请参阅[http://msdn.microsoft.com/en-us/library/ms169816.aspx](http://msdn.microsoft.com/en-us/library/ms169816.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-17T14:19:15.443

我应该指出，尽管 Gulzar 确实发布了正确的答案，但它仅在您将 Web 服务 URL 设置为默认值时才有效 - 如果没有，它将无法工作。

确保检查哪个 URL 正确 - 在 Reporting Services 配置管理器中，转到 Web 服务 URL 部分并查看“报表服务器 Web 服务 URL”框中的内容。这也可能包括端口号，但如果它是端口 80，您可以将其省略。

此外，出于某种原因，即使这是 Sql Server 2008 和 Reporting Services 2008，asmx***仍然***是ReportService2005.asmx。由于某种原因，这还没有更新。

所以 URL 应该是：

[http://MyReportServer:PortNumber/WhateverUrlTheWebServiceIsSetAs/ReportService2005.asmx?wsdl](http://MyReportServer:PortNumber/WhateverUrlTheWebServiceIsSetAs/ReportService2005.asmx?wsdl)

希望这可以帮助！

# java - Java：序列化初学者问题:-(

> ID：176051
> 
> 赞同：0
> 
> 时间：2008-10-06T20:26:09.583
> 
> 标签：java, arrays, serialization

我想通过序列化来保存和存储简单的邮件对象，但我总是收到一个错误，我找不到它在哪里。

```
package sotring;
import java.io.*;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.*;

import com.sun.org.apache.bcel.internal.generic.INEG;

public class storeing {

    public static void storeMail(Message[] mail){
        try {
            ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream("mail.ser"));
            out.writeObject(mail);
            out.flush();
            out.close();

        } catch (IOException e) {
        }   
    }

        public static Message[] getStoredMails(){

     try
     {

        ObjectInputStream in = new ObjectInputStream(new FileInputStream("mail.ser"));
        Message[] array = (Message[]) in.readObject() ;
        for (int i=0; i< array.length;i++)
            System.out.println("EMail von:"+ array[i].getSender() + " an " + array[i].getReceiver()+ " Emailbetreff: "+ array[i].getBetreff() + " Inhalt: " + array[i].getContent());

        System.out.println("Size: "+array.length);  //return array;
        in.close();
        return array;    
     }
     catch(IOException ex)
     {
        ex.printStackTrace();
        return null;
     }
     catch(ClassNotFoundException ex)
     {
        ex.printStackTrace();
        return null;
     }  
}

    public static void main(String[] args) {
        User user1 = new User("User1", "geheim");
        User user2 = new User("User2", "geheim");

        Message email1 = new Message(user1.getName(), user2.getName(), "Test", "Fooobaaaar");
        Message email2 = new Message(user1.getName(), user2.getName(), "Test2", "Woohoo");
        Message email3 = new Message(user1.getName(), user2.getName(), "Test3", "Okay =) ");
        Message [] mails = {email1, email2, email3};
        storeMail(mails);
        Message[] restored = getStoredMails();;         
    }
} 
```

这是用户和消息类

```
public class Message implements Serializable{

    static final long serialVersionUID = -1L;

    private String receiver;  //Empfänger
    private String sender;  //Absender
    private String Betreff;
    private String content;
    private String timestamp;

    private String getDateTime() {
        DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
        Date date = new Date();
        return dateFormat.format(date);
    }

    Message (String receiver, String sender, String Betreff, String content) {
        this.Betreff= Betreff;
        this.receiver = receiver;
        this.sender = sender;
        this.content = content;
        this.timestamp = getDateTime(); 
    }

    Message() {  // Just for loaded msg 
    }

    public String getReceiver() {
        return receiver;
    }

    public void setReceiver(String receiver) {
        this.receiver = receiver;
    }

    public String getSender() {
        return sender;
    }

    public void setSender(String sender) {
        this.sender = sender;
    }

    public String getBetreff() {
        return Betreff;
    }

    public void setBetreff(String betreff) {
        Betreff = betreff;
    }

    public String getContent() {
        return content;
    }
    public String getTime() {
        return timestamp;
    }
    public void setContent(String content) {
        this.content = content;
    }

}

public class User implements Serializable{

    static final long serialVersionUID = -1L;
    private String username;  //unique Username
    private String ipadress;  //changes everytime
    private String password;  //Password
    private int unreadMsg;    //Unread Messages
    private static int usercount;
    private boolean online;

    public String getName(){
        return username;
    }
    public boolean Status() {
        return online;
    }

    public void setOnline() {
        this.online = true;
    }
    public void setOffline() {
        this.online = false;
    }

    User(String username,String password){
        if (true){
            this.username = username;
            this.password = password;
            usercount++;

        } else System.out.print("Username not availiable"); 
    }

    public void changePassword(String newpassword){
        password = newpassword;
    }

    public void setIP(String newip){
        ipadress = newip;
    }

    public String getIP(){
        if (ipadress.length() >= 7){
            return ipadress;
        } else return "ip address not set.";
    }

    public int getUnreadMsg() {
        return unreadMsg;
    }   
} 
```

这是一个例外：

`exception in thread "main" java.lang.Error: Unresolved compilation problem: This method must return a result of type Message[] at sotring.storeing.getStoredMails(storeing.java:22) at sotring.storeing.main(storeing.java:57)`

感谢您的帮助！！！！！！！！！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T20:30:21.213

catch 子句需要返回一些东西。

```
public static Message[] getStoredMails(){

     try
     {

            ObjectInputStream in = new ObjectInputStream(new FileInputStream("mail.ser"));
            Message[] array = (Message[]) in.readObject() ;
            System.out.println("Size: "+array.length);      //return array;
            in.close();
            return array;    
     }
     catch(IOException ex)
     {
            ex.printStackTrace();
     }
     catch(ClassNotFoundException ex)
     {
            ex.printStackTrace();
     }    
     return null; //fix  
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T20:29:21.777

如果发生异常，您永远不会到达 getStoredMails 中的 return 语句。您需要抛出您捕获的异常（可能将其包装在另一个更具描述性的异常中）或仅在方法结束时返回 null。如果出现错误，这实际上取决于您要做什么。

哦，你的 in.close() 应该在 finally 块中。否则，您可能可以很好地读取数据，但如果您无法关闭流，则将其丢弃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T20:39:27.717

另一方面，您是否考虑过第三方序列化程序库？

我现在正在将[Simple](http://simple.sourceforge.net/)用于一个项目，它似乎只需很少的努力就可以很好地完成工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T20:56:07.730

在 getStoredMails 方法的异常处理块中，您不会返回任何内容。

建议修改：

```
public static Message[] getStoredMails(){

         try
         {

                ObjectInputStream in = new ObjectInputStream(new FileInputStream("mail.ser"));
                Message[] array = (Message[]) in.readObject() ;
                System.out.println("Size: "+array.length);      //return array;
                in.close();
                return array;    
         }
         catch(IOException ex)
         {
                ex.printStackTrace();
         }
         catch(ClassNotFoundException ex)
         {
                ex.printStackTrace();
         }  

         return null;    
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T20:35:08.957

我修改了源。我在异常中添加了“return null”，并在函数中添加了for循环输出。该函数为我提供了正确的输出，但随后将其抛出异常。

# build-process - 防止对话框出现在无人参与的构建中

> ID：176058
> 
> 赞同：2
> 
> 时间：2008-10-06T20:28:34.353
> 
> 标签：build-process, automation, build-automation

我想知道是否有一种万无一失的方法可以在 Windows 上运行程序，这样我就**可以保证**不会显示**任何类型**的交互式对话框。

我已经尝试过注册表ErrorMode hack，调用_CrtSetReportMode() 等，但它们都有漏洞或者需要你修改程序。

我需要一种方法来运行**任意**程序并实际上强制 Windows 执行它们，这样它们就不可能打开窗口。如果它试图打开一个窗口，程序崩溃是完全可以的。

将程序作为服务运行会解决问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:30:18.343

我不知道任何其他可能有效的方法。作为服务运行也不能解决问题，因为对话框将显示在服务的桌面上，而您通常无权访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T20:31:57.607

您可以使用诸如[Detours](http://research.microsoft.com/sn/detours/)之类的库来拦截对可能显示对话框的函数的所有调用（这实际上可能是 中的几乎所有内容`user32.dll`）。

# c# - 在开发过程中管理多个应用配置文件

> ID：176061
> 
> 赞同：12
> 
> 时间：2008-10-06T20:29:09.687
> 
> 标签：c#, .net, visual-studio, app-config

我正在构建一个由多个不同客户使用的应用程序。每个客户都有相当多的自定义业务逻辑，我巧妙地将其重构为在运行时加载的程序集。该程序集的名称以及许多其他客户特定的设置都存储在应用程序的配置文件中。

现在，为了调试客户 foo 的应用程序，我必须执行以下操作：

1.  转到我的项目目录中的文件系统并删除`app.config`
2.  复制`app.config.foo`到`app.config.foo - Copy`.
3.  重命名`app.config.foo - Copy`为`app.config`.
4.  告诉 Windows 是的，我想更改文件的扩展名。
5.  切换回 Visual Studio。
6.  在我的项目中打开`Settings.settings`项目。
7.  当 VS 询问我是否要使用已更改的新设置时，单击“是”13 或 14 次`app.config`。
8.  关闭`Settings.settings`。

好的！现在我准备调试了！

在我看来，打开的繁琐`Settings.settings`是或应该是不必要的：我不需要`Settings.cs`重新生成默认值，因为我不使用它们。但这是我所知道的让 VS 知道文件已更改这一事实的唯一方法`app.config`，以便构建将其复制到输出目录。

必须有一种更简单的方法来做到这一点。它是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-08-22T14:23:28.133

您还可以通过以下方式让 Visual Studio 自动化 Robert 的方法：

1.  为每个客户端定义构建配置
2.  在构建后事件中，只需将 app.config.xxx xcopy 到您的 bin 文件夹。其中 XXX 是在 VS 中可访问的构建配置的名称。类似于： xcopy app.config.$(ConfigurationName) $(OutDir)/app.config

VS 将在单独的文件夹中为您的客户端删除一个不同的构建，并使用正确的配置文件。bin/Client1/ bin/Client2/

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T20:30:35.877

您可以参考这篇文章了解一些好的做法：[使用预构建事件管理多个配置文件环境](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-15T12:03:59.230

考虑到管理多个配置文件的混乱，我制作了这个工具：[http ://envride.codeplex.com/](http://envride.codeplex.com/)

其目的正是为了更轻松地以`configuration files`自动化方式管理多个。如果您能看一看，我会非常高兴。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-03T06:14:05.037

有几个人建议使用多个 VS 配置，我认为这会奏效，但每次在配置之间切换时都需要我重新构建解决方案。

我做的事情在我做的时候似乎有点愚蠢，但我已经使用了近一年了，它运行得非常顺利。在我的项目中，我直接`app.config.XXX`为每个客户创建了一个单独的文件。实际`app.config`文件仅用于生成`Settings.cs`- 它具有所有正确的设置名称及其默认值。它永远不会被复制到构建目录中。

然后我写了一个小程序，让我选择一个客户，它简单地遍历每个项目的目录，如果我选择了客户 XXX，则复制`app.config.XXX`到`bin\debug\myprogram.exe.config`和`bin\release\myprogram.exe.config`. 只要这个程序知道解决方案的根源在哪里（每当我分支代码时我必须小心一点），它就像一个魅力。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-09-28T06:40:26.137

这个线程太旧了，无法代表 VS 中的当前工具。

1.  您可以使用与 web.debug.config 类似但用于 app.config 的插件。

[https://marketplace.visualstudio.com/items?itemName=GolanAvraham.ConfigurationTransform](https://marketplace.visualstudio.com/items?itemName=GolanAvraham.ConfigurationTransform)

2.  对于没有插件的相同 app.config 转换。

[https://www.linkedin.com/pulse/multi-appconfig-visual-studio-2017-benjamin-davis/](https://www.linkedin.com/pulse/multi-appconfig-visual-studio-2017-benjamin-davis/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T02:04:21.150

您可以选择为每个客户定义多个 Visual Studio 解决方案配置，并为您的 Windows 应用项目自定义 MSBuild 目标。

我在这里记录了我如何处理这个问题的步骤。[用于部署到不同环境的多个 app.config 文件](http://icelava.net/forums/thread/2920.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-18T22:10:04.680

经过一番挖掘和解决后，我的测试项目使用了多种配置，

1.  在配置管理器中，创建您需要的配置
2.  复制粘贴你的 app.config 并添加配置的名称，在我的例子中是 AHI、FIV、MGC，所以我的配置文件看起来像：App.AHI.config、App.MGC.config、App.FIV.Config。您可以随意命名它，但保持相同的约定
3.  添加构建后事件。在我的情况下，它看起来像： xcopy $(ProjectDir)app.$(ConfigurationName).config $(TargetDir)$(TargetName).dll.config /y

这是我的帖子，所以您可以阅读更多详细信息

[运行具有多个配置的测试项目](https://judocode.wordpress.com/2016/02/18/runing-c-unit-test-with-multiple-configurations/)

# c++ - 如何禁用然后启用 MessageBox 中的重试按钮？

> ID：176062
> 
> 赞同：0
> 
> 时间：2008-10-06T20:29:18.813
> 
> 标签：c++, winapi, unmanaged

我有以下非托管 C++ 代码：

```
MessageBox( NULL, strMessage, "Cool Product", MB_RETRYCANCEL | MB_ICONEXCLAMATION); 
```

我想禁用 RETRY 按钮 10 秒（例如），然后启用它。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:36:25.927

就像[@ffpf](https://stackoverflow.com/questions/176062/how-do-i-disable-and-then-enable-the-retry-button-in-a-messagebox-c#176082)所说，您需要使用 MFC、ATL、原始 Win32 等制作自己的对话框来执行此操作。

然后创建一个启用和禁用按钮的计时器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T20:54:25.550

您不能直接操作 MessageBox 控件，但可以使用 hack。`_`在显示对话框之前安装 WH CBT 挂钩并处理 HCBT `_`ACTIVATE 事件。这将为您提供消息框的 HWND，以便您可以对它做任何您想做的事情（子类化它，管理它的按钮并设置一个计时器）。

您可以在 James Brown 的网站上找到带有演示代码的[自定义 MessageBox教程。](http://www.catch22.net/tuts/msgbox)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T20:33:55.027

使用标准 MessageBox 调用，您不能。您需要实现自己的 MessageBox 才能做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T20:35:16.053

我不相信标准的消息框调用是可能的。

您最好编写自己的包含此功能的消息框。

（或者，您可以编写一个单独的线程，不断观察屏幕等待该消息框出现，禁用重试按钮，等待 10 秒并重新启用它。不好玩。说真的，换一种方式。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T20:45:08.127

从Vista 开始，您可以使用taskdialog——一个比简单消息框更复杂的对话框。更多信息和链接[在这里](http://shellrevealed.com/blogs/shellblog/archive/2006/09/19/So-long-MessageBox-and-thanks-for-all-the-memories.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T21:15:07.300

我同意 efotinis，这不是不可能的，一旦你有了 HWND，你就可以用它做任何你想做的事情。这只是“你真的需要这些技巧还是只创建自己的消息框对话框更好”的问题？

另一种找到 HWND 的不太好的方法（这显然可以让您访问消息框中的所有内容）是启动一个线程并使用 EnumChildWindows 循环轮询消息框句柄。但我个人也更喜欢 WH_CBT 钩子。

# installation - 您的开发环境是如何设置的？

> ID：176080
> 
> 赞同：8
> 
> 时间：2008-10-06T20:33:38.210
> 
> 标签：installation, development-environment

很想知道人们如何设置他们的个人和/或工作开发环境，包括：

您是否在主操作系统上安装了所有开发工具（例如 Visual Studio、SSMS 等）？
您是否使用虚拟机来拥有一个单独的“干净”开发环境，该环境仅包含操作系统和您正在使用的一个编译器？
您在多引导系统中有多个操作系统吗？
您是否远程连接到安装了开发人员工具的单独机器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T20:40:04.830

这完全取决于我猜的工作类型。这是我的设置：

1.  主电脑。我桌子上的那个。什么都有。
2.  次机。运行 Vista。
3.  一堆“干净的”用于测试的虚拟机。我们支持的每个操作系统通常有 2 台机器。
4.  构建机器。没有安装产品的虚拟机。只是源代码和一些编译器。
5.  用于托管服务器应用程序和数据库的专用“服务器”。[我们的产品是客户端-服务器的东西]

[最重要的是，我的主要机器和辅助机器也运行着服务器和数据库。]

编辑：“干净”是指他们只有一个新安装的操作系统，没有别的。这些是非持久性的，并在关闭时返回干净状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T21:05:10.300

我正在运行我认为是相当标准的敏捷 C# 开发环境。Vista SP1、带有 Resharper 4.1 的 Visual Studio 2008、SQL Express 2008、Subversion 服务器、命令行 svn 客户端和 Cruise Enterprise（令人难以置信的产品），带有 1 个服务器和 1 个用于持续集成的代理。

我在戴尔 XPS core 2 duo 2.4Ghz 笔记本电脑上运行，配备 4GB RAM 和 1 个外部 22 英寸宽屏显示器。

我已经*尝试过并坚持*使用 VMWare Workstation（主要是虚拟 PC），但在厌倦了 Visual Studio 中的性能和烦人的延迟后，我**一次又一次地求助。**我已经尝试了书中可用的所有性能技巧和调整。它显然只需要比我拥有的更多的硬件或更多的耐心。

我还尝试使用运行 Vista（vlite'ed）和 windows XP（lite）的 VMWare Worstation 服务器运行 64 位 Ubuntu，但我发现它同样烦人。

如果您的规格与我所描述的类似，那么我可以简单地建议不要沿着 VM 路径走，除非它是绝对必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T20:38:54.037

我在我的环境中有一个主要服务器的 VMWare 网络复制，包括 SQLserver、Web 服务器、我的开发盒的副本和 AD 服务器。我还在我的开发盒上使用 VS 来处理不需要太多测试的简单事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T20:40:33.377

我们使用 Virtual PC 进行开发。以及我们构建环境的副总裁。这样做的原因是我们可以在不同的项目之间切换而不会浪费时间。（为了支持）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T20:41:28.773

在我们当前的客户端，我们有一个 ESX 服务器，上面运行着虚拟机。我们通过远程桌面访问虚拟机。

对于我在 VS 2008 中的风格，我使用 Rob Conery 的 VibrantInk。

我们在所有虚拟机上都有 Reflector 和所有 Sysinternal 工具。

我还计划在每台机器上安装 ReSharper。

Firefox/Firebug 组合安装在每台机器上。

IE7 的 Web Developer 也安装在每台机器上。

干杯!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T20:42:16.057

我真的很喜欢为我使用的每个 IDE 使用单个 VM，但这需要一台强大的机器。然而，我的公司最近开始接受这样的想法，即开发人员可以用低于 500 美元的机器“做得很好”。因此，我当前的设置是我唯一机器上的一切。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T20:44:26.490

我所有的工具都在我的本地机器上。我通常在 MVC 思维模式下工作。

VMWare 安装在我的机器上，但它仅在极少数情况下用于我的机器无法控制的事情。

我的工作主要是在 Windows 机器上使用 Visual Studio 完成的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T20:45:25.100

我在我的主机（Vista :p）上运行了 Visual Studio 2005 和 2008，我可以在这里开发的所有东西都不会弄乱机器，我愿意。感觉比在虚拟机中响应快得多。我有一个用于基于 Linux 的开发的 VM 和几个用于测试目的的 VM。我从未测试过 VMWare 的调试功能（在主机上运行调试器，在客户机上运行调试器），尽管我可以想象这将是在主机上安装 Visual Studio 的一个很好的理由，即使您不关心响应能力。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T21:04:13.657

我的主工作站上运行着许多 IDE 和服务器产品。我还有一台远程访问笔记本电脑，上面装有所有相同的关键软件，因此我可以在本地开发（而不依赖于 Citrix 和远程桌面在办公室外进行代码修复）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T21:20:16.713

我的主要工作系统

*   Linux x64 双核
*   双显示器
*   基于 Redhat 的操作系统
*   Vim、Kdevelop、Eclipse（带有 Epic 和 Subclipse）。

我的系统与我们的服务器相似（架构和操作系统），这就是我实现代码的目的。由于我在一家有很多帽子的小公司工作，我倾向于在一个窗口中打开一个 ssh 的 mysql 连接，而在另一侧打开一个 vim 屏幕。我每天都在使用 SSH、VIM、SVN、firefox 和电子邮件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T21:30:03.370

我将构建代码所需的所有工具链和其他应用程序放入修订控制中，并为所有项目编写 makefile，以便使用存储库中的工具版本，而不是 $PATH 中的任何版本。所以当我为发布做一个标签时，它包括了构建所需的*一切*，并且尽可能少地依赖于构建机器的设置。我需要做的就是同步到版本控制，然后输入“make”。不幸的是，这确实需要在 Windows 上安装 cygwin，但就个人而言，我认为 Windows 机器在没有 cygwin 的情况下几乎无法用于开发，无论构建系统的先决条件如何。

我有简单的 makefile 来构建包含特定于平台的 .mk 文件的项目。我不手动创建 IDE 项目文件。在某些情况下（用于嵌入式 ARM 开发的 Rowley Crossworks，用于自托管 Windows PC 开发的 Visual Studio），我会根据我的 makefile 自动生成项目文件，作为“make debug”目标的一部分，然后使用生成的项目。这使得调试方便，除了我的 makefile 之外，不需要并行维护特定于 IDE 的项目文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-14T07:16:14.807

我即将为一个新部门建立一个新的开发环境。

构建环境（同时支持 Java 开发和 .Net）将在同一台物理计算机上运行的不同 VMware 机器上。两个图像都将使用 2008 服务器。

开发人员机器将是台式计算机，很可能是 qith 6 gig ram、大硬盘、1 或 2 个双核或四核 CPU、24" 屏幕 * 2 等，并安装了 2008 服务器。这是为了确保开发人员代码是在操作系统上编译。桌面，因为我希望开发人员能够使用 VMware 进行测试等，而无需花费太多时间抱怨同时运行 2 个 VMware 时性能不足:)

我现在正试图弄清楚构建环境。考虑到 Team City，++。当您想要支持多平台环境而不大惊小怪时，很难找到合适的 :)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-14T07:23:12.483

每个开发人员设置都包括一个 17 英寸的 MacBookPro 和一个 22 英寸的液晶屏幕。Eclipse 是我们的 IDE，我们使用 VMWare 在 winXP 下托管我们的开发数据库（oracle）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-14T07:24:40.827

显然，您的很多答案将在很大程度上取决于每个人的发展方式。也许我们应该对这些进行分类？:)

**Web开发**

我使用 VM 来运行带有开发网络服务器的 Linux 来宾。我在我的主机上使用 Notepad++ 进行编辑（最近从 jEdit 转换），并在 VM 软件（Sun 的 VirtualBox）中使用驱动器映射，我的开发网络服务器客户机可以毫无问题地提供不断变化的源文件。我还在另一个 VM 中使用 Windows XP IE6 VPC 映像来测试 IE6 中的页面。即使我没有开发复杂的网络应用程序并且只是在静态 HTML 页面上工作，我也会使用此设置；在许多浏览器中，本地打开的文件和提供的网页之间的行为仍然存在一些奇怪的差异，这使得这很值得。

# java - 为什么调用 .getBytes() 时字符串“¿”会被翻译成“Â¿”

> ID：176084
> 
> 赞同：2
> 
> 时间：2008-10-06T20:34:38.553
> 
> 标签：java, utf-8, character-encoding

当使用写出字符串“¿”时

```
System.out.println(new String("¿".getBytes("UTF-8"))); 
```

Â¿ 是写而不只是 ¿。

为什么？我们如何解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T20:55:52.050

您不必使用 UTF-16 来解决这个问题：

```
new String("¿".getBytes("UTF-8"), "UTF-8"); 
```

工作得很好。只要赋予`getBytes()`方法的编码与传递给 String 构造函数的编码相同，就可以了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T20:41:07.120

您需要在 String 构造函数中指定 Charset（请参阅[API 文档](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#String%28byte[],%20java.nio.charset.Charset%29)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T20:56:48.447

尝试：

```
System.out.println(new String("¿".getBytes("UTF-8"), "UTF-8")); 
```

在将字符串转换为字节时以及将字节转换回字符串时，您都需要指定编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T20:36:05.210

听起来系统控制台不是 UTF-8

# html - 在自定义框架中使用 actionscript 打开页面

> ID：176088
> 
> 赞同：0
> 
> 时间：2008-10-06T20:36:02.217
> 
> 标签：html, flash, actionscript

是否可以使用 navigateToURL 打开 HTML 页面并在 HTML 文档中指定命名框架？例如，如果您在页面上有一个名为“Steven”的 iframe，您可以调用

```
navigateToURL("someURL","Steven"); 
```

而不是像

```
navigateToURL("someURL","_self"); 
```

我已经尝试过了，它会在新窗口中打开 URL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T03:33:39.970

您是否对保存到硬盘的本地文件进行了测试？如果是这样，那么您可能会遇到一些安全限制。[请参阅此处](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/package.html#navigateToURL())的安全说明。

但是，如果您使用 Web 服务器上的文件对此进行测试，并且没有跨域问题，那么`navigateToURL()`应该完全按照您使用它的方式工作 - 如果您的 iframe 的名称是“Steven”，那么内容应该在那个 iframe。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T20:41:39.803

我不确定，但你可以使用 JavaScript：

```
navigateToURL("javascript:loadFrame(someURL)"); 
```

然后在您的 HTML 页面中：

```
function loadFrame(url) {
  documents.frames[1].src=url
} 
```

# java - Java2D: Clipping a Graphics object with a Line

> ID：176093
> 
> 赞同：0
> 
> 时间：2008-10-06T20:38:04.660
> 
> 标签：java, java-2d

Is there a way to use a Graphics object's 'setClip()' method to clip using a Line-ish shape? Right now I'm trying to use a Polygon shape but I'm having problems simulating the "width" of the line. I basically draw the line, and when I reach the end, I redraw it but this time subtract the line width from y-coordinate:

```
Polygon poly = new Polygon();

for(int i = 0; i < points.length; i++)
  poly.addPoint(points.[i].x, points.[i].y);

// Retrace line to add 'width'
for(int i = points.length - 1; i >=0; i--)
  poly.addPoint(points[i].x, points[i].y - lineHeight); 
```

It almost works but the width of the line varies based upon its slope.

I can't use the BrushStroke and drawLine() methods because the line can change color once it passes some arbitrary reference line. Is there some implementation of Shape that I overlooked, or an easy one I can create, that will let me do this more easily?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:59:55.380

If there is a better way, I've never run across it. The best I can think of is to use some trigonometry to make the line width more consistent.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T22:05:06.403

好的，我设法在不使用 setClip() 方法的情况下提出了一个非常好的解决方案。它涉及将我的背景绘制到一个中间 Graphics2D 对象，使用 setComposite() 来指定我想要如何屏蔽像素，然后在顶部使用 drawLine() 绘制我的线。一旦我有了这条线，我就通过 drawImage 将它重新绘制在我原来的 Graphics 对象之上。这是一个例子：

```
BufferedImage mask = g2d.getDeviceConfiguration().createCompatibleImage(width, height, BufferedImage.TRANSLUCENT);
Graphics2D maskGraphics = (Graphics2D) mask.getGraphics();
maskGraphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

maskGraphics.setStroke(new BasicStroke(lineWidth));
maskGraphics.setPaint(Color.BLACK);

// Draw line onto mask surface first.
Point prev = line.get(0);
for(int i = 1; i < line.size(); i++)
{
    Point current = line.get(i);
    maskGraphics.drawLine(prev.x, prev.y, current.x, current.y);
        prev = current;
}

// AlphaComposite.SrcIn:    "If pixels in the source and the destination overlap, only the source pixels
//                          in the overlapping area are rendered."
maskGraphics.setComposite(AlphaComposite.SrcIn);

maskGraphics.setPaint(top);
maskGraphics.fillRect(0, 0, width, referenceY);

maskGraphics.setPaint(bottom);
maskGraphics.fillRect(0, referenceY, width, height);

g2d.drawImage(mask, null, 0, 0);
maskGraphics.dispose(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-14T17:32:31.657

也许您可以使用 Stroke.createClippedShape 来执行此操作？（可能需要使用区域从原始形状中减去描边形状，具体取决于您要执行的操作。

# c# - 根据 USPS 州缩写验证字符串

> ID：176106
> 
> 赞同：14
> 
> 时间：2008-10-06T20:41:18.070
> 
> 标签：c#, .net

我需要能够根据可能的美国邮政服务州缩写列表来验证字符串，而 Google 没有为我提供任何指导。

我知道一个明显的解决方案：那就是编写一个非常庞大的 if（或 switch）语句来检查和比较所有 50 个状态，但我问的是 StackOverflow，因为必须有一种更简单的方法来做到这一点。是否有任何 RegEx 或枚举器对象可以用来以最有效的方式快速执行此操作？

[顺便说一下C#和.net 3.5]

[USPS 州缩写列表](https://www.usps.com/send/official-abbreviations.htm)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-06T21:34:12.957

我喜欢这样的东西：

```
private static String states = "|AL|AK|AS|AZ|AR|CA|CO|CT|DE|DC|FM|FL|GA|GU|HI|ID|IL|IN|IA|KS|KY|LA|ME|MH|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|MP|OH|OK|OR|PW|PA|PR|RI|SC|SD|TN|TX|UT|VT|VI|VA|WA|WV|WI|WY|";

public static bool isStateAbbreviation (String state)
{
  return state.Length == 2 && states.IndexOf( state ) > 0;
} 
```

此方法的优点是使用优化的系统例程，该例程可能使用单个机器指令进行搜索。如果我正在处理非固定长度的单词，那么我会检查“|” +状态+“|” 以确保我没有击中子字符串而不是完全匹配。由于字符串连接，这将花费更长的时间，但它仍然会在固定的时间内匹配。如果要验证小写缩写以及大写，请检查 state.UpperCase()，或将“states”字符串加倍以包含小写变体。

我保证无论您运行多少次，这每次都将击败 Regex 或 Hashtable 查找，并且它的内存使用量最少。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-06T20:45:54.957

我会用有效的缩写填充一个哈希表，然后用输入检查它以进行验证。如果每个字典版本有多个检查，它会更干净，可能更快。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-06T20:53:45.923

HashSet<string> 是我能想到的在 .NET 3.5 中使用内置类型的最简洁方式。（您也可以轻松地使其不区分大小写，或者将其更改为 Dictionary<string, string> ，其中值是全名。这也是 .NET 2.0/3.0 最合适的解决方案。）

至于速度——你真的相信这会成为你代码的瓶颈吗？HashSet 可能执行“相当好”（每秒数百万次查找）。我确信替代方案会更快 - 但更脏。我会坚持使用最简单的方法，直到您有理由相信它会成为瓶颈。

（编辑明确提及 Dictionary<,>。）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T20:45:50.340

这是一个正则表达式。享受！

```
^(?-i:A[LKSZRAEP]|C[AOT]|D[EC]|F[LM]|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEHINOPST]|N[CDEHJMVY]|O[HKR]|P[ARW]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-08T00:59:53.050

我知道这真的很老了，但我来看看是否有比我在 80 年代想出的更好的解决方案。在 C 语言中，它类似于（未经测试的代码）：

```
/* assumes 2 letter code is in upper case, returns 1 if valid or 0 if not */
int validate_state( const char *state )
{
    if (state[0] == ' ' || state[1] == ' ' || state[2] != '\0') return 0;
    return strstr("WVALAKSCARIDE CTNVTX NHINMNCOKY MSD MIA MOR WIL GAZ FL ME MD MA MT NE NJ NY ND OH PA UT WA WY", state) ? 1 : 0;
} 
```

在 C# 中可以这样写：

```
/* assumes 2 letter code is in upper case */
bool ValidateState(string state)
{
    const string ValidStatesMerged = "WVALAKSCARIDE CTNVTX NHINMNCOKY MSD MIA MOR WIL GAZ FL ME MD MA MT NE NJ NY ND OH PA UT WA WY";

    if (state == null)
        throw new ArgumentNullException(nameof(state));
    if (state.Length != 2 || state[0] == ' ' || state[1] == ' ')
        return false;
    return ValidStatesMerged.IndexOf(state) >= 0;
} 
```

只要`state`字符串全部大写，就不会使用正则表达式，而仅使用简单的字符串函数。诀窍是确保那里没有无效的组合，但是如果你从列表开始并重新排列它们，这样一个的结尾就是下一个的开始，就像`"WV"`then一样`"VA"`，然后删除重复字母，这样就很容易了你最终得到`"WVA"`...继续，直到他们都在，希望你能做的最短的字符串。

将其适应其他语言并不难；我需要在 bash 脚本中使用它，并将使用 Perl 命令通过上述“搜索字符串”来执行此操作。

# .net - ABCpdf 时不时会耗尽内存

> ID：176113
> 
> 赞同：2
> 
> 时间：2008-10-06T20:41:57.897
> 
> 标签：.net, asp.net, memory, pdf, abcpdf

我正在进行的项目是使用第 3 方组件在名为 ABCpdf.Net 的 VB.Net 网络系统中构建动态 PDF。（不是一个糟糕的工具，但也不是一个伟大的工具。）

有时，由于我无法理解的原因，文档对象会抛出 SEHException。进一步挖掘，事实证明这是由 WebSupergoo.ABCpdf6.Internal.PDFException 类型的文档对象中的自定义异常引起的。内容仅包含不太有用的标题“无法获取图像数据。内存不足”通常在尝试将图像添加到 PDF 时发生。由于这些图像是小于 100k 的 PNG，我猜它们的大小不是问题。

此外，真正奇怪的是，一旦这个问题开始发生，让它停止的唯一方法似乎是重新启动 Web 服务器，这显然有点低于标准。

有没有人遇到过这个问题（甚至使用过这个工具？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T21:27:08.493

迷人。我得出的结论是一定会发生什么。你还在 using 块的末尾调用 doc.Clear() 吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T18:44:13.547

三个月后更新：

据我所知，当我们从 ABCpdf 6 升级到 7 时，内存问题都得到了解决。似乎版本 7 不再是带有 .NET 包装器的 COM 对象，而是所有自下而上的托管代码。它仍然不是最好的 PDF 生成器，但资源处理问题似乎已经解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T20:51:49.127

我以前没有特别看到过这个错误，但是我们以前遇到过 ABC PDF 的内存问题。

长话短说，它不是一个完全托管的代码库，而只是一个围绕其 COM 版本的 .NET 包装器。话虽如此，我们将内存使用问题追溯到没有正确处理它们的对象。

所以，而不是：

```
 Dim doc As New Doc()
'etc... 
```

做这个：

```
 Dim doc as Doc
    Using doc As New Doc()
      'etc...
    End Using 
```

# c - 什么时候可以在 C 中使用全局变量？

> ID：176118
> 
> 赞同：60
> 
> 时间：2008-10-06T20:43:26.163
> 
> 标签：c, global-variables

显然那里有很多不同的意见，从“**从不！总是封装（即使它只是一个宏！）** ”到“**这没什么大不了的——在比不方便的时候使用它们。** ”

所以。

具体的，具体的原因（最好有例子）

*   为什么全局变量很危险
*   *什么时候应该*使用全局变量来代替替代品
*   对于那些试图不恰当地使用全局变量的人来说，有哪些替代方案

虽然这是主观的，但我会选择一个答案（对我来说，这最能代表每个开发人员应该与全局变量之间的爱恨关系），社区将投票给他们。

我相信新手拥有这种参考很重要，但如果存在与您的答案基本相似的另一个答案，请不要弄乱它 - 添加评论或编辑其他人的答案。

-亚当

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-06T20:58:01.390

变量应始终具有较小的范围。其背后的论点是，每次增加范围时，都会有更多可能修改变量的代码，因此解决方案会产生更多的复杂性。

因此很明显，如果设计和实现自然允许，避免使用全局变量是首选。因此，除非确实需要，否则我不喜欢使用全局变量。

我也不同意“从不”的说法。与任何其他概念一样，全局变量仅应在需要时使用。我宁愿使用全局变量而不是使用一些人为的构造（比如传递指针），这只会掩盖真正的意图。

使用全局变量的一些很好的例子是单例模式实现或嵌入式系统中的寄存器访问。

关于如何实际检测全局变量的过度使用：检查，检查，检查。每当我看到一个全局变量时，我都会问自己：在全局范围内真的需要它吗？

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-06T22:15:37.040

使全局变量起作用的唯一方法是给它们命名以确保它们是唯一的。

该名称通常具有与某些“模块”或全局变量特别关注或有意义的函数集合相关联的前缀。

这意味着变量“属于”这些函数——它是它们的一部分。实际上，全局通常可以用一个与其他函数一起使用的小函数“包装”——在同一个`.h`文件的同名前缀中。

奖金。

当你这样做时，突然间，它不再是*真正*的全球性了。它现在是一些相关功能模块的一部分。

这*总是*可以做到的。稍加思考，每个以前的全局变量都可以分配给一些函数集合，分配给特定`.h`文件，并与允许您在不破坏任何内容的情况下更改变量的函数隔离。

与其说“从不使用全局变量”，不如说“将全局变量的职责分配给最有意义的某个模块”。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-06T21:35:40.193

考虑一下这个公案：“如果范围足够窄，那么一切都是全局的”。

在这个时代仍然很有可能需要编写一个非常快速的实用程序来完成一次性工作。

在这种情况下，创建对变量的安全访问所需的能量大于在如此小的实用程序中调试问题所节省的能量。

这是我能临时想到的唯一一种全局变量是明智的情况，而且这种情况相对较少。有用的、新颖的程序小到可以完全保存在大脑的短期记忆中，但它们越来越少了，但它们仍然存在。

事实上，我可以大胆地说，如果程序没有这么小，那么全局变量应该是非法的。

*   如果变量永远不会改变，那么它是一个常数，而不是一个变量。
*   如果变量需要通用访问，那么应该存在两个子程序来获取和设置它，并且它们应该是同步的。
*   如果程序一开始很小，以后可能会变大，那么就好像今天的程序很大一样进行编码，并取消全局变量。并非所有程序都会增长！（当然，这假设程序员有时愿意丢弃代码。）

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-06T20:44:45.427

如果多个方法需要一个变量（而不是将变量传递给每个方法），C 中的全局变量有助于使代码更具可读性。但是，它们很危险，因为所有位置都可以修改该变量，从而可能难以追踪错误。如果您必须使用全局变量，请始终确保仅由一种方法直接修改它，并让所有其他调用者使用该方法。这将使调试与该变量更改相关的问题变得更加容易。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-06T21:29:39.737

**当您不担心线程安全代码**时：在任何有意义的地方使用它们，换句话说，在任何可以将某些东西表达为全局状态的地方使用它们。

**当您的代码可能是多线程**时：不惜一切代价避免。将全局变量抽象到工作队列或其他一些线程安全的结构中，或者如果绝对必要的话将它们包装在锁中，记住这些可能是程序中的瓶颈。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-06T20:56:28.430

我来自“从不”阵营，直到我开始在国防工业工作。有一些行业标准要求软件使用全局变量而不是动态（C 语言中的 malloc）内存。我不得不为我从事的一些项目重新考虑动态内存分配的方法。如果您可以使用适当的信号量、线程等来保护“全局”内存，那么这可能是一种可以接受的内存管理方法。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-12-03T08:55:44.497

代码复杂性并不是唯一需要关注的优化。对于许多应用程序，性能优化具有更高的优先级。但更重要的是，在许多情况下，使用全局变量可以大大降低代码复杂性。有许多，也许是专门的，全局变量不仅是可接受的解决方案，而且是首选的情况。我最喜欢的专门示例是它们用于在应用程序的主线程与在实时线程中运行的音频回调函数之间提供通信。

建议全局变量在多线程应用程序中是一种责任是误导性的，因为任何变量，无论范围如何，如果它在多个线程上发生变化，都是潜在的责任。

谨慎使用全局变量。应尽可能使用数据结构来组织和隔离全局命名空间的使用。

可变作用域为程序员提供了非常有用的保护——但它可能有代价。今晚我来写关于全局变量的文章，因为我是一位经验丰富的 Objective-C 程序员，经常对面向对象在数据访问上设置的障碍感到沮丧。我认为，反全球的狂热主要来自年轻的、理论丰富的程序员，他们主要是孤立地使用面向对象的 API，而没有深入的系统级 API 及其在应用程序开发中的交互的实践经验。但我不得不承认，当供应商草率地使用命名空间时，我会感到沮丧。例如，一些 Linux 发行版在全球范围内预定义了“PI”和“TWOPI”，这破坏了我的大部分个人代码。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-01-13T21:57:50.773

*   **何时不使用：**全局变量是危险的，因为了解全局变量如何更改的唯一方法是跟踪声明它们的 .c 文件中的整个源代码（或所有 .c 文件，如果它是 extern as好）。如果您的代码出现错误，您必须搜索整个源文件以查看哪些函数更改了它，以及何时更改。出错时进行调试是一场噩梦。我们常常理所当然地认为局部变量概念背后的独创性优雅地超出范围 -*很容易追踪*
*   **何时使用：当**全局变量的利用率没有被过度屏蔽并且使用局部变量的成本过于复杂以至于损害可读性时，应该使用全局变量。我的意思是必须向函数参数添加一个额外的参数，并返回和传递指针等等。三个经典示例：当我使用 pop 和 push 堆栈时 - 这是函数之间共享的。当然，我可以使用局部变量，但我必须将指针作为附加参数传递。第二个经典示例可以在 K&R 的“The C Programming Language”中找到，他们定义了*getch()*和*ungetch()*共享全局字符缓冲区数组的函数。再一次，我们不需要让它成为全局的，但是当它很难弄乱缓冲区的使用时，增加的复杂性值得吗？第三个示例是您可以在 Arduino 爱好者的嵌入式空间中找到的东西。主*循环*函数中的许多函数都共享*millis()*函数，这是调用该函数的瞬时时间。因为时钟速度不是无限的，所以*millis()*在单个循环中会*有所不同。*为了使其保持不变，请在每个循环*之前*拍摄时间快照并将其保存在全局变量中。时间快照现在将与许多功能访问时相同。
*   **替代品：**不多。尽可能坚持局部范围，尤其是在项目开始时，而不是相反。随着项目的发展，如果您觉得使用全局变量可以降低复杂性，那么就这样做，但前提是它满足第二点的要求。请记住，与不负责任地使用全局变量相比，使用局部范围和拥有更复杂的代码的危害要小一些。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-06T20:55:51.787

您还需要考虑在什么上下文中使用全局变量。将来您是否希望此代码重复。

例如，如果您在系统中使用套接字来访问资源。将来您是否希望访问多个这些资源，如果答案是肯定的，我首先会远离全局变量，因此不需要进行重大重构。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-06T20:50:24.933

它和其他任何经常被过度使用的工具一样，但我不认为它们是邪恶的。

例如，我有一个真正像在线数据库一样的程序。数据存储在内存中，但其他程序可以对其进行操作。有一些内部例程的行为很像数据库中的存储过程和触发器。

这个程序有数百个全局变量，但如果你仔细想想，什么是数据库，但有大量的全局变量。

这个程序已经通过许多版本使用了大约十年，它从来没有成为问题，我会在一分钟内再做一次。

我承认在这种情况下，全局变量是具有用于更改对象状态的方法的对象。因此，在调试时跟踪谁更改了对象不是问题，因为我总是可以在更改对象状态的例程上设置断点。或者更简单，我只需打开记录更改的内置日志记录。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-06T21:05:09.753

当多个函数需要访问数据或写入对象时，应使用全局变量。例如，如果您必须传递数据或对多个函数的引用，例如单个日志文件、连接池或需要跨应用程序访问的硬件引用。这可以防止非常长的函数声明和重复数据的大量分配。

除非绝对必要，否则通常*不应*使用全局变量，因为只有在明确告知这样做或程序结束时才会清理全局变量。如果您正在运行多线程应用程序，则多个函数可以同时写入变量。如果您有错误，则跟踪该错误可能会更加困难，因为您不知道哪个函数正在更改变量。除非您使用显式为​​全局变量指定唯一名称的命名约定，否则您还会遇到命名冲突的问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-06T21:20:12.487

当你声明常量时。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-02-19T17:28:20.363

我能想到几个原因：

调试/测试目的（警告-尚未测试此代码）：

```
#include <stdio.h>
#define MAX_INPUT 46
int runs=0;
int fib1(int n){
    ++runs;
    return n>2?fib1(n-1)+fib1(n-2):1;
};
int fib2(int n,int *cache,int *len){
    ++runs;
    if(n<=2){
        if(*len==2)
            return 1;
        *len=2;
        return cache[0]=cache[1]=1;
    }else if(*len>=n)
        return cache[n-1];
    else{
        if(*len!=n-1)
            fib2(n-1,cache,len);
        *len=n;
        return cache[n-1]=cache[n-2]+cache[n-3];
    };
};
int main(){
    int n;
    int cache[MAX_INPUT];
    int len=0;
    scanf("%i",&n);
    if(!n||n>MAX_INPUT)
        return 0;
    printf("fib1(%i)==%i",n,fib1(n));
    printf(", %i run(s)\n",runs);
    runs=0;
    printf("fib2(%i)==%i",n,fib2(n,&cache,&len));
    printf(", %i run(s)\n",runs);
    main();
}; 
```

我为 fib2 使用了作用域变量，但这是全局变量可能有用的另一种情况（需要存储数据以避免永远占用的纯数学函数）。

只使用一次的程序（例如用于比赛），或者需要缩短开发时间时

全局变量可用作类型化常量，其中某处的函数需要 *int 而不是 int。

如果我打算使用该程序超过一天，我通常会避免使用全局变量。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-12-26T15:18:01.590

我相信我们公司有一个边缘案例，这阻止了我进入“从不使用全局变量阵营”。

我们需要编写一个在我们的盒子中工作的嵌入式应用程序，从医院的设备中提取医疗数据。

这应该无限运行，即使医疗设备被关闭、网络消失或我们盒子的设置发生变化。设置是从 .txt 文件中读取的，该文件可以在运行时更改，最好没有问题。

这就是为什么单例模式对我没用。所以我们不时返回（读取 1000 条数据后）并读取设置，如下所示：

```
public static SettingForIncubator settings;

public static void main(String[] args) {
    while(true){
        SettingsForIncubator settings = getSettings(args);

        int counter=0;

        while(medicalDeviceIsGivingData && counter < 1000){
            readData(); //using settings

            //a lot of of other functions that use settings.

            counter++;
        }
    } 
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-21T02:23:54.727

全局常量很有用 - 与预处理器宏相比，您可以获得更多的类型安全性，并且如果您决定需要更改值，它仍然同样容易。

全局变量有一些用途，例如，如果程序的许多部分的操作取决于状态机中的特定状态。只要您限制可以修改变量跟踪涉及它的错误的位置的数量就不会太糟糕。

几乎只要您创建多个线程，全局变量就会变得危险。在这种情况下，您确实应该将范围限制为（最多）一个文件全局变量（通过将其声明为静态）和 getter/setter 方法来保护它免受可能危险的多次访问。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-10-06T20:49:18.023

我在这里“从不”阵营；如果你需要一个全局变量，至少使用一个[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)。这样，您就可以获得延迟实例化的好处，并且不会弄乱全局命名空间。

# database - 专业的数据库，如 BigTable、SimpleDB

> ID：176131
> 
> 赞同：16
> 
> 时间：2008-10-06T20:47:50.477
> 
> 标签：database, scalability, bigtable, amazon-simpledb, key-value-store

Google BigTable 和 Amazon SimpleDB 等新的学校数据存储范例是专门为可扩展性而设计的。基本上，不允许连接和非规范化是实现此目的的方式。

然而，在[这个](https://stackoverflow.com/questions/173726/why-are-database-joins-expensive)主题中，共识似乎是大表上的连接不一定必须太昂贵，并且非规范化在某种程度上被“高估”了为什么这些上述系统不允许连接并强制将所有内容放在一起单表实现可扩展性？是需要存储在这些系统中的大量数据（数 TB）吗？
数据库的一般规则是否根本不适用于这些规模？是因为这些数据库类型是专门为存储许多相似的对象而定制的吗？
还是我错过了更大的图景？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-06T22:36:01.427

分布式数据库并不像 Orion 所暗示的那样天真。在优化分布式数据集上的完全关系查询方面已经做了很多工作。您可能想看看 Teradata、Netezza、Greenplum、Vertica、AsterData 等公司在做什么。（甲骨文最终也加入了这场游戏，他们最近宣布了这一消息；微软以曾经被称为 DataAllegro 的公司的名义购买了他们的 solition）。

话虽如此，当数据扩展到 TB 时，这些问题变得非常重要。如果您不需要可以从 RDBM 获得的严格事务性和一致性保证，那么反规范化和不进行连接通常要容易得多。特别是如果您不需要太多交叉引用。特别是如果您不进行临时分析，但需要通过任意转换进行编程访问。

非规范化被高估了。仅仅因为在处理 100 Tera 时会发生这种情况，并不意味着每个从不费心学习数据库并且由于架构规划和查询优化不佳而无法查询一百万或两行的开发人员都应该使用这个事实.

但是，如果您在 100 Tera 范围内，无论如何...

哦，这些技术引起轰动的另一个原因——人们发现有些东西一开始就不属于数据库，并意识到他们不是在处理特定领域的关系，而是用基本的键——值对。对于不应该在数据库中的东西，完全有可能 Map-Reduce 框架或一些持久的、最终一致的存储系统就是这样。

在全球范围内，我强烈推荐 BerkeleyDB 来解决这类问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T22:02:10.780

我对它们不太熟悉（我只阅读了与其他人相同的博客/新闻/示例），但我的看法是，他们选择以可扩展性的名义牺牲许多正常的关系数据库功能 -我会试着解释一下。

假设您的数据表中有 200 行。

在 google 的数据中心中，其中 50 行存储在服务器 A 上，50 行存储在 B 上，100 行存储在服务器 C 上。此外，服务器 D 包含来自服务器 A 和 B 的数据的冗余副本，服务器 E 包含服务器 C 上的数据的冗余副本。

（在现实生活中，我不知道将使用多少台服务器，但它设置为处理数百万行，所以我想象不少）。

要“选择 * where name = 'orion'”，基础设施可以将该查询发送到所有服务器，并汇总返回的结果。这使他们可以在任意数量的服务器上进行线性扩展（仅供参考，这几乎就是 mapreduce）

然而，这意味着您需要一些权衡。

如果您需要对一些数据进行关系连接，这些数据分布在 5 台服务器上，那么这些服务器中的每台都需要从彼此*的每一行*中提取数据。当您有 200 万行分布在 10 台服务器上时，请尝试这样做。

这导致权衡#1 - 没有连接。

此外，根据网络延迟、服务器负载等，您的一些数据可能会立即保存，但有些可能需要一两秒钟。同样，当您有数十台服务器时，这会变得越来越长，而通常的方法是“每个人都等到最慢的人完成”不再是可以接受的。

这导致了权衡 #2 - 您的数据在写入后可能并不总是立即可见。

我不确定还有什么其他的权衡，但在我的脑海中，这些是主要的 2。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T11:53:38.633

所以我得到的是整个“非规范化，无连接”的哲学存在，不是因为连接本身不能在大型系统中扩展，而是因为它们实际上不可能在分布式数据库中实现。

当您存储单一类型的大部分不变数据时，这似乎很合理（就像 Google 所做的那样）。我在正确的轨道上吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T01:30:27.130

如果您谈论的是几乎只读的数据，则规则会发生变化。在数据更改的情况下，非规范化是最难的，因为所需的工作增加并且锁定问题更多。如果数据几乎没有变化，那么非规范化就不是什么大问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-04-29T10:58:51.270

Novaday 你需要为数据库寻找更多的互操作环境。更频繁地，您不仅需要 MySQL 或 MS SQL 等关系数据库，还需要 Hadoop 等大数据场或 MongoDB 等非关系数据库。在某些情况下，所有这些数据库都将在一个解决方案中使用，因此它们的性能在宏观范围内必须尽可能相同。这意味着，您将无法使用 Azure SQL 作为关系数据库和一个具有 2 个内核和 3GB RAM 的 MongoDB 虚拟机。您必须扩大您的解决方案并在可能的情况下使用数据库即服务（如果不可能，则在云中构建您自己的集群）。

# javascript - Which wysiwyg editor works best on Adobe AIR?

> ID：176135
> 
> 赞同：2
> 
> 时间：2008-10-06T20:49:22.830
> 
> 标签：javascript, air

There are tons of free wysiwyg editors you can embed in web pages. I'm looking for something that is easiest to embed into an adobe air app. Means something that works in webkit and is easy to get the content from with javascript.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T07:27:34.007

我想我可以回答我自己的问题。Fckeditor 是经过验证的最佳解决方案。Tinymce 违反了 air 的安全沙箱，你必须在 air 的 iframe 中驱动它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T02:31:36.547

而 Flex/AIR 自带的那个不行？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T06:02:00.030

[TinyMCE](http://tinymce.moxiecode.com/examples/simple.php)不错。它非常流行，甚至与[Symfony PHP 框架](http://www.symfony-project.org/)一起使用。不知道它会如何与 AIR 一起工作，但机会真的很好。像魅力一样与 Chrome 和 Safari 一起使用。

编辑：...还有一个[轻量级的 jQuery 编辑器插件](http://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html)。[以及 StackOverflow 上使用的来自 Attacklab](http://wmd-editor.com/demo) (WYSIWYM)的wmd 编辑器。

# java - Java，将纬度/经度转换为 UTM

> ID：176137
> 
> 赞同：28
> 
> 时间：2008-10-06T20:50:24.527
> 
> 标签：java, geolocation, latitude-longitude, geography, geotools

有谁知道在 Java 中将地球表面位置从 lat、lon 转换为 UTM 的方法（比如在 WGS84 中）？我目前正在研究 Geotools，但不幸的是解决方案并不明显。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2015-01-29T21:03:26.490

没有图书馆，什么都没有。复制这个！

使用这两个类，您可以将度数（纬度/经度）转换为 UTM，反之亦然！

```
private class Deg2UTM
{
    double Easting;
    double Northing;
    int Zone;
    char Letter;
    private  Deg2UTM(double Lat,double Lon)
    {
        Zone= (int) Math.floor(Lon/6+31);
        if (Lat<-72) 
            Letter='C';
        else if (Lat<-64) 
            Letter='D';
        else if (Lat<-56)
            Letter='E';
        else if (Lat<-48)
            Letter='F';
        else if (Lat<-40)
            Letter='G';
        else if (Lat<-32)
            Letter='H';
        else if (Lat<-24)
            Letter='J';
        else if (Lat<-16)
            Letter='K';
        else if (Lat<-8) 
            Letter='L';
        else if (Lat<0)
            Letter='M';
        else if (Lat<8)  
            Letter='N';
        else if (Lat<16) 
            Letter='P';
        else if (Lat<24) 
            Letter='Q';
        else if (Lat<32) 
            Letter='R';
        else if (Lat<40) 
            Letter='S';
        else if (Lat<48) 
            Letter='T';
        else if (Lat<56) 
            Letter='U';
        else if (Lat<64) 
            Letter='V';
        else if (Lat<72) 
            Letter='W';
        else
            Letter='X';
        Easting=0.5*Math.log((1+Math.cos(Lat*Math.PI/180)*Math.sin(Lon*Math.PI/180-(6*Zone-183)*Math.PI/180))/(1-Math.cos(Lat*Math.PI/180)*Math.sin(Lon*Math.PI/180-(6*Zone-183)*Math.PI/180)))*0.9996*6399593.62/Math.pow((1+Math.pow(0.0820944379, 2)*Math.pow(Math.cos(Lat*Math.PI/180), 2)), 0.5)*(1+ Math.pow(0.0820944379,2)/2*Math.pow((0.5*Math.log((1+Math.cos(Lat*Math.PI/180)*Math.sin(Lon*Math.PI/180-(6*Zone-183)*Math.PI/180))/(1-Math.cos(Lat*Math.PI/180)*Math.sin(Lon*Math.PI/180-(6*Zone-183)*Math.PI/180)))),2)*Math.pow(Math.cos(Lat*Math.PI/180),2)/3)+500000;
        Easting=Math.round(Easting*100)*0.01;
        Northing = (Math.atan(Math.tan(Lat*Math.PI/180)/Math.cos((Lon*Math.PI/180-(6*Zone -183)*Math.PI/180)))-Lat*Math.PI/180)*0.9996*6399593.625/Math.sqrt(1+0.006739496742*Math.pow(Math.cos(Lat*Math.PI/180),2))*(1+0.006739496742/2*Math.pow(0.5*Math.log((1+Math.cos(Lat*Math.PI/180)*Math.sin((Lon*Math.PI/180-(6*Zone -183)*Math.PI/180)))/(1-Math.cos(Lat*Math.PI/180)*Math.sin((Lon*Math.PI/180-(6*Zone -183)*Math.PI/180)))),2)*Math.pow(Math.cos(Lat*Math.PI/180),2))+0.9996*6399593.625*(Lat*Math.PI/180-0.005054622556*(Lat*Math.PI/180+Math.sin(2*Lat*Math.PI/180)/2)+4.258201531e-05*(3*(Lat*Math.PI/180+Math.sin(2*Lat*Math.PI/180)/2)+Math.sin(2*Lat*Math.PI/180)*Math.pow(Math.cos(Lat*Math.PI/180),2))/4-1.674057895e-07*(5*(3*(Lat*Math.PI/180+Math.sin(2*Lat*Math.PI/180)/2)+Math.sin(2*Lat*Math.PI/180)*Math.pow(Math.cos(Lat*Math.PI/180),2))/4+Math.sin(2*Lat*Math.PI/180)*Math.pow(Math.cos(Lat*Math.PI/180),2)*Math.pow(Math.cos(Lat*Math.PI/180),2))/3);
        if (Letter<'M')
            Northing = Northing + 10000000;
        Northing=Math.round(Northing*100)*0.01;
    }
}

private class UTM2Deg
{
    double latitude;
    double longitude;
    private  UTM2Deg(String UTM)
    {
        String[] parts=UTM.split(" ");
        int Zone=Integer.parseInt(parts[0]);
        char Letter=parts[1].toUpperCase(Locale.ENGLISH).charAt(0);
        double Easting=Double.parseDouble(parts[2]);
        double Northing=Double.parseDouble(parts[3]);           
        double Hem;
        if (Letter>'M')
            Hem='N';
        else
            Hem='S';            
        double north;
        if (Hem == 'S')
            north = Northing - 10000000;
        else
            north = Northing;
        latitude = (north/6366197.724/0.9996+(1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)-0.006739496742*Math.sin(north/6366197.724/0.9996)*Math.cos(north/6366197.724/0.9996)*(Math.atan(Math.cos(Math.atan(( Math.exp((Easting - 500000) / (0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting - 500000) / (0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2)/3))-Math.exp(-(Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*( 1 -  0.006739496742*Math.pow((Easting - 500000) / (0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2)/3)))/2/Math.cos((north-0.9996*6399593.625*(north/6366197.724/0.9996-0.006739496742*3/4*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.pow(0.006739496742*3/4,2)*5/3*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996 )/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4-Math.pow(0.006739496742*3/4,3)*35/27*(5*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/3))/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2))+north/6366197.724/0.9996)))*Math.tan((north-0.9996*6399593.625*(north/6366197.724/0.9996 - 0.006739496742*3/4*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.pow(0.006739496742*3/4,2)*5/3*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996 )*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4-Math.pow(0.006739496742*3/4,3)*35/27*(5*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/3))/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2))+north/6366197.724/0.9996))-north/6366197.724/0.9996)*3/2)*(Math.atan(Math.cos(Math.atan((Math.exp((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2)/3))-Math.exp(-(Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2)/3)))/2/Math.cos((north-0.9996*6399593.625*(north/6366197.724/0.9996-0.006739496742*3/4*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.pow(0.006739496742*3/4,2)*5/3*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4-Math.pow(0.006739496742*3/4,3)*35/27*(5*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/3))/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2))+north/6366197.724/0.9996)))*Math.tan((north-0.9996*6399593.625*(north/6366197.724/0.9996-0.006739496742*3/4*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.pow(0.006739496742*3/4,2)*5/3*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4-Math.pow(0.006739496742*3/4,3)*35/27*(5*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/3))/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2))+north/6366197.724/0.9996))-north/6366197.724/0.9996))*180/Math.PI;
        latitude=Math.round(latitude*10000000);
        latitude=latitude/10000000;
        longitude =Math.atan((Math.exp((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2)/3))-Math.exp(-(Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2)/3)))/2/Math.cos((north-0.9996*6399593.625*( north/6366197.724/0.9996-0.006739496742*3/4*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.pow(0.006739496742*3/4,2)*5/3*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2* north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4-Math.pow(0.006739496742*3/4,3)*35/27*(5*(3*(north/6366197.724/0.9996+Math.sin(2*north/6366197.724/0.9996)/2)+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/4+Math.sin(2*north/6366197.724/0.9996)*Math.pow(Math.cos(north/6366197.724/0.9996),2)*Math.pow(Math.cos(north/6366197.724/0.9996),2))/3)) / (0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2))))*(1-0.006739496742*Math.pow((Easting-500000)/(0.9996*6399593.625/Math.sqrt((1+0.006739496742*Math.pow(Math.cos(north/6366197.724/0.9996),2)))),2)/2*Math.pow(Math.cos(north/6366197.724/0.9996),2))+north/6366197.724/0.9996))*180/Math.PI+Zone*6-183;
        longitude=Math.round(longitude*10000000);
        longitude=longitude/10000000;       
    }   
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-07T01:43:31.080

[根据一些示例代码](http://svn.geotools.org/trunk/demo/referencing/src/main/java/org/geotools/demo/referencing/CTSTutorial.java)，我能够使用 Geotools 2.4 来获得一些有用的东西。

```
double utmZoneCenterLongitude = ...  // Center lon of zone, example: zone 10 = -123
int zoneNumber = ...                 // zone number, example: 10
double latitude, longitude = ...     // lat, lon in degrees

MathTransformFactory mtFactory = ReferencingFactoryFinder.getMathTransformFactory(null);
ReferencingFactoryContainer factories = new ReferencingFactoryContainer(null);

GeographicCRS geoCRS = org.geotools.referencing.crs.DefaultGeographicCRS.WGS84;
CartesianCS cartCS = org.geotools.referencing.cs.DefaultCartesianCS.GENERIC_2D;

ParameterValueGroup parameters = mtFactory.getDefaultParameters("Transverse_Mercator");
parameters.parameter("central_meridian").setValue(utmZoneCenterLongitude);
parameters.parameter("latitude_of_origin").setValue(0.0);
parameters.parameter("scale_factor").setValue(0.9996);
parameters.parameter("false_easting").setValue(500000.0);
parameters.parameter("false_northing").setValue(0.0);

Map properties = Collections.singletonMap("name", "WGS 84 / UTM Zone " + zoneNumber);
ProjectedCRS projCRS = factories.createProjectedCRS(properties, geoCRS, null, parameters, cartCS);

MathTransform transform = CRS.findMathTransform(geoCRS, projCRS);

double[] dest = new double[2];
transform.transform(new double[] {longitude, latitude}, 0, dest, 0, 1);

int easting = (int)Math.round(dest[0]);
int northing = (int)Math.round(dest[1]); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-15T14:51:58.273

坐标的变换实际上只需要几行代码就可以完成：

```
Coordinate coordinate = new Coordinate(x, y);
MathTransform transform = CRS.findMathTransform(CRS.decode("EPSG:4326"), CRS.decode("EPSG:3857"), false);
JTS.transform(coordinate, coordinate, transform); 
```

这会将经度/纬度坐标 (EPSG:4326) 转换为 Web 墨卡托投影 (EPSG:3857) 坐标。

您只需要在构建工具（例如 maven）中依赖以下两个 GeoTools 库即可：

```
<repositories>
    <repository>
        <id>osgeo</id>
        <name>Open Source Geospatial Foundation Repository</name>
        <url>http://download.osgeo.org/webdav/geotools/</url>
    </repository>
</repositories>

<dependencies>
    <dependency>
        <groupId>org.geotools</groupId>
        <artifactId>gt-api</artifactId>
        <version>${geotools.version}</version>
    </dependency>
    <dependency>
        <groupId>org.geotools</groupId>
        <artifactId>gt-epsg-hsql</artifactId>
        <version>${geotools.version}</version>
    </dependency>
</dependencies> 
```

此答案基于gis.stackexchange.com上的[问题/回复。](https://gis.stackexchange.com/questions/151565/what-simple-and-light-java-library-to-use-for-wgs84-to-utm-conversion)发布我的回复是因为这里的当前答案似乎很冗长。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-20T10:08:16.200

对于我的项目，我使用了来自 Ahmed Taha的[LatLongLib库。](https://sites.google.com/site/ahmdalitaha2/latlonglib)我认为将坐标从 UTM 系统转换为经纬度系统非常容易，反之亦然。您只需要使用类 UTMUtils、UTMPoint 和 LatLonPoint。

前段时间我也考虑过选择[Jcoord](http://www.jstott.me.uk/jcoord/)。这也很简单直接。但是，我需要使用 WGS84 椭球，当时似乎只有 LatLongLib 具有该功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-19T14:17:01.083

您可以使用此项目[https://github.com/Berico-Technologies/Geo-Coordinate-Conversion-Java/](https://github.com/Berico-Technologies/Geo-Coordinate-Conversion-Java/)，使用 jitpack 将其添加到现有的 pom.xml 中。

我已经成功地将 UTM 坐标（30N，即 30 区域和北半球）转换为纬度和经度。请参阅下面的示例：

```
public void setPunto(Point punto) {
    this.punto = punto;
    LatLon latlon = UTMCoord.locationFromUTMCoord(30, AVKey.NORTH, punto.getX(), punto.getY());
    this.latitud = latlon.getLatitude().degrees;
    this.longitud = latlon.getLongitude().degrees;
} 
```

请注意，Point 类属于 com.vividsolutions.jts.geom.Point 类类型。

# java - Swing：有没有办法区分用户引起的 ItemEvent 和应用程序引起的 ItemEvent？

> ID：176150
> 
> 赞同：6
> 
> 时间：2008-10-06T20:55:34.640
> 
> 标签：java, swing, events, combobox, listeners

我正在使用基于 Swing 的应用程序中的组合框，我很难弄清楚如何区分从用户事件生成的 ItemEvent 与由应用程序引起的 ItemEvent。

例如，假设我有一个组合框“ `combo`”，并且我正在使用我的 ItemListener“ `listener`”监听 itemStateChanged 事件。当用户将选择更改为第 2 项或我执行该行（伪代码）时：

`combo.setSelection(2)`

..似乎我无法区分这些事件。

也就是说，无论如何我都不是 Swing 专家，所以我想我会问。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T21:33:56.903

无论用户选择 Item 2，还是 API 调用 setSelection(2)，**事件都会出现相同的**。

您的问题的解决方案可能是重新考虑您希望 itemStateChanged 代码在选择更改时执行的操作。为什么您的应用程序在每种情况下的工作方式都不同？也许您可以利用一些相似之处来发挥自己的优势。

**使用标志时要小心**。itemStateChanged 事件将在事件调度线程上发生，该线程与您设置标志状态的线程不同。这意味着使用标志可能不是 100% 可靠的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T08:40:29.540

作用和反应定律很清楚:)。如果您尝试对更改做出反应，则无需区分用户和应用程序。我可以想象只有一个用例需要“区分”。应用程序显示某些数据的情况。在这种情况下，您可能拥有应用程序的数据模型。此模型中还有一些更改侦听器，应用程序 GUI 将通过为组件设置值来做出反应。并且。如果用户在 GUI 组件中选择任何内容。数据模型将通过改变值做出反应。在这种情况下，很容易在数据模型上设置某种只读状态，这将通知模型忽略来自观察对象的任何事件。此通知集应在 EDT 中运行，并且标记没有问题。小例子：

```
class ApplicationDataModel {

    private Flag current = Flag.RW;

    public void setData(ApplicationData data) {
        current = Flag.RO;
        setDataImpl(data);
        notifyObservers();
        current = Flag.RW;
    }

    public void reaction(Event e) {
        if (flag = Flag.RO) return;
        ...
    }

} 
```

小心标记，不要忘记线程。如果你从另一个线程调用 setData ，那么 EDT 你会遇到麻烦。当然。对象的提取`ApplicationData`必须在不同的线程中运行；）。一般来说，重新考虑您的应用程序的设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T21:11:11.380

您可以在设置选择之前在代码中设置一个标志，然后在侦听器中检查此标志（如果已设置，请取消设置该标志）...

自 Java 6 以来可能有更好的方法，但这是我一直使用的方法......

**[编辑]**：正如大卫指出的那样，您需要使用 SwingUtilities.invokeLater 或类似方法在 EDT 中设置标志（并更新组合）（无论如何您都应该这样做，因为您正在更改 UI 控件）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T03:23:25.030

如果您需要区分事件，那么您的设计可能需要重新考虑。MVC 的重点是将模型的更改与用户的实际鼠标点击解耦。

*也许您应该根据为什么*要区分这两种情况来重申这个问题。然后，我们可以就实现目标的不同方式提供一些指导。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T13:58:41.113

所以我猜你希望用户选择执行一些操作，而不仅仅是简单的旧的直接状态更改。这是由有限的灵活性引起的问题（灵活性总是会受到限制，特别是如果您在其他方向上具有灵活性）。

我的建议：

首先，总是直接在 Swing 中使用模型。小部件非常复杂，您希望将不同的关注点分开。幸运的是 Swing 已经有了它的模型。

一种常见的模式是在模型之间进行委托。因此，在这种情况下，您拥有保存数据的“真实”默认模型。在 JComboBox 和真正的 ComboBoxModel 之间插入，并委托 ComboBoxModel 对状态更改指令执行操作。您的应用程序代码应该忽略 JComboBox 并绕过委托模型直接使用真正的 ComboBoxModel。所以在图表中：

```
用户 -- JComboBox -- ActionComboBoxModel -- DefaultComboBoxModel -- 应用程序代码

```

# c++ - 围绕现有数组的 STL 非复制包装器？

> ID：176158
> 
> 赞同：9
> 
> 时间：2008-10-06T20:56:15.747
> 
> 标签：c++, arrays, stl, iterator

是否可以为现有的 POD 类型元素数组创建一个类似 STL 的容器，甚至只是一个 STL 样式的迭代器？

例如，假设我有一个整数数组。能够调用一些 STL 函数（例如 find_if、count_if 或直接在此数组上排序）会很方便。

非解决方案：复制整个数组，甚至只是对元素的引用。目标是非常节省内存和时间，同时希望允许使用其他 STL 算法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-06T21:01:34.427

您可以直接在常规 C 样式数组上调用许多 STL 算法——它们就是为此而设计的。例如，：

```
int ary[100];
// init ...

std::sort(ary, ary+100); // sorts the array
std::find(ary, ary+100, pred); find some element 
```

我想你会发现大多数东西都如你所愿。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T21:03:09.930

所有 STL 算法都使用迭代器。
指针是指向对象数组的有效迭代器。

**注意**结束迭代器必须是数组末尾之后的一个元素。因此，以下代码中的数据+5。

```
#include <algorithm>
#include <iostream>
#include <iterator>

int main()
{
    int   data[] = {4,3,7,5,8};
    std::sort(data,data+5);

    std::copy(data,data+5,std::ostream_iterator<int>(std::cout,"\t"));
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-06T21:28:58.927

您可以使用内联函数模板，这样您就不必复制数组索引

```
template <typename T, int I>
inline T * array_begin (T (&t)[I])
{
  return t;
}

template <typename T, int I>
inline T * array_end (T (&t)[I])
{
  return t + I;
}

void foo ()
{
  int array[100];
  std::find (array_begin (array)
      , array_end (array)
      , 10);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T20:58:36.087

您可以使用[Boost.Array](http://www.boost.org/doc/libs/1_36_0/doc/html/array.html)创建具有 STL 语义的 C++ 数组类型。

使用数组：

```
int a[100];
for (int i = 0; i < 100; ++i)
    a[i] = 0; 
```

使用 boost.arrays：

```
boost::array<int,100> a;
for (boost::array<int,100>::iterator i = a.begin(); i != a.end(); ++i)
    *i = 0; 
```

**更新：**使用 C++11，您现在可以使用`std::array`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T21:09:46.080

指针是迭代器的有效模型：

```
struct Bob
{ int val; };

bool operator<(const Bob& lhs, const Bob& rhs)
{ return lhs.val < rhs.val; }

// let's do a reverse sort
bool pred(const Bob& lhs, const Bob& rhs)
{ return lhs.val > rhs.val; }

bool isBobNumberTwo(const Bob& bob) { return bob.val == 2; }

int main()
{
    Bob bobs[4]; // ok, so we have 4 bobs!
    const size_t size = sizeof(bobs)/sizeof(Bob);
    bobs[0].val = 1; bobs[1].val = 4; bobs[2].val = 2; bobs[3].val = 3;

    // sort using std::less<Bob> wich uses operator <
    std::sort(bobs, bobs + size);
    std::cout << bobs[0].val << std::endl;
    std::cout << bobs[1].val << std::endl;
    std::cout << bobs[2].val << std::endl;
    std::cout << bobs[3].val << std::endl;

    // sort using pred
    std::sort(bobs, bobs + size, pred);
    std::cout << bobs[0].val << std::endl;
    std::cout << bobs[1].val << std::endl;
    std::cout << bobs[2].val << std::endl;
    std::cout << bobs[3].val << std::endl;

    //Let's find Bob number 2
    Bob* bob = std::find_if(bobs, bobs + size, isBobNumberTwo);
    if (bob->val == 2)
        std::cout << "Ok, found the right one!\n";
    else 
        std::cout << "Whoops!\n";

    return 0;
} 
```

# delphi - 在 Delphi 7 中，我可以设置“调试”和“发布”模式吗？

> ID：176159
> 
> 赞同：12
> 
> 时间：2008-10-06T20:56:27.243
> 
> 标签：delphi, ide, delphi-7

在大多数现代 IDE 中，您可以拥有 Debug 和 Release 构建配置，并且可以在它们之间快速切换。

在 Delphi 7 中，这似乎是不可能的。我必须去项目设置并手动切换优化和所有调试信息。

如果有一个插件或类似的插件可以为我处理这个，那就太好了。

有人知道吗？还有其他建议吗？

**编辑：**我无法升级到 Delphi 2007 或 2009，因为我们有一个必须转换的大型 Delphi 7 代码库。我同意这在理论上是最好的解决方案：P

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-06T22:16:02.093

[使用 Andreas Hausladen 出色的DDevExtensions](http://andy.jgknet.de/blog/?page_id=10) IDE 专家，您可以非常轻松地添加项目配置，类似于其他 IDE 提供的配置。只需确保从我提到的链接下载 1.6 版本，因为更高版本仅适用于 Delphi 2009。1.6 版本适用于 5 到 2007 之间的任何 Delphi 版本，包括在内。

专家在项目菜单下添加了一个子菜单，以防一开始找不到。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T21:05:14.823

我不知道 Delphi 7 的任何构建配置插件，但是你可以模拟这个；

只需在项目的每个单元中应用一个包含文件（无论如何这都是一件明智的事情），并让它自行调整为一个定义，如下所示：

--- ExampleIncludeFile.inc ---

```
{$IFDEF DEBBUG}

{$OPTIMIZATION OFF}
{$RANGECHECKING ON}
// etc

{$ELSE}

{$OPTIMIZATION ON}
{$RANGECHECKING OFF}

{$ENDIF} 
```

* * *

现在，如果您将 DEBUG 添加到 .dof 项目设置中的编译器定义中，您将获得一个 Debug-build，如果您删除它，您将获得一个发布版本。当然，其他设置也是完全可能的。

Delphi 2005 确实在项目管理器中嵌入了构建配置（仅限发布和调试），Delphi 2009 对此添加了更多内容，包括“选项集”和自定义“配置”等漂亮的小东西（您甚至可以将其标记为默认）所有新项目）。看看吧，真的是非常棒的产品！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T21:05:52.607

不是直接在 Delphi 7 中，但您有以下选择：

*   将所有更改（调试、优化等）的编译器指令包装在用户定义的编译器指令中，然后设置编译器指令以在调试和发布之间进行更改。
*   此外，您可以使用[FinalBuilder](http://www.finalbuilder.com/)或其他类似的构建工具来创建使用不同设置的构建。
*   Delphi 2005 添加了这个功能。所以升级到 Delphi 2007 或 2009 并内置它。它们都是非常稳定的版本，具有许多新功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T21:07:18.953

此功能仅在 Delphi 2009 中添加。

对于旧版本的 Delphi，您可以编写两份 .cfg 文件，一份带有调试选项，另一份带有发布选项，然后从批处理文件中编译调用**dcc32.exe的程序。**

像这样的东西：

```
rem release.bat
copy release.cfg myprog.cfg
dcc32 -B myprog.dpr

rem debug.bat
copy debug.cfg myprog.cfg
dcc32 -B myprog.dpr 
```

# c# - ASP.NET 母版页中的元素增强 Javascript

> ID：176171
> 
> 赞同：3
> 
> 时间：2008-10-06T21:01:07.843
> 
> 标签：c#, asp.net, javascript, master-pages

我遇到了一些问题，我做了一些挖掘，但努力想出一个确凿的答案/修复。

基本上，我有一些 javascript（由第 3 方创建）对页面元素做了一些非常棒的东西，使它们看起来很漂亮。该代码在单页（即没有母版）上效果很好，但是，当我尝试将效果应用于母版中的内容页面时，它不起作用。

简而言之，我有一个包含主要脚本参考的母版页。所有页面都将使用该脚本，但传递给它的参数对于内容页面会有所不同。

**母版页脚本参考**

```
<script src="scripts.js" language="javascript" type="text/javascript" /> 
```

**单页**

```
<script>
    MakePretty("elementID");
</script> 
```

如您所见，我需要每个页面中的引用（因此它在主页面中），但我想要“MakePretty”的实际元素将根据内容而改变。

**内容页面**

现在，由于内容页面没有`<head>`元素，我一直在使用以下代码将其添加到母版页`<head>`元素：

```
HtmlGenericControl ctl = new HtmlGenericControl("script");
ctl.Attributes.Add("language", "javascript");
ctl.InnerHtml = @"MakePretty(""elementID"")";
Master.Page.Header.Controls.Add(ctl); 
```

现在，这**行不通**。但是，如果我用简单的东西替换`alert("HI!")`，一切正常。所以代码被添加好了，它似乎并不总是根据它在做什么来执行..

现在，经过一些挖掘，我了解到内容页面的`Load`事件是在母版页之前引发的，这可能会产生影响，但是，我认为页面上的 javascript 是一次全部加载/运行的？

如果这是一个愚蠢的问题，请原谅我，但我对使用 javascript 还是比较陌生，尤其是在母版页场景中。

**如何让内容页面调用母版页中引用的 javascript 代码？**

感谢您对这些人的任何/所有帮助，您将真正帮助我解决这个工作问题。

## 笔记：

*   `RegisterStartupScript`之类的东西似乎在任何层面都不起作用..
*   即使在 MasterPage 环境中，控件 ID 的设置也很好，并且按预期呈现。

* * *

抱歉，如果其中任何一个不清楚，我真的很累，所以如果需要的话，如果需要重新措辞/澄清，请发表评论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T21:10:34.470

将 ContentPlaceHolder 放在母版页的 head 部分，然后在引用占位符的内容页上添加 asp:Content 控件，并将脚本放在该控件中。您可以通过这种方式为每个页面自定义它。

此外，ID 引用可能不起作用，因为当您使用母版页时，页面上的控件 ID 是根据容器结构自动创建的。因此，它可能不是预期的“elementID”，而是输出“ctl00_MainContentPlaceHolder_elementID”查看您的源代码或使用萤火虫检查您的表单元素以查看输出的 ID 是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T21:09:55.300

难道不能用干净的javascript做吗？-)

-- 只需在 body-tag 中添加与此类似的内容：

```
<script type="text/javascript">
  window.onload = function(){
    MakePretty("elementID");
  }
</script> 
```

顺便说一句，脚本标签必须有一个结束标签：

```
<script type="text/javascript" src="myScript.js"></script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T22:02:28.000

为什么不使用 jQuery 来查找所有控件？像这样的东西：

```
$(document).ready(function(){
  $("input[type='text'], input[type='radio'], input[type='checkbox'], select, textarea").each(function(){
    MakePretty(this);
  });
}); 
```

这样您将获得页面上的所有元素，您可以等到页面准备好（这样您就不会非法修改 DOM）。如果需要，jQuery 选择器可以获取更多特定格式的元素（即，添加根元素，如主体 div 的 ID）。

最好也修改 MakePretty 方法，使其将元素而不是 ID 作为参数，以减少处理开销。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T21:12:26.230

一旦您使用母版页，客户端上的控件 ID 就不是您认为的那样。生成脚本时应使用 Control.ClientID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T22:26:40.323

使用母版页时，您需要注意 html 属性 ID，因为 .NET 会修改此值，因为它需要保持 id 的唯一性。

我会假设您的 javascript 正在通过 ID 应用 css 样式，并且当您使用母版页时，ID 与您的 aspx 中的不同。如果您验证始终添加您的 javascript，则您的答案需要考虑以下几点：

*   始终在页面加载中设置您的母版页 ID (this.ID = "myPrefix";)
*   母版页中的任何 HTML 元素都将以母版页 ID 为前缀（即：在呈现的页面上将是“myPrefix_myDiv”）
*   您的内容占位符 ID 中的任何 HTML 元素都将以附加前缀作为前缀（即 myPrefix_ContentPlaceHolderId1_myDiv）

如果我能澄清任何事情，请告诉我。希望这可以帮助！

# geolocation - 图片的地理定位网站

> ID：176172
> 
> 赞同：1
> 
> 时间：2008-10-06T21:01:31.790
> 
> 标签：geolocation, social, image

我自己不是一名网络开发人员，但对一个很酷的网站有想法，如何创建这样一个网站？

[网站理念]

我需要建立一个简单的社交网站，人们可以在其中上传图片、评论图片，最重要的是，使用谷歌地图视图记录图片中内容的实际位置。

进入后，界面将显示谷歌地图并询问邮政编码、国家和搜索半径（5km、25km、50km 等）

结果将显示一个谷歌地图，所有图片都在该半径范围内。

清如泥？;)

这是一个“有趣”的项目，我正在四处寻找资源来实现它。哎呀，如果像上面这样的网站已经存在并且有免费的模板，那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T21:05:14.480

Flickr 已经提供了类似的[功能](http://www.flickr.com/map/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T14:23:52.193

谷歌地图本身有地理编码的图像 - 点击“更多”按钮并选中“照片”框。几个小时的乐趣！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T21:25:28.467

这是一个非常广泛的问题！我认为最直接的答案是“如果你因为不是程序员而不能自己做，那么你需要[租一个编码](http://www.rentacoder.com/RentACoder/DotNet/default.aspx)器（或找一个程序员朋友帮忙）”

除此之外...[查看 Google Maps API](http://code.google.com/apis/maps/)

这里还有一个建议，可以改善您的整体用户体验。许多智能手机和可能的独立相机本身就支持地理标记。检查上传图像的 EXIF 标头是否有地理标记。在存在地理标签的情况下，您不需要要求用户提供它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T21:05:28.163

我在这里建了一个[http://www.geograph.org.uk](http://www.geograph.org.uk)，虽然它不使用谷歌地图来显示，因为我们为英国授权了更详细的军械测量地图。不过，网站上有一些使用谷歌地图的地方。[GPL 源代码和其他信息](http://hub.geograph.org.uk/)也可用 :)

你需要一些开发技能，或者一个友好的开发人员来适应和部署它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T14:37:49.233

我认为您想开发类似于[http://www.panoramio.com/的东西](http://www.panoramio.com/)

# python - 用 Python 编写一个可靠的、完全有序的多播系统

> ID：176179
> 
> 赞同：5
> 
> 时间：2008-10-06T21:03:55.827
> 
> 标签：python, sockets, networking, ip, multicast

我必须用 Python 从头开始​​编写一个可靠的、完全有序的多播系统。我不能使用任何外部库。我被允许使用中央音序器。

似乎有两种直接的方法：

1.  编写一个高效的系统，为每个多播消息附加一个唯一的 id，为其接收到的消息 id 具有定序器多播序列号，并来回发送 ACK 和 NACK。
2.  编写一个低效的泛洪系统，其中每个多播器只需重新​​发送它接收到的每条消息一次（除非它是由那个特定的多播器发送的。）

我被允许使用第二个选项，并且倾向于这样做。

我目前正在多播 UDP 消息（这似乎是唯一的选择），但这意味着某些消息可能会丢失。这意味着我必须能够唯一标识每个发送的 UDP 消息，以便可以根据 #2 重新发送它。我真的应该生成唯一的数字（例如使用发件人地址和计数器）并将它们打包到每个发送的 UDP 消息中吗？我该怎么做呢？以及如何在 Python 中接收单个 UDP 消息，而不是数据流（即`socket.recv`）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T21:32:46.827

泛滥的方法可能会导致糟糕的情况变得更糟。如果消息由于高网络负载而被丢弃，让每个节点重新发送每条消息只会使情况变得更糟。

采取的最佳方法取决于您发送的数据的性质。例如：

1.  多媒体数据：不重试，丢弃的数据包是丢弃的帧，无论如何下一帧何时到达都无关紧要。
2.  固定周期数据：接收节点保持一个计时器，每次收到更新时都会重置该计时器。如果时间到期，它会向主节点请求丢失的更新。重试可以单播到请求节点。

如果这两种情况都不适用（每个节点都必须接收每个数据包，并且数据包时间不可预测，因此接收者无法自行检测丢失的数据包），那么您的选项包括：

1.  每个数据包的每个节点的显式 ACK。发送方重试（单播）任何未确认的数据包。
2.  基于 TCP 的网格方法，其中每个节点手动将接收到的数据包重复到相邻节点，依靠 TCP 机制来确保传递。

您可能会依赖接收者在收到具有较晚序列号的数据包时注意到丢失的数据包，但这要求发送者保留数据包，直到至少发送一个额外的数据包。要求肯定的 ACK 更可靠（并且可证明）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T22:42:25.563

您采用的方法将在很大程度上取决于您发送的数据的性质、网络的规模以及您发送的数据量。特别是，它将取决于每个节点连接到的目标数量。

如果您希望这可以扩展到每个节点的大量目标和大量数据，那么您可能会发现向每个数据包添加 ACK/NAK 的开销足以不利地限制您的吞吐量，特别是当您将重新传输添加到混合中。

正如 Frank Szczerba 所说，多媒体数据的好处是能够从丢失的数据包中恢复。如果您对发送的数据有任何控制权，则应尝试设计有效负载，以最大程度地减少对丢弃数据包的敏感性。

如果您发送的数据不能容忍丢弃的数据包*，并且*您正在尝试扩展到网络的高利用率，那么 udp 可能不是最好的协议。实现一系列 tcp 代理（其中每个节点向所有其他连接的节点重新传输、单播 - 类似于您的泛洪想法）将是一种更可靠的机制。

综上所述，您是否考虑过为此应用程序使用真正的多播？

* * *

刚刚看到“作业”标签......这些建议可能不适合家庭作业问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-25T15:45:59.407

恕我直言，您应该选择现有的可靠 UDP 协议。有几个你可以选择，看看这个 SO 问题：[当你需要可靠的 UDP 时，你使用什么？](https://stackoverflow.com/questions/107668/what-do-you-use-when-you-need-reliable-udp/)

我个人喜欢并使用[MoldUDP](https://www.google.com/search?q=moldudp)，这是 Nasdaq 的 ITCH 市场数据馈送所使用的协议。

# javascript - 显示具有相同核心变量类型的两组不同信息的 Javascript 选项卡

> ID：176192
> 
> 赞同：1
> 
> 时间：2008-10-06T21:05:50.470
> 
> 标签：javascript

所以基本上，我有两个包含常规和特殊电子邮件的选项卡。为了获得电子邮件，您必须单击日历日期，然后 AJAX 将查询数据库中的常规电子邮件和特殊电子邮件。有一个下一个和上一个按钮可以浏览所选日期的结果。我遇到的问题是，由于每个选项卡都跟踪一组单独的电子邮件、电子邮件计数、查看电子邮件*n* of *n*和当前电子邮件。

我的想法是我可以为每个公共变量使用 setter 和 getter。基本上，如果我在第一个选项卡中调用*getEmailCount()*，我将通过检查当前处于活动状态的选项卡来获取常规电子邮件的电子邮件计数。我问的唯一原因是因为我认为检查每个功能中哪个选项卡处于活动状态不是最好的方法。我用谷歌搜索了一下，但真的不知道我应该搜索什么。

编辑：仅当用户在日历上选择新日期时才会调用 AJAX 请求。如果有结果，电子邮件将存储在单独的数组中。如果没有结果，什么也不会发生。至于选项卡的行为，这很简单。选项卡的唯一职责是在 HTML 表格中显示电子邮件信息。下一个和上一个按钮用于浏览电子邮件。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T00:13:08.143

我会将其设计为一个包含两个单独集合的结果对象。应用程序对象中的引用将引用活动集合，并且所有操作（除非指定）都将对活动集合进行操作。

一些示例代码：

AJAX 返回 JSONP 数据：

```
 yourappobject.loadResults(
    {
        regular: [{subject: "Subject", from: "From"...},{..}...],
        special: [{subject: "Subject", from: "From"...},{...}...]
    }
); 
```

```
 function yourappobject() {
    var _results = {regular: [], special: []};
    var _active = _results["regular"];
    var _tab = "regular";

```
this.loadResults = function(data) {
    _results = data;
};

// pass "regular" or "special"
this.setActive = function(tab) {
    _active = results[tab];
    _tab = tab;
};

this.getEmailCount = function(collection) {
    var collection = collection || _active;
    return collection.length;
}; 
```

}; 
```

# html - 我应该清理托管 CMS 的 HTML 标记吗？

> ID：176195
> 
> 赞同：2
> 
> 时间：2008-10-06T21:06:12.203
> 
> 标签：html, xss, sanitization

我正在考虑为客户启动类似 CMS 的托管服务。

实际上，它将要求客户输入文本，这些文本将提供给任何访问其网站的人。我计划使用 Markdown，可能与 WMD（SO 使用的实时降价预览）结合使用来处理大块文本。

现在，我应该清理他们对 html 的输入吗？鉴于只有少数人编辑他们的“CMS”，所有付费客户，我应该去掉坏的 HTML，还是应该让他们疯狂？毕竟，这是他们的“网站”

**编辑：**我为什么要这样做的主要原因是让他们使用自己的 javascript，并拥有自己的 css 和 div 以及不用于输出的东西

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T21:09:42.040

为什么**不**清理输入？

如果你不这样做，你就是在招致灾难——对你的客户或你自己，或两者兼而有之。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T15:50:51.417

你的问题是：

“编辑：我这样做的主要原因是让他们使用自己的 javascript，并拥有自己的 css 和 div 以及不用于输出的东西”。

如果您允许用户提供任意 JavaScript，那么清理输入是不值得的。Cross-Site Scripting (XSS) 的定义基本上是“用户可以提供 JavaScript，而有些用户是坏的”。

现在，一些网站确实允许用户提供 JavaScript，并通过以下两种方式之一降低风险：

1.  将单个用户的 CMS 托管在不同的域下。Blogger 和 Tumblr（例如 myblog.blogspot.com与**blogger.com**）这样做是为了防止用户的模板窃取其他用户的 cookie。您必须知道自己在做什么，并且永远不要在根域下托管任何用户内容。
2.  如果用户内容从未在用户之间共享，那么恶意用户提供什么脚本就无关紧要了。但是，CMS 是关于共享的，所以这可能不适用于这里

有一些黑名单过滤器可能有效，但它们仅在**今天**有效。HTML 规范和浏览器会定期更改，这使得过滤器几乎无法维护。黑名单是解决安全和功能问题的可靠方法。

在处理用户数据时，始终将其视为不受信任。如果您没有在产品早期解决这个问题并且您的场景发生了变化，那么几乎不可能返回并找到所有 XSS 点或修改产品以防止 XSS 而不会让您的用户感到不安。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T21:14:12.357

您还将再次保护心怀不满的员工、交叉客户攻击或任何其他类型的愚蠢行为。

无论用户或观众如何，您都应该始终进行消毒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T21:12:30.583

至少解析他们的条目，只允许 HTML 标记的某个“安全”子集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T21:14:10.533

我认为您应该始终清理输入。大多数人使用 CMS 是因为他们不想从头开始创建自己的网站，并且希望轻松访问以编辑他们的页面。这些用户很可能不会尝试输入会被清理的文本，但通过防止它来保护他们的用户。

# java - 为什么即使使用 UTF-8，在 Windows 和 Linux 中 ¿ 的显示也会不同？

> ID：176196
> 
> 赞同：2
> 
> 时间：2008-10-06T21:06:16.850
> 
> 标签：java, utf-8, character-encoding

为什么在 Linux 和 Windows 中显示以下内容不同？

```
System.out.println(new String("¿".getBytes("UTF-8"), "UTF-8")); 
```

在 Windows 中：

¿

在 Linux 中：

一种

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-06T23:49:22.730

System.out.println() 以系统默认编码输出文本，但控制台根据其自己的编码（或“代码页”）设置解释该输出。在您的 Windows 机器上，这两种编码似乎匹配，但在 Linux 机器上，输出显然是 UTF-8，而控制台将其解码为单字节编码，如 ISO-8859-1。或者，正如 Jon 建议的那样，源文件被保存为 UTF-8 并将`javac`其作为其他内容读取，这个问题可以通过使用 Unicode 转义来避免。

当您需要输出 ASCII 文本以外的任何内容时，最好的办法是使用适当的编码将其写入文件，然后使用文本编辑器读取文件——控制台太有限且太依赖系统。顺便说一下，这段代码：

```
new String("¿".getBytes("UTF-8"), "UTF-8") 
```

...对输出没有影响。所做的只是将字符串的内容编码为字节数组并再次对其进行解码，从而再现原始字符串——这是一个昂贵的空操作。如果要以特定编码输出文本，则需要使用 OutputStreamWriter，如下所示：

```
FileOutputStream fos = new FileOutputStream("out.txt");
OutputStreamWriter osw = new OutputStreamWriter(fos, "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-06T21:19:47.183

不确定问题到底出在哪里，但值得注意的是

Â¿ ( 0xc2,0xbf)

是用 UTF-8 编码的结果

0xbf,

这是 ¿ 的 Unicode 代码点

因此，在 linux 的情况下，输出没有显示为 utf-8，而是显示为单字节字符串

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T21:20:55.340

检查你的 linux 终端有什么编码。

对于 ubuntu 中的 gnome-terminal - 转到“终端”菜单并选择“设置字符编码”。

对于腻子，配置 -> 窗口 -> 翻译 -> UTF-8（如果这不起作用，请参阅[这篇文章](http://planetozh.com/blog/2007/08/how-to-display-utf8-in-your-putty-bash-shell/)）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T21:34:02.893

运行此代码以帮助确定它是编译器问题还是控制台问题：

```
public static void main(String[] args) throws Exception {
    String s = "¿";
    printHex(Charset.defaultCharset(), s);

    Charset utf8 = Charset.forName("UTF-8");
    printHex(utf8, s);
}

public static void printHex(Charset encoding, String s)
        throws UnsupportedEncodingException {
    System.out.print(encoding + "\t" + s + "\t");

    byte[] barr = s.getBytes(encoding);
    for (int i = 0; i < barr.length; i++) {
        int n = barr[i] & 0xFF;
        String hex = Integer.toHexString(n);
        if (hex.length() == 1) {
            System.out.print('0');
        }
        System.out.print(hex);
    }
    System.out.println();
} 
```

如果每个平台上 UTF-8 的编码字节不同（应该是*c2bf*），这是编译器问题。

如果是编译器问题，请将 "¿" 替换为["\u00bf"](http://www.unicode.org/charts/PDF/U0080.pdf)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T21:10:29.073

由于您的编辑器和编译器编码，很难确切地知道您的源代码包含哪些字节，或者调用 getBytes() 的字符串。

您能否生成一个简短但完整的程序，其中仅包含 ASCII（以及在字符串中转义的相关 \uxxxx）仍然显示问题？

我怀疑问题很可能出在 Windows 或 Linux 上的控制台输出上，但最好先获得一个可重现的程序。

# python - 构建全文搜索引擎：从哪里开始

> ID：176213
> 
> 赞同：13
> 
> 时间：2008-10-06T21:10:44.330
> 
> 标签：python, full-text-search

我想使用[Google App Engine](http://code.google.com/appengine/)编写一个 Web 应用程序（所以参考语言是**Python**）。我的应用程序需要一个简单的搜索引擎，以便用户能够找到指定关键字的数据。

例如，如果我有一个包含这些行的表：

> 1 办公空间
> 2 2001：太空漫游
> 3 巴西

并且用户查询“空间”，将返回第 1 行和第 2 行。如果用户查询“办公空间”，结果也应该是第 1 行和第 2 行（第 1 行在前）。

以简单的方式执行此操作的技术指南/算法是什么？
你能给我指出这背后的理论吗？

谢谢。

*编辑*：我不是在这里寻找任何复杂的东西（例如，索引大量数据）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T02:06:11.550

阅读 Tim Bray[关于该主题的系列文章](http://www.tbray.org/ongoing/When/200x/2003/07/30/OnSearchTOC)。

> *   背景
> *   搜索引擎的使用
> *   基本
> *   准确率和召回率
> *   搜索引擎智能
> *   棘手的搜索词
> *   停用词
> *   元数据
> *   国际化
> *   排名结果
> *   XML
> *   机器人
> *   需求清单

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T21:14:52.433

当我过去构建全文搜索引擎时，我发现这两本书非常有用。

[信息检索](https://rads.stackoverflow.com/amzn/click/com/0134638379)

[管理千兆字节](https://rads.stackoverflow.com/amzn/click/com/1558605703)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T02:30:26.477

如果可能的话，我不会自己建造它。

App Engine 包含全文搜索引擎的基础知识，这里有一篇[很棒的博客文章](http://appengineguy.com/2008/06/how-to-full-text-search-in-google-app.html)介绍了如何使用它。

[错误跟踪器](http://code.google.com/p/googleappengine/issues/detail?id=217)中还有一个功能请求最近似乎受到了一些关注，因此如果可以的话，您可能希望坚持到实现为止。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T21:21:49.953

一如既往地从[维基百科](http://en.wikipedia.org/wiki/Index_(search_engine))开始。首先开始通常是建立一个倒排索引。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T22:58:42.723

这是一个原始的想法：

*不要*建立索引。严重地。

前段时间我也遇到过类似的问题。我需要一种快速的方法来搜索来自文档的大量文本。我不仅需要匹配单词，还需要匹配大型文档中的单词邻近度（这个词是否*靠近*那个词）。我刚刚用 C 语言编写了它，它的速度让我感到惊讶。它足够快，不需要任何优化或索引。

以当今计算机的速度，如果您编写直接在金属上运行的代码（编译代码），您通常不需要 order log(n) 类型的算法来获得所需的性能。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-07T10:41:51.430

[Lucene](http://en.wikipedia.org/wiki/Lucene)或[自治](http://www.searchtools.com/tools/autonomy.html)！这些不是为您提供开箱即用的解决方案。您将不得不在其接口之上编写包装器。
他们当然会处理词干、语法、关系运算符等

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T21:59:14.967

首先建立你的索引。遍历输入，拆分为单词
对于每个单词检查它是否已经在索引中，如果是则将当前记录号添加到索引列表中，如果没有则添加单词和记录号。
要查找一个单词，请转到（可能已排序的）索引并返回该单词的所有记录编号。
使用 Python 的内置存储类型为合理的大小列表执行此操作非常容易。

作为一个额外的改进，您只想存储单词的基本部分，例如“find”用于“finding” - 查找词干算法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-08T01:37:25.493

[《信息检索简介](http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html)》一书很好地介绍了该领域。

死树版本由剑桥大学出版社出版，但您也可以通过上面的链接找到免费的在线版本（HTML 和 PDF）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T21:23:36.427

另请参阅我提出的问题：[How-to: Ranking Search Results](https://stackoverflow.com/questions/47762/how-to-ranking-search-results)。

当然还有更多的方法，但这是我现在使用的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T22:49:56.937

老实说，比我更聪明的人已经弄清楚了这些东西。我会加载 solr 应用程序并从我的 appengine 应用程序进行 json 调用，然后让 solr 处理索引。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-07T02:40:28.580

我这个周末才发现这篇文章：[http ://www.perl.com/pub/a/2003/02/19/engine.html](http://www.perl.com/pub/a/2003/02/19/engine.html)

做一个简单的看起来并不太复杂（尽管它肯定需要大量优化才能成为企业类型的解决方案）。我计划使用古腾堡项目的一些数据来尝试概念验证。

如果您只是在寻找可以探索和学习的东西，我认为这是一个好的开始。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-08T02:26:31.853

查看“管理千兆字节”一书，它涵盖了大量纯文本数据的存储和检索——例如。压缩和实际搜索，以及可用于每种算法的各种算法。

同样对于纯文本检索，您最好使用基于矢量的搜索系统而不是关键字->文档索引系统，因为基于矢量的系统可以更快，更重要的是可以相对简单地提供相关性排名。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-01-04T21:45:06.197

试试这个：假设变量表是您的搜索条目列表。

```
query = input("Query: ").strip().lower()#Or raw_input, for python 2
end = []
for item in table:
    if query in item.strip().lower():
        end.append(item)

print end #Narrowed results 
```

它只是遍历所有项目以查看查询是否在其中任何一项中。它适用于简单的应用内搜索功能。不过，也许不适用于整个互联网。

# javascript - Are there any recent Lua to JavaScript converters or interpreters somewhere?

> ID：176235
> 
> 赞同：32
> 
> 时间：2008-10-06T21:18:46.450
> 
> 标签：javascript, lua, interpreter, converter

I need to find a good Lua to JavaScript converter; lua2js on luaforge.org is out of date (3 or so years old and looks like it doesn't work on Lua 5.1) and I haven't yet found anything on Google.

Does anyone have any experience with any other converters out there? It should work on Lua 5.1 and preferably be .NET based, but .NET is not a requirement. A javascript lua interpreter would work as well.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-12-29T22:21:04.433

新挑战者出现：Lua.js [https://github.com/mherkender/lua.js](https://github.com/mherkender/lua.js)

有关证明其成熟度的一些很棒的演示，请参阅[https://github.com/ghoulsblade/love-webplayer](https://github.com/ghoulsblade/love-webplayer)

Lua.js 通过将 Lua 代码直接转换为 ECMAscript（包括 JavaScript、ActionScript）来工作，这使其与尝试在 JavaScript 中实现 Lua VM 的解决方案相比具有重要的速度优势。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-08T15:04:58.450

这是 Lua 列表中经常出现的问题，我猜是因为这两种语言表面上的相似性。

不幸的是，有许多重要的区别并不那么明显。让它工作需要一个成熟的编译器，针对 JS 而不是 Lua 的字节码，或者用 JavaScript 重写 Lua VM。

我不知道 Lua2js 的最初目标；但如果它只是一个有限的“翻译器”，那么编写旨在翻译的 Lua 代码将否定 Lua 的大部分（全部？）优点。例如，我认为您不能将函数用作表键，因为在 JavaScript 中键只是字符串（和数字？我不确定）。

.NET 的选择更合理，可以通过更改现有编译器来发出 CLR 字节码而不是标准 Lua 字节码。即使 CLR 是针对其他类型的语言设计和优化的，它也绝对是通用的，可以很好地运行。主要障碍是图书馆的可用性。

我刚刚找到的另一个选择是Roberto Ierusalmschy 和 Fabio Mascarenhas的[这篇论文，他们在其中探索将 LuaVM 字节码转换为 CLR 字节码。](http://www.lua.inf.puc-rio.br/luanet/lua2il_jucs.pdf)

与学术论文一样，没有注明撰写日期，所以我不知道它是新的和革命性的还是旧的和被遗忘的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-04-26T10:14:39.673

[Emscripten](http://emscripten.org)包含转换为 JavaScript 的 Lua 解释器。您可以[在浏览器中尝试](http://syntensity.com/static/lua.html)。但是大小为1.5MB。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-11T16:46:14.647

ljs 在 javascript 中有一个 lua vm 的工作演示。甚至可以使用 lua 编写的 lua 解释器在浏览器中编译源代码。

[https://github.com/humbletim/ljs](https://github.com/humbletim/ljs)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-07T16:50:30.250

我一直在使用上一个答案中提到的这个实现[https://github.com/mherkender/lua.js 。](https://github.com/mherkender/lua.js)它可以进行离线和加载时解析，我发现它非常易于使用。

我的 Lua 脚本通过 C 函数调用，将 C 代码转换为 Javascript 并将其与 lua.js 连接起来非常简单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-07T18:45:17.830

访问[http://luajs.org](http://luajs.org)查看我的工作。

站点菜单上有演示和基准。

压缩前只有35.5K，压缩后只有12.2K。它可以直接访问 Javascript 对象/数组。它几乎每天都在更新。

它比 lua.vm.js 更快。（由于元表实现，没那么快），我一直在优化它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T21:53:11.397

转换为 javascript 很有趣，可以在浏览器端替换 javascript。我们也可以在浏览器上采取一点类型安全措施。将 javascript 定位为平台是针对最普遍的平台之一，即地球上的浏览器。GWT 执行 java2js，但我不确定是否只想在应用程序的几个页面中引入 GWT。我得想想。对于您作为表格中的键的功能，必须有一些魔法要做。也许只是在编译时为每个函数分配一个唯一的名称并将其用作您的密钥。您还可以为所有键添加前缀以进行类型检查，这是一个不错的开始。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-05T19:48:04.283

我已经为 ECMAscript 静态编译器编写了部分完整的 Lua。

[https://github.com/mherkender/lua2js-experiment](https://github.com/mherkender/lua2js-experiment)

它可能无法满足您的需求，因为该项目缺少许多关键功能，而且我不急于完成它，因为它是一个死胡同。阅读自述文件中的更多内容以获取详细信息。

尽管我在 Internet 上看到了一些问题，但只有少数 Lua 特定的功能（如 *fenv 函数或大多数调试库）是 Javascript 无法真正支持的。其他的，比如文件库，受到 VM 可以访问的功能的限制。

我还亲自尝试了 Lua + Emscripten 选项，虽然它令人印象深刻，但它也很慢。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-21T04:18:04.050

一种方法是使用[LuaSub](http://luaforge.net/projects/luasuper)并生成 JavaScript 而不是 Lua 输出。这可以通过合理的努力来完成（目前 LuaSub 不这样做）。

JS 不能满足 Lua 要求的地方可能会在编译时被发现，并导致错误。

以后我会做很多 JS+SVG 的事情，如果 JS 方面头疼的话，这可能是一件值得尝试的事情。如果其他人想去，请这样做。LuaSub 源代码就在那里。

最初，LuaSub 被设计为 Lua 5.1 的语法扩展器，以引入易于使用的概念（sa 增量、类型检查），而不需要与标准 Lua 的兼容性或需要对其进行修补。它在这方面类似于[MetaLua](http://metalua.luaforge.net)（这似乎变得更加普遍）。

# java - Suppressing warnings for JDK1.4 project

> ID：176236
> 
> 赞同：3
> 
> 时间：2008-10-06T21:19:02.863
> 
> 标签：java, eclipse, warnings, jdk1.4

Is it possible to suppress warnings in Eclipse for JDK1.4 project?

EDIT: Longer version. There is a project which requires JDK1.4 (no annotations). Only way of suppressing warnings I know is using annotation @SuppressWarnings - no can do in JDK1.4\. Is there any way to remove some warning notifications in some specific method/class (not whole project) ?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T21:22:04.383

If you mean that you are writing Java 1.4 code, and you are getting warnings because you aren't using generics, set your Java Compiler settings to 1.4\. You can do this on a per-project basis, or for the whole workspace.

Window->Preferences->Java->Compiler->Compiler Compliance Level = 1.4

To disable specific warnings, such as those regarding unnecessary casts, etc., you can tailor them under the Compiler->Errors/Warnings panel. Most of these warnings, however, are not version specific, and can be quite helpful if heeded.

Workspace settings can be overridden for a project, but I don't know of a way that gives you annotation-like control over a specific class or method.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T21:20:47.943

Setting the compiler to 1.4 compliance in the properties of the project should do the trick. Just right click your project and select "Properties" at the bottom and then search for "Compiler".

# .net - 配置文件调试或发布版本？

> ID：176253
> 
> 赞同：6
> 
> 时间：2008-10-06T21:23:54.350
> 
> 标签：.net, profiling

我需要对 .NET Framework 应用程序进行一些内存分析。我应该使用调试版本还是发布版本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T21:35:49.240

使用调试符号构建的发布版本。

这样就没有调试构建开销（例如在数组之后添加额外的内存以进行溢出检测），但您仍然拥有将地址与变量相关联所需的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T21:26:04.703

您应该分析导致问题的构建。我假设您正在为您的用户提供发布版本，因此您应该对此进行分析。

# javascript - 最喜欢的 Web 表单验证技术

> ID：176255
> 
> 赞同：2
> 
> 时间：2008-10-06T21:24:54.333
> 
> 标签：javascript, apache-flex, validation, sanitization

每个人最喜欢清理用户数据的方式是什么？

我一直在使用 Javascript，但最近需要一些更安全的东西（毕竟人们可以关闭它），所以我在看 Flex，但我想我会问社区他们的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T21:29:11.890

永远不要使用 javascript**或任何其他客户端技术**进行*唯一*验证。您可以使用客户端验证来节省服务器上的一些负载，或者通过在验证失败时更快地显示错误来使您的应用程序看起来更具响应性，但您应该**始终**使用服务器端代码进行验证。

就个人而言，我喜欢 ASP.Net 验证控件，因为它为您提供了客户端验证和服务器端安全性的好处，而无需编写两次逻辑。当然，库存控制非常简单，但您可以扩展它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T21:44:32.717

验证应始终在服务器端完成。此外，在客户端执行它也很好。

你如何做取决于你的应用程序是用什么编写的。任何语言都应该能够处理验证；重要的是使用的逻辑，而不是语言。

这还取决于您对所提供数据的处理方式。将其放入 URL 或将其存储在 SQL 数据库中需要两种截然不同的清理方法。如果可能的话，将有效值列入白名单——不要将无效值列入黑名单。总会有人想出一个你没有考虑过的新的错误输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T21:31:41.497

根据项目的要求，您可能希望也可能不希望实施客户端验证。但是，应始终实施服务器端验证。我更喜欢将适当的输入和值列入白名单，而不是将无效数据列入黑名单，因为这样可以确保没有人会漏掉我没有考虑到的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T21:46:45.117

*   至少总是使用服务器端验证
*   使用正则表达式

PHP 示例：

```
preg_match('/^[\w][\w\,\-\.]*\@[\w]+[\w\-\.]*$/', $_GET['email'], $matches);
if (count($matches) > 0) {
  $_GET['email'] = $matches[0];
} else {
  die('invalid email address');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T21:26:55.937

建议同时使用服务器端和客户端验证。我使用 JQuery 进行客户端验证。

# http - URI、URL 和 URN 之间有什么区别？

> ID：176264
> 
> 赞同：4736
> 
> 时间：2008-10-06T21:26:58.073
> 
> 标签：http, url, uri, urn, rfc3986

人们谈论**URL**、**URI**和**URN**就好像它们是不同的东西，但在肉眼看来它们是一样的。

它们之间有什么可区分的区别？

* * *

## 回答 #1

> 赞同：4025
> 
> 时间：2009-12-31T06:32:58.697

**[URI](http://en.wikipedia.org/wiki/Uniform_Resource_Identifier)的标识**和**[URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)的定位**；但是，**定位器也是标识符**，因此每个 URL 也是一个 URI，但有些 URI 不是 URL。

### 例子

*   罗杰·佩特

这是我的名字，这是一个标识符。它就像一个 URI，但不能是一个 URL，因为它不会告诉你我的位置或如何联系我。在这种情况下，仅在美国，它也恰好识别出至少 5 个其他人。

*   4914 West Bay Street, 拿骚, 巴哈马

这是一个定位器，它是该物理位置的标识符。它既像 URL 又像 URI（因为所有 URL 都是 URI），并且还[间接地](http://www.w3.org/TR/webarch/#indirect-identification)将我标识为“...的居民”。在这种情况下，它唯一地标识了我，但如果我有室友，情况就会改变。

我说“喜欢”是因为这些示例不遵循所需的语法。

### 流行的困惑

来自[维基百科](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)：

> 在计算中，统一资源定位符 (URL) 是统一资源标识符 (URI) 的子集，它指定已识别资源的可用位置以及检索它的机制。**在流行用法以及许多技术文档和口头讨论中，它经常被错误地用作 URI 的同义词**，... [强调我的]

由于这种常见的混淆，许多产品和文档错误地使用了一个术语而不是另一个，分配了它们自己的区别，或者同义地使用它们。

### URN

我的名字，Roger Pate，可能类似于[URN](http://en.wikipedia.org/wiki/Uniform_Resource_Name)（统一资源名称），除了那些[更受监管](https://stackoverflow.com/questions/2135450/why-is-urn-one-of-more-popular-formats-used-to-uniquely-identify-the-resource/3083561#3083561)并且旨在在空间和时间上*都是唯一的。*

因为我目前与其他人共享此名称，所以它不是全球唯一的，也不适合作为 URN。不过，就算没有其他家族用过这个名字，我也是以我祖父的名字命名的，所以也不会随着时间的推移而独树一帜。即使*不是*这样，以我的名字命名我的后代的可能性也使得它不适合作为 URN。

在这种严格的唯一性约束中，URN 与 URL 不同，尽管它们都共享 URI 的语法。

* * *

## 回答 #2

> 赞同：1880
> 
> 时间：2008-10-06T21:29:48.410

来自[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)：

> URI 可以进一步分类为定位符、名称或两者。术语“统一资源定位符”(URL) 指的是 URI 的子集，它除了标识资源之外，还通过描述资源的主要访问机制（例如，其网络“位置”）来提供定位资源的方法。术语“统一资源名称”（URN）在历史上一直用于指代“urn”方案[[RFC2141]](https://www.ietf.org/rfc/rfc2141.txt)下的两个 URI ，即使资源不再存在或变得不可用，它们也需要保持全局唯一和持久性，并且到具有名称属性的任何其他 URI。

所以所有的 URL 都是 URI，所有的 URN 都是 URI——但是 URN 和 URL 是不同的，所以你不能说所有的 URI 都是 URL。

如果您还没有阅读[Roger Pate 的回答](https://stackoverflow.com/a/1984225/22656)，我建议您也这样做。

* * *

## 回答 #3

> 赞同：757
> 
> 时间：2015-03-04T21:51:14.220

## URI——[统一资源标识符](https://en.wikipedia.org/wiki/Uniform_resource_identifier)

URI 是一种使用数字、字母和符号组成的短字符串来识别文档的标准。它们由[RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax](https://www.rfc-editor.org/rfc/rfc3986)定义。URL、URN 和 URC 都是URI*类型*。

## URL——[统一资源定位器](https://en.wikipedia.org/wiki/Uniform_resource_locator)

包含有关如何从其位置获取资源的信息。例如：

*   `http://example.com/mypage.html`
*   `ftp://example.com/download.zip`
*   `mailto:user@example.com`
*   `file:///home/user/file.txt`
*   `tel:1-888-555-5555`
*   `http://example.com/resource?foo=bar#fragment`
*   `/other/link.html`（相对 URL，仅在另一个 URL 的上下文中有用）

URL 总是以协议 ( `http`) 开头，通常包含诸如网络主机名 ( `example.com`) 和文档路径 ( `/foo/mypage.html`) 之类的信息。URL 可能有查询参数和片段标识符。

## URN --[统一资源名称](https://en.wikipedia.org/wiki/Uniform_resource_name)

通过唯一且持久的名称标识资源，但不一定告诉您如何在 Internet 上找到它。它通常以前缀开头，`urn:` 例如：

*   `urn:isbn:0451450523`通过 ISBN 号识别一本书。
*   `urn:uuid:6e8bc430-9c3a-11d9-9669-0800200c9a66`全局唯一标识符
*   `urn:publishing:book`- 将文档标识为书籍类型的 XML 命名空间。

URN 可以识别想法和概念。它们不限于识别文件。当 URN 确实表示文档时，它可以通过“解析器”转换为 URL。然后可以从 URL 下载该文档。

## URC——统一资源引用

指向有关文档的元数据而不是文档本身。URC 的一个示例是指向页面的 HTML 源代码，例如：`view-source:http://example.com/`

## [数据 URI](https://en.wikipedia.org/wiki/Data_URI_scheme)

数据可以直接放入 URI 中，而不是在 Internet 上定位或命名。一个例子是`data:,Hello%20World`。

* * *

# 经常问的问题

### 我听说我不应该再说 URL，为什么？

HTML 的 W3 规范说[`href`锚标记的](http://www.w3.org/TR/html401/struct/links.html#h-12.2)可以包含一个 URI，而不仅仅是一个 URL。您应该能够放入一个 URN，例如`<a href="urn:isbn:0451450523">`. 然后，您的浏览器会将该 URN 解析为 URL 并为您下载该书。

### 是否有浏览器真正知道如何通过 URN 获取文档？

据我所知，现代网络浏览器确实实现了数据 URI 方案。

### URL和URI之间的区别与它是相对还是绝对有关系吗？

不，相对 URL 和绝对 URL 都是 URL（和 URI）。

### URL和URI的区别跟有没有查询参数有关系吗？

否。带有和不带有查询参数的 URL 都是 URL（和 URI）。

### URL 和 URI 的区别与它是否有片段标识符有关系吗？

不。带有和不带有片段标识符的 URL 都是 URL（和 URI）。

### URL 和 URI 之间的区别是否与允许使用的字符有关？

不，URL 被定义为 URI 的严格子集。如果解析器允许 URL 中的字符但 URI 中不允许，则解析器中存在错误。规范详细说明了 URL 和 URI 的哪些部分允许使用哪些字符。某些字符可能只允许在 URL 的某些部分中使用，但字符本身并不是 URL 和 URI 之间的区别。

### 但是 W3C 现在不是说 URL 和 URI 是一回事吗？

是的。W3C 意识到对此有很多困惑。他们发布了一份[URI 澄清文件](http://www.w3.org/TR/uri-clarification/)，指出现在可以互换使用术语 URL 和 URI（表示 URI）。将 URI 严格划分为不同类型（如 URL、URN 和 URC）已不再有用。

### URI 可以既是 URL 又是 URN？

URN 的定义现在比我上面所说的要宽松。最新的关于 URI 的[RFC](http://tools.ietf.org/pdf/rfc3986.pdf)说，任何 URI 现在都可以是 URN（不管它是否以 开头`urn:`），只要它具有“名称的属性”。也就是说：即使资源不再存在或变得不可用，它也是全局唯一且持久的。一个例子：HTML 文档类型中使用的 URI，例如`http://www.w3.org/TR/html4/strict.dtd`. 即使 w3.org 网站上的页面被删除，该 URI 仍将继续命名 HTML4 过渡文档类型。

* * *

![URI/URL 维恩图](https://i.stack.imgur.com/FbaKm.png)

* * *

## 回答 #4

> 赞同：260
> 
> 时间：2009-12-31T06:51:06.120

总结：**一个URI标识，一个URL标识和定位。**

考虑莎士比亚戏剧《*罗密欧与朱丽叶*》的特定版本，您的家庭网络上有一个数字副本。

您可以将文本标识为`urn:isbn:0-486-27557-4`.
那将是一个 URI，但更具体地说是一个[**URN**](http://en.wikipedia.org/wiki/Uniform_Resource_Name) * 因为它**命名了 text**。

您还可以将文本标识为`file://hostname/sharename/RomeoAndJuliet.pdf`.
这也将是一个 URI，但更具体地说是一个**URL**，因为它**定位 text**。

*统一资源名称

*（请注意，我的示例改编自[维基百科](http://en.wikipedia.org/wiki/Uniform_Resource_Identifier)）*

* * *

## 回答 #5

> 赞同：143
> 
> 时间：2009-12-31T08:58:59.637

这些是一些写得很好但冗长的答案。**就 CodeIgniter 而言，**这是不同的：

**网址**- [http://example.com/some/page.html](http://example.com/some/page.html)

**URI** - /some/page.html

简而言之，URL 是在任何地方识别任何资源的完整方式，并且可以具有不同的协议，如 FTP、HTTP、SCP 等。

URI 是当前域上的资源，因此需要的信息较少。

在 CodeIgniter 使用 URL 或 URI 这个词的每一个例子中，这就是他们所说的区别，尽管在 web 的宏大计划中，它并不是 100% 正确的。

* * *

## 回答 #6

> 赞同：103
> 
> 时间：2017-07-21T17:50:21.490

**首先让你的头脑摆脱混乱，把它简单化，你就会明白。**

**URI => 统一资源标识符** 标识资源的完整地址，即位置、名称或两者。

**URL => 统一资源定位符** 标识资源的位置。

**URN => Uniform Resource Name** 标识资源的名称

**例子**

我们有地址**[https://www.google.com/folder/page.html](https://www.google.com/folder/page.html)**其中，

URI（统一资源标识符）=> [https://www.google.com/folder/page.html](https://www.google.com/folder/page.html)

URL（统一资源定位器）=> [https://www.google.com/](https://www.google.com/)

URN（统一资源名称）=> /folder/page.html

URI => (URL + URN) 或仅 URL 或仅 URN

* * *

## 回答 #7

> 赞同：67
> 
> 时间：2014-10-16T17:46:51.940

对已经发布的答案的一个小补充，这是一个总结理论的维恩图（来自 Prateek Joshi 的美丽[解释](http://prateekvjoshi.com/2014/02/22/url-vs-uri-vs-urn/)）：

![在此处输入图像描述](https://i.stack.imgur.com/aRdPS.jpg)

还有一个例子（也来自 Prateek 的网站）：

![在此处输入图像描述](https://i.stack.imgur.com/2iD7U.jpg)

* * *

## 回答 #8

> 赞同：65
> 
> 时间：2015-12-23T11:45:30.233

> **身份 = 名称和位置**

每个 URL( Uniform Resource **L** **ocator ) 抽象地****说都是一个 URI(Uniform Resource I** dentifier ) **，**但是**每个****URI**都不是一个 URL。**URI**的另一个子类是URN（**统一**资源**名称**），它是一个命名资源，但没有指定如何定位它们，如mailto，news，ISBN是URI。 [来源](https://docs.oracle.com/javase/8/docs/api/java/net/URI.html)

 ******[![在此处输入图像描述](https://i.stack.imgur.com/SntfL.png)](https://i.stack.imgur.com/SntfL.png)

**瓮：**

*   URN 格式：`urn:[namespace identifier]:[namespace specific string]`
*   urn: 和 : 代表自己。
*   [例子](https://en.wikipedia.org/wiki/Uniform_Resource_Name#Examples)：
*   瓮：uuid：6e8bc430-9c3a-11d9-9669-0800200c9a66
*   骨灰盒:ISSN:0167-6423
*   骨灰盒:isbn:096139210x
*   [Amazon 资源名称 (ARN)](https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html?shortFooter=true)是唯一标识 AWS 资源。
    *   ARN 格式：`arn:partition:service:region:account-id:resource`

**网址：**

*   网址格式：`[scheme]://[Domain][Port]/[path]?[queryString]#[fragmentId]`
*   :,//,? 和 # 代表他们自己。
*   方案是 https,ftp,gopher,mailto,news,telnet,file,man,info,whatis,ldap...
*   例子：
*   http://ip_server/path?query
*   ftp://ip_server/路径
*   邮寄地址：电子邮件地址
*   新闻：新闻组名称
*   telnet://ip_server/
*   文件：//ip_server/path_segments
*   ldap://hostport/dn?attributes?scope?filter?extensions

**类比：**
要联系一个人：驾驶（协议其他 SMS、电子邮件、电话）、地址（主机名其他电话号码、电子邮件 ID）和人名（具有相对路径的对象名称）。

* * *

## 回答 #9

> 赞同：60
> 
> 时间：2011-12-01T13:07:15.033

这是我作为网络专业人士遇到的最令人困惑且可能不相关的主题之一。

据我了解，URI 是对某事物的描述，遵循公认的格式，可以定义某事物的唯一名称（标识）或其位置。

有两个基本子集：

*   URL，定义位置（尤其是对于试图查找网页的浏览器）和
*   URN，它定义了某物的唯一名称。

我倾向于认为 URN 类似于 GUID。它们只是为事物提供唯一名称的标准化方法。就像在使用公司名称的命名空间声明中一样——它并不像在服务器上的某处对应于该文本行的资源——它只是唯一地标识某物。

我也倾向于完全避免使用 URI 这个术语，并且只在适当的时候使用 URL 或 URN 来讨论事物，因为它会引起很多混乱。我们真正应该尝试为人们回答的问题与其说是语义，不如说是在遇到这些术语时如何识别它们是否存在任何实际差异，从而改变编程情况的方法。例如，如果有人在对话中纠正我并说，“哦，那不是 URL，它是 URI”，我知道他们已经满了。如果有人说，“我们使用 URN 来定义资源”，我更可能理解我们只是唯一地命名它，而不是在服务器上定位它。

如果我离基地很远，请告诉我！

* * *

## 回答 #10

> 赞同：44
> 
> 时间：2008-10-06T21:30:16.553

URI => [http://en.wikipedia.org/wiki/Uniform_Resource_Identifier](http://en.wikipedia.org/wiki/Uniform_Resource_Identifier)

URL 是 URI 的子集（也包含 URN）。

基本上，URI 是一个通用标识符，其中 URL 指定位置，URN 指定名称。

* * *

## 回答 #11

> 赞同：36
> 
> 时间：2009-12-31T07:38:04.123

在考虑 URI 时，我喜欢使用的另一个示例是 XML 文档的 xmlns 属性：

```
<rootElement xmlns:myPrefix="com.mycompany.mynode">
    <myPrefix:aNode>some text</myPrefix:aNode>
</rootElement> 
```

在这种情况下，com.mycompany.mynode 将是一个 URI，它为在我的 XML 文档中使用它的所有元素唯一标识“myPrefix”命名空间。这不是 URL，因为它仅用于识别，而不是用于定位某些东西本身。

* * *

## 回答 #12

> 赞同：28
> 
> 时间：2008-10-06T21:28:43.717

[他们是同一个东西](http://www.tbray.org/ongoing/When/200x/2003/02/27/URL)。URI 是 URL 的概括。最初，URI 计划分为 URL（地址）和 URN（名称），但是 URL 和 URI 之间几乎没有区别，并且 http URI 被用作命名空间，即使它们实际上并没有找到任何资源。

* * *

## 回答 #13

> 赞同：28
> 
> 时间：2009-12-31T12:59:17.117

由于难以清楚地区分 URI 和 URL，据我所知，W3C 不再区分 URI 和 URL ( [http://www.w3.org/Addressing/](http://www.w3.org/Addressing/) )。

* * *

## 回答 #14

> 赞同：28
> 
> 时间：2016-06-02T11:16:26.660

[![URI 和 URL](https://i.stack.imgur.com/RKFwk.png)](https://i.stack.imgur.com/RKFwk.png)

> URI、URL、URN

如上图所示，这里有三个不同的组件在起作用。在讨论此类问题时，通常最好找到源头，所以这里是 Tim Berners-Lee 等人的摘录。人。在 [RFC 3986 中：统一资源标识符 (URI)：通用语法：](https://www.rfc-editor.org/rfc/rfc3986)

> 统一资源标识符 (URI) 是一个紧凑的字符序列，用于标识抽象或物理资源。
> 
> URI 可以进一步分类为定位符、名称或两者。术语“统一资源定位符”(URL) 指的是 URI 的子集，它除了标识资源外，还通过描述资源的主要访问机制（例如，其网络“位置”）来提供定位资源的方法。

* * *

## 回答 #15

> 赞同：21
> 
> 时间：2008-10-06T21:30:40.017

URI 是 URL 和 URN 的超类。Wikipedia 有一篇关于它们的[好文章](http://en.wikipedia.org/wiki/Uniform_Resource_Identifier)，其中包含指向正确 RFC 集的链接。

* * *

## 回答 #16

> 赞同：16
> 
> 时间：2008-10-06T21:30:02.870

维基百科将在此处提供您需要的所有信息。引用[http://en.wikipedia.org/wiki/URI](http://en.wikipedia.org/wiki/URI)：

> URL 是一个 URI，它除了标识资源外，还通过描述资源的主要访问机制或网络“位置”来提供对资源进行操作或获取资源表示的方法。

* * *

## 回答 #17

> 赞同：16
> 
> 时间：2012-09-08T08:17:25.833

**网址**

URL 是 URI 的一种特殊形式，它定义了特定资源的网络位置。与 URN 不同，URL 定义了如何获取资源。我们每天都以 etc 的形式使用 URL `http://example.com`。但是 URL 不一定是 HTTP URL，它也可以是`ftp://example.com`etc。

**URI**

URI 通过位置或名称或两者来标识资源。大多数情况下，我们大多数人使用定义资源位置的 URI。在我看来，URI 可以通过名称和位置来识别资源这一事实导致了很多混乱。URI 有两个特化，称为 URL 和 URN。

**URL和URI之间的区别**

URI 是某些资源的标识符，但 URL 为您提供获取该资源的特定信息。URI 是一个 URL，正如一位评论者指出的那样，现在在描述应用程序时使用 URL 被认为是不正确的。通常，如果 URL 描述了资源的位置和名称，则使用的术语是 URI。由于我们大多数人每天都会遇到这种情况，因此 URI 是正确的术语。

* * *

## 回答 #18

> 赞同：14
> 
> 时间：2009-12-31T07:51:39.893

URI 通过位置或名称或两者来标识资源。大多数情况下，我们大多数人使用定义资源位置的 URI。在我看来，URI 可以通过名称和位置来识别资源这一事实导致了很多混乱。URI 有两个特化，称为 URL 和 URN。

URL 是 URI 的一种特殊形式，它定义了特定资源的网络位置。与 URN 不同，URL 定义了如何获取资源。我们每天都使用[http://stackoverflow.com](http://stackoverflow.com)等形式的 URL。但是 URL 不一定是 HTTP URL，它可以是`ftp://example.com`，等等。

* * *

## 回答 #19

> 赞同：14
> 
> 时间：2014-08-28T09:29:00.243

根据[RFC 3986](https://en.wikipedia.org/wiki/Uniform_Resource_Identifier#Syntax)，URI 由以下部分组成：

```
scheme://authority/path?query 
```

URI 描述了用于访问服务器（*权限）上的资源（**路径*）或应用程序（*查询*）的协议。

 *![在此处输入图像描述](https://i.stack.imgur.com/HGWwt.png)

所有的 URL 都是 URI，所有的 URN 都是 URI，但所有的 URI 都不是 URL。

更多详情请参考：

> [维基百科](http://en.wikipedia.org/wiki/Uniform_resource_identifier)

* * *

## 回答 #20

> 赞同：12
> 
> 时间：2009-12-31T09:57:27.737

尽管术语 URI 和 URL 是严格定义的，但许多术语将这些术语用于定义它们之外的其他事物。

我们以 Apache 为例。如果从 Apache 服务器请求[http://example.com/foo](http://example.com/foo)，您将设置以下环境变量：

*   `REDIRECT_URL`：`/foo`
*   `REQUEST_URI`：`/foo`

启用 mod_rewrite 后，您还将拥有以下变量：

*   `REDIRECT_SCRIPT_URL`：`/foo`
*   `REDIRECT_SCRIPT_URI`：`http://example.com/foo`
*   `SCRIPT_URL`：`/foo`
*   `SCRIPT_URI`：`http://example.com/foo`

这可能是一些混乱的原因。

* * *

## 回答 #21

> 赞同：11
> 
> 时间：2009-12-31T06:33:44.160

请参阅[此文档](http://www.w3.org/TR/uri-clarification/#contemporary)。具体来说，

> URL 是一种 URI，它通过其主要访问机制的表示（例如，其网络“位置”）而不是通过它可能具有的某些其他属性来标识资源。

这不是一个非常明确的术语，真的。

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2012-10-06T20:05:52.917

通读帖子后，我发现了一些非常相关的评论。简而言之，URL 和 URI 定义之间的混淆部分是基于哪个定义取决于哪个定义，以及在软件开发中对 URI 一词的非正式使用。

根据定义，URL 是 URI [RFC2396] 的子集。URI 包含 URN 和 URL。URI 和 URL 都有自己的特定语法，赋予它们是 URI 或 URL 的状态。URN 用于唯一标识资源，而 URL 用于定位资源。请注意，一个资源可以有多个 URL，但只有一个 URN。[RFC2611]

作为 Web 开发人员和程序员，我们几乎总是关注 URL，因此也关注 URI。现在，一个 URL 被专门定义为包含所有部分 scheme:scheme-specific-part，例如[https://stackoverflow.com/questions](https://stackoverflow.com/questions)。这是一个 URL，它也是一个 URI。现在考虑嵌入在页面中的相对链接，例如 ../index.html。根据定义，这不再是 URL。它仍然是所谓的“URI-reference”[RFC2396]。

我相信当使用 URI 这个词来指代相对路径时，“URI-reference”实际上就是人们所想到的。因此，非正式地，软件系统使用 URI 来指代相对路径，使用 URL 来指代绝对地址。所以从这个意义上说，相对路径不再是 URL，而是 URI。

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2012-03-10T17:30:22.700

URI 源于需要以统一和连贯的方式识别 Web 上的**资源和其他 Internet 资源**（例如电子邮箱）。因此，可以引入一种新型的*小部件：* URI 来标识*小部件*资源或使用*tel:* URI 来获得 Web 链接，从而在调用时进行电话呼叫。

一些 URI 提供定位资源的信息（例如 DNS 主机名和该机器上的路径），而另一些则用作纯资源名称。该**URL**保留用于**作为资源定位器**的标识符，包括诸如*http://stackoverflow.com*之类的“http”URL ，它标识主机上给定路径处的网页。另一个示例是“mailto” URL，例如*mailto:fred@mail.org*，它标识给定地址的邮箱。

**URN**是用作**纯资源名称**而不是定位器的 URI。例如，URI：*mid:0E4FC272-5C02-11D9-B115-000A95B55BC8@stackoverflow.com*是一个 URN，用于标识在其“消息 ID”字段中包含它的电子邮件。URI 用于将该消息与任何其他电子邮件消息区分开来。但它本身并不提供消息在任何商店中的地址。

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2012-08-29T01:31:59.003

这是我的简化：

URN：唯一的资源名称，即“什么”（例如 urn:issn:1234-5678 ）。这是唯一的......因为没有两个不同的文档可以有相同的骨灰盒。有点像“uuid”

URL：“在哪里”可以找到它（例如[https://google.com/pub?issnid=1234-5678](https://google.com/pub?issnid=1234-5678) .. 或 [ftp://somesite.com/doc8.pdf](ftp://somesite.com/doc8.pdf)）

URI：可以是 URN 或 URL。这个模糊的定义要归功于 W3C 和 IETF 产生的 RFC 3986。

URI 的定义多年来发生了变化，因此大多数人感到困惑是有道理的。但是，您现在可以放心，您可以将[http://somesite.com/something](http://somesite.com/something)作为 URL 或 URI 引用……无论哪种方式，您都是正确的（至少目前是这样…… .)

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2015-03-10T18:24:59.610

为了回答这个问题，我将依靠[我修改为另一个问题的答案](https://stackoverflow.com/a/24377823/117471)。URI 的一个很好的例子是您如何识别 Amazon S3 资源。让我们来：

`s3://www-example-com/index.html` [**[无花果。1]**]

我创建的缓存副本

`http://www.example.com/index.html` [**[无花果。2]**]

在亚马逊的**S3-US-West-2**数据中心。

即使 StackOverflow 允许我超链接到`s3://` [~~协议~~](http://en.wikipedia.org/w/index.php?search=URI%20protocols)方案，它也不会对您*定位*资源有任何好处。因为它*标识*一个*Resource*，**图。1**是一个有效的 URI。它也是一个有效的 URN，因为 Amazon 要求存储桶（他们`authority`对 URI 部分的术语）在数据中心之间是唯一的。它*有助于*定位它，但它并不表示数据中心。因此它不能用作 URL。

那么，在这种情况下，URI、URL 和 URN 有何不同？

*   **如图。1**是一个 URI
*   **如图。1**是一个 URN
*   **如图。2**是一个URI
*   **如图。2**是一个网址
*   图的网址**。1**是[http://www-example-com.s3-website-us-west-2.amazonaws.com/](http://www-example-com.s3-website-us-west-2.amazonaws.com/)
    *   还有[http://www-example-com.s3.amazonaws.com/index.html](http://www-example-com.s3.amazonaws.com/index.html)
    *   但不是[http://www-example-com.s3.amazonaws.com/](http://www-example-com.s3.amazonaws.com/)（没有数据中心和文件名对于 Amazon S3 来说太通用了）

**注意：** RFC 3986 将 URI 定义为`scheme://authority/path?query#fragment`

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2010-05-15T14:25:47.183

我想知道同样的事情，我发现了这个：[http](http://docs.kohanaphp.com/helpers/url) ://docs.kohanaphp.com/helpers/url 。

`url::current()`您可以使用该方法看到一个清晰的示例。如果您有此**URL**：`http://example.com/kohana/index.php/welcome/home.html?query=string`然后 using`url:current()`为您提供**URI**，根据文档，该 URI 是：*welcome/home*

* * *

## 回答 #27

> 赞同：8
> 
> 时间：2020-04-05T11:37:15.627

最好的（技术）总结*imo*是这个

[IRI、URI、URL、URN 以及它们与](https://fusion.cs.uni-jena.de/fusion/blog/2016/11/18/iri-uri-url-urn-and-their-differences/)Jan Martin Keil 的区别：

## IRI、URI、URL、URN及其区别

每个与语义网打交道的人都会反复遇到**IRI**、**URI**、**URL**和**URN**等术语。然而，我经常观察到它们的确切含义存在一些混淆。当然，其他人也注意到了这一点（参见例如 RFC3305 或在 Google 上搜索）。老实说，我什至一开始自己也很困惑。但实际上问题并没有那么复杂。让我们看一下上述术语的定义，看看有什么区别：

### URI

**统一资源标识符**是标识抽象或物理资源的紧凑字符序列。字符集仅限于 US-ASCII，不包括一些保留字符。允许字符集之外的字符可以使用百分比编码来表示。URI 可以用作定位器、名称或两者兼而有之。如果一个 URI 是一个定位器，它描述了一个资源的主要访问机制。如果 URI 是一个名称，它通过给它一个唯一的名称来标识一个资源。URI 的语法和语义的确切规范取决于使用的方案，该方案由第一个冒号之前的字符定义。[RFC3986]

### 瓮

**统一资源名称**是方案 urn 中的URI，旨在用作持久的、与位置无关的资源标识符。从历史上看，该术语也指任何 URI。[RFC3986] URN 由命名空间标识符 (NID) 和命名空间特定字符串 (NSS) 组成： urn:: NSS 的语法和语义对每个 NID 都是特定的。除了已注册的 NID 之外，还有几个未经过正式注册过程的 NID。[RFC2141]

### 网址

**统一资源定位器**是一个URI，它除了标识资源外，还通过描述资源的主要访问机制 [RFC3986] 来提供定位资源的方法。由于没有通过一组方案对 URL 的准确定义，“URL 是一个有用但非正式的概念”，通常指的是不包含 URN 的 URI 子集 [RFC3305]。

### 红外线

**国际化资源标识符**的定义与 URI 类似，但字符集扩展为通用编码字符集。因此，它可以包含除保留字符之外的任何拉丁字符和非拉丁字符。代替扩展 URI 的定义，引入术语 IRI 是为了明确区分并避免不兼容。在支持通用编码字符集的情况下，IRI 旨在替换 URI 来识别资源。根据定义，每个 URI 都是一个 IRI。此外，IRI 到 URI 有一个定义的满射映射：每个 IRI 都可以映射到一个 URI，但不同的 IRI 可能映射到同一个 URI。因此，从 URI 到 IRI 的转换可能不会产生原始 IRI。[RFC3987]

### 总结一下，我们可以说：

```
IRI is a superset of URI (IRI ⊃ URI)
URI is a superset of URL (URI ⊃ URL)
URI is a superset of URN (URI ⊃ URN)
URL and URN are disjoint (URL ∩ URN = ∅) 
```

### 语义网问题的结论

RDF 明确允许使用 IRI 来命名实体 [RFC3987]。这意味着我们可以使用实体名称中的几乎每个字符。另一方面，我们经常不得不处理早期状态的软件。因此，使用非 ASCII 字符不太可能遇到问题。因此，我建议避免实体的非 URI 名称，并建议使用 http URIs [LINKED-DATA]。简而言之：仅使用 URL 来命名您的实体。当然，我们可以引用由 URN 命名的现有实体。但是，我们应该避免新创建这种标识符。

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2015-02-10T10:09:13.003

**容易解释：**

让我们假设以下

URI 是你的名字

URL 是您的地址和您的姓名，以便与您交流。

*   我叫洛约拉

    **洛约拉是 URI**

*   我的地址是 TN，钦奈 600001。

**TN, Chennai 600 001, Loyola 是 URL**

希望你能理解，

现在让我们看一个精确的例子

**[http://www.google.com/fistpage.html](http://www.google.com/fistpage.html)**

在上面，您可以使用以下**[http://www.google.com/fistpage.html](http://www.google.com/fistpage.html)** ( **URL ) 与名为****firstpage.html** ( **URI** ) 的页面进行通信。

 **因此 URI 是 URL 的子集，但反之则不然。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2013-08-11T04:41:38.363

我发现：

* * *

一个统一的资源标识符 (URI) 代表了一个大图景。您可以拆分 URI / URI 可以分类为定位器（统一资源定位器 - URL）或名称（统一资源名称 - URN），或两者兼而有之。所以基本上，URN 的功能就像一个人的名字，而 URL 描述了那个人的地址。长话短说，一个URN定义了一个项目的身份，而URL提供了定义找到它的方法，最后封装这两个概念就是URI

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2011-04-27T09:09:37.643

答案是模棱两可的。在 Java 中，它经常以这种方式使用：

统一资源定位符 (URL) 是用于标识 Internet 资源的术语，包括方案（http、https、ftp、新闻等）。例如[URI、URL 和 URN 之间有什么区别？](https://stackoverflow.com/questions/176264/whats-the-difference-between-a-uri-and-a-url)

统一资源标识符 (URI) 用于标识 Web 服务器中的单个文档：例如 /questions/176264/whats-the-difference-between-a-uri-and-a-url

在 Java servlet 中，URI 经常引用没有 Web 应用程序上下文的文档。

* * *

## 回答 #31

> 赞同：-3
> 
> 时间：2016-03-07T18:56:49.703

不要忘记 URN。URI 和 URL 都是 URN。URL 有一个位置：

```
URI: foo
URL: http://some.domain.com/foo
URL: http://some.domain.com:8080/foo
URL: ftp://some.domain.com/foo 
```

他们都是URN。

# c# - 为什么我应该同时进行单元测试和 Web 测试（而不仅仅是 Web 测试）？

> ID：176267
> 
> 赞同：16
> 
> 时间：2008-10-06T21:28:13.547
> 
> 标签：c#, asp.net, visual-studio, unit-testing

我目前的立场是：如果我使用 Web 测试（在我的情况下是通过 VS.NET'08 测试工具和 WatiN，可能）彻底测试我的 ASP.NET 应用程序，并具有代码覆盖率和广泛的数据，我应该没有需要编写单独的单元测试，因为我的代码将通过所有层与 UI 一起进行测试。代码覆盖率将确保我触及每一个功能性代码（或揭示未使用的代码），并且我可以提供涵盖所有合理预期条件的数据。

但是，如果您有不同的意见，我想知道：

1.  单元测试提供了哪些*额外*的好处，证明了将其包含在项目中的努力是合理的（请记住，无论如何我都在进行 Web 测试，因此在许多情况下，单元测试将涵盖 Web 测试已经涵盖的代码）。

2.  你能用具体的例子详细解释你的原因吗？我经常看到诸如“这不是它的目的”或“它促进更高质量”之类的回答——这实际上并没有解决我必须面对的实际问题，即，我如何才能证明——以切实的结果——花更多的钱时间测试？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-06T21:47:11.073

> 代码覆盖率将确保我*打到*每一个功能代码

### “命中”*并不*意味着“测试”

只进行网络测试的问题在于，它只能确保您*点击*代码，并且在高层次上*看起来是正确的。*

仅仅因为您加载了页面并且它没有崩溃，并不意味着它实际上可以正常工作。以下是我遇到的一些事情，其中​​“Web 测试”覆盖了 100% 的代码，但却完全遗漏了一些单元测试不会出现的非常严重的错误。

1.  页面从缓存中正确加载，但实际数据库已损坏
2.  该页面从数据库中加载了每个项目，但只显示了第一个项目 - 尽管它在生产中完全失败，但它似乎很好，因为它花费了太长时间
3.  页面显示了一个看似有效的数字，实际上是错误的，但是因为1000000很容易被误认为100000，所以没有被拾取
4.  页面巧合显示了一个有效数字 - 10x50 与 25x20 相同，但其中一个是错误的
5.  该页面应该向数据库添加一个日志条目，但用户看不到它，因此它没有被看到。
6.  身份验证被绕过以使 Web 测试实际工作，因此我们错过了身份验证代码中的一个明显错误。

很容易想出数百个这样的例子。

您需要两个单元测试以确保您的代码实际上在低级别执行它应该执行的操作，然后在这些测试之上进行功能/集成（您称为 Web）测试，以证明它在以下情况下确实有效所有那些经过单元测试的小块都链接在一起。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T21:35:00.397

单元测试的周转速度可能比 Web 测试快得多。这不仅在开发时间方面是正确的（如果你可以直接获得它，那么你可以更容易地单独测试一个方法，而不是你必须构建一个最终会在几层之后命中它的特定查询），而且在执行时间（按顺序执行数千个请求将比执行数千次短方法花费更长的时间）。

单元测试将测试小的功能单元，因此当它们失败时，您应该能够很容易地找出问题所在。

此外，使用单元测试模拟依赖项比使用完整的前端要容易得多——除非我错过了一些非常酷的东西。（几年前，我研究了 mocking 和 web testing 如何集成，当时没有什么合适的。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-06T21:51:17.697

单元测试通常不能证明任何给定的功能集都有效——至少它不应该如此。它证明您的班级合同按您的预期工作。

验收测试更以客户要求为导向。每个需求都应该有一个验收测试，但验收测试和单元测试之间实际上没有任何要求——它们甚至可能不在同一个框架中。

单元测试可用于推动代码开发，而重新测试的速度是一个重要因素。测试时，您通常会删除被测类依赖的部分以单独进行测试。

验收测试系统就像您交付系统一样——从 GUI 到数据库。有时它们需要数小时或数天（或数周）才能运行。

如果您开始将其视为两种完全不同的野兽，您将成为更有效的测试者。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T21:38:08.720

好的、专注的单元测试可以在问题出现时更快地发现和解决问题。当一个编写良好的单元测试失败时，您几乎知道失败意味着什么以及导致失败的原因。

此外，它们通常运行得更快，这意味着您更有可能在开发过程中作为编辑-编译-测试周期的一部分运行它们（而不是仅在您即将签入时）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T21:58:56.637

当您编写单元测试时，您将被迫以更好的方式编写代码。更松耦合，更面向对象。这将导致更好的架构和更灵活的系统。

如果您以 TDD 样式编写单元测试，您可能不会编写太多不必要的代码，因为您将专注于微小的步骤，只做必要的。

在进行重构以改进代码以提高可维护性并减少代码异味时，您将更有信心。

并且单元测试本身将作为系统做什么和不做什么的详尽文档。

这些只是我在工作中应用 TDD 时注意到的几个好处示例。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-17T19:16:42.343

另一个方面 - 原谅它所处的有点理想的环境：

假设您有 3 个组件最终必须一起工作。每个都可以通过 5 个单元测试单独进行*完全单元测试*（无论这意味着什么）。这使得**5 + 5 + 5 = 15 个**单元测试可以完全覆盖。

现在，如果您的集成/网络/组合测试可以一起测试所有组件，那么您需要（记住这个抽象场景的理想世界）**5 * 5 * 5 = 125 个**测试所有排列以给您相同的结果上面的 15 个测试用例（假设您甚至可以触发所有排列，否则在您扩展组件时可能会出现未经测试/未指定的行为可能会咬到您）。

此外，如果功能发生变化，125 个测试用例的设置会明显更复杂、周转时间更长，并且可维护性会大大降低。我宁愿选择 15 个单元测试加上一些基本的 Web 测试，以确保组件的连接正确。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T21:39:10.153

单元测试为您提供了速度，最重要的是，可以准确地确定引入故障或错误的位置。它使您能够测试与其他所有组件隔离的每个组件，并确保它按应有的方式工作。

例如，如果您有一个 Web 测试，它将 Ajax 请求发送回服务器上的服务，然后访问数据库，然后失败。是 Javascript、服务、业务逻辑还是数据库导致了问题？

如果您对每个服务单独进行单元测试，对数据库或每个业务逻辑单元进行存根/模拟，那么您更有可能确切地知道错误在哪里。单元测试不是关于覆盖（尽管很重要），而是更多关于隔离。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T22:12:13.050

几乎正如 Dijkstra 所说：单元测试只能用来证明软件有缺陷，而不是证明它没有缺陷。所以，一般来说，每条代码路径一次（并获得 100% 的覆盖率）与测试无关——它只是有助于消除比特腐烂。

如果您按书本行事，则只有在编写了触发该错误的单元测试后，才应消除每个严重的错误。巧合的是，修复错误意味着这个特定的单元测试不再失败。将来，此单元测试会检查此特定错误是否已修复。

编写触发特定错误的单元测试比编写仅执行此操作且不运行大量完全不相关的代码的端到端（Web）测试要容易得多（这也可能失败和混乱进行根本原因分析）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-06T22:22:44.327

单元测试测试每个组件是否工作。这些对于在接近它们创建时发现缺陷非常有帮助，这大大降低了修复缺陷的成本，并大大减少了最终在您的版本中出现的缺陷数量。此外，良好的单元测试使重构变得更容易和更健壮。

集成测试（或本例中的“web”测试）也非常重要，但它是比单元测试更晚的防线。单个集成测试涵盖了如此庞大的代码，以至于当一个失败时，需要进行大量调查以确定导致失败的缺陷（或可能的缺陷组）。这是代价高昂的，尤其是当您尝试测试发布版本以将其推出时。考虑到在修复程序中引入错误的可能性通常非常高，并且故障阻碍了对版本的进一步测试（这对开发周期来说是极其昂贵的），这将更加昂贵。

相反，当单元测试失败时，您确切地知道有缺陷的代码在哪里，并且您通常确切地知道代码做错了什么。此外，单元测试失败一次应该只影响一个开发人员，并在签入代码之前修复。

晚点修复错误总是比早点更昂贵。总是。

考虑制造一辆汽车。您会等到整车下线再测试每个组件是否正常工作吗？那时，如果您发现 CD 播放器、发动机、空调或巡航控制系统无法正常工作，您必须让整车下线，修复问题，然后重新测试所有内容（希望不会揭示任何新的缺陷）。这显然是错误的做法，就像尝试发布软件时只测试它是否在流程结束时而不是在从头开始的每个重要步骤时测试它显然是错误的一样。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T21:40:07.703

这取决于 ASP.NET 应用程序的架构如何。如果网页只是连接底层业务逻辑层或数据访问层，那么独立于 ASP.NET 状态模型的单元测试对开发人员来说比类似的 WaitiN 测试更快并且运行更快。

我最近在 Visual Studio 2003 中开发了一个遗留 ASP.NET 应用程序的区域，其中 NUnit 作为测试框架。以前的测试涉及通过 UI 测试来确保功能正确实现，而 90% 的测试是在不需要 UI 交互的情况下进行的。

我遇到的唯一问题是时间估计——Trac 中计划的任务之一是数据访问/业务逻辑需要 1 天，UI 创建和测试需要 2 天。NUnit 在数据访问/业务逻辑上运行，这部分开发的时间从 1 天缩短到 2 天。UI 开发时间减少到了 1/2 天。

随着新模块中的其他任务被添加到应用程序中，这将继续进行。单元测试更快地发现错误，并且以一种不那么痛苦的方式（对我而言），并且我对应用程序按预期运行更有信心。更好的是，单元测试是非常可重复的，因为它们不依赖于任何 UI 重新设计，因此往往不那么脆弱，因为设计更改在编译时失败，而不是在运行时失败。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T21:40:09.887

单元测试允许进行更严格的性能测试，并且更容易确定瓶颈发生在哪里。对于大型应用程序，当 10,000 个用户同时访问一个方法时，如果该方法需要 1/100 秒的时间来执行，性能就会成为一个主要问题，这可能是因为数据库查询编写得不好，因为现在一些用户必须等待页面加载最多 10 秒。我知道我个人不会等待页面加载那么久，并且会移动到不同的地方。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-06T22:09:55.490

单元测试允许您在添加复杂的前端之前专注于获取数据、应用规则和验证业务流程的逻辑。在编写和执行单元测试时，我知道应用程序的基础架构将支持我在进程之间来回传递的数据类型，我的事务可以正常工作等。

换句话说，在您开始验收测试时，可能会更好地隔离潜在的故障点，因为您已经通过单元测试解决了代码中的潜在错误。通过单元测试的历史，您会知道只有某些模块会抛出某些错误。这使得追踪罪魁祸首代码变得更加容易。

# continuous-integration - 将虚拟机映像创建为持续集成工件？

> ID：176273
> 
> 赞同：11
> 
> 时间：2008-10-06T21:29:41.810
> 
> 标签：continuous-integration, hudson, vmware, virtualization

我目前正在开发一种服务器端产品，该产品在新服务器上部署有点复杂，这使其成为在 VM 中进行测试的理想候选者。我们已经在使用 Hudson 作为我们的 CI 系统，我真的很希望能够使用最新最好的软件部署一个虚拟机映像作为构建工件。

那么，究竟是如何做到这一点的呢？为此建议使用什么 VM 软件？需要编写多少脚本才能完成此任务？在这里使用 Windows 2003 Server 作为操作系统时有什么问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T07:31:38.320

很抱歉在这里拒绝任何人接受的答案，但根据进一步的研究（感谢您的回答！），我找到了一个更好的解决方案，并想总结一下我的发现。

首先，VirtualBox 和 VMWare Server 都是很棒的产品，而且由于都是免费的，每个都值得评估。我们决定使用 VMWare Server，因为它是一个更成熟的产品，我们可以在需要时获得对它的支持。这一点尤其重要，因为我们也在考虑将我们的软件作为一个 VM 分发给客户端，而不是一个特殊的服务器安装，假设 VMWare Player 的开销不会太高。此外，还有一个名为 VIX 的[VMWare 脚本接口](http://www.vmware.com/support/developer/vix-api/)，可以使用它直接将文件安装到 VM，而无需安装 SSH 或 SFTP，这是一个很大的优势。

所以我们的解决方案基本上如下......首先我们创建一个带有操作系统的“vanilla”VM映像，没有别的，并将其签入存储库。然后，我们编写一个脚本作为我们的安装程序，将 Hudson 创建的工件放在 VM 上。此脚本应具有直接、通过 SFTP 和通过 VIX 复制文件的接口。这将允许我们继续直接在目标机器上分发软件，或者通过我们选择的 VM。然后将此生成的图像作为 CI 服务器的工件进行压缩和分发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T21:59:47.773

无论使用哪种 VM 软件（我也可以推荐 VirtualBox），我认为您正在查看以下场景：

1.  构建完成
2.  CI 启动虚拟机（或者它一直在运行）
3.  CI 使用 scp/sftp 通过网络将构建上传到 VM
4.  CI 使用 ssh（如果在 VM 中运行的目标操作系统上可用）或其他远程命令执行工具来触发在 VM 环境中的安装

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T22:17:20.060

VMWare Server 是免费且非常稳定的产品。它还使您能够创建 VM 切片的快照并在需要时回滚到虚拟机的先前版本。它将在 Win 2003 上运行良好。

在为您的构建配置新的 VM 片方面，您可以简单地复制并粘贴包含 VMWare 文件的文件夹，更改新 VM 的 SID 和 IP，然后您就拥有了一台新机器。需要 15 分钟，具体取决于 VM 切片的大小。无需编写脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T21:30:54.303

如果您使用 VirtualBox，您需要考虑无头运行它，因为它会在您的服务器上。通常，VirtualBox 作为桌面应用程序运行，但可以从命令行启动虚拟机并通过 RDP 访问虚拟机。

```
VBoxManage startvm "Windows 2003 Server" -type vrdp 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-08T18:56:21.570

我们在这个场景中使用 Jenkins + Vagrant + Chef。

因此，您可以执行以下过程：

*   使用 vagrant 配置脚本（Chef 或 Puppet）对您的 VM 环境进行版本控制

*   使用 Jenkins/Hudson 构建您的系统

*   运行 Vagrant 脚本以从 CI 输出中获取最后一个稳定版本

*   保存 VM 状态以供将来重用。

参考：

vagrantup.com

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T21:41:51.803

我会推荐[VirtualBox](http://www.virtualbox.org/)。它是免费的并且有一个定义良好的编程接口，尽管我个人没有在自动构建的情况下使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T07:48:01.577

选择 VMWare 目前并不是一个糟糕的选择。

但是，就像VMWare 支持VMWare 服务器一样，SUN 也支持VirtualBOX。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T17:20:26.990

您也可以使用免费的 VMWare Studio 完成此任务。基本工作流程如下： 1\. 创建一个描述您的虚拟机的 XML 文件 2\. 使用 studio 创建 shell。3\. 使用 VMWare 服务器配置虚拟机。

# php - 你如何从php中的URL中去除域名？

> ID：176284
> 
> 赞同：53
> 
> 时间：2008-10-06T21:31:27.207
> 
> 标签：php, urlparse

我正在寻找一种方法（或函数）来去除输入函数的任何 URL 的 domain.ext 部分。域扩展名可以是任何东西（.com、.co.uk、.nl、.whatever），输入的 URL 可以是从[http://www.domain.com](http://www.domain.com)到 www.domain.com/path的任何东西/script.php?=随便

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-10-06T21:47:51.620

[parse_url](http://www.php.net/manual/en/function.parse-url.php)将 URL 转换为关联数组：

```
php > $foo = "http://www.example.com/foo/bar?hat=bowler&accessory=cane";
php > $blah = parse_url($foo);
php > print_r($blah);
Array
(
    [scheme] => http
    [host] => www.example.com
    [path] => /foo/bar
    [query] => hat=bowler&accessory=cane
) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T21:37:03.387

您可以使用[parse_url()](http://www.php.net/manual/en/function.parse-url.php)来执行此操作：

```
$url = 'http://www.example.com';
$domain = parse_url($url, PHP_URL_HOST);
$domain = str_replace('www.','',$domain); 
```

在这个例子中，$domain 应该包含 example.com，不管它是否有 www。它也适用于 .co.uk 等域

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-10T10:20:50.957

你也可以写一个正则表达式来得到你想要的。

这是我的尝试：

```
$pattern = '/\w+\..{2,3}(?:\..{2,3})?(?:$|(?=\/))/i';
$url = 'http://www.example.com/foo/bar?hat=bowler&accessory=cane';
if (preg_match($pattern, $url, $matches) === 1) {
    echo $matches[0];
} 
```

输出是：

```
example.com 
```

此模式还考虑了诸如“example.com.au”之类的域。

注意：我没有查阅相关的 RFC。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-08-19T14:36:18.870

以下代码将从绝对 URL 中修剪协议、域和端口：

```
$urlWithoutDomain = preg_replace('#^.+://[^/]+#', '', $url); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-05T16:23:26.697

这里有几个简单的函数可以从普通或长域 (test.sub.domain.com) 或 url (http://www.example.com) 获取根域 (example.com)。

```
/**
 * Get root domain from full domain
 * @param string $domain
 */
public function getRootDomain($domain)
{
    $domain = explode('.', $domain);

    $tld = array_pop($domain);
    $name = array_pop($domain);

    $domain = "$name.$tld";

    return $domain;
}

/**
 * Get domain name from url
 * @param string $url
 */
public function getDomainFromUrl($url)
{
    $domain = parse_url($url, PHP_URL_HOST);
    $domain = $this->getRootDomain($domain);

    return $domain;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-04T15:09:34.403

解决了这个...

假设我们正在调用 dev.mysite.com，我们想要提取“mysite.com”

```
$requestedServerName = $_SERVER['SERVER_NAME']; // = dev.mysite.com

$thisSite = explode('.', $requestedServerName); // site name now an array

array_shift($thisSite); //chop off the first array entry eg 'dev'

$thisSite = join('.', $thisSite); //join it back together with dots ;)

echo $thisSite; //outputs 'mysite.com' 
```

也可以与 mysite.co.uk 一起使用，因此应该可以在任何地方使用 :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-24T21:11:07.863

我花了一些时间思考为此使用正则表达式是否有意义，但最后我认为不是。

firstresponder 的正则表达式几乎让我相信这是最好的方法，但它不适用于缺少斜杠的任何内容（例如[http://example.com](http://example.com)）。我用以下方法解决了这个问题：`'/\w+\..{2,3}(?:\..{2,3})?(?=[\/\W])/i'`，但后来我意识到像“ [http://example.com/index.htm](http://example.com/index.htm) ”这样的网址匹配两次。哎呀。这不会那么糟糕（只使用第一个），但它也匹配两次这样的东西：' [http](http://abc.ed.fg.hij.kl.mn/) ://abc.ed.fg.hij.kl.mn/ '，第一个匹配是' t 正确的。:(

一位同事建议只获取主机（通过`parse_url()`），然后只获取最后两个或三个数组位（`split()`在“.”上）这两个或三个将基于域列表，例如“co.uk”，等等。组成那个列表成为困难的部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-27T07:13:19.120

提取域部分只有一种正确的方法，它使用[公共后缀列表](https://publicsuffix.org/)（TLD 数据库）。我推荐[TLDExtract](https://github.com/layershifter/TLDExtract)包，这里是示例代码：

```
$extract = new LayerShifter\TLDExtract\Extract();

$result = $extract->parse('www.domain.com/path/script.php?=whatever');
$result->getSubdomain(); // will return (string) 'www'
$result->getHostname(); // will return (string) 'domain'
$result->getSuffix(); // will return (string) 'com' 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-20T19:24:03.730

此功能应该工作：

```
function Delete_Domain_From_Url($Url = false)
{
    if($Url)
    {
        $Url_Parts = parse_url($Url);
        $Url = isset($Url_Parts['path']) ? $Url_Parts['path'] : '';
        $Url .= isset($Url_Parts['query']) ? "?".$Url_Parts['query'] : '';
    }

    return $Url;
} 
```

要使用它：

```
$Url = "https://stackoverflow.com/questions/176284/how-do-you-strip-out-the-domain-name-from-a-url-in-php";
echo Delete_Domain_From_Url($Url);

# Output: 
#/questions/176284/how-do-you-strip-out-the-domain-name-from-a-url-in-php 
```

# batch-file - 如何在批处理文件中打开 Access 数据库（并等待它关闭后再继续）？

> ID：176295
> 
> 赞同：1
> 
> 时间：2008-10-06T21:35:20.880
> 
> 标签：batch-file

我已经尝试过这些，但它们没有工作（访问打开，但它不等待：

```
start "C:\program files\Microsoft Office\Office\MSACCESS.EXE" filename.mdb

start /WAIT "C:\program files\Microsoft Office\Office\MSACCESS.EXE" filename.mdb

start /W "C:\program files\Microsoft Office\Office\MSACCESS.EXE" filename.mdb

start filename.mdb

start msaccess.exe filename.mdb 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T21:35:43.907

```
start /WAIT msaccess.exe filename.mdb 
```

成功了。

我不知道为什么添加完整路径会使其失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-25T13:46:17.253

```
PATH="C:\Program Files\Microsoft Office\OFFICE11\; C:\Windows\Command"
START /WAIT MSACCESS.exe "path to mdb file" /X "name of macro" 
```

# java - Forcing file deletion on Windows from Java

> ID：176302
> 
> 赞同：3
> 
> 时间：2008-10-06T21:37:23.183
> 
> 标签：java, windows, file-locking

Is there a programatic way from java to force a file deletion on windows even if the file is locked by some process? I cannot kill the process that locks the file.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T21:40:19.700

you can go through JNI. But the whole point of locking was NOT to allow for deletion from another process.

So, unless you're running Windows 9x, this might be impossible to do.

That said, if you're aware of a way to do it using WIN32, then you might be able to do it in java using JNI.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T21:43:59.503

我不是 Windows 专家，但我不知道在 Java 中使用 OR OUT 的方法可以在进程继续运行时可靠地强制删除当前对进程打开的文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T07:00:28.773

使用[解锁器](http://www.emptyloop.com/unlocker/)。从 Java 调用它作为外部进程。

# sql-server - 比较工具以生成 SQL Server 更新脚本

> ID：176316
> 
> 赞同：10
> 
> 时间：2008-10-06T21:41:54.580
> 
> 标签：sql-server, build-process, installation, build-automation

我想让 Web 应用程序的更新尽可能自动化。
我正在寻找一种可以比较数据库的两个实例并为我生成更新脚本的工具。作为构建过程的一部分，创建数据库的最后一个版本（即当前处于生产中）的实例，并将其与开发版本上的更改进行比较。

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T21:46:04.587

我喜欢[SqlDbDiff](http://sqldbtools.com)。比[RedGate 的 SQL 比较便宜](http://www.red-gate.com/products/SQL_Compare/index.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T22:11:32.163

[我在这里](https://stackoverflow.com/questions/172055/looking-for-tools-to-export-a-set-of-specific-rows-of-data-creating-insert-scri#172825)回答了同样的问题。

祝你好运！如您所见，我喜欢[Red-Gate](http://www.red-gate.com/)工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T21:45:33.497

看

[跟踪数据库架构更改的机制](https://stackoverflow.com/questions/1607/mechanisms-for-tracking-db-schema-changes#22535)

我相信这个问题对[SO](https://stackoverflow.com/questions/175451/how-do-you-version-your-database-schema#175473)的影响说明了该问题缺乏标准解决方案。

方法的最大区别是
- 编写增量脚本
- 从“主”实例自动生成脚本

听起来你想要后一个阵营的东西。

上述问题中提到了几个这样的解决方案和工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-10T08:06:07.153

到目前为止，对 RedGate 很满意。我们使用 SQL 版本控制 + SQL 比较。我已经将它与 Msbuild 和 Hudson 集成。这给了我们一个完整的持续集成解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-02T09:18:14.423

这里还有更多要添加到列表中的内容：

*   [ApexSQL Diff](http://www.apexsql.com/sql_tools_diff.aspx)（模式比较）和[ApexSQL Data Diff](http://www.apexsql.com/sql_tools_datadiff.aspx)（数据比较）
*   [比较工具集](http://www.idera.com/productssolutions/sqlserver)
*   [熟练的 SQL 差异](http://www.adeptsql.com/)

# windows - 让 SearchPath API 不在 c:\windows 中查找的方法？

> ID：176318
> 
> 赞同：0
> 
> 时间：2008-10-06T21:42:40.943
> 
> 标签：windows, winapi

有没有办法让[SearchPath](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365527%28v=vs.85%29.aspx) API 在使用默认搜索路径时不在 c:\windows 中搜索（将 NULL 作为第一个参数传递）？我无法修改调用者以在特定路径中发送。

我有一个系统，在 c:\windows 中有一个应用程序 ini 文件（我不希望它使用它，但由于遗留原因必须保留在那里）。我将同一 ini 文件的副本放在 c:\users\public 中，并将 c:\users\public 放在我的系统路径环境变量的前面，但是对[SearchPath](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365527%28v=vs.85%29.aspx)的调用仍然会找到 c:\windows 版本。如果我删除该版本，它会找到 c:\users\public 版本，所以我知道路径设置正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T09:19:17.253

我知道这已经很晚了，但是我自己也遇到了这个问题，我会提出一个更好的解决方案。

[如您所见， SearchPath](http://msdn.microsoft.com/en-us/library/aa365527.aspx)的第一个参数可用于指定您希望它搜索的目录，而不是默认顺序。[您可以使用GetEnvironmentVariable](http://msdn.microsoft.com/en-us/library/ms683188.aspx)检索和使用当前用户的 PATH ，然后在其中进行搜索：

```
DWORD err = GetEnvironmentVariable("PATH", NULL, 0);
char* path = new char[err+1];   path[err] = 0;
GetEnvironmentVariable("PATH", path, err);

err = SearchPath(path, "application", ".ini", 0, NULL, NULL);
char* searchResult = new char[err+1];   searchResult[err] = 0;
err = SearchPath(path, "application", ".ini", err, searchResult, NULL); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T21:48:18.123

根据[MSDN](http://msdn.microsoft.com/en-us/library/aa365527(VS.85).aspx)，对于更改系统级别 (HKLM) 注册表项的此栏，您无能为力（这是“坏事”）。注册表更改将导致搜索顺序从当前工作目录开始，您可以在快捷方式中将其设置为所需的文件夹。（再次，我要说；更改机器级注册表项来执行此操作 - 具有潜在危险！）

您是否研究过[应用程序垫片](http://technet.microsoft.com/en-us/library/bb457032.aspx)？这可能对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T14:25:53.523

尝试`SetCurrentDirectory("c:\users\public")`然后`SearchPath(...)`。

# mysql - How can I use the TRUNCATE sentence avoiding MySql to write it into the binlog?

> ID：176319
> 
> 赞同：2
> 
> 时间：2008-10-06T21:42:50.023
> 
> 标签：mysql, database, replication, binlog

It seems MySQL does not support the flag "NO_ WRITE_ TO_ BINLOG" for TRUNCATE. So I have to wait until delay is 0, then stop the replication, make the TRUNCATE of the table/s, reset the master, and then start replication again. Really painful. Any other suggestion?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T14:14:51.157

您可以使用该命令禁用会话的二进制日志记录以执行您想要的操作。

```
设置 SQL_LOG_BIN = 0；
截断表；
设置 SQL_LOG_BIN = 1；

```

这确实需要您具有 SUPER 特权，因为您通过不将 TRUNCATE 发送到从属服务器来有效地破坏复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T14:18:33.287

TRUNCATE 不能轻易使用，因为它本质上只是将数据丢弃在地板上而没有记录它这样做的事实。它在事务上是不安全的并且无法从中恢复，因此它与复制不兼容。即使您设法在复制设置中使用 TRUNCATE，您复制的数据也会损坏，或者充其量是无效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T11:47:59.973

TRUNCATE 是相当严厉的。你可以只用一个 DELETE 查询吗？

# python - 我在哪里可以找到 py2exe 的好教程？

> ID：176322
> 
> 赞同：12
> 
> 时间：2008-10-06T21:43:38.740
> 
> 标签：python, wxpython, py2exe

有人可以指点我一个**好的**py2exe教程吗？我已经阅读了[官方教程](http://www.py2exe.org/index.cgi/Tutorial)，但与从 python 脚本构建可执行文件时可以使用的所有选项相比，它的细节相当简单。作为记录，我的 python 脚本使用 Python 2.5.2、wxPython/wxWidgets 2.8 和 MySQLdb 1.2.2；所以如果你有关于 py2exe 的特定提示以及那些将不胜感激的软件包（是的，我已经看到了[Py2EXE 和 wxPython](http://www.py2exe.org/index.cgi/Py2exeAndwxPython)页面）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T00:51:48.923

关于“Py2EXE 和 wxPython”，该页面提到了导入语句“from wxPython.wx import *”。这是旧的 wxPython（我认为有好几年了）。在我的应用程序中，我只是做“import wx”，我没有任何大麻烦。

我对 wxPython 和 py2exe 有一个提示：如果您希望您的应用程序在 Windows XP 上看起来不错，您需要一份清单。此电子邮件包含详细信息：http: [//mail.python.org/pipermail/python-list/2004-June/268126.html](http://mail.python.org/pipermail/python-list/2004-June/268126.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T03:48:41.360

我将发布 py2exe GUI，以便您无需编写安装脚本即可轻松编译您的应用程序。更多信息[在这里](http://sourceforge.net/projects/py2exegui/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T22:43:03.800

不知道有没有更好的教程，但在新闻列表中可以找到一些信息。

[http://news.gmane.org/gmane.comp.python.py2exe](http://news.gmane.org/gmane.comp.python.py2exe)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-14T10:28:51.020

自从提出这个问题以来，我已经更新了官方 py2exe 教程，以包含有关捆绑 Microsoft C 运行时 DLL 的更多信息。 [http://www.py2exe.org/index.cgi/Tutorial#Step5](http://www.py2exe.org/index.cgi/Tutorial#Step5)

如果阅读此问题的任何人都知道他们认为官方教程中缺少的东西，我可以鼓励他们将这些知识添加到官方教程中，这是一个 wiki。

# windows - Windows 上的共享内存访问权限

> ID：176331
> 
> 赞同：7
> 
> 时间：2008-10-06T21:45:06.617
> 
> 标签：windows, shared, memory-access

我开发了一个使用共享内存的 Windows 应用程序——即——用于进程间通信的内存映射文件。我有一个 Windows 服务，它进行一些处理并定期将数据写入内存映射文件。我有一个单独的 Windows 应用程序，它从内存映射文件中读取并显示信息。该应用程序在 Windows XP、XP Pro 和 Server 2003 上按预期工作，但在 Vista 上却不行。

我可以看到 Windows 服务正在正确地写入内存映射文件的数据，因为我可以使用文本编辑器打开文件并查看存储的消息，但“消费者”应用程序无法从文件中读取。这里要注意的一件有趣的事情是，如果我关闭消费者应用程序并重新启动它，它会使用之前写入内存映射文件的消息。

另外，另一个奇怪的事情是，当我使用远程桌面连接到 Windows 主机并通过远程桌面调用/使用消费者应用程序时，我得到了相同的行为。但是，如果我调用远程桌面并使用以下命令连接到目标主机的控制台会话：`mstsc -v:servername /F -console`，一切正常。

所以这就是为什么我认为问题与权限有关。任何人都可以对此发表评论吗？

编辑：

我用来创建内存映射文件和同步访问的 Mutex 对象的 ACL 如下：

```
TCHAR * szSD = TEXT("D:")
               TEXT("(A;;RPWPCCDCLCSWRCWDWOGAFA;;;S-1-1-0)")
               TEXT("(A;;GA;;;BG)")
               TEXT("(A;;GA;;;AN)")
               TEXT("(A;;GA;;;AU)")
               TEXT("(A;;GA;;;LS)")
               TEXT("(A;;GA;;;RD)")
               TEXT("(A;;GA;;;WD)")
               TEXT("(A;;GA;;;BA)"); 
```

我认为这可能是问题的一部分。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-08T20:30:18.340

所以我找到了解决我的问题的方法：

在 Windows XP 上，所有命名的内核对象，例如互斥体、信号量和内存映射对象都存储在同一个命名空间中。因此，当不同用户会话中的不同进程使用其名称引用特定对象时，它们会获得该对象的句柄。但是，作为安全预防措施，Windows 终端服务为从其会话中启动的进程引用的内核对象创建一个单独的命名空间。Windows Vista 也内置了这种行为，所以这就是我的应用程序在 Vista 上无法正常工作的原因。详细地说，我有一个在空会话中运行的 Windows 服务和一个在用户会话中运行的应用程序，因此我的命名对象是在单独的命名空间中创建的。

这个问题的快速解决方法是通过在我使用**的每个内核对象名称前面加上“Global\”来使用全局命名空间，**这样就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T01:02:37.433

前缀“Global\”可能不适用于共享内存。有关解决方案，请参阅[“会话 0 隔离对 Windows Vista 中的服务和驱动程序的影响”](http://msdn.microsoft.com/en-us/windows/hardware/gg463353)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T22:15:13.187

您打开共享内存部分的访问权限是什么？尝试`FILE_MAP_ALL_ACCESS`并按照自己的方式工作。还要确保生产者和消费者之间没有竞争条件——哪一个在创建共享内存？确保在另一个尝试打开它之前创建它。一种方法是在启动子进程之前在父进程中创建该部分 - 如果您使用的是父/子架构。

您的孩子可能需要在 Vista 上运行提升才能被允许访问共享内存。它也可能与您正在使用的窗口会话有关。服务在会话 0 中运行（我认为），而其他应用程序（特别是如果您通过远程桌面登录）可能在另一个会话中运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T22:14:40.347

您是否尝试过将文件移动到其他位置。尝试将它放在“共享文档”文件夹中，这似乎是 Vista 中最容易访问的文件夹。

# c++ - 监控打印机

> ID：176332
> 
> 赞同：2
> 
> 时间：2008-10-06T21:45:22.577
> 
> 标签：c++, monitor, printing

我编写了一个 DLL 来监控我们的网络打印机。打印机通过 USB 电缆连接到服务器。当我直接从服务器打印某些内容时，它会显示有关正确发送/打印的页面的信息，但是当我从其中一台客户端计算机打印某些内容时，它只显示其 IP，发送/打印的始终为 0。

我想这是 winspooler API 的一个缺点，我的问题是，有什么办法可以解决吗？

这是代码，它的价值：

```
typedef struct PRINTERMONITOR_API tagPRINTJOBINFO
{
    // name of the machine that printed
    char *machineName;
    // name of the document
    char *document;
    // total pages actually *printed*
    DWORD totalPages;
    // number of pages sent to the printer
    DWORD printed;
    // private: state of the printJob
    BOOL  done;
} printJobInfo_t;

//-------------------------------------------------------
// Function called when the print job event finishes
//-------------------------------------------------------
typedef void (*Callback)(printJobInfo_t *);

//-------------------------------------------------------
// Printer Monitor class
//-------------------------------------------------------
class PrinterMonitor
{
private:

    //-------------------------------------------------------
    // Handle to the printer.
    //-------------------------------------------------------
    HANDLE                  m_hPrinter;

    //-------------------------------------------------------
    // Handle to the notify object being set when print event
    // occurs.
    //-------------------------------------------------------
    HANDLE                  m_hNotify;

    //-------------------------------------------------------
    // Handle of our worker thread.
    //-------------------------------------------------------
    HANDLE                  m_hThread;

    //-------------------------------------------------------
    // Holds PRINTER_CHANGE_XXX_XXX information about current
    // event.
    //-------------------------------------------------------
    DWORD                   m_dwChanged;

    //-------------------------------------------------------
    // ID of the worker thread.
    //-------------------------------------------------------
    DWORD                   m_dwThreadId;

    //-------------------------------------------------------
    // Name of the printer.
    //-------------------------------------------------------
    char                    *m_pszPrinterName;

    //-------------------------------------------------------
    // Printer event snooping options.
    //-------------------------------------------------------
    PRINTER_NOTIFY_OPTIONS  *m_pOptions;

    //-------------------------------------------------------
    // Output of the event function.
    //-------------------------------------------------------
    PRINTER_NOTIFY_INFO     *m_pOutPut; 

    //-------------------------------------------------------
    // Shall we go away?
    //-------------------------------------------------------
    BOOL                    m_fExit;

public:
    //-------------------------------------------------------
    // Callback function called when the event fires.
    //-------------------------------------------------------
    Callback                m_fpCallback;

    //-------------------------------------------------------
    // Constructor
    // - name of the printer
    // - callback function
    //-------------------------------------------------------
    PrinterMonitor(char *printerName, Callback callback)
    {
        memset(this, 0, sizeof(PrinterMonitor)); // zero me
        m_fpCallback        = callback;
        m_pszPrinterName    = new char[strlen(printerName)];
        strcpy(m_pszPrinterName, printerName);
        m_pOptions          = new PRINTER_NOTIFY_OPTIONS;
        m_hThread           = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)PrinterMonitor::StartMonitoring, this, CREATE_SUSPENDED, &m_dwThreadId);
    }

    //-------------------------------------------------------
    // Stop the worker thread and delete some shit
    //-------------------------------------------------------
    ~PrinterMonitor()
    {
        StopMonitor();
        delete(m_pOptions);
        delete[](m_pszPrinterName);
    }

    //-------------------------------------------------------
    // Run the monitor in a seperate thread
    //-------------------------------------------------------
    void RunMonitor()
    {
        ResumeThread(m_hThread);
    }

    //-------------------------------------------------------
    // Stop the monitor, noes.
    //-------------------------------------------------------
    void StopMonitor()
    {
        m_fExit = true;
    }

    //-------------------------------------------------------
    // Checks if this object is a valid monitor
    //-------------------------------------------------------
    BOOL CheckMonitor()
    {
        if(OpenPrinter(this->m_pszPrinterName, &this->m_hPrinter, NULL))
        {
            if(this->m_hPrinter != INVALID_HANDLE_VALUE)
            {
                ClosePrinter(this->m_hPrinter);
                return true;
            }
        }

        return false;
    }

private:
    //-------------------------------------------------------
    // The worker thread proc
    //-------------------------------------------------------
    static void WINAPI StartMonitoring(void *thisPtr)
    {

        PrinterMonitor* pThis = reinterpret_cast<PrinterMonitor*>(thisPtr);

        if(OpenPrinter(pThis->m_pszPrinterName, &pThis->m_hPrinter, NULL))
        {
            WORD wJobFields[5];
            wJobFields[0]           = JOB_NOTIFY_FIELD_STATUS;
            wJobFields[1]           = JOB_NOTIFY_FIELD_MACHINE_NAME;
            wJobFields[2]           = JOB_NOTIFY_FIELD_TOTAL_PAGES;
            wJobFields[3]           = JOB_NOTIFY_FIELD_PAGES_PRINTED;
            wJobFields[4]           = JOB_NOTIFY_FIELD_DOCUMENT;

            PRINTER_NOTIFY_OPTIONS_TYPE rOptions[1];
            rOptions[0].Type    = JOB_NOTIFY_TYPE;
            rOptions[0].pFields = &wJobFields[0];
            rOptions[0].Count   = 5;

            pThis->m_pOptions->Count    = 1;
            pThis->m_pOptions->Version  = 2;
            pThis->m_pOptions->pTypes   = rOptions;
            pThis->m_pOptions->Flags    = PRINTER_NOTIFY_OPTIONS_REFRESH;

            if((pThis->m_hNotify = 
                FindFirstPrinterChangeNotification(pThis->m_hPrinter, 0, 0, pThis->m_pOptions)) != INVALID_HANDLE_VALUE)
            {
                while(pThis->m_hNotify != INVALID_HANDLE_VALUE && !pThis->m_fExit)
                {
                    if(WaitForSingleObject(pThis->m_hNotify, 10) == WAIT_OBJECT_0)
                    {
                        FindNextPrinterChangeNotification(pThis->m_hNotify, &pThis->m_dwChanged, (LPVOID)pThis->m_pOptions, (LPVOID*)&pThis->m_pOutPut);

                        printJobInfo_t info = {0};
                        for (unsigned int i=0; i < pThis->m_pOutPut->Count; i++)
                        {
                            PRINTER_NOTIFY_INFO_DATA data = pThis->m_pOutPut->aData[i];

                            if(data.Type == JOB_NOTIFY_TYPE)
                            {
                                switch(data.Field
                                {
                                    case JOB_NOTIFY_FIELD_PAGES_PRINTED:
                                        {
                                            info.printed = data.NotifyData.adwData[0];
                                        }
                                        break;

                                    case JOB_NOTIFY_FIELD_MACHINE_NAME:
                                        {
                                            LPSTR name = (LPSTR) data.NotifyData.Data.pBuf;
                                            unsigned int length = strlen(name); 
                                            info.machineName = new char[length];
                                            strcpy(info.machineName, name);                                         
                                        }
                                        break;

                                    case JOB_NOTIFY_FIELD_TOTAL_PAGES:
                                        {
                                            info.totalPages = data.NotifyData.adwData[0];
                                        }
                                        break;

                                    case JOB_NOTIFY_FIELD_DOCUMENT:
                                        {
                                            LPSTR document = (LPSTR) data.NotifyData.Data.pBuf;
                                            unsigned int length = strlen(document);
                                            info.document = new char[length];
                                            strcpy(info.document, document);                                            
                                        }
                                        break;

                                    case JOB_NOTIFY_FIELD_STATUS:
                                        {
                                            if(data.NotifyData.adwData[0] & JOB_STATUS_PRINTED)
                                            {
                                                info.done = true;
                                            }
                                        }
                                        break;
                                }
                            }
                        }

                        if(info.done)
                        {
                            pThis->m_fpCallback(&info);

                            delete[](info.document);
                            delete[](info.machineName);
                        }
                    }
                }

                if(pThis->m_hPrinter != INVALID_HANDLE_VALUE)
                    ClosePrinter(pThis->m_hPrinter);

                if(pThis->m_hNotify != INVALID_HANDLE_VALUE)
                    FindClosePrinterChangeNotification(pThis->m_hNotify);

            }
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T02:49:58.107

知道了。如果 Windows 自动添加了基本信息，则网络打印机只发送基本信息。

手动添加打印机解决了这个问题。

# asp.net - 客户可配置的 asp.net 网站安全性，可对页面和按钮访问进行细粒度控制

> ID：176338
> 
> 赞同：3
> 
> 时间：2008-10-06T21:47:01.793
> 
> 标签：asp.net, sql-server, security, active-directory, roles

我有一个 ASP.NET 2.0 [还没有 ajax...] 网站，它将以编译的形式部署在多个客户网站上。通常，该站点将仅是 Intranet。一些客户信任他们所有的人，不关心限制对站点和/或页面功能的访问，其他人不信任任何人，只希望某些人和/或组能够查看某些页面、单击某些按钮等人。

我可以做一些本土解决方案，可能从数据库表驱动访问权限，但在我走这条路之前，我想我会问：对于这种情况，什么是好的解决方案？最好可以在 web.config 文件和/或数据库中完全控制，因为重建网站是不可能的（对于客户端，我不想一遍又一遍地为他们做）。Active Directory 集成将是一个奖励，但不是必需的（除非这更容易）。

作为一个起点，我认为网站中的每个页面/功能点都被赋予一个身份并与一个权限组相关联......

编辑：web.config 授权部分允许/拒绝按角色和用户访问是好的，但这只是问题的一半 - 另一半是控制对每个页面上的单个方法（按钮等）的访问。例如，一些用户可以查看 whatchamacallits，而其他用户则可以编辑、创建、删除或禁用/启用它们。所有这些按钮/链接/操作都在视图页面上......

[理想情况下，我会让禁用的按钮不可见，但这在这里并不重要]

编辑：到目前为止有一些很好的建议，但还没有完整的解决方案 - 仍然倾向于数据库驱动的解决方案......

*   安全权限需求属性会在按钮被点击时抛出异常，这不是一件友好的事情；我宁愿隐藏不允许用户使用的按钮
*   LoginView 控件也很有趣，但需要多次复制大部分页面内容（每个角色一次），并且可能无法处理用户具有多个角色的情况 - 我不能假设角色是分层的，因为它们将由客户定义

编辑：平台是 Win2K/XP、Sql Server 2005、ASP.NET 2.0，不使用 AJAX

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T21:19:08.353

我认为您在这里需要做的是在您的业务对象或控制器中实现一组权限查询方法。示例：CanRead()、CanEdit()、CanDelete()

页面呈现时，需要查询业务对象，确定用户授权的能力，并根据这些信息启用或禁用功能。反过来，业务对象可以使用角色或其他数据库查询来确定活动用户的权限。

我想不出一种方法来集中声明地定义这些权限。它们需要分发到功能的实现中。但是，如果您想改进设计，您可以使用依赖注入将授权者插入到您的业务对象中，从而使实现保持独立。

Rocky Lhotka 的书中有一些代码使用了这个模型。新版本尚未在[Google](http://books.google.com/books?id=AS7zAQaKt-oC&pg=PA303&lpg=PA303&dq=ApplyAuthorizationRules()&source=web&ots=KAM2jFW5DR&sig=CH2iXpBw1K5i5zSnyA8sEJWjKlM&hl=en&sa=X&oi=book_result&resnum=7&ct=result)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T22:00:46.943

我更喜欢授予 AD 组而不是特定用户的访问权限。我发现它更灵活。

我不太了解您的应用程序，但您可能想查看 web.config 文件中的授权标记：

```
<authorization>
    <!--  
        <deny users="?" />
        <allow     users="[comma separated list of users]"
                   roles="[comma separated list of roles]"/>
        <deny      users="[comma separated list of users]"
                   roles="[comma separated list of roles]"/>
    -->
</authorization> 
```

您可以在 Web 应用程序中的每个目录中分隔 web.config 文件，并且可以嵌套目录。每个 web.config 文件都可以有自己的授权部分。如果您在每个目录中放置不同的页面，您可以通过在每个 web.config 中允许特定角色并拒绝其他所有内容来有效地严格管理安全性。然后您可以管理活动目录中每个角色的成员。我发现这是一个有效的解决方案，因为它很好地利用了 Microsoft 的 Active Directory 和 ASP.NET 安全框架，而无需编写您自己的自定义内容，而且如果您使用角色，则可以将角色成员的管理分担给无需接触 web.config 文件，他们只需要知道如何使用 AD 管理控制台。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T05:59:47.583

虽然我以前从未在实践中使用过它并且无法争论它的优点，但我知道 .NET 具有基于角色的代码安全性，它允许您以声明方式按角色或用户锁定方法。例如：

```
[PrincipalPermissionAttribute(SecurityAction.Demand, Name = "MyUser", Role = "User")]
public static void PrivateInfo()
{   
    //Print secret data.
    Console.WriteLine("\n\nYou have access to the private data!");
} 
```

[此处](http://msdn.microsoft.com/en-us/library/52kd59t0.aspx)更详细地介绍了基于角色的安全性。我不知道它会对你有多大帮助，但考虑到它需要重新编译才能改变它；然而，在方法上贴标签比构建逻辑来显示/隐藏按钮或在代码中进行安全验证要快。

此外，您还需要[阅读](http://msdn.microsoft.com/en-us/library/ms998358.aspx)集成 Windows 身份验证以获得 Active Directory 的可能性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T06:09:44.443

听起来您可以使用[LoginView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview.aspx)控件，它可以仅向某些用户或角色显示控件面板。角色是最灵活的——如果不需要安全性，则将所有用户置于所有角色中。

与标准 web.config 安全性（带有活动目录的集成窗口或表单身份验证（asp 2 Sql 服务器架构或您自己的架构））结合使用。

```
<asp:LoginView id="LoginView1" runat="server">
                    <RoleGroups>
                        <asp:RoleGroup Roles="Admin">
                            <ContentTemplate>
                                <asp:LoginName id="LoginName2" runat="Server"></asp:LoginName>, you
                                are logged in as an administrator.
                            </ContentTemplate>
                        </asp:RoleGroup>
                        <asp:RoleGroup Roles="User">
                            <ContentTemplate>
                                <asp:Button id="Button1" runat="Server" OnClick="AllUserClick">
                            </ContentTemplate>
                        </asp:RoleGroup>
                    </RoleGroups>
                </asp:LoginView> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T05:51:49.330

我想我将不得不将 AD 授权与数据库中的“功能和权限”表结合起来，以获得我们需要的细粒度控制 -

*   使用 web.config 文件只允许授权用户（通过 AD 组）访问网站
*   制作一个“功能”表，列出可能受影响的每个页面和功能，例如第 1 页的编辑按钮、第 2 页的删除按钮、第 3 页的详细信息网格等。
*   制作一个“权限”表，指定一个功能和一个允许使用该功能的 AD 组
*   更改网站页面以检查页面加载（或预渲染，视情况而定）的功能权限，以酌情禁用/隐藏禁止的功能

例子：

*   管理员可以使用网站的所有功能
*   开发者可以使用网站的所有功能
*   管理员可以查看所有页面，但只能添加和编辑信息，不能删除
*   主管可以查看所有部门的摘要，但只能查看和编辑自己部门的详细信息（每个部门和部门主管都有一个 AD 组）
*   员工只能查看其部门的详细信息
*   等等

最终解决方案将“功能”的概念简化为可以使用或不能使用的二元决策，并为每个功能添加了“允许/不允许”标志。这允许将大多数人都可以使用的功能定义为“允许的”，然后权限表只需记录被拒绝使用该功能的组。对于定义为不允许的功能，默认情况下没有人可以使用该功能，您必须为允许使用该功能的组创建权限表条目。这似乎提供了一个两全其美的解决方案，因为它减少了每个功能所需的权限记录数量。

# operators - 与所有不同的 Perl 6 相等运算符有什么关系？(==, ===, eq, eqv, ~~, =:=, ...)

> ID：176343
> 
> 赞同：42
> 
> 时间：2008-10-06T21:48:21.617
> 
> 标签：operators, raku

Perl 6 似乎有大量的相等运算符。是什么`=:=`？`leg`和有什么区别`cmp`？或者`eqv`和`===`？

谁有好的总结？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-06T22:00:15.197

[=:=](http://doc.perl6.org/routine/%3D%3A%3D)测试两个容器（变量或数组项或散列项）是否有别名，即如果一个更改，另一个是否也更改？

```
my $x;
my @a = 1, 2, 3;
# $x =:= @a[0] is false
$x := @a[0];
# now $x == 1, and $x =:= @a[0] is true
$x = 4;
# now @a is 4, 2, 3 
```

至于其他：[===](http://doc.perl6.org/routine/%3D%3D%3D)测试两个引用是否指向同一个对象，[eqv](http://doc.perl6.org/routine/eqv)测试两个事物是否在结构上等价。所以`[1, 2, 3] === [1, 2, 3]`会是假的（不是同一个数组），但`[1, 2, 3] eqv [1, 2, 3]`会是真的（相同的结构）。

`leg`比较像 Perl 5's 这样的字符串`cmp`，而 Perl 6's`cmp`更智能，并且会比较数字 like`<=>`和字符串 like `leg`。

```
13 leg 4   # -1, because 1 is smaller than 4, and leg converts to string
13 cmp 4   # +1, because both are numbers, so use numeric comparison. 
```

最后`~~`是“智能匹配”，它回答了“`$x`匹配`$y`”的问题。如果`$y`是类型，则为类型检查。如果`$y`是正则表达式，则它是正则表达式匹配 - 等等。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-07T05:24:36.830

[概要 3：比较语义](http://design.perl6.org/S03.html#Comparison_semantics)中的摘要是否符合您的要求，或者您是否已经阅读过？设计文档链接到使用这些功能的测试文件，因此您可以查看它们的使用示例及其当前测试状态。

Perl 6 的比较运算符更适合动态语言和所有正在发生的事情。不再只是比较字符串或数字（或将事物转换为字符串或数字），现在您可以使用符合您要求的运算符精确地测试事物。您可以测试值、容器、类型等。

在其中一条评论中，您询问了`eqv`and `cmp`。在 Perl 5 的旧时代，`cmp`它用于排序并返回三个魔法值之一（-1,0,1），并且它总是使用字符串语义来做到这一点。在 Perl 6 中，`cmp`返回三种类型的`Order`对象之一，因此您不必记住 -1、0 或 1 的含义。此外，新的`cmp`不强制字符串语义，所以它可以更聪明地处理数字（不像 Perl 5 的排序为 1、10、11、2、20、21 ...）。

（**小于**`leg`，等于，大于**）**是**字符串**语义。它被定义为 Perl 6's ，其中是强制字符串语义的新“字符串上下文化器”。使用，您总是在进行字符串比较，就像旧的 Perl 5 一样。******`cmp``~$a cmp ~$b``~``leg``cmp`******

 ******如果您对其他运营商仍有疑问，让我们将它们分解为单独的问题。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-14T14:47:21.020

这也是一个方便的参考指南：

[Perl6 运算符周期表](http://www.ozonehouse.com/mark/periodic/)

# asp.net-mvc - ASP/NET MVC：带会话的测试控制器？嘲讽？

> ID：176347
> 
> 赞同：43
> 
> 时间：2008-10-06T21:49:05.827
> 
> 标签：asp.net-mvc, unit-testing, mocking, session

我在这里阅读了一些答案：测试视图和控制器以及模拟，但我仍然无法弄清楚如何测试读取和设置会话值（或任何其他基于上下文的变量）的 ASP.NET MVC 控制器。如何为我的测试方法提供（会话）上下文？是在嘲讽答案吗？有人有例子吗？基本上，我想在调用控制器方法并让控制器使用该会话之前伪造一个会话。有任何想法吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-26T18:03:30.387

查看 Stephen Walther 关于伪造控制器上下文的帖子：

[ASP.NET MVC 技巧 #12 – 伪造控制器上下文](http://stephenwalther.com/blog/archive/2008/07/01/asp-net-mvc-tip-12-faking-the-controller-context.aspx)

```
[TestMethod]
public void TestSessionState()
{
    // Create controller
    var controller = new HomeController();

    // Create fake Controller Context
    var sessionItems = new SessionStateItemCollection();
    sessionItems["item1"] = "wow!";
    controller.ControllerContext = new FakeControllerContext(controller, sessionItems);
    var result = controller.TestSession() as ViewResult;

    // Assert
    Assert.AreEqual("wow!", result.ViewData["item1"]);

    // Assert
    Assert.AreEqual("cool!", controller.HttpContext.Session["item2"]);
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T22:02:43.617

由于使用抽象基类而不是接口，ASP.NET MVC 框架对模拟不是很友好（或者更确切地说，需要太多设置才能正确模拟，并且在测试时会导致太多摩擦，恕我直言）。我们很幸运地为每个请求和基于会话的存储编写了抽象。我们将这些抽象保持得很轻，然后我们的控制器依赖于这些抽象来进行每个请求或每个会话的存储。

例如，这是我们管理表单身份验证内容的方式。我们有一个 ISecurityContext：

```
public interface ISecurityContext
{
    bool IsAuthenticated { get; }
    IIdentity CurrentIdentity { get; }
    IPrincipal CurrentUser { get; set; }
} 
```

有一个具体的实现，如：

```
public class SecurityContext : ISecurityContext
{
    private readonly HttpContext _context;

    public SecurityContext()
    {
        _context = HttpContext.Current;
    }

    public bool IsAuthenticated
    {
        get { return _context.Request.IsAuthenticated; }
    }

    public IIdentity CurrentIdentity
    {
        get { return _context.User.Identity; }
    }

    public IPrincipal CurrentUser
    {
        get { return _context.User; }
        set { _context.User = value; }
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-17T18:00:56.237

在 MVC RC 1 中，ControllerContext 包装了 HttpContext 并将其作为属性公开。这使得模拟更容易。要使用 Moq 模拟会话变量，请执行以下操作：

```
var controller = new HomeController();
var context = MockRepository.GenerateStub<ControllerContext>();
context.Expect(x => x.HttpContext.Session["MyKey"]).Return("MyValue");
controller.ControllerContext = context; 
```

有关详细信息，请参阅[Scott Gu 的帖子](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T22:59:48.573

我发现嘲笑是相当容易的。这是一个使用 moq 模拟 httpContextbase（包含请求、会话和响应对象）的示例。

```
[TestMethod]
        public void HowTo_CheckSession_With_TennisApp() {
            var request = new Mock<HttpRequestBase>();
            request.Expect(r => r.HttpMethod).Returns("GET");     

            var httpContext = new Mock<HttpContextBase>();
            var session = new Mock<HttpSessionStateBase>();

            httpContext.Expect(c => c.Request).Returns(request.Object);
            httpContext.Expect(c => c.Session).Returns(session.Object);

            session.Expect(c => c.Add("test", "something here"));            

            var playerController = new NewPlayerSignupController();
            memberController.ControllerContext = new ControllerContext(new RequestContext(httpContext.Object, new RouteData()), playerController);          

            session.VerifyAll(); // function is trying to add the desired item to the session in the constructor
            //TODO: Add Assertions   
        } 
```

希望有帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T22:22:14.683

Scott Hanselman 有一篇关于如何使用 MVC[创建文件上传](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)快速应用的帖子，并讨论了 moking 并专门解决了“如何模拟不适合 mock 的东西”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-03-25T13:31:15.157

我使用了以下解决方案 - 制作一个我所有其他控制器都继承自的控制器。

```
public class TestableController : Controller
{

    public new HttpSessionStateBase Session
    {
        get
        {
            if (session == null)
            {
                session = base.Session ?? new CustomSession();
            }
            return session;
        }
    }
    private HttpSessionStateBase session;

    public class CustomSession : HttpSessionStateBase
    {

        private readonly Dictionary<string, object> dictionary; 

        public CustomSession()
        {
            dictionary = new Dictionary<string, object>();
        }

        public override object this[string name]
        {
            get
            {
                if (dictionary.ContainsKey(name))
                {
                    return dictionary[name];
                } else
                {
                    return null;
                }
            }
            set
            {
                if (!dictionary.ContainsKey(name))
                {
                    dictionary.Add(name, value);
                }
                else
                {
                    dictionary[name] = value;
                }
            }
        }

        //TODO: implement other methods here as needed to forefil the needs of the Session object. the above implementation was fine for my needs.

    }

} 
```

然后使用如下代码：

```
public class MyController : TestableController { } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T09:01:13.973

[因为 HttpContext 是静态的，所以我使用 Typemock Isolator 来模拟它，Typemock 还有一个为ASP.NET 单元测试](http://www.typemock.com/ASP.NET_unit_testing_page.php)定制的 Add-in，称为[Ivonna](http://sm-art.biz/Ivonna.aspx)。

# cocoa - 未在文件内容中进行替换的 Xcode 项目模板的具体帮助

> ID：176373
> 
> 赞同：3
> 
> 时间：2008-10-06T21:58:59.567
> 
> 标签：cocoa, xcode, macos

我们正在尝试制作一个项目模板，但是这方面的文档参差不齐或根本不存在。

对一些模板文件进行逆向工程，我们得出以下结论。然而，它实际上并不起作用！

首先，我们已经弄清楚应该在里面安装项目模板：

~/Library/Application Support/Developer/Shared/Xcode/Project Templates

我们已经制作了项目并将其安装在这里，这部分工作 - 我们看到它出现在 Xcode“新项目”选择器的“用户模板”部分。

项目文件夹包含以下文件。如您所见，我希望替换文件名（该部分有效），但正如您将看到的，我还希望替换文件的内容；这不会发生。

*   ___项目名称___.xcodeproj
*   ___PROJECTNAMEASIDENTIFIER____Prefix.pch
*   ___PROJECTNAMEASIDENTIFIER___.icns
*   ___PROJECTNAMEASIDENTIFIER___Delegate.h
*   ___PROJECTNAMEASIDENTIFIER___Delegate.m
*   ___PROJECTNAMEASIDENTIFIER___Template.html
*   调试.xcconfig
*   en.lproj
*   信息列表
*   发布.xcconfig

我在 ___PROJECTNAME___.xcodeproj 包中放入了两个特殊文件：

*   模板信息.plist
*   TemplateIcon.icns - 新项目窗口中显示的图标

如果我使用这个模板创建一个新项目（称为“Foo & Bar”作为压力测试），这些是它创建的文件：

*   调试.xcconfig
*   en.lproj
*   Foo & Bar.xcodeproj
*   Foo___Bar_Prefix.pch
*   Foo___Bar.icns
*   Foo___BarDelegate.h
*   Foo___BarDelegate.m
*   Foo___BarTemplate.html
*   信息列表
*   发布.xcconfig

到目前为止，一切都很好！

但是查看文件内容，我得到了这样的东西。这是 Foo___BarDelegate.m 的内容：

```
//
//  «PROJECTNAMEASIDENTIFIER»Delegate.m
//  «PROJECTNAME»
//
//  Created by «FULLUSERNAME» on «DATE».
//  Copyright «ORGANIZATIONNAME» «YEAR» . All rights reserved.
//

#import "«PROJECTNAMEASIDENTIFIER»Delegate.h"

@implementation «PROJECTNAMEASIDENTIFIER»Delegate

@end 
```

明显的问题是我在某种程度上做错了 TemplateInfo.plist。但是话又说回来，请注意不仅我的特殊物品没有被替换，而且标准物品甚至没有被替换！所以也许这是一个更深层次的问题。

但是，有问题的 TemplateInfo.plist 是我最好的假设，我提出了一些我尝试过的变体。都不工作。

任何一个：

```
{
    FilesToMacroExpand = (
        "\_\_\_PROJECTNAMEASIDENTIFIER\_\_\_\_Prefix.pch",
        "en.lproj/InfoPlist.strings",
        "\_\_\_PROJECTNAMEASIDENTIFIER\_\_\_\_Prefix.pch",
        "\_\_\_PROJECTNAMEASIDENTIFIER\_\_\_.icns",
        "\_\_\_PROJECTNAMEASIDENTIFIER\_\_\_Delegate.h",
        "\_\_\_PROJECTNAMEASIDENTIFIER\_\_\_Delegate.m",
        "\_\_\_PROJECTNAMEASIDENTIFIER\_\_\_Template.html",
        "Info.plist"
    );
    Description = "This project builds a cocoa-based \"element\" plugin for Sandvox.";
} 
```

或者：

```
{
    FilesToMacroExpand = (
        "«PROJECTNAMEASIDENTIFIER»\_Prefix.pch",
        "en.lproj/InfoPlist.strings",
        "«PROJECTNAMEASIDENTIFIER»\_Prefix.pch",
        "«PROJECTNAMEASIDENTIFIER».icns",
        "«PROJECTNAMEASIDENTIFIER»Delegate.h",
        "«PROJECTNAMEASIDENTIFIER»Delegate.m",
        "«PROJECTNAMEASIDENTIFIER»Template.html",
        "Info.plist"
    );
    Description = "This project builds a cocoa-based \"element\" plugin for Sandvox.";
} 
```

**更新**：我也尝试添加“FilesToRename”键，即使 ___ 似乎会自动导致重命名发生。这是 XML 格式的 plist 内容（因为有些人担心事物的 UTF-8 特性——是的，它是一个有效的 plist）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Description</key>
    <string>This project builds a cocoa-based "element" plugin for Sandvox.</string>
    <key>FilesToMacroExpand</key>
    <array>
        <string>«PROJECTNAMEASIDENTIFIER»_Prefix.pch</string>
        <string>en.lproj/InfoPlist.strings</string>
        <string>«PROJECTNAMEASIDENTIFIER».icns</string>
        <string>«PROJECTNAMEASIDENTIFIER»Delegate.h</string>
        <string>«PROJECTNAMEASIDENTIFIER»Delegate.m</string>
        <string>«PROJECTNAMEASIDENTIFIER»Template.html</string>
        <string>Info.plist</string>
    </array>
    <key>FilesToRename</key>
    <dict>
        <key>___PROJECTNAMEASIDENTIFIER___.icns</key>
        <string>«PROJECTNAMEASIDENTIFIER».icns</string>
        <key>___PROJECTNAMEASIDENTIFIER___Delegate.h</key>
        <string>«PROJECTNAMEASIDENTIFIER»Delegate.h</string>
        <key>___PROJECTNAMEASIDENTIFIER___Delegate.m</key>
        <string>«PROJECTNAMEASIDENTIFIER»Delegate.m</string>
        <key>___PROJECTNAMEASIDENTIFIER___Template.html</key>
        <string>«PROJECTNAMEASIDENTIFIER»Template.html</string>
        <key>___PROJECTNAMEASIDENTIFIER____Prefix.pch</key>
        <string>«PROJECTNAMEASIDENTIFIER»_Prefix.pch</string>
        <key>___PROJECTNAME___.xcodeproj</key>
        <string>«PROJECTNAME».xcodeproj</string>
    </dict>
</dict>
</plist> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T22:13:23.533

您可能想要使用“FilesToRename”部分。以下来自 PyObjC Cocoa Document Based Application 模板。它工作正常。

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
        <key>Description</key>
        <string>This project builds a Cocoa-based application written in Python that uses the NSDocument architecture.</string>
        <key>FilesToMacroExpand</key>
        <array>
                <string>«PROJECTNAME»_Prefix.pch</string>
                <string>Info.plist</string>
                <string>English.lproj/InfoPlist.strings</string>
                <string>English.lproj/MainMenu.xib</string>
                <string>English.lproj/«PROJECTNAMEASIDENTIFIER»Document.xib</string>
                <string>main.py</string>
                <string>«PROJECTNAMEASIDENTIFIER»Document.py</string>
                <string>main.m</string>
        </array>
        <key>FilesToRename</key>
        <dict>
                <key>CocoaAppDocument.py</key>
                <string>«PROJECTNAMEASIDENTIFIER»Document.py</string>
                <key>CocoaDocApp_Prefix.pch</key>
                <string>«PROJECTNAMEASIDENTIFIER»_Prefix.pch</string>
                <key>English.lproj/CocoaAppDocument.xib</key>
                <string>English.lproj/«PROJECTNAMEASIDENTIFIER»Document.xib</string>
        </dict>
</dict>
</plist> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T22:47:48.673

另一个资源是 Jesse Grosjean 的[XcodeTemplateFactory](http://hogbaysoftware.com/products/xcodetemplatefactory)。它是免费和开源的，可能会为您省去未来的麻烦。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T07:59:58.387

除了 Chris 的回答（“有两种样式的模板......”），您可以在另一个平台的模板中找到新样式的示例......

以下摘录显示了一些使用三重下划线的典型替换变量的示例；如果您使用这些代替 Foo___BarDelegate.m 中基于 guillamot 的变量，它应该可以工作。

```
//
//  ___PROJECTNAMEASIDENTIFIER___AppDelegate.m
//  ___PROJECTNAME___
//
//  Created by ___FULLUSERNAME___ on ___DATE___.
//  Copyright ___ORGANIZATIONNAME___ ___YEAR___. All rights reserved.
//

#import "___PROJECTNAMEASIDENTIFIER___AppDelegate.h"

@implementation ___PROJECTNAMEASIDENTIFIER___AppDelegate 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T22:05:32.270

有两种样式的模板，以模板宏分隔符区分：旧样式在 UTF-8 文件中使用 MacRoman guillamots，而新样式在整个文件中使用三重下划线。你不能混搭。新样式仅适用于 3.1 及更高版本，您还必须在要替换的文件名中使用三重下划线。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-24T12:22:36.667

我只是在解决同样的问题！

对我来说，在 plist 中添加文件是可行的，我用 php 文件更改了 html 文件并对其进行了解析。但现在它只解析列表中的少数第一项。旧的 html 文件仍然是：«PROJECTNAME» 就像这个程序不计算列表中有多少项目......

但是代码中的位置在哪里，它不这样做......？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-24T00:21:45.783

为什么你缺少那些“<<”之类的符号？这就是为什么`xcode`不识别和替换模板标签的原因..

# c++ - 使用 STL map/set/multiset/multimap，如何找到第一个大于或等于搜索键的值？

> ID：176376
> 
> 赞同：4
> 
> 时间：2008-10-06T21:59:52.530
> 
> 标签：c++, stl, containers

假设我有一组值，存储在 std::set 中：

{1、2、6、8}

我有一个搜索键，比如 3。我想将 3 放入一个函数并获得大于或等于 3 的第一个值，在这种情况下，我想获得 6。

map/set/multimap/and set 中提供的 find() 函数当然会返回这种情况的结束迭代器。在这种情况下，是否有类似的函数可以返回 6？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T22:04:10.913

是：`upper_bound(X)`返回一个迭代器，指向大于 的第一个元素`X`。还有一个`lower_bound(X)`函数返回一个迭代器，该迭代器指向不小于 的第一个元素`X`。因此，半开区间中的所有元素`[lower_bound(X), upper_bound(X))`都将等于 X。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T22:03:37.843

您需要[upper_bound](http://www.sgi.com/tech/stl/upper_bound.html)函数。

```
map<int, int> mymap = { 1,2,6,8 };
map<int,int>::iterator i = mymap.upper_bound(3); // returns an iterator to the '6' element. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T22:03:40.963

[下限](http://www.cppreference.com/wiki/stl/algorithm/lower_bound)。

糟糕，我的意思是[lower_bound](http://www.cppreference.com/wiki/stl/set/lower_bound)，成员函数，而不是算法。

如果集合中没有任何内容大于或等于您的搜索项，它将返回 end()。

# sql-server - 确定 SQL Server 数据库大小

> ID：176379
> 
> 赞同：77
> 
> 时间：2008-10-06T21:59:56.803
> 
> 标签：sql-server, tsql

SQL Server 2005/2008 Express 版本的限制为每个数据库 4 GB。据我所知，数据库引擎只考虑数据，因此不包括日志文件、未使用空间和索引大小。

根据 SQL Server 限制，获取 MDF 文件的长度不应给出正确的数据库大小。我的问题是如何获取数据库大小？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-10-06T22:02:23.273

sp_spaceused

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-02-05T18:23:36.840

sp_helpdb

不需要循环，不像 sp_spaceused。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-06T22:18:45.237

根据SQL2000的帮助，sp_spaceused包括数据和索引。

这个脚本应该做：

```
CREATE TABLE #t (name SYSNAME, rows CHAR(11), reserved VARCHAR(18), 
data VARCHAR(18), index_size VARCHAR(18), unused VARCHAR(18))

EXEC sp_msforeachtable 'INSERT INTO #t EXEC sp_spaceused ''?'''
-- SELECT * FROM #t ORDER BY name
-- SELECT name, CONVERT(INT, SUBSTRING(data, 1, LEN(data)-3)) FROM #t ORDER BY name
SELECT SUM(CONVERT(INT, SUBSTRING(data, 1, LEN(data)-3))) FROM #t
DROP TABLE #t 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-06T22:14:51.923

在 SQL Management Studio 中，右键单击数据库并从上下文菜单中选择“属性”。看“尺寸”图。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-09-28T07:06:30.200

最好的解决方案可能是使用 sys.sysfiles 视图计算每个数据库文件的大小，考虑到每个页面的大小为 8 KB，如下所示：

```
USE [myDatabase]
GO

SELECT
    [size] * 8
    , [filename]
FROM sysfiles 
```

[field] 列表示文件的大小，以页为单位（[MSDN Reference to sysfiles](http://msdn.microsoft.com/en-us/library/ms178009.aspx)）。

您会看到至少有两个文件（MDF 和 LDF）：这些文件的总和将为您提供整个数据库的正确大小......

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-08-02T14:08:42.263

我一直喜欢直接追求它：

```
SELECT 
    DB_NAME( dbid ) AS DatabaseName, 
    CAST( ( SUM( size ) * 8 ) / ( 1024.0 * 1024.0 ) AS decimal( 10, 2 ) ) AS DbSizeGb 
FROM 
    sys.sysaltfiles 
GROUP BY 
    DB_NAME( dbid ) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-27T08:31:57.400

你也可以用这个老式的...

```
set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
go

DECLARE @iCount int, @iMax int, @DatabaseName varchar(200), @SQL varchar (8000)

Select NAME, DBID, crdate, filename, version 
INTO #TEMP
from MAster..SYSDatabASES 

SELECT @iCount = Count(DBID) FROM #TEMP

Select @SQL='Create Table ##iFile1 ( DBName varchar( 200) NULL, Fileid INT, FileGroup int, TotalExtents INT , USedExtents INT , 
Name varchar(100), vFile varchar (300), AllocatedSpace int NUll, UsedSpace int Null, PercentageFree int Null ) '+ char(10)
exec (@SQL)

Create Table ##iTotals ( ServerName varchar(100), DBName varchar( 200) NULL, FileType varchar(10),Fileid INT, FileGroup int, TotalExtents INT , USedExtents INT , 
Name varchar(100), vFile varchar (300), AllocatedSpace int NUll, UsedSpace int Null, PercentageFree int Null ) 

WHILE @iCount>0
BEGIN    
    SELECT @iMax =Max(dbid) FROM #TEMP
    Select @DatabaseName = Name FROM #TEMP where dbid =@iMax

    SELECT @SQL = 'INSERT INTO ##iFile1(Fileid , FileGroup , TotalExtents  , USedExtents  , Name , vFile)
     EXEC (''USE [' + @DatabaseName +  '] DBCC showfilestats'')    ' + char(10)

    Print  (@SQL)
    EXEC (@SQL)

    SELECT @SQL = 'UPDATE ##iFile1 SET DBName ='''+ @DatabaseName +''' WHERE DBName IS NULL'
    EXEC  (@SQL)

    DELETE FROM #TEMP WHERE dbid =@iMax
    Select @iCount =@iCount -1
END
UPDATE ##iFile1
SET AllocatedSpace = (TotalExtents * 64.0 / 1024.0 ), UsedSpace =(USedExtents * 64.0 / 1024.0 )

UPDATE ##iFile1
SET PercentageFree = 100-Convert(float,UsedSpace)/Convert(float,AllocatedSpace   )* 100
WHERE USEDSPACE>0

CREATE TABLE #logspace (
   DBName varchar( 100),
   LogSize float,
   PrcntUsed float,
   status int
   )
INSERT INTO #logspace
EXEC ('DBCC sqlperf( logspace)')

INSERT INTO ##iTotals(ServerName, DBName, FileType,Name, vFile,PercentageFree,AllocatedSpace)
select @@ServerName ,DBNAME,  'Data' as FileType,Name, vFile, PercentageFree  , AllocatedSpace
from ##iFile1
UNION
select @@ServerName ,DBNAME, 'Log' as FileType ,DBName,'' as vFile ,PrcntUsed  , LogSize
from #logspace

Select * from ##iTotals

select ServerName ,DBNAME,  FileType, Sum( AllocatedSpace) as AllocatedSpaceMB
from ##iTotals
Group By  ServerName ,DBNAME, FileType
Order By  ServerName ,DBNAME, FileType

select ServerName ,DBNAME,  Sum( AllocatedSpace) as AllocatedSpaceMB
from ##iTotals
Group By  ServerName ,DBNAME
Order By  ServerName ,DBNAME

drop table ##iFile1
drop table #logspace
drop table #TEMP
drop table ##iTotals 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-18T12:27:37.660

***在支持 Azure 和本地的 SQL Server 中检查数据库大小的通用查询-***

**方法 1 – 使用 'sys.database_files' 系统视图**

```
SELECT
    DB_NAME() AS [database_name],
    CONCAT(CAST(SUM(
        CAST( (size * 8.0/1024) AS DECIMAL(15,2) )
    ) AS VARCHAR(20)),' MB') AS [database_size]
FROM sys.database_files; 
```

**方法 2 – 使用“sp_spaceused”系统存储过程**

```
EXEC sp_spaceused ; 
```

# c++-cli - 托管 C++/CLI 类中的 auto_ptr 或 shared_ptr 等效项

> ID：176403
> 
> 赞同：10
> 
> 时间：2008-10-06T22:06:51.673
> 
> 标签：c++-cli, smart-pointers, auto-ptr

在 C++/CLI 中，您可以在托管类中使用本机类型，但不允许在托管类中持有本机类的成员：在这种情况下您需要使用指针。

这是一个例子：

```
class NativeClass
{
....
};

public ref class ManagedClass
{
private:
  NativeClass mNativeClass; // Not allowed !

  NativeClass * mNativeClass; // OK

  auto_ptr<NativeClass> mNativeClass; //Not allowed !
  boost::shared_ptr<NativeClass> mNativeClass; //Not allowed !

}; 
```

有人知道 C++/CLI 世界中的 shared_ptr 等价物吗？

编辑：感谢您的建议，“1800-信息”。根据您的建议，我检查了 STL.Net，但它仅适用于 Visual Studio 2008，它提供容器 + 算法，但没有智能指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T23:26:04.760

我在[codeproject](http://www.codeproject.com)上找到了答案：

[Nishant Sivakumar 在http://www.codeproject.com/KB/mcpp/CAutoNativePtr.aspx](http://www.codeproject.com/KB/mcpp/CAutoNativePtr.aspx)上发布了一篇关于此的文章

在此页面上，还可以查看 Denis N. Shevchenko 的评论：他提供了一个运行良好的类似 stl 的实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:35:51.787

我还没有彻底测试过这个，但是像下面这样的东西怎么样：

```
#pragma once

#include <memory>

template <class T>
public ref class m_shared_ptr sealed
{
    std::shared_ptr<T>* pPtr;

public:
    m_shared_ptr() 
        : pPtr(nullptr) 
    {}

    m_shared_ptr(T* t) {
        pPtr = new std::shared_ptr<T>(t);
    }

    m_shared_ptr(std::shared_ptr<T> t) {
        pPtr = new std::shared_ptr<T>(t);
    }

    m_shared_ptr(const m_shared_ptr<T>% t) {
        pPtr = new std::shared_ptr<T>(*t.pPtr);
    }

    !m_shared_ptr() {
        delete pPtr;
    }

    ~m_shared_ptr() {
    delete pPtr;
    }

    operator std::shared_ptr<T>() {
        return *pPtr;
    }

    m_shared_ptr<T>% operator=(T* ptr) {
        pPtr = new std::shared_ptr<T>(ptr);
        return *this;
    }

    T* operator->() {
        return (*pPtr).get();
    }
}; 
```

这应该让您可以在 ref 类中互换使用 C++11/Boost 的 shared_ptrs。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T22:24:38.487

[STL.Net 记录在这里](http://msdn.microsoft.com/en-us/library/ms379600.aspx)。我不知道它处于什么状态或它可能对您有什么用处。

# c - 用 C 构建一个简单的 HTTP 服务器

> ID：176409
> 
> 赞同：127
> 
> 时间：2008-10-06T22:10:24.083
> 
> 标签：c, httpserver

我需要在 C 中构建一个简单的 HTTP 服务器。有什么指导吗？链接？样品？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2008-10-06T22:35:14.720

我建议您看一下：[编写客户端和服务器的实用指南](http://www.jmarshall.com/easy/http)

您必须以增量步骤实施的是：

1.  让您的基本 TCP 套接字层运行（监听端口/端口，接受客户端连接和发送/接收数据）。
2.  实现一个缓冲读取器，以便您一次可以读取一行（由 CRLF 分隔）的请求。
3.  阅读第一行。解析出方法、请求版本和路径。
4.  为“Header: value”语法实现标头解析。不要忘记展开折叠的标题。
5.  检查请求方法、内容类型和内容大小以确定如何/是否读取正文。
6.  实现基于内容类型的内容解码。
7.  如果您要支持 HTTP 1.1，请实现诸如“100 Continue”、保持活动、分块传输之类的东西。
8.  添加健壮性/安全措施，例如检测不完整的请求、限制最大客户端数量等。
9.  收缩包装你的代码并开源它:)

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2008-10-06T22:13:39.443

我建议你看看[tiny httpd](http://tinyhttpd.sourceforge.net/)。如果您想从头开始编写它，那么您需要*彻底*阅读[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616)。使用[BSD 套接字](http://en.wikipedia.org/wiki/Berkeley_sockets)在非常低的级别访问网络。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-10-06T22:15:34.510

HTTP 服务器在概念上很简单：

*   打开 80 端口进行监听
*   建立联系后，收集一些信息（主要获取 - 你现在可以忽略其余的）
*   将请求翻译成文件请求
*   打开文件并将其吐回客户端

根据您想要支持多少 HTTP，它变得更加困难 - POST 稍微复杂一点，脚本，处理多个请求等。

但是基础非常简单。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-10-06T22:30:51.877

[Mongoose](http://code.google.com/p/mongoose)（以前的简单 HTTP 守护程序）非常好。特别是，它可以在 Windows、Windows CE 和 UNIX 下嵌入和编译。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-06T22:12:41.710

在端口 80 上打开一个 TCP 套接字，开始监听新连接，实现[这个](http://www.w3.org/Protocols/rfc2616/rfc2616.html)。根据您的目的，您可以忽略几乎所有内容。最简单的情况是，您可以为每个请求发送相同的响应，这仅涉及将文本写入套接字。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2012-08-26T18:44:21.240

看看 nweb（Nigel 的 Web 服务器），“一个只有 200 行 C 源代码的小型、安全的 Web 服务器 [...]”：

[https://drive.google.com/file/d/0B3msld7qnNOhN1NXaFIwSFU2Mjg/view?usp=sharing&resourcekey=0-ngY0neP78dxJKlFv0PJoDQ](https://drive.google.com/file/d/0B3msld7qnNOhN1NXaFIwSFU2Mjg/view?usp=sharing&resourcekey=0-ngY0neP78dxJKlFv0PJoDQ) ~~http://www.ibm.com/developerworks/systems/library/es-nweb/~~

文章包括伪代码、解释和评论。

编辑：IBM 的链接已经失效。我已将网页的 PDF 保存到 Google 云端硬盘。下面是代码下载：

[https://drive.google.com/file/d/0B3msld7qnNOhSGZGdDJJMmY0VHM/view?usp=sharing&resourcekey=0-xkbf4mv0gN1sZrhBjt86UQ](https://drive.google.com/file/d/0B3msld7qnNOhSGZGdDJJMmY0VHM/view?usp=sharing&resourcekey=0-xkbf4mv0gN1sZrhBjt86UQ)

@ankushagarwal[做](https://github.com/ankushagarwal)了一些改动，并在 GitHub 上上传了他的版本： [https ://github.com/ankushagarwal/nweb](https://github.com/ankushagarwal/nweb)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-06T22:12:55.140

我自己写了你可以使用的。这个作品有 sqlite，是线程安全的，并且是 C++ for UNIX。

您应该能够将其拆开并使用与 C 兼容的代码。

[http://code.google.com/p/mountain-cms/](http://code.google.com/p/mountain-cms/)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-06T22:38:50.143

当我不得不为*我的*家庭作业做[HTTP 规范](http://www.ietf.org/rfc/rfc2616.txt)和[Firebug时，它对我非常有用。](https://addons.mozilla.org/en-US/firefox/addon/1843)

 *祝你好运。:)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-06T22:12:32.287

我建议查看诸如[lighthttpd](http://www.lighttpd.net/)之类的源代码。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-07T01:23:04.710

[http://www.manning.com/hethmon/](http://www.manning.com/hethmon/) -- Manning 的“Illustrated Guide to HTTP by Paul S. Hethmon”是一本非常好的学习 HTTP 协议的书，对实现/扩展它的人非常有用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-06T22:13:26.310

使用平台特定的套接字函数来封装 HTTP 协议，就像[Apache](http://en.wikipedia.org/wiki/Apache_HTTP_Server)背后的人所做的那样。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-12-30T07:17:40.043

有[更多响应的副本](https://stackoverflow.com/questions/175507/c-c-web-server-library)。

尚未提及的一个候选者是[spserver](http://code.google.com/p/spserver/)。

# php - PHP HTML 生成 - 使用字符串连接

> ID：176411
> 
> 赞同：4
> 
> 时间：2008-10-06T22:11:05.783
> 
> 标签：php, performance, string-concatenation

关于从 PHP 输出 html 的不同方法的问题；这些之间的性能差异是什么：

方法 1 - 变量串联

```
$html = '';
$html .= '<ul>';
for ($k = 1; $k < = 1000; $k++){
    $html .= '<li> This is list item #'.$k.'</li>';
}
$html .= '</ul>';
echo $html; 
```

方法 2 - 输出缓冲

```
ob_start();
echo '<ul>';
for ($k = 1; $k < = 1000; $k++){
    echo '<li> This is list item #',$k,'</li>';
}
echo '</ul>'; 
```

我怀疑您会因不断修改和扩大变量而受到一些性能影响；那是对的吗？

干杯!

谢谢 GaryF，但我不想要关于架构的答案——这个问题是关于性能的。关于哪个更快，似乎有一些不同的意见/测试，这就是为什么还没有一个公认的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T22:41:55.707

撇开字符串连接本身的想法不谈，你真的在​​问（我认为）你应该如何构建网页，我觉得任何形式的显式连接都可能是错误的做法。

尝试使用[Model-View-Control 模式](http://en.wikipedia.org/wiki/Model-view-controller)来构建您的数据，并将其传递给一个简单的模板库（如[Smarty](http://www.smarty.net/)），并让它担心如何构建您的视图。

更好的分离，更少的担忧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T22:17:29.373

我通常使用方法 #1，因此我可以将该 HTML 放在包含静态 HTML 的模板文件中的任何位置。我尝试在我的 PHP 中保留尽可能多的 HMTL。它使 PHP 更简洁、更短，因为模板通常是一个单独的文件。

关于速度/性能，我认为差异将非常小。使用输出缓冲，它也一直在扩大一个变量，尽管该变量不可访问，但它必须存储在某个地方。

我经常想知道打开和关闭`<?php`是否比将其全部放入`<?php`然后一次全部回显要慢。

我认为最终我们在极其复杂的脚本中谈论毫秒。

哦，是的，方法#1 在任何地方都更加灵活`echo $html;`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T04:30:07.227

它有点旧，但Sara Golemon 的[这篇文章可能会有所帮助。](http://blog.libssh2.org/index.php?/archives/28-How-long-is-a-piece-of-string.html)AFAIK 输出缓冲功能非常快速和高效`echo`，所以这就是我要使用的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T22:18:23.787

确实，不断修改变量并重新打印它会产生轻微的开销。但是，*不*这样做意味着脚本可能会在某些时候完成运行（由于中断或类似原因），并且连续的 echo 语句将部分打印页面而不是什么都打印。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T22:27:30.557

我打算输入一个关于 PHP 字符串如何可变的长回复（与 C 或 C# 中的不可变字符串相反），但我想我只会链接到[我遇到的旧帖子](https://stackoverflow.com/questions/124067/php-string-concatenation-performance#124109)。关于使用字符串生成器的 Java 和 C# 解决方案，我基本上处理了您的问题。

旁注：stringbuilder 解决方案将类似于（未经测试）：

```
$html = array();
$html[] = '<ul>';
for ($k = 1; $k < = 1000; $k++){
    $html[] = '<li> This is list item #';
    $html[] = $k;
    $html[] = '</li>';
}
$html[] = '</ul>';
echo implode('',$html); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T22:29:13.750

只是几个想法：

*   输出缓冲可以让你的页面看起来很慢，因为在整个脚本运行之前用户什么都看不到（尽管你有 #1 设置的方式同样适用）。

*   php 中的字符串是可变的，因此连接并不像其他一些语言那样糟糕。话虽如此，输出缓冲可能会快一点，因为默认情况下为输入分配的空间相当大（根据[this](http://phplens.com/lens/php-book/optimizing-debugging-php.php) 40K ）

最后我想说这更多的是风格问题。如果您喜欢输出缓冲给您带来的好处，那么这可能是您要走的路。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T22:38:18.850

您的问题的答案也可以在这里找到：[php: output[] w/ join vs $output .=](https://stackoverflow.com/questions/111282/php-output-w-join-vs-output)

字符串连接是构建字符串的最快方法。

我还没有测试过“回声”与字符串构建，但只要你不使用缓冲输出，回声应该是最快的，因为顺序写入自刷新缓冲区。（只有减速在冲洗，即使你提前进行字符串连接，你也不会真正避免）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T01:31:31.450

我没有看到提到的是，通常，PHP 人员必须与需要对 HTML 进行分类或以其他方式添加样式的设计人员合作，因此解决方案必须牢记这一点。

# regex - Flex ：使用包含在数据字段中的组合框值过滤数据网格

> ID：176440
> 
> 赞同：0
> 
> 时间：2008-10-06T22:20:26.873
> 
> 标签：regex, apache-flex, datagrid, combobox, filter

我在包含多个条目的组合框中有一个过滤器。我不想使用完全匹配过滤数据网格，而是采用所选值并仅显示数据字段中包含所选值的记录。例如：用户选择值“New”，数据网格显示记录，其中记录的内容可能是“New User”、“New Person”、“This one is New”等。我认为我需要使用RegExp，但我不知道如何让它工作。在此先感谢，S...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T23:14:11.973

像这样的东西应该工作：

```
 public function filter(item:Object):Boolean{
        var result:Boolean=false;
        if (item.name.toUpperCase().indexOf(cbo.selectedLabel.toUpperCase()) >= 0)
             result=true;
        return result;
 } 
```

此过滤器函数将搜索使用组合框当前选定标签传入的对象的名称属性（或您要过滤的任何内容），如果找到该值，它将返回 true。因此，如果它在字符串中的任何位置找到单词“New”，它将显示在数据网格中。IE：“新用户”、“新用户”都将在过滤后显示。

希望这是您正在寻找的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-26T15:23:35.030

您可以修改它以产生下拉过滤功能。当前文本框过滤正在工作。所以我把它贴在这里。

声明 2 个字符串变量 tempString 和 tempString_Name 然后...

**使用以下 2 个函数**

```
 private function filterByTerritory(item:Object):Boolean{
        tempString = item.name;
        tempString_Name = item.territory;
        if( (tempString.indexOf(sampleFilter.text,0) != -1) && 
                      (tempString_Name.indexOf(terrFilterTxt.text,0) != -1)){
            return true;
        }
        else{
            return false;
        }
     } 
     private function doFilter():void{
        if( (sampleFilter.text.length == 0) && 
                (terrFilterTxt.text.length == 0)) {
            myData.filterFunction == null;
        }
        else{
            myData.filterFunction = filterByTerritory;
        }
        myData.refresh();
     } 
```

**通过这两个文本框接受数据**

```
<mx:TextInput id="sampleFilter" change="doFilter()"/>
  <mx:TextInput id="terrFilterTxt" change="doFilter()"/> 
```

简而言之：在您希望进行过滤的某个事件上调用 doFilter。

很快我将发布基于组合框过滤数据网格。到时候再见。我很快就会成为会员:)

# java - 如何将元素添加到通配符通用集合中？

> ID：176446
> 
> 赞同：19
> 
> 时间：2008-10-06T22:22:11.517
> 
> 标签：java, generics

为什么此 Java 代码会出现编译器错误？

```
1  public List<? extends Foo> getFoos()
2  {
3    List<? extends Foo> foos = new ArrayList<? extends Foo>();
4    foos.add(new SubFoo());
5    return foos;
6  }
```

其中 'SubFoo' 是一个实现 Foo 的具体类，而 Foo 是一个接口。

我使用此代码得到的错误：

*   第 3 行：“无法实例化 ArrayList<? extends Foo>”
*   在第 4 行：“List<capture#1-of ? extends Foo> 类型中的方法 add(capture#1-of ? extends Foo) 不适用于参数 (SubFoo)”

**更新：**感谢 Jeff C，我可以将第 3 行更改为“new ArrayList<Foo>();”。但我仍然遇到第 4 行的问题。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-06T22:35:23.537

改用这个：

```
1  public List<? extends Foo> getFoos()
2  {
3    List<Foo> foos = new ArrayList<Foo>(); /* Or List<SubFoo> */
4    foos.add(new SubFoo());
5    return foos;
6  } 
```

一旦将 foos 声明为`List<? extends Foo>`，编译器就不知道添加 SubFoo 是安全的。如果 an`ArrayList<AltFoo>`被分配到`foos`怎么办？那将是一个有效的分配，但添加一个 SubFoo 会污染集合。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-16T09:18:33.813

只是想通过总结用类型或通配符实例化的 List 参数的属性来添加到这个旧线程中......

当方法的参数/结果是列表时，使用类型实例化或通配符确定

1.  可以作为参数传递给方法的 List 类型
2.  可以从方法结果中填充的列表类型
3.  可以在方法中写入列表的元素类型
4.  从方法内的列表中读取元素时可以填充的类型

## 参数/返回类型：`List< Foo>`

1.  可以作为参数传递给方法的 List 类型：
    *   `List< Foo>`
2.  可以从方法结果中填充的列表类型：
    *   `List< Foo>`
    *   `List< ? super Foo>`
    *   `List< ? super SubFoo>`
    *   `List< ? extends Foo>`
    *   `List< ? extends SuperFoo>`
3.  可以在方法中写入列表的元素类型：
    *   `Foo`& 亚型
4.  从方法内的列表中读取元素时可以填充的类型：
    *   `Foo`& 超类型（最多`Object`）

## 参数/返回类型：`List< ? extends Foo>`

1.  可以作为参数传递给方法的 List 类型：
    *   `List< Foo>`
    *   `List< Subfoo>`
    *   `List< SubSubFoo>`
    *   `List< ? extends Foo>`
    *   `List< ? extends SubFoo>`
    *   `List< ? extends SubSubFoo>`
2.  可以从方法结果中填充的列表类型：
    *   `List< ? extends Foo>`
    *   `List< ? extends SuperFoo>`
    *   `List< ? extends SuperSuperFoo>`
3.  可以在方法中写入列表的元素类型：
    *   没有任何！无法添加。
4.  从方法内的列表中读取元素时可以填充的类型：
    *   `Foo`& 超类型（最多`Object`）

## 参数/返回类型：`List<? super Foo>`

1.  可以作为参数传递给方法的 List 类型：
    *   `List< Foo>`
    *   `List< Superfoo>`
    *   `List< SuperSuperFoo>`
    *   `List< ? super Foo>`
    *   `List< ? super SuperFoo>`
    *   `List< ? super SuperSuperFoo>`
2.  可以从方法结果中填充的列表类型：
    *   `List< ? super Foo>`
    *   `List< ? super SubFoo>`
    *   `List< ? super SubSubFoo>`
3.  可以在方法中写入列表的元素类型：
    *   `Foo`& 超类型
4.  从方法内的列表中读取元素时可以填充的类型：
    *   `Foo`& 超类型（最多`Object`）

## 解释/评论

*   外部调用者的需求驱动方法声明的设计，即公共 API（通常是主要考虑因素）
*   内部方法逻辑的需求驱动对内部声明和构造的实际数据类型的任何额外决策（通常是次要考虑）
*   如果调用者代码始终专注于操作 Foo 类，则使用`List<Foo>`它，因为它最大限度地提高了读写的灵活性
*   如果可能有许多不同类型的调用者，专注于操作`List<? extends UpperMostFoo>`不同的类（不总是 Foo）并且 Foo 类型层次结构中有一个最上层的类，并且方法是内部写入列表和调用者列表操作，则使用在看书。在这里，该方法可以在返回之前在内部使用`List< UpperMostFoo>`并向其添加元素`List< ? extends UpperMostFoo>`
*   如果可能有许多不同类型的调用者，专注于操作不同的类（不总是 Foo），并且如果需要读取和写入列表并且 Foo 类型层次结构中有一个最低的类，那么使用它是有意义的`List< ? super LowerMostFoo>`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-06T22:38:47.897

尝试：

```
public List<Foo> getFoos() {
    List<Foo> foos = new ArrayList<Foo>();
    foos.add(new SubFoo());
    return foos;
} 
```

泛型 ArrayList 构造函数需要具有特定类型以进行参数化，您不能使用“？” 通配符在那里。将实例化更改为“new ArrayList<Foo>()”将解决第一个编译错误。

'foos' 变量的声明可以有通配符，但由于您知道确切的类型，因此在此处引用相同的类型信息更有意义。您现在所说的 foos 包含 Foo 的某些特定子类型，但我们不知道是哪个子类型。可能不允许添加 SubFoo，因为 SubFoo 不是“Foo 的所有子类型”。将声明更改为 'List<Foo> foos = ' 解决了第二个编译错误。

最后，我会将返回类型更改为“List<Foo>”，因为此方法的客户端无法对当前定义的返回值做太多事情。您应该很少在返回类型中使用通配符。如果需要，使用参数化的方法签名，但更喜欢有界类型只出现在方法参数中，因为这让调用者可以传入特定类型并相应地操作它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T22:36:39.930

以下将正常工作：

```
public List<? extends Foo> getFoos() {
    List<Foo> foos = new ArrayList<Foo>();
    foos.add(new SubFoo());
    return foos;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-03-23T13:52:56.590

要了解泛型的工作原理，请查看以下示例：

```
 List<SubFoo> sfoo = new ArrayList<SubFoo>();
    List<Foo> foo;
    List<? extends Foo> tmp;

    tmp = sfoo;
    foo = (List<Foo>) tmp; 
```

问题是，这不是为局部/成员变量设计的，而是为函数签名设计的，这就是它如此落后的原因。

# php - 如何安装 PHP/CURL？

> ID：176449
> 
> 赞同：1
> 
> 时间：2008-10-06T22:23:04.200
> 
> 标签：php, curl, installation

我尝试关注 PHP.net curl 站点，甚至这个链接：[http](http://curl.phptrack.com/forum/viewtopic.php?t=52)
://curl.phptrack.com/forum/viewtopic.php?t=52 并尝试在我的窗口笔记本电脑中安装 CURL。它不起作用.. CURL 没有安装。我想知道我是否需要在 Windows 服务器上运行它...任何人都有好的网站指导我如何安装 CURL？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T22:27:52.833

在此处下载 cURL：[http://curl.haxx.se/download.html](http://curl.haxx.se/download.html)。您可能必须更新环境变量才能让 PHP 找到 cURL 可执行文件。为此，请右键单击“我的电脑”，选择“属性”、“高级”、“环境变量”，找到 PATH 环境变量，对其进行编辑，然后将安装 cURL 的位置添加到其中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T22:36:46.030

您也可以尝试使用[XAMPP 之](http://www.apachefriends.org/en/xampp.html)类的东西在您的 Windows 机器上进行开发。它是一个多合一的包，包含使用 php 开发 Web 应用程序可能需要的一切（包括 curl）。如果您不喜欢 XAMPP，您还可以研究[大量](http://en.wikipedia.org/wiki/Comparison_of_WAMPs)其他类似的软件包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T22:44:37.213

如果您在托管主机上并且无法将 CURL 本身与 PHP 一起安装（我已经发现很多次了），那么有一个很棒的库叫做[libcurl emulator](http://code.blitzaffe.com/pages/phpclasses/category/52/fileid/7)。您将它包含在您的页面中，如果可以，它将使用已编译的版本，如果可以，则下拉到命令行，或者如果所有其他方法都失败，则运行纯 php 实现。这非常方便。

# model-view-controller - 重构应用程序

> ID：176456
> 
> 赞同：1
> 
> 时间：2008-10-06T22:27:15.160
> 
> 标签：model-view-controller, refactoring, theory

如果你必须修复和稳定一个 MVC 应用程序，你会从哪里开始：模型、控制器还是视图？这些问题在整个应用程序中平均分布，糟糕的编程实践使得添加功能变得困难。该应用程序是用 PHP 编写的，如果它有所作为的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T22:29:56.417

修复模型，因为它的变化比视图慢，而且控制器依赖于视图。您可以通过投资于良好稳定的模型代码获得更好的回报。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T05:05:25.900

从模型开始，因为它是您的应用程序的基础。编写测试也更容易。虽然可以为控制器编写单元测试，但为控制器编写单元测试很棘手，而对于视图则更难。然而，一旦你的模型有一个真正可靠且封装的 API，在它上面分层一个新的控制器和视图框架就相对容易了。如果您想真正与视图分离，请将您的模型构建为 REST API，并完全在 AJAX 中实现您的控制器。这将朝着更加面向服务的架构发展，并具有完全基于客户端的视图。这就是谷歌的工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T23:38:40.910

我按照模型、控制器、视图的顺序说。因为模型中最基本的逻辑，其次是控制器（通常在相当远的距离）

# c++ - C++ SQLBindParameter

> ID：176459
> 
> 赞同：5
> 
> 时间：2008-10-06T22:27:32.473
> 
> 标签：c++, odbc, sqlbindparameter

以下是变量的声明：

```
string strFirstName;
string strLastName;
string strAddress;
string strCity;
string strState;
double dblSalary;
string strGender;
int intAge; 
```

...做一些“cin”语句来获取数据...

```
retcode = SQLPrepare(StatementHandle, (SQLCHAR *)"INSERT INTO EMPLOYEE ([FirstName], [LastName], [Address], [City], [State], [Salary], [Gender],[Age]) VALUES (?,?,?,?,?,?,?,?)", SQL_NTS);

retcode = SQLBindParameter(StatementHandle, 1, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_LONGVARCHAR, 50, 0 &strFirstName,0, NULL);

retcode = SQLBindParameter(StatementHandle, 2, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_LONGVARCHAR, 50, 0, &strLastName,0, NULL);

retcode = SQLBindParameter(StatementHandle, 3, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_LONGVARCHAR, 30, 0, &strAddress,0, NULL);

retcode = SQLBindParameter(StatementHandle, 4, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_LONGVARCHAR, 30, 0, &strCity,0, NULL);

retcode = SQLBindParameter(StatementHandle, 5, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_LONGVARCHAR, 3, 0, &strState,0, NULL);

retcode = SQLBindParameter(StatementHandle, 6, SQL_PARAM_INPUT, SQL_C_DOUBLE, SQL_DOUBLE, 0, 0, &dblSalary,0, NULL);

retcode = SQLBindParameter(StatementHandle, 7, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_LONGVARCHAR, 2, 0, &strGender,0, NULL);

retcode = SQLBindParameter(StatementHandle, 8, SQL_PARAM_INPUT, SQL_C_LONG, SQL_INTEGER, 0, 0, &intAge,0, NULL);

retcode = SQLExecute(StatementHandle); 
```

int 和 double 工作正常并存储在表中......但我不知道如何让字符串存储......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T22:45:43.950

[SQLBindParameter 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/ms710963.aspx)说您要传递一个缓冲区，其中包含以下数据的数据`ParameterValuePtr`和缓冲区的长度（以字节为单位）`BufferLength`：

```
retcode = SQLBindParameter(StatementHandle, 1, SQL_PARAM_INPUT, SQL_C_CHAR,
   SQL_LONGVARCHAR, 50, 0, strFirstName.c_str(), strFirstName.length(), NULL); 
```

> ParameterValuePtr [Deferred Input] 指向参数数据缓冲区的指针。有关详细信息，请参阅“注释”中的“ParameterValuePtr 参数”。
> 
> BufferLength [Input/Output] ParameterValuePtr 缓冲区的长度（以字节为单位）。有关详细信息，请参阅“注释”中的“BufferLength 参数”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T22:29:35.513

它看起来像 api，想要一个**unsigned char *** 尝试使用**c_str()**方法调用传入 ac 字符串。

# internet-explorer - IE 7 在接收动态生成的 PDF 时是否有任何内存限制？如果是这样，有人有解决方法吗？

> ID：176463
> 
> 赞同：0
> 
> 时间：2008-10-06T22:28:24.890
> 
> 标签：internet-explorer, browser

我们的系统通过将许多 HTML 页面转换为单个 PDF 来动态生成大型报告。生成的 PDF 被发送回（通过 HTTP 请求）到调用浏览器。当报告足够大（200 多页）时，IE 7 会间歇性地阻塞。结果问题是调用 PC 锁定并且必须重新启动。当使用 Mozilla Firefox（在同一台 PC 上运行）等替代浏览器执行报告时，一切正常，没有任何问题。

任何想法或解决方法（除了告诉用户使用 Firefox）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T22:40:13.853

我相信有几种方法可以做到这一点：1）将 pdf 二进制数据流式传输到浏览器并更改 mime 类型，以便浏览器将其作为 pdf 处理，或 2）使用“附件”将 pdf bindara 数据流式传输到浏览器;file=" 标头，这将导致浏览器为您提供打开或保存文件的选项。

第二个选项可能会解决您的浏览器间歇性阻塞问题，尽管它不像第一个选项那样无缝，并且可能不是您想要的确切行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T01:13:45.307

您为 PDF 提供哪些标题？如果缓存标头设置为无缓存，IE 会出现可下载文件的问题，并且（尽管）我怀疑这是问题所在，IE 无法处理非常大的下载（例如 2.x Gig）

# .net - 使用 ASP.NET 和 Ajax 创建共享工作区

> ID：176473
> 
> 赞同：3
> 
> 时间：2008-10-06T22:31:23.637
> 
> 标签：.net, asp.net, ajax

这是我最近一直想知道的假设情况。假设我有一个在 ASP.NET 和 Ajax 中创建的交互式页面，我希望多个用户能够同时操作该页面。维护此页面状态的最佳方法是什么？特别是如果页面相对短暂，并且不需要特别存储在数据库中？

作为一个具体的例子，假设我正在实现一个基本的跳棋游戏。服务器需要时刻保持板子的状态。客户端需要定期检查板的状态，并且需要能够将他们的更改传输到板。当所有玩家离开时，或者当游戏结束时，棋盘就不再需要了，服务器可以将其处理掉。

我可以将所有内容存储在数据库中，当客户要求更新板时检索它，并在服务器收到更新时保存它。但这似乎是很多额外的开销。

静态变量呢？他们对于这项工作是否足够可靠/足够高效？我可以使用另一种存储机制吗？或者这是否远远超出了 ASP.NET 可以有效执行的限制，如果我想实现它，我应该研究一种完全不同的技术？

**更新：**
一个快速更新，看看我是否能得到另一轮答案。经过一番研究，这是我目前所拥有的：
[Manu](https://stackoverflow.com/questions/176473/creating-a-shared-workspace-with-aspnet-and-ajax#176568)建议独立使用 MemCached 来存储数据。我喜欢这个解决方案即使在多服务器环境中也能工作，但我注意到了一些缺点：
1）MemCached 的网站声明它适用于读取繁重的应用程序（相对于传统的 Web 应用程序，这不是），并且这是“不可靠的”。我还没有走得足够远来确定这些特性的重要性（即写入速度慢吗？是否存在传播延迟？）。
2）在与我的应用程序（存储会话数据）有点接近的实现中，MemCached 站点使用缓存后面的数据库，
3) 我担心 MemCached 在托管环境中的可用性。

查看静态变量，它们似乎确实很快。它们不是线程安全的，但可以考虑。但是，它们在工作进程中是本地的，所以我不确定它们如何与负载平衡或网络花园一起工作。

最后，至少有一个[基于 ASP.NET 的聊天客户端的](http://www.dynamicajax.com/fr/AJAX_Web_Chat_ASP_NET-.html)实现（与此示例非常相似），它使用数据库作为后端。通过适当的缓存，这可能只是“足够好”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T22:56:18.343

这在很大程度上取决于这个假设系统的使用。使用合理的刷新率（可能是 5 秒？），以及经过适当优化的数据库、适当的密钥等，这不会给您的服务器带来太大压力，尤其是如果您通过带有差异更新的 JSON-RPC 样式调用来执行此操作（仅给出我从 x 时间开始更改）而不是完整的董事会更新。

没有使用过 ASP.NET，我无法评论它的静态变量，我假设它们的工作方式类似于 PHP 中的会话变量，在这种情况下，只要它至少与 PHP 一样高效，这种方法也不应该太麻烦. 事实上，ASP.NET 很可能将这些变量存储在某种形式的数据库中。我无法想象这是一个比上面的数据库选项更糟糕的选项，如果不是更好的选项性能明智的话，只要有某种方法可以在客户端之间共享数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T23:04:59.340

试试 memcached：[http ://www.danga.com/memcached/](http://www.danga.com/memcached/)

# linux - 如何自动化 HTML 到 PDF 的转换？

> ID：176476
> 
> 赞同：48
> 
> 时间：2008-10-06T22:34:53.567
> 
> 标签：linux, perl, pdf

我使用 htmldoc 已经有一段时间了，但我遇到了一些相当严重的限制。我需要最终解决方案才能在 Linux 机器上工作。我将从 Perl 应用程序调用这个库/实用程序/应用程序，因此任何 Perl 接口都会是一个奖励。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2010-05-07T09:29:01.700

很抱歉发现了这篇旧帖子，但它首先出现在我寻找最佳 HTML/PDF 转换工具的过程中。在 Linux 上[wkhtmltopdf](http://wkhtmltopdf.org/)非常好（考虑到 CSS 等）和 GPL。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-04-28T20:24:30.133

[WeasyPrint 可](http://weasyprint.org/)生成带有可选文本和超链接的精美 PDF。

```
weasyprint input.html output.pdf 
```

如果您`wkhtmltopdf`改用，请尝试以下选项：

```
wkhtmltopdf --margin-bottom 20mm --margin-top 20mm --minimum-font-size 16 ... 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2017-08-14T09:20:51.893

**2019-05 更新**

谢天谢地，TheCodingMachine 将整个过程打包到了一个 docker 镜像中：[https ://github.com/thecodingmachine/gotenberg](https://github.com/thecodingmachine/gotenberg)

这使得在生产环境中维护和使用基于 chrome 的 pdf 生成非常顺畅且无忧。

* * *

自 Chrome 59 以来出现了一种新的无头模式。由于所有其他解决方案都在为 flexbox 等更新（或不再那么新）的 CSS 功能而苦苦挣扎，在我的情况下，这是生成正确 PDF 输出的唯一解决方案。

要从本地 html 文件创建 pdf，只需使用以下命令： `chrome --headless --disable-gpu --print-to-pdf file:///path/to/myfile.html`.

对于 Mac OS `chrome`，用`/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome`.

到目前为止，我注意到的唯一缺点是（当前）您无法通过标准输入传递 html，但创建临时文件并不是什么大问题。

有关更多信息，请参阅[https://developers.google.com/web/updates/2017/04/headless-chrome#create_a_pdf_dom](https://developers.google.com/web/updates/2017/04/headless-chrome#create_a_pdf_dom)

更新：事实证明，chrome 家伙很可能会为此任务提供某种节点模块，这最终会弃用无头模式（[https://bugs.chromium.org/p/chromium/issues/detail?id =719921](https://bugs.chromium.org/p/chromium/issues/detail?id=719921) )。

最好的办法是使用基于节点的方法，使用[https://developers.google.com/web/updates/2017/04/headless-chrome#node](https://developers.google.com/web/updates/2017/04/headless-chrome#node)下记录的 puppeteer 模块，并通过 Page.printToPDF 打印页面命令，它也启用了一些额外的配置。

当然，您也可以从节点以外的任何其他环境（即 PHP 脚本）连接到调试控制台 websocket。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-07T01:54:16.393

注意：这个答案来自 2008 年，现在可能不正确；请检查其他答案

[PrinceXML](http://www.princexml.com/)是我见过的最好的（它解析常规 HTML 以及 XML/XHTML）。怎么样是最好的？好吧，它通过了我认为非常令人印象深刻[的 acid2 测试](http://www.princexml.com/samples/acid2/)

然而，它相当昂贵

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-07T01:38:58.063

我为你做了一些谷歌搜索，并提出了两个选择。可能还有更多，我的google策略是尝试“webkit command-line pdf”和“gecko command-line pdf”，基本上是在寻找在命令行渲染器中嵌入两个流行的开源渲染引擎的命令行程序。这是我发现的：

[Firefox 命令行打印机](http://torisugari.googlepages.com/commandlineprint2)- 输出为 pdf 和 png

[wkpdf](http://wkpdf.plesslweb.ch/) - 虽然这适用于 mac，但它可能非常便携。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-06T22:40:36.630

我不会声称这是“最好的”解决方案，但它是我使用过的“一个”解决方案。

HTML 输入 --> [HTML 2 PS](http://user.it.uu.se/~jan/html2ps.html) --> [PS 2 PDF](http://pages.cs.wisc.edu/~ghost/doc/AFPL/6.50/Ps2pdf.htm) --> PDF 输出

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T22:45:45.590

这完全是矫枉过正，但您可以下载并安装[mirth](http://www.mirthproject.org/)。它是一个消息路由引擎，但它具有将 html 转换为 pdf 的能力，因此您可以将其设置为在文件夹中提取 html 文件，转换为 pdf，然后将 pdf 放入同一文件夹或其他文件夹中。就像我说的，矫枉过正，有点学习曲线，但它是免费的，而且 java，所以如果你愿意，你可以在 linux 上运行它。您的 perl 应用程序所要做的就是将 html 放到一个文件中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-03-29T21:58:30.500

你应该看看[http://phantomjs.org/](http://phantomjs.org/)

转换可以通过一个小脚本[rasterize.js](https://github.com/ariya/phantomjs/blob/master/examples/rasterize.js)然后发出

```
phantomjs rasterize.js 'http://en.wikipedia.org/w/index.php?title=Jakarta&printable=yes' jakarta.pdf 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-18T22:02:10.150

我发现[Electroshot](https://github.com/mixu/electroshot)支持现代 CSS 功能，尤其是布局。这是在 wkhtmltopdf 在[不支持 CSS3 之类的东西](https://github.com/wkhtmltopdf/wkhtmltopdf/issues/2235)方面显示其年龄的挣扎之后。

来自 Electroshot 的功能描述：

> Electroshot 使用 Electron，它提供了 Chrome 的最新稳定版本（而不是几年前的版本）；这意味着页面呈现就像在浏览器中一样......

我已经能够使用 Bootstrap 4 来设计一个页面，然后使用 Electroshot 来呈现一个非常类似于 HTML/CSS 的 PDF。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-03-31T00:49:54.383

您可以安装免费的 Calibre，并使用它提供的`ebook-convert`命令行实用程序，将许多 html 文档转换为单个 epub 或 pdf。

[https://manual.calibre-ebook.com/generated/en/ebook-convert.html](https://manual.calibre-ebook.com/generated/en/ebook-convert.html)

想法来自[这里](https://ebooks.stackexchange.com/a/6285)

我没有使用它，但是[这个 npm 模块](https://github.com/sethvincent/ebook-convert)像我下面的 bash 脚本一样包装了这个过程，但可能更好;-)

对我来说，在我的 Mac 上，我使用以下 bash 脚本将本地 html 网站转换为 PDF：

## convert_html_to_pdf.sh

```
function show_help()
{
  ME=$(basename $0)
  IT=$(cat <<EOF

  Converts an html file to pdf, epub, mobi or more if you look!

  usage: input.html output.{pdf|epub|mobi}

  e.g. 

  $ME index.html output.pdf 

  Note: Requires Calibre be installed. more info here: https://ebooks.stackexchange.com/a/6285
EOF
  )
  echo "$IT"
  exit
}

if [ "$1" == "help" ]
then
  show_help
fi
if [ "$1" == "--help" ]
then
  show_help
fi

/Applications/calibre.app/Contents/MacOS/ebook-convert $1 $2 --max-levels=1 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-09T11:54:13.680

此处尚未回答的另一种解决方案是使用 API。

它们的优点是您可以将工作所需的资源外部化，并拥有实现最新功能的最新服务（无需更新代码或安装错误修复）。

例如，使用[PDFShift](https://pdfshift.io)，您可以在以下位置使用单个 POST 请求执行此操作：

> 发布[https://api.pdfshift.io/v2/convert/](https://api.pdfshift.io/v2/convert/)

并传递`"source"`（URL 或原始 HTML 代码），您将获得二进制 PDF。（免责声明：我在 PDFShift 工作）。

这是 Python 中的代码示例：

```
import requests

response = requests.post(
    'https://api.pdfshift.io/v2/convert/',
    auth=('user_api_key', ''),
    json={"source": "https://en.wikipedia.org/wiki/PDF", "landscape": False, "use_print": False}
)

response.raise_for_status()

with open('wikipedia.pdf', 'wb') as f:
    f.write(response.content) 
```

您的 PDF 将位于 ./wikipedia.pdf

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-07T22:31:04.367

这是一个很好的易于安装的无头 Chrome 版本：

[https://www.npmjs.com/package/chrome-headless-render-pdf](https://www.npmjs.com/package/chrome-headless-render-pdf)

与“标准”无头 chrome 不同，它不会显示烦人的自动生成的页眉和页脚！

或者有`unoconv`（在幕后使用 LibreOffice）可以从 html 制作 pdf：

`unoconv -f pdf mypage.html`

您可以通过包管理器将它安装在大多数 Linux 风格上，例如`apt-get install unoconv`

这对于简单的文件来说既好又容易。如果您需要支持 css 的 javascript，请使用无头 Chrome。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-23T02:41:30.730

我已经开始整合一个[工具](https://github.com/lancejpollard/act)来为常见操作提供简化的界面。

您可以像这样将 HTML 转换为 PDF：

```
$ npm install @lancejpollard/act -g
$ act convert tmp/index.html -o tmp/index.pdf -w 2000px -h 3000px 
```

这将为 HTML 文件创建一个新的 PDF。

如果不出意外，请查看源代码并了解如何编写自己的脚本以在 JavaScript 中执行此操作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-27T07:31:58.043

wkhtmltopdf 和 wkhtmltoimage 是开源 (LGPLv3) 命令行工具，用于使用 Qt WebKit 渲染引擎将 HTML 渲染为 PDF 和各种图像格式。这些完全“无头”运行，不需要显示或显示服务。

**如何使用它？**

1.  下载预编译的二进制文件或从源代码构建 [https://wkhtmltopdf.org/downloads.html](https://wkhtmltopdf.org/downloads.html)

    [https://github.com/wkhtmltopdf/wkhtmltopdf](https://github.com/wkhtmltopdf/wkhtmltopdf)

2.  创建要转换为 PDF（或图像）的 HTML 文档

3.  通过该工具运行您的 HTML 文档。

用法：wkhtmltopdf input.html output_name.pdf

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-04-10T13:25:20.173

[使用Calibre](https://calibre-ebook.com/)`ebook-convert`附带的命令行工具时，我经常得到很好的结果。

```
ebook-convert <input.html> <output.pdf> 
```

检查[手册](https://manual.calibre-ebook.com/generated/en/ebook-convert.html)中的众多调整选项。例如，可以根据`H1`/ `H2`/... 标题（或基本上使用 XPath 表达式的任何内容）自动生成目录。

请注意：Calibre 专注于数字文档，我不知道`ebook-convert`对于非常复杂的 HTML 效果如何。不过值得一试。:-)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2014-03-04T17:30:48.317

您可能想查看 Peernet 的“文档转换服务”（位于[http://www.peernet.com/conversion-software/batch-document-converter/](http://www.peernet.com/conversion-software/batch-document-converter/)）。这在 Windows 桌面或 Windows Server 计算机上作为服务运行。它在 Web 浏览器中打开 HTML 文档，然后通过打印驱动程序打印它们以创建 PDF 文档，这样生成的 PDF 文档看起来就像您从浏览器打印的 HTML 文档一样。

# php - 在 PHP 中创建 PNG（它与 gif 和 jpg 不同吗？）

> ID：176479
> 
> 赞同：0
> 
> 时间：2008-10-06T22:35:34.313
> 
> 标签：php, image, png, jpeg, gif

我有一个图像上传表单，它应该采用图像类型（PNG、JPEG、GIF），调整它的大小，然后将其保存到路径中。

出于某种原因，我无法让 PNG 文件类型工作，它适用于 JPEG/GIF 并且文件被复制，所以看起来这与我创建 PNG 的方式有关。

在 PHP 中创建 PNG 是否需要不同的参数或选项？一些创建图像的示例代码：

```
$src = imagecreatefrompng($uploadedfile);
imagecreatetruecolor($newWidth,$newHeight)
imagecopyresampled($tmp,$src,0,0,0,0,$newWidth,$newHeight,$width,$height);
imagepng($tmp,$destinationPath."/".$destinationFile,100); 
```

相同的命令适用于 JPG 和 GIF。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T22:47:29.017

您需要查看您的 PHP 是如何构建的。例如：

```
GD Support  enabled
GD Version  bundled (2.0.28 compatible) 
PNG Support     enabled 
```

如果您没有编译 PNG 支持，则需要对其进行更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T23:14:44.050

我发现了问题，只是我没有阅读 API 的问题：P。

与`imagejpg()`or不同`imagegif()`，`imagepng()`接受 0-9 的整数进行压缩。所以我将 100 作为参数传递，认为质量会更高，但我想我将其视为最大压缩。通过 0 解决了这个问题。

也许 API 已经从 PHP 版本改变了？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T22:54:54.243

您是从 PNG-8 图像开始的吗？在使用 PHP 时，PNG-8 与 PNG-24 存在一些问题。确保编译了 PNG 支持，然后[看看这个人对 PNG-8 问题的解决方案](http://www.php.net/manual/en/function.imagecreatefrompng.php#71091)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T22:57:03.570

检查，我有PNG支持：

'GIF 读取支持' => boolean true 'GIF 创建支持' => boolean true 'JPG 支持' => boolean true 'PNG 支持' => boolean true

不过谢谢你的回复……以为就这样了

# asp.net - asp.net：同步开发环境

> ID：176504
> 
> 赞同：2
> 
> 时间：2008-10-06T22:43:59.867
> 
> 标签：asp.net, .net, visual-studio

新的视觉工作室和一般编程。

我开始从事 asp.net 项目。在家里，我有一台运行 Windows 2008 Server 并运行 SQL 2008 和 Visual 2008 的计算机。

我想在我的笔记本电脑 win2008/sql2008/vs2008 上安装相同的东西，这样我就可以随身携带。

我想知道的是我将如何同步这两者，项目将同步到我的笔记本电脑，我可以随身携带，然后当我返回并将其连接到我的网络时，它会同步回我的主工作站，所以这两个总是一样的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T22:52:01.520

听起来您想使用[修订控制软件](http://en.wikipedia.org/wiki/Revision_control)。

如果不是这种情况（您不想每次从一台机器更改为另一台机器时都签入更改），您可能可以使用[rsync](http://en.wikipedia.org/wiki/Rsync)编写脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T22:59:50.007

您需要一个[版本控制系统](http://en.wikipedia.org/wiki/Revision_control)(VCS) 或专用的文件同步解决方案，例如[“unison”](http://www.cis.upenn.edu/~bcpierce/unison/)。

如今，版本控制系统有两种类型：分布式或非分布式。在分布式 VCS 中，存储库（项目）的每个副本都是平等的，可以在没有网络访问的情况下进行工作，可以用作生成新工作副本的源等。示例：darcs、git、mercurial、bazaar。

非分布式（经典）VCS 假设您将设置某种版本控制系统并通过网络从您的每个工作场所连接到它。示例：CVS、SVN、Visual SourceSafe。

我会坚持使用分布式版本控制系统（mercurial？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T22:48:25.007

将项目文件直接保存到拇指驱动器怎么样？

要么，要么您设置一个批处理文件，以便在每次会话之前和之后将文件复制到拇指驱动器或从拇指驱动器复制它们。这更麻烦，但更安全*otoh*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T22:53:25.713

听起来你需要一个源代码控制系统。该解决方案通常用于在一组开发人员之间同步代码库，但该范例仍然适用于多个工作站上的单个开发人员。

事实上的开源 RCS 是[Subversion (SVN)](http://subversion.tigris.org/)

另请参阅： [维基百科 - 修订控制](http://en.wikipedia.org/wiki/Revision_control)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T23:00:34.500

就个人而言，我可能会在某个地方使用 SVN 存储库……但是，还有一个选择：将 VM 保留在便携式 HDD（USB 等）上，并将整个开发操作系统视为便携式。

请注意，VM 或 U 盘不会取代版本控制；这不仅仅是确保您拥有它的副本...由于您说您是一般编程新手，我会自愿提出建议：获取[VisualSVN 服务器](http://www.visualsvn.com/server/)和[Tortoise SVN](http://tortoisesvn.tigris.org/)（客户端）；在 Windows 上工作都是免费且微不足道的 - 非常“下一个好”。其他版本控制系统是可用的，但这些都易于使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T01:06:32.700

关于 VCS 的建议；如果您打算在较短的迭代中构建并期望代码在一天结束时不会完全稳定，那么您应该确保使用中央或分布式系统中的分支功能来确保不要用不必要的垃圾污染行李箱。这样，您就可以经常致力于内心的满足，而不会破坏核心。在 Subversion 中，这确实会带来丢失清晰历史记录的惩罚，但它仍然会存在，尽管不是在主干中而是在分支中。一些分布式系统可以更好地处理这个问题。Jeff Atwood 对此有一篇很好的[文章](http://www.codinghorror.com/blog/archives/001165.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T01:23:04.633

如果您要在两个站点中拥有完全相同的项目文件夹，您可以使用 Windows 的“robocopy”命令将一个文件夹中的更改同步到另一个文件夹。

使用该命令创建一个批处理 (.bat) 文件，然后您只需双击它即可使其同步。该命令识别网络路径，因此您可以使用“ `\\my_workstation\path\to\project`”作为目标文件夹。以下命令会将源文件夹中的`/MIR`所有文件和子文件夹 ( `/E`) 镜像 ( ) 到目标文件夹中。

```
robocopy "source_folder" "destination_folder" /E /MIR 
```

除了同步您的文件夹之外，拥有一个版本控制系统也是一个好主意。如果你搞砸了，它允许你回到你的代码的工作状态。阅读其他答案以了解更多信息。我个人喜欢 SVN，因为我发现它非常简单直接（点击[此](https://stackoverflow.com/questions/176504/synchronized-development-environments#176558)答案上的链接）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T01:28:23.263

我喜欢 Microsoft 的 Team Foundation Server 的 shelvset 功能。我让一个人能够将他们正在处理的代码放入修订控制系统，而无需创建变更集（或 SVN 术语，修订）。一个人去他们的另一台机器并取消搁置搁置集。

更大的问题是同步应用程序背后的数据库。这要求创建和更新数据库所需的所有脚本都必须是项目的一部分。您还需要生成测试数据的脚本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-07T01:43:13.860

查看[www.mesh.com](https://www.mesh.com/Welcome/Welcome.aspx) 在许多设备中同步文件的另一种新的简单方法。

安装 Windows Live Mesh 并将您的项目文件夹设置为 Mesh 文件夹，它会自动同步到您添加的设备。我在过去的 1 个月里一直在这样做，而且效果很好。我可以继续工作我所有的 3 台机器而无需任何额外的复制/粘贴 请注意，实时网格的范围远远超出了此功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T05:08:53.617

如果您不想采用源代码控制系统（因为仍然很难同步您的数据库和虚拟目录），您可以随时设置**虚拟机**并在其上进行开发。当您在计算机之间移动时，您可以将虚拟硬盘驱动器从一台计算机复制到另一台计算机。

想法的问题可能是：

*   使用 VS2008、SQL2008 和 Win2008，您的虚拟硬盘驱动器可能会大一些，并且需要一些时间在 PC 之间复制
*   由于您正在运行虚拟 PC，因此您的环境也可能会稍微慢一些，但是如果您为其提供足够的资源并杀死所有在后台运行的进程，您应该没问题。

这个解决方案的一个很好的好处是，您现在可以在家用 PC 上运行 Vista，在笔记本电脑上运行 XP，并且仍然可以在 Win2008 环境中进行开发。（如果你想）。

# database - 当您将数据库记录和数据集抽象为对象时，您的对象模型是什么样的？

> ID：176507
> 
> 赞同：2
> 
> 时间：2008-10-06T22:44:38.273
> 
> 标签：database, design-patterns, oop, dataset, records

我问你们所有没有为此使用库但正在构建自己的对象来管理流入和流出数据库表的数据的人。我有记录集对象吗？每行数据一个对象？两个都？两者都不？欢迎任何建议或经验。请不要告诉我使用 ORM 或其他此类工具包。这对我的项目来说太过分了，此外，这不是现在的问题，是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T22:56:43.040

我强烈建议学习[martin fowler](http://martinfowler.com/)的[企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)，它描述了许多有助于了解的数据库模式，并让您了解模式的演变以完全使用 ORM 库。

您可能感兴趣的特定模式：

*   [记录集](http://martinfowler.com/eaaCatalog/recordSet.html)
*   [行数据网关](http://martinfowler.com/eaaCatalog/rowDataGateway.html)
*   [表数据网关](http://martinfowler.com/eaaCatalog/tableDataGateway.html)

这些基本模式将让您了解如何构建对象，而更高级的模式（如活动记录/数据映射器）您将看到这些模式如何与您目前需要的问题域相关联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T01:09:23.677

您的数据模型由领域实体（现实世界的事物）主导。现实世界的事物有时可以映射到数据库中的单行。一个实体是一个对象是一个关系行——主要是。

有时，现实世界的实体非常复杂并且跨越多个数据库行。这就是“聚合”问题。对象可以是聚合。在不破坏所有正常形式规则的情况下，关系行不能轻易地聚合。

有时，由于类继承，您会不知道如何将对象映射到数据库行。继承层次结构的每一层是一行吗？还是所有的层都扁平化为每个子类表中的列？

此外，您需要拥有事物的集合（数据库是事物集合的集合）。

这些“集合”或“记录集”或“管理器”或“数据访问对象”在持久性（SQL？）和您的域实体之间进行调解。记录集从它有权访问的任何 SQL 内容构建您的域对象。同样，记录集将您的域对象展开为 SQL 内容。

ORM 是处理这个问题的一种方法；ORM 框架提供了这些类定义。如果 ORM “矫枉过正”，请借用设计模式。阅读 iBatis API。[当您使用它时，您可能会发现对于 ORM 来说没有什么太小了。]

简而言之，两者都是：“记录集对象”加上“每行数据一个对象”——大约。

如果您觉得需要滚动您自己的记录集集合，您可以尝试使用简单的序列化来持久化您的对象。您将在尝试序列化聚合和子类关系的复杂性之上堆积复杂性。为什么？对象之间有直接的引用。SQL 数据库必须使用主键和外键来模拟这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T22:47:59.063

无论您的项目有多大，我都会说使用 ORM :-P

但.....

回到没有 ORM 库的时代，我们使用手动将所有字段从 Java 记录集对象中提取出来并将它们插入到真正的 Java 类中。

反向应用于插入和删除（带有一个标志来指示要发生的事情）

多行通常填充到一个列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T00:02:36.260

这将取决于您是希望数据库设计驱动对象设计，还是您的域模型驱动数据库设计。

在第一个场景中，您为每个表创建一个类。您很快就会发现，有时您需要一个连接两个表的对象，因此您必须有一个场景来处理该异常。

在第二种情况下，您需要创建对象的标识映射，并以某种方式将类的关系映射回表。在这种情况下，将存在您没有对象与表的一对一关系的情况。

我知道您不想要一个工具的处方，但[SubSonic](http://www.codeplex.com/subsonic)是一个非常简单、稳定的工具包，可以帮助您从数据库结构生成代码，并且非常适合每个表有一个类的场景。您可以在半小时内安装并开始生成代码。值得一看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T23:46:39.193

要管理流入和流出数据库的实际数据（没有 ORM），您应该查看 Jakarta Commons DbUtils。

它提供了非常轻量级的帮助程序来运行查询和更新，例如自动将 ResultSets 转换为 bean 列表等。

# c - 单元测试错误条件 - EINTR

> ID：176512
> 
> 赞同：7
> 
> 时间：2008-10-06T22:47:09.550
> 
> 标签：c, unit-testing, errno, eintr

简而言之，您如何在系统调用中对错误条件（例如 EINTR）进行单元测试。

我正在研究的一个特定示例（可能本身就是一个案例）是，当 fclose 返回带有 (errno==EINTR) 的 EOF 时，是否有必要再次调用 fclose。该行为取决于 fclose 的实现：

```
// Given an open FILE *fp
while (fclose(fp)==EOF && errno==EINTR) {
    errno = 0;
} 
```

如果在 EINTR 发生时释放 fp，则此调用可能是不安全的。如何测试 when (errno==EINTR) 的错误处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T00:27:08.257

在这种特殊情况下，再次调用 fclose() 是不安全的，因为 C 标准表示即使调用失败，流也会与文件解除关联（并且变得不确定）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T00:21:02.917

使用函数指针结构来抽象出系统函数。用类似 sys->fclose(fp) 的方式替换对 flcose(fp) 的调用。在您的单元测试中，创建一个始终返回 EINTR 的 fclose 实现，然后将 sys->fclose 设置为该版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T00:38:03.973

查看 linux 内核源代码，我找不到任何在文件关闭时甚至返回 EINTR 的驱动程序。

如果您 absosmurfly 必须重现这种情况，您可以在 Linux 中编写自己的驱动程序以在 .release 方法上返回 -EINTR。查看 O'Reilly 的 Linux 设备驱动程序书中的[示例代码](http://examples.oreilly.com/linuxdrive3/examples.tar.gz)。scull 项目是最简单的项目之一。你可以把它改成这样：

```
int scull_release(struct inode *inode, struct file *filp)
{
    return -EINTR;
} 
```

不过，再次通过 linux 源代码树搜索，我找不到任何会在关闭时返回 EINTR 的驱动程序。

**编辑**- 好的，它看起来像保险丝 - 用户空间文件系统可能能够。这用于 sshfs 之类的东西。虽然仍然是一个边缘案例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T00:06:53.320

我认为没有一种简单的方法可以随意进行实际测试。

如果 fclose 操作被信号中断，则将生成 EINTR。这意味着 fclose 位于后台线程中，该线程在处理关闭请求时接收到信号。

祝你好运，试图重现这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T02:20:38.900

`fclose()`正如 Kris 建议的那样，用您在单元测试代码中定义的自己的实现暂时替换对“真实”的调用。您的实现可以做一些简单的事情：

```
int my_fclose(FILE *fp)
{
  errno = EINTR;
  return EOF;
} 
```

但是，正如 fizzer 指出的那样，`fclose()`由于行为未定义，您不应该再次调用，因此您甚至不必费心检查条件。

另一个要问的问题是你是否真的需要担心这个；如果您的应用程序代码在您的期间阻止所有可能的信号（SIGKILL 和 SIGSTOP 除外），`fclose()`那么您将不会得到 EINTR，并且根本不需要担心。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T13:47:01.677

这是我将如何测试它，只是为了测试，因为 fizzer 提醒我们调用`fclose()`两次是不安全的。

可以*用自己的行为在程序中***重新定义** `fclose()`（或 libc 的任何其他函数）。在类 Unix 系统上，链接器不会抱怨 - 从未在 Windows 上尝试过，但在 cygwin 上尝试过。当然，这会阻止您的其他测试使用 real ，因此必须将此类测试放入单独的测试可执行文件中。*`fclose()`*

 *这是[minunit](http://www.jera.com/techinfo/jtns/jtn002.html)的多合一示例。

```
#include <errno.h>
#include <stdio.h>
#include <stdbool.h>

/* from minunit.h : http://www.jera.com/techinfo/jtns/jtn002.html */
 #define mu_assert(message, test) do { if (!(test)) return message; } while (0)
 #define mu_run_test(test) do { char *message = test(); tests_run++; \
                                if (message) return message; } while (0)

int tests_run = 0;
bool fclose_shall_fail_on_EINTR = false;

//--- our implemention of fclose()
int fclose(FILE *fp) {
    if (fclose_shall_fail_on_EINTR) {
        errno = EINTR;
        fclose_shall_fail_on_EINTR = false;   //--- reset for next call 
        return EOF;
    } else { return 0; }
}

//--- this is the "production" function to be tested 
void uninterruptible_close(FILE *fp) {
    // Given an open FILE *fp
     while (fclose(fp)==EOF && errno==EINTR) {
        errno = 0;
     }
}

char *test_non_interrupted_fclose(void) {
    FILE *theHandle = NULL;   //--- don't care here
    uninterruptible_close(theHandle);
    mu_assert("test fclose wo/ interruption", 0 == errno);
    return 0;
}

char *test_interrupted_fclose(void) {
    FILE *theHandle = NULL;   //--- don't care here
    fclose_shall_fail_on_EINTR = true;

    uninterruptible_close(theHandle);
    mu_assert("test fclose wo/ interruption", 0 == errno);
    return 0;
}

char *test_suite(void)
{
    mu_run_test(test_non_interrupted_fclose);
    mu_run_test(test_interrupted_fclose);
    return 0;
}

int main(int ac, char **av)
{
  char *result = test_suite();

  printf("number of tests run: %d\n", tests_run);
  if (result) { printf("FAIL: %s\n", result); } 

  return 0 != result;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-26T00:47:38.320

我认为同时处理信号和确认错误条件可能存在问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-02T01:02:36.557

嗯，我认为你们都忽略了一些非常重要的事情。

fclose() 不能返回 EINTR。fopen()、fwrite()、fread() 或任何标准 CI/O 函数也不能。

只有当您涉足诸如 open(2)、write(2) 和 select(2) 之类的低级 I/O 调用时，您才需要处理 EINTR。

阅读 [有趣的] 手册页

# sql-server - SQL Server 中的 char、nchar、varchar 和 nvarchar 有什么区别？

> ID：176514
> 
> 赞同：672
> 
> 时间：2008-10-06T22:47:33.480
> 
> 标签：sql-server, varchar

是什么意思`nvarchar`？

SQL Server 中的`char`、`nchar`、`varchar`和有什么区别？`nvarchar`

* * *

## 回答 #1

> 赞同：929
> 
> 时间：2008-10-06T23:02:33.887

只是为了澄清......或总结......

*   **`nchar`**并且**`nvarchar`**可以存储**Unicode**字符。
*   **`char`**并且**不能存储 Unicode**字符。**`varchar`**
***   **`char`**并且**`nchar`**是**固定长度**的，即使您没有用完所有空间，也会为您指定的字符数**保留存储空间。***   **`varchar`**并且**`nvarchar`**是**可变长度**的，只会用完您存储的字符的空格。它**不会像`char`或`nchar`**那样保留存储空间。**

 **`nchar`并且`nvarchar`将占用两倍的存储空间，因此仅在需要*Unicode*支持时才使用它们可能是明智之举。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2011-11-23T23:37:48.643

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-10-06T22:51:40.553

nchar 和 char 的运行方式几乎完全相同，nvarchar 和 varchar 也是如此。它们之间的唯一区别是 nchar/nvarchar 存储 Unicode 字符（如果您需要使用扩展字符集则必不可少），而 varchar 不存储。

因为 Unicode 字符需要更多存储空间，所以 nchar/nvarchar 字段占用两倍的空间（例如，在 SQL Server 的早期版本中，nvarchar 字段的最大大小为 4000）。

这个问题是这个问题的[副本](https://stackoverflow.com/questions/144283/what-is-the-difference-between-varchar-and-nvarchar)。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2011-07-21T05:34:35.867

只是为了添加更多内容： **nchar** - 在数据中添加尾随空格。 **nvarchar** - 不向数据添加尾随空格。

因此，如果您要通过“nchar”字段过滤数据集，您可能需要使用 RTRIM 删除空格。例如，名为 BRAND 的 nchar(10) 字段存储单词 NIKE。它在单词的右侧添加了 6 个空格。因此，过滤时，表达式应为： **RTRIM(Fields!BRAND.Value) = "NIKE"**

希望这对那里的人有所帮助，因为我刚刚挣扎了一会儿！

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2013-06-27T05:41:02.833

My attempt to summarize and correct the existing answers:

First, `char` and `nchar` will always use a fixed amount of storage space, even when the string to be stored is smaller than the available space, whereas `varchar` and `nvarchar` will use only as much storage space as is needed to store that string (plus two bytes of overhead, presumably to store the string length). So remember, "var" means "variable", as in variable space.

The second major point to understand is that, `nchar` and `nvarchar` store strings using *exactly* two bytes per character, whereas `char` and `varchar` use an encoding determined by the collation code page, which will *usually* be exactly one byte per character (though there are exceptions, see below). By using two bytes per character, a very wide range of characters can be stored, so the basic thing to remember here is that `nchar` and `nvarchar` tend to be a much better choice when you want internationalization support, which you probably do.

Now for some some finer points.

First, `nchar` and `nvarchar` columns *always* store data using UCS-2\. This means that exactly two bytes per character will be used, and any Unicode character in the Basic Multilingual Plane (BMP) can be stored by an `nchar` or `nvarchar` field. However, it is not the case that *any* Unicode character can be stored. For example, according to Wikipedia, the code points for Egyptian hieroglyphs fall outside of the BMP. There are, therefore, Unicode strings that can be represented in UTF-8 and other true Unicode encodings that cannot be stored in a SQL Server `nchar` or `nvarchar` field, and strings written in Egyptian hieroglyphs would be among them. Fortunately your users probably don't write in that script, but it's something to keep in mind!

Another confusing but interesting point that other posters have highlighted is that `char` and `varchar` fields may use two bytes per character for certain characters if the collation code page requires it. (Martin Smith gives an excellent example in which he shows how Chinese_Traditional_Stroke_Order_100_CS_AS_KS_WS exhibits this behavior. Check it out.)

**UPDATE:** As of SQL Server 2012, there are finally [code pages for UTF-16](http://msdn.microsoft.com/en-us/library/ms143726.aspx#Supplementary_Characters), for example Latin1_General_100_CI_AS_SC, which can truly cover the entire Unicode range.

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-11-02T09:35:40.443

*   `char`：定长字符数据，最大长度为 8000 个字符。
*   `nchar`: 固定长度的 unicode 数据，最大长度为 4000 个字符。
*   `Char`= 8 位长度
*   `NChar`= 16 位长度

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-02-10T14:17:50.043

**`nchar[(n)]`** (national character)

*   Fixed-length **Unicode** string data.
*   `n` defines the string length and must be a value from 1 through 4,000.
*   The storage size is two times `n` bytes.

* * *

**`nvarchar [(n | max)]`** (national character varying.)

*   Variable-length **Unicode** string data.
*   `n` defines the string length and can be a value from 1 through 4,000.
*   `max` indicates that the maximum storage size is 2^31-1 bytes (2 GB).
*   The storage size, in bytes, is two times the actual length of data entered + 2 bytes

* * *

**`char [(n)]`** (character)

*   Fixed-length, `non-Unicode` string data.
*   `n` defines the string length and must be a value from 1 through 8,000.
*   The storage size is `n` bytes.

* * *

**`varchar [(n | max)]`** (character varying)

*   Variable-length, **non-Unicode** string data.
*   `n` defines the string length and can be a value from 1 through 8,000.
*   `max` indicates that the maximum storage size is 2^31-1 bytes (2 GB).
*   The storage size is the actual length of the data entered + 2 bytes.

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-10-06T22:53:07.883

nchar(10) 是长度为 10 的固定长度 Unicode 字符串。nvarchar(10) 是最大长度为 10 的可变长度 Unicode 字符串。通常，如果所有数据值都是 10 个字符，则使用前者，后者如果长度不同。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-11-18T11:04:45.893

nchar 需要**比**nvarchar 更多的空间。

**例如，**

一个 nchar(100) 将始终存储 100 个字符，即使您只输入 5，剩余的 95 个字符将用空格填充。在 nvarchar(100) 中存储 5 个字符将节省 5 个字符。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-11-02T10:33:36.410

[区别](http://msdn.microsoft.com/en-us/library/ms186939.aspx)在于：

1.  n[var]char 存储 unicode，而 [var]char 仅存储单字节字符。
2.  [n]char 需要精确长度的固定数量的字符，而 [n]varchar 接受不超过定义长度的可变数量的字符。

另一个区别是长度。nchar 和 nvarchar 都可以长达 4,000 个字符。char 和 varchar 最长可达 8000 个字符。但是对于 SQL Server，您还可以使用 [n]varchar(max) 最多可以处理 2,147,483,648 个字符。（2 GB，带符号的 4 字节整数。）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-06T22:59:43.953

*   nchar 是固定长度的，可以保存 unicode 字符。它每个字符使用两个字节存储。

*   varchar 是可变长度的，不能保存 unicode 字符。它每个字符使用一个字节存储。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-06T22:53:14.980

**NVARCHAR**可以存储 Unicode 字符，每个字符占用 2 个字节。

# java - 如何枚举包中的所有类并将它们添加到列表中？

> ID：176527
> 
> 赞同：32
> 
> 时间：2008-10-06T22:52:23.003
> 
> 标签：java

我需要枚举一个包中的所有类并将它们添加到一个列表中。单个类的非动态版本如下所示：

```
List allClasses = new ArrayList();
allClasses.add(String.class); 
```

如何动态地添加包中的所有类及其所有子包？

* * *

***更新：***阅读了早期的答案后，我确实在尝试解决另一个次要问题，所以让我说明一下。我知道这是可能的，因为其他工具可以做到。[在此处](https://stackoverflow.com/questions/176913/how-can-i-run-all-unit-tests-except-those-ending-in-integrationtest-in-my-intel)查看新问题。

***更新：***再读一遍，我可以看到它是如何被误读的。我希望在编译后从文件系统中枚举所有 MY PROJECT 的类。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2010-08-20T00:48:26.537

****更新 1 (2012)****

好的，我终于开始清理下面的代码片段了。我将它嵌入到它自己的 github 项目中，甚至添加了测试。

[https://github.com/ddopson/java-class-enumerator](https://github.com/ddopson/java-class-enumerator)

****更新 2 (2016)****

如需更强大且功能更丰富的类路径扫描器，请参阅[https://github.com/classgraph/classgraph](https://github.com/classgraph/classgraph)。我建议首先阅读我的代码片段以获得更高层次的理解，然后将 lukehutch 的工具用于生产目的。

****原帖（2010）****

严格来说，不可能列出*package*中的类。这是因为包实际上只不过是一个命名空间（例如 com.epicapplications.foo.bar），并且类路径中的任何 jar 文件都可能将类添加到包中。更糟糕的是，类加载器会按需加载类，并且类路径的一部分可能位于网络连接的另一端。

可以解决更严格的问题。例如，JAR 文件中的所有类，或 JAR 文件在特定包中定义的所有类。无论如何，这是更常见的情况。

不幸的是，没有任何框架代码可以使这项任务变得简单。您必须以类似于 ClassLoader 查找类定义的方式扫描文件系统。

网络上有很多关于普通目录中类文件的示例。如今，我们大多数人都使用 JAR 文件。

要使用 JAR 文件，请尝试以下操作...

```
private static ArrayList<Class<?>> getClassesForPackage(Package pkg) {
    String pkgname = pkg.getName();
    ArrayList<Class<?>> classes = new ArrayList<Class<?>>();
    // Get a File object for the package
    File directory = null;
    String fullPath;
    String relPath = pkgname.replace('.', '/');
    System.out.println("ClassDiscovery: Package: " + pkgname + " becomes Path:" + relPath);
    URL resource = ClassLoader.getSystemClassLoader().getResource(relPath);
    System.out.println("ClassDiscovery: Resource = " + resource);
    if (resource == null) {
        throw new RuntimeException("No resource for " + relPath);
    }
    fullPath = resource.getFile();
    System.out.println("ClassDiscovery: FullPath = " + resource);

    try {
        directory = new File(resource.toURI());
    } catch (URISyntaxException e) {
        throw new RuntimeException(pkgname + " (" + resource + ") does not appear to be a valid URL / URI.  Strange, since we got it from the system...", e);
    } catch (IllegalArgumentException e) {
        directory = null;
    }
    System.out.println("ClassDiscovery: Directory = " + directory);

    if (directory != null && directory.exists()) {
        // Get the list of the files contained in the package
        String[] files = directory.list();
        for (int i = 0; i < files.length; i++) {
            // we are only interested in .class files
            if (files[i].endsWith(".class")) {
                // removes the .class extension
                String className = pkgname + '.' + files[i].substring(0, files[i].length() - 6);
                System.out.println("ClassDiscovery: className = " + className);
                try {
                    classes.add(Class.forName(className));
                } 
                catch (ClassNotFoundException e) {
                    throw new RuntimeException("ClassNotFoundException loading " + className);
                }
            }
        }
    }
    else {
        try {
            String jarPath = fullPath.replaceFirst("[.]jar[!].*", ".jar").replaceFirst("file:", "");
            JarFile jarFile = new JarFile(jarPath);         
            Enumeration<JarEntry> entries = jarFile.entries();
            while(entries.hasMoreElements()) {
                JarEntry entry = entries.nextElement();
                String entryName = entry.getName();
                if(entryName.startsWith(relPath) && entryName.length() > (relPath.length() + "/".length())) {
                    System.out.println("ClassDiscovery: JarEntry: " + entryName);
                    String className = entryName.replace('/', '.').replace('\\', '.').replace(".class", "");
                    System.out.println("ClassDiscovery: className = " + className);
                    try {
                        classes.add(Class.forName(className));
                    } 
                    catch (ClassNotFoundException e) {
                        throw new RuntimeException("ClassNotFoundException loading " + className);
                    }
                }
            }
        } catch (IOException e) {
            throw new RuntimeException(pkgname + " (" + directory + ") does not appear to be a valid package", e);
        }
    }
    return classes;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-09-24T15:06:05.467

目前列出给定包中所有类的最强大的机制是[ClassGraph](https://github.com/classgraph/classgraph/wiki/Code-examples)，因为它处理[最广泛的类路径规范机制数组](https://github.com/classgraph/classgraph/wiki/Classpath-Specification-Mechanisms)，包括新的 JPMS 模块系统。（我是作者。）

```
List<String> classNames;
try (ScanResult scanResult = new ClassGraph().whitelistPackages("my.package")
        .enableClassInfo().scan()) {
    classNames = scanResult.getAllClasses().getNames();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T22:55:39.250

我想出了如何做到这一点。这是程序：

1.  从根包中的一个类开始，并从类加载器中获取它所在的文件夹
2.  递归枚举此文件夹中的所有 .class 文件
3.  将文件名转换为完全限定的类名
4.  使用 Class.forName() 获取类

这里有一些令人讨厌的技巧让我有点不安，但它确实有效 - 例如：

1.  使用字符串操作将路径名转换为包名
2.  对根包名称进行硬编码以启用剥离路径前缀

太糟糕了，stackoverflow 不允许我接受自己的答案......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T23:37:58.790

恐怕您将不得不手动扫描类路径和 java 搜索类的其他位置（例如，ext 目录或引导类路径）。由于 java 使用延迟加载类，它甚至可能不知道包中尚未加载的其他类。还要检查“密封”包装的概念。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T23:47:53.310

有趣的是，这个问题每隔一段时间就会出现一次。问题是这个关键字更适合命名为“命名空间”。Java 包在任何时候都没有描述一个包含包中所有类的具体容器。它只是定义了一个标记，类可以使用该标记来声明它们是该包的成员。您必须搜索整个类路径（如另一个答复所示）以确定包中的所有类。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-08-11T01:41:22.067

对此有一个警告：像 tomcat 和 JBoss 这样的 ApplicationEngines/servlet 容器**具有分层类加载**器。获取系统类加载器是不行的。

**Tomcat**的工作方式（事情可能已经改变，但我目前的经验并没有让我相信）但是每个应用程序上下文都有它自己的类加载器，因此应用程序 'foo' 的类不会与应用程序 'fooV2 的类冲突'

举个例子。如果所有的类都被整合到一个超级类上下文中，那么您将不知道您使用的是适合版本 1 还是版本 2 的类。

此外，每个人都需要访问系统类，如 java.lang.String。这就是层次结构。它首先检查本地应用程序上下文并将其向上移动（顺便说一句，这是我目前的情况）。

为了管理这个，更好的方法是：**this.getClass().getClassloader()**

在我的情况下，我有一个需要在某些模块上进行自我发现的 Web 服务，它们显然驻留在“这个”Web 服务上下文或系统上下文中。通过执行上述操作，我可以同时检查两者。通过仅获取系统类加载器，我无法访问任何应用程序类（因此我的资源为空）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T22:59:04.703

看看 java.net.URLClassLoader 在做什么。它从不枚举类，它只是在被要求时尝试查找类。如果要枚举类，则需要获取类路径，将其拆分为目录和 jar 文件。扫描目录（及其子目录）和 jar 文件以查找名称为 *.class 的文件。

可能值得查看似乎可以进行您想要的枚举的开源项目（如[Eclipse](http://www.eclipse.org/)）以获得灵感。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-04T22:17:58.050

如果您只是想加载一组相关的类，那么 Spring 可以帮助您。

Spring 可以在一行代码中实例化实现给定接口的所有类的列表或映射。列表或映射将包含实现该接口的所有类的实例。

话虽这么说，作为从文件系统中加载类列表的替代方法，只需在要加载的所有类中实现相同的接口，而不考虑包。这样，您可以加载（和实例化）所有您想要的类，而不管它们在什么包中。

另一方面，如果您想要将它们全部放在一个包中，那么只需让该包中的所有类都实现给定的接口。

# javascript - 是否有与 MooTools 的 Element() 构造函数等效的 jQuery？

> ID：176545
> 
> 赞同：3
> 
> 时间：2008-10-06T22:57:25.283
> 
> 标签：javascript, jquery, mootools

我将为我的网站启动一个 javascript 报告引擎，并开始使用 MooTools 进行一些原型设计。我真的很喜欢能够做这样的事情：

```
function showLeagues(leagues) {
    var leagueList = $("leagues");
    leagueList.empty();
    for(var i = 0; i<leagues.length; ++i) {
        var listItem = getLeagueListElement(leagues[i]);
        leagueList.adopt(listItem);
    }
}

function getLeagueListElement(league) {
    var listItem = new Element('li');
    var newElement = new Element('a', {
        'html': league.name,
        'href': '?league='+league.key,
        'events': {
                'click': function() { showLeague(league); return false; }
        }
    });
    listItem.adopt(newElement);
    return listItem;
} 
```

据我所知，jQuery 的“采用”类型方法只接受 html 字符串或 DOM 元素。是否有任何 jQuery 等效于 MooTools 的[Element](http://mootools.net/docs/Element/Element#Element:constructor)？

* * *

编辑：我在这里寻找的最重要的事情是我的点击事件到链接的程序化附件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T23:59:39.950

从语法上讲，使用 jQuery 可能会更好，但使用起来可能更有效

```
 document.createElement('li') 
```

并且至少消除了对字符串比较测试和次要标记解析的需要。

如果您坚持生成大量 dom 节点，[flydom也可能会引起您的兴趣。](http://flydom.socianet.com/)（理论上应该更快，但没有测试过）

* * *

注意：在内部，jQuery("<html></html>") 看起来有效地做到了这一点（过于简单化）：

```
jQuery(matcher) --> function(matcher)
{
   return jQuery.fn.init(matcher) --> function(matcher)
   {
      return  this.setArray(
        jQuery.makeArray(
           jQuery.clean(matcher) --> function(matcher)
           { 
               div = document.createElement('div');
               div.innerHTML = matcher;
               return div.childNodes;
           }
        )
      );
   }
} 
```

所以有人会假设“ `document.createElement`”因此是一个“要求”，如果你*知道*`$( datahere )`你想要什么（即：不将一些第 3 方数据`document.createElement`与缓慢的字符串操作。

相比之下：`jQuery(document.createElement('div'))` 看起来它有效地做到了这一点（过于简单化）：

```
jQuery(matcher) --> function(matcher)
{
   return jQuery.fn.init(matcher) --> function(matcher)
   {
       this[0] = matcher; 
       this.length = 1; 
       return this; 
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T23:03:44.040

这是 jQuery 中的相同内容。基本上要创建一个新元素，您只需输入您想要的 HTML。

```
function showLeagues(leagues) {
    var $leagueList = $("#leagues");
    $leagueList.empty();
    $.each(leagues, function (index, league) {
        $leagueList.append(getLeagueListElement(league));
    });
}

function getLeagueListElement(league) {
    return $('<li></li>')
        .append($('<a></a>')
            .html(league.name)
            .attr('href', '?league=' + league.key)
            .click(function() {
                showLeague(league);
                return false;
            })
        )
    ;
} 
```

# c# - 获取 PDF 文件中的超链接列表

> ID：176546
> 
> 赞同：2
> 
> 时间：2008-10-06T22:58:00.557
> 
> 标签：c#, pdf

我有一个 pdf 文件。我需要找到该文件中所有可用的超链接，然后对这些链接进行更改。我正在使用 C#，我宁愿不使用第三方工具！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T23:41:48.253

您可以使用[iTextSharp](http://sourceforge.net/projects/itextsharp/)。它是一个用于操作用 c# 编写的 pdf 的开源 API。

基本算法将是：

1.  循环浏览 PDF 文件中的每一页。
2.  对于每一页，循环遍历注解集合（注解字典）中的每个注解。
3.  如果您找到子类型链接的注释，请增加您的计数或执行您需要执行的任何逻辑。

[温迪](http://www.rwendi.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T23:13:48.403

就我个人而言，我会对[PyPDF 有所了解](http://pybrary.net/pyPdf/)。

# command-line - 是否有任何命令行工具可以生成 Windows 图标？

> ID：176557
> 
> 赞同：2
> 
> 时间：2008-10-06T23:00:21.020
> 
> 标签：command-line, image, icons

我正在开发一个需要从一组源图像生成的图标的项目。我有一个脚本，可以明智地使用[ImageMagick](http://www.imagemagick.org/script/index.php)生成所有需要的图像，尽管我还没有找到合适的工具来将图像打包为图标。

我有一组 png 文件（从 16x16 到 256x256 的尺寸，并且在位深度范围内），我想在构建脚本中生成一些漂亮的 vista 图标。我发现最接近我需要的工具是[png2ico](http://winterdrache.de/freeware/png2ico/)，尽管它无法处理大型 Vista 图标，并且不支持它生成的图标的适当透明度。

在我花时间编写这样一个工具之前，有没有人知道可以完成这项工作的任何东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T23:08:46.760

> 在我花时间编写这样一个工具之前，有没有人知道可以完成这项工作的任何东西？

您提供的**png2ico**网页有一个指向该工具源代码的链接。

为什么不从尝试修复您拥有的工具开始呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T00:59:36.270

由于 GConvert 不适合你，也许这会更有用：

### [资源调谐器控制台](http://www.heaventools.com/command-line_resource_editor.htm)

> Resource Tuner Console 是一个高效且高度可定制的脚本驱动资源编辑器，带有命令行界面，支持在 32 位和 64 位 Windows EXE 或 DLL 文件中创建和编辑资源。

具体请参阅图标页面的批量操作以获取一些附加信息：

*   [http://www.heaventools.com/rtconsole-replace-icons.htm](http://www.heaventools.com/rtconsole-replace-icons.htm)

无关，但也可能有用： [如何编译 Windows Vista 图标](http://www.rw-designer.com/compile-vista-icon)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-21T06:28:12.843

如果有人需要这个：icoutils 包含 icotool，它可能会有所帮助：[http ://manpages.ubuntu.com/manpages/raring/man1/icotool.1.html](http://manpages.ubuntu.com/manpages/raring/man1/icotool.1.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T23:38:59.787

不确定这是否符合要求，但描述说它支持“批处理”操作，因此您应该能够自动化该过程。

### [G转换](http://www.gdgsoft.com/gconvert/)

> GConvert 是一个功能齐全的图标工具包，可让您提取、创建、编辑、管理、编译和转换图标。它读取任何图标资源文件（EXE、DLL、ICL、OCX、NIL、CPL、SCR、RSRC、ICNS...），然后允许您将提取的图标保存为其他图像格式（ICO、BMP、PNG、GIF、Photoshop PSD、JPG 等

该页面还特别提到它完全支持 Vista 图标。需要注意的是，有一个免费试用版，但许可证是 25.00 美元

# c++ - “您不能转发声明重载运算符&的类”？

> ID：176559
> 
> 赞同：14
> 
> 时间：2008-10-06T23:00:55.217
> 
> 标签：c++, gcc

在 Google C++ Style Guide 中，有一个关于[运算符重载](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Operator_Overloading)的部分有一个奇怪的声明：

> 重载也有令人惊讶的后果。例如，您不能转发声明重载的类 `operator&`。

这似乎不正确，而且我找不到任何导致 GCC 出现问题的代码。有谁知道那句话是指什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-06T23:50:13.587

标准的 5.3.1 有“可以获取不完整类型对象的地址，但如果该对象的完整类型是声明 operator&() 为成员函数的类类型，则行为未定义（并且没有需要诊断）。”

我也不知道这一点，但正如另一位发帖人指出的那样，很容易看出它如何导致编译器生成不正确的代码。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-06T23:23:12.160

我也没有听说过，但这会给重载之前和之后相同代码的潜在混淆结果：

```
#include <iostream>

class Foo;

void bar (Foo& foo) {
    std::cout << &foo << std::endl;
}

class Foo {
public:
    bool operator & () { return true; }
};

void baz (Foo& foo) {
    std::cout << &foo << std::endl;
}

int main () {
    Foo foo;

    bar(foo);
    baz(foo);

    return 0;
} 
```

输出：

```
0x7fff092c55df
1 
```

尽管还有其他原因导致您无论如何都不会这样做 - 重载 address-of 不能很好地与 stl 或许多通用代码一起使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T23:25:49.720

我认为这种说法并不准确。像其他答案一样，我在这里猜。首先，我假设他们指的是[一元 operator& 而不是二元 operator&](http://www.artima.com/cppsource/YourAddress.html)。那是：

```
int x = 5;
int* p = &x; // unary &
if (x & 1)   // binary & 
```

您可以转发声明您想要的任何类。但是，如果类重载一元运算符&，并且您在指向这些对象之一的指针上调用一元运算符&，您可能会得到不一致的行为（有时您会简单地获取地址，有时您会调用重载方法）。这很容易变成几乎不可能调试的东西。

* * *

我很高兴 fizzer 实际上查看了标准，而不仅仅是猜测。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T13:05:08.617

由于能够重载 operator&，boost 库提供了[方便的模板 addressof()](http://www.boost.org/doc/libs/1_36_0/libs/utility/utility.htm#addressof)来处理查找类的真实地址。并不是我建议您重载 operator&，但如果您需要，可以提供帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T23:09:27.477

**编辑以考虑评论：**

~~这是一个猜测，但转发声明的主要原因之一是能够声明指向该类的指针。编译器必须在定义之前对类做出假设——例如，指针的大小。~~

~~是否可以通过为 T 重载 operator& 来更改 T* 的大小？（编辑：评论员——我认为不是）——但是~~

重载 operator& 违反了哪些假设——它如何改变类？

这是一种方法。

我可以写：

```
class A;

void f(A& x) {
    A* xPointer = &x;
} 
```

如果 operator&() 被重载比没有重载，这具有新的含义，编译器可能认为它可以为它生成代码，但这是错误的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T00:19:06.120

措辞不清楚，您当然可以前向声明类 - 但规则显然采取了您“不应该”在类重载的位置`operator&`。

类似的规则也出现在其他编码标准中，例如[JSF(pdf)](http://www.research.att.com/~bs/JSF-AV-rules.pdf)规则 159 规定`operator&`不应重载。

# c# - 将“数据行”从一个 C# 控制台应用程序传递到另一个 C# 控制台应用程序的最佳方法是什么？

> ID：176569
> 
> 赞同：3
> 
> 时间：2008-10-06T23:06:36.653
> 
> 标签：c#, sql, console

我有一个 C# 控制台应用程序“App1”，它从 SQL Server 2005 数据库中的表中读取一行数据。我希望 App1 将这一行中的所有数据传递给另一个 C# 控制台应用程序 App2。做这个的最好方式是什么？

我的第一个（天真的）尝试是这样做：

```
object[] o = myrow.ItemArray;
// make a string that separates each item by a space... for example "1 2 myVar".
// pass this string to App2 via command line. 
```

这有一些缺陷：如果行中的条目之一是“my var”而不是“myVar”怎么办？此外，项目的顺序将在接收应用程序 (App2) 中进行硬编码。

那么最好的方法是什么？通过命令行将 xml 字符串传递给 App2 是否合适？

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T23:13:22.710

一种方法是将行序列化为 XML 并使用它，但不能序列化 DataRow（缺少默认构造函数）。相反，您必须创建一个新的 DataTable 并将该行添加到其中。

然后，您可以简单地将整个 DataTable 序列化为 XML 并将其作为命令行参数或通过将 XML 保存到文件并传递文件名来传递给其他应用程序。

[借助DataTable.WriteXml](http://msdn.microsoft.com/en-us/library/system.data.datatable.writexml.aspx)方法，将 DataTable序列化为 XML 非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T23:12:20.450

如果您使用的是 Process.Start，则空格分隔的方法很好 - 您只需将包含空格的项目用引号括起来 - 与命令行相同： cd "c:\program files"

如果数据比几个值更复杂，那么远程处理、套接字、WCF 等 IPC 方法可能会有所帮助。或者更简单：将数据（可能是 xml）写入文件，然后让第二个应用程序从文件中加载数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T23:14:29.760

您可以使用序列化的 DataSet 轻松地将数据从一个地方获取到另一个地方，而无需编写大量自定义代码，因为默认 DataSet 已经提供了必要的方法（例如 .WriteXML 会将 DataSet 序列化为 XML 并写入文件）。然后，您的其他应用程序可以轮询适当的目录以查找新文件。

# javascript - 有没有办法将 IFRAME 中的内容溢出到父框架上？

> ID：176572
> 
> 赞同：52
> 
> 时间：2008-10-06T23:07:54.437
> 
> 标签：javascript, css, iframe, tooltip

我有一个 UI 小部件，出于性能原因需要将其放入 IFRAME 中，因此我们可以轻松地将其联合到附属网站。小部件的 UI 包括显示在其他页面内容顶部的工具提示。请参阅下面的屏幕截图或**[访问该站点](http://www.bookabach.co.nz/)**以查看它的运行情况。有没有办法让 IFRAME 中的内容与父框架的内容重叠？

![工具提示内容需要与父框架内容重叠](https://i.stack.imgur.com/8rAnj.png)

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-06T23:24:39.753

不，这是不可能的。忽略任何历史原因，现在它会被认为是一个安全漏洞——例如。许多网站将不受信任的内容放入 iframe（iframe 源是不同的来源，因此无法根据相同的来源策略修改父框架）。

如果此类不受信任的内容具有将内容放置在 iframe 范围之外的机制，则它可以（例如）在父框架的真实登录字段上放置一个“相同的”登录 div（或其他），从而窃取用户名/密码信息. 这会很糟糕。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-05-09T16:00:49.870

我找不到让框架的内容流出框架的方法，但我确实找到了一种绕过它的方法，将工具提示移动到父文档中并将其放在 iframe 上方（z-index） .

方法是：
1）在父文档中找到 iframe
2）从它在 DOM 中的位置删除工具提示元素，并将其添加到包含 iframe 的元素内的父文档中。
3）您可能需要调整 z-index 和定位，具体取决于您最初的操作方式。

您可以使用 parent.document 访问 iframe 的父文档。

```
jQuery(工具提示).remove();
var iframeParent = jQuery("#the_id_of_the_iframe", parent.document)[0].parentNode;
iframeParent.appendChild（工具提示）；
//调整z-index，定位

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T23:29:49.260

这可能是因为它不适合您的要求，或者它实际上可能没有帮助（！），但它可能值得[一试 UFrame](http://www.codeproject.com/KB/aspnet/uframe.aspx)。它是 iframe 和 div 的一种混合体，可能会被打包为一个小部件（最好的办法是给客户一个`<script>`标签，它会吸收 UFrame 和相关标记）。我不确定您是否可以实现所需的覆盖，但它可能值得一试。抱歉，我不能更具体，但这不是我自己实际使用过的东西，我只是在不久前将其添加为书签以供将来参考。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T23:32:45.777

如果您知道工具顶部可以具有的绝对值的顶部，则可以创建一个 div，它是内容的高度 + 工具提示将显示的最高距离。将 iframe 与 div 的底部对齐。确保 iframe 和 div 是透明的。然后应该显示带有工具提示的 iframe 内容。尽管这让您自己为确保突出显示等内容在所有浏览器中都一样工作而感到头疼。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-05T23:28:12.013

将您当前的 iframe 和建议的 div 嵌套在父 iframe 内，然后将您的父 iframe 放入第 3 方，两全其美！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T23:14:53.610

据我所知是做不到的。为什么不使用 XHR 请求并填充 div 呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-03T15:04:20.017

我已经找到了解决类似问题的方法，但这要求能够对父内容进行一些修改。

**快速上下文：**

我正在管理一个网站，该网站通过我们自己的 API 获取与某些合作伙伴相关的一些数据，并通过许多过滤选项以一种很好的方式呈现它。我们的一些合作伙伴有兴趣在他们自己的网站上显示这些数据，但开发他们自己的 UI 来显示 API 数据对于他们中的很多人来说是他们负担不起的。

我们首先建议将我们的 UI 集成到他们网站上的 iframe 中，但这样数据无法被外部搜索引擎（如 Google）索引。所以我们切换到相反的原则：我们将他们网站的顶部菜单集成到放置在我们 UI 中的 iframe 中。

**问题：**

他们的标题菜单通常包含一些下拉子菜单。这些子菜单不能超出 iframe 高度并被截断。

**解决方案：**

*   将 iframe 在 css 位置设置为“绝对”，并具有高 z-index，因此 iframe 会覆盖父 UI。
*   在 iframed 内容中，识别可以溢出 iframe 框的对象的类（在我们的例子中，我们要求菜单所有者为这些元素添加特定的类名，但您可以处理现有的类名）。

然后在一个JS中：

*   获取 iframe 内容的高度（因此标题的高度没有显示任何下拉列表）。
*   将初始 iframe 高度设置为此高度。
*   以等于此高度的边距移动父 UI 内容，以免被默认 iframe 内容覆盖。
*   添加一个事件侦听器，当鼠标悬停在已识别的特定类上时，将 iframe 高度设置为 100%。在这种状态下，iframe 内容可以完全覆盖父内容。
*   添加一个事件侦听器，当鼠标离开特定类时，将 iframe 高度设置回其原始大小。在这种状态下，一切都恢复正常。

# c# - 如何使用 C# 将 DataRow 转换为 XML 字符串？

> ID：176619
> 
> 赞同：0
> 
> 时间：2008-10-06T23:16:36.977
> 
> 标签：c#, xml

我有一个列 col1 和 col2 的 DataRow。每列都有一个值：分别为 val1 和 val2。如何使用 C# 将其转换为 xml 字符串？

对于上面提到的 DataRow，我想要以下字符串：

```
<col1>val1</col1><col2>val2</col2> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T23:33:21.670

> 将 DataRow 放入一个新的 DataTable 中。然后在 dataTable 上调用 writeXml。

技术上是正确的，但我会反对这一点，主要是因为您无法控制输出的 XML。

我将遍历表的行并使用 System.Linq.XML 类来正确格式化您的 XML（或者如果您感觉更反常，请尝试 XMLDocument 和相关类）

# sql - 设置查询定义字段的格式

> ID：176625
> 
> 赞同：3
> 
> 时间：2008-10-06T23:18:32.387
> 
> 标签：sql, ibm-midrange

我在输出到文件的 iSeries SQL 中有以下查询。

```
SELECT SSLOTMAK, SSLOTMDL, SSLOTYER, sum(SSCOUNT)       
FROM prqhdrss                                                      
GROUP BY SSLOTMAK, SSLOTMDL, SSLotyer 
HAVING sum(SSCOUNT) > 4 
ORDER BY SSLOTMAK, SSLOTMDL, SSLOTYER 
```

当我运行它时，创建的字段 sum(SSCOUNT) 是一个 31 Packed 字段。这不允许我将其发送到我的 PC。如何强制 SQL 将该字段创建为非压缩字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T08:39:41.007

试试这个

```
SELECT SSLOTMAK, SSLOTMDL, SSLOTYER, cast(sum(SSCOUNT) as integer)
FROM prqhdrss
GROUP BY SSLOTMAK, SSLOTMDL, SSLotyer
HAVING sum(SSCOUNT) > 4
ORDER BY SSLOTMAK, SSLOTMDL, SSLOTYER 
```

由于“计数”列的名称，我已转换为整数。如果该列具有浮点值，则可以`numeric(8, 2)`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T03:05:58.467

您如何尝试将其带到您的 PC 上？我知道的大多数 iSeries 方法都会自动将其转换为 PC 可读格式。

# javascript - 用于动态编辑页面内容的 Java 脚本

> ID：176626
> 
> 赞同：7
> 
> 时间：2008-10-06T23:19:03.790
> 
> 标签：javascript, html, editing

我正在写一篇关于编辑页面的文章，以便手动选择您真正想要打印的内容。有很多工具（比如“打印你喜欢的东西”），但我也找到了这个脚本。有人知道吗？我还没有找到任何类型的文档或参考资料。

```
javascript:document.body.contentEditable='true'; document.designMode='on'; void 0 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T23:39:59.600

contentEditable 属性是您想要的——它受 IE、Safari（以及 chrome 作为副产品）支持，我*认为是*firefox 3（可惜不是 FFX2）。嘿，它也是 HTML5 的一部分：D

Firefox 2 支持 designMode，但仅限于单个框架，而 contentEditable 属性适用于单个元素，因此您可以让您的可编辑内容更好地与您的页面一起播放：D

[编辑（olliej）：删除示例，因为 contentEditable 属性没有通过 SO 的输出过滤器（尽管在预览中工作）:( ]

[编辑（olliej）：我做了一个非常简单的[演示](http://www.nerget.com/contentEditableDemo.html)来说明它的行为方式]

[编辑（olliej）：是的，链接演示中的 contentEditable 属性在 IE、Firefox 和 Safari 中运行良好。唉，调整大小是只有 webkit 似乎支持的 css3 功能，而 IE 正在尽最大努力与几乎所有的 CSS 作斗争。*叹息*]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T23:23:53.173

IE 4+（显然是启动它）和 FireFox 1.3+ 支持 document.designMode。您打开它，您可以直接在浏览器中编辑内容，这非常令人迷惑。我以前从未使用过它，但听起来它非常适合手工挑选可打印信息。

编辑说：它似乎也适用于谷歌浏览器。我只在 Chrome 和 Firefox 中测试过它，因为这些浏览器中有一个 javascript 控制台，所以我不能保证它可以在 Internet Explorer 中运行，因为我从未亲自使用过它。我的理解是，这是其他浏览器采用的仅限 IE 的属性，目前没有任何标准，所以如果 Firefox 和 Chrome 支持它但 IE 停止了，我会感到惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T00:02:34.390

它在可用的情况下启用浏览器的内置编辑功能。如上所述，designMode 是 Gecko，contentEditable 是其他所有人（并添加到 Gecko 1.9）。这些功能被用作（几乎？）每个使用 HTML/Javascript 构建的所见即所得编辑器的基础。如果您只是简单地输入/删除，那么除了您提供的脚本之外，没有什么需要的了。（不过，从 'void' 开始的一切都是多余的。）

有关如何在应用程序中使用这些功能的文档，最好的参考是 Mozilla 的[Midas 规范](http://www.mozilla.org/editor/midas-spec.html)（[MSDN](http://msdn.microsoft.com/en-us/library/aa969729(VS.85).aspx)可能也有一些用处......）。

# html - 是否有任何工具或技术可以帮助确定非安全页面元素错误的确切原因？

> ID：176627
> 
> 赞同：1
> 
> 时间：2008-10-06T23:19:17.673
> 
> 标签：html, https

我经常遇到这种情况，据说新页面已经“测试”并准备好了。但是，一旦我将页面从 http 更改为 https（安全）模式，我就会得到“此页面包含安全和非安全项目”。错误。

通常我可以找到问题并很快解决。今天不一样了。我检查了每个图像参考和每个 javascript 参考及其来源，但没有发现任何应该导致此错误的东西。

是否有任何开发人员工具或技术可以具体指出导致此错误的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T23:28:11.883

[Firebug 的](http://getfirebug.com/) [网络面板](http://getfirebug.com/net.html)。同样，仅在 Firefox 中，虽然 Firebug Lite 可能包含此功能，但我不确定。如果是这样，那也将涵盖这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T23:25:23.670

如果您在 Firefox 中，您可以使用工具 -> 页面信息 -> 媒体，然后只需向下扫描列表即可找到非 https 链接。也可能有 JavaScript 构建动态`<script>`标签，或包含非安全元素的 CSS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T17:28:42.773

如果将来有人遇到此问题，只需添加几个其他工具：

*   如果您使用的是 IE，则有[Fiddler。](http://www.fiddlertool.com/fiddler/)
*   [Wireshark](http://www.wireshark.org/download.html)是另一个可能有用的工具。

# c# - 单元测试、死锁和竞争条件

> ID：176636
> 
> 赞同：11
> 
> 时间：2008-10-06T23:21:02.540
> 
> 标签：c#, .net, vb.net, parallel-processing

关于如何为可能易受死锁和竞争条件影响的代码编写可重复单元测试的任何建议？

现在我倾向于跳过单元测试并专注于压力测试。问题是你可以运行 5 次压力测试并看到五个不同的结果。

编辑：我知道这可能只是一个梦想，但如果有一种方法可以控制单个线程并让它们一次执行一条指令，那么我可能会到达某个地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T23:24:15.137

看看[TypeMock](http://www.typemock.com/typemock-racer-product/) Racer（它处于测试阶段）

编辑：实际上是阿尔法

[http://www.typemock.com/Typemock_software_development_tools.html](http://www.typemock.com/Typemock_software_development_tools.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T23:27:39.687

通常可以通过使用诸如 ManualResetEvent 之类的东西来强制*预见*的竞争条件和死锁在释放它之前让每个线程进入预期状态 - 即让线程 A 获得锁定并等待信号......让线程 B 请求锁等...

但是 - 您通常可以编写这样的测试来调查可疑的错误，以证明它何时被修复并且它不会重新出现。您通常会围绕竞争条件进行设计（但尽可能实用地测试它们）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T23:31:39.880

我不认为寻找竞争条件真的属于单元测试的范畴。根据定义，或多或少，测试竞争条件的唯一方法是伪随机。除非您愿意努力正式证明您的锁定策略的正确性，否则您将不得不进行一些压力测试。

您仍然需要编写单元测试，以验证算法的正确性，而不是锁定策略。

在对多线程代码进行压力测试时，您需要在每个线程有一个 CPU、多个线程共享 CPU 以及 CPU 多于线程（如果可能的话）的条件下进行测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T23:44:06.657

您可以编写一个锁类，通过查看锁操作的顺序来检测潜在的死锁。我们通过拥有一个线程上下文来做到这一点，所有锁在获取时都会注册（可以设为仅调试选项）。

这个想法是创建一个图，其中节点表示锁，A 和 B 之间的有向边意味着“在获取锁 B 时，锁 A 被持有”。让您的程序使用正常负载运行，然后检查图中的循环。循环意味着即使您的代码没有命中它，也有可能出现死锁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T23:27:46.190

想不出一个好的自动化方法，但我最接近的方法是编写一个“暴露”死锁的单元测试，它是在单元测试之外使用断点。我只是添加了一些关于在何处添加断点的说明。这涉及到一些手动工作，但有了它们，您总是可以公开您的最坏情况线程调度。

也许有人想出了一种自动化此类功能的好方法？我可以想象自动运行调试器，在特定行中断一个线程，让另一个线程运行直到特定条件，然后断言单元测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T13:22:34.723

我之前在代码中使用了由请求中的某些参数触发的人为延迟。例如，一个请求告诉服务器在两次写入之间延迟写入，另一个请求在两次写入之间不延迟。

Mark Bessey 写道，这仅对创建重现有用，而不是用于发现问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-22T21:32:00.987

你试过[Corensic Jinx](http://www.corensic.com/)吗？

# sql - 如何使用 SQL 日期时间字段在特定时间后获取记录

> ID：176673
> 
> 赞同：20
> 
> 时间：2008-10-06T23:30:06.763
> 
> 标签：sql, sql-server, datetime

如果我有一个日期时间字段，我如何只获得晚于某个时间创建的记录，而完全忽略日期？

这是一个日志表，它告诉人们何时在我们的应用程序中连接并执行某些操作。我想知道人们在下午 5 点以后上班的频率。

（抱歉 - 它是 SQL Server。但这对于其他数据库的其他人可能有用）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-06T23:36:48.763

对于 SQL Server：

```
select * from myTable where datepart(hh, myDateField) > 17 
```

请参阅[http://msdn.microsoft.com/en-us/library/aa258265(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa258265(SQL.80).aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T23:36:08.623

你用的是什么数据库系统？日期/时间函数变化很大。

对于甲骨文，你可以说

```
SELECT * FROM TABLE 
  WHERE TO_CHAR(THE_DATE, 'HH24:MI:SS') BETWEEN '17:00:00' AND '23:59:59'; 
```

此外，您可能需要滚动到第二天，并选择午夜和早上 6 点之间的时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T02:19:39.590

在 MySQL 中，这将是

```
where time(datetimefield) > '17:00:00' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T23:35:26.923

我能想到的最好的事情是：不要使用 DateTime 字段；好吧，你可以使用很多 DATEADD/DATEPART 等，但如果你有很多数据，它会很慢，因为它不能在这里真正使用索引。您的数据库可能会在本机提供合适的类型 - 例如 SQL Server 2008 中的 TIME 类型 - 但您可以轻松地以分钟为单位存储时间偏移量（例如）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-12T18:35:57.127

对于 MSSQL，使用 CONVERT 方法：

```
 DECLARE @TempDate   datetime = '1/2/2016 6:28:03 AM'
SELECT  
    @TempDate as PassedInDate,  
    CASE 
        WHEN CONVERT(nvarchar(30), @TempDate, 108) < '06:30:00' then 'Before 6:30am'
        ELSE 'On or after  6:30am'
    END,
    CASE 
        WHEN CONVERT(nvarchar(30), @TempDate, 108) >= '10:30:00' then 'On or after 10:30am'
        ELSE 'Before 10:30am'
    END 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T23:37:12.380

好的，我明白了。

```
select myfield1, 
       myfield2, 
       mydatefield
  from mytable
 where datename(hour, mydatefield) > 17 
```

这将使我在下午 5 点之后获得带有 mydatefield 的记录。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T01:35:21.707

另一种适用于简单情况的 Oracle 方法：

```
select ...
from   ...
where  EXTRACT(HOUR FROM my_date) >= 17
/ 
```

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions050.htm#SQLRF00639](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions050.htm#SQLRF00639)

但有些问题很棘手，比如时间在 15:03:21 和 15:25:45 之间的所有记录。我也会在那里使用 TO_CHAR 方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T21:51:59.270

在 Informix 中，假设您使用 DATETIME YEAR TO SECOND 字段来保存完整日期，您将编写：

```
WHERE EXTEND(dt_column, HOUR TO SECOND) > DATETIME(17:00:00) HOUR TO SECOND 
```

'EXTEND' 确实可以收缩字段集（以及扩展它，顾名思义）。

正如 Thilo 所指出的，这是 DBMS 之间存在极大差异的一个领域（Informix 肯定是其中一种变体）。

# visual-studio-2008 - 如何忽略来自 Cassini 的 GAC 引用？

> ID：176676
> 
> 赞同：1
> 
> 时间：2008-10-06T23:32:01.237
> 
> 标签：visual-studio-2008, gac, cassini

我在 GAC 中有一个程序集，当我调试 Web 应用程序时会加载它。但是，我已经在我正在调试的 Web 应用程序中更改了该程序集，但 VS2008/Cassini 正在 GAC 中选择该程序集。

如何让 VS2008/Cassini 使用我正在调试的那个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T13:49:48.320

您可以更改更新程序集的版本，并确保 Web 应用程序中的程序集引用完全符合该版本。

# excel - 为 Excel VBA 解决方案创建用户帮助文档的最佳方式是什么？

> ID：176690
> 
> 赞同：2
> 
> 时间：2008-10-06T23:37:18.667
> 
> 标签：excel, officedev, vba

VBA 解决方案的大小可以有很大的不同。

我想将**用户帮助文档添加到所有解决方案中，但创建和部署****帮助**的工作量需要与解决方案的大小相匹配。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T08:38:21.790

您应该检查[MZ-Tools 的 VBA 版本](http://www.mztools.com/v3/mztools3.aspx)。它是 VBA 的一个插件，可以从您的代码中自动生成文档（函数名称、参数、注释、主题等）。您还可以使用它来自动生成行号、onError 标签等。有关自动文档功能的更多信息，请参见[此处](http://www.mztools.com/v3/onlinehelp/index.html?html_xml_documentation.htm)。

它免费、简单且非常高效。一旦您注意到使用它节省了多少时间，请像我一样：捐赠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T20:24:13.177

您不妨考虑[HTML 帮助](http://msdn.microsoft.com/en-us/library/ms669985.aspx)。它允许您生成类似于标准 Microsoft 帮助的帮助文件。在大多数情况下，它并不是特别难以使用。

# c++ - 多线程深拷贝

> ID：176691
> 
> 赞同：3
> 
> 时间：2008-10-06T23:37:30.850
> 
> 标签：c++, multithreading, constructor

在作为多线程 C++ 代码一部分的对象的构造函数中执行深度复制的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T23:56:54.010

取决于您的数据结构。

我猜您面临的问题（尽管您没有这么说）是潜在的锁定反转。如果您正在深度复制，那么您可能会为需要复制的各种对象使用一个或多个锁。

如果您可以定义一个 DAG（即偏序），其中节点是系统中的每个锁，并且您可能想要使用的每个锁组合都由边连接，那么您可以确保永远不会使用锁不同线程中的不同顺序。因此，特别是您不会获得锁定反转。一个典型的规则是最后使用“最通用”的锁，因为这样可以最大限度地减少争用。

但是，如果您要深度复制一大堆“WidgetBox”中的一个，每个“WidgetBox”都包含基本上无法区分的“Widget”，并且框的内容之间可能存在重叠，那么您自然会遇到定义锁定顺序的问题。此外，您必须先锁定 WidgetBox（即使它是“最通用的”对象），因为没有该锁定，您无法确定还需要锁定什么。如果小部件具有可比性，您可能可以按顺序锁定每个小部件，复制并释放所有内容。讨厌。

另一种方法是定义在所有 Widget 和 WidgetBox 之间共享的单个锁。这可能会引起很多争用，在这种情况下，乐观锁定可能会有所改善，前提是副本不会同时发生太多修改。

另一种选择可能是放宽您对副本所做的保证 - 而不是要求从深层结构的可识别状态制作完整副本，您可以首先锁定 WidgetBox，浅复制它（使用引用计数或其他方式 - 锁定在引用计数上通常是“最终内部锁”，因此没有反转风险），释放 WidgetBox 锁，然后依次复制每个 Widget。如果 Widget 具有内部结构，请使用相同的方法来复制它们。结果可能包含一个 Widget，直到它从另一个线程中的 WidgetBox 中删除后才实现，或者其他类似的不协调，所以如果这是不可接受的，那么你不能使用这种方法。但是，如果您在每个线程中一次只锁定一个对象，那么您将无法获得锁定反转。

最后一个可能的“核”选项是使所有内容不可变，并始终在修改时复制。如果什么都不能修改，那么您就不需要任何锁（尽管在线程之间传递引用时仍然需要内存屏障）。

如果这些都不起作用，那么除非我忘记了某些东西，否则您将失去我的经验。我推测数据库实现是很多与锁相关的聪明才智的地方，这将是寻求想法的领域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T00:22:12.320

叉子（）

我只是在开玩笑。但这太有趣了，不能放弃:)

我认为 onebyone 已经涵盖了您的大部分选择。除了，也许，退后一步，看看你是否能找到一种方法来避免一开始就做深拷贝......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-06T23:39:06.590

我的第一个冲动（我不是专家）：

锁定代码用于写入该对象的对象。当您进行深度复制时，锁定对象，执行您的深度复制，然后解锁它。

或者，我在这里遗漏了什么？

# css - （CSS？）消除浏览器在超链接图像周围的“选定”行？

> ID：176695
> 
> 赞同：11
> 
> 时间：2008-10-06T23:38:14.360
> 
> 标签：css, selecteditem

随附的屏幕截图来自 OS X/Firefox 3。请注意，中心选项卡（图像）周围有一条虚线，显然是因为它是最近选择的选项卡。有没有办法可以消除 CSS 或 JavaScript 中的这条虚线？（嗯……免费的图像托管服务已经减小了图像的大小。但是如果你能看到它，你会注意到块周围有一个虚线选择区域。）

[屏幕截图 http://www.freeimagehosting.net/uploads/th.fadf78173b.png](http://www.freeimagehosting.net/uploads/th.fadf78173b.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-06T23:47:08.227

您需要将以下行添加到您的 css 中：

```
a:active, a:focus { outline-style: none; -moz-outline-style:none; } 
```

（当然，假设您的选项卡是使用 a 元素完成的。）

*[编辑] 应其他人的要求，对于未来的观众来说，应该注意大纲对于键盘导航器来说是必不可少的，因为它指定了您的选择在哪里，因此，提示您的下一个“标签”可能会去哪里. 因此，不建议删除此虚线选择。但是，如果您认为有必要，了解您将如何做仍然很有用。*

*正如评论中提到的，如果您只处理 FF > v1.5，请随时省略 -moz-outline-style:none;*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T23:40:20.113

在您的 onclick 事件中， this.blur()

或者，专门将焦点放在其他地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T23:49:29.143

对于初学者，试试这个

```
*,*:hover,*:focus,*:active { outline: 0px none; } 
```

然而，这会降低可用性。

您将希望在相关的地方选择性地应用替代效果，以使人们（例如主要使用 TAB 键导航的人）了解当前关注的内容。

```
div.foo:active, 
div.foo:focus, 
div.foo:hover
{  
  /* Alternative Style */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T23:40:26.027

您可以从查看 :focus 和 :active 伪类开始，尽管您可能*不应该*从这些案例中完全删除任何格式，因为它们是非常宝贵的可用性帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T21:15:22.030

使用

```
*:focus {outline:0px;} 
```

使用鼠标选择时，将删除输入和文本区域的样式。如果您选择删除 :focus 上的所有轮廓，请确保为这些表单项附加这些样式和边框。

# c# - 在 .net 中持久化配置项

> ID：176709
> 
> 赞同：3
> 
> 时间：2008-10-06T23:41:53.307
> 
> 标签：c#, .net, configuration

我有一组需要保存到“人类可读”文件的配置项。这些项目在一个层次结构中：

```
设备 1
   姓名
   频道 1
     姓名
     尺寸
     ...
   频道 N
     姓名
...
设备 M
   姓名
   频道 1

```

这些项目中的每一个都可以存储在带有字符串键和值的字典中。它们也可以在结构/DTO 中。

我不在乎文件的格式，只要它是人类可读的。它可以是 XML，也可以是更像 INI 格式的东西

```
[标题]
  键=值
  键2=值
...

```

有没有办法最小化我需要编写来管理存储/读取配置项的样板代码量？

我应该只创建数据传输对象（DTO）/结构并将它们标记为可序列化（生成臃肿的 XML 是否仍然人类可读？）

还有其他建议吗？

编辑：并不是说软件必须**写入**和**读取**配置。这使得 app.config 被排除在外。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T23:44:52.757

[.NET 的 YAML](http://www.codeplex.com/yaml)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T23:51:39.747

我认为[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.netdatacontractserializer.aspx)和[NetDataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.netdatacontractserializer.aspx)都创建了人类可读的 XML。 [我更喜欢](https://stackoverflow.com/questions/109318/using-c-what-limitations-if-any-are-there-in-using-the-xmlserializer#109393)NetDataContractSerializer，因为它可以做 XmlSerializer 不能做的事情，但这些额外的功能可能比你需要的更多。如果您已经为您的配置编写了类，那么这两个中的一个可能是您通往胜利的最短路径。

您还可以将配置写入本地 app.config 文件，或使用自定义[ConfigSections](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsection(VS.80).aspx)和[Configuration 类](http://msdn.microsoft.com/en-us/library/system.configuration.configuration.aspx)的子配置文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T00:52:43.493

如果将结构序列化为 JSON，您将获得比 XML 更简单的对象表示。

这是来自 James Netwon-King 的 JSON.Net 站点的示例：

```
Product product = new Product();    
product.Name = "Apple";    
product.Expiry = new DateTime(2008, 12, 28);    
product.Price = 3.99M;    
product.Sizes = new string[] { "Small", "Medium", "Large" };    

string json = JavaScriptConvert.SerializeObject(product);
//{
//  "Name": "Apple",
//  "Expiry": new Date(1230422400000),
//  "Price": 3.99,
//  "Sizes": [
//    "Small",
//    "Medium",
//    "Large"
//  ]
//}   

Product deserializedProduct = JavaScriptConvert.DeserializeObject<Product>(json); 
```

[您可以阅读他的博客并在此处](http://james.newtonking.com/pages/json-net.aspx)下载 JSON.Net 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T23:45:30.757

我怀疑您将要使用的是一个 app.config 文件，其中包含 XML 格式的设置，.NET 将能够使用 System.Configuration 命名空间加载该文件。

更多信息在这里： http: [//geekswithblogs.net/akraus1/articles/64871.aspx](http://geekswithblogs.net/akraus1/articles/64871.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T00:55:34.437

请参阅[FileHelpers](http://filehelpers.sourceforge.net/)库。它有大量的东西可以读取和写入许多不同的格式——你所要做的就是用属性标记你的对象并调用 Save()。有点像用于平面文件的 ORM。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T23:49:52.870

我通常使用注册表来存储配置（我知道，我很糟糕！），但使用 System.Xml 读取/写入轻量级 XML 文件并不难。事实上，我最近为一个使用 XML 文档与其主机通信并存储其自己的持久设置的插件项目做了这件事。

还有 System.Configuration 命名空间，但我还没有真正处理过它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T00:16:43.550

在这种情况下，我的偏好是创建一个带有 DataTables 的 DataSet，用于以良好的关系方式排列的配置数据 - 然后使用 DataSet.WriteXML() 将其保存到配置文件中。

然后再次加载它，您只需使用 DataSet.ReadXML() ，它就会回到一个很好的可查询对象中。

这是我的应用程序允许用户在文本编辑器窗口中编辑的示例配置文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<!--****************************************************************
 Config File: FileToExcel_test.cfg
      Author: Ron Savage
        Date: 06/20/2008

 Description: 
 File to test parsing a file into an Excel workbook.

 Modification History: 
 Date       Init Comment
 06/20/2008 RS   Created.
******************************************************************-->

<!--********************************************************************
 Global Key Definitions
********************************************************************-->
   <config key="sqlTimeout"      value="1800"/>
   <config key="emailSMTPServer" value="smtp-server.austin.rr.com"/>
   <config key="LogFile"         value="FiletoExcel_test_{yyyy}{mm}{hh}.log"/>
   <config key="MaxEntries"      value="1"/>

<!--********************************************************************
 Delimiter Configurations
********************************************************************-->
   <config key="pipe"           value="|"/>

<!--********************************************************************
 Source / Target Entries
********************************************************************-->
   <config key="source_1"  value="FILE, c:\inetpub\ftproot\filetoexcel.txt, pipe, , , , , "/>
   <config key="target_1"  value="XLS, REPLACE, c:\inetpub\ftproot\filetoexcel1.xls, , , , , , , ,c:\inetpub\ftproot\filetoexcel_template.xls, ,3"/>
   <config key="notify_1"  value="store_error, store_success"/>
</configuration> 
```

当我将它加载到 DataSet 中时，所有非注释标记都驻留在一个名为**Config的表中，其中包含****Key** & **value**字段。非常容易搜索。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T01:21:53.543

我会使用可以序列化为 XML 的数据结构 - 事实上，由于我很懒，我会使用 ADO.NET 数据集，因为它有一个简单的序列化格式，您无需费力地思考即可生成.

就使其可读性而言：如果它必须是人类可读的（而不是人类可修改的，我认为这是您在此处所描述的），我将构建一个 XSLT 转换并使用它来生成每当我写出 XML 时，配置数据的 HTML 版本。这使您可以根据您的要求对数据的视觉呈现进行细粒度的控制。

# php - 如何找到应用程序的基本 url？

> ID：176712
> 
> 赞同：10
> 
> 时间：2008-10-06T23:44:48.467
> 
> 标签：php, web-applications

我想找到我的应用程序的基本 url，这样我就可以自动引用我的应用程序树中的其他文件...

因此，给定我的应用程序基础中的文件 config.php，如果子目录中的文件包含它，则知道在 url 前面加上什么前缀。

```
application/config.php
application/admin/something.php
application/css/style.css 
```

因此，鉴于`http://www.example.com/application/admin/something.php`已访问，我希望它能够知道 css 文件位于`$approot/css/style.css`. 在这种情况下，`$approot`是“ `/application`”，但我想知道应用程序是否安装在其他地方。

我不确定是否可能，许多应用程序（我认为是 phpMyAdmin，Squirrelmail）必须设置一个配置变量。如果它只知道它会更加用户友好。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T02:34:33.643

我在自制框架中使用以下内容...将其放在应用程序根文件夹中的文件中并简单地包含它。

```
define('ABSPATH', str_replace('\\', '/', dirname(__FILE__)) . '/');

$tempPath1 = explode('/', str_replace('\\', '/', dirname($_SERVER['SCRIPT_FILENAME'])));
$tempPath2 = explode('/', substr(ABSPATH, 0, -1));
$tempPath3 = explode('/', str_replace('\\', '/', dirname($_SERVER['PHP_SELF'])));

for ($i = count($tempPath2); $i < count($tempPath1); $i++)
    array_pop ($tempPath3);

$urladdr = $_SERVER['HTTP_HOST'] . implode('/', $tempPath3);

if ($urladdr{strlen($urladdr) - 1}== '/')
    define('URLADDR', 'http://' . $urladdr);
else
    define('URLADDR', 'http://' . $urladdr . '/');

unset($tempPath1, $tempPath2, $tempPath3, $urladdr); 
```

上面的代码定义了两个常量。ABSPATH 包含应用程序根目录（本地文件系统）的绝对路径，而 URLADDR 包含应用程序的完全限定 URL。它确实适用于 mod_rewrite 情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-25T12:53:30.790

您可以使用以下代码找到基本 url：

```
define('SITE_BASE_PATH','http://'.preg_replace('/[^a-zA-Z0-9]/i','',$_SERVER['HTTP_HOST']).'/'.str_replace('\\','/',substr(dirname(__FILE__),strlen($_SERVER['DOCUMENT_ROOT']))).'/'); 
```

简短而最好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T23:50:46.037

结合[dirname()](http://us2.php.net/manual/en/function.dirname.php)的 REQUEST_URI可以告诉您当前目录，与 URL 路径相关：

```
<?php
  echo  dirname($_SERVER["REQUEST_URI"]);
?> 
```

因此[http://example.com/test/test.php](http://example.com/test/test.php)打印“/test”或[http://example.com/](http://example.com/)打印“/”，您可以使用它们生成链接以引用相对于当前路径的其他页面。

**编辑**：刚刚重新阅读时意识到您可能会询问磁盘路径而不是 URL 路径。在这种情况下，您需要 PHP 的[getcwd()](http://us2.php.net/getcwd)函数：

```
<?php
  echo  getcwd();
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T23:50:40.403

除非您自己跟踪，否则我认为这不会有定义。或者更确切地说，您要求 PHP 跟踪您有些随意定义的内容。

总而言之，如果我正确理解您的问题，我不相信您所要求的存在，至少不是“核心”PHP；一个给定的框架可以提供一个相对于*它所*理解的目录结构的“根”URL。

那有意义吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T23:55:47.023

把它放在你的 config.php 中（在你的应用程序的根目录中）：

```
$approot = substr(dirname(__FILE__),strlen($_SERVER['DOCUMENT_ROOT'])); 
```

我想这样就可以了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-11T08:58:18.417

可以通过以下方式找到应用程序的 url 根目录

```
$protocol = (strstr('https',$_SERVER['SERVER_PROTOCOL']) === false)?'http':'https';
$url = $protocol.'://'.$_SERVER['SERVER_NAME'].dirname($_SERVER['REQUEST_URI']); 
```

此代码将返回任何应用程序的 url 路径，无论是在线还是离线服务器。

我没有正确检查正确的'/'。请修改它的斜线。

这个文件应该放在根目录下。

示例：如果应用程序网址：

```
http://localhost/test/test/test.php 
```

那么这段代码将返回

```
http://localhost/test/test 
```

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T00:03:00.597

一种解决方案是对所有内容使用相对路径，这样应用程序的安装位置无关紧要。例如，要访问您的样式表，请使用以下命令：

```
../css/style.css 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T00:06:19.250

如果您想要文件系统上的路径，您可以使用`$_SERVER['DOCUMENT_ROOT']`
如果您只想要在域使用后出现在 URL 中的文件的路径`$_SERVER['REQUEST_URI']`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-07T03:36:03.600

我从来没有找到办法做到这一点。

我总是最终将服务器路径设置为高于 Web 根目录的一级配置变量。然后是：

*   $configVar 。'public/whatever/' 用于根目录下的内容，
*   但您也可以使用 $configVar 从外部包含。'phpInc/db.inc.php/' 等

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T06:19:53.440

这对我来说就像一个魅力，无论我在哪里部署，不管有没有重写规则：

$baseDir = 'http://'.$_SERVER['HTTP_HOST'].(dirname($_SERVER['SCRIPT_NAME']) != '/' ? dirname($_SERVER["SCRIPT_NAME"]).'/' ： '/');

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-31T11:58:08.723

这是我在我的应用程序中使用的，效果很好，我也使用自定义端口，所以我也必须允许这样做。

```
define('DOC_URL', ($_SERVER['HTTPS']=='on'?'https':'http').'://'.$_SERVER['SERVER_NAME'].(!in_array($_SERVER['SERVER_PORT'], array(80,443))?':'.$_SERVER['SERVER_PORT']:'')).dirname($_SERVER['REQUEST_URI']); 
```

然后我通过键入以下内容来使用它...

```
<img src="<?php echo DOC_URL; ?>/_img/logo.png" /> 
```

# c# - 不规则形状的 Windows 窗体 (C#)

> ID：176720
> 
> 赞同：19
> 
> 时间：2008-10-06T23:47:17.633
> 
> 标签：c#, .net, winforms

最简单的方法是什么？托管代码可以吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-06T23:55:27.790

```
this.BackgroundImage = //Image
this.FormBorderStyle = FormBorderStyle.None;
this.Width = this.BackgroundImage.Width;
this.Height = this.BackgroundImage.Height;
this.TransparencyKey = Color.FromArgb(0, 255, 0); //Contrast Color 
```

这允许您基于图像创建表单，并使用透明度索引使其看起来好像不是矩形。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-07T00:00:43.083

@Geoff 在 winforms 中显示了正确的方式。

但是如果您打算使用 WPF 而不是 Winforms，那么 WPF(.NET3.0+) 提供了非常灵活的方法来创建任意形状的自定义窗口。查看这篇文章也[http://www.codeproject.com/KB/WPF/wpfpopup.aspx](http://www.codeproject.com/KB/WPF/wpfpopup.aspx)

# .net - 构建通用实用程序库的最佳方法是什么？

> ID：176726
> 
> 赞同：2
> 
> 时间：2008-10-06T23:49:36.443
> 
> 标签：.net, projects-and-solutions

我想知道构建可用于不同项目的通用实用程序库的最佳方法是什么。我正在使用 .Net 和 C#。

我应该为每个实用程序（如日志记录、身份验证、Excel 等）创建一个单独的项目，并将它们与依赖项一起单独发布，还是应该将所有实用程序与捆绑的所有依赖项一起包含在一个通用 utils 程序集中，并且只在项目中引用必要的依赖项使用常用工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T23:53:58.430

我可能会弄清楚你想要提供什么功能（至少一般来说），然后围绕它定义一个逻辑命名空间层次结构。一旦你有了总体定义，你应该能够创建所有的库文件并构建它的模块化，这样你就没有一个庞然大物的“一切”库，而是可以拥有像“你的文件/目录助手”这样的东西程序集”.dll、“您的数据库包装程序集”.dll、“您的 UI 组件程序集”.dll 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T23:55:33.343

这取决于两件事。

首先，你捆绑在一起的东西之间有什么关系？把它们放在图书馆里有意义吗？

二、使用模式是什么？如果它是与每个项目链接的一组标准实用程序，那么将它们放在一起是有意义的，但如果您使用的是运行时插件样式模型，在其中动态加载不同的模块以提供功能，您可能需要更多的分离。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T00:10:35.247

我已经走上了创建 Master ProductivityLibrary 的路线 - 是的，那是愚蠢的命名空间 - 只是发现我有一个我使用最多的类的子集，以及设计模式瑞士的宏伟方案 -每次出现一组想法时，总是重新编译军刀。为所有东西制作插件是没有意义的，因为它变得如此混搭。

构建解决一个问题的离散程序集 - 它更易于管理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-02T16:45:50.040

我发现了一种在我的项目之间共享通用源代码和实用程序的好方法！在每个新项目中，我都会创建一个“Junction Point”文件夹，指向相同的公共源文件存储库。然后在 Visual Studio 的项目树中，我在需要的文件上选择“显示所有文件”和“包含”。这真的很棒！简单而强大...

我没有使用包含在某些项目中可能没有任何用处的各种代码的单一 common.dll，而是添加了我真正需要的文件，并且我得到了一个没有大量松散 dll 文件的单个 exe 文件。

另一个技巧是让不同的文件具有相同的部分静态实用程序类，例如 EncryptionUtils.cs 和 NetworkUtils.cs。当它们都可以从同一个静态类中访问时，很容易从代码中找到这些实用程序。而且因为我只包含我真正需要的文件，所以我只能在 Utilities 类中获得这些实用程序。

# .net - 使 DOM 元素有效地只读

> ID：176743
> 
> 赞同：0
> 
> 时间：2008-10-06T23:59:25.393
> 
> 标签：.net, dom, mshtml

我正在编写一个 .NET 表单控件来使用 MSHTML 编辑 HTML。我正在创建一些自定义元素，并希望使它们有效地只读。我想我可以通过关注整个元素来解决这个问题，只要焦点在该元素的任何位置输入，但 HtmlElement.Focus() 不会选择整个元素，而且我似乎无法捕获光标的输入.

另一种选择是在元素的文本发生更改时引发事件（我期望在 KeyDown 上），但我也无法触发该事件。关于为什么我对事件行为的期望是错误的任何想法或替代实施建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T17:25:38.370

我发现设置属性：

```
contentEditable=false 
```

导致所需的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T09:50:34.937

如果您尝试将只读行为应用于用户输入控件，您可以尝试使用该控件的 @readonly 属性。否则，您还可以为适当的 UI 事件（keydown、mousedown）添加事件侦听器并阻止它们的默认行为（return false 或 event.returnValue = false）。至于自定义事件调度，您确实可以这样做。使用 IE 已知的事件名称。另一个提示可能是：注册一个 onchange 事件处理程序并将控件的值恢复为 defaultValue 的值（任何输入控件的属性）。

希望一些想法会有所帮助。

# java - Java 中的循环引用

> ID：176745
> 
> 赞同：50
> 
> 时间：2008-10-06T23:59:45.050
> 
> 标签：java, memory, memory-management, memory-leaks, garbage-collection

给定一个以复杂、循环的方式相互引用的类实例的聚合：垃圾收集器是否可能无法释放这些对象？

我隐约记得这是过去 JVM 中的一个问题，但我*认为*这在几年前就已经解决了。然而，对 jhat 的一些调查显示，循环引用是我现在面临的内存泄漏的原因。

*注意：我一直认为 JVM 能够解析循环引用并从内存中释放这些“垃圾岛”。但是，我提出这个问题只是为了看看是否有人发现了任何例外。*

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-07T00:11:53.620

只有非常幼稚的实现才会有循环引用的问题。维基百科有一篇关于不同 GC 算法的好[文章。](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))如果您真的想了解更多信息，请尝试（亚马逊）[垃圾收集：自动动态内存管理算法](https://rads.stackoverflow.com/amzn/click/com/0471941484)。Java 从 1.2 开始就有一个很好的垃圾收集器，在 1.5 和 Java 6 中有一个非常好的垃圾收集器。

改进 GC 的难点在于减少暂停和开销，而不是像循环引用这样的基本内容。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-07T00:02:47.320

垃圾收集器知道根对象在哪里：静态变量、堆栈上的局部变量等，如果无法从根访问对象，那么它们将被回收。如果他们可以到达，那么他们需要留下来。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-07T18:31:42.670

Ryan，根据您对[Java 中的循环引用](https://stackoverflow.com/questions/176745/circular-references-in-java#176767)的评论判断，您陷入了从类中引用对象的陷阱，该类可能是由引导程序/系统类加载器加载的。每个类都由加载该类的类加载器引用，因此只有当类加载器不再可访问时才能进行垃圾收集。问题是引导程序/系统类加载器永远不会被垃圾收集，因此，系统类加载器加载的类中可访问的对象也不能被垃圾收集。

JLS 中解释了这种行为的原因。例如，第三版 12.7 [http://java.sun.com/docs/books/jls/third_edition/html/execution.html#12.7](http://java.sun.com/docs/books/jls/third_edition/html/execution.html#12.7)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-07T00:35:31.983

如果我没记错的话，那么根据规范，**只能保证 JVM 不能收集**什么（任何可达的），而不是它会收集什么。

除非您使用实时 JVM，否则大多数现代垃圾收集器应该能够处理复杂的引用结构并识别可以安全消除的“子图”。随着越来越多的研究想法进入标准（而不是研究）VM，效率、延迟和这样做的可能性会随着时间的推移而提高。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-07T00:02:55.013

不，至少使用 Sun 的官方 JVM，垃圾收集器将能够检测到这些循环并在不再有来自外部的任何引用时释放内存。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-07T00:27:24.683

Java 规范说垃圾收集器可以垃圾收集你的对象只有当它**不能从任何线程访问时。**

Reachable 意味着有一个引用，或从 A 到 B 的引用链，并且可以通过 C、D、...Z 进行所有它关心的事情。

自 2000 年以来，JVM 不收集东西对我来说一直不是问题，但你的里程可能会有所不同。

提示：Java 序列化缓存对象以提高对象网格传输效率。如果你有很多大的、瞬态的对象，并且你的所有内存都被占用了，请重置你的序列化程序以清除它的缓存。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-04-01T17:25:18.993

当一个对象引用另一个对象，而另一个对象引用第一个对象时，就会发生循环引用。例如：

```
class A {
private B b;

public void setB(B b) {
    this.b = b;
}
}

class B {
private A a;

public void setA(A a) {
    this.a = a;
}
}

public class Main {
public static void main(String[] args) {
    A one = new A();
    B two = new B();

    // Make the objects refer to each other (creates a circular reference)
    one.setB(two);
    two.setA(one);

    // Throw away the references from the main method; the two objects are
    // still referring to each other
    one = null;
    two = null;
}
} 
```

如果有循环引用，Java 的垃圾收集器足够聪明，可以清理对象，但是不再有任何活动线程对对象有任何引用。所以像这样的循环引用不会造成内存泄漏。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-07T00:10:54.373

只是为了放大已经说过的话：

我已经工作了六年的应用程序最近从 Java 1.4 更改为 Java 1.6，我们发现我们必须添加静态引用到我们之前甚至没有意识到可以进行垃圾收集的东西。我们以前不需要静态引用，因为垃圾收集器过去很糟糕，现在好多了。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-07T00:20:52.277

引用计数 GC 因这个问题而臭名昭著。值得注意的是，Suns JVM 不使用引用计数 GC。

如果无法从堆的根目录访问对象（通常，至少通过类加载器，如果没有其他情况0，那么对象将被销毁，因为它们在典型的 Java GC 期间没有被复制到新堆。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T00:02:54.903

垃圾收集器是一个非常复杂的软件——它已经在一个巨大的 JCK 测试套件中进行了测试。这不是完美的，但很有可能只要 java 编译器（javac）会编译你的所有类并且 JVM 会实例化它，那么你应该很好。

再说一次，如果您持有对该对象图根的引用，则不会释放内存，但是如果您知道自己在做什么，则应该没问题。

# json - 处理 JSON 序列化变化的正确方法

> ID：176749
> 
> 赞同：2
> 
> 时间：2008-10-07T00:00:49.837
> 
> 标签：json, serialization, google-visualization, simplejson

我有一个使用 Python 的 SimpleJSON 序列化 JSON 的网络服务，以及一个使用 Google 的 Visualization [API](http://code.google.com/apis/visualization/documentation/reference.html)的 javascript/ 客户端。当我尝试使用 Google 数据表的查询方法读取 JSON 响应时，我收到“无效标签”错误。

我注意到 Google 电子表格输出 JSON，对象键周围没有引号。我尝试在没有引号的情况下阅读 JSON 并且有效。我想知道将 SimpleJSON 输出读入 Google 数据表的最佳方法是什么

`query = new google.visualization.Query("http://www.myuri.com/api/")`.

我可以使用正则表达式来删除引号，但这似乎很草率。我尝试过的 javascript JSON 解析库不会在对象键周围没有引号的情况下以 JSON 语法读取。

这是一些很好的背景阅读：围绕对象键的引号：

[http://simonwillison.net/2006/Oct/11/json/](http://simonwillison.net/2006/Oct/11/json/)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T00:19:43.030

您确定 Google API 需要 JSON 吗？根据我的经验，Google 的 API 往往不会以您所描述的方式被大量破坏——可能是他们实际上期望一种仅类似于 JSON 的不同格式。

* * *

进一步探索揭示了以 Google 期望的格式检索数据的说明：

> 例如，要从 Google 电子表格中获取 dataSourceUrl，请执行以下操作：
> 
> 1.  在电子表格中，选择单元格范围。
> 2.  从菜单中选择“插入”，然后选择“小工具”。
> 3.  单击右上角的选择器打开小工具的菜单。
> 4.  选择菜单选项“获取数据源 URL”。

我这样做并在我的浏览器中打开了 URL。它返回的数据肯定不是 JSON：

```
google.visualization.Query.setResponse(
{requestId:'0',status:'ok',signature:'1464883469881501252',
table:{cols: [{id:'A',label:'',type:'t',pattern:''},
{id:'B',label:'',type:'t',pattern:''}],
rows: [[{v:'a'},{v:'h'}],[{v:'b'},{v:'i'}],[{v:'c'},{v:'j'}],[{v:'d'},{v:'k'}],[{v:'e'},{v:'l'}],[{v:'f'},{v:'m'}],[{v:'g'},{v:'n'}]]}}); 
```

看起来结果打算由浏览器直接执行。尝试修改您的代码以执行以下操作：

```
# old
return simplejson.dumps ({"requestId": 1, "status": "ok", ...})

# new
json = simplejson.dumps ({"requestId": 1, "status": "ok", ...})
return "google.visualization.Query.setResponse(%r);" % json 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T00:34:57.477

“无效标签”错误通常是由于 JSON 字符串上的盲目 eval()，导致属性名称被误认为标签（因为它们具有相同的语法 - “foo:”）。

```
eval("{ foo: 42, bar: 43 }"); // Results in invalid label 
```

快速的补救措施是确保您的 JSON 字符串有括号括住花括号：

```
eval("({ foo: 42, bar: 43 })"); // Works 
```

尝试将您的 JSON 字符串括在括号中，以查看“无效标签”错误是否消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T12:01:46.643

事实证明**:mod:json**也会阻塞单引号中的字符串。不过，这将解决问题：

# 在 python 中将 JavaScript 对象解析为 JSON：

## 解决方案：

```
>>> from re import sub
>>> import json
>>> js = "{ a: 'a' }"
>>> json.loads(sub("'", '"', sub('\s(\w+):', r' "\1":', js)))
{u'a': u'a'} 
```

**编辑：（**审查边缘案例）

因此有人提出，建议的解决方案不能处理所有情况，特别是类似的情况

> 例如 {foo:"a sentence: right here!"} 将更改为 {"foo":"a "sentence": right here!"}
> – Jason S 4 月 12 日 18:03

为了解决这个问题，我们只需要确保我们实际上是在使用一个键而不是字符串中的冒号，所以我们稍微看看背后的魔法来暗示逗号 (,) 或花括号 ({) 的存在确保我们有正确的，像这样：

## 字符串中的冒号：

```
>>> js = "{foo: 'a sentence: right here!'}"
>>> json.loads(sub("'", '"', sub('(?<={|,)\s*(\w+):', r' "\1":', js)))
{u'foo': u'a sentence: right here!'} 
```

这当然和做的一样：

```
>>> js = "{foo: 'a sentence: right here!'}"
>>> json.loads(sub('(?<={|,)\s*(\w+):', r' "\1":', js).replace("'",'"'))
{u'foo': u'a sentence: right here!'} 
```

但后来我指出这不是唯一的缺陷，因为引号呢：

如果我们还关心转义引号，我们将不得不稍微更具体地了解什么是字符串。第一个引号将在大括号（{）、空格（\s）或冒号（:）之后，而最后一个匹配的引号将在逗号（，）或右大括号（}）之前，然后我们可以考虑两者之间的所有内容都作为同一字符串的一部分，如下所示：

## 字符串中的附加引号：

```
>>> js = "{foo: 'a sentence: it\'s right here!'}"
>>> json.loads(
...     sub("(?<=\s|{|:)'(.*?)'(?=,|})", 
...         r'"\1"', 
...         sub('(?<={|,)\s*(\w+):', r' "\1":', js))
...     )
{u'foo': u"a sentence: it's right here!"} 
```

随着更多边缘案例的揭示和解决，请注意这个空间。你能发现另一个吗？

或者对于更复杂的事情，一个真实世界的例子，由返回`npm view`：

## 从：

> ```
> {名称：'查克'，
>       描述：“查克诺里斯笑话分配器。”，
>       'dist-tags'：{最新：'0.0.3'}，
>       版本：'0.0.3'，
>       维护者：'qard'，
>       时间：{'0.0.3'：'2011-08-19T22:00:54.744Z'}，
>       作者：“斯蒂芬·贝朗格”，
>       存储库：
>            {类型：'git'，
>              网址：'git://github.com/qard/chuck.git'},
>           版本：'0.0.3'，
>           依赖项：{ 'coffee-script': '>= 1.1.1' },
>           关键词：
>                ['查克'，
>                  '诺里斯'，
>                  “笑话”，
>                  '有趣的'，
>                  '乐趣' ]，
>               bin: { 夹头: './bin/chuck' },
>               主要：'索引'，
>               引擎：{节点：'>= 0.4.1 < 0.5.0'}，
>               devDependencies：{}，
>               分布：
>                    { shasum: '3af700056794400218f99b7da1170a4343f355ec',
>                      压缩包：' http ://registry.npmjs.org/chuck/-/chuck-0.0.3.tgz '},
>                   脚本：{}，
>                   目录：{}，
>                   可选依赖项：{} }
> ```

## 到：

> ```
> {u'author': u'Stephen Belanger',
>      u'bin': {u'chuck': u'./bin/chuck'},
>      u'dependencies': {u'coffee-script': u'>= 1.1.1'},
>      u'description': u'Chuck Norris 笑话分配器。',
>      u'devDependencies'：{}，
>      u'目录'：{}，
>      u'dist': {u'shasum': u'3af700056794400218f99b7da1170a4343f355ec',
>       u'tarball': u' http://registry.npmjs.org/chuck/-/chuck-0.0.3.tgz '},
>      u'dist-tags': {u'latest': u'0.0.3'},
>      u'engines': {u'node': u'>= 0.4.1 < 0.5.0'},
>      u'keywords': [u'chuck', u'norris', u'jokes', u'funny', u'fun'],
>      u'main': u'index',
>      u'maintainers': u'qard',
>      你'名字'：你'查克'，
>      u'optionalDependencies': {},
>      u'repository': {u'type': u'git', u'url': u'git://github.com/qard/chuck.git'},
>      u'脚本'：{}，
>      u'time': {u'0.0.3': u'2011-08-19T22:00:54.744Z'},
>      u'版本'：u'0.0.3'，
>      u'版本'：u'0.0.3'}
> ```

为我工作=）

开心！

# excel - 将 OOo 宏转换为 Excel 宏

> ID：176764
> 
> 赞同：2
> 
> 时间：2008-10-07T00:07:34.940
> 
> 标签：excel, openoffice.org, file-conversion

我有一个 OpenDocument 电子表格，其中包含 StarBasic/OOoBasic 中的宏，我想将其转换为 Excel 电子表格，并将 StarBasic 宏转换为 VBA。虽然 OpenOffice.org 声称能够将 VBA 宏转换为 StarBasic 并返回，但我尝试让 OOo 将这些原始 StarBasic 宏转换为 VBA 都失败了。

是否有任何保证方法可以将这些宏移动到 VBA 和 Excel，而无需完全重写它们？如果它们起源于那种形式，OOo 似乎只会将 StarBasic 宏转换为 VBA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T15:05:44.410

从 OpenOffice.org 3.0 开始，除了重写宏之外别无他法。幸运的是，VBA 和 StarBasic 非常相似，唯一需要做的工作就是更改应用程序文档模型。

# c# - C#：退出应用程序的非 Winforms 方式？

> ID：176771
> 
> 赞同：5
> 
> 时间：2008-10-07T00:13:30.873
> 
> 标签：c#, .net

我知道 Application.Exit() 但如果我不在 Windows 窗体应用程序中而是在一个简单的类库中，我如何发出信号让应用程序退出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T00:36:16.380

Environment.Exit()——但你为什么要从类库中的方法执行此操作？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T00:14:48.950

P/Invoke [ExitProcess](http://msdn.microsoft.com/en-us/library/ms682658(VS.85).aspx)，也许。或者，如果您真的很着急，[TerminateProcess](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx)。

# php - 从多个表中获取行作为单个结果？

> ID：176774
> 
> 赞同：1
> 
> 时间：2008-10-07T00:15:45.563
> 
> 标签：php, mysql

我有 2 张桌子。表 1 具有字段 A、B、C、D，表 2 具有字段 A、B。两个表的字段 A 和 B 具有相同的记录类型。我想从字段 A 和 B 的两个表中获取记录作为单个结果。

PHP+MySql 中是否有任何查询或函数？

谢谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T00:26:42.000

SQL中有一个联合子句可以满足您的要求：

```
select a,b from table1
    where <where-clause>
union all select a,b from table2
    where <where-clause> 
```

或者，如果您想要所有字段（table2 的空格）：

```
select a,b,c,d from table1
    where <where-clause>
union all select a,b,' ' as c,' ' as d from table2
    where <where-clause> 
```

第二个查询中的空格可能需要扩展以适应 c 和 d 的字段大小。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-07T00:18:09.023

我假设 MySql 这样做：

select a,b from table1 where your_criteria=test_value union select a,b from table2 where your_criteria=test_value

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-07T00:29:05.460

MySQL 服务器版本中确认的联合解决方案：5.0.51a-3ubuntu5.1 (Ubuntu)

```
create database foo;
create table bill(a int, b varchar(10));
create table ted(a int, b varchar(10), c datetime, d boolean);
insert into bill values (10, 'foo'), (20, 'bar');
insert into ted values (5, 'splot', now(), true), (10, 'splodge', now(), false);
select a,b from bill where a<=10 union select a,b from ted where a<=10;
+------+---------+
| a    | b       |
+------+---------+
|   10 | foo     |
|    5 | splot   |
|   10 | splodge |
+------+---------+ 
```

# c# - C#中的大整数

> ID：176775
> 
> 赞同：64
> 
> 时间：2008-10-07T00:16:09.243
> 
> 标签：c#, biginteger, largenumber, j#

目前我正在[从这里描述的 J# 库中](http://msdn.microsoft.com/en-us/magazine/cc163696.aspx)[借用`java.math.BigInteger`](http://msdn.microsoft.com/en-us/magazine/cc163696.aspx)。以前从未使用过处理大整数的库，这似乎很慢，大约慢了 10 倍，即使对于`ulong`长度数字也是如此。有没有人有更好的（最好是免费的）库，或者这种性能水平是否正常？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-27T19:06:08.720

从 .NET 4.0 开始，您可以使用 System.Numerics.BigInteger 类。请参阅此处的文档：http: [//msdn.microsoft.com/en-us/library/system.numerics.biginteger (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger(v=vs.110).aspx)

另一种选择是[IntX](https://github.com/devoyster/IntXLib)类。

> IntX 是用纯 C# 2.0 编写的任意精度整数库，具有快速 - O(N * log N) - 乘法/除法算法实现。它提供了整数的所有基本操作，如加法、乘法、比较、按位移位等。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-31T13:22:23.287

`F#`还附带一个。你可以在`Microsoft.FSharp.Math`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T17:48:05.223

.NET 4.0 中的`System.Numerics.BigInteger`类基于`Microsoft.SolverFoundation.Common.BigInteger`Microsoft Research。

Solver Foundation 的`BigInteger`类看起来非常高效。我不确定它是根据哪个许可证发布的，但您可以在[此处](http://code.msdn.microsoft.com/solverfoundation)获取它（下载并安装 Solver Foundation 并找到 Microsoft.Solver.Foundation.dll）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-07T00:33:45.293

我认为，如果您对 BigInts 执行所有操作，这些操作将在本机类型上返回小于本机类型（例如 int64）的结果，并且仅在您要溢出时处理大数组，我认为您可以优化实现。

**编辑**[codeproject 上的](http://www.codeproject.com/KB/cs/biginteger.aspx) 这个实现，似乎只慢了 7 倍......但是通过上面的优化，你可以让它执行几乎与小数字的本机类型相同。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-23T09:48:40.900

以下是 C# 中 BigInteger 的几个实现。我使用了 Mono 的 BigInteger 实现，运行速度非常快（我在 CompactFramework 中使用过）

[充气城堡](http://www.bouncycastle.org/csharp/BigInteger.cs)

[单核细胞增多症](https://svn.apache.org/repos/asf/incubator/heraldry/libraries/csharp/openid/trunk/Mono/Mono.Math/BigInteger.cs)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-07T00:20:52.887

我不确定性能，但 IronPython 也有一个 BigInteger 类。它位于 Microsoft.Scripting.Math 命名空间中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-07T00:23:35.393

是的，它会很慢，10 倍的差异是我所期望的。BigInt 使用数组来表示任意长度，所有操作都必须手动完成（与大多数可以直接用 CPU 完成的数学相反）

我什至不知道在汇编中手动编码是否会给你带来超过 10 倍的性能提升，这非常接近。我会寻找其他方法来优化它——有时取决于你的数学问题，你可以做一些小技巧来让它更快。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-07T00:29:04.617

我在以前的工作中使用[过 Biginteger](http://www.codeproject.com/KB/cs/biginteger.aspx)。我不知道你需要什么样的性能。我没有在性能密集型情况下使用它，但从来没有遇到任何问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-07T00:31:26.360

这听起来像是一个奇怪的建议，但是您是否测试过[十进制](http://msdn.microsoft.com/en-us/library/364x0z75(VS.80).aspx)类型以查看它的工作速度？

小数范围是±1.0 × 10^−28 到±7.9 × 10^28，所以可能还是不够大，但比ulong大。

.NET 3.5 中应该有一个 BigInteger 类，但[它被 cut 了](http://blogs.msdn.com/bclteam/archive/2008/01/04/where-did-biginteger-go-melitta-andersen.aspx)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-08T20:41:33.337

这对您没有帮助，但是 .Net 3.5 中应该有一个 BigInteger 类；它被删减了，但从 PDC 的声明来看，它将在 .Net 4.0 中。他们显然花了很多时间优化它，所以性能应该比你现在得到的要好得多。

此外，这个问题本质上是[如何在 .NET 中表示一个非常大的整数？](https://stackoverflow.com/questions/25375/how-can-i-represent-a-very-large-integer-in-net)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-10T20:28:47.073

请参阅此[线程](https://stackoverflow.com/questions/262025/how-do-you-do-maths-or-math-with-numbers-bigger-than-maxvalue-in-c)中的答案。您将需要使用可用的第三方大整数库/类之一，或者等待包含本机 BigInteger 数据类型的 C# 4.0。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-08-25T01:39:19.620

这看起来很有希望。它是[GMP](https://gmplib.org/)之上的 C# Wrapper 。

[http://web.rememberingemil.org/Projects/GnuMpDotNet/GnuMpDotNet.html](http://web.rememberingemil.org/Projects/GnuMpDotNet/GnuMpDotNet.html)

[.Net这里](http://blog.wezeku.com/2014/06/10/high-performance-large-integers-in-net/)还有其他 BigInteger 选项，特别是[Mpir.Net](http://wezeku.github.io/Mpir.NET/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-05-18T09:10:27.217

您还可以使用我编写的[Math.Gmp.Native](https://www.nuget.org/packages/Math.Gmp.Native.NET/) Nuget 包。其源代码可在[GitHub 上](https://github.com/MachineCognitis/Math.Gmp.Native/)获得，文档可[在此处](https://machinecognitis.github.io/Math.Gmp.Native/html/846f5c8a-6cba-433e-9f18-cde2ff5695cd.htm)获得。它向 .NET 公开了[GMP](https://gmplib.org/)库的所有功能，该库被称为高度优化的任意精度算术库。

任意精度整数由[mpz_t](https://machinecognitis.github.io/Math.Gmp.Native/html/8beda7fb-bbc4-b56f-fd1f-1459377ecb3b.htm)类型表示。对这些整数的操作都以前缀开头`mpz_`。例如，[mpz_add](https://machinecognitis.github.io/Math.Gmp.Native/html/acb6d3d4-70ad-58be-7cb8-9edb997204b3.htm)或[mpz_cmp](https://machinecognitis.github.io/Math.Gmp.Native/html/eea958f4-5951-38f2-05ba-3870cefb3842.htm)。每个操作都给出了源代码示例。

# c# - 需要 HttpWebRequest 对象的帮助

> ID：176777
> 
> 赞同：2
> 
> 时间：2008-10-07T00:16:44.050
> 
> 标签：c#, asp.net

我正在尝试为 .NET 构建代理模块，但在将标头从当前请求复制到新请求时遇到问题。我正在设置新请求的标头，因为我希望代理支持 SOAP 请求。这是我的代码的一部分。如果需要，我可以发布所有内容，但这是唯一与我遇到的问题相关的部分：

```
 HttpApplication app = (HttpApplication)sender;   // sender from context.BeginRequest event
HttpRequest crntReq = app.Request;  // set a reference to request object for easier access

HttpWebRequest proxyReq = (HttpWebRequest)HttpWebRequest.Create(crntReq.Url.AbsoluteUri);

// parse headers from current httpcontext.request.headers and add each name->value to the 
// new request object
foreach (string header in crntReq.Headers)
{    
    proxyReq.Headers.Add(header, crntReq.Headers[header]);      // throws exception :(                  
} 

```

当我的代码遇到 foreach 循环时，它会为 Headers.Add 函数引发异常。出于安全目的，我假设该集合具有访问限制。似乎某些标头值可以通过 HttpWebRequest 对象本身的属性访问。但是在这种情况下，我宁愿摆脱抽象并手动设置属性。我收到的例外是：
*{“必须使用适当的属性修改此标头。\r\n参数名称：名称”}*

* * *

在此先感谢您的帮助，

CJAM

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T00:22:16.860

一些标头实际上作为属性直接暴露在 HttpWebRequest 对象上。不允许您直接设置这些标头。例如 HttpWebRequest、ContentType 和 HttpWebRequest.UserAgent

您将需要直接更新这些属性并避免通过 Headers 属性设置它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T15:45:54.577

因此，我将您的回答理解为“无法明确设置集合”。我希望有一种方法可以将名称和值添加到 NameValueDictionary，但我想我只需要确定需要设置哪些字段并使用属性来访问特定的名称/值对象。我想我可以使用继承并推出我自己版本的 HttpWebRequest 对象，但我确信 Microsoft 的人员封装该集合是有原因的，所以我可能会保持原样。

感谢您对此的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T21:20:00.733

虽然这是一篇旧文章，但我最近需要为用 .NET 编写的 HTTP 代理执行此操作，以下是我在两个不同请求之间复制标头的方式。欢迎反馈，我希望它对某人有所帮助。

```
static void CopyHeaders (HttpRequest sourceRequest, HttpWebRequest targetRequest) {
    foreach (string key in sourceRequest.Headers) {
        var value = sourceRequest.Headers[key];
        object objectValue = value;
        var propName = key.Replace("-", string.Empty);
        switch (key) {
            case "Host":
            case "Content-Length":
                // Do not propogate Host and Content-Length.
                continue;
            case "Connection":
                // Cannot set the following values ...
                if (value == "Keep-Alive" || value == "Close") {
                    continue;
                }
                break;
            case "If-Modified-Since":
                objectValue = DateTime.Parse(value);
                break;
        }
        var prop = targetRequest.GetType().GetProperty(propName, BindingFlags.Public | BindingFlags.Instance);
        if (null != prop && prop.CanWrite) {
            prop.SetValue(targetRequest, objectValue, null);
        } else {
            targetRequest.Headers[key] = Convert.ToString(value);
        }
    }
} 
```

# wpf - 自动完成下拉菜单 - 数据过多，超时

> ID：176782
> 
> 赞同：2
> 
> 时间：2008-10-07T00:20:07.020
> 
> 标签：wpf, ajax, .net-3.5, wsdl

所以，我有一个带有乡镇列表的自动完成下拉列表。最初我只有数据库中的 20 个左右……但最近，我们注意到我们的一些数据位于其他县……甚至其他州。因此，答案是购买美国所有城镇的数据库之一（是的，我知道，地理编码是答案，但由于时间限制，我们会这样做，直到我们有时间使用该功能）。

因此，当我们有 20-25 个城镇时，自动完成功能非常出色……现在有 80,000 个城镇，这并不容易。

当我打字时，我认为最好的方法是默认为这种状态，那么就会少得多。我将在默认为 NJ 的页面上添加一个状态选择器，然后您可以根据需要选择另一个状态，这会将列表缩小到 < 1000。不过，我可能有同样的问题？有谁知道使用大量数据自动完成的工作？

我应该发布我的网络服务的代码吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-07T00:26:09.957

您是否尝试在仅输入 1 个字符后自动完成？也许等到2个或更多......？

另外，你可以只返回前 10 行吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T00:27:08.287

听起来您的应用程序因返回的数据量而窒息，然后尝试由浏览器呈现。

我假设您的数据库具有正确的索引，并且您在那里没有性能问题。

我会将您的服务结果限制为不超过 100 个结果。用户不会再看任何其他方法。

一旦输入 2 或 3 个字符，我也只会从服务中检索数据，这将进一步缩小查询范围。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T00:26:10.940

可能是愚蠢的问题，但是...您是否检查过以确保您在城镇名称列上有索引？我不认为 80K 名字应该给你的数据库带来压力......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T00:28:57.300

我认为你在正确的轨道上。使用一系列级联输入，州 -> 县 -> 乡镇，其中每个后续输入根据前一个的值获取潜在人口。每个输入都将根据其潜在人口进行验证，以避免虚假输入。我建议缓存中间结果并针对它们进行查询以进行自动完成，而不是每次都返回数据库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T00:43:40.017

如果您可以控制底层 SQL，您可能需要尝试多个“UNION”查询，而不是一个在 where 子句中包含多个“OR like”行的查询。

查看[这篇](http://www.bcarter.com/optimsql.htm)关于优化 SQL 的文章。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T03:58:42.400

我只是用一个 TOP 子句来限制 SQL 查询。我也喜欢使用“小于”而不是类似：

```
select top 10 name from cities where @partialname < name order by name; 
```

那个“Ce”会给你“Cedar Grove”和“Cedar Knolls”，还有“Chatham”和“Cherry Hill”，所以你总是得到十个。

在 LINQ 中：

```
var q = (from c in db.Cities
        where partialname < c.Name
        orderby c.Name
        select c.Name).Take(10); 
```

# css - 如何以编程方式修改 CSS 文件？

> ID：176791
> 
> 赞同：0
> 
> 时间：2008-10-07T00:24:23.720
> 
> 标签：css, dom, vb6

我有一个遗留应用程序，我需要实现一个配置页面来更改文本颜色、字体等。

该应用程序的输出也可以通过 PHP Web 应用程序进行复制，其中字体、颜色等在样式表中进行配置。

我以前没有使用过 CSS。

是否有一种编程方式来修改 CSS 并保存它而不求助于字符串解析或正则表达式？

该应用程序是 VB6，但如果这是唯一的方法，我可以编写一个 .net 工具来执行 css 操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T00:26:59.177

您不需要编辑现有的。你可以有一个新的覆盖另一个——你在你的 HTML 中一个接一个地包含这个。这就是“级联”的意思。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T00:26:45.057

看起来有人已经完成了一个 VB.NET CSS 解析器，它是 F/OSS，所以如果您对许可证感到满意，您可能可以根据您的需要调整它。

[http://vbcssparser.sourceforge.net/](http://vbcssparser.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T00:27:43.153

根据您的 CSS 编辑器的技术导向程度，您可以非常简单地通过将整个内容加载到 TextEdit 字段中让他们对其进行编辑 - 然后将其写回文件中。

为 CSS 的所有可能性解析和创建接口将是天文数字般的痛苦。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T00:27:44.120

一种技巧是创建一个所有输出都通过的 PHP 脚本，然后用可配置的替代方案替换 CSS 的某些部分。如果您使用 .htaccess，您可以使所有输出都通过脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T00:34:10.457

我能想到的解决这个问题的最好方法是创建一个应用程序，它将获取一些值（通过 URL 查询）并基于 css 模板生成适当的 css 输出

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T18:29:09.193

检查[一下](http://www.codeproject.com/KB/aspnet/ASPNET_Dynamic_Styling.aspx)，它使用 ASP.NET 和 C#。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T01:44:30.970

也许对于程序员和用户来说最简单的问题的解决方案是通过 html 表单编辑 css，也许。我想，创建 css 文件，这将是这个应用程序的“默认”或“标准”，并且只是为了读取它，例如，通过 perl 脚本，在 html 中编辑并写下来。这里只是一个简单的例子。

在 css 文件中，我们有如下字符串：

```
border-color: #008a77; 
```

我们必须读取这个字符串，将其拆分，然后发送到一个文件，该文件会将其写下来。在 Perl 中得到这样的东西：

```
tr/ / /s;
($vari, $value) = split(/:/, _$);
# # While you read file, you can just at the time to put this into html form
echo($vari.":<input type = text name = ".$vari." value = ".$value.">"); 
```

在这里，你只有简单的 html-form-data，你应该用这样的新数据覆盖你的 css 文件：

```
...
print $vari[i].": ".$value.";\n";
... 
```

瞧——你有改变css的编程方式。当然，你必须让它更通用，更接近你的特定问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T01:02:16.297

在我使用 IE 控件 (shadocvw.dll) 的工作中，它有一个有趣的功能，可以让您轻松管理页面的 CSS，并在页面上实时显示修改后的 CSS 效果。我自己从未处理过此类实现的细节，但我建议将其作为一个值得研究的可能解决方案。看到现在几乎每个人都在使用 IE 6 或更高版本，您可以跳过有关处理仅安装了 IE 5、4、3 或 2 的人的说明。

# web-crawler - 什么是好的网络爬虫工具

> ID：176820
> 
> 赞同：16
> 
> 时间：2008-10-07T00:37:54.147
> 
> 标签：web-crawler, robot

我需要索引很多网页，有什么好的网络爬虫工具？我更喜欢 .NET 可以与之交谈的东西，但这不是一个引人注目的东西。

我真正需要的是可以提供网站网址的东西，它会跟随每个链接并存储用于索引的内容。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-07T00:45:59.357

HTTrack -- [http://www.httrack.com/](http://www.httrack.com/) -- 是一个非常好的网站复制器。效果很好。已经使用了很长时间了。

Nutch 是一个网络爬虫（爬虫是您正在寻找的程序类型） ——http: [//lucene.apache.org/nutch/——](http://lucene.apache.org/nutch/)它使用一流的搜索实用程序 lucene。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T01:07:34.907

[Crawler4j](http://code.google.com/p/crawler4j/)是一个开源的 Java 爬虫，它提供了一个简单的 Web 爬虫界面。您可以在 5 分钟内设置一个多线程网络爬虫。

您可以设置自己的过滤器来访问或不访问页面（url），并根据您的逻辑为每个爬取的页面定义一些操作。

**选择 crawler4j 的一些理由；**

1.  多线程结构，
2.  您可以设置要抓取的深度，
3.  它是基于 Java 和开源的，
4.  控制冗余链接（url），
5.  您可以设置要抓取的页面数，
6.  您可以设置要抓取的页面大小，
7.  足够的文档

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T01:13:31.063

[Searcharoo.NET](http://Searcharoo.net)包含一个爬取和索引内容的蜘蛛，以及一个使用它的搜索引擎。您应该能够找到解决 Searcharoo.Indexer.EXE 代码的方法，以便在下载内容时捕获内容，并从那里添加您自己的自定义代码...

这是非常基础的（包括所有源代码，并在六篇 CodeProject 文章中进行了解释，其中最新的是[Searcharoo v6](http://www.codeproject.com/KB/IP/Searcharoo_6.aspx)）：蜘蛛跟随链接、图像映射、图像，服从 ROBOTS 指令，解析一些非 HTML 文件类型. 它适用于单个网站（而不是整个网络）。

Nutch/Lucene 几乎可以肯定是一个更强大/商业级的解决方案——但我没有看过他们的代码。不确定您想要完成什么，但您是否也看过[Microsoft Search Server Express](http://www.microsoft.com/enterprisesearch/serverproducts/searchserverexpress/default.aspx)？

免责声明：我是 Searcharoo 的作者；只是在这里提供它作为一个选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T00:42:40.767

[蜘蛛侠](http://www.sphider.eu/)还不错。它是 PHP，但它可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-25T01:05:41.700

我使用[Mozenda 的 Web Scraping 软件](http://www.mozenda.com)。您可以轻松地让它抓取所有链接并获取您需要的所有信息，这是一款物超所值的软件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T00:52:32.837

我还没用过这个，但这[看起来](http://www.vsj.co.uk/dotnet/display.asp?id=407)很有趣。作者从头开始编写并发布了他是如何做到的。它的代码也可以下载。

# vb6 - 如何从 VSS 中检出所有 VB6 项目文件？

> ID：176822
> 
> 赞同：0
> 
> 时间：2008-10-07T00:38:44.177
> 
> 标签：vb6, visual-sourcesafe

我在 Visual Source Safe 6.0 中有一个 VB6 项目。当我打开项目时，我想签出（获取）项目中的所有文件，以便我可以编辑它们。

我将 VSS 选项（在 VB6 中）设置为递归地作用于项目，但是当我签出 project.vbp 时，它只签出项目文件，而不是所有模块等。这些文件都保持写保护，直到我单独检查每一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T00:40:28.417

**解决方案**：选择*Project.vbp*，然后从 Tool>SourceSafe 菜单中选择 Check Out，您会看到一个对话框，让您选择所有文件（您会看到每个文件的复选框和 Select All 的按钮）。

**为什么我有问题**

出于某种原因，如果您*右键单击*项目树中的项目并选择“签出”，它不会为您提供该对话框。它只是检查项目文件。（但是，如果您执行相同的操作并签入，它会为您提供包含每个文件的复选框的对话框。我想这点它*知道*您有多个文件要签入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T15:18:30.297

FWIW 一般而言，与从右键单击上下文菜单中选择“签出”相比，通过“工具”菜单选择“签出...”时，您可以获得更多选项。更有用的“高级”选项之一是在不“获取”（即替换）本地文件的情况下签出。

# asp.net - 禁用回发

> ID：176827
> 
> 赞同：63
> 
> 时间：2008-10-07T00:41:48.087
> 
> 标签：asp.net, asplinkbutton

我的表单上有一个 ASP.NET 链接按钮控件。我想将它用于客户端的 javascript 并防止它回发到服务器。（我想使用 linkbutton 控件，以便在某些情况下对它进行蒙皮并禁用它，因此不建议使用直接向上的标签）。

如何防止它回发到服务器？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-10-07T01:21:17.303

ASP 代码：

```
<asp:LinkButton ID="someID" runat="server" Text="clicky"></asp:LinkButton> 
```

后面的代码：

```
public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        someID.Attributes.Add("onClick", "return false;");
    }
} 
```

呈现为 HTML 的内容是：

```
<a onclick="return false;" id="someID" href="javascript:__doPostBack('someID','')">clicky</a> 
```

在这种情况下，onclick 功能会成为您的验证器。如果为false，则不执行“href”链接；但是，如果它是真的 href 将被执行。这消除了您的回帖。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-10-07T02:05:08.993

这听起来可能是一个无益的答案......但是为什么您将 LinkBut​​ton 用于纯粹的客户端？使用标准的 HTML 锚标记并将其`onclick`操作设置为您的 Javascript。

如果您需要服务器生成该链接的文本，则使用 an`asp:Label`作为锚点的开始和结束标记之间的内容。

如果您需要根据服务器端代码动态更改脚本行为，请考虑`asp:Literal`作为一种技术。

但是，除非您从 LinkBut​​ton 的 Click 事件执行服务器端活动，否则在这里使用它似乎没有多大意义。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2011-02-01T20:06:19.350

你也可以

```
...LinkButton ID="BtnForgotPassword" runat="server" OnClientClick="ChangeText('1');**return false"**...
```

它停止链接按钮回发

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-05-11T23:07:54.113

只需设置 href="#"

```
<asp:LinkButton ID="myLink" runat="server" href="#">Click Me</asp:LinkButton> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-07T02:08:41.687

我认为您应该使用 HyperLink 控件进行调查。它是一个服务器端控件（因此您可以从代码中操纵可见性等），但它省略了常规的 ol' 锚标记并且不会导致回发。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-09-28T15:18:21.840

刚刚经历过这个，正确的方法是使用：

1.  `OnClientClick`
2.  `return false`

如以下示例代码行所示：

```
<asp:LinkButton ID="lbtnNext" runat="server" OnClientClick="findAllOccurences(); return false;" /> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-07T00:43:32.060

在 C# 中，你会做这样的事情：

```
MyButton.Attributes.Add("onclick", "put your javascript here including... return false;"); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-10-19T16:04:14.790

而不是实现属性：

```
public partial class _Default : System.Web.UI.Page{
 protected void Page_Load(object sender, EventArgs e)
 {
    someID.Attributes.Add("onClick", "return false;");
 }} 
```

采用：

```
OnClientClick="return false;" 
```

在 asp:LinkBut​​ton 标记内

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-10-16T07:16:06.227

为避免刷新页面，如果`return false`不`asp:LinkButton`使用

```
href="javascript: void;" 
```

或者

```
href="#" 
```

随着`OnClientClick="return false;"`

```
<asp:LinkButton ID="linkPrint" runat="server" CausesValidation="False" href="javascript: void;"
        OnClientClick="javascript:self.print();return false;">Print</asp:LinkButton> 
```

以上代码将调用浏览器打印而不刷新页面。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-09-28T12:16:00.000

在 onclick 事件上调用 java 脚本函数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-05-19T16:01:13.557

你试过用`OnClientClick`吗？

```
var myLinkButton = new LinkButton { Text = "Click Here", OnClientClick = "JavaScript: return false;" };

<asp:LinkButton ID="someID" runat="server" Text="clicky" OnClientClick="JavaScript: return false;"></asp:LinkButton> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-11-08T16:25:40.823

如果您想保留滚动位置，您可以做的其他事情是：

```
<asp:LinkButton runat="server" id="someId" href="javascript: void;" Text="Click Me" /> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-11T13:49:57.547

似乎没有人这样做：

```
createEventLinkButton.Attributes.Add("onClick", " if (this.innerHTML == 'Please Wait') { return false; } else {  this.innerHTML='Please Wait'; }"); 
```

这似乎是唯一可行的方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-05-08T18:26:46.333

为什么不使用一个空的 ajax 更新面板并将链接按钮的点击事件连接到它呢？这样，只有更新面板会得到更新，从而避免回发并允许您运行 javascript

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-01-29T19:57:14.497

在 jquery 就绪函数中，您可以执行以下操作 -

```
var hrefcode = $('a[id*=linkbutton]').attr('href').split(':');
var onclickcode = "javascript: if`(Condition()) {" + hrefcode[1] + ";}";
$('a[id*=linkbutton]').attr('href', onclickcode); 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-10-07T00:51:06.833

您可能还希望客户端函数返回 false。

```
<asp:LinkButton runat="server" id="button" Text="Click Me" OnClick="myfunction();return false;" AutoPostBack="false" /> 
```

您还可以考虑：

```
<span runat="server" id="clickableSpan" onclick="myfunction();" class="clickable">Click Me</span> 
```

我使用可点击类来设置指针、颜色等内容，使其外观类似于锚标记，但我不必担心它会被回发或必须执行 href="javascript:void (0);" 诡计。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2010-12-22T07:25:14.167

使用 html 链接而不是 asp 链接，您可以在 html 链接之间使用标签进行服务器端控制

# asp.net - 使用 Javascript 重新居中模态弹出窗口

> ID：176831
> 
> 赞同：6
> 
> 时间：2008-10-07T00:44:01.467
> 
> 标签：asp.net, javascript

我有一个模式弹出窗口，它最初显示一些内容，但如果选中了一个复选框，则会展开一个 div。除非您向上或向下滚动，否则模式会正确扩展但不会重新定位。是否有一个 javascript 事件可以附加到我的 javascript 函数以重新定位整个模态？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T23:17:55.883

这是什么：

```
$find('ModalPopupExtenderClientID')._layout(); 
```

例如：

```
$find('detailsPopUpExtenderId')._layout(); 
```

在 aspx 中：

```
<ccl:ModalPopupExtender runat="server" ID="MyPopUpExtender" TargetControlID="pop" PopupControlID="PopUp" BehaviorID="detailsPopUpExtenderId" BackgroundCssClass="ModalBackground" /> 
```

`BehaviorID`是设置客户端 ID 的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T17:03:11.740

请注意，这与窗口的调整大小事件无关。如果是这样，您的重新定位可能会触发 IE 中的调整大小事件，这将导致无限循环。

如果它与 resize 事件相关，则允许发生 1 或 2 个 resize 事件，然后忽略其余事件。（我说 2，因为在 IE 中，窗口上的“恢复”事件将触发至少 2 个调整大小事件（在 IE6 中为 3 个）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T00:47:49.383

无论您绑定到滚动以使其重新居中的任何事件，都将该事件绑定到复选框/div 扩展事件（或从另一个事件中调用它）。没有看到一些代码很难说更多。

# asp.net - 如何打破 ASP.NET 中未处理的异常？

> ID：176839
> 
> 赞同：15
> 
> 时间：2008-10-07T00:48:34.077
> 
> 标签：asp.net, visual-studio, debugging

在 Visual Studio 中调试应用程序时，有 2 个选项可用于中断异常。抛出异常时立即中断，仅在未捕获异常时才中断。这在开发桌面应用程序时效果很好。但是，在开发 ASP.NET 应用程序时，所有异常最终都会被 IIS 中的代码捕获。是否可以禁用此行为，以便当我的 ASP.Net 应用程序代码无法捕获异常时调试器中断？

* * *

### 编辑：

为了清楚起见，我不想在抛出异常时中断，因为很多时候它们都被我的代码处理得很好，而且我不想在每个异常上都停下来。我只想停止我的代码未处理的异常。

* * *

### 编辑：

这在 Visual Studio 2008 中似乎不是问题。在 Visual Studio 2003 中，所有异常都被视为用户处理，因为 ASP.NET 运行时捕获了所有异常，以免关闭 Web 服务器进程。似乎在 Visual Studio 2008 中，这种类型的异常捕获在检查用户未处理的异常时不会被计算在内。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-07T02:14:10.800

在 Debug->Exceptions 下，检查 Common Language Runtime Exceptions 的“Thrown”列（至少）。检查“抛出”以获取您感兴趣的其他异常。

现在，如果附加了调试器（活动调试或“附加到进程”），您的 ASP.NET 应用程序将因 CLR 异常（或您选择的任何其他异常）而中断。

[编辑]

如果您只想中断未处理**的**异常，请在 Debug->Exceptions 下，取消选中所有异常类型的“Thrown”，并确保为您感兴趣的异常检查“User-unhandled”。

![异常接口](https://i.stack.imgur.com/9O5E7.png)

然后，如果附加了调试器，您的 ASP.NET 应用程序将在您选择的每个用户未处理的异常上中断，而不管运行时最终会捕获异常的事实。样本：

![调试器中断用户未处理的异常](https://i.stack.imgur.com/lPrSs.png)

# scripting - Nano hacks：您编写或遇到的最有用的小程序

> ID：176840
> 
> 赞同：10
> 
> 时间：2008-10-07T00:49:17.120
> 
> 标签：scripting, automation

这是程序员的第一[大美德](http://oreilly.com/catalog/opensources/book/larry.html)。我们所有人都曾在某个时间或另一个时候使用一些一次性代码自动完成一项任务。有时需要几秒钟才能完成一个单行，有时我们会花费大量时间自动完成一个两秒钟的任务，然后再也不使用它了。

您发现哪些小技巧足以**重复使用**？竟然给自己起了个别名？

注意：在回答之前，请检查以确保它不在使用 BASH或 perl/ruby 单行问题的[常用命令行技巧中。](https://stackoverflow.com/questions/68372/what-is-your-single-most-favorite-command-line-trick-using-bash)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-07T02:19:15.830

我今天在 dotfiles.org 上发现了这个。这很简单，但很聪明。我自己没有想到这一点而感到愚蠢。

```
###
###   Handy Extract Program
###
extract () {
     if [ -f $1 ] ; then
         case $1 in
             *.tar.bz2)   tar xvjf $1        ;;
             *.tar.gz)    tar xvzf $1     ;;
             *.bz2)       bunzip2 $1       ;;
             *.rar)       unrar x $1     ;;
             *.gz)        gunzip $1     ;;
             *.tar)       tar xvf $1        ;;
             *.tbz2)      tar xvjf $1      ;;
             *.tgz)       tar xvzf $1       ;;
             *.zip)       unzip $1     ;;
             *.Z)         uncompress $1  ;;
             *.7z)        7z x $1    ;;
             *)           echo "'$1' cannot be extracted via >extract<" ;;
         esac
    else
         echo "'$1' is not a valid file"
    fi
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T03:17:03.670

这是一个过滤器，它将逗号放在标准输入中任何大数字的中间。

```
$ cat ~/bin/comma
#!/usr/bin/perl -p

s/(\d{4,})/commify($1)/ge;

sub commify {
    local $_  = shift;
    1 while s/^([ -+]?\d+)(\d{3})/$1,$2/;
    return $_;
} 
```

我通常最终将它用于大数字的长输出列表，并且我厌倦了计算小数位。现在而不是看到

```
-rw-r--r--   1 alester alester 2244487404 Oct  6 15:38 listdetail.sql 
```

我可以运行它`ls -l | comma`并查看

```
-rw-r--r--   1 alester alester 2,244,487,404 Oct  6 15:38 listdetail.sql 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T16:12:27.923

**这个脚本拯救了我的职业生涯！**

几年前，我在一个客户端数据库上远程工作。我更新了一个货件以更改其状态。但是我忘记了 where 子句。

当我看到（6834 行受影响）时，我永远不会忘记胃里的感觉。我基本上整晚都在查看事件日志并找出所有这些货物的正确状态。***废话！***

所以我写了一个脚本（最初在 awk 中），它会启动一个事务以进行任何更新，并在提交之前检查受影响的行。这避免了任何意外。

所以现在我从来没有在不通过这样的脚本的情况下从命令行进行更新。这是（现在在 Python 中）：

```
import sys
import subprocess as sp
pgm = "isql"
if  len(sys.argv) == 1:
    print "Usage: \nsql sql-string [rows-affected]"
    sys.exit()
sql_str = sys.argv[1].upper()
max_rows_affected = 3
if len(sys.argv) > 2:
    max_rows_affected = int(sys.argv[2])

if sql_str.startswith("UPDATE"):
    sql_str = "BEGIN TRANSACTION\\n" + sql_str
    p1 = sp.Popen([pgm, sql_str],stdout=sp.PIPE,
            shell=True)
    (stdout, stderr) = p1.communicate()
    print  stdout
    # example -> (33 rows affected)
    affected = stdout.splitlines()[-1]
    affected = affected.split()[0].lstrip('(')
    num_affected = int(affected)
    if num_affected > max_rows_affected:
        print "WARNING! ", num_affected,"rows were affected, rolling back..."
        sql_str = "ROLLBACK TRANSACTION"
        ret_code = sp.call([pgm, sql_str], shell=True)
    else:
        sql_str = "COMMIT TRANSACTION"
        ret_code = sp.call([pgm, sql_str], shell=True)
else:
    ret_code = sp.call([pgm, sql_str], shell=True) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T01:46:02.247

我在各种 linuxes 下使用这个脚本来检查机器之间（或到 CD/DVD）之间的目录复制是否有效，或者复制（例如 ext3 utf8 文件名 -> fusebl k）是否在文件名中损坏了特殊字符。

```
#!/bin/bash
##  dsum Do checksums recursively over a directory.
##  Typical usage: dsum <directory>  > outfile

export LC_ALL=C  # Optional - use sort order across different locales

if [ $# != 1 ]; then echo "Usage: ${0/*\//} <directory>" 1>&2; exit; fi
cd $1 1>&2 || exit
#findargs=-follow    # Uncomment to follow symbolic links
find . $findargs -type f | sort | xargs -d'\n' cksum 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T00:51:50.500

抱歉，手头没有确切的代码，但我编写了一个正则表达式，用于在 VS.Net 中搜索源代码，它允许我搜索评论中没有的任何内容。它在我正在从事的一个特定项目中非常有用，人们坚持认为注释掉代码是一种很好的做法，以防你想回去看看代码过去做了什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T01:45:35.523

我有两个 ruby​​ 脚本，我会定期修改它们以下载所有各种网络漫画。非常方便！ *注意：它们需要 wget，所以可能需要 linux。* *注意2：在尝试之前阅读这些内容，它们需要对每个站点进行一些修改。*

基于日期的下载器：

```
#!/usr/bin/ruby -w

Day = 60 * 60 * 24

Fromat = "hjlsdahjsd/comics/st%Y%m%d.gif"

t = Time.local(2005, 2, 5)

MWF = [1,3,5]

until t == Time.local(2007, 7, 9)
  if MWF.include? t.wday
    `wget #{t.strftime(Fromat)}`
    sleep 3
  end

  t += Day
end 
```

或者您可以使用基于数字的：

```
#!/usr/bin/ruby -w

Fromat = "http://fdsafdsa/comics/%08d.gif"
1.upto(986) do |i|
  `wget #{sprintf(Fromat, i)}`
  sleep 1
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T15:46:46.667

我不必在 SQL 查询分析器中反复打开文件并运行它们，而是找到了制作批处理文件所需的语法，然后可以一次运行 100 个。哦，甜蜜的喜悦！从那以后我就一直用这个。

```
isqlw -S servername -d dbname -E -i F:\blah\whatever.sql -o F:\results.txt 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-02T10:50:46.103

在整个工作日中，我不断地从自己的桌面连接到各种 linux 服务器，因此我创建了一些别名，它们将`xterm`在这些机器上启动并设置标题、背景颜色和其他调整：

```
alias  x="xterm"         # local
alias xd="ssh -Xf me@development_host xterm -bg aliceblue -ls -sb -bc -geometry 100x30 -title Development"
alias xp="ssh -Xf me@production_host  xterm -bg thistle1 ..." 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T02:07:30.057

我也有很多我经常连接的服务器，但它们都在我的本地网络上。这个 Ruby 脚本打印出为任何打开 ssh 的机器创建别名的命令：

```
#!/usr/bin/env ruby

require 'rubygems'
require 'dnssd'

handle = DNSSD.browse('_ssh._tcp') do |reply|
  print "alias #{reply.name}='ssh #{reply.name}.#{reply.domain}';"
end

sleep 1
handle.stop 
```

在你的`.bash_profile`：

```
eval `ruby ~/.alias_shares`

```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T00:56:24.483

这可以追溯到我的 COBOL 时代，但我有两个通用的 COBOL 程序，一批和一个在线（大型机人员会知道这些是什么）。它们是一个程序的外壳，可以采用任何一组参数和/或文件，并在 IMS 测试区域中运行、批处理或执行。我对它们进行了设置，以便根据参数我可以访问文件、数据库（DB2 或 IMS DB），或者只是操作工作存储或其他任何东西。

这很棒，因为我可以测试该日期函数，而无需猜测或测试为什么会出现截断或为什么会出现数据库 ABEND。随着时间的推移，这些程序的规模越来越大，包括各种测试，并成为开发组的主要内容。每个人都知道代码所在的位置，并将它们包含在他们的单元测试中。这些程序变得如此庞大（大部分代码都被注释掉了测试），而且这些都是多年来人们贡献的。他们节省了这么多时间，解决了这么多分歧！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-07T01:03:45.060

我编写了一个 Perl 脚本来映射依赖关系，而没有进入无限循环，对于我继承的遗留 C 程序......它也有一个菱形依赖问题。

我写了一个小程序，当我收到朋友的电子邮件时，它会在一个很少使用的电子邮件帐户上给我发电子邮件。

我写了另一个小程序，如果我的家庭 IP 发生变化，它会向我发送短信。

仅举几例。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-07T01:11:19.773

多年前，我在 PERL 的自定义 Web 应用程序平台上构建了一套应用程序。一个很酷的功能是将 SQL 查询字符串转换为人类可读的句子，描述结果是什么。

代码相对较短，但最终效果很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-07T01:26:14.173

我有一个你运行的小应用程序，它将 GUID 转储到剪贴板。您可以运行它 /noui 或不运行它。使用 UI，它是一个按钮，每次单击它时都会丢弃一个新的 GUID。没有它会丢弃一个新的然后退出。

我主要在 VS 中使用它。我将它作为外部应用程序并映射到快捷方式。我正在编写一个严重依赖 xaml 和 guid 的应用程序，所以我总是发现我需要将新的 guid 粘贴到 xaml 中......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-07T01:52:14.403

任何时候我写一个聪明的列表理解或在 python 中使用 map/reduce。有一个这样的：

```
if reduce(lambda x, c: locks[x] and c, locknames, True):
    print "Sub-threads terminated!" 
```

我记得的原因是我自己想出了它，然后在别人的网站上看到了完全相同的代码。现在，它可能会像这样完成：

```
if all(map(lambda z: locks[z], locknames)):
    print "ya trik" 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-07T03:49:37.613

我有 20 或 30 个这样的东西，因为一旦我在 Windows 中为我的标准控制台应用程序编写框架，我几乎可以放入任何我想要的逻辑，所以我得到了很多解决特定问题的这些小东西.

我想我现在经常使用的是一个控制台应用程序，它采用标准输入并根据将正则表达式与颜色匹配的 xml 配置文件对输出进行着色。我用它来查看构建中的日志文件。另一个是命令行启动器，因此我不会污染我的 PATH 环境变量，并且无论如何它都会超过某些系统的限制，即 win2k。

# nunit - 未找到 NUnit 程序集

> ID：176850
> 
> 赞同：20
> 
> 时间：2008-10-07T00:56:36.293
> 
> 标签：nunit

我以前用过 NUnit，但没用过一段时间，也从来没有在这台机器上用过。我在 2.4.8 下解压缩了 2.4.8 版本`Program Files`，尝试加载测试时不断收到此错误。

> 无法加载文件或程序集 'nunit.framework, Version=2.4.8.0, Culture=neutral, PublicKeyToken=96d09a1eb7f44a77' 或其依赖项之一。该系统找不到指定的文件**

为了简化问题，我编译了最基本的可能测试文件。

```
using NUnit.Framework;

namespace test
{
    [TestFixture]
    public class Tester
    {
        [Test]
        public void ATest()
        {
            Assert.IsTrue(false, "At least the test ran!");
        }
    }
} 
```

我已将“C:\Program Files\NUnit-2.4.8-net-2.0\bin”添加到我的 PATH（并重新启动）。请注意，如果我将测试程序集复制到该文件夹​​中，那么

```
C:\Program Files\NUnit-2.4.8-net-2.0\bin>nunit-console test.dll

```

有效，但是

```
C:\Program Files\NUnit-2.4.8-net-2.0\bin>nunit-console c:\dev\nunit_test\test.dll

```

和

```
C:\dev\nunit_test>nunit_console test.dll

```

因上述错误而失败。

大概我可以通过将 NUnit.Framework DLL 文件复制到我的项目`bin`文件夹中来解决这个问题，但我不记得过去必须这样做。此外，我在 GUI 中遇到了同样的错误。GUI 不应该知道框架的位置（即在同一个文件夹中）吗？

我没有使用 Visual Studio。我使用以下行来编译测试项目。

```
%windir%\Microsoft.NET\Framework\v2.0.50727\csc.exe /r:"C:\Program Files\NUnit-2.4.8-net-2.0\bin\nunit.framework.dll" /t:library /出：test.dll test.cs

```

我尝试了 .msi 和 .zip 文件，结果相同。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-07T01:02:54.703

确保您已添加对 nunit.framework 的引用。如果有，请确保该引用的属性将复制本地属性设置为 true。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-27T01:20:58.603

我有同样的问题，我使用 NUnit-2.4.8-net-2.0.msi 安装。扩展[“添加到 GAC”评论](https://stackoverflow.com/questions/176850/nunit-assembly-not-found/176862#176862)，这就是我所做的：

*   打开您的“Visual Studio 命令提示符（通常：确保 gacutil 在您的路径中）和：cd "C:\Program Files\NUnit 2.4.8\bin"

*   从 GAC 注销您的 NUnit 条目。您可以通过查找在 GAC 中注册的 NUnit 条目来执行此操作：

    ```
    gacutil /l | find /i "nunit" > temp.bat && notepad temp.bat 
    ```

*   在 nunit.core 和 nunit.framework 行前加上“gacutil /uf”，即：

    ```
    gacutil /uf nunit.core,Version=2.4.2.0,Culture=neutral,PublicKeyToken=96d09a1eb7f44a77

    gacutil /uf  nunit.framework,Version=2.4.2.0,Culture=neutral,PublicKeyToken=96d09a1eb7f44a77 
    ```

*   运行您的 .bat 文件以删除它们： `temp.bat`

*   注册您需要的 NUnit DLL 文件：

    ```
    gacutil /i nunit.core.dll

    gacutil /i nunit.framework.dll 
    ```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-07T01:05:05.947

如果您使用 NUnit-2.4.8-net-2.0.msi 安装，NUnit 程序集将添加到[GAC](http://en.wikipedia.org/wiki/Global_Assembly_Cache)中。

您还可以通过从 Visual Studio 2005 命令提示符运行 gacutil 手动重新安装。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-18T19:34:06.370

请注意，当前的 NUnit 安装 (2.5.10) 不会在 GAC 中自动注册。

如果您必须使用 GAC，请通过`gacutil /i <nunitframeworkpath>`where `nunitframeworkpath`is 通常注册它`%Program Files%\NUnit\net-2.0\framework\nunit-framework`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-19T17:05:55.803

今天，当我尝试将新的测试程序集添加到现有的 NUnit 测试项目时，我收到了此错误消息。似乎我的测试项目对相同的 nunit.framework.dll 程序集有多个路径引用。

如果您的 NUnit 项目中有多个测试程序集，您可能需要在测试项目中验证 nunit.framework 引用的 Path 属性。一旦我使它们匹配，错误消息就消失了。

# sql-server-2005 - 无法打开用户默认数据库。登录失败。SQL 2005

> ID：176851
> 
> 赞同：1
> 
> 时间：2008-10-07T00:59:35.927
> 
> 标签：sql-server-2005, sql-server-2000

我带了一份数据库副本回家，以便进行一些测试。但是，当我尝试运行存储过程时，我得到无法打开用户默认数据库。登录失败..

我已经检查并检查了我可以在数据库中打开表登录到 sql management studio 并访问默认数据库以及其他数据库有什么想法吗？

可能是一个损坏的用户，它是从工作中的 sql 2000 到家里的 2005

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T01:05:26.680

**编辑：**我的时间是从 2005 年到 2005 年。不确定这是否适用于您的情况...

我有一个类似的问题。对我来说，当我分离或创建备份然后重新创建数据库时，它会失去与用户的连接。我一直在使用的用户在登录下仍然存在，但它将无法登录。

就我而言，我可以通过删除数据库 -> 安全 -> 用户下的用户而不是根 sql server 用户列表中的用户来登录。

然后转到root用户列表并重新分配数据库映射或如果不存在则创建用户。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T01:26:22.957

这是在黑暗中拍摄的，所以如果它只是浪费你的时间，请原谅我。

另一位发帖人提到给定用户具有系统的 id 和任何给定数据库的 id。这可以通过比较相同登录名/用户名的 master.sys.syslogins 和 dbname.sys.users 之间的 sid 来证明。如果您从另一个拥有自己的主数据库副本的 sql 服务器恢复备份，则 sid 将不匹配。

Sql Server 2005 不允许直接编辑系统表而没有很多痛苦。为了帮助解决这些不匹配的问题，他们添加了一个存储过程来帮助您修复它们：

使用 dbName 去

sp_change_users_login @Action='报告'

这将向您显示哪些用户有 dbName.sys.users 条目，但没有 master.sys.syslogins 条目 - 或者名称在两者中都存在，但因 sids 而异。

如果它显示您的用户不同步，则该过程还具有更改链接的模式：

使用 dbName GO sp_change_users_login 'Update_One'、'userNameInDbUsers'、'UserNameInLogins'

如果 sid 不匹配不是您的问题，我还看到 Sql Server 2005 的问题非常糟糕。gui 特别有问题。要解决这样的问题，我必须实际删除 syslogins 条目（通过 gui 或 DROP LOGIN 命令）

sp_change_users_login： http: [//msdn.microsoft.com/en-us/library/ms174378 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms174378(SQL.90).aspx)

删除登录语法： http: [//msdn.microsoft.com/en-us/library/ms188012 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms188012(SQL.90).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-02T11:13:28.950

我有同样的问题，我用以下方法解决了它：

```
C:\> sqlcmd -E -d master
1> ALTER LOGIN ***** WITH DEFAULT_DATABASE=master
2> GO 
```

你的用户名在哪里`*****`。

（如果您使用的是域用户名`[*****]`：）

**编辑：**

`*****`可能在哪里：

*   `username`如果用户是本地用户
*   `[username]`如果用户属于实际域
*   `[domain\username]`如果用户属于另一个域（未测试）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T02:41:16.457

我将 8 个数据库从 SQL Server 2000 移到 SQL Server 2005 并移到了完全不同的计算机上。我通常想知道存储过程在做什么，所以我挖了一点，发现实际的命令是**ALTER USER**。

这是其他人一直在说的。当您在 SQL Server 2005 中分离和重新附加数据库时，用户会失去关联。我发现这种行为最烦人，因为我在 SQL Server 2000 中没有看到这种行为。

修复此问题的 T-SQL 如下所示：

```
USE AdventureWorks;
ALTER USER Mary5 WITH NAME = Mary51;
GO 
```

这篇 MSDN 文章对此进行了更多讨论：

[http://msdn.microsoft.com/en-us/library/ms176060.aspx](http://msdn.microsoft.com/en-us/library/ms176060.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-12T17:57:09.013

我刚刚解决了这个问题。我的默认数据库是 AdventureWorks2008，因此作为管理员，我最终从服务器中删除了我的登录信息。然后运行以下命令重新创建我的用户

```
CREATE LOGIN [NT\mylogin] FROM WINDOWS WITH DEFAULT_DATABASE=[Master], DEFAULT_LANGUAGE=[us_english]
GO 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T01:09:10.620

我的理解是登录名存储在服务器中，而用户是登录到数据库的分配（如果我错了，请纠正我）。

因此，您不能通过分离/附加数据库来移动登录名，解决方案是创建一个数据库用户，将（有效）登录名连接到复制的数据库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T01:48:01.040

如前所述，到该用户帐户的登录映射可能在移动过程中被取消关联。或者，您在没有创建预期凭据的情况下移动了它，在这种情况下，您需要先创建登录...

但是，如果它是一个备份集并且您正在恢复它，则无法（据我所知）通过管理 UI 将登录名重新关联到用户。相反，您必须使用：

```
exec sp_change_users_login update_one, 'user', 'login' 
```

让它恢复链接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T22:15:12.897

`ALTER LOGIN`仅适用于 SQL 2005 及更高版本。

要更改 2000 中用户的默认数据库，请使用

```
EXEC master.dbo.sp_defaultdb @loginname = N'BuiltIn\Administrators', @defdb = N'master' 
```

当我将 builtin\administrators 帐户设置为默认应用程序数据库并且它以某种方式脱机并且我无法再登录时，我发现了这一点。使用 Management Studio，您可以设置登录到 master 的选项，但您必须运行上述命令才能进行任何其他操作，否则会出现默认数据库不可用错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T13:52:03.467

[http://benharrell.wordpress.com/2007/01/15/cannot-open-user-default-database-login-failed-login-failed-for-user-username-microsoft-sql-server-error-4064/](http://benharrell.wordpress.com/2007/01/15/cannot-open-user-default-database-login-failed-login-failed-for-user-username-microsoft-sql-server-error-4064/)

# eclipse - 如何为 Eclipse 更新站点命名？

> ID：176854
> 
> 赞同：5
> 
> 时间：2008-10-07T01:00:13.773
> 
> 标签：eclipse, plugins

我正在生成一个 Eclipse 更新站点，并尝试给它一个标签，以便当它出现在用户的站点列表中时，它会显示为名称（例如，“Ganymede 项目”）而不是 URL。

我无法在 PDE 或 site.xml 中找到它的任何参数

我见过的唯一一件事是让它生成然后手动编辑 artifact.xml，但是每次构建时都会弄乱，而且丑得要命。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T18:50:29.493

由于我不熟悉 Eclipse 更新站点构建，因此对此不是 100% 确定，但是这个页面：

[http://wiki.eclipse.org/Equinox_p2_Metadata_Generator](http://wiki.eclipse.org/Equinox_p2_Metadata_Generator)

似乎表明您可以使用 org.eclipse.equinox.p2.metadata.generator.EclipseGenerator 为更新站点生成元数据，其中包括站点名称作为参数：

> ### 描述输出的参数
> 
> [...]
> 
> **-metadataRepositoryName**
> 
> 元数据存储库的用户友好名称

也许这就是您为网站生成元数据所需要的？另见[http://wiki.eclipse.org/WTP/What_we_have_learned_(to_love)_about_P2](http://wiki.eclipse.org/WTP/What_we_have_learned_(to_love)_about_P2)：

> ...由于您在该位置同时拥有 content.jar 和 site.xml，因此您实际上有两个存储库。您有一个经典更新站点和一个 p2 存储库（这些文件彼此不知道/不关心）。经典更新站点不包含站点名称（site.xml 没有名称元素），因此这些站点是“无名的”。p2 存储库包含一个名称元素，因此它们具有人类可读的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T16:11:36.040

也许我误解了您的问题，但是用户在使用查找/安装功能添加站点时没有选择站点名称吗？该对话框指定了一个名称字段和一个 URL 字段。该名称是“要搜索的站点”列表中显示的名称。

# php - 最佳实践：构建页眉和页脚的最佳方法是什么？

> ID：176856
> 
> 赞同：19
> 
> 时间：2008-10-07T01:01:40.603
> 
> 标签：php, codeigniter, templates

构建页眉和页脚的最佳方法是什么？你应该从控制器中调用它，还是从视图文件中包含它？我正在使用 CodeIgniter，我想知道对此的最佳做法是什么。从控制器加载所有包含的视图文件，像这样？

```
class Page extends Controller {

   function index()
   {
      $data['page_title'] = 'Your title';
      $this->load->view('header');
      $this->load->view('menu');
      $this->load->view('content', $data);
      $this->load->view('footer');
   }

} 
```

或调用单个视图文件，并从那里调用页眉和页脚视图：

```
//controller file    
class Page extends Controller {

   function index()
   {
      $data['page_title'] = 'Your title';
      $this->load->view('content', $data);

   }

}

//view file

<?php $this->load->view('header'); ?>

<p>The data from the controller</p>

<?php $this->load->view('footer'); ?> 
```

我已经看到它是双向的，但现在想在我走得太远之前做出选择。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-24T19:49:17.657

实际上，在我自己对此进行了相当多的研究之后，我得出的结论是，在 MVC 中包含页眉和页脚的最佳实践是第三种选择——即扩展基本控制器。这将为您提供比文本建议更多的灵活性，特别是如果您正在构建一个非常模块化的布局（不仅仅是页眉和页脚，还有侧边栏面板、非静态菜单等）。

首先，定义一个`Base_controller`类，在其中创建将页面元素（页眉、页脚等）附加到输出字符串的方法：

```
class Base_controller extends Controller
{
    var $_output = '';

    function _standard_header($data=null)
    {
        if (empty($data))
            $data = ...; // set default data for standard header here

        $this->_output .= $this->load->view('header', $data, true);
    }

    function _admin_header($data=null)
    {
        if (empty($data))
            $data = ...; // set default data for expanded header here

        $this->_output .= $this->load->view('admin_header', $data, true);
    }

    function _standard_page($data)
    {
        $this->_standard_header();
        $this->_output .=
            $this->load->view('standard_content', $data, true);
        echo $this->_output; // note: place the echo statement in a
                             // separate function for added flexibility
    }

    function _page_with_admin_header($data)
    {
        $this->_admin_header($data);
        $this->_output .=
            $this->load->view('standard_content', $data, true);
        echo $this->_output;
    }
} 
```

然后，在您的页面控制器中，只需扩展基类并调用您的函数来构建页面。

```
class Page_controller extends Base_controller
{
    function index()
    {
        $data = ...; // Set content data here
        $this->_standard_page($data);
    }

    function admin()
    {
        $data = ...; // Set content and header data here
        $this->_page_with_admin_header($data);
    }
} 
```

使用基本控制器，您可以在各个页面控制器中实现非常干净的代码，并为页面上的元素提供单独的视图（允许在视图和控制器中重用代码）。您需要做的就是将您的公共页面“部分”（您可能会被称为“片段”）定义为基本控制器中的函数。

如果基础控制器开始无法控制地增长（这可能发生在大型网站上），您可以通过将其放置在子类中并让相应的页面控制器而不是原始基础控制器扩展它们来重新排列它的一些不太通用的功能。

享受！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-07T15:04:04.023

您也可以这样尝试——定义一个默认视图模板，然后根据控制器传递的变量（在我的示例中为“内容”）拉入内容。

在您的控制器中：

```
$data['content'] = 'your_controller/index';

// more code...

$this->load->vars($data);
$this->load->view('layouts/default'); 
```

然后为所有页面定义默认布局，例如views/layouts/default.php

```
// doctype, header html etc.

<div id="content">
    <?= $this->load->view($content) ?>
</div>

// footer html etc. 
```

然后您的视图可以只包含纯内容，例如 views/your_controller/index.php 可能只包含从控制器/数据数组传递的变量

```
<?= $archives_table ?>
<?= $pagination ?>
// etc. 
```

[有关 CI wiki/FAQ 的更多详细信息](http://codeigniter.com/wiki/FAQ)——（问。如何在视图中嵌入视图？嵌套模板？...）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T03:48:17.537

我认为你这样做的第一种方式更清洁。仅从将要呈现的知识的角度来看。而不必输入视图文件来查找其余部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-07T02:14:56.180

在其他视图中调用视图是不好的做法。这可能是控制器视图混合的一种形式。CI 中的 view 函数允许您传递第三个参数，使其将该视图的输出作为字符串返回。您可以使用它来创建复合视图。

例如：

```
class Page extends Controller {
   function index() {
      $data['page_title'] = 'Your title';

      $this->load->view('default_layout', array(
         'header'  => $this->load->view('header' , array(), true), 
         'menu'    => $this->load->view('menu'   , array(), true), 
         'content' => $this->load->view('content', $data  , true), 
         'footer'  => $this->load->view('footer' , array(), true), 
      ));
   }
} 
```

default_layout.php

```
<? echo $header, $menu, $content, $footer; ?> 
```

您可能希望结合您的页眉和页脚来制作这样的模板。

```
class Page extends Controller {
   function index() {
      $data['page_title'] = 'Your title';

      $this->load->view('default_template', array(
         'menu'    => $this->load->view('menu'   , array(), true), 
         'content' => $this->load->view('content', $data  , true), 
      ));
   }
} 
```

default_template.php

```
<html><head></head><body><span>Some Header HTML</span> // this is your header html
<? echo $menu, $content; ?>
<span>some footer HTML</span></body></html>  // this is your footer html 
```

# sql-server - 安装问题sql server 2008

> ID：176857
> 
> 赞同：29
> 
> 时间：2008-10-07T01:02:05.190
> 
> 标签：sql-server, sql-server-2008, installation

我可能应该将此用于论坛，但认为这里的某人可能知道答案。我正在尝试在家用 vista 机器上安装 sql server 2008，但每次检查以确保满足先决条件时，它都会一直告诉“重新启动计算机失败”。我重新启动了计算机，甚至卸载/安装了 .net 3.5 sp1。
我发现的唯一线程是：[http ://forums.microsoft.com/msdn/showpost.aspx?postid=3656807&siteid=1&sb=0&d=1&at=7&ft=11&tf=0&pageid=1](http://forums.microsoft.com/msdn/showpost.aspx?postid=3656807&siteid=1&sb=0&d=1&at=7&ft=11&tf=0&pageid=1)

该论坛上的最后一篇文章指出，有一种方法可以“强制”（使用命令提示符）有一种方法可以绕过重新启动检查。

有谁知道可以使用哪些命令绕过重新预订检查？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-08T00:40:28.540

在这里找到这个：http: [//forums.microsoft.com/msdn/ShowPost.aspx?PostID=3762432 &SiteID=1](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3762432&SiteID=1)

"你可以打开Regedit，修改这个键"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager"并删除"PendingFileRenameOperations"中的任何值"

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-09-12T04:11:36.893

一个最简单的解决方案是通过命令行安装忽略此验证：

```
setup.exe /ACTION=INSTALL /SkipRules=RebootRequiredCheck 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-08T19:11:17.877

要从命令行跳过重新启动/重新启动检查，请使用 /SKIPRULES=RebootRequiredCheck

更多详情：[http ://technet.microsoft.com/en-us/library/ms144259.aspx](http://technet.microsoft.com/en-us/library/ms144259.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T00:43:40.750

还可以尝试在以下位置删除重启键：HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\运行一次

来源：[https ://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=3745175&SiteID=17](https://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=3745175&SiteID=17)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-30T15:30:11.210

如果你没有钥匙（像我一样），试试这个：

1.  找到 setup.exe 解压的目录
2.  启动 cmd.exe 并导航到该目录
3.  从命令行开始安装：

    setup.exe /ACTION=install /FEATURES=SQL /INSTANCENAME=SQL2008 /SQLSVCACCOUNT=”NT Authority\System” /SQLSYSADMINACCOUNTS=”yourPcName\yourUserName” /AGTSVCACCOUNT=”NT Authority\System” /SECURITYMODE=SQL /SAPWD=”yourSqlPassword ” /SQLTEMPDBDIR=”C:\SQL2008\TempDB\” /SQLUSERDBDIR=”C:\SQL2008\SQLData\” /SQLUSERDBLOGDIR=”C:\SQL2008\SQLLog\” /SkipRules=VSShellInstalledRule RebootRequiredCheck

在执行之前，请注意上面代码的某些部分：

```
INSTANCENAME=SQL2008
/SQLSYSADMINACCOUNTS=”yourPcName\yourUserName”
/SAPWD=”yourSqlPassword” 
/SQLTEMPDBDIR=”C:\SQL2008\TempDB\\” 
/SQLUSERDBDIR=”C:\SQL2008\SQLData\\” 
/SQLUSERDBLOGDIR=”C:\SQL2008\SQLLog\\” 
```

如果您找不到上面的标签：http: [//msdn.microsoft.com/en-us/library/ms144259 (SQL.100).aspx#Install](http://msdn.microsoft.com/en-us/library/ms144259(SQL.100).aspx#Install)

# clearcase - 在 ClearCase 中，如何从命令行以静态视图查看文件的旧版本？

> ID：176858
> 
> 赞同：17
> 
> 时间：2008-10-07T01:02:15.003
> 
> 标签：clearcase

在静态视图中，如何查看文件的旧版本？

给定一个空文件（`empty`在本例中调用），我可以颠覆`diff`以向我展示旧版本：

```
    % cleartool diff -ser 空文件@@/main/28

```

这感觉就像一个非常丑陋的黑客攻击。我错过了更基本的命令吗？有没有更简洁的方法来做到这一点？

（我不想编辑配置规范 - 这很乏味，我正在尝试查看一堆旧版本。）

**澄清**：我想将文件的版本发送到标准输出，这样我就可以将它与 Unix 的其余部分（grep、sed 等）一起使用。如果你发现这个问题是因为你正在寻找一种方法来保存文件中元素的版本，请参阅[Brian 的回答](https://stackoverflow.com/questions/176858/in-clearcase-how-can-i-view-old-version-of-a-file-in-a-static-view-from-the-com/4962643#4962643)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-07T06:03:44.020

> 我正在尝试查看一堆旧版本

我不确定您是在谈论*一个文件*的“一堆旧版本”，还是来自*多个*文件的“一堆旧版本”。

要可视化一个文件的多个旧版本，最简单的方法是显示其版本树 ( `ct lsvtree -graph File`)，然后选择一个版本，右键单击它并“ `Send To`”一个接受多个文件的编辑器（如 Notepad++）。只需单击几下，您就可以查看这些旧版本。
注意：您必须拥有 CC6.0 或 7.0.1 IFix01（7.0.0 和 7.0.1 无法“发送到”文件并显示以下错误消息“ `Access to unnamed file was denied`”）

但是为了可视化不同文件的几个旧版本，我建议使用动态视图并编辑该视图的配置规范（而不是您当前正在使用的快照视图），以便快速选择所有这些旧文件（希望通过简单的选择规则，如' `element * aLabel`'）

* * *

[来自评论：]

> “cat”文件的早期版本的惯用方式是什么？

惯用的方式是通过**动态**视图（您使用与现有快照视图完全相同的配置规范进行配置）。

然后，您可以浏览（如“将目录更改为”）文件的各种**扩展路径**。

如果要对文件分支的所有版本进行分类，请输入：

```
cd /view/MyView/vobs/myVobs/myPath/myFile@@/main/[...]/maBranch
cat 1
cat 2
...
cat x 
```

' `1`', ' `2`', ... ' `x`' 是该分支中文件的版本 1、2、... x。

* * *

对于**快照视图**，**扩展路径不可访问**，因此您的“hack”是要走的路。

但是，这里有两条评论：

*   要快速显示给定分支中快照文件的所有先前版本，您可以键入：

（用于复制粘贴的一行版本，Unix 语法：）

```
cleartool find addon.xml -ver 'brtype(aBranch) && !version(.../aBranch/LATEST) && ! 版本（.../aBranch/0）' -exec 'cleartool diff -ser empty "$CLEARCASE_XPN"'

```

（多行版本的可读性：）

```
cleartool find addon.xml -ver 'brtype(aBranch) &&
                               !version(.../aBranch/LATEST) &&
                               ！版本（.../aBranch/0）'
          -exec 'cleartool diff -ser empty "$CLEARCASE_XPN"'

```

*   您可以快速获得更好的输出

（用于复制粘贴的一行版本，Unix 语法：）

```
cleartool find addon.xml -ver 'brtype(aBranch) && !version(.../aBranch/LATEST) && ! 版本（.../aBranch/0）' -exec 'cleartool diff -ser empty "$CLEARCASE_XPN"' | ccperl -nle '$a=$_; $b = $a; $b =~ s/^>+\s(?:file\s+\d+:\s+)?//g;打印 $b if $a =~/^>/'

```

（多行版本的可读性：）

```
cleartool find addon.xml -ver 'brtype(aBranch) &&
                               !version(.../aBranch/LATEST) &&
                               ！版本（.../aBranch/0）'
         -exec 'cleartool diff -ser empty "$CLEARCASE_XPN"'
| ccperl -nle '$a=$_; $b = $a;
               $b =~ s/^>+\s(?:file\s+\d+:\s+)?//g;
               如果 $a =~/^>/' 则打印 $b

```

这样，输出更好。

* * *

[Brian](https://stackoverflow.com/users/612108/brian)[下面提到](https://stackoverflow.com/questions/176858/in-clearcase-how-can-i-view-old-version-of-a-file-in-a-static-view-from-the-com/4962643#4962643)的[“`cleartool get`](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_get.htm) ”命令（[手册页）](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_get.htm)不执行标准输出：

> get 命令仅将文件元素复制到视图中。
> 
> 在 UNIX 或 Linux 系统上，复制`/dev/hello_world/foo.c@@/main/2`到当前目录。

```
cmd-context get –to foo.c.temp /dev/hello_world/foo.c@@/main/2 
```

> 在 Windows 系统上，复制`\dev\hello_world\foo.c@@\main\2`到`C:\build`目录中。

```
cmd-context get –to C:\build\foo.c.temp \dev\hello_world\foo.c@@\main\2 
```

因此，也许通过将结果传递给`cat`（或`type`在 Windows 中），您可以对所述`cat`( `type`) 命令的输出执行某些操作。

```
cmd-context get –to C:\build\foo.c.temp \dev\hello_world\foo.c@@\main\2 | type C:\build\foo.c.temp 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-02-10T21:01:53.303

我知道这是一个旧线程......但我不能让这种颠簸没有解决......

静态视图有一个“ct get”命令，它完全符合您的要求。

```
cleartool get -to ~/foo File@@/main/28 
```

将这个版本的文件保存在`~/foo`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T04:58:25.073

[根据第一条评论重写]

Clearcase 中的所有文件，包括版本，都在虚拟目录结构中可用。我对静态视图不是很熟悉，但我相信它们仍然通过虚拟 fs；他们只是以不同的方式更新。

在这种情况下，您可以这样做：

```
 cat File@@/main/28 
```

如果您还必须找到包含该文件元素的目录的正确版本，它可能会变得很难看。我们有一个 PERL 脚本在工作，它使用这种方法来分析对文件所做的历史更改，我们很快就用完了 Windows 上的命令行空间来实际运行命令！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-05T21:50:33.493

如果 File 是 Clearcase 元素，并且`cat File`可以正常工作，并且视图设置正确，请尝试：

```
cat File@@/main/28 
```

（注意：没有`ct shell`-- 如果您已经在视图中，则不需要它。）

尝试输入：

```
ct ls -l File 
```

如果它显示具有与上述类似的扩展名的文件，那么您应该能够使用扩展名来分类文件。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-12-28T05:27:41.633

ct shell cat File@@version

# java - Java 1.5 到 1.4

> ID：176870
> 
> 赞同：6
> 
> 时间：2008-10-07T01:10:45.577
> 
> 标签：java

将用 java 1.5 编写的现有 jar（无源）转换为 java 1.4.x 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-07T01:24:34.490

看看[Retroweaver](http://retroweaver.sourceforge.net/index.html)。它将转换类或 jar 以便可以使用 1.4 JRE 运行。根据所使用的 1.5 功能，您不需要任何额外的逆向编织器运行时。

Retroweaver 使用字节码增强。这听起来很神秘，但它确实有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T13:54:55.473

[retrotranslator](http://retrotranslator.sourceforge.net/)是另一个类似于 retroweaver 的选项

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T01:17:15.080

你可以反编译它，然后重新编译。您可能必须手动修复不兼容性。这是关于 java [decompilers](https://stackoverflow.com/questions/31353/is-jad-the-best-java-decompiler)的一个线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T01:17:32.333

我的直觉是反编译 jar，然后重新编译为 1.4。

如果反编译的代码中没有 1.5 特定的 API 调用，那应该可以正常工作。如果有，您将需要重新设计这些部分以在早期的 java 版本中工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T01:25:10.120

除了反编译之外，您可能还必须重构源代码中的一些东西 - 枚举、泛型（我认为泛型不会出现在反编译的代码中，但这可能意味着您会丢失一些强制转换），装箱/拆箱等

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T01:34:31.707

正如 Rodeoclown 所说，
1）解压缩 JAR

2）使用像 jad（[http://www.kpdus.com/jad.html](http://www.kpdus.com/jad.html)）这样的反编译器，使用这些选项 jad -d src -f -ff -s .java -space - t4 ***.class

3) 并从生成的源文件中，使用 JDK 1.4 的 javac 编译它们。

4) 如果 1.4 编译器工作正常，重新打包到新的 jar

5) 如果 1.4 编译器有问题，你需要使用
retroweaver( [http://retroweaver.sourceforge.net/index.html](http://retroweaver.sourceforge.net/index.html) )。
这在某些情况下可能会起作用，但是如果该类期望 JVM 发生变化，那么您将处于困境中。[如果类使用新的线程工具，您可以使用来自http://g.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/intro.html](http://g.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/intro.html)的 JDK 1.4 版本的 util.concurrent.

祝你好运！

# c# - 来自 C# 中的键盘挂钩事件的 ShowDialog()

> ID：176877
> 
> 赞同：1
> 
> 时间：2008-10-07T01:15:15.053
> 
> 标签：c#, keyboard-hook

我想在`ShowDialog()`触发键盘钩子事件时调用，但我遇到了一些困难：

*   ShowDialog() 阻塞，所以我不能从钩子触发事件中调用它，因为它会阻塞操作系统。
*   我可以启动一个新线程并`ShowDialog()`从那里调用，但我得到了一些令人讨厌的异常。我想我不能调用`ShowDialog()`任何其他线程。
*   我可以启动一个计时器：在接下来的 50 毫秒调用`ShowDialog()`中（顺便说一句，这是一个令人讨厌的 hack，我宁愿不这样做）。但是随后计时器在一个新线程中触发，然后我遇到了上一个项目符号中解释的相同问题。

有办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T01:34:13.550

问题可能是您试图将 UI 放在非 UI 线程中。让您的事件从另一个线程触发并调用`ShowDialog()`从您的 UI 线程运行的方法。

本质上，您希望将 UI 保留在 UI 线程上，并将其他任何内容移至后台线程。

查看[Gekki Software](http://www.gekko-software.nl/DotNet/Art05.htm)了解一些详细信息（还有无数其他的——这恰好是我在研究档案中发现的第一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T01:20:38.180

我不确定 ShowDialog，但是当您尝试在后台线程中对 UI 执行某些操作时遇到异常时，这意味着您应该使用 UI 调度程序。

尝试使用调用 showdialog 的委托调用您控制的任何 UI 对象的 BeginInvoke 方法（如果您使用的是 Windows 窗体）。

此外，请确保尝试（在此之前）在显示对话框方法中传递对有效所有者的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T01:22:17.317

没有“讨厌的例外”，很难说出发生了什么。我认为这是因为您的线程不是[STA](http://en.wikipedia.org/wiki/Component_Object_Model#Threading_in_COM)线程，并且 UI 对象在实例化时抛出异常。将新线程的单元模型设置为 STA 而不是[MTA](http://en.wikipedia.org/wiki/Component_Object_Model#Threading_in_COM)，看看是否有帮助。

如果你不知道有什么区别，你应该做一些阅读，例如*[多线程公寓](http://msdn.microsoft.com/en-us/library/ms693421(VS.85).aspx)*（MSDN）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T01:39:52.820

您确实应该能够从 KeyPress 类型的事件中显示对话框。

此外，如果您`ShowDialog()`从另一个线程使用，它将不是模态的（没有父级）。这与使用`Show()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T02:54:03.170

试试这个：

```
void MyKeyboardHookHandler(...)
{
     WindowsFormsSynchronizationContext.Current.Post(state =>
     {
         Form f = new Form();
         f.ShowDialog();
     }, null);
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-07T01:37:43.370

ShowDialog() 将阻止您的应用程序的线程，但这是它应该做的。如果您不希望表单阻止您的应用程序，请改为调用 Show()。

ShowDialog() 不会“阻塞操作系统”，所以不要勉强使用它。

# c# - 如何使用 C# 通过套接字将 cookie 发送到客户端？

> ID：176881
> 
> 赞同：1
> 
> 时间：2008-10-07T01:16:09.640
> 
> 标签：c#, cookies, proxy

好的，如果我有这个权利，我的代码可以在特定的 url 获取 cookie，但是一旦我将 cookie 获取到容器中，我如何通过套接字将它发送到客户端？就像下面直接用于常规 http 页面请求的代码一样。

```
byte[] buffer = new byte[bz];
rebu = responsestream.Read(buffer, 0, bz);
while (rebu != 0)
{
    soket.Send(buffer, rebu, 0);
    rebu = responsestream.Read(buffer, 0, bz);
} 
```

我的请求/响应代码部分

```
System.Net.Configuration.HttpWebRequestElement wr = new System.Net.Configuration.HttpWebRequestElement();
wr.UseUnsafeHeaderParsing = true;
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
CookieContainer cookieContainer = new CookieContainer();
request.CookieContainer = cookieContainer;
request.CookieContainer.Add(cookieContainer.GetCookies((Uri)url));
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
Stream responsestream = response.GetResponseStream();
byte[] buffer = new byte[bz];
rebu = responsestream.Read(buffer, 0, bz);
while (rebu != 0)
{
    soket.Send(buffer, rebu, 0);
    rebu = responsestream.Read(buffer, 0, bz);
} 
```

这是我正在编码的代理服务器的一部分，我遇到了 cookie 问题。

C#.net3.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T01:47:09.233

中的 cookie`HttpRequest.CookieContainer`通过 HTTP 标头转到请求中指定的目标 URL *`Cookie:`*。通常，代理不会设置自己的 cookie。您应该检查来自客户端的所有传入 cookie 以传递，但如果服务器为客户端设置自己的 cookie，则无需执行任何特殊操作——它将作为 HTTP*`Set-Cookie:`*标头自动成为响应流的一部分。

# java - 如何从 NetBeans IDE 外部运行 .jar 可执行 java 文件？

> ID：176902
> 
> 赞同：8
> 
> 时间：2008-10-07T01:30:25.740
> 
> 标签：java, executable-jar

如何从 NetBeans IDE 外部运行 .jar 可执行 java 文件？（Windows Vista）。我的项目有一个由 Netbeans 创建的 .jar 文件。我们想运行它。要么：我们如何运行该文件，或者我们如何在 NetBeans 6.1 中创建一个“适当的”可执行文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-07T01:33:21.350

运行一个 jar 就像

```
java -jar filename.jar 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T01:36:27.960

正如拉普利所说，java -jar your.jar

可执行文件：请参阅此线程以获取答案[如何将我的 Java 程序转换为 .exe 文件？](https://stackoverflow.com/questions/147181/how-can-i-convert-my-java-program-to-an-exe-file)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-10T10:23:39.427

运行 jar 文件或 jar jar 文件的最佳技术之一

1.  通过 jar 命令创建 jar 文件 选择你的 jar 文件名 `Java_Jar_File.jar`
2.  使用类似的命令运行 jar 文件`java -jar Java_Jar_File.jar`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T01:35:38.290

如果 java 不在您的路径中，您可以通过命令提示符执行此操作，方法是查找 java 安装的完整路径，例如：

```
C:\java\java.exe -jar C:\jar_you_want_to_run.jar 
```

或者如果 java 在您的路径中：

```
java.exe -jar jar_you_want_to_run.jar 
```

这将运行 netbeans 生成的 jar。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-06T15:53:59.457

制作一个BAT文件

```
java -jar filepath.jar 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T07:27:43.303

首先，确保在 NetBeans 项目属性对话框中设置 Main Class。
然后，您可以

*   双击 jar 文件（这应该适用于任何安装了 JRE 的机器）

或者

*   确保 java.exe 在路径中（或`java`在下面替换为可执行文件的完整路径和文件名），将以下内容放入批处理文件中：
    `java -jar filename.jar`
    然后您可以双击批处理文件而不是 jar（如果您让人们不习惯使用裸 jar 文件）

或者

*   您可以按照此处描述的路径[如何将我的 Java 程序转换为 .exe 文件？](https://stackoverflow.com/questions/147181/how-can-i-convert-my-java-program-to-an-exe-file)为 Windows 构建 .exe。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-07T01:35:28.257

您可以从命令提示符运行以下命令：`java -jar your_jar.jar`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-02T15:15:37.857

要运行 java jar 文件，应正确配置其文件关联。有一个名为[jarfix](http://johann.loefflmann.net/en/software/jarfix/index.html)的免费工具可以修复所有 jar 文件关联问题。运行此文件以修复所有 jar 问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-07T12:12:38.013

如果您在运行 jar 时遇到问题，请确保您正在尝试运行当前版本以在 Netbeans 中获取最新版本：`GoTo Run Menu`-->`Clean and build`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-14T06:57:38.560

在 NetBeans 的项目属性对话框中，您需要设置 Main Class - 否则生成的 .jar 将无法执行。然后，如前所述，双击 .jar 或命令 java -jar 将启动程序。

# performance - 使用位向量/数组而不是简单的布尔数组是否值得？

> ID：176910
> 
> 赞同：3
> 
> 时间：2008-10-07T01:35:23.017
> 
> 标签：performance, optimization

当我想要一个标志数组时，使用整个字节（或单词）来存储每个标志通常会让我很痛苦，如果我创建一个`bool`s 数组或其他可以设置为 0 或1\. 但是现在我想知道考虑到移位和位测试的额外开销（尽管希望非常轻微），使用更节省空间的结构是否值得。

在我的公司中，我们使用 Rogue Wave 工具（尽管希望不会持续太久），`RWBitVec`到目前为止，我一直在使用它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T01:45:12.810

主要是为了节省内存。如果您的 bool 数组足够大，以至于 8 倍的存储空间改进是有意义的，那么请务必使用 bitarray。

请注意，与移位/与相比，内存访问非常昂贵，因此位数组方法比字符数组稍快。基本上它归结为内存与程序员时间。请记住，过早的优化是浪费时间。我会使用最容易开发的任何一种方法，然后仅在它表明它是主要的性能瓶颈后才进行重构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T01:53:01.017

不要使用vector<bool>，它不是真正的Container：

[http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=98](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=98)

在适当的地方使用 std::bitset （对于固定大小的位集）和 boost::dynamic_bitset （对于可调整大小的位集）。它们也不是容器，但它们看起来不应该是，因此不太可能引起混淆。

显然，这种权衡是否值得取决于程序中的数组有多大。我认为你是对的，位访问的开销通常可以忽略不计，但如果内存开销也可以忽略不计，那么你也没有什么可做的。

位集的优点是它们完全按照他们在锡上所说的去做——这些都不是“声明一个字符/整数数组，但唯一的合法值是 0 和 1”是胡说八道。您的代码将与您使用数组大致相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T02:18:40.323

我曾经写过一些代码来将位图图像行解压缩为每个像素的单独字节，然后在处理后再次将其打包回来。对于我进行基准测试的代码，实际上这样做比在位级别工作要快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T02:27:28.667

现代计算机具有[桶形移位器](https://en.wikipedia.org/wiki/Barrel_shifter)，因此最多 31 位的任意位数的移位需要几个周期（少于许多其他指令）。编译器利用了这一点，位操作不仅节省空间，而且在大多数情况下节省时间。

但这实际上取决于您如何使用和测试这些位 - 有一些低效的方法可以更快地使用整个整数。

-亚当

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-07T02:28:09.853

我使用了一个位数组来索引一棵巨大的树。算法是：

```
    如果条目存在，检查位数组
    如果条目不存在
      返回空
    否则在树中进行二进制搜索
      返回值

```

优点是树足够大，搜索不存在的条目会在完成之前导致几次缓存未命中。因此，算法是否需要更长的时间取决于值的存在。

但是，添加初始位数组搜索意味着我会减少缓存未命中，并且如果答案不存在，将完全避免搜索树。通过添加这个额外的步骤，算法变得更加健壮（计算机上的实际性能时间变得几乎是线性的，尽管 Big-O 会说不同），并且整体性能提高了一个数量级。

就像他们说的那样，有时考虑硬件比“理想”的数学算法更重要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T01:50:17.073

这值得么？仅当您知道内存使用存在问题时。

但除非你是：

1.  *在资源非常*有限的嵌入式处理器上工作，或
2.  存储天文数字的`bool`s

那么答案是否定的。与使用 bool 相比，使用位图在源代码中获得相同级别的可读性，您必须更加努力，除非您在前两种条件下操作，否则您可能会发现它没有不会对您的内存占用产生任何明显的影响。

# java - 如何使用集成测试运行程序在我的 IntelliJ IDEA 项目中运行除以“IntegrationTest”结尾的所有 JUnit 单元测试？

> ID：176913
> 
> 赞同：12
> 
> 时间：2008-10-07T01:35:43.733
> 
> 标签：java, unit-testing, reflection, junit, intellij-idea

我基本上想使用 JUnit 的 static suite() 方法在我的 IntelliJ IDEA 项目中运行所有 JUnit***单元***测试（不包括 JUnit 集成测试）。为什么使用静态套件（）方法？因为然后我可以使用 IntelliJ IDEA 的 JUnit 测试运行程序在我的应用程序中运行所有单元测试（并通过命名约定轻松排除所有集成测试）。到目前为止的代码如下所示：

```
package com.acme;

import junit.framework.Test;
import junit.framework.TestCase;
import junit.framework.TestSuite;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class AllUnitTests extends TestCase {

    public static Test suite() {
        List classes = getUnitTestClasses();
        return createTestSuite(classes);
    }

    private static List getUnitTestClasses() {
        List classes = new ArrayList();
        classes.add(CalculatorTest.class);
        return classes;
    }

    private static TestSuite createTestSuite(List allClasses) {
        TestSuite suite = new TestSuite("All Unit Tests");
        for (Iterator i = allClasses.iterator(); i.hasNext();) {
            suite.addTestSuite((Class<? extends TestCase>) i.next());
        }
        return suite;
    }

} 
```

应重写方法 getUnitTestClasses() 以添加所有扩展 TestCase 的项目类，除非类名以“IntegrationTest”结尾。

例如，我知道我可以在 Maven 中轻松做到这一点，但我需要在 IntelliJ IDEA 中做到这一点，这样我才能使用集成测试运行器 - 我喜欢绿色条 :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T18:15:46.210

如何将每个主要的 junit 测试组放入他们自己的根包中。我在我的项目中使用这个包结构：

```
test.
  quick.
    com.acme
  slow.
    com.acme 
```

无需任何编码，您就可以设置 IntelliJ 来运行所有测试，无论是快速测试还是慢速测试。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-07T11:30:57.493

我已经编写了一些代码来完成大部分工作。只有当您的文件在本地磁盘上而不是在 JAR 中时，它才有效。您所需要的只是包中的一个类。为此，您可以创建一个 Locator.java 类，以便能够找到该包。

```
public class ClassEnumerator {
    public static void main(String[] args) throws ClassNotFoundException {
        List<Class<?>> list = listClassesInSamePackage(Locator.class, true);

        System.out.println(list);
    }

    private static List<Class<?>> listClassesInSamePackage(Class<?> locator, boolean includeLocator) 
                                                                      throws ClassNotFoundException {

        File packageFile = getPackageFile(locator);

        String ignore = includeLocator ? null : locator.getSimpleName() + ".class";

        return toClassList(locator.getPackage().getName(), listClassNames(packageFile, ignore));
    }

    private static File getPackageFile(Class<?> locator) {
        URL url = locator.getClassLoader().getResource(locator.getName().replace(".", "/") + ".class");
        if (url == null) {
            throw new RuntimeException("Cannot locate " + Locator.class.getName());
        }

        try {
        return new File(url.toURI()).getParentFile();
        }
        catch (URISyntaxException e) {
            throw new RuntimeException(e);
        }
    }

    private static String[] listClassNames(File packageFile, final String ignore) {
        return packageFile.list(new FilenameFilter(){
            @Override
            public boolean accept(File dir, String name) {
                if (name.equals(ignore)) {
                    return false;
                }
                return name.endsWith(".class");
            }
        });
    }

    private static List<Class<?>> toClassList(String packageName, String[] classNames)
                                                             throws ClassNotFoundException {

        List<Class<?>> result = new ArrayList<Class<?>>(classNames.length);
        for (String className : classNames) {
            // Strip the .class
            String simpleName = className.substring(0, className.length() - 6);

            result.add(Class.forName(packageName + "." + simpleName));
        }
        return result;
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-02-28T16:06:40.523

使用 JUnit4 和 Suite-Runner 怎么样？

例子：

```
@RunWith(Suite.class)
@Suite.SuiteClasses({
UserUnitTest.class,
AnotherUnitTest.class
})
public class UnitTestSuite {} 
```

我制作了一个小的 Shell 脚本来查找所有单元测试和另一个查找我的集成测试。看看我的博客条目： [http ://blog.timomeinen.de/2010/02/find-all-junit-tests-in-a-project/](http://blog.timomeinen.de/2010/02/find-all-junit-tests-in-a-project/)

如果你使用 Spring TestContext，你可以使用 @IfProfile 注解来声明不同的测试。

亲切的问候，蒂莫·迈宁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-03T14:33:24.440

Spring 在 PathMatchingResourcePatternResolver 中实现了出色的类路径搜索功能。如果您使用 classpath*: 前缀，您可以找到所有资源，包括给定层次结构中的类，甚至可以根据需要过滤它们。然后，您可以使用 AbstractTypeHierarchyTraversingFilter、AnnotationTypeFilter 和 AssignableTypeFilter 的子级在类级别注释或它们实现的接口上过滤这些资源。

[http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/core/io/support/PathMatchingResourcePatternResolver.html](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/core/io/support/PathMatchingResourcePatternResolver.html)

[http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/core/type/filter/AbstractTypeHierarchyTraversingFilter.html](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/core/type/filter/AbstractTypeHierarchyTraversingFilter.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-16T00:41:01.167

解决方案：[https](https://github.com/MichaelTamm/junit-toolbox)
://github.com/MichaelTamm/junit-toolbox 使用以下功能

```
@RunWith(WildcardPatternSuite.class)
@SuiteClasses({"**/*.class", "!**/*IntegrationTest.class"})
public class AllTestsExceptionIntegrationSuit {
} 
```

假设您遵循一种命名模式，其中集成测试以 ...IntegrationTest 结尾，并且您将文件放在最顶层的包中（因此 **/*.class 搜索将有机会获取所有测试）

# python - 查找列表中项目的索引

> ID：176918
> 
> 赞同：3959
> 
> 时间：2008-10-07T01:39:38.437
> 
> 标签：python, list, indexing

给定一个列表`["foo", "bar", "baz"]`和列表中的一个项目`"bar"`，我如何`1`在 Python 中获取它的索引 ()？

* * *

## 回答 #1

> 赞同：5475
> 
> 时间：2008-10-07T01:40:49.213

```
>>> ["foo", "bar", "baz"].index("bar")
1 
```

参考：[数据结构 > 更多关于列表](https://docs.python.org/tutorial/datastructures.html#more-on-lists)

# 警告如下

请注意，虽然这可能是回答所*问*问题的最干净的方法，但它是 API`index`的一个相当薄弱的组件`list`，我不记得我上次在愤怒中使用它是什么时候了。评论中已向我指出，由于此答案被大量引用，因此应使其更加完整。`list.index`关于跟随的一些注意事项。最初可能值得看一下它的文档：

> ```
> list.index(x[, start[, end]]) 
> ```
> 
> 返回值等于*x*的第一项的列表中从零开始的索引。[`ValueError`](https://docs.python.org/library/exceptions.html#ValueError)如果没有这样的项目，则引发 a 。
> 
> 可选参数*start*和*end*被解释为[切片符号](https://docs.python.org/tutorial/introduction.html#lists)，用于将搜索限制为列表的特定子序列。返回的索引是相对于完整序列的开头而不是 start 参数计算的。

## 列表长度的线性时间复杂度

调用按顺序检查列表中的`index`每个元素，直到找到匹配项。如果您的列表很长，并且您不知道它在列表中的大致位置，则此搜索可能会成为瓶颈。在这种情况下，您应该考虑不同的数据结构。请注意，如果您大致知道在哪里可以找到匹配项，您可以给出`index`提示。例如，在这个片段中，`l.index(999_999, 999_990, 1_000_000)`大约比 Straight 快五个数量级`l.index(999_999)`，因为前者只需要搜索 10 个条目，而后者搜索一百万个：

```
>>> import timeit
>>> timeit.timeit('l.index(999_999)', setup='l = list(range(0, 1_000_000))', number=1000)
9.356267921015387
>>> timeit.timeit('l.index(999_999, 999_990, 1_000_000)', setup='l = list(range(0, 1_000_000))', number=1000)
0.0004404920036904514 
```

## 仅将第*一个匹配*项的索引返回到其参数

调用`index`按顺序搜索列表，直到找到匹配项，然后*停在那里。*如果您希望需要更多匹配项的索引，则应使用列表推导式或生成器表达式。

```
>>> [1, 1].index(1)
0
>>> [i for i, e in enumerate([1, 2, 1]) if e == 1]
[0, 2]
>>> g = (i for i, e in enumerate([1, 2, 1]) if e == 1)
>>> next(g)
0
>>> next(g)
2 
```

大多数我曾经使用过的地方`index`，现在我使用列表推导式或生成器表达式，因为它们更通用。因此，如果您正在考虑使用`index`，请查看这些出色的 Python 功能。

## 如果元素不存在于列表中，则抛出

如果项目不存在，则调用`index`结果为 a 。[`ValueError`](https://docs.python.org/library/exceptions.html#ValueError)

```
>>> [1, 1].index(2)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: 2 is not in list 
```

如果该项目可能不在列表中，您应该

1.  `item in my_list`首先使用（干净，可读的方法）检查​​它，或者
2.  `index`将调用包装在一个`try/except`可以捕获的块中`ValueError`（可能更快，至少当要搜索的列表很长并且该项目通常存在时。）

* * *

## 回答 #2

> 赞同：972
> 
> 时间：2008-10-07T13:19:56.933

对学习 Python 真正有帮助的一件事是使用交互式帮助功能：

```
>>> help(["foo", "bar", "baz"])
Help on list object:

class list(object)
 ...

 |
 |  index(...)
 |      L.index(value, [start, [stop]]) -> integer -- return first index of value
 | 
```

这通常会引导您找到您正在寻找的方法。

* * *

## 回答 #3

> 赞同：657
> 
> 时间：2013-06-19T22:31:52.557

大多数答案解释了如何查找**单个索引**，但如果项目多次在列表中，他们的方法不会返回多个索引。使用[`enumerate()`](https://docs.python.org/library/functions.html#enumerate)：

```
for i, j in enumerate(['foo', 'bar', 'baz']):
    if j == 'bar':
        print(i) 
```

该`index()`函数只返回第一次出现，而`enumerate()`返回所有出现。

作为列表理解：

```
[i for i, j in enumerate(['foo', 'bar', 'baz']) if j == 'bar'] 
```

* * *

这也是另一个小解决方案[`itertools.count()`](http://docs.python.org/library/itertools.html#itertools.count)（与枚举几乎相同）：

```
from itertools import izip as zip, count # izip for maximum efficiency
[i for i, j in zip(count(), ['foo', 'bar', 'baz']) if j == 'bar'] 
```

对于较大的列表，这比使用更有效`enumerate()`：

```
$ python -m timeit -s "from itertools import izip as zip, count" "[i for i, j in zip(count(), ['foo', 'bar', 'baz']*500) if j == 'bar']"
10000 loops, best of 3: 174 usec per loop
$ python -m timeit "[i for i, j in enumerate(['foo', 'bar', 'baz']*500) if j == 'bar']"
10000 loops, best of 3: 196 usec per loop 
```

* * *

## 回答 #4

> 赞同：215
> 
> 时间：2013-06-25T15:07:55.127

获取所有索引：

```
indexes = [i for i,x in enumerate(xs) if x == 'foo'] 
```

* * *

## 回答 #5

> 赞同：149
> 
> 时间：2011-08-30T09:40:54.867

`index()`返回值的**第一个**索引！

> | 索引（...）
> | L.index(value, [start, [stop]]) -> integer -- 返回值的第一个索引

```
def all_indices(value, qlist):
    indices = []
    idx = -1
    while True:
        try:
            idx = qlist.index(value, idx+1)
            indices.append(idx)
        except ValueError:
            break
    return indices

all_indices("foo", ["foo","bar","baz","foo"]) 
```

* * *

## 回答 #6

> 赞同：98
> 
> 时间：2012-08-21T12:01:54.630

```
a = ["foo","bar","baz",'bar','any','much']

indexes = [index for index in range(len(a)) if a[index] == 'bar'] 
```

* * *

## 回答 #7

> 赞同：98
> 
> 时间：2013-04-16T10:19:36.350

如果该元素不在列表中，则会出现问题。这个函数处理这个问题：

```
# if element is found it returns index of element else returns None

def find_element_in_list(element, list_element):
    try:
        index_element = list_element.index(element)
        return index_element
    except ValueError:
        return None 
```

* * *

## 回答 #8

> 赞同：66
> 
> 时间：2014-05-26T04:26:52.337

您必须设置一个条件来检查您正在搜索的元素是否在列表中

```
if 'your_element' in mylist:
    print mylist.index('your_element')
else:
    print None 
```

* * *

## 回答 #9

> 赞同：56
> 
> 时间：2015-11-17T19:05:23.603

如果你想要所有索引，那么你可以使用[NumPy](http://en.wikipedia.org/wiki/NumPy)：

```
import numpy as np

array = [1, 2, 1, 3, 4, 5, 1]
item = 1
np_array = np.array(array)
item_index = np.where(np_array==item)
print item_index
# Out: (array([0, 2, 6], dtype=int64),) 
```

这是清晰易读的解决方案。

* * *

## 回答 #10

> 赞同：51
> 
> 时间：2013-05-16T16:45:29.667

这里提出的所有功能都重现了固有的语言行为，但掩盖了正在发生的事情。

```
[i for i in range(len(mylist)) if mylist[i]==myterm]  # get the indices

[each for each in mylist if each==myterm]             # get the items

mylist.index(myterm) if myterm in mylist else None    # get the first index and fail quietly 
```

如果语言提供了执行您想要的方法的方法，为什么还要编写带有异常处理的函数？

* * *

## 回答 #11

> 赞同：47
> 
> 时间：2017-08-22T03:08:59.677

> ## 在 Python 中查找给定包含它的列表的项目的索引
> 
> 对于列表`["foo", "bar", "baz"]`中的列表和项目，`"bar"`在 Python 中获取其索引 (1) 的最简洁方法是什么？

好吧，当然，有 index 方法，它返回第一次出现的索引：

```
>>> l = ["foo", "bar", "baz"]
>>> l.index('bar')
1 
```

这种方法有几个问题：

*   如果该值不在列表中，您将得到一个`ValueError`
*   如果列表中有多个值，则仅获取第一个值的索引

### 没有值

如果该值可能丢失，则需要捕获`ValueError`.

您可以使用这样的可重用定义来做到这一点：

```
def index(a_list, value):
    try:
        return a_list.index(value)
    except ValueError:
        return None 
```

并像这样使用它：

```
>>> print(index(l, 'quux'))
None
>>> print(index(l, 'bar'))
1 
```

这样做的缺点是您可能会检查返回值是否为`is`无`is not`：

```
result = index(a_list, value)
if result is not None:
    do_something(result) 
```

### 列表中有多个值

如果您可以有更多的出现，您将**无法**获得完整的信息`list.index`：

```
>>> l.append('bar')
>>> l
['foo', 'bar', 'baz', 'bar']
>>> l.index('bar')              # nothing at index 3?
1 
```

您可以将索引枚举到列表中：

```
>>> [index for index, v in enumerate(l) if v == 'bar']
[1, 3]
>>> [index for index, v in enumerate(l) if v == 'boink']
[] 
```

如果你没有出现，你可以用布尔检查结果来检查，或者如果你循环结果，什么都不做：

```
indexes = [index for index, v in enumerate(l) if v == 'boink']
for index in indexes:
    do_something(index) 
```

### 使用 pandas 更好地处理数据

如果您有 pandas，您可以使用 Series 对象轻松获取此信息：

```
>>> import pandas as pd
>>> series = pd.Series(l)
>>> series
0    foo
1    bar
2    baz
3    bar
dtype: object 
```

比较检查将返回一系列布尔值：

```
>>> series == 'bar'
0    False
1     True
2    False
3     True
dtype: bool 
```

通过下标符号将该系列布尔值传递给该系列，您将获得匹配的成员：

```
>>> series[series == 'bar']
1    bar
3    bar
dtype: object 
```

如果您只需要索引，则 index 属性会返回一系列整数：

```
>>> series[series == 'bar'].index
Int64Index([1, 3], dtype='int64') 
```

如果您希望它们在列表或元组中，只需将它们传递给构造函数：

```
>>> list(series[series == 'bar'].index)
[1, 3] 
```

是的，您也可以将列表推导与 enumerate 一起使用，但这并不那么优雅，在我看来 - 您正在 Python 中进行相等性测试，而不是让用 C 编写的内置代码处理它：

```
>>> [i for i, value in enumerate(l) if value == 'bar']
[1, 3] 
```

## 这是[XY 问题](https://meta.stackexchange.com/a/66378/239121)吗？

> XY 问题是询问您尝试的解决方案，而不是您的实际问题。

为什么你认为你需要给定列表中的元素的索引？

如果您已经知道该值，为什么还要关心它在列表中的位置？

如果该值不存在，则捕获该`ValueError`值相当冗长-我更愿意避免这种情况。

无论如何，我通常会遍历列表，所以我通常会保留指向任何有趣信息的指针，[并通过枚举获取索引。](https://stackoverflow.com/q/522563/541136)

如果您正在处理数据，您可能应该使用 pandas - 它拥有比我展示的纯 Python 解决方法更优雅的工具。

我不记得需要`list.index`，我自己。但是，我浏览了 Python 标准库，发现它有一些出色的用途。

它有很多很多用途`idlelib`，用于 GUI 和文本解析。

该`keyword`模块使用它来查找模块中的注释标记，以通过元编程自动重新生成其中的关键字列表。

在 Lib/mailbox.py 中，它似乎像有序映射一样使用它：

```
key_list[key_list.index(old)] = new 
```

和

```
del key_list[key_list.index(key)] 
```

在lib/http/cookiejar.py中，好像是用来获取下个月的：

```
mon = MONTHS_LOWER.index(mon.lower())+1 
```

在 Lib/tarfile.py 中，类似于 distutils 来获得一个项目的切片：

```
members = members[:members.index(tarinfo)] 
```

在 Lib/pickletools.py 中：

```
numtopop = before.index(markobject) 
```

这些用法的共同点似乎是它们似乎在限制大小的列表上运行（很重要，因为 O(n) 的查找时间很重要`list.index`），并且它们主要用于解析（以及空闲情况下的 UI）。

虽然有它的用例，但它们并不常见。如果您发现自己正在寻找这个答案，请问问自己，您所做的是否是该语言为您的用例提供的工具的最直接使用。

* * *

## 回答 #12

> 赞同：31
> 
> 时间：2017-08-08T05:01:01.687

### 获取列表中一个或多个（相同）项目的所有出现和位置

使用 enumerate(alist) 您可以存储第一个元素 (n)，它是当元素 x 等于您要查找的内容时列表的索引。

```
>>> alist = ['foo', 'spam', 'egg', 'foo']
>>> foo_indexes = [n for n,x in enumerate(alist) if x=='foo']
>>> foo_indexes
[0, 3]
>>> 
```

### 让我们的函数 findindex

这个函数将项目和列表作为参数，并返回项目在列表中的位置，就像我们之前看到的那样。

```
def indexlist(item2find, list_or_string):
  "Returns all indexes of an item in a list or a string"
  return [n for n,item in enumerate(list_or_string) if item==item2find]

print(indexlist("1", "010101010")) 
```

* * *

**输出**

* * *

```
[1, 3, 5, 7] 
```

## 简单的

```
for n, i in enumerate([1, 2, 3, 4, 1]):
    if i == 1:
        print(n) 
```

输出：

```
0
4 
```

* * *

## 回答 #13

> 赞同：24
> 
> 时间：2015-11-11T05:16:38.490

[`zip`](https://docs.python.org/2/library/functions.html#zip)具有该功能的所有索引：

```
get_indexes = lambda x, xs: [i for (y, i) in zip(xs, range(len(xs))) if x == y]

print get_indexes(2, [1, 2, 3, 4, 5, 6, 3, 2, 3, 2])
print get_indexes('f', 'xsfhhttytffsafweef') 
```

* * *

## 回答 #14

> 赞同：22
> 
> 时间：2013-05-29T07:17:15.180

简单地你可以去

```
a = [['hand', 'head'], ['phone', 'wallet'], ['lost', 'stock']]
b = ['phone', 'lost']

res = [[x[0] for x in a].index(y) for y in b] 
```

* * *

## 回答 #15

> 赞同：19
> 
> 时间：2013-05-29T19:17:21.037

另外一个选项

```
>>> a = ['red', 'blue', 'green', 'red']
>>> b = 'red'
>>> offset = 0;
>>> indices = list()
>>> for i in range(a.count(b)):
...     indices.append(a.index(b,offset))
...     offset = indices[-1]+1
... 
>>> indices
[0, 3]
>>> 
```

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2014-12-30T21:03:10.157

# 而现在，为了完全不同的东西......

...就像在获取索引之前确认项目的存在。这种方法的好处是该函数总是返回一个索引列表——即使它是一个空列表。它也适用于字符串。

```
def indices(l, val):
    """Always returns a list containing the indices of val in the_list"""
    retval = []
    last = 0
    while val in l[last:]:
            i = l[last:].index(val)
            retval.append(last + i)
            last += i + 1   
    return retval

l = ['bar','foo','bar','baz','bar','bar']
q = 'bar'
print indices(l,q)
print indices(l,'bat')
print indices('abcdaababb','a') 
```

粘贴到交互式 python 窗口中时：

```
Python 2.7.6 (v2.7.6:3a1db0d2747e, Nov 10 2013, 00:42:54) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> def indices(the_list, val):
...     """Always returns a list containing the indices of val in the_list"""
...     retval = []
...     last = 0
...     while val in the_list[last:]:
...             i = the_list[last:].index(val)
...             retval.append(last + i)
...             last += i + 1   
...     return retval
... 
>>> l = ['bar','foo','bar','baz','bar','bar']
>>> q = 'bar'
>>> print indices(l,q)
[0, 2, 4, 5]
>>> print indices(l,'bat')
[]
>>> print indices('abcdaababb','a')
[0, 4, 5, 7]
>>> 
```

# 更新

经过一年的低调python开发，我对原来的答案有点尴尬，所以为了澄清事实，当然可以使用上面的代码；然而，获得相同行为*的更*惯用的方法是使用列表推导以及 enumerate() 函数。

像这样的东西：

```
def indices(l, val):
    """Always returns a list containing the indices of val in the_list"""
    return [index for index, value in enumerate(l) if value == val]

l = ['bar','foo','bar','baz','bar','bar']
q = 'bar'
print indices(l,q)
print indices(l,'bat')
print indices('abcdaababb','a') 
```

其中，当粘贴到交互式 python 窗口中时会产生：

```
Python 2.7.14 |Anaconda, Inc.| (default, Dec  7 2017, 11:07:58) 
[GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> def indices(l, val):
...     """Always returns a list containing the indices of val in the_list"""
...     return [index for index, value in enumerate(l) if value == val]
... 
>>> l = ['bar','foo','bar','baz','bar','bar']
>>> q = 'bar'
>>> print indices(l,q)
[0, 2, 4, 5]
>>> print indices(l,'bat')
[]
>>> print indices('abcdaababb','a')
[0, 4, 5, 7]
>>> 
```

现在，在查看了这个问题和所有答案之后，我意识到这正是[FMc](https://stackoverflow.com/users/55857/fmc)在他[之前的回答](https://stackoverflow.com/questions/176918/finding-the-index-of-an-item-given-a-list-containing-it-in-python/17300987#17300987)中所建议的。在我最初回答这个问题的时候，我什至没有*看到*那个答案，因为我不明白。我希望我更详细的示例将有助于理解。

如果上面的单行代码对您来说仍然*没有*意义，我强烈建议您谷歌“python 列表理解”并花几分钟时间熟悉一下。它只是使使用 Python 开发代码成为一种乐趣的众多强大功能之一。

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2014-03-28T09:11:57.203

来自 FMc 和 user7177 的答案的变体将给出一个可以返回任何条目的所有索引的 dict：

```
>>> a = ['foo','bar','baz','bar','any', 'foo', 'much']
>>> l = dict(zip(set(a), map(lambda y: [i for i,z in enumerate(a) if z is y ], set(a))))
>>> l['foo']
[0, 5]
>>> l ['much']
[6]
>>> l
{'baz': [2], 'foo': [0, 5], 'bar': [1, 3], 'any': [4], 'much': [6]}
>>> 
```

您也可以将其用作一个衬里来获取单个条目的所有索引。尽管我确实使用 set(a) 来减少调用 lambda 的次数，但不能保证效率。

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2018-05-25T21:56:07.317

查找列表 L 中项目 x 的索引：

```
idx = L.index(x) if (x in L) else -1 
```

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2015-05-17T03:21:00.660

此解决方案不如其他解决方案强大，但如果您是初学者并且只了解`for`循环，则仍然可以在避免 ValueError 的同时找到项目的第一个索引：

```
def find_element(p,t):
    i = 0
    for e in p:
        if e == t:
            return i
        else:
            i +=1
    return -1 
```

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2020-08-28T09:35:53.347

有可能该值可能不存在，因此为了避免此 ValueError，我们可以检查该值是否确实存在于 list 中。

```
list =  ["foo", "bar", "baz"]

item_to_find = "foo"

if item_to_find in list:
      index = list.index(item_to_find)
      print("Index of the item is " + str(index))
else:
    print("That word does not exist") 
```

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2022-01-13T19:49:59.767

我的朋友，我已经制作了最简单的代码来解决你的问题。当您收到大量代码时，我在这里为您提供两行代码，这都是由于`index()`python 中的函数的帮助。

```
LIST = ['foo' ,'boo', 'shoo']
print(LIST.index('boo')) 
```

输出：

```
1 
```

我希望我给了你最好和最简单的答案，这可能会对你有很大帮助。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2015-07-05T13:12:19.287

```
name ="bar"
list = [["foo", 1], ["bar", 2], ["baz", 3]]
new_list=[]
for item in list:
    new_list.append(item[0])
print(new_list)
try:
    location= new_list.index(name)
except:
    location=-1
print (location) 
```

这说明了字符串是否也在列表中，如果它不在列表中，则`location = -1`

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2018-03-04T08:39:34.357

如果未找到该项目， Python`index()`方法将引发错误。因此，您可以使其类似于`indexOf()`JavaScript 的函数，`-1`如果未找到该项目则返回：

```
try:
    index = array.index('search_keyword')
except ValueError:
    index = -1 
```

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2020-06-22T16:02:01.873

### 对于一个可比的

```
# Throws ValueError if nothing is found
some_list = ['foo', 'bar', 'baz'].index('baz')
# some_list == 2 
```

### 自定义谓词

```
some_list = [item1, item2, item3]

# Throws StopIteration if nothing is found
# *unless* you provide a second parameter to `next`
index_of_value_you_like = next(
    i for i, item in enumerate(some_list)
    if item.matches_your_criteria()) 
```

### 按谓词查找所有项目的索引

```
index_of_staff_members = [
    i for i, user in enumerate(users)
    if user.is_staff()] 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2021-04-10T07:48:03.217

它只使用 python 函数`array.index()`和一个简单的 Try / except，如果在列表中找到它则返回记录的位置，如果在列表中找不到则返回 -1（就像在 JavaScript 上使用 function 一样`indexOf()`）。

```
fruits = ['apple', 'banana', 'cherry']

try:
  pos = fruits.index("mango")
except:
  pos = -1 
```

在这种情况下，列表中不存在“芒果”，`fruits`因此`pos`变量为 -1，如果我搜索“樱桃”，则`pos`变量将为 2。

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2018-03-07T19:09:44.717

对此有一个更实用的答案。

```
list(filter(lambda x: x[1]=="bar",enumerate(["foo", "bar", "baz", "bar", "baz", "bar", "a", "b", "c"]))) 
```

更通用的形式：

```
def get_index_of(lst, element):
    return list(map(lambda x: x[0],\
       (list(filter(lambda x: x[1]==element, enumerate(lst)))))) 
```

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2017-08-12T20:01:08.917

由于 Python 列表是从零开始的，我们可以使用 zip 内置函数，如下所示：

```
>>> [i for i,j in zip(range(len(haystack)), haystack) if j == 'needle' ] 
```

其中“haystack”是有问题的列表，“needle”是要查找的项目。

（注意：这里我们使用 i 进行迭代以获取索引，但如果我们需要专注于项目，我们可以切换到 j。）

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2020-04-03T16:50:22.850

如果您要查找一次索引，那么使用“索引”方法就可以了。但是，如果您要多次搜索数据，那么我建议使用[bisect](https://docs.python.org/3/library/bisect.html)模块。请记住，必须对使用 bisect 模块的数据进行排序。因此，您对数据进行一次排序，然后您可以使用 bisect。在我的机器上使用[bisect](https://docs.python.org/3/library/bisect.html)模块比使用索引方法快大约 20 倍。

以下是使用 Python 3.8 及以上语法的代码示例：

```
import bisect
from timeit import timeit

def bisect_search(container, value):
    return (
      index 
      if (index := bisect.bisect_left(container, value)) < len(container) 
      and container[index] == value else -1
    )

data = list(range(1000))
# value to search
value = 666

# times to test
ttt = 1000

t1 = timeit(lambda: data.index(value), number=ttt)
t2 = timeit(lambda: bisect_search(data, value), number=ttt)

print(f"{t1=:.4f}, {t2=:.4f}, diffs {t1/t2=:.2f}") 
```

输出：

```
t1=0.0400, t2=0.0020, diffs t1/t2=19.60 
```

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2021-10-03T14:09:11.853

我发现这两种解决方案更好，我自己尝试过

```
>>> expences = [2200, 2350, 2600, 2130, 2190]
>>> 2000 in expences
False
>>> expences.index(2200)
0
>>> expences.index(2350)
1
>>> index = expences.index(2350)
>>> expences[index]
2350

>>> try:
...     print(expences.index(2100))
... except ValueError as e:
...     print(e)
... 
2100 is not in list
>>> 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2018-01-30T21:10:12.370

对于像我这样来自其他语言的人来说，也许通过一个简单的循环更容易理解和使用它：

```
mylist = ["foo", "bar", "baz", "bar"]
newlist = enumerate(mylist)
for index, item in newlist:
  if item == "bar":
    print(index, item) 
```

我很感激*[那么枚举到底是做什么的呢？](https://www.codecademy.com/en/forum_questions/5087f2d786a27b02000041a9)*. 这有助于我理解。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2018-09-10T18:51:04.540

# 如果关注性能：

在许多答案中都提到方法的内置`list.index(item)`方法是O（n）算法。如果您需要执行一次，这很好。但是，如果您需要多次访问元素的索引，那么首先创建一个包含项目索引对的字典 (O(n))，然后在每次需要时访问 O(1) 时的索引会更有意义它。

如果您确定列表中的项目不会重复，您可以轻松：

```
myList = ["foo", "bar", "baz"]

# Create the dictionary
myDict = dict((e,i) for i,e in enumerate(myList))

# Lookup
myDict["bar"] # Returns 1
# myDict.get("blah") if you don't want an error to be raised if element not found. 
```

如果您可能有重复的元素，并且需要返回它们的所有索引：

```
from collections import defaultdict as dd
myList = ["foo", "bar", "bar", "baz", "foo"]

# Create the dictionary
myDict = dd(list)
for i,e in enumerate(myList):
    myDict[e].append(i)

# Lookup
myDict["foo"] # Returns [0, 4] 
```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2018-11-14T18:49:26.307

让我们为`lst`您拥有的列表命名。可以将列表转换`lst`为`numpy array`. 然后，使用[numpy.where](https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.where.html)获取列表中所选项目的索引。以下是您实施它的方式。

```
import numpy as np

lst = ["foo", "bar", "baz"]  #lst: : 'list' data type
print np.where( np.array(lst) == 'bar')[0][0]

>>> 1 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2021-12-29T18:49:45.980

python 中的某些结构包含一个索引方法，可以很好地解决这个问题。

```
'oi tchau'.index('oi')     # 0
['oi','tchau'].index('oi') # 0
('oi','tchau').index('oi') # 0 
```

参考：

[在列表中](https://www.programiz.com/python-programming/methods/list/index)

[在元组中](https://www.programiz.com/python-programming/methods/list/index)

[在字符串中](https://www.programiz.com/python-programming/methods/list/index)

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2022-01-07T00:08:04.047

```
text = ["foo", "bar", "baz"]
target = "bar"

[index for index, value in enumerate(text) if value == target] 
```

> 对于一小部分元素，这可以正常工作。但是，如果列表包含大量元素，最好**使用 O(log n) 运行时复杂度的二进制搜索** 。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2022-02-07T10:46:48.563

列表理解将是在查找列表中项目的索引时获得紧凑实现的最佳选择。

```
a_list = ["a", "b", "a"]
print([index for (index , item) in enumerate(a_list) if item == "a"]) 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2018-09-25T15:47:56.120

正如@TerryA 所指出的，许多答案都讨论了如何找到*一个*索引。

[`more_itertools`](https://github.com/erikrose/more-itertools)是一个第三方库，带有用于在一个可迭代对象中定位*多个索引的工具。*

**给定**

```
import more_itertools as mit

iterable = ["foo", "bar", "baz", "ham", "foo", "bar", "baz"] 
```

**代码**

查找多个观测值的索引：

```
list(mit.locate(iterable, lambda x: x == "bar"))
# [1, 5] 
```

测试多个项目：

```
list(mit.locate(iterable, lambda x: x in {"bar", "ham"}))
# [1, 3, 5] 
```

另请参阅更多选项[`more_itertools.locate`](https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.locate)。通过安装[`> pip install more_itertools`](https://github.com/erikrose/more-itertools)。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2019-03-18T09:32:09.893

使用字典，首先处理列表，然后将索引添加到它

```
from collections import defaultdict

index_dict = defaultdict(list)    
word_list =  ['foo','bar','baz','bar','any', 'foo', 'much']

for word_index in range(len(word_list)) :
    index_dict[word_list[word_index]].append(word_index)

word_index_to_find = 'foo'       
print(index_dict[word_index_to_find])

# output :  [0, 5] 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2021-11-28T12:37:15.867

Pythonic 方式可以使用`enumerate`，但您也可以[`indexOf`](https://docs.python.org/3/library/operator.html#operator.indexOf)从`operator`模块中使用。请注意，[`ValueError`如果`b`不在`a`.](https://github.com/python/cpython/blob/3.10/Lib/operator.py#L179)

```
>>> from operator import indexOf
>>>
>>>
>>> help(indexOf)
Help on built-in function indexOf in module _operator:

indexOf(a, b, /)
    Return the first index of b in a.

>>>
>>>
>>> indexOf(("foo", "bar", "baz"), "bar") # with tuple
1
>>> indexOf(["foo", "bar", "baz"], "bar") # with list
1 
```

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2021-05-04T12:28:48.487

简单的选项：

```
a = ["foo", "bar", "baz"]
[i for i in range(len(a)) if a[i].find("bar") != -1] 
```

# naming - 你在你的程序中使用“kibibyte”作为度量单位吗？

> ID：176922
> 
> 赞同：25
> 
> 时间：2008-10-07T01:41:31.927
> 
> 标签：naming, units-of-measurement

几十年来，在计算领域（磁盘制造商除外），1 KB（千字节）被理解为 1024 字节。在过去的几年里，出现了用 KiB（“kibibyte”）来表示 1024 字节的运动，*将千字节的含义改为 1000 字节*，注定了我们会陷入更多年的困惑。另一方面，该运动似乎仅限于 Gnome，以及一些[过分热心的维基百科编辑](http://en.wikipedia.org/wiki/Talk:Kilobyte#Kibibyte.3F)。

*你会将你的程序转换为使用 KiB 吗？*如果您曾经以 KB 显示文件大小，您是除以 1000 还是 1024？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-07T01:44:30.457

KB 是 1024 字节，该死的。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-07T03:16:00.660

我以前在一个应用程序中做过一次。虽然它在内部使用了 kibbi 和 mebbi（KiB、MiB 等），但它仍会显示用户（在本例中为 IT 人员）习惯的内容。底层字段只是一个以字节 IIRC 为单位的 long。

它是向前兼容的，至少允许您输入 4 GB 和 4GiB。它还理解像 4.5G 这样的速记输入，并适当地四舍五入到实际的字节数——而不是强迫可怜的用户必须以这种方式输入并防止他们的错误。更新为使用 IEC 表示法是 1 行代码。

* * *

公斤是 1000 和 98% 的世界使用公制。我们需要克服它。

我在许多让我困惑的反应中看到了很多愤怒。SI 前缀是 SI 前缀，程序员无权更改它们，没有比方便和自定义更好的理由。奇怪的是，计算机科学这个高度技术性的领域，却吵着要回到肘弗隆和棒的时代。什么？

*我们*都知道我们的意思，但坚持习惯会疏远和混淆用户。仅仅因为在早期的先驱时代，有些人在谈论计算机内存时决定重用 SI 表示法并不意味着他们这样做是正确的。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-10-07T05:48:29.183

在我看来，1 千字节等于 1000 字节是驱动器制造商希望您相信的，这样您的驱动器看起来比实际更宽敞。;)

![如果它听起来不像“Kibbles N Bits”，我会更认真地对待“kibibyte”](https://imgs.xkcd.com/comics/kilobyte.png)

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-10-07T01:49:19.400

由于我在转专业之前花了几年时间学习成为一名机械工程师，我不得不承认“公斤”对我来说总是意味着 10^3。从这个角度来看，KiB 是有道理的。然而，试着大声说几次“kibibyte”，想想你听起来有多笨。

因此，千克为 1000 克，千字节为 1024 字节。

附录：此外，我同意那些说我们不应该改变已经建立的东西，如果它有效的话。1024 只是一个更好的二进制数字。此外，“kibibyte”听起来仍然像狗吃的东西。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-10-07T01:44:51.390

有两种方法可以考虑这个问题：

1.  使用您正在运行的操作系统使用的内容。这样用户就有了一致的体验。

2.  使用正确的。

如果您始终使用 KiB，则不会造成混淆。如果你使用 KB 会有混乱。因此，如果您选择选项 #2，那么您最好实际使用 1024 并使用 KiB 后缀。无论如何，使用 2 的幂会更有效。

这取决于您，但我的经验法则是，如果您有技术受众，请使用 KiB 并避免所有混淆。如果您有大量非技术用户，那么请使用您的操作系统使用的内容。顺便说一句，Windows 使用 KB 来表示 1024 字节。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-10-07T01:48:25.907

它不会改变“千字节”的含义。Kilo 表示 1000。有些人错误地使用它来指代 1024 字节的单位。

我从不以千字节为单位显示文件大小，因为用户不关心 1000 与 1024。相反，我总是使用“XXX KB/MB/GB”，其中 XXX 是字节数除以 1000/100 万等。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-10-07T02:31:17.367

专业领域总是以该专业所理解的方式使用术语。例如，建造桥梁的机械工程师使用“压力”一词来表示完全不同的东西，例如，发现他的明星证人在法庭上第一天撒谎的律师。我们是否应该强制工程师使用与律师相同的“压力”定义，仅仅因为该定义被更广泛地使用？如果我们这样做，我不会开车过那座桥！

千字节 = 1024 字节。它是行业公认的术语专业化。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-08T11:30:02.160

我使用 KiB。

你真的想通过拒绝使用像 IE 一样完善的标准来伤害每个人吗？

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-10-07T01:44:53.030

我总是以 1000 字节千字节显示文件大小。对于无法区分的人来说，这几乎无关紧要，当他们看到实际数字时，通常会减轻困惑。四舍五入时 65323 字节 = 65Kb，“正常”人就是这样。

我可能永远不会显示“KiB”，因为这绝不是我的客户想要的。

决定不遵循不仅仅由计算机社区创建的标准的傲慢（见...... Kilo 实际上意味着 1000 并不是“新的”）令人震惊。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2009-08-29T16:22:04.903

只有当情况需要时。在几乎所有情况下，以 1,000 为基础的单位更为合适。

我知道的唯一例外是内存，因为它自然是 2 的幂的倍数，以及 CD 的大小，因为它是由制造商以 2 ^(20)字节的倍数来衡量的。其他一切，包括硬盘驱动器、DVD、闪存驱动器、带宽、处理器速度、内存总线等，目前都以 1000 秒为单位，文件大小也应该如此。（或者，至少，我和[史蒂夫·乔布斯](http://www.tuaw.com/2009/08/29/snow-leopard-the-new-one-gigabyte-now-slimmer-than-before/)是这么认为的。Windows 可能会继续以 1024 年测量文件大小......）

为避免混淆用户，请使用 k- = 1,000 和 Ki- = 1,024。

“k”的草率用法表示 1024 是一种邪恶的可憎之物，应该用火杀死。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2011-11-16T05:08:15.113

Mac OS X 不使用 KiB、MiB、GiB。另一方面，当它使用公制时，它至少可以正确地进行数学运算：

![Mac OS X 截图](https://i.stack.imgur.com/QRroD.png)

就我个人而言，我更喜欢把这些东西做好，以便目前处于黑暗中的用户可以从中学习。等待用户先改变是愚蠢的。用户不会有一天突然醒来并认为一千字节是 1024 字节 - 是软件让他们这样认为，那么纠正错误不应该是软件的工作吗？

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2008-10-07T06:00:35.743

我在存储行业工作了十年。关于 TB 大小的参数可以将解决方案的大小改变 10%。简而言之：程序员和存储行业使用不同的度量。两者都不是一直正确的。

[存储网络行业协会](http://www.snia.org/home)(SNIA) 字典将[千字节定义](http://www.snia.org/education/dictionary/k/)为：

> **千字节 (KB)**
> 
> [常规] 1,000 (10^3)​​ 字节。
> 
> SNIA 使用存储和数据传输相关文献中常见的 10^3 约定，而不是计算机系统随机存取存储器和软件文献中常见的 1,024 (2^10) 约定。

我的经验法则是：

*   以 1024^n 字节块为单位测量网络上的内存、文件、文件系统和数据。
*   以 1000^n 字节块为单位测量原始磁盘空间——并且*仅测量原始磁盘空间。*
*   告诉客户您使用的是哪个单位。经常重复自己。

总的来说，这让我摆脱了麻烦。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-09-10T00:13:10.617

我正在开发的一个程序默认使用“KiB”，但用户偏好使用哪种测量单位（KiB 中的 1024 B、KB 中的 1024 B 或 KB 中的 1000 B）。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-08T11:17:16.163

从技术上讲 KiB 是正确的，但我只在少数应用程序（主要是 linux 控制台应用程序）中看到它。用户要么习惯于为 KB 和 KiB（IT 人员）使用 1024，要么他们并不真正关心并且会认为“KiB”拼写错误（非 IT 人员）。

但是：我已经习惯使用“千字节 = 1024 字节”已有 20 多年了，即使我知道它在科学上是错误的，也会继续使用它。

如果您需要提供 KiB 以让您的灵魂得到休息，请将其作为一个选项提供，但不要将可怜的用户与另一个定义混淆 - 特别是如果他们使用使用非科学方法并定义 KB 的操作系统为 1024。

（顺便说一句：Kibibytes 总是让我想起[Tinky Winky](http://en.wikipedia.org/wiki/Tinky_Winky)和他的[朋友们](http://en.wikipedia.org/wiki/Teletubbies)……；））

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-07T06:25:00.547

我在教我的学生时尝试开始使用这些术语，但我现在有点放弃了。

我教过一门计算机入门课程（“*这*是一个*磁盘驱动器*") 几次，这可能会让学生感到困惑，前缀在不同的上下文中表示不同的东西。当你有 1 千字节或 1 千比特的数据时，Kilo 表示 1024，除非你将它存储在磁盘上，当它是 1000 时，如果你通过网络每秒发送一个千比特，那么它是 1000，千赫兹当然也是 1000。而一公里的光缆是 1000 米！但事实证明，这真的不是什么大问题.工程和计算机科学的学生需要知道区别，反正他们会习惯的。当我在数据库课程或编译器课程中再次遇到他们时，对于不同种类的公斤、兆和其他领域（媒体设计等）的学生并不真正关心。

在我对大学走廊里的其他计算机科学人员进行了一次非正式调查后，发现他们中的大多数人从未听说过这些新前缀，我绝对放弃了。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-07T12:16:30.303

没有。1024 字节是一千字节，不管这是否有意义。

过去对 1024 字节单位使用“kilo-”前缀可能是一个错误。但它现在是标准。现在试图改变它只会增加混乱。

我们没有按照应有的方式对待这个世界；我们处理世界的本来面目。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-07T18:21:04.250

A KB 是 1024 字节 A kB 是 1000 字节不幸的是拼写不明确。我总是用1024。

Knuth 将 MB 称为 KKBytes 或 kkBytes 以区分 1024*1024 和 1000*1000

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-07T01:49:05.563

在计算机基于十进制之前，我仍然会测量 2 ^(10*n ...)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-07T05:52:28.287

当您在十进制数字系统中工作时，Kilo 表示 10^3。

当您在二进制数字系统中工作时，Kilo 表示 2^10。

我的意思是，看看它......他们都很随意。在我看来，其他任何事情都同样是任意的——所以我们有 40 年根深蒂固的任意与全新的任意。哪个应该赢？现在，我投票支持根深蒂固的方法，仅仅是因为它会减少完全的混乱。

在某些时候，我们的技术必然会发生变化——想想量子/基因计算机——那将是净化我们的测量系统的好机会。

此外，一些用户总是会感到困惑——我们是否应该为他们消除困惑，冒着让这一切发生的社区（我们和硬件人员）感到困惑的风险？我想不是。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-10-07T01:45:51.827

老实说，我从来没有听说过这个，我怀疑它会在主流使用中获得很大的吸引力。我无法想象我为什么要开始这样做。当前千字节的定义是准确且充分的。我更愿意看到硬盘制造商开始使用准确的术语，而不是进一步愚蠢的技术术语。为什么制造商既不能制造大小正好为 xGB 的驱动器，也不能简单地说出它们的真实情况？

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-10-07T01:46:50.823

除了对术语需要如何更改的咆哮之外，我从未听说过使用这些表达方式。它不会流行起来。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2009-09-10T00:21:30.167

对我来说，这有点像我们过去的“黑客”论点。

根据您的年龄和顽固程度，“黑客”对您来说可能意味着不同的东西。有一段时间，在媒体上（可能仍然是今天，部分仍然如此）人们认为黑客攻击是非法侵入机器的行为。但是，在现在的行业中，人们得到的感觉是，这是一个喜欢摆弄东西的人。

有一段时间，安全社区不确定这是否会成功，我们实际上尝试使用“cracker”来指代坏人。我认为饼干并没有像我们希望的那样真正起飞，但我们已经将“黑客”作为一个合法的术语，并取得了相当大的成功。

所以对我来说这也是一样的：仅仅因为媒体试图将 KB 视为`1,000`，我永远不会退缩，并且始终坚持剩余 24 位的权利。

24bFL

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2008-10-07T01:46:13.183

Drivemaker/denary 千字节可以在地狱中燃烧。二进制机器的二进制单位。

# msbuild - 给定相对路径时，如何让 MSBUILD 评估和打印完整路径？

> ID：176931
> 
> 赞同：61
> 
> 时间：2008-10-07T01:45:44.087
> 
> 标签：msbuild, relative-path, absolute-path

在给定相对路径的情况下，如何让 MSBuild 在`<Message />`任务中评估和打印绝对路径？

**物业集团**

```
<Source_Dir>..\..\..\Public\Server\</Source_Dir>
<Program_Dir>c:\Program Files (x86)\Program\</Program_Dir> 
```

**任务**

```
<Message Importance="low" Text="Copying '$(Source_Dir.FullPath)' to '$(Program_Dir)'" /> 
```

**输出**

> 将 '' 复制到 'c:\Program Files (x86)\Program\'

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-08-09T11:22:53.097

**在 MSBuild 4.0**中，最简单的方法如下：

```
$([System.IO.Path]::GetFullPath('$(MSBuildThisFileDirectory)\your\path')) 
```

即使脚本被`<Import>`编入另一个脚本，此方法也有效；路径是相对于包含上述代码的文件的。

（合并自[Aaron 的回答](https://stackoverflow.com/a/4894456/33080)以及[Sayed 回答](https://stackoverflow.com/a/2421596/33080)的最后一部分）

* * *

**在 MSBuild 3.5**中，您可以使用[ConvertToAbsolutePath](http://msdn.microsoft.com/en-us/library/bb882668.aspx "转换为绝对路径")任务：

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
         DefaultTargets="Test"
         ToolsVersion="3.5">
  <PropertyGroup>
    <Source_Dir>..\..\..\Public\Server\</Source_Dir>
    <Program_Dir>c:\Program Files (x86)\Program\</Program_Dir>
  </PropertyGroup>

  <Target Name="Test">
    <ConvertToAbsolutePath Paths="$(Source_Dir)">
      <Output TaskParameter="AbsolutePaths" PropertyName="Source_Dir_Abs"/>
    </ConvertToAbsolutePath>
    <Message Text='Copying "$(Source_Dir_Abs)" to "$(Program_Dir)".' />
  </Target>
</Project> 
```

相关输出：

```
Project "P:\software\perforce1\main\XxxxxxXxxx\Xxxxx.proj" on node 0 (default targets).
  Copying "P:\software\Public\Server\" to "c:\Program Files (x86)\Program\". 
```

如果你问我，有点啰嗦，但它有效。这将与“原始”项目文件相关，因此如果放置在一个被`<Import>`编辑的文件中，这将与该文件无关。

* * *

**在 MSBuild 2.0**中，有一种方法不能解决“..”。然而，它的行为就像绝对路径：

```
<PropertyGroup>
    <Source_Dir_Abs>$(MSBuildProjectDirectory)\$(Source_Dir)</Source_Dir_Abs>
</PropertyGroup> 
```

[$(MSBuildProjectDirectory)](http://msdn.microsoft.com/en-us/library/ms164309%28VS.80%29.aspx)保留属性始终是包含此引用的脚本的目录。

这也将与“原始”项目文件相关，因此如果放置在被`<Import>`编辑的文件中，这将与该文件无关。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2011-02-04T04:05:21.310

MSBuild 4.0 添加了[属性函数](http://msdn.microsoft.com/en-us/library/dd633440.aspx)，允许您调用某些 .net 系统 dll 中的静态函数。属性函数的一个非常好的事情是它们将评估目标的外部。

要评估完整路径，您可以在定义如下属性时使用[System.IO.Path.GetFullPath ：](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)

```
<PropertyGroup>
  <Source_Dir>$([System.IO.Path]::GetFullPath('..\..\..\Public\Server\'))</Source_Dir>
</PropertyGroup> 
```

语法有点难看，但非常强大。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-07T03:32:33.030

Wayne 是正确的，众所周知的元数据不适用于属性 - 仅适用于项目。使用诸如“MSBuildProjectDirectory”之类的属性将起作用，但我不知道解决完整路径的内置方法。

另一种选择是编写一个简单的自定义任务，该任务将采用相对路径并吐出完全解析的路径。它看起来像这样：

```
public class ResolveRelativePath : Task
{
    [Required]
    public string RelativePath { get; set; }

    [Output]
    public string FullPath { get; private set; }

    public override bool Execute()
    {
        try
        {
            DirectoryInfo dirInfo = new DirectoryInfo(RelativePath);
            FullPath = dirInfo.FullName;
        }
        catch (Exception ex)
        {
            Log.LogErrorFromException(ex);
        }
        return !Log.HasLoggedErrors;
    }
} 
```

你的 MSBuild 行看起来像：

```
<PropertyGroup>
    <TaskAssembly>D:\BuildTasks\Build.Tasks.dll</TaskAssembly>
    <Source_Dir>..\..\..\Public\Server\</Source_Dir>
    <Program_Dir>c:\Program Files (x86)\Program\</Program_Dir>
</PropertyGroup>
<UsingTask AssemblyFile="$(TaskAssembly)" TaskName="ResolveRelativePath" />

<Target Name="Default">
    <ResolveRelativePath RelativePath="$(Source_Dir)">
    <Output TaskParameter="FullPath" PropertyName="_FullPath" />
    </ResolveRelativePath>
    <Message Importance="low" Text="Copying '$(_FullPath)' to '$(Program_Dir)'" />
</Target> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-07T03:38:19.400

您正在尝试通过属性访问项目元数据属性，这是不可能的。你想要做的是这样的：

```
<PropertyGroup>
  <Program_Dir>c:\Program Files (x86)\Program\</Program_Dir>
</PropertyGroup>
<ItemGroup>
   <Source_Dir Include="..\Desktop"/>
</ItemGroup>     
<Target Name="BuildAll">
   <Message Text="Copying '%(Source_Dir.FullPath)' to '$(Program_Dir)'" />
</Target> 
```

这将生成输出为：

```
 Copying 'C:\Users\sdorman\Desktop' to 'c:\Program Files (x86)\Program\' 
```

（该脚本是从我的 Documents 文件夹中运行的，因此 ..\Desktop 是访问我的桌面的正确相对路径。）

在您的情况下，将 Source_Dir 项目中的“..\Desktop”替换为“......\Public\Server”，您应该已经准备就绪。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-07T16:24:50.693

如果您需要将属性转换为项目，您有两种选择。使用 msbuild 2，您可以使用**CreateItem**任务

```
 <Target Name='Build'>
    <CreateItem Include='$(Source_Dir)'>
      <Output ItemName='SRCDIR' TaskParameter='Include' />
    </CreateItem> 
```

并且使用 MSBuild 3.5，您可以在 Task 中包含 ItemGroups

```
 <Target Name='Build'>
    <ItemGroup>
      <SRCDIR2 Include='$(Source_Dir)' />
    </ItemGroup>
    <Message Text="%(SRCDIR2.FullPath)" />
    <Message Text="%(SRCDIR.FullPath)" />
  </Target> 
```

# python - 使用 Google Gears 离线访问 MoinMoin wiki

> ID：176955
> 
> 赞同：5
> 
> 时间：2008-10-07T01:53:38.330
> 
> 标签：python, wiki, offline, google-gears, moinmoin

如何向[MoinMoin wiki](http://moinmo.in)添加离线访问功能？

至少，我希望能够浏览访问基于服务器的 wiki 上的所有页面（离线时）。搜索和其他不修改内容的东西是次要的。如果此解决方案允许在离线时更新 wiki 内容并在在线时将其推送回 wiki，则额外的好处是。

Google Gears 看起来是尝试解决此问题的不错选择，但也欢迎其他解决方案。

MoinMoin 的一个有趣特性是它将内容保存在常规文件而不是数据库中。这可以更容易地将 wiki 内容从一个位置移植到另一个位置，但我不知道这是否可以在回答这个问题时发挥任何作用。

注意：如果你看到一个好的回复，请给它评分。我很乐意这样做，但该网站还不允许我进行评级。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T02:10:26.143

如果您可以自由更改 wiki 软件，我可能会建议您查看[ikiwiki](http://ikiwiki.info)。您可以对其进行设置，以便页面由 Git 等真正的 VCS 支持，在这种情况下，您可以克隆整个 wiki 并阅读甚至离线更新它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T12:27:47.910

*通过使用带有 Firefox Greasemonkey 插件的 Gears，您可以将 Gears 代码注入您想要的任何网站。不要等待您最喜欢的网站启用离线支持 - 自己动手。* [http://code.google.com/apis/gears/articles/gearsmonkey.html](http://code.google.com/apis/gears/articles/gearsmonkey.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-06T11:53:57.307

如果您有足够的耐心，MoinMoin 2.0 版将附带 Mercurial DVCS 后端，因此您无需切换。[有关http://moinmo.in/MoinMoin2.0](http://moinmo.in/MoinMoin2.0)的更多信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-19T12:42:53.490

*   如果您想在服务器上执行此操作，请参阅 moinmoin + DesktopEdition 中的 HelpOnSynchronisation
*   如果在本地，请使用 [unison](http://www.cis.upenn.edu/~bcpierce/unison/) + DesktopEdition 。小心忽略缓存等。这将允许双向同步。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-07T05:33:30.290

看看[MoinMoin 桌面版](http://moinmo.in/DesktopEdition)。

# sql - 为每个类别选择前 10 条记录

> ID：176964
> 
> 赞同：247
> 
> 时间：2008-10-07T02:01:24.603
> 
> 标签：sql, sql-server, sql-server-2005, greatest-n-per-group

我想在一个查询中返回每个部分的前 10 条记录。任何人都可以帮助如何做到这一点？节是表中的列之一。

数据库是 SQL Server 2005。我想按输入的日期返回前 10 名。部分是业务、本地和功能。对于某个特定日期，我只想要前 (10) 个业务行（最近的条目）、前 (10) 个本地行和前 (10) 个特征。

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2008-10-07T02:13:52.423

如果您使用的是 SQL 2005，则可以执行以下操作...

```
SELECT rs.Field1,rs.Field2 
    FROM (
        SELECT Field1,Field2, Rank() 
          over (Partition BY Section
                ORDER BY RankCriteria DESC ) AS Rank
        FROM table
        ) rs WHERE Rank <= 10 
```

如果您的 RankCriteria 有联系，那么您可能会返回 10 多行，而 Matt 的解决方案可能更适合您。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2012-06-25T10:16:59.370

在 T-SQL 中，我会这样做：

```
WITH TOPTEN AS (
    SELECT *, ROW_NUMBER() 
    over (
        PARTITION BY [group_by_field] 
        order by [prioritise_field]
    ) AS RowNo 
    FROM [table_name]
)
SELECT * FROM TOPTEN WHERE RowNo <= 10 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2012-06-15T14:26:32.557

```
SELECT r.*
FROM
(
    SELECT
        r.*,
        ROW_NUMBER() OVER(PARTITION BY r.[SectionID]
                          ORDER BY r.[DateEntered] DESC) rn
    FROM [Records] r
) r
WHERE r.rn <= 10
ORDER BY r.[DateEntered] DESC 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-10-07T02:09:02.107

这适用于 SQL Server 2005（编辑以反映您的说明）：

```
select *
from Things t
where t.ThingID in (
    select top 10 ThingID
    from Things tt
    where tt.Section = t.Section and tt.ThingDate = @Date
    order by tt.DateEntered desc
    )
    and t.ThingDate = @Date
order by Section, DateEntered desc 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-10-07T04:07:06.453

我这样做：

```
SELECT a.* FROM articles AS a
  LEFT JOIN articles AS a2 
    ON a.section = a2.section AND a.article_date <= a2.article_date
GROUP BY a.article_id
HAVING COUNT(*) <= 10; 
```

* * *

**更新：** 此 GROUP BY 示例仅适用于 MySQL 和 SQLite，因为这些数据库比有关 GROUP BY 的标准 SQL 更宽松。大多数 SQL 实现要求选择列表中不属于聚合表达式的所有列也在 GROUP BY 中。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2014-12-26T15:05:26.147

如果我们使用 SQL Server >= 2005，那么我们可以只用一个*选择*来解决任务：

```
declare @t table (
    Id      int ,
    Section int,
    Moment  date
);

insert into @t values
(   1   ,   1   , '2014-01-01'),
(   2   ,   1   , '2014-01-02'),
(   3   ,   1   , '2014-01-03'),
(   4   ,   1   , '2014-01-04'),
(   5   ,   1   , '2014-01-05'),

(   6   ,   2   , '2014-02-06'),
(   7   ,   2   , '2014-02-07'),
(   8   ,   2   , '2014-02-08'),
(   9   ,   2   , '2014-02-09'),
(   10  ,   2   , '2014-02-10'),

(   11  ,   3   , '2014-03-11'),
(   12  ,   3   , '2014-03-12'),
(   13  ,   3   , '2014-03-13'),
(   14  ,   3   , '2014-03-14'),
(   15  ,   3   , '2014-03-15');

-- TWO earliest records in each Section

select top 1 with ties
    Id, Section, Moment 
from
    @t
order by 
    case 
        when row_number() over(partition by Section order by Moment) <= 2 
        then 0 
        else 1 
    end;

-- THREE earliest records in each Section

select top 1 with ties
    Id, Section, Moment 
from
    @t
order by 
    case 
        when row_number() over(partition by Section order by Moment) <= 3 
        then 0 
        else 1 
    end;

-- three LATEST records in each Section

select top 1 with ties
    Id, Section, Moment 
from
    @t
order by 
    case 
        when row_number() over(partition by Section order by Moment desc) <= 3 
        then 0 
        else 1 
    end; 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-07T02:10:05.113

如果您知道这些部分是什么，您可以执行以下操作：

```
select top 10 * from table where section=1
union
select top 10 * from table where section=2
union
select top 10 * from table where section=3 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-02-14T12:10:18.583

我知道这个帖子有点老了，但我刚刚遇到了一个类似的问题（从每个类别中选择最新的文章），这是我想出的解决方案：

```
WITH [TopCategoryArticles] AS (
    SELECT 
        [ArticleID],
        ROW_NUMBER() OVER (
            PARTITION BY [ArticleCategoryID]
            ORDER BY [ArticleDate] DESC
        ) AS [Order]
    FROM [dbo].[Articles]
)
SELECT [Articles].* 
FROM 
    [TopCategoryArticles] LEFT JOIN 
    [dbo].[Articles] ON
        [TopCategoryArticles].[ArticleID] = [Articles].[ArticleID]
WHERE [TopCategoryArticles].[Order] = 1 
```

这与 Darrel 的解决方案非常相似，但克服了可能返回比预期更多行的 RANK 问题。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-11-12T06:55:10.417

尝试了以下方法，它也适用于领带。

```
SELECT rs.Field1,rs.Field2 
FROM (
    SELECT Field1,Field2, ROW_NUMBER() 
      OVER (Partition BY Section
            ORDER BY RankCriteria DESC ) AS Rank
    FROM table
    ) rs WHERE Rank <= 10 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-02-01T05:10:52.287

如果要生成按部分分组的输出，则仅显示每个部分的前*n*条记录，如下所示：

```
SECTION     SUBSECTION

deer        American Elk/Wapiti
deer        Chinese Water Deer
dog         Cocker Spaniel
dog         German Shephard
horse       Appaloosa
horse       Morgan 
```

...那么以下内容应该适用于所有 SQL 数据库。如果您想要前 10 名，只需在查询末尾将 2 更改为 10 即可。

```
select
    x1.section
    , x1.subsection
from example x1
where
    (
    select count(*)
    from example x2
    where x2.section = x1.section
    and x2.subsection <= x1.subsection
    ) <= 2
order by section, subsection; 
```

建立：

```
create table example ( id int, section varchar(25), subsection varchar(25) );

insert into example select 0, 'dog', 'Labrador Retriever';
insert into example select 1, 'deer', 'Whitetail';
insert into example select 2, 'horse', 'Morgan';
insert into example select 3, 'horse', 'Tarpan';
insert into example select 4, 'deer', 'Row';
insert into example select 5, 'horse', 'Appaloosa';
insert into example select 6, 'dog', 'German Shephard';
insert into example select 7, 'horse', 'Thoroughbred';
insert into example select 8, 'dog', 'Mutt';
insert into example select 9, 'horse', 'Welara Pony';
insert into example select 10, 'dog', 'Cocker Spaniel';
insert into example select 11, 'deer', 'American Elk/Wapiti';
insert into example select 12, 'horse', 'Shetland Pony';
insert into example select 13, 'deer', 'Chinese Water Deer';
insert into example select 14, 'deer', 'Fallow'; 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-02-20T17:36:30.367

Q) Finding TOP X records from each group(Oracle)

```
SQL> select * from emp e 
  2  where e.empno in (select d.empno from emp d 
  3  where d.deptno=e.deptno and rownum<3)
  4  order by deptno
  5  ;

 EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO 
```

* * *

```
 7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10
  7839 KING       PRESIDENT            17-NOV-81       5000                    10
  7369 SMITH      CLERK           7902 17-DEC-80        800                    20
  7566 JONES      MANAGER         7839 02-APR-81       2975                    20
  7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30
  7521 WARD       SALESMAN        7698 22-FEB-81       1250        500         30 
```

6 rows selected.

* * *

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-07T02:05:28.633

UNION[运算](http://www.w3schools.com/sql/sql_union.asp)符可以为您工作吗？每个部分有一个 SELECT，然后将它们联合在一起。猜猜它只适用于固定数量的部分。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-05-14T09:07:40.903

虽然问题是关于 SQL Server 2005，但大多数人已经继续前进，如果他们确实找到了这个问题，那么在其他情况下可能首选的答案是[使用`CROSS APPLY`本博客文章中所示的](https://blog.jooq.org/2017/09/22/how-to-write-efficient-top-n-queries-in-sql/)答案。

```
SELECT *
FROM t
CROSS APPLY (
  SELECT TOP 10 u.*
  FROM u
  WHERE u.t_id = t.t_id
  ORDER BY u.something DESC
) u 
```

此查询涉及 2 个表。OP 的查询仅涉及 1 个表，在这种情况下，基于窗口函数的解决方案可能更有效。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-01-25T22:41:16.930

You can try this approach. This query returns 10 most populated cities for each country.

```
 SELECT city, country, population
   FROM
   (SELECT city, country, population, 
   @country_rank := IF(@current_country = country, @country_rank + 1, 1) AS country_rank,
   @current_country := country 
   FROM cities
   ORDER BY country, population DESC
   ) ranked
   WHERE country_rank <= 10; 
```

# c - 如何 BSWAP 64 位寄存器的低 32 位？

> ID：176966
> 
> 赞同：8
> 
> 时间：2008-10-07T02:02:30.217
> 
> 标签：c, gcc, 64-bit, endianness

我一直在寻找如何将 BSWAP 用于 64 位寄存器的低 32 位子寄存器的答案。例如，`0x0123456789abcdef`在 RAX 寄存器中，我想`0x01234567efcdab89`用一条指令将其更改为（因为性能）。

所以我尝试了以下内联函数：

```
#define BSWAP(T) {  \
    __asm__ __volatile__ (  \
            "bswap %k0" \
            : "=q" (T)  \
            : "q" (T)); \
} 
```

结果是`0x00000000efcdab89`。我不明白为什么编译器会这样。有人知道有效的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T13:40:22.583

啊，是的，我现在明白了这个问题：

x86-64 处理器在执行 32 位操作（在 %eax、%ebx 等上）时，会将 32 位寄存器*[隐式零扩展为 64 位。](http://www.x86-64.org/documentation/assembly.html)*据我了解，这是为了保持与期望这些寄存器具有 32 位语义的遗留代码的兼容性。

所以恐怕**没有办法**只`ror`处理 64 位寄存器的低 32 位。你将不得不使用一系列的几个指令......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-07T02:10:29.200

检查 gcc 生成的汇编输出！使用该`gcc -s`标志编译代码并生成 asm 输出。

IIRC，x86-64 默认情况下使用 32 位整数，而没有明确指示这样做，所以这可能是（部分）问题。

# java - Prefuse：重新加载 XML 文件

> ID：176973
> 
> 赞同：2
> 
> 时间：2008-10-07T02:08:04.277
> 
> 标签：java, xml, visualization, toolkit, prefuse

我是 prefuse 可视化工具包的新手，有几个一般性问题。出于我的目的，我想使用 prefuse (graphview / graphml) 执行初始可视化。渲染后，在用户单击节点时，我想完全重新加载新的 xml 文件以进行新的可视化。我想这样做是为了让我能够“预先打包”图表以供显示。

例如。如果我搜索泰德。我想要一个与 Ted 相关的 xml 文件加载并渲染一个显示。现在在显示中，我看到 Ted 有关联的节点，称为 Bill 和 Joe。当我单击 Joe 时，我想清除显示并加载与 Joe 关联的 xml 文件。等等。

我已经研究过加载一个包含所有节点和节点关系信息的非常大的 xml 文件，并允许 prefuse 使用从一个级别到另一个级别的跃点来处理这个问题。但是，最终我确信由于数据的大小会出现系统性能问题。

提前感谢您的帮助，约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-10T01:46:22.687

当然，正如您所说，一种选择是加载所有节点，然后将不需要的节点设置为不可见。Prefuse 可以很好地扩展，但它当然有其局限性。第二种选择是创建一个全新的面板并替换旧面板。我使用了选项 2，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:00:01.800

我远不是 Prefuse 性能问题的专家，但我认为一次加载一个巨大的 xml 文件肯定比只重新加载必要的节点的处理更耗费资源。

我不知道您使用的是哪种图表，但我会放置一个“刷新图表”，从可视化对象中删除图表，取消活动，取消布局，刷新 ActionList 并重新开始。它可能会变成这样：

```
public void refresh(clickedNode){
    visualization.removeGroup(GRAPH);
    visualization.removeGroup(AGGR);
    activity.cancel();
    actionList.cancel();
    visualization.reset();
    // process the XML and reload your graph here
} 
```

# php - CodeIgniter 初学者学习教程

> ID：176983
> 
> 赞同：-1
> 
> 时间：2008-10-07T02:13:34.467
> 
> 标签：php, codeigniter

我正在尝试学习 CodeIgniter 以用于购物网站，但我对官方文档没有运气。有谁知道有什么帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T02:22:27.897

我们在几个项目中使用了 Code Igniter，发现他们网站上的视频对介绍很有帮助： [http ://codeigniter.com/tutorials/](http://codeigniter.com/tutorials/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T02:44:54.997

专门为您查询 CSS，这是一个新用户编写的很好的入门参考：http: [//codeignitercamp.blogspot.com/2007/08/codeigniter-tutorial-2.html](http://codeignitercamp.blogspot.com/2007/08/codeigniter-tutorial-2.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T03:17:59.267

回复：CSS。

我的 CSS 在根目录下有一个单独的文件夹。（与'index.php'相同的地方）... /content/css/main.css

称为：

```
<link href="<?=base_url();?>content/css/main.css" rel="stylesheet" type="text/css" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T02:52:48.710

刚刚找到了一个关于它的基础的很好的系列：

[http://capsizedesigns.com/blog/2008/05/getting-started-with-codeigniter-part-1/](http://capsizedesigns.com/blog/2008/05/getting-started-with-codeigniter-part-1/) [http://capsizedesigns.com/blog/2008/05/getting-started-with-codeigniter-part- 2/](http://capsizedesigns.com/blog/2008/05/getting-started-with-codeigniter-part-2/) [http://capsizedesigns.com/blog/2008/05/getting-started-with-codeigniter-part-3/](http://capsizedesigns.com/blog/2008/05/getting-started-with-codeigniter-part-3/)

# c++ - 您在 C++ 中使用 NULL 或 0（零）作为指针吗？

> ID：176989
> 
> 赞同：201
> 
> 时间：2008-10-07T02:15:05.073
> 
> 标签：c++, null

在 C++ 的早期，当它被固定在 C 之上时，您不能使用 NULL，因为它被定义为`(void*)0`. 您不能将 NULL 分配给除 之外的任何指针`void*`，这使得它毫无用处。在那些日子里，人们普遍认为您使用`0`（零）作为空指针。

时至今日，我继续使用零作为空指针，但我周围的人坚持使用`NULL`. `NULL`我个人认为将名称 ( ) 赋予现有值没有任何好处- 因为我也喜欢将指针测试为真值：

```
if (p && !q)
  do_something(); 
```

然后使用零更有意义（如果你使用`NULL`，你不能在逻辑上使用`p && !q`- 你需要明确比较`NULL`，除非你假设`NULL`为零，在这种情况下为什么使用`NULL`）。

是否有任何客观理由更喜欢零而不是 NULL（反之亦然），或者只是个人喜好？

编辑：我应该添加（并且最初是说）对于 RAII 和异常，我很少使用零/空指针，但有时你仍然需要它们。

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2008-10-07T02:21:38.820

这是 Stroustrup 对此的看法：[C++ 风格和技术常见问题解答](http://www.stroustrup.com/bs_faq2.html#null)

> 在 C++ 中， 的定义`NULL`是 0，所以只有审美上的区别。我更喜欢避免使用宏，所以我使用 0。另一个问题`NULL`是人们有时会错误地认为它不同于 0 和/或不是整数。在准标准代码中，`NULL`有时被定义为不合适的东西，因此必须/必须避免。这几天不太常见了。
> 
> 如果必须命名空指针，请调用它`nullptr`；这就是它在 C++11 中的名称。然后，`nullptr`将是一个关键字。

也就是说，不要为小事出汗。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2008-10-07T09:12:13.657

我认为有一些论点（其中一个是相对较新的）与 Bjarne 的立场相矛盾。

1.  **意图文件**

    Using`NULL`允许对其使用进行搜索，并且它还强调了开发人员**想要**使用`NULL`指针，而不管编译器是否将其解释为`NULL`。

2.  **指针和'int'的重载比较少见**

    大家引用的例子是：

    ```
     void foo(int*);
     void foo (int);

     void bar() {
       foo (NULL);  // Calls 'foo(int)'
     } 
    ```

    然而，至少在我看来，上述问题不在于我们使用`NULL`空指针常量：而是我们有重载，`foo()`它们采用非常不同类型的参数。该参数必须是一个`int`too，因为任何其他类型都会导致模棱两可的调用，因此会生成有用的编译器警告。

3.  **分析工具今天可以提供帮助！**

    即使在没有 C++0x 的情况下，今天也有可用的工具来验证哪些`NULL`是用于指针，哪些`0`是用于整数类型。

4.  **[C++ 11](http://en.wikipedia.org/wiki/C++11)将有一个新`std::nullptr_t`类型。**

    这是该表的最新论点。C++0x的问题`0`和`NULL`正在积极解决，您可以保证对于每个提供 的实现`NULL`，他们要做的第一件事是：

    ```
     #define NULL  nullptr 
    ```

    对于那些使用`NULL`而不是. 的人来说`0`，更改将是类型安全性的改进，只需很少或不付出任何努力 - 如果有的话，它也可能会在他们使用`NULL`的地方捕获一些错误`0`。对于`0`今天使用的任何人......好吧，希望他们对正则表达式有很好的了解......

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2008-10-07T03:11:13.727

使用 NULL。NULL 表明您的意图。它是 0 是一个无关紧要的实现细节。

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2008-10-07T03:54:24.873

我总是使用：

*   `NULL`用于指针
*   `'\0'`对于字符
*   `0.0`用于花车和双打

其中 0 会很好。这是一个信号意图的问题。也就是说，我对此并不感兴趣。

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2008-10-07T03:04:02.900

我很久以前就停止使用 NULL 来支持 0 （以及大多数其他宏）。我这样做不仅是因为我想尽可能避免使用宏，还因为 NULL 似乎在 C 和 C++ 代码中被过度使用了。它似乎在需要 0 值时使用，而不仅仅是指针。

在新项目中，我将其放在项目标题中：

```
static const int nullptr = 0; 
```

现在，当符合 C++0x 的编译器到来时，我所要做的就是删除该行。这样做的一个好处是 Visual Studio 已经将 nullptr 识别为关键字并适当地突出显示它。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2010-11-19T16:53:03.310

```
 cerr << sizeof(0) << endl;
    cerr << sizeof(NULL) << endl;
    cerr << sizeof(void*) << endl;

    ============
    On a 64-bit gcc RHEL platform you get:
    4
    8
    8
    ================ 
```

这个故事的主旨。处理指针时应该使用 NULL。

1）它声明了你的意图（不要让我搜索你所有的代码，试图找出一个变量是指针还是某种数字类型）。

2) 在某些需要可变参数的 API 调用中，它们将使用 NULL 指针来指示参数列表的结尾。在这种情况下，使用 '0' 而不是 NULL 可能会导致问题。在 64 位平台上， va_arg 调用需要一个 64 位指针，但您将只传递一个 32 位整数。在我看来，您似乎在依赖其他 32 位为您清零？我见过一些不太友好的编译器（例如 Intel 的 icpc）——这导致了运行时错误。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-07T02:23:02.000

如果我没记错的话，NULL 在我使用的标头中的定义不同。对于 C，它被定义为 (void*)0，而对于 C++，它被定义为 0。代码看起来像：

```
#ifndef __cplusplus
#define NULL (void*)0
#else
#define NULL 0
#endif 
```

就我个人而言，我仍然使用 NULL 值来表示空指针，它明确表明您使用的是指针而不是某种整数类型。是的，在内部，NULL 值仍然是 0，但它不是这样表示的。

此外，我不依赖整数到布尔值的自动转换，而是显式地比较它们。

例如更喜欢使用：

```
if (pointer_value != NULL || integer_value == 0) 
```

而不是：

```
if (pointer_value || !integer_value) 
```

* * *

可以说，这一切都在 C++11 中得到了补救，人们可以简单地使用`nullptr`而不是`NULL`，`nullptr_t`这也是 a 的类型`nullptr`。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2014-11-20T14:26:17.163

我想说历史已经说话，那些主张使用 0（零）的人是错误的（包括 Bjarne Stroustrup）。支持 0 的论据主要是美学和“个人偏好”。

在 C++11 创建新的 nullptr 类型之后，一些编译器开始抱怨（使用默认参数）将 0 传递给带有指针参数的函数，因为 0 不是指针。

如果代码是使用 NULL 编写的，则可以通过代码库执行简单的搜索和替换以使其为 nullptr。如果您坚持使用选择 0 作为指针编写的代码，那么更新它会更加乏味。

如果你现在必须按照 C++03 标准编写新代码（并且不能使用 nullptr），你真的应该只使用 NULL。这将使您将来更容易更新。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-10-07T02:22:23.263

我曾经在一台机器上工作，其中 0 是一个有效地址，而 NULL 被定义为一个特殊的八进制值。在那台机器上（0！= NULL），所以代码如

```
char *p;

...

if (p) { ... } 
```

不会像你期望的那样工作。你必须写

```
if (p != NULL) { ... } 
```

虽然我相信现在大多数编译器都将 NULL 定义为 0，但我仍然记得那些年前的教训：NULL 不一定是 0。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-10-07T02:21:38.820

我认为标准保证 NULL == 0，所以你可以做任何一个。我更喜欢 NULL 因为它记录了你的意图。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2009-03-31T07:30:11.910

我通常使用 0。我不喜欢宏，并且无法保证您使用的某些第三方标头不会将 NULL 重新定义为奇怪的东西。

您可以使用 Scott Meyers 和其他人提出的 nullptr 对象，直到 C++ 获得 nullptr 关键字：

```
const // It is a const object...
class nullptr_t 
{
public:
    template<class T>
    operator T*() const // convertible to any type of null non-member pointer...
    { return 0; }

    template<class C, class T>
    operator T C::*() const   // or any type of null member pointer...
    { return 0; }

private:
    void operator&() const;  // Can't take address of nullptr

} nullptr = {}; 
```

谷歌“nullptr”了解更多信息。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2011-03-27T15:44:58.610

使用 0 或 NULL 将具有相同的效果。

但是，这并不意味着它们都是良好的编程实践。鉴于性能没有差异，选择低级感知选项而不是不可知/抽象替代方案是一种糟糕的编程实践。**帮助您的代码读者了解您的思维过程**。

NULL, 0, 0.0, '\0', 0x00 和其他东西都翻译成同一个东西，但在你的程序中是不同的逻辑实体。它们应该这样使用。NULL 是一个指针，0 是数量，0x0 是一个值，其位是有趣的等等。无论它是否编译，您都不会将 '\0' 分配给指针。

我知道一些社区鼓励通过打破环境契约来展示对环境的深入了解。然而，负责任的程序员会编写可维护的代码，并将这种做法排除在他们的代码之外。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-09-17T07:24:37.117

奇怪的是，没有人，包括 Stroustroup 都提到过。虽然谈论了很多标准和美学，但没有人注意到代替 's 是危险*的*，例如，在架构上的可变参数列表中。像 Stroustroup 一样，出于美学原因，我更喜欢它，但必须小心不要在其类型可能模棱两可的地方使用它。`0``NULL``sizeof(int) != sizeof(void*)``0`

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-03-31T13:17:51.263

我尽量通过使用 C++ 引用来避免整个问题。而不是

```
void foo(const Bar* pBar) { ... } 
```

你可能经常能写

```
void foo(const Bar& bar) { ... } 
```

当然，这并不总是有效。但是空指针可能会被过度使用。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-07T02:23:06.820

我和 Stroustrup 一起讨论这个 :-) 因为 NULL 不是语言的一部分，所以我更喜欢使用 0。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-07T02:24:17.457

主要是个人偏好，尽管可以提出 NULL 的论点很明显，该对象是一个当前不指向任何东西的指针，例如

```
void *ptr = &something;
/* lots o' code */
ptr = NULL; // more obvious that it's a pointer and not being used 
```

IIRC，标准不要求 NULL 为 0，因此使用 <stddef.h> 中定义的任何内容可能最适合您的编译器。

该论点的另一个方面是您是否应该使用逻辑比较（隐式转换为 bool）或显式检查 NULL，但这也归结为可读性。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-10-07T02:52:00.287

我更喜欢使用 NULL，因为它清楚地表明您的意图是值表示指针而不是算术值。它是一个宏的事实是不幸的，但由于它是如此根深蒂固，所以几乎没有危险（除非有人做了一些非常愚蠢的事情）。我希望它从一开始就是一个关键字，但你能做什么？

也就是说，我对使用指针本身作为真值没有任何问题。就像 NULL 一样，它是一个根深蒂固的习惯用法。

C++09 将添加我认为早就应该的 nullptr 构造。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-07T02:51:28.683

我总是使用 0。不是出于任何真正深思熟虑的原因，只是因为当我第一次学习 C++ 时，我读过一些推荐使用 0 的东西，而我一直都是这样做的。理论上，可读性可能存在混淆问题，但在实践中，我从未在数千工时和数百万行代码中遇到过这样的问题。正如 Stroustrup 所说，在标准变为 nullptr 之前，这实际上只是个人审美问题。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-08-05T16:36:53.077

曾经有人告诉我...我将把 NULL 重新定义为 69。从那以后我不再使用它：P

它使您的代码非常容易受到攻击。

**编辑：**

并非标准中的所有内容都是完美的。宏 NULL 是一个实现定义的 C++ 空指针常量，与 C NULL 宏不完全兼容，除了类型隐藏隐式将其转换为无用且容易出错的工具外。

NULL 不表现为空指针，而是表现为 O/OL 文字。

告诉我下一个例子并不令人困惑：

```
void foo(char *); 
void foo(int); 
foo(NULL); // calls int version instead of pointer version! 
```

正因为如此，在新标准中出现了 std::nullptr_t

如果您不想等待新标准并想使用 nullptr，请至少使用一个像 Meyers 提出的像样的标准（参见 jon.h 评论）。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-07-10T08:34:08.187

好吧，我主张尽可能不使用 0 或 NULL 指针。

使用它们迟早会导致代码中出现分段错误。根据我的经验，gereral 中的指针是 C++ 中最大的错误来源之一

此外，它还会导致整个代码中出现“if-not-null”语句。如果您可以始终依赖有效状态，那就更好了。

几乎总是有更好的选择。

* * *

## 回答 #21

> 赞同：-4
> 
> 时间：2010-12-02T03:50:50.263

将指针设置为 0 并不是那么清楚。特别是如果您使用 C++ 以外的语言。这包括 C 和 Javascript。

我最近使用了一些类似这样的代码：

`virtual void DrawTo(BITMAP *buffer) =0;`

首次用于纯虚函数。我认为这是一个星期的魔法jiberjash。当我意识到它基本上只是将函数指针设置为 a `null`（因为虚拟函数在大多数情况下对于 C++ 来说只是函数指针）我踢了自己。

`virtual void DrawTo(BITMAP *buffer) =null;`

如果我的新眼睛没有适当的间距，那会比那个混蛋更容易混淆。实际上，我想知道为什么 C++ 不像`null`现在使用小写 false 和 true 那样使用小写。

# visual-c++ - 不使用 VCRedist_x86.exe 的 Visual C++ Redistributables

> ID：176992
> 
> 赞同：15
> 
> 时间：2008-10-07T02:17:37.673
> 
> 标签：visual-c++, dll, winsxs

我在一个受到严格限制的环境中开发，但开发人员也有严格的控制。

VCRedist_x86.exe - 一个 4Mb 的可再发行文件 - 不好玩（传输四个小时）。我真的更喜欢只重新分发 MFC90.dll、msvcm90.dll、msvcp90.dll 和 msvcr90.dll - 这更像是 2Mb。但是，[重新分发 Visual C++ 文件](http://msdn.microsoft.com/en-us/library/ms235299.aspx)说：

> 不支持重新分发在没有清单的情况下构建的 C/C++ 应用程序。如果没有将应用程序绑定到这些库的清单，C/C++ 应用程序就不能使用 Visual C++ 库。有关详细信息，请参阅[选择部署方法](http://msdn.microsoft.com/en-us/library/ms235316.aspx)。

我最初将 DLL 复制到程序工作目录的计划似乎在这个勇敢的清单新世界中行不通。

我的下一个猜测是将文件填充到 WinSxS 目录所需的注册表项并自己填充（而不是使用 4 meg 程序）。

[编辑] 该软件经常更新，因此 DLL 比静态链接更受欢迎。[/编辑]

**我怎样才能成功地分发必要的文件，同时降低开销？**

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-06T07:24:47.033

[我是微软目前的 SxS 维护者]

我强烈建议*不要*从清单中删除 publicKeyToken 属性。dll 的私有部署将在此属性保持不变的情况下正常工作。但是，如果目标计算机上集中安装了较新版本的 CRT，删除它会阻止您的应用程序从安全更新中受益，因为依赖项将不再匹配。

因此，总结一下：使用默认值嵌入清单是安全的。将 CRT 清单 + DLL 文件直接复制到可执行文件的目录中，无需进行任何编辑。就是这样。兼容Win2k+。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-07T03:05:39.293

我们使用这个：[Howto：在不安装 vcredist_x86.exe 的情况下部署 VC2008 应用程序](http://blog.kalmbach-software.de/2008/05/03/howto-deploy-vc2008-apps-without-installing-vcredist_x86exe/)

本质上

*   不要在您的 exe 文件中嵌入清单。
*   将 C++ DLL 及其清单复制到您的应用目录。
*   从所有清单（您的和 Microsoft 的）中删除“publicKeyToken”。
*   如有必要，更改应用清单文件中的版本信息以匹配 Microsoft 清单文件（反之亦然）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T02:21:38.197

在编译器属性页中为“运行时库”设置指定 /MT（多线程）。这静态链接到运行时库，因此您不必安装可再发行组件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T02:37:27.837

将它们安装为私有程序集。看这里：

[http://msdn.microsoft.com/en-us/library/ms235291.aspx](http://msdn.microsoft.com/en-us/library/ms235291.aspx)

请注意，如果您不需要提供的所有 DLL，您可以修改清单文件以仅引用您需要的那些。

# mono - Mono 2.0 中最重要的特性是什么？

> ID：176998
> 
> 赞同：3
> 
> 时间：2008-10-07T02:19:45.593
> 
> 标签：mono

[Mono 2.0 刚刚正式发布](http://www.mono-project.com/Main_Page)。您认为最重要的单一功能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T02:26:05.503

C# 3.0/LINQ

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T02:36:22.333

System.Windows.Forms 的完整实现

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T02:46:43.170

Windows.Forms 绝对是一流的……这可能是我最兴奋的功能。LINQ-to-XML 应该不错。既然 LINQ 核心可用，我期待更多的 LINQ 提供程序！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T17:30:43.130

完整的 .NET 2.0 配置文件是一项了不起的成就！********************