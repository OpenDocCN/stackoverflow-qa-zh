# StackOverflow 问答 000391000-000391999

# sql - How do I trim date in PLSQL?

> ID：391000
> 
> 赞同：3
> 
> 时间：2008-12-24T08:08:49.817
> 
> 标签：sql, oracle, plsql, date-format

I have a date variable as `24-dec-08`. I want only the `08` component from it.

How do I do it in a select statement?

e.g.:

```
select db||sysdate 
--(this is the component where I want only 08 from the date) 
from gct; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-24T08:18:26.193

The easiest way is to use the `to_char` function this way:

```
to_char(sysdate, 'YY') 
```

as [documented here](http://www.techonthenet.com/oracle/functions/to_char.php).

If you need the integer value, you could use the `extract` function for dates too. Take a look [here](http://www.techonthenet.com/oracle/functions/extract.php) for a detailed description of the `extract` syntax.

For example:

```
extract(YEAR FROM DATE '2008-12-24') 
```

would return *2008*.

If you just need the value of the last two digits, you could apply the [modulo function](http://www.techonthenet.com/oracle/functions/mod.php) `MOD`:

```
mod(extract(YEAR FROM DATE '2008-12-24'), 100) 
```

would return *8*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T09:56:31.363

The normal way to do this in Oracle is:

```
select db||to_char(sysdate,'YY')
from gct; 
```

# c# - 使用 C# 在托管 DirectX 中在视频上绘制文本

> ID：391002
> 
> 赞同：2
> 
> 时间：2008-12-24T08:10:41.560
> 
> 标签：c#, directx, directshow, mdx

如何使用 C# 在托管 DirectX 中通过视频绘制文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T10:10:23.877

您还需要一个组件[DirectShow.Net](http://directshownet.sourceforge.net/)。由于您指的是 MDX，我假设您仍在使用 MDX v1.1，因为 2.0 Beta 已停产并已于 2008 年 8 月到期。此外，我假设您知道如何使用 MDX 和 DirectShow 播放基本视频。

我不会在这里发布任何代码，因为 DirectShow.Net 库中有 2 个示例向您展示如何执行此操作，即 DxText (Samples\Players\DxText) 和 BitmapMixer (Samples\vmr9\BitmapMixer)。BitmapMixer 使用 VMR9 作为渲染器并在其上叠加位图。您可以使用自己的文本生成位图，`System.Drawing.Graphic`并将其叠加在视频上。大多数带字幕的视频播放器都使用这些方法中的任何一种。VMR9 更受欢迎，因为它是硬件加速的。

# php - 如何将 HTML 和 CSS 添加到 PDF 中

> ID：391005
> 
> 赞同：1701
> 
> 时间：2008-12-24T08:14:20.757
> 
> 标签：php, html, css, pdf, pdf-generation

我有一个在 Firefox 3 和 IE 7 中呈现良好的 HTML（不是 XHTML）文档。它使用相当基本的 CSS 来设置它的样式并在 HTML 中呈现良好。

我现在正在寻找一种将其转换为 PDF 的方法。我试过了：

*   [DOMPDF](https://github.com/dompdf/dompdf)：表格存在巨大问题。我分解出我的大型嵌套表并且它有所帮助（在它只消耗高达 128M 的内存然后死亡之前——这是我在 php.ini 中的内存限制）但它使表完全混乱并且似乎没有得到图片。表格只是一些基本的东西，带有一些边框样式，可以在各个点添加一些线条；
*   [HTML2PDF 和 HTML2PS](https://github.com/spipu/html2pdf)：实际上我的运气更好。它渲染了一些图像（所有图像都是谷歌图表 URL），表格格式要好得多，但它似乎有一些我还没有弄清楚的复杂性问题，并且一直死于未知的 node_type() 错误。不知道从这里去哪里；和
*   [Htmldoc](http://www.msweet.org/projects.php?Z1)：这似乎在基本的 HTML 上工作得很好，但几乎不支持 CSS，所以你必须在 HTML 中做所有事情（我没有意识到在 Htmldoc-land 中它仍然是 2001 年......）所以它对我没用。

我尝试了一个名为 Html2Pdf Pilot 的 Windows 应用程序，它实际上做得相当不错，但我需要至少在 Linux 上运行并且理想情况下通过 Web 服务器上的 PHP 按需运行的东西。

我错过了什么，或者我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：671
> 
> 时间：2009-08-31T13:36:14.910

看看[`wkhtmltopdf`](http://wkhtmltopdf.org/)。它是开源的，基于 webkit 并且是免费的。

[我们在这里](http://beebole.com/blog/general/convert-html-to-pdf-with-full-css-support-an-opensource-alternative-based-on-webkit/)写了一个小教程。

**编辑（2017）：**

如果要在今天建造一些东西，我就不会再走那条路了。
但会改用[http://pdfkit.org/](http://pdfkit.org/)。
可能会剥离它所有的 nodejs 依赖项，以便在浏览器中运行。

* * *

## 回答 #2

> 赞同：562
> 
> 时间：2009-01-12T08:47:28.523

**重要提示：** 请注意，此答案是在 2009 年编写的，它可能不是 2019 年当今最具成本效益的解决方案。今天的在线替代品比当时更好。

以下是您可以使用的一些在线服务：

*   [PDFShift](https://pdfshift.io)
*   [休息包](https://restpack.io/html2pdf)
*   [PDF 图层](https://pdflayer.com)
*   [猛禽博士](https://docraptor.com)
*   [HTMLPDFA​​PI](https://htmlpdfapi.com)
*   [HTML 转 PDF 火箭](https://www.html2pdfrocket.com)

* * *

看看[PrinceXML](http://princexml.com)。

它绝对是最好的 HTML/CSS 到 PDF 转换器，虽然它不是免费的（但是，你的编程可能也不是免费的，所以如果它可以为你节省 10 个小时的工作时间，你就可以免费回家了（因为你还需要考虑到替代解决方案将要求您使用正确的软件设置专用服务器）

哦，是的，我有没有提到这是第一个（也可能是唯一一个）执行完整[ACID2](http://princexml.com/samples/acid2/acid2.pdf)的 HTML2PDF 解决方案？

[PrinceXML 示例](http://princexml.com/samples/)

* * *

## 回答 #3

> 赞同：153
> 
> 时间：2009-01-12T03:51:12.257

经过一些调查和一般的拉扯，解决方案似乎是[HTML2PDF](http://html2pdf.fr/)。 [DOMPDF](https://github.com/dompdf/dompdf)在表格、边框甚至中等复杂的布局方面做得很糟糕，而[htmldoc](http://www.easysw.com/htmldoc/)看起来相当健壮，但几乎完全不了解 CSS，我不想只为那个程序重新做没有 CSS 的 HTML 布局。

HTML2PDF 看起来最有希望，但我一直有这个关于 node_type 的空引用参数的奇怪错误。我终于找到了解决方案。基本上，PHP 5.1.x 在任何大小的字符串上都可以正常使用正则表达式替换 (preg_replace_*)。PHP 5.2.1 引入了一个名为**pcre.backtrack_limit**的 php.ini 配置指令。这个配置参数的作用是限制匹配完成的字符串长度。为什么要介绍这个我不知道。默认值被选为 100,000。为什么价值这么低？再次，不知道。

[为此，针对 PHP 5.2.1 提出了](http://bugs.php.net/bug.php?id=40846)一个错误，该错误在*将近两年后*仍然开放。

可怕的是，当超过限制时，替换只是**默默地失败**。至少，如果一个错误被提出并记录下来，你就会知道发生了什么，为什么以及改变什么来修复它。但不是。

所以我有一个 70k 的 HTML 文件可以转换成 PDF。它需要以下 php.ini 设置：

*   pcre.backtrack_limit = 2000000; # 可能比我需要的多，但没关系
*   memory_limit = 1024M; # 是的，**1 GB** ; 和
*   max_execution_time = 600；# 是的，**10 分钟**。

现在精明的读者可能已经注意到我的 HTML 文件小于 100k。我能猜到我遇到这个问题的唯一原因是 html2pdf 将转换为 xhtml 作为该过程的一部分。也许这接管了我（尽管近 50% 的膨胀似乎很奇怪）。无论如何，上述工作。

现在，html2pdf 是一个资源猪。我的 70k 文件大约需要 5 分钟和至少 500-600M 的 RAM 来创建一个 35 页的 PDF 文件。不幸的是，实时下载速度不够快（到目前为止），而且内存使用率使内存使用率大约为 1000 比 1（70k 文件的 RAM 为 600M），这完全是荒谬的。

不幸的是，这是我想出的最好的。

* * *

## 回答 #4

> 赞同：128
> 
> 时间：2010-03-26T11:11:18.030

你为什么不试试[mPDF 2.0 版](http://www.mpdf1.com/)？我用它来创建 PDF 文档。它工作正常。

同时，mPDF 版本为 5.7，并且与 HTML2PS/HTML2PDF 相比，它得到了积极维护

但请记住，文档确实很难处理。例如，看看这个页面：[https](https://mpdf.github.io/) ://mpdf.github.io/ 。

关于 html 到 pdf 的非常基本的任务，可以使用这个库来完成，但更复杂的任务需要一些时间阅读和“理解”文档。

* * *

## 回答 #5

> 赞同：73
> 
> 时间：2013-11-28T14:52:06.673

1.  使用[MPDF](https://mpdf.github.io/)！==

a) 提取`yourfolder`

b)在其中创建**file.php**`yourfolder`并插入这样的代码：

```
<?php
include('../mpdf.php');
$mpdf=new mPDF();
$mpdf->WriteHTML('<p style="color:red;">Hallo World<br/>Fisrt sentencee</p>');
$mpdf->Output();   exit;
 ?> 
```

c)从浏览器打开**file.php**

# 

2）使用[pdfToHtml](http://sourceforge.net/projects/pdftohtml/)！

1.  **将 pdftohtml.exe**提取到您的根文件夹：

2.  在该文件夹中，在**anyfile.php**文件中，放置以下代码（假设也有源 example.pdf）：

3.  输入**FinalFolder**，就会有转换后的文件（与源 PDF 一样多的页面......）

* * *

## 回答 #6

> 赞同：58
> 
> 时间：2009-02-21T20:50:48.933

结帐[TCPDF](https://tcpdf.org/)。它具有一些 HTML 到 PDF 的功能，可能足以满足您的需要。它也是免费的！

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2009-01-21T23:32:29.830

只是为了解决问题，我尝试了 DOMPDF 并且效果很好。我已经使用`DIV`和其他块级元素来定位所有内容，我严格遵守 CSS 2.1 并且它播放得非常好。

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2010-11-13T00:48:16.677

我建议使用**[DocRaptor](http://docraptor.com)**（`PrinceXML`用作“引擎”）

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2011-11-21T20:23:29.790

**好消息！[活泼](https://github.com/knplabs/snappy)！！**

Snappy 是一个**非常简单**的开源 PHP5 库，允许从 url 或 html 页面生成缩略图、快照或 PDF。并且...它使用了**优秀**的基于 webkit 的**[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)**

享受！^_^

* * *

## 回答 #10

> 赞同：30
> 
> 时间：2013-02-18T20:50:34.343

已经提到过，但我想确认 mpdf 是最简单、最强大和最免费的 HTML 到 pdf 转换器。天空真的是极限。您甚至可以生成用户生成的动态数据的 pdf。

例如，一个客户想要一个 CMS 系统，这样他就可以更新他在俱乐部演奏的音乐的曲目列表。没问题，但他也希望用户能够下载播放列表的 .pdf，因此 cms 也必须更新这个可下载的 pdf。感谢 mpdf，通过一些简单的循环和散布的变量，我可以做到这一点。我认为会花费我数周时间的事情实际上花了我几分钟。

帮助我入门的好[文章。](http://www.smaizys.com/php/mpdf-html-to-pdf-introduction/)

* * *

## 回答 #11

> 赞同：27
> 
> 时间：2008-12-27T06:17:59.147

好吧，如果您想找到一个完美的 XHTML+CSS 到 PDF 转换器库，那就算了。这是不可能的。因为这就像寻找一个完美的浏览器（XHTML+CSS 渲染引擎）。我们有吗？IE还是FF？

我在 DOMPDF 方面取得了一些成功。问题是你必须修改你的 HTML+CSS 代码以适应库的工作方式。除此之外，我取得了不错的成绩。

见下文：

[原始 HTML](http://www.nutquote.com/quote/William_Shakespeare/1/simple)

[将 HTML 转换为 PDF](http://www.converthub.com/htmltopdf.php?html=http://www.nutquote.com/quote/William_Shakespeare/1/simple)

* * *

## 回答 #12

> 赞同：26
> 
> 时间：2015-05-07T10:43:28.097

最初在开篇文章中提到的**HTML2PDF 和 HTML2PS**正在谈论带有此[链接的 2009 软件包](http://tufat.com/html2ps-and-html2pdf/)

但是有更好的[HTML2PDF](http://html2pdf.fr/en/default)

它基于 TCPDF，尽管它部分是法语的。

您可以有在页面上重复的表格页眉或页脚，并有页码和总页数。请参阅[其示例](http://html2pdf.fr/en/example)。我已经使用它三年多了，并推荐它。

* * *

## 回答 #13

> 赞同：23
> 
> 时间：2009-02-21T20:21:17.053

我正在使用[fpdf](http://www.fpdf.org/)使用 PHP 生成 PDF 文件。到目前为止，产生简单的输出对我来说效果很好。

* * *

## 回答 #14

> 赞同：22
> 
> 时间：2008-12-24T09:46:11.727

Zend 的 devzone 上有一个关于从 php 生成 pdf 的教程（[第 1](http://devzone.zend.com/article/1254-PDF-Generation-Using-Only-PHP---Part-1)部分，[第 2 部分](http://devzone.zend.com/article/1255-PDF-Generation-Using-Only-PHP---Part-2)），没有任何外部库。我从未实现过这种解决方案，但由于它都是 php，您可能会发现它的实现和调试更加灵活。

* * *

## 回答 #15

> 赞同：17
> 
> 时间：2010-08-24T19:01:54.013

Darryl Hein 上面提到的[TCPDF](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf)可能是一个好主意。Nicola Asuni 的代码非常方便和强大。唯一的杀手是，如果您计划将 PDF 文件与生成的 PDF 合并，它没有这些功能。您必须创建 PDF，然后使用 Sid Steward (www.pdflabs.com/tools/pdftk-the-pdf-toolkit/) 的 PDFTK 之类的东西合并它。

* * *

## 回答 #16

> 赞同：16
> 
> 时间：2011-08-10T13:16:42.940

尝试获取最新的夜间**dompdf**版本 - 我使用的是旧版本，这是一个可怕的资源消耗，并且需要很长时间才能渲染我的 pdf。从[这里](http://eclecticgeek.com/dompdf/)抓了一个晚上之后。

生成 PDF 只需要几秒钟 - 而且它的渲染效果与使用**PrinceXML** / **Docraptor**一样好。自从我上次使用**dompdf**代码以来，似乎他们已经认真优化了它！

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2016-02-11T17:51:41.927

在成本方面，在许多情况下使用 Web 服务 (API) 可能是更明智的方法。另外，通过外包这个过程，您可以减轻自己的基础设施/后端的负担，并且 - 如果您使用的是信誉良好的服务 - 确保与调整 Web 标准、正常运行时间、较短的处理时间和快速的内容交付的兼容性。

我已经对目前市场上的大多数 Web 服务进行了一些研究，请在下面找到我认为在这个线程中值得一提的 API，按照价格/价值比排序。它们都提供预先组合的 PHP 类和包。

1.  [pdflayer.com](https://pdflayer.com) - 成本：$ - 质量：☆☆☆☆
2.  [doraptor.com](http://docraptor.com) - 成本：$$ - 质量：☆☆☆☆☆</li>
3.  [pdfcrowd.com](http://pdfcrowd.com) - 成本：$$ - 质量：☆☆☆</li>

**质量：**

以高质量引擎`PrinceXML`为骨干，[DocRaptor](http://docraptor.com)显然提供了最好的 PDF 质量，返回高度精美且转换良好的 PDF 文档。但是，[pdflayer API](https://pdflayer.com)服务在这里非常接近。[Pdfcrowd](http://pdfcrowd.com)不一定以质量得分，但以处理速度得分。

**成本：**

**pdflayer.com** - 如上所述，这里最具成本效益的选择是 pdflayer.com，提供完全免费的订阅计划，每月 100 个 PDF 和高级订阅，价格在 9.99 美元到 119.99 美元之间。*每月 10,000 个 PDF 文档的价格为 39.99 美元。*

**docraptor.com** - 提供 7 天免费试用期。高级订阅计划从 15 美元到 2250 美元不等。*每月 10,000 个 PDF 文档的价格约为 300.00 美元。*

**pdfcrowd.com** -免费提供 100 个 PDF *。*高级订阅计划从 9 美元到 89 美元不等。*每月 10,000 个 PDF 文档的价格约为 49.00 美元。*

我已经使用了所有这三个，并且这篇文章应该可以帮助任何人做出决定，而不必为所有这些付费。本文并非为支持任何一种产品而编写，我与任何产品均无从属关系。

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2014-10-08T14:14:59.863

如果您可以访问命令行，则可以使用**PhantomJS**`PDF`从`URL`（远程或本地）创建。

它工作得非常好，并且是一个免费的解决方案。

看看这个针对这个确切问题的[示例脚本。](https://github.com/ariya/phantomjs/blob/master/examples/rasterize.js)

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2012-02-20T15:19:17.723

这个问题已经很老了，但还没有看到有人提到[CutyCapt](http://cutycapt.sourceforge.net/)，所以我会:)

**CutyCapt**

> [CutyCapt](http://cutycapt.sourceforge.net/)是一个小型跨平台命令行实用程序，用于将 WebKit 的网页渲染捕获为各种矢量和位图格式，包括 SVG、PDF、PS、PNG、JPEG、TIFF、GIF 和 BMP

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2013-05-17T12:38:12.163

我推荐 TCPPDF 或 DOMPDF，按这个顺序。

* * *

## 回答 #21

> 赞同：9
> 
> 时间：2009-05-12T21:02:00.500

我不认为 php 类最适合用 css 呈现 xHtml 页面。

当新的 CSS 规则出现时会发生什么？（很快 CSS 3.0...）

呈现 html 页面的最佳方式显然是浏览器。Firefox 3.0 可以原生地以 pdf 格式“打印”，torisugary 开发了一个扩展（命令行打印）来使用它。[在这里你会找到它。](http://torisugari.googlepages.com/commandlineprint2)

无论如何，仍然有很多问题运行 firefox*只是*作为一个 pdf 转换器......

目前，我认为 wkhtmltopdf 是最好的（即 safari 浏览器使用的那个），速度快，速度快，很棒。是的，也是开源的…… [看看](http://code.google.com/p/wkhtmltopdf/)

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2016-06-22T14:22:52.100

我开发了一个公共 API 来从网页构建 PDF 文件。它有一个很好的 PHP 客户端类，使它超级容易使用。它使用 wkhtmltopdf 在云中呈现 PDF。

HTML 中不需要任何特殊的东西。在 images/css/js 链接中不需要绝对 URL。也适用于本地主机（开发机器）。

目前，该服务在 4 个 Azure 区域拥有端点：美国东部、美国西部、欧盟北部、东南亚。

它速度很快，因为它使用专有协议将网页内容发送到 API 以转换为 PDF。

它是可靠的，因为所有端点都是负载平衡的。

免费帐户可用于测试或低使用率。网站上的详细信息：

[https://rotativahq.com](https://rotativahq.com)

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2008-12-24T09:16:29.960

也许您可以在将文件交给转换器之前尝试使用 Tidy。如果其中一个渲染器因某些 HTML 问题（如未关闭的标签）而窒息，它可能会有所帮助。

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2008-12-24T09:09:27.183

精细的渲染并不意味着什么。它验证吗？

所有浏览器都尽其所能在屏幕上显示某些内容，无论输入多么糟糕。当然，他们不会做同样的事情。如果你想要和 FireFox 一样的渲染，你可以使用它的渲染引擎。有它的pdf生成器。不过，这是一项非常艰巨的工作。

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2014-06-02T17:59:32.290

尽管已经提供了许多解决方案，但我推荐以下两个：

1.  [HTM2PDF](http://www.htm2pdf.co.uk) - 提供一个将 HTML 转换为 PDF 的 API，还有一个 PHP SDK，这使得在 PHP 中实现非常容易；它提供欧洲、亚洲和美国的服务器位置选择
2.  [PDFmyURL](http://pdfmyurl.com) - 提供了一个 API，它也将 URL 和 HTML 转换为 PDF，具有与 HTM2PDF 大致相同的功能，但适用于负载平衡的环境，并且已经存在了一段时间

这两个 API 与前面提到的所有解决方案的不同之处在于 - 除了使用 CSS 和 JavaScript 将 HTML 转换为 PDF - 它还提供 PDF 权限管理、水印和加密。因此，对于那些想要开始行动的人来说，这是一个多合一的解决方案。

免责声明：我在经营这两个网站的公司 Kaiomi 工作。

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2013-08-29T15:06:44.533

HTML 到 PDF 的转换真的*需要*在服务器端使用 PHP 进行吗？

我刚刚遇到[jsPDF](http://parall.ax/products/jspdf)，一个使用 HTML5/JavaScript 的客户端解决方案。MIT 许可的[代码也在 GitHub 上](https://github.com/MrRio/jsPDF)。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2013-12-08T11:09:22.980

TCPDF 工作正常，没有依赖关系，是免费的，并且不断修正错误。如果提供的 HTML/CSS 内容格式正确，它具有合理的速度。我通常生成 50 - 300 kB 的 HTML 输入（包括 CSS），并在 1-3 秒内获得 10 - 15 个 PDF 页面的 PDF 输出。

我强烈建议在向 TCPDF 发送任何内容之前使用**tidy库作为 HTML 漂亮的格式化程序。**

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2013-05-22T06:47:40.477

我已经为 PHP 尝试了很多不同的库。所有列出的我都试过了。在我看来， [TCPDF](http://www.tcpdf.org/)库是最好的折衷性能/可用性。安装使用非常简单，在中小型应用中也有很好的表现。如果您需要高性能和非常大的 PDF 文档，请使用[Zend_PDF](http://framework.zend.com/manual/1.12/en/zend.pdf.html)模块，但要准备好编码！

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2014-04-23T14:40:16.993

# 网络 API

如果有人总是搜索这类东西，有一个**免费**网站可以让您将 html 代码和页面转换为 pdf。还有一个（非常小的）api，允许您从 url 获取 pdf 文件。

[**在这里检查**](http://simplehtmltopdf.com)

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2012-10-03T17:33:49.420

不是**PHP**，而是一个[**Java** library](http://code.google.com/p/flying-saucer/)，它做的事情：

> Flying Saucer 采用 XML 或 XHTML 并对其应用符合 CSS 2.1 的样式表，以便呈现为 PDF

它可以从**PHP** via`system()`或类似的调用中使用。尽管它需要**XML**格式良好的`input`.

# c++ - 具有静态函数的类在 C++ 中成为抽象基类

> ID：391006
> 
> 赞同：0
> 
> 时间：2008-12-24T08:15:38.743
> 
> 标签：c++, static, virtual, abstract-class

有一个用例

```
Class foo {

public:

  static std::string make(std::string a) { .. }

} 
```

我想让 foo 成为一个抽象基类，但显然 make 不能在这个抽象基类中，因为虚函数不能是静态的。

像这样

```
Class foo {

public:
   static virtual std::string make (std::string) = 0; //error this cannot be done 

}

Class fooImpl: foo{

public:
   std::string make(std::string a) { ..}
} 
```

从设计的角度来看，在抽象类中使方法非静态或使派生类具有静态方法是一种好方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T08:19:17.800

您可以使析构函数成为纯虚函数：

```
类富 {
  上市：
    虚拟〜foo（）= 0；
}

```

无论如何，您只需要确保为析构函数提供实现：

```
foo::~foo() {}

```

编辑：
因此你有一个可以派生的类，但它本身不能被实例化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T09:57:06.680

其他人发布的问题是该方法应该是虚拟的还是静态的。

多态性是基于这样的想法，即您调用特定对象实例的行为，而不管您对它有什么类型的引用。

```
base& somefunction(); // may return base or derived objects
base &b = somefunction();
b.method(); 
```

现在，如果*方法*行为从*基础*变为*派生*，并且您想要您所指的*真实实例的行为，那么您需要多态性，因此需要一个虚拟方法。*该方法可能使用或不使用成员数据这一事实无关紧要，重要的是它是绑定到特定实例的行为。

另一方面，静态方法绑定到类。也就是说，它是您正在处理的类的行为，而不是被引用的实例的行为。因此，即使可以使用上面的语法，它也会调用类*基中的静态**方法*，因为这是您正在处理的类。

 *如果没有更深入的领域知识，没有理由确定您正在处理的任何设计选项比另一个更好。我希望上面的推理能帮助你做出决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T12:47:18.960

将静态函数包装在非静态虚函数中允许多态性，当你有实例时允许静态调用（我想不出任何用例，当你还没有实例时你只需要多态性）实例）。如果您忘记将静态虚拟的实现放在派生类中，您会丢失编译时错误，它不是很漂亮，但您无能为力。遗憾的是，这种疏忽没有在 C0x 标准中得到修复，但它是相对狭窄的要求，所以我想没有需求

# packagemaker - 使用包中的 AppleScript 安装 3rd 方框架

> ID：391011
> 
> 赞同：-1
> 
> 时间：2008-12-24T08:20:15.597
> 
> 标签：packagemaker, mpkg

我的应用程序依赖于另一个第三方框架，我需要确保在我的应用程序运行之前安装了该框架。我正在使用 AppleScript 来检查框架是否已安装。我正在使用 PackageMaker 打包我的应用程序。

如果尚未安装该软件包，如何将其他框架的 pkg 文件打包到我的 PackageMaker 项目中并运行我的 AppleScript？

谢谢

注意：pkg 文件以及添加框架也将一些其他内容添加到 Applications 文件夹中。所以我需要运行 pkg 文件，而不仅仅是在我的应用程序资源中获取框架

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-24T13:42:29.283

不要尝试在系统中安装框架 - 最好在应用程序包中保留一份副本。

要使用 3rd 方框架，请拖入*Xcode -> Frameworks -> Linked Frameworks*。

然后在目标下创建一个“复制文件”阶段，将您的第 3 方框架复制到应用程序包中的内容/框架中。

有关更多详细信息和分步示例，请查看[Sparkle 框架的文档](http://sparkle.andymatuschak.org/documentation/pmwiki.php/Documentation/BasicSetup?from=Main.HomePage)

# c++ - 本地 WideString 变量调试错误“Int3 DbgBreakPoint”

> ID：391022
> 
> 赞同：0
> 
> 时间：2008-12-24T08:28:39.667
> 
> 标签：c++, delphi, c++builder, widestring

在 C++Builder 中，我编写了以下代码（在 Button1Click 处理程序中），当我在调试模式下运行时，我得到“Int3 DbgBreakPoint”（堆栈损坏？）。AnsiSting（可能是引用计数）不会发生这种情况。

```
WideString boshluq;
boshluq=L" "; 
```

这是正常的吗？您建议我如何修复此代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T13:11:34.433

还是使用 WideStrings 调用库的调试版本？具有显式 int 3; 调用内置？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T15:33:01.167

WideStrings 是 Windows WideStrings 的指针引用变量，可能问题出在您的 Windows 系统库中。

我在ntdll.dll中的断点也有同样的问题，我不知道你是否也一样。

我用这个单元解决了[http://www.tbosystems.bluehosting.com.br/dbx4/int3.pas](http://www.tbosystems.bluehosting.com.br/dbx4/int3.pas)（感谢 Leonel Togniolli），也许你可以检查一下，看看是否可以帮助你，或者尝试相同的代码在其他windows机器上。

# .net - 使 LINQ 查询可以访问 NameValueCollection

> ID：391023
> 
> 赞同：65
> 
> 时间：2008-12-24T08:28:47.250
> 
> 标签：.net, linq, namevaluecollection

如何使`NameValueCollection`LINQ 查询运算符（例如 where、join、groupby）可以访问？

我尝试了以下方法：

```
private NameValueCollection RequestFields()
{
    NameValueCollection nvc = new NameValueCollection()
                                  {
                                      {"emailOption: blah Blah", "true"},
                                      {"emailOption: blah Blah2", "false"},
                                      {"nothing", "false"},
                                      {"nothinger", "true"}
                                  };
    return nvc;

}

public void GetSelectedEmail()
{
    NameValueCollection nvc = RequestFields();
    IQueryable queryable = nvc.AsQueryable();
} 
```

但是我得到一个*ArgumentException*告诉我**源不是 IEnumerable<>**。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-12-28T18:38:03.803

您需要将非泛型“提升”`IEnumerable`到`IEnumerable<string>`. 有人建议您使用`OfType`，但这是一种过滤方法。你正在做的是相当于一个演员，其中有`Cast`运营商：

```
var fields = RequestFields().Cast<string>(); 
```

正如 Frans 指出的那样，这仅提供对密钥的访问。您仍然需要对值的集合进行索引。`KeyValuePair`这是从 中提取s的扩展方法`NameValueCollection`：

```
public static IEnumerable<KeyValuePair<string, string>> ToPairs(this NameValueCollection collection)
{
    if(collection == null)
    {
        throw new ArgumentNullException("collection");
    }

    return collection.Cast<string>().Select(key => new KeyValuePair<string, string>(key, collection[key]));
} 
```

**编辑：**响应@Ruben Bartelink 的请求，这里是如何使用以下方法访问每个键的完整值集`ToLookup`：

```
public static ILookup<string, string> ToLookup(this NameValueCollection collection)
{
    if(collection == null)
    {
        throw new ArgumentNullException("collection");
    }

    var pairs =
        from key in collection.Cast<String>()
        from value in collection.GetValues(key)
        select new { key, value };

    return pairs.ToLookup(pair => pair.key, pair => pair.value);
} 
```

或者，使用 C# 7.0 元组：

```
public static IEnumerable<(String name, String value)> ToTuples(this NameValueCollection collection)
{
    if(collection == null)
    {
        throw new ArgumentNullException("collection");
    }

    return
        from key in collection.Cast<string>()
        from value in collection.GetValues(key)
        select (key, value);
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-24T15:15:22.873

`AsQueryable`必须取一个`IEnumerable<T>`，一个泛型。`NameValueCollection`实现`IEnumerable`，这是不同的。

而不是这个：

```
{
    NameValueCollection nvc = RequestFields();
    IQueryable queryable = nvc.AsQueryable();
} 
```

Try [OfType](http://msdn.microsoft.com/en-us/library/bb360913.aspx)（它接受非泛型接口）

```
{
    NameValueCollection nvc = RequestFields();
    IEnumerable<string> canBeQueried = nvc.OfType<string>();
    IEnumerable<string> query =
       canBeQueried.Where(s => s.StartsWith("abc"));
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-09-17T15:59:43.420

我知道我迟到了，但只是想添加不涉及`.Cast`扩展方法而是使用 AllKeys 属性的答案：

```
var fields = RequestFields().AllKeys; 
```

这将允许以下扩展方法：

```
public static IEnumerable<KeyValuePair<string, string>> ToPairs(this NameValueCollection collection)
{
    if(collection == null)
    {
        throw new ArgumentNullException("collection");
    }

    return collection.AllKeys.Select(key => new KeyValuePair<string, string>(key, collection[key]));
} 
```

希望这可以帮助任何未来的访客

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-06-07T15:21:26.680

字典实际上可能更接近您想要使用的内容，因为它实际上会填充 NameValueCollection 填充的更多角色。这是 Bryan Watts 解决方案的变体：

```
public static class CollectionExtensions
{
    public static IDictionary<string, string> ToDictionary(this NameValueCollection source)
    {
        return source.Cast<string>().Select(s => new { Key = s, Value = source[s] }).ToDictionary(p => p.Key, p => p.Value); 
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-24T08:36:52.320

问题是集合实现`IEnumerable`（而不是`IEnumerable<T>`）并枚举集合返回键，而不是对。

如果我是你，我会使用一个`Dictionary<string, string>`可枚举的并且可以与 LINQ 一起使用的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-03T13:01:53.283

对我来说，@Bryan Watts（+1'd）答案的`ToLookup`变体代表了迄今为止在只读基础上使用它的最清晰的方法。

对于我的用例，我正在处理一个与[Linq2Rest](http://nuget.org/packages/linq2rest)一起使用的查询字符串，并且还需要在`NameValueCollection`最后将其全部转换为 a，因此我有一组扩展方法，`NameValueCollection`它们提供了更精细的操作（每个参数都可以操作）名称 ( `AsEnumerable`) 和每个参数 ( `AsKeyValuePairs`)) 以及将其转换回来的逆操作`ToNameValueCollection`（从任一表示形式））。

消费示例：

```
public static NameValueCollection WithoutPagingOperators( this NameValueCollection that )
{
    return that.AsEnumerable()
        .Where( @param => @param.Key != OdataParameters.Skip 
          && @param.Key != OdataParameters.Top )
        .ToNameValueCollection();
} 
```

代码：

```
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Linq;

public static class NamedValueCollectionExtensions
{
    public static IEnumerable<KeyValuePair<string, string[]>> AsEnumerable( this NameValueCollection that )
    {
        return that
            .Cast<string>() // doesn't implement IEnumerable<T>, but does implement IEnumerable
            .Select( ( item, index ) => // enable indexing by integer rather than string
                new KeyValuePair<string, string[]>( item, that.GetValues( index ) ) ); // if you use the indexer or GetValue it flattens multiple values for a key, Joining them with a ',' which we don't want
    }

    public static IEnumerable<KeyValuePair<string, string>> AsKeyValuePairs( this IEnumerable<KeyValuePair<string, string[]>> that )
    {
        return that
            .SelectMany( item =>
                item.Value.Select( value =>
                    new KeyValuePair<string, string>( item.Key, value ) ) );
    }

    public static NameValueCollection ToNameValueCollection( this IEnumerable<KeyValuePair<string, string[]>> that )
    {
        return that.AsKeyValuePairs().ToNameValueCollection();
    }

    public static NameValueCollection ToNameValueCollection( this IEnumerable<KeyValuePair<string, string>> that )
    {
        var result = new NameValueCollection();
        foreach ( KeyValuePair<string, string> item in that )
            result.Add( item.Key, item.Value );
        return result;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-13T04:30:19.023

我真的不明白为什么有人需要添加扩展方法。
以下是在 VB.NET 中执行此操作的一些不同方法。它包括 4 种不同的 IEnumerable 中间形式：Array、Tuple、Anonymous 和 KeyValuePair。对于 C# 等效项，请访问 converter.telerik dot com 并对其进行转换。

```
Dim nvc As New NameValueCollection() From {{"E", "55"}, {"A", "11"}, {"D", "44"}, {"C", "33"}, {"G", "66"}, {"B", "22"}}

Dim dictStrings As Dictionary(Of String, String) = nvc.Cast(Of String).ToDictionary(Function(key) key, Function(key) nvc(key))
Dim Ints2Chars__ As Dictionary(Of Integer, Char) = nvc.Cast(Of Object).ToDictionary(Function(key) CInt(nvc(CStr(key))), Function(key) CChar(key))

Dim arrEnumerable__ = From x In nvc.Cast(Of String) Select {x, nvc(x)}
Dim tupleEnumerable = From x In nvc.Cast(Of String) Select Tuple.Create(x, nvc(x))
Dim anonEnumerable_ = From X In nvc.Cast(Of String) Select New With {X, .Y = nvc(X)}
Dim kvpEnumerable__ = From x In nvc.Cast(Of String) Select New KeyValuePair(Of String, String)(x, nvc(x))

Dim anonQuery = From anon In anonEnumerable_ Let n = CInt(anon.Y) Order By n Where n > 30 Select New With {.num = n, .val = anon.X}
Dim dictQuery = anonQuery.ToDictionary(Of Integer, String)(Function(o) o.num, Function(o) o.val)

Dim dictArray_ = arrEnumerable__.ToDictionary(Function(x) x(0), Function(x) x(1))
Dim dictTuples = tupleEnumerable.ToDictionary(Function(tuple) tuple.Item1, Function(tuple) tuple.Item2)
Dim dictAnon__ = anonEnumerable_.ToDictionary(Function(anon) anon.X, Function(anon) anon.Y)
Dim dictKVPrs_ = kvpEnumerable__.ToDictionary(Function(kvp) kvp.Key, Function(kvp) kvp.Value) 
```

# jdbc - 结合 2 个结果集

> ID：391027
> 
> 赞同：1
> 
> 时间：2008-12-24T08:36:29.310
> 
> 标签：jdbc, resultset

有没有办法将 2 个不同查询的结果添加到结果集中？

类似的东西：

```
ResultSet rs ;

i=0;

while(i<=l)

  ResultSet rs1 = select * from tablei;

  rs = rs + rs1; 

 i++;

} 
```

我知道我可以用联合来做到这一点，但我有很多查询，如果我使用联合，查询太慢了。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T09:49:47.023

你是在做 UNION 还是 UNION ALL？后者与自己做应该没有太大区别（尽管我希望自己做会慢一些）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T09:22:11.057

我不相信有任何方法可以将 ResultSet 添加到另一个。他们在类中没有执行此类操作或从代码更新 ResultSet 的方法。结果集旨在从数据库接收数据，而不是从开发人员操作、用户输入等接收数据。

我的建议是将数据提取到数组或类似的东西中，并在代码中操作数据或在查询中执行 UNION。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T09:40:45.920

根据您使用的数据访问库，ResultSet 有一个名为 MoveNextRecordSet() 的方法，SqlDataReader 提供 NextResult()。

创建一个存储过程以返回多个结果集（即一个 sp 中的多个 SELECT 语句），并使用这些方法浏览结果集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T10:07:24.990

如果您在数据库中找到比 UNION 性能更好的方法，我会感到惊讶。Union 正在做你想做的事，数据库服务器会尽可能地优化它。你基本上是在重新发明轮子。

如果您的 UNION 太慢，请尝试查看您的数据库是否可以使用更好的索引。与 UNION 选项相比，您还应该对各个查询进行一些时序分析。我希望一个或其他查询是缓慢的位，而不是 UNION。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T11:59:11.460

如果该联合需要太多时间才能完成，那么您应该考虑更改您使用的表上的索引。

你检查过你的索引碎片吗？

如果您可以通过这种方式加快查询速度，请查看是否添加了正确的索引。我不认为像这样使用一段时间会比联合所有更快。

# version-control - 在 TFS (CodePlex) 中快速/轻松地重命名文件名

> ID：391032
> 
> 赞同：3
> 
> 时间：2008-12-24T08:44:52.083
> 
> 标签：version-control, tfs, codeplex, file-rename

我在 CodePlex 上托管了一个项目，但是需要更改一堆（200 多个）文件的扩展名。

最简单、最不痛苦的方法是什么？我看不到自己在 IDE 中一一进行。

**更新：**

我知道我可以通过命令行/实用程序删除和更改它们，然后读取它们，但这会丢失历史记录。

也许 CodePlex 上有一些 TFS 的命令行界面？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-24T10:16:07.767

您可以使用随 TFS Team Explorer 一起安装的[tf.exe 。](http://www.codeplex.com/CodePlex/Wiki/View.aspx?title=Obtaining%20the%20Team%20Explorer%20Client&referringTitle=CodePlex%20FAQ)看

```
tf.exe rename /? 
```

求助。提示：您必须使用 /login 参数来指定您的凭据。没有那个 tf.exe 使用你的 Windows 帐户。重命名可能是这样的：

```
tf rename /login:user,password old.cs new.cs 
```

# ruby-on-rails - 如何将大型 Rails 应用程序切割成可以协同工作的小型应用程序？

> ID：391033
> 
> 赞同：7
> 
> 时间：2008-12-24T08:44:54.127
> 
> 标签：ruby-on-rails, deployment, refactoring, code-reuse

我使用过 Django，我非常喜欢它的项目/应用程序模型：您可以通过组装一个或多个 Django 应用程序来构建一个 Django 项目。这些应用程序可以是自治的，或者某些应用程序可以构建在其他应用程序之上。一个应用程序可以很容易地依赖另一个应用程序的模型，以及它的控制器（Django 帅哥称它们为“视图”）甚至它的视图（Django 中的“模板”）。

我现在正在处理一个相对较大的 Ruby on Rails 项目，我很惊讶地发现在 Rails 中做同样的事情显然没有简单的方法。基本上，在 Rails 中，一个项目 = 一个应用程序。我们的项目一开始是一个巨大的单体应用程序，现在我们正试图弄清楚如何将它分成更小的块。

例如，我们当前的应用程序允许我们管理合作伙伴和合同（除其他外）。我想要一个“合作伙伴”应用程序来管理我们的合作伙伴（地址、联系人等）和一个“合同”应用程序来管理我们与合作伙伴的合同。“合同”应用程序将依赖于“合作伙伴”应用程序（但为了避免循环依赖，我希望“合作伙伴”应用程序不了解“合同”应用程序）。

目前，我认为以下是主要选项：

1.  使这些应用程序通过 REST 请求进行通信（每个应用程序都将充当 Web 服务）：这很好，但似乎禁止重用其他应用程序的视图。例如，如果“合作伙伴”应用程序有一个不错的页面来显示合作伙伴的详细信息，并且如果我想在合同详细信息页面的中间显示该页面，稍作修改，我看不到其他方法这比让“合同”应用程序通过 REST 请求向“合作伙伴”应用程序询问合作伙伴详细信息（它将获得对象表示，而不是视图），然后从“合作伙伴”应用程序到“合同”应用程序。
2.  将这些应用程序变成插件：没有那么好，而且有点困难，但似乎允许模型和视图重用
3.  使用 svn external 从应用程序到应用程序共享一些模型：简单但丑陋。

感谢您的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T09:28:33.587

由于这是我也希望能够做到的事情，我可以提供四种 - 不完整且相对未经测试（由我）的“解决方案”：

没有特别的顺序...

1.  使用 Rails[引擎](http://rails-engines.org/)插件，它现在显然适用于 2.2。这在一定程度上或全部可能会融入 Rails 2.3（见下文）

2.  切换到 [Merb](http://merbivore.com)，它有一些称为“切片”的东西，可能会提供您正在寻找的东西。无论如何，如果 [这](http://yehudakatz.com/2008/12/23/rails-and-merb-merge/) 是正确的（我有什么资格怀疑 Yehuda Katz？）无论如何，总有一天，这一切都是一样的，这很酷。

3.  看看 Edge Rails 中的[引擎功能](http://skyfallsin.com/2008/11/27/engines-slices-in-edge-rails/)（“Edge”是最新提交但未发布的版本，因此它通常可以工作，但可能还不是 100% 的生产质量）。

4.  [研究在 routes.rb 中](http://guides.rails.info/routing_outside_in.html)使用命名空间- 将项目分配`app`到命名空间意味着您可以将其放入相关`app`子目录中的子目录中，尽管这对于为每个“应用程序”单独设置一组 Rails 目录可能不太干净。

其中，我没有（2）的经验，因为我（在基础设施方面）与 Rails 绑定，但没关系，我喜欢 Rails。我打算看看 (1) 或者 (3)，因为 2.3 可能会在我需要部署我的下一个主要版本之前发布，而且我已经尝试过 (4)，它有效，但是，嗯，繁琐和有点（对我来说）令人困惑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T17:24:15.343

如果您想调查 Mike 的 #2 选项，Merb 切片有[一个关于该主题的截屏视频，很有帮助](http://merbunity.com/screencasts/1)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-29T04:31:11.203

我使用了沙漠插件（以前的“插件加”）。它似乎工作得很好。 [http://github.com/pivotal/desert/tree/master](http://github.com/pivotal/desert/tree/master)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-12-24T09:02:01.223

我对 RoR 的看法是将您的“应用程序”编写为 Rails 中的控制器。他们可以非常独立，但可以共享助手和观点。我不知道 Django，所以术语可能不同。

# oracle - Oracle：我如何以编程方式安排我当前的连接被终止？

> ID：391036
> 
> 赞同：2
> 
> 时间：2008-12-24T08:47:05.310
> 
> 标签：oracle, exception, testing

为了在连接断开的情况下测试异常处理，能够以编程方式请求数据库终止连接很有用。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T08:51:36.110

这里有几段代码来处理这个问题。这适用于 RAC 多节点环境。它假设您的每个集群实例都有一个 TNS 条目。

1.  用于终止连接的 shell 脚本：

    ```
    #!/bin/sh
    # oracle-killsession -- kill a specified oracle session

    sid=$1; ser=$2; inst=$3
    echo -n sys password:
    stty -echo; read pass; stty echo
    echo "alter system kill session '$sid,$ser';"|
         sqlplus -SL sys/$pass@$inst as sysdba 
    ```

2.  用于生成对脚本的调用的客户端函数（python 中的 this）。我在我的测试程序开始时调用它并打印字符串，以便我可以剪切和粘贴。

    ```
    def killstring(curs):
        """return a string that will kill this db connection"""
        curs.execute("""SELECT dbms_debug_jdwp.current_session_id,
                               dbms_debug_jdwp.current_session_serial,
                               sys_context('USERENV', 'INSTANCE_NAME')
                        FROM dual""")
        (sid,serial,instance)=curs.fetchone()
        s="oracle-killsession %s %s %s"%(sid,serial,instance)
        return s 
    ```

3.  和一个示例调用

    ```
    $ oracle-killsession 98 45809 orcl2
    sys password:
    System altered. 
    ```

4.  从我的客户那里......万岁！

    ```
    cx_Oracle.DatabaseError: ORA-00028: your session has been killed 
    ```

# workflow-foundation - 在工作流基础中创作是什么意思

> ID：391038
> 
> 赞同：0
> 
> 时间：2008-12-24T08:50:43.647
> 
> 标签：workflow-foundation

我需要了解在工作流基础中创作的含义以及它的类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-24T19:15:54.573

创作基本上意味着创建新的或修改现有的工作流。有两种基本类型，顺序工作流和状态机工作流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T18:18:54.247

最后我发现了。创作是编写工作流的模式。它们是三种类型。

1.  基于代码
2.  无代码和基于 XOML
3.  一些基于代码的。

# flash - flash 是否原生支持 MP3 音频格式？

> ID：391041
> 
> 赞同：2
> 
> 时间：2008-12-24T08:51:47.810
> 
> 标签：flash, plugins, adobe, native, codec

我认为 Flash（更具体地说是 Adob​​e 的 Flash 播放器浏览器插件）可能使用一些已安装的 MP3 编解码器（在客户端机器上）使用 OS API。听说有人说Flash原生支持MP3。真的吗？

我猜flash有它自己的视频和音频格式。（FLV 和类似的音频）。

这个问题也可以表述为“Flash（插件）原生支持哪些音频/视频格式”。

*谢谢你。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-25T10:25:02.210

Flash 支持的所有内容类型（包括 MP3）均受本机支持。Flash 不需要或使用来自客户端操作系统的任何编解码器。

这是一个[方便的 Flash 支持的视频和音频编解码器列表](http://kb.adobe.com/selfservice/viewContent.do?externalId=kb402866)- 但现在实际上有点过时了，因为它省略了Flash 从版本 10 开始支持的[Speex音频编解码器。](http://en.wikipedia.org/wiki/Speex)

旁注：您提到 FLV 是 Fl​​ash 的“自己的”格式，但请注意 FLV 不是编解码器，它只是一个容器文件。里面的音频/视频内容将在上面链接的编解码器之一中进行编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T09:12:47.160

Flash 播放器可以毫无问题地播放 MP3 编码的音频。如果目标操作系统支持 Flash，则 Flash 将播放 MP3，除了必备的声卡和扬声器之外，没有任何其他要求。此外，Flash 有一些很棒的 MP3 流功能和一整套缓冲托管文件的工具。至少从 Flash 6 开始就是这种情况。要记住的一件事是，出于“安全”原因，MP3 源必须来自托管 Flash SWF 的同一域，至少我上次检查过。

# django - Django 中的 Unicode 应用程序名

> ID：391054
> 
> 赞同：3
> 
> 时间：2008-12-24T09:04:23.387
> 
> 标签：django, unicode, character-encoding

我住在挪威，当我制作 Django 应用程序时，我希望能够使用像“æøå”这样的字符来命名我的应用程序，这些字符在 unicode 中可以正常工作，但是当我尝试在应用程序名称或字段中使用这些字符时显示文本我得到一个错误。

更好的是，我想按英文约定命名我的应用程序，但对应用程序有类似“verbose_name”的名称，而不仅仅是模型。

那么是否可以为应用程序设置显示名称，而不仅仅是模型？以及如何在管理界面中使用 unicode 字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T12:27:18.780

[这是来自http://softwaremaniacs.org/forum/django/716/](http://softwaremaniacs.org/forum/django/716/)的肮脏黑客（俄语）

在 /django/contrib/admin/templates/index.html 更改

```
<caption>{% blocktrans with app.name as name %}{{ name }}{% endblocktrans %}</caption> 
```

到

```
<caption>{% trans app.name %}</caption> 
```

在models.py中：

```
class Meta:
    verbose_name = _("Module name") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T19:47:09.587

我强烈建议不要尝试在您的应用程序中使用 unicode。这源于该名称当前源自您的应用程序所在目录的名称这一事实。这应该在未来发生变化，允许应用程序的详细名称，但目前这是不可能的。

还要记住，通过编程，命名和文档的实际标准是英语。

# asp.net - ASP.Net 中 URL 中的 UrlEncoding Plus(+)

> ID：391057
> 
> 赞同：3
> 
> 时间：2008-12-24T09:05:47.270
> 
> 标签：asp.net, url

我正在加密和 Base64 字符串。一切都很好，直到我从 QueryString 集合中检索到加密字符串。加密文本包含一个加号。当我检索加密字符串时，曾经有一个加号的地方现在有一个空格。正如您可以想象的那样，这不会解密。

我已经尝试过 Server.HtmlEncode/HtmlDecode 和 Server.UrlEncode/Server.UrlDecode 均无济于事。这两种方法都将加号与空格混淆了。

有任何想法吗？

这是一个类似的帖子：[QueryString Malformed](https://stackoverflow.com/questions/123994/querystring-malformed-after-urldecode)

**编辑：** 我找到了解决方案： Server.UrlEncode 确实有效，我正在应用 Server.UrlDecode 并且也不需要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-03T19:14:25.227

Be careful, the method of substituting "+++" for "==" is dangerous because in rare situations, it is possible for an encrypted query string to validly contain "+++". In this case, the decryption fails. For a better solution to the problem, look at using the "modified base64 for url". It involves switching out "-" for "+" and "_" for "/" and has no "==" padding. It seems to be working for us, even in situations where the other failed. Here is the link I used for reference that is working for us.

[Code for decoding/encoding a modified base64 URL](https://stackoverflow.com/questions/1228701/code-for-decoding-encoding-a-modified-base64-url)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T09:24:27.807

几年前我也遇到过你这样的问题。这是我将base64查询字符串解码为字符串的代码，反之亦然

```
 public static String DoDecryption(String Value)
    {
        Decryptor dec = new Decryptor(EncryptionAlgorithm.TripleDes );
        dec.IV = Encoding.ASCII.GetBytes("funky");
        byte [] DecValue =  Convert.FromBase64String(Value.Replace("+++","=="));
        byte [] DecKey   = Encoding.ASCII.GetBytes("0123456789012345");
        byte [] DecipherValue = dec.Decrypt(DecValue,DecKey);
        return Encoding.ASCII.GetString(DecipherValue);
    } 
```

这是加密部分

```
 public static String DoEncryption(String Value)
    {
        Encryptor enc = new Encryptor(EncryptionAlgorithm.TripleDes);
        byte [] EncValue =  Encoding.ASCII.GetBytes(Value);
        byte [] EncKey   = Encoding.ASCII.GetBytes("0123456789012345");
        enc.IV = Encoding.ASCII.GetBytes("funky");
        byte [] CipherValue = enc.Encrypt(EncValue,EncKey);
        //InitVector = Encoding.ASCII.GetString(enc.IV);
        return Convert.ToBase64String(CipherValue).Replace("==","+++");
    } 
```

Note that Value parameter in DoEncryption is the string you want to encrypt into querystring and value parameter in DoDecryption is query string that already convert into base64 string.

Hope thats help

# security - 您使用哪种哈希方法（MD5、SHA1、其他？）

> ID：391066
> 
> 赞同：11
> 
> 时间：2008-12-24T09:12:09.830
> 
> 标签：security, encryption, hash

[这个维基百科页面](http://en.wikipedia.org/wiki/Cryptographic_hash_function)有一个广泛的散列方法列表

如您所见，MD5 和 Sha1 都已被破坏（在密码学中，“破坏”意味着攻击没有暴力攻击复杂。换句话说，如果您需要 100 万年而不是 10 亿年来发现碰撞使用蛮力，该算法被认为是损坏的，即使使用它可能仍然安全）

您使用什么作为哈希算法？

SHA1 已损坏，但仍需要数十亿年的时间来计算碰撞。

其他散列仍然是完整的，但我们必须记住，研究人员将精力集中在主流算法（即 MD5 和 SHA1）上，因此完整的散列也可能是不安全的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-24T10:01:54.283

如今，大多数人仍然使用 SHA1 甚至 MD5，无论是否损坏。因为散列技术的当前状态是，我们知道一些函数存在理论上的漏洞，但没有真正的实际突破，还有一些未经证实的函数，我们对此知之甚少。

如果您使用哈希函数存储密码，那么理论上的漏洞可能对您来说并不重要。首先，因为漏洞的性质并不能真正帮助反转密码。其次，因为如果您非常关心安全性，您可能不会使用密码。

更重要的是您是否使用数字签名、SSL、IPSEC 等，它们都依赖于散列函数，以及您是否需要散列函数长时间保持安全。但是在这里，您别无选择，只能等待看看哪些散列函数成为新的经过验证的标准，和/或尽可能使用多个散列函数。

即便如此，从总体上看，这在威胁列表中还是很靠后的。与攻击您的哈希函数的人相比，您系统中的安全问题更可能出在您自己的代码或人员威胁中！

尽管如此，如果设计一个新系统，设计它以便您可以随时替换*任何*加密算法的建议仍然很有价值。理想情况下通过配置/插件，而不是重新编译。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T09:34:37.693

我使用[Whirlpool hash](http://www.larc.usp.br/~pbarreto/WhirlpoolPage.html)。但是......您不能依靠散列来保护密码。如果您将密码存储在数据库中，请*始终*使用合适的盐（这有助于防止彩虹表攻击和冲突）。

并遵循适用于您的平台的其他适当的安全指南 :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T09:39:35.593

这取决于我将哈希用于... 安全性？文件更改检测？查找重复文件？

我假设从提出问题的方式来看，前者是您使用哈希的原因。在这种情况下，我建议不要使用“破碎”的方法。

如果是非安全用途（即查找重复文件），MD5 可以正常工作并且速度更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T09:17:31.863

还有其他像[SHA-256](http://en.wikipedia.org/wiki/SHA-256#SHA-256_.28a_SHA-2_variant.29_pseudocode)或[RIPEMD-160](http://en.wikipedia.org/wiki/RIPEMD-160)甚至是 SHA-3 候选者之一（请参阅[此处](http://en.wikipedia.org/wiki/NIST_hash_function_competition)的列表供您选择。请始终记住，这些还没有像 MD4/5 和 SHA- 1\. 这当然在性能方面也是有代价的。

您的问题的一个答案是使用其中的两个，希望它们足够不同，以至于破坏一个不会破坏另一个。恕我直言，两者都被打破以伪造两个校验和的可能性非常大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T09:19:50.250

如果您关心安全性，最好避免“损坏”的哈希函数。对于刚刚被研究人员破解的一些哈希函数，您所说的可能是正确的，但是通过使用从研究工作中获得的新见解，现实世界的攻击很快就会浮出水面。

例如，现在可以很快找到 MD5 的冲突（我认为 wikipedia 提到了一种可以在几分钟内完成但如果我错了请纠正我的方法）。

如果发生这种情况，您不想为已经计算的大量事物重新计算所有哈希/签名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T09:44:10.297

据我了解，MD5 的损坏部分是*拥有原始*文本的人现在能够轻松构建具有相同 MD5 摘要的*第二个文本。*

对于只有原始文本的 MD5 摘要的人来说，仍然不可能构建与之匹配的第二个文本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-20T06:58:08.527

这也在[https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords](https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords)和[https://security.stackexchange.com/questions/56397/which-hashing-algorithm-is进行了讨论-理想的网络使用](https://security.stackexchange.com/questions/56397/which-hashing-algorithm-is-ideal-for-use-on-the-web)

TL;博士：

*   如果你散列**密码**，你需要一些慢的东西，比如 bcrypt。
*   否则，SHA-256 似乎是要走的路。

# visual-studio-2008 - 在 VS 2008 中处理 VS 2005 解决方案

> ID：391081
> 
> 赞同：2
> 
> 时间：2008-12-24T09:24:23.113
> 
> 标签：visual-studio-2008, visual-studio-2005

我不想在我的笔记本电脑上安装 2005，但我经常喜欢在家工作。我正在制定一个流程，使我能够检查 2005 年的项目，备份解决方案和项目文件 - 这些都是变化 - 并将解决方案转换为 2008。然后我备份 2008 年的解决方案和项目文件，并开始工作.

为了提交我的工作，我比较了新旧 2008 解决方案和项目文件，并手动对 2005 解决方案和项目文件进行任何更改。这种情况很少发生，当它发生时，98% 的时间是在添加、重命名或删除一个简单的类或一个带有代码隐藏和设计器文件的 ASP.NET 页面。然后我用更新的 2005 文件替换 2008 解决方案和项目文件，并提交解决方案。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T06:02:03.233

我们维护多个项目文件 - 每个 VS 版本一个。如果我们经常将类添加到任何特定版本，则确实需要将这些类复制到您提到的其他版本。

我们还注意使用诸如“#if DotNet35”之类的编译指令来“隐藏”2008 年可能存在但对于 2005 年来说太新的代码区域。如果您正在处理使用的共享库，这很有用2005 年和 2008 年的项目。

关于多目标的答案，这不会有太大帮助，因为 VS2k8 仍然需要解决方案文件为 2k8 格式。它只会确保最终结果（也就是编译的内容）能够针对特定版本的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T09:41:28.210

为什么不创建两个单独的项目，一个用于 vs2005，一个用于 vs2008？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T09:46:24.380

您应该只使用**Visual Studio 2008**，因为它具有**多目标**功能，因此允许您处理*.net 2.0*应用程序（不支持 1.1）**，而无需将它们转换为 VS 2008 解决方案**

有关此问题的更多详细信息，请查看ScottGu 的[这篇文章](http://weblogs.asp.net/scottgu/archive/2007/06/20/vs-2008-multi-targeting-support.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T10:04:30.817

可以在 Visual Studio 2008 的框架 1.1 中工作

[http://tech.einaregilsson.com/2008/01/15/developing-aspnet-1-1-in-visual-studio-2008/](http://tech.einaregilsson.com/2008/01/15/developing-aspnet-1-1-in-visual-studio-2008/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-24T10:57:44.890

为什么不直接使用两种不同的解决方案文件，一种用于 2005，一种用于 2008？

# c# - 数组列表与列表 I saw this reply from Jon on Initialize generic object with unknown type: If you want a single co 问问题 faulty 问问题 2008-12-24T09:30:19.293 28247 次 This question shows research effort; it is useful and clear 52 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I saw this reply from Jon on Initialize generic object with unknown type: If you want a single collection to contain multiple unrelated types of values, however, you will have to use List<object> I'm not comparing ArrayList vs List<>, but ArrayList vs List<object>, as both will be exposing elements of type object. What would be the benefit of using either one in this case? EDIT: It's no concern for type safety here, since both class is exposing object as its item. One still needs to cast from object to the desired type. I'm more interested in anything other than type safety. EDIT: Thanks Marc Gravell and Sean for the answer. Sorry, I can only pick 1 as answer, so I'll up vote both. List<> is a typesafe version of ArrayList. It will guarantee that you will get the same object type in the collection. c#.netlistarraylist 4 6 回答 6 This answer is useful 84 You'll be able to use the LINQ extension methods directly with List<object>, but not with ArrayList, unless you inject a Cast<object>() / OfType<object> (thanks to IEnumerable<object> vs IEnumerable). That's worth quite a bit, even if you don't need type safety etc. The speed will be about the same; structs will still be boxed, etc - so there isn't much else to tell them apart. Except that I tend to see ArrayList as "oops, somebody is writing legacy code again..." ;-p 于 2008-12-24T11:08:27.020 回答 This answer is useful 46 One big benefit to using List<object> is that these days most code is written to use the generic classes/interfaces. I suspect that these days most people would write a method that takes a IList<object> instead of an IList. Since ArrayList doesn't implement IList<object> you wouldn't be able to use an array list in these scenarios. I tend to think of the non-generic classes/interfaces as legacy code and avoid them whenever possible. 于 2008-12-24T10:17:01.133 回答 This answer is useful 11 In this case, ArrayList vs. List<Object> then you won't notice any differences in speed. There might be some differences in the actual methods available on each of these, particular in .NET 3.5 and counting extension methods, but that has more to do with ArrayList being somewhat deprecated than anything else. 于 2008-12-24T10:17:39.807 回答 This answer is useful 5 Yes, besides being typesafe, generic collections might be actually faster. From the MSDN (http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx) The System.Collections.Generic namespace contains interfaces and classes that define generic collections, which allow users to create strongly typed collections that provide better type safety and performance than non-generic strongly typed collections. 于 2008-12-24T09:38:12.040 回答 This answer is useful 1 Do some benchmarking and you will know what performs best. I guestimate that the difference is very small. 于 2008-12-24T12:17:22.187 回答 This answer is useful -4 List<> 是 ArrayList 的类型安全版本。它将保证您将在集合中获得相同的对象类型。 于 2008-12-24T09:34:00.707 回答 Related 1 java - 密码至少 [1-9] 至少 [az] 至少 [AZ] 不带特殊字符 1 java - 按下按钮时，ProgressIndicator 会冻结。JavaFX 1 asp.net-mvc-3 - Telerik MVC 网格分页查询字符串参数 1 android - 检查是否从外部服务检索到空值 1 sql - 替代 MIN 以选择多行 1 joomla - 为什么 JCE 会删除文章中看起来像 html 标记的文本？ 2 jquery - 手风琴添加和删除类 3 java - 确定 Java 包的位置 1 windows - 詹金斯“批量构建”每次都失败 3 c# - 有没有更简单的方法在 ListItemCollection 上进行投影？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：391088
> 
> 赞同：52
> 
> 时间：
> 
> 标签：c#, .net, list, arraylist

I saw this reply from Jon on [Initialize generic object with unknown type](https://stackoverflow.com/questions/386500/initialize-generic-object-with-unknown-type):

> If you want a single collection to contain multiple unrelated types of values, however, you will have to use `List<object>`

I'm not comparing `ArrayList` vs `List<>`, but `ArrayList` vs `List<object>`, as both will be exposing elements of type `object`. What would be the benefit of using either one in this case?

EDIT: It's no concern for type safety here, since both class is exposing `object` as its item. One still needs to cast from `object` to the desired type. I'm more interested in anything other than type safety.

EDIT: Thanks Marc Gravell and Sean for the answer. Sorry, I can only pick 1 as answer, so I'll up vote both.

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-12-24T11:08:27.020

You'll be able to use the LINQ extension methods directly with `List<object>`, but not with `ArrayList`, unless you inject a `Cast<object>()` / `OfType<object>` (thanks to `IEnumerable<object>` vs `IEnumerable`). That's worth quite a bit, even if you don't need type safety etc.

The speed will be about the same; structs will still be boxed, etc - so there isn't much else to tell them apart. Except that I tend to see `ArrayList` as "oops, somebody is writing legacy code again..." ;-p

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-12-24T10:17:01.133

One big benefit to using `List<object>` is that these days most code is written to use the generic classes/interfaces. I suspect that these days most people would write a method that takes a `IList<object>` instead of an `IList`. Since `ArrayList` doesn't implement `IList<object>` you wouldn't be able to use an array list in these scenarios.

I tend to think of the non-generic classes/interfaces as legacy code and avoid them whenever possible.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-24T10:17:39.807

In this case, `ArrayList` vs. `List<Object>` then you won't notice any differences in speed. There might be some differences in the actual methods available on each of these, particular in .NET 3.5 and counting extension methods, but that has more to do with ArrayList being somewhat deprecated than anything else.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-24T09:38:12.040

Yes, besides being typesafe, generic collections might be actually faster.

From the MSDN ([http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx](http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx))

> The **System.Collections.Generic** namespace contains interfaces and classes that define generic collections, which allow users to create strongly typed collections that provide better type safety and performance than non-generic strongly typed collections.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-24T12:17:22.187

Do some benchmarking and you will know what performs best. I guestimate that the difference is very small.

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-12-24T09:34:00.707

List<> 是 ArrayList 的类型安全版本。它将保证您将在集合中获得相同的对象类型。

# nhibernate - 你能混合使用 Fluent NHibernate 和 Traditional hbm.xml

> ID：391101
> 
> 赞同：7
> 
> 时间：2008-12-24T09:37:14.913
> 
> 标签：nhibernate

我们已经在 hbm.xml 中完成了一些映射，我宁愿不必以编程方式映射这些，您能否将它们混合在同一个 sessionfactory 中，直到我们有时间偿还债务？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-25T00:38:28.243

是的。

完全可以混合它们。我正在做我目前的项目。

我的 SessionFactory 构造看起来像这样：

```
 _configuration = new Configuration();
        _configuration.SetProperties(properties);

        // hbm files
        _configuration.AddAssembly(typeof(ISurveyTask).Assembly); 
```

...

```
 var persistenceModel = new PersistenceModel(...)

        // fluent mappings
        persistenceModel.addMappingsFromAssembly(typeof(ISurveyTask).Assembly);
        persistenceModel.Configure(_configuration); 
```

享受 ：-）

# c++ - 如何找出 Linux 上的 GNU C++ 中剩余的可用内存量

> ID：391107
> 
> 赞同：6
> 
> 时间：2008-12-24T09:40:22.190
> 
> 标签：c++, linux, memory

我正在编写一个 C++ 程序（用 gcc 编译并在 RedHat Linux 上运行）。程序需要在运行时知道堆栈上剩余多少空间以及堆中剩余多少。我意识到这个问题（关于堆）可能没有明确的答案，所以或者，我可以使用已经从堆中分配的内存量。是否有库/系统函数调用会给我这些数据？

我想补充一点，我只需要这个来进行调试，并且只需要粗略的估计，所以快速而肮脏的解决方案是完全可以接受的。但是，我需要非常频繁地查询内存使用情况，因此使用 Unix 命令行实用程序并解析其输出是不可接受的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T09:52:47.377

您可能可以创建自己的 new 和 delete 函数来封装真正的 new 和 delete 运算符，同时注意内存使用情况。

对于堆栈，C 中有一个技巧，您可以查看当前函数中定义的第一个局部变量的地址，以粗略了解当前堆栈指针的位置。我想它应该在 C++ 中工作，但还没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T10:09:15.533

在 linux 上你可以阅读 /proc/ `pid`/status

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T13:32:49.007

请注意，在 32 位系统上，堆栈向下增长，堆向上增长，两者可能会在中间的某个地方相遇。因此，空间可能被分配给堆栈或堆，但不能同时分配给两者。请注意，共享内存段（如果您使用它们）会使内存映射复杂化。动态加载（共享）库也是如此。

```
+------------+
|    stack   | high addresses
|      |     |
|      v     |
+------------+
|            |
|   unused   |
|            |
+------------+
|            |
|      ^     |
|      |     |
|    heap    |
|            |
+------------+
|            |
|     bss    |
|            |
+------------+
|            |
|    data    |
|            |
+------------+
|            |
|    text    |
|            | low addresses
+------------+ 
```

在 64 位系统上，有足够的地址空间可以在发生冲突之前用完实际内存和虚拟内存。

另外，请注意（至少某些版本的）Linux 愿意说可以分配的内存比它们实际支持的更多 - 它们过度使用。那不是很好。这意味着像试用内存分配这样的实际实验可能会给你一种错误的安全感。

最有可能的是，您最好询问“还剩多少 MB (GB？) 的空间”，而不是“还剩多少 MB (GB？) 的空间”。其他人指出`/proc`文件系统是使用多少内存的信息来源。我不确定它是否可靠地告诉您有多少内存可供抓取。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-08T02:06:45.193

这是一个 C 函数，用于返回 Raspberry PI 上的可用内存量。它通过读取 /proc/meminfo 来工作。我不确定它是否适用于其他系统。

```
#include <stdio.h>
#include <string.h>
// Return the amount of free memory in kbytes.
// Returns -1 if something went wrong.
int getfreememory()
{
  int returnValue;
  const int BUFFER_SIZE = 1000;
  char buffer[BUFFER_SIZE];
  FILE *fInput;
  int loop;
  int len;
  char ch;
  returnValue = -1;
  fInput = fopen("/proc/meminfo","r");
  if (fInput != NULL)
  {
    while (!feof(fInput))
    {
      fgets(buffer,BUFFER_SIZE-1,fInput);
      if (feof(fInput))
      {
        break;
      }
      buffer[BUFFER_SIZE-1] = 0;
      // Look for serial number
      if (strncmp(buffer,"MemFree:",8)==0)
      {
        // Extract mem free from the line.
        for(loop=0;loop<BUFFER_SIZE;loop++)
        {
          ch = buffer[loop];
          if (ch == ':')
          {
             returnValue = 0;
             continue;
          }
          if (ch == 0)
          {
              break;
          }
          if (returnValue >=0)
          {
             if (ch >='A')
             {
                break;
             }
             if ((ch >='0') && (ch <='9'))
             {
                returnValue = returnValue * 10 + (ch-'0');
             }
          }
        }
        break;
      }
    } 
    fclose(fInput);
  }
  return returnValue;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T18:28:42.377

带有 RLIMIT_STACK 参数的 getrlimit 将告诉您总共有多少堆栈空间。使用 RLIMIT_AS 参数，您可以找出有多少虚拟内存。

有关更多信息，请查看[http://linux.die.net/man/2/getrlimit](http://linux.die.net/man/2/getrlimit)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T10:04:17.430

您可以在 /proc 命名空间中检查文件 /proc/<pid>/smaps 和 /proc/<pid>/maps，其中 <pid> 是当前进程 ID。

看看[这篇博文](http://bmaurer.blogspot.com/2006/03/memory-usage-with-smaps.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-24T10:06:42.870

Valgrind 的 Massif 工具支持堆栈和堆[分析](http://valgrind.org/docs/manual/ms-manual.html)。你可能想检查它的源代码，看看它是如何做到的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-24T13:42:10.097

对于堆部分，也许您正在达到资源限制。看看[这个](http://linux.die.net/man/2/getrlimit)。

你可以使用 Valgrind 进行堆栈分析，但你打算用它做什么呢？栈不像堆。你说，你想这样做是为了调试。如果您的程序运行良好，则不存在堆栈问题（至少与其大小有关）。

您可以为您创建的线程设置堆栈大小，并通过查看局部变量（不得优化）地址来检查堆栈指针值。只需使用初始大小、初始堆栈指针值和当前堆栈指针值进行一些数学运算，您就会得到一些不错的数字。只是不要忘记先找出堆栈方向。这可能会因平台而异。

我认为如果你这么关心堆的使用，那么你的程序可能会泄漏内存。在这种情况下，Valgrind 可以为您指明正确的方向。[瓦尔格林德](http://valgrind.org/)

# php - 使用 Zend Framework 模型定义表关系方法的最佳代码位置是什么？

> ID：391111
> 
> 赞同：1
> 
> 时间：2008-12-24T09:41:26.947
> 
> 标签：php, database, model-view-controller, zend-framework, orm

我正在创建一个简单的标签系统，它允许我将标签链接到我的应用程序中的几乎所有内容。为了方便这一点，我创建了一个名为“objects”的表，由我的模型“Object”引用。

目前我已经设置了三个模型：

*   标记（将 TagObject 定义为依赖表）
*   对象（将 TagObject 定义为依赖表）
*   TagObject（在 referenceMap 中定义了 Tag 和 Object）

我已经在我的标签模型中创建了一些简单的方法，例如`fetchTagById()`和`fetchTagByName()`，但现在我想创建一个方法来获取我的标签及其在对象表中的相应出现，以便创建一个简单的标签云。

在结构方面，创建此方法的最佳位置是什么（使用[findDependentRowset()](http://framework.zend.com/manual/en/zend.db.table.relationships.html)）？

不知何故，我觉得将它存储在我的 Tag 模型中并不是很好的做法，但是将它存储在我的 TagObject 模型中似乎也很尴尬，并且可能会使事情变得过于复杂。

任何建议将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T10:01:00.340

如果该方法检索标签，那么它应该在标签模型中。如果它检索对象，它应该在对象模型中。由于您正在检索标签及其出现，它应该在标签模型中。

我将模型称为标签而不是标签，因为标签是标签中的行，而在 ZF 中，模型通常是表的 DataGateway。与对象相同。

```
$tags = new Tags();
$cloud = $tags -> getWithObjectOccurrences(); 
```

另一方面，我永远不会将一个类命名为“对象”或“对象”，因为它太通用了（对象是一种基本的语言结构）。考虑为它找到一个更具描述性的名称。

# sql-server - SQL Server 2005 varchar 丢失小数位转换为小数

> ID：391117
> 
> 赞同：0
> 
> 时间：2008-12-24T09:44:42.510
> 
> 标签：sql-server, decimal

```
Declare @BadDecimal varchar(5)
Set @BadDecimal = '4.5'
Declare @GoodDecimal Decimal
Set @GoodDecimal = @BadDecimal
Select @GoodDecimal

--Outputs 5 
```

为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-24T09:58:24.183

尝试

```
Declare @GoodDecimal Decimal(2,1) 
```

编辑：请求后更改为 (2,1)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T10:07:53.087

Coentjie 打败了我 arrggg...

您需要使用以下格式声明小数 Decimal(p,s)

p = 可以存储的小数位数的最大总数，包括小数点的左侧和右侧。精度必须是 1 到最大精度 38 之间的值。默认精度为 18。

s = 小数点右侧可以存储的最大小数位数。比例必须是从 0 到 p 的值。仅当指定精度时才能指定比例。默认比例为 0；因此，0 <= s <= p。最大存储大小因精度而异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T09:50:54.307

尝试`Set @BadDecimal = '4,5'`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T09:54:25.487

强制转换或转换为显式十进制（数字，精度）有效：

```
SELECT CONVERT(DECIMAL(5, 2), '4.5')
SELECT CAST('4.5' AS DECIMAL(5,2)) 
```

SQLServer 帮助指出（数字、精度）的每个组合都作为单独的数据类型处理。

# c++ - 如何从 MFC 中的线程更改状态栏的窗格文本？

> ID：391125
> 
> 赞同：6
> 
> 时间：2008-12-24T09:49:19.507
> 
> 标签：c++, multithreading, mfc, thread-safety

我在 MFC 中有一个带有 CStatusBar 的对话框。在一个单独的线程中，我想更改状态栏的窗格文本。然而 MFC 抱怨断言？它是如何完成的？一个示例代码会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T12:05:19.480

您可以将私人消息发布到主框架窗口并“要求”它更新状态栏。线程需要主窗口句柄（不要使用 CWnd 对象，因为它不是线程安全的）。这是一些示例代码：

```
static UINT CMainFrame::UpdateStatusBarProc(LPVOID pParam);

void CMainFrame::OnCreateTestThread()
{
    // Create the thread and pass the window handle
    AfxBeginThread(UpdateStatusBarProc, m_hWnd);
}

LRESULT CMainFrame::OnUser(WPARAM wParam, LPARAM)
{
    // Load string and update status bar
    CString str;
    VERIFY(str.LoadString(wParam));
    m_wndStatusBar.SetPaneText(0, str);
    return 0;
}

// Thread proc
UINT CMainFrame::UpdateStatusBarProc(LPVOID pParam)
{
    const HWND hMainFrame = reinterpret_cast<HWND>(pParam);
    ASSERT(hMainFrame != NULL);
    ::PostMessage(hMainFrame, WM_USER, IDS_STATUS_STRING);
    return 0;
} 
```

代码来自内存，因为我在家里无法访问编译器，所以现在为任何错误道歉。

`WM_USER`您可以注册自己的 Windows 消息，而不是使用：

```
UINT WM_MY_MESSAGE = ::RegisterWindowsMessage(_T("WM_MY_MESSAGE")); 
```

例如，将上述内容设为静态成员`CMainFrame`。

如果使用字符串资源太简单，那么让线程在堆上分配字符串并确保 CMainFrame 更新函数将其删除，例如：

```
// Thread proc
UINT CMainFrame::UpdateStatusBarProc(LPVOID pParam)
{
    const HWND hMainFrame = reinterpret_cast<HWND>(pParam);
    ASSERT(hMainFrame != NULL);
    CString* pString = new CString;
    *pString = _T("Hello, world!");
    ::PostMessage(hMainFrame, WM_USER, 0, reinterpret_cast<LPARAM>(pString));
    return 0;
}

LRESULT CMainFrame::OnUser(WPARAM, LPARAM lParam)
{
    CString* pString = reinterpret_cast<CString*>(lParam);
    ASSERT(pString != NULL);
    m_wndStatusBar.SetPaneText(0, *pString);
    delete pString;
    return 0;
} 
```

不完美，但这是一个开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T10:23:53.740

也许这可以帮助您：[如何从 MFC 中的线程访问 UI 元素。](http://www.codeguru.com/forum/showthread.php?t=312454)

我自己没有编写 C++/MFC 代码，但我在 C# 中遇到过类似的问题，即所谓的跨线程 GUI 更新。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T12:01:06.900

您应该使用消息（使用 Send- 或 PostMessage）来通知 UI 线程应该更新状态栏文本。不要试图从工作线程中更新 UI 元素，它一定会给你带来痛苦。

# java - Java中串口参数的含义？

> ID：391127
> 
> 赞同：5
> 
> 时间：2008-12-24T09:49:48.053
> 
> 标签：java, serial-port, core

我是Java的初学者。我正在从串口读取数据。我有

```
serialPort.setSerialPortParams(
   9600, SerialPort.DATABITS_8, SerialPort.STOPBITS_1, 
   SerialPort.PARITY_NONE); 
```

和的含义是`9600`什么？`DATABITS_8,STOPBITS_1``PARITY_NONE`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-24T16:19:49.780

> 9600、DATABITS_8、STOPBITS_1 和 PARITY_NONE

**9600 [BAUD](http://en.wikipedia.org/wiki/Baud)**：波特是每秒符号或脉冲的同义词。在这种情况下，它指的是每秒传输的位数。

**[DATABITS](http://en.wikipedia.org/wiki/Serial_port#Data_Bits) _8**：一次传输 8 位数据。这是典型的，因为现在大多数机器都有 8 位字节。

**[STOPBIT](http://en.wikipedia.org/wiki/Serial_port#Stop_bits) S_1**：添加一个尾随位以标记字的结尾。

**PARITY_NONE**：不包括[奇偶校验](http://en.wikipedia.org/wiki/Serial_port#Parity)位。这是一个错误检查功能。对于偶校验，如果它会使位的总和为偶数，则添加 1，反之亦然，对于奇校验。有时也使用标记和空间奇偶校验。RS-232 是一种低级协议，错误检查通常留给应用层。出于这个原因，串行数据包中通常包含校验[和](http://en.wikipedia.org/wiki/Checksum)或[CRC 。](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)例如，以太网对其数据帧使用 32 位 CRC，但它从不涉及应用程序开发人员。

在 RS-232 通信中，总是包含一个起始位。通用[异步接收器/发送器 (UART)](http://en.wikipedia.org/wiki/UART) ——这个 Java 库将控制的硬件——寻找这个标记，然后开始将数据位转移到缓冲区中。因此，传输中的每个字将占用 10 位：1 个起始位 + 8 个数据位 + 1 个停止位。在 9600 波特率下，即使发送相当于 1200 字节的数据，这将为您提供每秒 960 字节的最大数据传输速率：每秒 9600 位除以每字 10 位得到每秒 960 字和 8 个数据位（ 1 个字节）每个字。

您正在使用的此配置通常缩写为**9600,8,N,1**以表示*速度、数据位、奇偶校验和停止位*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T10:02:07.343

当你说你“得到serialPort.setSerialPortParams(....”时，你从哪里得到的？如果你想了解方法的参数，请参阅[javadoc](http://java.sun.com/products/javacomm/reference/api/javax/comm/SerialPort.html#setSerialPortParams(int,%20int,%20int,%20int))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-23T12:53:32.800

如果您不熟悉串口，请阅读[http://www.beyondlogic.org/serial/serial.htm](http://www.beyondlogic.org/serial/serial.htm)

# asp.net - 什么是 ASP.NET 中的 HttpHandler

> ID：391130
> 
> 赞同：68
> 
> 时间：2008-12-24T09:52:09.797
> 
> 标签：asp.net, httphandler, ihttphandler, ihttpasynchandler

什么是 ASP.NET 中的 HttpHandler？为什么以及如何使用它？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-12-24T10:35:09.833

用最简单的术语来说，ASP.NET HttpHandler 是一个实现`System.Web.IHttpHandler`接口的类。

ASP.NET HTTPHandlers 负责拦截对您的 ASP.NET Web 应用程序服务器发出的请求。它们作为进程运行以响应对 ASP.NET 站点的请求。最常见的处理程序是处理 .aspx 文件的 ASP.NET 页面处理程序。当用户请求 .aspx 文件时，该请求由页面通过页面处理程序进行处理。

ASP.NET 提供了一些**默认的 HTTP 处理程序**：

*   页面处理程序 (.aspx)：处理网页
*   用户控制处理程序 (.ascx)：处理 Web 用户控制页面
*   Web Service Handler (.asmx)：处理 Web 服务页面
*   跟踪处理程序 (trace.axd)：处理跟踪功能

您可以创建自己的**自定义 HTTP 处理程序**，将自定义输出呈现给浏览器。例如，ASP.NET 中 HTTP 处理程序的典型场景是

*   交付动态创建的图像（例如图表）或调整大小的图片。
*   发出 RSS 格式的 XML 的 RSS 提要

您**实现**接口以`IHttpHandler`创建同步处理程序，并实现`IHttpAsyncHandler`接口以创建异步处理程序。接口要求您实现`ProcessRequest`方法和`IsReusable`属性。

该`ProcessRequest`方法处理发出的请求的实际处理，而布尔`IsReusable`属性指定您的处理程序是否可以合并以供重用（以提高性能），或者每个请求是否需要一个新的处理程序。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-24T09:56:52.173

`HttpHandler`（或`IHttpHandler`）基本上是负责提供内容的任何东西。ASP.NET 页面 (aspx) 是一种处理程序。

您可以自己编写，例如，从数据库而不是 Web 服务器本身提供图像等，或者编写一个简单的 POX 服务（而不是 SOAP/WCF/等）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-10T05:12:51.827

**HttpHandler 示例，**

ASP.NET 2.0 中的 HTTP 处理程序

处理程序负责完成来自浏览器的请求。浏览器管理的请求要么通过文件扩展名处理，要么通过直接调用处理程序来处理。用于服务传入 Http 请求的低级请求和响应 API 是 Asp.Net 中的 Http 处理程序。所有处理程序都实现 IHttpHandler 接口，该接口位于 System.Web 命名空间中。处理程序有点类似于 Internet 服务器应用程序编程接口 (ISAPI) 扩展。

您实现 IHttpHandler 接口以创建同步处理程序，并实现 IHttpAsyncHandler 接口以创建异步处理程序。这些接口要求您实现 ProcessRequest 方法和 IsReusable 属性。ProcessRequest 方法处理发出的请求的实际处理，而 Boolean IsReusable 属性指定您的处理程序是否可以合并以重用以提高性能，或者每个请求是否需要一个新的处理程序。

.ashx 文件扩展名是为自定义处理程序保留的。如果您创建一个文件扩展名为 .ashx 的自定义处理程序，它将自动在 IIS 和 ASP.NET 中注册。如果您选择使用备用文件扩展名，则必须在 IIS 和 ASP.NET 中注册该扩展名。使用 .ashx 以外的扩展名的优点是您可以将多个文件扩展名分配给一个处理程序。

**配置 HTTP 处理程序**

配置节处理程序负责将传入的 URL 映射到 IHttpHandler 或 IHttpHandlerFactory 类。它可以在计算机、站点或应用程序级别声明。子目录继承这些设置。管理员使用标签指令来配置该部分。指令以自上而下的顺序进行解释和处理。对节处理程序使用以下语法：

**创建 HTTP 处理程序**

要创建 HTTP 处理程序，您必须实现 IHttpHandler 接口。IHttpHandler 接口有一个方法和一个属性，签名如下： void ProcessRequest(HttpContext); 布尔 IsReusable {get;}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-25T05:44:47.273

任何实现`System.Web.IHttpHandler`接口的类都变成`HttpHandler`. 并且此类作为进程运行以响应对 ASP.NET 站点的请求。

最常见的处理程序是处理 .aspx 文件的 ASP.NET 页面处理程序。当用户请求一个 .aspx 文件时，请求由页面通过页面处理程序（实现`System.Web.IHttpHandler`接口的类）进行处理。

您可以创建自己的自定义 HTTP 处理程序，将自定义输出呈现给浏览器。

一些 ASP.NET 默认处理程序是：

1.  页面处理程序 (.aspx) – 处理网页
2.  用户控制处理程序 (.ascx) – 处理 Web 用户控制页面
3.  Web 服务处理程序 (.asmx) – 处理 Web 服务页面
4.  跟踪处理程序 (trace.axd) – 处理跟踪功能

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-15T02:04:22.670

ASP.NET HTTP 处理程序是响应对 ASP.NET Web 应用程序发出的请求而运行的进程（通常称为“端点”）。最常见的处理程序是处理 .aspx 文件的 ASP.NET 页面处理程序。当用户请求 .aspx 文件时，该请求由页面通过页面处理程序进行处理。您可以创建自己的 HTTP 处理程序，将自定义输出呈现给浏览器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-07T04:40:38.267

处理程序是响应对 ASP.NET Web 应用程序发出的请求而运行的`ASP.NET HTTP`进程（通常称为“端点”）。最常见的处理程序是处理 .aspx 文件的 ASP.NET 页面处理程序。当用户请求 时`.aspx file`，请求由页面通过页面处理程序处理。

ASP.NET 页面处理程序只是一种处理程序。ASP.NET 附带几个其他内置处理程序，例如`.asmx files`.

当您需要可以在应用程序中使用文件扩展名识别的特殊处理时，您可以创建自定义 HTTP 处理程序。例如，以下场景可以很好地使用自定义 HTTP 处理程序：

**RSS 提要** 要为站点创建 RSS 提要，您可以创建一个发出 RSS 格式的 XML 的处理程序。然后，您可以将应用程序中的 .rss 扩展名（例如）绑定到自定义处理程序。当用户向您的站点发送以 .rss 结尾的请求时，ASP.NET 将调用您的处理程序来处理该请求。

**图像服务器** 如果您希望您的 Web 应用程序提供各种尺寸的图像，您可以编写一个自定义处理程序来调整图像大小，然后将它们作为处理程序的响应发送回用户。

HTTP 处理程序可以访问应用程序上下文，包括请求用户的身份（如果已知）、应用程序状态和会话信息。当请求 HTTP 处理程序时，ASP.NET 调用*`ProcessRequest`*相应处理程序上的方法。处理程序的`ProcessRequest`方法创建一个响应，该响应被发送回请求浏览器。与任何页面请求一样，响应会通过任何订阅了在处理程序运行后发生的事件的 HTTP 模块。

# c# - 压力测试 Web 服务 - 最佳方法

> ID：391133
> 
> 赞同：1
> 
> 时间：2008-12-24T09:55:12.317
> 
> 标签：c#, web-services, automated-tests, stress-testing

我有几个 Web 服务需要为它们创建一些测试机制并将其用作压力测试的工具。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T09:59:52.730

为此目的使用工具，例如[The Grinder](http://grinder.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T18:03:07.757

[JMeter](http://jakarta.apache.org/jmeter/)也是一个很好的解决方案，[SoapUI也是如此](http://www.soapui.org/)

我更喜欢 SoapUI，因为您可以通过创建测试用例获得额外的功能。

# php - PHP SQL Server 字符不一致

> ID：391137
> 
> 赞同：2
> 
> 时间：2008-12-24T09:57:01.783
> 
> 标签：php, sql-server

当我尝试使用 PHP 插入非拉丁字符（例如，使用 N'string to insert' 的希伯来语、阿拉伯语等）时，发生了一件非常奇怪的事情。我尝试过的所有扩展都会发生这种情况：mssql、odbc 和本机驱动程序。

通过 PHP 代码插入时，只有在通过 PHP 选择时它才能正常工作，并且我可以读取我插入的内容。在查询分析器中，字符串看起来很乱，C++ 代码也收到乱码。

通过查询分析器插入时，它在分析器和 C++ 代码中看起来不错，但是当使用 PHP 选择它时，我得到的是问号而不是字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T10:04:47.243

您没有正确控制连接排序规则。通过在开始处理数据之前发送正确的查询或在配置文件中更改它来设置它（我假设您使用的排序规则是 UTF 的一种形式）。

我不确定是否将相同的转换为 MsSQL，但在 MySQL 中，查询是：

```
SET NAMES 'utf8';
SET CHARACTER SET 'utf8'; 
```

并且有匹配的配置属性可以永久设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T13:44:58.977

这可能是由于以下两个问题之一：您的数据库/表/列正在使用您尝试插入的字符未知的字符集。在您的情况下，我建议使用 UTF-8（除非您主要使用非拉丁字符，否则 UTF-16 将是首选）。如果您绝对确定您的数据库能够存储这些字符，则也可能是连接设置不正确（可以将数据库连接设置为使用与数据库使用的字符集不同的字符集）。

另一个问题是 PHP 不支持 Unicode。因此，如果您尝试插入的字符嵌入在 PHP 源文件中，或者如果您在执行查询之前对查询应用字符串函数，那么 PHP 很可能已经损坏了原始字符串。幸运的是，PHP 有各种支持 Unicode 字符的函数，所以你也许可以使用它们。你可以在这里找到其中的一些：

[http://php.net/manual/en/refs.international.php](http://php.net/manual/en/refs.international.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-31T20:06:12.270

我们还尝试了所有可用的方法，并找到了两种处理 NVARCHAR 字段中的 unicode 数据的可行解决方案。不幸的是，[PHP 的 SQL Server 驱动程序](http://www.microsoft.com/sqlserver/2005/en/us/php-driver.aspx)仍然存在一些错误，并且确实很难使用，因为您必须从 UTF-16LE 手动转换类似 NVARCHAR 的字段。Zend Framework 1.9.0 中有支持，但我还没看过。

目前，从 PHP 访问 SQL Server 的最佳方式似乎是使用 COM 和 OLEDB：

```
$conn = new COM('ADODB.Connection', null, 65001);
$conn->Open('Provider=SQLNCLI;Server=SERVER;Database=DB;Uid=USER;Pwd=PASS');
$rs = $conn->Execute('SELECT nvarcharfield FROM sometable');
while (!$rs->EOF) { 
    echo $rs->Fields('nvarcharfield')->value, "\n";
    $rs->MoveNext();
} 
$rs->Close(); 
```

“65001”表示该组件应该在 UTF-8 模式下工作，这可能是您想要的。所以所有进出的数据都将采用 UTF-8 编码。

如果准备好的查询不是使用 COM 编程的那么复杂，那就太好了，所以您可能想看看 ADOdb for PHP。然后代码变得略有不同：

```
$conn = NewADOConnection('ado_mssql');
$conn->charPage = 65001;
$conn->Connect('Provider=SQLNCLI;Server=SERVER;Database=DB;Uid=USER;Pwd=PASS');
$conn->SetFetchMode('ADODB_FETCH_ASSOC');
$rs = $conn->Execute('SELECT nvarcharfield FROM sometable');
while (!$rs->EOF) { 
    echo $rs->fields['nvarcharfield'], "\n";
    $rs->MoveNext();
} 
$rs->Close(); 
```

使用 ADOdb，ADOdb 中的准备好的查询更容易编写和理解。

如果您有来自 SQL Server 2008 的新 SQL Native Client，您可能希望将提供程序“SQLNCLI”替换为“SQLNCLI10”。

一旦我获得一些声誉，我将添加内联链接（新用户只允许一个超链接）。

```
http://devzone.zend.com/article/4906-Zend-Framework-1.9.0-Released
http://msdn.microsoft.com/de-de/library/system.data.oledb.oledbcommand.prepare.aspx
http://adodb.sourceforge.net/
http://phplens.com/lens/adodb/docs-adodb.htm#prepare 
```

# asp.net - ASP.NET 广告网站

> ID：391139
> 
> 赞同：3
> 
> 时间：2008-12-24T09:57:56.663
> 
> 标签：asp.net, html, css

我目前正在开发一个网站，该网站是企业的广告门户。广告商可以创建一个帐户，选择各种列表选项（状态、护理等）并上传以“单位”的倍数衡量的图形。“单元”是`180px`宽而`120`高的图像或闪存文件。广告客户可以选择水平或垂直的多个单元，即水平对齐的2个单个单元或垂直对齐的2个单个单元。

我已经到了网站运行良好的地步。我被困在一个地方，我要布置“单元”并正确显示它们，它们之间没有任何空白空间。例如，如果我们有 4 个广告，一个水平 2 单元广告，一个垂直 2 单元和 2 个单单元广告，像这样 -

```
 |
                  |
   2 unit ad      |   2 
------------------|  unit 
        |         |   ad
1 unit  | 1 unit  | 
        |         |
        |         | 
```

我目前正在将广告单元存储在数据库中，其中包含在 Web 表单中用于构建表的属性（即 colspan、rowspan 等）。我不确定这是否是正确的方法，我担心不是。如果我得到一些建议，我将不胜感激。

谢谢，印地

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T09:25:52.473

恕我直言，表格非常适合这项工作，因为广告具有相同的行跨度和列跨度行为。如果您有生成正确表格的方法，请坚持使用。

此外，当我为布局创建 HTML 表格并且我不希望单元格之间有空格时，我包含了*cellspacing="0"*和*cellpadding="0"*属性，就像 Leah 提到的那样。

```
<table cellspacing="0" cellpadding="0" border="0"> 
```

额外的表格技巧：
要获得 HTML 表格单元格之间的单个像素边框，请使用

```
table 
{ 
    border-collapse: collapse; 
} 
```

CSS 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T06:37:02.580

所以问题是单元之间有空白空间？您的表格是否包含 cellspacing="0" 和 cellpadding="0"？

IE

```
<table cellspacing="0" cellpadding="0"> 
```

不确定如何存储具有属性的单位。分离数据和界面描述意味着您有更多的灵活性和能力来应对 UI 更改请求。如果每种类型的单元的属性相同，则可能存储了大量重复的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T10:56:31.477

你有没有看过任何 TreeMap 控件？其中大多数将是商业产品，但可能会有开源产品。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T07:02:07.537

这是一个艰难的。如果您想使用 div 和 css，您可以尝试浮动广告。唯一的问题是您不能以任意顺序渲染 div，因为它们不会总是尝试占用可用空间。但是，如果您使用的是表格，情况也是如此。

```
<html>
<head>
    <style>
        div.adcontainer {
            margin: 0px; width: 540px;
        }
        div.ad {
            float: right; margin: 0; padding: 0; width: 180px;
            height: 120px; background: #DDD;
        }
        div.adhorz {
            width: 360px; height: 120px;
        }
        div.advert {
            width: 180px; height: 240px;
        }
    </style>
</head>
<body>
    <div class="adcontainer">
        <div class="ad advert">ad v</div>
        <div class="ad adhorz">ad h</div>
        <div class="ad">ad 1</div>
        <div class="ad">ad 2</div>
    </div>
</body>
</html> 
```

# .net - 如何获取 WCF 远程端点的 IP 地址？

> ID：391142
> 
> 赞同：25
> 
> 时间：2008-12-24T09:58:27.367
> 
> 标签：.net, wcf, wcf-binding

有没有办法获取 WCF 连接的远程 IP 地址？

我猜它没有内置到 WCF 框架中的原因是 WCF 可以使用非 TCP/IP 绑定，因此 IP 地址并不总是有意义的。

然而，这些信息对于所有广泛使用的绑定都是有意义的（据我所知：BasicHttp、DualHttp、WSHttp 和 NetTcp）。

IP 地址可能可以使用反射访问，但我宁愿找到一种记录的方式来获取它，而不是侵入框架类。

我已经用谷歌搜索了这个问题，似乎很多人在没有找到合适的解决方案的情况下遇到了它（通常的答案是[依赖消息头](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/d6de4e3b-cbe1-4e7f-993f-573f57b0905f/)，但这意味着信任客户端提供其真实的 IP 地址，这如果您出于安全原因要记录 IP 地址，则不是一个选项）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-24T10:54:08.440

显然它已通过[RemoteEndpointMessageProperty](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.remoteendpointmessageproperty.aspx)在 3.5 中添加；看[这里](http://www.keyvan.ms/detect-client-ip-in-wcf-3-5)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-29T14:06:37.027

```
OperationContext context = OperationContext.Current;
MessageProperties properties = context.IncomingMessageProperties;
RemoteEndpointMessageProperty endpoint = properties[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;
string address = endpoint.Address; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T10:02:08.777

如果您在服务端并想要获取客户端 IP，则必须检查 OperationContext 的消息属性。例如看[这里](http://blogs.msdn.com/phenning/archive/2007/08/08/remoteendpointmessageproperty-in-wcf-net-3-5.aspx)或[这里](http://nayyeri.net/blog/detect-client-ip-in-wcf-3-5/)

# javascript - Javascript 警报中的文本颜色

> ID：391143
> 
> 赞同：6
> 
> 时间：2008-12-24T09:58:53.323
> 
> 标签：javascript, css, alerts

有没有办法改变文本的样式，在 Javascript 警报框中格式化文本。例如改变它的颜色，使它变粗，等等？

此外，如果有一个带有“是”、“否”按钮而不是“确定”/“取消”按钮的警报？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-24T10:04:41.330

**不**，恐怕这是不可能的。

使用 JavaScript，您只能使用 3 个弹出框`alert`：`prompt`和`confirm`.

如果你想制作一个更有特色的弹出窗口，你应该尝试使用许多用 JavaScript 编写的，它们是从 JavaScript 库构建的，比如[这个](http://dev.iceburg.net/jquery/jqModal/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-09T01:47:13.403

您可以为格式化做的最好的事情是换行符`\n`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T11:05:18.463

您不能以这种方式操作标准警报对话框，但您可以制作自己的对话框并设置您喜欢的样式。

查看[slayeroffice.com](http://slayeroffice.com/code/custom_alert/)上的自定义对话框教程，了解如何完成此操作的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T02:29:18.233

[http://prototype-window.xilinus.com/](http://prototype-window.xilinus.com/)这是你的人...运行在原型之上，并有 AJAX、拖放和很多东西等着你 =)

# .net - .NET BCL 中是否有任何现成的 Json 序列化帮助程序类？

> ID：391157
> 
> 赞同：18
> 
> 时间：2008-12-24T10:04:41.127
> 
> 标签：.net, json, serialization

我需要将一些对象序列化/反序列化到字符串中/从字符串中序列化，并将它们作为不透明数据传输。我可以使用 XmlSerializer 来做到这一点，但生成的字符串看起来笨拙而冗长。那么，.NET 中是否有任何简洁的序列化器可用？

我首先想到的是，也许 .NET 应该有 JSON 序列化器，但我找不到它。.NET 中是否有任何现成的方法可以将对象转换为简明字符串/从简明字符串转换？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-24T10:40:57.763

那里有两个;

*   3.5 中的[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)
*   3.5 SP1 中的[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)

在传统方式中，它们不是 100% 相互兼容的，尤其是 re `DateTime`; DCJS 使用 (IIRC) 文字字符串；JSS 使用`new`- 并且两者都不能正确读取 t'other。

当然，如果文本不透明，你也可以使用任何简洁的二进制序列化器，并简单地进行 base-64 编码；例如，[protobuf-net](http://code.google.com/p/protobuf-net/)非常简洁。但是使用 JSON 可以最大限度地减少每一端所需的外部代码，因此可能是您最好的选择。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-24T10:19:38.540

[Json.Net](http://james.newtonking.com/pages/json-net.aspx)是一个用于 .NET 的 JSON 库。它在 CodePlex 中可用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-19T05:05:03.497

我有一个**非常快速**的开源[JsonSerializer](http://www.servicestack.net/mythz_blog/?p=344)可用，它可以序列化任何 POCO 或 DataContract 类型，包括接口匿名和后期绑定类型等。

基本示例

```
var customer = new Customer { Name="Joe Bloggs", Age=31 };
var json = JsonSerializer.SerializeToString(customer);
var fromJson = JsonSerializer.DeserializeFromString<Customer>(json); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T10:06:16.350

[LINQ To Json](http://james.newtonking.com/projects/json/help/index.html?topic=html/LINQtoJSON.htm)可以序列化和反序列化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T12:16:01.567

只需使用您自己的 api .. 它很容易创建 json .. 但您也可以使用 JSON 库，如 JSON.NET ..

快乐编码

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T18:19:53.663

[JsonFx.NET](http://jsonfx.net/download/#json)有一个开源序列化程序，它允许序列化到/从强类型类，这可能是您正在寻找的。您可以控制日期的序列化方式并覆盖序列化的许多方面。它甚至通过支持匿名对象的序列化与 Linq 很好地交互。API 的工作方式与 .NET XML 序列化类似。

# asp.net - 首次加载时的设置页面

> ID：391194
> 
> 赞同：3
> 
> 时间：2008-12-24T10:22:58.703
> 
> 标签：asp.net, authentication, installation

我有一个将使用 Active Directory 进行身份验证的应用程序。这将用于 mnay 位置，所以我希望用户能够将他们的 AD 域输入到设置文件中。所以，他们第一次运行这个应用程序时，他们将无法登录，因为他们没有输入AD域名，所以我想做的就是检查web.config是否有ADName那里的值，如果没有，将它们转发到设置页面，如果有，则应要求它们进行身份验证，然后转发到索引页面。这可能吗？

特别是我需要知道的是最好的方法，因此如果 ADName 值为空，则设置页面不需要身份验证，但如果不是，则需要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T11:02:10.903

是的，在您的 web.config 中添加一个键/值对。您的键将是一个静态名称，例如“ADNAME”，值将是 csv 格式。

如果已登录的用户输入值，则将他重定向到身份验证事物。

您可以通过 configurationmanager.appsettings["adname"].tostring()... 访问 value 字段...确保您已导入 systems.configuration。

我会建议您将用户和广告名的映射存储在 db 中。如果存储在配置文件中，请确保对文件进行加密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T22:13:44.087

这是绝对可能的。使用 global.asax 中的 Session_OnStart 检查是否已使用与 AD 用户名相关的唯一 ID 设置了用户信息。如果没有，请从那里重定向，如果是，请继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T20:46:11.787

可以将 AD 信息存储在配置文件属性中的解决方案，如果您不想处理数据库，则可以使用配置文件提供程序的文本文件版本。

# php - php：通过变量调用静态类

> ID：391195
> 
> 赞同：6
> 
> 时间：2008-12-24T10:23:25.600
> 
> 标签：php

有没有办法按名称调用静态类/方法？

例子：

```
$name = 'StaticClass';
($name)::foo(); 
```

我有我保留所有静态方法的类，我想这样称呼它们。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-24T10:39:35.660

```
$name::foo() 
```

从 PHP5.3 开始是可能的。在早期版本中，您必须使用

```
call_user_func(array($classname,$methodname)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-24T10:37:12.420

您可以使用[call_user_func](http://php.net/call_user_func)函数执行类似的操作

它看起来像下面这样

```
$name = 'staticClass';
call_user_func(array($name, 'foo')); 
```

希望这可以帮助

# sql-server-2005 - 如何在 SSIS 中动态检测文件名？

> ID：391199
> 
> 赞同：2
> 
> 时间：2008-12-24T10:26:35.780
> 
> 标签：sql-server-2005, ssis

我需要使用 MS SSIS 将平面文件转换为 DB。我需要一种方法来查看特定文件夹以获取（唯一）平面文件，文件名的格式为“FileName-CCYYMMDD.txt”。

如果有办法从文件夹中添加文件或获取格式为“Filename-CCYYMMDD.txt”的文件名，请帮助我，其中 CCYYMMDD 是当前日期，或者根据要求可能是 CurrentDate -1。

任何代码示例或屏幕截图将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T08:32:50.033

要动态获取连接，您需要在平面文件的 ConnectionString 属性上使用表达式

例如，要获取“D:\CC080226.txt”，您可以使用以下表达式。

"D:\CC"
+ RIGHT((DT_WSTR,4)YEAR(GETDATE()),2) + (DT_WSTR,2)MONTH(GETDATE()) + (DT_WSTR,2)DAY(GETDATE()) + "。 TXT”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-09T18:43:35.713

在数据流中，右键单击平面文件源>显示高级编辑器>组件属性。在自定义属性下，指定 FileNameColumnName 属性的名称。这会将文件路径和名称添加到输出列集合中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T11:51:35.873

将文件名放入变量中，可能通过连接，并使用表达式设置变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T15:30:19.473

抱歉，我很着急，这是脚本的快照，希望对您有所帮助。

此包正在扫描文件夹以查找符合您的规范的文件，然后将控制权传递给数据流。

[替代文字 http://img395.imageshack.us/img395/8531/dynafilecontrolflowms9.jpg](http://img395.imageshack.us/img395/8531/dynafilecontrolflowms9.jpg)

控制流， http: [//img395.imageshack.us/img395/8531/dynafilecontrolflowms9.jpg](http://img395.imageshack.us/img395/8531/dynafilecontrolflowms9.jpg)

[替代文字 http://img104.imageshack.us/img104/2010/dynafileforeachij5.jpg](http://img104.imageshack.us/img104/2010/dynafileforeachij5.jpg)

对于每个循环属性， http: [//img104.imageshack.us/img104/2010/dynafileforeachij5.jpg](http://img104.imageshack.us/img104/2010/dynafileforeachij5.jpg)

[替代文字 http://img164.imageshack.us/img164/7614/dynafilefilesystemyj1.jpg](http://img164.imageshack.us/img164/7614/dynafilefilesystemyj1.jpg)

文件系统属性， http: [//img164.imageshack.us/img164/7614/dynafilefilesystemyj1.jpg](http://img164.imageshack.us/img164/7614/dynafilefilesystemyj1.jpg)

```
Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Runtime
Imports System.IO

Public Class ScriptMain

    Public Sub Main()
        Dim Ext As String = ".txt"
        Dim Path As String = ".\" 'must get from package variable to be more dynamic
        Dim FileNames() As String = Directory.GetFiles(Path, "CC*" + Ext, SearchOption.TopDirectoryOnly)
        Dim ValidFileNames As New Collection
        For Each FileName As String In FileNames
            Dim FileDate As String = FileName.Substring(Len(Path) + 2) 'first 2 letter is already "CC"
            If Not IsYmd(FileDate.Substring(0, Len(FileDate) - Len(Ext))) Then Continue For
            ValidFileNames.Add(FileName)
        Next
        Dts.Variables("FileNames").Value = ValidFileNames
        Dts.TaskResult = Dts.Results.Success
    End Sub

    Private Function IsYmd(ByVal Test As String) As Boolean
        If Len(Test) <> 6 Then Return False
        Dim Year As String = Left(Test, 2)
        Try
            If CStr(2000 + CInt(Year)) <> "20" + Year Then Return False
        Catch ex As Exception
            Return False
        End Try
        Dim Month As String = Mid(Test, 3, 2)
        Try
            If CInt(Month) < 1 Then Return False
            If CInt(Month) > 12 Then Return False
        Catch ex As Exception
            Return False
        End Try
        Dim Day As String = Right(Test, 2)
        Dim FirstOfMonth As String = "20" + Year + "/" + Month + "/01"
        Dim EndOfMonth As Integer = DateAndTime.Day(DateAndTime.DateAdd(DateInterval.Day, -1, _
            DateAndTime.DateAdd(DateInterval.Month, 1, CDate(FirstOfMonth))))
        Try
            If CInt(Day) < 1 Then Return False
            If CInt(Day) > EndOfMonth Then Return False
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

End Class 
```

# sql-server - 是否可以以编程方式区分 SQL Server 的版本？

> ID：391200
> 
> 赞同：3
> 
> 时间：2008-12-24T10:26:44.033
> 
> 标签：sql-server

基本上，是否可以确定是否有人将我的程序连接到 SQL Server Compact 或 Express Edition？我希望能够将我的产品的不同版本限制为不同版本的 SQL Server。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T10:37:03.217

连接到数据库后，您始终可以运行 T-Sql：

```
SELECT SERVERPROPERTY ('edition') 
```

这应该给你不同的版本

其他有用的信息可能来自：

```
SELECT SERVERPROPERTY('productversion'), SERVERPROPERTY ('productlevel') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T10:32:59.963

运行此 SQL 语句

```
SELECT @@VERSION 
```

它会给你一个 ReultSet （一列作为字符串），版本如下

> Microsoft SQL Server 2000 - 8.00.760（Intel X86）2002 年 12 月 17 日 14:22:05 版权所有 (c) 1988-2003 Microsoft Corporation Standard Edition on Windows NT 5.0（Build 2195：Service Pack 4）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T10:58:05.107

[**Microsoft 知识库文章 KB321185**](http://support.microsoft.com/kb/321185)描述了如何识别您当前的 Microsoft SQL Server 版本号和相应的产品或服务包级别。

如果您使用的是 Microsoft SQL Server 2000 或 Microsoft SQL Server 7.0，它还描述了如何识别特定版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T10:37:06.943

还有 SERVERPROPERTY 函数可以为您提供“版本”之类的内容：

```
SELECT SERVERPROPERTY ('edition') 
```

# windbg - 在WinDbg中显示共享内存部分的内容？

> ID：391208
> 
> 赞同：2
> 
> 时间：2008-12-24T10:34:16.777
> 
> 标签：windbg

我有几个使用命名内存部分进行通信的程序。有什么方法可以在用户模式或内核模式下从 WinDBG 查看此共享内存部分的内容？我没有指向它的指针，但我知道它的名字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-10T02:06:13.700

只是试图在我们的共享内存上执行此操作而没有得到您想要的，但我在这里为后代做笔记：

*   我找不到从名称中获取句柄的简单方法，但是如果您执行“！handle 0 f”然后搜索输出，您可以看到内核对象的名称及其句柄ID：从此获取句柄.
*   显然，共享内存内核对象中没有特定于进程的地址，但是 .call /s KnownFuncWithSamePrototype MapViewOfFileEx 确实返回了看起来像有效指针的东西

'.call' 需要完整的符号才能工作，但 MapViewOfFile(Ex) 没有，我碰巧找到了一个函数，它返回一个指针并在我们的代码中使用六个参数，所以我不必重新编译让它工作（这就是 KnownFuncWithSamePrototype 上面的意思）。我不确定这是否适合您。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T15:50:48.760

使用用户模式调试器......您是否可以编写一个非常简单的测试应用程序来获取对命名内存部分的访问（即调用 OpenFileMapping 然后 MapViewOfFile），然后在调试器下运行该应用程序？您应该能够跳过调用以访问该部分，然后检查该应用程序对该部分的视图。

（如果有帮助，[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/aa366551(VS.85).aspx)上的“第二进程”标题提供了示例代码，供进程访问命名的共享内存部分并将其映射到其地址空间。）

我通常喜欢编写小型测试工具来帮助调试这样的事情......如果你想让事情变得更容易，你甚至可以编写测试工具来自动中断任何附加的调试器（使用像 DebugBreak 这样的函数） .

# c# - 如何用双显示器应用程序解决这个焦点问题？

> ID：391224
> 
> 赞同：2
> 
> 时间：2008-12-24T10:44:32.453
> 
> 标签：c#, .net, windows, winforms, multiple-monitors

我们有一个使用双显示器设置的应用程序 - 用户 A 将使用显示器 1，而用户 B 将同时使用显示器 2。监视器 2 是触摸屏设备。

现在的问题是，当用户 A 在他的屏幕上键入内容时，如果用户 B 尝试做某事，用户 A 最终会失去其窗口的焦点，这是灾难性的。

即使用户 B 对监视器 2 执行某些操作，什么可能是一个很好的解决方案来保持监视器 1 中窗口的焦点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T14:21:31.483

可以用一些肘部润滑脂。将此代码粘贴到您在触摸屏上显示的表单中：

```
protected override CreateParams CreateParams {
  get {
    const int WS_EX_NOACTIVATE = 0x08000000;
    CreateParams param = base.CreateParams;
    param.ExStyle |= WS_EX_NOACTIVATE;
    return param;
  }
} 
```

这样可以确保表单不会从主表单中窃取焦点。让它看起来像这样：

```
 public partial class Form1 : Form {
    public Form1() {
      InitializeComponent();
      Thread t = new Thread(SecondMonitor);
      t.IsBackground = true;
      t.SetApartmentState(ApartmentState.STA);
      t.Start();
    }
    private void SecondMonitor() {
      Form2 f2 = new Form2();
      f2.StartPosition = FormStartPosition.Manual;
      f2.Left = 800;   // Use Screen class here...
      f2.ShowDialog();
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T10:48:52.927

对我来说，听起来您可能想要两台 PC ......或者可能在 PC 上托管一个 VM，并通过 USB 视频“卡”（不太正确的术语）让 VM 访问第二个显示器。大多数现代 VM 允许 USB 传输。

大多数情况下，多头显示器要么用于为单个用户提供大量屏幕空间，要么用作仅显示设施（例如，在大型基础设施设置上显示实时网络/服务器统计信息）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T11:00:58.643

我看不到允许两个用户同时访问同一个桌面环境而不会遇到焦点问题的方法。如果您考虑一下，允许两个应用程序（或者在这种情况下，一个具有两个用户“区域”的应用程序总是有问题的，因为应用程序需要尝试跟踪哪个输入设备最近与哪个区域的哪个区域一起工作。屏幕。

您*也许*可以添加功能来过滤每个设备的输入并将每个不同的输入发送到一组单独的控件，但我想这将需要一些驱动程序级别的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T12:36:15.487

我从来没有使用过触摸屏，但我倾向于认为它们在某种程度上就像鼠标一样工作。因此，如果这是真的，我认为您可以使用 Windows 挂钩来捕获事件。如果事件来自键盘（我假设是单一的），请将其定向到您的第一个窗口。如果事件来自鼠标，请检查它的坐标（或者可能是设备 ID，如果有的话，我不知道）。如果它在您的第一个窗口内，请直接输入。如果它在第二个屏幕中，直接输入到您的第二个窗口。

如果屏幕不像鼠标，我想你会找到另一种方法来为它挂上钩子。

我不知道这是否可行。这只是一个概念性的想法。

**编辑：**当然，您需要确定哪个应用程序应该在第一个屏幕上接收消息。我想 Z-order 会有所帮助，除非用户打开一些顶级应用程序。跟踪 OnFocus 消息（或类似消息）以跟踪哪个应用程序获得焦点（不包括您的其他应用程序）可能会更好。

（非常欢迎评论解释这种方法的任何缺陷！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T17:00:00.383

你能不造假吗？有一个窗口可以跨越两个监视器并充当您正在使用的窗口的容器吗？

# ruby - 如何将 Perl 的 Convert::ASN1 转换为 Ruby 代码？

> ID：391227
> 
> 赞同：1
> 
> 时间：2008-12-24T10:45:11.843
> 
> 标签：ruby, perl, openssl, asn.1, nss

有人可以告诉我这段代码的作用以及如何以最简单的方式将其转换为 Ruby 吗？

```
 #!perl

    use Convert::ASN1;

    my $asn1 = Convert::ASN1->new(encoding => 'DER');
    $asn1->prepare(q<
        Algorithm ::= SEQUENCE {
            oid OBJECT IDENTIFIER,
            opt ANY OPTIONAL
        }
        Signature ::= SEQUENCE {
            alg Algorithm,
            sig BIT STRING
        }
    >);

   my $data = $asn1->encode(sig => $body,
        alg => {oid => sha512WithRSAEncryption()}); 
```

它是[mexumgen](http://www.softlights.net/projects/mexumgen/)的一部分，Perl 库为带有 openssl 的 Mozilla 产品签名 update.rdf。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T15:52:07.633

这个特定的例子可以转换为

```
data = ["308191300b06092a864886f70d01010d03818100" + body.unpack("H*")].pack("H*") 
```

其中“308191300b06092a864886f70d01010d03818100”是从该 ASN 表达式到 BIT STRING 字段（包括 BIT STRING 的大小）的前缀，pack("H") 将二进制数据转换为十六进制表示，unpack("H") 将十六进制的字符串转换回二进制.

But for more general ASN converter it's better to use OpenSSL::ASN1, which comes with ruby as standard library. It's completely undocumented but some people managed to [have some use of it](http://groups.google.com/group/comp.lang.ruby/browse_thread/thread/3f2ad30e1995e3e1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T10:55:14.973

你看过[Net::ASN1](http://rubyforge.org/projects/net-asn1/)吗？

# c#-2.0 - 如何使用多个数据源填充 GridView？

> ID：391232
> 
> 赞同：1
> 
> 时间：2008-12-24T10:49:52.877
> 
> 标签：c#-2.0

使用多个数据源填充相同的 GridView 即我需要使用多个数据源在 GridView 中填充数据。如果可能，请提供代码片段...

**更多详细信息：-** 具有相同架构的表存在于两个不同的数据库中。我需要从两者中获取数据并将其填充到一个 GirdView 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T11:03:45.313

也许您可以将来自每个数据源的数据组合成一个数据集，然后将该数据集指定为数据视图的源。但是，如果没有进一步的信息，很难推测可能的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-20T15:30:07.050

您可以使用两个 SqlDataAdapter 将您的结果集组合到一个 DataTable 中，以分别从两个数据库中填充 DataTable。这是一个例子。

```
 DataTable dt = new DataTable();
        using(SqlDataAdapter a1 = new SqlDataAdapter("SELECT * FROM [user1]", "Data Source=DBServer1;Initial Catalog=Database1;User ID=user;Password=***"))
        a1.Fill(dt);

        using(SqlDataAdapter a2 = new SqlDataAdapter("SELECT * FROM [user2]", "Data Source=DBServer2;Initial Catalog=Database2;User ID=user;Password=***"))
        a2.Fill(dt); 
```

a1.Fill(dt) 将初始化 DataTable 并填充它。a2.Fill(dt) 只是将行添加到另一个结果集中的 DataTable dt。此示例假定两个数据源具有相同的架构。如果没有，您必须准备数据表以容纳两个结果集。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T10:52:39.423

您是否希望使用这两个数据源来填充数据网格以提供相同类型的对象或相关对象？如果你能提供一些额外的细节，那就太好了。

# python - pyGTK 单选按钮

> ID：391237
> 
> 赞同：1
> 
> 时间：2008-12-24T10:54:03.463
> 
> 标签：python, gtk, pygtk

*好吧，我会以我是 GTK和*Python 新手的事实作为开头，但我无法挖掘出我需要的信息。基本上我拥有的是一个单选按钮列表，根据选中的单选按钮，我需要将一个按钮连接到不同的功能。我尝试创建我所有的单选按钮，然后`sget_active()`在每个按钮上创建一个令人作呕的 if/else 块检查。问题是同一个按钮每次都返回 true。有任何想法吗？

这是正在使用的代码：

```
 #Radio Buttons Center
    self.updatePostRadioVBox = gtk.VBox(False, 0)
    self.updatePageRadio = gtk.RadioButton(None, "Updating Page")
    self.updatePostRadio = gtk.RadioButton(self.updatePageRadio, "Updating Blog Post")
    self.pageRadio = gtk.RadioButton(self.updatePageRadio, "New Page")
    self.blogRadio = gtk.RadioButton(self.updatePageRadio, "New Blog Post")
    self.addSpaceRadio = gtk.RadioButton(self.updatePageRadio, "Add New Space")
    self.removePageRadio = gtk.RadioButton(self.updatePageRadio, "Remove Page")
    self.removePostRadio = gtk.RadioButton(self.updatePageRadio, "Remove Blog Post")
    self.removeSpaceRadio = gtk.RadioButton(self.updatePageRadio, "Remove Space")

    #Now the buttons to direct us from here
    self.returnMainMenuButton = gtk.Button(" Main Menu ")
    self.returnMainMenuButton.connect("clicked", self.transToMain)
    self.contentManageHBoxBottom.pack_start(self.returnMainMenuButton, False, False, 30)
    self.contentProceedButton = gtk.Button("    Proceed    ")
    self.contentManageHBoxBottom.pack_end(self.contentProceedButton, False, False, 30)

    if self.updatePageRadio.get_active():
        self.contentProceedButton.connect("clicked", self.updatePage)

    elif self.updatePostRadio.get_active():
        self.contentProceedButton.connect("clicked", self.updatePost)

    elif self.pageRadio.get_active():
        self.contentProceedButton.connect("clicked", self.newPage)

    elif self.blogRadio.get_active():
        self.contentProceedButton.connect("clicked", self.newBlogPost)

    elif self.addSpaceRadio.get_active():
        self.contentProceedButton.connect("clicked", self.newSpace)

    elif self.removePageRadio.get_active():
        self.contentProceedButton.connect("clicked", self.removePage)

    elif self.removePostRadio.get_active():
        self.contentProceedButton.connect("clicked", self.removeBlogPost)

    elif self.removeSpaceRadio.get_active():
        self.contentProceedButton.connect("clicked", self.removeSpace) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-24T11:32:24.617

编辑：（因为您发布了一些代码），只需使用：

```
active = [r for r in self.updatePageRadio.get_group() if r.get_active()][0] 
```

并使用它在函数字典中查找并调用它：

```
my_actions[active]() 
```

* * *

编辑：我完全忘了提到这对于 RadioButtons 来说根本不是一个好的用例，在我看来，常规的 gtk.Button 会好得多。

* * *

您的答案是使用 RadioButton“组”系统。[本文档对此](http://www.pygtk.org/docs/pygtk/class-gtkradiobutton.html)进行了解释，但这里是一个小的实际示例。

首先，一个组实际上只是一个 RadioButton 本身，用于收集许多其他 RadioButton。您指定一个组作为构造函数的第一个参数。

```
r1 = gtk.RadioButton(None, label='Cat') # this has no group, it is the first
r2 = gtk.RadioButton(r1, label='Mouse') # use the first radio
                                        # button as the group argument
r3 = gtk.RadioButton(r1, label='Dog')   # again use r1 
```

现在所有单选按钮都将同步。阅读它们的问题很简单：

```
active_radios = [r for r in r1.get_group() if r.get_active()] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T11:31:58.673

首先，我认为这是一个错字，您实际上是在代码中调用 get_active() 而不是 set_active()？除此之外，在没有看到代码的情况下，我可以为您指出有关[单选按钮的 pygtk 教程](http://www.pygtk.org/pygtk2tutorial/sec-RadioButtons.html)

# unit-testing - 对使用数据库的代码进行单元测试

> ID：391249
> 
> 赞同：44
> 
> 时间：2008-12-24T11:00:39.860
> 
> 标签：unit-testing

我很想知道人们在开发运行数据库的自动化单元测试时采用了什么方法

在运行测试套件之前，您是否安装了 QA 数据库（已知起点）。

或者

每当发生数据库调用时，您是否构建数据库存根？

编辑：相关问题，但不是重复的，尽管对于手头的问题非常重要：[我如何对持久性进行单元测试？](https://stackoverflow.com/questions/2046/how-do-i-unit-test-persistence)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-24T11:23:19.627

所代表的“数据库存根”通常被称为“假存储库”或“模拟存储库”。他们是个好主意。您可以手动编写它们（对于简单的情况并不难）或使用像 Rhino Mocks 这样的框架来生成它们。您没有提及您正在使用哪种语言。Rhino 模拟适用于 .Net 。

如果您使用模拟存储库，那么您可以针对处理数据的代码运行测试，而无需实际使用数据库来存储数据。这使得测试运行得非常快，这是一件好事。

当然，您仍然需要在某个阶段测试真正的存储库，这更是一个问题。这些测试会运行得更慢，因为它们使用的是真实的数据库。由于速度和依赖性问题，有些人会将其归类为“集成测试”而不是单元测试。

我不介意你这么称呼它们，但将这些测试分开是个好主意。

数据一致性的一个好主意是在测试之前开始一个数据库事务，然后将其回滚。这样数据库状态就会恢复到测试前的状态。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-24T11:27:55.297

如果您使用 NHibernate，您可以非常轻松地[针对内存中的 SQLite 数据库进行测试](http://ayende.com/Blog/archive/2006/10/14/UnitTestingWithNHibernateActiveRecord.aspx)，这**非常**快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T11:06:06.777

我们做了一些技巧：

编辑：我们每个用户都有单独的数据库。我们的 buildserver 也有它自己的数据库。额外硬盘的成本远低于开发人员影响彼此测试的成本。

1.  我们的应用程序可以自己生成表并执行升级步骤（没有单独的数据库脚本）。这对我们的客户很有帮助，因为他只需要放入一个 WAR 文件就可以了。应用程序查看数据库并在启动 Spring 上下文的其余部分之前执行所需的任何 DDL 语句。
2.  我们的测试套件有一些代码卸载 Spring 上下文，删除数据库，并使用干净的数据库重新启动上下文。如果我们愿意，我们可以选择关闭它
3.  我们所有的数据库/SQL 单元测试都是 Spring 事务集成测试。这意味着在测试完成后，事务会回滚，其他单元测试将再次查看干净的数据库。

除此之外，我们尝试尽可能多地进行模拟测试，因为单元测试实际上并不打算成为集成测试。因此，请尝试将您的服务层与 DAO 层分开。这也有助于您更轻松地发现问题，因为您隔离了所有内容。

在某些时候，我确实相信您需要访问数据库，因为它不是我们生活的理想/学术世界:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-24T14:26:27.403

实际上，您应该两者都做。当您说“构建数据库存根”时，这暗示了在单元测试中进行模拟。当您谈论“安装 QA 数据库（已知起点）”时，这暗示了您实际访问数据库的集成测试。单元测试在游戏中出现得更早，并且是模拟发挥作用的地方。模拟比实际访问数据库要快得多。所以当你运行许多单元测试时，模拟会节省很多时间。Rhino Mocks 是我个人使用过的一个很棒的框架。但是有几种模拟框架，找到最适合您的。

在某些时候，您应该将完整的数据库通过集成测试，而我发现的最佳方法是拥有一个脚本，该脚本可以用一组已知的数据完全创建和填充数据库。然后确保除了集成测试之外没有任何东西会触及您新创建的数据库，然后进行测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T11:13:30.053

视情况而定，但在我不想存根数据库的遗留系统上，我经常引入一个接口，比如说 IFooDBManager，它具有返回 ADO.Net 实体的方法，如数据表或数据集。当然它不必是接口，但它可以是例如虚拟方法。然后，在我的测试中，我使用了一个我很久以前自己构建的带有流畅接口的小型 API，我用它来创建数据集和表格，并用测试值填充它们，以便我可以从我的假货中返回它们。

流畅的界面看起来像这样：

```
return DataTableBuilder.Create()
    .DefineColumns("a, b")
    .AddRow().SetValue("a", 1).SetValue("b", 2).DoneWithRow()
    .AddRow().SetValue("a", 10).SetValue("b", 20).DoneWithRow()
.Table 
```

正如我所说，这只是我使用的方法之一，这主要用于我不想在框架工作等方面引入新依赖的遗留系统。然而，这是一种我没有看到很多其他人使用过的技术，所以我认为它值得一提。

编辑：我忘了澄清这是为了删除数据库，因此在这种情况下未测试与数据库的交互。实际的交互将发生在 IFooDBManager 的具体实现中，以完全测试*是否*需要其他东西。

此外，当然，并非此类接口上的所有方法都会返回内容，还有用于写入数据库的方法，我通常通过 RhinoMocks 中的交互测试来测试这些方法，我对这些方法设置期望。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-24T11:21:42.407

我们正在转向使用模拟框架——它们模拟数据库、配置文件等资源。使用这些框架是有效运行单元测试的实用方法。

我们正在开发的框架之一是 Rhino Mocks。您可以在下面的链接中了解它。它还很好地介绍了为什么需要这样的框架。

[http://weblogs.asp.net/stephenwalther/archive/2008/03/22/tdd-introduction-to-rhino-mocks.aspx](http://weblogs.asp.net/stephenwalther/archive/2008/03/22/tdd-introduction-to-rhino-mocks.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-25T08:54:47.727

我通常使用两种方法。

依赖于数据库抽象层的代码与 IoC 一起使用，因此可以使用 mocks/stubs 轻松测试。您有一个*IDataAccess*或*IRepository*接口，并针对它测试代码的交互。

实际针对数据库工作的代码（比如实现*IDataAccess*的类）会自行测试，通常执行到数据库的往返（插入-检索-更新-检索-删除）。在运行每个测试用例之前，都会重新创建或清空数据库以避免测试串扰。这导致测试需要几分钟而不是几秒钟来运行，但在我看来，测试您将在生产中使用的实际数据库很重要。使用内存中的 SQLite 之类的替代品并不是一个好的选择，因为它与 SQL Server 之类的差别太大。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-24T14:34:04.970

在我的数据库测试实践中，我使用了 NUnit，在执行整个测试序列之前，安装了数据库并填充了测试数据。当然，这个过程并不是很快，但它会阻止你在测试运行时做其他工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-26T13:49:00.067

Spring 具有事务性的测试类。播种测试数据，运行测试，回滚它们。就好像你从来没有在那里一样。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-24T08:54:43.723

如果您尝试测试数据访问代码，则需要一个[模拟框架](http://www.typemock.com/index.php)。在以下链接中，您可以看到单元测试数据库[视频教程](http://www.typemock.com/Multimedia.html#identifier3)

# ruby-on-rails - 建模用户之间的消息

> ID：391252
> 
> 赞同：-2
> 
> 时间：2008-12-24T11:03:17.827
> 
> 标签：ruby-on-rails, modeling

我想对用户之间的消息进行建模，这是要求：

1.  用户已接收和发送消息，应由 和`user.received_messages`检索`user.sent_messages`

2.  消息有发送者和接收者，应该由`message.sender`and检索`message.receiver`。

我已将用户模型创建为：

```
script/generate model User name:string 
```

和消息模型为：

```
script/generate model Message content:text sender_id:integer receiver_id:integer 
```

我想出了下面的消息，它可以如愿以偿

```
class Message < ActiveRecord::Base
    belongs_to :sender, :class_name=>'User', :foreign_key=>'sender_id'
    belongs_to :receiver, :class_name=>'User', :foreign_key=>'receiver_id'
end 
```

但我不知道如何为用户建模，任何建议都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T11:58:34.767

就像在消息模型中一样：

```
class User < ActiveRecord::Base
  has_many :sent_messages, :class_name => "Message", :foreign_key => "sender_id"
  has_many :received_messages, :class_name => "Message", :foreign_key => "receiver_id"
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T17:29:57.827

@eric2323223

如果您只是从米兰复制/粘贴代码，那么我怀疑您看到的错误是因为“foreign_key”前面缺少分号。

这些行应为：

```
 has_many :sent_messages, :class_name => "Message", :foreign_key => "sender_id"
  has_many :received_messages, :class_name => "Message", :foreign_key => "receiver_id" 
```

肯尼

# c# - 在 C# 中使用 DirectX 进行开发的资源？

> ID：391255
> 
> 赞同：2
> 
> 时间：2008-12-24T11:05:33.533
> 
> 标签：c#, graphics, resources, directx

有人可以为我提供一些在 C# 中使用 DirectX 进行开发的好资源吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T11:12:56.577

MS 的 DirectX SDK 中的 C# 上有一个旧的 DirectX 端口。

还有一个名为 SlimDX 的开源框架：[http ://code.google.com/p/slimdx/](http://code.google.com/p/slimdx/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T11:23:31.763

[Microsoft 的 XNA](http://en.wikipedia.org/wiki/Microsoft_XNA)使用 DirectX，它旨在让托管开发人员更轻松地进行 DirectX/游戏编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T12:05:47.030

如果 DirectX 不是严格要求，我鼓励你尝试[Ogre3D](http://www.ogre3d.org/)。它是建立在 DirectX 或 OpenGL 之上的图形引擎。该库最初使用 C++，但[MOgre C# 包装器](http://www.ogre3d.org/wiki/index.php/MOGRE)工作正常。而且很容易上手。

# java - 记录用户操作

> ID：391269
> 
> 赞同：2
> 
> 时间：2008-12-24T11:19:08.623
> 
> 标签：java, struts, logging, aspectj

客户希望我们“记录”用户在我们系统上执行的“操作”：主要是创建、删除和更新。我已经有一个记录跟踪的方面，但是它在记录每个方法调用的非常低的级别上工作。因此，如果用户单击“打开医疗文件”按钮，日志将显示：

1.  closePreviousFiles("零号病人")
2.  createMedicalFile("零号病人") --> file #001
3.  changeStatus("#001") --> 打开

而期望的结果是：

1.  为零号病人打开医疗文件#001

我正在考虑使用日志语句来检测 Struts2 操作，但我想知道......是否有另一种方法可以做到这一点？我可能会再次使用 AspectJ（或过滤器）并将逻辑保留在一个地方，以便我可以轻松配置日志，但我担心一切都会变得更难理解（即“此操作的日志是错误的......我到底应该去哪里找麻烦？”）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T15:28:21.117

听起来您的客户想要对系统中用户的操作进行审计跟踪。

考虑在每个操作的入口点（来自 Web 请求）以在操作上使用枚举/常量启动审计条目。如果可能，用用户提供的信息填充它。

在退出/最后，在审核中指明是成功还是失败。伪代码示例：

```
enum Actions {
  OPEN_MEDICAL_FILE
  ...
}

void handleRequest(...) {
  String patient = ...;
  Audit audit = new Audit(OPEN_MEDICAL_FILE);
  audit.addParameter("patient", patient);
  try {
     ... more things ..
     audit.addParameter("file", "#001");
     ... more things ...
     audit.setSuccess();
  } finally {
    audit.save();
  }
} 
```

这里重要的是保存所有用户操作，无论成功或失败。此外，客户确实需要了解所有相关信息以及操作。

由于我们正在记录操作常量和数据，因此可以单独编码向客户端显示审计。您也获得了灵活性，因为演示字符串的更改（例如，“为患者 0 打开的医疗文件 #001”到“打开的患者 0 #001 的医疗文件）不是在操作时确定的，而是在以后确定的。你不'不必重新整理审计数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T11:26:38.170

我最近对日志进行了后处理以生成摘要。您可能需要考虑这种方法，特别是如果上述日志中的 #2 和 #3 是在不同的位置生成的，并且所需的结果需要将状态从一个地方带到另一个地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T13:30:37.250

如果您正在处理医疗数据，您可能需要同时考虑日志记录和版本控制。我什至会考虑用数据库触发器来做这件事。我不会做很多 Java 编程，但我已经与我们的学生信息系统团队讨论过这个问题。他们在后端使用 Oracle 并在他们的连接中注册一个会话变量。他们的触发器使用这个会话变量来创建关键表的日志条目和版本历史（更新/删除）。这为他们提供了审计和回滚功能。我认为这两种方法都对医疗记录应用程序有用。

他们还使用 log4j 进行应用程序级别的日志记录，但数据记录发生在数据库中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T18:00:47.813

我在 Struts2 动作中做过类似的事情，我使用了“log4j”。根据您的应用服务器，它可能有一个集成的日志系统，允许使用消息目录（例如：Weblogic）。

# scheme - DrScheme 与 mzscheme：定义的处理

> ID：391272
> 
> 赞同：3
> 
> 时间：2008-12-24T11:20:55.157
> 
> 标签：scheme, racket, sicp

我的一个长期项目是完成 SICP 的所有练习。我注意到最近的练习有点奇怪。我正在测试一个霍夫曼编码树。当我在 DrScheme 中执行以下代码时，我得到了预期的结果：

```
(a d a b b c a) 
```

但是，如果我通过调用 (load "2.67.scm") 或运行 mzscheme -f 2.67.scm 在 mzscheme 中执行相同的代码，它会报告：

```
symbols: expected symbols as arguments, given: (leaf D 1) 
```

我的问题是：为什么？是不是因为 mzscheme 和 drscheme 使用不同的规则来加载程序定义？程序代码如下。

```
;; Define an encoding tree and a sample message
;; Use the decode procedure to decode the message, and give the result. 

(define (make-leaf symbol weight)
  (list 'leaf symbol weight))
(define (leaf? object)
  (eq? (car object) 'leaf))
(define (symbol-leaf x) (cadr x))
(define (weight-leaf x) (caddr x))

(define (make-code-tree left right)
  (list left
        right
        (append (symbols left) (symbols right))
        (+ (weight left) (weight right))))

(define (left-branch tree) (car tree))
(define (right-branch tree) (cadr tree))

(define (symbols tree)
  (if (leaf? tree)
      (list (symbol-leaf tree))
      (caddr tree)))
(define (weight tree)
  (if (leaf? tree)
      (weight-leaf tree)
      (cadddr tree)))

(define (decode bits tree)
  (define (decode-1 bits current-branch)
    (if (null? bits)
        '()
        (let ((next-branch
               (choose-branch (car bits) current-branch)))
          (if (leaf? next-branch)
              (cons (symbol-leaf next-branch)
                    (decode-1 (cdr bits) tree))
              (decode-1 (cdr bits) next-branch)))))
  (decode-1 bits tree))
(define (choose-branch bit branch)
  (cond ((= bit 0) (left-branch branch))
        ((= bit 1) (right-branch branch))
        (else (error "bad bit -- CHOOSE-BRANCH" bit))))

(define (test s-exp)
  (display s-exp)
  (newline))

(define sample-tree
  (make-code-tree (make-leaf 'A 4)
                  (make-code-tree
                   (make-leaf 'B 2)
                   (make-code-tree (make-leaf 'D 1)
                                   (make-leaf 'C 1)))))

(define sample-message '(0 1 1 0 0 1 0 1 0 1 1 1 0))

(test (decode sample-message sample-tree)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-25T06:36:43.667

默认情况下，MzScheme 以存在 的现有定义的模式启动`symbols`，并且它内联它知道的函数——所以当它编译你的`make-code-tree`定义时，它使用它知道的绑定。当它稍后编译您的`symbols`时，它不会对先前的定义产生影响。

处理这个问题的最简单方法是把你的代码变成一个模块，在它前面加上一个`#lang scheme`.

# macos - Mac 上的 SharePoint 权限

> ID：391284
> 
> 赞同：0
> 
> 时间：2008-12-24T11:29:04.030
> 
> 标签：macos, sharepoint

我们正在使用带有 Windows 集成安全性的 SharePoint Server (MOSS 2007)。

公司中的几台电脑（经理）正在使用 Apple Mac。

这些人无法在他们的机器上运行应用程序！我认为问题是由于Windows集成安全性。我们如何解决这个问题？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T13:38:44.830

我们将 Sharepoint 2007 用于我们的 Intranet 门户，使用 Windows 集成身份验证，对于 Macintosh 用户没有（或很少）问题。我刚刚从我的 MacBook 登录到我们的，并且能够毫无问题地访问它。你能更详细地描述问题是什么吗？无法登录（他们是否应该指定一个域——我们必须这样做）？控制坏了？它们是标准控件还是自定义控件？如果自定义控件，可能 javascript 与 Safari 不兼容。说到这一点，他们使用哪种浏览器有关系吗？即，您在 Safari 和 Firefox 中看到相同的问题吗？

**编辑**：刚刚在我们的 Intranet 站点上发现了这个花絮，它可能有助于避免所有密码提示，尽管它需要 Firefox。我会四处寻找更多，看看是否可以找到 Safari 的解决方案：

```
Using Firefox on a non-Windows workstation (e.g. Linux):
In Firefox, type about:config in the URL address bar and press Enter
Find network.negotiate-auth.trusted-uris and double-click it
In the dialog box that comes up enter:
your-domain.goes.here.com
Click OK (Firefox should now use your Domain credentials to access these sites) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T14:07:06.473

在 Windows 上，我在 sharepoint 上使用 firefox 时遇到了麻烦。这也应该在mac上工作。

**about:config network.ntlm.send-lm-response**中有一个设置默认设置为 false。将其切换为 true，您应该能够手动登录。在进行此更改之前，我会在每一页上提示我输入密码。注意：您需要使用**域\用户名**作为用户名登录。

没有 activex 的 Firefox 中的界面有点不同，但大多数功能仍然存在。Sharepoint 与 Internet Explorer 和办公套件高度集成。如果没有这两种产品，sharepoint 就会失去大部分好处。

附带说明：我实际上很惊讶微软没有对共享点做出更大的推动。Sharepoint 使组织很难从 windows 和 office 迁移。如果我是微软，我将免费赠送共享点；对微软的好处将是供应商锁定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T18:57:51.953

你总是可以切换到基于表单的身份验证。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-16T20:17:20.013

*如果我是微软，我会免费赠送共享点*

他们几乎已经是了。他们会让您放弃第一年的所有许可，以获取所需的一切。这很聪明，您变得根深蒂固，并且您从 Sharepoint 迁移出来变得更加困难。

# c# - C# Remoting / WCF Client Server app 使用什么通讯技术？

> ID：391286
> 
> 赞同：0
> 
> 时间：2008-12-24T11:30:37.943
> 
> 标签：c#, remoting

我真的很喜欢这样的建议。我一直在考虑一个客户端服务器项目，并且将使用 .NET。最初只是打算使用 2.0，但最近得到了 VS2008，并认为我也应该真正探索 3.5。

该应用程序将连接一台服务器和许多客户端。客户端和服务器都需要相互通信（即双向通信）。这将在互联网上运行。

我本来打算为此使用远程处理，但是有什么或任何理由我应该对 3.5 使用不同的方法吗？

我意识到当我使用远程处理时端口可能在客户端被阻止时，我可能会遇到防火墙问题。

真的，我正在寻找建议，以成为处理客户端和服务器之间通信的最佳方式，这些通信将使用 .NET 在网络上工作（希望客户端也能够运行其他语言，但这并不重要我猜测）。客户端和服务器都必须能够调用彼此的方法。

谢谢，

和圣诞快乐。

乔恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T11:43:06.250

我刚刚开始使用 WCF，并在 SO 上围绕这个主题提出了一些问题。在过去一周左右我学到了一些东西：

1.  这篇文章很棒：[MS Pub-Sub with WCF](http://msdn.microsoft.com/en-gb/magazine/cc163537.aspx)
2.  WCF 是要走的路。它的动态配置和单一编程模型应该使其成为您优于传统 Web 服务或远程处理的首选。
3.  通过配置，您的 WCF 服务可以通过简单的 HTTP 绑定公开，允许传统 Web 服务使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T11:36:14.423

据我所知，WCF 应该取代 .NET Remoting，所以我会这样做。

# php - 插入表单时如何删除 Word 标记废话？

> ID：391291
> 
> 赞同：4
> 
> 时间：2008-12-24T11:35:03.410
> 
> 标签：php, ms-word, tinymce, textarea, fckeditor

我正在用 PHP 构建一个 CMS，我担心的是用户必须从现有的 Word（和 Excel，但没关系）文档中填写数据。现在，我看到当他们不小心从 Word 复制并粘贴到 textarea 时会发生什么：数据库中充满了垃圾标记。

现在，我当然可以自己剥离所有标记，但我必须先开始学习它。所以我问你：你有没有测试过一些有用的功能——常见的插件（tinyMCE、FCKeditor 等）在这里有帮助？侵入性最小的解决方案的奖金。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T12:10:27.647

遗憾的是，我使用过的大多数 HTML 编辑器控件：

1.  有一个按钮来去除标记的各种元素（word、html、脚本等）
2.  通过 JavaScript去除粘贴上的**所有**标记。

如果你把它留给一个按钮，那么通常非技术用户会忘记按下它，因为他们不（有些人会说“不应该”）关心它:(

稍微玩一下正则表达式（现在你有另一个问题;））你可以做一些类似于 2 的事情，但只适用于 word xml。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T12:06:54.593

我发现 FCKEditor 可以处理从 Word 文档中拉出并扔给它的文本，比 tinyMCE 好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T12:00:16.480

好的，我找到[了一个 TinyMCE 插件](http://www.vivvo.net/forums/showthread.php?t=2043)，显然可以满足我的要求。尽管如此，这仍要求用户按下按钮进行粘贴，这有点不太理想。有更好的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T12:13:36.220

ASP.NET？[Telerik](http://www.telerik.com/)的[RadEditor](http://www.telerik.com/products/aspnet-ajax/editor.aspx)对我来说效果很好

# oracle - oracle 10G 收缩数据文件

> ID：391292
> 
> 赞同：1
> 
> 时间：2008-12-24T11:35:29.947
> 
> 标签：oracle, oracle10g

我如何在 oracle 10G 中收缩数据文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T13:56:27.213

警告：我不是 Oracle 系统管理员，除了个人安装。用一大粒盐来接受我所说的一切。

我假设您使用自动扩展创建了数据文件，并且它们已经扩展超出了您认为它们应该包含的内容。ALTER DATABASE 有一个子句可以调整文件大小，这是 Oracle SQL 参考中的示例：

```
ALTER DATABASE
DATAFILE 'diskb:tbs_f5.dat' RESIZE 10 M; 
```

但是，我真的不认为您想盲目地这样做。IMO 更好的方法是使用 export 命令转储该数据文件中的表，然后重新创建表空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-28T15:46:08.900

这是一种方法，由 Tom Kyte 提供，用于获取数据库的块大小，列出您可以回收多少空间，并构建 alter... 命令以实际执行数据库缩小。希望这可以帮助，

[http://cglendenningoracle.blogspot.com/2009/08/how-do-i-shrink-datafiles-to-reclaim.html](http://cglendenningoracle.blogspot.com/2009/08/how-do-i-shrink-datafiles-to-reclaim.html)

克雷格格伦登宁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-27T17:20:49.800

**@Dave**关于导出和导入的回答是正确的，是释放空间的最佳选择。同样在 Oracle 中没有收缩命令，**@Dave**是正确的，但存在调整大小命令，正如**@David**所说“数据文件可以调整到最后使用的块”但是有一件值得一提的事情，数据文件中的空闲块可能是像这样分配

```
0101000001111000000000000000000001110000000000
                                    |--------- 
```

其中： 0-是空闲块 1-是使用块

通过调整数据文件的大小直到最后使用的块，它将变成这样：

```
010100000111100000000000000000000111
                                    |--------- 
```

但是数据文件中的其他空闲块呢？它们不适用于其他数据文件或系统本身。

如果数据文件是这样的：

```
1111111111111100000000000000000 
```

那么调整大小会很有用，但在以前的变体中没有。

无论如何要确定直到你能够调整数据文件的大小，这里是脚本：

```
 select 'alter database '||a.name||' datafile '''||b.file_name||'''' ||
' resize '||greatest(trunc(bytes_full/.7)
,(bytes_total-bytes_free))||chr(10)||
'--tablespace was '||trunc(bytes_full*100/bytes_total)||
'% full now '||
trunc(bytes_full*100/greatest(trunc(bytes_full/.7)
,(bytes_total-bytes_free)))||'%'
from v$database a
,dba_data_files b
,(Select tablespace_name,sum(bytes) bytes_full
From dba_extents
Group by tablespace_name) c
,(Select tablespace_name,sum(bytes) bytes_total
From dba_data_files
Group by tablespace_name) d
,(Select a.tablespace_name,a.file_id,b.bytes bytes_free
From (select tablespace_name,file_id
,max(block_id) max_data_block_id 
from dba_extents
group by tablespace_name,file_id) a
,dba_free_space b
where a.tablespace_name = b.tablespace_name
and a.file_id = b.file_id
and b.block_id > a.max_data_block_id) e
Where b.tablespace_name = c.tablespace_name
And b.tablespace_name = d.tablespace_name
And bytes_full/bytes_total < .7
And b.tablespace_name = e.tablespace_name
And b.file_id = e.file_id 
```

不用担心这个脚本不会从数据文件中删除任何使用过的块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-14T22:31:44.753

ALTER TABLESPACE....RESIZE 只允许超出 HWM。因此，您可能在它下面有许多未使用的 segmnet。在此操作之前，发出：

ALTER TABLE .. .SHRINK SPACE 在该表空间/数据文件的某些表上，以便重新组织数据文件的内容。

可能是一项漫长的任务，但您可以使用 SQL 生成命令。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-24T13:53:33.710

对于 Oracle 中的标准数据文件，您无法缩小它们。您必须执行以下操作：

1.  将段移动到另一个表空间，或导出并删除它们
2.  删除数据文件
3.  创建一个新的较小的数据文件
4.  将段移回第一个表，或从转储文件中导入它们

对于“大文件”表空间——意味着 CREATE BIGFILE TABLESPACE 用于创建它——你可以使用 ALTER TABLESPACE .. RESIZE ...

# x86 - 进程内存中的 Unicode 字符串

> ID：391295
> 
> 赞同：3
> 
> 时间：2008-12-24T11:36:37.870
> 
> 标签：x86, language-design, language-implementation

处理内存中 unicode 字符串的首选格式是什么？为什么？

我正在通过为其生成可执行文件映像来实现编程语言。显然，一个工作的编程语言实现需要一个处理字符串的协议。

我考虑过使用动态数组作为字符串的基础，因为它们实现起来非常简单，并且对于短字符串非常有效。当以这种方式使用字符串时，我只是不知道字符的最佳可能格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T12:23:00.130

UTF16 是使用最广泛的格式。

[UTF16](http://fr.wikipedia.org/wiki/UTF-16)优于[UTF8](http://fr.wikipedia.org/wiki/UTF-8)的优势在于，尽管不那么紧凑，但每个字符的大小都是 2 字节（16 位）的恒定值 - 只要您不使用代理项（当坚持使用 2 字节字符时，编码称为[UCS-2](http://fr.wikipedia.org/wiki/ISO/CEI_10646)） .

在 UTF8 中，只有一小部分字符编码为 1 个字节，其他字符则为 4 个字节。这使得字符处理不那么直接并且更容易出错。

当然，使用 Unicode 是首选，因为它可以处理国际字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T13:01:06.327

C Python 2.x 系列根据平台/构建/等使用 UTF-16 和 UCS-4。

这是python-dev 关于选择 Python 3.0 的 Unicode 内部表示的要求和权衡[的有趣讨论。](http://mail.python.org/pipermail/python-3000/2006-September/003795.html)虽然那里的内容比我可以简要描述的要多，但它包括：

*   讨论外部接口（恒定时间切片、.lower、.islower 等的高效实现）
*   外部要求（GTK 采用 UTF-8 字符串，QT 采用 UTF-16 和 UCS-4 字符串，Windows 采用 UT-16 字符串等）
*   它指向 Unicode 数据的其他实现（例如 QT）。
*   它讨论了重要的用例（与外部接口密切相关）。
*   等等

# c# - 具有订阅者缓存的 WCF Pub/Sub

> ID：391296
> 
> 赞同：7
> 
> 时间：2008-12-24T11:38:02.453
> 
> 标签：c#, wcf, architecture, disaster-recovery

**问题：**如何使用 WCF 提供分布式、可扩展和抗灾的发布/订阅服务。

**细节：**

*请注意，除了消息传递/中间件解决方案（如 Tibco EMS）之外，还考虑使用此方法。*

我一直在研究 WCF，特别是它如何用于提供 pub/sub。关于这个主题这篇文章非常好：[WCF pub-sub](http://msdn.microsoft.com/en-gb/magazine/cc163537.aspx)。

在这篇文章中，作者试图解决拥有多个发布者的问题（就像一个跨多个盒子扩展的服务层一样）。问题在于，如果客户端 A 向发布者 A 注册，但发布者 B 希望发布事件，那么发布者 B 将不知道客户端 A。即没有人告诉发布者 B 客户端 A 希望收到有关事件的通知。作者建议使用 pub/sub 服务作为解决方案。发布/订阅服务将集中存储订阅。但是，如果我想通过拥有辅助/双 pub/sub 服务来使 pub/sub 服务具有抗灾能力，那么我会遇到同样的原始问题。

所以，我认为这个问题有几个解决方案：

1.  将订阅者详细信息存储在分布式缓存中（请参阅问题：[q1](https://stackoverflow.com/questions/125697/wcf-application-caching-implementation)和[q2](https://stackoverflow.com/questions/21870/systemwebcaching-vs-enterprise-library-caching-block)）。
2.  将订户详细信息存储在数据库/中央文件系统中。

谁能想到任何其他解决方案（即我没有错过 WCF 的一些奇妙的神奇功能？）任何意见表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T18:26:48.837

我有同样的问题，我对这个问题做了很多研究。问题其实很简单。你想保持一些集中的状态，但是以分布式的方式。我发现实现这一点的最佳方法是使用分布式缓存。以速度为例。我知道没有可以解决状态管理问题的本机 WCF 解决方案。我什至研究过持久服务，其中状态管理由 WCF 处理，但不适合发布/订阅服务，因为需要为所有客户端连接集中状态。将数据存储在数据库中也是一种选择，但代价是需要数据库，即使使用数据库，如果数据库不是针对多台计算机进行集群，您也可能会出现单点故障。

最后，我认为实现零故障点的东西实际上是昂贵的，如果你决定去那里然后看看 Azure，存储的未来在云上，Azure 服务将是完全可扩展和分布式的，但我们还没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T19:51:18.717

我认为 WCF 还没有。您需要的是一个为您处理所有这些细节的代理，这样您就可以实现您的业务逻辑。有一些非常好的，比如 ActiveMQ。如果您需要编排，那么您可能想要使用也可以位于代理之上的总线。我认为 WCF 很棒，但尝试将其变成不是的东西，这不是一个好主意。

# php - 来自 PHP 的 JavaScript 函数

> ID：391306
> 
> 赞同：-1
> 
> 时间：2008-12-24T11:44:45.920
> 
> 标签：php, javascript

我有一个 JavaScript 函数，`pop_item`. 我必须从 PHP 调用它，所以我的 PHP 代码如下：

```
echo '<a href="javascript:pop_item('.$_code.',1)">Link </a>'; 
```

它没有提供错误，但`pop_item`无法正常工作，

上面的 HTML 输出是：

```
<a href="javascript:pop_item('ABC',1)">Link </a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T11:53:15.637

我认为问题出在 pop_item 函数中，因为调用似乎是正确的。试试这个：

```
echo " <a href='#' onclick=\"pop_item(".$_code."', 1)\">link</a>"; 
```

或者

```
echo '<a href="javascript:alert('.$_code.')">Link</a>'; 
```

看看这是否有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T16:04:09.810

如果你的 pop_item 函数接受一个字符串作为它的第一个参数，这可能是因为那里缺少一些引号字符。使用 PHP 的插值功能，因此您可以确定哪个报价是哪个报价。像这样的一行：

```
 echo "<a href=\"javascript: pop_item('$_code',1);\">Link</a>"; 
```

如果 pop_item 接受其他数据类型，则不需要单引号。我还建议您使用浏览器的 JavaScript 错误控制台来查看问题的详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T11:56:09.267

您的功能可能未定义...确保将其包含在某处...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T12:25:48.737

如果输出看起来正确，那么 PHP 已经正确完成了它的工作，问题出在你的 JavaScript 代码中。尝试使用[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)或其他一些 JavaScript 调试器来运行您的页面以找出问题所在。

# jquery - jQuery 插入

> ID：391314
> 
> 赞同：32
> 
> 时间：2008-12-24T11:55:51.840
> 
> 标签：jquery

我正在尝试使用 jQuery 将 li 元素插入到 ul 元素上的特定索引中。我似乎只能在列表末尾插入一个元素。我对 jQuery 很陌生，所以我可能只是思考不正确。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-24T11:59:42.580

尝试这样的事情：

```
$("#thelist li").eq(3).after("<li>A new item</li>"); 
```

使用该`eq`函数，您可以获得检索到的元素的特定索引......然后，在其后插入新的列表项。

在上面的函数中，我在位置 4（索引 3）插入了一个新项目。

[jQuery Docs](http://docs.jquery.com/Traversing/eq#index)中有关该函数的更多信息

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-15T20:29:20.093

一个简单的 jQuery 插件（[一个小型​​测试套件](http://jsfiddle.net/KQqfB/1/)），它允许在包括 0 在内的任何索引处添加项目。

```
$.fn.insertAt = function(index, $parent) {
    return this.each(function() {
        if (index === 0) {
            $parent.prepend(this);
        } else {
            $parent.children().eq(index - 1).after(this);
        }
    });
} 
```

假设我们有以下 HTML：

```
<ul id="items">
    <li>A</li>
</ul> 
```

然后在索引 0 处插入一个项目`$('<li>C</li>').insertAt(0, $('#items'))`将导致

```
<ul id="items">
    <li>C</li>
    <li>A</li>
</ul> 
```

插入另一个项目，这次在索引 1 处`$('<li>B</li>').insertAt(1, $('#items'))`产生

```
<ul id="items">
    <li>C</li>
    <li>B</li>
    <li>A</li>
</ul> 
```

*免责声明：*输入参数没有错误处理。如果`index`为负数或大于子项的长度，或者如果`index`不是数字，则行为或多或少未定义。如果`$parent`不是 jQuery 对象`insertAt`将失败。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-24T13:24:59.257

类似于 Dreas 的答案，但略有不同，可能更有效：

```
$("#thelist li:eq(2)").after("<li>new item</li>"); 
```

或者另一种方式：

```
$("<li>new item</li>").insertAfter("#thelist li:eq(2)"); 
```

* * *

## 回答 #4

> 赞同：-13
> 
> 时间：2008-12-24T12:11:51.340

尝试使用此方法..这是在元素内插入文本的最简单方法..

```
<div id="test"></div>

$('#test').append(); 
```

# svn - 拒绝访问所有 SVN 目录

> ID：391316
> 
> 赞同：2
> 
> 时间：2008-12-24T11:56:44.227
> 
> 标签：svn, windows-vista

我正在尝试删除几个工作副本目录，但我得到所有 SVN 文件的访问被拒绝，以管理员或普通用户身份运行。我已经杀死了 Tortoise 缓存进程，但不知道出了什么问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-24T12:08:56.150

下载 Microsoft 的[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)并查看哪些进程打开了文件句柄。

下载 Process Explorer 后运行它（无需安装），然后

*   选择查找 -> 查找句柄或 DLL
*   输入一个您不能删除的文件名。

它将列出具有该文件句柄的进程。杀死进程，你应该没问题。

请注意，这是一个通用的 Windows 答案，而不是 TortoiseSVN 特定的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T12:11:12.650

您可以先尝试重新启动您的电脑，然后再尝试再次删除它。

或者也许这个工具可以提供帮助：[Unlocker](http://www.emptyloop.com/unlocker/)

> Unlocker 是以下类型的 Windows 错误消息的解决方案
> 
> ```
> * Cannot delete folder: It is being used by another person or 
> ```
> 
> 程序 * 无法删除文件：访问被拒绝 * 存在共享冲突。* 源文件或目标文件可能正在使用中。* 该文件正被另一个程序或用户使用。* 确保磁盘未满或未写保护且文件当前未在使用中。
> 
> 1.  只需右键单击文件夹或文件，然后选择解锁器
>     
>     
> 2.  如果文件夹或文件被锁定，将出现一个储物柜窗口列表
>     
>     
> 3.  只需单击全部解锁即可！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T23:36:35.543

在禁用 Norton Autoprotect 防病毒软件之前，我遇到了令人发指的问题。

[http://subversion.tigris.org/faq.html#windows-access-denied](http://subversion.tigris.org/faq.html#windows-access-denied)

所以发布提示：包括您的环境的版本、操作系统等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-13T13:53:38.207

尝试从另一台服务器移动存储库时，我遇到了类似的访问被拒绝问题。我可以通过执行以下操作来加载 repo。

*   使用创建新的仓库`svnadmin create C:\RepoDirectory\RepoName`
*   确保您的用户帐户具有您尝试执行的文件夹的“所有者”权限。右键单击属性并进入高级安全设置。
*   执行你的 svnadmin 加载命令
*   `svnadmin load C:\RepoDirectory\RepoName < C:\LocationOf\RepoDump.dmp`

# mysql - MySQL中的表注释长度

> ID：391323
> 
> 赞同：16
> 
> 时间：2008-12-24T12:03:41.200
> 
> 标签：mysql, mysql-workbench

根据 MySQL 手册，表注释限制为 60 个字符。我正在 MySQL Workbench 中设计架构，它不强制执行此限制，因此我最终经常编写超过 60 个符号，这会导致 SQL 脚本失败。说实话，我会很高兴表注释在我的模式内部（即不导出到实际数据库），但 Workbench 也不允许这样做。因此我的问题是：有没有办法将 MySQL 中表注释的最大长度增加到 255？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T13:52:57.613

我从谷歌来到这里 - 没有办法（除了补丁），但评论长度显着增加，正如我在这里总结的那样[https://stackoverflow.com/a/14502814/857958](https://stackoverflow.com/a/14502814/857958)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T12:15:19.820

根据[这个错误报告](http://bugs.mysql.com/bug.php?id=34507)，Workbench 在 5.0.18 中被修复，不允许超过 60 个字符的评论。

我很确定没有办法增加限制，但是如果您关闭严格模式（即使是在导入时暂时关闭），那么它应该用警告截断它而不是抛出错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-16T23:41:58.487

我从谷歌来到这里。这个 60 个字符的限制已经失效*很长时间*了[http://dev.mysql.com/doc/refman/5.5/en/create-table.html](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)

> `COMMENT`
> 
> 表的注释，最多 2048 个字符（在 MySQL 5.5.3 之前为 60 个字符）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T12:20:30.043

可在此处获得在 MySQL 中启用更长注释的补丁，[链接文本](http://lists.mysql.com/commits/57746)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-16T11:50:46.817

这是我在 MySQL Workbench 中发现的第一个缺陷。我以前从未使用过表格评论，但我确实喜欢它们。为什么在生成的 SQL 脚本中使用包含（或前置）带有哈希标记的注释？不会让他们失望的。

# nhibernate - NHibernate 中的 Tuplizer 是什么

> ID：391332
> 
> 赞同：7
> 
> 时间：2008-12-24T12:12:26.753
> 
> 标签：nhibernate, tuplizer

我遇到了一篇在 NHibernate 中提到 Tuplizer 的帖子，任何人都可以为 Tuplizer 提供一个好的定义或参考吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-05-15T03:45:58.770

来自[ITuplizer 的源代码](http://fisheye3.atlassian.com/browse/nhibernate/trunk/nhibernate/src/NHibernate/Tuple/ITuplizer.cs?r=3313)：

> A tuplizer defines the contract for things which know how to manage a particular representation of a piece of data, given that representation's EntityMode (the entity-mode essentially defining which representation).
> 
> If that given piece of data is thought of as a data structure, then a tuplizer is the thing which knows how to:
> 
> *   create such a data structure appropriately
> *   extract values from and inject values into such a data structure
> 
> For example, a given piece of data might be represented as a POCO class. Here, it's representation and entity-mode is POCO. Well a tuplizer for POCO entity-modes would know how to:
> 
> *   create the data structure by calling the POCO's constructor
> *   extract and inject values through getters/setter, or by direct field access, etc
> 
> 同一条数据也可以表示为 DOM 结构，使用与 XML 实体模式关联的元组器，它将生成 XmlElement 的实例作为数据结构，并知道如何以嵌套的 XmlElements 或 XmlAttributes 的形式访问值。

[用 Fabio Maulo](http://nhforge.org/blogs/nhibernate/archive/2008/10/16/less-than-gof-is-hbm.aspx)的话来说：

> tuplizer 定义如何将 Property-Value 转换为其持久表示，反之亦然，将 Column-Value 转换为其内存表示，EntityMode 定义正在使用的 tuplizer。

您可以使用自定义 tuplizer 进行一些操作：

*   [远程延迟加载](http://www.theserverside.com/news/1363571/Remote-Lazy-Loading-in-Hibernate)（本文使用 Java Hibernate，但一般概念也适用于 NHibernate）
*   [无缝映射/持久化接口而不是 POCO](http://nhforge.org/blogs/nhibernate/archive/2008/10/12/less-than-few-is-gof.aspx)
*   [映射/持久化 F# 记录](http://bitbucket.org/robertpi/functionalnhibernate/src/tip/src/app/FunctionalNHibernate/FSharpRecordTuplizer.fs)（来自[FunctionalNHibernate 项目](http://strangelights.com/blog/archive/2009/12/20/1650.aspx)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T13:07:56.140

好吧，首先了解什么是元组可能会有所帮助：

[http://en.wikipedia.org/wiki/Tuple](http://en.wikipedia.org/wiki/Tuple)

Python 最值得注意的是对元组的一流支持，尽管其他一些语言也支持 (F#)

[http://diveintopython3.ep.io/native-datatypes.html#tuples](http://diveintopython3.ep.io/native-datatypes.html#tuples)

而且当然！

[https://stackoverflow.com/search?q=tuples](https://stackoverflow.com/search?q=tuples)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-20T11:37:33.670

**org.hibernate.tuple.Tuplizer及其子接口负责管理给定表示的****org.hibernate.EntityMode**的数据的特定表示 。如果给定的数据被认为是一种数据结构，那么元组器就是知道如何创建这种数据结构以及如何从这种数据结构中提取值并将值注入到这种数据结构中的东西。例如，对于 POJO 实体模式，对应的 tuplizer 通过其构造函数知道如何创建 POJO。它还知道如何使用定义的属性访问器访问 POJO 属性。Tuplizer 有两种高级类型，分别由 **org.hibernate.tuple.entity.EntityTuplizer**和 **org.hibernate.tuple.component.ComponentTuplizer表示**接口。EntityTuplizers 负责管理上面提到的关于实体的合约，而 ComponentTuplizers 对组件做同样的事情。

# vb.net - 如何确保有一个应用程序实例正在运行

> ID：391339
> 
> 赞同：7
> 
> 时间：2008-12-24T12:19:12.417
> 
> 标签：vb.net, single-instance

我想检查用户何时双击应用程序图标，该应用程序的另一个实例尚未运行。

我阅读了有关 My.Application 的信息，但我仍然不知道该怎么做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-24T12:49:11.467

这是我用过的东西......（.NET 2.0 上的 C#）

```
 [STAThread]
    private static void Main(string[] args)
    {
        //this follows best practices on
        //ensuring that this is a single instance app.
        string mutexName = "e50cf829-f6b9-471e-8d9f-67eac3699f09";
        bool grantedOwnership;
        //we prefix the mutexName with "Local\\" to allow this to run under terminal services.
        //The "Local\\" prefix forces this into local user space.
        //If we want to forbid this in TS, use the "Global\\" prefix.
        Mutex singleInstanceMutex = new Mutex(true, "Global\\" + mutexName, out grantedOwnership);
        try
        {
            if (!grantedOwnership)
            {
                MessageBox.Show("Error: X is already running.\n\nYou can only run one copy of X at a time.", "X", MessageBoxButtons.OK, MessageBoxIcon.Error, MessageBoxDefaultButton.Button1);
                Application.Exit();
            }
            else
            {
                Application.Run(new X(args));
            }
        }
        finally
        {
            singleInstanceMutex.Close();
        }
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-24T13:35:22.043

在 VB .NET 中有一个[IsSingleInstance](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.issingleinstance.aspx)布尔属性可以为您完成这项工作。

在 VB 中（取自[此处](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic59664.aspx)）：

```
Public Class Program
        Inherits Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase

       Public Sub New()
            Me.IsSingleInstance = True
        End Sub

End Class 
```

以下是在 C# 中使用它的方法（取自[此处](http://en.csharp-online.net/Application_Architecture_in_Windows_Forms_2.0%E2%80%94Single-Instance_Detection_and_Management)）：

```
// SingleInstanceApplication.cs
class SingleInstanceApplication : WindowsFormsApplicationBase {

 // Must call base constructor to ensure correct initial 
 // WindowsFormsApplicationBase configuration
 public SingleInstanceApplication() {

  // This ensures the underlying single-SDI framework is employed, 
  // and OnStartupNextInstance is fired
  this.IsSingleInstance = true;
 }
}

// Program.cs
static class Program {
 [STAThread]
 static void Main(string[] args) {
  Application.EnableVisualStyles();
  SingleInstanceApplication application = 
   new SingleInstanceApplication();
  application.Run(args);
 }
} 
```

确保在您的项目中引用 Microsoft.VisualBasic.dll。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T13:44:19.530

打开您的项目属性（应用程序选项卡）并选中**制作单实例应用程序**选项。

在 Application 选项卡中，您还可以单击**View Application Events**按钮，以创建一个**ApplicationEvents.vb**类，您可以在其中处理第二个实例事件：

```
Partial Friend Class MyApplication
    Private Sub MyApplication_StartupNextInstance(ByVal sender As Object, ByVal e As Microsoft.VisualBasic.ApplicationServices.StartupNextInstanceEventArgs) Handles Me.StartupNextInstance
        ' Bring First Instance to Foreground
        e.BringToForeground = True
        ' Pass Second Instance Command Line to First Instance
        AppShared.DoSomethingWithCommandLine(e.CommandLine)
    End Sub
End Class 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-24T13:08:36.920

Scott Hanselman 对此有很好的文章。代码在 C# 中，但我想将它移植到 VB 会很容易。

[http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx)

如果不能满足您的需求，这里还有一篇关于该主题的文章：

[http://www.codeproject.com/KB/cs/cssingprocess.aspx](http://www.codeproject.com/KB/cs/cssingprocess.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T13:51:16.117

在 VB.NET 中，单实例应用程序只是[项目属性页上的一个复选框](http://msdn.microsoft.com/en-us/library/8fz4ssw2.aspx)。您还可以捕获[My.Application.StartupNextInstance](http://msdn.microsoft.com/en-us/library/b9z4eyh8.aspx)事件，让您的单个实例在另一个副本启动时执行某些操作。例如，这可以用于类似 MDI 的行为，即在原始实例中打开请求的文档。

在幕后，它封装了一些互斥量和 IPC goo - 请参阅[WindowsFormApplicationBase](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.aspx) - 并且也可以在 C# 中使用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-23T21:30:01.130

通过上面的提示，我发现了如何使我的应用程序成为单个实例，但我仍然必须去另一个站点才能找到确切的方法。这是我如何做到这一点的简单图片。这很容易，我希望它可以帮助其他有同样需求的人，因为我确信 OP 在 7 年前解决了这个问题： [![在此处输入图像描述](https://i.stack.imgur.com/qxY5S.png)](https://i.stack.imgur.com/qxY5S.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-24T12:46:13.643

使用`Mutex`. 实际上，a`Mutex`可以用字符串命名，并且在 CLR 中是唯一的。

示例代码：

```
try
{
mutex = Mutex.OpenExisting(mutexName);
//since it hasn’t thrown an exception, then we already have one copy of the app open.
MessageBox.Show(”A copy of Todo 3.0 is already open. Please check your system tray (notification area).”,
“Todo 3.0″, MessageBoxButtons.OK, MessageBoxIcon.Information);
Environment.Exit(0);
}
catch (Exception Ex)
{
//since we didn’t find a mutex with that name, create one
Debug.WriteLine(”Exception thrown:” + Ex.Message + ” Creating a new mutex…”);
mutex = new Mutex(true, mutexName);
} 
```

从这篇[文章](http://joelbennett.wordpress.com/2007/04/14/using-a-mutex-to-prevent-multiple-copies-of-an-application-from-runningc/)：

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-24T13:44:52.587

如果您的应用程序在 VB.NET 2.0-3.5 中，保持程序的单个实例运行的最简单方法是使用“Windows 应用程序框架属性”。要到达那里，请右键单击您的项目名称并转到“属性”。在那里，选择“制作单实例应用程序”复选框。

您还可以使用 ApplicationEvents.vb 向用户显示他们已经第二次运行您的程序。您可以通过选择“查看应用程序事件”按钮在同一属性窗口中轻松创建/查看它。在那里，您可以选择 MyApplication_StartupNextInstance 子并在那里输入代码，如下所示：

```
Private Sub MyApplication_StartupNextInstance(ByVal sender As Object, ByVal e As Microsoft.VisualBasic.ApplicationServices.StartupNextInstanceEventArgs) Handles Me.StartupNextInstance
    MessageBox.Show("This program is already running.  If you do not see the program running, please check your " _
        & "Windows Task Manager for this program name in the 'Processes' Tab." & vbNewLine & vbNewLine & "WARNING: " _
        & " If you terminate the process, you will terminate the only instance of this program!", My.Application.Info.ProductName.ToString _
        & " is Running!", MessageBoxButtons.OK, MessageBoxIcon.Warning)

End Sub 
```

让我知道这是否有帮助！联合部队

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-24T12:51:12.337

为您的应用分配一些唯一标识符，例如硬编码的 guid，并创建一个 Mutex 实例，在该实例中将互斥锁分配给该标识符。如果它引发异常，则表示您的应用程序已经在运行（因为它成功地创建了互斥锁）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-24T13:20:49.093

**我认为将示例放在此处而不是链接会更容易。**

```
 [STAThread]
    static void Main()
    {
        if (!IsAppAlreadyRunning())
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1()); /* Change Form1 for your main Form */
        }
        else
        {
            MessageBox.Show("Application is already running!");
        }
    }

    public static bool IsAppAlreadyRunning()
    {
        Process currentProcess = Process.GetCurrentProcess();
        return (IsAppAlreadyRunning(currentProcess.Id, 
                                    currentProcess.ProcessName));
    }

    private static bool IsAppAlreadyRunning(int ID, string Name)
    {
        bool isAlreadyRunning = false;
        Process[] processes = Process.GetProcesses();
        foreach (Process process in processes)
        {
            if (ID != process.Id)
            {
                if (Name == process.ProcessName)
                {
                    isAlreadyRunning = true;
                    break;
                }
            }
        }
        return isAlreadyRunning;
    } 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-24T12:25:11.080

最常见的模式是使用单例模式。由于您没有指出一种语言，我将假设您在这里指的是 C# - 如果不是，则大多数 OO 语言中的原则仍然相同。

[这篇](http://iridescence.no/post/CreatingaSingleInstanceApplicationinC.aspx)文章应该能给你一些帮助。

# c# - 当我从 C 和 C# 过渡到 C++ 时，我可以期待有什么不同？

> ID：391346
> 
> 赞同：4
> 
> 时间：2008-12-24T12:26:27.020
> 
> 标签：c#, c++, c

这是一个简单的问题。

我已经使用 C 和 C# (2.0) 完成了大量工作，但从未使用 C++。在学习 C++ 时，我可以期待有什么不同？会有什么大问题或障碍我也应该注意吗？有没有人为有经验的程序员学习 C++ 提供好的速成课程书/网站推荐？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-24T14:37:50.233

我能想到的主要区别是 C++ 比 C 和 C# 更像是一种多范式语言。在 C# 中，OOP 仍然*是*范例。它首先是一种 OOP 语言，如果您不使用 OOP，C# 社区会告诉您您做错了。（尽管在过去几年中，C# 也为一些函数式编程添加了很好的支持）。

在 C++ 中，OOP 是受支持的，您可以在喜欢的时候使用它，但所有的大惊小怪都围绕着泛型编程。C++ 模板允许广泛的智能、可重用和通用库，并实现许多与老式 OOP 相同的目标，但没有大的继承层次结构，并且类之间几乎没有耦合。标准库包含很多这样的例子

在 C++ 中，许多 C 结构虽然仍然合法，但基本上都被避开了：

*   原始指针（*通常*替换为智能指针，例如`boost::shared_ptr`or `std::auto_ptr`，或替换为引用
*   用户代码中的内存分配（通常应该包装在智能指针中，或者在定制的 RAII 对象中）
*   函数指针（通常用仿函数替换，以获得更好的类型安全性和性能）
*   goto（在 C 中经常用于跳转到清理代码。同样，RAII 不再需要）
*   预处理器（实际上从不需要。更喜欢模板）

当然，每一点都有例外，但作为一般经验法则，与 C 代码不同，C++ 代码将几乎消除所有这些的使用。

与 C# 相比，类确实是承担大量繁重工作的主力。在 C# 中，一个类只不过是一个脚手架，一个将所有方法放入其中的容器。当然，它有一个构造函数，并且它*可以*实现 Dispose(); 但 C++ 更进一步，你有：

*   构造函数（就像在 C# 中一样，从头开始初始化类）
*   复制构造函数（将一个类初始化为另一个对象的副本）
*   赋值运算符（因为类是 C# 认为的值类型。因此赋值不仅仅是更改引用，而是以用户定义的方式复制对象的所有内容）
*   析构函数

析构函数可能*是*C++ 中最重要的概念。RAII 是管理内存或其他资源的方式至关重要，因为当对象超出范围时会自动调用它。这使您的类可以做出很多在 C 或 C# 中无法实现的保证。例如，boost::thread 提供了一个作用域锁，当它超出作用域时，无论函数是否正常返回、是否抛出异常或其他任何情况，都保证释放该作用域锁。所以在使用这个库时，用户不必担心释放锁或其他资源。一旦你完成了它们，它就会自动发生。

从某种意义上说，这给了你更多的钩子来定制你的类的行为。与 C# 不同，您可以准确控制执行简单赋值时发生的情况。您可以控制当类超出范围、从头开始初始化或作为另一个对象的副本时发生的情况。这使得编写良好的类几乎不可能被错误地使用。（几乎）

除此之外，模板和模板元编程是您可能会遇到的概念。它们是非常强大的工具，因此请确保您与它们保持友好关系。:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-24T12:44:10.667

以下是我的一些观点：

*   **指针**在 C++ 中扮演着重要角色。在 C# 中，您只有引用类型。你可能会因为指针错误而头疼。
*   您还必须手动管理内存分配。如果没有正确完成，您的程序可能会遇到内存泄漏。在 C# 中，每个对象都会自动进行垃圾回收。
*   类的声明和定义通常在 **头文件 (.h)**和**源文件 (.cpp 或 .cc)**中分开。这首先会引起一些混乱。
*   在 C++ 中，您不会像在 C# 中那样拥有那么多的基类库支持。例如，您不会 `HttpRequest`在 C++ 中内置类。
*   因此，您将不得不使用大量外部库并知道如何处理 .dll 或 .lib。
*   C++`Interface`与 C# 不同。您将改用抽象类（和多重继承）。
*   C++ 中的字符串是一个 char 数组或指向 char 的指针。
*   标准模板库 (STL) 中有一些算法和数据结构可供使用。但是在开始有效使用它之前需要时间来学习 :)

您还可以学习 C++/CLI 以将您的 .NET 代码和本机 C++ 混合在一起，以获得两全其美的效果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-24T12:39:43.500

我强烈建议：“有效的 C++ 和更有效的 C++”。如果您愿意，“Effective STL”可能会有所帮助:)

这些书是专门为需要有效处理 C++ 的聪明程序员编写的。我证明，当我开始使用 C++ 时，Effective C++ 对我的帮助很大！

另一本适合 C++ 初学者（但我不认为是计算机初学者）的好书是《Accelerated C++》。它主要关注良好的编码、stl 和生成高级代码，而不是关注细节。（这些在本书的末尾有更多的介绍）。

祝你好运 ：）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-24T12:40:25.307

好吧，我已经使用 C++ 10 多年了，所以我的答案是，学习严格的内存管理、C++ 模板、STL，然后是 Boost。这应该需要您几个月的时间，然后细节将需要您说 5 年 :)

至于书，我喜欢 Herb Sutter 的 Exceptional C++ 和 More Exceptional C++

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T12:36:55.237

嗯...艰难的一个。如果你对 .NET 和指针没问题，就不应该有太多新的东西。

我认为处理 C++ 头文件将是一种体验。您还可以熟悉 C++ STL。

您可能还必须处理那些对您大喊大叫的人，例如多重继承。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-24T13:20:02.933

我从 Asm 转到了 C、C++、...，最近又转到了 C#。它减轻了能够实例化对象并从方法或属性中返回它们的能力。通常，实现和用户代码都不需要担心释放内存。此外，在大多数情况下，没有理由返回状态代码，如 HRESULT，因为如果出现问题，您会抛出异常并让用户代码在需要时处理它。

最近在我的上一个项目中切换回本机 C++ 代码后，我真的很怀念垃圾收集和异常抛出。

不过，我确实喜欢 C++ 的模板功能。C# 应该有一天会扩展这种技术。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-24T15:39:07.117

主要区别在于 C++ 是基于值的，而 C# 是基于引用的。

在 C# 中，当您将对象传递给方法时，实际上只是传递了一个引用，因此调用方法和被调用方法都在查看同一个对象。

在 C++ 中，当您将对象传递给方法时，会生成该对象的副本，并将整个副本传递给方法。被调用方法对副本所做的更改不会影响调用方法中的原始内容。可以使用参考语法在 C++ 中模拟参考行为：

```
void somemethod(someclass& obj); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-24T13:57:49.083

我看到有几个人指出内存管理是一个大问题，因为您必须手动完成。好吧，不要相信他们，这是错误的。除非您处于异国情调/老式环境中，否则 C++ 具有帮助我们隐式和确定性地管理内存（以及任何其他资源）的工具。请参阅 boost/std::tr1 shared_ptr<> 和 RAII。

GC 收集内存的最大区别是：您必须自己处理循环。

关于多重继承，一旦你掌握了 LSP 的含义，它也不是什么大问题。

我必须同意[pheze](https://stackoverflow.com/questions/391346/what-can-i-expect-to-be-difference-when-i-transition-from-c-c-to-c#391358)的信息：如果你想教你如何（/应该？）使用C++，*加速 C++是必读的。*

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-24T15:20:34.563

Jalf 完全正确 - 来自 C/C# 背景，您实际上已经了解所有您需要的基本 C++，并且您也了解 OOP，所以您已经做得很好了。

不过，有两件事会浮现在您的脑海中，这对您来说是新的：

*   RAII：这让你有自动的内存管理，你不再需要记住释放所有你 malloc 的东西。酷啊！它还对其他所有资源都有帮助，您不再需要记住关闭该套接字、文件、数据库连接 - RAII 会为您完成。C 和 C# 都没有这个。

*   STL/Boost：这是“C++ 类库”，充满了有用的实用程序和位。所有标准容器都在 STL 中（如“字典”、“数组”和“列表”）以及您可以应用于它们的算法（例如，如果您有数据项列表，您可以提供一个小函数对象（称为一个仿函数），然后将两者都传递给一个通用算法。这真的很强大，你可以用它做很多工作）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-24T12:33:36.523

最大的“障碍”可能是您将负责释放您分配的内存

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-24T12:38:01.863

正如已经发布的那样，您可能会负责您的内存管理，但除了学习 C++ 库以及如何组织包括它们之外，我认为这根本不应该是一个艰难的转变。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-24T13:02:50.130

关于语言实现的差异——我认为你需要小心内存管理、标头中的声明等——我认为最难处理的是特殊字符的额外重载句法。经过多年编写 C# 代码后，我最容易绊倒的东西都是那些多余`*`的`&`, 和`<>`。我的第一反应是 C++ 代码看起来很像一个大的正则表达式。

我敢肯定，一旦你使用它一段时间，它就会消失，但我不再做足够的 C++ 来让我知道在每种情况下都使用哪个符号——我是传入一个指针还是一个引用那个对象？

无论如何，在阅读其他人的代码时，另一个大问题是运算符重载。我知道你可以在 C# 中做到这一点，但我很少看到它在那里完成。可能事情已经发生了变化，但我曾经在 C++ 中看到很多运算符重载`+/-`会产生一些奇怪的效果。除了一些相当明显的胜利（比如字符串连接）之外，我认为这确实是一个我可以不用的可疑特性——在 C++ 和 C# 中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-24T13:36:30.793

1.  内存管理
2.  更复杂的语法
3.  内存管理
4.  在整个 OOP 生命周期中，工具支持少于 C#。
5.  内存管理

我有没有提到内存管理？

我一直认为使用市场作为一部分人口感知需求的指标很有趣。考虑到（为了对比）VB 市场，组件库似乎是主要重点。然而，从早期开始，C++（和 C）市场中的主要产品似乎是内存管理、泄漏检测和代码质量工具（例如类似 lint 的检查器）。

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2008-12-24T14:02:34.923

类之间的循环引用 [在 C++ 中]。如果你问我，C++ 中的 OOP 真的是半生不熟。

编辑：好的，所以我想更多的细节是有序的。假设你有：类 Foo 和类 Blah。Blah 类引用 Foo 类，Foo 类引用 Blah 类。假设你走的是天真的路线，你可能会像这样实现它：

```
#include <blah.h>
class Foo {
    Blah blah;
    ...
} 
```

和废话：

```
#include <foo.h>
class Blah {
     Foo foo;
     ...
} 
```

那可能行不通。相反，您需要使用前向引用，即 Foo 变为：

```
class Blah;

class Foo {
    Blah blah;
    ...
} 
```

如果您对“C++ 中的循环引用”进行一些谷歌搜索，您就会明白我在这个问题中提到它的原因。现在停止投票给我好吗...

# sql - Delphi DBExpress/Firebird 参数化查询中的字符串截断错误

> ID：391348
> 
> 赞同：2
> 
> 时间：2008-12-24T12:28:53.020
> 
> 标签：sql, delphi, firebird, dbexpress

我在 Delphi 中有一个使用 DBExpress TSQLQuery 的查询，看起来像这样

```
ActiveSQL.sql.add('SELECT * FROM MYTABLE where MYFIELD=(:AMYFIELD) ');

ActiveSQL.ParamByName('AMYFIELD').AsString    := 'Some random string that is to long for the field';

ActiveSQL.Open; 
```

如果我运行它，当它执行 open 命令时，我会收到以下异常

> 在类 TDBXError 中，带有消息“算术异常、数字溢出或字符串截断”。

这是由于 AMYFIELD 中的字符串比表字段长度长，MYFIELD 是 Varchar(10)，如果我将其修剪为较短的字符串，它可以正常工作，如果我像这样直接将字符串添加到 SQL 中

```
 ActiveSQL.sql.add('SELECT * FROM MYTABLE where MYFIELD="Some random string that is to long for the field" '); 
```

它工作正常，即不会抱怨截断，现在如果这是插入/更新，我想知道截断，但由于它只是用于搜索，我想停止它。

有什么办法可以告诉 DBExpress 可以截断我的字符串？或者是否有可行的解决方法

我想避免添加类似的东西

l_input := 复制(l_input,0,fieldLength-1);

因为看起来很乱，并且会使维护代码更加困难。

如果有帮助，我正在通过 interbase 驱动程序将 Delphi 2007 与 Firebird 2 一起使用？

更新：

@Erick [Sasse](https://stackoverflow.com/questions/391348/string-truncation-error-in-delphi-dbexpress-paramatised-queries#393694)看起来像你的权利，我在火鸟常见问题解答网站[http://www.firebirdfaq.org/faq79/上找到了错误消息](http://www.firebirdfaq.org/faq79/)

@ [inzKulozik](https://stackoverflow.com/questions/391348/string-truncation-error-in-delphi-dbexpress-paramatised-queries#392779) LeftStr 工作正常，虽然我无法让 ActiveSQL.ParamByName('AMYFIELD').Size 工作，但这对我来说仍然很乱，而且更难维护。

我还看到了一种将 substr 添加到 SQL 的方法：类似于

```
select * from mytable where myname = substr(:MYNAME,0,10) 
```

再次看起来更难维护，理想情况下，我想要一个 Firebird/DBExpress 配置设置来解决这个问题，但在我找到一个之前，我会使用 inzKulozik 的解决方案，并希望表结构不会发生太大变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T12:24:07.273

```
l_input := copy(l_input,**0**,fieldLength-1); 
```

您不能从位置 0 复制子字符串！

试试这个：

```
l_input := LeftStr(l_input, fieldLength); 
```

或者

```
ActiveSQL.ParamByName('AMYFIELD').AsString := LeftStr('Some random string that is to long for the field', ActiveSQL.ParamByName('AMYFIELD').Size); 
```

或者

```
with ActiveSQL.ParamByName('AMYFIELD') do
  AsString := LeftStr('Some random string that is to long for the field', Size); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T11:24:27.503

此错误消息来自 Firebird，而不是 DBX。我认为 DBX 完全按照您输入的方式将参数发送到数据库，因此截断它应该是 Firebird 的工作。

# xaml - 为什么 XAML Width="Auto" 对我不起作用？

> ID：391363
> 
> 赞同：3
> 
> 时间：2008-12-24T12:44:04.147
> 
> 标签：xaml

我开始对一些写得不好的 XAML 进行维护。我对 XAML 比较陌生。

我需要的一件事是 - 网格列应该根据文本内容自动调整它们的宽度。

GridViewColumn.Width 上的 MSDN 文档说 - 将其设置为 Auto 以启用自动调整大小的行为。然而，即使代码如下所示，无论内容文本如何，列宽都保持不变。

```
<ListView.View>
<GridView>
<GridViewColumn x:Name="lstColName" Width="200">Name</GridViewColumn>
<GridViewColumn x:Name="lstColPath" Width="Auto">Path</GridViewColumn>
</GridView>
</ListView.View> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-08T19:36:21.357

仅当`GridView`模板或内部列集合更改时才重新计算列内容大小，这就是为什么`Width="Auto"`仅适用于加载`GridView`.

[这](http://leghumped.com/blog/2009/03/11/wpf-gridview-column-width-calculator/)是一篇关于解决方案的可能方法的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T12:55:51.330

自动工作正常，如下所示。

```
 <ListView>
        <ListView.View>
            <GridView>
                <GridViewColumn x:Name="Spoons" Width="Auto">

                </GridViewColumn>

            </GridView>
        </ListView.View>
    </ListView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-06T16:10:10.777

[这篇 David Hanson 博客文章包含另一个解决方案。](http://www.ontheblog.net/CMS/Home/tabid/36/EntryID/37/Default.aspx)

# php - 实用程序类上的phpunit警告

> ID：391390
> 
> 赞同：12
> 
> 时间：2008-12-24T13:18:22.173
> 
> 标签：php, phpunit

我在集成服务器上使用 phpUnit 来运行所有测试，如果我从命令行启动 phpunit 命令，我会收到：

```
PHPUnit 3.2.18 by Sebastian Bergmann.
F..III..I......I.IIII...
Time: 6 seconds
There was 1 failure:

1) Warning(PHPUnit_Framework_Warning)
No tests found in class "TU".
FAILURES
Tests: 24, Failures: 1, Incomplete: 9. 
```

通过 apache，运行相同的测试文件：

```
PHPUnit 3.2.18 by Sebastian Bergmann.
..III..I......I.IIII...
Time: 7 seconds

OK, but incomplete or skipped tests!
Tests: 23, Incomplete: 9. 
```

我的 TU 类只包含所有带有 a 的测试类`$suite->addTestFile()`，它们有两个静态函数：`main()`运行所有测试，以及`suite()`返回测试套件。但是 TU 类不在作为 phpunit 命令参数的主文件中，它是一个通用类，它扫描文件并列出所有测试类。

我对将 PHPUnit_Framework_TestCase 扩展为 add 的类有同样的问题，该类`specific assert()`不包含在 via 中，`$suite->addTestFile()`而仅包含在 a`require()`中。

我该如何纠正？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-30T10:14:54.287

对于扩展 PHPUnit_Framework_TestCase 的类，它应该是抽象的，并且警告消失。对于第一个问题，它似乎是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T14:23:58.313

看起来您正在`php.ini`为命令行和 Apache 使用两个不同的文件。

在大多数 unixoid 系统上，运行

```
diff /etc/php*/*/php.ini 
```

应该向您展示差异。

在 Windows 系统上，使用搜索查找名为`php.ini`. 在大多数情况下，您只需将 Apache 配置文件复制到 CLI 之一即可。

# c# - Castle Windsor to Unity - 你能像在 CW 中一样在 Unity 中自动配置吗？

> ID：391391
> 
> 赞同：6
> 
> 时间：2008-12-24T13:19:53.933
> 
> 标签：c#, dependency-injection, castle-windsor, unity-container

我不知道这是否是一个太具体的问题，如果可能的话，但我必须将使用 Castle Windsor 的应用程序移植到 Unity，这样就不会依赖非微软批准的库。我知道我知道，但你要做什么。

无论如何，我已经做到了，但我对我所拥有的并不满意。在温莎我有这个：

```
Register(
            AllTypes.Of(typeof(AbstractPresenter<>)).FromAssemblyNamed("Links.Mvp"),
            AllTypes.Of(typeof(IView)).FromAssemblyNamed("Links.WinForms").WithService.FromInterface()); 
```

我已经统一转换为这个

```
RegisterType<IMainView, MainView>();
        RegisterType<IConfigureLinkView, ConfigureLinkView>();
        RegisterType<IConfigureSourceView, ConfigureSourceView>();
        RegisterType<IConfigureSinkView, ConfigureSinkView>();
        RegisterType<MainPresenter, MainPresenter>();
        RegisterType<ConfigureLinkPresenter, ConfigureLinkPresenter>();
        RegisterType<ConfigureSourcePresenter, ConfigureSourcePresenter>();
        RegisterType<ConfigureSinkPresenter, ConfigureSinkPresenter>(); 
```

如您所见，我必须注册每一件事，而不是能够使用某种自动配置。所以我的问题是：有没有更好的统一方式来做到这一点？

谢谢，

亚当。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-08T09:55:52.853

看看[这个](http://autoregistration.codeplex.com/)：

```
 var container = new UnityContainer();

        container
            .ConfigureAutoRegistration()
            .LoadAssemblyFrom("Plugin.dll")
            .IncludeAllLoadedAssemblies()
            .ExcludeSystemAssemblies()
            .ExcludeAssemblies(a => a.GetName().FullName.Contains("Test"))
            .Include(If.Implements<ILogger>, Then.Register().UsingPerCallMode())
            .Include(If.ImplementsITypeName, Then.Register().WithTypeName())
            .Include(If.Implements<ICustomerRepository>, Then.Register().WithName("Sample"))
            .Include(If.Implements<IOrderRepository>,
                     Then.Register().AsSingleInterfaceOfType().UsingPerCallMode())
            .Include(If.DecoratedWith<LoggerAttribute>,
                     Then.Register()
                            .AsInterface<IDisposable>()
                            .WithTypeName()
                            .UsingLifetime<MyLifetimeManager>())
            .Exclude(t => t.Name.Contains("Trace"))
            .ApplyAutoRegistration(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-05T20:37:53.383

Unity 3 现在支持开箱即用的常规注册。

以下将注册所有具体实现并将其映射到遵循约定的接口： IFoo -> Foo

```
var container = new UnityContainer();
container.RegisterTypes(
    AllClasses.FromLoadedAssemblies(),
    WithMappings.MatchingInterface,
    WithName.Default); 
```

顺便说一句，如果具体类型类没有映射到不同的类型，则不需要注册具体类型类（就像 XXXPresenter 类一样）......如果类依赖于具体类型，Unity 将自动构建它。

您可以使用约定做更多的事情，例如过滤要使用的程序集或类型，或者如何完成映射，但我建议您查看 MSDN 中的示例，因为它们涵盖了其中的几个：

[http://msdn.microsoft.com/en-us/library/dn178463(v=pandp.30).aspx#sec23](http://msdn.microsoft.com/en-us/library/dn178463(v=pandp.30).aspx#sec23)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-25T05:46:06.593

凉爽的。此功能尚未统一，但如果您觉得有点野心，您可以设置自己的基于约定的注册。下面是一个适用于执行程序集和接口的片段。祝你好运。

PS这感觉就像一个大黑客，我可能会继续手动注册所有类型。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using System.Reflection;

namespace Forum
{
    class Program
    {
        static void Main(string[] args)
        {
            // get your assemblies and types you can register
            Assembly a = Assembly.GetExecutingAssembly();
            var types = a.GetTypes();            
            var bindTo = from t in types
                         where t.IsAbstract || t.IsInterface
                         select t;

            // apply your conventions to filter our types to be registered
            var interfacePairs = from t in bindTo.Where(x => x.IsInterface)
                                 let match = types.FirstOrDefault(x => x.Name ==     t.Name.Substring(1))
                                 where match != null
                                 select new Pair { To = t, From = match };
            var abstractPairs = new Pair[] {};

            // setup the generic form of the method to register the types
            var thisType = typeof(Program);
            var bindings = BindingFlags.Static | BindingFlags.Public;
            MethodInfo genericMethod = thisType.GetMethod("RegisterType", bindings);            

            // register all your types by executing the 
            // specialized generic form of the method
            foreach (var t in interfacePairs.Concat(abstractPairs))
            {
                Type[] genericArguments = new Type[] { t.To, t.From };
                MethodInfo method = genericMethod.MakeGenericMethod(genericArguments);
                method.Invoke(null, new object [] {});
            }

            Console.ReadKey();
        }

        public static void RegisterType<To, From>()
        {
            Console.WriteLine("Register { To: {0} From: {1} }", typeof(To), typeof(From));
        }

        // Test classes that should be picked up
        interface ITest { }
        class Test : ITest { }

        class Pair
        {
            public Type To { get; set; }
            public Type From { get; set; }
        }        
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-02T22:42:52.687

我只是偶然发现了这个问题，寻找有关 Windsor 的基于约定的注册的信息，虽然这是一个相当古老的问题，但我想我会为可能在 Unity 中寻找这种功能的其他人留下一个答案。

去年，我为 Unity 编写了一个基于约定的注册扩展，您可以在[此处](http://www.aspiringcraftsman.com/2009/06/convention-based-registration-extension/)阅读。实际下载可在[此处](http://code.google.com/p/conventionextension/)的 google 代码上找到。基本用法是：

```
 _container
        .Using<IConventionExtension>()
        .Configure(x =>
            {
                x.Conventions.Add<InterfaceImplementionNameMatchConvention>();
                x.Assemblies.Add(Assembly.GetExecutingAssembly());
            })
        .Register(); 
```

还有一个 ClosingTypeConvention 用于自动注册开放的泛型类型：

```
 _container
                .Using<IConventionExtension>()
                .Configure(x =>
                    {
                        x.Conventions.Add(new ClosingTypeConvention(typeof (IRepository<>)));
                        x.Assemblies.Add(Assembly.GetExecutingAssembly());
                    })
                .Register(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-30T09:09:54.667

AFAIK 在 Unity 中无法做到这一点。Unity 比 Windsor 更不成熟，架构更差，因此很多事情都更难/不可能。

# c# - 模拟 IEnumerable 的 GetEnumerator() 方法 类型

> ID：391411
> 
> 赞同：12
> 
> 时间：2008-12-24T13:36:02.760
> 
> 标签：c#, mocking, rhino-mocks

以下测试用例在 rhino 模拟中失败：

```
[TestFixture] 
    public class EnumeratorTest 
    { 
        [Test] 
        public void Should_be_able_to_use_enumerator_more_than_once() 
        { 
            var numbers = MockRepository.GenerateStub<INumbers>(); 
            numbers.Stub(x => x.GetEnumerator()).Return(new List<int> 
{ 1, 2, 3 }.GetEnumerator()); 
            var sut = new ObjectThatUsesEnumerator(); 
            var correctResult = sut.DoSomethingOverEnumerator2Times 
(numbers); 
            Assert.IsTrue(correctResult); 
        } 
    } 
    public class ObjectThatUsesEnumerator 
    { 
        public bool DoSomethingOverEnumerator2Times(INumbers numbers) 
        { 
            int sum1 = numbers.Sum(); // returns 6 
            int sum2 = numbers.Sum(); // returns 0 =[ 
            return sum1 + sum2 == sum1 * 2; 
        } 
    } 
    public interface INumbers : IEnumerable<int> { } 
```

我认为这个测试用例有一些非常微妙的地方，我认为这是因为我没有考虑过 Rhino Mocks 存根是如何工作的。通常，当您枚举一个 IEnumerable 时，您将从一个新的 IEnumerator 开始。在上面的示例中，看起来我可以在第二次调用 sum 时重新使用相同的枚举数，如果枚举数已经在其序列的末尾，这可以解释为什么第二次调用 Sum() 返回0\. 如果是这种情况，我如何模拟 GetEnumerator() 以使其按照我想要的方式运行（例如，新的枚举器或相同的枚举器重置到位置 0）？

**您将如何修改上述测试用例以使第二个 .Sum() 调用实际上返回 6 而不是 0？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-30T17:40:58.923

WhenCalled() api 允许您动态解析返回值。

将测试用例更改为以下内容将使其通过：

```
numbers.Stub(x => x.GetEnumerator())
                     .Return(null)
                     .WhenCalled(x => x.ReturnValue = 
                                    new List<int> { 1, 2, 3 }.GetEnumerator()
                                 ); 
```

因此，存根的行为将始终返回一个新的枚举器，而不是返回相同的枚举器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T20:15:40.257

该声明

```
numbers.Stub(x => x.GetEnumerator()).Return(new List<int> { 1, 2, 3 }.GetEnumerator()); 
```

等同于

```
var enumerator = new List<int> { 1, 2, 3 }.GetEnumerator();
numbers.Stub(x => x.GetEnumerator()).Return(enumerator); 
```

在您的测试中，您告诉 Rhino Mocks两次给出相同的`IEnumerator<int>`实例。`enumerator`那不是你想要的。单个实例`IEnumerator<int>`仅适用于一个枚举，而不适用于两个枚举（`Reset()`通常不支持）。您希望 Rhino Mocks 给出 的两个不同实例`IEnumerator<int>`，以便它们可以分别求和，就像对任何其他`GetEnumerator<int>()`函数的调用一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T14:44:15.370

*免责声明：我在 Typemock 工作*

我不知道您是否可以使用 Rhino 来执行此操作，但您可以将[Isolator](http://www.typemock.com/learn_about_typemock_isolator.html)与 AAA API 一起使用，这正是您正在寻找的 -

```
[Test] 
public void Should_be_able_to_use_enumerator_more_than_once() 
{
   var numbers = Isolate.Fake.Instance<INumbers>();
   Isolate.WhenCalled(() => numbers).WillReturnCollectionValuesOf(new List<int>{ 1, 2, 3 });
   var sut = new ObjectThatUsesEnumerator(); 
   var correctResult = sut.DoSomethingOverEnumerator2Times(numbers); 
   Assert.IsTrue(correctResult); 
} 
```

有关详细信息，请参阅开发人员指南中的[管理集合](http://www.typemock.com/Docs/UserGuide/newGuide/Documentation/ReplacingCollectionsAAA.html)。

# windows - 表单调整大小和最大化

> ID：391413
> 
> 赞同：1
> 
> 时间：2008-12-24T13:37:26.377
> 
> 标签：windows, resize, max, maximize

我阻止用户调整表单大小。如何删除最大化按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T13:46:05.470

如果你说的是winforms（.net），那么在设计器中右键单击表单并选择属性。确保在属性列表中关闭“MaximizeBox”。

如果是 MFC，则查找名为“控制框”的属性并将其关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T13:49:22.593

首先......为了能够调整（或不调整） FormBorderStyle 的大小，应该设置为正确的值。要不允许调整大小，请选择未显示“可调整大小”的选项之一。

然后，要删除右上角的控制按钮，请将值“MaximizeBox”或“MinimizeBox”设置为 false。您可以清除所有顶部按钮，将“ControlBox”设置为 false。

这些都是表单本身的属性。我不太确定属性的确切名称...

希望能帮助到你 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-25T03:08:29.563

您可能在谈论 .NET，但如果不是，并且您正在使用 windows API，您将在调用 CreateWindow 时指定它。像这样的东西：

```
hwnd = CreateWindow (szAppName, TEXT("Program Name"),
    WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_MINIMIZEBOX,
    ... 
```

应该给你一个不能调整大小的窗口。当你调用该方法而不是传递诸如 WS_OVERLAPPEDWINDOW 之类的东西时要具体。

# parsing - 开发一个简单的解析器

> ID：391432
> 
> 赞同：4
> 
> 时间：2008-12-24T13:44:22.277
> 
> 标签：parsing, bison, flex-lexer

我的日常工作包括开发一个类似 Pascal 的编译器。我一直致力于优化和代码生成。

我也想开始学习为同一种语言构建一个简单的解析器。但是，我不确定该怎么做。Flex 和 Bison 似乎是首选。但是，难道不能使用 C++ 或 C# 编写解析器吗？我对C有点毛骨悚然。

Yacc++ 支持 C#，但它是一个许可的。我正在寻找在这方面我能找到的所有帮助。建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-24T14:05:21.953

我相信您可以将 ANTLR 与 C# 一起使用。我自己（还）从未尝试过，但是这里有一个教程[可能](http://www.manuelabadia.com/blog/PermaLink,guid,ff1dc504-f854-40b4-bfe7-250ce91efad7.aspx)会为您指明正确的方向。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-24T14:59:31.283

就个人而言，我推出了自己的词法分析器和解析器 (LL)。这是一个非常简短的例子。它在 C++ 中，但希望你能适应它。它使用宏 PARSE_HIGHER 来轻松插入不同优先级的运算符，而无需更改太多代码。

```
 // routine to scan over whitespace/comments
void ScanWhite(const char* &pc){
  while(true){
    if(0);
    else if (WHITESPACE(*pc)) pc++;
    else if (pc[0]=='/' && pc[1]=='/'){
      while(*pc && *pc++ != '\n');
    }
    else break;
  }
}
// routine to lex an identifier
bool SeeId(const char* &pc, string sId){
  ScanWhite(pc);
  const char* pc0 = pc;
  if (alpha(*pc)){
    sId = "";
    while(alphanum(*pc)) sId += (*pc++);
    return true;
  }
  pc = pc0;
  return false;
}
// routine to lex a number
bool SeeNum(const char* &pc, double &dNum){
  ScanWhite(pc);
  const char* pc0 = pc;
  if (digit(*pc)){
    dNum = 0;
    while(digit(*pc)) dNum = dNum * 10 + (*pc++ - '0');
    if (*pc == '.'){
      double divisor = 1, frac = 0;
      while(digit(*pc)){
        divisor *= 0.1;
        frac += (*pc++ - '0') * divisor;
      }
      dNum += frac;
    }
    return true;
  }
  pc = pc0;
  return false;
}
// routine to lex some constant word
bool SeeWord(const char* &pc, const char* sWord){
  ScanWhite(pc);
  const char* pc0 = pc;
  int len = strlen(sWord);
  if (strncmp(pc, sWord, len)==0 && !alphanum(pc[len])){
    pc += len;
    return true;
  }
  pc = pc0;
  return false;
}
// routine to lex a single character like an operator
bool SeeChar(const char* &pc, const char c){
  ScanWhite(pc);
  const char* pc0 = pc;
  if (*pc == c){
    pc++;
    return true;
  }
  pc = pc0;
  return false;
}
// primitive expression parser
void ParsePrimitiveExpr(const char* &pc, CNode* &p){
  double dNum;
  char sId[100];
  if (0);
  else if (SeeNum(pc, dNum)){
    p = new CNode(dNum);
  }
  else if (SeeId(pc, sId)){
    // see if its a function call
    if (SeeChar(pc, '(')){
      p = MakeNewFunctionCallNode(sId);
      while(!SeeChar(pc, ')')){
        CNode* p1 = null;
        ParseExpression(pc, p1);
        AddArgumentExprToFunctionCallNode(p, p1);
        SeeChar(pc, ','); /* optional comma separator */
      }
    }
    // otherwise its just a variable reference
    else {
      p = new CNode(sId);
    }
  }
  // handle embedded expressions
  else if (SeeChar(pc, '(')){
    ParseExpression(pc, p);
    if (!SeeChar(pc, ')')) /* deal with syntax error */
  }
}
#define PARSE_HIGHER ParsePrimitiveExpr
// product parser
void ParseProduct(const char* &pc, CNode* &p){
  PARSE_HIGHER(pc, p);
  while(true){
    if (0);
    else if (SeeChar(pc, '*')){
      CNode p1 = null;
      PARSE_HIGHER(pc, p1);
      p = new CNode('*', p, p1);
    }
    else if (SeeChar(pc, '/')){
     CNode p1 = null;
     PARSE_HIGHER(pc, p1);
     p = new CNode('/', p, p1);
   }
   else break;
  }
}
#undef  PARSE_HIGHER
#define PARSE_HIGHER ParseProduct
// sum parser
void ParseSum(const char* &pc, CNode* &p){
  PARSE_HIGHER(pc, p);
  while(true){
    if (0);
    else if (SeeChar(pc, '+')){
      CNode p1 = null;
      PARSE_HIGHER(pc, p1);
      p = new CNode('+', p, p1);
    }
    else if (SeeChar(pc, '-')){
      CNode p1 = null;
      PARSE_HIGHER(pc, p1);
      p = new CNode('-', p, p1);
    }
   else break;
  }
}
#undef  PARSE_HIGHER
// can insert more routines like the above
// to handle move operators
#define PARSE_HIGHER ParseSum
// overall expression parser
void ParseExpression(const char* &pc, CNode* &p){
  PARSE_HIGHER(pc, p);
} 
```

添加了一些 Pascal 风格的语句语法：

```
void ParseStatement(const char* &pc){
  char sId[100];
  if(0);
  else if (SeeWord(pc, "begin")){
    while(!SeeWord(pc, "end")){
      ParseStatement(pc);
      SeeChar(pc, ';');
    }
  }
  else if (SeeWord(pc, "while")){
    CNode* p1 = null;
    ParseExpression(pc, p1);
    ParseStatement(pc);
    /* semantics for while statement */
  }
  else if (SeeWord(pc, "if")){
    CNode* p1 = null;
    ParseExpression(pc, p1);
    ParseStatement(pc);
    if (SeeWord(pc, "else")){
      ParseStatement(pc);
    }
    /* semantics for if statement */
  }
  else if (SeeWord(pc, "for")){
    /* you do it */
  }
  // handle assignments and subroutine calls
  else if (SeeId(pc, sId)){
    if(0);
    else if (SeeChar(pc, '=')){
      CNode* p1 = null;
      ParseExpression(pc, p1);
      /* semantics for assignment statement */
    }
    else if (SeeChar(pc, '(')){
      CNode* p = MakeNewFunctionCallNode(sId);
      while(!SeeChar(pc, ')')){
        CNode* p1 = null;
        ParseExpression(pc, p1);
        AddArgumentExprToFunctionCallNode(p, p1);
        SeeChar(pc, ','); /* optional comma separator */
      }
    }
    else {
      /* we have a 1-word statement, which is OK in pascal */
    }
  }
  else {
    /* syntax error */
  }
} 
```

它仍然需要数组索引、变量声明和函数定义的语法，但我希望清楚如何做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-27T05:45:31.477

在他的经典编程文本*Algorithms + Data Structures = Programs*中，Niklaus Wirth 为一种简单的类似 Pascal0 的语言开发了一个完整的递归下降解析器（在 Pascal 中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T13:47:56.280

如果您使用 Java 编写它，我会推荐 ANTLR。这是一个用 Java 编写的不错的 LL(*) 解析器生成器。亚马逊上也有一本很棒的书。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T13:48:35.357

bison & flex 是规范的解析器生成器。如果您对 C++ 感兴趣，我发现[boost spirit](http://spirit.sourceforge.net "振奋精神")很有用。不过，我从来没有将它用于像编译器这样复杂的东西。我相信其他人会对其他语言（例如 C#）提出有趣的建议...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T14:02:08.247

您实际上可以在 C++ 中使用 flex & bison。例如，在[本教程](http://ds9a.nl/lex-yacc/cvs/output/lexyacc.html)中，您可以看到第 5 节专门讨论这个问题。只需 google 一下，我相信你会找到很多例子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-24T14:18:07.903

当您使用 Lex 和 Yacc 时，您实际上并没有用 C 编写任何东西[。Lex](http://westes.github.io/flex/manual/)是它自己的语言，Yacc 也是如此。因此，您在 Lex 中编写词法分析器，在[Yacc](http://www.gnu.org/software/bison/manual/html_mono/bison.html)中编写解析器。但是，对于 Pascal，Lex 和 Yacc 输入[已经可用](http://www.moorecad.com/standardpascal/yacclex.html)。

生成的解析器和词法分析器具有 C 接口，这是真的。然而，包括 C++ 在内的大多数语言都有调用（或包装）C 接口的简单方法。

我不是这方面的专家，但我确信以上所有内容也适用于 ANTLR。

如果您要求在“纯 C++”（无论这意味着什么）中执行此操作，请考虑使用 boost [spirit](http://spirit.sourceforge.net/)。如果它导致更多的工作，我真的不明白理论上的纯度有什么意义。

手动编写自己的词法分析器和解析器实际上很有趣。词法分析器是极少数可以同时使用**goto**和预处理器的情况之一。但是，如果可以避免的话，我不建议将它用于像 Pascal 这样的成熟语言。那将是很多工作。我说的是人年。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-24T19:36:58.493

我用 flex 和 bison 编写了一个 XSLT 解析器。不过，最近我正在使用 ANTLR 做一个项目：

[JFig 语言语法是否高效且清晰（并且比 Spring-Framework 的 XML DSL 更好）？](https://stackoverflow.com/questions/384890/is-jfig-language-syntax-efficient-and-clear-and-better-than-spring-frameworks-x)

比起 Flex 和 Bison，我更喜欢在 ANTLR 工作。ANTLR 在某些方面使您处于更高的抽象级别。词法定义和解析器语法都可以放在一个文件中。（ANTLR 将生成令牌文件。）

关键项目之一是定义树语法的能力。基本上，您对输入语言进行语法分析，并执行重写为高度优化的 AST 树输出的操作（在内存中保留为链接数据结构）。然后，您可以将此树传递给在单独的树解析器文件中定义的另一个解析器。树解析器是您执行所需操作项的实际工作的地方。

这是一种很好的方法，因为您可以保留 AST 表单并根据需要反复对其进行重新处理——根据后面的操作等剥离特定的子树节点以进行处理。想想像语言解释器这样的东西。无需进入 for 循环并一遍又一遍地从头开始处理语言，只需处理它的 AST 表示即可。

在我的例子中，我设计了一个 bean factory 来进行 IoC 依赖注入。我的 bean 工厂在运行时保留 bean 描述符的 AST。当它需要创建（或检索）一个新的 bean 实例时，我只需将 bean 描述符 AST 子树传递给我的树解析器 - 结果是所需的 bean 实例（有很多因素决定如何实例化请求的 bean，包括制作任何其他被引用的 bean 和/或通过元属性应用其他特殊行为）。

最后，我当前的 bean factory 以 Java 为目标，但我想以 ActionScript3 和 C# .NET 为目标。ANTLR 支持这样做。

如前所述，Terrence Parr 写了一本关于如何使用 ANTLR 的书。它面向需要使用 ANTLR 做一些实际事情的工作程序员（而不是对该主题的学术处理）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-02T00:30:58.493

如果您按照这个[问题](https://stackoverflow.com/questions/269256/is-there-a-modern-e-g-clr-replacement-for-bison-yacc)想要 C#，请尝试 Gardens Point GPPG 和 GPLEX。

# asp.net-mvc - 你会使用这个 ASP.NET MVC 视图语法吗？

> ID：391438
> 
> 赞同：1
> 
> 时间：2008-12-24T13:48:16.950
> 
> 标签：asp.net-mvc

[我在这个问题](https://stackoverflow.com/questions/390693/does-anyone-beside-me-just-not-get-aspnet-mvc#391382)中提出了我认为更好的 ASP.NET MVC 视图语法。由于该问题已被回答，我认为我的回答将产生很少的反馈，因此我将其作为自己的问题发布在这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T14:14:49.203

您正在使用标记来表示代码。我的观点是：在需要代码的地方，就用代码，这样总是更灵活。在需要标记的地方，使用标记。 [这篇文章](http://www.defmacro.org/ramblings/lisp.html)准确地解释了我的观点。不过，有时代码和标记之间的界限是模糊的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T15:43:40.460

我真的希望人们不再将 XML 视为一种编程语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T17:33:00.630

也许您应该改用[这种](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/)称为 HAML 的“MVC 语法”。

```
%h2= Model.CategoryName
%ul
  - foreach (var product in Model.Products)
    %li
      = product.ProductName 
      .editlink
        = Html.ActionLink("Edit", new { Action="Edit", ID=product.ProductID })
= Html.ActionLink("Add New Product", new { Action="New" }) 
```

替换

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" 
    CodeBehind="List.aspx" Inherits="MvcApplication5.Views.Products.List" Title="Products" %>
<asp:Content ContentPlaceHolderID="MainContentPlaceHolder" runat="server">
 <h2><%= ViewData.Model.CategoryName %></h2>
  <ul>
    <% foreach (var product in ViewData.Model.Products) { %>
      <li>
        <%= product.ProductName %> 
        <div class="editlink">
          (<%= Html.ActionLink("Edit", new { Action="Edit", ID=product.ProductID })%>)
        </div>
      </li>
    <% } %>
  </ul>
  <%= Html.ActionLink("Add New Product", new { Action="New" }) %>
</asp:Content> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T16:20:33.053

你走在正确的轨道上，但我认为你走得太远了。平衡是将代码与其流动的 html 混合在一起，而不是过度复杂化，也不会创建标签汤。我发现的最好的视图引擎是[Spark](http://dev.dejardin.org/)。

看看它，你会发现它以一种更微妙和更易读的方式解决了你提出的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T16:41:15.773

还要看看 JSP：他们不得不引入一种“表达语言”，以便在 jsp 标记中获得一些代码的力量。结果真的很尴尬恕我直言。它甚至需要一个显式映射（当然是在 XML 中）才能从这个表达式语言访问一个简单的函数。

看到[这个](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPIntro7.html)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-12-24T16:07:49.303

除了 maucsch 和 matt 的观点之外，这是否也意味着服务器必须加载到内存中并解析整个页面以查找“mvc:”？这难道不是不使用网络表单的原因之一吗？

# html - 怎么做 可调整大小？

> ID：391440
> 
> 赞同：40
> 
> 时间：2008-12-24T13:48:46.510
> 
> 标签：html, css, drag-and-drop, resize

有没有办法`<div>`通过拖放来调整容器的大小？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-12-24T16:35:56.017

最好的方法是使用 CSS3。它至少受到 Webkit 和 Gecko 的支持。

根据[w3c 规范](http://www.w3.org/TR/css3-ui/#resize)：

```
div.my_class {
    resize:both;
    overflow:auto; /* something other than visible */
} 
```

Webkit 和 Firefox 不会以相同的方式解释规范。在 Webkit 中，大小仅限于设置的宽度和高度。还有另一个问题：[如何使用 CSS 使元素的尺寸调整为小于初始尺寸？](https://stackoverflow.com/questions/18178301/how-can-i-use-css-resize-to-resize-an-element-to-a-height-width-less-than-init)关于这个。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-02-19T15:08:18.210

```
div {
  border: 1px solid black;
}

.resizable-content {
  min-height: 30px;
  min-width: 30px;
  resize: both;
  overflow: auto;
  max-height: fit-content;
  max-width: fit-content;
}
```

```
<div class="resizable-content">Resize Me!</div>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-07T18:33:26.557

CSS3-only 方法的问题是只有 div 的右下角变成可拖动的。在尝试通过从 Stack Overflow 复制代码片段来尝试做到这一点之后，我强烈建议在您的项目中使用优秀的[InteractJS JavaScript 库。](https://interactjs.io)它允许您轻松创建一个可调整大小（和可拖动）的 div，该 div 可以从各个方面调整大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-17T08:26:25.153

如果您需要为*mustberesizeable* **tags**数组中的每个标签（也是 <div>）执行一些函数***doOnResize(tag)***，您可以简单地将这个数组复制到**window**的一个：

 *****```
window[WIN_RESIZED] = [] // init the window's array
for (var i in tags) {      
  window[WIN_RESIZED].push(tags[i])
} 
```

在那之后

```
window.addEventListener('resize', function(e){
  for (var i in window[WIN_RESIZED]) {
    doOnResize(window[WIN_RESIZED][i])
  }
}) 
```

必须写在开头的某个地方

```
const WIN_RESIZED = 'move_resized_divs' 
```

具有任意名称，例如“ *move_resized_divs* ”

# asp.net - ASP.NET GridView 对计算字段进行排序

> ID：391450
> 
> 赞同：2
> 
> 时间：2008-12-24T13:52:11.713
> 
> 标签：asp.net, gridview

我有一个 DataBound GridView。但是，我有一列的值来自后面代码中的计算 - 它显示在 TemplateField 中。

如何根据这个计算值对我的网格进行排序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-24T14:06:32.043

将您最初返回的数据放入 DATASET 或 DATATABLE。为您的计算字段添加一个新列到 DATATABLE。遍历该数据进行必要的计算，并将结果放入所述计算字段。

根据数据表创建新视图，并按计算字段对视图进行排序。将网格绑定到数据视图。

```
Dim DT as DataTable 
DT = GetDataTableFromDataBaseMethod()
DT.Columns.Add(New DataColumn("CalculatedColumnName"))
For each row as DataRow in DT.Rows
    row("CalculatedColumnName") = PerformCalculations(row)
Next 

Dim view as New DataView 
view.DataTable =dt 
View.Sort = "CalculatedColumnName DESC"

datagrid1.Datasource = view
datagrid1.Databind 
```

或者，如果可能，在 SQL 语句中执行计算，重新：

```
SELECT Col1, Col2, Col3, Col1+Col2+Col3 AS LineTotal FROM Table; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T14:05:15.713

一种可能的解决方案是填充数据表而不是绑定网格。然后使用将排序设置为计算列的数据视图，并将其绑定到后面代码中的网格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:17:48.847

Another solution is to consider is adding calculated column to the database table itself. This has the benefit of returning the calculated column in the same SQL expression that loads the rest of the row, but unfortunately does require changing the database schema.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T12:17:59.117

Note that adding a column to the datatable will mark all rows as updated, so when saving back to the database, it will try to update all records.

# c# - 在 C# 中，var 关键字何时与键入不同？

> ID：391462
> 
> 赞同：2
> 
> 时间：2008-12-24T13:59:45.473
> 
> 标签：c#, var

C# 3.0 引入了`var`关键字。编译后，编译器将为您插入正确的类型。这意味着它甚至可以在 2.0 运行时上运行。到现在为止还挺好。但是前几天我发现了一个案例，`var`关键字将被替换为只是对象，因此不够具体。假设你有类似的东西：

```
var data = AdoMD.GetData(...); // GetData returns a DataTable

foreach (var row in data.Rows)
{
     string blah = (string)row[0]; // it fails since it's of type object
} 
```

当我尝试使用行时，[IntelliSense](http://en.wikipedia.org/wiki/IntelliSense)和编译器都告诉我它是对象类型。`data.Rows`是类型`System.Data.DataRowCollection`。以下作品：

```
var data = AdoMD.GetData(...); // GetData returns a DataTable

foreach (DataRow row in data.Rows)
{
     string blah = (string)row[0]; // works since it now has the right type
} 
```

这不是关于 var 使用的问题，这里有一个[线程](https://stackoverflow.com/questions/41479/use-of-var-keyword-in-c)。

我正在使用 Visual Studio 2008 SP1 顺便说一句。

编辑：现在附上正确的代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-30T16:57:31.227

我想我看到了问题。DataRowCollection 是非泛型的，因此编译器唯一知道的是它包含 Object 类型的对象。如果它是一个通用的数据结构，这将是可行的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T14:06:42.950

这：

```
using System;

namespace Test
{
    public class X
    {
        public String Bleh;
    }

    public class Y : X
    {
        public String Blah;
    }

    public static class Program
    {
        public static void Main()
        {
            var y = SomeFunctionThatReturnsY();
            // y. <-- this gives me both Blah and Bleh in the dropdown
        }

        public static Y SomeFunctionThatReturnsY()
        {
            return new Y();
        }
    }
} 
```

按预期工作，它让我在 Visual Studio 2008 中显示 Bleh 和 Blah 的智能感知。

你有类似的东西*，*或者*完全*是这样的吗？除了您显示的代码之外，可能还有其他事情会触发智能感知。

回答实际问题。拼出类型和使用 之间的唯一区别`var`是，在某些情况下，当您根本没有正确的类型时，您*必须使用 var。*如果我没记错的话，这仅在您使用匿名类型时才相关。

没有其他区别，编译器将在左侧选择与右侧相同的类型。

**编辑**：感谢[@Telos](https://stackoverflow.com/users/17145/telos)指出一个区别是，当使用 var 时，您当然必须在声明时给变量一个值，因为右侧表达式的类型用于指示左边的变量。在拼写类型时，您当然可以选择不给它一个值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T14:20:33.467

我的猜测是它`somethingThatReturnsY`实际上被*声明*为返回 X - 即使它在实践中返回 Y。我希望如果您声明`y`为`Y y = somethingThatReturnsY();`它将无法编译。

的规则`var`非常简单（对于它有效的情况 - 有各种限制阻止你这样做`var x = null;`等等。

如果您认为`var`确实做错了事，请发布一个简短但完整的程序来演示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T14:10:14.690

我试图在控制台应用程序中使用以下代码重现这一点。

```
class Program
{
    static void Main(string[] args)
    {
        var j = returny();
        j.blah();
    }

    private static y returny()
    {
        return new y();
    }
}

class x
{
}

class y : x
{
    public void blah() { }
} 
```

这可以按预期工作，IntelliSense 是正确的，并且[Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)显示它`j`的类型是`y`. 我的猜测是，如果您遇到可疑的事情，那么这里的简单情况会更复杂。

我也在使用 Visual Studio 2008 RTM。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-27T18:52:30.497

DataTable.Rows 返回实现 InternalDataCollectionBase 的 DataRowCollection，后者又实现 ICollection 和 IEnumerable。编码

```
foreach(DataRow row in dt.Rows) { } 
```

将 DataRowCollection 中的每个项目转换为 DataRow。您可以通过将其更改为来证明这一点

```
foreach(int row in dt.Rows) { } 
```

编译但抛出 InvalidCastException。

如果实现了 DataRowCollection `IEnumerable<DataRow>`，则不会编译，并且使用 var 会将列表中的每个对象键入为 DataRow。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T14:20:55.277

我不相信您在示例代码中提供了足够的信息。我做了一个小程序来尝试模仿你描述的行为：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        var y = SomeFunctionThatReturnsY();

        MessageBox.Show(y.bla);

        return;
    }

    private Y SomeFunctionThatReturnsY()
    {
        return new Y();
    }
}

internal class X { }

internal class Y : X
{
    public string bla = "Saw a Y, not an X";
} 
```

但是输出清楚地表明 var 正在解析 Y 类型，而不是 X。

您确定您的函数返回 Y 作为 Y 引用，而不是作为 X 引用吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T17:08:29.847

它可以正常工作。当编译器无法确定正确的数据类型时，它将对象类型作为“对象”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-27T18:37:08.253

当您使用 foreach 关键字时，可以通过 IEnumerable 接口访问 DateRowCollection。用于访问 DataRow 的特定方法称为 Current 并返回一个对象。所以 var 关键字是查看 Current 方法的返回值来推断类型。

# oop - 抽象方法和虚拟方法有什么区别？

> ID：391483
> 
> 赞同：1676
> 
> 时间：2008-12-24T14:11:43.377
> 
> 标签：oop, language-agnostic, abstract, virtual-functions

抽象方法和虚拟方法有什么区别？在哪些情况下建议使用抽象或虚拟方法？哪一个是最好的方法？

* * *

## 回答 #1

> 赞同：2857
> 
> 时间：2008-12-24T14:14:19.673

**抽象函数不能具有功能。**你基本上是在说，任何子类都必须给出他们自己的这个方法版本，但是它太笼统了，甚至无法在父类中实现。

**一个虚函数**，基本上是说看，这里的功能可能对子类来说可能不够好，也可能不够好。所以如果足够好，就用这个方法，如果不行，那就覆盖我，提供你自己的功能。

* * *

## 回答 #2

> 赞同：323
> 
> 时间：2008-12-24T14:19:39.820

抽象函数没有实现，只能在抽象类上声明。这迫使派生类提供实现。

虚函数提供默认实现，它可以存在于抽象类或非抽象类中。

例如：

```
public abstract class myBase
{
    //If you derive from this class you must implement this method. notice we have no method body here either
    public abstract void YouMustImplement();

    //If you derive from this class you can change the behavior but are not required to
    public virtual void YouCanOverride()
    { 
    }
}

public class MyBase
{
   //This will not compile because you cannot have an abstract method in a non-abstract class
    public abstract void YouMustImplement();
} 
```

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2009-04-16T09:03:40.930

1.  只有`abstract`类可以有`abstract`成员。
2.  `abstract`从类继承的非`abstract`类**必须** `override`是它的`abstract`成员。
3.  一个`abstract`成员是隐式的`virtual`。
4.  `abstract`成员不能提供任何实现（在某些语言`abstract`中调用）。`pure virtual`

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2008-12-24T14:13:32.793

您必须始终覆盖抽象函数。

因此：

*   **抽象函数**——当**继承者必须提供自己的实现时**
*   **虚拟**-**由继承人决定**

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2014-05-28T07:52:37.670

抽象功能：

1.  它只能在抽象类中声明。
2.  它只包含方法声明而不包含抽象类中的实现。
3.  它必须在派生类中被覆盖。

虚拟功能：

1.  它可以在抽象类和非抽象类中声明。
2.  它包含方法实现。
3.  它可能会被覆盖。

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2016-06-16T01:01:45.913

解释：用比喻。希望它会帮助你。

**语境**

我在一栋大楼的 21 楼工作。我对火很偏执。时不时地，在世界的某个地方，一场大火正在烧毁一座摩天大楼。但幸运的是，我们这里有一本关于发生火灾时该怎么做的说明手册：

**火灾逃生（）**

1.  不要收集物品
2.  步行到消防通道
3.  走出大楼

这基本上是一个名为**FireEscape()的虚拟方法**

**虚方法**

这个计划在 99% 的情况下都很好。这是一个有效的基本计划。但是有 1% 的可能性是火灾逃生通道被阻塞或损坏，在这种情况下你完全被搞砸了，除非你采取一些激烈的行动，否则你会被烤焦。使用虚拟方法，您可以做到这一点：您可以使用您自己的计划版本覆盖基本 FireEscape() 计划：

1.  运行到窗口
2.  跳出窗外
3.  安全降落伞到底部

换句话说*，虚拟方法提供了一个基本计划，如果您需要，可以将其覆盖*。如果程序员认为合适，子类可以覆盖父类的虚方法。

**抽象方法**

并非所有组织都经过良好训练。一些组织不进行消防演习。他们没有整体的逃生政策。每个人都是为自己。管理层只对现有的这种政策感兴趣。

换句话说，每个人都*被迫*开发自己的 FireEscape() 方法。一个人会走出防火梯。另一个人会跳伞。另一个人将使用火箭推进技术飞离建筑物。另一个人将绕道而行。只要你有一个基本的 FireEscape() 计划，管理层并不关心你*如何逃生——如果他们没有，你可以保证 OHS 会像一吨砖头一样打击组织。*这就是抽象方法的含义。

**两者又有什么区别？**

抽象方法：子类***被迫***实现自己的 FireEscape 方法。使用虚拟方法，您有一个基本计划等着您，但如果不够好，您可以选择*实施您自己的计划。*

现在这不是那么难，是吗？

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2009-04-16T09:03:07.513

抽象方法：当一个类包含一个抽象方法时，该类必须声明为抽象。抽象方法没有实现，因此从该抽象类派生的类必须为此抽象方法提供实现。

虚方法：一个类可以有一个虚方法。虚方法有一个实现。当您从具有虚拟方法的类继承时，您*可以*覆盖该虚拟方法并提供额外的逻辑，或者用您自己的实现替换该逻辑。

什么时候使用什么：在某些情况下，你知道某些类型应该有一个特定的方法，但是，你不知道这个方法应该有什么实现。
在这种情况下，您可以创建一个包含具有此签名的方法的接口。但是，如果您有这种情况，但您知道该接口的实现者还将有另一个通用方法（您已经可以为其提供实现），您可以创建一个抽象类。然后这个抽象类包含抽象方法（必须被覆盖）和另一个包含“通用”逻辑的方法。

如果您有一个可以直接使用的类，但您希望继承者能够更改某些行为，则应该使用虚拟方法，尽管这不是强制性的。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2009-04-16T09:13:27.270

抽象方法是必须实现才能创建具体类的方法。声明在抽象类中（任何具有抽象方法的类都必须是抽象类），并且必须在具体类中实现。

虚拟方法是可以在派生类中使用覆盖覆盖的方法，**替换**超类中的行为。如果您不覆盖，您将获得原始行为。如果你这样做，你总是会得到新的行为。这与非虚拟方法相反，它不能被覆盖但可以隐藏原始方法。这是使用`new`修饰符完成的。

请参见以下示例：

```
public class BaseClass
{
    public void SayHello()
    {
        Console.WriteLine("Hello");
    }

    public virtual void SayGoodbye()
    {
        Console.WriteLine("Goodbye");
    }

    public void HelloGoodbye()
    {
        this.SayHello();
        this.SayGoodbye();
    }
}

public class DerivedClass : BaseClass
{
    public new void SayHello()
    {
        Console.WriteLine("Hi There");
    }

    public override void SayGoodbye()
    {
        Console.WriteLine("See you later");
    }
} 
```

当我实例化`DerivedClass`并调用`SayHello`, or`SayGoodbye`时，我得到“Hi There”和“See you later”。如果我打电话`HelloGoodbye`，我会得到“你好”和“稍后见”。这是因为`SayGoodbye`是虚拟的，可以用派生类代替。`SayHello`只是隐藏的，所以当我从我的基类调用它时，我得到了我的原始方法。

抽象方法是隐式虚拟的。它们定义了必须存在的行为，更像是一个接口。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-04-16T09:00:52.323

抽象方法总是虚拟的。他们不能有一个实现。

这是主要的区别。

基本上，如果您有它的“默认”实现并希望允许后代更改其行为，您将使用虚拟方法。

使用抽象方法，您可以强制后代提供实现。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2011-12-07T09:14:23.927

我通过对以下类进行一些改进（来自其他答案）使这变得更简单：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace TestOO
{
    class Program
    {
        static void Main(string[] args)
        {
            BaseClass _base = new BaseClass();
            Console.WriteLine("Calling virtual method directly");
            _base.SayHello();
            Console.WriteLine("Calling single method directly");
            _base.SayGoodbye();

            DerivedClass _derived = new DerivedClass();
            Console.WriteLine("Calling new method from derived class");
            _derived.SayHello();
            Console.WriteLine("Calling overrided method from derived class");
            _derived.SayGoodbye();

            DerivedClass2 _derived2 = new DerivedClass2();
            Console.WriteLine("Calling new method from derived2 class");
            _derived2.SayHello();
            Console.WriteLine("Calling overrided method from derived2 class");
            _derived2.SayGoodbye();
            Console.ReadLine();
        }
    }

    public class BaseClass
    {
        public void SayHello()
        {
            Console.WriteLine("Hello\n");
        }
        public virtual void SayGoodbye()
        {
            Console.WriteLine("Goodbye\n");
        }

        public void HelloGoodbye()
        {
            this.SayHello();
            this.SayGoodbye();
        }
    }

    public abstract class AbstractClass
    {
        public void SayHello()
        {
            Console.WriteLine("Hello\n");
        }

        //public virtual void SayGoodbye()
        //{
        //    Console.WriteLine("Goodbye\n");
        //}
        public abstract void SayGoodbye();
    }

    public class DerivedClass : BaseClass
    {
        public new void SayHello()
        {
            Console.WriteLine("Hi There");
        }

        public override void SayGoodbye()
        {
            Console.WriteLine("See you later");
        }
    }

    public class DerivedClass2 : AbstractClass
    {
        public new void SayHello()
        {
            Console.WriteLine("Hi There");
        }
        // We should use the override keyword with abstract types
        //public new void SayGoodbye()
        //{
        //    Console.WriteLine("See you later2");
        //}
        public override void SayGoodbye()
        {
            Console.WriteLine("See you later");
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-08-13T20:06:43.573

**绑定**是将名称映射到代码单元的过程。

**后期绑定**意味着我们使用名称，但延迟映射。换句话说，我们首先创建/提及名称，然后让一些后续进程处理代码到该名称的映射。

现在考虑：

*   与人类相比，机器非常擅长搜索和分类
*   与机器相比，人类真的很擅长发明和创新

因此，简短的回答是：`virtual`是机器（运行时）`abstract`的后期绑定指令，而人类（程序员）是后期绑定指令

换句话说，`virtual`意味着：

“亲爱的**运行时**，通过做你最擅长的事情将适当的代码绑定到这个名称：*搜索*”</p>

鉴于`abstract`：

“亲爱的**程序员**，请通过做你最擅长的事情将适当的代码绑定到这个名字：*发明*”</p>

为了完整起见，*重载*意味着：

“亲爱的**编译器**，通过做你最擅长的事情将适当的代码绑定到这个名称：*排序*”。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-16T09:02:26.923

当您希望继承者根据需要扩展功能时，您基本上使用虚拟方法。

当您希望继承者实现功能时使用抽象方法（在这种情况下他们别无选择）

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-03-25T17:26:46.703

**虚拟方法**：

*   *虚拟意味着我们可以覆盖它。*

*   虚函数有一个实现。当我们继承类时，我们可以覆盖虚函数并提供我们自己的逻辑。

*   我们可以在子类中实现函数的同时改变虚函数的返回类型
    （可以说是
    Shadowing的一个概念）。

**抽象方法**

*   *抽象意味着我们必须覆盖它。*

*   抽象函数没有实现，必须在抽象类中。

*   它只能被声明。这迫使派生类提供它的实现。

*   抽象成员是隐式虚拟的。在某些语言中，抽象可以称为纯虚拟。

    ```
    public abstract class BaseClass
    { 
        protected abstract void xAbstractMethod();

        public virtual void xVirtualMethod()
        {
            var x = 3 + 4;
        }
    } 
    ```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-08-05T20:45:43.143

我在某些地方看到了抽象方法的定义如下。**

> **“必须在子类中实现抽象方法”**

** 我觉得它就像。

**如果子类也是抽象的**，则不必在子类中实现抽象方法。

1）抽象方法**不能**是私有方法。2）一个抽象方法**不能**在同一个抽象类中实现。

我想说..如果我们正在实现一个抽象类，你必须重写基础抽象类的抽象方法。因为..实现抽象方法是用**重写**关键字.类似于Virtual方法。

**虚拟方法不必在继承的类中实现。**

```
 ----------CODE--------------

public abstract class BaseClass
{
    public int MyProperty { get; set; }
    protected abstract void MyAbstractMethod();

    public virtual void MyVirtualMethod()
    {
        var x = 3 + 4;
    }

}
public abstract class myClassA : BaseClass
{
    public int MyProperty { get; set; }
    //not necessary to implement an abstract method if the child class is also abstract.

    protected override void MyAbstractMethod()
    {
        throw new NotImplementedException();
    }
}
public class myClassB : BaseClass
{
    public int MyProperty { get; set; }
    //You must have to implement the abstract method since this class is not an abstract class.

    protected override void MyAbstractMethod()
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-05-06T00:48:23.907

上面的大多数示例都使用代码 - 它们非常非常好。我不需要添加他们所说的内容，但以下是使用类比而不是代码/技术术语的简单解释。

**简单的解释 - 使用类比的解释**

**抽象方法**

想想乔治·W·布什。他对他的士兵说：“去伊拉克打仗”。就是这样。他所指定的只是必须进行战斗。他没有具体说明这将*如何*发生。但我的意思是，你不能只是出去“打架”：这到底是什么意思？我用 B-52 还是我的 derringer 战斗？这些具体细节留给其他人。这是一种抽象方法。

**虚方法**

大卫彼得雷乌斯在军队中地位很高。他定义了战斗的含义：

1.  寻找敌人
2.  中和他。
3.  之后喝啤酒

问题是它是一种非常通用的方法。这是一种行之有效的好方法，但有时不够具体。彼得雷乌斯的好处是他的命令有余地和范围——他允许其他人根据他们的特殊要求改变他对“战斗”的定义。

Private Job Bloggs 阅读了彼得雷乌斯的命令，并被允许根据他的特殊要求实施他自己的战斗版本：

1.  寻找敌人。
2.  朝他的头部开枪。
3.  回家
4.  喝啤酒。

Nouri al Maliki 也收到了来自彼得雷乌斯的相同命令。他也要战斗。但他是政治家，不是步兵。显然，他不能四处射击他的政敌。因为彼得雷乌斯给了他一个虚拟的方法，那么马利基可以根据自己的具体情况，实现自己版本的战斗方法：

1.  寻找敌人。
2.  让他以一些 BS 捏造的罪名被捕。
3.  回家
4.  喝啤酒。

换句话说，虚拟方法提供样板指令 - 但这些是一般指令，可以由军队层级的人们根据他们的特定情况制定更具体的指令。

**两者的区别**

*   乔治布什没有证明任何实施细节。这必须由其他人提供。这是一种抽象方法。

*   另一方面，Petraeus*确实*提供了实施细节，但他已允许他的下属用他们自己的版本覆盖他的命令，如果他们能想出更好的东西的话。

希望有帮助。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-05-31T13:12:14.010

抽象函数（方法）：

● 抽象方法是用关键字abstract 声明的方法。

● 没有本体。

● 由派生类实现。

● 如果一个方法是抽象的，那么该类应该是抽象的。

虚函数（方法）：

● 虚方法是用关键字virtual 声明的方法，它可以被派生类方法用override 关键字覆盖。

● 是否覆盖它取决于派生类。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-08-19T10:28:31.413

答案已多次提供，但关于何时使用每个答案的问题是设计时的决定。我认为尝试将通用方法定义捆绑到不同的接口中并将它们拉入适当抽象级别的类中是一种很好的做法。当最好定义一个实现一组简洁接口的非抽象类时，将一组通用的抽象和虚拟方法定义转储到一个类中会使该类变得不可实例化。与往常一样，这取决于最适合您的应用程序特定需求的内容。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-01-12T17:17:10.797

**抽象函数**不能有主体，必须被子类覆盖

**虚函数**将有一个主体，并且可能会或可能不会被子类覆盖

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-03-01T10:35:20.740

从一般面向对象的角度来看：

**关于抽象方法**：当您将抽象方法放入父类时，实际上您是在对子类说：嘿，请注意，您有这样的方法签名。如果你想使用它，你应该实现你自己的！

**关于虚函数**：当您在父类中放置一个虚方法时，您对派生类说：嘿，这里有一个功能可以为您做一些事情。如果这对您有用，请使用它。如果没有，请覆盖它并实现您的代码，即使您可以在您的代码中使用我的实现！

这是一般OO中这两个概念之间不同的一些哲学

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-07-27T11:07:41.600

抽象函数“只是”一个签名，没有实现。它在接口中用于声明如何使用类。它必须在派生类之一中实现。

虚函数（实际上是方法）也是您声明的函数，应该在继承层次结构类之一中实现。

此类继承的实例也继承实现，除非您在较低层次的类中实现它。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-10-27T06:55:35.543

从 C++ 的背景来看，C# virtual 对应于 C++ virtual，而 C# abstract methods 对应于 C++ 纯虚函数

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-09-10T19:10:13.153

如果一个类派生自这个抽象类，那么它就会被强制覆盖这个抽象成员。这与 virtual 修饰符不同，它指定可以选择性地覆盖该成员。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-06-07T14:41:29.177

C# 中没有调用虚拟类。

对于函数

1.  抽象函数只有签名，驱动类应该用功能覆盖。
2.  虚函数将包含驱动器类可能会或可能不会根据要求覆盖它的部分功能

你可以根据你的要求来决定。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-06-05T12:38:45.130

抽象方法没有实现。它在父类中声明。子类负责实现该方法。

虚拟方法应该在父类中有一个实现，它有助于子类选择是使用父类的实现还是在子类中为自己的该方法有一个新的实现。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-02-24T00:36:35.107

**抽象函数或方法**是类公开的公共“操作名称”，其目的与抽象类一起，主要是在对象设计中针对对象必须实现的结构提供一种约束形式。

实际上，从其抽象类继承的类必须为此方法提供实现，通常编译器会在不这样做时引发错误。

使用抽象类和方法很重要，主要是为了避免在设计类时关注实现细节，类结构与实现过于相关，从而在它们之间协作的类之间产生依赖和耦合。

**虚函数或方法**只是模拟类的公共行为的方法，但我们可以在继承链中随意修改它，因为我们认为子类可能需要为该行为实现一些特定的扩展。

它们都代表了面向对象范式中的一种**多态性**。

我们可以一起使用抽象方法和虚函数来支持良好的继承模型。

我们为解决方案的主要对象设计了一个良好的抽象结构，然后通过定位那些更容易进一步专业化的对象来创建基本实现，并将它们作为虚拟对象，最后我们专门化我们的基本实现，最终“覆盖”继承的虚拟对象。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-03-02T12:50:32.630

在这里，我正在编写一些示例代码，希望这可能是一个相当有形的示例，可以在非常基本的层面上查看接口、抽象类和普通类的行为。如果您想将其用作演示，您也可以在 github 中找到此代码作为项目：[https ://github.com/usavas/JavaAbstractAndInterfaceDemo](https://github.com/usavas/JavaAbstractAndInterfaceDemo)

```
public interface ExampleInterface {

//    public void MethodBodyInInterfaceNotPossible(){
//    }
    void MethodInInterface();

}

public abstract class AbstractClass {
    public abstract void AbstractMethod();

    //    public abstract void AbstractMethodWithBodyNotPossible(){
    //
    //    };

    //Standard Method CAN be declared in AbstractClass
    public void StandardMethod(){
        System.out.println("Standard Method in AbstractClass (super) runs");
    }
}

public class ConcreteClass
    extends AbstractClass
    implements ExampleInterface{

    //Abstract Method HAS TO be IMPLEMENTED in child class. Implemented by ConcreteClass
    @Override
    public void AbstractMethod() {
        System.out.println("AbstractMethod overridden runs");
    }

    //Standard Method CAN be OVERRIDDEN.
    @Override
    public void StandardMethod() {
        super.StandardMethod();
        System.out.println("StandardMethod overridden in ConcreteClass runs");
    }

    public void ConcreteMethod(){
        System.out.println("Concrete method runs");
    }

    //A method in interface HAS TO be IMPLEMENTED in implementer class.
    @Override
    public void MethodInInterface() {
        System.out.println("MethodInInterface Implemented by ConcreteClass runs");

    //    Cannot declare abstract method in a concrete class
    //    public abstract void AbstractMethodDeclarationInConcreteClassNotPossible(){
    //
    //    }
    }
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-05-13T11:00:53.377

方法可以根据*义务*/缺乏和*权限*/缺乏来划分以覆盖它们：

*   **抽象（纯）/具体（不纯）：**必须被覆盖/不能被覆盖；
*   **虚拟/真实：**可以被覆盖/不能被覆盖。

所以根据定义，抽象方法只能是虚拟的，而真实的方法只能是具体的。

* * *

## 回答 #28

> 赞同：-4
> 
> 时间：2011-06-27T15:37:43.160

据我了解：

抽象方法：

只有抽象类可以保存抽象方法。派生类也需要实现该方法，并且类中没有提供实现。

虚拟方法：

一个类可以声明这些并提供相同的实现。派生类也需要实现方法来覆盖它。

# c# - 警告：页面已过期

> ID：391485
> 
> 赞同：4
> 
> 时间：2008-12-24T14:11:47.447
> 
> 标签：c#, back-button

我已将以下代码添加到我的母版页 (Page_Load)，因此一旦用户注销，他们将无法使用后退按钮查看他们之前所在的页面。

```
 Response.Buffer = true;
 Response.ExpiresAbsolute = DateTime.Now.AddDays(-1);
 Response.Expires = -1;
 Response.CacheControl = "no-cache"; 
```

问题是，我的用户希望能够在登录到应用程序时使用浏览器后退按钮。当我将代码注释掉以不缓存页面时，他们可以使用后退按钮，但一旦他们注销，他们可以使用后退按钮查看他们所在的上一页，这会导致安全风险。

有没有人有任何建议，以便他们可以使用应用程序中的浏览器后退按钮，但是一旦他们退出，他们就无法返回应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T14:22:55.133

目的是防止未经身份验证的用户偷偷访问以前使用的计算机并查看经过身份验证的用户在做什么？如果是后者，那么您应该将用户重定向到具有 window.close(); 的注销页面；命令以及关于这是一项**要求**的强有力的语言。现在，这不是铁定的：IE 会*询问*用户是否愿意让应用程序关闭窗口，而其他浏览器则完全忽略该请求。但是，在正确的安全环境中，我认为它确实为您的安全策略提供了重要的补充——尽管主要是文化多样性（它有助于文化成员遵守规则）。

如果您想要“一次性完成”类型的安全性，那么我担心锁定缓存或将“window.forward()”添加到每个页面（这会阻止所有使用后退按钮）是您的只有真正的选择。

另一件事：AJAX 也提供了一些有用的工具。您可以将敏感信息放在更新面板上，并让页面加载 javascript 触发更新面板刷新。由于这将始终返回到服务器，因此将拒绝未经身份验证/过期的用户。这是一个相当大的工作量，但我想我会把它扔在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T14:21:57.943

看：

*   [禁用浏览器上的后退按钮](https://stackoverflow.com/questions/87422/disabling-back-button-on-the-browser)
*   [一旦一个人注销但点击“返回”按钮，有没有办法阻止页面呈现？](https://stackoverflow.com/questions/64059/is-there-a-way-to-keep-a-page-from-rendering-once-a-person-has-logged-out-but-h)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:20:04.457

YUI 提供了一种轻松控制浏览器历史记录的方法，以编程方式将 URL 插入历史记录。看看 YUI[浏览器历史](http://developer.yahoo.com/yui/history/)管理器。

# .net - 您会在新项目中使用 LINQ to SQL 吗？

> ID：391486
> 
> 赞同：9
> 
> 时间：2008-12-24T14:13:10.113
> 
> 标签：.net, linq-to-sql, orm, linq-to-entities, data-access-layer

我一直在研究为我正在设计的新的基于 Web 的项目使用什么数据层，并且我非常热衷于将 LINQ 与 SQL 结合起来。它明显的简单性、灵活性和设计器支持确实很有吸引力，并且与 SQL Server 的隐式连接很好。

然而，最近宣布 LINQ to SQL 将退居到实体框架之后，因为它已被传递给 ADO.NET 团队 ( [http://blogs.msdn.com/adonet/archive/2008/10 /29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)）。当然，它会在未来得到支持，但不太可能看到更多的开发工作。

考虑到这一点，您会推荐我在我的项目中使用这项技术，还是值得选择替代 ORM（nHibernate？）或手动编写通用 DAL？

该项目本身是基于 ASP.NET 和 SQL Server 2005/2008 的，并且可能会使用 MVC，即使它仍处于测试阶段。这是一个个人项目，数据库不会过于复杂，主要用作看.NET未来技术的原型。不过，我会将未来的项目建立在我从这个项目中学到的东西上，所以我做出的选择会影响到更大的解决方案。

是的，我意识到微软明天可能会推出全新的数据访问技术！;)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-24T14:16:56.580

选择 NHibernate。它将作为一个概念或实际的 ORM 存在一段时间。因此，学习两者都会很有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T15:00:16.833

IMO，这整件事真的被夸大了。

微软并没有说 LINQ to SQL 会死。他们更多地表示它将被合并到实体框架中。

我会专注于使用实体框架作为解决方案，因为我知道大部分 LINQ to SQL 都将包含在其中。

反正现在真的没有太大区别。最大的抱怨是实体框架不是轻量级的。只要您的层级之间有良好的分离，这真的很重要吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T07:01:01.340

好吧，这里的答案主要涵盖了它（也有一些有趣的观点），但无论如何我还是要再说一遍。

LINQ to SQL (L2S) 非常通用，但从我的角度来看，它感觉有点太基础了。在大多数情况下，它在做简单的事情方面做得很好，但只要你要求更多一点，它就会变得昂贵。这根本不是一件坏事。我实际上认为 LINQ to SQL 实际上很好地补充了实体框架。

以使用 LinqDataSource 的自动分页为例。如果您不指定 Order By/Group By 那么它是非常经济的。将排序或分组放入组合中，您开始获得性能飙升（变得非常健谈）。然后，您几乎必须编写自己的分页实现（我承认这并不难）。

我将是第一个承认 L2S 在生成的 T-SQL 的质量方面优于实体框架的人（我应该，因为 L2S 是专门为查询 SQL Server 而构建的）以及在概念和语义上，大部分 LINQ to SQL 与 EF 类似，但您遇到的问题是扩展需求和考虑更复杂的实现要求。

如果我要从头开始并选择投入个人开发时间，我会选择实体框架。有趣的是，我目前正在开发一个使用 L2S 的项目，它旨在扩展和处理重负载，但是当我们遇到一些更具“创造性”的要求时，我们经常被迫扩展 SQL Metal （例如多对多关系）。

所以..简而言之..我会这样处理：

a) 学习 LINQ to SQL 作为介绍（微软的 ORM 模式和技术）。它让您熟悉与实体框架共享的大部分基础知识，并体验 LINQ 样式查询（如果您有后天的体验） T-SQL 的背景）

b）一旦您掌握了 LINQ to SQL，我建议您跳到实体框架以了解其他好处（eSQL 等）

c) 在两者中实施概念验证项目并比较结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-24T14:25:47.810

L2S 是，恕我直言，它的方式非常好，正如你所说，不会去任何地方。我工作的公司已将它作为我们的数据访问标准，我们将它用于从 5 个用户小众应用程序到 1000 多个用户企业应用程序的所有应用，并取得了很好的效果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T14:28:36.260

查看亚音速：

[http://subsonicproject.com/](http://subsonicproject.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-24T14:30:35.897

我认为[EDM](http://msdn.microsoft.com/en-us/library/aa697428(VS.80).aspx)的目标比 LINQ to SQL 的目标要大得多。如果您正在寻找一个简单的 ORM，那么我认为 LINQ to SQL 是要走的路。如果您计划构建具有与具有关系结构的数据库表相关的继承结构并执行其他高级映射的类，那么 EDM 可能是一个不错的选择。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-24T15:38:59.457

值得一提的是，该站点是使用 LINQ to SQL 构建的。Jeff 在 StackOverflow 播客中谈到了使用它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T06:40:29.697

L2S 是一项很棒的技术，我永远不会回到旧的 ADO。

但正如你所提到的，它正在让位给 L2E。L2S 功能强大，我已经使用它进行了许多应用，并且非常高兴。但是听说它不再先进了，就在我身边放了一把刀。所以我去检查了 L2E，它在 SQL 交互方面*几乎*是一样的，而且在很多方面我发现它更容易，更不用说它的关系处理更有效了。有了这样的相似之处，选择 L2E 似乎是合乎逻辑的。

我写了一篇关于进行切换和比较两个框架的帖子：http: [//naspinski.net/post/Getting-started-with-Linq-To-Entities.aspx](http://naspinski.net/post/Getting-started-with-Linq-To-Entities.aspx)

我几乎可以保证你会对这些框架中的任何一个感到满意，它们是开发的天赐之物。简单性和避免错误是首屈一指的。我个人倾向于 L2E，因为它将比 L2S 更积极地开发。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-05T18:30:28.897

我在当前的 Web 项目中大量使用 L2S，我相信您会发现最大的问题是有关进行 n 层数据库开发的最佳方法的文档相互矛盾。

首先，您需要预先意识到的是，DataContext 对象**的持续时间仅与工作单元**、周期一样长。此外，DataContext 是无状态的。一旦你掌握了这两个原则，在 n 层环境中使用 LINQ 就可以很好地工作了。

另一方面，你会看到很多人推荐一些非常非常非常糟糕的方式来使用 Linq。永远不要让你的 DataContext 静态，这是我早期犯的一个错误，它创造了奇迹，直到它不起作用，然后在不同的会话中交叉错误的数据等，这绝对是可怕的。简单地说，这可能是最大的使用 Linq 的最大禁忌，应该在每个文档中用粗体大写字母书写。此外，在 Session 变量中持久保存 DataContext 也是一个坏主意。

我在使用 LINQ 时遇到的唯一另一个主要问题是在进行断开连接的更新时，您需要在整个调用中使用相同的 DataContext。例如：

```
 public static void UpdateUser(UserLibrary.User user) {
        using (UserLibraryDataContext dc = new UserLibraryDataContext(_conStr))
        {
            UserLibrary.User newUser = (from user2 in dc.Users where user2.UserID == user.UserID select user2).FirstOrDefault();
            newUser.Email = user.Email;
            newUser.FirstName = user.FirstName;
            newUser.LastName = user.LastName;
            dc.SubmitChanges();
        } 
```

您不能简单地传入在不同数据上下文中创建的用户并期望更新工作，除非您设置 DataContext.ObjectTrackingEnabled = false，我不建议这样做。相反，在同一个 DataContext 中，您应该检索现有对象，更新其值，然后提交更改。将所有类似的任务保存在同一个 DataContext 中。

不过我会推荐 L2S，一旦你解决了一些琐碎的问题（比如上面的问题），它就是一项很棒的技术，而且绝对可以节省时间。但是，我建议在您的 DAL 周围做一个薄包装，这样您就可以轻松更改。我正在考虑（出于经济原因）将我的部分代码移植到使用 OpenAccess ORM -> MySql 进行部分数据访问，并且使用正确定义的层，这项任务应该只需要我几个小时。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-24T15:01:15.443

我同意回声风暴。L2S 非常适合您的需求。而且它很容易使用......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T06:51:17.020

如果您正确设计您的应用程序并很好地隔离您的数据访问层，那么您应该使用 L2S。根据我从您的帖子中推断，这不是一个大项目，因此 L2S 应该可以很好地满足您的要求，而普通的旧 ADO.NET 只是一个禁忌，而 Entity Framework 是......只是不要使用它， 行？无论如何，如果你很好地隔离了你的 DAL，如果项目增长，你可以在未来将 L2S 换成其他东西。即使 L2S 不会去任何地方，它也不会去任何地方。MS 停止了对它的投资，但它不会被弃用或其他东西，所以它仍然是一项安全的投资。或者，您应该评估简单而成熟的 NHibernate。

# asp.net - 如何创建段落 ( ) 在 ASP.NET 中使用 HtmlGenericControl？

> ID：391498
> 
> 赞同：19
> 
> 时间：2008-12-24T14:17:08.577
> 
> 标签：asp.net

如何使用 HtmlGenericControl 类在 ASP.NET 中创建 pragraph <p> 标记？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-24T14:22:37.597

```
HtmlGenericControl para = new HtmlGenericControl ( "p" ); 
```

虽然我会把它作为额外属性/方法的容器控件。

```
HtmlContainerControl para = (HtmlContainerControl)new HtmlGenericControl ( "p" ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T14:23:23.930

我知道，这可能不是最快的实现方式，但我曾经编写过“缺失”的 html 控件，以便以后通过代码重用，而不会弄乱 html 标签。

```
Public Class HtmlParagraph
    Inherits HtmlControl

    Public Sub New()
        MyBase.New("p")
    End Sub

    Protected Overrides Sub AddParsedSubObject(ByVal obj As Object)
        If (TypeOf obj Is LiteralControl) Then
            Me._text = DirectCast(obj, LiteralControl).Text
        Else
            MyBase.AddParsedSubObject(obj)
        End If
    End Sub

    Protected Overrides Sub Render(ByVal writer As HtmlTextWriter)
        writer.RenderBeginTag(HtmlTextWriterTag.Fieldset)
        If (Me.HasControls) Then
            Me.RenderChildren(writer)
        ElseIf (Not String.IsNullOrEmpty(Me._text)) Then
            writer.Write(Me._text)
        End If
        writer.RenderEndTag()
    End Sub

    Private pText As String = String.Empty
    <Category("Appearance"), PersistenceMode(PersistenceMode.InnerDefaultProperty), Localizable(True), DefaultValue(""), DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)> _
    Public Overridable Property [Text]() As String
        Get
            If (Me.pText Is Nothing) Then Return String.Empty Else Return Me.pText
        End Get
        Set(ByVal value As String)
            Me.pText = value
        End Set
    End Property
End Class 
```

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2008-12-24T14:22:02.137

```
new HtmlGenericControl("p"); 
```

PS。尝试使用智能感知...

# c# - 将鼠标悬停在此用户控件中的任何控件上时，每个标签的文本都会变为红色

> ID：391499
> 
> 赞同：2
> 
> 时间：2008-12-24T14:17:43.160
> 
> 标签：c#, asp.net

我有一个自定义用户控件，其中包含`asp:ValidationSummary`. 它与显示数据的其他控件一起放置在页面上。当我尝试保存页面并触发验证时，我得到以下奇怪的行为：

如果我将鼠标悬停在页面上的任何控件上，所有标签都会变为红色。当光标离开页面时，它们会返回到其 CSS 中指定的颜色。我没有找到任何鼠标悬停的代码，等等......

我想知道 ValidationSummary 是否正在做一些我不知道的事情？我很感激任何反馈。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T15:35:53.907

要测试此理论，请将验证摘要的颜色更改为蓝色，然后再试一次。如果您的控件变为蓝色，那么是的，我会说这是您的验证摘要。

由于验证摘要是客户端，我不建议将其放在自定义控件中，除非您有非常明确的理由。

# coding-style - 如果（条件）继续；或者如果（！条件）{...}？（风格偏好）

> ID：391503
> 
> 赞同：6
> 
> 时间：2008-12-24T14:18:47.263
> 
> 标签：coding-style

我知道这是一个风格问题，因此是主观标签。我有一小段代码，有两个嵌套条件。我可以用两种方式对其进行编码，并且我想看看更有经验的开发人员认为它应该是什么样子。

*样式 1*：

```
while (!String.IsNullOrEmpty(msg = reader.readMsg()))
{
    RaiseMessageReceived();
    if (parseMsg)
    {
        ParsedMsg parsedMsg = parser.parseMsg(msg);
        RaiseMessageParsed();
        if (processMsg)
        {
            process(parsedMsg);
            RaiseMessageProcessed();
        }
    }
} 
```

*风格二：*

```
while (!String.IsNullOrEmpty(msg = reader.readMsg()))
{
    RaiseMessageReceived();
    if (!parseMsg) continue;

    ParsedMsg parsedMsg = parser.parseMsg(msg);
    RaiseMessageParsed();
    if (!processMsg) continue;

    process(parsedMsg);
    RaiseMessageProcessed();
} 
```

（附带问题：如何在源代码示例中放置空行？）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-24T14:21:35.307

我更喜欢样式 1 - 带有缩进。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-24T14:21:59.160

我更喜欢样式 2 - 带有 continue 语句。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-24T15:31:28.503

原则上，我同意大多数喜欢样式 1 的人的观点。这是 Steve McConnell 在“代码完成”中所赞同的 - 说出你的意思，即如果你对条件为真更感兴趣，而假状态则更罕见或不受欢迎，然后说明首选版本。

在实践中，虽然我经常发现自己使用样式 2，因为我喜欢首先清除所有可能的错误/无效状态。在我摆脱了所有我不感兴趣的可能性之后，我可以将核心代码写到例程的末尾，而不会一直想知道我是否需要防范某种情况或其他情况。基本上，态度是，甩掉糠秕，然后安心地做真正的工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-24T15:26:01.790

这两个都是假的。不要将赋值放在条件表达式中。

```
(!String.IsNullOrEmpty(msg = reader.readMsg())) 
```

你这样做只是因为读者的古怪行为——为什么读者会给你一个非消息来表明阅读已经完成？这是一个设计更好的阅读器的替代方案：

```
while (reader.HasMessage())
{
  string msg = reader.GetMessage();
  HandleMessage(msg);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-24T14:22:55.367

我绝对更喜欢第一个版本。该语句在不过度*使用*`continue`时非常好。

 *我会按照与多个返回语句相同的方式来处理它。它们适用于保护子句，并且在提高清晰度时具有很好的用处，但不应过度使用。

此外，一行上的两个空格应该在代码块中为您插入一个换行符。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-24T14:37:16.943

我更喜欢Style2。此外，Refactoring.com 上描述了相同的示例 [替换嵌套条件](http://www.refactoring.com/catalog/replaceNestedConditionalWithGuardClauses.html)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-24T16:58:46.690

我想在不同的方向重构这段代码。你的代码做的事情太多了！

1.  读取输入
2.  迭代
3.  发出通知
4.  解析（有条件！（有通知！！））
5.  处理（有条件！（有通知！！））

我认为我们需要在这里分开。我想探索：

*   将读取输入移动到迭代器 ( `yield return`)。
*   将条件转移到[策略模式中](http://en.wikipedia.org/wiki/Strategy_pattern)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-24T14:31:26.003

在显示的示例中，我会使用样式 1。如果我的方法足够大以至于嵌套成为问题（并且没有更好的方法来重构代码），那么我会考虑样式 2。但是对于仅显示了两个紧凑型外壳，绝对是样式 1。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-24T14:42:01.317

样式 1 更清晰，恕我直言。Continue 本身并不反对，但正如人们之前所说，缩进使后续更容易。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-24T15:38:31.190

出于多种原因，我个人更喜欢样式 2。

*   您可能会遇到一个潜在错误，即在 if 之后缩进但忘记大括号。

*   您遇到浮动 else 问题的风险较小，即使用多个嵌套 if 时，您可能会混淆给定 else 属于哪个 if。

*   您避免了可能导致代码离开页面的过度缩进

当我编写此代码时，我倾向于将 continue 放在单独的行上；

```
if (!parseMsg) 
    continue; 
```

由于它使它更明显，并且更容易为其分配断点。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-24T16:52:25.157

样式 2 让人类读者专注于重要的代码，甚至不看任何不相关的东西——你看到 continue 语句，下面的任何东西都是不相关的。

风格 2 管理复杂性并因此扩展到更复杂的方法，风格 1 很快变得难以管理。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-24T14:23:37.033

我发现 continue 语句使代码更难遵循（因此调试）。在某些情况下，您仍然可以使用它们，但我认为您的示例不是其中一种情况。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-24T15:55:55.053

虽然我更喜欢样式 1。我发现有时使用样式 2 很有用，因为它有助于降低缩进级别并使代码更易于阅读。

老实说，任何一种风格都很好，这真的取决于个人选择。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-24T14:29:26.833

我更喜欢带有缩进的样式 1，它更干净，并且更容易通过查看它来理解我可以看到代码的布局。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-24T14:58:32.907

第一种风格当然更清楚——它说明了你（显然）的意思，即获取一条消息，如果`parseMsg`设置了标志，则尝试解析它；如果成功，则处理它。另一方面，第二个版本将处理显着更少的指令，尤其`parseMsg`是在设置的情况下。我很想介于两者之间：

```
while (!String.IsNullOrEmpty(msg = reader.readMsg())){
    RaiseMessageReceived();

    if (!parseMsg) continue ;

    ParsedMsg parsedMsg = parser.parseMsg(msg);
    RaiseMessageParsed();
    if (processMsg){
       process(parsedMsg);
       RaiseMessageProcessed();
    }
} 
```

...理论上，在解析被关闭的特殊情况下，您将跳过所有解析。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-24T15:22:24.623

我更喜欢样式 1，并将 continue 语句等同于 goto 语句。我承认它在执行期间可能不如另一个高效，但我发现代码理解效率几乎总是比代码执行效率更重要。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-24T15:52:06.230

在担心外观无关之前，我会删除使用全局变量在函数之间进行通信。大概您的语言支持函数的返回值。使用这些

*   表达每一步的成功或失败，或
*   让每个转换函数返回下一个状态

哪个更清楚。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-24T16:20:10.340

我的偏好是样式 1，但如果 !parseMsg 或 !processMsg 经常发生，我会立即使用样式 2。总是把最有可能的情况放在第一位——对吧？

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-24T16:45:07.763

Guard Clause 适用于条件函数返回，因为它创建了一个完整的语句。您一眼就知道发生了什么（我们在这里完成）。

continue 语句通常需要更多的思考。我个人觉得，如果您在循环中使用多个 continue 语句，那么您做错了什么。

我认为第一种类型是自我记录和标准方式。当您违反标准方式时，您需要添加评论。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-24T16:50:07.957

我发现样式 1 更容易遵循。所以我更喜欢风格1。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-05T20:45:25.310

两种选择都很尴尬。**从样式 2**开始，将 while 循环的内部提取到一个新方法中，并将 continue 语句更改为 return 语句。它仍然需要更多的重构。

**continue 关键字很尴尬**，但 return 语句很好理解。此选项几乎没有嵌套缩进。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2008-12-24T14:26:01.927

尽可能避免`continue`陈述。

我们`goto`尽可能地避免，不是吗 - 避免它的表亲不是也有意义`continue`吗？

# silverlight - 将 .xaml 和 .xaml.vb 文件移动到新的 Silverlight 项目会中断 xaml 编译

> ID：391506
> 
> 赞同：2
> 
> 时间：2008-12-24T14:20:28.897
> 
> 标签：silverlight, xaml

当我将 .xaml 和 .xaml.vb 文件移动到新的 Silverlight 项目时，生成的 .g 文件不再包含 xaml 文件中定义的 x:Name 属性的成员。这意味着代码隐藏文件不能引用这些成员并且不能构建。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T15:27:49.520

在 Visual Studio 中，选择 .xaml 文件，然后在属性中，将文件的生成操作设置为页面。您不需要手动修改项目文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T14:36:56.990

我想我已经回答了我自己的问题。如果您使用 Visual Studio 解决方案资源管理器将用户控件从一个项目复制并粘贴到另一个项目，它会将用户控件作为 ApplicationDefinition 而不是页面放入 vbproj 文件（不确定 csproj）。例如，将 vbproj 中的 xml 更改为每个用户控件的如下所示：

```
<Page Include="calculator.xaml">
    <Generator>MSBuild:MarkupCompilePass1</Generator>
    <SubType>Page</SubType>
</Page> 
```

...解决问题。

这是一种使我感到不安的工具巫术，但至少文件是透明的，因此您可以弄清楚并修改它们。

这似乎是 Visual Studio 中的一个错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-03-03T12:09:31.787

即使这样不行，也试试这个：

1.  手动从资源管理器中删除您手动添加的文件。您宁愿使用 VS 来添加它。
2.  右键单击该项目，然后单击“添加”->“现有项目”。
3.  VS 将完成同步代码隐藏和 XAML 的其余工作。

巴拉特

# c# - 匿名类型与动态类型

> ID：391529
> 
> 赞同：43
> 
> 时间：2008-12-24T14:28:19.800
> 
> 标签：c#, .net, dynamic, anonymous-types

c# 3.0 中的匿名类型（var）和 c# 4.0 中的动态类型（动态）之间的真正区别是什么？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-12-24T20:14:43.657

您似乎正在混合三种完全不同的正交事物：

*   *静态与动态*类型
*   *清单与隐式*类型
*   *命名与匿名*类型

这三个方面是完全独立的，彼此没有任何关系。

*静态与动态*类型是指*何时*进行类型检查：动态类型发生在*运行时*，静态类型发生*在运行时之前*。

*清单与隐式*类型是指类型是否*在源代码*中显示：清单类型意味着*程序员*必须将类型写入源代码，隐式类型意味着*类型系统*自己计算出来。

*命名与匿名*类型是指类型是否具有名称。

C# 4.0 中的`dynamic`关键字意味着这个变量、参数、方法、字段、属性……无论是*动态类型*的，即它的类型将在运行时检查。所有不是动态类型的都是静态类型的。类型是静态的还是动态的不仅决定了何时进行类型检查，而且在 C# 4.0 中，它还决定了何时进行*方法分派*。在 C# 中，方法分派是在运行时之前完成的，基于静态类型（当然，运行时子类型多态性除外），而在 C# 4.0 中的动态类型对象上，方法分派是在运行时完成的，基于运行时类型。

C# 3.0 中的`var`关键字意味着这个局部变量将被*隐式类型化*，也就是说，不是程序员显式地写下类型，而是类型系统会自己计算出来。这与动态类型无关，至少在 C# 3.0 中是这样。变量将是强静态类型的，就像您自己写下类型一样。这只是为了方便：例如，当类型系统可以*清楚地*确定是 a时，为什么还要写下所有类型名称*两次*，所以改为写. 请注意，这没有任何动态或匿名的。该类型是静态的，并且有一个名称：`HashMap<int, string> foo = new HashMap<int, string>();`*`foo``HashMap<int, string>``var foo = new HashMap<int, string();``HashMap<int, string>`. 当然，在 C# 4.0 中，如果类型系统发现赋值的右侧是动态的，那么左侧变量的类型将是动态的。*

 *C# 3.0 中的*匿名类型*意味着该类型没有名称。好吧，实际上，*真正的*匿名类型需要对通用类型系统进行向后不兼容的更改，所以在幕后*实际*发生的是编译器将为该类型生成一个非常长、非常随机、唯一且非法的名称，并放入该名称出现在匿名类型的任何位置。但是从程序员的角度来看，类型没有名字。为什么这很有用？嗯，有时你有中间结果，你只需要短暂的，然后再扔掉。给这些瞬态类型起一个自己的名字会将它们提升到一个他们根本不应该得到的重要程度。但同样，这没有什么动态的。

那么，如果类型没有名字，程序员怎么去引用呢？好吧，她不能！至少不是直接的。程序员*可以*做的是描述类型：它有两个属性，一个叫做 type 的“name”，`string`另一个叫做 type 的“id” `int`。那是我想要的类型，但我不在乎它叫什么。

这是碎片开始融合的地方。在 C# 中，您必须通过显式写下类型名称来声明局部变量的类型。但是，你怎么能写下一个没有名字的类型的名字呢？这就是`var`进来的地方：因为从 C# 3.0 开始，这实际上不再正确：您不再需要写下名称，您也可以告诉编译器来弄清楚。因此，虽然我在上面第一段中写的内容是正确的，隐式类型和匿名类型与其他类型没有任何关系，但如果没有隐式类型，匿名类型也将毫无用处。

但是请注意，相反的情况并非如此：隐式类型在没有匿名类型的情况下非常有用。`var foo = HashMap<int, string>`非常有意义，并且看不到匿名类型。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-24T14:34:24.187

匿名类型是为您创建的真实的、编译器生成的类型。这样做的好处是编译器可以稍后将这种类型重新用于需要它的其他操作，因为它是一个 POCO。

我对动态类型的理解是它们是后期绑定的，这意味着 CLR（或 DLR）将在执行时评估对象，然后使用鸭子类型来允许或禁止成员访问该对象。

所以我想区别在于匿名类型是编译器可以看到但你只能使用的真正的 POCO，而动态类型是后期绑定的动态对象。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-12-24T14:34:53.860

该`dynamic`类型本质上是，但将*在运行时*通过 DLR 或其他提供程序（例如反射）`object`解析所有方法/属性/运算符等调用。

 *这使它很像带有 VB 的 VB [`Option Strict Off`](http://msdn.microsoft.com/en-us/library/zcd4xwzs.aspx)，并且使它非常适合调用 COM 或 DLR 类型。

动态编译时*没有*类型检查；显然，匿名类型是正确的静态类型、类型检查的野兽（你可以在反射器中看到它们，尽管它们并不漂亮）。

此外，匿名类型可以由编译器专门处理；`dynamic`需要广泛的运行时支持 - 所以匿名类型是 C# 的一项功能，但`dynamic`主要由 .NET 4.0 实现（有一些 C# 4.0 支持）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-24T18:26:19.570

有 3 次，有 3 位演员——每次一个。

*   设计时 - 程序员
*   编译时 - c# 编译器
*   运行时 - .net 运行时

匿名类型由编译器声明和命名。此声明基于程序员的规范（他如何使用类型）。由于这些类型是在程序员离开进程之后命名的，因此它们对程序员来说似乎是无名的，因此是“匿名的”。

*   程序员说：有些类型有名称和地址
*   编译器说：有一个名为 xyz 的类型，具有 Name 和 Address 属性和字段，都是字符串。
*   运行时说：我无法区分 xyz 和程序员制作的任何类型之间的任何区别。

c# 中的动态类型允许您调用在编译时可能存在或不存在的方法。这对于调用未编译的 python 或 javascript 很有用。

*   程序员说：把这个汽车实例当作一个动态类型。现在，嘎嘎。
*   编译器说：动态类型是吗？一定没问题。我不会抱怨，因为我无法检查。
*   运行时尝试使 car 实例 quack。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-02-23T22:19:52.710

没有什么比一个小代码更能解决问题的了：

```
// anonymous types
var anonType = new {Id = "123123123", Name = "Goku", Age = 30, DateAdded = new DateTime()};
// notice we have a strongly typed anonymous class we can access the properties with
Console.WriteLine($"Anonymous Type: {anonType.Id} {anonType.Name} {anonType.Age} {anonType.DateAdded}");
// compile time error
//anonType = 100;

// dynamic types
dynamic dynType = 100.01m;
Console.WriteLine($"Dynamic type: {dynType}");
// it's ok to change the type however you want
dynType = new List<DateTime>();
Console.WriteLine($"Dynamic type: {dynType}");

// mix dynamic and anonymous
dynamic dynamicAnonymousType = new {Id = 8000, FirstName = "Goku", Gender = "male", IsSuperSaiyan = true};
// Wasn't sure this would work but it does! However, you lose intellisense on the FirstName so you have to type it manually.
Console.WriteLine($"FirstName: {dynamicAnonymousType.FirstName}");
dynamicAnonymousType = 100;
Console.WriteLine(dynamicAnonymousType);
// runtime error
Console.WriteLine($"Id: {dynamicAnonymousType.FirstName}"); 
```

# c++ - 从 VC++ 文件发送 HTTP 请求

> ID：391532
> 
> 赞同：1
> 
> 时间：2008-12-24T14:29:42.420
> 
> 标签：c++, visual-studio, http

我正在尝试发送一个 HTTP 请求，其中一个文件的内容设置为 HTTP 请求的主体，并希望使用 VC++ 从服务器获取响应。

任何帮助表示赞赏。谢谢。

我想我不是很清楚我想做什么，或者我误解了答案。Newways，我想要完成的是，我的一个网络服务接受本地文件的数据作为发送给它的 HTTP 请求的主体。我想调用此服务并将 txt 文件的内容作为 HTTP 请求的正文发送。作为回报，我将从服务中获得我想要在字符串变量中获得的响应。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T15:02:21.683

您可以使用[cURL 库](http://curl.haxx.se/libcurl/c/example.html)。还有一个类似的主题[Programmatically reading a web page](https://stackoverflow.com/questions/389069/programmatically-reading-a-web-page)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T14:37:08.567

您始终可以使用 WinInet。在此处查看文档：

[http://msdn.microsoft.com/en-us/library/aa385331(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa385331(VS.85).aspx)

高温高压

科尔比非洲

# model-view-controller - MVC 的数据库设计问题 - 每个模型 1 个表

> ID：391549
> 
> 赞同：12
> 
> 时间：2008-12-24T14:35:50.440
> 
> 标签：model-view-controller, database-design

我开始使用 MVC 框架的最大障碍与 1 模型到 1 数据库表的概念有关。对我来说，除了简单的应用程序之外，任何东西都过于简单和不切实际。然而，MVC 无处不在，包括这个很棒的 StackOverflow 站点。通常，我遇到的所有代码示例和教程都非常简单，并且在这些情况下一对一的关系可以正常工作。但是，我正在寻找的是地址表连接的 MVC 模型的真实世界示例。在 stackoverflow 的情况下，我会想象一个带有问题、标签、用户等表的数据库设计。在我的数据库设计中，我可能有一个 Question_Tag 链接表来查找与给定问题关联的所有标签。MVC 如何处理这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-24T14:41:28.060

我不相信关于[MVC 设计模式](http://en.wikipedia.org/wiki/Model-view-controller)的任何内容都表明每个域类应该有一个数据库表。事实上，MVC 设计模式中没有任何内容甚至说您的模型应该或必须保存在关系数据库中。

这只是一些流行的框架（Ruby on Rails - 也可能是 ASP.NET MVC？）为了方便起见而采取的策略。但这不是 MVC 的要求。Spring MVC（用于 Java 世界）没有关于如何将模型组件映射到数据库的固有概念，事实上它的美妙之处在于它不关心 - 您只需要提供要使用的模型数据，以及您从哪里获得它来自 MVC 框架并不关心。

所以换句话说，您不需要假设 MVC 模式意味着您必须为每个模型组件使用一个数据库表。哎呀，您甚至不需要使用数据库，您的模型也可以来自平面文件或 Web 服务（MVC 的优点在于，如果您正确设计应用程序，您可以交换不同的数据层实现和退出您的应用程序，视图或控制器*甚至都不知道*）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T14:56:01.600

我认为您将 MVC 与 ORM 混淆了。ORMS 将您与数据库表和对象一对一绑定。

您需要做的是将模型对象从 MVC 发送到 DAL 层，该层可以从 SQL 查询中为您填充它们并返回对象。同样，您可以将具有更改的填充对象发送回 DAL 层以进行持久化。

这是一种更简洁灵活的设计，您可以将其与 MVC 模式一起使用，并且您不必将对象耦合到数据库表，同时使用 SQL 的连接功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T15:14:31.657

好的，艾哈迈德，这是有道理的。但在我见过的所有 MVC 示例中，该模型是某种组合的 BLL/DAL。您所说的是将模型保持为纯 BLL 并创建单独的 DAL。我认为使用现有 mvc 框架的主要功能之一是加快开发速度。如果我必须在 MVC 之上创建一个 DAL，我不妨坚持我现有的非 MVC 开发过程，即创建具有单独业务逻辑和数据访问层的页面。

# javascript - Javascript原型继承？

> ID：391550
> 
> 赞同：16
> 
> 时间：2008-12-24T14:35:51.813
> 
> 标签：javascript, inheritance, prototype, prototypal-inheritance

为了更好地理解它，我一直在 js 中做一些继承，但我发现了一些让我感到困惑的东西。

我知道，当您使用 new 关键字调用“构造函数”时，您会得到一个引用该函数原型的新对象。

我也知道，为了进行原型继承，您必须将构造函数的原型替换为您希望成为“超类”的对象的实例。

所以我做了这个愚蠢的例子来尝试这些概念：

```
function Animal(){}
function Dog(){}

Animal.prototype.run = function(){alert("running...")};

Dog.prototype = new Animal(); 
Dog.prototype.bark = function(){alert("arf!")};

var fido = new Dog();
fido.bark() //ok
fido.run() //ok

console.log(Dog.prototype) // its an 'Object' 
console.log(fido.prototype) // UNDEFINED
console.log(fido.constructor.prototype == Dog.prototype) //this is true

function KillerDog(){};
KillerDog.prototype.deathBite = function(){alert("AAARFFF! *bite*")}

fido.prototype = new KillerDog();

console.log(fido.prototype) // no longer UNDEFINED
fido.deathBite(); // but this doesn't work! 
```

（这是在 Firebug 的控制台中完成的）

1) 为什么如果所有新对象都包含对创建函数原型的引用，fido.prototype 是未定义的？

2) 继承链是 [obj] -> [constructor] -> [prototype] 而不是 [obj] -> [prototype] ？

3) 是否检查过我们对象 (fido) 的“原型”属性？如果是这样......为什么'deathBite'未定义（在最后一部分）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-24T18:13:59.207

> 1) 为什么如果所有新对象都包含对创建函数原型的引用，fido.prototype 是未定义的？

所有新对象都持有对在构造时存在于其构造函数中的原型的引用。但是，用于存储此引用的属性名称`prototype`与构造函数本身不同。一些 Javascript 实现确实允许通过某些属性名称访问这个“隐藏”属性，就像`__proto__`其他人不允许的那样（例如 Microsoft）。

> 2) 继承链是 [obj] -> [constructor] -> [prototype] 而不是 [obj] -> [prototype] ？

不。看看这个：-

```
function Base() {}
Base.prototype.doThis = function() { alert("First"); }

function Base2() {}
Base2.prototype.doThis = function() { alert("Second"); }

function Derived() {}
Derived.prototype = new Base()

var x = new Derived()

Derived.prototype = new Base2()

x.doThis(); 
```

这会提醒“第一”而不是第二。如果继承链通过构造函数，我们将看到“Second”。当一个对象被构造时，保存在 Functions 原型属性中的当前引用被转移到该对象对其原型的隐藏引用。

> 3) 是否检查过我们对象 (fido) 的“原型”属性？如果是这样......为什么'deathBite'未定义（在最后一部分）？

分配给一个对象（除了一个函数）一个被调用的属性`prototype`没有特殊的意义，如前所述，一个对象不会通过这样的属性名称来维护对其原型的引用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-24T15:06:03.093

对象的原型一旦被实例化就无法更改`new`。

在你上面的例子中，像

```
fido.prototype = new KillerDog(); 
```

`prototype`只需在 object 上创建一个名为的新属性`fido`，并将该属性设置为一个新`KillerDog`对象。这和没区别

```
fido.foo = new KillerDog(); 
```

正如你的代码所代表的......

```
// Doesn't work because objects can't be changed via their constructors
fido.deathBite();

// Does work, because objects can be changed dynamically, 
// and Javascript won't complain when you use prototype 
//as an object attribute name
fido.prototype.deathBite(); 
```

特殊`prototype`行为仅适用于 javascript 中的构造函数，其中构造函数是`function`s，将使用`new`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-24T18:19:10.443

用数字回答你的问题：

1.  不调用对象的原型属性`prototype`。该标准用于`[[prototype]]`指定它。Firefox 以 __proto__ 的名义将此属性公开。
2.  继承链是`[obj]`⇒ `[prototype object]`。您最初的假设 ( `[obj]`⇒ `[constructor]`⇒ ) 是不正确的，您可以通过修改和/或`[prototype]`轻松地反驳它，并检查您可以调用哪些方法- 您会发现这些修改不会改变任何东西。`constructor``constructor.prototype``[obj]`
3.  `prototype`不检查也不使用对象上的属性。您可以将其设置为您喜欢的任何内容。JavaScript 仅在对象构造期间在函数对象上使用它。

为了演示#3，这里是[Dojo](http://dojotoolkit.org/)的代码：

```
dojo.delegate = dojo._delegate = (function(){
  // boodman/crockford delegation w/ cornford optimization
  function TMP(){}
  return function(obj, props){
    TMP.prototype = obj;
    var tmp = new TMP();
    if(props){
      dojo._mixin(tmp, props);
    }
    return tmp; // Object
  }
})(); 
```

`prototype`正如您所看到的，它利用了仅在一个地方使用的事实，通过`TMP`对具有不同原型的所有委托对象重用相同的函数。实际上`prototype`是在调用函数之前直接赋值的`new`，之后它会被改变而不影响任何创建的对象。

[您可以在我对Relation between [[Prototype]] and prototype in JavaScript](https://stackoverflow.com/questions/383201/relation-between-prototype-and-prototype-in-javascript#383478)的回答中找到对象创建序列。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-30T23:00:41.763

我知道它已经得到了回答，但是，有更好的继承方法。仅出于继承目的调用构造函数是不可取的。不良影响之一是。

```
function Base() {this.a = "A"}
function Child() {this.b = "B"};

Child.prototype = new Base(); 
```

现在您已将属性“a”添加到您不打算添加的 Child 原型中。

这是正确的方法（我没有发明这个，Ext-JS 和其他库使用这个）

```
// This is used to avoid calling a base class's constructor just to setup inheritance.
function SurrogateCtor() {}

/**
 * Sets a contructor to inherit from another constructor
 */
function extend(BaseCtor, DerivedCtor) {
  // Copy the prototype to the surrogate constructor
  SurrogateCtor.prototype = BaseCtor.prototype;
  // this sets up the inheritance chain
  DerivedCtor.prototype = new SurrogateCtor();
  // Fix the constructor property, otherwise it would point to the BaseCtor
  DerivedCtor.prototype.constructor = DerivedCtor;
  // Might as well add a property to the constructor to 
  // allow for simpler calling of base class's method
  DerivedCtor.superclass = BaseCtor;
}

function Base() {
  this.a = "A";
}

Base.prototype.getA = function() {return this.a}

function Derived() {
  Derived.superclass.call(this);  // No need to reference the base class by name
  this.b = "B";
}

extend(Base, Derived);
// Have to set methods on the prototype after the call to extend
// otherwise the prototype is overridden;
Derived.prototype.getB = function(){return this.b};
var obj = new Derived(); 
```

一个更简单的方法是在你指定派生类的方法的地方添加第三个参数来扩展，这样你就不必调用扩展，然后将方法添加到原型

```
extend(BaseCtor, DerivedCtor, {
  getB: function() {return this.b}
}); 
```

然后你可以为语法糖做很多其他的事情。

关于它的博客：http: [//js-bits.blogspot.com/2010/08/javascript-inheritance-done-right.html](http://js-bits.blogspot.com/2010/08/javascript-inheritance-done-right.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-17T21:30:29.157

值得注意的是，在 ECMAScript 5（即最新版本的 JavaScript 语言）中，您可以通过以下方式访问实例的内部 [[Prototype]] 属性[`Object.getPrototypeOf`](http://es5.github.com/#x15.2.3.2)：

```
Object.getPrototypeOf(fido) === Dog.prototype 
```

# c++ - 是否有适用于 C++ 的备忘单？

> ID：391553
> 
> 赞同：3
> 
> 时间：2008-12-24T14:37:04.977
> 
> 标签：c++

您喜欢 C++ 备忘单中的哪些内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T14:42:19.710

我发现[这个](http://web.archive.org/web/20090823155413/http://www.sfu.ca/~vwchu/projects/CPPQuickRef.pdf)似乎足够详细。

它涵盖了模板、继承、运算符、异常等的基础知识。它在很小的空间内包含大量信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T15:13:10.303

O'Reilly 的[C++ 袖珍参考书](http://oreilly.com/catalog/9780596004965/)就是这样一种有用的工具。

> C++ 袖珍参考是 C++ 程序员的记忆辅助工具，使他们能够快速查找该语言不熟悉和不经常使用的方面的用法和语法。这本书体积小，便于携带，确保在需要时随时可用。程序员也会欣赏这本书的简洁性。尽可能多的信息被塞进了它的小页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T15:16:22.403

我一直在使用[SparkCharts C++ 备忘单](http://sparkcharts.sparknotes.com/cs/cplusplus/)。我在 Borders 找到了它，但你可以以相同的价格在线打印出来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T04:55:22.717

[CPP_Language_Reference](http://interviewpattern.com/Resources/CPP_Language_Reference.pdf)

[Cpp快速参考](http://interviewpattern.com/Resources/CppQuickReference.pdf)

# c# - 一般来说，C# 中的每个抽象函数都是虚拟的吗？

> ID：391557
> 
> 赞同：22
> 
> 时间：2008-12-24T14:38:09.517
> 
> 标签：c#, oop

我在看堆栈溢出问题*[抽象函数和虚函数有什么区别？](https://stackoverflow.com/questions/391483)*，我想知道是否每个抽象函数都应该被认为是 C# 中的虚函数还是一般意义上的虚函数？

我对这个问题的“你必须覆盖/你可以覆盖”的回答有点困惑。作为一名 C# 程序员，我倾向于认为抽象函数只是一个编译时概念，而抽象函数根据定义是虚函数，因为您必须至少提供一个，但可以在层次结构的下方提供多个实现。

虚函数也具有编译时维度，因为您不能覆盖非虚函数，但它们主要是运行时概念，因为它“只是”根据实际接收者选择正确的方法实现。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-24T14:45:37.597

是的。从[C# 3.0 规范](http://download.microsoft.com/download/3/8/8/388e7205-bc10-4226-b2a8-75351c669b09/CSharp%20Language%20Specification.doc)的第 10.6.6 节：

> 当实例方法声明包含抽象修饰符时，该方法称为抽象方法。尽管抽象方法隐含地也是虚拟方法，但它不能有修饰符 virtual。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T16:11:16.520

它***必须***是虚拟的（Jon Skeet 已经拿出规范来证明它*是*虚拟的），因为给定对抽象基类的引用，必须调用具体派生类的实现。例如，给定经典的 Animal 层次结构：

```
abstract class Animal{
    public abstract void Speak();
}

class Cat : Animal{
    public override void Speak(){Console.WriteLine("meow");}
}

class Dog : Animal{
    public override void Speak(){Console.WriteLine("bark");}
} 
```

如果函数不是虚拟的，则接受一个`Animal`对象并调用其方法的函数将不知道要调用哪个实现。`Speak`

```
static void TalkToAnimal(Animal a){
    Console.WriteLine("Hello, animal.");
    a.Speak();
} 
```

但是请注意，默认情况下接口实现**不是**虚拟的。因为接口与类的工作方式不同，所以不需要真正的多态性来找到接口方法的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T14:41:37.527

是的。为证：

```
abstract class A {
    public abstract void Foo();
}
class B : A {
    public override void Foo()
    { /* must do */ }
}
class C : B {
    public override void Foo()
    { /* can do */ }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T14:45:30.937

是的。

> 抽象属性声明指定属性的访问器是虚拟的，但不提供访问器的实际实现。( [MSDN](http://msdn.microsoft.com/en-us/library/aa664453(VS.71).aspx) )

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T15:23:47.897

我认为您是从“C++”的角度看待问题（更简洁，避免必要的关键字，节省击键）。

C# 哲学是代码的意图应该从阅读源代码中清楚，并且编译器应该能够尽可能地验证该意图。

因此，虽然在抽象方法和虚拟方法之间（或者就此而言，在抽象和非抽象类之间；或在 out 参数和 ref 参数之间）生成的 MSIL 几乎没有什么不同，但额外的关键字一定要告诉维护程序员一些事情，并让编译器仔细检查你在做什么。

# c# - 单个控件的 HandleCreated 多次出现

> ID：391581
> 
> 赞同：2
> 
> 时间：2008-12-24T14:47:31.667
> 
> 标签：c#, .net, winforms, controls

我正在使用需要注册到异步事件的控件。事件将在 UI 线程中使用由 WinForms 控件实现的[ISynchronizeInvoke接口引发](http://msdn.microsoft.com/en-us/library/system.componentmodel.isynchronizeinvoke.aspx)

我无法在构造函数中注册事件，因为它允许在完全创建控件之前调用事件处理程序。在此期间不允许调用 ISynchronizeInvoke。

该问题的解决方案是使用从事件处理程序到[HandleCreated](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.handlecreated.aspx)执行异步事件注册， 而不是从构造函数注册。

但是，这带来了另一个问题，在某些场景中，由于控件状态的更改，HandleCreated 事件被多次引发。例如，每次更改“RightToLeft”属性都会导致 WMCreate 消息引发“HandleCreated”事件。

如何防止事件上升的倍增？是否有另一种方法可以知道何时创建控件并首次显示？

我可以在 HandleCreated 中保留一个布尔标志，但感觉就像是 hack，我想知道是否有更好的方法来处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T18:26:42.427

你不能只是覆盖`CreateHandle`和检查`RecreatingHandle`吗？您可能还想覆盖`DestroyHandle`以捕获它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T17:50:01.377

您是否考虑过使用 Load 事件？非托管句柄在那个时间点肯定是可用的。

# sql-server - 创建自定义 SQL Server“数据源”数据提供程序的文档

> ID：391585
> 
> 赞同：0
> 
> 时间：2008-12-24T14:50:29.490
> 
> 标签：sql-server, import, datasource

我想编写一个导入驱动程序，它允许我的专有文件类型显示在 SQL Server 2005（或任何版本的 SQL Server，就此而言）的导入向导“数据源”下拉列表中。我看到其他供应商已将其格式添加到此列表中 - 是否有关于如何将驱动程序组合在一起的文档？我搜索了 MSDN 和 Google，但似乎找不到任何线索，尽管它显然在某个地方。谢谢！

**澄清**：我想为我正在寻找的内容添加一些细节。我是供应商，我想为我的客户提供一种将文件从我的自定义格式直接导入 SQL Server 的方法。在这张图片（[Flickr 链接](http://www.flickr.com/photos/97207635@N00/3133335987/)）中，您可以看到 Gupta 在我安装他们的客户端工具时出现的这个列表中添加了一个“提供者”，就像 Oracle（或许多其他公司）为他们的数据源添加一个提供者一样。

如何为我的自定义数据源类型添加一个？我想在该列表中添加“Ryan 的 123-Base”（或任何我的产品名称），以便客户可以直接从我公司的格式导入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-13T01:56:05.377

那只是一个[ODBC 驱动程序](http://en.wikipedia.org/wiki/Microsoft_Data_Access_Components)。如果您构建并安装 ODBC 驱动程序，任何系统范围的 ODBC 驱动程序都将显示在该下拉框中。它不是特定于 SQL 的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T15:03:25.113

“司机”可能是错误的搜索词。您想要的是某种 SQL 2005 扩展 API。对不起 - 我个人不熟悉它，但是如果没有其他人知道它，那么更改您的搜索可能会导致您找到答案！

也许是[SQL Server 管理对象（SMO）](http://www.yukonxml.com/articles/smo/)？

这是[SQL 2005 在线书籍](http://msdn.microsoft.com/en-us/library/ms130214(SQL.90).aspx)。也许是关于“集成服务”的那部分？似乎它越来越接近您正在寻找的东西。

好的，我认为它看起来非常有前途。他们有[一些关于它的教程，](http://msdn.microsoft.com/en-us/library/ms167031(SQL.90).aspx)并描述了[你的情况](http://msdn.microsoft.com/en-us/library/ms169917(SQL.90).aspx)：

> 在本教程中，您将学习如何使用 SSIS 设计器创建一个简单的 Microsoft SQL Server 2005 集成服务包。您创建的包从平面文件中获取数据，重新格式化数据，然后将重新格式化的数据插入到事实表中。

祝你好运！

# c++ - 什么时候可以从 C++ 的析构函数中抛出异常？

> ID：391595
> 
> 赞同：7
> 
> 时间：2008-12-24T14:54:15.850
> 
> 标签：c++, exception

我知道规则是在析构函数期间永远不要抛出一个，我明白为什么。我不敢这样做。但即使是 C++ Faq Lite 也说这条规则在 99% 的情况下都是好的。他们未能深入研究的另外 1% 是什么？

[链接到 C++ Faq Lite 关于从 ~() 抛出的要点：](http://www.parashift.com/c++-faq-lite/exceptions.html#faq-17.3)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-24T15:02:22.073

只是不要这样做。如果恒星和行星以这样一种方式排列，你发现你需要……

还是不要这样做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-24T15:22:57.647

哇，我正要投票给 Juan，直到我看到关于从不使用异常的部分。

好的，首先，胡安说得对。如果，*由于某种原因*，你最终陷入了两个异常相互追逐的情况，C++ 将简单地扔掉它的手和最后一顿饭，然后异常终止。因此，从 dtor 抛出异常可以保证您有可能导致计划外异常终止的代码路径，这通常是一件坏事。如果这就是你*想要*的，那就直截了当，调用 abort 或 exit，然后结束它。

然而，通过不使用异常来避免它的部分是不好的建议。对于将要健壮并长时间运行的系统，异常确实是 C++ 中必不可少的机制。它们确实是保证您可以处理错误情况而不会到处泄漏资源的唯一方法。

碰巧我曾经为编写 FAQ 的人 Marshall Cline 工作，并从 FAQ Book 中教授 C++；正因为如此，我可以告诉你，你有点误解了答案。他不是在说“哎呀，有这种情况可以，但我不会告诉你”，他是在说“我敢肯定，如果我说**绝对且无例外，请不要从某天**某个人会想出一个有意义的现成例子。但我不知道，也不太相信。不要在家里尝试这个，并咨询律师，没有明示或暗示的保证。”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T14:59:25.370

如果一切都如此复杂以至于您想通过异常代码流使程序终止。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-24T15:01:30.170

由于另一个异常，您必须保证没有调用析构函数。

话虽如此，我不使用异常。但是如果我不得不使用它们来保住我的工作，我永远不会从析构函数中抛出异常。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T15:18:12.540

如果在堆栈展开期间未自动调用此析构函数，则可以从析构函数中抛出异常，或者抛出异常将导致调用 terminate()。要确定从析构函数中抛出异常是否安全，请使用标准函数 uncaught_exception(); 如果返回 false，则抛出异常是安全的

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-24T17:18:40.283

我想如果你能可靠地检测到析构函数中的一个**非常糟糕**的情况，一个非常糟糕以至于没有好的方法来处理它，你必须确保在其他事情发生之前这个过程**现在**停止......（想象一台连接到枪或核导弹的计算机）但我想到了另外两个想法：

1.  与其抛出异常，不如调用 exit() 或 abort() 或 TerminateProcess() 或显式停止事物的东西，而不是假设您知道编译器会将您的“在析构函数中抛出异常”变成什么当它编译时。

2.  This is more of a contrived example. Extreme safety checks should be handled in a real function that's executed on purpose at well-defined times (or better yet, handled in hardware or redundant processors) and not as an afterthought during a destructor.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-24T14:59:36.977

如果破坏是受控过程的一部分，那么它是可以接受的，但是，您仍然需要尽可能地摆脱剩余的引用，因此抛出可能并不好。

破坏可能经常发生，以至于抛出可能会破坏正常的代码逻辑。

# algorithm - 系统设计：预防/检测投票欺诈

> ID：391600
> 
> 赞同：10
> 
> 时间：2008-12-24T14:57:04.640
> 
> 标签：algorithm, heuristics

鉴于最近发生的[投票欺诈事件](https://blog.stackoverflow.com/2008/12/vote-fraud-and-you/)，我想知道是否有人熟悉构建系统以防止或检测不良投票行为。我想这项技术被广泛用于搜索引擎、在线广告（例如点击欺诈）和社区网站（例如 Digg、reddit），但令人惊讶的是，由于显而易见的原因很少公开。

**所以这是我的问题：考虑到复杂性和用户体验，你将如何设计这样一个系统？是否有一些学术研究领域对此进行了研究？**

PS：这*不是*关于欺诈检测机制的问题，也不是您最近的个人经历；为此，请参阅[另一个问题](https://stackoverflow.com/questions/389509/how-does-the-so-voter-fraud-detection-mechanism-work)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-24T15:08:46.240

关于投票系统的文献有很多，可以应用一些博弈论。困难的问题是它本质上是概率性的。您选择某些模式作为*可能*的欺诈行为，并检测或排除它们；通过这样做，您还排除了某人出于无辜或至少是非欺诈性的原因以这种方式投票的可能性。

考虑一下，例如，有人读了我不死的散文，立即对我产生了好感，并通过我所有的答案投票赞成。我有 30 多个答案，所以需要几天时间。现在，根据假设，这不是我的名誉嫖客，这是一个出于自己的原因，无论多么不明智，一次将所有投票都献给我的人。

这是欺诈吗？不，但它会被检测为并可能被视为欺诈。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T15:06:38.040

问题是你可以创建的几乎任何系统都可以被玩弄，祝你好运，试着提前弄清楚如何玩弄它。当然，另一个问题是我们“A 型”人格对本质上毫无意义的事情过于重视，所以你让人们花费大量时间和精力来最大化他们的代表或最小化别人的代表。

（而且因为我是一个大伪君子，但我尽量不成为，我会做这个 CW）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-12T21:52:25.160

我在 2020 年美国大选中看到了很多选票欺诈的证据，这现在是联邦和州诉讼的主题（参见：Hammer / Scorecard / Dominion）[纽约邮报][1]

[更多链接][2]

我想知道如何建立一个像样的投票系统。看起来真的没那么难。

我提出了这样一个系统的以下框架大纲。

中央政府可以发布一个人的 Dob + 姓名加上随机的 4 位数字的哈希值。（或其他识别信息）

该数据库由政府集中保存，（可能是区块链）

该信息的哈希值通过邮寄、电子邮件或短信发送给选民。

选民然后把这个带到投票站，

如果呈现的哈希与中央记录的哈希匹配，#您的投票选择将针对您的中央持有的哈希进行记录。

这样的系统可以构成相当不错的投票机制的基础。

如果 Hash 的长度为 100 个字符，并且有 3000 万选民（在英国），这意味着一个大约 3Gb 的数据库。

整个事情可以在一个非常小的平台上运行。

几乎不需要人工参与，整个事情可以在公开（只读）的情况下运行以提高透明度。选民 ID 受到保护，因为只有哈希和选择是公开可用的，因此观察者可以检查人口数量、计票等。可能整个事情都可以自动化，因此几乎不需要人工参与。

可以编写代码，因此您只能投票一次，例如，如果 Vote = False，则 Vote Allowed = True

投票可以记录为 2 个（或更多）字节，允许 4 个半字节用于 4 个选择等等等等。

你不能投票两次，因为一旦你的投票被登记在你的个人哈希上，一旦你投票，它就不能改变不能改变。

您的识别哈希必须与中央持有的哈希匹配才能被允许投票。

我只是展示了一个看起来相当健壮的系统如何组合在一起的基本骨架轮廓。

# oracle - 重建索引oracle 10G

> ID：391618
> 
> 赞同：2
> 
> 时间：2008-12-24T15:03:18.920
> 
> 标签：oracle, oracle10g

当我需要运行进程来重建索引时，我如何知道我需要重建哪些索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T18:15:03.977

在这里阅读[http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:2913600659112](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:2913600659112)关于重建索引。重建位图索引是可以的，但 btree 索引不是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T18:08:28.890

定期重建索引是许多人信奉的宗教，但很少有人能证明这一点。几乎所有为它制作的案例都是错误的，通常是因为它具有意想不到的副作用，例如随着索引返回到其稀疏的自然状态，由于块拆分而增加了后续系统负载。

在考虑重建索引之前，您应该首先研究索引是如何工作的，如何创建和删除条目，以及拥有紧凑或稀疏索引对性能的影响——通过谷歌不难找到这些信息。

还要考虑合并操作而不是重建。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T15:33:37.203

一般来说，当索引和表变得过于碎片化时，应该重建它们。
在实践中，您可能不需要使用 Oracle 10g 执行此操作。碎片发生在表和索引上，对结构有很多更改（添加/删除列）和大量数据更改（插入、更新、删除）。

从 v10 开始，Oracle 拥有许多关注数据库性能的自动化流程。其中之一是自动运行的“Segment advisor”。

如果这是 Oracle 10g 的完整版（不是 express），那么您就有了数据库管理器仪表板。
在那里您会找到“顾问中心”，您可以在其中找到 Oracle 各个部分的维护信息。
除此之外，还有“Segment advisor”报告，您可以在其中找到性能改进建议。您可以在此处选择推荐的操作并告诉 Oracle 执行此操作。

如果您对某些表或索引的性能存有疑虑，您可以按需执行分析，您将获得建议是否应该重建表或索引。

如果您拥有包含大量用户和大量更改的大型数据库，则可以每天检查它。

# c# - 比较使用 Thread.Sleep 和 Timer 来延迟执行

> ID：391621
> 
> 赞同：63
> 
> 时间：2008-12-24T15:04:35.920
> 
> 标签：c#, multithreading, timer, sleep, delayed-execution

我有一个方法应该延迟运行指定的时间。

我应该使用

```
Thread thread = new Thread(() => {
    Thread.Sleep(millisecond);
    action();
});
thread.IsBackground = true;
thread.Start(); 
```

或者

```
Timer timer = new Timer(o => action(), null, millisecond, -1); 
```

我读过一些[关于](http://msmvps.com/blogs/peterritchie/archive/2007/04/26/thread-sleep-is-a-sign-of-a-poorly-designed-program.aspx)使用`Thread.Sleep`是糟糕的设计的文章。但我真的不明白为什么。

但是对于使用 Timer，Timer 有 dispose 方法。由于执行延迟，我不知道如何处置 Timer。你有什么建议吗？

或者，如果您有延迟执行的替代代码，也很感激。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-24T16:09:43.840

一个区别是`System.Threading.Timer`在线程池线程上分派回调，而不是每次都创建一个新线程。如果您需要在应用程序的生命周期中多次发生这种情况，这将节省创建和销毁一堆线程的开销（正如您引用的文章所指出的那样，这是一个非常耗费资源的过程），因为它会只需重用池中的线程，如果您将有多个计时器同时运行，则意味着您将同时运行的线程更少（也节省了大量资源）。

换句话说，`Timer`将会更有效率。它也可能更准确，因为`Thread.Sleep`只保证至少等待您指定的时间量（操作系统可能会使其休眠更长时间）。当然，`Timer`仍然不完全准确，但目的是尽可能接近指定时间触发回调，而这不一定是`Thread.Sleep`.

至于销毁`Timer`，回调可以接受一个参数，因此您可以将`Timer`自身作为参数传递并在回调中调用 Dispose （虽然我没有尝试过这个 - 我猜可能是 Timer 可能是在回调期间锁定）。

编辑：不，我猜你不能这样做，因为你必须在`Timer`构造函数本身中指定回调参数。

也许是这样的？（再次，实际上并没有尝试过）

```
class TimerState
{
    public Timer Timer;
} 
```

...并启动计时器：

```
TimerState state = new TimerState();

lock (state)
{
    state.Timer = new Timer((callbackState) => {
        action();
        lock (callbackState) { callbackState.Timer.Dispose(); }
        }, state, millisecond, -1);
} 
```

`Timer`锁定应该防止计时器回调在设置字段之前尝试释放计时器。

* * *

附录：正如评论者所指出的，如果`action()`对 UI 做了一些事情，那么使用 a`System.Windows.Forms.Timer`可能是更好的选择，因为它将在 UI 线程上运行回调。但是，如果不是这种情况，并且归结为`Thread.Sleep`vs. `Threading.Timer`，`Threading.Timer`那就是要走的路。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-07-30T23:51:11.090

使用[`ThreadPool.RegisterWaitForSingleObject`](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.registerwaitforsingleobject(v=vs.110).aspx)而不是计时器：

```
//Wait 5 seconds then print out to console. 
//You can replace AutoResetEvent with a Semaphore or EventWaitHandle if you want to execute the command on those events and/or the timeout
System.Threading.ThreadPool.RegisterWaitForSingleObject(new AutoResetEvent(false), (state, bTimeout) => Console.WriteLine(state), "This is my state variable", TimeSpan.FromSeconds(5), true); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-24T15:16:33.370

我认为 Thread.Sleep 如果你真的想暂停应用程序一段指定的时间就可以了。我认为人们之所以说这是一个糟糕的设计，是因为在大多数情况下，人们实际上并不希望应用程序暂停。

例如，我正在开发一个 pop3 客户端，程序员使用 Thread.Sleep(1000) 等待套接字检索邮件。在这种情况下，最好将事件处理程序连接到套接字并在套接字完成后继续执行程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-22T06:41:47.530

我记得实施了一个类似于 Eric 的解决方案。然而，这是一个可行的;）

```
class OneTimer
    {
        // Created by Roy Feintuch 2009
        // Basically we wrap a timer object in order to send itself as a context in order to dispose it after the cb invocation finished. This solves the problem of timer being GCed because going out of context
        public static void DoOneTime(ThreadStart cb, TimeSpan dueTime)
        {
            var td = new TimerDisposer();
            var timer = new Timer(myTdToKill =>
            {
                try
                {
                    cb();
                }
                catch (Exception ex)
                {
                    Trace.WriteLine(string.Format("[DoOneTime] Error occured while invoking delegate. {0}", ex), "[OneTimer]");
                }
                finally
                {
                    ((TimerDisposer)myTdToKill).InternalTimer.Dispose();
                }
            },
                        td, dueTime, TimeSpan.FromMilliseconds(-1));

            td.InternalTimer = timer;
        }
    }

    class TimerDisposer
    {
        public Timer InternalTimer { get; set; }
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T17:09:59.443

我对 System.Timer 的唯一不满是，大多数时候我看到它在轮询服务中用于长时间延迟（小时、分钟），开发人员经常忘记在启动计时器*之前启动事件。*这意味着如果我启动应用程序或服务，我必须等到计时器过去（小时、分钟）才能真正执行。

当然，这不是定时器的问题，但我认为它经常被不当使用，因为它太容易误用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-31T01:30:19.330

@miniscalope 不，不要使用 ThreadPool.RegisterWaitForSingleObject 代替计时器，System.Threading.Timer 将在时间过去并且不需要等待句柄时将回调排队在线程池线程上执行，等待单个对象将在线程调用回调之前占用线程池线程等待事件发出信号或超时到期。

# mysql - 为什么 MySQL 不在用作布尔值的 int 字段上使用索引？

> ID：391637
> 
> 赞同：4
> 
> 时间：2008-12-24T15:15:10.160
> 
> 标签：mysql, indexing

```
select * from myTable where myInt 
```

即使在 myInt 字段上有索引，在解释查询时也不会显示任何可能的键。

**编辑：**
有问题的索引不是唯一的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-24T15:15:15.947

为了让 MySQL 使用索引，您必须明确地将 int 字段与一个值进行比较（例如，true，1）。

```
select * from myTable where myInt = true 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T15:18:34.410

我不是数据库专家，但如果该字段只有两个可能的值，它不会破坏在该字段上建立索引的目的吗？

如果索引列中的所有字段都是唯一的，则数据库引擎可以进行索引扫描以查找相关行。如果只有两个可能的值 - 那么我看不到将该字段编入索引的目的。数据库引擎必须执行与索引不存在时相同的操作。

也许 MySQL 没有将它显示为可能的键，因为引擎已经放弃了在执行计划中使用索引的想法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T17:12:35.023

有很多因素需要考虑。

一个不应考虑的因素是问题中使用的符号。当列是布尔值时，优化器应将这些条件视为相同：

```
SELECT * FROM MyTable WHERE MyInt;

SELECT * FROM MyTable WHERE MyInt != 0;

SELECT * FROM MyTable WHERE MyInt IS TRUE;

SELECT * FROM MyTable WHERE MyInt = TRUE; 
```

可能还有其他等效的配方。其中第一个不是标准 SQL（即使 MyInt 的类型是 BOOLEAN；其他都是标准的。但是优化器应该简单地将速记转换为适当的长格式，然后表现得与长格式是由（如果优化器不这样做，那么可以说优化器存在问题；在决定如何处理查询之前，应该将查询简化为规范形式。但是，即使是最好的优化器也经常存在盲点. 学习如何避免这些是一种艺术形式，并且本质上是特定于 DBMS 的。）

当优化器认为索引会提高查询性能时，它会使用索引。当索引不会提高性能时，它会被忽略（如果优化器有任何好处）。有时，这取决于索引的统计数据是否是最新的。

在数据仓库系统中，可以设计和配置系统以非常快速地对表进行顺序扫描；在这样的系统中，如果索引的选择性使得使用它会提取超过 25% 的行，那么执行全表扫描实际上比使用索引更快。

想想看。通过索引读取时，DBMS 必须至少进行两次读取；它从索引页读取有关行的信息，然后必须从数据页读取行。

一些 DBMS 提供仅索引表。所有数据都在索引中。其他 DBMS 提供了一种机制，您可以说“索引在 A、B、C 列上是唯一的；但是，在数据中也包括 D 和 E 列”。然后，如果查询需要来自 A、B、C、D 或 E（或任何组合）的数据，并且对其他列没有过滤，则 DBMS 只需扫描索引，而不是表页。

通常，您会在一个页面中获得许多索引行。但是，对于某些表，读取索引可能需要读取比读取行更多的数据。考虑包含两个（4 字节）整数 ID 值的原型多对多映射表。这需要数据页中每行 8 个字节，但索引可能需要 4-8 个字节的开销（因为索引键条目存储了两个 ID 值以及在磁盘上定位相应行所需的信息）。因此，那里的索引扫描可能涉及两倍于数据扫描的磁盘 I/O，即使索引扫描是“仅索引”完成的。

这只是触及使用或不使用索引的可能原因的表面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T15:34:35.113

您的问题的 SQL 在我看来格式不正确。您是否正在寻找列的非空值？这应该使用索引：

```
select * from myTable where myInt is not null 
```

# winapi - LPHANDLE 与 HANDLE

> ID：391649
> 
> 赞同：3
> 
> 时间：2008-12-24T15:20:42.300
> 
> 标签：winapi, handle

在浏览一些代码时，我发现了对[OpenPrinter()](http://msdn.microsoft.com/en-us/library/dd162751.aspx)的调用。代码编译并且工作正常。但是，我们传递的是 a`HANDLE`而不是`LPHANDLE`（如 MSDN 中所指定）。我发现在`windef.h`以下声明中存在：

```
typedef HANDLE FAR          *LPHANDLE; 
```

LP 代表什么？我应该使用 a`LPHANDLE`还是保留`HANDLE`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-24T15:23:17.537

“LP”代表长指针。

HANDLE != LPHANDLE，就像 DWORD != DWORD*（或 LPDWORD）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-24T15:30:24.607

LP 代表长指针。在这种情况下，它是指向句柄的指针。

```
HANDLE h = <winapi function>();
LPHANDLE ph = &h; 
```

您可以通过取消引用指针以与处理句柄相同的方式使用它：

```
HANDLE anotherh = *ph;
or
<winapi function>(*ph, ...); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T00:31:19.533

**FAR**构造可以追溯到*8086/8088 CPU*和它使用的分段内存模式的时代。在那些日子里，你可以有**NEAR**和**FAR**指向内存的指针。

**LP**（长指针）只是早期*Microsoft Hungarian Notation*的遗留物。

如今，Win32 内存模型是扁平的，因此**NEAR**和**FAR**指针基本相同。但是，虽然*近指针*现在与*远*指针相同，但这并不意味着指针与句柄相同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-24T15:50:44.987

只是为了给你一些背景知识，长指针也称为远指针，与 16 位窗口中的普通 16 位指针不同。操作系统使用分段内存模型，您可以在其中从一个段偏移或有一个段 + 偏移量，这是一个长指针。匈牙利符号 LP 用于这些长指针，并且由于这些遗留原因仍然散布在整个 windows api 中。

当然，在 32 位和 64 位 Windows 操作系统中使用的是平面内存模型，并且这些操作系统中的指针之间没有区别（尽管 PAE 在概念上添加了一些类似的东西）。

# asp.net - 带有通配符映射的 ASP.Net 1.1 在默认文档上给出 404

> ID：391661
> 
> 赞同：0
> 
> 时间：2008-12-24T15:24:58.533
> 
> 标签：asp.net, url-rewriting, friendly-url, asp.net-1.1

我有一个应用程序，它被要求为使用大量查询字符串值的动态页面创建一个友好的 url。在互联网上进行一些研究后，我发现我需要创建一个 HttpModule 或 HttpHandler 来执行路由，然后在 IIS 中设置一个通配符映射到 aspnet_isapi.dll 的.Net v1.1（删除验证文件存在复选框）。

使用虚拟目录进行测试，在我的 XP Pro 机器上本地一切正常。

当我将它提升到测试环境（Server 2003）时，直接访问页面和路由工作正常；但是，默认文档不再有效。我在网上找到了一个参考，指出由于 ASP.Net WP 和 IIS6 的分离，IIS6 在默认文档逻辑之前处理通配符映射。

我试图更新我的 HttpHandler 以考虑 / 路由；但是，路由页面上的代码不再起作用。在 Web.Config 中，我尝试使用路径作为 * 以及 / 并获得相同的响应。我也在使用我觉得不正确的 Response.Redirect 。

我也尝试过 URLRewriter.net；然而，在花了几个小时试图让它工作后它没有工作（它只是因为某种原因不会在这个 asp.net 1.1 应用程序中路由）。

关于可能是什么原因的任何想法，或者我如何将我的路由带到默认页面和我的特定页面设置，同时不理会其余部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-24T16:53:24.407

我在 URLRewriter 的 README 信息中发现了一些拼写错误。根据在线文档而不是二进制文件附带的示例对其进行配置后，我能够让它工作并在本地解决我的问题。

在我将代码提升到我的测试服务器后，预期的路由正在运行，但默认的域路由仍然没有。我稍微修改了默认路由的 URL 模式，一切都开始工作了。

# c++ - 使用热方程从分散的数据中插入地形表面

> ID：391673
> 
> 赞同：2
> 
> 时间：2008-12-24T15:32:25.117
> 
> 标签：c++, surface, data-modeling

这是我在这个论坛的第一个问题，所以请多多包涵，希望我没有违反任何规则。我正在研究将分散的 3d 数据建模为网格函数的不同方法（通过 xy 支持，z=z(x,y)）。

在回答另一个问题时，coryan 很好地提到了[使用热方程插入（近似）](https://stackoverflow.com/questions/313297/simple-way-to-interpolate-between-points-in-3d-space-to-form-a-smooth-surface#316107)我听说过并渴望学习的地形表面的方法，或者甚至找到并行实现？如果它在公共领域，或者至少进一步解释它是如何完成的，请coryan或任何其他人指出我这样的实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T15:46:19.863

不确定热方程，但我解决这个问题的方法是通过[TIN 建模](http://en.wikipedia.org/wiki/Delaunay_triangulation)。查看[Herbert Edelsbrunners](http://en.wikipedia.org/wiki/Herbert_Edelsbrunner)关于主题的书，[用于网格生成的几何和拓扑](https://rads.stackoverflow.com/amzn/click/com/0521793092)。我会把它作为必读的。同样值得一提的是[C 语言中的 Joeseph O'Rourkes Computational Geometry](http://maven.smith.edu/~orourke/books/compgeom.html)，虽然更通用，但它确实包含了工作示例并制作了一本有用的食谱。

在开源方面，请查看以下[Code Guru 链接](http://www.codeguru.com/cpp/cpp/algorithms/general/article.php/c8901)并查看[Paul Bourkes](http://local.wasp.uwa.edu.au/~pbourke/cgi-bin/sitesearch.cgi)的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T15:53:02.407

好吧，他指出的维基百科文章是一个好的开始。想想在一杯热茶里放一块冰块：第一瞬间，它们之间的梯度是陡峭的：

```
     +-----
     |
-----+

```

但是热量穿过梯度与梯度成正比，所以它开始快速变化，然后随着时间的推移变化更慢。（这就是为什么它是一个抛物线偏微分方程；变化率在变化，所以你有 ∂²t。）所以你评估点，在每一步调整地形，以平滑过程。并行执行只是您可以将每个网格点及其相邻值交给每个步骤的单独进程；它不依赖于其他任何东西。

# c# - 奇怪的 DLL + InterropServices 问题

> ID：391693
> 
> 赞同：1
> 
> 时间：2008-12-24T15:44:20.817
> 
> 标签：c#, c++, dll, interop

我正在尝试学习捆绑非托管 C++ 和 .NET 的基础知识。所以，我已经从 C# 编译和调用了 DLL。伟大的。现在我遇到了这个奇怪的问题：

这是我的 C++ 文件`Main.cpp`：

```
#include <stdio.h>

extern "C" __declspec(dllexport) void DisplayHelloFromDLL()
{
    printf ("Hello from the World of 1986!\n");
} 
```

和 C# 文件，`Program.cs`：

```
using System; using System.Runtime.InteropServices;

namespace FancyApp {
    class Program
    {
        [DllImport("ConsoleApp.dll")]
        public static extern void DisplayHelloFromDLL();

        static void Main()
        {
            Console.WriteLine("Hello form the World of 2008!");
            DisplayHelloFromDLL();

            Console.WriteLine("Press any key to exit");
            Console.ReadKey();

       }
    }
} 
```

很简单。构建时，我`ConsoleApp.dll`从 C++ 端和`FancyApp.exe`C# 获取。

运行时输出

> 您好，2008 年的世界！
> 
> 你好，来自 1986 年的世界！
> 
> 按任何一个键退出

正如它应该的那样，除了在 VS2008 的发布模式下（按 F5），我得到

> 您好，2008 年的世界！
> 
> 按任何一个键退出

现在，如果我去 Explorer 并运行`FancyApp.exe`没有 VS 的发布版本，它运行良好。

想法？

我在[这里](http://www.tian.co.za/temp/ConsoleApp.zip)上传了我的解决方案文件夹（180kb）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T16:15:29.897

好吧，我在这里看到了相同的行为，我无法完全解释。但是我认为尝试在调试模式 (F5) 下针对发布版本运行，您应该期待未定义的行为。如果我使用 ctrl-F5 它运行正常。

由于这是有效的，我们可以推断二进制文件是正确构建的，所以不存在编译器问题，但是您会看到一些奇怪的调试器工件。

这可以通过进入 FancyApp 的属性并在“调试”选项卡上取消选中“启用 Visual Studio 托管进程”来证明。如果你这样做，它会按你的预期工作。为什么，确切地说，我不能说。这里的教训是不要尝试调试发布版本。

# java - VisualVM 的问题 - 连接到远程主机时

> ID：391708
> 
> 赞同：7
> 
> 时间：2008-12-24T15:51:38.650
> 
> 标签：java, visualvm

我是 Java 开发新手，第一次使用 VisualVm。我在从 VisualVm 界面连接远程主机时遇到了一些问题。

我在远程主机上运行了 JDK 1.6，并在同一主机上启动了 jstatd 服务器。当我从本地计算机上运行的 VisualVm 接口连接远程主机时，它已连接，但接口中缺少 Profiler 选项卡和 Threads 选项卡。可能是什么问题。

我的操作系统是 SUSE Linux。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T18:19:01.910

探查器选项卡仅适用于本地 JVM。

我不确定为什么不显示线程选项卡。它对我有用。

我读过[Netbeans](http://www.netbeans.org/features/java/profiler.html)有远程分析支持。但我从未亲自使用过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T13:59:57.687

我在尝试监控 Jboss 4.0.2 时遇到了同样的问题，因为该版本有自己的 mbean 服务器，这是你的情况吗？无论如何，请确保您使用的是 jdk 1.6.0u7 或更高版本，否则您必须关闭类共享才能使 visualvm 工作 (-Xshare:off)

我希望这会有所帮助，也许您可​​以提供有关您尝试分析/正在使用的 JVM 的应用程序性质的更多详细信息

# windows - 在 Vim 中，将文件中的所有行合并为一行的最简单方法是什么？

> ID：391710
> 
> 赞同：62
> 
> 时间：2008-12-24T15:51:56.810
> 
> 标签：windows, vim

我想将文件中的所有行合并为一行。最简单的方法是什么？我在尝试使用替换时运气不佳（`\r\n`或者在 Windows 上`\n`似乎没有正确选择）。`s/\r\n//`在范围表达式中使用`J`似乎也不起作用（可能是因为在执行第一个命令后范围不再处于“同步”状态）。

我试过`:1,$norm! J`了，但这只做了一半的文件——这是有道理的，因为它只加入了每一行一次。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2008-12-24T16:31:12.160

其他方式：

```
ggVGJ 
```

" `ggVG`" 直观地选择所有行，然后 " `J`" 将它们连接起来。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-12-24T15:55:33.993

啊，我找到了答案。

```
:1,$join 
```

奇迹般有效。

**编辑**：正如评论中指出的：

```
:%join   -or-    :%j 
```

...删除范围。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2012-04-07T16:11:51.280

您可以从正常模式开始使用 3 次击键：

```
:%j 
```

*   `:`进入命令模式
*   `%`引用文件中的所有行
*   `j`执行连接命令

现在看来，这在行之间增加了一个空格。我不确定你是否想要这个。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-12-24T17:00:38.120

您只需少敲三下即可完成此操作：

```
:1,$j 
```

不是埃德盛大吗？

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-24T16:55:47.647

神秘方式：

```
qqqqqJ@qq@q 
```

（前三个`q`清除`q`寄存器，`qqJ@qq`记录一个宏到`q`寄存器执行一个连接，然后调用`q`，最后`@q`运行它。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-12-24T22:36:11.377

我很惊讶没有人提到另一种方式：

```
:%s/\n/ / 
```

我同样感到惊讶的是，没有人指出该范围`1,$`有一个写成的速记`%`。

（这与加入线条的作用不同，但取决于实际上可能更合适的情况。）

# svn - 如何在 svn 存储库中搜索任何修订版中是否存在文件

> ID：391718
> 
> 赞同：27
> 
> 时间：2008-12-24T15:55:04.150
> 
> 标签：svn, tortoisesvn

我如何搜索一个名为的文件`foo.txt`是否曾经提交到我的 svn 存储库（在任何修订版中）？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-24T16:15:44.687

右键单击已签出文件夹的根 > TortoiseSVN > 显示日志

您也可以在那里输入文件名。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-24T16:10:51.107

这应该适合你：

```
svn log -r 0:HEAD -v $REPOSITORY_PATH | grep "/foo.txt" 
```

这将为您提供文件的路径和日志中的状态。如果你得到任何点击，你就知道它在某个时候存在。如果您没有得到任何结果，那么在任何版本的存储库中都没有匹配的内容。您还将看到每个日志行的状态，例如：

```
   /some/path/foo.txt
   D /some/path/foo.txt

```

但我猜额外的信息对你来说不是问题。:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-08-06T13:08:03.153

使用 Subversion 1.8+ 客户端，[新的`--search`和`--search-and`选项可用于`svn log`command](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.log.html)。这些选项不允许在存储库中执行全文搜索，并且仅查找以下数据：

*   修订的作者（`svn:author`未版本化的属性），
*   日期（`svn:date`未版本化的属性），
*   记录消息文本（`svn:log`未版本化的属性），
*   更改的路径列表（即受特定修订影响的路径）。

据我猜测，您可以使用以下命令行搜索“foo.txt”：

`svn log -v --search "foo.txt"`.

以下是有关这些新`svn log`搜索选项的完整帮助页面：

```
 If the --search option is used, log messages are displayed only if the
 provided search pattern matches any of the author, date, log message
 text (unless --quiet is used), or, if the --verbose option is also
 provided, a changed path.
 The search pattern may include "glob syntax" wildcards:
     ?      matches any single character
     *      matches a sequence of arbitrary characters
     [abc]  matches any of the characters listed inside the brackets
 If multiple --search options are provided, a log message is shown if
 it matches any of the provided search patterns. If the --search-and
 option is used, that option's argument is combined with the pattern
 from the previous --search or --search-and option, and a log message
 is shown only if it matches the combined search pattern.
 If --limit is used in combination with --search, --limit restricts the
 number of log messages searched, rather than restricting the output
 to a particular number of matching log messages. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-16T12:39:33.903

我使用 powershell 和命令`svn list -R`递归地搜索 repo，然后将结果通过管道传输到`findstr`或类似的地方，例如：

`svn list -r HEAD -R | findstr /R /I "\/obj\$/ \/bin\/$"`

# ruby-on-rails - 在后台设置模型属性，基于另一个属性？

> ID：391725
> 
> 赞同：0
> 
> 时间：2008-12-24T15:58:55.623
> 
> 标签：ruby-on-rails

我有一个具有多个属性的拍卖模型，其中两个是**current_auction:boolean**和**schedule_start:datetime**。当 schedule_start 成为当前时间时，如何使布尔值（默认为 false）变为 true？如果您需要更多信息，请告诉我。我假设我需要使用脚本/运行程序，但没有使用它的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-24T16:07:38.853

我不会将 current_auction 存储为属性。Current_auction 是一种取决于 schedule_start 时间与当前时间的状态。不要将其放入数据库中，而是将其添加为模型上的方法，该方法将 schedule_start 与当前时间进行比较，并根据计算返回 true/false。

如果您需要根据是否为当前进行选择，请使用取决于 schedule_start 时间而不是当前/非当前的选择逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T17:21:01.683

正如 tvanfosson 所说，您很可能根本不希望它在数据库中。

但是如果你在数据库中需要它（比如你需要用 Sphinx 搜索它），你可能需要一个数据库触发器。有关一些信息，请参阅[MySQL 5.0 Reference Maunual](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)（假设您使用的是 MySQL）。

对于需要更复杂逻辑的事情，我会设置一个排队系统并在队列上添加一条消息以更新`after_save`挂钩中的该属性。这样它会触发更新，但实际上不会等待更新完成后再返回给用户。我有一个[关于异步队列](https://stackoverflow.com/questions/124360/what-is-the-best-way-to-run-asynchronous-jobs-in-a-rails-application)的问题，最后我使用了 Starling 和 Workling。

# ruby-on-rails - 在 Rails 上运行 Perl 的可行性是什么？

> ID：391726
> 
> 赞同：3
> 
> 时间：2008-12-24T15:59:04.220
> 
> 标签：ruby-on-rails, perl

Rails 是一个很棒的平台，但它没有 Perl 的历史，所以我认为将它们放在一起可能是一个有趣的想法。有很多 Rails 经验的人看到这有什么问题吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-24T16:04:40.357

Rails 不是一个平台。Rails 是一个用 Ruby 编程语言编写的 Web 框架。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-24T16:11:14.883

这是完全不可行的。

“Rails”是一个用 Ruby 编写的框架。

“Ruby on Rails”总是让我觉得是倒退逻辑。

因此，“在 Rails 上运行 Perl”将是一个无意义的术语，

Perl On Rails（用 ruby​​ 编写）。

充其量，您可以尝试在 Perl 中从头开始重写 Rails，但这样做没有多大意义。目前所有现有的 Rails 实用程序都是用 Ruby 编写的，因此它们还需要移植到 Perl。

何必呢，我们有 Catalyst，以及 CPAN 上已经存在更长的模块列表

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-24T16:10:44.073

BBC 实际上也走上了类似的道路，不久前创建了他们自己的[“Perl on Rails”](http://www.bbc.co.uk/blogs/radiolabs/2007/11/perl_on_rails.shtml)。听起来这对他们有用。我还没有看到任何关于发布代码的信息，所以你必须自己编写。

我看到的问题是，就测试框架、记录它并优化它的性能而言，你只能靠自己。Rails 已经存在了很长时间，以至于很多人已经完成了这些步骤。但是如果你有时间和精力，Perl 和 Ruby 有足够的相似之处，很多来自 Rails 的想法都可以在 Perl 中实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-24T21:25:58.850

由于 Rails 是用 Ruby 编写的，Perl on Rails 意味着 Rails 是用 Perl 编写的，不是吗？

让 Perl 跳过同样的圈子似乎有点适得其反——为什么不使用已经存在的众多 MVC 框架之一呢？只需[谷歌“mvc 框架 perl”](http://www.google.co.uk/search?q=mvc+framework+perl)

哦，关于 Beeb，他们确实在 Rails 上构建了 Perl，但他们[并不是真的想要](http://www.bbc.co.uk/blogs/radiolabs/2007/11/perl_on_rails.shtml).

当然，Perl 只是没有 COBOL 或 ALGOL 的历史。FORTRAN on Rails 怎么样？任何人？任何人？布勒？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-24T21:42:13.263

实际上，至少有两个“PHP on Rails”项目：[TRAX](http://www.phpontrax.com/)和[Akelos](http://akelos.org/)，因此可以将 Rails 移植到其他语言（为什么不应该呢？）。

然而（正如 Cody 指出的那样）Rails 是用 Ruby 语言编写的*，*并且它充分利用了 Ruby 特性（可能）是其他语言不提供的。所以我认为使用现有的 MVC 框架（如[Catalyst](http://www.catalystframework.org/)），甚至从头开始编写一个新框架比移植 Rails 更有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T08:12:24.860

似乎可以在使用 phusion 乘客的同一 apache 虚拟主机上与 mod_perl 应用程序（例如 Catalyst）一起部署 rails。但是，mod_perl 应用程序必须处理子 URI，而 phusion 乘客处理站点的根目录。

您只需对特定位置使用 SetHandler 指令，并使用 PerlModule 指令指定哪个 perl 模块处理请求

# sharepoint - 在 SharePoint 的“我的网站”的文档库中的面包屑导航中显示主页

> ID：391728
> 
> 赞同：1
> 
> 时间：2008-12-24T16:03:21.107
> 
> 标签：sharepoint, navigation, breadcrumbs

我的站点中文档库中的面包屑显示：
用户名 > 文档库名称

是否可以将其更改为“主页 > 用户名 > 文档库名称”或“主页 > 文档库名称”

实现这一目标的最简单方法是什么？
亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T21:37:37.323

如果它是一个公共的 MySite，我建议从默认母版创建一个新的自定义母版页并直接修改 HTML。这可以通过使用 SharePoint Designer 打开网站来实现 - 创建新的母版页后，将其设置为默认自定义。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-12-26T10:24:12.243

在您的 MySite 站点设置中，转到“门户站点连接”并设置您的主页名称和 URL。

要为您的所有我的网站执行此操作，您需要两者：

*   为所有现有的 mysites 编写操作脚本（在 PowerShell 中很容易）
*   对所有新的 mysites 使用功能装订：http: [//blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx](http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx)

**编辑：（精度，因为我被低估了）这是你能得到的。**

# ruby - 你如何制作一个窗口来填满整个屏幕？

> ID：391731
> 
> 赞同：1
> 
> 时间：2008-12-24T16:05:27.030
> 
> 标签：ruby, shoes, maximize

有人可以给我一个关于如何在鞋子中制作一个窗口来填满整个屏幕的指针吗？我希望有一个类似于 Writeroom 的窗口。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T17:45:54.267

现在看来是不可能了，可惜了。

# wpf - 您如何知道您的 WPF 控件是否正在呈现？

> ID：391732
> 
> 赞同：6
> 
> 时间：2008-12-24T16:06:48.510
> 
> 标签：wpf

我有 2 个标签项。在 1 号选项卡中，我有一个与窗口调整大小事件相对应的控件，需要调用 PointToScreen()。

问题是 2 号选项卡处于活动状态，我调整了窗口大小，1 号选项卡中的控件反应并失败，因为它的视觉没有被呈现，我得到“这个视觉没有连接到 PresentationSource”异常。

你知道在我打电话给 PointoScreen 之前如何检查这个案例吗？

谢谢爱丽儿

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-24T17:28:04.947

您可以检查“IsVisible”——这对应，不是作为比较可见性属性的快捷方式，而是告诉您该事物是否正在屏幕上呈现。我不完全确定这如何影响 UIElements 的虚拟化，但我认为它正确地意识到了这些场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T16:15:31.550

我将执行此操作的方式是在后面的代码中，根据选择的选项卡添加和删除事件处理程序。当 Tab1 被选中时，在控件上为 Window Resize Event 执行 AddHandler，当 Tab1 未被选中时（即不同的选项卡出现在前面），为控件执行 RemoveHandler。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-28T15:06:50.870

我遇到了这个异常的类似问题。我订阅了选项卡控件的 SelectedChanged 事件，这并不意味着 WPF 中的选择发生了变化。 有关详细信息，请参阅[http://dotbay.blogspot.com/2009/10/in-wpf-selectionchanged-does-not-mean.html 。](http://dotbay.blogspot.com/2009/10/in-wpf-selectionchanged-does-not-mean.html)希望对你有帮助。亚历克斯。

# sql - 在单独的 sql 服务器上检索数据

> ID：391744
> 
> 赞同：1
> 
> 时间：2008-12-24T16:12:47.220
> 
> 标签：sql, sql-server

我们有一种情况，我们的应用程序调用 sql 2000 服务器上的一些存储过程。现在我们必须从另一个通过 vpn 连接的 sql 2000 机器获取一些数据。

从一个 sql server 到另一个 sql server 执行 CRUD 操作的语法是什么样的？

两台数据库服务器都是 SQL 2000 并运行 Windows 2003。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T16:17:09.223

您可以使用 SQL Server 的[链接服务器功能](http://msdn.microsoft.com/en-us/library/aa213778.aspx)。

> 链接服务器配置允许 Microsoft SQL Server 对不同服务器上的 OLE DB 数据源执行命令。链接服务器具有以下优势：
> 
> *   远程服务器访问
>     
>     
> *   能够在整个企业的异构数据源上发布分布式查询、更新、命令和事务。
>     
>     
> *   以类似方式处理不同数据源的能力。

查询可能如下所示：

```
 SELECT * FROM MyRemoteServer.MyDB.dbo.MyTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T16:20:00.357

您只需使用完全限定名称引用链接服务器中的数据，即：SELECT Columns FROM ServerName.DatabaseName.dbo.TableName

[http://searchsqlserver.techtarget.com/expert/KnowledgebaseAnswer/0,289625,sid87_gci1155184,00.html](http://searchsqlserver.techtarget.com/expert/KnowledgebaseAnswer/0,289625,sid87_gci1155184,00.html)

附带说明 -

确保分布式事务协调器服务正在客户端和服务器 DTC 上运行。

# c++ - 匿名对象可以在 C++ 中声明为静态的吗？

> ID：391756
> 
> 赞同：2
> 
> 时间：2008-12-24T16:22:00.930
> 
> 标签：c++, static, anonymous

这是允许的吗？：

```
class A;
void foo()
{
    static A();
} 
```

当我尝试这样做时，我得到了信号 11，但以下工作正常：

```
class A;
void foo()
{
    static A a;
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T16:28:54.863

没有。C++ 中没有“匿名对象”这样的东西。有这样的事情，将对象定义为类型 A 会立即被丢弃；你写的是一个表达式，它返回一个从未分配给变量的 A 对象，就像 printf 的返回码通常从未分配或使用一样。

在该代码中，如果它有效，您将声明“无对象”要在堆外分配。由于没有要分配的对象，因此没有意义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T16:40:09.880

您可以创建“匿名”自动变量，但不能创建静态变量。以下将创建 A 类的对象并调用构造函数，然后在函数退出时调用析构函数。

```
class A;
void foo()
{
    A();
} 
```

您可以通过在堆上分配对象或在预分配位置[适当地构造它](https://stackoverflow.com/questions/222557/cs-placement-new)来获得类似的效果。

```
void foo()
{
    new A();
}

void foo()
{
    static char memory[sizeof (A)];
    new (memory) A();
} 
```

但是，在这两种情况下，都无法正确清理对象，因为没有保留指针以供以后调用删除。即使将释放静态内存，也永远不会调用析构函数。匿名对象只有在与垃圾收集器一起使用时才真正产生。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T17:08:03.393

不知何故，我认为这家伙是在单例构造函数的副作用之后。

无论如何，只要给这该死的东西一个变量名就行了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-14T17:39:19.957

C++ 中当然**有匿名对象！**A(100) 是此示例[中的匿名对象](http://codepad.org/EIbxTNVw)

但是，如果您考虑一下，创建静态匿名对象是没有意义的。

# javascript - 查找非活动 CSS 属性

> ID：391757
> 
> 赞同：0
> 
> 时间：2008-12-24T16:23:22.020
> 
> 标签：javascript, css, dom

是否可以通过 Javascript 确定 CSS 文件中的样式？

我正在尝试检测将应用于处于某种状态的元素的 CSS 属性，`:hover`在这种情况下，但这些属性当前在元素上没有处于活动状态。我曾考虑过克隆元素，将克隆附加为同级`display: none`并以这种方式查询属性，但我不知道如何`:hover`通过 Javascript 强制样式。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T19:23:35.830

我相信您对作为( )`styleSheets`属性的数组感兴趣。该数组索引当前页面引用的所有样式表，并允许您遍历每个表中的所有样式规则。用于访问 css 规则的 W3C 数组（Firefox、Opera、Safari）是，而微软的数组是. 以下代码片段取自[www.quirksmode.org](http://www.quirksmode.org)： `document``document.styleSheets``cssRules``rules`

```
`var theRules = new Array();
if (document.styleSheets[1].cssRules)
    theRules = document.styleSheets[1](http://www.quirksmode.org).cssRules
else if (document.styleSheets[1].rules)
    theRules = document.styleSheets[1](http://www.quirksmode.org).rules` 
```

`现在`theRules`包含文档的第二个样式表的规则。有关从 JavaScript 访问 CSS 规则的更多信息，请参阅 quirksmode 的[参考](http://www.quirksmode.org/dom/changess.html)和[兼容性表](http://www.quirksmode.org/dom/w3c_css.html)。`

 `* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:40:30.490

如果我正确理解了您的问题，那么您正在寻找的似乎是 CSS（伪）类的 XPath。除了使用 Ajax 获取 CSS 文件并使用正则表达式搜索之外，我不知道有任何方法可以从 CSS 文件中检索样式信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T19:30:04.527

要通过 JS 确定样式，您可以像这样使用 className，例如：

> item.onmouseover = gohover;
> 
> item.onmouseout = nohover;
> 
> 函数 gohover(){this.className = gClass;}

...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T16:55:38.303

悬停样式由浏览器应用，取决于鼠标移动。我不认为你可以通过 JS 强制它。但你为什么想要？只需定义另一个 css 类并通过 JS 中的 className 属性分配它。

# pdf - XSL FO 内联对齐

> ID：391759
> 
> 赞同：28
> 
> 时间：2008-12-24T16:24:42.703
> 
> 标签：pdf, xsl-fo

我需要在同一行上左右对齐文本。这应该是可能的，但我似乎找不到办法。我正在使用 Apache FOP 将 xml 转换为 pdf。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-26T12:21:05.420

优雅不是一个明确的要求，但这应该符合要求：

```
<fo:block text-align-last="justify">
  LEFT TEXT
  <fo:leader leader-pattern="space" />
  RIGHT TEXT
</fo:block> 
```

这通过对齐块中的最后一行文本来工作，以便文本从该行的左侧开始并在右侧结束。通常在目录页面上使用的前导符会拉伸以填充左右文本之间的空间。通常它被用作`<fo:leader leader-pattern="dots" />`，这会产生一段时期，但在这种情况下，它只是提供了一个空间的鸿沟。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-25T15:17:34.553

这可以解决问题：

```
<fo:table>
  <fo:table-column />
  <fo:table-column />

  <fo:table-body>
    <fo:table-row>
      <fo:table-cell>
        <fo:block>LEFT TEXT</fo:block>
      </fo:table-cell>
      <fo:table-cell>
        <fo:block text-align="right">RIGHT TEXT</fo:block>
      </fo:table-cell>
    </fo:table-row>
  </fo:table-body>
</fo:table> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-08-22T21:37:35.043

```
<fo:inline-container vertical-align="top" inline-progression-dimension="49.9%">
    <fo:block>left content</fo:block>
</fo:inline-container>
<fo:inline-container vertical-align="top" inline-progression-dimension="49.9%">
    <fo:block>right-content</fo:block>
</fo:inline-container> 
```

经验证可使用 FOP 2.0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T22:59:16.443

我现在没有时间对此进行测试，但请查看[http://www.w3.org/TR/xsl/#fo_float](http://www.w3.org/TR/xsl/#fo_float)

一个向右浮动另一个向左浮动 - 如果我想做你所描述的事情，我会试一试

你也可以用一张桌子

除非右对齐和左对齐，否则您的意思是合理的...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-21T11:47:28.670

我创建了两个块，并在第二个块上设置了这个属性：

```
margin-top="-4mm" 
```

或者你的字体大小和边距底部是什么（只是看起来它们在同一行）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-24T16:38:13.470

这是可能的，我不确定确切的输出是什么，但您是否尝试过：

```
<fo:block-container>
   <fo:block text-align="left">text</fo:block>
   <fo:block text-align="right">text</fo:block>
</fo:block-container > 
```

我有一段时间没有做过 XSLFO，但我当然可以推荐 Stylus Studio 用于 XSL-FO 开发（以及一般的 XML），应用内调试和预览让我在按时完成最后期限时节省了时间。您也可以使 Stylus 与 Apache FOP 处理器一起工作。

PS：如果我在家里也正确设置了 Apache FOP 等，我会仔细检查。

# .net - 用于设置 CurrentCulture 的线程创建事件

> ID：391766
> 
> 赞同：4
> 
> 时间：2008-12-24T16:30:37.807
> 
> 标签：.net, multithreading, globalization, culture

我们的应用程序允许用户更改他们运行它的文化，并且该文化可以不同于底层的操作系统文化。我发现这样做的唯一方法是为每个线程设置 Thread.CurrentThread.CurrentCulture 和 Thread.CurrentThread.CurrentUICulture。

唯一的问题是我们必须为每个线程设置文化，并且我们需要记住在创建新线程时这样做。如果您将线程设置为另一种文化，然后创建一个新线程，它将获得操作系统的文化，而不是创建它的线程的文化。

我想找到一种更好的方法来做到这一点。我只能想到两件事，但我不知道是否有可能。

1.  在应用程序级别设置文化，以便所有线程默认为该文化。这可能吗？
2.  我可以订阅的任何地方都有线程创建事件吗？这样我可以设置一个处理程序来设置线程创建的文化。

任何想法或帮助都会受到欢迎，即使我需要 PInvoke 到 Win32 API。提前致谢。

**编辑：**我发现[这个问题](https://stackoverflow.com/questions/93153/easy-way-to-set-currentculture-for-the-entire-application)很相似，但没有找到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T16:46:20.567

可能不是确切的解决方案，但是创建一个负责创建线程的类怎么样？

```
class MyThreadFactory
{
    public static Thread getThread()
    {
        Thread a = new Thread(..);
        a.CurrentCulture = xxxx;
        return a;
    }
} 
```

用法：

```
Thread newThread = MyThreadFactory.getThread(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T16:46:57.477

1.  您可以将所有文化逻辑和静态资源文件放在 UI/Presentation 层中，而只需担心 UI 线程的文化（假设此处为桌面应用程序）。这将包括资源文件中的任何翻译、任何特定于文化的格式等。
2.  如果第一个想法无法实现，您可以创建一个线程助手类，在创建长时间运行的线程时为您设置文化。您还需要设置所有线程池线程的区域性。

文化是 Windows 中特定于线程的概念，Windows 中的线程实际上与进程或应用程序域无关。线程和保存文化信息（我知道）的操作系统之间没有抽象级别，因此您必须在每个线程上设置它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-01T02:52:42.833

.NET 4.5 中的 CultureInfo 类中添加了两个新属性来解决此问题，即[DefaultThreadCurrentCulture](http://msdn.microsoft.com/en-us/library/vstudio/system.globalization.cultureinfo.defaultthreadcurrentculture)和[DefaultThreadCurrentUICulture](http://msdn.microsoft.com/en-us/library/vstudio/system.globalization.cultureinfo.defaultthreadcurrentuiculture)。

现在您可以设置这两个属性，所有新线程都将设置为默认文化而不是系统文化。这些属性还将为所有没有明确设置其文化的现有线程设置文化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-02T07:45:17.737

只是为了添加到@Rob Prouse 的答案。这是一个快速演示。

1.  设置应用程序初始化的文化：

    ```
     if(CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol != "N$")
      {
           CultureInfo customCulture = CultureInfo.CreateSpecificCulture(CultureInfo.CurrentCulture.Name);
           customCulture.NumberFormat.CurrencySymbol = "N$";

           CultureInfo.DefaultThreadCurrentCulture = customCulture;
           CultureInfo.DefaultThreadCurrentUICulture = customCulture;
       } 
    ```

2.  在我的 .ToString() 上使用文化信息。

    ```
     .ToString("C", CultureInfo.DefaultThreadCurrentCulture) 
    ```

# asp.net - 拒绝访问路径“C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\Temporary ASP.NET Files\cbnonreg\fc933fca\bbf91eea”

> ID：391767
> 
> 赞同：20
> 
> 时间：2008-12-24T16:31:05.810
> 
> 标签：asp.net, webserver

我得到错误

> 拒绝访问路径“C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\Temporary ASP.NET Files\cbnonreg\fc933fca\bbf91eea”。

每当我尝试访问我新部署的站点时。
我查看了路径，发现它`/cbnonreg\fc933fca\bbf91eea`不存在。
请问我该怎么办？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2018-01-09T19:34:19.613

我收到此错误是因为我在 Visual Studio 的“异常设置”窗口中打开了所有“公共语言运行时异常”。

这一定是作为 ASP.NET 正常流程的一部分触发的异常之一。如果这是您的问题（或者如果您不知道“异常设置”窗口的作用并且您想将其重置为默认值），您可能应该打开“异常设置”窗口并单击“将列表恢复为默认设置” " 顶部的按钮，或者至少取消选中您不希望调试器中断的异常。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-24T16:37:49.570

这听起来像是权限问题。确保 ASPNET 帐户对 Temporary ASP.NET Files 文件夹具有完全访问权限。如果您的问题仍然存在，您还可以尝试运行“aspnet_regiis -i”命令重新安装框架，这也应该重置文件权限。

如果做不到这一点，您可以尝试使用进程监视器并过滤到 aspnet_wp.exe 进程来检查进程正在尝试做什么，并相应地更新文件权限。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-03-02T09:28:44.060

在我的情况下，如果我继续例如“mscorlib.dll 未加载”，则错误之后会出现进一步的异常。基于此，我在这里找到了可行的解决方案：[https](https://stackoverflow.com/a/27446877) ://stackoverflow.com/a/27446877 。

“转到工具，选项，调试，常规，仅启用我的代码”。

根本原因分析：我意识到在之前尝试过 Debug config 之后，我尝试在 IIS Express 下测试 Release config（当然没有调试）。我还在为 Release 使用 Web.config 转换。VS 要求我在应用启动时禁用 Just My Code。当我想返回调试时，我开始收到引用的错误。此线程中的解决方案提案均未成功。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-06T15:50:02.710

**在 Windows 8 上，您会收到此错误**

```
Microsoft (R) ASP.NET RegIIS version 4.0.30319.17929
Administration utility to install and uninstall ASP.NET on the local machine.
Copyright (C) Microsoft Corporation.  All rights reserved.
Start installing ASP.NET (4.0.30319.17929).
This option is not supported on this version of the operating system.  Administr
ators should instead install/uninstall ASP.NET 4.5 with IIS8 using the "Turn Win
dows Features On/Off" dialog,  the Server Manager management tool, or the dism.e
xe command line tool.  For more details please see http://go.microsoft.com/fwlin
k/?LinkID=216771.
Finished installing ASP.NET (4.0.30319.17929). 
```

**要从上面修复错误（Windows 8），请运行以下命令：**

```
dism /online /enable-feature /featurename:IIS-ASPNET45 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T16:41:39.580

这不时发生。尝试重新启动计算机并删除临时 ASP.net 文件夹下的所有内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-24T16:38:14.267

部署新版本时，您的 Web 应用程序似乎出现了问题。这不时发生。我通常尝试以下项目来解决问题：

1.  在服务器上打开并重新保存 web.config 文件。很多时候，这会导致程序集刷新并解决您的问题。

2.  删除“cbnonreg”文件夹。这将强制刷新程序集并解决问题。

3.  重新启动 IIS。这会清除所有临时文件，让您重新开始一切。

一次一个地测试这些问题，看看它们是否能解决您的问题。它们按“侵入性最小”的顺序排列，因此服务器上的其他应用程序不受影响。如果某些进程仍在尝试保留文件，则在执行问题 #2 时，您可能会遇到“权限被拒绝”错误。

希望这可以帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-08T16:38:27.270

我通过删除本地工作区并执行从 TFS 获取来解决了这个问题。

不起作用的事情：以管理员身份运行 VS，重新启动 VS，杀死内置的 ASP.NET IIS 开发服务器程序，进行清理和重建，重新启动计算机。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-06-17T16:28:06.690

我通过将完全控制权分配给 ASP.Net 临时文件夹上的 IIS_IUSRS 解决了这个问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-13T14:57:22.300

在非管理员模式下启动命令提示符，错误就会消失。无需在 Windows 7 上摆弄权限。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-15T06:47:46.037

此问题是由位于`C:\windows\Microsoft.Net\Framework`或中的临时文件夹之一的错误权限引起的`C:\windows\Microsoft.Net\Framework64`。

我想这应该归咎于一些 Windows 更新。在授予我的用户对该文件夹的完全访问权限后，`C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files`异常消失了！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-06-16T01:30:37.913

如果您在尝试在 Visual Studio 中调试应用程序时遇到此错误，请尝试以管理员身份运行 Visual Studio。它将提升使用的烫发并可能解决问题。

# c++ - 如何使用 c++ 将子级附加到 qt 中的 QDomDocumentFragment 对象

> ID：391772
> 
> 赞同：3
> 
> 时间：2008-12-24T16:35:45.503
> 
> 标签：c++, qt

我将 qt 4.4.3 与 c++ 一起使用。我想实现一个[QDomDocumentFragment](http://doc.trolltech.com/4.4/qdomdocumentfragment-members.html)对象，并将其作为函数的返回值传递。我使用与 QDomElement 对象相同的方式使用[appendChild()](http://doc.trolltech.com/4.4/qdomnode.html#appendChild)：

```
QDomDocumentFragment rootnode;

QDomNode initmodnode = doc.createElement("initmod");
QDomText initmodval = doc.createTextNode("4");
initmodnode.appendChild(initmodval);
rootnode.appendChild(initmodnode); 
```

以这种方式插入 7 个其他节点并从函数返回后，我注意到在返回 QDomDocumentFragment的[QDomElement节点上调用](http://doc.trolltech.com/4.4/qdomelement-members.html)[insertAfter()](http://doc.trolltech.com/4.4/qdomnode.html#insertAfter)并没有插入任何新的子节点。在函数内使用以下代码进行调试后，我意识到实际上没有节点被插入到根节点中：

```
QMessageBox::information(this->owner, QObject::tr("Debug"), QObject::tr("Node has children: ")+QString::number(rootnode.childNodes().size())); 
```

打印的消息是“节点有孩子：0”。我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T17:53:42.540

好的抱歉浪费大家的时间..看起来我需要使用以下方法创建文档片段：

```
QDomDocumentFragment rootnode = doc.createDocumentFragment(); 
```

# .net - Asp.net 会话到期重定向到登录页面

> ID：391784
> 
> 赞同：1
> 
> 时间：2008-12-24T16:41:14.790
> 
> 标签：.net, session, .net-2.0, asp.net-2.0

会话到期时重定向到登录页面的最佳方法是什么。我正在使用

```
sessionState mode="InProc" 
```

我可以在 web.config 文件中设置它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T16:50:37.377

要记住会话过期的技巧是，这发生在后台运行的工作进程中，并且没有直接的方法来通知用户而不返回服务器检查事物的状态。

我要做的是让页面注册一个 Javascript 块，在指定的超时后将用户再次重定向到登录页面：

```
Page.ClientScript.RegisterStartupScript(Me.GetType, "TimeoutScript", 
"setTimeout(""top.location.href = '~/Login.aspx'""," &
 ConfigurationManager.AppSettings("SessionTimeoutMilliseconds") & ");", True) 
```

您会注意到我的 web.config 文件中存储了实际的毫秒数，因此我可以根据需要调整超时长度。

使用它，结合 Global.asax 文件中的典型 Session_End 事件，可以非常简洁地处理我的 Web 应用程序中的会话超时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T06:12:36.283

回复有点晚，但是，如果您使用的是标准的 asp.net 会员提供程序，您也可以使用下面的配置。

这样做的基本思想是让您的身份验证 cookie + 会话同时过期。asp.net 的自动行为会将您带回定义的登录页面。auth cookie 上的“slidingExpiration”属性需要为“true”才能在会话处于活动状态时继续延长其寿命。

```
<system.web>
  <sessionState mode="InProc" cookieless="false" timeout="20" />
  <authentication mode="Forms">
    <forms name=".SAMPLESITEAUTH" loginUrl="~/Login.aspx" protection="All" timeout="20" slidingExpiration="true" path="/" cookieless="UseCookies"></forms>
  </authentication>
</system.web> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T18:09:46.750

一个选项不是将客户端计时器设置为盲目重定向，而是让计时器点击一个小型 Web 服务，该服务可以指示用户是否应该被重定向。这为您提供了更大的灵活性，您可以在许多情况下重定向用户，包括：

*   会话已过期
*   从另一台机器登录的相同用户帐户
*   站点正在进入维护模式，您想将用户踢出。

我已经成功地使用了这种方法来处理多个用户帐户。至于处理会话，即使存储在会话超时的哈希表中，您也可能希望监听会话超时。

当该用户调用 Web 服务时，您将它们从哈希中删除并告诉客户端代码重定向它们。

这种系统的另一个好处是您可以跟踪浏览器何时访问服务器，这样您就可以更好地了解谁仍然在线。

**编辑**

回应以下评论：

我不认为调用公共方法会更干净。一旦您这样做，您就会假设所有页面共享一个母版页或公共基类。我不想做出这样的假设。此外，如果您打算使用 PageMethods 方法，这将不起作用，因为 PageMethods 必须是静态的。

我不确定您的意图是什么，但是如果您要在每个请求上调用此方法，那么我会使用 http 模块并挂钩到管道中；但是，这仅在发出请求时才有效。通过使用带有客户端计时器的 Web 服务，即使用户没有发出任何请求，您也可以重定向用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T02:04:19.813

你能绑定到 Global.asax 文件中的 Session_End 事件吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-13T10:30:59.347

贝娄答案是有史以来最好的例子......

最好尝试这种方式：

```
Page.ClientScript.RegisterStartupScript(Me.GetType, "TimeoutScript", "setTimeout(""top.location.href = '~/Login.aspx'""," & ConfigurationManager.AppSettings("SessionTimeoutMilliseconds") & ");", True) 
```

您会注意到我的 web.config 文件中存储了实际的毫秒数，因此我可以根据需要调整超时长度。

使用它，结合 Global.asax 文件中的典型 Session_End 事件，可以非常简洁地处理我的 Web 应用程序中的会话超时。

问候， Nagaraju R || 戴尔佩罗系统 ||

# .net - StdAfx.h 中的“Afx”是怎么回事？

> ID：391791
> 
> 赞同：43
> 
> 时间：2008-12-24T16:46:34.763
> 
> 标签：.net, mfc, fxcop, stdafx.h

我只是好奇 Afx 代表什么。那么 FxCop 中的 Fx 呢？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-24T17:05:40.170

来自[维基百科](http://en.wikipedia.org/wiki/Application_Framework_eXtensions)：

> MFC 的一个有趣的怪癖是使用“Afx”作为许多函数、宏和标准预编译头文件名称“stdafx.h”的前缀。在早期开发过程中，MFC 被称为“应用程序框架扩展”并缩写为“Afx”。Microsoft 基础类 (MFC) 的名称在发布周期中采用得太晚，无法更改这些引用。

[旧的 Stingray MFC 常见问题解答](http://cs.sookmyung.ac.kr/class/00891/C++/mfc-faq/)（不再在他们的网站上找到，链接是旧版本）：

> 一开始，微软创建了一个名为 AFX 组
> （代表 (A) 应用 (F) 框架 (X)）的组。

[...]

> AFX 小组实际上负责两件事：MFC 库和 IDE 对 MFC 的支持（即资源编辑器和向导）。AFX 名称于 1994 年 4 月被取消，该组的成员只是成为 Visual C++ 组内较小团队的一部分。这些较小的团队之一就是今天的 MFC 团队。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-24T16:59:19.030

[http://en.wikipedia.org/wiki/Stdafx.h](http://en.wikipedia.org/wiki/Stdafx.h)

“stdafx.h 中的 AFX 代表 Application Framework eXtensions。AFX 是 Microsoft Foundation Classes (MFC) 的原始缩写。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T16:55:00.783

在 FxCop 中它的框架。

# memory - .txt 文件大小有上限吗？

> ID：391794
> 
> 赞同：23
> 
> 时间：2008-12-24T16:47:26.713
> 
> 标签：memory, text-files, primes, filesize

作为圣诞礼物，我用 Java 编写了一个小程序来计算素数。我的意图是让它通宵达旦，计算下一个素数并将其写入 .txt 文件。早上我会终止程序并将 .txt 文件带给我的朋友过圣诞节。

有什么我应该担心的吗？请记住，这是您正在与之交谈的真正的初学者 Ziggy，而不是一些聪明的错误检查 ASM 家伙。

编辑更具体地说，因为我将在整个晚上计算素数时离开这个程序，我是否有可能遇到某种与内存相关的错误？像，堆压成堆或狗和猫睡在一起？

编辑更具体地说，当文件大小为 4GB 时，我可以输入一行代码来停止打印行吗？只是为了安全？

编辑：成功：整夜离开后，我得到的素数不超过 13 KB，我得到的最高值是 22947217，这就像数万个素数。成功！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-24T16:51:28.937

我建议为您计算的每个素数发送一条短信。你的朋友比一堆纸更想要那个。另外，他可以更频繁地更新。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-24T16:56:40.640

有很多限制，尽管它们都不是 .txt 文件所固有的：

*   Windows 9x 记事本不会打开大于 64KB 的文件。
*   Windows NT/2k/etc 的记事本没有限制，但往往会阻塞和锁定数兆字节的文件。您还需要记住，大多数文本编辑器都是愚蠢的，并试图将整个文件读入 RAM。
*   许多软件被限制为 2GB 或 4GB 文件，具体取决于它们使用有符号整数还是无符号整数——因为有人已经提到 FAT32 有罪。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-24T17:23:42.850

您很可能正在使用缓慢的算法。随着素数变大，您的程序将花费越来越长的时间来计算单个素数。如果你让它在晚上运行，那么早上的文本文件不会很大。如果它超过几兆，我会印象深刻。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-24T16:51:15.533

从技术上讲，除了文件系统对您的限制之外，没有任何限制。然而，记事本对于打开非常大的文件真的很不耐烦。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T16:53:52.223

您可能会考虑跟踪写入每个文件的字节数，并在达到一定字节数后切换到新文件。您还可以为您的文件提供查看器，以便您的朋友可以更轻松地看到他的礼物。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-24T16:53:05.827

如果没有记忆，FAT32 的文件大小限制为 4gig。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-24T16:54:46.637

齐格——

我喜欢这个：“不是一些聪明的错误检查 ASM 家伙。” 你在描述我们所有人！

有足够的磁盘空间并写掉！如前所述，确保用于打开文件的编辑器可以打开非常大的文件。

节日快乐，真正的初学者 Ziggy。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-24T16:49:10.093

仅关于您在磁盘上存储文本文件的位置的大小。

而且，如果你没有马上写，你的内存+虚拟内存。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-24T16:59:49.807

节省一些 CPU 周期并下载预先计算[的素数列表](http://primes.utm.edu/lists/)怎么样？还是更“重要的想法”？:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-24T17:15:28.607

为每个质数创建一个文件，然后使用文件名显示数字怎么样？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-25T21:14:00.417

不知何故，我怀疑当你的程序在一夜之间运行时，文件大小是否会成为问题，因为随着数字变大，找到素数需要更长的时间。只要确保清理干净，否则您可能会耗尽所有 RAM。

回答您的问题：理论上，文件系统会限制文件大小。然而，许多文本编辑器在加载大文件（> 100 MB）时会崩溃（vim 不会），因为它们试图将其放入一个缓冲区中。

总而言之，考虑将文件分成最弱链接（文本编辑器）可以处理的块。

# c# - 在更新面板中找不到内容？

> ID：391796
> 
> 赞同：1
> 
> 时间：2008-12-24T16:48:38.053
> 
> 标签：c#, updatepanel, asp.net-2.0

我有一个联系表格的表格，该表格包含另一个表格，无论是否需要扩展表格，该表格都被隐藏，因为该控件在多个页面上使用。所有这一切都很好，直到我在它周围放置了一个更新面板。我可以在后面的代码中看到控件并且页面构建成功，但是当我运行它时会抛出这个错误：

你调用的对象是空的。

我很确定我以前做过这种事情，但现在似乎不起作用。有没有其他人经历过这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T17:36:58.813

在同事的帮助下，我发现了我的问题。

我在设置属性时引用了控件，显然属性是在所有控件都放在页面上之前设置的，而在没有更新面板的情况下，该设置工作正常。

如果其他人遇到此问题，您只需在页面上设置一个属性，然后在页面加载中根据需要设置控件属性。

# vb.net - 如何将自动完成添加到蒙面文本框？

> ID：391803
> 
> 赞同：1
> 
> 时间：2008-12-24T16:50:29.077
> 
> 标签：vb.net, textbox, autocomplete, maskedtextbox

在 .Net 中，有 MaskedTextBox 和具有自动完成成员的 TextBox。自动完成似乎不适用于 MaskedTextBox。你如何让 MaskedTextBox 使用自动完成功能？

我正在尝试在 Visual Basic 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T16:57:01.187

您唯一的选择是创建一个从 MastedTextBox 或 TextBox 继承的自定义控件并添加缺少的行为。

或者创建一个封装 TextBox 但添加您的功能的控件。

我会使用一个文本框并添加掩码，因为这比添加自动完成更容易。

# asp.net - ASP.net：处理清除页面的最佳方法是什么？

> ID：391821
> 
> 赞同：0
> 
> 时间：2008-12-24T16:55:39.927
> 
> 标签：asp.net

我有一个搜索页面，搜索结果将显示在 gridview 控件中。我有一个名为 Clear 的按钮，用于清除 gridview 中的搜索结果以及用户输入搜索条件的文本框。

起初，我通过刷新页面来进行清除，`print("Response.Redirect(~/blah/search.aspx");`但我不确定这是否是清除页面的最佳方式。将文本框设置为空字符串并将gridview数据源设置为Nothing然后绑定它会更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T17:06:45.287

我更喜欢重定向方法有几个原因：

1.  使用可以回击并取回他们的数据。
2.  更少的代码来维护你何时更改页面的记忆。（如果您添加一个新字段，您还会记得清除它吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T17:01:47.837

我宁愿清除文本框并将gridview绑定到一个空列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T17:37:38.983

做到这一点的最好方法是根本不这样做。

尝试设计搜索框/按钮，以便您可以通过在文本框中键入并单击搜索按钮来启动新搜索。从谷歌那里得到启示。您的大多数用户可能已经熟悉此行为。

如果从头开始而不是细化当前搜索是用户最常见的行为，那么您可以使用一些 javascript 来清除焦点上的搜索框。或者不那么打扰，您可以只选择焦点上的文本以启用类型覆盖样式清除。

```
onFocus="this.select()" 
```

不应该有任何理由浪费您的服务器的 CPU/带宽，或者您的用户的时间只是从空白页面搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T17:13:34.023

我通常只是创建一个链接，上面写着“新搜索”（因为您要重新开始，而不仅仅是清除表单，这就是“清除”对我的含义）指向搜索页面而不是提交按钮以避免一个不必要的回发只是为了重定向。

# apache-flex - 在 Flash Player 10 中切换时堆栈溢出

> ID：391857
> 
> 赞同：1
> 
> 时间：2008-12-24T17:10:45.620
> 
> 标签：apache-flex, flash

有没有人遇到过这个问题？我在从一个 TextInput 组件切换到另一个组件时所做的一切。

我已将我的 TitleWindow（TextInputs 的容器）减少到只有这两个组件，但我仍然收到此错误。我认为它与我的 flashplayer 安装有关，所以我卸载并重新安装，但我仍然得到相同的行为。

任何帮助/建议/最佳猜测都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T04:20:07.307

我正在使用 FlashPlayer 10，只是尝试了以下操作，没有任何错误。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:TitleWindow>
        <mx:TextInput id="textA">

        </mx:TextInput>

        <mx:TextInput id="textB">

        </mx:TextInput>
    </mx:TitleWindow>
</mx:Application> 
```

制表符还有其他事情吗？一些自定义代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T10:16:04.567

Do you have any handlers for, say, focus events or the like on the text fields? As far as Flash is concerned, all that happens when you tab is a change of focus. Stack overflows are usually the result of recursion, so something like that would be my first guess.

Or are you saying that there's nothing in your app except for the components?

# svn - 工作副本根以外的路径上的 SVN Mergeinfo 属性

> ID：391864
> 
> 赞同：46
> 
> 时间：2008-12-24T17:13:31.807
> 
> 标签：svn, tortoisesvn, merge, branch

我有一个 SVN 存储库，其中有主干和一个分支。

我打算定期将主干合并到分支中，但是，当我这样做时，除了实际文件内容更改外，我还看到许多属性状态更改。

在进一步调查中，属性更改是 mergeinfo 属性。我没想到会这样，因为我们*总是*从最高根级别分支和合并。

在合并主干之前，我使用了该`svn propdel`命令并从分支 WC 中删除了所有 mergeinfo 属性（然后恢复了根上的更改），问题就消失了。

所以问题是，我的分支是如何在子目录级别获得所有这些mergeinfo 更改的？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-25T08:00:21.877

Subversion 1.5.x 添加了很多 svn:mergeinfo 属性，甚至在您认为与合并无关的文件/文件夹上。但是 Subversion 仍然使用这些来减少后续合并的合并时间。

如果您不喜欢这些，您可以安全地从所有不属于合并的文件/文件夹中删除那些修改/添加的 svn:mergeinfo 属性（将其保留在工作副本根目录和从合并）。

如果在 1.6 版本中一切都按计划进行，Subversion 1.6 将大大减少这些 svn:mergeinfo 属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-08T09:47:22.440

Subversion 1.5.5 中至少修复了这个错误的一部分。从[1.5.5 更改文件](https://svn.collab.net/repos/svn/tags/1.5.5/CHANGES)：

> 不要为 wc-wc 移动或副本创建合并信息 (r34184, -585)

也就是说，在 1.5 之前的 SVN 中有一个错误，它会创建它不使用并且是多余的 mergeinfo 条目。

# .net - VB.NET 2005 DataGridView 重绘

> ID：391873
> 
> 赞同：1
> 
> 时间：2008-12-24T17:19:18.880
> 
> 标签：.net, vb.net, datagridview

描述 ：

我正在使用一个创建一次的 Global DataGridView，然后我在多个用户控件上共享该网格 ByRef，奇怪的是 -> 第一个控件添加或初始化该网格将绘制它所有其他控件都不会绘制它（当然，我知道为什么它不画）

问题：如何强制全局 datagridview 在我拥有的每个用户控件中重绘..!!？

提到我正在填充`DataGridView`Manully 而不使用 data member / Data source 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T17:26:57.973

好吧，那真的很危险。控件并不意味着由多个表单/控件作为父级。您会更好地共享*数据*（通过可观察的集合，例如`BindableList<T>`，或者`DataView`如果您愿意）。显然，这意味着设置数据成员/数据源，或者自己进行所有更新（对所有网格）。

不过实话说; `DataGridView`（也不是任何其他控件 AFAIK）并不意味着这样使用。

对于信息，*假设*VB's`ByRef`与 C#'s 相当`ref`，那么无论如何你都不需要它......你已经只是传递了引用（按值）。但这并不重要，因为无论哪种方式都行不通。

# sql - Oracle 中的更新

> ID：391874
> 
> 赞同：0
> 
> 时间：2008-12-24T17:20:29.173
> 
> 标签：sql, database, oracle, sql-update

我需要更新表中的评论字段以获取大量 customer_ids。需要更新评论以包括现有评论并附加一些文本和另一个表中的密码。我不太确定该怎么做。

这是一些针对单个客户 ID 执行此操作的代码。对于超过 100 个客户 ID 的列表，我将如何处理？我的第一个想法是创建一个临时表并将所有客户 ID 放在其中，但我仍然不确定之后如何对其进行编码，因为在查询中使用了 customer_id 两次。

```
Update Contract
SET Contract_Comment= Contract_Comment || '; 12/29/2008 Password `' ||
(SELECT Password FROM WLogin WHERE default_customer_id='1234' ) ||'`'|| ' reinstated per Mickey Mouse;'
WHERE Customer_id='1234' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T17:30:28.577

好吧，假设 Contract_comment 有一个 customer_id，或者很容易连接到一个确实有一个的表......

```
update contract c
set contract_comment = contract_comment || '; 12/29/2008 Password ' ||
(select password from WLogin w where w.default_customer_id = c.customer_id) ||''|| ' reinstated per Mickey Mouse;' WHERE Customer_id in (1234, 4567). 
```

或者，用另一个子选择替换最后的列表...

WHERE Customer_id in（从 ... 中选择 customer_id）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T03:29:41.983

我同意托德所说的一切，并希望补充以下内容。

尽管可能并不明显，但他还（可能）更正了您发布的另一个错误，即将 customer_id 字段视为字符串。

通过将 id 放在引号内（至少在您的示例中），您将强制 Oracle 在比较之前将所有行转换为字符串，或者将您提供的 id 转换为整数 - 我必须尝试确定实际将适用的规则。

无论哪种方式，最好与您的数据类型保持一致，而不是将其留给数据库来解决。

您说提供的代码是针对单个客户的。如果您在循环中部署此代码，请确保您使用绑定变量，而不是仅将客户 ID 连接到您正在构建的 SQL 语句中。如果您在 PL/SQL 中执行此操作，那么它会为您完成 - 使用 Java 或其他语言您必须自己执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T18:14:09.517

上面托德的回答可以使用 IN （或 EXISTS 子句，如果您将 ID 存储在临时表中。我只是将其增强如下：

```
UPDATE contract c
   SET contract_comment = nvl2(contract_comment, contract_comment || '; ', '') || '12/29/2008 Password ' ||
                          NVL((SELECT PASSWORD
                                FROM wlogin p
                               WHERE p.default_customer_id = c.customer_id),
                              '<NULL>') || '' || ' reinstated per Mickey Mouse'
 WHERE EXISTS (SELECT 'x' FROM wlogin l WHERE l.default_customer_id = c.customer_id) 
```

这可确保 1) 您正在处理密码是否为空，以及 2) 您只为具有 wlogin 记录的客户进行更新。

随意添加如下内容：

```
AND EXISTS (SELECT 'y' FROM temp_ids_table t WHERE t.customer_id = c.customer_id) 
```

感谢您为这些正确答案提供的任何信用。

*   炖

# iis - IIS 应用程序池 - 停止/启动与回收

> ID：391878
> 
> 赞同：40
> 
> 时间：2008-12-24T17:23:07.920
> 
> 标签：iis, application-pool, worker-process, recycle

我注意到，在我的一个生产 Web 应用程序中，当我手动回收应用程序池时，根据在任务管理器中的观察，回收的工作进程实际上可能需要 60 多秒才能完全销毁。但是，如果我完全停止应用程序池，工作进程几乎会立即消失 - 在 1-2 秒内。

所以，我的问题有两个：

a) 当应用程序池被回收而不是停止时，为什么销毁进程需要这么长时间（更有意义的是释放它使用/锁定的资源）；和

b）假设我已经停止将流量定向到服务器，是否有任何理由不停止/启动而不是回收？

* * *

**编辑：**
为了澄清，在我回收或停止应用程序池之前，我停止将流量发送到有问题的服务器（服务器位于负载平衡集群中，我从负载平衡器中删除了服务器）。因此，理论上，当我对应用程序池执行任何操作时，应该没有请求进入网站。

* * *

**Edit Part Deux：**
在阅读了 Igal 的链接后，对我来说发生了什么似乎很明显。当我回收应用程序池时，新进程启动，但由于根本没有流量，它没有将新进程注册为正在运行，所以它不会关闭旧进程，直到超时（即 90秒）。

有了这些知识，我很清楚“回收”功能专门用于在实时服务器上的中游，并且由于我事先手动排出流量，因此我应该使用停止/启动。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-24T17:54:21.383

a) 由于[重叠回收](http://msdn.microsoft.com/en-us/library/ms525803.aspx)。有一个“旧”进程等待新进程启动的时间段。

b) 没有。据我所知。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-24T17:52:09.017

如果我没记错的话，回收允许所有现有请求完成，然后它将回收应用程序池。停止只是在您停止它的那一刻结束它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-07-28T17:54:46.987

根据[这个链接](http://mvolo.com/starting-stopping-and-recycling-iis-70-web-sites-and-application-pools/)，

> **停止**- 通过停止应用程序池，您指示所有为该应用程序池服务的 IIS 工作进程关闭，并防止任何其他工作进程启动，直到应用程序池再次启动。**这将启动工作进程的正常关闭，每个工作进程都试图耗尽它的所有请求，然后退出。**
> 
> 如果工作进程没有在每个应用程序池定义的 processModel 元素中的 shutdownTimeLimit 配置属性指定的时间内退出（默认值：90 秒），WAS 将强制终止它（如果附加了本机调试器，则不会发生这种情况） .
> 
> 因此，停止应用程序池是一种破坏性操作，会导致卸载 ASP.NET 应用程序域、FastCGI 子进程以及丢失任何进程内应用程序状态。
> 
> **回收**– 回收应用程序池会导致该应用程序池中所有当前正在运行的 IIS 工作进程正常关闭，但与停止池不同的是，可以按需启动新的 IIS 工作进程以处理后续请求。
> 
> 回收应用程序池是重置应用程序状态和由 IIS 工作进程缓存但不会自动刷新的任何配置（主要是全局注册表项）的好方法，而不会中断服务器的操作。在大多数情况下，这使得回收应用程序池成为 IISRESET 的绝佳替代方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-27T20:38:02.507

**停止**

1.  优雅地停止此应用程序池的所有现有工作进程。
2.  *不允许*为此应用程序池启动新的工作进程。

**回收**

1.  优雅地停止此应用程序池的所有现有工作进程。
2.  允许为此应用程序池启动新的工作进程。
3.  重置应用程序状态和缓存

*注意：*两者的第 1 点完全相同。第 3 点不适用于*停止*，因为进程已经消失，因此状态显然消失了。

# python - 组织我的 Python 项目

> ID：391879
> 
> 赞同：46
> 
> 时间：2008-12-24T17:23:14.440
> 
> 标签：python, project-organization

我正在开始一个 Python 项目，并希望其中有 20 个或更多类。作为一种好的做法，我想将它们分别放在一个单独的文件中。但是，项目目录很快就会被文件淹没（或者当我这样做时）。

如果我将要导入的文件放在文件夹中，我将无法再导入它。如何从另一个文件夹中导入文件，并且由于它位于文件夹中，我是否需要以不同的方式引用它包含的类？

提前致谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-24T17:31:40.117

在您的项目文件夹中创建一个`__init__.py`文件，它将被 Python 视为一个模块。

然后可以使用以下语法导入包目录中的类：

```
from package import class
import package.class 
```

在`__init__.py`中，您可以创建一个`__all__`定义`from package import *`行为的数组：

```
# name1 and name2 will be available in calling module's namespace 
# when using "from package import *" syntax
__all__ = ['name1', 'name2'] 
```

这里有[比你想知道的 Python 包更多的信息](http://www.python.org/doc/essays/packages/)

一般来说，学习如何组织大量代码的一个好方法是选择一个流行的 Python 包，看看他们是如何做到的。对于初学者，我会查看[Django](http://www.djangoproject.com/)和[Twisted 。](http://twistedmatrix.com/trac/)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-24T17:42:54.963

“作为一种好的做法，我想将它们分别放在一个单独的文件中。”

这实际上不是一个很好的做法。您应该设计包含密切相关的类的模块。

实际上，没有一个类实际上是完全独立的。通常，类以逻辑相关的集群或组的形式出现。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-24T17:33:00.410

Python 不会强迫您进入 Java 令人讨厌的每个文件一个类的风格。事实上，除非它们很大，否则将每个类放在单独的文件中甚至都不是一种好的风格。（如果它们很大，您可能无论如何都必须进行重构。）相反，您应该将类​​似的类和函数分组到模块中。例如，如果您正在编写 GUI 计算器，您的包布局可能如下所示：

```
/amazingcalc
   /__init__.py # This makes it a Python package and importable.
   /evaluate.py # Contains the code to actually do calculations.
   /main.py # Starts the application
   /ui.py # Contains the code to make a pretty interface 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-24T17:33:09.333

`__init__.py`简单的答案是在您创建的新文件夹中创建一个名为的空文件。然后在您的顶级 .py 文件中包含以下内容：

```
import mynewsubfolder.mynewclass 
```

# .net - 如何获得 Visible 属性的“真实”价值？

> ID：391888
> 
> 赞同：14
> 
> 时间：2008-12-24T17:25:49.787
> 
> 标签：.net, winforms, visible

如果将 Windows 窗体控件的 Visible 属性设置为 true，则如果控件的任何父窗口被隐藏，该属性仍会返回 false。如果父窗口被隐藏，有没有办法获得控件的真实、底层可见性标志？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-24T17:36:09.920

好吧，常规实现*确实会*检查控制堆栈，以确保所有父级都是可见的。我知道的唯一规避方法是用反射作弊，并要求`GetState(2)`，但这很脆弱：

```
 // dodgy; not recommended
    Panel query;
    Form form = new Form
    {
        Controls = {
            new Panel {
                Visible = false,
                Controls = {
                    (query = new Panel {Visible = true})
                }
            }
        }
    };
    form.Show();

    // this is the dodgy bit...
    bool visible = (bool)typeof(Control)
        .GetMethod("GetState", BindingFlags.Instance | BindingFlags.NonPublic)
        .Invoke(query, new object[] { 2 }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-14T11:28:06.633

我所做的是暂时从其父控件中删除按钮以检查其 Visible 值，然后重新添加到父控件。

如果需要，您可以跟踪子索引以将其重新添加到正确的索引中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-22T10:59:02.087

我对从“ToolStripItem”基类派生的类有同样的问题。所以我使用 Available 属性值来检查项目是否会显示。问题解决了。样本：

```
ToolStripItem curItm = menuStrip1.Items[i] as ToolStripItem;
if(curItm is ToolStripItem && curItm.Available) DoAnyThing(); 
```

在此示例中，“curItm”是 ToolStripItem 派生类的一个实例。

.Net 控件中依赖于父容器的 Visible/Enabled 的 Visible/Enabled 属性的这个问题必须由 .Net 团队解决。我在自己的类中创建了一个名为 IsVisible/IsEnabled 的服装属性，该属性返回为 Visible/Enabled 属性分配的值，而不是依赖于父容器的值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-24T17:48:55.153

不依赖于反射的一个选项是通过控件层次结构的父级递归查找 Visible 设置为 false 的父级。

**编辑：**请参阅注释以了解代码的重要性。

 ````
var frm2 = new Form {Text = "Form2"};
var lbl = new Label {Visible = true};
frm2.Controls.Add(lbl);
frm2.Show();

var frm1 = new Form {Text = "Form1"};
var lblVis = new Label { Text = lbl.Visible.ToString(), Left = 10, Top = 10};
lbl.VisibleChanged += (sender, args) => MessageBox.Show("Label Visible changed");
var btnShow = new Button {Text = "Show", Left = 10, Top = lblVis.Bottom + 10};
btnShow.Click += (sender, args) =>
                    {
                        frm2.Visible = true;
                        lblVis.Text = lbl.Visible.ToString();
                        };
var btnHide = new Button {Text = "Hide", Left = 10, Top = btnShow.Bottom + 10};
btnHide.Click += (sender, args) =>
                    {
                        frm2.Visible = false;
                        lblVis.Text = lbl.Visible.ToString();
                    };

frm1.Controls.AddRange(new Control[] {lblVis, btnShow, btnHide});

Application.Run(frm1); 
```

# itunes - 访问 iTunes 评分数据

> ID：391896
> 
> 赞同：3
> 
> 时间：2008-12-24T17:31:16.390
> 
> 标签：itunes

我们想编写一个 Windows/OS X 应用程序，将 iPod 和 iTunes 中的播客收视率信息发送回服务器。两个问题：

1.  是否有关于如何将评级数据存储在 iTunes 中的文档，
2.  如果用户将 iTunes 设置为自动删除他听过的节目，有没有办法在收视率数据消失之前捕获它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T17:49:47.930

我怀疑数据文件格式是否有官方规范，但您可以在 iTunes 目录的“iTunes Music Library.xml”文件中找到评级信息。查找一个名为“Rating”的键，其值为从 0 到 100 的整数值。如果用户没有对该项目进行评分，它将不存在。例如，4 星评级的值为 80。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T17:47:17.450

iTunes 将其音乐库数据和评分存储在用户机器上的 XML 文件中。在 Windows 中，它位于“音乐”或“我的音乐”文件夹中。

您可以打开“iTunes Music Library.xml”文件并查找 Rating 元素以查看用户对每首歌曲的评分。由于它的 XML，它是不言自明的。这应该很容易从您正在编写的程序中打开和解析。

我认为 iTunes 在程序关闭之前不会从其 xml 文件中删除播客。只要 iTunes 仍处于打开状态，您就应该能够获取该评分数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-27T02:37:39.250

除了 xml 文件之外，还有一个 COM 接口可以让您访问所有库信息，包括每首歌曲的评分。SDK 已记录在案。

我不知道你想用什么语言，但我用 C# 与 iTunes 交互，非常流畅。

[您可以在http://developer.apple.com/sdk/](http://developer.apple.com/sdk/)下载 SDK

# fortran - 如何识别 fortran 标准 - '77、'90 或 '95？

> ID：391897
> 
> 赞同：15
> 
> 时间：2008-12-24T17:31:33.113
> 
> 标签：fortran

我有一段 fortran 代码，但我不确定它是哪个标准 - '77、'90 或 '95。是否有一个标准工具来识别它所遵循的标准？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-24T18:07:40.980

可能有自动化工具，但我的方法主要是启发式的：

*   注释`!`是在行中的任意位置（F90+）还是`C`在第一列（F77）中使用a？
*   循环使用`do`.. `end do`(F90+) 还是`do`.. `continue`(F77)？
*   `&`行是在行尾 (F90+) 还是在第 6 列 (f77)继续使用？
*   代码是否使用`module`或`type`结构（F90）？
*   如果代码使用数组，它是作为单个结构（F90）还是始终使用循环（F77）对它们进行操作？
*   是否使用了动态内存（使用`allocatable`或`pointer`方法）（F90）？

通常这些足以区分 F90 和 F77。Fortran 90 和 FORTRAN 77 之间的差异比 Fortran 90 和 Fortran 95 之间的差异要大得多，所以我通常停在那里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T17:52:00.873

如果您可以访问[GNU Fortran](http://gcc.gnu.org/wiki/GFortran) (gfortran)，您可以尝试使用不同的选项对其进行编译，`--std`然后查看哪个有效。[您可以在此处](http://gcc.gnu.org/onlinedocs/gcc-4.3.0/gfortran/Fortran-Dialect-Options.html#Fortran-Dialect-Options)找到有关方言选项的详细信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-04T00:57:24.460

我正在 fortran 2003 和 2008 中添加功能（这只是我的想法）

如果程序具有参数化派生数据类型（fortran 2003。）如果数组构造函数使用方括号 [] 而不是 (/ /) (fortran 2003.) 如果您看到，则提供使用 coarrays (fortran 2008)

尽管许多编译器具有特殊功能（如 Bessel 函数）作为扩展的一部分，但它是 fortran 2008 的真正功能。

（如果有任何差异让我知道我会编辑）

# asp.net - 跨多个站点同步 ASP.NET 会话

> ID：391912
> 
> 赞同：0
> 
> 时间：2008-12-24T17:41:29.193
> 
> 标签：asp.net, session-state

是否有一个优雅的解决方案可以跨多个 ASP.NET 应用程序同步会话？我敢肯定这很容易被认为是一个安全漏洞，但是涉及到一个第 3 方 ASP.NET 应用程序，无法对其进行扩展。出于这个原因，正在开发第二个 [相关] 站点，但需要直接访问在第 3 方应用程序上创建的会话。

例如，当用户登录/退出一个站点时，应该在另一个站点上发生相同的操作。但是，重要的是要注意这超出了典型的 SSO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T19:20:31.753

试试 memcached 会话状态提供程序：http: [//www.codeplex.com/memcachedproviders](http://www.codeplex.com/memcachedproviders) 由于缓存在单独的服务中运行，我很确定您可以从不同的应用程序访问同一个存储池。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T19:38:49.627

使用 SQL Server 存储是您最简单的解决方案之一。请确保您对 SQL 对象设置了适当的权限。我不熟悉 Manu 的建议。实际上还有另一种方法，它有点困难。它是通过对类似纪念品的模式进行修改来完成的。App1 将会话信息存储在数据库中，但其他应用程序 App2 访问数据库，会话信息通过 App2 可以引用的服务公开。一旦用户移至 app2 并通过身份验证，其会话将使用该服务恢复。

希望有帮助。它在我的一个项目中对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T17:53:22.290

假设应用程序在其 cookie 中存储一些关键数据，则 cookie 是一个选项。如果另一个站点在同一个域中，它可以读取它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T19:57:22.883

使用 NCache - [http://www.alachisoft.com/ncache/](http://www.alachisoft.com/ncache/)

它会帮助你实现你正在寻找的东西。

它还内置了分布式 ASP.NET 会话状态缓存，并将帮助您在多个站点之间共享会话。[详情在这里](http://www.alachisoft.com/ncache/session_index.html)

# c# - C#中的重入锁

> ID：391913
> 
> 赞同：124
> 
> 时间：2008-12-24T17:41:52.297
> 
> 标签：c#, .net, multithreading, locking, deadlock

以下代码会导致在 .NET 上使用 C# 导致死锁吗？

```
 class MyClass
 {
    private object lockObj = new object();

    public void Foo()
    {
        lock(lockObj)
        { 
             Bar();
        }
    }

    public void Bar()
    {
        lock(lockObj)
        { 
          // Do something 
        }
    }       
 } 
```

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-12-24T17:44:09.733

不，只要您锁定同一个对象即可。递归代码实际上**已经拥有锁**，因此可以不受阻碍地继续执行。

`lock(object) {...}`是使用[Monitor](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)类的简写。正如[Marc 指出的那样](https://stackoverflow.com/questions/391913/re-entrant-locks-in-c/391921#391921)，`Monitor`允许*[重新进入](http://en.wikipedia.org/wiki/Reentrant_(subroutine))*，因此重复尝试锁定**当前线程已经拥有锁定**的对象将正常工作。

如果您开始锁定*不同*的对象，那就是您必须小心的时候。特别注意：

*   总是以相同的顺序在给定数量的对象上获取锁。
*   **始终以与获取锁相反**的顺序释放锁。

如果你打破了这些规则中的任何一个，你几乎肯定会*在某些时候*遇到死锁问题。

这是一个描述 .NET 中线程同步的好网页：[http ://dotnetdebug.ne​​t/2005/07/20/monitor-class-avoiding-deadlocks/](http://dotnetdebug.net/2005/07/20/monitor-class-avoiding-deadlocks/)

此外，一次锁定尽可能少的对象。尽可能考虑使用[粗粒度锁](http://martinfowler.com/eaaCatalog/coarseGrainedLock.html)。这个想法是，如果您可以编写代码以便有一个对象图并且您可以在该对象图的根上获取锁，那么就这样做。这意味着您在该根对象上拥有一个锁，因此不必担心获取/释放锁的顺序。

*（进一步说明，您的示例在技术上不是递归的。要使其递归，`Bar()`必须调用自身，通常作为迭代的一部分。）*

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-24T17:44:42.977

好吧，`Monitor`允许重新进入，所以你不能让自己陷入僵局......所以不：它不应该这样做

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-24T18:01:01.213

如果一个线程已经持有一个锁，那么它不会阻塞自己。.Net 框架确保了这一点。您只需确保两个线程不会尝试通过任何代码路径不按顺序获取相同的两个锁。

同一个线程可以多次获取同一个锁，但您必须确保释放锁的次数与获取锁的次数相同。当然，只要您使用“lock”关键字来完成此操作，它就会自动发生。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-01-14T18:36:12.160

不，这段代码不会有死锁。如果您真的想创建死锁，最简单的一个需要至少 2 个资源。考虑狗和骨头的场景。1\. 一只狗可以完全控制一根骨头，因此任何其他狗都必须等待。2\. 最少需要2只2块骨头的狗，分别锁定自己的骨头并寻找其他骨头时造成僵局。

.. 等等 n 狗和 m 骨头，并导致更复杂的死锁。

# wpf - 如何让这个 ComboBox 托管在 ListView 中以更新我的收藏？

> ID：391915
> 
> 赞同：0
> 
> 时间：2008-12-24T17:42:54.917
> 
> 标签：wpf, data-binding, binding

我在 ListView 中托管了一个 ComboBox，我需要在 CombBox 中进行更改以更新 ListView 绑定到的支持类。

这是我的数据模板

```
<DataTemplate x:Key="Category">
    <ComboBox IsSynchronizedWithCurrentItem="False" 
              Style="{StaticResource DropDown}" 
              ItemsSource="{Binding Source={StaticResource Categories}}"
              SelectedValuePath="Airport"
              SelectedValue="{Binding Path=Category}"
              />
    </DataTemplate> 
```

这是列表视图。ListView 的 ItemSource 是 Airports 的集合，并在后面的代码中设置，并且有一个名为 Category 的属性，我需要组合框来更新它。

```
<ListView.View>
            <GridView>
                <GridViewColumn DisplayMemberBinding="{Binding Path=Name}" Header="Airport" Width="100" />
                <GridViewColumn Header="Category" Width="100"  CellTemplate="{StaticResource Category}" />
            </GridView>
        </ListView.View> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T18:23:20.123

你为什么设置`SelectedValuePath`在你的`ComboBox`? 没有看到你的数据结构很难说，但这对我来说看起来不对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T18:58:36.370

这是支持 ComboBox 和 ListView 的数据。

```
Imports System.Collections.ObjectModel 
```

班级窗口1

```
Public Airports As New ObservableCollection(Of Airport)
Public Sub New()
    ' This call is required by the Windows Form Designer.
    InitializeComponent()

    '*************************
    'Dummy data for testing

    Dim anAirports As New Airport
    anAirports.Name = "ABC"
    anAirports.Category = "AA"

    Airports.Add(anAirports)

    anAirports = New Airport
    anAirports.Name = "DEF"
    anAirports.Category = "BB"

    Airports.Add(anAirports)
    '*************************
    'Bind the airports to the list for display
    lstCategories.ItemsSource = Airports

End Sub 
```

结束类

公共类机场

```
''' <summary>
''' Name of the Airport
''' </summary>
''' <remarks></remarks>
Private mName As String
Public Property Name() As String
    Get
        Return mName
    End Get
    Set(ByVal value As String)
        mName = value
    End Set
End Property

''' <summary>
''' Describes the type airport and is selected from a combobox
''' </summary>
''' <remarks></remarks>
Private mCategory As String
Public Property Category() As String
    Get
        Return mCategory
    End Get
    Set(ByVal value As String)
        mCategory = value
    End Set
End Property 
```

结束类

''' ''' 要在 ComboBox 中显示的项目 ''' ''' 公共类类别

```
Inherits ObservableCollection(Of String)

Public Sub New()
    Me.Add("AA")
    Me.Add("BB")

End Sub 
```

结束类

# c++ - 带 ijg 的 JPEG 支持 - 获取访问冲突

> ID：391917
> 
> 赞同：3
> 
> 时间：2008-12-24T17:42:57.757
> 
> 标签：c++, c, jpeg, ijg

我最近尝试更新[我的游戏](http://kentb.blogspot.com/2008/12/kentis.html)以存储压缩格式（JPEG 和 PNG）的图形。

虽然我最终选择了一个不同的库，但我最初的尝试是合并[ijg](http://www.ijg.org/)来进行 JPEG 解压缩。然而，我什至无法让最简单的控制台应用程序工作，我想知道是否有人能够解释原因。

这是我的代码，它链接到*jpeg.lib*，它是 ijg 包的一部分：

```
#include "stdafx.h"
#include <stdio.h>
#include <assert.h>
#include <jpeglib.h>

int _tmain(int argc, _TCHAR* argv[])
{
    struct jpeg_decompress_struct cinfo;
    struct jpeg_error_mgr jerr;
    JSAMPARRAY buffer;
    int row_stride;

    //initialize error handling
    cinfo.err = jpeg_std_error(&jerr);

    //initialize the decompression
    jpeg_create_decompress(&cinfo);

    FILE* infile;
    errno_t err = fopen_s(&infile, "..\\Sample.jpg", "rb");
    assert(err == 0);

    //specify the input
    jpeg_stdio_src(&cinfo, infile);

    //read headers
    (void) jpeg_read_header(&cinfo, TRUE);

    return 0;
} 
```

问题是调用`jpeg_read_header()`失败并出现访问冲突：

> JPEGTest.exe 中 0x7c91b1fa (ntdll.dll) 的未处理异常：0xC0000005：访问冲突写入位置 0x00000010。

有谁知道我可能做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T03:28:57.527

我刚刚遇到了同样的问题（尽管我试图对图像进行编码）。显然， FILE* 在 DLL 之间不可移植，因此您不能使用任何将 FILE* 作为参数的 libjpeg API。

有几种解决方案，但它们都归结为必须重建库：

*   将该库构建为静态库，并将其链接到您的应用程序。这就是我所做的，它解决了我的问题。
*   将源/目标处理程序移出 libjpeg 并进入您的应用程序。然后，您可以将 libjpeg 构建为静态库或 DLL，以适合您的方式。我不确定这是否可行，但它是随源代码分发的“install.doc”文件中建议的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-25T10:33:10.150

我同意埃尔南的观点。这不是一个好的接口（我认为内部代码本身可能很好），除非你真的需要在底层工作（甚至可能不需要）。我认为 ImageMagick 可能更好。他们有一个更高级的“MagickWand”C 接口，更不用说它支持更多的格式。

但是，我对 libjpeg 的界面很好奇，所以我得到了一个令我满意的测试程序，它基于您的示例程序以及[libjpeg.doc](http://download.blender.org/source/chest/blender_2.03_tree/jpeg/libjpeg.doc)、[IJG 示例](http://dev.w3.org/cvsweb/Amaya/libjpeg/Attic/example.c?rev=1.4)和 [USING THE IJG JPEG LIBRARY](http://www.jpegcameras.com/libjpeg/libjpeg.html#toc2)。无论如何，这是代码。它只是打印出尺寸，以及每行第一个像素的 RGB。

我很惊讶您的代码出现错误。它对我来说很好，并且编译时没有任何警告。其他人可以测试吗？

```
#include <stdio.h>
#include <assert.h>
#include <jpeglib.h>

int main(int argc, char* argv[])
{
    struct jpeg_decompress_struct cinfo;
    struct jpeg_error_mgr jerr;
    JSAMPARRAY buffer;
    int row_stride;

    //initialize error handling
    cinfo.err = jpeg_std_error(&jerr);

    FILE* infile;
    infile = fopen("Sample.jpg", "rb");
    assert(infile != NULL);

    //initialize the decompression
    jpeg_create_decompress(&cinfo);

    //specify the input
    jpeg_stdio_src(&cinfo, infile);

    //read headers
    (void) jpeg_read_header(&cinfo, TRUE);

    jpeg_start_decompress(&cinfo);

    printf("width: %d, height: %d\n", cinfo.output_width, cinfo.output_height);

    row_stride = cinfo.output_width * cinfo.output_components;

    buffer = (*cinfo.mem->alloc_sarray)
        ((j_common_ptr) &cinfo, JPOOL_IMAGE, row_stride, 1);

    JSAMPLE firstRed, firstGreen, firstBlue; // first pixel of each row, recycled
    while (cinfo.output_scanline < cinfo.output_height)
    {
    (void)jpeg_read_scanlines(&cinfo, buffer, 1);
    firstRed = buffer[0][0];
    firstBlue = buffer[0][1];
    firstGreen = buffer[0][2];
    printf("R: %d, G: %d, B: %d\n", firstRed, firstBlue, firstGreen);
    }

    jpeg_finish_decompress(&cinfo);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T13:59:52.743

这是一个无需重建库的解决方法：制作替换 I/O 函数，正如 André Caron 所说，但除了标准的 stdio 函数之外什么都没有。

我过去制作的下面的代码可能会有所帮助。它是为 libpng 编写的，但我相信在 libjpeg 中也很容易做到这一点。

我将此添加到代码中：

```
 png_set_write_fn (png_ptr,file,replwrite,replflush); 
```

然后创建了替换函数：

```
void replwrite (png_structp png_ptr, png_bytep data, png_size_t length)
{
    fwrite (data,1,length,(FILE*) png_get_io_ptr(png_ptr));
}

void replflush (png_structp png_ptr)
{
    fflush ((FILE*) png_get_io_ptr(png_ptr));
} 
```

它总是对我有用。我实际上在做的是告诉 libpng，“嘿，不要使用 .dll 指向的 MSVCR 中的写入函数，使用这些来自我在程序中使用的 MSVCR 的写入函数，fwrite 和 fflush”。你看这基本上是一个兼容性问题。

我希望这个或类似的东西能解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T05:12:06.600

从给出的代码示例中很难看出访问冲突的原因。如果您可以包含有助于识别问题的堆栈跟踪（带有符号）。要验证的一件事是 .LIB 和 .EXE 项目的对齐设置是一致的，这通常会导致令人讨厌的问题，因为结构/类成员不在编译器期望的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-25T06:48:53.223

要使用多种格式的图像，我建议您将 DevIL 作为库[http://openil.sourceforge.net/](http://openil.sourceforge.net/)。这是一个很好的选择，因为我已经多次使用它并取得了很好的效果。请注意，它的语法类似于 OpenGL。

功能列表：

支持加载：

*   .bmp
*   。切
*   .dcx
*   .dds
*   .exr
*   .ico
*   .icns
*   .gif
*   .jpg
*   .jp2
*   .磅
*   .lif
*   .mdl
*   .pcd
*   .pcx
*   .pic
*   .png
*   .pnm
*   .psd
*   .psp
*   。生的
*   .sgi
*   .tga
*   .tif
*   .wal
*   。行为
*   。朋友
*   .hdr
*   厄运图形

支持保存：

*   .bmp
*   .dds
*   .jpg
*   .pcx
*   .png
*   .pnm
*   。生的
*   .sgi
*   .tga
*   .tif
*   。朋友

库功能

*   便携，支持 Windows、Mac OS X 和 *nix。
*   OpenGL 风格的语法。
*   使用图像名称而不是丑陋的指针。
*   从文件、文件流或内存“块”加载。
*   通过 ilGetData() 和 ilSetData() 直接访问数据。
*   支持亮度、rgb(a)、bgr(a) 和颜色索引图像。
*   每个通道支持 3 种不同的位数。
*   所有格式和数据类型（包括调色板）之间的转换。
*   加载图像时，如果需要，用户定义的自动转换。
*   如果需要，在保存图像时自动转换。
*   如果需要，自动将彩色索引图像转换为真彩色图像。
*   保存时可控压缩。
*   维护一个可以推送和弹出的状态堆栈。
*   完全支持 3d 纹理体积（3d 图像）。
*   图像验证。
*   支持图层。
*   支持 mipmap。
*   支持动画。
*   用户指定的透明颜色。
*   如果加载失败，可以加载默认图像。
*   用户指定的提示。
*   使用关键颜色。
*   支持将图像叠加在另一个图像之上。
*   允许用户指定自己的加载和保存回调，甚至覆盖默认回调。
*   支持用户指定的读写功能。
*   德尔福支持。
*   Visual Basic 支持。
*   Linux 支持。
*   可以选择哪些功能将用于创建更小的 dll。
*   选择是使用英特尔 Jpeg 库还是 libjpeg。
*   应用于图像的一系列效果和过滤器，例如浮雕和边缘检测。
*   图像可以调整大小，甚至可以放在更大的背景上（放大的画布）。
*   OpenGL、Allegro、Windows GDI 和 DirectX API 支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-19T16:45:06.997

这是一个经过测试的功能

```
void test(char FileName[])
{
    unsigned long x, y;
    struct jpeg_decompress_struct info; //for our jpeg info
    struct jpeg_error_mgr err;           //the error handler
    JSAMPARRAY buffer;
    FILE* infile;
    //initialize error handling
    info.err = jpeg_std_error(& err);     

    infile = fopen(FileName, "rb");  //open the file

    //if the jpeg file doesn't load
    if(!infile) {
    fprintf(stderr, "Error reading JPEG file %s!", FileName);
        // printf("Error reading JPEG file %s!", FileName);
        //return 0;
    }

    //initialize the decompression
    jpeg_create_decompress(&info);

    //specify the input
    jpeg_stdio_src(&info, infile);    

    //read headers
    jpeg_read_header(&info, TRUE);   // read jpeg file header

    jpeg_start_decompress(&info);    // decompress the file

    //set width and height
    x = info.output_width;
    y = info.output_height;

    printf("x value is %ul", x);
    printf("x value is %ul", y);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-15T12:04:24.463

这个问题到现在已经快 10 年了，但与作者今天发布的内容完全相同（我使用的是 Visual Studio 2013）。

最初我尝试使用 GnuWin32 中的 libjpeg 库：http://gnuwin32.sourceforge.net/packages/jpeg.htm[并且](http://gnuwin32.sourceforge.net/packages/jpeg.htm)遇到了同样的错误。然后注意到这是 libJpeg 的**“6b 版”**，现在已经很老了（2005 年）对我有用的是通过 nuget pacakge 管理器安装 libJpeg：

> 安装包 libjpeg -版本 9.2.0.1

# delphi - 更新项目的控件显示样式不一致的表单设计器

> ID：391920
> 
> 赞同：1
> 
> 时间：2008-12-24T17:44:26.753
> 
> 标签：delphi, controls, properties, delphi-2009, themes

我有一个在 Turbo Delphi 中开始的项目，我最近将其更新到 D2009，并且我注意到表单设计器中的一些怪癖。所有旧表单都应用了 Win98 样式。例如，按钮是灰色的，带有锋利的方形边缘。但是我在升级后创建的任何新表单都以 WinXP 样式显示其控件。如果我从旧表单复制控件并将其粘贴到新表单，则样式会更改。在运行时，所有窗体的所有控件都以 XP 样式显示。

知道是什么导致我的旧表格以旧样式显示吗？我查看了属性列表，但没有任何东西跳出来。但显然有一些东西，它是持久的，因为保存和重新加载不会改变它。有谁知道这个属性在哪里以及如何修复它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T18:50:54.263

您应该启用运行时主题。

你检查过了吗？

```
Project | Options | Application | [  ]  Enable Run Time Themes 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T19:09:50.247

查看旧形式和新形式的uses子句，可能会有不同的地方。我知道在delphi 7中你必须添加xpman（或类似的东西）才能获得windows皮肤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T19:25:06.410

你检查过dfm文件吗？有时有些东西没有在属性列表中显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-25T23:59:52.783

也许您的 dfm 中有一个杂散的 Ctl3D (sp?) 设置？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-16T08:38:12.700

使用D2007，

我的运行时包有同样的问题。他们可以使用 D5 或 D7 创建。

要解决此问题：只需将“XP Theme ManiFest”添加到您的罪魁祸首包“res”文件中。

D2007 清单示例：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <assemblyIdentity
    type="win32"
    name="CodeGear RAD Studio"
    version="11.0.2902.10471" 
    processorArchitecture="*"/>
  <dependency>
    <dependentAssembly>
      <assemblyIdentity
        type="win32"
        name="Microsoft.Windows.Common-Controls"
        version="6.0.0.0"
        publicKeyToken="6595b64144ccf1df"
        language="*"
        processorArchitecture="*"/>
    </dependentAssembly>
  </dependency>
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
      <requestedPrivileges>
        <requestedExecutionLevel
          level="asInvoker"
          uiAccess="false"/>
        </requestedPrivileges>
    </security>
  </trustInfo>
</assembly> 
```

# database-design - 大数据/报告项目的方法

> ID：391924
> 
> 赞同：0
> 
> 时间：2008-12-24T17:45:45.957
> 
> 标签：database-design, projects-and-solutions

以下是什么好方法：

每周，大约 250,000 条表示事务的记录将被附加到 SQL 2005 数据库中的一个大表中。需要扩充此数据并将其附加到另一个表。（例如，基于事务上的客户端 ID，将根据某些业务规则计算各种数据；数据取决于客户端 ID 和事务 ID。）将此表视为分析引擎的预处理输入。然后，该输入数据将通过分析引擎（供应商解决方案），该引擎将生成第三个数据库表。然后，该表将需要进一步处理（例如，通过客户 ID 和一些内部分析进行聚合）以附加到包含我们团队可用于生成报告的形式的结果的表中。将来，相同的数据很可能会提供给其他应用程序，

我们的技能基础是 C、C++、C#、.NET，并且熟悉 ADO.NET 和 LINQ。如果这对于这样的项目还不够，请告诉我。虽然我们现在没有新人才的预算，但我们可能会努力提高我们的内部技能基础或从另一个团队借用以满足项目要求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T17:54:23.770

根据您的描述，这听起来应该完全由数据库驱动，例如使用 T-SQL 和 SSIS。加载到表和前后处理（聚合、后续加载等）是 SSIS 大放异彩的地方。如果我错过了意图，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T18:12:46.680

这些天我正在阅读有关维度建模、星型模式和数据仓库的信息，所以请原谅我在学习了锤子之后看到了钉子。我会问你手头是否有一个好的数据建模师。我真的很喜欢 Ralph Kimball 关于维度建模的想法。我敢打赌，供应商报告解决方案会直接插入。在我看来，事务模式和报告模式之间的任务差异需要不同的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T18:08:49.497

这听起来像 ETL 项目。您想使用 SQL Server 集成服务。它是 SQL 2000 中 DTS 的替代品。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-28T15:56:54.627

1.  数据库操作是 S... L... O... W...

2.  您将内容放入数据库中进行查询。

因此，您的中间结果不适合用于数据库存储。

“代表交易的250,000条记录...。需要扩充此数据...根据交易上的客户ID，将根据某些业务规则计算各种数据；数据取决于客户ID和交易ID。”

前几个操作不会导致您要查询的数据。您只是将它暂存在数据库中。那是（1）慢，（2）不是很有帮助。只需将其保留在文件中即可完成所有这些扩充处理。

将文件放在可以备份的目录中，就像备份数据库一样简单，你会没事的。

由于您的设计看起来相当固定，这就是您所能做的。但是，如果您的数据库设计是灵活的，请查看 Kimball 的数据仓库工具包，您会发现当您有依赖于客户 ID 的字段时，这实际上意味着您有一个客户维度。

定义一个客户表。在事实和维度之间使用简单的连接来定位客户数据。

这种维度查找技术适用于所有这些“数据增强”操作。因此，在您的“数据增强”中几乎不需要进行实际处理。

大多数情况下，您会弄清楚如何将传入交易的密钥与您定义的维度进行匹配。有时尺寸值发生了变化；有时您需要添加新的维度值。因此，您的“增强”转而检查维度，并将一些键附加到每个传入记录。然后将具有适当度量和外键的事实表加载到维度。

# gwt - 将 JPA 与我的 GWT 应用程序一起使用的最简单方法

> ID：391929
> 
> 赞同：1
> 
> 时间：2008-12-24T17:48:55.527
> 
> 标签：gwt, jpa, rpc

我想创建一个使用 RPC 的简单 Google Web Toolkit 应用程序。对于持久性，我想使用 Java Persistence API 之类的东西。

这是否意味着我必须使用像 Glassfish 这样的应用服务器？还是我可以坚持使用简单的 Web 容器？

就具体库而言，我应该如何进行？顶联？休眠？...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-24T18:01:07.547

我相信 GWT RPC 的东西是作为简单的 servlet 实现的。假设您完全可以在像 Tomcat 这样的 Web 容器中使用 JPA，并且不需要完整的 J2EE 应用服务器。

为此，您需要进行一些手动设置，以简化对 PersistenceContext 的访问。Hibernate 建议使用 ThreadLocal，我的博客上有一个条目，详细说明了我是如何为 Tomcat 执行[此操作的](http://www.naildrivin5.com/daveblog5000/?p=39)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T22:55:10.840

我个人会推荐 Glassfish，因为它比 Tomcat 更稳定、更好地实现并且通常质量更高。我不想引发一场激烈的战争（说将 J2EE 放入 Tomcat 就像给猪涂口红一样），但我会告诉你我们如何部署所有应用程序：

我们使用 Glassfish 作为 Web 容器，使用 TopLink 作为持久性提供程序，通常连接到 MySQL 5 数据库。我们一直使用 JPA POJO，从 EJB 层到 Web 层，以及 GWT 层，通过 RPC。我们还将 Stripes 和 JSP 用于所有不需要 AJAX 功能的表示逻辑。这种方法我们从来没有遇到过任何问题，到目前为止，我们已经用这种方法完成了至少 10 个大型项目。这是迄今为止我们所拥有的最好的架构，并且我们拥有很多（tomcat、jboss、hibernate、struts、spring 等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T13:39:22.053

您可以使用任何您喜欢的容器，我的意思是 servlet 和 jpa 容器。

关键是GWT不支持jpa，所以你必须使用DTO设计parten。这将使一切井井有条，并且您不会遇到延迟加载的问题。

# asp.net - 远程提交注册表

> ID：391935
> 
> 赞同：2
> 
> 时间：2008-12-24T17:52:32.557
> 
> 标签：asp.net, webforms, viewstate

我的一个客户需要他们当前的网站连接到场外的在线租赁模块。

该模块需要通过在我们的网站上发布用户名和密码哈希或注册信息来访问。

当我将视图状态从源手动复制到他们在我们系统上填写的表单中时，它会起作用，但当我从 WebClient 请求中提取它时不起作用。

当我使用 WebClient 拉回视图状态时，出于某种原因，视图状态永远不会改变。

但是，在 IE 中每次访问时，视图状态都会发生变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T18:03:52.673

你为什么要处理视图状态？您可以使用 WebRequest 进行身份验证，从 WebResponse 获取身份验证 cookie 并将此 cookie 用于每个下一个请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T02:03:26.027

我们能够强制他们提交并创建一个供我们使用的 Web 服务和一个使用哈希值将用户登录到他们系统的网页。

# c# - 什么是用于 c# 和 .net 的好的商业 tar 流库？

> ID：391936
> 
> 赞同：1
> 
> 时间：2008-12-24T17:52:40.373
> 
> 标签：c#, stream, tar

我们目前正在使用 SharpZipLib，但由于它使用 GPL，我们需要将其替换为商业库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T18:06:32.060

你看过[DotNetZip](http://www.codeplex.com/DotNetZip)吗？

它不在 GPL 下，而是在 Microsoft 公共许可证 (Ms-PL) 下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T19:05:40.397

请参阅我在主帖上对#ziplib 的评论……但如果您真的需要商业产品（非开源），[IP*Works！Zip .NET](http://www.nsoftware.com/ipworks/zip/technologies.aspx?sku=izn8-a)可能符合要求。根据[这个](http://www.nsoftware.com/products/component/tar.aspx)，它确实有 TAR 支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T02:55:48.150

仅供参考。可以选择使用 BSD 许可库进行 tar 读/写。Gzip 压缩和解压缩可以使用来自 microsoft .NET 2.0 的内置 GZipStream

[http://code.google.com/p/tar-cs/](http://code.google.com/p/tar-cs/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-13T21:03:45.300

如果你想要一个 tar 库，有一个单模块实现

[http://cheeso.members.winisp.net/srcview.aspx?dir=Tar&file=Tar.cs](http://cheeso.members.winisp.net/srcview.aspx?dir=Tar&file=Tar.cs)

# configuration-management - 在哪里可以找到配置管理计划的好示例或模板？

> ID：391946
> 
> 赞同：0
> 
> 时间：2008-12-24T17:56:54.077
> 
> 标签：configuration-management, rup, cmp

文档不是开发人员最喜欢的领域，但如果您想在组织中拥有标准，则需要完成的重要领域。我们正在尝试制定一个新的配置管理计划来设置变更控制、备份策略和其他有趣的事情，比如从开发、登台到生产的过程。

我想听听你对好的例子的看法，或者可能是 CMP 过程的一个好的开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-11-17T06:26:23.323

如果您想要软件配置管理工厂中的一些项目列表，此链接提供了一个示例：[http ://www.scmwise.com/software-configuration-management-plan.html](http://www.scmwise.com/software-configuration-management-plan.html)

但是，请注意，SCM 计划的内容在很大程度上取决于贵公司的标准和软件开发本身的过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-03T14:33:53.610

我通常会参考[cmcrossroads.com](http://www.cmcrossroads.com)获取此类信息。该网站组织得不好，但有很多信息。另一个非常有用的资源是[nasa.gov](http://nasa.gov)（我知道）。

我建议您查看以下链接，而不是我列出 CM 计划的索引：http: [//www.nasa.gov/centers/ivv/pdf/170879main_T2401.pdf](http://www.nasa.gov/centers/ivv/pdf/170879main_T2401.pdf)

设置 CM 流程的一些快速指南：

1.  你绝对需要管理层/公司的支持。没有他们的推动，没有人会坚持这个过程。
2.  SCM 就像警察/邮政服务。在出现问题之前，没有人会记住它们。在您的情况下，如果没有人谈论（抱怨）您实施的 SCM 流程，这是一个好兆头。
3.  开源 SCM 系统与其他类型不相上下。根据您项目的强度，您可能需要执行多个 POC 来确定哪个系统适合您的需求。

这是一个广泛的话题；如果您遇到困难，我会推荐 Alexis Leon 的[书。](http://tinyurl.com/2rkk33)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T05:38:25.753

与软件开发相关的所有类型的文档都可以作为 Rational Unified Process [RUP] 的一部分获得。您可以在以下位置找到这些：

*   [配置管理计划](http://sce.uhcl.edu/helm/rationalunifiedprocess/process/artifact/ar_cmpln.htm)
*   [RUP 模板](http://www.ts.mah.se/RUP/RationalUnifiedProcess/)
*   [RUP 模板](http://espec.ppgia.pucpr.br/doc/programming/rup/index.htm)

# asp.net - 实现实时 UI 更新（如 SO 的“新答案”通知程序）的最佳方式？

> ID：391948
> 
> 赞同：4
> 
> 时间：2008-12-24T17:59:41.060
> 
> 标签：asp.net, ajax, user-interface

在 Web 应用程序中提供实时 UI 更新的建议模式是什么？例如，在回答关于 SO 的问题时，另一个用户提交答案并出现提示。另外，如果您站点中的每个页面都提供此功能，您如何避免过多的 AJAX 调用使服务器过载？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-24T18:09:22.727

只需运行一个计时器并通过`XmlHttpRequest`. 这不像您需要*即时*更新；AFAIK，所以每隔 30 秒轮询一次，但这对我来说太慢了，所以我安装了一个 Greasemonkey 脚本每 15 秒检查一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T18:04:28.523

我认为为此使用彗星将是一种方法。（[彗星信息here](http://www.aaronlerch.com/blog/2007/07/08/creating-comet-applications-with-aspnet/)和[here](http://www.openajax.org/member/wiki/Simple_protocol_for_Ajax_Push)）

使用 Comet，您可以在获得信息时将答案或您拥有的任何信息推送到服务器上，这样您就不会每次 X 次都向客户端请求信息。

但作为一个缺点，tvanfosson 和 Josh 让我注意到，它会使 HTTP 连接在客户端读取状态下长时间阻塞。

# lucene - 在 lucene 搜索结果中冒泡最新内容

> ID：391949
> 
> 赞同：1
> 
> 时间：2008-12-24T18:00:42.853
> 
> 标签：lucene

我将各种文章存储在我的 lucene 索引中。当用户搜索包含特定术语或短语的文章时，我需要显示所有文章（可能在 1000 到 10000 篇文章之间），但最新文章“冒泡”在搜索结果中。

我相信您可以使用“日期字段提升”在 Lucene 中冒泡搜索结果。有人可以告诉我如何去做吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T16:14:34.543

我会实现[SortComparatorSource 接口](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/SortComparatorSource.html)。您应该编写一个新的[ScoreDocComparator](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/ScoreDocComparator.html)，它的 compare() 函数比较两个日期。然后，您将需要使用新的排序器对搜索进行排序。这个建议取自[Lucene in Action](http://www.manning.com/hatcher2/)的第 6 章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T00:57:13.517

您可以使用[setBoost](http://lucene.apache.org/java/2_3_2/api/core/org/apache/lucene/document/Document.html#setBoost(float))方法在索引时为索引中的特定文档设置“提升”。由于默认的 boost 值为 1.0，因此设置小于 1.0 的值将使文档在搜索结果中“相关性降低”。通过将文档的提升值与其年龄相关联（文档越旧，提升越低），您可以使更新的内容在搜索结果中看起来更相关。

请注意，`setBoost`在索引时设置的 boost 值不适用于检索到的文档（boost 有效，您只是无法在检索时读回该值以查看您是否在索引时应用了正确的值）。

# c# - 具有显式接口的依赖属性

> ID：391955
> 
> 赞同：3
> 
> 时间：2008-12-24T18:04:26.200
> 
> 标签：c#, wpf, mvvm, dependency-properties

我正在为我们部门的工作拼凑一个 WPF 演示，向他们展示 WPF 的优势，同时*努力*遵守我们的开发标准（依赖注入和将对象开发到显式接口）。

我现在遇到了一些困难。我正在使用 MVVM 设计模式实现视图，并且每次更新视图模型 (VM) 上的属性时，我都需要更新 TextBlocks Text 属性。为此，我将 VM 属性定义为依赖属性并将视图中的 TextBlocks Text 属性绑定到它。

现在 MV 属性在我的界面上，并且（根据我们的开发标准）明确定义。从视图中，我将视图中 TextBlock 的 Text 属性绑定到依赖属性属性（不是静态部分），但是当依赖属性值更改时，这不会更新我的视图（我知道如何绑定到显式接口，所以这个据我所知，这不是问题）。

任何帮助将不胜感激。我可以将依赖属性与显式接口一起使用吗？如果可以的话，如果没有，您对我在这种情况下可以做什么有任何想法吗？

感谢您的阅读，我期待您的回复。

亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-24T23:36:53.780

我不完全确定我是否正确理解了您的问题，但为什么不简单地`INotifyPropertyChanged`在您的 ViewModel 上使用呢？

例如：

```
interface MyInterface : INotifyPropertyChanged
{
    string Text { get; set; }
}

class MyViewModel : MyInterface
{
    private string text;
    public string Text 
    {
        get { return text; }
        set 
        { 
            if (text != value)
            {
               text = value;
               // TODO: Raise the NotifyPropertyChanged event here
            }
        }
    }
} 
```

有了这个，你应该能够简单地绑定到`Text`属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-25T06:29:04.307

这个问题有点令人困惑，但我会尝试一下。我尝试了依赖属性的几种变体，但无法使其与以下界面一起使用。

```
interface IViewModel
{
    string Text { get; set; }
} 
```

我使用以下语法在实现类上注册了该属性（每个都在不同的测试中）。

```
public static readonly DependencyProperty TextProperty = 
    DependencyProperty.Register("Text", 
        typeof(string), typeof(IViewModel)); 
```

然后我尝试显式或隐式实现接口无济于事。唯一有效的组合是我使用的时候。

```
public static readonly DependencyProperty TextProperty = 
    DependencyProperty.Register("Text", 
        typeof(string), typeof(ImplementingClass)); 
```

如果您遇到问题并正在寻找其他 WPF 示例，您可能需要查看。

*   [52 个 WPF 示例应用程序](http://www.actiprosoftware.com/Support/ResourceGuides/WPF/ViewCategory.aspx?ResourceGuideCategoryID=26)
*   [微软示例](http://windowsclient.net/downloads/folders/wpfsamples/default.aspx)
*   [Vertigo 的光滑样品](http://www.vertigo.com/Lab.aspx)
*   [SO Thread 关于样品](https://stackoverflow.com/questions/244786/wpf-sample-applications)

祝你好运。

# visual-studio - 是否可以仅在 Visual Studio 上启用 ClearType？

> ID：391969
> 
> 赞同：3
> 
> 时间：2008-12-24T18:13:43.060
> 
> 标签：visual-studio, cleartype

我真的很喜欢 Consolas 在启用 ClearType 时的样子，但不幸的是它让其他一切看起来都很糟糕。有没有办法在每个应用程序的基础上启用它？我注意到腻子（终端仿真器）具有与显示设置分开的 ClearType 选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T18:42:05.733

可以有一个应用程序独立于系统范围的设置来启用或禁用 ClearType ......但它需要专门编写应用程序来执行此操作，因为它涉及在创建时将特定参数传递给 Windows API字体。不幸的是，据我所知，VS 并不是为此而编写的。（而且，顺便说一句，我不认为 .NET 也不支持它，而无需求助于 P/Invoke。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T22:03:39.273

使用 ClearType 得到不好的结果但看起来很漂亮的 Consolas 是很奇怪的。试用[ClearType 调谐器。](http://www.microsoft.com/typography/ClearTypePowerToy.mspx)

# javascript - 如何使用 JavaScript 获取客户端的 IP 地址？

> ID：391979
> 
> 赞同：560
> 
> 时间：2008-12-24T18:22:30.780
> 
> 标签：javascript, jquery, ip-address

我需要使用 JavaScript 以某种方式检索客户端的 IP 地址；没有服务器端代码，甚至没有 SSI。

但是，我并不反对使用免费的第 3 方脚本/服务。

* * *

## 回答 #1

> 赞同：1070
> 
> 时间：2016-02-01T04:40:39.370

我会使用一个可以返回 JSON 的 Web 服务（连同 jQuery 一起让事情变得更简单）。以下是我能找到的所有可用的*免费*IP 查找服务以及它们返回的信息。如果您知道其他人，请添加评论，我将更新此答案。

* * *

## [抽象的](https://www.abstractapi.com/ip-geolocation-api)

```
let apiKey = '1be9a6884abd4c3ea143b59ca317c6b2';
$.getJSON('https://ipgeolocation.abstractapi.com/v1/?api_key=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每月 10,000 个请求
*   需要注册才能获取您的 API 密钥

* * *

## [大数据云](https://www.bigdatacloud.com/ip-geolocation-apis)

```
// Base
let apiKey = 'd9e53816d07345139c58d0ea733e3870';
$.getJSON('https://api.bigdatacloud.net/data/ip-geolocation?key=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

```
// Base + Confidence Area
let apiKey = 'd9e53816d07345139c58d0ea733e3870';
$.getJSON('https://api.bigdatacloud.net/data/ip-geolocation-with-confidence?key=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

```
// Base + Confidence Area + Hazard Report
let apiKey = 'd9e53816d07345139c58d0ea733e3870';
$.getJSON('https://api.bigdatacloud.net/data/ip-geolocation-full?key=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每月 10,000 个请求
*   需要注册才能获取您的 API 密钥

* * *

## [Cloudflare](https://www.cloudflare.com/)

```
$.get('https://www.cloudflare.com/cdn-cgi/trace', function(data) {
  // Convert key-value pairs to JSON
  // https://stackoverflow.com/a/39284735/452587
  data = data.trim().split('\n').reduce(function(obj, pair) {
    pair = pair.split('=');
    return obj[pair[0]] = pair[1], obj;
  }, {});
  console.log(data);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   返回纯文本
*   如果有，则仅返回 IPv6 地址

* * *

## [数据库IP](https://db-ip.com/)

**试试看：** [https ://api.db-ip.com/v2/free/self](https://api.db-ip.com/v2/free/self)

```
$.getJSON('https://api.db-ip.com/v2/free/self', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "ipAddress": "116.12.250.1",
  "continentCode": "AS",
  "continentName": "Asia",
  "countryCode": "SG",
  "countryName": "Singapore",
  "city": "Singapore (Queenstown Estate)"
} 
```

**限制：**

*   每天 1,000 个请求
*   需要非空`Origin`请求标头

* * *

## [地理字节](https://geobytes.com/)

**试试看： http:** [//gd.geobytes.com/GetCityDetails](http://gd.geobytes.com/GetCityDetails)

```
$.getJSON('http://gd.geobytes.com/GetCityDetails?callback=?', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "geobytesforwarderfor": "",
  "geobytesremoteip": "116.12.250.1",
  "geobytesipaddress": "116.12.250.1",
  "geobytescertainty": "99",
  "geobytesinternet": "SA",
  "geobytescountry": "Saudi Arabia",
  "geobytesregionlocationcode": "SASH",
  "geobytesregion": "Ash Sharqiyah",
  "geobytescode": "SH",
  "geobyteslocationcode": "SASHJUBA",
  "geobytescity": "Jubail",
  "geobytescityid": "13793",
  "geobytesfqcn": "Jubail, SH, Saudi Arabia",
  "geobyteslatitude": "27.004999",
  "geobyteslongitude": "49.660999",
  "geobytescapital": "Riyadh ",
  "geobytestimezone": "+03:00",
  "geobytesnationalitysingular": "Saudi Arabian ",
  "geobytespopulation": "22757092",
  "geobytesnationalityplural": "Saudis",
  "geobytesmapreference": "Middle East ",
  "geobytescurrency": "Saudi Riyal",
  "geobytescurrencycode": "SAR",
  "geobytestitle": "Saudi Arabia"
} 
```

**限制：**

*   每小时 16,384 个请求
*   免费计划没有 SSL (https)
*   可以返回错误的位置

* * *

## [GeoIPLookup.io](https://geoiplookup.io/api)

```
$.getJSON('https://json.geoiplookup.io/?callback=?', function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每小时 10,000 个请求
*   免费计划仅用于非商业用途
*   如果有，则仅返回 IPv6 地址

* * *

## [地理插件](https://www.geoplugin.com/)

**试试看：** [http ://www.geoplugin.net/json.gp](http://www.geoplugin.net/json.gp)

```
$.getJSON('http://www.geoplugin.net/json.gp', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "geoplugin_request": "116.12.250.1",
  "geoplugin_status": 200,
  "geoplugin_credit": "Some of the returned data includes GeoLite data created by MaxMind, available from <a href=\\'http://www.maxmind.com\\'>http://www.maxmind.com</a>.",
  "geoplugin_city": "Singapore",
  "geoplugin_region": "Singapore (general)",
  "geoplugin_areaCode": "0",
  "geoplugin_dmaCode": "0",
  "geoplugin_countryCode": "SG",
  "geoplugin_countryName": "Singapore",
  "geoplugin_continentCode": "AS",
  "geoplugin_latitude": "1.2931",
  "geoplugin_longitude": "103.855797",
  "geoplugin_regionCode": "00",
  "geoplugin_regionName": "Singapore (general)",
  "geoplugin_currencyCode": "SGD",
  "geoplugin_currencySymbol": "&#36;",
  "geoplugin_currencySymbol_UTF8": "$",
  "geoplugin_currencyConverter": 1.4239
} 
```

**限制：**

*   每分钟 120 个请求
*   免费计划没有 SSL (https)

* * *

## [黑客目标](https://hackertarget.com/geoip-ip-location-lookup/)

```
$.get('https://api.hackertarget.com/geoip/?q=116.12.250.1', function(data) {
  // Convert key-value pairs to JSON
  // https://stackoverflow.com/a/39284735/452587
  data = data.trim().split('\n').reduce(function(obj, pair) {
    pair = pair.split(': ');
    return obj[pair[0]] = pair[1], obj;
  }, {});
  console.log(data);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每天 100 个请求
*   需要 IP 地址参数
*   返回纯文本

* * *

## [伊皮皮](https://ipapi.co/)

**试试看：** [https ://ipapi.co/json/](https://ipapi.co/json/)

```
$.getJSON('https://ipapi.co/json/', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "ip": "116.12.250.1",
  "city": "Singapore",
  "region": "Central Singapore Community Development Council",
  "country": "SG",
  "country_name": "Singapore",
  "postal": null,
  "latitude": 1.2855,
  "longitude": 103.8565,
  "timezone": "Asia/Singapore"
} 
```

**限制：**

*   每天 1,000 个请求
*   需要 SSL (https)
*   需要非空`Origin`请求标头
*   如果有，则仅返回 IPv6 地址

* * *

## [IP-API](https://ip-api.com/)

**试试看：http:** [//ip-api.com/json](http://ip-api.com/json)

```
$.getJSON('http://ip-api.com/json', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "as": "AS3758 SingNet",
  "city": "Singapore",
  "country": "Singapore",
  "countryCode": "SG",
  "isp": "SingNet Pte Ltd",
  "lat": 1.2931,
  "lon": 103.8558,
  "org": "Singapore Telecommunications",
  "query": "116.12.250.1",
  "region": "01",
  "regionName": "Central Singapore Community Development Council",
  "status": "success",
  "timezone": "Asia/Singapore",
  "zip": ""
} 
```

**限制：**

*   每分钟 150 个请求
*   免费计划没有 SSL (https)

* * *

## [数据](https://ipdata.co/)

```
let apiKey = 'be0f755b93290b4c100445d77533d291763a417c75524e95e07819ad';
$.getJSON('https://api.ipdata.co?api-key=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每天 1,500 个请求
*   需要注册才能获取您的 API 密钥
*   需要 SSL (https)

* * *

## [IP 查找](https://ipfind.co/)

```
let apiKey = '50e887ce-e3bb-4f00-a9b9-667597db5539';
$.getJSON('https://ipfind.co/me?auth=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每天 300 个请求
*   需要注册才能获取您的 API 密钥

* * *

## [ipgeolocation](https://ipgeolocation.io/)

```
let apiKey = 'f8e0b361e8f4405c94613ab534959fdf';
$.getJSON('https://api.ipgeolocation.io/ipgeo?apiKey=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每月 50,000 个请求
*   需要注册才能获取您的 API 密钥
*   如果有，则仅返回 IPv6 地址

* * *

## [ipify](https://www.ipify.org/)

```
$.getJSON('https://api.ipify.org?format=jsonp&callback=?', function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   没有任何

* * *

## [IP信息数据库](https://ipinfodb.com/)

```
let apiKey = '25864308b6a77fd90f8bf04b3021a48c1f2fb302a676dd3809054bc1b07f5b42';
$.getJSON('https://api.ipinfodb.com/v3/ip-city/?format=json&key=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每秒两个请求
*   需要注册才能获取您的 API 密钥

* * *

## [ipinfo.io](https://ipinfo.io/)

```
$.getJSON('https://ipinfo.io/json', function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每月 50,000 个请求

* * *

## [注册中心](https://ipregistry.co/)

```
$.getJSON('https://api.ipregistry.co/?key=tryout', function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   免费计划包括 100,000 个请求
*   需要注册才能获取您的 API 密钥
*   如果有，则仅返回 IPv6 地址

* * *

## [ipstack](https://ipstack.com/)（以前的 freegeoip.net）

**试试看：** [http ://api.ipstack.com/ *<ip_address>* ?access_key= *<your_api_key>*](http://api.ipstack.com/116.12.250.1?access_key=7d558868069cc34f545d822af056be3c)

```
$.getJSON('http://api.ipstack.com/<ip_address>?access_key=<your_api_key>', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "ip": "116.12.250.1",
  "type": "ipv4",
  "continent_code": "AS",
  "continent_name": "Asia",
  "country_code": "SG",
  "country_name": "Singapore",
  "region_code": "01",
  "region_name": "Central Singapore Community Development Council",
  "city": "Singapore",
  "zip": null,
  "latitude": 1.2931,
  "longitude": 103.8558,
  "location": {
    "geoname_id": 1880252,
    "capital": "Singapore",
    "languages": [
      {
        "code": "en",
        "name": "English",
        "native": "English"
      },
      {
        "code": "ms",
        "name": "Malay",
        "native": "Bahasa Melayu"
      },
      {
        "code": "ta",
        "name": "Tamil",
        "native": "தமிழ்&quot;
      },
      {
        "code": "zh",
        "name": "Chinese",
        "native": "中文"
      }
    ],
    "country_flag": "http://assets.ipstack.com/flags/sg.svg",
    "country_flag_emoji": "",
    "country_flag_emoji_unicode": "U+1F1F8 U+1F1EC",
    "calling_code": "65",
    "is_eu": false
  }
} 
```

**限制：**

*   每月 10,000 个请求
*   需要 IP 地址参数
*   需要注册才能获取您的 API 密钥
*   免费计划没有 SSL (https)

* * *

## [jsonip.com](https://getjsonip.com/)

```
$.getJSON('https://jsonip.com/', function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   如果有，则仅返回 IPv6 地址

* * *

## [JSON 测试](https://www.jsontest.com/)

**试试看：http:** [//ip.jsontest.com/](http://ip.jsontest.com/)

```
$.getJSON('http://ip.jsontest.com/', function(data) {
  console.log(JSON.stringify(data, null, 2));
}); 
```

回报：

```
{
  "ip": "116.12.250.1"
} 
```

**限制：**

*   无 SSL (https)
*   如果有，则仅返回 IPv6 地址

* * *

## [史努比](https://www.snoopi.io/)

```
let apiKey = 'ed5ebbeba257b8f262a6a9bbc0ec678e';
$.getJSON('https://api.snoopi.io/116.12.250.1?apikey=' + apiKey, function(data) {
  console.log(JSON.stringify(data, null, 2));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
```

**限制：**

*   每月 10,000 个请求
*   每 2 秒 1 个请求
*   需要 IP 地址参数
*   需要注册才能获取您的 API 密钥

* * *

### 香草 JAVASCRIPT

在现代浏览器中，您可以使用原生[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)而不是依赖 jQuery 的`$.getJSON()`. 这是一个例子：

```
let apiKey = '1be9a6884abd4c3ea143b59ca317c6b2';
// Make the request
fetch('https://ipgeolocation.abstractapi.com/v1/?api_key=' + apiKey)
  // Extract JSON body content from HTTP response
  .then(response => response.json())
  // Do something with the JSON data
  .then(data => {
    console.log(JSON.stringify(data, null, 2))
  });
```

### 笔记

*   由于这些都是免费服务，谁知道它们何时/是否会在路上下线（图表 A：[Telize](https://www.telize.com/)）。
*   如果您想要更多功能和稳定性，这些服务中的大多数还提供付费层。
*   正如@skobaljic 在下面的评论中指出的那样，请求配额主要是学术性的，因为呼叫发生在客户端，大多数最终用户永远不会超过他们的配额。
*   有些服务没有可运行的代码片段，因为它们在免费计划中不允许 SSL 连接或需要非空`Origin`请求标头（StackOverflow 代码片段被迫使用 https 并包含`Origin: null`在请求标头中）。

### 更新

*   2/1/2016：删除[Telize](https://www.telize.com/)（不再提供免费计划）
*   2016 年 4 月 18 日：删除[freegeoip.net](http://freegeoip.net/)（停止服务）
*   2016 年 4 月 26 日：添加[了 DB-IP](https://db-ip.com/)
*   2016 年 4 月 26 日：添加[了黑客目标](https://hackertarget.com/geoip-ip-location-lookup/)
*   2016 年 7 月 6 日：恢复[freegeoip.net](http://freegeoip.net/)
*   2016 年 7 月 6 日：删除[ip-json.rhcloud.com](http://ip-json.rhcloud.com/)（死链接）
*   2016 年 12 月 21 日：删除了[黑客目标](https://hackertarget.com/geoip-ip-location-lookup/)（停止服务）
*   2017 年 2 月 10 日：添加[了 Nekudo](http://geoip.nekudo.com/)
*   2017 年 4 月 20 日：添加[了 ipapi](https://ipapi.co/)（感谢 Ahmad Awais）
*   2017 年 4 月 24 日：恢复[黑客目标](https://hackertarget.com/geoip-ip-location-lookup/)
*   2017 年 4 月 24 日：删除[Snoopi.io](https://www.snoopi.io/)（停止服务）
*   2017 年 7 月 16 日：添加了限制“免费计划没有 SSL (https)”
*   2017 年 7 月 16 日：添加了[IP 查找](https://ipfind.co/)（感谢 JordanC）
*   2017 年 9 月 25 日：添加[了 Stupid Web 工具](http://www.stupidwebtools.com/)（感谢 Cœur）
*   2018 年 3 月 16 日：添加[了 ipdata](https://ipdata.co/)（感谢 Jonathan）
*   2018 年 4 月 14 日：将 freegeoip.net 重命名为[ipstack](https://ipstack.com/)（感谢 MA-Maddin）
*   2018 年 4 月 16 日：添加[GeoIPLookup.io](https://geoiplookup.io/)（感谢 Rob Waa）
*   2018 年 6 月 11 日：添加[了 ipgeolocation](https://ipgeolocation.io/)（感谢 Ejaz Ahmed）
*   2019 年 7 月 31 日：添加[了 ipregistry](https://ipregistry.co/)（感谢 Laurent）
*   2019 年 8 月 16 日：添加[SmartIP.io](https://smartip.io/)（感谢 kevinj）
*   2019 年 8 月 22 日：删除了[Stupid Web Tools](http://www.stupidwebtools.com/)（停止服务）
*   2019 年 12 月 10 日：添加[了 Cloudflare](https://www.cloudflare.com/)
*   2020 年 1 月 9 日：删除[SmartIP.io](https://smartip.io/)（停止服务）
*   2020 年 11 月 6 日：添加[摘要](https://www.abstractapi.com/)
*   2020 年 11 月 13日：添加[了 AstroIP.co](https://astroip.co/)
*   2021 年 4 月 13 日：用片段替换代码示例（接近 30k 字符限制）
*   2021 年 4 月 13 日：添加了将键值对转换为 JSON 以用于纯文本响应的代码
*   2021 年 4 月 13 日：添加了限制“需要非空`Origin`请求标头”
*   2021 年 4 月 13 日：添加[了 BigDataCloud](https://www.bigdatacloud.com/ip-geolocation-apis)
*   2021 年 4 月 13 日：恢复[Snoopi.io](https://www.snoopi.io/)
*   2021 年 4 月 13 日：删除[AstroIP.co](https://astroip.co/)（停止服务）
*   2021 年 4 月 13 日：移除[Nekudo](http://geoip.nekudo.com/)（现在是 ipapi 的一部分）

* * *

## 回答 #2

> 赞同：305
> 
> 时间：2015-09-29T10:03:00.370

## 2021 年更新：

正如最近一个新的 Github 存储库[webrtc-ip](https://github.com/joeymalvinni/webrtc-ip)所示，您现在可以使用 WebRTC 泄露用户的***公共***IP 地址。遗憾的是，由于逐渐转向 mDNS（至少对于 WebRTC 而言），此泄漏不适用于私有 IP，[此处](https://bloggeek.me/psa-mdns-and-local-ice-candidates-are-coming/)已完全解释。但是，这是一个工作演示：

```
getIPs().then(res => document.write(res.join('\n')))
```

```
<script src="https://cdn.jsdelivr.net/gh/joeymalvinni/webrtc-ip/dist/bundle.dev.js"></script>
```

可以在[此处](https://github.com/joeymalvinni/webrtc-ip/blob/main/dist/bundle.dev.js)找到此存储库的已编译源代码。

* * *

（以前）**最终更新**

此解决方案将不再有效，因为浏览器正在修复 webrtc 泄漏：有关更多信息，请阅读另一个问题：[RTCIceCandidate 不再返回 IP](https://stackoverflow.com/questions/56755747/rtcicecandidate-no-longer-returning-ip)

* * *

**更新**：我一直想做一个最小/丑化版本的代码，所以这里是一个 ES6 Promise 代码：

```
var findIP = new Promise(r=>{var w=window,a=new (w.RTCPeerConnection||w.mozRTCPeerConnection||w.webkitRTCPeerConnection)({iceServers:[]}),b=()=>{};a.createDataChannel("");a.createOffer(c=>a.setLocalDescription(c,b,b),b);a.onicecandidate=c=>{try{c.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g).forEach(r)}catch(e){}}})

/*Usage example*/
findIP.then(ip => document.write('your ip: ', ip)).catch(e => console.error(e))
```

**注意：**如果您想要用户的所有 IP（可能更多取决于他的网络），这个新的缩小代码将只返回单个 IP，请使用原始代码...

* * *

感谢**WebRTC**，在支持 WebRTC 的浏览器中获取本地 IP 非常容易（至少现在是这样）。我修改了源代码，减少了行数，没有发出任何 stun 请求，因为您只需要本地 IP，而不是公共 IP，下面的代码适用于最新的 Firefox 和 Chrome，只需运行代码段并自行检查：

```
function findIP(onNewIP) { //  onNewIp - your listener function for new IPs
  var myPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection; //compatibility for firefox and chrome
  var pc = new myPeerConnection({iceServers: []}),
    noop = function() {},
    localIPs = {},
    ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g,
    key;

  function ipIterate(ip) {
    if (!localIPs[ip]) onNewIP(ip);
    localIPs[ip] = true;
  }
  pc.createDataChannel(""); //create a bogus data channel
  pc.createOffer(function(sdp) {
    sdp.sdp.split('\n').forEach(function(line) {
      if (line.indexOf('candidate') < 0) return;
      line.match(ipRegex).forEach(ipIterate);
    });
    pc.setLocalDescription(sdp, noop, noop);
  }, noop); // create offer and set local description
  pc.onicecandidate = function(ice) { //listen for candidate events
    if (!ice || !ice.candidate || !ice.candidate.candidate || !ice.candidate.candidate.match(ipRegex)) return;
    ice.candidate.candidate.match(ipRegex).forEach(ipIterate);
  };
}

var ul = document.createElement('ul');
ul.textContent = 'Your IPs are: '
document.body.appendChild(ul);

function addIP(ip) {
  console.log('got ip: ', ip);
  var li = document.createElement('li');
  li.textContent = ip;
  ul.appendChild(li);
}

findIP(addIP);
```

```
<h1> Demo retrieving Client IP using WebRTC </h1>
```

这里发生的情况是，我们正在创建一个虚拟对等连接，并且为了让远程对等连接我们，我们通常会相互交换 ice 候选者。并且读取候选冰（从本地会话描述和 onIceCandidateEvent）我们可以知道用户的 IP。

我从哪里获取代码-> [Source](https://github.com/diafygi/webrtc-ips)

* * *

## 回答 #3

> 赞同：174
> 
> 时间：2009-05-01T07:02:03.670

您可以使用 JSONP 通过服务器端中继它

在谷歌搜索找到一个时，在 SO[我可以使用客户端 Javascript 执行 DNS 查找（主机名到 IP 地址）吗？](https://stackoverflow.com/questions/102605/can-i-lookup-the-ip-address-of-a-hostname-from-javascript)

```
<script type="application/javascript">
    function getip(json){
      alert(json.ip); // alerts the ip address
    }
</script>

<script type="application/javascript" src="http://www.telize.com/jsonip?callback=getip"></script> 
```

> **注意：** telize.com API 已于[2015 年 11 月 15 日永久关闭](http://www.cambus.net/adventures-in-running-a-free-public-api/)。

* * *

## 回答 #4

> 赞同：112
> 
> 时间：2008-12-24T18:25:00.650

这里的大多数答案都“解决”了对服务器端代码的需求……点击别人的服务器。这是一种完全有效的技术，除非您*确实需要*在不访问服务器的情况下获取 IP 地址。

传统上，如果没有某种插件，这是不可能的（即使那样，如果你在 NAT 路由器后面，你可能会得到*错误*的IP 地址），但随着 WebRTC 的出现，实际上可以做到这一点。 .*如果*您的目标[是支持 WebRTC 的浏览器](http://caniuse.com/#feat=rtcpeerconnection)（目前：Firefox、Chrome 和 Opera）。

有关如何使用 WebRTC 检索有用的客户端 IP 地址的详细信息，**[请阅读 mido 的答案。](https://stackoverflow.com/questions/391979/get-client-ip-using-just-javascript/32841164#32841164)**

* * *

## 回答 #5

> 赞同：95
> 
> 时间：2015-01-14T05:28:30.287

# 别再看了

查看[http://www.ipify.org/](http://www.ipify.org/)

根据他们：

> *   您可以**无限制**地使用它（即使您每分钟处理数百万个请求）。
> *   ipify 是完全开源的（查看[GitHub 存储库](https://github.com/rdegges/ipify-api)）。

这是一个有效的 JS 示例（与其想知道为什么这个答案的票数这么少，不如自己尝试一下，看看它的实际效果）：

```
<script>
function getIP(json) {
  alert("My public IP address is: " + json.ip);
}
</script>
<script src="https://api.ipify.org?format=jsonp&callback=getIP"></script> 
```

懒得复制/粘贴？我喜欢。[**这是一个演示**](http://jsbin.com/bajubacaju/edit?html,output)

懒得点击？`:O`

> **注意**：*在运行演示之前关闭 Adblock Plus / uBlock & co .. 否则，它将无法正常工作。*

我与 IPify 团队*无关。*我只是觉得有人会为大众提供这样的服务真是太酷了。

* * *

## 回答 #6

> 赞同：92
> 
> 时间：2015-04-09T03:09:47.510

你不能。你得问服务员。

* * *

## 回答 #7

> 赞同：82
> 
> 时间：2011-03-08T22:21:18.237

您可以对 hostip.info 或类似服务进行 ajax 调用...

```
function myIP() {
    if (window.XMLHttpRequest) xmlhttp = new XMLHttpRequest();
    else xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

    xmlhttp.open("GET","http://api.hostip.info/get_html.php",false);
    xmlhttp.send();

    hostipInfo = xmlhttp.responseText.split("\n");

    for (i=0; hostipInfo.length >= i; i++) {
        ipAddress = hostipInfo[i].split(":");
        if ( ipAddress[0] == "IP" ) return ipAddress[1];
    }

    return false;
} 
```

作为奖励，地理定位信息在同一个调用中返回。

* * *

## 回答 #8

> 赞同：77
> 
> 时间：2013-11-13T12:06:34.550

> 尝试这个

```
$.get("http://ipinfo.io", function(response) {
    alert(response.ip);
}, "jsonp"); 
```

或者

```
$(document).ready(function () {
    $.getJSON("http://jsonip.com/?callback=?", function (data) {
        console.log(data);
        alert(data.ip);
    });
}); 
```

[小提琴](http://jsfiddle.net/rBL3D/79/)

* * *

## 回答 #9

> 赞同：27
> 
> 时间：2013-07-23T10:48:51.337

您可以为此使用我的服务[http://ipinfo.io](http://ipinfo.io)，它将为您提供客户端 IP、主机名、地理位置信息和网络所有者。这是一个记录 IP 的简单示例：

```
$.get("http://ipinfo.io", function(response) {
    console.log(response.ip);
}, "jsonp"); 
```

这是一个更详细的 JSFiddle 示例，它还打印出完整的响应信息，因此您可以查看所有可用的详细信息：http: [//jsfiddle.net/zK5FN/2/](http://jsfiddle.net/zK5FN/2/)

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2012-06-16T13:56:39.073

Include this code in your page : `<script type="text/javascript" src="http://l2.io/ip.js"></script>`

more doc [here](http://l2.io)

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2016-04-13T22:40:29.977

这个问题有两种解释。大多数人将“客户端 IP”解释为 Web 服务器在 LAN 之外和 Internet 上看到的公共 IP 地址。在大多数情况下，这不是客户端计算机的 IP 地址，但

我需要运行托管我的 JavaScript 软件的浏览器的计算机的真实 IP 地址（它几乎总是位于 NAT 层后面的 LAN 上的本地 IP 地址）。

Mido 在上面发布了一个 FANTASTIC 答案，这似乎是唯一真正提供客户端 IP 地址的答案。

谢谢你，米多！

但是，呈现的函数是异步运行的。我需要在我的代码中实际使用 IP 地址，并且通过异步解决方案，我可能会尝试在检索/学习/存储 IP 地址之前使用它。在使用它们之前，我必须能够等待结果到达。

这是 Mido 函数的“等待”版本。我希望它可以帮助别人：

```
function findIP(onNewIP) { //  onNewIp - your listener function for new IPs
    var promise = new Promise(function (resolve, reject) {
        try {
            var myPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection; //compatibility for firefox and chrome
            var pc = new myPeerConnection({ iceServers: [] }),
                noop = function () { },
                localIPs = {},
                ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g,
                key;
            function ipIterate(ip) {
                if (!localIPs[ip]) onNewIP(ip);
                localIPs[ip] = true;
            }
            pc.createDataChannel(""); //create a bogus data channel
            pc.createOffer(function (sdp) {
                sdp.sdp.split('\n').forEach(function (line) {
                    if (line.indexOf('candidate') < 0) return;
                    line.match(ipRegex).forEach(ipIterate);
                });
                pc.setLocalDescription(sdp, noop, noop);
            }, noop); // create offer and set local description

            pc.onicecandidate = function (ice) { //listen for candidate events
                if (ice && ice.candidate && ice.candidate.candidate && ice.candidate.candidate.match(ipRegex)) {
                    ice.candidate.candidate.match(ipRegex).forEach(ipIterate);
                }
                resolve("FindIPsDone");
                return;
            };
        }
        catch (ex) {
            reject(Error(ex));
        }
    });// New Promise(...{ ... });
    return promise;
};

//This is the callback that gets run for each IP address found
function foundNewIP(ip) {
    if (typeof window.ipAddress === 'undefined')
    {
        window.ipAddress = ip;
    }
    else
    {
        window.ipAddress += " - " + ip;
    }
}

//This is How to use the Waitable findIP function, and react to the
//results arriving
var ipWaitObject = findIP(foundNewIP);        // Puts found IP(s) in window.ipAddress
ipWaitObject.then(
    function (result) {
        alert ("IP(s) Found.  Result: '" + result + "'. You can use them now: " + window.ipAddress)
    },
    function (err) {
        alert ("IP(s) NOT Found.  FAILED!  " + err)
    }
); 
```

```
<h1>Demo "Waitable" Client IP Retrieval using WebRTC </h1>
```

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2012-09-07T09:01:37.087

我想说乍得和马耳他有很好的答案。然而，他们的情况很复杂。所以我建议我从国家插件的广告中找到的这段代码

```
<script>
<script language="javascript" src="http://j.maxmind.com/app/geoip.js"></script>
<script language="javascript">
mmjsCountryCode = geoip_country_code();
mmjsCountryName = geoip_country_name();

</script> 
```

**没有阿贾克斯。只是普通的javascripts。:D**

如果你去[http://j.maxmind.com/app/geoip.js](http://j.maxmind.com/app/geoip.js)你会看到它包含

```
function geoip_country_code() { return 'ID'; }
function geoip_country_name() { return 'Indonesia'; }
function geoip_city()         { return 'Jakarta'; }
function geoip_region()       { return '04'; }
function geoip_region_name()  { return 'Jakarta Raya'; }
function geoip_latitude()     { return '-6.1744'; }
function geoip_longitude()    { return '106.8294'; }
function geoip_postal_code()  { return ''; }
function geoip_area_code()    { return ''; }
function geoip_metro_code()   { return ''; } 
```

它还没有真正回答这个问题，因为

[http://j.maxmind.com/app/geoip.js](http://j.maxmind.com/app/geoip.js)不包含 IP（尽管我打赌它使用 IP 来获取国家/地区）。

但是制作一个弹出类似的 PhP 脚本非常容易

```
function visitorsIP()   { return '123.123.123.123'; } 
```

做那个。穿上[http://yourdomain.com/yourip.php](http://yourdomain.com/yourip.php)。

然后做

```
<script language="javascript" src="http://yourdomain.com/yourip.php"></script> 
```

该问题特别提到不要使用第三方脚本。没有其他办法。Javascript 无法知道您的 IP。但是可以通过 javascript 访问的其他服务器也可以正常工作，没有问题。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2009-01-04T12:07:52.470

好吧，我离题了，但我今天也有类似的需求，虽然我无法使用 Javascript 从客户端找到 ID，但我做了以下操作。

在服务器端： -

```
<div style="display:none;visibility:hidden" id="uip"><%= Request.UserHostAddress %></div> 
```

使用 Javascript

```
var ip = $get("uip").innerHTML; 
```

我正在使用 ASP.Net Ajax，但您可以使用 getElementById 而不是 $get()。

发生的事情是，我在页面上有一个隐藏的 div 元素，用户的 IP 是从服务器呈现的。比在 Javascript 中我只加载那个值。

这可能对像你这样有类似要求的人有帮助（比如我，虽然我还没有弄清楚）。

干杯!

* * *

## 回答 #14

> 赞同：14
> 
> 时间：2008-12-24T18:25:06.280

除非您使用某种外部服务，否则一般不可能。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2012-02-27T23:00:00.777

使用 Smart-IP.net [Geo-IP API](http://smart-ip.net/geoip-api)。例如，通过使用 jQuery：

```
$(document).ready( function() {
    $.getJSON( "http://smart-ip.net/geoip-json?callback=?",
        function(data){
            alert( data.host);
        }
    );
}); 
```

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2015-12-03T11:50:59.463

有一种更简单且免费的方法，不会向您的访问者征求任何许可。

它包括向[http://freegeoip.net/json](http://freegeoip.net/json)提交一个非常简单的 Ajax POST 请求。收到 JSON 格式的位置信息后，您会通过更新页面或重定向到新页面来做出相应的反应。

以下是您提交位置信息请求的方式：

```
jQuery.ajax( { 
  url: '//freegeoip.net/json/', 
  type: 'POST', 
  dataType: 'jsonp',
  success: function(location) {
     console.log(location)
  }
} ); 
```

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2016-03-25T16:26:11.917

我真的很喜欢[`api.ipify.org`](https://www.ipify.org/)，因为它同时支持 HTTP 和 HTTPS。

下面是一些`api.ipify.org`使用 jQuery 获取 IP 的示例。

### HTTPS 上的 JSON 格式

```
https://api.ipify.org?format=json 
```

```
$.getJSON("https://api.ipify.org/?format=json", function(e) {
    alert(e.ip);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

### 基于 HTTP 的 JSON 格式

```
http://api.ipify.org?format=json 
```

```
$.getJSON("http://api.ipify.org/?format=json", function(e) {
    alert(e.ip);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

### HTTPS 上的文本格式

如果您不想在 JSON 中使用它，那么还有一个通过 HTTPS 的纯文本响应

```
https://api.ipify.org 
```

### HTTP 上的文本格式

还有一个通过 HTTP 的明文响应

```
http://api.ipify.org 
```

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2014-09-21T05:37:10.077

您可以使用[userinfo.io](http://userinfo.io) javascript 库。

```
<script type="text/javascript" src="userinfo.0.0.1.min.js"></script>

UserInfo.getInfo(function(data) {
  alert(data.ip_address);
}, function(err) {
  // Do something with the error
}); 
```

您还可以使用 requirejs 来加载脚本。

它将为您提供访问者的 IP 地址，以及有关其位置（国家、城市等）的一些数据。它基于 maxmind geoip 数据库。

*免责声明：我写了这个库*

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2014-03-11T06:38:26.437

**使用 jQuery 获取您的 IP**

一行JS就可以得到你的公网IP地址？有一项免费服务可以为您提供此功能，您只需要一个获取请求即可：

```
 $.get('http://jsonip.com/', function(r){ console.log(r.ip); }); 
```

要使上述代码段正常工作，您的浏览器必须支持 CORS（跨域请求共享）。否则会抛出安全异常。在旧浏览器中，您可以使用此版本，它使用 JSON-P 请求：

```
 $.getJSON('http://jsonip.com/?callback=?', function(r){ console.log(r.ip); }); 
```

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2018-02-18T13:30:57.043

使用[ipdata.co](https://ipdata.co?utm_campaign=stackoverflow-answer-391979&utm_medium=answer&utm_source=stackoverflow)。

该 API 还提供地理位置数据，并有 10 个全球端点，每个端点每天能够处理超过 8 亿个请求！

> 此答案使用非常有限的“测试”API 密钥，仅用于测试几个调用。[注册](https://ipdata.co?utm_campaign=stackoverflow-answer-391979-free-plan-cta&utm_medium=answer&utm_source=stackoverflow)您自己的免费 API 密钥并每天收到多达 1500 个开发请求。

```
$.get("https://api.ipdata.co?api-key=test", function (response) {
    $("#response").html(response.ip);
}, "jsonp");
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<pre id="response"></pre>
```

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2008-12-24T18:28:50.423

没有真正可靠的方法来获取客户端计算机的 IP 地址。

这经历了一些可能性。如果用户有多个接口，使用 Java 的代码将会中断。

[http://nanoagent.blogspot.com/2006/09/how-to-find-evaluate-remoteaddrclients.html](http://nanoagent.blogspot.com/2006/09/how-to-find-evaluate-remoteaddrclients.html)

从这里的其他答案看来，您可能想要获取客户端的公共 IP 地址，这可能是他们用来连接互联网的路由器的地址。这里的许多其他答案都谈到了这一点。我建议创建和托管您自己的服务器端页面，以接收请求并使用 IP 地址进行响应，而不是依赖于可能会或可能不会继续工作的其他人的服务。

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2014-02-12T00:06:47.997

Appspot.com 回调服务不可用。ipinfo.io 似乎正在工作。

我做了一个额外的步骤，并使用 AngularJS 检索了所有地理信息。（感谢 Ricardo）检查一下。

```
<div ng-controller="geoCtrl">
  <p ng-bind="ip"></p>
  <p ng-bind="hostname"></p>
  <p ng-bind="loc"></p>
  <p ng-bind="org"></p>
  <p ng-bind="city"></p>
  <p ng-bind="region"></p>
  <p ng-bind="country"></p>
  <p ng-bind="phone"></p>
</div>
<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="http://code.angularjs.org/1.2.12/angular.min.js"></script>
<script src="http://code.angularjs.org/1.2.12/angular-route.min.js"></script>
<script>
'use strict';
var geo = angular.module('geo', [])
.controller('geoCtrl', ['$scope', '$http', function($scope, $http) {
  $http.jsonp('http://ipinfo.io/?callback=JSON_CALLBACK')
    .success(function(data) {
    $scope.ip = data.ip;
    $scope.hostname = data.hostname;
    $scope.loc = data.loc; //Latitude and Longitude
    $scope.org = data.org; //organization
    $scope.city = data.city;
    $scope.region = data.region; //state
    $scope.country = data.country;
    $scope.phone = data.phone; //city area code
  });
}]);
</script> 
```

工作页面在这里：[http ://www.orangecountyseomarketing.com/projects/_ip_angularjs.html](http://www.orangecountyseomarketing.com/projects/_ip_angularjs.html)

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2012-07-09T14:34:07.547

当我想在 html 页面中存储信息时，我将提供一种我经常使用的方法，并希望我的 javascript 读取信息而无需实际将参数传递给 javascript。当您的脚本被外部引用而不是内联时，这尤其有用。

但是，它不符合“无服务器端脚本”的标准。但是，如果您可以在 html 中包含服务器端脚本，请执行以下操作：

在您的 html 页面底部，就在 end body 标记上方制作隐藏标签元素。

您的标签将如下所示：

```
<label id="ip" class="hiddenlabel"><?php echo $_SERVER['REMOTE_ADDR']; ?></label> 
```

确保创建一个名为`hiddenlabel`并设置的类，`visibility:hidden`以便没有人真正看到标签。您可以通过这种方式在隐藏标签中存储很多东西。

现在，在您的 javascript 中，要检索存储在标签中的信息（在本例中为客户端的 IP 地址），您可以执行以下操作：

```
var ip = document.getElementById("ip").innerHTML; 
```

现在您的变量“ip”等于 ip 地址。现在您可以将 ip 传递给您的 API 请求。

*** 2 年后编辑 *** 两个小改进：

我经常使用这种方法，但是调用 label `class="data"`，因为它实际上是一种存储数据的方式。类名“hiddenlabel”是一个愚蠢的名字。

第二个修改是在样式表中，而不是`visibility:hidden`：

```
.data{
    display:none;
} 
```

...是更好的方法。

* * *

## 回答 #24

> 赞同：8
> 
> 时间：2013-11-13T12:06:58.023

如果你要包含一个文件，你可以做一个简单的 ajax get：

```
function ip_callback() {
    $.get("ajax.getIp.php",function(data){ return data; }
} 
```

`ajax.getIp.php`会是这样的：

```
<?=$_SERVER['REMOTE_ADDR']?> 
```

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2013-07-22T23:56:13.977

[Javascript / jQuery 获取客户端的 IP 地址和位置](http://ip.codehelper.io)（国家、城市）

您只需要在服务器上嵌入一个带有“src”链接的标签。服务器将“codehelper_ip”作为 Object / JSON 返回，您可以立即使用它。

```
// First, embed this script in your head or at bottom of the page.
<script language="Javascript" src="http://www.codehelper.io/api/ips/?js"></script>
// You can use it
<script language="Javascript">
    alert(codehelper_ip.IP);
    alert(codehelper_ip.Country);
</script> 
```

更多信息在[Javascript Detect Real IP Address Plus Country](http://ip.codehelper.io)

如果您使用的是 jQUery，您可以尝试：

```
console.log(codehelper_ip); 
```

它将向您显示有关返回对象的更多信息。

如果你想要回调函数，请试试这个：

```
// First, embed this script in your head or at bottom of the page.
<script language="Javascript" src="http://www.codehelper.io/api/ips/?callback=yourcallback"></script>
// You can use it
<script language="Javascript">
    function yourcallback(json) {
       alert(json.IP);
     }
</script> 
```

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2018-03-23T16:10:28.687

试试这个：[http](http://httpbin.org/ip) ://httpbin.org/ip （或[https://httpbin.org/ip](https://httpbin.org/ip)）

以 https 为例：

```
$.getJSON('https://httpbin.org/ip', function(data) {
                console.log(data['origin']);
}); 
```

来源：[http ://httpbin.org/](http://httpbin.org/)

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2016-12-07T14:23:22.403

如果您在某处使用 NGINX，您可以添加此代码段并通过任何 AJAX 工具询问您自己的服务器。

```
location /get_ip {
    default_type text/plain;
    return 200 $remote_addr;
} 
```

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2018-04-15T13:47:22.257

首先是***实际答案***：**不可能使用纯粹的客户端执行代码来找出您自己的 IP 地址。**

但是，您可以对[https://api.muctool.de/whois](https://api.muctool.de/whois)执行 GET并接收类似获取客户端 IP 地址的信息

```
{
"ip": "88.217.152.15",
"city": "Munich",
"isp": "M-net Telekommunikations GmbH",
"country": "Germany",
"countryIso": "DE",
"postalCode": "80469",
"subdivisionIso": "BY",
"timeZone": "Europe/Berlin",
"cityGeonameId": 2867714,
"countryGeonameId": 2921044,
"subdivisionGeonameId": 2951839,
"ispId": 8767,
"latitude": 48.1299,
"longitude": 11.5732,
"fingerprint": "61c5880ee234d66bded68be14c0f44236f024cc12efb6db56e4031795f5dc4c4",
"session": "69c2c032a88fcd5e9d02d0dd6a5080e27d5aafc374a06e51a86fec101508dfd3",
"fraud": 0.024,
"tor": false
} 
```

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2016-04-25T10:58:17.923

**获取系统本地 IP：**

```
 try {
var RTCPeerConnection = window.webkitRTCPeerConnection || window.mozRTCPeerConnection;
if (RTCPeerConnection) (function () {
    var rtc = new RTCPeerConnection({ iceServers: [] });
    if (1 || window.mozRTCPeerConnection) {
        rtc.createDataChannel('', { reliable: false });
    };

    rtc.onicecandidate = function (evt) {
        if (evt.candidate) grepSDP("a=" + evt.candidate.candidate);
    };
    rtc.createOffer(function (offerDesc) {
        grepSDP(offerDesc.sdp);
        rtc.setLocalDescription(offerDesc);
    }, function (e) { console.warn("offer failed", e); });

    var addrs = Object.create(null);
    addrs["0.0.0.0"] = false;
    function updateDisplay(newAddr) {
        if (newAddr in addrs) return;
        else addrs[newAddr] = true;
        var displayAddrs = Object.keys(addrs).filter(function (k) { return addrs[k]; });
        LgIpDynAdd = displayAddrs.join(" or perhaps ") || "n/a";
        alert(LgIpDynAdd)
    }

    function grepSDP(sdp) {
        var hosts = [];
        sdp.split('\r\n').forEach(function (line) {
            if (~line.indexOf("a=candidate")) {
                var parts = line.split(' '),
                    addr = parts[4],
                    type = parts[7];
                if (type === 'host') updateDisplay(addr);
            } else if (~line.indexOf("c=")) {
                var parts = line.split(' '),
                    addr = parts[2];
                alert(addr);
            }
        });
    }
})();} catch (ex) { } 
```

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2017-08-08T07:34:11.460

```
 $.getJSON("http://jsonip.com?callback=?", function (data) {
        alert("Your ip address: " + data.ip);
    }); 
```

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2014-07-14T20:23:32.883

您可以通过使用 js 可以调用的 Flash 对象完全在客户端并且主要在 JavaScript 中完成此操作。Flash*可以*访问本地机器的 IP 地址，这可能不是很有用。

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2014-05-28T12:51:40.533

您可以使用以下 Web 服务：http: [//ip-api.com/](http://ip-api.com/)

例子：

```
<script type="text/javascript" src="http://ip-api.com/json/?callback=foo">
<script>
    function foo(json) {
        alert(json.query)
    }
</script>

additional example: http://whatmyip.info 
```

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2014-02-19T06:31:01.933

```
var call_to = "http://smart-ip.net/geoip-json?callback=?";

$.getJSON(call_to, function(data){
   alert(data.host);
}); 
```

`data.host`是IP地址。只需从您的浏览器中调用它。

`http://smart-ip.net/geoip-json?callback=?`[不带引号]并获取IP。

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2013-11-13T15:50:48.223

```
<!DOCTYPE html>
<html ng-app="getIp">
<body>
    <div ng-controller="getIpCtrl">
        <div ng-bind="ip"></div>
    </div>

    <!-- Javascript for load faster
    ================================================== -->
    <script src="lib/jquery/jquery.js"></script>
    <script src="lib/angular/angular.min.js"></script>
    <script>
    /// Scripts app

    'use strict';

    /* App Module */
    var getIp = angular.module('getIp', [ ]);

    getIp.controller('getIpCtrl', ['$scope', '$http',
      function($scope, $http) {
        $http.jsonp('http://jsonip.appspot.com/?callback=JSON_CALLBACK')
            .success(function(data) {
            $scope.ip = data.ip;
        });
      }]);

    </script>
</body>
</html> 
```

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2014-12-30T17:09:26.750

```
<script type="text/javascript" src="http://l2.io/ip.js?var=myip"></script>
    <script>
        function systemip(){
        document.getElementById("ip").value = myip
        console.log(document.getElementById("ip").value)
        }
    </script> 
```

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2017-03-23T12:31:51.310

获取 IP 地址的简单解决方案是在文件中添加以下代码。

```
 $.getJSON('https://api.ipify.org?format=json', function(data){

   // Your callback functions like   

    console.log(data.ip);
    localStorage.setItem('ip',data.ip);
    alert(data.ip);

  }); 
```

它会在页面加载时获取 IP 地址。

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2017-08-06T20:15:49.847

您可以尝试使用我们的[https://ip-api.io](https://ip-api.io) geo ip API。以 jQuery 为例：

```
$(document).ready( function() {
    $.getJSON("http://ip-api.io/api/json",
        function(data){
            console.log(data);
        }
    );
}); 
```

[https://ip-api.io](https://ip-api.io)还会检查 TOR、公共代理和垃圾邮件发送者数据库并提供此信息。

示例响应：

```
{
  "ip": "182.35.213.213",
  "country_code": "US",
  "country_name": "United States",
  "region_code": "CA",
  "region_name": "California",
  "city": "San Francisco",
  "zip_code": "94107",
  "time_zone": "America/Los_Angeles",
  "latitude": 32.7697,
  "longitude": -102.3933,
  "suspicious_factors": {
    "is_proxy": true,
    "is_tor_node": true,
    "is_spam": true,
    "is_suspicious": true // true if any of other fields (is_proxy, is_tor_node, is_spam) is true
  }
} 
```

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2013-02-12T04:46:12.827

以上所有答案都有服务器部分，而不是纯客户端部分。这应该由网络浏览器提供。目前，没有网络浏览器支持此功能。

但是，对于 Firefox 的这个插件： [https](https://addons.mozilla.org/en-US/firefox/addon/ip-address/) ://addons.mozilla.org/en-US/firefox/addon/ip-address/ 您必须要求您的用户安装这个插件。（这对我来说很好，第 3 方）。

您可以测试用户是否安装了它。

```
var installed=window.IP!==undefined; 
```

您可以使用 javascript 获取它，如果已安装，则 var ip=IP.getClient(); var IPclient=ip.IP; //而ip.url是url

```
ip=IP.getServer();
var IPserver=ip.IP;
var portServer=ip.port;
//while ip.url is the url

//or you can use IP.getBoth(); 
```

更多信息在这里：[http ://www.jackiszhp.info/tech/addon.IP.html](http://www.jackiszhp.info/tech/addon.IP.html)

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2017-09-25T21:33:07.463

尝试这个

```
$.get("http://ipinfo.io", function(response) {
   alert(response.ip);
}, "jsonp"); 
```

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2015-11-18T08:49:11.917

我在这里看到的其他一些服务的一个问题是它们要么不支持 IPv6，要么在存在 IPv6 的情况下无法预测。

因为我自己在双栈环境中需要此功能，所以我将自己的 IP 地址服务放在一起，您可以在[http://myip.addr.space/](http://myip.addr.space/)找到它。[/help](http://myip.addr.space/help)也有一个快速参考。

要将它与 jQuery 一起使用，请使用`/ip`端点。您将返回包含 IP 地址的纯文本，具体取决于您使用的子域：

`$.get("http://myip.addr.space/ip")`返回 IPv6 或 IPv4，具体取决于系统可用的内容。（[JSFiddle](http://jsfiddle.net/kdew5ob4/)）

`$.get("http://ipv4.myip.addr.space/ip")`总是返回 IPv4（如果没有 IPv4，则失败）。

`$.get("http://ipv6.myip.addr.space/ip")`总是返回 IPv6（如果没有 IPv6，则失败）。

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2008-12-24T18:38:51.730

我不是 javascript 大师，但如果可能的话，您可以打开一个以[http://www.whatismyip.com/automation/n09230945.asp](http://www.whatismyip.com/automation/n09230945.asp)作为源的 iframe 并阅读框架的内容。

编辑：由于跨域安全性，这将不起作用。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2014-07-22T05:40:07.337

我有自己的带有 laravel 的 api 后端，所以我通常只是以下内容：

```
$(document).ready( function() {

    $.getJSON( "http://api.whoisdoma.com/v1/ip/visitor?api_key=key",
        function(data){
          alert( data.ip);
        }
    );

}); 
```

为了额外的安全性，我提供了一个获取结果所需的 api 密钥。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2014-06-16T09:23:12.933

```
$.getJSON("http://jsonip.com?callback=?", function (data) {
    alert("Your ip: " + data.ip);
}); 
```

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2015-09-27T11:11:50.070

**用于查找 IP 的 Java 脚本**

*为了获得 IP 地址，我正在对 Free Web Service 进行 JSON 调用*。喜欢

[jsonip.com/json, ipinfo.io/json, www.telize.com/geoip, ip-api.com/json, api.hostip.info/get_json.php]

*我正在传递回调函数的名称，该函数将在请求完成时调用。*

```
<script type="text/javascript">
    window.onload = function () {
    var webService = "http://www.telize.com/geoip";
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = webService+"?callback=MyIP";
        document.getElementsByTagName("head")[0].appendChild(script);
    };
    function MyIP(response) {
        document.getElementById("ipaddress").innerHTML = "Your IP Address is " + response.ip;
    }
</script>
<body>
    <form>
        <span id = "ipaddress"></span>
    </form>
</body> 
```

*对于 xml 响应[代码](https://stackoverflow.com/questions/391979/get-client-ip-using-just-javascript/5239085#5239085)*

*不需要服务器支持的[WebRTC 。](https://stackoverflow.com/questions/102605/can-i-lookup-the-ip-address-of-a-hostname-from-javascript/25962226#25962226)*

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2015-05-25T19:59:05.710

它不能单独使用 Javascript 完成（除非客户端具有如上所述的浏览器插件）。客户端上的 Flash 也无法完成。但它可以在客户端上使用 Java 小程序完成（并且 javascript 可以与之对话），尽管它会提示提供完整权限。例如参见[http://www.findmyrouter.net](http://www.findmyrouter.net)

* * *

## 回答 #46

> 赞同：-1
> 
> 时间：2013-11-13T12:10:25.040

```
<script type="application/javascript">
  function getip(json)
  {
     alert(json.ip); 
  } 
```

```
 <script type="application/javascript" src="http://jsonip.appspot.com/?callback=getip"></script> 
```

运行上面的脚本[点击这里](http://jsbin.com/ijiha)

* * *

## 回答 #47

> 赞同：-1
> 
> 时间：2015-02-18T18:22:19.387

好吧，如果在 HTML 中导入脚本...

```
<script type="text/javascript" src="//stier.linuxfaq.org/ip.php"></script> 
```

然后，您可以在页面上的任何位置使用变量 userIP（这将是访问者的 IP 地址）。

重定向：

```
<script>
if (userIP == "555.555.555.55") {window.location.replace("http://192.168.1.3/flex-start/examples/navbar-fixed-top/");}
</script> 
```

或者在页面上显示：`document.write (userIP);`

免责声明：我是我说要导入的脚本的作者。该脚本使用 PHP 提供 IP。该脚本的源代码如下。

```
<?php 
//Gets the IP address
$ip = getenv("REMOTE_ADDR") ; 
Echo "var userIP = '" . $ip . "';"; 
?> 
```

* * *

## 回答 #48

> 赞同：-3
> 
> 时间：2015-09-15T00:03:44.647

您可以使用[telize的 api 服务](http://www.telize.com/)

如果您只需要客户端的公共 ip，请执行以下操作：

```
var ip = "http://www.telize.com/ip";
var response = http.request({url: ip}); 
```

如果你想要更多的细节，比如位置和东西，你可以这样做：

```
var ipAndGeoDetails = "http://www.telize.com/geoip/"
var response = http.request({url: ipAndGeoDetails}); 
```

> **注意**：telize 的公共 API 将于 2015 年 11 月 15 日永久关闭。

# java - Hibernate 如何创建具体类的代理？

> ID：391989
> 
> 赞同：12
> 
> 时间：2008-12-24T18:28:15.480
> 
> 标签：java, hibernate, proxy

据我所知，创建一个动态 Java 代理需要一个接口来为代理工作。然而，Hibernate 似乎无需为实体类编写接口即可管理其动态代理生成。它是如何做到的？来自 Hibernate 文档的唯一线索是，类必须至少有一个包可见的构造函数才能生成代理。

Hibernate 是否使用自定义类加载器进行运行时字节码工程？文档表明情况并非如此。那么他们如何围绕具体实体对象创建代理包装器呢？他们是否只是创建一些琐碎接口的代理而不考虑类型安全，然后根据需要进行转换？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T15:41:10.210

从 Hibernate 3.3 开始，默认的字节码提供程序现在是 Javassist 而不是 CGLib。

[Hibernate 核心迁移指南：3.3](https://community.jboss.org/wiki/HibernateCoreMigrationGuide33)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-01T21:09:08.410

Hibernate 使用 中配置的字节码提供程序`hibernate.properties`，例如：

```
hibernate.bytecode.provider=javassist 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-11T07:27:39.390

有关详细信息，请参阅类[javassist.util.proxy.ProxyFactory](http://www.csg.is.titech.ac.jp/~chiba/javassist/html/javassist/util/proxy/ProxyFactory.html)。

# ms-access - 对于每个在 VBA 代码中无法正常工作

> ID：391991
> 
> 赞同：1
> 
> 时间：2008-12-24T18:29:21.657
> 
> 标签：ms-access, vba

好吧，我几乎完成了我在[此处](https://stackoverflow.com/questions/390567/form-level-event-for-when-data-is-changed-on-a-msaccess-form)讨论的应用程序的审核部分。我这样做的方式是遍历所有文本字段、下拉框和复选框，并将它们的值存储在 form_load 事件中。然后我在 form_afterUpdate 事件中做同样的事情并比较两者。如果有差异，我会记录它，如果没有，我会继续。这是代码：

```
Dim strValues(1 To 32) As String

Private Sub Form_AfterUpdate()
    Dim strCurrentValue, strSQL As String
    Dim intCurrentField As Integer
    intCurrentField = 1

    For Each C In Forms!frmVendorsManageVendors.Controls
        Select Case C.ControlType
            Case acTextBox, acComboBox, acCheckBox
                //Doing this because I don't want a NULL as it won't concatenate in the SQL query and don't want 0 or -1 for the boolean fields
                strCurrentValue = IIf(IsNull(C), "", IIf(C = vbTrue Or C = vbFalse, IIf(C = vbTrue, "Yes", "No"), C))

                If strValues(intCurrentField) <> strCurrentValue Then
                    strSQL = "INSERT INTO changesTable (change_time,user_affected,field_affected,old_value,new_value) VALUES (NOW()," & [id] & ",'" & C.ControlSource & "','" & strValues(intCurrentField) & "','" & strCurrentValue & "')"

                    DoCmd.SetWarnings False
                    DoCmd.RunSQL strSQL
                    //InputBox "", "", strSQL
                    strSQL = "WEEEE"
                    DoCmd.SetWarnings True

                    strValues(intCurrentField) = strCurrentValue
                End If

                intCurrentField = intCurrentField + 1
        End Select
    Next
End Sub

Private Sub Form_Open(Cancel As Integer)
    Call btnLock_Click

    Dim intCurrentField As Integer
    intCurrentField = 1

    For Each C In Forms!frmVendorsManageVendors.Controls
        Select Case C.ControlType
            Case acTextBox, acComboBox, acCheckBox
                //Doing this because I don't want a NULL as it won't concatenate in the SQL query and don't want 0 or -1 for the boolean fields
                strValues(intCurrentField) = IIf(IsNull(C), "", IIf(C = vbTrue Or C = vbFalse, IIf(C = vbTrue, "Yes", "No"), C))
                intCurrentField = intCurrentField + 1
        End Select
    Next
End Sub 
```

正如你所看到的，有一个注释掉的行，我在其中插入到 changesTable 中，它将把查询放在输入框中，这样我就可以复制/粘贴它并查看它。当我取消注释该行时，一切都很好。如果它被评论，它会生成第一个更改，但不会为其他控件更改它。因此，如果我更改 field1 和 field2，它将插入字段 1 更改两次。

这很令人困惑，我不知道为什么会这样。

另外我知道我使用了错误的注释语法，但是如果我使用正确的语法，那么 SO“代码颜色”er 将无法正确显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T19:48:13.647

我不确定我有完整的答案，但有几点意见。

您可以使用 CurrentDB.Execute strSQL 消除一些代码行。这消除了对 SetWarnings 调用的需要。它直接针对数据库执行，而不与通常的接口机制交互。

出于调试目的，最好使用 Debug.Print 将 SQL 字符串放到调试窗口中。它避免了涉及用户界面，如果您想抓取它并使用它，它仍然会将 SQL 放在可以将其复制到剪贴板的位置。

我认为执行 SQL 的 DoCmd 方法调用的可能性很小，即使调用了 SetWarnnigs，也可能会在界面中倾斜某些东西以将焦点从表单上移开，就像 shahkalpesh 建议的那样。我已经做过这样的事情，但没有看到你遇到的问题，所以我对问题本身的唯一建议是像我一样做并切换到 CurrentDB.Execute 并消除循环内对 DoCmd 的调用。

只是好奇——为什么你对以前的值使用数组而不是在控件上使用 OldValue 属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:25:25.737

您是否尝试过使用执行语句（类似这样）？

```
Dim db As DAO.Database    'Inside the transaction.
Set db = CurrentDB
strSQL = "INSERT INTO changesTable (change_time, user_affected, " & _ 
            "field_affected, old_value, new_value) VALUES (NOW()," & [id] & _
            ",'" & C.ControlSource & "','" & strValues(intCurrentField) & _
            "','" & strCurrentValue & "')"
db.Execute strSql 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T20:41:00.750

我猜 AfterUpdate 可能不是正确使用的事件。

此外，放置输入框可能会导致现有控件失去焦点（这使其行为正确）。

我建议通过在选择案例之后将 msgbox C.name 放入循环中来检查您的每个控件是否被运行。``*********