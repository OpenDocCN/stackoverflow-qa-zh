# StackOverflow 问答 000910000-000910999

# php - 从 PHP/CakePHP 访问 REMOTE_USER

> ID：910000
> 
> 赞同：1
> 
> 时间：2009-05-26T10:28:43.213
> 
> 标签：php, authentication, cakephp

我正在开发一个 CakePHP 站点，我刚刚使用 .htaccess 文件为其启用了 VAS 身份验证：

```
AuthType VAS

AuthVasUseBasic On
AuthVasRemoteUserMap local

Require valid-user 
```

我希望能够使用 找出谁登录了`$_SERVER['REMOTE_USER']`，但我发现`$_SERVER`结构中缺少密钥：所有这些都是`$_SERVER['REDIRECT_REMOTE_USER']`. 事实上，整个结构充满了带有`REDIRECT_`前缀的键：

```
echo var_dump($_SERVER);
array(52) {
["REDIRECT_REDIRECT_REDIRECT_SCRIPT_URL"]=>  string(37) "/cake_1_2/feedbacks/edit/6" 
["REDIRECT_REDIRECT_REDIRECT_SCRIPT_URI"]=>  string(55) "http://test/cake_1_2/feedbacks/edit/6"
["REDIRECT_REDIRECT_REDIRECT_STATUS"]=>  string(3) "200" 
["REDIRECT_REDIRECT_SCRIPT_URL"]=>  string(37) "/cake_1_2/feedbacks/edit/6" 
["REDIRECT_REDIRECT_SCRIPT_URI"]=>  string(55) "http://test/cake_1_2/feedbacks/edit/6" 
["REDIRECT_REDIRECT_STATUS"]=>  string(3) "200" 
["REDIRECT_SCRIPT_URL"]=>  string(37) "/cake_1_2/feedbacks/edit/6" 
["REDIRECT_SCRIPT_URI"]=>  string(55) "http://test/cake_1_2/feedbacks/edit/6" 
["REDIRECT_HANDLER"]=>  string(8) "php5-cgi"
["REDIRECT_STATUS"]=>  string(3) "200" 
["SCRIPT_URL"]=>  string(37) ...
["REDIRECT_REMOTE_USER"]=>  string(9) "andygeers"
... 
} 
```

我不完全确定发生了什么！这是在 POST 请求中生成的第一件事，它不会对这个特定的请求进行重定向。

这与 CakePHP 有关，还是只是一般的 PHP 问题？有什么想法吗？我现在在互联网上找到了很多页面，这些页面表明 REDIRECT_REMOTE_USER 是正常/常见的查找此值的地方，但似乎没有人知道为什么！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:06:55.180

Apache 正在添加这些 REDIRECT_ 前缀，以便脚本可以更好地处理发生的事情。对于我的应用程序，我编写了一个函数来处理这个问题。在我的例子中，它是一个类的方法，但是你可以很容易地将它变成一个全局函数。

```
class MyClass {
    /** @var integer How deep the redirect layers of Apache go. -1 means not set. */
    private $redirectLevel = -1;

    /**
     * Get an environment variable with all the REDIRECT_ prefixes stripped off
     */
    private function getEnv($var)
    {
        // Find out how deep the redirect goes
        if ($this->redirectLevel == -1) {
            reset($_SERVER);
            $key = key($_SERVER);
            $this->redirectLevel = substr_count($key, 'REDIRECT_');
        }

        $result = '';
        $prefix = '';
        for ($i = 0; $i < $this->redirectLevel + 1; $i++) {
            if (isset($_SERVER[$prefix . $var])) {
                $result = $_SERVER[$prefix . $var];
            }
            $prefix .= 'REDIRECT_';
        }
        return $result;
    }
} 
```

**编辑：**上面的函数返回具有最多 REDIRECT_ 前缀的变量的内容，这通常是你想要的。如果 Apache 不会为变量添加前缀，那么这就是您所得到的。变量的内容可以根据前缀的数量而改变。毕竟，Apache 添加了前缀，因此它不会覆盖旧值。

例如，在我的站点上，我使用 mod_ssl 通过客户端 SSL 证书进行客户端身份验证。证书主题（包含用户的电子邮件地址）存储在 SSL_CLIENT_S_DN 变量中。使用 Apache 前缀，这将显示为：

```
$_SERVER['REDIRECT_REDIRECT_SSL_CLIENT_S_DN'] // string containing the subject
$_SERVER['REDIRECT_SSL_CLIENT_S_DN'] // exists, but empty
// $_SERVER['SSL_CLIENT_S_DN'] does not exist 
```

我上面写的 getEnv() 函数将返回顶部的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T11:39:19.437

这是一般的 PHP 事情。一些框架根据其路由策略在内部重定向页面。如果您在框架之外重定向，您将获得相同的结果。

直接访问框架之外的页面将为您提供您最初期望的名称。我确实注意到在 CodeIgniter 中你得到`$_SERVER['REMOTE_USER']`并且没有重定向。所以这取决于你使用的框架。

因此，如果您不确定是否发生重定向，最好同时检查两者。

我还注意到您正在使用`AuthVasUseBasic On`. 如果您使用它，您还应该检查基本用户身份验证变量`$_SERVER['USERNAME']`IIRC

# java - 在 Box 布局中固定摆动组件的高度

> ID：910003
> 
> 赞同：0
> 
> 时间：2009-05-26T10:29:08.423
> 
> 标签：java, swing, fixed

早上好，

感谢 javax.swing.Box 类，我正在制作一个 GUI

面板内部： 具有**固定高度**
的 JLabel JTable 具有**自动高度**的 JLabel JTable

 ****我尝试了一切来修复第一个 JTable 高度，但没有任何成功。
我为上述行的每个组件专用一个 Box.createHorizo​​ntalBox()，然后将它们添加到 Box.createVerticalBox()。
我没有得到第一个结果，而是得到了一个 JTable 都有自动高度的布局，我更喜欢第一个 JTable 有一个固定的高度......

感谢您的任何回答，

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:20:32.967

我找到了一个解决方案，我不应该用这样一个愚蠢的问题来惹恼你：
对于我创建的每个水平框，我添加了一个 10 像素的水平支柱来显示一种填充。那些支柱是行中的第一个，它被自动作为盒子布局建筑的*“高度参考”*，但我是 awt/swing 布局的新手，所以我可能会误会这样说。

我移除了这些支柱并插入了一个垂直框，其中包含一个 10 像素的水平支柱。它完成了这项工作。

无论如何，感谢您的时间 Markus 和 Michael，当我的老板让我有时间这样做时，我将深入研究 sun 的教程

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T10:38:43.723

例如，您可以通过调用更改为行高

```
TableColumn column = table.getColumnModel().getColumn(0);
    column.setPreferredWidth(150);
    //set all rows height 
    table.setRowHeight(20);
    //set specific row height
    table.setRowHeight(2,50); 
```

您可以通过调用更新的表大小

```
setPreferredSize(Dimension preferredSize) 
```

您还必须决定面板应该具有哪种布局。你设置布局了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T10:41:07.433

向我们展示实际代码怎么样？

听起来您没有正确使用布局管理器。您可能应该在其 CENTER 位置使用带有“自动”表的 BorderLayout，其余的在 NORTH 位置的第二个面板内，第二个面板使用 Boxlayout 或 FlowLayout。

Sun 有一个关于使用布局管理器的非常好的[教程，可能会对您有很大帮助。](http://java.sun.com/docs/books/tutorial/uiswing/layout/index.html)

# c# - 检索系统驱动器的最安全方法是什么

> ID：910004
> 
> 赞同：14
> 
> 时间：2009-05-26T10:29:13.387
> 
> 标签：c#, .net, windows, environment-variables, system-administration

我知道以下应该有效：

```
Environment.GetEnvironmentVariable("windir", EnvironmentVariableTarget.Machine) 
```

我对这个电话的问题是，如果由于某种原因有人决定删除“windir” Env Var ，这将不起作用。

有没有更安全的方法来获取系统驱动器？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-26T10:37:56.097

```
string windir = Environment.SystemDirectory; // C:\windows\system32
string windrive = Path.GetPathRoot(Environment.SystemDirectory); // C:\ 
```

注意：此属性在内部使用 GetSystemDirectory() Win32 API。它不依赖于环境变量。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T10:36:20.237

这个返回系统目录（system32）的路径。

```
Environment.GetFolderPath(Environment.SpecialFolder.System) 
```

您也许可以使用它，那么您不需要依赖环境变量。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T11:20:24.937

我实际上可能误解的一件事是您想要系统驱动器，但是通过使用“windir”，您将获得 windows 文件夹。因此，如果您需要一种*安全的方式*来获取 windows 文件夹，您应该使用良好的旧 API 函数 GetWindowsDirectory。

这是为 C# 使用准备的函数。;-)

```
 [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern uint GetWindowsDirectory(StringBuilder lpBuffer, uint uSize);

    private string WindowsDirectory()
    {
        uint size = 0;
        size = GetWindowsDirectory(null, size);

        StringBuilder sb = new StringBuilder((int)size);
        GetWindowsDirectory(sb, size);

        return sb.ToString();
    } 
```

因此，如果您真的需要运行 Windows 的驱动器，您可以稍后调用

```
System.IO.Path.GetPathRoot(WindowsDirectory()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T10:36:22.870

您可以使用[GetWindowsDirectory](http://msdn.microsoft.com/en-us/library/ms724454(VS.85,loband).aspx) API 来检索 windows 目录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T15:38:56.833

永远不要读取环境变量（任何脚本或用户都可以更改它们！）
官方**方法**（MS 内部，由 Explorer 使用）是几十年来的 Win32 api 常见问题解答（参见 Google 组、Win32、系统 api）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T10:34:39.163

有一个环境变量叫做`SystemDrive`

```
C:\>SET SystemDrive
SystemDrive=C: 
```

# installation - 如何检测我是否在 InnoSetup 脚本中的终端服务器上安装？

> ID：910005
> 
> 赞同：3
> 
> 时间：2009-05-26T10:29:16.817
> 
> 标签：installation, inno-setup, terminal-services

当程序安装在终端服务器上时，我的设置应该会略有不同。我知道，`GetSystemMetrics(SM_REMOTESESSION)`但据我所知，这只会告诉我我是否在 RDP 会话中运行。它不会捕获服务器管理员在本地登录以安装软件的情况，还是会这样？

检查终端服务器服务似乎也不可行，因为启用远程桌面后，它也在工作站上运行。我需要将此与允许多个并发登录会话的真正 TS 区分开来。

我没有检查任何其他服务或注册表项吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T10:54:22.040

这正是您需要的：

[检测终端服务是否安装](http://msdn.microsoft.com/en-us/library/cc644951(VS.85).aspx)

请注意，除此之外，您还可以使用**GetVersion()**的值来确定您是否正在运行 NT。如果不是新台币，那么保释。

```
// Are we running Windows NT?
DWORD dwVersion = GetVersion();
if (!(dwVersion & 0x80000000)) {
    // Is it Windows 2000 or greater?
    if (LOBYTE(LOWORD(dwVersion)) > 4) {
        // Check with VerSetConditionMask() and VerifyVersionInfo()
        return ..;
    }
    else  {
        // Windows NT 4.0 or earlier. Check ProductSuite value in
        // HKLM\\System\\CurrentControlSet\\Control\\ProductOptions
        return ..;
    }
}

return false; 
```

链接显示版本是Win2k或更高版本需要查询的代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T12:49:18.250

感谢 Magnus Skog 提供的链接，我发现 InnoSetup 已经支持`GetWindowsVersionEx`API 功能。因此，我所要做的就是：

```
function IsRunningOnTS: Boolean;
var
  lWinVer: TWindowsVersion;
begin
  GetWindowsVersionEx(lWinVer);
  Result := (lWinVer.SuiteMask and VER_SUITE_TERMINAL) <> 0;
end; 
```

我已经成功测试了以下场景：

*   本地登录到启用 RDP 的 XP 工作站（返回`False`）
*   通过 RDP 远程登录到终端服务器（返回`True`）
*   通过 RDP 远程登录到工作站（返回`False`）

在 TS 上本地登录时，我还没有机会进行测试。当我有时会更新这篇文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T11:01:46.703

我猜这个问题有很多答案的可能性，所有这些都看起来有点不令人满意。

例如，可能的场景有哪些：

*   启用 RDP 的工作站（即启用远程帮助的 XP）
*   服务器，启用了 RDP（通过检查操作系统类型很容易与工作站区分开来）

但是，启用了 RDP 选项但未使用的服务器呢？如果服务器启用了 RDP 选项，但管理员正在控制台上安装您的软件，而一天中没有人通过 RDP 登录，情况如何？您将无法确定服务器是否实际在使用中，RDP 明智的，或者没有。

给你一个具体答案的最好方法是问你为什么需要确定这个？如果您能够可靠地检测到这一点，您将启用或禁用哪种功能？

# security - 是否可以在 ASP.NET 中使用 2 个成员资格提供程序？

> ID：910006
> 
> 赞同：0
> 
> 时间：2009-05-26T10:29:29.267
> 
> 标签：security, login, active-directory, membership

我有一个网站，需要使用来自用户数据库（SQL Server、Oracle 等）和 NT 用户数据库（计算机或域）的用户群来对站点进行安全/身份验证。

1.  用户登录网站并输入他/她的用户名和密码。
2.  如果用户存在，该站点会查找用户数据库（SQL Server、Oracle 等）。
3.  如果不存在，则站点查找域（Active Directory）（如果用户存在）。

是否可以同时使用 SqlMembershipProvider**和**ActiveDirectoryMembershipProvider ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:32:26.967

是的，有可能。

只需将两个 MembershipProviders 添加到您的 Web.config 并指定 defaultMembershipProvider afaicr

# sql-server - 如何最小化 SQL 复制中的数据

> ID：910008
> 
> 赞同：4
> 
> 时间：2009-05-26T10:29:45.443
> 
> 标签：sql-server, performance, replication

我想将数据从海上船只复制到陆上站点。连接有时是通过卫星链路进行的，速度可能很慢，并且延迟很高。

在我们的应用程序中延迟很重要，岸上的人应该尽快获得数据。

有一个表被复制，由一个 id、日期时间和一些长度可能不同的二进制数据组成，通常小于 50 字节。

离岸应用程序不断将数据（硬件测量）推送到表中，我们希望这些数据尽快上岸。

**MS SQL Server 2008 中是否有任何技巧可以帮助减少带宽使用并减少延迟？初始测试使用 100 kB/s 的带宽。**

我们的替代方案是推出我们自己的数据传输，这里的初始原型设计使用 10 kB/s 的带宽（同时在相同的时间跨度内传输相同的数据）。这没有任何可靠性和完整性检查，因此这个数字被人为地降低了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T16:42:37.797

您可以尝试不同的复制配置文件或创建自己的复制配置文件。不同的配置文件针对不同的网络/带宽场景进行了优化。

[MSDN在这里](http://msdn.microsoft.com/en-us/library/ms152515.aspx)谈论复制配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T04:28:19.380

您是否考虑过购买 WAN 加速器设备？我在这里太新了，无法发布链接，但是有几个可用的。

本质上，发送端的设备压缩传出数据，接收端对其进行解压缩，所有这些都在运行中且完全不可见。这样做的好处是可以提高流量的明显速度，并且不需要您更改服务器配置。它应该是完全透明的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T11:34:53.097

我建议在 SQL Server 之外进行动态压缩/解压缩。也就是说，SQL 正常复制数据，但网络堆栈中的某些内容会压缩，因此它更小且带宽效率更高。

我什么都不知道，但我确信这些存在。

不要直接弄乱 SQL 文件。如果不是不可能的话，那就太疯狂了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T16:53:36.167

您是否希望它始终只有一个被复制的表？有很多更新，还是只是插入？复制是通过在目标上为每个更改的行调用插入/更新存储过程来实现的。一种廉价的优化是强制 sproc 名称变小。默认情况下，它由表名组成，但 IIRC 您可以为文章强制使用不同的存储过程名称。假设每行插入大约 58 个字节，在 sproc 名称中保存 5 或 10 个字符非常重要。

我猜想如果你更新二进制字段，它通常是一个完整的替换？如果这是不正确的并且您可能会更改一小部分，您可以推出自己的差异修补机制。可能是第二个表，其中包含对原始字节的时间序列变化。听起来很痛苦，但可以根据您的工作量节省大量带宽更改。

插入通常是按逻辑批次完成的吗？如果是这样，您可以将一批插入作为一个自定义 blob 存储在复制表中，并有一个辅助过程将它们解压缩到您要使用的最终表中。这将减少流经复制的这些小行的开销。

# language-design - 什么是“成熟”软件？

> ID：910009
> 
> 赞同：3
> 
> 时间：2009-05-26T10:29:56.300
> 
> 标签：language-design, platform, maturity

Jeffery Palermo 说“经典 WebForms 比 ASP.NET MVC 更*成熟*”：[“经典 WebForms 比 ASP.NET MVC 更成熟吗？”](http://jeffreypalermo.com/blog/is-classic-webforms-more-mature-than-asp.net-mvc/) .

这似乎是主观的，但我想知道的是，究竟什么是“成熟”的软件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T10:43:54.680

答案非常主观。但基本上，如果软件可以满足这些标准中的大多数（按重要性不分先后）：

*   安全的
*   可靠的
*   积极维护
*   有活跃的社区
*   经现场验证

那么它可以被认为是“成熟的”。

需要注意的是，不同的客户会期望不同的“成熟度”水平。一家大公司会要求其使用的软件足够安全以保护其敏感数据，并且该软件由 24/7 全天候可用的支持代表支持。与您自己的小型私人项目相反，您可能不太关心安全性，并且您不需要（也负担不起）包括 24/7 客户支持的服务包。

因此，成熟度根据客户而有所不同，但基本标准保持不变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T10:35:40.797

成熟是人们已经弄清楚如何处理它的时候。（我们谈论的是开发平台而不是最终用户应用程序，不是吗？）

例如，javascript只是随着prototype、jquery等的引入才变得成熟。

在此之前，人们倾向于编写他们会后悔的奇怪事物。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T10:42:44.670

因此，您是在询问对主观主题的主观意见。:)

我想说，成熟会为技术添加以下特征：

1.  人们知道如何使用它，知道它的可能性和局限性

2.  人们知道典型的使用场景是什么，模式，什么是该技术的良好使用场景，以便它显示出最好的效果

3.  人们已经发现了如何处理限制/错误，那里有社区知识和帮助

4.  该技术值得信赖，不仅可以供个人使用，也可以在生产性商业环境中使用

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T11:41:19.497

***通过为自己开发测量工具来减少主观性。***

我的标准适用于商业软件：

1.  功能丰富 - 处理大量业务规则
2.  灵活 - 通过参数和配置可选择功能
3.  稳定 - 很少，如果有任何错误导致故障，如崩溃
4.  有据可查 - 用户和技术文档
5.  用户友好 - 经用户证明和推荐
6.  稳健 - 不会因为电源故障和错误的用户输入等事件而烦恼。
7.  安装和运行“开箱即用”。

获取所有标准并将其放入电子表格中，列评分从 0 到 5，并通过勾选与您对每个标准的评分相对应的列进行评分。

*   如果总分为 25 分或更高，则该软件已成熟。
*   如果分数是 15 到 24，那么软件是平均的。
*   如果低于 15 则软件不成熟。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T10:36:51.933

成熟的软件必须是你想要的任何东西。我认为您不会找到一种简单的衡量成熟度的机制，而且每个人的定义都会有所不同。恐怕这总是一种主观观点，因此会受到很多争论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T10:44:59.063

我想说成熟的软件是稳定的、有据可查的、广泛使用的和经过良好测试的。

# .net - 数据网格视图中的自动大小行

> ID：910016
> 
> 赞同：1
> 
> 时间：2009-05-26T10:32:34.580
> 
> 标签：.net, datagridview

海先生，当文本（字符）应该在同一行中换行时，如何自动增加datagridview中行的高度。然后行高应该自动增加。例如

```
---------- this is column width
column1

----------
abcdefghijklmn
---------- 
```

这里“klmn”是下一行。但是我们手动增加将显示的行高。但我想自动增加行高。我在做什么先生

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-03T18:57:32.323

有一个属性`AutoSizeRowsMode`。将其设置为`AllCells`或`DisplayedCells`。`AllCells`如果 datagridview 有非常多的行，将需要时间。`DisplayedCells`将仅调整显示单元格的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-08T16:53:58.127

```
dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T11:33:32.040

高度还是宽度？- 在这种情况下，正常情况是溢出：隐藏；和...或在工具提示中显示完整的字符串，或者，当用户将鼠标悬停在字符串上时，它将开始运行（水平滚动）字符串以完全可读。

这是你要找的吗？

# language-agnostic - 强制显式 this/self 指针有什么好处？

> ID：910020
> 
> 赞同：21
> 
> 时间：2009-05-26T10:33:37.370
> 
> 标签：language-agnostic, oop, programming-languages, language-theory

[`this`//`self``me`](http://en.wikipedia.org/wiki/This_(computer_science))**强制**显式指针有什么好处[？](http://en.wikipedia.org/wiki/This_(computer_science))

根据[OOP](http://en.wikipedia.org/wiki/Object-oriented_programming)理论，方法应该主要（仅？）对成员变量和方法的参数进行操作。在此之后，引用成员变量应该比引用外部（从对象的角度）变量更容易......显式**使其**`this`更冗长，因此引用成员变量比引用外部变量**更难。**这对我来说似乎违反直觉。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-26T10:53:26.237

除了成员变量和方法参数之外，您还有局部变量。关于对象最重要的事情之一是它的内部状态。显式成员变量取消引用使您在哪里引用该状态以及您在哪里修改该状态非常清楚。

例如，如果您有如下代码：

```
someMethod(some, parameters) {
    ... a segment of code
    foo = 42;
    ... another segment of code
} 
```

当快速浏览它时，您必须对前一段中定义的变量有一个心智模型，以了解它是否只是一个临时变量或它是否会改变对象状态。而 this.foo = 42 则很明显对象状态已发生变化。如果专门使用显式取消引用，则可以确保该变量在相反情况下是临时的。

更短的、经过充分考虑的方法使其不那么重要，但在编写代码时，长期的可理解性仍然胜过一点便利。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T10:44:08.270

如果您在谈论`self`Python 意义上的“显式”，这里有一个关于该主题的[有趣讨论](http://effbot.org/pyfaq/why-must-self-be-used-explicitly-in-method-definitions-and-calls.htm)。这是[Guido 对](http://www.artima.com/weblogs/viewpost.jsp?thread=214325)Bruce [Eckel 文章](http://www.artima.com/forums/flat.jsp?forum=106&thread=214112)的回应。对布鲁斯文章的评论也很有启发性（其中一些，无论如何）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T10:35:40.207

如果方法的参数与成员变量同名怎么办？然后你可以使用`this.x = x`例如。where`this.x`是成员变量，`x`是方法参数。这只是一个（微不足道的）例子。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T10:36:52.183

您需要它将指针/引用传递给其他地方的当前对象或防止赋值运算符中的自赋值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T10:37:05.490

我通常仅在编写**赋值运算符**或**复制构造函数**时才使用它（在 C++ 中），因为它有助于清楚地识别变量。我可以考虑使用它的其他地方是，如果您的函数参数变量名称与您的成员变量名称相同，或者我想使用**delete this**杀死我的对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T10:38:16.923

例如，成员名称与传递给方法的名称相同

```
public void SetScreenTemplate(long screenTemplateID, string screenTemplateName, bool isDefault)
        {
            this.screenTemplateID = screenTemplateID;
            this.screenTemplateName = screenTemplateName;
            this.isDefault = isDefault;
        } 
```

# javascript - 从 javascript 调用 WebService

> ID：910021
> 
> 赞同：1
> 
> 时间：2009-05-26T10:33:45.420
> 
> 标签：javascript, web-services, firefox-addon

我正在开发一个需要与外部 WebService 交互的 Firefox 插件
WebSerivce 是使用 ASP.NET（.asmx 页面）构建的

我不能使用 ajax，因为它是一个插件而不是一个网站。
有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:42:41.063

如果您想手动完成所有操作，则需要使用[XMLHttp Object](http://www.w3.org/TR/XMLHttpRequest/)。然而，这可能会变得非常痛苦，这就是为什么有很多 Javascript 库的原因，以使获取和发送数据的任务变得不那么痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T10:57:57.477

查看此链接：它清楚地提到 XMLHttpRequest 可以从 Mozilla 扩展中使用。[https://developer.mozilla.org/En/Using_XMLHttpRequest#Downloading_JSON.c2.a0and_JavaScript_from_extensions](https://developer.mozilla.org/En/Using_XMLHttpRequest#Downloading_JSON.c2.a0and_JavaScript_from_extensions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T11:19:04.703

您将需要考虑从您的附加组件向服务发起调用的跨域问题。

XMLHttpRequest 对象是 AJAX 的基本构建块之一。我不确定您的附加组件的隔离，但您无法使用它似乎很奇怪。

创建 Web 服务的语言并不重要，您只需要知道它需要哪种[Web 服务协议](http://en.wikipedia.org/wiki/List_of_web_service_protocols)。就像当您访问一个网站时，您可以不知道是 php、asp 还是 jsp 生成 HTML，您只需要知道如何处理 HTML。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T10:56:12.473

签出[从 JavaScript 调用 ASP.NET Web 服务](http://www.dotnetspider.com/resources/4933-Call-an-ASP-NET-web-service-from-JavaScript.aspx)

# ruby-on-rails - rails flash 图形/图表插件

> ID：910022
> 
> 赞同：9
> 
> 时间：2009-05-26T10:33:51.050
> 
> 标签：ruby-on-rails, graph, ruby-on-rails-plugins

我正在寻找一个 rails flash 图表/图表插件，用于绘制条形图、堆积条形图、饼图、堆积面积图和折线图

支持以下标准，
1\. 可定制的工具提示。例如：当我绘制堆积面积图时，我想将该 x 轴点的所有 y 轴值显示为工具提示。
2.图表应该支持点击事件
3.图表应该能够通过内联附件作为图像发送。
4.柱形图，应该可以在柱状图上方显示数值。
5.应该可以关闭动画
6.我们可以画两个y轴

非常感谢任何帮助。

提前致谢。
尼西”

编辑：如果其服务器的目的，我愿意购买商业许可证。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T15:05:47.087

我不知道哪些将具有您想要的所有功能，但我前一段时间正在玩图表，这是一些可能性的列表：

1.  Ziya( [http://ziya.liquidrail.com/](http://ziya.liquidrail.com/) ) - Rails 插件
2.  AmCharts ( [http://www.amcharts.com/](http://www.amcharts.com/) ) - 由于灵活性，我最终使用的那个 - 没有 rails 插件，但使用 rails XML 支持部署非常简单（我猜它确实导出图像并且具有所有您想要的功能虽然可能需要一些时间来理解和充分利用它）
3.  Fusion Charts ( [http://www.fusioncharts.com/](http://www.fusioncharts.com/) ) - 如果你愿意在上面投资一些钱，这似乎是一个不错的选择
4.  Gruff ( [http://nubyonrails.com/pages/gruff](http://nubyonrails.com/pages/gruff) ) - 也是 rails 插件 - 我不记得为什么我决定反对它，但我认为这是因为缺乏动画
5.  OpenFlash ( [http://openflashchart.com/](http://openflashchart.com/) ) - 我喜欢这个虽然我只是用作概念证明

我也尝试过完全是 javascript 的 Timeplot ( [http://www.simile-widgets.org/timeplot/](http://www.simile-widgets.org/timeplot/) )，因为我的图表所需的点数有问题，而基于 Flash 的解决方案有几个对此的限制。虽然我因为部署时间限制而放弃了它。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-24T12:46:36.937

查看 Highcharts [http://www.highcharts.com/](http://www.highcharts.com/)

干杯，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:55:11.950

我还大量使用 AmCharts 和[Ambling](http://github.com/ahobson/ambling/tree/master) Rails 插件。

如果您采用这种方式，请知道您将在 AmCharts 参考文档中花费时间来微调图表的参数。但值得考虑它给出的结果。

# xcode - Xcode 在输入时滚动文本

> ID：910026
> 
> 赞同：6
> 
> 时间：2009-05-26T10:34:49.270
> 
> 标签：xcode, editor

Xcode 今天似乎在做一些烦人的事情。

我喜欢编辑我的源代码，以便大致在 Xcode 窗口的垂直中心输入。我不喜欢在窗口底部或顶部附近打字，因为它会在我正忙于编辑的代码之前或之后隐藏代码。

最近，在编辑实现文件时，Xcode 有滚动文本的习惯，因此我在靠近窗口底部进行编辑。每次发生任何代码完成时都会触发此滚动。

有没有人见过这个？如果是这样，我该如何关闭它或者它只是一个错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T04:15:27.040

您可能会遇到一个错误，即在同一文件上打开第二个窗口时，一个文本视图会意外滚动。如果发生这种情况，请确保该文件未在任何其他窗口中打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-20T20:16:21.000

我在 Xcode 5 及更早版本中也注意到了这一点。看来 Apple 已在 Xcode 6 中解决了这个问题。我正在运行 Xcode 6.4 并且不再看到这个问题。

# iphone - 如何识别电话后应用程序是否重新加载？

> ID：910028
> 
> 赞同：3
> 
> 时间：2009-05-26T10:35:10.533
> 
> 标签：iphone, cocoa-touch, phone-call

我有一个程序可以在程序启动时自动拨打电话。这是在 AppDelegate 的“applicationDidFinishLaunching”方法中实现的。

问题是：当电话结束并且我的应用程序再次自动启动时，它会重新启动该循环并再次开始电话。

如何识别应用程序是否从该调用返回？或者以某种方式轻松保存定义调用是否已经进行的程序的状态或变量？

我刚开始 iPhone 编程，结果就出现了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T19:49:43.973

这是无法做到的。在您意识到并非所有呼叫终止都会将您返回到应用程序之前，标志的想法很好。例如，如果您按下顶部电源按钮挂断电话。

对于这些情况，标志将不一致（即，在下次启动时，您的应用程序会认为这是从呼叫返回，而实际上它是从主屏幕启动的）。

所以总而言之，没有办法检测到手机的所有返回，我已经询问了 Apple 开发支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T10:48:30.773

在让您的应用程序启动电话呼叫之前，请在[应用程序](https://stackoverflow.com/questions/789404/iphone-how-to-save-user-settings-from-application/789661#789661)[数据库](https://stackoverflow.com/questions/789404/iphone-how-to-save-user-settings-from-application/789661#789661)`BOOL`中读取一个标志，询问它是否应该启动该呼叫，例如.[`NSUserDefaults`](https://stackoverflow.com/questions/789404/iphone-how-to-save-user-settings-from-application/789661#789661)`callWasMade`

如果`callWasMade`设置为初始默认值`NO`，则将标志设置为`YES`，将标志的值保存为`NSUserDefaults`，然后触发电话呼叫。

在您的应用程序随后启动时，会读取`callWasMade`( ) 的值，并且不会触发调用。`YES``NSUserDefaults`

此时，将标志的值翻转回`NO`以允许下一次调用应该是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-26T08:32:18.227

您可以使用 UIWebview 拨打此问题中解释的电话：

[在本机代码中与 UIWebView 不同的电话后返回应用程序行为](https://stackoverflow.com/questions/5317783/return-to-app-behavior-after-phone-call-different-in-native-code-than-uiwebview)

并使用核心电话检查通话是否结束：

```
//before calling loadRequest:
CTCallCenter *callCenter.callEventHandler=^(CTCall* call) {

        if(call.callState == CTCallStateDialing)
        {
            //The call state, before connection is established, when the user initiates the call.
            NSLog(@"Dialing");
        }
        if(call.callState == CTCallStateIncoming)
        {
            //The call state, before connection is established, when a call is incoming but not yet answered by the user.
            NSLog(@"Incoming Call");
        }

        if(call.callState == CTCallStateConnected)
        {
            //The call state when the call is fully established for all parties involved.
            NSLog(@"Call Connected");
        }   

        if(call.callState == CTCallStateDisconnected)
        {
            [self release];
            NSLog(@"Call Ended");

        }

    }; 
```

# java - db4o 如何实例化对象？

> ID：910037
> 
> 赞同：5
> 
> 时间：2009-05-26T10:36:57.427
> 
> 标签：java, reflection, db4o

db4o 使用什么机制来实例化存储对象？

我的类不是可序列化的，并且不提供零参数构造函数，并且唯一的构造函数在其参数为空时抛出 NullPointerException。

尽管如此，db4o 仍然可以实例化该类的存储对象（尽管值不正确）。

如果我能理解这个机制，也许我可以追踪我的错误。

我将不胜感激任何链接：]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:49:35.497

它使用 sun（或您的其他 jvm）的特殊 api 来实例化对象，而无需检查访问和运行构造函数。

您遇到的错误很可能是由于没有运行构造函数，包括在字段上设置默认值的隐式构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T10:52:43.103

Db4o 是开源的，因此您可以查看源代码。基本思想是使用[类型处理程序](http://developer.db4o.com/Resources/view.aspx/Reference/Implementation_Strategies/TypeHandlers)来实现对象的序列化和反序列化。对于需要自定义类型处理程序的高级用户，有一个[简单的示例](http://developer.db4o.com/Resources/view.aspx/Reference/Implementation_Strategies/Typehandlers/Custom_Typehandler_Example)提供程序。[如果不存在合适的构造函数，对象构造](http://developer.db4o.com/Resources/view.aspx/Reference/Object_Lifecycle/Object_Construction/Creating_Objects)可以使用构造函数或绕过构造函数。可以通过使用指示 db4o 无论如何调用构造函数的配置设置来防止提到的构造函数错误。

您可能希望在 db4o[论坛](http://developer.db4o.com/forums/default.aspx)上发布这个问题，以便从开发人员那里获得更详细的解释。

戈兰

# c# - 动态数据实体 ID 列可见是否为假？

> ID：910055
> 
> 赞同：0
> 
> 时间：2009-05-26T10:43:17.773
> 
> 标签：c#, .net, asp.net, dynamic-data

asp.net 3.5中有两种模板

1) 动态数据 Web 应用程序。

2) 动态数据 Web 应用程序。实体

我的 SQL 数据库有 Customer Table ；列：ID、姓名、姓氏与姓名

如果您使用第一个（动态数据 Web 应用程序）；你看不到 ID 列（客户表）（Linq to Sql）

但是如果你使用第二个（Dynamic Data Web App.Entities），你可以看到 ID 列

我如何过滤列，尤其是 ID 区域。我是说; 我需要 ID 列可见 =false

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T10:47:58.403

在您的元数据类中，将 Id 设置为以下内容：

```
[ScaffoldColumn(false)]
public object Id { get; set; } 
```

如果您没有对元数据类的引用，您可以通过将属性添加到部分类来添加它，如下所示：

```
[MetadataType(typeof(MyEntityFromTable_MD))]
public partial class MyEntityFromTable
{

} 
```

然后你需要元数据类本身。就像是：

```
public class MyEntityFromTable_MD
{
        [ScaffoldColumn(false)]
        public object Id;
} 
```

# asp.net - 即使在 DataBind() 之后，GridView 也没有列

> ID：910058
> 
> 赞同：2
> 
> 时间：2009-05-26T10:44:37.597
> 
> 标签：asp.net, gridview

我有一个已经填充了数据的 DataView（验证这是真的）。

然后我将 GridView 的 DataSource 设置为该 DataView 并调用 .DataBind() 函数。

绑定后，我检查了我的 GridView (grid.Columns.Count) 的列数，它显示为 0。但它显示了 15 列的正确输出。

此外，使用其索引访问列将引发异常。

那我该如何访问该列？

谢谢！

编辑——附加信息：

我实际上需要在列标题中添加一个“字形”（向上/向下箭头）以显示正在排序的列及其方向。下面的代码是我正在使用的。问题是，Columns.Count 始终为零。

```
 for (int i = 0; i < dgData.Columns.Count; i++)
    {
        string colExpr = dgData.Columns[i].SortExpression;
        if (colExpr != "" && colExpr == dgData.SortExpression)
            item.Cells[i].Controls.Add(glyph);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:49:39.943

**编辑**

试试这个，它有点笨拙，因为它依赖于针对 GridView SortExpression 测试链接按钮文本。Gridview ID 为“测试”

```
 protected void test_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.Header)
        {
            foreach (TableCell tc in e.Row.Cells)
            {
                if(test.SortExpression.Contains( (tc.Controls[0] as LinkButton).Text ))
                    tc.Controls.Add( glyph )
            }
        }
    } 
```

如果您自动生成列，我认为没有设置列集合......

您可以检查`Row.Cells.Count`或是否需要列名，获取 HeaderRow，然后遍历单元格并获取它们的 .Text 值。

如果 GridView 是可排序的（例如，标题中有可点击的链接，那么要获取您需要检查的列名

```
foreach(Row r in GridView.Rows)
{
    if(r.RowType == HeaderRow)
    {
         r.Cells[0].Controls[0]; //Link Control is here.
    }
} 
```

# objective-c - 在不同的时区将 NSString 隐藏到 NSDate

> ID：910060
> 
> 赞同：2
> 
> 时间：2009-05-26T10:45:10.403
> 
> 标签：objective-c, iphone, nsstring, nsdateformatter

我正在尝试将字符串转换为与当前系统时区不同的时区中的日期。我已将 dateformatter 的时区设置为此时区。但是我得到的 NSDate 总是在我当前的时区。

例如，我当前的时区是 PDT。我已将 DateFormatter 的时区设置为 CST。我有一个带有 CST 时间的字符串。但是当我使用日期格式化程序将此字符串转换为日期时，我会在 PDT 中获得日期，而我想要在 CST 中。

有人可以帮忙吗。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T11:09:03.883

`NSDate`仅存储自 2001 年 1 月 1 日 00:00:00 以来的秒数。 NSDate 的描述将使用您当前的时区（例如，如果尝试使用 NSLog 进行调试）。

您必须获得默认时区

```
[NSTimeZone defaultTimeZone] 
```

然后使用计算偏移量

```
-(NSTimeInterval)secondsFromGMT 
```

# c# - 仅允许在文本框中输入字母数字

> ID：910063
> 
> 赞同：17
> 
> 时间：2009-05-26T10:45:53.540
> 
> 标签：c#, .net, wpf, regex, alphanumeric

我有一个不允许输入任何特殊字符的文本框。

用户可以输入：

1.  AZ
2.  阿兹
3.  0-9
4.  空间

我怎样才能使`KeyDown`活动做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-26T11:11:46.187

处理 KeyDown 或 KeyPress 事件是执行此操作的一种方法，但程序员通常会忘记用户仍然可以将无效文本复制并粘贴到文本框中。

一种更好的方法是处理 TextChanged 事件，并删除那里的任何违规字符。这有点复杂，因为您必须跟踪插入符号的位置并在更改框的 Text 属性后将其重新设置到适当的位置。

根据您的应用程序的需要，我会让用户输入他们想要的任何内容，然后在用户尝试提交时标记文本框（将文本变为红色或其他内容）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-03-13T15:08:17.880

只是想为那些通过搜索结束的人添加一些代码：

```
private void Filter_TextChanged(object sender, EventArgs e)
{
    var textboxSender = (TextBox)sender;
    var cursorPosition = textboxSender.SelectionStart;
    textboxSender.Text = Regex.Replace(textboxSender.Text, "[^0-9a-zA-Z ]", "");
    textboxSender.SelectionStart = cursorPosition;
} 
```

这是一个更改过滤器，因此可以处理复制和粘贴，并保留光标位置，以便中间更改文本正常工作。

请注意，它使用“发送者”来获取控件名称，允许将这一功能链接到多个文本框，假设它们需要相同的过滤器。您可以通过转到控件的事件部分并手动选择 TextChanged 事件的函数来链接多个控件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-26T10:50:35.043

使用正则表达式过滤掉其他字符。或者使用 Char.IsDigit、IsXXX 方法过滤掉不需要的字符。很多方法可以做到这一点。

更新：如果您必须使用 KeyDown ，那么您似乎还需要处理 KeyPressed 并设置 obEventArgs.Handled = true 以禁止字符。[请参阅KeyDown MSDN 页面](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx)上的示例

更新：现在您指定它是 WPF。下面的代码将只允许在文本框中输入 az 和 AZ 字符。根据需要扩展...

```
private void _txtPath_KeyDown(object sender, KeyEventArgs e)
      {
         if ((e.Key < Key.A) || (e.Key > Key.Z))
            e.Handled = true;
      } 
```

如果您将内容复制粘贴到文本框中，这将中断。一旦用户离开控件或单击“确定/提交”，如 MusicGenesis 所说，验证整个文本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T13:15:43.330

我认为值得考虑对 TextBox 的 TextChanged 事件进行过滤。您可以创建一个从文本字符串中删除任何无效字符的操作。这比阻止 KeyDown 事件要麻烦一些。

但是，我认为这是要走的路，因为您没有阻止 WPF 的内置 KeyDown/Up 事件处理机制，所以复制/粘贴仍然有效。您将在更高级别的抽象上工作，因此我认为更容易弄清楚发生了什么。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-28T03:51:11.227

```
private void _txtPath_KeyDown(object sender, KeyEventArgs e)
  {
     if ((e.Key < Key.A) || (e.Key > Key.Z))
        e.Handled = true;
  } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-30T21:24:04.397

我在silverlight中遇到了这个并写了这样的东西。

```
private string _filterRegexPattern = "[^a-zA-Z0-9]"; // This would be "[^a-z0-9 ]" for this question.
private int _stringMaxLength = 24;

private void _inputTextBox_TextChanged(object sender, TextChangedEventArgs e)
{
    if (!string.IsNullOrEmpty(_filterRegexPattern))
    {
        var text = _inputTextBox.Text;
        var newText = Regex.Replace(_inputTextBox.Text, _filterRegexPattern, "");

        if (newText.Length > _stringMaxLength)
        {
            newText = newText.Substring(0, _stringMaxLength);
        }

        if (text.Length != newText.Length)
        {
            var selectionStart = _inputTextBox.SelectionStart - (text.Length - newText.Length);
            _inputTextBox.Text = newText;
            _inputTextBox.SelectionStart = selectionStart;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-03-13T16:11:18.130

我使用自定义依赖属性来完成此操作。它可用于任何`TextBox`控件，使用起来比构建关键事件更快、更高效，并使我的代码文件更清晰。

此外，它还可以处理其他不触发按键事件的输入法，例如使用鼠标将值粘贴到 TextBox 中。

自定义 DP 的代码如下所示：

```
// When set to a Regex, the TextBox will only accept characters that match the RegEx

/// <summary>
/// Lets you enter a RegexPattern of what characters are allowed as input in a TextBox
/// </summary>
public static readonly DependencyProperty AllowedCharactersRegexProperty =
    DependencyProperty.RegisterAttached("AllowedCharactersRegex",
                                        typeof(string), typeof(TextBoxProperties),
                                        new UIPropertyMetadata(null, AllowedCharactersRegexChanged));

// Get
public static string GetAllowedCharactersRegex(DependencyObject obj)
{
    return (string)obj.GetValue(AllowedCharactersRegexProperty);
}

// Set
public static void SetAllowedCharactersRegex(DependencyObject obj, string value)
{
    obj.SetValue(AllowedCharactersRegexProperty, value);
}

// Events
public static void AllowedCharactersRegexChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
{
    var tb = obj as TextBox;
    if (tb != null)
    {
        if (e.NewValue != null)
        {
            tb.PreviewTextInput += Textbox_PreviewTextChanged;
            DataObject.AddPastingHandler(tb, TextBox_OnPaste);
        }
        else
        {
            tb.PreviewTextInput -= Textbox_PreviewTextChanged;
            DataObject.RemovePastingHandler(tb, TextBox_OnPaste);
        }
    }
}

public static void TextBox_OnPaste(object sender, DataObjectPastingEventArgs e)
{
    var tb = sender as TextBox;

    bool isText = e.SourceDataObject.GetDataPresent(DataFormats.Text, true);
    if (!isText) return;

    var newText = e.SourceDataObject.GetData(DataFormats.Text) as string;
    string re = GetAllowedCharactersRegex(tb);
    re = string.Format("[^{0}]", re);

    if (Regex.IsMatch(newText.Trim(), re, RegexOptions.IgnoreCase))
    {
        e.CancelCommand();
    }
}

public static void Textbox_PreviewTextChanged(object sender, TextCompositionEventArgs e)
{
    var tb = sender as TextBox;
    if (tb != null)
    {
        string re = GetAllowedCharactersRegex(tb);
        re = string.Format("[^{0}]", re);

        if (Regex.IsMatch(e.Text, re, RegexOptions.IgnoreCase))
        {
            e.Handled = true;
        }
    }
} 
```

它是这样使用的：

```
<TextBox Text="{Binding SomeValue, UpdateSourceTrigger=PropertyChanged}" 
         local:TextBoxHelpers.AllowedCharactersRegex="a-zA-Z0-9\s" /> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-26T11:59:14.453

我知道 winForms 有一个 MaskedTextBox 控件，它可以让你准确地指定这种东西。我不知道 WPF，所以我不知道那里是否有，但如果有，那就这样做。它比所有这些带有按键和事件的东西要容易得多，而且也更健壮。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-10-14T15:22:50.273

最简单的方法是包含扩展的 WPF 工具包，它有一个控件，可以通过指定掩码来完全按照您的要求进行操作。

[http://wpftoolkit.codeplex.com/wikipage?title=MaskedTextBox&referringTitle=Home](http://wpftoolkit.codeplex.com/wikipage?title=MaskedTextBox&referringTitle=Home)

如果需要，它还会在您输入时在文本框中显示掩码。

（它还有许多其他有用的控件）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-26T11:53:11.953

并且您的 regExp 可能看起来像 [0-9a-zA-Z]* 以仅允许英文字母数字字符

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-12-07T17:10:36.250

只有字母数字文本框 WPF C#，

对不起我的英语..但是对于WPF，c＃的这段代码，我只允许字母数字

```
private void txtTraslado_TextChanged(object sender, KeyEventArgs e)
{
  if (((e.Key < Key.NumPad0)||(e.Key > Key.NumPad9))&&((e.Key < Key.A)||(e.Key > Key.Z)))
  {
    e.Handled = true;
  }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-04-05T07:10:28.770

使用 Asp.NET AJAX 控件工具包

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %> 
```

并使用 FilteredTextBoxExtender

```
<asp:TextBox ID="txt_gpf_no" runat="server" CssClass="textbox" 
                                                MaxLength="10"></asp:TextBox>
<asp:FilteredTextBoxExtender ID="FilteredTextBoxExtender_gpf_no" runat="server" Enabled="True"
                                                TargetControlID="txt_gpf_no" FilterType="UppercaseLetters,LowercaseLetters,Custom" ValidChars="1234567890 ">
</asp:FilteredTextBoxExtender> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-24T13:22:43.740

在 my.Net Framework 4.5 C# 应用程序中

```
 private void txtRF_Register_Val_KeyDown(object sender, KeyEventArgs e)
    {
        //only enable alphanumeric
        if (!(((e.KeyCode < Keys.NumPad0) || (e.KeyCode > Keys.NumPad9)) && ((e.KeyCode < Keys.A) || (e.KeyCode > Keys.E))))
        {
            e.SuppressKeyPress = false;
        }
        else
        {
            e.SuppressKeyPress = true;
        }
    } 
```

# c++ - 如何在 boost::asio 中实现基于 POSIX select() 的行为

> ID：910064
> 
> 赞同：2
> 
> 时间：2009-05-26T10:45:54.227
> 
> 标签：c++

我已经浪费了两天时间阅读 boost::asio 的文档而且我仍然不知道如何`select()`仅使用一个线程（使用 boost 框架）为多个套接字实现类似阻塞的功能。boost::asio 的异步函数立即返回，因此需要在主线程中放置一些等待函数，直到其中一个`async_read`完成。我怀疑这会很耗时，但我确实受到性能要求的限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T17:47:48.243

`io_service`对象是函数的抽象`select`。设置你的套接字，然后`io_service::run`从你的主线程调用成员函数。该函数将阻塞，直到与实例`io_service::run`关联的所有工作完成。`io_service`您可以在异步处理程序中安排更多工作。

您也可以使用`io_service::run_one`,`io_service::poll`或`io_service::poll_one`代替`io_service::run`.

# c - 将数据从内联汇编移动到 C 中的数组中

> ID：910066
> 
> 赞同：0
> 
> 时间：2009-05-26T10:46:43.303
> 
> 标签：c, assembly

我有一个非常简单的问题；我有一个数组，它应该存储一些内联汇编程序的结果。我现在的问题是如何将数据从内联汇编器移动到数组中？我正在使用 gcc 在 x86 机器上进行编译。考虑以下简单的代码片段：

```
int main() {    
  int result[32];

  __asm__ __volatile__(  ".mov  esi, 32 \n\t"); 

  __asm__ __volatile__(  ".mov  edi, 32 \n\t");

  __asm__ __volatile__(  ".rept 32 \n\t");   
  __asm__ __volatile__(  ".mov  eax, esi \n\t");

  __asm__ __volatile__(  ".sub  eax, edi \n\t");

  __asm__ __volatile__(  ".sub  edi, 1 \n\t");

  //Code here for storing eax in result[0], result[1], ... result[31],

  __asm__ __volatile__(  ".endr \n\t");

  for(i=0; i<32; i++)
     printf("%d\n", results[i]); 

  return (0);
} 
```

最后，输出应如下所示：

结果[0] = 32；结果[1] = 31; 结果[2] = 30; ...结果[31] = 1;

任何人的想法，这怎么可能很简单？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:57:58.413

我会用这个循环来做到这一点：

```
 __asm {
        lea edx, result
        mov ecx, 32
loop1:
        mov dword ptr [edx], ecx
        add edx, 4
        loop loop1
    } 
```

**更新**（*感谢 Bastien 的评论*）：在研究了本文档后（[http://www.cs.virginia.edu/~clc5q/gcc-inline-asm.pdf](http://www.cs.virginia.edu/~clc5q/gcc-inline-asm.pdf)）：从 asm 访问的变量（在 GCC 中）必须是静态的，源和目标是相反的，必须使用特殊语法来偏移数组。

```
#include <stdio.h>

static int results[32];

int main(int argc, char** argv) 
{
    int i;

    asm volatile( "xor %eax, %eax \n\t");
    asm volatile( "movl $0x020, %edi \n\t");
    asm volatile( ".rept 32 \n\t");
    asm volatile( "mov %edi, _results(,%eax,4) \n\t");
    asm volatile( "dec %edi \n\t");
    asm volatile( "inc %eax \n\t");
    asm volatile( ".endr");

    for (i=0; i<32; i++) 
        printf("%d\n", results[i]);

    return 0; 
} 
```

这适用于 gcc 3.4.4 (cygwin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:49:32.303

请忽略我最后的评论，我在这里再试一次：

```
int main() {

  int results[32];
  int i;

  __asm__ __volatile__(  "mov  %esi, 32 \n\t");   
  __asm__ __volatile__(  "mov  %edi, 32 \n\t");  
  __asm__ __volatile__(  ".rept 32 \n\t");   
  __asm__ __volatile__(  "mov  %eax, %esi \n\t");  
  __asm__ __volatile__(  "sub  %eax, %edi \n\t");  
  __asm__ __volatile__(  "sub  %edi, 1 \n\t");

   __asm__(".intel_syntax prefix");  
  __asm__ __volatile__( "mov dword ptr results[%edi*4], %eax \n\t");  
  __asm__(".att_syntax prefix");

  __asm__ __volatile__(  ".endr \n\t");

  for(i=0; i<32; i++)
     printf("%d\n", results[i]); 

  return 0;
} 
```

这样做时，我收到错误消息：未定义对“结果”的引用。我想这需要以某种方式传递给内联程序集？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T10:51:41.937

放在“sub edi”行之前的这一行将进行复制（AT&T 语法 - 目标在右侧）：

```
__asm__ __volatile__(  "movl %ecx, $label(,%edi,$4) \n\t"); 
```

# jira - 在 Jira 中将用户故事的已解决状态更改为已关闭状态

> ID：910073
> 
> 赞同：0
> 
> 时间：2009-05-26T10:48:36.840
> 
> 标签：jira

我正在使用 Jira 为我的敏捷方法项目组织用户故事。当我尝试关闭用户故事时，它显示状态为“已解决”，而不是“已关闭”。有人可以帮我如何将用户故事状态更改为已关闭？

请发表您的建议和帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T13:32:32.157

回答这样一个模糊的问题有点困难——所以如果你能详细说明你在 JIRA 实例中所做的自定义，它会有所帮助。

一些指示：

JIRA 使用工作流来管理问题可以使用的流程。JIRA 安装附带的默认工作流程称为“jira”，如下所示：[https ://confluence.atlassian.com/display/JIRA/Configuring+Workflow](https://confluence.atlassian.com/display/JIRA/Configuring+Workflow)

根据您的 JIRA 安装的自定义，您可以在使用“解决”操作时将工作流程从 Open 更改为 Closed。

如果您不是 JIRA 管理员，则不同的工作流转换可以设置各种属性和条件以及验证器，例如检查权限。因此，如果您是无权执行特定转换的用户 - 您可以查看是否可以通过权限管理面板更改它，或者再次 - 在工作流验证中。

# c# - 如果从 C# 安装了 Office 的 MUI 包，如何检测当前语言环境的情况

> ID：910079
> 
> 赞同：1
> 
> 时间：2009-05-26T10:51:16.430
> 
> 标签：c#, ms-office, windows-mui

如果从 C# 安装了 Office 的 MUI 包，如何检测当前语言环境的情况

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T11:23:05.540

您可以获取安装了 Office 的区域设置，例如查看注册表项...

适用于 Office 2007

```
HKEY_LOCAL_MACHINE\Software\Office\12.0\MsoExample\A\1030 
```

[LCID 1030](http://msdn.microsoft.com/en-us/goglobal/bb964664.aspx)告诉您丹麦（丹麦）MUI 已安装。

如果还有更多，我不能向你保证，我只安装了这个，但你可以自己做那个测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-03T09:57:31.647

不，你不能。

HKEY_LOCAL_MACHINE\Software\Office <- 不存在！HKEY_LOCAL_MACHINE\Software\Microsoft\Office\12.0 <-- 确实存在，但在任何地方都不包含任何“A”键，也不包含任何 MsoExample 键。

# jquery - Jquery延迟css div位置

> ID：910080
> 
> 赞同：1
> 
> 时间：2009-05-26T10:51:38.677
> 
> 标签：jquery, css, jquery-animate

我试图让我的菜单栏在大约 5 秒的不活动超时后部分隐藏。菜单位于距页面顶部 20px 的位置，基本思想是，一旦向上移动，菜单的一小部分仍然可见，以允许用户将鼠标悬停在该菜单上以使其再次下拉（希望这使得感觉！）。

我已经管理了动画方面，但不是很超时。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:59:57.677

您应该使用代表菜单的`mouseout`事件`div`来实现如下功能：

```
var waitingForMenuToHide = false;

function myOnMouseOut() {
    waitingForMenuToHide = true;
    setTimeout(function() {
        if (waitingForMenuToHide) {
            // Hide the menu div...
        }
    }, 5000);
} 
```

以及`mouseover`重置`waitingForMenuToHide`变量的事件：

```
function myMouseOver() {
    waitingForMenuToHide = false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T11:00:53.430

不幸的是，jQuery 没有延迟功能。但是，您可以通过将元素的不透明度设置为从 1 到 1 的动画来使用偷偷摸摸且不太脏的 hack 来模拟延迟：

```
$('#visibleElement')               // Assuming the element is already shown
  .animate({opacity: 1.0}, 3000);  // do nothing for 3 seconds 
```

因此，要在鼠标离开 5 秒后向上滑动菜单，您可以执行以下操作：

```
$('#menuDiv').mouseout(function(){
  .animate({opacity: 1.0}, 5000)
  .animate( slide up etc...
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T11:01:15.537

尝试查看 HoverIntent。 [http://cherne.net/brian/resources/jquery.hoverIntent.html](http://cherne.net/brian/resources/jquery.hoverIntent.html)

这使得在用户停止与您的菜单交互后延迟执行操作变得非常容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T11:28:47.197

在 mouseout 事件上，使用回调启动超时以向上滚动元素。在鼠标悬停事件中，如果超时，请使用以下命令将其终止：

```
clearTimeout(timer); 
```

所以它会是这样的：

```
var timer;
$('mybar').mouseover(function(){clearTimeout(timer);/* Animate down code here */});
$('mybar').mouseout(function(){timer=setTimeout(function(){/* Animate up Code Here */}, 5000);}); 
```

# asp.net - linq更新记录

> ID：910084
> 
> 赞同：6
> 
> 时间：2009-05-26T10:52:14.913
> 
> 标签：asp.net, linq, linq-to-sql

如何在 LINQ to SQL (ASP.Net / C#) 中更新具有特定 ID 的记录？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-01T17:38:54.713

你可以这样做...

```
var record = 
(
   from x in db.TableName
   where x.Id == 12345
   select x
)
.Single();

record.DateUpdated = DateTime.Now;

db.SubmitChanges(); 
```

希望它有帮助**:)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T10:57:02.893

注意发布一些您已经尝试过的示例代码。

如果是 linq2sql，那么使用 linq datacontext 使用`Where<T>()`子句检索对象、更新对象属性然后调用`DataContext.SubmitChanges()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T11:14:07.607

以这段代码为例。

```
void UpdateRow(Int32 intID)
{
    bool IsSuccessfullyUpdated = false;

    var db = new DataContext();
    try
    {
        var dbCstInfo = db.TableName
            .Where(w => w.ID == intID)
            .SingleOrDefault();

        if (dbCstInfo != null)
        {
            dbCstInfo.IsActive = !dbCstInfo.IsActive;
            dbCstInfo.Name = "BJP";
            dbCstInfo.Comp = "PVtal";
            db.SubmitChanges();
            IsSuccessfullyUpdated = true;
        }
    }
    catch
    {
        IsSuccessfullyUpdated = false;
    }

    return IsSuccessfullyUpdated;

} 
```

# php - 在 Magento 的前端显示产品创建和最后编辑日期

> ID：910085
> 
> 赞同：9
> 
> 时间：2009-05-26T10:52:36.007
> 
> 标签：php, mysql, magento

我在 MySQL 数据库中的表 catalog_product_entity 中看到了这两个属性

字段是“created_at”和“updated_at”

我如何让他们出现在前端？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T10:01:58.027

可以使用 getAttributeName() 函数简单地添加属性，例如，要获取 created_at，只需将以下 php 脚本添加到 phtml 页面：

```
<?php echo $_product->getCreatedAt();?> 
```

对于 updated_at，使用：

```
<?php echo $_product->getUpdatedAt();?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-31T01:30:52.990

如果您在列表页面中显示这两个东西，它们可能不会显示。而是使用以下代码：

**对于已创建**

```
<?php echo Mage::getModel('catalog/product')->load($_product->getId())->getCreatedAt();?> 
```

**对于更新：**

```
<?php Mage::getModel('catalog/product')->load($_product->getId())->getUpdatedAt();?> 
```

# .net - 如何将 ASP.NET MVC 应用程序中的模型、视图和控制器分离到不同的程序集中

> ID：910089
> 
> 赞同：12
> 
> 时间：2009-05-26T10:54:07.703
> 
> 标签：.net, asp.net, asp.net-mvc, .net-assembly

目前我正在尝试进入 ASP.NET MVC 框架。
对于我的大多数测试应用程序，我使用了一个程序集/项目。这适用于一些较小的应用程序。然后我想知道如何将我的模型、控制器和视图类放入单独的程序集中？在非常大的 Web 应用程序中，将所有内容放入单个程序集/项目中是不太现实的。

所以我的问题是：是否可以告诉 ASP.NET MVC 框架在另一个程序集中搜索视图和/或控制器，而不会失去路由引擎的内置灵活性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T22:53:57.237

（未知）是正确的。创建两个项目，一个类库和一个 MVC Web 项目。MVC 项目应该引用包含控制器和代码隐藏文件（全局 asax 等）的类库。这是一个示例布局。

类库应该只包含 .cs 文件而不包含视图（.aspx/.ascx 文件）。

```
MyProject.BaseSite（类库）
    + 控制器
        - HomeController.cs
        - ...任何其他控制器
    - default.aspx.cs
    - global.asax.cs

```

MVC Web 项目应包含配置、视图等以及对您的类库的引用

```
MyProject.ExampleSite
    + 内容
        + 脚本
        + CSS
        + 图片
    + 意见
        + 主页
            - 索引.aspx
            - .. 其他 aspx 文件
        + 共享
            - Site.master
    - web.config

```

记住不同的命名空间。然后，您可以创建多个引用相同代码的示例网站。这使您可以有效地对您的网站进行完全不同的皮肤。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T11:11:38.293

为每个责任层创建一个单独的类库项目，编译以创建程序集，然后在适当的应用程序中引用每个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T11:12:46.403

是的，如果您使用受支持的[依赖注入](http://haacked.com/archive/2007/12/07/tdd-and-dependency-injection-with-asp.net-mvc.aspx)容器之一，那么它们的配置数据通常不仅指定要加载以响应特定查询的类，还指定要从中加载它的程序集。这允许您将您的类拆分到任意程序集中，并且 MVC 仍然能够找到它们。

当然，Unknown（Google）提供的更简单的答案也可以！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-19T20:21:27.717

我意识到这是一个非常古老的问题，但我已经写了一篇关于如何准确地满足您的要求的文章

[http://dotnetslackers.com/articles/aspnet/storing-asp-net-mvc-controllers-views-in-separate-assemblies.aspx](http://dotnetslackers.com/articles/aspnet/storing-asp-net-mvc-controllers-views-in-separate-assemblies.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-14T16:08:34.470

只完成@David的回答：

如果您的项目由 管理`NuGet`，则在创建类库后，将`packages.config`文件复制到类库根目录。之后，您应该`packages.config`根据每个类库的需要编辑添加或删除包的每个文件。

# uml - 绘图程序有助于设计软件？

> ID：910093
> 
> 赞同：2
> 
> 时间：2009-05-26T10:54:26.593
> 
> 标签：uml, software-design, diagramming

我正在寻找一个可以帮助设计软件的图表程序，从高级需求到低级类和功能。

我见过很多 UML 程序，但它们不允许您在同一张地图中设计多个细节级别，就像您可以“放大”并设计零件的细节一样。

**是否存在有助于这种设计的程序？**让您在同一张地图上进行高级和低级设计的程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T12:15:00.083

大多数来自大型供应商的 UML 产品都可以让您随心所欲。“Rational Rose”和“Enterprise Architect”只是我用过的两个例子。它们都允许您在同一个视图中混合组件、包和类级别的信息。它们都提供了一种将需求指定为类元数据的一部分的方法，我相信它们也可以发挥作用。

编辑 8/23/09 我刚刚发现[Topcased](http://topcased.org/)。它是免费的，并且与 Rose & EA 有许多相同的功能。我不确定在一个视图中混合不同的图表类型，但您可能想试一试。我肯定会研究将它用于我的个人项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T11:52:39.633

我推荐[BOUML](http://bouml.free.fr/)。这是一个免费的 UML 建模应用程序，它：

*   具有出色的 SVG 导出支持，这一点很重要，因为以矢量格式查看大图（在 Firefox 中可快速缩放）非常方便（您可以在“鸟瞰”视图和类详细视图之间快速切换），
*   这可以作为您要求的“缩放”功能（我使用这样的 SVG 导出我自己，以便能够快速概览一组类的关系，然后放大选定一个的细节），
*   速度极快（有史以来最快的 UML 工具，查看[基准测试](http://bouml.free.fr/benchmark.html)），
*   具有坚如磐石的 C++、Java、PHP 和其他导入支持，
*   是多平台（Linux、Windows、其他操作系统），
*   功能齐全，令人印象深刻的密集开发（看看[发展历史](http://bouml.free.fr/historic.html)，很难相信如此快速的进步是可能的）。
*   支持插件，具有模块化架构（这允许[用户贡献](http://bouml.free.fr/contrib.html)，看起来 BOUML 社区正在形成）

您要求的“缩放”功能可以通过 SVG 导出获得。我按照您的要求使用此类导出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T10:56:57.760

我使用了[Rational Rose](http://www-01.ibm.com/software/rational/)，看起来它符合您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T10:59:38.317

您可以尝试[BOUML](http://bouml.free.fr/)，虽然它不允许您“放大”，但它确实涵盖了 UML 的所有方面，并允许您一次查看设计的不同部分（在多个窗口中）。它也是免费的，这可能会或可能不会使它更适合您，并且是跨平台的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T10:59:59.843

首先，对于您要表达的不同事物，有不同的图表。在软件设计期间，您不仅使用 UML，还使用 ​​HTML 草图和类似的东西。所以为正确的任务选择正确的工具是我的建议。根据您的粒度创建一个文件夹结构，一个用于前端草图（您可以将其混合放置），一个用于类图等等。因此，请尝试建立一个满足您所有需求的流程。圣杯计划通常不存在或不好，只是因为它试图满足许多客户。

# algorithm - 将正方形分割成小正方形

> ID：910097
> 
> 赞同：4
> 
> 时间：2009-05-26T10:55:34.300
> 
> 标签：algorithm, math

我有大广场。我想把这个正方形分成小正方形。我需要所有可能的组合。我知道有无数种组合，但我有一个限制。我有最小正方形的固定尺寸。

我可以使用蛮力来实现它。但它太长了。

这个任务有更好的算法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T11:16:53.930

那么这个问题只有在我们做出 2 个假设时才有解决方案（否则会有无限组合）

1）最小的正方形有固定的大小
2）切割大正方形的方式也是固定的，就像你把正方形放到一个网格中，线被小正方形的大小分开。

还有第三个假设会使问题更容易一些

3）大正方形的边比小正方形大K倍。K为整数。

如果两个假设都成立，我们可以继续：

求 N 个（N beign integer）最小正方形的个数：大小为 N*small-size 的正方形

```
 if ((big-size % N*small-size)==0)
    Number += (big-size / N*small-size)^2
 else
    Number += ((big-size / N*small-size)^2) * (big-size % N*small-size) 
```

else 条件中的 * (big-size % N *small-size) 是因为如果 bigsquare 不被 N 整除，当“griding”gid-width 为 N 的 big square 时，我们将有一个“fraction part” “ 剩下。通过这种方式，我们可以再次开始划分（再次网格化），但偏移量为 1、2 或 N 个小步长。步数为 (big-size % N* small-size)。

同样，这些步骤仅在采用 3 个假设的情况下才成立。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T11:04:13.643

没有“无限”的组合。事实上，这个数字可能很大，但也是有限的。此外，如果您需要严格的正方形（宽度=高度，而不仅仅是矩形），那就更少了，因为您必须将原始正方形（L 边）除以两边相同的整数，否则您将得到矩形也是。如果您使用整数，我建议您将 L 除以 2、3、... M（L/M = 最小内平方长度）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T11:05:03.233

我的数学有点模糊，但如果你有一个正方形 (n^2)，那么你就有一个边的长度 (n)。

您可以从中`n`计算出该数字的所有因子，并将它们用作较小正方形的边...

例如

```
n^2 = 44100
n = 210

Factors of n = x=2,x=3,x=5,x=7, x= ... and so on. 
```

所以每个因素的小方块是

```
x=2 : x^2 = 4 : 44100 / 4 = 11025 small squares
x=3 : x^2 = 9 : 44100 / 9 = 4900 small squares
x=5 : x^2 = 25 : 44100 / 25 = 1764 small squares
x=7 : x^2 = 49 : 44100 / 49 = 900 small squares 
```

等等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-14T13:30:19.723

我建议使用以下 Python 代码将一个大正方形（512x512）随机拆分为较小的正方形（最小 32x32）。

```
import random 
import numpy as np

n = 16
cellSize = 32
smallSizes = [1,2,4,8]

def is_cell_available(grid, indexRow, indexCol):
    return not bool(grid[indexRow, indexCol])

def try_square_size(grid, indexRow, indexCol):
    smSizes = smallSizes.copy()
    while True:
        potentialSize = random.choice(smSizes)
        if indexRow + potentialSize <= n and indexCol + potentialSize <= n:
            if np.count_nonzero(grid[indexRow:indexRow+potentialSize, indexCol:indexCol+potentialSize])==0:
                return potentialSize
        else:
            smSizes.remove(potentialSize)

grid = np.zeros((n,n), np.uint8)
bigMat = np.zeros((n*cellSize,n*cellSize), np.uint8)

for indexRow in range(n):
    for indexCol in range(n):
        if is_cell_available(grid, indexRow, indexCol):
            blockSize = try_square_size(grid, indexRow, indexCol)
            val = random.randint(1,255)
            grid[indexRow:indexRow+blockSize, indexCol:indexCol+blockSize] = val
            bigMat[indexRow*cellSize:(indexRow+blockSize)*cellSize, indexCol*cellSize:(indexCol+blockSize)*cellSize] = val
        else:
            pass 
```

# c# - 如何从集合 A 中获取不在集合 B 中的元素？即AB

> ID：910098
> 
> 赞同：1
> 
> 时间：2009-05-26T10:55:36.920
> 
> 标签：c#, linq, collections

> **可能的重复：**
> [LINQ 中的不相交联合](https://stackoverflow.com/questions/801757/disjoint-union-in-linq)

**DUPE**：[LINQ 中的不相交联合](https://stackoverflow.com/questions/801757/disjoint-union-in-linq)

我知道这是一个简单的收集操作，我的代码是：

```
var gone = from a in A
     where B.Contains(a) == false
     select a; 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T10:57:18.600

```
var gone = A.Except(B); 
```

# c# - 如何创建列表 从逗号分隔的字符串？

> ID：910119
> 
> 赞同：16
> 
> 时间：2009-05-26T10:59:28.800
> 
> 标签：c#, generics

给定变量

```
string ids = Request.QueryString["ids"]; // "1,2,3,4,5"; 
```

有什么方法可以将其转换为 List 而无需执行类似的操作

```
List<int> myList = new List<int>();

foreach (string id in ids.Split(','))
{
    if (int.TryParse(id))
    {
        myList.Add(Convert.ToInt32(id));
    }
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-26T11:05:12.283

要从头开始创建列表，请使用 LINQ：

```
ids.Split(',').Select(i => int.Parse(i)).ToList(); 
```

如果您已经拥有列表对象，请省略 ToList() 调用并使用 AddRange：

```
myList.AddRange(ids.Split(',').Select(i => int.Parse(i))); 
```

如果字符串中的某些条目可能不是整数，则可以使用 TryParse：

```
int temp;
var myList = ids.Split(',')
    .Select(s => new { P = int.TryParse(s, out temp), I = temp })
    .Where(x => x.P)
    .Select(x => x.I)
    .ToList(); 
```

一种避免 temps/TryParse 但跳过无效条目的最终（较慢）方法是使用 Regex：

```
var myList = Regex.Matches(ids, "[0-9]+").Cast<Match>().SelectMany(m => m.Groups.Cast<Group>()).Select(g => int.Parse(g.Value)); 
```

但是，如果您的条目之一溢出 int (999999999999)，这可能会抛出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-26T11:05:39.520

这应该可以解决问题：

```
myList.Split(',').Select(s => Convert.ToInt32(s)).ToList(); 
```

如果列表可能包含除整数之外的其他数据，`TryParse`则应包含调用。请参阅已接受的答案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T11:01:32.400

使用 Linq：

```
myList.AddRange(ids.Split(',').Select(s => int.Parse(s)); 
```

或直接：

```
var myList = ids.Split(',').Select(s => int.Parse(s)); 
```

此外，为了防止编译器显式生成（很大程度上是冗余的）lambda，请考虑：

```
var myList = ids.Split(',').Select((Func<string, int>)int.Parse); 
```

（提示：微优化。）

如果可能存在无效输入并且应该静默处理，那么也`TryParse`应该使用 which 而不是（仅）。`Parse`但是，其他人已经发布了使用的解决方案，`TryParse`所以我当然不会。请记住，您不应该重复计算。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T11:10:02.587

或者`TryParse`在你的例子中包括：

```
var res = ids.Split(',').Where(x => { int tmp; return int.TryParse(x, out tmp); }).Select(x => int.Parse(x)).ToList(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T11:18:21.367

为了在性能特征和行为方面匹配请求，它应该做同样的事情，而不是退出正则表达式或不做'TryParse'：-

```
ds.Split(',')
  .Select( i => {
    int value; 
    bool valid = int.TryParse(out value); 
    return new {valid, value}
  })
  .Where(r=>r.valid)
  .Select(r=>r.value)
  .ToList(); 
```

但是虽然正确，但这很丑：D

借用杰森评论中的提示：-

```
ds.Split(',')
  .Select( i => {
    int value; 
    bool valid = int.TryParse(out value); 
    return valid ? new int?( value) : null;
  })
  .Where(r=>r != null)
  .Select(r=>r.Value)
  .ToList(); 
```

或者

```
static class Convert
{
  public static Int32? ConvertNullable(this string s)
  {
    int value; 
    bool valid = int.TryParse(out value); 
    return valid ? new int?( value) : null;
  }
}

ds.Split(',')
  .Select( s => Convert.ConvertNullable(s))
  .Where(r=>r != null)
  .Select(r=>r.Value)
  .ToList(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T11:08:25.833

这里的一个问题是我们将如何处理不是整数的值（假设我们会得到一些不是整数的值）。一个想法可能是简单地使用正则表达式：

^-?[0-9]+$

现在，我们可以将所有这些结合起来（如 Konrad 的示例所示）：

```
var myList = ids.Split(',').Where(s => Regex.IsMatch(s, "^-?[0-9]$")).Select(s => Convert.ToInt32(s)).ToList(); 
```

那应该做的工作。

# linux - 使用 awk 就地编辑

> ID：910121
> 
> 赞同：4
> 
> 时间：2009-05-26T10:59:44.587
> 
> 标签：linux, awk

我想在文件顶部添加一行，比如`f1`使用 awk。
有没有比以下更好的方法？

```
awk 'BEGIN{print "word"};{print $0}' f1 > aux;cp aux f1;\rm aux<br/> 
```

`-i`awk在 sed 中有类似选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T11:46:37.893

为什么不使用 sed - 它会使解决方案更直接

```
$sed -i.bak '1i\
word
' <filename> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:59:14.320

另一种方法是：

```
sed -i '1s:^: Word1\nWord2 :' file 
```

# .net - .NET：如何查询 NT/Users 数据库或记录？

> ID：910131
> 
> 赞同：0
> 
> 时间：2009-05-26T11:01:54.350
> 
> 标签：.net, windows

我们如何查询机器上所有用户的 NT/Users 数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T11:11:11.537

您可以使用[System.DirectoryServices](http://msdn2.microsoft.com/en-us/system.directoryservices.aspx "System.DirectoryServices")命名空间来执行此操作。这是一篇[很好的文章](http://www.willasrari.com/blog/query-active-directory-users-using-c/000133.aspx)，描述了如何使用该命名空间的类。

这是显示如何执行此操作的代码：

```
DirectoryEntry entry = new DirectoryEntry("WinNT://MACHINE_NAME");
entry.AuthenticationType = AuthenticationTypes.Secure;

DirectorySearcher deSearch = new DirectorySearcher(entry);
deSearch.Filter = "(&(objectClass=user))";

SearchResultCollection results = deSearch.FindAll();

foreach (SearchResult srUser in results)
{
      try
      {
            DirectoryEntry de = srUser.GetDirectoryEntry();
            lstbox.Items.Add(de.Properties["sAMAccountName"].Value.ToString());
      }
      catch { }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T11:11:39.273

我假设您使用的是 C#。您可以使用 WMI 获取它们：

```
using System.Management;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            SelectQuery query = new SelectQuery("Win32_UserAccount");
            ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);
            foreach (ManagementObject envVar in searcher.Get())
            {
                Console.WriteLine("Username : {0}", envVar["Name"]);
            }

            Console.ReadLine();
        }
    }
} 
```

# iphone - Xcode 组和文件：如何将文件从项目 A 复制到项目 B 而不发疯？

> ID：910132
> 
> 赞同：11
> 
> 时间：2009-05-26T11:01:57.233
> 
> 标签：iphone, xcode

出于某种原因，Xcode“组和文件”中的表示与我所有真实项目文件所在的文件夹中的文件层次结构不匹配。而且由于某种原因，我无法复制整个组甚至单个文件并将其放入另一个项目中。所以我在“组和文件”中有一个很好的图像层次结构，但是所有排序的图像都是无序的，就像我的文件系统上一个装满东西的巨大文件夹中的一团糟。真的很可怕；）

所以现在我想把我所有的图标放到另一个项目中，但我不能只复制组“img > gui > icons”。我必须从我的文件系统中挑选每一个图标图像，其中图标与数百个其他图像和文件混合在一起。

是否有一些我可以激活的隐藏选项，以便 Xcode 能够在文件系统上的项目文件夹中重现“组和文件”的层次结构？或者我还能如何复制这些文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T04:10:12.837

将组层次结构完整地从一个项目移植到另一个项目是不可能的。一些建议的方法：

*   如果您要带入的文件是项目的绝大部分，只需克隆项目并删除所有不是您要复制的文件的内容。
*   如果是少量组中的很多文件，则在新项目中设置组，并将旧项目组中的文件拖放到新项目组中
*   编写 AppleScript 以使用递归下降算法移动层次结构
*   ◆◆ 将两个project.pbxproj 文件作为文本文件打开，小心地将文件引用和组引用从一个复制到另一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T11:06:31.173

将过滤后的 Finder 窗口中的图标文件复制到“仅图标”文件夹。然后将它们导入到您的新 Xcode 项目中。重复任何其他类别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-08T18:52:19.507

步骤： 1.在 Xcode 中打开组 2.选择您想在其他项目中拥有的所有项目 3.右键单击并在 finder 中显示。4\. 将这些文件复制到 Finder 中的新文件夹 5\. 现在将 Finder 中新文件夹中的这些文件拖放到新项目中 Xcode 中新创建的组文件夹中。6\. 接受 Xcode 中“添加文件”操作的复制说明

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-15T11:36:11.130

[在这里](https://stackoverflow.com/questions/1128398/xcode-project-resource-organization-and-structure)看看这个其他问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T00:17:25.533

[在这里](https://stackoverflow.com/questions/338652/how-do-i-get-xcode-to-replicate-project-group-structure-in-the-folder-structure-o)查看我之前的问题。

此外，向 Apple 提交错误，让他们知道您希望让组代表磁盘上的文件夹结构的选项。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-07T08:18:21.423

我迟到了，但这是一种可能性：

使用 Finder 打开项目目录。将整个目录（在 Xcode 中作为一个组使用）复制到您的新项目中。在项目导航器中，右键单击并按“添加文件”。在对话框中，选择复制的目录并完成。

# regex - 用于组合数字的正则表达式

> ID：910133
> 
> 赞同：3
> 
> 时间：2009-05-26T11:02:14.207
> 
> 标签：regex, vim

我有一个如下的数字序列。我想将数字组合成 4 组。有人可以给一个 vim 正则表达式来做到这一点吗？

输入：1234 56 7890 1234

输出应该是：1234 5678 9012 34

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T11:12:49.507

两关：

```
s/ //g
s/\(.\{4\}\)/\1 /g 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T11:13:55.103

我将分两步执行此操作：（1）删除数字组右侧的空白

```
:s/\(\d\+\) /\1/g 
```

(2) 分组：

```
:s/\(\d\{4}\)/\1 /g 
```

如果有很多行，请记录宏
或对标记区域执行这些步骤。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T11:34:33.660

您*可以*一次性完成，但看起来很糟糕：

```
:s/\(\d\) *\(\d\) *\(\d\) *\(\d\) */\1\2\3\4 /g 
```

虽然这有效，但它相当愚蠢。比花 2 分钟完成一个一次性完成的 Monsteregex™ 来完成其中一种不错的两遍解决方案要快得多。另外，两遍解决方案更容易理解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T11:40:39.030

```
:s/\(\d\)\s*\(\d\)\s*\(\d\)\s*\(\d\)\s*/\1\2\3\4 /g 
```

有效，但我更喜欢[Autocracy 的解决方案](https://stackoverflow.com/questions/910133/regex-for-combining-digits/910158#910158)。

# dynamics-crm - CRM 4.0 上的计划任务/插件

> ID：910134
> 
> 赞同：0
> 
> 时间：2009-05-26T11:02:14.333
> 
> 标签：dynamics-crm, dynamics-crm-4

是否可以在 CRM 上安排 pulgin。

如果上周没有活动，我正在尝试为机会实体创建提醒任务活动。我希望每周运行一次。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:05:33.680

尽管 Dynamics CRM 中没有*重复工作流*这样的东西，但您可以通过创建一个工作流规则来模拟这种行为

1.  在创建记录时被解雇
2.  检查条件
3.  有条件地做某事
4.  等待 n 天/小时/分钟
5.  再次调用自己

不要忘记将规则标记为“作为子工作流运行”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T11:31:19.953

我认为也许更好的方法是将该功能构建到工作流程中？我最近没有做太多的 CRM，但我已经在当年的 CRM 1.2 中实施了你所描述的内容。事实证明，这对于报告也非常有用，可以提取销售人员的报告，从而养成不跟进机会的习惯。

最好的问候 Rihan

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T13:07:59.387

我建议使用 SQL Server Scheduled Job。虽然工作流可以用于这个问题，但等待状态工作流被认为是应用程序消耗。

原因是等待状态工作流保存在内存中，需要定期针对特定的时序条件进行验证。在您的情况下，它需要定期计算是否超过一周，如果是，它将从数据库中上传等待状态工作流以执行。

问候，

哈迪

# java - 我们可以在edittext中有不可编辑的文本吗

> ID：910135
> 
> 赞同：18
> 
> 时间：2009-05-26T11:03:22.660
> 
> 标签：java, android, android-edittext

我正在使用一个`EditText`. 是否有可能部分文本不可编辑而其余部分可编辑`EditText`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-26T15:19:18.650

你可以使用

```
editText.setFocusable(false);
```

或者

```
editText.setEnabled(false);
```

虽然禁用`EditText`当前不会忽略来自屏幕键盘的输入（我认为这是一个错误）。

根据应用程序，最好使用[`InputFilter`](http://developer.android.com/reference/android/text/InputFilter.html)拒绝所有更改的 an：

```
editText.setFilters(new InputFilter[] {
    new InputFilter() {
        public CharSequence filter(CharSequence src, int start,
            int end, Spanned dst, int dstart, int dend) {
            return src.length() < 1 ? dst.subSequence(dstart, dend) : "";
        }
    }
});
```

另请参阅[此](https://stackoverflow.com/questions/660151/how-to-replicate-androideditablefalse-in-code)问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T12:17:40.920

您可以实现一个 TextChangedListener 以确保您的文本的这些部分不会得到`deleted/overwritten`。

```
class TextChangedListener implements TextWatcher {
    public void afterTextChanged(Editable s) {
                makeSureNothingIsDeleted();
    }

    public void beforeTextChanged(CharSequence s, int start, int count, int after) {}

    public void onTextChanged(CharSequence s, int start, int before, int count) {}
} 
```

* * *

```
 TextChangedListener tcl = new TextChangedListener();
    my_editable.addTextChangedListener(tcl); 
```

# excel - 对齐记录集中的相应行

> ID：910143
> 
> 赞同：0
> 
> 时间：2009-05-26T11:06:37.380
> 
> 标签：excel, vb6, recordset

我有两个具有相同主键的记录集：称为“item_no”和“Order_id”的两列的组合.....两个记录集都有这个主键（组合），其余不同的列......

现在，我想对两个记录集中的（那些）行进行排序，以便记录的位置（具有相同的主键值）应该是相同的......

例如，考虑 rset1 和 rset2... 将上述列作为主键组合，并且 rset1 中的 row5 的“item_no”和“order_id”的值为**2 300** ，而 rset2 中的第 8 行的值为**2 300**（相同)....

1）现在我想将第 5 行（在 rset1 中）带到第 8 个位置，这样两个记录在记录集中的位置相同

2）如果在两个 rset 中都没有找到共同的记录...那么我会将它保留在相应行（在 rset2 中）的位置（在 rset1 中）*[意思是 rset2 中的记录 rset1 中没有对应的记录]*

它总是确保 tht no: of records in rset2 > tht in rset1 ...

你能帮助如何在 VB6.0 中对齐记录集中的记录，因为我将这些记录集绑定到 Excel 以并排显示？

VB6.0中的任何内置方法（进行对齐或任何操作）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T11:30:02.467

VB6 中没有 inbuild 方法可以做到这一点（我不知道），但是，自己做很容易。

你需要做的是创建两个错误的记录列表，一旦你有了它们，你可以随心所欲地把它们吐出来（到 csv 文件，到 excel，到 ms 访问）。警告：记录集必须按主键排序才能工作。

此代码按顺序遍历两个记录集，创建带有空白或链接到记录的有序列表（虽然它看起来很像 VB 代码，但认为这是伪代码，逻辑正确，它不会编译）

```
Dim rs1 As Recordset
Dim rs2 As Recordset

Dim rs1List As Collection
Dim rs2List As Collection

REM code here to initialise the collections to new Collection and fill the record sets

Do While Not rs1.EOF And Not rs2.EOF
    If rs1("PKey") = rs2("PKey") Then
        rs1List.Add rs1.Bookmark
        rs2List.Add rs2.Bookmark
        rs1.Movenext
        rs2.Movenext
    ElseIf rs1("PKey") < rs2("PKey") Then
        rs1List.Add rs1.Bookmark
        rs2List.Add Nothing
        rs1.Movenext
    ElseIf rs1("PKey") > rs2("PKey") Then
        rs1List.Add Nothing
        rs2List.Add rs2.Bookmark
        rs2.Movenext
    End If
Loop
Do While Not rs2.EOF
    rs1List.Add Nothing
    rs2List.Add rs2.Bookmark
    rs2.Movenext
Loop
Do While Not rs1.EOF
    rs1List.Add rs1.Bookmark
    rs2List.Add Nothing 
    rs1.Movenext
Loop 
```

假设主键字段是 PKey，并且 .Bookmark 是一种您可以用来直接转到该记录的方法（如果可用，可以使用序数位置）。

希望这可以帮助

**编辑**

只是在最后两个循环中更改了一些位，它们不太正确。

# c# - 在不可变类型的构造函数中生成 HashCode

> ID：910149
> 
> 赞同：2
> 
> 时间：2009-05-26T11:10:51.243
> 
> 标签：c#, .net, constructor

我对不可变类型的 HashCode 有一些疑问。

*   我可以在构造函数中“预”生成不可变类型的 HashCode，还是有任何理由不这样做？
*   当调用 GetHashCode() 方法时，我是否应该总是再次生成哈希码？

这是一个示例类：

```
 public class Id  {

        private readonly object _value;

        private readonly int _hash = -1;

        public Id( object value ) {
          _value = value;
          _hash = ( int ) ( 7 * value.GetType().GetHashCode() + 7 + 7 * _value.GetHashCode() );
        }

        public object Value {
          get {
            return _value;
          }
        }

        public override int GetHashCode() {
          return _hash;
        }

        public override bool Equals( object obj ) {
          Id other = obj as Id;

          if ( other == null ) {
            return false;
          }

          return this.GetHashCode() == other.GetHashCode();
        }
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T11:17:03.663

您可以预先生成哈希码，但为什么呢？只需在需要时生成它（在 中`GetHashCode`）然后可能存储它 - 大多数对象从不需要哈希，所以它只会减慢程序的速度。

> 当调用 GetHashCode() 方法时，我是否应该总是再次生成哈希码？

不可变对象的哈希码应该始终相同，因此无论您再次生成它还是存储它都不应该有任何影响，除非存储会提高性能。

注意：您不应该`Equals`通过比较 HashCodes 来定义 - 两个不同的对象*可能*具有相同的 HashCodes（哈希冲突）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T12:20:06.313

这实际上取决于用例。

你经常使用哈希吗？然后预生成它，因为对象是不可变的，每次计算它都是不必要的，因为结果总是相同的。

哈希不是用的很多吗？然后不要预先生成它，因为它会不必要地减慢程序的速度，计算可能不会使用的哈希。

第三种（在我看来也是最好的）选项是在 GetHashCode 中计算哈希并缓存结果，只计算一次哈希，之后每次都返回这个缓存的哈希。这样一来，就不会在从未使用过的哈希值上花费时间，也不会在每次调用 GetHashCode 时都进行不必要的计算。尽管这确实意味着内存用于在对象中存储散列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T11:15:19.643

不预生成的原因：它减慢了对象的创建速度。

总是重新生成的原因：您节省了保留哈希码所需的存储空间。

作为记录，我可能会预先计算哈希码并将其存储为不可变对象*，除非*分析显示它很昂贵并且我不经常访问该值。

# python - Python MemoryError - 我如何强制删除对象

> ID：910153
> 
> 赞同：0
> 
> 时间：2009-05-26T11:11:40.787
> 
> 标签：python, memory, resources, garbage-collection

我有一个处理多个文件的程序，并为每个文件生成一个报告。报告生成部分是一个单独的函数，它接受一个文件名，然后返回。在报告生成期间，中间部分缓存在内存中，因为它们可能用于报告的多个部分，以避免重新计算。

当我对目录中的所有文件运行此程序时，它会运行一段时间，然后因 MemoryError 而崩溃。如果我然后在同一目录上重新运行它，它将跳过它成功为其创建报​​告的所有文件，然后继续。它将在再次崩溃之前处理几个文件。

现在，为什么在生成报告的方法调用之后没有清除所有资源，或者至少标记为垃圾回收？没有实例离开，我没有使用任何全局对象，并且在每次文件处理之后，所有打开的文件都被关闭。

有没有办法让我验证没有对对象的额外引用？有没有办法在 Python 中强制进行垃圾收集？

关于实现和缓存的更多细节。每个报告中都有几个元素，然后每个元素可以依赖于不同的计算，每个计算可以依赖于其他计算。如果一个计算已经完成，我不想再做一次（其中大部分都很昂贵）。

这是缓存中的缩写版本：

```
class MathCache:
    def __init__(self): self.cache = {}
    def get(data_provider):
        if not data_provider.id in self.cache:
            self.cache[data_provider.id] = data_provider.get_value(self)
        return self.cache[data_provider.id] 
```

创建它的一个实例，然后将其传递给报表中的每个元素。此实例仅保存在报表创建方法中的本地引用中。

所有 data_providers 都继承自一个公共类，该类用于根据构造函数参数和类名的哈希值为实例创建一个唯一的 id。我传递了 MathCache，因为 data_provider 本身可能依赖于其他计算。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T11:13:21.470

您应该查看 gc 模块：[http](http://docs.python.org/library/gc.html#module-gc) ://docs.python.org/library/gc.html#module-gc 。

# java - 可以使用反射访问方法变量吗？

> ID：910155
> 
> 赞同：2
> 
> 时间：2009-05-26T11:11:49.447
> 
> 标签：java, reflection

如何使用反射访问方法内定义的变量？

我必须在 Hibernate 中创建标准。数据库是基于属性的。

考虑一部电影。一部电影可以有多种语言和多种类型。例如

```
Movieid           Property           Value
1                 Language           Hindi
1                 Language           English
1                 genre              action
2                 genre              comedy 
```

假设有一千条不同电影的记录。用户选择一组流派（动作）和语言（印地语、英语）来过滤结果。现在，我必须按以下顺序创建标准：表达式 =（属性 = 英语和流派 = 动作）或（属性 = 印地语和流派 = 动作）

对于实现，我必须查找在 for 循环条件中定义的局部变量。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-26T11:13:04.670

你不能。如果它是在方法中定义的，那么它是否只是在该范围内定义的局部变量。由于该方法在其范围之外没有任何状态，因此您无权访问。

访问一个类成员（根据定义，它是一个状态），您可以[通过“常规”反射访问](http://java.sun.com/docs/books/tutorial/reflect/member/fieldValues.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T00:16:09.467

我猜这些电影的数据存储在 RDBMS 中。只需执行一个简单的关系查询即可准确获得您需要的结果。这个问题是人们开发关系数据库管理系统的一个完美例子。

# asp.net-mvc - 使用 LINQ 的多个或单个存储库

> ID：910156
> 
> 赞同：8
> 
> 时间：2009-05-26T11:12:05.653
> 
> 标签：asp.net-mvc, linq, tdd

我一直在阅读 Professional ASP.NET MVC 1.0 书中的第 11 章（可测试的设计模式）。在本章的示例中，数据访问被拆分为多个存储库：IOrderRepository、IProductRepository 等。这一切都很有意义：单个存储库用于单个数据类。

但是，当您考虑表格之间的链接时，这对我来说有点崩溃：订单包含许多产品。当订单类由 LINQ-to-SQL 创建时，订单类将有一个 Products 集合，该集合枚举与该订单相关的所有产品。因此，通过使用这个集合，我们绕过了 ProductsRepository。

因此，在模拟时，我不仅要模拟 OrderRepository 和 ProductRepository，还必须在返回的 Order 对象中填充 Products 集合。这意味着模拟的 OrderRepository 必须知道模拟的 ProductsRepository 等等。

忽略 LINQ 为我创建的这些集合似乎是一种浪费，所以我的问题是，在这种情况下，单个存储库不是更有意义吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T11:38:07.990

您的问题描述是一个典型的教科书示例，当太多关于“这很好，那很糟糕”的废话成为开发人员按照其创建方式创建软件而不是查看手头问题并创建软件来解决该问题的原因时.

恰当的例子：您的问题描述不是您要解决的问题：您要为您的客户创建一个应用程序，这是您应该解决的问题。如果您选择的工具让您的生活变得艰难，那就把它们踢出去并使用有效的方法：如果模拟不起作用，为什么还要麻烦？哦，因为有人说如果你不模拟你的软件会很烂？为什么？

您在这里和那里收集了一些 DDD 内容，但是您错过了一些重要部分： Product 是聚合根。这意味着您应该从它自己的存储库中获取产品。是的，这减轻了模型中的导航功能，但这对您来说是 DDD，如果您严格按照 Evans 书中第二部分的规定创建存储库。但是……你应该吗？

如果您无法回答为什么 Product 有自己的存储库，但您可以从 Order 导航到产品，那么您不应该为聚合根创建存储库。为什么那个存储库在那里？如果它在那里，它不应该是获得产品的唯一点吗？（所以也不要通过延迟加载！）。

这确实会产生很多开销和您可能不需要的代码（具有讽刺意味的是，YAGNI 完全有效）。

好了，废话不多说。DDD 是关于**思考**的。所以领域应该驱动设计，通过实践，你会得到一个代表现实的领域模型。这并不是说您应该仅仅因为您阅读了应该阅读的地方就应该实现大量代码。相反，如果您已经识别了域元素、聚合根等，那么您必须将这些类型的行为放在某个地方，例如在域类中。您可以将获取逻辑放在单独的类中，例如订单存储库中的面向订单的获取逻辑，但它不会是严格意义上的存储库（例如，它没有自己的本地缓存等）。这还不错，这完全取决于您应该为客户创建什么。

所以，第一：想，第二：想，第三：再想。什么对你来说似乎是合乎逻辑的。列出您拥有的选项的优缺点，然后选择最适合您的选项。记录该选择以及您选择该选择而不是替代方案的原因。与其他任何来源相比，这给维护者带来了更多价值：您记录替代方案以及为什么不选择它们，您研究什么对您有用，然后您选择了一个。

软件工程并不难，只是现在似乎很流行先做后想，没有适当的推理***为什么***要那样做而不是那样做。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T05:54:52.443

Other factors to consider include the likely lifespan of the product and the likelihood of having to change from LINQ-to-SQL to some other O/R mapper at any point in the lifetime. The smaller the project, the less critical the product, the less you need to worry about abstracting minutae to the nth degree.

# ruby-on-rails - 使用 has_many 时找到给定两个实体的连接模型的最简单方法是什么：通过

> ID：910163
> 
> 赞同：3
> 
> 时间：2009-05-26T11:13:23.983
> 
> 标签：ruby-on-rails

我`has_many :through`用来指定两个实体之间的多对多关联，并且我希望能够轻松地从连接表中检索模型。以下是主要实体：

```
class Group < ActiveRecord::Base
    has_many :memberships
    has_many :members, :through => :memberships
end 

class Member < ActiveRecord::Base
    has_many :memberships
    has_many :groups, :through => :memberships
end 
```

联接表称为“memberships”，并具有附加属性“admin”，表示用户可以充当该组的组管理员。这是迁移代码段：

```
create_table :memberships do |t|
  t.integer :group_id
  t.integer :member_id
  t.boolean :admin

  t.timestamps
end 
```

现在，在我的控制器中，我想检查特定成员是否是组的管理员。我目前有以下代码（有效）：

```
membership = @member.memberships.find_by_group_id(@group.id) 
```

我的问题：有没有比使用`find_by_group_id`助手更优雅的方法来检索连接对象（成员资格）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T19:20:12.610

你可以问：

```
 @member.is_admin?(@group) 
```

像这样的东西。

```
 class Member < ActiveRecord::Base

    has_many :memberships
    has_many :groups, :through => :memberships

    def is_admin?(group)
      memberships.find_by_group_id(group.id).admin?
    end

  end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T01:51:12.307

避免使用辅助方法，您可以编写：

```
 @member.admin?(@group) 
```

with something like this (untested!).

```
 class Member < ActiveRecord::Base

    has_many :memberships
    has_many :groups, :through => :memberships
    named_scope :admin?, :through => :memberships, 
    lambda {|group|:conditions=> ["admin = 'true' and group_id = ?"], group.id }
  end 
```

# java - 想用Struts2开发JasperReport

> ID：910167
> 
> 赞同：2
> 
> 时间：2009-05-26T11:15:38.067
> 
> 标签：java, struts2, jasper-reports

我正在使用`Spring`, `Struts2`&开发项目`Hibernate`。

现在我想使用`JasperReport`with `Struts2`。

但我对`JasperReport`.

任何人都可以给出简单的例子或教程或任何其他可以帮助我的链接..

提前谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T11:21:48.490

我认为任何 jasper-report 教程都会对你有好处。Struts2 不会对您如何生成 JasperReport 产生太大影响。

您可能想看看“流结果”：

[http://struts.apache.org/2.x/docs/stream-result.html](http://struts.apache.org/2.x/docs/stream-result.html)

**编辑：** 我刚找到这个，我认为这就是你要找的： http: [//struts.apache.org/2.x/docs/jasperreports-plugin.html](http://struts.apache.org/2.x/docs/jasperreports-plugin.html) [http://struts.apache.org/2。 x/docs/jasperreports-tutorial.html](http://struts.apache.org/2.x/docs/jasperreports-tutorial.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-08T15:07:03.690

我们在项目中使用 Struts2、Spring 和 Hibernate。Jasper Reports 有两种方法，它们都使用 Struts2-Jasper 插件

1.  使用 Hiberate 检索要放入报告中的对象列表。我们尽量避免这种技术，因为报告不可移植，并强制报告在与您的应用程序相同的 JVM 中生成。

2.  我们在 JRXML 中使用嵌入式 SQL。我们认为这是一种更好的方法，因为最终我们可以将 JRXML 上传到专用的 JasperServer。在 Struts 2.1.x 之前，这很难实现，因为没有办法将连接传递给 JRXML。以下是关于如何将 Jasper Report 与嵌入式 SQL 与 Struts 2 集成的教程

[http://yellow-jbox.blogspot.com/2011/04/jasper-report-with-embedded-sql-using.html](http://yellow-jbox.blogspot.com/2011/04/jasper-report-with-embedded-sql-using.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:28:08.923

Tahir 提到的教程应该可以帮助您。我想我早在 Webwork 时代就写了这种方式的第一个版本。其工作方式是将您的操作的属性作为可迭代类型并将其用作 Jasper 数据源。这样您就可以报告您的操作，而不是针对数据库。我写这个是为了让我们能够针对没有报告工具的 Versant 对象数据库进行报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-12T17:33:55.430

Stuts2 中有一个 jasper 报告插件，只需使用该插件即可。该插件将提供开始在 Struts2 中开发 Jasper 报告所需的所有基本基础架构

# jquery - 从控制器返回 PartialView 和 Javascript

> ID：910168
> 
> 赞同：1
> 
> 时间：2009-05-26T11:15:59.953
> 
> 标签：jquery, asp.net-mvc

我看到这里有一个问题[，](https://stackoverflow.com/questions/756797/returning-a-partialview-with-both-html-and-javascript)但没有明确的答案。有谁知道如何使用 Javascript 或 JSON 返回 PartialView。我正在做一个 AJAX 帖子，成功后它会呈现 PartialView，但随后需要运行一些 javascript 或检查 JSON 结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:22:58.317

```
public static string RenderPartialToString(string controlName, object viewData, object model, System.Web.Routing.RequestContext viewContext)
            {

                ViewDataDictionary vd = new ViewDataDictionary(viewData);
                ViewPage vp = new ViewPage { ViewData = vd };

                vp.ViewData = vd;
                vp.ViewData.Model = model;
                vp.ViewContext = new ViewContext();
                vp.Url = new UrlHelper(viewContext);

                Control control = vp.LoadControl(controlName);

                vp.Controls.Add(control);

                StringBuilder sb = new StringBuilder();

                using (StringWriter sw = new StringWriter(sb))
                {

                    using (HtmlTextWriter tw = new HtmlTextWriter(sw))
                    {

                        vp.RenderControl(tw);

                    }

                }

                return sb.ToString();

            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T11:20:44.060

我认为为另一个问题提供的答案可能是您的最佳选择。您不能突然拥有另一个`onSuccess`方法签名，其中另一个参数与 JSON 对象一起添加，因此您只能使用一个返回对象。从逻辑上讲，该对象必须同时包含您的视图和 JSON 对象，这意味着对象本身必须是 JSON 对象。

# python - 在 Django Admin 中调整字段大小

> ID：910169
> 
> 赞同：121
> 
> 时间：2009-05-26T11:16:16.443
> 
> 标签：python, django, django-models, django-admin

Django 在管理员上添加或编辑条目时往往会填满水平空间，但在某些情况下，当编辑一个 8 个字符宽的日期字段或一个同样为 6 或 8 个字符的字段时，这是一种真正的空间浪费字符宽，然后编辑框增加到 15 或 20 个字符。

如何告诉管理员文本框的宽度或 TextField 编辑框的高度？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2009-11-16T19:24:46.610

您应该使用[ModelAdmin.formfield_overrides](http://docs.djangoproject.com/en/dev/ref/contrib/admin/)。

这很容易 - 在`admin.py`，定义：

```
from django.forms import TextInput, Textarea
from django.db import models

class YourModelAdmin(admin.ModelAdmin):
    formfield_overrides = {
        models.CharField: {'widget': TextInput(attrs={'size':'20'})},
        models.TextField: {'widget': Textarea(attrs={'rows':4, 'cols':40})},
    }

admin.site.register(YourModel, YourModelAdmin) 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-26T17:57:49.063

[您可以使用小部件的“attrs”](http://docs.djangoproject.com/en/dev/ref/forms/widgets/#django.forms.Widget.attrs)属性在小部件上设置任意 HTML 属性。

您可以在 Django 管理员中使用 formfield_for_dbfield 执行此操作：

```
class MyModelAdmin(admin.ModelAdmin):
  def formfield_for_dbfield(self, db_field, **kwargs):
    field = super(ContentAdmin, self).formfield_for_dbfield(db_field, **kwargs)
    if db_field.name == 'somefield':
      field.widget.attrs['class'] = 'someclass ' + field.widget.attrs.get('class', '')
    return field 
```

或使用自定义 Widget 子类和[formfield_overrides 字典](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_overrides)：

```
class DifferentlySizedTextarea(forms.Textarea):
  def __init__(self, *args, **kwargs):
    attrs = kwargs.setdefault('attrs', {})
    attrs.setdefault('cols', 80)
    attrs.setdefault('rows', 5)
    super(DifferentlySizedTextarea, self).__init__(*args, **kwargs)

class MyModelAdmin(admin.ModelAdmin):
  formfield_overrides = { models.TextField: {'widget': DifferentlySizedTextarea}} 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2014-02-13T21:56:18.820

**更改特定字段的宽度。**

通过[ModelAdmin.get_form 制作](https://docs.djangoproject.com/en/1.5/ref/contrib/admin/#django.contrib.admin.ModelAdmin.get_form)：

```
class YourModelAdmin(admin.ModelAdmin):
    def get_form(self, request, obj=None, **kwargs):
        form = super(YourModelAdmin, self).get_form(request, obj, **kwargs)
        form.base_fields['myfield'].widget.attrs['style'] = 'width: 45em;'
        return form 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-05-26T20:45:00.973

一个快速而肮脏的选择是简单地为有问题的模型提供一个自定义模板。

如果您创建一个名为的模板`admin/<app label>/<class name>/change_form.html`，那么管理员将使用该模板而不是默认模板。也就是说，如果您有一个名为`Person`的应用程序中的模型`people`，您将创建一个名为 的模板`admin/people/person/change_form.html`。

所有管理模板都有一个`extrahead`块，您可以覆盖以`<head>`在`id_<field-name>`.

因此，您可以在模板中添加以下内容：

```
{% extends "admin/change_form.html" %}

{% block extrahead %}
  {{ block.super }}
  <style type="text/css">
    #id_my_field { width: 100px; }
  </style>
{% endblock %} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-27T01:36:50.417

如果要更改每个字段实例的属性，可以将“attrs”属性直接添加到表单条目中。

例如：

```
class BlogPostForm(forms.ModelForm):
    title = forms.CharField(label='Title:', max_length=128)
    body = forms.CharField(label='Post:', max_length=2000, 
        widget=forms.Textarea(attrs={'rows':'5', 'cols': '5'}))

    class Meta:
        model = BlogPost
        fields = ('title', 'body') 
```

“attrs”属性基本上传递了将调整表单字段的 HTML 标记。每个条目都是您想要覆盖的属性和您想要覆盖它的值的元组。只要用逗号分隔每个元组，就可以输入任意数量的属性。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-08-09T17:58:57.723

我发现的最好方法是这样的：

```
class NotificationForm(forms.ModelForm):
    def __init__(self, *args, **kwargs): 
        super(NotificationForm, self).__init__(*args, **kwargs)
        self.fields['content'].widget.attrs['cols'] = 80
        self.fields['content'].widget.attrs['rows'] = 15
        self.fields['title'].widget.attrs['size'] = 50
    class Meta:
        model = Notification 
```

对于 ModelForm 来说，它比使用不同的小部件覆盖字段要好得多，因为它保留了属性`name`和`help_text`模型字段的默认值，因此您不必将它们复制到表单中。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2010-01-26T09:11:02.200

您始终可以在自定义样式表中设置字段大小，并告诉 Django 将其用于您的 ModelAdmin 类：

```
class MyModelAdmin(ModelAdmin):
    class Media:
        css = {"all": ("my_stylesheet.css",)} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-01-26T02:48:20.093

我对 TextField 有类似的问题。我正在使用 Django 1.0.2 并想更改关联文本区域中“行”的默认值。此版本中不存在 formfield_overrides。覆盖 formfield_for_dbfield 有效，但我必须为我的每个 ModelAdmin 子类都这样做，否则会导致递归错误。最终，我发现将下面的代码添加到 models.py 中是可行的：

```
from django.forms import Textarea

class MyTextField(models.TextField):
#A more reasonably sized textarea                                                                                                            
    def formfield(self, **kwargs):
         kwargs.update(
            {"widget": Textarea(attrs={'rows':2, 'cols':80})}
         )
         return super(MyTextField, self).formfield(**kwargs) 
```

然后在定义模型时使用 MyTextField 而不是 TextField。我将它从[这个答案](https://stackoverflow.com/questions/430592/djang-admin-charfield-as-textarea/430652#430652)改编为类似的问题。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-09-02T15:02:06.667

[Django FAQ](http://code.djangoproject.com/wiki/NewformsHOWTO#Q:HowdoIchangetheattributesforawidgetonafieldinmymodel.)中有很好的描述：

**问：**如何更改模型中字段上的小部件的属性？

**A：**覆盖 ModelAdmin/StackedInline/TabularInline 类中的 formfield_for_dbfield

```
class MyOtherModelInline(admin.StackedInline):
    model = MyOtherModel
    extra = 1

    def formfield_for_dbfield(self, db_field, **kwargs):
        # This method will turn all TextFields into giant TextFields
        if isinstance(db_field, models.TextField):
            return forms.CharField(widget=forms.Textarea(attrs={'cols': 130, 'rows':30, 'class': 'docx'}))
        return super(MyOtherModelInline, self).formfield_for_dbfield(db_field, **kwargs) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-27T02:10:18.593

对于 1.6，使用表单我必须在 charfield 内指定 textarea 的属性：

```
test1 = forms.CharField(max_length=400, widget=forms.Textarea( attrs={'rows':'2', 'cols': '10'}),  initial='', help_text=helptexts.helptxt['test']) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-01-29T09:44:15.203

这是一个简单但灵活的解决方案。使用自定义表单来覆盖一些小部件。

```
# models.py
class Elephant(models.Model):
    name = models.CharField(max_length=25)
    age = models.IntegerField()

# forms.py
class ElephantForm(forms.ModelForm):

    class Meta:
        widgets = {
            'age': forms.TextInput(attrs={'size': 3}),
        }

# admin.py
@admin.register(Elephant)
class ElephantAdmin(admin.ModelAdmin):
    form = ElephantForm 
```

给出的小部件`ElephantForm`将替换默认小部件。键是字段的字符串表示形式。表单中未指定的字段将使用默认小部件。

请注意，虽然`age`是一个`IntegerField`我们可以使用`TextInput`小部件，因为与 , 不同`NumberInput`，`TextInput`接受`size`属性。

此解决方案[在本文](http://blogs.harvard.edu/rprasad/2011/08/31/django-admin-resizing-form-fields-for-tabularinline/)中进行了描述。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-12-18T15:04:13.820

与 msdin 相同的答案，但使用 TextInput 而不是 TextArea：

```
from django.forms import TextInput

class ShortTextField(models.TextField):
    def formfield(self, **kwargs):
         kwargs.update(
            {"widget": TextInput(attrs={'size': 10})}
         )
         return super(ShortTextField, self).formfield(**kwargs) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-28T18:27:26.137

如果您正在使用涉及选项/选项/下拉菜单的 ForeignKey 字段，则可以`formfield_for_foreignkey`在 Admin 实例中覆盖：

```
class YourNewAdmin(admin.ModelAdmin):
    ...

    def formfield_for_foreignkey(self, db_field, request, **kwargs):
        if db_field.name == 'your_fk_field':
            """ For your FK field of choice, override the dropdown style """
            kwargs["widget"] = django.forms.widgets.Select(attrs={
                'style': 'width: 250px;'
            })

        return super().formfield_for_foreignkey(db_field, request, **kwargs) 
```

有关此模式的更多信息，请[点击此处](http://books.agiliq.com/projects/django-admin-cookbook/en/latest/filter_fk_dropdown.html)和[此处](http://books.agiliq.com/projects/django-admin-cookbook/en/latest/fk_display.html)。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2019-05-09T10:24:58.180

还有一个例子：

```
class SecenekInline(admin.TabularInline):
   model = Secenek
   # classes = ['collapse']
   def formfield_for_dbfield(self, db_field, **kwargs):
       field = super(SecenekInline, self).formfield_for_dbfield(db_field, **kwargs)
       if db_field.name == 'harf':
           field.widget = TextInput(attrs={'size':2})
       return field
   formfield_overrides = {
       models.TextField: {'widget': Textarea(attrs={'rows':2})},
   }
   extra = 2 
```

如果您只想编辑特定的字段大小，可以使用它。

# c++ - 跟踪 C++ 内存分配

> ID：910172
> 
> 赞同：51
> 
> 时间：2009-05-26T11:16:58.810
> 
> 标签：c++, windows, memory-management, visualization

我正在寻找一种方法来跟踪 C++ 程序中的内存分配。我对内存泄漏*不*感兴趣，这似乎是大多数工具试图找到的，而是为应用程序创建内存使用配置文件。理想的输出将是函数名称的大列表加上随时间变化的最大分配字节数，或者更好的是，随时间变化的堆的图形表示。横轴是时间，纵轴是堆空间。每个函数都会根据分配的堆字节获得自己的颜色并绘制线条。用于识别分配的对象类型的奖励积分也是如此。

这个想法是找到内存瓶颈/可视化哪些函数/线程消耗最多的内存，应该针对进一步优化。

我简要地查看了 Purify、BoundsChecker 和 AQTime，但它们似乎不是我所追求的。Valgrind 看起来很合适，但是，我在 Windows 上。[Memtrack](http://www.almostinfinite.com/memtrack.html)看起来很有希望，但需要对源代码进行重大更改。

我的谷歌技能一定让我失望了，因为这似乎不是一个不常见的请求？创建这样一个工具所需的所有信息都应该可以从程序的调试符号和运行时 API 调用中轻松获得——不是吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-26T11:55:02.057

使用 Valgrind 及其工具 Massif。它的示例输出（它的一部分）：

```
99.48% (20,000B) (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
->49.74% (10,000B) 0x804841A: main (example.c:20)
| 
->39.79% (8,000B) 0x80483C2: g (example.c:5)
| ->19.90% (4,000B) 0x80483E2: f (example.c:11)
| | ->19.90% (4,000B) 0x8048431: main (example.c:23)
| |   
| ->19.90% (4,000B) 0x8048436: main (example.c:25)
|   
->09.95% (2,000B) 0x80483DA: f (example.c:10)
  ->09.95% (2,000B) 0x8048431: main (example.c:23) 
```

因此，您将获得详细信息：

*   WHO分配了内存（上面例子中的函数：g()、f()和main()）；您还可以获得导致分配功能的完整回溯，
*   内存确实去了哪个数据结构（上例中没有数据结构），
*   发生的时候，
*   它是所有已分配内存的百分比（g：39.7%，f：9.95%，main：49.7%）。

这是[Massif 手册](http://valgrind.org/docs/manual/ms-manual.html)

您可以跟踪堆分配以及堆栈分配（默认关闭）。

**PS。我刚刚读到你在 Windows 上。不过，我会留下答案，因为它给出了您可以从可能的工具中获得什么的图片。**

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-26T11:35:40.397

Microsoft 有据可查的内存跟踪功能。但是，由于某种原因，它们在开发者社区中并不是很有名。这些是 CRT 调试功能。良好的起点将是[CRT 调试堆函数](https://docs.microsoft.com/en-us/visualstudio/debugger/crt-debug-heap-details)。

检查以下链接以获取更多详细信息

1.  [堆状态报告函数](https://docs.microsoft.com/en-us/visualstudio/debugger/crt-debug-heap-details#BKMK_Heap_State_Reporting_Functions)
2.  [跟踪堆分配请求](https://docs.microsoft.com/en-us/visualstudio/debugger/crt-debug-heap-details#BKMK_Track_Heap_Allocation_Requests)。可能这就是您正在寻找的功能。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-26T16:04:29.963

对于通用 C++ 内存跟踪器，您需要重载以下内容：

```
global operator new
global operator new []
global operator delete
global operator delete []
any class allocators
any in-place allocators 
```

棘手的一点是获得有用的信息，重载的运算符只有分配器的大小信息和删除的内存指针。一种答案是使用宏。我知道。讨厌。一个示例 - 放置在所有源文件中包含的标头中：

```
#undef new

void *operator new (size_t size, char *file, int line, char *function);
// other operators

#define new new (__FILE__, __LINE__, __FUNCTION__) 
```

并创建一个源文件：

```
void *operator new (size_t size, char *file, int line, char *function)
{
  // add tracking code here...
  return malloc (size);
} 
```

仅当您没有在类范围内定义任何 operator new 时，上述内容才有效。如果您确实有一些在课堂范围内，请执行以下操作：

```
#define NEW new (__FILE__, __LINE__, __FUNCTION__) 
```

并将“新类型”替换为“新类型”，但这可能需要更改大量代码。

由于它是一个宏，因此删除内存跟踪器非常简单，标题变为：

```
#if defined ENABLED_MEMORY_TRACKER
#undef new

void *operator new (size_t size, char *file, int line, char *function);
// other operators

#define NEW new (__FILE__, __LINE__, __FUNCTION__)
#else
#define NEW new
#endif 
```

和实现文件：

```
#if defined ENABLED_MEMORY_TRACKER
void *operator new (size_t size, char *file, int line, char *function)
{
  // add tracking code here...
  return malloc (size);
}
endif 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-06-28T22:40:59.343

**更新：** @Skizz 的回答

从 C++20 开始，我们可以使用[std::source_location](https://en.cppreference.com/w/cpp/utility/source_location)代替宏`__FILE__`和`__LINE__`.

（由于这是一个重大的简化，我相信它值得单独回答）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-22T02:37:35.503

在 Xcode 上，您可以使用 Instruments 来跟踪分配、VM 使用情况和其他几个参数。最受 iOS 开发人员欢迎，但值得一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T15:41:26.673

在 Mac OS X 上，您可以使用代码分析工具 Shark 来执行此操作，IIRC。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-26T14:13:06.130

Visual Studio IDE 具有内置的堆分析支持（自 2015 年以来），这可能是最容易开始的。它具有随时间变化的堆使用情况的图形视图，并且可以按函数/方法跟踪分配。

*   [在 Visual Studio 中测量内存使用情况](https://github.com/MicrosoftDocs/visualstudio-docs/blob/master/docs/profiling/memory-usage.md)

![堆分析](https://raw.githubusercontent.com/MicrosoftDocs/visualstudio-docs/master/docs/profiling/media/diagnostictools-update1.png)

CRT 还具有调试和配置文件支持，更详细和更底层。您可以使用其他工具跟踪数据并绘制结果：

*   [CRT 调试堆详细信息](https://docs.microsoft.com/en-us/visualstudio/debugger/crt-debug-heap-details?view=vs-2019)

特别是看`_CrtMemCheckpoint`和相关的功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-05T11:39:46.090

“堆随时间变化的图形表示” - 接近您正在寻找的内容是在[Intel(R) Single Event API](https://github.com/01org/IntelSEAPI/wiki)中实现的，可以在[本文](http://www.codeproject.com/Tips/1055834/Cross-platform-Visual-Memory-Tracker)中找到详细信息（放在这里相当大）。[![随着时间的推移内存块分配](https://i.stack.imgur.com/G2pEx.png)](https://i.stack.imgur.com/G2pEx.png)

它向您显示每个块大小分配的时间线，并允许向您的代码添加额外的标记以更好地理解整个画面。

# sql - 每天有多少兆字节是每纳秒两个半字节？

> ID：910176
> 
> 赞同：-1
> 
> 时间：2009-05-26T11:18:29.043
> 
> 标签：sql, database, capacity-planning

我的 SQL 数据库中的一张表的增长率为每纳秒两个半字节。我想知道每天有多少兆字节，我应该担心吗？我的硬盘是 150 GB。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-26T11:21:23.780

Wolfram Alpha 来救援！

[http://www61.wolframalpha.com/input/?i=How+many+megabytes+per+day+are+two+nibbles+per+nanosecond%3F](http://www61.wolframalpha.com/input/?i=How+many+megabytes+per+day+are+two+nibbles+per+nanosecond%3F)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T11:21:12.267

两个半字节 == 一个字节。每秒 1,000,000,000 字节，或每秒 953 兆字节。

假设您的硬盘无法快速写入。如果可以的话，它会在 3 分钟内充满。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T11:22:02.390

谷歌说：每纳秒 1 个半字节 = 每秒 476.837158 兆字节

换句话说：是的，确实非常担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-20T21:20:27.593

[http://www.wolframalpha.com/input/?i=two+nibbles+per+nanosecond+in+terabytes+per+day+and+two+nibbles+per+nanosecond+in+megabytes+per+day](http://www.wolframalpha.com/input/?i=two+nibbles+per+nanosecond+in+terabytes+per+day+and+two+nibbles+per+nanosecond+in+megabytes+per+day)

有了这个值，您可以更好地想象如此庞大的数据量......

# maven-2 - maven, ant 插件, antrun:run

> ID：910177
> 
> 赞同：8
> 
> 时间：2009-05-26T11:18:39.243
> 
> 标签：maven-2, ant, maven-plugin

执行“mvn antrun:run”时，我的任务没有运行。我有一个回显任务，但没有显示输出。运行任务绑定的阶段时，它们确实被执行了。

如何从命令行专门执行任务？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T19:51:39.193

假设这样的东西被添加到你的 pom.xml

```
<build>
   <plugins>
       <plugin>
          <artifactId>maven-antrun-plugin</artifactId>
          <executions>
            <execution>
              <phase>package</phase><!--Change this to control when it runs -->
              <configuration>
                <tasks>
            <echo  message="Hello, maven"/>
                </tasks>
              </configuration>
              <goals>
                <goal>run</goal><!-- this is to call antrun:run -->
              </goals>
            </execution>
          </executions>
        </plugin>
     </plugins>
  </build> 
```

执行`mvn package`将在您的控制台上产生以下结果

```
[INFO] [antrun:run {execution: default}]
[INFO] Executing tasks
     [echo] Hello, maven
[INFO] Executed tasks 
```

您可以更改`phase`以让您的 ant 脚本在您需要的任何时候运行。

# iphone - NSNumber 超出范围？

> ID：910186
> 
> 赞同：1
> 
> 时间：2009-05-26T11:21:26.603
> 
> 标签：iphone, objective-c, cocoa, memory-management, nsnumber

我已经编写了一个 Objective-C 类，并且在我的 iPhone 项目中的多个视图中使用了它的共享实例。它的成员变量包括 bools、ints、NSStrings 和一个 NSNumber。共享实例似乎在我的应用程序范围内工作得很好，除了调试器告诉我的 NSNumber 在第二次或后续访问共享实例后“超出范围”。

这是我正在做的事情的快速概述......

```
// UserData.h
@interface UserData : NSObject {
    TaxYears selectedTaxYear;
    NSNumber *grossWage; // <--- this is the troublesome member

// ...

    NSString *other;
    int age;

}
+ (UserData *)getSharedUserData;

@end

// UserData.m
#import "UserData.h"

@implementation UserData

static UserData *sharedUserData = nil;  // Points to the shared object

+ (UserData *)getSharedUserData {
    if(sharedUserData == nil) {
        sharedUserData = [[UserData alloc] initWithTaxYear:0];
        [[NSNotificationCenter defaultCenter]
         addObserver:sharedUserData
         selector:@selector(doTerminate:)
         name:UIApplicationWillTerminateNotification
         object:nil];
    }
    return sharedUserData;
}

- (id)initWithTaxYear:(TaxYears)theTaxYear {
    if ((self = [super init])) {

    }
    return self;
}
- (void)updateGrossWage:(NSNumber *)theGrossWage {
    grossWage = theGrossWage;
}
- (NSNumber *)getGrossWage {
    return grossWage;
}
// ...
@end 
```

所以它可以在一个视图中访问，如下所示：

```
UserData *userData
userData = [[UserData getSharedUserData] retain]; 
```

在另一个视图中以同样的方式。但是第二次访问它时，grossWage 成员超出了范围，但其他一切都很好——这就是我难过的原因。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T11:48:30.370

为什么要手动编写`grossWage`访问器（`updateGrossWage`和`getGrossWage`）？你确定你只是想简单地分配给定的总工资而不是保留或复制它吗？这样，当调用者摆脱他的总工资实例时，您最终将在`userData`对象中释放总工资：

```
NSNumber grossWage = [[NSNumber numberWithInt:12] retain];
[userData updateGrossWage:grossWage];
[grossWage release];
// Now userData’s grossWage points to released object. 
```

这可能是问题的原因。如果没有，我建议发布一小段完整的示例代码——没有通知内容和调用上下文。

* * *

PS 像您这样的共享对象`UserData`通常不利于您的设计（= 导致代码痛苦），例如，参见Miško Hevery 的[这篇文章和他博客上的其他文章。](http://misko.hevery.com/code-reviewers-guide/flaw-brittle-global-state-singletons/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T12:58:29.417

您遇到问题的原因不是因为您应该或不应该使用属性，而是因为您没有遵循内存管理规则。NSNumber 是一个对象，应该保留在您的设置器中。将其更改为属性将解决直接问题，因为 Objective-C 正在为您处理工作，但您仍应查看内存管理，因为它 100% 确定您将继续遇到问题，直到您对它感到满意为止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T12:08:34.090

跟进@zoul的观点......

我会声明 GrossWage 是一个属性，并合成 getter 和 setter。我认为二传手是你问题的根源。

```
// in UserData.h
@interface UserData : NSObject {
    NSNumber *grossWage; 
}

@property (nonatomic, retain) NSNumber *grossWage; 

// in UserData.m
#import "UserData.h"

@implementation UserData
@synthesize grossWage;

// then do NOT create getters and setters for grossWage 
```

看看这是否清除它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T13:49:35.977

这听起来很愚蠢，但检查除以零。我有同样的错误，原因是除以零。

# java - 在 JComboBox.addItem(o) 中禁用 HTML 解析

> ID：910191
> 
> 赞同：0
> 
> 时间：2009-05-26T11:22:43.963
> 
> 标签：java, attributes, jcombobox

我正在寻找一种方法来禁用 JComboBox() 中 addItem() 方法的 HTML 解析。

```
JComboBox jHighlight = new JComboBox();
for (int i = 0; i < tl.size(); i++) {
     //getTagname() returns a string like "br", "a", "body" or "html"
     jHighlight.addItem("<" + tl.get(i).getTagname() + ">");
} 
```

JComboBox 中的输出将如下所示：

```
<a>
<br>
<body>
         //notice the blank space where <html> should be
<link>
<meta> 
```

所以问题是html标签被解析了，因为我在它前面添加了一个<符号，我该如何解决这个问题？我尝试改用“\u003C”，但它仍然解析为 html，并且标签没有显示在列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T11:36:30.177

我相信以下两种说法中的任何一种都可以做到：

```
highlight.putClientProperty("html.disable", true);  

highlight.putClientProperty(
    javax.swing.plaf.basic.BasicHTML.propertyKey, null
); 
```

如果您在某个中心位置创建和配置组件，您可能需要考虑为所有人设置它。组件支持中的 HTML 文本设计不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T11:25:11.557

使用“<” 而不是“<” 并且（也许）将其包装在 HTML 中。;)

```
<html>&lt;html></html> 
```

# blackberry - 黑莓模拟器“fileconn.dir.photos”的位置？

> ID：910192
> 
> 赞同：0
> 
> 时间：2009-05-26T11:22:58.957
> 
> 标签：blackberry, filesystems, rim-4.2

我在 BlackBerry JDE 4.2.0 和它附带的 8100 模拟器上遇到了一个奇怪的问题：

```
String path = System.getProperty("fileconn.dir.photos"); 
```

这将返回 null！

这适用于我迄今为止使用过的所有 J2ME 电话和仿真器。为了让它在黑莓模拟器上运行，我需要做些什么特别的事情吗？请注意，我不想要 SD 卡图像路径，而是手机的内部存储。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:38:20.507

不幸的是，它不是运行 4.2 的 BlackBerry 设备上支持/实现的属性。从 4.3 开始，它在平台的更高版本中得到完全支持和外部可用。

# msmq - 更改 BizTalk MSMQ 接收适配器上的轮询间隔

> ID：910200
> 
> 赞同：1
> 
> 时间：2009-05-26T11:25:57.110
> 
> 标签：msmq, biztalk, polling

是否有一些设置会影响 BizTalk MSMQ 接收适配器中的轮询间隔？

我已经阅读了 Professional BizTalk 2006 中*“这设置为 1/2 秒且不可配置”*的部分，但我的测试盒上的延迟似乎约为 10 秒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:03:36.370

似乎无法为 MSMQ 接收适配器配置轮询间隔。

关于 10 秒的轮询延迟，运行适配器的主机/主机实例是否可能负载过重，因此延迟？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T09:53:33.960

似乎减少了延迟的是将 Batch 大小减少到 1

# crystal-reports - 水晶报表数据库

> ID：910201
> 
> 赞同：0
> 
> 时间：2009-05-26T11:27:22.380
> 
> 标签：crystal-reports

我将我的数据库存储在我的应用程序的 APP_DATA 文件夹中。

我在我的应用程序中添加了水晶报告。我提到 .\SQLEXPRESS 作为我的服务器。

在数据库下拉列表中，我只看到这些数据库 -Master、Model、msdb、tempdb

我的数据库名称是 "Database.mdf" 。为什么我看不到它？

我的连接字符串是：Data Source=.\SQLEXPRESS ;AttachDbFilename=C:\Inetpub\ wwwroot\test\ App_Data\ Database。mdf;综合安全=真；User Instance=True 我正在使用本地主机。VS 2005 .NET 2.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T15:42:41.343

这是一篇较旧的帖子（以 SO 术语），但我想无论如何我都会对一些你可以尝试的事情发表评论。

首先是连接到 SQL Server 数据库时，您不必在配置连接字符串中包含 AttachDBFilename。如果数据库附加到本地 SQLEXPRESS 实例，那么您应该能够以这种方式引用它。您应该在连接字符串中包含“initial catalog=[your database name]”，以便它知道要查看哪个数据库。

另外不要放文件名的绝对路径，如果你要按文件名连接，我相信你可以放“|DataDirectory|” 它指的是 App_Data 文件夹。因此，该部分看起来像“AttachDbFilename=|DataDirectory|\Datbase.mdf”。

我相信你现在已经解决了这个问题，但如果没有，那么我希望这会有所帮助。

# linq - LINQ 查询返回的 int 列表

> ID：910202
> 
> 赞同：2
> 
> 时间：2009-05-26T11:28:12.173
> 
> 标签：linq

我有一张具有 ID 和其他属性的表。

如何通过该表上的 LINQ 查询获取 ID**的 int列表？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T11:32:19.047

使用 Select 方法将结果投影为不同的格式：

```
var myList = myTable.Select(t => t.ID).ToList(); 
```

应该这样做，注意您还可以使用更类似于 SQL 的语法：

```
var myList = (from t in myTable
             select t.ID).ToList(); 
```

编辑：

另请注意，这是 C# 语法，如果您需要不同的语法，则需要说明您使用的是哪种语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T11:31:05.973

尝试

```
var list = from b 
           in MyDataContext.Table
           select b.ID 
```

# windows - 任何网站都提供与 Windows Server 的 Slice 主机相同的服务？

> ID：910204
> 
> 赞同：1
> 
> 时间：2009-05-26T11:28:34.297
> 
> 标签：windows, hosting, dedicated-hosting

是否可以在 Slicehost 和 Linode 上使用类似于 Linux 托管的选项来托管 Windows Server 2003？需要设置几个月的测试服务器，看看是否可以为 MS Exchange Server 创建插件。

我需要一些图形远程访问，自然会尽可能降低成本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T11:32:16.113

搜索 Windows VPS，你会发现很多。您可以找到每月 30 美元以下的计划。我记得 VPSLand 有这样的计划。

另一个想法是使用 Amazon EC2。它是按需提供的，因此您按使用小时计费。您可以在需要时启动实例，并在完成后将其关闭。

# asp.net - CS0016: 目录无效错误

> ID：910208
> 
> 赞同：3
> 
> 时间：2009-05-26T11:29:54.760
> 
> 标签：asp.net, windows, security, filesystems

在编译 ASP.NET 网站时，我一直在努力追查一个神秘的错误。错误是（非常有名的）CS0016：“无法写入输出文件 [文件名] - 目录无效”。

经过两天的调试，我发现我的问题的原因是 NetworkService 在某种程度上没有对 C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET 文件的必要权限。我已经添加了对该文件夹具有完全权限的“所有人” - 但我仍然无法访问`http://localhost`，并且我可以使用 SysInternals 的进程监视器看到 NetworkService 帐户在尝试在其中创建 DLL 文件时获得“未找到名称”目录。我的解释是它对文件夹没有足够的权限。

但是 - 当我启动 Visual Studio 并附加调试器时，文件是使用我的域用户（JohnDoe 供参考）编译的，并且由于某种原因效果很好 - 好像域用户帐户包含比我无法提供的更多权限我机器上的本地用户 - 这让我很困惑。

我给你们的两个问题是：为什么当我将具有完全权限的“所有人”添加到文件夹时，NetworkService 仍然没有创建所需临时文件所需的权限？我的 JohnDoe 域用户拥有哪些我无法在我的机器上授予本地用户的权限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T11:41:40.383

您需要授予 NetworkService 权限到您的系统临时目录（临时变量中的目录）。这是因为临时 asp.net 文件在被移动到 ASP.NET Temporary Internet Files 目录之前首先被写入此临时文件夹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T12:18:01.793

事实证明，我有一个 TEMP 环境变量指向一个不再存在的 RAM 驱动器......它与提到的用户问题毫无关系。经验教训：用户和系统都有 TEMP 变量！！！那里有两个！！！我已经想到了这种情况并为用户更改了变量 - 但我错过了有关系统的变量。不知何故，计算机将临时文件写入它无法访问的驱动器上的文件夹有点困难......

Ø"#¤/(%"/#¤%"(/=("(!§##§¤%"!#!"!!

结案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-02T02:50:59.257

这几天我在一个新客户那里遇到了这个问题。我使用的是 VMWare 映像，指向共享上的源代码。我给了用户“每个人”的完全访问权限，但仍然是 gettign 问题。

由于我将共享复制到 VM 磁盘，还没有出现问题（到目前为止只尝试了几次，但看到一致的成功与我之前遇到的一致失败）。VS2005 和 VS2008 都发生了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-27T09:15:21.857

在我的情况下，错误是由运行 ASP.NET 应用程序的帐户的 TEMP 和 TMP 环境变量指向不存在的目录引起的。

# .net - 如何在 WindowsForms DataGridView 中禁用单元格文本的省略号？

> ID：910210
> 
> 赞同：6
> 
> 时间：2009-05-26T11:30:11.047
> 
> 标签：.net, winforms, datagridview, ellipsis

我在 .NET 3.5 (Visual Studio 2008) WinForms 应用程序中有一个只读模式的 DataGridView。

单元格的宽度非常小。一些单元格包含一个短数字。现在，即使使用小字体，有时数字也会用省略号显示。例如*"8..."*而不是*"88"*。

有没有办法让文本流过标准 DataGridView 中的下一个单元格并避免省略号？

*谢谢！*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-23T23:36:34.850

在设计器中更改 DataGridView 属性 "RowDefaultCellStyle" -> 设置 "Wrap Mode" = "true"

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-12T11:03:51.513

处理 DataGridView 控件的 CellPainting 事件。检查以下链接：

[http://msdn.microsoft.com/en-us/library/hta8z9sz.aspx](http://msdn.microsoft.com/en-us/library/hta8z9sz.aspx)

请注意，当您绘制文本本身时，您需要自定义 StringFormat -

引用 MSDN 代码：

```
if (e.Value != null)
{
    e.Graphics.DrawString((String)e.Value, e.CellStyle.Font,
                    Brushes.Crimson, e.CellBounds.X + 2,
                    e.CellBounds.Y + 2, StringFormat.GenericDefault);
} 
```

使用以下 StringFormat 对象而不是 StringFormat.GenericDefault ：

```
StringFormat strFormat = new StringFormat();
strFormat.Trimming = StringTrimming.None; 
```

问候

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-14T17:03:56.333

我发现 KD2ND 在这里给出的解决方案并不令人满意。对于如此小的变化完全重新实现单元格绘制似乎很愚蠢 - 处理列标题和选定行的绘制也需要大量工作。幸运的是，有一个更简洁的解决方案：

```
// you can also handle the CellPainting event for the grid rather than 
// creating a grid subclass as I have done here.
protected override void OnCellPainting(DataGridViewCellPaintingEventArgs e)
{
    var isSelected = e.State.HasFlag(DataGridViewElementStates.Selected);

    e.Paint(e.ClipBounds, DataGridViewPaintParts.Background
        //| DataGridViewPaintParts.Border
        //| DataGridViewPaintParts.ContentBackground
        //| DataGridViewPaintParts.ContentForeground
        | DataGridViewPaintParts.ErrorIcon
        | DataGridViewPaintParts.Focus
        | DataGridViewPaintParts.SelectionBackground);

    using (Brush foreBrush = new SolidBrush(e.CellStyle.ForeColor),
        selectedForeBrush = new SolidBrush(e.CellStyle.SelectionForeColor))
    {
        if (e.Value != null)
        {
            StringFormat strFormat = new StringFormat();
            strFormat.Trimming = StringTrimming.Character;
            var brush = isSelected ? selectedForeBrush : foreBrush;

            var fs = e.Graphics.MeasureString((string)e.Value, e.CellStyle.Font);
            var topPos= e.CellBounds.Top + ((e.CellBounds.Height - fs.Height) / 2);

            // I found that the cell text is drawn in the wrong position
            // for the first cell in the column header row, hence the 4px
            // adjustment
            var leftPos= e.CellBounds.X;
            if (e.RowIndex == -1 && e.ColumnIndex == 0) leftPos+= 4;

            e.Graphics.DrawString((String)e.Value, e.CellStyle.Font,
                brush, leftPos, topPos, strFormat);
        }
    }

    e.Paint(e.ClipBounds, DataGridViewPaintParts.Border);
    e.Handled = true;
} 
```

The trick is to let the existing `Paint method handle the painting of most of the cell. We only handle painting the text. The border is painted after the text because I found that otherwise, the text would sometimes be painted over the border, which looks bad.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T11:50:08.307

不，可能有一些属性可以禁用省略号（如果您访问底层控件），但标准 DataGridView 不支持流过（以及单元格合并）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-06T08:02:26.730

一个可能对您有用的简单技术就是为有问题的单元格打开 WrapMode

# c++ - 需要可预测的随机发生器

> ID：910215
> 
> 赞同：152
> 
> 时间：2009-05-26T11:31:40.420
> 
> 标签：c++, algorithm, random

我是一名网络游戏开发人员，我遇到了随机数问题。假设一个玩家有 20% 的机会用他的剑造成致命一击。这意味着，五分之一的命中应该是关键的。问题是我在现实生活中得到了非常糟糕的结果——有时玩家在 5 次命中中得到 3 个暴击，有时在 15 次命中中没有。战斗时间很短（3-10 次命中），因此获得良好的随机分布很重要。

目前我使用 PHP `mt_rand()`，但我们只是将代码转移到 C++，所以我想在我们游戏的新引擎中解决这个问题。

我不知道解决方案是否是一些统一的随机生成器，或者可能要记住以前的随机状态以强制正确分布。

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2009-05-26T12:00:55.650

> 这意味着，五分之一的命中应该是关键的。问题是我在现实生活中得到了非常糟糕的结果——有时玩家在 5 次点击中获得 3 个暴击，有时在 15 次点击中没有。

你需要的是一个[洗牌包](https://web.archive.org/web/20150324141028/http://kaioa.com/node/53)。它解决了真随机对于游戏来说太随机的问题。

算法大概是这样的：你把 1 个重击和 4 个非重击放在一个袋子里。然后你将它们在袋子里的顺序随机化，一次挑出一个。当袋子是空的时，你再次用相同的值填充它并随机化它。这样，您将平均每 5 次命中获得 1 次重击，并且连续最多 2 次重击和 8 次非重击。增加包中物品的数量以获得更多随机性。

这是我前段时间编写的[一个实现](http://github.com/orfjackal/puzzle-warrior/blob/6a0455993984f5f2a9b617d7587c360393524e44/src/main/java/net/orfjackal/puzzlewarrior/ShuffleBag.java)（Java 语言）[及其测试用例的示例。](http://github.com/orfjackal/puzzle-warrior/blob/6a0455993984f5f2a9b617d7587c360393524e44/src/test/java/net/orfjackal/puzzlewarrior/ShuffleBagSpec.java)

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2009-05-26T11:42:33.003

您对随机的含义有误解。

其中哪个更随机？

[![在此处输入图像描述](https://i.stack.imgur.com/JKsPW.png)](https://i.stack.imgur.com/JKsPW.png) [![在此处输入图像描述](https://i.stack.imgur.com/re18S.png)](https://i.stack.imgur.com/re18S.png)

虽然第二个图看起来分布更均匀，但实际上第一个图更*随机。*人类大脑经常看到随机模式，所以我们将第一个图中的团块视为模式，但它们不是 - 它们只是随机选择的样本的一部分。

* * *

## 回答 #3

> 赞同：90
> 
> 时间：2009-05-26T11:45:40.843

鉴于您要求的行为，我认为您正在随机化错误的变量。

*与其随机化这次*命中是否会是致命的，不如尝试随机化轮数直到下一次致命一击发生。例如，每次玩家获得关键点时，只需在 2 和 9 之间选择一个数字，然后在多轮过去后给他们下一个关键点。您还可以使用骰子方法来接近正态分布——例如，您将在 2D4 回合中获得下一个临界值。

我相信这种技术也可以用于在主世界中随机遭遇的 RPG 中——你随机化一个计步器，然后在这么多步之后，你又被击中了。这感觉更公平，因为你几乎不会被连续两次遭遇击中——如果这种情况发生一次，玩家就会变得烦躁。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2009-05-26T11:34:41.147

首先，定义“适当的”分布。随机数是随机的——你看到的结果与（伪）随机性完全一致。

对此进行扩展，我假设您想要的是某种“公平”的感觉，因此用户不能在没有成功的情况下转 100 圈。如果是这样，我会跟踪自上次成功以来的失败次数，并对生成的结果进行加权。假设您希望五分之一的卷“成功”。所以你随机生成一个从 1 到 5 的数字，如果是 5，那就太好了。

如果不是，记录失败，下一次，生成一个从 1 到 5 的数字，但添加例如 floor(numFailures / 2)。所以这一次，他们有五分之一的机会。如果他们失败了，下次获胜间隔是4*和*5；5 分之二的成功机会。有了这些选择，8次失败后，他们一定会成功。

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2009-05-26T18:06:01.327

我同意早期的答案，即在某些游戏的小运行中真正的随机性是不可取的——这对于某些用例来说似乎太不公平了。

我在 Ruby 中编写了一个类似 Shuffle Bag 的简单实现并进行了一些测试。实现是这样做的：

*   如果它仍然看起来很公平，或者我们没有达到最小掷骰的阈值，它会根据正常概率返回一个公平的命中。
*   如果从过去的掷骰中观察到的概率使它看起来不公平，它会返回一个“公平化”的命中。

基于边界概率，它被认为是不公平的。例如，对于 20% 的概率，您可以将 10% 设置为下限，将 40% 设置为上限。

使用这些界限，我发现运行 10 次命中时，**14.2% 的时间真正的伪随机实现产生的结果超出了这些界限**。大约 11% 的情况下，在 10 次尝试中得分为 0 次重击。3.3% 的时间，10 次重击中有 5 次或更多次命中。自然地，使用这种算法（最小掷骰数为 5），“Fairish”运行的数量（0.03%）少得多。 . 即使下面的实现不合适（当然可以做更聪明的事情），值得注意的是，您的用户通常会觉得真正的伪随机解决方案是不公平的。

这是我`FairishBag`用 Ruby 编写的内容。此处提供了整个实现和快速蒙特卡罗模拟[（要点）](http://gist.github.com/118194)。

```
def fire!
  hit = if @rolls >= @min_rolls && observed_probability > @unfair_high
    false
  elsif @rolls >= @min_rolls && observed_probability < @unfair_low
    true
  else
    rand <= @probability
  end
  @hits += 1 if hit
  @rolls += 1
  return hit
end

def observed_probability
  @hits.to_f / @rolls
end 
```

**更新：**使用此方法确实会增加获得致命一击的总体概率，使用上述界限将其提高到大约 22%。您可以通过将其“真实”概率设置得低一点来抵消这一点。17.5% 的概率与公平的修改产生了大约 20% 的观察到的长期概率，并保持短期运行感觉公平。

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2009-05-26T11:39:55.350

用这样的东西替换 mt_rand() 怎么样？

![XKCD 漫画（RFC 1149.5 将 4 指定为标准 IEEE 审查的随机数。）](https://imgs.xkcd.com/comics/random_number.png)

*（RFC 1149.5 将 4 指定为标准 IEEE 审查的随机数。）*

来自[XKCD](http://xkcd.com/221/)。

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2009-05-26T11:58:53.783

希望本文对您有所帮助： [http ://web.archive.org/web/20090103063439/http://www.gamedev.net:80/reference/design/features/randomness/](http://web.archive.org/web/20090103063439/http://www.gamedev.net:80/reference/design/features/randomness/)

这种生成“随机数”的方法在 rpg/mmorpg 游戏中很常见。

它解决的问题是这个（摘录）：

> 一只刀片蜘蛛在你的喉咙里。它命中了，你错过了。它再次击中，你又错过了。一次又一次，直到你没有任何东西可以击中。你死了，还有一条重达 2 吨的蜘蛛在你的尸体上幸灾乐祸。不可能的？不，不可能？是的。但只要有足够多的球员和足够的时间，不可能的事情就变得几乎可以确定了。不是刀刃蜘蛛硬，只是运气不好。多么令人沮丧。足以让玩家想要退出。

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2009-05-26T12:32:46.567

你想要的不是随机数，而是对人类来说似乎随机的数字。其他人已经建议了可以帮助您的个别算法，例如 Shuffle Bag。

有关该领域的详细和广泛的分析，请参阅[AI Game Programming Wisdom 2](http://www.aiwisdom.com/bookshelf_aiwisdom2.html)。整本书值得任何游戏开发者阅读，“看似随机数”的概念在章节中处理：

**人工智能决策和游戏逻辑的过滤随机性**：

> 摘要：传统观点认为，随机数生成器越好，您的游戏就越难以预测。然而，根据心理学研究，短期内真正的随机性在人类看来往往是绝对不随机的。本文展示了如何让随机 AI 决策和游戏逻辑在玩家看来更加随机，同时仍保持强大的统计随机性。

您可能还会发现另一章有趣：

**随机数统计**

> 摘要：随机数在人工智能和游戏中使用最多。忽视他们的潜力会使游戏变得可预测和无聊。错误地使用它们可能与完全忽略它们一样糟糕。了解随机数是如何生成的、它们的局限性和能力，可以消除在游戏中使用它们的许多困难。本文提供了对随机数、它们的生成以及区分好坏的方法的见解。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-05-26T11:37:20.860

当然，任何随机数生成都有机会产生这样的运行吗？您不会在 3-10 卷中获得足够大的样本集来查看适当的百分比。

也许你想要的是一个怜悯阈值......记住最后 10 次掷骰，如果他们没有重击，给他们一个免费赠品。消除随机性的吊索和箭头。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-05-26T11:38:09.580

您最好的解决方案可能是使用多种不同的**非**随机方案进行游戏测试，然后选择让玩家最开心的方案。

您也可以在给定的遭遇中尝试对相同数字的退避策略，例如，如果玩家`1`在第一轮投掷了 a，则接受它。要获得另一个`1`，他们需要`1`连续滚动 2 秒。要获得三分之一`1`，他们需要连续 3 个，无止境。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-05-26T11:36:11.940

不幸的是，您所要求的实际上是一个非随机数生成器 - 因为您希望在确定下一个数字时考虑以前的结果。恐怕这不是随机数生成器的工作方式。

如果您希望每 5 次命中中有 1 次是关键，那么只需在 1 到 5 之间选择一个数字并说该命中将是关键。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2009-05-26T11:47:11.170

mt_rand() 基于[Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_twister)实现，这意味着它产生了您可以获得的最佳随机分布之一。

显然你想要的根本不是随机性，所以你应该开始明确指定你想要的。您可能会意识到您有相互矛盾的期望——结果应该是真正随机的并且不可预测，但同时它们不应该表现出与所述概率的局部变化——但随后它就变得可预测了。如果您连续设置最多 10 个非暴击，那么您只是告诉玩家“如果您连续有 9 个非暴击，那么下一个将是 100% 确定的关键”——您可能会这样完全不用担心随机性。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-05-26T11:38:04.603

在如此少量的测试中，您应该期望得到这样的结果：

真正的随机性只能在一个巨大的集合大小上预测，因此很有可能第一次掷硬币并连续 3 次正面朝上，但是超过几百万次翻转你最终会得到大约 50-50 次。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-05-26T14:24:23.253

我看到很多答案建议跟踪先前生成的数字或对所有可能的值进行洗牌。

就个人而言，我不同意，连续 3 次暴击很糟糕。我也不同意连续 15 次非暴击是不好的。

我会通过在每个数字之后自己修改暴击机会来解决这个问题。示例（演示这个想法）：

```
int base_chance = 20;
int current_chance = base_chance;

int hit = generate_random_number(0, 100) + 1; // anything from 1 to 100
if(hit < current_chance)//Or whatever method you use to check
{
    //crit!
    if(current_chance > base_chance)
        current_chance = base_chance; // reset the chance.
    else
        current_chance *= 0.8; // decrease the crit chance for the NEXT hit.
}
else
{
    //no crit.
    if(current_chance < base_chance)
        current_chance = base_chance; // reset the chance.
    else
        current_chance *= 1.1; // increase the crit chance for the NEXT hit.
    //raise the current_chance
} 
```

您没有获得暴击的时间越长 - 您的下一个动作暴击的机会就越高。我包含的重置是完全可选的，它需要测试来判断它是否需要。在较长的非暴击动作链之后，可能需要也可能不希望为连续的多个动作提供更高的暴击概率。

只需投入我的2美分...

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2009-05-27T05:36:58.033

前几个答案是很好的解释，所以我将只关注一种算法，它可以让你控制“坏条纹”的概率，同时*永远不会*变得确定。这是我认为你应该做的：

代替指定*p*，伯努利分布的参数，即您的重击概率，指定*a*和*b*，beta 分布的参数，伯努利分布的“共轭先验”。您需要跟踪*A*和*B*，到目前为止的关键和非关键命中数。

现在，要指定*a*和*b*，请确保 a/(a+b) = p，即重击的机会。巧妙的是 (a+b) 量化了您希望 A/(A+B) 通常与 p 的接近程度。

你做你的采样是这样的：

让`p(x)`是贝塔分布的概率密度函数。它在许多地方都可用，但您可以在 GSL 中以 gsl_ran_beta_pdf 的形式找到它。

```
S = A+B+1
p_1 = p((A+1)/S)
p_2 = p(A/S) 
```

通过从概率为 p_1 / (p_1 + p_2) 的伯努利分布中采样来选择重击

如果你发现随机数有太多“坏条纹”，放大*a*和*b*，但在极限情况下，当*a*和*b*趋于无穷大时，你就会有前面描述的 shuffle bag 方法。

如果你实现了这个，请告诉我它是怎么回事！

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-05-27T09:05:56.223

如果您想要一个不鼓励重复值的分布，您可以使用简单的重复拒绝算法。

例如

```
int GetRand(int nSize)
{
    return 1 + (::rand() % nSize);
}
int GetDice()
{
    static int nPrevious=-1;
    while (1) {
        int nValue = GetRand(6);
        // only allow repeat 5% of the time
        if (nValue==nPrevious && GetRand(100)<95)
            continue;
        nPrevious = nValue;
        return nValue;
    }
} 
```

此代码在 95% 的情况下拒绝重复值，使得重复不太可能但并非不可能。从统计上看，它有点难看，但它可能会产生你想要的结果。当然，它不会阻止像“5 4 5 4 5”这样的分布。你可以变得更漂亮，拒绝倒数第二个（比如说）60% 的时间和倒数第三个（比如说）30% 的时间。

我不建议将其作为良好的游戏设计。简单地建议如何实现你想要的。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-05-26T11:44:29.833

目前还不清楚你想要什么。可以创建一个函数，使您调用它的前 5 次，它以随机顺序返回数字 1-5。

但这并不是随机的。玩家将知道他将在接下来的 5 次攻击中恰好得到一个 5。不过，这可能是您想要的，在这种情况下，您只需自己编写代码即可。（创建一个包含数字的数组，然后将它们打乱）

或者，您可以继续使用当前的方法，并假设您当前的结果是由于随机生成器错误造成的。请注意，您当前的数字可能没有任何问题。随机值是随机的。有时您会连续获得 2、3 或 8 个相同值。因为它们是随机的。一个好的随机生成器只是保证平均而言，所有数字都将被同样频繁地返回。

当然，如果你一直在使用一个糟糕的随机生成器，那可能会扭曲你的结果，如果是这样，只需切换到一个更好的随机生成器就可以解决问题。（查看 Boost.Random 库以获得更好的生成器）

或者，您可以记住随机函数返回的最后 N 个值，并通过这些值对结果进行加权。（一个简单的例子是，“对于新结果的每次出现，我们有 50% 的机会应该丢弃该值并获得一个新结果”

如果我不得不猜测，我会说坚持“实际”随机性是你最好的选择。确保你使用了一个好的随机生成器，然后继续你现在做的方式。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-05-26T11:47:38.937

您可以创建一个包含从 1 到 5 的数字的列表，并让它们按随机性排序。然后只需浏览您创建的列表。您可以保证每个号码至少跑一次...当您完成前 5 个号码时，只需再创建 5 个号码...

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-05-27T14:56:57.747

好吧，如果你有点数学，你可以尝试[指数分布](http://en.wikipedia.org/wiki/Exponential_distribution)

例如，如果 lambda = 0.5，则预期值为 2（去阅读那篇文章！），这意味着您很可能每 2 回合就会击中/暴击/其他任何东西（比如 50%，对吧？）。但是在这样的概率分布下，你会在第 0 回合（事件已经发生并且 turn_counter 已重置的那个回合）明确地错过（或做任何相反的事情），有大约 40% 的机会击中下一回合，大约 65%有机会在第 2 回合（下一个之后）进行，大约 80% 可以打到第 3 回合，依此类推。

该分布的全部目的是，如果一个人有 50% 的命中率并且他连续 3 次未命中，那么他肯定会（嗯，超过 80% 的机会，并且每下一轮都会增加）命中。它会导致更“公平”的结果，保持 50% 的总体几率不变。

以 20% 的几率暴击，你有

*   17% 暴击第一回合
*   32% 到第 2 回合暴击，如果之前的所有暴击都没有发生。
*   45% 到第 3 回合暴击，如果之前的所有暴击都没有发生。
*   54% 到第 4 回合暴击，如果之前的所有暴击都没有发生。
*   ...
*   80% 到第 8 回合暴击，如果之前的所有暴击都没有发生。

在随后的 5 个回合中，3 个暴击 + 2 个非暴击的几率仍然约为 0.2%（相对于 5%）。并且有 14% 的几率出现​​ 4 次非暴击，5% 的 5 次，1.5% 的 6 次，0.3% 的 7 次，0.07% 的 8 次后续的非暴击。我敢打赌，它比 41%、32%、26%、21% 和 16% “更公平”。

希望你还没有无聊到死。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2009-05-27T19:05:32.113

我推荐暴雪使用的累进百分比系统：http: [//www.shacknews.com/onearticle.x/57886](http://www.shacknews.com/onearticle.x/57886)

通常，您滚动 RNG，然后将其与一个值进行比较以确定是否成功。这可能看起来像：

```
if ( randNumber <= .2 ) {
   //Critical
} else {
   //Normal
} 
```

您需要做的就是逐步增加基本机会...

```
if (randNumber <= .2 + progressiveChance ) {
   progressiveChance = 0;
   //Critical
} else {
   progressiveChance += CHANCE_MODIFIER;
   //Normal hit
} 
```

如果您需要它更花哨，添加更多内容很容易。您可以限制progressiveChance 可以获得的数量以避免100% 的致命机会或在某些事件上重置它。您还可以通过诸如progressiveChance += (1 -progressiveChance) * SCALE 之类的方式以较小的量增加progressiveChance，其中SCALE < 1。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-05-26T12:21:03.847

如何使关键的机会取决于最后的 N 次攻击。一种简单的方案是某种马尔可夫链：[http](http://en.wikipedia.org/wiki/Markov_chain) ://en.wikipedia.org/wiki/Markov_chain但无论如何代码都非常简单。

```
 IF turns_since_last_critical < M THEN 
   critial = false
   turns_since_last_critical++;
ELSE
   critial = IsCritical(chance);
   IF Critial THEN
       turns_since_last_critica = 0;
   ELSE
       turns_since_last_critica++;
   END IF;
END IF; 
```

当然，您必须进行数学运算，因为一旦您知道自上一次以来已经有足够的转数，出现批判的机会就会低于出现批判的机会

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-05-26T13:19:19.750

操作，

几乎，如果你希望它是公平的，它不会是随机的。

您的游戏的问题是实际匹配长度。比赛时间越长，您看到的随机性就越少（暴击率往往为 20%）并且它会接近您的预期值。

你有两个选择，根据之前的掷骰预先计算攻击。每5次攻击你会得到一个暴击（基于你的20％），但你可以让它发生的顺序随机。

listOfFollowingAttacks = {命中，命中，命中，未命中，暴击}；

这就是你想要的模式。所以让它从那个列表中随机选择，直到它为空，他们重新创建它。

这是我为我的游戏创建的模式，它运行良好，可以满足我的需求。

您的第二个选择是，增加暴击的机会，您可能会在所有攻击结束时看到一个更偶数（假设您的比赛结束得相当快）。机会百分比越少，您获得的 RNG 就越多。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-05-27T21:41:27.820

当您可能需要正态分布时，您正在查看线性分布。

如果您还记得年轻时玩 D&D 时，您被要求掷多个 n 面骰子，然后将结果相加。

例如，滚动 4 x 6 面骰子不同于滚动 1 x 24 面骰子。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2009-05-27T22:31:32.493

![替代文字](https://i.stack.imgur.com/IXs3g.gif)

这个真的是可以预测的……但你永远无法确定。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2009-07-27T18:12:00.410

《英雄之城》实际上有一个名为“streakbreaker”的机制可以解决这个问题。它的工作方式是在一串长度与字符串中最低命中概率相关的未命中字符串之后，保证下一次攻击是命中。例如，如果您错过了一次命中率超过 90% 的攻击，那么您的下一次攻击将自动命中，但如果您的命中率低于 60%，那么您将需要连续多次未命中才能触发“连胜”（我不知道具体数字）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-26T11:34:45.420

如何权衡价值？

例如，如果您有 20% 的几率发生重击，则生成一个介于 1 和 5 之间的数字，其中一个数字表示重击，或者生成一个介于 1 和 100 之间的数字，其中 20 个数字表示重击。

但是，只要您使用随机数或伪随机数，就无法避免您当前看到的结果。这是随机性的本质。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-05-26T12:01:07.770

**预先计算每个**玩家的随机暴击。

```
// OBJECT
//...
// OnAttack()
//...
c_h = c_h -1;
if ( c_h == 0 ) {
 // Yes, critical hit!
 c_h = random(5) + 1 // for the next time
 // ...
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-05-26T12:40:11.250

反应：“问题是我在现实生活中得到了非常糟糕的结果——有时玩家在 5 次安打中得到 3 次暴击，有时在 15 次安打中没有。”

在 15 次点击中，您有 3% 到 4% 的机会一无所获……

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-05-26T13:00:16.170

我会提出以下“随机延迟的回退”：

*   维护两个数组，一个 ( `in-array`) 最初填充从 0 到 n-1 的值，另一个 ( `out-array`) 为空
*   请求结果时：
    *   *从所有定义*的值中返回一个随机值`in-array`
    *   将此值从移动`in-array`到`out-array`
    *   将一个随机（在*所有*元素上，包括未定义的！）元素从`out-array`后面移到`in-array`

*这具有这样的特性，即n*越大，“反应”就越慢。例如，如果您想要 20% 的机会，将*n*设置为 5 并命中 0 比将*n*设置为 10 并命中 0 或 1 并使其从 0 到 199 出 1000 几乎是“随机性”与小样本的真正随机性无法区分。您必须将*n*调整为您的样本量。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-05-27T09:34:12.797

我想也许你使用了错误的随机分布函数。您可能不希望在数字上均匀分布。尝试使用正态分布，以使重击变得比“常规”命中更罕见。

我使用 Java，所以我不确定你在哪里可以找到 C++ 的东西，它可以为你提供具有正态分布的随机数，但必须有一些东西在那里。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-05-27T14:52:13.090

正如许多人所说，这确实是“随机”的问题。你得到的结果是随机的，无论你如何制作游戏，一些玩家都会觉得你的计数器不公平，不随机。;)

一种可能的选择可能是保证每 n 次命中一次，并在每次命中后在特定边界内随机生成 n。这都是关于在游戏测试中“感觉”正确的问题。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-05-27T20:42:20.153

这就是它应该的样子，它是概率，你不应该期望每 5 场战斗有 1 次致命一击......用硬币或骰子尝试一下，自己看看。但这只是我。国标

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-05-29T15:16:07.147

我也尝试过解决这个问题。我能想到的最好的办法是动态地改变概率，如果数字基于它们在过去出现的频率。类似的东西（对于骰子，在 matlab 中）：

```
probabilities = [1 1 1 1 1 1];
unrandomness = 1;
while true
    cumprob = cumsum(probabilities) ./ sum(probabilities);
    roll = find(cumprob >= rand, 1)
    probabilities = probabilities + unrandomness;
    probabilities(roll) = probabilities(roll) - 6*unrandomness;
    if min(probabilities) < 0
        probabilities = probabilities - min(probabilities);
    end
end 
```

抱歉缺少缩进。可以根据需要调整非随机性参数。真正的随机输出（非随机性=0）：

2 3 1 1 4 1 3 3 4 5 1 5 5 2 6 1 1 1 6 1 1 3 5 6 6 1 4 2 4 6 3 6 5 1 1 6 2 5 6 4 3 5 2 4 6 5 5 5 4 4 3 4 1 2

非随机性=1：

3 2 4 5 6 2 6 2 4 1 5 5 1 6 4 3 1 4 2 1 3 2 6 5 3 6 5 3 1 4 1 6 5 3 4 2 1 6 5 4 1 4 3 1 6 6 5 4 3 1 5 2 3 2

我觉得更好看。特别是如果您绘制数字之间的差距。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-06-10T15:59:39.353

我认为您需要从泊松分布中生成随机数。

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2009-05-31T16:34:24.973

[bozo sort](http://en.wikipedia.org/wiki/Bogosort#Bozo_sort)的问题，它有可能永远解决。

* * *

## 回答 #36

> 赞同：-2
> 
> 时间：2009-05-26T11:37:50.547

对于 C++ 随机数生成器，使用[rand](http://www.cplusplus.com/reference/clibrary/cstdlib/rand/)或[boost::random](http://www.boost.org/doc/libs/1_39_0/libs/random/index.html)

每当玩家被击中时，您只需检查 [0; 中是否有随机数；1] 小于 0.2。这意味着某人无法在 15 次内获得暴击，但这是不可能的。

这将根据[二项分布](http://en.wikipedia.org/wiki/Binomial_distribution)定律为您提供自然随机数（p = 0.2）

* * *

## 回答 #37

> 赞同：-4
> 
> 时间：2009-05-26T11:52:25.307

```
static int crit = 0;

public bool isCritical()
{
   crit = crit++ % 5;
   return (crit==0);
} 
```

如果您仍然想要一些随机性，请在每次执行暴击时使用另一个静态变量更改模数。将其从 3 更改为 7 的概率应保持 5 比 1 的平均暴击时间，但它们之间的命中次数不得少于 3 次或超过 7 次。

# python - 虚拟主机上的 python 脚本问题

> ID：910219
> 
> 赞同：0
> 
> 时间：2009-05-26T11:32:49.997
> 
> 标签：python, hosting, pywikibot

我已经为 Wikipedia 编写了一个脚本，它在我的计算机上运行良好，但是当我将它上传到我的网络主机（Dreamhost）时它不起作用并说我尝试登录的用户被阻止 - 这不是是的，它可以在我的电脑上运行并且我没有被阻止。这是我得到的确切错误消息-

```
A problem occurred in a Python script. Here is the sequence of function calls leading up to the error, in the order they occurred.

 /home/tris1601/thewikipediaforum.com/pywikipedia/wikitest.py
   35 site = wikipedia.getSite()
   36 newpage = wikipedia.Page(site, u"User:Dottydotdot/test")
   37 newpage.put(text + "<br><br>'''Imported from [http://en.wikiquote.org '''Wikiquote'''] by [[User:DottyQuoteBot|'''DottyQuoteBot''']]", u"Testing")
   38 
   39 wikipedia.stopme()
newpage = Page{[[User:Dottydotdot/test]]}, newpage.put = <bound method Page.put of Page{[[User:Dottydotdot/test]]}>, text = u'You have so many things in the background that y... could possibly work?" <p> [[Ward Cunningham]] \n'
 /home/tris1601/thewikipediaforum.com/pywikipedia/wikipedia.py in put(self=Page{[[User:Dottydotdot/test]]}, newtext=u"You have so many things in the background that y...''] by [[User:DottyQuoteBot|'''DottyQuoteBot''']]", comment=u'Testing', watchArticle=None, minorEdit=True, force=False, sysop=False, botflag=True)
 1380 
 1381         # Check blocks
 1382         self.site().checkBlocks(sysop = sysop)
 1383 
 1384         # Determine if we are allowed to edit
self = Page{[[User:Dottydotdot/test]]}, self.site = <bound method Page.site of Page{[[User:Dottydotdot/test]]}>, ).checkBlocks undefined, sysop = False
 /home/tris1601/thewikipediaforum.com/pywikipedia/wikipedia.py in checkBlocks(self=wikipedia:en, sysop=False)
 4457         if self._isBlocked[index]:
 4458             # User blocked
 4459             raise UserBlocked('User is blocked in site %s' % self)
 4460 
 4461     def isBlocked(self, sysop = False):
global UserBlocked = <class wikipedia.UserBlocked>, self = wikipedia:en
UserBlocked: User is blocked in site wikipedia:en 
      args = ('User is blocked in site wikipedia:en',) 
```

关于为什么它不起作用的任何想法？

谢谢，非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T11:38:47.503

可能是您的主机 (Dreamhost) 被阻止，而不是您的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T12:30:42.250

我会先添加一些调试。你能捕捉到你发送到维基百科的输出和它返回的结果吗？那里可能有更多信息，您可以提取这些信息以查看它失败的原因。

**[编辑]**重新调试-鉴于您提供的小片段，很难给出建议。您在单个文件中有超过 3.5k 行的事实表明其中存在一些相当低效的编码，或者问题没有特别好地分解......这可能会使调试更加棘手。

话虽如此，上面调试中提到的 .put() 几乎可以肯定是向服务器发送请求。您可以从打印出这些请求或请求的位开始。尝试拼凑正在发送的请求，然后尝试仅执行这些请求并使用 python 的 print 命令记录输出：

```
print "Sending '%s' to server%(my_put_request) 
```

...其中 my_put_request 是您发送的数据位。

**[Edit2]**我刚刚发现这是您正在使用的 pywikipedia 机器人脚本。关于机器人的维基百科文章[提到了一些关于权限的观点，](http://meta.wikimedia.org/wiki/Using_the_python_wikipediabot#Permission_on_wiki_projects)这将支持 uggedals 的建议，即这是一个访问问题。维基百科很可能识别出 Dreamhosts 的 IP，并且其他人过去曾尝试过做坏事，导致他们以某种方式被阻止。

# asp.net - 如何从在线 API 中提取数据？

> ID：910229
> 
> 赞同：1
> 
> 时间：2009-05-26T11:35:13.830
> 
> 标签：asp.net, linq, linq-to-xml

这是一个新手问题，所以请善待我:)

如何在 ASP.NET 中使用 php API？此 API 返回一个 XML 文档。它还能够返回 JSON。

输出如下所示

XML

```
<?xml version="1.0" encoding="UTF-8"?>

<Address>

        <Country>US</Country>

        <City>Seattle</City>

        <Result>Done</Result>

</Address> 
```

JSON

```
{

"CountryCode" : "US",

"City" : "Seattle",

"Result" : "Done"

} 
```

例如：有一个服务[http://someservice.com/name_query.php?pincode=](http://someservice.com/name_query.php?pincode=) 接受 pincode 并返回一个 XML 文档。

我可以使用 LINQtoXML 并使用它吗？请举一个使用 XML 和使用 JSON 的示例，这将非常有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T12:09:37.083

**首先是 XML 与 JSON**

如果您打算使用 API 执行一些 AJAX 查询（例如，在用户单击链接/图像时查询 API，例如，您想要更改该链接的颜色，女巫会告诉用户没关系或不...去JSON，因为你不需要解析XML）

如果您在“灌木丛”后面做所有事情，并且只需要呈现在后面的代码中处理的数据，那么请使用 XML。

简单使用，**带有 WebClient 对象**

```
private string GetDocument(string myPin) {
   String url = String.Format("http://someservice.com/name_query.php?pincode={0}", myPin);

   WebClient client = new WebClient();
   client.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0;)"); // pass as Internet Explorer 7.0

   Stream data = client.OpenRead(url);
   StreamReader reader = new StreamReader(data);
   s = reader.ReadToEnd();
   data.Close();
   reader.Close();

   return s;
} 
```

此时，您拥有从 API 获得的整个 XML 字符串，您现在只需要处理 XML，例如：

假设输出是一个 XML 文档，例如：

```
<Hit dbId="400179221" systemId="115">
    <WorksiteDbId>200105072</WorksiteDbId>
    <Subscribed>false</Subscribed>
    <FirstName>Klaus Holse</FirstName>
    <LastName>Andersen</LastName>       
    <Status>Active</Status>
    <MainJobTitle>CEO (Managing Director, General Manager, Owner)</MainJobTitle>
    <WorksiteName>Microsoft Development Center Copenhagen ApS </WorksiteName>
    <Department></Department>
    <Address></Address>
    <Zipcode></Zipcode>
    <City></City>
    <WorksitePhone></WorksitePhone>
    <TypeCode>TY10</TypeCode>
    <WorksiteStatus>Active</WorksiteStatus>
</Hit> 
```

处理文档信息的方法是这样的：

```
private void processDocument(string myPin) {

    String xml = GetDocument(myPin);
    XmlTextReader reader = new XmlTextReader(new StringReader(xml));
    XmlDocument document = new XmlDocument();
    document.Load(reader);

    XmlNodeList list = document.SelectNodes("/XMLNode/XMLSubNode");

    foreach (XmlNode node in list)   // loop through all nodes
    {
        foreach (XmlAttribute att in node.Attributes)  // loop through all attributes
        {
            switch (att.Name.ToLower())
            {
                case "dbid": myClass.DbID = Int32.Parse(att.InnerText); break;
                case "systemid": myClass.SystemID = Int32.Parse(att.InnerText); break;
                default: break;
            }
        }

        foreach (XmlNode subnode in node.ChildNodes)  // loop through all subnodes
        {
            switch (subnode.Name.ToLower())  // check what node has what
            {
                case "subscribed": myClass.Subscribed = bool.Parse(subnode.InnerText); break;
                case "firstname": myClass.Firstname = subnode.InnerText; break;
                case "lastname": myClass.Lastname = subnode.InnerText; break;
                case "status": myClass.Status = subnode.InnerText; break;
                ...
            }
        }
    }
} 
```

您将在 myClass 中填满 API 返回的所有值...

正如您在第一行中提到的...这是为新手准备的 :)，这是了解获取和使用 XML 数据的概念的好方法...在您理解了这部分之后，您将轻松转向 LINQ2XML :)

我希望这有帮助...

* * *

**添加**

因为我现在才看到你有 XML 的输出，这里是使用确切 XML 的 processDocument 方法

xml:

```
<?xml version="1.0" encoding="UTF-8"?>
<Address>
        <Country>US</Country>
        <City>Seattle</City>
        <Result>Done</Result>
</Address> 
```

方法：

```
private void processDocument(string myPin) {

    String xml = GetDocument(myPin);
    XmlTextReader reader = new XmlTextReader(new StringReader(xml));
    XmlDocument document = new XmlDocument();
    document.Load(reader);

    XmlNodeList list = document.SelectNodes("/Address");

    foreach (XmlNode node in list)   // loop through all nodes
    {
        foreach (XmlNode subnode in node.ChildNodes)  // loop through all subnodes
        {
            switch (subnode.Name.ToLower())  // check what node has what
            {
                case "country": myClass.Country =subnode.InnerText; break;
                case "city": myClass.City= subnode.InnerText; break;
                case "result": myClass.Result = subnode.InnerText; break;
            }
        }
    }
} 
```

请记住检查错误，例如传递一组错误的数据，以便您可以正确处理错误。

:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T11:56:52.490

可以使用 LINQtoXML，也可以使用 XMLDom。您将使用 C# 或 VB.NET 哪种语言？

在 LINQ to XML 中执行此操作的一种方法：

```
var XML = XElement.Parse(xmlSourceString);
        var query = from a in XML.Descendants("addressXML")
                    select new
                               {
                                   Country = a.Element("Country").Value,
                                   City = a.Element("City").Value
                               }; 
```

# c++ - 可能：执行 Qt3 和 Qt4 代码的程序？

> ID：910230
> 
> 赞同：3
> 
> 时间：2009-05-26T11:35:27.620
> 
> 标签：c++, python, windows, qt, boost

也许这是一个非常愚蠢的问题，但我希望你能给我一些答案。

我有一个商业应用程序，它使用 Qt3 作为它的 GUI 和一个嵌入式 Python 解释器（命令行）来编写脚本。我想为这个使用 Qt4 的应用程序编写一个自定义插件。该插件主要是一个子类 QMainWindow 类，它与一个 boost python 包装器一起链接到一个 dll（所以我在 Windows 上）。python 包装器应该是我的插件和我的商业应用程序之间的接口。

所以我的问题是：这可能吗？独立于在同一应用程序中运行 Qt4 代码运行 Qt3 代码也是如此。

第一次实验导致应用程序关闭，我将尝试进一步调查......

谢谢！

编辑：我的应用程序崩溃了，因为我没有创建 QT4 qapplication 实例。因此，当我创建实例时，没有额外的 Qt 命名空间（在答案中建议，因此无需重新编译），一切正常！;)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T12:36:00.710

在 Trolltech 论坛上查看[此线程。](http://labs.trolltech.com/forums/topic/414)（实际上这是关于 Qt4 应用程序中的 Qt3 插件，但我怀疑答案大致相同）。

更新：现在链接一个哑巴，但[回程机器](http://web.archive.org/web/20090112213159/http://labs.trolltech.com/forums/topic/414)有它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T13:02:07.117

这可以通过命名空间 Qt 来实现。从`configure --help`;

```
-qtnamespace <name>  Wraps all Qt library code in 'namespace <name> {...}'. 
```

从理论上讲，这应该可以防止可能使您当前的方法失败的符号冲突。

# installscript - InstallScript 上的好资源

> ID：910232
> 
> 赞同：2
> 
> 时间：2009-05-26T11:35:53.953
> 
> 标签：installscript

任何人都可以推荐网络上的任何资源来学习安装脚本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T19:56:46.623

请注意，InstallShield DVD 媒体上有一个 .PDF 文件 ( `InstallShieldInstallScript.pdf`)，它是最全面的 InstallScript 资源——截至 IS 2009，它有 1626 页！！！

当然，这不是您所要求的“在网络上”，但它是电子的，并且是免费的，假设您拥有 InstallShield 的许可副本。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T10:04:53.420

找到它： [http ://helpnet.installshield.com/installshield20helplib/installshield20helplib.htm](http://helpnet.installshield.com/installshield20helplib/installshield20helplib.htm)

更新了断开的链接。不幸的是，Installshield 会定期更改他们的帮助资源路径。

# sql-server - SSIS - 保存为 Office 2007 格式

> ID：910239
> 
> 赞同：0
> 
> 时间：2009-05-26T11:37:08.210
> 
> 标签：sql-server, ssis

我正在尝试从 SQL Server Integration Services 2005 中保存一个 excel 电子表格。

不幸的是，我似乎只能以 2003 格式保存，但我希望能够以 2007 格式保存。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:49:52.290

使用 OLEDB 连接管理器应该可以做到这一点。（不是 Excel 连接。）

看看[这个例子](http://bensullins.com/using-excel-2007-files-as-a-source-in-ssis-2005/)。它是用于进口的，但它也应该适用于出口。[请记住使用此处](http://msdn.microsoft.com/en-us/library/cc280527.aspx)描述的 XML 格式。[在这里](http://dougbert.com/blogs/dougbert/archive/2009/02/13/exporting-data-from-ssis-to-excel-2007-gotchas.aspx)更详细。

# linux - 如何在 Perl 中删除权限？

> ID：910241
> 
> 赞同：7
> 
> 时间：2009-05-26T11:37:26.460
> 
> 标签：linux, perl, security, privileges

我创建了一个将以 root 身份启动的服务器程序。启动后，我想将权限授予另一个用户。我怎样才能安全地做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T11:46:44.867

请参阅[Privileges::Drop](http://search.cpan.org/dist/Privileges-Drop)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T12:19:41.400

你真的不需要一个模块，虽然 Benji York 链接的那个看起来很不错。

`$<`通过和设置 UID 很简单`$>`。有关这些的更多信息，请参见[perlvar](http://perldoc.perl.org/perlvar.html#$%3C)。您也可以使用`$(`and `$)`;以这种方式设置 GID 请注意，`$) = "$target_gid $target_gid"`如果要删除补充组，则需要设置。不要忘记事后测试是否成功。

# subsonic - SubSonic 错误：名称中带有 ~ 的 db.tables 导致“字符无效”错误

> ID：910251
> 
> 赞同：0
> 
> 时间：2009-05-26T11:38:37.397
> 
> 标签：subsonic, struct

我重命名了一个数据库表并在表名中添加了一个 ~ 字符（我通知它的方式是某`backup`事）。生成 SubSonic 文件后，我的 Visual Studio 在文件“AllStructs.vb”上给出“字符无效”错误

查看此文件时，生成了以下代码行；公共共享只读 DbTable1~old As String = "dbtable1~old"。

我假设在生成 SubSonic 名称时必须从 db.table 名称中过滤掉这个字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T11:53:42.857

您可以使用 stripTableText/stripSPText 将 ~ 从类名中删除，也可以使用 regexReplaceExpression 将 ~ 替换为不同的字符。

生成类时，您需要在配置中指定此项，有关更多详细信息，请参阅“[配置选项](http://subsonicproject.com/configuration/config-options/)”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:31:59.353

SubSonic（约定和所有）不支持这种命名。您最好的选择是使用 includeTableList 和 excludeTableList （或我们拥有的其他选项之一）：

[http://subsonicproject.com/configuration/config-options/](http://subsonicproject.com/configuration/config-options/)

帮助你摆脱旧的东西。

# .net - POCO 是什么意思？

> ID：910253
> 
> 赞同：83
> 
> 时间：2009-05-26T11:38:46.990
> 
> 标签：.net, poco

我看过很多关于 POCO 的文章。这是什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-26T11:40:03.680

[普通的旧 CLR 对象](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-26T11:40:05.223

根据您要选择的语言**POCO**手段

> 普通的旧**CLR**对象

正如[维基百科](http://en.wikipedia.org/wiki/POCO)所提到的，或者，

> 普通的旧**C++**对象

正如[PocoCapsule](http://code.google.com/p/pococapsule/)提到的那样，或者，

> 便携式组件

正如[POCO 项目](http://pocoproject.org/)所提到的那样。

对于我所关心的以及这个问题的原因，当然简单来说，它是一个[C++ 库](http://pocoproject.org/)。:)

> [POCO C++ 库](http://pocoproject.org/)旨在用于以网络为中心的跨平台 C++ 软件开发，就像 Apple 的 Cocoa 用于 Mac 开发或 Ruby on Rails 用于 Web 开发一样——一个强大但易于使用的平台来构建您的应用程序。
> 
> [POCO C++ 库](http://pocoproject.org/)严格建立在标准 ANSI/ISO C++ 之上，包括标准库。POCO C++ 库的开发人员试图在使用高级 C++ 功能和保持类的可理解性以及代码干净、一致和易于维护之间找到一个很好的平衡点。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-26T11:42:07.607

POCO C++ 库（POCO 代表 POrtable 组件）是**开源 C++ 类库**，可简化和**加速**C++中以网络为中心的可移植应用程序的开发。这些库与 C++ 标准库完美集成，并填补了它留下的许多功能空白。它们的**模块化和高效**的设计和实现使 POCO C++ 库非常适合嵌入式开发，这是 C++ 编程语言变得越来越流行的领域，因为它适用于低级（设备 I/O、中断处理程序等） .) 和高级面向对象的开发。当然，POCO C++ 库也为企业级挑战做好了准备。

POCO C++ 库将**开发人员从重新发明轮子中解放出来**，并允许他们将时间花在更有价值的领域，例如快速完成工作并致力于使他们的应用程序独一无二的功能。

[来源和更多信息](http://pocoproject.org/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-26T11:41:05.347

如果您在谈论 .NET：

> POCO = 普通旧类（或 CLR）对象

请参阅：[POCO 与 DTO](https://stackoverflow.com/questions/725348/poco-vs-dto)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-26T11:41:27.093

像这样的首字母缩略词通常代表“Plain Old...”，例如 POX 表示 Plain Old XML。

因此，我猜 POCO 要么是普通的旧 C 对象，要么是普通的旧类对象或某种派生词。如果我知道上下文（例如您正在使用的编程语言）会有所帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T11:43:42.923

lainMH 和 Darnell 已经给你答案了。正如 Wikipedia 文章中所说，是对[POJO](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)一词的引用，该词的背景可在[Martin Fowlers 的网站上找到](http://martinfowler.com/bliki/POJO.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T11:40:51.323

POCO 代表[普通旧 C++ 对象](http://en.wikipedia.org/wiki/Plain_Old_C++_Object)。

# flash - AS2 到 AS3 转换

> ID：910256
> 
> 赞同：0
> 
> 时间：2009-05-26T11:39:38.047
> 
> 标签：flash

```
// This is AS2 Coding

this.createEmptyMovieClip("some_mc", 1);
some_mc.loadVariables("external.txt");
some_mc.onEnterFrame = function() {
    if (this.done == "yes") {
        // the variables have finished loading
        trace("**\nfinished loading\n**\nthe variables are:");
        trace(this.fName); // outputs nuno 
        trace(this.lName); // outputs mira 
        trace(this.age); // outputs 24 
        // delete the method to end the loop
        delete this.onEnterFrame;
    }  else  { 
        // not loaded yet
        trace("**\nstill loading\n**");
    }
};

//I want AS3 Coding

//in the text file external.txt data:

&fName=nuno& 
&lName=mira& 
&age=24& 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-09T03:01:15.000

```
Simply you have to use URLLoader,URLRequest & URLVariables class in as3, see my example code in below.

    private var _vars:URLVariables;
    private Var _urlloader:URLLoader = new URLLoader(new URLRequest("external.txt"));
    _urlloader.addEventListener(Event.COMPLETE, onURLLoaderCompleteHandler);
    private function onURLLoaderCompleteHandler(e:Event):void
    {
        var loader:URLLoader = URLLoader(e.target);
    _vars = new URLVariables(loader.data);
       some_mc.addEventListener(Event.ENTER_FRAME, onFrameRunning);
    }

    private function onFrameRunning(e:Event):void
    {
        if(_vars != null)
         {
             trace("fname :"_vars.fname);
             trace("lname :"_vars.lname);
             trace("age :"_vars.age);
         }
    }

//in the text file external.txt data:
fname=nuno&lname=mira&age=24 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:15:53.397

那么这个问题：[https](https://stackoverflow.com/questions/909409/how-to-read-text-file-external-txt-in-as3) ://stackoverflow.com/questions/909409/how-to-read-text-file-external-txt-in-as3也被您提交的可能性有多大？双重问题和个人资料，偷偷摸摸......你应该关闭其中一个。

无论如何，您拥有的代码并不是最佳实践，文本文件中的格式也不是。我建议改用 xml，但在另一个问题中，您似乎坚持使用接近标准的文本格式（通常是**fName=nuno&lName=mira&age=24**）。

无论如何，要做到这一点，您首先需要使用[URLLoader](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLLoader.html#includeExamplesSummary)加载文本，该示例应该为您提供所需的一切。

然后你需要解析文本，我建议[Regex](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/RegExp.html#includeExamplesSummary)，这个例子应该给你大部分你需要的东西。您应该能够使用**/&(.+)=(.+)&/g**解析它（在捕获子字符串时检查[这一点](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000112.html)），其中第一个子字符串是名称，第二个是值。

然后，您最终可以遍历最终得到的数组并将所有内容放入[Dictionary](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/utils/Dictionary.html)中，以便您可以按名称访问值。

# objective-c - 带有自定义单元格的 NSTableView

> ID：910267
> 
> 赞同：17
> 
> 时间：2009-05-26T11:40:38.047
> 
> 标签：objective-c, cocoa, xcode, macos, osx-leopard

似乎我已经搜索了很长时间，但还没有找到一个很好的、简单的答案来解决我的问题。

我将 XCode 与 Cocoa/ObjC 一起使用，并尝试创建一个 NSTableView，它将值从 NSDictionary/Array 加载到单元格的不同部分。

例如，我试图将 NSImage、NSTextField 和其他项目放入自定义单元格（以及背景图像）。但是，我找不到如何创建这个的简单答案。

我用 UITableViews 为 iPhone 编写代码已经有一段时间了，似乎找不到与 NSTableViews 类似的方法。

任何帮助都会非常棒！

谢谢

多米尼克

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-26T12:47:58.473

NSTableView 有`-tableView:dataCellForTableColumn:row:`. 只需在您的委托中创建您的 NSCell 子类，如果您需要对该行进行自定义，请返回它。如果您只是为表格视图中的每一行使用自定义单元格，您也可以只使用 IB 来设置自定义单元格类。

表格视图将根据需要复制单元格，因此如果效率更高，您可以将单元格保留为实例变量。表视图上的数据源方法或绑定正常工作，只是您将返回填充的字典而不是单个字符串或数字。您也可以将自定义模型对象直接传递给 tableview，尽管您必须使其可复制，或者`setObjectValue:`在您的单元格中覆盖以将其包装在 NSValue 中。

如果它是给你带来麻烦的 NSCell 子类化，那可能是一种学习体验。从`-drawWithFrame:inView:`绘制所有自定义对象开始，然后在需要更多功能时从那里开始。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-01-17T22:59:00.157

观看 WWDC 2011 视频“基于视图的 NSTableView 基础到高级”（第 120 节）

[https://developer.apple.com/videos/wwdc/2011/](https://developer.apple.com/videos/wwdc/2011/)

这适用于 Lion (10.7) 及更高版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T16:49:21.917

一个单元格一次只能保存一个对象值。使用图像和字符串/属性字符串作为属性创建一个模型对象，并用它填充表格视图。

此外，文本字段是一个视图。你的模型应该对它的表现一无所知——那是你的视图的工作。

# c# - 如何在 nhibernate 中获取具有实体属性的实体？

> ID：910274
> 
> 赞同：1
> 
> 时间：2009-05-26T11:41:38.230
> 
> 标签：c#, nhibernate

我想获得一个具有子属性的实体。我怎么能用 nhibernate 做到这一点而不在映射中指示。我想像在 linq-to-sql 中一样通过“LoadWith()”方法来控制获取。不是自动化解决方案。

```
public class Survey
{
   public virtual long Id;
   public virtual String Title;
   public virtual IList<SurveyPage> Pages; 
} 
```

我想在不使用映射文件的情况下在一个查询中加载其 Pages 属性的调查。我怎么能在休眠中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T11:53:33.900

解决了。这做了我想要的。

```
IList<Survey> surveys = session.CreateCriteria(typeof(Survey))
                        .SetFetchMode("SurveyPages", FetchMode.Eager)
                        .List<Survey>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T08:05:48.263

是的，FetchMode 是一种巧妙的做法。需要注意的几件事是

1.  您只能将 fetchmode 设置为（一次）映射文件的一个集合。

2.  当您对关联的集合执行提取模式时，它将返回行的连接。（不会分隔父项的唯一行）。

另一种方法是将 HQl 查询与 Join 结合使用。

# wpf - 如何在 wpf 应用程序中了解有关图像的信息

> ID：910276
> 
> 赞同：0
> 
> 时间：2009-05-26T11:41:45.173
> 
> 标签：wpf, image, c#-3.0

我正在开发 WPF 应用程序。在那个我正在加载列表框中的图像。有什么方法可以知道分辨率低的图像。我想显示带有警告的低分辨率图像。请帮我解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:02:03.123

假设您正在加载位图图像（包括 BMP、JPEG、PNG 等 - 任何不是矢量图像绘图的东西），您可以使用 System.Windows.Media.Imaging 中的 BitmapSource 类来读取源图像的​​ PixelHeight 和 PixelWidth . 虽然您可以将图像直接加载到 BitmapSource 中，但如果您要加载到 Image 控件中，则可以通过 Image 的 Source 属性直接访问 BitmapSource。然后，它只是确定低分辨率对您意味着什么 - 小于 50px 正方形、100px、200px 等，并在 PixelHeight 或 PixelWidth 小于该值时显示警告。

综上所述，假设我们想在图像顶部显示一个橙色矩形，如果它的宽度小于 100 像素或高度小于 100 像素。使用非列表框实现，我们可以这样做：

```
<Image x:Name="DemoImage" Source="demo.png"/>
<Rectangle Fill="Orange" Width="20" Height="20">
    <Rectangle.Resources>
        <local:LessThanConverter x:Key="LessThanConverter"/>
    </Rectangle.Resources>
    <Rectangle.Style>
        <Style TargetType="Rectangle">
            <Setter Property="Visibility" Value="Collapsed"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=DemoImage, Path=Source.PixelHeight, 
                    Converter={StaticResource LessThanConverter}, ConverterParameter=100}" Value="True">
                    <Setter Property="Visibility" Value="Visible"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=DemoImage, Path=Source.PixelWidth, 
                    Converter={StaticResource LessThanConverter}, ConverterParameter=100}" Value="True">
                    <Setter Property="Visibility" Value="Visible"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Rectangle.Style>
</Rectangle> 
```

由于 WPF 仅触发检查相等性，我们需要一个转换器来比较两个值——在这种情况下，我们的实际像素高度/宽度和我们确定的像素高度/宽度使图像“低分辨率”——并返回真/假我们可以触发的值。在上面的代码中，它被命名为 LessThanConverter。转换器的代码很简单：

```
/// <summary>
/// Converter to use in WPF triggers that returns true when
/// 'value' is less than 'parameter'.
/// </summary>
public class LessThanConverter : IValueConverter
{
    public object Convert(object value, Type targetType, 
        object parameter, System.Globalization.CultureInfo culture)
    {
        return ((int)value < System.Convert.ToInt32(parameter));
    }

    public object ConvertBack(object value, Type targetType, 
        object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

然后，当加载一个 Image 时，Rectangle 的 Style 检查它的 Triggers 以查看该图像的高度或宽度是否小于 100px；如果是这样，它将矩形的可见性从默认（折叠）更改为可见，从而在图像顶部显示橙色矩形。当然，当图像分辨率较低时，您可以轻松地使用不同的元素来显示。

要在列表框中执行此操作，您只需更新项目模板以包含源图像和警告图标；然后，根据关联的图像将样式应用于警告图标。您不能在此处使用 ElementName 绑定，但其他绑定类型之一就足够了。

或者，将下面的代码（使用 ElementName 绑定）包装到包含图像和警告图标的自定义控件中，您可以像在项目模板中使用普通图像控件一样使用它，除了您的自定义控件另外显示警告图标到图像（显示低分辨率图像时）。

# javascript - 逐行解释 JavaScript 函数

> ID：910282
> 
> 赞同：1
> 
> 时间：2009-05-26T11:43:18.510
> 
> 标签：javascript

我遇到了以下一段 JavaScript 并想知道它在做什么：

```
function flipString(aString) {
 var last = aString.length - 1;
 var result = new Array(aString.length)
 for (var i = last; i >= 0; --i) {
  var c = aString.charAt(i)
  var r = flipTable[c]
  result[last - i] = r != undefined ? r : c
 }
 return result.join('')
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T11:46:44.197

它看起来像某种加密/混淆。不知道是什么`filpTable`样子很难说。

```
function flipString(aString) {
 var last = aString.length - 1;

 // Create a new array with the length of the string
 var result = new Array(aString.length)

 // Walk through the string backwards
 for (var i = last; i >= 0; --i) {
  // Get the current character
  var c = aString.charAt(i)

  // Find the associated character in the flipTable
  var r = flipTable[c]

  // If the character wasn't in the flip table, use it as-is, else use the one we found
  // Store as (last-i) instead of (i) so it comes out backwards
  result[last - i] = r != undefined ? r : c
 }

 // Return the result as a string instead of an array
 return result.join('')
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T11:47:31.417

它从第一个字符到最后一个字符遍历字符串，同时将在每个索引处找到的字符存储在数组中。对于每个字符，如果数组“flipTable”有一个与之关联的条目，则它使用翻转表条目而不是字符。然后将生成的数组与 '' 连接以形成一个字符串。

简单来说，它反转一个字符串，同时将作为 FlipTable 键的每个字符更改为与其关联的条目。你为什么要这样做，没有上下文我不知道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T11:52:43.217

看起来像一个简单的[替换密码](http://en.wikipedia.org/wiki/Substitution_cipher)实现。`flipTable`包含替换字母表，该函数逐步遍历字符串中的每个字符，并将其替换为该字母表中的对应字符。

# python - Django 对象更改模型字段

> ID：910287
> 
> 赞同：2
> 
> 时间：2009-05-26T11:44:43.483
> 
> 标签：python, django, django-models

这不起作用：

```
>>> pa = Person.objects.all()
>>> pa[2].nickname
u'arst'
>>> pa[2].nickname = 'something else'
>>> pa[2].save()
>>> pa[2].nickname  
u'arst' 
```

但如果你服用它会起作用

```
 p = Person.objects.get(pk=2) 
```

并更改昵称。

为什么这样。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T17:41:35.993

```
>>> type(Person.objects.all())
<class 'django.db.models.query.QuerySet'>

>>> pa = Person.objects.all() # Not evaluated yet - lazy
>>> type(pa)
<class 'django.db.models.query.QuerySet'> 
```

查询 DB 给你一个 Person 对象

```
>>> pa[2] 
```

DB 再次查询为您提供另一个 Person 对象。

```
>>> pa[2].first_name = "Blah" 
```

让我们将此实例称为 PersonObject1，它驻留在内存中。所以它相当于这样的东西：

```
>>> PersonObject1.first_name = "Blah" 
```

现在让我们这样做：

```
>>> pa[2].save() 
```

pa[2] 再次查询一个数据库并返回另一个人员对象实例，例如 PersonObject2。哪个不会改变！所以它相当于调用类似的东西：

```
PersonObject2.save() 
```

但这与 PersonObject1 无关。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T11:58:37.823

如果你将你分配`pa[2]`给一个变量，就像你做的那样，`Person.objects.get(pk=2)`你会做对的：

```
pa = Person.objects.all()
print pa[2].nickname
'Jonny'
pa[2].nickname = 'Billy'
print pa[2].nickname
'Jonny'

# when you assign it to some variable, your operations 
# change this particular object, not something that is queried out each time
p1 = pa[2]
print p1.nickname 
'Jonny'
p1.nickname = 'Billy'
print p1.nickname 
'Billy' 
```

这与您从数据库中提取对象的方法无关。

而且，顺便说一句，django 编号 PrimaryKeys 从 1 开始，而不是 0，所以

```
Person.objects.all()[2] == Person.objects.get(pk=2)
False
Person.objects.all()[2] == Person.objects.get(pk=3)
True 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T18:13:04.837

`Person.objects.all()`返回 a `QuerySet`，它是惰性的（在从它请求数据之前不执行 DB 查询）。切片 a `QuerySet`(pa[2]) 执行数据库查询以从数据库中获取单行（在 SQL 中使用 LIMIT 和 OFFSET）。再次切片`QuerySet`不会再次执行数据库查询（结果被缓存），但它确实返回了模型的*新*实例。每次访问 pa[2] 时，您都会获得一个新的 Person 实例（尽管其中包含所有相同的数据）。

# nunit - nunit 在哪里存储最近加载的程序集

> ID：910301
> 
> 赞同：0
> 
> 时间：2009-05-26T11:48:04.490
> 
> 标签：nunit

当我们打开 NUnit 应用程序时，它会加载之前加载的程序集。nunit 将那些最近加载的程序集存储在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:22:56.233

最新版本的 NUnit (2.5.0.9112) 将用户设置存储在 xml 文档中。

文件位置因用户而异，如下所示：

> C:\Documents and Settings\[用户]\Application Data\NUnit\NUnitSettings.xml

在设置文件中，您会看到每个最近文件的标签。例如：

```
<Setting name="RecentProjects.File1" value="C:\MyAssembly.dll" />
<Setting name="RecentProjects.File2" value="C:\MyAssembly2.dll" /> 
```

在上面的示例中，默认情况下将加载名称为“RecentProjects.File1”的设置中标识的程序集。

* * *

**更新：**
*由于 OP 表示他们正在使用 NUnit 2.4.8 并且这个问题仍然悬而未决，我想我应该更新我的答案。*

对于 2.4.8 版本，上述答案几乎相同，只是*设置*名称值需要更改如下：

```
<Setting name="RecentProjects.V2.File1" value="C:\MyAssembly.dll" />
<Setting name="RecentProjects.V2.File2" value="C:\MyAssembly2.dll" /> 
```

请注意，唯一的区别是添加了文本“V2”。在此示例中，默认情况下将加载设置中标识的名称为“RecentProjects.V2.File1”的程序集。

希望这能回答你的问题。

[您可以在此处](http://www.nunit.org/index.php?p=download)找到这些项目的源代码。

# iphone - 如何将 IBAction 方法连接到普通视图以进行修饰事件？

> ID：910305
> 
> 赞同：5
> 
> 时间：2009-05-26T11:49:33.880
> 
> 标签：iphone, interface-builder

我在 Xcode 中创建了一个空白的新的基于视图的应用程序项目。它为它生成了一个 myProjectViewController 和一个 nib。在该视图控制器的那个笔尖中，只有一个视图。我想测试一些事件处理的东西并创建了一个 -(IBAction) 方法，当我触摸视图时它只会记录一个“hello world”。但出于某种原因，IB 没有给我机会勾搭行动。我在那里做错了什么？我还尝试将 UIView 作为子视图放在那里。当我从那里拖到文件的所有者（谁的类是 myProjectViewController，我在标题中有 IBAction）时，甚至没有提到 IBAction。但它实际上应该，对吧？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-04-11T18:18:02.367

有一种简单的方法可以实现这一目标。转到您的类的界面构建器>>选择您要添加操作的视图>>然后将其自定义类从 IDENTITY INSPECTOR 从 UIView 更改为“UIControl”。现在您可以将任何 IBAction 方法添加到此视图。

![将类更改为 UIControl](https://i.stack.imgur.com/wMdlx.png)

![将 IBAction 事件添加到此视图以执行操作方法](https://i.stack.imgur.com/KhV76.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T09:23:47.997

IBAction 只是您添加到方法声明中的一个标记，该标记将该方法标识为连接到控件操作的候选方法。

IBAction 方法是接收某个其他控件的操作消息的方法。

UIViews 不发送任何动作。UIControls 可以。因此，没有什么可以从普通的 UIView 连接到您的对象。您只能将 IBActions 连接到 UIControl 子类和 UIBarButtonItems。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T12:29:02.130

为此，我们有 touchesBegan、touchesMoved 和 touchesEnded 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T12:42:14.053

IBAction 是旨在从控件接收操作的方法。它们并不向 Interface Builder 表明该方法是动作的来源（该类为响应某些其他事件而生成）。

要从 UIView 子类连接自定义事件，请[在此处](https://stackoverflow.com/questions/906762/events-for-custom-uiview/906811#906811)查看我对相关问题的回答。您将需要使用委托/协议方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-04T05:26:47.053

我认为您可以按照@lostInTransit 的建议使用 touchesBegan 或 touchesEnded 方法。它是正确的方法，而不是将其作为按钮的视图。

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

// do something here

} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-05-04T05:23:09.150

使您的视图成为 UIButton 类。这将使视图可以挂钩。

# java - 甲骨文表格 10 / java

> ID：910306
> 
> 赞同：2
> 
> 时间：2009-05-26T11:49:54.970
> 
> 标签：java, oracleforms

由 Oracle Forms 调用的 Java 应用程序是否可以像 Forms 一样参与同一个数据库会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:07:27.990

我知道的唯一方法是让java应用程序作为表单的一个组件运行，例如作为表单容器中的java bean。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:08:45.340

不幸的是，这是*不可能*的。Forms 进程本身在服务器上的 Forms Runtime 中运行，这是一个 C 程序。

您可以按照 Jeffrey 的建议包含一个 JavaBean，但 JavaBean 将通过 JDBC 打开它自己的连接——它不会共享表单的事务上下文。

可能还有其他方法 - 尝试使用有关您要实现的目标的一些详细信息更新问题，我很乐意为您提供帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T10:38:52.863

我想这是受限制的，可能是出于安全考虑。

# hex - 如何使用大脑将十六进制转换为十进制？

> ID：910309
> 
> 赞同：28
> 
> 时间：2009-05-26T11:52:34.497
> 
> 标签：hex

打开计算器做这些小事对我来说似乎很烦人，我坚信“你知道的越多越好！” 所以在这里我问你如何将十六进制转换为十进制。

直到那一刻，我使用以下公式：

```
Hex:        Decimal:
12          12+6
22          22+2*6
34          34+3*6
49          49+4*6
99          99+9*6 
```

当我以更高的数字（如 C0 或 FB）继续前进时，我会感到困惑

您使用的公式（大脑，非功能性）是什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-26T12:08:11.720

如果你认为十六进制是以 16 为基数的，它实际上很容易：

从最低有效数字开始，向最高有效数字（从右到左）工作，然后将数字乘以 16 的递增幂，然后将结果相加。

例如：

0x12 = 2 + (1 * 16) = 18

0x99 = 9 + (9 * 16) = 153

然后，记住 A = 10、B = 11、C = 12、D = 13、E = 14 和 F = 15

所以，

0xFB = 11 + (15 * 16) = 251

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-26T12:07:05.327

那不是公式……这甚至不像公式……

公式为：

X*16^y 其中 X 是您要转换的数字，y 是数字的位置（从右到左）。

所以..如果你想将*DA145*转换为十进制将是..

> (5 * 16^0) + (4 * 16^1) + (1 * 16^2) + (10 * 16^3) + (13 * 16^4)

你必须记住字母是：
A - 10
B - 11
C - 12
D - 13
E - 14
F - 15

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-26T12:01:47.677

当我发现我正在使用的十六进制数字是 32 位时，我几乎不再这样做了。那里没有太多乐趣。

对于较小的数字，我（最终）记住了一些模式：10 = 16、20 = 32、40 = 64、80 = 128（因为 100 = 256 和 80 少一点）。200 = 512 我记得是因为我曾经使用的某些机器的页面大小为 512（不再记得是什么机器了！）。1000 = 4096 因为那是另一台机器的页面大小。

还有，64=100, 32=50, B8=200

这就是全部。除此之外，我补充说。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-26T12:08:52.107

为了记录，你的大脑确实使用了一种功能性的方法来寻找答案。这是我的大脑用来查找十六进制数的值的函数：

1.  将十六进制数分成单独的数字。
2.  将每个数字转换为其十进制值（因此 0-9 保持不变，A 为 10，B 为 11，等等）
3.  从最右边的数字开始，将每个值乘以 16^X 次方，其中 X 是与最右边数字的距离（所以最右边的数字是 16^0，或 1，接下来是 16^1，或 16，接下来是 16^ 2 或 256 等）
4.  将所有值加在一起。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-09-04T10:17:39.930

记住 20h、40h 等的十进制值，直到 E0h。（我想你已经知道 100h。）然后通过在 1 到 16 之间加减一个数字来获得其他数字的十进制值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-11T07:36:36.043

十进制值将是

```
20h = 0x16^0 + 2x16^1 = 0x1 + 2x16 = 0 + 32 = 32 
```

以十进制表示法，或`(32)10`.

对于`40h`hexa 我们将有`64`十进制，对于`EOH`，我们将有`224`十进制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-03-23T16:03:27.427

在确定单词中特定索引的十进制值时，对所有基进行概括：

```
b^i*n 
```

其中 b 是基数，i 是单词中的索引，n 是索引处的数值。通过记住 b,i,n = bin = binary 的缩写来记住这一点。

## 例子：

* * *

对于base2（二进制）**1** 000，获取1所在的值：

b = base，即base2：**b=2**

i = word 中从 0 开始的索引，即 1000，1 在第 3 个索引中，**i=3**

n = 索引中列出的数字，即 1000，第 3 个索引为 1，**n=1**

所以，2^3*1 = 8

* * *

对于base10（十进制）**9** 00，获取9所在的值：

b=10, i=2, n=9 : 10^2*9 = 100*9 =900

* * *

对于base16（十六进制）0x0 **f** 0，获取f所在的值：

b=16, i=1, n=15 (0-9,af,f=15) : 16^1*15 = 16*15 = 240

* * *

请注意，这可以用来确定一个单词中每个索引的值，然后可以将每个值求和以确定完整的单词值。

例如 1001，从左到右（总和顺序无关紧要）：

(2^3*1=8) + (2^2*0=0) + (2^1*0=0) + (2^0*1=1) = 9

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-16T13:51:55.870

我没有发现这些有用，所以这是我的方法：将其转换为两组二进制数来表示每个字母，然后取整个二进制表示并转换为十进制

示例：AB

甲/乙

= 1010 / 1011 二进制

= 171 (128 + 0 + 32 + 0 + 8 + 0 + 2 + 1) 十进制

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-19T14:55:35.487

这是另一种不涉及 16 次方且可以用铅笔和纸完成的方法：

从最左边的数字开始。将它乘以 16 并加上左数第二个数字。然后将结果乘以 16 并加上左起第三个数字。等等。

例如，转换`0x20A5`为十进制：

```
 2 * 16 +  0 = 32
 32 * 16 + 10 = 522   (remember that A is 10 decimal)
522 * 16 +  5 = 8357 
```

转换的结果是 8,357。

# visual-studio-2008 - 为什么在我使用 VS2008 完成 Web 应用程序调试后 Internet Explorer 关闭？

> ID：910313
> 
> 赞同：3
> 
> 时间：2009-05-26T11:52:58.317
> 
> 标签：visual-studio-2008, debugging, internet-explorer, web-applications

> **可能重复：**
> [Visual Studio - 阻止关闭 Internet Explorer 停止调试](https://stackoverflow.com/questions/281034/visual-studio-prevent-stopping-debugging-from-closing-internet-explorer)

当我开始在 Visual Studio 2008 中调试我的 Web 应用程序时，会打开一个新的 Internet Explorer 窗口。当我完成调试时，该新窗口以及所有以前打开的 IE 窗口都将关闭。

每当我调试我的应用程序时，我都厌倦了丢失所有打开的网站。请帮助我找到解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:03:50.887

每当您从Visual Studio“运行”一个Web应用程序时，它都会启动一个Web浏览器的实例（您将如何使用您的应用程序？）如果您不希望这种情况发生，您最好设置您的应用程序在 IIS 中，然后当您要调试构建时，启动 Web 浏览器，浏览到 localhost/App，然后在 Visual Studio 中手动将进程附加到 Web 浏览器实例。这样，当您停止调试时，浏览器将继续存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T12:04:18.590

我不知道语法，但我假设您想附加到现有的 IE 会话，而不是在调试时创建一个新会话。此外，您不想停止调试，而是想从调试器中分离 IE 应用程序。

查看您的调试属性以查看“附加”调试设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T12:09:50.203

在项目选项中，转到 web 部分。您可以选择一系列启动操作。如果您不想打开 Web 浏览器，请选择“不打开页面。等待来自外部应用程序的请求”。然后，您可以使用 Web 浏览器的任何实例来访问您的应用程序，它不会被绑定到您的调试会话。

如果您使用内置 Web 服务器运行，则可以通过单击系统托盘中的“Web”图标来查看正在使用的端口。

# c - 编译错误：无法分配常量大小为 0 的数组。为什么会这样？

> ID：910314
> 
> 赞同：1
> 
> 时间：2009-05-26T11:53:10.877
> 
> 标签：c, visual-studio-2005, compiler-errors

我在使用 Microsoft Visual Studio-2005 编译器处理 C 代码时遇到了一个问题。

我试图静态声明一个大缓冲区：

```
int gbl_data[4096*4096*256]; 
```

编辑：此声明是头文件中的全局变量。

它给出了一个编译错误——“<strong>无法分配一个常量大小为 0 的数组”。

意味着不知何故 4096X4096X256 的大小变得比 MAX_INT_LIMIT 大小 (2^31) 太大，并且可能会环绕并变成 -ve 左右。但是它应该将错误作为“负下标”。

我尝试将常量转换为 4096UL x 4096UL x 256UL ，仍然是相同的编译错误。

这个错误的原因是什么？

是因为物理内存大小不足以分配这个大大小的缓冲区还是什么？

解决方法是什么？

谢谢。

-通用汽车。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T12:00:09.693

数组大小不是整数，而是无符号整数。unsigned int 的最大值为 4294967295。你还有一个，所以它回绕到 0。

将常量转换为 long 不会改变任何内容，因为 long在大多数平台上**也是**32 位整数。

您可以尝试使用 long longs，但现在我们遇到了另一个小问题。

您正在尝试分配 40 亿个整数。32 位 CPU 的内存空间为 40 亿*字节*。您正在尝试分配 4 倍于可以存在的最大理论内存量。（16 GB）

所以回到绘图板。弄清楚你为什么要这样做，以及你能做些什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T12:01:41.047

您正在尝试静态分配 2^32 的数组（或 4 倍的地址空间，在 32 位系统上）。编译器似乎将 4096 * 4096 * 256 （即，在我的脑海中，0x10000）截断为 32 位值。

根据您的平台，无符号长整数也可能是 32 位的，并且还会截断。

我建议您确保您正在为 64 位平台进行编译（如果这是您想要的），或者将算法更改为动态分配内存（显然不超过地址空间），或者使用文件磁盘。

# c# - 用现代类似 OO C 的语言来做这件事的好方法？

> ID：910320
> 
> 赞同：5
> 
> 时间：2009-05-26T11:54:23.353
> 
> 标签：c#, java, c++, data-structures

我有`Tile`s 代表游戏二维世界中的瓷砖。瓷砖可以在任意数量的 4 个面上有墙。我现在有这样的事情：

```
interface Tile {
    boolean isWallAtTop();
    boolean isWallAtRight();
    boolean isWallAtLeft();
    boolean isWallAtBottom();
} 
```

在其他地方我也有 16 张图像，每个可能的瓷砖墙配置一张。像这样的东西：

```
static final Image WALLS_ALL_AROUND = ...
static final Image WALL_ON_TOP_AND_RIGHT = ...
/* etc etc all 16 possibilities */ 
```

我想写一个

```
static Image getWallImage(Tile tile) 
```

我想*避免*的是经历各种可能性的折磨

```
if (tile.isWallTop && tile.isWallRight 
    && !tile.isWallBottom && !tile.isWallLeft) {
    return WALL_ON_TOP_AND_RIGHT;
} 
```

有谁知道一个更可爱的方法来做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T11:58:44.670

Go go 小工具位掩码。为每个图块使用 4 位掩码，说明哪一面有墙。

```
A B C D 
```

位 A 表示顶部的墙壁，B 表示右侧，C 表示底部，D 表示左侧。定义常量以帮助您在逻辑上与掩码相交，即

```
if (tile.Walls & (WALL_LEFT | WALL_RIGHT))
  // Do stuff 
```

为了找到图像，这个 4 位掩码产生 16 种可能性。将其用作图像“数组”的索引，因此您可以毫不费力地直接找到正确的图像。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T12:01:42.310

瓦片对象是否有任何其他属性？`Tile.getImage()`如果不是（或者如果您可以排除这些因素），您可以使用返回传递给构造函数的固定图像的方法将 tile 对象本身变成 16 个常量的枚举。这被称为[享元模式](http://en.wikipedia.org/wiki/Flyweight_pattern)：

```
class Tile {
    public final boolean isWallAtTop;
    public final boolean isWallAtRight;
    public final boolean isWallAtLeft;
    public final boolean isWallAtBottom;
    public final Image image;

    private Tile(boolean top, boolean right, boolean left, 
                 boolean bottom, Image image)
    {
        this.isWallAtTop = top;
        this.isWallAtRight = right;
        this.isWallAtLeft = left;
        this.isWallAtBottom = bottom;
        this.image = image;
    }

    public static final Tile WALLS_ALL_AROUND = 
        new Tile(true, true, true, true, new Image("allWalls.png"))
    // more constants here, plus other methods that work with
    // only the wall data
} 
```

**在 Java 中，您甚至可以将其实现为“真正的”枚举。**

对于由瓦片组成的地图，您可以拥有一个简单的瓦片引用二维数组，或者如果您需要单个瓦片的其他数据，则拥有另一个`SpecificTile`包含“其他数据”和对瓦片之一的引用的类上面的物体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T12:05:12.023

我建议创建一个位标志枚举，如下所示。

```
[Flags]
public enum WallLocations
{
    None = 0,
    Left = 1,
    Right = 2,
    Top = 4,
    Bottom = 8
} 
```

然后，您可以使用字典将墙壁位置映射到图像。

```
Dictionary<WallLocations, Image> map = new Dictionary<WallLocations, Image>();

map.Add(WallLocations.None, image0000);
map.Add(WallLocations.Left, image1000);
map.Add(WallLocations.Right, image0100);
map.Add(WallLocations.Top, image0010);
map.Add(WallLocations.Bottom, image0001);
map.Add(WallLocations.Left | WallLocations.Right, image1100);
// .... 
```

至少在 C# 中，您还可以将枚举定义扩展到所有 16 种情况。

```
[Flags]
public enum WallLocations
{
    None = 0,

    Left = 1,
    Right = 2,
    Top = 4,
    Bottom = 8,

    LeftAndRight = Left | Right,
    LeftAndTop = Left | Top,
    LeftAndBottom = Left | Bottom,
    RightAndTop = Right | Top,
    RightAndBottom = Left | Bottom,
    TopAndBottom = Top | Bottom,

    AllExceptLeft = Right | Top | Bottom,
    AllExceptRight = Left | Top | Bottom,
    AllExceptTop = Left | Right | Bottom,
    AllExceptBottom = Left | Right | Top,

    All = Left | Right | Top | Bottom
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T11:58:20.413

你不能用标志枚举做点什么吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T12:00:39.113

您应该将墙配置放入单个变量中，并构建此变量到瓷砖图像的映射。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T12:21:34.750

与其制作`WALLS_ALL_AROUND`图像，不如使其成为包含图像的对象，以及处理允许的运动等所需的任何其他逻辑。在一个`Location`对象中，您可以将`walls`属性设置为 that `WALLS_ALL_AROUND`，您可以查询图像并处理其他与墙相关的逻辑。

`Tile`由于每组图像只需要这些（不可变）对象的 16 个实例（如果您只有一组图像，每个对象都可能是单例子类），因此您还可以节省内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T15:02:02.570

一个体面的 OO 解决方案可能会涉及[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)。一种可能的实现是有一个 WallConfiguration 类和一个 WallFactory 来创建它们。然后，一个 Tile 将包含一个 WallConfiguration。实现（C++ 风格）看起来像这样：

```
class Tile
{
private:
    WallConfiguration walls;
    // Other Tile data

public:
    enum Walls
    { 
        TOP,
        BOTTOM,
        LEFT,
        RIGHT,
        TOP_RIGHT,
        TOP_LEFT
        // Fill in the rest
    }; //Enums have a place!
    Tile(Walls wall)
    {
        walls = WallFactory.getConfiguration(wall);
    } 
```

这样做的一个有趣的优势是，现在，当您添加炸毁墙壁的能力时（来吧……您知道您会这样做，因为我们都喜欢炸毁东​​西），您可以添加对 WallConfiguration 类负责，例如，当您炸毁左墙时，该类将知道如何获取自身的正确实例。

# javascript - 征求关于严厉批评 jQuery 的意见

> ID：910324
> 
> 赞同：6
> 
> 时间：2009-05-26T11:56:09.340
> 
> 标签：javascript, jquery

我对 jQuery 感到困惑。

一方面，它附带 Microsoft MVC 库，我认为它是一个我喜欢使用的深思熟虑的库。

另一方面，我最近在 comp.lang.javascript 中指出了[这篇](http://groups.google.com/group/comp.lang.javascript/browse_frm/thread/3d90e8b8a8301462)文章的方向，其中作者对 jQuery（以及显然其他几个类似的库）几乎没有好话可说，并且足够善良/勇敢提供[他自己的图书馆](http://www.cinsoft.net/mylib.html)。

您对 jQuery 和其他此类 JS 库的当前状态有何看法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-26T12:03:49.857

我不是 JS 开发人员，但这样说：

有人批评一个广泛使用的图书馆，同时宣传他们自己的图书馆？

称我为愤世嫉俗者，但考虑到内在的利益冲突，我会在将他们的话作为最终答案之前寻找另一种或 2 种意见。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-26T12:11:16.173

我的 $.02：

jQuery 赢得了图书馆大战。它只是：包含在 MVC 中密封了这一点。

这不是可能发生的最糟糕的事情。就我个人而言，我发现它的功能集和实现优于任何竞争对手，[MooTools](http://en.wikipedia.org/wiki/MooTools)的动画套件经得起考验，但最重要的是它已成为通用语。我们需要一个标准来出现。

对于那些抱怨开源库质量的人，我没有太多时间——不喜欢吗？参与并修复它。

我对 jQuery 有一个问题的地方是，*太多*我喜欢的开发人员没有像他们应该的那样深入学习 JavaScript。我想这与那些坚持每个人都应该学习 C++ 的人类似，也许我开始明白这个论点的意义所在。JavaScript*本身*就是一种非常强大的语言，多年来它一直能够在不添加多 K 库的情况下解决问题。根据我的经验，调用大锤来破解坚果有一个明确的 jQuery 效果（标志：“为什么不使用 jQuery？”）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-26T12:28:49.837

嗯，我宁愿相信我多年来使用 jQuery 和使用它的成千上万快乐的露营者，而不是一些认为自己更了解的吹毛求疵的笨蛋。据我所知，他的很多批评都是非常具体的（例如，使用`match`，这完全是蹩脚的）关于效率和优化代码，但完全缺乏支持浏览器怪癖数量所需的绝对魔力和错误，甚至可以做 jQuery 提供的一小部分。哦，jQuery 有多年的包袱，所以是的，会有一些缺陷。

让我们看看这个替代的 JavaScript 库。最初的页面写着，文学，“我讨厌图书馆，所以我创建了一个图书馆。” 此外，它抱怨浏览器嗅探，并声称自己只做特征嗅探。伙计，这就是他们中的很多人实际上进行浏览器嗅探的方式。它继续说纠结于 API 是愚蠢的，并继续展示它的，嗯，API。是的，这有点傻，但我敢肯定这一切都是为了一个好的原因？

深入研究实际的 API，我对浏览器丛林的框架方法所缺少的一组语义感到震惊，并且它缺少使 jQuery 如此成功的关键部分；好的选择器进入 DOM。它可能会完成这项工作（其中没有文档；它实际上对我有什么帮助？只是跨浏览器 DOM 访问，什么？还有什么？）但我需要一致性和优雅（当然，后者有点主观）。它明显缺乏示例、演示或任何东西，也没有明显的插件架构。

它可能是一个纯粹主义者的图书馆，但不幸的是，现实世界正在将我从精英云中召唤出来。我会对整个事情持怀疑态度（他测试了哪个版本？他是否先接近开发人员询问为什么有些事情是这样的？），我记得[一些明智的话](http://www.joelonsoftware.com/articles/fog0000000069.html)（接近“两页长”），正是 Stack Overflow 的启动者 Joel Spolsky，所有这些看似疯狂或晦涩的代码实际上都是您的系统所获得的关于浏览器、平台、操作系统、编译器、版本、代码的知识等等。实际上，看起来像是纯粹主义者最可怕的噩梦的东西可能只是工作代码。

哦，阅读他最初帖子的评论后发现，他是一个傲慢的混蛋，他告诉任何不同意他的人，他们是无用的，一无所知，无能和更多的细节。优雅。

无论如何，回到破解我自己的主题地图引擎而不是使用其他人的引擎。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T12:03:05.490

嗯，在我看来，jQuery 是一个非常好的经过深思熟虑的库，它几乎没有命名空间冲突，并且通常符合 JavaScript 作为一门语言的精神。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T14:06:35.973

comp.lang.javascript 充满了铁杆狂热者。

这并不全是坏事。我认为由于所有的狙击，图书馆已经变得更好了。例如，这是来自 jQuery 1.3 发行说明：“No More Browser Sniffing。此版本的最后一个主要功能是您可能永远不会看到或直接处理的一个，但它是一个重要的更改，将有助于做出jQuery 持续时间更长，错误更少：从 1.3 开始，jQuery 不再在内部使用任何形式的浏览器/userAgent 嗅探——并且是第一个这样做的主要 JavaScript 库。”

我认为主要的库，尤其是 jQuery，现在已经如此根深蒂固，以至于浏览器的开发人员实际上必须适应 jQuery，而不是相反。如果你发布的浏览器在常见的 jQuery 操作中失败，人们会认为你的浏览器坏了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T12:07:46.057

jQuery 是一个真正的节省时间的工具，并且有一些很棒的特性。我不会让这家伙太让你失望的。试一试，得出你自己的结论。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T15:34:05.830

那个讨论已经进行了一段时间，clj上的人们有强烈的意见。

大多数批评都是关于 jQuery 所采取的方法，但事实证明，他们忽略了 jQuery 这样做的原因。例如，马特克鲁斯在名单上做出了回应

```
> Five seconds in, this line sticks out like a sore thumb:
> if ( typeof text !== "object" && text != null )

I mentioned this line in a recent thread on a jquery group...

> The first comparison does not need to be strict.  

The argument is that in some browsers, making it strict is actually
faster, and doesn't hurt anything. Supposing this is true, then it
makes sense to leave it as-is.

> The second comparison is obviously a waste of time.

Not true. The intent is to also catch cases where text is undefined,
and would then ==null. 
```

然后在他的[博客](http://mattkruse.com/2009/02/11/jquerys-latest-stab-at-competence/)上又一次非常恰当地：

> 所有库都需要权衡取舍。我只广泛使用过 jQuery，但我对其他人有一些知识和经验。
> 
> YUI 是健壮的，如果不是冗长的话。它有一些非常聪明的人，但它似乎没有像 jQuery 那样流行。当我看着它时，我觉得它“沉重”。其中也有一些可疑的编码实践。原型是一种已经存在很长时间的野兽，我不会推荐它。但它确实有很多面向对象的支持，如果那是你正在寻找的。IMO，javascript 不是 OO，所以我从不喜​​欢强迫它成为。ExtJS 非常漂亮和花哨，但它非常臃肿。我不知道代码是什么样子的。我知道它将被移植到使用 jQuery，但我不知道这是否发生了。MooTools 是一个黑客的库，而 IMO 它只是不提供 jQuery 不提供的任何东西。道场死了，AFAIK。我从来不喜欢它。
> 
> 所以，我最喜欢的是 jQuery。它有问题，而且远非完美。插件可能会被击中或错过。UI 框架似乎开始走出它的婴儿期，但它对于我的使用来说仍然有点过于臃肿。我使用 jQuery 的一部分并避免使用其他一些部分。我编写了大部分自己的插件，但我仍然编写了很多“纯”非 jQuery javascript。我发现当我要优化一大块 jQuery 代码以提高性能并对其进行概括时，这个过程会慢慢开始过滤掉 jQuery！因此，当我知道它会按预期工作时，我使用 jQuery 来快速完成工作并为方便起见，而对于复杂的事情，我最终会编写纯 js（并将其保存以供重用）。IMO，在最困难的情况下，任何框架都无法正常工作。

# iphone - 如何以编程方式将 UIView 或 UIImageView 与“touch up inside”之类的事件联系起来？

> ID：910334
> 
> 赞同：3
> 
> 时间：2009-05-26T12:00:04.637
> 
> 标签：iphone, events, event-handling

Interface Builder 只允许我为按钮连接此类事件。但就像在 HTML 中一样，我只想有一个空白的 UIImageView - 只要用户点击它 - 就会调用一个方法。我希望有一些很酷的编程方式可以做到这一点，我不知道。

更新：

在创建 UIImageView 的视图控制器中，我尝试这样做：

```
SEL actionSelector = @selector(doSomethingWhenImageIsTouched:);
[self.myUIImageView addTarget:nil action:actionSelector forControlEvents:UIControlEventTouchUpInside]; 
```

编译器给了我一个警告，UIImageView 可能无法响应 addTarget:... 我必须做什么才能使其与 UIImageView 一起使用。我在文档中看到 UIImageView 不是从 UIControl 继承的，但是 addTarget: 是 UIControl 的一部分。

更新：

在创建 UIImageView 之后，我最终创建了一个 UIButton。然后我将该按钮的框架设置为 UIImageView 的框架，并将 alpha 设置为 0.1f。由于某种原因，如果 alpha 为 0.0f，它将不起作用。然后，我做了那个很酷的 addTarget: 事情......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-05-02T17:44:26.330

在 SDK 版本 3.2（我不知道可能更早）中，您可以将手势识别器添加到 UIView。UIGestureRecogniser 是一个抽象类，允许您定义手势（点击、捏合、滑动等）并将其添加到 UIView 中，当手势识别器识别出手势时，它会在您想要的目标上触发一个动作。

在文档中阅读所有相关信息...：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-01T10:05:08.123

这里不可能使用 Target-Action 模型，因为 UIImageView 不像 UIButton 那样继承自 UIControl，它是从 UIView 派生的。因此，如果您想首先跟踪视图或图像视图上的触摸，您必须自定义类，然后将触摸开始事件放入其中并执行操作。否则使用可能对你有很大帮助的 UIGestures

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:13:50.823

UIView 通常不需要 IBAction 插座来接收触摸事件。通常，如果视图在 viewController 的控制下，您可以使用 touchesBegan 方法检查 UITouch 事件。要为控制操作设置目标和选择器，您还可以使用：

```
- (void)addTarget:(id)target action:(SEL)action forControlEvents:(UIControlEvents)controlEvents 
```

# groovy - 如何通过 URL 使用 Java/Groovy 打开 mp3 文件？

> ID：910347
> 
> 赞同：0
> 
> 时间：2009-05-26T12:02:19.967
> 
> 标签：groovy, mp3

有没有人有任何有用的建议/链接到有关在 Groovy 中使用 mp3 文件的信息。我很欣赏这与使用 Java 库一样，但想要一个简单的解决方案来解决这个问题：

*   我想通过 URL 加载一个 mp3 并询问它。
*   我想测试它是否存在并拉出标题、艺术家和默认图像（如果存在）。

任何帮助表示赞赏。谢谢。

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T12:57:29.950

试试 ID3 库？我还没有[从 Sourceforge 尝试过这个，](http://javamusictag.sourceforge.net/)但它看起来是正确的。

# html - 是否可以将嵌套 DIV 的 z-index 更高（显示“上方”）然后是 IE7 中的根 DIV？

> ID：910349
> 
> 赞同：2
> 
> 时间：2009-05-26T12:02:31.857
> 
> 标签：html, css, z-index

**更新！！！**

***建议的答案不正确，我的错误。#container DIV 应该有“float:left;”。请在 Firefox 和 IE7 中验证 HTML。你可以看到区别！***

我无法使用 z-index 让嵌套的 DIV 显示在层次较高的嵌套 DIV 上方...即使较低的嵌套 DIV 具有更高的 z-index ，叠加层仍会覆盖较低的嵌套 DIV...这是甚至可能在 IE7 中？

**以下显示 Firefox 中绿色 #overlay 上方的蓝色 #details，但在 IE7 中，蓝色 #details 位于绿色 #overlay 下方**

**UPDATE2：昂贵** ：添加“z-index：99；” #container 样式使类 .item div 出现（在 Firefox 中，IE 搞砸了：无论如何都不能正确显示），而它们应该在覆盖之下！如果没有设置#container z-index，它会在 Firefox 中正确显示，但在 IE 中无法正确显示...。

```
<html>
    <body>
        <style type="text/css">
            .item {
                float:left;width:75px;height:75px;background-color:red;
            }
        </style>
        <div id="main" style="position:relative;">
            <!-- this one should overlay everything, except #details -->
            <div id="overlay" style="position:absolute;
                                     top:0px;
                                     left:0px;
                                     width:500px;
                                     height:500px;
                                     z-index:1;
                                     background-color:green;"></div>
            <div id="container" style="position:relative;float:left;">
                <!-- these ones should display UNDER the overlay: so NOT visible -->
                <div class="item"></div>
                <div class="item"></div>
                <div class="item"></div>
                <div class="item"></div>
                <div class="item"></div>
                <!-- this one should display above the overlay -->
                <div id="details" style="position:absolute;
                                         width:200px;
                                         height:200px;
                                         background-color:blue;
                                         left:400px;
                                         z-index:99;"></div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T12:10:24.740

我相信你必须增加 #container 的 z-index 才能在 IE7 中进行这项工作。

[替代文字 http://img529.imageshack.us/img529/6416/24042958.jpg](http://img529.imageshack.us/img529/6416/24042958.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T10:57:20.210

我不认为 IE7 会让你这样做，除非你可以改变你的标记。

**#container 在被赋予绝对位置之前不会坐在#overlay 后面，如果你将#container 的z-index 更改为-1，那么它的子#details 就会跟在它后面。**

将 .items z-index 更改为 -1 也不起作用。

如果无法将#details 移到#container 之外？？如果没有确切地看到您试图实现的最终结果以及您拥有的控制权（如果有的话），我无法提出替代方案？

例如，叠加层有什么意义？它会是一个稍微透明的 div 还是实心的？如果用户无法在覆盖层后面看到它们，您不想隐藏 .items 吗？

您是否有权访问任何 javascript 库，例如 Jquery.. 以便能够将 #details 移动到 DOM 中的不同位置？

# apache-flex - 弹性缓冲数据

> ID：910357
> 
> 赞同：1
> 
> 时间：2009-05-26T12:04:36.267
> 
> 标签：apache-flex, actionscript-3, air, buffer

我们正在 Flex 中实现一个 AIR 应用程序。我们动态地填充画布并呈现它。问题是数据不是在画布更改之前构建的。有没有办法缓冲输出并在填充数据后呈现它？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:22:56.777

你可以做几件不同的事情。

1）使用状态 - 有一个加载数据状态，然后一旦数据到达，被处理等切换到新添加状态的状态。（我不推荐这种方法，因为它有点像 hack。你可以采用这种方法并使用 viewstack 或类似的东西，它必须作为状态实现（即，一旦数据处理完毕，就从可见索引 0 到 1 - 0 是加载状态，1 是可视组件）

2) 更好的做法是在处理数据后更新您的 UI。如果由于某种原因在您添加/更改了一些 UI 组件后 UI 没有更新，那么您需要了解诸如 invalidateProperties 和 invalidateDisplayList 之类的内容。我发现这个例子非常适合理解这些技术。[http://www.quietlyscheming.com/blog/components/randomwalk-component/](http://www.quietlyscheming.com/blog/components/randomwalk-component/)和[http://demo.quietlyscheming.com/RandomWalk/IconWalk.html](http://demo.quietlyscheming.com/RandomWalk/IconWalk.html)

# matlab - 将 ITK/VTK 导入 Matlab 或将 Matlab 导入 VTK/ITK 环境？

> ID：910362
> 
> 赞同：5
> 
> 时间：2009-05-26T12:07:56.260
> 
> 标签：matlab, import, development-environment, vtk

对于当前的项目，我必须使用矩阵中提供的信息并对其进行数学运算，并使用 ITK/VTK 函数来显示医疗信息/渲染。基本上我必须以（我猜）50/50 的方式同时使用 matlab 例程和 VTK/ITK。问题是，由于我必须同时使用这两种方法，我想提前决定使用哪种方法：

1.  **将 ITK 和 VTK 库导入 matlab：** 为此，您必须首先构建自己的 VTK。然后，通过[这个](http://www.mathworks.com/matlabcentral/fileexchange/19638)例子，整个想法是在 .mex 文件中编写您的 VTK 代码。这些是您可以在其中将 c 代码编程为 matlab 功能的文件。

2.  **在 ITK/VTK 环境中导入 matlab 函数：**为此我会使用一种语言，可能是 python，来进行矩阵计算。我可以使用 Numpy。这是 Python 中的 matlab 类计算模块，将 vtk 数据转换为 numpy 数据，我可以使用 matplotlib 来制作绘图。

**优点/缺点 ITK/VTK 在 matlab 中导入**
+ 易于进行 matlab 计算和绘图
+ matlab 是处理矩阵的最强大工具之一
+ 以前使用过 matlab（主观）

- 必须安装 matlab
- 运行 matlab 会增加你的电脑的负担

**在 ITK/VTK 环境中导入的优点 / 缺点 matlab**
+ 无需安装 matlab
+ 对 PC 的压力较小，而且由于医疗数据集需要您的 PC 提供很多，这很好。
+ 在这种情况下已经设置了 ITK/VTK 环境（目前以这种方式使用，但从未使用 matlab/matrices .mat）

- 听说过很难以这种方式进行 matlab 计算的故事。有点乱。
- 较少的python经验（结合matlab 0）

**所以...？结论**
实际上，我正在寻找在这两种环境之一中工作的人，但由于我认为其中有这么几个人，所以我喜欢在做出最终选择之前听取建议。让它以我需要的方式工作将花费大量时间，因此尝试两者都是浪费时间（也有截止日期）。

**额外说明**
- 我已经尝试将 Simulink for matlab 与 VTK/ITK 库结合使用，但我不喜欢它。
- 虽然问题的解决方案当然是我能在这里得到的最好的解决方案，但我也很高兴人们在做出与这个基本相同的选择方面有经验。做出这样的选择时要寻找哪些关键点？我是否错过了我的利弊中的一个关键点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:40:18.773

VTK comes with Python bindings ([one description](http://www.imaging.robarts.ca/~dgobbi/vtk/vtkpython.html)). I'm assuming ITK does too. If you don't already have a lot of code in Matlab, I'm guessing you'd have a much easier time seamlessly integrating VTK/ITK with python's numpy, matplotlib, etc.

**EDIT:**

In my opinion, non-trivial MEX functions are a pain to write. The tradeoff can often be writing new MEX functions for each task or taking extra time to write a lot of interfacing code.

Depending on what you're doing, scipy (a bundle of python packages including matplotlib, numpy, etc.) does a lot of what Matlab does. There are subtle differences and various tradeoffs. Automatic broadcasting is so incredibly useful, once you get the hang of it. MathWorks has recently added BSXFUN, but it's automatic with numpy. If you're doing a lot of work with sparse matrices or calling a lot of the more advanced linear algebra functions, check the numpy docs to see if what you need exists yet.

Depending on what you've done with your environment so far, I'd suggest trying out the Python approach for a few weeks. See if its plotting capabilities and math functions are sufficient for your needs. Expect to bang your head against the wall a little in the beginning because the documentation isn't as mature as Matlab's.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-20T00:22:45.137

这可能会有所帮助：mlabwrap 是一种从 Python 调用 Matlab 的相当复杂的方法。[http://mlabwrap.sourceforge.net/](http://mlabwrap.sourceforge.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-10T07:45:15.873

我花了一些时间来测试两个版本，但在这个问题上得出结论：

我选择将 python 与 numpy/scipy 和 matplotlib 结合使用。我选择使用它的主要原因只有一个。当您在 Matlab 中导入 itk 和 vtk 时，您必须使用 Mex 函数来编写您的 C 代码。这些 mex 文件以下列方式在例程中：

[替代文字 http://www.bastijn.nl/zooi/routine.png](http://www.bastijn.nl/zooi/routine.png)

现在，当例程到达 mex 文件所在的位置时，它会将控制权交给这个 mex 文件并像函数一样触发它，**mex 文件就像一个黑盒子**。在 Mex 文件完成它的工作后，它会将控制权交还给 matlab，然后程序继续。但是，在触发 Mex 文件或从 matlab 访问此 mexfile 中的变量时，您不能执行任何 matlab 操作。因此，不可能运行一些 itk/vtk 代码，请注意它不起作用并更改 mex 文件中使用的一些变量（在那里创建，但它们也会死在那里，因为黑盒只返回你的结果）速度测试什么是有效的。您必须再次触发整个 mex 功能。

这是一个主要缺点，因为您需要重新运行完整的 mex 文件（C 函数）以进行所有小改动。正在忙着修复这个主要的限制，但由于它们还没有准备好，我现在确实需要它，所以我选择了 python 之旅。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-27T11:24:10.980

有点旧的帖子，但我只想提一下 matVTK（[http://www.cir.meduniwien.ac.at/matvtk/](http://www.cir.meduniwien.ac.at/matvtk/)）。这使您可以在 Matlab 中进行所有计算，然后使用 vtk 库绘制数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-10T15:36:27.723

Bastjin，您做出了正确的选择：Python 规则！

更多信息：

对于选项 1，我写了这个：http: [//github.com/thewtex/matlab-itk-import](http://github.com/thewtex/matlab-itk-import) 但是，正如你提到的，它是次等的选项。

以下是选项 2 的一些链接： Mayavi2 的 mlab 具有很好的在 VTK 和 numpy 之间切换的能力。

WrapITK 允许您在 Python 中编写 ITK 管道，并且您可以使用 Numpy 与在那里找到的 PyBuffer 外部项目来回切换。

# javascript - 最大可点击选项#IE8

> ID：910368
> 
> 赞同：2
> 
> 时间：2009-05-26T12:09:30.547
> 
> 标签：javascript, internet-explorer-8, html-select

选择元素中可点击选项的最大数量似乎存在限制。

如果有一个带有 3200 多个选项的选择元素。从 3125 到 N 的项目在单击时不会触发更改事件。但是，可以使用键盘选择项目。

知道这是错误还是 IE8 的功能？IE6、IE7、FF或chrome都没有这个问题。

这是一个例子：

```
<html>
  <head>
    <title>Large select</title>
  <script>
  function loadData()
  {
    var s=document.getElementById('s');
    for(i=0;i<3500;i++)
      s.options[i]=new Option(i);
  }
  </script>
</head>
<body onload="loadData()">
<select id="s" multiple="multiple" size="20" onchange="alert('change')"></select>
</body>
</html> 
```

**更新**：我在 ie8 beta (8.0.7000.0) 中尝试过这个。它似乎在 ie8 final 中完美运行

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T12:13:35.360

> 在...中没有这样的问题

问题？！我是唯一一个害怕你创造的野兽的 SO 用户吗？

只是出于好奇，为什么你有这么多选择？

**编辑：**不要误会我的意思，学习事物的上限很有趣。但是现在我已经看到它现在可以在 IE8 最终版中使用，我的下一个网站将至少有 6000 个`<options>`我`<select>`使用的网站！

摇滚吧！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T12:18:19.030

**这是您永远不**应该遇到的另一个限制。就像数据库表中的最大列数一样。即使询问限制是多少也表明设计存在严重缺陷。

# java - 为什么Java有瞬态字段？

> ID：910374
> 
> 赞同：1595
> 
> 时间：2009-05-26T12:11:36.673
> 
> 标签：java, field, transient

为什么Java有**瞬态**字段？

* * *

## 回答 #1

> 赞同：1787
> 
> 时间：2009-05-26T12:53:22.953

Java中的`transient`关键字用于指示字段不应该是序列化（这意味着像文件一样保存）过程的一部分。

来自[Java 语言规范，Java SE 7 版](http://docs.oracle.com/javase/specs/jls/se7/html/index.html)，[第 8.3.1.3 节。`transient`领域](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.1.3)：

> 可以标记变量`transient`以指示它们不是对象的持久状态的一部分。

例如，您可能有从其他字段派生的字段，并且只能以编程方式完成，而不是通过序列化来保持状态。

这是一个`GalleryImage`包含图像和从图像派生的缩略图的类：

```
class GalleryImage implements Serializable
{
    private Image image;
    private transient Image thumbnailImage;

    private void generateThumbnail()
    {
        // Generate thumbnail.
    }

    private void readObject(ObjectInputStream inputStream)
            throws IOException, ClassNotFoundException
    {
        inputStream.defaultReadObject();
        generateThumbnail();
    }    
} 
```

在此示例中，是通过调用该方法`thumbnailImage`生成的缩略图。`generateThumbnail`

该`thumbnailImage`字段标记为`transient`，因此仅对`image`原始图像进行序列化，而不是同时保留原始图像和缩略图图像。这意味着保存序列化对象所需的存储空间更少。（当然，根据系统的要求，这可能是可取的，也可能不是可取的——这只是一个例子。）

在反序列化时，[`readObject`](http://java.sun.com/javase/6/docs/api/java/io/ObjectInputStream.html#readObject())调用该方法以执行将对象状态恢复到发生序列化时的状态所需的任何操作。这里需要生成缩略图，所以`readObject`重写了方法，调用`generateThumbnail`方法生成缩略图。

有关其他信息，文章[Discover the secrets of the Java Serialization API](http://www.oracle.com/technetwork/articles/java/javaserial-1536170.html)（最初可在 Sun Developer Network 上获得）有一个部分讨论了`transient`关键字用于防止某些字段序列化的用法并提供了一个场景。

* * *

## 回答 #2

> 赞同：472
> 
> 时间：2012-09-23T09:12:18.583

在理解`transient`关键字之前，必须先了解序列化的概念。如果读者了解序列化，请跳过第一点。

### 什么是序列化？

序列化是使对象的状态持久化的过程。这意味着对象的状态被转换为字节流以用于持久化（例如在文件中存储字节）或传输（例如通过网络发送字节）。同样，我们可以使用反序列化从字节中恢复对象的状态。这是 Java 编程中的重要概念之一，因为序列化主要用于网络编程。需要通过网络传输的对象必须转换为字节。为此，每个类或接口都必须实现该[`Serializable`](https://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html)接口。它是一个没有任何方法的标记接口。

### 现在`transient`关键字及其用途是什么？

默认情况下，对象的所有变量都会转换为持久状态。在某些情况下，您可能希望避免保留某些变量，因为您不需要保留这些变量。因此，您可以将这些变量声明为`transient`. 如果变量被声明为`transient`，那么它将不会被持久化。这是`transient`关键字的主要目的。

我想用下面的例子来解释以上两点（借用[这篇文章](http://www.javabeat.net/what-is-transient-keyword-in-java/)）：

> ```
> package javabeat.samples;
>  
> import java.io.FileInputStream;
> import java.io.FileOutputStream;
> import java.io.IOException;
> import java.io.ObjectInputStream;
> import java.io.ObjectOutputStream;
> import java.io.Serializable;
>  
> class NameStore implements Serializable{
>     private String firstName;
>     private transient String middleName;
>     private String lastName;
> 
>     public NameStore (String fName, String mName, String lName){
>         this.firstName = fName;
>         this.middleName = mName;
>         this.lastName = lName;
>     }
> 
>     public String toString(){
>         StringBuffer sb = new StringBuffer(40);
>         sb.append("First Name : ");
>         sb.append(this.firstName);
>         sb.append("Middle Name : ");
>         sb.append(this.middleName);
>         sb.append("Last Name : ");
>         sb.append(this.lastName);
>         return sb.toString();
>     }
> }
> 
> public class TransientExample{
>     public static void main(String args[]) throws Exception {
>         NameStore nameStore = new NameStore("Steve", "Middle","Jobs");
>         ObjectOutputStream o = new ObjectOutputStream(new FileOutputStream("nameStore"));
>         // writing to object
>         o.writeObject(nameStore);
>         o.close();
>  
>         // reading from object
>         ObjectInputStream in = new ObjectInputStream(new FileInputStream("nameStore"));
>         NameStore nameStore1 = (NameStore)in.readObject();
>         System.out.println(nameStore1);
>     }
> } 
> ```

输出如下：

> ```
> First Name : Steve
> Middle Name : null
> Last Name : Jobs 
> ```

*Middle Name*被声明为`transient`，因此它不会存储在持久存储中。

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2009-05-26T12:13:50.430

允许您定义不想序列化的变量。

在一个对象中，您可能拥有不想序列化/持久化的信息（可能是对父工厂对象的引用），或者序列化可能没有意义。将这些标记为“瞬态”意味着序列化机制将忽略这些字段。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2014-03-18T22:04:28.983

**为什么 Java 中需要瞬态字段？**

该`transient`关键字使您可以对序列化过程进行一些控制，并允许您从该过程中排除一些对象属性。序列化过程用于持久化 Java 对象，主要是为了在传输或不活动时保留它们的状态。有时，不序列化对象的某些属性是有意义的。

**您应该将哪些字段标记为瞬态？**

现在我们知道了`transient`关键字和瞬态字段的用途，重要的是要知道哪些字段要标记瞬态。静态字段也没有序列化，因此相应的关键字也可以解决问题。但这可能会破坏您的课程设计；这就是`transient`关键字来拯救的地方。我尽量不允许序列化其值可以从其他字段派生的字段，因此我将它们标记为瞬态的。如果您有一个名为的字段`interest`，其值可以从其他字段（`principal`，`rate`& `time`）中计算出来，则无需对其进行序列化。

另一个很好的例子是文章字数。如果您要保存整篇文章，则实际上不需要保存字数，因为它可以在文章“反序列化”时计算。或者想想记录器；`Logger`实例几乎不需要被序列化，因此它们可以是瞬态的。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-05-26T12:15:43.997

`transient`变量是类序列化时不包含的变量。

想到什么时候这可能有用的一个例子是，仅在特定对象实例的上下文中才有意义的变量，并且在您序列化和反序列化对象后变得无效。在这种情况下，让这些变量变为有用是很有用的，`null`这样您就可以在需要时使用有用的数据重新初始化它们。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-05-28T02:20:46.850

本机 java 以外的序列化系统也可以使用此修饰符。例如，Hibernate 不会保留标记有**@Transient**或**瞬态**修饰符的字段。兵马俑也尊重这个修饰符。

我相信修饰符的比喻意义是“这个字段仅供内存使用。不要以任何方式将其保留或移动到此特定 VM 之外。它是不可移植的”。即你不能依赖它在另一个VM 内存空间中的值。很像**volatile**意味着您不能依赖某些内存和线程语义。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2010-03-26T14:16:29.647

`transient`用于表示类字段不需要序列化。最好的例子可能是一个`Thread`字段。通常没有理由序列化 a `Thread`，因为它的状态非常“特定于流”。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-07-01T13:12:27.717

在我回答这个问题之前，我需要解释一下序列化，因为如果你理解它在科学计算机中的序列化是什么意思，你就可以很容易地理解这个关键字。

当对象通过网络传输/保存在物理媒体（文件，...）上时，必须“序列化”对象。序列化转换字节状态对象系列。这些字节在网络上发送/保存，并从这些字节重新创建对象。

例子：

```
public class Foo implements Serializable 
{
 private String attr1;
 private String attr2;
 ...
} 
```

现在，如果这个类中有一个字段你不想转移或保存，你可以使用`transient`关键字

```
private transient attr2; 
```

这可以防止在序列化类时包含字段表单。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-05-26T12:15:38.490

因为并非所有变量都具有可序列化的性质

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-05-26T12:19:31.743

当您不想共享一些与序列化相关的敏感数据时，就需要它。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-11-02T08:56:39.017

根据谷歌短暂的意思==只持续很短的时间；暂时的。

现在，如果您想在 java 中使用瞬态关键字。

**Q：在哪里使用瞬态？**

**A：**一般在java中我们可以通过在变量中获取数据并将这些变量写入文件来将数据保存到文件中，这个过程称为序列化。现在，如果我们想避免将变量数据写入文件，我们将该变量设置为瞬态。

```
transient int result=10; 
```

**注意：**瞬态变量不能是本地的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-06-05T03:09:36.640

瞬态关键字的简化示例代码。

```
import java.io.*;

class NameStore implements Serializable {
    private String firstName, lastName;
    private transient String fullName;

    public NameStore (String fName, String lName){
        this.firstName = fName;
        this.lastName = lName;
        buildFullName();
    }

    private void buildFullName() {
        // assume building fullName is compuational/memory intensive!
        this.fullName = this.firstName + " " + this.lastName;
    }

    public String toString(){
        return "First Name : " + this.firstName
            + "\nLast Name : " + this.lastName
            + "\nFull Name : " + this.fullName;
    }

    private void readObject(ObjectInputStream inputStream)
            throws IOException, ClassNotFoundException
    {
        inputStream.defaultReadObject();
        buildFullName();
    }
}

public class TransientExample{
    public static void main(String args[]) throws Exception {
        ObjectOutputStream o = new ObjectOutputStream(new FileOutputStream("ns"));
        o.writeObject(new NameStore("Steve", "Jobs"));
        o.close();

        ObjectInputStream in = new ObjectInputStream(new FileInputStream("ns"));
        NameStore ns = (NameStore)in.readObject();
        System.out.println(ns);
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-14T13:40:27.380

简单地说，transient java 关键字保护字段不被序列化作为它们的非瞬态字段对应部分。

在这段代码片段中，我们的抽象类 BaseJob 实现了 Serializable 接口，我们从 BaseJob 扩展，但我们不需要序列化远程和本地数据源；仅序列化组织名称和 isSynced 字段。

```
public abstract class BaseJob implements Serializable{
   public void ShouldRetryRun(){}
}

public class SyncOrganizationJob extends BaseJob {

   public String organizationName;
   public Boolean isSynced

   @Inject transient RemoteDataSource remoteDataSource;
   @Inject transient LocalDaoSource localDataSource;

   public SyncOrganizationJob(String organizationName) {
     super(new 
         Params(BACKGROUND).groupBy(GROUP).requireNetwork().persist());

      this.organizationName = organizationName;
      this.isSynced=isSynced;

   }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-01-24T09:12:22.327

使用瞬态修饰符声明的字段将不参与序列化过程。当一个对象被序列化（以任何状态保存）时，其瞬态字段的值在序列表示中被忽略，而瞬态字段以外的字段将参与序列化过程。这就是瞬态关键字的主要目的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-07-04T03:28:54.360

因为并非所有变量都具有可序列化的性质。

1.  序列化和反序列化是对称的过程，如果不是你不能期望结果是确定的，在大多数情况下，未确定的值是没有意义的；
2.  序列化和反序列化是幂等的，这意味着您可以根据需要进行多次序列化，并且结果是相同的。

所以如果Object可以存在于内存而不存在于磁盘上，那么Object就不能被序列化，因为反序列化时机器无法恢复内存映射。例如，您不能序列化`Stream`对象。

你不能序列化一个`Connection`对象，因为它的状态也依赖于远程站点。

# iphone - 如何在 UIScrollView 中嵌套 UIScrollView，以便用户可以滚动内部 UIScrollView？

> ID：910378
> 
> 赞同：8
> 
> 时间：2009-05-26T12:13:28.090
> 
> 标签：iphone, cocoa-touch, uikit, uiscrollview

我还没有尝试过，但我假设一旦我知道用户想要在子滚动视图中滚动，我就必须禁用父滚动视图的滚动，对吧？

两个滚动视图都是水平滚动的。

如何暂时禁用父级的滚动检测？还是有其他方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T19:08:16.910

UIScrollView 有一个名为 的属性`scrollEnabled`，您可以将其设置`NO`为禁用父滚动视图中的滚动。

我还没有尝试过，但您可能会发现它做正确的事，即内部滚动视图滚动直到它不能再滚动，此时外部滚动视图滚动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-23T03:34:07.673

这是很有可能的。最简单的方法是禁用该`scrollEnabled`属性，您也可以尝试将 outer 设置为其边界，使其不会滚动。根据您的需要，您也可以将 No 设置为，但这基本上会使您的滚动视图像常规 UIView 一样。`UIScrollView``contentSize``bounce`

If you have control over all the child `UIScrollView`'s, you can implement `UIScrollViewDelegate` protocol, but if you don't, or your child `UIScrollView` is really a `UITableView`, or `UICollectionView`, then you can't really rely the `UIScrollViewDelegate` protocol, but remember `UIScrollView` comes with a `panGestureRecognizer` and you can play with that. A powerful but heavy handed way is to add an observer on the `panGestureRecognizer`'s `state` property so that you can capture all the events without being the delegate of the `UIScrollView` in question.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-07T20:13:27.013

我这样做了，它确实导致父 scrollView 不再滚动，这很好*，但是*通过 presentModalViewController 推送的子 scrollView 仍然不响应滚动事件（例如向上或向下滚动）。我显然错过了一些东西......

**编辑**：通过在父视图上使用'scrollEnabled'终于让它工作了。谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-02T20:35:48.877

在我为内部 ScrollView 的 contentSize 动态设置足够的高度之前，我遇到了同样的问题，使用：

```
[scrollView setContentSize:CGSizeMake(scrollView.frame.size.width,600)]; 
```

显然这只是一个硬编码的例子，你应该设置显示整个视图内容所需的高度，最后可能不需要滚动。

似乎使用 IBuilder 设置 scrollView 的高度是不够的，所以不需要滚动，这就是为什么我认为扫描事件没有到达内部滚动。

希望这可以帮助！

# nhibernate - 使用 nHibernate 时，谁创建类文件？

> ID：910384
> 
> 赞同：0
> 
> 时间：2009-05-26T12:16:50.000
> 
> 标签：nhibernate

我的印象是，在使用 nHibernate 时，在创建映射 xml 文件等之后，基本 CRUD 操作的所有管道都已为您完成，以及类文件，即

```
public class Employee
{
       public virtual string Name {get; set; }

} 
```

但是我在这里一定是错的，因为似乎没有生成任何东西，或者它是在第一个页面加载时构建会话/配置时在内部生成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:20:13.893

我们首先创建类文件，然后是映射，然后我们生成 db。

直接使用映射属性使这种风格（IMO 更容易）代码看起来很像这样：

```
public class Base {
    [Id(..., Column="{{Id.Column}}")]
    [AttributeIdentifier(Name="Id.Column", Value="ID")] // Default value
    public int Id { ... }
}
[AttributeIdentifier(Name="Id.Column", Value="SUB_ID")]
[Class] public class MappedSubClass : Base { } 
```

我认为生成的 db 模型与我从 db 设计开始时有点不同 - 但我对结果感到满意。

如果您将很多类相互嵌套，请确保延迟加载正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T12:21:03.503

我不相信 nHibernate 会为您生成这些类，但您可以使用 CodeSmith 或下一个版本的 LLBLGen 等工具为您生成它们。

在 hibernates 网站的“有用的工具”部分下查看一些可能有用的工具。其中一些将生成映射和类文件。您可以尝试其中一个，并且只将类文件作为您的类的基础。

[https://www.hibernate.org/365.html](https://www.hibernate.org/365.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T12:22:30.457

[有一个生成类的工具](http://nhforge.org/doc/nh/en/index.html#toolsetguide-s2)（我认为只有java），但我建议自己编写类。这是您的域类，您应该特别注意它们。它不像类型化的记录集或仅用于数据库交互的东西。

另一方面，强烈推荐[创建 db 模式的工具。](http://nhforge.org/doc/nh/en/index.html#toolsetguide-s1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T08:01:08.787

据我所知，NHibernate 不会为您创建类。我在这方面遇到的两个非常好的工具是

1.  我的世代 - 免费

2.  CodeSmith - 获得许可。

抱歉，由于 stackoverflow 的一些限制，无法添加超链接。

# sql-server-2005 - 如何使用 CTE 使用 nHibernate 对数据进行分页？

> ID：910392
> 
> 赞同：0
> 
> 时间：2009-05-26T12:19:04.117
> 
> 标签：sql-server-2005, nhibernate

是否有人可以向我展示任何示例代码，这些代码将通过给定表中的数据进行分页，并在后台使用 CTE？

nhibernate 是否可以开箱即用地跨各种数据库工作？我现在使用的是 MS SQL Server 2008，但是如果客户有一天想使用 Oracle 怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T12:32:02.373

对于分页，您只需在查询中定义开始和结束结果：

```
IQuery q = sess.CreateQuery("from DomesticCat cat");
q.SetFirstResult(20);
q.SetMaxResults(10);
IList cats = q.List(); 
```

请参阅[参考文档](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-queryinterface)

NHibernate 应该可以跨各种数据库工作。许多方言已实现并且开箱即用。SqlServer 和 Oracle 都得到了很好的支持。

有关支持的方言列表，请参阅[参考文档。](http://nhforge.org/doc/nh/en/index.html#configuration-optional-dialects)

# c# - 从 Excel 中读取（范围为多维数组）C#

> ID：910400
> 
> 赞同：13
> 
> 时间：2009-05-26T12:20:38.463
> 
> 标签：c#, excel, multidimensional-array

如何从 Excel 工作表中读取并将标记的选择（区域）加载到多维数组中？Excel 中的列本身可能是一个多维数组，因为它包含的值不止一个。

现在的想法（不确定这是好是坏）是对所有 Excel.Area（选定字段）进行 for 循环，并将该字段的内容添加到多维数组中。由于多维数组是 object[,] 类型的，因此是非泛型的，因此没有方便的 add() 方法。所有这些都需要手动完成。

知道这种方法是否可行或者是否可以更有效地完成？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-26T12:31:32.483

您可以将 Range 的值读取为数组：

```
using (MSExcel.Application app = MSExcel.Application.CreateApplication()) 
{
    MSExcel.Workbook book1 = app.Workbooks.Open( this.txtOpen_FilePath.Text);
    MSExcel.Worksheet sheet = (MSExcel.Worksheet)book1.Worksheets[1];
    MSExcel.Range range = sheet.GetRange("A1", "F13");

    object value = range.Value; //the value is boxed two-dimensional array
} 
```

此代码片段来自[MS Office 的 .NET 包装器](http://www.codeplex.com/msofficefornet)。但同样的原则在 MS Excel 中的 VSTO 或 VBA 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T14:18:49.147

这是使用[SpreadsheetGear](http://www.spreadsheetgear.com/)执行此操作的 C# 代码：

```
 // Load the workbook.
    SpreadsheetGear.IWorkbook workbook = SpreadsheetGear.Factory.GetWorkbook(@"MyWorkbook.xlsx");
    // Get a range of cells as an array of object[,].
    object[,] values = (object[,])workbook.Worksheets["MySheet"].Cells["A1:J10"].Value; 
```

SpreadsheetGear 还提供了一次访问一个单元格的快速 API，这样您就可以避免将值复制到数组而不牺牲性能。

免责声明：我拥有 SpreadsheetGear LLC

# asp.net - Asp.net：自定义角色和成员资格提供程序，LoginStatus 控件没有反应

> ID：910403
> 
> 赞同：0
> 
> 时间：2009-05-26T12:21:26.967
> 
> 标签：asp.net, membership-provider, web-controls

参与了一个项目，其中一半的团队正在构建数据库和 Web 服务层，我们正在构建一个单独的前端 Web 服务消费站点。

我们正在构建一个自定义角色和成员资格提供者，它将通过 Web 服务层进行操作。

只是做一些早期的原型设计，设置角色，检查页面权限并查看菜单项是否根据角色关闭和打开等。

出现了一件奇怪的物品。内置的 loginview 控件根据某人是否登录在 LoggedInTemplate 和 AnonymousTemplate 之间正确切换。

但是 LoginStatus 控件根本没有反应。它始终显示 LoggedOut 文本。

我会猜到 LoginView 和 LoginStatus 的运行方式相同，即只是在新的提供程序中进行测试，然后他们就可以使用它了。

身份验证当然也是表单。

任何人都知道在将 LoginStatus 控件与自定义提供程序一起使用时要注意的任何特定设置吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-29T09:30:46.690

一旦正确使用了所有角色和提供者方法 - 一切都很好

# asp.net - iis 7.0，模块顺序更改

> ID：910408
> 
> 赞同：7
> 
> 时间：2009-05-26T12:23:42.983
> 
> 标签：asp.net, iis-7

“条目无法重新排序，因为其中一个或多个已被锁定在父文件中”

在 iis 7.0 管理器中，当我尝试更改应用程序中模块的顺序时，它会显示此消息。

如何更改模块的顺序？是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T12:26:48.937

你不能在服务器级别而不是站点级别上做吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T09:25:51.290

要更改站点的模块顺序，您首先需要在服务器级别解锁受影响的模块。因为你并不真正知道哪些模块受到影响，所以我通常将它们全部解锁。最简单的方法是使用 PowerShell 脚本（如果您仍在使用 IIS7，则需要下载[PowerShell IIS snapin](http://www.iis.net/downloads/microsoft/powershell)）。

将以下内容保存到文本文件中： unlock-modules.ps1

```
 Import-Module WebAdministration

 Get-WebConfiguration `
 -pspath 'MACHINE/WEBROOT/APPHOST' `
 -filter "system.webServer/modules/add" -recurse | `
 where {$_.PSPath -eq 'MACHINE/WEBROOT/APPHOST' -and $_.Type -eq ''} `
 | foreach {         
     $filter = "system.webServer/modules/add[@name='" + $_.Name + "']"     
     Remove-WebConfigurationLock -pspath 'MACHINE/WEBROOT/APPHOST'  -filter $filter -verbose
 } 
```

以提升的管理员身份打开 PowerShell 提示符并运行脚本。

该脚本循环遍历服务器级别的所有模块。通常只有本地模块（带有和空的'type'属性）被锁定。全部解锁。

现在您可以在站点级别更改模块的顺序。

重新排序时要小心，如果更改某些系统模块的顺序，IIS 可能不再按预期方式工作。

还要记住，如果您在服务器级别对模块进行更改，站点将不再继承这些，您也必须将它们应用到站点级别。

# java - java 记录器通过多个类和包到一个文件

> ID：910410
> 
> 赞同：0
> 
> 时间：2009-05-26T12:24:00.017
> 
> 标签：java, logging

我试图弄清楚如何使用 java.util.logging 功能。所有的教程都展示了如何从主类登录到日志文件，但我不知道如何在不同的类中登录到一个文件。我有一个 Web 服务和一个 Web 服务客户端，我希望能够在使用 Web 服务客户端时在 Web 服务上记录错误。

我尝试创建一个记录器类，但最终得到了 38 个空日志文件。我应该如何创建一个在 Web 服务上的每个类中调用的记录器？Web 服务有两个不同的包和各种类。

在我的搜索中，我遇到了单例记录器类的想法。我试图弄清楚如何实现它：

```
public class Logger{

private static Logger self = new Logger();

//empty private constructor
private Logger(){

}

//synchronized getInstance
public static synchronized Logger getInstance(){
    if (self == null)
        self = new Logger();
    return self;
}

//prevent cloning
public Object clone() throws CloneNotSupportedException {
    throw new CloneNotSupportedException(); 
}

//synchronized logging
public synchronized void debug(String msg){

}
public synchronized void info(String msg){

}
public synchronized void fatal(String msg){

} 
```

}

要在我的其他类中调用它，我需要在每个类中创建一个文件处理程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T12:29:26.280

这就是[JDK 日志框架](http://java.sun.com/j2se/1.5.0/docs/api/java/util/logging/package-summary.html)具有[处理程序](http://java.sun.com/j2se/1.5.0/docs/api/java/util/logging/Handler.html)的目的。将[FileHandler](http://java.sun.com/j2se/1.5.0/docs/api/java/util/logging/FileHandler.html)添加到位于记录器层次结构根目录的记录器中，所有内容都将记录到该文件处理程序中。您必须注意处理程序也有自己的日志级别这一事实。

因此，无需实现自己的日志框架。它已经在那里，而且已经很好了。（如果您不喜欢 JDK 日志记录，请将[Apache Commons Logging](http://commons.apache.org/logging/)与 JDK 记录器或[log4j](http://logging.apache.org/log4j/)一起使用。）

# svn - 如何将代码导入 Subversion？

> ID：910412
> 
> 赞同：1
> 
> 时间：2009-05-26T12:24:57.660
> 
> 标签：svn

我在 SourceForge 上使用 Subversion，并在 WinXP 上通过 TortoiseSVN 发送了一些代码，这是修订版 1。当我更改某些内容时，我尝试将其作为修订版 2 发送，但我不知道如何发送。我当然在 Linux 上尝试了 RapidSVN、eSVN、kdesvn，但我遇到了同样的错误：

svn: /svnroot/projects/****/****.kdevelop 已经存在，或者类似的东西，其中 **** 是我的项目名称。

我必须做什么才能将其作为 Revision 2 发送？

PS对不起愚蠢的问题和糟糕的英语。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T12:26:41.837

使用命令行工具来熟悉颠覆。然后这些工具将更有意义。

```
svn commit 
```

在您签出的工作目录中

做：

```
mkdir ws
svn co file:///path/to/repo/trunk ws
cd ws
... make changes ...
svn commit 
```

它应该说一些类似的东西

```
Transmitted Revision 2. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T12:31:31.937

如果您不知道有不同语言的好手册：http: [//svnbook.red-bean.com/](http://svnbook.red-bean.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T12:32:28.427

在您所指的初始代码“导入”之后，您只需要“签入”或“提交”您的更改；版本控制基于修订之间的差异，而不是每次都导入整个文件。

[SVN](http://svnbook.red-bean.com/)的书一开始就很慢，有一章很好地介绍了源代码控制的[基本概念](http://svnbook.red-bean.com/en/1.5/svn.basic.html)。

# c# - 从 Windows 移动应用程序调用经过身份验证的 Web 服务 - 需要访问 cookie 容器

> ID：910415
> 
> 赞同：1
> 
> 时间：2009-05-26T12:25:57.767
> 
> 标签：c#, web-services, windows-mobile, cookies

我正在编写一个需要调用 Web 服务的 Windows 移动客户端。

Web 服务有一个登录方法，该方法在 cookie 中返回会话 ID。

我已经使用普通的 winforms 编写了一个快速测试应用程序，我可以毫无问题地访问 Web 服务 cookiecontainer 属性

在我的 windows mobile 项目（针对 windows mobile 专业版 6.0 的 C# .net 2.0）中，我可以在 Web 服务中引用作为 Web 引用，但是为我的 Web 服务创建的代理类上没有 cookiecontainer 属性。

有什么方法可以取回 cookie，以便我可以保存它并将会话 ID cookie 与后续请求一起发送回来？

**[编辑 1]**

如果没有，是否有更好的方法来处理 Web 服务上的身份验证，而不是捎带现有的 asp.net 网站的成员资格和使用会话？

# c# - 如何在 WPF 中保存全局应用程序变量？

> ID：910421
> 
> 赞同：10
> 
> 时间：2009-05-26T12:28:12.303
> 
> 标签：c#, wpf, global-variables

在 WPF 中，在一个 UserControl 中我可以在哪里**保存一个值**，然后在另一个 UserControl中再次**访问该值**，类似于 Web 编程中的会话状态，例如：

**UserControl1.xaml.cs：**

```
Customer customer = new Customer(12334);
ApplicationState.SetValue("currentCustomer", customer); //PSEUDO-CODE 
```

**UserControl2.xaml.cs：**

```
Customer customer = ApplicationState.GetValue("currentCustomer") as Customer; //PSEUDO-CODE 
```

# 回答：

谢谢，鲍勃，这是我根据你的代码开始工作的代码：

```
public static class ApplicationState
{
    private static Dictionary<string, object> _values =
               new Dictionary<string, object>();
    public static void SetValue(string key, object value)
    {
        if (_values.ContainsKey(key))
        {
            _values.Remove(key);
        }
        _values.Add(key, value);
    }
    public static T GetValue<T>(string key)
    {
        if (_values.ContainsKey(key))
        {
            return (T)_values[key];
        }
        else
        {
            return default(T);
        }
    }
} 
```

要保存变量：

```
ApplicationState.SetValue("currentCustomerName", "Jim Smith"); 
```

读取变量：

```
MainText.Text = ApplicationState.GetValue<string>("currentCustomerName"); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T13:42:34.900

[Application 类](http://msdn.microsoft.com/en-us/library/ms743714.aspx#The_Application_Class)已经内置了这个功能。

```
// Set an application-scope resource
Application.Current.Resources["ApplicationScopeResource"] = Brushes.White;
...
// Get an application-scope resource
Brush whiteBrush = (Brush)Application.Current.Resources["ApplicationScopeResource"]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T12:39:36.757

像这样的东西应该工作。

```
public static class ApplicationState 
{ 
    private static Dictionary<string, object> _values =
               new Dictionary<string, object>();

    public static void SetValue(string key, object value) 
    {
        _values.Add(key, value);
    }

    public static T GetValue<T>(string key) 
    {
        return (T)_values[key];
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T12:33:25.770

您可以在 App.xaml.cs 文件中公开一个公共静态变量，然后使用 App 类在任何地方访问它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T12:29:57.650

可以自己将其存储在静态类或存储库中，您可以将其注入到需要数据的类中。

# performance - 哪个更快？比较还是赋值？

> ID：910423
> 
> 赞同：51
> 
> 时间：2009-05-26T12:28:41.770
> 
> 标签：performance, optimization, refactoring

我正在做一些编码，我必须编写这种代码：

```
if( array[i]==false )
    array[i]=true; 
```

我想知道它是否应该重写为

```
array[i]=true; 
```

这就提出了一个问题：比较比分配更快吗？

语言之间的差异如何？（java和cpp之间的对比，例如）

*注意：我听说过“过早的优化是万恶之源”。我认为这不适用于这里:)*

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-26T12:33:18.797

这不仅仅是[*过早的优化*](http://prematureoptimization.org/blog/archives/26)，这是*[微优化](http://www.codinghorror.com/blog/archives/000185.html)*，这是无关紧要的干扰。

假设您的数组是布尔类型，那么您的比较是不必要的，这是唯一相关的观察。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-26T12:32:29.173

好吧，既然您说您确定这很重要，您应该只编写一个测试程序并进行测量以找出差异。

如果对分配在内存中分散地址的多个变量执行此代码，则比较可以更快。通过比较，您只会将数据从内存读取到处理器缓存，并且如果在缓存决定刷新该行时您不更改变量值，它将看到该行没有更改并且无需将其写回到内存。这可以加快执行速度。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-26T12:42:09.247

编辑：我用 PHP 编写了一个脚本。我只是注意到其中有一个明显的错误，这意味着最佳情况下的运行时间计算不正确（可怕的是没有其他人注意到！）

最好的情况*胜过*直接的分配，但最坏的情况比简单的分配*要糟糕得多。*就现实世界的数据而言，分配可能是最快的。

输出：

*   在 0.0119960308075 秒内分配
*   0.0188510417938 秒内的最坏情况比较
*   0.0116770267487 秒内的最佳情况比较

代码：

```
<?php
$arr = array();

$mtime = explode(" ", microtime());
$starttime = $mtime[1] + $mtime[0];

reset_arr($arr);

for ($i=0;$i<10000;$i++)
    $arr[i] = true;

$mtime = explode(" ", microtime());
$firsttime = $mtime[1] + $mtime[0];
$totaltime = ($firsttime - $starttime);
echo "assignment in ".$totaltime." seconds<br />"; 

reset_arr($arr);

for ($i=0;$i<10000;$i++)
    if ($arr[i])
        $arr[i] = true;

$mtime = explode(" ", microtime());
$secondtime = $mtime[1] + $mtime[0];
$totaltime = ($secondtime - $firsttime);
echo "worst case comparison in ".$totaltime." seconds<br />"; 

reset_arr($arr);

for ($i=0;$i<10000;$i++)
    if (!$arr[i])
        $arr[i] = false;

$mtime = explode(" ", microtime());
$thirdtime = $mtime[1] + $mtime[0];
$totaltime = ($thirdtime - $secondtime);
echo "best case comparison in ".$totaltime." seconds<br />"; 

function reset_arr($arr) {
    for ($i=0;$i<10000;$i++)
        $arr[$i] = false;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-29T13:46:53.710

我相信如果比较和赋值语句都是原子的（即一个处理器指令）并且循环执行 n 次，那么在最坏的情况下比较然后分配将需要 n+1（在每次迭代中比较加上设置分配）执行，而不断分配布尔值需要 n 次执行。所以第二个效率更高。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-08T17:45:04.053

取决于语言。然而，遍历数组也可能代价高昂。如果数组在连续内存中，最快的方法是使用 memcpy 在整个数组中写入 1 位（255 秒），假设您的语言/编译器可以做到这一点。

因此总共执行 0 次读取 - 1 次写入，没有读取/写入循环变量/数组变量（每个循环 2 次读取/2 次写入）数百次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T12:35:17.717

我真的不希望对于像这样微不足道的事情会有任何明显的性能差异，因此可以肯定的是，它可以为您提供清晰、更具可读性的代码。我认为这将始终是真实的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T12:37:23.487

可以试试这个：

```
if(!array[i])
    array[i]=true; 
```

但真正确定的唯一方法是分析，我相信几乎任何编译器都会认为与 false 的比较是不必要的，并对其进行优化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T12:38:16.433

这完全取决于数据类型。分配布尔值比首先比较它们要快。但对于较大的基于值的数据类型，这可能并非如此。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T16:03:51.290

正如其他人所指出的，这是微优化。

（在政治或新闻业中，这被称为肚脐凝视 ;-)

程序是否足够大，可以有超过几层的函数/方法/子程序调用？

如果是这样，它可能有一些可以避免的调用，而这些调用可能会浪费数百个与低级低效率一样多的时间。

假设您已经[删除了那些](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)（很少有人这样做），那么一定要在秒表下运行 10^9 次，看看哪个更快。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-10-08T22:32:22.337

你为什么还要写第一个版本？在设置为真之前检查是否为假有什么好处。如果您总是将其设置为 true，那么请始终将其设置为 true。

当您遇到性能瓶颈并追溯到不必要地设置单个布尔值时，请回来与我们交谈。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-11-02T05:58:15.510

我记得在一本关于汇编语言的书中，作者声称如果可能的话，应该避免 if 条件。如果条件为假并且执行必须跳转到另一行，则速度要慢得多，从而大大降低了性能。此外，由于程序是用机器代码执行的，我认为“if”在每种（编译的）语言中都比较慢，除非它的条件几乎一直都是真的。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-05-26T16:09:58.080

如果您只想翻转值，请执行以下操作：

```
array[i] = !array[i]; 
```

使用它的性能实际上更差，因为它不必只检查一次真假值然后设置，而是检查两次。

如果您声明一个 1000000 元素数组的真、假、真、假模式比较会更慢。(var b = !b) 本质上是检查两次而不是一次

# c# - 如果我在我的代码中添加一些东西，我怎样才能让我的单元测试失败？

> ID：910429
> 
> 赞同：0
> 
> 时间：2009-05-26T12:31:02.140
> 
> 标签：c#, unit-testing, poco

我希望我的单元测试涵盖我的 POCO。

我应该如何测试它们？

如果我添加一个新属性怎么办？如何让我的测试失败？

测试我知道的属性和方法，但问题是，如何确保我的测试失败是将任何东西添加到我的 poco 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T12:36:00.010

测试就是验证所写的内容是否能够做它应该做的事情，不多也不少。所以如果你写一些代码，你这样做是有原因的。您的测试应该反映代码确实与您编写代码的原因相匹配。就是这样，没有别的了。Iow：如果你写了一堆类，你应该测试你写的行为与行为应该做的相比是否确实正确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T12:38:08.680

通过阅读您的问题，您要么误解了 POCO 是什么，要么误解了单元测试。

POCO 只是一个老式的对象。它有状态和行为。您通过将（设置）值放入属性中并断言该值是您期望的值来对状态进行单元测试。您通过针对方法断言期望来对行为进行单元测试。

这是 POCO 及其测试的过度简化示例。请注意，测试代码多于实现代码。当单元测试正确完成（TDD）时，就是这种情况。

```
public class Person
{
    private Name name = Name.Empty;
    private Address address = Address.Empty;
    private bool canMove;

    public Name Name
    {
        set { name = value; }
        get { return name; }
    }

    public Address Address
    {
        private set { address = value; }
        get { return address; }
    }

    public bool CanMove
    {
        set { canMove = value; }
        get { return value; }
    }

    public bool MoveToNewAddress(Address newAddress)
    {
        if (!CanMove) return false;
        address = newAddress;
        return true;
    }
}

[TestFixture]
public class PersonTests
{
    private Person toTest;
    private readonly static Name NAME = new Name { First = "Charlie", Last = "Brown" };
    private readonly static Address ADDRESS =
        new Address {
            Line1 = "1600 Pennsylvania Ave NW",
            City = "Washington",
            State = "DC",
            ZipCode = "20500" };

    [SetUp]
    public void SetUp()
    {
        toTest = new Person;
    }

    [Test]
    public void NameDefaultsToEmpty()
    {
        Assert.AreEqual(Name.Empty, toTest.Name);
    }

    [Test]
    public void CanMoveDefaultsToTrue()
    {
        Assert.AreEqual(true, toTest.CanMove);
    }

    [Test]
    public void AddressDefaultsToEmpty()
    {
        Assert.AreEqual(Address.Empty, toTest.Address);
    }

    [Test]
    public void NameIsSet()
    {

        toTest.Name = NAME;
        Assert.AreEqual(NAME, toTest.Name);
    }

    [Test]
    public void CanMoveIsSet()
    {
        toTest.CanMove = false;
        Assert.AreEqual(false, toTest.CanMove);
    }

    [Test]
    public void AddressIsChanged()
    {
        Assert.IsTrue(toTest.MoveToNewAddress(ADDRESS));
        Assert.AreEqual(ADDRESS, toTest.Address);
    }

    [Test]
    public void AddressIsNotChanged()
    {
        toTest.CanMove = false;
        Assert.IsFalse(toTest.MoveToNewAddress(ADDRESS));
        Assert.AreNotEqual(ADDRESS, toTest.Address);
    }
} 
```

为了使测试首先失败，存根方法或属性，但不实现任何行为。运行测试，观察它们失败，然后一次添加一行，直到它通过。一旦过去，停下来。除非您编写更多测试，否则不要编写更多代码（除非您正在重构，在这种情况下您不添加行为）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T12:35:11.057

如果你想在类中添加一个新特性，写一个因为特性没有实现而失败的测试，然后实现这个特性，看看测试通过了。

或者...

在构建过程中运行代码覆盖率指标。它们将指示是否添加了代码气体而没有被测试覆盖。

或者...

作为构建的一部分运行突变测试。他们将指出是否有任何覆盖代码的测试只是通过它而不是实际测试任何东西。

或以上所有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T14:10:25.887

1.  我相信您不应该将框架与您自己的代码一起测试，例如，如果您有这样的自动生成属性：

    ```
    public string Name
    {get;set;} 
    ```

    没有必要有一个测试方法来查看它是否工作正常。

2.  你不应该测试你的类的内部状态，而应该测试它的行为。
3.  有时（有些人可能总是说）最好在编写代码之前编写测试。这样你必须了解你想要做什么而不是了解如何去做。（这种方法称为测试驱动开发）

这是TDD循环：

*   编写测试并获得红色信号
*   编写代码并获得绿色信号
*   重构代码，你应该得到一个绿色信号

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T15:52:40.160

也许您所说的 POCO 是指 DTO，在这种情况下，答案是：

不，您不应该测试您的 DTO，而是测试与它们一起工作的服务。

# perl - 如何在 Perl 中列出给定对象或包的可用方法？

> ID：910430
> 
> 赞同：44
> 
> 时间：2009-05-26T12:31:13.827
> 
> 标签：perl, introspection

如何在 Perl 中列出给定对象或包的可用方法？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-26T13:08:54.920

在 Perl 中有（相当）很多方法可以做到这一点，因为在 Perl 中有很多方法可以做到这一点。正如有人评论的那样，自动加载的方法总是有点棘手。但是，与其采用自己的方法，我建议您查看 CPAN 上的[Class::Inspector](http://search.cpan.org/~adamk/Class-Inspector-1.24/lib/Class/Inspector.pm)。这将使您可以执行以下操作：

```
my $methods =   Class::Inspector->methods( 'Foo::Class', 'full', 'public' ); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-26T12:42:41.557

如果你有一个名为 的包`Foo`，应该这样做：

```
no strict 'refs';
for(keys %Foo::) { # All the symbols in Foo's symbol table
  print "$_\n" if exists &{"Foo::$_"}; # check if symbol is method
}
use strict 'refs'; 
```

或者，要获取 package 中所有方法的列表`Foo`：

```
no strict 'refs';
my @methods = grep { defined &{"Foo::$_"} } keys %Foo::;
use strict 'refs'; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-26T14:51:11.280

如果你有一个使用[Moose](http://p3rl.org/Moose)的包，它相当简单：

```
print PackageNameHere->meta->dump; 
```

对于更完整的数据：

```
use Data::Dumper;
print Dumper( PackageNameHere->meta ); 
```

会让你开始。对于其他一切，出现`->meta`在[Class::MOP::Class中的方法](http://p3rl.org/Class::MOP::Class)

你可以对没有它的包做一些 AdHoc 假装驼鹿的好处：

```
use Class::MOP::Class;
my $meta = Class::MOP::Class->initialize( PackageNameHere ); 
```

然后像使用 Moose 一样继续使用 Class::MOP 方法。

对于初学者：

```
 $meta->get_method_map(); 
```

**使用驼鹿；**#，*真棒*。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T15:24:44.117

一般来说，你不能用像 Perl 这样的动态语言来做到这一点。该包可能定义了一些您可以找到的方法，但它也可以即时组成在您使用它们之前没有定义的方法。此外，即使调用一个方法（有效）也可能不会定义它。这就是使动态语言变得更好的东西。:)

你想解决什么任务？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-29T14:50:01.853

[如何获取结构和继承历史](https://stackoverflow.com/questions/59512734/how-to-get-structure-and-inheritance-history-of-a-perl-object-not-a-class)的一个很好的答案
可以使用以下方法找到对象类当前继承的类：

```
use mro          qw( );
use Scalar::Util qw( blessed );
say join ", ", @{ mro::get_linear_isa(blessed($o)) }; 
```

# objective-c - 另一个：NSString 比较在 Objective-C 中不起作用

> ID：910431
> 
> 赞同：2
> 
> 时间：2009-05-26T12:31:18.507
> 
> 标签：objective-c

我正在尝试使用**IsEqualToString**方法（我之前已经成功使用过）。但我收到以下错误：

**-[NSCFString IsEqualToString:]：无法识别的选择器发送到实例 0xa055e7b0**

这是代码：

```
@interface EditHabitViewController : UIViewController<UITableViewDataSource,UITableViewDelegate> {

NSString *contactId;
}
@property (nonatomic, retain) NSString *contactId;

-(void)updateContactInfo {
NSString *sSQL = @"";
NSString *sCheck= self.contactId;

// nothing to load? then leave: 
if ([sCheck IsEqualToString: @"0"]) {
    return;
} // end if 
```

请注意，sCheck 和 contactId 都被声明为 NSString。这真让我抓狂！

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T12:33:46.800

你有一些错误的大写`IsEqualToString:`——试试吧`isEqualToString:`。

# java - 如何使用 Java HTMLParser 库解析大型 HTML 文件

> ID：910438
> 
> 赞同：3
> 
> 时间：2009-05-26T12:32:47.753
> 
> 标签：java, parsing

我有一些由 Filemaker 导出创建的 html 文件。每个文件基本上都是一个巨大的 HTML 表格。我想遍历表行并将它们填充到数据库中。我曾尝试使用[HTMLParser](http://htmlparser.sourceforge.net/)进行如下操作：

```
String inputHTML = readFile("filemakerExport.htm","UTF-8");
Parser parser = new Parser();
parser.setInputHTML(inputHTML);
parser.setEncoding("UTF-8");    
NodeList nl = parser.parse(null); 
NodeList trs = nl.extractAllNodesThatMatch(new TagNameFilter("tr"),true);
for(int i=0;i<trs.size();i++) {
    NodeList nodes = trs.elementAt(i).getChildren();
    NodeList tds  = nodes.extractAllNodesThatMatch(new TagNameFilter("td"),true);
    // Do stuff with tds
} 
```

上面的代码适用于 1 Mb 以下的文件。不幸的是，我有一个 4.8 Mbs 的 html 文件，并且出现内存不足错误。

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
    at org.htmlparser.lexer.Lexer.parseTag(Lexer.java:1002)
    at org.htmlparser.lexer.Lexer.nextNode(Lexer.java:369)
    at org.htmlparser.scanners.CompositeTagScanner.scan(CompositeTagScanner.java:111)
    at org.htmlparser.util.IteratorImpl.nextNode(IteratorImpl.java:92)
    at org.htmlparser.Parser.parse(Parser.java:701)
    at Tools.main(Tools.java:33) 
```

有没有更有效的方法来使用 HTMLParser 解决这个问题（我对这个库完全陌生），或者我应该使用不同的库或方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T12:37:00.757

您是否尝试过增加 JVM 的最大堆大小

以下命令行参数将其增加到 512 兆字节：-Xmx512M

例如

```
java -Xmx512M myrunclass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:02:28.117

当您只想提取一些信息并且您对执行某些 XPath 查询或其他类型的查询在 DOM 结构（父子关系等）上表现最好时，不要构建 DOM。

使用 Parser.visitAllNodesWith() 而不是 Prser.parse()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-30T22:01:17.630

我遇到了同样的问题。HtmlParser 似乎存在内存泄漏问题和缺乏文档。使用 JProfiler 进行分析我注意到解析页面 HtmlParser 包含指向它处理的 html 代码的链接。我尝试在解析结束时调用 parser.reset() 。它没有帮助。我还查看了测试代码，但没有发现任何提示。

结果，我通过调用 parser.setInputHTML(""); 大大减少了内存使用量。当我不再需要解析器对象时。

PS最好分析一下HtmlParser的源码，不过我没时间做这个：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-01T08:45:54.433

HTMLParser 有一个解析器和一个词法分析器。解析器构建一个内存模型，但词法分析器只是通知您文件中的标签。对于固定数据的简单提取，词法分析器可能是提取数据的最有效方法，您必须在遇到标签时跟踪 html 的结构。HTMlParser 库已经有一段时间没有发布了，因此内存问题令人担忧，因为它们似乎不太可能得到修复。如果您需要高级解析，请尝试 JSoup，因为它具有强大的查询语法并且非常易于使用。

# parsing - 解决我的语法中的 shift-reduce 冲突的问题

> ID：910445
> 
> 赞同：6
> 
> 时间：2009-05-26T12:34:11.137
> 
> 标签：parsing, grammar, shift-reduce-conflict, irony

我正在尝试用[Irony](http://www.codeplex.com/irony/)编写一个小型解析器。不幸的是，我遇到了“减少班次冲突”。语法不是我的强项，我只需要完成这件小事。这是产生错误的简化语法：

```
ExpressionTerm := "asd"
LogicalExpression :=
    ExpressionTerm |
    LogicalExpression "AND" LogicalExpression |
    LogicalExpression "OR" LogicalExpression 
```

“班次减少冲突”是什么意思，我该如何解决？我认为这意味着我的语法模棱两可，但我无法充分扭曲我的逻辑以了解如何。

**补充：**澄清 - “asd”只是一个文字字符串“asd”。所以我希望这个语法会解析以下表达式：

```
asd
asd AND asd
asd AND asd OR asd
asd OR asd AND asd OR asd 
```

**补充2：**忘了说，语法的根是`LogicalExpression`。

**补充3：**啊，我明白了！模棱两可是因为像这样的表达

```
asd AND asd OR asd 
```

可以用两种不同的方式来解释：

```
(asd AND asd) OR asd
asd AND (asd OR asd) 
```

但是我该如何解决呢？好的，我可以将 AND 或 OR 中的一个设置为比另一个更强大（无论如何我都想这样做）。但是现在我看到即使只有一个操作员也会出现错误。换句话说，这也会产生同样的错误：

```
LogicalExpression := "asd" | LogicalExpression "OR" LogicalExpression 
```

在这种情况下，我想要这个：

```
asd OR asd OR asd 
```

要解析为：

```
(asd OR asd) OR asd 
```

这样做的明确方式是什么？

**补充4：**知道了！

```
LogicalExpression1 := LogicalExpression1 "OR" LogicalExpression2 | LogicalExpression2
LogicalExpression2 := LogicalExpression2 "AND" LogicalExpression3 | LogicalExpression3
LogicalExpression3 := "NOT" LogicalExpression4 | LogicalExpression4
LogicalExpression4 := "asd" | "(" LogicalExpression1 ")" 
```

这会解析所有布尔表达式，运算符优先级为 NOT->AND->OR。“asd”可以替换为您的条款的表达方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T12:41:07.613

如果您只使用一个前瞻，您的语法是模棱两可的。为了说明，什么是“asd”？它是 ExpressionTerm 还是更长的期限。这就是轮班减少冲突。我怀疑这里也存在减少-减少冲突。

大多数 LL(1) / LALR(1) 生成器将提供一些方法来通过优先运算符处理移位减少冲突。在存在移位减少冲突的情况下，大多数也将默认为最长的序列，因此通常可以忽略这些（经过一些审查）。（在这种情况下，您可能需要将单个术语移到底部才能使其正常运行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T12:45:25.450

Shift-Reduce 冲突意味着您的语法不明确。使用您的递归规则，标记“asd”可以被解释为`ExpressionTerm`or`LogicalExpression`的一部分，并且解析器无法决定哪个。需要一个额外的规则来打破平局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T01:16:17.240

当涉及到解析器时，减少冲突是让你的大脑更难处理的事情之一。说明冲突的最简单方法是在这个伪代码中：

```
if (a) then
   if (b) then
     printf('a + b');
   else
     print('this could be a + !b or !a'); 
```

else 语句可以绑定到第一个或第二个 if。在模棱两可的语法的情况下，您通常定义一个值来指示语法中预期的移位减少警告的数量。

或者，您可以使用 LL(k) 或 LL(*) 解析器。这些类型的解析器没有移位/减少歧义。根据您的应用程序，它们可能比 LALR(1) 解析器更容易或更难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-08T13:22:16.040

语法模棱两可，`LL(1)`或者`LALR(1)`因为 asd 标记可以被替换，`ExpressionTerm`并且还可以`LogicalExpression`展平语法规则以解决移位/减少冲突

# ruby-on-rails - Rails：验证是否选择了 date_select 中的所有字段，但仍将 :prompt 设置为 true

> ID：910453
> 
> 赞同：3
> 
> 时间：2009-05-26T12:36:30.633
> 
> 标签：ruby-on-rails

当使用带有 :prompt => true 的 Rails date_select 时，我在提交未选择所有字段的表单时看到一些非常奇怪的行为。例如。

提交表单时选择了 1 月，但默认提示中留下的日期和年份字段会导致 1 月 1 日 0001 被传递给模型验证。如果验证失败并且再次呈现表单，则仍然选择一月（正确），但日期设置为 1（错误）。如果提交表单时只选择了年份，则月份和日期都设置为 1。

这是非常奇怪的行为 - 谁能给我一个解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T07:43:19.587

问题与多参数分配有关。基本上，您希望将三个值存储到一个属性中（即。`written_at`）。date_select 将其发送`{ 'written_at(1)' => '2009', 'written_at(2)' => '5', 'written_at(3)' => '27' }`给控制器。活动记录将这三个值打包成一个字符串，并用它初始化一个新的 Date 对象。

例如，当您尝试使用无效日期实例化它时，问题开始于 Date 引发异常的事实`Date.new(2009, 0, 1)`。Rails 捕获该错误并改为实例化一个 Time 对象。Rails 中支持时区的 Time 类具有各种神奇的功能，使其不会因无效数据而引发。这使您的一天变成了 1。

在此过程中，活动记录会丢失原始值散列，因为它会将内容打包`written_at`到一个数组中并尝试从中创建一个日期或时间对象。这就是表单无法再使用该`written_at_before_time_cast`方法访问它的原因。

解决方法是向您的模型添加六种方法：`written_at_year`、`written_at_year=`和`written_at_year_before_type_cast`（用于年、月和日）。过滤器`before_validation`可以重建日期并将其写入written_at。

```
class Event < ActiveRecord::Base
  before_validation :reconstruct_written_at

  def written_at_year=(year)
    @written_at_year_before_type_cast = year
  end

  def written_at_year
    written_at_year_before_type_cast || written_at.year
  end

  def written_at_year_before_type_cast
    @written_at_year_before_type_cast
  end

  private

  def reconstruct_written_at
    written_at = Date.new(written_at_year, written_at_month, written_at_day)
  rescue ArgumentError
    written_at = nil
  end
end 
```

# jquery - Jquery - 花式框和回调

> ID：910455
> 
> 赞同：8
> 
> 时间：2009-05-26T12:36:35.517
> 
> 标签：jquery, fancybox

我对fancybox有问题。
我想写一个在fancybox打开时运行的函数。如何以及何时调用该函数？

例子：

```
function myFunc() {
    alert("Opened!");
}

$('.content a').fancybox({ 
    'hideOnContentClick': false ,
    'callBackOnShow': myFunc(), // This not working! It call function when page is loaded
    'frameWidth': 920,
    'frameHeight': 530
}); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-26T12:39:25.900

而不是`myFunc()`使用`myFunc`. 在 javascript 中，带有括号（和/或 args）的函数意味着您要调用它。没有它们的函数名称意味着您只需要对该函数的引用（这可能是 fancybox 想要的）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-01-21T18:39:53.960

这有效

```
$("#element").fancybox({
    onStart     :   function() {
        return window.confirm('Continue?');
    },
    onCancel    :   function() {
        alert('Canceled!');
    },
    onComplete  :   function() {
        alert('Completed!');
    },
    onCleanup   :   function() {
        return window.confirm('Close?');
    },
    onClosed    :   function() {
        alert('Closed!');
    }
}); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-09T13:13:16.613

使其工作的最新方法是使用 afterShow 或 beforeShow：

```
$("a#registrace").fancybox({
  beforeShow   : function() {
    alert('its working!');
    validate_reg_form();
  }
}); 
```

我正在通过 ajax 加载注册表单，我需要启用表单验证。在这两种情况下（之前和之后），内容已经加载。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T13:08:05.217

实际上，在检查文档时，您的选项列表中有错字...

你有`callBackOnShow`，但应该是`callbackOnShow`（小写 b）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T13:04:37.173

它应该是：-

```
function myFunc() {
    alert("Opened!");
}

$('.content a').fancybox({ 
    'hideOnContentClick': false ,
    'callBackOnShow': myFunc, // no brackets
    'frameWidth': 920,
    'frameHeight': 530
}); 
```

或者，您可以创建一个匿名函数...

```
$('.content a').fancybox({ 
    'hideOnContentClick': false ,
    'callBackOnShow': function() { alert('hello'); },
    'frameWidth': 920,
    'frameHeight': 530
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T13:11:11.170

```
'callbackOnShow': myFunc 
```

小写 b 因为选项区分大小写，并且 myFunc 上没有括号，因为您希望将函数作为选项传递，而不是调用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-26T13:49:51.843

正如您的标题所说的“Jquery - fancybox 和回调”，您可以在选项卡回调下找到 fancybox 2 插件的完整回调选项列表。

[http://fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)

如果您使用旧的fancybox，也许升级到fancybox2，因为新插件具有更好的功能，更多的控制。

# php - PHP中的未定义变量错误

> ID：910457
> 
> 赞同：3
> 
> 时间：2009-05-26T12:37:03.580
> 
> 标签：php, mysql

```
Notice: Undefined variable: username in C:\xampp\htdocs\test_class.php
        on line 20
Notice: Undefined variable: password in C:\xampp\htdocs\test_class.php
        on line 20 
```

当我使用这段代码通过我的数据库检查我的用户名和密码时，我得到了上述错误。

```
<?php
    class test_class {

        public function __construct() { 

        }
        public function doLogin() {

            include("connection.php");

            if (isset($_POST['username']))
                {
                $username= $_POST['username'];
                }
                if (isset($_POST['password']))
                {
                $password= $_POST['password'];
                } 

            $query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
            $result = mysql_fetch_array(mysql_query($query));
            if(!$result)

            {

            return 'assa';

            }else{

            return 'assa112121212';

            }

                }
        }
?> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T12:43:04.317

这很可能意味着您的表单尚未提交。您应该确保仅使用存在的变量。此外，您[永远不](http://xkcd.com/327/)应该在未经验证的情况下使用来自用户的输入。尝试以下操作，例如：

```
if (isset($_POST['username']) && isset($_POST['password']))
{
    $username= $_POST['username'];
    $password= $_POST['password'];
    $query = "SELECT *
                      FROM users
                      WHERE username = '".mysql_real_escape_string($username)."'
                      AND password = '".mysql_real_escape_string($password)."'";
    $result = mysql_fetch_array(mysql_query($query));
    # ...
}
else
{
    return NULL;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-26T12:39:43.637

这只是一个**通知**，即在查询中引用的变量不在范围内。

在 doLogin() 的顶部定义 $username 和 $password 并将它们初始化为 Null 或类似的。然后稍后检查它们。

无论 $username 和 $password 是否设置，您似乎也在执行查询。你应该做更多类似的事情：

```
if( isset($_POST['username']) && isset($_POST['password'])){
     //create vars, do query
}else{
     // Nothing to process
} 
```

这两个错误都发生在第 20 行，我认为这是查询字符串插值。这里的问题是：

1.  范围/引用不一致（无论如何这在 PHP 中很糟糕）
2.  你的 ifs 需要更有序一些。这个错误很小，但如果你处理这样的变量，更糟糕的错误会在以后咬你：)

另外：**在将变量像热煤一样倾倒到 SQL 中之前转义变量，** 请参阅 PDO（我会选择）或 mysql_escape_string()

**祝你好运**！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T13:00:48.820

再上一堂快乐的课，没有错误:)

```
<?php
class test_class
{
    private $post = array();
    public function __construct ()
    {
    }
    public function doLogin ()
    {
        $this->post = $_POST;
        include ("connection.php");
        if ($this->post['username'] && $this->post['password']) {
            $username = $this->post['username'];
            $password = $this->post['password'];
            $query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
            $result = mysql_fetch_array(mysql_query($query));
            if (! $result) {
                return 'assa';
            } else {
                return 'assa112121212';
            }
        }
    }
}
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T12:44:59.307

```
<?php
class test_class {

    public function doLogin() {
        include("connection.php");

        if (isset($_POST['username']) && isset($_POST['password']) {
            $username = $_POST['username'];
            $password = $_POST['password'];

            $query = "SELECT * ".
                     "FROM users " .
                     "WHERE username = '$username' ".
                     "  AND password = '$password'";
            $result = mysql_fetch_array(mysql_query($query));
            if(!$result) {
               return 'assa';
            } else {
               return 'assa112121212';
            }
        } else {
            echo "Missing parameter 'username' and/or 'password'";
        }
    }
} 
```

此外，您应该[转义](http://se.php.net/mysql_real_escape_string) *$username*和*$password*以避免[sql 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T12:51:25.453

您还在检查数据库是否提供了用户名和密码。

也许是这样的；

```
public function doLogin() {

    include("connection.php");
    $username = (isset($_POST['username'])) ? $_POST['username'] : NULL ;
    $password = (isset($_POST['password'])) ? $_POST['password'] : NULL ;
        if ( $username !== NULL && $password !== NULL )  {
                    $query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
                    $result = mysql_fetch_array(mysql_query($query));
            /* auth code here */

        } else {
        return false; // no u/p provided    
    }

    } 
```

在将输入放在数据库附近之前，您还应该通过使用[`mysql_real_escape_string`](http://php.net/mysql_real_escape_string)或[PDO（PHP 数据对象）转义输入](http://php.net/pdo)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T12:42:15.503

您将要使用 error_reporting(E_ALL ^ E_NOTICE); 从 Sam 链接到的页面。通知实际上是不必要的，就像在 gcc 中使用 WALL 和 WERROR 标志一样。

# c++ - 如何捕获文件创建和负责的调用者

> ID：910459
> 
> 赞同：0
> 
> 时间：2009-05-26T12:37:08.540
> 
> 标签：c++, winapi, file, debugging, creation

我们正在使用第三方库来渲染 3d。在这个库中，有一个“内存跟踪器”功能，可以跟踪库在执行期间分配和释放的所有内存。这是一个很好的功能，因为它有助于确定例如内存泄漏。

通过调用该库中的某个函数，会在进程的当前工作目录中生成一个日志文件。最近我注意到这个文件出现在几个不同的地方，所以我的第一个想法当然是总是将当前工作目录设置为我希望显示日志的文件夹，这很好用。

然而，事实证明，这个文件仍然是在不同的地方创建的，而没有被程序调用过上述函数。因此，该文件必须在未经我同意的情况下由库以某种方式创建。这个库的创建者说引擎从不在内部调用这个方法。

所以，为了证明他是错的（或者证明自己是愚蠢的（虽然这不是第一次）），我需要一种方法来准确地捕捉到这个文件的创建时间。**FindFirstChangeNotification()**不会这样做，因为这只会为我提供某些文件夹中发生的事情的信息。理想情况下，我想（在进程内或进程外）在发生这种情况时拦截并以某种方式注入进程异常（例如，让 WinDbg 捕获这个），所以我通过调用堆栈获取我想要的信息。

欢迎任何建议。

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T12:44:45.560

你可以试试：

1.  使用[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)或[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)之类的工具，它们可能足以追踪它。
2.  使用挂钩库并用您自己的函数替换 CreateFile（或更多函数，如果需要）。我对[Detours](http://research.microsoft.com/en-us/projects/detours/)有很好的经验，它有一些非常好的例子，你可以直接使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T13:53:02.273

您需要使用自定义 CreateFile 创建注入 DLL，如下所示：

```
/** We'll create a custom version of the CreateFile (WinAPI).
  *
  *
  */
HANDLE WINAPI __CreateFile(LPCWSTR fileName,
                           DWORD desiredAccess,
                           DWORD shareMode,
                           LPSECURITY_ATTRIBUTES securityAttributes,
                           DWORD createDisp,
                           DWORD flags,
                           HANDLE tmp)
{
        // At very first, we shall call the original CreateFile.

        HANDLE file = Real_CreateFile(fileName,
                                      desiredAccess,
                                      shareMode,
                                      securityAttributes,
                                      createDisp,
                                      flags,
                                      tmp);

        /** Here, you can do whatever you wish with fileName and the handle, file.
          *
          * ...
          */

        return file;
}
```

然而，这还不够。您还需要从 Detours 中受益：

```
BOOL APIENTRY DllMain(HANDLE module, DWORD reasonForCall, LPVOID reserved)
{
        switch (reasonForCall) {
                case DLL_PROCESS_ATTACH: {
                        if (::GetModuleHandle(L"blablabla.exe") == NULL) {
                                DetourTransactionBegin();
                                DetourUpdateThread(GetCurrentThread());
                                DetourAttach(&(PVOID &)Real_CreateFile, __CreateFile);
                                DetourTransactionCommit();
                }

                break;

                case DLL_THREAD_ATTACH: {
                }

                break;

                case DLL_THREAD_DETACH: {
                }

                break;

                case DLL_PROCESS_DETACH: {
                        if (::GetModuleHandle(L"blablabla.exe") == NULL) {
                                DetourTransactionBegin();
                                DetourUpdateThread(GetCurrentThread());
                                DetourDetach(&(PVOID&)Real_CreateFile, __CreateFile);
                                DetourTransactionCommit();
                        }
                }
    }

    return TRUE;
}
```

我把剩下的留给你练习。这只是一个方向。您还需要找到合适的 IPC 方法来进行数据传输。

# java - 如何为 ANT build.xml 文件设置环境变量？（爪哇）

> ID：910461
> 
> 赞同：2
> 
> 时间：2009-05-26T12:37:32.270
> 
> 标签：java, ant, classpath

我正在尝试使用 Windows 版本的 Eclipse 打开一个项目，但在选择打开 build.xml 文件后，错误消息显示：

> 从 javac 类路径设置项目的类路径时出现问题：C:\project1\${env.TOMCATEB_HOME}

我试图在 Windows 控制面板中设置 TOMCATEB_HOME 环境变量，指向 Tomcat 根文件夹（有卸载.exe 的那个），但没有效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T12:59:38.793

[向下滚动以设置环境变量](http://www.onjava.com/pub/a/onjava/excerpt/anttdg2_ch11/index1.html)

# c# - 避免无参数的 SQL 注入

> ID：910465
> 
> 赞同：110
> 
> 时间：2009-05-26T12:38:20.550
> 
> 标签：c#, asp.net, sql-server, sql-injection

我们正在讨论在我们的代码中使用参数化的 sql 查询。我们在讨论中有两个方面：我和其他一些人说我们应该始终使用参数来防止 sql 注入以及其他认为没有必要的人。相反，他们希望在所有字符串中用两个撇号替换单个撇号，以避免 sql 注入。我们的数据库都在运行 Sql Server 2005 或 2008，我们的代码库在 .NET framework 2.0 上运行。

让我在 C# 中给你一个简单的例子：

我希望我们使用这个：

```
string sql = "SELECT * FROM Users WHERE Name=@name";
SqlCommand getUser = new SqlCommand(sql, connection);
getUser.Parameters.AddWithValue("@name", userName);
//... blabla - do something here, this is safe 
```

而其他人想要这样做：

```
string sql = "SELECT * FROM Users WHERE Name=" + SafeDBString(name);
SqlCommand getUser = new SqlCommand(sql, connection);
//... blabla - are we safe now? 
```

其中 SafeDBString 函数定义如下：

```
string SafeDBString(string inputValue) 
{
    return "'" + inputValue.Replace("'", "''") + "'";
} 
```

现在，只要我们在查询中的所有字符串值上使用 SafeDBString，我们就应该是安全的。对？

使用 SafeDBString 函数有两个原因。首先，这是自石器时代以来的方式，其次，由于您看到在数据库上运行的精确查询，因此更容易调试 sql 语句。

那么。我的问题是使用 SafeDBString 函数是否真的足以避免 sql 注入攻击。我一直在尝试找到违反此安全措施的代码示例，但我找不到任何示例。

有没有人可以打破这个？你会怎么做？

**编辑：** 总结到目前为止的答复：

*   还没有人找到绕过 Sql Server 2005 或 2008 上的 SafeDBString 的方法。这很好，我想？
*   一些回复指出，使用参数化查询可以提高性能。原因是查询计划可以重复使用。
*   我们也同意使用参数化查询可以提供更易于维护的可读代码
*   此外，始终使用参数比使用各种版本的 SafeDBString、字符串到数字的转换和字符串到日期的转换更容易。
*   使用参数，您可以获得自动类型转换，这在我们处理日期或十进制数字时特别有用。
*   最后：[不要](https://stackoverflow.com/questions/910465/avoiding-sql-injection-without-parameters/910694#910694)像 JulianR 所写的那样尝试自己做安全工作。数据库供应商在安全性上花费了大量时间和金钱。我们没有办法做得更好，也没有理由尝试做他们的工作。

因此，虽然没有人能够破坏 SafeDBString 函数的简单安全性，但我得到了许多其他好的论据。谢谢！

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-05-26T13:31:01.507

我认为正确的答案是：

**不要试图自己做安全**。使用任何值得信赖的行业标准库来解决您正在尝试做的事情，而不是*尝试*自己做。无论您对安全性做出何种假设，都可能是不正确的。尽管您自己的方法看起来很安全（而且充其量看起来很不稳定），但您可能会忽略某些东西，您真的想在安全方面抓住这个机会吗？

使用参数。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2009-05-26T12:45:21.893

然后有人去使用“而不是”。参数是，IMO，唯一安全的方法。

它还避免了很多关于日期/数字的 i18n 问题；03 年 1 月 2 日是几号？123,456 是多少？您的服务器（app-server 和 db-server）是否相互同意？

如果风险因素对他们没有说服力，那么绩效呢？如果您使用参数，RDBMS 可以重用查询计划，从而提高性能。它不能只用字符串来做到这一点。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-05-26T13:57:50.640

争论是没有胜利的。如果您确实设法找到了一个漏洞，您的同事只会更改 SafeDBString 函数来解决它，然后要求您再次证明它是不安全的。

鉴于参数化查询是无可争议的编程最佳实践，他们应该承担举证责任，说明为什么他们没有使用更安全、性能更好的方法。

如果问题是重写所有遗留代码，那么简单的折衷方案是在所有新代码中使用参数化查询，并重构旧代码以在处理该代码时使用它们。

我的猜测是真正的问题是骄傲和固执，对此你无能为力。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-26T12:45:30.567

首先，您的“替换”版本示例是错误的。您需要在文本周围加上撇号：

```
string sql = "SELECT * FROM Users WHERE Name='" + SafeDBString(name) & "'";
SqlCommand getUser = new SqlCommand(sql, connection); 
```

所以这是参数为你做的另一件事：你不需要担心一个值是否需要用引号括起来。当然，你可以将它构建到函数中，但是你需要给函数增加很多复杂性：如何知道 'NULL' 作为 null 和 'NULL' 作为字符串之间的区别，或者数字和一个恰好包含很多数字的字符串。这只是错误的另一个来源。

另一件事是性能：参数化查询计划通常比级联计划缓存得更好，因此可能在运行查询时为服务器节省了一步。

此外，**转义单引号还不够好。** 许多数据库产品允许使用替代方法来转义攻击者可以利用的字符。例如，在 MySQL 中，您还可以使用反斜杠转义单引号。所以下面的“name”值只会用这个`SafeDBString()`函数来破坏 MySQL，因为当你把单引号加倍时，第一个引号仍然被反斜杠转义，而第二个是“活动的”：

> x\' 或 1=1;--

* * *

此外，JulianR 在下面提出了一个很好的观点： ***永远不要***尝试自己做安全工作。即使经过彻底的测试，也很容易以*看似*有效的微妙方式使安全编程出错。然后时间过去了，一年后你发现你的系统在六个月前被破解了，直到那时你才知道。

始终尽可能多地依赖为您的平台提供的安全库。它们将由以编写安全代码为生的人编写，经过比您可以管理的测试更好的测试，并在发现漏洞时由供应商提供服务。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-26T15:00:43.790

所以我想说：

1）你为什么要重新实现一些内置的东西？它就在那里，随时可用，易于使用，并且已经在全球范围内进行了调试。如果在其中发现未来的错误，它们将很快得到修复并可供所有人使用，而无需您做任何事情。

2) 有哪些流程可以*保证*您*不会*错过对 SafeDBString 的调用？仅仅在一个地方错过它可能会引发一大堆问题。您将如何关注这些事情，并考虑当接受的正确答案如此容易获得时，这些努力浪费了多少。

3) 你有多确定你已经掩盖了微软（数据库和访问库的作者）在你的 SafeDBString 实现中知道的每一个攻击向量......

4) 读取 sql 的结构有多容易？示例使用+连接，参数很像string.Format，更具可读性。

此外，有 2 种方法可以计算出实际运行的内容 - 滚动您自己的 LogCommand 函数，一个*没有安全问题*的简单函数，或者甚至查看 sql 跟踪以了解数据库认为真正发生的事情。

我们的 LogCommand 函数很简单：

```
 string LogCommand(SqlCommand cmd)
    {
        StringBuilder sb = new StringBuilder();
        sb.AppendLine(cmd.CommandText);
        foreach (SqlParameter param in cmd.Parameters)
        {
            sb.Append(param.ToString());
            sb.Append(" = \"");
            sb.Append(param.Value.ToString());
            sb.AppendLine("\"");
        }
        return sb.ToString();
    } 
```

对与错，它为我们提供了我们需要的信息，而没有安全问题。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-26T12:47:49.643

使用参数化查询，您获得的不仅仅是针对 sql 注入的保护。您还可以获得更好的执行计划缓存潜力。如果您使用 sql server 查询分析器，您仍然可以看到“在数据库上运行的确切 sql”，因此您在调试 sql 语句方面也不会真正失去任何东西。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-26T12:44:21.367

我已经使用这两种方法来避免 SQL 注入攻击，并且肯定更喜欢参数化查询。当我使用连接查询时，我使用了一个库函数来转义变量（如 mysql_real_escape_string），并且我不相信我已经涵盖了专有实现中的所有内容（看起来你也是）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-26T12:58:58.870

如果不使用参数，您将无法轻松地对用户输入进行任何类型检查。

如果您使用 SQLCommand 和 SQLParameter 类进行 DB 调用，您仍然可以看到正在执行的 SQL 查询。查看 SQLCommand 的 CommandText 属性。

当参数化查询如此易于使用时，我总是怀疑使用自己滚动的方法来防止 SQL 注入。其次，仅仅因为“它总是以这种方式完成”并不意味着它是正确的方式。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-26T13:17:18.477

仅当您保证要传入字符串时，这才是安全的。

如果您在某个时候没有传入字符串怎么办？如果你只传递一个数字怎么办？

```
http://www.mywebsite.com/profile/?id=7;DROP DATABASE DB 
```

最终会变成：

```
SELECT * FROM DB WHERE Id = 7;DROP DATABASE DB 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-26T12:43:45.593

我会为所有事情使用存储过程或函数，所以不会出现问题。

在我必须将 SQL 放入代码的地方，我使用参数，这是唯一有意义的事情。提醒持不同政见者，有些黑客比他们更聪明，并且更有动力破解试图智取他们的代码。使用参数，根本不可能，也不难。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-26T13:26:53.497

非常同意安全问题。
使用参数的另一个原因是为了提高效率。

数据库将始终编译您的查询并将其缓存，然后重新使用缓存的查询（这对于后续请求显然更快）。如果您使用参数，那么即使您使用不同的参数，数据库也会重新使用您的缓存查询，因为它在绑定参数之前基于 SQL 字符串匹配。

但是，如果您不绑定参数，那么 SQL 字符串会在每个请求（具有不同参数）上发生变化，并且它永远不会匹配缓存中的内容。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-10-17T08:49:33.897

由于已经给出的原因，参数是一个非常好的主意。但是我们讨厌使用它们，因为创建参数并将其名称分配给变量以供以后在查询中使用是三重间接的头疼。

以下类包装了您通常用于构建 SQL 请求的 stringbuilder。它使您**无需创建参数即可编写参数化查询**，因此您可以专注于 SQL。您的代码将如下所示...

```
var bldr = new SqlBuilder( myCommand );
bldr.Append("SELECT * FROM CUSTOMERS WHERE ID = ").Value(myId, SqlDbType.Int);
//or
bldr.Append("SELECT * FROM CUSTOMERS WHERE NAME LIKE ").FuzzyValue(myName, SqlDbType.NVarChar);
myCommand.CommandText = bldr.ToString(); 
```

我希望你同意，代码的可读性得到了极大的提高，并且输出是一个适当的参数化查询。

班级看起来是这样的......

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
using System.Data.SqlClient;

namespace myNamespace
{
    /// <summary>
    /// Pour le confort et le bonheur, cette classe remplace StringBuilder pour la construction
    /// des requêtes SQL, avec l'avantage qu'elle gère la création des paramètres via la méthode
    /// Value().
    /// </summary>
    public class SqlBuilder
    {
        private StringBuilder _rq;
        private SqlCommand _cmd;
        private int _seq;
        public SqlBuilder(SqlCommand cmd)
        {
            _rq = new StringBuilder();
            _cmd = cmd;
            _seq = 0;
        }
        //Les autres surcharges de StringBuilder peuvent être implémenté ici de la même façon, au besoin.
        public SqlBuilder Append(String str)
        {
            _rq.Append(str);
            return this;
        }
        /// <summary>
        /// Ajoute une valeur runtime à la requête, via un paramètre.
        /// </summary>
        /// <param name="value">La valeur à renseigner dans la requête</param>
        /// <param name="type">Le DBType à utiliser pour la création du paramètre. Se référer au type de la colonne cible.</param>
        public SqlBuilder Value(Object value, SqlDbType type)
        {
            //get param name
            string paramName = "@SqlBuilderParam" + _seq++;
            //append condition to query
            _rq.Append(paramName);
            _cmd.Parameters.Add(paramName, type).Value = value;
            return this;
        }
        public SqlBuilder FuzzyValue(Object value, SqlDbType type)
        {
            //get param name
            string paramName = "@SqlBuilderParam" + _seq++;
            //append condition to query
            _rq.Append("'%' + " + paramName + " + '%'");
            _cmd.Parameters.Add(paramName, type).Value = value;
            return this; 
        }

        public override string ToString()
        {
            return _rq.ToString();
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-26T13:09:21.440

在我不得不调查 SQL 注入问题的很短的时间内，我可以看到，使值“安全”也意味着您正在关闭可能实际需要在数据中使用撇号的情况的大门 - 那某人的名字呢，例如奥莱利。

剩下的就是参数和存储过程。

是的，你应该总是尝试以你现在知道的最好的方式来实现代码——而不仅仅是它一直是如何完成的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-26T13:20:29.140

这里有几篇文章，您可能会发现它们有助于说服您的同事。

[http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

[http://unixwiz.net/techtips/sql-injection.html](http://unixwiz.net/techtips/sql-injection.html)

就我个人而言，我更喜欢永远不允许任何动态代码接触我的数据库，要求所有联系都通过 sps（而不是使用动态 SQl 的联系）。这意味着除了我授予用户的权限之外，其他任何事情都无法完成，并且内部用户（除了极少数出于管理目的而具有生产访问权限的用户）无法直接访问我的表并造成破坏、窃取数据或进行欺诈。如果您运行财务应用程序，这是最安全的方法。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-26T14:49:12.690

我没有看到任何其他答案解决了“为什么自己做不好”的这一方面，但考虑[SQL 截断攻击](http://download.microsoft.com/download/3/a/7/3a7fa450-1f33-41f7-9e6d-3aa95b5a6aea/MSDNMagazineNovember2006en-us.chm)。

`[QUOTENAME](http://doc.ddart.net/mssql/sql70/qua-quz.htm)`如果您无法说服他们使用参数，还有一个T-SQL 函数会很有帮助。它捕获了很多（全部？）逃逸的 qoute 问题。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-26T14:58:07.617

它可以被破坏，但是方法取决于确切的版本/补丁等。

已经提出的一个是可以利用的溢出/截断错误。

另一个未来的方法是寻找与其他数据库类似的错误——例如 MySQL/PHP 堆栈遇到了转义问题，因为某些 UTF8 序列可以用于操作替换函数——替换函数将被欺骗*引入*注入字符。

归根结底，替代安全机制依赖于*预期*但并非*预期*的功能。由于该功能不是代码的预期目的，因此某些发现的怪癖很可能会破坏您的预期功能。

如果你有很多遗留代码，replace 方法可以用作权宜之计，以避免冗长的重写和测试。如果您正在编写新代码，则没有任何借口。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-10-23T09:27:53.903

尽可能使用参数化查询。有时，即使是一个没有使用任何奇怪字符的简单输入，如果它没有被识别为数据库中某个字段的输入，它就已经可以创建一个 SQL 注入。

因此，只需让数据库自己完成识别输入的工作，更不用说当您需要实际插入可能会被转义或更改的奇怪字符时，它还可以省去很多麻烦。它甚至可以最终节省一些宝贵的运行时间，而不必计算输入。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-09-28T12:54:37.197

[2 年后](https://stackoverflow.com/a/26421296/1585345)，我重新开始......欢迎任何对参数感到痛苦的人尝试我的 VS 扩展，**[QueryFirst](https://visualstudiogallery.msdn.microsoft.com/eaf390af-afc1-4994-a442-ec95923dafcb)**。您在一个真实的 .sql 文件（验证、智能感知）中编辑您的请求。要添加参数，您只需将其直接输入到 SQL 中，以“@”开头。保存文件时，QueryFirst 将生成包装类，让您运行查询并访问结果。它将查找参数的 DB 类型并将其映射到 .net 类型，您可以将其作为生成的 Execute() 方法的输入。**再简单不过了**. 以正确的方式进行操作比以任何其他方式进行操作要更快、更容易，并且创建 sql 注入漏洞变得不可能，或者至少非常困难。还有其他杀手级优势，例如能够删除数据库中的列并立即查看应用程序中的编译错误。

法律免责声明：我写了 QueryFirst

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-26T13:41:43.980

以下是使用参数化查询的几个原因：

1.  安全性——数据库访问层知道如何删除或转义数据中不允许的项目。
2.  关注点分离 - 我的代码不负责将数据转换为数据库喜欢的格式。
3.  没有冗余 - 我不需要在每个执行此数据库格式化/转义的项目中包含程序集或类；它内置在类库中。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-26T14:38:50.497

与 SQL 语句的缓冲区溢出有关的漏洞很少（我不记得是哪个数据库了）。

我想说的是，SQL 注入不仅仅是“逃避​​引用”，你不知道接下来会发生什么。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-29T02:45:04.760

另一个重要的考虑因素是跟踪转义和未转义的数据。有大量的应用程序（Web 和其他应用程序）似乎无法正确跟踪数据何时为原始 Unicode、& 编码、格式化 HTML 等。很明显，要跟踪哪些字符串是`''`编码的，哪些不是。

当您最终更改某个变量的类型时，这也是一个问题——也许它曾经是一个整数，但现在它是一个字符串。现在你有问题了。

# java - 了解内核在 udp 套接字上分配的本地地址

> ID：910466
> 
> 赞同：0
> 
> 时间：2009-05-26T12:38:29.333
> 
> 标签：java, c, sockets, udp, wildcard

我正在使用 jstun 库（hxxp://jstun.javawi.de/）开发一个 java 应用程序，我需要将我的公共 IP 与内核选择的 IP 进行比较（通配符地址 - hxxp://java.sun .com/j2se/1.5.0/docs/api/java/net/DatagramSocket.html#DatagramSocket() ）当我创建一个udp套接字时。

我不明白的是，如果我的 natted 网络上的本地 ip 是 192.168.1.x 的形式，为什么我会得到 10.xxx 之类的 ip？

两者完全不相关有什么特别的原因吗？如果我*不在*nat 后面，内核会将套接字绑定到我的公共地址吗？

多谢！不对称

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:51:38.230

对于发送套接字，源 IP 将由主机路由表根据目标 IP 确定；对于接收套接字，目标 IP 就是你得到的。您的对等方看到的“公共”IP 是来自您的数据包上的源地址，它被 NAT 重写为任何内部地址被转换为的地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:17:35.780

我没有提到一件相当重要的事情：我正在为 android 开发，并在 android 模拟器上运行我的代码，这解释了 10.xxx 地址的事情..

我应该更深入地研究..感谢您的帮助！

对于那些感兴趣的人：hxxp://developer.android.com/guide/developing/tools/emulator.html#networkaddresses

# c# - 多操作系统用户身份验证技术的方法和建议

> ID：910468
> 
> 赞同：2
> 
> 时间：2009-05-26T12:39:09.347
> 
> 标签：c#, linux, windows, authentication

我正在寻找有关如何在多个不同操作系统中验证用户/密码组合和验证组关联的建议。基本上我有一个在 MS Visual Studio C# 和 Mono C# 中工作的 C# 应用程序，我需要向它添加一个身份验证机制以支持 Windows、Linux 和 MacOSX。

对于 Windows，我编写了一个快速 C# 互操作来使用仅限 Windows 的 LogonUser API。这运行良好，但不适用于 Windows 以外的系统。我的最终目标是在所有平台（Windows、Linux 和 MacOSX）上运行相同的代码集，并且尽可能少地依赖操作系统的#ifdefing。

请注意——我正在拼命尝试使用固有的操作系​​统用户帐户。我不想维护自己的用户帐户存储。

欢迎任何关于方法、用户身份验证技术等的想法或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:55:38.830

我不确定身份验证如何在 linux 和 mac 上工作，但我想到的第一件事是实现 IAuthenticator 接口并具有特定于操作系统的身份验证器类。然后，您可以通过 Dependecy Injection 手动切换到适当的类，也可以在运行时动态切换……但不知何故，您的应用程序应该能够识别它当前正在运行的操作系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T16:53:43.233

每个系统处理本地身份验证的方式不同。正如@Darnell 提到的，您可能需要为您的身份验证编写一个接口，并隐藏系统特定的后端。

如果您需要跨多个系统拥有相同的用户帐户，则使用 ldap 获取用户信息，使用 kerberos 进行身份验证是唯一完全支持的跨平台处理方式。

没有“kerberizing”你的应用程序，并坚持它只在等效的环境中运行，没有通用的身份验证方法。此外，LDAP 确实是查询组信息的唯一可移植方式。

一个更简单（更便携）的选项可能是使用某种预共享密钥。这样，用户将只授权您的程序，通过给它一个密钥来签署消息。根据用户的相应密钥检查消息会让您知道 a) 用户在本地存在，并且 b) 消息来自用户授权的来源。您仍然有没有通用组查找的问题，但是如果您不能依赖 ldap，您可能需要自己执行此操作。

注意：我还是要强调以下几点

我强烈建议*不要*在您的消息传递中使用某人的密码，即使这需要您维护自己的用户/密码数据库。您将绕过本地安全范式，并使系统面临更多安全风险。如果系统使用 kerberos/ActiveDirectory，这一点就更重要了，因为在这些系统中已经花费了很长时间来确保用户的密码*永远不会*通过网络传输。以 DBMS 为例——它们中的大多数不绑定到本地用户数据库（至少默认情况下），并实现自己的用户身份验证机制。看看 MySQL 或 PostgreSQL 中的安全性如何工作。

# java - 如何根据 Java 中的 Schematron 模式验证文档？

> ID：910476
> 
> 赞同：7
> 
> 时间：2009-05-26T12:40:30.593
> 
> 标签：java, validation, schema, jaxp, schematron

据我所知，[JAXP 默认支持来自 Java 6 的 W3C XML Schema 和 RelaxNG](http://java.sun.com/javase/6/docs/api/javax/xml/validation/SchemaFactory.html)。

[我可以在schematron.com 链接页面](http://www.schematron.com/links.html)上看到一些 API，大部分是实验性的或不完整的。

是否有一种在 Java 中验证 schematron 的方法是完整的、高效的并且可以与 JAXP API 一起使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-07T08:04:28.823

[Jing](http://code.google.com/p/jing-trang/)支持 pre-ISO Schematron 验证（请注意，Jing 的实现也是基于 XSLT）。

还有一些 XSLT 实现可以很容易地从 Java 中调用。您需要确定您对哪个版本的 Schematron 感兴趣，然后获取相应的样式表 - 所有这些样式表都应该可以从 schematron.com 获得。该过程非常简单简单，基本上涉及2个步骤：

*   在您的 Schematron 模式上应用骨架 XSLT 以获得一个新的 XSLT 样式表，该样式表在 XSLT 中表示您的 Schematron 模式
*   将获得的 XSLT 应用于您的一个或多个实例文档以验证它们

JAXP 只是一个 API，它不需要实现对 Relax NG 的支持。您需要检查您使用的具体实现是否支持 Relax NG。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-26T09:52:27.147

纯 Java Schematron 实现位于[https://github.com/phax/ph-schematron/](https://github.com/phax/ph-schematron/) 它支持 XSLT 方法和纯 Java 方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-09T19:29:52.287

您可以查看[SchematronAssert](https://github.com/j-maly/SchematronAssert)（披露：我的代码）。它主要用于单元测试，但您也可以将它用于普通代码。它是使用 XSLT 实现的。

单元测试示例：

```
ValidationOutput result = in(booksDocument)
    .forEvery("book")
    .check("author")
    .validate();
assertThat(result).hasNoErrors(); 
```

独立验证示例：

```
StreamSource schemaSource = new StreamSource(... your schematron schema ...);
StreamSource xmlSource = new StreamSource(... your xml document ... );
StreamResult output = ... here your SVRL will be saved ... 
// validation 
validator.validate(xmlSource, schemaSource, output); 
```

使用 SVRL 的对象表示：

```
ValidationOutput output = validator.validate(xmlSource, schemaSource);
// look at the output
output.getFailures() ... 
output.getReports() ... 
```

# c# - 禁用选择框而不从帖子中删除值

> ID：910479
> 
> 赞同：1
> 
> 时间：2009-05-26T12:41:26.333
> 
> 标签：c#, .net, html, asp.net-mvc, postback

在我当前的 asp.net-mvc 项目中，我的一个页面允许用户在发出更新多个值的发布请求后在下拉框中选择一个值。为了确保回发的延迟不会让用户混淆选择另一个值（从而创建另一个帖子、创建另一个延迟等），我将选择的禁用属性设置为 true。
但是，禁用的输入不会提交给 post call。

我怎样才能让用户在视觉上清楚地知道工作正在进行中，并且在不从帖子中删除输入的情况下不可能选择新值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:48:02.950

是的，这也让我很烦。

基本上，您需要做的是隐藏旧按钮并将其替换为禁用的按钮，以便用户看起来相同。这样它仍然被提交，但不能被双重提交。

实际上，我在[Problem with disable submit button on form submit](https://stackoverflow.com/questions/661752/problem-with-disabling-submit-buttons-on-form-submit)中发现了似乎与此重复的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:23:18.163

根据您的回答，我猜您已经在使用 jQuery。在那种情况下，为什么不获取选择框的值，禁用它，然后自己发布值？

奖励：[BlockUI](http://malsup.com/jquery/block/)是一个不错的 jQuery 插件，可以很好地阻止 UI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:58:16.800

我在 Cletus 的帖子中找到的答案都不是我想要的。
这是我想出的。它不是 100% 可重复使用的，但它可以满足我的需要并且可以随意改进/编辑。

```
$('#productMixSelectorForm').change(function() { $(this).ChangeSelection() });

jQuery.fn.ChangeSelection = function() {
    var html = $('<div class="hidden">');
    $(this).find('select, input').each(function() {
        if ($(this).hasClass('hidden') == false) {
            //Clone the original one into the hidden div
            html.append($(this).clone());
            //Disable the original (visible) one and make it's name unique again
            $(this).attr("disabled", true);
            var name = $(this).attr("name");
            $(this).attr("name", name + "disabledDummy");
        }
    });    
    //Add the collection of clones to the form so they get submitted
    $(this).append(html);
    $(this).submit();
} 
```

# xml - 包含大量货币的货币 xml 提要

> ID：910480
> 
> 赞同：7
> 
> 时间：2009-05-26T12:41:51.293
> 
> 标签：xml, currency

我正在寻找带有货币数据的 XML 提要。它应该是免费的并且每天更新。我为此搜索了一整天都没有成功。如果有人知道，请分享信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-08-19T18:44:07.163

欧洲中央银行 (ECB) 拥有我所知道的最可靠的免费提要。它包含大约 28 种货币，并且至少每天更新一次。

[http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml](http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml)

有关更多格式和工具，请参阅欧洲央行参考页面： http: [//www.ecb.int/stats/exchange/eurofxref/html/index.en.html](http://www.ecb.int/stats/exchange/eurofxref/html/index.en.html)

此外，我发现另一个包含更多货币的提要：http: [//themoneyconverter.com/USD/rss.xml](http://themoneyconverter.com/USD/rss.xml)
更多信息请访问：[http ://themoneyconverter.com/RSSFeeds.aspx](http://themoneyconverter.com/RSSFeeds.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T00:19:13.877

取决于您的特定需求：

*   如果您只是每天更新的前 28 种货币，请选择 ECB（非常可靠）。
*   如果您想每天更新多达 90 种货币，请使用货币转换器（一些停机时间）
*   如果您想不断更新前 16 种货币，请转到 FXCM（也可以）。

希望这可以帮助。

# asp.net - 如何使用 javascript 生成虚假回发？

> ID：910485
> 
> 赞同：5
> 
> 时间：2009-05-26T12:43:01.337
> 
> 标签：asp.net, postback

我的页面上有 Dropdownlist 及其在代码隐藏文件 (.cs) 中创建的 selectedindexchanged 方法。

我想用 A 标签（onmouseover 事件）创建假回发。

首先我查看了html的源代码。

```
<select name="ctl00$cpholder_ana$ddlFaturaNolar" onchange="javascript:setTimeout('__doPostBack(\'ctl00$cpholder_ana$ddlFaturaNolar\',\'\')', 0)" id="ctl00_cpholder_ana_ddlFaturaNolar">
    <option selected="selected" value="CHOOSE"></option>
    <option value="001926">[ 30.04.2009 - 156.492,00 TL ]  001926</option>
</select> 
```

*   然后，我复制了

    ```
    onchange="javascript:setTimeout('__doPostBack(\'ctl00$cpholder_ana$ddlFaturaNolar\',\'\')', 0)" 
    ```

而且，我创建了一个带有鼠标悬停事件的标签（用于回发，但它被 Dropdownlist 触发）

```
<a onmouseover="javascript:setTimeout('__doPostBack(\'ctl00$cpholder_ana$ddlFaturaNolar\',\'\')', 0)">asdasdasdasdad</a> 
```

但它并没有下降到 SelectedIndexChanged 方法。

*   首先，为什么？
*   第二，我该怎么做？

从现在开始感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T12:46:00.177

您可以使用此代码段 -

```
__doPostBack('<%= dropdownlist.UniqueID %>', ''); 
```

您不能使用硬编码的唯一 ID，因为它们可能会因多种原因而改变。例如，如果父控件的 id 更改等，id 将更改。您必须使用上面给出的代码从服务器端获取 UniqueID。

编辑：忘了提到一件重要的事情。仅当下拉列表的 selectedIndex 更改时页面才会回发:) 因此，如果您想触发该事件，请使用此更改下拉列表的索引，然后调用`__doPostBack`代码 -

```
document.getElementById("<%= dropdownlist.UniqueID %>").selectedIndex = 1;
__doPostBack('<%= dropdownlist.UniqueID %>', ''); 
```

EDIT2：加上鲍勃所说的，您可以使用隐藏的服务器控件。我建议您使用 asp:Hidden 控件并连接其 OnValueChanged 事件。因此，每当您想将页面发布回服务器时，您只需更改隐藏变量的值。这样您就不必使用隐藏按钮。

```
document.getElementById("<%= hiddenField.UniqueID %>").value = (new Date()).getTime(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-22T13:51:02.193

我很抱歉地说伙计们

__doPostBack 不适用于 DropDownList，但适用于 Button。所以做一件事

添加一个应该像这样跟随的按钮

```
<asp:DropDownList ID="ddlCategory" runat="server" AutoPostBack="true" 
OnSelectedIndexChanged="ddlCategory_SelectedIndexChanged">
  <asp:ListItem Text="All" Value="0" Selected="True"></asp:ListItem>
  <asp:ListItem Text="Published" Value="1"></asp:ListItem>
  <asp:ListItem Text="Pending" Value="2"></asp:ListItem>
  <asp:ListItem Text="Rejected" Value="3"></asp:ListItem></asp:DropDownList> 
```

现在调用你的 __doPostBack 方法

```
__doPostBack('<%= btnRefresh.UniqueID %>',''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T12:51:04.580

您可以尝试的另一个选项是在您的页面上创建一个隐藏的（style="display:none" 不使用可见属性）asp:Button，我发现它更容易并且可能会中断。当您想回帖时，您可以模拟单击该按钮

```
 document.getElementById("<%= Button1.ClientID %>").click(); 
```

如果您想坚持在下拉列表中回发，请确保下拉列表的 AutoPostBack 属性仍设置为 true。请记住，这种行为有点奇怪，您在鼠标悬停时触发了选定的更改事件。这不仅有点令人困惑，而且还增加了意外回发的风险，因为很容易将鼠标悬停在某些东西上而期望什么都不会发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T12:54:52.607

不是`<%= ddlFaturaNolar.ClientID %>`吗？

# asp.net-mvc - 如何在 ASP.NET MVC 中调试死机白屏

> ID：910487
> 
> 赞同：1
> 
> 时间：2009-05-26T12:43:12.617
> 
> 标签：asp.net-mvc, visual-studio, visual-studio-2008

我最近将我的 ASP.NET MVC 应用程序从 beta 版升级到了版本 1。确实，在我修复了所有引用之后，当我按下 F5 时，我得到了一个白屏死机。

是否知道如何在 VS 2008 中调试白屏死机？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:25:53.977

[我通过打开视图编译](https://devermind.wordpress.com/2009/05/03/aspnet-mvc-tip-turn-on-compile-time-view-checking/)发现了其中一些神秘的问题。这将捕获默认构建过程未捕获的一些难以调试的问题。

您还可以连接[Elmah](https://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)[错误日志记录](https://code.google.com/archive/p/elmah/)组件。它会记录您的异常，以便您在四处寻找答案时拥有堆栈和异常的副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T22:06:47.300

创建一个新的 ASP.NET MVC v1 应用程序并比较两者的设置方式。

我会特别注意 web.config 和 global.asax。

HTH，查尔斯

# .net - WPF Storyboard 初学者问题

> ID：910488
> 
> 赞同：1
> 
> 时间：2009-05-26T12:43:25.377
> 
> 标签：.net, wpf, animation, storyboard

我正在编写我的第一个 WPF 应用程序，并尝试在窗体关闭时实现淡入淡出动画。我遇到了这个问题[Fading out a wpf window on close](https://stackoverflow.com/questions/867656/fading-out-a-wpf-window-on-close)，它显示了如何制作淡出动画，但我似乎无法让它工作。我的 XAML 中有这个：

```
<Window.Resources>
    <Storyboard Name="FadeOutStoryboard" x:Key="FadeOutStoryboard" Completed="FadeOutStoryboard_Completed">
        <DoubleAnimation Storyboard.TargetProperty="Window.Opacity" From="1" To="0" Duration="0:0:2" FillBehavior="HoldEnd" />
    </Storyboard>
</Window.Resources> 
```

然后我有这个事件处理程序：

```
 private bool doneFade;
    private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
    {
        if (!doneFade)
        {
            e.Cancel = true;
            Storyboard sb = (Storyboard)this.FindResource("FadeOutStoryboard");
            sb.Begin();
        }
    } 
```

但是当`sb.Begin()`调用该方法时，我得到了这个异常：

```
System.InvalidOperationException: No target was specified for 'System.Windows.Media.Animation.DoubleAnimation'. 
```

如前所述，这是我在 WPF 的第一次尝试，所以我对在表单关闭时添加淡出需要做些什么感到很困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T13:07:33.283

您需要将目标 UI 元素添加到 StoryBoard 动画，否则将无法应用动画。

```
<Storyboard Name="FadeOutStoryboard" x:Key="FadeOutStoryboard" Completed="FadeOutStoryboard_Completed">        
     <DoubleAnimation Storyboard.TargetName="myWindow" Storyboard.TargetProperty="Window.Opacity" From="1" To="0" Duration="0:0:2" FillBehavior="HoldEnd" />    
</Storyboard> 
```

# .net - 如果你必须创建类似 ReSharper 的东西，你会从哪里开始？

> ID：910499
> 
> 赞同：2
> 
> 时间：2009-05-26T12:45:40.787
> 
> 标签：.net, visual-studio, plugins, resharper

如果您必须为 Visual Studio 创建像[ReSharper](http://www.jetbrains.com/resharper/)这样的插件，您会从哪里开始？
（不是在谈论每一个功能，但我只是想得到它的骨架）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T13:03:03.123

截至 2007 年初，JetBrains 人员估计 ReSharper 大约需要[30 人年](http://translate.google.com/translate?prev=hp&hl=en&js=n&u=http%3A%2F%2Frsdn.ru%2Fforum%2Fjetbrains%2F2196726.1.aspx&sl=ru&tl=en&history_state0=)（这是俄罗斯论坛上帖子的谷歌翻译版本）。他们还说，仅仅精通构建编译器是不够的：他们认为最复杂的部分是缓存、AST 事务、AST 上下文等。Visual Studio 集成在技术上并不是最复杂的事情：这只是阅读的问题大量的文档。

所以基本上就是这样：Visual Studio 集成和 AST 管理将是实现 ReSharper 骨架的最复杂部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T12:57:18.330

我当然不会尝试使用 Reflector 对 Resharper 进行逆向工程。不，先生，不是我。绝不。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T12:55:06.383

我会首先研究一种开源替代方案，例如[TytanNET](http://tytannet.codeplex.com/)。显然，如果您对 Resharper 的特定功能感兴趣，那么可能会有更直接的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T13:30:05.313

我有幸为 ReSharper 编写了一些插件，以对代码布局和样式进行额外更改（根据我工作的公司的编码指南）。这不是很容易，但是 API 相当丰富，尽管文档很差，所以使用 Reflector 将是强制性的。

我建议查看现有插件的源代码，例如[Agent Johnson](http://code.google.com/p/agentjohnsonplugin/)和[StyleCop for ReSharper](http://www.codeplex.com/StyleCopForReSharper)。您还可以尝试在 JetBrains 的[ReSharper Open API](http://www.jetbrains.net/devnet/community/resharper/resharper_open_api)论坛上获得帮助。

**编辑：**显然我无法阅读。我以为你是指ReSharper的插件**。**在这种情况下，我将从 Visual Studio SDK 开始，学习如何与代码交互、构建 AST 等。SDK 中提供了许多示例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T14:48:06.483

文件 -> 新建 -> 项目

其他项目类型 -> 可扩展性 -> Visual Studio 插件

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T13:21:24.130

我可能会首先确保我了解我的工具将支持哪些特定的重构。从技术角度来看，“像 resharper 之类的东西”有点笼统地知道“从哪里开始”。

因此，正如我所说，我会首先尝试确保我了解业务需求。从那里开始，将项目分解为更小、更易于管理的子问题变得更加容易。

# .net - .NET 或 WinAPI

> ID：910511
> 
> 赞同：-1
> 
> 时间：2009-05-26T12:50:38.810
> 
> 标签：.net, windows, winapi, desktop

我正在尝试构建一个桌面应用程序。最大的要求是它应该尽可能地小。对于 Windows 用户，使用 .NET 还是 WinAPI 构建更好？我不是软件背景，如果这是一个无意义的问题，请原谅我，但我听说使用 .NET，有可能某些 Windows 用户的计算机上可能没有它，在这种情况下，他们将被要求下载大量软件，而使用 winAPI 绝不会如此。那正确吗？有多少百分比的 Windows 在他们的计算机上可能没有 .NET 2.0？另外，我听说在 WinAPI 中开发这个小应用程序需要更多的努力。这样做是否值得，还是 .NET 能让您接触到几乎同样多的用户？谢谢

PS。我是这个论坛的新手（正如我上面提到的，来自非软件背景），但我不得不说这个论坛是我找到的最好的论坛，可以对我正在尝试构建的应用程序做出一些基本决策。但问题是，我学的越多，就越没有。我遇到的问题..感谢大家的帮助:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T12:57:46.813

> 最大的要求是它应该尽可能地小。

*如果*该要求是合法的，它几乎会迫使您进入 win32 API 级别。但我真的质疑这个要求。如今，下载几 MB 已不再是以前的样子，如果您的大部分用户群仍在拨号上网，那么有一些方法可以缓解这些问题。将此与为 Win32 和 .Net 开发增加的难度（以及因此的时间）进行比较可能很有意义。

> 有多少百分比的 Windows 在他们的计算机上可能没有 .NET 2.0？

很难获得真正的渗透率，我看到的统计数据高达 > 90% 和低至 20%。所以这一切都归结为你想相信什么。如果真的有那么大的交易，您可以为单声道开发并使用它来静态链接运行时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T12:53:53.530

看看[这个](https://stackoverflow.com/questions/880491/windows-gui-programming-c-sdk-or-c-windows-forms)问题。

但是，如果您需要的是一个非常小的可执行文件，而无需安装完整的 .NET 框架，请选择 Win32。您没有在 Windows XP 上预装 .NET 框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T12:54:18.100

由于 Windows Update 和用户可能安装的其他程序，大多数计算机现在都以某种形式拥有 .NET。如果您是编码新手，我肯定会使用 WinForms/.NET 而不是直接为 Windows API 编码。它更简单，即使更大。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T13:10:28.067

> 另外，我听说在 WinAPI 中开发这个小应用程序需要更多的努力。

好吧，想象一下你要造一辆汽车。

1.  您进入汽车零件目录，为发动机订购正确数量的阀门、活塞、齿轮、风扇、散热器等。您订购了构建变速器所需的所有润滑剂、齿轮、轴承、螺母和螺栓。您订购前照灯、灯泡灯泡、刹车灯、转向灯、倒车灯。

您订购了足够的钢材将底盘焊接在一起，您订购了一些座椅，一些布来装饰它们，一个变速杆，踏板，灯开关，门，窗户玻璃，最后是后视镜。

这一切都到了，你必须把它们放在一起。底盘的强度取决于最坚固的焊缝，而将它们组合在一起是一项艰巨的任务，而且出错的余地很大。直到你把它们放在一起，你才意识到你没有订购任何轮毂或轮胎。

这是Win32，windows api。

2.  你去一个汽车零件目录，你订购一个装有座椅、灯、轮子等的底盘。您订购了发动机和变速箱。三样东西到了。您仍然必须安装发动机并连接变速箱（不是微不足道的任务），但这是一个简单得多的命题。

这是.net 框架。

如果项目比儿童遥控车大，请点击分发并使用 .net

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T12:56:01.997

如果它需要很小，肯定会使用“本机代码”。但是，这要困难得多，尤其是如果您不是软件背景的话。

将这项工作外包可能会更好？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T13:27:24.243

编写调用 WinAPI 的本机（非托管）代码将为您提供更小的占用空间，而不依赖于 .NET 框架。

但如果您想要更小的 .net 框架部署，请查看[.net 客户端配置文件](http://msdn.microsoft.com/en-us/library/cc656912.aspx)。您通常使用的所有 .net 程序集都占用 28mb 的空间。（使用 200kb 引导程序，仅安装客户端计算机上尚未安装的内容）

另见[这篇博文](http://blogs.windowsclient.net/trickster92/archive/2008/05/21/introducing-the-net-framework-client-profile.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T13:29:01.633

“尽可能小”是最重要的要求吗？走这条路时，您将拥有更少的依赖项（因此更小的可部署项目），但您的开发成本和时间将会增加。

我要冒昧地说大多数 Windows PC 已经安装了 .NET 框架（通过 Windows 更新或预安装）。如果您是针对 XP 或 Vista 进行开发，那么肯定会出现这种情况。

但更重要的是，最终包装的大小与实现价值的时间一样重要吗？您将更容易找到在 .NET 中快速编写好代码的开发人员。WinAPI 开发可能是乏味的、缓慢的，并且在调试中花费大量时间。这并不是说 WinAPI 开发人员不擅长他们所做的事情，但 .NET 是软件开发的一个进步，它让您可以更多地关注业务问题，而不是技术领域。

如果您是 PM 或项目负责人，您可能需要考虑进行成本分析，以确定在您的决策中真正重要的是什么。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-02-20T10:37:58.453

使用银光。.Net 的易用性，不依赖于本地软件配置。将来甚至会在 Linux 上运行良好。在某种程度上在手机上:)

# asp.net-ajax - Silverlight：访问客户端桌面 - 显示属性

> ID：910518
> 
> 赞同：1
> 
> 时间：2009-05-26T12:52:50.897
> 
> 标签：asp.net-ajax, asp.net-3.5, silverlight-2.0

我想在 silverlight 应用程序中访问客户端桌面的显示属性，并根据客户端机器上设置的 2 修改应用程序布局。当我们右键单击桌面并选择属性时，我们会得到显示属性对话框。我想从中访问外观和主题属性。我 hv 检索字体、主题等外观属性并将它们应用到我的 silverlight 应用程序中。我也不确定这是否可以在普通的 Web 应用程序中完成。

试图用谷歌搜索它，但除了调整大小的代码外，什么都可以找到。但我不仅想访问屏幕宽度和高度，还想访问外观设置。

任何帮助，将不胜感激。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T12:56:33.183

没门。这是不应向任何其他域公开的私有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:02:45.977

不确定这是否适用于 Silverlight，但请查看[此问题](https://stackoverflow.com/questions/541468/how-do-i-match-my-controls-styles-to-the-current-theme-wpf/543866#543866)，了解基于当前 Windows 主题的不同样式。

至于宽度/高度，除非您全屏运行 Silverlight 应用程序，否则更重要的是浏览器窗口的宽度/高度，因为它并不总是与屏幕本身的大小相同。您应该能够在谷歌上搜索如何轻松获取浏览器窗口宽度/高度的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T16:19:50.037

Silverlight 沙盒会阻止对客户端计算机的访问。您可以尝试使用 ActiveX 控件将数据公开给 silverlight 控件，或者您可以使用具有提升的信任权限的 WPF 浏览器应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-10T15:28:14.933

您可以使用`javascript`获取高度和宽度，并将这些值作为启动参数发送到`silverlight`应用程序。

# nhibernate - 在映射文件中定义枚举类型，或从另一个表中定义列

> ID：910521
> 
> 赞同：0
> 
> 时间：2009-05-26T12:53:06.170
> 
> 标签：nhibernate, nhibernate-mapping

如果我的映射文件，我将如何引用 C# 枚举类型？
另一个表中的列呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T13:17:24.403

您可以在映射文件中直接使用 Int32 类型。或者，如果您想使用枚举的字符串表示形式，那么您可以使用[EnumStringType](http://codebetter.com/blogs/jeremy.miller/archive/2006/02/20/138732.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-04T10:08:08.250

您可以直接在 NHibernate 映射文件中使用您的实际枚举类型，而不是 Int32。例如，如果您要映射具有类型为 Example.NameSpace.MyEnum 的 MyEnum 属性的对象：

```
<property name="MyEnum" type="Example.NameSpace.MyEnum">
</property> 
```

# bash - 如何在 BASH 中执行从文件中获取随机文本的脚本？

> ID：910523
> 
> 赞同：0
> 
> 时间：2009-05-26T12:53:38.290
> 
> 标签：bash, scripting, awk, sh

## 我有这样的文件：

啊啊啊

bbb

ccc

ddd

eee

* * *

我想在 BASH 中做一个脚本，它可以随机取这个文本文件的行，并将它作为变量或其他东西返回给我。

我听说可以用一些 AWK 来完成。有任何想法吗？

**更新：**我现在使用这个：

shuf -n 1 文本.txt

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T13:02:15.667

我使用这样的脚本从我的 singature-quotes 文件中生成随机行：

```
#!/bin/bash

QUOTES_FILE=$HOME/.quotes/quotes.txt
numLines=`wc -l $QUOTES_FILE | cut -d" " -f 1`

random=`date +%N`

selectedLineNumber=$(($random - $($random/$numLines) * $numLines + 1))
selectedLine=`head -n $selectedLineNumber $QUOTES_FILE | tail -n 1`

echo -e "$selectedLine" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:15:48.727

我会将 sed 与 p 参数一起使用...

```
sed -n '43p' 
```

其中 43 可能是一个变量...

我对 awk 不太了解，但我想你可以做几乎同样的事情（但是我不知道 awk 是否已经完成......）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-15T02:25:10.977

这是一种 bash 方式，没有任何外部工具

```
IFS=$'\n'
set -- $(<"myfile")
len=${#@}
rand=$((RANDOM%len+1))
linenum=0
while read -r myline
do
  (( linenum++ ))
  case "$linenum" in
   $rand) echo "$myline";;
  esac
done <"myfile" 
```

# c++ - 如何从 C++ 更改 ACL？

> ID：910528
> 
> 赞同：4
> 
> 时间：2009-05-26T12:55:03.013
> 
> 标签：c++, windows, file-permissions

如何从 C++ 更改 ACL？

任何人都可以在没有任何确认的情况下帮助我从 c++ 执行以下操作：

```
cacls c:\personal\file.txt /d everyone 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T05:13:23.757

使用以下代码

```
#include <Accctrl.h>
#include <Aclapi.h>
void SetFilePermission(LPCTSTR FileName)
{
    PSID pEveryoneSID = NULL;
    PACL pACL = NULL;
    EXPLICIT_ACCESS ea[1];
    SID_IDENTIFIER_AUTHORITY SIDAuthWorld = SECURITY_WORLD_SID_AUTHORITY;

    // Create a well-known SID for the Everyone group.
    AllocateAndInitializeSid(&SIDAuthWorld, 1,
                     SECURITY_WORLD_RID,
                     0, 0, 0, 0, 0, 0, 0,
                     &pEveryoneSID);

    // Initialize an EXPLICIT_ACCESS structure for an ACE.
    ZeroMemory(&ea, 1 * sizeof(EXPLICIT_ACCESS));
    ea[0].grfAccessPermissions = 0xFFFFFFFF;
    ea[0].grfAccessMode = DENY_ACCESS;
    ea[0].grfInheritance= NO_INHERITANCE;
    ea[0].Trustee.TrusteeForm = TRUSTEE_IS_SID;
    ea[0].Trustee.TrusteeType = TRUSTEE_IS_WELL_KNOWN_GROUP;
    ea[0].Trustee.ptstrName  = (LPTSTR) pEveryoneSID;

    // Create a new ACL that contains the new ACEs.
    SetEntriesInAcl(1, ea, NULL, &pACL);

    // Initialize a security descriptor.  
    PSECURITY_DESCRIPTOR pSD = (PSECURITY_DESCRIPTOR) LocalAlloc(LPTR, 
                                SECURITY_DESCRIPTOR_MIN_LENGTH); 

    InitializeSecurityDescriptor(pSD,SECURITY_DESCRIPTOR_REVISION);

    // Add the ACL to the security descriptor. 
    SetSecurityDescriptorDacl(pSD, 
            TRUE,     // bDaclPresent flag   
            pACL, 
            FALSE);   // not a default DACL 

    //Change the security attributes
    SetFileSecurity(FileName, DACL_SECURITY_INFORMATION, pSD);

    if (pEveryoneSID) 
        FreeSid(pEveryoneSID);
    if (pACL) 
        LocalFree(pACL);
    if (pSD) 
        LocalFree(pSD);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:13:36.173

我假设您的意思是在 Windows 系统上？您需要使用 cacls 使用的 Win32 API 的 NTFS 部分。浏览 MSDN，它会在某处。例如[SetSecurityInfo](http://msdn.microsoft.com/en-us/library/aa379588(VS.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:14:27.687

如果您不想乱用 API（即 SetNamedSecurityInfo），您可以像这样绕过提示：

```
echo y|cacls filename /d everyone 
```

由于 echo 是内置的，要从程序中调用该命令行，您可能必须运行：

```
cmd.exe /c echo y|cacls filename /d everyone 
```

# performance - 我可以在 ASP 中延迟执行吗？或者：请提供任何帮助以提高旧 ASP 站点的性能

> ID：910530
> 
> 赞同：4
> 
> 时间：2009-05-26T12:55:18.537
> 
> 标签：performance, asp-classic

我正在尝试提高用经典 ASP 编写的网站的性能。

它支持多种语言，问题在于它是如何实现的。它有以下方法：

```
GetTranslation(id,language) 
```

整个商店都是这样称呼的：

```
<%= GetTranslation([someid],[thelanguage]) %> 
```

该方法只是在 SQL 中查找 ID 和语言并返回翻译。简单的。

但令人难以置信的低效。在每次页面加载时，大约有 300 次独立的 SQL 调用来获得单独的翻译。

我已经在许多情况下显着提高了性能：

*   扫描 .asp 文件并获取对 GetTranslation 的引用的 AC# 工具
*   然后，该工具会构建一个“批量缓存”方法，该方法（取决于页面）获取它找到的所有 ID，并一举将结果缓存在字典中。
*   然后更新 GetTranslation 方法以检查字典是否有任何请求，如果它还没有，则只转到 SQL（如果需要，缓存它自己的结果）

仅此而已。

当翻译的 ID 存储在数据库中时，我无法获取它们（特别容易）。

**理想情况下**，GetTranslation 方法将在每次调用时构建一个大 SQL 字符串，该字符串仅在页面请求结束时执行。

这在 ASP 中可能吗？我可以将 <%= ... %> 的结果作为对稍后解决的内容的*引用*吗？

我也真诚地感谢任何其他可以改善这个古老而丑陋的野兽的表现的创造性方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T16:03:50.277

我认为您不能在 Classic ASP 中延迟执行。至于提高性能的建议。你可以有这样的课程：

```
Class TranslationManager
        Private Sub Class_Initialize
        End Sub

        Private Sub Class_Terminate
        End Sub

        Private Function ExistsInCache(id, language)
            ExistsInCache = _
                Not IsEmpty(Application("Translation-" & id & "-" & language))
        End Function

        Private Function GetFromCache(id, language)
            GetFromCache = Application("Translation-" & id & "-" & language)
        End Function

        Private Function GetFromDB(id, language)
            //'GET THE RESULT FROM DB
            Application("Translation-" & id & "-" & language) = resultFromDB
            GetFromDB = resultFromDB
        End Function

        Public Default Function GetTranslation(id, language)
            If ExistsInCache(id, language) Then
                GetTranslation = GetFromCache(id, language)
            Else
                GetTranslation = GetFromDB(id, language)
            End If
        End Function
End Class 
```

并在您的代码中像这样使用它

```
Set tm = New TranslationManager
translatedValue = tm([someid], [thelanguage])
Set tm = Nothing 
```

这肯定会减少对 DB 的调用。但是您需要**非常小心**将多少数据放入应用程序对象中。你不想耗尽内存。最好您还跟踪翻译在内存中停留的时间，并在一段时间未访问时使它们过期（从 Application 对象中删除）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:01:09.617

`<%= x %>`简单地转换为 Response.Write(x)。没有办法推迟。

事实上，据我所知，Classic ASP 无法延迟*任何内容。*

您已经在编写缓存工具方面做了很多工作。下一步是编写一个将这些 ASP 页面转换为 ASP.NET 的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:18:54.403

您的缓存是您可以在此处进行的最佳保存，您可以消除 .net 预缓存器的复杂性，只需每次调用​​ GetTranslate 检查您的字典中的条目，如果不存在则它可以获取并缓存它在应用程序空间。那会很快减轻。然后就是不时刷新缓存的问题，但是当工作进程被刷新时，这将每 24 小时为你完成一次。

如果您需要它比这更最新，那么您可以像使用 .net 缓存器一样提取所有引用。然后，您可以创建一个新函数来获取给定 id 集的所有条目，在每个页面的 ASP 页面顶部附近编写对该函数的调用，该函数将使用一个 SQL 字符串调用您的数据库，将结果存储在一个本地词典。然后修改 GetTranslation 以使用此字典中的值。需要更新，但这可能是您构建过程的一部分，或者只是每小时/每晚运行的作业。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:16:29.827

我们在我们的电子商务系统中使用具有命名空间和语言属性的 i18n 类。该类有一个名为“翻译”的默认函数，它基本上执行字典查找。该词典是使用 memento 模式从包含命名空间和语言的所有翻译的文本文件中加载的。

这些翻译文件的骨架是由一个自定义工具（实际上是用 vbscript 编写的）生成的，该工具解析 ASP 的 i18n($somestring) 调用。文件名基于命名空间和语言，例如“shoppingcart_step_1_FR.txt”。当我们将新的可翻译字符串添加到 ASP 代码中时，该工具实际上可以更新/扩展现有的翻译文件，这对于维护非常重要。

使用此方法的性能开销很小。由于分割，我们最大的翻译文件包含大约 200 个可翻译字符串（包括静态图像 url）。每个请求加载它对性能的影响很小。我想人们可以使用一些第三方踏安全字典将翻译字典缓存在应用程序对象中，但恕我直言，这不值得麻烦。

一个额外的提示，在你的字符串中使用变量替换来提高可翻译性。例如使用：

```
 <%=replace(i18n("Buy $productname"), "$productname", product.name)%> 
```

代替

```
 <%=i18n("Buy")%> <%=product.name%> 
```

第一种方法对译者来说更加灵活。许多语言有不同的句子结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T09:45:00.683

我在自己的 CMS 中使用的方法是在启动时使用基于变量名称、语言 ID 和 CMS 实例的唯一键将数据库中的所有静态语言字符串加载到应用程序对象中。然后我在创建页面时使用页面级缓存到一个数组中，因此重复使用的变量会被缓存，并尽可能避免大量访问 Application 对象。我使用数组而不是字典作为我的 CMS 函数的方式，每个页面都是在部分中创建的，每个部分相互隔离，所以我会在每个页面创建多个字典，这是不可取的。

显然，此解决方案的可行性完全取决于您拥有的变量数量和您拥有的翻译数量以及您需要在每个页面上检索的变量数量。

# c++ - C++模板特化问题

> ID：910542
> 
> 赞同：3
> 
> 时间：2009-05-26T12:58:09.153
> 
> 标签：c++, templates, metaprogramming

我需要一个 C++ 模板，给定一个类型和该类型的对象，它可以根据类型是否为整数做出决定，同时能够访问实际对象。我试过这个

```
template <typename T, T &N>
struct C {
    enum { Value = 0 };
};

template <int &N>
struct C<int, N> {
    enum { Value = N };
}; 
```

但它不起作用。有什么办法可以实现类似的东西吗？

**编辑**

我试图实现的是这样的，这将在编译时发生：

```
if (type is int) {
    return IntWrapper<int_value>
else {
    return type
} 
```

您实际上可以在模板实例化中传递指向对象的指针或引用，如下所示：

```
struct X {
    static const int Value = 5;
};

template <X *x>
struct C {
    static const int Value = (*x).Value; 
};

X x;

std::cout << C<&x>::Value << std::endl; // prints 5 
```

但显然这一切都是通过推断`x`的类型来初始化模板，并且`x`还需要全局声明。我正在尝试做的事情没有用，我认为这在编译时毕竟是不可能的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T13:09:49.363

您尝试做的不是有效的 C++ 模板。您不能使用任意对象作为模板参数，您只能使用类型、整数文字以及在某些特殊情况下的字符串文字。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T19:15:14.697

除非我误解了你，否则你想要的都是不可能的。在您的示例中，您显示了指针模板参数的无效使用。

```
template <X *x>
struct C {
    static const int Value = (*x).Value; 
}; 
```

这是无效的，因为`(*x).Value`它必须是一个常量表达式才能初始化`Value`。当用作代替时，当然`Value`在类中作为常量表达式会很好。但是这一次，它不是因为它涉及一个指针（引用在常量表达式中同样无效）。`X``X::Value`

总而言之，你不能这样做：

```
Magic<T, someT>::type 
```

`::type`如果 T 不是 int，则期望为 T，`IntWrapper<someT>`否则，因为`T`只能是枚举、整数、指针或引用类型。在后两种情况下，您将无法获得指针所指向或在*编译时*引用所引用的任何内容的“值” 。*如果*您对此感到满意，那么解决您的问题很容易，我不会向您展示如何（我怀疑您已经知道如何）。

我认为你已经把自己逼入了这样一种情况，即按照给定的规则解决你的问题变得不可能。当事情仍然可以解决问题时，请退回一些步骤并向我们展示您正在尝试解决的*真正问题。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T13:43:42.480

也许一个简单的重载模板方法适用于您的情况？

```
template<typename T>
void doSomething(const T& x)
{
    // ...
}
void doSomething(int x)
{
    // ...
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T13:15:56.217

```
 template <typename T> struct A
{
    enum { Value = false };
};
template <> struct A<int>
{
    enum { Value = true };
}; 
```

那么这个怎么样：

```
 template <typename T> struct A
{
    T value_;
    A() : value() {}
    enum { is_int = false };
};
template <> struct A<int>
{
    int value_;
    explicit A( int v ) : value_( v ) {}
    enum { is_int = true };
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T13:24:10.863

其他帖子的补充：您不再需要使用`enum {}`-hack 了：

```
template<typename T, int val>
struct Test {
    static const int Value = 0;
};

template <int val>
struct Test<int, val> {
    static const int Value = val;
};

int main(int argc,char *argv[]) {
    const int v = Test<int,1>::Value;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T13:20:38.127

你可以这样做：

```
template<typename T, int val>
struct Test
{
    enum {Value = 0};
};

template <int val>
struct Test<int, val>
{
    enum {Value = val};
};

int main(int argc,char *argv[])
{
    int v = Test<int,1>::Value;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-26T14:23:50.977

> 我需要一个 C++ 模板，给定一个类型和该类型的对象，它可以根据类型是否为整数做出决定，同时能够访问实际对象。

您可以根据类型是否为整数来做出决定，问题是不可能用任何类型的对象声明模板。所以关于如何确定一个类型是否是整数的问题是没有实际意义的。

请注意，在所有答案中，您的原始模板都整齐地更改为

```
template < typename T, int >
class C {}; 
```

而不是你的

```
template< typename T, T >
class C {}; 
```

但是，虽然`C<int, 5>`是一个完全有效的声明，但对于任意类型 T 而言，情况并非如此，例如`C<float, 5.>`会给出编译器错误。

你能准确地发布你想要达到的目标吗？

并且作为记录，如果第二个模板参数始终是`int`，并且如果类型是整数类型，您只想获取它的值，否则为 0，您可以简单地执行以下操作：

```
#include <limits>

template< typename T, int N >
class C {
    static const int Value = (std::numeric_limits<T>::is_integer) ? N : 0;
}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T15:38:43.947

查看 Alexandrescu 的[Modern C++ Design](http://books.google.com/books?id=aJ1av7UFBPwC&dq=modern+c%2B%2B+design&printsec=frontcover&source=bn&hl=en&ei=sgwcSqvfCJvGM63Y9I8P&sa=X&oi=book_result&ct=result&resnum=4)。我相信第 2 章有一个正确的例子来说明你想要做什么。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T13:35:31.590

对您的代码进行简单修复 - 松开参考：

```
template <typename T, T N>
struct C {
    enum { Value = 0 };
};

template <int N>
struct C<int, N> {
    enum { Value = N };
}; 
```

在模板参数中使用引用无论如何都是没有意义的，因为您实际上并没有在任何地方传递参数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-08T21:29:46.237

> 我试图实现的是这样的，这将在编译时发生：

```
if (type is int) {
    return IntWrapper<int_value>
else {
    return type
} 
```

我不确定你为什么不使用 IntWrapper 开始。如果它是 int，从哪里需要将编译时整数常量包装到 IntWrapper 中？

否则，您似乎正在尝试使用仅在运行时可用的数据来实例化模板。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-08T21:05:27.983

[模板专业化](http://www.cplusplus.com/doc/tutorial/templates/)可以这样实现（代码取自 www.cplusplus.com）：

```
// template specialization
#include <iostream>
using namespace std;

// class template:
template <class T>
class mycontainer {
    T element;
  public:
    mycontainer (T arg) {element=arg;}
    T increase () {return ++element;}
};

// class template specialization:
template <>
class mycontainer <char> {
    char element;
  public:
    mycontainer (char arg) {element=arg;}
    char uppercase ()
    {
      if ((element>='a')&&(element<='z'))
      element+='A'-'a';
      return element;
    }
};

int main () {
  mycontainer<int> myint (7);
  mycontainer<char> mychar ('j');
  cout << myint.increase() << endl;
  cout << mychar.uppercase() << endl;
  return 0;
} 
```

在您的情况下，您必须将 char 替换为类模板专业化中所需的内容。现在，我不太确定您要完成什么，但我希望上面的示例能够很好地指示您如何进行模板专业化。

# c# - 序列化列表 到带有继承的 XML

> ID：910546
> 
> 赞同：4
> 
> 时间：2009-05-26T12:59:14.080
> 
> 标签：c#, .net, xml-serialization

我在尝试将我的对象序列化为 XML 时遇到了一些问题。尝试序列化作为配置文件项目列表的“配置文件”属性时会出现问题。个人资料是我自己的类型。Profile 类型在理想情况下应该是抽象的，但事实并非如此，因为 XML 序列化需要一个无参数的 ctor。Profiles 属性包含“IncomeProfile”、“CostProfile”、“InvestmentProfile”等类型的项目，这些项目当然都继承自 Profile。

正如我所读到的，本机不支持序列化，因为 XmlIncludeAttribute 只允许一种继承类型。IE

```
[XmlInclude(typeof(IncomeProfile))]
public List<Profile> Profiles { get; set; } 
```

解决此问题时的最佳做法是什么？我尝试了使用 IXmlSerializable 和反射的不同解决方案，但是我似乎无法将每个配置文件反序列化为正确的类型（它们最终都使用 Profile 类型的 ReadXml(XmlReader reader) 方法，即使 Visual Studio 调试器说对象的类型是“IncomeProfile”或“CostProfile”。这是我当前的反序列化代码，它将xml反序列化为三个Profile对象，而不是两个IncomeProfile和一个CostProfile：

```
while(reader.MoveToContent() == XmlNodeType.Element && reader.LocalName == "Profile")
    {
        String type = reader["Type"];
        var project = (Profile)Activator.CreateInstance(Type.GetType(type));
        project.ReadXml(reader);

        reader.Read();
        this.Profiles.Add(p2);
    } 
```

非常感谢任何想法或建议！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T13:02:25.230

您可以使用多个包含属性 - 尽管它们更常针对类型本身设置：

```
using System;
using System.Collections.Generic;
using System.Xml.Serialization;
[XmlInclude(typeof(IncomeProfile))]
[XmlInclude(typeof(CostProfile))]
[XmlInclude(typeof(InvestmentProfile))]
public class Profile {
    public string Foo { get; set; }
}
public class IncomeProfile : Profile {
    public int Bar { get; set; }
}
public class CostProfile : Profile { }
public class InvestmentProfile : Profile { }
static class Program {
    static void Main() {
        List<Profile> profiles = new List<Profile>();
        profiles.Add(new IncomeProfile { Foo = "abc", Bar = 123 });
        profiles.Add(new CostProfile { Foo = "abc" });
        new XmlSerializer(profiles.GetType()).Serialize(Console.Out, profiles);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T13:02:19.770

您只需使用多个 [XmlInclude] 属性。这很好用。

# crystal-reports - Crystal Reports - 多列数据的行标题

> ID：910550
> 
> 赞同：1
> 
> 时间：2009-05-26T13:00:24.423
> 
> 标签：crystal-reports

请帮忙！

我需要生成一个包含多个数据列的 Crystal Report，但还需要显示行标题。

例如

```
(Fieldname)        (DataColumn1)        (DataColumn2)       (DataColumn3)
Animalname         Elephant             Dog                 Mouse
Animalsize         Large                Medium              Small 
```

我已经使用详细信息部分中的“多列格式”选项成功地显示了数据列，但是有什么方法可以显示标题（动物名/动物大小）吗？

（我在 Visual Studio 2008 中使用 Crystal Reports 2008）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T02:11:27.540

如果表格列是名称和大小，则垂直排列详细信息字段，例如...

```
name  {name_field}
size  {size_field} 
```

但我认为问题在于当你“用多列格式化”时，它会变成这样......

```
name  {name_field}  name  {name_field}  name  {name_field}
size  {size_field}  size  {size_field}  size  {size_field}
name  {name_field}  name  {name_field}  name  {name_field}
size  {size_field}  size  {size_field}  size  {size_field}
name  {name_field}  name  {name_field}  name  {name_field}
size  {size_field}  size  {size_field}  size  {size_field} 
```

那是问题吗？如何仅在第一列中显示“行标题”？因为我不确定这是否可能。即使你能做到，这真的是你想要的吗？

```
name  {name_field}  {name_field}  {name_field}
size  {size_field}  {size_field}  {size_field}
name  {name_field}  {name_field}  {name_field}
size  {size_field}  {size_field}  {size_field}
name  {name_field}  {name_field}  {name_field}
size  {size_field}  {size_field}  {size_field} 
```

走标准的方式不是更容易......

```
name          size          name          size          name          size
{name_field}  {size_field}  {name_field}  {size_field}  {name_field}  {size_field}
{name_field}  {size_field}  {name_field}  {size_field}  {name_field}  {size_field}
{name_field}  {size_field}  {name_field}  {size_field}  {name_field}  {size_field}
{name_field}  {size_field}  {name_field}  {size_field}  {name_field}  {size_field}
{name_field}  {size_field}  {name_field}  {size_field}  {name_field}  {size_field} 
```

我错过了什么吗？

编辑

像这样为每个字段创建一个公式......

```
if remainder(recordnumber, 3) = 1 then
"Field Name    " + {some_field}
else
{some_field} 
```

可能希望将条件放入函数中，以防您想要显示超过 3 列。

# mysql - 为什么关联的集合包含空值？（休眠，注释，弹簧）

> ID：910551
> 
> 赞同：3
> 
> 时间：2009-05-26T13:00:29.243
> 
> 标签：mysql, database, hibernate, spring, associations

[编辑：显然，这只是数组的问题，FoxyBOA 的答案可能指向（甚至是）答案。]

我的问题与这些软件有关：Hibernate3+Annotation、Spring MVC、MySQL，在这个例子中还有 Spring Security。

我想知道，为什么由 Hibernate 自动关联的集合包含子表的每个行号的空值（除了正确的元素）。我的例子：

我有一个*用户*和一个*权限表，**用户*表的主键是*用户名*作为外键。现在，我的*权限*表中有 13 行。当我从数据库（MySQL InnoDB）中检索用户时，Hibernate 会自动检索与此映射对应的用户权限：

```
@OneToMany
@JoinColumn(name = "username")
@IndexColumn(name="id") // "id" was the primary key and is used to sort the elements
public Authority[] getAuthorities() {
    return authorities;
}
public void setAuthorities(Authority[] authorities) {
    this.authorities = authorities;
} 
```

...我最终得到一个包含 14 (0-13) 个元素的集合“权限”，其中只有四个不为空（数据库表中的四行属于该特定用户，所以这是正确的）。据我所知，我正在为 Fetchmode 等属性使用 Hibernate 默认值。我得到的用户是这样的：

```
Criteria criteria = getSession().createCriteria(User.class);
criteria.add(Restrictions.eq("username",username));
User user = (User) criteria.uniqueResult(); 
```

来自 org.hibernate.loader.loader 的日志信息正确地“提及”了结果集的四行。尽管如此，用户创建的数组中有四个正确的元素加上十个空值。在我的具体示例中，这会导致此异常：

```
java.lang.IllegalArgumentException: Granted authority element 0 is null - GrantedAuthority[] cannot contain any null elements 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:01:24.567

答案在于@IndexColumn 注释。它使用 id 的值作为数组索引，因此 Array 中的元素个数基本上是 Authorities 表中 ID 最高的值。

请参阅[有关索引集合的休眠文档](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/collections.html#collections-indexed)

尝试删除注释。

也只是一个念头；您是否考虑过使用 Set 进行映射？这不是绝对必要的，它只是一种更常见的映射形式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:08:25.670

我可以建议你检查你的数据。如果您有丢失的索引（在您的情况下为 id 列），那么您将在数组中获得 null 而不是丢失的 id 。IE

```
table authorities:
username id
bob 1
bob 3
bob 5 
```

结果，您将拥有一个数组： {0=null, 1=bob, 2=null, 3=bob, 4=null, 5=bob}

**更新：** 我在两种情况下遇到了这种情况：

1.  *权限*表的索引列*id*中缺少键值（例如 0,1,3,4,5 - 缺少值 2。Hibernate 将自动添加到键为 2 且值为 null 的数组值）。
**   索引值是按顺序排列的，但选择标准过滤其中的一部分（例如，您的 HQL 类似于“从用户 u 加入 u.authorities a where a.id=2”。在这种情况下，休眠加载用户，但在权限数组中你将只有 3 个值：0 - null、1 - null、2 - id 为 2 的权限。*

 *# mysql - 处理两个坐标之间的距离的最有效方法是什么？

> ID：910553
> 
> 赞同：1
> 
> 时间：2009-05-26T13:00:52.377
> 
> 标签：mysql, google-maps, performance, geospatial

我在 mysql 表中存储了 2063 个位置。在我的一个过程中，我需要根据它们与给定原点的距离来排除某些结果。问题是，我需要一次过滤几百个甚至几千个结果。

那么进行距离数学的最佳方法是什么。我应该在运行时做吗

```
1\. Find all points connecting to my point of origin
2\. loops through the connecting points
3\. calculate the distance between the point of origin and the connecting point
4\. exclude the connecting point if the distance if too great 
```

或者我应该创建一个查找表，其中包含已经计算出的每个点之间的距离。我可以避免重复行，因为 p1 和 p2 之间的距离与 p2 和 p1 之间的距离相同，但这仍然会导致表中出现几百万行。

或者..有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T13:07:10.947

您可以使用 MySQL 的空间扩展来计算距离，甚至可以在数据上创建 R-tree 索引来优化某个范围内的点查找。

有关详细信息，请参阅 MySQL 空间扩展的文档：http: [//dev.mysql.com/doc/refman/5.1-maria/en/spatial-extensions.html](http://dev.mysql.com/doc/refman/5.1-maria/en/spatial-extensions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:10:58.083

这个怎么样：

```
1.遍历所有点：
  2\. 如果 abs(ab) < 距离 && abs(ab) < 距离，则：
    3\. 做a和b之间的花式距离计算。

```

即假设大多数点将在您感兴趣的距离定义的“框”之外，您可以通过步骤 2 非常快速地过滤掉大多数点，并且只计算少量点的实际距离。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T13:13:42.883

由于您的数据位于 mysql 表中，因此您确实需要 SQL 能够帮助您的解决方案。

我将假设每个位置都有一个 x 和 y 坐标。将这些作为单独的条目存储在表中。

您可以快速将搜索范围缩小到以您的兴趣点为中心的框。例如

```
WHERE X > (MyPosX - Range) AND X < MyPosX + Range) 
AND Y > (MyPosY - Range) AND Y < MyPosY + Range) 
```

一旦您有一组较小的可能在范围内的项目，您可以使用更迭代的方法

**编辑：**在计算实际距离时避免平方根计算，因为这些很昂贵。例如，而不是

```
sqrt(x*x + y*y) < distance 
```

尝试

```
(x*x + y*y) < distance*distance    
// distance*distance is a constant and can be calculated once 
```

# c# - 直线和球体的交点？

> ID：910565
> 
> 赞同：3
> 
> 时间：2009-05-26T13:03:51.247
> 
> 标签：c#, math, 3d

我有一个简单的对象，它允许您分配三个属性（x，y，z）（让我们将此对象称为“点”，因为它就是这样）。然后我有第二个对象，其方法接受第一个对象的两个实例，并返回三维空间中两个“点”之间的距离。我还需要一个方法，它将接受两个“点”和一个双精度，表示行进的距离（从使用的第一个“点”参数开始），它返回一个带有 x、y、z 坐标的“点”对象。

除了计算所提供的两个点之间的原始线上的点坐标（即距第一个点一定距离）之外，我对一切都很好。

“点”对象：

```
public class POR
{
    private double PORX;
    private double PORY;
    private double PORZ;

    public double X
    {
        get { return PORX; }
        set { PORX = value; }
    }
    public double Y
    {
        get { return PORY; }
        set { PORY = value; }
    }
    public double Z
    {
        get { return PORZ; }
        set { PORZ = value; }
    }
    public POR(double X, double Y, double Z)
    {
        PORX = X;
        PORY = Y;
        PORZ = Z;
    } 
```

然后我正在使用：

```
 public double PorDistance(POR por1, POR por2)
    {
        return Math.Round(Math.Sqrt( Math.Pow((por1.X - por2.X),2) + Math.Pow((por1.Y - por2.Y),2) + Math.Pow((por1.Z - por2.Z),2)),2);
    } 
```

要返回这两点之间的距离，我需要类似的东西

```
public POR IntersectPOR (POR por1, POR por2, double distance)
{

} 
```

其中 distance 是从 por1 到 por2 的距离。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T13:18:35.290

这可以通过向量的一些帮助来完成。

假设您的起点称为P，另一点为Q，距离为d。你想在从 P 到 Q 的距离为 d 的线上 PQ 上找到点。

1.  首先你需要找到行进的方向。这是通过找到 Q - P

    ```
    v = Point(Q.x - P.x, Q.y - P.y, Q.z - P.z) 
    ```

2.  现在你需要找到那个方向的单位向量，所以

    ```
    scale = sqrt(v.x*v.x + v.y*v.y + v.z*v.z)
    unit = Point(v.x/scale, v.y/scale, v.z/scale) 
    ```

3.  现在您需要找到表示行进距离的向量：

    ```
    t = Point(unit.x*d, unit.y*d, unit.z*d) 
    ```

4.  要找到最终位置，请将您的行进向量添加到您的起点：

    ```
    final = Point(P.x + t.x, P.y + t.y, P.z + t.z) 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:13:18.997

看起来你想要类似的东西：

```
public class Point
{
     public double x, y, z;

     // ctors, Add(), Subtract() omitted

     public Point Normalize()
     {
         double m = Magnitude;
         if (m != 0.0) return ScaleTo(1.0/m);
         return new Point();
     }

     public double Magnitude
     {
         get { return Math.Sqrt(x * x + y * y + z * z); }
     }

     public Point ScaleTo(double s)
     {
         return new Point(x * s, y * s, z * s);
     }
}

public Point PointOnLine(Point from, Point to, double dist)
{
    return from.Add(to.Subtract(from).Normalize().ScaleTo(dist));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T13:28:29.000

没有实际代码，因为我认为这更像是一个概念性问题。这可能不是最有效的，但是当我这样做时，我只是将总距离和线段之间的比率应用于坐标增量。例如，如果我在 0,0,0 和 1,2,3 处有点，则总 3D 距离为 3.74，如果我想从第一个点放置一个点 1 单位，则比率为 1/3.74，因此新坐标为从第一个点到第二个点的总距离的 .2673 或 .267 , .534 , .802

# .net - Data Access Application Block 和 Transaction Scope 将不同的数据库对象使用相同的连接

> ID：910577
> 
> 赞同：0
> 
> 时间：2009-05-26T13:07:59.603
> 
> 标签：.net, asp.net, enterprise-library, application-blocks

我将 System.Transactions 和 Transaction 范围与 Enterprise Library Data Access Application Block 一起用于我的事务处理。

在某些情况下，我在事务中使用 Database 类的单独实例。但是，连接是到同一个数据库。

我想知道在这种情况下，应用程序块是否会重用相同的连接而不跨越分布式事务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T13:17:26.243

简而言之， [MSDN](http://msdn.microsoft.com/en-us/library/cc511672.aspx)有你的答案：

“另一方面，企业库通常会为每个请求打开和关闭一个连接。这种做法与 TransactionScope 类的工作方式不兼容。如果有多个连接，则 TransactionScope 类将事务视为分布式事务。分布式与本地事务相比，事务具有显着的性能和资源开销。” (MSDN)

和

“为避免这种情况，数据库类方法（如 ExecuteDataSet）会识别 TransactionScope 实例何时处于活动状态，并在此事务中登记数据库调用。如果事务当前由于使用 TransactionScope 实例而处于活动状态，则数据库类方法使用一个单一的连接。” (MSDN)

你没有提到你正在使用什么数据库。在我使用的 Oracle 10g 客户端中，如果您使用 TransactionScope，您将始终拥有分布式事务。看起来这个问题[现在在以后的版本中得到解决](http://forums.oracle.com/forums/thread.jspa?messageID=1836900)。

您可以通过查看[Transaction Statistics](http://technet.microsoft.com/en-us/library/cc732182(WS.10).aspx)来检查答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:10:06.710

`TransactionScope`是一种非常奇怪的野兽。根据我的经验，一旦另一个连接（甚至是同一个数据库）打开，数据库事务就会被提升为分布式事务。

# wpf - DependencyProperty.Register() 或 .RegisterAttached()

> ID：910579
> 
> 赞同：42
> 
> 时间：2009-05-26T13:08:41.583
> 
> 标签：wpf, workflow-foundation, dependency-properties

两者有什么区别，什么时候应该使用RegisterAttached()而不是.Register()？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-27T05:04:51.313

我假设您的意思是 DependencyProperty.Register 和 DependencyProperty.RegisterAttached。

DependencyProperty.Register 用于注册普通的DependencyProperty。您可以将它们视为常规属性，并增加它们可以参与 WPF 的 DataBinding、动画等的扭曲。事实上，它们在无类型的 DependencyObject.SetValue 之上作为普通属性（使用 get 和 set 访问器）公开/ 获取值。您将它们声明为您的类型的一部分。

另一方面，附加属性是不同的。它们被认为是一个可扩展性系统。如果您曾经在 Windows 窗体中使用过扩展器，它们有点相似。您将它们声明为类型的一部分，以用于另一种类型。

它们被大量用于与布局相关的信息。例如，Canvas 需要 Left/Top 坐标，Grid 需要 Row 和 Column，DockPanel 需要 Dock 信息等。如果所有这些都必须在每个可以布局的 Control 上声明，那将是一团糟。因此它们在相应的面板上声明，但在任何控件上使用。

如果需要，您可以使用相同的东西将任何信息附加到 DependencyObject。例如，只需声明一条您可以在 xaml 中设置的信息，以便稍后在现有类的样式中使用它就可以派上用场。

所以这两种 DependencyProperty 服务于一个非常不同的目的。常规属性（通过 Register() 注册）与普通属性一样用作类型接口的一部分。附加属性（通过 RegisterAttached() 注册）用作现有类的扩展点。

希望能澄清一点。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-27T00:19:12.400

DependencyProperty.Register() 和 DependencyProperty.RegisterAttached() 之间的区别在于 .Register() 用于在 DependencyObject 上注册“常规”依赖属性，而 .RegisterAttached() 用于设置“附加”依赖属性。

两种类型的依赖属性之间的区别相当简单：常规依赖属性是在特定的 DependencyObject 上设置的，就像您设置任何其他 .NET 属性一样。另一方面，附加属性与特定的 DependencyObject（例如 Grid）相关联，但设置在完全独立的 DependencyObject 上，通常是定义附加属性的 DependencyObject 的子项（例如 Grid.Row，附加属性）在父网格的子节点上）。

有关附加属性[的更多详细信息，请参见 MSDN](http://msdn.microsoft.com/en-us/library/ms749011.aspx)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-19T07:18:29.347

使用 Register 或 RegisterAttached 注册的属性可以使用 SetValue 和 GetValue 附加到任何 DependencyObject。但是，如果您将使用 Register 注册的属性附加到非 ownerType 类型的对象上，则不会使用其元数据（默认值除外）。这意味着 Inherits 或 AffectsMeasure 等属性不适用于这些属性。如果您对附加属性的元数据感兴趣，则应使用 RegisterAttached。

For details, see my answer to a similar question: [Difference between Attached and non-Attached Dependency Properties in Silverlight](https://stackoverflow.com/questions/6843877/difference-between-attached-and-non-attached-dependency-properties-in-silverlight/7463778#7463778)

# html - Firefox 中的 HTML 表格呈现问题

> ID：910583
> 
> 赞同：0
> 
> 时间：2009-05-26T13:09:12.533
> 
> 标签：html, firefox

该表在 Firefox 中的呈现方式与 IE8/Chrome 不同。

该网站在这里：[http ://nordschleife.metaforix.net/118/118/index.php/panasonic.html?id=5&___store=uk&___from_store=default](http://nordschleife.metaforix.net/118/118/index.php/panasonic.html?id=5&___store=uk&___from_store=default)

我更喜欢 IE8/Chrome 下的表格的外观和感觉，因为线条是浅灰色而不是全黑。

我能做些什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T13:12:08.797

您需要在 CSS 信息中为 TD 元素赋予浅灰色边框颜色。

例如

```
table tr td {border:1px solid #DDD; } 
```

# c# - C# variable length args, which is better and why: __arglist, params array or Dictionary ?

> ID：910585
> 
> 赞同：10
> 
> 时间：2009-05-26T13:09:42.063
> 
> 标签：c#, c#-3.0, c#-2.0

I recently read the following overflow post: [Hidden Features of C#](https://stackoverflow.com/questions/9033/hidden-features-of-c)

One of the features pointed out was the arglist. Why would one choose this or the alternatives as a means of using a variable length argument list to a method? Also, note that I would probably not use this kind of construct in my code unless a corner case warranted doing so. This is more of a question of semantics than whether it is even practical or prudent to even use variable length arguments. So does anyone know which is better and why?

```
 [Test]
 public void CanHandleVariableLengthArgs()
 {
     TakeVariableLengthArgs(__arglist(new StringBuilder(), 12));

     object[] arr = { new StringBuilder() };
     TakeVariableLengthArgs2(arr);

     TakeVariableLengthArgs3(
         new Dictionary<string, object> 
         { { "key", new StringBuilder() } });
 }

 public void TakeVariableLengthArgs(__arglist)
 {
      var args = new ArgIterator(__arglist);

      var a = (StringBuilder)TypedReference.ToObject(args.GetNextArg());
      a.Append(1);
 }

 public void TakeVariableLengthArgs2(params object[] args)
 {
      var a = (StringBuilder)args[0];
      a.Append(1);
 }

 public void TakeVariableLengthArgs3(Dictionary<string, object> args)
 {
      var a = (StringBuilder)args["StringBuilder"];
      a.Append(1);
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T13:18:47.117

I would certainly never use __arglist, since it's undocumented and nobody knows what it means in any case.

I'd also avoid variable-length argument lists for as long as possible, and instead rework my design to understand what is truly variable, and to model that variability in a less platform-dependant manner.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T14:13:38.410

C# 4 will have a better mechanism for this; [named and optional arguments](http://msdn.microsoft.com/en-us/library/dd264739(VS.100).aspx):

```
static void Main(string[] args)
{
    // The method can be called in the normal way, by using positional arguments.
    Console.WriteLine(CalculateBMI(123, 64));

    // Named arguments can be supplied for the parameters in either order.
    Console.WriteLine(CalculateBMI(weight: 123, height: 64));
    Console.WriteLine(CalculateBMI(height: 64, weight: 123));

    // Positional arguments cannot follow named arguments.
    // The following statement causes a compiler error.
    //Console.WriteLine(CalculateBMI(weight: 123, 64));

    // Named arguments can follow positional arguments.
    Console.WriteLine(CalculateBMI(123, height: 64));
}

static int CalculateBMI(int weight, int height)
{
    return (weight * 703) / (height * height);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T14:03:04.967

It depends on the case. I've used params in cases where I have a variable number of arguments and it significantly adds to the readability of the calling code.

For example, I have a class that represents a TIFF document and allows access to a collection of pages which can be reordered and interspersed with other TIFF documents. Since one of the most common tasks our customers want is the ability to easily combine multiple TIFF documents into a single, we also provide the following two utility methods:

```
public static void Combine(Stream output, params Stream[] sources) { /* ... */ }
public static void Combine(Stream output, params string[] sourceFiles) { /* ... */ } 
```

which in usage make the client code feel really nice:

```
using (FileStream output = new FileStream(outputPath, FileMode.Create)) {
    TiffDocument.Combine(output, tpsCoverSheetPath, mainDocumentPath, tpsTrailerPath);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T14:07:14.973

In general, you are probably better off avoiding undocumented features of the language - for several reasons.

*   They are more likely to change then the established, documented features
*   They may have side-effects and implications that are not obvious in their usage
*   Other developers will not be familiar with them and will have a harder time maintaining your code
*   Refactoring tools (like VS itself or [Resharper](http://www.jetbrains.com/resharper/index.html)) are unlikely to be able to recognize them
*   They take away clarity from the intent of your code
*   There are language-supported alternatives to most of them

In the specific case of the __arglist, you can achieve the same capabilities with the language supported [params](http://msdn.microsoft.com/en-us/library/w5zay9db.aspx) keyword, which allows you to create type-safe variable argument lists for methods in C#. As a practice, though, I would be careful using it as it can obfuscate your code if used inpropertly - good use cases (like those in string.Format() which accepts variable arguments) - are less frequent than you would think.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T13:21:41.757

I would prefer to not use *any* of the three techniques described here. I would instead design a value object that has strong types wherever possible, and possibly even nullable types. If push comes to shove you can create a generics-typed value object too.

There's just all so much code smell in this way of coding for me. A *variable length* collection of *object* ? Wouldn't pass unnoticed in *my* code review.

**Edit**: And if it DID pass my code review the parameter would in all likelyhood be an IEnumerable instance and none of the three suggestions items. IEnumerable is the leanest thing that could encapsulate my needs.

# c# - 是否有基于 .NET 的 CSS 抽象库？

> ID：910587
> 
> 赞同：4
> 
> 时间：2009-05-26T13:10:05.493
> 
> 标签：c#, .net, css, vb.net, dsl

我已经在一个非常大的项目上工作了将近 2 年，并且客户的要求不断变化。当然，这些变化会影响一切，我想找到一种以更动态的方式使用 CSS 的方法。

我假设我可以获得在 IronRuby/Python 下运行的 ruby​​ 或 python CSS DSL 之一，但是这个客户端对安装的软件/框架非常特别。

我还没有找到基本编程语言是 vb 或 c# 的 CSS DSL。

参考： [http](http://sandbox.pocoo.org/clevercss/) ://sandbox.pocoo.org/clevercss/和[http://nubyonrails.com/articles/dynamic-css](http://nubyonrails.com/articles/dynamic-css)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-22T16:51:24.820

Less CSS for .NET 最近发布了。

[http://www.dotlesscss.org/](http://www.dotlesscss.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T17:12:30.420

我不确定是否有任何公开可用的产品，但我已经为 .css 文件编写了几次 ASP.NET HttpHandler。这是一项非常简单的任务，我通常会添加变量和基本表达式支持、实时缩小、注释剥离等内容。这是您要找的吗？如果是这样，我认为每次最多需要 10 个小时的工作来编写、调试和实现处理程序……考虑到所有的好处，这还不算太糟糕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T17:24:33.483

您还可以使用作为 Visual Studio SDK 一部分的 DSL 工具包或使用 Oslo 编写自己的 DSL。在前一种情况下，结果可能是 .css 文件以及您需要的任何其他文件，包括供您的 ASP.NET 应用程序调用的 API 代码。

# visual-studio - 什么是强命名键？

> ID：910589
> 
> 赞同：1
> 
> 时间：2009-05-26T13:10:11.797
> 
> 标签：visual-studio, strongname

在 .NET 中，什么是强命名键？我以前读过它，但它并没有留在我的脑海里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:19:56.660

它们用于识别程序集。更具体地说，谁创建了程序集。

使用强名称密钥签署程序集的一个原因是将其添加到 GAC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:16:31.037

根据（[http://msdn.microsoft.com/en-us/library/wd40t7ad(VS.71).aspx](http://msdn.microsoft.com/en-us/library/wd40t7ad(VS.71).aspx)），它可以防止任何人更改程序集。
它保护（半）编译的程序集被更改。

# c# - 字典词典的扩展方法

> ID：910591
> 
> 赞同：4
> 
> 时间：2009-05-26T13:10:29.673
> 
> 标签：c#, dictionary, extension-methods

我正在尝试编写一个扩展方法来将数据插入到定义如下的字典字典中：

```
items=Dictionary<long,Dictionary<int,SomeType>>() 
```

到目前为止，我所拥有的是：

```
 public static void LeafDictionaryAdd<TKEY1,TKEY2,TVALUE>(this IDictionary<TKEY1,IDictionary<TKEY2,TVALUE>> dict,TKEY1 key1,TKEY2 key2,TVALUE value)
    {
        var leafDictionary = 
            dict.ContainsKey(key1) 
                ? dict[key1] 
                : (dict[key1] = new Dictionary<TKEY2, TVALUE>());
        leafDictionary.Add(key2,value);
    } 
```

但编译器不喜欢它。该声明：

```
items.LeafDictionaryAdd(longKey, intKey, someTypeValue); 
```

给我一个类型推断错误。

对于声明：

```
items.LeafDictionaryAdd<long, int, SomeType>(longKey, intKey, someTypeValue); 
```

我得到“...不包含...的定义，并且最好的扩展方法重载有一些无效的参数。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T13:24:23.343

一些创造性的通用用法；-p

```
class SomeType { }
static void Main()
{
    var items = new Dictionary<long, Dictionary<int, SomeType>>();
    items.Add(12345, 123, new SomeType());
}

public static void Add<TOuterKey, TDictionary, TInnerKey, TValue>(
        this IDictionary<TOuterKey,TDictionary> data,
        TOuterKey outerKey, TInnerKey innerKey, TValue value)
    where TDictionary : class, IDictionary<TInnerKey, TValue>, new()
{
    TDictionary innerData;
    if(!data.TryGetValue(outerKey, out innerData)) {
        innerData = new TDictionary();
        data.Add(outerKey, innerData);
    }
    innerData.Add(innerKey, value);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T13:19:24.650

尝试使用具体类型：

```
public static void LeafDictionaryAdd<TKEY1,TKEY2,TVALUE>(this IDictionary<TKEY1, Dictionary<TKEY2,TVALUE>> dict,TKEY1 key1,TKEY2 key2,TVALUE value) 
```

看到**`Dictionary<TKEY2,TVALUE>`**而不是`IDictionary<TKEY2,TVALUE>`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T13:21:58.590

我猜这是一个协方差/逆变问题。您的方法签名需要 IDcitionaries 的 IDictionary，但您传递给它的是 Dictionary 的 IDictionary。尝试在您的方法签名中使用具体的字典来代替内部字典。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T13:23:14.470

如果您在 Parameter 列表中为 Extension 方法指定 IDictionary，那么您的项目将不匹配。

将您的扩展名更改为

```
public static void LeafDictionaryAdd<TKEY1,TKEY2,TVALUE>(
    this IDictionary<TKEY1, Dictionary<TKEY2,TVALUE>> dict,
    TKEY1 key1,
    TKEY2 key2,
    TVALUE value) 
```

或尝试将您的物品投射到

```
((IDictionary<long, IDictionary<int, YourType>>)items).LeafDictionaryAdd(l, i, o); 
```

# .net - 在 .net 代码中获取对已运行进程的引用

> ID：910598
> 
> 赞同：0
> 
> 时间：2009-05-26T13:11:47.723
> 
> 标签：.net, windows, process, reference

是否可以在托管代码中获取对已运行进程（COM+ 组件）的引用并在其上调用方法？除了实例化一个新对象之外，有没有一种方法可以指向一个已经运行的 COM 对象实例，这样 .net 代码就可以引用正在运行的进程，就像它已经实例化它一样 - 像调用它的方法一样它在自己的应用程序域中更新了一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T13:44:33.960

### 通讯

这完全取决于 COM 组件。如果它被设计为单例（例如，这在 ATL 中直接支持）并且不在进程中，那么获取相同的对象是唯一的选择。

另一方面，大多数 COM 组件不提供执行此操作的能力，即使进程耗尽。单个代理/代理组件可以拥有相关组件的单个实例。

总结：它可以做到，但只有在组件的合作下，客户端代码通过覆盖实例化来“实例化”以返回相同的对象。

### WCF

WCF 可能是另一条路线。默认情况下，WCF 服务器运行时将为每个调用实例化一个新实例。但是您可以使用属性来覆盖它，并在单个实例中服务所有客户端请求（并且您必须处理并发）。同样，实现服务契约的类可以引用单例。

# transactions - 如果消息在 MQ 中回滚，会发生什么？

> ID：910613
> 
> 赞同：6
> 
> 时间：2009-05-26T13:16:01.723
> 
> 标签：transactions, message-queue, ibm-mq, high-volume

我收到来自 WebSPhere MQ 队列的消息。我尝试处理，如果我收到一些异常，我想将消息回滚到 MQ 队列。

我做同样的事情没有问题。消息会发生什么？它会排到队列的底部吗？

如果我尝试从队列中提取消息，我会收到与回滚相同的消息吗？

可能的行为是什么？我想知道这种行为通常在大容量队列场景中吗？

感谢任何输入。

谢谢，芒卢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T15:38:40.110

如果您在事务范围内执行队列操作，并且发生回滚，则在事务解决后，队列和消息将像事务开始前一样出现。换句话说，根本没有变化。

但是，在大容量场景中，通常在单个队列上有多个事务读取器和写入器，并且它们不会为每个出队或入队锁定整个队列。

这些读取器和写入器会将项目插入队列，或者在您注定的事务正在解决时以事务方式从队列中取出项目。在这种情况下，其他队列项目可能会出现或消失（或两者兼而有之）。

如果在原始事务回滚后，您再次从队列中出列，您*可能会*收到原始消息，但可能不会。在大容量、高并发的场景中，有可能在您的代码执行此操作之前，另一个阅读器已经提取了消息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T20:17:57.613

回滚将消息留在队列中并将其放置以重新传递。

但是，当达到重新传递尝试的（可配置的）限制时，消息将被放在“死信队列”中。

发生这种情况的典型示例是 sc '毒消息'：由于基本和非暂时性问题（例如无效格式、缺少字段等）而无法处理的消息。

因此，在回滚（并将消息放回队列）之前，请务必考虑错误是否是暂时的（例如与后端的连接被破坏）。

在后一种情况下，最好吞下消息并记录错误或触发其他警报。否则，消息将不必要地消耗处理能力和队列基础设施。

高温高压

盖伊

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-26T11:11:45.187

要回答这个线程中的几个具体点......

*   消息保留它在队列中的位置。同步点下的 GET 会锁定消息，但不会将其从队列中移除或更改其位置。回滚释放锁定并使消息可用于重新传递。
*   有害消息的自动重新排队使用 JMS 和 XMS 类而不是本机 Java、C、C#、COBOL 等 API。如果您没有使用 JMS 或 XMS（它为 C 和 .Net 程序实现 JMS API），那么您需要自己重新排队消息。
*   您是正确的，在超过 BOQTHRESH 重新传递后，将在输入队列的 BOQNAME 属性中指定的队列上尝试重新排队。如果该队列不可用（已满、未授权、不存在等），则尝试 DLQ。如果失败，消息侦听器将完全停止接收消息。
*   理想情况下，程序将通过重新排队并警告异常队列中存在消息来处理有害消息。如果做不到这一点，至少不要只是消费和丢弃消息。将它与消息标题一起记录下来，以便以后有人可以协调它发生的事情。

# sql-server - 在 SQL Server 2005 中使用 FreeTextTable 时初始查询缓慢

> ID：910615
> 
> 赞同：2
> 
> 时间：2009-05-26T13:16:08.993
> 
> 标签：sql-server, sql-server-2005, caching, freetext, freetexttable

以下 FreeTextTable 查询在第一个请求上花费 > 10 秒，但对于后续请求大约需要一秒钟：

```
SELECT [Key], [Rank]
INTO #matches
FROM FREETEXTTABLE(Book, [Description], @searchWord) 
```

大约后。10 分钟不活动下一个请求将再次花费 > 10 秒。这似乎是定期清除自由文本缓存。

这是我可以在 SQL Server 2005 中配置的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T08:25:44.477

你是在没有互联网访问的服务器上运行它吗？

SQL Server 2005 尝试在第一次使用分词器时对其执行证书验证。这会在 45 秒后超时，之后后续查询不会执行检查。

但是，如果 5 分钟内没有运行全文查询，则卸载断字器并再次执行证书检查。

您可以通过运行禁用证书检查

```
sp_fulltext_service 'verify_signature', 0; 
```

更多信息在这里：http: [//support.microsoft.com/default.aspx/kb/915850](http://support.microsoft.com/default.aspx/kb/915850)

# sql-server - 是否可以直接用 T-SQL 语言计算 MD5 哈希？

> ID：910617
> 
> 赞同：8
> 
> 时间：2009-05-26T13:16:23.687
> 
> 标签：sql-server, tsql, hash, sql-server-2000, md5

我需要散列（MD5）我们 Sql Server 2000 数据库中的所有密码。我可以轻松地生成一个 C#/VB.NET 程序来转换（散列）所有密码，但我想知道（更多的是为了我的教育而不是真正的迫切需要）是否可以直接在 T-SQL 中计算 MD5 散列。
感谢任何会回答的人。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T13:19:32.153

在 2005 年及以后，您可以调用[HashBytes()](http://msdn.microsoft.com/en-us/library/ms174415.aspx)函数。在 2000 年，最接近的是[pwdencrypt/pwdcompare](http://weblogs.asp.net/bradygaster/archive/2003/11/26/39935.aspx)，尽管这些功能有其自身的缺陷（阅读链接的评论）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T13:18:19.113

它正在使用此代码，但它不是该语言的原生代码。

[http://www.codeproject.com/KB/database/xp_md5.aspx](http://www.codeproject.com/KB/database/xp_md5.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T13:22:13.770

不，在 SQL Server 2000 中没有用于生成 MD5 哈希的本机 TSQL 命令。

2005及以上可以使用该`HashBytes`功能：http: [//msdn.microsoft.com/en-us/library/ms174415.aspx](http://msdn.microsoft.com/en-us/library/ms174415.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-31T20:57:59.753

请参阅下面使用 2008 的示例/解决方案

```
DECLARE @HashThis nvarchar(4000);
SELECT @HashThis = CONVERT(nvarchar(4000),'dslfdkjLK85kldhnv$n000#knf');
SELECT HashBytes('md5', @HashThis);
GO 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T16:38:48.850

md5 没有什么神奇之处，如果你愿意，你可以将它实现为一个纯 tsql 函数。我不确定在 tsql 中会不会很有趣，但是应该没有什么可以阻止你这样做:)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-02-21T14:13:56.163

仅作记录：

```
UPDATE T_WHATEVER_YOUR_TABLE_NAME_IS 
    SET PREFIX_Hash = LOWER(SUBSTRING(master.dbo.fn_varbintohexstr(HashBytes('MD5', LOWER('a-string-with-utf8-encoded-international-text'))), 3, 32) ) 
```

# c++ - 在 Windows 上生成硬件 ID

> ID：910619
> 
> 赞同：17
> 
> 时间：2009-05-26T13:17:11.173
> 
> 标签：c++, windows, unique, uuid, copy-protection

使用 C++ 在 Microsoft Windows 上生成一个不易被欺骗的唯一硬件 ID（例如更改 MAC 地址）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-26T13:24:08.680

Windows 在注册表中为每台机器存储一个唯一的 Guid：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Cryptography\MachineGuid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:27:08.013

这曾经是 CPU 序列号，但今天有许多类型的主板，这个因素并不准确。MAC地址很容易伪造。这给我们留下了内部硬盘驱动器序列号。另见： http: [//www.codeproject.com/Articles/319181/Haephrati-Searching-for-a-reliable-Hardware-ID](http://www.codeproject.com/Articles/319181/Haephrati-Searching-for-a-reliable-Hardware-ID)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-08T17:05:39.987

有各种各样的“技巧”，但唯一真正的“物理答案”是“不，没有解决方案”。

“机器”只不过是带有一些硬件的被动总线。尽管每一块熨斗都可以提供某种可用的标识符，但每一块熨斗都可以由用户更换，无论出于何种坏或好的原因，您永远无法完全意识到（因此，如果您将功能基于此，则会给您的用户，因此 - 因此 - 每次必须更换/重新初始化/重新配置硬件等时对您自己来说）。

现在，如果您的问题是在许多机器必须一起互操作的环境中识别一台机器，那么 MAC 或 IP 地址或主机名可以很好地发挥这一作用。但是要准备好它们不一定在很长一段时间内保持不变的想法（因此避免对它们进行硬编码 - 而是在您的任何启动时“发现”）

如果您的问题是 - 而不是 - 识别软件实例或许可证，您可能最好专注于另一种解决方案：您将许可证出售给“用户”（有钱的是用户，而不是他的计算机！），不是他们的“机器”（用户必须在需要/喜欢的时候在未经您许可的情况下自由更改，因为您没有许可硬件或操作系统......），因此您的问题不是识别机器，而是用户（考虑到同一台机器可以是许多用户的主机，并且同一用户可以在各种机器上工作......，你不能假设/强加 1:1 关系，而不会很快遇到某种问题或者以后，当这个成语 ifs 发现不再合适时）。

The idea should be to register the users in a somewhat reachable site, give them keys you generate, and check that a same user/key pair is not con-temporarily used more than an agreed number of times under a given time period. When violations exceed, or keys becomes old, just block and wait for the user to renew.

As you can see, the answer mostly depends on the reason behind your question, more than from the question itself.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:26:40.393

分配给硬件的各种 ID 可以被读取和组合以形成机器密钥。例如，您可以获得存储软件的硬盘的 ID、proc ID 等。其中一些可以比其他更容易设置，但部分优势在于将多个部分组合在一起，这些部分不一定自己足够强大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-07T13:38:12.183

这是一个可以读取和显示您的计算机/硬件 ID的程序（也可用作[DLL ）：http:](http://www.soft.tahionic.com/download-hdd_id/hardware%20ID%20programmer%27s%20DLL.html) [//www.soft.tahionic.com/download-hdd_id/index.html](http://www.soft.tahionic.com/download-hdd_id/index.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-27T15:20:11.070

使用 Win32 系统 HDS API。不要阅读注册表，它根本没有任何意义。

# asp.net-mvc - Html.ListBox

> ID：910627
> 
> 赞同：1
> 
> 时间：2009-05-26T13:18:39.050
> 
> 标签：asp.net-mvc, listbox

我正在尝试使用 asp.net mvc 重新选择列表框中的项目

```
Html.ListBox("SupplierId",
             new SelectList(Model.Suppliers, "Id", "Name", Model.SelectedSuppliers)) 
```

这是视图数据

```
var viewData = new ViewData.SubstrateEditViewData(
               new DataAccess.SubstrateRepository().GetItemById(id),
               new DataAccess.SupplierRepository().GetItems(),
               new DataAccess.SupplierSubstrateRepository().GetItems().Where(s =>  s.SubstrateId ==id).Select(s => s.Supplier)); 
```

由于某种原因，即使我可以看到 Model.SelectedSupplier 包含两个 Supplier 对象，它也没有选择项目。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T05:44:52.420

请注意，只有项目的 id 应传递给*MultiSelectList()方法的**selectedValues*参数，因此您应该使用

 *```
Html.ListBox("SupplierId", new MultiSelectList(Model.Suppliers, "Id", "Name",
    Model.SelectedSuppliers.Select(s => s.Id))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:53:22.070

SelectList 构造函数的[文档](http://msdn.microsoft.com/en-us/library/dd492553.aspx)引用了单个值。看起来传入 List 或 IEnumerable 值不会导致列表框选择多个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T16:16:26.773

几周前我也遇到过同样的问题。MultiSelect 列表的默认扩展方法不符合预期。我最终只是自己循环遍历这些项目并`selected`手动设置它们的属性。

# .net - sql在事务下执行时抛出错误

> ID：910637
> 
> 赞同：1
> 
> 时间：2009-05-26T13:20:23.773
> 
> 标签：.net, sql, sql-server

我正在尝试在事务下执行以下语法，但它会引发错误：-

这是我在事务下执行的脚本：-

```
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
-- full text search is installed. Run the necessary procedures
BEGIN
    declare @dbName nvarchar(128)
    select @dbName = DB_Name()
    exec('ALTER DATABASE [' + @dbName + '] SET RECOVERY SIMPLE')

    if(0 = DATABASEPROPERTY(DB_Name(),'IsFulltextEnabled'))
    BEGIN
        -- Full text is installed but not enabled on the Database. Enable that
        EXEC sp_fulltext_database 'enable'  
    END

    -- Check if there are current tables in full text search. If yes, remove them
    if(1 = INDEXPROPERTY(Object_id('Blog'),'PK_Blog','IsFulltextKey'))
    BEGIN
        -- Drop the full text index
        EXEC sp_fulltext_table 'Blog','drop'
    END
END 
```

我收到以下错误：-

多语句事务中不允许使用 ALTER DATABASE 语句。不能在事务中执行过程“sys.sp_fulltext_table”。不能在事务中执行过程“sys.sp_fulltext_table”。不能在事务中执行过程“sys.sp_fulltext_table”。

小伙伴们有什么想法吗？？

编辑：-我想知道有没有办法做到这一点。我正在尝试更改数据库中列的数据类型，并且它们已启用全文搜索，因此我希望以某种方式完成上述操作。:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T13:25:58.693

你在问什么 ？

您收到了一条错误消息，准确地解释了问题所在。您不能在事务下执行该 SPROC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T13:29:18.047

这里的问题是，大多数数据定义语言语句 (DDL)（如 Alter Database）在执行时都会发出隐式提交。TSQL 代码试图通过告诉您“您不能这样做”来保护您免受某些意外结果的影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:53:58.670

您可以尝试推出自己的交易。基本上，在每个步骤中捕获已完成的操作，如果有任何失败，手动撤消这些步骤直至失败点。但是这很危险，因为如果发生灾难性故障，那么您可能无法回滚所有内容，并且总是有可能错过某些组合。

# jquery-ui - Jquery ui 选项卡的不同动画

> ID：910640
> 
> 赞同：3
> 
> 时间：2009-05-26T13:20:41.073
> 
> 标签：jquery-ui

我正在使用 jquery ui 选项卡小部件。我没有使用过 jquery 主题，因为我更喜欢自己做 css 和东西。我已经让它工作了，但我想要的是在单击不同的选项卡时为选项卡内容提供不同的动画效果。我想要的是新标签内容从左侧滑入。

目前我有：

```
$("#tabs").tabs({ fx: {slide: 'slow' } }); }); 
```

我知道上面的代码只是滑动而不是向左滑动，但它甚至没有滑动！我已经下载了幻灯片效果作为我的自定义 ui 下载的一部分。我不知道为什么它不起作用！是我缺少一些CSS吗？！我不知道！！！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-22T14:49:39.053

不确定您使用的是哪个版本，但对于 1.7.1，这里是如何做到的：

```
$("#tabs").tabs({ 
    fx: { height: 'toggle', duration: 'slow' }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-07T15:00:11.913

我知道这个问题已经超过一年了，但你可以试试这个：

```
$('#tabs').tabs(
{
   fx: { width: 'toggle', duration: '500' }
}); 
```

如果你使用 'width'，jQuery 将使用 width 属性创建效果，从而产生水平动画。您还可以将高度和宽度一起使用以获得对角线效果。

还可以尝试使用“隐藏”和“显示”关键字而不是“切换”，它们也很酷:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-09T11:25:47.150

只是为了更新这个问题的答案，使用 1.10 版的 jquery ui，我使用了“显示”选项在选项卡上应用过渡效果。jquery ui 文档中有一个示例：

[http://api.jqueryui.com/tabs/#option-show](http://api.jqueryui.com/tabs/#option-show)

```
$( ".selector" ).tabs({ show: { effect: "blind", duration: 800 } }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T00:43:18.223

试试这个：[http](http://www.eduteka.org/ajax/tabs3/) ://www.eduteka.org/ajax/tabs3/ 更多选项

# c# - 将值插入数据表

> ID：910644
> 
> 赞同：1
> 
> 时间：2009-05-26T13:21:26.843
> 
> 标签：c#, datatable

我有一个用数据库中的值填充的 DataTable。我有另一个正在创建的数据表，它与第一个数据表具有相同的列名，加上一些额外的数据，这些数据是我创建 CSV 所需的。我想做的是从第一个表中获取数据并使用它来填充第二个表，然后我可以填写其他数据。

我知道我可以通过循环、创建新行然后为第一个表中的单元格填充单元格来以非常机械的方式做到这一点。

我希望有人知道一些更圆滑的东西。

吉姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T13:23:59.757

我认为这就是您正在寻找的[DataTable.Merge](http://msdn.microsoft.com/en-us/library/system.data.datatable.merge.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T13:24:06.387

您可以在数据表上使用[Merge](http://msdn.microsoft.com/en-us/library/fk68ew7b.aspx)方法。您唯一需要注意的是两个 DataTables 都需要有一个主键。来自数据库的那个可能已经有了，但是你在内存中填充的那个很可能没有。

您可以像这样轻松设置主键：

```
table.PrimaryKey = new DataColumn[] { table.Columns[0]}; //or whatever column you want. 
```

# ajax - 使用 jquery 将项目添加到 jQuery Accordion

> ID：910645
> 
> 赞同：46
> 
> 时间：2009-05-26T13:21:31.087
> 
> 标签：ajax, jquery-ui, jquery-ui-accordion

我正在使用 jQuery 手风琴插件来制作一些数据的手风琴。然后我希望用户能够向手风琴添加更多数据。我已经设置了手风琴以使其正常工作，然后我制作了一个函数，该函数将“列表项”添加到与手风琴语义匹配的手风琴前面。

是否可以“更新”手风琴使其与新添加的元素一起使用，而无需将新数据保存到数据库并刷新页面？

像这样的东西：

```
.accordion('refresh') 
```

或者像 jQuery 1.3 中添加的现场事件，有人知道吗？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-05-26T13:33:59.160

我还没有测试过，但这应该可以工作：假设你有你的手风琴，id 为#accordion

```
$('#accordion').append('<h3><a href="#">New Paragraph</a></h3><div><p>New data</p></div>')
    .accordion('destroy').accordion(); 
```

基本上，只需破坏并重新创建手风琴即可。

**更新：**

由于编写了此答案，因此已将 refresh() 方法添加到手风琴小部件中。它可以通过调用来调用：

```
$( ".selector" ).accordion( "refresh" ); 
```

[您可以在此处](http://api.jqueryui.com/accordion/#method-refresh)阅读有关此方法的更多信息

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-24T11:29:18.607

要添加新部分并保持旧部分处于活动状态：

```
var active = $('#accordion').accordion('option', 'active');
$('#accordion').append('<h3><a href="#">New Paragraph</a></h3><div><p>New data</p></div>')
    .accordion('destroy').accordion({ active: active}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-19T17:38:30.663

正如 Shahzad 上面提到的，jQuery UI 1.10 让这变得更容易了。请参阅[文档](http://jqueryui.com/upgrade-guide/1.10/#added-ability-to-add-remove-panels)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T13:33:15.447

您可能想查看 LiveQuery 插件：[http ://plugins.jquery.com/project/livequery](http://plugins.jquery.com/project/livequery)

它允许您在加载 DOM 后添加事件和绑定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T14:24:51.827

由于我需要一个有效的添加/编辑/删除 vor 手风琴项目，我为此目的破解了这个小 javascript 函数

[http://jsfiddle.net/Sd6fC/](http://jsfiddle.net/Sd6fC/)

h3 和 div 需要一个唯一的 id，它遵循以下约定

```
<h3 id="divname_hitm_<uniquenumber>"><h3> 
```

对应的div需要以下

```
<div id="divname_ditm_<samenumber as h3"></div> 
```

示例手风琴代码块

```
<div id="divname">
    <h3 id="divname_hitm_1><a href="#">Section 1</h3>
    <div id="divname_ditm_1>
        <p>Section 1 Payload</p>
    </div>
    <h3 id="divname_hitm_2><a href="#">Section 2</h3>
    <div id="divname_ditm_2>
        <p>Section 2 Payload</p>
    </div>
</div> 
```

玩得开心，也许它可以帮助一些人！

# assembly - ORG 指令在汇编代码中的作用是什么？

> ID：910647
> 
> 赞同：2
> 
> 时间：2009-05-26T13:21:51.617
> 
> 标签：assembly, motorola, 68000

作为参考，代码适用于摩托罗拉 68008。

假设我有如下代码：

```
org 200
sequenceO: ds.b 5
sequenceN: ds.b 5

move.w #sequenceO, A0
move.w #sequenceN, A1 
```

1.  我认为 A0 将保持值 200 而 A1 将保持值 205 是否正确？

2.  过去一篇论文中的一个考试题是：“sequence0 和 sequenceN 的物理地址是什么？”，答案是“200 和 205”，还是“200-204 和 205-209”？

3.  我见过一些带有多个组织指令的代码，例如；

    组织 100

    数组1：ds.b 4

    组织 300

我认为遵循最后一个 org 指令是否正确，例如在这种情况下，array1 指向 300？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T13:24:30.067

我假设“ORG”的意思是“原点”——分配给正在发出的代码或数据段的第一个地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T13:32:07.573

1.  是的，听起来不错。的地址`sequenceN`超出 5 个字节`sequence0`。
2.  “这取决于”，我猜......因为它是复数形式的“地址”，我猜他们想要整个范围，在这种情况下，你的后一个答案是正确的。
3.  不，我希望多个`org`s 只适用于它们后面的代码，所以在这种情况下，`array1`它将是 100 美元。由于后者之后没有代码或数据生成`org`，因此汇编器基本上忽略了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T13:34:52.200

1.  是的，200 和 205

2.  Sequence0 从 200 开始，延伸 5 个字节到 204

3.  不，array1 从 100 开始，org 300 之后的任何内容都将从 300 开始

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-26T01:00:55.777

您正在使用：`MOVE.W #sequenceO, A0`

因此，您仅将地址的低位字（16 位）加载到`A0`. 这只适用于非常低的内存（`A0`下`$00010000`）

一般来说`MOVE.W`，在地址寄存器上使用 a 会很棘手。

尝试：（ `LEA #sequence0, A0` 加载一个 32 位地址到`A0`）

大多数汇编程序也会这样做：

```
MOVEA.L #sequence0, A0 
```

谢谢，小戴夫

# javascript - Javascript未定义变量

> ID：910649
> 
> 赞同：2
> 
> 时间：2009-05-26T13:22:11.087
> 
> 标签：javascript, jquery, undefined

我遇到了一个 javascript 错误问题：`$("#slider") is undefined`

我怎么解决这个问题？

```
<script type="text/javascript">
$(document).ready(function() {
    $("#slider").easySlider({
        controlsBefore: '<p id="controls">',
        controlsAfter: '</p>',
        prevId: 'prevBtn',
        nextId: 'nextBtn'
    });
});
</script> 
```

这是我的html

```
<div id='slider'>
    <table>
        <tr>
            <td width='325'>hello</td>
            <td width='325'>hello</td>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T08:00:16.683

```
jQuery(document).ready(function() {
    jQuery("#slider").easySlider({
        controlsBefore: '<p id="controls">',
        controlsAfter: '</p>',
        prevId: 'prevBtn',
        nextId: 'nextBtn'
    });
}); 
```

可能你有超过 1 个 jQuery 脚本试试这个脚本如果它工作你必须改变脚本使用的顺序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:32:02.813

我怀疑你粘贴在这里的代码有问题——即使你写了这样的东西：

```
$('bladkhadlhadkjha').easySlider({ ... }); 
```

您不会收到“未定义”错误，因为 jQuery 会优雅地处理它。确保正确包含 jQuery，正确包含您的插件，并且您粘贴的代码正是您遇到问题的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:11:17.773

尝试：

```
$(document).ready(function(){
    alert("jquery is working");
}); 
```

如果这不会弹出警报，则您的问题出在 jquery 的链接中。我希望它有帮助；）

# asp.net - 什么是最好的用途：缓存对象或静态变量

> ID：910653
> 
> 赞同：0
> 
> 时间：2009-05-26T13:23:20.960
> 
> 标签：asp.net, caching, object

我需要在我的网站中存储大量数据，但我不确定什么是最好的：

**缓存对象**

或者

**将数据存储在母版页**的静态变量中？****

 **请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:25:24.323

使用缓存的好处是，您不会将不再使用的对象保留在内存中（例如，通过使用滑动/绝对过期）。

此外，当可用内存变低时，ASP.NET 可以从缓存中删除对象（从而提供更多可用内存）。

如果您确定要一直使用一些数据，那么另一种选择（静态变量）将是使用[Application 对象](http://msdn.microsoft.com/en-us/library/system.web.httpapplicationstate%28VS.80%29.aspx)。这与 Session 对象的方式相同，但它的数据是全局的（对于所有会话）：

```
Application["myData"] = someData; 
```

# c# - 用一种方法对几个不同的结果进行单元测试

> ID：910654
> 
> 赞同：1
> 
> 时间：2009-05-26T13:23:22.380
> 
> 标签：c#, unit-testing, nunit

我正在使用 NUnit 2.5，我想测试一个接收多个参数的方法。
尝试使用一种测试方法和几个不同的测试用例来测试它们是否合理，或者从长远来看会更难维护（或者只是指出确切的故障）？

我的总体想法是尝试类似

```
[TestCase("valid", Result="validasd", 
  Description = "Valid string test, expecting valid answer")]
[TestCase(null, ExpectedException = typeof(ArgumentNullException),
  Description = "Calling with null, expecting exception")]
[TestCase("", ExpectedException = typeof(ArgumentException), 
  Description = "Calling with an empty string, expecting exception")]
public string TestSubString(string value)
{
  return MethodUnderTest(value);
} 
```

这也是推荐的用法吗 - 没有明确的断言，只检查返回值？或者我应该坚持正常的方式还是在方法内断言值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T13:51:39.263

我发现 TestCase 属性在测试主要接受一些简单值、用它们计算然后返回结果的方法时很有用。在这些情况下，编写此类测试所需的开销和重复次数要少得多。

当方法需要复杂的对象参数时，这种方法不起作用，因为 TestCase 属性只能接受原始类型作为输入参数传递给方法。

如果出现以下情况，您可能还需要考虑编写更典型的单元测试：

1.  您团队中的其他开发人员不熟悉此技术
2.  可能会更改或容纳更多参数的方法的签名
3.  如果有多个测试用例或要测试的值组合
4.  您需要以特定顺序执行测试
5.  您想使用[ReSharper](http://www.jetbrains.com/resharper/index.html) for Visual Studio 运行测试（它目前无法识别 TestCase 属性）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:27:03.417

我会避免这种情况。这将是非常难以维护的。对于每种情况，我都会有一种测试方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:44:00.340

我认为陪审团仍然在这种参数测试上——铁杆 TDDers 可能会说它违反了“每个测试一个断言”的原则，他们可能是对的。单元测试中最重要的一点是，当测试失败时，您可以快速准确地确定失败的原因、导致失败的输入，并通过重新运行相同的测试来重现它。虽然前两个对于这种测试结构可能不是问题，但第三个可能是（尽管使用足够智能的工具您可能能够解决这个问题）。

就个人而言，我会说至少你应该将测试用例分成结果集，即如果两组参数具有相同的预期结果（例如 ArgumentException），则可以将它们放在同一个测试方法上。但是在您的示例中，所有三个参数都有不同的预期结果，因此您应该将它们放在不同的测试方法上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T13:49:51.997

对我来说，最好的方法通常是让你编写更少代码的方法。我认为属性方式更好，因为：

*   测试运行器会将这些方法分组在同一个树节点下
*   从视觉上看，很明显这 3 个测试用例适用于相同的代码，只有方法参数在变化，如果测试失败，错误消息仍然会告诉您哪些参数导致它失败
*   更少的代码！

缺点是参数和返回值是硬编码的，因此您无法针对动态或随机生成的参数进行测试，这在某些情况下很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T13:57:20.330

写这样的东西不是更好吗？

```
[Test]
public string TestSubString()
{
    Assert.AreEqual("validasd", MethodUnderTest("valid"));
    AssertEx.Throws<ArgumentNullException>(() => { MethodUnderTest(null); });
    AssertEx.Throws<ArgumentException>(() => { MethodUnderTest(""); });
} 
```

# .net - .NET 拆分器控件显示

> ID：910655
> 
> 赞同：4
> 
> 时间：2009-05-26T13:23:28.493
> 
> 标签：.net, vb.net, winforms, splitter

我在 VB.NET 中创建了一个 Winform，并添加了一个拆分器控件以允许在运行时调整面板的大小。

我的问题是拆分器控件不明显。我想让它以一种用户知道表单可以调整大小的方式出现。目前，我基本上只是改变了颜色，但我不喜欢它的外观。

谁能告诉我使用此控件的正确方法，以便用户立即了解面板可调整大小？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T13:30:14.207

我正要建议边界技巧（您自己发布的）。我通常做的另一件事是为 Splitter 控件连接 MouseEnter 和 MouseLeave 事件的事件处理程序，并在其中添加以下代码：

```
private void Splitter_MouseEnter(object sender, EventArgs e)
{
    ((Splitter)sender).BackColor = SystemColors.ControlDark;
}

private void Splitter_MouseLeave(object sender, EventArgs e)
{
    ((Splitter)sender).BackColor = SystemColors.Control;
} 
```

这样，当鼠标经过时，Splitter 会“亮起”（或者更确切地说，阴影会下降......），从而引起人们注意那里有一个可以与之交互的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:27:43.337

好的，

我想如果我将面板设置为有边框，看起来面板可以调整大小。

我没有设置边框，因此分离器不可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:36:19.933

您可以将 SplitterWidth 属性设置为更大的值以使其更明显。

当鼠标悬停在拆分器控件上时，您还可以更改鼠标光标。类似的想法是在鼠标悬停在控件上时显示工具提示文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-03T23:32:12.210

我喜欢派生控制，这样我就可以使所有的分离器工作相同。添加该属性使其与 IDE 一起工作得更好一些，因此编码人员可以在设计时更改它。

```
Public Class HighlightSplitContainer
    Inherits SplitContainer

    Property HighlightColor As Color = SystemColors.ControlDark

    Protected Overrides Sub OnMouseEnter(e As System.EventArgs)
        BackColor = HighlightColor
        MyBase.OnMouseEnter(e)
    End Sub

    Protected Overrides Sub OnMouseLeave(e As System.EventArgs)
        BackColor = SystemColors.Control
        MyBase.OnMouseLeave(e)
    End Sub
End Class 
```

# django - 需要一个关于那个错误的提示

> ID：910667
> 
> 赞同：0
> 
> 时间：2009-05-26T13:24:59.850
> 
> 标签：django, django-templates

从某种意义上说，我遇到了一个相当奇怪的问题，我无法理解它可能是什么。我的网站使用 django-registration 并且一切正常，但是如果我重新启动 django dev。服务器在会话中间（即已登录）我立即得到错误：

**渲染时遇到异常： 'django.contrib.auth.decorators._CheckLogin object at 0x235aa50' 与参数 '()' 和关键字参数 '{}' 未找到。**

再一次：如果我不重新启动开发，一切正常。服务器。当且仅当我重新启动 djange dev 时才会发生此错误。服务器已登录到我的网站。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T14:33:09.103

不幸的是，Django 中的 URL 反向功能非常脆弱。它通过导入所有视图并查看哪些视图匹配来工作。如果由于某种原因它不能导入视图——*任何*附加到 URLconf 的视图——那么整个反向匹配就会失败。

因此，有时您的视图中存在一些依赖关系，这意味着它们无法在您重新启动服务器后直接导入。这会导致所有 URL 反向匹配失败，即使是与问题视图无关的那些。但是如果你刷新页面，你经常会发现错误消失了。

该错误可能根本不在 django-registration 中，而是在您自己的观点中非常模糊的地方。我会尝试注释掉所有其他 url，然后一一重新启用它们 - 每次重新启动开发服务器 - 查看错误何时出现。

# apache-flex - 如何扩展 LinkBut ton 以允许 Flex 中的 HTML 文本？

> ID：910675
> 
> 赞同：0
> 
> 时间：2009-05-26T13:27:13.307
> 
> 标签：apache-flex, linkbutton

我直接从我从谷歌 API 收到的字符串中将标签提供给我的 LinkBut​​ton，该 API 将 html 用于格式化标签。

我想扩展链接按钮以允许这样做。我自己写了一个类来允许标签的 html 文本，它的这方面工作，但现在当你悬停时出现的背景太大了。我试图覆盖 measure() 来解决这个问题，但我不知道如何。这是我写的课程：

```
package com.kranichs.components
{
    import mx.controls.LinkButton;

    public class HTMLLinkButton extends LinkButton
    {
        protected var _isHTML:Boolean;

        public function HTMLLinkButton()
        {
            super();
        }

        [Bindable]
        public function set isHTML(value:Boolean):void
        {
            _isHTML = value;
        }
        public function get isHTML():Boolean
        {
            return _isHTML;
        }

        override protected function updateDisplayList(unscaledWidth:Number,
                                                  unscaledHeight:Number):void
        {
            super.updateDisplayList(unscaledWidth, unscaledHeight);
            if(_isHTML)
            {
                textField.htmlText = label;
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T18:29:53.727

measure() 函数是关键。

假设您使用的是 flex 兼容版本 >= 3.0，关键行在 Button.measure() 中：

```
var lineMetrics:TextLineMetrics = measureText(label); 
```

您需要将其更改为：

```
var lineMetrics:TextLineMetrics = _isHTML ? measureHTMLText(label) : measureText(label); 
```

您可能需要将测量功能从按钮复制​​到您的类中并进行此更改。

如果这样做，您很可能需要导入内部命名空间，如下所示：

```
import mx.core.mx_internal;

use namespace mx_internal; 
```

# javascript - 你如何在原型的 $() 实用方法中传递一个变量的值？

> ID：910680
> 
> 赞同：0
> 
> 时间：2009-05-26T13:27:57.363
> 
> 标签：javascript, methods, prototypejs, utility

```
function insertChildDiv(parentId)
{
  var ChildComment = new Element('div', {'class':'padding'});
  ChildComment.update('testing');
  $().insert(ChildComment);
} 
```

我想要该行中 $() 内的 parentId 的值

```
$().insert(ChildComment); 
```

我已经试过了

```
$('parentId').insert(ChildComment); 
```

但它将 parentId 评估为字符串，并正在寻找元素 id 为“parentId”的 div，因此错误将是 $("parentId") is null

也试过

```
$(parentId).insert(ChildComment); 
```

但它返回错误**“$(parentId).insert 不是函数”**

顺便说一句，这个 html 调用了脚本

```
<a href="#" onclick="insertChildDiv(123456)" id="123456more">Replies and more</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T13:32:21.970

$() 接受字符串或 DOM 元素作为参数

编辑以反映原始 Q 中的编辑。

只要 id 有效，$(parentId) 就可以工作。

传递给函数的 id 是“123456”，而您要查找的 id 是“123456more”。此外，您传递的是整数 (123456) 而不是字符串。无论如何，由于它们不匹配，因此原型找不到它。此外，id 不应以数字开头：IE8 将失败，因为 w3c 规范说 id 属性不能以数字开头（如果我没记错的话）

尝试将html更改为

```
<a href="#" onclick="insertChildDiv('more123456')" id="more123456">Replies and more</a> 
```

它应该可以工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:41:01.160

**这**是救援。“this”指的是元素本身，因此将元素引用传递给您的函数，而不是字符串。

```
<div onclick="insertChildDiv(this)">###</a>

<script type='text/javascript'>
function insertChildDiv(element) {
    $(element).insert(new Element('div',{'class':'padding'}).update('testing'))
}

// or if you want to add an ID:

function insertChildDiv(element) {
    $(element).insert(new Element('div',{'class':'padding',id:'more'+element.id}).update('testing'))
}

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:30:33.473

您通常会使用 $(parentId).insert(...) 。

`$(parentId + 'more').insert(...)`在您的特定情况下不起作用？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T13:58:29.140

parentId 的值是它所在的 div 的 id `<a href="#" onclick="insertChildDiv('more123456')" id="more123456">Replies and more</a>`。我在函数 insertChildDiv() 中传递了这个 parentId 的值，以便插入的子 div 将嵌套在这个父 div 中。a 标签的 id 也`id="more123456"`将用于将 href 值更改为隐藏插入的子 div 的值

谢谢，我将重命名元素的 id 以使第一个字符变成字母。

如果我删除将 parentId 包装在 $() ex 中的单个 qoutes。`$(parentId).insert(ChildComment);`返回的错误是：

```
$(parentId).insert is not a function 
```

如果我将 parentId 用单引号括起来，原型将找不到 id 为“parentId”的 div 错误将是`$("parentId") is null`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T18:36:52.980

您的原始函数与传递给 $() 的参数一起工作......

```
function insertChildDiv(parentId)
{
  var ChildComment = new Element('div', {'class':'padding'});
  ChildComment.update('testing');
  $(parentId).insert(ChildComment);
} 
```

这是一个测试用例：

[将变量传递给 $()](http://ryanflorence.com/sandbox/prototype/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T05:22:51.443

哇非常感谢大家！现在它可以工作了。为了其他可能遇到同样情况的人的利益，我认为这是发生的事情：不要只使用数字作为元素的 ID（即使“id”这个词表明它应该是一个数字。）如果你真的需要，是的该 id 上的一个数字，甚至可以在 id ex 的开头连接一个字母。我现在使用的 id 是 id="parent123456"

# url - 为什么只是 URL 路径中的 ID 对 SEO 来说是个坏主意？

> ID：910683
> 
> 赞同：12
> 
> 时间：2009-05-26T13:29:00.917
> 
> 标签：url, seo

就 SEO 而言，为什么在 URL 中有一个 ID 是个坏主意？这个 URL 如何 `http://example.com/user/1234`伤害 SEO？

有人可以给我一个搜索引擎排名更差的实际例子吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-26T14:47:45.220

人们说 URL 中的 {ID} 不好的原因是搜索引擎算法的工作方式。当搜索词位于实际 URL 中时，它的权重远大于页面内容等。

* * *

例如：

```
<!-- http://example.com/blog/57 -->
<html><head><title>An article on search engine optimization</title>... 
```

对比

```
<!-- http://example.com/blog/an-article-on-search-engine-optimization -->
<html><head><title>An article on search engine optimization</title>... 
```

如果您在 Google 中搜索“搜索引擎优化”第二页，则 url 中带有 slug 的那一页将比仅带有 id 的那一页的权重更好。

* * *

您可以使用与堆栈溢出处理此问题相同的方式来处理此问题：

```
http://stackoverflow.com/questions/{id}/{slug}
http://stackoverflow.com/questions/910683/why-is-id-in-the-url-a-bad-idea 
```

id 和 slug 的组合格式确实可以帮助您实现两全其美。您可以通过 {id} 检索记录来简化编程，但由于 {slug}，您还保留了优化的搜索 URL。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-26T13:40:43.157

它确实对点击率有影响。

该网址在搜索结果下方以绿色显示 - 因此，如果它包含相关字词，用户可能会点击您的网站而不是其他网站。

您更愿意点击哪个：

www.test.com/page.php?u=85583

或者

www.test.com/Solution-to-your-problem.php

正如所评论的那样，即使使用包含 id 的 url 也可以实现这种效果。

在过去，搜索引擎非常尊重 url 中的单词，并给予这些页面额外的信用和更高的排名。这种影响几乎消失了。我们还剩下两个可读 url 的效果：

*   通过点击
*   链接建设：人类更容易复制这样的网址，并且在复制链接后，通常会用一些 slug 词来引用它。当人们链接到您的页面时，带有“解决您的问题”的网址也可能在 a 标签内解决您的问题。这会影响你的排名。

带有 id + slug 的解决方案可能是最好的解决方案，它解决了跟踪 slug 更改的问题。test.com/85583/solution-to-your-problem

但是有一些规则要遵循，如果 slug 不正确，您应该进行 301 重定向，以防止出现大量重复的内容页面。如果您有很多类似的页面，则会启动垃圾邮件/重复内容检测：

test.com/85583/solution-to-your-problem test.com/85583/solution-to-yar-problem test.com/85583/evil-competitor-spamming-you-haha

包含 id 还要求您的 id 尽可能短，带有完整 guid 的 url 可能会使眼睛混淆并阻止良好的点击：

test.com/0CD03822-4A35-11DE-BF38-3F9356D89593/solution-to-yar-problem

请记住，Google 新闻甚至要求您在 url 中包含一个 id。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T13:34:58.113

看到这个[SEO 友好的 URL 真的会影响页面的排名吗？](https://stackoverflow.com/questions/505793/do-seo-friendly-urls-really-affect-a-pages-ranking)问题。根据答案，没有人能找到任何证据证明 URL 中的 ID 对 SEO 有任何影响。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-26T13:40:21.503

好吧，我的名字是 Sudhir Jonathan，所以如果我想让人们在你的网站上找到我，`example.com/user/sudhir-jonathan`比`example.com/user/1234`. 仅仅因为您的页面对象 - “Sudhir Jonathan” - 现在出现在 url 本身中。这是一个很大的胜利。

同样，`example.com/articles/how-to-bake-a-cake`排名远高于`example.com/articles/2379797`搜索词“烤蛋糕”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T02:59:40.703

很简单，搜索引擎关心单词而不是数字。也就是说，最好在 url 中看到关键字，而不是仅仅 ID sine ID/number 对搜索引擎确定您的网站是否相关是没有用的！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T13:38:33.753

提供不寻常的信息总是一个坏主意。请尝试使用用户名！

对于 SEO，静态 ID url 和用户名 url 之间没有真正的优势/劣势。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-04T11:32:48.030

1) 你错过了 url 中的关键字 2) 人类更难阅读和理解链接的内容 3) 使用 ID 更容易进行 sql 注入

# paypal-subscriptions - 如何将我的自动回复与 Paypal 联网以进行定期订阅付款？

> ID：910687
> 
> 赞同：0
> 
> 时间：2009-05-26T13:29:37.703
> 
> 标签：paypal-subscriptions

我想创建一个固定期限的会员网站（12 个月），每月通过自动回复器向付费会员提供信息。我想使用 Paypal 作为支付网关。有谁知道我如何在收到付款后触发第一个月的内容交付并在他们取消时取消交付？

我知道如何设置自动回复，也知道如何在 Paypal 中设置订阅。我只是不确定如何让两者进行交流。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T13:33:17.430

您将希望 PayPal 调用的 URL 放入您的 PayPal 个人资料中，每次发生付款或取消订阅等事情时，PayPal 系统都会向您的 URL 发送 HTTP 请求。

您的工作是解析请求中发送的信息并采取相应措施。他们发送大量信息，包括订阅 ID、付款金额等。

# c - C：动态大小结构的推荐样式

> ID：910688
> 
> 赞同：9
> 
> 时间：2009-05-26T13:29:48.233
> 
> 标签：c, data-structures, struct

我需要通过互联网传输数据包，其长度应该是动态的。

```
struct packet
{
  int id;
  int filename_len;
  char filename[];
}; 
```

问题是零长度数组不符合 ISO 标准。

我应该`char filename[1];`改用吗？但随后`sizeof(struct packet)`将不再返回正确的值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T13:35:11.233

我认为您应该在此处查看一些现有的动态大小结构示例以获得指导。我所知道的最好的例子是 Win32 中的 TOKEN API。他们使用宏 ANYSIZE_ARRAY，它只解析为 1。Raymond Chen 做了一篇详尽的博客文章，详细说明了他们这样做的原因

*   [https://devblogs.microsoft.com/oldnewthing/20040826-00/?p=38043](https://devblogs.microsoft.com/oldnewthing/20040826-00/?p=38043)

至于sizeof等操作失败。无论您为动态大小的结构选择什么解决方案，这都会失败。sizeof 是编译时操作，您将在运行时重新调整结构的大小。它根本行不通。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T14:00:59.213

经典问题。您可以简单地处理它（请注意，如果编译器将结构大小向上舍入，则 sizeof(foo) 可能会超过一个，这是（我相信）允许的），或者您可以执行以下操作：

```
struct packetheader {
   int id;
   int filename_len;
};
struct packet {
   struct packetheader h;
   char filename[1];
}; 
```

这很烦人（你必须使用 h.id 等），但它确实有效。通常我只是把它当作一个来处理，但上面的可能更便携。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T13:41:41.763

我建议使用`char filename[1]`并包含一个终止的 0 字节。这样，您可以`malloc()`正确的结构大小并避免像这样的一次性错误：

```
ptr = malloc(sizeof(struct packet)+filename_len);
strncpy(&ptr->filename, filename, filename_len); 
```

但是接收者必须知道它需要读取`filename_len+1`字节。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T15:37:07.540

事实上[，零长度数组](http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html)不是标准的一部分。但是您在代码片段中拥有的是一个灵活的数组，它是 ISO C99 标准的一部分。如果您可以使用 C99，我会使用灵活的数组，如果不是，jesup 的建议可能是最好的。

# asp.net - 目标和渠道

> ID：910691
> 
> 赞同：0
> 
> 时间：2009-05-26T13:30:19.917
> 
> 标签：asp.net, google-analytics

我的网站中只有页面（default.aspx），我想在 Google 分析的目标和渠道中配置该页面。任何人都可以帮助我，我必须做些什么来配置以实现目标？

问候， 萨加尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T17:15:50.273

您可以拥有一个包含多个步骤的动态页面。使用 GA 记录每个步骤的关键是调用 urchinTracker 方法并传递您希望记录该命中的 URL。

一旦您控制了每个步骤的命中 GA 记录，您就可以将最终页面添加为目标，并将中间页面添加到渠道中。

我们有一个从单个 ASPX 页面提供的 3 步注册过程（`/registration/register.aspx)`。我在页面上输出以下 GA 代码，每次递增步骤编号；

```
<script type="text/javascript">
    _uacct = "UA-1234567-1";
    urchinTracker('/registration/Step1.html');
</script> 
```

在我们的最后一页上，我重定向到我的 acknowledgement.aspx 页面并正常调用 GA

```
<script type="text/javascript">
    _uacct = "UA-1234567-1";
    urchinTracker();
</script> 
```

然后是目标漏斗；

```
/register/acknowledgement.aspx

/registration/Step1.html
/registration/Step2.html
/registration/Step3.html 
```

也许谷歌解释得更好；[https://www.google.com/support/googleanalytics/bin/answer.py?answer=55514&hl=en_US&utm_id=ad](https://www.google.com/support/googleanalytics/bin/answer.py?answer=55514&hl=en_US&utm_id=ad)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:37:17.990

你需要两页——我就是这样做的，因为它很容易。谷歌分析将成功记录为访问特定页面。人们访问您的目标网页的次数会影响您的点击率。人们点击并至少再点击一次转化页面的次数会影响您的转化率。

如果你真的需要单页解决方案，你可以添加一个按钮和回发事件，比如

```
protected MyButtonClick(...)
{
   Page.Controls.Add(new literal("...google's conversion widget code...")
} 
```

但从谷歌的角度来看，URL 仍然是相同的。下一步将尝试使用 HTTP 处理程序进行 URL 重写，以模拟多个页面，其中只有一个 aspx 页面。

# python - 确定是否继承了 ntfs 权限的可靠方法

> ID：910696
> 
> 赞同：5
> 
> 时间：2009-05-26T13:31:29.570
> 
> 标签：python, winapi, acl, ntfs, file-permissions

我在这里有一个有点模糊的问题。

我需要什么：确定文件/文件夹的权限（或者，严格来说，DACL 的特定 ACE）是否被继承。

我如何尝试解决这个问题：使用 python 的 winapi 绑定（准确地说是 win32security 模块）。这是精简版，它就是这样做的——它只是将文件的路径作为参数，并一一打印出 ACE，指示设置了哪些标志。

```
#!/usr/bin/env python
from win32security import *
import sys

def decode_flags(flags):
    _flags = {
        SE_DACL_PROTECTED:"SE_DACL_PROTECTED",
        SE_DACL_AUTO_INHERITED:"SE_DACL_AUTO_INHERITED",
        OBJECT_INHERIT_ACE:"OBJECT_INHERIT_ACE",
        CONTAINER_INHERIT_ACE:"CONTAINER_INHERIT_ACE",
        INHERIT_ONLY_ACE:"INHERIT_ONLY_ACE",
        NO_INHERITANCE:"NO_INHERITANCE",
        NO_PROPAGATE_INHERIT_ACE:"NO_PROPAGATE_INHERIT_ACE",
        INHERITED_ACE:"INHERITED_ACE"
    }
    for key in _flags.keys():
        if (flags & key):
            print '\t','\t',_flags[key],"is set!"

def main(argv):
    target = argv[0]
    print target

    security_descriptor = GetFileSecurity(target,DACL_SECURITY_INFORMATION)

    dacl = security_descriptor.GetSecurityDescriptorDacl()

    for ace_index in range(dacl.GetAceCount()):
        (ace_type,ace_flags),access_mask,sid = dacl.GetAce(ace_index)
        name,domain,account_type = LookupAccountSid(None,sid)
        print '\t',domain+'\\'+name,hex(ace_flags)
        decode_flags(ace_flags)

if __name__ == '__main__':
    main(sys.argv[1:]) 
```

很简单——获取一个安全描述符，从中获取一个 DACL，然后遍历 DACL 中的 ACE。这里真正重要的一点是 INHERITED_ACE 访问标志。它应该在 ACE 被继承而不是显式设置时设置。

当您创建文件夹/文件时，其 ACL 会根据父对象（文件夹）的 ACE 填充 ACE，这些 ACE 设置为传播给子对象。但是，除非您对访问列表进行任何更改，否则不会设置 INHERITED_ACE 标志！但是继承的权限在那里并且它们确实有效。

如果您进行任何细微的更改（例如，在访问列表中添加一个条目，应用更改并删除它），标志就会神奇地出现（该行为不会以任何方式改变，但它之前有效，之后有效）！我想要的是找到 INHERITED_ACE 标志的这种行为的来源，并且可能找到另一种*可靠*的方法来确定 ACE 是否被继承。

如何重现：

1.  创建对象（文件或文件夹）
2.  检查 Windows 资源管理器中的权限，查看它们是否已从父对象传播（例如，使用 Windows 资源管理器的文件属性对话框的安全选项卡）。
3.  例如，使用我正在使用的脚本检查标志（不会在任何 ACE 上设置 INHERITED_ACE）。
4.  更改对象的权限（应用更改），甚至将它们更改回来。
5.  检查标志（INHERITED_ACE*将*在那里）
6.  ..难以置信地摇头（我知道我做到了）

抱歉，这篇文章有点冗长，希望这至少有点意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-24T02:32:39.537

您可以使用 .Net 框架

```
System.Security.AccessControl 
```

这包括 ACL 和 DACL 和 SACL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-06T12:50:53.143

我认为原始海报正在看到详细的行为

[此新闻组发布](http://groups.google.co.uk/group/microsoft.public.platformsdk.security/browse_thread/thread/5204736623c71a84/)

请注意，在容器上设置的控制标志可以通过取消勾选和重新勾选 GUI 中的继承框来更改。

进一步注意，使用 Microsoft 的工具简单地将 ACE 添加到 DACL 也会更改控制标志。

进一步注意，由于新闻组发布中讨论的许多细微错误，在继承方面不能依赖 GUI、cacls 和 icacls。

似乎控制继承的“旧”方法是结合使用容器上的控制标志与继承相关的 ACE 标志。

“新”方式不使用容器上的控制标志，而是使用重复的 ACE；一个控制对对象的访问，另一个控制子对象继承的内容。

但是，现有的 Microsoft 工具（例如 Vista）似乎还不能以“新”方式工作，因此当您使用工具进行简单更改时，它会求助于在容器上使用控制标志的旧方式。

如果你在 Vista 上创建一个新分区，然后创建一个新文件夹，然后查看标志和 ACE，它看起来像这样

```
ControlFlags : 0x8004
Owner : BUILTIN\Administrators
Group : WS1\None
S-1-5-32-544 : BUILTIN\Administrators : 0x0 : 0x0 : 0x1F01FF
S-1-5-32-544 : BUILTIN\Administrators : 0x0 : 0xB : 0x10000000
S-1-5-18 : NT AUTHORITY\SYSTEM : 0x0 : 0x0 : 0x1F01FF
S-1-5-18 : NT AUTHORITY\SYSTEM : 0x0 : 0xB : 0x10000000
S-1-5-11 : NT AUTHORITY\Authenticated Users : 0x0 : 0x0 : 0x1301BF
S-1-5-11 : NT AUTHORITY\Authenticated Users : 0x0 : 0xB : 0xE0010000
S-1-5-32-545 : BUILTIN\Users : 0x0 : 0x0 : 0x1200A9
S-1-5-32-545 : BUILTIN\Users : 0x0 : 0xB : 0xA0000000 
```

请注意 ControlFlags 和重复的 ACE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T20:58:07.857

在我的 Win XP Home Edition 上，此代码似乎根本不起作用 :-)

我得到这个堆栈跟踪：

> 回溯（最后一次调用）：
> 文件“C:\1.py”，第 37 行，在 main(sys.argv[1:])
> 文件“C:\1.py”，第 29 行，在 main 中用于 ace_index范围（dacl.GetAceCount（））：
> 
> AttributeError：“NoneType”对象没有属性“GetAceCount”

您可以尝试“轻推”要填充的 DACL 吗？我的意思是，如果您知道它会在您对其进行轻微更改后工作......以编程方式进行轻微更改，添加一个存根 ACE 并将其删除。你可以吗？

**更新。**我在我的工作机器（使用 Win XP Prof）上做了一个 C# 程序的实验，我必须告诉你，.net 获取此安全信息的方式确实有效。因此，当我创建一个新文件时，我的 C# 程序检测到 ACE 是继承的，而您的 python 代码没有。

这是我运行的示例输出：

> C:>csharp_tricks.exe 2.txt
> 
> FullControl --> IsInherited: True
> 
> FullControl --> IsInherited: True
> 
> ReadAndExecute，同步 --> IsInherited: True
> 
> * * *
> 
> C:>1.py 2.txt
> 
> 2.txt
> 
> 内置\管理员 0x0
> 
> NT AUTHORITY\SYSTEM 0x0
> 
> 内置\用户 0x0

我的 C# 类：

```
public class InheritedAce
{
    public static string GetDACLReport(string path)
    {
        StringBuilder result = new StringBuilder();
        FileSecurity fs = new FileSecurity(path, AccessControlSections.Access);
        foreach (var rule in fs.GetAccessRules(true, true, typeof(SecurityIdentifier)).OfType<FileSystemAccessRule>())
        {
            result.AppendFormat("{0}  -->  IsInherited:  {1}", rule.FileSystemRights, rule.IsInherited);
            result.AppendLine();
        }

        return result.ToString();
    }
} 
```

因此，这似乎是 python pywin32 安全库中的一个错误。也许他们没有做所有必要的系统调用......

# php - PHP 5 的 HTML 表单库

> ID：910708
> 
> 赞同：6
> 
> 时间：2009-05-26T13:34:34.603
> 
> 标签：php, html, forms

我正在寻找`QuickForm`替代品。QF 存在性能问题，例如组合框中的许多选项。我还想要一些更面向对象的东西，比如 Zend_Form，但没有装饰器和这么多的臃肿。当然它也应该用 警告`E_STRICT`。有什么建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T07:35:16.390

你可以试试`\Nette\Forms\Form`，它是[Nette Framework](http://nette.org)的一部分。

文档：[http ://doc.nette.org/en/forms](http://doc.nette.org/en/forms)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T15:03:57.730

[QuickForm](http://pear.php.net/package/html_quickform/redirected)的链接不会害死你……

无论如何，我一直在寻找一个系统来生成表单，然后将结果保存到数据库中。以下是我找到的一些系统。

*   [数据人](http://www.phpdevshed.com/forum/)
*   [phpMyEdit](http://www.phpmyedit.org/)
*   [PHP DataGrid](http://www.apphp.com/php-datagrid/index.php)两个版本，旧版本免费，新版本免费。
*   [达比克](http://www.dadabik.org/)

我发现的第一个系统可以做我想做的事情。但是，并没有完全按照我的意愿去做。没有进口。设置存储在数据库中。使用 Web 界面轻松更改设置。易于修改表。无法创建表。允许您从同一界面轻松查看多个表格。没有多选。（多选。）

然后我决定，到底是什么，我要自己写，我做到了。它还不能下载，但正在使用中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-29T22:06:40.543

因为你没有指定，我假设你没有使用[QuickForm2](http://pear.php.net/package/HTML_QuickForm2)，你看过这个版本的 QuickForm 吗？

[http://pear.php.net/package/HTML_QuickForm2](http://pear.php.net/package/HTML_QuickForm2)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-30T20:32:58.153

您可以尝试[Zebra_Form](http://stefangabos.ro/php-libraries/zebra-form/) - 当错误级别设置为 E_ALL 时不会产生错误消息，同时进行服务器端和客户端验证，具有针对跨站点脚本 (XSS) 攻击的保护，针对跨站点请求伪造 (CSRF) 攻击的保护，有[壮观的文档](http://stefangabos.ro/wp-content/docs/Zebra_Form/Zebra_Form/Zebra_Form.html)，而且很容易学习；

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-04T21:46:17.617

您可以查看以下免费的 PHP 表单脚本：

*   [phpAdd编辑](http://www.phpaddedit.com)
*   [Formitable - 表单创建类](http://formitable.sourceforge.net/)
*   [达达比克](http://www.dadabik.org/)
*   [FormHandler](http://www.formhandler.net/) [FormBuilder](http://FormBuilder)
*   [福尔姆](http://www.phorm.com/)
*   [信息化](http://www.peaceworks.ca/phormation.php)
*   [phpFormGenerator](http://phpformgen.sourceforge.net/)
*   [PHP 表单 - 处理器](http://www.richardwillars.com/articles/php/php-form-processor/)
*   [PHP HTML 表单 - 生成和验证类](http://stefangabos.blogspot.com/2006/12/zebra-php-framework-php-html-form.html)
*   [phpMyEdit](http://www.phpmyedit.org/)
*   [phpOpenFormGenerator](http://sourceforge.net/projects/phpopenformgen/)
*   [在HotScripts.com](http://www.hotscripts.com/category/php/scripts-programs/form-processors/)上查找更多信息

如果商业软件不会吓到您，请检查[PHPRunner](http://xlinesoft.com/phprunner/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-14T15:06:11.517

你也可以看看[phorms](http://www.artfulcode.net/phorms/)及其[较新的 fork](https://github.com/jordanlev/phorms)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T14:01:41.413

我从来没有使用过它，但我上次研究这个主题时确实偶然发现了这个：[http ://www.phpclasses.org/browse/package/1.html](http://www.phpclasses.org/browse/package/1.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-29T07:18:11.360

你应该试试[Aura.Input](https://github.com/auraphp/Aura.Input)。很容易集成和使用任何框架/遗留代码。

如果您有兴趣查看一些如何为 PHP 编写独立表单的代码，请查看[http://harikt.com/phpform/](http://harikt.com/phpform/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-03-09T22:27:54.847

我创建了 Minacl - [http://minacl.org](http://minacl.org) - 它与大多数表单库有点不同，您编写 HTML 并对其进行解析，因此任何地方都没有装饰器！更多地将其视为表单的 MVC。

# javascript - 在虚拟地球地图上附加和分离事件

> ID：910710
> 
> 赞同：0
> 
> 时间：2009-05-26T13:34:43.463
> 
> 标签：javascript, dom-events, virtual-earth

我不*认为*这特别古怪，但是为了控制我的 JavaScript 代码（如果*可以*真正控制 JavaScript ;-)）我一直在将所有客户端 JavaScript 包装在可爱的对象中。或者无论如何我都可以让它们变得可爱。

我遇到的第一个问题是将事件附加到这些对象中的任何内容。很快就会发现，**这**并不总是意味着您认为它的含义，因此我的代码必须如下所示：

```
var obj = this;
_map.AttachEvent("onclick", function(event){ obj.onClickMap(event); }); 
```

这样所有的事件都会调用当前对象。乔布斯是个好人。

但是，当从 Virtual Earth 地图对象中分离事件时，您需要传递您最初分配的函数，以便仅未分配该函数。这不起作用：

```
_map.DetachEvent("onclick", function(event){ obj.onClickMap(event); }); 
```

...并不是我真正期望的那样。但我不知道如何分离那个事件！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:39:03.690

很明显你可以存储函数：

```
var obj = this;
var func = function(event){ obj.onClickMap(event); }
_map.AttachEvent("onclick", func); 
```

然后分离：

```
_map.DetachEvent("onclick", func); 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:39:06.060

啊哈！突然的灵感让我想到了这个解决方案（这可能是也可能不是最好的方法，但它确实有效）。附加事件时，我使用它：

```
// Attach map events
var obj = this;
_currentOnClickMapHandler = function(event){ obj.onClickMap(event); };
_map.AttachEvent("onclick", _currentOnClickMapHandler); 
```

其中**_currentOnClickMapHandler**是类中的全局变量。

当我想分离事件时，我使用这个：

```
if (_currentOnClickMapHandler)
{
    _map.DetachEvent("onclick", _currentOnClickMapHandler);
} 
```

似乎有效，原因对我来说相当明显，所以我不太关心它作为解决方案。如果有人有更好的想法（或同意此解决方案，以便我对此感到更安全！），请告诉我。

# social - 为社交数据驱动的网站收集数据

> ID：910718
> 
> 赞同：4
> 
> 时间：2009-05-26T13:36:17.673
> 
> 标签：social

我希望这不是OT。

我有一个由用户提供内容的社交网站的想法。我看到两个问题：

1.  你打开网站，它只有很少的数据开始
2.  您吸引了一些用户，您如何鼓励他们添加内容？

我在想象类似 yelp.com 的东西，其中的实用程序真正来自用户评论/评论/评分。

只是大量的广告吗？数据挖掘？一开始就雇佣人来添加数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:19:23.063

**从私人测试版开始**。

了解目标受众并尝试解决他们。**封闭的私人测试版意味着参与者理解和接受的某些缺点**。这些缺点几乎就是您预见到的可能问题，例如：

*   内容少
*   多样性小
*   很少参与

私人测试版在参与者之间创造了一定的接受度。**让您的用户驱动平台缓慢发展。**

# input - Watin - Watin.Core.Exceptions.ElementNotFoundException

> ID：910720
> 
> 赞同：2
> 
> 时间：2009-05-26T13:36:30.667
> 
> 标签：input, watin

我的代码运行时出现错误：找不到包含属性名称的“输入（文本密码 textarea 隐藏）或 TEXTAREA”标签，其值为 ____________（它正在测试一个网站）

说找不到

找不到它的原因是什么？它在其他页面上发现其他人没有问题，但是这个页面出于某种奇怪的原因而犹豫不决？这个怎么可能？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-26T13:39:30.740

WatiN 代码库并没有那么复杂。下载它并在调试模式下运行它，看看抛出异常时它在哪里中断，然后您可以检查错误周围的上下文。

# javascript - 按下箭头键时是否可以防止文档滚动？

> ID：910724
> 
> 赞同：1
> 
> 时间：2009-05-26T13:38:05.517
> 
> 标签：javascript, html, browser, dom-events

非常简单：

**当用户按下箭头键时，是否可以防止浏览器滚动？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T13:45:11.650

是的。使用类似： document.getElementById('yourID').onkeypress = HandleKeyPress;

```
function HandleKeyPress(e) {
    var e = e || window.event;
    switch (e.keyCode) {

        case e.DOM_VK_LEFT:
        case e.DOM_VK_RIGHT:
        case e.DOM_VK_UP:
        case e.DOM_VK_DOWN:
            if (e.preventDefault)
                e.preventDefault();
            else e.returnValue = false;
    }
} 
```

尽管这样做可能不是一个好主意。请确保您没有忽略更好的方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T13:48:47.740

非常直截了当：是的，但不要这样做。

改变浏览器运行方式的基本操作只会让用户感到困惑或愤怒，并使整个体验变得不那么友好。用户应该最终控制他或她的浏览器的运行方式，而不是您。这类似于阻止访问菜单项或删除上下文菜单等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T15:43:25.310

似乎很多人都说不要破坏浏览器的功能。

我会这么说，除非你用类似或更好的功能替换它。

我经常在溢出的元素中终止键盘滚动，因为我已经向使用键盘“向下”和“向上”键选择项目的元素添加了一个键盘事件（想想 finder 或 Windows 资源管理器窗口）。

默认滚动使交互变得很奇怪。如果选择了最上面的项目，则按下“向下”键，它将选择下一个项目，然后向下滚动元素并隐藏刚刚选择的内容。

所以我打破了默认滚动，然后添加我自己的滚动到所选项目，如果它低于（或高于）当前滚动视图。这样，在通过文件上下键时，它的行为与任何操作系统完全相同。

只是说，随心所欲地破坏它，但要确保你知道为什么要破坏它并且用户不会注意到任何事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T13:46:30.100

在 jQuery 中你可以这样做：

```
$().keydown(function(e) { return e.keyCode != 38 && e.keyCode != 40; }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T13:44:39.420

可能，但打破每个人都知道和理解的约定通常不是一个好主意：D

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-13T04:07:27.923

监听 keydown 事件并防止默认行为。

在jQuery中

```
$(document).on('keydown.yournamespace', function(e) {e.preventDefault();}); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-26T13:46:28.260

在 JQuery 中

```
$("*").keypress(function(e){e.preventDefault(); return false;}); 
```

# jquery - 加载图像的 jQuery 事件

> ID：910727
> 
> 赞同：97
> 
> 时间：2009-05-26T13:38:24.080
> 
> 标签：jquery, dom

是否可以通过 jQuery 事件检测所有图像何时加载？

理想情况下，应该有一个

```
$(document).idle(function()
{
} 
```

或者

```
$(document).contentLoaded(function()
{
} 
```

但是我找不到这样的东西。

我想附加一个这样的事件：

```
$(document).ready(function()
{
    var imageTotal = $('img').length;
    var imageCount = 0;        
    $('img').load(function(){if(++imageCount == imageTotal) doStuff();});
} 
```

但是，如果图像无法加载，这会中断吗？在正确的时间调用该方法至关重要。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-03-06T18:38:59.170

根据 jQuery 的[文档](http://api.jquery.com/load-event/)，将加载事件与图像一起使用有许多注意事项。如另一个答案中所述， ahpi.imgload.js 插件已损坏，但不再维护链接的 Paul Irish gist。

根据 Paul Irish，**用于检测图像加载完成事件的规范插件**现在位于：

[https://github.com/desandro/imagesloaded](https://github.com/desandro/imagesloaded)

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-07-10T15:08:12.970

如果您想检查的不是所有图像，而是特定图像（例如，在 DOM 完成后动态替换的图像），您可以使用以下命令：

```
$('#myImage').attr('src', 'image.jpg').on("load", function() {  
  alert('Image Loaded');  
}); 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2011-09-05T10:33:55.537

你可以使用我的插件[*waitForImages*](https://github.com/alexanderdickson/waitForImages)来处理这个......

```
$(document).waitForImages(function() {
   // Loaded.
}); 
```

这样做的好处是您可以将其本地化为一个祖先元素，并且可以[选择](https://github.com/alexanderdickson/waitForImages#advanced)检测 CSS 中引用的图像。

不过，这只是冰山一角，请查看[文档](https://github.com/alexanderdickson/waitForImages/blob/master/README.md)了解更多功能。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-09-16T19:03:48.173

不保证使用 jQuery $().load() 作为 IMG 事件处理程序。如果图像从缓存中加载，某些浏览器可能不会触发该事件。对于（较旧？）版本的 Safari，如果您将 IMG 元素的 SRC 属性更改为*相同的值*，则不会触发 onload 事件。

这似乎在最新的 jQuery (1.4.x) - [http://api.jquery.com/load-event](http://api.jquery.com/load-event)中得到认可- 引用：

> 如果图像是从浏览器缓存中加载的，则可能不会触发 load 事件。为了解决这种可能性，我们可以使用一个特殊的加载事件，如果图像准备好，它会立即触发。event.special.load 目前可作为插件使用。

现在有一个插件可以识别这种情况和 IE 的 IMG 元素加载状态的“完整”属性：http: [//github.com/peol/jquery.imgloaded/raw/master/ahpi.imgload.js](http://github.com/peol/jquery.imgloaded/raw/master/ahpi.imgload.js)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-08-15T01:59:11.603

As per [this answer](https://stackoverflow.com/a/545005/3715), you can use the [jQuery load event](http://api.jquery.com/load-event/) on the `window` object instead of the `document`:

```
jQuery(window).load(function() {
    console.log("page finished loading now.");
}); 
```

This will be triggered after all content on the page has been loaded. This differs from `jQuery(document).load(...)` which is triggered after the DOM has finished loading.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-04-07T09:21:02.813

如果您需要跨浏览器解决方案，[imagesLoaded Plugin 是不错的选择](https://github.com/desandro/imagesloaded)

```
 $("<img>", {src: 'image.jpg'}).imagesLoaded( function( $images, $proper, $broken ){
 if($broken.length > 0){
 //Error CallBack
 console.log('Error');
 }
 else{
 // Load CallBack
 console.log('Load');
 }
 }); 
```

如果您只需要一个 IE 解决方法，就可以了

```
 var img = $("<img>", {
    error: function() {console.log('error'); },
    load: function() {console.log('load');}
    });
  img.attr('src','image.jpg'); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-02-15T11:33:35.663

目前关于 ahpi.imgload.js 插件的注释说它当前已损坏，请尝试使用此要点： [https ://gist.github.com/797120/7176db676f1e0e20d7c23933f9fc655c2f120c58](https://gist.github.com/797120/7176db676f1e0e20d7c23933f9fc655c2f120c58)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-05-05T17:49:10.900

### 对于同源图像，您可以使用：

```
$.get('http://www.your_domain.com/image.jpg', imgLoaded);

function imgLoaded(){
    console.log(this, 'loaded');
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-12T19:37:43.617

等待所有图像加载...
我在这里找到了 jfriend00 问题的答案[jquery：如何监听一个容器 div 的图像加载事件？](https://stackoverflow.com/questions/8570018/jquery-how-to-listen-to-the-image-loaded-event-of-one-container-div)..和“如果（this.complete）”
等待所有的东西加载，一些可能在缓存中！..我已经添加了“错误”事件...... ***它在所有浏览器中都很强大***

```
$(function() { // Wait dom ready
    var $img = $('img'), // images collection
        totalImg = $img.length,
        waitImgDone = function() {
            totalImg--;
            if (!totalImg) {
                console.log($img.length+" image(s) chargée(s) !");
            }
        };
    $img.each(function() {
        if (this.complete) waitImgDone(); // already here..
        else $(this).load(waitImgDone).error(waitImgDone); // completed...
    });
}); 
```

演示：http: [//jsfiddle.net/molokoloco/NWjDb/](http://jsfiddle.net/molokoloco/NWjDb/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-04T13:56:36.333

也许这个插件可能有用： http: [//www.farinspace.com/jquery-image-preload-plugin/](http://www.farinspace.com/jquery-image-preload-plugin/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-18T06:47:07.623

我创建了自己的脚本，因为我发现很多插件都非常臃肿，我只是希望它按照我想要的方式工作。我的检查以查看每个图像是否具有高度（本机图像高度）。我已经将它与 $(window).load() 函数结合起来解决缓存问题。

我已经对它进行了大量的代码注释，因此即使您不使用它，它也应该很有趣。它非常适合我。

事不宜迟，这里是：

[imgLoad.js 脚本](https://github.com/JohnnyBash/imgLoad)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-17T20:07:32.807

```
$( "img.photo" ).load(function() {

    $(".parrentDiv").css('height',$("img.photo").height());
    // very simple

}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-28T14:11:47.133

```
 function CheckImageLoadingState()
  {
     var counter = 0;
     var length = 0;

     jQuery('#siteContent img').each(function() 
     {
        if(jQuery(this).attr('src').match(/(gif|png|jpg|jpeg)$/))
          length++;
     });

     jQuery('#siteContent img').each(function() 
     {  
        if(jQuery(this).attr('src').match(/(gif|png|jpg|jpeg)$/))
        {
           jQuery(this).load(function() 
           {
           }).each(function() {
              if(this.complete) jQuery(this).load();
            });
        }
        jQuery(this).load(function()
        {
           counter++;
           if(counter === length) 
           {  
              //function to call when all the images have been loaded
              DisplaySiteContent();
           }
        });
     });
  } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-01T16:30:24.840

`window.load = function(){}`

它被所有浏览器完全支持，当所有图像完全加载时它会触发一个事件。

[https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onload](https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onload)

# c# - 如何将 Silverlight ImageSource 转换为 byte[]？

> ID：910729
> 
> 赞同：0
> 
> 时间：2009-05-26T13:38:33.987
> 
> 标签：c#, .net, silverlight, bytearray, imagesource

我的画布上有一个简单的 ImageSource silverlight 控件。工作正常。有什么方法可以将 ImageSource 的内容提取到字节数组中？

干杯！

PS。任何版本的 SL 都可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T13:53:53.830

我不确定您是否可以从 ImageSource 组件中获取字节数组，但您可能可以创建一个 BitmapImage 并设置其 UriSource 属性，然后从那里获取字节 []。不完全是您问题的答案，而是hth ;)

# python - 蟒蛇微软字

> ID：910730
> 
> 赞同：2
> 
> 时间：2009-05-26T13:38:47.323
> 
> 标签：python, ms-word

> **可能重复：**
> [在 Python 中读/写 MS Word 文件](https://stackoverflow.com/questions/188444/reading-writing-ms-word-files-in-python)

我正在研究一个需求管理系统（如 requiste pro - Rational Rose） - 并且需要在 Windows 或 Apple OS 环境中通读 MS Word 文档以搜索特定标签。是否有任何已知的框架（我找不到） - 或建议的方法？

只是为了添加一些说明 - 这不是一次性阅读，每次有更新时我都会查看文档并在特定需求区域执行 CRUD。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T14:03:33.890

首先，让它脱离原生 Word ( `.doc`) 格式。

*   执行“另存为 XML”并坚持您的用户使用该文件而不是该`.doc`文件。他们几乎不会注意到差异——除了文件更大。

    使用[lxml](http://codespeak.net/lxml/)或[元素树](http://docs.python.org/library/xml.etree.elementtree.html)来解析 XML 并找到标题、部分、段落和列表。

*   您还可以在进行分析之前执行“另存为 HTML”。这与 XML 版本一样有效。但是，HTML 版本对用户来说并不容易，因此请在分析之前执行此操作。

    使用[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)解析 HTML 并找到标题、部分、段落和列表。

一旦有了解析结构（XML 或 HTML），您就可以分析文档以查找特定标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:40:53.490

您可以利用[openoffice.org](http://openoffice.org/)阅读 Word 文档的能力。[Python-UNO](http://wiki.services.openoffice.org/wiki/PyUNO_bridge) 桥允许使用`OpenOffice.org API`来自 python 脚本语言的标准。在您的机器上使用`Python-UNO`并拥有 openoffice 的相关部分，阅读大多数 Word 文档应该很简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T16:02:58.767

使用[Visual Studio Tools for Office (VSTO)](http://msdn.microsoft.com/en-us/vsto/default.aspx)，可以`Word`使用任何`.NET`语言编写脚本。How to : [Search for Text in Documents](http://msdn.microsoft.com/en-us/library/f1f367bx.aspx)示例显示`C#`和`Visual Basic`编码，但[`IronPython`](http://www.codeplex.com/IronPython)也可以调用相同的`.NET`方法。

如果您准备好使用[IronPython](http://www.codeplex.com/IronPython)（没有 Mac 等效项），这可能是用于搜索内部`Word`文档的 Windows 特定解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T16:14:30.177

假设您在 Windows 上并安装了 Word，您可以使用 COM 在 python 中控制 Word - 请参阅[Python for win32](http://www.python.org/download/windows/)在 Linux 上，您可以使用 OpenOffice 执行相同操作。

或者，有一堆适用于 win32 或 Linux 的 Word 字符串提取器，然后您可以使用普通的 python 正则表达式工具。

请参阅this question [extracting text from MS word files in python](https://stackoverflow.com/questions/125222/extracting-text-from-ms-word-files-in-python)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T14:13:25.210

如果你有一点现金，你可以购买[Aspose.Word](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)的 Java API。有了它，您可以以编程方式访问和操作任何 Word 文档

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T14:54:05.113

我知道这是一个 Python 问题，但是......

在 Windows 上，您应该使用 VBScript（VBA 宏）和 OLE 以编程方式访问 Word。

[示例](http://www.java2s.com/Code/VBA-Excel-Access-Word/CatalogVBA-Excel-Access-Word.htm)| [操作方法](http://www.kayodeok.btinternet.co.uk/favorites/kbofficewordhowto.htm#kbhowtoauto)| [使用 OLE 自动化 Word](http://support.microsoft.com/kb/184974)

在 MacOSX 上，旧版本使用 VBA，Office 2008 使用 AppleScript。

[文章](http://www.macworld.com/article/133027/2008/04/geekfactor2505.html)

使用 VBA，您可以选择就地修改文档或执行自动“另存为”以更容易处理的格式获取数据（尽管警告其 HTML 导出非常糟糕）。

我强烈建议您远离第三方库/产品，即使您不喜欢 vbscript。该格式过于复杂、未记录且不一致，无法进行准确的外部处理。StarOffice/OpenOffice 就是证明。他们已经尝试了多年，仍然没有准确的.doc解析，更不用说.docx了。是的，它通常可以工作，但是一旦您开始尝试在 Word 之外以编程方式修改文档，您就会面临无法量化的修改文档的风险。您应该能够使用 os.system 从 Python 调用 VBscript。我认为解释器是 wscript.exe 但不要强迫我这样做。不过，这可能有效：

```
os.system('start script.vb') 
```

# python - 从 Python 脚本中运行另一个程序的推荐方法

> ID：910733
> 
> 赞同：13
> 
> 时间：2009-05-26T13:38:56.310
> 
> 标签：python, windows

> **可能重复：**
> [如何在 Python 中调用外部命令](https://stackoverflow.com/questions/89228/how-to-call-external-command-in-python)

我正在 Windows 机器上编写 Python 脚本。我需要启动另一个应用程序“OtherApp.exe”。最合适的方法是什么？

直到现在我一直在看`os.system()`or`os.execl()`并且它们看起来不太合适（我什至不知道后者是否可以在 Windows 中工作）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T13:46:45.203

推荐的方法是使用[subprocess 模块](http://docs.python.org/library/subprocess.html)。所有其他方式（如`os.system()`or `exec`）都是脆弱的、不安全的并且具有您不需要关心的微妙副作用。subprocess 替换所有这些。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-26T13:55:42.487

*请注意，此答案特定于 python 版本 2.x，由于嵌入式系统，我被锁定。我只是出于历史原因离开它以防万一。*

子进程提供的其中一件事是捕获命令输出的方法，例如在 Windows 机器上使用 [popen]

```
import os
os.popen('dir').read() 
```

将产生

' 驱动器 C 中的卷没有标签。\n 卷序列号是 54CD-5392\n\n C:\Python25\Lib\site-packages\pythonwin\n\n[.] [..] dde.pyd 的目录license.txt\nPythonwin.exe [pywin] scintilla.dll tmp.txt\nwin32ui.pyd win32uiole.pyd \n 7 File(s) 984,178 bytes\n 3 Dir(s) 30,539,644,928 bytes free\n'

然后可以按照您想要的任何方式对其进行解析或操作。

# python - 使用 python 库发送 xmpp 消息

> ID：910737
> 
> 赞同：10
> 
> 时间：2009-05-26T13:39:08.947
> 
> 标签：python, xmpp

如何使用以下 Python 库之一发送 XMPP 消息：wokkel、xmpppy 或 jabber.py？

我想我知道伪代码，但到目前为止还没有能够正确运行。这是我到目前为止所尝试的：

*   调用一些 API 并传递服务器名称和端口号以连接到该服务器。
*   调用一些 API 并传递用户名、密码来构造一个 JID 对象。
*   使用该 JID 进行身份验证。
*   构造一个 Message 对象并调用一些 API 并在参数中传递该消息 obj。
*   调用一些发送 API。

这在概念上似乎很容易，但魔鬼在细节的某个地方。如果可能，请显示示例代码段。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-26T20:36:32.100

这是最简单的 xmpp 客户端。它将发送一条“你好 :)”消息。我[`xmpppy`](https://pypi.python.org/pypi/xmpppy)在示例中使用。并连接到 gtalk 服务器。我认为这个例子是不言自明的：

```
import xmpp

username = 'username'
passwd = 'password'
to='name@example.com'
msg='hello :)'

client = xmpp.Client('gmail.com')
client.connect(server=('talk.google.com',5223))
client.auth(username, passwd, 'botty')
client.sendInitPresence()
message = xmpp.Message(to, msg)
message.setAttr('type', 'chat')
client.send(message) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-05T01:46:45.287

[xmpppy](http://xmpppy.sourceforge.net/)在其主页（在“示例”下）列出了许多示例，其中最基本的示例[发送一条测试消息](http://xmpppy.sourceforge.net/examples/README.py)。[它们使示例逐渐变得更有趣——它们通过聊天机器人程序](http://xmpppy.sourceforge.net/examples/xtalk.py)引入了面向回调的 API 。

# java - 取消长时间运行的正则表达式匹配？

> ID：910740
> 
> 赞同：19
> 
> 时间：2009-05-26T13:40:28.490
> 
> 标签：java, regex, multithreading

假设我正在运行一项服务，用户可以在其中提交正则表达式来搜索大量数据。如果用户提交了一个非常慢的正则表达式（即 Matcher.find() 返回需要几分钟），我想要一种取消该匹配的方法。我能想到的唯一方法是让另一个线程监视匹配需要多长时间，并在必要时使用 Thread.stop() 取消它。

成员变量：

```
long REGEX_TIMEOUT = 30000L;
Object lock = new Object();
boolean finished = false;
Thread matcherThread; 
```

匹配线程：

```
try {
    matcherThread = Thread.currentThread();

    // imagine code to start monitor thread is here

    try {
        matched = matcher.find();
    } finally {
        synchronized (lock) {
            finished = true;
            lock.notifyAll();
        }
    }
} catch (ThreadDeath td) {
    // send angry message to client
    // handle error without rethrowing td
} 
```

监控线程：

```
synchronized (lock) {
    while (! finished) {
        try {
            lock.wait(REGEX_TIMEOUT);

            if (! finished) {
                matcherThread.stop();
            }
        } catch (InterruptedException ex) {
            // ignore, top level method in dedicated thread, etc..
        }
    }
} 
```

我已阅读 java.sun.com/j2se/1.4.2/docs/guide/misc/threadPrimitiveDeprecation.html 并且我认为这种用法是安全的，因为我正在控制通过同步抛出 ThreadDeath 的位置并处理它以及唯一损坏的对象可能是我的 Pattern 和 Matcher 实例，无论如何都会被丢弃。我认为这会破坏 Thread.stop() 因为我没有重新抛出错误，但我真的不希望线程死亡，只是中止 find() 方法。

到目前为止，我已经设法避免使用这些已弃用的 API 组件，但 Matcher.find() 似乎不是可中断的，并且可能需要很长时间才能返回。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-26T13:51:20.933

来自 Heritrix：（[crawler.archive.org](http://crawler.archive.org)）

```
/**
 * CharSequence that noticed thread interrupts -- as might be necessary 
 * to recover from a loose regex on unexpected challenging input. 
 * 
 * @author gojomo
 */
public class InterruptibleCharSequence implements CharSequence {
    CharSequence inner;
    // public long counter = 0; 

    public InterruptibleCharSequence(CharSequence inner) {
        super();
        this.inner = inner;
    }

    public char charAt(int index) {
        if (Thread.interrupted()) { // clears flag if set
            throw new RuntimeException(new InterruptedException());
        }
        // counter++;
        return inner.charAt(index);
    }

    public int length() {
        return inner.length();
    }

    public CharSequence subSequence(int start, int end) {
        return new InterruptibleCharSequence(inner.subSequence(start, end));
    }

    @Override
    public String toString() {
        return inner.toString();
    }
} 
```

用这个包裹你的 CharSequence，线程中断将起作用......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-05T16:11:20.143

稍加改动就可以避免为此使用额外的线程：

```
public class RegularExpressionUtils {

    // demonstrates behavior for regular expression running into catastrophic backtracking for given input
    public static void main(String[] args) {
        Matcher matcher = createMatcherWithTimeout(
                "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx", "(x+x+)+y", 2000);
        System.out.println(matcher.matches());
    }

    public static Matcher createMatcherWithTimeout(String stringToMatch, String regularExpression, int timeoutMillis) {
        Pattern pattern = Pattern.compile(regularExpression);
        return createMatcherWithTimeout(stringToMatch, pattern, timeoutMillis);
    }

    public static Matcher createMatcherWithTimeout(String stringToMatch, Pattern regularExpressionPattern, int timeoutMillis) {
        CharSequence charSequence = new TimeoutRegexCharSequence(stringToMatch, timeoutMillis, stringToMatch,
                regularExpressionPattern.pattern());
        return regularExpressionPattern.matcher(charSequence);
    }

    private static class TimeoutRegexCharSequence implements CharSequence {

        private final CharSequence inner;

        private final int timeoutMillis;

        private final long timeoutTime;

        private final String stringToMatch;

        private final String regularExpression;

        public TimeoutRegexCharSequence(CharSequence inner, int timeoutMillis, String stringToMatch, String regularExpression) {
            super();
            this.inner = inner;
            this.timeoutMillis = timeoutMillis;
            this.stringToMatch = stringToMatch;
            this.regularExpression = regularExpression;
            timeoutTime = System.currentTimeMillis() + timeoutMillis;
        }

        public char charAt(int index) {
            if (System.currentTimeMillis() > timeoutTime) {
                throw new RuntimeException("Timeout occurred after " + timeoutMillis + "ms while processing regular expression '"
                                + regularExpression + "' on input '" + stringToMatch + "'!");
            }
            return inner.charAt(index);
        }

        public int length() {
            return inner.length();
        }

        public CharSequence subSequence(int start, int end) {
            return new TimeoutRegexCharSequence(inner.subSequence(start, end), timeoutMillis, stringToMatch, regularExpression);
        }

        @Override
        public String toString() {
            return inner.toString();
        }
    }

} 
```

非常感谢 dawce 为我指出这个解决方案来回答一个不必要的复杂[问题](https://stackoverflow.com/questions/11307649/can-it-be-acceptable-in-java-to-use-threadstop-to-kill-a-thread-that-is-runni)！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:54:21.947

另一种解决方法是限制匹配器的[区域](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#region(int,%20int))，然后调用`find()`，重复直到线程被中断或找到匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-15T09:42:22.920

也许您需要的是一个实现 NFA 算法的新库。

NFA算法比Java标准库使用的算法快数百倍。

并且 Java 标准库对输入正则表达式很敏感，这可能会导致您的问题发生——一些输入会使 CPU 运行多年。

NFA算法可以通过它使用的步骤来设置超时。它比 Thread 解决方案有效。相信我，我使用线程超时来解决一个相对问题，这对性能来说太可怕了。我终于通过修改我的算法实现的主循环来解决这个问题。我在主循环中插入了一些检查点来测试时间。

详细信息可以在这里找到：[https](https://swtch.com/~rsc/regexp/regexp1.html) ://swtch.com/~rsc/regexp/regexp1.html 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-17T21:15:15.750

在使用一个或多个正则表达式模式执行之前检查用户提交的正则表达式是否有“邪恶”模式怎么样（这可能是在条件执行正则表达式之前调用的方法的形式）：

这个正则表达式：

```
\(.+\+\)[\+\*] 
```

将匹配：

```
(a+)+
(ab+)+
([a-zA-Z]+)* 
```

这个正则表达式：

```
\((.+)\|(\1\?|\1{2,})\)\+ 
```

将匹配：

```
(a|aa)+
(a|a?)+ 
```

这个正则表达式：

```
\(\.\*.\)\{\d{2,}\} 
```

将匹配：

```
(.*a){x} for x \> 10 
```

我可能对 Regex 和 Regex DoS 有点天真，但我不禁认为，对已知的“邪恶”模式进行一点预筛选将大大有助于防止执行时出现问题，尤其是如果有问题的正则表达式是最终用户提供的输入。上面的模式可能不够完善，因为我远非正则表达式专家。这只是深思熟虑，因为我在那里发现的所有其他内容似乎都表明它无法完成，并且专注于在正则表达式引擎上设置超时，或者限制允许执行的迭代次数.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-29T19:01:18.377

我包括了一个计数器，以检查每 n 次 charAt 读取，以减少开销。

笔记：

有人说 carAt 的调用频率可能不够高。我刚刚添加了 foo 变量，以说明调用了多少 charAt，并且它足够频繁。如果您要在生产中使用它，请删除该计数器，因为如果长时间在服务器中运行，它会降低性能并最终导致长时间溢出。在此示例中，每 0.8 秒左右调用 3000 万次 charAt（**未使用适当的微基准测试条件进行测试，这只是一个概念证明**）。如果您想要更高的精度，您可以设置较低的 checkInterval，但会以性能为代价（从长远来看，System.currentTimeMillis() > timeoutTime 比 if 子句更昂贵。

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import com.goikosoft.test.RegexpTimeoutException;

/**
 * Allows to create timeoutable regular expressions.
 *
 * Limitations: Can only throw RuntimeException. Decreases performance.
 *
 * Posted by Kris in stackoverflow.
 *
 * Modified by dgoiko to  ejecute timeout check only every n chars.
 * Now timeout < 0 means no timeout.
 *
 * @author Kris https://stackoverflow.com/a/910798/9465588
 *
 */
public class RegularExpressionUtils {

    public static long foo = 0;

    // demonstrates behavior for regular expression running into catastrophic backtracking for given input
    public static void main(String[] args) {
        long millis = System.currentTimeMillis();
        // This checkInterval produces a < 500 ms delay. Higher checkInterval will produce higher delays on timeout.
        Matcher matcher = createMatcherWithTimeout(
                "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx", "(x+x+)+y", 10000, 30000000);
        try {
            System.out.println(matcher.matches());
        } catch (RuntimeException e) {
            System.out.println("Operation timed out after " + (System.currentTimeMillis() - millis) + " milliseconds");
        }
        System.out.print(foo);
    }

    public static Matcher createMatcherWithTimeout(String stringToMatch, String regularExpression, long timeoutMillis,
                                                      int checkInterval) {
        Pattern pattern = Pattern.compile(regularExpression);
        return createMatcherWithTimeout(stringToMatch, pattern, timeoutMillis, checkInterval);
    }

    public static Matcher createMatcherWithTimeout(String stringToMatch, Pattern regularExpressionPattern,
                                                    long timeoutMillis, int checkInterval) {
        if (timeoutMillis < 0) {
            return regularExpressionPattern.matcher(stringToMatch);
        }
        CharSequence charSequence = new TimeoutRegexCharSequence(stringToMatch, timeoutMillis, stringToMatch,
                regularExpressionPattern.pattern(), checkInterval);
        return regularExpressionPattern.matcher(charSequence);
    }

    private static class TimeoutRegexCharSequence implements CharSequence {

        private final CharSequence inner;

        private final long timeoutMillis;

        private final long timeoutTime;

        private final String stringToMatch;

        private final String regularExpression;

        private int checkInterval;

        private int attemps;

        TimeoutRegexCharSequence(CharSequence inner, long timeoutMillis, String stringToMatch,
                                  String regularExpression, int checkInterval) {
            super();
            this.inner = inner;
            this.timeoutMillis = timeoutMillis;
            this.stringToMatch = stringToMatch;
            this.regularExpression = regularExpression;
            timeoutTime = System.currentTimeMillis() + timeoutMillis;
            this.checkInterval = checkInterval;
            this.attemps = 0;
        }

        public char charAt(int index) {
            if (this.attemps == this.checkInterval) {
                foo++;
                if (System.currentTimeMillis() > timeoutTime) {
                    throw new RegexpTimeoutException(regularExpression, stringToMatch, timeoutMillis);
                }
                this.attemps = 0;
            } else {
                this.attemps++;
            }

            return inner.charAt(index);
        }

        public int length() {
            return inner.length();
        }

        public CharSequence subSequence(int start, int end) {
            return new TimeoutRegexCharSequence(inner.subSequence(start, end), timeoutMillis, stringToMatch,
                                                regularExpression, checkInterval);
        }

        @Override
        public String toString() {
            return inner.toString();
        }
    }

} 
```

以及自定义异常，因此您只能捕获该异常以避免吞下其他 RE 模式/匹配器可能抛出的异常。

```
public class RegexpTimeoutException extends RuntimeException {
    private static final long serialVersionUID = 6437153127902393756L;

    private final String regularExpression;

    private final String stringToMatch;

    private final long timeoutMillis;

    public RegexpTimeoutException() {
        super();
        regularExpression = null;
        stringToMatch = null;
        timeoutMillis = 0;
    }

    public RegexpTimeoutException(String message, Throwable cause) {
        super(message, cause);
        regularExpression = null;
        stringToMatch = null;
        timeoutMillis = 0;
    }

    public RegexpTimeoutException(String message) {
        super(message);
        regularExpression = null;
        stringToMatch = null;
        timeoutMillis = 0;
    }

    public RegexpTimeoutException(Throwable cause) {
        super(cause);
        regularExpression = null;
        stringToMatch = null;
        timeoutMillis = 0;
    }

    public RegexpTimeoutException(String regularExpression, String stringToMatch, long timeoutMillis) {
        super("Timeout occurred after " + timeoutMillis + "ms while processing regular expression '"
                + regularExpression + "' on input '" + stringToMatch + "'!");
        this.regularExpression = regularExpression;
        this.stringToMatch = stringToMatch;
        this.timeoutMillis = timeoutMillis;
    }

    public String getRegularExpression() {
        return regularExpression;
    }

    public String getStringToMatch() {
        return stringToMatch;
    }

    public long getTimeoutMillis() {
        return timeoutMillis;
    }

} 
```

基于[安德烈亚斯的回答](https://stackoverflow.com/a/11348374/9465588)。主要功劳应该归于他和他的来源。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-24T10:59:13.257

可以使用以下方法停止长时间运行的模式匹配过程。

*   创建`StateFulCharSequence`管理模式匹配状态的类。当该状态发生变化时，下一次调用方法时会引发异常`charAt`。
*   `ScheduledExecutorService`可以使用所需的超时来安排该状态更改。
*   这里模式匹配发生在主线程中，不需要每次都检查线程中断状态。

    ```
    public class TimedPatternMatcher {
    public static void main(String[] args) {
        ScheduledExecutorService executorService = Executors.newScheduledThreadPool(1);
        Pattern pattern = Pattern.compile("some regex pattern");
        StateFulCharSequence stateFulCharSequence = new StateFulCharSequence("some character sequence");
        Matcher matcher = pattern.matcher(stateFulCharSequence);
        executorService.schedule(stateFulCharSequence, 10, TimeUnit.MILLISECONDS);
        try {
            boolean isMatched = matcher.find();
        }catch (Exception e) {
            e.printStackTrace();
        }

    }

    /*
    When this runnable is executed, it will set timeOut to true and pattern matching is stopped by throwing exception.
     */
    public static class StateFulCharSequence implements CharSequence, Runnable{
        private CharSequence inner;

        private boolean isTimedOut = false;

        public StateFulCharSequence(CharSequence inner) {
            super();
            this.inner = inner;
        }

        public char charAt(int index) {
            if (isTimedOut) {
                throw new RuntimeException(new TimeoutException("Pattern matching timeout occurs"));
            }
            return inner.charAt(index);
        }

        @Override
        public int length() {
            return inner.length();
        }

        @Override
        public CharSequence subSequence(int start, int end) {
            return new StateFulCharSequence(inner.subSequence(start, end));
        }

        @Override
        public String toString() {
            return inner.toString();
        }

        public void setTimedOut() {
            this.isTimedOut = true;
        }

        @Override
        public void run() {
            this.isTimedOut = true;
        }
    }} 
    ```

# linq - 速度测试 Linq2SQL v 整个框架

> ID：910744
> 
> 赞同：0
> 
> 时间：2009-05-26T13:41:28.660
> 
> 标签：linq, linq-to-sql, entity-framework

有没有人将 LINQ to SQL 与实体框架之间的性能速度进行比较？

我听说 LINQ to SQL 比实体框架快 4 倍，但我从未见过任何基准测试或示例应用程序证明这一点。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-26T13:46:41.957

[这里](http://blogs.msdn.com/adonet/archive/2008/03/27/ado-net-entity-framework-performance-comparison.aspx)有相当全面的调查，尽管我认为它是一个 MSDN 博客，因此可能存在偏见。

# php - 帮助 mod_rewrite

> ID：910752
> 
> 赞同：1
> 
> 时间：2009-05-26T13:43:33.040
> 
> 标签：php, mod-rewrite

我有文件夹 home/admin。在这个文件夹中有 index.php。当我访问 domain.com/admin/ 时，我的 mod_rewrite 规则将它重定向到我的主文件夹中的 index.php。我希望 mod_rewrite 跳过现有文件夹或文件，以及 /admin/ 文件夹的特殊情况，其中包含 index.php 文件。

我的重写规则是：

```
 <IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteRule ^$ index.html [QSA]
   RewriteRule ^([^.]+)$ $1.html [QSA]
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteRule ^(.*)$ index.php [QSA,L]
 </IfModule> 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T13:46:49.663

尝试改变

```
RewriteCond %{REQUEST_FILENAME} !-f 
```

到

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

这将跳过目录和文件

编辑：我认为这条规则出了问题（也是）：

```
RewriteRule ^([^.]+)$ $1.html [QSA] 
```

试试这个

```
RewriteRule (^|/)([^.]+)$ $2.html [QSA] 
```

# c# - 如何从 asp.net 页面运行任何 win.exe？

> ID：910754
> 
> 赞同：1
> 
> 时间：2009-05-26T13:43:50.293
> 
> 标签：c#, .net, asp.net

如何从 asp.net 页面运行任何 win.exe？

这给我编码错误：**系统找不到指定的文件**

```
 System.Diagnostics.Process process1 = new System.Diagnostics.Process();

            process1.StartInfo.WorkingDirectory = Request.MapPath(@"C:\");

            process1.StartInfo.FileName = Request.MapPath("WindowsApplication1.exe");
            process1.Start();
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T13:47:13.423

请记住，您发布的代码是*在您的 Web 服务器上*运行的。它不会*也不能*在用户的机器上运行。这将是一个重大的安全问题——严重到足以让网络变得毫无用处。

如果这是您的意图，那么您只需要确保您的 asp.net 帐户（出于安全原因通常以非常有限的权限运行）具有适当的权限、访问权限和信任来运行请求的程序。否则，您将需要做其他事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T13:48:20.737

您正在做的事情不需要 Request.MapPath()，因为您已经在使用本地路径。Request.MapPath() 用于将应用程序相关的 URL（例如“~/test.htm”）转换为本地路径（例如“c:\inetpub\wwwroot\myapp\test.htm”）。

应用程序是否存在于**服务器上的**c:\WindowsApplication1.exe 中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:47:33.563

试试这个

`System.Diagnostics.Process process1 = new System.Diagnostics.Process(); process1.StartInfo.FileName = "C:\WindowsApplication1.exe";
process1.Start();`

通过这种方式，应用程序首先被下载，然后它将运行。我认为它不会从服务器运行。

如果你想从服务器上运行它，最好在 flash 或 silverlight/moonlight 中编写应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T13:47:56.807

你想做什么 ？

您的目标是在客户端计算机上执行吗，（顺便说一句，您不能这样做）

如果只是当用户浏览该页面时您想在服务器上执行一些 .exe（我什至不会开始说明​​为什么这是一个坏主意），那么您正在做一些愚蠢的事情。

`Request.MapPath`文件名周围不需要's。

您还需要确保您的网络服务器身份帐户有权访问和运行该文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T13:49:04.200

Request.MapPath 采用相对 URL，并返回本地文件名（在服务器上），例如`Request.MapPath("test.aspx")`可能返回`C:\inetpub\wwwroot\MyApp\Test.aspx`.

因此，基本上您的“网页”将在服务器上与名为 WindowsApplcation1.exe 的网页相同的目录中查找应用程序。

最后 - 如果您希望此 Windows 应用程序在客户端上运行，这将不起作用，因为它将在服务器上运行应用程序。不允许在客户端上自动运行文件，因为这会带来安全风险。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T10:44:00.970

我这样做：

```
 var client = new Client(Int32.Parse(Session["uid"].ToString()));
    var genReceipt = new Process();
    genReceipt.StartInfo.FileName = "Chitanta_unit.exe";
    genReceipt.StartInfo.WorkingDirectory = @"C:\chitanta_unit\";
    genReceipt.StartInfo.Arguments = client.ClientID.ToString();
    genReceipt.Start();
    genReceipt.WaitForExit();
    if (genReceipt.ExitCode == 0)
    {
        Response.Redirect("~/subscriber/ch/" + client.GetChitantaFilename());
    }
    genReceipt.Close(); 
```

客户类包含与客户的操作。服务器上的“C:\chitanta_unit\”路径。服务器都是我的 =) 我用 clientID 参数运行它。Chitanta_unit.exe 是一个 ConsoleApplication

它运作良好

# ruby - 如何通过 Ruby 解压缩受密码保护的文件

> ID：910756
> 
> 赞同：3
> 
> 时间：2009-05-26T13:44:32.803
> 
> 标签：ruby, unzip, rubyzip

我想通过 Ruby 脚本解压缩加密/受密码保护的文件，而不需要下拉到系统调用。我目前使用 ruby​​zip 库来解压缩文件，但没有看到处理加密文件的选项。

任何人都知道一些代码或库可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:21:32.673

是的，顺便说一下，有一个效果很好，我刚试过，发现你的帖子在中间..

[存档-zip](https://github.com/javanthropus/archive-zip)

使用示例：

```
require 'archive/zip'
Archive::Zip.extract('example5.zip', 'a_destination', :password => 'seakrit') 
```

我相信这对于在谷歌上寻找相同内容的其他人会很有用:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T14:38:43.227

有时正确的答案是使用系统调用。这就是它在那里的原因。

的确，它比使用库或方法更慢且更不优雅。但它比向某人纳税（版税）便宜得多，而且比自己编写一个新库要快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T13:50:40.310

迄今为止，我只听说过[**Chilkat Ruby Zip 库**](http://www.chilkatsoft.com/)，它不是免费的。RubyZip 库不支持受密码保护的文件，因为底层库 zlib 也不支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T00:34:36.940

不是 ruby​​ 库，但是......也许是一个免费的选择。

如果您的应用程序在 Windows 上运行，您可以通过新的 COM 接口使用[DotNetZip](http://dotnetzip.codeplex.com)库。它执行受密码保护的文件，无论是 Zip 加密（弱）还是与 WinZip 兼容的 AES 加密。

DotNetZip 是免费的。

如果Windows是不可能的，可能还有另一种可能性。DotNetZip 也可以在 Mono 中运行。我不知道是否有 Ruby-to-Mono 集成机制允许您在其他平台上从 Ruby 调用 Mono，但如果它们存在，它们也可能让您调用 DotNetZip。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-25T23:06:19.687

总是可以选择使用 JRuby + 一个 Java 库来处理 zip 文件。 [http://www.lingala.net/zip4j](http://www.lingala.net/zip4j)处理（加密的）zip 文件并且是 Apache 许可的。我还没有使用它，但它*应该可以*工作。

# vb.net - VB.NET 的 LINQ 中 ORDERBY 的语法是什么？

> ID：910762
> 
> 赞同：21
> 
> 时间：2009-05-26T13:45:38.823
> 
> 标签：vb.net, distinct, sql-order-by

我是 Linq 的新手，VB 中 order by 的语法是什么？

```
Dim cxt As New datContext
Dim qry = (From lst In cxt.zipcodes _
              Select lst.state).Distinct

    qry = qry.OrderBy() 
```

我的简单 SQL 语句将是这样的：

```
Select distinct state from zipcodes
order by State 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-26T13:48:03.937

```
qry = qry.OrderBy(Function(obj) obj.PropertyToSortBy) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-26T15:14:04.933

查询的替代语法（更清晰的 IMO）：

```
Dim qry = From lst In cxt.zipcodes _
          Select lst.state Distinct _
          Order By state 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-06T10:48:45.507

```
Dim cxt As New datContext

Dim qry = (From lst In cxt.zipcodes OrderBy lst.state).Distinct.tolist

Dim statelst = qry.Select(Function(o) o.state).ToList 
```

# datetime - 如何设置像'YYYYMM'这样的Postgresql默认值日期戳？

> ID：910763
> 
> 赞同：50
> 
> 时间：2009-05-26T13:45:45.813
> 
> 标签：datetime, postgresql, default-value

作为标题，如何将表格的列设置为当前年份和月份的默认值，格式为“YYYYMM”，例如今天的 200905？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-26T14:17:47.183

请记住，日期的格式与存储无关。如果以该格式**存储**日期对您很重要，您将需要定义自定义数据类型或将其存储为字符串。然后，您可以使用[extract](http://www.postgresql.org/docs/8.3/interactive/functions-datetime.html)、 typecasting 和 concatenation 的组合来获得该格式。

但是，我怀疑您想存储日期并获取输出格式。所以，这样的事情会为你解决问题：

```
 CREATE TABLE my_table
    (
    id serial PRIMARY KEY not null,
    my_date date not null default CURRENT_DATE
    );

(CURRENT_DATE is basically a synonym for now() and a cast to date). 
```

（编辑为使用 to_char）。

然后你可以得到你的输出，如：

```
SELECT id, to_char(my_date, 'yyyymm') FROM my_table; 
```

现在，如果您**确实**需要将该字段存储为字符串并确保您始终可以使用的格式：

```
CREATE TABLE my_other_table
(
id serial PRIMARY KEY not null,
my_date varchar(6) default to_char(CURRENT_DATE, 'yyyymm')
); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-26T14:27:02.720

以防万一 Milen A. Radev 没有时间发布他的解决方案，就是这样：

```
CREATE TABLE foo (
    key     int PRIMARY KEY,
    foo     text NOT NULL DEFAULT TO_CHAR(CURRENT_TIMESTAMP,'YYYYMM')
); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-26T13:53:12.723

你为什么想做这个？

恕我直言，您应该将日期存储为默认类型，并在需要时将其转换为所需格式。

您可以通过指定列的格式而侥幸逃脱，但可以使用视图。我不知道其他方法。

**编辑：**

说真的，在我看来，您应该在具有日期类型的表上创建一个视图。我在谈论这样的事情：

```
create table sample_table ( id serial primary key, timestamp date); 
```

然后

```
create view v_example_table as select id, to_char(date, 'yyyymmmm'); 
```

并在您的应用程序中使用 v_example_table。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T14:43:18.147

感谢所有回答的人，感谢那些给我函数格式想法的人，我会好好研究它以备将来使用。

但是对于这种明确的情况，“特殊 yyyymm 字段”不被视为日期字段，而只是作为标签，o 用于匹配精确年份月份研究值的任何内容；已经有另一个日期字段，带有完整的时间戳，但如果我需要 2008 年 1 月的所有行，我认为这样的选择会更快

```
SELECT  [columns] FROM table WHERE yearmonth = '200801' 
```

代替

```
SELECT  [columns] FROM table WHERE date BETWEEN DATE('2008-01-01') AND DATE('2008-01-31') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-06T10:27:56.400

一种常见的误解是，您可以像这样进行非规范化以提高性能。如果您发现它运行缓慢，请`date_trunc('month', date)`用于您的查询并为此添加索引表达式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-29T10:26:24.177

我从字面上理解你的问题。因为你做不到。无论如何，datestamp 至少同时具有**“Y”、“M”、“D”** **3 个元素。**

表 8.10 显示了日期类型的一些可能输入。
[https://www.postgresql.org/docs/current/datatype-datetime.html#DATATYPE-DATETIME-DATE-TABLE](https://www.postgresql.org/docs/current/datatype-datetime.html#DATATYPE-DATETIME-DATE-TABLE)。

```
Example     Description
1999-01-08  ISO 8601; January 8 in any mode (recommended format)
January 8, 1999     unambiguous in any datestyle input mode
1/8/1999    January 8 in MDY mode; August 1 in DMY mode
1/18/1999   January 18 in MDY mode; rejected in other modes
01/02/03    January 2, 2003 in MDY mode; February 1, 2003 in DMY mode; February 3, 2001 in YMD mode
1999-Jan-08     January 8 in any mode
Jan-08-1999     January 8 in any mode
08-Jan-1999     January 8 in any mode
99-Jan-08   January 8 in YMD mode, else error
08-Jan-99   January 8, except error in YMD mode
Jan-08-99   January 8, except error in YMD mode
19990108    ISO 8601; January 8, 1999 in any mode
990108  ISO 8601; January 8, 1999 in any mode
1999.008    year and day of year
J2451187    Julian date
January 8, 99 BC    year 99 BC 
```

日期输出：

```
datestyle Setting   Input Ordering  Example Output
SQL, DMY    day/month/year  17/12/1997 15:37:16.00 CET
SQL, MDY    month/day/year  12/17/1997 07:37:16.00 PST
Postgres, DMY   day/month/year  Wed 17 Dec 07:37:16 1997 PST 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-26T14:18:33.233

对。最好使用一个函数：

```
CREATE OR REPLACE FUNCTION yyyymm() RETURNS text
    LANGUAGE 'plpgsql' AS $$
DECLARE
    retval text;
    m integer;
BEGIN
    retval := EXTRACT(year from current_timestamp);
    m := EXTRACT(month from current_timestamp);
    IF m < 10 THEN retval := retval || '0'; END IF;
    RETURN retval || m;
END $$;

SELECT yyyymm();

DROP TABLE foo;
CREATE TABLE foo (
    key             int PRIMARY KEY,
    colname text DEFAULT yyyymm()
    );
INSERT INTO foo (key) VALUES (0);
SELECT * FROM FOO; 
```

这给了我

```
 key | colname 
-----+---------
   0 | 200905 
```

`createlang plpgsql`如有必要，请确保从 Unix 命令行运行。

# apache-flex - 如何在 FLEX 表单项标签中嵌入图像

> ID：910765
> 
> 赞同：2
> 
> 时间：2009-05-26T13:46:18.277
> 
> 标签：apache-flex, image, forms, icons

我需要在表单中的标签左侧包含一个图标。如果图标是标签的一部分，它可能效果最好。在我看来，表单项在左侧的标签之前不能有任何东西，这周围有吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:08:22.557

如果您查看 formItem 的源代码，它有两个孩子。一个是标签，另一个是indicatorSkin。因此，如果不扩展 formItem 类或使用不同的东西（如 Grid 将提供类似的布局），就不可能添加图标/图像，但这显然不包括表单具有的任何功能（例如必填字段等。

查看这篇关于扩展 FormItem 以包含图像/图标的帖子。 [http://kennethsutherland.com/2009/05/27/formitem-adding-an-icon/](http://kennethsutherland.com/2009/05/27/formitem-adding-an-icon/)

我已经编辑了这篇文章，因为经过一番思考，我之前的回答是废话 :) 该博客文章将允许您将图像添加到 formItem。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:14:54.973

最好的办法是扩展 FormItem 类并添加一个属性，以便您可以指定要显示的图像。然后覆盖 commitProperties()、measure() 和 updateDisplayList() 来创建图标，分别设置组件的首选大小和定位图标。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-26T13:49:57.240

应该说这是一个 FLEX 问题

# forms - codeigniter 从数据库中填充表单

> ID：910785
> 
> 赞同：6
> 
> 时间：2009-05-26T13:49:42.077
> 
> 标签：forms, codeigniter

在控制器中，我有...

```
function update($id = null)
{
    $this->load->database();

    // more code

    $data = array();
    $data = $this->db->get_where(
            'users',
            array(
            'id' => $id
            )
        );
    $data = $data->result_array();
    $data = $data[0];

    // more code

    $this->load->view('update', $data);
} 
```

在视野中，我...

```
<h5>Username</h5>
<input type="text" name="username" value="<?php echo set_value('username'); ?>" size="50" />

<h5>Email</h5>
<input type="text" name="email" value="<?php echo set_value('email'); ?>" size="50" />

<h5>Email Confirmation</h5>
<input type="text" name="emailconf" value="<?php echo set_value('emailconf'); ?>" size="50" />

<h5>Password</h5>
<input type="text" name="password" value="<?php echo set_value('password'); ?>" size="50" />

<h5>Password Confirmation</h5>
<input type="text" name="passconf" value="<?php echo set_value('passconf'); ?>" size="50" /> 
```

set_value() 没有读取 $data

搜索值 =“”

在[http://codeigniter.com/forums/viewthread/103837/](http://codeigniter.com/forums/viewthread/103837/)

发帖人只使用了“”中“值=”之间的 set_value() 函数。

我想知道如何做同样的事情，但我无法让它工作。帮助？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-04-06T17:10:49.330

set_value 需要 2 个参数。字段名称和值。

你需要：

```
value="<?php echo set_value('username', $username); ?>" 
```

假设您正在传递 $data['username'] 等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T23:00:28.813

我认为您没有将值正确传递给视图。

在控制器中放置：

```
$data = $this->db->get_where(
        'users',
        array(
        'id' => $id
        )
    );
$data = $data->result_array();

$data['result'] = $data[0]; 
```

然后在视图内：

```
<h5>Password Confirmation</h5> <input type="text" name="passconf" value="<?php echo $result['passconf']; ?>" size="50" /> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T08:14:39.837

尝试这个：

控制器：

```
$data = array();
$data = $this->db->get_where(
        'users',
        array(
        'id' => $id
        )
    );
$data = $data->result_array();
$data['view_username'] = $data['username']; 
```

我没有使用 $date[0]，而是使用列名，但这是您的决定

看法：

```
<h5>Username</h5> <input type="text" name="username" value="<?=$view_username?>" size="50"/> 
```

`<?= =>`是 PHP 短标签，在 codeigniter 用户指南中了解它

问候，

西尔维奥

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-20T07:23:59.770

set_value() 旨在与 CI 表单验证一起使用。

首次加载表单时， set_value() 可以使用其第二个参数将字段填充为默认值。提交表单后，您可以再次显示该表单，并且该字段将填充提交的值，前提是已检查验证。

另请参阅[http://codeigniter.com/forums/viewthread/96617/](http://codeigniter.com/forums/viewthread/96617/) - set_value() 有一些文档没有说明的问题。

到目前为止适用于 CI 1.7.3。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-03-08T17:40:31.607

Try to assign default values to `$_POST` variable in your controller, e.g. `$_POST['email'] = 'email';`

# c# - C# Charting - 合理的大数据集和实时性

> ID：910790
> 
> 赞同：1
> 
> 时间：2009-05-26T13:50:06.443
> 
> 标签：c#, winforms, charts, real-time, large-data-volumes

我正在寻找一个 C# WinForms 图表组件，无论是商业的还是开源的，它可以处理相对较大的数据集，并且在图表呈现和更新方面具有合理的可扩展性。要显示的数据集数量约为 30。每个数据集每秒更新 15 到 20 次。为此将需要折线图组件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T13:53:34.267

我过去曾使用[ZedGraph](http://sourceforge.net/projects/zedgraph/)来制作具有大量历史的实时股票图表。

如果图表非常复杂，但发现它非常好并且易​​于扩展（作为开源）以执行您需要的任何自定义格式，它可能会有点慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:13:45.743

有几个图表控件来自

*   www.xceed.com
*   www.infragistics.com
*   www.teltrik.com

也许其中之一将满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T13:53:30.650

你试过[微软图表控件](http://www.microsoft.com/downloads/details.aspx?FamilyId=130F7986-BF49-4FE5-9CA8-910AE6EA442C&displaylang=en)吗？

# asp.net - 在 asp:label 上使用 ajaxToolkit CalendarExtender

> ID：910792
> 
> 赞同：0
> 
> 时间：2009-05-26T13:50:20.267
> 
> 标签：asp.net

我想在 asp:Label 上使用 ajaxToolkit:CalendarExtender。当我将 CalendarExtender 附加到标签时，出现错误：

> “AjaxControlToolkit.CalendarExtender”类型的扩展器控件无法扩展“System.Web.UI.WebControls.Label”类型的控件。

我希望有人知道一个快速技巧，允许我在标签中显示日期并允许单击该标签以触发/打开可能针对隐藏的 asp:TextBox 的 CalendarExtender ...如果可能的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:00:05.940

正如错误所述，日历扩展器默认只能扩展文本框控件。

查看[日历扩展器的 ASP.NET AJAX 控件工具包页面](http://www.asp.net/ajax/ajaxcontroltoolkit/Samples/Calendar/Calendar.aspx)，您应该能够使用`PopupButtonID`启用标签来触发日历弹出（您还需要添加文本框的取消隐藏）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T13:56:14.653

如果您有 AjaxControlToolkit 的源代码，您可以编辑 CalendarExtender.cs 然后更改

```
[TargetControlType(typeof(TextBox))] 
```

并放置标签（或控制，如果您只想拥有一个日历扩展器）。不知道这将如何影响 Extender 的一般行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-01T07:07:41.447

如何使用文本框然后禁用它

# php - 检测编码并使一切变为 UTF-8

> ID：910793
> 
> 赞同：326
> 
> 时间：2009-05-26T13:50:34.930
> 
> 标签：php, encoding, utf-8, character-encoding

我正在从各种 RSS 提要中读取大量文本并将它们插入到我的数据库中。

当然，提要中使用了几种不同的字符编码，例如 UTF-8 和 ISO 8859-1。

不幸的是，文本的编码有时会出现问题。例子：

1.  “Fußball”中的“ß”在我的数据库中应该如下所示：“ÂŸ”。如果是“ÂŸ”，则显示正确。

2.  有时，“Fußball”中的“ß”在我的数据库中看起来像这样：“ÃƒÂŸ”。然后它显示错误，当然。

3.  在其他情况下，“ß”被保存为“ß” - 所以没有任何变化。然后它也显示错误。

我能做些什么来避免情况 2 和 3？

如何使所有内容都使用相同的编码，最好是 UTF-8？什么时候必须使用`utf8_encode()`，什么时候必须使用`utf8_decode()`（很清楚效果是什么，但什么时候必须使用函数？），什么时候必须对输入不做任何事情？

如何使所有内容都使用相同的编码？也许与功能`mb_detect_encoding()`？我可以为此编写一个函数吗？所以我的问题是：

1.  如何找出文本使用的编码？
2.  如何将其转换为 UTF-8 - 无论旧编码是什么？

这样的功能会起作用吗？

```
function correct_encoding($text) {
    $current_encoding = mb_detect_encoding($text, 'auto');
    $text = iconv($current_encoding, 'UTF-8', $text);
    return $text;
} 
```

我已经测试过了，但它不起作用。它出什么问题了？

* * *

## 回答 #1

> 赞同：378
> 
> 时间：2010-08-13T18:49:01.750

如果应用`utf8_encode()`到已经是 UTF-8 的字符串，它将返回乱码的 UTF-8 输出。

我做了一个函数来解决所有这些问题。它被称为`Encoding::toUTF8()`。

您不需要知道字符串的编码是什么。它可以是 Latin1 ( [ISO 8859-1)](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)、[Windows-1252](https://en.wikipedia.org/wiki/Windows-1252)或 UTF-8，或者字符串可以混合使用它们。`Encoding::toUTF8()`将所有内容转换为 UTF-8。

我这样做是因为一项服务向我提供了一个混乱的数据源，将 UTF-8 和 Latin1 混合在同一个字符串中。

用法：

```
require_once('Encoding.php');
use \ForceUTF8\Encoding;  // It's namespaced now.

$utf8_string = Encoding::toUTF8($utf8_or_latin1_or_mixed_string);

$latin1_string = Encoding::toLatin1($utf8_or_latin1_or_mixed_string); 
```

下载：

[https://github.com/neitanod/forceutf8](https://github.com/neitanod/forceutf8)

我已经包含了另一个函数 ，`Encoding::fixUFT8()`它将修复每个看起来乱码的 UTF-8 字符串。

用法：

```
require_once('Encoding.php');
use \ForceUTF8\Encoding;  // It's namespaced now.

$utf8_string = Encoding::fixUTF8($garbled_utf8_string); 
```

例子：

```
echo Encoding::fixUTF8("FÃ©dÃ©ration Camerounaise de Football");
echo Encoding::fixUTF8("FÃÂ©dÃÂ©ration Camerounaise de Football");
echo Encoding::fixUTF8("FÃÂÃÂ©dÃÂÃÂ©ration Camerounaise de Football");
echo Encoding::fixUTF8("FÃÂ©dération Camerounaise de Football"); 
```

将输出：

```
Fédération Camerounaise de Football
Fédération Camerounaise de Football
Fédération Camerounaise de Football
Fédération Camerounaise de Football 
```

我已经将函数 ( `forceUTF8`) 转换为一个名为`Encoding`. 新功能是`Encoding::toUTF8()`。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-05-26T19:52:56.507

您首先必须检测使用了什么编码。当您解析 RSS 提要（可能通过 HTTP）时，您应该从[HTTP 标头字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)`charset`的参数中读取编码。如果不存在，则从[XML 处理指令](http://www.w3.org/TR/REC-xml/#dt-xmldecl)的属性中读取编码。如果这也缺少，[请使用规范中定义的 UTF-8](http://www.w3.org/TR/REC-xml/#charencoding)。[`Content-Type`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)`encoding`

* * *

**编辑**   这是我可能会做的：

我会使用[cURL](http://docs.php.net/curl)来发送和获取响应。这允许您设置特定的标头字段并获取响应标头。获取响应后，您必须解析 HTTP 响应并将其拆分为标头和正文。然后，标头应包含`Content-Type`包含 MIME 类型的标头字段和（希望）`charset`带有编码/字符集的参数。如果没有，我们将分析 XML PI 中是否存在`encoding`属性并从那里获取编码。如果这也缺失，XML 规范定义使用 UTF-8 作为编码。

```
$url = 'http://www.lr-online.de/storage/rss/rss/sport.xml';

$accept = array(
    'type' => array('application/rss+xml', 'application/xml', 'application/rdf+xml', 'text/xml'),
    'charset' => array_diff(mb_list_encodings(), array('pass', 'auto', 'wchar', 'byte2be', 'byte2le', 'byte4be', 'byte4le', 'BASE64', 'UUENCODE', 'HTML-ENTITIES', 'Quoted-Printable', '7bit', '8bit'))
);
$header = array(
    'Accept: '.implode(', ', $accept['type']),
    'Accept-Charset: '.implode(', ', $accept['charset']),
);
$encoding = null;
$curl = curl_init($url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_HEADER, true);
curl_setopt($curl, CURLOPT_HTTPHEADER, $header);
$response = curl_exec($curl);
if (!$response) {
    // error fetching the response
} else {
    $offset = strpos($response, "\r\n\r\n");
    $header = substr($response, 0, $offset);
    if (!$header || !preg_match('/^Content-Type:\s+([^;]+)(?:;\s*charset=(.*))?/im', $header, $match)) {
        // error parsing the response
    } else {
        if (!in_array(strtolower($match[1]), array_map('strtolower', $accept['type']))) {
            // type not accepted
        }
        $encoding = trim($match[2], '"\'');
    }
    if (!$encoding) {
        $body = substr($response, $offset + 4);
        if (preg_match('/^<\?xml\s+version=(?:"[^"]*"|\'[^\']*\')\s+encoding=("[^"]*"|\'[^\']*\')/s', $body, $match)) {
            $encoding = trim($match[1], '"\'');
        }
    }
    if (!$encoding) {
        $encoding = 'utf-8';
    } else {
        if (!in_array($encoding, array_map('strtolower', $accept['charset']))) {
            // encoding not accepted
        }
        if ($encoding != 'utf-8') {
            $body = mb_convert_encoding($body, 'utf-8', $encoding);
        }
    }
    $simpleXML = simplexml_load_string($body, null, LIBXML_NOERROR);
    if (!$simpleXML) {
        // parse error
    } else {
        echo $simpleXML->asXML();
    }
} 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-05-26T14:38:55.970

检测编码很困难。

`mb_detect_encoding`根据您通过它的一些候选人，通过猜测来工作。在某些编码中，某些字节序列是无效的，因此它可以区分各种候选者。不幸的是，有很多编码，其中相同的字节是有效的（但不同）。在这些情况下，无法确定编码；在这些情况下，您可以实现自己的逻辑来进行猜测。例如，来自日本网站的数据可能更有可能采用日语编码。

只要您只处理西欧语言，要考虑的三种主要编码是`utf-8`,`iso-8859-1`和`cp-1252`. 由于这些是许多平台的默认设置，因此它们也最有可能被错误地报告。例如。如果人们使用不同的编码，他们可能会坦率地说，否则他们的软件会经常崩溃。因此，一个好的策略是信任提供者，除非编码被报告为这三者之一。您仍然应该仔细检查它是否确实有效，使用`mb_check_encoding`（请注意，*有效*与*存在*不同- 相同的输入可能对许多编码有效）。如果它是其中之一，则可以使用`mb_detect_encoding`来区分它们。幸运的是，这是相当确定的；您只需要使用正确的检测序列，即`UTF-8,ISO-8859-1,WINDOWS-1252`.

一旦您检测到编码，您需要将其转换为您的内部表示（`UTF-8`这是唯一明智的选择）。该函数`utf8_encode`转换`ISO-8859-1`为`UTF-8`，因此它只能用于该特定输入类型。对于其他编码，请使用`mb_convert_encoding`.

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-06-09T14:54:40.793

此备忘单列出了一些与 PHP 中的 UTF-8 处理相关的常见警告： [http://developer.loftdigital.com/blog/php-utf-8-cheatsheet](http://developer.loftdigital.com/blog/php-utf-8-cheatsheet)

此函数检测字符串中的多字节字符也可能很有帮助（[来源](http://www.unspecifiederror.net/2008/09/11/detecting-utf8-in-php-without-multibyte/)）：

```
 function detectUTF8($string)
{
    return preg_match('%(?:
        [\xC2-\xDF][\x80-\xBF]             # non-overlong 2-byte
        |\xE0[\xA0-\xBF][\x80-\xBF]        # excluding overlongs
        |[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2} # straight 3-byte
        |\xED[\x80-\x9F][\x80-\xBF]        # excluding surrogates
        |\xF0[\x90-\xBF][\x80-\xBF]{2}     # planes 1-3
        |[\xF1-\xF3][\x80-\xBF]{3}         # planes 4-15
        |\xF4[\x80-\x8F][\x80-\xBF]{2}     # plane 16
        )+%xs', 
    $string);
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-08-13T18:23:12.920

可以在[php.net](http://php.net/manual/en/function.utf8-encode.php#82210)上找到一个*非常*好的实现-function 的方法：`isUTF8`

```
function isUTF8($string) {
    return (utf8_encode(utf8_decode($string)) == $string);
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-06-27T16:12:12.590

有点抬头。您说“ß”应在数据库中显示为“ÂŸ”。

这可能是因为您使用的是 Latin-1 字符编码的数据库，或者您的 PHP-MySQL 连接设置错误，也就是说，P 认为您的 MySQL 设置为使用 UTF-8，所以它以 UTF-8 发送数据, 但是你的 MySQL 认为 PHP 正在发送编码为 ISO 8859-1 的数据，所以它可能会再次尝试将你发送的数据编码为 UTF-8，从而导致这种麻烦。

看看*[mysql_set_charset](http://php.net/manual/en/function.mysql-set-charset.php)*。它可能会帮助你。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-04T10:07:44.863

您的编码看起来像您**两次**编码为 UTF-8 ；也就是说，从其他编码，到 UTF-8，然后再到 UTF-8。就好像您有 ISO 8859-1，从 ISO 8859-1 转换为 UTF-8，并将新字符串视为 ISO 8859-1 以再次转换为 UTF-8。

这是您所做的一些伪代码：

```
$inputstring = getFromUser();
$utf8string = iconv($current_encoding, 'utf-8', $inputstring);
$flawedstring = iconv($current_encoding, 'utf-8', $utf8string); 
```

你应该试试：

1.  `mb_detect_encoding()`使用或您喜欢使用的任何方式检测编码
2.  如果是 UTF-8，则转换为 ISO 8859-1，然后重复步骤 1
3.  最后，转换回 UTF-8

这是假设在“中间”转换中您使用了 ISO 8859-1。如果您使用的是 Windows-1252，则转换为 Windows-1252 (latin1)。原始源编码并不重要；您在有缺陷的第二次转换中使用的那个是。

这是我对发生的事情的猜测；要获得四个字节来代替一个扩展的 ASCII 字节，您几乎没有什么别的办法。

德语也使用[ISO 8859-2](https://en.wikipedia.org/wiki/ISO/IEC_8859-2)和[Windows-1250](https://en.wikipedia.org/wiki/Windows-1250) (Latin-2)。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-03-11T17:58:32.557

有趣的`mb_detect_encoding`是`mb_convert_encoding`，您建议的编码顺序确实很重要：

```
// $input is actually UTF-8

mb_detect_encoding($input, "UTF-8", "ISO-8859-9, UTF-8");
// ISO-8859-9 (WRONG!)

mb_detect_encoding($input, "UTF-8", "UTF-8, ISO-8859-9");
// UTF-8 (OK) 
```

因此，您可能希望在指定预期编码时使用特定顺序。不过，请记住，这并非万无一失。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-26T13:55:14.997

很简单：当你得到不是 UTF-8 的东西时，你必须把它*编码**成*UTF-8。

因此，当您获取某个符合 ISO 8859-1 的提要时，请通过`utf8_encode`.

但是，如果您要获取 UTF-8 提要，则无需执行任何操作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-26T14:02:41.083

计算 RSS 提要的字符编码似乎很[复杂](http://diveintomark.org/archives/2004/02/13/xml-media-types)。即使是普通的网页也经常忽略或谎报其编码。

因此，您可以尝试使用正确的方法来检测编码，然后回退到某种形式的自动检测（猜测）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-26T14:10:34.407

php.net/[`mb_detect_encoding`](http://www.php.net/manual/en/function.mb-detect-encoding.php)

```
echo mb_detect_encoding($str, "auto"); 
```

或者

```
echo mb_detect_encoding($str, "UTF-8, ASCII, ISO-8859-1"); 
```

我真的不知道结果是什么，但我建议您只使用一些不同编码的提要并尝试是否`mb_detect_encoding`有效。

**update**
auto 是“ASCII,JIS,UTF-8,EUC-JP,SJIS”的缩写。它返回检测到的字符集，您可以使用它通过[iconv](http://www.php.net/manual/en/function.iconv.php)将字符串转换为 utf-8 。

```
<?php
function convertToUTF8($str) {
    $enc = mb_detect_encoding($str);

    if ($enc && $enc != 'UTF-8') {
        return iconv($enc, 'UTF-8', $str);
    } else {
        return $str;
    }
}
?> 
```

我没有测试过，所以不能保证。也许有更简单的方法。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-05-23T05:52:59.887

我知道这是一个较老的问题，但我认为有用的答案永远不会受到伤害。我在桌面应用程序、SQLite 和 GET/POST 变量之间的编码存在问题。有些是 UTF-8，有些是 ASCII，当涉及到外来字符时，基本上一切都会搞砸。

这是我的解决方案。它会在处理之前的每个页面加载时清除您的 GET/POST/REQUEST（我省略了 cookie，但您可以根据需要添加它们）。它在标题中运行良好。如果 PHP 无法自动检测到源编码，它会抛出警告，所以这些警告会被 @'s 抑制。

```
//Convert everything in our vars to UTF-8 for playing nice with the database...
//Use some auto detection here to help us not double-encode...
//Suppress possible warnings with @'s for when encoding cannot be detected
try
{
    $process = array(&$_GET, &$_POST, &$_REQUEST);
    while (list($key, $val) = each($process)) {
        foreach ($val as $k => $v) {
            unset($process[$key][$k]);
            if (is_array($v)) {
                $process[$key][@mb_convert_encoding($k,'UTF-8','auto')] = $v;
                $process[] = &$process[$key][@mb_convert_encoding($k,'UTF-8','auto')];
            } else {
                $process[$key][@mb_convert_encoding($k,'UTF-8','auto')] = @mb_convert_encoding($v,'UTF-8','auto');
            }
        }
    }
    unset($process);
}
catch(Exception $ex){} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-07-26T22:21:58.837

@harpax 对我有用。就我而言，这已经足够了：

```
if (isUTF8($str)) { 
    echo $str; 
}
else
{
    echo iconv("ISO-8859-1", "UTF-8//TRANSLIT", $str);
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-12-01T00:15:08.350

我一直在寻找编码的解决方案*，*这个页面可能是多年搜索的结论！我测试了您提到的一些建议，这是我的笔记：

这是我的测试字符串：

> 这是一个“wròng wrìtten”字符串，但我需要 pù 'sòme' 特殊字符才能看到它们，由 fùnctìon 转换！！＆ 就是这样！

我执行 INSERT 将此字符串保存在数据库中设置为的字段中`utf8_general_ci`

我的页面的字符集是 UTF-8。

如果我像这样进行 INSERT，在我的数据库中，我有一些字符可能来自火星......

所以我需要将它们转换成一些“理智的”UTF-8。我试过`utf8_encode()`了，但外星人仍然在入侵我的数据库......

所以我尝试使用`forceUTF8`8 号发布的函数，但在数据库中保存的字符串如下所示：

> 这是一个“wrÃ²ng wrÃ¬tten”字符串 bÃ¹t 我不需要 pÃ¹ 'sÃ²me' 特殊字符才能看到 thÃ¨m，由 fÃ¹nctÃ¬on 转换！＆ 就是这样！

因此，在此页面上收集更多信息并将它们与其他页面上的其他信息合并，我用这个解决方案解决了我的问题：

```
$finallyIDidIt = mb_convert_encoding(
  $string,
  mysql_client_encoding($resourceID),
  mb_detect_encoding($string)
); 
```

现在在我的数据库中，我的字符串具有正确的编码。

**注意：** 只有注意要注意的是功能`mysql_client_encoding`！您需要连接到数据库，因为此函数需要一个资源 ID 作为参数。

但是，我只是在我的 INSERT 之前进行重新编码，所以对我来说这不是问题。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-12-16T16:46:49.060

您需要测试输入的字符集，因为响应可以使用不同的编码进行编码。

我通过使用以下函数进行检测和翻译来强制将所有内容发送到 UTF-8：

```
function fixRequestCharset()
{
  $ref = array(&$_GET, &$_POST, &$_REQUEST);
  foreach ($ref as &$var)
  {
    foreach ($var as $key => $val)
    {
      $encoding = mb_detect_encoding($var[$key], mb_detect_order(), true);
      if (!$encoding)
        continue;
      if (strcasecmp($encoding, 'UTF-8') != 0)
      {
        $encoding = iconv($encoding, 'UTF-8', $var[$key]);
        if ($encoding === false)
          continue;
        $var[$key] = $encoding;
      }
    }
  }
} 
```

该例程会将来自远程主机的所有 PHP 变量转换为 UTF-8。

如果无法检测或转换编码，则忽略该值。

您可以根据自己的需要对其进行自定义。

只需在使用变量之前调用它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-01-18T19:31:55.927

整理好你的 php 脚本后，别忘了告诉 mysql 你正在传递什么字符集并希望接收。

示例：设置字符集 utf8

在 latin1 I/O 会话中将 utf8 数据传递给 latin1 表会产生那些讨厌的鸟脚。我每隔一天就会在 oscommerce 商店看到这个。回来和第四似乎是正确的。但是 phpmyadmin 会显示真相。通过告诉 mysql 你传递什么字符集，它将为你处理 mysql 数据的转换。

如何恢复现有的乱码mysql数据是另一个要讨论的话题。:)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-02-22T18:47:30.817

此版本适用于德语，但您可以修改 $CHARSETS 和 $TESTCHARS

```
class CharsetDetector
{
private static $CHARSETS = array(
"ISO_8859-1",
"ISO_8859-15",
"CP850"
);
private static $TESTCHARS = array(
"€",
"ä",
"Ä",
"ö",
"Ö",
"ü",
"Ü",
"ß"
);
public static function convert($string)
{
    return self::__iconv($string, self::getCharset($string));
}
public static function getCharset($string)
{
    $normalized = self::__normalize($string);
    if(!strlen($normalized))return "UTF-8";
    $best = "UTF-8";
    $charcountbest = 0;
    foreach (self::$CHARSETS as $charset) {
        $str = self::__iconv($normalized, $charset);
        $charcount = 0;
        $stop   = mb_strlen( $str, "UTF-8");

        for( $idx = 0; $idx < $stop; $idx++)
        {
            $char = mb_substr( $str, $idx, 1, "UTF-8");
            foreach (self::$TESTCHARS as $testchar) {

                if($char == $testchar)
                {

                    $charcount++;
                    break;
                }
            }
        }
        if($charcount>$charcountbest)
        {
            $charcountbest=$charcount;
            $best=$charset;
        }
        //echo $text."<br />";
    }
    return $best;
}
private static function __normalize($str)
{

$len = strlen($str);
$ret = "";
for($i = 0; $i < $len; $i++){
    $c = ord($str[$i]);
    if ($c > 128) {
        if (($c > 247)) $ret .=$str[$i];
        elseif ($c > 239) $bytes = 4;
        elseif ($c > 223) $bytes = 3;
        elseif ($c > 191) $bytes = 2;
        else $ret .=$str[$i];
        if (($i + $bytes) > $len) $ret .=$str[$i];
        $ret2=$str[$i];
        while ($bytes > 1) {
            $i++;
            $b = ord($str[$i]);
            if ($b < 128 || $b > 191) {$ret .=$ret2; $ret2=""; $i+=$bytes-1;$bytes=1; break;}
            else $ret2.=$str[$i];
            $bytes--;
        }
    }
}
return $ret; 
}
private static function __iconv($string, $charset)
{
    return iconv ( $charset, "UTF-8" , $string );
}
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-02-01T09:20:41.540

从标头获取编码并将其转换为 utf-8。

```
$post_url='http://website.domain';

/// Get headers ////////////////////////////////////////////////////////////
function get_headers_curl($url) 
{ 
    $ch = curl_init(); 

    curl_setopt($ch, CURLOPT_URL,            $url); 
    curl_setopt($ch, CURLOPT_HEADER,         true); 
    curl_setopt($ch, CURLOPT_NOBODY,         true); 
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
    curl_setopt($ch, CURLOPT_TIMEOUT,        15); 

    $r = curl_exec($ch); 
    return $r; 
}
$the_header = get_headers_curl($post_url);
/// check for redirect /////////////////////////////////////////////////
if (preg_match("/Location:/i", $the_header)) {
    $arr = explode('Location:', $the_header);
    $location = $arr[1];

    $location=explode(chr(10), $location);
    $location = $location[0];

$the_header = get_headers_curl(trim($location));
}
/// Get charset /////////////////////////////////////////////////////////////////////
if (preg_match("/charset=/i", $the_header)) {
    $arr = explode('charset=', $the_header);
    $charset = $arr[1];

    $charset=explode(chr(10), $charset);
    $charset = $charset[0];
    }
///////////////////////////////////////////////////////////////////////////////
// echo $charset;

if($charset && $charset!='UTF-8') { $html = iconv($charset, "UTF-8", $html); } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-08-19T18:46:58.410

`ÂŸ`是 Mojibake 的`ß`。在您的数据库中，您可能有十六进制

```
DF if the column is "latin1",
C39F if the column is utf8 -- OR -- it is latin1, but "double-encoded"
C383C5B8 if double-encoded into a utf8 column 
```

你不应该*在*PHP 中使用任何编码/解码函数；相反，您应该正确设置数据库及其连接。

如果涉及 MySQL，请参阅：[Trouble with utf8 characters；我看到的不是我存储的](https://stackoverflow.com/questions/38363566/trouble-with-utf8-characters-what-i-see-is-not-what-i-stored/)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-12-13T15:05:09.327

我在这里找到解决方案[http://deer.org.ua/2009/10/06/1/](http://deer.org.ua/2009/10/06/1/)

```
class Encoding
{
    /**
     * http://deer.org.ua/2009/10/06/1/
     * @param $string
     * @return null
     */
    public static function detect_encoding($string)
    {
        static $list = ['utf-8', 'windows-1251'];

        foreach ($list as $item) {
            try {
                $sample = iconv($item, $item, $string);
            } catch (\Exception $e) {
                continue;
            }
            if (md5($sample) == md5($string)) {
                return $item;
            }
        }
        return null;
    }
}

$content = file_get_contents($file['tmp_name']);
$encoding = Encoding::detect_encoding($content);
if ($encoding != 'utf-8') {
    $result = iconv($encoding, 'utf-8', $content);
} else {
    $result = $content;
} 
```

我认为*@*是错误的决定，并从 deer.org.ua 对解决方案进行一些更改；

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-06-29T03:51:00.597

投票最多的答案不起作用。这是我的，希望对您有所帮助。

```
function toUTF8($raw) {
    try{
        return mb_convert_encoding($raw, "UTF-8", "auto"); 
    }catch(\Exception $e){
        return mb_convert_encoding($raw, "UTF-8", "GBK"); 
    }
} 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2011-09-14T23:29:02.000

当您尝试处理日语和韩语等多种语言时，您可能会遇到麻烦。带有 'auto' 参数的 mb_convert_encoding 不能正常工作。设置 mb_detect_order('ASCII,UTF-8,JIS,EUC-JP,SJIS,EUC-KR,UHC') 没有帮助，因为它会错误地检测到 EUC-*。

我得出的结论是，只要输入字符串来自 HTML，它就应该在元元素中使用“字符集”。我使用[Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/)因为它支持无效的 HTML。

下面的代码片段从网页中提取标题元素。如果您想转换整个页面，那么您可能需要删除一些行。

```
<?php
require_once 'simple_html_dom.php';

echo convert_title_to_utf8(file_get_contents($argv[1])), PHP_EOL;

function convert_title_to_utf8($contents)
{
    $dom = str_get_html($contents);
    $title = $dom->find('title', 0);
    if (empty($title)) {
        return null;
    }
    $title = $title->plaintext;
    $metas = $dom->find('meta');
    $charset = 'auto';
    foreach ($metas as $meta) {
        if (!empty($meta->charset)) { // html5
            $charset = $meta->charset;
        } else if (preg_match('@charset=(.+)@', $meta->content, $match)) {
            $charset = $match[1];
        }
    }
    if (!in_array(strtolower($charset), array_map('strtolower', mb_list_encodings()))) {
        $charset = 'auto';
    }
    return mb_convert_encoding($title, 'UTF-8', $charset);
} 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-07-15T20:19:12.320

**我对phpQuery**（*ISO-8859-1*而不是*UTF-8* ）有同样的问题，这个黑客帮助了我：

```
$html = '<?xml version="1.0" encoding="UTF-8" ?>' . $html; 
```

`mb_internal_encoding('UTF-8')`, `phpQuery::newDocumentHTML($html, 'utf-8')`,`mbstring.internal_encoding`和其他操作没有产生任何效果。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2017-07-22T08:55:34.333

尝试不使用“自动”

那是：

```
mb_detect_encoding($text) 
```

代替：

```
mb_detect_encoding($text, 'auto') 
```

更多信息可以在这里找到：[mb_detect_encoding](http://php.net/manual/en/function.mb-detect-encoding.php)

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2021-04-22T23:09:06.267

尝试使用它...所有不是 UTF-8 的文本都将被翻译。

```
function is_utf8($str) {
    return (bool) preg_match('//u', $str);
}

$myString = "Fußball";

if(!is_utf8($myString)){
    $myString = utf8_encode($myString);
}

// or 1 line version ;) 
$myString = !is_utf8($myString) ? utf8_encode($myString) : trim($myString); 
```

# c# - 为什么这个存储过程在 Management Studio 中执行得很快，而在应用程序中却没有？

> ID：910796
> 
> 赞同：1
> 
> 时间：2009-05-26T13:50:49.937
> 
> 标签：c#, strongly-typed-dataset, sql-server-2005-express

我将此查询作为存储过程：

```
SELECT     ID
    FROM         dbo.tblRentalUnit
    WHERE     (NOT EXISTS
        (SELECT     1 AS Expr1
        FROM          dbo.tblTenant
        WHERE      (dbo.tblRentalUnit.ID = UnitID))) 
```

在 Microsoft SQL Server Management Studio Express 中，它在 16 毫秒内执行。当我将它放在 Visual Studio 2008 自动生成的类型化数据集中时，它的执行时间为 64,453 毫秒。超过一分钟。

估计和执行计划是这样的：

```
选择 [0%] <- 过滤 [1%] <- 合并连接（左外连接）[28%] <- 索引扫描 [16%]
                                                                 <- 排序 [43%] <- 聚集索引扫描 [12%]

```

为什么这里有这种差异，我该如何纠正？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:03:09.817

这听起来像是一个错误缓存的查询计划。

您的索引和统计数据是最新的吗？

顺便说一句，如果 tblTenant.UnitId 是 tblRentalUnit.ID 的外键，那么您的查询可以重写为：

```
SELECT ru.ID    
FROM         
    dbo.tblRentalUnit ru
    LEFT JOIN dbo.tblTenant t ON ru.ID = t.UnitID
WHERE
    t.UnitID IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:07:31.493

您是否在每次测试之前（从任一客户端）刷新缓冲区？确保在每个测试之间执行 DBCC DROPCLEANBUFFERS 和 DBCC FREEPROCCACHE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:19:46.743

tblRentalUnit.ID 是否正确编入索引？

# ms-access - 如何检查子窗体是否在 ms 访问中打开

> ID：910803
> 
> 赞同：1
> 
> 时间：2009-05-26T13:51:53.960
> 
> 标签：ms-access

我有一个主窗体 MYMAIN，其中有两个子窗体 MYSUBONE 和 MYSUBTWO。

我在每个子表单中都有“当前”事件，更新另一个子表单中的文本框。

我的问题是在加载表单时出现的。当子窗体“MYSUBONE”被加载（在“MYSUBTWO”被加载之前）并且它试图更新 MYSUBTWO 中尚未加载的文本框时，会触发“on current”事件。所以在事件过程中会触发错误。

如何检查 MYSUBONE 的“当前”事件过程（在 VBA 中？）以检查 MYSUBTWO 子表单是否尚未加载。

on-current-mysubone 如果未加载 mysubtwo 则更新 mysubtwo.textbox = ... end if

我在示例数据库“Northwind”中尝试了“Isloaded”函数，但似乎不起作用。如何检查子表单是否尚未加载？

或者我可以忽略错误并使用“如果错误，退出函数”之类的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T15:49:36.827

解决此问题的一种可能方法是确保您知道加载子表单的顺序。您可以通过取消绑定子表单控件然后手动加载它们来完成此操作。这是如何做到的：

1.  像往常一样将子窗体控件添加到父窗体。
2.  确保你有你的链接字段等。设置你想要的方式。
3.  在子表单属性>数据选项卡中，删除“源对象”字段中的值。

添加 VBA 以在父窗体打开时手动绑定控件：

```
Private Sub Form_Open(Cancel As Integer)
    Me.sfB.SourceObject = "FormB"
    Me.sfA.SourceObject = "FormA"
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:55:30.320

子窗体实际上是在主窗体打开之前打开的（包括它们的所有 OnCurrent 事件）。我认为您也不能保证它们的加载顺序。

我会解决问题并从主窗体进行更新。如果您确实必须从子窗体进行更新，请将更新移动到`MySubOne`. 然后在主窗体的 OnCurrent 中，调用`MySubOne`. 这将保证两者`MySubOne`都已`MySubTwo`加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-09T01:29:18.233

不知道它是否有用，但有什么价值......我正在显示两个具有父子关系的网格。但是，第二个网格会同时显示与第一个网格中的所有父记录关联的所有子记录。当在第一个网格中选择一个记录时，我想在第二个网格中找到第一个相应的子记录。在最初打开主窗体时，我遇到了与第二个网格（子窗体）记录集的引用失败相同的麻烦，因为第二个网格尚未显示。我的解决方法包括捕获错误 2455 并忽略它，因此它有机会继续，直到第二个网格完全显示。

```
Private Sub Form_Current()
Dim rsResults As Recordset
Dim stFilter As String

On Error GoTo ErrHdlr

'Locate first results record associated to current requisition
Set rsResults = Me.Parent.sfResults.Form.Recordset
stFilter = obRecord.GetFilter(Me.Recordset, vrPKFields, vrPKTypes)
rsResults.FindFirst (stFilter)

Exit Sub

ErrHdlr:
If Err.Number = 2455 Then
   Exit Sub 'When this sub form is first displayed, Current event
               'tries to reference another subform on the same parent.
               'However, such second subform is not yet open and
               'reference fails. This is the error number raised,
               'so it is ignored on purpose. After second subform
               'is displayed, code works correctly.
               'It had to be handled this way because there's no way
               'to know in advance whether subform is already open.
Else
   msgbox Err.number & " " & err.description
endif
exit sub 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-11-24T02:25:20.223

“有没有办法检查检索到的子表单记录数是否为 0”

```
if forms!myMainForm!mySubForm.form.RecordsetClone.RecordCount = 0 then.... 
```

# python - 如何在python中显示非ascii字符？

> ID：910809
> 
> 赞同：0
> 
> 时间：2009-05-26T13:53:18.810
> 
> 标签：python, urllib2

我以这种方式使用 Python Shell：

```
>>> s = 'Ã'
>>> s
'\xc3' 
```

如何打印 s 变量以显示字符 Ã??? 这是第一个也是最简单的问题。真的，我从一个网页中获取内容，该网页包含非 ascii 字符（如前一个字符）和其他带有波浪号（如 á、é、í、ñ 等）的网页。此外，我正在尝试使用这些字符执行正则表达式针对网页内容的模式表达。

这个问题怎么解决？？

这是一个正则表达式的示例：

```
u'<td[^>]*>\s*Definición\s*</td><td class="value"[^>]*>\s*(?P<data>[\w ,-:\.\(\)]+)\s*</td>' 
```

如果我使用 Expresson 应用程序工作正常。

编辑[05/26/2009 16:38]：对不起，关于我的解释。我会尽力解释得更好。

我必须从页面中获取一些文本。我有该页面的网址，并且我有正则表达式来获取该文本。我首先想到的是正则表达式是错误的。我用 Expresso 检查了它并且工作正常，我得到了我想要的文本。所以，我想到的第二件事是打印页面的内容，那是当我看到内容不是我在网页源代码中看到的内容时。区别在于非 ascii 字符，如 á、é、í 等。现在，我不知道我必须做什么以及问题出在页面内容的编码中还是在正则表达式的模式文本中。我定义的正则表达式之一是前一个。

问题将是：使用正则表达式是否有任何问题，其中模式文本具有非 ascii 字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:06:47.673

**如何打印 s 变量以显示字符 Ã???**
使用`print`：

```
>>> s = 'Ã'
>>> s
'\xc3'
>>> print s
Ã 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:41:53.333

假设您要将其打印为 utf-8。在python 3之前，最好是专门编码

```
print u'Ã'.encode('utf-8') 
```

如果您从外部获取文本，则必须专门 decode('utf-8) 例如

```
f = open(my_file)
a = f.next().decode('utf-8') # you have a unicode line in a
print a.encode('utf-8') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:07:17.360

我会用它`ord()`来找出一个字符是否是 ASCII/特殊字符：

```
if ord(c) > 127:
    # special character 
```

这可能不适用于 UTF-8 等多字节编码。在这种情况下，我会在测试之前转换为 Unicode。

如果您从网页中获取特殊字符，您应该知道编码。然后对其进行解码，请参阅[Unicode HOWTO](http://docs.python.org/howto/unicode.html)。

编辑：我绝对不确定这个问题是关于什么的......澄清它可能是个好主意。

# c# - 在运行时加载 XAML？

> ID：910814
> 
> 赞同：48
> 
> 时间：2009-05-26T13:53:54.750
> 
> 标签：c#, wpf, xaml

首先是一些背景：我正在开发一个应用程序，并且我正在尝试遵循 MVVM 约定来编写它。我想做的一件事是能够为我的应用程序赋予不同的“皮肤”。相同的应用程序，但为一个客户显示一个“皮肤”，为另一个客户显示不同的“皮肤”。

所以我的问题是：
1\. 是否可以在运行时加载 xaml 文件并将其“分配”给我的应用程序？
2\. xaml 文件可以是驻留在不同文件夹中的外部文件吗？
3\. 应用程序是否可以轻松切换到另一个 xaml 文件，或者仅在启动时切换？

那么我应该从哪里开始寻找这方面的信息呢？哪些 WPF 方法（如果存在）处理此功能？

谢谢！

编辑：我想要做的“剥皮”类型不仅仅是改变我的控件的外观。这个想法是拥有一个完全不同的用户界面。不同的按钮，不同的布局。有点像一个版本的应用程序如何为专家提供完整的功能，而另一个版本为初学者简化。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-26T15:15:36.350

正如 Jakob Christensen 所说，您可以使用`XamlReader.Load`. 这不仅适用于样式，也适用于`UIElement`s。您只需像这样加载 XAML：

```
UIElement rootElement;
FileStream s = new FileStream(fileName, FileMode.Open);
rootElement = (UIElement)XamlReader.Load(s);
s.Close(); 
```

然后您可以将其设置为合适元素的内容，例如

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Foo Bar">
    <Grid x:Name="layoutGrid">
        <!-- any static elements you might have -->
    </Grid>
</Window> 
```

您可以`rootElement`在其中添加`grid`：

```
layoutGrid.Children.Add(rootElement);
layoutGrid.SetColumn(rootElement, COLUMN);
layoutGrid.SetRow(rootElement, ROW); 
```

您自然还必须`rootElement`在代码隐藏中手动连接内部元素的任何事件。例如，假设您`rootElement`包含 a`Canvas`和一堆`Path`s，您可以像这样分配`Path`s'`MouseLeftButtonDown`事件：

```
Canvas canvas = (Canvas)LogicalTreeHelper.FindLogicalNode(rootElement, "canvas1");
foreach (UIElement ui in LogicalTreeHelper.GetChildren(canvas)) {
    System.Windows.Shapes.Path path = ui as System.Windows.Shapes.Path;
    if (path != null) {
        path.MouseLeftButtonDown += this.LeftButtonDown;
    }
} 
```

我没有尝试过动态切换 XAML 文件，所以我不能说这是否真的有效。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-26T14:59:02.530

我认为这对于 XamlReader 来说相当简单，试一试，我自己没有尝试过，但我认为它应该可以工作。

[http://blogs.msdn.com/ashish/archive/2007/08/14/dynamically-loading-xaml.aspx](http://blogs.msdn.com/ashish/archive/2007/08/14/dynamically-loading-xaml.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-30T10:55:04.580

我做了简单的标记扩展，它加载 xaml：

```
public class DynamicXamlLoader : MarkupExtension
{
    public DynamicXamlLoader() { }

    public DynamicXamlLoader(string xamlFileName)
    {
        XamlFileName = xamlFileName;
    }

    public string XamlFileName { get; set; }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        var provideValue = serviceProvider.GetService(typeof(IProvideValueTarget)) as IProvideValueTarget;
        if (provideValue == null || provideValue.TargetObject == null) return null;

        // get target
        var targetObject = provideValue.TargetObject as UIElement;
        if (targetObject == null) return null;

        // get xaml file
        var xamlFile = new DirectoryInfo(Directory.GetCurrentDirectory())
            .GetFiles(XamlFileName ?? GenerateXamlName(targetObject), SearchOption.AllDirectories)
            .FirstOrDefault();

        if (xamlFile == null) return null;

        // load xaml
        using (var reader = new StreamReader(xamlFile.FullName))
            return XamlReader.Load(reader.BaseStream) as UIElement;
    }

    private static string GenerateXamlName(UIElement targetObject)
    {
        return string.Concat(targetObject.GetType().Name, ".xaml");
    }
} 
```

用法：

这会查找并加载 MyFirstView.xaml 文件

```
<ContentControl Content="{wpf:DynamicXamlLoader XamlFileName=MyFirstView.xaml}" /> 
```

这填充了整个 UserControl（查找并加载 MySecondView.xaml 文件）

```
<UserControl x:Class="MySecondView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         Content="{wpf:DynamicXamlLoader}" /> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-26T14:41:13.937

您可以使用[XamlReader.Load](http://msdn.microsoft.com/en-us/library/cc190359(VS.95).aspx)加载所需的任何 XAML 。

如果您在应用程序中设置所有控件的样式并在应用程序资源字典中定义这些样式，则可以使用 XamlReader.Load 在其他地方加载在 XAML 中定义的新样式，并用加载的 XAML 替换部分资源字典。您的控件将相应地更改外观。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-05-30T09:30:03.920

我已经在运行时加载了 XAML，这是一个简短的示例

```
Grid grd = new Grid();
var grdEncoding = new ASCIIEncoding();
var grdBytes = grdEncoding.GetBytes(myXAML);
grd = (Grid)XamlReader.Load(new MemoryStream(grdBytes));
Grid.SetColumn(grd, 0);
Grid.SetRow(grd, 0);
parentGrid.Children.Add(grd);

private String myXAML = @" <Grid xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' Margin='30 10 30 65' VerticalAlignment='Bottom'>" +
                    "<Label Content='Date: 1-Feb-2013' FontFamily='Arial' FontSize='12' Foreground='#666666' HorizontalAlignment='Left'/>" +
                    "<Label Content='4'  FontFamily='Arial' FontSize='12' Foreground='#666666' HorizontalAlignment='Center'/>" +
                    "<Label Content='Hello World'  FontFamily='Arial' FontSize='12' Foreground='#666666' HorizontalAlignment='Right'/>" +
                "</Grid>"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-02T21:01:09.947

正如其他答案中已经提到的那样，您可以使用[`XamlReader.Load`](https://msdn.microsoft.com/en-us/library/ms590398.aspx).

如果您正在寻找一个更直接的示例，下面是一个示例，显示您可以轻松地从包含 XAML 的字符串变量创建控件：

```
public T LoadXaml<T>(string xaml)
{
    using (var stringReader = new System.IO.StringReader(xaml))
    using (var xmlReader = System.Xml.XmlReader.Create(stringReader))
        return (T)System.Windows.Markup.XamlReader.Load(xmlReader);
} 
```

并作为用法：

```
var xaml = "<TextBox xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation\'>" +
            "Lorm ipsum dolor sit amet." +
            "</TextBox>";
var textBox = LoadXaml<System.Windows.Controls.TextBox>(xaml); 
```

# html - 工具提示 - 标题在 IE 6 中不起作用

> ID：910815
> 
> 赞同：1
> 
> 时间：2009-05-26T13:54:18.900
> 
> 标签：html, css, xhtml, dhtml

我正在使用一个下拉菜单，其宽度为 100 像素。但是该下拉列表中的内容远不止这些 - 它对用户不可见，所以我选择标题（HTML 中的工具提示）。它在 IE 6 中不起作用。

这个.. mouseover 事件的替代方法是什么也不起作用。请帮助并澄清错误

```
<select>
    <option>-</option>
    <option  title="Alpha">a</option>
    <option  title="Beta">b</option>
    <option  title="Complex">c</option>
    <option  title="Durpal">d</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:57:17.333

我认为 IE 用于该目的的属性是“alt”而不是“title”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:00:10.650

听起来您在说的是您的选择中有一些选项，其文本溢出选择的边缘。如果是这种情况，实际上并没有一种简单的方法来修复它（除了增加下拉列表的大小）。您可能想要查看将模拟下拉列表的第三方组件。使用其中之一，下拉区域不会与选择元素绑定，因此该区域可以更大。

请参阅此示例

[http://jquery.sanchezsalvador.com/samples/example.htm](http://jquery.sanchezsalvador.com/samples/example.htm)

# .net - 用于 OS X 的 Mono 对专业的 .NET 开发人员有好处吗？

> ID：910817
> 
> 赞同：12
> 
> 时间：2009-05-26T13:55:19.723
> 
> 标签：.net, macos, mono

作为一名专业的 .net 开发人员（至少这是我赚钱的方式），我想知道 Mono for Mac 是否值得仔细研究。我在 3 年前第一次拿到 iMac 时已经尝试过 Mono，但安装无法掌握，半天后我就放弃了。我还从 Unix 专业人士那里得到了帮助，但我们都无法在我的 Mac 上运行 Mono。

就像我说的，那是几年前的事了。今天 OS X 的 Mono 状态如何？安装还疼吗？与 .NET Framework 2.0 的兼容性如何？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T14:12:47.427

如今，Mono 在性能和稳定性方面已经相当成熟。当前版本 Mono 2.4 具有 .NET 2.0 的完整实现，包括 ASP.NET。这也支持 C# 3.0 和 .NET 3.5 的几乎所有 API，是的，它也支持 ASP.NET MVC。我对 Mac 和 Mono 的体验非常积极，包括开发环境。我更喜欢使用 Textmate + Compiler，但有一个很好的 IDE：MonoDevelop。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T13:58:05.443

设置它非常容易。它比 3 年前成熟得多，但您仍然应该考虑使用 Mono 存在问题的库。我的意思是，您应该测试应用程序，而不是盲目地假设它与 Mono 兼容。

从开发人员的角度来看，MonoDevelop 几乎无法与 Visual Studio Express 的一半竞争。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:16:49.977

如果您想知道您的应用程序是否会在 Mono 上运行，有一个名为[MoMA](http://www.mono-project.com/MoMA)的应用程序可以分析您的代码并告诉您可能在哪里出现问题。

# svn - Subversion 没有正确更新工作副本

> ID：910818
> 
> 赞同：3
> 
> 时间：2009-05-26T13:55:29.583
> 
> 标签：svn

周末，另一位程序员向项目添加了一个文件并将其提交到存储库。今天，我在 repo 上运行了更新，但文件没有被拉到我的工作副本中。

我能够删除目录并运行更新以再次从目录中获取所有文件，但这让我担心某些文件没有从 repo 中删除。

关于为什么会发生这种情况的任何想法？我使用的是 HEAD 版本，这个目录的版本号是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:58:49.017

存储库可能在没有“完全递归”的情况下被签出，它只更新工作副本。

您可以尝试执行“更新到修订版”功能，并指定更新深度应该是完全递归的。

# asp.net - spring.net 是否递归子目录？

> ID：910822
> 
> 赞同：0
> 
> 时间：2009-05-26T13:56:56.413
> 
> 标签：asp.net, ioc-container, spring.net

当 spring.net 框架为 asp.net 应用程序启动时，注册 IoC 容器中所有对象的组件是否递归 web.config 中引用的所有子目录？

例如。

```
<spring>
  <context>
    <resource uri="~/bin/ClientService/ClientService.config"/>
    <resource uri="~/MCFModule.config"/>
  </context>
</spring> 
```

我相信查看调试信息（跟踪侦听器）输出的答案是肯定的。

我看到的问题是，当它尝试在 '\bin\clientservice' 目录中创建实例时，即使 dll 存在于子目录中，它也会失败并显示错误消息；

'无法加载文件或程序集'log4net，Version=1.2.10.0，Culture=neutral，PublicKeyToken=1b44e1d426115821'或其依赖项之一。该系统找不到指定的文件。'

有人有任何想法吗？

干杯

奥利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-09T04:53:52.660

您还可以选择使用 [`AppDomain.AssemblyResolve`](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)AppDomain 类上的事件以编程方式处理程序集加载失败。

例如，您可以扫描所有子目录以查找您关心的程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:09:23.613

当 Spring.NET 尝试解析其配置文件中的引用时，它将使用与.NET 程序集加载器相同的[规则。](http://msdn.microsoft.com/en-us/library/yx7xezcf(VS.71).aspx)因此，也许您可​​以尝试在您的 bin 文件夹中添加 log4net 程序集的正确引用。

* * *

编辑：如果您希望 Spring.NET 将程序集定位在非标准位置，您可以使用[<assemblyBinding>](http://msdn.microsoft.com/en-us/library/twy1dw1e.aspx)元素来指示位置：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <sectionGroup name="spring">
      <section name="context" type="Spring.Context.Support.ContextHandler, Spring.Core"/>
      <section name="objects" type="Spring.Context.Support.DefaultSectionHandler, Spring.Core" />
    </sectionGroup>
  </configSections>

  <spring>
    <context>
      <resource uri="config://spring/objects"/>
    </context>
    <objects xmlns="http://www.springframework.net">
      <object id="someObject" type="log4net.Util.AppenderAttachedImpl, log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821" />
    </objects>
  </spring>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="log4net"
                          publicKeyToken="1b44e1d426115821"
                          culture="neutral" />
        <codeBase version="1.2.10.0
                  href="file:///c:/some_special_location/log4net.dll" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>

</configuration> 
```

然后你可以让容器实例化对象：

```
var someObject = ContextRegistry.GetContext().GetObject("someObject"); 
```

# asp.net-mvc - 渲染一个在视图中返回局部视图的动作

> ID：910826
> 
> 赞同：1
> 
> 时间：2009-05-26T13:57:34.633
> 
> 标签：asp.net-mvc

假设我有一个操作，它返回一个呈现的 asp.net mvc 控件并将其作为 AJAX 请求的响应发送。

我希望在整个页面呈现在视图中期间对该操作的响应。

```
public class Controller
{
  ....

  public ActionResult AjaxAction(string parameter)
  {
    return PartialView("~/Views/Controls/Control.ascx",parameter);
  }
} 
```

现在鉴于呈现整个页面，我想要类似的东西：

```
<%var par = "1";%>
<%= AjaxAction(par) %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:20:04.043

根据您想要实现的[部分请求](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)可能对您有用。当您的控件是某种形式的“小部件”时，这通常很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:15:40.933

我会使用 jQuery 加载函数，在文档准备好时触发，并将部分视图加载到 div 中。

```
$(function() {
   $('#partialResult').load( '<%= Url.Action( "AjaxAction", "Controller", new { parameter = "1" } ) %>' );
}

 <div id="partialResult">
 </div> 
```

# asp.net - 如何在母版页的内容占位符中显示 aspx 页面

> ID：910828
> 
> 赞同：0
> 
> 时间：2009-05-26T13:57:57.677
> 
> 标签：asp.net

我的网站上有一个母版页。

我在该母版页上有两个内容占位符。在一个内容占位符中，我有一些链接，单击这些链接我想重定向到同一母版页上第二个内容占位符中的相应页面。

我怎样才能做到这一点....？

请帮忙..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:07:46.267

我想你可能在这里错过了一些东西。当您使用母版页时，您将使用内容页。内容页面定义母版页中内容占位符定义的区域。创建内容页面时，您可以使用 contentplaceholder 标签在母版页中显示页面内容。阅读ASP.NET 网站上的[母版页教程](http://www.asp.net/learn/master-pages/)可能是值得的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:01:52.100

我认为这里没有问题。只需使`.aspx`页面使用相同的母版页并将链接位置设置为`.aspx`页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:04:08.817

听起来，您将希望使用站点地图而不是第一个内容占位符。以下是对它们的描述：http: [//msdn.microsoft.com/en-us/library/yy2ykkab.aspx](http://msdn.microsoft.com/en-us/library/yy2ykkab.aspx)

# c++ - MC++ 中的 LogonUser 失败

> ID：910829
> 
> 赞同：0
> 
> 时间：2009-05-26T13:57:59.533
> 
> 标签：c++, visual-studio-2008, login

在与这个问题斗争了一周之后，我还没有真正了解为什么它在我的代码中不断失败，但在其他示例中却没有。我的代码在编译时不会登录到我知道具有正确登录信息的用户。它失败的地方是以下行：

```
wi = gcnew WindowsIdentity(token); 
```

它在这里失败，因为令牌为零，这意味着它从未设置为用户令牌。这是我的完整代码：

```
#ifndef UNCAPI_H
#define UNCAPI_H

#include <windows.h>

#pragma once
using namespace System;
using namespace System::Runtime::InteropServices;
using namespace System::Security::Principal;
using namespace System::Security::Permissions;

namespace UNCAPI
{
public ref class UNCAccess
{
public:
    //bool Logon(String ^_srUsername, String ^_srDomain, String ^_srPassword);
    [PermissionSetAttribute(SecurityAction::Demand, Name = "FullTrust")]
    bool Logon(String ^_srUsername, String ^_srDomain, String ^_srPassword)
    {
        bool bSuccess = false;
        token = IntPtr(0);
        bSuccess = LogonUser(_srUsername, _srDomain, _srPassword, 8, 0, &tokenHandle);

        if(bSuccess)
        {
            wi = gcnew WindowsIdentity(token);
            wic = wi->Impersonate();                
        }

        return bSuccess;
    }

    void UNCAccess::Logoff()
    {
        if (wic != nullptr )
        {
            wic->Undo();
        }

        CloseHandle((int*)token.ToPointer());           
    }
private:
    [DllImport("advapi32.dll", SetLastError=true)]//[DllImport("advapi32.DLL", EntryPoint="LogonUserW",  SetLastError=true, CharSet=CharSet::Unicode, ExactSpelling=true, CallingConvention=CallingConvention::StdCall)]
    bool static LogonUser(String ^lpszUsername, String ^lpszDomain, String ^lpszPassword, int dwLogonType, int dwLogonProvider, IntPtr *phToken);

    [DllImport("KERNEL32.DLL", EntryPoint="CloseHandle",  SetLastError=true, CharSet=CharSet::Unicode, ExactSpelling=true, CallingConvention=CallingConvention::StdCall)]
    bool static CloseHandle(int *handle);   
    IntPtr token;
    WindowsIdentity ^wi;
    WindowsImpersonationContext ^wic;
};// End of Class UNCAccess
}// End of Name Space

#endif UNCAPI_H 
```

现在使用微软的这个稍微修改过的例子，我能够获得一个登录名和一个令牌：

```
#using <mscorlib.dll>
#using <System.dll>
using namespace System;
using namespace System::Runtime::InteropServices;
using namespace System::Security::Principal;
using namespace System::Security::Permissions;

[assembly:SecurityPermissionAttribute(SecurityAction::RequestMinimum, UnmanagedCode=true)]
[assembly:PermissionSetAttribute(SecurityAction::RequestMinimum, Name = "FullTrust")];

[DllImport("advapi32.dll", SetLastError=true)]
bool LogonUser(String^ lpszUsername, String^ lpszDomain, String^ lpszPassword, int dwLogonType, int dwLogonProvider, IntPtr* phToken);

[DllImport("kernel32.dll", CharSet=System::Runtime::InteropServices::CharSet::Auto)]
int FormatMessage(int dwFlags, IntPtr* lpSource, int dwMessageId, int dwLanguageId, String^ lpBuffer, int nSize, IntPtr *Arguments);

[DllImport("kernel32.dll", CharSet=CharSet::Auto)]
bool CloseHandle(IntPtr handle);

[DllImport("advapi32.dll", CharSet=CharSet::Auto, SetLastError=true)]
bool DuplicateToken(IntPtr ExistingTokenHandle, int SECURITY_IMPERSONATION_LEVEL, IntPtr* DuplicateTokenHandle);

// GetErrorMessage formats and returns an error message
// corresponding to the input errorCode.
String^ GetErrorMessage(int errorCode)
{
    int FORMAT_MESSAGE_ALLOCATE_BUFFER = 0x00000100;
    int FORMAT_MESSAGE_IGNORE_INSERTS = 0x00000200;
    int FORMAT_MESSAGE_FROM_SYSTEM  = 0x00001000;

    //int errorCode = 0x5; //ERROR_ACCESS_DENIED
    //throw new System.ComponentModel.Win32Exception(errorCode);

    int messageSize = 255;
    String^ lpMsgBuf = "";
    int dwFlags = FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS;

    IntPtr ptrlpSource = IntPtr::Zero;
    IntPtr prtArguments = IntPtr::Zero;

    int retVal = FormatMessage(dwFlags, &ptrlpSource, errorCode, 0, lpMsgBuf, messageSize, &prtArguments);
    if (0 == retVal)
    {
        throw gcnew Exception(String::Format( "Failed to format message for error code {0}. ", errorCode));
    }

    return lpMsgBuf;
}

// Test harness.
// If you incorporate this code into a DLL, be sure to demand FullTrust.
[PermissionSetAttribute(SecurityAction::Demand, Name = "FullTrust")]
int main()
{    
    IntPtr tokenHandle = IntPtr(0);
    IntPtr dupeTokenHandle = IntPtr(0);
    try
    {
        String^ userName;
        String^ domainName;

        // Get the user token for the specified user, domain, and password using the 
        // unmanaged LogonUser method.  
        // The local machine name can be used for the domain name to impersonate a user on this machine.
        Console::Write("Enter the name of the domain on which to log on: ");
        domainName = Console::ReadLine();

        Console::Write("Enter the login of a user on {0} that you wish to impersonate: ", domainName);
        userName = Console::ReadLine();

        Console::Write("Enter the password for {0}: ", userName);

        const int LOGON32_PROVIDER_DEFAULT = 0;
        //This parameter causes LogonUser to create a primary token.
        const int LOGON32_LOGON_INTERACTIVE = 2;
        const int SecurityImpersonation = 2;

        tokenHandle = IntPtr::Zero;
        dupeTokenHandle = IntPtr::Zero;

        // Call LogonUser to obtain a handle to an access token.
        bool returnValue = LogonUser(userName, domainName, Console::ReadLine(), 
        LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT,
        &tokenHandle);

        Console::WriteLine("LogonUser called.");

        if (false == returnValue)
        {
            int ret = Marshal::GetLastWin32Error();
            Console::WriteLine("LogonUser failed with error code : {0}", ret);
            Console::WriteLine("\nError: [{0}] {1}\n", ret, GetErrorMessage(ret));
            int errorCode = 0x5; //ERROR_ACCESS_DENIED
            throw gcnew System::ComponentModel::Win32Exception(errorCode);
        }

        Console::WriteLine("Did LogonUser Succeed? {0}", (returnValue?"Yes":"No"));
        Console::WriteLine("Value of Windows NT token: {0}", tokenHandle);

        // Check the identity.
        Console::WriteLine("Before impersonation: {0}", WindowsIdentity::GetCurrent()->Name);

        bool retVal = DuplicateToken(tokenHandle, SecurityImpersonation, &dupeTokenHandle);
        if (false == retVal)
        {
            CloseHandle(tokenHandle);
            Console::WriteLine("Exception thrown in trying to duplicate token.");        
            return -1;
        }

        // The token that is passed to the following constructor must 
        // be a primary token in order to use it for impersonation.
        WindowsIdentity^ newId = gcnew WindowsIdentity(dupeTokenHandle);
        WindowsImpersonationContext^ impersonatedUser = newId->Impersonate();

        // Check the identity.
        Console::WriteLine("After impersonation: {0}", WindowsIdentity::GetCurrent()->Name);

        // Stop impersonating the user.
        impersonatedUser->Undo();

        // Check the identity.
        Console::WriteLine("After Undo: {0}", WindowsIdentity::GetCurrent()->Name);

        // Free the tokens.
        if (tokenHandle != IntPtr::Zero)
            CloseHandle(tokenHandle);
        if (dupeTokenHandle != IntPtr::Zero) 
            CloseHandle(dupeTokenHandle);
    }
    catch(Exception^ ex)
    {
        Console::WriteLine("Exception occurred. {0}", ex->Message);
    }

Console::ReadLine();
}// end of function 
```

为什么微软的代码要成功，而我的代码却失败了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:13:39.303

“为什么微软的代码要成功，而我的代码却失败了？”

因为你的代码做了一些不同的事情:-)

在这一行：

```
bool returnValue = LogonUser(userName, domainName, Console::ReadLine(), LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT,
    &tokenHandle); 
```

请注意，“tokenHandle”是通过引用传递的，但在您的版本中：

```
bSuccess = LogonUser(_srUsername, _srDomain, _srPassword, 8, 0, (IntPtr*)token.ToPointer()); 
```

您**没有**通过引用传递“令牌”，因此您的本地引用不会被更新，这就是为什么当您将它传递给 WindowsIdentity 时它仍然为零的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:28:25.010

我认为答案在描述 LogonUser 功能的 MSDN 文章中：

* * *

LOGON32_LOGON_NETWORK 登录类型最快，但有以下限制：

该函数返回一个模拟令牌，而不是主令牌。您不能直接在 CreateProcessAsUser 函数中使用此令牌。但是，您可以调用 DuplicateTokenEx 函数将令牌转换为主令牌，然后在 CreateProcessAsUser 中使用它。

* * *

# platform - 一些开发人员如何从一个平台迁移到另一个平台？

> ID：910836
> 
> 赞同：0
> 
> 时间：2009-05-26T13:58:45.613
> 
> 标签：platform

我注意到一些开发人员掌握了新技能并从一个平台转移到另一个平台？他们是如何做到的呢？他们如何证明他们在获得这份工作的上述平台上缺乏经验？

它是基于与他们以前的经验的相关性吗？他们是否获得了目标平台的认证并在接受减薪的初级水平上工作？如果您从事承包/咨询工作会更简单吗？还是只是正确地投射简历的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T14:22:58.030

实际上，许多看似不同的平台实际上非常相似，如果您了解“幕后”发生的事情的话。例如，尽管十多年来我几乎没有接触过微软平台，但我在那里开发东西并不困难，因为对计算机系统的深入了解通常是可以转移的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T14:35:07.523

对我来说，从 LAMP 迁移到 .Net 是一项工作需要。我工作的咨询公司需要一个 PHP 人员，这就是我进入的方式，但是那个项目突然完成了，他们没有准备好 PHP 工作。

在 PHP 项目的最后几周，我参加了[O'Reilly](http://www.oreillyschool.com/)的 C# 在线课程，并与一位更有经验的开发人员密切合作开发同一客户端的 Windows 应用程序。PHP 演出完成后，我可以立即开始一个 .Net 项目，并且从那时起我就拥有了 .Net 客户端。

对我来说，关键是灵活性。我立即让我的雇主知道我对不同的技术和平台感兴趣，并主动要求访问课程并利用我们的年度图书津贴来探索不同的领域。当有机会研究移动性（PDA、专用设备和平板电脑）等新方向时，我抓住了这个机会。

如果您的雇主没有促进这种自我导向扩展的政策，那么请尝试在新平台中构建您熟悉的应用程序类型。一旦你对技术有了不错的掌握，就可以在你的目标平台上参与开源项目，并在你还在学习的时候寻找有偿的外部机会（例如 Craigslist、elance 等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:16:07.310

很可能是环境的结果。在这些触手可及的经济时代，能够走出舒适区至关重要

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T14:39:43.397

我真的没有看到任何人不愿意将开发人员放在对他们来说是新的平台上。计算机语言的变化往往比平台变化更让管理者担心。

# browser - 如何控制浏览器后退按钮

> ID：910840
> 
> 赞同：0
> 
> 时间：2009-05-26T13:59:34.817
> 
> 标签：browser, back-button

我想要一个点击浏览器后退按钮的确认窗口。如果我按是，那么上一页将被加载，否则我将留在同一页面？

任何建议都非常感谢..但请走上正轨..我的问题很直接

提前谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T14:12:33.870

你为什么要这样做？

您可以使用 Javascript 阻止他们离开页面，但如果您不能使用它，则无法对其执行任何操作。

通常你应该在 body 中使用 unload 事件（例如，在 jQuery 中，只需添加

```
jQuery(window).unload(function(evt){
   if(!confirm('Do you really want to leave')){
      evt.preventDefault();
   }}); 
```

Prototype 有类似的东西，对于纯 Javascript，我猜它仍然取决于您使用的浏览器，但`window.unload = function(evt){return false;}` *可能会*起作用。

虽然不记得它的正确语法。

但我不知道您是否可以仅将其限制在背面，或者它是否会触发所有卸载（例如单击链接、关闭浏览器等）

如果您想阻止它们，因为它们可能在表单中有未保存的数据，那没关系。如果您想阻止他们出于其他原因返回，我认为您应该重新考虑原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:34:40.457

通常，如果使用后退按钮可能会导致问题，那么您已经遇到了更大的问题。

您可能想要做的是检查您是否执行以下操作：

*   对所有更改数据的请求使用 POST
*   使用 nonce（唯一 ID）确保表单不会被提交两次

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-12T09:53:50.447

出于这个原因，我使用[noscript 。](http://noscript.net/)我坚持要控制我的浏览器而不是我正在访问的网站。我只允许某些网站的脚本。对于任何禁用我的后退按钮的网站，我不允许它运行脚本。

# jquery - jquery从链接中为li分配onclick

> ID：910850
> 
> 赞同：5
> 
> 时间：2009-05-26T14:01:29.870
> 
> 标签：jquery

我有一个物品清单

```
<ul class="list">
    <li>
        <a href="#Course1" class="launch" onclick="alert('event 1')">event 1</a>
    </li>
    <li class="alt">
        <a href="#Course2" class="launch" onclick="alert('event 2')">event 2</a>
    </li>
    <li>
        <a href="#Course3" class="launch" onclick="alert('event 3')">event 3</a>
    </li>
    <li class="alt">
        <a href="#Course4" class="launch" onclick="alert('event 4')">event 4</a>
    </li>
</ul> 
```

我希望能够将链接的 onclick 分配给 li 的 onclick

到目前为止，我的尝试是单击一次（因为我将脚本分配给 onclick 而不是执行脚本）

```
$('.list li').click(function() {
    var launch = $('a.launch', this);
    if (launch.size() > 0) { this.onclick = launch.attr('onclick'); }
}); 
```

提前感谢蒂姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T04:06:16.660

基于[@Thomas Stock 的](https://stackoverflow.com/users/72859/thomas-stock) [回答](https://stackoverflow.com/questions/910850/jquery-assign-onclick-for-li-from-a-link/910877#910877)，以下代码可防止在单击链接而不是 li 时重复执行。（从[这里](http://docs.jquery.com/Events/jQuery.Event)jQuery 网站获得）

```
$(document).ready(function() {

    $('ul.list li').click(function(e) {
        var $target = $(e.target);
        if(!$target.is("li")) //magic happens here!!
        {
            return;
        }

        var launch = $('a.launch', this);
        if (launch.size() > 0) 
        { 
          eval(launch[0].onclick());
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T04:19:34.727

你这样做是为了让整个 li 块是一个可点击的链接，而不仅仅是一个元素？如果是这样，您可以使用 CSS 轻松地做到这一点。

HTML：

```
<html>
<head>
    <title>Testing Block Elements</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body>
    <ul id="menu">
        <li><a href="#">Link 1</a></li>
        <li><a href="#">Link 2</a></li>
        <li><a href="#">Link 3</a></li>
        <li><a href="#">Link 4</a></li>
        <li><a href="#">Link 5</a></li>
    </ul>
</body>
</html> 
```

CSS：

```
#menu {
    list-style: none;
    padding: 0;
    margin: 0;
}

#menu li {
    /* Added to show the whole li element will be a clickable link. */
    width: 250px;
    border: 1px solid #000000;
}

#menu li a {
    display: block;
} 
```

编辑：

通过这样做，如果您确实需要在用户单击它时执行一些 javascript，则只需将 click 事件附加到 a 标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:04:06.727

使用 each 而不是单击循环遍历 li：

```
$(document).ready(function(){
    $('.list li').each(function() {
        var launch = $('a.launch', this);
        if (launch.size() > 0) { this.onclick = launch.attr('onclick'); }
    });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T14:06:15.990

```
$('.list li').click(function() {
    var launch = $('a.launch', this);
    if (launch.size() > 0) { eval(launch.attr('onclick')) }
}); 
```

马里奥的解决方案也将起作用。我的将在实际点击时获取 child 的 onclick 事件并执行它。

Mario 的解决方案会将 's onclick 事件绑定到 li's on document load。选择最适合您的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T03:17:47.123

您最好的选择可能是选择一种特定的元素类型——也许是具有更大尺寸的元素类型——然后只将点击处理程序分配给那些。如果 onclick 同时设置为 A 标记和 LI（通过任何方式），则调用可能会发生两次，除非您在命名函数中特别防止此类事件冒泡。

您是否有特殊原因希望在两种元素类型上发生相同的操作，而不仅仅是一种？（如果它是“只是一种预防措施”的话，最好解决问题，而不是用更多的脚本来解决它们。）

# c++ - 在 C++ 中开发 Web 服务的好平台是什么？

> ID：910854
> 
> 赞同：3
> 
> 时间：2009-05-26T14:02:24.623
> 
> 标签：c++, web-services

我们正在研究开发一个 Web 服务，作为用 C++ 编写的网络安全原型的浏览器显示/GUI 的基础。我在 Web 服务方面的经验仅限于 Java。我更喜欢 Java 中的 Web 服务，因为它处于“人迹罕至的道路”上。

一个确定的做法是简单地编写一个调用 Web 服务的 Java 客户端，并使用 C++ 代码中的参数将其作为命令行调用。

这并不理想，因为一般来说 API 更可取，但在这种情况下，它会起作用并且是一个非常安全的解决方案。

在 C++ 中处理 Web 服务开发的资源称为 gSOAP，网址为：http: [//gsoap2.sourceforge.net](http://gsoap2.sourceforge.net)

有什么想法更好的方法吗？有没有人使用过 gSOAP，如果有，你怎么看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:20:34.883

我用 gSOAP 做了一些事情，这并不糟糕。不过，我越来越反对 Web 服务的 RPC 模型。它迫使您进入大量的连接和会话状态，从而增加了复杂性。REST 接口更简单、更健壮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T14:04:51.267

对我来说是[Axis C++](http://ws.apache.org/axis/cpp/index.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T14:22:23.930

对于 RPC 风格，看看[Thrift](http://incubator.apache.org/thrift/)，我发现它比soap 更好（更快、更清晰、多种语言实现）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T17:55:05.107

我的同事最终将 Axis2 / java（用于服务）和 gsoap 用于客户端的组合。他通过从 C++ 标头生成 wsdl（使用 c2wsdl (?) 或类似的东西）从 Java 服务创建了 wsdl。他说这比使用 Java 接口更好，因为它生成了两组 wsdl，用于不同版本的 soap。

然后他使用 wsdl2java 生成了 webservice 和一个测试 web 客户端。一旦我们开始工作，他使用 gsoap 创建 Web 客户端（在 C++ 中），它运行良好。

感谢所有的答案！我最终使用了它们的组合。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T14:07:25.987

[我对gsoap](http://gsoap2.sourceforge.net/)有很好的体验——非常简单，性能很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T14:21:55.957

如果只能在 Windows 上运行是可以接受的，那么有一个用于此目的的全新 API：[WWSAPI](http://msdn.microsoft.com/en-us/library/dd430435(VS.85).aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T14:27:14.810

您可以在 C 应用程序中创建 Java 虚拟机，实例化类并调用任何方法，而不是从命令行调用 java 客户端。这就是 java.exe 应用程序所做的，我认为源代码包含在 jdk 中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T15:35:02.253

取决于你想去多低的水平。您可以结帐[yield](http://code.google.com/p/yield)。

# windows - out-proc COM 服务器如何检测客户端故障？

> ID：910855
> 
> 赞同：0
> 
> 时间：2009-05-26T14:02:30.520
> 
> 标签：windows, com, interop

假设我们有一个 out-proc COM 服务器和一个客户端。客户端调用服务器中的方法并意外终止。服务器有没有办法检测到这一点并中断该方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:31:30.340

不是没有保活。如果您使用 DCOM，则有一个内置的保持活动机制。DCOM 服务器会定期 pingback 到 COM 客户端，如果 3 次 ping 没有响应，则服务器声明客户端“已消失”，服务器端对象可以消失。

如果不是 DCOM 那么...？

# web-applications - 现代 Web 应用程序中密码检索的有效技术

> ID：910856
> 
> 赞同：18
> 
> 时间：2009-05-26T14:02:36.497
> 
> 标签：web-applications, passwords, password-recovery, forgot-password

我们一直在开发 web 应用程序，我们需要在其中实现密码检索的传统 web 应用程序功能。根据趋势，有一些方法，如..

1.  将密码重置链接发送到用户的电子邮件。
2.  向用户询问密码恢复的秘密问题。
3.  重置现有密码并创建新密码并将其发送给用户。这也可能会强制用户在下次登录时更改密码。

我们是否有任何非传统技术来实现密码检索机制？您为此尝试了哪些其他方法？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-26T15:10:25.550

这取决于您的目标安全级别、支持成本和可用性问题。

出于多种原因，通过电子邮件发送密码重置链接是首选方法：

*   **支持成本**- 从业务角度来看，这是最大的因素。用户甚至经常忘记他们的密码提示或使用虚假的邮寄地址或忘记他们的用户名。所有这些都是您可能会收到支持请求的合法问题。这反过来又产生了另一个问题，您必须通过询问他们最近的帐户活动以及什么不是来确定用户的合法性。如果您不提供这种级别的支持，很多新手用户会感到失望。通过电子邮件发送密码重置链接可以缓解这些担忧，因为用户通常有一个或两个电子邮件地址，并且他们可以通过提供他们的电子邮件地址轻松恢复他们的用户名/密码。

*   **安全问题**- 从技术角度来看，这是最大的因素。这里有各种各样的问题，你必须权衡。被入侵的电子邮件帐户意味着黑客可以访问所有允许通过电子邮件发送密码重置链接的用户服务。您可以选择中间立场，即通过电子邮件将密码重置链接发送给用户，然后向用户询问密码提示问题，然后允许他们重置密码。同样，您不应该在任何媒体中公开用户的密码。事实上，如果您有能力向他们展示他们的密码，那么您的系统已经不安全，因为这意味着您没有使用像 SHA-1 这样的安全哈希来存储它们，并且您公司的开发人员可以获取每个人的密码。

*   **可用性**——从用户的角度来看，这是最大的因素。通过电子邮件发送密码重置链接需要用户去检查他们的电子邮件地址，这意味着完成任务的时间可能长达 2 分钟甚至 3 分钟。但是，我认为这没什么大不了的。大多数用户似乎并不介意这一点，因为他们觉得自己有过错，这是符合他们最大利益的安全措施。我只是根据个人经验进行假设，一般用户可能会有不同的感受。我会将安全性视为比用户体验更高的优先级，因为用户很少需要检索他们的密码（用户很长时间没有登录并忘记了他的密码；用户已将他的密码保存在重新安装的浏览器中，并且其他一些边缘情况）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-07-18T22:19:52.987

我在实践中看到的其他选择包括：

*   当出现问题时允许使用第二个密码——比如手机使用的超级密码。
*   创建一个文件令牌（通常是 PGP 密钥），用户将在创建帐户时下载该令牌并将其存储在 USB 记忆棒上，或将其存档以备后用。当出现问题时，用户将上传令牌，从而证明他是帐户的“所有者”，并且应用程序将让用户更改密码。这可以是一个常量令牌，也可以是一个带有多个令牌的文件（类似于网上银行 TAN）——每次使用一个令牌时，它也会失效。

上述方法实现起来并不那么简单，但对用户非常友好（因为它们没有什么新东西，而且在日常情况下也存在）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-26T14:05:45.990

在我看来，向用户的电子邮件发送密码重置链接是最好的方法。Digg 就是这样做的，我也是这样做的。

但是在这种方法中，我们需要依靠用户能够访问他的电子邮件。

关于密题法：密题的答案往往不如我们想的那么隐秘。阻止这种“帐户破解”方法符合我们用户的最大利益。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-23T11:35:27.867

网站及其管理员不应知道其用户的明文密码。应该只存储密码的单向哈希，以便在身份验证事件中进行比较。因此，不应选择发送密码明文。

我个人喜欢发送给用户的密码重置链接。请记住使该链接过期。此外，通过电子邮件通知用户密码重置尝试（可以是与重置链接相同的电子邮件），以及成功重置后。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-09T20:09:43.450

密码重置链接的一种附加方法可能是创建一个随机密钥，该密钥不会出现在电子邮件链接中，一旦单击链接，用户就必须输入该密钥。这将有助于防止人们捕获电子邮件。

# c# - 使用带有亚音速的事务

> ID：910863
> 
> 赞同：7
> 
> 时间：2009-05-26T14:03:44.763
> 
> 标签：c#, asp.net, web-applications, subsonic, transactions

在我的 Web 应用程序中，我必须对用户操作进行审核。因此，每当用户采取行动时，我都会更新采取行动的对象并保留该行动的审计跟踪。

现在，如果我先修改对象然后更新审计跟踪，但审计跟踪失败，那怎么办？

显然我需要回滚对修改对象的更改。我可以在简单的应用程序中使用 Sql-Transactions，但我正在使用 Subsonic 与 db 对话。我该如何处理这种情况？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T02:26:34.903

[@Kevinw](https://stackoverflow.com/users/108853/kevinw)给出的[答案](https://stackoverflow.com/questions/910863/using-transactions-with-subsonic/911069#911069)完全可以。我将其发布为他对 C# 代码的回答的翻译。我没有使用注释，因为它不会格式化代码:) 另外我正在使用 try/catch 来了解事务是否应该完成或回滚。

```
using (System.Transactions.TransactionScope ts = new TransactionScope())
{
    using (SharedDbConnectionScope scs = new SharedDbConnectionScope())
    {
        try
        {
            //do your stuff like saving multiple objects etc. here 

            //everything should be completed nicely before you reach this
            //line if not throw exception and don't reach to line below
            ts.Complete();
        }
        catch (Exception ex)
        {
            //ts.Dispose(); //Don't need this as using will take care of it.
            //Do stuff with exception or throw it to caller
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-26T14:42:16.930

就像是：

```
Using ts As New System.Transactions.TransactionScope()
  Using sharedConnectionScope As New SubSonic.SharedDbConnectionScope()

' Do your individual saves here

' If all OK
      ts.Complete()

   End Using
End Using 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-12T10:17:08.517

没有。如果我把`SharedDbConnectionScope`之前的更改放在数据库中是可见的`ts.Complete()`。把它放在里面会阻塞服务器，直到操作完成。

# c# - 显示成员详细信息以更正用户

> ID：910867
> 
> 赞同：0
> 
> 时间：2009-05-26T14:04:17.397
> 
> 标签：c#, asp.net, vb.net, session

我目前有一个网站，在注册到该网站后，我会为每个成员生成一个唯一的 GUID。在用户登录到网站后，我检查凭据并将 guid 存储在会话中（如果成功），以便向用户显示那里的个人资料/已发布多少帖子等，我运行我的查询到数据库，将用户会话 GUID 传递给获取与它们相关的数据。

任何人都可以确认一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:08:05.533

看看 ASP.Net 中的会员功能：http: [//msdn.microsoft.com/en-us/library/ms998347.aspx](http://msdn.microsoft.com/en-us/library/ms998347.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:15:44.193

这基本上是大多数身份验证/授权系统的工作方式。您可能需要记住一些事情：

1.  如果不需要，不要重新发明轮子——正如 Max 所指出的，ASP.NET 有一个内置的身份验证提供程序，它功能相当丰富，也可以扩展。
2.  除非您必须这样做，否则我会避免在 Session 中存储任何内容。使用 Session 很容易变得懒惰，而且它也有潜在的波动性——如果你退回服务，Session 中的任何东西都会消失。
3.  如果您在客户端上存储一个 cookie 来处理这个问题，请确保它是加盐和加密的。

# silverlight - 通过 XAML 刷新 Silverlight UserControl

> ID：910869
> 
> 赞同：0
> 
> 时间：2009-05-26T14:05:08.630
> 
> 标签：silverlight, xaml, refresh, silverlight-2.0

我在 Visual Studio 2008 中使用最新版本的 Silverlight 2.0。我有一个简单的 Silverlight UserControl，代码如下：

```
public partial class SilverlightControl1 : UserControl
{
    public SilverlightControl1()
    {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(SilverlightControl1_Loaded);
        Composite = new Composite();
    }

    void SilverlightControl1_Loaded(object sender, RoutedEventArgs e)
    {
        Composite.Width = this.Width / 2.0;
        Composite.Height = this.Height / 2.0;
        if (!this.LayoutRoot.Children.Contains(Composite)) 
            this.LayoutRoot.Children.Add(Composite);
    }

    public Composite Composite
    {
        get;
        set;
    }
}

public class Composite : ContentControl
{
    private Grid grid;
    private Canvas canvas;

    public Composite()
    {
        if (grid == null) grid = new Grid();
        if (canvas == null) canvas = new Canvas();
        if (!grid.Children.Contains(canvas)) 
            grid.Children.Add(canvas);
        Content = grid;
        this.Loaded += new RoutedEventHandler(Composite_Loaded);
    }

    private Rectangle rectangle;

    void Composite_Loaded(object sender, RoutedEventArgs e)
    {
        if (rectangle == null) rectangle = new Rectangle();
        Canvas.SetTop(rectangle, 0);
        Canvas.SetLeft(rectangle, 0);
        rectangle.Fill = new SolidColorBrush(Color);
        rectangle.Width = Width;
        rectangle.Height = Height;
        if (!canvas.Children.Contains(rectangle)) 
            canvas.Children.Add(rectangle);
    }

    public Color Color
    {
        get;
        set;
    }
} 
```

然后我在 Silverlight 应用程序中使用此 UserControl，页面的 XAML 如下所示：

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:test="clr-namespace:SilverlightClassLibrary1;assembly=SilverlightClassLibrary1"
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="Green">
    <test:SilverlightControl1 Name="uControl1">
      <test:SilverlightControl1.Composite>
        <test:Composite Color="Yellow"/>
      </test:SilverlightControl1.Composite>
    </test:SilverlightControl1>
    </Grid>
</UserControl> 
```

我的问题是：我必须在上面添加什么代码，以便通过将“复合颜色”更改为黄色以外的颜色并点击返回按钮，UserControl 会自动刷新？正如代码所示，刷新 UserControl 的唯一方法是在 VS2008 IDE 中移动滑块栏，这会更改 Silverlight 页面的缩放百分比。一个附带的问题，虽然对上述问题不太重要，但它是：使用上面的代码，为什么我不能更改 LayoutRoot 的“背景”颜色？如果我删除我的 UserControl，它会按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T09:10:50.147

解决方案是双重的。首先是在 LayoutUpdated 事件而不是 Loaded 事件中进行更改，其次是订阅 PropertyMetadata 的 PropertyChangedCallback。这是完整的工作代码：

```
 public partial class SilverlightControl1 : UserControl
  {
    public SilverlightControl1()
    {
      InitializeComponent();
      this.LayoutUpdated += new EventHandler(SilverlightControl1_LayoutUpdated);
      Composite = new Composite();
    }

    void SilverlightControl1_LayoutUpdated(object sender, EventArgs e)
    {
      Composite.Width = this.Width / 2.0;
      Composite.Height = this.Height / 2.0;
      if (!this.LayoutRoot.Children.Contains(Composite)) this.LayoutRoot.Children.Add(Composite);
    }

    public Composite Composite
    {
      get;
      set;
    }
  }

  public class Composite : ContentControl
  {
    private Grid grid;
    private Canvas canvas;

    public Composite()
    {
      if (grid == null) grid = new Grid();
      if (canvas == null) canvas = new Canvas();
      if (!grid.Children.Contains(canvas)) grid.Children.Add(canvas);
      Content = grid;
      this.LayoutUpdated += new EventHandler(Composite_LayoutUpdated);
    }

    void Composite_LayoutUpdated(object sender, EventArgs e)
    {
      if (rectangle == null) rectangle = new Rectangle();
      Canvas.SetTop(rectangle, 0);
      Canvas.SetLeft(rectangle, 0);
      rectangle.Fill = new SolidColorBrush(Color);

      rectangle.Width = Width;
      rectangle.Height = Height;
      if (!canvas.Children.Contains(rectangle)) canvas.Children.Add(rectangle);
    }

    public static readonly DependencyProperty ColorProperty = DependencyProperty.Register("Color", typeof(Color), typeof(Composite), new PropertyMetadata(Colors.Red, new PropertyChangedCallback(OnColorPropertyChanged)));

    private static void OnColorPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
      Composite comp = (Composite)d;
      comp.InvalidateArrange();
    }

    private Rectangle rectangle;

    public Color Color
    {
      get { return (Color)GetValue(ColorProperty); }
      set { SetValue(ColorProperty, value); }
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:20:59.597

我认为您需要将 Composite 变成依赖属性。可能会希望对复合颜色上的颜色做同样的事情，以便您能够绑定它。

# javascript - 更改文本框数量，使用 jQuery/Javascript 悬停更改图片

> ID：910870
> 
> 赞同：1
> 
> 时间：2009-05-26T14:05:13.527
> 
> 标签：javascript, jquery

我想用 jQuery 或 Javascript 做两件事，

1.  在带有向上和向下箭头的文本框中随数量变化。默认数量为 1，当用户单击向上箭头时，我想增加 1，反之亦然。

2.  当鼠标悬停在箭头上时，我可以将箭头更改为另一张图片（颜色）吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:20:02.420

我建议使用[`click()`](http://docs.jquery.com/Events/click)命令来更改文本框中的值以及[`hover()`](http://docs.jquery.com/Events/hover)将箭头更改为另一张图片（颜色）的命令

例如，对于增量器

```
$('#myImg')
    .click( function() { 
                           var num = $('#myTextbox').text(); 
                           if (!isNaN(num))
                               $('#myTextbox').text(parseInt(num,10) + 1);
    .hover(
            function() { $(this).css('background-image','over.jpg'), //over 
            function() { $(this).css('background-image','out.jpg') // out
          ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:20:10.190

1.)

```
<script>
function increase() {
  var textbox = document.getElementById('textbox');
  textbox.value = parseInt(textbox.value) + 1;
}
</script>

<input id="textbox" name="textbox" type="text" value="1">
<a href="#" onclick="increase()">up</a> 
```

2.) 应该使用 CSS :hover

# c# - 如何确定文件是c#中的二进制文件还是文本文件？

> ID：910873
> 
> 赞同：60
> 
> 时间：2009-05-26T14:05:20.297
> 
> 标签：c#, text, file-io, binary

我需要确定 80% 的文件是二进制文件还是文本文件，有没有办法在 c# 中快速和肮脏/丑陋地做到这一点？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-26T14:16:52.567

有一种方法叫做马尔可夫链。扫描这两种类型的几个模型文件，并为每个字节值从 0 到 255 收集后续值的统计信息（基本上是概率）。这将为您提供一个 64Kb (256x256) 配置文件，您可以将运行时文件与之进行比较（在 % 阈值内）。

据说，这就是浏览器的自动检测编码功能的工作原理。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-26T14:16:45.983

我可能会寻找大量通常出现在二进制文件中但很少出现在文本文件中的控制字符。二进制文件倾向于使用足够的 0，以至于仅测试许多 0 字节可能足以捕获大多数文件。如果您关心本地化，您还需要测试多字节模式。

如前所述，您总是很不幸，得到一个看起来像文本的二进制文件，反之亦然。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-10-30T12:27:47.917

分享我的解决方案，希望它可以帮助其他人，因为它可以从这些帖子和论坛中帮助我。

## 背景

我一直在研究和探索相同的解决方案。但是，我希望它是简单的或稍微扭曲的。

然而，大多数尝试在这里以及其他来源提供了复杂的解决方案，并深入研究了 Unicode、[UTF-series](https://stackoverflow.com/questions/496321/utf8-utf16-and-utf32)、BOM、编码、字节顺序。在这个过程中，我也进入了[Ascii 表和代码页面](http://www.ascii-codes.com/cp852.html)。

无论如何，我提出了一个基于流阅读器和*自定义控制字符检查*的解决方案。

它的构建考虑了论坛和其他地方提供的各种提示和技巧，例如：

1.  检查大量控制字符，例如查找多个连续的空字符。
2.  检查 UTF、Unicode、编码、BOM、字节顺序和类似方面。

我的目标是：

1.  它不应该依赖字节顺序、编码和其他更多涉及的深奥工作。
2.  它应该相对容易实现和易于理解。
3.  它应该适用于所有类型的文件。

提出的解决方案适用于我的测试数据，包括 mp3、eml、txt、info、flv、mp4、pdf、gif、png、jpg。到目前为止，它给出了预期的结果。

# 解决方案如何运作

我依靠[StreamReader 默认构造函数](http://msdn.microsoft.com/en-us/library/f2ke0fzy(v=vs.110).aspx)来完成它在确定默认使用[UTF8Encoding](http://msdn.microsoft.com/en-us/library/system.text.utf8encoding(v=vs.110).aspx)的文件编码相关特征方面做得最好的事情。

我创建了自己的自定义控件字符条件检查版本，因为[Char.IsControl](http://msdn.microsoft.com/en-us/library/18zw7440(v=vs.110).aspx)似乎没有用。它说：

> 控制字符是格式化字符和其他非打印字符，例如 ACK、BEL、CR、FF、LF 和 VT。Unicode 标准从 \U0000 到 \U001F、\U007F 和从 \U0080 到 \U009F 分配代码点来控制字符。这些值将被解释为控制字符，除非应用程序另外定义了它们的使用。它将 LF 和 CR 视为控制字符等

这使得它没有用，因为文本文件至少包含 CR 和 LF。

# 解决方案

```
static void testBinaryFile(string folderPath)
{
    List<string> output = new List<string>();
    foreach (string filePath in getFiles(folderPath, true))
    {
        output.Add(isBinary(filePath).ToString() + "  ----  " + filePath);
    }
    Clipboard.SetText(string.Join("\n", output), TextDataFormat.Text);
}

public static List<string> getFiles(string path, bool recursive = false)
{
    return Directory.Exists(path) ?
        Directory.GetFiles(path, "*.*",
        recursive ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly).ToList() :
        new List<string>();
}    

public static bool isBinary(string path)
{
    long length = getSize(path);
    if (length == 0) return false;

    using (StreamReader stream = new StreamReader(path))
    {
        int ch;
        while ((ch = stream.Read()) != -1)
        {
            if (isControlChar(ch))
            {
                return true;
            }
        }
    }
    return false;
}

public static bool isControlChar(int ch)
{
    return (ch > Chars.NUL && ch < Chars.BS)
        || (ch > Chars.CR && ch < Chars.SUB);
}

public static class Chars
{
    public static char NUL = (char)0; // Null char
    public static char BS = (char)8; // Back Space
    public static char CR = (char)13; // Carriage Return
    public static char SUB = (char)26; // Substitute
} 
```

**如果您尝试上述解决方案，请告诉我它是否适合您。**

其他有趣和相关的链接：

*   [关于 Unicode.org 上的 UTF 和 BOM](http://www.unicode.org/faq/utf_bom.html)
*   [Unicode 示例文件](http://www.humancomp.org/unichtm/unichtm.htm)
*   [如何检测文本文件的编码](https://stackoverflow.com/questions/4520184/how-to-detect-the-character-encoding-of-a-text-file)和
*   [在 Csharp 中检测文件编码](https://stackoverflow.com/questions/3404199/how-to-find-out-the-encoding-of-a-file-c-sharp)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-05-20T15:16:04.590

虽然这不是万无一失的，但这应该检查它是否有任何二进制内容。

```
public bool HasBinaryContent(string content)
{
    return content.Any(ch => char.IsControl(ch) && ch != '\r' && ch != '\n');
} 
```

因为如果存在任何控制字符（除了标准`\r\n`），那么它可能不是文本文件。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-07-07T16:32:50.343

如果这里真正的问题是“是否可以不加修改地使用 StreamReader/StreamWriter 读取和写入此文件？”，那么答案就在这里：

```
/// <summary>
/// Detect if a file is text and detect the encoding.
/// </summary>
/// <param name="encoding">
/// The detected encoding.
/// </param>
/// <param name="fileName">
/// The file name.
/// </param>
/// <param name="windowSize">
/// The number of characters to use for testing.
/// </param>
/// <returns>
/// true if the file is text.
/// </returns>
public static bool IsText(out Encoding encoding, string fileName, int windowSize)
{
    using (var fileStream = File.OpenRead(fileName))
    {
    var rawData = new byte[windowSize];
    var text = new char[windowSize];
    var isText = true;

    // Read raw bytes
    var rawLength = fileStream.Read(rawData, 0, rawData.Length);
    fileStream.Seek(0, SeekOrigin.Begin);

    // Detect encoding correctly (from Rick Strahl's blog)
    // http://www.west-wind.com/weblog/posts/2007/Nov/28/Detecting-Text-Encoding-for-StreamReader
    if (rawData[0] == 0xef && rawData[1] == 0xbb && rawData[2] == 0xbf)
    {
        encoding = Encoding.UTF8;
    }
    else if (rawData[0] == 0xfe && rawData[1] == 0xff)
    {
        encoding = Encoding.Unicode;
    }
    else if (rawData[0] == 0 && rawData[1] == 0 && rawData[2] == 0xfe && rawData[3] == 0xff)
    {
        encoding = Encoding.UTF32;
    }
    else if (rawData[0] == 0x2b && rawData[1] == 0x2f && rawData[2] == 0x76)
    {
        encoding = Encoding.UTF7;
    }
    else
    {
        encoding = Encoding.Default;
    }

    // Read text and detect the encoding
    using (var streamReader = new StreamReader(fileStream))
    {
        streamReader.Read(text, 0, text.Length);
    }

    using (var memoryStream = new MemoryStream())
    {
        using (var streamWriter = new StreamWriter(memoryStream, encoding))
        {
        // Write the text to a buffer
        streamWriter.Write(text);
        streamWriter.Flush();

        // Get the buffer from the memory stream for comparision
        var memoryBuffer = memoryStream.GetBuffer();

        // Compare only bytes read
        for (var i = 0; i < rawLength && isText; i++)
        {
            isText = rawData[i] == memoryBuffer[i];
        }
        }
    }

    return isText;
    }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-12-31T01:23:33.163

好问题！我自己很惊讶 .NET 并没有为此提供简单的解决方案。

以下代码对我有用，可以区分图像（png、jpg 等）和文本文件。

`0x00`根据 Ron Warholic 和 Adam Bruss 的建议，我刚刚检查了前 512 个字节中的连续空值 ( )：

```
if (File.Exists(path))
{
    // Is it binary? Check for consecutive nulls..
    byte[] content = File.ReadAllBytes(path);
    for (int i = 1; i < 512 && i < content.Length; i++) {
        if (content[i] == 0x00 && content[i-1] == 0x00) {
            return Convert.ToBase64String(content);
        }
    }
    // No? return text
    return File.ReadAllText(path);
} 
```

显然这是一种快速而肮脏的方法，但是可以通过将文件分成 10 个 512 字节的块并检查其中 8 个连续空值来轻松扩展它（个人而言，如果 2或其中 3 个匹配 - 空值在文本文件中很少见）。

这应该为你所追求的提供一个很好的解决方案。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-26T14:10:20.007

快速而肮脏的是使用文件扩展名并查找常见的文本扩展名，例如 .txt。为此，您可以使用[Path.GetExtension](http://msdn.microsoft.com/en-us/library/system.io.path.getextension.aspx)调用。其他任何东西都不会真正被归类为“快速”，尽管它很可能很脏。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-26T14:24:16.827

一个非常非常肮脏的方法是构建一个只接受标准文本、标点符号、符号和空白字符的正则表达式，在文本流中加载文件的一部分，然后针对正则表达式运行它。根据您的问题域中的纯文本文件，没有成功的匹配将指示二进制文件。

要考虑 unicode，请确保将流上的编码标记为这样。

这真的不是最理想的，但你说的又快又脏。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-26T14:46:13.070

[http://codesnipers.com/?q=node/68](http://codesnipers.com/?q=node/68)描述了如何使用字节顺序标记（可能出现在您的文件中）检测 UTF-16 与 UTF-8。它还建议遍历一些字节以查看它们是否符合 UTF-8 多字节序列模式（如下）以确定您的文件是否为文本文件。

*   0xxxxxxx ASCII < 0x80 (128)
*   110xxxxxx 10xxxxxx 2 字节 >= 0x80
*   1110xxxx 10xxxxxx 10xxxxxx 3 字节 >= 0x400
*   11110xxx 10xxxxxx 10xxxxxx 10xxxxxx 4 字节 >= 0x10000

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-05T15:44:42.020

另一种方法如何：确定二进制数组的长度，表示文件的内容，并将其与将给定二进制数组转换为文本后的字符串长度进行比较。

如果长度相同，则文件中没有“不可读”符号，它是文本（我确定 80%）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-03-25T07:47:59.307

另一种方法是使用[UDE](https://github.com/tylerlong/ude)检测文件的字符集。如果 charset 检测成功，您可以确定它是文本，否则它是二进制。因为二进制没有字符集。

当然，您可以使用 UDE 以外的其他字符集检测库。如果字符集检测库足够好，这种方法可以达到 100% 的正确性。

# javascript - 使用正则表达式拆分复杂字符串

> ID：910876
> 
> 赞同：1
> 
> 时间：2009-05-26T14:06:00.513
> 
> 标签：javascript, regex

我如何使用*正则表达式*拆分此**字符串**：

```
string = "a[a=d b&c[e[100&2=34]]] e[cheese=blue and white] x[a=a b]" 
```

进入这个**数组**：

```
string.split( regexp ) =>

[ "a[a=d b&c[e[100&2=34]]]", "e[cheese=blue and white]", "x[a=a b]" ] 
```

基本规则是**字符串**应该在**空格（ \s ）**处分割，除非**括号**内存在**空格**（ [ ] ） ；

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T14:17:58.120

你不能；正则表达式基于没有“堆栈”的状态机，因此您可以记住嵌套级别的数量。

但也许您可以使用一个技巧：尝试将字符串转换为有效的[JSON 字符串](http://en.wikipedia.org/wiki/JSON)。然后您可以使用`eval()`它来将其解析为 JavaScript 对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T14:59:56.757

如果规则这么简单，我建议只手动执行。逐步检查每个字符，并通过为每个 [ 增加 1 并为每个 ] 减少 1 来跟踪您的嵌套级别。如果您到达嵌套 == 0 的空间，则拆分。

编辑：我在想我可能还会提到某些语言中的其他模式匹配工具确实支持这种事情。例如，在 Lua 中，您可以使用 '%b[]' 来匹配平衡的嵌套 []。（当然，Lua 没有内置的 split 函数......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:21:59.407

你能在 "(?<=])\s(?=[az][)" 上分开吗？也就是说，一个空格，前面有一个]，后面是一个字母和一个[? 这假设您在括号内没有任何字符串，例如 "a[b=d[x=yb] g[w=vb]]"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:14:25.087

另一种是循环方法，您一次解构嵌套括号一个级别，否则很难（TM）确保您的单个正则表达式按预期工作。

这是一个红宝石的例子：

```
str = "a[a=d b&c[e[100&2=34]]] e[cheese=blue and white] x[a=a b]"
left = str.dup
tokn=0
toks=[]
# Deconstruct
loop do
  left.sub!(/\[[^\]\[]*\]/,"\{#{tokn}\}")
  break if $~.nil?
  toks[tokn]=$&
  tokn+=1
end
left=left.split(/\s+/)
# Reconstruct
(toks.size-1).downto(0) do |tokn|
  left.each { |str| str.sub!("\{#{tokn}\}", toks[tokn]) }
end 
```

上面使用 {n} ，其中 n 在解构期间是一个整数，因此在某些情况下，字符串中这样的原始输入会破坏重构。这应该说明这种方法。

不过，编写通过遍历字符进行拆分的代码更简单、更安全。

红宝石中的示例：

```
str = "a[a=d b&c[e[100&2=34]]] e[cheese=blue and white] x[a=a b]"
toks=[]
level=st=en=0; 
str.each_byte do |c|
  en+=1; 
  level+=1 if c=='['[0]; 
  level-=1 if c==']'[0]; 
  if level==0 && c==' '[0]
    toks.push(str[st,en-1-st]);
    st=en
  end
end    
toks.push(str[st,en-st]) if st!=en 
p toks 
```

# sql - 自动化 DDL 脚本：要预测多少功能？

> ID：910881
> 
> 赞同：1
> 
> 时间：2009-05-26T14:06:50.653
> 
> 标签：sql, database-design, ddl

我有一个脚本，它生成 DDL 脚本来为规范化数据库定义物化视图。某些表具有指向特定数据库用户的“所有者”列，然后我可以为其创建视图，该视图将仅显示当前数据库用户创建的表的行。在某些情况下，从安全性和便利性的角度来看，这样的视图都是有益的——例如，只显示一个人自己的多项选择测验结果。

问题是，除了几张表之外，还有很多表我可以想象有人要求这样的视图，但想不出具体的用例。但是，我认为有时这种通用功能可能很有用，因为我不能总是预见所有用例。

我的问题是，我应该费心自动生成多少这些个性化视图？对于数百个表，这为构建、测试和基准测试过程增加了大量时间，尽管它们是自动化的。您会在可能永远不会使用的额外功能方面犯错，还是在仅提供那些已被要求/您知道将有用的视图方面犯错？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T15:16:19.000

这是一个问自己的好问题——一般性（通常；-）是一件好事，但正如您所观察到的那样，过度概括会使您陷入组合爆炸。当用户尝试使用它时，您是否可以安排“及时”生成所需的 DDL 位（当然保留一些已经证明有用的位的“缓存”）？

如果这是不可行的，那么，考虑到“潜在有用的视图”在表和列的数量上呈指数增长的可能性，我会不情愿地选择“只制作已知有用/想要的”策略（并努力制作用户很容易让我知道他们何时需要我添加更多内容...）。

# c# - 如何判断某个点是否在某条线附近？

> ID：910882
> 
> 赞同：8
> 
> 时间：2009-05-26T14:06:58.437
> 
> 标签：c#, algorithm, geometry, gdi+, drawing

我问过“[如何判断一个点是否属于某条线？](https://stackoverflow.com/questions/907390/how-can-i-tell-if-a-point-belongs-to-a-certain-line) ”之前我找到了合适的答案，非常感谢。

**现在，我想知道如何判断某个点是否*靠近*我的线。**

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-26T14:14:52.570

您需要[计算到直线的直角距离](http://mathworld.wolfram.com/Point-LineDistance2-Dimensional.html)。然后你必须定义什么是“接近”并测试它是否在那个距离内。

![](https://i.stack.imgur.com/YTmsx.gif)

你想要的等式是：

![d=|v^^·r|=(|(x_2-x_1)(y_1-y_0)-(x_1-x_0)(y_2-y_1)|)/(sqrt((x_2-x_1)^2+(y_2- y_1)^2))。](https://i.stack.imgur.com/NQox2.gif)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-24T15:04:11.187

[@Alan Jackson](https://stackoverflow.com/users/72995/alan-jackson)的回答几乎是完美的——但他的第一个（也是投票最多的）评论表明端点没有得到正确处理。为确保该点位于线段上，只需创建一个线段为对角线的框，然后检查该点是否包含在其中。这是*伪代码*：

给定线 ab，由点 a 和 b 以及点 p 组成，有问题：

```
int buffer = 25;//this is the distance that you would still consider the point nearby
Point topLeft = new Point(minimum(a.x, b.x), minimum(a.y, b.y));
Point bottomRight = new Point(maximum(a.x, b.x), maximum(a.y, b.y));
Rect box = new Rect(topLeft.x - buffer, topLeft.y - buffer, bottomRight.x + buffer, bottomRight.y + buffer);
if (box.contains(p))
{
    //now run the test provided by Alan
    if (test)
        return true;
}
return false; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-18T14:06:09.063

这是一个可以解决问题的python函数。它应该在 2 或 3 维（或更多）中工作，并且在没有特殊情况的情况下处理垂直和水平线。如果设置`clipToSegment`为 true，则如果投影线超出提供的线段，则返回的点将被剪裁到末端。

```
def nearestPointOnLine(pt, r0, r1, clipToSegment = True):
    r01 = r1 - r0           # vector from r0 to r1 
    d = np.linalg.norm(r01) # length of r01
    r01u = r01 / d          # unit vector from r0 to r1
    r = pt - r0             # vector from r0 to pt
    rid = np.dot(r, r01u)   # projection (length) of r onto r01u
    ri = r01u * rid         # projection vector
    lpt = r0 + ri           # point on line

    if clipToSegment:       # if projection is not on line segment
        if rid > d:         # clip to endpoints if clipToSegment set
            return r1
        if rid < 0:
            return r0 

    return lpt 
```

用法：（点[4,5]到[2,4]到[4,6]线段的距离）

```
r0 = np.array([2,4])
r1 = np.array([4,6])
rpt = np.array([4,5])
pt = nearestPointOnLine(rpt, r0, r1, True)

dist = np.linalg.norm(rpt-pt)
print('dist', dist) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:16:05.767

基本上，你想要做的是找到与你的点和线相交的法线——即一条垂直于你的线的线，然后计算沿着这条线的距离。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T14:16:23.427

近到什么程度？

有些几何会给你你需要的答案，你只需要注意以下步骤。

假设你喜欢的形式是 y=mx+b，那么到你的点的最短距离将是垂直于你的起点的线 (m1=-1/m)，与你的点相交。

从那里您可以计算交点和相关点之间的距离。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-21T07:33:08.397

计算线上最接近该点的点。

假设线段是a和b，点是p。

```
float vAPx = p.x - a.x;
float vAPy = p.y - a.y;
float vABx = b.x - a.x;
float vABy = b.y - a.y;
float sqDistanceAB = a.distanceSq(b);
float ABAPproduct = vABx*vAPx + vABy*vAPy;
float amount = ABAPproduct / sqDistanceAB;
if (amount > 1) amount = 1;
if (amount < 0) amount = 0; 
```

这给了你“数量”，你在 A 和 B 之间的线段有多远（适当的界限）。

```
 float nx = (amount * (b.x - a.x)) + a.x;
    float ny = (amount * (b.y - a.y)) + a.y; 
```

给你点（nx，ny）。

```
if (p.distance(nx,ny) > threshold) reject; 
```

这将在线段结束后正常工作，因为它将“数量”保持在 0 和 1 之间。

如果您不希望它是有界线段，请摆脱数量的界限。其余的代码仍然可以工作，计算 A 之后和之前和 B 之外的位置。

还有另一个问题声称这个问题是重复的，但是它要求不同的东西，因此我的解决方案解决了点的位置，然后只解决了欧几里得距离（实际上解决了这两个问题）。

a.distanceSq(b) 也可以作为 vABx *vABx + vABy* vABy 完成，因为我们已经完成了这些。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-26T14:16:00.387

谷歌是你的朋友：[点线距离（二维）](http://mathworld.wolfram.com/Point-LineDistance2-Dimensional.html)。您可以使用底部的等式，然后就可以了。

# twitter - 通过 #topic 搜索具有不同用户的 Twitter 推文

> ID：910890
> 
> 赞同：0
> 
> 时间：2009-05-26T14:08:00.247
> 
> 标签：twitter

什么是显示不同用户在#topic 上的最新推文的好方法？例如，如果五个用户在#example 上总共写了 20 条推文，但一个狂热者拥有最近的 15 条，我只想要他的最新。

重复消除是一个优点，因为鹦鹉的价值很低。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:21:18.173

使用 Twitter 搜索 API 无法做到这一点 - 您需要下拉提要并对其进行自己的后期处理。

# javascript - 在 IE7 和 8 中使用 javascript 将内容动态添加到 UI 中

> ID：910893
> 
> 赞同：0
> 
> 时间：2009-05-26T14:09:35.453
> 
> 标签：javascript, html, css, dynamic

谁能帮忙？

我有一个简单的 html 文件，我通过 javascript 填充，在 Firefox 中，下面的所有内容都会自动调整大小，因此我添加的内容越多，下面的内容（在另一个 div 中）就会向下移动，但在 IE 中它不会。我正在使用溢出设置为可见

这是 html（部分）- 我要添加的 id="extras"，我要添加许多复选框和组合框等

```
 <ul id="extras" style="padding:0px; margin:0px; list-style:none; ">
  <li style="width:248px; background-repeat:no-repeat; float:left; "> 
```

我正在使用的 javascript 基本上我已经加载到另一个文件 html 文件中并获取对它的引用并添加控件等。

我唯一的特别之处是将溢出设置为可见，正如我所说的它在 Firefox 中效果很好，但 IE .. 页脚（另一个 div 中的下面的内容）不会调整大小，所以这个内容与页脚重叠 - 好吧其中一些。

```
tempDetails.prototype.showData= function() {
    if (this.req.readyState == 4) {
        var container = this.loadedLayer;
        container.style.overflow = 'visible';

        container.innerHTML = " ";
        container.innerHTML = this.req.responseText; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:32:51.240

确保您的[浮动已清除](http://www.quirksmode.org/css/clearing.html)，或者您在 UL 容器上使用[clearfix hack 。](http://www.webtoolkit.info/css-clearfix.html)

# ms-access - Access 2002 - 如何在同一查询中分组和前 N 条记录

> ID：910894
> 
> 赞同：0
> 
> 时间：2009-05-26T14:09:40.210
> 
> 标签：ms-access

我的数据如下所示：

```
Group     Product    PercentAch
Gr1       Pr1        55%
Gr1       Pr2        65%
Gr2       Pr1        45%
Gr2       Pr2        95%
Gr3       Pr1        15%
Gr3       Pr2        35%
.
.
. 
```

因此，基本上数据描述了一组分配给不同组的不同产品。我正在尝试创建一个查询，该查询将为我检索基于 PercentAch 按产品分组的前 N% 的记录。Access 帮助文件说按 PercentAch 排序以使用 TOP 属性，但这会导致组和产品混合在一起。我的另一个选择是为每个组/产品组合创建一个单独的查询，这似乎是多余的。有没有办法只使用一个（或两个）查询来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:40:23.593

您需要使用唯一标识符，否则如果您在同一组中有多个具有相同 PercentAch 的产品，您将获得所有这些产品......即超过您想要的前 5%。假设我们在产品上有一个唯一的 ID。SQL 将是：

```
SELECT Group, ProductID, Product, PercentAch
FROM SalesPerformance
WHERE ProductID IN (
    SELECT TOP 5 PERCENT ProductID
    FROM SalesPerformance as S
    WHERE S.Group = SalesPerformance.Group
    ORDER BY PercentAch DESC
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T17:44:04.427

这是你的答案。对不起，但我花了一段时间才明白这一点。我知道我以前见过这个：

ACC：如何为每个组查询创建前 N 个值：http: [//support.microsoft.com/kb/153747](http://support.microsoft.com/kb/153747)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-04T08:48:28.480

在一天的大部分时间里，我一直在试图找出完全相同的问题。事实证明，答案只是添加`Product`到子查询的`WHERE`子句中。

```
SELECT Group, Product, PercentAch
FROM SalesPerformance
WHERE PercentAch IN (
    SELECT TOP 5 PERCENT PercentAch 
    FROM SalesPerformance as S
    WHERE S.Group = SalesPerformance.Group and S.Product = SalesPerformance.Product
    ORDER BY PercentAch DESC
); 
```

这给了我每个组/产品组合的 PercentAch 值的前 5%。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:21:06.130

您需要两个查询。Top 查询需要分组查询的输出。如果您尝试将 Top 与 Group 放在同一查询中，Top 将作用于原始源数据，而不是分组数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T19:38:50.893

杰，这里是：

```
SELECT Group, Product, PercentAch
FROM SalesPerformance
WHERE PercentAch IN (
    SELECT TOP 5 PERCENT PercentAch 
    FROM SalesPerformance as S
    WHERE S.Group = SalesPerformance.Group
    ORDER BY PercentAch DESC
); 
```

您想要每组中前 5% 的记录，还是只想要前 5 名？如果您只想要每个组中的前 5 条记录，请从查询中删除 PERCENT 关键字。

# flash - 使用 SWFBridge 处理刷新 AS3 和 AS2 swfs 之间的 localConnection 的最佳方法是什么？（加载，卸载，再次加载）

> ID：910903
> 
> 赞同：0
> 
> 时间：2009-05-26T14:11:21.720
> 
> 标签：flash, actionscript-3, actionscript, actionscript-2, localconnection

我有一个由 AS3 swf 托管的 AS2 swf，它们使用 SWFBridge 进行连接。在此过程中，我需要卸载 AS2 swf 并重新加载它。因此我假设我需要重新建立 SWFBridge 连接。但是当我尝试重新打开连接时，它似乎不起作用。这是我所拥有的-

**AS3 代码：**

```
var myBridge:SWFBridgeAS3;
function setUpBridge() :void {
   myBridge = new SWFBridgeAS3("connectionID", this);
   myBridge.addEventListener(Event.CONNECT, handleConnect);
}
setUpBridge(); // the first time
loadAS2SWF(); // loads the As2 swf using Loader class 
```

*... 一段时间以后*

```
loader.unload(); // unload the AS2 swf
myBridge.close();
setUpBridge();
loadAS2SWF(); 
```

谁能看到我做错了什么？首次加载 AS2 swf 时一切正常，但在后续加载中未建立连接....

...顺便说一句-似乎在重新连接时，从主机到客户端的通信正常，但没有收到从客户端到主机 swf 的函数调用？令人困惑！

谢谢

- - - - - - - - - - - - - - - - - - - 更新 - - - - - - -------------------------------------------

我发现当我打开 2 个浏览器窗口时，SWFBridge 不起作用。使用相同 ID 的连接似乎存在问题。[有关此问题的讨论和一些解决方法，请在 Grant Skinner 的博客](http://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html)上搜索“多连接问题”

希望这可以帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T11:59:12.263

嗯，看看实现，它看起来会完美地工作，如果你只创建一个桥并让它保持连接，因为它通常是主机，因为之后加载 as2 电影......

这里没有 flex sdk ......你能检查一下吗？

问候

back2dos

# php - 从 PHP 中的文本中提取 URL

> ID：910912
> 
> 赞同：47
> 
> 时间：2009-05-26T14:13:55.523
> 
> 标签：php, html, regex

我有这段文字：

```
$string = "this is my friend's website http://example.com I think it is coll"; 
```

如何将链接提取到另一个变量中？

我知道应该特别使用正则表达式`preg_match()`，但我不知道怎么做？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2011-04-17T00:27:58.490

可能最安全的方法是使用 WordPress 的代码片段。下载最新版本（当前为 3.1.1）并查看 wp-includes/formatting.php。有一个名为 make_clickable 的函数，它具有纯文本的参数并返回格式化的字符串。您可以获取用于提取 URL 的代码。不过这很复杂。

这一行正则表达式可能会有所帮助。

```
preg_match_all('#\bhttps?://[^\s()<>]+(?:\([\w\d]+\)|([^[:punct:]\s]|/))#', $string, $match); 
```

但是这个正则表达式仍然无法删除一些格式错误的 URL（例如`http://google:ha.ckers.org`）。

另请参阅： [如何模仿 StackOverflow 自动链接行为](https://stackoverflow.com/questions/1925455/how-to-mimic-stackoverflow-auto-link-behavior)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-03-23T11:24:42.867

我尝试按照 Nobu 所说的那样做，使用 Wordpress，但是由于对其他 WordPress 函数的依赖性很大，我选择使用 Nobu 的正则表达式 for[`preg_match_all()`](http://php.net/preg_match_all)并将其变成一个函数，使用[`preg_replace_callback()`](http://php.net/preg_replace_callback); 现在用可点击的链接替换文本中的所有链接的功能。它使用[匿名函数](http://php.net/manual/en/functions.anonymous.php)，因此您需要 PHP 5.3，或者您可以重写代码以使用普通函数。

```
<?php 

/**
 * Make clickable links from URLs in text.
 */

function make_clickable($text) {
    $regex = '#\bhttps?://[^\s()<>]+(?:\([\w\d]+\)|([^[:punct:]\s]|/))#';
    return preg_replace_callback($regex, function ($matches) {
        return "<a href=\'{$matches[0]}\'>{$matches[0]}</a>";
    }, $text);
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-26T14:21:26.707

URL 有一个相当[复杂的定义](http://en.wikipedia.org/wiki/URI_scheme#Generic_syntax)——您必须先决定要捕获的内容。`http://`一个简单的示例捕获以and开头的任何内容`https://`：

```
preg_match_all('!https?://\S+!', $string, $matches);
$all_urls = $matches[0]; 
```

请注意，这是非常基本的，可能会捕获无效的 URL。对于更复杂的事情，我建议使用[POSIX](http://en.wikipedia.org/wiki/Regular_expression#POSIX_Basic_Regular_Expressions)和[PHP 正则表达式。](http://php.net/manual/en/regexp.reference.php)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-04-12T06:42:00.420

对我有用的代码（特别是如果您的 中有多个链接`$string`）：

```
$string = "this is my friend's website https://www.example.com I think it is cool, but this one is cooler https://www.stackoverflow.com :)";
$regex = '/\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i';
preg_match_all($regex, $string, $matches);
$urls = $matches[0];
// go over all links
foreach($urls as $url) 
{
    echo $url.'<br />';
} 
```

希望对其他人也有帮助。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-26T14:30:59.917

如果您从中提取 URL 的文本是用户提交的，并且您要将结果显示为任何地方的链接，那么您必须非常非常小心地避免[XSS 漏洞](https://en.wikipedia.org/wiki/Cross-site_scripting)，最突出的是“javascript:”协议 URL，而且[格式错误](http://ha.ckers.org/xss.html)可能会欺骗您的正则表达式和/或显示浏览器将它们作为 Javascript URL 执行的 URL [。](http://ha.ckers.org/xss.html)至少，您应该只接受以“http”、“https”或“ftp”开头的 URL。

Jeff也有 [一篇博客文章，他在其中描述了提取 URL 的一些其他问题。](https://blog.codinghorror.com/the-problem-with-urls/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-26T14:19:40.877

```
preg_match_all('/[a-z]+:\/\/\S+/', $string, $matches); 
```

这是一种简单的方法，适用于很多情况，而不是全部。所有匹配项都放在 $matches 中。请注意，这不包括锚元素中的链接（<a href=""...），但这也不是在您的示例中。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-12-24T06:02:52.283

你可以这样做..

```
<?php
$string = "this is my friend's website http://example.com I think it is coll";
echo explode(' ',strstr($string,'http://'))[0]; //"prints" http://example.com 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-09-01T12:54:55.830

```
preg_match_all ("/a[\s]+[^>]*?href[\s]?=[\s\"\']+".
                "(.*?)[\"\']+.*?>"."([^<]+|.*?)?<\/a>/",
                $var, &$matches);

$matches = $matches[1];
$list = array();

foreach($matches as $var)
{    
    print($var."<br>");
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-11T08:44:38.300

您可以尝试这个来找到链接并修改链接（添加 href 链接）。

```
$reg_exUrl = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";

// The Text you want to filter for urls
$text = "The text you want to filter goes here. http://example.com";

if(preg_match($reg_exUrl, $text, $url)) {

       echo preg_replace($reg_exUrl, "<a href="{$url[0]}">{$url[0]}</a> ", $text);

} else {

       echo "No url in the text";

} 
```

参考这里： http: [//php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-04-22T18:21:21.237

```
<?php
preg_match_all('/(href|src)[\s]?=[\s\"\']?+(.*?)[\s\"\']+.*?/', $webpage_content, $link_extracted); 
```

[预习](https://i.stack.imgur.com/K3g0d.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-01-25T18:49:03.703

有很多带有 url 的边缘情况。像 url 可以包含括号或不包含协议等。这就是为什么正则表达式是不够的。

我创建了一个可以处理很多边缘情况的 PHP 库：[Url highlight](https://github.com/vstelmakh/url-highlight)。

例子：

```
<?php

use VStelmakh\UrlHighlight\UrlHighlight;

$urlHighlight = new UrlHighlight();
$urlHighlight->getUrls("this is my friend's website http://example.com I think it is coll");
// return: ['http://example.com'] 
```

有关更多详细信息，请参阅[自述文件](https://github.com/vstelmakh/url-highlight/blob/master/README.md)。对于涵盖的 url 案例，请参阅[test](https://github.com/vstelmakh/url-highlight/blob/master/tests/UrlHighlightTest.php#L11)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-09-19T13:05:07.113

这个正则表达式对我很有用，我检查了所有类型的 URL，

```
<?php
$string = "Thisregexfindurlhttp://www.rubular.com/r/bFHobduQ3n mixedwithstring";
preg_match_all('/(https?|ssh|ftp):\/\/[^\s"]+/', $string, $url);
$all_url = $url[0]; // Returns Array Of all Found URL's
$one_url = $url[0][0]; // Gives the First URL in Array of URL's
?> 
```

检查了很多 URL 可以在这里找到[http://www.rubular.com/r/bFHobduQ3n](http://www.rubular.com/r/bFHobduQ3n)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-03-07T04:35:15.497

这是我使用的一个函数，不记得它来自哪里，但似乎在文本中查找链接方面做得很好。并使它们成为链接。

您可以更改功能以满足您的需要。我只是想在环顾四周时分享这个，并记得我在我的一个助手库中有这个。

```
function make_links($str){

  $pattern = '(?xi)\b((?:https?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:\'".,<>?«»“”‘’]))';

  return preg_replace_callback("#$pattern#i", function($matches) {
    $input = $matches[0];
    $url = preg_match('!^https?://!i', $input) ? $input : "http://$input";
    return '<a href="' . $url . '" rel="nofollow" target="_blank">' . "$input</a>";
  }, $str);
} 
```

利用：

```
$subject = 'this is a link http://google:ha.ckers.org maybe don't want to visit it?';
echo make_links($subject); 
```

输出

```
this is a link <a href="http://google:ha.ckers.org" rel="nofollow" target="_blank">http://google:ha.ckers.org</a> maybe don't want to visit it? 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-08-23T08:08:49.100

```
public function find_links($post_content){
    $reg_exUrl = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";
    // Check if there is a url in the text
    if(preg_match_all($reg_exUrl, $post_content, $urls)) {
        // make the urls hyper links,
        foreach($urls[0] as $url){
            $post_content = str_replace($url, '<a href="'.$url.'" rel="nofollow"> LINK </a>', $post_content);
        }
        //var_dump($post_content);die(); //uncomment to see result
        //return text with hyper links
        return $post_content;
    } else {
        // if no urls in the text just return the text
        return $post_content; 
    }
} 
```

# actionscript-3 - AS3-是否可以从字符串中调用变量？

> ID：910913
> 
> 赞同：3
> 
> 时间：2009-05-26T14:13:57.627
> 
> 标签：actionscript-3

有没有办法让“getDefinitionByName()”适用于任何对象类型，我只让它适用于一个类：

```
 var test:Class = getDefinitionByName("myClass") as Class; 
```

我需要类似的东西：

```
var myNumber:Number = 10; 
var test:Number = getDefinitionByName("myNumber") as Number;

trace(test); //10 
```

还是有另一种方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:14:19.737

您应该在 KeyCodes 类中将您的密钥代码定义为公共**静态常量：**

```
class KeyCodes { 
    public static const A:int = 65;
} 
```

然后，您可以将它们用作函数的参数`useKeyCodes`：

```
useKeyCodes(KeyCodes.A); 
```

这样您就不必记住每个关键代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:31:35.080

不。

这是简短的答案， getDefinitionByName 获取类定义。您可以使用 [] 语法访问公共字段和函数，如`trace(this["myNumber"]);`. 您的示例似乎带有一个确实没有意义的局部变量。

也许你可以解释你想做什么，这听起来像是你可以设计出来的东西。

# javascript - Flex：使 SWF 的高度 == 内容的高度？

> ID：910915
> 
> 赞同：2
> 
> 时间：2009-05-26T14:14:30.513
> 
> 标签：javascript, html, flash, apache-flex, actionscript

我将在 html 页面上嵌入一个 Flex 应用程序。html 页面已经有了一个可以上下滚动的滚动条。flex 应用程序的内容是非常动态的，当已经有滚动条时，我不希望有额外的滚动条。那么有没有办法让 swf 的高度与 swf 内容的高度相匹配呢？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:51:20.570

让 SWF 调用 ExternalInterface 以在 JavaScript 中调整自身大小。

1.  SWF 加载等待其所有内容加载和布局。
2.  布置好所有内容后，SWF 会对您用 JavaScript 编写的函数进行 ExternalInterface 调用，以调整 SWF 的大小
3.  SWF 在主要内容上添加了一个调整大小事件侦听器，以防万一发生任何变化。

# python - 在 3d 空间中存储点的信息

> ID：910930
> 
> 赞同：5
> 
> 时间：2009-05-26T14:17:04.423
> 
> 标签：python, data-structures, 3d, matrix, numpy

我正在用 Python 编写一些代码（到目前为止只是为了好玩），它将在 3d 空间中的每个点上存储一些数据。我基本上是在存储任意对象的 3d 矩阵对象之后，这些对象将允许我进行一些高级选择，例如：

*   得到 x=1,y=2,z=3 的点。
*   获取 y=2 的所有点。
*   获取位置 x=1,y=2,z=3 的 3 个单位内的所有点。
*   获取 point.getType() == "Foo" 的所有点

在上述所有内容中，我需要最终得到某种输出，以提供空间中的原始位置以及该点存储的数据。

显然 numpy 可以做我想做的事，但它似乎对科学计算进行了高度优化，并且到目前为止我还没有弄清楚如何获得我想要的数据。

有没有更好的选择，还是我应该回到把头撞在麻木墙上？:)

编辑：前三个答案的更多信息让我意识到我应该包括：我不担心性能，这纯粹是一个概念验证，我更喜欢干净的代码而不是良好的性能。我还将拥有给定 3d 空间中每个点的数据，所以我猜备用矩阵不好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T15:30:30.423

这是另一种常见的方法

```
class Point( object ):
    def __init__( self, x, y, z, data ):
        self.x, self.y, self.z = x, y, z
        self.data = data
    def distFrom( self, x, y, z )
        return math.sqrt( (self.x-x)**2 + (self.y-y)**2 + (self.z-z)**2 )

database = [ Point(x,y,z,data), Point(x,y,z,data), ... ] 
```

让我们看看您的用例。

得到 x=1,y=2,z=3 的点。

```
[ p for p in database if (p.x, p.y, p.z) == ( 1, 2, 3 ) ] 
```

获取 y=2 的所有点。

```
[ p for p in database if p.y == 2 ] 
```

获取位置 x=1,y=2,z=3 的 3 个单位内的所有点。

```
[ p for p in database if p.distFrom( 1, 2, 3 ) <= 3.0 ] 
```

获取 point.getType() == "Foo" 的所有点

```
[ p for p in database if type(p.data) == Foo ] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T14:20:43.713

嗯...如果您希望真正*填充*该空间，那么您可能最好使用密集的矩阵状结构，基本上是[体素](http://en.wikipedia.org/wiki/Voxel)。

如果您不希望填充它，请研究一些更优化的东西。我将从查看[octrees](http://en.wikipedia.org/wiki/Octree)开始，它们通常用于此类事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:50:21.453

numpy 的一个优点是它非常快，例如计算 8000x8000 邻接矩阵的 pagerank 需要几毫秒。即使`numpy.ndarray`只接受数字，您也可以将数字/id-对象映射存储在外部哈希表中，即字典（这又是一个高度优化的数据结构）。

切片就像 python 中的列表切片一样简单：

```
>>> from numpy import arange

>>> the_matrix = arange(64).reshape(4, 4, 4)
>>> print the_matrix[0][1][2]
    6
>>> print the_matrix[0][1]
    [4 5 6 7]
>>> print the_matrix[0]
    [[ 0  1  2  3]
    [ 4  5  6  7]
    [ 8  9 10 11]
    [12 13 14 15]] 
```

如果你将一些你想要的函数（距离）包裹在一些核心矩阵和一个 id-object-mapping 哈希上，你可以让你的应用程序在很短的时间内运行。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:40:16.157

您可以在 numpy 中使用切片进行前 2 个查询：

```
a = numpy.zeros((4, 4, 4))
a[1, 2, 3] # The point at x=1,y=2,z=3
a[:, 2, :] # All points where y=2 
```

对于第三个，如果您的意思是“获取半径为 3 且以 x=1,y=2,z=3 为中心的球体内的所有点”，您将必须编写一个自定义函数来执行此操作；如果你想要一个立方体，你可以继续切片，例如：

```
a[1:3, 1:3, 1:3] # The 2x2x2 array sliced from the center of 'a' 
```

对于第四个查询，如果存储在数组中的唯一数据是单元格类型，则可以将其编码为整数：

```
FOO = 1
BAR = 2
a = numpy.zeros((4, 4, 4), dtype="i")
a[1, 2, 3] = FOO
a[3, 2, 1] = BAR
def filter(a, type_code):
    coords = []
    for z in range(4):
        for y in range(4):
            for x in range(4):
                if a[x, y, z] == type_code:
                    coords.append((x, y, z))
    return coords
filter(a, FOO) # => [(1, 2, 3)] 
```

numpy 看起来是做你想做的事的好工具，因为数组在内存中会更小，在 C 中很容易访问（甚至更好，[cython](http://www.cython.org/)！）并且扩展的切片语法将避免你编写代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T14:51:03.653

这是一种可能有效的方法。

每个点都是一个 4 元组 (x,y,z,data)，您的数据库如下所示：

```
database = [ (x,y,z,data), (x,y,z,data), ... ] 
```

让我们看看您的用例。

得到 x=1,y=2,z=3 的点。

```
[ (x,y,z,data) for x,y,z,data in database if (x,y,z) == (1,2,3) ] 
```

获取 y=2 的所有点。

```
[ (x,y,z,data) for x,y,z,data in database if y == 2 ] 
```

获取位置 x=1,y=2,z=3 的 3 个单位内的所有点。

```
[ (x,y,z,data) for x,y,z,data in database if math.sqrt((x-1)**2+(y-2)**2+(z-3)**2)<=3.0 ] 
```

获取 point.getType() == "Foo" 的所有点

```
[ (x,y,z,data) for x,y,z,data in database if type(data) == Foo ] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T15:59:24.310

[何时使用二进制空间分区、四叉树、八叉树？](https://stackoverflow.com/questions/99796/when-to-use-binary-space-partitioning-quadtree-octree)

3d 数组 imo 毫无价值。特别是如果你的世界是动态的。您应该在 BSP、四叉树或八叉树之间做出选择。BSP 会做得很好。由于您的世界是 3d 的，因此在拆分 bsp 时需要平面，而不是线。

干杯！

编辑

> 我还将拥有给定 3d 空间中每个点的数据，所以我猜备用矩阵不好？

我想如果总是知道你的数据集有多大并且它永远不会改变，那就没问题了，即如果更多的点被添加到它又超出了界限。在这种情况下，您必须调整 3d 数组的大小。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T17:06:27.560

如果您想要一个使用标准库的相对简单的解决方案，则使用带有 x,y,z 元组作为键的字典是另一种解决方案。

```
import math

#use indexing to get point at (1,2,3): points[(1,2,3)]
get_points(points, x=None, y=None, x=None):
    """returns dict of all points with given x,y and/or z values.  Call using keywords (eg get_points(points, x=3)"""
    filteredPoints = points.items()
    if x:
        filteredPoints = [p for p in filteredPoints if p[0][0] == x]
    if y:
        filteredPoints = [p for p in filteredPoints if p[0][1] == y]
    if z:
        filteredPoints = [p for p in filteredPoints if p[0][0] == x]
    return dict(filteredPoints)

get_point_with_type(points, type_):
    """returns dict of points with point.getType() == type_"""
    filteredPoints = points.items()
    return dict((position,data) for position,data in points.iterItems() if data.getType == type_)

get_points_in_radius(points,x,y,z,r):
    """Returns a dict of points within radius r of point (x,y,z)"""
    def get_dist(x1,y1,z1,x2,y2,z3):
        return math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2)+(z1-z2)*(z1-z2))
    return dict((position,data) for position,data in points.iterItems() if get_dist(x,y,z, *position) <= r)) 
```

而且由于python引用，您可以更改返回字典中的“点”，并且原始点也可以更改（我认为）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-26T14:27:14.277

这取决于系统的精确配置，但从您给出的示例中，您使用的是整数和离散点，因此考虑[稀疏矩阵](http://en.wikipedia.org/wiki/Sparse_matrix)数据结构可能是合适的。

# c# - 如何将事件绑定到不同类型的强类型数据集？

> ID：910950
> 
> 赞同：1
> 
> 时间：2009-05-26T14:20:15.027
> 
> 标签：c#, reflection, inheritance, strongly-typed-dataset

我的应用程序包含几个表单，其中包括一个强类型数据网格视图、一个强类型绑定源和一个强类型表适配器。

每当用户离开当前行、将焦点从数据网格或表单上移开或关闭表单时，我都会在每个表单中使用一些代码来更新数据库。

这段代码在每种情况下都是相同的，所以我想创建一个表单的子类，所有这些表单都可以从中继承。

但是强类型数据对象都继承自组件，它不会暴露我想要绑定的事件或我想要调用的方法。

我能看到访问事件的唯一方法是使用：`Type(string Name).GetEvent(string EventName).AddEventHandler(object Target,Delegate Handler)`

同样，我想调用强类型表适配器的 Update 方法，并且正在使用`Type(string Name).GetMethod(String name, Type[] params).Invoke(object target, object[] params)`.

它工作正常，但似乎非常沉重。有没有更好的办法？

这是我的主类代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data;
using System.Data.SqlClient;
using System.ComponentModel;

namespace MyApplication
{
    public class AutoSaveDataGridForm: Form
    {
        private DataRow PreviousRow;

        public Component Adapter
        {
            private get;
            set;
        }

        private Component dataGridView;
        public Component DataGridView
        {
            private get
            {
                return dataGridView;
            }
            set
            {
                dataGridView = value;
                Type t = dataGridView.GetType();
                t.GetEvent("Leave").AddEventHandler(dataGridView, new EventHandler(DataGridView_Leave));

            }
        }
        private Component bindingSource;
        public Component BindingSource
        {
            private get
            {
                return bindingSource;
            }
            set
            {
                bindingSource = value;
                Type t = bindingSource.GetType();
                t.GetEvent("PositionChanged").AddEventHandler(bindingSource, new EventHandler(BindingSource_PositionChanged));

            }
        }

        protected void Save()
        {
            if (PreviousRow != null && PreviousRow.RowState != DataRowState.Unchanged)
            {
                Type t = Adapter.GetType();
                t.GetMethod("Update", new Type[] { typeof(DataRow[]) }).Invoke(Adapter, new object[] { new DataRow[] { PreviousRow } });

            }

        }

        private void BindingSource_PositionChanged(object sender, EventArgs e)
        {
            BindingSource bindingSource = sender as BindingSource;
            DataRowView CurrentRowView = bindingSource.Current as DataRowView;
            DataRow CurrentRow = CurrentRowView.Row;
            if (PreviousRow != null && PreviousRow != CurrentRow)
            {
                Save();
            }
            PreviousRow = CurrentRow;

        }

        private void InitializeComponent()
        {
            this.SuspendLayout();
            // 
            // AutoSaveDataGridForm
            // 
            this.FormClosed += new System.Windows.Forms.FormClosedEventHandler(this.AutoSaveDataGridForm_FormClosed);
            this.Leave += new System.EventHandler(this.AutoSaveDataGridForm_Leave);
            this.ResumeLayout(false);

        }

        private void DataGridView_Leave(object sender, EventArgs e)
        {
            Save();
        }

        private void AutoSaveDataGridForm_FormClosed(object sender, FormClosedEventArgs e)
        {
            Save();
        }

        private void AutoSaveDataGridForm_Leave(object sender, EventArgs e)
        {
            Save();
        }

    }
} 
```

这是一个实现它的（部分）表单：

```
 public partial class FileTypesInherited :AutoSaveDataGridForm
{
    public FileTypesInherited()
    {
        InitializeComponent();
    }

    private void FileTypesInherited_Load(object sender, EventArgs e)
    {
        // TODO: This line of code loads data into the 'sharedFoldersInformationV2DataSet.tblFileTypes' table. You can move, or remove it, as needed.
        this.tblFileTypesTableAdapter.Fill(this.sharedFoldersInformationV2DataSet.tblFileTypes);
        this.BindingSource = tblFileTypesBindingSource;
        this.Adapter = tblFileTypesTableAdapter;
        this.DataGridView = tblFileTypesDataGridView;

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-15T02:49:38.977

这演示了如何为您的类型化数据集使用“MustInherit”基类，以访问未公开的属性。

将此设置为每个键入的 TableAdapter 的“BaseClass”，替换“System.ComponentModel.Component”。通过使用“MustInherit/MustOverride”（C# 中的“Abstract”），您可以获得其他方式无法访问的属性。

```
Public MustInherit Class SuperTableAdapter
    Inherits System.ComponentModel.Component

    Public MustOverride ReadOnly Property MyCommandCollection As Data.SqlClient.SqlCommand()

    Public Sub New()
        MyBase.New()
        'With the command collection exposed, you can replace it with your own.  You can do the same for events.'

        For i = 0 To MyCommandCollection.Length - 1
             Dim myspecialCommand As New Data.SqlClient.SqlCommand()
            MyCommandCollection(i) = myspecialCommand
        Next
    End Sub
End Class 
```

对于您设置为继承 BaseClass 的每个表适配器，您必须覆盖所需的“MustOverride”属性。没有它，它将无法编译。如果添加代码但不设置 TableAdapter 基类，它也不会编译。那是好事；它确保你做对了。

```
Namespace DataSet1TableAdapters
    Partial Public Class Table1TableAdapter
        Public Overrides ReadOnly Property MyCommandCollection As System.Data.SqlClient.SqlCommand()
            Get
                Return Me.CommandCollection
            End Get
        End Property
    End Class

    Partial Public Class Table2TableAdapter
        Public Overrides ReadOnly Property MyCommandCollection As System.Data.SqlClient.SqlCommand()
            Get
                Return Me.CommandCollection
            End Get
        End Property
    End Class
End Namespace 
```

现在您可以将各种特殊代码放入您的 SuperTableAdapter。如果您需要访问未公开的内容，只需使用“MustOverride”来保证它可用。

# indexing - 当没有一个字段一起使用时，为什么会有聚集复合索引？

> ID：910959
> 
> 赞同：1
> 
> 时间：2009-05-26T14:21:24.260
> 
> 标签：indexing, sql-server-2000, clustered-index, composite-index

在旧数据库 (SQL Server 2000) 中，我们有一个如下所示的聚集索引：

```
CREATE CLUSTERED INDEX [IX_usr] ON [dbo].[usr] 
(
    [uid] ASC,
    [ssn] ASC,
    [lname] ASC
) 
```

问题是，据我所知，这些字段都没有在 WHERE 子句中一起使用。也没有任何理由将它们中的任何一个一起使用。有任何理由拥有这样的聚集索引吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:28:58.643

我能想到的一个原因是，如果您在许多 select 语句中只使用这些字段（不一定在 where 子句中），它可以用作覆盖索引。

例如，如果您有很多这样的查询：

```
SELECT uid, ssn, lname FROM usr WHER uid = x 
```

由于所有必填字段都在索引中，因此查询实际上不必命中表。

# gcc - 从 Winarm 迁移到 Yagarto

> ID：910961
> 
> 赞同：3
> 
> 时间：2009-05-26T14:21:54.647
> 
> 标签：gcc, embedded, arm

这个问题一定适用于这么少的人……

我正忙着将我的 ARM C 项目从 Winarm GCC 4.1.2 迁移到 Yagarto GCC 4.3.3。

我没想到会有任何差异，并且都使用相同的 makefile 和 .ld 文件愉快地编译了我的项目。

然而，虽然 Winarm 版本运行 Yagarto 版本却没有。处理器是 Atmel AT91SAM7S。

任何关于在哪里看的想法都将受到欢迎。我在想我关于makefile 是makefile 的假设是不正确的，或者Winarm 的.ld 文件不适用于Yagarto。

由于它们都是 GCC 工具链并且可能使用相同的链接器，因此它们肯定是兼容的。

TIA

结束。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T06:06:55.683

我同意 gcc 和其他二进制文件 (ld) 应该相同或足够接近，以使您不会注意到差异。但是无论是你的还是他们的，启动代码和 C 库都会产生很大的不同。足以在尝试使用相同的源代码和链接器脚本时区分成功与失败。现在，如果这是 100% 你的代码，没有库或任何其他从 WinARM 或 Yagarto 使用的文件，那么这没有多大意义。3.xx 到 4.xx 是的，我不得不重新旋转我的链接器脚本，但是 4.1.x 到 4.3.x 我不记得那里有问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-06T19:26:14.697

这也可能是编译器行为的细微差别：代码生成确实从 gcc 版本更改为 gcc 版本，并且如果您的代码包含其语义依赖于实现的片段，那么它很可能会以这种方式咬住您。例如，数据的内存布局可能会发生变化，并且意外依赖它的代码会中断。

看到这种情况发生了很多次。

在编译中尝试使用不同的优化选项，看看是否会有所不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T06:15:12.583

如果我是你，我会检查编译/链接器标志 - 特别是默认值。不同的工具链具有不同的默认 ABI 或 FP 约定是很常见的。它甚至可能使用您的 CPU 不支持的指令集扩展进行编译。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T07:53:23.733

WinARM 和 YAGARTO 都是基于 gcc 的，应该平等对待 ld 文件。两者都使用 gnu make 实用程序 - make 文件将以相同的方式处理。[您可以在此处](http://www.siwawi.arubi.uni-kl.de/avr_projects/arm_projects/#winarm)和[此处](http://www.yagarto.de/)比较两个工具链。

如果您使用 OCD 运行项目，那么 OpenOCD 调试器的实现会有所不同。此外，发送到调试器以对其进行配置的命令也可能不同。

如果您正在生成一个 hex 文件，那么这可能会有所不同，因为两个工具链没有使用相同版本的 newlib 库。

为了安全起见，请确保在这两种情况下，正确的 binutils 都位于路径的首位。

# c# - 动态铸造

> ID：910969
> 
> 赞同：2
> 
> 时间：2009-05-26T14:24:10.680
> 
> 标签：c#, casting

如何在运行时将参数转换为函数？

```
private object PopulateObject(object dataObj, System.Data.DataRow dataRow, string query)
{

    object = DataAccess.Retriever.RetrieveArray<dataObj.GetType()>(query); 
```

我想知道如何在运行时在类型声明中获取 dataObj.GetType() 。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T14:26:14.327

尝试这样的事情：

```
private T PopulateObject<T>(T dataObj, System.Data.DataRow dataRow, string query)
{
    dataObj = DataAccess.Retriever.RetrieveArray<T>(query);
} 
```

这将允许您避免此方法中的任何反射，因为提供给`PopulateObject`的类型参数也将是`RetrieveArray`. 通过调用此方法，编译器将能够推断 的类型`T`，从而避免编写运行时类型检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:28:21.577

你不能这样做，因为变量声明发生在编译时，而不是运行时。您应该创建一个通用方法。

```
private T PopulateObject<T>(T dataObj, DataRow dataRow, String query)
{
    return DataAccess.Retriever.RetrieveArray<T>(query);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:29:09.283

您想知道如何在运行时设置泛型类型参数吗？

你需要在这里反射 - [MakeGenericMethod](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod.aspx)

注意：当类型可以在编译时确定时，使用类型参数重写它。

```
private T PopulateObject<T>(T dataObj, System.Data.DataRow dataRow, string query)
{
    dataObj = DataAccess.Retriever.RetrieveArray<T>(query);
} 
```

# asp.net-mvc - ASP.Net MVC Final Release中IList的模型绑定

> ID：910972
> 
> 赞同：1
> 
> 时间：2009-05-26T14:24:45.640
> 
> 标签：asp.net-mvc, data-binding, model

有很多关于如何使用内置模型绑定功能自动获取项目列表的示例。但它们都指的是 ASP.net MVC 的 Beta 版本。还提到此模型绑定发生了变化，但到目前为止，我无法找到关于它现在在最终版本中如何工作的良好来源。而且我还远远不能解释源代码:-)

如果有人可以向我解释我需要如何在视图中准备一个值列表以将其很好地返回到特定对象的 IList 中，那就太好了。

感谢你的帮助

迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T11:20:32.793

看法：

```
<% using(Html.BeginForm("Retrieve", "Home")) %> { %>
<% var counter = 0; %>
    <% foreach (var app in newApps) { %>
    <tr>
        <td><%=Html.CheckBox(String.Format("myAppList[{0}].Id", counter), app.ApplicationId) %></td>
        <!-- ... -->
        <td><%=Html.Input(String.Format("myAppList[{0}].SomeProperty1", counter), app.SomeProperty1) %></td>
        <td><%=Html.Input(String.Format("myAppList[{0}].SomePropertyN", counter), app.SomePropertyN) %></td>
        <% counter = counter + 1; %>
    </tr>
    <% } %>
    <input type"submit" />
<% } %> 
```

控制器：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Retrieve(IList<MyAppObject> myAppList) 
```

# android - 为什么我可以输入禁用的 EditText？

> ID：910973
> 
> 赞同：10
> 
> 时间：2009-05-26T14:25:14.890
> 
> 标签：android

如果我使用禁用`EditText`小部件

```
editText.setEnabled(false);
```

我仍然可以使用屏幕输入法（在模拟器和 G1 上）输入它。这是故意的吗？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T21:16:48.447

我注意到您无法通过点击禁用的 EditText 来激活屏幕键盘，而且 DEL 键也不起作用，所以这对我来说似乎是一个错误。我在 Android 问题跟踪器中将其归档为[问题 2771 。](http://code.google.com/p/android/issues/detail?id=2771)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-17T06:10:03.083

```
edittext.setKeyListener(null); 
```

这将帮助你

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-01T12:32:02.993

使用这个，它对我有用

```
setFocusableInTouchMode(boolean);

setFocusable(boolean); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-26T11:47:37.703

我修复了这个问题，但补丁只包含在 Honeycomb 中。这就是为什么我创建了一个小项目，其中将包含我从 2.1 开始的版本的反向移植修复。它包含对错误 2771 的修复：[http](http://code.google.com/p/android-fixes/)
://code.google.com/p/android-fixes/ 您可以从 svn 中查看“库”并将其包含在您的项目中。然后代替 android.widget.EditText 导入 edu.ubbdroid.android.widget.EditText （它扩展了原始的EditText），问题应该消失了:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-10T07:50:17.483

```
etComment.setEnabled(flag);
etComment.setFocusable(flag);
etComment.setFocusableInTouchMode(flag);
if (flag) {
    etComment.requestFocus();
}
etComment.setFilters(new InputFilter[] { new InputFilter() {
    @Override
    public CharSequence filter(
        CharSequence source, int start, int end, Spanned dest, int dstart, int dend) {
            if (!flag) {
                return source.length() < 1 ? dest.subSequence(dstart, dend) : "";
            }
            return null;
        }
    }
}); 
```

尽你所能！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-02T13:00:09.450

也许您可以选择用 TextView 动态替换并返回。但是您可能需要调整字体以匹配 EditText。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T19:03:55.093

我认为您应该能够使用自己的函数 editText.setOnClickListener() 并调用 super.onClickListener() 如果您想要编辑文本。

编辑：
以下链接有一些听起来更正确的答案：
[我们可以在edittext中有不可编辑的文本吗](https://stackoverflow.com/questions/910135/can-we-have-uneditable-text-in-edittext)

# asp.net - jquery ui 选项卡在回发时重定向到 ASPX 页面

> ID：910976
> 
> 赞同：2
> 
> 时间：2009-05-26T14:26:35.077
> 
> 标签：asp.net, jquery, ajax, jquery-ui, tabs

当我提交表单时，我被重定向到实际的 aspx 页面。如何避免重定向。

选项卡.aspx

```
<div id="container-1">
        <ul>
            <li><a href="Survey.aspx?group=1"><span>HR</span></a></li>
            <li><a href="Survey.aspx?group=2"><span>Sales</span></a></li>
            <li><a href="Survey.aspx?group=3"><span>Finance</span></a></li>
        </ul> 
```

tabs.aspx 中的 jquery 代码

```
<script type="text/javascript">
        $(function() {
            $('#container-1 > ul').tabs();
</script> 
```

调查.aspx

```
<form id="form1" runat="server">
<div>
    <asp:Label ID="lblHeading" runat="server"></asp:Label><br />
    <asp:HiddenField ID="hdnGroupId" runat="server" />
    <br />
    1) Question 1        <asp:DropDownList ID="DropDownList1" runat="server">
    </asp:DropDownList>

    <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox><br />
    2) Another question:  <asp:TextBox ID="TextBox2" runat="server"></asp:TextBox><br />
    <br />
    <br />

    <asp:Button ID="btnSave" runat="server" OnClick="btnSave_Click" Text="Save" /><br />

    <div id="Result">Click here for the time.</div>

    <asp:Label ID="lblMessage" runat="server"></asp:Label></div>
</form> 
```

调查页面背后的代码

```
protected void btnSave_Click(object sender, EventArgs e)
{
    if (groupId > 0)
    {
        switch (groupId)
        {
            case 1:
                lblMessage.Text = "HR data is saved.";
                break;
            case 2:
                lblMessage.Text = "Sales data is saved.";
                break;
            case 3:
                lblMessage.Text = "Finance data is saved.";
                break;
            default:
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-23T06:50:19.083

**尝试这个：**

> ```
>  <ul> 
>         <li><a href="#group1"><span>HR</span></a></li>
>         <li><a href="#group2"><span>Sales</span></a></li>
>         <li><a href="#group3"><span>Finance</span></a></li>
>     </ul>
>     <div id="group1"><iframe src="Survey.aspx?group=1"></iframe></div>
>     <div id="group2"><iframe src="Survey.aspx?group=2"></iframe></div>
>     <div id="group3"><iframe src="Survey.aspx?group=3"></iframe></div> 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-20T11:05:20.107

试试这个插件... [http://code.google.com/p/jquery-hijack/](http://code.google.com/p/jquery-hijack/)

# php - 可以处理大量数据的图表包

> ID：910978
> 
> 赞同：1
> 
> 时间：2009-05-26T14:26:55.980
> 
> 标签：php, javascript, ajax, charts

过去这里有很多关于图表包的问题，​​但我正在寻找一个具有一组特定属性的问题。尤其是：

*   处理数千个数据点的能力
*   允许用户平移和缩放的能力
*   能够实时更新图表（即反映新数据）

理想情况下，它将与 PHP（和/或 JavaScript）一起使用，我猜它会生成基于 Flash 的图表。我有一种感觉，处理需求的正确方法是拥有一个系统，该系统可以确定它需要为所需视图获取哪些数据点。因此，当用户放大时，前端会从不同的范围获取一组新的点。在任何给定点仅获取足够的点（例如，每个像素一个数据点）。

有谁知道以这种方式工作的图表包？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T16:37:33.110

我过去使用[过 amCharts](http://www.amcharts.com/)，我认为这是一个很棒的软件包。该功能集非常庞大且高度可配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:34:19.437

> *   处理数千个数据点的能力

考虑使用缓存机制进行快速值检索，LAMP 的标准是[memcached](http://www.danga.com/memcached/)，尽管我一直在使用[redis](http://github.com/antirez/redis/tree/master)以获得出色的性能。

此外，您可能希望利用预渲染图表来节省数据检索，请考虑使用[Google Charts API](http://code.google.com/apis/chart/)。

> *   允许用户平移和缩放的能力

每个人，包括 SO，如果将[flot](http://code.google.com/p/flot/)用于动态 JavaScript 图表。

> *   能够实时更新图表（即反映新数据）

您可以通过在间隔上呈现浮动图来完成此操作。绝对考虑使用某种形式的缓存，这样您的应用程序就不会降低数据源的性能。

# .net - 无法让 SharpSSH 通过 FTP 连接

> ID：910985
> 
> 赞同：0
> 
> 时间：2009-05-26T14:28:03.857
> 
> 标签：.net, ftp, sftp, sharpssh

我无法使用 SharpSSH 建立安全的 FTP 连接。到目前为止，我一直在使用 DOS 命令行应用程序 MOVEit Freely 进行连接，并且连接正常：

```
C:\> ftps -user:ABC -password:123 xxx.xxx.xxx.mil 
```

但是，当我尝试使用 SharpSSH 做同样的事情时，我收到一个错误，提示连接超时或服务器没有正确响应：

```
Dim sftp = New Tamir.SharpSsh.Sftp("xxx.xxx.xxx.mil", "ABC", "123")
sftp.Connect() 
```

或者

```
Dim host = New Tamir.SharpSsh.SshStream("xxx.xxx.xxx.mil", "ABC", "123") 
```

知道我可能做错了什么，或者我怎么能找出失败的地方？

请注意，我需要一个安全的 FTP 连接，因此 .NET 类不是一个选项。如果它们存在，我愿意尝试 SharpSSH 的替代品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T23:55:58.873

您正在使用 Tamir.SharpSsh，它是一个 SSH 库。但是，您似乎正在连接到 FTPS（或 FTP/SSL）服务器。FTPS 是完全不同的协议，与 SFTP 或 SSH 没有任何共同之处。

我们网站上的以下页面讨论了 FTP、FTP/SSL、FTPS 和 SFTP 协议之间的区别：[rebex.net/secure-ftp.net/](http://www.rebex.net/secure-ftp.net/)。

简要总结如下：

*   FTP 普通的、旧的、不安全的文件传输协议。通过网络传输明文密码。

*   FTPS - 通过 TLS/SSL 加密通道的 FTP。FTP 和 FTPS 的关系类似于 HTTP 和 HTTPS。

*   FTP/SSL - 与 FTPS 相同

*   SFTP - SSH 文件传输协议。与 FTP 没有任何共同之处（除了名称之外）。通过 SSH 加密通信通道运行。

*   安全 FTP - 可以是 SFTP 或 FTPS :-(

你可以试试[Rebex File Transfer Pack](http://www.rebex.net/file-transfer-pack/)组件，它同时支持 SFTP 和 FTPS 协议（但与 SharpSSH 不同，它需要一些钱）。

与 FTP/SSL 服务器的连接如下所示：

```
' Create an instance of the Ftp class. 
Dim ftp As New Ftp()

' Connect securely using explicit SSL. 
' Use the third argument to specify additional SSL parameters. 
ftp.Connect(hostname, 21, Nothing, FtpSecurity.Explicit)

' Connection is protected now, we can log in safely. 
ftp.Login(username, password) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T00:41:31.320

另一个不错的选择（也不是免费的）是[edtFTPnet/PRO](http://www.enterprisedt.com/products/edtftpnetpro/overview.html)，这是一个稳定、成熟的库，它为 .NET 中的 FTPS（和 SFTP）提供全面支持。

这是一些用于连接的示例代码：

```
 SecureFTPConnection ftpConnection = new SecureFTPConnection();

   // setting server address and credentials
   ftpConnection.ServerAddress = "xxx.xxx.xxx.mil";
   ftpConnection.UserName = "ABC";
   ftpConnection.Password = "123";

   // select explicit FTPS
   ftpConnection.Protocol = FileTransferProtocol.FTPSExplicit;

   // switch off server validation (only do this when testing)
   ftpConnection.ServerValidation = SecureFTPServerValidationType.None;

   // connect to server
   ftpConnection.Connect(); 
```

# php - 简单的 PHP 条件帮助：if($Var1 = in list($List) and $Cond2) - 这是可能的吗？

> ID：910987
> 
> 赞同：12
> 
> 时间：2009-05-26T14:28:31.437
> 
> 标签：php, list, conditional

这是一个可能的功能吗？

我需要检查一个变量是否存在于我需要检查的列表中，并且 cond2 是否为真，例如

```
if($row['name'] == ("1" || "2" || "3") && $Cond2){
    doThis();
} 
```

它对我不起作用，我在复制粘贴中所做的只是我的列表和变量名

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-26T14:32:07.717

```
if(in_array($row['name'], array('1', '2', '3')) && $Cond2) {
  doThis();
} 
```

PHP 的`in_array()`文档：[http ://us.php.net/manual/en/function.in-array.php](http://us.php.net/manual/en/function.in-array.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T14:32:26.233

您正在寻找功能[`in_array()`](http://us.php.net/manual/en/function.in-array.php)。

```
if (in_array($row['name'], array(1, 2, 3)) && $cond2) {
    #... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T14:33:19.990

```
if (in_array($name , array( 'Alice' , 'Bob' , 'Charlie')) && $condition2 ) {
 /* */
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T14:32:42.677

使用 in_array 函数 if(in_array($row['name'], array(1,2,3)) && $cond2){ do ... }

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T14:31:22.773

```
$name = $row['name'];
if (($name == "1" || $name == "2" || $name == "3") && $cond2)
{
  doThis();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-14T15:55:51.667

我有比这更简单的东西，如果它仍然可能的话......

```
if(strpos("1,2,3", $row['name']) !== false) && $Cond2) {
  doThis();
} 
```

# windows - 我的应用程序如何找到 Windows 消息的发件人？

> ID：910991
> 
> 赞同：17
> 
> 时间：2009-05-26T14:29:33.650
> 
> 标签：windows, message, keyboard-hook

我有一个在库中使用键盘挂钩程序的应用程序。一条消息的钩子中的 wParam 是 255，我们认为它是“（保留 / OEMClear）”。我想弄清楚这条消息的来源，因为它会导致我的应用程序在库中崩溃，并且鉴于它不应该发生，最好识别它。该消息仅在我们拥有的一台 PC 上重复出现 - 其他计算机根本看不到该消息。

那么，有没有办法追踪发送到窗口的消息的来源，或者系统上的所有消息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T15:54:29.767

没有内置方法可以找出谁发送了窗口消息，甚至 win32k 也没有跟踪这一点；您也许可以使用内核调试器和条件断点找到它。

但是，我认为您并不真的需要这些信息。您需要使您的应用程序正确处理发送给它的*任何消息。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:24:43.413

（我最初建议使用 Spy++ 或 winspector，但它们不会与消息的*发送*挂钩。这甚至没有意义！窗口接收消息但他们不发送消息，线程会这样做。我会离开我的关于使用调试器的建议。）

有时调试会有所帮助。尝试下载 Windows [PDB](http://www.microsoft.com/whdc/DevTools/Debugging/debugstart.mspx)文件并设置一个断点，该断点仅在出现这些消息之一时才命中。在这一点上查看调用堆栈通常可以对事情发生的原因有所了解。发布的消息和从其他进程发送的消息将挫败这种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-02-05T11:28:30.500

我想出了一种技术，用于确定谁在一次性调试/故障排除会话期间跨线程/进程发送 win32 窗口消息。它需要做出几个假设，所以它不是 100% 可靠的，但到目前为止我还没有发现它不起作用的情况。

基本思想是利用这样一个事实，即当消息到达时，接收窗口线程通常被阻塞在其消息循环中*等待*[`GetMessage()`](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getmessage)（特别是， ）。当消息被传递时，发送线程*准备*接收线程，将其拉出等待状态。

事实证明，Windows 提供了使用[Windows 事件跟踪](https://docs.microsoft.com/en-us/windows-hardware/test/wpt/event-tracing-for-windows)来精确跟踪哪些线程正在准备哪些其他线程的方法。使用这个特性，通常可以确定哪个线程发送了消息——它是准备接收线程的线程。甚至可以看到发送线程在发送消息时的调用堆栈是什么，甚至可以看到堆栈的内核端 ( `win32k`) 部分！

基本程序是这样的：

1.  使用[Windows 性能记录器](https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-recorder)启动跟踪。确保包含“CPU 使用率”配置文件。
2.  触发发送您感兴趣的消息。
3.  停止追踪。
4.  [在Windows 性能分析器](https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-analyzer)中打开跟踪。
5.  在“CPU Usage (Precise)”图表中，“Stacks”图表预设，放大收到消息的时间。
    *   一种方法是定位接收线程并确定它何时醒来。
    *   如果关联很困难，则可能值得使用[TraceLogging](https://docs.microsoft.com/en-us/windows/win32/tracelogging/trace-logging-portal)来检测接收线程以生成清晰的参考时间点。
6.  您应该能够找到接收线程准备就绪的上下文切换事件`GetMessage`。
7.  “Reading Process”、“Reading Thread Id”和“Reading Thread Stack”列将显示准备好的线程的详细信息，该线程很可能是消息的发送者。

例如，在下面的屏幕截图中，TID 7640 接收到来自 WindowsTerminal.exe、TID 1104的[外壳挂钩消息：](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-registershellhookwindow)

[![WPA 截图](https://i.stack.imgur.com/AhtwH.png)](https://i.stack.imgur.com/AhtwH.png)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-05-26T14:59:08.457

我不确定这是否符合您的要求，但请查看 sysinternals 的 Process Monitor。

http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx

它显示了进程发生的所有事情，所以我假设它也捕获消息。该网站在撰写本文时已关闭，因此我无法检查。

# sql-server-2005 - ORM for Compact Framework 3.5 winforms 应用程序与外部 ms sql server 2005

> ID：910993
> 
> 赞同：1
> 
> 时间：2009-05-26T14:29:52.650
> 
> 标签：sql-server-2005, compact-framework, or-mapper

我正在构建一个**.NET CF 3.5 应用程序**，它将与基于**服务器的 MS SQL server 2005**进行通信。

通信将通过设备的 WiFi 连接进行。

我一直在寻找一个好的 O/R 映射器，但有点迷茫。大多数站点/人们假设您将使用*本地紧凑型数据库*，而不是使用*外部“普通” SQL 服务器*。

过去，我使用过实体空间（但现在这似乎是商业化的？），最近使用过 linq-to-sql。

在具有普通 MS SQL 数据库的 .NET CF 应用程序上运行的易于学习和实现的 O/R 映射器有什么好的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:31:56.827

几年前，我使用 .NET 1.1 和[LLBLGen](http://www.llblgen.com)取得了巨大成功。

# iphone - 视图控制器：如何以编程方式在视图之间切换？

> ID：910994
> 
> 赞同：52
> 
> 时间：2009-05-26T14:30:14.850
> 
> 标签：iphone, uikit, uiviewcontroller, uitabbarcontroller

简而言之：我想要两个全屏视图，我可以在视图 A 和视图 B 之间切换。我知道我可以只使用选项卡栏控制器，但我不想。我想看看这是如何手工完成的，以了解幕后发生的事情。

我有一个 UIViewController 作为根控制器：

```
@interface MyRootController : UIViewController {
    IBOutlet UIView *contentView;
}
@property(nonatomic, retain) UIView *contentView;

@end 
```

contentView 连接到我作为子视图添加到 Nib 的“视图”的 UIView。这有绿色，我看到它全屏。工作正常。

然后，我以几乎相同的方式创建了另外两个视图控制器。ViewControllerA 和 ViewControllerB。ViewControllerA 有蓝色背景， ViewControllerB 有黑色背景。只是看看哪个是活跃的。

所以，在 myRootController 的实现中，我这样做：

```
// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {
    [super viewDidLoad];

    ViewControllerA *vcA = [[ViewControllerA alloc] initWithNib];
    [self.contentView addSubview:vcA.view];

    [cvA release];
} 
```

顺便说一下，-initWithNib 方法如下所示：

```
- (id)initWithNib { // Load the view nib
    if (self = [super initWithNibName:@"ViewA" bundle:nil]) {
        // do ivar initialization here, if needed
    }
    return self;
} 
```

这样可行。当我启动应用程序时，我会看到来自 ViewControllerA 的视图。但现在最大的问题是：视图控制器通常具有所有这些方法，例如：

*   (void)viewWillAppear:(BOOL) 动画；
*   (void)viewDidDisappear:(BOOL)动画；
*   (void)viewDidLoad;

...等等。如果我在没有标签栏控制器的情况下以“我的”方式进行操作，谁或什么，或者如何调用这些方法？我的意思是：如果我分配 ViewController 的类并且视图 get 是可见的，我是否需要注意调用这些方法？它如何知道 viewWillAppear、viewDidDisappear 或 viewDidLoad？我相信标签栏控制器在引擎盖下具有所有这些“聪明”。还是我错了？

更新：我已经测试过了。如果我释放视图控制器（例如：ViewControllerA），我将不会在 viewDidDisappear 上收到任何日志消息。只有在分配和初始化 ViewControllerA 时，我才会得到一个 viewDidLoad。但就是这样。所以现在所有的迹象都代表了 UITabBarController 的聪明；）我必须弄清楚如何复制它，对吧？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-26T14:54:41.010

在开始 iPhone 开发的第 6 章中有一个很好的切换视图示例。你可以在这里看到它的源代码：http: [//iphonedevbook.com/](http://iphonedevbook.com/)

SwitchViewController 具有以编程方式更改视图的代码。

```
 - (IBAction)switchViews:(id)sender
{

    if (self.yellowViewController == nil)
    {
        YellowViewController *yellowController = [[YellowViewController alloc]
                initWithNibName:@"YellowView" bundle:nil];
        self.yellowViewController = yellowController;
        [yellowController release];
    }

    [UIView beginAnimations:@"View Flip" context:nil];
    [UIView setAnimationDuration:1.25];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];

    UIViewController *coming = nil;
    UIViewController *going = nil;
    UIViewAnimationTransition transition;

    if (self.blueViewController.view.superview == nil) 
    {   
        coming = blueViewController;
        going = yellowViewController;
        transition = UIViewAnimationTransitionFlipFromLeft;
    }
    else
    {
        coming = yellowViewController;
        going = blueViewController;
        transition = UIViewAnimationTransitionFlipFromRight;
    }

    [UIView setAnimationTransition: transition forView:self.view cache:YES];
    [coming viewWillAppear:YES];
    [going viewWillDisappear:YES];
    [going.view removeFromSuperview];
    [self.view insertSubview: coming.view atIndex:0];
    [going viewDidDisappear:YES];
    [coming viewDidAppear:YES];

    [UIView commitAnimations];

} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-26T15:18:25.407

你可以从最简单的 removeFromSuperview/insertSubview 开始，一点一点的添加代码。

```
 //SwitchViewController.h
#import 
@class BlueViewController;
@class YellowViewController;

@interface SwitchViewController : UIViewController {
    IBOutlet BlueViewController *blueViewController;
    IBOutlet YellowViewController *yellowViewController;
}
- (IBAction)switchViews:(id)sender;
@property (nonatomic, retain) BlueViewController *blueViewController;
@property (nonatomic, retain) YellowViewController *yellowViewController;
@end 
```

```
 //1\. remove yellow view and insert blue view
- (IBAction)switchViews:(id)sender {
    if(self.blueViewController.view.superview == nil)
    {
        [yellowViewController.view removeFromSuperview];
        [self.view insertSubview:blueViewController.view atIndex:0];
    }
}

//2\. appear=insert, disappear=remove
if(blueViewController.view.superview == nil)
{
    [blueViewController viewWillAppear:YES];
    [yellowViewController viewWillDisappear:YES];

    [yellowViewController.view removeFromSuperview];
    [self.view insertSubview:self.blueViewController.view atIndex:0];

    [yellowViewController viewDidDisappear:YES];
    [blueViewController viewDidAppear:YES];
}

//3\. now add animation
[UIView beginAnimations:@"View Flip" context:nil];
[UIView setAnimationDuration:1.25];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
//blue view will appear by flipping from right
if(blueViewController.view.superview == nil)
{
    [UIView setAnimationTransition: UIViewAnimationTransitionFlipFromRight 
                            forView:self.view cache:YES];

    [blueViewController viewWillAppear:YES];
    [yellowViewController viewWillDisappear:YES];

    [yellowViewController.view removeFromSuperview];
    [self.view insertSubview:self.blueViewController.view atIndex:0];

    [yellowViewController viewDidDisappear:YES];
    [blueViewController viewDidAppear:YES];
}
[UIView commitAnimations]; 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-26T14:40:36.403

如果我理解正确，那么您要完成的工作非常简单。

只需在您的应用程序委托上添加一个 UINavigationController 并执行以下操作：

```
[navigationController pushView:vcA]; 
```

将相应地调用代表：

*   (void)viewWillAppear:(BOOL) 动画；
*   (void)viewDidDisappear:(BOOL)动画；
*   (void)viewDidLoad;

当您想要弹出视图并推送另一个视图时：

```
[navigationController popViewControllerAnimated:true];
[navigationController pushView:vcB]; 
```

如果您不希望 navigationController 显示，请使用：

```
[navigationBar setHidden:YES]; 
```

其中，navigationBar 是与您的 UINavigationController 对应的 UINavigationBar。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-15T06:58:47.483

这可能是一个老问题，但我最近遇到了同样的问题，很难找到有效的方法。我想在两个互补的视图控制器之间切换，但我希望切换是动画的（内置动画效果很好），如果可能的话，我希望它与故事板兼容。

为了利用内置的过渡，UIView 的[`+transitionFromView:toView:duration:options:completion:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)方法工作得很好。但是，它只在视图之间转换，而不是视图控制器。

对于整个视图控制器之间的转换，而不仅仅是视图，创建自定义`UIStoryboardSegue`是要走的路。无论您是否使用故事板，这种方法都可以让您封装整个转换并管理相关信息从一个视图控制器到下一个视图控制器的传递。它只涉及子类化`UIStoryboardSegue`和覆盖单个方法，`-perform`.

有关参考实现，请参阅[`RAFlipReplaceSegue`](https://github.com/ryanartecona/RAFlipReplaceSegue)我使用这种方法放在一起的确切自定义 segue。作为奖励，如果它在`UINavigationController`堆栈中，它还会用新的视图控制器替换旧的视图控制器。

# analysis - 检测过度分析

> ID：910995
> 
> 赞同：2
> 
> 时间：2009-05-26T14:30:15.660
> 
> 标签：analysis, platform-agnostic, platform-independent

我怎么知道我是否过度分析？

最近三天我一直在追查一个问题。我经历了许多设计，并使用大约 3 个类达到了一个复杂的解决方案。与同事讨论后，我意识到我所需要的只是一种方法和一个`struct`. 我怎样才能避免成为一名[建筑宇航员](http://www.joelonsoftware.com/articles/fog0000000018.html)？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T14:33:54.780

我发现如果我不能在 30 分钟内想出一个好的清洁解决方案，几乎总是最好与其他人讨论。
即使他们不知道如何解决它，它通常也会触发更好的设计或解决方案。

所以和某人谈谈。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T14:38:12.057

就个人而言，我真的不能抱怨任何实际上首先计划他们的软件的人！我这样做，但我知道很多程序员只知道如何直接跳入代码......而且我经常不得不修复这样的代码......

也就是说，您真正要问的是如何知道何时有更好的解决方案。

我给你的建议是反复问自己：我是在考虑解决方案的细节，还是考虑真正的问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T15:25:39.510

避免成为架构宇航员的最好方法是养成直接参与的习惯。直接参与的最好方法是编写一些测试，当你的实现完整且正确时这些测试将通过。这迫使您从一开始就面对“完成”的含义，*并且*它提供了对随后代码的健全性检查。

然后寻求解决方案。

您现在可能是第一次到达那里，但是从“完成”的概念开始的练习将帮助您在进行过程中提出更好的问题，并且提前完成一些验收测试将有助于剔除将空间设计到合理的程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:33:28.587

我曾经被这个问题困扰。设计一个可以处理未来大量增长的解决方案，而不是什么。确保它具有良好的抽象性，从而导致您遇到上述问题。

然后我抛弃了这种方法，把它全部打入一个大的肮脏的班级，也许两个。之后我重新考虑它，直到它类似于我希望其他人工作的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T14:38:49.747

我喜欢先做一些快速而肮脏的事情，当它起作用时，我会逐步重构代码，直到我对设计感到满意为止。

这也是TDD方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T14:49:37.243

我发现自己遵循以下三个步骤来找到“理想”的解决方案：

1.  如果我拥有世界上所有的时间和资源，那么最好的解决方案是什么。（技术上，逻辑上，性能上，可选地解决一些相关问题，重写你发现可以做得更好的模块......）在这里做你的（过度）分析，只是为了尽可能多地了解。运行测试、统计数据并创建*概念验证*。

2.  和现在的情况有什么不同。两种解决方案的结果有什么区别。有没有更快的方法来获得相同或相似的结果。为什么这个或那个改变会解决手头的问题。做更多的测试，统计数据，更新你的概念证明。

3.  找到一种方法来实现所需的更改，并且*只有*所需的更改，才能删除对这个更改不重要的任何内容。检查你没有修改任何没有问题的东西。对此进行测试，审查对代码、逻辑、结构的更改；并尽可能减少它们。

这听起来非常有限制（而且工作量很大），但实际上我发现自己在某些情况下最终会向数据库添加整个表。部分工作（因为要 100% 确定某事需要大量工作）是检查所有现有代码是否与要加入的额外表保持完全相同的工作。

最重要的是，在大多数情况下，在工作中，我们需要满足更新前保留在系统中的“过渡数据”，这些数据在更新后必须以同样的方式生产和运送。

# visual-studio - Visual Studio 2010 Beta 1 会干扰我的 Visual Studio 2008 安装吗？

> ID：910997
> 
> 赞同：0
> 
> 时间：2009-05-26T14:30:45.630
> 
> 标签：visual-studio

> **可能重复：**
> [将 Visual Studio 2010 Beta 与 VS2008 并排安装会导致问题吗？](https://stackoverflow.com/questions/879913/will-installing-visual-studio-2010-beta-side-by-side-with-vs2008-cause-problems)

如果可能的话，我想玩一下测试版和新的实体框架。

VS2010 会影响我的 Visual Studio 2008 安装吗？

我仍然需要 VS08 才能工作。

简历

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T14:32:31.117

我让它们并排工作，没有任何问题（直到我通过磁盘升级 - 仍然有很多安装要做）。但是，我不能说我已经做了彻底的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:33:12.847

我没有进行任何广泛的测试，但是在我家里的盒子上，我同时运行了两者，没有明显的问题。

# xml - 数据集成方法

> ID：910999
> 
> 赞同：1
> 
> 时间：2009-05-26T14:31:09.060
> 
> 标签：xml, xsd

我正在尝试通过 XML 导入将一些数据推送到 CRM 系统中。

我有用于 CRM 系统 (XSD) 的 XML 模式，它们非常复杂（具有大量命名空间的大文件），我正在努力弄清楚 XML 应该是什么样子，而命名空间根本没有帮助。

我需要一种简单的方法来制作 XML 文档的原型，一旦我有了一组工作 XML 模板，我就可以正确地对数据馈送进行编码。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:33:37.150

据推测，这种连接是双向的。您能告诉 CRM 输出一些 XML 以便您查看吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:38:08.640

我们已经使用 Liquid XML Studio 很长时间了，XSD 图表让我们很容易理解 XSD。还有一个特性，您可以在其中创建示例 XML 文档，这有时是一个好的开始。最后，XML 编辑器中的智能感知为您提供了所有选项并确保您拥有正确的命名空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:52:50.373

我听起来你只需要一个好的[XML 编辑器](http://www.liquid-technologies.com/XmlStudio/Free-Xml-Editor.aspx)。

我会选择 Liquid XML Studio（免费版本可以满足您的所有需求）。

或 Visual Studio 2003 或更高版本。intellisense 没问题，但设置起来很麻烦 - 请查看“[如何配置 Visual Studio 2005 IDE 以使用 IntelliSense 的自定义 XSD 文件](http://blogs.msdn.com/astebner/archive/2005/12/07/501466.aspx)”

如果您想要架构可视化，尽管[Liquid XML](http://www.liquid-technologies.com/XmlStudio/Free-Xsd-Editor.aspx)是可行的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:10:54.020

布莱恩，

[如果您在 Microsoft .NET 中工作，您可以使用XSD.EXE](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)从您的 XML 模式生成 C# 或 VB 类。**********