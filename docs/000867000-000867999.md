# StackOverflow 问答 000867000-000867999

# objective-c - 何时在类属性上使用 self？

> ID：867001
> 
> 赞同：7
> 
> 时间：2009-05-15T04:42:53.297
> 
> 标签：objective-c

类属性何时需要 self ？例如：

```
self.MyProperty = @"hi there"; 
```

对比

```
MyProperty = @"hi there"; 
```

MyProperty 是一个设置为 (nonatomic, copy) 的 NSString。以上两者的内存管理有什么区别吗？

当没有属性并且在头文件中声明了变量 MyProperty 时怎么办？如果从未在类之外引用某个属性，是否需要该属性？它对内存管理有影响吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T08:21:38.253

是的，内存和性能都有所不同。

```
MyProperty = @"hi there"; 
```

这被认为是直接分配。实际上没有内存或性能影响。当然，这并不是说这是最佳实践 - 这是一个不同的问题:)

```
@property(nonatomic, copy) NSString *MyProperty;
// ...
self.MyProperty = @"hi there"; 
```

该语句对内存和性能有重大影响。这基本上等同于：

```
-(void)setMyProperty(NSString *)newValue {
    if (MyProperty != newValue) {
        [MyProperty release];
        MyProperty = [newValue copy];
    }
} 
```

旧值被释放，新值被复制到 MyProperty。当您分配的字符串是可变的（即，它可以稍后更改）时，这是可以接受的并且在处理字符串时尤其典型。

如果像您的示例一样，您只是分配一个静态字符串（@“hi there”），那么直接分配字符串值没有任何问题；它更有效，但性能差异微不足道。

您可以使用 @property 将属性声明为保留、复制或分配（默认为分配）。然后，您可以使用@synthesize 生成“访问器”（getter/setter）方法。以下是您执行此操作时生成的 setter 方法的样子：

```
// @property(nonatomic, assign)
-(void)setMyProperty(NSString *)newValue {
    MyProperty = newValue;
}

// @property(nonatomic, retain)
-(void)setMyProperty(NSString *)newValue {
    if (property != newValue) {
        [property release];
        property = [newValue retain];
    }

// @property(nonatomic, copy)
-(void)setMyProperty(NSString *)newValue {
    if (property != newValue) {
        [property release];
        property = [newValue copy];
    }
} 
```

有关[ObjectiveC 声明的属性](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocProperties.html "声明的属性")的更多信息。

“您可以在@implementation 块中使用@synthesize 和@dynamic 指令来触发特定的编译器操作。请注意，任何给定的@property 声明都不需要。

重要提示：如果您没有为特定属性指定 @synthesize 或 @dynamic，则必须为该属性提供 getter 和 setter（或者在只读属性的情况下仅提供 getter）方法实现。”

换句话说，如果您声明了一个属性但不合成该属性，您将无法使用 [self MyProperty] 或 self.MyProperty，除非您定义了 'MyProperty' 和 'setMyProperty' 方法。如果你不声明一个属性，那么你只需要一个实例变量。

注意：@dynamic 不会生成访问器。如果您通过加载代码或动态方法解析来动态（即神奇地）解析访问器方法，那么它真的很有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T05:55:28.257

不同之处在于

```
self.MyProperty = @"hi there" 
```

是点符号调用，它将调用生成的访问器，它将正确处理保留计数（相当于 [self setMyProperty:@"hi there"]），而

```
MyProperty = @"hi there" 
```

是对您的成员变量的直接赋值，它不会释放旧值、保留新值或执行访问器所做的任何其他事情（例如，如果您有一个执行额外工作的自定义设置器）。

所以是的，两者之间的内存管理和一般行为存在很大差异。后一种形式几乎总是错误的，除非您明确知道为什么要这样做并且您自己正确地处理了保留计数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T07:21:14.277

如果您使用自动[Key-Value Observing](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueObserving/Concepts/AutoVsManual.html#//apple_ref/doc/uid/20001844-178255)（或任何基于它的 Cocoa 技术——如绑定，...），使用 setter 也很重要。如果您分配给 ivar，观察者将不会收到任何通知。如果将“MyProperty”绑定到 NSTextfield 并通过代码更改“MyProperty”ivar，则绑定的文本字段仍将显示旧值，因为它没有收到任何更改通知。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T23:09:27.247

要*访问*变量，通常不需要使用点符号。因此，在 XCode 模板生成的代码中，您将看到如下内容：

```
[flipsideViewController viewWillAppear:YES]; 
```

此处无需编写 self.flipsideViewController，因为访问器方法通常除了将变量交给您之外什么都不做。

因此，一个好的经验法则是在*设置*变量时使用点表示法（绝对必要，除非您想自己进行保留和释放），但在*访问*它时不使用：

```
self.aString = @"Text text text";
NSLog (aString);   // No need for self.aString here
NSString* tmpString = aString; // Here neither 
```

当您使用非对象类型时，如 int 或 float 或许多其他类型，您可以不使用点表示法/setter 方法。在这些情况下，没有什么要保留的，所以 setter 方法除了分配值之外几乎没有什么作用。

**然而**，合成的 getter 和 setter 不仅仅是保留和释放。正如其他人所提到的，它们也是保持 KVO 系统运行的引擎。因此，即使在 int、float 和其余部分上，您也应该使用正确的 setter。

那么访问器呢？*在更高级的上下文中，即使变量不存在*，类也可能会响应对变量值的请求。引用崇高的 Objective-C 手册，类可能会提供“直接或在运行时使用其他机制 [而不是简单的访问器方法] 的方法实现，例如动态加载代码或动态方法解析”。

（实现这种对消息的即时响应的一种方法是覆盖 NSObject 方法，如 methodSignatureForSelector: 和 forwardInvocation: 。）

出于这个原因，在处理大事时，使用正确声明的接口（无论是否合成）总是一个好主意。但是直接访问 ivars 是完全可以的，只要你使用正确的 API*设置它们。*

（注意：我不是 Cocoa 大师，因此非常欢迎更正。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T04:57:41.717

对于问题的第二部分，不需要属性定义，这对我们有帮助。属性上的 @synthesize 指令为属性生成访问器方法，因此我们不必手动执行，因为：

> 此代码指示编译器生成或合成访问器方法。编译器将使用经过充分测试的快速算法生成访问器方法，这些算法可用于多核和多线程环境，包括在 setter 方法中锁定变量。使用属性不仅可以减少您必须编写的代码量，还可以用当今现代多核系统的最佳访问器替换该代码。稍后，如果您需要为属性访问器提供替代实现，您可以简单地将适当的代码添加到您的类中。
> 
> [http://developer.apple.com/leopard/overview/objectivec2.html](http://developer.apple.com/leopard/overview/objectivec2.html)

访问变量时将`nonatomic`避免使用锁定，如果您不指定任何内容，则默认为`atomic`. 锁定在多线程系统上很有用。副本指定应该为访问者生成什么代码，`copy`将复制对象，`retain`将保留新对象并释放旧对象，`assign`适用于像 int 这样的简单变量，只是简单地分配值。因此，当您像上面那样定义属性`(nonatomic,copy)`然后使用`self.MyProperty = @"Hey"`时，您实际上是在调用生成的访问器，它将复制新变量，而不是仅仅分配它。您可以覆盖访问器并向其添加检查。

**由于上述原因，我会说即使变量没有在类之外使用，定义属性也有好处。**

我相信访问你应该使用的属性，`self.MyProperty`而不是仅仅`MyProperty`但我不能指出你解释为什么。可能与编译器将生成的事实有关

```
self.MyProperty = @"Hey"; 
```

这：

```
[self setMyProperty: @"Hey"]; 
```

但我只是在这里推测。

无论您调用 self.MyProperty 还是 MyProperty，它都不会影响内存管理（我仍然更喜欢第一个 - self.MyProperty）。

有关Apple 的一些高级描述，请参阅[Objective-C 2.0 概述。](http://developer.apple.com/leopard/overview/objectivec2.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T06:04:49.343

作为其他答案的补充，试着这样想：

```
self.MyProperty = @"hi there"; 
```

或者

```
[self setMyProperty:@"hi there"]; 
```

（它们是等效的）都调用一个方法，而

```
MyProperty = @"hi there"; 
```

只需设置一个变量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-09T18:52:20.270

这是一个老问题，虽然它曾经是“我什么时候写`[self setMyProperty:@"hi there"]`？” （请注意，`self.MyProperty = @"hi there"`这与此完全相同。）

我一直听到的答案（这很有意义）*总是*使用访问器；*从不*写`MyProperty = @"hi there"`。有几个原因：

1.  内存管理为您处理；您不必担心正确的保留/释放/复制。
2.  以后修改代码更容易；如果在某个时候您意识到更改`MyProperty`需要产生特定的副作用，您可以添加到 setter 方法中，而无需每次设置时都找到`MyProperty`。
3.  如果您遇到问题`MyProperty`，可以轻松地将日志记录代码添加到 setter（甚至 getter）中，以便在每次更改（甚至访问）时找出它。

*总结：总是*使用`[self setMyProperty:@"hi there"]`or`self.MyProperty = @"hi there"`和*从不*使用.是最安全和最灵活的`MyProperty = @"hi there"`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-25T13:55:02.517

仍然不清楚何时使用访问器以及何时对 ivars 进行直接分配？我见过很多直接访问 ivars 的 Apple 示例。因此，对所有 ivars 使用属性似乎有点迂腐。

似乎只有需要较长时间并在外部访问的重要 ivars 才倾向于使用这些属性。

希望有一些可可大师介入并澄清。

# security - 尝试复制文件 Windows Vista 时访问被拒绝

> ID：867009
> 
> 赞同：2
> 
> 时间：2009-05-15T04:47:07.517
> 
> 标签：security, windows-vista, batch-file, uac

我有这个需要运行的批处理，用户必须执行它来复制一个简单的 xml 文件。但是，在 Windows 2000/XP 上一切正常。但是，在 Windows Vista 上，我收到错误“拒绝访问”。

即使我尝试在 Vista 上使用 Windows 资源管理器复制文件，我也会遇到同样的错误。

我能做些什么来制作这个文件副本。我是否必须在我的 bat 文件中添加任何额外的代码才能复制该文件？

非常感谢。

```
@ECHO OFF
REM copy config file to the windows/system32
copy config.xml c:\windows\system32\DataLinks.xml 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T04:54:06.390

我猜这是因为你试图改变 windows\system32\. Vista、7 和未来版本的 Windows 需要提升权限才能更改 system32。

你真的需要把这个文件放在system32中吗？如果是任意位置，为什么不将其弹出到用户的 AppData 目录（%AppData%\DataLinks.xml）中？

AppData 是自 Windows 2000 以来一直存在的标准目录，它隐藏在用户的 Documents and Settings 或 Users 文件夹中（取决于版本）。这是一个隐藏但用户可编辑的文件夹，用于用户需要能够访问的应用程序设置，但大多数情况下只会由您的代码使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T05:02:10.320

1.  您需要提升权限才能复制到 %windir%\system32
2.  您根本不应该将配置数据复制到 %windir% 中。这适用于 Windows。使用 %AppData%。
3.  如果您确实复制到 %windir%，请使用 %windir% 变量并且不要硬编码路径 C:\Windows

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T17:39:21.267

JS Bangs 是对的；使用 %windir% 变量。大多数时候，当你这样做时，它不会给出任何错误。

例子：

```
@ECHO OFF
REM copy config file to the windows/system32
copy config.xml %windir%\system32\DataLinks.xml 
```

但是你会吗？只要把它放在任何其他的。就像 AppData 已经说过的一样：

```
@ECHO OFF
REM copy config file to the windows/system32
copy config.xml %appdata%\DataLinks.xml 
```

# javascript - 如何修复浏览器兼容性

> ID：867016
> 
> 赞同：-3
> 
> 时间：2009-05-15T04:48:47.590
> 
> 标签：javascript, html, css, dhtml

我开发了一个 html 文件。它在 IE6 和 IE7 中运行良好。当我在 IE8 中运行相同的 html 文件时，设计不一样并且 Javascript 无法正常工作。它显示浏览器的“兼容性视图”？

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T04:50:42.763

由于您没有向我们提供足够的信息，因此很难真正帮助您。从某种意义上说，您的问题非常广泛，让您的网站在所有浏览器中都显示相同的内容需要大量工作，而特定布局在特定浏览器中不起作用的原因几乎是无限的。

不过，一些重要的事情可以让您开始您的旅程：

*   [使用 DOCTYPE](http://www.alistapart.com/articles/doctype/)否则您会将浏览器置于怪异模式。
*   [重置您的 CSS ，以便](http://meyerweb.com/eric/tools/css/reset/)*您*可以将所需的样式应用于元素。
*   [使用 Javascript 库](http://www.jquery.com)——围绕这些部分流行的库是 jQuery，这是我个人推荐的库。但是，只要您使用一个，您就可以使用哪一个并不重要。许多聪明人已经花费了大量时间来处理浏览器之间的所有不兼容问题。试图在你的网站上用纯 Javascript 做很多动态的东西是近乎自虐的。

一旦我开始做这些事情，让我的网站在不同的浏览器中运行起来就容易多了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T04:53:15.567

读一读，它详细介绍了导致 IE8 切换到兼容模式的原因，以及如何修复它们。

[http://blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx](http://blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:19:27.717

您必须给我们一些示例代码（甚至是工作网站）并​​执行以下操作：

1.  网站验证（html 标记、css 和 javascript）
2.  在另一个现代浏览器（opera、firefox、chrome、safari 等）上测试它
3.  您在构建 Web 时是否遵守 Web 标准？
4.  你依赖 CSS hacks 吗？
5.  您知道 IE6 和 IE7 上的 Trident 渲染引擎甚至没有通过 ACID 2 测试吗？这意味着CSS实现有很多麻烦......

那么我们可能会帮助你

# c# - C# 中“尝试”的性能成本

> ID：867017
> 
> 赞同：22
> 
> 时间：2009-05-15T04:49:09.087
> 
> 标签：c#, exception

我知道异常会降低性能，并且尝试避免异常通常比在所有事情上都放弃一个大的 try/catch 更有效——但是 try 块本身呢？即使它从不抛出异常，仅仅声明一个 try/catch 的成本是多少？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-15T04:57:04.137

try 的性能开销很小。异常处理的主要成本是获取堆栈跟踪和其他元数据，这是在您实际必须抛出异常之前不会支付的成本。

但这会因语言和实现而异。为什么不用 C# 编写一个简单的循环并自己计时呢？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-15T05:27:28.870

实际上，几个月前我正在创建一个 ASP.NET Web 应用程序，我不小心用一个很长的循环包装了一个 try/catch 块。即使循环没有生成所有异常，也需要花费太多时间才能完成。当我回去看到循环包裹的 try/catch 时，我反其道而行之，我将循环包裹在 try/catch 块中。性能提高了很多。您可以自己尝试：做类似的事情

```
int total;

DateTime startTime = DateTime.Now;

for(int i = 0; i < 20000; i++)
{
try
{
total += i;
}
catch
{
// nothing to catch;
}
}

Console.Write((DateTime.Now - startTime).ToString()); 
```

然后取出 try/catch 块。你会看到很大的不同！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-15T05:26:33.910

一个常见的说法是，异常在被捕获时是昂贵的——而不是被抛出。这是因为*大多数*异常元数据收集（例如获取堆栈跟踪等）只发生在 try-catch 端（而不是 throw 端）。

展开堆栈实际上非常快——CLR 沿着调用堆栈向上走，只注意它找到的 finally 块；在纯 try-finally 块中，运行时不会尝试“完成”异常（它是元数据等）。

据我记得，任何带有过滤器的 try-catch（例如“catch (FooException) {}”）都同样昂贵——即使它们对异常不做任何事情。

我敢说一个方法（称为CatchesAndRethrows）具有以下块：

```
try
{
    ThrowsAnException();
}
catch
{
    throw;
} 
```

可能会导致方法中的堆栈遍历更快 - 例如：

```
try
{
    CatchesAndRethrows();
}
catch (Exception ex) // The runtime has already done most of the work.
{
    // Some fancy logic
} 
```

一些数字：

```
With: 0.13905ms
Without: 0.096ms
Percent difference: 144% 
```

这是我运行的基准测试（请记住，发布模式 - 无需调试即可运行）：

```
 static void Main(string[] args)
    {
        Stopwatch withCatch = new Stopwatch();
        Stopwatch withoutCatch = new Stopwatch();

        int iterations = 20000;

        for (int i = 0; i < iterations; i++)
        {
            if (i % 100 == 0)
            {
                Console.Write("{0}%", 100 * i / iterations);
                Console.CursorLeft = 0;
                Console.CursorTop = 0;
            }

            CatchIt(withCatch, withoutCatch);
        }

        Console.WriteLine("With: {0}ms", ((float)(withCatch.ElapsedMilliseconds)) / iterations);
        Console.WriteLine("Without: {0}ms", ((float)(withoutCatch.ElapsedMilliseconds)) / iterations);
        Console.WriteLine("Percent difference: {0}%", 100 * withCatch.ElapsedMilliseconds / withoutCatch.ElapsedMilliseconds);
        Console.ReadKey(true);
    }

    static void CatchIt(Stopwatch withCatch, Stopwatch withoutCatch)
    {
        withCatch.Start();

        try
        {
            FinallyIt(withoutCatch);
        }
        catch
        {
        }

        withCatch.Stop();
    }

    static void FinallyIt(Stopwatch withoutCatch)
    {
        try
        {
            withoutCatch.Start();
            ThrowIt(withoutCatch);
        }
        finally
        {
            withoutCatch.Stop();
        }
    }

    private static void ThrowIt(Stopwatch withoutCatch)
    {
        throw new NotImplementedException();
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-04T08:22:25.060

要查看它的实际成本，您可以运行下面的代码。它采用一个简单的二维数组并生成超出范围的随机坐标。如果您的异常只发生一次，您当然不会注意到它。我的示例是为了强调这样做几千次意味着什么，以及捕获异常与实现简单测试将节省您的时间。

```
 const int size = 1000;
        const int maxSteps = 100000;

        var randomSeed = (int)(DateTime.UtcNow - new DateTime(1970,1,1,0,0,0).ToLocalTime()).TotalMilliseconds;
        var random = new Random(randomSeed);
        var numOutOfRange = 0;
        var grid = new int[size,size];
        var stopwatch = new Stopwatch();
        Console.WriteLine("---Start test with exception---");
        stopwatch.Reset();
        stopwatch.Start();
        for (int i = 0; i < maxSteps; i++)
        {
            int coord = random.Next(0, size * 2);
            try
            {
                grid[coord, coord] = 1;
            }
            catch (IndexOutOfRangeException)
            {
                numOutOfRange++;
            }
        }
        stopwatch.Stop();
        Console.WriteLine("Time used: " + stopwatch.ElapsedMilliseconds + "ms, Number out of range: " + numOutOfRange);
        Console.WriteLine("---End test with exception---");

        random = new Random(randomSeed);

        stopwatch.Reset();
        Console.WriteLine("---Start test without exception---");
        numOutOfRange = 0;
        stopwatch.Start();
        for (int i = 0; i < maxSteps; i++)
        {
            int coord = random.Next(0, size * 2);
            if (coord >= grid.GetLength(0) || coord >= grid.GetLength(1))
            {
                numOutOfRange++;
                continue;
            }
            grid[coord, coord] = 1;
        }
        stopwatch.Stop();
        Console.WriteLine("Time used: " + stopwatch.ElapsedMilliseconds + "ms, Number out of range: " + numOutOfRange);
        Console.WriteLine("---End test without exception---");
        Console.ReadLine(); 
```

此代码的示例输出：

```
---Start test with exception---
Time used: 3228ms, Number out of range: 49795
---End test with exception---
---Start test without exception---
Time used: 3ms, Number out of range: 49795
---End test without exception--- 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T05:00:36.500

您可能想阅读结构化异常处理。它是 Window 的异常实现，在 .NET 中使用。

[http://www.microsoft.com/msj/0197/Exception/Exception.aspx](http://www.microsoft.com/msj/0197/Exception/Exception.aspx)

# iphone - 为什么 sqlite3_bind 似乎循环？

> ID：867023
> 
> 赞同：0
> 
> 时间：2009-05-15T04:53:16.627
> 
> 标签：iphone, sqlite

我正在使用一些 sqlite3_bind 例程（在 iPhone SDK 中）如下所示对表进行一次更新（插入或更新）：

```
 sqlite3_bind_text(update_statement, 1, aString, -1, SQLITE_TRANSIENT);
        sqlite3_bind_int(update_statement, 2, anInteger);
        sqlite3_bind_int(update_statement, 3, pk); 
```

然而，在检查更新的表格后，我发现了意想不到的结果。我在 Xcode 调试器中使用“step over”跟踪了进度，看起来这组三个 sqlite3_bind 例程正在循环，以便执行**不止一次**，并且当应该只有一个时，我得到了多个插入或更新。这个例程不在 while 语句或任何内容中，所以我很困惑。

希望熟悉 iPhone SDK 中 sqlite3 的人能提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T09:28:33.907

哎呀....如果包含 sqlite3_bind 的方法没有被其他地方的另一个函数同时冗余调用 LOL，这可能会有所帮助。我使用 sqlite3_bind 例程创建了对该函数的单独调用，完全忽略了删除原始调用。愚蠢的错误，解决了：**sqlite3_bind 不循环。**

# sql - 如何清理这个 Sql 数据？

> ID：867030
> 
> 赞同：1
> 
> 时间：2009-05-15T04:57:14.480
> 
> 标签：sql, sql-server

这是对[先前提出的问题的后续问题](https://stackoverflow.com/questions/834247/need-some-help-trying-to-do-a-simple-sql-insert-with-some-simple-data-checking)。

我在单个数据库表中有以下数据。

```
Name                LeftId    RightId
------------------------------------------
Cat                     1  
Cat                     1
Dog                     2
Dog                     2
Dog                               3
Dog                               3
Gerbil                  4         5 
Cat                
Bird
Cow                     6
Cow
Cow                               7
Dog                     8         9 
```

请注意，有些行没有 LeftId 和 RightId 的数据。

现在，我想做的是找到两个不同的查询

1.  在两列之一中至少有 1 个 Id 的所有行和在这两个 Id 列中都没有数据的行。

例如。

```
Cat     1
Cow     6 (or 7 .. i'm not worried) 
```

2.  LeftId 和 RightId 为 NULL 的所有行按相同名称分组。如果另一行（同名）在 LeftId 或 RightId 中有值，则不会返回此名称。

例如。

```
Bird 
```

唔..

编辑：正确改写第一个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T05:12:46.400

对于第一个查询，您需要同时满足以下两个条件的行：

1.  行中的`Name`出现在表中的同一行中，其中`LeftId`和`RightId`都是 NULL。
2.  行中的`Name`出现在同一行的表中，其中至少有一个*和不*`LeftId`为`RightId`NULL 。

 *好吧，#1 由以下人员完成：

```
SELECT Name FROM Tbl WHERE (LeftId IS NULL) AND (RightId IS NULL) 
```

#2 由以下人员完成：

```
SELECT Name FROM Tbl WHERE (LeftId IS NOT NULL) OR (RightId IS NOT NULL) 
```

您可以将它们**相交**以查看`Name`两个列表中出现的 s：

```
SELECT Name FROM Tbl WHERE (LeftId IS NULL) AND (RightId IS NULL)
INTERSECT
SELECT Name FROM Tbl WHERE (LeftId IS NOT NULL) OR (RightId IS NOT NULL) 
```

返回：

```
Name
----
Cat
Cow 
```

但是你想要`LeftId`and `RightId`，你不在乎哪个，所以我想我们会在 Name 上聚合：

```
SELECT Name, MIN(LeftId) AS LeftId, MIN(RightId) AS RightId 
    FROM Tbl WHERE Tbl.Name IN (
      SELECT Name FROM Tbl WHERE (LeftId IS NULL) AND (RightId IS NULL)
      INTERSECT
      SELECT Name FROM Tbl WHERE (LeftId IS NOT NULL) OR (RightId IS NOT NULL)
    )
GROUP BY Name 
```

哪个返回

```
Name  LeftId  RightId
----  ------  -------
Cat   1
Cow   6       7 
```

[lc](https://stackoverflow.com/questions/867030/how-to-clean-this-sql-data-up/867069#867069)已经建议使用 COALESE 将这两个 ID 转换为一个 ID。那么这个怎么样：

```
SELECT Name, COALESCE(MIN(LeftId),MIN(RightId)) AS Id 
    FROM Tbl WHERE Tbl.Name IN (
      SELECT Name FROM Tbl WHERE (LeftId IS NULL) AND (RightId IS NULL)
      INTERSECT
      SELECT Name FROM Tbl WHERE (LeftId IS NOT NULL) OR (RightId IS NOT NULL)
    )
GROUP BY Name 
```

返回：

```
Name  Id
----  --
Cat   1
Cow   6 
```

* * *

对于第二个查询，您需要符合以下条件的行：

1.  仅出现`Name`在没有`LeftId`和的行中`RightId`

我想不出用一组标准在 SQL 中执行这种自引用查询的方法，所以我将其分解为两个标准。*两者都*必须遵守才能被接受：

1.  `Name`出现在没有`LeftId`和的行中`RightId`
2.  `Name`不会出现*在*具有`LeftId`或`RightId`

做#1很简单：

```
SELECT Name FROM Tbl WHERE (LeftId IS NULL) AND (RightId IS NULL) 
```

但是＃2很棘手。当然，做与#2相反的事情（“所有`Name`出现在具有`LeftId`or的行中的所有`RightId`）就像以前一样：

```
SELECT Name FROM Tbl WHERE (LeftId IS NOT NULL) OR (RightId IS NOT NULL) 
```

现在出现了棘手的问题——我们想要所有服从#1 但不服从与#2 相反的行。这是**EXCEPT**有用的地方：

```
SELECT Name FROM Tbl WHERE (LeftId IS NULL) AND (RightId IS NULL)
EXCEPT
SELECT Name FROM Tbl WHERE (LeftId IS NOT NULL) OR (RightId IS NOT NULL) 
```

返回：

```
Name
----
Bird 
```

这就是我们想要的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T05:04:53.637

如果我理解正确，那么这是相当微不足道的：

1：

```
SELECT * 
FROM your_table 
WHERE (LeftId IS NOT NULL 
AND RightId IS NULL)
OR
(LeftId IS NULL 
AND RightId IS NOT NULL) 
```

2：

```
SELECT * 
FROM your_table
WHERE 
    NOT EXISTS 
              (SELECT * FROM your_table y1
               WHERE (y1.LeftId IS NOT NULL OR y1.RightId IS NOT NULL)
               AND y1.name = your_table.name) 
```

如果这不正确，那么也许您可以澄清一下。

编辑：更新

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T05:05:25.867

查询 1)

```
SELECT * 
FROM Table 
WHERE (LeftID IS NULL AND RightID IS NOT NULL) 
    OR (LeftID IS NOT NULL AND RightID IS NULL) 
```

查询 2)

```
SELECT * 
FROM Table 
WHERE LeftID IS NULL AND RightID IS NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T05:19:49.683

我希望我在这里正确理解你。

查询一：

```
SELECT t1.Name, COALESCE(MIN(t1.LeftID), MIN(t1.RightID))
FROM Table t1
WHERE EXISTS(SELECT t2.Name
             FROM Table t2
             WHERE t2.Name = t1.Name 
             AND   t2.LeftID IS NULL AND t2.RightID IS NULL)
AND   COALESCE(MIN(t1.LeftID), MIN(t1.RightID)) IS NOT NULL
GROUP BY t1.Name 
```

查询 2：

```
SELECT t1.Name
FROM Table t1
WHERE NOT EXISTS(SELECT t2.Name
                 FROM Table t2
                 WHERE t2.Name = t1.Name
                 AND   (t2.LeftID IS NOT NULL OR t2.RightID IS NOT NULL)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T05:31:35.287

查询一：

```
SELECT [Name], [LeftID], [RightID]

FROM [TestTable]

WHERE -- "All rows which have at least 1 Id in one of the two columns"
      ([LeftID] IS NOT NULL OR [RightID] IS NOT NULL)
      OR
      -- "Rows with NO data in both of those two Id columns"
      ([LeftID] IS NULL AND [RightID] IS NULL) 
```

查询 2：

```
SELECT [Name], [LeftID], [RightID]

FROM [TestTable]

WHERE -- "All the rows where LeftId and RightId are NULL
      -- grouped by the same name"
      ([LeftID] IS NULL AND [RightID] IS NULL)
      AND
      -- "If another row (with the same name) has a value
      -- in the LeftId or RightId, this name will not be returned"    
      ([Name] NOT IN (SELECT DISTINCT [Name] FROM [TestTable]
                      WHERE [LeftID] IS NOT NULL
                            OR
                            [RightID] IS NOT NULL))

GROUP BY [Name], [LeftID], [RightID] 
```

结果：

```
Name                                               LeftID      RightID
-------------------------------------------------- ----------- -----------
Cat                                                1           NULL
Cat                                                1           NULL
Dog                                                2           NULL
Dog                                                2           NULL
Dog                                                NULL        3
Dog                                                NULL        3
Gerbil                                             4           5
Cat                                                NULL        NULL
Bird                                               NULL        NULL
Cow                                                6           NULL
Cow                                                NULL        NULL
Cow                                                NULL        7
Dog                                                8           9

(13 row(s) affected)

Name                                               LeftID      RightID
-------------------------------------------------- ----------- -----------
Bird                                               NULL        NULL

(1 row(s) affected) 
```

# sharepoint - SharePoint：在计算/查找字段方面需要帮助：

> ID：867033
> 
> 赞同：1
> 
> 时间：2009-05-15T04:58:25.023
> 
> 标签：sharepoint, sharepoint-2007

在计算字段方面需要帮助：

Activity_List : ActivityID, ActivityName, ActivityPerson （此列表用作模板来预填充 projectList 列。即）

项目列表：项目 ID、活动 ID、活动名称、活动人员。一旦您选择 ActivityID，它就会预填充 ActivityName 和 ActivityPerson。

我如何做到这一点在 SharePoint 列表中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:41:48.707

实际上，没有标准或广泛确认的方法可以做到这一点。不过，也有一些建议可能对您有所启发！No.1 构建自定义字段类型，为任何自定义列表创建基于父子关系的字段。这个链接[http://blog.12thwave.com/?p=7](http://blog.12thwave.com/?p=7)可以帮助你做到这一点。

另一个构建解决方案是[Cascaded Lookup](http://www.boostsolutions.com/cascaded-lookup.html)。面对海量数据，这个方案值得考虑！

干杯

# objective-c - 基本 Obj-C 问题：在对象上调用方法

> ID：867035
> 
> 赞同：1
> 
> 时间：2009-05-15T05:00:47.123
> 
> 标签：objective-c, cocoa

背景：我是一个 .NET 人员，之前没有 Objective-C/Cocoa 方面的经验，但我正在阅读 Aaron Hillegass 的书“Mac OS X 的 Cocoa 编程”，试图学习基础知识。（到目前为止，这本书很棒，顺便说一句！）为了完成一个可选的侧面挑战，我正在编写一个基于文档的应用程序，让用户可以在任意位置绘制椭圆。

我有两个类，接口如下：

```
@interface OvalDrawDocument : NSDocument
{
    IBOutlet OvalView* myOvalView;
}
@end

@interface OvalView : NSView {
    NSMutableArray *ovals;
}
@property (readwrite, assign) NSMutableArray *ovals;
@end 
```

在实现中，`OvalDrawDocument`我尝试使用自动生成的属性访问器，`ovals`如下所示：

```
// in OvalView.m
@synthesize ovals;

// in OvalDrawDocument.m
[myOvalView setOvals:loadedOvals];                // setter?
NSMutableArray *ovalsToSave = [myOvalView ovals]; // getter? 
```

但是，编译器警告我找不到这些方法，并且它们在运行时也不起作用。它们出现在 Code Sense 中，但我想这并不意味着什么（仍然习惯 XCode/VS 之间的差异）我猜这里有一些 Obj-C 概念我不太了解，可能与这`myOvalView`也是一个事实`IBOutlet`，但我很迷茫。我应该做什么，**更重要的是，为什么？**

* * *

**更新**：我没有在 OvalDrawDocument.m 中声明 OvalView.h。这样做修复了编译警告。但是，保存和加载似乎仍然不起作用，我不知道为什么。

根据要求，我已经在网上发布了完整的源代码以供阅读：[浏览](http://www.control-v.net/stackoverflow/867035/OvalDrawer/)或[下载 (59KB zip)](http://www.control-v.net/stackoverflow/867035/OvalDrawer.zip)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T05:22:55.947

警告：在 OvalDrawDocumentation 实现文件中导入 OvalView 的标头。

消息在运行时不起作用：确保您已实际连接 IB 中的插座。

此外，正如 Martin Pilkington 在他对您的问题的评论中所说，您可能应该使用`retain`，而不是声明该属性`assign`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T05:24:22.137

它与 IBOutlet keywrod 无关，它只是 Interface Builder 的“helper”关键字，在编译时被定义为“nothing”。您确实导入了相关的头文件并在 myOvalView 上进行了分配/初始化？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:21:26.073

我认为你将不得不展示更多的代码，因为你在那里似乎有正确的东西，所以你一定在其他地方遗漏了一些东西。此外，如果您要将椭圆声明为属性，那么在 OvalDrawDocument 中使用属性语法会很有意义：

```
// in OvalDrawDocument.m
myOvalView.ovals = loadedOvals;                // setter
NSMutableArray *ovalsToSave = myOvalView.ovals; // getter 
```

# wpf - 为什么服务器在尝试执行 .xbap 文件时会说找不到 .exe 文件？

> ID：867038
> 
> 赞同：0
> 
> 时间：2009-05-15T05:03:45.557
> 
> 标签：wpf, xbap

我使用 Visual Studio C# Express 创建了一个 .xbap 应用程序。

F5 运行良好。

然后按 F6，将以下文件从 /Release 目录复制到 ASP.NET 网络服务器：

*   Motion2.exe
*   Motion2.exe.manifest
*   Motion2.pdb
*   Motion2.xbap

但是当我尝试在 Firefox 或 IE 中执行它时：http: [//tanguay.de/xbap/Motion2/Motion2.xbap](http://tanguay.de/xbap/Motion2/Motion2.xbap)

我收到错误：下载[http://tanguay.de/xbap/Motion2/Motion2.exe](http://tanguay.de/xbap/Motion2/Motion2.exe)没有成功。

这发生在两台机器上，两台机器都安装了 .NET 3.5。

如何让我的 .xbap 应用程序在我的托管服务器上运行？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T05:27:36.030

然后我将构建/发布到指定它将从网站运行的位置，然后将名称 Publish.htm 更改为 Default.htm，复制生成的文件：

*   应用程序文件（文件夹）
*   默认.htm
*   Motion2.xbap

现在它运行：[http](http://www.tanguay.de/xbap/Motion2) ://www.tanguay.de/xbap/Motion2 （在 Firefox 和 IE 中，很好）。

# sql - 如何转换这个 t-sql 脚本？

> ID：867042
> 
> 赞同：1
> 
> 时间：2009-05-15T05:05:28.300
> 
> 标签：sql, sql-server, oracle

我不熟悉 Oracle，我需要有与我的 Oracle 脚本等效的东西。

脚本：

```
 SELECT  COL_NAME(parent_object_id, parent_column_id) AS ForigneKeyField,
        COL_NAME(referenced_object_id, referenced_column_id) AS PrimaryKeyField,
        OBJECT_NAME(referenced_object_id) AS PrimaryTable
FROM    sys.foreign_key_columns
WHERE   parent_object_id = OBJECT_ID(@name) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T06:35:57.410

我不熟悉 t-sql 但我熟悉 Oracle，所以：

看来您正在查询数据字典以获取给定表的所有引用完整性约束，并为每个表报告外键字段，以及它们所引用的表的相关字段和表。

`ALL_CONSTRAINTS`在 Oracle 中，此信息保存在`ALL_CONS_COLUMNS`数据字典视图中（或者`DBA_CONSTRAINTS / DBA_CONS_COLUMNS or USER_CONSTRAINTS / USER_CONS_COLUMNS`，取决于查询的范围）。我会运行这样的查询：

```
SELECT fc.constraint_name   AS ForeignConstraint
      ,fc.r_constraint_name AS ReferencedConstraint
      ,fcc.column_name      AS ForeignKeyField
      ,rcc.column_name      AS ReferencedKeyField
      ,rc.table_name        AS ReferencedTable
FROM   sys.all_constraints  fc
      ,sys.all_constraints  rc
      ,sys.all_cons_columns fcc
      ,sys.all_cons_columns rcc
WHERE  fc.table_name        = :name
AND    fc.constraint_type   = 'R'
AND    fc.r_constraint_name = rc.constraint_name
AND    fc.constraint_name   = fcc.constraint_name
AND    rc.constraint_name   = rcc.constraint_name
AND    fcc.position         = rcc.position
ORDER BY fc.constraint_name, fcc.position; 
```

我在查询中添加了约束名称（ForeignConstraint 和 ReferencedConstraint），这在引用约束涉及连接键时很有用。

# change-management - 你将如何处理不再有效的程序员？

> ID：867046
> 
> 赞同：5
> 
> 时间：2009-05-15T05:07:10.633
> 
> 标签：change-management

您团队中的程序员非常擅长维护旧的遗留系统。但该公司已转向新的技术/平台。

您如何处理不再有效的开发人员？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T05:11:11.343

尝试顺利地将他转移到新的技术/平台——首先给他小任务，然后是更大的任务，然后完全转移他。

如果他是一名优秀的程序员，他会学习和适应，如果不是，向他解释他将不得不考虑另一个职位——在同一家公司或另一个公司。这是生意，不是他的游乐场。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T05:12:11.683

据推测，该公司仍在从事同一业务，因此这个人将拥有多年来之不易的领域知识，可以在技术/项目管理或 BA 角色中加以利用。此外，如果您有不愿意迁移到新平台的现有客户，他将在支持角色中发挥无价的作用，因为没有一个新人会理解遗留的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-19T09:44:46.370

人们可能因为各种原因变得“不再有效”，包括失去热情、个人问题、对公司或管理层的幻想破灭、对技术变革的恐惧或厌倦、娱乐性药物的不当使用等。

据推测，他们曾经是受重视和有效的员工。一个人道的反应是找出问题所在，然后找到一种方法让那个人再次对自己和他们的工作感觉良好，这样他们就可以再次帮助企业提高生产力。处于您所描述的位置的人显然对现在效率低下或被其他更幸运或更有才华的同事视为“不再有效”感到不高兴。

所以我不喜欢你提出问题的方式，好像那个人已经成为一个问题和一个负担：它缺乏人性。如果你这样说，答案可能会更快地变得更清楚。

“我发现我不再是一个高效的开发人员，我担心我很快就会失业。我周围的世界已经发生了变化。我能做些什么来让我的雇主帮助我度过这个难关，让我恢复理智价值和自尊？”

PS 我今年 52 岁，主要通过承包和始终使用新技术，设法保持在最前沿，但我看到很多人处于你所描述的位置。在成为程序员或雇员之前，他们是人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T05:11:05.867

告诉他学习新技术，并提供合理的时间和帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T05:12:08.783

如果你不能在新系统上训练他，你将不得不让他离开。或者你可以将他提升为“项目经理”，等他搞砸了，然后解雇他。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T07:32:16.107

我认为，在您将旧软件投入生产之前，您总是需要了解旧平台的人。想象一下，如果所有可以为您 20 岁的 cobol 程序工作的人都走了，有一天客户打电话告诉您有问题......我以前已经看到过这种情况；）

与团队成员交谈，向他解释公司正在向不同的技术/语言/平台等方向发展，并为他提供课程或培训材料以跟上公司业务的可能性。

如果他不想花时间学习新东西，你可以随时尝试在不同的领域使用他。经验总是很重要，即使在你不使用的技术中也是如此。

假设你在一家使用 Visual Basic .net 的公司工作，你有两个程序员可供选择，一个有 1 年的 Visual Basic .net 经验，另一个有 15 年的低级 C++/汇编编程经验。我可能会聘请第二个，即使他对visual basic一无所知，他也肯定有很多经验可以分享。

阿尔克。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T07:54:43.727

留住他，至少有两个原因：

*   如果旧的遗留系统仍在生产中，他仍然有能力维护它。

*   他肯定比任何人都**清楚**旧系统是如何工作的，而且他也**知道**它在最隐蔽的部分做了什么。在指定和设计新系统时，这些知识非常有价值。你的人在构建新系统方面可以发挥作用，即使他没有参与新技术。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T07:10:47.577

最好的方法是积极主动的：确保为遗留系统编程的员工提供一定比例的涉及新技术的任务。这使他们对组织更有价值，并提高了他们的工作满意度。有什么不喜欢的？;-)

如果您是参与遗留代码的人，请务必花时间学习新技术，如果需要，请自行安排时间。

如果您不能将学到的知识直接应用到遗留代码中，您始终可以利用更新的技术来完成外围软件工程任务，例如源代码控制、配置管理、错误跟踪、项目管理（例如，敏捷项目管理的 Scrum 方法） )、文档、支持等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T07:44:08.307

除了已经说过的，我认为您还应该考虑遗留系统是否具有备份价值。特别是如果您刚刚采取行动。

考虑下面的假设场景：

步骤 1\. 实施全新的闪亮技术。

步骤 2\. 将遗留技术程序员转移到其他任何地方（或解雇）

步骤 3\. 发现新技术中的关键错误，或旧系统支持但新系统不支持的重要数据/流程。

第 4 步。

如果这个人一直“很棒”，那么他就有非常合理的机会学习新系统。他可能不知道所涉及的技术，但他确实知道系统的目的和功能。他知道系统做什么以及为什么，你只需要告诉他怎么做。

当然，如果他真的无法得到它，并且您确定遗留系统已准备好捐赠给博物馆......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-15T08:02:08.903

你问了这个问题，意味着你处于两难境地，意味着你喜欢这个人的工作，你确实说他擅长遗留代码。

擅长一件事的人也可以擅长其他事情（我相信如此）

告诉你的程序员 CHANGE 是不可避免的，告诉他开始改变他的技术，设定一个现实的、互惠互利的目标，并严格执行时间表。

如果他能领养，他会活下来，否则他会学会找一份新工作。[注意：我的意见和建议虽然可以帮助您，但不能保证 100% 成功。]

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-11-20T00:30:00.850

显而易见的，非有趣的答案是给他训练。不是给他一本书，告诉他学习新系统，而是给他适当的培训，送他上​​一门课程，让他从当前使用它的人那里学习系统，在他们的工作中跟随他们一段时间，提出问题和很快。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-09T00:16:31.477

这里有几个因素：

1.  公司规模
2.  回归旧技术的可能性
3.  员工转向新技术的意愿。
4.  公司对员工价值的看法

如果您谈论的是一家小公司（<10 人）；与其花时间对员工进行再培训，不如减少诱饵并寻找新的人才；对于公司和那个人。小型公司无法承受长期在工资单上没有生产力的人。

对于较大的公司，其他 3 项优先。如果有一丝回去的迹象，那么留住那个人是纯粹的保险。同样，如果员工对转向新技术（和做事方式）充满热情，那么他们可以将他们过去的所有经验用于前进。

最后，如果公司真的重视他们的员工，他们会试图鼓励员工将自己塑造成新的环境。不过在这里要小心，鼓励对变革不感兴趣的员工对任何人都不起作用。

* * *

我已经看到这个问题是双向的。在一个案例中，一名员工对转换感到高兴，并花费了大量时间来跟上进度；他们最终能够提供很多洞察力和价值。

我还看到那些跟随技术变革的人大喊大叫：他们应该比他们更早被放手。然而，该公司感到有义务继续与他们合作。在他们最终裁掉他一年后，我遇到了一个这样的人：他在新工作中快乐得多。

# c# - 如何细化从搜索中获得的结果

> ID：867047
> 
> 赞同：-1
> 
> 时间：2009-05-15T05:07:22.490
> 
> 标签：c#, asp.net, sql, sql-server, sql-server-2000

我正在使用带有 c# 的 SQL Server 2000 和 ASP.Net 来制作搜索引擎。

由于速度因素，我想改进从搜索中获得的结果，而不需要一次又一次地建立服务器连接。

如何让我的搜索更快？如何减少连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T05:20:54.720

正如 Matthew 所提到的，您的两个连接点是从客户端（Web 浏览器）到服务器（Web 服务器）的 HTTP 请求，以及从 Web 服务器到 sql 服务器的连接。

在整个 client-server-sql-server-client 旅程中，从 web 服务器到 sql server 的连接成本非常低。所以有人会假设您正在谈论浏览器到网络服务器的连接。避免这种情况的唯一方法是将整个数据库（或至少可以查询的未过滤记录池）转储到浏览器并在客户端进行过滤 - 这是一个令人难以置信的！糟糕！主意。

所以我的建议是停止烦恼，像往常一样编写应用程序，如果完成后事情看起来很慢，那么你可以开始寻找缓慢的原因 - 而不是试图猜测（并且可能是错误的) 在出现问题之前。

# compact-framework - .net 紧凑框架：避免程序同时启动两次

> ID：867050
> 
> 赞同：4
> 
> 时间：2009-05-15T05:10:09.847
> 
> 标签：compact-framework

如何避免用户两次启动同一个程序？当前的实现尝试使用“FindWindow”来做到这一点，但由于程序打开第一个窗口需要一些时间，用户经常设法启动程序两次，从而导致错误等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T16:43:51.270

您必须使用命名互斥体，以便可以跨进程使用它。不管出于什么（愚蠢的）原因，CF 设计师认为 CF 开发人员永远不需要这样的东西，所以你有 2 个选择：

1.  P/Invoke CreateMutex 和相关的清理工作
2.  使用 OpenNETCF 中已经编写好的实现，例如 SDF 的[NamedMutex 类](http://opennetcf.com/library/sdf/html/0bd35291-a154-0277-1dcf-233208d75a5f.htm)（它只是为您执行 #1）。

实际上还有第三种选择。SDF 的[Application2 类](http://opennetcf.com/library/sdf/html/fcac3a8d-fb5b-fc77-74f4-5603c51c19bb.htm)有几个[Run 方法重载](http://opennetcf.com/library/sdf/html/98173725-375a-b394-89dc-7affb44961cf.htm)，它们为您包装了此逻辑并强制执行应用程序单例行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-13T18:18:25.630

使用这个：http: [//msdn.microsoft.com/en-us/netframework/bb943002.aspx](http://msdn.microsoft.com/en-us/netframework/bb943002.aspx)

那里的许多替代方案要么太复杂，要么不能一直有效。

# c# - 处理警告的最佳实践

> ID：867051
> 
> 赞同：13
> 
> 时间：2009-05-15T05:10:33.123
> 
> 标签：c#, warnings

我目前正在处理的项目每次构建时都会生成 30 多个警告。他们从项目开始就被忽略了。我猜是由于缺乏关于警告的政策。

你通常如何处理这个问题？完全忽略它们？尝试一次修复它们（这需要一些时间）？或者只是在路上一点一点地修复？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-15T07:41:49.140

他们中只有 30 个，只需 2 小时的工作人员就可以修复它们。

我完全不同意任何说最后期限取代修复这些警告的人。与现在解决问题相比，您将在后期代码完成阶段的问题上浪费更多的时间。忽略你的经理，他可能是一个想在老板面前看起来不错的白痴。初始质量和正确的设计比他任意的期限（在合理范围内）更重要。您首先收到警告的事实意味着有人对代码草率。仔细检查存在警告的区域是否正确。

如果您正在使用代码分析或正在编写 C/C++，那么警告有时实际上是无效的。在这种情况下，将它们编译为 (C/C++) 或 System.Diagnostics.CodeAnalysis.SuppressMessage。这可以从 VS2008 自动完成。

我没有看到任何在代码分析之外无效的 .net 警告。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-15T05:17:17.863

我强烈建议使用将警告视为错误的设置进行构建。当然，这将导致项目停止构建，但这是强制执行合理错误策略的唯一方法。

完成此操作后，您可以检查您收到的警告并做出一些合理的决定。可能有一些警告是良性的并且您不关心，因此将这些警告添加到要忽略的警告列表中。修复其余部分。如果您现在没有时间修复所有问题，请添加 #pragma（或 C# 等效项）以忽略每个文件中出现的特定警告，并为每个文件提交错误以确保稍后解决它们。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-15T05:16:44.637

在我们的开发团队中，每个人都需要在周五啤酒点之前清理他们的警告。如果您不修复警告 - 没有啤酒适合您。令人惊讶的是，这是一个很好的动力。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-15T06:19:48.650

大多数程序员在编写完每个结构后都会定期构建他们的代码，只是为了看看它是否正确构建。这是标记警告的时间（在 VB 中，它们也被后台构建标记）。

我将在每次构建时修复警告作为一项政策。我也不接受来自我的团队的任何标记警告的代码。只有极少数类型的警告是“可接受的”。

所以，我的策略是，我不会在以后将它们全部修复在一起，而是在它们被标记时修复它们。附带说明一下，当我的代码开始标记警告时，我会责备自己编写不符合我标准的代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-15T06:57:28.060

去年秋天，我继承了一个新的 5,000 行 Java 子系统，它有 100 个被忽略的警告。和这里的其他受访者一样，我的策略是修复每一个警告，在这样做的过程中，我发现 100 个中的三个是真正的编程错误。警告是有原因的，所以不要忽视它们，修复它们。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-15T06:40:43.890

每个警告都应该被修复，或者特别禁用（使用编译器指令或消除它的代码结构）。
如果您决定忽略警告而不禁用它，那么所有警告都将变得毫无意义——因为您只是不再查看它们。你*知道*有一些“好的”警告，那么为什么还要看这个列表呢？

另外，强烈建议在最高警告级别进行编译，并“将警告视为错误”（但这是由您的编译器完成的）。如果您的编译器不支持此设置 - 尝试通过查看其输出/返回值作为构建脚本/过程的一部分来强制执行它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T05:15:56.557

最佳做法是将它们一起修复。您应该修复您现在拥有的那些，看起来可能需要一些时间，但它们通常是可以轻松修复的小语法错误。然后，当您在创建更多代码时开始获取它们时，您可以随时修复出现的那些。

我也总是将我的项目保持在警告级别 4，这是最高级别的警告，这样当我编译时，我可以修复默认编译器（Visual Studio）认为错误的所有内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T05:22:55.277

我还认为，您应该一起修复它们，在此之后我建议您切换编译器设置以将所有警告视为错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T07:02:46.597

在编程时，您会遇到很多问题，这些问题不会被编译时捕获（邪恶的运行时错误）。所以编译器无法找到所有问题（也就是错误）。在某些情况下，他只是说，嗯，可能有问题，但我真的不知道，请检查一下（也就是警告）。因此，请查看警告，修复它并继续。

在极少数情况下，你真的知道你在做什么，只是想，我知道这个警告，但这段代码是正确的，所以不要再打扰我了。在这些（非常罕见的）情况下，您可以封装提到的行

```
// Why you think this warning should be disabled at this point
#pragma warning disable xxx
/// ... some code ...
#pragma warning restore xxx 
```

并继续，编译器不再提及。

因此，请查看所有警告并修复它们。通过重新编程或暂时禁用此警告。

PS真的**不要**在您的项目设置中禁用警告。因为在这种情况下，您将在全局范围内禁用它（因此可能会为将来创建的代码），也不能添加任何禁用它的注释。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-15T06:31:25.580

想象一下你的项目是一辆汽车。

如果任何时候您启动汽车时 30-40 个警告灯闪烁，您会怎么做？

如果您的构建脚本发出警告，您至少**必须**看看发生了什么，为什么会有这个警告。当然，您可以有运行带有警告的系统的示例，但这不是您想要的（我期望）。

我们使用一些静态代码分析器lime PMD 或findBugs（都用于Java）。每次构建后，我们还会修复这些工具提供的警告。

如果您的警告出于某种原因并不重要，那么请查看您的语言是否提供了诸如@supressWarning 之类的内容。其实这不是推荐。这只是一个评论。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T08:06:06.010

* * *

故意编码，割草机，好像你的警告是在跟踪纸上推出的。像蝴蝶的翅膀一样脆弱，像蚕的茧一样紧紧抓住——当你能把它的长度编码成印刷警告的长度，并且不留下任何错误的痕迹，你就会学会。——朴老师

* * *

如果您收到的警告标记了您没有考虑到的事情，您应该继续将警告视为错误，并立即修复它们。

如果你收到的警告总是关于你故意做的事情，并且生成的代码符合你的意图，并且修复它们所花费的时间不可忽略，你可以忽略它们，但你需要一个新的习惯用于修复错误。

现在进行修复的一部分必须包括检查每个错误，以查看是否有任何当前被忽略的警告实际上标记了错误。保持运行计数。只要忽略的警告没有帮助，就继续。如果/当您发现您忽略了两个有意义的警告时，请切换回将所有警告视为错误。给自己一些时间来改进，然后再试一次。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-15T05:20:28.293

程序员抽烟

一个人站在街角，一根接一根地抽着烟。一位路过的女士注意到他并说

“喂，你不知道那些东西会害死你吗？我的意思是，你没看到盒子上的巨大警告吗？！”</p>

“没关系”，那家伙说，随口吐了口气，“我是一名计算机程序员”</p>

“所以？有什么关系？”</p>

“我们不关心警告。我们只关心错误。”</p>

;)

我的建议是忽略，直到您的解决方案完美运行。然后开始修复警告；因为在大多数情况下，该行业是“以截止日期为导向的”。；）

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-05-15T05:14:15.860

我实际上做了什么：我当前的项目也产生了 30-40 个警告，我忽略了它们。

我应该做什么：修复它们，因为其中一些可能是有意义的。

# hardware - 空中应用程序与外部硬件通信

> ID：867058
> 
> 赞同：1
> 
> 时间：2009-05-15T05:14:01.850
> 
> 标签：hardware, air

我想知道我的 adobe air 应用程序是否可以与外部硬件的 API 函数进行通信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T05:39:47.797

最简洁的答案是不。AIR 没有直接的机制来与客户端机器上的本机代码或操作系统进程进行交互。

但是，您可以建立从 AIR 客户端到客户端计算机上运行的服务器进程的套接字连接。如果服务器进程可以完成您需要的硬件集成，这将起作用，尽管由于您需要安装 AIR 应用程序 + 其他本机代码，这会使您的安装例程有些复杂。

其中一个例子是 Merapi 项目，它将 AIR 连接到在客户端机器上运行的基于服务器的 Java 应用程序，该应用程序可以调用 exec() 来启动本机应用程序或使用 JNI 来利用本机代码。

[http://www.merapiproject.net/](http://www.merapiproject.net/)

# makefile - 如何抑制makefile中的回声？

> ID：867077
> 
> 赞同：3
> 
> 时间：2009-05-15T05:22:45.060
> 
> 标签：makefile, gnu-make

我在 Makefile 中有以下 PHONY 目标

```
install: 
        echo /usr/bin/shelldecrypt must be writable
        cp shelldecrypt /usr/bin 
```

当我运行目标时，它会显示它正在执行的命令

**提示>进行安装**

*输出是*

```
    echo /usr/bin/shelldecrypt 必须是可写的
    /usr/bin/shelldecrypt 必须是可写的
    cp shelldecrypt /usr/bin

```

*我想要的输出*

```
    /usr/bin/shelldecrypt 必须是可写的
    cp shelldecrypt /usr/bin

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T05:29:31.190

您可以在命令前添加“@”来抑制该回声

```
install: 
        @echo /usr/bin/shelldecrypt must be writable
        cp shelldecrypt /usr/bin 
```

# postgresql - 导入/更新 PostgreSQL 中的现有行

> ID：867084
> 
> 赞同：2
> 
> 时间：2009-05-15T05:25:19.017
> 
> 标签：postgresql

我正在开发一个爱好应用程序，该应用程序将包含大量基本硬编码的数据，以及部署后的动态用户数据。我希望能够在本地更新硬编码数据（`UPDATE`s 多于`INSERT`s），然后将这些数据导出到服务器。换句话说，我需要将数据转储到文件中，并以这样的方式导入它，即新行（相对较少）是`INSERT`ed，现有行（由 PK 标识）是`UPDATE`d。显然，不能`INSERT`在服务器上编辑新行（否则 PK 可能会发生冲突并发出错误`UPDATE`的 s）；这是一个可接受的限制。但是，我不能`DELETE`将行设为`UPDATE`d，更不用说删除同步表了，因为用户可访问的表将对“静态”表具有 FK 约束。

不幸的是，这似乎很难做到。谷歌和 Postgres 邮件列表通知我“类似 MySQL”的功能`on_duplicate_key_update`“将在新版本中”（陈旧信息；是否存在？），以及“ `pg_loader can do it`”的建议，没有说明*如何*。

在最坏的情况下，我想我可以想出一个自制的解决方案（转储一个数据文件，编写一个自定义导入脚本来适当地检查 PK 冲突和问题`INSERT`或`UPDATE`语句），但这似乎是一个非常笨拙的解决方案其他人肯定在我之前遇到过的问题。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:31:33.383

是的，临时表+插入/更新的一些组合是要走的路（你不需要在函数中这样做，但你可以）。

作为记录，您正在寻找的功能是合并命令。有人为它写了一个补丁，但它从未完成。AFAIK 现在没有人在研究它；它肯定不会在即将发布的 Postgres 8.4 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:55:51.437

```
create temporary table newdata as select * from table1 where false; 
```

用新数据填充 newdata，然后：

```
start transaction;
create function fill_table1() returns void as
$$
declare
    data record;
begin
    for data in select * from newdata
    loop
        update table1 set
            column1 = data.column1,
            column2 = data.column2
        where id = data.id
        if not found then
            insert into table1 values data.*;
        end if;
    end loop;
end;
$$ language plpgsql;
select fill_table();
drop function fill_table();
commit; 
```

这未经测试，因此可能需要一些调整才能工作。它要求表在运行时不会更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T05:35:39.053

您是否考虑过在本地运行 postgresql？

1.  转储服务器数据
2.  本地导入
3.  打开查询日志记录
4.  进行更新
5.  获取查询日志并在服务器上运行
6.  清除查询日志

还是我误解了您要做什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T12:43:47.983

这个问题似乎与[此](https://stackoverflow.com/questions/728373/performing-insert-or-update-upsert-on-sql-server-compact-edition/731847)类似：

也许你可以检查我在那里提供的解决方案。

# aix - 如何限制对 aix 上文件夹的 root 访问？

> ID：867087
> 
> 赞同：0
> 
> 时间：2009-05-15T05:26:57.030
> 
> 标签：aix

我想限制对 aix 上某些文件夹的访问。

即使是 root 用户也应该被限制访问某些文件夹。对于 e..gi 在 aix 5.3 服务器上有用户 - aixuser 和 root 并且我有一个文件夹 - myfolder。

我只希望 aixuser 可以访问此文件夹而不是 root。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T05:30:19.550

不，这是做不到的。root 用户的整个概念依赖于不受限制的访问。您可以使用用户/组/其他范例或访问控制列表很容易地保护您的文件免受其他普通用户的侵害，但是，一旦有人拥有 root 权限，您就根本无法限制它们。

这有一个很好的理由 - 如果您以某种方式失去了对文件的访问权限，您希望管理员如何为您恢复它们？

处理您的问题的方法是限制具有 root 访问权限的人数或以某种方式加密您的文件。但即使*是*后一种建议也不会阻止确定的根用户，他们可以查看您的进程地址空间或拦截您的输入流以获取您的密码（如果需要）。

唯一可行的安全措施是拥有自己的盒子，只有你拥有根权限。然后，您可以将另一个盒子上的 root 用户视为您的普通用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T05:28:36.073

您不能排除对任何本地文件系统上任何文件的 root 访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T20:54:07.387

正如 paxdiablo 所说，root 用户特权是 AIX 中的终极目标（实际上是任何 UNIX/Linux 机器）。在 RBAC 中，将角色权限设置为 aix（在 mkrole 命令中）将授予您执行 root 用户可以执行的所有操作的权限，但只能执行 root 用户。

如果 UID=0，则 GID=0 为**root**提供了它在机器上所需的所有访问权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-03T21:52:54.033

实际上，我相信您可以使用加密的文件系统来做到这一点。我还没有这样做。对不起，含糊的答复。但我相信 EFS 有两种模式。一种是信任root，另一种是不信任root。

来自[https://www.ibm.com/developerworks/aix/library/au-efs/index.html](https://www.ibm.com/developerworks/aix/library/au-efs/index.html)

```
AIX® EFS encryption is at the file system level. Each file is protected with a unique file key, and protection is created against malicious root. 
```

如果您真的考虑一下，加密是您唯一的选择。Root 可以打开硬盘并将其复制到另一个驱动器，然后对文件系统本身进行随心所欲的操作。防止root的唯一方法是通过加密。

# asp.net - 哪个控件回发了我的页面？（ASP.NET 页面）

> ID：867095
> 
> 赞同：2
> 
> 时间：2009-05-15T05:30:47.723
> 
> 标签：asp.net, page-lifecycle

1 - 我想知道如何让哪个控件发回页面，有什么方法可以转换

```
Request["__EVENTVALIDATION"] 
```

值字符串到可理解的字符串。

2- 组件将按什么顺序绑定以及它们如何从视图状态中获取它们的值？

感谢4您的帮助...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T08:44:27.743

在 Web 窗体上，ASP.NET 将启动回发的控件存储在名为“__EVENTTARGET”的隐藏字段中，但按钮控件除外。
更多信息可以在[这里](http://www.aspdotnetfaq.com/Faq/How-to-determine-which-Control-caused-PostBack-on-ASP-NET-page.aspx)和[这里](http://ryanfarley.com/blog/archive/2005/03/11/1886.aspx)找到。

# macos - 使用股票 apache 和 php5 在 Mac OSX 上启用 memcache

> ID：867098
> 
> 赞同：3
> 
> 时间：2009-05-15T05:32:09.497
> 
> 标签：macos, memcached

我一生都无法弄清楚如何在 Mac OSX 上启用 memcache 以与 apache 一起工作。我已经安装了 memcache，并且可以通过 php 命令行验证它是否正常工作。

以下命令：

```
php --ri memcache 
```

报告支持 memcache。

但是，如果我在浏览器中加载执行 phpinfo() 的本地测试脚本，它不会报告已安装 memcahe。在我的浏览器中运行一个脚本来实例化一个新的 memcache 对象报告：

```
Fatal error: Class ‘Memcache’ not found 
```

我已经编辑了 php.ini 并添加了 extensions=memcache.so

我已经通过转到系统偏好设置->共享并禁用和启用 Web 共享来重新启动 apache。我什至尝试使用 sudo apachectl restart 从命令行重新启动 apache。

当通过浏览器执行时，我可能会错过什么阻止 php 识别 memcache？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T08:16:16.907

您可能会将 memcache.so 扩展安装在一个`*/no-debug-non-zts-*`有时很痛苦的目录中（在 Linux 上也是如此），并且 php.ini 可能不会在该目录中查找。您可以更改 php.ini 中的扩展目录（这可能会破坏其他内容），或者更好地在`*/no-debug-non-zts-*`目录中创建指向 memcache.so 文件的符号链接。

就我而言，这是：

```
ln -s /usr/local/lib/php/extensions/no-debug-non-zts-20060613/memcache.so /usr/lib64/php/modules/memcache.so 
```

除此之外，检查 memcache.so 文件的权限并确保它是可执行的（755），在我的例子中，这是：

```
chmod 755 /usr/local/lib/php/extensions/no-debug-non-zts-20060613/memcache.so 
```

希望有帮助，这是我的最后一个建议:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-09T03:17:51.737

当然，命令行 php 和 mod_php 似乎使用不同版本的 php.ini。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-15T07:26:34.513

你用内存缓存做什么？你是如何启动它的？您是否也在机器上运行了 memcached？

这不是一个专门的 mac 答案，但希望它能让你沿着跑步路线前进，如果这涵盖了显而易见的问题，我们深表歉意。

您需要在 mac 上或 mac 可以在 memcached 端口上访问的另一台机器上运行 memcached。

Mac 上的 memcached 上有一个特定的文档 - [http://memcached.darwinports.com/](http://memcached.darwinports.com/)

请记住，您还需要配置 php 以将 memcache 用于您希望 memcache 缓存的任何内容，例如更改相关的 PHP 设置，例如使用 memcache 来处理会话：

session.save_handler = 文件
更改为：
session.save_handler = memcache

session.save_path="tcp://:11211?persistent=1&weight=1&timeout=1&retry_interval=2"

希望这在某种程度上有所帮助。

[http://www.of-networks.co.uk](http://www.of-networks.co.uk)

# algorithm - 布隆过滤器还是布谷鸟哈希？

> ID：867099
> 
> 赞同：18
> 
> 时间：2009-05-15T05:32:47.907
> 
> 标签：algorithm, hash, filter

你更偏向于哪个，为什么？

它们都可以用来完成类似的任务，但我很好奇人们在实际应用中使用了什么以及他们这样做的理由。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-11-24T05:16:24.573

Bloom 过滤器和 Cuckoo 过滤器在类似的情况下使用，但有很多差异通常决定哪个是更好的选择。

Bloom 过滤器在数据库引擎内部使用，特别是 Apache Cassandra。原因正如其他发帖者所说，为了降低慢集操作的成本。基本上，任何“这可能存在或绝对不存在”的高成本操作都可以使用布隆过滤器来减少完成的检查次数。

当今 SaaS 模型的另一个常见示例是具有每次调用成本的远程 REST 服务。任何带有二进制答案的 API 调用（例如“此地址是否无效”）都可以使用布隆过滤器来消除 90% 以上的重复查询！请注意，由于 Bloom 和 Cuckoo 过滤器具有误报，因此它们对于逆运算“此地址是否有效”没有用处

重要的是要记住 Bloom 和 Cuckoo 过滤器没有误报。这使得这些过滤器对于诸如“这绝对不是垃圾邮件或可能是垃圾邮件”之类的检查很有用，但对于不可接受误报的操作（例如检查用户权限）则无用。在这方面，它们在概念上可以被认为是缓存的对立面。Bloom/Cuckoo 过滤器和缓存都主要用于通过布尔答案降低昂贵操作的成本，除了缓存没有误报，Bloom/Cuckoo 没有误报。

Cuckoo/Bloom 之间的显着差异包括：

*   组合。只要使用相同的参数创建布隆过滤器，就可以有效地合并它们。快速且带宽小。这就是为什么你会看到它们在大规模分布式系统中经常使用，交换 Bloom 过滤器很快。Cuckoo 过滤器不容易组合，这使得它们在这些情况下不太有用。

*   假阳性率。Cuckoo 过滤器更节省空间。这两种结构的许多用例都集中在低级网络上。在弱硬件上，对于相同的误报率，Cuckoo 过滤器的效率提高约 40% 可能很重要。参考实现，在 C++ 中，对每个桶中的项目进行排序以节省额外的空间，利用项目在桶中的位置来存储较小的指纹。我稍后会提到的其他库（包括我的）似乎没有这样做。如果有人使用我的库，我可能会添加它:)。

*   恒定的误报率。布隆过滤器的误报率越来越差，因为它们超过了设计的大小。您可以永远插入项目，但最终您的误报率将接近 100%。基于 Cuckoo 散列的 Cuckoo 过滤器具有一定的容量，其中插入实际上会失败。重复插入非随机项目哈希可能会导致 Cuckoo 过滤器插入失败，可能远在其设计的填充水平之前。

*   速度。这是主观的，很大程度上取决于硬件，但 Cuckoo 过滤器在一般情况下通常更快（根据我的经验）。大多数布隆过滤器设计运行一个哈希函数两次。特别是在使用安全散列函数时，与只散列插入的项目一次的 Cuckoo 过滤器相比，这可能是一个很大的障碍。我看到的代码对 Bloom 和 Cuckoo 过滤器使用了各种散列函数。Google 的 Guava Bloom 使用 Murmur3，许多其他实现使用 SHA1 或其他东西。如果您的用例可以利用散列冲突，请确保库使用安全散列。重要的是要知道 Bloom 过滤器的插入时间大致恒定，而 Cuckoo 过滤器的插入时间是恒定的 AVERAGE 情况。由于 Cuckoo 过滤器在容量的百分之几以内，插入速度会大大降低。即使这样，

*   灵活性。布隆过滤器仅支持插入和包含。Cuckoo 过滤器还支持删除和有限计数。在参考设计中，Cuckoo 过滤器可以确定一个项目被插入了多少次，最多 7 次。布隆过滤器只能确定是-否。Cuckoo 过滤器还支持删除插入的项目，与 Bloom 相比，这在许多用例中是一个很大的优势。使用 Bloom 过滤器时，当过滤器“已满”（估计误报率超过阈值）时从头重新创建过滤器是非常标准的，因为您无法删除旧项目。请注意，当插入开始失败时，Cuckoo 过滤器仍然会重建过滤器，因此根据用例，这可能没有实际意义。在某些情况下，Cuckoo 过滤器更有用，因为您可以删除项目以保持在过滤器限制范围内，而不是重建。

*   支持。Cuckoo 过滤器是许多语言的新的稳定库，根本不存在。

布隆过滤器的最大优势是它们在大多数语言中都有更成熟的库支持。布隆过滤器背后的数学原理也被科学家们更好地理解了。Cuckoo 过滤器的大部分特性都是根据经验确定的，而 Bloom 过滤器具有坚实的数值基础。这不包括必须验证其性能的实时和关键系统的 Cuckoo 过滤器，尽管实验证据表明 Cuckoo 过滤器在大多数情况下表现更好。

Shameless Plug：我是 Java 的 Cuckoo 过滤器库的开发人员。[杜鹃过滤器4J](https://github.com/MGunlogson/CuckooFilter4J/ "CuckooFilter4J")。它缺少论文中使用的桶半排序，因此空间效率略低于参考实现。在项目自述文件中，我有指向我知道的其他实现的链接。哪种结构更好取决于您的用例，但主要取决于您的语言是否存在可靠的 Cuckoo 过滤器实现。

在生产中使用 Cuckoo/Bloom 过滤器之前，您绝对应该查看源代码。在编写自己的库之前，我通读了各种库……由于 32 位底层数组或明显的性能问题，其中许多库具有静默大小限制。大多数人的测试为零。Google 的 Guava Bloom 实现具有迄今为止最好的代码质量和测试（并支持 64 位数组限制）。Guava 的 Bloom 唯一的缺点是它没有使用安全哈希函数的选项并且不是多线程的。

在生产系统中，您可能需要多线程以提高速度。Guava's Bloom 的答案是为每个线程制作不同的过滤器，并偶尔将它们组合起来。由于 Cuckoo 过滤器无法组合，因此我在 Cuckoo 过滤器库中添加了并发线程。我知道的另一个不是线程安全的或不是并发的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-11-08T02:42:12.847

你更喜欢哪一个，葡萄酒还是奶酪？

布隆**过滤器**适用于**空间有限**、**查询成本高**且**大多为否定查询**的情况。
在这种情况下，**每个键 8 位**和**4 个哈希函数的****布隆过滤器**会给你**2.5% 的误报率**；您处理查询的**速度比以前快了近 40 倍**，代价是**每个键 1 个字节**。

 ******另一方面，如果**前面的任何条件都不成立**，那么**作为缓存的哈希表**是有意义的，尽管**每个条目显然需要多于一个字节**:-)

如果它是缓存，您甚至可以跳过**布谷鸟哈希的硬边缘情况。**这也使得**布谷鸟哈希表**（或线性哈希以外的任何东西）的大小增加问题没有实际意义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-04T21:46:44.220

杜鹃过滤器。

“布谷鸟过滤器：实际上比布卢姆更好。” Bin Fan、David Andersen、Michael Kaminsky、Michael Mitzenmacher CoNext 2014。http: [//dx.doi.org/10.1145/2674005.2674994](http://dx.doi.org/10.1145/2674005.2674994)

来自一位作者的[博客](http://mybiasedcoin.blogspot.com/2014/10/cuckoo-filters.html)：

> 让我描述一下布谷鸟过滤器和论文中的一些内容。如果你想避免技术讨论，你只需要知道对于相当大的集合，对于与相应的布隆过滤器相同的误报率，布谷过滤器比布隆过滤器使用更少的空间，查找速度更快（但更慢插入/构造），并且令人惊讶的是还允许删除键（Bloom过滤器不能这样做）。如果您想查看代码，甚至有一个[github 存储库](https://github.com/efficient/cuckoofilter)供您使用，其中包含 cuckoo 过滤器的代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T05:44:47.893

我更喜欢杜鹃哈希。我对在较高填充因子下布隆过滤器可能出现的误报保持警惕。
在我们拥有非常大的哈希表并且遇到内存压力问题的应用程序中使用了布谷鸟哈希。请在[http://codeplex.com/ecollections](http://www.codeplex.com/ecollections)上查看我的 eCollections 库，了解布谷鸟散列变体的实现。

亲切的问候，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T04:41:57.977

如果我可以容忍误报并且空间很重要，我会使用布隆过滤器，因为它占用的空间更少。否则，我使用哈希。

# sharepoint - 用于日期时间比较的 Sharepoint 计算列公式

> ID：867101
> 
> 赞同：1
> 
> 时间：2009-05-15T05:34:36.293
> 
> 标签：sharepoint, datetime, comparison, calculated-columns

我有两列 C1 和 C2，在文档库中都是日期和时间类型。现在我想创建一个计算列 C3，使用它我可以知道哪一列（C1 或 C2）具有更大的价值。我尝试了计算列 IF(C1>C2, 1,0) 的以下公式，它工作得非常好，但如果我用“修改”列替换 C1，它似乎不起作用。请为 C2 使用不同的日期时间值以在计算列中获得 1,0,1,0。我注意到经过 2-3 次操作后，它仍然是 1 或 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T05:43:36.367

**更新** 我刚刚对此进行了如下测试：

创建包含 3 列的列表：

```
C1 - Date and Time    
C2 - Date and Time    
C3 - Calculated Column. 
```

我将计算列配置为返回一个数字并输入以下公式：

```
=IF(c1>c2,1,0) 
```

这非常有效。

如果计算列应返回文本（默认设置），则使用以下公式有效：

```
=IF(c1>c2,"1","0") 
```

再一次，这对我来说非常有效。

# c# - 寻找样本来验证 UTF-8

> ID：867104
> 
> 赞同：3
> 
> 时间：2009-05-15T05:35:41.597
> 
> 标签：c#, validation, utf-8

假设我有一个字节流（数组），我想编写代码（使用 .Net C#）来验证它是否是有效的 UTF-8 字节序列。我想从头开始编写代码，因为我需要报告存在无效字节序列的确切位置，甚至可能删除无效字节——而不仅仅是想知道字节流/数组是否有效。

是否有任何示例代码可供参考？如果没有 C# 代码，也可以使用 C++/Java 中的简单示例。谢谢！

对于 UTF-8 的无效字节序列，我的意思是

[http://en.wikipedia.org/wiki/UTF-8#Invalid_byte_sequences](http://en.wikipedia.org/wiki/UTF-8#Invalid_byte_sequences)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T06:37:19.763

您需要的是[DecoderFallback](http://msdn.microsoft.com/en-us/library/system.text.decoderfallback.aspx)。当`Encoding`类尝试将字节序列转换为目标编码时，您可以指定回退行为：

*   要么[报错，要么停止处理](http://msdn.microsoft.com/en-us/library/system.text.decoderexceptionfallback(VS.80).aspx)。
*   或者[找到错误并替换它](http://msdn.microsoft.com/en-us/library/system.text.decoderreplacementfallback(VS.80).aspx)。

使用`UTF8Encoding`并且`DecoderReplacementFallback`您可以实现您正在寻找的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T11:23:07.627

这就是原始问题所要求的，即使它不是原始海报真正需要的。但是，我已经编写[了一些 C 代码来验证字节流是否为 utf-8](http://snowplow.org/martin/utf8checker/)，并使其免费可用。也许通过谷歌搜索针对这个问题的其他人会发现它很有用。

它一次占用一个字节，因此适用于流处理，并将所有内容分类为有效的 UTF-8 或字节序列中的以下可能错误之一：

```
/* Ways a UTF stream can screw up */
/* a multibyte sequence without as many continuation bytes as expected.  e.g. [ef 81] 48 */
#define MISSING_CONTINUATION 1 
/* A continuation byte when not expected */
#define UNEXPECTED_CONTINUATION 2 
/* A full multibyte sequence encoding something that should have been encoded shorter */
#define OVERLONG_FORM 3
/* A full multibyte sequence encoding something larger than 10FFFF */
#define OUT_OF_RANGE 4
/* A full multibyte sequence encoding something in the range U+D800..U+DFFF */
#define BAD_SCALAR_VALUE 5
/* bytes 0xFE or 0xFF */
#define INVALID 6 
```

这个验证器有一个很好的属性，如果*a*和*b*是有效的 utf-8 字节流，并且*x*是其他一些字节流，那么连接*a* + *x* + *b*将被解码为所有在*a*中编码的字符，某种组合字符和错误，然后是*x*中编码的所有字符。也就是说，无效的字节序列不能吃掉在坏字节之后开始的有效编码字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-10T16:24:06.113

```
static void CheckUTF8(byte[] data)
{
    new UTF8Encoding(false, true).GetCharCount(data);
} 
```

`DecoderFallbackException`对无效数据抛出 a 。`DecoderFallbackException.Index`应该指向无效序列的索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T05:47:03.363

好点。我不知道存在无效的 UTF-8 序列。

维基百科上的文章是一个起点，但我认为您无法进行完整的测试。你能？我有兴趣

完整的测试意味着对于每个序列，您都可以有一个函数来回答每个可能的序列是或否。功能齐全。

如果您的序列不完整（短序列），关键是要做什么或返回。据我所知，有些编辑器会添加特殊字符以实现它。可能您应该处理无效序列等情况，然后您的测试将完成。我想知道这是否是唯一的情况。

无论如何，我会将这个问题作为收藏夹，以便跟踪答案。当然有人会照亮我们。

# asp.net - ASP.NET 2.o 页面的 jQuery 登录模式弹出窗口

> ID：867109
> 
> 赞同：3
> 
> 时间：2009-05-15T05:38:41.510
> 
> 标签：asp.net, jquery, .net-2.0, modalpopups

我有一个 ASP.NET 网页（不是 MVC）（HomePage.aspx）和另一个页面（PRiceList.aspx）。我的主页中有登录功能。所以当用户登录网站时，他们可以去pricelist.aspx 页面很容易使用主页中的链接。如果有人在没有登录的情况下进入页面，我想显示一个模式登录框（背景禁用）来登录。我在 jqueryui 网站上看到了这个。谁能告诉我如何在我的网站上实现这个？这是否存在任何安全问题，因为我在使用此方法时使用 javascript 将用户凭据发送到站点（我不确定）。请指教。提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T06:17:06.083

jQuery Modal Form Dialog 是你可以去这里的方式。我做了一个测试应用程序做你想做的事，它运行良好。

ASPX 页面的标记：

```
<div id="dialog" title="Please Login">
        <asp:Login ID="login" runat="server" />
</div> 
```

页面所需的 Javascript：

```
$(document).ready(function() {
$("#dialog").dialog({
    bgiframe: true,
    autoOpen: false,
    height: 300,
    modal: true,
    buttons: {
        Cancel: function() {
            $(this).dialog("close");
        }
    },
    close: function() {
        allFields.val("").removeClass("ui-state-error");
    }
});

var isAuthenticated = $("#isAuthenticated").val();
if (isAuthenticated && isAuthenticated == "false") {
    // Display the modal dialog.
    $("#dialog").dialog("open");
}}); 
```

我在aspx页面上使用的代码：

```
ClientScript.RegisterHiddenField("isAuthenticated", "false"); 
```

你会给它真或假，这取决于用户是否经过身份验证，所以 javascript 会知道是否显示登录名。

现在关于安全性。登录不会由 javascript 完成，因为用户会点击该登录页面上的按钮，然后它会像往常一样发回服务器。如果您想使用 ajax，则必须查看 jQuery [$.ajax](http://docs.jquery.com/Ajax)方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T05:51:30.933

使用 jquery 对话框：

[http://jqueryui.com/demos/dialog](http://jqueryui.com/demos/dialog)

这也需要您将模式添加回 DOM。

```
jQuery(".loginPanel").each(function() 
{ 
   var popup = jQuery(this); 
   popup.parent().appendTo(jQuery("form:first")); 
}); 
```

# .net - 如果我的最终目标是 ASP.NET MVC，我应该学习多少 ASP.NET？

> ID：867112
> 
> 赞同：5
> 
> 时间：2009-05-15T05:40:07.793
> 
> 标签：.net, asp.net, asp.net-mvc

从零开始，对 .NET 知之甚少，在开始深入研究 ASP.NET MVC 之前，我应该学习多少 ASP.NET？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-15T05:51:48.623

实际上，我认为您应该学习很少的传统 ASP.NET 网络表单，或者根本不学习。

ASP.NET MVC 使用与“传统” ASP.NET webforms 完全不同的范例，并且忘记其中的一部分几乎是必要的。ASP.NET webforms 的核心引擎——页面生命周期和视图状态——在 ASP.NET MVC 中都没有。

如果您来自更类似于 MVC 的背景，例如 PHP 或 Ruby on Rails，则尤其如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T05:53:39.650

购买一本简单的书，并仔细阅读 scottgu 的 asp.net mvc nerddinner 示例。它将涵盖实际应用程序的所有方面。

这是链接： [http ://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx](http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx)

这是真正的网站：www.nerddinner.com

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T12:44:08.430

理想情况下，您应该**首先学习 MVC**，因为它迫使您学习和*理解*Web 的各个部分，例如 HTTP 请求、Web 的无状态、HTML、CSS 等。

因此，如果您决定使用 Web 表单，或者被迫使用 Web 表单，您就会了解事物是如何被抽象出来的，并且可以更好地编码以提高应用程序的效率。

从 Web 表单拖放的吸引力一开始可能非常吸引人。但是过了一会儿，你就会看到 MVC 是多么的好，因为它迫使你从一开始就完全控制你的代码。

就个人而言，我曾涉足网络表单——但在使用 MVC 之后，就没有回头路了。另一方面，MVC 是建立在 webforms 之上的，所以你可以随时使用它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T05:43:13.200

尽你所能。

你知道和理解的越多，你就会越有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T12:34:03.867

大约 **-** 100% 的网络表单应该足够了，考虑到网络表单更多的是让事情自动为您处理，而 ASP.NET MVC 意味着对大多数事情的更多控制:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T16:23:12.537

尽你所能地。**ASP.NET MVC 只是 ASP.NET 的一部分**——因此，要构建可扩展且快速的 ASP.NET MVC 应用程序，你实际上必须学习“所有”ASP.NET（我认为你也必须学习 Webforms——至少部分学习）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T17:34:11.883

I think it depends on your programming background. If you are already familiar with web development and its stateless nature, then by all means learn MVC first. It is much more "pure" web development. However, it requires a much more in-depth understanding of how the web works.

On the other hand, if you are used to developing in a stateful environment, it can be much more comfortable to learn Web Forms first. If you are trying to learn a new language/platform, adding the extra trauma of learning to work with a stateless environment is unnecessary and may slow your progress.

Ultimately, it comes down to what you are comfortable with. Read up on both, and see which makes more sense for yourself personally, and for the task at hand. Neither Web Forms nor MVC are the end-all be-all of web development. They are both tools, and as with all tools, each is appropriate for different tasks.

# c# - 为什么 C# 中没有引用计数 + 垃圾回收？

> ID：867114
> 
> 赞同：64
> 
> 时间：2009-05-15T05:40:46.590
> 
> 标签：c#, garbage-collection, reference-counting

我来自 C++ 背景，我已经使用 C# 工作了大约一年。像许多其他人一样，我对为什么确定性资源管理没有内置在语言中感到困惑。我们有 dispose 模式，而不是确定性析构函数。[人们开始怀疑](https://stackoverflow.com/questions/752344)通过他们的代码传播 IDisposable 癌症是否值得付出努力。

在我偏向 C++ 的大脑中，使用带有确定性析构函数的引用计数智能指针似乎是垃圾收集器的一大进步，垃圾收集器需要你实现 IDisposable 并调用 dispose 来清理你的非内存资源。诚然，我不是很聪明......所以我问这个纯粹是为了更好地理解为什么事情会这样。

如果 C# 被修改为：

对象是引用计数的。当一个对象的引用计数变为零时，会在该对象上确定性地调用资源清理方法，然后将该对象标记为进行垃圾回收。垃圾收集发生在未来某个不确定的时间，此时内存被回收。在这种情况下，您不必实现 IDisposable 或记得调用 Dispose。如果您有非内存资源要释放，您只需实现资源清理功能。

*   为什么这是个坏主意？
*   这会破坏垃圾收集器的目的吗？
*   实施这样的事情是否可行？

编辑：从到目前为止的评论来看，这是一个坏主意，因为

1.  没有引用计数的 GC 更快
2.  处理对象图中的循环问题

我认为第一个是有效的，但第二个很容易使用弱引用来处理。

速度优化是否超过了您的缺点：

1.  可能无法及时释放非内存资源
2.  可能过早释放非内存资源

如果您的资源清理机制是确定性的并且内置于语言中，那么您可以消除这些可能性。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-26T04:52:36.340

Brad Abrams 发布了 Brian Harry在 .Net 框架开发期间写[的一封电子邮件。](https://docs.microsoft.com/en-gb/archive/blogs/brada/resource-management)它详细说明了未使用引用计数的许多原因，即使早期的优先事项之一是保持与使用引用计数的 VB6 的语义等价。它研究了一些可能性，例如对某些类型进行引用而不是对其他类型进行计数（`IRefCounted`！），或者对特定实例进行引用计数，以及为什么这些解决方案都不被认为是可接受的。

> 因为[资源管理和确定性最终确定的问题]是一个如此敏感的话题，我将尽量在我的解释中做到准确和完整。我为邮件的长度道歉。这封邮件的前 90% 是试图让你相信这个问题确实很困难。在最后一部分中，我将讨论我们正在尝试做的事情，但您需要在第一部分了解我们为什么要考虑这些选项。
> 
> ...
> 
> 我们最初假设**解决方案将采用自动引用计数的形式**（因此程序员不会忘记）加上其他一些东西来自动检测和处理周期。...我们**最终得出结论，这在一般情况下是行不通的。**
> 
> ...
> 
> 总之：
> 
> *   我们觉得在 不强迫程序员围绕这些复杂的数据结构问题去理解、追踪和设计的情况下，**解决循环问题是非常重要的。**
> *   我们希望确保我们拥有一个高性能（速度和工作集）系统，我们的分析表明，**对系统中的每个对象使用引用计数将无法实现这一目标**。
> *   由于各种原因，包括组合和铸造问题，**没有简单透明的解决方案来仅对那些需要它的对象进行引用计数**。
> *   我们选择不选择**为单一语言/上下文提供确定性终结的解决方案，因为它抑制**了与其他语言的互操作，并通过创建特定于语言的版本导致类库的分叉。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-15T05:48:14.593

垃圾收集器不需要您为您定义的**每个**类/类型编写 Dispose 方法。当你需要明确地做一些事情来清理时，你只定义一个；当您明确分配本机资源时。大多数时候，GC 只是回收内存，即使您只对对象执行 new() 之类的操作。

GC 确实引用计数 - 但是它以不同的方式执行它，通过在**每次执行集合时**`Ref Count > 0`查找哪些对象是“可访问的”（ ）......它只是不以整数计数器方式执行它。. 收集无法访问的对象 ( )。这样，运行时不必在每次分配或释放对象时都进行内务处理/更新表......应该更快。**`Ref Count = 0`**

 **C++（确定性）和 C#（非确定性）之间的唯一主要区别是何时清理对象。您无法预测在 C# 中收集对象的确切时间。

*无数个插件：如果您真的对 GC 的工作原理感兴趣，我建议您阅读 Jeffrey Richter 关于[CLR 中通过 C#的 GC 的站立章节。](https://rads.stackoverflow.com/amzn/click/com/0735621632)*

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-05-15T05:51:29.873

在 C# 中尝试了引用计数。我相信，发布 Rotor（提供了源代码的 CLR 的参考实现）的人确实引用了基于计数的 GC，只是为了看看它与分代的 GC 相比如何。结果令人惊讶——“普通”GC 速度如此之快，甚至都不好笑。我不记得我是在哪里听到的，我认为这是 Hanselmuntes 播客之一。如果你想看到 C++ 在与 C# 的性能比较中基本被压垮——谷歌 Raymond Chen 的中文词典应用程序。他做了一个 C++ 版本，然后 Rico Mariani 做了一个 C# 版本。我认为 Raymond 经过 6 次迭代才最终击败了 C# 版本，但到那时他不得不放弃 C++ 中所有好的面向对象的特性，并降到 win32 API 级别。整个事情变成了性能黑客。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-26T03:20:22.100

C++ 风格的智能指针引用计数和引用计数垃圾回收之间存在差异。[我还在我的博客](http://lukequinane.blogspot.com/2009/04/smart-pointers-managed-automatic-memory.html)上谈到了不同之处，但这里有一个简短的总结：

### C++ 样式引用计数：

*   **递减的无限成本：**如果大型数据结构的根递减为零，则释放所有数据的成本是无限的。

*   **手动循环收集：**为防止循环数据结构泄漏内存，程序员必须通过用弱智能指针替换部分循环来手动破坏任何潜在结构。这是潜在缺陷的另一个来源。

### 引用计数垃圾回收

*   **延迟 RC：**堆栈和寄存器引用忽略对对象引用计数的更改。相反，当触发 GC 时，这些对象通过收集根集来保留。可以推迟和批量处理对引用计数的更改。这导致[更高的吞吐量](http://portal.acm.org/citation.cfm?id=390011.808261)。

*   **合并：**使用写屏障可以[合并](http://portal.acm.org/citation.cfm?id=1111596.1111597)对引用计数的更改。这使得忽略对象引用计数的大多数更改成为可能，从而提高了频繁变异引用的 RC 性能。

*   **循环检测：**对于完整的 GC 实施，还必须使用循环检测器。然而，可以以增量方式执行循环检测，这反过来意味着有限的 GC 时间。

基本上可以为 Java 的 JVM 和 .net CLR 运行时等运行时实现高性能的基于 RC 的垃圾收集器。

我认为跟踪收集器的使用部分是出于历史原因：最近对引用计数的许多改进都是在 JVM 和 .net 运行时发布之后出现的。研究工作也需要时间才能过渡到生产项目。

## 确定性资源处置

这几乎是一个单独的问题。.net 运行时使用 IDisposable 接口使这成为可能，示例如下。我也喜欢[Gishu的](https://stackoverflow.com/users/1695/gishu)回答。

* * *

[@Skrymsli](https://stackoverflow.com/users/105568/skrymsli)，这是“[使用](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)”关键字的目的。例如：

```
public abstract class BaseCriticalResource : IDiposable {
    ~ BaseCriticalResource () {
        Dispose(false);
    }

    public void Dispose() {
        Dispose(true);
        GC.SuppressFinalize(this); // No need to call finalizer now
    }

    protected virtual void Dispose(bool disposing) { }
} 
```

然后添加一个具有关键资源的类：

```
public class ComFileCritical : BaseCriticalResource {

    private IntPtr nativeResource;

    protected override Dispose(bool disposing) {
        // free native resources if there are any.
        if (nativeResource != IntPtr.Zero) {
            ComCallToFreeUnmangedPointer(nativeResource);
            nativeResource = IntPtr.Zero;
        }
    }
} 
```

然后使用它很简单：

```
using (ComFileCritical fileResource = new ComFileCritical()) {
    // Some actions on fileResource
}

// fileResource's critical resources freed at this point 
```

另请参阅[正确实施 IDisposable](http://msdn.microsoft.com/en-us/library/ms244737(VS.80).aspx)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-12-19T16:50:51.623

> 我来自 C++ 背景，我已经使用 C# 工作了大约一年。像许多其他人一样，我对为什么确定性资源管理没有内置在语言中感到困惑。

该`using`构造提供“确定性”资源管理并内置于 C# 语言中。请注意，“确定性”的意思是保证在块开始执行`Dispose`之后的代码之前被调用。`using`另请注意，这不是“确定性”一词的含义，但每个人似乎都在这种情况下以这种方式滥用它，这很糟糕。

> 在我偏向 C++ 的大脑中，使用带有确定性析构函数的引用计数智能指针似乎是垃圾收集器的一大进步，垃圾收集器需要你实现 IDisposable 并调用 dispose 来清理你的非内存资源。

垃圾收集器不需要您实现`IDisposable`. 事实上，GC 完全没有注意到它。

> 诚然，我不是很聪明......所以我问这个纯粹是为了更好地理解为什么事情会这样。

跟踪垃圾收集是一种模拟无限内存机器的快速可靠的方法，将程序员从手动内存管理的负担中解放出来。这消除了几类错误（悬空指针、过早释放、双重释放、忘记释放）。

> 如果 C# 被修改为：
> 
> 对象是引用计数的。当对象的引用计数变为零时，会在对象上确定性地调用资源清理方法，

考虑一个在两个线程之间共享的对象。线程竞相将引用计数减为零。一个线程将赢得比赛，另一个负责清理。那是不确定的。认为引用计数本质上是确定性的信念是一个神话。

另一个常见的神话是引用计数在程序中最早的可能点释放对象。它没有。递减总是被推迟，通常到作用域的末尾。这使对象的存活时间超过了必要的时间，留下了所谓的“浮动垃圾”。请注意，特别是，一些跟踪垃圾收集器可以并且确实比基于范围的引用计数实现更早地回收对象。

> 然后将该对象标记为垃圾回收。垃圾收集发生在未来某个不确定的时间，此时内存被回收。在这种情况下，您不必实现 IDisposable 或记得调用 Dispose。

无论如何，您不必`IDisposable`为垃圾收集的对象实现，所以这是无益的。

> 如果您有非内存资源要释放，您只需实现资源清理功能。
> 
> 为什么这是个坏主意？

天真的引用计数非常慢并且会泄漏周期。例如， C++ 中[的 Boost`shared_ptr`比 OCaml 的跟踪 GC 慢 10 倍](http://flyingfrogblog.blogspot.co.uk/2011/01/boosts-sharedptr-up-to-10-slower-than.html)。在多线程程序（几乎所有现代程序）存在的情况下，即使是基于范围的简单引用计数也是不确定的。

> 这会破坏垃圾收集器的目的吗？

一点也不，不。事实上，这是一个坏主意，它是在 1960 年代发明的，并在接下来的 54 年中进行了激烈的学术研究，得出的结论是引用计数在一般情况下很糟糕。

> 实施这样的事情是否可行？

绝对地。早期的原型 .NET 和 JVM 使用引用计数。他们还发现它很糟糕并放弃了它以支持跟踪 GC。

> 编辑：从到目前为止的评论来看，这是一个坏主意，因为
> 
> 没有引用计数的 GC 更快

是的。请注意，您可以通过延迟计数器递增和递减来更快地进行引用计数，但这会牺牲您非常渴望的确定性，并且它仍然比使用今天的堆大小跟踪 GC 慢。然而，引用计数越来越快，所以在未来某个时候，当堆变得非常大时，也许我们会开始在生产自动化内存管理解决方案中使用 RC。

> 处理对象图中的循环问题

试验删除是一种专门设计用于检测和收集参考计数系统中的循环的算法。但是，它是缓慢且不确定的。

> 我认为第一个是有效的，但第二个很容易使用弱引用来处理。

将弱引用称为“简单”是希望战胜现实的胜利。他们是一场噩梦。它们不仅不可预测且难以架构，而且会污染 API。

> 速度优化是否超过了您的缺点：
> 
> 可能无法及时释放非内存资源

不及时`using`释放非内存资源？

> 可能过早释放非内存资源如果您的资源清理机制是确定性的并且内置于语言中，则可以消除这些可能性。

该`using`结构是确定性的并内置于语言中。

I think the question you really want to ask is why doesn't `IDisposable` use reference counting. My response is anecdotal: I've been using garbage collected languages for 18 years and I have never needed to resort to reference counting. Consequently, I much prefer simpler APIs that aren't polluted with incidental complexity like weak references.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-15T05:53:22.130

我对垃圾收集有所了解。这是一个简短的摘要，因为完整的解释超出了这个问题的范围。

.NET 使用复制和压缩分代垃圾收集器。这比引用计数更先进，并且具有能够收集直接或通过链引用自己的对象的好处。

引用计数不会收集循环。引用计数也具有较低的吞吐量（总体上较慢），但具有比跟踪收集器更快的暂停（最大暂停更小）的好处。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-15T05:55:43.343

这里有很多问题。首先，您需要区分释放托管内存和清理其他资源。前者可能非常快，而后者可能非常慢。在 .NET 中，两者是分开的，这样可以更快地清理托管内存。这也意味着，当您有超出托管内存要清理的内容时，您应该只实施 Dispose/Finalizer。

.NET 采用了一种标记和清除技术，它遍历堆寻找对象的根。有根的实例在垃圾收集中幸存下来。只需回收内存即可清除其他所有内容。GC 必须时不时地压缩内存，但除此之外，即使在回收多个实例时，回收内存也是一个简单的指针操作。将此与 C++ 中对析构函数的多次调用进行比较。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T05:55:31.237

当用户没有显式调用 Dispose 时，实现 IDisposable 的对象还必须实现由 GC 调用的终结器 - 请参阅[MSDN 上的 IDisposable.Dispose](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)。

IDisposable 的全部意义在于 GC 在某个不确定的时间运行，而您实现 IDisposable 是因为您拥有宝贵的资源并希望在确定的时间释放它。

因此，就 IDisposable 而言，您的提议不会改变任何内容。

编辑：

对不起。没有正确阅读您的建议。:-(

[维基百科对References counted GC的缺点](http://en.wikipedia.org/wiki/Reference_counting#Advantages_and_disadvantages)有一个简单的解释

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T05:55:55.027

**参考计数**

使用引用计数的成本是双重的：首先，每个对象都需要特殊的引用计数字段。通常，这意味着必须在每个对象中分配一个额外的存储字。其次，每次将一个引用分配给另一个引用时，都必须调整引用计数。这显着增加了赋值语句所花费的时间。

**.NET 中的垃圾收集**

C# 不使用对象的引用计数。相反，它维护堆栈中对象引用的图，并从根导航以覆盖所有引用的对象。图中所有引用的对象都在堆中压缩，以便为未来的对象提供连续的内存。回收所有不需要最终确定的未引用对象的内存。那些未被引用但要在其上执行终结器的那些被移动到称为 f-reachable 队列的单独队列，垃圾收集器在后台调用它们的终结器。

除了上述 GC 之外，还使用了生成的概念来进行更有效的垃圾收集。它基于以下概念 1\. 压缩托管堆的一部分的内存比压缩整个托管堆更快 2\. 较新的对象将具有较短的生命周期，而较旧的对象将具有较长的生命周期 3\. 较新的对象倾向于彼此相关并由应用程序大约在同一时间访问

托管堆分为三代：0、1、2。新对象存储在gen 0中。经过一次GC循环没有回收的对象被提升到下一代。因此，如果第 0 代中较新的对象在 GC 周期 1 中存活，那么它们将被提升到第 1 代。其中那些在 GC 周期 2 中存活的对象被提升到第 2 代。因为垃圾收集器仅支持三代，所以第 2 代中的对象在第 2 代中保留一个集合，直到确定它们在未来的集合中无法访问。

垃圾收集器在第 0 代已满并且需要为新对象分配内存时执行收集。如果第 0 代的收集没有回收足够的内存，垃圾收集器可以执行第 1 代的收集，然后是第 0 代。如果这没有回收足够的内存，垃圾收集器可以执行第 2、1 和 0 代的收集.

因此 GC 比引用计数更有效。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-03T01:31:39.917

确定性非内存资源管理是语言的一部分，但它不是用析构函数完成的。

您的观点在来自 C++ 背景的人中很常见，他们试图使用[RAII](http://en.wikipedia.org/wiki/RAII)设计模式。在 C++ 中，您可以保证某些代码将在作用域末尾运行（即使抛出异常）的唯一方法是在堆栈上分配一个对象并将清理代码放入析构函数中。

在其他语言（C#、Java、Python、Ruby、Erlang 等）中，您可以改用 try-finally（或 try-catch-finally）来确保清理代码始终运行。

```
// Initialize some resource.
try {
    // Use the resource.
}
finally {
    // Clean-up.
    // This code will always run, whether there was an exception or not.
} 
```

IC#，您还可以使用[using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)构造：

```
using (Foo foo = new Foo()) {
    // Do something with foo.
}
// foo.Dispose() will be called afterwards, even if there
// was an exception. 
```

因此，对于 C++ 程序员来说，将“运行清理代码”和“释放内存”视为两个独立的事情可能会有所帮助。将您的清理代码放在 finally 块中，并留给 GC 处理内存。

# python - python实例变量作为可选参数

> ID：867115
> 
> 赞同：8
> 
> 时间：2009-05-15T05:40:57.073
> 
> 标签：python, function, class

在 python 中，有没有办法可以在类方法中使用实例变量作为可选参数？IE：

```
def function(self, arg1=val1, arg2=val2, arg3=self.instance_var):
    # do stuff.... 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-15T05:45:31.463

试试这个：

```
def foo(self, blah=None):
    if blah is None: # faster than blah == None - thanks to kcwu
        blah = self.instance_var 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-15T07:51:18.243

所有建议的回答`None`都是正确的；如果您想确保调用者可以将 None 作为常规参数传递，请使用特殊的`sentinel`和测试`is`：

```
class Foo(object):
  __default = object()
  def foo(self, blah=Foo.__default):
    if blah is Foo.__default: blah = self.instavar 
```

每次调用`object()`都会创建一个唯一的对象，这样`is`在它和任何其他值之间永远不会成功。两个下划线的`__default`意思是“强私有”，这意味着调用者知道他们不应该试图弄乱它（并且需要相当多的工作才能做到这一点，明确地模仿编译器正在做的名称修改）。

顺便说一句，您不能只使用您发布的代码的原因是默认值在`def`语句评估时评估，而不是在调用时进行评估；并且在`def`评估时，还没有`self`从中获取实例变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T05:47:33.893

不，因为类函数定义时实例不存在

你必须重写如下

```
def function(self, arg1=val1, arg2=val2, arg3=None):
    if arg3 is None:
        arg3 = self.instance_var 
```

这与原来的略有不同：如果你真的想要，你不能传递带有 None 值的 arg3。

替代解决方案：

```
def function(self, arg1=val1, arg2=val2, **argd):
    arg3 = argd.get('arg3', self.instance_var) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-26T20:27:45.043

```
def foo(self, blah=None):
    blah = blah if not blah is None else self.instance_var 
```

这适用于 python 2.5 并转发并处理 blah 为空字符串、列表等的情况。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-15T05:53:02.817

另一种方法是：

```
def foo(self, blah=None):
    blah = blah or self.instance_var 
```

这个较短的版本看起来更好，特别是当有多个可选参数时。

**小心使用。请参阅下面的评论...**

# c# - 如何在 MVC Html.DropDownList() 中添加静态项目列表

> ID：867117
> 
> 赞同：14
> 
> 时间：2009-05-15T05:41:03.893
> 
> 标签：c#, .net, asp.net, asp.net-mvc, html-helper

我想在 ASP.NET MVC 中将 a 中的静态项目列表分配给 a `SelectList()`，`Html.DropDownList()`最佳做法是什么？

我正要尝试找到一种使用方法，`new SelectList(new {key = "value"}...`但是一个不起作用，第二个，我会在这里违反法律吗，我的静态列表是否应该以任何方式声明`ViewData`并传递为`IList/IENumerable`？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T06:17:42.837

最好不要在视图中创建 SelectList。您应该在控制器中创建它并使用 ViewData 传递它。

例子：

```
 var list = new SelectList(new []
                                          {
                                              new {ID="1",Name="name1"},
                                              new{ID="2",Name="name2"},
                                              new{ID="3",Name="name3"},
                                          },
                            "ID","Name",1);
            ViewData["list"]=list;
            return View(); 
```

您传递给构造函数：IEnumerable 对象、值字段、文本字段和选定值。

在视图中：

```
 <%=Html.DropDownList("list",ViewData["list"] as SelectList) %> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-01T15:10:29.327

所有 MVC 新手最初都避免使用“M”字，但它确实从 MVC 首字母缩写词的开头开始。所以也许，只是也许，你可能想用一个模型开始你的解决方案......只是说。

不要重复自己（干）。您将最终将“new PageData()”复制并粘贴到将选项列表传递给视图的每个控制器。然后，您将要删除或添加一个选项，并且必须编辑每个控制器的 PageData。

此外，您希望以最少的不必要的冗长“add”、“new”、“IS”和“Name”键入最少的代码。因为您在选择选项（和/或单选按钮列表）中只有一个键值对，所以在您的模型中使用尽可能轻的数据结构，即 Dictionary --。

然后只需在 Controller 中引用 Model 并使用包含 LINQ Lambda 表达式的 DropDownListFor 将 Dictionary 转换为 View 中的 SelectList。

被吓倒了？你不是一个人。我当然是。这是我用来自学 M、V 和 C 的示例：

MVC的模型部分：

```
using System.Web.Security;
using System.Collections.Generic;
using System.Text;
using System.Linq.Expressions;
using System.Web.Routing;
using System.Web.Helpers;
using System.Web.Mvc.Html;
using MvcHtmlHelpers;
using System.Linq;

// EzPL8.com is the company I work for, hence the namespace root. 
    // EzPL8 increases the brainwidths of waiters and bartenders by augmenting their "memories" with the identifies of customers by name and their food and drink preferences.
   // This is pedagogical example of generating a select option display for a customer's egg preference.  

namespace EzPL8.Models     
{
    public class MyEggs    
    {
        public Dictionary<int, string> Egg { get; set; }

        public MyEggs()  //constructor
        {
            Egg = new Dictionary<int, string>()
            {
                { 0, "No Preference"},  //show the complete egg menu to customers
                { 1, "I hate eggs"},    //Either offer an alternative to eggs or don't show eggs on a customer's personalized dynamically generated menu

                //confirm with the customer if they want their eggs cooked their usual preferred way, i.e.
                { 2, "Over Easy"},  
                { 3, "Sunny Side Up"},
                { 4, "Scrambled"},
                { 5, "Hard Boiled"},
                { 6, "Eggs Benedict"}
            };
    }
} 
```

控制器现在相当简单，只需传递模型。它避免了创建一个孤立的概念，它可能不仅仅局限于一页。：

```
public ActionResult Index()
{
   var model = new EzPL8.Models.MyEggs();
   return View(model);
} 
```

视图使用 DropDownListFor（而不是 DropDownList），并且需要用于事件重构中的强类型的 Lambda 表达式：

```
@Html.DropDownListFor(m => m.Egg, new SelectList( Model.Egg, "Key", "Value")) 
```

瞧，生成的 HTML：

```
<select id="Egg" name="Egg">
<option value="0">No Preference</option>
<option value="1">I hate eggs</option>
<option value="2">Over Easy</option>
<option value="3">Sunny Side Up</option>
<option value="4">Scrambled</option>
<option value="5">Hard Boiled</option>
<option value="6">Eggs Benedict</option>
</select> 
```

注意：不要`<option value="6">`对 SelectList() 中的“Value”中的 VALUE 感到困惑，它是字典中的键，它是在选项标签之间结束的文本/标题（例如 Eggs Benedict）。

**用例**：为了最大限度地减少应用程序和数据库之间的流量，我创建了一个静态列表，以避免数据库查询下拉列表，如果有的话，很少更改。然而，变化是不可避免的，从现在起六个月后，我客户餐厅的一名用餐者去世了；不是因为绿色的火腿，而是因为他们对鸡蛋过敏，厨师在他们的华夫饼里混了一些。

餐厅需要立即更新他们的客户信息以包括食物过敏。虽然他们喜欢回头客，但他们对死去的顾客作为僵尸回来并不酷，因为他们的信用卡被取消了，他们无法付款。

反问：我应该修改所有与客户鸡蛋偏好相关的控制器和视图吗？或者只是将 { 7, "Allergic to Eggs"} 插入模型中？

另一个反问：煎蛋不是鸡蛋吗？是否要向模型中添加一次 {8, "Omelette, Western"}, {9, "Omelette, Mushroom-Feta-Spinach"} 并让新添加的内容自动传播到所有使用它们的视图中的所有下拉列表中?

**底线**这可能比您要求的要多，...但您确实说过 MVC，而不仅仅是 VC： 1\. 在 * *M* *VC
中使用模型。2\. Use a dictionary in the Model when a select list is based on nothing more than a "primary key" and a title. 3\. 如果您的静态列表与某处的数据库查找表不匹配，则您的应用程序可能不是很有用。当您向静态列表添加选项时，您很可能还需要对查找表执行插入操作，以避免与数据库中的其他表发生主键/外键关系完整性错误。4\. 使用 lambda 和强类型数据结构来避免错误并获得 typeahead 支持。

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T06:05:31.417

好的，我决定接受自己的建议，这应该在控制器中定义：

仅供参考，我刚回来：

```
PageData data = new PageData()
           {
               Formats = new[]
                             {
                                 new { ID = "string", Name = "Text" },
                                 new { ID = "int", Name = "Numeric" },
                                 new { ID = "decimal", Name = "Decimal" },
                                 new { ID = "datetime", Name = "Date/Time" },
                                 new { ID = "timespan", Name = "Stopwatch" }
                             },
               .............

           };
return View(data); 
```

...（忽略上下文）并在 View ASPX 端：

```
<%= Html.DropDownList("type.field", new SelectList(ViewData.Model.Formats, "ID", "Name"... 
```

如果有人有更优化的方法，我会很乐意接受他们的回答。

# django - 如何检查 Django (django-admin) 中的值转换？

> ID：867120
> 
> 赞同：8
> 
> 时间：2009-05-15T05:43:20.283
> 
> 标签：django, django-admin, django-forms

我有一个状态字段，它有 3 个值：挂起、激活和拒绝。如果我要更改状态的值，我希望检查已激活不能更改为待处理。我不想为此编写存储过程。在保存之前我可以在 Django 中获得以前的值吗？

表示新旧价值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T13:34:23.270

```
def clean_status(self):
    status = self.cleaned_data.get('status')
    if status == 'pending':
        if self.instance and self.instance.status == 'activated':
            raise forms.ValidationError('You cannot change activated to pending')

    return status 
```

此方法将添加到`Form`子类中。它的名字是`clean_FIELD_NAME`。

`cleaned_data`包含以前的值。新值存储在`self.instance`.

或者，`validate()`可以将方法添加到`forms.Field`子类中。[请参阅 Django 文档。](https://docs.djangoproject.com/en/dev/ref/forms/validation/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-15T06:35:08.113

您可以在覆盖的`save`方法中执行此操作。要记住的是，Django 模型实例不是实际的数据库对象，它们只是在加载时从那里获取它们的值。因此，您可以在保存当前对象之前轻松返回数据库以获取现有值。

```
def save(self, *args, **kwargs):
    if self.status == 'pending':
         old_instance = MyClass.objects.get(pk=self.pk)
         if old_instance.status == 'activated':
              raise SomeError
     super(MyModel, self).save(*args, **kwargs) 
```

除了引发异常之外，目前没有向用户返回错误消息的好方法。目前有一个 Google Summer of Code 项目正在进行中，以启用“模型验证”，但这要几个月才能准备好。

如果您想在管理员中做类似的事情，最好的方法是定义一个自定义 ModelForm 并覆盖一个`clean()`方法。但是，这一次，因为这是一种形式，您已经可以访问旧值而无需再次访问数据库。另一个好处是您可以向用户返回表单验证错误。

```
class MyModelForm(forms.ModelForm):

     class Meta:
          model = MyModel

    def clean_status(self):
        status = self.cleaned_data.get('status', '')
        if status == 'pending':
             if self.instance and self.instance.status == 'activated':
                  raise forms.ValidationError(
                      'You cannot change activated to pending'
                  )
         return status

 class MyModelAdmin(forms.ModelAdmin):
     form = MyModelForm
     model = MyModel 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-10T19:28:50.377

这已在 Stack Overflow 的其他地方得到解答，但正确的方法是使用类似[这样](https://github.com/smn/django-dirtyfields)的方法来跟踪字段是否脏。然后，您可以使用信号来表示重要的事情发生了变化。（即你的领域）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T10:47:26.837

与其重写 save 方法，这不是一个使用信号的好地方吗？在提交前拦截保存，检查数据库中的当前值，然后转发保存，或者拒绝它？

现在我不确定信号是否阻止了保存请求或者它是否发生异步，所以如果不能使用信号来防止在验证时发生保存，请随意对这个答案投反对票。

如果有另一个同样有效的内置工具，我反对覆盖内置方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-20T19:35:59.207

在搜索同一问题的答案时发现了此线程。为什么不做这样的事情？这样你就可以避免接触数据库。并且内置`__init__`只是有点扩展。我认为这比使用信号更简单。

```
class MyModel(models.Model):
    my_fair_field = ....

    def __init__(self, *args, **kwargs):
        super(MyModel, self).__init__(*args, **kwargs)
        self.__clean_fair_field = self.my_fair_field

    def save(self, *args, **kwargs):
        # check if field value changed
        if self.__clean_fair_field != self.my_fair_field
                 # ...do some work...

        super(MyModel, self).save(*args, **kwargs) 
```

# collections - 从 .Net 集合中的值获取键

> ID：867126
> 
> 赞同：2
> 
> 时间：2009-05-15T05:46:13.613
> 
> 标签：collections, .net-2.0, dictionary

我正在使用 StringDictionary 来存储键值对。我需要交替使用键和值，即我应该能够从值中获取键，因为在我的情况下，值将是不同的。

有没有直接的方法可以做到（不循环）？或者，如果我可以使用任何其他集合来实现这一目标？

目前我正在循环：

```
public String GetKeyFromValue(string value)
        {
            foreach (KeyValuePair<string, string> kvp in instance)
            { 
                if (String.Equals(kvp.Value, value))
                    return kvp.Key;
            }

            throw new Exception ("Key not found in FilterControlMapping");
        } 
```

任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T06:03:12.793

您基本上需要使用封装成一个的两个字典。

在其他 Stack Overflow 问题中，[这里](https://stackoverflow.com/questions/255341/getting-key-of-value-of-a-generic-dictionary/255630#255630)和[这里](https://stackoverflow.com/questions/268321/bidirectional-1-to-1-dictionary-in-c/268545#268545)已经有实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T06:00:06.670

我能想到的唯一方法是两本词典。

D1 <键，值> D2 <值，键>

你会重复你的数据。但是您可以通过这种方式同时搜索键和值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:00:13.317

这也可以使用字典：

```
Dictionary<string, string> sd = new Dictionary<string, string>();
string sKey = sd.Single(kvp => kvp.Value.Equals("A value")).Key; 
```

请注意，如果值多次出现，Single 方法将抛出。您可以使用 First 甚至 FirstOrDefault。

编辑：正如 Jon Skeet 评论的那样，这仍在循环中。他发布到链接字典的链接提供了解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T06:06:44.783

最好的想法是使用 Dictionary 而不是 StringDictionary 作为其过时的......你可以在这里找到更多关于这个： [StringDictionary vs Dictionary<string, string>](https://stackoverflow.com/questions/627716/stringdictionary-vs-dictionarystring-string/627733#627733) 关于检索你应该在内部使用 linq 它正在使用循环，但它仍然是更清洁的方式..

# windows - 是否可以通过编程方式禁用 Windows 上的 Caps Lock 键？

> ID：867130
> 
> 赞同：4
> 
> 时间：2009-05-15T05:47:44.280
> 
> 标签：windows, keyboard, capslock

Caps Lock 键让我发疯——我从不故意使用它，但有时会不小心按下它而不是 TAB。我目前的解决方案是用螺丝刀卸下按钮（没有损坏，如果需要可以放回去）。

有没有办法在 Windows 上以编程方式禁用 Caps Lock 键 - 用键盘钩子或类似的东西编写程序？我从哪说起呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-01-03T21:59:59.740

为了在 Windows 2000 或 Windows XP 机器上重新映射 Caps lock（不安装软件），我调整了[如何将 AltGr 键全局映射到 Alt 键？](https://stackoverflow.com/questions/229633/how-to-globally-map-altgr-key-to-alt-key)如下。将 Caps 映射到 null 是示例之一，但您可以像我一样选择另一个键来映射。要将 caps 映射到 null，注册表文件是：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"Scancode Map"=hex:00,00,00,00, 00,00,00,00, 02,00,00,00, 1d,00,00,00, 00,00,00,00 
```

将此保存为 filename.reg 并执行，然后重新启动（或注销并重新登录）。

我基于 Tomas Sedovic 的该页面和Ronald Blaschke 推荐的[Scan Code Mapper for Windows的答案。](http://www.microsoft.com/whdc/archive/w2kscan-map.mspx)我介绍了空格，让我/你可以看到字节是如何组合成单词的。

请注意，我实际上使用它来将 Caps 映射到 Ctrl 并且我的倒数第二组数字是“1d,00,3a,00”，我确认这可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T02:08:40.620

问题[如何制作自定义键盘布局？](https://stackoverflow.com/questions/826986/how-to-make-a-custom-keyboard-layout/837747#837747)介绍如何更改 Caps Lock 键的功能。

# c++ - 如何在c中找到两次之间的差异？

> ID：867135
> 
> 赞同：4
> 
> 时间：2009-05-15T05:49:37.367
> 
> 标签：c++, c

我的第一次是下午 12:10:20，第二次是同一天的上午 7:10:20 我如何才能找到它们的黑白差异？

我的想法是将所有时间转换为秒，然后再次找到差异转换为时间

是不是很好 Approch r 还有什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T06:05:49.277

你想要这个[`difftime`](http://linux.die.net/man/3/difftime)功能。

**编辑**

如果您没有`difftime`可用的数据，我建议您将您所处的任何格式转换为纪元的秒数​​，进行计算并转换回您需要的任何格式。以下一组函数可以帮助您完成所有这些转换：

[asctime, ctime, gmtime, localtime, mktime, asctime_r, ctime_r, gmtime_r, localtime_r - 将日期和时间转换为故障时间或 ASCII](http://linux.die.net/man/3/localtime)

[timegm, timelocal - gmtime 和 localtime 的倒数（可能并非在所有系统上都可用）](http://linux.die.net/man/3/timelocal)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T06:23:47.923

不一定是最好的方法，但如果你想使用系统上可用的东西，difftime() 和 mktime() 可以帮助 -

```
#include <time.h>

tm Time1 = { 0 };  // Make sure everything is initialized to start with.
/* 12:10:20 */
Time1.tm_hour = 12;
Time1.tm_min = 10;
Time1.tm_sec = 20;

/* Give the function a sane date to work with (01/01/2000, here). */
Time1.tm_mday = 1;
Time1.tm_mon = 0;
Time1.tm_year = 100;

tm Time2 = Time1;  // Base Time2 on Time1, to get the same date...
/* 07:10:20 */
Time2.tm_hour = 7;
Time2.tm_min = 10;
Time2.tm_sec = 20;

/* Convert to time_t. */
time_t TimeT1 = mktime( &Time1 );
time_t TimeT2 = mktime( &Time2 );

/* Use difftime() to find the difference, in seconds. */
double Diff = difftime( TimeT1, TimeT2 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T12:23:44.783

你的方法听起来很明智。

更进一步，您可以转换为通用时间格式，例如[Unix time](http://en.wikipedia.org/wiki/Unix_epoch)，然后获取差异。

# c# - 在桌面上拖动 WPF 窗体

> ID：867140
> 
> 赞同：16
> 
> 时间：2009-05-15T05:51:17.410
> 
> 标签：c#, wpf, forms, window, drag

我正在尝试制作 ac# WPF 表单，我可以通过单击它并用鼠标移动来在屏幕上拖动它。表格的特点包括完全透明并且只包含一个图像。这就是说窗口样式是none，它不会显示在任务栏中。所以本质上，当应用程序运行时你能看到的只是一个小图像——理想情况下，如果我单击并按住鼠标左键并移动它，我希望能够在桌面上拖动它。

有谁知道我可以做到这一点的简单方法，还是我忽略了内置功能？

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-08-10T17:47:17.033

以前的答案命中了答案，但完整的例子是这样的：

```
 private void Window_MouseDown(object sender, MouseButtonEventArgs e)
    {
        if (e.LeftButton == MouseButtonState.Pressed)
        {
            DragMove();
        }
    } 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-15T05:57:15.040

您可以在窗口的鼠标按下事件中使用 Window.DragMove 方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-19T19:53:35.033

下面是一些简化的代码，用于在屏幕上拖动 WPF 表单。您可能已经在不同的帖子中看到了其中的一些代码，我只是对其进行了修改以适应拖动 WPF 表单的需要。

请记住，我们需要在 MouseLeftButtonDown 上获取表单位置，这样当我们在屏幕上拖动鼠标指针时，我们可以将鼠标指针定位在表单上的同一位置。

您还需要添加以下引用以获取鼠标相对于屏幕的位置：System.Windows.Forms

所需属性：

```
private bool _IsDragInProgress { get; set; }
private System.Windows.Point _FormMousePosition {get;set;} 
```

代码：

```
 protected override void OnMouseLeftButtonDown(MouseButtonEventArgs e)
        {
            this._IsDragInProgress = true;
            this.CaptureMouse();
            this._FormMousePosition = e.GetPosition((UIElement)this);
            base.OnMouseLeftButtonDown(e);
        }

        protected override void OnMouseMove(MouseEventArgs e)
        {
            if (!this._IsDragInProgress)
                return;

            System.Drawing.Point screenPos = (System.Drawing.Point)System.Windows.Forms.Cursor.Position;
            double top = (double)screenPos.Y - (double)this._FormMousePosition.Y;
            double left = (double)screenPos.X - (double)this._FormMousePosition.X;
            this.SetValue(MainWindow.TopProperty, top);
            this.SetValue(MainWindow.LeftProperty, left);
            base.OnMouseMove(e);
        }

        protected override void OnMouseLeftButtonUp(MouseButtonEventArgs e)
        {
            this._IsDragInProgress = false;
            this.ReleaseMouseCapture();
            base.OnMouseLeftButtonUp(e);
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-26T15:34:03.033

如果你和我一样，想要对 DoDragMove() 有更多的控制 - 说，让窗口始终保持在当前桌面的边界，我已经做到了。

用法：

```
public partial class MainWindow : Window
{
    private WindowsDragger _dragger;

    public MainWindow()
    {
        InitializeComponent();
        _dragger = new WindowsDragger(this);
    }
} 
```

助手类：

```
class WindowsDragger
{
    private readonly Window _window;
    private Point _dragDelta;

    public WindowsDragger(Window window)
    {
        _window = window;

        _window.MouseLeftButtonDown += MouseLeftButtonDown;
        _window.MouseLeftButtonUp += MouseLeftButtonUp;
        _window.MouseMove += MouseMove;
    }

    void MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        _dragDelta = e.GetPosition(_window);
        Mouse.Capture(_window);
    }

    void MouseMove(object sender, MouseEventArgs e)
    {
        if (Equals(_window, Mouse.Captured))
        {
            var pos = _window.PointToScreen(e.GetPosition(_window));
            var verifiedPos = CoerceWindowBound(pos - _dragDelta);
            _window.Left = verifiedPos.X;
            _window.Top = verifiedPos.Y;
        }
    }

    void MouseLeftButtonUp(object sender, MouseButtonEventArgs e)
    {
        if (Equals(_window, Mouse.Captured))
            Mouse.Capture(null);
    }

    private Vector CoerceWindowBound(Vector newPoint)
    {
        // Snap to the current desktop border
        var screen = WpfScreen.GetScreenFrom(_window);
        var wa = screen.WorkingArea;
        if (newPoint.X < wa.Top) newPoint.X = wa.Top;
        if (newPoint.Y < wa.Left) newPoint.Y = wa.Left;
        if (_window.Width + newPoint.X > wa.Right) newPoint.X = wa.Right - _window.Width;
        if (_window.Height + newPoint.Y > wa.Bottom) newPoint.Y = wa.Bottom - _window.Height;
        return newPoint;
    }
} 
```

WpfScreen 来自这里：[如何在 WPF 中获取当前屏幕的大小？](https://stackoverflow.com/questions/1927540/how-to-get-the-size-of-the-current-screen-in-wpf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-30T12:53:09.533

在窗口加载或网格加载事件上，您可以使用委托来触发 DragMove() 函数。

`private void Grid_Loaded(object sender, RoutedEventArgs e) {

```
 this.MouseDown += delegate{DragMove();};

    }` 
```

# javascript - 带有两个验证消息的 jquery 表单验证

> ID：867144
> 
> 赞同：0
> 
> 时间：2009-05-15T05:52:03.040
> 
> 标签：javascript, jquery, forms, jquery-plugins

通过使用 jQuery，客户端[表单验证变得最简单。](http://docs.jquery.com/Plugins/Validation)

我尝试了所有验证器，它们非常简单！

但在日期、数字和范围验证器中；我需要依次添加两个验证器

1) 必填 2) 日期

有可能吗？

另一个常见的要求是**重置表单字段**。是否可以在不编写太多代码的情况下使用 jQuery？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:02:07.570

[您可以一次添加许多规则](http://docs.jquery.com/Plugins/Validation/rules#.22add.22rules)。

至于重置表单，Javascript 中有一个内置的方法：

```
$('#myform')[0].reset(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T06:07:54.077

使用两个验证器应该不是问题。你有错误吗？

在此处使用 jQuery 表单插件：http: [//www.malsup.com/jquery/form/#api](http://www.malsup.com/jquery/form/#api)用于重置功能。

# html - AJAX 响应：数据（JSON、XML）还是 HTML 片段？

> ID：867163
> 
> 赞同：12
> 
> 时间：2009-05-15T06:00:38.587
> 
> 标签：html, xml, ajax, json, client-server

我只是想知道 AJAX 响应的“理想”输出格式是什么？使用某些客户端 JavaScript 模板引擎将纯数据（JSON、XML）渲染到页面中？还是“按原样”呈现到页面中的 HTML 片段？

你的偏好是什么，为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-15T07:29:47.907

在大多数情况下，您只需要发送 JSON（或适当的 XML，我以 JSON 为例）。

*   如果您要发送股票报价等数据，请使用 JSON。
*   如果您想保持网络层非常精简，请发送纯 JSON 数据并让客户端完成添加标记的繁重工作。
*   如果客户端页面是持久的，则发送 JSON。然后客户端可以向 Person.Name 发送问候。它可以刷新 Person.Score 或显示一个表单来编辑 Person.Status，所有这些都只处理一个 Person 对象。
*   如果您要公开 Web API，显然使用 JSON，以便客户端可以用它做任何他们想做的事情。

话虽如此，我真的不喜欢从 JavaScript 生成 HTML。这是一场维护噩梦，我根本不喜欢将两者混为一谈。那么，如果您发送的只是 JSON，如何避免在 JavaScript 中生成 HTML？如果你正在处理 Person(s) 对象，当你第一次渲染页面时，你会这样渲染它：

```
...
<div class="person display">
    <div class="name"></div>
    <div class="status"></div>
    <div class="score"></div>
</div>
... 
```

当您通过 AJAX 获取人员数据时，只需填充上述 DOM 结构。

如果您希望显示多个 Person 的信息，则不应直接填充 DOM 结构，您应该克隆它然后填充它。这样您的模板将保持完整，您可以重复使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T07:38:13.313

这在很大程度上取决于**将要使用的数据**：

## 用于混搭和 Web 服务

对于将在您的应用程序和外部使用的数据，永远不要使用 HTML：难以解析，难以使其适合其他结构。

如果它是关于少量数据的，比如为小部件更新的一些数据，请使用 JSON，因为它快速且易于使用。

如果它可以是大量数据，例如搜索查询的结果，请使用 XML，因为它对于大数据分析更加灵活。

## 仅限内部使用

不要费心使用纯 XML。无论如何，批量分析总是在输出之前完成。

大多数时候，您会想要使用 JSON，因为它比 HTML 更灵活，而且部署起来相当快。

如果您知道以后不需要处理数据并且布局很复杂，请使用 HTML。在服务器端编写复杂的 HTML 比使用 DOM 容易得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T06:05:43.770

如果您要返回大量 HTML，最好将它们放在服务器端并简单地将其加载到页面中。

如果您要返回类似一堆键值对来更新 a `<select>`with 或类似的东西，最好将其作为 JSON 返回并在客户端构建 HTML。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T06:45:23.003

对我来说没有“理想”的方式。当我需要分页并且我已经有了模板客户端时，使用纯 JSON 和 jTemplates 使用 jQuery 进行客户端渲染。

当我必须实现对服务器的简单调用时也使用 JSON：自动完成、就地编辑、保存草稿等。

当我需要一个分支新页面片段时，我使用 HTML 渲染：加载模板、向页面添加窗格、渲染自定义控件。

顺便说一句，我什么时候可以更喜欢 json，因为我们可以切换到客户端对象操作，而不仅仅是拥有一个“更新面板”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T07:25:22.753

这取决于情况，我更喜欢向客户端发送数据，并使用客户端框架更新页面，因为我有一个可用的。如果我是自己写的，而且代码片段足够小，我可能会在服务器端做，保持 js 尽可能苗条。

# c# - c#中对对象列表进行排序的算法

> ID：867164
> 
> 赞同：1
> 
> 时间：2009-05-15T06:01:00.177
> 
> 标签：c#, .net, algorithm

我有一个我希望在 C#.Net 3.5 中排序的对象列表，对象如下

编号 | 姓名 | parent_id

1 | 超人 | 空值

2 | 蝙蝠侠 | 3

3 | 守望者 | 1

4 | 金刚狼 | 2

我知道你们中的一些人可能会觉得这很容易，但我需要根据 parent_id 对列表进行排序，它指向同一个表中自己的索引（id）。

那么有人可以给我一个很好的算法来对这个列表进行排序而不会一遍又一遍地循环吗？我真的不能说得那么好，因此我似乎无法在谷歌上搜索到我想要的正确结果。

IEnumerable 或 DataTable 解决方案的集合会很棒。

提前致谢。

编辑：----------------新示例

编号 | 姓名 | parent_id

1 | 顶级儿童 | 空值

2 | 孩子 C | 3

3 | 孩子 B | 4

4 | 孩子A | 1

----> 我想要的输出是

编号 | 姓名 | parent_id

1 | 顶级儿童 | 空值

4 | 孩子A | 1

3 | 孩子 B | 4

2 | 孩子 C | 3

----> 如果我使用 OrderBy 或 Sort，我得到的结果是

编号 | 姓名 | parent_id

1 | 顶级儿童 | 空值

4 | 孩子A | 1

2 | 孩子 C | 3

3 | 孩子 B | 4

--> 不是我真正想要的解决方案，再次抱歉，不清楚

希望这个例子更清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T06:18:32.007

您可以为上述数据创建一个类，其中 id、name、parent_id 作为类成员。覆盖 IComparable 的 CompareTo 方法

```
 public class Person : IComparable<Person>
        {
            public int id, parentID;
            public string name;

            public Person(int id, string name, int parentID)
            {
                this.id = id;
                this.name = name;
                this.parentID = parentID;
            }

            #region IComparable Members

            public int CompareTo(Person obj)
        {
        return this.parentID.CompareTo(obj.parentID);

        //OR 
        //if (this.parentID > obj.parentID)
        //{
        //    return 1;
        //}
        //else if (this.parentID < obj.parentID)
        //{
        //    return -1;
        //}

        //return 0;
        }        
            #endregion
        } 
```

在主代码中：

```
List<Person> peopleArray = new List<Person>();
            peopleArray.Add(new Person(1, "Jerry", 1));
        peopleArray.Add(new Person(2, "George", 4));
        peopleArray.Add(new Person(3, "Elaine", 3));
        peopleArray.Add(new Person(4, "Kramer", 2));    
            peopleArray.Sort();

            foreach (Person p in peopleArray)
                Console.WriteLine(p.parentID); 
```

这将按父 id 的父 id O/P 对列表进行排序：1 2 3 4

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T06:28:08.600

编辑后：我想我明白了，比较器看起来像：

```
public Int32 CompareTo(SuperHero right)
{
    if (this.ID == right.ID)
        return 0;

    return this.ParentID.CompareTo(right.ID);
} 
```

回应您的评论：

该类看起来像：

```
public class SuperHero : IComparable<SuperHero>
{
    public Int32 ID { get; set; }
    public String Name { get; set; }
    public Int32 ParentID { get; set; }

    public SuperHero(Int32 id, String name, Int32 pid)
    {
        this.ID = id;
        this.Name = name;
        this.ParentID = pid;
    }

    public Int32 CompareTo(SuperHero right)
    {
        if (this.ID == right.ID)
            return 0;

        return this.ParentID.CompareTo(right.ID);
    }

    public override string ToString()
    {
        return this.Name;
    }
} 
```

并使用它：

```
static void Main(string[] args)
{
    // create your list
    List<SuperHero> heroes = new List<SuperHero>();

    // populate it
    heroes.Add(new SuperHero(1, "Superman", 0));
    heroes.Add(new SuperHero(2, "Batman", 3));
    heroes.Add(new SuperHero(3, "Watchman", 1));
    heroes.Add(new SuperHero(4, "Wolverine", 2));

    foreach (SuperHero hero in heroes)
        Console.WriteLine(hero.ToString());
    Console.WriteLine();

    // sort it
    heroes.Sort();

    foreach (SuperHero hero in heroes)
        Console.WriteLine(hero.ToString());

    Console.ReadKey();
} 
```

.NET 排序 (QuickSort) 将使用您的比较器对列表进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T06:07:22.673

简单的方法：

```
using System.Linq;
...
var sorted = unsorted.OrderBy(x=>x.parent_id); 
```

更复杂/可重用的方式：

在 .NET 中，您只需替换一个方法即可使用现有的排序工具（如 Array.Sort、List.Sort、LINQ 的 OrderBy 等）。您需要实现一个比较器（通过创建一个实现 IComparer 的对象、在被比较的对象上实现 IComparable 或使用一个比较委托。）

比较器的所有工作就是确定给定对象是否大于或小于另一个对象。只要您这样做并遵循一些基本规则（即，如果 X 大于 Y，则 Y 必须小于 X），那么排序将快速而轻松。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T06:10:06.693

如果在对象中实现 IComparable，则可以在 Array 或 ArrayList 集合上使用 .Sort 方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T06:20:30.803

我猜你希望 NULL parentId 是第一个，然后是它的孩子。
如果是这样，您可以使用 linq 在列表中调用 OrderBy。

`OrderBy(x => Convert.ToInt32(x.ParentId == null ? "0" : x.ParentId));`

我假设 ParentId 是一个字符串（如果它是一个 int 则它不能为 null）。
并假设该列表不会有 Id = 0。

编辑：这将按以下顺序打印项目
超人
守望者
金刚狼
蝙蝠侠

# mysql - MySQL关于重复键更新

> ID：867166
> 
> 赞同：9
> 
> 时间：2009-05-15T06:01:33.327
> 
> 标签：mysql, duplicates

如果我有这样的查询，我如何引用我已经在更新语句中给出的值，这样我就不需要插入相同的数据来再次查询？示例 我想用“xxx”更新 col1 的值，但现在我需要在重复语句中再次输入“xxx”。反正有没有在重复声明中引用这些值？

```
INSERT INTO TABLENAME(col1, col2) 
VALUES (’xxx’, ‘yyy’) 
ON DUPLICATE KEY UPDATE col1 = ‘zzz’ 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-02-03T16:42:16.867

这应该可以工作并且更优雅一点：

```
INSERT INTO TABLENAME(col1, col2) 
VALUES ('xxx', 'yyy') 
ON DUPLICATE KEY UPDATE col1 = VALUES(col1) 
```

请注意，您不需要更新行的主键部分。我们知道这是一样的，因为发生了碰撞。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T13:49:34.890

在 PHP 中，我这样做是为了解决问题：

```
$fields = "a = 1, b = 2, c = 3";
$sql = "INSERT INTO some_table SET id = $id, $fields ON DUPLICATE KEY UPDATE $fields";
mysql_query($sql); 
```

# c# - 从 httprequest C# 读取客户端证书

> ID：867171
> 
> 赞同：11
> 
> 时间：2009-05-15T06:02:42.437
> 
> 标签：c#, asp.net, security, x509certificate2

我正在尝试使用 Request.ClientCertificate 读取 X509 证书，但没有返回任何内容。证书肯定附加到请求中，因为我可以从发送请求的页面获取证书信息。

我曾尝试从几个不同的地方阅读证书，但似乎无法让它发挥作用。

我从[这篇知识库文章](http://support.microsoft.com/kb/895971)中的代码开始。在请求的页面中，我尝试打印出有关证书的一些信息，但响应中没有返回任何内容。

这是在 IIS 5.1 上运行的，并且通过 SSL 进行通信。这必须使用 .Net 框架的第 2 版来完成

为什么证书似乎消失了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-09-04T05:57:19.573

不久前，我写了一个识别网页，用于查找客户端证书，如果找到，将显示证书信息。我相信这就是您正在寻找的......这是页面：

```
<%@ Page Language="C#" Trace="false" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<%@ Import Namespace="System.Security.Cryptography.X509Certificates" %>
<%@ Import Namespace="System.Security.Cryptography" %>

<script runat="server">
    //protected void Page_Load(object sender, EventArgs e)
    //{ }

    void LoadCertInfo()
    {
        string para = "<div style='margin: 10px 0 0 0; font-weight: bold'>{0}</div>";
        string subpara = "<div style='margin-left: 15px; font-size: 90%'>{0}</div>";

        if (Page.Request.ClientCertificate.IsPresent)
        {
            Response.Write("<hr /><div style='width: 500px; margin: 20px auto'>");
            Response.Write("<h3 style='width: 500px; margin: 20px auto'>Client Certificate Information</h3>");
            try
            {
                X509Certificate2 x509Cert2 = new X509Certificate2(Page.Request.ClientCertificate.Certificate);

                Response.Write(string.Format(para, "Issued To:"));
                Response.Write(string.Format(subpara, x509Cert2.Subject));

                Response.Write(string.Format(para, "Issued By:"));
                Response.Write(string.Format(subpara, x509Cert2.Issuer));

                Response.Write(string.Format(para, "Friendly Name:"));
                Response.Write(string.Format(subpara, string.IsNullOrEmpty(x509Cert2.FriendlyName) ? "(None Specified)" : x509Cert2.FriendlyName));

                Response.Write(string.Format(para, "Valid Dates:"));
                Response.Write(string.Format(subpara, "From: " + x509Cert2.GetEffectiveDateString()));
                Response.Write(string.Format(subpara, "To: " + x509Cert2.GetExpirationDateString()));

                Response.Write(string.Format(para, "Thumbprint:"));
                Response.Write(string.Format(subpara, x509Cert2.Thumbprint));

                //Response.Write(string.Format(para, "Public Key:"));
                //Response.Write(string.Format(subpara, x509Cert2.GetPublicKeyString()));

                #region EKU Section - Retrieve EKU info and write out each OID
                X509EnhancedKeyUsageExtension ekuExtension = (X509EnhancedKeyUsageExtension)x509Cert2.Extensions["Enhanced Key Usage"];
                if (ekuExtension != null)
                {
                    Response.Write(string.Format(para, "Enhanced Key Usages (" + ekuExtension.EnhancedKeyUsages.Count.ToString() + " found)"));

                    OidCollection ekuOids = ekuExtension.EnhancedKeyUsages;
                    foreach (Oid ekuOid in ekuOids)
                        Response.Write(string.Format(subpara, ekuOid.FriendlyName + " (OID: " + ekuOid.Value + ")"));
                }
                else
                {
                    Response.Write(string.Format(para, "No EKU Section Data"));
                }
                #endregion // EKU Section

                #region Subject Alternative Name Section
                X509Extension sanExtension = (X509Extension)x509Cert2.Extensions["Subject Alternative Name"];
                if (sanExtension != null)
                {
                    Response.Write(string.Format(para, "Subject Alternative Name:"));
                    Response.Write(string.Format(subpara, sanExtension.Format(true)));
                }
                else
                {
                    Response.Write(string.Format(para, "No Subject Alternative Name Data"));
                }

                #endregion // Subject Alternative Name Section

                #region Certificate Policies Section
                X509Extension policyExtension = (X509Extension)x509Cert2.Extensions["Certificate Policies"];
                if (policyExtension != null)
                        {
                            Response.Write(string.Format(para, "Certificate Policies:"));
                            Response.Write(string.Format(subpara, policyExtension.Format(true)));
                        }
                        else
                        {
                            Response.Write(string.Format(para, "No Certificate Policies Data"));
                        }
                #endregion //Certificate Policies Section

                // Example on how to enumerate all extensions
                //foreach (X509Extension extension in x509Cert2.Extensions)
                //    Response.Write(string.Format(para, extension.Oid.FriendlyName + "(" + extension.Oid.Value + ")"));
            }
            catch (Exception ex)
            {
                Response.Write(string.Format(para, "An error occured:"));
                Response.Write(string.Format(subpara, ex.Message));
                Response.Write(string.Format(subpara, ex.StackTrace));
            }
            finally
            {
                Response.Write("</div>");
            }
        }
    }
</script>
<html>
  <head runat="server">
    <title><% Page.Response.Write(System.Environment.MachineName); %></title>
  </head>
  <body>
      <% LoadCertInfo();  %>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-11T01:07:13.103

我不确定您需要客户端证书的用途，但如果您将其用于您自己的自定义身份验证或授权，您可能需要考虑使用 Web 服务器的安全基础架构，而不是实现自己的。例如，您可以将 IIS 配置为需要客户端证书，将证书映射到用户帐户，并使用基于 Windows 的身份验证。当然，这不一定适用于您的问题域。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T08:47:56.390

好的，这并不完全清楚，但是您有一个网站要求客户使用证书进行身份验证？因为这就是`Request.ClientCertificate`房产的用途。

我这样说是因为你的问题有些奇怪。

*“我可以从发送请求的页面获取证书信息。”*

页面通常不会真正发送客户端所做的请求。

要获得服务器证书，您可以打开 X509Store 并筛选证书以找到您需要的 CN。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-14T14:45:48.660

您必须将本地 IIS 配置为接受（或要求）客户端证书。

# python - python中的数据库连接

> ID：867175
> 
> 赞同：0
> 
> 时间：2009-05-15T06:03:32.607
> 
> 标签：python, tcp, database-connection

我正在用 python 编写代码，在其中建立了与数据库的连接。我有一个循环的查询。在循环中执行查询时，如果我拔下网络电缆，它应该停止并出现异常。但这不会发生，当我在 2 分钟后再次插入网络电缆时，它会从结束的地方重新开始。我正在使用 linux 和 psycopg2。它没有显示异常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T06:11:53.147

您的数据库连接几乎肯定会基于 TCP 套接字。TCP 套接字将在失败和（在 python 中）引发异常之前重试很长时间。更不用说在数据库层重试/自动重新连接尝试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T06:18:49.683

正如道格拉斯的回答所说，它不会因 TCP 而引发异常。

您可以尝试使用 socket.setdefaulttimeout() 来设置更短的超时值。

> 设置默认超时（...）
> 
> ```
>  setdefaulttimeout(timeout)
> 
>    Set the default timeout in floating seconds for new socket objects.
>    A value of None indicates that new socket objects have no timeout.
>    When the socket module is first imported, the default is None. 
> ```

但是，如果您的数据库连接不是由 python 套接字构建的，例如本机套接字，它可能无法工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T07:43:58.307

如果您想实现无论客户端库如何连接到服务器都有效的超时，最好在单独的线程中尝试 DB 操作，或者更好的是，在单独的进程中，“监视器”线程/进程可以杀死如果需要的话; 请参阅 Python 2.6 标准库中的多处理模块（如果需要，有 2.5 的反向移植版本）。一个进程更好，因为当它被杀死时，操作系统将负责释放和清理资源，而杀死一个线程总是一件非常不安全和混乱的事情。

# asp.net - 每 x 秒调用/启动 Windows 服务的最佳方式是什么？

> ID：867179
> 
> 赞同：1
> 
> 时间：2009-05-15T06:05:00.917
> 
> 标签：asp.net, windows-services, wcf

我有一个 Windows 服务，它基本上是访问邮箱并阅读电子邮件。我试图找出每 x 秒检查一次邮箱的最佳方法。

一种方法是只调用 Thread.Sleep，然后再次调用 Start 方法，例如

```
protected override void OnStart(string[] args)
{
    // get config settings
    CheckMailbox();
}

public void CheckMailbox()
{
    int x = 5000;

    // do stuff

    Thread.Sleep(x);
    CheckMailbox();
} 
```

不确定这是否是最好的方法。为了进一步探索这一点，我知道您可以通过 WCF 公开服务来调用 Windows 服务。在这种情况下，如果一个 Web 应用程序调用 Process 来启动，会有冲突的线程我正确吗？那我该如何处理呢？我每次都必须创建一个新线程并将其放入队列中吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T06:09:48.597

睡觉通常是个坏主意。除此之外，这意味着您不会快速响应 Stop 事件。

您应该使用`Timer`. 有两种适用于服务：

*   [System.Threading.Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)
*   [System.Timers.Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)

在每种情况下，您基本上都会在每次计时器“滴答”以及您希望它何时触发时说出您想要发生的事情。

我的线程教程有一[节解释了可用计时器之间的一些差异](http://pobox.com/~skeet/csharp/threads/timers.shtml)。

我不确定您的 WCF 问题，但我认为您的 Web 服务不会显式启动该服务 - 它只是通过 WCF 联系它。是的，您可能需要小心线程。您需要注意的确切内容取决于 WCF 服务所公开的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T06:34:24.357

基本 System.Threading.Timer 代码：

```
// Class level variable in the Windows Service:
private System.Threading.Timer timer;

// This is in the constructor for a Windows Service.
// interval would be the time in milliseconds in between ticks.
// 0 is how long until it should start.
timer = new Timer(new TimerCallback(TimerElapsed), null, 0, interval);

// The TimerCallback in the Windows Service:
private void TimerElapsed(object o)
{
    // Do email stuff here.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:10:36.723

如果您想让它作为服务运行（在后台，没有任何人登录），是的，这是一种方法。

另一种方法是有一个定时器，它每 5 秒左右调用一次它的“Tick”事件处理程序。

或者，如果您的检查不那么频繁，您还可以创建一个命令行控制台应用程序，并将其安排为 Windows 中的“计划任务”。

马克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T06:18:01.697

您的代码存在为每次调用添加到调用堆栈的问题，因为您从自身内部调用该方法。在某些时候你会得到一个堆栈溢出异常。一个等待是在“等待线程”上调用另一种方法，该方法将在一段时间后返回信号：

```
private void CheckMailBox()
{
    _waitHandle = new AutoResetEvent(true);
    while (_waitHandle.WaitOne())
    {
        // do the mail checking
        ((IDisposable)_waitHandle).Dispose();
        _waitHandle = new AutoResetEvent(false);
        ThreadPool.QueueUserWorkItem(WaitSomeTime, 2000);
    }

}

private void WaitSomeTime(object state)
{

    Thread.Sleep((int)state);
    _waitHandle.Set();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T06:42:39.937

除了使用计时器之外，可能的增强功能是在您的服务中使用调度组件。然后，您可以将您的服务设置为访问您邮箱的代码的主机。

[Quartz.NET](http://quartznet.sourceforge.net/)是一个可以做到这一点的开源调度组件。它允许您完全根据需要设置计划，并且非常易于使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T07:29:08.250

好的，虽然您的时间问题已经得到了很好的处理（我同意上述大部分内容），但我可以提供一些有关 WCF 的信息。WCF 服务只是托管在应用程序域中。该域可以是 Windows 窗体、控制台应用程序、ASP.net，在这种情况下，可以是 Windows 服务。

因此，从某种意义上说，您不是通过**WCF公开****Windows 服务**，而是更多地**将 WCF 服务托管在 Windows 服务**应用程序域中。我建议在转换到 Windows 服务之前在**Windows 窗体中测试您的服务（包括计时器对象）。**更容易调试和测试。

 ******托管的 WCF 服务实际上在其自己的线程中运行：

```
 serviceType_MyEmailer = typeof(MyEmailerServiceType);
    ServiceHost host_MyEmailer;

    host_MyEmailer = new ServiceHost(serviceType_MyEmailer); 
```

在线查找“DerivativesCalculatorService”示例。向您展示如何在代码中托管 WCF 服务。

这里的计时技巧在您的服务本身中。您可以将服务类创建为立即初始化的单例类，并在其初始化时启动其 Timer 对象（如其他答案所示）。

通过这种方式，您的 WCF 服务将拥有您的类的持久实例，其 Timer 对象会静默关闭。将所有这些都托管在 Windows 服务中，您就完成了。

希望这可以帮助。

# asp.net - 打开附件页面事件后在 asp.net 中不起作用

> ID：867187
> 
> 赞同：0
> 
> 时间：2009-05-15T06:06:36.903
> 
> 标签：asp.net, attachment

在页面上，我通过将 PostBackUrl 设置为单击打开链接按钮上的附件

```
lnkCalendar.PostBackUrl = "AddScheduleToCalendar.aspx?scheduleGuid=" + scheduleGuid; 
```

保存或关闭附件后，当前打开的网页按钮单击仍会再次打开相同的附件，但它们自己的单击事件不起作用。如果直到不单击附件链接按钮事件有效。AddScheduleToCalendar.aspx 页面加载方法的attachmnet 代码为

```
string calendarFormat = GetScheduleInfo();
            Response.ContentType = "text/calendar";
            Response.AppendHeader("content-disposition", "attachment; filename=MyCalendar.ics");
            Response.Write(calendarFormat);
            Response.End(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T06:12:19.247

当您回发打开附件时，您的页面生命周期将再次执行。

我最好的猜测是您在加载附件时没有分配 PostBackUrls。

提供有关如何加载这些附件的更多信息。

# java - Java ResultSet如何检查是否有任何结果

> ID：867194
> 
> 赞同：340
> 
> 时间：2009-05-15T06:08:57.553
> 
> 标签：java, jdbc

[结果集没有hasNext](http://java.sun.com/j2se/1.4.2/docs/api/java/sql/ResultSet.html)的方法。我想检查结果集是否有任何值

这是正确的方法吗

```
if (!resultSet.next() ) {
    System.out.println("no data");
} 
```

* * *

## 回答 #1

> 赞同：574
> 
> 时间：2011-07-25T09:01:27.663

假设您正在使用一个新返回`ResultSet`的光标指向第一行之前的光标，一个更简单的检查方法是调用`isBeforeFirst()`. 如果要读取数据，这避免了必须回溯。

[如文档中所述](https://docs.oracle.com/javase/9/docs/api/java/sql/ResultSet.html#isBeforeFirst--)，如果游标不在第一条记录之前，或者**ResultSet 中没有行，则**返回 false 。

```
if (!resultSet.isBeforeFirst() ) {    
    System.out.println("No data"); 
} 
```

* * *

## 回答 #2

> 赞同：260
> 
> 时间：2009-05-15T06:13:38.137

没错，最初`ResultSet`' 的光标指向第一行之前，如果第一次调用`next()`返回`false`，则`ResultSet`.

如果您使用此方法，您可能必须`beforeFirst()`立即调用以重置它，因为它现在已将自己定位到第一行之外。

然而，应该注意的是，下面[Seifer 的回答](https://stackoverflow.com/a/6813771/1030)是对这个问题的一个更优雅的解决方案。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-05-30T22:19:28.237

你总是可以先做下一个，然后做一个循环后检查

```
if (!resultSet.next() ) {
    System.out.println("no data");
} else {

    do {
     //statement(s)
    } while (resultSet.next());
} 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-04-01T20:01:17.640

为了完全确定结果集是否为空，无论光标位置如何，我都会这样做：

```
public static boolean isMyResultSetEmpty(ResultSet rs) throws SQLException {
    return (!rs.isBeforeFirst() && rs.getRow() == 0);
} 
```

如果 ResultSet 为空，此函数将返回 true，否则返回 false；如果 ResultSet 关闭/未初始化，则抛出 SQLException。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-05-15T06:16:12.403

你通常会做这样的事情：

```
while ( resultSet.next() ) { 
   // Read the next item
   resultSet.getString("columnName");
} 
```

如果要报告空集，请添加一个变量来计算读取的项目。如果您只需要阅读单个项目，那么您的代码就足够了。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-12-12T17:56:33.207

最好使用 ResultSet.next() 和 do {...} while() 语法。

“检查任何结果”调用 ResultSet.next() 将光标移动到第一行，因此使用 do {...} while() 语法来处理该行，同时继续处理循环返回的剩余行。

这样您就可以检查任何结果，同时还可以处理返回的任何结果。

```
if(resultSet.next()) { // Checks for any results and moves cursor to first row,
    do { // Use 'do...while' to process the first row, while continuing to process remaining rows

    } while (resultSet.next());
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-02-17T12:53:12.137

根据最可行的答案，建议是使用“isBeforeFirst()”。**如果您没有“仅转发类型”，这不是最好的解决方案**。

有一个名为“ [.first()](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#first()) ”的方法。获得完全相同的结果并不那么矫枉过正。您检查“结果集中”中是否有某些内容，并且不要前进光标。

文档指出：“(...) false 如果**结果集中没有行**”。

```
if(rs.first()){
    //do stuff      
} 
```

> 您也可以只调用 isBeforeFirst() 来测试是否有任何行返回而不推进游标，然后正常继续。– SnakeDoc 2014 年 9 月 2 日 19:00

但是，“isBeforeFirst()”和“first()”是有区别的。如果在“仅向前”类型的结果集上完成，首先会生成一个异常。

比较两个 throw 部分： http: [//docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#isBeforeFirst()](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#isBeforeFirst()) [http://docs.oracle.com/javase/7/docs /api/java/sql/ResultSet.html#first()](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#first())

好的，基本上这意味着您应该使用“isBeforeFirst”，只要您有“仅转发”类型。否则使用“first()”就不会那么矫枉过正了。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-15T06:20:21.987

如果您想查看结果集中是否有任何行，那将起作用。

请注意，`next()`总是移动到下一行，因此如果您打算从结果集中进行任何读取，则需要考虑到这一点。

ResultSet 的通常用法（简单阅读时）是：

```
while (resultSet.next())
{
   ... read from the row here ...
} 
```

`next()`如果您已经调用一次以检查结果集是否为空，这显然将无法正常工作，因此请注意这一点。尽管有一些“备份”方法，但并非所有类型的结果集都支持这些方法。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-03-22T21:02:48.597

我相信这是一篇实用且易于阅读的文章。

```
 if (res.next()) {
            do {

                // successfully in. do the right things.

            } while (res.next());
        } else {
           // no results back. warn the user.
        } 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-10-11T09:11:23.500

为什么不使用 rs.getRow()？

```
int getRow()
           throws SQLException
Retrieves the current row number. The first row is number 1, the second number 2, and so on.
Note:Support for the getRow method is optional for ResultSets with a result set type of TYPE_FORWARD_ONLY

Returns:
the current row number; 0 if there is no current row
Throws:
SQLException - if a database access error occurs or this method is called on a closed result set
SQLFeatureNotSupportedException - if the JDBC driver does not support this method
Since:
1.2 
```

对我来说，检查“如果（rs.getRow（）！= 0）”似乎工作得很好。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-06-23T13:32:25.603

```
if(resultSet.first) {

} else { 
    system.out.println("No raw or resultSet is empty");
} 
```

因为如果 ResultSet 没有 raw 则`resultSet.first`返回 false。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-10-04T19:32:58.773

```
if (!resultSet.isAfterLast() ) {    
System.out.println("No data"); 
} 
```

`isAfterLast()`空结果集也返回 false，但由于游标无论如何都在第一行之前，因此此方法似乎更清晰。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-02-11T04:44:58.213

```
ResultSet result = stmt.executeQuery(sqlQuery);
if (!result.next())
    status = "ERROR";
else
    status = "SUCCESS"; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-11-24T19:16:21.500

最好的办法是检查第一行，这样当您打算获取数据时，您可以避免跳过一行的错误。类似于： if (!resultSet.first() ) { System.out.println("no data"); }

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-09-02T13:50:21.703

通过使用 resultSet.next() 您可以轻松获得结果，无论 resultSet 是否包含任何值

```
ResultSet resultSet = preparedStatement.executeQuery();
if(resultSet.next())
 //resultSet contain some values
else
 // empty resultSet 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-04-04T22:53:05.603

我一直在尝试将当前行设置为第一个索引（处理主键）。我会建议

```
if(rs.absolute(1)){
    System.out.println("We have data");
} else {
    System.out.println("No data");
} 
```

填充 ResultSet 时，它指向第一行之前。将其设置为第一行（`rs.absolute(1)`由 我们可以将其推断为

```
for(int i=1; rs.absolute(i); i++){
    //Code
} 
```

它将当前行设置为位置 i 并且如果该行不存在将失败。这只是一种替代方法

```
while(rs.next()){
    //Code
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-02-20T02:05:24.733

我创建了以下方法来检查 ResultSet 是否为空。

```
public static boolean resultSetIsEmpty(ResultSet rs){        
    try {
        // We point the last row
        rs.last();
        int rsRows=rs.getRow(); // get last row number

        if (rsRows == 0) {
            return true;
        }

        // It is necessary to back to top the pointer, so we can see all rows in our ResultSet object.
        rs.beforeFirst();
        return false;
    }catch(SQLException ex){            
        return true;
    }
} 
```

有以下考虑非常重要：

**CallableStatement**对象必须设置为让 ResultSet 对象走到最后并返回顶部。

**TYPE_SCROLL_SENSITIVE** : ResultSet 对象可以在最后移动并返回顶部。进一步可以捕捉到最后的变化。

**CONCUR_READ_ONLY**：我们可以读取 ResultSet 对象数据，但不能更新。

```
CallableStatement proc = dbconex.prepareCall(select, ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_READ_ONLY); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-03-14T07:14:05.537

我认为检查结果集的最简单方法是通过**org.apache.commons.collections.CollectionUtils**包下的**CollectionUtils**

 **```
if(CollectionUtils.isNotEmpty(resultList)){
  /**
  * do some stuff
  */
} 
```

这将检查 null 以及空结果集条件。

有关更多详细信息，您可以参考以下文档。 [CollectionUtils](https://commons.apache.org/proper/commons-collections/javadocs/api-release/org/apache/commons/collections4/CollectionUtils.html)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-03-06T15:19:18.950

你可以做这样的事情

```
boolean found = false;

while ( resultSet.next() )
{
    found = true;
    resultSet.getString("column_name");
}

if (!found)
    System.out.println("No Data"); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-11-05T20:05:57.507

```
ResultSet rs = rs.executeQuery();
if(rs.next())
{
  rs = rs.executeQuery();
  while(rs.next())
  {
    //do code part
  }
}
else
{
  //else if no result set
} 
```

最好重新执行查询，因为当我们调用`if(rs.next()){....}`ResultSet 的第一行时，将执行它，在它内部之后，`while(rs.next()){....}`我们将从下一行获取结果。所以我认为在里面重新执行查询`if`是更好的选择。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-06-13T07:45:41.317

```
if (resultSet==null ) {
    System.out.println("no data");
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-08-13T14:30:35.443

**提醒一句，**

如果您使用的是[org.springframework.jdbc.core.RowMapper](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jdbc/core/RowMapper.html) ，请非常小心如何检查您的 ResultSet 是否为空，因为以下对于 mapRow 方法适用：

*此方法不应在 ResultSet 上调用 next()；它只应该映射当前行的值。* <-来自文档

在这种情况下，您的支票可能会变成类似的东西

```
resultSet.beforeFirst();
if (!resultSet.next() ) {
    System.out.println("no data");
} 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2014-05-20T16:41:41.553

最初，结果集对象 (rs) 指向 BFR（在第一条记录之前）。一旦我们使用 rs.next()，光标指向第一条记录并且 rs 保持“真”。使用 while 循环，您可以打印表的所有记录。检索到所有记录后，光标移动到 ALR（最后一条记录之后），并将其设置为空。让我们考虑表中有 2 条记录。

```
if(rs.next()==false){
    // there are no records found
    }    

while (rs.next()==true){
    // print all the records of the table
    } 
```

简而言之，我们也可以将条件写为 while (rs.next())。

# mysql - MySQL5.1用InnoDB有回滚次数上限吗？

> ID：867195
> 
> 赞同：0
> 
> 时间：2009-05-15T06:09:11.313
> 
> 标签：mysql

用MySQL5.1的InnoDB进行数据管理，对复数的表进行INSERT、UPDATE时使用事务。有时顺便提一下，但是当我在INSERT处理失败的事务开始时间点进行保护主义回滚时，会有多少数据数知道是否可以进行保护主义回滚的方法？

尽管如此我认为保护主义的倒退是几百件，几千件没有任何限制，但是我想抓住似乎仍然是一些目标的东西，并且认为我建议你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T09:27:19.530

这受`max_binlog_cache_size`变量限制。如果您更改的数据多于此，则会收到错误消息，并且事务将自动回滚。

实际上，在 64 位计算机上，您将用完 RAM 并在默认的 16PB 启动之前进行交换。

请参阅[http://dev.mysql.com/doc/refman/5.1/en/replication-options-binary-log.html#sysvar_max_binlog_cache_size](http://dev.mysql.com/doc/refman/5.1/en/replication-options-binary-log.html#sysvar_max_binlog_cache_size)

# c++ - 我们如何在编辑框中垂直对齐文本？

> ID：867207
> 
> 赞同：7
> 
> 时间：2009-05-15T06:14:26.543
> 
> 标签：c++, mfc

我创建了一个编辑框：

```
m_EditWnd.Create(m_hWnd, rect, NULL, ES_LEFT | ES_AUTOHSCROLL | WS_CHILD |
                                     WS_OVERLAPPED | WS_VISIBLE,
                 WS_EX_CLIENTEDGE | WS_EX_LEFT | WS_EX_LTRREADING); 
```

水平对齐有一种样式为 ES_CENTER 用于水平文本对齐，但是我们可以将文本垂直居中对齐吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-06-28T09:31:00.567

我没有足够的声誉发表评论，所以这里有一个非常古老的问题可能有用的片段！

如果您提供`WS_BORDER`样式，则文本会根据要求自动垂直居中。由于 OP 正在使用，因此*无论如何*`WS_EX_CLIENTEDGE`都会绘制边框，因此添加这种样式应该不是问题。

 *但是，`WS_BORDER | WS_EX_CLIENTEDGE`只能实现“部分”垂直居中。

使用`WS_BORDER | WS_EX_STATICEDGE`实现了正确的垂直居中，尽管显然我们的视觉风格与客户端边缘风格略有不同。对我来说，我可以忍受这个小小的权衡，而不是编写一个自定义编辑控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-03T01:59:32.927

我尝试了@Aidan Ryan 的解决方案，稍作调整以避免另一个与 UI 相关的问题。我将“SetWindowPos”移动到 OnNCPaint() 中并且只调用一次该函数。

# c# - 写入使用 AsciiEncoding.GetBytes 和 Convert.FromBase64String 解码的字节时 FileStream.Write 中的性能问题

> ID：867211
> 
> 赞同：4
> 
> 时间：2009-05-15T06:16:19.470
> 
> 标签：c#, .net, encoding, filestream, decoding

我在使用 FileStream.Write 函数时遇到了性能问题。

我有一个控制台应用程序，用于使用 StreamReader 对象从文件中读取 Base64 字符串（~ 大小为 400 KB）。我使用 Convert.FromBase64String 将此字符串转换为字节数组。然后我使用 FileStream 对象将此字节数组写入文件。这里得到的字节数组长度为 334991。

我测量了写入字节数组的时间——结果大约是**0.116 秒。**

只是为了好玩，我使用 ASCIIEncoding.GetBytes 函数从同一个 Base64 编码字符串中获取了字节数组（尽管我知道这不会给出正确的解码输出 - 我只是想尝试一下）。我使用 FileStream 对象将此字节数组写入文件。这里得到的字节数组长度为 458414。

我用这种方法测量了写入字节数组的时间——结果大约是**0.008 秒。**

这是示例代码：

```
class Program
{
    static void Main(string[] args)
    {
        Stopwatch stopWatch = new Stopwatch();
        TimeSpan executionTime;

        StreamReader sr = new StreamReader("foo.txt");
        string sampleString = sr.ReadToEnd();
        sr.Close();

        ////1\. Convert to bytes using Base64 Decoder (The real output!)
        //byte[] binaryData = Convert.FromBase64String(sampleString);

        //2\. Convert to bytes using AsciiEncoding (Just for Fun!)
        byte[] binaryData = new System.Text.ASCIIEncoding().GetBytes(sampleString);
        Console.WriteLine("Byte Length: " + binaryData.Length);

        stopWatch.Start();
        FileStream fs = new FileStream("bar.txt", FileMode.Create, FileAccess.Write);
        fs.Write(binaryData, 0, binaryData.Length);
        fs.Flush();
        fs.Close();
        stopWatch.Stop();

        executionTime = stopWatch.Elapsed;
        Console.WriteLine("FileStream Write - Total Execution Time: " + executionTime.TotalSeconds.ToString());
        Console.Read();
    }
} 
```

我对大约 5000 个包含 Base64 编码字符串的文件进行了测试，写入这两种类型的字节数组所需的时间差几乎是 10 倍（使用 **真实**解码写入字节数组的时间更长）。

使用 Convert.FromBase64String 获得的字节数组的长度小于使用 ASCIIEncoding.GetBytes 函数获得的长度。

我想知道我要做的就是使用 FileStream 对象写入一堆字节。那么，为什么在将字节数组写入磁盘时会有如此巨大的性能差异（所需时间）？

还是我做错了什么？请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T07:59:54.307

对于初学者， DateTime 的分辨率较低（iirc 0.018 s）。所以最好使用秒表类。

现在这并不能完全解释差异，但您可能会得到一些更好的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T08:00:48.470

我对另一个问题给出了一些类似的建议，请查看 MS Research 的[这些](https://stackoverflow.com/questions/166452/performance-of-system-io-readallxxx-writeallxxx-methods/867261#867261)工具和参考资料。

它们将帮助您解决任何潜在的 I/O 问题，或者至少了解它们。

此外，您应该注意 CLR [LARGE object heap](http://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/)周围的问题。特别是在使用数组时（超过 80kb 的任何东西都具有次优的托管堆交互，以防您在同一进程中运行 5000 次）。

但是，真的，再看一遍后，我认为这些与您的引理没有那么密切的关系。我在分析器中运行了这段代码，它只是显示了 Convert. *Base64*正在消耗您的所有周期。

其他一些事情，在您的测试代码中，您应该始终连续运行测试 2 次以上，抖动将有机会影响运行时负载。这可能会导致执行时间发生如此大的变化，这太神奇了。现在我认为你应该重新评估你的测试工具，尝试考虑抖动和可能的大对象堆效应。（将这些例程之一放在另一个前面......）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T08:19:28.270

我认为您的代码中的主要问题是您试图将卷心菜与胡萝卜进行比较（法语表达）：

Convert.FromBase64String 和 ASCIIEncoding().GetBytes 根本不做同样的事情。

只需尝试使用任何文本文件作为程序的输入，它会在 FromBase64 上失败，而使用 ASCIIEncoding 运行良好。

现在解释一下性能命中：

*   ASCIIEncoding().GetBytes 只是从文件中取出一个字符并将其转换为一个字节（这很简单：没有什么可做的）。例如，它会将“A”翻译成 0x41，将“Z”翻译成 0x5A……

*   对于 Convert.FromBase64String，这是另一回事。它实际上是将“base64 编码字符串”转换为字节数组。base64 字符串是 - 比方说 - 二进制数据的“可打印表示”。更好的是，它是二进制数据的“文本”表示，例如，可以通过 Internet 线路发送。邮件中的图像是 base64 编码的，因为邮件协议是基于文本的。因此将 base64 来回转换为字节的过程一点也不简单；因此会影响性能。

仅供参考，base64 字符串应如下所示：

SABlAGwAbABvAHcAIABXAG8AcgBsAGQAIQA=

翻译为“你好世界！” 不是即时的，不是吗？

以下是有关 base64 格式的一些信息：[http ://en.wikipedia.org/wiki/Base64](http://en.wikipedia.org/wiki/Base64)

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T08:12:45.417

您可能想查看 Jon Skeet 最近就该问题撰写的一系列文章（以及随附的源项目）

[这里](http://msmvps.com/blogs/jon_skeet/archive/2009/03/20/benchmarking-io-buffering-vs-streaming.aspx)和[这里](http://msmvps.com/blogs/jon_skeet/archive/2009/03/24/buffering-vs-streaming-benchmark-first-results.aspx)

具体来说，他比较了缓冲与流式传输，但也有不同文件大小和线程数的有趣结果。

# c++ - 将键值对数组发送到 COM 中的 API 的最佳方式

> ID：867214
> 
> 赞同：1
> 
> 时间：2009-05-15T06:16:48.627
> 
> 标签：c++, com

我想用 API 创建一个接口，它可以接受 COM 中的键值对数组。最好的方法是什么？我可以考虑发送 BSTR 的 SAFEARRAY 。每个 BSTR 都可以视为 key-value pair 。需要添加打包/解包键值的逻辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T07:43:30.167

您可以为键值对引入一个接口，并为此类对的集合引入另一个接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T07:38:21.800

我不会将 BSTR 用于非字符串用途——它可能会为您节省一纳秒，但最终会在您需要扩展或移植代码时出现问题。我只需使用 SAFEARRAY 变体，其键位于索引 0、2、4...，对应的值位于 1、3、5、...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-23T10:43:12.083

考虑`IPersistPropertyBag`执行此操作的标准方法。

考虑一个 OLE 属性集对象。

考虑接受`Scripting.Dictionary`对象，或者`ADODB.Record`如果您正在创建快速而肮脏的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T21:08:18.920

您需要定义“最佳”。COM 是——尽管它的设计者有最好的祝愿——一个非常多样化的平台。您期望与对象交互的客户端的性质（又名什么语言？）应该会严重影响您的选择。

只是两个简单的例子：

*   从分类 ASP 中调用？
    您唯一的工具是变体。好的——您正在使用 ATL：您唯一的工具是 BSTR 或 VARIANTS 的 SAFEARRAY。

*   从 C++ 调用？
    您可以使用自定义数据数组（阅读 [size_is]）。如果可能的话，甚至是固定大小的数组。双方都更容易。

还有其他考虑：

你在写客户端吗？然后你想让双方的事情变得更容易。

你只写对象吗？然后你可能想让客户端上的事情变得*最简单*，即使它在服务器上**最难***（为什么？因为你希望对方很高兴与你合作，尤其是在咨询或商业环境中——不要看起来懒惰！ )* .

另外，这是一次性物品吗？还是将来会在多种情况下使用？在前一种情况下，您可能会发现这真的无关紧要。在后者中，您将需要彻底考虑。

如果您发布有关您的情况的更多详细信息，我们可能会提供更具体的指导。

# gridview - 需要帮助使用 webaii 自动化 Extjs 网格

> ID：867215
> 
> 赞同：0
> 
> 时间：2009-05-15T06:16:51.637
> 
> 标签：gridview, automation, extjs, web-testing

我们广泛使用 webaii 作为我们的功能自动化工具并取得了巨大成功，但我们现在面临使用 webaii 自动化 extjs 网格类型的问题。任何在 webaii 或 watin 或 watir 中克服了这个问题的人都可以就此提供意见吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T01:03:33.303

查看 Ext.ux.Autogrid
[http://extjs.com/forum/showthread.php?t=10951](http://extjs.com/forum/showthread.php?t=10951)

# regex - 非连续字符的正则表达式

> ID：867217
> 
> 赞同：0
> 
> 时间：2009-05-15T06:17:36.580
> 
> 标签：regex

如果一种语言仅由集合 { *a* , *b* , *c* } 组成，我们如何才能为没有两个连续字符出现的语言构造正则表达式。

例如：*abcbcabc*将是有效的，而*aabbcc*将被正则表达式拒绝。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T06:47:36.307

此正则表达式匹配*abcbcabc*但不匹配*aabbcc*

```
// (?:(\w)(?!\1))+
// 
// Match the regular expression below «(?:(\w)(?!\1))+»
//    Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
//    Match the regular expression below and capture its match into backreference number 1 «(\w)»
//       Match a single character that is a “word character” (letters, digits, etc.) «\w»
//    Assert that it is impossible to match the regex below starting at this position (negative lookahead) «(?!\1)»
//       Match the same text as most recently matched by capturing group number 1 «\1» 
```

* * *

**编辑**

正如评论中所解释的，字符串边界**确实很**重要。然后正则表达式变为

```
\m(?:(\w)(?!\1))+\M 
```

向秋葵致敬。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T07:09:12.277

我们不能保持简单吗？只是“如果不是”这个正则表达式：

```
/(aa|bb|cc)/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T06:22:13.153

假设“ `()`”是一个分组符号，“ `a|b`”代表`a` *逻辑或* `b`，那么，在伪代码中

```
if regexp('/(aa)|(bb)|(cc)/', string) == MATCH_FOUND
  fail;
else
  succeed; 
```

[正如Gumbo](https://stackoverflow.com/users/53114/gumbo)所说，可能不需要分组。我把它们放在那里只是为了安全和清晰。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T06:25:36.063

您必须将输入与这样的内容进行匹配（以您想要的任何方式编码），如果您发现巧合，那么它就是您想要的语言：

```
[^{aa}|{bb}|{cc}] 
```

# python - Python 类成员初始化

> ID：867219
> 
> 赞同：46
> 
> 时间：2009-05-15T06:17:50.217
> 
> 标签：python, class, initialization

我最近刚刚与 Python 中的一个错误作斗争。这是那些愚蠢的新手错误之一，但它让我想到了 Python 的机制（我是一名长期 C++ 程序员，对 Python 不熟悉）。我将列出错误代码并解释我做了什么来修复它，然后我有几个问题......

场景：我有一个名为 A 的类，它有一个字典数据成员，下面是它的代码（这当然是简化）：

```
class A:
    dict1={}

    def add_stuff_to_1(self, k, v):
        self.dict1[k]=v

    def print_stuff(self):
        print(self.dict1) 
```

使用此代码的类是 B 类：

```
class B:

    def do_something_with_a1(self):
        a_instance = A()
        a_instance.print_stuff()        
        a_instance.add_stuff_to_1('a', 1)
        a_instance.add_stuff_to_1('b', 2)    
        a_instance.print_stuff()

    def do_something_with_a2(self):
        a_instance = A()    
        a_instance.print_stuff()            
        a_instance.add_stuff_to_1('c', 1)
        a_instance.add_stuff_to_1('d', 2)    
        a_instance.print_stuff()

    def do_something_with_a3(self):
        a_instance = A()    
        a_instance.print_stuff()            
        a_instance.add_stuff_to_1('e', 1)
        a_instance.add_stuff_to_1('f', 2)    
        a_instance.print_stuff()

    def __init__(self):
        self.do_something_with_a1()
        print("---")
        self.do_something_with_a2()
        print("---")
        self.do_something_with_a3() 
```

请注意，每次调用都会`do_something_with_aX()`初始化一个新的 A 类的“干净”实例，并在添加之前和之后打印字典。

错误（如果您还没有弄清楚）：

```
>>> b_instance = B()
{}
{'a': 1, 'b': 2}
---
{'a': 1, 'b': 2}
{'a': 1, 'c': 1, 'b': 2, 'd': 2}
---
{'a': 1, 'c': 1, 'b': 2, 'd': 2}
{'a': 1, 'c': 1, 'b': 2, 'e': 1, 'd': 2, 'f': 2} 
```

在A类的第二次初始化中，字典不是空的，而是以最后一次初始化的内容开始的，以此类推。我希望他们开始“新鲜”。

解决这个“错误”的方法显然是添加：

```
self.dict1 = {} 
```

在`__init__`A 类的构造函数中。然而，这让我想知道：

1.  在 dict1 的声明点（A 类的第一行）初始化“dict1 = {}”是什么意思？没有意义吗？
2.  导致从上次初始化复制引用的实例化机制是什么？
3.  如果我在构造函数（或任何其他数据成员）中添加“self.dict1 = {}”，它如何不影响先前初始化实例的字典成员？

* * *

编辑：按照答案，我现在明白，通过声明一个数据成员而不是在`__init__`self.dict1 或其他地方引用它，我实际上是在定义 C++/Java 中所谓的静态数据成员。通过将其称为 self.dict1 我将其设置为“实例绑定”。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-15T06:19:29.667

您一直将其称为错误的是 Python 类的已[记录](http://docs.python.org/tutorial/classes.html)的标准行为。

像你最初所做的那样声明一个字典`__init__`就是声明一个类级变量。它一开始只创建一次，每当您创建新对象时，它都会重用相同的字典。要创建实例变量，请使用`self`in声明它们`__init__`；就这么简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T06:23:12.417

当您访问实例的属性时，例如 self.foo，python 将首先在`self.__dict__`. 如果没有找到，python 会在`TheClass.__dict__`

在您的情况下，`dict1`属于 A 类，而不是实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-09T08:21:50.783

@Matthew：请查看面向对象编程中类成员和对象成员之间的区别。发生此问题是因为原始 dict 的声明使其成为类成员，而不是对象成员（正如原始发布者的意图）。因此，对于类的所有实例（即一次），它存在一次（共享）对于类本身，作为类对象本身的成员），因此行为是完全正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T06:27:39.943

Python 的类声明作为代码块执行，任何局部变量定义（其中函数定义是一种特殊类型）都存储在构造的类实例中。由于属性查找在 Python 中的工作方式，如果在实例上找不到属性，则使用类上的值。

这是[一篇关于](http://python-history.blogspot.com/2009/02/adding-support-for-user-defined-classes.html)Python 历史博客的类语法的有趣文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T07:06:18.320

如果这是您的代码：

```
class ClassA:
    dict1 = {}
a = ClassA() 
```

然后你可能预计这会发生在 Python 内部：

```
class ClassA:
    __defaults__['dict1'] = {}

a = instance(ClassA)
# a bit of pseudo-code here:
for name, value in ClassA.__defaults__:
    a.<name> = value 
```

据我所知，这*就是*发生的情况，除了 a`dict`复制了它的指针，而不是值，这是 Python 中所有地方的默认行为。看看这段代码：

```
a = {}
b = a
a['foo'] = 'bar'
print b 
```

# linq-to-sql - 在 linq 中找到“改进最大的”

> ID：867223
> 
> 赞同：2
> 
> 时间：2009-05-15T06:18:56.657
> 
> 标签：linq-to-sql

以下代码是我用来识别 Top 10 收入项目的代码

```
var top = (from m in db.Stats
           where m.Item.AccountID == AccountID
           && m.DateTime >= month
           && m.DateTime < month.AddMonths(1)
           group m by m.Item into g
           orderby g.Sum(p => p.Earnings) descending
           select g.Key).Take(10).ToArray(); 
```

在比较 2 个不同的月份时，我需要确定哪个项目的改进最大 (%)。可用数据仅为每日总数。我可能需要过滤掉低于一定数量“访客”的项目，即在哪里

```
m.Visitors >= 20 
```

在 Linq-Sql 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-04-22T12:17:03.633

如果您将查询分成两个不同的组，即当前月份（或时间段）和上个月（或时间段），它应该更易于管理。为清楚起见，我使用私有类来保留我们感兴趣的结果。您可以使用现有的类来代替。或者，编译器甚至可能足够聪明地意识到属性是相同的，从而为两个查询生成相同的匿名类。在任何情况下...

```
private class C {
    public object Key { get; set; }

    public object Earnings { get; set; }
}

var thisMonth = (from m in db.Stats
                 where m.Item.AccountID == AccountID
                 && m.DateTime.Month == month
                 group m by m.Item into g
                 select new C { g.Key, g.Earnings });

var lastMonth = (from m in db.Stats
                 where m.Item.AccountID == AccountID
                 && m.DateTime.Month == month.AddMonths(-1)
                 group m by m.Item into g
                 select new C { g.Key, g.Earnings }); 
```

从这里开始，将结果结合起来计算两组之间的百分比增益或损失。完成后，您可以按最高收益排序以获得前 n 名。

# algorithm - 寻找具有尽可能少的比较操作的排序算法

> ID：867224
> 
> 赞同：11
> 
> 时间：2009-05-15T06:19:25.453
> 
> 标签：algorithm, sorting

我想对人类进行比较的项目进行排序：

*   图片
*   工作项的优先级
*   ...

对于这些任务，比较次数是性能的限制因素。

*   需要的最小比较次数是多少（我假设**N**个项目> **N**）？
***   哪种算法可以保证这个最小数量？**

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T09:30:24.700

要回答这个问题，我们需要做出很多假设。

假设我们按可爱程度对图片进行排序。目标是在最短的时间内从人类那里获得最大的可用信息。这种交互将主导所有其他计算，因此它是唯一重要的。

正如其他人所提到的，人类可以很好地处理在一次交互中订购多个项目。假设我们每轮可以按相对顺序获得八个项目。

每一轮都将七个边引入有向图中，其中节点是图片。如果节点 A 可以从节点 B 到达，则节点 A 比节点 B 更可爱。请记住此图。

现在，让我告诉你一个海军和空军以不同方式解决的问题。他们都想快速地让一群人按身高顺序排列。海军告诉人们排队，然后如果你比你面前的人矮，就换个位置，然后重复直到完成。在最坏的情况下，它是 N*N 比较。

空军告诉人们站成方格。他们在 sqrt(N) 人身上前后洗牌，这意味着最坏的情况 sqrt(N)*sqrt(N) == N 比较。然而，人们只按照一个维度进行分类。于是，众人面左，再做同样的洗牌。现在我们最多进行 2*N 比较，排序仍然不完善，但对于政府工作来说已经足够了。有一个短角，对面有一个高角，以及明显的对角线高度梯度。

如果您不关心完美，您可以看到空军方法如何在更短的时间内获得结果。您还可以看到如何有效地获得完美。你已经知道最短和最长的男人在两个角落。第二个最短的可能在最矮的后面或旁边，第三个最短的可能在他的后面或旁边。一般来说，某人的身高排名也是他到短角的最大可能曼哈顿距离。

回顾图类比，每轮呈现的八个节点是当前最常见的最长入站路径长度的节点中的八个。最长入站路径的长度也表示节点的最小可能排序等级。

按照此计划，您将使用大量 CPU，但您将尽可能地利用您的人力资源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T06:23:49.170

[鸽子洞排序](http://en.wikipedia.org/wiki/Pigeonholing)是 N 阶，如果数据可以被鸽子洞，则可以很好地与人类一起工作。一个很好的例子是在选举中计算选票。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T07:04:31.197

从我曾经做过的关于这个主题的任务中......

比较计数适用于以随机顺序对数据进行操作的各种排序算法

```
Size      QkSort    HpSort   MrgSort     ModQk   InsrtSort
  2500     31388     48792     25105     27646     1554230
  5000     67818    107632     55216     65706     6082243
 10000    153838    235641    120394    141623    25430257
 20000    320535    510824    260995    300319   100361684
 40000    759202   1101835    561676    685937
 80000   1561245   2363171   1203335   1438017
160000   3295500   5045861   2567554   3047186 
```

这些比较计数适用于对开始“接近排序”的数据进行操作的各种排序算法。除其他外，它显示了快速排序的病态案例。

```
Size      QkSort    HpSort   MrgSort     ModQk   InsrtSort
  2500     72029     46428     16001     70618      76050
  5000    181370    102934     34503    190391    3016042
 10000    383228    226223     74006    303128   12793735
 20000    940771    491648    158015    744557   50456526
 40000   2208720   1065689    336031   1634659  
 80000   4669465   2289350    712062   3820384
160000  11748287   4878598   1504127  10173850 
```

由此我们可以看出，归并排序在比较次数上是最好的。

我不记得对快速排序算法的修改是什么，但我相信一旦单个块减小到一定大小，它就会使用插入排序。这种事情通常用于优化快速排序。

您可能还想查找 Tadao Takaoka 的“[最小合并排序](http://www.cosc.canterbury.ac.nz/research/reports/TechReps/1997/tr_9701.pdf)”，它是合并排序的更高效版本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T06:37:09.203

您应该考虑到人类可能会进行非传递性比较，例如，他们偏爱 A 而不是 B，B 而不是 C，但也偏爱 C 而不是 A。因此，在选择排序算法时，请确保在发生这种情况时它不会完全崩溃。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-15T06:45:17.730

人们真的很擅长从最好到最坏的顺序排列 5 到 10 件东西，并在这样做时得出更一致的结果。我认为由于典型的人工多重比较方法，尝试应用经典的排序算法可能在这里行不通。

我认为您应该采用循环式方法，并尝试每次将事物放入最一致的组中。每次迭代只会使结果更加确定。

写起来也很有趣：）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-02-08T18:23:30.273

如果比较相对于簿记成本来说是昂贵的，您可以尝试以下我称之为“锦标赛排序”的算法。首先，一些定义：

1.  每个节点都有一个数字“score”属性（它必须能够保存从 1 到节点数的值），以及一个“last-beat”和“fellow-loser”属性，它必须能够保存节点引用。
2.  如果一个节点应该在另一个节点之前输出，则它比另一个节点“更好”。
3.  如果没有已知比它更好的元素已被输出，则该元素被认为是“合格的”，如果已知任何尚未输出的元素比它更好，则该元素被认为是“不合格”。
4.  一个节点的“分数”是它已知优于的节点数加一。

要运行该算法，首先为每个节点分配 1 分。反复比较两个得分最低的合格节点；每次比较后，将失败者标记为“不合格”，并将失败者的分数添加到获胜者的分数（失败者的分数不变）。将失败者的“同伴失败者”属性设置为获胜者的“last-beat”，将获胜者的“last-beat”属性设置为失败者。重复此操作，直到只剩下一个符合条件的节点。输出该节点，并使符合条件的所有节点成为获胜者（使用获胜者的“最后一拍”和“同伴失败者”属性链）。然后在剩下的节点上继续算法。

与 1,000,000 个项目的比较次数略低于 Quicksort 的库存库实现；我不确定该算法将如何与更现代的 QuickSort 版本进行比较。簿记成本很高，但如果比较足够昂贵，那么节省可能是值得的。该算法的一个有趣特征是它只会执行与确定要输出的下一个节点相关的比较；我知道没有其他具有该功能的算法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T06:23:32.510

我认为您可能不会得到[比维基百科关于排序的页面](http://en.wikipedia.org/wiki/Sorting_algorithm)更好的答案。

概括：

*   对于任意比较（您不能使用基数排序之类的东西），您可以达到的最佳效果是 O(n log n)
*   各种算法实现了这一点 - 请参阅“算法比较”部分。
*   常用的快速排序在典型情况下是O(n log n)，但在最坏情况下是O(n^2)；通常有很多方法可以避免这种情况，但如果你真的担心比较的成本，我会选择 MergeSort 或 HeapSort 之类的东西。它部分取决于您现有的数据结构。

如果人类进行比较，他们是否也在进行排序？您是否有需要使用的固定数据结构，或者您是否可以使用平衡二叉树插入排序有效地创建副本？存储要求是什么？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T06:27:12.347

[这](http://en.wikipedia.org/wiki/Stable_sort#Comparison_of_algorithms)是算法的比较。两个更好的候选者是快速排序和合并排序。快速排序通常更好，但在最坏情况下的性能更差。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T06:47:32.610

合并排序绝对是这里的方法，因为您可以使用 Map/Reduce 类型算法让几个人并行进行比较。

快速排序本质上是一种单线程排序算法。

您还可以调整合并排序算法，这样您就无需比较两个对象，而是向您的人类展示一个包含五个项目的列表，并要求他或她对它们进行排名。

另一种可能性是使用著名的“Hot or Not”网站所使用的排名系统。这需要更多的比较，但是，比较可以以任何顺序并行进行，如果您有足够的类人猿可供使用，这将比经典排序更快。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-15T07:27:01.187

这些问题确实引发了更多问题。

我们是在说一个人进行比较吗？如果你在谈论一群人试图按顺序排列物体，那将是一个非常不同的挑战。

信任和错误的问题呢？不是每个人都可以被信任或把所有事情都做对——如果在任何给定的时间你对一个单一的比较提供了错误的答案，某些类型会出现灾难性的错误。

主观性呢？“按可爱程度排列这些图片”。一旦达到这一点，它可能会变得非常复杂。正如其他人提到的，“热与否”之类的概念在概念上是最简单的，但效率不高。在最复杂的情​​况下，我会说谷歌是一种将对象排序为顺序的方式，搜索引擎在其中推断人类进行的比较。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T06:26:39.850

最好的一个是合并排序

最小运行时间为 n*log(n) [Base 2] 它的实现方式是

如果列表的长度为 0 或 1，则它已经排序。

除此以外：

将未排序的列表分成两个大约一半大小的子列表。

通过重新应用归并排序对每个子列表进行递归排序。

将两个子列表合并回一个排序列表。

# ruby-on-rails - 使用 RESTful 身份验证插件进行 Ruby on Rails 功能测试

> ID：867231
> 
> 赞同：8
> 
> 时间：2009-05-15T06:19:56.263
> 
> 标签：ruby-on-rails, testing, restful-authentication, functional-testing

我今天开始为我的 Rails 应用程序编写功能测试。我使用 RESTful 身份验证插件。我遇到了一些令人困惑的事情，希望有人可以为我澄清。

1）我写了一个快速登录功能，因为我的rails应用程序中的大多数功能都需要身份验证。

```
def login_as(user)
   @request.session[:user_id] = user ? user.id : nil
end 
```

我看到这个功能的问题是，它基本上是伪造的身份验证。我应该担心这个吗？只要我在某处测试真正的身份验证方法，也许可以走这条路。或者，这可能是一种糟糕的做法。

2) 第二个令人困惑的事情是，在我的功能测试的某些地方，我需要进行完整的身份验证过程。当用户被激活时，我让 do_activate 方法为用户创建一些初始对象。如果有意义的话，它类似于为学生应用程序创建一个空白笔记本对象和笔对象。

因此，为了正确测试我的应用程序，我需要用户达到该激活状态，以便创建这些对象。我目前正在使用 Factory Girl 创建用户，然后调用上面的 login_as 函数来伪造身份验证。

我想另一种选择是跳过完整的身份验证序列，只使用 Factory Girl 创建空白对象。我可以在其他地方测试正确的身份验证。

你怎么看？如果我应该通过正确的顺序，为什么下面的代码不调用 do_activate 函数？

```
user = Factory.create(:user)
user.active = 1
user.save 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T01:46:50.747

假装是完全可以接受的。

但是，编写其他测试以确保您想要保护的东西受到保护。所以

```
test "it should show the profile page" do
  user = Factory(:user)
  login_as(user)
  get :show, :id => user
  assert_response :success
end

test "it should not show the profile page cos I'm not logged in" do
  user = Factory(:user)
  get :show, :id => user
  assert_response :redirect
end 
```

随时联系我进行跟进！

# graphics - JavaFX 设计器

> ID：867249
> 
> 赞同：3
> 
> 时间：2009-05-15T06:27:43.967
> 
> 标签：graphics, designer, javafx

目前我使用 JavaFX 只是为了好玩和学习。

我觉得烦人的是通过编码来设计图形并在预览窗口中观察结果——你知道我的意思吗？

JavaFX 是否有类似 Expression Blend 对于 Silverlight 的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T19:02:53.953

您可以看看 JavaFX SceneBuilder。[http://docs.oracle.com/javafx/scenebuilder/1/user_guide/jsbpub-user_guide.htm](http://docs.oracle.com/javafx/scenebuilder/1/user_guide/jsbpub-user_guide.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T06:47:16.260

**更新**

Tor Norbye 在 JavaOne 2009 会议上谈到了 JavaFX 设计器，他在他的博客上发布了截图。

[http://blogs.oracle.com/tor/entry/finally_over](http://blogs.oracle.com/tor/entry/finally_over)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T08:45:37.397

是的，支持从 Adob​​e 工具中导出。它被称为[JavaFX 生产套件](http://javafx.com/docs/gettingstarted/production_suite/)。

# python - 在 django/python 中编写类似 Digg 的系统

> ID：867251
> 
> 赞同：2
> 
> 时间：2009-05-15T06:28:17.663
> 
> 标签：python, django, digg

我想写一个 digg、hackernews、[http:](http://collectivesys.com/) //collectivesys.com/ 之类的应用程序，用户可以在其中提交内容，其他用户可以投票赞成或反对，将项目标记为最喜欢的等。我只是想知道是否有一些开源实现 django/python 可以用作起点，而不是从头开始重新发明轮子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T06:32:02.617

查看[Pinax](http://pinaxproject.com/)和[Django Pluggables](http://djangoplugables.com/)以获得一些预先制作的 Django 应用程序来帮助您。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-15T06:57:22.057

[reddit](http://reddit.com)是[开源](https://github.com/reddit/reddit)的，主要用 python 编写。除了代码之外，可能还有一些您可能会发现有用的算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T14:31:08.377

我建议仔细查看Google Code 上的[django-voting 项目。](http://code.google.com/p/django-voting/wiki/RedditStyleVoting)

他们声称是“Reddit 风格投票”的 django 实现

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T06:58:51.223

虽然不是用 django 编写的，但[reddit](http://reddit.com)是用 python 编写的并且是开源的。从[代码中](http://code.reddit.com/)你可以得到一些想法，看看他们是如何克服某些障碍等的。他们已经开源了所有东西，除了他们的反垃圾邮件措施。

# asp.net - 如何将文本框值传递给我的 Ajax.ActionLink？

> ID：867253
> 
> 赞同：6
> 
> 时间：2009-05-15T06:29:34.040
> 
> 标签：asp.net, asp.net-mvc, ajax, actionlink

在我的 ASP.NET MVC 应用程序中，我希望用户将值添加到文本框中，然后按我的 Ajax.ActionLink。我想做这样的事情：

Ajax.ActionLink("Go", "Action", "Controller", new { value = textbox1.value })

或者我怎样才能让这个文本框值回到我的操作中？jQuery？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T07:32:07.727

您可以使用 AJAX [$.get](http://docs.jquery.com/Ajax/jQuery.get)方法运行操作：

```
<script type="text/javascript">     

    $(document).ready(function()
    {
        $("#t").change(function()
        {
            RunAction();
        });

        RunAction();
    });

    function RunAction()
    {
        var action = '<%= Url.Action("Action", "Controller") %>';
        var data = $("#t").serialize();
        $.get(action, data);
    }

</script>

<input type="text" id="t" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T15:27:14.903

非常感谢亚历山大！谢谢你让我走上正确的道路。我没有尝试你最新的代码，但我能够让你以前的代码工作。这是工作代码。我敢肯定这一切都很笨拙，但也许有人可以向我展示一个更优雅的解决方案：

```
 <script type="text/javascript">
                $(document).ready(function() {
                    $("#myVal").change(function() {
                        changeActionURL();
                    });
                    changeActionURL();
                });
            function changeActionURL() {
                var url = '<%= new UrlHelper(ViewContext.RequestContext).Action("Action", "Controller") %>' + '?dup=' + $("#myVal").val();
                $("#u").attr('href', url);
            }
            </script>

            <a id="u" href="" onclick="Sys.Mvc.AsyncHyperlink.handleClick(this, new Sys.UI.DomEvent(event), { insertionMode: Sys.Mvc.InsertionMode.replace, updateTargetId: 'HellaYeah' });">Report Dupe</a>

        </p>
        <div id="response">not done</div> 
```

如您所见，我的解决方案只是对 LINK 进行硬编码，而不是尝试使用 ASP.NET AJAX 帮助器类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T06:35:07.943

这就是您从 JQuery 中的文本框中检索值的方式

```
var input =  $('input[name=txt_MyTextBox]').val() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-22T15:50:23.343

替换 $.get(action, data); 与 $("#yourTargetId").load(action, data); 你得到一个ajax，如下所示：

```
<script type="text/javascript">     

    $(document).ready(function()
    {
        $("#t").change(function()
        {
            RunAction();
        });

        RunAction();
    });

    function RunAction()
    {
        var action = '<%= Url.Action("Action", "Controller") %>';
        var data = $("#t").serialize();
        $("#yourTargetId").load(action, data);
    }

</script>

<input type="text" id="t" /> 
```

# asp.net - 在 Updatepanel AJAX 中使用是/否消息框

> ID：867256
> 
> 赞同：0
> 
> 时间：2009-05-15T06:30:51.540
> 
> 标签：asp.net, ajax, updatepanel, messagebox

我有一个要求，我要求用户确认并显示消息。

用于此的程序员来自 Windows 窗体背景。因此，在每个角落都使用了 MsgBox。即使在业务逻辑部分，他们也使用了需要用户确认是/否样式的消息框。

当我们从远程机器测试该站点时，我们发现它给出了使用 DefaultDesktopOnly/ServiceNotification 的错误。但是经过测试，我们发现这与我们所寻找的完全不同。

现在我的要求是从“删除记录”之类的代码中显示一个确认框“是的，没有，并根据我们采取行动的回复。

这将使用更新面板来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:48:31.343

当您在多个地方使用此代码时，我建议您制作一个自定义控件，它接收您的消息并显示和更新面板，其中包含消息和是/否按钮。

在内部为 yes、no、cancel... 设置一些值，以便您获得类似于 MessageBox 的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T06:36:43.743

无论是否更新面板，您都必须附加一些会调用`confirm()`javascript 函数的 javascript。根据它的结果，您取消 javascript 默认链接/按钮行为...

这会给你一些让你头疼的开始： http:
[//www.dotnetfunda.com/tutorials/ajax/updatepanel.aspx](http://www.dotnetfunda.com/tutorials/ajax/updatepanel.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:37:58.590

这不是一个真正的问题，而是一个要求。

无论如何... MessageBox 是 Windows 功能，它不是 HTML 或浏览器功能。现在您可以通过两种方式之一来模仿它，通过 javascript[确认](http://www.tizag.com/javascriptT/javascriptconfirm.php)功能或通过是/否按钮和适当的事件。

鉴于您的要求是在更新面板中工作的东西，我猜想为此手动连接 javascript 事件不会让您感到满意，所以我建议在 UpdatePanel 中使用 asp:Panel有是和否按钮，服务器端事件绑定到它们。在 UpdatePanel 逻辑中，当您需要确认并隐藏其他所有内容时显示此内容，请相应地采取行动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T06:42:39.750

如果您想做服务器端确认，您将进入更复杂的代码生成。首先，您将有两个*视图*。第一个有一个链接/按钮**删除**，但实际上只是对第二个视图的回发，它将显示带有是/否的确认*表单。*在这种形式中，您的“**是**”按钮实际上是您的*删除*操作...

但我仍然选择了 javascript 和服务器端的混合体（特别是如果这是我们正在谈论的网格）（因为从用户体验的角度来看是邪恶的）`alert()`：`confirm()`

1.  你有一个链接按钮*删除*
2.  当用户点击它时，你用一个 div 替换这个控件，它显示两个链接按钮是/否
3.  使用两者之一发送回传

**附录**

*   *没有*链接按钮可能只是虚拟的，隐藏此确认并再次显示*删除*- 所以这意味着不会有任何服务器往返
*   您甚至可以创建一个模仿这种*复杂的*删除链接行为的用户控件，以使其在应用程序范围内可重用。

# user-interface - 可编译为本机二进制的 GUI 编程语言

> ID：867263
> 
> 赞同：1
> 
> 时间：2009-05-15T06:34:02.487
> 
> 标签：user-interface, programming-languages

我需要编写一个应用程序来读取配置文件，其中包含它需要创建的菜单栏上的信息。

通常，我只会使用 java，但我需要应用程序具有尽可能少的运行时依赖关系，这包括不强制用户下载任何东西，即使是 JRE，更不用说像 NET Framework 之类的东西了。

所以我需要一些可以编译为 EXE 的东西（现在只有 Windows），这将允许我对GUI 进行**编码**，这样我就可以从我的配置中动态地创建它。

顺便说一句：像 C++ 这样的东西有点太低级了，我所需要的只是创建菜单，并在面板中显示 HTML。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T06:45:06.670

[wxPython](http://www.wxpython.org/)和[py2exe](http://www.py2exe.org/)怎么样？有一个很好的教程关于如何做到这一点[here](http://wiki.wxpython.org/SmallApp)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T06:37:45.520

如果 Java 太高级而 C++ 太低级，那么两者之间就没有太多的区别了。也许德尔福？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T06:43:50.917

出于几个原因，我不会完全放弃使用 Java 和/或 Python。

1) [py2exe](http://www.py2exe.org/)可以将你的 Python 代码编译成 exe。

2) [GCJ](http://gcc.gnu.org/java/)可以将你的Java 代码编译成exe。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T06:42:35.523

Delphi 是您的最佳选择。因为 Delphi 将源代码编译成原生 x86。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T06:53:27.243

除非您有充分的理由避免使用解释型语言，否则我建议您更好地研究打包或编译解释型脚本的方法，因为这样做可能会减少您的学习和开发时间。

我会在**Tcl/Tk**中编写一个简单的 GUI ，然后将其打包为**[Starpack](http://wiki.tcl.tk/3663)**。

ActiveState 提供了一个发行版 ( [ActiveTCL](http://www.activestate.com/activetcl/) ) 和一个不错的编辑器 ( [Komodo Edit](http://www.activestate.com/komodo_edit/) )，并且很容易获得与 Tk 一起使用的简单 GUI。查看[TkDocs](http://www.tkdocs.com/index.html)了解一些手把手。

完成后，您可以将代码、Tcl 运行时、数据库和虚拟文件系统[打包](http://wiki.tcl.tk/3663)成一个可执行文件，您可以轻松分发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T06:44:23.100

你考虑过[D](http://digitalmars.com/d/)吗？它的语法类似于 Java、C++ 和 Python 的混合体，能够制作原生 Windows 应用程序。[dprogramming.com](http://www.dprogramming.com/)上的教程非常适合学习该语言。对于快速 GUI，您可能会对[The D Forms Library](http://www.dprogramming.com/dfl.php)和[Entice Designer](http://www.dprogramming.com/entice.php)感兴趣。

[这里](http://www.dprogramming.com/dfl/videos.php)有一些简短的视频教程，用于启动和运行 Entice。

或者，您是否尝试过[Qt & Qt Creator](http://trolltech.com)？它需要大量的 C++ 编程，而且它也是跨平台的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T07:09:40.763

耳柳是对的。您可以使用 HTA： http: [//www.interclasse.com/scripts/htanotepad.php](http://www.interclasse.com/scripts/htanotepad.php)

但是，如果您了解 C++，那么使用 Visual C++ 创建这种类型的应用程序实际上非常容易。使用 MFC，并静态链接所有内容。您可以在资源编辑器中绘制菜单，并将事件附加到菜单项。如果我是你，我不会使用 HTML。只需使用常规的 Windows 控件。但是如果你真的打算使用 HTML，你可以在 formview 中嵌入一个浏览器控件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T06:53:51.737

你说：

> 我只需要创建菜单并在面板中显示 HTML。

很像一个网络浏览器，那么。如果它要在 Windows 上运行，那么用户有 IE。为什么不使用 IE 为您完成所有工作？

您可以使用 IE 制作类似于 .exe 的东西，称为 .hta：

[http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx)

# c++ - 传递 **Class 作为参数

> ID：867270
> 
> 赞同：0
> 
> 时间：2009-05-15T06:37:00.420
> 
> 标签：c++, class

我试图在 main.h 中声明一个方法，如下所示：

```
void buildGraph(int gNum, Graph** gArray); 
```

其中 Graph 是一个类，我正在尝试将指针传递给指向 Graph 对象的指针数组。

我收到错误消息：“图形尚未声明”。尽管我在页面顶部有 #include "graph.h" 并且到目前为止我一直在使用图形类，所以我知道它有效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T06:39:00.353

文件系统中可能有多个 graph.h 文件，并且包含了错误的文件。如果是因为意外复制删除不需要的副本，如果是因为与 C++ 标准库或其他库头文件冲突，则应重命名头文件以防止将来发生此类冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T06:48:26.727

一个常见的可能性是 Graph.h 中的包含保护不正确，可能是您正在使用的另一个头文件的遗留物。

也就是说，确保您应该在 Graph.h 中拥有的类似“#ifndef GRAPH_H”的行确实​​是它应该是的......

（但实际上，如果没有更多信息来回答这个问题......很难）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:39:16.950

也许名称 Graph 在命名空间中？该 graph.h 文件说什么 - 是 Graph 在顶层还是在命名空间语句中？

# javascript - 我们可以在 iframe 中淡入淡出吗

> ID：867272
> 
> 赞同：5
> 
> 时间：2009-05-15T06:37:18.220
> 
> 标签：javascript, html

是否可以在 iframe 中进行淡入淡出过渡？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-15T08:47:34.957

淡入或淡出可以通过随时间改变元素的不透明度来实现，一个非常简单的例子：

```
var iframe = document.getElementById('iframe');

fadeOut(iframe, 1000);

function fadeOut(el, duration) {

    /*
     * @param el - The element to be faded out.
     * @param duration - Animation duration in milliseconds.
     */

    var step = 10 / duration,
        opacity = 1;
    function next() {
        if (opacity <= 0) { return; }
        el.style.opacity = ( opacity -= step );
        setTimeout(next, 10);
    }
    next();
} 
```

* * *

虽然 jQuery 是一个令人难以置信的库，但您使用它的理由不仅仅是它能够创造奇特的效果。应采用库的完整性和易用性；不是因为它恰好提供了您可能想要使用的*一件事。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T06:43:32.417

你可以用jquery来做！

[http://docs.jquery.com/Effects/fadeOut](http://docs.jquery.com/Effects/fadeOut)

[http://docs.jquery.com/Effects/fadeIn](http://docs.jquery.com/Effects/fadeIn)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-22T13:04:04.177

或者，您可以让 CSS 为您处理。用很少的 javascript 来触发效果。

**CSS：**

```
#iframe_selector {
  /* initial values for iframe, we'll change them via javascript. */
  opacity: 0;
  /* Note: In out/2016 opacity is on 97.39% of browsers */
  /* Just an extra property to show multiple transitions, not needed for fade effect. */
  height: 0;
  /* Here you can handle a couple of transitions as you wish */
  transition: opacity 2s ease-in-out, height 3s ease-in-out;
  /* Note: Add all prefixes */
} 
```

**Javascript**

```
function toogleIframe(iframe) {
  //Check if is show with opacity property,
  if (iframe.style.opacity == 0) {
    //and set to original values,
    iframe.style.opacity = 1;
    iframe.style.height = '500px';
  } else {
    //or hide it.
    iframe.style.opacity = 0;
    iframe.style.height = '0px';
  }
}

//And now, just use it...
//Examples:
domReady(function() {
  toogleIframe(document.getElementById('iframe_selector'));
});

var button = document.getElementById('my_button');
button.onclick = function() {
  toogleIframe(document.getElementById('iframe_selector'));
};

//Just specify when your iframe needs to be show or not... 
```

只是一件事，也许您想在 iframe 将要显示时加载它，为此只需`src`从 HTML 中的 iframe 中删除，然后使用`iframe.src`. 那是我的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-21T14:09:33.467

您可以使用 onload 属性和 css 动画使 iframe 在加载后淡入

```
<iframe
    src="..."
    onload="this.style.opacity = '1';"
    style="
        opacity: 0;
        transition-duration: 300ms;
        transition-property: opacity;
        transition-timing-function: ease-in-out;
    "
></iframe> 
```

# regex - 定义一些二进制序列的正则表达式

> ID：867279
> 
> 赞同：7
> 
> 时间：2009-05-15T06:38:16.220
> 
> 标签：regex

您将如何编写一个正则表达式来定义所有由 0 和 1 组成的字符串，它们作为二进制数表示是 3 的倍数的整数。

一些有效的二进制数是：

```
11
110
1001
1100
1111

```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-15T08:02:07.297

[在这里](http://introcs.cs.princeton.edu/java/73dfa/)使用 DFA ，我们可以通过以下方式制作正则表达式，其中 A、B、C 表示 DFA 的状态。

```
A = 1B + 0A
B = 1A + 0C
C = 1C + 0B

C = 1*0B // Eliminate recursion

B = 1A + 0(1*0B)
B = 01*0B + 1A
B = (01*0)*1A // Eliminate recursion

A = 1(01*0)*1A + 0A
A = (1(01*0)*1 + 0)A
A = (1(01*0)*1 + 0)* // Eliminate recursion 
```

导致 PCRE 正则表达式，如：

```
/^(1(01*0)*1|0)+$/ 
```

Perl 测试/示例：

```
use strict;

for(qw(
11
110
1001
1100
1111
0
1
10
111
)){
    print "$_ (", eval "0b$_", ") ";
    print /^(1(01*0)*1|0)+$/? "matched": "didnt match";
    print "\n";
} 
```

输出：

```
11 (3) matched
110 (6) matched
1001 (9) matched
1100 (12) matched
1111 (15) matched
0 (0) matched
1 (1) didnt match
10 (2) didnt match
111 (7) didnt match 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-15T08:31:53.187

当你将一个数除以三时，只有三个可能的余数（0、1 和 2）。您的目标是确保余数为 0，因此是 3 的倍数。

这可以通过具有三种状态的自动机来完成：

*   ST0，3 的倍数 (0, 3, 6, 9, ....)。
*   ST1，3 的倍数加 1 (1, 4, 7, 10, ...)。
*   ST2，3 的倍数加 2 (2, 5, 8, 11, ...)。

现在考虑*任何*非负数（这是我们的域）并将其乘以 2（在末尾添加一个二进制零）。为此的过渡是：

```
ST0 -> ST0 (3n * 2 = 3 * 2n, still a multiple of three).
ST1 -> ST2 ((3n+1) * 2 = 3*2n + 2, a multiple of three, plus 2).
ST2 -> ST1 ((3n+2) * 2 = 3*2n + 4 = 3*(2n+1) + 1, a multiple of three, plus 1). 
```

还可以考虑任何非负数，将其乘以 2，然后*加 1*（将二进制 1 添加到末尾）。为此的过渡是：

```
ST0 -> ST1 (3n * 2 + 1 = 3*2n + 1, a multiple of three, plus 1).
ST1 -> ST0 ((3n+1) * 2 + 1 = 3*2n + 2 + 1 = 3*(2n+1), a multiple of three).
ST2 -> ST2 ((3n+2) * 2 + 1 = 3*2n + 4 + 1 = 3*(2n+1) + 2, a multiple of three, plus 2). 
```

这个想法是，最后，您需要在状态 ST0 中完成。但是，考虑到可以有任意数量的子表达式（和子子表达式），它不容易简化为正则表达式。

您需要做的是允许任何可以从 ST0 到 ST0 的转换序列，然后重复它们：

这些归结为两个 RE 序列：

```
ST0 --> ST0                                      :  0+
    [0]
ST0 --> ST1 (--> ST2 (--> ST2)* --> ST1)* --> ST0:  1(01*0)*1
    [1]     ([0]     ([1]    )* [0]    )* [1] 
```

或正则表达式：

```
(0+|1(01*0)*1)+ 
```

这捕获了三个的倍数，或者至少是我测试的前十个。您可以尝试任意次数，它们都会起作用，这就是数学分析的美妙之处，而不是轶事证据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T22:37:11.670

答案是`(1(01*0)*10*)*`，这是迄今为止唯一适用于`110011`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-15T06:42:50.483

我不认为你会。我无法相信任何使用正则表达式的语言都可能是做到这一点的最佳方式。

# hql - 在 HQL 执行期间将惰性设置为 true

> ID：867289
> 
> 赞同：1
> 
> 时间：2009-05-15T06:42:14.323
> 
> 标签：hql, lazy-evaluation, hbm

在我们的应用程序中，我们根据应用程序需要将各种对象设置为lazy false。然而，在一个用例中，我们希望忽略 HBM 文件中的所有惰性设置，只获取目标对象。

所以问题是：有没有办法在 HQL 中指定只获取目标对象而不管 HBM 设置如何？

~斯里兰卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:48:35.680

您可以在执行之前在 Criteria 上使用[setFetchMode](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/FetchMode.html)来覆盖 HBM 文件设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T07:03:20.403

抱歉，不确定您是否理解您的问题。

如果您必须为特定类实现它，则可以使用 SetFetchMode。

```
var query = session.CreateCriteria(typeof(MyClass));
query.SetFetchMode("PropertyA", FetchMode.Select);
query.SetFetchMode("PropertyB", FetchMode.Select); 
```

注意：对于多对一引用，实体类本身必须映射为lazy=true。如果没有，NHibernate 甚至不会为它创建代理类。

* * *

如果您想以通用的、与类型无关的方式延迟加载类型，这就是答案：

您可以使用元数据找到它们并将获取模式添加到条件

我没有尝试过，但我将从以下代码开始：

```
var meta = sessionfactory.GetClassMetaData(typeof(MyClass));

var query = session.CreateCriteria(typeof(MyClass));

for(int index = 0; index < meta.PropertyType.Length; index++)
{
  if (meta.PropertyType[index] == NHibernateUtil.Entity)
  {
    query.SetFetchMode(meta.PropertyNames[index], FetchMode.Select);
  }
} 
```

这不包括集合。它们可能与 一起找到`factory.GetCollectionMetadata(roleName)`，但您需要找出`roleName`.

# iphone - 从 UITableView 中删除自定义单元格的方法是什么？

> ID：867327
> 
> 赞同：-1
> 
> 时间：2009-05-15T06:54:01.860
> 
> 标签：iphone, xcode

我有一个自定义单元格，我想在单击位于自定义单元格本身上的按钮时将其删除。我该如何实现这一点。有人帮助我很多天都被困在这个问题上

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T07:27:34.137

不知道为什么要这样做而不是使用标准的删除行为，但是...

首先，您需要知道`indexPath`按下该按钮的单元格。因此，您必须连接自定义单元格以接收按钮操作，然后`indexPathForCell`使用该单元格调用表格的方法以获取 indexPath。

拥有它后，将 indexPath 放入 an`NSArray`并将其传递给表格的`deleteRowsAtIndexPaths`方法（并选择用于删除单元格的动画类型）。这也将调用 dataSource 的`commitEditingStyle`方法来让您删除底层数据。

请记住，通过这种方式，您绕过了内置于表中的两步删除过程——用户通常会在该过程中请求删除，然后必须进行确认。因此，为了安全起见，您可能希望自己实现类似的东西。

此外，在表格单元格上滑动的默认行为是调出删除按钮。您可能想要覆盖`editingStyleForRowAtIndexPath`委托方法并返回`UITableViewCellEditingStyleNone`该单元格，这样它就不会执行默认操作。

# java - Java中的定时器与线程原语

> ID：867329
> 
> 赞同：2
> 
> 时间：2009-05-15T06:55:22.107
> 
> 标签：java, multithreading, timer

有没有人观察到使用 Thread.sleep(t) 创建一个在 while(true) 循环中工作的线程似乎比在 Java 中创建一个唤醒时间为 t 的 Timer 消耗更多的 CPU？任何具有 JVM 专业知识的人都知道这是为什么？我只是在 Windows 和 Linux x86 上真正尝试过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T07:00:39.317

根据[Timer 类的 Javadoc](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Timer.html)，有一个后台线程可以完成这项工作：

> 对应于每个 Timer 对象的是单个后台线程，用于按顺序执行所有计时器的任务。定时器任务应该很快完成。如果一个定时器任务花费了过多的时间来完成，它就会“占用”定时器的任务执行线程。反过来，这会延迟后续任务的执行，当（如果）有问题的任务最终完成时，这些任务可能会“聚集”并快速连续执行。

您如何观察 CPU 使用率？您是否尝试过 JVM 分析器？

# iphone - 从 URL 下载时的 UIActivityIndi cator 问题

> ID：867336
> 
> 赞同：0
> 
> 时间：2009-05-15T06:59:30.647
> 
> 标签：iphone

我正在尝试从 URL 下载图片并使用活动指示器动画来呈现文件正在下载的事实。但是，它不起作用，因为当我调用此下载功能时，我的指示器没有动画，有人可以告诉我为什么吗？

```
-(void)download{
    [indicator startAnimating];
    NSString *downloadPath=@"http://www.xyz.com/path/pic.jpg; 
    NSData *downloadData=[NSData dataWithContentsOfURL:[ NSURL  URLWithString:downloadPath]];
    if(downloadData){
           //do something
          [indicator stopAnimating];
     }
      else{
        //do something
        [indicator stopAnimating];
          }
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T11:04:11.900

你需要把 [indicator startAnimating] 和 [indicator stopAnimating]; 在不同的方法中。我相信动画在方法结束之前不会启动。所以如果你把它分成几个方法，这应该有效

*   一种启动动画的方法
*   一种下载文件的方法。
*   一种停止动画的方法。

另一种选择是线程来完成这一点。更多信息[在这里](https://stackoverflow.com/questions/441345/does-uiactivityindicator-require-manual-threading-on-iphone)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T11:41:01.233

动画在事件循环中执行，它与您的代码在同一个线程中。也就是说，动画不会在您的代码执行时开始。

相反，您需要忘记动画，切换到使用异步下载方法或在单独的线程中执行下载。我会推荐异步选项。

# nhibernate - NHibernate：拦截器和监听器的区别

> ID：867341
> 
> 赞同：15
> 
> 时间：2009-05-15T07:01:21.173
> 
> 标签：nhibernate, listener, interceptor

查看 NHibernate 中创建/更新列的所有可能性，我主要（[Stackoverflow 问题](https://stackoverflow.com/questions/551701/how-do-i-implement-changetime-and-changeuser-columns-using-nhibernate)，[Ayende Rahien](http://ayende.com/Blog/archive/2009/04/29/nhibernate-ipreupdateeventlistener-amp-ipreinserteventlistener.aspx)）查看 Listeners 的解决方案。

在我公司编写这个程序的程序员使用拦截器来实现同样的事情。

这两种解决方案有什么区别吗？（其中之一是否已过时，是否首选其中之一，有哪些优点和/或缺点）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-15T07:09:50.200

拦截器是旧方式，事件侦听器是较新的，服务相同的目的。所以在一个新项目中，推荐使用事件监听器。您连接到新的*NHibernate 事件系统*。

**编辑：**正如 Rashack 在他的评论中提到的，有些操作只能使用拦截器来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-05T02:20:38.407

根据文档，它声明：“如果您必须对持久层中的特定事件做出反应，您还可以使用 Hibernate 事件架构。事件系统可以作为拦截器的补充或替代使用。”

两者都有一些区别：

1.  侦听器很容易配置，即按照休眠文档“在注册期间额外定义的类型可以更容易地在配置期间打开或关闭自定义侦听器”

2.  拦截器可以是会话范围的，也可以是会话工厂范围的，通过编程和声明的方法。另一方面，以声明方式注册的侦听器不能共享实例。如果在多个元素中使用相同的类名，则每个引用将导致该类的单独实例。如果您需要在侦听器类型之间共享侦听器实例，则必须使用编程注册方法。

# regex - vim & csv 文件：将标题信息放入新列

> ID：867347
> 
> 赞同：5
> 
> 时间：2009-05-15T07:04:44.253
> 
> 标签：regex, vim, csv, replace, copy-paste

我有大量的 csv 文件，如下所示：

* * *

xxxxxxxx
xxxxx
发货，YD564n
xxxxxxxx
xxxxx

1,RR1760
2,HI3503
3,HI4084
4,HI1824

* * *

我需要让它们看起来像下面这样：

* * *

xxxxxxxx
xxxxx
发货，YD564n
xxxxxxxx
xxxxx

YD564n,1,RR1760
YD564n,2,HI3503
YD564n,3,HI4084
YD564n,4,HI1824

* * *

YD564n 是一个货件编号，每个 csv 文件都会有所不同。但它总是紧跟在“装运”之后。

我可以使用哪些 vim 命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T07:26:20.130

在一个文件中，在正常模式下键入以下内容：

```
qqgg/^Shipment,<CR>ww"ay$}j:.,$s/^/<C-R>a,<CR>q 
```

注意`<CR>`是ENTER键，`<C-R>`是CTRL-R。

这将更新该文件并记录寄存器 q 中的命令。

然后在每个其他文件中键入@q（也在正常模式下）。（这将播放寄存器 q）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T07:29:39.077

您可以使用宏来执行此操作，并将其应用于多个文件。

这是一个例子。按原样键入以下内容：

```
3gg$"ayiw:6,$s/^/<C-R>a/<CR>:w<CR>:bn<CR> 
```

现在看起来很可怕。让我看看我是否可以更好地解释一下。

`3gg$`: 转到第三行的末尾。

`"ayiw`: 将最后一个字复制到寄存器`a`中。

`:6,$s/^/<C-R>a/<CR>`：从第 6 行开始的每一行中，在开头替换寄存器 a 中的任何内容。

`:w<CR>:bn<CR>`：保存并转到下一个缓冲区。

现在您可以将其映射到一个键，通过

```
:nnoremap <C-A> 3gg$"ayiw:6,$s/^/<C-R>a/<CR>:w<CR>:bn<CR> 
```

然后如果你有 200 个 csv 文件，你打开 vim 为

```
vim *.csv 
```

进而

```
200<C-A> 
```

你在哪里输入 Ctrl-A ，这一切都应该完成。

也就是说，我肯定会更舒服地用适当的脚本语言来做这件事，它会更直接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T07:27:23.543

这可以作为 Perl 单行来完成：

```
perl -i.bak -e' $c = do {local $/; <>};
                ($n) = ($c =~ /Shipment,(\w+)/);
                $c =~ s/^(\d+,)/$n,$1/gm;
                print $c' shipment.csv 
```

这将读取`shipment.csv`into的内容`$c`，将货件 ID 提取到`$n`中，并在每个 CSV 行前面加上货件编号。该文件将在原地修改，备份保存到`shipment.csv.bak`.

要在 Vim 中执行此操作，请将其调整为过滤器：

```
:%!perl -e' $c = do {local $/; <>}; ($n) = ($c =~ /Shipment,(\w+)/); $c =~ s/^(\d+,)/$n,$1/gm; print $c' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T07:28:43.617

好吧，不要抨击我，但是......你可以考虑：不要在 vim 中这样做！

这是脚本语言的经典用法示例。学习基本的 python、perl 或 ruby​​ 教程。解决方案就在其中。

正则表达式可能不会太难，并且在 vim 中*是可行的。*但是那里有更简单的选择。还有更灵活的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T07:31:51.380

为什么是vim？

试试这个 shell 脚本：

```
#!/bin/sh

input=$1

shipment=`grep Shipment $input|awk -F, '{print $2}'`

mv $input $input.orig

sed -e "s/^\([0-9]\)/$shipment,\1/" $input.orig > $input 
```

您可以遍历特定文件：

```
for input in *.txt
do
    script.sh $i
done 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T07:32:55.137

我也认为这不太适合 vim，那么在 Bash 中呢？

```
FILENAME='filename.csv' && SHIPMENT=`grep Shipment $FILENAME | sed 's/^Shipment,//'` && cat $FILENAME | sed "s/^[0-9]/$SHIPMENT,&/" > $FILENAME 
```

# c# - C# 从绑定源限制的类型化数据集中删除行的最佳方法

> ID：867349
> 
> 赞同：2
> 
> 时间：2009-05-15T07:06:42.500
> 
> 标签：c#, datagridview, dataset, bindingsource

C# 2008 SP1。

我正在从当前在 datagridview 上选择的行中删除一行。

我正在使用 Typed 数据集，并且我的 datagridview 绑定到绑定源。

但是，我认为我的技术不是最好的，即使它有效。

非常感谢您的任何建议，

```
 DataRow[] drDelete;
            // Get the value of the PK from the currently selected row
            DataRowView drv = (DataRowView)bsAddressBook.Current;
            int index = Convert.ToInt16(drv[0]);

            // Find the actual data row from the primary key and delete the row
            drDelete = dsCATDialer.AddressBook.Select(string.Format("ID = '{0}'", index));
            dsCATDialer.AddressBook.Rows.Remove(drDelete[0]); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T08:00:46.457

您也可以使用 BindingSource 直接删除：

```
bsAddressBook.RemoveCurrent(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T07:51:29.180

我认为您可以使用 DataRowView 的 Row 属性来缩短它。

```
// Get the value of the PK from the currently selected row
DataRowView drv = (DataRowView)bsAddressBook.Current;

DataRow drDelete = drv.Row;
dsCATDialer.AddressBook.Rows.Remove(drDelete); 
```

# java - 在Java中，我可以用二进制格式定义一个整数常量吗？

> ID：867365
> 
> 赞同：87
> 
> 时间：2009-05-15T07:14:56.100
> 
> 标签：java, syntax, binary

类似于如何以十六进制或八进制定义整数常量，我可以用二进制来定义吗？

我承认这是一个非常简单（而且愚蠢）的问题。我的谷歌搜索是空的。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-11-07T12:47:48.207

在 Java 7 中：

```
int i = 0b10101010; 
```

旧版本的 Java 中没有二进制文字（有关替代方案，请参阅其他答案）。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2011-12-20T01:56:05.573

因此，随着 Java SE 7 的发布，二进制表示法成为开箱即用的标准。如果您对二进制有很好的理解，则语法非常简单明了：

```
byte fourTimesThree = 0b1100;
byte data = 0b0000110011;
short number = 0b111111111111111; 
int overflow = 0b10101010101010101010101010101011;
long bow = 0b101010101010101010101010101010111L; 
```

特别是在将类级别变量声明为二进制文件时，使用二进制表示法初始化静态变量绝对没有问题：

```
public static final int thingy = 0b0101; 
```

请注意不要用太多数据溢出数字，否则会出现编译器错误：

```
byte data = 0b1100110011; // Type mismatch: cannot convert from int to byte 
```

现在，如果你真的想变得花哨，你可以将 Java 7 中另一个被称为数字文字的简洁新特性与下划线结合起来。看看这些带有文字下划线的二进制符号的奇特示例：

```
int overflow = 0b1010_1010_1010_1010_1010_1010_1010_1011;
long bow = 0b1__01010101__01010101__01010101__01010111L; 
```

现在不是很好和干净，更不用说高度可读了吗？

我从我在 TheServerSide 上写的一篇关于该主题的小文章中提取了这些代码片段。请随时查看以获取更多详细信息：

[Java 7 和二进制表示法：掌握 OCP Java 程序员 (OCPJP) 考试](http://www.theserverside.com/tutorial/Java-7-and-Binary-Notation)

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2009-05-15T07:18:53.423

Java中没有二进制文字，但我想你可以这样做（虽然我不明白这一点）：

```
int a = Integer.parseInt("10101010", 2); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-07-30T03:00:44.557

Ed Swangren 的回答

```
public final static long mask12 = 
  Long.parseLong("00000000000000000000100000000000", 2); 
```

工作正常。我使用`long`代替`int`并添加了修饰符以阐明可能用作位掩码的用法。但是，这种方法有两个不便之处。

1.  所有这些零的直接输入很容易出错
2.  结果在开发时不可用十进制或十六进制格式

我可以建议替代方法

```
public final static long mask12 = 1L << 12; 
```

这个表达式很明显第12位是1（计数从0开始，从右到左）；当您将鼠标光标悬停时，工具提示

```
long YourClassName.mask12 = 4096 [0x1000] 
```

出现在 Eclipse 中。您可以定义更复杂的常量，例如：

```
public final static long maskForSomething = mask12 | mask3 | mask0; 
```

或明确

```
public final static long maskForSomething = (1L<<12)|(1L<<3)|(1L<<0); 
```

在开发时，该变量的值`maskForSomething`在 Eclipse 中仍然可用。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2011-03-14T12:23:36.343

## 使用二进制常量进行屏蔽

声明常量：

```
public static final int FLAG_A = 1 << 0;
public static final int FLAG_B = 1 << 1;
public static final int FLAG_C = 1 << 2;
public static final int FLAG_D = 1 << 3; 
```

并使用它们

```
if( (value & ( FLAG_B | FLAG_D )) != 0){
    // value has set FLAG_B and FLAG_D
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-05-15T07:24:12.367

在 Google 上搜索“Java 文字语法”，您会找到一些条目。

有八进制语法（以 0 为数字前缀）、十进制语法和以“0x”为前缀的十六进制语法。但是没有二进制表示法的语法。

一些例子：

```
int i = 0xcafe ; // hexadecimal case
int j = 045 ;    // octal case
int l = 42 ;     // decimal case 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-09T17:04:40.970

如果你想弄乱很多二进制文件，你可以定义一些常量：

```
public static final int BIT_0 = 0x00000001;
public static final int BIT_1 = 0x00000002; 
```

等等

或者

```
public static final int B_00000001 = 0x00000001;
public static final int B_00000010 = 0x00000002;
public static final int B_00000100 = 0x00000004; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T08:00:05.523

稍微尴尬的回答：

```
public class Main {

    public static void main(String[] args) {
        byte b = Byte.parseByte("10", 2);
        Byte bb = new Byte(b);
        System.out.println("bb should be 2, value is \"" + bb.intValue() + "\"" );
    }

} 
```

哪个输出 [java] bb 应该是 2，值是“2”

# wpf - WPF 数据导航控件

> ID：867368
> 
> 赞同：1
> 
> 时间：2009-05-15T07:16:10.183
> 
> 标签：wpf, navigation

我需要一组导航控件来移动数据（First、Next、Prev、Last 和特定记录）。是否有任何一组控件可以将其连接起来？我是 WPF 的新手，并希望已经存在提供此功能的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T21:49:58.400

不，您需要自己创建它们。当然，这取决于您的数据模型。

WPF 方法是将您的数据绑定到 ListView（或任何 ListItem 容器），然后使用

```
myList.Items.MoveCurrentToFirst()
myList.Items.MoveCurrentToLast()
//etc.... 
```

# iphone - 在 iPhone 上使用 OpenGL ES 加载大纹理时出现 glError: 0x0501？

> ID：867378
> 
> 赞同：2
> 
> 时间：2009-05-15T07:21:51.887
> 
> 标签：iphone, opengl-es

这是我用来加载纹理的代码。图像是一个 CGImageRef。使用此代码加载图像后，我最终使用 glDrawArrays() 绘制图像。

```
 size_t imageW = CGImageGetWidth(image);
    size_t imageH = CGImageGetHeight(image);
    size_t picSize = pow2roundup((imageW > imageH) ? imageW : imageH);

    GLubyte *textureData = (GLubyte *) malloc(picSize * picSize << 2);
    CGContextRef imageContext = CGBitmapContextCreate( textureData, picSize, picSize, 8, picSize << 2, CGImageGetColorSpace(image), kCGImageAlphaNoneSkipLast | kCGBitmapByteOrder32Big );  

    if (imageContext != NULL) {
        CGContextDrawImage(imageContext, CGRectMake(0.0, 0.0, (CGFloat)imageW, (CGFloat)imageH), image);    
        glGenTextures(1, &textureId);   
        glBindTexture(GL_TEXTURE_2D, textureId);

        // when texture area is small, bilinear filter the closest mipmap
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
        // when texture area is large, bilinear filter the original
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

        // the texture wraps over at the edges (repeat)
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
        glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE);

        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, picSize, picSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, textureData);

        GLenum err = glGetError();
        if (err != GL_NO_ERROR)
            NSLog(@"Error uploading texture. glError: 0x%04X", err);

        CGContextRelease(imageContext);
    }

    free(textureData); 
```

当图像为 320x480 时，这似乎可以正常工作，但当图像较大时（例如 picSize = 2048），它会失败。

这是我在调试器控制台中得到的：

```
Error uploading texture. glError: 0x0501 
```

这个错误是什么意思？最好的解决方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T07:51:42.987

你不是简单地达到了最大纹理大小限制吗？错误代码是`GL_INVALID_VALUE`，请参阅[glTexImage2D 文档](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/teximage2d.html)：

> `GL_INVALID_VALUE`如果`width` 或`height`小于`0`或大于`2 + GL_MAX_TEXTURE_SIZE`，或者其中一个不能表示为 `2k+2(border)`的某个整数值，则生成 `k`.

iPhone 不支持大于 1024 像素的纹理。解决方法是将图像拆分为多个纹理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T07:41:35.710

也许您只是内存不足-您是否验证了从 malloc() 返回的值不为 NULL？
（这可以解释得到 0x0501，即 GL_INVALID_VALUE）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-17T13:44:42.303

我也遇到了同样的问题`GLKitBaseEffect`，这似乎是一个内存问题（正如 Hexagon 建议的那样）。为了解决这个问题，我不得不添加手动纹理释放调用：

```
GLuint name = self.texture.name;
glDeleteTextures(1, &name); 
```

有关更多信息，请参阅此线程：[释放纹理（GLKTextureInfo 对象）由 GLKTextureLoader 分配](https://stackoverflow.com/questions/8720221/release-textures-glktextureinfo-objects-allocated-by-glktextureloader)。

# vb6 - 如何将 ffmpeg 转码过程信息链接到 vb6 GUI 应用程序中？

> ID：867383
> 
> 赞同：2
> 
> 时间：2009-05-15T07:23:37.500
> 
> 标签：vb6, ffmpeg, progress-bar

我正在使用[ffmpeg](http://www.videohelp.com/tools/ffmpeg)的 vb6 gui 前端，到目前为止，我所能做的就是通过 cmd.exe 调用 ffmpeg，这将在整个过程仍在运行时显示命令提示符。我认为这是查看 WinFF（另一个基于 pascal 的 ffmpeg 前端 gui）如何工作的规范。

但是当我看到另一个[有进度条和所有东西的 GVC gui 时，我被震撼了。](http://download.freewarefiles.com/files/GVC_0.6_Beta_1.7z)

所以基本上，我正在研究一种如何干净地隐藏整个命令提示符并将转码进度链接到我的 gui 中的进度条的方法。

所以这是我的计划，我正在考虑找到一个 win32 api 函数，我可以调用 cmd 行并隐藏它，[从这里的另一个讨论](https://stackoverflow.com/questions/747982/can-ffmpeg-show-a-progress-bar)中，我想我必须阅读日志文件才能获取 ffmpeg 进度信息。

那么我应该为 win32 api 调用哪个函数？有没有人知道更好/更简单的方法来完成这项工作？谢谢

## 更新：

如果有人有兴趣，我会找到一个[很好的类模块，介绍如何将 cmd 输出抓取到我的 vb6 应用程序中，这正是伟大的 joacim](http://www.vbforums.com/showthread.php?t=364219) :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T07:48:23.353

我在 OSX 上为 Java 写了同样的东西。极简逻辑：

*   您需要在生成 ffmpeg 输出时读取它。
*   逐行解析输出（CR 和 LF）
    *   找到“持续时间”行，将时间值存储为整数中的秒数。 *“持续时间：**00** :03:18 .48，开始：0.000000，比特率：274 kb/s”*（CRLF 终止）
    *   从那时起，解析 CR 并查找时间（以秒为单位）完成值。 *“帧= 2816 fps=667 q=11.0 Lsize= 13036kB 时间= **187.66**比特率= 569.1kbits/s”*（CR 终止，无 LF）
    *   做除法（时间/持续时间），你有一个百分比！

我不相信让 ffmpeg 写入日志文件会起作用。至少在 *nix 上，ffmpeg 将此输出写入 std err，并且您需要捕获的状态行没有换行符，因此会覆盖先前的状态行。这是您可以在自己的代码中克服的问题。

抱歉，对 VB6 部分无能为力，但会假设直接从您退出的进程中捕获输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-20T20:27:15.740

首先原谅我的英语我说的是西班牙语。我找到了答案。1/首先放入预设，我有这个例子“输出格式 MPEG2 DVD HQ”

```
-vcodec mpeg2video -vstats_file MFRfile.txt -r 29.97 -s 352x480 -aspect 4:3 -b 4000k -mbd rd -trellis -mv0 -cmp 2 -subcmp 2 -acodec mp2 -ab 192k -ar 48000 -ac 2 
```

这条指令可以让一个 txt 文件不要忘记`-vstats_file Mitxt.txt`像示例一样将命令包含到预设中。这可以在您的文件 Source 的文件夹源中生成一个 ubicadet 的报告。如果你愿意，你可以输入任何名字，然后你可以用这个例子来阅读这个 txt。

```
Private Sub Timer1_Timer()
 Dim strLastLine As String
 'For example my ruta "C:\Documents and Settings\Gortiz\Mis documentos\file.txt"

 strLastLine = ReadLastLineOfFile("C:\Documents and Settings\Gortiz\Mis _ documentos\file.txt")
 Lst1.AddItem strLastLine
End Sub

Function ReadLastLineOfFile(sFileName As String) As String
 Dim objFSO, TS
 Dim sTmpContents As String
 Set objFSO = CreateObject("Scripting.FileSystemObject")
 Set TS = objFSO.OpenTextFile(sFileName, 1)
 sTmpContents = TS.ReadAll
 TS.Close
 Set TS = Nothing
 Set objFSO = Nothing

 ReadLastLineOfFile = Split(sTmpContents, vbCrLf)(UBound(Split(sTmpContents, vbCrLf)) - 1)
End Function 
```

在一个名为的列表框中，`Lst1`您可以看到结果。比特率、处理帧、处理时间（以秒为单位）。ETC

# oracle - 如何保护 Oracle/PostgreSQL 中正在运行的列（某种 MAX 结果锁定或其他东西）

> ID：867388
> 
> 赞同：2
> 
> 时间：2009-05-15T07:25:32.813
> 
> 标签：oracle, postgresql, concurrency, transactions

我需要有关 Oracle/PostgreSQL 的以下情况的建议：

我有一个带有“运行计数器”的数据库表，并希望在以下情况下使用两个并发事务来保护它：

```
T1                      T2
SELECT MAX(C) FROM TABLE WHERE CODE='xx'
-- C for new : result + 1
                        SELECT MAX(C) FROM TABLE WHERE CODE='xx';
                        -- C for new : result + 1
                        INSERT INTO TABLE... 
INSERT INTO TABLE... 
```

因此，在这两种情况下，INSERT 的列值都是根据旧结果加一来计算的。

由此，数据库处理的一些运行计数器会很好。但这行不通，因为

*   计数器值或现有行有时会更改
*   有时我希望有多个计数器“值组”（如提到的 CODE）：使用不同的 CODE 值，计数器将是独立的。

对于其他一些数据库，这可以使用 SERIALIZABLE 隔离状态来处理，但至少使用 Oracle&Postgre 可以防止幻读，但结果表最终会出现两个具有相同计数器值的不同行。这似乎与谓词锁定有关，锁定“查询覆盖的所有可能行” - 其他一些 db:s 最终会锁定整个表或其他东西..

SELECT ... FOR UPDATE -语句似乎用于其他目的，甚至似乎不适用于 MAX() -函数。

在列上设置 UNIQUE 约束可能是解决方案，但还有其他方法可以防止这种情况吗？

br Touko

编辑：另一种选择可能是手动锁定，即使它对我来说并不好..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T08:12:54.870

[Oracle](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_6015.htm)和[PostgreSQL](http://www.postgresql.org/docs/current/static/functions-sequence.html)都支持所谓的序列，非常适合您的问题。您可以有一个常规的 int 列，但为每组定义一个序列，并执行单个查询，例如

```
--PostgreSQL
insert into table (id, ... ) values (nextval(sequence_name_for_group_xx), ... )

--Oracle
insert into table (id, ... ) values (sequence_name_for_group_xx.nextval, ... ) 
```

序列的增量是原子的，所以你的问题就不存在了。只需创建所需的序列，每组一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T09:54:33.237

> *   计数器值或现有行有时会更改

如果这对您的应用程序来说是个问题，您应该对该列设置唯一约束。这样做可以保证 SERIALIZABLE 隔离级别的事务在尝试使用与另一个事务相同的 id 时会中止。

> 另一种选择可能是手动锁定，即使它对我来说并不好......

在这种情况下手动锁定非常简单：只需在选择最大值之前对表进行 SHARE UPDATE EXCLUSIVE 或更强大的锁定。不过，这会扼杀并发性能。

> *   有时我希望有多个计数器“值组”（如提到的 CODE）：使用不同的 CODE 值，计数器将是独立的。

这使我找到了解决此问题的正确方法：序列。设置几个序列，一个用于您想要在其自己的范围内获取 ID 的每个“值组”。有关序列的详细信息以及如何使用它们，请参见[手册的第 9.15 节；](http://www.postgresql.org/docs/8.3/interactive/functions-sequence.html)看起来它们非常适合您。序列永远不会两次给出相同的值，但可能会跳过值：如果事务从序列中获取值“2”并中止，则下一个事务将获得值“3”而不是“2”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T01:05:52.430

序列答案很常见，但可能不正确。该解决方案的可行性取决于您的实际需求。如果您在语义上想要的是“一些保证是唯一的数字”，那么这就是序列的用途。但是，如果您想要确保每次插入时您的值恰好增加一（如您所要求的），那么不要使用序列！我已经在自己之前遇到了这个陷阱。序列不保证是连续的！他们可以跳过数字。根据您配置的优化类型，他们可以跳过很多数字。即使您的配置恰到好处，以至于您不应该跳过任何数字，这也不能保证，也不是序列的用途。因此，如果您（误）那样使用它们，您只会自找麻烦。

一个更好的解决方案是将选择捆绑到插入中，如下所示：

```
INSERT INTO table(code, c, ...) 
VALUES ('XX', (SELECT MAX(c) + 1 AS c FROM table WHERE code = 'XX'), ...); 
```

（我没有测试运行该查询，但我很确定它应该可以工作。如果没有，我很抱歉。）但是，做这样的事情反映了你正在尝试做的事情的语义意图。但是，这是低效的，因为您必须对 MAX 进行扫描，而我从您的样本中得出的推论是，相对于表的大小，您的代码值数量很少，因此您将执行每次插入都要进行昂贵的全表扫描。那不好。此外，这甚至不能为您提供您正在寻找的 ACID 保证。选择与插入无关。您不能“锁定” MAX() 函数的结果。因此，您仍然可以有两个事务运行此查询，并且它们都执行子选择并获得相同的最大值，都添加一个，然后都尝试插入。它'

最终，如果您尝试在插入时增加，我会挑战您可能有错误的数据模型。您应该使用唯一键插入，最常见的是序列值（至少作为任何自然键的简单代理键）。这样可以安全地插入数据。然后，如果您需要对事物进行计数，请使用一张表来存储您的计数。

```
CREATE TABLE code_counts (
    code VARCHAR(2), --or whatever
    count NUMBER
); 
```

如果您真的想在插入时存储每个项目的代码计数，单独的计数表还允许您以事务方式正确执行此操作，如下所示：

```
UPDATE code_counts SET count = count + 1 WHERE code = 'XX' RETURNING count INTO :count;
INSERT INTO table(code, c, ...) VALUES ('XX', :count, ...);
COMMIT; 
```

关键是更新会锁定计数器表并为您保留该值。然后您的插入使用该值。所有这些都作为一个事务性更改提交。您必须在事务中执行此操作。拥有一个单独的计数表可以避免做的全表扫描`SELECT MAX()...`。从本质上讲，这样做是重新实现了一个序列，但它也保证了你按顺序、有序的使用。

在不了解您的整个问题域和数据模型的情况下，很难说，但是将您的计数抽象到这样的单独表中，您不必执行 select max 来获得正确的值可能是一个好主意。当然，假设计数是您真正关心的。如果您只是在做日志记录或想要确保事物唯一的事情，那么请使用序列和时间戳进行排序。

请注意，我是说不要按顺序排序。基本上，**永远不要相信序列是唯一的**。因为当您在多节点系统上缓存序列值时，您的应用程序甚至可能会乱序使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T07:48:15.863

这就是为什么您应该使用 Serial 数据类型，它将 C 的查找推迟到插入时间（我假设它使用表锁）。然后您不会指定 C，但它会自动生成。如果您需要 C 进行一些中间计算，则需要先保存，然后读取 C，最后使用派生值进行更新。

编辑：对不起，我没有阅读你的整个问题。用规范化解决你的其他问题怎么样？只需为每个特定类型创建第二个表（对于每个 x，其中 A='x'），您还有另一个自动增量。手动编辑的序列可以是同一个表中的另一列，它使用生成的序列作为基础（即如果 pk = 34，您可以有另一列 mypk='34Changed'）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T22:27:33.733

您可以使用序列作为默认值来创建顺序列：

首先，您必须创建序列计数器：

```
CREATE SEQUENCE SEQ_TABLE_1 START WITH 1 INCREMENT BY 1; 
```

因此，您可以将其用作默认值：

```
CREATE TABLE T (
  COD NUMERIC(10)  DEFAULT NEXTVAL('SEQ_TABLE_1') NOT NULL,
  collumn1...
  collumn2...
); 
```

现在您无需担心插入行的顺序：

```
INSERT INTO T (collumn1, collumn2) VALUES (value1, value2); 
```

问候。

# python - Python 等语言如何克服 C 的 Integral 数据限制？

> ID：867393
> 
> 赞同：2
> 
> 时间：2009-05-15T07:26:49.987
> 
> 标签：python, c, types, integer

在用 C、Python 和 Scheme 中的阶乘程序做一些随机实验时。我遇到了这个事实：

在 C 中，使用“unsigned long long”数据类型，我可以打印的最大阶乘是 65。即“9223372036854775808”，即 [此处](http://en.wikipedia.org/wiki/Integer_(computer_science)#Common_integral_data_types)指定的 19 位。

在 Python 中，我可以找到一个大到 999 的数字的阶乘，它由大量数字组成，比 19 多得多。

CPython 是如何实现这一点的？它是否使用像“[八字](http://en.wikipedia.org/wiki/Integer_(computer_science)#Common_integral_data_types)”这样的数据类型？

我可能在这里遗漏了一些基本事实。因此，我将不胜感激阅读一些见解和/或参考资料。谢谢！

更新：谢谢大家的解释。这是否意味着，CPython 正在使用 GNU 多精度库（或其他类似库）？

更新 2：我在源代码中寻找 Python 的“bignum”实现。它究竟在哪里？它在[http://svn.python.org/view/python/trunk/Objects/longobject.c?view=markup](http://svn.python.org/view/python/trunk/Objects/longobject.c?view=markup)。谢谢白沙帕扬。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-15T07:33:02.453

它被称为*任意精度算术*。这里还有更多：[http ://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T19:32:03.020

查看 Python 源代码，似乎`long`类型（至少在 Python 3 之前的代码中）是在[longintrepr.h](http://svn.python.org/view/python/trunk/Include/longintrepr.h?view=markup)中定义的，如下所示 -

```
/* Long integer representation.
   The absolute value of a number is equal to
    SUM(for i=0 through abs(ob_size)-1) ob_digit[i] * 2**(SHIFT*i)
   Negative numbers are represented with ob_size < 0;
   zero is represented by ob_size == 0.
   In a normalized number, ob_digit[abs(ob_size)-1] (the most significant
   digit) is never zero.  Also, in all cases, for all valid i,
    0 <= ob_digit[i] <= MASK.
   The allocation function takes care of allocating extra memory
   so that ob_digit[0] ... ob_digit[abs(ob_size)-1] are actually available.

   CAUTION:  Generic code manipulating subtypes of PyVarObject has to
   aware that longs abuse  ob_size's sign bit.
*/

struct _longobject {
    PyObject_VAR_HEAD
    digit ob_digit[1];
}; 
```

然后通过创建一个新类型 PyLongObject 像这样在[longobject.h](http://svn.python.org/view/python/trunk/Include/longobject.h?view=markup)`long`中定义该类型的实际可用接口-

```
typedef struct _longobject PyLongObject; 
```

等等。

[longobject.c](http://svn.python.org/view/python/trunk/Objects/longobject.c?view=markup)内部发生了更多事情，您可以查看这些以获取更多详细信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T07:34:43.277

诸如`int`C 中的数据类型直接映射（或多或少）到处理器支持的数据类型。因此，对 C 的`int`限制本质上是处理器硬件施加的限制。

但是可以完全在软件中实现自己的`int`数据类型。例如，您可以使用数字数组作为基础表示。可能是这样的：

```
class MyInt {
    private int [] digits;
    public MyInt(int noOfDigits) {
       digits = new int[noOfDigits];
    }
} 
```

一旦你这样做了，你就可以使用这个类并存储包含任意数量数字的整数，只要你不耗尽内存。

也许 Python 在它的虚拟机中做了类似的事情。您可能想阅读[这篇](http://en.wikipedia.org/wiki/Arbitrary_precision)关于任意精度算术的文章以获取详细信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T07:32:07.853

不是八字。它实现了[bignum](http://en.wikipedia.org/wiki/Bignum)结构来存储任意精度的数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T07:30:36.577

Python 为`long`整数（`int`Python 3 中的所有 s）分配所需的空间——根据需要分配的“数字”数组（基数是 2 的幂）。

# c# - 获取填充了 DataSource 的 ComboBox 的项目

> ID：867395
> 
> 赞同：3
> 
> 时间：2009-05-15T07:27:18.427
> 
> 标签：c#, winforms, .net-2.0, controls, combobox

考虑有一个通过其 DataSource 属性填充的 ComboBox。ComboBox 中的每个项目都是一个自定义对象，并且 ComboBox 使用`DisplayMember`和设置`ValueMember`。

```
IList<CustomItem> aItems = new List<CustomItem>();
//CustomItem has Id and Value and is filled through its constructor
aItems.Add(1, "foo"); 
aItems.Add(2, "bar");

myComboBox.DataSource = aItems; 
```

现在的问题是，我想将项目读取为将在 UI 中呈现的字符串。考虑到我不知道 ComboBox 中每个项目的类型（我不知道`CustomItem`）

这可能吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T07:33:47.567

捆绑：

```
ComboBox1.DataSource = aItems;
ComboBox1.DisplayMember = "Value"; 
```

获取物品：

```
CustomItem ci = ComboBox1.SelectedValue as CustomItem; 
```

编辑：如果您想要获得的只是组合框所有显示值的列表

```
List<String> displayedValues = new List<String>();
foreach (CustomItem ci in comboBox1.Items)
    displayedValues.Add(ci.Value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T07:34:15.540

例如，创建一个接口，`ICustomFormatter`并让那些自定义对象实现它。

```
interface ICustomFormatter
{
   public string ToString();
} 
```

然后调用`ToString()`方法。

编辑：链接到[装饰器](http://www.dofactory.com/Patterns/PatternDecorator.aspx)模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T07:42:01.870

您应该能够通过反射获得 ValueMember 和 DisplayMember。但是询问组合框可能会更容易一些。以下将起作用，但也许您想用 SuspendUpdate 或其他东西包围它。

```
string s = string.Empty;
int n = comboBox1.Items.Count;

for (int i = 0; i < n; i++)
{
    comboBox1.SelectedIndex = i;
    s = s + ';' + comboBox1.Text; // not SelectedText;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-03T14:38:18.020

尽管计算成本稍高，但反射可以做你想做的事：

```
using System.Reflection;    
private string GetPropertyFromObject(string propertyName, object obj)
    {
        PropertyInfo pi = obj.GetType().GetProperty(propertyName);
        if(pi != null)
        {
            object value = pi.GetValue(obj, null);
            if(value != null)
            {
                return value.ToString();
            }
        }
        //return empty string, null, or throw error
        return string.Empty;
    } 
```

# svn - svn - 远程，断开连接的工作

> ID：867401
> 
> 赞同：4
> 
> 时间：2009-05-15T07:29:07.547
> 
> 标签：svn, tortoisesvn

我们使用 svn，我将开始在家工作。我的想法是带上我的笔记本电脑，检查项目并将其带回家，然后在周一返回并反转该过程。

但它是一台笨重的笔记本电脑，我不喜欢骑着它背着它工作。

是否可以改为：

1.  创建第二个 Windows/SVN 用户“MeRemote”
2.  将项目签出到“MeRemote”下的另一个位置
3.  将这些文件复制到 U 盘
4.  将磁盘带回家，“本地”处理文件
5.  周一返回，复制“MeRemote”签出项目
6.  “MeRemote”提交对 repo 的更改
7.  “RealMe”更新更改。

这样，当我在办公室/家中工作时，所有内容都会被记录和标记，我不必拖着沉重的笔记本电脑四处走动，并且源代码控制保持一致。

这是正确的方法吗？在我进入另一个 SVN 痛苦的世界之前检查一下。

我们正在使用 SVN、VisualSVN 服务器、Visual SVN 客户端和 TortoiseSVN。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T07:35:10.840

## 简单的方法

这是使用 SVN 的正常过程：

1.  您可以直接在拇指驱动器上下载项目，方法是在拇指驱动器上进行**结帐**。
2.  随身携带拇指驱动器，随时随地使用它（例如，您在家中的笔记本电脑）。
3.  当您返回使用拇指驱动器工作时，您可以**更新**代码，然后将其全部**提交到存储库中。**

当您使用工作登录更新更改时，它将显示谁更改并签入了文件。您唯一的麻烦是修复可能出现的合并冲突。

## 需要本地提交？

如果您需要仅在拇指驱动器上进行*本地提交*，则可以通过在拇指驱动器上创建新的 svn 存储库来实现。但是，您需要在拇指驱动器上的存储库和工作存储库之间复制文件。

[您还可以使用Alex Martelli](https://stackoverflow.com/questions/867401/svn-remote-disconnected-working/867412#867412)指出的分布式版本控制进行本地提交，这是通过将存储库克隆到您的拇指驱动器然后将其同步回 svn 来完成的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T10:04:09.687

Subversion 假设文件戳至少有 1 秒的精度来检查文件是否已更改，但大多数 USB 驱动器上的 FAT 文件系统仅支持 2 秒的精度。从理论上讲，它可能会在更新、提交等之后的第一秒内错过文件中的更改。

我建议将您的 USB 驱动器格式化为 NTFS 以解决此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T08:09:05.410

我想你可能对[SVK感兴趣](http://svk.elixus.org/view/HomePage)

```
svk is a decentralized version control system built with the robust Subversion filesystem. It supports repository mirroring, disconnected operation, history-sensitive merging, and integrates with other version control systems, as well as popular visual merge tools. 
```

[您可以在此处](http://www.newartisans.com/2007/09/an-svk-primer.html)找到描述使用和工作流程的博客文章

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T07:33:08.693

在你的鞋子里，我会使用 DVCS（比如 Mercurial）和它附带的工具来与 svn 顺利互操作，参见例如[https://www.mercurial-scm.org/wiki/WorkingWithSubversion](https://www.mercurial-scm.org/wiki/WorkingWithSubversion)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T07:37:20.803

您可以使用 RealYou 将项目签出到您的情况下的不同位置，即 USB 驱动器。然后，您可以在家中处理它，并在周一回来时从 USB 驱动器提交更改。

您不需要单独的用户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T07:40:15.510

您可以只导出您的项目（没有 .svn 子文件夹的相同 fs 结构）并离线工作。重新开始工作时，只需复制您的开发路径，然后提交。

可以使用简单的 vpn（使用 openvpn 来完成您的要求）在家工作，而无需随身携带您的项目。这允许完整的 scm 功能（提交、恢复、历史记录等），对我来说是正确的方式。

# recursion - 你如何在 Erlang 中编写一个有趣的递归函数？

> ID：867418
> 
> 赞同：38
> 
> 时间：2009-05-15T07:35:42.603
> 
> 标签：recursion, erlang

我正在尝试在 Erlang shell 中编写递归乐趣，但我不断收到未绑定的变量异常：

```
1> Foo = fun(X) -> Foo(X) end.
* 1: variable 'Foo' is unbound 
```

这可能不言而喻，但我并不是要创建一个无限循环！这只是我遇到的错误的一个简单示例。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-15T08:12:31.330

自[OTP 17.0](http://www.erlang.org/download_release/24)以来，有命名的乐趣：

```
1> Perms = fun F([]) -> [[]]; F(L) -> [[H|T] || H <- L, T <- F(L--[H])] end.    
#Fun<erl_eval.30.54118792>
2> Perms([a,b,c]).
[[a,b,c],[a,c,b],[b,a,c],[b,c,a],[c,a,b],[c,b,a]] 
```

在此之前，您可以通过一些参数技巧来做到这一点：

```
1> Foo = fun(F, X) -> F(F, X) end.
#Fun<erl_eval.12.113037538>
2> Foo(Foo, a).
<...infinite loop!> 
```

这里的技巧是将函数作为参数发送给自身以允许递归。

一次拍摄的另一种方法：

```
1> Foo = fun(X) -> Fun = fun(F,Y) -> F(F,Y) end, Fun(Fun,X) end.
#Fun<erl_eval.6.13229925>
2> Foo(a). 
```

例如：

```
1> Foo = fun(Max) ->
1>     Fun = fun(F, X) when X > Max -> [];
1>              (F, X) -> [X | F(F, X+1)]
1>           end,
1>     Fun(Fun, 0)
1> end.
#Fun<erl_eval.6.13229925>
2> Foo(10).
[0,1,2,3,4,5,6,7,8,9,10] 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-05-02T08:14:02.850

在 Erlang 17 之后，您还可以使用[“Funs with names”](https://stackoverflow.com/questions/23199177/funs-names-in-erlang-17)变体：

```
Foo = fun F(X) -> F(X) end. 
```

这样更容易理解`F`定义中的函数本身。此外，`Foo`和`F`可以是同一个变量。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-15T12:47:46.737

或者，您可以使用 Y 组合器。[Erlang 中的 Y Combinator](http://bc.tech.coop/blog/070611.html)解释道。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-09T21:29:16.027

我需要通过 UDP 快速发送一些数据包进行测试，下面是我使用上面的示例完成它的方法：

```
Sendtimes = fun F(0,Socket) -> ok;
        F(Times,Socket) -> gen_udp:send(Socket, {127,0,0,1}, 5555, ["Message #:" ++ [Times]]),
        F(Times-1,Socket) end. 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-15T07:51:02.910

显然， Foo 仅在 fun 定义后才被分配，因此可能无法从其中访问它。

我不认为 Erlang 允许从自身调用匿名函数。只是把它命名为一个。

# asp.net - ASP.NET GridView 问题

> ID：867431
> 
> 赞同：1
> 
> 时间：2009-05-15T07:42:56.767
> 
> 标签：asp.net

好吧，我有一个 gridview，我自己定义了列并关闭了自动生成，但现在我遇到了无法访问 GridView.SelectedRow.DataItem 的问题。

因为它现在是空的，当它在自动生成打开时有一个值时..

编辑：我需要一种方法来保存行的 ID，而不向用户显示 ID，所以如果有任何方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T07:46:32.890

我猜只有在您使用 DataBinding 时才能正确填充 DataItem。你在使用数据绑定吗？

好的，从这个[网址](http://forums.asp.net/t/903560.aspx)：

> GridView（实际上是我们所有的数据控件）不会跨回发保存数据项。这会减少 ViewState（如果对象甚至是可序列化的）并使垃圾收集发生并清理您的对象。因此，当您单击按钮回发时，GridView 没有调用 DataBind，因此您的数据项不存在。这就是你所发现的。

猜测您正在从回发中读取值，可能只是问题所在。

如果您已经为项目设置了（主）键，请尝试使用 SelectedValue。我一直使用它并且它有效。 [msdn 关于 SelectedValue](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.selectedvalue(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T08:00:18.160

您可以创建一个新的隐藏模板列，该列将具有 ID 的标签。并在 cs 文件中对行使用 .FindControl 。

您在 gridview 上也有[DataKeys](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeys.aspx)属性，我认为女巫也可以满足您的需求

# python - 数字比较 - Python Bug？

> ID：867436
> 
> 赞同：1
> 
> 时间：2009-05-15T07:45:07.540
> 
> 标签：python, numbers

在我的代码深处，在一个嵌套的 if 中，在一个嵌套的类方法中，我将某个索引值与某个列表的长度进行比较，以验证我可以访问该索引。代码看起来像这样：

```
if t.index_value < len(work_list):
    ... do stuff ...
else:
    ... print some error ... 
```

为澄清起见，`index_value`至少为零（在其他地方验证）。令我惊讶的是，即使我知道`index_value`数据是有效的，代码仍会继续执行“else:”子句。我添加了一些临时调试代码：

```
print('Checking whether '+str(t.index_value)+"<"+str(len(work_list)))

x = t.index_value
y = len(work_list)

print(x)
print(y)
print(x<y)

if t.index_value < len(work_list):
    ... do stuff ...
else:
    ... print some error ... 
```

以下是输出：

```
>> Checking whether 3<4
>> 3
>> 4
>> False 
```

谁能帮我理解这里发生了什么？

进一步说明：

*   work_list 是在方法内实例化的局部变量
*   t 是一个类实例，在方法 ( `t = SomeClass()`)中实例化

* * *

更新：问题是类型`t.index_value`是 UNICODE 而不是 int。原因是我从文本文件中反序列化了 t 的内容，其中 index_value 的值由单个数字字符表示。从文本中提取后，我立即将其分配给`index_value`，而没有通过我应该做的 int() 传递它，这解决了问题。

我决定保留“有争议”的标题，尽管它显然是我的错误而不是 Python 的错误，因为有同样问题的人可能会使用这个标题找到它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T07:51:05.733

根据我的经验，“t.index_value”的类型是什么？也许它是一个字符串“3”。

```
>>> print '3' < 4
False 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T08:07:11.543

要显示可能与您期望的类型不同的值（例如，字符串而不是数字，如 kcwu 建议`repr(x)`的那样），请使用等。

# iphone - iPhone 上 CALayerCollectLayers_ 中的 EXC_BAD_ACCESS

> ID：867437
> 
> 赞同：1
> 
> 时间：2009-05-15T07:45:16.543
> 
> 标签：iphone, crash

在设备上运行时：

```
Program received signal:  “EXC_BAD_ACCESS”. 
```

调试器：

```
#0  0x31e11158 in CALayerCollectLayers_
#1  0x31e11180 in CALayerCollectLayers_
#2  0x31e11180 in CALayerCollectLayers_
#3  0x31dd7428 in CALayerDisplayIfNeeded
#4  0x31dd5780 in CAContextCommitTransaction
#5  0x31dd543c in CATransactionCommit
#6  0x3026a0ec in __CFRunLoopDoObservers
#7  0x30269418 in CFRunLoopRunSpecific
#8  0x30269326 in CFRunLoopRunInMode
#9  0x306941fe in -[NSRunLoop(NSRunLoop) runMode:beforeDate:]
#10 0x30694f9a in -[NSRunLoop(NSRunLoop) run]
#11 0x0000319e in -[AppController createInStreamThread] at AppController.m:395
#12 0x30672e08 in -[NSThread main]
#13 0x30672cd6 in __NSThread__main__
#14 0x3146178c in _pthread_body 
```

在模拟器中运行时：

```
modifying layer that is being finalized - 0x52f2b0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T08:50:19.287

这种类型的缺陷很难追踪。我很高兴你这么快就找到了。幸运的是，有一些很好的工具可以帮助您。

首先，使用[clang 静态语言分析](http://clang.llvm.org/StaticAnalysisUsage.html#BasicUsage)它可以发现这种缺陷，而无需您运行代码。

如果您在那之后遇到此缺陷，请打开[NSZombies](https://stackoverflow.com/questions/535060/how-to-add-nsdebug-h-and-use-nszombie-in-iphone-sdk)、 MallocStackLogging 和 MallocStackLoggingNoCompact 然后使用[malloc_history](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man1/malloc_history.1.html)查找执行分配的位置。它并不完美，但它有很大的帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T07:48:08.157

事实证明，我过度释放了一个 UIButton。

```
UIButton *button = [self buttonWith...];
...
[self addSubview:button];
[button release]; 
```

但是 [self buttonWith...] 返回了一个自动释放的按钮，所以我的释放不应该在那里。删除该行修复了崩溃。

# javascript - 释放 Javascript 对象使用的内存

> ID：867441
> 
> 赞同：5
> 
> 时间：2009-05-15T07:47:05.803
> 
> 标签：javascript, arrays, garbage-collection

我应该自己释放分配的内存，还是有一种垃圾收集器？

可以在 JavaScript 中使用以下代码吗？

```
function fillArray()
{
  var c = new Array;
  c.push(3);
  c.push(2);
  return c;
}

var arr = fillArray();
var d = arr.pop() 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T07:50:39.667

引用自[Apple JavaScript 编码指南](http://developer.apple.com/DOCUMENTATION/ScriptingAutomation/Conceptual/JSCodingGuide/Advanced/Advanced.html)：

> 使用删除语句。每当您使用新语句创建对象时，请将其与删除语句配对。这可确保与对象关联的所有内存（包括其属性名称）都可用于垃圾回收。删除语句在“释放对象”中有更多讨论。</p>

这将建议您使用`delete`命令允许垃圾收集器`Array`在您完成使用它时释放为您分配的内存。`delete`值得注意的是，该语句仅删除引用，因为它与 C/C++ 中的行为不同，后者没有垃圾收集并`delete`立即释放内存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T07:53:03.683

变量`arr`和`d`将作为全局变量存在，直到被垃圾收集器收集为止。

这些变量将被设置为全局对象的属性，即`window`在浏览器环境中，但由于它们是用 声明的`var`，[因此它们不能从全局对象中删除。](http://perfectionkills.com/understanding-delete)

在您的特定情况下，最好的做法可能是`null`在您完成变量后分配给它们。您可能还想考虑将它们的作用域包含在一个函数中，并在该函数中执行您需要对它们执行的操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-25T14:39:44.573

JavaScript 中的内存管理是自动的，并且有一个垃圾收集器 (GC)。

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Memory_Management](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Memory_Management)

您不能显式删除变量`d`和`arr`，但可以通过将变量设置为其他值来删除对其值的引用，例如`null`，以允许 GC 将它们从内存中删除。

```
arr = null;
d = null; 
```

请注意，该`delete`关键字仅删除对象属性。

# java - 比较几个 javabean 属性的最佳方法是什么？

> ID：867442
> 
> 赞同：16
> 
> 时间：2009-05-15T07:47:18.130
> 
> 标签：java, reflection

我需要比较两个对象（同一类的实例）中的数十个字段，并进行一些记录和更新以防有差异。元代码可能看起来像这样：

```
if (a.getfield1 != b.getfield1)
  log(a.getfield1 is different than b.getfield1)
  b.field1 = a.field1

if (a.getfield2!= b.getfield2)
  log(a.getfield2 is different than b.getfield2)
  b.field2 = a.field2

...

if (a.getfieldn!= b.getfieldn)
  log(a.getfieldn is different than b.getfieldn)
  b.fieldn = a.fieldn 
```

包含所有比较的代码非常简洁，我想以某种方式使其更紧凑。如果我可以有一个方法，它将作为参数调用 setter 和 getter，并为所有字段调用它，但不幸的是，这对于 java 是不可能的。

我提出了三个选项，每个选项都有自己的缺点。

**1\. 使用反射 API 找出 getter 和 setter**
丑陋，如果字段名称更改可能会导致运行时错误

**2\. 将字段更改为 public 并直接操作它们而不使用 getter 和 setter**
Ugly 并且会将类的实现暴露给外部世界

**3\. 让包含类（实体）进行比较，更新更改的字段并返回日志消息**
实体不应该参与业务逻辑

所有字段都是字符串类型，如果需要，我可以修改拥有这些字段的类的代码。

编辑：类中有一些字段不能比较。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-15T08:48:07.657

使用[注释](http://java.sun.com/j2se/1.5.0/docs/guide/language/annotations.html)。

如果把需要比较的字段标记出来（不管是私有的，还是不丢封装，然后拿到那些字段，比较一下。可能是这样的：

在需要比较的类中：

```
@ComparableField 
private String field1;

@ComparableField
private String field2;

private String field_nocomparable; 
```

在外部类中：

```
public <T> void compare(T t, T t2) throws IllegalArgumentException,
                                          IllegalAccessException {
    Field[] fields = t.getClass().getDeclaredFields();
    if (fields != null) {
        for (Field field : fields) {
            if (field.isAnnotationPresent(ComparableField.class)) {
                field.setAccessible(true);
                if ( (field.get(t)).equals(field.get(t2)) )
                    System.out.println("equals");
                field.setAccessible(false);
            }
        }
    }
} 
```

代码未经测试，但如果有帮助，请告诉我。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T09:13:01.293

[JavaBeans API](http://java.sun.com/javase/6/docs/api/java/beans/package-summary.html)旨在帮助自省。自 Java 1.2 版以来，它一直以一种或另一种形式出现，并且自 1.4 版以来一直非常有用。

比较两个 bean 中的属性列表的演示代码：

```
 public static void compareBeans(PrintStream log,
      Object bean1, Object bean2, String... propertyNames)
      throws IntrospectionException,
      IllegalAccessException, InvocationTargetException {
    Set<String> names = new HashSet<String>(Arrays
        .asList(propertyNames));
    BeanInfo beanInfo = Introspector.getBeanInfo(bean1
        .getClass());
    for (PropertyDescriptor prop : beanInfo
        .getPropertyDescriptors()) {
      if (names.remove(prop.getName())) {
        Method getter = prop.getReadMethod();
        Object value1 = getter.invoke(bean1);
        Object value2 = getter.invoke(bean2);
        if (value1 == value2
            || (value1 != null && value1.equals(value2))) {
          continue;
        }
        log.format("%s: %s is different than %s%n", prop
            .getName(), "" + value1, "" + value2);
        Method setter = prop.getWriteMethod();
        setter.invoke(bean2, value2);
      }
    }
    if (names.size() > 0) {
      throw new IllegalArgumentException("" + names);
    }
  } 
```

示例调用：

```
compareBeans(System.out, bean1, bean2, "foo", "bar"); 
```

如果您走注释路线，请考虑转储反射并使用编译时[注释处理器](http://java.sun.com/javase/6/docs/api/javax/annotation/processing/Processor.html)或其他代码生成器生成比较代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T08:22:52.130

我会选择选项 1，但我会使用`getClass().getDeclaredFields()`来访问字段而不是使用名称。

```
public void compareAndUpdate(MyClass other) throws IllegalAccessException {
    for (Field field : getClass().getDeclaredFields()) {
        if (field.getType() == String.class) {
            Object thisValue = field.get(this);
            Object otherValue = field.get(other);
            // if necessary check for null
            if (!thisValue.equals(otherValue)) {
                log(field.getName() + ": " + thisValue + " <> " + otherValue);
                field.set(other, thisValue);
            }
        }
    }
} 
```

这里有一些限制（如果我是对的）：

*   compare 方法必须在同一个类中实现（我认为它应该——不管它的实现如何）而不是在外部类中。
*   只使用这个类的字段，而不是超类的字段。
*   必须处理 IllegalAccessException（我只是在上面的示例中抛出它）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T07:57:35.000

这可能也不太好，但它远没有你提出的两种选择中的任何一种邪恶（恕我直言）。

如何提供一个获取数字索引字段的单个 getter/setter 对，然后让 getter/setter 将索引字段取消引用到相关的成员变量？

IE：

```
public class MyClass {
    public void setMember(int index, String value) {
        switch (index) {
           ...
        }
    }

    public String getMember(int index) {
        ...
    }

    static public String getMemberName(int index) {
        ...
    }
} 
```

然后在您的外部课程中：

```
public void compareAndUpdate(MyClass a, MyClass b) {
    for (int i = 0; i < a.getMemberCount(); ++i) {
        String sa = a.getMember();
        String sb = b.getMember();
        if (!sa.equals(sb)) {
            Log.v("compare", a.getMemberName(i));
            b.setMember(i, sa);
        }
    }
} 
```

这至少允许您将所有重要的逻辑保留在正在检查的类中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T07:58:05.810

虽然选项 1 可能很难看，但它可以完成工作。选项 2 更丑陋，并且会使您的代码暴露在您无法想象的漏洞中。即使您最终排除了选项 1，我也祈祷您保留现有代码，不要选择选项 2。

话虽如此，如果您不想将其作为静态列表传递给方法，则可以使用反射来获取类的字段名称列表。假设您要比较所有字段，则可以在循环中动态创建比较。

如果不是这种情况，并且您比较的字符串只是一些字段，您可以进一步检查这些字段并仅隔离那些类型为 的字段`String`，然后继续进行比较。

希望这可以帮助，

尤瓦尔=8-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T09:41:12.473

自从

> 所有字段都是字符串类型，如果需要，我可以修改拥有这些字段的类的代码。

你可以试试这个类：

```
public class BigEntity {

    private final Map<String, String> data;

    public LongEntity() {
        data = new HashMap<String, String>();
    }

    public String getFIELD1() {
        return data.get(FIELD1);
    }

    public String getFIELD2() {
        return data.get(FIELD2);
    }

    /* blah blah */
    public void cloneAndLogDiffs(BigEntity other) {
        for (String field : fields) {
            String a = this.get(field);
            String b = other.get(field);

            if (!a.equals(b)) {
                System.out.println("diff " + field);
                other.set(field, this.get(field));
            }
        }
    }

    private String get(String field) {
        String value = data.get(field);

        if (value == null) {
            value = "";
        }

        return value;
    }

    private void set(String field, String value) {
        data.put(field, value);
    }

    @Override
    public String toString() {
        return data.toString();
    } 
```

魔术代码：

```
 private static final String FIELD1 = "field1";
    private static final String FIELD2 = "field2";
    private static final String FIELD3 = "field3";
    private static final String FIELD4 = "field4";
    private static final String FIELDN = "fieldN";
    private static final List<String> fields;

    static {
        fields = new LinkedList<String>();

        for (Field field : LongEntity.class.getDeclaredFields()) {
            if (field.getType() != String.class) {
                continue;
            }

            if (!Modifier.isStatic(field.getModifiers())) {
                continue;
            }

            fields.add(field.getName().toLowerCase());
        }
    } 
```

这个类有几个优点：

*   反映一次，在类加载
*   添加新字段非常简单，只需添加新的静态字段（这里更好的解决方案是使用注释：如果您关心使用反射也可以使用 java 1.4）
*   你可以在一个抽象类中重构这个类，所有派生类都只获取
    数据和 cloneAndLogDiffs()
*   外部接口是类型安全的（你也可以很容易地强加不变性）
*   没有[setAccessible](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/reflect/AccessibleObject.html#setAccessible(boolean))调用：这种方法有时会出现问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T08:55:09.993

我也会提出与 Alnitak 类似的解决方案。

如果比较时需要对字段进行迭代，为什么不放弃单独的字段，将数据放入数组，HashMap或类似的东西中。

然后您可以以编程方式访问它们，比较它们等。如果需要以不同的方式处理和比较不同的字段，您可以为实现接口的值创建适当的帮助器类。

然后你可以做

```
valueMap.get("myobject").compareAndChange(valueMap.get("myotherobject") 
```

或类似的规定...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T09:12:24.647

一个广泛的想法：

创建一个新类，其对象接受以下参数：要比较的第一个类，要比较的第二个类，以及对象的 getter 和 setter 方法名称列表，其中仅包含感兴趣的方法。

您可以通过反射查询对象的类，并从中查询其可用方法。假设参数列表中的每个 getter 方法都包含在类的可用方法中，您应该能够调用该方法来获取值进行比较。

粗略地勾勒出类似的东西（如果它不是超级完美的话，请道歉......不是我的主要语言）：

```
public class MyComparator
{
    //NOTE: Class a is the one that will get the value if different
    //NOTE: getters and setters arrays must correspond exactly in this example
    public static void CompareMyStuff(Object a, Object b, String[] getters, String[] setters)
    {
        Class a_class = a.getClass();
        Class b_class = b.getClass();

        //the GetNamesFrom... static methods are defined elsewhere in this class
        String[] a_method_names = GetNamesFromMethods(a_class.getMethods());
        String[] b_method_names = GetNamesFromMethods(b_class.getMethods());
        String[] a_field_names = GetNamesFromFields(a_class.getFields());

        //for relative brevity...
        Class[] empty_class_arr = new Class[] {};
        Object[] empty_obj_arr = new Object[] {};

        for (int i = 0; i < getters.length; i++)
        {
            String getter_name = getter[i];
            String setter_name = setter[i];

            //NOTE: the ArrayContainsString static method defined elsewhere...
            //ensure all matches up well...
            if (ArrayContainsString(a_method_names, getter_name) &&
                ArrayContainsString(b_method_names, getter_name) &&
                ArrayContainsString(a_field_names, setter_name)
            {
                //get the values from the getter methods
                String val_a = a_class.getMethod(getter_name, empty_class_arr).invoke(a, empty_obj_arr);
                String val_b = b_class.getMethod(getter_name, empty_class_arr).invoke(b, empty_obj_arr);
                if (val_a != val_b)
                {
                    //LOG HERE
                    //set the value
                    a_class.getField(setter_name).set(a, val_b);
                }
            } 
            else
            {
                //do something here - bad names for getters and/or setters
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T17:43:26.120

你说你目前有所有这些领域的getter和setter？好的，然后将基础数据从一堆单独的字段更改为数组。更改所有 getter 和 setter 以访问数组。我会为索引创建常量标签，而不是使用数字来实现长期可维护性。还要创建一个并行的标志数组，指示应该处理哪些字段。然后创建一个使用索引的通用 getter/setter 对，以及用于比较标志的 getter。像这样的东西：

```
public class SomeClass
{
  final static int NUM_VALUES=3;
  final static int FOO=0, BAR=1, PLUGH=2;
  String[] values=new String[NUM_VALUES];
  static boolean[] wantCompared={true, false, true};

  public String getFoo()
  {
    return values[FOO];
  }
  public void setFoo(String foo)
  {
    values[FOO]=foo;
  }
  ... etc ...
  public int getValueCount()
  {
    return NUM_VALUES;
  }
  public String getValue(int x)
  {
    return values[x];
  }
  public void setValue(int x, String value)
  {
    values[x]=value;
  }
  public boolean getWantCompared(int x)
  {
    return wantCompared[x];
  }
}
public class CompareClass
{
  public void compare(SomeClass sc1, SomeClass sc2)
  {
    int z=sc1.getValueCount();
    for (int x=0;x<z;++x)
    {
      if (!sc1.getWantCompared[x])
        continue;
      String sc1Value=sc1.getValue(x);
      String sc2Value=sc2.getValue(x);
      if (!sc1Value.equals(sc2Value)
      {
        writeLog(x, sc1Value, sc2Value);
        sc2.setValue(x, sc1Value);
      }
    }
  }
} 
```

我只是在脑海中写下这个，我还没有测试过，所以它们可能是代码中的错误，但我认为这个概念应该有效。

由于您已经拥有 getter 和 setter，因此使用此类的任何其他代码都应该继续保持不变。如果没有使用此类的其他代码，则丢弃现有的 getter 和 setter，只对数组执行所有操作。

# c++ - 有没有办法使用 C++ 进行 iPhone 开发？

> ID：867450
> 
> 赞同：0
> 
> 时间：2009-05-15T07:48:55.160
> 
> 标签：c++, iphone, objective-c, wrapper

抱歉，如果某处提到了这一点，找不到任何有关它的信息。如果您发现重复，请发表评论。

这与是否有可能为 iPhone 编译一个 C++ 程序无关（我认为这是可能的）。

基本上问题是，你能在**Objective C**和**C++**之间架起桥梁吗？如果可能的话，用一个不错的 C++ 库包装整个**Cocoa Touch API for iPhone 是否可行？**

我对Objective C一无所知，我真的很想把我目前的C++技能带到iPhone上。

**编辑：**[**这里**](https://stackoverflow.com/questions/270455/is-it-possible-to-program-iphone-in-c)非常相似的问题[](https://stackoverflow.com/questions/270455/is-it-possible-to-program-iphone-in-c)

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T12:58:15.213

[这个问题](https://stackoverflow.com/questions/270455/is-it-possible-to-program-iphone-in-c)非常接近于复制你自己的问题。

但是，我建议多花一点时间在 Objective-C 上。在学习 Objective-C 之前，我自己做过 C++ 开发，而且过渡非常顺利。许多核心概念是相同的，您的所有基本 C 技能都将相互转化。我认为一旦你深入了解它，你会发现直接 Objective-C 与 Cocoa 框架的交互确实是在 Mac 和 iPhone 上进行的方式。有很多很棒的入门资源，比如我[在此处](http://www.sunsetlakesoftware.com/2009/02/13/resources-getting-started-cocoa)列出的资源。

诚然，在某些情况下，最好在幕后拥有一个跨平台的 C++ 引擎和一个 Objective-C / Cocoa UI。

# java - 最好的 GWT 小部件库？

> ID：867451
> 
> 赞同：134
> 
> 时间：2009-05-15T07:49:29.340
> 
> 标签：java, gwt

对所有 GWT 大师的问题 - 哪个是最好的 GWT 小部件库？为什么？

根据答案列出：

*   [默认](http://www.gwtproject.org/)
*   [煎茶 GXT](http://extjs.com/products/gxt/)
*   [智能 GWT](https://github.com/isomorphic-software/smartgwt)
*   [瓦丁](http://vaadin.com/)
*   [GWT-引导程序](http://gwtbootstrap.github.io/)
*   [GwtBootstrap3](https://github.com/gwtbootstrap3/gwtbootstrap3)
*   [火箭 GWT](http://code.google.com/p/rocket-gwt/)（非活动）
*   [榻榻米](http://code.google.com/p/tatami/)（非活动）
*   [Errai框架](http://erraiframework.org/)
*   [GWT材料设计](https://github.com/GwtMaterialDesign/gwt-material)

И наконец- новое поколение основанное на [JsInterop](http://ronanquillevere.github.io/2014/02/02/GWT-futur-javascript-interop.html#.VmCsmHYrJhE) :

*   [GWT + 聚合物元素](https://github.com/vaadin/gwt-polymer-elements)
*   [GWT + 聚合物](https://vaadin.com/blog/-/blogs/use-gwt-widget-as-polymer-web-component)
*   [Angular 和 GWT](https://github.com/jDramaix/AngularGwtExample)
*   [GWT材料设计](https://github.com/GwtMaterialDesign/gwt-material)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2010-08-09T07:01:39.673

不要将自己绑定到这些库中的任何一个。使用 Vanilla GWT 创建项目的结构。特别是，使用 MVP 模式和事件总线。请参阅谷歌文章以了解如何使用 GWT 最好地设计您的客户端应用程序：[构建 MVP 应用程序](http://www.gwtproject.org/articles/mvp-architecture.html)

之后，您可以使用这些库的任何小部件（例如表格、组合框、日期选择器等）并将其合并到您的项目中。仅当您看不到使用 vanilla GWT 的方法时，才尝试使用扩展组件。这样，您就不会将自己束缚在这些库中，当您尝试做一些没有出现在演示应用程序中的事情时，这些库总是很痛苦，包含许多错误，而且它们的支持充其量也很差。

如何查找小部件应遵循以下顺序：

*   首先检查 GWT Incubator 看看是否有我要找的东西。 [http://code.google.com/p/google-web-toolkit-incubator/](http://code.google.com/p/google-web-toolkit-incubator/)
*   然后，如果您正在寻找“更酷”的东西，请查看 GWT Mosaic [http://code.google.com/p/gwt-mosaic/](http://code.google.com/p/gwt-mosaic/)

小心其他图书馆，我和他们一起工作过（并且仍然做噩梦）。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-05-15T14:47:03.017

取决于您所说的“最佳”是什么意思。最好看的？最好的 API？最适合扩展到您自己的定制需求？

例如，我只是在评估要在我们的应用程序中使用的表类。我们一直在使用 GWT-Ext，但是它给我们带来了很多性能问题，并且很难按照我们需要的方式调整表的大小。我非常接近使用[GWT-Mosaic](http://code.google.com/p/gwt-mosaic/)，但决定在[GWT Incubator](http://code.google.com/p/google-web-toolkit-incubator/)中构建小部件。

那么，我为什么会做出这个选择呢？似乎有太多的图书馆都有自己的图书馆，因为没有更好的词，包袱。要么你必须全身心投入到一些 MVC 框架中（它可能与你的代码库的其余部分不完全兼容），要么你必须采用某人的新奇的布局系统，或者你必须接受这样一个事实：你不能真正调试代码（因为它只是 JSNI 包装器）。

不要误会我的意思，GWT 孵化器并不完美……那里的小部件在不断变化。不过，就我而言，这是最好的选择。它给了我很好的（但绝对不是完美的）：

*   API
*   可扩展性
*   外观和感觉（嗯，这有点弱，但这就是 CSS 的用途。）

所以......答案（对我来说）是以下组合：

*   库存 GWT 小部件（具有*大量*自定义样式）
*   GWT 培养箱表
*   一些自制的小部件

（我应该补充一点：我所指的“行李”*不一定*是坏事。但是，如果你只想要一个或两个小部件，它可以提高完成工作所需的标准以及如何完成工作你的应用程序看起来不错。）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-23T16:46:12.437

请参阅此组件库[GWT Bootstrap](http://gwtbootstrap.github.com/) 这是 Twitter Bootstrap 的 gwt 中的一个实现。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-15T10:54:18.133

GWT alone is a pretty good library.

I didn't use all of the mentioned ones but can recommend [Ext GWT](http://extjs.com/products/gxt/).

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-20T13:02:53.403

我更喜欢香草 GWT。其他一些 API 看起来很漂亮，它们的展示确实展示了小部件，但我总是发现性能并不是最好的……当我说性能时，我的意思更像是响应时间。我讨厌应用程序感觉迟缓。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-06-03T12:37:05.123

提到的大多数库都不是开源的，更糟糕​​的是：它们只是 JavaScript 库之上的包装器。GWT 的强大之处在于应用程序可以在不同的浏览器上运行（因为专门为“大”浏览器生成代码）。这些 JavaScript 底层库可能会导致很多问题。

我同意 jgindin GWT Incubator 和 GWT Mosaic 是迄今为止最好的。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-08-24T13:47:21.357

并不是说它是“最好的”，但我最近在工作中一直在使用[GWT-Ext](http://gwt-ext.com/)。它有一些优点和缺点：

**优点：**

*   相对容易设置和使用
*   它背后的体面大小的社区
*   网上有很多例子，都有附带代码
*   涵盖广泛功能的精选小部件

**缺点：**

*   对您可能无法适应的数据格式和结构做出假设
*   库只是一个 JSNI 包装器，这使得调试和扩展变得更加困难
*   图书馆未来的支持和发展是不确定的
*   一些恼人的跨浏览器问题仍然存在（尤其是布局）
*   他们论坛上的搜索功能基本上没用。（这已成为我的一大烦恼>_<）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-10-07T15:54:17.963

不要使用它们中的任何一个！如果你打算开发一个大规模的应用程序，你应该考虑使用 MVP 模式。最好的实现是[MVP4G](http://code.google.com/p/mvp4g/)框架，它支持开箱即用的 GWT 代码拆分。有很多很好的例子，你可以开始。最有价值的是 Mvp4GModules。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-05-30T18:36:21.780

添加新的：[GWT-Bootstrap](http://gwtbootstrap.github.com) :)

目前还没有稳定的版本，但很快就会有。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-06-29T10:46:07.840

我的经验表明，第 3 方库总是存在很多问题。最好的方法 - 是使用众所周知且制作精良的技术本身以及您自己的组件。编写和维护它们可能需要更长的时间，但 TCO 始终处于较低水平。

3rd 方库通常会意外地破坏您的计划。而且很难找到并解决问题的根源。

所以我建议使用普通的 GWT。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-05-18T14:29:51.047

我认为如果您只是想按原样使用小部件，SmartGWT 很好，但如果您想像我在[Gxt 调度程序](http://www.ext-scheduler.com)中那样扩展或修改小部件，我认为 Ext-GWT 是一个更好的选择。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-07-20T13:48:45.707

对我来说 EXT-GWT（又名 GXT）是目前可用的最好的库，我在 6 个月的项目中使用它，它对许多预定义的组件有很大帮助，如网格、树......它也很漂亮

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-15T09:03:50.677

[SmartGWT](http://code.google.com/p/smartgwt/)是一个很好的库，它有很多示例，但用户界面不是那么时尚。对于用户界面， [Ext GWT](http://extjs.com/products/gxt/)很好。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-10-03T23:43:25.097

gwt-mosaic 的用户组似乎不是很活跃，除了 wiki 片段之外我找不到用户手册。gwt-mosaic 向我介绍了两个有趣的工具。

1) gwt-mosaic 包含一个用于 Tibco 的 PageBus 的包装器，它是您应用程序的 JS 部分（RPC 处理程序、小部件回调、小部件设置器）的发布/订阅工具。这是 gwt 的事件总线的替代方案。

2) gwt-mosaic 鼓励使用 Beans Binding (http://code.google.com/p/gwt-beans-binding/) 将数据绑定到小部件和验证小部件。

smartgwt 对于完整的功能集和支持来说并不便宜。除非您删除不使用的主题文件，否则 jar 对 appengine 来说太大了。他们也在服务器端投资工程。

我听说 ext-gwt 很慢而且 JS 文件很大。

gwt 小部件孵化器看起来已被弃用。我相信豪华网格将与新的gwt一起发布。

外观、绑定和验证标准的缺乏阻碍了小部件库的互操作性。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-05-10T04:42:53.987

绝对不是 SmartGWT。他们的框架很臃肿并且具有非常不成熟的性质。他们有一百万个小部件，但要让它们为您的项目工作并不容易。数据源使管理数据的过程变得非常复杂，例如，为了获取数据源中的数据，您必须经常使用 fecth 和检查。虽然您可以缓存结果，但查询它们并不总是那么容易。

RPC 是另一个薄弱而复杂的领域。文档和论坛中有相互矛盾的信息。虽然文档会说您应该很少将自定义操作用作 ds 的一部分，但他们的论坛会告诉您这完全没问题。在最好的日子里，学习有效地使用这些工具是一次艰难的攀登。

他们会超卖产品。例如，charting/analytics 包包含图表......但这些图表不会显示负值或让您以任何有意义的方式操纵轴标签。他们在论坛上以“是啊，那又怎样”的态度公开回应有关此问题的查询。“我们不打算将其添加到 3.0 倍，尽管这是我们的卖点之一，它在我们的路线图上。” 当他们卖给我包裹时，他们从未提到我不能显示负值。真的吗？什么图表不需要能够显示负值？我只能想到一个——描述不满意的同构客户数量的那个。

远离这些家伙，去任何竞争对手的网站，例如 ExtJS、JQuery、甚至是 quxdoo。有一些项目确实正在取得进展，并且实际上提供了一个很好的解决方案。

如果您评估此产品，请务必谨慎。它看起来不错，但是在使用它的项目大约两周后，你就会开始明白我的意思了。小部件是半生不熟的，数据源非常复杂，仅仅因为您支付了论坛支持费用，并不意味着您实际上会得到除嘲讽之外的任何东西，居高临下的答案一开始会让您认为您错过了一些东西。你没有，他们通常很傲慢。

祝您好运，如果您重视开发时间和可维护性，请远离此产品。哦，还有最后一件事。查看他们网站上的 MVC 示例。除了标签上写着“MVC”之外，它实际上与 MVC 无关。他们会试图让你相信这样的框架是为没有经验的开发人员准备的，而且这样的概念在真正的编程中是没有位置的……有点像那些 try catch 块。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-15T10:36:35.180

Google 的默认库是最强大的库。

[Ext GWT](http://extjs.com/products/gxt/)添加了花里胡哨的功能，但除此之外它与 Google 的类似。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-07-07T23:48:53.567

我们目前喜欢[GWT Mosaic](http://code.google.com/p/gwt-mosaic/)小部件。我们使用过 ext-JS，过去我们也推出过自己的小部件。ext-JS 许可和批量对我们来说是个问题。滚动我们自己不是我们想要做的。Mosaic 为我们提供了一个快乐的中间地带，我们认为随着项目的成熟，这将是一个更加快乐的中间地带。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-07-28T06:29:04.653

需要注意的一件事是，从论坛来看，[GWT-Ext](http://code.google.com/p/gwt-ext/)看起来将不再被开发/维护太多（也许根本没有？）。在他们的网站上，他们建议迁移到[SmartGWT](http://code.google.com/p/smartgwt/)。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-09-19T05:33:11.203

没有看到提到这个，[Vaadin](http://vaadin.com/)（以前称为 IT Mill Toolkit），但也许那是因为它在技术上并不完全是 GWT；正如他们的[常见问题解答](http://vaadin.com/faq)所说：

> ***这与 GWT 有何不同？***
> 
> *GWT 应用程序在浏览器中运行，而 Vaadin 应用程序在服务器上运行。我们确实使用 GWT 作为浏览器端的“渲染引擎”，因此您可以结合 Vaadin 和 GWT。*

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-06-03T10:54:42.770

我会说，如果您只需要几个小部件，然后构建您自己的。您可以从提到的库中复制粘贴一些概念。但他们都缺少一件事或另一件事。我和他们中的大多数人一起玩过，并且放弃了每一个。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-11-26T10:33:29.420

smartGWT 速度很慢，而且缺乏示例，即使是基本问题也很难找到答案，即在这个论坛上查看我所有未回答的问题。我正在抛弃 smartgwt。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-05-31T12:13:24.830

Check out SpiffyUI: [www.spiffyui.org](http://www.spiffyui.org)

It is not just a widget library but complex UI/UX GWT framework.

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-08-13T12:38:54.167

这里比较[两个 EXT](http://whatwouldnickdo.com/wordpress/235/gwt-ext-to-ext-gwt/)的优缺点。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2010-04-30T10:47:11.377

我使用 GWT 一年了。经过大量研究，我决定将 GWT Mosaic 作为一个小部件库.. Mosaic 使用了一些 GWT 孵化器组件，例如 PagingScrollTable.. 但是组合框和表格的功能对我们来说还不够.. 这就是为什么，我们有扩展这些组件以添加所需的功能。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-08-24T13:34:56.067

我们使用[GWT Portlets](http://code.google.com/p/gwtportlets/)构建了一个大型 HR 门户和几个较小的应用程序。该项目的重点不是构建一组小部件，而是创建一个简单的编程模型。

从网站：

GWT Portlets 是一个免费的开源 Web 框架，用于构建 GWT（Google Web Toolkit）应用程序。它定义了一个非常简单且高效但功能强大的编程模型来构建美观的模块化 GWT 应用程序。

编程模型有点类似于为门户服务器（Liferay、JBoss Portal 等）编写 JSR168 portlet。“门户”是使用 GWT Portlets 框架作为库构建的应用程序。应用程序功能被开发为松散耦合的 Portlet，每个 Portlet 都带有一个可选的服务器端 DataProvider。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2012-04-17T14:56:07.857

单元测试和调试是两件重要的事情——也是大多数库遗漏的事情。这就是 GWT 大放异彩的地方。如果您使用基于 vanilla js 的库，您将放弃对项目进行单元测试和调试的能力。作为 GWT 开发人员，您应该考虑这些要点并使用没有或最小 js 依赖的库。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-05-12T05:27:22.507

我们做 gwt 项目已经 2 年多了，我们坚持使用默认的小部件。我们制作了自己的开源库来自动填充默认库或我们自己的小部件扩展。请检查一下，它叫做[gwt-jet](http://code.google.com/p/gwt-jet/)。自从我们在大型生产环境中使用它以来，它经过了很好的测试，我们希望它能够安全成长。

# iphone - 如何计算 iPhone 中应用程序的加载时间？

> ID：867452
> 
> 赞同：0
> 
> 时间：2009-05-15T07:50:21.007
> 
> 标签：iphone, objective-c

我想在游戏的初始添加一个加载栏，它是自定义加载栏。为此，我需要计算加载百分比以显示加载进度。有没有办法计算应用程序的加载时间？请帮我。

如果我在资源文件夹中添加 Default.png，它将在应用程序加载时看到。这个怎么运作？我想定制它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T09:20:04.833

我认为您的进度条需要基于*进度*而不是时间。请记住，某些硬件比其他硬件更快。2G iPod touch 是最快的（我认为）原来的 iPhone 是最慢的。

您的`Default.png`图像完全是静态的。听起来你会在加载屏幕的进度为零时截取并使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T09:00:23.927

您可以根据自己的喜好更改 Default.png，甚至在应用程序启动之间交换它，但它仍然是无法动画的静态图像。它在 iPhone OS 引导您的应用程序时显示。一旦应用程序进入您自己的主函数，您就可以显示您想要的任何内容——从此时起，加载的内容和显示的内容都在您的控制之下。

关于进度显示，我只能从游戏开发者的角度来说。通常，您知道要加载多少资源（纹理、声音文件等），因此您可以在每个主循环过程中加载例如一个资源并相应地显示进度。

# c++ - C++ 隐式转换

> ID：867462
> 
> 赞同：27
> 
> 时间：2009-05-15T07:52:49.270
> 
> 标签：c++

关于我最近的一个答案的几条评论，[在 C++ 中可以使用哪些其他有用](https://stackoverflow.com/questions/862858/what-other-useful-casts-can-be-used-in-c/862896#862896)的转换，表明我对 C++ 转换的理解是错误的。只是为了澄清问题，请考虑以下代码：

```
#include <string>

struct A {
    A( const std::string & s ) {}
};

void func( const A & a ) {
}

int main() {
    func( "one" );                  // error
    func( A("two") );           // ok
    func( std::string("three") );   // ok
} 
```

我的断言是第一个函数调用是错误的，因为没有从 const char * 到 A 的转换。有从字符串到 A 的转换，但使用它会涉及多个转换。我的理解是这是不允许的，这似乎得到了 g++ 4.4.0 和 Comeau 编译器的证实。使用 Comeau，我收到以下错误：

```
"ComeauTest.c", line 11: error: no suitable constructor exists 
      to convert from "const char [4]" to "A"
      func( "one" );                    // error 
```

如果您可以在此处或原始答案中指出我错的地方，最好参考 C++ 标准，请这样做。

**C++ 标准的答案似乎是：**

> 最多一个用户定义的转换（构造函数或转换函数）被隐式应用于单个值。

**感谢 Abhay 提供报价。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T09:50:27.490

我认为Sharptooth的答案是准确的。C++ 标准 (SC22-N-4411.pdf) 第 12.3.4 节标题为“转换”清楚地表明，只允许一个隐式的用户定义转换。

> 1 类对象的类型转换可以由构造函数和转换函数指定。这些转换称为用户定义的转换，用于隐式类型转换（第 4 条）、初始化（8.5）和显式类型转换（5.4、5.2.9）。
> 
> 2 用户定义的转换仅适用于明确的情况（10.2、12.3.2）。转换遵守访问控制规则（第 11 条）。在歧义解决（3.4）之后应用访问控制。
> 
> 3 [注：有关在函数调用中使用转换的讨论以及下面的示例，请参见 13.3。——尾注]
> 
> 4 最多一个用户定义的转换（构造函数或转换函数）隐式应用于单个值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-15T12:26:55.523

正如似乎已经达成的共识：是的，你是对的。

但是由于这个问题/答案可能会成为stackoverflow上C++隐式转换的参考点，我想补充一点，对于模板参数，规则是不同的。

用于模板参数推导的参数不允许隐式转换。这可能看起来很明显，但仍然会导致微妙的怪异。

例如，std::string 加法运算符

```
 std::string s;
 s += 67;    // (1)
 s = s + 67; // (2) 
```

(1) 编译运行良好，`operator+=`是一个成员函数，模板字符参数已经通过实例化`std::string`for s (to `char`) 推导出来。因此允许隐式转换（`int`-> `char`），导致 s 包含相当于 67 的字符，例如在 ASCII 中这将变为 'C'

(2) 给出了一个编译器错误，因为`operator+`它被声明为一个自由函数，这里模板字符参数*用于*推导。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-15T07:56:39.743

没错，只允许进行一次*隐式*转换。

可以使用转换运算符和参数化构造函数的组合执行连续两次转换，但这会导致[C4927 警告](http://msdn.microsoft.com/en-us/library/727wstex(VS.80).aspx)- “非法转换；已隐式应用多个用户定义的转换” - 在 VC++ 中是有原因的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-15T08:58:15.353

*[C++ 编程语言](https://books.google.com/books?id=PSUNAAAAQBAJ&pg=PA546&lpg=PA546&dq=%22only+one+level+of+user-defined+implicit+conversion+is+legal%22&source=bl&ots=DqxpDja_3L&sig=qjudOpQncUR6BdzfFT_vGLwoGDc&hl=en&sa=X&ved=0ahUKEwi_tfvf-Y7NAhWDjz4KHd8tDmAQ6AEIMjAE#v=onepage&q=%22only%20one%20level%20of%20user-defined%20implicit%20conversion%20is%20legal%22&f=false)（第 4 版）*（第 18.4.3 节）说

> 只有一级用户定义的隐式转换是合法的

如果某些类型介于本机类型之间，则“用户定义”部分听起来像是允许进行多个隐式转换。

# websphere - Websphere 配置模板

> ID：867465
> 
> 赞同：3
> 
> 时间：2009-05-15T07:54:23.010
> 
> 标签：websphere

有谁知道是否可以导出 websphere application server 6.1 的现有配置并将其导入到其他 WAS 实例？

# jquery - 当我制作一个可拖动的克隆并将其放入可放置的对象中时，我无法再次拖动它

> ID：867469
> 
> 赞同：56
> 
> 时间：2009-05-15T07:56:32.957
> 
> 标签：jquery, drag-and-drop, clone, jquery-ui-draggable, jquery-ui-droppable

当我制作一个可拖动的克隆并将其放入可放置的对象中时，我无法再次拖动它。我怎么做？其次，我只能弄清楚如何`.append`将克隆添加到 droppable 中。但随后它会在任何现有元素而不是放置位置之后捕捉到左上角。

```
$(document).ready(function() {
    $("#container").droppable({
        drop: function(event, ui) {
            $(this).append($(ui.draggable).clone());
        }
    });
    $(".product").draggable({
        helper: 'clone'
    });
});
</script>

<div id="container">
</div>
<div id="products">
    <img id="productid_1" src="images/pic1.jpg" class="product" alt="" title="" />
    <img id="productid_2" src="images/pic2.jpg" class="product" alt="" title="" />
    <img id="productid_3" src="images/pic3.jpg" class="product" alt="" title="" />
</div> 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-15T10:48:07.960

一种方法是：

```
$(document).ready(function() {
    $("#container").droppable({
        accept: '.product',
        drop: function(event, ui) {
            $(this).append($("ui.draggable").clone());
            $("#container .product").addClass("item");
            $(".item").removeClass("ui-draggable product");
            $(".item").draggable({
                containment: 'parent',
                grid: [150,150]
            });
        }
    });
    $(".product").draggable({
        helper: 'clone'
    });
}); 
```

但我不确定它是否是干净整洁的编码。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-08-31T04:46:43.270

我通过谷歌找到了这个问题。我也无法阻止位置捕捉到容器，直到我在附加时将“ui.draggable”更改为“ui.helper”：

```
$(this).append($(ui.helper).clone()); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-03-02T02:33:48.467

对于那些试图重新定位丢弃的物品的人。看看这里。

[Jquery 拖放和克隆](https://stackoverflow.com/questions/2100896/jquery-drag-drop-and-clone)。

我实际上不得不使用看起来像的代码

```
$(item).css('position', 'absolute');
$(item).css('top', ui.position.top - $(this).position().top);
$(item).css('left', ui.position.left - $(this).position().left); 
```

去做吧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-28T22:35:13.647

这是我的解决方案，它允许拖放克隆，然后根据需要通过另一个拖放替换它。它还有一个回调函数参数，该参数将被删除的 div 对象传回，以便您可以在删除后对 jquery 选择的 div 执行某些操作。

```
refreshDragDrop = function(dragClassName,dropDivId, callback) {
  $( "." + dragClassName ).draggable({
    connectToSortable: "#" + dropDivId,
    helper: "clone",
    revert: "invalid"
  });
  $("#" + dropDivId).droppable({
    accept: '.' + dragClassName,
    drop: function (event, ui) {
      var $this = $(this),
        maxItemsCount = 1;
      if ($this.children('div').length == maxItemsCount ){
        //too many item,just replace
        $(this).html($(ui.draggable).clone());
        //ui.sender.draggable('cancel');
      } else {
        $(this).append($(ui.draggable).clone());
      }
      if (typeof callback == "function") callback($this.children('div'));
    }
  });
} 
```

# c - C 结构中的自动字段重新排序以避免填充

> ID：867471
> 
> 赞同：12
> 
> 时间：2009-05-15T07:57:23.503
> 
> 标签：c, data-structures, memory-optimization

我花了几分钟手动重新排序结构中的字段以减少填充效果[1]，这感觉就像几分钟太多了。我的直觉告诉我，我最好把时间花在编写 Perl 脚本之类的东西上来为我做这种优化。

我的问题是这是否也是多余的；是否已经有一些我不知道的工具，或者我应该能够打开[2] 来打包结构的一些编译器功能？

这个问题更加复杂，因为这需要在几个不同的架构上进行一致的优化，所以无论使用什么工具都需要能够考虑不同的结构对齐和指针大小。

编辑：快速澄清——我想要做的是重新排序源代码中的字段以避免填充，而不是像在没有填充的情况下编译那样“打包”结构。

编辑#2：另一个复杂情况：根据配置，某些数据类型的大小也可能发生变化。显而易见的是针对不同架构的指针和指针差异，还有浮点类型（16、32 或 64 位，取决于“精确度”）、校验和（8 位或 16 位，取决于“速度”）和一些其他不明显的东西。

[1] 有问题的结构在嵌入式设备上被实例化了数千次，因此结构每减少 4 字节可能意味着该项目的成功*与否*之间*的*差异。

[2] 可用的编译器有 GCC 3.* 和 4.*、Visual Studio、TCC、ARM ADS 1.2、RVCT 3.* 和其他一些比较晦涩的编译器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T08:16:10.463

如果您可以从存储中挤出的每个单词都很关键，那么我必须建议手动优化结构。一个工具可以为您最佳地安排成员，但它不知道，例如，您以 16 位存储的这个值实际上永远不会超过 1024，因此您可以窃取*该*值的高 6 位*这里*...

因此，人类几乎肯定会在这项工作上击败机器人。

[编辑] 但似乎你真的不想为每个架构手动优化你的结构。也许你真的有很多架构需要支持？

我确实认为这个问题不适用于通用解决方案，但您可能能够将您的领域知识编码到自定义 Perl/Python/something 脚本中，该脚本会为每个架构生成结构定义。

此外，如果您的所有成员的大小都是 2 的幂，那么您只需按大小对成员进行排序（最大的优先）即可获得最佳包装。在这种情况下，您可以使用良好的老式基于宏的结构构建 -像这样的东西：

```
#define MYSTRUCT_POINTERS      \
    Something*  m_pSomeThing;  \
    OtherThing* m_pOtherThing; 

#define MYSTRUCT_FLOATS        \
    FLOAT m_aFloat;            \
    FLOAT m_bFloat;

#if 64_BIT_POINTERS && 64_BIT_FLOATS
    #define MYSTRUCT_64_BIT_MEMBERS MYSTRUCT_POINTERS MYSTRUCT_FLOATS
#else if 64_BIT_POINTERS
    #define MYSTRUCT_64_BIT_MEMBERS MYSTRUCT_POINTERS
#else if 64_BIT_FLOATS
    #define MYSTRUCT_64_BIT_MEMBERS MYSTRUCT_FLOATS
#else
    #define MYSTRUCT_64_BIT_MEMBERS
#endif

// blah blah blah

struct MyStruct
{
    MYSTRUCT_64_BIT_MEMBERS
    MYSTRUCT_32_BIT_MEMBERS
    MYSTRUCT_16_BIT_MEMBERS
    MYSTRUCT_8_BIT_MEMBERS
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T08:26:22.153

有一个称为 pstruct 的 Perl 脚本，它通常包含在 Perl 安装中。该脚本将转储结构成员的偏移量和大小。您可以修改 pstruct 或将其输出用作创建实用程序的起点，该实用程序可以按照您想要的方式打包您的结构。

```
$ cat foo.h 
struct foo {
    int x;
    char y; 
    int b[5];
    char c;
};

$ pstruct foo.h
struct foo {
  int                foo.x                      0       4
  char               foo.y                      4       1
                     foo.b                      8      20
  char               foo.c                     28       1
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T08:19:42.763

大多数 C 编译器不会这样做，因为您可以做一些奇怪的事情（比如获取结构中元素的地址，然后使用指针魔法访问其余部分，绕过编译器）。一个著名的例子是 AmigaOS 中的双链表，它使用守护节点作为列表的头部和尾部（这使得在遍历列表时可以避免 ifs）。守护者头节点将始终具有`pred == null`，尾节点将具有`next == null`，开发人员将这两个节点滚动到单个三指针结构`head_next null tail_pred`中。通过使用`head_next`或`null`作为头尾节点的地址，他们节省了四个字节和一个内存分配（因为他们只需要整个结构一次）。

所以你最好的选择可能是将结构编写为伪代码，然后编写一个预处理器脚本，从中创建真正的结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T08:06:49.190

看看#pragma pack。这改变了编译器对齐结构中元素的方式。您可以使用它来强制它们紧密排列在一起，没有空格。

[在此处查看更多详细信息](http://publib.boulder.ibm.com/infocenter/macxhelp/v6v81/index.jsp?topic=/com.ibm.vacpp6m.doc/compiler/ref/rnpgpack.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T08:30:35.140

它也取决于平台/编译器。如前所述，大多数编译器将所有内容都填充为 4 字节对齐（或更糟！），因此假设结构有 2 个 short 和一个 long：

```
short
long
short 
```

将占用 12 个字节（带有 2*2 字节的填充）。

将其重新排序为

```
short
short
long 
```

仍将占用 12 个字节，因为编译器将填充它以使数据访问更快（这是大多数桌面的默认设置，因为他们更喜欢快速访问而不是内存使用）。您的嵌入式系统有不同的需求，因此无论如何您都必须使用#pragma 包。

至于重新排序的工具，我会简单地（手动）重新组织您的结构布局，以便将不同的类型放在一起。先把所有的短裤放进去，然后把所有的长头放进去，等等。如果你要完成包装，无论如何这就是工具会做的事情。您可能在类型之间的转换点的中间有 2 个字节的填充，但我认为这不值得担心。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T10:15:28.367

编译器可能不会通过自己的头部重新排序结构中的字段。标准要求字段应按定义的顺序排列。做其他事情可能会以微妙的方式破坏代码。

正如你所写的，当然完全有可能制作某种代码生成器，以一种有效的方式在字段周围打乱。但我更喜欢手动执行此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T10:40:50.147

考虑如何制作这样的工具......我想我会从调试信息开始。

从源头获取每个结构的大小是一件很痛苦的事情。它与编译器已经完成的许多工作重叠。我对 ELF 不够熟悉，无法准确说明如何从调试二进制文件中提取结构大小信息，但我知道该信息存在，因为调试器可以显示它。也许 objdump 或 binutils 包中的其他东西可以轻松地为您提供这个（至少对于使用 ELF 的平台）。

得到信息后，剩下的就很简单了。将成员从大到小排序，尽量保持原始结构的顺序。使用 perl 或 python 甚至可以很容易地将其与源代码的其余部分进行交叉引用，甚至可以根据使用的干净程度保留注释或 #ifdefs。最大的痛苦将是更改整个代码库中结构的所有初始化。哎呀。

事情就是这样。听起来很不错，但我不知道有任何这样*的现有*工具可以做到这一点，并且当你编写自己的......我认为你将能够手动重新排序程序中的大多数结构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-21T14:21:19.387

我有同样的问题。正如另一个答案中所建议的那样， pstruct 可能会有所帮助。但是，它确实提供了我们需要的东西。实际上 pstruct 使用 gcc 提供的调试信息。我基于相同的想法编写了另一个脚本。

您必须生成带有 STUBS 调试信息的程序集文件 ( `-gstubs`)。（可以从 dwarf 获得相同的信息，但我使用的方法与 pstruct 相同）。在不修改编译过程的情况下执行此操作的一个好方法是添加`"-gstubs -save-temps=obj"`到您的编译选项中。

以下脚本读取汇编文件并检测何时在结构中添加了额外的字节：

```
 #!/usr/bin/perl -n

    if (/.stabs[\t ]*"([^:]*):T[()0-9,]*=s([0-9]*)(.*),128,0,0,0/) {
       my $struct_name = $1;
       my $struct_size = $2;
       my $desc = $3;
       # Remove unused information from input
       $desc =~ s/=ar\([0-9,]*\);[0-9]*;[-0-9]*;\([-0-9,]*\)//g;
       $desc =~ s/=[a-zA-Z_0-9]+://g;
       $desc =~ s/=[\*f]?\([0-9,]*\)//g;
       $desc =~ s/:\([0-9,]*\)*//g;
       my @members = split /;/, $desc;
       my ($prev_size, $prev_offset, $prev_name) = (0, 0, "");
       for $i (@members) {
          my ($name, $offset, $size) = split /,/, $i;
          my $correct_offset = $prev_offset + $prev_size;
          if ($correct_offset < $offset) {
             my $diff = ($offset - $correct_offset) / 8;
             print "$struct_name.$name looks misplaced: $prev_offset + $prev_size = $correct_offset < $offset (diff = $diff bytes)\n";
          }
          # Skip static members
          if ($offset != 0 || $size != 0) {
            ($prev_name, $prev_offset, $prev_size) = ($name, $offset, $size);
          }
       }
    } 
```

调用它的好方法：

```
find . -name *.s | xargs ./detectPaddedStructs.pl | sort | un 
```

# c# - 来自用户输入的 RegEx 是否安全？

> ID：867478
> 
> 赞同：4
> 
> 时间：2009-05-15T07:59:53.357
> 
> 标签：c#, regex, user-input

我正在开发一个需要接受用户正则表达式的应用程序，为此我使用以下代码：

```
Regex user_searchPattern = new Regex(this.userInput_regEx.Text); 
```

这样做安全吗？
是否需要清理用户输入，如果需要，如何处理？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T08:04:33.970

如果正则表达式的语法无效，您可能会收到错误，或者如果在某个特定字符串上测试所谓的*病态正则表达式，则在处理时可能会消耗指数量的时间和空间。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T08:06:02.467

用户输入总是邪恶的。“安全”是什么意思。它是否包含会使您的代码抛出异常或以其他方式失败的错误？是的，它当然可以，所以你当然应该为此做好准备。

# iphone - 有没有人尝试过任何 SQLite3 包装器 API 来简化 iPhone 上的数据库功能？

> ID：867482
> 
> 赞同：0
> 
> 时间：2009-05-15T08:00:37.270
> 
> 标签：iphone, core-data, sqlite, entropy, fmdb

来自非 SQL 背景，过去几天我一直很难吸收 SQLite3。有没有人使用任何 SQLite3 包装器 API 获得任何好的结果？它们工作可靠吗？哪个最好？我还听到有关 Core Data 即将登陆 iPhone 的传闻。不确定这些信息是否值得信赖，但也许你们中的一些人知道：在某个时候会有适用于 iPhone 的 Core Data 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T03:33:05.493

FMDB 易于使用，并从您那里抽象出一些 SQLite 的讨厌，但仍然暴露了 SQL。

我在一个项目中使用过它，但将其子类化以添加我自己的部分 OO 层。这种方法的优点是，如果我需要更快的速度或我没有预见到的东西（例如触发器），我可以实现它。使用 Core Data，没有可用的“绕过”，我必须依赖 Core Data 的优化、内存使用等。

另一个区别是 Core Data 将允许您的应用程序完全保持 OO。使用 FMDB 或其他数据库解决方案，您始终与数据库的组织密切相关。这是一个设计决定，而不是您以后可以更改的决定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T09:14:47.187

如果你现在才刚刚开始，我会使用 Core Data。

去年我花了一些时间查看当时的各种包装。最后我一个都没用。

我认为 NDA 在我寻找时仍然存在，所以我可能错过了最好的，但我发现大多数都是非常薄的包装纸。出于我的目的，这意味着它添加了一个外部依赖项，并没有节省太多的输入，而且我可能仍然不得不深入使用 sqlite 函数调用，有时无论如何。只是看起来不值得。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T08:39:29.907

为什么不使用 3.0 SDK 定位 CoreData？

如果出于某种原因您需要支持 2.x，您应该查看[SQLitePersistentObject](http://code.google.com/p/sqlitepersistentobjects/)。它很慢并且有一些错误，但它非常易于使用。可悲的是，作者不再积极开发它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T10:27:14.000

另外：前段时间，在一个小示例项目（2.x）中，我使用了[fmdb](http://code.google.com/p/flycode/source/browse/#svn/trunk/fmdb/src)。据我记得它很容易使用。但是，它需要 SQL 知识。

# c# - C# 获取 %AppData% 的路径

> ID：867485
> 
> 赞同：441
> 
> 时间：2009-05-15T08:00:59.670
> 
> 标签：c#, .net, path

C# 2008 SP1

我正在使用下面的代码：

```
dt.ReadXml("%AppData%\\DateLinks.xml"); 
```

但是，我收到一个异常，该异常指向我的应用程序运行的位置：

> 找不到路径“D:\Projects\SubVersionProjects\CatDialer\bin\Debug\%AppData%\DateLinks.xml”的一部分。

我认为`%AppData%`应该找到相对路径。当我去时，`Start|Run|%AppData%`Windows 资源管理器将我带到那个目录。

我无法输入完整路径，因为每台客户端计算机上的用户都不同。

* * *

## 回答 #1

> 赞同：913
> 
> 时间：2009-05-15T08:03:03.223

要获取*AppData*目录，最好使用`GetFolderPath`方法：

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

`using System`（如果不存在必须添加）。

`%AppData%`是一个环境变量，并且它们不会在 .NET 中的任何位置自动扩展，尽管您可以显式使用该[`Environment.ExpandEnvironmentVariable`](https://docs.microsoft.com/en-us/dotnet/api/system.environment.expandenvironmentvariables)方法来这样做。但是，我仍然强烈建议您使用`GetFolderPath`，因为正如 Johannes Rössel 在评论中指出的那样，`%AppData%`在某些情况下可能不会设置。

最后，创建示例中所示的路径：

```
var fileName = Path.Combine(Environment.GetFolderPath(
    Environment.SpecialFolder.ApplicationData), "DateLinks.xml"); 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2013-06-14T12:29:45.893

**使用AppData**目录的**最佳**方式是使用方法。**[`Environment.ExpandEnvironmentVariables`](http://msdn.microsoft.com/en-us/library/system.environment.expandenvironmentvariables.aspx)**

 ****原因：**

*   它用有效的目录或任何东西替换你的字符串的一部分
*   它不区分大小写
*   这很简单
*   这是一个标准
*   适合处理用户输入

**例子：**

```
string path;
path = @"%AppData%\stuff";
path = @"%aPpdAtA%\HelloWorld";
path = @"%progRAMfiLES%\Adobe;%appdata%\FileZilla"; // collection of paths

path = Environment.ExpandEnvironmentVariables(path);
Console.WriteLine(path); 
```

**[更多信息：](https://www.askvg.com/list-of-environment-variables-in-windows-xp-vista-and-7/)**

```
%ALLUSERSPROFILE%   C:\ProgramData
%APPDATA%   C:\Users\Username\AppData\Roaming
%COMMONPROGRAMFILES%    C:\Program Files\Common Files
%COMMONPROGRAMFILES(x86)%   C:\Program Files (x86)\Common Files
%COMSPEC%   C:\Windows\System32\cmd.exe
%HOMEDRIVE% C:
%HOMEPATH%  C:\Users\Username
%LOCALAPPDATA%  C:\Users\Username\AppData\Local
%PROGRAMDATA%   C:\ProgramData
%PROGRAMFILES%  C:\Program Files
%PROGRAMFILES(X86)% C:\Program Files (x86) (only in 64-bit version)
%PUBLIC%    C:\Users\Public
%SystemDrive%   C:
%SystemRoot%    C:\Windows
%TEMP% and %TMP%    C:\Users\Username\AppData\Local\Temp
%USERPROFILE%   C:\Users\Username
%WINDIR%    C:\Windows 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2009-07-27T10:14:09.213

如果您使用的是 ASP.NET，则路径会有所不同。

我找不到任何指向 ASP.NET 的 /App_Data 的“SpecialFolder”值。

相反，您需要这样做：

```
 HttpContext.Current.ApplicationInstance.Server.MapPath("~/App_Data") 
```

（注意：您不需要 MVC 控制器中的“当前”属性）

如果有另一种更“抽象”的方式去`App_Data`很想听听如何。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-05-15T08:06:18.473

你也可以使用

```
Environment.ExpandEnvironmentVariables("%AppData%\\DateLinks.xml"); 
```

扩展`%AppData%`变量。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-04-08T12:03:34.547

在 .net2.0 中，您可以使用变量`Application.UserAppDataPath`

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2020-11-09T17:34:10.317

**AppData ⇝ 本地**又名 ( `C:\Users\<user>\AppData\Local`):

```
Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

* * *

**AppData ⇝ 漫游**又名 ( `C:\Users\<user>\AppData\Roaming`):

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

* * *

此外，了解以下内容可能很方便：

*   `Environment.SpecialFolder.ProgramFiles` - 用于程序文件 X64 文件夹
*   `Environment.SpecialFolder.ProgramFilesX86`- 用于程序文件 X86 文件夹

完整列表请[点击此处](https://docs.microsoft.com/en-us/dotnet/api/system.environment.specialfolder?view=netcore-3.1)。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-15T08:06:08.740

我不认为将 %AppData% 放在这样的字符串中会起作用。

尝试

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData).ToString() 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-06-27T22:58:53.267

只是想分享另一种在我的 mvc 应用程序中访问“App_Data”文件夹的方式，以防有人需要。

```
 Path.Combine(HttpRuntime.AppDomainAppPath,"App_Data") 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-03-27T23:37:00.110

这在控制台应用程序中对我有用 -

```
string appData = System.Environment.GetEnvironmentVariable("APPDATA"); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-12-11T17:17:57.017

对于 ASP.NET，`Load User Profile`需要在应用程序池上设置该设置，但这还不够。有一个名为`setProfileEnvironment`in的隐藏设置`\Windows\System32\inetsrv\Config\applicationHost.config`，由于某种原因默认关闭，而不是[文档](https://docs.microsoft.com/en-us/iis/configuration/system.applicationhost/applicationpools/add/processmodel)中描述的打开。您可以更改默认设置或在您的应用程序池中设置它。然后类上的所有方法`Environment`都将返回正确的值。

# ruby-on-rails - Geokit-rails 插件 - 无法在返回的 GeoLoc 对象上调用 to_json，给出循环引用错误

> ID：867491
> 
> 赞同：2
> 
> 时间：2009-05-15T08:02:31.913
> 
> 标签：ruby-on-rails, ruby

我在 rails 2.3 应用程序上使用了早期版本的 geokit 插件，并且刚刚更新到这个最新版本 - 现在使用 gem 的那个。

在以前的版本中，可以将 .geocode 方法返回的对象转换为 json。只需调用它的 to_json 方法。

然而，这在新版本中中断。

我注意到新 GeoLoc 中有一个属性 @all 如果您在其上调用 to_json 会产生循环引用错误。

以下是返回对象的示例：

```
<Geokit::GeoLoc:0x3837be4 @full_address="Phoenix, AZ, USA", @city="Phoenix", @provider="google", @country_code="US", @accuracy=4, @street_address=nil, @lng=-112.073821, @precision="city", @zip=nil, @success=true, @all=[#<Geokit::GeoLoc:0x3837be4...>], @lat=33.448263, @state="AZ"> 
```

如果您在其上调用 to_json，则会出现以下错误：

ActiveSupport::JSON::CircularReferenceError（对象引用自身）

我正在使用“json”通过 jquery 在地图上绘制标记。当然，我可以从 GeoLoc 结果中创建自己的字符串并将其转换为 json - 但它是更多代码......

任何人都知道为什么在新版本中添加了该属性，以及是否有另一种方法可以将 geoLoc 结果直接转换为 json？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T09:52:48.607

嘿，现在最简单的方法是打电话`my_geoloc.to_hash.to_json`

发生循环引用是因为地理编码调用可以返回多个结果，这些结果保存在 @all 属性中。

# linux - 是否有适用于 Linux 的命令行 TMX 编辑工具（多语言支持）？

> ID：867495
> 
> 赞同：4
> 
> 时间：2009-05-15T08:03:52.147
> 
> 标签：linux, command-line, multilingual, tmx

我正在 TMX 中构建一个支持多语言的应用程序。我找到了一些适用于 Windows 的编辑器，但由于我是在远程服务器上开发的，所以我正在寻找一个用于 linux 的命令行工具来翻译字符串并将它们写入 TMX 文件。有谁知道这样的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T06:44:45.783

TMX，（翻译记忆交换）格式是一个简单的 XML 文件。您可以在此处找到确切的规格：**[http](http://www.lisa.org/Translation-Memory-e.34.0.html#c33)** ://www.lisa.org/Translation-Memory-e.34.0.html#c33 。

您还可以在那里找到验证工具。

您会注意到，TMX 格式有多个版本。假设您不关心格式化信息，最旧的格式是最广泛支持的。

以下是 TMX 代码示例：

```
<body>
  <tu creationdate="20080317T093024Z" creationid="user_name">
    <tuv xml:lang="EN-US">
      <seg>English text</seg>
    </tuv>
    <tuv xml:lang="FR-FR">
      <seg>French text</seg>
    </tuv>
    ...
  </tu>
</body> 
```

有几个支持 TMX 的开源项目，如 OmegaT (Java) 和 Okapi Framework (Java & .NET)，但坦率地说，直接输出 TMX 可能更容易。

我的意思是，无论使用哪种工具，您都必须指定源语言代码和目标语言代码（*警告：这是 TMX 工具之间兼容性问题的最大单一来源。请慷慨地接受...*），并且您还拥有输出语言字符串并指定它们使用的语言。

因此，只需用 XML 标记包装您的字符串，打上一个时间戳，您就完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T11:58:54.577

我在 TMX 的维基百科页面上找到[po2tmx](http://translate.sourceforge.net/wiki/toolkit/po2tmx)

编辑以添加示例 .po 文件 .po 文件
的格式：

```
msgid "This is my first string"
msgstr "This is my first string"

msgid "This is my second string"
msgstr "This is my second string" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:07:01.293

[bitext2tmx](http://bitext2tmx.sourceforge.net/)，也许？它是用java编写的，在linux上运行良好。它合并来自两个纯文本文件的数据。我还没有尝试过，但[看起来](https://sourceforge.net/project/screenshots.php?group_id=157764)它的编辑功能还不错。

# html - 归根结底，为什么选择 XHTML 而不是 HTML？

> ID：867498
> 
> 赞同：77
> 
> 时间：2009-05-15T08:05:08.053
> 
> 标签：html, xhtml

我想知道为什么我应该使用 XHTML 而不是 HTML。

XHTML 应该是“模块化的”，但我还没有看到任何服务器端语言利用这些。

XHTML 也更严格，我看不出有什么好处。XHTML 提供了哪些我非常需要的东西？它如何使我的代码“更好”？

编辑：我在评论中发现的另一个问题：XHTML 解析比 HTML 快吗？

EDIT2：在阅读了您所有的评论和链接之后，我确实同意另一篇文章应该是正确的答案，所以我选择了直接链接到最佳来源的文章。

此外，这表明人们甚至在没有阅读的情况下就对绿色评论进行了投票。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-20T02:32:15.287

您应该阅读[Beware of XHTML](http://www.webdevout.net/articles/beware-of-xhtml)，这是一篇内容丰富的文章，它警告了 XHTML 优于 HTML 的一些陷阱。

在我阅读它之前，我对 XHTML 非常感兴趣，但它确实提出了几个有效的观点。包括以下位；

> XHTML 1.x 不是“未来兼容的”。目前处于起草阶段的 XHTML 2 不能向后兼容 XHTML 1.x。XHTML 2 将对文档的编写和结构方式进行大量重大更改，即使您已经用 XHTML 1.1 编写了站点，通常也需要完全重写站点才能将其转换为正确的 XHTML 2。一个简单的在大多数情况下，XSL 转换是不够的，因为某些语义无法正确转换。
> 
> HTML 4.01 实际上更加兼容未来。根据现代支持级别编写的有效 HTML 4.01 文档将是有效的 HTML 5，而 HTML 5 是浏览器开发人员和 W3C 的主要关注点。

在处理某些项目时，未来的兼容性可能会很大。这篇文章继续提出其他几个优点，但我认为这对我来说可能是最突出的。

不要把这篇文章误认为是对 XHTML 的抨击，作者确实谈到了 XHTML 的优点，但在深入研究之前了解缺点是很好的。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-15T08:59:23.510

我打算将此作为评论添加到其他帖子之一，但它变得有点太大了。

大多数人似乎缺少的基本点是 XHTML 背后的目的。开发 XHTML 规范的主要原因之一是淡化标记中与表示相关的标签，并将表示推迟到 CSS。虽然可以使用纯 HTML 实现这种分离，但规范并未促进这种行为。

分离元标记和表示是“可编程网络”开发的重要组成部分，不仅可以改善 SEO 和屏幕阅读器/文本浏览器的访问，还可以使您的网站更容易被那些希望分析的人分析。以编程方式访问它（在许多简单的情况下，这可以消除开发特定 API 的需要，甚至只允许客户端脚本执行诸如轻松识别电话号码之类的事情）。如果您的网页符合 XHTML 规范，则可以使用与 XML 相关的工具以及诸如 XPath 之类的工具轻松遍历它……这对于那些想要从您的网站中提取特定信息的人来说是个好消息。

XHTML 不是为它自己而开发的，而是通过与各种其他技术一起使用而开发的。它在很大程度上依赖于使用 CSS 进行表示，并为诸如微格式（无论你喜欢还是讨厌它们）之类的东西奠定了基础，以便为常见的数据表示提供标准化的标记。

不要被那些认为 XHTML 微不足道、过于严格和毫无意义的人群所愚弄……它的创建目的是 95% 的世界似乎都忽略/不知道。

无论如何都要使用 HTML，但要为它所用的地方使用它，并在查看 XHTML 时采用相同的方法。

* * *

**关于解析速度**，我想 XHTML 和 HTML 对实际文档的解析几乎没有什么区别。权衡将纯粹取决于您如何使用可用标记来描述文档。由于必需的属性、适当的关闭等原因，XHTML 标记往往会更长，但会放弃对文档本身的任何表示性标记的需求。在这种情况下，我认为您正在谈论将一种苹果与一种略有不同的苹果进行比较......它们是不同的，但不太可能产生任何后果（在解析和渲染方面) 当你想要一个健康、美味的苹果时。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-15T08:10:15.063

对于网站的访问者来说，它可能没有任何明显的区别。此外，使用 XHTML 通常更痛苦，因为至少有一个广泛使用的浏览器仍然不知道如何处理它，在这种情况下您需要将其作为 text/html 提供（这会产生无效的 HTML）。

如果您的 HTML 将由自动化工具定期处理，而不是由人类阅读，那么您可能希望使用 XHTML，因为它的结构更严格，并且是 XML，它更容易解析（从应用程序的角度来看。不是 XML 是不过，本质上很容易解析）。

不过，除此之外，我没有看到任何令人信服的理由来使用它。XHTML 是在利用 HTML 的 XML 特性的方法创建的，基本上它归结为“具有几个烦人的副作用的 HTML 4”（至少恕我直言）。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-19T23:37:22.287

使用**HTML**（HTML4 Strict 或 HTML5）。

*   HTML 可以充分利用 CSS，可以明确地验证和解析。在 HTML4 中已经完成了结构和表示的分离，而 XHTML 只是继续这样做。

*   所有浏览器都支持 HTML。只有一些浏览器支持 XHTML，而那些支持的浏览器通常对 HTML 有更成熟、更好的测试和优化支持（这是由于一[小部分](http://devfiles.myopera.com/articles/554/mamaurlset-mimehistogram.htm)页面使用 XML 模式这一事实造成的）。

*   如果您关心 IE 和 Google，则必须使用 HTML 或 XHTML 的子集和 XHTML 规范附录 C 中定义的 HTML。后者几乎是两全其美的，因为这样的 XHTML 不能用标准的 XML 工具生成，不能使用 XHTML 的新扩展机制，并且比单独的 HTML 有额外的限制。

*   XHTML1.0 现在已经有 10 多年的历史了，它是在“Web1.0”时代设计的，正如 W3C 负责人所说，[回想起来它并没有成功，需要更好的方法](http://dig.csail.mit.edu/breadcrumbs/node/166)。W3C HTML5 是在我们说话的时候编写的，它解决了当今使用的 Web 应用程序的需求，并且具有非常好的向后兼容性。

*   HTML5 弥补了 HTML4 和 XHTML1 之间的许多差距（例如，添加了内联 SVG、MathML i RDF），清理了 XHTML1.0 和 XHTML1.1 之外的语言。

*   在可预见的将来，Web 浏览器不会支持 XHTML2。它很可能*永远不会*被支持（所有浏览器供应商都大力支持 [X]HTML5，有些已经声明他们不会实现 XHTML2）。

* * *

XHTML1.0 与 HTML4.01 具有*完全相同*的语义和表示与结构的分离。任何说其他话的人[都没有阅读规范](http://www.w3.org/TR/xhtml1/)。我鼓励每个人都阅读规范——它出奇地短且无趣。

*   样式表是在 HTML4.01 中引入的，在 XHTML1.0 中*没有*改变。
*   表示元素在 HTML4.01 中被弃用，在 XHTML1.0 中*没有*被删除。

[XHTML 神话](http://www.webdevout.net/articles/beware-of-xhtml#myths)。

* * *

HTML 和 XHTML 中没有难以解决的差异，这会使解析一个比另一个慢得多。这取决于解析器是如何实现的。

*   SGML 和 XML 解析器都需要加载和解析整个 DTD 才能理解实体。仅此一项通常比解析文档本身需要更多的工作。HTML 解析器几乎总是“作弊”并使用硬编码的实体和元素信息。浏览器中的 XHTML 解析器也作弊。
*   解析 HTML 需要处理隐含的开始和结束标签，而现实世界的 HTML 需要额外的工作来处理放错位置的标签。
*   正确解析 XHTML 需要跟踪 XML 名称空间。
*   严格的 XML 规则要求检查每个字符是否正确编码。HTML 解析器可能会侥幸逃脱，但 OTOH 他们需要寻找`<meta>`.

与下载文档、构建 DOM、运行脚本、应用 CSS 和所有其他浏览器必须做的事情所花费的时间相比，解析成本的总体差异很小。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-16T19:38:11.563

我很惊讶这里的所有答案都推荐 XHTML 而不是 HTML。我坚决反对——在可预见的未来，你不应该使用 XHTML。原因如下：

*   除非您将 XHTML 用作 mimetype ，否则任何浏览器都不会将 XHTML 解释*为*`application/xhtml+xml`XHTML 。如果您只是使用默认的 mimetype 提供它，所有浏览器都会将其解释为 HTML - 例如，接受未关闭或不正确嵌套的元素。

*   但是，您永远不应该*这样做*，因为 Internet Explorer 无法识别`application/xhtml+xml`，并且无法完全呈现页面。

*   XHTML 和 HTML 之间的 DOM 存在显着差异。由于目前所有所谓的 XHTML 页面都以 HTML 形式提供，因此所有 javascript 代码都是使用 HTML DOM 编写的。如果对 XHTML mimetype 的支持变得足够重要，足以说服人们开始使用它，那么他们的大部分 javascript 代码都会中断——即使他们认为他们的页面验证为 XHTML。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-20T01:17:16.157

我建议不要继续争论 HTML 4.01 Strict 与 XHTML Strict，而是建议从今天开始使用 HTML 5。jquery 的作者 John Resig[去年](http://ejohn.org/blog/html5-doctype/)在他的博客上提出了类似的建议。

HTML 5 doctype，在它的美丽简洁中将触发所有浏览器（包括 IE6）中的标准模式。

```
<!DOCTYPE html> 
```

就是这样。

HTML 5 提供了一些令人兴奋的新特性，例如`<canvas>`标签，它可能将 javascript 应用程序开发推向一个新的水平。`<video>`HTML 5 还以和`<audio>`标签的形式对媒体（媒体是当今网络的一个相当重要的方面！）提供了适当的支持。

如果您喜欢 XHTML 的语法，即关闭“空”标签，例如`<br />`，那么 HTML 5 完全支持。来自 W3C 的 Karl Dubost 文章[Learn How To Write HTML 5](http://www.w3.org/QA/2008/11/html5-howto.html)：

> 在 HTML 5 中允许并符合自动关闭标签。

与 HTML 5 相比，XHTML2 受到的关注相对较少。越来越清楚的是，HTML 5 是网络标记的未来。Microsoft 最新的浏览器 IE8**仍然**将作为 text/xml 的 XHTML 呈现为 text/html。

微软在 W3C HTML 工作组中有一位联合主席，他们暗示支持 HTML 5。所有浏览器供应商都公开宣布支持 HTML 5。

归根结底，即使 XHTML2 重新获得业界的支持，它也不会像过去那样有两个相互竞争的标准。两种语言都支持 XML 命名空间（在 HTML 5 的情况下，HTML 的序列化，即 DOCTYPE 切换）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-15T08:13:22.263

看看[http://www.w3.org/MarkUp/2004/xhtml-faq#need](http://www.w3.org/MarkUp/2004/xhtml-faq#need)。除了模块化之外，还有一些很好的理由。

我喜欢 XHTML，因为它更严格，布局更清晰。HTML 很古怪，浏览器必须接受`<b><i>sadasd</b></i>`. 虽然这是一个非常简单的示例，但它也可能会变得更加混乱，并且不同的浏览器可能会以不同的方式布局。

此外，我认为 XHTML 必须“更快”，因为浏览器不必进行那种“修复”。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-15T08:16:23.300

作为程序员，您应该非常关心您的代码。HTML 很丑陋并且遵循一些规则。

另一方面，XHTML 遵循严格的结构和句法规则，将 HTML 转换为适当的语言。

XHTML 对每个人都更好，因为它将有助于将 Web 移动到每个人（所有浏览器）都可以就如何显示网页达成一致的程度。

XHTML 是 XML 的后代，我们使用为分析语法合理的 XML 文档而构建的解析器要容易得多。

如果您看不到 XHTML 的好处，您不妨使用 MS Word 来创建您的 HTML 文档。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-15T08:37:38.477

一些区别是：

*   XHTML 标记必须正确嵌套
*   文档必须有一个根元素
*   XHTML 标签总是小写
*   标签必须始终关闭（例如，`<br>`在 XHTML 中使用标签必须有结束标签`<br />`或`<br></br>`在 XHTML 中）

这里有一些链接

[维基 XHTML](http://en.wikipedia.org/wiki/XHTML)

[wiki HTML 与 XHTML](http://wiki.whatwg.org/wiki/HTML_vs._XHTML)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-15T09:26:55.393

XHTML 允许使用所有为 XML 设计的工具。其中，还有XSLT、embedding SVG等……

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-07-02T20:14:39.050

有趣的发展：[XHTML 2 工作组预计将于 2009 年底停止工作，W3C 将增加关于 HTML 5 的资源](http://www.w3.org/News/2009#item119)

*2009-07-02：今天主管宣布，当 XHTML 2 工作组章程如期在 2009 年底到期时，该章程将不再更新。通过这样做，并通过增加工作组中的资源，W3C 希望加快 HTML 5 的进程并阐明 W3C 对于 HTML 未来的立场。FAQ 回答了有关 XHTML 2 工作组可交付成果的未来以及与 HTML 相关的各种讨论的状态的问题。了解有关 HTML 活动的更多信息。*

好吧，我想这让 HTML 的未来变得非常清晰。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-15T08:13:52.667

XHTML 迫使您保持整洁。

例如，在 HTML 中，您可以编写：

```
<img src="image.jpg"> 
```

这不太合乎逻辑，因为`img`标签永远不会关闭。然而，在 XHTML 中，您不得不整齐地关闭标签，如下所示：

```
<img src="image.jpg" /> 
```

我喜欢使用迫使我整洁的东西。

史蒂夫

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-15T08:45:28.177

XHTML 1.0 推荐的副标题：

> XML 1.0 中 HTML 4 的重新表述

目前存在许多处理 XML 的工具。通过使用 XHTML，您可以使用大量工具对您的页面进行操作并以编程方式提取信息。

如果您要使用 HTML，这也是可能的。存在解析 HTML DOM 树的工具。但是，这些工具通常比用于 XML 的工具更专业。您可能找不到您最喜欢的与 HTML 兼容的 XML 数据处理工具。此外，现在 XML 有很多用途，您可能会将 XML 用于应用程序的其他部分。为什么不也使用相同的 XML 解析器来解析您的网页呢？这就是 XHTML 背后的动机。

如果您已经熟悉并熟悉 HTML 4.01，那么您有一个使用 HTML 4 的既定项目，并且您没有大量的空闲时间，那么就使用 HTML 4.01。如果您有空闲时间，无论如何都要学习 XHTML 1.1，并在 XHTML 1.1 中开始您的新项目——这样做并没有什么坏处。如果您使用的不是 HTML 4.01 或者对 HTML 4 非常不熟悉，那么只需学习 XHTML 1.1。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-15T08:54:54.533

使用具有正确 DocType 的 XHTML 将强制浏览器以更符合标准（严格）的模式呈现内容。这使得不同的浏览器表现得更好，最重要的是，它们彼此更相似。这使您作为 Web 开发人员的工作变得更加轻松，因为它减少了使内容在所有浏览器中看起来相同所需的特定于浏览器的调整量。

[Quirksmode.org](http://www.quirksmode.org/css/quirksmode.html)有很多关于这个主题的好信息。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-15T08:14:17.907

在我看来，严格性至少在理论上是一件好事，因为在 HTML 中，您不需要严格，而且由于 HTML5 垃圾，浏览器具有先进的纠错算法，可以做到最好摆脱破碎的HTML。问题是，算法并不完全相同，会导致你无法预测的非常奇怪的行为。另一方面，使用 XHTML，您通常拥有良好、有效的 XHTML，因此不需要纠错算法，即整个浏览器行为是可预测的。此外，严格的代码使您的工具更容易使用代码。因此，使用 XHTML 实际上并没有什么可失去的，但是有一些潜在的收益。当 HTML5 最终出来并且“接受你所接受的东西”时，纯 HTML 的情况会变得更糟 将导致所描述的奇怪行为。但至少那时这是一种标准化的奇怪行为。叹。

另一方面，如果您使用像 Visual Studio 这样好的 IDE，无论如何几乎不可能生成损坏的 HTML 代码，因此结果是一样的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-15T10:20:57.620

## 使用 XHTML

*   **快速失败**。如果有任何不一致之处，将在验证过程中发现。
*   它通过将语义标记与表示等分开来鼓励**更好的设计。**
*   **它是结构化的**，这意味着您可以将其视为数据对象并针对它运行各种查询。例如，您可以在您的网站中找到所有地址或引文。
*   您可以进行**构建时优化**。由于它是格式良好的 XML，您可以在构建期间轻松地进行查找/替换操作。或任何文件管理和操作。
*   您可以编写 XSLT 或其他**转换脚本**以编程方式将您的 XHTML 转换为其他平台。例如，您可以有一个用于 iPhone 的 XSLT，它将转换所有 XHTML 以使其与 iPhone 兼容或更易于使用
*   你正在为自己做**未来**的证明。再次使用转换将 XHTML 转换为更新的语义非常容易。
*   **作为可编程网络**的一部分，搜索引擎将继续发展以收集更多的语义信息。
*   **DOM 操作**更可靠，因为它是结构化的。
*   从算法的角度来看，它产生了**更容易和更快的解析**。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-15T10:39:56.887

XHTMl 是一个很好的使用点，因为如果您想要有效的代码，您需要向残疾人社区提供某些方面的帮助，因为屏幕阅读器需要图像和链接标签的 alt 和标题部分。在一定程度上解析必须更快，因为与 HTML 不同，解析器不需要检查标签是否没有正确关闭，是否正确嵌套等。而且最好使用它，因为是的，它是严格的但在学习编程语言时，它可以帮助你更理性地思考（在我看来）。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-15T11:30:31.290

我相信 XHTML 的解析速度（或应该）更快。必须将有效的 XHTML 文档写入更严格的规范，因为在解析时错误是致命的，而 HTML 更宽松，允许在我的评论之前提到的奇怪之处，如无序结束标记等。我发现这有助于发现 HTML 和 XHTML 解析之间的差异：

[http://wiki.whatwg.org/wiki/HTML_vs._XHTML#Parsing](http://wiki.whatwg.org/wiki/HTML_vs._XHTML#Parsing)

您可能使用 XHTML 而不是 HTML 的一个原因可能是您打算将移动用户作为您的受众的一部分。如果我记得，许多手机使用更多的 XML 解析器，而不是 HTML 解析器来显示网络。如果您正在为桌面浏览器编写代码，那么 HTML 可能是可以接受的。

也就是说，如果您要以 text/html 的形式提供数据，则应该使用 HTML：

[http://www.hixie.ch/advocacy/xhtml](http://www.hixie.ch/advocacy/xhtml)

# c# - 如何将数据上下文回滚到最后一次提交更改的点

> ID：867499
> 
> 赞同：2
> 
> 时间：2009-05-15T08:05:59.957
> 
> 标签：c#, linq, linq-to-sql, datacontext

我正在开发一个应用程序，该应用程序插入了许多新对象（行）和它们之间的关系。但是在某个错误发生时，我希望对 DataContext 的所有更改都被忽略并“丢弃”。这样在发生错误后，我就有了与数据库状态匹配的 DataContext 的干净副本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T08:15:57.107

**编辑**

或者，您可以使用 DataContext.Transaction，并将其用于`.Commit()`或`.Rollback()`您的更改。

**原创**

只需丢弃该 DataContext 并重新实例化它。

就像是...

```
public void MyMethod(string connStr)
{
    try
    {
        DataClasses1DataContext dc = new DataClasses1DataContext(connStr);
        for (int i = 0; i < 100; i++)
        {
            try
            {
                //Do Stuff
                //Insert Objects
                dc.SubmitChanges();
            }
            catch (Exception ex) //So if it bombs in the loop, log your exception
            {
                Log(ex);
            }
            finally //Reinstantiate your DC
            {
                dc = new DataClasses1DataContext(connStr);
            }
        }
    }
    catch (Exception bigEx)
    {
        Log(bigEx);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T10:23:15.273

您还可以在 using 语句中使用 TransactionScope。如果您不在 TransactionScope 上调用 .Complete() ，则所有更改在处理时都会回滚（这在离开 using 语句时发生）。

# iphone - Info button vanishes from view

> ID：867506
> 
> 赞同：0
> 
> 时间：2009-05-15T08:06:35.103
> 
> 标签：iphone, cocoa-touch, ios-simulator

I have a view xib that contains an info button. I'm doing animation on the UIView by adding CALayer objects to the view's layer and animating these layers. I'm careful to place these layers behind the info button by moving their zPosition. The problem is that on a real iPod touch the info button does not show in the view, even though it's area is responding fine to touches. Note that the same button shows fine in the simulator.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T04:52:44.797

I fixed this by removing the info button layer from its super layer, then adding my own layers used for animation and finally adding back the info button layer. This does keep the info button layer properly displayed.

# html - 为什么字体大小在 IE7 中不起作用

> ID：867510
> 
> 赞同：0
> 
> 时间：2009-05-15T08:07:49.733
> 
> 标签：html, internet-explorer-7

我必须遵循代码片段，无论我将字体大小设置为什么，IE7 根本不听！所有其他浏览器都工作正常。有任何想法吗？

```
<html>
<head>
    <title>Test</title>

    <style type="text/css">
        * {margin:0;padding:0;font-size:3em;font-family:Arial;}

    </style>

</head>
    <body>
        <h1>A heading goes here</h1>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T08:14:05.817

它应该适用于所有（体面的）浏览器，包括 IE 7。

我想这是您的浏览器的可访问性设置，可能是：

工具 -> 选项 -> 常规选项卡 -> 辅助功能 -> “忽略页面上指定的字体大小”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T08:19:32.293

尝试以下操作：

a) 使用萤火虫检查样式。检查元素时，在右侧萤火虫窗格的样式视图中会删除覆盖的样式。

b)

```
font-size: 3em !important; 
```

c）现在尝试直接在元素上设置样式，只是为了测试

```
<h3 style='font-size: 10em;'>Test</h3> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T08:21:53.600

单位“em”是相对于当前字体大小的。由于您为所有元素安装了大小，IE 应该使用哪个模板？

您必须指定样式应应用的元素列表或使用类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T09:01:34.223

尽量使用常用的reset.css。* 选择器会减慢渲染页面的速度。您通常需要重置显示为块的元素。[http://960gs.com](http://960gs.com)可以帮助您实现此目的。

# fonts - 如何使用 Wix 安装 Open Type 字体

> ID：867511
> 
> 赞同：17
> 
> 时间：2009-05-15T08:07:54.147
> 
> 标签：fonts, installation, wix

我想在我的 MSI 安装中安装一组开放式字体。我正在使用 Wix 创建 MSI。

有什么建议吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-15T08:41:03.273

您需要指定目录 FontsFolder，并在文件上设置 TrueType 属性：

```
<DirectoryRef Id="FontsFolder">
  <Component Id="MyFontsFonts" Guid="...">
    <File Id="font1.ttf" Source="font1.ttf" TrueType="yes" />
    <File Id="font2.ttf" Source="font2.ttf" TrueType="yes" />
  </Component>
</DirectoryRef> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-16T02:52:57.233

对于安装字体，您必须在代码中设置两个部分：

```
 <Feature Id="ProductFeature" Title="WixSetup" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcut" />
      <ComponentRef Id="ApplicationShortcutDesktop" />
      <ComponentRef Id="MyFontsFonts" />
  </Feature> 
.
.
.

<Directory Id="TARGETDIR" Name="SourceDir">                  
.
.
.
   <Directory Id="FontsFolder">
        <Component Id="MyFontsFonts" Guid="myGuid">
           <File Id="font1.ttf" Source="Fonts\font1.ttf" TrueType="yes" />
        </Component>
   </Directory>

</Directory> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-22T20:32:34.827

我想不通——也许这些年来`DirectoryRef`有些事情发生了变化——但我`Directory`在我的根中放了一个 a`TARGETDIR`并让它发挥作用。就我而言，我需要在服务器上使用 Arial Narrow Bold：

```
<Directory Id="TARGETDIR" Name="SourceDir">
   <!-- snip ... all my other stuff here -->
   <Directory Id="FontsFolder">
     <Component Id="ComponentFontArialNarrowBold" Guid="{65F4712A-EAA6-4801-9200-212A3593D6E2}">
       <File Id="FileFontArialNarrowBold" Source="$(var.SolutionDir)Res\Fonts\ARIALNB.TTF" TrueType="yes" KeyPath="yes" />
     </Component>
   </Directory>
</Directory> 
```

# c# - 使 ListBox 项具有与项文本不同的值

> ID：867514
> 
> 赞同：22
> 
> 时间：2009-05-15T08:09:02.600
> 
> 标签：c#, winforms

我想要一个`ListBox`完整的项目。虽然，每个项目应该有不同的价值。因此，当用户选择一个项目并按下按钮时，将调用一个方法，该方法将使用所选项目的值。

我不想向用户透露项目值。

**编辑：**这不适用于 ASP.NET，它适用于 Windows 窗体应用程序。我只是认为 HTML 示例很容易阅读。

我从 HTML 中获得灵感：

```
<form>
<input type="radio" name="sex" value="Value1" /> Male
<br />
<input type="radio" name="sex" value="Value2" /> Female
</form> 
```

这也允许我使用与用户看到的不同的值。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-15T08:15:58.327

您可以使用 ListBox 的 DisplayMember 选择要显示的内容。

```
List<SomeData> data = new List<SomeData>();
data.Add(new SomeData() { Value = 1, Text= "Some Text"});
data.Add(new SomeData() { Value = 2, Text = "Some Other Text"});
listBox1.DisplayMember = "Text";
listBox1.DataSource = data; 
```

当用户选择一个项目时，您可以从所选对象中读取值（或任何其他属性）：

```
int value = (listBox1.SelectedItem as SomeData).Value; 
```

更新：请注意 DisplayMember 仅适用于属性，而不适用于字段，因此您需要稍微更改您的类：

```
public class SomeData
{
    public string Value { get; set; };
    public string Text { get; set; };
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T08:11:32.533

项目有一个名为“标签”的属性，您可以使用它来存储您想要的任何信息（对用户隐藏）

```
ListViewItem myItem = new ListViewItem();
myItem.Text = "Users see this";
myItem.Tag = "Users don't see this"; 
```

（或在属性资源管理器中设置适当的属性）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-01T15:31:05.997

非常简单：

```
foreach(var item in *Your Source List*)
        {
            ListItem dataItem =  new ListItem();
            dataItem.Text = "value to show";
            dataItem.Value = *another value you want*;
            listBox.Items.Add(dataItem);
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T09:49:59.223

如[第一个答案](https://stackoverflow.com/questions/867514/make-listbox-items-have-a-different-value-than-item-text/867542#867542)所述，`DisplayMember`无论您使用的是 asp.net 还是 winforms，都可以使用。

再多评论一点，如果您使用相当老式的`Items.add`方式将项目添加到`ListBox`.

只是为了好玩，这里有一个您需要的简单演示（只需创建一个新表单并在其上放置一个 ListBox 和一个标签）：

```
public partial class Form1 : Form
{
    class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }

        public override string ToString()
        {
            return string.Format("{0} {1}", LastName, FirstName);
        }
    }

    public Form1() { InitializeComponent(); }

    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);                        
        listBox1.DisplayMember = "LastName";            
        listBox1.DataSource = GetCustomers();
        //listBox1.Items.AddRange(GetCustomers().ToArray());            
    }

    private IEnumerable<Customer> GetCustomers()
    {
        return new List<Customer>()
        {
            new Customer() { FirstName = "Gustav", LastName = "MAHLER" },
            new Customer() { FirstName = "Johann Sebastian", LastName = "BACH" }
        };
    }

    private void lb_SelectedIndexChanged(object sender, EventArgs e)
    {
        label1.Text = listBox1.SelectedItem.ToString();
    }        
} 
```

享受

PS：[@2nd 帖子](https://stackoverflow.com/questions/867514/make-listbox-items-have-a-different-value-than-item-text/867524#867524) `Tag`不适用于`ListBox`: 因为它接受一个数组`object`，而不是一个特定的项目容器，比如`ListView`... 但你不需要任何在你的情况下。`Tag`当您想要携带附加数据以及特定`TreeViewItem`或`ListViewItem`例如时很有用。顺便说一句，`Tag`是在`Control`级别定义的，因此存在于`Button`，`Label`等等......但就我而言，我认为将业务数据存储在其中（无类型，UI耦合......）是一个坏主意，除了`ListView`和`TreeView`比较方便的情况。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-05-17T16:11:57.913

简单的！

```
protected void Page_Load(object sender, EventArgs e)
    {
        llenaListBox(ListBox1, 0, 10);
    }

    private void llenaListBox(ListBox PoListBox, int PiMinimo, int PiMaximo)
    {
        int Li;
        for (Li = PiMinimo; Li <= PiMaximo; Li++)
        {
            ListItem obj = new ListItem();
            obj.Text  = Li.ToString();
            obj.Value = Li.ToString();
            PoListBox.Items.Add(obj);
        }

    } 
```

# android - 如何制作带有初始文本“Select One”的Android Spinner？

> ID：867518
> 
> 赞同：596
> 
> 时间：2009-05-15T08:09:23.520
> 
> 标签：android, android-spinner

我想使用最初（当用户尚未做出选择时）显示文本“选择一个”的 Spinner。当用户单击微调器时，将显示项目列表并且用户选择其中一个选项。用户做出选择后，所选项目将显示在 Spinner 中，而不是“Select One”。

我有以下代码来创建 Spinner：

```
String[] items = new String[] {"One", "Two", "Three"};
Spinner spinner = (Spinner) findViewById(R.id.mySpinner);
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_spinner_item, items);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner.setAdapter(adapter); 
```

使用此代码，最初会显示项目“One”。我可以在项目中添加一个新项目“Select One”，但随后“Select One”也将作为第一项显示在下拉列表中，这不是我想要的。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2012-08-31T19:14:21.260

您可以做的是`SpinnerAdapter`用一个呈现“选择选项...”的视图来装饰您的视图，以便微调器在没有选择任何内容的情况下显示。

这是一个针对 Android 2.3 和 4.0 测试的工作示例（它不使用兼容性库中的任何内容，所以一段时间应该没问题）因为它是一个装饰器，所以应该很容易改造现有代码，并且它也适用于`CursorLoader`s。（当然，在包装上交换光标`cursorAdapter`......）

有一个 Android 错误使重用视图变得更加困难。（所以你必须使用`setTag`或其他东西来确保你`convertView`是正确的。）[Spinner 不支持多种视图类型](https://issuetracker.google.com/issues/36928962 "Spinner 不支持多种视图类型")

代码注释：2个构造函数

这允许您使用标准提示或将您自己的“未选择任何内容”定义为第一行，或两者兼而有之，或无。（注意：某些主题显示 Spinner 的 DropDown 而不是对话框。Dropdown 通常不显示提示）

您将布局定义为“看起来”像一个提示，例如，灰显...

![初始未选择](https://i.stack.imgur.com/aEL12.png)

使用标准提示（注意没有选择任何内容）：

![带有标准提示](https://i.stack.imgur.com/zFvtw.png)

或者有提示和动态的东西（也可能没有提示）：

![提示并且没有选择行](https://i.stack.imgur.com/TRDiy.png)

**上面例子中的用法**

```
Spinner spinner = (Spinner) findViewById(R.id.spinner);
ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.planets_array, android.R.layout.simple_spinner_item);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner.setPrompt("Select your favorite Planet!");

spinner.setAdapter(
      new NothingSelectedSpinnerAdapter(
            adapter,
            R.layout.contact_spinner_row_nothing_selected,
            // R.layout.contact_spinner_nothing_selected_dropdown, // Optional
            this)); 
```

**contact_spinner_row_nothing_selected.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    style="?android:attr/spinnerItemStyle"
    android:singleLine="true"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ellipsize="marquee"
    android:textSize="18sp"
    android:textColor="#808080"
    android:text="[Select a Planet...]" /> 
```

**NothingSelectedSpinnerAdapter.java**

```
import android.content.Context;
import android.database.DataSetObserver;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ListAdapter;
import android.widget.SpinnerAdapter;

/**
 * Decorator Adapter to allow a Spinner to show a 'Nothing Selected...' initially
 * displayed instead of the first choice in the Adapter.
 */
public class NothingSelectedSpinnerAdapter implements SpinnerAdapter, ListAdapter {

    protected static final int EXTRA = 1;
    protected SpinnerAdapter adapter;
    protected Context context;
    protected int nothingSelectedLayout;
    protected int nothingSelectedDropdownLayout;
    protected LayoutInflater layoutInflater;

    /**
     * Use this constructor to have NO 'Select One...' item, instead use
     * the standard prompt or nothing at all.
     * @param spinnerAdapter wrapped Adapter.
     * @param nothingSelectedLayout layout for nothing selected, perhaps
     * you want text grayed out like a prompt...
     * @param context
     */
    public NothingSelectedSpinnerAdapter(
      SpinnerAdapter spinnerAdapter,
      int nothingSelectedLayout, Context context) {

        this(spinnerAdapter, nothingSelectedLayout, -1, context);
    }

    /**
     * Use this constructor to Define your 'Select One...' layout as the first
     * row in the returned choices.
     * If you do this, you probably don't want a prompt on your spinner or it'll
     * have two 'Select' rows.
     * @param spinnerAdapter wrapped Adapter. Should probably return false for isEnabled(0)
     * @param nothingSelectedLayout layout for nothing selected, perhaps you want
     * text grayed out like a prompt...
     * @param nothingSelectedDropdownLayout layout for your 'Select an Item...' in
     * the dropdown.
     * @param context
     */
    public NothingSelectedSpinnerAdapter(SpinnerAdapter spinnerAdapter,
            int nothingSelectedLayout, int nothingSelectedDropdownLayout, Context context) {
        this.adapter = spinnerAdapter;
        this.context = context;
        this.nothingSelectedLayout = nothingSelectedLayout;
        this.nothingSelectedDropdownLayout = nothingSelectedDropdownLayout;
        layoutInflater = LayoutInflater.from(context);
    }

    @Override
    public final View getView(int position, View convertView, ViewGroup parent) {
        // This provides the View for the Selected Item in the Spinner, not
        // the dropdown (unless dropdownView is not set).
        if (position == 0) {
            return getNothingSelectedView(parent);
        }
        return adapter.getView(position - EXTRA, null, parent); // Could re-use
                                                 // the convertView if possible.
    }

    /**
     * View to show in Spinner with Nothing Selected
     * Override this to do something dynamic... e.g. "37 Options Found"
     * @param parent
     * @return
     */
    protected View getNothingSelectedView(ViewGroup parent) {
        return layoutInflater.inflate(nothingSelectedLayout, parent, false);
    }

    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) {
        // Android BUG! http://code.google.com/p/android/issues/detail?id=17128 -
        // Spinner does not support multiple view types
        if (position == 0) {
            return nothingSelectedDropdownLayout == -1 ?
              new View(context) :
              getNothingSelectedDropdownView(parent);
        }

        // Could re-use the convertView if possible, use setTag...
        return adapter.getDropDownView(position - EXTRA, null, parent);
    }

    /**
     * Override this to do something dynamic... For example, "Pick your favorite
     * of these 37".
     * @param parent
     * @return
     */
    protected View getNothingSelectedDropdownView(ViewGroup parent) {
        return layoutInflater.inflate(nothingSelectedDropdownLayout, parent, false);
    }

    @Override
    public int getCount() {
        int count = adapter.getCount();
        return count == 0 ? 0 : count + EXTRA;
    }

    @Override
    public Object getItem(int position) {
        return position == 0 ? null : adapter.getItem(position - EXTRA);
    }

    @Override
    public int getItemViewType(int position) {
        return 0;
    }

    @Override
    public int getViewTypeCount() {
        return 1;
    }

    @Override
    public long getItemId(int position) {
        return position >= EXTRA ? adapter.getItemId(position - EXTRA) : position - EXTRA;
    }

    @Override
    public boolean hasStableIds() {
        return adapter.hasStableIds();
    }

    @Override
    public boolean isEmpty() {
        return adapter.isEmpty();
    }

    @Override
    public void registerDataSetObserver(DataSetObserver observer) {
        adapter.registerDataSetObserver(observer);
    }

    @Override
    public void unregisterDataSetObserver(DataSetObserver observer) {
        adapter.unregisterDataSetObserver(observer);
    }

    @Override
    public boolean areAllItemsEnabled() {
        return false;
    }

    @Override
    public boolean isEnabled(int position) {
        return position != 0; // Don't allow the 'nothing selected'
                                             // item to be picked.
    }

} 
```

* * *

## 回答 #2

> 赞同：265
> 
> 时间：2010-08-06T19:25:25.977

这是一个覆盖`Spinner`视图的通用解决方案。它覆盖`setAdapter()`将初始位置设置为 -1，并代理提供`SpinnerAdapter`的以显示位置小于 0 的提示字符串。

这已经在 Android 1.5 到 4.2 上进行了测试，但买家要小心！由于此解决方案依赖于反射来调用私有`AdapterView.setNextSelectedPositionInt()`and `AdapterView.setSelectedPositionInt()`，因此不能保证在未来的操作系统更新中正常工作。看起来很可能会，但绝不能保证。

通常我不会宽恕这样的事情，但是这个问题已经被问了足够多的时间，而且这似乎是一个足够合理的要求，我认为我会发布我的解决方案。

```
/**
 * A modified Spinner that doesn't automatically select the first entry in the list.
 *
 * Shows the prompt if nothing is selected.
 *
 * Limitations: does not display prompt if the entry list is empty.
 */
public class NoDefaultSpinner extends Spinner {

    public NoDefaultSpinner(Context context) {
        super(context);
    }

    public NoDefaultSpinner(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public NoDefaultSpinner(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    @Override
    public void setAdapter(SpinnerAdapter orig ) {
        final SpinnerAdapter adapter = newProxy(orig);

        super.setAdapter(adapter);

        try {
            final Method m = AdapterView.class.getDeclaredMethod(
                               "setNextSelectedPositionInt",int.class);
            m.setAccessible(true);
            m.invoke(this,-1);

            final Method n = AdapterView.class.getDeclaredMethod(
                               "setSelectedPositionInt",int.class);
            n.setAccessible(true);
            n.invoke(this,-1);
        } 
        catch( Exception e ) {
            throw new RuntimeException(e);
        }
    }

    protected SpinnerAdapter newProxy(SpinnerAdapter obj) {
        return (SpinnerAdapter) java.lang.reflect.Proxy.newProxyInstance(
                obj.getClass().getClassLoader(),
                new Class[]{SpinnerAdapter.class},
                new SpinnerAdapterProxy(obj));
    }

    /**
     * Intercepts getView() to display the prompt if position < 0
     */
    protected class SpinnerAdapterProxy implements InvocationHandler {

        protected SpinnerAdapter obj;
        protected Method getView;

        protected SpinnerAdapterProxy(SpinnerAdapter obj) {
            this.obj = obj;
            try {
                this.getView = SpinnerAdapter.class.getMethod(
                                 "getView",int.class,View.class,ViewGroup.class);
            } 
            catch( Exception e ) {
                throw new RuntimeException(e);
            }
        }

        public Object invoke(Object proxy, Method m, Object[] args) throws Throwable {
            try {
                return m.equals(getView) && 
                       (Integer)(args[0])<0 ? 
                         getView((Integer)args[0],(View)args[1],(ViewGroup)args[2]) : 
                         m.invoke(obj, args);
            } 
            catch (InvocationTargetException e) {
                throw e.getTargetException();
            } 
            catch (Exception e) {
                throw new RuntimeException(e);
            }
        }

        protected View getView(int position, View convertView, ViewGroup parent) 
          throws IllegalAccessException {

            if( position<0 ) {
                final TextView v = 
                  (TextView) ((LayoutInflater)getContext().getSystemService(
                    Context.LAYOUT_INFLATER_SERVICE)).inflate(
                      android.R.layout.simple_spinner_item,parent,false);
                v.setText(getPrompt());
                return v;
            }
            return obj.getView(position,convertView,parent);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：134
> 
> 时间：2011-04-26T12:55:10.710

我最终改用了 a `Button`。虽然 a`Button`不是 a `Spinner`，但行为很容易定制。

首先像往常一样创建适配器：

```
String[] items = new String[] {"One", "Two", "Three"};
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_spinner_dropdown_item, items); 
```

请注意，我使用的`simple_spinner_dropdown_item`是布局 ID。这将有助于在创建警报对话框时创建更好的外观。

在我的 Button 的 onClick 处理程序中，我有：

```
public void onClick(View w) {
  new AlertDialog.Builder(this)
  .setTitle("the prompt")
  .setAdapter(adapter, new DialogInterface.OnClickListener() {

    @Override
    public void onClick(DialogInterface dialog, int which) {

      // TODO: user specific action

      dialog.dismiss();
    }
  }).create().show();
} 
```

就是这样！

* * *

## 回答 #4

> 赞同：67
> 
> 时间：2009-05-15T22:42:46.807

首先，您可能对类的`prompt`属性感兴趣`Spinner`。见下图，“Choose a Planet”是可以在XML中设置的提示 `android:prompt=""`。

[![在此处输入图像描述](https://i.stack.imgur.com/4a3Na.png)](https://i.stack.imgur.com/4a3Na.png)

我打算建议 subclassing `Spinner`，您可以在内部维护两个适配器。一个具有“选择一个”选项的适配器，另一个*真正的*适配器（带有实际选项），然后`OnClickListener`在显示选择对话框之前使用 切换适配器。但是，在尝试实现该想法后，我得出的结论是您无法接收`OnClick`小部件本身的事件。

您可以将微调器包装在不同的视图中，拦截视图上的点击，然后告诉您`CustomSpinner`切换适配器，但这似乎是一个可怕的 hack。

你真的需要显示“选择一个”吗？

* * *

## 回答 #5

> 赞同：60
> 
> 时间：2014-10-20T22:04:36.840

此代码已经过测试，可在 Android 4.4 上运行

![在此处输入图像描述](https://i.stack.imgur.com/onnOf.png)

```
Spinner spinner = (Spinner) activity.findViewById(R.id.spinner);
ArrayAdapter<String> adapter = new ArrayAdapter<String>(activity, android.R.layout.simple_spinner_dropdown_item) {

            @Override
            public View getView(int position, View convertView, ViewGroup parent) {

                View v = super.getView(position, convertView, parent);
                if (position == getCount()) {
                    ((TextView)v.findViewById(android.R.id.text1)).setText("");
                    ((TextView)v.findViewById(android.R.id.text1)).setHint(getItem(getCount())); //"Hint to be displayed"
                }

                return v;
            }       

            @Override
            public int getCount() {
                return super.getCount()-1; // you dont display last item. It is used as hint.
            }

        };

        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        adapter.add("Daily");
        adapter.add("Two Days");
        adapter.add("Weekly");
        adapter.add("Monthly");
        adapter.add("Three Months");
        adapter.add("HINT_TEXT_HERE"); //This is the text that will be displayed as hint.

        spinner.setAdapter(adapter);
        spinner.setSelection(adapter.getCount()); //set the hint the default selection so it appears on launch.
        spinner.setOnItemSelectedListener(this); 
```

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2010-07-20T15:54:09.780

我找到了这个解决方案：

```
String[] items = new String[] {"Select One", "Two", "Three"};
Spinner spinner = (Spinner) findViewById(R.id.mySpinner);
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_spinner_item, items);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner.setAdapter(adapter);

spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int position, long id) {
        items[0] = "One";
        selectedItem = items[position];
    }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
    }
}); 
```

只需使用“Select One”更改数组 [0]，然后在 onItemSelected 中将其重命名为“One”。

不是一个经典的解决方案，但它有效：D

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2016-09-29T23:18:24.370

这里有很多答案，但我很惊讶没有人提出一个简单的解决方案：在 Spinner 顶部放置一个 TextView。在 TextView 上设置一个点击监听器，它隐藏 TextView 显示 Spinner，并调用 spinner.performClick()。

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2014-03-31T23:44:24.793

没有默认 API 可以在 Spinner 上设置提示。要添加它，我们需要一个小的解决方法，而不是安全反射实现

```
List<Object> objects = new ArrayList<Object>();
objects.add(firstItem);
objects.add(secondItem);
// add hint as last item
objects.add(hint);

HintAdapter adapter = new HintAdapter(context, objects, android.R.layout.simple_spinner_item);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

Spinner spinnerFilmType = (Spinner) findViewById(R.id.spinner);
spinner.setAdapter(adapter);

// show hint
spinner.setSelection(adapter.getCount()); 
```

适配器来源：

```
public class HintAdapter
        extends ArrayAdapter<Objects> {

    public HintAdapter(Context theContext, List<Object> objects) {
        super(theContext, android.R.id.text1, android.R.id.text1, objects);
    }

    public HintAdapter(Context theContext, List<Object> objects, int theLayoutResId) {
        super(theContext, theLayoutResId, android.R.id.text1, objects);
    }

    @Override
    public int getCount() {
        // don't display last item. It is used as hint.
        int count = super.getCount();
        return count > 0 ? count - 1 : count;
    }
} 
```

[原始来源](http://yakivmospan.wordpress.com/2014/03/31/spinner-hint/)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-10-02T08:03:58.917

我在微调器上遇到了同样的问题，选择为空，我找到了更好的解决方案。看看这个简单的代码。

```
Spinner lCreditOrDebit = (Spinner)lCardPayView.findViewById(R.id.CARD_TYPE);
spinneradapter lAdapter = 
  new spinneradapter(
    BillPayScreen.this, 
    ndroid.R.layout.simple_spinner_item,getResources().getStringArray(R.array.creditordebit));
lAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
lCreditOrDebit.setAdapter(lAdapter); 
```

这里 spinneradapter 是对 arrayadapter 的一个小定制。它看起来像这样：

```
import android.content.Context;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;

public class spinneradapter extends ArrayAdapter<String>{
    private Context m_cContext;
    public spinneradapter(Context context,int textViewResourceId, String[] objects) {
        super(context, textViewResourceId, objects);
        this.m_cContext = context;
    }

    boolean firsttime = true;
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if(firsttime){
            firsttime = false;
            //Just return some empty view
            return new ImageView(m_cContext);
        }
        //Let the array adapter take care of it this time.
        return super.getView(position, convertView, parent);
    }
} 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2014-11-07T12:03:27.883

这是我的方式：

```
List<String> list = new ArrayList<String>();
list.add("string1");
list.add("string2");
list.add("string3");
list.add("[Select one]");
final int listsize = list.size() - 1;
ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, list) {
 @Override
public int getCount() {
    return(listsize); // Truncate the list
}
};
dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
mySpinner.setAdapter(dataAdapter);

mySpinner.setSelection(listsize); // Hidden item to appear in the spinner 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-08-09T02:25:42.700

您可以将其更改为文本视图并使用它：

```
android:style="@android:style/Widget.DeviceDefault.Light.Spinner" 
```

然后定义`android:text`属性。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-11-04T21:39:31.873

XML 文件：

```
<Spinner android:id="@+id/locationSpinner"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:prompt="@string/select_location" /> 
```

活动：

```
private Spinner featuresSelection;
private ArrayAdapter<CharSequence> featuresAdapter;
private List<CharSequence> featuresList; 
```

创建：

```
featuresList = new ArrayList<CharSequence>();
featuresAdapter = new ArrayAdapter<CharSequence>(this,
  android.R.layout.simple_spinner_item, featuresList);
featuresAdapter.setDropDownViewResource(
  android.R.layout.simple_spinner_dropdown_item);
featuresSelection = ((Spinner) yourActivity.this
  .findViewById(R.id.locationSpinner));
featuresSelection.setAdapter(featuresAdapter);
featuresSelection.setOnItemSelectedListener(
  new MyOnItemSelectedListener()); 
```

一些功能（以编程方式向适配器添加东西）>

```
featuresAdapter.add("some string"); 
```

现在您有一个空的微调器，您可以编写代码以在为空时不打开对话框。或者他们可以反击。但您也可以在运行时使用函数或其他列表填充它。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-10-09T02:25:43.320

我的 main.xml 上有一个微调器，它的 id 是`@+id/spinner1`

这是我在 OnCreate 函数中写的：

```
spinner1 = (Spinner)this.findViewById(R.id.spinner1);
final String[] groupes = new String[] {"A", "B", "C", "D", "E", "F", "G", "H"};
ArrayAdapter<CharSequence> featuresAdapter = new ArrayAdapter<CharSequence>(this, android.R.layout.simple_spinner_item, new ArrayList<CharSequence>());
featuresAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner1.setAdapter(featuresAdapter);
for (String s : groupes) featuresAdapter.add(s);

spinner1.setOnItemSelectedListener(new OnItemSelectedListener() {
     public void onItemSelected(AdapterView<?> arg0, View arg1, int position, long id) {
         // Here go your instructions when the user chose something
         Toast.makeText(getBaseContext(), groupes[position], 0).show();
     }
     public void onNothingSelected(AdapterView<?> arg0) { }
}); 
```

它不需要类中的任何实现。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2011-11-05T12:18:36.110

我试过如下。拿一个按钮并给它点击事件。通过更改按钮背景，它似乎是一个微调器。

声明为全局变量 alertdialog 和默认值..

```
AlertDialog d;
static int default_value = 0;
final Button btn = (Button) findViewById(R.id.button1);
btn .setOnClickListener(new View.OnClickListener() {

@Override
public void onClick(View v)
{
    //c.show();
    final CharSequence str[] = {"Android","Black Berry","Iphone"};
        AlertDialog.Builder builder =
          new AlertDialog.Builder(TestGalleryActivity.this).setSingleChoiceItems(
            str, default_value,new  DialogInterface.OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int position)
            {
                Toast.makeText(TestGalleryActivity.this,
                               "" + position,
                               Toast.LENGTH_SHORT).show();
                default_value = position;
                btn.setText(str[position]);
                if(d.isShowing())
                    d.dismiss();
            }
        }).setTitle("Select Any");
        d = builder.create();
        d.show();
    }
}); 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-01-30T10:36:19.727

此外，还有一个简单的技巧来显示默认值：

您可以在列表中添加默认值，然后使用添加所有集合`list.addAll(yourCollection);`

此处的示例可行代码：

```
List<FuelName> fuelList = new ArrayList<FuelName>();
                    fuelList.add(new FuelName(0,"Select One"));
                    fuelList.addAll(response.body());
                    ArrayAdapter adapter = new ArrayAdapter<>(getActivity(), android.R.layout.simple_spinner_item, fuelList);
                    //fuelName.setPrompt("Select Fuel");
                    fuelName.setAdapter(adapter); 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-09-15T20:46:48.753

查看 iosched 应用程序，了解将元素添加到列表顶部的通用解决方案。特别是，如果您使用 CursorAdapter，请查看[TracksAdapter.java](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/ui/TracksAdapter.java)，它扩展了该定义以提供“setHasAllItem”方法和相关代码来管理列表计数以处理顶部的额外项目。

使用自定义适配器，您可以将文本设置为“选择一个”或您可能希望该顶部项目说的任何其他内容。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-10-24T00:52:26.143

我为此找到了许多好的解决方案。大多数通过在适配器的末尾添加一个项目来工作，并且不显示下拉列表中的最后一个项目。对我来说最大的问题是微调器下拉列表将从列表底部开始。因此，在第一次触摸微调器后，用户会看到最后一个项目而不是第一个项目（如果有很多项目要显示）。

所以我把提示项放在列表的开头。并隐藏下拉列表中的第一项。

```
private void loadSpinner(){

    HintArrayAdapter hintAdapter = new HintArrayAdapter<String>(context, 0);

    hintAdapter.add("Hint to be displayed");
    hintAdapter.add("Item 1");
    hintAdapter.add("Item 2");
            .
            .
    hintAdapter.add("Item 30");

    spinner1.setAdapter(hintAdapter);

    //spinner1.setSelection(0); //display hint. Actually you can ignore it, because the default is already 0
    //spinner1.setSelection(0, false); //use this if don't want to onItemClick called for the hint

    spinner1.setOnItemSelectedListener(yourListener);
}

private class HintArrayAdapter<T> extends ArrayAdapter<T> {

    Context mContext;

    public HintArrayAdapter(Context context, int resource) {
        super(context, resource);
        this.mContext = context
    }

    @Override 
    public View getView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(Activity.LAYOUT_INFLATER_SERVICE);
        View view = inflater.inflate(android.R.layout.simple_spinner_item, parent, false);
        TextView texview = (TextView) view.findViewById(android.R.id.text1);

        if(position == 0) {
            texview.setText("");
            texview.setHint(getItem(position).toString()); //"Hint to be displayed"
        } else {
            texview.setText(getItem(position).toString());
        }

        return view;
    }

    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(Activity.LAYOUT_INFLATER_SERVICE);
        View view;

        if(position == 0){
            view = inflater.inflate(R.layout.spinner_hint_list_item_layout, parent, false); // Hide first row
        } else {
            view = inflater.inflate(android.R.layout.simple_spinner_dropdown_item, parent, false);
            TextView texview = (TextView) view.findViewById(android.R.id.text1);
            texview.setText(getItem(position).toString());
        } 

        return view;
    }
} 
```

当 position 为 0 时，在 @Override getDropDownView() 中设置以下布局，以隐藏第一个提示行。

R.layout.spinner_hint_list_item_layout：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

</LinearLayout> 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-11-14T16:28:02.340

我认为最简单的方法是在索引 0 上创建一个虚拟项目，说“选择一个”，然后在保存时检查选择是否不是 0。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-04-04T09:38:13.987

所以这是我最后一个按钮微调器的“全押”示例

在**activity_my_form.xml**

```
 <Button
        android:id="@+id/btnSpinnerPlanets"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="left|center_vertical"
        android:singleLine="true"
        android:text="@string/selectAPlanet"
        android:textSize="10sp"
        android:background="@android:drawable/btn_dropdown">
    </Button> 
```

在**strings.xml中**

```
<string name="selectAPlanet">Select planet&#8230;</string>

<string-array name="planets__entries">
    <item>The Sun with a name very long so long long long long longThe Sun with a name very long so long long long long longThe Sun with a name very long so long long long long long</item>
    <item>Mercury</item>
    <item>Venus</item>
    <item>Earth</item>
    <item>Mars</item>
    <item>Jupiter</item>
    <item>Saturn</item>
    <item>Uranus</item>
    <item>Neptune</item>
</string-array> 
```

在**MyFormActivity.java**

```
public class MyFormActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        ((Button) findViewById(R.id.btnSpinnerPlanets)).setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                final String[] items = view.getResources().getStringArray(R.array.planets__entries);
                ArrayAdapter<String> adapter = new ArrayAdapter<String>(MyFormActivity.this, android.R.layout.simple_spinner_dropdown_item, items);
                new AlertDialog.Builder(MyFormActivity.this).setTitle("the prompt").setAdapter(adapter, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        ((Button) findViewById(R.id.btnSpinnerPlanets)).setText(items[which]);
                        dialog.dismiss();
                    }
                }).create().show();
            }
        });     

    }

} 
```

最后我得到了一个字体大小可配置的无第一项可选按钮微调器！！！ *感谢HRJ*

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-08-14T09:30:59.850

我为此找到的最佳解决方案实际上不是使用 Spinner，而是使用 AutoCompleteTextView。它基本上是一个带有 Spinner 的 EditText，用于在您键入时显示建议 - 但是，使用正确的配置，它可以完全按照 OP 的意愿行事等等。

XML:

```
<com.google.android.material.textfield.TextInputLayout
                android:id="@+id/item"
                android:layout_width="match_parent"
                android:layout_height="wrap_content">

            <androidx.appcompat.widget.AppCompatAutoCompleteTextView
                    android:id="@+id/input"
                    android:hint="Select one"
                    style="@style/AutoCompleteTextViewDropDown"/>
        </com.google.android.material.textfield.TextInputLayout> 
```

风格：

```
<style name="AutoCompleteTextViewDropDown">
    <item name="android:clickable">false</item>
    <item name="android:cursorVisible">false</item>
    <item name="android:focusable">false</item>
    <item name="android:focusableInTouchMode">false</item>
    <item name="android:layout_width">match_parent</item>
    <item name="android:layout_height">wrap_content</item>
</style> 
```

至于适配器，请使用基本的 ArrayAdapter 或将其扩展为您自己的，但无需在适配器端进行额外的自定义。在 AutoCompleteTextView 上设置适配器。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-03-23T13:59:42.883

扩展时`SpinnerAdapter`，您覆盖两个`View`生成方法，`getView(int, View, ViewGroup)`并且`getDropDownView(int, View, ViewGroup)`. 第一个提供`View`插入到`Spinner`自身中；第二个提供`View`下拉列表中的 （顾名思义）。您可以覆盖 ，`getView(...)`以便在选择项目之前，它会显示一个`TextView`包含提示；然后，当您检测到已选择一个项目时，您将其更改为显示与该项目`TextView`相对应的一个。

```
public class PromptingAdapter extends SpinnerAdapter {

    //... various code ...

    private boolean selectionmade = false;

    //call this method from the OnItemSelectedListener for your Spinner
    public setSelectionState(boolean b) {
        selectionmade = b;
    }

    @Override
    public View getView(int position, View recycle, ViewGroup container) {
        if(selectionmade) {
            //your existing code to supply a View for the Spinner
            //you could even put "return getDropDownView(position, recycle, container);"
        }
        else {
            View output;
            if(recycle instanceof TextView) {
                 output = recycle;
            }
            else {
                 output = new TextView();
                 //and layout stuff
            }
            output.setText(R.string.please_select_one);
            //put a string "please_select_one" in res/values/strings.xml
            return output;
        }
    }

//...
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-08-11T17:26:43.923

对于那些使用 Xamarin 的人，这里是与上面 aaronvargas 的答案等效的 C#。

```
using Android.Content;
using Android.Database;
using Android.Views;
using Android.Widget;
using Java.Lang;

namespace MyNamespace.Droid
{ 
  public class NothingSelectedSpinnerAdapter : BaseAdapter, ISpinnerAdapter, IListAdapter
  {
    protected static readonly int EXTRA = 1;
    protected ISpinnerAdapter adapter;
    protected Context context;
    protected int nothingSelectedLayout;
    protected int nothingSelectedDropdownLayout;
    protected LayoutInflater layoutInflater;

    public NothingSelectedSpinnerAdapter(ISpinnerAdapter spinnerAdapter, int nothingSelectedLayout, Context context) : this(spinnerAdapter, nothingSelectedLayout, -1, context)
    {
    }

    public NothingSelectedSpinnerAdapter(ISpinnerAdapter spinnerAdapter, int nothingSelectedLayout, int nothingSelectedDropdownLayout, Context context)
    {
      this.adapter = spinnerAdapter;
      this.context = context;
      this.nothingSelectedLayout = nothingSelectedLayout;
      this.nothingSelectedDropdownLayout = nothingSelectedDropdownLayout;
      layoutInflater = LayoutInflater.From(context);
    }

    protected View GetNothingSelectedView(ViewGroup parent)
    {
      return layoutInflater.Inflate(nothingSelectedLayout, parent, false);
    }

    protected View GetNothingSelectedDropdownView(ViewGroup parent)
    {
      return layoutInflater.Inflate(nothingSelectedDropdownLayout, parent, false);
    }

    public override Object GetItem(int position)
    {
      return position == 0 ? null : adapter.GetItem(position - EXTRA);
    }

    public override long GetItemId(int position)
    {
      return position >= EXTRA ? adapter.GetItemId(position - EXTRA) : position - EXTRA;
    }

    public override View GetView(int position, View convertView, ViewGroup parent)
    {
      // This provides the View for the Selected Item in the Spinner, not
      // the dropdown (unless dropdownView is not set).
      if (position == 0)
      {
        return GetNothingSelectedView(parent);
      }

      // Could re-use the convertView if possible.
      return this.adapter.GetView(position - EXTRA, null, parent);
    }

    public override int Count
    {
      get
      {
        int count = this.adapter.Count;
        return count == 0 ? 0 : count + EXTRA;
      }
    }

    public override View GetDropDownView(int position, View convertView, ViewGroup parent)
    {
      // Android BUG! http://code.google.com/p/android/issues/detail?id=17128 -
      // Spinner does not support multiple view types
      if (position == 0)
      {
        return nothingSelectedDropdownLayout == -1 ?
          new View(context) :
          GetNothingSelectedDropdownView(parent);
      }

      // Could re-use the convertView if possible, use setTag...
      return adapter.GetDropDownView(position - EXTRA, null, parent);
    }

    public override int GetItemViewType(int position)
    {
      return 0;
    }

    public override int ViewTypeCount => 1;

    public override bool HasStableIds => this.adapter.HasStableIds;

    public override bool IsEmpty => this.adapter.IsEmpty;

    public override void RegisterDataSetObserver(DataSetObserver observer)
    {
      adapter.RegisterDataSetObserver(observer);
    }

    public override void UnregisterDataSetObserver(DataSetObserver observer)
    {
      adapter.UnregisterDataSetObserver(observer);
    }

    public override bool AreAllItemsEnabled()
    {
      return false;
    }

    public override bool IsEnabled(int position)
    {
      return position > 0;
    }
  }
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2017-10-07T21:50:32.770

我还使用以下代码解决了这个问题。假设您有一个项目列表，例如

```
ArrayList<Item> itemsArrayList = new ArrayList<Item>();
Item item1 = new Item();
item1.setId(1);
item1.setData("First Element");
Item item2 = new Item();
item2.setId(2);
Item2.setData("Second Element");
itemsArrayList.add(item1);
itemsArrayList.add(item2); 
```

现在我们必须向微调器提供字符串，因为微调器无法理解对象。所以我们将创建一个带有这样的字符串项的新数组列表 ->

```
ArrayList<String> itemStringArrayList = new ArrayList<String>();
for(Item item : itemsArrayList) {
    itemStringArrayList.add(item.getData());
} 
```

现在我们有`itemStringArrayList`两个字符串项的数组列表。我们必须将“选择项目”文本显示为第一项。所以我们必须在`itemStringArrayList`.

```
itemStringArrayList.add("Select Item"); 
```

现在我们有一个数组列表`itemsArrayList`，我们想在下拉列表中显示两个元素。但是这里的条件是......如果我们不选择任何东西，那么`Select Item`应该作为第一个元素出现，它将不会被启用。

所以我们可以像这样实现这个功能。如果您需要将数组列表项加载到 android 微调器中。所以你将不得不使用一些适配器。所以在这里我将使用`ArrayAdapter`. 我们也可以使用自定义适配器。

```
ArrayAdapter<String> itemsArrayAdapter = new ArrayAdapter<String>(getApplicationContext(), R.layout.spinner_item, itemsArrayList){
        @Override
        public boolean isEnabled(int position) {
            if(position == 0)
            {
                return false;
            }
            else
            {
                return true;
            }
        }

        @Override
        public View getDropDownView(int position, View convertView,
                                    ViewGroup parent) {
            View view = super.getDropDownView(position, convertView, parent);
            TextView tv = (TextView) view;
            if(position == 0){
                // Set the hint text color gray
                tv.setTextColor(Color.GRAY);
            }
            else {
                tv.setTextColor(Color.BLACK);
            }
            return view;
        }
    };

itemsArrayAdapter.setDropDownViewResource(R.layout.spinner_item);
your_spinner_name.setAdapter(itemsArrayAdapter); 
```

在这段代码中。我们正在使用自定义微调器布局，即`R.layout.spinner_item`。这是一个简单的文本视图

```
<?xml version="1.0" encoding="utf-8"?>
<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="10dp"
    android:textStyle="italic"
    android:fontFamily="sans-serif-medium"
    /> 
```

我们需要禁用微调器中的第一个文本。所以对于位置 0，我们禁用文本。我们也可以通过覆盖 getDropDownView 方法来设置颜色。所以通过这种方式，我们将得到预期的微调器。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-02-09T09:57:11.947

我昨天遇到了同样的问题，不想向 ArrayAdapter 添加隐藏项或使用反射，这工作正常但有点脏。

在阅读了许多帖子并尝试之后，我通过扩展`ArrayAdapter`和覆盖该`getView`方法找到了解决方案。

```
import android.content.Context;
import android.support.annotation.NonNull;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.TextView;

/**
 * A SpinnerAdapter which does not show the value of the initial selection initially,
 * but an initialText.
 * To use the spinner with initial selection instead call notifyDataSetChanged().
 */
public class SpinnerAdapterWithInitialText<T> extends ArrayAdapter<T> {

    private Context context;
    private int resource;

    private boolean initialTextWasShown = false;
    private String initialText = "Please select";

    /**
     * Constructor
     *
     * @param context The current context.
     * @param resource The resource ID for a layout file containing a TextView to use when
     *                 instantiating views.
     * @param objects The objects to represent in the ListView.
     */
    public SpinnerAdapterWithInitialText(@NonNull Context context, int resource, @NonNull T[] objects) {
        super(context, resource, objects);
        this.context = context;
        this.resource = resource;
    }

    /**
     * Returns whether the user has selected a spinner item, or if still the initial text is shown.
     * @param spinner The spinner the SpinnerAdapterWithInitialText is assigned to.
     * @return true if the user has selected a spinner item, false if not.
     */
    public boolean selectionMade(Spinner spinner) {
        return !((TextView)spinner.getSelectedView()).getText().toString().equals(initialText);
    }

    /**
     * Returns a TextView with the initialText the first time getView is called.
     * So the Spinner has an initialText which does not represent the selected item.
     * To use the spinner with initial selection instead call notifyDataSetChanged(),
     * after assigning the SpinnerAdapterWithInitialText.
     */
    @Override
    public View getView(int position, View recycle, ViewGroup container) {
        if(initialTextWasShown) {
            return super.getView(position, recycle, container);
        } else {
            initialTextWasShown = true;
            LayoutInflater inflater = LayoutInflater.from(context);
            final View view = inflater.inflate(resource, container, false);

            ((TextView) view).setText(initialText);

            return view;
        }
    }
} 
```

Android 在初始化 Spinner 时所做的是，在为`T[] objects`. `SpinnerAdapterWithInitialText`返回 a`TextView`和，第`initialText`一次调用它。如果您正常使用 Spinner，则它调用的所有其他时间都是调用`super.getView`的`getView`方法。`ArrayAdapter`

要确定用户是否选择了微调器项目，或者微调器是否仍显示`initialText`，请调用`selectionMade`并移交适配器分配给的微调器。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-08-19T16:53:28.100

如果您只有三个选择，我只会使用带有 RadioButtons 的 RadioGroup，您可以首先将它们全部取消选中。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-07-19T05:07:35.183

以前提交的答案都没有真正按照我想要解决这个问题的方式工作。对我来说，理想的解决方案是在微调器首次显示时提供“选择一个”（或任何初始文本）。当用户点击微调器时，初始文本不应该是显示的下拉列表的一部分。

为了使我的特殊情况更加复杂，我的微调器数据来自通过 LoaderManager 回调加载的游标。

经过大量实验，我想出了以下解决方案：

```
public class MyFragment extends Fragment implements
LoaderManager.LoaderCallbacks<Cursor>{

private static final String SPINNER_INIT_VALUE = "Select A Widget";
private Spinner mSpinner;
private int mSpinnerPosition;
private boolean mSpinnerDropDownShowing = false;
private View mSpinnerDropDown;

private MyCursorAdapter mCursorAdapter;

...

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){
...

mCursorAdapter = new MyCursorAdapter(getActivity());

mSpinner = (Spinner) rootView.findViewById(R.id.theSpinner);
mSpinner.setOnTouchListener(mSpinnerTouchListener);
mSpinner.setAdapter(mCursorAdapter);

...
}

//Capture the touch events to toggle the spinner's dropdown visibility
private OnTouchListener mSpinnerTouchListener = new View.OnTouchListener() {
    @Override
    public boolean onTouch(View view, MotionEvent motionEvent) {
        if(mSpinnerDropDown != null && mSpinnerDropDownShowing == false){
            mSpinnerDropDownShowing = true;
            mSpinnerDropDown.setVisibility(View.VISIBLE);
        }
        return false;
    }
};

//Capture the click event on the spinner drop down items
protected OnClickListener spinnerItemClick = new OnClickListener(){

    @Override
    public void onClick(View view) {
        String widget = ((TextView) view.findViewById(android.R.id.text1)).getText().toString();

        if(!widget.equals(SPINNER_INIT_VALUE)){
            if(mCursorAdapter != null){
                Cursor cursor = mCursorAdapter.getCursor();
                if(cursor.moveToFirst()){
                    while(!cursor.isAfterLast()){
                        if(widget.equals(cursor.getString(WidgetQuery.WIDGET_NAME))){

                            ...

                            //Set the spinner to the correct item
                            mSpinnerPosition = cursor.getPosition() + 1;
                            mSpinner.setSelection(mSpinnerPosition);
                            break;
                        }
                        cursor.moveToNext();
                    }
                }
            }
        }

        //Hide the drop down. Not the most elegent solution but it is the only way I could hide/dismiss the drop down
        mSpinnerDropDown = view.getRootView();
        mSpinnerDropDownShowing = false;
        mSpinnerDropDown.setVisibility(View.GONE);
    }
};

private class MyCursorAdapter extends CursorAdapter {

    private final int DISPLACEMENT = 1;
    private final int DEFAULT_ITEM_ID = Integer.MAX_VALUE;

    private Activity mActivity;

    public MyCursorAdapter(Activity activity) {
            super(activity, null, false);
            mActivity = activity;
    }

    //When loading the regular views, inject the defualt item
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if(position == 0){
            if(convertView == null){
                convertView = mActivity.getLayoutInflater().inflate(R.layout.list_item_widget, parent, false);
            }
            return getDefaultItem(convertView);
        }
        return super.getView(position - DISPLACEMENT, convertView, parent);
    }

    //When loading the drop down views, set the onClickListener for each view
    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent){
        View view = super.getDropDownView(position, convertView, parent);
        view.setOnClickListener(spinnerItemClick);
        return view;
    }

    //The special default item that is being injected
    private View getDefaultItem(View convertView){
        TextView text = (TextView) convertView.findViewById(android.R.id.text1);
        text.setText(SPINNER_INIT_VALUE);
        return convertView;
    }

    @Override
    public long getItemId(int position) {
        if (position == 0) {
            return DEFAULT_ITEM_ID;
        }
        return super.getItemId(position - DISPLACEMENT);
    }

    @Override
    public boolean isEnabled(int position) {
        return position == 0 ? true : super.isEnabled(position - DISPLACEMENT);
    }

    @Override
    public int getViewTypeCount() {
        return super.getViewTypeCount() + DISPLACEMENT;
    }

    @Override
    public int getItemViewType(int position) {
        if (position == 0) {
            return super.getViewTypeCount();
        }

        return super.getItemViewType(position - DISPLACEMENT);
    }

    @Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) {
        return mActivity.getLayoutInflater().inflate(R.layout.list_item_widget, parent, false);
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor){

        if(cursor.isAfterLast()){
            return;
        }

        TextView text = (TextView) view.findViewById(android.R.id.text1);
        String WidgetName = cursor.getString(WidgetQuery.WIDGET_NAME);
        text.setText(WidgetName);
    }
}
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-10-17T14:42:14.010

我通过使用按钮而不是 Spinner 来处理这个问题。 [我在 GitHub 上有示例项目。](https://github.com/sberg413/SpinnerButton)

在项目中，我同时显示 Spinner 和按钮，以表明它们确实看起来相同。除了按钮，您可以将初始文本设置为您想要的任何内容。

这是活动的样子：

```
package com.stevebergamini.spinnerbutton;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.Spinner;

public class MainActivity extends Activity {

    Spinner spinner1;
    Button button1;
    AlertDialog ad;
    String[] countries;

    int selected = -1;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        spinner1 = (Spinner) findViewById(R.id.spinner1);
        button1 = (Button) findViewById(R.id.button1);

        countries = getResources().getStringArray(R.array.country_names);

        //  You can also use an adapter for the allert dialog if you'd like
        //  ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_dropdown_item, countries);        

        ad = new AlertDialog.Builder(MainActivity.this).setSingleChoiceItems(countries, selected,  
                new  DialogInterface.OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            button1.setText(countries[which]);
                            selected = which;
                            ad.dismiss();

                        }}).setTitle(R.string.select_country).create(); 

        button1.setOnClickListener( new OnClickListener(){

            @Override
            public void onClick(View v) {
                ad.getListView().setSelection(selected);
                ad.show();              
            }});

    }

} 
```

**注意：** 是的，我意识到这取决于应用的主题，如果使用 Theme.Holo，外观会略有不同。但是，如果您使用的是 Theme.Black 等传统主题之一，那么您就可以开始使用了。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-12-12T00:45:20.200

似乎是一个平庸的解决方案，但我通常只是在微调器的前面放一个 TextView。整个 Xml 看起来像这样。（嘿伙计们，别开枪，我知道你们有些人不喜欢这种婚姻）：

```
<FrameLayout
    android:id="@+id/selectTypesLinear"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <Spinner
        android:id="@+id/spinnerExercises"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:entries="@array/exercise_spinner_entries"
        android:prompt="@string/exercise_spinner_prompt"
     />                         
    <TextView
        android:id="@+id/spinnerSelectText"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:text="Hey! Select this guy!"
        android:gravity="center"
        android:background="#FF000000" />

</FrameLayout> 
```

然后我在选择项目时隐藏 TextView。显然TextView的背景颜色应该和Spinner一样。适用于 Android 4.0。不知道老版本。

是的。因为 Spinner 在开始时调用了 setOnItemSelectedListener，所以 textview 的隐藏可能有点棘手，但可以这样完成：

```
 Boolean controlTouched;

    exerciseSpinner.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            controlTouched = true; // I touched it but but not yet selected an Item.
            return false;
        }

    });
    exerciseSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {

        @Override
        public void onItemSelected(AdapterView<?> arg0, View arg1,
                int arg2, long arg3) {
            if (controlTouched) { // Are you sure that I touched it with my fingers and not someone else  ?
                spinnerSelText.setVisibility(View.GONE);
            }
        }

        @Override
        public void onNothingSelected(AdapterView<?> arg0) {
        }

    }); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-03-24T07:07:24.243

如果您在**从 database-cursor 填充项目时遇到**此问题，

我在[这个](https://stackoverflow.com/a/12568025/1665247)SO 答案中找到的最简单的解决方案：

**在游标适配器查询中使用 UNION**并将 id= -1 的附加项添加到查询结果中，而不是将其真正添加到数据库中：

就像是：

```
db.rawQuery("SELECT iWorkerId as _id, nvLastName as name  FROM  Worker
w  UNION  SELECT -1 as _id , '' as name",null); 
```

如果选择的项目是-1，那么它是默认值。否则，它是表中的记录。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-05-20T13:10:55.190

对我来说，它的工作原理是这样的。具有仅更改某些选项中的文本的改进，而不是全部更改。

首先，我取微调器的名称并使用自定义视图创建 arrayadapter，但现在没关系，关键是覆盖 getView，并在内部更改您需要更改的值。在我的情况下只有第一个，其余的我留下原来的

```
public void rellenarSpinnerCompeticiones(){
        spinnerArrayCompeticiones = new ArrayList<String>();
        for(Competicion c: ((Controlador)getApplication()).getCompeticiones()){
            spinnerArrayCompeticiones.add(c.getNombre());
        }
        //ArrayAdapter<String> spinnerArrayAdapter = new ArrayAdapter<String>(this,R.layout.spinner_item_competicion,spinnerArrayCompeticiones);
        ArrayAdapter<String> spinnerArrayAdapter = new ArrayAdapter<String>(this, R.layout.spinner_item_competicion, spinnerArrayCompeticiones){
            @Override
            public View getView(int position, View convertView, ViewGroup parent) {
                LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                final View v = vi.inflate(R.layout.spinner_item_competicion, null);
                final TextView t = (TextView)v.findViewById(R.id.tvCompeticion);
                if(spinnerCompeticion.getSelectedItemPosition()>0){
                    t.setText(spinnerArrayCompeticiones.get(spinnerCompeticion.getSelectedItemPosition()));
                }else{
                    t.setText("Competiciones");
                }
                return v;
            }
        };
        spinnerArrayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinnerCompeticion.setAdapter(spinnerArrayAdapter);
    } 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-12-07T15:37:41.747

```
private boolean isFirst = true;
private void setAdapter() {
    final ArrayList<String> spinnerArray = new ArrayList<String>();     
    spinnerArray.add("Select your option");
    spinnerArray.add("Option 1");
    spinnerArray.add("Option 2");
    spin.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
        @Override
        public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
            TextView tv = (TextView)selectedItemView;
            String res = tv.getText().toString().trim();
            if (res.equals("Option 1")) {
            //do Something
        } else if (res.equals("Option 2")) {
            //do Something else
        }
        }

        @Override
        public void onNothingSelected(AdapterView<?> parentView) { }

    });

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.my_spinner_style,spinnerArray) {
         public View getView(int position, View convertView, ViewGroup parent) {
             View v = super.getView(position, convertView, parent);
             int height = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 25, getResources().getDisplayMetrics());                  
             ((TextView) v).setTypeface(tf2);
             ((TextView) v).getLayoutParams().height = height;
             ((TextView) v).setGravity(Gravity.CENTER);
             ((TextView) v).setTextSize(TypedValue.COMPLEX_UNIT_SP, 19);
             ((TextView) v).setTextColor(Color.WHITE);
             return v;
         }

         public View getDropDownView(int position, View convertView,
                 ViewGroup parent) {
             if (isFirst) {
                 isFirst = false;
                 spinnerArray.remove(0);
             }
             View v = super.getDropDownView(position, convertView, parent);                  
             ((TextView) v).setTextColor(Color.argb(255, 70, 70, 70));
             ((TextView) v).setTypeface(tf2);
             ((TextView) v).setGravity(Gravity.CENTER);
             return v;
         }
     };
     spin.setAdapter(adapter);
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2015-10-14T19:30:00.413

请参阅上述答案之一：[https ://stackoverflow.com/a/23005376/1312796](https://stackoverflow.com/a/23005376/1312796)

我添加了我的代码来修复一个小错误。没有检索到数据的地方..如何显示提示文本..！

这是我的技巧……它对我很有效。！

尝试将微调器放在 Relative_layout 中并将 Textview 与微调器对齐，并在微调器的适配器加载或空时使用 Textview 的可见性（显示/隐藏）。像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_marginLeft="10dp"
android:layout_marginRight="10dp"
android:layout_marginTop="20dp"
android:background="#ededed"
android:orientation="vertical">

    <TextView
        android:id="@+id/txt_prompt_from"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:textColor="@color/gray"
        android:textSize="16sp"
        android:layout_alignStart="@+id/sp_from"
        android:text="From"
        android:visibility="gone"/>

    <Spinner
        android:id="@+id/sp_from"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        /> 
```

这是代码：

```
 txt__from = (TextView) rootView.findViewById(R.id.txt_prompt_from); 
```

在微调器适配器加载和清空之前和之前调用此方法。

```
setPromptTextViewVisibility (); //True or fales 

public void setPromptTextViewVisibility (boolean visible )
{
    if (visible)
    {
        txt_from.setVisibility(View.VISIBLE);
    }
    else
    {
        txt_from.setVisibility(View.INVISIBLE);
    }

} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-06-28T08:20:40.150

```
String[] listAges = getResources().getStringArray(R.array.ages);

        // Creating adapter for spinner
        ArrayAdapter<String> dataAdapter =
                new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, listAges);

        // Drop down layout style - list view with radio button
        dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

        // attaching data adapter to spinner
        spinner_age.getBackground().setColorFilter(ContextCompat.getColor(this, R.color.spinner_icon), PorterDuff.Mode.SRC_ATOP);
        spinner_age.setAdapter(dataAdapter);
        spinner_age.setSelection(0);
        spinner_age.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
                String item = parent.getItemAtPosition(position).toString();

                if(position > 0){
                    // get spinner value
                    Toast.makeText(parent.getContext(), "Age..." + item, Toast.LENGTH_SHORT).show();
                }else{
                    // show toast select gender
                    Toast.makeText(parent.getContext(), "none" + item, Toast.LENGTH_SHORT).show();
                }
            }
            @Override
            public void onNothingSelected(AdapterView<?> parent) {
            }
        }); 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2018-05-05T19:53:16.437

```
public AdapterView.OnItemSelectedListener instructorSpinnerListener = new AdapterView.OnItemSelectedListener() {
    @Override
    public void onItemSelected(AdapterView << ? > adapterView, View view, int i, long l) {
        String selectedInstructorName = adapterView.getItemAtPosition(i).toString();
        if (selectedInstructorName.equals("[Select Instructor]")) {
            instructorSpinnerAdapter.clear();
            for (Offering offering: allOfferingsList)
                instructorSpinnerAdapter.add(offering);
        } else {
            instructorSpinnerAdapter.clear();
        }
    }

    @Override
    public void onNothingSelected(AdapterView<< ? > adapterView) {
        adapterView.setSelection(0);

        // Toast.makeText(getApplicationContext(), "Why?", Toast.LENGTH_SHORT).show();
    }
}; 
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2016-02-15T07:37:38.903

考虑有 N 个项目可供选择。

添加这 N 项后，将提示文本添加为​​第 (N+1) 项。

将所选项目设置为第 N 个位置 [第 (N+1) 个项目]。

在您的 OnItemSelected 监听器中，如果选中的位置不是 N，则弹出最后一项并调用 Adapter.notifyDataSetChanged() 并将选中的项目设置为选中的位置。

像这样的东西：

```
 spinner.setItems("Daily", "One time", "Frequency"); // here "Frequency is the hint text"
    spinner.setSelectedIndex(2);

    spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
        @Override
        public void onItemSelected(Spinner view, int position, long id, Object item) {
            if (position != 2) {
                view.setItems("Daily", "One time");
                view.setSelectedIndex(position);
            }else {
                // This item is not a valid selection
            }
        }
    }); 
```

* * *

## 回答 #36

> 赞同：-4
> 
> 时间：2015-06-18T08:19:10.690

```
 ArrayList<String> sizes = new ArrayList<>();

 spinner = (Spinner) findViewById(R.id.spinner_size);

    if (sizes != null && !sizes.isEmpty()) {

        //SORT ArrayList If You Want Data in ASC or DSC Order

        sizes.add("28");
        sizes.add("29");
        sizes.add("31");

        sizes.add("Choose Size"); //adding String at the end of ArrayList
        Collections.reverse(sizes); //Last Item Will Be Shown As A Spinner Title

        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, sizes);
        spinner.setAdapter(adapter); 
```

*只需使用 arraylist.add("Your Data") 方法在 arrayList 的末尾添加项目，然后使用 Collection.reverse(arrayList) 将其反转，以便标题成为 Spinner 中的第一个项目。您还可以在最后添加数据之前对项目进行排序。* ![在此处输入图像描述](https://i.stack.imgur.com/2kP8J.jpg)

# python - 如何捕获 str 异常？

> ID：867522
> 
> 赞同：2
> 
> 时间：2009-05-15T08:11:01.410
> 
> 标签：python, exception, string

```
import sys
try:
    raise "xxx"
except str,e:
    print "1",e
except:
    print "2",sys.exc_type,sys.exc_value 
```

在上面的代码中，引发了一个字符串异常，尽管已弃用但我使用的第 3 方库仍然使用它。那么如何在不依赖全部捕获的情况下捕获此类异常，这可能很糟糕。

除了str，e：没有抓住它？为什么？

系统：Linux2 上的 Python 2.5.2 (r252:60911, Jul 31 2008, 17:28:52) [GCC 4.2.3 (Ubuntu 4.2.3-2ubuntu7)]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T08:22:14.253

通用`except:`子句是捕获所有 str 异常的唯一方法。

str 异常是一个遗留的 Python 特性。在新代码中，您应该使用`raise Exception("xxx")`或引发您自己的 Exception 子类，或者`assert 0, "xxx"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T11:54:47.160

这是来自[python 邮件列表](http://groups.google.com/group/comp.lang.python/browse_frm/thread/6f82aa367e86a54e/6891821d373b50a8#6891821d373b50a8)的解决方案，不是很优雅，但如果不能避免这种黑客的需要，它会起作用

```
import sys
try:
     raise "a string exception"
except:
     e, t, tb = sys.exc_info()
     if not isinstance(e, str):
          raise    
     print "caught", e 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T08:19:29.610

```
try:
    raise "xxx"

except "xxx":
    print "xxx caught" 
```

`except <class>``Exception`仅适用于我认为是子类的类。哦，顺便说一句，`basestring`在检查字符串类型时使用，也适用于 unicode 字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T10:53:12.707

提高原始字符串是错误的。这是一个已弃用的功能（因此应该提出警告）。如果您真的需要它，捕获显式字符串将起作用，捕获所有内容也是如此。由于捕获所有内容会使代码变得丑陋，因此*我*建议显式捕获字符串，甚至更好：修复损坏的库。

```
try:
    #code_that_throws_string()
    raise("spam")
except "spam":
    pass 
```

将达到通过声明。有很多充分的理由不使用字符串作为异常，这就是其中之一（另一个是：我不相信您可以获得回溯，因此它们对于错误修复基本上没有用处）。

所以，修复图书馆（好）。或者明确地抓住字符串（坏的）。或者抓住一切（非常糟糕）并做一些 isinstance(e, str) 检查（甚至更糟）。

# django - Facebook 问题 + django

> ID：867527
> 
> 赞同：3
> 
> 时间：2009-05-15T08:12:53.293
> 
> 标签：django, facebook

我正在尝试编写一个 facebook 应用程序，用户可以在其中查看他朋友的状态历史记录。在我尝试将状态信息保存在我的数据库中之前，一切似乎都运行良好。这是代码：

```
 class UserStatus(models.Model):
        facebookid = models.IntegerField()
        time = models.IntegerField()
        status_msg = models.CharField(max_length = 2000)

@facebook.require_login()
 def canvas(request):
    # Get the User object 
    user, created = FacebookUser.objects.get_or_create(id = request.facebook.uid)
    user_lastname = request.facebook.users.getInfo([request.facebook.uid], ['last_name'])[0]['last_name']
    query = "SELECT time,message FROM status WHERE uid=%s" % request.facebook.uid
    result = request.facebook.fql.query(query) 
```

所以结果给了我所有的状态信息。所以我的问题是当我尝试保存它时给出错误。

```
 userstatus = UserStatus()
  for item in result:
  userstatus.facebookid = request.facebook.uid
  userstatus.time = item.time

userstatus.msg = item.message
  userstatus.save() 
```

错误：从应用程序加载页面时出错

加载时收到 HTTP 错误代码 500

那么我该如何解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T23:46:09.503

首先你应该检查你是否从中得到结果，

```
result = request.facebook.fql.query(query) 
```

确保结果采用模型所需的正确格式（ uid 是整数，时间是整数，消息是字符串。

再次确保结果是有效的 python 对象而不是 JSON 字符串/对象。

请记住 python 与 JSON 不完全兼容，因此如果结果是 JSON，则执行此操作以将其转换为 python 对象，

```
import simplejson
result = simpljson.loads(result) # if result was a JSON string
result = simpljson.loads(simplejson.dumps(result)) # if result was a JSON object 
```

检查现在的结果是否是字典列表 { "time" : 123456, "messaage": "xyz"}。

```
for item in result:
    userstatus = UserStatus() 
    userstatus.facebookid = request.facebook.uid
    userstatus.time = item["time"]
    userstatus.msg = item["message"]
    userstatus.save() 
```

你现在不应该有任何错误。

# silverlight - Silverlight 的 Facebook API

> ID：867530
> 
> 赞同：0
> 
> 时间：2009-05-15T08:13:11.420
> 
> 标签：silverlight, facebook

有没有人有示例显示如何从 Silverlight 查询 Facebook 用户照片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T08:21:26.550

您是否尝试过CodeProject 上的[WPF Facebook 示例？](http://www.codeproject.com/KB/WPF/WPFacebook.aspx)与 Silverlight 应该不会有太大的不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T19:19:01.327

另一个：

[http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2008/10/16/How-to-Build-Facebook-Applications-with-Silverlight-2-RTW-1320-Part-1-of-2 。*_* aspx](http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2008/10/16/How-to-Build-Facebook-Applications-with-Silverlight-2-RTW-_1320_-Part-1-of-2.aspx)

# c++ - MSHTML IWebBrowser2 - 下沉页面事件导致错过击键？

> ID：867532
> 
> 赞同：0
> 
> 时间：2009-05-15T08:13:42.200
> 
> 标签：c++, internet-explorer, mfc, webbrowser-control, idispatch

我的应用程序使用 MSHTML 有点问题。除了主题行中提到的快速打字时奇怪的击键丢失行为外，我一切正常。我认为这可能与我用来接收事件的方法有关？

详细信息：我的应用程序是在 Visual Studio 2005 中用 C++ 和 MFC 编写的单独程序。该程序附加到 Internet Explorer 的当前运行（独立）实例，并获取指向`IWebBrowser2`接口的指针并将其传递给类型为的对象`CCmdTarget`：

```
 class CHandler : public CCmdTarget
{
  IWebBrowser2* m_pWebBrowser2;
  DWORD m_dwBrowserCookie;
  …
  DECLARE_DISPATCH_MAP()
}; 
```

这个类跟踪浏览器中发生的事情。我使用以下命令接收浏览器事件：

```
 LPUNKNOWN pUnkSink = GetIDispatch(FALSE);
retval = AfxConnectionAdvise((LPUNKNOWN)m_pWebBrowser2, DIID_DWebBrowserEvents2, pUnkSink, FALSE, &m_dwBrowserCookie); 
```

如果我注释掉`AfxConnectionAdvise`，那么不会错过任何击键但不会有更多事件。如果我把它留在里面，我会沉没事件，但如果打字很快就会错过偶尔的击键。

我知道有很多方法可以连接到事件（`AtlAdvise`连接点），但这是我唯一可以使用的方法。

任何建议都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T17:55:47.097

如果你只是在寻找击键，你不能子类化控件吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T18:14:51.527

在封面之下，所有各种连接方法（`AtlAdvise`、`AfxConnectionAdvise`等）都使用了`IConnectionPointContainer`，而且`IConnectionPoint`——它们只是为您节省了键入样板 COM goo 的时间。

我怀疑这与您连接到正在运行的 IE 实例的方式有关。你怎么得到`IWebBrowser2`指针？您是被加载到 IE 进程中还是一个单独的进程？如果您在`IWebBrowser2`与原始线程（IE Tab UI 线程）不同的线程上运行，您是否在进行正确的 COM 编组？

# nhibernate - HQL：按其地图中的特定项目对所有项目进行排序

> ID：867534
> 
> 赞同：3
> 
> 时间：2009-05-15T08:14:03.557
> 
> 标签：nhibernate, hibernate, hql

我对 Hibernate 很陌生，目前在 HQL 方面有点挣扎。我有以下映射，并希望获取给定“culture_id”的“翻译”排序的所有“行业”实体

代码：

```
 <?xml version="1.0" encoding="utf-8" ?>
  <hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Domain.Industry, Core" table="industry">

    <id name="ID" unsaved-value="0">
      <generator class="identity" />
    </id>

    <map name="AllNames"
      access="nosetter.camelcase-underscore"
      table="_dict_industry_name"
      cascade="all-delete-orphan">
      <key column="record_id"></key>
      <index column="culture_id" type="Int32"></index>
      <element column="translation" type="String"></element>
    </map>

  </class>
  </hibernate-mapping> 
```

我尝试了以下方法： 代码：

```
from Industry industry order by elements(industry.AllNames[:lcid]) 
```

但它不起作用......

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T02:41:36.913

由于没有发布答案，我在其他一些论坛上问过。以下是两种可能的解决方案：

[https://forum.hibernate.org/viewtopic.php?f=1&t=996853](https://forum.hibernate.org/viewtopic.php?f=1&t=996853)

[http://groups.google.com/group/nhusers/browse_thread/thread/1750d64ecdeb72f9](http://groups.google.com/group/nhusers/browse_thread/thread/1750d64ecdeb72f9)

我更喜欢这个：

```
from Industry industry
where index(industry) = :lcid
order by industry.AllNames 
```

# wpf - 与 WPF MVVM 混淆

> ID：867540
> 
> 赞同：0
> 
> 时间：2009-05-15T08:15:14.660
> 
> 标签：wpf, mvvm

我已经从 CodePlex 下载了关于 MVVM 的文档，但是我不明白这个图。

[替代文字 http://img194.imageshack.us/img194/3959/diagram.png](http://img194.imageshack.us/img194/3959/diagram.png)

在文档中，ContactView 从未将其DataContext 设置为ContactViewModel，所以我不明白为什么此图显示ContactView 通过DataContext 引用ContactViewModel。

不知道什么时候设置了ContactView.DataContext，还是文档漏掉了这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T08:36:08.697

如果联系人显示在列表视图或类似内容中，则可能不需要专门设置 DataContext。

如果列表视图的 datacontext 设置为 MainViewModel 的 Contacts 属性，则每个项目的 datacontext 将自动设置为特定的 ContactViewModel 对象，这可能会触发项目使用 ContactView 控件呈现，假设设置了某些模板绑定在文档的前面。

* * *

抱歉，我在使用 codeplex 时遇到了问题，只是设法下载了文档。图表之前的代码块证实了我的怀疑：

```
<Grid>
    <ListBox ItemsSource="{Binding Contacts}">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <views:ContactView />
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</Grid> 
```

由于 ListBox 绑定了 Contacts ObservableCollection，因此每个 ListItem 都将其 DataContext 设置为绑定到的特定对象。DataTemplate 设置为将每个项目显示为 ContactView 控件。因此，ContactView 的 DataContext 将从集合中设置为正确的 Contact 对象，所有这些都发生在幕后，而无需您自己实际设置属性。

# sql-server - 如何将具有 1 行和 varchar 列的表转换为列？

> ID：867555
> 
> 赞同：2
> 
> 时间：2009-05-15T08:19:37.973
> 
> 标签：sql-server, tsql

在 SQL 服务器中，如何将 1 行与 varchar 列转换为一列？我想我需要使用 Pivot 但我找不到没有聚合器的例子

这是我的情况：

```
create table #tmp ( ac varchar(100), bc varchar(100), cc varchar(100))
insert into #tmp (ac,bc,cc)
Values ('test1','test2','test3')

insert into #tmp
Values ('test4','test5','test6')

SELECT *
FROM #tmp
WHERE ac='test1'

drop table #tmp 
```

我需要在一个列中转换选择的结果，我将在另一个嵌套查询中使用结果列。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T08:51:35.430

您需要使用 UNPIVOT，而不是 PIVOT

```
create table #tmp ( ac varchar(100), bc varchar(100), cc varchar(100))

insert into #tmp (ac,bc,cc)

Values ('test1','test2','test3')

SELECT
    *
FROM
    #tmp

SELECT
    *
FROM
    #tmp
UNPIVOT
(
    [Column] FOR Data IN (ac, bc, cc)
) uPIVOT

drop table #tmp 
```

# php - 如何在 PHP 中使用 MVC 框架路由多语言 URL？

> ID：867569
> 
> 赞同：2
> 
> 时间：2009-05-15T08:27:06.147
> 
> 标签：php, model-view-controller, internationalization

我会在 PHP 中做类似的事情：

[http://mysite.com/en/museum/gallery/garden](http://mysite.com/en/museum/gallery/garden)

[http://mysite.com/es/museo/galeria/jardin](http://mysite.com/es/museo/galeria/jardin)

这是可能的？如何使用多种语言路由控制器/视图？

我想知道是否可以使用 gettext 自动翻译 url，具体取决于所选语言...

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T08:41:52.647

如果您使用 Zend 作为 MVC 框架，它内置了对[Zend Translate](http://framework.zend.com/manual/en/zend.translate.html)的支持。Jason Gilmore 使用 Zend Translate 写了一个关于这个主题的[简短教程](http://www.developer.com/tech/article.php/3683571)（还有更多）。

但是，我不知道控制器是否会被翻译（我从未使用过）——但我对此表示怀疑。可能您必须为控制器和操作编写路由规则，而不是创建新的西班牙语控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T09:44:27.147

我使用了一个名为 translations 的模型，它返回一个语言翻译数组，这样当我替换视图中的变量时，我可以选择一种语言。

至于路线，您可以将其留给负责处理 /garden 或 /jardin 位的控制器。

# tortoisesvn - 使用 TortoiseSvn 执行结帐时出现错误 200

> ID：867575
> 
> 赞同：-1
> 
> 时间：2009-05-15T08:30:37.370
> 
> 标签：tortoisesvn

我正在尝试执行简单的结帐操作。这适用于其他几台计算机（虽然不在同一个局域网中）。我收到此错误消息：

[http://www.jamamate.com/error.jpg](http://www.jamamate.com/error.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T08:36:38.087

如果您在代理服务器后面，HTTP 错误 200 可能表示代理不支持 WebDAV 或禁用了 WebDAV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T08:38:53.263

我会首先检查您的防火墙/防病毒软件，它可能会破坏 subversion 收到的数据。要确认是否是这种情况，请查看禁用其中任何一个是否会改变任何内容。

如果它仍然不起作用，那么如果您在代理后面，我会检查您的代理设置。

# javascript - 检测和更新字符串的正则表达式（用于更新 AssemblyInfo.cs 中的文件版本）

> ID：867582
> 
> 赞同：1
> 
> 时间：2009-05-15T08:34:18.407
> 
> 标签：javascript, regex

我有一个这种格式的字符串

```
1.0.x.0 
```

我必须在 javascript 中编写一个自动递增的正则表达式`x`-- 怎么做？

请注意，给定的字符串将始终采用该格式-无需测试格式有效性...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T08:42:17.683

试试这个：

```
"1.0.123.0".replace(/(\d+\.\d+\.)(\d+)(\.\d+)/, function($0, $1, $2, $3) {
    return $1 + (parseInt($2) + 1) + $3;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T09:13:31.790

为什么必须是正则表达式？符号是一致的，只是略有不同；不需要正则表达式。

```
function incrementStrN(str) {
    var split = str.split('.');
    split[2]++;
    return split.join('.');
}
incrementStrN("1.0.123.0"); // Returns "1.0.124.0" 
```

我知道它看起来不太漂亮，但它比使用正则表达式要快；加上更容易定制；例如，您可以以这样的方式实现它，以便可以更改要递增的部分：（请参阅**`@param sec`**）

```
function incrementStrN(str, sec) {
     var split = str.split('.');
     split[sec-1]++;
     return split.join('.');
}

incrementStrN("1.0.123.0", 1); // Returns "2.0.123.0"
incrementStrN("1.0.123.0", 3); // Returns "1.0.124.0" 
```

# asp.net - 在调用 RegisterScriptDescriptors() 之前，必须使用 RegisterExtenderControl() 注册扩展器控件

> ID：867584
> 
> 赞同：3
> 
> 时间：2009-05-15T08:35:21.400
> 
> 标签：asp.net, dotnetnuke

我正在尝试部署一个使用 Dotnetnuke 构建的 Web 应用程序。有一个 DNN 控件/ASCX 具有 MultiView 和几个 AjaxToolkit 控件，如 AutoComplete、ModalPopup。在视图中包括其他（普通）ASCX，其中一些具有 UpdatePanel。

在开发人员机器（WinXp / ASP.NET Web Server）上没有错误......但是当我尝试将它部署在服务器上时，我得到了上述错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T12:44:22.767

我尝试了最新的 AjaxToolkit 版本，但问题仍然存在......

它似乎与 MultiView 有关，控件本身正在动态加载到 DNN 中。删除 MultiView 已解决该问题。

生产站点运行的是较旧版本的 Dotnetnuke，而开发人员使用的是最新的 Dotnetnuke。这可能是问题...但是我们尝试禁用 DNN 的 SupportsPartialRendering 选项并自己添加 ScriptManager...但它没有解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-14T09:56:47.290

即使我在使用 PopupControlExtender 时也遇到了同样的问题，但是当我从 PopupControlExtender 中删除“OffsetX”标签时问题得到了解决

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-18T11:40:51.690

如果您在 asp.net 中的用户控件或页面控件中使用任何声明性语句，则将以下代码粘贴到您的页面中。它应该可以正常工作。

```
protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);

        if (this.DesignMode == true)
        {
            this.EnsureChildControls();
        }
        this.Page.RegisterRequiresControlState(this);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T13:11:39.753

此解决方案适用于 VS 2010 和 VS 2012 On Page 事件

```
 protected void Page_Init(object sender, EventArgs e)
{
  {
    base.OnPreRender(e);
    ToolkitScriptManager1.RegisterExtenderControl(HoverMenuExtender1, Page);
  }

} 
```

# css - css 页脚 - 试图分成 2 列

> ID：867587
> 
> 赞同：4
> 
> 时间：2009-05-15T08:36:30.600
> 
> 标签：css, css-float, footer

我正在尝试拆分页脚，以便有左对齐和右对齐的文本。我有以下内容，但两个元素一个接一个地显示：

```
#footer {
    clear: both;
    background-color: #330066;
    padding: .5em;
    font-size: 0.8em;
    color: #fff;
}

#footer p .left {
    text-align:left;
    float:left;
}

#footer p .right {
    float:right;
    text-align:right;
}

<div id="footer">
    <p class="left">
        Copyright © 2009 
    </p>
    <p class="right">
        Designed by xxxxxx
    </p>
</div> 
```

我敢肯定应该很简单，但我就是无法让它工作——有人可以提供任何建议吗？

谢谢

海伦

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T08:39:58.253

您正在使用`footer p .right`而不是`footer p.right`（注意空格字符）。这意味着`.right`and`.left`类不适用于段落，但适用于段落*内的后代元素*。或者它也可能意味着一个错字，导致你的 CSS 失败:)

请在此处复制您的 HTML，以便我们更好地帮助您。

* * *

**编辑：**我看到你现在已经发布了你的 HTML。我的假设被证明是正确的。去掉`p`and `.left`/之间的空格`.right`。此外，如果您要浮动段落，则可以省略这些`text-align`属性。

```
#footer p.left {
 float: left;
}

#footer p.right {
 float: right;
} 
```

* * *

**编辑：**回应您的评论：它应该可以工作。这是一个小测试用例：

```
<!DOCTYPE html>
<html lang="en">
 <head>
  <title>Test case for the CSS footer problem</title>
  <style>
   #footer { width: 300px; outline: 1px solid red; }
    #footer p.left { float: left; }
    #footer p.right { float: right; }
  </style>
 </head>
 <body>
  <p>See <a href="http://stackoverflow.com/a/867599/96656" title="Stack Overflow: CSS footer; trying to split into two columns">http://stackoverflow.com/a/867599/96656</a> for details.
  <div id="footer">
   <p class="left">Copyright © 2009</p>
   <p class="right">Designed by xxxxxx</p>
  </div>
 </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T09:06:52.947

无需像之前建议的那样删除 #footer 上的 clear:both 。正如 Mathias Bynens 所说，你必须写“p.left”而不是“p.left”你需要在两段之后都清楚，并最终得到如下内容：

```
#footer {
    clear: both;
    background-color: #330066;
    padding: .5em;
    font-size: 0.8em;
    color: #fff;
}

#footer p.left {
    text-align:left;
    float:left;
}

#footer p.right {
    float:right;
    text-align:right;
}

<div id="footer">
     <p class="left">
         Copyright © 2009 
     </p>
     <p class="right">
         Designed by xxxxxx
     </p>
     <div style="clear:both"></div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T08:39:07.693

您是否尝试过为左右设置宽度，例如各 50%

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T08:44:15.357

由于段落是块级元素，如果您希望它们并排显示，您应该删除浮动并将它们设置为内联：

```
footer p.left {text-align:left; display:inline; }
footer p.right {text-align:right; display:inline; } 
```

另外我假设应该是 #footer 或 .footer 事先？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T08:51:22.577

问题是`#footer`你有一个`clear: both;`杀死所有花车的东西。

如果您有以下情况会更好：

```
#footer {
    background-color: #330066; 
    padding: .5em; 
    font-size: 0.8em; 
    color: #fff;
    width: 100%;
    overflow: hidden;
 }

p.left { float: left; }
p.right { float: right; } 
```

`width: 100%;`和将`overflow: hidden;`解决您的问题，因为它会在浮动完成后清除它们。

使用上面的代码，您将能够拥有：

```
<div id="footer">
    <p class="left">Copyright &copy; 2009</p>
    <p class="right">Designed by ****</p>
</div> 
```

# asp.net-mvc - 如何使用 ASP.NET MVC 和 ODBC 2.0

> ID：867591
> 
> 赞同：0
> 
> 时间：2009-05-15T08:37:16.980
> 
> 标签：asp.net-mvc, odbc

我开始一个项目，该项目将涉及使用旧版 ODBC 2.0 兼容数据库的 ASP.NET MVC。目标是在大约一年的时间内用 Web 前端替换当前的系统功能，然后用 SQL Server 替换后端。

计划是针对 SQL 服务器编写代码，然后将一些 shim 插入存储库类以改用 ODBC。这样做是否可行？实体框架没有内置对 ODBC 的支持。

任何想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T08:40:31.947

没有什么可以阻止您编写自己的数据访问层来查询 ODBC 数据库。您还可以创建自己的实体层，以便 MVC 模型可以使用数据层填充您的实体，并将这些对象返回给控制器。

基本上，在你的 mvc 应用程序下有一个数据访问和实体层，然后你可以在以后用实体框架或 nhibernate 实体替换这些实体。

这种方式意味着您的 MVC 应用程序不需要知道它正在使用什么数据库，这也意味着您以后切换实体时应该很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T12:18:24.437

我个人将 NHibernate 与 MVC 一起使用。最初我选择它是因为我们的数据库不支持 EF，但我很喜欢它，即使我们迁移到 SQL Server，我也会保留 NHibernate。

学习曲线有点奇怪。成为专家绝对是陡峭的，但有趣的是，当您对某些层感到满意时，让它为您处理越来越多的工作是非常有机的。

因此，对于您的情况，NHibernate 可能支持您的数据库，可以用作简单的数据访问层（仅返回 DTO），提供与数据库无关的接口，并且可以在时机成熟时支持 SQL Server。如果您最终想从 NHibernate 中获得更多信息，那么时机成熟时它就在那里。

# sql-server - 存储在数据库文件中的旧数据

> ID：867593
> 
> 赞同：2
> 
> 时间：2009-05-15T08:38:44.807
> 
> 标签：sql-server, database, persistence, pci-dss, computer-forensics

如何确保我从 db 表中删除的所有数据不再存储在硬盘上的 mdb 文件（和其他文件）中？

这是我的情况：
我的客户曾经在他们的数据库（SQL Server）中存储未加密的信用卡数据。由于 PCI 的要求，他们现在对所有数据进行加密......但是，mdb 文件仍然有一些旧的、未加密的 CC 写入其中。
我们已经验证数据库中没有更多的 CC；我们已经压缩了数据库；我们已将其备份到一个文件并重新将其恢复到一个新数据库；我们甚至运行了 sp_cleandb。
然而，当我们分析磁盘上的持久文件时，我们仍然发现了一些未加密的 CC——它们没有存储在数据库中，它们不是 SP、视图或 UDF 的一部分，并且它们不会出现在任何表元数据中。

所以，我的问题 - 我怎样才能确保所有“坏”的 CC 数据都消失了？或者，更一般地说，我如何强制 MSSQL 仅存储当前数据，并从任何“垃圾”中清除文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T08:42:58.073

根据您所做的，我建议创建一个新数据库，并将所有数据移入其中。

这样你就知道你只是在处理你的新数据，没有任何遗留数据会以某种方式存储在文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T08:43:40.863

您是否尝试过释放数据库文件（和日志文件）中未使用的空间？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T08:57:10.677

绝对确定：

*   以某种文本格式转储您的数据，例如 CSV
*   在 CSV 中搜索任何未加密的数据并将其删除
*   创建一个新的空数据库
*   将 CSV 加载到新数据库中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T21:06:51.887

编写数据库脚本

将数据批量复制到平面文件

在平面文件中查找未加密的数据

删除数据库

使用安全删除删除数据库文件：[http ://www.snapfiles.com/Freeware/security/fwerase.html](http://www.snapfiles.com/Freeware/security/fwerase.html)

使用您的脚本在服务器上创建一个新数据库

从平面文件中加载数据

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-06T03:40:48.453

如果你对这个话题感兴趣，我推荐：

数据库系统取证分析中对隐私的威胁，数据档案管理国际会议，2007 年 ACM SIGMOD 数据管理国际会议论文集 [http://www.cs.umass.edu/~miklau/pubs/sigmod2007LMS/ stahlberg07forensicDB.pdf](http://www.cs.umass.edu/~miklau/pubs/sigmod2007LMS/stahlberg07forensicDB.pdf)

# asp.net - 使用来自服务器的数据填充 ListView

> ID：867596
> 
> 赞同：1
> 
> 时间：2009-05-15T08:39:18.317
> 
> 标签：asp.net, listview

我的结帐页面上有一个 ListView，其中有一个 ItemTemplate，它建立了一个客户订购的项目表。我想在表的页脚中添加总计，我有以下标记：

```
<asp:ListView ID="lvOrderSummary" runat="server">
  <LayoutTemplate>
    <table id="tblOrderSummary">
      <tr>
        <td><b>Title</b></td>
        <td><b>Cost</b></td>
      </tr>
      <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
      <tr>
        <td><b>Total Cost:</b></td>
        <td><%# GetTotalCost().ToString()%></td>
      </tr>
    </table>
  </LayoutTemplate>
  <ItemTemplate>
    <tr>
      <td><%#Eval("Title") %></td>
      <td><%#Eval("Cost") %> </td>
    </tr>
  </ItemTemplate>
</asp:ListView> 
```

我有一个名为 GetTotalCost 的服务器端方法，它返回我需要的值。我遇到的问题是这个方法永远不会被调用。我也尝试过，而不是使用：

```
<td><%# GetTotalCost().ToString()%></td> 
```

我试过使用

```
<td id="tdTotal" runat="server"></td>
---------------
protected void Page_Load(object sender, EventArgs e)
{
  if (!Page.IsPostBack)
  {
    TableCell td = ((TableCell)this.FindControl("lvOrderSummary_tdTotal"));
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T08:46:02.090

查看[本文](http://www.devcurry.com/2009/03/how-to-add-total-column-to-aspnet.html)以获取如何在 ListView 中显示总计的示例。

基本上你可以在布局模板中添加标签：

```
<asp:ListView ID="lvOrderSummary" runat="server"
  OnPreRender="lvOrderSummary_PreRender" ...>

  <LayoutTemplate>
    ...
    <td><asp:Label ID="lblTotalCost" runat="server" Text="Total"/></td>
    ..
  </LayoutTemplate></asp:ListView> 
```

然后在 PreRender 事件处理程序中设置标签的文本：

```
protected void lvOrderSummary_PreRender(object sender, EventArgs e)
{
   Label lbl = lvOrderSummary.FindControl("lblTotalCost") as Label;
   lbl.Text = GetTotalCost().ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-01T07:11:59.670

```
Try

        Dim strcon As String = "Data Source=.\SQLEXPRESS;AttachDbFilename=D:\webarticles\App_Data\mydatabase.mdf;Integrated Security=True;User Instance=True"
        Dim con As New SqlConnection(strcon)
        con.Open()
        Dim da As SqlDataAdapter
        Dim ds As New DataSet
        Dim sqlstring As String = "SELECT * FROM tblstudent "
        da = New SqlDataAdapter(sqlstring, con)
        da.Fill(ds)
        DetailsView1.DataSource = ds.Tables(0)
        DetailsView1.DataBind()

    Catch ex As Exception
        MsgBox("There is some Error")

    End Try 
```

另一个数据处理控件是 DetailsView 控件，它使您能够从其关联的数据源一次显示、删除、编辑、插入一条记录。DetailsView 控件不支持排序。默认情况下，DetailsView 控件将记录的每个字段显示在自己的行上。

# wix - 如何在不使用 WiX 安装的情况下运行 Dll32 文件？

> ID：867598
> 
> 赞同：1
> 
> 时间：2009-05-15T08:39:37.927
> 
> 标签：wix

我试图在 DLL 上调用 RunDll32 以在安装时将私钥安装到机器密钥存储区，但我不想将文件放在磁盘上。我目前有一个自定义操作调用 RunDll，然后删除文件（显然安装后）。

有没有办法在不先安装文件的情况下做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T09:56:21.733

为什么不使用 Certificate 元素呢？

# c++ - 生成随机位的最快方法

> ID：867602
> 
> 赞同：10
> 
> 时间：2009-05-15T08:41:18.983
> 
> 标签：c++, random

生成大量（伪）随机位的最快方法是什么。每个位必须是独立的，并且以相等的概率为零或一。我显然可以做一些变化

```
randbit=rand()%2; 
```

但我觉得应该有一种更快的方法，从每次调用随机数生成器中生成几个随机位。理想情况下，我希望得到一个 int 或 char ，其中每个位都是随机且独立的，但其他解决方案也是可能的。

该应用程序本质上不是加密的，因此强随机性不是主要因素，而速度和获得正确的分布很重要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T08:50:03.797

**将随机数转换为二进制**
为什么不只获取一个数字（大小合适以获取所需的足够位），然后将其转换为二进制。您实际上会从随机数中获取位，这意味着它们也是随机的。

零和一也有 50% 的概率，因为取 0 到某个 2^n 限制之间的所有数字并计算零和一的数量相等 > 意味着零和一的概率是相同的。

*关于速度*
，这可能会非常快，因为与其中的位数相比，仅获得一个随机数会更快。它现在完全取决于您的二进制转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T08:48:43.893

看看[Boost.Random](http://www.boost.org/doc/libs/release/libs/random)，尤其是`boost::uniform_int<>`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T08:49:05.453

正如您所说，只需生成随机整数。
然后你有 32 个随机位，其中 1 和 0 的概率相同。

循环获取位：

```
for (int i = 0; i < 32; i++)
{
  randomBit = (randomNum >> i) & 1
  ...
  // Do your thing
} 
```

重复此操作多次以获得正确的位数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-16T15:26:15.957

这是我基于 George Marsaglia 的 XORShift 算法用 Java 编写的一个非常快的算法：一次获取 64 位！

```
/**
 * State for random number generation
 */
private static volatile long state=xorShift64(System.nanoTime()|0xCAFEBABE);

/**
 * Gets a long random value
 * @return Random long value based on static state
 */
public static final long nextLong() {
    long a=state;
    state = xorShift64(a);
    return a;
}

/**
 * XORShift algorithm - credit to George Marsaglia!
 * @param a Initial state
 * @return new state
 */
public static final long xorShift64(long a) {
    a ^= (a << 21);
    a ^= (a >>> 35);
    a ^= (a << 4);
    return a;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T09:22:34.280

如果我没记错的话，对于大多数伪随机数生成器，最低有效位通常具有“较少随机”的分布，因此如果您担心分布，使用模数和/或生成数字中的每个位会很糟糕。

（也许你至少应该用谷歌搜索 Knuth 所说的话......）

如果这成立（并且在不确切知道您使用的是什么算法的情况下很难判断），只需使用每个生成数字中的最高位。

[http://en.wikipedia.org/wiki/Pseudo-random](http://en.wikipedia.org/wiki/Pseudo-random)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T08:49:25.857

[SMP 安全（即这些天可能的最快方式）和好位](http://blogs.msdn.com/pfxteam/archive/2009/02/19/9434171.aspx)

注意[ThreadStatic]属性的使用，这个对象自动处理新线程的，不加锁。这是确保高性能随机 SMP 无锁的唯一方法。

[http://blogs.msdn.com/pfxteam/archive/2009/02/19/9434171.aspx](http://blogs.msdn.com/pfxteam/archive/2009/02/19/9434171.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-13T23:50:10.820

```
#include <iostream>
#include <bitset>
#include <random>

int main()
{
    const size_t nrOfBits = 256;
    std::bitset<nrOfBits> randomBits;

    std::default_random_engine generator;
    std::uniform_real_distribution<float> distribution(0.0,1.0);

    float randNum;
    for(size_t i = 0; i < nrOfBits; i++)
    {
        randNum = distribution(generator);
        if(randNum < 0.5) {
            randNum = 0;
        } else {
            randNum = 1;
        }
        randomBits.set(i, randNum);
    }

    std::cout <<  "randomBits =\n" << randomBits << std::endl;
    return 0;
} 
```

在我的 256 位测试中，这花费了 4.5886e-05s。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-08T03:58:55.523

如果您一次只需要一点，请尝试 `bool coinToss() { return rand()&1; }`从技术上讲，这是一种更快的生成位的方法，因为将 %2 替换为等效的 &1 。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T08:49:41.147

您可以生成一个随机数并继续右移并测试最低有效位以获得随机位，而不是执行 mod 操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-15T16:35:05.753

您需要生成的位数有多大？如果它不大于几百万，并且记住您没有使用生成器进行密码学，那么我认为最快的方法是预先计算大量具有正确分布的整数，将其转换为文本像这样的文件：

```
unsigned int numbers[] =
{
  0xABCDEF34, ...
}; 
```

然后将数组编译到您的程序中并一次通过一个数字。

这样，每次调用（在 32 位处理器上）都会获得 32 位，生成时间尽可能短，因为所有数字都是提前生成的，并且分配由您控制。当然，不利的一面是，这些数字根本不是随机的，这取决于您使用 PRNG 的目的可能会或可能无关紧要。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-05-15T08:55:00.103

只需读取一些内存 - 获取原始内存的一部分。这将是非常随机的。

或者，生成一个大的随机 int x 并仅使用位值。

```
for(int i = (bitcount-1); i >= 0 ; i--) bin += x & (1 << i); 
```

# jboss - 如何将 JBoss4 消息驱动 Bean 连接到远程服务器上的主题？

> ID：867618
> 
> 赞同：1
> 
> 时间：2009-05-15T08:46:25.537
> 
> 标签：jboss, jms, remote-server

我有一个发布主题消息的 JBoss 服务器（服务器 A）。我在另一台服务器（服务器 B）上有一个消息驱动 bean，需要从服务器 A 检索消息。

我该怎么做？如果发布者和订阅者在同一台服务器上，我可以轻松地让一切正常工作，但我找不到任何有关如何使用远程服务器进行操作的信息。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:44:23.527

此[链接](http://www.jboss.org/community/wiki/HowDoIConfigureAnMDBToTalkToARemoteQueue)描述如何将 MDB 连接到远程队列。

# algorithm - 高效的定时器算法

> ID：867621
> 
> 赞同：8
> 
> 时间：2009-05-15T08:47:36.767
> 
> 标签：algorithm, timer

实现简单计时器库的最佳算法是什么。图书馆应允许以下内容：

1.  要启动的计时器
2.  要停止的计时器
3.  要检查的计时器是否仍在运行

在 Timer 到期时，将调用回调函数。

定时器模块将允许定时器具有 Ns 的时间分辨率，并且每隔 Ns 将给该模块踢一次以提示模块检查过期的定时器。

许多计时器可能同时处于活动状态。

最佳算法需要满足以下目标

1.  在处理定时器到期回调时对定时器启动/停止具有鲁棒性
2.  允许快速启动、停止和检查计时器
3.  内存占用小

问候

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-10-09T02:08:33.737

我见过的定时器的最佳算法是在研究论文[Hashed and Hierarchical Timing Wheels: Data Structures for the Efficient Implementation of a Timer Facility 中找到的定时器轮](http://www.cs.columbia.edu/~nahum/w6998/papers/sosp87-timing-wheels.pdf)

我知道在 Java 中有一个 Netty、JBoss 的实现，如果你用 Java 编写，我相信你也可以在其他地方使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T09:38:11.747

定时器通常最好在操作系统内核中实现，在汇编/C 级别，尽可能使用特定于平台的功能，如 APIC 定时器。

您可能想查看[http://lwn.net/Articles/167897/](http://lwn.net/Articles/167897/)以了解有关 Linux 实现的详细信息，并深入研究 Linux 源代码以查看有效的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T09:11:09.440

在 POSIX 系统上，您可以使用[`timer_create`/`timer_settime`](http://www.opengroup.org/onlinepubs/007908799/xsh/timer_create.html)系列函数来“免费”提供很多这样的功能。

# macos - 来自时间机器胶囊的异地备份

> ID：867625
> 
> 赞同：3
> 
> 时间：2009-05-15T08:48:48.200
> 
> 标签：macos, amazon-s3, remote-backup, timemachine, offsite

如何创建（辅助）备份到驻留在苹果时间胶囊上的时间机器备份的异地位置？

可能的目的地是 Amazon S3、Mosso 云文件、通用 SSH/SCP 服务器，...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T08:59:57.003

知道时间机器大量使用底层 mac 文件系统 HFS+ 的功能，研究[RDiff](http://www.gnu.org/savannah-checkouts/non-gnu/rdiff-backup/)是有道理的。RDiff 可用于通过网络同步文件夹并支持特定的 mac 功能。因此，它甚至可以用于将时间机器备份同步到远程服务器。远程服务器需要 ssh-login 并且必须具有 POSIX 文件系统。

# version-control - 在 TFS 中的项目之间合并和分支共享代码

> ID：867628
> 
> 赞同：8
> 
> 时间：2009-05-15T08:49:14.050
> 
> 标签：version-control, tfs

我目前负责将我们的 asp.net 应用程序从源安全迁移到 TFS。我们有三四个非常相似的应用程序（比如电子商务），它们目前共享一个核心库（服务、业务逻辑、实体、数据访问等）。

这些应用程序相似但不相同，因此一个应用程序可能会获得其他应用程序无法获得的功能集等。

我想停止共享代码，而是设置分支（如果合适的话），所以如果我在 Application A:s 核心库中更改某些内容，我需要将更改与其他分支合并，而不是让它们自动获取更改。这是为了避免当您从主干更新时出现意外，突然核心已更改为另一个项目并且该项目以某种方式中断。

关于如何在 TFS 中进行设置的任何建议？我是否应该有一个不直接在作为所有其他核心的父项的任何项目中使用的“主”核心，以便我可以将更改从一个核心推送到该核心，然后将其分发到其他核心？这有意义吗？在 TFS 中设置是否容易？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T09:29:56.290

针对您的评论，我建议您阅读`Feature branches`CodePlex[网站](http://www.codeplex.com)。

> **场景 4 – 功能分支**
> 在这个场景中，您创建一个开发分支，在该分支中执行工作，然后将您的工作合并回您的主源代码树。您根据产品功能组织您的开发分支。以下是显示功能开发分支的物理视图：
> 
> **我的团队项目**

```
 Development -> Isolated development branch container  
        Feature A -> Feature branch  
           Source  
        Feature B -> Feature branch  
          Source  
        Feature C -> Feature branch  
          Source  
        Main      -> Main Integration branch
          Source 
```

我们将在不久的将来从`SS`到。`TFS`

据我所知，我们将保持我们的`SS`存储库在线并在`TFS`. 我们的*框架*可能会在`TFS`. 项目特定的*共享*单元需要不时合并。

* * *

您构建存储库的方式取决于您的具体情况。每个分支场景都有其特定的优点和缺点。

*   有多少项目
*   有多少开发商
*   开发人员是否敬业
*   您是否需要并发热修复
*   你需要服务包吗

查看[CodePlex 分支指南](http://www.codeplex.com/TFSBranchingGuideII)，了解您对 TFS 结构做出明智决策所需的所有信息。打印出[备忘单](http://tfsbranchingguideii.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=20785#DownloadId=52466)并将它们钉在墙上以供快速参考。

> 在执行您的分支计划之前，请注意此警告信息 - 您创建的每个分支都有成本，因此请确保您从中获得一些价值。TFS 中的分支机制被简化为一个右键单击分支命令。然而，分支的总成本是通过降低到主代码的速度来支付的，合并冲突和额外的测试可能很昂贵。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T16:53:45.583

我假设您已经调查过您是否真的需要将您的“副本”制作成单独的团队项目。请记住“团队项目”的 TFS 概念是一个非常大的高级容器。它与大多数 IT 商店认为的“项目”不同。将“Microsoft Vista”或“Office 2007”视为一个项目，而不是将“XYZ 公司的应收帐款系统的新版本”视为团队项目意义上的一个项目。

我有一个客户决定为 TFS 建立一个团队项目。这并没有错——在许多情况下，这确实是最好的情况。

如果您确实需要在您的应用程序副本之间进行非常强的隔离（也许它们是单独的客户端，并且您需要非常强大的安全隔离）并且必须有单独的团队项目。

也就是说 - 你仍然 - 正如你所说的需要在应用程序实例之间共享代码。我强烈建议的第一件事是远离“剪切和粘贴”共享。我真的会尝试将共享代码隔离到一个单独的解决方案中并为此生成二进制文件（也许你已经这样做了！）

Codeplex TFS 对此进行了介绍：http: [//tfsguide.codeplex.com/](http://tfsguide.codeplex.com/)

我为几个客户做过的另一种方法是创建一个包含共享代码的团队项目。“构建”为共享代码创建二进制文件 - 而“部署”只是将它们复制到“已知位置”（即构建机器上的 UNC 共享）

对于作为“框架”的“消费者”的应用程序，我们只需使用“AdditionalReferencesPath”项组来包含该已知位置的位置。

此外 - 这个工具：[http](http://tfsdepreplicator.codeplex.com/) ://tfsdepreplicator.codeplex.com/可能会有所帮助。这将允许您在构建“框架”解决方案时为您的“消费者”项目自动触发构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:22:33.227

我的简短回答是，您应该只设置一个“TFS 项目”并简单地将您的不同项目（即您的个人应用程序和每个共享库）组织为该 TFS 项目下的单独文件夹。另一种方法是在每个单独的应用程序中包含共享库的特定（二进制）构建——如果你这样做了，那么你可以将每个应用程序组织到它自己的 TFS 项目中，但你不能在不使用 TFS 的情况下合并更改或分支这些项目命令行（以及一些不明显的引导命令）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-09T18:14:43.203

我试图确定相同的信息，这个关于 codeplex 的指南是完美的

[http://vsarbranchingguide.codeplex.com/releases](http://vsarbranchingguide.codeplex.com/releases)

包括术语和不同的分支工作流方法以及备忘单。

# .net - 是否有类似 WinForms 的 Yahoo Pipes 接口的接线控件？

> ID：867632
> 
> 赞同：0
> 
> 时间：2009-05-15T08:49:43.300
> 
> 标签：.net, winforms, controls

我的应用程序的用户界面需要尽快构建，并且所表示的数据是可链接的；大多数组件都有输入和输出，可以根据需要自由连接在一起。Yahoo Pipes 是我认为我需要的界面风格，但我很难找到适合 WinForms 的东西。TreeGX 看起来很有趣，但它只是向外流动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T09:01:27.373

当我在 2002 年尝试时， Northwood 的[GoDiagram](http://www.northwoods.com/GO/dotnet.htm)非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T13:08:37.980

看看 Netron 项目

[www.orbifold.net/netron/](http://www.orbifold.net/netron/)

[http://www.orbifold.net/default/?page_id=1273](http://www.orbifold.net/default/?page_id=1273)

更新：

这个是开源的，但我没试过

[http://www.piccolo2d.org](http://www.piccolo2d.org)

# wpf - wpf中的ItemSource vs Datacontext

> ID：867638
> 
> 赞同：13
> 
> 时间：2009-05-15T08:52:00.687
> 
> 标签：wpf, datacontext, itemsource

谁能告诉我WPF中Listview的Itemsource和DataContext之间的区别？举个例子

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-15T08:54:12.743

项目源（必须隐含 IEnumerable）将用于创建出现在列表中的项目列表。DataContext（可以是任何对象）是您为 ListView 上的其他属性指定的任何绑定的默认对象。

```
public List<string> ItemsObject = new List<string>() { "Item1", "Item2", "Item3" };
public AnyObject DataContextObject = new AnyObject() { WidthValue = 23 }

<ListView
           ItemsSource="{Resource_of_ItemsObject}"
           DataContext="{Resource_of_DataContextObject}"
           Width="{Binding Path=WidthValue}"/> 
```

将生成一个“Item1”、“Item2”、“Item3”的列表，显示宽度为 23。

# c# - 如何在数据上下文中使用事务

> ID：867643
> 
> 赞同：18
> 
> 时间：2009-05-15T08:56:00.100
> 
> 标签：c#, linq, linq-to-sql, transactions, datacontext

我可以使用带有数据上下文的事务，以便在出错后回滚上下文的状态吗？如果是这样，它是如何工作的？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-15T09:07:11.773

我一直在测试中使用它们:)

```
try
{
  dc.Connection.Open();
  dc.Transaction = dc.Connection.BeginTransaction();

  dc.SubmitChanges();
}
finally
{
  dc.Transaction.Rollback();
} 
```

**更新**

事后这总是会回滚。我在测试中使用它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-15T10:12:35.800

默认情况下，DataContext 会选择环境事务，因此只需确保范围内有事务即可。细节成为主要问题：

*   您需要哪些选项（例如隔离级别）
*   您想要一个新事务还是重用现有事务（例如，审计/日志记录操作可能需要一个新事务，以便即使整个业务操作失败并因此回滚外部事务也可以提交它）。

这是一些原型代码的简化，真正的代码使用助手来创建带有策略驱动选项的事务（原型的目的之一是检查这些选项的影响）。

```
using (var trans = new TransactionScope(
                           TransactionScopeOption.Required,
                           new TransactionOptions {
                               IsolationLevel = IsolationLevel.ReadCommitted
                           },
                           EnterpriseServicesInteropOption.Automatic)) {
    // Perform operations using your DC, including submitting changes

    if (allOK) {
        trans.Complete();
    }
} 
```

如果 Complete() 没有被调用，那么事务将被回滚。如果存在包含事务范围，则内部事务和外部事务都需要完成才能提交数据库上的更改。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-04-08T11:00:11.503

它不像 TransactionScope 方法那么简单，但据我了解，这是对 LINQ-to-SQL 执行此操作的“正确”方法。它不需要对 System.Transactions 的任何引用。

```
dataContext.Connection.Open();
using (dataContext.Transaction = dataContext.Connection.BeginTransaction())
{
    dataContext.SubmitChanges();

    if (allOK)
    {
        dataContext.Transaction.Commit();
    }
    else
    {
        dataContext.Transaction.RollBack();
    }
} 
```

当然，RollBack 只有在您打算在 using 中进行进一步的数据操作时才需要，否则更改将被自动丢弃。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-15T10:11:41.853

大概是这样的：

```
try
{
    using (TransactionScope scope = new TransactionScope())
    {
        //Do some stuff

        //Submit changes, use ConflictMode to specify what to do
        context.SubmitChanges(ConflictMode.ContinueOnConflict);

        scope.Complete();
    }
}
catch (ChangeConflictException cce)
{
        //Exception, as the scope was not completed it will rollback
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-23T19:57:35.587

是这样的：

> ```
> using (YourDatacontext m_DB = new YourDatacontext())
> using (TransactionScope tran = new TransactionScope())
> {
>    try
>    {
>       //make here the changes
>       m_DB.SubmitChanges();
>       tran.Complete();
>    }
>    catch (Exception ex)
>    {
>        Transaction.Current.Rollback();
>    }
> } 
> ```

# flash - 从另一个 SWF 文件访问一个文件中的影片剪辑

> ID：867644
> 
> 赞同：0
> 
> 时间：2009-05-15T08:56:50.630
> 
> 标签：flash, actionscript-3

我是 Flash 和 AS 的新手。我必须在 as2 和 as3 中加载 2 个 swf 文件，我已经在 as3 swf 中加载了 swf 文件（as2），它可以工作，但我需要从（swf（as2））访问所有影片剪辑并更改属性（如样式) 动态。我该怎么做 。

这是我的代码::

```
var loader:Loader = new Loader();
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, handleComplete);
addChild(loader);
loader.load(new URLRequest("games.swf"));
loader.x = 50;
loader.y = 125;

function handleComplete(event:Event):void{

    trace("swf loaded");
} 
```

上面的代码工作正常，还加载了 swf 文件。如何从 swf as2 文件中访问单个影片剪辑。我也知道影片剪辑的所有名称（ID）。

帮助我克服这个问题......在此先感谢......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T07:39:13.583

我建议使用 Event.INIT 而不是 Event.COMPLETE。INIT在加载**完成后触发，加载的 swf****中**的所有类/实例都已初始化并准备好使用。

```
var loader:Loader = new Loader(); 
loader.contentLoaderInfo.addEventListener(Event.INIT, handleInit);
addChild(loader);

function handleInit(e:Event):void{
var as2Movie:AVM1Movie = e.target.content as AVM1Movie;
} 
```

您可以通过 Loader 类的 content 属性访问加载的内容。并不是因为您将 as2 电影加载到 as3 电影中，所以有一些限制：

“AVM1Movie 是一个简单的类，它表示使用 ActionScript 1.0 或 2.0 的 AVM1 影片剪辑。（AVM1 是用于运行 ActionScript 1.0 和 2.0 的 ActionScript 虚拟机。AVM2 是用于运行 ActionScript 3.0 的 ActionScript 虚拟机。）当 Flash Player 8 或更早版本的 SWF 文件由 Loader 对象加载，创建 AVM1Movie 对象。AVM1Movie 对象可以使用从 DisplayObject 类继承的方法和属性（例如 x、y、width 等）。但是， AVM1Movie 对象和 AVM2 对象之间不允许互操作（例如调用方法或使用参数）。

AVM2 SWF 文件加载的 AVM1 SWF 文件有几个限制：

加载的 AVM1Movie 对象作为 AVM1 SWF 文件及其加载的所有 AVM1 SWF 文件的伪根对象运行（就像 ActionScript 1.0 lockroot 属性设置为 true）。AVM1 影片始终是任何子代中任何 ActionScript 1.0 或 2.0 代码执行的顶部。加载的子项的 _root 属性始终是此 AVM1 SWF 文件，除非在加载的 AVM1 SWF 文件中设置了 lockroot 属性。AVM1 内容无法将文件加载到关卡中。例如，它不能通过调用 loadMovieNum("url", levelNum) 来加载文件。由 AVM2 SWF 文件加载的 AVM1 SWF 文件无法将另一个 SWF 文件加载到此文件中。也就是说，它不能在自身之上加载另一个 SWF 文件。但是，此 SWF 文件加载的子 Sprite 对象、MovieClip 对象或其他 AVM1 SWF 文件可以加载到此。”来自 as3 docs。

有关详细信息，请参阅[AMV1Movie 参考](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/AVM1Movie.html)。

如果您想从 as3 调用 as2 电影，您将需要使用本地连接在 2 个 swf 之间建立通信。

[Grant Skinner](http://www.gskinner.com/blog/)为这种情况写了一个名为[SWF Bridge的方便的东西（简单的 as2 到 as3 通信）。](http://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html)值得一试。

祝你好运！

# asp.net-mvc - ASP.net MVC：在 RenderAction 中获取“主控制器”

> ID：867649
> 
> 赞同：6
> 
> 时间：2009-05-15T08:58:49.110
> 
> 标签：asp.net-mvc, routing

如何在 RenderAction 中获得实际的“主控制器”？

例子：

我的路线：

```
{controller}/{action} 
```

我的网址是：pages/someaction tours/someaction ...

在我的 Site.Master 中，我做了一个 RenderAction：

```
<% Html.RenderAction("Index", "BreadCrumb"); %> 
```

我的 BreadCrumbController 动作如下所示：

```
public ActionResult Index(string controller)
{

} 
```

字符串控制器包含“BreadCrumb”（这是可以理解的，因为实际上我在 BreadCrumbController 中）。

获得“真实”控制器（例如页面或游览）的最佳方式是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-12-28T15:02:17.837

## 父视图/控制器上下文

如果您使用 MVC 2 RC（不知道以前的版本），您可以通过视图的上下文访问父控制器，您将在其中找到一个名为：

```
ViewContext ParentActionViewContext; 
```

这是父视图的上下文，并且还引用了启动视图渲染的控制器...

## 路由

在我看来（根据您的问题）您有任意数量的路线段的请求......在这种情况下，您有两个选择：

1.  使用贪婪参数定义您的路由，`actions`在这种情况下将捕获您请求 URL 中的所有操作

    ```
    {controller}/{*actions} 
    ```

2.  创建一个自定义`Route`类来处理您的自定义路由要求并`RouteData`根据需要进行填充。

第二个需要更多的工作和路由知识，但它将帮助您获得更多关于 Asp.net MVC 路由的知识。我过去做过，这是一个宝贵的教训。也是处理我的自定义路线要求的一种优雅方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T16:06:31.323

你能把它作为参数传递给控制器​​吗？

*--Site.master--*

```
 <% Html.RenderAction("Index", "BreadCrumb"
                      new { controller = ViewData["controller"] }); %> 
```

*--BreadCrumbController.cs--*

```
 public ActionResult Index(string controller)
  {

  } 
```

*--ToursController.cs--*

```
 public ActionResult SomeAction(...)
 {
      // ....
      ViewData["controller"] = "Tours"  
      // You could parse the Controller type name from:
      // this.ControllerContext.Controller.GetType().Name
      // ....
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T09:06:09.077

“真正的”控制器是什么意思？您的操作指向一个控制器。
你是说以前的控制器吗？那么：用于呈现指向您的面包屑控制器的链接创建的视图的控制器？
除非您将该控制器的名称作为参数添加到链接中，否则无法实现。

# reporting-services - SQL Server Reporting Services 2005 - 辅助功能指南

> ID：867651
> 
> 赞同：2
> 
> 时间：2009-05-15T08:59:05.040
> 
> 标签：reporting-services, accessibility

有谁知道是否可以根据 WCAG 1.0 或 2.0 访问 SQL Server Reporting Services 2005 的 html 输出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T15:45:39.570

差远了

# opengl - 如何在OpenGL中实现灰度渲染？

> ID：867653
> 
> 赞同：5
> 
> 时间：2009-05-15T08:59:27.783
> 
> 标签：opengl, effects, grayscale

在渲染纹理多边形场景时，我希望能够在原始颜色渲染和“灰度”模式之间切换。我一直在尝试使用混合和颜色矩阵操作来实现这一点；它都不起作用（通过混合我找不到一个 glBlendFunc() 可以实现与我想要的东西很相似的东西，并且颜色矩阵操作[......在这里讨论](https://stackoverflow.com/questions/789904/opengl-color-matrix)）。

想到的一个解决方案（但也相当昂贵）是每帧捕获屏幕并将生成的纹理转换为灰度纹理并显示它......（我说灰度实际上是指任何低饱和度的东西，但我猜大多数可能的解决方案与灰度没有太大区别）。

我还有什么其他选择？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-15T16:29:22.447

默认的 OpenGL 帧缓冲区使用 RGB 颜色空间，它不存储显式饱和度。您需要一种方法来提取饱和度，对其进行修改，然后再次将其改回。

我之前的建议只是使用 RGB 矢量长度来表示亮度为 0 是不正确的，因为它没有考虑缩放，我很抱歉。

新的简短片段归功于来自 FreeNode/IRC 上 ##opengl 和 ##opengl3 的普通用户“RTFM_FTW”，它允许您直接修改饱和度，而无需计算代价高昂的 RGB->HSV->RGB 转换，即正是你想要的。尽管就您的问题而言，HSV 代码较差，但我还是让它留下来。

```
void main( void ) 
{ 
    vec3 R0 = texture2DRect( S, gl_TexCoord[0].st ).rgb;
    gl_FragColor = vec4( mix( vec3( dot( R0, vec3( 0.2125, 0.7154, 0.0721 ) ) ),
        R0, T ), gl_Color.a ); 
} 
```

如果您想要更多的控制而不仅仅是饱和度，您需要转换为 HSL 或 HSV 色彩空间。如下所示，使用 GLSL 片段着色器。

阅读[http://www.opengl.org/registry](http://www.opengl.org/registry)上的 OpenGL 3.0 和 GLSL 1.30 规范，了解如何使用 GLSL v1.30 功能。

```
#version 130
#define RED 0
#define GREEN 1
#define BLUE 2

in vec4 vertexIn;
in vec4 colorIn;
in vec2 tcoordIn;
out vec4 pixel;
Sampler2D tex;
vec4 texel;
const float epsilon = 1e-6;

vec3 RGBtoHSV(vec3 color)
{
    /* hue, saturation and value are all in the range [0,1> here, as opposed to their
       normal ranges of: hue: [0,360>, sat: [0, 100] and value: [0, 256> */
    int sortindex[3] = {RED,GREEN,BLUE};
    float rgbArr[3] = float[3](color.r, color.g, color.b);

    float hue, saturation, value, diff;
    float minCol, maxCol;
    int minIndex, maxIndex;

    if(color.g < color.r)
        swap(sortindex[0], sortindex[1]);
    if(color.b < color.g)
        swap(sortindex[1], sortindex[2]);
    if(color.r < color.b)
        swap(sortindex[2], sortindex[0]);

    minIndex = sortindex[0];
    maxIndex = sortindex[2];
    minCol = rgbArr[minIndex];
    maxCol = rgbArr[maxIndex];

    diff = maxCol - minCol;

    /* Hue */
    if( diff < epsilon){
        hue = 0.0;
    }
    else if(maxIndex == RED){
        hue = ((1.0/6.0) * ( (color.g - color.b) / diff )) + 1.0;
        hue = fract(hue);
    }
    else if(maxIndex == GREEN){
        hue = ((1.0/6.0) * ( (color.b - color.r) / diff )) + (1.0/3.0);
    }
    else if(maxIndex == BLUE){
        hue = ((1.0/6.0) * ( (color.r - color.g) / diff )) + (2.0/3.0);        
    }

    /* Saturation */
    if(maxCol < epsilon)
        saturation = 0;
    else
        saturation = (maxCol - minCol) / maxCol;

    /* Value */
    value = maxCol;

    return vec3(hue, saturation, value);
}
vec3 HSVtoRGB(vec3 color)
{
    float f,p,q,t, hueRound;
    int hueIndex;
    float hue, saturation, value;
    vec3 result;

    /* just for clarity */
    hue = color.r;
    saturation = color.g;
    value = color.b;

    hueRound = floor(hue * 6.0);
    hueIndex = int(hueRound) % 6;
    f = (hue * 6.0) - hueRound;
    p = value * (1.0 - saturation);
    q = value * (1.0 - f*saturation);
    t = value * (1.0 - (1.0 - f)*saturation);

    switch(hueIndex)
    {
        case 0:
            result = vec3(value,t,p);
        break;
        case 1:
            result = vec3(q,value,p);
        break;
        case 2:
            result = vec3(p,value,t);
        break;
        case 3:
            result = vec3(p,q,value);
        break;
        case 4:
            result = vec3(t,p,value);
        break;
        default:
            result = vec3(value,p,q);
        break;
    }
    return result;
}
void main(void)
{
    vec4 srcColor;
    vec3 hsvColor;
    vec3 rgbColor;
    texel = Texture2D(tex, tcoordIn);
    srcColor = texel*colorIn;
    hsvColor = RGBtoHSV(srcColor.rgb);
    /* You can do further changes here, if you want. */
    hsvColor.g = 0; /* Set saturation to zero */
    rgbColor = HSVtoRGB(hsvColor);
    pixel = vec4(rgbColor.r, rgbColor.g, rgbColor.b, srcColor.a);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T09:03:46.417

如果您正在使用足够现代的 OpenGL，我会说[像素着色器](http://en.wikipedia.org/wiki/Pixel_shader)在这里是一个非常合适的解决方案。通过在渲染时挂钩每个多边形的阴影，或者通过在第二次传递中执行单个全屏四边形来读取每个像素，转换为灰度，然后将其写回。除非您的分辨率、图形硬件和目标帧速率在某种程度上是“极端”的，否则这些天在大多数情况下应该是可行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T09:06:50.840

对于大多数桌面来说，渲染到纹理不再那么昂贵，所有 compiz、aero 等以及最近标题中看到的绽放或景深等效果都依赖于它。

实际上，您不会将屏幕纹理本身转换为灰度，您可能希望使用纹理和片段着色器绘制一个屏幕大小的四边形，将值转换为灰度。

另一种选择是为您的三角形设置两组片段着色器，一组只是将 gl_FrontColor 属性复制为固定函数 pieline，另一组将灰度值写入屏幕缓冲区。

如果您设置 uüp 灰度调色板，第三个选项可能是索引颜色模式，但该模式可能已被弃用并且现在支持不佳；如果我没记错的话，你会失去很多功能，比如混合。

# asp.net-mvc - 实现多数据库、多提供商认证系统

> ID：867655
> 
> 赞同：2
> 
> 时间：2009-05-15T09:00:07.207
> 
> 标签：asp.net-mvc, authentication, openid, dotnetopenauth

我们已经开始构建一个 asp.net mvc 应用程序。应用程序将包含一个主数据库，其中包含用户、项目、公用表等……以及许多数据库（都具有相同的结构），其中包含与特定项目相关的数据。使用可以有一些全局角色（存储在主数据库中）和一些项目特定角色（存储在项目数据库中），并且每个用户可以链接到许多项目。

我的目标是构建一个支持经典用户名/密码身份验证和 OpenID 身份验证的身份验证系统（我们为此使用 DotNetOpenAuth）和支持我上面描述的角色系统的授权系统。

但是我遇到了几个问题：1.）我认为我们应该支持单个用户的（用户名/密码和 Ppenid）身份验证选项，以便用户名/密码用户在决定他们时不需要创建额外的帐户将使用一个 OpenId，我认为我们应该像 SO 那样为单个用户支持多个 OpenId（如果某些提供程序已关闭）。

2.) 我认为最好的数据库是：

```
table Users (UserId (PK), LastActivityDate)
table UsernameLogins (UserId (PK,FK), Username, Password, IsApproved, IsLockedOut, LastLoginDate, LastLockedOutDate, etc...)
table OpenIdLogins(OpenIdUrl (PK), UserId(FK),LastLoginDate)
table Profiles(UserId(PK,FK), DisplayName(Unique), Email (Unique), FirstName, LastName, Address, Country, etc...)
table Roles(RoleName (PK), RoleType(1=GlobalRole,2=ProjectRole).
table UserRoles(UserId(FK,PK), RoleName(PK)). 
```

3.) 我应该创建自己的提供商（MembershipProvider、ProfileProvider、RoleProvider）吗？似乎 MembershipProvider 不太适合 OpenId 身份验证（当然我只能支持基本方法（GetUser，ValidateUser））？我应该只为用户名/密码登录实现 MembershipProvider 吗？我认为 ProfileProvider 和 RoleProvider 不会那么难实现吗？我应该只使用 FormsAuthentication 并使用我自己的“服务”吗？

我们还在为 DI 使用 NHibernate 和 Spring。

任何建议将被认真考虑。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T14:13:35.783

> 1.）我认为我们应该支持单个用户的（用户名/密码和 Ppenid）身份验证选项，以便用户名/密码用户在决定使用 OpenId 时不需要创建其他帐户，我认为我们应该像 SO 那样为单个用户支持多个 OpenId（如果某些提供程序已关闭）。

这似乎是合理的。我喜欢您为拥有多个 OpenID 的用户设计的方式。StackOverflow 将用户限制为只有两个，但用户通常拥有更多，并且可能希望将它们全部绑定。如果您的目标受众需要 OpenID，我认为用户名/密码是一个不错的选择。StackOverflow 是一个很好的例子，说明当它的纯 OpenID 时登录是多么简单。不提供用户名/密码可以使登录不那么忙。但同样，提供这两种选择似乎最以客户为中心，因为它给了他们选择。DNOA 的未来版本将在其 OpenID 登录系统中提供 InfoCard Selector 的集成版本，以便您甚至可以直接接受 InfoCard，但它的外观和感觉就像 OpenID，因此您的系统不需要任何更改。

> 2.) 我认为最好的数据库是：`<snipped/>`

这看起来是一个合理的模式。正如您所发现的，分离凭证表为您提供了最大的灵活性。

> 3.) 我应该创建自己的提供商（MembershipProvider、ProfileProvider、RoleProvider）吗？

MembershipProvider 肯定不太适合 OpenID。如果你只支持 OpenID 登录，我会说把它扔掉，不要费心实现你自己的。RoleProvider 与 OpenID 完美配合，因此它是一个守门员。我从其他人那里听说 ProfileProvider 需要 MembershipProvider 才能发挥作用。我不知道这是不是真的。但是 ProfileProvider 要求您使用 ASP.NET Membership SQL 数据库架构，如果您可以编写自己的数据库架构，我认为这很糟糕。而且，如果您正在编写自己的数据库，那么存储有关用户的其他数据应该是微不足道的，因此您不需要配置文件提供程序。

如果您同时使用用户名+密码和 OpenID，那么拥有一个您自己实现的 MembershipProvider 可能是可能的，但根据我的经验，大多数包含任何 OpenID 代码的 MembershipProviders 都是杂乱无章的，甚至存在安全漏洞。因此，如果 OpenID 在您的系统中有任何位置，我仍然会避免使用 MembershipProvider。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T14:20:15.640

我想知道……对多个 OpenID 的支持是否很重要。看起来这更像是 OpenID 提供者的角色。例如，我使用 ClaimID，我得到了本质上相当于“识别转发”（在电子邮件转发的意义上）的内容，以便我可以将其重新绑定到不同的身份。现在我不经常重新绑定提供者，但提供者可以这样做（即，当您被重定向到他们的登录页面时，他们可能会询问您最终想要呈现的身份）。所以问题是……这真的是要实施的应用程序工作吗？

# c# - 关闭时淡出 wpf 窗口

> ID：867656
> 
> 赞同：22
> 
> 时间：2009-05-15T09:00:22.320
> 
> 标签：c#, wpf, animation, eventtrigger, routedevent

我想在我的应用程序中淡入/淡出一个窗口。
淡入发生在`Window.Loaded`并且我想在关闭时淡出（`Window.Closed`或`Window.Closing`）。淡入效果完美，但`Window.Closing`不允许为`RoutedEvent`属性值。
我`RoutedEvent`应该使用什么来关闭？

```
 <Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:2" FillBehavior="HoldEnd" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="Window.Closing">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:2" FillBehavior="HoldEnd" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers> 
```

我收到错误消息，无法将值“Window.Closing”分配给属性“RoutedEvent”。事件名称无效。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-15T12:04:02.100

关闭不是路由事件，因此您不能在 EventTrigger 中使用它。也许您可以在代码隐藏中的 ClosingEvent 处理程序中启动情节提要并取消事件......类似这样的事情：

```
private bool closeStoryBoardCompleted = false;

private void Window_Closing(object sender, CancelEventArgs e)
{
    if (!closeStoryBoardCompleted)
    {
        closeStoryBoard.Begin();
        e.Cancel = true;
    }
}

private void closeStoryBoard_Completed(object sender, EventArgs e)
{
    closeStoryBoardCompleted = true;
    this.Close();
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-17T15:23:00.023

我想我会添加另一个解决方案，使用 Expression SDK 中的行为并将其与 @Thomas 的解决方案相结合。使用它，我们可以定义一个“CloseBehavior”来处理启动故事板并在完成后关闭窗口的代码。

```
using System.ComponentModel;
using System.Windows;
using System.Windows.Interactivity;
using System.Windows.Media.Animation;

namespace Presentation.Behaviours {
    public class CloseBehavior : Behavior<Window> {
        public static readonly DependencyProperty StoryboardProperty =
            DependencyProperty.Register("Storyboard", typeof(Storyboard), typeof(CloseBehavior), new PropertyMetadata(default(Storyboard)));

        public Storyboard Storyboard {
            get { return (Storyboard)GetValue(StoryboardProperty); }
            set { SetValue(StoryboardProperty, value); }
        }

        protected override void OnAttached() {
            base.OnAttached();
            AssociatedObject.Closing += onWindowClosing;
        }

        private void onWindowClosing(object sender, CancelEventArgs e) {
            if (Storyboard == null) {
                return;
            }
            e.Cancel = true;
            AssociatedObject.Closing -= onWindowClosing;

            Storyboard.Completed += (o, a) => AssociatedObject.Close();
            Storyboard.Begin(AssociatedObject);
        }
    }
} 
```

该行为将故事板定义为依赖属性，因此我们可以在 xaml 中设置它，并且当`AssociatedObject`（我们定义行为的窗口）关闭时，该故事板使用`Storyboard.Begin()`. 现在，在 xaml 中，我们只需使用以下 xaml 将行为添加到窗口

```
<Window x:Class="Presentation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:behave="clr-namespace:Presentation.Behaviours"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        x:Name="window">
    <Window.Resources>
        <Storyboard x:Key="ExitAnimation">
            <DoubleAnimation Storyboard.Target="{Binding ElementName='window'}"
                             Storyboard.TargetProperty="(Window.Opacity)"
                             Duration="0:0:1" From="1" To="0"/>
        </Storyboard>
    </Window.Resources>

    <i:Interaction.Behaviors>
        <behave:CloseBehavior Storyboard="{StaticResource ExitAnimation}"/>
    </i:Interaction.Behaviors>

    <Grid>
    </Grid>
</Window> 
```

请注意 System.Windows.Interactivity dll 中的 xml 命名空间`i`，并且还引用了该窗口，因此必须对其进行`x:Name`分配。现在我们只需在关闭应用程序之前将行为添加到我们希望在其上执行情节提要的每个窗口，而不是将逻辑复制到每个窗口中的每个代码隐藏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T11:50:16.453

我不是 WPF 方面的专家，但我相信除非你取消最初的 Closing 事件，否则窗口甚至会在动画开始之前消失。

收到 Window.Closing 事件后，您应该取消该事件并启动动画。动画完成后，您可以关闭窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-19T01:00:57.240

这甚至更简单、更短。添加如下行为：

```
public class WindowClosingBehavior : Behavior<Window>
    {
        protected override void OnAttached()
        {
            AssociatedObject.Closing += AssociatedObject_Closing;
        }

        private void AssociatedObject_Closing(object sender, System.ComponentModel.CancelEventArgs e)
        {
            Window window = sender as Window;
            window.Closing -= AssociatedObject_Closing;
            e.Cancel = true;
            var anim = new DoubleAnimation(0, (Duration)TimeSpan.FromSeconds(0.5));
            anim.Completed += (s, _) => window.Close();
            window.BeginAnimation(UIElement.OpacityProperty, anim);
        }
        protected override void OnDetaching()
        {
            AssociatedObject.Closing -= AssociatedObject_Closing;
        }
    } 
```

然后在您的窗口中添加参考：

```
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
xmlns:wt="clr-namespace:Desktop.Themes.WindowTask;assembly=Desktop.Themes" 
```

插入行为：

```
<i:Interaction.Behaviors>
     <wt:WindowClosingBehavior />
</i:Interaction.Behaviors> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-09-18T19:01:11.420

将自动反转设置为“真”

```
<Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" AutoReverse="True" From="0" To="1" Duration="0:0:0.5" FillBehavior="HoldEnd" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers> 
```

# api - 上传视频到我的空间

> ID：867658
> 
> 赞同：0
> 
> 时间：2009-05-15T09:00:44.567
> 
> 标签：api, file-upload, myspace

我正在开发一个上传视频的应用程序，我正在尝试找出 Myspace API 是否支持视频上传。但是我在他的论坛中找不到它，是否有其他方法可以让用户这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-16T22:31:42.060

使用最新版本的 MySpace API，您可以使用 OpenSocial 端点上传视频。更多信息可以在这里找到：[http ://wiki.developer.myspace.com/index.php?title=OpenSocial_0.9_MediaItems](http://wiki.developer.myspace.com/index.php?title=OpenSocial_0.9_MediaItems)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T10:43:45.940

使用 Myspace android sdk，并在其上使用示例项目并放置您的密钥而不是消费者密钥和秘密密钥。

# c# - 检查字符串结尾的问题

> ID：867659
> 
> 赞同：1
> 
> 时间：2009-05-15T09:01:01.977
> 
> 标签：c#, string

这似乎是一个非常奇怪的问题，我一生都无法弄清楚。我有一个看起来像这样的路径（字符串）：

> D:\development\php\bchat\chat\index.php

我需要检查有问题的文件是否是 PHP 文件。我认为最合乎逻辑的方法是从 . 到字符串的末尾，看看它是否 == .php

所以我尝试了：

```
bool isphp = (path.Substring(path.LastIndexOf('.')) == ".php") ? true : false; 
```

这总是返回错误。我想也许最后有一个尾随空格把我搞砸了，所以我在它前面的路径上放了一个 TrimEnd()。但这并没有改变什么。所以我尝试了这个：

```
bool isphp = (path.EndsWith(".php") == true) ? true : false; 
```

这也总是返回 false。

**编辑** 我现在也试过这个：

```
bool isphp = (Path.GetExtension(path) == ".php"); 
```

但这也返回 false。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T09:04:05.650

使用路径类。它有一个 GetExtension() 方法：

```
var path =  @"D:\development\php\bchat\chat\index.php";
if( Path.GetExtension( path.ToUpperInvariant() ) == ".PHP" )
{} 
```

编辑：添加了大小写检查

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T09:17:29.503

以下代码在我的机器上运行良好：

```
 public static void Main()
    {
        string path = @"D:\development\php\bchat\chat\index.php";
        bool isPhp = path.EndsWith(".php");
        Console.WriteLine(isPhp);
    } 
```

所以我猜你的字符串还有其他原因导致它不起作用。也许这是一个案例，在这种情况下，像这样将 StringComparison.InvariantCultureIgnoreCase 添加到您的 EndsWith 调用中。

```
 public static void Main()
    {
        string path = @"D:\development\php\bchat\chat\index.pHp";
        bool isPhp = path.EndsWith(".php", StringComparison.OrdinalIgnoreCase);
        Console.WriteLine(isPhp);
    } 
```

如果这不起作用，请在比较行上设置一个断点，然后在“立即”窗口中键入：

```
path[path.Length-1] 
```

你应该得到这个结果：

```
112 'p' 
```

如果你不这样做，你可以看出你的路径不是以标准 p 字符结尾的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T09:04:41.437

如果它是现有文件，您可以为其获取 FileInfo 对象并以这种方式检查扩展名：

```
FileInfo fi = new FileInfo(@"D:\development\php\bchat\chat\index.php");
if (fi.Exists && fi.Extension == ".php")
{
    //Do something
} 
```

* * *

或者我想你可能是一只羊，随波逐流，使用其他人建议的更好的 Path.GetExtension 方法。但首先问自己这个问题——你想用最干净、最快和最好的方式来做，还是想坚持你的个性，和我一起走上最抗拒的道路？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T09:10:14.857

只是已发布解决方案的示例：

```
bool isphp = Path.GetExtension(path)
                 .Equals(".php", StringComparison.InvariantCultureIgnoreCase); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T09:04:46.930

使用 Path.GetExtension 并与您要查找的文件类型进行比较。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T09:05:21.327

[Path.GetExtension](http://msdn.microsoft.com/en-us/library/system.io.path.getextension.aspx)方法呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T09:07:16.283

更新：

检查`path.Substring(path.LastIndexOf('.')`实际返回的内容 - 这可能会为您指明正确的方向。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T09:07:37.123

确保大小写没有区别。您只测试小写的“php”。

```
string ext = Path.GetExtension(path);
bool isPhp = (ext.Equals(".php", StringComparison.InvariantCultureIgnoreCase)); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T09:20:38.840

```
private static bool IsPhp(string fileName)
{
    return string.Compare(Path.GetExtension(fileName), ".php",
        StringComparison.OrdinalIgnoreCase) == 0;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-15T09:32:35.817

我怀疑你的字符串中有一些“奇怪”的东西。我建议您详细转储您的字符串，如下所示：

```
foreach (char c in path)
{
    Console.WriteLine("'{0}' U+{1:x4}", c, (int) c);
} 
```

这样，您将看到任何意外字符，例如“真实”字符之间的 unicode char 0。

# java - j2me 网络、线程和死锁

> ID：867660
> 
> 赞同：7
> 
> 时间：2009-05-15T09:01:25.843
> 
> 标签：java, multithreading, java-me, mobile, deadlock

下面的一段简单的 midlet 代码（Moo 类）（在摘录之后）死锁（至少我认为在阅读这里关于线程的帖子后它会死锁[）](http://developers.sun.com/mobility/midp/ttips/threading3/index.html)。

我已经复制了帖子的相关摘录：

```
 String url = ...
    Connection conn = null;

    try {
        conn = Connector.open( url );
        // do something here
    }
    catch( IOException e ){
        // error
    } 

```

**问题的根源在于 open() 调用的阻塞特性。在某些平台上，系统在幕后进行实际连接，相当于一个单独的线程。调用线程阻塞，直到连接线程建立连接。同时，安全子系统可能要求用户确认连接，连接线程阻塞，直到事件线程得到用户的确认。发生死锁是因为事件线程已经在等待连接线程。**

```
 public class Moo extends MIDlet {

    protected void destroyApp(boolean arg0) throws MIDletStateChangeException {
        // TODO Auto-generated method stub

    }

    protected void pauseApp() {
    }

    protected void startApp() throws MIDletStateChangeException {
        Display display = Display.getDisplay(this);
        MyCanvas myCanvas = new MyCanvas();
        display.setCurrent(myCanvas);
        myCanvas.repaint();

    }

    class MyCanvas extends Canvas {

        protected void paint(Graphics graphics) {
                try {
                        Image bgImage = Image.createImage(getWidth(), getHeight());

                        HttpConnection httpConnection = (HttpConnection) Connector
                                        .open("http://stackoverflow.com/content/img/so/logo.png");
                        Image image = Image.createImage(httpConnection
                                        .openInputStream());
                        bgImage.getGraphics().drawImage(image, 0, 0, 0);
                        httpConnection.close();

                        graphics.drawImage(bgImage, 0, 0, 0);
                } catch (IOException e) {
                        e.printStackTrace();
                }
        }

    }

} 

```

有人可以告诉我系统线程调用是如何在这里完成的（事件和通知线程）以及导致死锁的事件序列。我不清楚这里涉及哪些线程导致死锁。

1.  有没有关于 j2me 线程模型的文档？
2.  我在哪里可以获得 j2me 系统类的源代码（我想查看 Connection 类的实现）？

**编辑**：在上面的代码中，我得到了逻辑。但是下面的代码至少应该可以正常工作吗？这也导致我在一个单独的线程中进行网络连接的死锁。

```
 public class Foo extends MIDlet {

    protected void destroyApp(boolean arg0) throws MIDletStateChangeException {
        // TODO Auto-generated method stub
    }

    protected void pauseApp() {
        // TODO Auto-generated method stub
    }

    protected void startApp() throws MIDletStateChangeException {
        Display display = Display.getDisplay(this);
        MyCanvas myCanvas = new MyCanvas();
        display.setCurrent(myCanvas);
        myCanvas.repaint();
    }

    class MyCanvas extends Canvas {
        protected void paint(Graphics graphics) {
            try {
                Image bgImage = Image.createImage(getWidth(), getHeight());

                FetchImage fetchImage = new FetchImage();
                Thread thread = new Thread(fetchImage);
                thread.start();

                thread.join();

                bgImage.getGraphics().drawImage(fetchImage.image, 0, 0, 0);

                graphics.drawImage(bgImage, 0, 0, 0);
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }

    public class FetchImage implements Runnable {
        public Image image;

        public void run() {
            HttpConnection httpConnection;
            try {
                httpConnection = (HttpConnection) Connector
                        .open("http://10.4.71.200/stage/images/front/car.png");
                image = Image.createImage(httpConnection.openInputStream());
                httpConnection.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

    }
} 
```

 `* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-15T12:56:08.027

> 我在哪里可以获得 j2me 系统类的源代码（我想查看 Connection 类的实现）？

你不能。它实际上取决于供应商。诺基亚处理这种情况的方式可能与摩托罗拉不同。

您必须吸取的教训是不要在系统回调中进行昂贵的计算，因为这可能会使系统无响应。因此，将耗时的操作放在单独的线程中，并始终尽早从回调中返回。

即使您在第二个示例中创建了一个单独的线程，您仍等待它在 paint() 中完成，它最终会导致根本没有线程！

你可以做的一件事是

```
class MyCanvas extends Canvas {

    Image image;
    boolean imageFetchFailed;

    protected void paint(Graphics g) {
        if (image == null) {
            fetchImage();
            g.drawString("Fetching...", getWidth() >> 1, getHeight() >> 1, Graphics.HCENTER | Graphics.TOP)

        } else if (imageFetchFailed) {
            g.drawString("Failed to fetch image", getWidth() >> 1, getHeight() >> 1, Graphics.HCENTER | Graphics.TOP)
        } else {
            g.drawImage(image, 0, 0, 0);
        }
    }

    private void fetchImage() {
        new Thread(new Runnable() {
            public void run() {
                HttpConnection httpConnection = null;
                try {
                    httpConnection = (HttpConnection) Connector
                            .open("http://10.4.71.200/stage/images/front/car.png");
                    image = Image.createImage(httpConnection.openInputStream());
                } catch (IOException e) {
                    e.printStackTrace();
                    imageFetchFailed = true;
                }

                if (httpConnection != null) {
                    try {
                        httpConnection.close();
                    } catch (IOException ignored) {
                    }
                }

                // Following will trigger a paint call 
                // and this time image wont be null and will get painted on screen
                repaint();    
            }
        }).start();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T10:49:44.650

嗯，基本问题是一些 Java VM 实现使用相同的 Java 线程来做所有事情。

关于 VM 的线程模型，您需要弄清楚的第一件事就是谁开发了它。

这里有一个 J2ME 被许可人列表：http: [//java.sun.com/javame/licensees/index.jsp](http://java.sun.com/javame/licensees/index.jsp)

根据这些信息，尝试找出您的 VM 正在使用多少本机线程。两种常见的模型要么将所有字节码解释运行到一个本地线程中，要么将每个 java 线程运行到它自己的本地线程中。

下一步是收集有关底层操作系统 API 的异步程度的信息。在开发 VM 时，被许可方必须编写本机代码才能将 VM 移植到操作系统。任何进程间通信或使用慢速传输介质（从闪存卡到 GPS 信号）都可以使用单独的本机线程来实现，该线程可以允许字节码解释器线程在系统等待某些数据时继续运行。

下一步是意识到虚拟机的实现有多糟糕。通常，当 VM 对 MIDP 规范中的所有回调方法仅使用一个内部 java 线程时，就会出现问题。因此，如果您尝试在错误的 java 线程中打开连接，则只有在打开连接之后，您才有机会对键盘事件做出反应。

更糟糕的是，您实际上可以阻止刷新屏幕，因为 Canvas.paint() 将在与 javax.microedition.media.PlayerListener.playerUpdate() 相同的 Java 线程中被调用。

从 VM 实现的角度来看，黄金法则是任何您无法控制的回调（因为它可能以“用户”代码结束，如侦听器）不能从您使用解除阻塞标准 API 调用的同一个 java 线程调用。那里的许多 VM 只是违反了该规则，因此 Sun 建议 JavaME 开发人员解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T11:40:52.607

Canvas.paint() 是一种[事件传递方法](http://java.sun.com/javame/reference/apis/jsr118/javax/microedition/lcdui/Canvas.html#eventdelivery)，这意味着它被系统事件线程调用。

假设在系统上，Canvas.paint() 调用和用户确认事件处理均由 UI 事件线程 (UT) 实现。

现在，当 UT 在 Canvas.paint() 中被 Connector.open() 阻塞时，UT 肯定无法处理下一个即将到来的事件，在这种情况下是由 Connector.open() 触发的用户确认事件。当另一个事件在您的应用程序代码中被阻塞时，UT 无法处理它。

[这就是为什么在这里](http://developers.sun.com/mobility/midp/ttips/threading3/index.html)发生死锁，连接线程正在等待永远不会发生的事情，并永远阻塞UT。

一般来说，你不应该期望系统事件线程将如何实现，并尽可能快地从事件处理方法中返回。否则，您可能会收到较低的性能或像这样的死锁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T19:14:43.157

一些好主意，但在 Manoj 的示例中似乎存在竞争条件。

下载图像时可能会调用多个绘图，这会导致创建多个线程都下载相同的图像（额外绘图调用的一个示例是弹出 HTTP 连接提示时）。

由于所有的绘制调用都是在同一个线程上进行的，我们可以通过在绘制调用中测试和设置一个标志来避免同步。以下是改进版本的尝试：

```
 class MyCanvas extends Canvas {

    Image image;
    boolean imageDownloadStarted;
    boolean imageFetchFailed;

    protected void paint(Graphics g) {
        g.fillRect(0, 0, g.getClipWidth(), g.getClipHeight());
        if (image == null) {
            if (imageDownloadStarted)
                return;
            imageDownloadStarted = true;
            fetchImage();
            g.drawString("Fetching...", getWidth() >> 1, getHeight() >> 1, Graphics.HCENTER | Graphics.TOP);

        } else if (imageFetchFailed) {
            g.drawString("Failed to fetch image", getWidth() >> 1, getHeight() >> 1, Graphics.HCENTER | Graphics.TOP);
        } else {
            g.drawImage(image, 0, 0, 0);
        }
    }

    private void fetchImage() {
        new Thread(new Runnable() {

            public void run() {
                try {
                    final HttpConnection httpConnection = (HttpConnection) Connector.open("http://stackoverflow.com/content/img/so/logo.png");
                    try {
                        final InputStream stream = httpConnection.openInputStream();
                        try {
                            image = Image.createImage(stream);
                        } finally {
                            stream.close();
                        }
                    } finally {
                        httpConnection.close();
                    }
                } catch (IOException e) {
                    e.printStackTrace();
                    imageFetchFailed = true;
                }

                repaint();
            }
        }).start();
    }
} 
```

请注意使用*final*关键字来避免空测试和*openInputStream*返回的流的显式关闭。

# html - 有没有简单的 3 列纯 CSS 布局？

> ID：867667
> 
> 赞同：5
> 
> 时间：2009-05-15T09:04:03.653
> 
> 标签：html, css

一个不需要以下内容：

1.  依赖图像（即“假列”）
2.  专门为 IE 设置的某种怪异或“黑客”
3.  需要 IE 在 quirks 模式下运行
4.  没有像三个 DIV 之一重叠其他的奇怪（即“圣杯”）
5.  边距设置为高负数，使它们远离屏幕（再次是“圣杯”布局）

我在 CSS 中找不到不依赖上述之一的 3 列布局。依赖上述之一似乎否定了使用 CSS 优于表格的许多优势。每次我想改变左栏的宽度时，我都不想用 Photoshop 调整图像的大小。而且我不想拿出计算器来计算我的 DIV 必须在屏幕侧面有多少像素。

我应该提到我正在寻找一个等高的布局。

任何人？

编辑：我正在寻找 100% 的宽度，中心列是液体。

编辑：我也希望以像素为单位指定左右列的宽度。

编辑：背景可以是透明的，但我想要一个上下运行的列之间的分界线。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-15T09:24:15.073

当您谈论 CSS 时，没有“简单”之类的东西。

但是有一个简单的解决方案是跨浏览器、优雅地降级并且完全兼容 HTML 和 CSS：使用具有三列的表格。

推理：DIV 并不意味着具有相同的动态高度。因此，CSS 对此不提供支持。如果您需要一个块元素来确保其子元素具有相同的高度，那么这就是表格的用途。

[编辑] 很抱歉冒犯了所有的 CSS 狂热分子，但坦率地说，当某些东西不是为了做某事而设计的并且你滥用它时，它不起作用，请停止抱怨，好吗？DIV 不是 TABLE，不能在不依赖 hack 的情况下用作一个 DIV。

[[EDIT2] 正如在各个地方](https://stackoverflow.com/questions/82391/should-tables-be-avoided-in-html-at-any-cost)已经说过的那样，不使用表格进行布局的原因是，在早期，表格是*唯一*的设计元素，这导致 HTML 具有数十个嵌套表格。那很糟。但这并不意味着您**不能**使用单个表格来放置所有内容，然后依靠 CSS 使里面的内容看起来正确。

大脑就像降落伞：拥有它很好，但只有在它打开时才有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T12:25:15.637

您可能能够适应：

[http://matthewjamestaylor.com/blog/perfect-3-column.htm](http://matthewjamestaylor.com/blog/perfect-3-column.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T09:23:36.820

我同意罗伯特。由于浏览器对 CSS 规则的解释和最终页面的呈现方式不同，我怀疑你会找到一个完美的解决方案，而不会在你的要求上更加灵活。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T10:13:43.707

您可以通过使用 jS 来实现这一点。

如果您要创建 3 个 Div，则左一浮动，右一浮动，中间作为左右边距，宽度使其居中。

然后用一点 JS 每个 div 都有自己的 ID，你可以计算它们的高度，将 2 个较低的设置为最高值。

使用 Jquery 非常简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T10:39:25.157

[http://960.gs/](http://960.gs/)

这可用于 3 列布局（以及各种其他布局）。就个人而言，我不认为对所有事情都使用 div 是一个好主意，但它很简单而且很好......它很有效。

编辑：对于 100% 宽度的布局[http://www.alistapart.com/articles/fluidgrids/](http://www.alistapart.com/articles/fluidgrids/)可能会有所帮助，但我不确定这种布局是否仍然符合“简单”的条件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T12:33:09.940

[YAML](http://www.yaml.de)

> “Yet Another Multicolumn Layout” (YAML) 是一个 (X)HTML/CSS 框架，用于创建现代且灵活的浮动布局。该结构在编程方面非常通用，并且最终用户绝对可以访问。

它包含一些 IE 错误修复，但您可以删除它们。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-15T10:31:09.967

将页面分成三列，高度相同？

```
<html>
<head>
<style type="text/css">
#col_wrapper{
    height: 400px;
}

.col{
    width: 33%;
    float:left;
    height: 100%;
}
</style>
</head>
<body>
<div id="col_wrapper">
    <div class="col">
        one
    </div>
    <div class="col">
        two
    </div>
    <div class="col">
        three
    </div>
</div>
</body> 
```

没有怪癖，很简单。

# continuous-integration - 关于“自动构建”系统

> ID：867674
> 
> 赞同：1
> 
> 时间：2009-05-15T09:04:58.020
> 
> 标签：continuous-integration, build-automation

我有一些用 C++ 编写并使用 Visual Studio 2005 编译的项目。我使用 SVN 进行源代码控制。你能推荐一个自动构建系统来编译我的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T09:07:33.677

FinalBuilder 是首屈一指的，请查看：[http ://www.finalbuilder.com/](http://www.finalbuilder.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T09:47:26.187

Cruisecontrol 或 Cruisecontrol.net 都适合此类任务。您可以单独使用它们，也可以与构建（非自动构建）工具（例如 ant 或 nant）一起使用它们。

（它们都是免费的）。

不要被他们的 java 或 .net 基础所推迟，它们都会很高兴地允许您从 svn 构建 Visual Studio C++。

看

[http://cruisecontrol.sourceforge.net/](http://cruisecontrol.sourceforge.net/)

[http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)

# mfc - WM_POWERBROADCAST 消息未在 MFC Dlg 中捕获

> ID：867682
> 
> 赞同：0
> 
> 时间：2009-05-15T09:07:31.900
> 
> 标签：mfc, power-management, windows-messages

当系统进入睡眠模式时，我尝试捕捉 WM_POWERBROADCAST 消息。

我正在这样做：

```
BOOL CPowManApp::PreTranslateMessage(MSG* pMsg) 
{
    if(pMsg->message == WM_POWERBROADCAST || pMsg->message == WM_POWER)
    {
        CString strMessage;

        strMessage.Format(_T("%d WM_POWERB%s wParam %x lParam %x"),
                         pMsg->time,
                         pMsg->message == WM_POWER?_T(""):_T("BRAODCAST"),
                         pMsg->wParam,
                         pMsg->lParam);

        OutputDebugString(strMessage);
    }

    return CWinApp::PreTranslateMessage(pMsg);
} 
```

它根本行不通。同时，一个 win32 应用程序工作得很好。我试图将消息处理程序放在 Dlg 类中是徒劳的。

我正在使用 VS6.0 构建应用程序。我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T11:48:19.873

在您的消息映射中

```
ON_MESSAGE( WM_POWERBROADCAST, OnPowerBroadcast ) 
```

执行

```
LRESULT CDialogDlg::OnPowerBroadcast(WPARAM wParam, LPARAM lParam)
{
    switch (wParam)
    {
        case PBT_...
    }
} 
```

请务必检查[MSDN](http://msdn.microsoft.com/en-us/library/aa373247(VS.85).aspx)以了解有关 wParam 值的一些特定于操作系统的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:04:19.767

此消息的文档特别[说明](http://msdn.microsoft.com/en-us/library/aa373247(VS.85).aspx)：

> 窗口通过其 WindowProc 函数接收此消息。

您是否尝试在主窗口上覆盖此方法？

# biztalk - 如何为 BizTalk Map 中的目标架构元素设置默认值

> ID：867686
> 
> 赞同：2
> 
> 时间：2009-05-15T09:07:53.880
> 
> 标签：biztalk

我在 BizTalk 地图中有一个要求，其中

1.  我会将一些元素从源模式映射到目标模式，其中将根据某些条件将值分配给目标模式元素。

2.  如果未分配这些值，我需要发送一些默认值（N/A）。

3.  我的地图不是一对一的，因此我可以使用脚本函数并发送默认值，除此之外，目标模式是平面文件，在源模式中我必须循环很多。

因此，任何人都可以使用 BizTalk Map/架构中的某些设置给我一些关于“如果没有映射任何内容，如何将默认值设置为目标架构中的元素”的建议。

我已经尝试过的是，我打开了所有元素的目标架构，我将值“N/A”设置为属性->“DefaultValue”，它位于属性选项卡中，但是当没有映射任何内容时，默认值为不来。相反，节点本身并未在输出文件中创建。

请参阅下面的地图以获得更好的理解

[替代文字 http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/0131.problem.JPG](http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/0131.problem.JPG)

源模式是一个 XML 模式。

目标架构是平面文件架构。

现在在上面的地图中，在我的源模式中，我有一个名为 F4706 的节点，它将循环。

1.  当 F4706 中的元素“TypeAddressNumber”为“1”时，我将该 F4706 实例的剩余字段映射到目标架构中的“运送到”详细信息

2.  当 F4706 中的元素“TypeAddressNumber”为“2”时，我将该 F4706 实例的剩余字段映射到目标架构中的“经销商”详细信息

3.  当 F4706 中的元素“TypeAddressNumber”为“3”时，我将该 F4706 实例的剩余字段映射到目标架构中的“EndUser”详细信息

现在，如果我将逻辑 NOT functoid 连接到 Logical Equal functoid 并分配一些默认值，那么我的目标节点会出现三次，一次“=”函数返回 true 一次，另外两次返回 false。但我想要的是，如果有什么要映射的，那么从“F4706”实例映射或分配默认值。

在下面找到输入文件

[替代文字 http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/5430.ip.JPG](http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/5430.ip.JPG)

我期待和得到的输出是：

[替代文字 http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/0724.curOP.JPG](http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/0724.curOP.JPG)

现在，如果输入文件如下所示：

[替代文字 http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/6403.otherIP.JPG](http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/6403.otherIP.JPG)

也就是说，当我没有 TypeAddressNumber=2 的“F4706”节点时，我需要在目标架构中的经销商相关节点中填写“N/A”，如下所示：

[替代文字 http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/0435.nextOP.JPG](http://www.biztalkgurus.com/cfs-filesystemfile.ashx/__key/CommunityServer.Discussions.Components.Files/13/0435.nextOP.JPG)

如果你去检查正在生成的 XLST，它正在编写一个 xsl:foreach，所以如果你使用 xsl:choose/otherwise 条件会被检查多次并且我的输出节点会被复制。

我还尝试在第一个循环和第二个循环中使用 XLST 中的一些全局变量来访问它并写入默认值，不幸的是它也不起作用。因为 XLST 中的 VARIABLE 不是 TRUE 变量。我认为它是一个常数。

非常感谢如何完成此任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-30T06:37:34.327

我相信您实际上是在尝试根据某些条件控制输出节点的创建。

我已经尝试过记录（您正在尝试对元素执行此操作，所以我相信这也应该适用）。

我已将逻辑 functoid 的输出连接到记录，并且仅当逻辑 functoid 返回 true 时才创建记录。

对于默认值，您可以通过将默认值放入 Schema 元素的属性网格中以正确的方式进行操作。因此，如果没有任何内容映射到该元素，您将在 xsl 文件中看到生成了具有默认值的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T11:37:29.590

1.  在地图上放置两个“值映射”（将它们标记为“传入”和“默认”）并将输出从两者拖到您的目的地（您将在编译时收到警告）。

2.  在地图上放置“逻辑非”（将其标记为“NoValue”）。

3.  放置一个适合您需要的逻辑评估（存在、IsNil、长度），以评估您是否有传入值，并将源字段拖到其中。（将其标记为“HasValue”）

4.  将结果拖到“传入”和“逻辑非”。

5.  将您的源字段拖到“传入”。

6.  将输出从“NoValue”拖到“Default”。

7.  通过双击并插入新参数，将常量参数添加到“默认”，这是您的默认值。

希望你能理解这个烂摊子:)

# jstl - 我如何检查是否使用 jstl 设置了属性（不是 null 也不是空字符串）？

> ID：867687
> 
> 赞同：57
> 
> 时间：2009-05-15T09:08:25.907
> 
> 标签：jstl

例如

```
<c:if test="${post}">
    <h3>${post.title}</h3>  
</c:if> 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-05-15T09:18:22.420

使用空关键字

```
<c:if test="${not empty post}">
   <h3>${post.title}</h3>   
</c:if> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-08-10T02:36:36.600

您也可以使用“！” 而不是'不'：

```
<c:if test="${!empty post}">
    <h3>${post.title}</h3>
</c:if> 
```

# php - PHP 4 和 PHP 5 中的错误报告

> ID：867689
> 
> 赞同：0
> 
> 时间：2009-05-15T09:09:32.410
> 
> 标签：php

我将我的网站从 PHP 4.4 迁移到 PHP 5.2 两种情况下的 error_reporting 级别都是 E_ALL。在 PHP 4 上，该站点运行良好，但在迁移到 PHP 5 后，我发现一页抛出错误。 **无法重新声明 ClassName:varName** 我发现该变量确实在文件中重新声明。我想知道为什么它在 PHP4.4 中工作 PHP 4 E_ALL 不包括“类变量重新声明错误”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T09:39:43.803

我认为这不是关于错误报告，而是关于 PHP4 和 PHP5 中的 OOP 支持。PHP5 在 OOP 方面有很多变化。PHP4 中的 OOP 支持非常有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:52:09.963

我将不得不同意 Zilupe 在这一点上，PHP5 带来了更标准化的 OOP 支持，以至于您可以扩展一个类，但您不能重新声明它。如果没有通常的 LOL、ROFL 等，我从未想过 PHP4 和 OOP 真的存在于同一个句子中

# list - 如何以编程方式列出执行 MSBuild 时定义的所有属性？

> ID：867691
> 
> 赞同：12
> 
> 时间：2009-05-15T09:10:26.137
> 
> 标签：list, msbuild, properties, build, defined

我正在寻找一种方法来访问在执行 MSBuild 时定义的所有 Build 属性。我有一个配置文件。我想修改配置文件中的属性并将其复制到新位置。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T09:30:07.977

如果您使用 /verbosity:detailed 或 /verbosity:diagnostic 运行构建，您将获得构建过程中使用的所有属性的非常详细的输出。但是我怀疑您想在将构建的文件复制到另一个位置之后/之前更改配置类型文件？在这种情况下，有几种机制可以做到这一点，我们发现效果很好的是 MSBuildCommunity 任务，可以[在 code plex 上找到](http://msbuildextensionpack.codeplex.com)

如果你想看看这个的一些样本，我很乐意发布它们

# c - C 编程：从汇编程序的角度来看 ++i 和 i=i+1 之间的区别？

> ID：867692
> 
> 赞同：16
> 
> 时间：2009-05-15T09:10:33.280
> 
> 标签：c, compiler-construction, assembly, compilation, compiler-optimization

这是一道面试题。我说他们是一样的，但这被判定为错误的反应。从汇编程序的角度来看，有什么可以想象的区别吗？我使用默认的 gcc 优化和 -S 编译了两个简短的 C 程序以查看汇编器输出，它们是相同的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-15T09:17:56.897

面试官可能想要这样的答案：

> `i=i+1`将不得不加载 的值`i`，将其加一，然后将结果存储回`i`. 相反，`++i`可以使用单个汇编指令简单地增加值，因此理论上它可能更有效。但是，大多数编译器会优化掉差异，生成的代码将完全相同。

FWIW，您知道如何看待汇编这一事实使您成为比我多年来不得不采访的 90% 的人更好的程序员。不必与面试你的无知的失败者一起工作，这让你感到安慰。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-15T09:15:13.253

看起来你是对的，他们是错的。我在一次求职面试中遇到了类似的问题，我给出了被认为不正确的正确答案。

我自信地与我的面试官争论了这一点，他显然对我的无礼感到生气。我没有得到这份工作，但话又说回来，在“无所不知”的人手下工作也不是那么理想。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-15T09:16:32.923

你可能是对的。一个天真的编译器可能会这样做：

```
++i to inc [ax] 
```

和

```
i = i + 1 to add [ax], 1 
```

但是任何半明智的编译器只会优化将 1 添加到第一个版本。

这一切都假设相关架构具有 inc 和 add 指令（就像 x86 一样）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-15T14:27:14.097

为了保护面试官，上下文就是一切。i的类型是什么？我们是在谈论 C 还是 C++（或其他类似 C 的语言）？是否给了你：

```
++i;
i = i + 1; 
```

还是有更多的背景？

如果有人问我这个问题，我的第一反应会是“我易变吗？” 如果答案是肯定的，那么差异是巨大的。如果不是，则差异很小且语义上的差异，但实际上没有差异。证明是解析树的差异，以及生成的子树的最终含义。

所以听起来你在务实方面是对的，但语义/批判性思维方面是错误的。

为了攻击面试官（没有上下文），我不得不想知道这个问题的目的是什么。如果我问这个问题，我想用它来了解候选人是否知道细微的语义差异、如何生成解析树、如何批判性地思考等等。我通常会问我的面试者一个 C 问题，几乎每个候选人都会出错 - 这是设计使然。实际上，我并不关心问题的答案，[我关心的是我将与候选人](https://stackoverflow.com/questions/154112/c-potential-interview-questiontoo-hard/154385#154385)达成理解的旅程，它告诉我的不仅仅是一个琐事问题的正确/错误。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-15T09:36:12.220

在 C++ 中，它取决于`i`是 int 还是 object。如果它是一个对象，它可能会生成一个临时实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T13:24:28.807

上下文是这里的主要内容，因为在优化的版本构建中，如果 i++ 可用于简单的 [inc eax]，编译器将优化它。而像 int some_int = i++ 这样的东西需要将 i 值存储在 some_int FIRST 中，然后才增加 i。

# apache-flex - Flex3 改进基本跟踪

> ID：867695
> 
> 赞同：2
> 
> 时间：2009-05-15T09:12:51.073
> 
> 标签：apache-flex, actionscript-3, debugging, trace, logging

我在某处阅读了一个实用程序，以显示调用 trace("foo") 的函数的类 + 行 nbr，一旦您开始获得大量调试输出，这将非常方便。

关于在哪里找到它的任何提示？它是开源的，可能会在 flex 活动中展示。

```
trace("my debug");

> mydebug :34 bla.as3 .. 
```

谢谢，

格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T11:57:10.760

这是一个快速而肮脏的解决方案：

```
 private function mytrace(s:String):void {
        try {
            throw new Error();
        } catch (e:Error) {
            var arr:Array = e.getStackTrace().split("\n", 3);
            trace(arr[2] + " " + s);
        }
    } 
```

对于 mytrace("xyz") 你会得到：

```
at Main/init() xyz 
```

或者如果你用“-debug=true”编译：

```
at Main/init()[C:\home\myproject\Main.mxml:120] xyz 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T14:30:59.127

我以前没有见过这样的包，但你可能会很幸运地使用精心设计的正则表达式搜索谷歌的代码搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T03:41:52.473

我认为您指的是 Haxe ( [http://haxe.org](http://haxe.org) )，它是一种与 ActionScript 非常相似的开源编程语言。

他们没有浏览器可访问的存储库，但您可以按照此处的说明下载源代码[http://haxe.org/download](http://haxe.org/download)。

我确实设法在 Google 代码搜索上找到了一些东西：

*   [http://code.google.com/p/haxecli/source/browse/trunk/haxe/std/haxe/Log.hx](http://code.google.com/p/haxecli/source/browse/trunk/haxe/std/haxe/Log.hx)
*   [http://www.google.com/codesearch/p?hl=en#Pm0PKVV_vso/trunk/haxe/std/haxe/Log.hx](http://www.google.com/codesearch/p?hl=en#Pm0PKVV_vso/trunk/haxe/std/haxe/Log.hx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T21:17:30.273

你试过使用[MonsterDebugger](http://demonsterdebugger.com/buzz)了吗？它非常全面，易于安装，并且显示的不仅仅是跟踪语句 - 请参阅站点上的功能页面以获取概述。

我试过了，但它对我的口味来说太丰富了，我又回到了简单的跟踪语句——我的程序还没有那么复杂！

# outlook - 如何查找在 Outlook 2007 中复制的约会项目的计数

> ID：867701
> 
> 赞同：0
> 
> 时间：2009-05-15T09:15:08.510
> 
> 标签：outlook, outlook-2007, outlook-addin, outlook-object-model

在 Outlook 2007 中当用户有两个日历说测试和实际日历，他去查看测试日历中的所有约会，复制说大约 20 到 30 个约会并将它们粘贴到实际日历的“所有约会项目视图，如何获取消息框说复制了这么多项目。

如果再次为另外 50 个约会项目重复复制/粘贴，则进一步补充我上面的评论，则消息框应显示 50（此计数应正确出现，无需关闭 Outlook 或终止会话

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-07T01:26:38.720

This is how you do it.

```
Outlook.Application olApp = new Outlook.Application();
Outlook.Folder cal = olApp.Session.GetDefaultFolder(Outlook.oldefaultfolders.olCalender)();
System.Windows.Forms.MessageBox.Show("Number of items in calendar : {0}", cal.Items.Count.ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T10:24:43.137

如果我理解正确，您希望跟踪已从一个日历复制到另一个日历的项目数，并在对话框中显示复制的项目数。

我认为这样做的方法是在资源管理器对象周围编写一个包装类，如果你也想要的话，它可以连接 Explorer.BeforeItemCopy 和 Move 等。

当该事件触发时，您将不得不查找当前的项目选择以获取您的计数。

可能有更好的方法..？

76梅尔

# string - 如何在没有库函数的情况下将字符串解析为整数？

> ID：867706
> 
> 赞同：7
> 
> 时间：2009-05-15T09:18:08.097
> 
> 标签：string, parsing, integer

我最近在一次采访中被问到这个问题：

“你怎么能在不使用任何库函数且不考虑语言的情况下将'12345'形式的字符串解析为其整数表示12345？”

我想到了两个答案，但面试官说还有第三个。这是我的两个解决方案：

解决方案 1：保留一个映射 '1' => 1、'2' => 2 等的字典。然后一次解析一个字符，在字典中查找字符，然后乘以位置值。总结结果。

解决方案 2：一次解析一个字符并从每个字符中减去“0”。这将为您提供 '1' - '0' = 0x1、'2' - '0' = 0x2 等。同样，乘以位置值并对结果求和。

谁能想到第三种解决方案可能是什么？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T09:33:33.193

我希望这是面试官所追求的：

```
number = "12345"
value = 0
for digit in number:                    //Read most significant digit first
    value = value * 10 + valueOf(digit) 
```

此方法使用的操作远少于您概述的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T09:32:33.070

以相反的顺序解析字符串，使用两种方法之一解析单个数字，将累加器乘以 10，然后将数字添加到累加器中。

这样您就不必计算位置值。每次得到相同结果时，将累加器乘以十。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-23T17:30:49.517

Artelius 的答案非常简洁且与语言无关，但对于那些寻求更详细的答案和解释以及 C 和 Java 实现的人可以查看此页面：

[http://www.programminginterview.com/content/strings](http://www.programminginterview.com/content/strings)

向下滚动（或搜索）到“练习题：将 ASCII 编码字符串转换为整数”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T15:31:31.150

//java版本

```
public static int convert(String s){
    if(s == null || s.length() == 0){
        throw new InvalidParameterException();
    }

    int ret = 0;

    boolean isNegtive = false;

    for(int i=0;i<s.length();i++){
        char c = s.charAt(i);

        if( i == 0 && (c == '-')){
            isNegtive = true;
            continue;
        }

        if(c - '0' < 0 || c - '0' > 10){
            throw new InvalidParameterException();
        }

        int tmp = c - '0';

        ret *= 10;
        ret += tmp;

    }

    return isNegtive ? (ret - ret * 2) : ret;

} 
```

//单元测试

```
@Test
public void testConvert() {

    int v = StringToInt.convert("123");
    assertEquals(v, 123);

    v = StringToInt.convert("-123");
    assertEquals(v, -123);

    v = StringToInt.convert("0");
    assertEquals(v, 0);

}

@Test(expected=InvalidParameterException.class)
public void testInvalidParameterException() {
     StringToInt.convert("e123");
}

@Rule
public ExpectedException  exception = ExpectedException.none();
@Test
public void testInvalidParameterException2() {

    exception.expect(InvalidParameterException.class);
    StringToInt.convert("-123r"); 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T09:24:40.827

保留一个字典，将所有字符串映射到它们的整数对应项，直到某个限制？可能没有多大意义，除了如果上限很小，例如两位或三位数字，这可能*会更快。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T09:25:30.467

您总是可以通过大量的字符串表示查找表尝试二进制搜索！

没有人谈论效率... :-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-02T12:21:36.010

```
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

int nod(long);
char * myitoa(long int n, char *s);
void main()
{

  long int n;
  char *s;
  printf("Enter n");
  scanf("%ld",&n);
  s=myitoa(n,s);
  puts(s);
}

int nod(long int  n)
{
  int m=0;
  while(n>0)
  {
    n=n/10;
    m++;
  }
  return m;
}

char * myitoa(long int n, char *s)
{

  int d,i=0;
  char cd;
  s=(char*)malloc(nod(n));
  while(n>0)
  {
    d=n%10;
    cd=48+d;
    s[i++]=cd;
    n=n/10;
  }
  s[i]='\0';
  strrev(s);
  return s;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-01T10:11:54.233

**这是一个完整的程序，所有条件都是正面的，负面的，不使用库**

```
import java.util.Scanner;

public class StringToInt {
 public static void main(String args[]) {
  String inputString;
  Scanner s = new Scanner(System.in);
  inputString = s.nextLine();

  if (!inputString.matches("([+-]?([0-9]*[.])?[0-9]+)")) {
   System.out.println("error!!!");
  } else {
   Double result2 = getNumber(inputString);
   System.out.println("result = " + result2);
  }

 }
 public static Double getNumber(String number) {
  Double result = 0.0;
  Double beforeDecimal = 0.0;
  Double afterDecimal = 0.0;
  Double afterDecimalCount = 0.0;
  int signBit = 1;
  boolean flag = false;

  int count = number.length();
  if (number.charAt(0) == '-') {
   signBit = -1;
   flag = true;
  } else if (number.charAt(0) == '+') {
   flag = true;
  }
  for (int i = 0; i < count; i++) {
   if (flag && i == 0) {
    continue;

   }
   if (afterDecimalCount == 0.0) {
    if (number.charAt(i) - '.' == 0) {
     afterDecimalCount++;
    } else {
     beforeDecimal = beforeDecimal * 10 + (number.charAt(i) - '0');
    }

   } else {
    afterDecimal = afterDecimal * 10 + number.charAt(i) - ('0');
    afterDecimalCount = afterDecimalCount * 10;
   }
  }
  if (afterDecimalCount != 0.0) {
   afterDecimal = afterDecimal / afterDecimalCount;
   result = beforeDecimal + afterDecimal;
  } else {
   result = beforeDecimal;
  }

  return result * signBit;
 }
} 
```

# mysql - MySQL：当存储过程参数名称与表列名称相同时 [继续]

> ID：867709
> 
> 赞同：2
> 
> 时间：2009-05-15T09:18:56.957
> 
> 标签：mysql, stored-procedures, parameters, backticks

假设有一个存储过程 SetCustomerName，它有一个输入参数 Name，并且我有一个带有列 Name 的表客户。所以在我的存储过程中，我想设置客户的名字。如果我写

```
UPDATE customers SET Name = Name;
```

这是不正确的，我必须写（例如）

```
UPDATE customers SET `Name` = Name;
```

所以，有一个关于反引号的链接（[http://dev.mysql.com/doc/refman/5.0/en/identifiers.html](http://dev.mysql.com/doc/refman/5.0/en/identifiers.html)）但是它没有足够深入地解释如何使用它们（如何将它们与参数和列一起使用名称）。

还有一件很奇怪的事情（至少对我来说）：你可以用任何一种方式使用反引号：

```
UPDATE customers SET Name = `Name`;
//or
UPDATE customers SET `Name` = Name;
//or even
UPDATE customers SET `Name` = `Name`;
```

他们都以完全相同的方式工作。

你不觉得这很奇怪吗？这种奇怪的行为是否在某处得到了解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T00:21:21.507

我不明白为什么你首先需要使用反引号来逃避。在语句*UPDATE x SET a = b*中，*a*必须始终引用*x*的列。*但是b*可以是变量或列。鉴于[本地范围和变量解析在存储过程中的工作方式](http://dev.mysql.com/doc/refman/5.1/en/local-variable-scope.html)，*b将始终引用本地变量，即使**x*中存在同名的列。

因此，我无法重现您的问题。我试过这样：

```
mysql> SELECT * FROM comments;
+----+-----------+---------+
| id | parent_id | content |
+----+-----------+---------+
|  1 |         0 | bar     | 
|  2 |         0 | baz     | 
+----+-----------+---------+
2 rows in set (0.00 sec)
mysql> delimiter //
mysql> CREATE PROCEDURE foo(IN content TEXT)
    -> BEGIN
    ->   UPDATE comments SET content = content;
    -> END //
Query OK, 0 rows affected (0.00 sec)
mysql> delimiter ;
mysql> CALL foo('changed!');
Query OK, 2 rows affected (0.00 sec)
mysql> SELECT * FROM comments;
+----+-----------+----------+
| id | parent_id | content  |
+----+-----------+----------+
|  1 |         0 | changed! | 
|  2 |         0 | changed! | 
+----+-----------+----------+
2 rows in set (0.00 sec) 
```

如您所见，注释表的列*内容*得到更新，即使*内容*也是存储过程*foo*的参数名称。

你确定 UPDATE 客户 SET Name = Name; 给你一个错误？有了上面的解释，似乎合乎逻辑

```
UPDATE customers SET Name = `Name`;
UPDATE customers SET `Name` = Name;
UPDATE customers SET `Name` = `Name`; 
```

都具有相同的效果。

**编辑：**当然，SELECT 语句的情况会有所不同。

# tapestry - Tapestry 4 中过期的会话重定向

> ID：867716
> 
> 赞同：2
> 
> 时间：2009-05-15T09:20:57.343
> 
> 标签：tapestry

当用户会话过期时，如何更改 Tapestry 4 显示的页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:30:08.780

Ah, the old days, Tapestry 4...

I think there were different ways..

*   just name the page you want to display "StaleSession.html", or

*   put something in your app.application file.. like

    `<page name="StaleSession" specification-path="tapestry/page/StaleSession.page"/>`

or

*   put something in your hivemodule.xml, like

`<contribution configuration-id="tapestry.InfrastructureOverrides"> <property name="staleSessionPageName" value="MyStaleSessionPage" /> </contribution>`

hth

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:39:36.710

如果您需要检查用户是否登录或类似的东西，您可以在您的访问对象中设置一个属性，并在`validate(IRequestCycle cycle)`您的页面的方法中检查它。如果有多个页面，则为没有用户登录时要重定向的所有页面创建一个超类，并在超类中实现该方法。请记住，每当您调用时，`getVisit()`如果没有任何实例，您都会获得一个新实例，因此您需要在您的访问对象中设置一个属性以查看会话是否有效。

# asp.net-mvc - ASP.Net MVC FormCollection VS ModelBinding 效率

> ID：867717
> 
> 赞同：2
> 
> 时间：2009-05-15T09:21:47.620
> 
> 标签：asp.net-mvc, subsonic

我正在使用 Subsonic 3 ActiveRecord 方法，想知道在发布数据方面什么是最有效的。以下是两种情况：

一世）

```
public ActionResult Edit(Person PostedItem)
{
        Person p = new Person(PostedItem.ID);
        p.Name = PostedItem.Name;
        p.Update();
} 
```

ii)

```
public ActionResult Edit(FormCollection PostedItem)
{
        Person p = new Person(PostedItem["ID"]);
        p.Name = PostedItem["Name"];
        p.Update();
} 
```

我会想象 FormCollection 更有效，因为不需要发生模型绑定反射过程，但是它更好地具有强类型的东西。

有替代方法吗？还有什么可以放在传递发布数据的编辑参数中的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T13:24:50.937

我认为反射性能在这里完全不重要。哎呀，它甚至可能比字符串索引更快——我从来没有费心去测量。无论实际成本是多少，它几乎肯定会被保存数据库更改的成本所掩盖。此外，编辑（与页面加载相反）不会经常发生，以至于几毫秒就会加载您的服务器。

真正优化的第一条规则是分析您的应用程序并只优化实际上很慢的部分！

# vim - gvim 的类似尾巴的功能

> ID：867721
> 
> 赞同：27
> 
> 时间：2009-05-15T09:22:39.553
> 
> 标签：vim

我想使用 gvim 来查看一个不断更新的日志文件，这样我总是能看到最后更新的行，就像 unix 中的 tail 命令一样。是否可以？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-15T09:24:04.107

打开日志文件和

```
:setlocal autoread 
```

[vim](http://www.vim.org)站点上有一个插件（[Tail Bundle](http://www.vim.org/scripts/script.php?script_id=1714)） 。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-01-18T08:06:05.973

我喜欢它简短，没有大量的黑客或外部脚本。您可以在需要时从 ex (whithin vim) 运行此 oneliner（或将每个命令放在 vimrc 中，以便在打开日志文件时使用。）

```
:set autoread | au CursorHold * checktime | call feedkeys("lh") 
```

此外，您还可`:set syntax=logtalk`以为日志着色

**（如果您想（几乎）跳到文件末尾，只需使用“G”而不是“lh”和 feedkeys）**

解释：

*   `autoread`：从外部更改时读取文件（但它本身不起作用，没有内部计时器或类似的东西。它只会在 vim 执行操作时读取文件，就像 ex 中的命令`:!`
*   `CursorHold * checktime`：当光标在指定的时间`updatetime`（默认为 4000 毫秒）内没有被用户移动时`checktime`，执行，检查文件外部的更改
*   `call feedkeys("lh")`：光标移动一次，左右移动。然后什么也没有发生（...这意味着`CursorHold`触发，这意味着我们有一个**循环**）

要在使用时停止滚动`call feedkeys("G")`，请执行`:set noautoread`- 现在 vim 会告诉文件已更改并询问是否要读取更改）

*来自这个[答案](https://stackoverflow.com/a/48296697/4940240)（参考 PhanHaiQuang 的回答[和](https://stackoverflow.com/users/407256/flukus)[flukus](https://stackoverflow.com/users/2467354/phan-hai-quang)的评论）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T22:09:47.603

或者在 vim 7.x 上一个不太优雅的解决方案就是：e！每当您需要更新时。

# iphone - 如何在 iPhone OS 中从 PNG 图像中获取干净的 alpha 通道信息？

> ID：867723
> 
> 赞同：4
> 
> 时间：2009-05-15T09:23:46.447
> 
> 标签：iphone, cocoa-touch, uikit, core-graphics

我创建了这样的上下文（简化）：

```
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

CGContextRef context = CGBitmapContextCreate (bitmapData,
  pixWide,
  pixHeigh,
  8, // bits per component
  bitmapBytesPerRow,
  colorSpace,
  kCGImageAlphaPremultipliedFirst); 
```

现在，当我尝试使用 Alphatransparency 提取 PNG 中第一个像素的数据时，它具有非常奇怪的 alpha 值。我有一个简单的PNG，它是一个正方形。在每个边缘上，我切断了 10x10 像素并使它们完全透明。Alpha 不应该是像 153 这样的东西。

在 CGImage.h 中声明了一个 kCGImageAlphaOnly。医生说：

> kCGImageAlphaOnly 没有颜色数据，只有一个 alpha 通道。

好的，这听起来不错，因为我只需要 Alpha 数据，不需要其他任何东西。但这在我的脑海中提出了一些问号。如果我确实拥有一个带有一堆颜色 + alpha 的设备齐全的 PNG：这个常数会确保我的 PNG 被转换为匹配该颜色空间吗？或者我是否必须提供与指定颜色空间匹配的 PNG？

编辑：我尝试使用 kCGImageAlphaOnly，但出现此错误：

```
<Error>: CGBitmapContextCreate: unsupported parameter combination: 8 integer bits/component; 24 bits/pixel; 0-component colorspace; kCGImageAlphaOnly; 55 bytes/row. 
```

这里可能有什么问题？我之前指定了这个：

```
size_t pixelsWide = CGImageGetWidth(inImage);
size_t pixelsHigh = CGImageGetHeight(inImage);
bitmapBytesPerRow = (pixelsWide * 1); // not * 4, because I just want alpha
bitmapByteCount = (bitmapBytesPerRow * pixelsHigh); 
```

编辑：我一分钟前一直在读这个：

> 添加到 XCode 的 PNG 在编译期间由“pngcrush”优化。这会进行一些字节交换（从 RGBA 到 BRGA）和 alpha 的预乘。

我认为 alpha 的这种预乘会带来麻烦。

编辑：在 pngcrunch 对 PNG 进行字节交换之后，alpha 通道保持不变。因为我不关心颜色，只关心 alpha，所以我认为预乘应该不是一个太大的问题。

我的 PNG 在我将它们添加到 Xcode 之前是 24 位 PNG。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T14:59:39.073

You can't do this:

```
bitmapBytesPerRow = (pixelsWide * 1); // not * 4, because I just want alpha 
```

The function you're calling will always return all the image data. The `kCGImageAlphaOnly` constant is used to tell YOU that an image only contains an alpha channel, no colour information.

You'll need to use `pixelsWide * 4` for the bytesPerRow. Also note that the bitmapData argument to CGBitmapContextCreate() is used to provide storage space explicitly, rather than having it drawn for you.

Possibly what you want to do is this (untested code, just typed from memory):

```
CGImageRef image = GetMyImageFromWhereverItIs();
CGColorSpaceRef space = CGColorSpaceCreateDeviceRGB();
CGContextRef ctx = CGBitmapContextCreate( NULL, CGImageGetWidth(image),
        CGImageGetHeight(image), CGImageGetBitsPerComponent(image),
        CGImageGetBytesPerRow(image), space,
        kCGBitmapByteOrderDefault | kCGImageAlphaLast );
CGColorSpaceRelease( space );

// now draw the image into the context
CGRect rect = CGRectMake( 0, 0, CGImageGetWidth(image), CGImageGetHeight(image) );
CGContextDrawImage( ctx, rect, image );
UInt32 * pixels = CGBitmapContextGetData( ctx );

// now we can iterate through the data & read the alpha values
int i, count = CGBitmapContextGetBytesPerRow(ctx) * CGBitmapContextGetHeight(ctx);
for ( i = 0; i < count; i++ )
{
    UInt8 alpha = pixels[i] & 0x000000ff;
    // do with the alpha what you will
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T14:50:43.337

# c++ - 如何修改 CToolTipCtrl 的工具矩形？

> ID：867724
> 
> 赞同：3
> 
> 时间：2009-05-15T09:23:57.583
> 
> 标签：c++, tooltip, mfc-feature-pack

这个问题[与这个有关](https://stackoverflow.com/questions/269837/how-do-i-display-custom-tooltips-in-a-ctreectrl)。

在 CDockablePane 派生类中，我有一个 CTreeCtrl 成员，我在 OnCreate() 中为其添加了 ToolTip：

```
int CMyPane::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CDockablePane::OnCreate(lpCreateStruct) == -1)
        return -1;

    const DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN |
        TVS_CHECKBOXES | TVS_DISABLEDRAGDROP | TVS_HASBUTTONS | TVS_HASLINES | TVS_LINESATROOT |
        TVS_INFOTIP | TVS_NOHSCROLL | TVS_SHOWSELALWAYS;

    if(!m_tree.Create(dwStyle, m_treeRect, this, TREECTRL_ID) ) { return -1; }

    m_pToolTip->AddTool(&m_tree, LPSTR_TEXTCALLBACK, &m_treeRect, TREECTRL_ID);
    m_tree.SetToolTips(m_pToolTip);

    return 0;
} 
```

我必须使用所有可选参数调用 AddTool()，因为默认值不适用于 CDockablePane。
`m_treeRect`是 CTor 中的`CRect`成员集`(0, 0, 10000, 10000)`。这真的很丑。

`m_tree`每当的大小发生变化时，我想调整工具的矩形。
所以我尝试了一些东西，`CMyPane::OnSize()`但都没有奏效：

*   调用`m_pToolTip->GetToolInfo()`然后修改`CToolInfo`的 rect 成员，然后调用`SetToolInfo()`
*   打电话`m_pToolTip->SetToolRect()`

它是如何完成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-18T21:18:00.443

除了在您的处理程序中再次调用`DelTool`then之外，我没有其他方法可以做到这一点：`AddTool``OnSize`

```
void CMyPane::OnSize(UINT nType, int cx, int cy)
{
    CDockablePane::OnSize(nType, cx, cy);

    if (m_pToolTip != NULL)
    {
        m_pToolTip->DelTool(&m_tree, TREECTRL_ID);

        CRect treeRect;
        m_tree.GetClientRect(treeRect);

        m_pToolTip->AddTool(&m_tree, LPSTR_TEXTCALLBACK, &treeRect, TREECTRL_ID);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-07T11:35:43.627

```
int CMyPane::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CDockablePane::OnCreate(lpCreateStruct) == -1)
        return -1;

    const DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN |
        TVS_CHECKBOXES | TVS_DISABLEDRAGDROP | TVS_HASBUTTONS | TVS_HASLINES | TVS_LINESATROOT |
        TVS_INFOTIP | TVS_NOHSCROLL | TVS_SHOWSELALWAYS;

    if(!m_tree.Create(dwStyle, m_treeRect, this, TREECTRL_ID) ) { return -1; }

    m_pToolTip->AddTool(&m_tree, LPSTR_TEXTCALLBACK, &m_treeRect, TREECTRL_ID);
    m_tree.SetToolTips(m_pToolTip);

    return 0;
} 
```

# c - n = 0 和 n = n - n 之间的差异

> ID：867727
> 
> 赞同：3
> 
> 时间：2009-05-15T09:24:19.707
> 
> 标签：c, assembly, optimization, compiler-construction, micro-optimization

当我读到**[这个](https://stackoverflow.com/questions/867692/c-programming-difference-between-i-and-ii1-from-an-assembler-point-of-view)**问题时，我记得有人曾经（多年前）告诉我，从汇编程序的角度来看，这两个操作非常不同：

```
n = 0;

n = n - n; 
```

这是真的吗？如果是，为什么会这样？

**编辑：**正如一些回复所指出的，我想这对于编译器来说很容易优化成同样的东西。但我发现有趣的是，如果编译器有一个完全通用的方法，为什么它们会有所不同。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-15T09:31:31.653

编写你经常使用的汇编代码：

```
xor eax, eax 
```

代替

```
mov eax, 0 
```

那是因为第一条语句只有操作码，没有涉及的参数。您的 CPU 将在 1 个 cylce（而不是 2 个）内完成此操作。我认为您的情况类似（尽管使用 sub）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T09:31:24.463

编译器 VC++ 6.0，没有优化：

```
4:        n = 0;
0040102F   mov         dword ptr [ebp-4],0
5:
6:        n = n - n;
00401036   mov         eax,dword ptr [ebp-4]
00401039   sub         eax,dword ptr [ebp-4]
0040103C   mov         dword ptr [ebp-4],eax 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-15T09:27:49.353

优化编译器将为两者生成相同的汇编代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-15T09:42:11.083

在早期，内存和 CPU 周期很少。这导致了很多所谓的“窥视孔优化”。让我们看一下代码：

```
    移动.l #0,d0

    moveq.l #0,d0

    sub.l a0,a0

```

第一条指令需要两个字节作为操作码，然后是四个字节作为值 (0)。这意味着浪费了四个字节，而且您需要访问内存两次（一次用于操作码，一次用于数据）。慢。

`moveq.l`更好，因为它将数据合并到操作码中，但它只允许将 0 到 7 之间的值写入寄存器。而且您仅限于数据寄存器，没有快速清除地址寄存器的方法。您必须清除数据寄存器，然后将数据寄存器加载到地址寄存器中（两个操作码。不好。）。

这导致对任何寄存器起作用的最后一个操作，只需要两个字节，一个内存读取。翻译成C，你会得到

```
n = n - n; 
```

这适用于最常用的类型`n`（整数或指针）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-15T09:28:09.337

这可能取决于是否`n`声明为`volatile`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-15T09:59:12.507

通过从自身减去寄存器或与自身进行异或来清零寄存器的汇编语言技术是一种有趣的技术，但它并不能真正转化为 C。

如果有意义，任何优化的 C 编译器都会使用这种技术，并且尝试显式地写出它不太可能实现任何目标。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-12-28T09:10:50.130

**在 C 中，如果您的编译器很糟糕（或者您禁用了 MSVC 答案所示的优化**），它们只会有所不同（对于整数类型）。****

 **也许以这种方式告诉您的人试图描述一条 asm 指令，如`sub reg,reg`使用 C 语法，*而不是*谈论这样的语句如何用现代优化编译器*实际*编译？在这种情况下，我不会对大多数 x86 CPU 说“非常不同”；大多数*将*特殊情况`sub same,same`作为归零习语，例如`xor same,same`. **[在 x86 汇编中将寄存器设置为零的最佳方法是什么：xor、mov 或 and？](https://stackoverflow.com/questions/33666617/what-is-the-best-way-to-set-a-register-to-zero-in-x86-assembly-xor-mov-or-and/)**

这使得 asm`sub reg,reg`类似于`mov reg,0`，具有更好的代码大小。（但是，是的，英特尔 P6 系列上的部分寄存器重命名有一些独特的好处，您只能从归零习语中获得，而不是`mov`）。

* * *

如果您的编译器试图在ARM 或 PowerPC 之类的弱排序 ISA 上实现最不推荐使用的**语义**，它们在 C 中*可能会*有所不同，其中破坏了对旧值的依赖，但仍然“携带依赖”，所以像这样的负载在 之后进行依赖排序。有关更多详细信息，请参阅[C11 中的内存顺序消耗使用情况](https://stackoverflow.com/questions/55741148/memory-order-consume-usage-in-c11)**`memory_order_consume`**`<stdatomic.h>``n=0``n = n-n;``array[n]``n = atomic_load_explicit(&shared_var, memory_order_consume)`

在实践中，编译器放弃了尝试正确地进行依赖跟踪并将`consume`负载提升到`acquire`. [http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0371r1.html](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0371r1.html)什么[时候不应该使用[[carries_dependency]]？](https://stackoverflow.com/questions/20126983/when-should-you-not-use-carries-dependency)

但是在弱序 ISA 的 asm 中，`sub dst, same, same`仍然*需要*对输入寄存器进行依赖，就像在 C 中一样。（大多数弱序 ISA 是具有固定宽度指令的 RISC，因此避免立即操作数不会使机器代码更小。因此，`sub r1, r1, r1`即使在没有架构零寄存器的 ARM 等 ISA 上， 也没有使用更短的归零习惯用法。`mov r1, #0`大小相同，至少与任何其他方式一样有效。在 MIPS 上，您只需`move $v0, $zero`)

**所以是的，对于那些非 x86 ISA，它们在 asm 中非常不同**。 `n=0`避免对变量（寄存器）的旧值的任何错误依赖，同时在旧值准备好`n=n-n`之前无法执行。`n`

* * *

**只有 x86 的特殊情况 `sub same,same`和`xor same,same`像`mov eax, imm32`**, 因为`mov eax, 0`是 5 个字节但`xor eax,eax`只有 2 个字节这样的依赖关系破坏归零习惯用法。因此，在乱序执行 CPU 之前使用这种窥视孔优化的历史由来已久，这样的 CPU 需要运行现有代码有效。 [在 x86 汇编中将寄存器设置为零的最佳方法是什么：xor、mov 或 and？](https://stackoverflow.com/questions/33666617/what-is-the-best-way-to-set-a-register-to-zero-in-x86-assembly-xor-mov-or-and/)解释细节。

**除非您是在 x86 asm 中手动编写，否则请`0`像普通人一样编写而不是`n-n`or `n^n`，并让*编译器*使用 xor-zeroing 作为窥视孔优化。**

其他 ISA 的 Asm 可能有其他窥视孔，例如另一个答案提到 m68k。但同样，如果您使用 C 语言编写，这是编译器的工作。`0`当你的意思写`0`。尝试“手持”编译器使用 asm 窥视孔不太可能在禁用优化的情况下工作，并且在启用优化的情况下，如果需要，编译器将有效地将寄存器归零。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-15T09:39:22.680

不确定组装等，但一般来说，

```
n=0
n=n-n 
```

如果 n 是浮点数，则并不总是相等，请参见此处 [http://www.codinghorror.com/blog/archives/001266.html](http://www.codinghorror.com/blog/archives/001266.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-13T20:56:56.437

`n = 0`以下是一些极端情况，其中和的行为不同`n = n - n`：

*   如果`n`具有浮点类型，则结果将不同于`0`特定值：`-0.0`, `Infinity`, `-Infinity`, `NaN`...

*   if`n`定义为`volatile`：第一个表达式将生成一个存储到相应的内存位置，而第二个表达式将生成两个加载和一个存储，此外，如果`n`是硬件寄存器的位置，这两个加载可能会产生不同的值，导致写入存储非`0`值。

*   如果优化被禁用，编译器可能会为这两个表达式生成不同的代码，即使对于 plain `int n`，这可能会或可能不会以速度执行。

# .net - 使用 oracle（.Net 连接器）描述查询

> ID：867731
> 
> 赞同：2
> 
> 时间：2009-05-15T09:25:16.677
> 
> 标签：.net, oracle

我正在使用 Oracle Express Edition，我想在我的程序（.Net C#、Microsoft oracle 连接器）中以编程方式获取表信息（列名、类型、大小等）。

在 SqlPlus 中，当我发出命令“desc <tablename>”时，它可以完美运行并打印有关表的所有信息。

现在我想以编程方式进行。我试图给出查询“desc <tablename>”但它失败了。然后我在某处读到 desc 是一个存储过程，我们必须将它称为存储过程，然后我尝试了以下代码，它失败并出现错误，

代码 1

```
private OracleDataReader OracleDescribe(string tablename)
{
    OracleCommand cmd = new OracleCommand("describe " + tablename, OracleConn);
    return cmd.ExecuteReader();
} 
```

错误 1

```
Invalid SQL Statement 
```

代码 2

```
private OracleDataReader OracleDescribe(string tablename)
{
    OracleCommand cmd = new OracleCommand("describe", OracleConn);
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.Parameters.Add("table", OracleType.VarChar).Value = tablename;
    return cmd.ExecuteReader();
} 
```

错误 2

```
Encountered the symbol ">" when expecting one of the following: ( 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T10:02:04.670

对系统的元数据视图/表使用查询。例如：

```
SELECT TABLE_NAME, COLUMN_NAME, DATA_TYPE, DATA_LENGTH, 
       DATA_PRECISION, DATA_SCALE, NULLABLE, DATA_DEFAULT, CHAR_LENGTH 
FROM ALL_TAB_COLUMNS 
WHERE OWNER='SCOTT' AND TABLE_NAME IN ('EMP', 'DEPT') 
ORDER BY TABLE_NAME ASC, COLUMN_ID ASC 
```

You could also look into the GetSchema method on DbConnection, (if you're using .NET 2.0 or higher, recommended), and check the specific views defined in the MSDN.

# visual-studio-2008 - SSD 驱动器和 Visual Studio IDE。大改进？真实的使用故事，没有理论

> ID：867741
> 
> 赞同：92
> 
> 时间：2009-05-15T09:30:53.217
> 
> 标签：visual-studio-2008

我想使用 Windows 7 + Intel SSD 驱动器来加快我的 Visual Studio 2008 开发周期。

我想加快的领域是：

*   编译/构建时间
*   为 winforms/webforms 打开文件
*   适用于 Windows 和 Web 的通用 Visual Studio “迟缓”

我对 Visual Studio 的启动时间不感兴趣。每 GB 的成本也不是问题。我要速度。

有没有人尝试过这个（**SSD 驱动器 + Visual Studio**），你能说出加速/减速的什么？

我知道关于 SSD 的理论，但通常布丁的证据在于吃东西。因此，我对实际尝试并测试了带有 SSD 的 Visual Studio 设置的人感兴趣......

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-11-02T10:14:23.803

我有 Visual C# 2008**的硬数据。简短的版本是你最好把钱花在更快的 CPU 上而不是更快的 I/O**上。更长的答案如下...

我们的 C# (.NET 3.5) 解决方案包含 81 个项目，代码行数超过 200 万行（包括注释和空白行）。几年前，我们从配备标准 HDD 的 Pentium 4 3 GHz PC 升级到配备 10,000 RPM WD Raptor HDD (74 GB) 的 Core 2 Duo 2.6 GHz PC。加速是巨大的。大约 10 分钟到 3.5 分钟。所有这些都在具有 4 GB RAM 的 Windows XP Pro 32 位环境中进行。

我们还得到了一个 Gigabyte i-RAM（谷歌它的信息），它基本上是一个带有备用电池的 RAM 硬盘。与读取速度快但写入速度较慢的 SSD 不同，i-RAM 对两者都非常快，但如果您断电，则电池只能持续大约 12 小时，因此您必须遵守签到的规定。与 10,000 RPM Raptor HDD 相比，这将 Core 2 Dou 平台上的编译时间缩短了一分钟（减少到 2.5 分钟）。

从那以后，我发现那些旧的 74 GB 10,000 RPM Raptor 驱动器比您的花园品种 7,200 RPM 现代驱动器稍慢，我们已经证明了一致的基准测试编译。我们还没有尝试过新的 Velociraptors，但它们肯定会更快，但可能不足以仅用于编译时间。

**上周我们获得了一个新的英特尔酷睿 i7-870 平台，它带有一个 G.Skill Falcon 128 GB SSD（带有 Indilix Barefoot 控制器）和一个标准的 500 GB HDD 作为第二个驱动器。我还将 i-RAM 插入这台 PC 并测试了所有配置。**

**与 Core 2 Duo 的 HDD 编译时间为 3.5 分钟，i-RAM 的编译时间为 2.5 分钟相比，i7-870 的 SSD 编译时间为 1 分 40 秒，HDD 和 i-RAM 的编译时间为 3 秒。**

**因此，我们两次升级开发人员工作站时，C# 编译时间的绝大多数性能改进都来自更快的 CPU，而不是更快的磁盘。如果您想加快编译时间，请将您的资金投入 CPU 而不是磁盘。**

也就是说，SSD 加载 Visual Studio 和打开解决方案的速度要快得多（尽管我没有时间）。如果您买得起 SSD，您将永远不会回头，因为您 PC 上的每个程序加载速度都快得令人难以置信。但它不会显着加快你的编译速度。这就是 Visual Studio C# 是单线程的。如果微软能够齐心协力并在 IDE 中使用多线程编译器，那么我们实际上可以使用这四个内核......

* * *

**2012 年 5 月更新：**我们现在再次升级了我们的 PC，并基于我们在关注 CPU 性能之前所学到的知识。新款 PC 配备超频至 4.6 GHz 的 Intel Core i7-2600k CPU，配备 Intel 510 系列 120 GB SATA III SSD、16 GB RAM 和大型 CPU 散热器！令人惊讶的是，这几乎将编译时间*减半*，我当然将其归结为 CPU 马力的大幅增加，而不是更快的 SSD。

Visual Studio 2010 中的 C# 编译性能结果为：

*   159 秒：Intel Core i7-870 库存（2.9 - 3.3 GHz），4 GB RAM 和 SATA II SSD
*   109 秒：Intel Core i7-2600k 库存 (3.4 - 3.8 GHz) 16 GB RAM 和 SATA III SSD
*   84 秒：Intel Core i7-2600k 超频 (4.63 GHz) 16 GB RAM 和 SATA III SSD

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-02-20T18:57:22.413

我刚买了一个，唯一的遗憾就是没有早点买 SSD。

之前的编译时间还可以，但现在整个 IDE 的响应速度要快得多。它不仅是 Visual Studio，还包括其他应用程序。当整个系统运行得如此之快时，保持流畅就容易多了。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-12-03T01:04:48.777

作为测试，我们刚刚订购了一个基于 Sandforce 的 90 GB SSD，看看它是否可以帮助我们缩短构建时间。我们有一个大型 C++ 项目，需要 21 分钟才能在（较旧的 Xeon 3.4 GHz 机器上）进行完全重建。

每个运行三个测试，构建的时间差异可以忽略不计；大约快 30 秒。

我们较新的（！）Xeon 5150 机器（带硬盘）在大约 11 分钟内重建了相同的项目，这表明编译确实受 CPU 限制。

（这让我感到惊讶，因为我认为 SSD 出色的 4k 和 512k 读/写性能在构建中会非常有益。）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-08-02T14:33:26.843

经过长时间的性能测试，我在这里得到了最好的设置，但是对于 C++ 编译器。你会需要：

*   适用于 Windows 和*程序文件*的 SSD （通常是 C: 驱动器）
*   1 TB WD Caviar Black 分两个分区：
    *   驱动器 D：一个很小的（最大 35 GB），位于启动柱面，只有一个 TEMP 文件夹；您应该将您的 TMP 和 TEMP 环境变量映射到 D:\TEMP （这个非常重要！！！）
    *   驱动器 E：与驱动器存储的其余部分；将其用于一般数据存储，除了软件开发的东西
*   1 TB WD Caviar Black 在您想要存储 Visual Studio 2008 项目/解决方案的任何分区布局中。根据 Subversion 的使用情况，我最终得到了四个分区：
    *   820 GB 用于主干和通用项目
    *   60 GB 用于“功能分支”
    *   60 GB 用于产品稳定期间使用的“稳定分支”
    *   60 GB 用于“产品质量分支”，用于对已批准软件进行小修复
*   6 核或 8 核处理器，使用 /MP 编译器开关，（不要与 Visual Studio 2008 原生的“并行项目构建”功能混淆——我不知道为什么 AMD Phenon II 处理器与这个组合）
*   Windows 7 64 位（我不确定为什么它在 64 位操作系统中运行得更快，即使使用 32 位编译器也是如此）
*   SATA 3 兼容主板

此设置优于我测试过的任何其他组合。

一个巨大的模块化项目的典型编译将有以下结果：

*   没有 /MP 和常规 HDD 的并行构建：大约 12:00 分钟
*   建议的设置：4:30 分钟
*   此设置，但交替使用 WD Caviar Green 驱动器：每个驱动器 +1:00（两者均为 5:30 或 6:30）
*   将 TEMP 分区移动到 RAMDRIVE：5:30

我的结论如下：

*   不要让 TEMP 文件夹在 SSD 中运行，因为它们是糟糕的“作者”，并且在 WD Caviar Black 中没有可比的 64 MB 缓存
*   使用专用驱动器作为 TEMP 可以让两个 WD 驱动器并行工作：用于 cl.exe 临时文件的 TEMP 和用于存储 *.cpp/h、*.obj、*.lib、*.exe 等的项目驱动器。
*   WD Caviar Black 缓存算法令人印象深刻，结合 SATA 6 GB/s，优于我为 TEMP 驱动器测试过的 RAMDRIVE 设置
*   分区减少了对编译器环境中不可避免的碎片的影响；这同样适用于 TEMP 驱动器

我希望我能帮助你。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-15T10:22:21.423

请参阅 Joel Spolsky 的文章*[固态磁盘](http://www.joelonsoftware.com/items/2009/03/27.html)*(2009-03-27)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-05-20T03:03:44.537

我刚刚通过克隆原始的 5400 RPM 硬盘驱动器将笔记本电脑升级到 SSD（令人惊讶的是一个无痛的过程）。我使用秒表来捕捉指标之前和之后的数据。（戴尔 Inspiron 灵越 1525、3 GB RAM、Windows Vista 32 位）

## Windows的启动/启动

**63 秒 --> 52 秒**

## 加载我的 ASP.NET Visual Studio 解决方案

换句话说，从单击 .sln 文件到 Visual Studio 完全加载并可以开始编码的时间。我在进行测量之前执行了一次此操作，因为第一次总是比后续时间花费更长的时间。

**16 秒 --> 8 秒。**

## 调试

`F5`到主页完全加载。

**5 秒 --> 3.5 秒**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-02-05T09:17:54.440

当我买了一台新电脑时，我不确定是什么让我的体验更快。

但是，我的一位同事将 7200 RPM 硬盘驱动器更换为 SSD。Visual Studio（尤其是启动/调试 ASP.NET）的速度至少快**了两倍**！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-15T10:25:18.873

我也一直在考虑这个问题，不久前我买了一张快速的[SD 卡](http://en.wikipedia.org/wiki/Secure_Digital)，我可以把它插在笔记本电脑上而忘记它，这样 Windows Vista 就可以使用[ReadyBoost](http://en.wikipedia.org/wiki/ReadyBoost)功能。感觉就像它有所作为，但仅仅为此购买 SSD 驱动器肯定是不够的。

[然后我在进行Subversion](http://en.wikipedia.org/wiki/Apache_Subversion)更新时开始遇到问题，并决定放弃 ReadyBoost 的想法，并将 SD 驱动器安装在我创建所有项目文件的安装点上。SD 卡不是很大（1 GB），但它确实减少了我等待构建的时间，并使调试更快。

其中大部分是主观的，我正在回答一个需要事实的问题，“我觉得这个”和“我觉得那个”。由于我尝试从不同的驱动器运行 Visual Studio 文件，我当然相信它会有所作为，我愿意为此付出多少，以及我愿意为此付出多少，这是我也在热切寻找答案的问题。我的笔记本电脑可以使用另一个硬盘驱动器，但我无法在 SDD 和 7200 RPM 笔记本电脑驱动器之间做出决定。

# asp.net - 循环通过控件

> ID：867746
> 
> 赞同：4
> 
> 时间：2009-05-15T09:32:52.320
> 
> 标签：asp.net, controls, c#-2.0

在我的代码中，我需要遍历 GroupBox 中的控件，并且仅当它是 ComboBox 时才处理控件。我正在使用代码：

```
foreach (System.Windows.Forms.Control grpbxChild in this.gpbx.Controls)
{
    if (grpbxChild.GetType().Name.Trim() == "ComboBox")
    {
        // Process here
    }
} 
```

我的问题是：可以只从 GroupBox 中获取组合框，而不是遍历所有控件并仅处理组合框？像这样的东西：

```
foreach (System.Windows.Forms.Control grpbxChild in this.gpbx.Controls.GetControlsOfType(ComboBox))
{
    // Process here
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T09:37:38.580

由于您使用的是 C# 2.0，因此您非常不走运。你可以自己写一个函数。在 C# 3.0 中，您只需执行以下操作：

```
foreach (var control in groupBox.Controls.OfType<ComboBox>())
{
    // ...
} 
```

C# 2.0 解决方案：

```
public static IEnumerable<T> GetControlsOfType<T>(ControlCollection controls)
    where T : Control
{
    foreach(Control c in controls)
        if (c is T)
            yield return (T)c;
} 
```

你会使用它：

```
foreach (ComboBox c in GetControlsOfType<ComboBox>(groupBox.Controls))
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T09:42:35.497

Mehrdad 非常正确，但是您的语法（即使您使用的是 C# 2.0）过于复杂。

我发现这更简单：

```
foreach (Control c in gpBx.Controls) 
{ 
  if (c is ComboBox) 
  { 
    // Do something.
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T09:38:41.077

```
if (!(grpbxChild is System.Windows.Forms.Combobox)) continue;

// do your processing goes here
grpbxChild.Text += " is GroupBox child"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T11:28:46.817

```
foreach (System.Windows.Forms.Control grpbxChild in this.gpbx.Controls)
{
    if (grpbxChild is ComboBox)
    {
        // Process here
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T10:04:03.560

```
foreach (Control items in this.Controls.OfType<GroupBox>())
{
    foreach (ComboBox item in items.Controls.OfType<ComboBox>())
    {
        // your processing goes here
    }
} 
```

# java - SSL 和 SocketChannel

> ID：867751
> 
> 赞同：13
> 
> 时间：2009-05-15T09:34:45.063
> 
> 标签：java, ssl, nio, socketchannel, sslengine

理想情况下，我只需要一个简单的`SSLSocketChannel`.

我已经有一个组件可以通过普通方式读取和写入消息`SocketChannel`，但是对于其中一些连接，我必须通过网络使用 SSL；但是，对这些连接的操作是相同的。

有谁知道免费的`SSLSocketChannel`实现（使用适当的选择器）或类似的东西？我找到[了这个](http://docs.norther.org/api/tammi/org/norther/tammi/acorn/nio/SSLSocketChannel.html)，但是选择器不接受它，因为它的供应商不是 SUN。

我正在通过一个简单的对象将 read_from/writing_to 网络逻辑与网络数据的插入和检索解耦，以便在`SSLEngine`不生气的情况下使用 a ，但考虑到我不知道的事实，正确实现它真的很棘手SSL协议的内部...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T18:23:14.060

Jetty 为其服务器提供了 NIO SSL 实现：[SslSelectorChannelConnector](http://www.mortbay.org/jetty/jetty-6/xref/org/mortbay/jetty/security/SslSelectChannelConnector.html)。您可能想查看它以了解其功能的详细信息。

还有一篇来自[O'Reilly](http://www.onjava.com/pub/a/onjava/2004/11/03/ssl-nio.html?page=last&x-order=date)的旧文章（但不错），它解释了有关 NIO + SSL 的详细信息以及示例代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-21T19:20:46.290

[TLS Channel](https://github.com/marianobarrios/tls-channel)是一个简单的库，可以做到这一点：包装 SSLContext（或 SSLEngine）并公开 ByteChannel 接口，在内部完成繁重的工作。

（免责声明：我是图书馆的主要作者）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T12:39:03.520

不确定这是否是您要查找的内容，但可能会有所帮助...要创建启用 SSL/TLS 的服务器套接字，我目前正在使用如下代码（keystore.jks 包含使用的自签名私钥/公钥对用于保护确认）- 客户端有一个类似的信任库，其中包含带有该对公钥的签名证书。

围绕配置进行一些谷歌搜索应该会让你开始。

```
String keyStorePath = "keystore.jks";
String keyStorePassword = "password";

KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
KeyStore keyStore = new KeyStore();
keyStore.load(new FileInputStream(keyStorePath), keyStorePassword);
keyManagerFactory.init(keyStore, keyStorePassword.toCharArray());

sslContext = SSLContext.getInstance("TLS");
sslContext.init(keyManagerFactory.getKeyManagers(), null, new SecureRandom());

SSLContext sslContext = getServerSSLContext(namespace.getUuid());
SSLServerSocketFactory serverSocketFactory = sslContext.getServerSocketFactory();

// Create sockets as necessary 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T23:18:43.103

查看 Restlet 的实现，它可以满足您的需求，而这一切都与 NIO 有关。

[Restlet 引擎 Javadoc](http://www.restlet.org/documentation/1.2/engine/)

特别是 HttpClientCall。SetProtocol(HTTPS) - getResponseEntityChannel 返回一个 ReadableByteChannel（getEntityChannel 返回一个 WriteableByteChannel）

# c# - 我如何使用数据集进行细化

> ID：867754
> 
> 赞同：0
> 
> 时间：2009-05-15T09:35:56.790
> 
> 标签：c#, sql-server-2000

如何进行数据集过滤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T09:40:55.203

如果您正在谈论过滤数据集表行：

```
myDataSet.DefaultViewManager.DataViewSettings["myTableName"].RowFilter = "ID = 3"; 
```

# c# - 从 SQL Server 检索图像以在 ASP.NET 应用程序中显示它

> ID：867756
> 
> 赞同：0
> 
> 时间：2009-05-15T09:36:25.060
> 
> 标签：c#, asp.net, silverlight-2.0

我想从 SQL Server 检索图像以在 ASP.NET 应用程序中显示它。我认为我可以将从 SQL Server 检索到的图像写到服务器的文件夹中，并显示它抛出它的路径。还有其他更好的方法吗？

我对音频和视频文件也有同样的问题（我可以使用 silverlight 播放这些音频和视频文件吗？）

我担心的是我不想将这些文件（图像、音频和视频）存储在服务器上以显示它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T09:51:02.730

您可以编写一个自定义 HTTP 处理程序，该处理程序将获取您尝试在查询字符串参数上显示的项目的 ID。

然后，此处理程序将从 SQL Server 检索数据，并像下载文件一样返回它。这个[帖子](http://www.clariusconsulting.net/blogs/kzu/archive/2003/08/27/74.aspx)有步骤。

我不确定 Silverlight 从“文件”流式传输的能力，您可能需要使用[Silverlight Streaming Service](http://silverlight.live.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T09:39:58.933

有没有更好的办法？恕我直言，是的。将图像文件存储为文件。这就是文件系统的用途，并且您不会参与到数据库中。

过去，我使用 MySQL 存储图像并使用 PHP 检索它们，但从维护的角度来看，该解决方案很快就变得非常陈旧。归根结底，您总是必须以某种方式存储数据，而最有效的方式也是最简单的方式。

如果您*必须*将它存储在数据库中，我会使用通用访问器页面（例如 myImage.aspx），它查询数据库并将返回的 blob 直接流式传输到浏览器。您的 img 标签可能需要看起来像

```
<img src="/img/myImage.aspx?imgId=123456" <other tag data> /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T09:41:44.610

如果您使用 SQL Server 2008，那么我相信您可以将这些对象存储为 FILESTREAM，然后您可以检索文件系统上文件的路径。您应该能够安排通过 IIS 映射该路径，因此将其转换为 URL 应该是可行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T12:28:01.043

您的图像源可以是

```
<img src="blah.aspx?id=123" /> 
```

在 blah.aspx 中，从数据库中检索图像数据并使用 Response.BinaryWrite 发送到浏览器，并设置适当的内容类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-16T06:29:31.930

大家好，我想解决方案在以下链接中：

[http://www.codeproject.com/KB/aspnet/asp_net_and_mysql.aspx](http://www.codeproject.com/KB/aspnet/asp_net_and_mysql.aspx)

[http://www.codeproject.com/KB/aspnet/image_asp.aspx](http://www.codeproject.com/KB/aspnet/image_asp.aspx)

此解决方案适用于 mysql 数据库，也可以适当修改以与 mssql 数据库一起使用。

# oracle - Schema 的用户限制

> ID：867757
> 
> 赞同：0
> 
> 时间：2009-05-15T09:36:44.183
> 
> 标签：oracle

在 Oracle 9i 和 10g 数据库中，我的应用程序显示此类错误。“源数据库连接可以访问多个模式。限制用户对所需模式的访问。”。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T13:40:03.367

在我看来，这听起来像是来自您的应用程序（或其用于连接到 Oracle 的工具）的消息，而不是来自 Oracle 本身的消息。

# vba - 在 Excel 中以编程方式设置“选择对象”光标

> ID：867758
> 
> 赞同：3
> 
> 时间：2009-05-15T09:37:25.807
> 
> 标签：vba, excel, cursor

我正在努力找出如何以编程方式启用“选择对象”光标类型。我检查了对象浏览器并希望找到类似`Application.CursorType`or的属性`Application.DrawingMode`。

在宏记录器中没有选择更改光标类型，我必须搜索错误的术语，因为我无法在任何地方找到有关此的信息。

**编辑：**我应该明确表示我不是在谈论可以通过设置的光标外观`Application.Cursor`。相反，我想通过单击绘图工具栏上的“选择对象”图标将光标设置为可以通过 GUI 设置的相同模式。这是只允许选择形状并忽略单元格、文本和编辑栏的光标。

实际上，在我检查工具提示以编写此更新之前，我从来不知道此光标模式的正确名称，也许这会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T00:01:19.620

我不太明白你为什么要这样做，但你可以通过执行内置的 CommandBar 控件以编程方式切换“选择对象”绘图模式：

```
Call CommandBars("Drawing").Controls("Select Objects").Execute 
```

您可以通过检查其状态来确定当前模式：

```
If CommandBars("Drawing").Controls("Select Objects").State Then
  Call Debug.Print("Select Object mode is on")
End If 
```

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-08T16:09:37.447

我在这个问题上有点“迟到”，但这里是“他为什么要这样做”以及“他想做什么”的答案。

```
'Turn ON 'Select Objects' option during initial display. While ON, cell input is prevented.
If CommandBars("Drawing").Controls("Select Objects").State = False Then
    CommandBars("Drawing").Controls("Select Objects").Execute
End If 
```

我在一个简单的计时器应用程序中使用它，该应用程序在“ActiveSheet”显示屏上有一个命令按钮和两个复选框。通过打开“选择对象”，我将光标输入目标限制为这三个项目。无法选择单元格。

干杯，劳伦斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T10:01:02.300

这个[链接会有](http://www.your-save-time-and-improve-quality-technologies-online-resource.com/vba-change-cursor.html)帮助吗？

这是一个概要：

在应用程序中，您有四个选择：

*   xl默认
*   xl等待
*   xlBeam
*   xl西北箭头

你这样称呼它：

```
Application.Cursor = xlDefault 
```

通过表格，您有更多选择。有关更多信息，请参阅文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T10:01:03.377

我不知道您所说的“绘图模式”是什么意思。但是，如果您想更改鼠标光标的外观，您正在寻找的属性是`Application.Cursor`

您可以将其设置为四个预定义值之一：`xlWait, xlNorthwestArrow, xlIBeam`和`xlDefault`。

如果要显示其他光标，请查看[这篇文章](http://www.vbaexpress.com/kb/getarticle.php?kb_id=929)，了解如何在 Access 中显示自定义光标。由于它使用 WinAPI，因此该解决方案应该在 Excel 中同样有效。

**编辑：**

回应您的编辑：我认为不可能做您想做的事。宏记录器没有拾取它，因为没有 VBA 命令可以做到这一点。根据您通过切换到设计模式来尝试实现的目标，可能还有其他方法。

如果要阻止用户更改工作簿中的数据，可以使用该`Application.Visible`属性隐藏完整的 Excel 窗口。

如果您想阻止用户选择或更改任何内容，但仍显示数据，请查看`ActiveSheet.Protect`或`ActiveWorkbook.Protect`，在*Tools - Protection*下可用。

如果要移动工作簿中的某些控件或调整其大小，可以通过更改控件的 、 和 属性以编程方式执行`Left`此操作`Top`，无需切换到设计模式即可从宏中执行此操作。`Height``Width`

# linux - Access 有什么替代品吗？

> ID：867760
> 
> 赞同：6
> 
> 时间：2009-05-15T09:37:49.547
> 
> 标签：linux, ms-access, open-source

我是一名程序员，我父亲使用Access收集患者信息（我父亲是一名医生），

他要我教他如何使用它。

我不喜欢 Access（我是一个 linux 人），而且我找不到任何替代品。大家知道吗？（它一定很容易让我父亲使用）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-15T09:47:41.833

也许您需要对此更加务实。

我也不是 Access 的粉丝，但如果你父亲已经理解它并且他已经有了系统，你需要问一个问题，为什么要改变？如果它没有损坏，请不要尝试修复它。

您可能会发现，对现有系统进行一些简单的更改即可为您父亲提供所需的一切，这将为您节省大量时间，并且意味着您无需重新培训您的父亲。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-15T09:42:34.717

[OpenOffice-Base](http://www.openoffice.org/)怎么样？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-15T09:48:17.837

你父亲想让你教他如何使用访问，但你是一个 linux 人，不喜欢访问。访问不是这里的问题 我认为你和你父亲不适合这个。

让其他人教他如何使用 Access

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-15T10:13:16.267

访问并不总是它被制造出来的怪物。任何应用程序或语言中编码不佳的数据库都是编码不佳的数据库。Access 在关键时刻占据市场主导地位导致更多人遇到设计不良的数据库的比例更高。Access 用户和程序员也有大量的支持。我特别喜欢[访问世界论坛](http://www.access-programmers.co.uk/forums/index.php)。正如[ilivewithian 所说](https://stackoverflow.com/questions/867760/is-there-any-replacement-of-access/867793#867793)，如果你不乐意告诉他，请让其他人告诉他。

但是，如果您热衷于担任您父亲的导师（并且我可以看到吸引力 - 也许有机会回馈一些东西），那么我建议您使用基于 Web 的数据库界面。与[Oli](https://stackoverflow.com/questions/867760/is-there-any-replacement-of-access/867783#867783)不同，我没有使用 Django 的经验，但我会推荐[Dabble](http://dabbledb.com/)或[blist](http://www.blist.com/)。（Blist 尤其擅长处理图像，Dabble 更擅长灵活的报告格式，尽管两者都不如 Access，恕我直言）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T09:43:21.720

我认为 Access 的自然继承者是一个简单的 Web 界面数据库系统。

它们很简单，可以以十亿种不同的方式创建，但我会认真建议尝试 Django（因为在这种情况下，您会发现它的管理区域为您完成了 90% 的实际工作）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-21T23:36:44.117

[FileMaker](http://www.filemaker.com/) Inc. 是 Apple 的子公司。它可以在 Mac OS X 和 Windows 上运行（而 MS Access 只能在 Windows 上运行）。许多人声称 FileMaker 比 MS Access 更易于使用。听起来 FileMaker 可能是您的完美解决方案！（虽然我同意[ilivewithian](https://stackoverflow.com/questions/867760/is-there-any-replacement-of-access/867793#867793)）

[在OpenOffice](http://www.openoffice.org/) / [StarOffice](http://www.staroffice.org/get.html)中还有 Sun 对应的 MS Access，称为[BASE](http://www.openoffice.org/product/base.html)（有人已经提到过），它也是跨平台兼容的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T20:58:58.303

与其开发自己的记录保存应用程序，不如从众多医疗记录系统供应商之一购买已经开发的系统。他将获得更好的应用程序，并拥有可以寻求支持的人。此外，还有关于医疗记录存储和访问的所有法律问题。供应商已经解决了这些问题。

话虽如此，还有许多其他基于文件的数据库系统：[http ://www.google.com/search?q=file+based+database](http://www.google.com/search?q=file+based+database)

我没有用过任何一个，所以我无法推荐。

当然，还有各种企业数据库（Oracle、MySQL、SQL Server 等）。在这些 SQL Server 中，对于新手来说可能是最容易学习的。由于没有 64 位版本的 Access，我开始看到人们将 Access 替换为 SQL Server Express（免费！）用于需要在 64 位窗口上运行的小型应用程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-25T09:02:36.923

如果使用 Access 作为数据库前端并使用 VBA（Visual Basic fro Applications）编程，[Gambas是 Access 的一个非常好的替代方案。](http://gambas.sourceforge.net/en/main.html)可以重用为 Access 编写的大量代码并轻松创建表单和报告。

所以对于想要在 Linux 下使用自己的知识的 VB 或 VBA 程序员来说，Gambas 是一个很好的解决方案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-19T23:56:12.283

我现在在一个拥有多个项目的多语言组织中使用 Viravis 超过 6 个月，我觉得它非常好。它不仅易于构建（我是初学者），而且它们也提供了非常好的支持！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-15T09:41:28.777

没有第一手经验，但您可以尝试 OpenOffic.org 数据库。或者，您可以教您的父亲使用 MySQL GUI 工具。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-20T22:39:53.987

[Viravis](http://www.viravis.com "在线数据库应用平台")可能是访问数据库的在线替代品。你最好检查一下它是否符合你的需要。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-15T20:46:35.137

对于大多数人来说，获取数据库结构是最困难的部分。创建一个简单的表单或报告也不是那么难。就用户而言（数据输入、报告等）可能比大多数应用程序更容易。您还拥有所有的搜索和排序功能；为什么要重新发明轮子？

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-05-15T09:41:27.450

对于 Windows 和简单数据，我会使用 Excel，所以我认为 Open Office 应该没问题。除非你父亲有医院，否则它可能会适合......或者你可以做一些编程，使用像 Firebird 这样的嵌入式数据库，然后自己写一些东西，比如说 - 用 Ja​​va？

# performance - 是否有任何时间跟踪 Web 应用程序？

> ID：867763
> 
> 赞同：0
> 
> 时间：2009-05-15T09:39:02.073
> 
> 标签：performance, monitoring

是否有任何时间跟踪 Web 应用程序？

我想用它作为监控我的程序生产力的工具。（我的意思是，我在一个项目上花费了多少小时）

编辑：我曾经注意到有一个（比如带有时间跟踪的网络推特），但我忘记了它的名字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T10:25:33.070

另一方面，如果您的问题是关于测量 Web 应用程序的响应时间，那么除了 Firebug 之外，还有其他代理记录器：SST Trace Plus 和 Fiddler 浮现在脑海中。Fiddler 是开源的，您可以为其编写插件。

如果您对测量响应时间很认真，那么您希望在非常高的负载下进行测量，以找到系统/应用程序的断点。没有好的免费工具，大多数人使用 HP 的 LoadRunner（用于大型功能测试）或 Spirent 的 Avalanche（用于非常高的负载）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T10:01:16.810

如果您追求的是个人时间跟踪，请查看[Kimai](http://www.kimai.de/index.php?article_id=8&clang=1)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T09:55:45.543

您是指用于监控您作为开发人员的时间的工具，还是用于监控程序响应速度的工具？

如果您想跟踪自己的时间，请尝试大本营（[http://www.basecamphq.com/](http://www.basecamphq.com/)）

如果您想监控应用程序的性能，那么@RichieHindle 的建议（Firebug；现在已删除答案）是一个很好的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:04:50.407

[http://www.rescuetime.com/](http://www.rescuetime.com/)

救援时间独奏？

# php - 我应该使用 \r 或 \n 在 PHP 中对文件的内容进行爆炸（）处理吗？

> ID：867776
> 
> 赞同：1
> 
> 时间：2009-05-15T09:42:17.290
> 
> 标签：php, string, explode

我正在创建一个函数，它可以接受一个字符串，该字符串要么通过`file_get_contents()`本地文本文件检索，要么从`http://site.com/338383.txt`.

该文件将是一个制表符分隔的文件，文件中的每个项目都在其自己的行上。使用`\n`或`\r`使用`explode()`字符串并获取每行的数组更好吗？

我注意到在某些情况下`\n`不起作用。我想要一种始终有效的一致方式。有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T09:49:07.133

您可以使用[file()](http://uk.php.net/manual/en/function.file.php)将文件的内容作为具有单独行的数组获取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T09:57:39.237

正如[duckyflip](https://stackoverflow.com/users/7370/duckyflip)指出的那样，您可以使用[file()](http://uk.php.net/manual/en/function.file.php)函数来获取文件行数组。但是，如果您仍然需要爆炸（出于未知原因），您应该使用 PHP 常量`PHP_EOL`而不是 '\n'，因为这是跨平台兼容的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T10:03:02.700

问题是对于不同的“文本/纯文本”编码和平台，[换行符](http://en.wikipedia.org/wiki/Crlf)的定义不同。快速而肮脏的解决方案可能是使用 split 和正则表达式“\r\n|\r|\n”，但是，它可能会在某些 unicode 文件上中断并且它没有“上下文”意义。即，如果您有一个文件，其中 LF (\n) 用作 EOL 标记，并且那里有一些应该保留的 CR，那么这些 CR 也将被拆分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T09:54:53.283

您可以使用[preg_split ()](http://php.net/preg-split)按 /\n\r|\n|\r/ 分解，然后[trim ()](http://php.net/trim)每个项目以确保没有剩余的尾随空格（如果合适的话）。

# mysql - 为什么我会收到“此版本的 MySQL 尚不支持 '...'”错误？

> ID：867782
> 
> 赞同：5
> 
> 时间：2009-05-15T09:43:05.400
> 
> 标签：mysql, sql, mysql-error-1235

我有如下查询：

```
delimiter $$
DROP TRIGGER IF EXISTS TR_SCIN_BANK_UPD$$
CREATE TRIGGER TR_SCIN_BANK_UPD
AFTER UPDATE ON SCIN_BANK
FOR EACH ROW
BEGIN
  IF OLD.BANK_NAME != NEW.BANK_NAME THEN
    INSERT into SCIN_BANK_LOG SET BANK_ID=OLD.BANK_ID, BANK_NAME=OLD.BANK_NAME, LAST_UPD_USER_ID=OLD.LAST_UPD_USER_ID, LAST_UPD_TS=now();
  END IF;
  IF OLD.BANK_DESC != NEW.BANK_DESC THEN
    INSERT into SCIN_BANK_LOG SET BANK_ID=OLD.BANK_ID, BANK_DESC=OLD.BANK_DESC, LAST_UPD_USER_ID=OLD.LAST_UPD_USER_ID, LAST_UPD_TS=now();
  END IF;
END$$ 
```

执行时我得到

> 此版本的 MySQL 尚不支持“一个表具有相同操作时间和事件的多个触发器”

这个错误任何人都可以为此提供解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T10:29:34.353

我猜该表上已经有一个`AFTER UPDATE`触发器，但它没有命名`TR_SCIN_BANK_UPD`，这意味着您的`DROP TRIGGER IF EXISTS`行什么都不做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-23T06:47:30.270

将 Mysql 升级到 5.6.27 版本为我解决了这个问题：

服务器版本：5.6.27-0ubuntu0.14.04.1（Ubuntu）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T13:59:48.877

是的，如果您同时使用具有不同触发器名称的相同事件，mysql 不支持此功能。

更好，为此你应该在这里使用 if 条件：如下所示：

```
delimiter $$
create trigger trigger_name
AFTER insert
on t1
for each row
begin
  if new.col1 like '%Sabcd%'
  then
    update t2 inner join t3 on t2.col1=t1.col1
    set t2.col2=0 ;
  end if;
  if new.col1 like '%dcba%'
  then
    update t2 inner join t3 on t2.col1=t1.col1
    set t2.col2=02;
  end if;
end;
$$ 
```

# c# - 如何减轻在 C# 中初始化列表字典的痛苦？

> ID：867785
> 
> 赞同：5
> 
> 时间：2009-05-15T09:44:07.397
> 
> 标签：c#, .net, .net-3.5, collections

我碰巧经常使用这种结构：

```
Dictionary<string, List<string>> Foo = new Dictionary<string, List<string>>(); 
```

这导致了这种代码：

```
foreach (DataRow dr in ds.Tables[0].Rows)
{
    List<string> bar;
    if (!Foo.TryGetValue(dr["Key"].ToString(), out desks))
    {
        bar= new List<string>();
        Foo.Add(dr["Key"].ToString(), bar);
    }
    bar.Add(dr["Value"].ToString());
} 
```

你认为值得编写一个自定义 DictionaryOfList 类来自动处理这种事情吗？

还有其他方法可以懒惰地初始化这些列表吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T09:46:10.213

您可以编写扩展方法 - GetValueOrCreateDefault() 或类似的东西：

```
foreach (DataRow dr in ds.Tables[0].Rows)
{
    Foo.GetValueOrCreateDefault( dr["Key"] ).Add( dr["Value"].ToString() )
} 
```

也许您甚至可以为整个初始化编写扩展方法？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T10:20:48.353

一个列表的字典......在 .NET 3.5 中，这将是一个`ILookup<TKey,TValue>`. 默认实现 ( ) 是不可变的，但我为[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)`Lookup<TKey,TValue>`编写了一个。这将更简单使用 - 即`EditableLookup<TKey,TValue>`

```
var data = new EditableLookup<string, int>();
data.Add("abc",123);
data.Add("def",456);
data.Add("abc",789);

foreach(int i in data["abc"]) {
    Console.WriteLine(i); // 123 & 789
} 
```

除此之外，扩展方法：

```
public static void Add<TKey, TList, TValue>(
    this IDictionary<TKey, TList> lookup,
    TKey key, TValue value)
    where TList : class, ICollection<TValue>, new()
{
    TList list;
    if (!lookup.TryGetValue(key, out list))
    {
        lookup.Add(key, list = new TList());
    }
    list.Add(value);
}

static void Main() {
    var data = new Dictionary<string, List<string>>();
    data.Add("abc", "def");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T09:46:17.967

我认为以下应该做：

```
class DictionaryOfList : Dictionary<string, List<string>> {} 
```

*   编辑我应该更正确地阅读。这没有回答问题。Tanascius 提供了一种巧妙的方法来解决它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T11:00:36.480

添加对 System.Data.DataSetExtensions 的引用，您可以使用 Linq 扩展：

```
var dictOfLst = ds.Tables[0].Rows.
    //group by the key field
    GroupBy( dr => dr.Field<string>("key") ).
    ToDictionary(
        grp => grp.Key,
        //convert the collection of rows into values
        grp => grp.Select( dr => dr.Field<string>("value") ).ToList() ); 
```

我不确定我是否会打扰另一个类，但是实用程序或扩展方法可以使这更简单：

```
public static Dictionary<TKey, List<TValue>> ToGroupedDictionary<TKey, List<TValue>>(
    this DataTable input, 
    Func<TKey, DataRow> keyConverter, 
    Func<TValue, DataRow> valueConverter )
{
    return input.Rows.
        //group by the key field
        GroupBy( keyConverter ).
        ToDictionary(
            grp => grp.Key,
            //convert the collection of rows into values
            grp => grp.Select( valueConverter ).ToList() );
}

//now you have a simpler syntax
var dictOfLst = ds.Tables[0].ToGroupedDictionary(
    dr => dr.Field<string>("key"),
    dr => dr.Field<string>("value") ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T11:29:40.300

不要忘记[using 指令](http://msdn.microsoft.com/en-us/library/sf0df423.aspx)。

这不是直接响应的，但无论如何可能会有所帮助。泛型集合类型的“使用别名”可能会使您的代码更容易阅读。

```
using StoreBox = System.Collections.Generic.Dictionary<string, System.Collections.Generic.List<string>>; 
using ListOfStrings = System.Collections.Generic.List<string>; 
class Program
{
    static void Main(string[] args)
    {
      var b = new StoreBox ();
      b.Add("Red", new ListOfStrings {"Rosso", "red" });
      b.Add("Green", new ListOfStrings {"Verde", "green" });
    }
} 
```

[这个提示归功于SO](https://stackoverflow.com/questions/9033/hidden-features-of-c/74482#74482)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T20:50:36.583

为什么不简单一点：

```
foreach (DataRow dr in ds.Tables[0].Rows)
{
   string key = dr["Key"].ToString();
   if (!Foo.ContainsKey(key)) Foo.Add(key, new List<string>());
   Foo[key].Add(dr["Value"].ToString());
} 
```

# apache-flex - 编译 Flex 应用程序而不进行调试？flex 编译器的优化选项？

> ID：867788
> 
> 赞同：4
> 
> 时间：2009-05-15T09:46:13.427
> 
> 标签：apache-flex, optimization, debugging, compilation, trace

我使用以下代码创建了一个简单的测试应用程序

```
var i : int;
for (i=0; i<3000000; i++){
   trace(i);
} 
```

当我运行应用程序时，加载速度很慢，这意味着“跟踪”正在运行。我通过右键单击检查 Flash 播放器，调试器选项未启用。

所以我想知道是否有一个选项可以在编译器中排除跟踪。否则，我必须手动删除程序中的所有跟踪。

是否有任何其他编译器选项可以最大限度地优化 flex 应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-20T11:17:59.903

Flex 中内置了一个非常棒的功能，称为日志记录 API（您可以在此处阅读有关它的更多信息[http://livedocs.adobe.com/flex/3/html/logging_09.html](http://livedocs.adobe.com/flex/3/html/logging_09.html)）。

基本上，您以不同的方式记录（跟踪）事物，诚然，其代码比标准跟踪略多，但它使您具有更大的灵活性。这是一个例子：

```
import mx.logging.Log;
Log.getLogger("com.edibleCode.logDemo").info("This is some info");
Log.getLogger("com.edibleCode.logDemo").error("This is an error"); 
```

然后您需要做的就是在您的主应用程序文件中创建一个跟踪目标，例如：

```
<mx:TraceTarget id="logTarget" fieldSeparator=" - " includeCategory="true" includeLevel="true" includeTime="true">

            <mx:filters>
                <mx:Array>
                    <mx:String>*</mx:String>
                </mx:Array>
            </mx:filters>

            <!--
            0 = ALL, 2 = DEBUG, 4 = INFO, 6 = WARN, 8 = ERROR, 1000 = FATAL
            -->
            <mx:level>0</mx:level>

    </mx:TraceTarget> 
```

并使用以下命令注册跟踪：

```
Log.addTarget(logTarget); 
```

与正常跟踪相比，这提供了几个好处：

*   您可以过滤（关闭）跟踪以仅查看您想要的内容：
    *   通过修改过滤器数组
    *   或仅显示错误或致命消息的级别
*   您可以将跟踪目标替换为任何其他类型的日志记录接口，例如
    *   一个文本字段
    *   一个文本文件

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-20T23:46:59.730

使用条件编译，更多[在这里](http://help.adobe.com/en_US/Flex/4.0/UsingSDK/WS2db454920e96a9e51e63e3d11c0bf69084-7abd.html)。

在您的代码集中：

```
CONFIG::debugging { 
    trace(i);
} 
```

然后转到 Project->Properties->Flex Compiler 并添加

```
-define=CONFIG::debugging,false
or
-define=CONFIG::debugging,true 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T10:35:15.043

您可以对整个项目进行查找/替换。搜索 'trace(' 并替换为 '//trace('。这将足够快并且很容易撤消。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T23:01:13.627

mxmlc 参数`debug`允许您在 SWF 文件中添加或删除调试功能。对于命令行编译器，debug 参数的值默认为 false，但在 Flex Builder 中，您必须手动创建非调试 SWF。根据[有关编译器参数的文档](http://livedocs.adobe.com/flex/3/html/compilers_14.html)，添加到 SWF 的调试信息包括“所有源文件的行号和文件名”。没有提到`trace()`函数调用，我认为没有办法通过编译器参数删除它们，但欢迎您查看链接文档以获取可用参数的整个列表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-16T20:59:08.533

您应该设置两个编译器选项：`-debug=false -optimize=true`. 在 Flex Builder 或 Eclipse 中，查看 Project->Properties->Flex Compiler 并填写标有“Additional compiler arguments”的框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-17T16:09:37.750

转到您的 flex 代码库目录（如果 Flex Builder 正在运行，则关闭它 - 如果您在运行时更改内容，它会变得很自大）。运行此命令以更改所有跟踪语句。我建议先将树检查到 git 或其他东西中，然后再运行 diff （或 cp -r 树来执行 diff -r 或其他东西）。唯一会搞砸的主要情况是跟踪字符串中有分号：

```
find . -name '*.as'   -exec perl -pe 'BEGIN{ undef $/; }s/trace([^;]*);/CONFIG::debugging { trace $1 ; };/smg;' -i {} \;

find . -name '*.mxml' -exec perl -pe 'BEGIN{ undef $/; }s/trace([^;]*);/CONFIG::debugging { trace $1 ; };/smg;' -i {} \; 
```

然后在你的 Project->Properties->Flex Compiler->Additional compiler arguments 中设置以下内容：

```
-define=CONFIG::debugging,true -define=CONFIG::release,false 
```

并使用：

```
CONFIG::release { /* code */ } 
```

对于“#else”子句。这是我在阅读此问答集后选择的解决方案。

还要注意这一点：

```
if( foo )
{
    /*code*/
}
else
    CONFIG::debugging { trace("whoops no braces around else-clause"); }; 
```

即，如果您在 if 或 else 或任何块中只有其中一个，并且它是一个没有大括号的裸块，那么无论它是否被编译出来，它都会抱怨。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-08T10:09:57.657

Something else you could do is define a boolean named debugMode or something in an external constants .as file somewhere and include this file in any project you use. Then, before any trace statement, you could check the status of this boolean first. This is similar to zdmytriv's answer.

Have to say, I like edibleCode's answer and look forward to trying it some time.

# internet-explorer - Internet Explorer 忽略我的 cookie

> ID：867796
> 
> 赞同：7
> 
> 时间：2009-05-15T09:47:53.410
> 
> 标签：internet-explorer, http, cookies, webobjects

我遇到了一个奇怪的问题，即 Internet Explorer 不接受我的 cookie。这是饼干：

```
set-cookie: USUSERNAME=LrceSVu6mUJ9Ztmvp4oKSQ%3D%3D; version="1"; expires=Mon, 15-Jun-2009 11:42:21 GMT; path=/; domain=.us.is 
```

它不会为域 dev-intranet.us.is 或任何其他 us.is 域存储。但是，将 cookie 的域设置为我的开发机器 ip 地址非常有效：

```
set-cookie: USUSERNAME=LrceSVu6mUJ9Ztmvp4oKSQ%3D%3D; version="1"; expires=Mon, 15-Jun-2009 08:41:58 GMT; path=/; domain=192.168.34.104 
```

在 Firefox、Opera、Safari 和 Chrome 中一切正常，但在 IE7 中没有

有什么想法吗？

顺便提一句。使用 WebObjects WOCookie 创建 cookie。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-23T14:44:54.313

您示例中的 cookie 用于“us.is”域。**IE 忽略为两个字母域设置的 cookie**。更准确地说，它似乎忽略了来自少于 5 个字符的域的 cookie（比如你的：2+2）。

我记得我相信来自 IE6 的这个错误/功能，可能是早期版本。阅读本文，看起来这种行为仍然存在于 IE7 中。

可以在此处找到建议不切实际的解决方法的 MSKB 文章：http: [//support.microsoft.com/kb/310676](http://support.microsoft.com/kb/310676)。

更实际的可能是获得一个更长的域名；-) 或者确保用户总是被重定向到一个规范的名称，即“www.us.is”并在那里放置您的 cookie。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-09-06T04:29:13.473

一些额外的边缘案例/细节（在 IE8 中使用 Per Site Privacy Actions [Internet Options > Privacy > Sites] 完成的测试）：

以下域被**拒绝**：

```
 a.a
 aa.a
  a.aa
 aa.aa 
```

带有错误消息：

```
You have entered an invalid domain. Domains must be in the Internet zone
and must use the HTTP or HTTPS protocol. URLs beginning with xn-- must
be valid IDN names.

Examples of valid domains:

  - www.treyresearch.net
  - http://treyresearch.net
  - fineartschool.net 
```

**接受**以下域：

```
aaa.a
aaa.aa
  a.aaa
 aa.aaa

   a.a.a
  a.a.aa
 a.aa.aa
aa.aa.aa 
```

此外，在很大程度上不相关，Internet Explorer 似乎拒绝接受包含域规范中不允许的字符的域。如果（大概是在开发环境中），你有一个无效的域，IE 不喜欢它。

以下域被**拒绝**：

```
a_a.aa
a%a.aa
a*a.aa
a=a.aa 
```

带有错误消息：`The site name you entered is not a valid IDN URL`。

测试似乎仅限于字符有效性而不是安排有效性，因为以下域是**ACCEPTED**：

```
aa-.aa
aa.aaa.
---.aa
-.---
---.- 
```

希望这可以帮助人们寻找在 IE7 / IE8 中在一种环境与另一种环境中未正确设置 cookie 的详细信息。

# c++ - 如何绘制 C++ Win32 控制台应用程序的输出？

> ID：867813
> 
> 赞同：1
> 
> 时间：2009-05-15T09:54:00.257
> 
> 标签：c++, winapi, plot, charts

我有一个小型 Win32 控制台应用程序，它本质上是一个测试工具。我读入数据，对其进行一些处理，目前只是将一些数字输出到控制台。这不是一个大问题 - 我可以了解数据的样子，但是如果有一种方法可以将这些信息放入每次运行软件的图表中，那么分析起来会容易得多。

我最近一直在掌握 GNUPlot，但无法找到一种简单的方法来获取发送给它的数据。有没有人试过这个？..或者我应该尝试另一个图形应用程序吗？

Excel 和 OO Calc 是很棒的工具，我自己已经将 .csv 数据加载到它们中，用于多次绘制数据。然而，我希望有一种方法可以将数据动态地输送到图形应用程序中，以避免每次我想查看一些数据时都必须关闭/重新打开 excel 并绘制图表。

我认为您可以将数据通过管道传输到 GNUPlot（这就是我提到它的原因），但是如何做到这一点的细节却很少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T09:56:03.217

一种简单的方法是将数据输出为 CSV，然后将其导入 Excel 或 OpenOffice 等电子表格以进行图形绘制。

**编辑：**根据你的问题，我自己对 GNUPlot 很感兴趣——这是我发现的从命令行使用它的最简单描述：[http ://www.goldb.org/goldblog/CommentView,guid,f378e279-eaa5-4d85 -b7d2-0339a7c72864.aspx](http://www.goldb.org/goldblog/CommentView,guid,f378e279-eaa5-4d85-b7d2-0339a7c72864.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T09:57:42.263

永远不要低估 Excel 和 .csv 数据转储的强大功能。

将数据写入 C++ 格式的 .csv 文件并不是很困难，并且有很多关于该主题的文章，例如：[here](http://knab.ws/blog/index.php?/archives/3-CSV-file-parser-and-writer-in-C-Part-1.html)，或者只是 google。

Excel 可以轻松加载 .csv，然后您可以使用它来绘制您需要的任何图表。如果您只想对结果等进行快速的视觉完整性检查，这将特别有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T13:29:22.270

您可能还想查看[XMGrace](http://plasma-gate.weizmann.ac.il/Grace/)，它允许您启动它并从 C/Fortran 程序直接驱动它，如下[所示](http://plasma-gate.weizmann.ac.il/Grace/doc/UsersGuide.html#ss6.2)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T14:31:45.333

你真的不需要接触 VBA 来做到这一点

在 Excel 中，您可以设置与文件的数据连接，它支持多种文件类型，但 CSV 可以正常工作。

*   转到列表项
*   数据选项卡
*   单击连接
*   点击添加
*   选择文件
*   转到连接属性 - 取消勾选提示输入文件名
*   设置所需的时间。
*   关闭连接对话框
*   选择导入数据的起始单元格 - 工作表 2 上的单元格 1a
*   单击现有连接
*   选择你的数据连接
*   翻转到 worksheet1 添加图表并连接数据。

图表现在将自动更新

这是 Excel 2007 - 但认为旧版本有这个，我认为 OO 可以做到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T13:07:44.817

我刚刚在卡迪夫大学的网站上找到[了一个将数据管道传输到 gnuplot 的示例。](http://www.cs.cf.ac.uk/Dave/C/node23.html)还没试过，但看起来很有希望！

**[编辑]** ..[还有一个包含一些 windows 注释](http://sushpa.wordpress.com/2008/05/29/calling-gnuplot-from-within-c-or-python/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T13:49:55.183

Excel 完全可以编写脚本。使用宏记录器找出步骤。在自己的工作表中创建图表。然后使用 GIF 过滤器保存图表。

实际的导入是这样的：

ActiveChart.Export FileName:=something_dot_gif, FilterName:="GIF"

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-25T21:35:26.293

您可以使用[MathGL](http://mathgl.sourceforge.net/) - 它可以创建一个窗口（FLTK、GLUT 或 Qt）并在其中显示绘图。它也有大量的情节类型，可以在控制台中工作。

# oracle - 甲骨文版本

> ID：867829
> 
> 赞同：0
> 
> 时间：2009-05-15T09:59:36.237
> 
> 标签：oracle

oracle 有哪些版本？哪个是最新的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T10:05:16.020

最新版本是[Oracle 11G](http://www.oracle.com/technology/products/database/oracle11g/index.html)。以前的版本包括：

*   甲骨文10G
*   甲骨文 9i
*   甲骨文 8i
*   甲骨文 8
*   甲骨文 7
*   甲骨文 6
*   ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T11:40:20.860

除了版本号，还有不同的版本，也许这就是您所要求的：

*   个人版
*   快捷版
*   标准版一
*   标准版
*   企业版

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T10:03:38.677

您的意思是，哪些 oracle 版本可用于 .NET 程序？在这种情况下：MS Oracle 提供程序中的 8i 及更高版本 8i 及 ODP.NET 9.2 中的更高版本 9i 及 ODP.NET 10g 及更高版本中的更高版本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-15T11:35:13.337

最新的是11g....

但在印度公司直到现在都在使用 oracle 10G。

大多数人仍在研究 8i、6i 等......

9i是最好的....

10g基于网格系统

# git - 将远程 github 存储库中的更改合并到本地存储库

> ID：867831
> 
> 赞同：121
> 
> 时间：2009-05-15T09:59:44.737
> 
> 标签：git, merge, repository, github

前段时间我在 github 上 fork 了一个存储库，做了一个小改动并将更改推送回我的 github fork。从那以后，原始存储库发生了变化。我想将原始存储库中的更改合并到我的 fork 中。

我是 git 和 github 的新手，我需要特定的命令来完成它。

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2009-05-15T10:42:50.390

```
git remote add {name} {Public Clone URL}
git pull {name} master
git push 
```

例子：

```
git remote add bret git://github.com/bret/watir.git
git pull bret master
git push 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-15T10:08:27.040

只需将原始 repo 添加为远程并将您的 fork 与它合并；然后将合并的 fork 推送到 github。

还有一个[ruby​​ gem 用于更轻松的 github 操作](http://github.com/defunkt/github-gem/tree/master)。您可以通过一个呼叫合并上游...

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-10-02T11:58:17.657

# **同步分叉**

*（来自 GitHub 帮助）*

[https://help.github.com/articles/syncing-a-fork](https://help.github.com/articles/syncing-a-fork)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-11T10:23:38.547

```
git pull origin master 
```

将完成创建额外合并提交的工作。如果您没有冲突并且不想为您推送的每个提交创建重新加入（带有额外的“合并”提交），那么`rebase`更优选。您可以使用 Git Gui+gitk 来完成。只需使用远程获取`Git Gui`然后打开历史记录`gitk`并在获取时创建临时`r_master`分支`remotes/origin/master`。最后，调用`git rebase r_master`. `git bash`这会将您的提交置于远程修改之上。您已准备好推送和删除`r_master`.

此[评论](https://stackoverflow.com/questions/559917/git-rebase-and-git-push-non-fast-forward-why-use/14276196#comment4955647_559971)表明此流程有捷径。

# c# - WCF 服务可以创建自己的主机吗？

> ID：867832
> 
> 赞同：0
> 
> 时间：2009-05-15T09:59:44.830
> 
> 标签：c#, wcf

我有一个客户端/服务器类型的应用程序，我希望服务器对象创建自己的主机。它看起来像这样：

```
public class Server : IServer {
  private ServiceHost m_Host;
  public Server() {
    m_Host = new ServiceHost(this);
    m_Host.Open();
  }
} 
```

当发生的消息传输很少时，它似乎工作正常。但是当它开始加速时（我的应用程序要求每 50 毫秒传输一次数据），服务器会挂起，并且传输会在几秒钟后停止而不会引发异常。

那么，对象是否有可能创建自己的宿主？或者我真的必须在 main() 中创建它还是做其他事情？

编辑：我认为这种情况下的问题是我希望实现服务本身的对象创建自己的ServiceHost。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T11:01:51.810

没有什么能真正阻止任何对象创建 ServiceHost 的实例。

那么最大的问题是 - 你能保证包含服务主机的对象是“活动的”吗？还是偶然收集到的垃圾？

我们使用 Windows (NT) 服务来托管我们自己的自定义服务主机类，以便为 WCF 服务提供全天候的可用性——工作得很好。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T11:37:04.317

查看[ServiceBehaviorAttribute](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.aspx)，它允许您指定服务的行为方式。;) [ConcurrencyMode](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.concurrencymode.aspx)属性定义了对多线程的支持并默认为单线程模式，而[InstanceContextMode](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.instancecontextmode.aspx)定义了服务对象是按会话、按调用还是单例。

来自 ConcurrencyMode 的报价：

> 将 ConcurrencyMode 设置为 Single 指示系统将服务实例一次限制为一个执行线程，从而使您无需处理线程问题。Multiple 的值意味着服务对象可以在任何时候被多个线程执行。在这种情况下，您必须确保线程安全。

引用 InstanceContextMode：

> 如果 InstanceContextMode 值设置为 Single，则结果是您的服务一次只能处理一条消息，除非您还将 ConcurrencyMode 值设置为 Multiple。

我们真的可以使用您服务的一些代码示例来进一步调试您所描述的行为。例如，您的服务对象的构建成本是否很高（假设非单例实现），或者操作是否变慢？你知道时间花在了哪里，是代码，还是一些限制连接的防火墙？你使用什么协议？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T11:18:58.260

要成为 WCF 服务，它只需要实现服务契约。没有什么可以阻止您添加更多方法来打开和关闭自身实例作为服务。

# .net - 使用 .net 侦听器进行日志文件轮换

> ID：867833
> 
> 赞同：4
> 
> 时间：2009-05-15T10:00:13.927
> 
> 标签：.net, configuration, logging

我有一个**现有的**.net 服务，我想将其配置为将消息写入日志文件。我在服务配置中添加了以下内容：

```
<system.diagnostics>
  <sources>
    <source name="My.Service" switchValue="All">
      <listeners>
        <add name="text" type="System.Diagnostics.TextWriterTraceListener" initializeData="c:\log.txt" traceOutputOptions="Timestamp"/>
      </listeners>
    </source>
  </sources>
</system.diagnostics> 
```

问题是日志文件很快变得非常大，所以我想知道是否可以配置某种日志轮换。
由于该进程锁定文件以进行写入，因此无法手动旋转它，例如使用脚本定期重命名文件，至少无需停止和重新启动服务。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-15T10:40:11.317

我认为有[FileLogTraceListener可以解决问题。](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.logging.filelogtracelistener.aspx)您可以将其配置为每天或每周间隔。

如果这还不够，那么您将不得不编写自己的跟踪侦听器，只需从 TraceListener 继承并覆盖写入方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:04:19.813

您能否将日志轮换内置到文件名中，以便：

“c:\log.txt”

变成：

“c:\logDDMMYYYY.txt”

这样，日志会在一天结束时自动滚动到新文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T10:04:59.420

也许您可能会看一下[log4net](http://logging.apache.org/log4net/index.html)，这是一个免费且易于使用的 .NET 日志库。该库已经包含日志轮换。

否则，您将拥有“解锁”文件和/或自动登录到新文件的服务。

# python - 在 Python 中为 C 库创建包装器

> ID：867850
> 
> 赞同：5
> 
> 时间：2009-05-15T10:06:06.780
> 
> 标签：python, c

我正在尝试为 FLAC 创建自己的包装器，以便可以在自己的 Python 代码中使用 FLAC。

我首先尝试使用 ctypes，但它显示了一个非常奇怪的库接口，例如 FLAC 流和文件的所有 init 函数都变成了一个函数，没有关于如何初始化它的真实信息。特别是因为它想要引用流解码器，但 Python 无法存储指针（[BZZZT！](http://docs.python.org/library/ctypes.html#fundamental-data-types)），因此我无法存储指向流解码器的指针。不同的 init 函数具有不同数量的参数并且某些参数类型不同，这无济于事。它还有很多枚举和结构，我不知道如何将它们放入我的代码中。

我一直在研究 Pyrex，但我在指针方面遇到了同样的问题，但我想我解决了，有点。[文件也不小，甚至都不完整。](http://github.com/Bocom/zet-subou-/blob/db6d1d37068c936f1e3a98b09ec038b38b7d25e0/flac_wrapper.pyx)

因此，我正在寻找可以帮助我更好地理解上述方法的替代方法或指南。如果我能得到推荐和/或帮助，那真的很有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T10:13:15.017

> Python 无法存储指针，因此我无法存储指向流解码器的指针

**ctypes**有指针，ctypes 可以用来包装现有的 C 库。只是一个提示，您需要将所有相关的 C 结构包装/重写到 ctypes.Structure 中。查看示例：[code.google.com/p/pyxlib-ctypes](http://code.google.com/p/pyxlib-ctypes/)和[code.google.com/p/pycairo-ctypes](http://code.google.com/p/pyxlib-ctypes/)。有关如何在[http://docs.python.org/library/ctypes.html](http://docs.python.org/library/ctypes.html)上映射函数/过程及其*argtypes*和*restype的更多信息*

> 我一直在研究 Pyrex，但我在指针方面遇到了同样的问题，但我想我解决了，有点。文件也不小，甚至都不完整。

**如果您想要干净的语法， cython**可能是您所需要的。[www.cython.org](http://www.cython.org)

> 因此，我正在寻找可以帮助我更好地理解上述方法的替代方法或指南。如果我能得到推荐和/或帮助，那真的很有帮助。

**另一方面，**swig总是可以使用，但如果你不习惯它会更复杂。**[www.swig.org](http://www.swig.org)**

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-15T10:12:24.613

你有没有看过[http://www.swig.org/](http://www.swig.org/)：

> SWIG 是一种软件开发工具，它将用 C 和 C++ 编写的程序与各种高级编程语言连接起来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T21:33:20.653

> 但是 Python 没有办法存储指针（BZZZT！）

这是不正确的。你创建一个这样的指针：

```
pInt = POINTER(c_int)() 
```

你像这样访问它

```
pInt[0] # or p.contents 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-03T00:39:47.863

这篇文章很旧，但有一个替代方案`ctypes`：[CFFI](http://cffi.readthedocs.org)。它更容易，更快，并且在 PyPy 下工作得更好。另外，它对指针有很好的支持。这是一个例子：

```
from cffi import FFI

ffi = cffi.FFI()

ffi.cdef('''
struct x { void *a; }

void* get_buffer();
struct x* make_x(void*);
void change_x(struct x*, void*);
''')

dll = ffi.dlopen('libmyawesomelibrary.so')

buf = dll.get_buffer()
tst = dll.new('struct x*')
tst.a = buf
change_x(tst, get_buffer())
tst2 = make_x(get_buffer()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T10:49:07.660

Some people use [pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/) for this.

# apache-flex - Flex 画布和鼠标事件

> ID：867852
> 
> 赞同：1
> 
> 时间：2009-05-15T10:07:22.613
> 
> 标签：apache-flex, actionscript-3, events, canvas

这个简单的代码在红色画布上显示了一个绿色画布，我希望绿色画布**让鼠标按下事件被他身后的孩子抓住**：红色画布。

我怎样才能做到这一点 ？

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" applicationComplete="init()">
    <mx:Canvas id="bg" width="100%" height="100%" backgroundColor="white" />

     <mx:Script>
        <![CDATA[

            private function init():void {

            var cvstest:Canvas = new Canvas();
            cvstest.width = 200;
            cvstest.height = 200;
            cvstest.x = 100;
            cvstest.doubleClickEnabled = true;
            cvstest.addEventListener(MouseEvent.DOUBLE_CLICK, dc);
            cvstest.addEventListener(MouseEvent.MOUSE_DOWN, md);
            cvstest.setStyle("backgroundColor",0xff0000);
            this.addChild(cvstest);   

            var cvsselect:Canvas = new Canvas();
            cvsselect.width = 20;
            cvsselect.height = 20;
            cvsselect.x = 140;
            cvsselect.doubleClickEnabled = false;
            cvsselect.mouseChildren = true;
            cvsselect.addEventListener(MouseEvent.MOUSE_DOWN, md2);
            cvsselect.setStyle("backgroundColor",0x00ff00);
            this.addChild(cvsselect);   
            }

         public function dc (e:MouseEvent) : void {
            trace("DOUBLE CLICK ON TEST CANVAS");
        } 
         public function md (e:MouseEvent) : void {
            trace("SINCLICK ON TEST CANVAS");
        } 
        public function md2 (e:MouseEvent) : void {
            trace("GREEN CLICK ON TEST CANVAS");
        } 
        ]]>    
    </mx:Script>
</mx:Application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T10:16:26.960

mouseEnable false 成功了，还有其他方法吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:27:27.197

你需要改变你养育孩子的方式。事件“遍历”显示树。所以你有'主应用'->'红色画布'和'主应用'->'绿色画布'。

因此，当您单击绿色画布时，事件永远不会到达红色画布。它将从“主应用程序”变为“绿色画布”并备份到“主应用程序”。

您需要做的是使“绿色画布”成为“红色画布”的子级，然后您可以将侦听器添加到“红色画布”，这样就能够侦听从“绿色画布”触发的事件。

如果您这样做，请记住 event.target 是事件的来源（绿色画布），如果您在“红色画布”内收听，那么 event.currentTarget 将是“红色画布”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T11:58:42.860

您也可以实现观察者设计模式，但是您必须扩展 Canvas 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T12:17:52.393

不要将鼠标按下侦听器添加到绿色画布，即删除该行

```
cvsselect.addEventListener(MouseEvent.MOUSE_DOWN, md2); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-15T10:18:55.697

cvsselect.mouseChildren = false;

cvsselect.mouseEnabled = false;

并删除行 cvsselect.addEventListener(MouseEvent.MOUSE_DOWN, md2);

# sql-server-2005 - SQL Server Reporting Services 2005 - 生成的 HTML - 标准合规性

> ID：867853
> 
> 赞同：1
> 
> 时间：2009-05-15T10:07:34.187
> 
> 标签：sql-server-2005, reporting-services, accessibility, standards-compliance

通过报告服务（例如 XHTML、CSS、WCAG 等）寻找关于生成的 html 的标准合规性的指导

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T15:46:08.447

差远了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T12:04:42.633

更具体地说，我查看了：

*   [H39：使用标题元素将数据表标题与数据表关联](http://www.w3.org/TR/WCAG20-TECHS/H39.html)；
*   [H43：使用 id 和 headers 属性将数据单元格与数据表中的标题单元格关联起来](http://www.w3.org/TR/WCAG20-TECHS/H43.html)；
*   [H63：使用范围属性关联数据表中的标题单元格和数据单元格](http://www.w3.org/TR/WCAG20-TECHS/H63.html)。

Reporting Services 似乎都没有遵循这些，至少对于我检查过的版本 2008。

我在 Microsoft Connect 上发布了一条建议，以[提供符合 WCAG 2.0 的 HTML 呈现扩展](https://connect.microsoft.com/SQLServer/feedback/details/793480/provide-an-html-rendering-extension-that-complies-with-wcag-2-0)。如果您想挑战微软对此做点什么，请在那里投票。

# asp.net - ASP.NET 中的可选验证

> ID：867855
> 
> 赞同：0
> 
> 时间：2009-05-15T10:08:37.837
> 
> 标签：asp.net, validation-controls

我有一个包含三个单选按钮的页面，具体取决于选择了哪个按钮，我需要验证一些控件（使用必填字段验证器）。除了使用自定义验证器之外，还有什么方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T10:39:26.217

ASP.NET 验证器提供了一个[客户端 API](http://msdn.microsoft.com/en-us/library/aa479045.aspx#aspplusvalid_clientside)，允许您：

*   验证客户端
*   连接验证器客户端。
*   启用或禁用客户端验证器。

该`ValidatorEnable`函数的语法是：

```
 ValidatorEnable(rfvMyValidator, boolState); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T10:40:34.217

我在一个小例子上试过这个，它对我有用：

我有

-2 文本框：TextBox1 和 TextBox2

-RequiredFieldValidator：RequiredFieldValidator1 与 ControlToValidate="TextBox1"

-RadioButton：必需的FieldValidator1

此代码由RequiredFiledValidator 生成：

```
<script type="text/javascript">
//<![CDATA[
var RequiredFieldValidator1 = document.all ? document.all["RequiredFieldValidator1"] : document.getElementById("RequiredFieldValidator1");
RequiredFieldValidator1.controltovalidate = "TextBox1";
RequiredFieldValidator1.errormessage = "RequiredFieldValidator";
RequiredFieldValidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
RequiredFieldValidator1.initialvalue = "";
//]]>
</script> 
```

我希望当用户单击 RadioButton1 时将验证切换到 TextBox2。

我是这样做的：

```
 protected void Page_Load(object sender, EventArgs e)
        {
            RadioButton1.Attributes.Add("onclick", "RequiredFieldValidator1.controltovalidate=\"TextBox2\"");
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T10:19:36.173

将 OnSelectedIndexChanged 添加到 RadioButtonList （如果它们是单独的单选按钮控件，则添加 CheckedChanged）

在后面的代码中，`.Enable`以及`.Disable`特定的必填字段验证器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T20:08:39.003

Waleed，您没有指定您使用的是 ASP.Net 表单还是 ASP.Net MVC。

如果您使用的是 ASP.Net MVC，答案很简单......

首先，您应该创建一个 ModelView 类，其中应包含与您的单选按钮对应的布尔属性。

只需使用 Codeplex 上提供的 Foolproof 验证库，它应该可以开箱即用地解决您的问题：[https ://foolproof.codeplex.com/](https://foolproof.codeplex.com/)

除其他外，它支持以下“必需的”验证属性/装饰：

```
[RequiredIf]
[RequiredIfNot]
[RequiredIfTrue]
[RequiredIfFalse]
[RequiredIfEmpty]
[RequiredIfNotEmpty]
[RequiredIfRegExMatch]
[RequiredIfNotRegExMatch] 
```

开始很容易：

*   从提供的链接下载包
*   添加对包含的 .dll 文件的引用
*   导入包含的 javascript 文件
*   确保您的视图从其 HTML 中引用包含的 javascript 文件，以进行不显眼的 javascript 和 jquery 验证。

然后剩下要做的就是装饰应该使用属性有条件地验证的字段，该`[RequiredIfTrue]`属性应该指向 ViewModel 中相应的单选按钮值。

# openid - 从应用程序中外化身份的趋势

> ID：867857
> 
> 赞同：3
> 
> 时间：2009-05-15T10:09:50.547
> 
> 标签：openid, geneva-framework, cardspace, xacml

Stackoverlow 决定使用 OpenID 可能是因为它的简单性，而其他人则认为信息卡（例如 cardspace）是一种更好的策略，因为它得到了主要行业供应商的支持并且众所周知更安全。

开发人员是否可以将库放入 Java Web 应用程序中，从而轻松支持两者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T12:27:14.383

[这](http://www.google.com/url?sa=t&source=web&ct=res&cd=4&url=http%3A%2F%2Fidunno.org%2Fpresentations%2Fwebdd%2FAn%2520Introduction%2520to%2520CardSpace.ppt&ei=sF4NSqCUIYfGMvKC1aYG&rct=j&q=cardspace+java&usg=AFQjCNEI4BcXGZUDSgshjg3utluN34QS2g)是一个比较两者的演示文稿。最后甚至还有一个关于 CardSpace 的 Java 实现的链接。但是，这似乎是从 CardSpace 的角度来看，所以要小心偏见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T19:06:19.520

信息卡和 OpenID 不是相互排斥的，并且可以以互补的方式使用以产生巨大的效果，正如Kim Cameron在他的[Identity Weblog中的](http://www.identityblog.com/)[这段短片](http://www.identityblog.com/wp-content/images/2008/02/OpenID/Normal/OpenIDPhish.html)中所展示的那样。

# python - 在python中将unicode代码点转换为UTF8 hex

> ID：867866
> 
> 赞同：15
> 
> 时间：2009-05-15T10:13:24.533
> 
> 标签：python, unicode

我想将从文件中读取的多个 unicode 代码点转换为它们的 UTF8 编码。

例如，我想将字符串转换为`'FD9B'`字符串`'EFB69B'`。

我可以使用这样的字符串文字手动执行此操作：

```
u'\uFD9B'.encode('utf-8') 
```

但我无法弄清楚如何以编程方式进行操作。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-15T10:18:55.690

使用内置函数[`chr()`](https://docs.python.org/3/library/functions.html#chr)将数字转换为字符，然后对其进行编码：

```
>>> chr(int('fd9b', 16)).encode('utf-8')
'\xef\xb6\x9b' 
```

这是字符串本身。如果您希望字符串为 ASCII 十六进制，您需要遍历并将每个字符转换`c`为十六进制，使用`hex(ord(c))`或类似的。

***注意***：如果您仍然坚持使用 Python 2，则可以[`unichr()`](https://docs.python.org/2/library/functions.html#unichr)改用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-03T02:22:40.770

这是一个完整的解决方案：

```
>>> ''.join(['{0:x}'.format(ord(x)) for x in unichr(int('FD9B', 16)).encode('utf-8')]).upper()
'EFB69B' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T15:05:03.163

```
data_from_file='\uFD9B'
unicode(data_from_file,"unicode_escape").encode("utf8") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T10:20:48.167

```
Python 2.6.2 (r262:71600, Apr 16 2009, 09:17:39) 
[GCC 4.0.1 (Apple Computer, Inc. build 5250)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> u'\uFD9B'.encode('utf-8')
'\xef\xb6\x9b'
>>> s = 'FD9B'
>>> i = int(s, 16)
>>> i
64923
>>> unichr(i)
u'\ufd9b'
>>> _.encode('utf-8')
'\xef\xb6\x9b' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T19:54:55.557

如果输入字符串长度是 4 的倍数（即您的 unicode 代码点是 UCS-2 编码的），那么试试这个：

```
import struct

def unihex2utf8hex(arg):
    count= len(arg)//4
    uniarr= struct.unpack('!%dH' % count, arg.decode('hex'))
    return u''.join(map(unichr, uniarr)).encode('utf-8').encode('hex')

>>> unihex2utf8hex('fd9b')
'efb69b' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-08T22:52:09.177

`unichr`因为在使用宽 unicode 字符时可能会遇到错误：

```
>>> n = int('0001f600', 16)
>>> unichr(n)
ValueError: unichr() arg not in range(0x10000) (narrow Python build) 
```

这是在窄 python 构建上使用宽 unicode 的另一种方法：

```
>>> n = int('0001f600', 16)
>>> s = '\\U{:0>8X}'.format(n)
>>> s = s.decode('unicode-escape')
>>> s.encode("utf-8")
'\xf0\x9f\x98\x80' 
```

并使用原始问题的价值：

```
>>> n = int('FD9B', 16)
>>> s = '\\u{:0>4X}'.format(n)
>>> s = s.decode('unicode-escape')
>>> s.encode("utf-8")
'\xef\xb6\x9b' 
```

# c# - .Net MTP / PTP 包装器？

> ID：867871
> 
> 赞同：9
> 
> 时间：2009-05-15T10:14:49.227
> 
> 标签：c#, .net, camera, mtp, ptp

我正在编写一个业余项目来处理相机上的文件。以前我发现[相机和 FolderBrowserDialog](https://stackoverflow.com/questions/541247/using-folderbrowserdialog-on-a-removable-device-removable-storage)有问题。

我认为令人高兴的是相机正在使用 MTP 或 PTP（图片传输协议不是点对点）。

为了使与相机的接口更加无缝，我想使用 PTP 或 MTP 来访问相机。是否有任何用于 .Net 的 MTP / PTP 包装器可以推荐？如果可能的话，我很想避免自己编写或涉足非托管代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-03T17:40:38.067

我发现 dimeby8 的这篇博客文章是一个很好的起点，其中包含许多有关协议如何工作的有用信息，但是在托管实现的方式上还有很多不足之处

[http://blogs.msdn.com/dimeby8/archive/tags/C_2300_/default.aspx](http://blogs.msdn.com/dimeby8/archive/tags/C_2300_/default.aspx)

我还发现了一个粗略的 C++/CLI MTP 包装器——它几乎没有任何功能，但却很好地展示了混合托管/非托管代码：

[http://ko.sourceforge.jp/projects/sfnet_mtpsharp/](http://ko.sourceforge.jp/projects/sfnet_mtpsharp/)

还有一个 CodePlex 项目，但它没有演示传输或 - 我感兴趣的是 - 编辑相机元数据（特别是相机日期）

[http://www.codeplex.com/portabledevicelib/](http://www.codeplex.com/portabledevicelib/)

你在这个项目上取得过成功吗？

# bash - grep'ing 后保留 ls 着色

> ID：867877
> 
> 赞同：30
> 
> 时间：2009-05-15T10:17:21.170
> 
> 标签：bash, grep, colors, ls

如果我做

```
$ ls -l --color=always 
```

我得到了目录中的文件列表，其中包含针对不同文件类型等的一些漂亮的颜色。

现在，我希望能够通过管道将彩色输出`ls`过滤`grep`掉一些我不需要的文件。关键是我仍然想保留 grep 过滤器之后的颜色。

```
$ ls -l --color=always | grep -E some_regex 
```

^ grep 后我失去了颜色

编辑：我正在使用无头服务器 Ubuntu 8.10、Bash 3.2.39，几乎是一个没有花哨配置的库存安装

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-15T11:13:04.657

您的 grep 可能正在删除`ls`的颜色代码，因为它打开了自己的颜色。

你“可以”这样做：

```
ls -l --color=always | grep --color=never pattern 
```

但是，了解您在`grep`此处 ping 的具体内容非常重要。不仅`grep`ping是`ls`不必要的（使用 a`glob`代替），这种特殊情况`grep`不仅通过文件名和文件统计信息 ping，还通过`ls`!添加的颜色代码进行 ping。

你的问题的真正答案是：不要`grep`。永远不需要管道`ls`到任何东西或捕获它的输出。 `ls`仅用于人类解释（例如，仅在*交互式外壳中**查看*，为此目的，它当然非常方便）。如前所述，您可以使用 glob 过滤枚举的文件：*`ls`*

 *```
ls -l *.txt      # Show all files with filenames ending with `.txt'.
ls -l !(foo).txt # Show all files with filenames that end on `.txt' but aren't `foo.txt'. (This requires `shopt -s extglob` to be on, you can put it in ~/.bashrc) 
```

我**强烈**建议你阅读这两个关于此事的优秀文件：

*   解析不好的解释`ls`：[http://mywiki.wooledge.org/ParsingLs](http://mywiki.wooledge.org/ParsingLs)
*   s的幂`glob`：[http://mywiki.wooledge.org/glob](http://mywiki.wooledge.org/glob)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:47:38.633

您应该通过直接调用二进制文件来检查您是否真的在使用“真正的”ls：

```
/bin/ls .... 
```

因为：您描述的代码确实应该可以工作，除非 ls 由于某些奇怪的原因或错误而忽略 --color=always 。

我怀疑某些别名或函数会（直接或通过变量）添加一些选项。仔细检查情况是否如此。

# database - Visual Studio 2008 中的 PostgreSQL 数据连接/服务器资源管理器

> ID：867879
> 
> 赞同：4
> 
> 时间：2009-05-15T10:18:08.453
> 
> 标签：database, visual-studio-2008, postgresql

我试图找到一种从 Visual Studio 2008“服务器资源管理器”面板浏览 PostgreSQL 数据库的方法。我下载了 Npgsql，但据我所知，这只是代码本身的库，而不是服务器资源管理器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-07-11T07:37:59.253

Npgsql 是 PostgreSQL 的 .NET 提供程序。给定的提供程序是否与服务器资源管理器集成取决于它是否支持[DDEX](http://msdn.microsoft.com/en-us/library/ms379576.aspx)， Npgsl 目前不支持，但[计划在未来版本中提供这种支持](http://npgsql.projects.postgresql.org/roadmap.html)。

但是，如果您只想在服务器资源管理器中浏览 PostgreSQL 数据库，您可以通过安装[psqlODBC](http://psqlodbc.projects.postgresql.org/)、PostgreSQL ODBC 驱动程序并通过[.NET Framework Data Provider for ODBC 进行](http://www.microsoft.com/downloads/details.aspx?FamilyID=6ccd8427-1017-4f33-a062-d165078e32b1&displaylang=en)连接来实现。

[替代文字 http://www.codingthewheel.com/image.axd?picture=postgre_sql_server_explorer.png](http://www.codingthewheel.com/image.axd?picture=postgre_sql_server_explorer.png)

另外，我应该提到 Npgsql 确实[与 Visual Studio 有一些设计时集成](http://npgsql.projects.postgresql.org/docs/manual/UserManual.html)- 例如，您可以使用工具栏中的 NpgsqlConnection 对象等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T10:28:04.420

今年早些时候我找了这个，发现有人在某个邮件列表上写道，他们正在为 Npgsql 做这个，但它还没有。

我们实际上放弃了 Npsql，现在使用[dotConnect for PostgreSQL](http://www.devart.com/dotconnect/postgresql/)代替。它是一种商业产品，提供免费选项，但您必须付费才能获得 Visual Studio 集成。

# sql - 获取最后的记录

> ID：867887
> 
> 赞同：0
> 
> 时间：2009-05-15T10:21:18.837
> 
> 标签：sql, ms-access

如何获取最后 3 条记录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T10:25:12.197

MS Access（注意拼写）使用 SQL，因此您可以使用：

```
SELECT TOP 3 * FROM [tablename] ORDER BY [columnName] DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:44:58.153

if you have an autonumber field as IID on your table then

```
select * from  (select *, (select COUNT(0)  from tableName 
where IID >= thisIsTempNameNotChange.IID)
as INDEX from [tableName] thisIsTempNameNotChange) WHERE INDEX<=3 
```

# java - StackTrace 中的行号指向方法开始

> ID：867894
> 
> 赞同：1
> 
> 时间：2009-05-15T10:24:44.037
> 
> 标签：java, eclipse, websphere, stack-trace, line-numbers

我们正在使用 Rational Application Developer 7.5（基于 Eclipse 3.4）为 WebSphere Application Server 6.1 开发一个 Web 应用程序。在登台服务器上检查堆栈跟踪时，行号始终指向方法的开头，而不是实际行。在本地开发环境中（每个开发人员都有自己的本地 Websphere 6.1 运行）一切似乎都很完美。

在 Java > Compiler > 部分 Classfile Generation 下的 Eclipse Preferences 中，所有内容都已检查。

部署是通过使用 RAD 的`earExport`Ant 目标（不是`ear`核心任务）构建 EAR 文件来完成的。之后它被重新打包以删除一些不必要的文件。没有启动显式编译 - 使用工作区中的类。

怎么会发生这种情况，这些信息会丢失？这是一些热点优化的一部分吗？如果是这样，它可以被禁用吗？

我怎样才能找回正确的行号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T13:51:01.513

你的分期平台是什么？我有一个客户，其登台/生产环境是 iSeries，直到他们将 iSeries 操作系统更新到较新的级别之一，调试行号才最终开始排列。

# android - Android上的蓝牙声音输出

> ID：867897
> 
> 赞同：1
> 
> 时间：2009-05-15T10:25:23.757
> 
> 标签：android, audio, bluetooth

我刚刚注意到，使用 HTC Dream 时，使用蓝牙耳机拨打电话真的很容易，但似乎没有任何东西可用于视频/音乐声音输出。V1.0 的限制并没有错，因为当您播放音乐并开始通话时，您可以在耳机中听到一秒钟的音乐。所以这在技术上是可行的，只是在设置中不可用。

有谁知道如何以编程方式将声音输出重定向到蓝牙耳机？

我想编写一个小应用程序，让你在听音乐的同时看起来像个白痴，带着一个大设备挂在你的耳朵上:-)

[注意：这个问题是我在 Google 小组中提出的](http://groups.google.com/group/android-developers/browse_thread/thread/c29b455707e5eba4)问题的副本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T18:28:06.627

在 Android 1.5 之前，蓝牙支持仅限于耳机/免提配置文件。除了电话对话之外，没有“音频”可以通过蓝牙重定向。

在我的 G1 上安装 Cupcake 后，我现在可以完美地使用蓝牙立体声音频与我的摩托罗拉 S9 耳机。整个堆栈甚至足够智能，可以自动暂停音乐/视频，在来电时切换到耳机配置文件，然后在通话结束时返回。

# svn - 为一家小型 Web 开发公司设置代码存储库

> ID：867899
> 
> 赞同：4
> 
> 时间：2009-05-15T10:25:29.747
> 
> 标签：svn

我最近成为了一家小型 Web 开发机构的技术总监，我们拥有遍布大约 200 个网站的大型代码库。代码使用 PHP 和 VBScript 以及许多客户端 javascript 和一些复杂的 MySQL 查询。

我要做的是建立一个代码库，我们可以在其中存储我们所有的函数、脚本和文件。我们目前有 2 名开发人员在一个保存所有文件的网络驱动器上工作，这显然不是一个理想的解决方案。

我想知道是否有人遇到过类似的情况以及他们为代码存储库设置了什么。我正在考虑为服务器端代码设置一个远程 Subverison 文件系统。

谁能推荐一种明智的方式来维护和存储我们的代码库？Subversion 是适合我们情况的最佳选择吗？我们正在运行面向 Web 的 Solaris 服务器，因此远程访问是系统的目标。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T10:37:09.093

Subversion 是解决这个问题的好方法。Subversion 是免费的，有时设置起来可能非常复杂，如果您正在寻找快速解决方案，您可以尝试[VisualSVN](http://www.visualsvn.com/server/)（它可以轻松安装 Windows）

您还可以使用[Mercurial](http://www.selenic.com/com/mercurial/wiki/)进行版本控制，它以不同的方式处理版本控制。

在每个开发人员工作站上安装[TortoiseSVN](http://tortoisesvn.tigris.org/)，以与 Subversion 交互。

您还应该查看带有颠覆的持续集成。（对于.net，我使用 Cruisecontrol.net 和 TeamCity）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T10:28:54.480

我建议使用 git 和[GitHub](http://github.com)作为 remore repo 主机（尽管还有其他的，你当然可以自托管 git repo）。我们已经成功地将其用于许多大型项目，其中有超过 15 个贡献者分布在世界各地。

git 的一个主要好处是分布式的，如果您由于某种原因无法访问远程存储库，您的开发人员可以在本地工作，提交他们的更改而无需将更改集发送回中心位置。此外，他们可以从彼此的 repo 中提取以共享他们的变更集。

在本地提交时速度快如闪电，每次您克隆一个 repo（几乎类似于 svn 的 checkout）时，您都会获得整个 repo 的本地副本，因此检查日志、比较文件和回滚比 SVN 快得多。

如果你有兴趣，[这篇文章](http://git.or.cz/course/svn.html)可能值得一读。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T10:29:12.483

如果你有一个专用的面向公众的服务器，你将能够设置 Subversion 服务（或守护进程——或在 *NIX 世界中被称为的任何东西）：在 Windows 上你需要 Svnserve，在 NIXes 上（以及在 Windows以及）Apache 将完成这项工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T17:46:00.977

如果您正在寻找托管 SVN 解决方案，[Unfuddle](http://unfuddle.com)非常适合我们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T10:45:39.090

我倾向于发现 Trac 比 SVN 稍微好一点，只是在项目管理和 REPO 方面，两者都非常好用，只需要你学习一些命令，除非你在你的 Windows 机器上可以使用 TortoiseSVN

# silverlight - ContentControl 调整大小的问题

> ID：867915
> 
> 赞同：4
> 
> 时间：2009-05-15T10:29:55.727
> 
> 标签：silverlight, resize

一段时间以来，我一直在用这个把头撞到墙上。

我有一个从 ContentControl 派生的自定义控件——它工作得很好，除非它不会以声明方式或以编程方式调整大小以适应其父级。

自定义控件（最终）在内容演示器中作为父级，并且大小正确，但我的控件不会自行调整大小以适应。

```
 (sample.MyControl) - 400x267
-  (System.Windows.Controls.ContentPresenter) - 979x569 
```

即使我明确设置宽度和高度（在正确的时刻），尺寸也不会“粘住”

```
 Debug.WriteLine(string.Format("MyControl {0}: Size is {1}x{2} ({3}/{4})",
            GetHashCode(), this.ActualWidth, this.ActualHeight,
            this.HorizontalAlignment, this.VerticalAlignment));

        Debug.WriteLine(string.Format("Parent is {0}x{1} ({2}/{3})",
                                      parent.ActualWidth, parent.ActualHeight, 
                                      parent.HorizontalAlignment, parent.VerticalAlignment));

        this.Width = parent.ActualWidth;
        this.Height = parent.ActualHeight;

        Debug.WriteLine(string.Format("MyControl {0}: New size is {1}x{2}",
            GetHashCode(), this.ActualWidth, this.ActualHeight)); 
```

上面的代码给出：

```
MyControl 36022757: Size is 400x267 (Stretch/Stretch)
Parent is 979x569 (Stretch/Stretch)
MyControl 36022757: New size is 400x267 
```

为什么！天哪，为什么！

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-16T23:44:17.710

您只需要添加`HorizontalContentAlignment="Stretch"`和`VerticalContentAlignment="Stretch"`到您的控件：

```
<ContentControl HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
    ...
</ContentControl> 
```

在这种情况下，[Silverlight Spy](http://silverlightspy.com/silverlightspy/download-silverlight-spy/)工具有助于在运行时调试布局。

尝试在此工具中运行您的应用程序，您将能够查看所有 xaml 元素，甚至可以在运行时更改一些属性。

# javascript - 在 jQuery 中创建一个 div 元素

> ID：867916
> 
> 赞同：1618
> 
> 时间：2009-05-15T10:30:24.117
> 
> 标签：javascript, jquery, html, append, jquery-append

如何在**jQuery**`div`中创建元素？

 *** * *

## 回答 #1

> 赞同：2058
> 
> 时间：2010-11-11T19:01:18.817

从 jQuery 1.4 开始，您可以将属性传递给自封闭元素，如下所示：

```
jQuery('<div>', {
    id: 'some-id',
    class: 'some-class some-other-class',
    title: 'now this div has a title!'
}).appendTo('#mySelector'); 
```

这是在*[文档中](http://api.jquery.com/jQuery/#jQuery2)*

示例可以在*[jQuery 1.4 Released: The 15 New Features you Must Know](http://net.tutsplus.com/tutorials/javascript-ajax/jquery-1-4-released-the-15-new-features-you-must-know/)*中找到。

* * *

## 回答 #2

> 赞同：1142
> 
> 时间：2009-05-15T10:43:53.697

您可以使用`append`（在父级的最后一个位置添加）或`prepend`（在父级的第一个位置添加）：

```
$('#parent').append('<div>hello</div>');    
// or
$('<div>hello</div>').appendTo('#parent'); 
```

或者，您可以使用`.html()`或在[不同的答案](https://stackoverflow.com/a/867941/59087)`.add()`中提到。

* * *

## 回答 #3

> 赞同：239
> 
> 时间：2009-05-15T10:49:01.623

从技术上讲`$('<div></div>')`，将“创建”一个`div`元素（或更具体地说是一个 DIV DOM 元素），但不会将其添加到您的 HTML 文档中。然后，您需要将它与其他答案结合使用，以实际使用它做任何有用的事情（例如使用`append()`方法等）。

[操作文档](http://docs.jquery.com/Manipulation)为您提供了有关如何添加新元素的所有各种选项。

* * *

## 回答 #4

> 赞同：204
> 
> 时间：2011-08-07T22:08:45.517

```
d = document.createElement('div');
$(d).addClass(classname)
    .html(text)
    .appendTo($("#myDiv")) //main div
.click(function () {
    $(this).remove();
})
    .hide()
    .slideToggle(300)
    .delay(2500)
    .slideToggle(300)
    .queue(function () {
    $(this).remove();
}); 
```

* * *

## 回答 #5

> 赞同：81
> 
> 时间：2009-05-15T10:36:29.203

```
div = $("<div>").html("Loading......");
$("body").prepend(div); 
```

* * *

## 回答 #6

> 赞同：67
> 
> 时间：2009-05-15T10:34:43.500

```
$("<div/>").appendTo("div#main"); 
```

将附加一个空白 div`<div id="main"></div>`

* * *

## 回答 #7

> 赞同：61
> 
> 时间：2015-02-25T03:46:27.847

创建 div 的一种简短方法是

```
var customDiv = $("<div/>"); 
```

现在自定义 div 可以附加到任何其他 div。

* * *

## 回答 #8

> 赞同：57
> 
> 时间：2011-01-28T04:41:33.160

所有这些都对我有用，

HTML部分：

```
<div id="targetDIV" style="border: 1px solid Red">
    This text is surrounded by a DIV tag whose id is "targetDIV".
</div> 
```

JavaScript 代码：

```
//Way 1: appendTo()
<script type="text/javascript">
    $("<div>hello stackoverflow users</div>").appendTo("#targetDIV"); //appendTo: Append at inside bottom
</script>

//Way 2: prependTo()
<script type="text/javascript">
    $("<div>Hello, Stack Overflow users</div>").prependTo("#targetDIV"); //prependTo: Append at inside top
</script>

//Way 3: html()
<script type="text/javascript">
    $("#targetDIV").html("<div>Hello, Stack Overflow users</div>"); //.html(): Clean HTML inside and append
</script>

//Way 4: append()
<script type="text/javascript">
    $("#targetDIV").append("<div>Hello, Stack Overflow users</div>"); //Same as appendTo
</script> 
```

* * *

## 回答 #9

> 赞同：40
> 
> 时间：2012-02-03T15:56:40.267

```
$("<div/>").attr('id','new').appendTo('body'); 
```

这将在正文中创建 ID 为“new”的新 div。

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2011-06-17T12:15:50.677

```
document.createElement('div'); 
```

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2012-11-27T13:16:50.313

这是另一种使用 jQuery 创建 div 的技术。

***元素克隆***

假设您的页面中有一个现有的 div，您想使用 jQuery 进行克隆（例如，在表单中多次复制输入）。你可以这样做。

```
$('#clone_button').click(function() {
  $('#clone_wrapper div:first')
  .clone()
  .append('clone')
  .appendTo($('#clone_wrapper'));
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="clone_wrapper">
  <div>
    Div
  </div>
</div>

<button id="clone_button">Clone me!</button>
```

* * *

## 回答 #12

> 赞同：18
> 
> 时间：2017-05-01T13:05:37.773

创建内存中的 DIV

```
$("<div/>"); 
```

添加点击处理程序、样式等 - 最后**将 DOM 插入到**目标元素选择器中：

```
$("<div/>", {

  // PROPERTIES HERE

  text: "Click me",
  id: "example",
  "class": "myDiv",      // ('class' is still better in quotes)
  css: {           
    color: "red",
    fontSize: "3em",
    cursor: "pointer"
  },
  on: {
    mouseenter: function() {
      console.log("PLEASE... "+ $(this).text());
    },
    click: function() {
      console.log("Hy! My ID is: "+ this.id);
    }
  },
  append: "<i>!!</i>",
  appendTo: "body"      // Finally, append to any selector

}); // << no need to do anything here as we defined the properties internally.
```

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

[类似于 ian 的答案，但我没有找到正确解决属性对象声明中方法使用的示例，*所以*你去吧。]

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2016-10-14T05:29:04.367

简单地说，如果你想创建任何 HTML 标签，你可以试试这个，例如

```
var selectBody = $('body');
var div = $('<div>');
var h1  = $('<h1>');
var p   = $('<p>'); 
```

如果你想在 flay 上添加任何元素，你可以试试这个

```
selectBody.append(div); 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-05-15T10:34:36.167

```
<div id="foo"></div>

$('#foo').html('<div></div>'); 
```

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2016-03-14T11:40:25.980

**如果您使用的是 Jquery > 1.4，那么最好使用 [Ian's answer](https://stackoverflow.com/a/4158203/3025256)。否则，我会使用这种方法：**

[这与celoron 的答案](https://stackoverflow.com/a/6976126/3025256)非常相似，但我不知道他们为什么使用`document.createElement`而不是 Jquery 表示法。

```
$("body").append(function(){
        return $("<div/>").html("I'm a freshly created div. I also contain some Ps!")
            .attr("id","myDivId")
            .addClass("myDivClass")
            .css("border", "solid")                 
            .append($("<p/>").html("I think, therefore I am."))
            .append($("<p/>").html("The die is cast."))
});

//Some style, for better demonstration if you want to try it out. Don't use this approach for actual design and layout!
$("body").append($("<style/>").html("p{background-color:blue;}div{background-color:yellow;}div>p{color:white;}")); 
```

我还认为`append()`在这种情况下使用回调函数更具可读性，因为您现在立即将某些内容附加到正文中。但这是一个品味问题，就像编写任何代码或文本时一样。

一般来说，在 JQuery 代码中使用尽可能少的 HTML，因为这主要是意大利面条代码。它容易出错且难以维护，因为 HTML-String 很容易包含拼写错误。此外，它将标记语言 (HTML) 与编程语言 (Javascript/Jquery) 混合在一起，这通常是一个坏主意。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2016-08-31T07:58:56.033

或者 append() 你也可以使用`appendTo()`具有不同语法的：

```
$("#foo").append("<div>hello world</div>");
$("<div>hello world</div>").appendTo("#foo"); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2013-08-26T07:03:36.353

`.jquery()`您可以使用该方法创建单独的标签。并使用该`.append()`方法创建子标签。由于 jQuery 支持链接，您还可以通过两种方式应用 CSS。要么在类中指定它，要么只调用`.attr()`：

```
var lTag = jQuery("<li/>")
.appendTo(".div_class").html(data.productDisplayName);

var aHref = jQuery('<a/>',{         
}).appendTo(lTag).attr("href", data.mediumImageURL);

jQuery('<img/>',{                                               
}).appendTo(aHref).attr("src", data.mediumImageURL).attr("alt", data.altText); 
```

首先，我将一个列表标签附加到我的 div 标签并将 JSON 数据插入其中。接下来，我正在创建列表的子标签，并提供一些属性。我已将值分配给一个变量，以便我可以轻松附加它。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-02-16T08:52:16.197

我认为这是添加 div 的最佳方式：

要将测试 div 附加到 ID 为 div_id 的 div 元素：

```
$("#div_id").append("div name along with id will come here, for example, test"); 
```

现在将[HTML](http://en.wikipedia.org/wiki/HTML)附加到这个添加的测试 div 中：

```
$("#test").append("Your HTML"); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2015-09-21T00:42:31.007

我希望这有助于代码。：） （我用）

```
function generateParameterForm(fieldName, promptText, valueType) {
    //<div class="form-group">
    //<label for="yyy" class="control-label">XXX</label>
    //<input type="text" class="form-control" id="yyy" name="yyy"/>
    //</div>

    // Add new div tag
    var form = $("<div/>").addClass("form-group");

    // Add label for prompt text
    var label = $("<label/>").attr("for", fieldName).addClass("control-label").text(promptText);

    // Add text field
    var input = $("<input/>").attr("type", "text").addClass("form-control").addClass(valueType).attr("id", fieldName).attr("name", fieldName);

    // lbl and inp => form
    $(form).append(label).append(input);

    return $(form);
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-09-04T03:11:29.697

如果它只是一个空的 div，这就足够了：

```
$("#foo").append("<div>") 
```

或者

```
$("#foo").append("<div/>") 
```

它给出了相同的结果。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-03-25T11:14:07.460

`$(HTMLelement)`可以成功。如果您想要一个 epmty div，请将其用作`$('<div></div>');`. 您也可以通过相同的方法设置其他元素。如果要在创建后更改内部 HTML，可以使用`html()`方法。对于获取 outerHTML 作为字符串，您可以使用如下所示：

```
var element = $('<div/>');
var innerHTML = element.html(); // if you want set new HTML use it like this element.html('<b>new HTML</b>');
var outerHTML = element[0].outerHTML; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-09-25T11:20:46.877

您可以使用`.add()`创建一个新的***jQuery*** *对象*并添加到目标元素。然后使用链接继续进行。

例如[jQueryApi](https://api.jquery.com/add/)：

```
$( "div" ).css( "border", "2px solid red" )
  .add( "p" )
  .css( "background", "yellow" );
```

```
 div {
    width: 60px;
    height: 60px;
    margin: 10px;
    float: left;
  }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2017-05-30T11:05:59.620

这个怎么样？在这里，`pElement`指的是你想要这个`div`里面的元素（成为它的子元素！:)。

```
$("pElement").append("<div></div"); 
```

您可以轻松地`div`在字符串中添加更多内容 - 属性、内容，您可以命名它。请注意，对于属性值，您需要使用正确的引号。

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2013-08-16T08:06:28.830

我刚刚为此制作了一个小的[jQuery 插件](https://github.com/ern0/jquery.create)。

它遵循您的语法：

```
var myDiv = $.create("div"); 
```

**DOM**节点 ID 可以指定为第二个参数：

```
var secondItem = $.create("div","item2"); 
```

严重吗？不，但是这种语法比*$("<div></div>")*更好，而且物有所值。

*（答案部分复制自：[jQuery document.createElement 等价物？](https://stackoverflow.com/questions/268490/jquery-document-createelement-equivalent/18255277#18255277)）*

# asp.net - web.config ignoring certain files from requiring authentication

> ID：867917
> 
> 赞同：0
> 
> 时间：2009-05-15T10:30:43.883
> 
> 标签：asp.net, web-config

In my asp.net web application, I have a folder in which I have a few html and jpeg files. some of these files do not need a user to login while the others do. How do I exclude the files that are free for view to be displayed without logging in while still maintaining the user to login for viewing other files in the same folder using just the config file. I wasnt able to find something relevant in the config file or maybe I overlooked it. If anyone knows please reply.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T10:43:44.257

I've tried to answer this as well as I can but the sentence:

> How do I exclude the files that are free for view to be displayed without logging in while still maintaining the user to login for viewing other files in the same folder using just the config file.

..is a bit confusing!

The files that need to be authenticated are the ones that are handled by the asp.net handler such as .aspx files. jpegs and other static files bypass this so can be viewed without authentication. The handler aspnet_isapi only handles certain files but you can configure it to handle more file extensions (or all files) by configuring extension mappings in IIS.

Personally, I would put all files I wanted to be unprotected in a folder with permissions to allow anyone to view that folder, set the aspnet_isapi handler to handle all files and then protect your other folders according to your application's needs.

Depending on what you want to do (as your question isn't that clear), you may or may not be able to achieve what you want just from the config file but hopefully this answer will give you the information you need to make your own conclusions on that.

# php - 使用 UNION 或以编程方式联合两个 MySQL 查询

> ID：867922
> 
> 赞同：1
> 
> 时间：2009-05-15T10:31:55.987
> 
> 标签：php, mysql, performance, union

我有两个 MySQL 查询，它们都将数据插入到表中。两者都具有以下格式：

```
CREATE TABLE IF NOT EXISTS `data` (
`id` BIGINT NOT NULL AUTO_INCREMENT UNIQUE,
PRIMARY KEY (`id`)
)
SELECT `field1`, `field2`
WHERE `active` = 1 
```

两个查询之间的唯一区别是如何确定`field1`和`field2`确定，以及条件子句中的一些细微差别。两者都运行高达 12K 和更多的记录。

现在，什么会更有效：

A. 分别运行两个查询：

```
if (mysql_query($query1)) {
    return mysql_query($query2);
}
return false; 
```

B. 或将这两个查询与 UNION 组合，并运行一次：

```
$query = 'SELECT `field1`, `field2` WHERE `active` = 1
            UNION 
            SELECT DO_ONE(`field1`), DO_TWO(`field2`) WHERE `active` = 1
            ORDER BY `field1`';
return mysql_query('CREATE TABLE IF NOT EXISTS `data` (
`id` BIGINT NOT NULL AUTO_INCREMENT UNIQUE,
PRIMARY KEY (`id`)
) ' . $query) 
```

如果没有来自另一个查询的数据，来自一个查询的数据是无用的，因此两者都需要成功。`DO_ONE`并且`DO_TWO`是用户定义的 MySQL 函数，可根据某些规范更改字段数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T17:42:56.620

Aaronmccall 的答案通常可能是最好的——UNION 方法在一个 SQL 调用中完成所有工作。一般来说，这将是最“有效”的，但可能会出现一些副作用，并影响您特定应用程序的“有效”衡量标准。

具体来说，如果 UNION 需要一个临时表来收集中间结果并且您正在处理非常大的数据集，那么在您的特定情况下对新表执行两个单独的直接 SELECT 可能会更有效。这将取决于数据库引擎中的内部工作、完成的优化等（这可能会根据您使用的数据库引擎的版本而改变）。

最终，就这样的特定问题回答您的问题的唯一方法可能是为您的特定应用程序和环境进行计时。

您可能还想考虑两个单独查询与“一体式”查询所需的时间之间的差异在总体方案中可能是微不足道的......您可能正在谈论几毫秒的差异（或甚至是微秒？）除非您的 mysql 数据库位于具有巨大延迟问题的单独服务器上。如果您一次执行数千个这样的调用，那么差异可能很大，但是如果您只执行其中一两个调用并且您的应用程序花费 99.99% 的时间执行其他操作，那么两者之间的差异两个可能甚至不会被注意到。

---劳伦斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T12:40:52.057

你的选择做不同的事情。如果第一个查询正确执行，则第一个查询返回第二个查询的结果（顺便说一句，它独立于它返回的结果，它可以返回一个空行集）。第二个将第一个查询和第二个查询的结果一起返回。第一个选项在我看来毫无用处，可能你想要实现的是你对 UNION 所做的（除非我误解了你）。

编辑：阅读你的评论后，我认为你是这样的：

SELECT true where (EXISTS(SELECT field1, field2 ...) AND EXISTS (SELECT Field1, field2 ...))。

这样，您将只有一个对数据库的查询，它可以更好地扩展，从连接池中占用的资源更少，并且如果您将数据库引擎放在不同的服务器上，延迟的影响不会加倍，但您仍然会中断查询如果第一个条件失败，这就是您使用嵌套分离查询寻找的性能改进。

作为一种优化，尝试首先获得执行速度更快的条件，以防它们不一样。我假设如果其中一个需要这些字段计算会更慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T14:12:41.337

UNION 方法肯定会更快，因为从 php 调用两次 mysql api 调用相对于一次调用。

# c++ - 在哪里可以找到 C++/MFC 的提要库？

> ID：867925
> 
> 赞同：0
> 
> 时间：2009-05-15T10:32:31.163
> 
> 标签：c++, mfc

我正在寻找一个 C++ 提要库。

我在哪里可以找到一个？

### 编辑：

我需要能够从我的 MFC 应用程序访问提要。我希望有一个可以处理 RSS、音频、视频以及它可以容纳的任何其他内容的库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T14:10:22.107

看到[这个](https://stackoverflow.com/questions/26436/rss-feed-library-for-unmanaged-c)。基本上，[Windows RSS 平台](http://msdn.microsoft.com/en-us/library/ms684701.aspx)就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-22T02:45:12.617

您可以查看[Feedreader-lib](http://code.google.com/p/feed-reader-lib/)。但是，它可能对您有太多的依赖关系。

如果您想要 c++ 的提要库列表，您可以查看[这个问题](https://stackoverflow.com/questions/459874/recommendations-easy-to-use-low-dependency-c-c-rss-library)。这些是那里的答案中提到的库：

*   [libxml](http://xmlsoft.org/downloads.html)，因为 RSS 提要只是 XML
*   [外籍人士](http://expat.sourceforge.net/)，同上
*   [练习](http://xerces.apache.org/xerces-c/)
*   CodeProject 上的[灵活解析器，看起来相当不错](http://www.codeproject.com/KB/recipes/FlexibleParser.aspx)
*   [libmrss](http://www.autistici.org/bakunin/libmrss/doc/)，大约一年没更新了

请注意，其中大多数确实依赖于下载提要的外部库，例如[libcurl](http://curl.haxx.se/)，而那些不是专用 XML 解析器的库也依赖于外部 XML 解析器。

# c# - C# 欺骗进程所有者

> ID：867928
> 
> 赞同：0
> 
> 时间：2009-05-15T10:33:43.750
> 
> 标签：c#, user-interface, spoofing

在 C# 中是否可以欺骗进程的所有者？假设我的进程名称是“Game.exe”，当用户运行它时，它在进程列表中显示为 Game.exe UsernameHere

是否可以欺骗 UsernameHere 部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T10:34:43.030

您需要调查身份冒充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:38:30.573

仅通过以其他用户身份运行它。

# iphone - 对于具有 alphatransparency 的 pngcrunch 优化的 24 位 PNG 文件，我必须为每个组件指定多少位？

> ID：867929
> 
> 赞同：0
> 
> 时间：2009-05-15T10:34:16.107
> 
> 标签：iphone, png, core-graphics, png-24

CGBitmapContextCreate 接受一个对我来说不是很明显的参数：

> 例如，对于 32 位像素格式和 RGB 颜色空间，您将指定每个组件 8 位的值。

我创建了具有 alphatransparency 的 24 位 PNG 文件，并将它们添加到 Xcode。在编译时，Xcode 使用 pngcrunch 优化那些 PNG 切片。

因此，当尝试在 iPhone-OS 上从此类图像文件中创建图形上下文时，我需要指定每个组件的位。

在这种情况下，我会说它们是每个组件 4 位，尽管我不知道 alpha 是否算作一个组件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T14:13:26.937

每个组件有 8 位：

```
Red:8;
Green:8;
Blue:8;
Alpha:8; 
```

每个像素加起来最多 32 位。具有透明度的 24 位 png 是 24 位的 RGB，加上 8 位的透明度（“alpha 通道”）。

# python - Python：在同一个列表上进行双重/多重迭代的优雅方式

> ID：867936
> 
> 赞同：6
> 
> 时间：2009-05-15T10:35:14.607
> 
> 标签：python, iterator

我编写了一些类似下面的代码来将项目与列表中的其他项目进行比较。这种双重迭代是否有更优雅的模式？

```
jump_item_iter = (j for j in items if some_cond)
try:
    jump_item = jump_item_iter.next()
except StopIteration:
    return
for item in items:
    if jump_item is item:
        try:
            jump_item = jump_iter.next()
        except StopIteration:
            return
    # do lots of stuff with item and jump_item 
```

我不认为“ `except StopIteration`”很优雅

编辑：

为了希望更清楚，我想访问列表中的每个项目并将其与列表中满足 some_cond 的下一个项目 (jump_item) 配对。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T15:49:57.907

据我所见，任何现有的解决方案都适用于一般的一次性，可能是无限的迭代**器**，它们似乎都需要一个迭代**器**。

这是一个解决方案。

```
def batch_by(condition, seq):
    it = iter(seq)
    batch = [it.next()]
    for jump_item in it:
        if condition(jump_item):
            for item in batch:
                yield item, jump_item
            batch = []
        batch.append(jump_item) 
```

这将很容易在无限迭代器上工作：

```
from itertools import count, islice
is_prime = lambda n: n == 2 or all(n % div for div in xrange(2,n))
print list(islice(batch_by(is_prime, count()), 100)) 
```

这将打印前 100 个整数及其后的素数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T12:26:24.743

```
paired_values = []
for elmt in reversed(items):
    if <condition>:
        current_val = elmt
    try:
        paired_values.append(current_val)
    except NameError:  # for the last elements of items that don't pass the condition
        pass
paired_values.reverse()

for (item, jump_item) in zip(items, paired_values):  # zip() truncates to len(paired_values)
    # do lots of stuff 
```

如果 items 的第一个元素匹配，则将其用作 jump_item。这是与原始代码的唯一区别（您可能想要这种行为）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T10:47:45.013

I have no idea what `compare()` is doing, but 80% of the time, you can do this with a trivial dictionary or pair of dictionaries. Jumping around in a list is a kind of linear search. Linear Search -- to the extent possible -- should always be replaced with either a direct reference (i.e., a dict) or a tree search (using the bisect module).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T14:03:58.037

编写一个生成器函数：

```
def myIterator(someValue):
    yield (someValue[0], someValue[1])

for element1, element2 in myIterator(array):
     # do something with those elements. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T12:40:49.560

以下迭代器节省时间和内存：

```
def jump_items(items):
    number_to_be_returned = 0
    for elmt in items:
        if <condition(elmt)>:
            for i in range(number_to_be_returned):
                yield elmt
            number_to_be_returned = 1
        else:
            number_to_be_returned += 1

for (item, jump_item) in zip(items, jump_items(items)):
    # do lots of stuff 
```

请注意，您实际上可能希望将第一个 number_to_be_returned 设置为 1...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T12:19:15.183

这是一个看起来更简洁的简单解决方案：

```
for i, item in enumerate(items):
    for next_item in items[i+1:]:
        if some_cond(next_item):
            break
    # do some stuff with both items 
```

缺点是您多次检查 next_item 的条件。但是您可以轻松地对此进行优化：

```
cond_items = [item if some_cond(item) else None for item in items]
for i, item in enumerate(items):
    for next_item in cond_items[i+1:]:
        if next_item is not None:
            break
    # do some stuff with both items 
```

但是，这两种解决方案都比问题中的原始解决方案带来更多开销。当您开始使用计数器来解决这个问题时，我认为最好直接使用迭代器接口（如在原始解决方案中）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T12:29:29.213

如果我理解正确，您希望主要`for item in items:`“追逐”过滤掉某些项目的迭代器。好吧，您无能为力，除了可以将其包装到`chase_iterator(iterable, some_cond)`生成器中，这将使您的主代码更具可读性。

也许更易读的方法是“累加器方法”（如果 compare() 的顺序无关紧要），例如：

```
others = []
for item in items:
    if some_cond(item):
        for other in others:
            compare(item, other)
        others = []
    else:
        others.append(item) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T13:46:05.647

使用 itertools.groupby 更好：

```
def h(lst, cond):
  remain = lst
  for last in (l for l in lst if cond(l)):
    group = itertools.groupby(remain, key=lambda x: x < last)
    for start in group.next()[1]:
      yield start, last
    remain = list(group.next()[1]) 
```

用法：lst = range(10) cond = lambda x: x%2 print list(h(lst, cond))

将打印

```
[(0, 1), (1, 3), (2, 3), (3, 5), (4, 5), (5, 7), (6, 7), (7, 9), (8, 9)] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T13:47:15.610

```
l = [j for j in items if some_cond]
for item, jump_item in zip(l, l[1:]):
    # do lots of stuff with item and jump_item 
```

如果 l = [j for j in range(10) if j%2 ==0] 则迭代结束：[(0, 2),(2, 4),(4, 6),(6, 8) ]。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-15T10:44:14.880

I have no idea what you're trying to do with that code. But I'm 99% certain that whatever it is could probably be done in 2 lines. I also get the feeling that the '==' operator should be an 'is' operator, otherwise what is the compare() function doing? And what happens if the item returned from the second jump_iter.next call also equals 'item'? It seems like the algorithm would do the wrong thing since you'll compare the second and not the first.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T10:46:34.157

You could put the whole iteration into a single try structure, that way it would be clearer:

```
jump_item_iter = (j for j in items if some_cond)
try:
    jump_item = jump_item_iter.next()
    for item in items:
        if jump_item is item:
            jump_item = jump_iter.next()

    # do lots of stuff with item and jump_item

 except StopIteration:
     pass 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-15T10:46:37.387

So you want to compare pairs of items in the same list, the second item of the pair having to meet some condition. Normally, when you want to compare pairs in a list use `zip` (or `itertools.izip`):

```
for item1, item2 in zip(items, items[1:]):
    compare(item1, item2) 
```

Figure out how to fit your `some_cond` in this :)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-15T11:31:25.703

您是否基本上试图将迭代器中的每个项目与原始列表中的每个其他项目进行比较？

在我看来，这应该只是使用两个循环的情况，而不是试图将它放入一个循环中。

```
 filtered_items = (j for j in items if some_cond)
for filtered in filtered_items:
    for item in items:
        if filtered != item:
            compare(filtered, item) 

```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-15T13:19:04.807

仅使用迭代器

```
def(lst, some_cond):
      jump_item_iter = (j for j in lst if som_cond(j))
      pairs = itertools.izip(lst, lst[1:])
      for last in jump_item_iter:
        for start, start_next in itertools.takewhile(lambda pair: pair[0] < last, pairs):
          yield start, last
        pairs = itertools.chain([(start_next, 'dummy')], pairs) 
```

输入： range(10) 和 some_cond = lambda x : x % 2 给出 [(0, 1), (1, 3), (2, 3), (3, 5), (4, 5), ( 5, 7), (6, 7), (7, 9), (8, 9)] （与您的示例相同）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-15T17:48:53.377

您可以将循环体编写为：

```
import itertools, functools, operator

for item in items:
    jump_item_iter = itertools.dropwhile(functools.partial(operator.is_, item), 
                                         jump_item_iter)

    # do something with item and jump_item_iter 
```

dropwhile 将返回一个迭代器，该迭代器将跳过所有符合条件的迭代器（此处为“ `is item`”）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-15T12:49:50.943

```
for i in range( 0, len( items ) ):
    for j in range( i+1, len( items ) ):
        if some_cond:
            #do something
            #items[i] = item, items[j] = jump_item 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-15T21:41:22.960

您可以执行以下操作：

```
import itertools

def matcher(iterable, compare):
    iterator= iter(iterable)
    while True:
        try: item= iterator.next()
        except StopIteration: break
        iterator, iterator2= itertools.tee(iterator)
        for item2 in iterator2:
            if compare(item, item2):
                yield item, item2 
```

但它非常复杂（实际上效率不高），如果你只是做了一个会更简单

```
items= list(iterable) 
```

然后只写两个循环`items`。

显然，这不适用于无限迭代，但您的规范只能在有限迭代上工作。

# qt - QAbstractItemModel.parent()，为什么？

> ID：867938
> 
> 赞同：9
> 
> 时间：2009-05-15T10:36:00.687
> 
> 标签：qt

我是（Py）Qt 新手，将 C# GUI 代码移植到 Qt 已经有几天了。我一直在问自己的一个问题是，为什么需要`QAbstractItemModel`子类来提供一种`parent()`方法，以及为什么它们需要在结果`QModelIndex`中提供父类中的子类？

这个要求迫使我在我的树数据上添加另一个层（因为我不想调用`indexOf(item)`，`parent()`它不会很有效）记住行索引。

我问这个是因为这是我第一次看到基于模型的视图需要这个。例如，`NSOutlineViewDataSource`在 Cocoa 中不需要这个。

奇趣科技的开发者是聪明人，所以我确信这是有充分理由的，我只是想知道是什么原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T17:17:44.653

快速的回答是，“他们当时认为最好。” Qt 开发人员就像你我一样——他们并不完美，他们确实会犯错误。他们从那次经验中吸取了教训，结果以[Itemviews-NG](http://blog.qt.io/blog/2008/10/24/itemviews-the-next-generation/)的形式出现在作品中。

用他们自己的话从上面的链接：

> 让我们说还有改进的空间，很大的空间！

通过提供包含行和列索引的父级，它们提供了一种实现树和支持导航的可能方式。他们可以很容易地使用更明显的图形实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T14:00:44.410

要求主要是支持树木。我无法告诉你原因，因为我不是 Qt 开发人员......我只使用这些东西。但是，如果你不做树，你可能会使用一个更优化的模型类，而不必处理提供父级的开销。我相信两者都可以`QAbstractListModel`自己`QAbstractTableModel`处理父部分，让您可以自由地担心您想要的数据。

对于树木，我怀疑他们需要父母的原因之一是他们试图继续只询问他们需要绘制的信息。在不知道树中所有项目的情况下（例如，如果它没有展开），提供给定项目在树中的绝对位置变得更加困难。

至于`indexOf(item)`在父函数中使用的困惑，您是否考虑过使用`QModelIndex`'s`internalId`或`internalPointer`？我假设它们在 PyQt 中可用......您的模型可以使用它们来跟踪有关索引的内容。您也许可以使用它来简化查找父索引的工作。

# command-line - 从批处理文件中解析引用的文本

> ID：867940
> 
> 赞同：3
> 
> 时间：2009-05-15T10:36:13.557
> 
> 标签：command-line, batch-file

我想在批处理文件中做一些简单的解析。

给定输入行：

```
Foo: Lorem Ipsum 'The quick brown fox' Bar 
```

我想提取引用的部分（不带引号）：

```
The quick brown fox 
```

仅使用 Windows XP 上可用的标准命令行工具。

（我看了看，`find`但`findstr`它们似乎不够灵活，不能只返回一行的*一部分*。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T12:03:24.767

像这样的东西会起作用，但前提是每行输入有一个带引号的字符串：

```
@echo OFF
SETLOCAL enableextensions enabledelayedexpansion

set TEXT=Foo: Lorem Ipsum 'The quick brown fox' Bar
@echo %TEXT%

for /f "tokens=2 delims=^'" %%A in ("abc%TEXT%xyz") do (
    set SUBSTR=%%A
)

@echo %SUBSTR% 
```

输出，中间带引号的字符串：

```
Foo: Lorem Ipsum 'The quick brown fox' Bar
The quick brown fox 
```

输出，前面引用的字符串：

```
'The quick brown fox' Bar
The quick brown fox 
```

输出，最后引用的字符串：

```
Foo: Lorem Ipsum 'The quick brown fox'
The quick brown fox 
```

输出，引用整个字符串：

```
'The quick brown fox'
The quick brown fox 
```

# iphone - iPhone内存问题？

> ID：867945
> 
> 赞同：0
> 
> 时间：2009-05-15T10:37:16.537
> 
> 标签：iphone, objective-c

我使用单个 UIImageView 对象，分配一次内存。但是多次更改图像名称。问题是，

A) 一个 UIImageView 对象，分配一次并且永远不会更改图像名称。例如 UIImageView *firstObj = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"blue.png"]];

B）另一个 UIImageView 对象，分配一次并多次更改图像名称

例如 UIImageView *secondObj = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"blue.png"]];

//更改图像名称一次，

secondObj.image = [UIImage imageNamed:@"green.png"];

```
 and so on.... 
```

哪些对象使用最大内存或使用相等内存？

以最低内存利用率使用 secondObj 的最佳方法是什么？

请简要解释一下，因为我需要在我的项目中使用图像数量，并且我想避免由于图像引起的内存问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T11:15:26.007

重新格式化您的代码，您的第二个示例是：

```
UIImageView *secondObj = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"blue.png"]];
// changed image name once
secondObj.image = [UIImage imageNamed:@"green.png"];
// and so on.... 
```

这段代码很好。当您将图像分配给 UIImageView 的实例时，它会将图像的保留计数增加一。如果图像已经被分配，它将首先释放它。

由于**[UIImage imageNamed:...]**将为您提供已标记为自动释放的对象，因此您可以继续分配图像，如示例中所示，没有内存泄漏。一旦 UIImageView 释放现有的图像，它将被自动释放池收集。

在最小化内存使用方面，**[UIImage imageNamed:...]**方法确实将图像存储在少量应用程序范围的缓存内存中，您不会对其施加任何直接控制。缓存确实有一个上限，但是你不能刷新它来回收内存，所以在你获取新的 UIImage 时使用它会增加你的内存占用。

您可能需要考虑通过使用**[UIImage imageWithData:...]**加载图像来避免此缓存，这在 Stackoverflow 问题**[[UIImage imageNamed...] vs [UIImage imageWithData...]](https://stackoverflow.com/questions/316236/uiimage-imagenamed-vs-uiimage-imagewithdata)**中进行了讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:52:39.727

我不是出色的 Objective-C 专家，但您在 B 中的使用看起来应该可以正常工作而不会泄漏。由于没有其他对象（除了 UIImageView）保留 UIImages，因此当它们在 UIImageView 中被替换时应该释放它们，并且垃圾收集器应该完成它的工作。

大卫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T11:11:43.893

使用 +imageNamed: 创建的 UIImage 是自动释放的，因此它会消失。举个例子：

```
UIImage *image1 = [UIImage imageNamed:@"blue.png"]; //image1 has retain count 1
[myImageView setImage:image1]; //image1 is retained by UIImageView so has retain count 2

//run loop ends, all auto released objects are released and image1 now has retain count 1

//Later in app

UIImage *image2 = [UIImage imageNamed:@"green.png"]; //image2 has retain count 1
[myImageView setImage:image2]; //image1 is released and now has retain count 0, so the memory is freed, image2 now has retain count 2 as it is retained 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T11:12:15.203

> 由于没有其他对象（除了 UIImageView）保留 UIImages，因此当它们在 UIImageView 中被替换时应该释放它们，并且垃圾收集器应该完成它的工作。

请记住，iPhone 上没有垃圾收集器。您可以在此处找到更多相关信息：
[StackOverflow：iPhone 应用程序是否支持垃圾收集？](https://stackoverflow.com/questions/416108/is-garbage-collection-supported-for-iphone-applicaions)

（这实际上应该是对戴维斯回答的评论，但我还没有足够的声誉）

# javascript - 如何为弹出窗口设置选项..例如大小

> ID：867946
> 
> 赞同：1
> 
> 时间：2009-05-15T10:37:23.307
> 
> 标签：javascript

我有以下功能来制作弹出窗口。

```
function makewindows(html){
child1 = window.open ("about:blank");
child1.document.write(html);
child1.document.close(); 
} 
```

它工作正常，但它会在 Firefox 中打开一个新选项卡。我想知道如何使它成为一个实际的弹出窗口，尺寸更小，与实际窗口分开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T10:42:02.967

```
window.open("example.html", "windowName",
            "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no"); 
```

有关详细信息，请参阅[MSDN window.open 文档](http://msdn.microsoft.com/en-us/library/ms536651(VS.85).aspx)或[Mozilla window.open 文档](https://developer.mozilla.org/En/Window.open)。

# c# - 我可以晚绑定到 C# 中的事件处理程序吗？

> ID：867948
> 
> 赞同：2
> 
> 时间：2009-05-15T10:37:30.373
> 
> 标签：c#, event-handling, late-binding

我正在动态创建对象并将它们插入到 html 表中，对象是标签或链接按钮，如果它们是链接按钮，我需要为点击事件订阅事件处理程序，但我正在努力寻找一种方法来实际添加处理程序。到目前为止的代码是：

```
WebControl myControl;

if _createLabel)
{
    myControl = new Label();
}
else
{
    myControl = new LinkButton();
}

myControl.ID = "someID";
myControl.GetType().InvokeMember("Text", BindingFlags.SetProperty, null, myControl,  new object[] { "some text" });

if (!_createLabel)
{
    // somehow do myControl.Click += myControlHandler; here
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T10:49:04.307

以下将起作用：

```
LinkButton lnk = myControl as LinkButton;
if (lnk != null)
{
    lnk.Click += myControlHandler;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T10:44:09.513

类似的东西会起作用。

[我的控制](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.aspx)。[获取类型（）](http://msdn.microsoft.com/en-us/library/system.object.gettype.aspx)。[获取事件（“点击”）](http://msdn.microsoft.com/en-us/library/system.type.getevent.aspx)。[AddEventHandler(myControl, myControlHandler)](http://msdn.microsoft.com/en-us/library/system.reflection.eventinfo.addeventhandler.aspx) ;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T10:46:35.280

这显示了将控件上的事件（按名称）绑定到当前实例上的方法（按名称）：

```
Button btn = new Button();
EventInfo evt = btn.GetType().GetEvent("Click");
MethodInfo handler = GetType().GetMethod("SomeHandler",
    BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance);
evt.AddEventHandler(btn, Delegate.CreateDelegate(
        evt.EventHandlerType, this, handler)); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-15T10:41:10.520

你可以简单地做：

Control.Event += new EventHandlerType(this.controlClick);

# php - 单个开发人员是否需要版本控制系统或代码存储库？

> ID：867949
> 
> 赞同：3
> 
> 时间：2009-05-15T10:38:01.540
> 
> 标签：php, svn

为什么我需要使用版本控制系统或存储库？我自己从头开始编写代码，并在相当大的项目上进行 Web 代码更改以及数据库更改。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T10:41:51.720

您不必这样做 - 但我发现它使开发变得更加容易。

它帮助了我

*   从我的程序中删除很多注释代码
*   回到旧版本（找出为什么它适用于旧版本而不适用于当前版本）
*   用我的备份策略

在学习曲线之后，我很确定你会喜欢它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T10:40:02.427

**绝对是**的——我过去经常自己编码，一个合适的版本控制系统在无数场合被证明是无价的。

另请参阅[不使用版本控制的好借口](https://stackoverflow.com/questions/132520/good-excuses-not-to-use-version-control)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T10:40:07.013

更改历史记录和标签（SVN 中的标签）无论如何都不会伤害您。该存储库还将保护您免受因错误代码编辑而导致的意外损失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T10:40:46.043

可能是因为它会为您提供通常有用的版本控制系统、应用程序的备份、可以使用的远程工作区。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T10:41:34.340

只是为了安全起见。时期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T10:41:54.450

因为当你写新东西的时候，意识到这是一场史诗般的失败，然后想要以最少的麻烦回到旧版本。

是的 - 它非常有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T10:42:06.447

版本管理可以通过多种方式完成，svn，带有日期状态的 zipfiles dd-mm-yyyy），地狱，甚至副本

我会推荐像 SVN/CVS/Sourcesafe 这样的版本管理工具，因为它可以帮助您了解您在何时以及为什么做了什么，并让您更好地控制您的代码（返回、分支/合并等）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T10:42:28.830

Of course. It will help you roll back to a previous version in case anything goes wrong :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T10:48:07.367

Yes, you definitely need source control. It'll help if you need to go back to a previous version or accidently edit/delete files.

I'd say Continuous Integration wouldn't hurt either ... even for a one person project.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-15T10:53:57.073

It helps me at least in the following cases:

*   Feel safe, e.g. if I accidentally remove a file (shit happens) I can just restore it
*   Backups are easy to do

Anyway, all the answers say "yes", so, I guess you have already made a decision.

# sql-server-2005 - 使用 SQL Server 2005 在表中插入仅日期和仅时间

> ID：867952
> 
> 赞同：1
> 
> 时间：2009-05-15T10:38:44.237
> 
> 标签：sql-server-2005

如何使用 SQL Server 2005 在表中仅插入日期和唯一时间（列数据类型为 DateTime）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T10:41:52.997

据我所知，日期和时间总是存储在一起。它的实习生表示是一个数字，表示从某个时刻开始经过的时间点。

您当然可以从中过滤日期信息和时间信息，并将其存储为例如字符串。

或者您可以创建一个用户定义的类型，如下所示：[http ://weblogs.sqlteam.com/jeffs/archive/2007/10/31/sql-server-2005-date-time-only-data-types.aspx](http://weblogs.sqlteam.com/jeffs/archive/2007/10/31/sql-server-2005-date-time-only-data-types.aspx)

# sql - SQL 子查询可以返回两个/更多值但仍与其中一个进行比较吗？

> ID：867965
> 
> 赞同：0
> 
> 时间：2009-05-15T10:41:12.220
> 
> 标签：sql, sql-server, database, sql-server-2000

我有这个查询：

```
SELECT Items.Name, tblBooks.AuthorLastName, tblBooks.AuthorFirstName
FROM Items WHERE Items.ProductCode IN (
SELECT TOP 10 Recommended.ProductCode
FROM 
Recommended 
INNER JOIN Stock ON Recomended.ProductCode = Stock.ProductCode
AND Stock.StatusCode = 1
WHERE (Recommended.Type = 'TOPICAL') ORDER BY CHECKSUM(NEWID())); 
```

这对我的数据来说很好，除了推荐表有一个我也需要的 SKU 字段但是我不能把它放在Recommended.ProductCode 旁边并且让查询仍然有效。
我已将 JOINS 用于此查询并且这些工作 - 但此查询运行得更快我只需要推荐表中的 ProductCode 和 SKU - 如何在不需要另一个子查询的情况下完成？
数据库：MS SQL Server 2000

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T11:00:51.877

子查询似乎在挑选 10 个随机建议。我认为您可以在没有子查询的情况下做到这一点：

```
SELECT TOP 10
    Items.*,
    Recommended.*,
    Stock.*
FROM Items 
INNER JOIN Recommended 
    ON Items.ProductCode = Recommended.ProductCode
    AND Recommended.Type = 'TOPICAL'
INNER JOIN Stock 
    ON Recomended.ProductCode = Stock.ProductCode
    AND Stock.StatusCode = 1
ORDER BY CHECKSUM(NEWID()) 
```

这使您可以访问所有列，而不必从子查询中传递它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:54:18.133

您只能使用子选择返回一个值，因此您必须通过连接从“推荐”表中获取字段 -​​ 我认为这是您已经拥有的：

```
选择 Items.Name、tblBooks.AuthorLastName、tblBooks.AuthorFirstName、Recommended.SKU
从项目
INNER JOIN 推荐 ON Recommended.ProductCode = Items.ProductCode
WHERE Items.ProductCode IN (
选择 TOP 10 推荐。产品代码
从
受到推崇的
INNER JOIN Stock ON Recomended.ProductCode = Stock.ProductCode
AND St​​ock.StatusCode = 1
WHERE (Recommended.Type = 'TOPICAL') ORDER BY CHECKSUM(NEWID()));

```

我猜，现实中的加入很可能也是外在的。只要您在 ProductCode 上同时拥有 Items 和 Recommended 表，这确实不应该有任何性能问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T10:58:46.373

我认为您需要将子查询移出 where 子句：

```
SELECT Items.Name, tblBooks.AuthorLastName, tblBooks.AuthorFirstName, R.SKU
FROM Items 
INNER JOIN 
   (SELECT TOP 10 Recommended.ProductCode, Recommended.SKU FROM Recommended 
   INNER JOIN Stock ON Recommended.ProductCode = Stock.ProductCode AND 
   Stock.StatusCode = 1 WHERE (Recommended.Type = 'TOPICAL') 
   ORDER BY CHECKSUM(NEWID())) 
AS Rec ON Items.ProductCode = Rec.ProductCode; 
```

以上是 MySQL 中的有效语法，您的里程可能会有所不同......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T11:00:03.687

在这种情况下，我通常会使用内部连接从我需要的 where 子句和额外的列中获取行过滤。像下面这样的东西；如果这是您所做的给您带来性能损失的操作，那么您可能需要翻转查询；从推荐和加入到项目；因为这可能会导致在加入之前进行更多的数据过滤。

```
SELECT Items.Name, tblBooks.AuthorLastName, tblBooks.AuthorFirstName
FROM Items 
Inner Join
(
SELECT TOP 10 Recommended.ProductCode, SKUID
FROM 
Recommended 
INNER JOIN Stock ON Recomended.ProductCode = Stock.ProductCode
AND Stock.StatusCode = 1
WHERE (Recommended.Type = 'TOPICAL')
) reccomended
on items.productcode - reccomended.ProductCode

ORDER BY CHECKSUM(NEWID() 
```

# regex - 使用VB .Net代码在HTML标签中查找图像url的正则表达式

> ID：867966
> 
> 赞同：0
> 
> 时间：2009-05-15T10:41:12.983
> 
> 标签：regex

我想从任何网站中提取图像 url。我正在通过 webRequest 阅读源信息。我想要一个正则表达式，它将从此内容中获取图像 url，即`<img>`标签中的 Src 值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-12T05:54:13.037

我建议使用 HTML 解析器来读取 html 并从中提取图像标签，因为正则表达式不能很好地与 xml 和 html 等数据结构相结合。

在 C# 中：（[来自这个 SO question](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser)）

```
 var web = new HtmlWeb();
    var doc = web.Load("http://www.stackoverflow.com");

    var nodes = doc.DocumentNode.SelectNodes("//img[@src]");

    foreach (var node in nodes)
    {
            Console.WriteLine(node.src);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T10:51:13.630

```
/(?:\"|')[^\\x22*<>|\\\\]+?\.(?:jpg|bmp|gif|png)(?:\"|')/i 
```

is a decent one I have used before. This gets any reference to an image file within an html document. I didn't strip " or ' around the match, so you will need to do that.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T11:02:38.690

尝试这个*：

```
<img .*?src=["']?([^'">]+)["']?.*?> 
```

[在这里](http://www.cuneytyilmaz.com/prog/jrx/)测试：

```
<img class="test" src="/content/img/so/logo.png" alt="logo homepage"> 
```

给

```
$1 = /content/img/so/logo.png 
```

$1（您必须将鼠标悬停在匹配项上才能看到它）对应于 () 之间的正则表达式部分。您如何访问该值将取决于您使用的正则表达式的实现。

*如果您想知道这是如何工作的，请发表评论

**编辑** 几乎总是与正则表达式一样，存在边缘情况：

```
<img title="src=hack" src="/content/img/so/logo.png" alt="logo homepage"> 
```

这将被匹配为“hack”。

# asp.net-mvc - 如何使用 Subsonic MVC 模板？

> ID：867967
> 
> 赞同：1
> 
> 时间：2009-05-15T10:41:28.460
> 
> 标签：asp.net-mvc, subsonic

我开始下载 MVC 模板，并使用该模板创建了一个新项目。我编译了应用程序，到目前为止一切正常。我的问题是，我在哪里可以找到生成 MVC DAL 的新 sonic.exe 文件？那是旧的sonic.exe吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T12:08:39.123

只要您不使用 Express，那么在您构建应用程序时就会创建这些类。有时这不起作用，您需要右键单击 Models/Classes.tt 并选择“运行自定义工具”。然后，您应该在 Classes.tt 文件下嵌套一个 Classes.cs 文件，并在其中定义 DAL 对象。

# c - 如何在c中将字符串转换为字符数组（或）如何提取单个char形式的字符串？

> ID：867979
> 
> 赞同：20
> 
> 时间：2009-05-15T10:43:34.227
> 
> 标签：c

我需要在 C 中将字符串转换为 char 数组；我怎样才能做到这一点？

或者至少，如何逐步从字符串中提取单个字符？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T10:46:57.027

在 C 中，字符串实际上存储为字符数组，因此“字符串指针”指向第一个字符。例如，

```
char myString[] = "This is some text"; 
```

通过将 myString 用作数组，您可以将任何字符作为简单 char 访问，因此：

```
char myChar = myString[6];
printf("%c\n", myChar); // Prints s 
```

希望这可以帮助！大卫

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T10:45:11.757

在 C 中，没有（真正的、不同类型的）字符串。每个 C“字符串”都是一个字符数组，以零结尾。

因此，要从字符串 your_string 中提取索引 i 处的字符 c，只需使用

```
char c = your_string[i]; 
```

索引以 0 为底（第一个字符是 your_string[0]，第二个是 your_string[1]...）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-28T16:53:01.947

以这种简单的方式

```
char str [10] = "IAmCute";
printf ("%c",str[4]); 
```

# sql-server - 还原 SQL Server 2005 数据库后将所有用户链接到登录

> ID：867986
> 
> 赞同：45
> 
> 时间：2009-05-15T10:45:09.527
> 
> 标签：sql-server, tsql, sql-server-2005

（请注意，此问题询问有关链接所有用户的问题，与可能的重复项询问有关链接单个用户的问题不同）

我希望在两台服务器之间移动数据库，我已经从第一台服务器备份了数据库，并在第二台服务器上进行了数据库恢复，到目前为止一切顺利。

然而，我们的应用程序使用了在数据库中定义的大量数据库用户。这些必须链接到主数据库中定义的登录。我已将数据库恢复到的服务器定义了所有登录名，但是它们有不同的 sid。

我不是 T-SQL 专家……

我认为`sp_change_users_login`是解决方案的一部分，但我不知道如何让它自动将恢复的数据库中的**所有**用户链接到同名的登录名。

我们用于应用程序的数据库创建脚本会创建用户和登录名，但是在创建登录名时它没有指定 SID，因此会出现这个问题。现在如果我有一台时光机...

（当我用谷歌搜索时，我得到了很多点击，但它们大多是那些不让你先在网站上注册就不会让你看到答案的网站。）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-15T10:55:57.287

是的，您可以通过执行以下操作来做到这一点：

```
EXEC sp_change_users_login 'Auto_Fix' , 'TheUserName'; 
```

但是，如果您的问题是我可以自动修复所有用户，那么这不会这样做。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-05-31T18:35:00.223

我想出了以下内容。它很好用，因为它向您展示了：

1.  当前所有孤立用户。
2.  哪些是固定的。
3.  哪些是无法修复的。

其他解决方案要求您事先知道孤立的用户名才能修复。

以下代码可以在将数据库还原到另一台服务器后调用的存储过程中运行。

**脚本：**

```
EXEC sp_change_users_login 'report'--See all orphaned users in the database.
DECLARE @OrphanedUsers TABLE
(
  IndexKey Int IDENTITY(1,1) PRIMARY KEY,
  UserName SysName,--nVarChar(128)
  UserSID  VarBinary(85)
)
INSERT INTO @OrphanedUsers
    EXEC sp_change_users_login 'report'

DECLARE @CRLF as nVarChar
    SET @CRLF = CHAR(10) + '&' + CHAR(13)--NOTE: Carriage-Return/Line-Feed will only appear in PRINT statements, not SELECT statements.
DECLARE @Sql as nVarChar(MAX)
    SET @Sql = N''
DECLARE @IndexKey as Int
    SET @IndexKey = 1
DECLARE @MaxIndexKey as Int
    SET @MaxIndexKey = (SELECT COUNT(*) FROM @OrphanedUsers)
DECLARE @Count as Int
    SET @Count = 0
DECLARE @UsersFixed as nVarChar(MAX)
    SET @UsersFixed = N''
DECLARE @UserName as SysName--This is an orphaned Database user.

WHILE (@IndexKey <= @MaxIndexKey)
  BEGIN
    SET @UserName = (SELECT UserName FROM @OrphanedUsers WHERE IndexKey = @IndexKey)
    IF 1 = (SELECT COUNT(*) FROM sys.server_principals WHERE Name = @UserName)--Look for a match in the Server Logins.
      BEGIN
        SET @Sql = @Sql + 'EXEC sp_change_users_login ''update_one'', [' + @UserName + '], [' + @UserName + ']' + @CRLF
        SET @UsersFixed = @UsersFixed + @UserName + ', '
        SET @Count = @Count + 1
      END
    SET @IndexKey = @IndexKey + 1
  END

PRINT @Sql
EXEC sp_executesql @Sql
PRINT   'Total fixed: ' + CAST(@Count as VarChar) + '.  Users Fixed: ' + @UsersFixed
SELECT ('Total fixed: ' + CAST(@Count as VarChar) + '.  Users Fixed: ' + @UsersFixed)[Fixed]
EXEC sp_change_users_login 'report'--See all orphaned users still in the database. 
```

**结果：**

![在此处输入图像描述](https://i.stack.imgur.com/QVyrP.png)

*注意：未修复的 4 个（在我上面的示例屏幕截图中）在数据库恢复到的目标服务器中没有相应的用户。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-22T09:24:18.413

如果：

```
EXEC sp_change_users_login 'Auto_Fix' , 'TheUserName'; 
```

不起作用，试试这个：

```
EXEC sp_change_users_login 'Auto_Fix', 'Username', NULL, 'p@ssword123' 
```

我在这里找到它：http: [//dbadiaries.com/using-sp_change_users_login-to-fix-sql-server-orphaned-users](http://dbadiaries.com/using-sp_change_users_login-to-fix-sql-server-orphaned-users)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T10:53:19.163

[我从Microsoft KB918992](https://support.microsoft.com/en-us/help/918992/how-to-transfer-logins-and-passwords-between-instances-of-sql-server)中找到了以下脚本- 在原始服务器上运行它，它将创建一个名为“sp_help_revlogin”的存储过程，该过程生成另一个脚本以在目标服务器上运行，创建具有相同密码和 sids 的所有用户帐户。为我们从 SQL2000 升级到 2008 创造了奇迹。

```
USE master
GO
IF OBJECT_ID ('sp_hexadecimal') IS NOT NULL
  DROP PROCEDURE sp_hexadecimal
GO
CREATE PROCEDURE sp_hexadecimal
    @binvalue varbinary(256),
    @hexvalue varchar(256) OUTPUT
AS
DECLARE @charvalue varchar(256)
DECLARE @i int
DECLARE @length int
DECLARE @hexstring char(16)
SELECT @charvalue = '0x'
SELECT @i = 1
SELECT @length = DATALENGTH (@binvalue)
SELECT @hexstring = '0123456789ABCDEF' 
WHILE (@i <= @length) 
BEGIN
  DECLARE @tempint int
  DECLARE @firstint int
  DECLARE @secondint int
  SELECT @tempint = CONVERT(int, SUBSTRING(@binvalue,@i,1))
  SELECT @firstint = FLOOR(@tempint/16)
  SELECT @secondint = @tempint - (@firstint*16)
  SELECT @charvalue = @charvalue +
    SUBSTRING(@hexstring, @firstint+1, 1) +
    SUBSTRING(@hexstring, @secondint+1, 1)
  SELECT @i = @i + 1
END
SELECT @hexvalue = @charvalue
GO

IF OBJECT_ID ('sp_help_revlogin') IS NOT NULL
  DROP PROCEDURE sp_help_revlogin 
GO
CREATE PROCEDURE sp_help_revlogin @login_name sysname = NULL AS
DECLARE @name    sysname
DECLARE @xstatus int
DECLARE @binpwd  varbinary (256)
DECLARE @txtpwd  sysname
DECLARE @tmpstr  varchar (256)
DECLARE @SID_varbinary varbinary(85)
DECLARE @SID_string varchar(256)

IF (@login_name IS NULL)
  DECLARE login_curs CURSOR FOR 
    SELECT sid, name, xstatus, password FROM master..sysxlogins 
    WHERE srvid IS NULL AND name <> 'sa'
ELSE
  DECLARE login_curs CURSOR FOR 
    SELECT sid, name, xstatus, password FROM master..sysxlogins 
    WHERE srvid IS NULL AND name = @login_name
OPEN login_curs 
FETCH NEXT FROM login_curs INTO @SID_varbinary, @name, @xstatus, @binpwd
IF (@@fetch_status = -1)
BEGIN
  PRINT 'No login(s) found.'
  CLOSE login_curs 
  DEALLOCATE login_curs 
  RETURN -1
END
SET @tmpstr = '/* sp_help_revlogin script ' 
PRINT @tmpstr
SET @tmpstr = '** Generated ' 
  + CONVERT (varchar, GETDATE()) + ' on ' + @@SERVERNAME + ' */'
PRINT @tmpstr
PRINT ''
PRINT 'DECLARE @pwd sysname'
WHILE (@@fetch_status <> -1)
BEGIN
  IF (@@fetch_status <> -2)
  BEGIN
    PRINT ''
    SET @tmpstr = '-- Login: ' + @name
    PRINT @tmpstr 
    IF (@xstatus & 4) = 4
    BEGIN -- NT authenticated account/group
      IF (@xstatus & 1) = 1
      BEGIN -- NT login is denied access
        SET @tmpstr = 'EXEC master..sp_denylogin ''' + @name + ''''
        PRINT @tmpstr 
      END
      ELSE BEGIN -- NT login has access
        SET @tmpstr = 'EXEC master..sp_grantlogin ''' + @name + ''''
        PRINT @tmpstr 
      END
    END
    ELSE BEGIN -- SQL Server authentication
      IF (@binpwd IS NOT NULL)
      BEGIN -- Non-null password
        EXEC sp_hexadecimal @binpwd, @txtpwd OUT
        IF (@xstatus & 2048) = 2048
          SET @tmpstr = 'SET @pwd = CONVERT (varchar(256), ' + @txtpwd + ')'
        ELSE
          SET @tmpstr = 'SET @pwd = CONVERT (varbinary(256), ' + @txtpwd + ')'
        PRINT @tmpstr
    EXEC sp_hexadecimal @SID_varbinary,@SID_string OUT
        SET @tmpstr = 'EXEC master..sp_addlogin ''' + @name 
          + ''', @pwd, @sid = ' + @SID_string + ', @encryptopt = '
      END
      ELSE BEGIN 
        -- Null password
    EXEC sp_hexadecimal @SID_varbinary,@SID_string OUT
        SET @tmpstr = 'EXEC master..sp_addlogin ''' + @name 
          + ''', NULL, @sid = ' + @SID_string + ', @encryptopt = '
      END
      IF (@xstatus & 2048) = 2048
        -- login upgraded from 6.5
        SET @tmpstr = @tmpstr + '''skip_encryption_old''' 
      ELSE 
        SET @tmpstr = @tmpstr + '''skip_encryption'''
      PRINT @tmpstr 
    END
  END
  FETCH NEXT FROM login_curs INTO @SID_varbinary, @name, @xstatus, @binpwd
  END
CLOSE login_curs 
DEALLOCATE login_curs 
RETURN 0
GO 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-07-09T05:31:59.407

**具有相应数据库名称的所有孤立用户详细信息的列表**

*简单的步骤*

* * *

```
 EXEC master.sys.sp_MSforeachdb ' USE [?]
    Select ''?'' 
      EXEC ?.dbo.sp_change_users_login   ''report'' ' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-04T19:28:33.437

我有一个不错的脚本，可用于从数据库用户创建登录名，我在搜索此脚本使用存储过程的问题后遇到了该脚本。您还可以在此网址 [http://www.sqlserveroptimizer.com/2011/08/how-to-script-logins-from-user-database-in-sql-server-20052008-r2/找到一些其他有用的脚本](http://www.sqlserveroptimizer.com/2011/08/how-to-script-logins-from-user-database-in-sql-server-20052008-r2/)

```
USE MyDatabaseName

DECLARE @login nvarchar(50)

DECLARE logins_cursor CURSOR FOR SELECT l.name FROM sys.database_principals u INNER JOIN sys.server_principals l ON u.sid=l.sid

OPEN logins_cursor FETCH NEXT FROM logins_cursor INTO @login

WHILE @@FETCH_STATUS = 0 BEGIN EXEC sp_help_revlogin @login FETCH NEXT FROM logins_cursor INTO @login END

CLOSE logins_cursor DEALLOCATE logins_cursor GO 
```

# php - International Fonts Display Issue with UTF-8

> ID：867990
> 
> 赞同：0
> 
> 时间：2009-05-15T10:46:07.963
> 
> 标签：php, unicode, encoding, utf-8, internationalization

We have developed a PHP-MySQL application in two languages - English and Gujarati. The Gujarati language contains symbols that need unicode UTF-8 encoding for proper display.

The application runs perfectly on my windows based localhost and on my Linux based testing server on the web.

But when I transfer the application to the client's webserver (linux redhat based), the Gujarati characters are not displayed properly.

I have checked the raw data from both the databases (on my webserver and on the client's webserver) - it is exactly the same. However the display is different. On my server the fonts are displayed perfectly, but when I try to access the client's copy of the app, the display of Guajarati font is all wrong.

Since I am testing both these installation instances from the same machine and the same browser, the issue is not of browser incompatability or the code. I believe that there is some server setting that needs to be done, which I am missing out.

Can you help please.

Thanks

Vinayak

**UPDATE**

Thanks. We have tried the apache and php settings suggestions given by the SO community members. But the problem remains.

To breakdown the issue we have looked at the different stages that the data is passing through.

The two databases (at the client's end and at at our end) are identical. There is no difference in them.

The next step in this app is that a query is run which recovers the data, creates an xml file and saves it.

This XML file is then displayed using a PHP page.

We have identified that the problem is that there is a difference in the XML file being created. The code used for creating the XML file is as below:

```
function fnCreateTestXML($testid)
{
    $objQuery = new clsQuery();
    $objTest = new clsTest();
    $setnames = $objQuery->fnSelectRecords("tbl_testsets", "setnumber", "");
    $queryresultstests = $objQuery->fnSelectRecords("tbl_tests", "", "");
    if($queryresultstests)
    {

        foreach($queryresultstests as $queryresulttest)
        {
            foreach($setnames as $setname)
            {
                //Creating Root node test and set its attribute 
                $doc = new DomDocument('1.0','utf-8');
                $root = $doc->createElement('test');
                $root = $doc->appendChild($root);
                //and so on

//Saving XML on the disk
                $xml_create = $doc->saveXML();
                $testname = "testsxml.xml";
                $xml_string = $doc->save($testname); 
```

Any ideas??

Thanks

Vinayak

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T11:07:08.663

由于您已声明它在您的开发环境中而不是在您的客户端上运行，因此您可能需要检查客户端 Apache 的[AddDefaultCharset](http://httpd.apache.org/docs/2.0/mod/core.html#AddDefaultCharset)并将其设置为 UTF-8（如果还没有的话）。（假设他们使用的是 Apache。）

我倾向于确保检查以下步骤

1.  PHP Header 以 UTF-8 格式发送
2.  元标记设置为 UTF-8（内容类型）
3.  存储设置为 UTF-8
4.  服务器输出设置为 UTF-8
5.  确保您的 php 代码文件以带有 BOM（字节顺序标记）的 UTF8 编码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T11:10:44.927

答案几乎肯定在于与网页一起发送的标头。为了诊断这样的问题，我发现安装 firefox 插件["Live HTTP Headers"](https://addons.mozilla.org/en-US/firefox/addon/3829)很有用。

安装该插件，然后打开它并从客户端的网络服务器和您自己的网络服务器重新加载页面。

您可能会看到您的网络服务器提供的页面具有标题：

```
Content-Type: text/html; charset=UTF-8 
```

而当由客户端网络服务器提供服务时，它会说：

```
Content-Type: text/html 
```

我建议解决此问题的方法是确保您明确设置标题以在应用程序的每个页面中指定 utf-8。然后，这将您的应用程序与客户端的未来配置更改隔离开来。

为此，请致电

```
header('Content-type: text/html; charset=utf-8'); 
```

在发送任何数据之前在每一页上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-07T06:51:15.653

请使用此元标记：meta http-equiv="Content-Type" content="text/html; charset=UTF-8"

确保在 php 中使用此代码：mysql_query ("set character_set_results='utf8'");

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T11:04:09.123

确保响应标头正确 - 内容类型应包含 UTF-8。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T11:04:47.420

检查客户端机器上数据库实例的字符集设置：

```
SHOW VARIABLES LIKE 'character_set%';
SHOW VARIABLES LIKE 'collation%'; 
```

在执行任何文本获取查询之前，请尝试执行：

```
SET NAMES utf8
SET CHARACTER SET utf8 
```

如果可行，您可能需要将以下内容添加到客户端计算机上的 my.cnf 中：

```
[mysqld]
collation_server=utf8_unicode_ci
character_set_server=utf8
default-character-set=utf8
default-collation=utf8_general_ci
collation-server=utf8_general_ci 
```

# c# - 我可以修改 [appname].exe.config 而无需手动读/写 XMl 吗？

> ID：867993
> 
> 赞同：4
> 
> 时间：2009-05-15T10:46:35.763
> 
> 标签：c#, .net

我使用 .NET 3.5 和 Visual Studio 2008 Express 在 C# 应用程序中创建了一些设置。我有许多应用程序范围的设置，我希望能够从应用程序中修改它们 - 我可以通过它们访问它们，`Properties.Settings.Default`但它们按预期只读。我不想让这些成为用户范围的设置，因为它们应该是应用程序范围的。如果不加载 XML 并自己读取/写入它，这是否可能？

我已经看到了使用的示例`System.Configuration.ConfigurationManager.OpenExeConfiguration`，但是配置 xml 的格式看起来与我正在使用的格式不同（这是来自旧版本吗？）

谢谢

* * *

**编辑**

我发现我可以修改这样做的值，但这似乎是一个荒谬的黑客行为。

```
Configuration config = ConfigurationManager.OpenExeConfiguration(Application.ExecutablePath);
SettingElementCollection settingElements = ((ClientSettingsSection)config.GetSectionGroup("applicationSettings").Sections[0]).Settings;

SettingElement element = settingElements.Get("SettingName");
element.Value.ValueXml.InnerText = "new value";

config.Save(ConfigurationSaveMode.Modified, true); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T10:57:00.403

[`OpenExeConfiguration`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.openexeconfiguration.aspx)（或任何其他`ConfigurationManager`方法）是对配置文件进行大多数修改的首选入口点。一旦你有了一个`Configuration`实例，你应该得到你想要修改的部分，并在修改后调用任何[`ConfigurationManager.Save`](http://msdn.microsoft.com/en-us/library/system.configuration.configuration.save.aspx)方法。但是，以这种方式检索该`applicationSettings`部分是不可能的。

没有用于更改文件`applicationSettings`部分中的设置的 API。`app.config`只能通过这种方式更改用户范围的设置。

所以实际上更改这些设置只能通过直接操作 app.config XML 文件来完成。

由于索引属性 from`Properties.Settings.Default`实际上是可写的，因此可能会出现一些混淆。以下是完全合法的：

```
Properties.Settings.Default["MySetting"] = "New setting value";
Properties.Settings.Default.Save(); 
```

但是，设置不会被保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T11:10:54.200

您还可以使用 Windows 注册表来存储特定于应用程序的状态。注册表中有每个用户和每个机器的密钥 - 您可以使用其中一个或两个。例如，有些人在退出时使用注册表来存储应用程序窗口的位置和大小。然后，当应用程序重新启动时，您可以根据上次已知的大小来定位和调整窗口大小。这是您可以在注册表中存储的那种状态的一个小例子。

为此，您将使用不同的 API 进行存储和检索。特别是 Microsoft.Win32.RegistryKey 类上的 SetValue 和 GetValue 调用。可能有一些库有助于将复杂状态保存到注册表。如果您有简单的案例（一些字符串和数字），那么您自己就可以轻松完成。

```
 private static string _AppRegyPath = "Software\\Vendor Name\\Application Name";

  public Microsoft.Win32.RegistryKey AppCuKey
  {
      get
      {
          if (_appCuKey == null)
          {
              _appCuKey = Microsoft.Win32.Registry.CurrentUser.OpenSubKey(_AppRegyPath, true);
              if (_appCuKey == null)
                  _appCuKey = Microsoft.Win32.Registry.CurrentUser.CreateSubKey(_AppRegyPath);
          }
          return _appCuKey;
      }
      set { _appCuKey = null; }
  }

  private void RetrieveAndApplyState()
  { 
      string s = (string)AppCuKey.GetValue("textbox1Value");
      if (s != null) this.textbox1.Text = s;

      s = (string)AppCuKey.GetValue("Geometry");
      if (!String.IsNullOrEmpty(s))
      {
          int[] p = Array.ConvertAll<string, int>(s.Split(','),
                           new Converter<string, int>((t) => { return Int32.Parse(t); }));
          if (p != null && p.Length == 4)
          {
              this.Bounds = ConstrainToScreen(new System.Drawing.Rectangle(p[0], p[1], p[2], p[3]));
          }
      }
  }

  private void SaveStateToRegistry()
  {
      AppCuKey.SetValue("textbox1Value", this.textbox1.Text);

      int w = this.Bounds.Width;
      int h = this.Bounds.Height;
      int left = this.Location.X;
      int top = this.Location.Y;

      AppCuKey.SetValue("Geometry", String.Format("{0},{1},{2},{3}", left, top, w, h);
  }

  private System.Drawing.Rectangle ConstrainToScreen(System.Drawing.Rectangle bounds)
  {
      Screen screen = Screen.FromRectangle(bounds);
      System.Drawing.Rectangle workingArea = screen.WorkingArea;
      int width = Math.Min(bounds.Width, workingArea.Width);
      int height = Math.Min(bounds.Height, workingArea.Height);
      // mmm....minimax            
      int left = Math.Min(workingArea.Right - width, Math.Max(bounds.Left, workingArea.Left));
      int top = Math.Min(workingArea.Bottom - height, Math.Max(bounds.Top, workingArea.Top));
      return new System.Drawing.Rectangle(left, top, width, height);
  } 
```

该代码使用 Microsoft.Win32.Registry.CurrentUser，因此它设置和检索用户特定的应用程序设置。如果要设置或检索计算机范围的状态，则需要 Microsoft.Win32.Registry.LocalMachine。

# c# - I am trying to save images in wpf application, but after saving some pink color is coming on that images. Is there any solution for that?

> ID：867997
> 
> 赞同：1
> 
> 时间：2009-05-15T10:47:09.490
> 
> 标签：c#, wpf, .net-3.5

I am developing a WPF application. In which I am trying to save images. After saving the image, the color balance of the image turns to light reddish. How can we retain the original color of image after saving also. Is there any solution for that.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T13:50:58.940

听起来这可能是因为您的源图像处于 CMYK 颜色模式，而您的输出处于 RGB 颜色模式。

您能否向我们提供有关源图像和输出图像的更多信息？*（颜色模式、图像格式等...）*

另外，你在做什么图像处理？*（调整大小，将位图保存为 jpeg 等...）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:52:28.183

I suspect you are saving images with transparency into a BITMAP format. Bitmaps do not support transparency as such, but usually use a colour replacement technology to give the illusion of transparency. The default colour for this is magenta I believe.

You might try saving the images either as PNG's, or perhaps there is a way to specify the transparency colour (I'm not sure).*******`*************************