# StackOverflow 问答 000895000-000895999

# asp.net - ASP.NET Active Directory 成员资格提供程序和 SQL 配置文件提供程序

> ID：895002
> 
> 赞同：17
> 
> 时间：2009-05-21T20:36:52.437
> 
> 标签：asp.net, active-directory, membership, provider

我目前正在为我正在从事的一个新项目设计会员/个人资料计划，我希望从其他人那里得到一些意见。

该项目是一个 ASP.NET Web 应用程序，由于时间短，我正在尝试使用所有内置的 .NET 框架组件。该网站可能会招待 < 5000 名用户。每个用户都有一个配置文件，其中自定义设置和对象将在访问之间保持不变。

我需要使用现有的 Active Directory 进行身份验证。由于 AD 架构无法扩展以保存新字段，因此我需要将用户设置和对象保存在不同的数据存储中。我还被告知 ADAM 可能不是一个可能的解决方案。

我希望将 Active Directory 成员资格提供程序用于我的身份验证方案，并将 SQL 配置文件提供程序用作用户配置文件数据存储。我不希望构建自定义配置文件提供程序，但如果需要，我认为这不会造成太大问题。

我想知道这是否甚至是一个可能的解决方案，如果是这样，是否有人对这种方法有任何运气。

任何意见将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T21:15:21.377

First off - I've never done this myself.

There's a really excellent series (14 !! parts) on the whole topic of ASP.NET 2.0 membership, roles and profile provider systems by Scott Mitchell at [4 Guys from Rolla](http://www.4guysfromrolla.com/articles/120705-1.aspx).

According to my understanding, you should be able to configure this behavior you are looking for by using basically these two sections in your web.config:

```
 <!-- configure Active Directory membership provider -->
  <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">
    <providers>
      <add name="AspNetActiveDirectoryMembershipProvider"
           type="System.Web.Security.ActiveDirectoryMembershipProvider, 
                 System.Web, Version=2.0.3600, Culture=neutral, 
                 PublicKeyToken=b03f5f7f11d50a3a" />
    </providers>
  </membership>

  <!-- configure SQL-based profile provider -->      
  <profile defaultProvider="SqlProvider">
    <providers>
      <add name="SqlProvider"
        type="System.Web.Profile.SqlProfileProvider"
        connectionStringName="SqlProfileProviderConnection"
        applicationName="YourApplication" />
    </providers>

    <!-- specify any additional properties to store in the profile -->   
    <properties>
      <add name="ZipCode" />
      <add name="CityAndState" />
    </properties>
  </profile> 
```

I would think this ought to work :-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-25T17:41:09.017

除此之外，正如 Marc 所回答的那样：

```
<add name="AspNetActiveDirectoryMembershipProvider"
           type="System.Web.Security.ActiveDirectoryMembershipProvider, 
                 System.Web, Version=2.0.3600, Culture=neutral, 
                 PublicKeyToken=b03f5f7f11d50a3a" /> 
```

您可能还需要添加

```
connectionStringName="ADService",
attributeMapUsername="sAMAccountName" 
```

带有相应的连接字符串

```
<connectionStrings>
    <add name="ADService" connectionString="LDAP://ServerIP" />
</connectionStrings> 
```

如果您使用的是 .net 4.0，则需要更换

```
Version=2.0.3600 
```

和

```
Version=4.0.0.0 
```

所以最后，

```
<membership defaultProvider="AspNetActiveDirectoryMembershipProvider">
      <providers>
        <add name="AspNetActiveDirectoryMembershipProvider"
             connectionStringName="ADService"
             type="System.Web.Security.ActiveDirectoryMembershipProvider, 
                 System.Web, Version=4.0.0.0, Culture=neutral, 
                 PublicKeyToken=b03f5f7f11d50a3a"
             attributeMapUsername="sAMAccountName"/>
      </providers>
    </membership> 
```

并且由于它被设置为默认值，因此可以将其引用为：

```
MembershipProvider provider = Membership.Provider; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-17T11:36:07.573

我正在使用 Visual Studio 2012 并尝试按照建议进行操作，但显示错误：

```
To call this method, the "Membership.Provider" property must be an instance of "ExtendedMembershipProvider". 
```

所以我发现应该对带有MVC 4和实体框架的VS2012上的默认登录表单进行一些更改，如下所示：

在文件“AccountController.cs”上

关于“公共 ActionResult 登录（LoginModel 模型，字符串 returnUrl）”

更改

```
 if (ModelState.IsValid && WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe)) 
```

为了

```
 if (ModelState.IsValid && Membership.Provider.ValidateUser(model.UserName, model.Password)) 
```

在“公共 ActionResult LogOff()”上

更改

```
 WebSecurity.Logout(); 
```

为了

```
 FormsAuthentication.SignOut(); 
```

并添加以下内容： FormsAuthentication.SetAuthCookie(model.UserName, false);

```
 public ActionResult Login(LoginModel model, string returnUrl)
    {
        if (ModelState.IsValid && Membership.Provider.ValidateUser(model.UserName, model.Password))
        {

            FormsAuthentication.SetAuthCookie(model.UserName, false);               

            return RedirectToLocal(returnUrl);
        }

        // If we got this far, something failed, redisplay form
        ModelState.AddModelError("", "The user name or password provided is incorrect.");
        return View(model);
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-25T15:18:33.200

感谢您的信息，它有很大帮助。`MembershipProvider provider = Membership.Provider;` 此外，您可以在成员标签中设置它，而不是设置默认提供者 。

`<membership defaultProvider="AspNetActiveDirectoryMembershipProvider">`

我还写了一个小方法并下载到配置为使用 AspNetActiveDirectoryMembershipProvider 的 Visual Studio 项目和源。

[基于 ASP.NET 表单的身份验证 - 使用 AspNetActiveDirectoryMembershipProvider](http://www.christowles.com/2011/04/aspnet-forms-based-authentication-with.html)

# java - Swing：从 JScrollPane 中定位弹出窗口

> ID：895005
> 
> 赞同：0
> 
> 时间：2009-05-21T20:37:49.033
> 
> 标签：java, swing, popup, jscrollpane

我有`JTable`一个`JScrollPane`. 我正在为表格的一列创建一个自定义单元格编辑器，我希望这个编辑器弹出一个滚动的`JList`. 我已经通过使用 a`Popup`来显示一个`JScrollPane`包含`JList`.

一切正常，除了`Popup`. 我的编辑器自定义组件基本上是这样的：

```
public class CustomPanel extends JPanel {
    JTextField text = new JTextField();
    JList list = new JList();
    JScrollPane scroll = new JScrollPane(list);
    Component owner = null;
    public CustomPanel(Component owner) {
        this.owner = owner;
        add(text);
    }
    public void showPopup() {
        Popup p = PopupFactory.getPopup(owner, scroll, getX(), getY()+getHeight());
        p.show();
    }
} 
```

正在发生的事情是`getX()`返回`getY()`表格单元格相对于持有它的 JScrollPane 的位置，并且`Popup`想要绝对屏幕位置。即使我传入它们相对`owner`的`JScrollPane`那个，它也不起作用。如果我使用`text.getX()`/ ，我会遇到同样的问题`text.getY()`。

我怎样才能把我的`Popup`直接放在下面`TextBox`？

更多背景知识：最终目标是一个多选组合框，它将所有选定的项目显示为逗号分隔的列表。如果其他类似的东西已经存在，请不要犹豫，指出我。

编辑：`owner.getLocationOnScreen().y + getY()`当滚动窗格在任何地方但一直向上滚动时不起作用。然而，只是简单`getLocationOnScreen().y`的工作。问题已解决，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T20:42:17.810

您可以使用 查询绝对屏幕位置[`Component.getLocationOnScreen()`](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#getLocationOnScreen())。那是你要找的吗？

# c# - 如何通过 WebDav 访问 Exchange 2007 公用文件夹？

> ID：895008
> 
> 赞同：0
> 
> 时间：2009-05-21T20:38:06.787
> 
> 标签：c#, .net, exchange-server, webdav

在 Exchange 2003 中，我可以通过 WebDav 通过类似于以下的 URL 连接到公用文件夹：

[https://mail.myserver.com/Public/My%20Public%20Folder/](https://mail.myserver.com/Public/My%20Public%20Folder/)

我试图在 Exchange 2007 中做同样的事情，但无法找出公用文件夹的正确 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T16:10:41.103

显然这不应该是那么困难。

即使 OWA 不使用相同的 URL，通过 WebDav 我也可以使用完全相同的 URL 架构。

例如：[https](https://mail.my2003server.com/Public/My%20Public%20Folder/) ://mail.my2003server.com/Public/My%20Public%20Folder/变成[https://mail.my2007server.com/Public/My%20Public%20Folder/](https://mail.my2007server.com/Public/My%20Public%20Folder/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:48:36.500

我最近在升级时遇到了同样的问题，不过是在 SBS 服务器上。由于 WebDAV 界面现在已“取消优先级”，因此需要一段时间才能完成，但是经过大量调试后，我发现了以下内容。

1.  OWA 身份验证现在位于 /owa 而不是 /exchange 中，您无法更改它。
2.  身份验证已更改为需要 NT 身份验证（我认为 OWA 身份验证）

这些问题并不是文件夹已更改位置的问题。就我而言，我更改了我的程序以纠正安全性，但是我认为更改了一些虚拟 Web 权限也给了我访问权限。

# mean - 如何根据票数/分数/样本/等计算平均值？

> ID：895009
> 
> 赞同：1
> 
> 时间：2009-05-21T20:38:09.190
> 
> 标签：mean, equation

为简单起见，假设我们有一组可能的分数 {0, 1, 2}。有没有一种方法可以根据分数的数量计算平均值，而无需进入毛茸茸的查找表等来计算 95% 的置信区间？

dreeves 在这里发布了一个解决方案：[如何根据可变数量的比赛计算公平的整体游戏得分？](https://stackoverflow.com/questions/280457/how-can-i-calculate-a-fair-overall-game-score-based-on-a-variable-number-of-match/281407#281407)

现在说我们有两种情况......

场景 A) 2 票值为 2 导致 SE=0 导致平均值为 2

场景 B) 10000 票值为 2 的结果为 SE=0，导致平均值为 2

由于投票数较少，我希望场景 A 的值小于 2，但似乎该解决方案无法处理该问题（当您的集合中的所有值不相等时，dreeve 的方程成立） . 我是否遗漏了什么，或者是否有另一种算法可以用来计算更好的分数。

我可用的数据是：

*   n（票数）
*   sum（总票数）
*   {一组投票}（所有投票值）

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T20:54:03.930

你可以在对结果进行排名时给它一个加权分数，而不是仅仅显示到目前为止的平均投票，通过乘以投票数的某个函数。

C# 中的一个示例（因为这是*我*碰巧最了解的......）可以很容易地翻译成您选择的语言：

```
double avgScore = Math.Round(sum / n);
double rank = avgScore * Math.Log(n); 
```

在这里，我使用了 的对数`n`作为加权函数——但它只有在投票数既不太小也不太大的情况下才有效。究竟有多大是“最佳”取决于您希望选票数量有多重要。

如果您喜欢对数方法，但 base`10`并不真正适用于您的投票计数，您可以轻松地使用另一个 base。例如，要在 base 中执行此操作`3`：

```
double rank = avgScore * Math.Log(n, 3); 
```

您应该使用哪个函数进行称重可能最好由您期望达到的票数的数量级决定。

您还可以通过定义使用自定义加权函数

```
double rank = avgScore * w(n); 
```

其中`w(n)`根据投票数返回权重值。然后`w(n)`，您可以根据需要定义，例如：

```
double w(int n) {
    // caution! ugly example code ahead...
    // if you even want this approach, at least use a switch... :P

    if (n > 100) { 
        return 10; 
    } else if (n > 50) {
        return 8;
    } else if (n > 40) {
        return 6;
    } else if (n > 20) {
        return 3;
    } else if (n > 10) {
        return 2;
    } else {
        return 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:26:01.870

如果您想在我的其他参考答案（谢谢！）中使用平均使用悲观下限的想法，那么我认为需要注入一些额外的假设/参数。

为了确保我理解：有 10000 张选票，每张选票都是“2”，你很确定真正的平均数是 2。如果有 2 张选票，每张选票都是“2”，你很不确定——也许有些0 和 1 会出现并降低平均值。但是如何量化，我认为是你的问题。

这里有一个想法：每个人都从一些“行李”开始：一个“1”的幻影投票。拥有 2 个真正的“2”票的人的平均票数为 (1+2+2)/3 = 1.67，其中拥有 10000 个真正的“2”票的人的平均票数为 1.9997。仅此一项就可以满足您的标准。或者加上悲观的下界想法，拥有 2 票的人的悲观平均得分为 1.333，拥有 10k 票的人的平均得分为 1.99948。

（为了绝对确保您永远不会遇到零标准错误的问题，请使用两个不同的幻影投票。或者也许使用尽可能多的幻影投票，因为有可能的投票值，每个值一票。）

# c# - WPF ComboBox...如何设置 .Text 属性？

> ID：895014
> 
> 赞同：10
> 
> 时间：2009-05-21T20:39:31.293
> 
> 标签：c#, wpf, visual-studio-2008, combobox

有没有办法直接设置`.Text`Wpf ComboBox 控件的属性？

我的组合框绑定到一个`List<T>`集合，但是当我尝试`.Text`在事件中设置属性时`DropDownClosed`，它完全忽略了它。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-21T20:50:10.337

如果您尝试将文本设置为列表中某个项目的文本，它应该可以正常工作。

如果您尝试将其设置为不在列表中的项目，则 IsEditable 属性必须为 true。如果您实际上不希望用户在组合框中输入内容，则可以将 IsReadOnly 属性设置为 true。

如果这些情况都不适合您，您可以发布您正在使用的代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-20T12:47:41.887

您还可以尝试添加一个 Visibility=Collapsed 的 ComboBoxItem，将该项目设置为选定项目并将其内容设置为所需的任何内容。

# sql - SQL多对多查询问题

> ID：895018
> 
> 赞同：5
> 
> 时间：2009-05-21T20:40:17.470
> 
> 标签：sql, mysql, many-to-many

我有三个表：视频、视频类别和类别。

表格如下所示：

```
videos: video_id, title, etc...
videos_categories: video_id, category_id
categories: category_id, name, etc... 
```

在我的应用程序中，我允许用户多选类别。当他们这样做时，我需要返回**每个选定类别**中的所有视频。

我最终得到了这个：

```
SELECT * FROM videos WHERE video_id IN (
    SELECT c1.video_id FROM videos_categories AS c1
    JOIN c2.videos_categories AS c2
    ON c1.video_id = c2.video_id
    WHERE c1.category_id = 1 AND c2.category_id = 2
) 
```

但是对于我添加到多选的每个类别，我都必须在我的内部选择中添加一个连接：

```
SELECT * FROM videos WHERE video_id IN (
    SELECT c1.video_id FROM videos_categories AS c1
    JOIN videos_categories AS c2
    ON c1.video_id = c2.video_id
    JOIN videos_categories AS c3
    ON c2.video_id = c3.video_id
    WHERE c1.category_id = 1 AND c2.category_id = 2 AND c3.category_id = 3
) 
```

我不禁觉得这是*真正错误*的方法，但我在试图看到正确的方法时被阻止了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T21:00:01.610

如果这是主键：

```
 videos_categories: video_id, category_id 
```

那么 GROUP BY 和 HAVING 应该可以工作，试试这个：

```
SELECT
    * 
    FROM videos 
    WHERE video_id IN (SELECT 
                           video_id
                           FROM videos_categories
                           WHERE category_id IN (1,2,3)
                           GROUP BY video_id
                           HAVING COUNT(video_id)=3
                      ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:44:33.857

这是一个 FOR XML PATH 解决方案：

```
--Sample data
CREATE TABLE Video
    (
    VideoID int,
    VideoName varchar(50)
    )

CREATE TABLE Videos_Categories
    (
    VideoID int,
    CategoryID int
    )

INSERT  Video(VideoID, VideoName)
SELECT  1, 'Indiana Jones'
UNION ALL
SELECT  2, 'Star Trek'

INSERT Videos_Categories(VideoID, CategoryID)
SELECT 1, 1
UNION ALL
SELECT 1, 2
UNION ALL
SELECT 1, 3
UNION ALL
SELECT 2, 1
GO

--The query
;WITH   GroupedVideos
AS
(
SELECT  v.*,
        SUBSTRING(
                    (SELECT  (', ') + CAST(vc.CategoryID AS varchar(20))
                    FROM     Videos_Categories AS vc
                    WHERE    vc.VideoID = v.VideoID
                    AND      vc.CategoryID IN (1,2)
                    ORDER BY vc.CategoryID
                    FOR XML PATH('')), 3, 2000) AS CatList
FROM    Video AS v
)

SELECT  *
FROM    GroupedVideos
WHERE   CatList = '1, 2' 
```

## （忽略下面的所有内容 - 我误读了这个问题）

尝试

```
WHERE c1.category_id IN (1,2,3) 
```

或者

```
...
FROM videos v
JOIN Vedeos_categories vc ON v.video_id = vc.video_id
WHERE vc.category_id IN (1,2,3) 
```

根本不需要多个连接。

编辑：将解决方案放在上下文中（我意识到这并不明显）：

```
SELECT * 
FROM videos 
WHERE video_id IN 
(    SELECT c1.video_id 
FROM videos_categories AS c1
WHERE c1.category_id = IN (1,2,3)) 
```

或者

```
SELECT *
FROM videos v
JOIN Vedeos_categories vc ON v.video_id = vc.video_id
WHERE vc.category_id IN (1,2,3) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:02:21.717

听起来类似于[SQL 搜索包含多个条件的行](https://stackoverflow.com/questions/863053/sql-searching-for-rows-that-contain-multiple-criteria/863377#863377)

为避免必须为每个类别进行另一个联接（并因此更改查询的结构），您可以将类别放入临时表中，然后针对该表进行联接。

```
CREATE TEMPORARY TABLE query_categories(category_id int);
INSERT INTO query_categories(category_id) VALUES(1);
INSERT INTO query_categories(category_id) VALUES(2);
INSERT INTO query_categories(category_id) VALUES(3);

SELECT * FROM videos v WHERE video_id IN (
  SELECT video_id FROM video_categories vc JOIN query_categories q ON vc.category_id = qc.category_id
  GROUP BY video_id
  HAVING COUNT(*) = 3
) 
```

当然，尽管这本身就很丑陋。您可能想跳过临时表并在子查询中说“category_id IN (...)”。

# c++ - 为什么我会收到“未引用的局部变量”警告？(C++)

> ID：895020
> 
> 赞同：2
> 
> 时间：2009-05-21T20:40:47.250
> 
> 标签：c++, variables, initialization

当我做类似的事情时

```
#include<iostream>
int main()
{
    int x;
    return 0;
} 
```

我收到关于 x 是未引用的局部变量的警告（我假设是因为我创建了一个变量，然后没有使用它），但为什么这会给我一个警告？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-21T20:43:45.590

因为通常人们不会故意创建未引用的变量。因此，如果程序中存在未引用的变量，通常表明您在某处存在错误，并且编译器会警告您。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-21T20:42:26.933

可能是因为你白白浪费内存。

此外，代码变得肮脏和难以理解，更不用说程序员通常不会定义他们不需要的变量，所以它有点像“这真的是你的意思吗？” 警告。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-21T20:48:35.080

可能会停止这样的事情：

```
void some_func() {
    int a, b, c, d, e;
    ...
    do_something_with(a);
    do_something_with(b);
    do_something_with(c);
    do_something_with(d);
    do_something_with(c); // after hours of reading code, e looks like c: BUG!!
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T21:46:00.083

顺便说一句，我在开发代码时偷偷地将未使用的变量作为一种快速'n'dirty的TODO机制......火焰消失了：

```
bool doSomething(...)
{
    int dontForgetToReplaceStubWithSomethingReal;
    return false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T20:46:27.457

它还可以让您知道，如果您*认为*您正在使用变量而不是您会发现。假设您创建变量是有原因的，也许您忘记在某处使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-11T20:26:04.627

或者，也许他们希望它的构造函数在作用域内产生副作用，而它的析构函数在作用域外产生另一个副作用，并且不希望编译器对人们最了解的意图如此“有帮助”别人的代码。

# visual-studio-2008 - VS2008 发布的 Crystal Reports 版本是什么？

> ID：895021
> 
> 赞同：1
> 
> 时间：2009-05-21T20:40:52.663
> 
> 标签：visual-studio-2008, crystal-reports

我想弄清楚我有什么版本的 Crystal Reports。它是 Visual Studio 2008 中的一个。有谁知道它是什么或者我该如何检查？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T20:45:07.070

Visual Studio 2008 Professional 包括 CR 2008 basic。

VS Basic 或 Express 没有 CR。

检查此[链接](http://aspalliance.com/1564_What_Visual_Studio_Developers_Should_Know_About_Crystal_Reports_2008.2)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:45:27.443

根据 EULA [在默认路径中找到] C:\Program Files\Microsoft Visual Studio 9.0\Crystal Reports\license.txt，它是*CRYSTAL REPORTS BASIC FOR MICROSOFT VISUAL STUDIO 2008*。我很确定这是版本 10 的一些变体。据我所知，这仅包含在专业和团队系统版本中。它不包含在 Visual Studio 2008 的基本版本中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-04T17:38:26.437

[以下是 Visual Studio .NET 版本支持哪些 Crystal Reports 程序集版本](http://wiki.scn.sap.com/wiki/display/BOBJ/Which+Crystal+Reports+assembly+versions+are+supported+in+which+versions+of+Visual+Studio+.NET)的完整列表：

```
 **CR Product Name         CR Assembly Version   VS .NET Supported Version   CR Install Configuration**                                                                                                                  
----------------------- --------------------- --------------------------- ------------------------------------------------------------------------------------------------------------------------------------------ 
 CR 9.1 for .NET 2002    9.1.3300.0            2002                        C:\Program Files\Common Files\Crystal Decisions\1.0\Bin                                                                                   
 CR 9.1 for .NET 2003    9.1.5000.0            2003                        C:\Program Files\Common Files\Crystal Decisions\1.0\Bin                                                                                   
 CR 9.2.x                9.2.3000.0            2002, 2003                  C:\Program Files\Common Files\Crystal Decisions\2.0\Bin                                                                                   
 CR 10.0.0.x             10.0.3300.0           2002, 2003                  C:\Program Files\Common Files\Crystal Decisions\2.5\Bin                                                                                   
 CR 10.2 for .NET 2005   10.2.3600.0           2005                        C:\Program Files\Business Objects\Common\2.7\Bin                                                                                          
 CR 10.5 for .NET 2008   10.5.3700.0           2008                        C:\Program Files\Business Objects\Common\2.8\bin                                                                                          
 CR 11.0.0.x             11.0.3300.0           2002, 2003                  C:\Program Files\Common Files\Crystal Decisions\3.0\Bin                                                                                   
 CR 11.5.0.x             11.5.3300.0           2002, 2003, 2005            C:\Program Files\Business Objects\Common\3.5\bin                                                                                          
 CR 12.0.0.x             12.0.1100.0           2002, 2003, 2005, 2008      C:\Program Files\Business Objects\BusinessObjects Enterprise 12.0\win32_x86                                                               
 CRVS2010                13.0.2000.0           2010                        C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86 
```

对于 Visual Studio 2008 的含义，您可能正在使用 Crystal Reports 版本 10.5 或 12

# usability - Web 应用程序的主页应该是什么？

> ID：895025
> 
> 赞同：4
> 
> 时间：2009-05-21T20:41:37.560
> 
> 标签：usability, web-applications, user-experience

设计一个Web应用程序，你如何设计*主页*？我的意思是在输入基本 URL 后向用户显示的页面，例如`http://www.foo.com`.

它可能取决于一个网站，但是......

*   stackoverflow 用一系列问题欢迎我们，不傻*，什么是 stackoverflow*登陆页面，
*   last.fm 呈现了一种*仪表板*，最近很流行，一种针对注册用户的个性化登陆页面
*   google 用搜索框欢迎我们，但*iGoogle*我完全不同的故事 - 每个人看起来都不同（嗯，这就是重点）。

另一件事是，如果用户已登录（前提是网站支持登录），我们是否应该在那里向他展示不同的内容，然后是一些新的、随机的收入者？我不是指一些个性化的内容，而是完全不同的东西，比如他的用户资料而不是主页？

从一个角度来看，这可能是件好事——注册用户通常都知道我们的网站，并且一旦他们回来就会得到一种特别的问候。另一方面，这可能会导致问题——当我向朋友展示一个网站时，他会从他的电脑上看到一些完全不同的东西。
另一件事是，当我`http://www.foo.com`向朋友展示时，它会将我直接带到我的用户个人资料/仪表板 - 这有时不是我想向所有人展示的，因为这可能会显示我的一些个人数据*等*.

当你设计你的 Web 应用程序时，你会做什么？在您看来，从用户的角度来看，我对注册用户和未注册用户的网站看起来不同的担忧是否有任何意义？（同样，我不是指*小*的差异，比如现在隐藏巨大的**寄存器**链接 - 但显示完全不同的视图）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:51:41.673

这实际上取决于您的应用程序的重点，但如果您要概括，我会说确定您的应用程序中的一两个最关键的路径并专注于那些。

*   注册可能是您最想推动的事情，因此请明确用户如何注册和参与。

*   让现有用户轻松登录。

*   考虑您在首页上的文字数量，并
    尽可能减少和配对。使您在此处传达的信息和信息尽可能简洁。

*   提供一些立即显示您的应用程序或站点提供的内容的内容。不要让用户点击链接以立即访问您网站的核心功能，例如，如果您正在构建拍卖网站，请确保首页上有列表。

*   考虑你的听众。如果您的网站是非技术性的，那么您呈现的 UI 元素越少越好。门户网站之类的网站，具有许多分隔的功能和信息，对于许多非技术用户来说可能会令人困惑和不知所措。

*   明确用户在需要时如何获得帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T16:36:40.043

在大多数情况下，访问您的页面的访问者已经知道您的应用程序的要点，因此不需要详细解释您在做什么。相反，向他们表明您拥有他们正在寻找的信息。如今，屏幕截图和截屏视频越来越流行，作为将其传达给注意力不集中的用户的一种方式。

对于注册用户，我建议将他们直接带到主应用程序页面而不是主页（除非主页是主应用程序页面）。对于许多应用程序来说，这是一个仪表板（Flickr、Basecamp、Campaign Monitor）。如果您的应用程序的主要焦点是主页，您可能希望向他们展示该页面的个性化版本（想想 Google 与 iGoogle）。

综上所述，这确实取决于您要构建的内容。每个应用程序都是不同的，并且没有*正确*的方法来做到这一点 - 只有适用于大多数人的约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T20:49:52.647

在不知道您网站的业务领域的情况下，回答这个问题会很棘手，但是......

您应该尽快让用户进入您网站的主流，而主页是这样做的最佳位置。

如果您是在线商店，请开始展示您的产品。如果你是一个搜索引擎，给用户搜索的能力。如果您是博客/新闻网站，请向用户展示最新消息。

是的 - 让登录/注册用户的体验更好（向他们展示他们的新闻，向他们展示他们推荐的产品等），但您网站的目的应该是显而易见的，并且可以从该主页访问。尽快让您的现有用户加入他们的流程，并通过向他们展示您网站的内容来吸引新用户进入您的网站。

有很多地方可以讨论良好的网页设计，让您的网站“有粘性”等。看看 SmashingMagazine.com（它就是这样一个网站），但还有很多其他的。

哦，请记住，您需要容纳一个非常重要的主页用户——搜索引擎。让他们的生活更轻松，使内容可被发现和可索引，并通过搜索将人们吸引到您的网站。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T20:57:10.727

我发现最适合我的是“角色扮演”最终用户的体验。

当他们最初访问您的网站时，他们最想看到什么，或者换句话说，他们最有可能在寻找和想要做什么？

我在一家非常大的公司的许多 Intranet 网站上工作，我了解到，一个包含网站详细信息及其功能的主页是无用的，因此，我的最终用户只是按顺序跳过它访问他们真正需要的页面。所以，我的策略通常包括一个主页，让他们可以直接进入业务以及他们在那里做的任何事情。

但是，这仅适用于我创建的网站。我认为这完全取决于您的目标市场以及他们想要做什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-01T13:51:59.737

我将首先查看可以在您的网络应用程序中执行的任务类型，什么是重要的？当他们是新用户时，什么是重要的？当他们是重复用户时，什么是重要的？当他们甚至还没有注册时，什么是重要的。

尽管所有这些事情都发生在同一个页面上，但您可能需要定义不同的状态。例如，如果用户在主页上但没有登录，我们是否应该提示他们登录和注册。

也许还可以查看[Personas](http://en.wikipedia.org/wiki/Personas)，这样您就可以准确地确定谁将使用该应用程序以及与他们相关的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T20:48:35.847

它应该是对应用程序有意义的任何东西，并且应该通过使用一组预期用户测试应用程序来验证这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T10:56:06.067

我知道人们讨厌 stackoverflow 上的这个答案，但只有一种方法可以找出最适合您的用户的东西是什么——您需要与潜在用户一起集思广益，或者至少询问他们。

我不是建议你做一个焦点小组，或者提出一个有缺陷的民意调查（这些都不管用）。相反，我建议你出去和可能在你的目标用户中的人交谈，并与他们一起规划游戏（比如卡片分类），或者出去用纸质原型做一些用户测试。

其他的都是猜测。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T20:52:32.250

主页应该为初次使用的用户提供足够的视觉和/或书面信息，以了解应用程序的内容。他们应该对可以采取哪些操作与应用程序交互以及这些操作的结果可能有所了解。

# javascript - Ajax：从不同的域加载 XML？

> ID：895045
> 
> 赞同：2
> 
> 时间：2009-05-21T20:45:25.557
> 
> 标签：javascript, ajax, cross-domain

我已经注册（付费）了 Google 网站搜索。他们为我提供了一种 Web 服务的 url，我可以在其中向它发送查询，它搜索我的网站，并返回搜索结果的 XML。好吧，我正在尝试通过 Ajax 从我网站上的页面加载此 XML，但我不能。我可以从我的域上的任何页面加载，所以我假设这是因为 XML 在 Google 的域上。所以必须有一种方法来加载它，但如果我不能用它做任何事情，我认为他们不会给我 URL 哈哈。有谁知道如何做到这一点？

谢谢！

**更新**：

这就是谷歌页面上给我 XML 的内容：

> 如何获取 XML
> 
> 您可以通过在此 URL 中将 query+terms 替换为您的搜索查询来为您的搜索引擎获取 XML 结果：
> 
> [http://www.google.com/cse?cx=MY_UNIQUE_KEY&client=google-csbe&output=xml_no_dtd&q=query+terms](http://www.google.com/cse?cx=MY_UNIQUE_KEY&client=google-csbe&output=xml_no_dtd&q=query+terms)

其中 MY_UNIQUE_KEY = 我的唯一键。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T21:17:14.260

您不能使用 AJAX 加载外部文件。但是，您可以在自己的服务器上设置一个文件，使内容在您的服务器上可用。例如在 PHP 中，您可以编写一个文件`googlexml.php`：

```
<?php
@readfile("http://www.google.com/cse?cx=MY_UNIQUE_KEY&client=googlecsbe&output=xml_no_dtd&q=query+terms");
?> 
```

然后您可以使用 AJAX 访问它。我不确定谷歌的使用条款是否会让你这样做，但如果他们这样做，那么这是一个选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:51:51.597

谷歌不提供将 DNS 地址转发到您服务的 IP 并将其折叠到您的域中的功能吗？这样你就可以在 AJAX 中做

```
googleAlias.mydomain.com 
```

谷歌应该支持这一点，但我不确定。我想他们会以与 GMail 和外部域邮件相同的方式。

删除您的跨域 javascript 问题

**编辑**我在下面展开，另一个用户很有帮助地指出这应该有效（感谢 Stobor）

好吧，如果我记得的话，为了让我的公司邮件进入 GMail，我需要将我的 DNS 上的 MX 记录更改为指向一个谷歌 IP。如果 google 支持，您可以将 A 记录添加到您的域，因此对 foo.yourdomain.com 的 AJAX 请求与 search.google.com 或其他任何内容相同。Google 需要识别 A 记录中来自您的主机名的请求，并说“哦，是的，那是我，代表我的客户”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-11T02:22:11.543

对于那些现在遇到这种情况的人来说，AJAX 搜索 API 可能就是您想要的：[http ://code.google.com/apis/ajaxsearch/documentation/](http://code.google.com/apis/ajaxsearch/documentation/)

编辑：实际上，经过进一步审查，这可能不会与网站搜索挂钩......

# c++ - 如何列出 COM 对象的上下文/公寓？

> ID：895047
> 
> 赞同：3
> 
> 时间：2009-05-21T20:45:47.130
> 
> 标签：c++, .net, debugging, com

我将 vs2008 调试器用于使用 .NET 程序集的 COM 对象的 C++ 项目。

我`'DisconnectedContext'`从托管调试助手那里收到一条消息，但我不知道哪个指针持有对错误 COM 对象的引用。

是否可以使用 Visual Studio 在线程中跟踪公寓/上下文？或者我至少可以保留为我的每个 COM 对象创建的运行时可调用包装器吗？

# javascript - jQuery：在不执行脚本的情况下解析/操作 HTML

> ID：895048
> 
> 赞同：4
> 
> 时间：2009-05-21T20:45:49.737
> 
> 标签：javascript, jquery, html, ajax

我正在通过 Ajax 以这种格式加载一些 HTML：

```
<div id="div1">
  ... some content ...
</div>
<div id="div2">
  ...some content...
</div>
... etc. 
```

我需要遍历响应中的每个 div 并单独处理它。将每个 div 的 HTML 内容映射到 id 的单独字符串将满足我的要求。但是，div 可能包含脚本标签，我需要保留但不执行（它们稍后会在我将 HTML 粘贴到文档中时执行，因此在解析期间执行会很糟糕）。我的第一个想法是做这样的事情：

```
// data being the result from $.get
var clean = data.replace(/<script.*?</script>/,function() {
    // insert some unique token, save the tag, put it back while I'm processing
}); 

$('<div/>').html(clean).children().each( /* ... process here ... */); 
```

但我担心一些愚蠢的开发人员会出现并在其中一个 div 中放入类似这样的内容：

```
<script> var foo = '</script>'; // ... </script> 
```

这会搞砸这一切。更不用说，整个事情一开始就感觉像是一个黑客攻击。有谁知道更好的方法？

编辑：这是我想出的解决方案：

```
var divSplitRegex = /(?:^|<\/div>)\s*<div\s+id="prefix-(.+?)">/g,
    idReplacement = preDelimeter+'$1'+postDelimeter;
var r = data.replace(<\/div>\s*$/,'').
    replace(divSplitRegex,idReplacement).split(preDelimeter);
$.each(r,function() {
    var content;
    if(this) {
        callback.apply(null,this.split(postDelimeter));
    }
}); 
```

其中 preDelimiter 和 postDelmeter 只是唯一的字符串，例如“###我必须是个白痴才能将此字符串嵌入我的内容中，因为它会破坏一切###'，而回调是一个期望 div id 和div 内容。这仅有效，因为我知道 div 将只有一个 id 属性，并且 id 将有一个特殊的前缀。我想有人可以在他们的内容中放置一个 id 具有相同前缀的 div，它会搞砸也起来。

所以，我仍然不喜欢这个解决方案。谁有更好的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T20:53:29.050

仅供参考，在任何 JavaScript 脚本中使用未转义会在浏览器中导致此问题。无论如何，开发人员都必须逃避它，所以没有任何借口。因此，您可以“信任”在任何情况下都会中断。

```
<body>
 <div>
   <script>
     alert('<script> tags </script> are not '+
         'valid in regular old HTML without being escaped.');
   </script>
</body> 
```

看

[http://jsbin.com/itevu](http://jsbin.com/itevu)

看到它打破。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-30T19:28:08.357

在某些情况下，删除脚本标签会导致无效的 html：

```
 <html>
    <head>
    </head>
    <body>
        <p>This should be
        <script type="text/javascript">
            document.writeln("<b");
        </script>>bolded</b>.
    </body>
 </html> 
```

# php - mod_rewrite 问题

> ID：895057
> 
> 赞同：0
> 
> 时间：2009-05-21T20:47:49.840
> 
> 标签：php, apache, mod-rewrite

我有以下规则：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !=/favicon.ico 
RewriteRule ^(.*)$ index.php?q=$1 [L,QSA] 
```

我的网址如下：

```
http://www.mydomain.com/189-9544737-0616922?%5Fencoding=UTF8&node=10 
```

在 myphp.php 上

```
var_dump($_GET): array(3) { 
  ["q"]=>  string(19) "185-8676848-3133633" 
  ["_encoding"]=>  string(4) "UTF8" 
  ["node"]=>  string(2) "10" } 
```

有任何想法吗？

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:53:54.883

尝试添加`B`修饰符：

> Apache 必须在映射 URL 之前对其进行转义，因此在应用反向引用时将对其进行转义。使用 B 标志，反向引用中的非字母数字字符将被转义。

```
RewriteRule ^(.*)$ index.php?q=$1 [B,L,QSA] 
```

# c++ - 如何 工作？(C++)

> ID：895058
> 
> 赞同：3
> 
> 时间：2009-05-21T20:48:06.313
> 
> 标签：c++, input, iostream

只是出于好奇，iostream 如何访问输入输出系统。（我有一个不断重新发明轮子的坏习惯，我想知道我是否可以为 iostream 之类的东西构建一个自定义输入输出系统）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T21:25:31.030

有关 IOstreams 的详细指南，请参阅[Standard C++ IOStreams and Locales](http://www.angelikalanger.com/iostreams.html)一书。读完之后，我怀疑你会满足于现状——IOStreams 可能是 C++ 标准库中最复杂的部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T20:51:22.393

这取决于...

它以某种方式与操作系统的本机 IO 系统交互。它可能在内部使用 C 库，该库使用对内核的系统调用，或者它可能直接使用系统调用。确切的实现高度依赖于平台。

很多人会说不要重新发明轮子，但这可能是一次很好的学习经历。如果您使用的是 Windows，请查看用于文件处理的 Win32 API 调用。如果你使用 Linux，要么使用 POSIX/C 库，要么使用系统调用（更难，我建议使用 C 库）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T21:10:04.103

你当然可以重新发明轮子。

流操作符处理国际字符集增加了很多复杂性。在相当深入地看了它之后，我真的不太在乎它。它非常复杂，完全破坏了任何轻松使用继承的机会。它可以工作并且可用。（我想改变它在转换过程中使用的存储行为）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T09:09:13.173

所有流都进入一个streambuf。该streambuf 将取决于流的类型。一个 ofstream 进入一个 fstreambuf；cout 转到一些未指定的流缓冲区。如果你想定制一些东西，cout 允许你获取这个 streambuf 并可能替换它。

一个常见的模式是“过滤流缓冲”，它是一个流缓冲接口，它在将其输入发送到另一个流缓冲之前对其进行转换。这可以与 cout 结合使用：取出原始流缓冲区，将其包装在过滤流缓冲区中，然后将该包装器放回 cout。您不需要知道原始流缓冲区是如何工作的。

# css - 有效的 CSS 还是 Hack？

> ID：895066
> 
> 赞同：3
> 
> 时间：2009-05-21T20:49:23.783
> 
> 标签：css

将其放在 CSS 文件的顶部：

```
* { margin: 0; padding: 0; } 
```

黑客？或有效的CSS？它有什么作用？以及如何移植到不同的浏览器/版本？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-21T20:51:47.790

这是有效的 CSS。它选择每个元素并重置默认边距和填充。人们使用它的原因是为了使他们的站点布局在不同的浏览器/版本之间更加一致，因为每个浏览器都有自己的默认样式表。如果您不使用此声明或为每个元素指定边距/填充，则每个浏览器都会为该元素使用其自己的默认边距/填充，并且页面将在不同浏览器中呈现不一致。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T20:52:30.207

根据[http://css-tricks.com/margin-0-padding-0-no-longer-cool/](http://css-tricks.com/margin-0-padding-0-no-longer-cool/)

这是“CSS 重置”理论的一部分。这消除了跨浏览器填充和边距的所有差异。渲染代理对文档中的每个元素应用规则非常繁重，尤其是对于大型网页，这也会破坏很多好的默认样式，特别是当你想要有默认样式的提交按钮时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T20:53:06.507

星号被称为[通用选择器](http://www.peachpit.com/articles/article.aspx?p=358552)，是有效的 CSS。它所做的就是将样式应用于页面中的*所有*元素。然而，它应该小心使用。就个人而言，我还没有发现它有很大的用处。重置所有元素的边距和填充是您可以对其他元素、元素组和类更具体（并且在我看来更好）的事情。

有关浏览器支持的详细信息，请参阅[此页面。](http://meyerweb.com/eric/articles/webrev/200006a.html)（请注意，它已经过时了，写于 2000 年；我想你可以期待现在所有流行的浏览器都得到全面支持。）

> Windows 和 Macintosh 的 Internet Explorer 5.x 以及 Mac 的 IE 4.5 和 Opera 3.6 都支持通用选择器。它还在所有可用的平台上的 Netscape 6 Preview Release 1 和 Opera 4 for Windows 的 Preview Release 3 中得到支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-15T23:11:47.633

这是：

*   有效的 CSS
*   不是真正的“黑客”
*   有点杂乱无章
*   反正可能不是你想要的

`*`是通用选择器。在[CSS 规范](http://www.w3.org/TR/CSS21/cascade.html#specificity "计算选择器的特异性")中，通用选择器的特殊性为 0000，这意味着每个其他选择器都具有更高的优先级。因此，这是一种以任何其他规则都能够覆盖的方式“重置”所有边距的方法。

请记住，这种方法会使您的列表变得一团糟。没有边距和填充，列表项不再缩进。一些规则确实是有益的，因为它们对通常不被认为需要样式的东西进行样式化。

通用选择器选择页面上的每一个元素。每一点`div`，每一点`li`，等等。事实上，它甚至会选择不是块级元素的东西，比如`a`and`span`和`head`。在许多情况下，这太过分了，而且在大页面上效率很低。

如果您正在寻找一种方法来重置 HTML 的默认样式，最好使用 Eric Meyer 的[Reset CSS](http://meyerweb.com/eric/tools/css/reset/)之类的东西。虽然重置 CSS 样式表要复杂得多，但它并不会因为选择每一个元素而过火。否则，只需将困扰您的每个元素的边距和填充清零即可。`body`（我总是在页面开始时将和的填充和边距归零`h1`。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T12:05:01.083

你有时会看到：

```
html * { margin: 0; padding: 0; } 
```

或者

```
body * { margin: 0; padding: 0; } 
```

在各种浏览器中的结果略有不同。只是需要注意的事情。

此外，还有一些不包含所有 HTML 元素的选择性重置 - 请参阅这篇[比较各种 CSS 重置的](http://www.kennycarlile.net/2008/06/19/yahoo-vs-eric-meyer-css-reset/)文章。

它不可能是 hack，因为它是有效且标准的 CSS。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T20:52:06.527

它是有效的 CSS，但从技术上讲，它可能被视为 hack。

基本上，它用于重置 HTML 中每个元素的边距和填充，因为不同的浏览器有时具有不同的默认值。使用此重置将确保所有元素都从一个共同点开始。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T20:53:16.540

它既有效又是骇客。但是，它不是特定于浏览器的。它的术语是“css重置”

正如 tf111 解释的那样，这个想法是摆脱浏览器特定的边距和填充设置，这些设置在所有浏览器中都不同

# c++ - C++ 中的动态源代码

> ID：895077
> 
> 赞同：4
> 
> 时间：2009-05-21T20:51:28.790
> 
> 标签：c++, dynamic, evaluation

如何在 C++ 中处理动态源代码？是否可以使用类似 eval("foo") 的东西？

我有一些函数需要根据用户的选择来调用：

```
 void function1 ();
     void function2 ();
     ...
     void functionN ();

     int main (int argv, char * argv [])
     {
         char * myString = new char [100];
         ...
         myString = "1" //user input            
         cout << eval("function"+myString)();
     } 
```

通常是怎么做的？

**UPD**：根据 slacy 和 clinisbut 的回答，我认为我需要创建一个函数注册表。我想它应该作为一个指向函数的指针数组。问题来了，如何声明一个指向函数的指针数组？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T21:14:47.617

你的问题的真正答案是这样的：

```
extern "C" {
void function1 ();
void function2 ();
void function3 ();
}

 int main (int argv, char * argv [])
 {
     char * myString = new char [100];
     ...
     myString = "function1"; //user input     

     void (*f)() = dlsym(RTLD_NEXT, myString);
     f();
 } 
```

您可以获得二进制文件中定义的函数（通过它的名称，如果它是用 extern "C" 声明的），然后调用它。

在 Windows 上，它变得更丑陋，但仍然可能 - 阅读 GetProcAddress

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-21T20:52:17.070

C++ 是一种编译语言，因此不存在“eval()”等价物。

对于您提到的特定示例，您可以创建一个函数注册表，将输入（字符串）映射到输出（函数指针），然后调用结果函数。

有几个可用的 C++ 解释器库，虽然性能会很差，但它们可能会完成你想要的。谷歌搜索“C++ 解释器”。我已经看到了“ [Ch](http://www.softintegration.com/) ”、“ [CINT](http://root.cern.ch/drupal/content/cint) ”和“clipp”的结果

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T20:54:20.653

如果你真的需要这个，你可以在你的程序中[嵌入一个 C/C++ 解释器。](http://en.wikipedia.org/wiki/Ch_interpreter)但是，您也可以[嵌入更类似于脚本的语言](http://en.wikipedia.org/wiki/Python_(programming_language))。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-21T21:00:04.823

要回答您通常如何做到这一点的问题，答案是：不是。

必须使用类似的东西`eval()`通常是一个设计问题。如果您确实需要它，请嵌入脚本语言，例如 Lua 或 Python。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-21T21:01:50.717

如果您将 function1 .. functionN 放入 DLL 中，您可以简单地将它们拉出并使用 dlopen/dlsym 按名称调用它们，这可能会为您提供 90% 的方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-22T09:18:47.367

函数指针呢？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-21T21:03:12.477

C++ 语言本身不能直接做到这一点。但是您可以根据用户输入（或其他）使用特定于平台的函数来调用给定 DLL 中的任何函数。例如，在 Windows 上，查找 GetProcAddress() 和 LoadLibrary()

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-21T21:19:28.933

这是嵌入解释语言（如 LUA）的一个很好的例子。如果您创建与 C++ API 的 LUA 绑定，您将能够通过应用程序中的 LUA 代码动态执行您的代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-11-27T23:37:00.940

有两种方法可以做到这一点：

1.  **动态加载**

    *   Windows：这给出了可执行文件的路径`GetModuleFileName()`。`hModule = NULL`用于`LoadLibrary(Executable_Name)`将自身加载到内存中。
    *   Linux：使用`dloopen()`with`NULL`并将其自身加载到内存中。

    在 Windows 和 Linux 中，您都可以定义一个`void* (function*)()`指针。这始终适用于所有没有参数的签名。这不适用于类方法。

2.  **使用命名空间系统**

    这个命名空间很容易，您可以使用`Inspect`功能和`InvokeMember`方法来动态调用类方法并从类内部访问变量。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-21T20:52:33.077

你不能在 C++ 中做到这一点。它是一种强制编译的语言。

无论如何，实现 eval() 所需的许多信息都会在运行时丢失。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T21:00:08.130

我将构建一个函数指针数组或 STL 列表，以及您找到的触发对它们的调用的字符串。如果你真的需要调用任意函数，你应该调查 RTTI [http://en.wikipedia.org/wiki/Run-time_type_information](http://en.wikipedia.org/wiki/Run-time_type_information)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-30T00:49:44.460

> 如何声明一个指向函数的指针数组？

**C程序员对这个问题的回答：**

使用 cdecl。

> cdecl> 将 functable 声明为指向函数的指针 (int,pointer to int) 返回双精度
> 
> 双 (*functable)(int , int *)
> 
> cdecl> 将 functable 声明为返回 double 的函数 (int) 指针的数组 17
> 
> 双 (*functable[17])(int)

请注意，函数会自动转换为指向函数的指针，就像数组衰减为指针一样。您不需要 & 来获取函数的地址以将其放入指针中。

如果您使用 C++，则使用 std::map< *YourFunctionPointerType* > 而不是数组可能会有所帮助，因为无论如何您都想映射字符串...

**OO方法：**

改用多态性。它不会立即解决您的问题，但是如果您这样做，则很有可能为每个函数设置一个类。

请注意，从根本上说，vtable 是一个指向函数的指针表。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-22T09:31:32.737

你想要的是[反射](http://en.wikipedia.org/wiki/Reflection_(computer_science))。C++ 默认不支持它，但是很多人已经为各种目的编写了全面的反射系统。我想到的一个是将 C++ 函数绑定到自定义脚本语言。

其他人提到使用 switch 语句（或更准确地说是 if/else 树）。这与可能出现的反射系统一样简单……它可能是您项目的最佳解决方案。C++ 中的反射是一种相当先进的技术，通常需要大量额外的代码……有时甚至需要自定义预处理器。

另请注意，出于安全目的， eval() 几乎绝不是您想在任何语言中使用的东西。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-03-09T05:43:54.467

在 C++ 应用程序中嵌入和评估代码的最佳方式可能是使用像 python 这样的脚本语言。使用[Boost.Python](http://www.boost.org/doc/libs/1_45_0/libs/python/doc/index.html)，“一个 C++ 库，可实现 C++ 和 Python 编程语言之间的无缝互操作性。”

# vb6 - Windows 2008 64 位版本上的 TAPI

> ID：895079
> 
> 赞同：6
> 
> 时间：2009-05-21T20:51:47.120
> 
> 标签：vb6, 64-bit, windows-server-2008, tapi

我有一个我支持的旧应用程序（用 VB6 编写），它与 TAPI 接口。最近，该应用程序安装在 Windows 2008 Server 64 位版本上。但是，用于 TAPI 安装的 TSP 驱动程序即使已安装，也会发出看似无害的警告。

但是，驱动程序（肯定是 32 位的）似乎没有被 Windows 2008 识别。我尝试点击控制面板的 32 位版本，但它也不存在。

所以问题是这样的：64 位系统上的 TAPI 是否需要 64 位驱动程序？如果是这种情况，我的 32 位应用程序能否使用 64 位 TAPI 驱动程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-16T15:46:34.067

第一个答案是非常错误的。TAPI 是一个 Windows API，每个现代版本的 Windows 都支持！当然它是原生支持的。该问题纯粹是 32 位/64 位问题。32 位进程不能调用 64 位进程，反之亦然。为了运行 TAPI 应用程序，您必须具有正确的 TSP。32 位应用程序需要 32 位 TSP。如果您有一个 64 位编译的应用程序，您将需要一个 64 位 TSP，或者可能需要一个 32 位 TSP，将其 UI 功能提取到单独的 dll 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T15:49:20.540

TAPI 在 64 位 Windows 中不受原生支持，尽管有一些方法可以解决这个问题。您可以在机器上运行 Virtual PC 32Bit 会话并使用它的 TAPI 支持，或者您可以尝试其中的第 3 方 TAPI 驱动程序之一。

这个适用于 32 位和 64 位系统：

[TAPI 驱动程序](http://wareseeker.com/download/demo-tapi-driver-3.1.rar/240160)

# c# - 泛型方法 - 代码重复

> ID：895081
> 
> 赞同：0
> 
> 时间：2009-05-21T20:51:49.333
> 
> 标签：c#, generics

我无法掌握通用方法。

我有两个生成的类（它们完全相同，但我无法对代码进行反应以使用相同的类对象）。

这是课程：

```
public class1 : SoapHttpClientProtocol {
    public partial class notificationsResponse {

        private ResponseType[] responsesField;

        private bool ackField;

        /// <remarks/>
        public ResponseType[] Responses {
            get {
                return this.responsesField;
            }
            set {
                this.responsesField = value;
            }
        }

        /// <remarks/>
        public bool Ack {
            get {
                return this.ackField;
            }
            set {
                this.ackField = value;
            }
        }
    }
}

public class2 : SoapHttpClientProtocol {
    public partial class notificationsResponse {

        private ResponseType[] responsesField;

        private bool ackField;

        /// <remarks/>
        public ResponseType[] Responses {
            get {
                return this.responsesField;
            }
            set {
                this.responsesField = value;
            }
        }

        /// <remarks/>
        public bool Ack {
            get {
                return this.ackField;
            }
            set {
                this.ackField = value;
            }
        }
    }
} 
```

如您所见，class1 和 class2 是相同的；而且由于它们是内联类，因此我必须重复。

除此之外，我正在尝试使用这些类类型作为参数调用更新方法：

```
 private void UpdateMessageResponses<T>(T results)
    {
        T responses = (T)results;

        foreach (var accts in results.Responses)
        {
            int row = GetRowIdByAccountId(accts.ObjectId);
            if (row != -1)
            {
                TestResultsGrid["Status", row].Value = String.Format("{0} {1} - {2} - {3}", accts.ResponseDate, accts.ObjectType, accts.Message, accts.ObjectId);
            }
        }
    } 
```

如何正确转换结果以便我可以访问结果属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T21:00:27.927

您需要为 Responses 属性定义一个接口，然后指定 T 必须实现该接口（并且您的类确实实现了该接口）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:58:11.847

我可能错了，但我认为你不能纯粹用泛型来做到这一点。唯一可能的方法是对泛型类型参数进行限制，但是由于您要访问的成员未在两个类通用的基类中声明，因此不幸的是，该选项被排除在外。

# php - 我如何在 mail() 中发送带有键和值的完整请求数组

> ID：895085
> 
> 赞同：0
> 
> 时间：2009-05-21T20:51:59.753
> 
> 标签：php

我有大表格，我想使用 php 在邮件中发送，虽然我可以用 request['name'] 发送它我必须在消息变量中写超过 50 次，我想做什么我如何添加密钥以及带有一些过滤的消息变量的值，我想省略提交请求变量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T21:12:54.003

I would make a copy of the variable, delete the `submit` element and then get the array declaration code with [`var_export`](http://docs.php.net/var_export):

```
$array = $_REQUEST;
unset($array['submit']);
$text = var_export($array, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:59:57.913

[http://php.net/filter_var_array](http://php.net/filter_var_array)可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:02:22.497

foreach 不正是这样做的吗？

```
foreach (filter_var_array($_REQUEST, ..) as $key => $value) {
    echo $key.' => '.$value."\n";
} 
```

当然不要忘记过滤数据本身。

# vb.net - 如何确定我在哪个控件中（vb.net cf）

> ID：895103
> 
> 赞同：0
> 
> 时间：2009-05-21T20:55:33.553
> 
> 标签：vb.net, compact-framework

我对动态运行时控件有疑问。

我为每条记录创建一组控件以显示在表单上。

我将记录 ID 作为标签添加到每个控件上，以识别它们属于哪个记录。

```
While rCONT.Read
    Dim txtphome As New TextBox
    txtphome.Name = "phone" + rCONT.Item("pcontID").ToString
    txtphome.Text = rCONT.Item("pcontPhHome").ToString
    txtphome.Tag = rCONT.Item("pcontID").ToString
    tcPatientDetails.TabPages(2).Controls.Add(txtphome)
       AddHandler txtphome.LostFocus, AddressOf SaveContactChange
       AddHandler txtphome.GotFocus, AddressOf SetContactNumber
End While 
```

在 SetContactNumber 我想保存标签值 如何识别触发它的控件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T20:59:49.847

假设您的 SetContactNumber 事件定义为：

**C＃**

```
 private void SetContactNumber(object sender, EventArgs e)
  {
      //Stuff that happens when the SetContactNumber event is raised...
  } 
```

**VB**

```
 Private sub SetContactNumber(sender As object, e As EventArgs)
      //Stuff that happens when the SetContactNumber event is raised
  End Sub 
```

*Sender*参数是引发事件的对象。所以你只需要转换它并将值附加到标签：

**C＃**

```
 ((textbox)sender).tag = "Whatever you wanted to put in here"; 
```

**VB**

```
 CType(sender, textbox).tag = "Whatever you wanted to put in here" 
```

tag 属性采用*object*类型的值，因此分配的值可以是您喜欢的任何值：字符串、对象、类的实例等。当您将其从 tag 属性中拉出以使用时，您有责任强制转换该对象它虽然。

因此，当您将它们放在一起时，这将拉出引发事件的对象，将其转换为文本框并将您指定的值转储到 tag 属性中。

**C＃**

```
 private void SetContactNumber(object sender, EventArgs e)
  {
      textbox thisTextbox = (textbox)sender;
      thisTextbox.tag = "Whatever you wanted to put in here";
  } 
```

**VB**

```
 Private Sub SetContactNumber(sender As Object, e As EventArgs)
      Dim thisTextbox As TextBox = CType(sender, Textbox)
      thisTextbox.tag = "Whatever you wanted to put in here"
  End Sub 
```

# sharepoint - Custom field type derived from SPFieldCalculated

> ID：895106
> 
> 赞同：1
> 
> 时间：2009-05-21T20:56:27.640
> 
> 标签：sharepoint, sharepoint-2007, moss

I am trying to create a custom field type which will display values based on another field in the same list. (basically, display some images based on the value of the source column)

Since this column derives it's data entirely on the basis of another column, i need to make sure the column values are not stored in the database.

So, i think i need to create a custom field type which derives from SPFieldCalculated class.

But, when i try to do so, I get an error message "The type 'Microsoft.SharePoint.SPFieldCalculated' has no constructors defined"

How do i create a custom field tpye deriving from SPFieldCalculated? If this is not possible, can somebody at least tell me how do i go about satisfying my requirement?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-16T20:08:12.077

In the fieltype xml you can add in the CAML of the template a LookupColumn. in you question you can use a field type text and in the DisplayPattern write something like this.

```
<RenderPattern Name="DisplayPattern">
    <HTML><![CDATA[<img src="]]></HTML>
      <LookupColumn Name="FileLeafRef" HTMLEncode="TRUE" />
    <HTML><![CDATA["/>]]></HTML>
</RenderPattern> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-28T10:32:54.740

Unfortunately it isn't possible to inherit from the SPCalculatedField class, which is why you are receiving that error: [http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldcalculated.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldcalculated.aspx)

> Windows SharePoint Services 3.0 does not support inheriting from this class.

In order to display an image based on another column's value in 2007 you're going to have to do some unpleasant CAML work in the fldtypes...xml (As @David A mentions). Here's a good place to start: [http://msdn.microsoft.com/en-us/library/aa544291.aspx](http://msdn.microsoft.com/en-us/library/aa544291.aspx)

I'm also going to innocently mention that there might be commercial alternatives with this functionality, one of which I might have helped create, and may have mentioned here: [Sharepoint webpart for conditional formatting?](https://stackoverflow.com/questions/2321128/sharepoint-webpart-for-conditional-formatting/5378035#5378035)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T23:35:34.400

Is there anything you want from SPFieldCalculated that SPField doesn’t have? I would solve the problem by making a custom field based on SPField, then I would either:

1 Register an event receiver in the field editor and use it to set the value of the field.

or

2 If you want to preview the value in edit/new forms, calculate the value in the field control. This requires your field to be ordered below the fields you base your value on, otherwise you will end up calculating your value based on old data.

I would also recommend you to save your calculated value instead if recalculating it. This is the only reasonable way if you want to display the data in a lists view, since you write the render pattern in CAML, not C#.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T04:22:12.507

You may actually get more mileage from creating a [custom view style](http://msdn.microsoft.com/en-us/library/dd583132.aspx) for the list(s).

This would allow you to completely change the way the column displays html-wise, without needing to add a calculated field.

Alternativley you could also consider that it is possible to do some very funky things with a custom field definition just in the schemaxml. As an example I include the schema xml for one of the "name" fields in an ordinary publishing pages library.

```
<Field ID="{9d30f126-ba48-446b-b8f9-83745f322ebe}" ReadOnly="TRUE" Type="Computed" Name="LinkFilenameNoMenu" DisplayName="Name" DisplayNameSrcField="FileLeafRef" Filterable="FALSE" AuthoringInfo="(linked to document)" SourceID="http://schemas.microsoft.com/sharepoint/v3" StaticName="LinkFilenameNoMenu" FromBaseType="TRUE"><FieldRefs><FieldRef Name="FileLeafRef" /><FieldRef Name="FSObjType" /><FieldRef Name="Created_x0020_Date" /><FieldRef Name="FileRef" /><FieldRef Name="File_x0020_Type" /><FieldRef Name="ContentTypeId" /><FieldRef Name="PermMask" /><FieldRef Name="CheckoutUser" /><FieldRef Name="IsCheckedoutToLocal" /></FieldRefs><DisplayPattern><IfEqual><Expr1><LookupColumn Name="FSObjType" /></Expr1><Expr2>1</Expr2><Then><FieldSwitch><Expr><GetVar Name="RecursiveView" /></Expr><Case Value="1"><LookupColumn Name="FileLeafRef" HTMLEncode="TRUE" /></Case><Default><SetVar Name="UnencodedFilterLink"><SetVar Name="RootFolder"><HTML>/</HTML><LookupColumn Name="FileRef" /></SetVar><SetVar Name="FolderCTID"><FieldSwitch><Expr><ListProperty Select="EnableContentTypes" /></Expr><Case Value="1"><Column Name="ContentTypeId" /></Case></FieldSwitch></SetVar><FilterLink Default="" Paged="FALSE" /></SetVar><HTML><![CDATA[<A onfocus="OnLink(this)" HREF="]]></HTML><GetVar Name="UnencodedFilterLink" HTMLEncode="TRUE" /><HTML><![CDATA[" onclick="javascript:EnterFolder(']]></HTML><ScriptQuote NotAddingQuote="TRUE"><GetVar Name="UnencodedFilterLink" /></ScriptQuote><HTML><![CDATA[');return false;">]]></HTML><LookupColumn Name="FileLeafRef" HTMLEncode="TRUE" /><IfEqual><Expr1><GetVar Name="ShowAccessibleIcon" /></Expr1><Expr2>1</Expr2><Then><HTML><![CDATA[<img src="/_layouts/images/blank.gif" class="ms-hidden" border=0 width=1 height=1 alt="]]></HTML><HTML>Use SHIFT+ENTER to open the menu (new window).</HTML><HTML><![CDATA[">]]></HTML></Then></IfEqual><HTML><![CDATA[</A>]]></HTML></Default></FieldSwitch></Then><Else><HTML><![CDATA[<A onfocus="OnLink(this)" HREF="]]></HTML><Field Name="ServerUrl" URLEncodeAsURL="TRUE" /><HTML><![CDATA[" onclick="return DispEx(this,event,']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ServerProperty Select="HtmlTransform" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ServerProperty Select="HtmlTrAcceptType"><Column Name="File_x0020_Type" /></ServerProperty></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ServerProperty Select="HtmlTrHandleUrl"><Column Name="File_x0020_Type" /></ServerProperty></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ServerProperty Select="HtmlTrProgId"><Column Name="File_x0020_Type" /></ServerProperty></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ListProperty Select="DefaultItemOpen" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><MapToControl><Column Name="HTML_x0020_File_x0020_Type" /><HTML>|</HTML><Column Name="File_x0020_Type" /></MapToControl></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><Column Name="HTML_x0020_File_x0020_Type" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ServerProperty Select="GetServerFileRedirect"><Field Name="ServerUrl" /><HTML>|</HTML><Column Name="HTML_x0020_File_x0020_Type" /></ServerProperty></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><Column Name="CheckoutUser" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><UserID AllowAnonymous="TRUE" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><ListProperty Select="ForceCheckout" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><Field Name="IsCheckedoutToLocal" /></ScriptQuote><HTML><![CDATA[',']]></HTML><ScriptQuote NotAddingQuote="TRUE"><Field Name="PermMask" /></ScriptQuote><HTML><![CDATA[')">]]></HTML><UrlBaseName HTMLEncode="TRUE"><LookupColumn Name="FileLeafRef" /></UrlBaseName><IfEqual><Expr1><GetVar Name="ShowAccessibleIcon" /></Expr1><Expr2>1</Expr2><Then><HTML><![CDATA[<img src="/_layouts/images/blank.gif" class="ms-hidden" border=0 width=1 height=1 alt="]]></HTML><HTML>Use SHIFT+ENTER to open the menu (new window).</HTML><HTML><![CDATA[">]]></HTML></Then></IfEqual><HTML><![CDATA[</A>]]></HTML><IfNew Name="Created_x0020_Date"><HTML><![CDATA[<IMG SRC="/_layouts/1033/images/new.gif" alt="]]></HTML><HTML>New</HTML><HTML><![CDATA[">]]></HTML></IfNew></Else></IfEqual></DisplayPattern></Field> 
```

Nasty, but potent.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T21:01:53.527

Well afraid I've not tried making custom fields before.. however I have a suggestion that might work. The field could be simply a picture field. You could use an event receiver on the list that calculates the required field whenever the target field changes. Bit of a long winded way round but if you don't get the custom field way to work, this might.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T21:51:33.347

Assuming this column is really only meant to be displayed there are two ways I can think of that might help:

1.  Use the calculated column to create HTML and then JavaScript to "turn it on": [http://pathtosharepoint.wordpress.com/2008/09/01/apply-color-coding-to-your-sharepoint-lists/](http://pathtosharepoint.wordpress.com/2008/09/01/apply-color-coding-to-your-sharepoint-lists/)
2.  You could probably do this with SharePoint Designer and the DataForm webpart: [http://masteringsharepoint.com/blogs/beagle/archive/2008/08/13/DFWP1.aspx](http://masteringsharepoint.com/blogs/beagle/archive/2008/08/13/DFWP1.aspx)

# asp.net - ASP.NET 中的 iPhone Web 应用程序开发 - 从哪里开始？

> ID：895107
> 
> 赞同：7
> 
> 时间：2009-05-21T20:56:43.333
> 
> 标签：asp.net, iphone, asp.net-mvc

对于 ASP.NET 中的 iPhone Web 应用程序开发，我从哪里开始？

我正在考虑使用 ASP.NET MVC，但我该如何开始呢？有什么奇怪的警告我应该注意的吗？

看起来这些可能是很好的资源：

*   [混合：使用 ASP.NET MVC 和移动浏览器定义文件的移动网站](http://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx)
*   [使用 ASP.NET MVC 震撼 iPhone](http://www.aaronlerch.com/blog/2008/06/08/rock-the-iphone-with-aspnet-mvc/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T08:47:31.703

我用过 BlackBaud iPhone Simulator 和 iUi。通过在 iPhone 上访问它，您可以在 NerdDinner.com 应用程序中实时看到它。我有[一篇关于如何在此处进行移动 ASP.NET MVC 开发的文章](http://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:13:07.373

I highly recommend the second link, ASP.NET MVC and iUI make things pretty easy.

Our first pass at developing apps for the iPhone took forever trying to get everything looking pretty, but those tools make things pretty simple.

We did run into a problem pretty quick though where the size of the site outgrew the simplicity of MVC, so we implemented this ["areas" concept from Phil Haack's blog](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx). That made our site pretty scalable.

Also, TEST WITH SAFARI. If you try to develop for IE or FireFox you'll end up recoding the whole thing so it looks nice on the iPhone.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:13:15.047

I do things for myself for iPhone in ASP.Net and so far the most important trick for me was setting the viewport meta tag to the width of the screen if the page is accessed by iPhone.

This article [link text](http://dotnetslackers.com/articles/aspnet/DevelopingForTheiPhone.aspx) also describes some other little neat tricks, but I did not need any of that for my particular applications.

# visual-studio-2008 - 如何将 Access 报表转换为 Crystal 报表？

> ID：895109
> 
> 赞同：1
> 
> 时间：2009-05-21T20:56:53.067
> 
> 标签：visual-studio-2008, ms-access, crystal-reports

我有 Access 2003 和 Crystal Reports 10（VS2008 Pro 附带的那个）。如何将访问报表转换为 Crystal Reports？它不必是完美的，只要能减轻我的负担即可。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T21:45:26.107

也许[http://www.access2crystal.com/](http://www.access2crystal.com/)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T01:04:52.703

我们的 AccessToCR 可以帮助您将 Access 报表转换为 Crystal Reports。我们的网址是[http://www.microtools.us/](http://www.microtools.us/)。

# jquery - 你最喜欢 jQuery 的哪个特性？

> ID：895110
> 
> 赞同：9
> 
> 时间：2009-05-21T20:56:55.470
> 
> 标签：jquery

前几天我刚刚获得了 jQuery 顿悟，但仍然觉得其中有很多我没有利用的力量。

也就是说，您最喜欢 jQuery 的哪个功能可以节省您的时间和/或使您的客户端应用程序更酷或更强大？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-21T21:16:11.017

我最喜欢 jQuery 的特性是它帮助 JavaScript 在一夜之间从一种讨厌的语言变成了一种性感的语言。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-22T00:30:46.287

**创建一个 HTML 元素并保留一个引用：**

```
var newDiv = $('<div></div>');
newDiv.attr("id","myNewDiv").appendTo("body");
//Now whenever I want to append the new div I created, 
//I can just reference it from the 'newDiv' variable 
```

**检查元素是否存在：**

```
if ($("#someDiv").length) {
    //it exists...
} 
```

**编写自己的选择器：**

```
$.extend($.expr[':'], {
    over100pixels: function(a) {
        return $(a).height() > 100;
    }
});

$('.box:over100pixels').click(function() {
    alert('The element you clicked is over 100 pixels high');
}); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-22T00:35:37.307

不必（尽可能多地）担心不同浏览器之间的兼容性

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-21T20:59:55.760

[选择器](http://docs.jquery.com/Selectors)和链接。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-21T21:00:59.953

**连锁！** 巨大的 jQuery 链是惊人的。有时我停不下来。感觉就像在一条线上做所有事情（你想，不要否认）。

```
this.lasso = $('<div/>')
    .css({ position: 'absolute', overflow: 'hidden' })
    .addClass('ui-crop-lasso')
    .hide()
    .appendTo('body')
    .resizable({
        handles: 'all',
        start: setLasso,
        stop: setLasso,
        resize: setLasso,
        minHeight: 50,
        minWidth: 50
    })
    .draggable({
        containment: el,
        cursorAt: 'move',
        drag: setLasso
    }); 
```

试试看，你很快就会上瘾。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-21T21:06:06.823

插件系统令人难以置信。从技术上讲，您可以并且仍然是一个完整的 JQuery 新手，并且仍然可以通过应用插件来利用它的大部分（如果不是全部）功能。这使得它非常受艺术家和非程序员的欢迎，他们只是希望添加工具提示、模式对话框、灯箱、下拉菜单等。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-22T18:25:38.100

我喜欢 jQuery 从 HTML 中删除事件处理程序以将内容与行为分开的方面。而不是写

```
<p class="active" onclick="myFunction()">foo</p> 
```

在网页上多次，我可以这样写：

```
<p class="active">foo</p> 
```

并在我的脚本标签中写一次：

```
$(".active").click(function(){ ... }); 
```

为什么我更喜欢这个？因为 jQuery 将内容与功能分开，就像 CSS 将内容与样式分开一样。正如 Jan Zich 和其他人所提到的，jQuery 使许多功能非常容易为任何浏览器编程，因此，例如，当您想要模拟在页面上为用户显示/隐藏 div 的选项卡时，动画变得轻而易举。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-21T21:01:53.293

jQuery 对象的工作方式与其中没有、一个或多个 DOM 元素无关。

此外，事件处理很重要。能够在点击事件上返回 false，例如，rocks。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-21T21:34:31.010

作为 jQuery 的新手，它必须是[jQuery UI](http://jqueryui.com/)插件，以及人们为它设计的主题。[ThemeRoller](http://jqueryui.com/themeroller/)可让您在 Firefox 中显示应用程序时快速调整主题并播放“假设”场景。从根本不了解 jQuery 开始，我能够在一两天内通过使用选项卡、手风琴滑块、日期选择器和警报来极大地改进 Web 应用程序。

更有经验的 Web 开发人员会喜欢 jQuery 的“不显眼的 JavaScript”哲学，它对 XHTML 和 CSS、选择器和链接的严格利用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-22T07:28:52.127

大多数事情需要大量的跨浏览器测试和调整，我不可能把自己写得像 jQuery 社区那样可靠和广泛地测试。这包括：

*   $(文档).ready(...)。看看这个函数的实现。有很多 if-else 语句检查各种浏览器功能。

*   位置和尺寸方法：$(...).offset()、$(...).position()、$(...).width()、$(...).innerWidth() 等。同样，这里也是同样的故事。此外，对于窗口和文档等特殊情况，它们可以可靠地工作（或者我认为我能够更可靠地实现自己）。

*   $(...).animate()。基于任何（合理的）CSS 样式为元素设置动画的能力。还有动画链接和 $(...).stop()。非常流畅的 API。

*   事件处理程序。这是每个 JavaScript 库都有的东西，不是任何人自己都无法实现的，但它很高兴拥有。

还有一些不太受欢迎的功能。其中之一是函数链接，它似乎是半官方的 jQuery 编程风格。乍一看它可能令人印象深刻，但总的来说，使用变量和单独的语句并不是你不能做的任何事情，最后，在我看来，它会导致代码的可读性降低。

另一个我不太喜欢的小事是渴望使用闭包和深度嵌套的匿名函数。一周后可能更难阅读此类代码。一些变量来自哪里以及函数范围是什么可能不是很明显。尝试准备一些更详细的 jQuery 源代码来了解我的意思。

尽管 jQuery 的卖点之一是选择器，但我发现我并不经常需要它们，如果需要，我通常会使用基本的。

最后，jQuery DOM 操作有一些有用的实用程序，但总的来说，我认为可以通过更多（尽管乏味）的代码来实现相同的效果。我知道我很可能过于简单化了，但似乎没有一些严重的跨浏览器问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-22T18:30:13.897

选择器中的正则表达式（因为我使用 ASP.Net 并且控件具有荒谬的渲染 ID。）

要在 jQuery 中得到这个：

```
<asp:TextBox ID="txtTest" runat="server" /> 
```

我只是这样做：

```
$("input[id$='txtTest']") 
```

它让我改变了在网站上做客户端工作的看法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-21T21:14:16.963

不完全是一个功能，但已经编写的插件数量和关于如何使用 jQuery 的社区信息绝对是一个奖励。否则，选择器与插件系统一起使用。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-22T08:10:11.810

**支持**CSS 1-3**和**XPath的****选择**器和您自己的自定义选择器相结合！**

 **```
// "odd" numbered rows in a table with class "orders"
jQuery('table.orders tr:odd')

// All external links (links that start with http://)
jQuery('a[@href^="http://"]') 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-25T14:55:32.143

插件系统：

```
((function($){
    $.fn.plugin = function(){
        return this.each(function(){
            //code here
        });
    }
})(jQuery) 
```

链接：

```
$('.parent').children().remove().end().css('background-color', 'red'); 
```

跨各种功能的跨浏览器兼容性，例如。阿贾克斯

```
$.GET('url', {data: 'here'}, function(data){ /* callback */ }); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-28T19:57:50.823

动画函数中的相对值：

```
$('div.class:hover').animate({ height: '+=10', width: '+=10', opacity: '-=.5' }) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-22T01:06:16.170

我喜欢它在一定程度上平等对待新手和专家的事实。但是，如果您知道自己在做什么，那么您真的可以让应用程序在各个方面都大放异彩。诸如延迟加载、代码分离和模板化之类的事情都可以用 jQuery 来完成。它被设计为 DOM 工具，但可以很容易地适应命名空间并充当全栈 js 框架。

简而言之，我认为 jQuery 的最大特点是它从各个角度设计时都考虑到了简单性。最简单的答案通常是最好的答案。

# asp.net-ajax - Asp.net 客户端模板 -

> ID：895112
> 
> 赞同：0
> 
> 时间：2009-05-21T20:56:59.887
> 
> 标签：asp.net-ajax, client-templates

是否可以使用 asp.net ajax 4.0 客户端模板重用客户端模板？我有一个场景，如下例所示。我在这里有两个问题：

1.  我无法在客户端模板中获得 if 条件
2.  如何为三种类型的“列”数据（示例 json 中的 col1、col2、col3）重用 ul 标记模板？

示例代码：

```
<style>
    .sys-template { display:none; }
    .list {width:220px; float:left;  margin:0px 0px 0px 10px; background-color:#f2f2f2; }
    </style>

    <script src="MicrosoftAjax.debug.js" type="text/javascript"></script>
    <script src="MicrosoftAjaxTemplates.debug.js" type="text/javascript"></script>

    <script type="text/javascript">
        var listItems = [{ item: "item1", col: "col1" },
                         { item: "item2", col: "col1" },
                         { item: "item3", col: "col1" },
                         { item: "item4", col: "col2" },
                         { item: "item5", col: "col2" },
                         { item: "item6", col: "col2" },
                         { item: "item7", col: "col2" },
                         { item: "item8", col: "col3" },
                         { item: "item9", col: "col3" },
                         { item: "item10", col: "col3" }]
    </script>
    </head>

    <body xmlns:sys="javascript:Sys" xmlns:dataview="javascript:Sys.UI.DataView" sys:activate="*">
    <ul id="col1" class="list sys-template"  sys:attach="dataview" dataview:data="{{ listItems }}">
        <!--* if (col=="col1") { *-->
        <li>{{item}}</li>
        <!--* } *-->
    </ul>
    <ul id="col2" class="list sys-template"  sys:attach="dataview" dataview:data="{{ listItems }}">
        <!--* if (col=="col2") { *-->
        <li>{{item}}</li>
        <!--* } *-->
    </ul>
    <ul id="col3" class="list sys-template"  sys:attach="dataview" dataview:data="{{ listItems }}">
        <!--* if (col=="col3") { *-->
        <li>{{item}}</li>
        <!--* } *-->
    </ul>
    </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T23:15:00.793

在预览版 4 中，您使用 code:before 和 code:after 属性而不是注释代码块来注入代码。

也可以重复使用模板。实际上，框架会为您做到这一点：如果您将两个数据视图的模板属性指向同一个元素，则只会编译和使用一个模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:24:48.730

像这样的东西应该可以工作——我只是在运行中输入这个，如果它不完美，请原谅我。

```
<ul id="template1" class="sys-template">
  <li code:if="col==$element.id">{{item}}</li>
</ul>

<ul id="col1" class="list sys-template" sys:attach="dataview" dataview:data="{{listItems }}" dataview:itemtemplate="template1">
</ul>
<ul id="col2" class="list sys-template" sys:attach="dataview" dataview:data="{{listItems }}" dataview:itemtemplate="template1">
</ul>
<ul id="col2" class="list sys-template" sys:attach="dataview" dataview:data="{{listItems }}" dataview:itemtemplate="template1">
</ul> 
```

# apache-flex - Flex 问题：我可以在 Flex 中使用 ComboBox 来更改视图堆栈吗？

> ID：895114
> 
> 赞同：1
> 
> 时间：2009-05-21T20:57:14.190
> 
> 标签：apache-flex, combobox, viewstack

我正在尝试使用带有数组的 flex 组合框来更改为视图堆栈中的画布。我可以使用一些自定义操作脚本来做到这一点吗？我正在设计的 UI 真的可以从中受益。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T00:35:10.553

这是一个小演示应用程序，演示了您要执行的操作：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical">

    <mx:Script>
        <![CDATA[
            import mx.core.Container;

            private function onComboBoxChange():void
            {
                stackNav.selectedChild = this[comboNav.selectedItem];
            }            

        ]]>
    </mx:Script>

    <mx:ComboBox id="comboNav" dataProvider="{['canvas1','canvas2']}" change="onComboBoxChange()"/>

    <mx:ViewStack id="stackNav" width="400" height="300">
        <mx:Canvas id="canvas1" width="100%" height="100%">
           <mx:Label text="Hello" horizontalCenter="0" verticalCenter="0"/>
        </mx:Canvas>
        <mx:Canvas id="canvas2" width="100%" height="100%">
           <mx:Label text="World!" horizontalCenter="0" verticalCenter="0"/>
        </mx:Canvas>
    </mx:ViewStack>

</mx:Application> 
```

您也可以更改 onComboBoxChange() 中的逻辑以使用 selectedIndex ：

```
stackNav.selectedIndex = comboNav.selectedIndex; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-28T12:21:58.693

您可以使用此解决方案，但请注意，您不能使用空格插入单词（尝试将“canvas1”更改为“canvas 1”），您将看到：

```
[Bindable] private  var models:Array = ["tasks","users","bugs"];
public function changeViewStackModel():void { 
    //this.modelViewStack.selectedChild=users; //works
//this.modelViewStack.selectedChild="users"; //does not work
//this.modelViewStack.selectedChild=this.modelsCombo.selectedItem; //does not work

    switch(modelsCombo.selectedItem) {
    case "tasks": modelViewStack.selectedChild=tasks; break;
    case "users": modelViewStack.selectedChild=users; break;
    case "bugs": modelViewStack.selectedChild=bugs; break;
    }

} 
```

MXML 代码：

```
<mx:ComboBox id="modelsCombo" dataProvider="{models}" selectedIndex="0"   
    change="changeViewStackModel()"/>
    <mx:ViewStack x="29.25" y="55" id="modelViewStack" width="90%" height="200">
        <mx:Canvas id="tasks" label="Tasks"><mx:Label text="Tasks stack view!!"/>
        </mx:Canvas>
        <mx:Canvas id="users" label="Users"><mx:Label text="Users stack view!!"/>
        </mx:Canvas>
        <mx:Canvas id="bugs" label="Bugs"><mx:Label text="Bugs stack view!!"/>
        </mx:Canvas>
    </mx:ViewStack> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:29:08.223

或者您可以将 viewStack 的 selectedIndex 绑定到组合的 selectedIndex 属性：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical">
    <mx:ComboBox id="comboNav" dataProvider="{['canvas1','canvas2']}"/>

    <mx:ViewStack id="stackNav" width="400" height="300"
        selectedIndex="{comboNav.selectedIndex}">
        <mx:Canvas id="canvas1" width="100%" height="100%">
           <mx:Label text="Hello" horizontalCenter="0" verticalCenter="0"/>
        </mx:Canvas>
        <mx:Canvas id="canvas2" width="100%" height="100%">
           <mx:Label text="World!" horizontalCenter="0" verticalCenter="0"/>
        </mx:Canvas>
    </mx:ViewStack>

</mx:Application> 
```

# sql-server - 性能相关：SQL Server 如何处理来自单个 .NET 桌面应用程序的多个连接的并发查询？

> ID：895117
> 
> 赞同：3
> 
> 时间：2009-05-21T20:57:49.417
> 
> 标签：sql-server, performance, concurrency, database-connection

单线程版本说明：

1.  程序收集问题列表。

2.  对于每个问题，获取模型答案，并通过评分模块运行每个问题。

* * *

*   评分模块进行许多（只读）数据库查询。
*   串行处理，单数据库连接。

我决定通过将问题列表分成块并为每个块创建一个线程来对上述程序进行多线程处理。

每个线程打开它自己的数据库连接并处理它自己的问题列表（6 个线程中的每个线程大约有 95 个问题）。应用程序等待所有线程完成，然后聚合结果以供显示。

令我惊讶的是，多线程版本的运行时间几乎相同，大约需要 16 秒而不是 17 秒。

**问题：**

为什么我没有看到在具有单独连接的单独线程上同时执行查询所期望的性能提升？机器有 8 个处理器。

当查询来自单个应用程序时，SQL Server 是否会同时处理查询，或者它（或 .net 本身）是否会序列化它们？

可能有一些错误配置，这会使它运行得更快，或者我可能只是将 SQL Server 推到了它的计算极限？

**当前配置：**

Microsoft SQL Server Developer Edition 9.0.1406 RTM
操作系统：Windows Server 2003 标准
处理器：8
RAM：4GB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T22:14:03.333

这只是在黑暗中的一个镜头，但我敢打赌你没有看到性能提升，因为它们由于共享资源（记录）的锁定而在数据库中序列化自己。现在是小字。

我假设您的 C# 代码实际上是正确的，并且您实际上确实启动了单独的线程并并行发出每个查询。无意冒犯，但我看到很多人提出这种说法，并且由于各种原因，代码实际上在客户端中是串行的。您应该通过监视服务器来验证这一点（通过 Profiler，或使用 sys.dm_exec_requests 和 sys.dm_exec_sessions）。

我还假设您的查询具有相似的权重。即，您没有一个持续 15 秒的线程和 5 个持续 100 毫秒的线程。

您所描述的症状缺乏更多详细信息，表明您在每个线程的开头都有一个写操作，该操作对某些资源进行了 X 锁定。第一个线程启动并锁定资源，其他 5 个等待。第一个线程完成，释放资源，然后下一个线程抓取它，其他 4 个等待。[所以最后一个线程必须等待所有其他 5 个线程的执行。通过查看sys.dm_exec_requests](http://msdn.microsoft.com/en-us/library/ms177648.aspx)并监控阻塞请求的内容，这将非常容易解决。

顺便说一句，您应该考虑使用 Asynchronous Processing=true 并依靠 BeginExecuteReader 之类的异步方法来并行执行命令，而不会产生客户端线程的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-13T22:02:25.957

You can simply check the task manager when the process is running. If it's showing 100% CPU usage then its CPU bound. Otherwise its IO Bound.

For hyperthreading 50% CPU usage is roughly equal to 100% usage!

Wow I didn't realize how old the thread was. I guess its always good to leave the response for others looking.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:10:23.103

is it possible that the the threads share a connection? did you verify that multiple SPIDs are created when this runs (sp_who)?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:00:21.360

你的数据库有多大？您的 HDD / Raid / 其他存储的速度有多快

也许您的数据库受 I/O 限制？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T21:04:10.683

我的第一个倾向是您正在尝试使用线程解决 IO 问题，这几乎永远不会奏效。IO就是IO，多线程不增加管道。您最好一次性下载所有问题及其答案，并使用多个线程在本地处理该批次。

话虽如此，您可能正在经历一些导致缓慢的数据库锁定。由于您在谈论只读查询，请尝试在查询中使用 with (nolock) 提示，看看是否有帮助。

关于 SQL Server 处理，据我了解，SQL Server 将尝试同时处理尽可能多的连接（每个连接一次一条语句），直至配置允许的最大连接数。您看到的那种 if 问题几乎从来都不是线程问题，而且几乎总是锁定或 IO 问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T12:26:37.393

我在 task_address 上跨 sys.dm_os_workers、sys.dm_os_tasks 和 sys.dm_exec_requests 运行了一个连接查询，结果如下（排除了一些无趣/零值字段，其他前缀为 ex 或 os 以解决歧义）：

```
-COL_NAME-  -Thread_1-  -Thread_2-  -Thread_3-  -Thread_4-

task_state  SUSPENDED   SUSPENDED   SUSPENDED   SUSPENDED
context_switches_count  2   2   2   2
worker_address  0x3F87A0E8  0x5993E0E8  0x496C00E8  0x366FA0E8
is_in_polling_io_completion_routine 0   0   0   0
pending_io_count    0   0   0   0
pending_io_byte_count   0   0   0   0
pending_io_byte_average 0   0   0   0
wait_started_ms_ticks   1926478171  1926478187  1926478171  1926478187
wait_resumed_ms_ticks   1926478171  1926478187  1926478171  1926478187
task_bound_ms_ticks 1926478171  1926478171  1926478156  1926478171
worker_created_ms_ticks 1926137937  1923739218  1921736640  1926137890
locale  1033    1033    1033    1033
affinity    1   4   8   32
state   SUSPENDED   SUSPENDED   SUSPENDED   SUSPENDED
start_quantum   3074730327955210    3074730349757920    3074730321989030    3074730355017750
end_quantum 3074730334339210    3074730356141920    3074730328373030    3074730361401750
quantum_used    6725    11177   11336   6284
max_quantum 4   15  5   20
boost_count 999 999 999 999
tasks_processed_count   765 1939    1424    314
os.task_address 0x006E8A78  0x00AF12E8  0x00B84C58  0x00D2CB68
memory_object_address   0x3F87A040  0x5993E040  0x496C0040  0x366FA040
thread_address  0x7FF08E38  0x7FF8CE38  0x7FF0FE38  0x7FF92E38
signal_worker_address   0x4D7DC0E8  0x571360E8  0x2F8560E8  0x4A9B40E8
scheduler_address   0x006EC040  0x00AF4040  0x00B88040  0x00E40040
os.request_id   0   0   0   0
start_time  2009-05-26 19:39    39:43.2 39:43.2 39:43.2
ex.status   suspended   suspended   suspended   suspended
command SELECT  SELECT  SELECT  SELECT
sql_handle  0x020000009355F1004BDC90A51664F9174D245A966E276C61  0x020000009355F1004D8095D234D39F77117E1BBBF8108B26  0x020000009355F100FC902C84A97133874FBE4CA6614C80E5  0x020000009355F100FC902C84A97133874FBE4CA6614C80E5
statement_start_offset  94  94  94  94
statement_end_offset    -1  -1  -1  -1
plan_handle 0x060007009355F100B821C414000000000000000000000000  0x060007009355F100B8811331000000000000000000000000  0x060007009355F100B801B259000000000000000000000000  0x060007009355F100B801B259000000000000000000000000
database_id 7   7   7   7
user_id 1   1   1   1
connection_id   BABF5455-409B-4F4C-9BA5-B53B35B11062    A2BBCACF-D227-466A-AB08-6EBB56F34FF2    D330EDFE-D49B-4148-B7C5-8D26FE276D30    649F0EC5-CB97-4B37-8D4E-85761847B403
blocking_session_id 0   0   0   0
wait_type   CXPACKET    CXPACKET    CXPACKET    CXPACKET
wait_time   46  31  46  31
ex.last_wait_type   CXPACKET    CXPACKET    CXPACKET    CXPACKET
wait_resource               
open_transaction_count  0   0   0   0
open_resultset_count    1   1   1   1
transaction_id  3052202 3052211 3052196 3052216
context_info    0x  0x  0x  0x
percent_complete    0   0   0   0
estimated_completion_time   0   0   0   0
cpu_time    0   0   0   0
total_elapsed_time  54  41  65  39
reads   0   0   0   0
writes  0   0   0   0
logical_reads   78745   123090  78672   111966
text_size   2147483647  2147483647  2147483647  2147483647
arithabort  0   0   0   0
transaction_isolation_level 2   2   2   2
lock_timeout    -1  -1  -1  -1
deadlock_priority   0   0   0   0
row_count   6   0   1   1
prev_error  0   0   0   0
nest_level  2   2   2   2
granted_query_memory    512 512 512 512 
```

所有查询的查询计划预测器显示几个节点，0% 用于选择，100% 用于聚集索引查找。

编辑：我遗漏的字段和值（对于所有 4 个线程都相同，除了 context_switch_count）：`exec_context_id(0), host_address(0x00000000), status(0), is_preemptive(0), is_fiber(0), is_sick(0), is_in_cc_exception(0), is_fatal_exception(0), is_inside_catch(0), context_switch_count(3-89078), exception_num(0), exception_Severity(0), exception_address(0x00000000), return_code(0), fiber_address(NULL), language(us_english), date_format(mdy), date_first(7), quoted_identifier(1), ansi_defaults(0), ansi_warnings(1), ansi_padding(1), ansi_nulls(1), concat_null_yields_null(1), executing_managed_code(0)`

# c# - 在 C# 中附加两个或多个字节数组

> ID：895120
> 
> 赞同：32
> 
> 时间：2009-05-21T20:58:43.563
> 
> 标签：c#, bytearray

有没有最好的（见下文）在 C# 中附加两个字节数组的方法？

假装我有完全的控制权，我可以使第一个字节数组足够大以在最后容纳第二个字节数组并使用[Array.CopyTo](https://msdn.microsoft.com/en-us/library/system.array.copyto%28v=vs.110%29.aspx)函数。或者我可以遍历单个字节并进行分配。

有没有更好的方法？我无法想象像将字节数组转换为字符串并将它们连接起来并将它们转换回来这样的事情会比上述任何一种方法都好。

就最佳/更好（按顺序）而言：

1.  最快的
2.  最少的 RAM 消耗

一个限制是我必须在 .NET 2.0 框架中工作。

推荐的两个选择是 MemoryStream 和 BlockCopy。我已经对 10,000,000 个循环进行了 3 次简单的速度测试，得到了以下结果：

## *3 次运行 10,000,000 次循环的平均值（以毫秒为单位）：*

*   **BlockCopy Time: 1154** , 范围为 13 毫秒
*   MemoryStream GetBuffer 时间：1470，范围为 14 毫秒
*   MemoryStream ToArray Time：1895，范围为3毫秒
*   CopyTo Time：2079，范围为19毫秒
*   逐字节时间：2203，范围为10毫秒

List<byte> [AddRange](https://msdn.microsoft.com/en-us/library/z883w3dc%28v=vs.110%29.aspx)超过 1000 万次循环的结果：List<byte> 时间：16694

## 相对 RAM 消耗（1 是基线，越高越差）：

*   **逐字节：1**
*   **块复制：1**
*   **复制到：1**
*   内存流获取缓冲区：2.3
*   MemoryStream ToArray：3.3
*   列表<字节>：4.2

测试表明，一般来说，除非你正在做大量的字节副本[**我是**]，否则查看字节副本不值得关注[例如，1000 万次运行产生多达 1.1 秒的差异]。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-21T21:11:00.387

You want [BlockCopy](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)

According to [this blog post](https://web.archive.org/web/20140418112901/http://danielvl.blogspot.com/2004/04/use-bufferblockcopy-instead-of.html) it is faster than Array.CopyTo.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-21T21:29:59.477

您还可以使用带有 MemoryStream 的方法。假设 b1 和 b2 是两个字节数组，您可以通过以下方式使用 MemoryStream 获得一个新的 b3：

```
var s = new MemoryStream();
s.Write(b1, 0, b1.Length);
s.Write(b2, 0, b2.Length);
var b3 = s.ToArray(); 
```

这应该可以在没有 LINQ 的情况下工作，实际上速度要快得多。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-21T21:18:36.957

Create a new [MemoryStream](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx) passing into the constructor a buffer that's exactly the size of the merged one. Write the individual arrays, and then finally use the buffer:

```
byte[] deadBeef = new byte[] { 0xDE, 0xAD, 0xBE, 0xEF};
byte[] baadF00d = new byte[] { 0xBA, 0xAD, 0xF0, 0x0D};
int newSize = deadBeef.Length + baadF00d.Length;
var ms = new MemoryStream(new byte[newSize], 0, newSize, true, true);
ms.Write(deadBeef, 0, deadBeef.Length);
ms.Write(baadF00d, 0, baadF00d.Length);
byte[] merged = ms.GetBuffer(); 
```

A lot of the low-level I/O functions in .NET take byte arrays and offsets. This was done to prevent needless copies. Be sure you really need the merged array if this is performance sensitive, otherwise just use buffers and offsets.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-21T21:11:37.483

Another option, although I haven't tested it to see how it fares in terms of speed and memory consumption, would the LINQ approach:

```
byte[] combined = bytesOne.Concat(bytesTwo).Concat(bytesThree).ToArray(); 
```

...where bytesOne, bytesTwo, and bytesThree are byte arrays. Since Concat uses deferred execution, this shouldn't create any intermediate arrays, and it shouldn't duplicate the original arrays until it constructs the final merged array at the end.

Edit: [LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx) will allow you to use LINQ-to-Objects (which this is an example of) in the 2.0 framework. I understand if you don't want to depend on this, but it's an option.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-21T21:05:55.437

如果您有大小会不时更改的数组，那么您最好`List<T>`首先使用 a 。然后你可以调用`AddRange()`列表的方法。

否则，Array.Copy() 或 Array.CopyTo() 与您可能看到的其他任何东西一样好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-21T21:13:59.727

Have you taught about using List or ArrayList instead of an Array? With these types they can grow or shrink and append via InsertRange

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-21T21:22:14.547

Do you need the output to actually be a byte array?

If not, you could create yourself a "smart cursor" (which is similar to what LINQ does): Create a custom IEnumerator<byte> that will first iterate the first array, and just continue on the second one without interuption.

This would work in the 2.0 framework be fast (in that the joining of arrays has virtually no cost), and use no more RAM than the arrays already consume.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-21T21:03:17.783

使第一个数组足够大以包含第二个数组并使用 Array.CopyTo 的第一个选项最终与手动迭代每个项目并进行分配大致相同。Array.CopyTo() 只是让它更简洁。

与上述相比，转换为字符串并返回数组将非常慢。并且可能会使用更多内存。

# hibernate - 休眠OneToMany列表排序持续但反转？

> ID：895121
> 
> 赞同：6
> 
> 时间：2009-05-21T20:59:05.653
> 
> 标签：hibernate, list

我有一个具有`@OneToMany`另一个实体列表的持久实体，我需要列表顺序才能由用户编辑，这非常有效。我可以完全重新排序内存中的 java 列表，当我 save() 对象时，链接表中的链接顺序确实发生了变化。但是，它会更改为用户设置的相反顺序。但是，如果您在关闭程序之前将实体拉回，它会显示正确，因为它没有重新加载。如果您重新加载程序，再次，它是倒退的。

这不是我应该做的事情吗，取决于那个顺序？但是创建另一个订单列似乎是多余的，因为无论如何都有订单，我似乎可以更改它。我只需要它来保存而不是倒退。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-04T05:52:05.537

Hibernate 支持使用 IndexColumn 注释的有序元素。

这是[“Java Persistence with Hibernate”一书中](http://www.manning.com/bauer2/)的示例：

```
@org.hibernate.annotations.CollectionOfElements
@JoinTable(
name = "ITEM_IMAGE",
joinColumns = @JoinColumn(name = "ITEM_ID")
)
@org.hibernate.annotations.IndexColumn(
name="POSITION", base = 1
)
@Column(name = "FILENAME")
private List<String> images = new ArrayList<String>(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-03T09:50:35.550

我遇到了同样的问题，我只是按照[此处](https://stackoverflow.com/questions/3020232/hibernate-how-to-maintain-insertion-order)另一篇文章中的建议添加了**@OrderBy**注释来修复它。我认为它也应该能够解决您的问题，这是我的代码：

```
 @Entity
    @Table(name = "my_library")
    public class MyLibrary implements java.io.Serializable{

    (...omitted)

    private List<Book> bookList = new ArrayList<Book>();   

    @OneToMany(mappedBy = "library", cascade = CascadeType.ALL)
    @OrderBy
    public List<Book> getBookList() {
        return bookList;
    }

    public void setBookList(List<Book> bookList) {
        this.bookList= bookList;
    }

    } 
```

然后，我可以将 getBookList() 与我在持久存储到 DB 时插入的顺序相同。当我们没有像**@OrderBy("xxxColumn")**那样指定列名时，它默认使用该实体的主键。就我而言，它使用 Book 的 instanceId，它始终遵循与插入顺序相同的顺序，因此它很好地满足了我的需要。

但是，我很好奇为什么顺序是相反的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-24T15:46:36.863

您的 Hibernate 层是否使用 Sets？我相信默认情况下会这样做。set 接口（及其具体实现）**不**维护插入顺序。

或者，您可能想查看您的查询，您是否使用“order by”？

我还尝试使用调试器查看内存中的集合。您的视图代码可能正在重新排序集合。至少调试器将有助于查看您的集合在哪个确切点被反转。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-24T21:36:57.967

我认为没有办法通过列表直接实现这一点。我们在工作中使用以下内容：

如果您想让您的用户完全控制实体的顺序，您应该添加一个新字段，例如：

```
@Entity
public class Todo {
  @Id private Long id;
  private int position; 
  // + public setter/getter 
} 

@Entity
public class Todos {
  @Id private id;

  @OneToMany
  private List<Todo> todos = new LinkedList<Todo>();
  // + public setter/getter     
} 
```

然后在所有查询中按位置排序或为 Todos 实现 Comparator 并使用 Collections.sort(List lst, Comparator cmp) 对内存中的列表进行排序。

```
public class TodoComparator implements Comparator {
  public int compare(Object o1, Object o2) {
    Todo t1 = (Todo)o1;
    Todo t2 = (Todo)o2;
    return t2.getPosition() - t1.getPosition();
  }
} 
```

Collection.sort(todos,new TodosComparator());

在您的用户完成重新排序列表后，（保存之前）重新编号列表：

```
for(int pos=0; pos < todos.size(); pos++ )
    todos.get(pos).setPosition(pos); 
```

并保存待办事项。并享受完全控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-03T19:24:08.587

你是直接上单操作吗？

```
object.getItems().add/remove/set ... 
```

尝试制作副本

```
List items = new ArrayList(object.getItems()); 
```

然后对其进行操作，然后一次性设置完整的集合：

```
object.setItems(items) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-22T20:10:07.903

您是否在该对象层次结构上实现了 compareTo？

# java - 如何在java中找出日期是否比今天的日期早1年

> ID：895125
> 
> 赞同：2
> 
> 时间：2009-05-21T20:59:38.070
> 
> 标签：java, date

在 java 中，我怎样才能找出特定日期是否在今天日期的 1 年内。

我有以下但不确定这是否是最好的方法。

```
 String date = "01/19/2005";
    DateFormat df = new SimpleDateFormat("dd/MM/yyyy");
    Date lastExamTakenDate = null;
    Calendar todaysDateMinus1Year = Calendar.getInstance();
    todaysDateMinus1Year.add(Calendar.YEAR, -1);

    if (date!=null)
    {
        try {
             lastExamTakenDate = df.parse(date);
            if (lastExamTakenDate.before(todaysDateMinus1Year.getTime()))
                hasToTakeExam = true;
        } catch (ParseException ex) {
            //exception
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-10T08:08:21.087

与 Java 捆绑在一起的 java.util.Date 和 .Calendar 类是出了名的麻烦。避开他们。使用[Joda-Time](http://www.joda.org/joda-time/)或与 Java 8 捆绑在一起的新 java.time 包（并受 Joda-Time 启发）。

# 乔达时间

如果您确定只需要没有时间或时区的日期，请使用[LocalDate](http://www.joda.org/joda-time/apidocs/org/joda/time/LocalDate.html)类（在 Joda-Time 和 java.time 中都可以找到）。

请注意在询问当前日期时使用时区。日期取决于您目前在地球上的位置。如果您未能指定日期，将使用 JVM 的默认时区。通常最好指定。

这是一些使用 Joda-Time 2.3 的示例代码。

```
String input = "01/19/2005";
DateTimeFormatter formatter = DateTimeFormat.forPattern( "MM/dd/yyyy" );
LocalDate localDate = LocalDate.parse( input, formatter );
DateTimeZone timeZone = DateTimeZone.forID( "Europe/Paris" );
LocalDate now = LocalDate.now( timeZone );
LocalDate yearAgo = now.minusYears( 1 );
boolean withinYearAgo = ( ( localDate.isAfter( yearAgo ) ) & ( localDate.isBefore( now ) ) ); 
```

转储到控制台...</p>

```
System.out.println( "input: " + input );
System.out.println( "localDate: " + localDate );
System.out.println( "now: " + now );
System.out.println( "yearAgo: " + yearAgo );
System.out.println( "withinYearAgo: " + withinYearAgo ); 
```

运行时……</p>

```
input: 01/19/2005
localDate: 2005-01-19
now: 2014-04-10
yearAgo: 2013-04-10
withinYearAgo: false 
```

根据您对“去年内”的定义，您可能希望添加“或等于”测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T21:14:38.647

If you call getTime() on a date object it will return a long with milliseconds since epoch (jan 1\. 1970). Checking if a date is within the last year is then a simple matter of creating one date object with a date one year ago and doing comparison on the long values (someDate > aYearAgo). Alternatively you can use the after() method on a calendar object. To create a calendar/date object with a value one year ago you can use calObj.add(Calendar.YEAR, -1).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T21:20:29.917

I believe something like this will get you the start of the calendar day so that time of day is not a factor.

```
GregorianCalendar calToday = new GregorianCalendar();
GregorianCalendar oneYearAgoTodayAtMidnight = new GregorianCalendar(calToday.get(Calendar.YEAR) - 1, calToday.get(Calendar.MONTH), calToday.get(Calendar.DATE)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T03:43:27.027

这种方法忽略了闰年（以及其他由日历引起的怪事），但非常简单：

```
public boolean isWithinAYear(Date inputDate) {
  Date d = new Date() // Get "now".
  long dLong = d.getTime();
  // You could multiply this next line out and use a single constant,
  // I didn't do that for clarity (and the compiler will optimize it 
  // out for us anyhow.)
  long oneYearAgo = dLong - (365 * 24 * 60 * 60 * 1000); 

  return inputDate.getTime() > oneYearAgo;
} 
```

您使用 GregorianCalendar 的解决方案在技术上更正确。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-10T04:49:06.633

这很完美。

公共课 X {

```
 public static Date date ;

public static Date date1 ;

/**
 * @param args the command line arguments
 */
public static void main(String[] args) {

   Calendar cal = Calendar.getInstance();
 cal.add(Calendar.YEAR, 0); 

    boolean time;

 date = cal.getTime();
    System.out.println(date);
 time =  withinYear(date);

   System.out.println(time);

}

private static boolean result;
public static  boolean withinYear(Date inputDate)
{
   Calendar todaysDateMinus1Year = Calendar.getInstance();
todaysDateMinus1Year.add(Calendar.YEAR, -1);

date1 = todaysDateMinus1Year.getTime();

if (inputDate.before(date1))
            result= true;
            return result;

} 
```

# javascript - 用于 Markdown、Textile 等的 JavaScript 库；锚参考

> ID：895135
> 
> 赞同：7
> 
> 时间：2009-05-21T21:00:55.197
> 
> 标签：javascript, markdown, textile

我需要一个 javascript 库来即时将结构化的 ascii 文本转换为 html。我对以下几点特别感兴趣：

我想在页面内使用锚定链接，请参阅[http://www.w3.org/TR/REC-html40/struct/links.html#h-12.1.1](http://www.w3.org/TR/REC-html40/struct/links.html#h-12.1.1)

哪个结构化文本库将支持这一点，或者如果不支持它可以轻松扩展（我可以编写扩展名）？

您能否为“页面内链接”的结构化 ascii 文本提出一个好的和简单的语法建议？

```
<a href="#jumpend">jump to the end</a>
...some body text...
<a name="jumpend">this is the end</a> 
```

我喜欢用“markdown”编写链接的方式，那么如何将要编写的扩展名中的名称锚以一种好的方式表达？

您知道或可以推荐哪些图书馆？应该是多浏览器，良好且易于阅读和扩展干净的源代码，积极维护。

我目前正在查看 JavaScript Markdown 库“Showdown”：[http ://attacklab.net/showdown/](http://attacklab.net/showdown/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T01:55:35.353

你可以看看[markItUp！](http://markitup.jaysalvat.com/home/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-28T10:28:21.007

如果您正在寻找锚参考，我认为您不应该使用降价。尝试以下 Creole Wiki 标记解析器：

*   可以在[MeatballSociety找到原型 Javascript Creole 0.4 解析器](http://www.meatballsociety.org/Creole/0.4/)
*   [JavaScript Creole 1.0 Wiki Markup Parser](http://sourceforge.net/projects/jscreole/)，基于上述

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-14T15:28:04.500

Textile 有一个内置的“脚注”机制：

```
.. AJAX[1] ...

fn1\. Asynchronous JavaScript and XML .. 
```

从[Textile 2.2](https://github.com/netcarver/textile)开始，还有一个“notelist”功能：[textile.sitemonks.com/ ?eg=notes](http://textile.sitemonks.com/?eg=notes#results)

# java - java swing中的定位

> ID：895139
> 
> 赞同：0
> 
> 时间：2009-05-21T21:01:13.433
> 
> 标签：java, swing, layout

我在定位标签/密码字段时遇到了一些麻烦。
使用此代码，它们都位于彼此相邻的中心，而我实际上希望它们在我的面板中间彼此重叠。

有谁知道我应该怎么做？

```
import java.awt.BorderLayout;
import java.awt.FlowLayout;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JPasswordField;

public class Paneel_Pincode extends JPanel {

    Paneel_Pincode() {
        setLayout(new FlowLayout());

        JPasswordField pincode = new JPasswordField(15);
        pincode.setLocation(500, 500);
        JLabel pinInvoer = new JLabel();

        ImageIcon pin1 = new ImageIcon("images/voerPincodeIn.jpg");

        pinInvoer.setIcon(pin1);
        pinInvoer.setLocation(500,700);

        add(pincode);
        add(pinInvoer);
    }

    public static void main(String[] args) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setSize(1000,1000);
        f.setLocationRelativeTo(null);

        f.add(new Paneel_Pincode());
        f.setVisible(true);
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T21:04:00.590

为了掌握布局的窍门，我建议阅读我关于它们的文章 ( [http://java.sun.com/developer/onlineTraining/GUI/AWTLayoutMgr/](http://java.sun.com/developer/onlineTraining/GUI/AWTLayoutMgr/) )。它很旧，但是 FlowLayout 的概念和工作原理都很详细。

“彼此之上”是什么意思？

如果你的意思是喜欢

```
 Password
   <field> 
```

编辑：我记得有一种更简单的方法来做到这一点（完全在 JDK/JRE 中）...（这类似于我对下面的 BoxBeans 所做的，但您不需要 BoxBeans。我创建 BoxBeans 是为了很久以前就可以在 UI builder 中使用 BoxLayout ...)

```
JLabel label = new JLabel("Password") {
    @Override public Dimension getMaximumSize() {
        return super.getPreferredSize();
    }
};
JPasswordField field = new JPasswordField() {
    @Override public Dimension getMaximumSize() {
        return super.getPreferredSize();
    }
};
field.setColumns(10);
Box verticalBox = Box.createVerticalBox();
verticalBox.add(Box.createVerticalGlue());
verticalBox.add(label);
verticalBox.add(field);
verticalBox.add(Box.createVerticalGlue());
//
Box horizontalBox = Box.createHorizontalBox();
horizontalBox.add(Box.createHorizontalGlue());
horizontalBox.add(verticalBox);
horizontalBox.add(Box.createHorizontalGlue());
add(horizontalBox); 
```

上一个答案供参考...

我不推荐以下，但它可以帮助其他读者的想法

你可以做类似的事情

```
setLayout(FlowLayout());
JPanel group = new JPanel(new BorderLayout());
group.add(new JLabel("Password"), BorderLayout.NORTH);
group.add(passwordField, BorderLayout.SOUTH);
add(group); 
```

这将在整个 UI 的顶部中心创建一个小面板，其中包含密码和字段。

请注意，嵌套的 BorderLayout 可确保标签和字段各自获得其首选大小。您需要在字段上调用 ​​setColumns 来显示您想要显示的字符数。

如果您还想将标签/字段垂直居中，您可以执行以下操作

```
setLayout(new GridBagLayout());
//
add(new JLabel("Password"), 
    new GridBagConstraints(0,0,1,1,1,1,
        GridBagConstraints.SOUTH,GridBagConstraints.NONE, 
        new Insets(3,3,3,3), 0,0));
field.setColumns(10);
add(field, new GridBagConstraints(0,1,1,1,1,1,
    GridBagConstraints.NORTH,GridBagConstraints.NONE, 
    new Insets(3,3,3,3), 0,0)); 
```

我一般讨厌使用 GridBagLayout，所以我将使用 BoxLayout 添加一个版本（但由于首选大小设置，它有点棘手）

```
 JFrame f = new JFrame();
    f.setLayout(new BorderLayout());
    //
    JPanel stuffH = new JPanel();
    f.add(stuffH, BorderLayout.CENTER);
    stuffH.setLayout(new BoxLayout(stuffH, BoxLayout.X_AXIS));
    //
    JPanel stuffV = new JPanel();
    stuffV.setLayout(new BoxLayout(stuffV, BoxLayout.Y_AXIS));
    //
    JLabel label = new JLabel("Password");
    BoxAdapter labelAdapter = new BoxAdapter();
    labelAdapter.add(label);
    JPasswordField field = new JPasswordField();
    field.setColumns(10);
    BoxAdapter fieldAdapter = new BoxAdapter();
    fieldAdapter.add(field);
    //
    stuffV.add(new VerticalGlue()); // for vertical spacing
    stuffV.add(labelAdapter);
    stuffV.add(fieldAdapter);
    stuffV.add(new VerticalGlue()); // for vertical spacing
    //
    stuffH.add(new HorizontalGlue()); // for horizontal spacing
    stuffH.add(stuffV);
    stuffH.add(new HorizontalGlue()); // for horizontal spacing
    //
    f.setVisible(true);
    f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE); 
```

对此有几点说明：

*   我正在使用我的 BoxBeans 辅助类 - 请参阅[http://javadude.com/tools/boxbeans](http://javadude.com/tools/boxbeans)。这个页面是基于VisualAge for Java，但是页面底部的jar可以在VAJ之外使用。例如，我刚刚在 Eclipse 中尝试过。
*   AFAICS，您不能将 jframe 的布局直接设置为 BoxLayout，因此我在两者之间添加了一个额外的面板。BoxLayout 中有一个检查内容窗格的自动间接问题。
*   我嵌套了 BoxLayouts，因此水平居中（stuffH 面板）包含垂直居中（stuffV 面板）。它们通过用“胶水”组件围绕它们来居中，这些组件只是允许自身扩展的组件。
*   我不得不将标签和字段放在 BoxAdapter 中，这将它们的最大尺寸限制为它们的首选尺寸。如果您不想使用 BoxAdapter，您可以通过对字段和标签使用以下内容来实现相同的效果：

    ```
    JLabel label = new JLabel("Password") {
        @Override public Dimension getMaximumSize() {
            return super.getPreferredSize();
        }
    };
    JPasswordField field = new JPasswordField() {
        @Override public Dimension getMaximumSize() {
            return super.getPreferredSize();
        }
    }; 
    ```

希望这对您和其他任何人都有帮助！——斯科特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T00:43:59.817

我会推荐 JGoodies FormLayout。一旦你学会了它，它就非常强大并且很容易通过手工编码来完成。

# maven-2 - 在哪个 maven2 存储库中可以找到 Google Guice？

> ID：895152
> 
> 赞同：35
> 
> 时间：2009-05-21T21:03:51.133
> 
> 标签：maven-2, repository, guice

据我了解，[Google Guice](http://code.google.com/p/google-guice/) 2.0 不久前发布。但我看到中央回购仍然有过时的[1.0](http://www.mvnrepository.com/artifact/com.google.code.guice/guice)版本。请告诉我在哪里可以找到带有 Google Guice 2.0 的 maven2 存储库。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-09-01T20:23:51.270

Guice 3.0 现在[可以在 central 上使用](http://repo2.maven.org/maven2/com/google/inject/guice/3.0/)。您需要以下内容才能依赖它。

```
<dependency>
  <groupId>com.google.inject</groupId>
  <artifactId>guice</artifactId>
  <version>3.0</version>
</dependency> 
```

遗憾的是，他们[还没有上传源 jars](http://code.google.com/p/google-guice/issues/detail?id=382)，并且类文件已经[用 Java 6 编译](http://code.google.com/p/google-guice/issues/detail?id=402)。这可能会让你大吃一惊……</p>

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-31T22:18:47.607

Guice 2.0 现在在官方 google-maven-repository 中可用。要使用它，请将以下内容添加到`<dependencies>`标记内的 pom.xml 中（如果没有，则需要添加一个）：

```
<dependency>
  <groupId>com.google.inject</groupId>
  <artifactId>guice</artifactId>
  <version>2.0</version>
</dependency> 
```

您不需要，但您可以按照[此处](http://code.google.com/p/google-maven-repository/wiki/ProjectSetup)的说明在 pom.xml 中添加对官方 google-maven-repository 的引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-07T00:34:51.583

由于我在中央没有看到 Guice 2.0，我想我会在我找到它的地方包含一个稳定的 repo：

*   [https://repository.jboss.org/nexus/content/repositories/thirdparty-uploads/](https://repository.jboss.org/nexus/content/repositories/thirdparty-uploads/)

[Grails OpenID 插件](http://grails.org/plugin/spring-security-openid)引用了[http://guice-maven.googlecode.com/svn/trunk/](http://guice-maven.googlecode.com/svn/trunk/)但它没有（目前）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T21:44:07.683

正如他们在此承诺的那样，他们将很快将其放入中央存储库：[http ://groups.google.com/group/google-guice/browse_thread/thread/6707a887ed5ef2e3](http://groups.google.com/group/google-guice/browse_thread/thread/6707a887ed5ef2e3)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T21:30:03.047

没关系。[Guice-maven](http://code.google.com/p/guice-maven/)旨在提供这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T20:17:54.333

在它到达中央存储库之前，我一直从这里获取它：http: [//guice-maven.googlecode.com/svn/trunk](http://guice-maven.googlecode.com/svn/trunk)

# .net - String.Substring 相对于其他字符串处理方法有多快？

> ID：895159
> 
> 赞同：4
> 
> 时间：2009-05-21T21:05:42.847
> 
> 标签：.net, performance, string

我正在使用 VB.NET 来处理长的固定长度记录。最简单的选项似乎是将整个记录加载到字符串中，并使用 Substring 按位置和长度访问字段。但似乎每次调用都会在 Substring 方法中进行一些冗余处理。这让我想知道使用基于流或基于数组的方法是否可以获得更好的结果。

内容以包含 UTF8 字符数据的字节数组开始。下面列出了我想到的其他几种方法。

1.  将字符串加载到 StringReader 并一次读取它的块
2.  将字节数组转换为 char 数组并在数组中按位置访问字符
3.  （这个看起来很蠢，但我会把它扔在那里）将字节数组复制到内存流并使用 StreamReader

这*绝对*是过早的优化；即使慢了几毫秒，子字符串方法也可能完全可以接受。但我想我会在编码之前先问一下，看看是否有人能想到使用其他方法之一的理由。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T21:14:56.213

子字符串的主要成本是将子字符串切除为新字符串。使用反射器，您可以看到：

```
private unsafe string InternalSubString(int startIndex, int length, bool fAlwaysCopy)
{
    if (((startIndex == 0) && (length == this.Length)) && !fAlwaysCopy)
    {
        return this;
    }
    string str = FastAllocateString(length);
    fixed (char* chRef = &str.m_firstChar)
    {
        fixed (char* chRef2 = &this.m_firstChar)
        {
            wstrcpy(chRef, chRef2 + startIndex, length);
        }
    }
    return str;
} 
```

现在要到达那里（注意那不是`Substring()`），它必须经过 5 次长度检查等。

如果您多次引用相同的子字符串，那么可能值得将所有内容都拉出一次并转储巨大的字符串。您将在数组中产生开销来存储所有这些子字符串。

如果它通常是“一次性”访问，则将其子串化，否则考虑分区。也许`System.Data.DataTable`会有用？如果您正在对其他数据类型进行多次访问和解析，那么`DataTable`对我来说看起来更有吸引力。如果您一次只需要一条记录在内存中，那么 a`Dictionary<string,object>`应该足以保存一条记录（字段名称必须是唯一的）。

或者，您可以编写一个自定义的通用类来为您处理固定长度的记录读取。指明每个字段的起始索引和字段的类型。字段的长度由下一个字段的开头推断（例外是可以从总记录长度推断的最后一个字段）。可以使用 , , 等自动`int.Parse()`转换`double.Parse()`类型`bool.Parse()`。

```
RecordParser r = new RecordParser();
r.AddField("Name", 0, typeof(string));
r.AddField("Age", 48, typeof(int));
r.AddField("SystemId", 58, typeof(Guid));
r.RecordLength(80);

Dictionary<string, object> data = r.Parse(recordString); 
```

如果反射适合您的喜好：

```
[RecordLength(80)]
public class MyRecord
{
    [RecordFieldOffset(0)]
    string Name;

    [RecordFieldOffset(48)]
    int Age;

    [RecordFieldOffset(58)]
    Guid Systemid;
} 
```

只需运行属性，您就可以`PropertyInfo.PropertyType`知道如何处理记录中的子字符串；您可以从属性中提取偏移量和总长度；并返回填充数据的类的实例。本质上，您可以使用反射从我之前的建议中提取信息以调用 RecordParser.AddField() 和 RecordLength()。

然后把它全部包装成一个整洁的小类：

```
RecordParser<MyRecord> r = new RecordParser<MyRecord>();
MyRecord data = r.Parse(recordString); 
```

甚至可以调用`r.EnumerateFile("path\to\file")`并使用`yield return`枚举语法解析出记录

```
RecordParser<MyRecord> r = new RecordParser<MyRecord>();
foreach (MyRecord data in r.EnumerateFile("foo.dat"))
{
    // Do stuff with record
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T21:16:19.533

最快的方法可能是使用流技术，因为假设您可以按顺序读取每个字段，它只会将您需要的内容保留在内存中，并且会[记住您在进程中的位置](http://www.joelonsoftware.com/articles/fog0000000319.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T19:40:24.127

您尝试做的事情听起来像是解析任务。如果我理解正确，您会加载一个包含多个字段及其值的巨大字符串。对于这种特殊的场景，Substring 的性能不会特别好。对于每个字段及其值，您将需要在较大的字符串中调用具有特定位置和长度的 Substring。这是相当多的开销。

作为替代方案，您可以实现一个简单的解析器，从头到尾处理您的字符串一次，并在一次传递中检索每个字段和值。这样的解析器不需要非常复杂……只需一个简单的 1 个字符的前瞻解析器就可以了。您可能甚至不需要标记您的输入......您可以以流式方式处理它以提取一个字段，然后提取它的值，将其放入某个容器中，然后继续。

如果您的输入字符串比一系列字段和值（即其结构化）更复杂，则可能需要更复杂的解析器。有很多工具，比如[antler](http://www.antlr.org/)，它们提供的框架可以为你生成语法、生成解析器，并提供一个很好的 API 来使用你解析的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:30:33.000

你是如何阅读记录的？

你是逐个字符还是逐行阅读？

您可以在阅读时即时执行操作，因此不会涉及子字符串。

如果您必须读取一次然后处理然后读取到字符串并使用 StringReader 它将允许您逐个字符或按多个字符读取。

# python - 编译的 Python CGI

> ID：895163
> 
> 赞同：0
> 
> 时间：2009-05-21T21:06:11.113
> 
> 标签：python

假设网络服务器配置为处理***.exe***，我可以将 python CGI 文件编译成 exe 以提高速度。这样的消沉会有什么利弊？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T21:10:07.957

有[py2exe](http://www.py2exe.org/)（[以及如何使用它的教程](http://www.ehow.com/how_2091641_compile-python-code.html)），但不能保证它会使您的脚本更快。实际上，它更像是一个包装字节码的可执行解释器。还有其他 exe 编译器对 python 代码执行不同程度的操作，因此您可能需要进行一般的 Google 搜索。

但是，您始终可以使用[psyco](http://psyco.sourceforge.net/doc.html)来提高 python 脚本可以执行的许多最密集操作的速度，即循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T21:15:14.730

如果您想要快速运行 Python，您可能不想将其作为 CGI 运行。查看代理、mod_python、WSGI 或 FastCGI，因为这些技术可以避免在每次请求时重新加载 python 运行时和您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:10:56.580

由于 RDBMS 和网络是瓶颈，我认为创建 EXE 没有任何价值。

平均而言，网站的大部分传输都是静态内容（图像、.CSS、.JS 等），最好由 Apache 处理，无需任何 Python 循环。这具有巨大的影响。

为创建动态 HTML 的“有趣”和“复杂”部分保留 Python。使用框架。

# computer-science - 什么本科计算机科学课程最能帮助程序员为工作做好准备？

> ID：895165
> 
> 赞同：18
> 
> 时间：2009-05-21T21:07:24.590
> 
> 标签：computer-science, generic-programming

这里的想法是让更好的程序员从大学毕业。

我想我必须使用算法，它不是你可以很容易地自己掌握的东西，我认为它可以让你更深入地看待软件的效率和正确性。

我也相信教授实际编程可能会有所帮助，但我学到了我在工作中学到的大部分编程知识，这让我认为其中一些编程课程块（不是全部）可以更好地使用。

这些结果将成为我想写给我以前学校的 CS 部门的一封信的一部分，我认为我参加的很多课程根本没有帮助，还有一些我认为非常宝贵的课程。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-21T21:20:19.540

我还没有找到一门很好的 CompSci 课程，可以让*软件工程师*为工作场所做好充分准备。如果您找到具有以下内容的软件[尽管我怀疑它是否可以称为 CompSci，它更像是真实世界的软件设计，它是一种非常不同的野兽]。

计算机科学是一门更具理论性的学科，具有非常现实的世界意义，但在学术方面更有用。例如，算法设计对软件工程师非常有帮助，但对消费者并没有真正的直接帮助。例如，知道如何构建快速排序算法，或者理解链表遍历并不是真的*如此*在当今的软件工程环境中很有用——当然，理解理论有助于为工作选择正确的工具，不要误会我的意思。作为开发人员，我们中的许多人依靠计算机科学世界的输出来改进我们的开发工具，事实上，如果没有它们，许多开发人员会陷入困境，但是把计算机科学专业的毕业生放在用户面前，让他们设计一个对他们来说有意义的软件和学术知识将分崩离析，因为两者使用完全不同的语言。

对于软件工程师来说，更有用的课程将包括我能想到的尽可能多的[甚至可能更多]以下组件：

*   **编程语言**- 基本的程序流程、范式、语法等。大部分都讲得很好，所以我不会过多地坚持这一点。尽管如果教授一些完全不同类别的编程语言会很有帮助——例如，我学习了 C、Pascal 和 VB 3（？我不记得确切的版本了）。如果程序员至少学会一门函数式语言、一门命令式语言、一门声明式语言，那将会更有帮助。
*   **调试**- 在编写 nTier 应用程序 [许多/大多数现实世界的应用程序是] 时，能够找出*哪里*出了问题，如果必要的话，直接到协议级别是很有用的。WireShark 等分析工具对此很有用。
*   **通信设备**- XML、XQuery、XPath、XSL、XSD [因为这些似乎被广泛使用]。
*   **关系数据库设计**- 这已经被很好地教授了。
*   **关系数据库性能调优**——仅仅设计表是不够的，知道什么时候适合索引某些字段，什么时候不适合也很重要，而且似乎很多课程都没有涵盖。
*   **数据规范化**在很多情况下，这似乎也被教授得相当好。尽管大多数学生似乎进入现实世界时会吐出他们所学的理论——“你应该总是使用 Boyce-Codd 范式”等，而没有真正考虑这些理论的含义。有时在现实世界中，我们有很好的理由违反规则。
*   **查询优化**- 编写基本查询通常似乎处于毕业生舒适区的外部界限，应该教授优化。此外，应该教授查询分析器等工具来帮助学生调试应用程序的性能问题。
*   **存储过程/触发器**- 我还没有遇到可以编写存储过程或触发器或有效使用其中任何一个的学生。选择/连接/嵌套选择似乎是查询设计所教内容的限制。
*   **基本算法**——根据我的经验，这点教得很好，但是很多学生似乎不知道如何决定哪些算法适用于哪些情况，而没有被告知“使用这样那样的算法，解决这个问题”。如果您可以说“解决这个问题”，那将很有用，他们会说，好吧，我有一组算法在这种情况下很有用，这是最好的，因为 x、y 或 z原因，这里是如何应用它来提供解决方案。
*   **递归**——我还没有找到一种可以教授递归的方法，看来你要么明白，要么不明白。有一天，我会找到一个很好的比喻，即使是最基本的程序员也能理解这一点。
*   **抽象**——这似乎是许多课程掩盖的东西，尽管它是 OOP 的核心原则之一。
*   **代码重构**——知道*什么时候*重构，几乎同样重要的是，什么时候*不*重构。
*   **代码重用**- 似乎很多课程都在吐出剪切/粘贴猴子 - 这*不是*代码重用的意思！
*   **源代码控制**- 在我的第 3 份或第 4 份编程工作之前，我没有学习源代码控制，而且我个人不知道有哪个软件工程师在他们的课程中学习了源代码控制......为什么会这样？
*   **备份和恢复**——我还没有听说过任何教授这个的课程。有多少初学者程序员因为没有*考虑*备份而失去了所有工作？我知道我过去有过——不过最近没有。不是我不知道备份，而是俗话说“它永远不会发生在我身上”。它*会*发生在你身上，并保证在你必须演示你刚刚失去的一切之前它会是正确的！
*   **文件系统维护**- 好的，一些课程简要地掩盖了这一点，但很多没有。
*   **编写高质量的设计规范**- 这似乎总是作为课程简介提供，但很少要求学生自己设计。编写工作范围和理解文档模板似乎远远超出了大多数软件课程的范围。
*   **用户文档**- 用户不会像您那样思考，将“自我解释”或“白痴可以使用它的简单软件”交给他们会在您的脸上炸开。有一句名言：“今天的编程是软件工程师努力构建更大更好的防白痴程序与宇宙试图产生更大更好的白痴之间的竞赛。到目前为止，宇宙正在获胜”。编写一个 8 岁的孩子可以遵循的用户文档 - 编写它可能看起来很痛苦，但一旦完成，并且永远更多，你会感谢自己。
*   **技术文档**- 即如果学生可以使用 Sandcastle、nDoc 或任何文档工具，将会很有用。
*   **测试计划**——设计允许测试的测试和软件。nUnit 或类似工具将是教授软件开发课程的绝佳工具。事实上，教授*任何*测试框架都比不教授任何测试框架要好……看起来就是这样。
*   **FAT/SAT/UAT 测试**- 这将有助于了解现实世界中的各种测试场景，例如健全性检查、工厂验收测试和用户验收测试。签署您的软件与开发软件一样重要。如果您没有交付客户认为他们得到的东西，那么您就不会获得报酬——无论您的解决方案在技术方面多么出色。
*   **软件架构**- 了解现实世界 n 层应用程序的不同组件，使用它们的优点和缺点。
*   **与用户的互动**——也许这不是真正的计算机科学，但学习如何与那些不经常在你的波长上并且不以你的方式思考的人交谈，这与交流有关，但确实是开发人员需要的东西要知道。
*   **常识**- 叮，叮，叮，叮 - 有很多程序员没有这个！这些课程旨在证明您可以独立思考，我不明白为什么这么多毕业生进入现实世界认为他们所要做的就是盲目地应用他们所教的规则，而不考虑原因和含义。我将重复我之前所说的——在现实世界中，我们有时会找到违反规则的很好的理由。我们不会盲目地跟随它们，我们也不会盲目地破坏它们。软件开发是一门艺术，就像所有艺术一样，我们必须知道什么时候可以，什么时候不能，同样重要的是，我们应该什么时候不应该违反规则。作为一名毕业生，你已经学会了规则，你已经证明了这一点。
*   **倾听**——你会惊讶于我看到代码编写的次数，因为开发人员“认为他们知道客户想要什么”，而不是真正倾听用户在说什么并了解他们的实际需求。
*   **理解**——与倾听齐头并进。
*   **沟通技巧**
*   **与技术上无能的人交谈**- 即您的大部分用户群
*   **项目调解**——把你的想法卖给那些写支票的人
*   **优先级**- 如何决定哪些功能比其他功能更重要。
*   **预算**- 时间估算
*   **时间管理**- 当你周围的每个人都在阻碍你的时间并且不关心你的最后期限时，如何按时完成工作。就像你所有的朋友都希望你去酒吧喝一品脱或十品脱一样，而你有一份尚未开始的课程作业，明天结束时要完成。
*   **范围蔓延**- 什么时候说，不，那不在规范/预算中。

即使你*确实*设法在你的课程中学到了所有这些，我敢说你*仍然*会在一个体面的软件开发咨询公司实习三四个月，而不是在整个课程中学到更多。在获得学士学位后的前 6 个月里，我学到的东西比我整个 3 年课程中学到的更多。*诚然，如果没有*我在该课程中学到的许多东西，我会面无表情，但是有太多不必要的内容可以用更有用的内容代替。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-21T21:21:21.210

你暑假在一家实际的公司编写软件的课程。

说真的 - CS 课程并不是为了培养优秀的程序员。它们旨在培养计算机科学家，作为副作用，他们也可以编写软件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T21:11:10.217

计算机科学！=编程。

如果您正在寻找更好的程序员，请寻找具有 2 年制大学课程教育且专门专注于此的人。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-21T21:13:05.203

*   商务101
*   办公室政治200
*   在现实世界中没有什么是学术的

实际上，从第一天开始，您就不会被期望成为一名高级开发人员。实际上，学习一些编码基础知识肯定会让您走很长一段路，但是随着时间的推移，我看到不少计算机科学专业的学生在现实世界中挣扎因为他们并不真正知道自己在第一天会做什么。他们在业务领域中挣扎，并理解他们为什么要做他们所做的事情。他们不知道该与谁交流。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-21T21:14:54.810

没有什么比通过构建项目获得的知识更好的了.

你只能通过“编程”成为更好的程序员，而不仅仅是学习课程并获得高 GPA。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-21T21:28:19.667

最重要和最相关的不是 CS 课程。你需要好好沟通。无论您上什么课程，您都可以成为更好的听众/读者和更好的作家/演讲者。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-21T21:15:41.547

这是一个很难回答的问题，但我认为在许多 CS 程序中*阻碍*程序员的一件事是缺乏动手编码。了解计算机科学的理论很重要，但我认为很多理论性很强的 CS 课程因为不需要在课程中进行编程练习而失败。例如，我见过很多需要研究和论文的 AI 类，但不需要代​​码。在我看来，理解计算机科学的理论非常重要，但能够应用它也同样重要。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-21T21:46:43.637

我认为学术的空白应该由学生组织或独立的学生项目来填补。

在我的大学，我们有专门针对 CS 学生[的计算机协会](http://www.acm.org)学生分会，我们还有一个致力于视频游戏开发的学生组织。这些组织通过从行业中引进演讲者并强迫学生相互合作，帮助向学生传授“现实世界”。

如果学生对领先的软件团体感兴趣，或者如果学生想要在技术上更加熟练，那么我还建议主修计算机科学辅修商业的学生，​​他们辅修文科。我知道这看起来很奇怪，但我这样做了，我发现它实际上教你如何在纯粹的技术和数学视角之外进行思考，以及如何将人类思维应用于软件开发。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-21T21:13:45.687

我想说这是数据库系统和软件工程项目课程之间的联系。在我的学校，这两个课程都不是本科学位所必需的，但本科生可以参加。对于大多数程序员来说，掌握一些数据库知识可能比算法更重要。在项目团队中工作，甚至在课程项目中，可以帮助您了解团队动态以及如何在团队环境中工作。

另一方面，我坚信对基础计算机科学主题的良好理解，包括数据结构、算法、操作系统等，对于准备一个程序员成长是至关重要的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-21T21:36:52.877

我在谢菲尔德大学的软件工程学位中与工作场所最相关的两个是第二年的 Software Hut 模块，该模块涉及在一个学期内为现实世界的客户生产软件产品的团队。我认为有三个不同的客户，团队相互竞争，为他们生产最好的系统。

然后在第四年，三分之一的成绩来自经营一家软件公司，同样是为现实世界的客户服务。虽然不完全像经营一家实际的企业，但由于我们生产的任何产品都受到知识产权限制（因为我们还是大学的学生，他们拥有这项工作），但我们确实参与了经营公司的大部分方面——禁止任何会计/合同写作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T21:11:54.927

数据库设计

函数式编程

面向对象编程

x 驱动设计

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-21T21:27:52.380

我的看法（作为一名英语 IT 主管）是，办公室的一天值得在学校呆一周，因此，如果你能找到一种获得一些经验的方法，那将是值得的。

除此之外，只要对自己的能力充满信心，发挥自己的优势，并准备好用谷歌搜索任何你不知道的东西！

如果您想从普通的 IT 人群中脱颖而出，那么请确保您能够正常沟通，因为令人惊讶的是有多少“顶尖”毕业生无法做到。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-21T21:38:11.283

这一切都取决于你想要编程什么以及你对什么样的问题感兴趣。

显然，一般的组合

*   **离散数学**（你的逻辑、图论、一些数论和递归）

*   **算法设计**（学习各种解决问题的模型、设计范式、思考计算机资源）

*   **像这样的软件工程**（管理软件项目、使用现有组件、成对或成组工作、版本控制、模式等 [）](http://www.ccs.neu.edu/home/kenb/csg110/)

*   **编程强化**课程（我参加了[这门课程](http://www.ccs.neu.edu/home/matthias/107-f08/index.html)），教你解决问题的一般思路，在编写一行代码之前收集你的想法，接触不同的编程范式

    将为您应对大多数编程挑战做好准备。

之后，这一切都取决于您要在哪个域上工作。问问你的导师、你大学的前辈和教授，和他们谈谈你的目标和兴趣。他们会比这里的任何人都更好地为您提供建议。

但是不要忽视批判性思维，写作课。参加可以让您展示自己的想法并为公开演讲做好准备的课程。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-21T21:39:56.867

大学毕业就成为更好的程序员？直到学校开始教授内聚、耦合、良好的编程实践、版本控制、配置管理、现代开发模型等概念——我不这么认为。我通常看到的是自学者希望自己做正确的事情，或者如果他们幸运地被雇用到一个宣扬和实践好的事情的组织中。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-21T22:16:33.843

我认为我学到的最多的课程是**数据结构和算法**。知识独立于技术的进步，它提供了各类程序员使用的基本工具。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-21T23:59:19.253

我们需要一门课程来构建某种社区服务项目。这要求我们使用和学习整个软件工程策略。

尽管如此，除非老师决定在课堂上放一些古怪的东西，目的是让事情变得尽可能困难，否则这样的课程将大大缺乏......

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-10-18T21:11:59.447

本科期间的数据结构和算法课程对我的工作有很大帮助

# wmi - 为什么 wmi 处理 win32_xxx 查询比 cim_xxx 查询快？

> ID：895169
> 
> 赞同：0
> 
> 时间：2009-05-21T21:08:12.997
> 
> 标签：wmi

PS D:\work\scripts> 测量命令 { get-wmiobject -query "select * from win32_service" | Where-Object -FilterScript {$ _.Name -eq "WinRM"} }

天：0小时：0分钟：0秒：0毫秒：426刻度：4​​262955总待日：4.933975694444444E-06总价：0.0001184154166666666667总数

PS D:\work\scripts> 测量命令 { get-wmiobject -query "select * from cim_service" | Where-Object -FilterScript {$_. 名称 -eq "WinRM"} }

天：0小时：0分钟：1秒：35毫秒：320滴答：953208058总待日：0.00110325006712963总价：0.026478001611111111111111111111111111111111111同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T23:43:06.017

这很简单——通过查询 CIM_Service 可以检索更多信息（因为 CIM 服务不受 Win32 服务的限制；而且 win32_service 实例包含在 CIM_Service 中）。也就是说 - 您的查询在检索到的数据量方面存在显着差异。

您可以通过 WMI CIM Studio 轻松探索它。

# c++ - 堆叠 Cg 着色器

> ID：895170
> 
> 赞同：1
> 
> 时间：2009-05-21T21:08:21.377
> 
> 标签：c++, graphics, shader, cg

在我的引擎中，我从成对的顶点/像素着色器文件中加载 Cg 着色器。我希望能够堆叠着色器来组合它们（照明+材质等）。除了将着色器分解为单独的函数，然后从中创建单个着色器脚本字符串之外，您知道在 Cg 中堆叠不同着色器的任何好方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-14T09:50:15.307

听起来有点像你想要的类似于 DirectX 11 中的动态着色器链接功能？Cg 的接口特性可以让你完成类似的事情。它允许您重新配置着色器，以便您可以轻松、干净地执行诸如更改照明计算方式或更改材质类型之类的操作。

例如，假设您想编写一个着色器，但需要能够更改计算光照的方式。您可以定义一个 Light 接口，该接口具有以某种方式计算光线的函数。在其他地方，您可以将 Light 接口实现为例如 CoolLight 和 UberLight。在运行时，您可以指定应使用 Light 接口的哪个实现，其方式与指定其他参数的方式几乎相同。

要查看这是否是您想要的，我建议您查看 Cg 用户手册（[http://developer.download.nvidia.com/cg/Cg_2.2/CgUsersManual.pdf](http://developer.download.nvidia.com/cg/Cg_2.2/CgUsersManual.pdf)）。如果您搜索“共享参数和接口”，则有一个小示例。

# jquery - 按 Enter 阻止用户提交表单

> ID：895171
> 
> 赞同：906
> 
> 时间：2009-05-21T21:09:25.070
> 
> 标签：jquery, html, forms, form-submit

我在网站上进行了一项调查，用户按 Enter 键（我不知道为什么）并在未单击提交按钮的情况下意外提交了调查（表单）似乎存在一些问题。有没有办法防止这种情况？

我在调查中使用 HTML、PHP 5.2.9 和 jQuery。

* * *

## 回答 #1

> 赞同：988
> 
> 时间：2009-05-21T21:19:10.760

您可以使用诸如

```
$(document).ready(function() {
  $(window).keydown(function(event){
    if(event.keyCode == 13) {
      event.preventDefault();
      return false;
    }
  });
}); 
```

在阅读原始帖子的评论时，为了使其更有用并允许人们在`Enter`完成所有字段时按下：

```
function validationFunction() {
  $('input').each(function() {
    ...

  }
  if(good) {
    return true;
  }
  return false;
}

$(document).ready(function() {
  $(window).keydown(function(event){
    if( (event.keyCode == 13) && (validationFunction() == false) ) {
      event.preventDefault();
      return false;
    }
  });
}); 
```

* * *

## 回答 #2

> 赞同：724
> 
> 时间：2009-12-29T21:42:39.883

## 禁止在任何地方输入键

如果您的表单中没有 a `<textarea>`，则只需将以下内容添加到您的`<form>`:

```
<form ... onkeydown="return event.key != 'Enter';"> 
```

或者使用 jQuery：

```
$(document).on("keydown", "form", function(event) { 
    return event.key != "Enter";
}); 
```

这将导致表单内的每个按键都将在`key`. 如果不是`Enter`，那么它将返回`true`并且一切照常继续。如果是`Enter`，那么它将返回`false`并且任何事情都会立即停止，因此不会提交表单。

该[`keydown`](https://developer.mozilla.org/en-US/docs/Web/API/Document/keydown_event)事件优先[`keyup`](https://developer.mozilla.org/en-US/docs/Web/API/Document/keyup_event)于`keyup`阻止表单提交为时已晚。历史上也有[`keypress`](https://developer.mozilla.org/en-US/docs/Web/API/Document/keypress_event)，但已弃用，就像[`KeyboardEvent.keyCode`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode). 您应该[`KeyboardEvent.key`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)改用它返回被按下的键的名称。选中时`Enter`，将检查 13（正常输入）和 108（小键盘输入）。

请注意，`$(window)`正如其他一些答案中所建议的那样，而不是`$(document)`不适用于IE<=8 中的`keydown`/ `keyup`，因此，如果您也想涵盖那些可怜的用户，那么这不是一个好的选择。

## 仅允许在 textareas 上输入键

如果您`<textarea>`的表单中有 a （当然*应该*接受 Enter 键），则将 keydown 处理程序添加到不是`<textarea>`.

```
<input ... onkeydown="return event.key != 'Enter';">
<select ... onkeydown="return event.key != 'Enter';">
... 
```

为了减少样板，最好使用 jQuery 来完成：

```
$(document).on("keydown", ":input:not(textarea)", function(event) {
    return event.key != "Enter";
}); 
```

如果您在这些输入元素上附加了其他事件处理函数，出于某种原因您还想在输入键上调用它们，那么只阻止事件的默认行为而不是返回 false，以便它可以正确传播到其他处理程序。

```
$(document).on("keydown", ":input:not(textarea)", function(event) {
    if (event.key == "Enter") {
        event.preventDefault();
    }
}); 
```

## 只允许在 textareas 上输入键和提交按钮

如果您也想在提交按钮上允许输入键`<input|button type="submit">`，那么您可以随时优化选择器，如下所示。

```
$(document).on("keydown", ":input:not(textarea):not(:submit)", function(event) {
    // ...
}); 
```

请注意，`input[type=text]`正如其他一些答案中所建议的那样，它不涵盖那些 HTML5 非文本输入，因此这不是一个好的选择器。

* * *

## 回答 #3

> 赞同：233
> 
> 时间：2018-07-24T21:29:32.303

W3C HTML5 规范的[第 4.10.22.2 节隐式提交说：](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#implicit-submission)

> [`form`](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#the-form-element)元素的默认**按钮**是按[树形顺序排列的第一个](https://www.w3.org/TR/2018/SPSD-html5-20180327/infrastructure.html#tree-order)[提交按钮](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#concept-submit-button)，其[表单所有者](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#form-owner)是该元素。[`form`](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#the-form-element)
> 
> 如果用户代理支持让用户隐式提交表单（例如，在某些平台上，当文本字段聚焦时，按下“enter”键会隐式提交表单），那么对于[默认按钮](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#default-button)已定义[激活的表单执行此操作行为](https://www.w3.org/TR/2018/SPSD-html5-20180327/dom.html#activation-behavior)必须导致用户代理在该[默认按钮上](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#default-button)[运行合成点击激活步骤](https://www.w3.org/TR/2018/SPSD-html5-20180327/dom.html#run-synthetic-click-activation-steps)。
> 
> > **注意：**因此，如果禁用[默认按钮](https://www.w3.org/TR/2018/SPSD-html5-20180327/forms.html#default-button)，则在使用这种隐式提交机制时不会提交表单。（按钮在禁用时没有[激活行为](https://www.w3.org/TR/2018/SPSD-html5-20180327/dom.html#activation-behavior)。）

因此，禁用任何隐式提交表单的符合标准的方法是将禁用的提交按钮作为表单中的第一个提交按钮：

```
<form action="...">
  <!-- Prevent implicit submission of the form -->
  <button type="submit" disabled style="display: none" aria-hidden="true"></button>

  <!-- ... -->

  <button type="submit">Submit</button>
</form> 
```

这种方法的一个很好的特点是它可以*在没有 JavaScript*的情况下工作。无论是否启用 JavaScript，都需要符合标准的 Web 浏览器来防止隐式提交表单。

* * *

## 回答 #4

> 赞同：70
> 
> 时间：2012-03-27T13:57:03.087

我必须捕获与按键相关的所有三个事件，以防止表单被提交：

```
 var preventSubmit = function(event) {
        if(event.keyCode == 13) {
            console.log("caught ya!");
            event.preventDefault();
            //event.stopPropagation();
            return false;
        }
    }
    $("#search").keypress(preventSubmit);
    $("#search").keydown(preventSubmit);
    $("#search").keyup(preventSubmit); 
```

您可以将以上所有内容组合成一个不错的紧凑版本：

```
 $('#search').bind('keypress keydown keyup', function(e){
       if(e.keyCode == 13) { e.preventDefault(); }
    }); 
```

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2013-07-24T16:29:33.270

如果您使用脚本进行实际提交，那么您可以将“return false”行添加到 onsubmit 处理程序，如下所示：

```
<form onsubmit="return false;"> 
```

从 JavaScript 对表单调用 submit() 不会触发事件。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2014-05-30T12:36:09.703

采用：

```
$(document).on('keyup keypress', 'form input[type="text"]', function(e) {
  if(e.keyCode == 13) {
    e.preventDefault();
    return false;
  }
}); 
```

此解决方案适用于网站上的所有表单（也适用于使用 Ajax 插入的表单），仅防止`Enter`输入文本中出现 s。把它放在一个文件准备功能中，一辈子忘记这个问题。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2009-05-21T21:35:27.250

您可以保留表单并添加一些额外的客户端验证，而不是阻止用户按`Enter`，这可能看起来不自然完成表格需要完成什么。如果您使用的是 jQuery，请尝试 Validation 插件：

[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

这将需要比抓住`Enter`按钮更多的工作，但它肯定会提供更丰富的用户体验。

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2011-12-09T20:35:12.873

一个不错的简单的小 jQuery 解决方案：

```
$("form").bind("keypress", function (e) {
    if (e.keyCode == 13) {
        return false;
    }
}); 
```

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2014-08-07T21:28:18.057

我还不能评论，所以我会发布一个新的答案

接受的答案是好的，但它并没有停止在小键盘输入上提交。至少在当前版本的 Chrome 中。我必须将键码条件更改为此，然后它才能工作。

```
if(event.keyCode == 13 || event.keyCode == 169) {...} 
```

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2017-02-20T11:28:33.150

完全不同的方法：

1.  **表格中的第一个`<button type="submit">`将在按下时激活`Enter`。**
2.  即使按钮被隐藏也是如此`style="display:none;`
3.  **该按钮的脚本可以返回`false`，这会中止提交过程。**
4.  您仍然可以让另一个`<button type=submit>`人提交表格。只需返回`true`级联提交即可。
5.  在真正的提交按钮集中时按下`Enter`将激活真正的提交按钮。
6.  按`Enter`内部`<textarea>`或其他表单控件将正常运行。
7.  按`Enter`内部`<input>`表单控件将触发第一个`<button type=submit>`，它返回`false`，因此没有任何反应。

因此：

```
<form action="...">
  <!-- insert this next line immediately after the <form> opening tag -->
  <button type=submit onclick="return false;" style="display:none;"></button>

  <!-- everything else follows as normal -->
  <!-- ... -->
  <button type=submit>Submit</button>
</form> 
```

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2017-03-23T23:57:55.470

这是我达到目标的解决方案，它干净有效。

```
$('form').submit(function () {
  if ($(document.activeElement).attr('type') == 'submit')
     return true;
  else return false;
}); 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2017-05-30T05:29:44.250

不放提交按钮就可以了。只需将脚本放入输入（type=button）或添加 eventListener 如果您希望它提交表单中的数据。

而是使用这个

```
<input type="button"> 
```

比使用这个

```
<input type="submit"> 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2012-04-27T11:49:19.950

为表单提供 'javascript:void(0);' 的操作 似乎可以解决问题

```
<form action="javascript:void(0);">
<input type="text" />
</form>
<script>
$(document).ready(function() {
    $(window).keydown(function(event){
        if(event.keyCode == 13) {
    alert('Hello');
        }
    });
});
</script> 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2017-08-15T06:08:31.940

1.  不要将**type="submit"**用于输入或按钮。
2.  使用**type="button"**并使用 js [Jquery/angular/etc] 将表单提交到服务器。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2019-12-11T17:48:00.700

这是完美的方式，您不会被重定向到您的页面

```
$('form input').keydown(function (e) {
if (e.keyCode == 13) {
    e.preventDefault();
    return false;
}
}); 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2013-10-12T23:32:27.033

我需要防止只提交特定的输入，所以我使用了一个类选择器，让它成为我需要的“全局”特性。

```
<input id="txtEmail" name="txtEmail" class="idNoEnter" .... /> 
```

这个jQuery代码：

```
$('.idNoEnter').keydown(function (e) {
  if (e.keyCode == 13) {
    e.preventDefault();
  }
}); 
```

或者，如果 keydown 不足：

```
$('.idNoEnter').on('keypress keydown keyup', function (e) {
   if (e.keyCode == 13) {
     e.preventDefault();
   }
}); 
```

一些注意事项：

在这里修改各种好的答案，`Enter`关键似乎适用`keydown`于所有浏览器。作为替代方案，我更新`bind()`了该`on()`方法。

我是类选择器的忠实粉丝，权衡所有的利弊和性能讨论。我的命名约定是“idSomething”，表示 jQuery 将其用作 id，将其与 CSS 样式分开。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2019-09-04T11:44:28.953

您还可以使用`javascript:void(0)`来阻止表单提交。

```
<form action="javascript:void(0)" method="post">
    <label for="">Search</label>
    <input type="text">
    <button type="sybmit">Submit</button>
</form> 
```

```
<form action="javascript:void(0)" method="post">
    <label for="">Search</label>
    <input type="text">
    <button type="sybmit">Submit</button>
</form>
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2018-10-02T20:30:15.287

这里已经有很多好的答案，我只是想从用户体验的角度贡献一些东西。表单中的键盘控件*非常*重要。

问题是如何禁用 keypress 上的提交`Enter`。不是如何`Enter`在整个应用程序中忽略。所以考虑将处理程序附加到表单元素，而不是窗口。

禁用`Enter`表单提交仍应允许以下操作：

1.  通过`Enter`提交按钮获得焦点时提交表单。
2.  填写所有字段后提交表单。
3.  通过 与非提交按钮交互`Enter`。

这只是样板，但它遵循所有三个条件。

```
$('form').on('keypress', function(e) {
  // Register keypress on buttons.
  $attr = $(e.target).attr('type');
  $node = e.target.nodeName.toLowerCase();
  if ($attr === 'button' || $attr === 'submit' || $node === 'textarea') {
    return true;
  }

  // Ignore keypress if all fields are not populated.
  if (e.which === 13 && !fieldsArePopulated(this)) {
    return false;
  }
});
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-05-21T21:15:39.020

您可以创建一个 JavaScript 方法来检查`Enter`键是否被击中，如果是，则停止提交。

```
<script type="text/javascript">
  function noenter() {
  return !(window.event && window.event.keyCode == 13); }
</script> 
```

只需在提交方法上调用它。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2017-12-07T19:39:02.870

ONLY BLOCK SUBMIT 但不是其他重要的 enter 键功能，例如在 a 中创建一个新段落`<textarea>`：

```
window.addEventListener('keydown', function(event) {
  //set default value for variable that will hold the status of keypress
  pressedEnter = false;

  //if user pressed enter, set the variable to true
  if (event.keyCode == 13)
    pressedEnter = true;

  //we want forms to disable submit for a tenth of a second only
  setTimeout(function() {
    pressedEnter = false;
  }, 100)

})

//find all forms
var forms = document.getElementsByTagName('form')

//loop through forms
for (i = 0; i < forms.length; i++) {
  //listen to submit event
  forms[i].addEventListener('submit', function(e) {
    //if user just pressed enter, stop the submit event
    if (pressedEnter == true) {
      updateLog('Form prevented from submit.')
      e.preventDefault();
      return false;
    }

    updateLog('Form submitted.')
  })
}

var log = document.getElementById('log')
updateLog = function(msg) {
  log.innerText = msg
}
```

```
input,
textarea {
  display: inline-block;
  margin-bottom: 1em;
  border: 1px solid #6f6f6f;
  padding: 5px;
  border-radius: 2px;
  width: 90%;
  font-size: 14px;
}

input[type=submit] {
  background: lightblue;
  color: #fff;
}
```

```
<form>
  <p>Sample textarea (try enter key):</p>
  <textarea rows="4">Hit enter, a new line will be added. But the form won't submit</textarea><br/>
  <p>Sample textfield (try enter key):</p>
  <input type="text" placeholder="" />
  <br/>
  <input type="submit" value="Save" />
  <h3 id="log"></h3>
</form>
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-06-12T11:27:36.073

```
$(document).on("keydown","form", function(event)
{
   node = event.target.nodeName.toLowerCase();
   type = $(event.target).prop('type').toLowerCase();

   if(node!='textarea' && type!='submit' && (event.keyCode == 13 || event.keyCode == 169))
   {
        event.preventDefault();
        return false;
    }
}); 
```

它完美地工作！

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2021-09-14T09:10:45.220

如果使用 Vue，请使用以下代码来阻止用户通过点击提交表单`Enter`：

```
<form @submit.prevent>...</form> 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2012-07-19T11:45:52.893

我有一个类似的问题，我有一个带有“ajax 文本字段”（Yii CGridView）的网格，只有一个提交按钮。每次我在文本字段上进行搜索并点击输入提交的表单。我不得不对按钮做一些事情，因为它是视图之间唯一的公共按钮（MVC 模式）。我所要做的就是移除`type="submit"`并放置`onclick="document.forms[0].submit()`

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2013-07-28T17:57:08.247

我认为它很好地涵盖了所有答案，但是如果您使用带有一些 JavaScript 验证代码的按钮，您可以将表单的 onkeypress 设置为 Enter 以按预期调用您的提交：

```
<form method="POST" action="..." onkeypress="if(event.keyCode == 13) mySubmitFunction(this); return false;"> 
```

onkeypress JS 可以是您需要做的任何事情。没有必要进行更大的全球性变革。如果您不是从头开始编写应用程序的人，并且您已经被带入修复其他人的网站而没有将其拆开并重新测试，则尤其如此。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-08-24T12:31:01.500

我在这里没有看到回答：当您浏览页面上的元素时，`Enter`当您到达提交按钮时按下将触发表单上的 onsubmit 处理程序，但它会将事件记录为 MouseEvent。这是我涵盖大多数基础的简短解决方案：

***这不是与 jQuery 相关的答案***

### HTML

```
<form onsubmit="return false;" method=post>
  <input type="text" /><br />
  <input type="button" onclick="this.form.submit()" value="submit via mouse or keyboard" />
  <input type="button" onclick="submitMouseOnly(event)" value="submit via mouse only" />
</form> 
```

### JavaScript

```
window.submitMouseOnly=function(evt){
    let allow=(evt instanceof MouseEvent) && evt.x>0 && evt.y>0 && evt.screenX > 0 && evt.screenY > 0;
    if(allow)(evt.tagName=='FORM'?evt.target:evt.target.form).submit();
} 
```

要找到一个工作示例：[https ://jsfiddle.net/nemesarial/6rhogva2/](https://jsfiddle.net/nemesarial/6rhogva2/)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-06-19T14:40:26.313

使用**Javascript**（不检查任何输入字段）：

```
<script>
window.addEventListener('keydown', function(e) {
    if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) {
        e.preventDefault();
        return false;
    }
}, true);
</script> 
```

如果有人想将此应用于特定字段，例如输入类型文本：

```
<script>
window.addEventListener('keydown', function(e) {
    if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) {
        if (e.target.nodeName == 'INPUT' && e.target.type == 'text') {
            e.preventDefault();
            return false;
        }
    }
}, true);
</script> 
```

这在我的情况下效果很好。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-08-30T09:14:11.343

我已使用此代码禁用输入类型 [文本] 和输入类型 [密码] 上的“ENTER”键，您可以添加其他输入类型 [电子邮件] 或也可以应用于您想要的输入类型。

```
$(document).on('keyup keypress', 'form input[type="text"] , input[type="password"]', function(e) {
        if (e.keyCode == 13) {
            e.preventDefault();
            return false;
        }
    }); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-08-16T17:35:36.210

在我的具体情况下，我必须阻止 ENTER 提交表单并模拟单击提交按钮。这是因为提交按钮上有一个点击处理程序，因为我们在一个模式窗口中（继承旧代码）。无论如何，这是我针对这种情况的组合解决方案。

```
 $('input,select').keypress(function(event) {
        // detect ENTER key
        if (event.keyCode == 13) {
            // simulate submit button click
            $("#btn-submit").click();
            // stop form from submitting via ENTER key press
            event.preventDefault ? event.preventDefault() : event.returnValue = false;
        }
    }); 
```

这个用例对使用 IE8 的人特别有用。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2013-03-14T17:02:02.163

这对我有用

```
jQuery.each($("#your_form_id").find('input'), function(){
    $(this).bind('keypress keydown keyup', function(e){
       if(e.keyCode == 13) { e.preventDefault(); }
    });
}); 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2013-08-01T02:16:04.483

我想添加一些 CoffeeScript 代码（未经现场测试）：

```
$ ->
    $(window).bind 'keypress', (event) ->
        if event.keyCode == 13
            unless {'TEXTAREA', 'SELECT'}[event.originalEvent.srcElement.tagName]
                event.preventDefault() 
```

（我希望你喜欢 unless 子句中的妙招。）

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-08-14T17:04:14.417

进入您的css并将其添加到其中，然后只要您有提交输入，如果您不再需要它，您可以将其删除或键入`activate`，`deactivate`而是自动阻止公式的提交

```
 input:disabled {
        background: gainsboro;
      }
      input[value]:disabled {
        color: whitesmoke;
      } 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-03-30T04:34:34.933

这会禁用页面上所有表单的输入键，并且不会阻止在 textarea 中输入。

```
 // disable form submit with enter

    $('form input:not([type="submit"])').keydown((e) => {
        if (e.keyCode === 13) {
            e.preventDefault();
            return false;
        }
        return true;
    }); 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2022-01-27T12:34:22.450

如果您使用的是 Alpine，您可以使用以下命令来阻止表单提交`Enter`：

```
<div x-data>
  <form x-on:keydown.prevent.enter="">...</form>
</div> 
```

或者，您可以使用`.window`修饰符在页面上的根`window`对象而不是元素上注册事件侦听器。

```
<form>
  <div x-data>
    <input x-on:keydown.window.prevent.enter="" type="text">
  </div>
</form> 
```

* * *

## 回答 #34

> 赞同：-2
> 
> 时间：2009-12-29T21:36:33.557

在对其他解决方案感到非常沮丧之后，这在所有浏览器中都对我有用。name_space 外部函数只是为了避免声明全局变量，我也建议这样做。

```
$(function() {window.name_space = new name_space();}); //jquery doc ready
function name_space() {
    this.is_ie = (navigator.userAgent.indexOf("MSIE") !== -1);

    this.stifle = function(event) {
        event.cancelBubble;
        event.returnValue = false;
        if(this.is_ie === false) {
            event.preventDefault();
        }
        return false;
    }

    this.on_enter = function(func) {
        function catch_key(e) {
            var enter = 13;
            if(!e) {
                var e = event;
            }
            keynum = GetKeyNum(e);
            if (keynum === enter) {
                if(func !== undefined && func !== null) {
                    func();
                }
                return name_space.stifle(e);
            }
            return true; // submit
        }

        if (window.Event) {
            window.captureEvents(Event.KEYDOWN);
            window.onkeydown = catch_key;
        }
        else {
            document.onkeydown = catch_key;
        }

        if(name_space.is_ie === false) {
            document.onkeypress = catch_key;    
        }
    }
} 
```

样品用途：

```
$(function() {
    name_space.on_enter(
        function () {alert('hola!');}
    );
}); 
```

* * *

## 回答 #35

> 赞同：-2
> 
> 时间：2012-11-09T04:55:47.097

采用：

```
// Validate your form using the jQuery onsubmit function... It'll really work...

$(document).ready(function(){
   $(#form).submit(e){
       e.preventDefault();
       if(validation())
          document.form1.submit();
   });
});

function validation()
{
   // Your form checking goes here.
}

<form id='form1' method='POST' action=''>
    // Your form data
</form> 
```

* * *

## 回答 #36

> 赞同：-3
> 
> 时间：2016-01-12T10:20:10.367

就我而言，我在一个表单中有几个[jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)自动完成字段和文本区域，所以我绝对希望他们接受`Enter`. 所以我`type="submit"`从表单中删除了输入并添加了一个锚点`<a href="" id="btn">Ok</a>`。然后我将其设置为按钮并添加以下代码：

```
$( '#btn' ).click( function( event ){
    event.preventDefault();
    if ( validateData() ){
        $( 'form#frm' ).append( '<input type="submit" id="frm-submit" style="display:none;"></input>' );
        setTimeout( function(){ $( '#frm-submit' ).click(); }, 500 );
    }
    return false;
}); 
```

如果用户填写了所有必填字段，`validateData()`则成功并提交表单。

# javascript - 如何在没有“this”的情况下获取元素的索引？

> ID：895179
> 
> 赞同：0
> 
> 时间：2009-05-21T21:10:36.237
> 
> 标签：javascript, jquery

我有一个看起来像这样的表格：

```
<div>
    <div class="contact">
        <h1>Person's name</h1>
        <!-- more stuff goes here -->
        <form method="post" action="myurl">
            <input type="submit" value="go" />
        </form>
    </div>
    <div class="contact">
        <h1>Another name</h1>
        <!-- more stuff goes here -->
        <form method="post" action="myOtherUrl">
            <input type="submit" value="go" />
        </form>
    </div>
</div> 
```

我正在使用 jQuery 来捕获表单的`submit`事件，并且需要获取`div`包含提交它的按钮的索引。通常我会[`index()`](http://docs.jquery.com/Core/index)像这样使用jQuery的函数：

```
var i = $(this).parents('.contact').index(this); 
```

不幸的是，`this`在这种情况下，操作员指的`form`是正在提交的。我想我可能缺少一些简单的东西，但我的脑海里对此一片空白。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T21:13:41.473

把事情简单化：

```
var parent = $(this).closest('div.contact'); // get containing DIV
var i = $('div.contact').index(parent); // get index relative to the rest 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T22:52:02.010

```
var i = $(this).parents('.contact:first').prevAll('.contract').length 
```

# php - 如何在这里摆脱 PHP 通知？

> ID：895188
> 
> 赞同：0
> 
> 时间：2009-05-21T21:11:58.590
> 
> 标签：php, notice

```
function t1()
{
  echo 1;
}
function t2()
{ 
  echo 2;
}

$funcs = array(t1,t2);

$length = count($funcs);
for($i=0;$i<$length;$i++)
{
$funcs[$i]();
} 
```

当我执行这个小 php 文件时：

PHP 注意：使用未定义的常量 t1 - 在第 11 行的 D:\jobirn\test\str.php 中假定为 't1'

PHP 注意：使用未定义的常量 t2 - 在第 11 行的 D:\jobirn\test\str.php 中假定为 't2'

我怎样才能摆脱这些通知？12

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T21:48:09.127

您会收到通知，因为 PHP 不将函数视为第一类对象。当你这样做时

```
$functions = array(t1, t2); 
```

PHP 引擎看到 t1 和 t2，并尝试将其解析为常量，但由于找不到名为 t1/t2 的常量，它“假定”您要键入 array('t1', 't2'); 如果您执行 var_dump($functions)，您可以看到数组中的项目是字符串。

当您尝试将字符串作为函数调用时，例如

```
$functions[0]() 
```

PHP 将寻找与字符串同名的函数。我不会将其称为使用字符串作为函数指针，这更像是使用反射。PHP 称之为“变量函数”，参见：

[http://hu2.php.net/manual/en/functions.variable-functions.php](http://hu2.php.net/manual/en/functions.variable-functions.php)

因此，摆脱通知的正确方法是：

```
$functions = array('t1', 't2'); 
```

关于为什么

```
't1'(); 
```

不行？不幸的是，没有答案。它是 PHP，有很多令人讨厌的怪癖。这与以下怪癖相同：

```
explode(':', 'one:two:three')[0];
Parse error: syntax error, unexpected '[' in php shell code on line 1 
```

编辑：
上面提到的数组引用语法在 PHP5.4 中可用，它被称为数组解引用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T21:17:20.203

```
$funcs = array('t1','t2'); 
```

不直观，但这就是它的工作原理

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T21:16:01.733

解决此问题的方法是将 php.ini 设置从

```
error_reporting = E_ALL 
```

到

```
error_reporting = E_ALL & ~E_NOTICE 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:15:12.827

查看 error_reporting() 函数：

[http://us2.php.net/manual/en/function.error-reporting.php](http://us2.php.net/manual/en/function.error-reporting.php)

它允许您配置显示的错误、通知和警告级别。

例如，如果您想要错误和警告并且没有通知：

错误报告（E_ERROR | E_WARNING）；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T21:16:48.737

如果您指的是字符串，请使用[字符串声明：](http://docs.php.net/manual/en/language.types.string.php)

```
$funcs = array('t1','t2'); 
```

另请参阅PHP 手册中[有关可变函数的章节。](http://docs.php.net/manual/en/functions.variable-functions.php)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-21T22:03:52.340

要使用字符串调用函数，您应该使用花括号

```
'hello'() // wont work
$hello = 'hello'; $hello() // will work 
```

编辑它似乎 {''}() 不起作用。我记得它曾经>.<

# iphone - 将数据从模态导航控制器传递到父控制器？

> ID：895191
> 
> 赞同：1
> 
> 时间：2009-05-21T21:12:45.437
> 
> 标签：iphone

我开始从事 iPhone 开发，我正在尝试使用联系人样式的控制器将项目添加到表格中。我已经设计了两个控制器，但我似乎无法弄清楚如何在它们之间传递数据。如何从模态控制器获取数据到其父级？

仅仅试图调用 parentViewController 上的方法是行不通的（并导致编译器警告和崩溃）。我已经考虑将数据移出控制器本身（无论如何这都会发生，我现在只是想让事情尽可能简单），但即便如此我仍然必须以某种方式告诉父视图刷新它的数据。再说一次，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T20:40:41.223

> 我已经考虑将数据移出控制器本身（无论如何都会发生

我认为现在可能是时候遵循这一考虑并创建一个单独的“ContactList”模型对象来存储您的数据。

您的模态视图控制器只是将新的“联系人”添加到“联系人列表”中。

您的 TableViewController 应该遵守相同的“ContactList”。随着项目被添加到/从“ContactList”中删除，您的 TableViewController 将简单地从其 tableView 中添加和删除行。

通过这种方式，您将保持每个 ViewController 独立，您的代码将更加灵活，并且添加/删除单行将比重新加载整个 tableView 更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T21:18:14.630

您要么保留指向您创建的子视图的链接，并要求它提供在返回时已更改的数据，或者将自己广告为子视图的代表并让它直接给您回电（如果您有有效的参考，这确实有效） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-07T20:14:10.860

我有同样的问题，发现这个示例代码：http: [//developer.apple.com/iphone/library/samplecode/LocateMe/Introduction/Intro.html](http://developer.apple.com/iphone/library/samplecode/LocateMe/Introduction/Intro.html)

帮了我很多，而且很容易从代码中找出来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:02:34.173

简而言之，使用委托。

我建议你看看 Lecture 11: Text input, Presenting content modally（5 月 6 日）——斯坦福大学提供的 iPhone 应用程序编程课程。在 iTunes U 上搜索它。

如果您想知道如何实现委托，请下载此示例应用程序：http: [//www.stanford.edu/class/cs193p/downloads/11-Pickers.zip](http://www.stanford.edu/class/cs193p/downloads/11-Pickers.zip)

# c++ - 在 Mac 上通过 HTTP/HTTPS 和/或 FTP/FTPS 上传文件

> ID：895197
> 
> 赞同：0
> 
> 时间：2009-05-21T21:13:28.307
> 
> 标签：c++, objective-c, macos, file, upload

我发现了许多关于在 Windows 上通过 C++ 将文件上传到 Web 服务器的示例。

但是，经过*大量*搜索（而且我认为我对 Google 很擅长！），我很难找到任何示例来帮助我在 Mac 上实现同样的目标。

任何人都可以向我指出如何使用 C++ 或目标 C 将文件上传到 Mac OS 上的 Web 服务器的一些帮助吗？

它可以通过 HTTP/HTTPS*或*FTP/FTPS（或两者）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T21:37:33.033

您可以使用“libcurl”，请参阅Wikipedia 上的[这篇文章](http://en.wikipedia.org/wiki/CURL)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T22:25:48.257

您可能希望将 NSURLConnection 与 NSMutableURLRequest 一起使用，如下所示：

```
NSMutableURLRequest *theRequest=[[NSMutableURLRequest alloc] init];
[theRequest addValue:@"attachment;filename=\"file2.gif\"" forHTTPHeaderField:@"Content-disposition"];
[theRequest addValue:@"image/gif" forHTTPHeaderField:@"Content-Type"];
[theRequest addValue:@"binary" forHTTPHeaderField:@"Content-Transfer-Encoding"];
[theRequest setHttpBody:myBodyNSDataObject];
// create the connection with the request
// and start loading the data
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {
    // Create the NSMutableData that will hold
    // the received data
    // receivedData is declared as a method instance elsewhere
    receivedData=[[NSMutableData data] retain];
} else {
    // inform the user that the download could not be made
} 
```

您可以使用 NSMutableURLRequest 方法修改或设置标头：

```
- (void)addValue:(NSString *)value forHTTPHeaderField:(NSString *)field 
```

响应将是服务器返回的任何内容。您可以查看[Apple 的文档](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html)以了解要实现的其余委托方法以获取响应的主体。您应该准备好代表您要上传的文件内容的 NSData 对象。使用 FTP 做同样的事情有点复杂，但这将有助于发布文件正文。您需要确保您的 NSData 对象设置为像 HTTP 帖子的正文一样，以便您设置标头，例如：

```
[theRequest addValue:@"attachment;filename=\"file2.gif\"" forHTTPHeaderField:@"Content-disposition"];
[theRequest addValue:@"image/gif" forHTTPHeaderField:@"Content-Type"];
[theRequest addValue:@"binary" forHTTPHeaderField:@"Content-Transfer-Encoding"]; 
```

然后你应该附加身体。在服务器端，您可以获得文件名和组成文件的字节。

这不完全是您应该使用的代码，但它应该让您很好地了解如何继续。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T21:40:23.277

[连接套件](http://opensource.utr-software.com/connection/)可能是您正在寻找的

# database - There is probably a name for this. Please re-title appropriately

> ID：895201
> 
> 赞同：0
> 
> 时间：2009-05-21T21:14:03.127
> 
> 标签：database, data-modeling

I'm evaluating the idea of building a set of generic database tables that will persist user input. There will then be a secondary process to kick off a workflow and process the input.

The idea is that the notion of saving the initial user input is separate from processing and putting it into the structured schema for a particular application.

An example might be some sort of job application or quiz with open-ended questions. The raw answers will not be super valuable to us for aggregate reporting without some human classification. But, we do want to store the raw input as a historical record.

We may also want the user to be able to partially fill out some information and have it persisted until he returns.

Processing all the input to the point where we can put it into our application-specific data schema may not be possible until we have ALL the data.

Two initial questions:

1.  Assuming this concept has a name, what is it?
2.  Is this a reasonable approach? Why or why not?

**Update:**

Here's another way to state the idea. The user is sequentially populating fields in a DTO. I (think I) want to save the DTO to disk even in a partially-complete state. Once the user has completed populating the fields, I want to pull out the DTO and process it for structured saving into a table which represents the specific DTO. I can't, however, save a partially complete or (worse) a temporarily incorrect set of input since some of the input really shouldn't be stored as part of the structured record.

My idea is to create some generic way to save *any* type of DTO and then pull them out for processing in a specific app as needed. So maybe this generic DTO table stores data relating to customer satisfaction surveys right next to questions answered in a new account setup wizard.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T23:54:29.340

你说：

> 我的想法是创建一些通用的方法来保存任何类型的 DTO，然后根据需要将它们拉出来在特定的应用程序中进行处理。

我认为你是一个抽象层次。我认为整个数据库正在履行您希望一组有限的表执行的角色。您可以创建某种复杂的存储模式，它不会以任何方式表示数据，然后（从 DBMS 的角度来看，缓慢而痛苦地）合并并呈现数据视图......但我建议这是过度设计的解决方案。

我编写了几个应用程序，由于自定义用户需求，应用程序的一部分（有时很重要）是动态的——由用户构建，从模式到业务规则。令人惊讶的是，通过执行 CREATE TABLE 和 ALTER TABLE 等语句来制造存储模式的那些是最容易维护的。它们还允许用户以非常直接、预期的方式创建报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:21:46.810

You might be speaking about Workflow. You might want to check out [Windows Workflow](http://msdn.microsoft.com/en-us/library/dd851337.aspx).

The concepts of Workflow are that they mirror the processes of real life. That is to say, you make complete a document, but the document is not complete until it has been approved. In your case, that would be 'Data is entered' but unclassified, so it is stored in the database (dehydrated) and a flag is sent up for whoever needs to deal with the issue. It can persist in this state for as long as necessary. Once someone is able to deal with it, the workflow is kicked off again (hydrated) and continues to the next steps.

Here are some SO questions regarding workflows:

This question: "[Is it better to have one big workflow or several smaller specific ones?](https://stackoverflow.com/questions/744156/is-it-better-to-have-one-big-workflow-or-several-smaller-specific-ones)" clears up some of the ways that workflow can be used, and also highlights some issues with it.

John Saunders has a very good breakdown of what workflow is good for in [this question](https://stackoverflow.com/questions/701792/should-i-bother-learning-windows-workflow/701922#701922).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:00:01.363

听起来您最初是以标准化形式（通用）存储数据，一旦您拥有完整的数据集，您就会对其进行非标准化（结构化模式）。

# c# - Linq to Sql 本地化查询

> ID：895202
> 
> 赞同：2
> 
> 时间：2009-05-21T21:14:10.460
> 
> 标签：c#, linq-to-sql, localization, left-join, outer-join

鉴于下表，我想返回给定文化的本地化文本或给定文化不存在行的默认文化的文本。

[图 http://lh4.ggpht.com/_gjsCWAV_CZc/ShW6hC-eozI/AAAAAAAACbY/mXaBfiZtBY8/s400/diagram.png](http://lh4.ggpht.com/_gjsCWAV_CZc/ShW6hC-eozI/AAAAAAAACbY/mXaBfiZtBY8/s400/diagram.png)

所以有了以下数据

**资源**

```
ID  Name
1   Donkey
2   Elephant 
```

**语言环境字符串**

```
ID  CultureID  ResID   LocaleText
1   1         1       Donkey
2   1         2       Elephant
3   2         1       baudet 
```

我希望能够为法国文化返回以下内容

```
baudet
elephant 
```

我已经尝试了基于我见过的 LEFT JOINS 示例的各种查询，但我被卡住了。

```
var ct = from r in db.Resources
                 join lt in db.LocaleStrings
                     on r.ID equals lt.ResID into res
                 from x in res.DefaultIfEmpty()
                 select new
                 {
                     CultureID = x.CultureID,
                     LocaleText = x.LocaleText,
                     ResID = x.ResID
                 };

        var text =
            from c in db.Cultures
            join t in ct
            on c.ID equals t.CultureID into cults
            from x in cults.DefaultIfEmpty()
            select x; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:44:44.220

我确信有更好的方法，但这似乎有效：

```
 var ct =
        from c in db.Cultures
        from l in db.LocaleStrings
        from r in db.Resources
        where r.ID == l.ResID
        select new
        {
            CultureID = c.ID,
            LocaleText = l.CultureID == c.ID ? l.LocaleText : r.Name,
            ResID = r.ID,
            LSID = l.CultureID == c.ID ? l.ID : 0
        };

    var text =
        from t in ct
        where t.LSID != 0 || (t.LSID == 0 && !((from ac2 in ct
                                                where ac2.LSID > 0 && ac2.CultureID == t.CultureID
                                                select ac2.ResID).Contains(t.ResID)))
        select new
        {
            CultureID = t.CultureID,
            LocaleText = t.LocaleText,
            ResID = t.ResID
        }; 
```

# php - 如何将带有 unicode 字符集的 xls/csv 文件导入 php/mysql？

> ID：895221
> 
> 赞同：3
> 
> 时间：2009-05-21T21:17:01.013
> 
> 标签：php, mysql, excel, unicode

我想让用户能够将 csv 文件导入我的 php/mysql 系统，但是当语言是俄语时遇到了一些编码问题，而 excel 只能存储在 UTF-16 制表符编码的选项卡文件中。

现在我的数据库在 latin1 中，但我会将其更改为 utf-8，如问题“a-script-to-change-all-tables-and-fields-to-the-utf-8-bin-collat​​ion-在-mysql"

但是我应该如何导入文件？并存储字符串？

例如，我应该将其翻译成 html_entitites 吗？

我正在使用`fgetcsv`命令从 csv 文件中获取数据。我的代码现在看起来像这样。

```
 file_put_contents($tmpfile, str_replace("\t", ";", file_get_contents($tmpfile)));
$filehandle = fopen($tmpfile,'r');
while (($data = fgetcsv($filehandle, 1000, ";")) !== FALSE) {
  $values[] = array(
    'id' => $data[0], 
    'type' => $data[1], 
    'text' => $data[4], 
    'desc' => $data[5], 
    'pdf' => $data[7]);
} 

```

请注意，如果我将 xls 文件作为 csv 存储在 excel 中，我的特殊字符将替换为“_”，因此我可以从文件中获取俄语字符的唯一方法是将文件作为选项卡式分隔文件存储在 excel 中UTF16 格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:59:36.207

好的，解决方案是将文件从 excel 导出为 UTF16 unicode 文本并添加 ';' 代替 '\t' 并从 utf16 转换为 utf8。

```
`file_put_contents($tmpfile, str_replace("\t", ";",  iconv('UTF-16', 'UTF-8', file_get_contents($tmpfile))));`
```

`mysql中的表必须从latin1改为utf8`

 ````
ALTER TABLE `翻译`
更改 `text` `text` VARCHAR( 100 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ,
更改 `desc` `desc` VARCHAR( 255 ) 字符集 utf8 整理 utf8_general_ci 非空
```

然后可以像以前一样导入文件。

当我想将数据库中的数据导出到 excel 文件时，csv-version**不是**一个选项。它必须在excel的html模式下完成。数据由例如纠正的地方。`urlencode()`或者`htmlentities()`

这里有一些示例代码。

```
 <?php
header('Content-type: application/vnd.ms-excel');
header('Content-Disposition: attachment; filename="export.xls"');
print ('<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:x="urn:schemas-microsoft-com:office:excel"
xmlns="http://www.w3.org/TR/REC-html40">
<div id="Classeur1_16681" align=center x:publishsource="Excel">
<table x:str border=0 cellpadding=0 cellspacing=0 width=100% style="border-collapse: collapse">');
for($i = 0 ; $i < count($lines) ; $i++) {
    print ('<tr><td>');
  print implode("</td><td>",$lines[$i]);
    print ('</td></tr>');
}
?>
</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T22:29:55.453

或者，您可以使用 MySQL[加载命令](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)。此命令允许您指定分隔符、字符集等。需要注意的是，加载数据的服务器必须对文件具有直接可见性，这意味着文件必须驻留在 db 服务器可见和可读的文件系统上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T09:47:24.220

我不会使用 PHP 导入它。[相反，请考虑使用READ DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)创建一个临时表来存储您的数据。

```
$file_handle = fopen($file_name, 'r');
$first_row = fgetcsv($file_handle, 0, ',', '"');
fclose($file_handle);
# Your usual error checking
if (!is_array($first_row)) {
    ...
}
$columns = 'column'.implode(' TEXT, column', array_keys($first_row)).' TEXT';
query("CREATE TABLE $table ($columns) Engine=MyISAM DEFAULT CHARSET=ucs2");
query("LOAD DATA LOCAL INFILE '$file_name' INTO TABLE $table ... 
```

然后，您可以对该表中的数据做任何您想做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-15T17:35:37.623

好的，我的解决方案也是将文件从**excel**导出为 UTF16 unicode 文本。唯一的区别是我使用制表符分隔符来获取我的文件：

```
fgetcsv($fp, '999999', "\t", '"') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-26T09:15:58.797

我尝试了很多替代方案，但最简单快速的解决方案是使用**Navicat**

```
http://www.navicat.com/ 
```

![在此处输入图像描述](https://i.stack.imgur.com/bJ00l.png)

# c# - 如何从 MainWindowHandle 获取表单？

> ID：895225
> 
> 赞同：1
> 
> 时间：2009-05-21T21:17:26.070
> 
> 标签：c#, winforms, command-line, process

我有一个程序，它只允许它自己的一个实例运行。我使用此代码

```
bool createdNew = true;
using(Mutex mutex = new Mutex(true, "MobilePOSServer", out createdNew))
{
    if(createdNew)
    {

        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MainForm());
    }
    else
    {
        Process current = Process.GetCurrentProcess();
        foreach(Process proc in Process.GetProcessesByName(current.ProcessName))
        {
            if(proc.Id != current.Id)
            {
                SetForegroundWindow(proc.MainWindowHandle);
            }
        }
    }
} 
```

我想要做的是处理命令行参数以在我的 MainForm winform 上调用一些启动和停止方法。我可以很好地开始。但是从新的命令行窗口运行应用程序并尝试调用方法不起作用。我可以让窗户来到前面。有没有办法从手柄上获取我的表格？

或者更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T21:32:35.163

您将无法获得对表单本身的引用，不 - 该对象存在于不同的进程中。

如果您希望能够控制其他进程，则需要公开某种“远程访问”（在这种情况下，“远程”表示“进程外”，而不是“在不同的机器上”）。这可能是通过 .NET 远程处理、WCF 或您自己的基于套接字、命名管道等的简单协议。但是，这样做可能有点痛苦 - 所以在开始之前权衡一下您*真正*想要这个功能的程度太多的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:35:34.957

这是你要找的：

[单实例应用程序，传递命令行参数](http://www.codeproject.com/KB/threads/SingletonApp.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T01:51:45.750

如果您要在远程应用程序上执行的方法很简单，您还可以使用 SendMessage/PostMessage 将 windows 消息发送到其他应用程序并触发要执行的操作。

如果您确实需要与其他实例进行更多交互而不是简单的触发器，那么我将不得不接受 Jon 的回答，并且我会选择带有命名管道的 WCF。正如他所说，这将是一个更复杂的解决方案，您应该考虑该功能对应用程序的真正重要性。

# unix - 无法使用同名的目标文件有效地建立符号链接

> ID：895226
> 
> 赞同：0
> 
> 时间：2009-05-21T21:17:45.913
> 
> 标签：unix, ln

我的工作区有一个 dotFiles 列表。例如，.bashrc 和 .vimrc。

我想从它们到我的主页建立一个符号链接，以便它们的名称与我的 workarea 文件夹中的名称相同。

**我对伪代码的尝试**

```
ln workarea/.[a-zA-Z] ~/.* 
```

问题是从 [a-zA-Z] 到我家中出现的文件的双射。

**如何使用与原始文件同名的目标文件创建符号链接？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T21:28:00.727

'男人' 说：

> ln [选项]...目标...目录（第三种形式）

因此，您需要执行以下操作：

$`ln -s workarea/.* ~/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T21:28:41.520

`ln`创建符号链接的可能用途是：

```
ln -s <source-file> [<target-file]>
ln -s <source-file> ... <target-dir> 
```

当您键入

```
ln -s workarea/.[a-zA-Z]* ~/.* 
```

（我认为你错过了一个`*`）外壳会扩展出来`workarea/.[a-zA-Z]` **，** `~/.*`所以（假设你的 HOME 目录包含文件`.abc`和`.def`）你最终会得到

```
ln -s workarea/.bash_profile workarea/.bashrc ~/.abc ~/.def 
```

这既不适合`ln`.

要使用 的第二种用法`ln`，您将使用：

```
ln -s workarea/.[a-zA-Z]* ~/. 
```

# sql-server - 将数据库图添加到源代码管理？

> ID：895228
> 
> 赞同：7
> 
> 时间：2009-05-21T21:18:35.630
> 
> 标签：sql-server, database, svn

有没有办法将 SQL Server 数据库图添加到源代码管理？我似乎无法找到一种方法将其从数据库中编写出来。如果是这样，有没有办法将该图表放入 Visual Studio 数据库项目中以便于部署？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T21:30:37.070

将其脚本写入文件尝试：

[http://www.codeproject.com/KB/database/ScriptDiagram2005.aspx](http://www.codeproject.com/KB/database/ScriptDiagram2005.aspx)

我不会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-23T11:04:35.583

我被允许在一组执行此操作的脚本上发布我的变体，在存储在数据库中的文件和图表之间提供简单的双向导入/导出。

[https://github.com/timabell/database-diagram-scm](https://github.com/timabell/database-diagram-scm)

只需运行批处理文件，指向您选择的数据库，您将获得一组文件，每个图表一个。不幸的是，数据仍然是二进制的，但这是一个开始。

它建立在其他人已经完成的工作之上，绝对是巨人的肩膀。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:33:35.367

我不知道将图表存储在源代码管理中的好处是什么。数据库图说明了应该在其他地方定义的数据库关系。只要您将数据库的创建脚本放在源代码安全中，当您创建图表并将表添加到其中时，图表应该会呈现得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:41:38.750

确实没有一种简单的方法可以做到这一点。我通常为此做几件事之一。

1.  只需使用[CutePDF之类的工具将文档打印为 PDF](http://cutepdf.com/)
2.  使用 Visio 和逆向工程选项生成文档，然后保存 visio 文件
3.  对流程使用[Enterprise Architect](http://www.sparxsystems.com.au/)或类似工具。

由于我的应用程序经历了生命周期，我个人使用选项 3。但真正的东西是你要存储什么，如果是静态版本的数据库图，以上任何一个都是有效的。

# .net - 将属性设置应用于 Visual Studio 中 Project 中的所有类似控件

> ID：895239
> 
> 赞同：1
> 
> 时间：2009-05-21T21:20:45.313
> 
> 标签：.net, winforms, visual-studio-2008, properties, shortcuts

假设我在整个 winform 应用程序中有多个*DataGrid* ，我想在 Visual Studio 中将**所有**这些的 BackColor 设置为*Purple 。*

**为不在**同一个表单上的多个项目设置*属性*的最快方法是什么？

 **谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T21:24:12.047

有一个**`Application.OpenForms`**属性 - 您可以遍历该列表，然后递归遍历每个控件的 Controls 属性，修改与您的类型匹配的那些。

这就是你要找的东西吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:31:10.317

由于您询问的是在设计时而不是运行时更改它，我会在您的整个解决方案中搜索“新 DataGrid”并在 Designer.cs（或 Designer.vb）文件中更改它们。除此之外，除了编写某种宏之外，我想不出更快的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:33:14.183

与其搜索“new DataGrid”，不如搜索“.BackColor =”，这是您将要更改的行（请记住，其他控件具有 .BackColor 属性，因此不要盲目更新）。

希望这可以帮助，

账单

# winapi - WaitForSingleObject 的超时解决

> ID：895242
> 
> 赞同：12
> 
> 时间：2009-05-21T21:21:31.677
> 
> 标签：winapi

**当我使用WaitForSingleObject**函数等待一个非信号事件时，我发现在某些情况下调用将在小于指定的超时期限内返回 WAIT_TIMEOUT。只需在超时设置为 1000 毫秒的情况下循环调用，我就看到调用返回的周期低至 990 毫秒（在 WinXP 上运行）。我正在使用**QueryPerformanceCounter**来获得与系统时钟无关的时间测量，所以我认为时钟漂移可能不是一个答案。

这种行为对我来说没有任何实际问题，但我想更好地理解它。看起来它可能以大致计时器滴答的分辨率工作。Microsoft 是否会发布有关此功能精度的更多详细信息？我应该期望 Vista 中的精度更高吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T21:31:08.740

是的，WaitForSingleObject 使用计时器刻度分辨率，它不使用像 QueryPerformanceCounter 这样的高分辨率计时器。

[http://msdn.microsoft.com/en-us/library/ms687069(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms687069(VS.85).aspx)，关于“等待函数”的 MSDN 文章对此进行了扩展：

> 指定超时间隔的准确性取决于系统时钟的分辨率。系统时钟以恒定速率“滴答”。如果超时间隔小于系统时钟的分辨率，则等待可能会在小于指定的时间长度内超时。如果超时间隔大于 1 个滴答但小于 2 个滴答，则等待可能介于 1 到 2 个滴答之间，依此类推。

本文还解释了如何使用 timeBeginPeriod 来提高系统时钟分辨率 - 但不建议这样做。

我可以想到几个原因。首先，几乎所有 WaitForSingleObject 用例都不需要更高的分辨率。使用高分辨率定时器将需要内核不断轮询定时器（这是不可行的，因为内核代码不能保证始终运行）或频繁对其重新编程以产生中断（因为可能有多个 WaitForSingleObjects 并且很可能只有一个可编程中断）。

另一方面，已经有一个定时源可以不断更新，其分辨率足以满足 WaitForSingleObject、SetWaitableTimer 和 Sleep。

# visual-c++ - Access violation error when using glut on vista

> ID：895248
> 
> 赞同：0
> 
> 时间：2009-05-21T21:23:37.507
> 
> 标签：visual-c++, windows-vista, glut

I am new in OpenGL. I am using glut library in VC express edition on vista. I am getting runtime error of "access violation" on the following line

`glClear(GL_COLOR_BUFFER_BIT);`

Can I avoid this error somehow?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-01T19:07:05.147

对我来说设置`project properties -> linker -> advanced -> data execution prevention`解决`/NXCOMPAT:NO`问题。

# c - 我可以对 ingenico/verifone 终端进行编程以做任何我想做的事情吗？

> ID：895251
> 
> 赞同：9
> 
> 时间：2009-05-21T21:24:53.527
> 
> 标签：c, printing, embedded, point-of-sale, verifone

理想情况下，我会通过以太网电缆将 Ingenico/VeriFone 终端连接到网络，该终端将专门运行我编写的程序。该程序将轮询 Web 服务，当它检测到某种信息时发出哔哔声，等待某人的输入，将所述信息传输回 Web 服务，然后打印一张票。

这对 Ingenico/VeriFone/其他人的终端是否可行？

我正在寻找所述终端的外形尺寸/半坚固性。我们不需要/想要更大的东西，比如 PC 或笔记本电脑。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-12-03T09:12:06.790

我在 Verifone、Hypercom 和 Trintech 终端上构建了应用程序。Verifones 是迄今为止最容易开发的。他们有一个简单的闪存和 RAM 文件系统，应用程序被下载并作为文件运行，操作系统（Verix）是 POSIX，就像具有良好的 C/C++ 库等。唯一的缺点是工具成本，VerixV 使用 ARM SDT（每个座位 5K 欧元）和较旧的 Verix 终端（基于 Coldfire）使用 SDS 编译器。开发工具包带有默认密钥来签署您的应用程序（不是最安全的，但您可以密码保护终端上的下载访问）。我在这些终端上写了很多应用程序，而不仅仅是支付应用程序。Verifone 多应用控制器 (VMAC) 是一团糟，但使用管道用于应用间通信很容易自己运行多个应用（尽管您的应用不会在使用 VMAC 的第三方终端上运行）。我们使用 FTP 的以太网连接来管理应用程序和配置下载以及事务批处理。还在最新的终端上使用了 WIFI（也使用了 3G 终端，但我没有在这些终端上做任何代码）。Verifone 在代码开发方面类似于 PC，我们在 WIN32/Verix/VerixV 和 Linux 之间共享了许多库/应用程序代码。Verifone 终端机制造精良，可能会受到很多滥用，但如今大多数严肃的终端机制造商都做得很好。

# php - Ruby 和 PHP 的评估引擎有何不同？

> ID：895254
> 
> 赞同：1
> 
> 时间：2009-05-21T21:25:48.360
> 
> 标签：php, ruby

我曾经发现一篇文章，其中介绍了 PHP 和 Ruby 如何处理与某些测试条件匹配的不同类型的变量（即：isempty、isset 等）之间的差异。它们有何不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-07T01:12:09.400

PHP/`empty`与 Ruby 等价物几乎相同，`empty?` 对于 Rails 中的字符串，该`blank?`方法优先于`empty?`

```
# this is PHP
$bob = array();          # empty( $bob ) => true
$bob = array( "cat" );   # empty( $bob ) => false

$bob = null;        # empty( $bob ) => true
$bob = "boo"        # empty( $bob ) => false
$bob = "";          # empty( $bob ) => true

# this is Ruby
[].empty?           # => true
[ "cat" ].empty?    # => false

nil.empty?          # => NoMethodError
"boo".empty?        # => false
"".empty?           # => true 
```

PHP/isset 可以用 has_key 代替吗？对于哈希对象。对于一般的局部变量用法，当在代码中引用变量时，Ruby 将变量实例化为 nil，因此唯一容易检查的是它们是否为 nil？

**编辑**

您还可以使用`defined?`关键字复制`isset`本地变量的 PHP 用法。

```
#PHP

isset($bob);        # => false
$bob = "foo";
isset($bob);        # => true

$bob =  array();
isset($bob['cat']);  # => false

$bob =  array( 'cat' => 'bag' );
isset($bob['cat']);  # => true
isset($bob['dog']);  # => false

#Ruby
bob                  # => nil
defined?(bob)        # => false
bob.nil?             # => true
bob = "foo"
bob                  # => "foo"
bob.nil?             # => "false"
bob = {}
bob.has_key? :cat    # => false
bob = { :cat => 'bag' }
bob.has_key? :cat    # => true 
```

需要注意的一件事：在 PHP 中，空字符串或数字 0 将在`if`语句中评估为 false。在 Ruby 中，仅在 if 语句`nil`中`false`评估为 false。这需要添加另外两个布尔查询方法，`blank?`和`zero?`. 这些方法作为 Rails 应用程序的一部分混合到 String 类中。可以在 Facets 上找到它们的独立版本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-21T22:48:24.137

这是一个非常分散的问题。Ruby 和 PHP 之间的一个主要区别是 Ruby（大部分）是[强类型](http://en.wikipedia.org/wiki/Type_system#Strong_and_weak_typing)的，而 PHP 是非常弱类型的。

# java - 我可以直接通过 getter 添加到私人列表吗？

> ID：895257
> 
> 赞同：0
> 
> 时间：2009-05-21T21:26:42.197
> 
> 标签：java

我意识到我会因为不简单地自己编写测试而被激怒......但我对人们的意见感到好奇，而不仅仅是功能，所以......这里是......

我有一个有私人名单的班级。我想通过 public getMyList() 方法添加到该私人列表中。

所以……这行得通吗？

```
public class ObA{
 private List<String> foo;
public List<String> getFoo(){return foo;}
}

public class ObB{
   public void dealWithObAFoo(ObA obA){
     obA.getFoo().add("hello");

   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T21:28:45.017

是的，这绝对会奏效——这通常是一件坏事。（这是因为您实际上返回的是对集合对象的*引用*，而不是集合本身的副本。）

很多时候，您希望提供对集合的真正只读访问，这通常意味着返回集合周围的只读包装器。使返回类型成为集合实现的只读接口并返回实际的集合引用并不能提供太多保护：调用者可以轻松地转换为“真实”集合类型，然后毫无问题地添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:35:54.720

确实，这不是一个好主意。不要在外面发布您的可变成员，如果您不能即时提供只读版本，请制作副本......

```
public class ObA{
  private List<String> foo;
  public List<String> getFoo(){return Collections.unmodifiableList(foo);}
  public void addString(String value) { foo.add(value); }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T21:39:03.200

如果您想对此发表意见，我将删除该`getFoo()`调用并向 ObA 添加一个`add(String msg)`and`remove(String msg)`方法（或您想要公开的任何其他功能）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T21:50:08.607

在我的经验中，允许访问收藏似乎总是一件坏事——主要是因为一旦他们出去，他们几乎是不可能控制的。我已经养成了从不允许直接访问包含它们的类之外的集合的习惯。

这背后的主要原因是，几乎总是有某种业务逻辑附加到数据集合中——例如，添加验证，或者有一天您可能需要添加第二个密切相关的集合。

如果您像您所说的那样允许访问，那么将来进行这样的修改将非常困难。

哦，另外，我经常发现我最终必须用我正在存储的对象存储更多数据——所以我创建了一个新对象（仅在容纳集合的“容器”内部知道），然后我把对象在将其放入收藏夹之前。

如果您一直锁定您的收藏，这是一个微不足道的重构。试着想象一下，在某些情况下，如果你没有锁定收藏品，那会有多困难……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T06:03:12.943

如果你想支持 Foo 的添加和删除函数，我建议使用 addFoo() 和 removeFoo() 方法。理想情况下，您可以通过为您需要的每个功能创建一个方法来一起消除 getFoo。这清楚地表明了调用者将在列表中执行的功能。

# vb.net - 使用 Canon EDSDK 2.5.2 VB.NET 进行实时查看

> ID：895265
> 
> 赞同：4
> 
> 时间：2009-05-21T21:28:20.587
> 
> 标签：vb.net, edsdk

我正在尝试做两件事中的一件，偏好号 1：

使用 VB.NET 和 Canon EDSDK 2.5.2 打开实时视图，并在 Windows 窗体应用程序中呈现实时输出。目前我正在尝试将其放入图片框中；但是，我肯定愿意接受建议。

第二种选择是至少打开实时取景并通过摄像机上的视频输出将其流式传输到监视器。

我真的很想完成第一个！以下是我当前的代码库，帮助！

```
Private Sub btnStartLiveView_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnStartLiveView.Click

    Dim err As Integer = EDS_ERR_OK

    Dim prop As Integer = EdsEvfOutputDevice.kEdsEvfOutputDevice_PC
    Dim proptype As Integer = EDSDKTypes.kEdsPropID_Evf_OutputDevice
    '// Stock the property.'
    Dim wkIntPtr As IntPtr = Marshal.AllocHGlobal(Marshal.SizeOf(prop))
    Marshal.StructureToPtr(prop, wkIntPtr, False)
    'send property/command to the camera'
    EdsSetPropertyData(model.getCameraObject(), proptype, 0, Marshal.SizeOf(prop), prop)

    Dim stream As IntPtr
    Dim outMemoryRef As IntPtr
    Dim evfImage As IntPtr

    err = EdsCreateMemoryStream(0, stream)

    If err = EDS_ERR_OK Then

        err = EdsCreateImageRef(stream, outMemoryRef) '(stream, evfImage)'

    Else

        Dim str As String = Hex(err)

        MessageBox.Show(str)

    End If

    If err = EDS_ERR_OK Then
        err = EdsDownloadEvfImage(model.getCameraObject(), evfImage)
    Else

        Dim str As String = Hex(err)

        MessageBox.Show("&H" & str & "L") ' Shows &H2CL which = ERR_FILE_FORMAT_NOT_RECOGNIZED'
    End If

    ' Get the Incidental Data of the Image'

    If err = EDS_ERR_OK Then

        Dim zoom As UInt32
        Dim point As IntPtr

        EdsGetPropertyData(outMemoryRef, kEdsPropID_Evf_ZoomPosition, 0, Marshal.SizeOf(zoom), zoom)

        EdsGetPropertyData(outMemoryRef, kEdsPropID_Evf_ZoomPosition, 0, Marshal.SizeOf(point), point)

    Else

        'MessageBox.Show(err.ToString())'

    End If

    Dim buffer(Marshal.SizeOf(stream)) As Byte

    Dim mStream As System.IO.Stream = New System.IO.MemoryStream(Marshal.SizeOf(stream))

    Dim gcTime As GCHandle = GCHandle.Alloc(0, GCHandleType.Pinned)
    Dim pTime As IntPtr = gcTime.AddrOfPinnedObject()
    Marshal.Copy(stream, buffer, 0, Marshal.SizeOf(stream))

    mStream.Write(buffer, 0, Marshal.SizeOf(stream))

    Me.PictureBox1.Image = Image.FromStream(mStream)

    EdsRelease(stream)
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-05T05:50:59.270

这是一个 .vb 文件，我在其中定义了 Camera 类，它可以让您执行顶级操作，例如

```
Dim camera as New Camera
camera.EstablishSession()
camera.TakePicture("C:\path\to\save.jpg")
camera.StartLiveView(me.LiveViewPictureBox)
camera.StopLiveView()
camera.FlushTransferQueue() 
```

我想你可能会发现它很有用：

```
<snip> 
```

多年来，我收到了多封电子邮件，要求更新此代码块，该代码块在 GitHub 上作为开源代码：

[http://github.com/superjoe30/Camlift-Controller](http://github.com/superjoe30/Camlift-Controller)

Camera 类在 slnCamliftController / src / Camera.vb

其中一些代码非常糟糕。例如，为了让它适用于 5D 和 7D 相机，我必须创建一个程序来初始化 SDK，然后故意崩溃。糟糕的！我知道！这是在克鲁格龙中发现的。就像当您尝试连接到 5D 或 7D 时，没有任何效果。那里有一个尖刺坑。所以我们把一个农民（克鲁格龙）推到了尖刺上，杀死了他（它默默地失败了），所以我们可以穿过农民的尸体到安全的地方。

它既丑陋又可怕，但是：它每次都有效。如果你不这样做，它就行不通。我曾多次询问佳能是否会发布 EOS Utility 的源代码，它可以完美地连接到 5D 和 7D。他们每次都坚决拒绝。我的同事开玩笑说他们不想透露他们也在使用克鲁格龙。无论如何，我只是想让你了解一下这个令人讨厌的细节。

我还创建了一个 Python 模块来与相机交互：http: [//github.com/superjoe30/pyedsdk](http://github.com/superjoe30/pyedsdk)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-15T14:28:57.853

我是最初发布这个问题的人。我看到这里还有其他人仍在寻找答案。[我已经在我的博客http://www.overridepro.com/2009/06/28/canon-sdk-live-view/](http://www.overridepro.com/2009/06/28/canon-sdk-live-view/)上发布了我们最终提出的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T16:12:24.933

There are code samples [here](http://canonsdk.com/) and discussions on different ways of acomplishing it.

# flash - 如何调用由 AS3 swf 托管的 AS2 swf 中的函数并将数组返回给 AS3 swf？（使用 SwfBridge）

> ID：895266
> 
> 赞同：0
> 
> 时间：2009-05-21T21:28:39.837
> 
> 标签：flash, actionscript-3, actionscript-2, communication, localconnection

我有一个使用 gSkinner 的 swfBridge 加载 Flash 8 AS2 swf（客户端）的 Flash CS4 AS3 swf（主机）。

这很好用，主机可以在客户端调用函数没有问题。但是我希望能够在客户端调用一个函数并让该函数将一个数组返回给主机。

这是我认为可行的代码 -

**主机 (AS3) 代码 -**

```
var hostArray:Array = new Array();
hostArray = mySwfBridge.send("getArray"); 
```

**客户端 (AS2) 代码**

```
var theArray = new Array("item1, item2, item3);
function getArray() :Array {
    return theArray;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T01:31:42.837

您面临的问题是`LocalConnection`(used by `SwfBridge`) 它是异步调用的。换句话说，调用者脚本的执行不会停止执行以等待被调用函数返回的结果。

如果您需要从另一侧检索值，则`LocalConnection`需要将其设置为双向工作。`LocalConnection`即，您的客户端脚本必须通过（`SwfBridge`在这种情况下）将其结果发送回主机对象上的回调方法，而不是通过执行此操作*`return`*。

# javascript - Visual Studio 2008 jQuery IntelliSense 偶尔失败，重新启动 VS 修复

> ID：895270
> 
> 赞同：3
> 
> 时间：2009-05-21T21:29:10.710
> 
> 标签：javascript, visual-studio, intellisense

马上，这不是您的标准“我无法让 javascript IntelliSense 在 Visual Studio 中工作”。作为记录：

*   我正在使用 Visual Studio 2008
*   我已经安装了 SP 1
*   我已经为 -vsdoc.js 文档文件[KB958502安装了修补程序](http://code.msdn.microsoft.com/KB958502/Release/ProjectReleases.aspx?ReleaseId=1736)

我正在开发一套相互关联的 jQuery 插件，以打包为类库中的资源。所以在一个目录中，我有（例如）：

*   jquery-vsdoc.js
*   核心.js
*   插件1.js
*   插件2.js

在 core.js 中，我在文件顶部有以下内容：

```
/// <reference path="jquery-vsdoc.js" /> 
```

然后在每个plug#.js 中，我有：

```
/// <reference path="jquery-vsdoc.js" />
/// <reference path="core.js" /> 
```

IntelliSense 最初可以工作，甚至包括在插件中工作时来自 core.js 的添加。但是，有时最轻微的更改，甚至在引用 XML 标记中添加和删除空格，或按 Ctrl-Shift-J，都会导致可怕的“更新 JScript IntelliSense 时出错：由于错误而未生成客户端脚本 IntelliSense 信息在外部脚本参考中。” 除了它在一秒钟前正在使用该外部脚本引用！

[对于 jquery-vsdoc.js，我使用来自http://jqueryjs.googlecode.com/files/jquery-1.3.2-vsdoc2.js](http://jqueryjs.googlecode.com/files/jquery-1.3.2-vsdoc2.js)的 Comment Version 1.3.2b（文件中的内容）。我从文件中省略了版本号，以便在不可避免地更新时不必更改一堆引用。

那么可能是什么问题呢？事实证明，重新启动 Visual Studio 是一种非常不雅（且耗时）的解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T05:38:32.143

您是否尝试过增加 IntelliSense 超时？

> 默认情况下，每个 IntelliSense 请求只允许执行 15 秒。这是为了防止 IntelliSense 使用无限循环的脚本。如果您有一个大型脚本或较慢的机器，增加超时限制可能是有意义的。超时值存储在以下注册表项中（取决于您使用的是 Express 还是完整产品）。该值以毫秒为单位，因此请选择大于 15000 的值。
> 
> HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0\HTML Editor\JsFailsafeTimeout HKEY_CURRENT_USER\Software\Microsoft\VWDExpress\9.0\HTML Editor\JsFailsafeTimeout

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-15T07:55:51.457

您可能希望在 Visual Studio 中禁用 JavaScript 智能感知。

安装 SP1 后，您可以禁用 JavaScript 智能感知。
转到工具，选项...

*将显示选项对话框。*

导航到左侧面板中的以下节点：
Text Editor :: JScript :: General

禁用以下选项（在组语句完成中）：
* 自动列出成员
* 参数信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-29T19:33:52.230

我不知道这是否会对你有所帮助，但我在 VS 2008 JS 智能感知中遇到了以下错误：

在外部文件中添加 jQuery 作为引用时，然后我更新 JS 我得到：

'XmlHttpRequest 未定义' 上线：

```
return window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest(); 
```

看起来 JS 智能感知引擎实际上正在执行一些 jQuery 代码（很可能会检查它，以便提供更多关于它的信息）。但是它看起来 window.ActiveXObject 对引擎来说是空的，所以它落入了“新的 XMLHttpRequest()”块——这也失败了。

我破解了一个解决方法，它破坏了除 IE 之外的所有浏览器 - 所以不是一个好的解决方案。我的修复更改了以下内容：

```
 xhr: function()
    {
        // hack to fix VS 2008 intellisense... note this breaks any browser
        // except IE
        var objXhr = { open: function() { },
            setRequestHeader: function() { } 
        };

        return window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : objXhr;
    }, 
```

现在我的智能感知工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T15:33:56.623

关闭和打开文件是否会重置状态？

打开任务管理器并观察进程。当您按下 Ctrl-Shift-J 时，您是否看到一个名为“typelibbuilder.exe”的进程启动？

我试图想象什么样的问题可能需要重新启动 VS。每次按下 Ctrl-Shift-J 时，引用（与该消息相关）的处理都会在一个新的单独进程中完成（除非处理已被禁用，在这种情况下您会看到不同的消息）。几乎听起来 VS 和 typelibbuilder 或其他一些必要组件之间的通信失败了。

在 SP1 中，您不需要直接引用“-vsdoc”文件。如果你引用“foo.js”并且旁边有一个“foo-vsdoc.js”文件，那么VS将使用vsdoc版本来生成智能感知。我怀疑这与您的问题有关。

我知道这并不令人欣慰，但我们在 Visual Studio 2010 中大幅提高了 Javascript Intellisense 的性能和可靠性。Beta1 目前可供 MSDN 订阅者使用（尽管它是 beta 版，其中仍有一些错误）。

如果您可以获得可靠的重现步骤，您还可以在[http://connect.microsoft.com/](http://connect.microsoft.com/)提交错误报告。

# regex - 正则表达式匹配多个查询字符串参数/值对

> ID：895279
> 
> 赞同：1
> 
> 时间：2009-05-21T21:31:04.030
> 
> 标签：regex

即将解决这个问题，但认为有人可能已经不得不解决它，所以......

我正在寻找一个优雅的（并且与 isapi 重写兼容）正则表达式来在查询字符串中查找三个已知的参数/值对，无论顺序如何，并且在去除这三个参数的同时提取所有其他参数。

**abc=123** **def=456**和**ghi=789**都是已知的固定字符串。它们可能以任何顺序出现在查询字符串中，可能是也可能不是唯一的参数，可能相邻也可能不相邻。它应该是智能的，并且不匹配**aabc=123**或**abc=123** 4 （因此每个搜索的参数都应该用 &、?、# 或字符串结尾括起来）。我想要的输出是一个新的查询字符串，其中剩余的参数被去掉了。

我可能会在早上尝试一下逻辑，所以如果你能在我尝试之前解决它，那就加分吧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T21:54:02.423

我认为正则表达式不应该用于此类问题。只需对字符串进行标记，并将每个参数的名称与您要查找的名称进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-25T10:20:33.803

There are querystring decoders. There are many connected topics, especially on this site.

Some of them.

[First](https://stackoverflow.com/questions/1667278/parsing-query-strings-in-java)

[Second](https://stackoverflow.com/questions/248938/alternative-to-deprecated-javax-servlet-http-httputils-parsequerystring)

And javadocs [link](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/utils/URLEncodedUtils.html#parse%28org.apache.http.HttpEntity%29) for apache decoder.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T01:23:45.193

这是我想出的：

```
RewriteRule ^/oldpage.htm\?(.\*)(?<=\?|&)(?:abc=123&|def=456&|ghi=789&)(.\*)(?<=&)(?:abc=123&|def=456&|ghi=789&)(.\*)(?<=&)(?:(?:abc=123|def=456|ghi=789)(?:&|#|$))(.\*) /newpage.htm?$1$2$3  [I,RP,L] 
```

我认为可行。lookAhead/lookbehind 限定符 (?<= 和 (?= ) 似乎是允许我寻找包含 & 或 ? 的关键，而不会“消耗它”来搞砸下一场比赛。

一个问题是，如果旧页面 url 只有三个参数，我仍然会得到一个尾随 ? 重定向的 url 上没有参数，“/newpage.htm?”。我目前正计划通过使用 RewriteCond 在触发之前仅查看具有 4 个以上参数的 url 来避免这种情况，并为恰好具有 3 个参数的 URL 提供更简单的匹配正则表达式。所以完整的规则集如下：

```
RewriteCond URL ^/oldpage.htm\?([^#]\*=[^#]\*&){3,}[^#]\*=[^#]\*.\*

RewriteRule ^/oldpage.htm\?(.\*)(?<=\?|&)(?:abc=123&|def=456&|ghi=789&)(.\*)(?<=&)(?:abc=123&|def=456&|ghi=789&)(.\*)(?<=&)(?:(?:abc=123|def=456|ghi=789)(?:&|#|$))(.\*) /newpage.htm?$1$2$3  [I,RP,L]

RewriteRule ^/oldpage.htm\?(?:abc=123|def=456|ghi=789)&(?:abc=123|def=456|ghi=789)&(?:abc=123|def=456|ghi=789)(.\*) /newpage.htm$1 [I,RP,L] 
```

（末尾的 $1 用于 #additions 到 url...我真的需要它吗？）另一个问题是我想 /oldpage.htm?abc=123&abc=123&abc=123 的 url 会触发这个，但我没有看到任何简单的解决方法，也不太担心..

谁能想到一个更好的方法来解决这个问题，或者看到任何其他问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:40:11.607

```
s/(\?|\#|\&)(abc=123|def=456|ghi=789)(\&|\#|$)//g 
```

这是近似且未经测试的，但提出了一个可行的（我认为）概念。基本上，查找起始边框、文字字符串，然后是结束边框，将每个边框替换为 null、全局并使用 | 为每个选项提供替代选项。

# c# - c#中的接口、继承和窗体

> ID：895282
> 
> 赞同：1
> 
> 时间：2009-05-21T21:31:12.843
> 
> 标签：c#, inheritance, interface, software-design

我有一个设计问题。当编写一个应用程序时，其中有几个组件共享某些属性，而其他组件在 GUI（Windows 窗体）和后端方面都不同，理论上如何解决这个问题？

例如，我有一个应用程序，其中有 4 种不同类型的产品。输入产品详细信息的表格都共享 3 个不同的字段。到目前为止，很容易 - 有一个基类，然后从这个基类派生 4 种形式。但是，比如说，2 种产品共享某种行为，这对它们来说都是相同的。当然，我可以有一个定义方法的接口，然后让这2个产品入口表单实现这个接口，但是由于接口没有提供默认实现，这样做岂不是很浪费？因为我必须在每个类中提供一个实现，如果它完全相同，那就是代码重复。

我当然可以将此方法放在基类中，并从中派生出 2 种形式。如果我的表单共享多个共同元素而不共享其他元素，那么在不必扯掉我的头发的情况下，最理智、最合乎逻辑的方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T22:08:14.390

为什么不让 2 个不相关的类直接从您的基类派生，然后创建一个具有通用功能的新类，并从基类派生，让其余两个类从该新类继承？

```
BaseClass
CommonClass : BaseClass
ClassA : BaseClass
ClassB : BaseClass
ClassC : CommonClass
ClassD : CommonClass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:34:01.777

将公共行为放入两个类的一种方法是让两个类*包含*该行为作为成员，而不是*继承*该行为：对于表单，这可能意味着定义一个“用户控件”（即可重用的公共控件集合）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:35:22.630

没有任何特定的布局很难说。通常，另一种更灵活的重用形式是组合而不是继承。事实上，控制层次结构显示了组合的强大程度。也许您可以将 UI 的各个部分分离为自定义控件，这些控件根据您所追求的特定产品布局进行组装

# php - 如何在jquery中预加载一个div组合框

> ID：895283
> 
> 赞同：0
> 
> 时间：2009-05-21T21:31:16.447
> 
> 标签：php, jquery

我的代码如下：

```
$("#item_select").change(function() 
{ 
    var params = $("#item_select option:selected").val();
    $.post('/account/ar_form.php', {idata: params},  function(data){
        $("#message_display" ).html(data);
    });
}); 
```

这是一个使用 /account/ar_form.php 在 div 中正确显示 html 的下拉菜单。

但它只显示在更改事件上。我希望它预加载数据。当我使用加载事件时，它会显示 html，但在更改时，它会显示两次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:41:53.090

```
$("#item_select").change(function(){ 
    var params = $("#item_select option:selected").val();
    $.post('/account/ar_form.php', {idata: params},  function(data){
        $("#message_display" ).html(data);
    });
}).triggerHandler("change"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:41:49.670

这取决于一点......你的 ar_form.php 用空白参数返回什么？

你可以通过打电话来做一个骇人听闻的方式（害怕被否决）

`$("#item_select").change();`

# locking - 我们是否要求过多的事务内存？

> ID：895289
> 
> 赞同：3
> 
> 时间：2009-05-21T21:33:14.303
> 
> 标签：locking, transactional-memory, stm

最近我一直在阅读很多关于事务性内存的文章。TM 有一些炒作，所以很多人都对它充满热情，它确实为痛苦的锁定问题提供了解决方案，但你也经常看到抱怨：

*   你不能做 I/O
*   你必须编写你的原子部分，以便它们可以运行多次（小心你的局部变量！）
*   软件事务内存性能不佳
*   [在此处插入您的小毛病]

我理解这些担忧：通常情况下，您会发现有关 STM 的文章仅在某些特定硬件上运行，这些硬件支持一些非常漂亮的原子操作（如[LL/SC](http://en.wikipedia.org/wiki/Load-Link/Store-Conditional)），或者它必须由一些虚构的编译器支持，或者它需要所有对内存的访问*都是*事务性的，它引入了类型约束 monad 样式等。最重要的是：这些都是真正的问题。

这让我问自己：**是什么反对本地使用事务内存来代替锁？**这是否已经带来了足够的价值，还是必须在所有地方使用事务内存（如果使用的话）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T12:41:19.203

> 最近我一直在阅读很多关于事务性内存的文章。

您可能还对这个[关于软件事务内存的播客](http://se-radio.net/podcast/2007-09/episode-68-dan-grossman-garbage-collection-and-transactional-memory)感兴趣，它还使用基于垃圾收集的类比介绍了 STM：

> 该[论文](http://www.cs.washington.edu/homes/djg/papers/analogy_oopsla07.pdf)是关于垃圾收集和事务内存之间的类比。除了看到类比的美妙之处，这个讨论还很好地介绍了事务性内存（在 Goetz/Holmes 情节中提到过）和 - 在某种程度上 - 垃圾收集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-18T13:56:59.707

是的，你提到的一些问题现在可能是真实的，但事情会发展。就像任何新技术一样，首先是炒作，然后新技术表明存在一些未解决的问题，然后这些问题有的解决了，有的没有。这导致解决您的问题的另一种可能性，该技术更适合。

我会说您可以将 STM 用于您的应用程序的一部分，该部分可以不受当前最先进技术的约束。例如，不介意效率损失的应用程序的一部分。

事务和非事务部分之间的通信是个大问题。有些 STM 具有锁意识，因此它们可以以一致的方式与非事务性部分进行交互。

I/O 也是可能的，但您的事务变得不可撤销，即不能中止。这意味着只有一个事务可以同时使用 I/O。一旦顶级事务成功，您也可以在非事务世界上使用 I/O，就像现在一样。

大多数 STM 库基础系统都强制用户区分事务数据和非事务数据。所以是的，你需要明白这到底意味着什么。另一方面，编译器可以推断出哪些访问必须是事务性的，问题是它们可能过于保守，从而降低了我们在显式管理不同类型的变量时可以获得的效率。这与拥有静态、局部和动态变量相同。您需要了解每个人必须制定正确程序的限制条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:09:43.733

如果您使用事务性内存作为锁的替代品，那么在持有该锁的情况下执行的所有代码都可以在完成时回滚。因此，以前使用锁的代码必须是事务性的，并且具有所有相同的缺点（和优点）。

因此，您可以将 TM 的影响限制在仅那些持有锁的代码部分，对吧？在这种情况下，可以在持有锁期间调用的每一段代码都必须支持 TM。您的程序中有多少没有持有锁并且从不被持有锁的代码调用？

# wpf - 列表视图选择颜色

> ID：895309
> 
> 赞同：2
> 
> 时间：2009-05-21T21:37:23.313
> 
> 标签：wpf, listview, selection, listviewitem

我正在玩 wpf，我看到了以下文章： [WPF ListView Inactive Selection Color](https://stackoverflow.com/questions/382006/wpf-listview-inactive-selection-color)

我想做类似的事情。我想在选择列表视图项时在它周围放置一个边框，并且我不想更改背景颜色。我想要这个的原因是我想要一个颜色编码的列表视图，并且我仍然想在选择它时看到它的颜色，但我想知道它是通过它周围有边框来选择的。

有任何想法吗？

**更新：**

我尝试了下面的答案，它让我成功了一半，它确实在 listviewitem 周围设置了一个边框，但它覆盖了我的背景颜色。我无法得到我尝试过的正确语法（注意 BasedOn）：

```
 <Style x:Key="SourceListView" TargetType="{x:Type ListViewItem}">
        <Setter Property="Background" Value="{Binding SourceType, Converter={StaticResource SourceGroupConverter}}"/>
    </Style>

    <Style x:Key="MyListViewItemStyle" TargetType="{x:Type ListViewItem}" BasedOn="{StaticResource SourceListView}" >
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListViewItem}">
                    <Border
                             x:Name="Border"
                             BorderBrush="Transparent"
                             BorderThickness="1">
                        <GridViewRowPresenter Columns="{TemplateBinding GridView.ColumnCollection}" Content="{TemplateBinding Content}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter TargetName="Border" Property="BorderBrush" Value="Black"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

然后我尝试了这个：

```
 <Style x:Key="MyListViewItemStyle" TargetType="{x:Type ListViewItem}">
        <Setter Property="Background" Value="{Binding SourceType, Converter={StaticResource SourceGroupConverter}}"/>
        <Setter Property="Template">
            ...//Same as above
        </Setter>
    </Style> 
```

两次尝试都只是将背景设置为白色（或我不知道的透明）。我知道这只是语法，我很感激朝着正确的方向再次轻推:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T22:51:35.020

将 ListView 上的 ItemContainerStyle 更改为在选择项目时不会更改背景但会更改边框颜色的样式。下面是一个例子：

```
 <Style x:Key="MyListViewItemStyle" TargetType="{x:Type ListViewItem}">
     <Setter Property="Background" Value="{Binding SourceType, Converter={StaticResource SourceGroupConverter}}" />
     <Setter Property="Template">
        <Setter.Value>
           <ControlTemplate TargetType="{x:Type ListViewItem}">
              <Border
                 x:Name="Border"
                 BorderBrush="Transparent"
                 BorderThickness="1"
                 Background="{TemplateBinding Background}">
                 <GridViewRowPresenter Columns="{TemplateBinding GridView.ColumnCollection}" Content="{TemplateBinding Content}"/>
              </Border>
              <ControlTemplate.Triggers>
                 <Trigger Property="IsSelected" Value="true">
                    <Setter TargetName="Border" Property="BorderBrush" Value="Black"/>
                 </Trigger>
              </ControlTemplate.Triggers>
           </ControlTemplate>
        </Setter.Value>
     </Setter>
  </Style> 
```

然后使用这样的样式：

```
<ListView ItemContainerStyle="{StaticResource MyListViewItemStyle}">
   ...
</ListView> 
```

# silverlight - 运行 Silverlight 网站

> ID：895313
> 
> 赞同：1
> 
> 时间：2009-05-21T21:38:11.627
> 
> 标签：silverlight, xaml, web

在浏览器中使用 Silverlight 时，是否可以切换 xaml 页面？我还想知道如何使用我在 C# 中编写的加密类来验证 Silverlight 中的用户。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T19:06:18.163

我们正在使用 Jesse Liberty 的方法在 SL2 中进行页面切换。这里解释一下。[Jesse Liberty SL2 页面切换](http://jesseliberty.com/2008/05/31/multi-page-applications-in-silverlight/)

它的外观或感觉也很像 SL3 使用上述导航的方式。

注意：如果您这样做，则需要处理浏览器上的后退按钮 - 用户在点击后退按钮时将退出您的 SL2 应用程序。SL3 内置支持正确处理和响应后退按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T01:17:01.450

如果您使用的是 Silverlight 3 Beta，那么您正在寻找的是使用 Frame 和 Page 控件的导航系统。网上有很多关于这方面的教程。

在 Silverlight 2 中，最简单的解决方案是用面板（如 Grid 或 Canvas）替换 RootVisual，并使用您自己的代码来切换子元素（通常是您自己的 UserControl）。

[Flawless Code](http://www.flawlesscode.com/post/2008/03/Silverlight-2-Navigating-Between-Xaml-Pages.aspx)上有一个很好的教程

# delphi - 在将 TComponent 写入 TStream 时压缩它们

> ID：895314
> 
> 赞同：5
> 
> 时间：2009-05-21T21:38:11.753
> 
> 标签：delphi, compression

我们正在使用的一些应用程序依赖于 TComponent 后代，以便在 Write/ReadComponentResFile 的帮助下轻松保存/加载其内部对象的状态

```
function TSomeClass.SaveState: boolean;
begin
  ...
  try
    ...
    WriteComponentResFile(self.f_path, TComponent(self));
    result := true;
  except   
    result := false;
  end;
  ....
end; 
```

现在我们想压缩这些数据，但由于某种原因，我一直无法找到使用 JCL bzip2 流类编写类似函数的方法，不支持查找操作

由于我不是 TStream 专家，我想知道实现这种压缩的最简单方法；使用 TComponent 读/写？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T21:47:40.093

`TComponent`显然希望能够在它读取或写入的流中寻找，而你通常不能用压缩流来做到这一点——至少不能向后。一旦您读取了一个字节，您就不能再返回并再次读取它，因为您获得的确切值可能取决于首先导致该字节的整个流内容。向后寻求重新读取一个字节可能意味着重新读取整个流。对于写入，要返回并“修复”流的某些区域，更改一个字节意味着需要重新压缩之后的所有内容。所以你可以看到为什么压缩流不喜欢向后搜索。

将您的数据写入 a `TMemoryStream`，然后将该流的内容复制到压缩流。要阅读，请将解压缩流复制到 a 中`TMemoryStream`，然后从那里加载您的组件。（在从内存流中加载组件之前，不要忘记将`Position`属性设置回零。）

# list - 如何使用查找命令删除除列出的文件之外的所有内容？

> ID：895319
> 
> 赞同：0
> 
> 时间：2009-05-21T21:39:38.863
> 
> 标签：list, shell, find

我在文件“list_files”中有一个隐藏文件列表，不应在当前目录中删除。如何使用查找命令删除除它们之外的所有内容？我试过了，但它显然不起作用：

```
find . -iname ".*" \! -iname 'list_files' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T02:05:16.690

您可以通过使用 bash 脚本调用 exec 来做到这一点，如下所示：-

```
find . -iname ".*" -exec bash -c "fgrep {} /tmp/list_files >/dev/null || rm -i {}" \; 
```

要非常小心你如何构建你的文件列表。要排除的文件列表必须与 find 生成的输出相同，否则您将删除与您的模式匹配的所有文件。

我已将交互式选项放在 rm 上，您可能希望将其用于测试。如果您希望使用此技术删除目录，则需要修改 rm 选项。

您可能希望使用 find 从您将用于运行查找的同一文件夹中构建文件列表，以确保排除将得到尊重，尽管绝对而不是相对路径将是更好的即更安全的选择，因此您的查找将变为

```
find /some/folder/name -name "some pattern" -exec .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T02:56:35.930

删除文件应始终安全完成。

我假设您有一个包含隐藏文件的目录树以及您想要保留的这些隐藏文件的子集列表。您要删除所有其他隐藏文件。

让我们从隐藏文件列表开始。

```
find `pwd` -iname ".*" -type f > all-hidden-files.txt 
```

现在，假设您有一些过滤器可以将列表缩减为您想要保留的所有文件（创建您的 list_files）。在这里**SomeFilter**可能是您手动编辑文件列表以保留您不想删除的文件。

```
SomeFilter all-hidden-files.txt > list_files 
```

下一个命令将识别 all-hidden-files.txt 中 list_files 中缺少的行，从而为您提供可以删除的文件。

```
comm -3 all-hidden-files.txt list_files > removable-files.txt 
```

编辑：刚刚意识到应该对 comm 的输入文件进行排序。所以用这个作为，

```
comm -3 <(sort all-hidden-files.txt | uniq) <(sort list_files | uniq) \
    > removable-files.txt 
```

您可以确认这对您有效，然后删除生成的文件列表，例如，

```
for i in $(<removable-files.txt); do rm $i; done; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:59:58.413

在源目录中创建一个临时目录，将所有内容移动到临时目录，将要保存的文件移回原始位置，然后递归删除临时目录。由于所有移动都在一个文件系统上，因此任何体面的文件系统都应该几乎是瞬时的，这是非常安全的。

# c# - 进度条帮助

> ID：895320
> 
> 赞同：1
> 
> 时间：2009-05-21T21:39:49.283
> 
> 标签：c#, .net, winforms

我对编程非常陌生，到目前为止做得还不错。但是进度条仍然让我感到困惑。不幸的是，网络有很多不同的例子让我从中得到任何东西。有人说要使用后台工作人员，有些人不使用，等等。下面我有我认为应该工作但没有工作的东西。将文件从一个文件夹复制到另一个文件夹时，它只是应该给她一个进度条。任何帮助表示赞赏。

谢谢。

```
 private void btnCopyFiles_Click(object sender, EventArgs e)
    {
        string folder1 = @"c:\folder1\";
        string folder2 = @"c:\folder2\";

        DirectoryInfo di = new DirectoryInfo(folder1);
        FileInfo[] filelist = di.GetFiles("*.*");
        int count = di.GetFiles("*.*").Length;

        this.progressBar1 = new System.Windows.Forms.ProgressBar();
        progressBar1.Maximum = count;
        progressBar1.Minimum = 0;
        progressBar1.Step = 1;

        foreach (FileInfo file in filelist)
        {
            try
            {
                this.Cursor = Cursors.WaitCursor;
                File.Copy(folder1 + @"\" + file.Name, folder2 + @"\" + file.Name, true);
                progressBar1.PerformStep();
                this.Cursor = Cursors.Default;
            }
            catch (Exception error)
            {
                MessageBox.Show("Error: " + error);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T21:45:12.563

我假设您正在使用 Visual Studio 并通过将 ProgressBar 控件拖到窗体中来添加它。如果这是正确的，那么以下行可能是问题所在：

```
this.progressBar1 = new System.Windows.Forms.ProgressBar(); 
```

通过重新创建控件，您将失去它与表单的链接。只需删除或评论该行，然后再试一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:47:05.633

总体而言，问题是您的代码继续执行，不允许表单根据需要重新绘制自己。您最好、最快的方法是使用 BackgroundWorker 来实际执行您的操作，使用它的事件来更新进度。这样做，进度条的更新在 UI 线程上完成，并且 UI 更新，您的文件操作在幕后进行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T22:08:51.923

首先，创建一个结构来保存 BackgroundWorker 的参数，该参数将在 DoWorkEventArgs 中传递。

```
public struct CopyStruct
{
    public string sourceDir;
    public string destDir;
} 
```

然后，做这样的事情：

```
private void btnCopyFiles_Click(object sender, EventArgs e)
{
    InitializeBackgroundWorker();

    CopyStruct copyStruct = new CopyStruct
    {
        sourceDir = @"C:\folder1\",
        destDir = @"C:\folder2\"
    };

    backgroundWorker.RunWorkerAsync(copyStruct);
}

private void InitializeBackgroundWorker()
{
    backgroundWorker.WorkerReportsProgress = true;
    backgroundWorker.DoWork += backgroundWorker_DoWork;
    backgroundWorker.RunWorkerCompleted += backgroundWorker_RunWorkerCompleted;
    backgroundWorker.ProgressChanged += backgroundWorker_ProgressChanged;
}

private void backgroundWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    progressBar.Value = e.ProgressPercentage;
}

private void backgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    // do something when finished
}

private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    BackgroundWorker worker = (BackgroundWorker) sender;
    CopyStruct copyStruct = (CopyStruct) e.Argument;

    DirectoryInfo di = new DirectoryInfo(copyStruct.sourceDir);
    FileInfo[] filelist = di.GetFiles("*.*");

    int numFiles = filelist.Length;

    for (int i = 0; i < numFiles; i++)
    {
        FileInfo file = filelist[i];

        File.Copy(Path.Combine(copyStruct.sourceDir, file.Name), Path.Combine(copyStruct.destDir, file.Name), true);

        // This line updates the progress bar
        worker.ReportProgress((int) ((float) i/numFiles*100));
    }
} 
```

这几乎不包含错误检查，因此您必须添加它，但它适用于我系统上的一些测试目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T21:50:48.873

要在用户界面中更新进度条，正在处理某事的进程必须在另一个线程上执行（否则它会阻塞 UI 线程，并且 UI 将不会更新）。BackgroundWorker 是执行此操作的理想选择。

[在后台工作人员的DoWork](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.dowork.aspx)事件中执行文件复制循环，并调用[BackgroundWorker.ReportProgress](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.reportprogress.aspx)方法来报告进度。在[ProgressChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)事件的事件处理程序中，您可以在 ProgressBar 控件中设置值。您可以通过在 BackgroundWorker 组件上调用[RunWorkerAsync方法来启动该过程。](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkerasync.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T21:57:15.333

由于您是编程新手，因此请从这里开始。

添加

```
 Application.DoEvents(); 
```

后

```
 progressBar1.PerformStep(); 
```

这应该让您的应用程序现在可以正常工作。您最终会希望将复制过程移至线程/后台工作人员。但不知道您的能力，Application.DoEvents() 可能是最简单的修复，但不是首选修复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T21:45:45.543

您是否尝试过 progressbar1.Increment(x) 其中 x 是传输的文件数？

# curly-braces - 括号放置会影响可读性吗？

> ID：895326
> 
> 赞同：5
> 
> 时间：2009-05-21T21:40:42.073
> 
> 标签：curly-braces

> **可能的重复：**
> [if 语句的格式](https://stackoverflow.com/questions/97506/formatting-of-if-statements)
> [是否有用于标识的最佳编码样式（同一行，下一行）？](https://stackoverflow.com/questions/159366/is-there-a-best-coding-style-for-identations-same-line-next-line)
> [编写stackoverflow样式“问题”/“标签”翻转按钮的最佳方法](https://stackoverflow.com/questions/437315/best-way-to-code-stackoverflow-style-questions-tags-rollover-buttons)

```
public void Method {

} 
```

或者

```
public void Method
{

} 
```

除了个人喜好之外，一种风格比另一种风格有什么好处吗？我曾经对第二种方法发誓，但现在在工作和个人项目中使用第一种方法。

通过可读性，我的意思是想象这些方法中的代码 - if/else 等......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T21:52:59.430

[谷歌 C++ 风格指南](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)建议

> 返回类型与函数名在同一行，参数在同一行（如果合适）。
> 
> 函数如下所示：
> 
> ```
> ReturnType ClassName::FunctionName(Type par_name1, Type par_name2) {
>   DoSomething();
>   ...
> } 
> ```

* * *

[WebKit 编码风格指南](http://webkit.org/coding/coding-style.html)建议

> 函数定义：将每个大括号放在自己的行上。
> 
> 对：
> 
> ```
> int main()
> {
>     ...
> } 
> ```
> 
> 错误的：
> 
> ```
> int main() {
>     ...
> } 
> ```

不过，他们建议将大括号用于其他所有内容。

* * *

[GNU 编码标准](http://www.gnu.org/prep/standards/standards.html)建议

> 将启动 C 函数主体的左大括号放在第一列中很重要，这样它们就可以启动 defun。有几个工具会在第一列中查找开括号以查找 C 函数的开头。这些工具不适用于未以这种方式格式化的代码。
> 
> 当它们在函数内部时，避免将左大括号、左括号或左括号放在第一列中，这样它们就不会启动 defun。如果您发现将该定义视为 defun 很有用，则开始结构体的左大括号可以放在第一列中。
> 
> 函数定义在第一列中以函数名称开头也很重要。这有助于人们搜索函数定义，也可能有助于某些工具识别它们。因此，使用标准 C 语法，格式如下：
> 
> ```
> static char *
> concat (char *s1, char *s2)
> {
>   ...
> } 
> ```
> 
> 或者，如果您想使用传统的 C 语法，请像这样格式化定义：
> 
> ```
> static char *
> concat (s1, s2)        /* Name starts in column one here */
>      char *s1, *s2;
> {                     /* Open brace in column one here */
>   ...
> } 
> ```

* * *

如你所见，每个人都有自己的看法。就个人而言，我更喜欢 Perl 风格的大括号-在同一行-除-之外- `else`，但只要编写代码的每个人都可以合作，那真的没关系。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T21:46:14.670

我认为这完全是主观的，但是，我认为为您的团队建立代码标准并让每个人都使用相同的风格很重要。话虽如此，我喜欢第二个（并让我的团队使用它），因为当它不是您的代码时，它似乎更容易阅读。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-21T21:43:43.177

在过去，我们习惯使用第一种样式（K&R 样式），因为屏幕更小，并且代码经常打印在这种称为纸张的东西上。

现在我们有大屏幕，第二种方法（ANSI 样式）可以更容易地查看您的括号是否匹配。

有关更多信息，请参见[此处](http://en.wikipedia.org/wiki/Indent_style)和[此处](http://catb.org/~esr/jargon/html/I/indent-style.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T21:43:24.347

第一个在行数方面较小（也许这就是为什么开发-Java-书籍倾向于使用该语法）

第二个是，恕我直言，因为您总是有两个对齐的括号，所以更容易阅读。

无论如何，它们都被广泛使用，这是您个人喜好的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T21:48:10.373

在这个高度情绪化的主题中，我使用 if 语句作为推理的依据。

```
if (cond) {
   //code
} 
```

只需询问 else 语句是什么样的？上述的逻辑扩展是：-

```
if (cond) {
   //code   
} else {
   //more code
} 
```

那可读吗？我不这么认为，它也很丑陋。

更多的行是 != 可读性较差。因此，我会选择你的后一种选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T21:53:17.447

就我个人而言，我发现第二个更具可读性（对齐的卷曲）。

团队使用默认值总是最容易的，因为 Visual Studio 和我同意这一点，这就是我的论点。;-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T21:42:53.350

使用第一个选项，您的代码行数将大大减少。:)

# iphone - iPhone：纹理大于 64x64？

> ID：895327
> 
> 赞同：2
> 
> 时间：2009-05-21T21:40:50.530
> 
> 标签：iphone, opengl-es, load, background, textures

我以 GLPaint 为例...我正在尝试将背景放入“PaintingView”中，这样​​您就可以在背景上绘制，最后将图像保存为文件......我迷路了。

我正在加载 PNG (512x512) 并尝试在程序一开始就“用它绘画”，但它被绘制为 64x64 而不是 512x512 ......

我之前尝试加载是作为绘画视图的子视图......但是，glReadPixels 没有按预期工作（它只考虑到绘画视图，而不是子视图）。此外，paintingView 没有像 initWithImage 这样的方法...我需要 glReadPixels 处理图像（以及修改中），但我真的不知道为什么当我加载它时，纹理的大小为 64x64。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T19:03:34.250

GLPaint 示例项目使用 GL_POINT_SPRITE 在您移动画笔时绘制画笔纹理的副本。在 iPhone 上，glPointSize 被限制为 64x64 像素。这是一个硬件限制，在模拟器中我认为你可以把它做得更大。

听起来您正在尝试使用 GL_POINT_SPRITE 方法来绘制背景图像，而这确实不是您想要的。相反，请尝试绘制一个填充屏幕的平面纹理框。

这是一些 OpenGL 代码，它为 2D 框设置顶点和 texcoords，然后绘制它：

```
const GLfloat verticies[] = {
        0.0f, 0.0f,
        1.0f, 0.0f,
        0.0f, 1.0f,
        1.0f, 1.0f,
    };

    const GLfloat texcoords[] = {
        0, 0,
        1, 0,
        0, 1,
        1, 1,
    };

    glVertexPointer(2, GL_FLOAT, 0, verticies);
    glEnableClientState(GL_VERTEX_ARRAY);
    glTexCoordPointer(2, GL_FLOAT, 0, texcoords);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);
    glEnable(GL_TEXTURE_2D);

    glBindTexture(GL_TEXTURE_2D, texture);
    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); 
```

希望有帮助！请注意，您需要根据相机投影的设置方式指定不同的顶点。就我而言，我使用下面的代码设置了我的 GL_MODELVIEW - 我不确定 GLPaint 示例是如何做到的。

```
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glOrtho(0, 1.0, 0, 1.0, -1, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T11:59:07.260

首先，`glReadPixels()`只会查看与当前 OpenGL 上下文相关联的帧缓冲区。这可以解释为什么您没有得到您期望的像素。

其次，以特定像素大小渲染纹理是什么意思？我假设纹理被渲染为一个四边形，然后这个四边形的大小应该在你的控制之下，代码方面。

另外，检查纹理的加载不会产生[OpenGL 错误](http://www.khronos.org/opengles/sdk/docs/man/glGetError.xml)，我不确定 iPhone 对纹理大小的限制是什么。512x512超出范围是完全可以想象的。您当然可以通过调用`[glGetIntegerv()](http://www.khronos.org/opengles/sdk/docs/man/glGet.xml)`和使用`GL_MAX_TEXTURE_SIZE`常量来自己研究这个问题。

# com - 使用 Windbg 查找传递给 COM+ 方法的参数

> ID：895335
> 
> 赞同：0
> 
> 时间：2009-05-21T21:42:55.533
> 
> 标签：com, windbg, com+

为 COM+ 应用程序生成了一个调试诊断转储文件。经分析，看起来像是线程处的死锁`OLE32!SwitchSTA`。我的符号路径指向 msdl.microsoft.com/download/symbols。有没有办法知道传递给这个方法的参数是什么？

一般来说，如何使用 Windbg 找到方法调用的输入参数值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T08:49:32.453

你可以打电话

```
kP 
```

它将使用参数转储调用堆栈

# c++ - 在同一个类中使用访问器

> ID：895340
> 
> 赞同：3
> 
> 时间：2009-05-21T21:43:28.840
> 
> 标签：c++, accessor

我听说在 C++ 中，`get...()`在定义访问器的同一类的成员函数中使用访问器 () 是一种好的编程习惯？这是真的吗？应该这样做吗？

例如，这是首选：

```
void display() {
    cout << getData();
} 
```

在这样的事情上：

```
void display() {
    cout << data;
} 
```

`data`是定义访问器的同一类的数据成员...与`display()`方法相同。

我正在考虑这样做的开销，特别是如果您需要在同一个类中多次调用访问器，而不是直接使用数据成员。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T21:45:58.803

这样做的原因是，如果您更改 的实现`getData()`，则不必更改直接访问的其余代码`data`。

而且，无论如何，一个智能编译器都会内联它（它总是知道类中的实现），所以没有性能损失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T21:52:09.447

这取决于。使用访问器函数提供了一个抽象层，这可以使未来对“数据”的更改不那么痛苦。例如，如果您想懒惰地计算“数据”的值，您可以将该计算隐藏在访问器函数中。

至于开销 - 如果您指的是性能开销，它可能是微不足道的 - 您的访问器几乎肯定会被内联。如果您指的是编码开销，那么是的，这是一种权衡，您必须决定是否值得为提供访问器付出额外的努力。

就个人而言，我认为在大多数情况下访问器不值得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:06:10.417

是的，我认为应该或多或少无条件地这样做。如果状态变量在某个基类中，它应该或多或少总是私有的。如果您允许它被保护或公开，所有继承的*将*直接使用它。这些类又可能是您的同事在其他项目中编写的类。如果您突然决定在基类中进行模拟并将变量名称重构为更合适的名称，则必须重写该状态的所有用户。

如果您是唯一的程序员或开发一些没人会使用的代码，这可能不是问题。但是一旦子类的数量开始增长，它可能会变得非常棘手。一定要爱透明！

然而，我不是这个星球上最好的孩子。有时我会作弊；）当你在所有者类中时，我认为直接访问私有数据是可以的。它甚至可能是有益的，因为您自动知道您正在修改您所在的实际类。鉴于您有某种命名约定实际上告诉您，例如一些带有下划线的变量名称末尾：“someVariable_ ”。

干杯！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:47:15.277

嗯，Khunt 先生，在大多数情况下，开销对于访问者来说真的是微不足道的。问题是是否需要调用访问器逻辑，或者您是否需要直接访问该字段。这是每个单独实现的问题，但在许多情况下，不会有太大的不同。

访问器的真正原因是将您的字段封装到其他类 - 而不是包含类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T21:49:41.870

就个人而言，我不喜欢有几十个额外的函数（每个成员变量都获取和设置）。我只会使用*data* ，并且只有在需要做不同的事情时才会更改为*getData() 。*由于我们讨论的是仅在一个类中更改代码，因此应该不会太难。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T21:51:31.383

我想这取决于您最终可能对您的数据成员做什么。

通过将其包装在访问器中，您可以执行诸如延迟检索数据之类的操作，如果这是一个昂贵的过程，而不是您不想做的事情，除非有人要求。另一方面，您可能知道它始终是一个愚蠢的内置类型，所以我看不出在那里通过访问器有什么好处。正如我所说，这取决于成员。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T08:25:29.080

在我看来，这个问题最重要的方面是它是否使代码更具可读性并因此可维护？我个人认为不会，所以我不会这样做。
当然，您永远不应该为此添加私有访问器，那将是胡说八道。

# android - 自定义列表单击复选框

> ID：895341
> 
> 赞同：8
> 
> 时间：2009-05-21T21:43:30.073
> 
> 标签：android, checkbox, android-listview, android-viewbinder

我已经`ListActivity`从`Cursor`使用`SimpleCursorAdapter`中填充了一个，当单击其中一个列表项时，它会启动另一个活动。我还`ViewBinder`用来对数据进行一些自定义转换。

我想为`CheckBox`列表中的每一行添加一个，所以我更改了视图并添加了一个`CheckBox`重力权。

添加`CheckBox`删除了单击项目的能力。当您按下列表项时，不再调用`onListItemClick`我覆盖的方法。`ListActivity`删除此`CheckBox`修复程序。为什么是这样？

`CheckBox`另外，如果单击列表项的主要部分但在选中项目中时具有附加功能，我如何设置列表以便它继续执行我所需的功能？将设置一个`onCheckedChangedListener`工作还是为列表中的每个项目重用相同的视图实例？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-11-28T14:05:07.457

正如[这里](https://stackoverflow.com/questions/1121192/android-custom-listview-unable-to-click-on-items)所解释的，点击监听器只有在没有其他视图的情况下才起作用`focusable`。设置你`CheckBox`应该`focusable="false"`做的伎俩：

```
<CheckBox android:focusable="false" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T22:33:17.257

看起来`SimpleCursorAdapter`对于我想要实现的目标来说太原始​​了。我已经切换到在我的方法实现中`CursorAdapter`使用实现并返回一个新视图。`LayoutInflater``newView`

```
 public View newView(Context context, Cursor cursor, ViewGroup parent) {
    return LayoutInflater.from(context).inflate(R.layout.alarm_row, parent, false);
  } 
```

在 bindView 中，我`OnClickListener`为我的 main设置了一个自定义`LinearLayout`，然后`OnCheckedChangeListener`为`CheckBox`.

为了让这一切看起来正确，我必须将`LinearLayout`' 背景设置为 android 的 menuitem 可绘制对象：

```
android:background="@android:drawable/menuitem_background" 
```

# c# - 我可以使用 VBScript 以外的语言以编程方式执行 QTP 测试吗？

> ID：895342
> 
> 赞同：11
> 
> 时间：2009-05-21T21:43:33.737
> 
> 标签：c#, vbscript, automation, qtp

我有启动 QuickTest Professional、执行一系列 QTP 测试并通过电子邮件发送结果的 VBScript 代码。这很好用，但我更喜欢使用具有更好工具支持的语言（例如一个好的 IDE）。我目前正在从启动脚本调用 .Net 库，所以我想知道是否可以使用像 C# 这样的语言来完成相同的任务。如果是这样，是否有任何好的资源可以解决这个问题？我可以通过谷歌找到关于这个主题的很少，而且似乎没有关于这个主题的任何其他问题。

为了清楚起见，我已经包含了完成大部分工作的例程的代码。这不包括 .Net 声明，但`failedTestsList`和`allTestsList`是 .Net 的实例`System.ArrayList`。

**编辑**：所有 QTP 文档示例都使用 VBScript，但正如您所见，代码只是创建 QTP 对象。我会假设这些可以从另一种支持创建这些对象的语言中调用。从我的谷歌失败看来，没有人这样做。

```
Sub ExecuteQTPTest(name)
    Dim App, resultsPath
    Dim testPath, testResults
    testPath = name
    allTestsList.Add(name)
    Set App = CreateObject("QuickTest.Application")

    App.Launch
    App.Visible = False
    App.Open testPath

    SetQTPTestOptions(App)
    SetQTPRunOptions(App)
    SetQTPWebOptions(App)

    App.Folders.RemoveAll

    Dim qtpTest, qtpResultsOpt
    Set qtpTest = App.Test
    Set qtpResultsOpt = CreateObject("QuickTest.RunResultsOptions")

    resultsPath = testPath & "\RES1"

    qtpResultsOpt.ResultsLocation = resultsPath

    qtpTest.Run qtpResultsOpt ''// Run the test

    testResults = "Test Status: " & qtpTest.LastRunResults.Status & vbCrLf & _
          "Last Error: " & qtpTest.LastRunResults.LastError & vbCrLf & _
          "Detailed Results located at " & qtpTest.LastRunResults.Path & _
               " can be viewed with the QTP Results Viewer Tool " & vbCrLf

    If qtpTest.LastRunResults.Status <> "Passed" Then
        g_testRunPassed = False
        failureCount = failureCount + 1
        failedTestsList.Add(name)
        LogResults testResults, name        
    End If

    qtpTest.Close

    Set qtpResultsOpt = Nothing 
    Set qtpTest = Nothing 

    App.Quit

    Set App = Nothing 
End Sub 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-23T11:27:25.403

抱歉，但我没有时间将您的完整示例转换为 C#。我已经整理了一个简单的演示，应该可以让您继续前进。这只是使用 C# 打开一个 QTP 实例：

```
using System;
using QTObjectModelLib;

namespace QtpDemo
{
    class QtpDriver
    {
        [STAThread]
        static void Main(string[] args)
        {
            Application app = new Application();
            app.Launch();
            app.Visible = true;
        }
    }
} 
```

您需要将其编译为链接到 C:\Program Files\Mercury Interactive\QuickTest Professional\bin\QTObjectModelLib.dll（这是 QTObjectModel.dll 的 .NET 互操作库），并在您的应用程序目录中包含该和 QTObjectModel.dll当你运行它时。

从这里开始，您应该不难将任何对象声明和函数调用从 VBScript 转换为 C#。请询问是否有任何不清楚的地方。

关于互联网上的样本的另一点 - 有很多人在那里使用 QTP 和 QC 做更高级的东西，但我认为没有共享任何真正聪明的解决方案。例如，我的雇佣合同可能会禁止我分享这些东西，但我同意你的看法——至少在谷歌上，缺乏好的 QTP API 样本。话虽如此，我衷心推荐[SQA 论坛](http://www.sqaforums.com)以满足您的 QTP 和 QC 需求。

富有的

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T19:33:57.273

是的，你可以使用任何可以“做”COM 的东西，包括 C#。当然还有 VB.NET。

以及 Perl、Python、Javascript 等。

在没有谷歌帮助的情况下，您将不得不跟随您的鼻子，了解如何处理界面，但是当您拥有现有示例时，这并不难。理想情况下，您的供应商也会为您记录 COM 接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-05T13:28:19.417

如果这对您仍然很重要... QTP 11 允许您在 C# 中编写脚本

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-25T21:52:23.247

请参阅以下答案，因为它将为您提供您正在寻找的将 C# 应用程序与 QTP/UFT 连接的确切信息：

[https://stackoverflow.com/a/19887866/2794121](https://stackoverflow.com/a/19887866/2794121)

# asp.net-mvc - 如何使用 MVC onchange of an input["text"] 处理 HTTP POST

> ID：895358
> 
> 赞同：1
> 
> 时间：2009-05-21T21:45:48.867
> 
> 标签：asp.net-mvc, onchange, http-post

我正在寻找一个很好的例子来展示如何（在控制器中）处理 POST onchange（例如输入 [“text”]）

目前，当我设置我的 onchange = form[0].submit(); 我看到控制器上的动作，HTTP 动词仍然是 GET 出于某种奇怪的原因。但是当我查看源代码时，页面上的表单有 method="POST" ...那我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:23:58.820

您是否能够使用 ajax 库（jquery、ms 等）并为调用设置一个帖子？

“javascript submit() 方法不会触发 onsubmit 事件，而是绕过它直接提交表单。” - [http://www.webmasterworld.com/forum91/4047.htm](http://www.webmasterworld.com/forum91/4047.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T13:26:23.153

你应该把

返回假

在提交事件处理函数结束时

# coldfusion - ColdFusion 中的 NTLM 身份验证

> ID：895361
> 
> 赞同：5
> 
> 时间：2009-05-21T21:45:59.083
> 
> 标签：coldfusion, ntlm

ColdFusion 中是否有推荐的（最好是免费的）方法来访问受 NTLM 身份验证保护的远程文件？cfhttp 标签似乎只支持基本身份验证。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T13:15:16.750

这个 CFX 标签 - [CFX_HTTP5](http://www.cftagstore.com/tags/cfxhttp5.cfm) - 应该可以满足您的需求。它确实要花 50 美元，但也许物有所值？似乎要付出很小的代价。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T23:56:35.120

这是我在其中找到的一些代码：

[http://www.bpurcell.org/downloads/presentations/securing_cfapps_examples.zip](http://www.bpurcell.org/downloads/presentations/securing_cfapps_examples.zip)

还有 ldap、webservices 等的示例。我将在此处粘贴 2 个文件，以便您有一个想法，代码看起来应该仍然可以工作。

```
<cfapplication name="example2" sessionmanagement="Yes" loginStorage="Session">
<!-- Application.cfm -->
<!-- CFMX will check for authentication with each page request. -->
<cfset Request.myDomain="allaire">

<cfif isdefined("url.logout")>
    <CFLOGOUT>
</cfif>

<cflogin>
   <cfif not IsDefined("cflogin")>
      <cfinclude template="loginform.cfm">
      <cfabort>
   <cfelse>
      <!--Invoke NTSecurity CFC -->
        <cfinvoke component = "NTSecurity" method = "authenticateAndGetGroups"
            returnVariable = "userRoles" domain = "#Request.myDomain#"
            userid = "#cflogin.name#" passwd = "#cflogin.password#">
        <cfif userRoles NEQ "">
            <cfloginuser name = "#cflogin.name#" password = "#cflogin.password#" roles="#stripSpacesfromList(userRoles)#">
            <cfset session.displayroles=stripSpacesfromList(userRoles)><!--- for displaying roles only --->
        <cfelse>
            <cfset loginmessage="Invalid Login">
            <cfinclude template="loginform.cfm">
            <cfabort>
        </cfif>
   </cfif>
</cflogin>

<!-- strips leading & trailing spaces from the list of roles that was returned -->
<cffunction name="stripSpacesfromList">
    <cfargument name="myList">
    <cfset myArray=listtoarray(arguments.myList)>
    <cfloop index="i" from="1" to="#arraylen(myArray)#" step="1">
        <!--- <cfset myArray[i]=replace(trim(myArray[i]), " ", "_")> 
        out<br>--->
        <cfset myArray[i]=trim(myArray[i])>
    </cfloop>
    <cfset newList=arrayToList(myArray)>
    <cfreturn newList>
</cffunction> 
```

这是您可能感兴趣的 cfc：

```
<!--- 
This component implements methods for use for NT Authentication and Authorization.

$Log: NTSecurity.cfc,v $
Revision 1.1  2002/03/08 22:40:41  jking
Revision 1.2  2002/06/26 22:46  Brandon Purcell
component for authentication and authorization
--->

<cfcomponent name="NTSecurity" >

        <!---  Authenticates the user and outputs true on success and false on failure. --->
        <cffunction name="authenticateUser" access="REMOTE" output="no" static="yes" hint="Authenticates the user." returntype="boolean">
                <cfargument name="userid" type="string" required="true" />
                <cfargument name="passwd" type="string" required="true" />
                <cfargument name="domain" type="string" required="true" />
                <cftry> 
                        <cfscript>
                        ntauth = createObject("java", "jrun.security.NTAuth");
                        ntauth.init(arguments.domain);
                        // authenticateUser throws an exception if it fails, 
                        ntauth.authenticateUser(arguments.userid, arguments.passwd);
                        </cfscript>

                <cfreturn true>
                <cfcatch>
                <cfreturn false>
                </cfcatch>
                </cftry>  
        </cffunction>

        <!--- 
                Authenticates the user and outputs true on success and false on failure.
        --->
        <cffunction access="remote" name="getUserGroups" output="false" returntype="string" hint="Gets user groups." static="yes">
                <cfargument name="userid" type="string" required="true" />
                <cfargument name="domain" type="string" required="true" />

                 <cftry>
                        <cfscript>
                        ntauth = createObject("java", "jrun.security.NTAuth");
                        ntauth.init(arguments.domain);
                        groups = ntauth.GetUserGroups(arguments.userid); 
                        // note that groups is a java.util.list, which should be 
                        // equiv to a CF array, but it's not right now???
                        groups = trim(groups.toString());
                        groups = mid(groups,2,len(groups)-2);
                        </cfscript>
                       <cfreturn groups>
                <cfcatch>
                        <cflog text="Error in ntsecurity.cfc method getUserGroups - Error: #cfcatch.message#" type="Error" log="authentication" file="authentication" thread="yes" date="yes" time="yes" application="no"> 
                        <cfreturn "">
                 </cfcatch>
                </cftry>  

        </cffunction>

        <!--- 
                This method combines the functionality of authenticateUser and getUserGroups. 
        --->
        <cffunction access="remote" name="authenticateAndGetGroups" output="false" returntype="string" hint="Authenticates the user and gets user groups if it returns nothing the user is not authticated" static="yes">
                <cfargument name="userid" type="string" required="true" />
                <cfargument name="passwd" type="string" required="true" />
                <cfargument name="domain" type="string" required="true" />  
                 <cftry>  
                        <cfscript>
                        ntauth = createObject("java", "jrun.security.NTAuth");
                        ntauth.init(arguments.domain);
                        // authenticateUser throws an exception if it fails, 
                        // so we don't have anything specific here
                        ntauth.authenticateUser(arguments.userid, arguments.passwd);
                        groups = ntauth.GetUserGroups(arguments.userid);

                        // note that groups is a java.util.list, which should be 
                        // equiv to a CF array, but it's not right now
                        groups = trim(groups.toString());
                        groups = mid(groups,2,len(groups)-2);
                        </cfscript>     
                <cfreturn groups>
                <cfcatch>
                        <cfreturn "">
                 </cfcatch>
                </cftry>   

        </cffunction>

</cfcomponent> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-23T17:41:20.077

如果 Brandon Purcell 中使用`jrun.security.NTauth`该类的代码对您不起作用`cf9`（对我不起作用），则解决方法是改用`coldfusion.security.NTAuthentication`该类。一切对我来说都很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:50:08.183

您可以尝试按照此处的指导进行操作：[http://cfsilence.com/blog/client/index.cfm/2008/3/17/ColdFusionSharepoint-Integration--Part-1--Authenticating](http://cfsilence.com/blog/client/index.cfm/2008/3/17/ColdFusionSharepoint-Integration--Part-1--Authenticating)

这归结为你在做什么：

```
edit the client-config.wsdd 
```

改变

```
<transport 
    name="http" 
    pivot="java:org.apache.axis.transport.http.HTTPSender">
</transport> 
```

到

```
<transport 
    name="http" 
    pivot="java:org.apache.axis.transport.http.CommonsHTTPSender">
</transport> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-12T08:40:44.040

就我而言，我使用“NTLM 授权代理服务器”解决了这个问题

[http://www.tldp.org/HOWTO/Web-Browsing-Behind-ISA-Server-HOWTO-4.html](http://www.tldp.org/HOWTO/Web-Browsing-Behind-ISA-Server-HOWTO-4.html)

对我来说工作得很好:)

# php - 如何在PHP中获取字符串重复的次数

> ID：895364
> 
> 赞同：1
> 
> 时间：2009-05-21T21:46:07.837
> 
> 标签：php, string

在一个字符串`"abc fox fox fox ghi xyz"`中，我怎样才能获得字符串中“狐狸”重复的次数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T21:49:11.713

```
$string = 'abc fox fox fox ghi xyz';

$substring = 'fox';

$substringCount = substr_count($string, $substring);

echo '"' . $substring . '" appears in "' . $string . '" ' . $substringCount . ' times'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T17:23:24.247

该[`substr_count()`](http://www.php.net/manual/en/function.substr-count.php)方法确实非常好，但是如果您有更多需求（例如仅匹配整个单词），这里是使用[`preg_match_all()`](http://www.php.net/manual/en/function.preg-match-all.php)和单词边界的正则表达式版本：

```
$nb_of_matches = preg_match_all('/\bfox\b/', $subject); 
```

也很简单:-)

# python - 冒泡排序作业

> ID：895371
> 
> 赞同：131
> 
> 时间：2009-05-21T21:47:24.853
> 
> 标签：python, algorithm, sorting, bubble-sort

在课堂上，我们正在做排序算法，虽然我在谈论它们和编写伪代码时理解它们很好，但我在为它们编写实际代码时遇到了问题。

这是我在 Python 中的尝试：

```
mylist = [12, 5, 13, 8, 9, 65]

def bubble(badList):
    length = len(badList) - 1
    unsorted = True

    while unsorted:
        for element in range(0,length):
            unsorted = False
            if badList[element] > badList[element + 1]:
                hold = badList[element + 1]
                badList[element + 1] = badList[element]
                badList[element] = hold
                print badList
            else:
                unsorted = True

print bubble(mylist) 
```

现在，这个（据我所知）排序正确，但一旦完成，它就会无限循环。

如何修复此代码，以便函数正确完成并正确排序任何（合理）大小的列表？

PS我知道我不应该在函数中真正打印，我应该有一个返回，但我还没有这样做，因为我的代码还没有真正工作。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-23T23:49:07.790

为了解释为什么您的脚本现在无法正常工作，我将变量重命名`unsorted`为`sorted`.

起初，您的列表尚未排序。当然，我们设置`sorted`为`False`.

一旦我们开始`while`循环，我们就假设列表已经排序。这个想法是这样的：一旦我们发现两个元素的顺序不正确，我们就`sorted`回到`False`. *只有在没有错误顺序的元素时*`sorted`才会保留。`True`

 *```
sorted = False  # We haven't started sorting yet

while not sorted:
    sorted = True  # Assume the list is now sorted
    for element in range(0, length):
        if badList[element] > badList[element + 1]:
            sorted = False  # We found two elements in the wrong order
            hold = badList[element + 1]
            badList[element + 1] = badList[element]
            badList[element] = hold
    # We went through the whole list. At this point, if there were no elements
    # in the wrong order, sorted is still True. Otherwise, it's false, and the
    # while loop executes again. 
```

还有一些小问题可以帮助代码更高效或更具可读性。

*   在`for`循环中，您使用变量`element`. 从技术上讲，`element`不是一个元素；它是一个代表列表索引的数字。而且，还蛮长的。在这些情况下，只需使用临时变量名，例如`i`“index”。

    ```
    for i in range(0, length): 
    ```

*   该`range`命令也可以只接受一个参数（名为`stop`）。在这种情况下，您将获得从 0 到该参数的所有整数的列表。

    ```
    for i in range(length): 
    ```

*   [Python 样式指南](http://www.python.org/dev/peps/pep-0008/ "Python 代码风格指南")建议使用下划线以小写字母命名变量。对于这样的小脚本，这是一个非常小的挑剔；更多的是让你习惯 Python 代码最常见的样子。

    ```
    def bubble(bad_list): 
    ```

*   要交换两个变量的值，请将它们写为元组赋值。右侧被评估为一个元组（例如`(badList[i+1], badList[i])`is `(3, 5)`），然后分配给左侧的两个变量（`(badList[i], badList[i+1])`）。

    ```
    bad_list[i], bad_list[i+1] = bad_list[i+1], bad_list[i] 
    ```

把它们放在一起，你会得到：

```
my_list = [12, 5, 13, 8, 9, 65]

def bubble(bad_list):
    length = len(bad_list) - 1
    sorted = False

    while not sorted:
        sorted = True
        for i in range(length):
            if bad_list[i] > bad_list[i+1]:
                sorted = False
                bad_list[i], bad_list[i+1] = bad_list[i+1], bad_list[i]

bubble(my_list)
print my_list 
```

（顺便说一句，我也删除了你的打印声明。）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-21T23:18:39.163

冒泡排序的目标是在每一轮中将*较重*的项目移动到底部，同时将*较轻*的项目向上移动。在比较元素的内部循环中，**您不必在每一轮中迭代整个列表**。最*重*的已经放在最后了。swapped*变量*是一个额外的检查，因此我们可以标记列表现在已排序并避免继续进行不必要的计算。

```
def bubble(badList):
    length = len(badList)
    for i in range(0,length):
        swapped = False
        for element in range(0, length-i-1):
            if badList[element] > badList[element + 1]:
                hold = badList[element + 1]
                badList[element + 1] = badList[element]
                badList[element] = hold
                swapped = True
        if not swapped: break

    return badList 
```

您的版本 1，更正：

```
def bubble(badList):
    length = len(badList) - 1
    unsorted = True
    while unsorted:
        unsorted = False
        for element in range(0,length):
            #unsorted = False
            if badList[element] > badList[element + 1]:
                 hold = badList[element + 1]
                 badList[element + 1] = badList[element]
                 badList[element] = hold
                 unsorted = True
                 #print badList
             #else:
                 #unsorted = True

     return badList 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-21T21:54:22.373

当您使用具有负面含义的变量名时会发生这种情况，您需要反转它们的值。以下内容会更容易理解：

```
sorted = False
while not sorted:
    ... 
```

另一方面，算法的逻辑有点偏离。您需要检查在 for 循环期间是否交换了两个元素。我会这样写：

```
def bubble(values):
    length = len(values) - 1
    sorted = False
    while not sorted:
        sorted = True
        for element in range(0,length):
            if values[element] > values[element + 1]:
                 hold = values[element + 1]
                 values[element + 1] = values[element]
                 values[element] = hold
                 sorted = False
    return values 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-21T21:55:33.013

您对 Unsorted 变量的使用是错误的；你想要一个变量来告诉你是否交换了两个元素；如果你已经这样做了，你可以退出你的循环，否则，你需要再次循环。要解决您在这里遇到的问题，只需将“unsorted = false”放在 if 案例的正文中；删除您的 else 案例；并将 "unsorted = true 放在你的`for`循环之前。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-21T23:17:22.973

```
def bubble_sort(l):
    for passes_left in range(len(l)-1, 0, -1):
        for index in range(passes_left):
            if l[index] < l[index + 1]:
               l[index], l[index + 1] = l[index + 1], l[index]
    return l 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-14T23:01:18.410

#一个非常简单的函数，可以（显然）通过减少第二个数组的问题空间来优化。但相同的 O(n^2) 复杂度。

```
def bubble(arr):
    l = len(arr)        
    for a in range(l):
        for b in range(l-1):
            if (arr[a] < arr[b]):
            arr[a], arr[b] = arr[b], arr[a]
    return arr 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-21T22:08:14.953

你有几个错误在那里。第一个是长度，第二个是你对 unsorted 的使用（如 McWafflestix 所述）。如果您要打印它，您可能还想返回列表：

```
mylist = [12, 5, 13, 8, 9, 65]

def bubble(badList):
    length = len(badList) - 2
    unsorted = True

    while unsorted:
        for element in range(0,length):
            unsorted = False

            if badList[element] > badList[element + 1]:
                hold = badList[element + 1]
                badList[element + 1] = badList[element]
                badList[element] = hold
                print badList
                unsorted = True

    return badList

print bubble(mylist) 
```

eta：你说得对，上面的东西是马车。我不通过更多示例进行测试是不好的。

```
def bubble2(badList):
    swapped = True
    length = len(badList) - 2

    while swapped:
        swapped = False
        for i in range(0, length):
            if badList[i] > badList[i + 1]:

                # swap
                hold = badList[i + 1]
                badList[i + 1] = badList[i]
                badList[i] = hold

                swapped = True

    return badList 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-19T13:09:36.677

我是一个新手，昨天开始阅读 Python。受你的例子的启发，我创造了一些可能更像 80 系风格​​的东西，但它还是有点用

```
lista1 = [12, 5, 13, 8, 9, 65]

i=0
while i < len(lista1)-1:
    if lista1[i] > lista1[i+1]:
        x = lista1[i]
        lista1[i] = lista1[i+1]
        lista1[i+1] = x
        i=0
        continue
    else:
        i+=1

print(lista1) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-23T02:16:20.210

原始算法的问题在于，如果列表中的数字较低，则不会将其带到正确的排序位置。程序每次都需要回到开头，以确保数字一直排序。

我简化了代码，它现在适用于任何数字列表，无论列表如何，即使有重复的数字。这是代码

```
mylist = [9, 8, 5, 4, 12, 1, 7, 5, 2]
print mylist

def bubble(badList):
    length = len(badList) - 1
    element = 0
    while element < length:
        if badList[element] > badList[element + 1]:
            hold = badList[element + 1]
            badList[element + 1] = badList[element]
            badList[element] = hold
            element = 0
            print badList
        else:
            element = element + 1

print bubble(mylist) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-05T06:41:12.697

```
def bubble_sort(l):
    exchanged = True
    iteration = 0
    n = len(l)

    while(exchanged):
        iteration += 1
        exchanged = False

        # Move the largest element to the end of the list
        for i in range(n-1):
            if l[i] > l[i+1]:
                exchanged = True
                l[i], l[i+1] = l[i+1], l[i]
        n -= 1   # Largest element already towards the end

    print 'Iterations: %s' %(iteration)
    return l 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-02-16T23:02:43.477

```
def bubbleSort(alist):
if len(alist) <= 1:
    return alist
for i in range(0,len(alist)):
   print "i is :%d",i
   for j in range(0,i):
      print "j is:%d",j
      print "alist[i] is :%d, alist[j] is :%d"%(alist[i],alist[j])
      if alist[i] > alist[j]:
         alist[i],alist[j] = alist[j],alist[i]
return alist 
```

alist = [54,26,93,17,77,31,44,55,20,-23,-34,16,11,11,11]

打印气泡排序（alist）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-03-16T20:47:13.620

```
def bubble_sort(a):
    t = 0
    sorted = False # sorted = False because we have not began to sort
    while not sorted:
    sorted = True # Assume sorted = True first, it will switch only there is any change
        for key in range(1,len(a)):
            if a[key-1] > a[key]:
                sorted = False
                t = a[key-1]; a[key-1] = a[key]; a[key] = t;
    print a 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-09-04T07:13:41.427

一个更简单的例子：

```
a = len(alist)-1
while a > 0:
    for b in range(0,a):
        #compare with the adjacent element
        if alist[b]>=alist[b+1]:
            #swap both elements
            alist[b], alist[b+1] = alist[b+1], alist[b]
    a-=1 
```

这只是将元素从 0 带到 a（基本上是该轮中所有未排序的元素）并将其与其相邻元素进行比较，如果它大于其相邻元素则进行交换。在回合结束时，对最后一个元素进行排序，并且在没有它的情况下再次运行该过程，直到所有元素都已排序。

不需要条件是否`sort`为真。

请注意，该算法仅在交换时考虑数字的位置，因此重复的数字不会影响它。

PS。我知道这个问题发布已经很久了，但我只是想分享这个想法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-06-14T21:30:58.457

```
def bubble_sort(li):
    l = len(li)
    tmp = None
    sorted_l = sorted(li)
    while (li != sorted_l):
        for ele in range(0,l-1):
            if li[ele] > li[ele+1]:
                tmp = li[ele+1]
                li[ele+1] = li [ele]
                li[ele] = tmp
    return li 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-01-18T15:32:51.923

```
def bubbleSort ( arr ):
    swapped = True 
    length = len ( arr )
    j = 0

    while swapped:
        swapped = False
        j += 1 
        for i in range ( length  - j ):
            if arr [ i ] > arr [ i + 1 ]:
                # swap
                tmp = arr [ i ]
                arr [ i ] = arr [ i + 1]
                arr [ i + 1 ] = tmp 

                swapped = True

if __name__ == '__main__':
    # test list
    a = [ 67, 45, 39, -1, -5, -44 ];

    print ( a )
    bubbleSort ( a )
    print ( a ) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-05T23:26:22.007

```
def bubblesort(array):
    for i in range(len(array)-1):
        for j in range(len(array)-1-i):
            if array[j] > array[j+1]:
                array[j], array[j+1] = array[j+1], array[j]
    return(array)

print(bubblesort([3,1,6,2,5,4])) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-09-27T09:14:16.637

```
arr = [5,4,3,1,6,8,10,9] # array not sorted

for i in range(len(arr)):
    for j in range(i, len(arr)):
        if(arr[i] > arr[j]):
            arr[i], arr[j] = arr[j], arr[i]

            print (arr) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-11-02T17:02:00.903

**我考虑添加我的解决方案，因为这里的解决方案有**

1.  *更多时间*
2.  *更大的空间复杂度*
3.  *或者做太多操作*

**那么应该是**

***所以，这是我的解决方案：***

* * *

```
def countInversions(arr):
    count = 0
    n = len(arr)
    for i in range(n):
        _count = count
        for j in range(0, n - i - 1):
            if arr[j] > arr[j + 1]:
                count += 1
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
        if _count == count:
            break
    return count 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-03-19T17:46:42.237

如果有人对使用列表理解的更短的实现感兴趣：

```
def bubble_sort(lst: list) -> None:
    [swap_items(lst, i, i+1) for left in range(len(lst)-1, 0, -1) for i in range(left) if lst[i] > lst[i+1]]

def swap_items(lst: list, pos1: int, pos2: int) -> None:
    lst[pos1], lst[pos2] = lst[pos2], lst[pos1] 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-04T22:31:27.033

`for`这是没有循环的冒泡排序的不同变体。基本上你正在考虑 的`lastIndex`并`array`慢慢地`decrementing`直到它成为数组的第一个索引。

将`algorithm`继续像这样在阵列中移动，直到完成整个传递而没有`swaps`发生任何事情。

泡沫基本上`Quadratic Time: O(n²)`是在性能方面。

```
class BubbleSort: 
  def __init__(self, arr):
    self.arr = arr;

  def bubbleSort(self):
    count = 0;
    lastIndex = len(self.arr) - 1;

    while(count < lastIndex):
      if(self.arr[count] > self.arr[count + 1]):
        self.swap(count)  
      count = count + 1;

      if(count == lastIndex):
        count = 0;
        lastIndex = lastIndex - 1;   

  def swap(self, count):
    temp = self.arr[count];
    self.arr[count] = self.arr[count + 1];
    self.arr[count + 1] = temp;

arr = [9, 1, 5, 3, 8, 2]
p1 = BubbleSort(arr)

print(p1.bubbleSort()) 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-05-21T23:12:40.500

the-fury 和 Martin Cote 提供的答案解决了无限循环的问题，但我的代码仍然无法正常工作（对于更大的列表，它不会正确排序。）。我最终放弃了`unsorted`变量并使用了计数器。

```
def bubble(badList):
    length = len(badList) - 1
    n = 0
    while n < len(badList):
        for element in range(0,length):
            if badList[element] > badList[element + 1]:
                hold = badList[element + 1]
                badList[element + 1] = badList[element]
                badList[element] = hold
                n = 0
            else:
                n += 1
    return badList

if __name__ == '__main__':
    mylist = [90, 10, 2, 76, 17, 66, 57, 23, 57, 99]
    print bubble(mylist) 
```

如果有人可以在评论中提供有关如何改进我的代码的任何指示，将不胜感激。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2018-10-24T13:46:28.463

试试这个

```
a = int(input("Enter Limit"))

val = []

for z in range(0,a):
    b = int(input("Enter Number in List"))
    val.append(b)

for y in range(0,len(val)):
   for x in range(0,len(val)-1):
       if val[x]>val[x+1]:
           t = val[x]
           val[x] = val[x+1]
           val[x+1] = t

print(val) 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2019-03-07T14:36:40.133

如果这可能会在 9 年后对您有所帮助……它是一个简单的冒泡排序程序

```
 l=[1,6,3,7,5,9,8,2,4,10]

    for i in range(1,len(l)):
        for j in range (i+1,len(l)):
            if l[i]>l[j]:
                l[i],l[j]=l[j],l[i] 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2019-06-23T20:43:59.620

```
def merge_bubble(arr):
    k = len(arr)
    while k>2:
        for i in range(0,k-1):
            for j in range(0,k-1):
                if arr[j] > arr[j+1]:
                    arr[j],arr[j+1] = arr[j+1],arr[j]

        return arr
        break
    else:
        if arr[0] > arr[1]:
            arr[0],arr[1] = arr[1],arr[0]
        return arr 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2019-08-20T02:29:04.453

```
def bubble_sort(l):
    for i in range(len(l) -1):
        for j in range(len(l)-i-1):
            if l[j] > l[j+1]:
                l[j],l[j+1] = l[j+1], l[j]
    return l 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2020-07-15T07:20:40.753

```
def bubble_sorted(arr:list):
    while True:
        for i in range(0,len(arr)-1):
            count = 0
            if arr[i] > arr[i+1]:
                count += 1
                arr[i], arr[i+1] = arr[i+1], arr[i]
        if count == 0:
            break
    return arr
arr = [30,20,80,40,50,10,60,70,90]
print(bubble_sorted(arr))
#[20, 30, 40, 50, 10, 60, 70, 80, 90] 
```

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2018-03-21T19:39:05.293

`def bubbleSort(a): def swap(x, y): temp = a[x] a[x] = a[y] a[y] = temp #outer loop for j in range(len(a)): #slicing to the center, inner loop, python style for i in range(j, len(a) - j):
#find the min index and swap if a[i] < a[j]: swap(j, i) #find the max index and swap if a[i] > a[len(a) - j - 1]: swap(len(a) - j - 1, i) return a`

# button - Facebook Connect 关于自定义分享按钮的查询

> ID：895379
> 
> 赞同：0
> 
> 时间：2009-05-21T21:49:01.933
> 
> 标签：button, facebook, share

我真的很讨厌在 SO 上询问 Facebook Connect，但他们自己的开发论坛太可怕了。

我们正在使用这个实现一个 Facebook 分享按钮：

```
<fb:share-button class="url" href="http://oursite.com/"></fb:shared-button> 
```

这在这里记录（很差）：[http ://wiki.developers.facebook.com/index.php/Fb:share-button](http://wiki.developers.facebook.com/index.php/Fb:share-button)

我需要能够将文本从“共享”更改为其他内容。我花了 2 个小时来寻找这个问题的答案，但结果很短。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-03T20:30:22.247

如果您真的想自定义 facebook 分享按钮，请查看您将用于桌面应用程序的 url。让它变得更好。您还可以使用 AddThis 以相同的方式从共享中获取一些分析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-26T14:20:04.810

使用社交插件之类的替换插件（您现在应该使用的插件，而不是已弃用的 fb:share-button），您有两种按钮文本选择： `Like`或`Recommend`.
[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

# javascript - 传递整数时截断宽度函数不起作用

> ID：895381
> 
> 赞同：1
> 
> 时间：2009-05-21T21:49:20.420
> 
> 标签：javascript, jquery

我正在尝试创建一个通用函数，我可以从多个位置调用它以递归地截断长文本以适应预定义的像素宽度 - 使用 jquery。

这是代码...

```
function constrain(text, original, ideal_width){

    var ideal = parseInt(ideal_width);

    $('span.temp_item').remove();
    var temp_item = ('<span class="temp_item" style="display:none">'+ text +'</span>');
    var item_length = text.length; 
    $(temp_item).appendTo('body');
    var item_width = $('span.temp_item').width();

    if (item_width > ideal) {
        var smaller_text = text.substr(0, (item_length-1));
        return constrain(smaller_text, original);
    } else if (item_length != original) {
        return (text + '&hellip;');
    } else if (item_length == original) {
        return text;
    }
} 
```

如果我像这样运行函数：

```
 $('.service_link span:odd').each(function(){
    var item_text = $(this).text();
    var original_length = item_text.length;
    var constrained = constrain(item_text, original_length,'175');
    $(this).html(constrained);
}); 
```

文本不会截断。我还尝试了不带引号的 175。

如果我定义 var Ideal = 175; 在函数内部，然后它就起作用了。为什么将 175 传递给函数不起作用？我对它做了一个 parseInt 以防它是一个字符串。

另外——这个截断代码在旧机器上运行有点慢——有什么加快它的技巧吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-14T08:34:38.887

很棒的东西在这里。我使用了 Phil Carter 的功能。我只是希望将带有 &hellip 的新字符串以与其他字符串相同的宽度截断。

我只是快速添加了另一个临时宽度查找和递归调用。可以使用一些清理，但它的工作原理。这是新的时间：

```
while(item_width > ideal) {                     
            var smaller_text = text.substr(0, (item_length-1));
            return constrain(smaller_text, original, ideal_width, counter);
    } 

    if (item_length != original) {
            new_text=text+'&hellip;';
            $('span.temp_item').remove();
            var temp_item = ('<span class="temp_item" style="display:none">'+ new_text +'</span>');
            $(temp_item).appendTo('body');
            var item_width_new = $('span.temp_item').width();
        if(item_width_new>ideal){
            var smaller_text = text.substr(0, (item_length-1));
            return constrain(smaller_text, original, ideal_width, counter);         
        }
        else {
            return new_text;
        }
    } else if (item_length == original) {
            return text;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:55:29.283

当您网站的访问者按下“ctl +”时会发生什么？我（可能已经过时）认为您应该对字体容器使用“em”大小，因此它们可以缩放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:04:05.193

**我们写的总数**

所以我决定你在 5 个跨度内迭代 lorum ipsum 文本，花费 16 秒太长了，所以想了想如何加快速度。我把它降到了 0.4 秒。

```
function constrain(text, original, ideal_width, counter){

    var ideal = parseInt(ideal_width);

    $('span.temp_item').remove();
    var temp_item = ('<span class="temp_item" style="display:none">'+ text +'</span>');
    var item_length = text.length; 
    $(temp_item).appendTo('body');
    var item_width = $('span.temp_item').width();

    if(counter == 0) {
    //work out some ranges
    var temp_item = ('<span class="temp_item_i" style="display:none">i</span>');
        $(temp_item).appendTo('body');
        var i_width = $('span.temp_item_i').width();

    var max_i = Math.round((ideal_width / i_width) + 1);

    var temp_item = ('<span class="temp_item_m" style="display:none">M</span>');
        $(temp_item).appendTo('body');
        var m_width = $('span.temp_item_m').width();

    var max_m = Math.round((ideal_width / m_width) + 1);

    text = text.substr(0, (max_i - max_m));

        var item_length = text.length; 
    }
    counter++;

while(item_width > ideal) {         
            var smaller_text = text.substr(0, (item_length-1));
            return constrain(smaller_text, original, ideal_width, counter);
    } 

    if (item_length != original) {

            return (text + '&hellip;');
    } else if (item_length == original) {
            return text;
    }
}

$(document).ready(function() {
var d = new Date();
var s = d.getTime();

$('.service_link').each(function(){
        var item_text = $(this).text();
        var original_length = item_text.length;
        var constrained = constrain(item_text, original_length, 175, 0);
        $(this).html(constrained);
});

var e = d.getTime()

alert('Time Taken: ' + ((e - s)/1000));
}); 
```

基本上在第一次运行时，它会计算出空间中有多少个小写 i 和多少个大写 Ms，然后将文本长度限制在这个范围内，这大大减少了迭代次数。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:06:37.093

啊...发现了错误-忘记将递归部分传递给理想的宽度：

```
return constrain(smaller_text, original, ideal); 
```

# c# - 具有强类型 MVC 的实体框架

> ID：895382
> 
> 赞同：12
> 
> 时间：2009-05-21T21:49:29.403
> 
> 标签：c#, .net, asp.net, asp.net-mvc, entity-framework

我同时使用 ASP.NET MVC 和 ADO.NET Entity Framework。

我希望我的视图和控制器是强类型的。

但是我应该如何处理实体关联呢？

这是一个简单的例子：

一个人有一个部门。一个部门有零个或多个人。

![人员和部门实体的实体数据模型](https://i.stack.imgur.com/G8m7Z.gif)

我的控制器将 Person 对象的一个​​实例和所有 Department 对象的集合传递给 View。

```
public class PersonController : Controller
{
    ...

    //
    // GET: /Person/Create

    public ActionResult Create()
    {
        Person Model = new Person();
        Model.Id = Guid.NewGuid();
        ViewData["Departments"] = db.Department;
        return View(Model);
    } 
    ...
} 
```

我的视图有一个“部门”下拉列表，其中包含所有部门作为选项。

```
<% using (Html.BeginForm()) {%>

    <fieldset>
        <legend>Fields</legend>
        <p>
            <label for="Id">Id:</label>
            <%= Html.TextBox("Id") %>
            <%= Html.ValidationMessage("Id", "*") %>
        </p>
        <p>
            <label for="Name">Name:</label>
            <%= Html.TextBox("Name") %>
            <%= Html.ValidationMessage("Name", "*") %>
        </p>
        <p>
            <label for="Department">Family:</label>
            <%= Html.DropDownList("Department", new SelectList((IEnumerable)ViewData["Departments"], "Id", "Name"))%>
            <%= Html.ValidationMessage("Department", "*")%>
        </p>
        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>

<% } %> 
```

但是，发布到控制器的 Person 对象**没有 Department 并且失败了！**

```
public class PersonController : Controller
{
    ...

    //
    // POST: /Person/Create

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(Person Model)
    {
        try
        {
            db.AddToPerson(Model);
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        catch
        {
            return View();
        }
    }
    ...
} 
```

为什么从 DropDownList "Department" 中选择的部门没有自动添加到模型 Person 中？

如何将 ADO.NET Entity Framework 和 ASP.NET MVC 与强类型视图和控制器一起使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T22:58:01.530

I will try to guide you from the MVC side, as this is where the problem is, I believe

In the Create() method you create the Person object and the list of Departments from the database, then both objects are passed to the View. The View takes the data from the Department list and uses it to render an HTML form - using only Id and Name.

In the next step the form is submitted to the server as a collection of value-key pairs (standard POST). The routing engine takes the requested url from the action attribute and resolves it to PersonController.Create(Person Model) action. The argument of this method is Person, so the data binder kicks in, creates the new instance of Person class and tries to match the incoming data with properties of the Person. In case of Department the incoming value is the Id of the department (because this is what you set as a value member for the DropDownList), while the property Department on the Person class is probably of Department type. This is a mismatch, so it cannot fill the property and it is left empty.

As you can see, this is not the limitation of DropDownList, the problem is that you cannot pass all Department data to the DropDownList and have it recreated during save (like with the Person), because of a nature of the POST request, and that is why the DropDownList takes only two values from each Department (value and name).

My usual solution: as normally my models are not the same classes as my business objects, I do this by having two properties on the model: get only IEnumerable property, and another DepartmentId property (get/set). Then I use it like this:

```
<%= Html.DropDownList("DepartmentId", Model.Departments) %> 
```

Then in the save action, I grab the Department from the db using DepartmentId, assign it to Person and save.

In your case (models being business objects) I would probably not try to bind the Department to the Person model automatically, but just grab the Id and do it by myself.

This is just a guess (I'm not an EF specialist), but I think you may have another issue here: if the db is a field on Controller, and it is recreated at each request, this may be some unnecessary overhead. I hope it doesn't open a db connection every time, please check it.

Hope that helps

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-31T01:13:06.663

我使用 ViewModel（查看 NerdDinner 教程，底部的参考资料）。

首先，您需要通过部分扩展模型来伪造外键约束：

```
public partial class Person
{
  public int DepartmentId
  {
    get
    {
      if(this.DepartmentsReference.EntityKey == null) return 0;
      else 
        return (int)this.DepartmentsReference.EntityKey.EntityKeyValues[0].Value;
    }
    set
    {
      this.DepartmentsReference.EntityKey = 
          new EntityKey("YourEntities.DepartmentSet", "Id", value);
    }
  }
} 
```

二、创建ViewModel：

```
public class PersonFormViewModel
{
  public SelectList Departments { get; set: }
  public Person Pers { get; set; }

  public PersonFormViewModel(Person p, List<Department> departments)
  {
    this.Pers = p;
    this.Departments = new SelectList(departments, "Id", "Name", p.DepartmentId);
  }
} 
```

三、控制器动作（一个简写的create例子）：

```
public ActionResult Create()
{
  YourEntities entities = new YourEntities();
  List<Department> departments = entities.DepartmentSet.ToList();
  PersonFormViewModel viewModel = 
    new PersonFormViewModel(new Person(), departments);
  return View(modelView);
}    

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create([Bind(Exclude="Id")]Person personToCreate
{
  YourEntities entities = new YourEntities(); // Probably not instantiated here
  entities.AddToPersonSet(personToCreate);
  entities.SaveChanges();
  redirectToAction("Index");
} 
```

四、视图片段：

```
<p>
  <label for="Name">Name:</label>
  <%= Html.TextBox("Name", Model.Pers.Name) %>
  <%= Html.ValidationMessage("Name", "*") %>
</p>
<p>
  <label for="DepartmentId">Family:</label>
  <%= Html.DropDownList("DepartmentId", Model.Departments)%>
  <%= Html.ValidationMessage("DepartmentId", "*")%>
</p> 
```

**参考：**

*   [NerdDinner 教程](http://nerddinnerbook.s3.amazonaws.com/Part6.htm)
*   [如何伪造外键属性](http://blogs.msdn.com/alexj/archive/2009/03/25/tip-7-faking-foreign-key-properties-in-net-3-5-sp1.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T22:10:50.017

我还没有发现开箱即用的 DropDownList 助手可以很好地与模型绑定配合使用。在将更改提交到存储库或数据库之前，我总是必须从 ViewData 中获取 DropDownList 的值并在我的控制器中手动映射该值。

大多数时候，我使用 DropDownList 来显示自定义类型关系的选项（例如人员的部门）。MVC 无法知道如何仅根据列表中选定项的值来映射对象。相反，您必须使用选定的值获取该实体并自己映射它。我不知道这是否是这里的问题，而且我没有尝试将列表绑定到仅具有简单类型作为选项的模型（例如要购买的产品数量或类似的东西），但我会很好奇了解有关此特定问题的更多信息以及其他人如何使用下拉列表管理模型绑定。

# .net - 加密大量大图像的最佳方法是什么？

> ID：895385
> 
> 赞同：0
> 
> 时间：2009-05-21T21:49:57.390
> 
> 标签：.net, encryption, jpeg, jpeg2000

我需要加密很多大型 JPEG 文件。

图片非常敏感，只需要在我的应用程序中解密。

由于图像的数量和大小，速度是一个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T21:56:02.620

你的文件是什么格式并不重要——你可以加密任何字节序列。

阅读有关[TripleDESCryptoServiceProvider](http://msdn.microsoft.com/en-us/library/system.security.cryptography.tripledescryptoserviceprovider(loband).aspx)的文档，它将为您提供加密任何东西所需的所有工具。

当然，如果`TripleDES`对你来说太慢，你可以尝试一个较弱的算法。但是，老实说，在这些问题上，您通常会以速度换取安全性。

# python - 如果我想在内存缓存中存储一 个 None 值怎么办？

> ID：895386
> 
> 赞同：10
> 
> 时间：2009-05-21T21:50:03.773
> 
> 标签：python, google-app-engine, memcached

这与 Google App Engine Memcache API 特别相关，但我确信它也适用于其他 Memcache 工具。

字典 .get() 方法允许你指定一个默认值，例如 dict.get('key', 'defaultval')

如果您可能希望将 None 作为值存储在字典中，这将很有用。

但是， memcache.get() 不允许您这样做。我已经修改了我的 @memoize 装饰器，所以它看起来像这样：

```
def memoize(keyformat, time=1000000):

    """Decorator to memoize functions using memcache."""
    def decorator(fxn):
        def wrapper(*args, **kwargs):
            key = keyformat + str(args[1:]) + str(kwargs)
            from google.appengine.api import memcache
            data = memcache.get(key)
            if Debug(): return fxn(*args, **kwargs) 
            if data:
                if data is 'None': data =  None
                return data
            data = fxn(*args, **kwargs)
            if data is None: data = 'None' 
            memcache.set(key, data, time)
            return data
        return wrapper
    return decorator 
```

现在我确信有一个很好的论据，我不应该首先存储 None 值，但现在让我们把它放在一边。除了将 None vals 转换为字符串并返回之外，还有更好的方法可以处理这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T22:29:26.890

一种可能的方法是创建`None`为此目的定义的新类，并将其实例分配给缓存（不幸的是，您不能扩展`None`）。或者，您可以使用空字符串“”，或者完全避免存储无/空值（没有键意味着无）。

`mc.get(key)`然后在检查( `is None`,`== ""`等)的结果时检查“无”类的实例

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T14:10:46.920

你可以做类似 Haskell 和 Scala 所做的事情并存储一个 Option 字典。字典包含两个键：一个键表示它是有效的，一个键用于保存数据。像这样的东西：

```
{valid: true, data: whatyouwanttostore} 
```

那么如果`get`返回None，就知道缓存丢失了；如果结果是一个以 None 为数据的字典，则您知道数据在缓存中，但它是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T04:33:50.267

并不真地。

您可以将 None 值存储为空字符串，但实际上没有办法将特殊数据存储在 memcache 中。

缓存键不存在和缓存值为无之间有什么区别？将这两种情况统一起来可能会更好。

# windows - 创建一个位于 Windows 任务栏中的程序，并在激活时阻止屏幕保护程序启动

> ID：895389
> 
> 赞同：2
> 
> 时间：2009-05-21T21:50:26.330
> 
> 标签：windows, winapi, input, taskbar, screensaver

我真的不知道从哪里开始。让我们从愚蠢的问题开始：

我应该为此使用什么语言？什么适合手头的任务？

接下来是真人：

除了更改光标位置之外，有没有办法阻止屏幕保护程序启动？如果没有，更改光标位置是否有效？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T22:07:06.310

[如果您传递 ES_CONTINUOUS 和 ES_DISPLAY_REQUIRED 标志， SetThreadExecutionState](http://msdn.microsoft.com/en-us/library/aa373208.aspx)将阻止屏幕保护程序开启或机器自动进入睡眠状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T00:43:12.443

我不久前写了一个应用程序，它完全符合您的要求。它在系统托盘而不是任务栏中作为图标运行，并使用全局消息挂钩来禁止`WM_SYSCOMMAND/SC_SCREENSAVE`通知到达任何应用程序。如果该通知未到达 DefWindowProc() 函数，则屏幕保护程序将永远不会运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:01:19.333

1.  您的程序根本不需要在任务栏中可见。
2.  如果您可以在注册表中禁用屏幕保护程序，您甚至根本不需要程序。
3.  您想要做的*也许*可以通过向桌面窗口发送 MOUSE_MOVE 事件来实现。如果您想使用 C#（我目前唯一使用的语言），您可以查看[这篇文章](http://pinvoke.net/default.aspx/user32/mouse_event.html)，但使用 WinAPI 的简单 C 程序可能更适合此任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:01:21.877

.NET 将允许您轻松地将应用程序放入系统托盘（检查 System.Windows.Forms.Controls 中的 NotifyIcon 对象）。

我相信您可以使用 SetCursorPos ( [http://msdn.microsoft.com/en-us/library/ms648394(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms648394(VS.85).aspx) ) API 调用来阻止屏幕保护程序，只需确保将它们设置为当前位置，因此您实际上不会移动鼠标。

# c# - 客户端对象（代理）如何注册到要在服务器端触发的事件？

> ID：895393
> 
> 赞同：1
> 
> 时间：2009-05-21T21:51:21.350
> 
> 标签：c#, .net, remoting

我想创建一个类，其中实例化对象的客户端（代理）可以注册到事件（或委托），并在服务器端触发此事件时得到通知。

我直接尝试过，但我收到一条无法在此安全级别序列化的`SecurityException`通知。`System.DelegateSerializationHolder`

有没有解决的办法？

例子：

```
MyClass proxy = Activator.GetObject(typeof(MyClass ), uri) as MyClass;
proxy.OnMyEvent += new MyEventHandler(this.Callback); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:02:37.490

不，反正不是直接的。

您的选择是让客户端回调服务器并向其注册一个端口，用于来自服务器的带外控制。这可能会引发各种安全问题。

可能最好的方法是让客户端轮询服务器以查看是否需要处理任何事件。这将信息请求的控制权留在了客户端域中，这也是我使用过的 Microsoft Exchange 和其他产品倾向于处理这种情况的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-01T14:26:14.223

是的，这是可能的，但默认情况下它已停用。

默认的 .net Remoting 反序列化级别是`Low`，它不允许通过 Remoting 边界传递委托。您可以创建一个反序列化级别为的自定义 BinaryServerFormatterSinkProvider`Full`并将此提供程序传递给您的通道（在服务器端）。

这是一个 VB.NET 示例；有关C# 示例，请参阅有关[*.NET Framework Remoting 中的自动反序列化*](http://msdn.microsoft.com/en-us/library/5dxse167.aspx)[的 MSDN 文章。](http://msdn.microsoft.com/en-us/library/5dxse167.aspx)

 *```
Dim myChannel = New TcpServerChannel("", myPort, _
                                     New BinaryServerFormatterSinkProvider() With {.TypeFilterLevel = Runtime.Serialization.Formatters.TypeFilterLevel.Full}) 
```

# c# - 如何在大量数字中找到平均值？

> ID：895396
> 
> 赞同：18
> 
> 时间：2009-05-21T21:51:37.403
> 
> 标签：c#, math, memory

我有一大堆数字，可能在数千兆字节范围内。第一个问题是我无法将所有这些都存储在内存中。其次是任何添加这些的尝试都会导致溢出。我正在考虑使用更多的滚动平均值，但它需要准确。有任何想法吗？

这些都是浮点数。

这不是从数据库中读取的，它是从多个来源收集的 CSV 文件。它必须是准确的，因为它存储为秒的一部分（例如；0.293482888929），并且滚动平均值可以是 0.2 和 0.3 之间的差异

它是一组#，表示用户响应某些表单操作所花费的时间。例如，当显示一个消息框时，他们按 OK 或 Cancel 花了多长时间。发送给我的数据存储为 seconds.portions of a second；例如 1.2347 秒。将其转换为毫秒，我会很快溢出 int、long 等。即使我不转换它，我仍然会很快溢出它。我想下面的一个答案是正确的，也许我不必 100% 准确，只需在特定的 StdDev 内的某个范围内查看，我就足够接近了。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-21T21:56:11.280

[您可以从您的集合（“人口](http://en.wikipedia.org/wiki/Statistical_population)”）中随机抽样以获得平均值（“[平均值](http://en.wikipedia.org/wiki/Arithmetic_mean)”）。准确性将取决于您的样本变化量（由“[标准偏差](http://en.wikipedia.org/wiki/Standard_deviation#Estimating_population_SD)”或方差确定）。

优点是您有数十亿个观察值，您只需对其中的一小部分进行采样即可获得不错的准确度或您选择的“[置信范围](http://en.wikipedia.org/wiki/Confidence_interval)”。如果条件合适，这会减少您将要做的工作量。

这是一个包含随机序列生成器的 C#[数值库。](http://www.extremeoptimization.com/)只需创建一个随机数字序列，这些数字引用您的元素数组中的索引（从 1 到*x*，您的数组中的元素数）。取消引用以获取值，然后计算您的平均值和标准差。

如果您想测试数据的分布，请考虑使用[卡方拟合](http://www.itl.nist.gov/div898/handbook/eda/section3/eda35f.htm)检验或[KS](http://www.itl.nist.gov/div898/handbook/eda/section3/eda35g.htm)检验，您可以在许多电子表格和统计包（例如[R](http://www.r-project.org/)）中找到它们。这将有助于确认这种方法是否可用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-21T21:55:33.683

整数还是浮点数？

如果它们是整数，您需要通过读取数字并记录您看到的每个值的数量来累积频率分布。这可以很容易地平均。

对于浮点数，这有点问题。考虑到浮点数的整体范围和实际分布，您必须计算出一个 bin 大小，以保留您想要的精度而不保留所有数字。

* * *

**编辑**

首先，您需要对数据进行采样以获得平均值和标准差。几千点应该足够了。

然后，您需要确定一个可观的范围。人们选择平均值周围的±6σ（标准偏差）之类的东西。您将把这个范围分成尽可能多的桶。

实际上，存储桶的数量决定了平均值中的有效位数。因此，选择 10,000 或 100,000 个桶来获得 4 或 5 位数的精度。由于它是一个测量值，因此您的测量值只有两位或三位数字的可能性很大。

* * *

**编辑**

您会发现初始样本的平均值非常接近任何其他样本的平均值。并且任何样本均值都接近总体均值。您会注意到，您的大多数（但不是全部）均值彼此相差 1 个标准差。

您应该发现您的测量误差和不准确度大于您的标准偏差。

这意味着样本均值与总体均值一样有用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-21T22:00:54.063

滚动平均值会不会像其他任何东西一样准确（我的意思是不考虑舍入误差）？由于所有的划分，它可能有点慢。

您可以对一批数字进行分组并递归平均它们。就像平均 100 个数字 100 次，然后平均结果。这将减少颠簸，主要是添加。

事实上，如果您一次添加 256 或 512，您可能能够将结果移位 8 或 9，（我相信您可以通过简单地更改浮点尾数以双精度方式执行此操作）——这将使您的程序非常快，并且只需几行代码就可以递归编写（不包括尾数移位的不安全操作）。

也许除以 256 已经使用了这种优化？我可能需要加快测试除以 255 和 256 的速度，看看是否有很大的改进。我猜不是。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-21T22:09:31.830

您的意思是 32 位和 64 位数字。但是为什么不直接使用合适的 Rational Big Num 库呢？如果您有这么多数据并且想要一个精确的平均值，那么只需对其进行编码。

```
class RationalBignum {
    public Bignum Numerator { get; set; }
    public Bignum Denominator { get; set; }
}

class BigMeanr {
    public static int Main(string[] argv) {
        var sum = new RationalBignum(0);
        var n = new Bignum(0);
        using (var s = new FileStream(argv[0])) {
            using (var r = new BinaryReader(s)) {
                try {
                    while (true) {
                        var flt = r.ReadSingle();
                        rat = new RationalBignum(flt);
                        sum += rat;
                        n++;
                    }
                }
                catch (EndOfStreamException) {
                    break;
                }
            }
        }
        Console.WriteLine("The mean is: {0}", sum / n);
    }
} 
```

请记住，那里的数字类型比您的编译器提供给您的要多。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-21T22:04:56.753

您可以将数据分解为一组，例如 1000 个数字，对它们进行平均，然后对平均值进行平均。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-21T22:16:11.503

诀窍是你担心溢出。在这种情况下，这一切都归结为执行顺序。基本公式是这样的：

鉴于：

```
A = current avg
C = count of items
V = next value in the sequence

```

下一个平均值 (A [1] ) 是：

```
      (C * A) + V
A 1 = ———————————
        C + 1

```

危险是在评估序列的过程中，而`A`应该保持相对可控的 C 将变得非常大。
最终 C * A 将溢出整数或双精度类型。

我们可以尝试的一件事是像这样重写它，以减少溢出的机会：

```
A 1 = C/(C+1) * A/(C+1) + V/(C+1)

```

这样，我们就不会乘以 C * A 并且只处理较小的数字。但现在担心的是分裂行动的结果。如果 C 非常大，`C/C+1`（例如）在受限于普通浮点表示时可能没有意义。我能建议的最好的方法是在这里为 C 使用最大的类型。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-21T23:37:53.977

这是一个典型的分治型问题。

问题是一大组数字的平均值与该组前半部分的平均值相同，与该组后半部分的平均值相同。

换句话说：

```
AVG(A[1..N]) == AVG( AVG(A[1..N/2]), AVG(A[N/2..N]) ) 
```

这是一个简单的 C# 递归解决方案。它通过了我的测试，应该是完全正确的。

```
public struct SubAverage
{
    public float Average;
    public int   Count;
};

static SubAverage AverageMegaList(List<float> aList)
{
    if (aList.Count <= 500) // Brute-force average 500 numbers or less.
    {
        SubAverage avg;
        avg.Average = 0;
        avg.Count   = aList.Count;
        foreach(float f in aList)
        {
            avg.Average += f;
        }
        avg.Average /= avg.Count;
        return avg;
    }

    // For more than 500 numbers, break the list into two sub-lists.
    SubAverage subAvg_A = AverageMegaList(aList.GetRange(0, aList.Count/2));
    SubAverage subAvg_B = AverageMegaList(aList.GetRange(aList.Count/2, aList.Count-aList.Count/2));

    SubAverage finalAnswer;
    finalAnswer.Average = subAvg_A.Average * subAvg_A.Count/aList.Count + 
                          subAvg_B.Average * subAvg_B.Count/aList.Count;
    finalAnswer.Count = aList.Count;

    Console.WriteLine("The average of {0} numbers is {1}",
        finalAnswer.Count, finalAnswer.Average);
    return finalAnswer;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-21T22:08:56.853

这是用伪代码执行此操作的一种方法：

```
平均=第一
计数=1
还有更多：
  计数+=1
  diff=下一个平均值
  平均+=差异/计数
平均回报

```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-28T22:42:58.460

对不起，迟到的评论，但不是乔尔·科霍恩（Joel Coehoorn）提供的上述公式改错了吗？

我的意思是，基本公式是正确的：

> 鉴于：
> 
> A = 当前平均值 C = 项目数 V = 序列中的下一个值
> 
> 下一个平均值 (A1) 是：
> 
> A1 = ( (C * A) + V ) / ( C + 1 )

但不是：

> A1 = C/(C+1) * A/(C+1) + V/(C+1)

我们不应该有：

A1 = C/(C+1) * A + V/(C+1)

这可以解释 kasterester 的帖子：

“我的数学在这里打勾 - 你有 C，你说它“走向无穷大”，或者至少是一个非常大的数字，然后：C/(C+1) 趋向 1。A /(C+1) 趋向0\. V/(C+1) 趋向于 0。总而言之：A1 ​​= 1 * 0 + 0 所以很快 A1 趋向于 0 - 似乎有点偏离。– kastermester"

因为我们将有 A1 = 1 * A + 0，即 A1 朝向 A，这是正确的。

我长期以来一直使用这种方法计算平均值，而上述精度问题对我来说从来都不是问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-08-22T19:29:16.410

对于浮点数，问题不是溢出，而是当累积值变大时精度损失。将一个小数添加到一个巨大的累积值将导致丢失该小数的大部分位。

IEEE 浮点标准的作者本人有一个聪明的解决方案，即[Kahan 求和算法](https://en.wikipedia.org/wiki/Kahan_summation_algorithm)，它通过检查每一步的错误并保持运行补偿项来防止丢失小值，从而准确地处理此类问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T22:03:52.060

如果数字是整数，则将总数累积在一个长整数中。如果数字很长......你使用什么语言？在 Java 中，您可以在 BigInteger 中累积总数，这是一个整数，可以根据需要增长。您总是可以编写自己的类来重现此功能。它的要点只是制作一个整数数组来保存每个“大数字”。当您添加两个数字时，从低阶值开始循环。如果加法的结果设置了高位，则清除该位并将该位传送到下一列。

另一种选择是一次找到 1000 个数字的平均值。保留这些中间结果，然后在完成后将它们平均在一起。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-21T22:06:15.347

为什么浮点数之和溢出？为了实现这一点，您需要有接近最大浮点值的值，这听起来很奇怪。

如果您正在处理整数，我建议您使用 BigInteger，或者将集合分成多个子集，递归地对子集进行平均，然后对平均值进行平均。

如果你正在处理浮动，它会变得有点奇怪。滚动平均值可能变得非常不准确。我建议使用滚动平均值，该平均值仅在您遇到溢出异常或集合结束时更新。如此有效地将集合划分为非溢出集合。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-21T22:06:50.663

我的两个想法：

*   [如果数字是整数，请使用像IntX](http://codeplex.com/IntX/)这样的任意精度库——不过这可能太慢了
*   如果数字是浮点数并且您知道总数，则可以将每个条目除以该数字并将结果相加。如果你使用双精度，精度应该足够了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-03T16:27:13.173

为什么不在计算平均值之前直接缩放数字（向下）？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-01-03T18:40:18.400

**如果我要尽可能准确地**找到数十亿双打的平均值，我会采取以下方法（未测试）：

1.  找出 'M' 的上限`log2(nb_of_input_data)`。如果有数十亿的数据，50 可能是一个很好的候选者（> 1 000 0000 亿的容量）。创建一个包含 M 个双精度元素的 L1 数组。如果您不确定 M，创建可扩展列表将解决问题，但速度较慢。

2.  还创建一个关联的 L2 布尔数组（所有单元格默认设置为 false）。

3.  对于每个传入数据 D：

```
int i = 0;
double localMean = D;
while (L2[i]) {
    L2[i] = false;
    localMean = (localMean + L1[i]) / 2;
    i++;
}
L1[i] = localMean;
L2[i] = true; 
```

你的最终平均值将是：

```
double sum = 0;
double totalWeight = 0;
for (int i = 0; i < 50) {
    if (L2[i]) {
        long weight = 1 << i;
        sum += L1[i] * weight;
        totalWeight += weight;
    }
}
return sum / totalWeight; 
```

笔记：

*   该线程中提出的许多解决方案都忽略了丢失精度的问题。
*   使用二进制而不是 100-group-or-whatever 可以提供更好的精度，并且双精度可以安全地加倍或减半而不会丢失精度！

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-05-21T21:55:43.043

根据数字的范围，最好有一个数组，其中下标是您的数字，值是该数字的数量，然后您可以从中进行计算

# javascript - javascript - 查找标签的长度以及它是否为空？

> ID：895417
> 
> 赞同：2
> 
> 时间：2009-05-21T21:57:17.080
> 
> 标签：javascript

我有一个有时是空的标签。如何在客户端设置条件语句来测试这个？

我有

```
var label = document.getElementByID("<%=label1.ClientID %>").innerHTMl; 
```

获取文本，但我似乎无法弄清楚 if..else 语句是否为空。标签长度== 0；label == null 等似乎不起作用。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:02:14.357

试试这个：

```
if(label){
  // The label is defined
} 
```

如果未定义，则 if 和 else 都不会执行，所以最好不要在 this 上使用 else（看起来很奇怪，但我只是用 Firefox 进行了检查）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T22:06:12.320

这里有更好的：

```
var id = "<%= label1.ClientID %>";
var label = id.length > 0 ? document.getElementById(id).innerHTML : ""; 
```

（假设这里是 Ruby ......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:08:52.407

使用此代码：

```
 var labelID = '<%=label1.ClientID %>';
 if (labelID.length!=0)
     var label = document.getElementByID(labelID).innerHTMl;
 else... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:51:43.880

空字符串是假的，空字符串也是假的。

如果标签总是存在（document.getElementByID("<%=label1.ClientID %>") 总是返回一个 html 元素），那么上面应该可以工作。

但是，标签可能只显示为空。它里面可能有一个空白字符串。所以试试这个：

```
var label = document.getElementByID("<%=label1.ClientID %>").innerHTMl;
if (label.replace(/\s/g, '')) {
    // handle it
} 
```

# c - 我的连接函数 mystrcat(char*, char*, char*) 有什么问题？

> ID：895419
> 
> 赞同：2
> 
> 时间：2009-05-21T21:58:39.747
> 
> 标签：c, string

我最近接受了采访，被要求写`mystrcat(*s1, *s2, *s3)`where`s1`和`s2`are source 字符串，连接结果由`s3`. 有人告诉我，不要担心内存分配并`s3`假设它们不是空/无效字符串。所以我写了下面这个蹩脚（粗鲁）的程序。有人告诉我有问题，或者可能会出现问题。你能告诉它是什么/可能是什么吗？`s1``s2``s3``s3`

```
void mystrcat(char *s1, char *s2, char *s3)
{
    if (! (s1 || s2 || s3)) return; // one/more pointers are invalid

    // copy string s1 into s3
    while(*s1) {
      *s3 = *s1;
      s1++;
      s3++;
    }

    // concatenate string s2 into s3
    while(*s2) {
      *s3 = *s2;
      s2++;
      s3++;
    }

    *s3 = '\0';
} 
```

你能告诉我这里有什么问题吗？有什么更专业的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T22:07:15.233

两个可能的点

首先，您被告知输入和输出指向有效字符串，因此可以说不需要有效性测试。如果需要它，你应该大声失败。更好的是：

```
 void mystrcat(char *s1, char *s2, char *s3)
    {
        ASSERT( s1 );
        ASSERT( s2 );
        ASSERT( s3 );
        .... 
```

然后，当您可以重用它们时，您基本上编写了 strcat/strcpy：

```
void mystrcat(char *s1, char *s2, char *s3)
{
    strcpy( s3, s1 );
    strcat( s3, s2 );
} 
```

如果我面试你不是为了一个初级职位，我希望你向我指出指定的 mystrcat 界面设计得非常好，并详细说明了你将如何改进它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T22:02:46.930

```
if (! (s1 || s2 || s3) return; // one/more pointers are invalid 
```

应该

```
if ((!s1) || (!s2) || (!s3)) return; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-21T22:04:58.827

这是我的评论

*   s1 和 s2 都应该输入，`const char*`因为您无意修改它们。
*   您没有验证 s3 有足够的分配空间来包含 s1 和 s2 的组合长度
*   当用户传入错误数据（NULL 值）时，您正在默默地失败。这不好，因为调用者无法区分成功和失败的调用
*   您验证 s1、s2 和 s3 不为空的方法不正确（Igor 说得对）

我希望你在面试中问或自己回答的问题

*   我应该如何表达无法复制字符串？
*   你想要一个精确的 strcat 克隆还是一个更现代、更好的论证验证？
*   我可以使用其他标准的 str 函数来完成答案吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T22:13:16.877

除了前面的答案，还有一件可能出错的事情：s3 可能指向 s1 或 s2 字符串的中间。如果这是一个合法条件，那么您需要更复杂的实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T23:28:53.917

可以对您的函数定义提出一些批评，但在问题陈述的约束范围内，您的函数将产生正确的答案。这在技术上并没有错。

我的猜测是问题没有得到有效的沟通，或者面试官的批评没有得到有效的沟通。也许澄清这些是测试的一部分，嗯？

这是可能的投诉的快速摘要...

*   此行有一个逻辑错误...

    if (! (s1 || s2 || s3)) 返回；

*...因为如果所有*内容都为空，它将返回，但如果*有任何*为空，您可能希望返回。这不会导致失败，因为问题陈述说没有一个可以为空。

*   上面提到的同一行静默失败。最好返回错误代码、抛出异常或断言。静默失败是不好的做法，但在技术上仍然是正确的，因为在给定问题域的情况下该功能不会失败。
*   s1 和 s2 可以是 const char* 类型，以获得更好的可读性和效率（const 有助于一些编译器优化）。
*   修改参数变量通常被认为是不好的做法。另一个可读性问题。
*   您可以使用现有函数 strcpy 和 strcat。另一个可读性和效率的问题。

一个伟大的程序员应该在可读性、效率和健壮的错误处理方面超越技术正确性，但这些大多是主观的和情境的。无论如何，不​​管你的第一个 if 语句中的错误，我认为你的函数读得很好并且可以完成工作。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T00:19:58.807

1.  无效支票

    if (! (s1 || s2 || s3)) 返回；// 一个/多个指针无效

    它实际上检查是否至少一个指针不为0，例如至少一个指针是有效的。它应该是

    如果 (!s1 || !s2 || !s3) 返回；

2.  您没有检查 s3 是否足够大，或者您是否在外面写作（但假设 s3 足够大，对吗？ - 但它仍然无法在现实世界中工作）

3.  您无法跳过从 s1 末尾复制到 s3 的 null。您在 s3 中的 0 之后附加 s2 ，因此它将以“ `s1stringvalueNULLs2stringvalue`”结尾（此处的 NULL 表示实际代码中的值 0 或 null 或 nil，这是为了说明）。任何需要以 null 结尾的字符串的 C 方法都只会看到“ `s1stringvaluepart`”，并将在 null 处停止。

这是一个解决方案：

```
void mystrcat(char *s1, char *s2, char *s3)
{
    if (!s1 || !s2 || !s3) return;

    while (*s3++ = *s1++);
    if (!*(s3-1)) --s3;             // reverse over null in s1
    while (*s3++ = *s2++);

    *s3 = 0;
} 
```

您可以使用以下方法对其进行测试：

```
#include <iostream>
using namespace std;

int main()
{
    char s1[] = "short";
    char s2[] = "longer";
    char s3[20];

    memset(s3, 0, sizeof(s3));
    mystrcat(0,s2,s3);
    cout << "2: " << s3 << endl;

    memset(s3, 0, sizeof(s3));
    mystrcat(s1,0,s3);
    cout << "3: " << s3 << endl;

    memset(s3, 0, sizeof(s3));
    mystrcat(s1,s2,0);
    cout << "4: " << s3 << endl;

    memset(s3, 0, sizeof(s3));
    mystrcat(s1,s2,s3);
    cout << "1: " << s3 << endl;

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T22:16:50.707

如果我错了，请纠正我。复制s1后s3的最后一个字符不会是'\0'吗？那么在某些情况下，s2 中的剩余字符永远无法读取？

据我了解

```
while(*s3++ = *s1++); 
```

将复制字符直到达到 NULL 并且 '\0' 不是 NULL，或者它是否被视为这样？如果我可以假设 s1 = "Hello" 和 s2 = "world!" 然后在复制 s1 之后，s3 看起来像： Hello\0 然后复制“世界！” 位会导致 s3 看起来像：Hello\0 world!\0

这有什么意义吗？我的理解正确吗？

# python - 使用python开发web应用

> ID：895420
> 
> 赞同：17
> 
> 时间：2009-05-21T21:58:58.170
> 
> 标签：python

我一直在用 python 做一些工作，但这都是针对独立应用程序的。我很想知道 python 的任何分支是否支持 Web 开发？

有人还会建议一个好的教程或一个网站，我可以从中学习一些使用 python 进行 Web 开发的基础知识吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-22T11:35:19.447

既然每个人都说过[Django](http://docs.djangoproject.com/en/dev/intro/tutorial01/)，我可以补充两分：我认为在使用 Django 之前，您可以先查看不同的组件来了解更多信息。对于使用 Python 进行 Web 开发，您通常需要 3 个组件：

1.  处理 HTTP 内容的东西（例如 [CherryPy](http://www.cherrypy.org/)）

2.  用于创建网页的模板语言。 [Mako](http://www.makotemplates.org/) 非常 Python 并且[与](http://docs.cherrypy.org/stable/progguide/choosingtemplate.html)Cherrpy 一起工作。

3.  如果您从数据库中获取数据，那么 ORM 会派上用场。 [SQLAlchemy](http://www.sqlalchemy.org/) 就是一个[例子](https://bitbucket.org/Lawouach/cherrypy-recipes/src/c8290261eefb/web/database/sql_alchemy/)。

上面的所有链接都有很好的教程。对于许多现实世界的用例，Django 将是比这样的堆栈更好的解决方案，因为它无缝地集成了这个功能（以及更多）。如果你需要一个 CMS，Django 是你最好的选择，而不是 Zope。然而，为了更好地掌握正在发生的事情，一堆松散耦合的程序可能会更好。Django 隐藏了很多细节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T22:07:28.260

**3 年后编辑**：不要使用 mod_python，使用 mod_wsgi。Flask 和 Werkzeug 也是很好的框架。需要知道发生了什么是有用的，但这不是必需的。那将是愚蠢的。

在您很好地掌握 Django 代表您所做的事情之前，请不要查找 Django。为你。使用 mod_python 和它的请求对象编写一些基本的应用程序。我刚开始使用 mod_python 学习 Python 进行 Web 开发，它很棒。

mod_python 还在 site-packages/mod_python/publisher.py 中使用了一个调度程序。浏览一下，看看如何以简单的方式处理请求。

您可能需要在 Apache 配置文件中添加一些配置以启动并运行 mod_python，但 mod_python 站点对此进行了很好的解释。

```
<Directory /path/to/python/files>
     AddHandler mod_python .py
     PythonHandler mod_python.publisher
     PythonDebug On
</Directory> 
```

而你走了！

使用（作为一个愚蠢的基本示例）：

```
def foo(req):
    req.write("Hello World") 
```

`/path/to/python/files/bar.py`假设是`/path/to`您的站点根目录。

然后你可以做

```
http://www.mysite.com/python/files/bar/foo 
```

看到“你好世界”。此外，让**我感到困惑的**是调度程序使用一种蹩脚的方法来计算内容类型，因此强制使用 HTML：

```
req.content_type = 'text/html' 
```

**祝你好运**

在你对 Python 如何与 mod_python 和 Apache 交互有了一个很好的了解之后，然后使用一个框架来为你完成所有无聊的事情。由你决定，只是我的建议

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T09:14:49.543

如果你真的不想深入研究框架——你应该这样做，我衷心推荐 Django 或 Pylons——仍然需要走 CGI 的道路。这是一项完全过时的技术，更不用说缓慢和低效了。

有*一种*构建 Python Web 应用程序的标准方法，称为[WSGI](http://www.wsgi.org/)。如果您想从头开始推出自己的 Web 应用程序，这绝对是您的最佳选择。

也就是说，如果您刚刚开始，那么您真的应该使用其中一个框架。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T22:06:48.903

[Python Wiki：Python 的 Web 框架](http://wiki.python.org/moin/WebFrameworks)

如果您决定使用[Django](http://www.djangoproject.com/)，[官方教程](http://docs.djangoproject.com/en/dev/intro/tutorial01/)是一个很好的起点。[Django Book](http://www.djangobook.com/)也是免费的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T23:25:10.950

Web 开发有多种选择。根据我的经验，您的选择将再次取决于您的应用程序。我在生产中使用了[django](http://djangoproject.com)和[web.py](http://webpy.org/)，我即将部署一个基于[pylons](http://pylonshq.com/)的应用程序。

[Django](http://djangoproject.com)隐藏了很多选择（带有它的 ORM 和模板）。文档内容广泛且编写良好。django 有许多可重用的应用程序，但您可能会花一点时间来无缝集成它们。[djangocon 08 上提到的](http://www.youtube.com/watch?v=fipFKyW2FA4)一件事是，django 中有一些很酷的东西，在非 django 项目中不容易访问。

[web.py](http://webpy.org/)的原始简洁给我留下了深刻的印象。在不知不觉中，我在其中编写了一个小应用程序（[78 行 quasi-wiki](http://myyn.org/localwiki)）。

[塔](http://pylonshq.com/)感觉就像在两者的中间。我可以使用[sqlalchemy](http://www.sqlalchemy.org/)和[jinja](http://jinja.pocoo.org/2/)，总而言之，这是一个愉快的开始体验。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T22:02:33.403

查找 Django。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T22:05:45.270

Python 可用于 Web 开发，但没有特殊的语言扩展或任何可以处理所有 HTML 生成或像 PHP 一样工作的语言。

它几乎是通过 Web 服务器（CGI、mod_python 等）上的某种解释器运行的。

我建议研究[Python Web 应用程序框架](http://wiki.python.org/moin/WebFrameworks)或如何编写[Python CGI 脚本](http://wiki.python.org/moin/CgiScripts)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T22:07:25.983

那里有[很多](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks)用于 python 的 Web 框架，但我使用的唯一一个是[Django](http://www.djangoproject.com/)，我真的很喜欢它。

如果你有几个小时，做[教程](http://docs.djangoproject.com/en/dev/intro/install/)，我向你保证，你会喜欢的 :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T22:19:28.953

正如其他人所提到的，您所说的更突出的 python“分支”之一是[Django](http://www.djangoproject.com/)。它是一个相当强大的框架，可让您快速安全地构建 Web 应用程序。首先要看的是[他们的概述](http://docs.djangoproject.com/en/dev/intro/overview/#intro-overview)，它提供了一些关于 Django 作为框架的作用的见解。

通过[他们的教程](http://docs.djangoproject.com/en/dev/intro/tutorial01/)，我学到了很多关于突出的模型-视图-控制器设计模式以及如何在 Web 开发环境中使用它的知识。我发现这是开始编写一个有效的应用程序并通过改进它来学习的好方法。

# case-sensitive - 区分大小写与不区分语法

> ID：895423
> 
> 赞同：7
> 
> 时间：2009-05-21T22:00:08.463
> 
> 标签：case-sensitive

任何人都可以为区分大小写提供一个很好的案例（:-)）吗？

C#：区分大小写 VB.NET：**不**区分大小写 C++：区分大小写 ...

更糟糕的部分：在像 VB.NET 这样的语言中使用的 XML**是**区分大小写的。

我认为这是荒谬的，并且只有在我们发现系统中的错误之后才会造成伤害，因为 XML 同时具有**值**​​和**值**节点......

我在评论中被一遍又一遍地问到

> “也许你可以提出一个论点来说明为什么不区分大小写是这样一个世界中的正确选择？”

这是一个示例：我认为它类似于以下问题：URL 应该区分大小写吗？www.cnn.com <> www.cnn.com ? 当然他们应该是一样的，身份盗窃天堂！因为人类不会过多关注两个相同但可能具有不同外壳的字符串。程序员是人。所以 getAge() 和 getage() 在大多数人的心目中是一样的。

* * *

请注意：我不认为我们希望代码实际上有一个定义为 getAget() 的函数，然后有代码调用它 getage()，VS (vb.net) 会自动将 getaget 更正为 getAge。所以代码很清晰，程序员知道正确的大小写。我的观点是：好的 IDE 使问题变得无关紧要，但它在像 vb.net 这样不区分大小写的语言中效果更好，然后让我们说 c#。参考：[这里](http://www.tonymarston.net/php-mysql/case-sensitive-software-is-evil.html)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-21T22:17:20.987

案例规则取决于文化。您是否*想要*一种编程语言，其中变量`i`有时**被**认为与被调用的变量相同`I`，有时它们是不同的变量？（顺便说一句，这不是一个虚构的例子。在土耳其语中，**不是**`I`大写的.**`i`**

 **老实说，这很简单。您希望编译器在您打错字时纠正您，还是希望它猜测您的意思？正如您所发现的，后者会导致错误。VB 假定“哦，您可能是同样的意思，没关系，我们不会阻止您”，而 XML 就从字面上理解了您。

您的错误不是因为区分大小写不好而发生的，而是因为马虎是不好的。随意改变大小写最多可能不会导致问题，最坏的情况会导致错误。假设最坏的情况，并与您的情况*保持一致*。顺便说一句，这就是区分大小写的语言强迫你做的事情。无论您的工具是否区分大小写，程序员*都应该*区分大小写。只要世界具有不敏感和敏感的工具，区分大小写就会为您节省很多麻烦。如果我们可以改造这个世界，让*一切都不*区分大小写，那么很多支持区分大小写的理由就会消失。但我们不能。

当然要注意一点：在许多语言中，给变量和类型赋予相同的名称是很常见的，但大小写不同：

```
Foo foo; // declare a variable foo of type Foo 
```

当然你可以争辩说“你不应该那样做”，但它很方便，它会立即告诉读者变量的类型。它允许我们创建一个日志类和一个日志对象。而且由于这个对象的目的是记录，所以名字很明显。

最后要考虑的一点：

大小写在真实语言中很重要。以大写字母开头的单词与以小写开头的相同单词不同。“word”这个词是不正确的英文。信息被编码在案例中，这使得文本更易于阅读。例如，它会告诉我们什么时候遇到一个名字，或者一个句子什么时候开始，这很方便。允许人们忽略大小写规则会使文本更难阅读。既然代码通常应该尽可能可读，为什么我们不应该在编程中做同样的事情呢？允许案例对重要信息进行编码。在许多语言中，`Foo`是一个类型，并且`foo`是一个变量。这是重要的信息。我想在编程时知道这一点。如果我看到一个名为“Getage”的函数，我想知道这是不是我以前从未听过的英语单词。但是当我看到“GetAge”时，我立刻知道它应该被读作“Get”这个词，然后是“Age”这个词。

顺便说一句，[这里](http://www.siao2.com/2006/04/11/572838.aspx)有一个很好的例子，说明您可以在区分大小写的语言中遇到有趣的惊喜。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T22:11:44.930

Slop 在编程语言中从来都不是一个好主意。您希望事情尽可能具体。你永远不希望你的语言猜测任何事情，它应该允许尽可能少的方法来解决给定的问题。

至于具体的答案，可读性如何？stoRetroData 在视觉上与 storeTRodAtA 没有很大区别吗？并不是说有人会做这样的事情，但允许这样做有什么意义呢？

我想不出任何理由允许忽略大小写。

至少这是我的意见——但你的里程可能会有所不同。

编辑：我可能应该从免责声明开始：

大约 18 年前，我学会了基础编程，并短暂地产生了同样的想法。相信我，这是你在 20 年后回顾的那些事情之一，然后说“哦，是的，我错了”（就像我现在一样）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T22:07:33.393

1.  **历史**这是它已经完成的方式。XML 是 VB.NET 区分大小写的，因为 XML 标准要求它
2.  **国际**化 我们是否要支持所有语言（法语、日语、希伯来语、克林贡语等）的大小写？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T22:10:32.933

现在有几种区分大小写的语言是这样的，因为它们所基于的语言是区分大小写的，并且转换会更容易。就我个人而言，我更喜欢区分大小写，但 Jeff Atwood 写了[一篇很好的文章](http://www.codinghorror.com/blog/archives/000458.html)，说明为什么不再需要区分大小写。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T22:17:12.530

几个原因。

*   在不区分大小写的情况下查找东西我必须到处都有“不区分大小写”的标志。使用 UTF-8 也应该知道 Klingon smallcase..

*   更重要的是，CamelCasing，CAMelcaSing。它并不漂亮，但它被大量使用并且相当理智。不区分大小写几乎是不可能的。

*   语言奇偶校验，例如 xsd.exe（与 VS200x 一起提供）可以为您提供的 xsd 生成类。当你也有“价值”时，你的“价值”会是什么？因此，这消除了另一个可能的阻抗。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T22:19:01.640

大小写在编程语言中很好用，但与其在符号名称中使用它不如在符号名称中使用它，我们应该按照最初的意图使用它——分隔句子或命令或专有名称的开头。例如：

```
Var test = 0;
Console.writeline(test);
Test = test + 1;
Console.writeline(test); 
```

好漂亮啊。。。:P

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T22:07:18.637

我发现不区分大小写只是愚蠢的。您应该遵循原始声明的大小写。除了懒得打字`TheRealName`而不是`therealname`.

事实上，我什至不会*考虑*使用不区分大小写的语言。

# regex - 自动正则表达式生成器

> ID：895425
> 
> 赞同：3
> 
> 时间：2009-05-21T22:00:32.423
> 
> 标签：regex, algorithm

我有N个字符串。此外，还有 K 个正则表达式，我不知道。每个字符串要么匹配正则表达式之一，要么就是垃圾。集合中共有 L 个垃圾字符串。K 和 L 都是未知的。

我想推导出正则表达式。显然，这个问题有无数个解。我需要找到一个“相当好的解决方案”，

1) 最小化 K

2) 最小化 L

3) 最大化正则表达式的“细节”。我不知道用什么词来形容这种品质是不恰当的。例如，字符串“ab123”可以描述为 /ab\d+/ 或 /\w+.+/，但第一个正则表达式更“具体”。

三个要求都需要作为一个复合标准，并具有一定的合理权重。

一种特殊情况的解决方案：如果 L = 0 且 K = 1（只有一个正则表达式，没有垃圾），那么我们可以找到字符串的 LCS（最长公共子序列）并从那里得出相应的正则表达式。但是，当我们有“噪音”（L > 0）时，这种方法就行不通了。

非常感谢任何想法（或指向现有工作的指针）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T22:56:09.427

What you are trying to do is *language learning* or *language inference* with a twist: instead of **generalising** over a set of given examples (and possibly counter-examples), you wish to infer a language with a small yet **specific** grammar.

I'm not sure how much research is being done on that. However, if you are also interested in finding the minimal (= general) regular expression that accepts all *n* strings, search for papers on [MDL](http://en.wikipedia.org/wiki/Minimum_description_length) (Minimum Description Length) and [FSMs](http://en.wikipedia.org/wiki/Finite_state_machine) (Finite State Machines).

Two interesting queries at [Google Scholar](http://scholar.google.com/):

*   ["minimum description length" automata](http://scholar.google.com/scholar?hl=en&q=%22minimum+description+length%22+automata)
*   ["language inference" automata](http://scholar.google.com/scholar?hl=en&q=%22language+inference%22+automata)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T22:55:20.317

The key words in academia are "grammatical inference". Unfortunately, there aren't any efficient, general algorithms to do the sort of thing you're proposing. What's your real problem?

Edit: it sounds like you might be interested in Data Description Languages. PADS ([http://www.padsproj.org/](http://www.padsproj.org/)) is a typical example.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:46:11.537

这里没什么聪明的，也许我没有完全理解这个问题？

为什么不总是将 L 减少到 0？针对每个正则表达式检查每个字符串；如果一个字符串与任何正则表达式都不匹配，那就是垃圾。如果匹配，请记住匹配的正则表达式/字符串，并在每个 L = 0、K = 1 上执行 LCS 以推断每个正则表达式的定义。

# .net - 打印预览不显示条码

> ID：895430
> 
> 赞同：0
> 
> 时间：2009-05-21T22:00:46.590
> 
> 标签：.net, printing

当我直接写入 Windows 窗体时它看起来很好，当我从打印预览打印到打印机时它看起来很好。但是，打印预览本身不会使用条形码字体呈现条形码文本。

```
Public Class frmPrintPreview
Private Const testString1 As String = "*A1C1S1B1*"
Private Const testString2 As String = "*A99C99S7B3*"
Dim _BarcodeFont As System.Drawing.Text.PrivateFontCollection
Dim _BarcodeFont1 As Font
Dim _BarcodeFont2 As Font
Private Sub frmPrintPreview_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    _BarcodeFont = New System.Drawing.Text.PrivateFontCollection()
    _BarcodeFont.AddFontFile("FRE3OF9X.TTF")
    _BarcodeFont.AddFontFile("FREE3OF9.TTF")
    _BarcodeFont1 = New Font(Me._BarcodeFont.Families(0), 20, FontStyle.Regular, GraphicsUnit.Point)
    _BarcodeFont2 = New Font(Me._BarcodeFont.Families(1), 20, FontStyle.Regular, GraphicsUnit.Point)
End Sub

Private Sub PrintData(ByVal sender As Object, ByVal e As Printing.PrintPageEventArgs)
    DrawingRoutine(e.Graphics)
End Sub

Private Sub DrawingRoutine(ByRef g As Graphics)
    Dim PrintFont As Font
    PrintFont = New Font(Me.Font.FontFamily, 10.0, FontStyle.Regular) ', GraphicsUnit.Point)
    g.TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias
    Dim y As Int32 = 0
    g.DrawString(vbCrLf + Application.ProductName + " Version:" _
                           + Application.ProductVersion + vbCrLf _
                           + testString1, PrintFont, Brushes.Black, 0, 0)
    y += 80
    g.DrawString(testString1, Me.Font, Brushes.Black, 50, y)
    y += 40
    g.DrawString(testString1, _BarcodeFont1, Brushes.Black, 50, y)
    y += 40
    g.DrawString(testString2, Me.Font, Brushes.Black, 50, y)
    y += 40
    g.DrawString(testString2, _BarcodeFont2, Brushes.Black, 50, y)

End Sub

Private Sub btnPrint_Paint(ByVal sender As Object, ByVal e As System.Windows.Forms.PaintEventArgs) Handles Me.Paint
    DrawingRoutine(e.Graphics)
End Sub

Private Sub btnPrint_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPrint.Click
    Using printPreview As New PrintPreviewDialog()
        Dim x As New Printing.PrintDocument()
        AddHandler x.PrintPage, AddressOf PrintData
        printPreview.Document = x
        Dim result As DialogResult = printPreview.ShowDialog(Me)
        ' MsgBox(result)

    End Using
End Sub 
```

结束类

我的打印预览有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T13:31:31.287

打印机要么有字体，要么我的打印方法在我尝试打印的两台打印机的途中用它们制作了图形。一旦我将这些字体安装到我所在的计算机上，Printpreview 也可以工作。

# iphone - 视图完全加载完成后调用哪个函数？

> ID：895433
> 
> 赞同：4
> 
> 时间：2009-05-21T22:01:05.327
> 
> 标签：iphone

一旦视图（从 nib 文件加载）在 iPhone 上完全加载完毕，会调用哪个函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T01:46:51.390

`-viewDidLoad`

这与 Mac OS X 世界不同，在哪里`-awakeFromNib`可以做到这一点。

看

[是 applicationDidFinishLaunching 为 UIImageView 设置图像的错误位置吗？](https://stackoverflow.com/questions/707249/is-applicationdidfinishlaunching-the-wrong-place-for-setting-an-image-for-an-uiim/707309#707309)

# c# - 在“表”C#中查找值的有效方法

> ID：895442
> 
> 赞同：0
> 
> 时间：2009-05-21T22:03:15.150
> 
> 标签：c#, arrays, performance

我需要在“表”中查找一个值，其中表可以是一个数组或其他任何东西。
在纸上它看起来像这样（简化和概括）：

```
Size      500     750    1000    1250   1500 (speed)
--------------------------------------------
6x5       0.1     0.5     0.55   0.58   0.8
6x4       0.01    0.1     0.4    0.5    0.9
8x5       0.5     0.9     1.1    1.5    2.0
10x5      1.2     1.5     2.0    2.7    3.0
12x6      2.6     3.0     4.4    5.1    7.0  (pressure) 
```

当我的尺寸和速度可变时，我需要以某种方式提取压力。
我现在已经将每一行放在一个单独的数组中，但我想避免一堆 if else's，但我真的不知道更好的方法。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T22:22:48.993

假设您的大小和速度始终是特定值并且不在示例中指定的值之间（因此没有大小`780`或`598`例如），根据速度和大小执行查找的最快方法是使用`Dictionary<SizeAndSpeed, double>`where`SizeAndSpeed`是这样的类：

```
public class SizeAndSpeed : IEquatable<SizeAndSpeed>
{
    public string Size { get; set; }
    public int Speed { get; set; }
    public bool Equals(SizeAndSpeed other)
    {
        return Size == other.Size && Speed == other.Speed;
    }
} 
```

我假设这`Size`可以是一个`string`但当然也可以使用更复杂的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T22:14:34.113

如果大小是唯一的，请将其设置为 Dictionary 的关键，然后您可以使用它来获取其他元素...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:12:58.857

在我的脑海中，您可以使用 DataTable。

```
Size      Speed     Pressure
--------------------------------------------
6x5       500       0.1
6x5       750       0.5
6x5       1000      0.55
6x5       1250      0.58
6x5       1500      0.8
6x4       500       0.01 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:22:33.987

创建一个结构以保持大小和速度对：

```
public struct SizeSpeedKey
{
public string Size;
public int Speed;

public SizeSpeedKey(string size, int speed)
{
  Size = size;
  Speed = speed;
}
} 
```

这将是查找代码：

```
using System;
using System.Collections.Generic;

namespace LookupTable
{
  internal class Program
  {
    private static readonly Dictionary<SizeSpeedKey, double> lookupTable =
      new Dictionary<SizeSpeedKey, double>
      {
        {new SizeSpeedKey("6x5", 500), 0.1},
        {new SizeSpeedKey("6x5", 750), 0.5},
        {new SizeSpeedKey("6x4", 500), 0.01},
        {new SizeSpeedKey("6x4", 750), 0.1},
        {new SizeSpeedKey("8x5", 500), 0.5},
        {new SizeSpeedKey("8x5", 750), 0.9},
      };

    private static void Main(string[] args)
    {
      // these will of course need to be read from the user
      var size = "6x4";
      var speed = 500;

      Console.WriteLine("For size = {0} and speed = {1}, the pressure will be {2}", size, speed, lookupTable[new SizeSpeedKey(size, speed)]);
      Console.ReadLine();
    }
  }
} 
```

# java - Java 垃圾收集日志消息

> ID：895444
> 
> 赞同：98
> 
> 时间：2009-05-21T22:03:26.413
> 
> 标签：java, logging, garbage-collection

我已将 java 配置为将垃圾收集信息转储到日志中（[详细 GC](http://wiki.zimbra.com/index.php?title=When_to_Turn_On_Verbose_GC)）。我不确定日志中的垃圾收集条目是什么意思。这些条目的示例发布在下面。我在[谷歌](http://www.google.com/search?q=PSYoungGen)上四处搜索，并没有找到可靠的解释。

我有一些合理的猜测，但我正在寻找能够严格定义条目中数字含义的答案，并得到可靠来源的支持。对引用 sun 文档的所有答案自动 +1。我的问题是：

1.  PSYoungGen 指的是什么？我认为这与上一代（年轻？）有关，但究竟是什么？
2.  第二个三元组和第一个有什么区别？
3.  为什么为第一个三元组指定了名称（PSYoungGen）而不是第二个？
4.  三元组中的每个数字（内存大小）是什么意思。比如109884K->14201K(139904K)，就是GC前的内存109884k，然后降到14201K。第三个数字有什么关系？为什么我们需要第二组数字？

> 8109.128：[GC [PSYoungGen：109884K->14201K(139904K)] 691015K->595332K(1119040K)，0.0454530 秒]
> 
> 8112.111：[GC [PSYoungGen：126649K->15528K(142336K)] 707780K->605892K(1121472K)，0.0934560 秒]
> 
> 8112.802：[GC [PSYoungGen：130344K->3732K(118592K)] 720708K->607895K(1097728K)，0.0682690 秒]

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-08-19T13:39:18.143

1.  PSYoungGen 指的是用于次要收集的垃圾收集器。PS 代表并行清除。
2.  第一组数字是年轻代的前后大小，第二组数字是整个堆的。（[诊断垃圾收集问题](http://web.archive.org/web/20071011045315/http://java.sun.com/docs/hotspot/gc1.4.2/example.html)详细说明了格式）
3.  该名称表示有问题的生成和收集器，第二组用于整个堆。

关联的完整 GC 的示例还显示了用于旧代和永久代的收集器：

```
3.757: [Full GC [PSYoungGen: 2672K->0K(35584K)] 
            [ParOldGen: 3225K->5735K(43712K)] 5898K->5735K(79296K) 
            [PSPermGen: 13533K->13516K(27584K)], 0.0860402 secs] 
```

最后，分解您的示例日志输出的一行：

```
8109.128: [GC [PSYoungGen: 109884K->14201K(139904K)] 691015K->595332K(1119040K), 0.0454530 secs] 
```

*   **GC 前使用107Mb**，GC后使用**14Mb**，最大年轻代大小**137Mb**
*   **GC 前使用 675Mb 堆，GC**后使用****581Mb**堆，最大堆大小为**1Gb****
***   Minor GC 发生 在 JVM 启动后**8109.128**秒，耗时**0.04**秒**

 *** * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-05-21T22:09:43.593

大部分内容在[GC Tuning Guide](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html)中进行了解释（无论如何你都应该好好阅读）。

> 命令行选项`-verbose:gc`导致在每次收集时打印有关堆和垃圾收集的信息。例如，这里是大型服务器应用程序的输出：
> 
> ```
> [GC 325407K->83000K(776768K), 0.2300771 secs]
> [GC 325816K->83372K(776768K), 0.2454258 secs]
> [Full GC 267628K->83769K(776768K), 1.8479984 secs] 
> ```
> 
> 在这里，我们看到两个次要集合，然后是一个主要集合。箭头前后的数字（例如，`325407K->83000K`从第一行开始）分别表示垃圾回收前后活动对象的组合大小。在次要收集之后，大小包括一些垃圾（不再存在）但无法回收的对象。这些对象要么包含在永久代中，要么从永久代或永久代中引用。
> 
> 括号中的下一个数字（例如，`(776768K)`再次从第一行开始）是堆的提交大小：Java 对象可用的空间量，而无需从操作系统请求更多内存。请注意，此数字不包括幸存者空间之一，因为在任何给定时间只能使用一个，也不包括永久代，其中包含虚拟机使用的元数据。
> 
> 行中的最后一项（例如`0.2300771 secs`）表示执行收集所花费的时间；在这种情况下，大约是四分之一秒。
> 
> 第三行主要集合的格式类似。
> 
> **生成的输出格式`-verbose:gc`在未来版本中可能会发生变化。**

我不确定为什么你的里面有一个 PSYoungGen；你改变了垃圾收集器吗？

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-06-22T14:47:31.270

我只是想提一下，可以通过以下方式获取详细的 GC 日志

```
-XX:+PrintGCDetails 
```

范围。然后你会看到答案中的 PSYoungGen 或 PSPermGen 输出。

`-Xloggc:gc.log`似乎也生成相同的输出，但`-verbose:gc`您可以在第一个指定输出文件。

示例用法：

```
java -Xloggc:./memory.log -XX:+PrintGCDetails Memory 
```

为了更好地可视化数据，您可以尝试[gcviewer](http://www.tagtraum.com/gcviewer.html)（可以在[github](https://github.com/chewiebug/GCViewer/wiki)上找到更新的版本）。

注意参数写正确，我忘记了“+”，我的JBoss无法启动，没有任何错误信息！

# c# - System.IO.Exception：管道损坏

> ID：895445
> 
> 赞同：22
> 
> 时间：2009-05-21T22:03:29.673
> 
> 标签：c#, .net-3.5, named-pipes

我有两个通过命名管道相互通信的 .NET 应用程序。第一次通过一切都很好，但是在发送第一条消息之后，服务器将再次侦听，该`WaitForConnection()`方法抛出一个`System.IO.Exception`带有消息的**管道已损坏。**
为什么我在这里得到这个异常？这是我第一次使用管道，但过去对我来说类似的模式也适用于套接字。

代码啊！
服务器：

```
using System.IO.Pipes;

static void main()
{
    var pipe = new NamedPipeServerStream("pipename", PipeDirection.In);
    while (true)
    {
        pipe.Listen();
        string str = new StreamReader(pipe).ReadToEnd();
        Console.Write("{0}", str);
    }
} 
```

客户：

```
public void sendDownPipe(string str)
{
    using (var pipe = new NamedPipeClientStream(".", "pipename", PipeDirection.Out))
    {
        using (var stream = new StreamWriter(pipe))
        {
            stream.Write(str);
        }
    }
} 
```

第一次调用 sendDownPipe 让服务器打印我发送的消息就好了，但是当它循环回来再次收听时，它便便。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-21T22:49:51.420

I'll post my code that seems to work - I was curious since I never did anything with pipes. I didn't find the class you name for the server-side in the relevant namespace, so here's the code based on the **NamedPipeServerStream**. The callback stuff is just because I couldn't be bothered with two projects.

```
NamedPipeServerStream s = new NamedPipeServerStream("p", PipeDirection.In);
Action<NamedPipeServerStream> a = callBack;
a.BeginInvoke(s, ar => { }, null);
...
private void callBack(NamedPipeServerStream pipe)
{
  while (true)
  {
    pipe.WaitForConnection();
    StreamReader sr = new StreamReader(pipe);
    Console.WriteLine(sr.ReadToEnd());
    pipe.Disconnect();
  }
} 
```

And the client does this:

```
using (var pipe = new NamedPipeClientStream(".", "p", PipeDirection.Out))
using (var stream = new StreamWriter(pipe))
{
  pipe.Connect();
  stream.Write("Hello");
} 
```

I can repeat above block multiple times with the server running, no prob.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-28T15:21:54.537

在客户端断开连接后，当我从服务器调用 pipe.WaitForConnection() 时，出现了问题。解决方法是捕获 IOException 并调用 pipe.Disconnect()，然后再次调用 pipe.WaitForConnection()：

```
while (true)
{
    try
    {
        _pipeServer.WaitForConnection();
        break;
    }
    catch (IOException)
    {
        _pipeServer.Disconnect();
        continue;
    }            
 } 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2019-10-29T10:46:54.553

我遇到了同样的问题 - 这是由 Using...End Using 处理服务器的 StreamReader 引起的，这也取消了 NamedPipeServerStream。解决方案就是不要使用...结束使用它并信任垃圾收集器。

# python - Django 应用程序依赖循环

> ID：895454
> 
> 赞同：26
> 
> 时间：2009-05-21T22:05:33.677
> 
> 标签：python, django, dependencies

我正在开发一个 Django 应用程序，该应用程序具有相当复杂的模型（它为大学建模 - 课程、模块、讲座、学生等）

我已将项目分成应用程序，以使整个事情更有条理（应用程序是课程、学校、人员、模块和时间段）。我遇到了一个问题，一个应用程序中的模型可能依赖于另一个应用程序中的模型 - 所以我必须导入它。然后第二个应用程序又依赖于第一个模型中的模型，因此存在一个循环，Python 会抛出一个错误。

人们如何处理这个问题？我知道应用程序应该是相对“独立”的，但在这样的系统中，例如使用 ContentTypes 将学生链接到模块是没有意义的。

有没有人有类似的项目可以评论这个案例？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-22T09:08:17.123

如果您的依赖关系是外键引用其他应用程序中的模型，*则不需要*导入其他模型。您可以在 ForeignKey 定义中使用字符串：

```
class MyModel(models.Model):
    myfield = models.ForeignKey('myotherapp.MyOtherModel') 
```

这样就不需要导入 MyOtherModel，所以不需要循环引用。Django 在内部解析字符串，一切都按预期工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-24T10:12:36.793

这可能不太适合您的情况，但忽略您问题的 Django 方面，打破循环依赖关系的一般技术是将交叉引用的项目之一分解为新模块。例如：

```
moduleA: class1, class2
           |        ^
           v        |
moduleB: class3, class4 
```

可能变成：

```
moduleC: class 3
           ^
           |
moduleA: class 1, class 2
                     ^
                     |
moduleB:          class 4 
```

（或者，您也可以将第 2 类分解为它自己的模块。或者两者兼而有之！）

当然，如果 A 类和 B 类相互依赖，这也无济于事。在那种情况下，也许它们应该在同一个模块中，或者更好的是，也许这些类的某些部分可以分解为第三个模块，这两个类都依赖于该模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T01:58:07.563

如果您看到循环模型依赖关系，我猜测正在发生以下三件事之一：

*   您已经定义了与已经定义的反向关系（例如，两门课程都有很多讲座，而讲座有一门课程），这在 django 中是多余的
*   您在错误的应用程序中有一个模型方法
*   您在应该在管理器中的模型方法中提供功能

也许您可以向我们展示这些模型中发生了什么，我们可以尝试找出问题出现的原因。循环模型依赖性很少表明您需要组合两个应用程序 - 更有可能（尽管并非绝对如此）您的模型定义之一存在问题。

ps 我*正在*开发一个类似的 django 应用程序，但我的应用程序结构可能与您的完全不同。如果您有兴趣，我很乐意为您提供高级别的描述。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T00:56:03.473

通常我主张将功能拆分为更小的应用程序，但模型之间的循环依赖反映了如此紧密的集成，以至于您可能不会从拆分中获得太多收益，可能只是考虑合并应用程序。如果这导致应用程序感觉太大，则可能有一种方法可以沿不同的轴进行拆分，从而产生更合理的依赖关系图。

# c++ - 无法在 C 中访问#defined 常量

> ID：895458
> 
> 赞同：0
> 
> 时间：2009-05-21T22:05:58.873
> 
> 标签：c++, c, c-preprocessor

这是我正在使用的 C 程序，在头文件中我定义了一个偏移量：

```
#define LDR_DATA_PATHFILENAME_OFFSET    0x24    // MODULE_ITEM.PathFileName 
```

稍后在程序中我使用它如下：

```
pImageName = (PUNICODE_STRING)( ((DWORD)(pUserModuleListPtr)) + 
(LDR_DATA_PATHFILENAME_OFFSET-dwOffset)); 
```

检查 LDR 的值时，我得到一个**CXX0017：错误：找不到符号“LDR_DATA_PATHFILENAME_OFFSET”。** Erm，它的定义，它编译，但它无法访问该值！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T22:08:18.417

我假设您正在调试您的应用程序，因为您说“检查”：符号常量在编译时被其值替换。在运行时，您再也看不到它们了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T22:38:58.557

你确定你的头文件被包含了吗？轻松检查 - 将 #define 从头文件复制粘贴到 C 文件的开头。

仔细检查头文件中的#ifndef 保护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:23:59.663

在编译器中找到转储预处理源的选项，以便您了解实际情况。您的符号可能未定义，或者您的标头未按预期正确包含。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-21T22:37:10.340

您使用的是较旧的 C 编译器吗？您正在使用 C++ 样式注释 // 而不是 /* */ 的 C 样式注释。较旧的 C 编译器无法识别 //.

# php - 构建嵌入链接的 RSS 提要

> ID：895459
> 
> 赞同：0
> 
> 时间：2009-05-21T22:06:09.463
> 
> 标签：php, mysql, html, xml, rss

编辑：我有这一行：

```
$comments = "http://www.kiubbo.com/index.php?action=comments&param=".$articles[$index]->getId(); 
```

如果我把它放在这里，它会在标题标签中起作用，而不是在链接或 guid 标签上。

```
fwrite ($fp, "<item>\n");
fwrite ($fp, " <title>$title</title>\n");
fwrite ($fp, " <link>$comments</link>\n");
fwrite ($fp, "<guid>$comments</guid>\n");
fwrite ($fp, "</item>\n");
}
fwrite ($fp, "</channel></rss>\n");
fclose ($fp); 
```

由于某种原因，它取出了链接的“¶m”部分（$comments）。

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:37:38.120

可能是您的解析器未能正确纠正错误。例如，你还没有逃脱你的 & 符号。询问[Feed Validator](http://feedvalidator.org/check.cgi)出了什么问题。

如果要编写 XML 文件，请使用 XML 工具，不要将字符串拼凑在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T22:14:58.807

如果我正确理解了您并且您想要评论链接：

```
$comments = "YOUR_WEBSITE_HERE/index.php?action=comments&param=".$articles[$index]->getId(); 
```

您可能还应该使用`<link rel="replies"` 链接，每个人都喜欢语义！

希望有帮助，

菲尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:08:16.353

好的，我错的是我必须更改`&`为`&amp;`.

# c# - 如何将 RichTextBox 滚动到底部？

> ID：895470
> 
> 赞同：72
> 
> 时间：2009-05-21T22:07:18.573
> 
> 标签：c#, winforms, scroll, richtextbox

我需要能够将 RichTextBox 滚动到底部，即使我没有附加文本。我知道我可以附加文本，然后使用它来设置选择开始。但是，出于视觉原因，我想确保它位于底部，所以我没有添加任何文本。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-05-21T22:16:35.357

您可以尝试将 SelectionStart 属性设置为文本的长度，然后调用 ScrollToCaret 方法。

```
richTextBox.SelectionStart = richTextBox.Text.Length;
richTextBox.ScrollToCaret(); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-01-31T21:36:21.720

如果它有焦点并且你用来添加信息，`RichTextBox`它将保持滚动到最后。`AppendText`如果您设置`HideSelection`为 false，它将在失去焦点时保持其选择并保持自动滚动。

我设计了一个使用以下方法的日志查看器 GUI。它使用了一个完整的核心来跟上。摆脱此代码并将其设置`HideSelection`为 false 可使 CPU 使用率降至 1-2%。

```
//Don't use this!
richTextBox.AppendText(text);  
richTextBox.ScrollToEnd(); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-10-28T17:43:05.653

在 WPF 中，您可以使用 ScrollToEnd：

```
richTextBox.AppendText(text);  
richTextBox.ScrollToEnd(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-26T14:54:39.243

代码应该写在富文本框的 TextChanged 事件中，例如：

```
private void richTextBox_TextChanged(object sender, EventArgs e) {
       richTextBox.SelectionStart = richTextBox.Text.Length;
       richTextBox.ScrollToCaret();
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-06-07T06:29:01.400

不需要：

```
richTextBox.SelectionStart = richTextBox.Text.Length; 
```

这可以解决问题：

```
richTextBox.ScrollToCaret(); 
```

# svn - 元源代码控制？

> ID：895488
> 
> 赞同：1
> 
> 时间：2009-05-21T22:09:39.800
> 
> 标签：svn, version-control

源代码控制开发人员使用什么进行源代码控制？

subversion 的源代码是否存储在 subversion 存储库中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T22:15:58.323

我认为答案是明确的“是”。例如：

*   [颠覆源代码](http://svn.collab.net/viewvc/svn/trunk/)
*   [Git 源代码](http://git.kernel.org/?p=git/git.git;a=summary)
*   [水银源代码](http://selenic.com/repo/hg)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T23:26:28.833

如果他们不吃自己的狗粮，*就没有人*会使用他们的东西！

# .net - 如何检测应用程序关闭？

> ID：895493
> 
> 赞同：0
> 
> 时间：2009-05-21T22:10:37.240
> 
> 标签：.net, .net-3.5, appdomain

我正在服务器应用程序中构建一个组件，该组件管理我的应用程序和外部服务之间的连接。我的组件检测到服务器何时不可用，启动后台线程直到服务可用，然后重新进入“工作”状态。

我的问题是，如果调用组件的进程在该线程运行时退出，则应用程序将在线程退出之前终止。基本上，如果此服务可用，我的应用程序将无法关闭。

我的问题：有没有办法检测应用程序是否试图关闭以便任何后台线程可以退出？我注意到 AppDomain 类上有几个事件，但我不确定它们会在什么条件下以及在什么环境中被触发。

因为这是一个低级组件，我不希望它知道它运行的环境的任何信息，我也不希望更高级别的组件需要告诉它它正在关闭。

这个组件将在 WCF 服务和 Windows 服务应用程序中使用，而且我还在 WinForm 客户端应用程序中进行测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T04:03:15.217

如果您需要处理较低级别的事情，也许您需要您的组件来监视应用程序关闭事件。此代码用于监视关闭进程。（如果有人从任务管理器执行结束任务，它也会起作用。）

```
Process MyMonitoredProcess = null;
private void Form1_Load(object sender, EventArgs e) 
{
    Process[] p = Process.GetProcessesByName("processName", "machineName");
    if (p.Length > 0)
    {
        MyMonitoredProcess = p[0];
        MyMonitoredProcess.EnableRaisingEvents = true;
        MyMonitoredProcess.Exited += TestProcessEndedEvent;
    } 

}

private void TestProcessEndedEvent(object sender, System.EventArgs e)
{
    // Tasks to be done if application closes.
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:46:26.423

“因为这是一个低级组件，我不希望它知道它运行的环境的任何信息，我也不希望更高级别的组件需要告诉它它正在关闭。”

这两个要求是冲突的。要么组件必须能够知道应用程序何时关闭（在这种情况下，它必须知道它正在运行的环境），或者某个更高级别的组件（它确实知道环境）必须告诉它去关机。没有其他选择。

在我看来，组件应该尽可能少地假设它们将如何被使用。例如，它们不应假定它们将在应用程序的整个生命周期中使用，而是可以根据应用程序的需要随时启动和停止。即使事实证明组件的唯一使用方式是在应用程序的整个生命周期内使用，但这种方法会带来更简洁的设计。因此，我会说正确的方法是让应用程序在不再需要它时告诉组件，并且它应该自行终止，无论应用程序是否正在关闭。我还要说这是设计组件时的典型方法。

# iphone - 如何测试 Objective-C 中的原语是否为零？

> ID：895495
> 
> 赞同：15
> 
> 时间：2009-05-21T22:10:47.367
> 
> 标签：iphone, objective-c, primitive

我正在检查一个 iPhone 应用程序 -

```
int var;
if (var != nil) 
```

它可以工作，但在 X-Code 中，这会产生一个警告“指针和整数之间的比较”。我如何解决它？

我来自 Java 世界，我很确定上述语句在编译时会失败。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-21T22:17:19.753

基元不能`nil`。 `nil`保留用于指向 Objective-C 对象的指针。 `nil`从技术上讲，它是一种指针类型，并且在没有强制转换的情况下混合指针和整数几乎总是会导致编译器警告，但有一个例外：将整数 0 隐式转换为没有强制转换的指针是完全可以的。

如果要区分 0 和“无值”，请使用[`NSNumber`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html)类：

```
NSNumber *num = [NSNumber numberWithInt:0];
if(num == nil)  // compare against nil
    ;  // do one thing
else if([num intValue] == 0)  // compare against 0
    ;  // do another thing 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-21T22:13:12.117

```
if (var) {
    ...
} 
```

欢迎来到 C 的奇妙世界。任何不等于整数 0 或空指针的值都是 true。

**但是你有一个错误：整数不能为空。它们是值类型，就像在 Java 中一样。**

如果你想“装箱”整数，那么你需要询问它的地址：

```
int can_never_be_null = 42; // int in Java
int *can_be_null = &can_never_be_null; // Integer in Java
*can_be_null = 0; // Integer.set or whatever
can_be_null = 0;  // This is setting "the box" to null,
                  //  NOT setting the integer value 
```

# python - 从磁盘读取列表是否比加载字典更好？

> ID：895500
> 
> 赞同：2
> 
> 时间：2009-05-21T22:12:17.097
> 
> 标签：python, list, dictionary, performance

我正在构建一个应用程序，我试图允许用户提交公司和日期对的列表，并找出该日期是否有新闻事件。新闻事件以公司标识符和日期作为关键字存储在字典中。

```
newsDict('identifier','MM/DD/YYYY')=[list of news events for that date] 
```

事实证明，这本字典比我想象的要大得多——甚至无法在内存中构建它，所以我将它分成三部分，每部分仅限于特定范围的公司标识符。

我的计划是获取用户提交的列表并使用字典组公司标识符的用户列表来匹配预期会找到公司事件的特定 newsDict，然后一个接一个地加载 newsDict 以获取值。

那么现在我想知道将新闻事件保存在一个列表中是否会更好，列表的每个项目都是一个元组的子列表列表和另一个列表

```
[('identifier','MM/DD/YYYY'),[list of news events for that date]] 
```

我当时的想法是，我会有一本字典，其中包含每个公司标识符的列表范围

```
 companyDict['identifier']=(begofRangeinListforComp,endofRangeinListforComp) 
```

我会使用用户输入来查找我需要的范围，并构建一个按范围排序的标识符和范围列表。然后我只需阅读列表的适当部分以获取数据并构造输出。

我看到的最大原因是，即使将字典分成三部分，每个部分也需要大约两分钟才能加载到我的机器上，而字典最终占用了大约 600 到 750 mb 的内存。

我很惊讶地注意到，一个包含 800 万行的列表只用了大约 15 秒的时间来加载，并且使用了包含 1/3 条目的字典的大约 1/3 的内存。

此外，由于我可以在处理列表时丢弃列表中的行，因此我将在处理用户列表时释放内存。

我很惊讶，因为我认为字典是最有效的方法。但我对它的研究表明，字典需要比列表更多的内存。我对 SO 和其他地方的其他帖子的阅读表明，任何其他结构都将需要比列表指针更昂贵的指针分配。我在这里遗漏了什么吗？有没有更好的方法来做到这一点？

在阅读了 Alberto 的回答和对我的评论的回复后，我花了一些时间试图弄清楚如果我要使用数据库如何编写函数。现在我可能在这里步履蹒跚，因为我对数据库编程知之甚少，但是

我认为使用数据库实现的代码比：

```
outList=[]
massiveFile=open('theFile','r')
for identifier in sortedUserList
# I get the list and sort it by the key of the dictionary 
    identifierList=massiveFile[theDict[identifier]['beginPosit']:theDict[identifier]['endPosit']+1]
    for item in identifierList:
        if item.startswith(manipulation of the identifier)
        outList.append(item) 
```

我必须将它包装在一个函数中，如果我将列表转换为数据库，我看不到任何相对简单的东西。

当然，简单并不是带我来这个论坛的原因。我仍然没有看到使用另一种结构会消耗更少的内存。我有 30000 个公司标识符和大约 3600 个日期。我列表中的每个项目都是 OOD 术语中的一个对象。这就是我苦苦挣扎的地方，今天早上我花了六个小时整理字典的数据，然后我放弃了。花那么多时间来实现一个数据库，然后发现我使用了一半或更多的其他人的内存来加载它似乎有问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T22:18:34.900

有这么大量的数据，你应该使用数据库。这比查看列表要好得多，并且无论如何都是存储数据的最合适方式。如果您使用的是 Python，我相信它内置了 SQLite。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T02:15:54.813

字典将占用更多内存，因为它实际上是一个散列。

您不必使用数据库，因为您的查找要求非常简单。只需使用文件系统。

根据公司名称（或股票代码）创建目录结构，每个日期都有子目录。要查找数据是否存在并加载它，只需形成数据所在的子目录的名称，然后查看它是否存在。

例如，5 月 21 日的 IBM 新闻将在 C:\db\IBM\20090521\news.txt 中，如果事实上那天有新闻的话。您只需检查文件是否存在；没有搜索。

如果您想尝试从那里提高速度，请提出一个方案来缓存可能经常请求的有限数量的结果（假设您正在操作服务器）。为此，您将使用哈希。

# math - 使用 FIND 命令联合、交叉和排除？

> ID：895501
> 
> 赞同：-1
> 
> 时间：2009-05-21T22:12:26.097
> 
> 标签：math, list, find

我需要使用 find-command 管理列表。假设列表在非不同列表中具有随机名称（即它们的交集不是空集）。我能怎么做：

**甲\乙**

> 查找列表 A 中的文件，但列表 B 中的文件除外

**A 路口 B**

> 查找列表 A 和 B 共有的文件

请[在这里咨询。](https://stackoverflow.com/questions/895743/how-does-the-and-operator-work-in-the-find-command)

**A 联合 B**

> 查找两个列表中的所有文件

**例子**

```
$ find . | awk -F"/" '{ print $2 }'

.zcompdump
.zshrc
.bashrc
.emacs

$ find ~/bin/FilesDvorak/.* -maxdepth 0 | awk -F"/" '{ print $6 }'

.bashrc
.emacs
.gdbinit
.git 
```

我想：

**甲\乙**：

```
.zcompdump
.zshrc 
```

**A 交叉口 B** :

```
.bashrc
.emacs 
```

**A 联合 B**：

```
.zcompdump
.zshrc
.bashrc
.emacs
.bashrc
.emacs
.gdbinit
.git 
```

**十字路口的尝试**

当我将输出保存到单独的列表中时，我无法理解为什么该命令不采用常见的东西，即上面的交集：

```
find -f all_files -and -f right_files . 
```

**从问题中出现了问题：**

1.  找到 ~/bin/FilesDvorak/.* -maxdepth 0 -and ~/.PAST_RC_files/.*

2.  请咨询递归查找 点击这里！

3.  找到 ~/bin/FilesDvorak/.* -maxdepth 0 -并列出

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T23:29:23.667

说真的，这就是 comm(1) 的用途。我认为手册页不会更清晰： http: [//linux.die.net/man/1/comm](http://linux.die.net/man/1/comm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T02:06:27.420

有几种工具可以帮助您在文件列表中找到交集。“发现”不是其中之一。Find 用于在文件系统上查找与特定条件匹配的文件。

这里有一些方法可以找到你的答案。

生成两个文件列表

```
find . -maxdepth 1 | sort > a
(cd ~/bin/FilesDvorak/; find . -maxdepth 1 | sort > b) 
```

现在您有两个文件 a 和 b 包含目录条目，而不递归到子目录。（要删除前导 ./ 您可以在查找排序之间添加“sed -e 's/^.///'”或您的第一个 awk 命令）

寻找联盟

```
cat a b | sort -u 
```

找到 A\B

```
comm -23 a b 
```

寻找交叉点

```
comm -12 a b 
```

'man comm' 和 'man find' 了解更多信息。

# .net - Excel 2003 ActionsPane 中的 AutoSize ElementHost

> ID：895507
> 
> 赞同：2
> 
> 时间：2009-05-21T22:13:50.760
> 
> 标签：.net, wpf, winforms, excel, vsto

我在 Excel 2003 ActionsPane 中托管 WPF 图表。图表设置为水平和垂直拉伸，但是，虽然 ElementHost 和图表水平填充 ActionsPane，但我还没有找到一种方法使 ElementHost 垂直填充。似乎对 ElementHost 的布局有任何影响的唯一属性是 Height 和 Size 属性。Anchor、Dock、AutoSize 似乎不会影响 ActionsPane 对象或 ElementHost 对象上的布局。

我错过了什么吗？

问候，

丹尼

```
// A snippet from ThisWorkbook.cs
public partial class ThisWorkbook
{
    private void ThisWorkbook_Startup(object sender, System.EventArgs e)
    {

        var ap = Globals.ThisWorkbook.ActionsPane;
        ap.Clear();
        ap.Visible = true;
        var plotControl1 = new Swordfish.WPF.Charts.TestPage();
        var elementHost1 = new System.Windows.Forms.Integration.ElementHost();
        elementHost1.AutoSize = true; // Doesn't seem to have an effect.
        elementHost1.Child = plotControl1;

        ap.Controls.Add(elementHost1);

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-04T20:48:38.880

创建一个名为我的 ActionPane 的自定义 WPF 表单并将其托管在 ElementHost 中。下面是我如何做 ElementHost 本身：

```
private void ThisDocument_Startup(object sender, System.EventArgs e)
    {
        ActionPane actionPaneControl = new ActionPane();
        this.ActionsPane.Resize += new EventHandler(ActionsPane_Resize);
        this.ActionsPane.Controls.Add(new ElementHost { Child = actionPaneControl, AutoSize = true });
    } 
```

基本上我订阅了 ActionsPane Resize 事件并以此为基础调整 ElementHost 对象的大小。这提供了 WPF 控制（具有垂直和水平拉伸）与 Office 应用程序窗口一起调整大小的额外好处

```
void ActionsPane_Resize(object sender, EventArgs e)
    {
        ((this.ActionsPane.Controls[0] as ElementHost).Child as ActionPane).Height = this.ActionsPane.Height;
    } 
```

# java - Java 语言环境字体问题..？

> ID：895517
> 
> 赞同：3
> 
> 时间：2009-05-21T22:16:41.237
> 
> 标签：java, fonts, locale

[编辑] 这发生在带有 Java 1.5 的 OSX 上！（但也可能发生在 Windows 上！）

我的 Java Swing 程序的日语用户似乎无法在 JTextFields 中编写日语符号。实际上他们可以写它们但看不到它们。他们只看到以某种方式表明我认为字体不支持这些符号的块。

我出于各种原因设置了自己的字体（“Lucida Sans”，Font.PLAIN，12）——我不想改变。我的问题是：

1.  如果我不设置此字体，JTextFields 会显示日文符号吗？

2.  我是否可以检测到我的字体完全支持哪些语言环境并仅在这些情况下设置它，但为所有其他情况（如 Locale.Japan）保留标准 Java 字体？

3.  你有什么其他的建议？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T22:48:40.173

> *would the JTextFields show japanese Symbols without me setting this Font?*

Most likely since the JRE will choose the default.

> *could I detect which Locale's are fully supported by my Font and only set it in those cases but leave the standard Java font for all other cases like Locale.Japan?*

Yes, in theory, although easier would be to test if this font can display a locale specific character using the the [canDisplay(char)](http://java.sun.com/javase/6/docs/api/java/awt/Font.html#canDisplay(char)) method in Font. If it don't, you may switch to the default.

> *do you have any other suggestions?*

[Here's a link on this topic that may help](http://java.sun.com/javase/technologies/core/basic/intl/faq.jsp#desktop-rendering)

Do you have a link for your product?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T22:26:16.490

正是出于这个原因，我的国际化应用程序根据语言环境设置其字体。要回答您的问题：

1.  这可能取决于所使用的 Windows 版本。这是安装了日文字体的美国版，还是在日本销售的版本？我不知道你的问题的确切答案，但我希望答案是，“这取决于。”

2.  我不知道有任何标准方法可以做到这一点。我发现了一个很好的工具来调查这种事情： [BabelMap](http://www.babelstone.co.uk/Software/BabelMap.html)。这将准确地告诉您任何给定字体都支持哪些字符。

3.  其他建议：根据区域设置设置字体，至少对于选择区域设置。

# javascript - 更改标签 javascript firefox 扩展的 url

> ID：895523
> 
> 赞同：1
> 
> 时间：2009-05-21T22:17:25.933
> 
> 标签：javascript, firefox, url, firefox-addon, tabbed

我正在尝试更改 javascript firefox 扩展中当前打开的选项卡的 url

请问有什么指点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T02:04:14.430

我相信它是“gbrowser.loadURI()”。尝试阅读MDC 上有关与全局变量 gBrowser 交互的页面，以及[有关](https://developer.mozilla.org/En/Code_snippets/Tabbed_browser)loadURI 方法的页面[。](https://developer.mozilla.org/En/XUL:Method:loadURI)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-02T18:17:15.913

TML 提到的 mozilla[文档](https://developer.mozilla.org/en/Code_snippets/Tabbed_browser)在“按其他标准重用”下有示例代码，但它已损坏。相应的[讨论页](https://developer.mozilla.org/Talk:en/Code_snippets/Tabbed_browser)说要添加这一行来修复它：

```
tabbrowser.loadURI(url, tabbrowser.currentURI, "UTF-8"); 
```

但是，如果您已经获得了选项卡对象（例如之前调用 addTab ），那么我认为这样做更简单：

```
gBrowser.selectedTab = mytab;
gBrowser.loadURI(myurl); 
```

我看不到任何方法可以更改未选中的选项卡的 URL，但这会很好 - 我讨厌窃取焦点。

更新：这是不选择选项卡的方法。简单的：

```
gBrowser.getBrowserForTab(mytab).loadURI(myurl); 
```

# .net - 还有人后悔使用实体框架吗？

> ID：895527
> 
> 赞同：20
> 
> 时间：2009-05-21T22:18:30.220
> 
> 标签：.net, linq-to-sql, entity-framework

我有一个实现 Linq To SQL 的项目，我对此非常满意。很长一段时间里，最大的问题就是设计师有问题。

可惜我的项目现在需要多表继承，而Linq to SQL不支持。当我了解到实体框架确实支持多重继承并且似乎是微软的发展方向时，我决定切换到实体框架。但现在我开始后悔这个决定了。

例如，调用 Load()? 怎么回事？如果我不想要这些数据，我就不会要求它！弄清楚 Entity Framework 的所有肛门怪癖正在成为我身边的一根巨大的刺。

无论如何……隧道尽头有灯吗？当我全部完成后，使用 EF 是否值得，还是我做出了一个糟糕的决定？

最后，我想问一下：微软在整个 ORM 方面的进展如何？多年来，Rails 的 ActiveRecord 一直运行良好且简单。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-21T23:40:40.850

你并不孤单。ADO.NET 博客上有[一系列文章](http://blogs.msdn.com/adonet/)讨论了 .NET 4.0 中对实体框架所做的增强。它们似乎非常重要，但它们是否足以满足您的需求，只有您可以判断。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T23:08:25.283

嗯，[VS2010 beta 已经上线](http://blogs.msdn.com/somasegar/archive/2009/05/18/visual-studio-2010-and-net-fx-4-beta-1-ships.aspx)了；您可以启动虚拟机并查看 4.0 中的 EF 是否更适合您？

就个人而言，我现在坚持使用 LINQ-to-SQL，但可能是因为我还不需要任何其他功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T15:41:52.487

我实际上期待在其 v4 版本中使用 Entity Framework，希望 Real Soon Now。诚然，在我们的例子中，它伴随着摆脱了一个不再受支持的糟糕的内部 ORM，这比瘟疫还要糟糕——所以 EF v4 对我来说就像是天赐良机！:-)

马克

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T18:14:02.273

我对 EF v1.0 感到非常失望。它承诺了很多，但实际上它非常严格，性能很糟糕，并且不支持现有的应用程序和基础设施。

也就是说，EF v2.0 看起来很有前途。微软向大众开放了设计过程，让我们这些希望看到 EF 成功的人，看看它是否适合各种各样的使用场景，它确实应该提供我们的建议、建议和意见。

如果您有兴趣查看这项工作的结果，或者想提供您自己的意见，您应该查看 EF 设计博客，此处：http: [//blogs.msdn.com/efdesign/](http://blogs.msdn.com/efdesign/)

最后，如果微软仍然无法生产适合各种场景的灵活 ORM，那么 NHibernate 总是存在的。我使用 LINQ to SQL、Entity Framework 和 NHibernate 有一段时间了，在这三个框架中，NHibernate 是最友好、灵活和成熟的框架。它对视觉设计师的影响不大，但如果您对 EF 的局限性、怪癖、奇怪的行为和糟糕的性能感到沮丧，NHibernate 是一个很好的选择。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-07T06:20:44.487

I absolutely agree. Lazy loading is what killed the entity framework for me. It just opens a can of worms with attaching and detaching entities to the context instance. I really don't want to worry about these things. But then who hasn't worked with a half-assed product from Microsoft before :) I'm glad they're going to be patching things up in a new release. Until then L2S seems like your best bet.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T15:32:41.150

跟进：

我暂时放弃了实体框架。代码重写一直在转化，我对结果一点也不满意……很大程度上是由于缺乏延迟加载支持。

我决定现在回到 Linq to SQL 并尝试单表继承。我们的子类型并不多，所以就目前而言，它应该是一个丑陋但可以接受的解决方案。当新版本的 VS 和 Entity Framework 发布时，我会考虑再次切换，因为新版本的更改看起来很有希望。

# java - 在 Mac 和 Windows 上从 swing 打印 - postscript 支持在哪里？

> ID：895530
> 
> 赞同：1
> 
> 时间：2009-05-21T22:19:01.297
> 
> 标签：java, windows, swing, printing, postscript

我正在通过机场将复杂的 Swing 应用程序 UI 打印到物理打印机。我有 Mac 和 Windows 机器都打印到同一台打印机。从 Mac 打印看起来很棒。从 Windows 打印看起来远非很好 - 一切都非常像素化，包括字体和图形线。

一些挖掘发现可用的 PrintServices 对于不同的平台是不同的。

```
DocFlavor flavor = DocFlavor.INPUT_STREAM.POSTSCRIPT;
PrintRequestAttributeSet attrs = new HashPrintRequestAttributeSet();
PrintServiceLookup.lookupPrintServices(flavor, attrs); 
```

当从 mac 执行时，上面返回一个单元素数组。从 Windows 中，它返回一个空数组。这让我相信 Windows 正在向打印机发送 72 DPI 图像，而不是 postscript 数据。

这是 mac 和 windows JVM 实现的区别吗？是否有任何解决方法可以在 Windows 上进行打印？我意识到我可以生成自己的 350dpi 光栅化图像并将其发送到打印机，但是这些东西会进入数百页，如果可能的话，我真的很想避免这条路线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:44:29.933

我想我得到了答案：`java.awt.printerjob`系统属性设置为`sun.awt.windows.WPrinterJob`. 如果您喜欢打印机上的块状像素化输出，显然这是一个方便的 PrinterJob 子类。相反，我得到一个`sun.print.PSPrinterJob`它是否可用的实例，如下所示：

```
PrinterJob printerJob = null;
try {
    if (System.getProperty("java.awt.printerjob").equals("sun.awt.windows.WPrinterJob")) {
        // WPrinterJob sends crappy GIF images to the printer, and everything looks all blocky
        // try to get an instance of a PSPrinterJob instead
        printerJob = (PrinterJob) Class.forName("sun.print.PSPrinterJob").newInstance();
    }
} catch (Throwable e1) {
    log.log(Level.SEVERE, "Could not instaniate sun.print.PSPrinterJob", e1);
}
if (printerJob == null) {
      printerJob = PrinterJob.getPrinterJob();
} 
```

# c# - 将字符串转换为未知数字类型的正确方法是什么？

> ID：895535
> 
> 赞同：0
> 
> 时间：2009-05-21T22:20:21.387
> 
> 标签：c#, reflection, parsing

我正在创建一个用于内部库的类型转换器，该库应该能够从数据库返回的**任何**类型（long、DBNull、bool、string 等）转换为任何*兼容*的类型。

对于可以铸造的物品，这一切都很好用：

```
try { return (T)value } catch(InvalidCaseException) { } 
```

或者可以解析：

请参阅[使用反射从字符串转换为 Nullable<T>](https://stackoverflow.com/questions/894640/convert-to-a-nullablet-from-a-string-using-reflection)

但是，当我想要这种期望的行为时，我正在碰壁：

```
Assert.That(
    2,
Is.EqualTo(
    Converter<long>.Convert("2.1")
)); 
```

问题是 Pasre 和 TryParse 函数将其作为无效格式返回，而真正想要的结果是截断小数。

您认为使用*反射将“2.1”之类的字符串解析为**未知值类型*的最佳方法是什么？

 *编辑：目前我正在使用：

```
if (Nullable.GetUnderlyingType(t) != null)
{
    t = Nullable.GetUnderlyingType(t);
}

MethodInfo parse = t.GetMethod("Parse", new Type[] { typeof(string) });

if (parse != null)
{
    object parsed = parse.Invoke(null, new object[] { value.ToString() });
    return (T)parsed;
}
else
{
    throw new InvalidOperationException("The value you specified is not a valid " + typeof(T).ToString());
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T23:00:37.233

什么版本的 .NET，什么范围的值？例如，一种选择是将其解析为小数并从那里转换...

```
T val = Convert.ChangeType(decimal.Parse("2.1"), typeof(T)) 
```

（上面只显示了中央转换 - 它不会尝试将其放入您现有的代码中）

这不适用于巨大/非常小的值，但可能不会遇到与`double`.

# javascript - 使用 jquery 检查正文中是否有任何文本节点

> ID：895537
> 
> 赞同：1
> 
> 时间：2009-05-21T22:20:42.523
> 
> 标签：javascript, jquery, dom

我需要以某种快速的方式检查页面上是否有***任何***文本节点，不包括空格。最好，我想看看是否有办法用 jQuery 做到这一点，并且可以跨浏览器。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T22:22:55.187

```
if( $.trim($("body").text()).length > 0 ){
  ...
} 
```

或者，如果您想排除所有空格...

```
$("body").text().replace(/\s/g,'').length > 0 ){ 
```

# svn - 使用 VCS 会帮助我作为 Web 开发人员吗？

> ID：895541
> 
> 赞同：4
> 
> 时间：2009-05-21T22:22:03.490
> 
> 标签：svn, version-control

我正在考虑尝试使用诸如[subversion](http://subversion.tigris.org/)之类的 VCS来管理我的下一个项目，但我不确定是否会为我作为 Web 开发人员提供任何真正的好处。据我了解，VCS 的主要好处之一是一群人可以同时处理一个项目。

[关于这个主题的阅读材料](http://www.relisoft.com/co_op/whyvcs.html)似乎[很片面](http://www.onlamp.com/pub/a/onlamp/2004/01/29/scm_overview.html)：

> “对于几百行代码以上项目的开发人员来说，使用版本控制系统是绝对必须的”

...而且我有一种感觉，这可能会成为一件苦差事，没有太多好处。

我在本地网络上的开发服务器上工作，所以任何数量的人都可以处理这些文件。如果有人需要远程进入，他们使用 FTP。在此之上，现代版本控制系统会给我什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-21T22:33:32.717

在您的情况下，它可以为您带来至少四个额外的好处：

**1)**它将作为**额外的备份存储**。
**2）**如果您不小心添加了错误，您可以**轻松返回之前的稳定版本**。
**3)**如果您不小心添加了错误或破坏了某些东西 - 您可以看到当前源代码和上次提交的源代码之间的差异 - VCS 将以非常合适和示范的方式向您展示差异 - 您会**很容易找到改变导致错误**或问题。这个非常有用。
**4）**您可以**在提交之前轻松查看您的修改**. 相信我，你会感到惊讶 :) 有时你只是自动做某事，没有太多思考，或者你可能会累。在这种情况下，**如果您**稍后查看您的修改 -**您可能会发现错误或错误代码**。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T22:45:53.673

在我看来，VCS 系统在 Web 环境中更加有用，因为“任何人”都可以轻松地编辑站点。

我做过的每一个网络项目都有“厨房里的厨师太多”综合症的困扰，最终有人去添加一个小功能，然后你回过头去看，发现他们最终重写了一大块该网站并打破了其他东西。在 VCS 中拥有一堆版本可以让您尽可能轻松地解决这些类型的错误。

此外，VCS 使 Web 应用程序的部署变得轻而易举。像这样标记 VCS 中所有页面的生产版本，然后检查到 Web 服务器。比一个拥有已更改文件列表和 FTP 客户端的人的“传统”方法要好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T09:09:24.013

我发现源代码控制的另一个好处是它可以帮助您更有条理。在使用 SCM 之前，我会四处进行一些小的更改。有了 SCM 和对明智签到的需求，我在编写内容时变得更加考虑和结构化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T18:20:41.313

我在这方面迟到了，但只想在 nightcoder 开始的列表中添加一些项目符号：这些是 SVN 使我受益的方式。

***Nightcoder 写道：***

1) ...备份存储。

2) ...返回之前的稳定版本。

3) ...查看您当前的源代码和上次提交的源代码之间的差异......

***此外：***

4) 从 SVN 日志中的一条简短评论，您可以看到谁提交了更改、何时以及为什么。

*   无需筛选代码中的注释（除非您愿意）。
*   这是为什么？因为每次提交时，都会要求您评论更改。那个沉默寡言的评论被记录下来。

5) 添加（由您选择）到文件本身的“$id$”是一个很棒的参考点。

*   它是否与您桌面上的版本的 id 匹配？
    *   不再需要对两个（或 3 个或 4 个！）同名文件进行差异检查。
*   它是否与您在不同服务器/不同域上运行的同名文件的 id 匹配？
    *   不？然后一个服务器/域没有使用最新版本 - 修复它。
*   $id$ 在 x/html 文档元标记中提供了方便的“版本”引用。

6) 不再需要筛选带有日期标记的备份来查找工作副本（另请参见 2）。

7) 将您的代码轻松添加到 Google 代码中，以便与世界分享或从他人那里获得帮助。

*   Google 代码目前使用 SVN。

8）正如其他人所说，组织，组织，组织。

*   在使用 SVN 之前，我认为自己组织得很好。我错了。

9) 在多用户环境中，当前版本的同步非常简单。

*   这种内置的同步系统可能是组织在多开发人员环境中对这种系统发誓的主要原因。

***缺点：***

*   除非您以终端语言为导向，否则学习曲线可能相当陡峭。术语不像 Perl/Java/PHP/等。
*   初始设置可能会令人困惑。阅读和遵循指示是必不可少的。

总体而言，非常值得您花费一周时间来设置和学习系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T22:32:40.300

即使您独自工作，版本控制系统也是必须的，因为它允许您保留更改的历史记录 - 这反过来又使您可以自由地进行试验，因为您知道您总是可以回到以前的工作版本.

我现在甚至对少于 100 行的“测试”项目也使用 subversion。你永远不会知道 ：）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T20:00:30.850

另一个原因：工作环境之间的共享。

我不仅将 svn 用于我的重要项目，还用于一次性沙箱脚本（我是唯一的编码器）。对于项目，我有不同的存储库，然后是“沙盒”存储库。所有的一次性代码都在那里。

这样做的原因是，我从不同的地方编辑代码 - 工作和家庭 - 它使共享变得容易。没有通过档案发送电子邮件或将它们加载到某个地方。在工作中，我只是承诺，回家，更新并继续。对于重要的项目，您不应该这样做（仅提交工作脚本）。如果我在一天结束时忘记提交，我至少可以处理代码，然后在第二天将编辑合并在一起。

我这样做不仅是为了代码，而且是为了对我很重要的各种（小）文件。如果我在某个我引以为豪的地方写了评论，但我知道一周后就会被遗忘，我会在沙箱中保存一份副本（类似于共享的“我的文档”）——出于怀旧的原因。故事、头脑风暴、想法、待办事项列表等也是如此。

vcs 还有很多其他优点：

*   从任何地方快速**访问**您的东西（如果它是公共服务器）。如果你只需要阅读代码，浏览器就足够了（如果服务器支持的话）。
*   **在服务器上托管**。我个人电脑中的所有磁盘迟早都会死掉，通常会带上数年的脚本。是的，我敢肯定，在地窖的某个地方有 cd 或 zip 磁盘上的备份，我也确定我再也找不到它们了（*另外，我不再拥有 zip 驱动器，而且你知道它的使用寿命cds ...* )。cvs 服务器都有raid、专业管理员、备份……如果公司倒闭，你至少在本地有一份代码副本。
*   您可以在提交时**运行自动化脚本。**我从来没有用过这么强硬的。
*   **保持代码库正常工作**。您的应用程序有 3 个副本：本地、存储库和网络服务器。如果您在轮班结束时没有完成工作，请不要提交，因此存储库不包含损坏的代码。如果您进行了所有更改和测试，请将它们导出到网络服务器。这样，（在一个完美的世界中）网络服务器永远不会托管损坏的代码。
*   **授予/撤销其他人的访问权限**。您也可以使用 ftp 执行此操作，但这样更容易跟踪他们所做的更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-29T07:12:17.503

您可以在新分支上尝试新功能，如果它没有按预期工作，您可以丢弃测试分支并恢复到原始工作分支，这对于编码人员来说非常方便。

# svn - Subversion：仅在一个客户端上忽略对本地文件的修改

> ID：895548
> 
> 赞同：54
> 
> 时间：2009-05-21T22:23:48.680
> 
> 标签：svn, ignore

是否可以仅在一个客户端本地忽略对 subversion 中文件的更改，而不将忽略传播到整个存储库？

我正在处理的特殊问题是我已经检查了一个项目并修改了一堆文件，包括 Makefile，它已经是存储库的一部分。现在我正在处理的环境与该组的其他人不同，我希望对 Makefile 的更改在我的机器上保持本地而不是提交。

但是，我不想设置 svn:ignore 因为我相信会将忽略提交到存储库，而将 make 文件保留在那里很重要。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-08-17T18:14:51.017

与 svn 的许多方面一样，乌龟使它变得非常容易。事实上，我相信乌龟实际上是通过系统地使用现有的 svn 特性来添加特性的。我意识到这个答案只是 windows，但也许有些人像我一样仍然使用 windows。在“检查修改”弹出窗口中，只需右键单击您的文件并选择“移动到更改列表”->“忽略提交”。现在，当您使用 tortoise 签入时，它会将您的更改分割到各种更改列表中，因此至少您可以直观地分辨出您要提交的内容和不想提交的内容。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-22T03:37:52.053

如果您使用 Subversion 1.5.x 或更高版本，您可以使用更改列表：

```
svn cl COMMIT /path/to/project/*

svn cl NOT_COMMIT /path/to/project/Makefile 
```

注意：使用第二个命令*Makefile*将从第一个更改列表中删除。您可以忽略警告。

不要提交第二个更改列表。

通过以下方式提交：

```
svn ci --cl COMMIT -m"<LOG MESSAGE HERE>" 
```

**重要提示：** 如果您在没有 --cl 选项的情况下提交，您的所有更改都将被提交

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:57:33.823

The closest safe solution I can think of is to use a personal branch.

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-05-21T22:26:41.997

用于`svn export`导出文件，使其不受版本控制。

[http://svnbook.red-bean.com/en/1.0/re10.html](http://svnbook.red-bean.com/en/1.0/re10.html)

编辑：但是我相信这必须在每个目录的基础上完成，所以你必须重新组织你的文件。

我目前无法对此进行测试，但是稀疏的结帐对您有帮助吗？

[http://svnbook.red-bean.com/nightly/en/svn.advanced.sparsedirs.html](http://svnbook.red-bean.com/nightly/en/svn.advanced.sparsedirs.html)

# javascript - SpiderMonkey vs JavaScriptCore vs?

> ID：895554
> 
> 赞同：7
> 
> 时间：2009-05-21T22:24:37.603
> 
> 标签：javascript, c++, embedded-language, spidermonkey

我有一个 C++ 桌面应用程序（用 wxWidgets 编写），我想添加对某些脚本语言的支持。

脚本主要用于用户提供的 JavaScript 代码对字符串、数字和日期的运行时转换。

我想使用 JavaScript，因为它被广泛使用并且每个人都熟悉它的语法。

谷歌搜索，似乎我有两个选择：

*   来自 Mozilla 的 SpiderMonkey
*   来自 WebKit 的 JavaScriptCore

有没有人试过这些？哪一个更容易设置？你知道其他一些更适合我需要的实现吗？

顺便说一句，我的目标是 Windows 和 Linux 平台。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-30T06:04:33.107

还有谷歌的 V8 JavaScript 引擎，在 Linux 上构建得很好，嵌入 API 似乎也很简单：（与 SpiderMonkey 的相比，从未看过 JavaScriptCore API） [http://code.google.com/apis/v8/get_started.html](http://code.google.com/apis/v8/get_started.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T22:50:48.983

当然，你也可以使用[Lua](http://lua.org)，它不仅是专门为此设计的，而且比任何 JS 都要快得多。

此外，它具有精心设计的语义、极小的核心、简单的 C API、出色的可移植性、非常成熟的[JIT](http://luajit.org)、我见过的最有用的在线社区等等......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T22:49:50.080

JavaScriptCore 具有稳定的 C API（和 ABI），并且已在 macos 上可用（并用作）标准系统框架。

[编辑：哦，它作为一个独立的库在 linux 和 windows 上工作，虽然我相信只有 debian 这样分发它]

# c# - 带有 ASP.NET MVC 的实体框架

> ID：895564
> 
> 赞同：4
> 
> 时间：2009-05-21T22:26:31.700
> 
> 标签：c#, .net, asp.net, asp.net-mvc, entity-framework

如何将强类型控制器与 EntityObjects 一起使用？

我的失败...

首先我尝试了这个：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

这未能实际保存对数据库的任何更改。因此，我尝试将模型附加到我的 ObjectContext：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    db.Attach(Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

这失败了，因为“无法将具有空 EntityKey 值的对象附加到对象上下文。” 所以，我尝试分配EntityKey：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    Model.EntityKey = (from Department d in db.Department
                       where d.Id == id
                       select d).FirstOrDefault().EntityKey;
    db.Attach(Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

失败是因为“ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象。”

这应该如何工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T22:56:37.990

The thing is, what you have as your input is not a complete model object with changed properites - it is just a "start" of new one, with all the properties that you want to overwrite on an already existing entity. You don't post any of the ID properties,

This looks a little verbose, but it's the best I've found, so it is how I do it in my projects (ajusted to your class names, with whatever was missing made up...):

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    var dbDepartment = (from Department d in db.Department
                        where d.Id == id
                        select d).FirstOrDefault() as Department

    dbDepartment.Name = Model.Name;
    dbDepartment.Color = Model.Color;
    // etc, assigning values manually...

    try
    {
        db.SaveChanges();
    }
    catch (Exception ex)
    {
        // oops...
    }
    return RedirectToAction("Index");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-15T16:49:31.933

这个怎么样

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int id, Department dept)
{
    Department tmp = new Department()
    {
        Id = dept.Id
    };
    try
    {
        db.Departments.Attach(dept, tmp);
        db.Save();
    }
} 
```

也许 tmp-part 可以在 Attach 部分之后交换为对 UpdateModel 的调用，但我不确定。

编辑：刚刚查看了有关 Attach(Entity e, Entity original) 的文档，它确实用 e 替换了 original （或相应地更新原始文件或 w/e）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:40:45.697

尝试 db.AttachTo() 而不是 db.Attach()

[如此处](http://msdn.microsoft.com/en-us/library/bb896271.aspx)所述

“在 ObjectContext 上调用 AttachTo 以将对象附加到对象上下文中的特定实体集。如果对象具有空值（Visual Basic 中为无）EntityKey 值，也执行此操作。”

编辑：实际上，在这种情况下，您可能需要调用 ApplyPropertyChanges()。

编辑 2：您可以使用如下代码为您的对象构建实体键：

```
public EntityKey GetEntityKey(string entitySetName, object keyValue)
{
  IEnumerable<KeyValuePair<string, object>> entityKeyValues =
    new[]
    {
      new KeyValuePair<string, object>("Id", keyValue)
    };

  var key = new EntityKey(string.Concat("YOUR_OBJECT_CONTEXT_NAME.", entitySetName), entityKeyValues);
  return key;
} 
```

然后你会用类似这样的东西来调用它，用于基于名为“Id”的单个数据库列的实体键：

var entityKey = GetEntityKey("客户", 23);

我在自己的 EF 代码中使用了类似的方法，除了使用 Generic 类型参数来避免必须使用字符串作为实体类名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-14T12:17:03.903

我不建议在 MVC 应用程序中使用 POCO。您应该使用 DTO 或模型。

也许您应该在之前通过 id 检索一个对象，然后将您通过参数提供的值替换为 edit 方法，然后保存更改。你得到一个错误，因为你没有首先分离模型。

`[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model) {
var entity=from m in db.Models where m.Id == Model.id select m;
Model entityAttached=entity.FirstOrDefault();
//replace all the new values in you object
db.SaveChanges();
}`

或在您通过 id 获取对象时将其分离，并在您想在编辑方法中保存新值时将其附加回来。

# java - 不同语言的 memcache 客户端是否以相同的方式散列？

> ID：895567
> 
> 赞同：7
> 
> 时间：2009-05-21T22:27:04.400
> 
> 标签：java, php, memcached

我们想在 Java 应用程序中进行一些处理，将结果存储在我们的 memcache 服务器池中，然后使用 PHP 中的 memcache 将其读回。

这很容易尝试，但我想问问有没有其他人这样做过。

只要 Java 和 PHP 客户端都连接到同一个内存缓存服务器池，两个客户端是否会散列到同一个服务器位置，从而可以从 PHP 进行检索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T22:42:03.917

不，并非所有客户端都以相同的方式散列。作为这一点的证据，您会看到一些客户端提供“一致哈希”，而另一些则不提供。

简而言之，memcached 客户端可以使用他们喜欢的任何散列算法。没有官方标准。

PHP 客户端支持[多种散列算法](http://www.php.net/manual/en/memcached.constants.php)——因此可以将其配置为使用您的 Java 库使用的相同算法（看起来有几种算法——您使用的是哪一种？）。但是很明显，您需要进行大量测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-18T08:34:47.247

允许跨语言访问的另一种可能性是不依赖语言序列化，而是以 JSON 格式存储对象，作为文本字符串。

就个人而言，我在 Java 中使用[Gson](http://code.google.com/p/google-gson/)，在 PHP 中使用 json_encode、json_decode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-28T08:24:10.510

pylibmc

```
import pylibmc

mc = pylibmc.Client(["127.0.0.1"], binary=True,
                   behaviors={"tcp_nodelay": True,
                               "ketama": True})

key="someKey"
i=0
while True:
    #mc.set(key, str(i))
    value = mc.get(key)
    print(value)
    sleep(1)
    i+=1 
```

# math - 将摄像机视图中的 x/y 值转换为平移/倾斜值

> ID：895571
> 
> 赞同：2
> 
> 时间：2009-05-21T22:27:48.500
> 
> 标签：math, trigonometry, point

如果我有一台提供 360 度平移 (x) 和倾斜 (y) 值的相机，并且我想获取我的光标在相机视图中的平移和倾斜值，我将如何转换它？

更多信息：这是一个 Flash/AS3 项目。平移和倾斜值来自摄像机视图的中心。相机视图尺寸为 960x540。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-14T23:57:10.100

您以像素为单位给出了“视图”大小。您需要知道的是视野 (FOV)，它以度数为单位。从那里你可以知道从中心到图像边缘的度数。

您可以在相机的技术规格中找到 FOV。（由探测器阵列尺寸和焦距决定）。或者，您可以尝试测量它。这是一个网页，解释了如何：

[http://www.panohelp.com/lensfov.html](http://www.panohelp.com/lensfov.html)

# visual-studio-2008 - 如何使用 Visual Source Safe 2005？

> ID：895573
> 
> 赞同：5
> 
> 时间：2009-05-21T22:27:57.457
> 
> 标签：visual-studio-2008, svn, version-control, visual-sourcesafe

我目前在仍然有 VSS 2005 的环境中工作。我目前无权更改为 Subversion、TFS 等。

使用 VSS 2005 时需要注意的主要问题是什么——我怎样才能最好地使用它来尝试保存我的版本而不破坏我的源代码？例如，将它与 Visual Studio 2008 集成更好，还是只使用 VSS 客户端？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T12:31:21.577

不要用 VSS 做任何复杂的事情。我认为许多从未遇到过 VSS 问题的人只是将它用作文件共享（即文件被签入一次并且从不修改）——具有讽刺意味的是，使用 VSS 作为普通文件备份实际上增加了灾难性丢失的几率！

VSS 让你陷入一连串措辞不佳的问题中。每个问题都没有一个单一的答案，你必须停下来思考每一个问题。与 VSS 断开连接时，系统会不断询问您是否要切换到通过 IIS 使用 VSS，如果这样做，如何撤消它并不明显。

不要使用 VSS 插件来获取初始项目或签出项目。VSS 插件往往会将您的文件放在意想不到的地方，使用 VSS 客户端，它更有可能为您提供一个反映 VSS 中项目结构的文件夹结构。

不要使用内置功能来分支，不要合并。创建一个新的 VSS 项目（即新的文件夹集）并在需要分支时将代码作为一个全新的东西签入。如果您需要模拟合并，请使用无法比较的东西。

不要重命名文件，而是添加新文件，复制粘贴，然后删除。这打破了历史链条，但恶化的次数更少

允许多次签出，但非正式地不要让太多工作在同一代码区域完成，不要让其他开发人员让他们的版本变得太陈旧，因为那样你会尝试合并旧的工作文件夹版本和最新版本和 VSS 往往会使初级开发人员淹没在他们不理解的问题中。

不要进行非常大的签到。不要在没有第三方产品的情况下在慢速网络连接上使用。

如果您在 Visual Studio 中使用 VSS 插件，请定期使用 VSS 客户端比较和同步您的工作文件夹，但要逐个文件进行，而不是批量进行。

不要让存储库变得太大。为不相关的工作拆分存储库。

不要被登录密码所迷惑。VSS 并不比文件夹上的 NTFS 权限更安全。

当开发人员离开公司时，请他们撤消结帐。使用相同的机器和用户凭据以及工作文件夹撤消签出比使用管理员帐户撤消其他人的签出要容易一个数量级。

任何源代码控制系统的所有最佳实践也适用，例如，将二进制文件的连续版本检查为 binaryfile.bin，而不是 binaryfilev1.bin、binaryfilev2.bin，但请告诉 VSS .bin 或您的意思是二进制，否则它将尝试做文本合并。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T14:02:00.320

> 如何使用 Visual Source Safe 2005？

酒精。它的负载。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T14:40:37.963

运行具有自动作业的隐形 SVN 存储库，该作业每晚检出最新的 VSS 文件并将它们检入 SVN。

当 VSS 死掉时（它会死掉）告诉老板我们准备好了第二个存储库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T22:50:36.537

在尝试将 VSS 与 VS 集成时，除了负面经验外，我什么都没有，所以我建议不要这样做。然而，我们当时正在处理 ASP.Net 1.1 项目，它没有能够以任何类型的文件夹结构存在于任何位置的好特性，而这主要是我们遇到问题的地方 - 尝试同步带有 VSS 存储库的项目结构。

除此之外，我只能建议您不要通过容易掉线的 VPN 连接签入代码。事实上......我建议永远不要远程签入代码；）如果连接在提交过程中断开，您可以加倍确认数据库是否刚刚损坏。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T22:55:36.930

上次我尝试（很久以前）时，Visual Studio 集成在使用 VSS 项目分支时表现不佳。

我只是使用 VSS 客户端。

其他建议：

*   定期运行 VSS Admin“分析”（以检测/修复数据库中的任何损坏）
*   制作并测试数据库的定期（例如每晚）备份，并使用“影子”功能，以防万一数据库损坏而无法修复

# language-agnostic - 有哪些好的代码优化方法？

> ID：895574
> 
> 赞同：5
> 
> 时间：2009-05-21T22:28:07.580
> 
> 标签：language-agnostic, optimization, performance

我想了解好的代码优化方法和方法论。

1.  如果我已经在考虑性能，我该如何避免过早的优化。
2.  如何找到代码中的瓶颈？
3.  我如何确保随着时间的推移我的程序不会变慢？
4.  要避免哪些常见的性能错误（例如；我知道在 try{} catch{} 块的 catch 部分内返回时在某些语言中是不好的

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-08-30T19:20:39.383

对于您建议的优化类型，您应该为清晰起见编写代码，并且在您有证据证明它们是瓶颈之前不要优化它们。

尝试像这样的微优化的一个危险是你可能会让事情*变慢*，因为编译器在很多时候比你更聪明。

进行“优化”：

```
const int windowPosX = (screenWidth * 0.5) - (windowWidth * 0.5); 
```

世界上没有一个严肃的编译器不知道除以二的最快方法是右移一。乘以浮点 0.5 实际上更昂贵，因为它需要转换为浮点并返回，并进行两次乘法（这比移位更昂贵）。

但不要相信我的话。看看编译器实际上做了什么。32 位 Ubuntu（-O3、-msse3、-fomit-frame-pointer）上的 gcc 4.3.3 编译：

```
int posx(unsigned int screen_width, unsigned int window_width) {
  return (screen_width / 2) - (window_width / 2);
} 
```

对此：

```
00000040 <posx>:
  40:   8b 44 24 04             mov    eax,DWORD PTR [esp+0x4]
  44:   8b 54 24 08             mov    edx,DWORD PTR [esp+0x8]
  48:   d1 e8                   shr    eax,1
  4a:   d1 ea                   shr    edx,1
  4c:   29 d0                   sub    eax,edx
  4e:   c3 
```

两次移位（使用立即操作数）和减法。非常便宜。另一方面，它编译这个：

```
int posx(unsigned int screen_width, unsigned int window_width) {
  return (screen_width * 0.5) - (window_width * 0.5);
} 
```

对此：

```
00000000 <posx>:
   0:   83 ec 04                sub    esp,0x4
   3:   31 d2                   xor    edx,edx
   5:   8b 44 24 08             mov    eax,DWORD PTR [esp+0x8]
   9:   52                      push   edx
   a:   31 d2                   xor    edx,edx
   c:   50                      push   eax
   d:   df 2c 24                fild   QWORD PTR [esp]
  10:   83 c4 08                add    esp,0x8
  13:   d8 0d 00 00 00 00       fmul   DWORD PTR ds:0x0
            15: R_386_32    .rodata.cst4
  19:   8b 44 24 0c             mov    eax,DWORD PTR [esp+0xc]
  1d:   52                      push   edx
  1e:   50                      push   eax
  1f:   df 2c 24                fild   QWORD PTR [esp]
  22:   d8 0d 04 00 00 00       fmul   DWORD PTR ds:0x4
            24: R_386_32    .rodata.cst4
  28:   de c1                   faddp  st(1),st
  2a:   db 4c 24 08             fisttp DWORD PTR [esp+0x8]
  2e:   8b 44 24 08             mov    eax,DWORD PTR [esp+0x8]
  32:   83 c4 0c                add    esp,0xc
  35:   c3                      ret 
```

您看到的是转换为浮点数，乘以数据段中的值（可能在缓存中也可能不在缓存中），然后转换回整数。

当您想执行这样的微优化时，请考虑这个示例。它不仅为时过早，而且可能根本没有帮助（在这种情况下，它会严重伤害！）

严肃地说：不要这样做。我认为黄金法则是永远不要进行这样的优化，除非您像我在这里所做的那样定期检查编译器的输出。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-21T22:31:42.737

1.  不要考虑性能，要考虑清晰度和正确性。
2.  使用分析器。
3.  继续使用分析器。
4.  见 1。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-08-30T18:32:40.773

**编辑**此答案最初出现在另一个问题（已合并）中，其中 OP 列出了一些他认为必须有效的可能优化技术。所有这些都严重依赖于假设（例如`x << 1`总是比 快`x * 2`）。下面我试图指出这种假设的危险。

* * *

由于您的所有观点都可能是错误的，这表明了这种过早和微不足道的优化的危险。将此类决定留给编译器，除非您*非常*清楚自己在做什么并且它很重要。

否则它——只是——不—​​—不重要。

更重要（而且一点也不为时）是对一般程序结构的优化。例如，一遍又一遍地重新生成相同的大批量数据可能非常糟糕，因为很多地方都需要它。相反，必须在设计中考虑一些想法，以允许共享这些数据，从而只计算一次。

了解您所从事的领域也非常重要。我来自生物信息学背景，并在 C++ 中完成了许多核心算法工作。我经常处理大量数据。但目前，我正在用 Java 创建一个应用程序，每次创建容器的副本时我都会*感到畏缩，因为我已经习惯于避免此类操作。*但是对于我喜欢的 Java GUI 来说，这些操作完全是微不足道的，而且对用户来说一点也不明显。哦，好吧，我必须克服自己。

顺便一提：

> 声明常量时初始化常量（如果可以的话）……</p>

好吧，在许多语言（例如 C++）中，常量（即标记为 的标识符`const`）*必须*在定义时初始化，因此您实际上没有选择的余地。但是，遵循该规则*是*一个好主意，不仅适用于常量，而且一般而言。不过，原因不一定是性能。它只是更简洁的代码，因为它清楚地将每个标识符绑定到一个*目的*，而不是让它到处乱跑。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-22T01:34:22.727

优化俱乐部规则：

1.  优化俱乐部的第一条规则是，你不要优化。
2.  优化俱乐部的第二条规则是，没有衡量就不要优化。
3.  如果您的应用程序运行速度比底层传输协议快，那么优化就结束了。
4.  一次一个因素。
5.  没有市场机器人，没有市场机器人时间表。
6.  只要需要，测试就会继续进行。
7.  如果这是您在优化俱乐部的第一个晚上，您必须编写一个测试用例。

[http://xoa.petdance.com/Rules_of_Optimization_Club](http://xoa.petdance.com/Rules_of_Optimization_Club)

第 3 条规则是让大多数人绊倒的规则。如果您的程序等待磁盘写入或网络传输，那么您的计算速度并不重要。

规则#6 和#7：总是有测试。如果你在优化，你就是在重构，你不想在没有可靠的测试套件的情况下进行重构。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-08-30T18:17:09.433

记住“成本”是什么总是好的。一些 C# 示例：

*   字符串连接总是创建一个新字符串，因为字符串是不可变的。因此，对于重复连接，a`StringBuilder`更有效。

*   重复或大量内存分配通常是您应该注意的。

*   抛出异常非常昂贵。这就是为什么只应在异常情况下使用异常的原因之一。

除此之外的大多数事情都是过早的优化。如果速度很重要，请使用分析器。

* * *

关于您的“优化”：

*   我怀疑浮点运算 ( `* 0.5`) 是否比整数除法 ( `/ 2`) 快。

*   如果你需要一个大小为 300 的数组，你应该初始化一个大小为 300 的数组。关于 2 的幂并没有什么“魔法”可以使大小为 256 的数组更有效率。

*   “在代码中需要 2 次调用”是错误的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-21T22:37:58.620

确保您有明确定义的性能目标和针对这些目标进行衡量的测试，以便您可以快速找出是否存在问题。

更多地从设计的角度而不是从编码的角度考虑性能——优化性能不佳的设计只会导致更快的慢代码

当您确实遇到性能问题时，请使用诸如分析器之类的工具来识别问题 - 您可以猜测瓶颈在哪里并且通常会猜错。

在开发的早期解决性能问题，而不是推迟它们——随着时间的推移和特性进入产品，修复性能问题只会变得越来越困难。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-21T22:37:29.853

我们有一个分包商为我们写了一段非常重要的代码，用于非平凡的程序。显然他们总是使用微不足道的数据。所以..

*   使用分析器
*   测试时使用大量数据。如果可能的话，制作大量的数据。
*   当事情变得紧张时，使用理智的算法。
*   使用分析器检查您所做的任何“优化”实际上是否正确，例如最近的“java jar”惨败，其中 O(1) 操作以 O(n) 完成。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-21T22:40:40.957

我使用的第一条规则是[DRY](http://en.wikipedia.org/wiki/Don't_repeat_yourself)（不要重复自己）。我发现这条规则很好地突出了可以修复的问题区域，而不会损害程序的清晰度。一旦发现瓶颈，它还可以更轻松地修复它们。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-22T09:20:36.677

**早期优化并不总是为时过早**——只有在没有正当理由的情况下损害其他利益（可读性、维护、实施时间、代码大小……）时，这才是坏事。

在 stackoverflow 上，早期优化是新的`goto`，不要因此而气馁。*任何*早期错误的决定都很难在以后解决。优化之所以特别，只是因为经验表明它通常可以在本地修复，而糟糕的代码需要大规模的更改。

* * *

对不起，现在是您的实际问题：

**了解你的环境！**
这包括所有低级别的细节——例如非线性内存访问、编译器可以优化的东西等等。诀窍是不要担心很多你不应该担心的事情，只是要注意。

**测量测量测量！**
实际优化尝试的结果通常令人惊讶，尤其是当您改变看似无关的因素时。这也是培养对表演放松态度的最佳方式——大多数时候这并不重要。

**在考虑实现细节之前先考虑算法。**
大多数低级优化为您提供 1.1 的系数，不同的算法可以为您提供 10 的系数。一个好的（！）缓存策略可以为您提供 100 的系数。弄清楚您真的不需要拨打电话给你Warp 10。

这通常会导致我思考如何组织数据：哪些是潜在瓶颈的频繁操作，或可扩展性问题？

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-08-30T18:34:56.247

1.  编写显示*意图*的可读代码。不要进行微优化——你*无法*超越 JIT。
2.  学习使用分析器，例如 Sun JDK 中的 jvisualvm，并*使用*它。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-08-30T18:26:04.563

我想说的是，您可以在旅途中进行的小优化正是那些没有多大意义的优化。如果要优化，请先编写代码，然后进行概要分析，*然后再*优化花费太多时间的部分。即便如此，通常需要优化的是*算法，而不是实际的代码。*

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-08-30T18:40:42.710

我什至会说对于整数类型，而不是乘以 0.5，您可以将它们向右移动一位（不要忘记有符号/无符号移位）。

我很确定，至少在 C# 的情况下，编译器会优化很多。

例如：

```
Guid x = Guid.NewGuid(); 
```

也

```
Guid x; x = Guid.NewGuid(); 
```

两者都转换为以下 CIL：

```
call        System.Guid.NewGuid
stloc.0 
```

诸如 (4 + 5) 之类的常量表达式以及诸如“Hello”+“World”之类的字符串连接都是预先计算的。

不过，我将主要专注于可读和可维护的代码。除了特殊的边缘情况外，这种微优化不太可能产生重大影响。

就我而言，（有时被感知的）性能的最大收益如下：

*   如果您从数据库或 Internet 获取数据，请使用单独的线程
*   如果加载大型 XML 文件，请在单独的线程上执行。

当然，这只是我的 C# 经验，但输入/输出操作是常见的瓶颈。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-22T01:16:12.873

恐怕这需要经验。当你构思一个问题的解决方案时，你可能会考虑类层次结构，或者你可能会考虑输入什么信息，输出什么信息，在这两者之间需要持续多长时间。我推荐后者。

无论如何，人们所说的大多是好的建议——保持干净和简单，并在他们进来时摆脱性能问题，因为他们会进来。

[与此方法相比，](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)我发现*测量*对于*定位*性能问题没有多大帮助。

但是无论你使用什么方法，希望经验能教会你在开发软件时不该做什么。长期以来，我一直在解决性能问题，而这些天来，最流行的性能杀手就是**疾驰泛化**。没有人喜欢听到他们最喜欢的信仰受到质疑，但是一次又一次，尤其是在大型软件中，杀死性能的是**使用火箭筒来打苍蝇**。

奇怪的是，这种过度设计的原因经常是你猜怎么着？*表现。*

无论你在任何地方学习过编程，你都可能学到了所有关于学术的东西，比如复杂的数据结构、抽象类层次结构、棘手的编译器优化技术——所有有趣和有趣的最新知识，我喜欢和任何人一样。他们没有教你什么**时候使用它，几乎从来没有**。

所以我建议你做的是：**获得经验。它是最好的老师。**

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-08-30T18:33:38.260

不知道你会不会买，但[早优化不是万恶之源](http://www.acm.org/ubiquity/views/v7i24_fallacy.html)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-08-30T19:22:04.513

当然，您可以随时进行优化，例如通过 C++ 中的 const 引用传递大对象（[C++ 优化策略和技术](http://www.tantalon.com/pete/cppopt/main.htm)）。第一个建议（“不要除以 2”）可能属于“炸弹策略”——假设某些操作比其他操作更快。

我犯的一个过早的（？）优化是将昂贵对象的声明移出循环。例如，如果一个循环每次迭代都需要一个新的向量，我经常这样做：

```
std::vector<T> vec;
while (x) {
    vec.clear(); //instead of declaring the vector here
    ...
} 
```

我曾经在成员函数中创建了一个本地使用的向量作为优化（以减少内存分配 - 这个函数经常被调用），但是当我决定通过使用多个这些对象中的一个以上来获得真正的性能时，它被炸毁了多个线程。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-21T23:13:19.080

简介，简介，简介。如果[`valgrind`](http://valgrind.org)可以（与`kcachegrind`可视化器一起）使用，则使用古老的`gprof`.

我的最佳表现命中：

1.  分配内存而不释放它。只能使用 C 和 C++。
2.  分配内存。
3.  调用编译器以某种方式无法内联的非常小的过程、函数或方法。
4.  内存流量。

其他一切都在噪音中。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-08-30T18:32:32.710

你可能想看看编译器做了哪些优化——许多编译器可以优化掉尾递归之类的东西，相比之下，大多数其他次要优化都是微不足道的。我的方法是写东西，使它们尽可能可读/可管理，然后，如果需要，看看生成的汇编代码是否需要某种优化。这样就不需要花时间优化不需要优化的东西。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-21T22:36:07.377

1、2 和 3 有相同的答案：**Profile**。获取一个好的分析器并在您的应用程序上以侵入式和采样模式运行它。这将向您展示您的瓶颈在哪里，它们有多严重，并且定期这样做会告诉您性能每周都在哪里变得更糟。

您也可以简单地将秒表放入您的应用程序中，以便它告诉您，例如，加载文件需要多少秒；您会注意到该数字是否变大，尤其是当您记录它时。

4 是一个很大很大的问题，从高级算法设计一直到[特定 CPU 管道的微小细节](http://www.microsoft.com/downloads/details.aspx?FamilyId=1643D55A-D252-4717-BC3E-237C2C5295F4&displaylang=en)。那里有很多资源，但总是从高层次开始——在你开始担心整数操作码延迟等之前，把你的外循环从 O(N^2) 带到 O(N log N)。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-22T15:02:52.617

*   仅在遇到性能问题时进行优化。
*   只优化慢速部分，**如实测！**
*   找到更好的算法可以为您节省几个数量级，而不是几个百分点。

上面提到了，但值得多说：测量！您必须进行测量以确保您正在优化正确的东西。您必须测量以了解您是否已经改进或足够改进，以及改进了多少。记录你的测量！

此外，您通常会认为例行程序占用了总时间的 75% 以上。值得花时间更细粒度地分析...通常您会发现该例程中的大部分时间*都*花在了代码的一小部分上。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-02-13T09:15:33.303

> 如果我已经在考虑性能，我该如何避免过早的优化。

优化有多重要，它将如何影响可读性和可维护性？

> 如何找到代码中的瓶颈？

在你的脑海中走过它的执行流程。了解所采取步骤的成本。在您进行的过程中，评估此上下文中的现有实现。您还可以使用调试器查看另一个视角。考虑并实际尝试替代解决方案。

与流行的方法相反，在程序编写后或一旦出现问题就进行分析是幼稚的——这就像在准备不足的饭菜中添加酱汁来掩盖不愉快的事情。它也可以比作总是寻求解决方案而不是实际确定原因（并在此过程中了解原因）的人之间的差异。如果您已经实现了一个程序，然后花时间进行分析，然后进行了简单的修复，并在此过程中使其速度提高了 20%……如果性能和资源利用率很重要，那么这通常不是一个“好的”实现，因为所有的小问题都有累积将是分析器输出中的高噪声。一个好的实现比临时构造函数的实现好 5、10 甚至 25 倍并不罕见。

> 我如何确保随着时间的推移我的程序不会变慢？

这取决于很多事情。一种方法将涉及持续集成和实际执行程序。然而，即使在严格控制的环境中，这也可能是一个移动的目标。通过专注于第一次创建良好的实现来最小化更改...... :)

> 要避免哪些常见的性能错误（例如；我知道在 try{} catch{} 块的 catch 部分内返回时在某些语言中是不好的

我要补充一点：多线程经常被用于错误的原因。它太常用来加剧糟糕的实现，而不是定位现有设计中的现有问题/弱点。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-03-04T12:30:37.437

[github上](https://github.com/foo123/code-optimization-methods)的代码优化方法总结（语言无关） （ps我是作者）

**大纲：**

1.  一般原则（即缓存、连续块、延迟加载等）
2.  低级（二进制格式、算术运算、数据分配等）
3.  与语言无关的优化（重新排列表达式、代码简化、循环优化等）
4.  数据库（延迟加载、高效查询、冗余等）
5.  Web（最小事务、压缩等）
6.  参考

# windows - 如何从 Windows 读取 Fedora 分区？

> ID：895576
> 
> 赞同：1
> 
> 时间：2009-05-21T22:28:53.710
> 
> 标签：windows, cross-platform, backup, disk-partitioning, ext3

Windows 识别并给我的 Fedora 分区一个驱动器号，但它显示为空白。有没有办法让 Windows 读取 ext3 文件系统？它是一个 Fedora 10 分区。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T22:53:35.407

我会看看[EXT2 IFS for Windows](http://www.fs-driver.org/index.html)。

有几件事要记住这一点。

*   Ext3 向后兼容 Ext2，只是不写入日志
*   NTFS 不区分大小写，这可能会让您感到困惑，具体取决于您要移动的内容
*   某些在 Ext2/3 中有效的文件名在 NTFS/VFAT 中无效，例如 : 和 $
*   特殊文件将无法访问，套接字，软链接，块设备
*   不维护权限
*   不适用于 LVM 卷

它会让你读和写它；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T22:32:44.280

在 ServerFault.com 上查看我的类似问题的答案：

*   [我应该使用什么 Windows ext3 驱动程序？](https://serverfault.com/questions/3038/what-windows-ext3-driver-should-i-use)

我得到的最佳答案的摘要（其他答案后来被删除，我假设他们的作者）：使用 ntfs-3g 从 Linux 访问 NTFS 文件系统。与使用 Windows 中的任何现有 ext2/3 驱动程序相比，这样做的文件系统损坏的可能性要小得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T23:12:31.593

我知道你想挂载你的 Fedora 分区，但根据经验，我发现与 Windows 共享分区的最佳方法是格式化为 NTFS 并使用 ntfs-3g 在 Linux 中访问它。

几年前，我尝试使用 JensenDied 提到的 ext2 Windows 应用程序，但最终在访问正在使用的 USB 驱动器上的数据时遇到了问题。

# asp.net - 如何管理各种 ASP.NET 网站项目引用和自动更新

> ID：895577
> 
> 赞同：1
> 
> 时间：2009-05-21T22:29:02.523
> 
> 标签：asp.net, reference, visual-sourcesafe, com-interop, web-site-project

我的解决方案中有一个 Visual Studio 2008 网站项目，其中包含许多其他程序集项目。

网站项目有 4 种类型的引用：项目、bin、COM 互操作和文本文件。

该项目完美地引用了自动更新。

托管 DLL 的 bin 引用使用 .refresh 文件自动更新，这些文件运行良好并且可以检入 Visual SourceSafe。

我的问题是关于如何管理其他两种类型 - COM 互操作和文本文件。

我有一个 OCX，当作为参考添加时，它会创建一个没有 .refresh 文件的互操作 DLL。将互操作 DLL 检查到 VSS 中是不可取的，因为您必须在构建时检查它。将互操作 DLL 移动到另一个位置以直接引用不起作用，因为我需要对我的程序集进行强命名，在这种情况下这需要原始 OCX。互操作引用甚至不会显示在“属性页”>“引用”页面上。

**如何让它正确自动更新？如何制作合适的 .refresh 文件？**

我有纯文本文件，其中包含其他托管 DLL 引用的许可证。我创建了似乎适用于 VS2008 和 VSS 的 .refresh 文件，但不是自动为我创建的。

**我应该如何以适用于 VSS 的方式包含引用？**

签入 bin 目录中的许可证文件会导致同样的问题，即必须在每次构建时签出它们。

# generics - 如何在 IronRuby 中调用重载的泛型方法？

> ID：895585
> 
> 赞同：0
> 
> 时间：2009-05-21T22:30:43.113
> 
> 标签：generics, methods, overloading, ironruby

如何在 IronRuby 中调用重载的泛型方法？

我有一个具有以下方法的 .NET 类。（注意这些方法是静态的）

```
Factory.cs
----
public static T CreateService<T>()
public static T CreateService<T>(string serviceName)

ironruby_sample.rb
----
service = Factory.create_service[ISomeService] 
```

=> 产生错误“错误的参数”

顺便说一句，我正在使用 IronRuby 0.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T20:00:54.927

```
Factory.method(:create_service).of(System::String).call(serviceName) 
```

您不必指定参数 IronRuby 将自动选择重载。您必须获取该方法，然后给它（a）类型参数。接下来将参数传递给调用方法

# asp.net-mvc - 在 ASP.NET MVC 中的 URL 中加密 id

> ID：895586
> 
> 赞同：11
> 
> 时间：2009-05-21T22:30:44.110
> 
> 标签：asp.net-mvc, encryption

我正在尝试对 URL 中的加密 id 进行编码。像这样： http: *[//www.calemadr.com/Membership/Welcome/9xCnCLIwzxzBuPEjqJFxC6XJdAZqQsIDqNrRUJoW6229IIeeL4eXl5n1cnYapg+N](http://www.calemadr.com/Membership/Welcome/9xCnCLIwzxzBuPEjqJFxC6XJdAZqQsIDqNrRUJoW6229IIeeL4eXl5n1cnYapg+N)*

但是，它要么编码不正确，我在加密中得到斜杠“/”，要么我从 IIS 收到错误消息：**请求过滤模块配置为拒绝包含双转义序列的请求。**

我尝试了不同的编码，每个都失败了：

*   HttpUtility.HtmlEncode
*   HttpUtility.UrlEncode
*   HttpUtility.UrlPathEncode
*   HttpUtility.UrlEncodeUnicode

**更新**

问题是当我加密一个 Guid 并将其转换为 base64 字符串时，它会包含不安全的 url 字符。当然，当我尝试导航到包含不安全字符的 url 时，IIS(7.5/windows 7) 会崩溃。Url 对 base64 加密字符串进行编码会在 IIS 中引发错误（*请求过滤模块被配置为拒绝包含双转义序列的请求。*）。我不确定它如何检测双编码字符串，但确实如此。

在尝试了上述方法对base64加密字符串进行编码之后。我决定删除 base64 编码。但是，这会将加密文本保留为 byte[]。我尝试对字节 [] 进行 UrlEncoding，它是 httpUtility.Encode 方法的重载之一。同样，虽然它是 URL 编码的，但 IIS 不喜欢它并提供*“找不到页面”。*

在网上挖掘后，我遇到了一个[HexEncoding/Decoding](http://bimalesh.blogspot.com/2006/11/c-class-for-hex-encoding.html)类。将十六进制编码应用于加密字节就可以了。输出是 url 安全的。另一方面，我在解码和解密十六进制字符串方面没有任何问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-04-05T23:28:54.583

使用`HttpServerUtility.UrlTokenEncode`and`HttpServerUtility.UrlTokenDecode`将字节数组转换为 URL 安全字符串。

请参阅[C# Byte[] to Url Friendly String](https://stackoverflow.com/questions/1886686/c-byte-to-url-friendly-string)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-09-25T20:48:13.883

我写了一篇关于这个主题的简短博客[文章，包括完整的源代码。](http://toranbillups.com/blog/archive/2009/09/25/How-to-encrypt-a-query-string-in-aspnet-mvc/)

它使您能够使用 16 字符密钥加密和解密以查询字符串形式存储的数据：

> 我找到了一组很棒的基类来解决这个问题，但大多数情况下它归结为一个类。此类需要某种 16 字符的密钥来进行加密，并需要一个值来加密。如果需要，您还可以设置过期值。

```
using System.Collections.Specialized;
using System.Security;
using System.Text;
using System.Web;
using EncryptionMVC.Security.Encryption.Utility.Interfaces;
using EncryptionMVC.Security.Encryption.Utility;
namespace Security.Encryption.QueryString
{
    /// 
    /// Provides a secure means for transfering data within a query string.
    /// 
    public class SecureQueryString : NameValueCollection
    {

        private string timeStampKey = '__TS__';
        private string dateFormat = 'G';
        private IEncryptionUtility mEncryptionUtil;
        private DateTime m_expireTime = DateTime.MaxValue;

        /// 
        /// Creates an instance with a specified key.
        /// 
        /// The key used for cryptographic functions, required 16 chars in length.
        public SecureQueryString(string key) : base()
        {
            mEncryptionUtil = new EncryptionUtility(key);
        }

        /// 
        /// Creates an instance with a specified key and an encrypted query string.
        /// 
        /// The key used for cryptographic functions, required 16 chars in length.
        /// An encrypted query string generated by a  instance.
        public SecureQueryString(string key, string queryString) : this(key)
        {
            Deserialize(DecryptAndVerify(queryString));
            CheckExpiration();
        }

        /// 
        /// Returns a encrypted query string.
        /// 
        /// 
        public override string ToString()
        {
            return EncryptAndSign(Serialize());
        }

        private void Deserialize(string queryString)
        {
            string[] nameValuePairs = queryString.Split('&');
            for (int i = 0; i <= nameValuePairs.Length - 1; i++) {
                string[] nameValue = nameValuePairs(i).Split('=');
                if (nameValue.Length == 2) {
                    base.Add(nameValue(0), nameValue(1));
                }
            }

            if (base.GetValues(timeStampKey) != null) {
                string[] strExpireTime = base.GetValues(timeStampKey);
                m_expireTime = Convert.ToDateTime(strExpireTime(0));
            }
        }

        private string Serialize()
        {
            StringBuilder sb = new StringBuilder();
            foreach (string key in base.AllKeys) {
                sb.Append(key);
                sb.Append('=');
                sb.Append(base.GetValues(key)(0).ToString());
                sb.Append('&');
            }

            sb.Append(timeStampKey);
            sb.Append('=');
            sb.Append(m_expireTime.ToString(dateFormat));

            return sb.ToString();
        }

        private string DecryptAndVerify(string input)
        {
            return mEncryptionUtil.Decrypt(input);
        }

        private string EncryptAndSign(string input)
        {
            return mEncryptionUtil.Encrypt(input);
        }

        private void CheckExpiration()
        {
            if (DateTime.Compare(m_expireTime, DateTime.Now) < 0) {
                throw new ExpiredQueryStringException();
            }
        }

        /// 
        /// Gets or sets the timestamp in which this string should expire
        /// 
        public DateTime ExpireTime {
            get { return m_expireTime; }
            set { m_expireTime = value; }
        }
    }
} 
```

> 要加密某些值并将其传递给 MVC 中的另一个操作，您可以执行以下操作。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(FormCollection collection)
{
    SecureQueryString qs = new SecureQueryString(mKey);

    qs('YourName') = collection('name');
    qs.ExpireTime = DateTime.Now.AddMinutes(2);

    Response.Redirect('Home.aspx/About?data=' + HttpUtility.UrlEncode(qs.ToString()));
} 
```

> 在我们重定向到的操作中，您需要拥有相同的密钥和查询字符串值本身来解密它。请记住，如果您没有正确的密钥，或者您在过期后尝试解密该值，则该类将引发异常。

```
public ActionResult About()
{
    if (Request('data') != null) {
        try {
            SecureQueryString qs = new SecureQueryString(mKey, Request('data'));

            ViewData('Message') = 'Your name is ' + qs('YourName');
        }
        catch (Exception ex) {

        }
    }
    return View();
} 
```

> 我没有花太多时间深入解释源代码，因为距离我写它已经很久了。还要记住，这早在我测试的第一天之前就已经过了……（但它似乎确实有效）
> 
> 与往常一样，此示例的[源代码](http://dl.dropbox.com/u/716525/content/downloads/EncryptionMVC.zip)可供下载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T22:36:30.463

加密和编码是有区别的；这些方法不适用于加密。

因为加密很难做到正确，而且非常容易出错（虽然看起来仍然像正确的解决方案一样“加密”），所以我建议您改用 GUID ID：

[http://www.calemadr.com/.../](http://www.calemadr.com/.../) {6F0184E4-809F-4e30-8A5B-4DC144135A54}

SQL Server 具有仅适用于这种情况的 uniqueidentifier 类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T05:59:41.057

这篇文章可能很旧，但在这里你有另一个解决方案......当你要加密 .ToBase64String 时，url 编码/解码会更改加密的字符串。

在进行解码之前在您的加密库（或函数）上尝试此操作：

```
Myencodedid.Replace(' ', '+') 
```

然后，去解密！..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T23:13:55.117

我很惊讶 UrlEncode 不起作用。你的加密输出是什么样的？

加密 Guid 后，尝试使用[Convert.ToBase64String](http://msdn.microsoft.com/en-us/library/8f9a8s97.aspx)方法将其编码为 Base64。然后对 Base64 字符串进行 UrlEncode 以使其成为可接受的字符串，以包含在您的 URL 中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T23:14:50.137

嗯...这可能不会有任何区别，但您可以尝试使用 AntiXSS 库和它的 URLEncode() 方法。

[http://www.codeplex.com/AntiXSS](http://www.codeplex.com/AntiXSS)

HTH，查尔斯

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-25T18:21:17.587

不知道这对您是否重要，但我只是自己解决了这个问题。我不得不加倍 urlencode。

例如

Server.UrlEncode(Server.UrlEncode(要编码的字符串))

问题似乎是 Request.Querystring(encoded string) 自动进行解码，这会破坏加密。我希望我能解释得更好，但我还是有点困惑

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-09-21T03:38:56.650

首先创建一个这样的类：

```
public class Encryption
{ 
    public static string Encrypt(string clearText)
    {
        string EncryptionKey = "MAKV2SPBNI99212";
        byte[] clearBytes = Encoding.Unicode.GetBytes(clearText);
        using (Aes encryptor = Aes.Create())
        {
            Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
            encryptor.Key = pdb.GetBytes(32);
            encryptor.IV = pdb.GetBytes(16);
            using (MemoryStream ms = new MemoryStream())
            {
                using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateEncryptor(), CryptoStreamMode.Write))
                {
                    cs.Write(clearBytes, 0, clearBytes.Length);
                    cs.Close();
                }
                clearText = Convert.ToBase64String(ms.ToArray());
            }
        }
        return clearText;
    }

    public static string Decrypt(string cipherText)
    {
        string EncryptionKey = "MAKV2SPBNI99212";
        byte[] cipherBytes = Convert.FromBase64String(cipherText);
        using (Aes encryptor = Aes.Create())
        {
            Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
            encryptor.Key = pdb.GetBytes(32);
            encryptor.IV = pdb.GetBytes(16);
            using (MemoryStream ms = new MemoryStream())
            {
                using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateDecryptor(), CryptoStreamMode.Write))
                {
                    cs.Write(cipherBytes, 0, cipherBytes.Length);
                    cs.Close();
                }
                cipherText = Encoding.Unicode.GetString(ms.ToArray());
            }
        }
        return cipherText;
    }
} 
```

在 Controller 中，为这个 Ecription 类添加引用，如下所示：

```
using testdemo.Models

public ActionResult Index() {
            return View();
        }
        [HttpPost]
        public ActionResult Index(string text)
        {
            if (Request["txtEncrypt"] != null)
            {
                string getEncryptionCode = Request["txtEncrypt"];
                string DecryptCode = Encryption.Decrypt(HttpUtility.UrlDecode(getEncryptionCode));
                ViewBag.GetDecryptCode = DecryptCode;
                return View();
            }
            else {
                string getDecryptCode = Request["txtDecrypt"];
                string EncryptionCode = HttpUtility.UrlEncode(Encryption.Encrypt(getDecryptCode));
                ViewBag.GetEncryptionCode = EncryptionCode;
                return View();
            }

        } 
```

在视图中：

```
<h2>Decryption Code</h2>
@using (Html.BeginForm())
{
    <table class="table-bordered table">
        <tr>
            <th>Encryption Code</th>
            <td><input type="text" id="txtEncrypt" name="txtEncrypt" placeholder="Enter Encryption Code" /></td>
        </tr>
        <tr>
            <td colspan="2">
                <span style="color:red">@ViewBag.GetDecryptCode</span>
            </td>
        </tr>
        <tr>
                <td colspan="2">
                    <input type="submit" id="btnEncrypt" name="btnEncrypt"value="Decrypt to Encrypt code" />
                </td>
            </tr>
    </table>
}
    <br />
    <br />
    <br />
    <h2>Encryption Code</h2>
@using (Html.BeginForm())
{
    <table class="table-bordered table">
        <tr>
            <th>Decryption Code</th>
            <td><input type="text" id="txtDecrypt" name="txtDecrypt" placeholder="Enter Decryption Code" /></td>
        </tr>

        <tr>
            <td colspan="2">
                <span style="color:red">@ViewBag.GetEncryptionCode</span>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <input type="submit" id="btnDecryt" name="btnDecryt" value="Encrypt to Decrypt code" />
            </td>
        </tr>
    </table>
} 
```

我希望这有用。

# vb.net - 图像未显示 - 程序冻结

> ID：895588
> 
> 赞同：-1
> 
> 时间：2009-05-21T22:31:08.040
> 
> 标签：vb.net, image

程序开始。当我单击“开始”按钮时，原始表单就像我想要的那样消失了，但它只是挂在那里。没有图片显示。CPU 变热，声音变大。它冻结了，有时我必须按 CTRL+ALT+DELETE 才能退出程序。

* * *

```
'Reaction.exe

'Picture comes up once, user presses left side of keyboard (Q,A,or Z)  
'Picture comes up a second time, user presses right side of keyboard (P,L,or M)
'A total of 10 .bmps, pictures show up randomly, a picture will only show up twice 
'Time (in millisecods) is recorded for each attempt 
'If user presses correct key, 
'For example if user presses 2 and it is the 2nd time the picture has shown up 
'Accuracy goes up a point (maximum of 10) 
'If user presses wrong key,  
'For example if user presses 2 even though the picture has only shown up once 
'Accuracy goes down a point (minimum of 0)

Public Class Form_Main

'Declare Globals'
Public X As Integer = 0 'Used in DisplayImage() function
Public I As Integer = 0 'Used for Times array and CalcTime() function
Public Num As Integer = 0   'Used in branches
Public Flag As Integer = 0
Public Accuracy As Integer = 0
Public Speed As Double = 0
Public Delay As Integer = 0
Public Timer_Start As Double = 0
Public Timer_End As Double = 0

'Arrays
'Times Array
Public Times(20) As Double  'Holds 20 times (since each picture will pop up twice)'

'Main Array
'Field = How many images will be used (Default is 10, for 10 pictures)
'Value:
'0 = Picture hasn't been used yet
'1 = Picutre has been used
'2 = Picture has already been used twice, and will not appear again
Dim MainArray(10) As Integer

' Start Button click (Main Function)
Private Sub Button_Start_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button_Start.Click
    ' Disable and hide the form
    RadioButton_Images.Visible = False
    RadioButton_Inkblots.Visible = False
    RadioButton_Words.Visible = False
    Button_Start.Visible = False
    Button_Reset.Visible = False
    RadioButton_Images.Enabled = False
    RadioButton_Inkblots.Enabled = False
    RadioButton_Words.Enabled = False
    Button_Start.Enabled = False
    Button_Reset.Enabled = False

    'Images branch
    If RadioButton_Images.Checked Then
        Images()
    End If

    'Show the Reset Button
    Button_Reset.Visible = True
    Button_Reset.Enabled = True
End Sub

'Functions
'Images() Function
Private Function Images() As Action
    Do Until (Num = 10)
        Timer_Start = 0
        Timer_End = 0
        Flag = 0
        Delay = Rand(3000, 6000)
        System.Threading.Thread.Sleep(Delay) '3-6 second delay
        DisplayImage()
        Timer_Start = TimeOfDay.Millisecond
        Do While (Flag = 0)
        Loop
        CalcTime()
    Loop
End Function

'Rand() Function (returns a random integer between (x,y) )
Private Function Rand(ByVal Low As Long, ByVal High As Long) As Long
    'randomize function
    Randomize()
    Rand = Int((High - Low + 1) * Rnd()) + Low
End Function

'DisplayImage() Function
Private Function DisplayImage() As Action
    Do Until PictureBox.Visible = True
        X = Rand(1, 10)  'Get a random number from 1 to 10

        Select Case X
            Case Is = 1
                If MainArray(X) = 0 Then                    'First time the picture is used
                    PictureBox.ImageLocation = "C:\Reaction\Images\1.bmp"
                    MainArray(X) = 1
                    PictureBox.Visible = True
                ElseIf MainArray(X) = 1 Then                'Second time the picture is up
                    PictureBox.ImageLocation = "C:\Reaction\Images\1.bmp"
                    MainArray(X) = 2
                    Num = Num + 1
                    PictureBox.Visible = True
                Else                                        'If MainArray(X) doesn't = 1 or 0
                End If                                      'Then endif and get another rand #
            Case Is = 2
                If MainArray(X) = 0 Then
                    PictureBox.ImageLocation = "C:\Reaction\Images\2.bmp"
                    MainArray(X) = 1
                    PictureBox.Visible = True
                ElseIf MainArray(X) = 1 Then
                    PictureBox.ImageLocation = "C:\Reaction\Images\2.bmp"
                    MainArray(X) = 2
                    Num = Num + 1
                    PictureBox.Visible = True
                Else
                End If
            Case Is = 3
                If MainArray(X) = 0 Then
                    PictureBox.ImageLocation = "C:\Reaction\Images\3.bmp"
                    MainArray(X) = 1
                    PictureBox.Visible = True
                ElseIf MainArray(X) = 1 Then
                    PictureBox.ImageLocation = "C:\Reaction\Images\3.bmp"
                    MainArray(X) = 2
                    Num = Num + 1
                    PictureBox.Visible = True
                Else
                End If
                ...
        End Select
    Loop
End Function

Private Function CalcTime() As Action
    'Calculates the time in milliseconds
    'Records to Times() array
    Times(I) = Timer_Start - Timer_End
    I = I + 1
End Function

Private Sub Form_Main_KeyPress(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles MyBase.KeyPress

    'Keypress Q, A, or Z if the picture is seen for the first time
    'Otherwise one accuracy point is deducted
    If e.KeyChar = "Q" Or "A" Or "Z" Or "q" Or "a" Or "z" Then
        If PictureBox.Visible = True Then
            If MainArray(X) = 1 Then
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy + 1
                Flag = 1
            Else
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy - 1
                Flag = 1
            End If
        End If
    End If

    'Keypress for second occurance
    If e.KeyChar = "P" Or "L" Or "M" Or "p" Or "l" Or "m" Then
        If PictureBox.Visible = True Then
            If MainArray(X) = 2 Then
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy + 1
                Flag = 1
            Else
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy - 1
                Flag = 1
            End If
        End If
    End If
End Sub

'Reset button
Private Sub Button_Reset_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button_Reset.Click
    'Reset all global variables
    X = 0
    I = 0
    Num = 0
    Flag = 0
    Accuracy = 0
    Speed = 0
    Delay = 0
    Timer_Start = 0
    Timer_End = 0
    'temporarily use I and X to clear out MainArray() and Times() array
    For I = 0 To I = 10
        MainArray(I) = 0
    Next

    For X = 0 To X = 20
        Times(X) = 0
    Next
    'Reset back to 0
    X = 0
    I = 0

    'Enable and show the form, hiding the reset button
    RadioButton_Images.Visible = True
    RadioButton_Inkblots.Visible = True
    RadioButton_Words.Visible = True
    Button_Start.Visible = True
    Button_Reset.Visible = False
    RadioButton_Images.Enabled = True
    RadioButton_Inkblots.Enabled = True
    RadioButton_Words.Enabled = True
    Button_Start.Enabled = True
    Button_Reset.Enabled = False
End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-03T13:18:17.960

您有一对永远不会停止的 Do While 循环（Do Until (Num = 10)、Do While (Flag = 0)），因此当程序遇到它们时，它将进入一个永无止境的“无限循环”。

你写了：

```
   Do While (标志 = 0)
   环形

```

...但是您需要在这两行之间添加一些代码，将 Flag 的值更改为 0 以外的值，否则计算机永远无法满足条件，它将永远无果地循环。例如，这个*假设*示例将等待用户按下 Escape 键：

```
   Do While (标志 = 0)
       If UserPressedEscape() Then Flag = 1
   环形

```

CPU 变热，冷却风扇全速运转，因为程序正在疯狂循环，占用了 100% 的 CPU 时间。

（我想您希望程序中的事件处理代码在循环运行时“在后台”执行，但实际上计算机一次只做一件事，因此它永远不会退出循环以能够运行你的事件处理程序。如果程序是“多线程”的，那么这是可能的，但是它的编写方式是“单线程”的，所以程序一次只做一件事，按顺序，所以它永远不会得到跳出循环）

# vb.net - 为什么移动项目后 VB.net 编译器会崩溃？

> ID：895591
> 
> 赞同：0
> 
> 时间：2009-05-21T22:31:19.990
> 
> 标签：vb.net, visual-studio-2008, migration, crash

我正在将数据从旧笔记本电脑迁移到新笔记本电脑，包括 Visual Studio 2008 中的一些 vb.net 项目。但是当我尝试在新笔记本电脑上打开其中一些项目时，我很快得到一个对话框，指出 vb 编译器有崩溃并询问我是否要关闭、调试或在线查看解决方案。然后，Visual Studio 令人沮丧地关闭了。

这些项目在旧笔记本电脑上打开时不会崩溃，而其他迁移的项目打开时不会崩溃。因此，必须是项目的某些属性因移动它们而损坏。

我已经进行了搜索并找到了具有类似问题但没有答案的人的帖子。为什么会发生这种情况，我该如何解决？

错误详情：

```
Problem signature:
  Problem Event Name:   APPCRASH
  Application Name: devenv.exe
  Application Version:  9.0.21022.8
  Application Timestamp:    47317b3d
  Fault Module Name:    kernel32.dll
  Fault Module Version: 6.0.6001.18215
  Fault Module Timestamp:   4995344f
  Exception Code:   e06d7363
  Exception Offset: 0002f328
  OS Version:   6.0.6001.2.1.0.768.3
  Locale ID:    4105

Additional information about the problem:
  LCID: 1033

Read our privacy statement:
  http://go.microsoft.com/fwlink/?linkid=50163&clcid=0x0409 
```

旧笔记本电脑是 windows xp 并使用 Visual Studio Professional。新的笔记本电脑是 windows vista 并使用了视觉工作室团队。“迁移”是源文件的直接复制粘贴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T22:35:52.947

项目文件可能引用了一个不再存在的位置（即它在旧笔记本电脑上而不是在新笔记本电脑上）。例如，驱动器是否不同（D：在一个上，C：在另一个上）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T04:07:55.663

该项目崩溃是因为任何相当于以下代码片段的代码都会导致 VS2008 崩溃，但不会导致 VS2008 SP1 崩溃：

```
Public Class B(Of T)
    Protected Function P(ByVal arg As T) As Boolean
    End Function
End Class
Public Class C
    Inherits B(Of Integer)
    Private Sub New(ByVal arg As Integer)
        Dim d = Function() P(arg)
    End Sub
End Class 
```

笔记：

*   升级到 SP1 可以解决此问题。
*   'Boolean' 或 'Integer' 没有什么特别之处，它们只是方便的类型
*   将两个 sub 组合到一个类中会使 bug 消失。
*   在基类函数中使用非泛型参数会使错误消失。
*   在子类中使用非构造函数子会使错误消失。
*   对错误的天真 C# 翻译不会导致 C# 编译器崩溃。

我终于可以把它归咎于编译器了。不是我的错！

# perl - 我可以在 Perl 中有一个应用程序范围变量吗？

> ID：895592
> 
> 赞同：1
> 
> 时间：2009-05-21T22:31:25.873
> 
> 标签：perl, variables, scope, cgi

我对 Perl/CGI 有点陌生，而且我来自 Java/JSP 背景。

我正在编写一个小型原型，需要将一些“重”数据（~200MB）加载到数据结构中。

现在，我显然想避免在每个请求中加载数据。到目前为止，我设法使用了一个“静态”变量（一个包含在 {} 块中），但这似乎适用于一些请求。在一段时间不活动之后，下一个请求将不得不再次加载数据。

根据我的 JSP 经验，这似乎是一种会话变量，在会话到期之前一直可用。

如何设置“全局”或“应用程序”变量？不确定这些术语是否适用于 CGI... 是否可以让应用程序的所有会话共享一个变量？

顺便说一句，我现在只是在使用“使用 CGI qw(:standard)”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T22:39:52.533

CGI 脚本被执行，然后在每次请求后终止。每次都会加载您的 200 MB 变量。

您应该将此数据放入数据库或其他结构化格式，以便您仅在需要时加载数据。

查看类似[MLDBM](http://search.cpan.org/dist/MLDBM/lib/MLDBM.pm)、[DBD::SQLite](http://search.cpan.org/dist/DBD-SQLite/lib/DBD/SQLite.pm)或[DBM::Deep的内容](http://search.cpan.org/dist/DBM-Deep/lib/DBM/Deep.pod)

有关Perl 中变量作用域的信息，请参见[Coping with Scopes 。](http://perl.plover.com/FAQs/Namespaces.html)

[Ovid 的 CGI 课程](http://jdporter.perlmonk.org/cgi_course/)也是学习用 Perl 编写 CGI 脚本的好资源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T22:37:49.307

CGI 程序针对每个请求在单独的进程中运行。这是[CGI 协议](http://hoohoo.ncsa.illinois.edu/cgi/interface.html)的一部分。

因此，只要您绑定到 CGI，这是不可能的。你确定你绑定到 CGI 吗？

如果您正在运行 Apache，并且 Apache 已编译 mod_perl 或作为动态加载的模块提供，则可以在进程中运行 perl 脚本并重用数据；甚至还有一种兼容模式，您可以在其中正常编写 CGI 脚本（使用“使用 CGI”），它们会自动进行 mod-perl 化，以便 BEGIN 块中的内容只运行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:18:22.997

试试[CGI::Session](http://search.cpan.org/perldoc?CGI::Session "CGI::Session - CGI 应用程序中的持久会话数据")模块。

*但是请注意，像 Daniel Martin 和 daotoad 所写的持久性**超出**了 CGI 的范围；您将不得不使用某种额外的存储空间来保存状态。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T01:38:42.483

您是否查看过 Storable 模块及其冻结/解冻方法来冻结您的对象结构并临时存储它？[CPAN > 可存储](http://http:/search.cpan.org/~ams/Storable-2.20/Storable.pm)

Storable 允许你在任何可以被认为是数据库的东西中写入和检索你的结构，包括 Berkley，甚至是平面文件。虽然 200 MB 是要存储的大块，但您可以将数据重新组合成更小的散列，这些散列很容易重新组合在一起。

而且速度超级快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T14:37:27.227

如果我是你，我会考虑研究[CGI::Fast 。](http://search.cpan.org/dist/CGI.pm/CGI/Fast.pm)CGI::Fast 使编写持久 CGI 程序变得容易。根据您的数据结构的不同，另一个不错的选择是使用[Cache::Memcached](http://search.cpan.org/dist/Cache-Memcached/lib/Cache/Memcached.pm)（或其更快的表亲[Cache::Memcached::XS](http://search.cpan.org/dist/Cache-Memcached-XS/lib/Cache/Memcached/XS.pm)）将数据结构移出程序但仍将其保留在内存中。

# c# - 如何在没有全局变量的情况下保留数据？

> ID：895595
> 
> 赞同：8
> 
> 时间：2009-05-21T22:32:32.437
> 
> 标签：c#, global-variables

我习惯于脚本语言。PHP、Javascript 等，我编写了一些相对简单的 Java 和 C# 应用程序。这是一个我反复需要答案的问题，我想我不是唯一一个。

假设我在 Javascript 中。

我有由 GUI 调用的函数 A()，它检索一些值。

也由 GUI 调用的函数 B() 需要该值，但函数 B() 将被调用任意次数，在 A() 之后的任意时间长度。

我不希望 A() 每次都重新计算值。

一个示例是登录凭据。A() 要求输入用户名，B() 每次调用时都使用该值附加到日志中。

为此，我可能只使用一个全局变量。

现在，C#。没有全局变量！我该怎么做？

**编辑：** 享受答案，但有很多“尽量不要使用全局变量”的评论。我确实理解，但我想听听此要求的替代模式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T22:41:20.830

这不是一个好的做法，但如果你真的需要它，有很多方法：

1.  Web 应用程序：您可以将变量放在某种上下文中，例如会话或应用程序范围。
2.  桌面应用程序：您可以创建对象并将其存储为始终具有活动对象的类的属性。
3.  任何类型的应用程序：使用公共静态属性。每个人都可以看到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T22:40:37.070

首先，总是问自己是否真的需要一个全球性的，通常你不会。但如果你真的必须拥有一个...

最好的方法是在一些合理命名的类上拥有一个静态属性，它实际上成为你的全局变量

```
public class Credentials
{
  public static string Username {get;set;}
}

//...somewhere in your code

Credentials.Username = "MyUserName"; 
```

编辑：

这里有几个人说全局变量不好的笼统声明，我同意这种观点，而且 C# 的设计者似乎也同意，因为它们根本不可用。

然而，我们应该看看 Globals 不好的原因，它们大多被认为是坏的，因为你违反了封装规则。静态数据虽然不一定是坏事，但静态数据的好处是您可以封装它，我上面的示例是一个非常简单的示例，可能在现实世界的场景中，您会将静态数据包含在同一个类中是否可以使用凭据进行其他工作，可能是 Login 类或 User 类或对您的应用有意义的任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:45:08.997

我会说您可能应该使用[Singleton Pattern](http://en.wikipedia.org/wiki/Singleton_pattern)。

如果您要使用多线程应用程序，那么您还需要确保对单例实例属性的访问是线程安全的。

与往常一样，请仔细考虑在您的应用程序中引入任何类型的全局变量，但不要害怕使用它。很多东西确实是全局的，例如 App.Settings 中没有任何“坏”的东西。

MSDN 上的这篇[文章](http://msdn.microsoft.com/en-us/library/ms998558.aspx)解释了如何在 c# 中正确创建单例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:40:40.753

在 C# 中，获得类似于全局变量的行为的方法之一是使用静态类方法和类变量。静态类方法和变量在 C# 中只有一个实例，有点类似于其他语言中的全局变量。

也就是说，对于您的问题，这听起来更像是一个设计问题。C# 非常注重面向对象的设计；我怀疑你给出的问题是更好的OOD会解决你的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T22:42:53.963

函数 A 将是类的一部分（称为 C）。然后，函数 A 可以存储登录凭据并提供一个函数（或在 C# 中，一个属性）来获取凭据。当需要它们时，您可以简单地使用该属性来获取存储的凭据并将它们传递给函数 B（在不同的类上）。

```
class C
{
    public void functionA()
    {
         credentials = obtainCredentials;
    }

    private LogonCredentials _logonCredentials = null;

    public LogonCredentials logonCredentials
    {
        get { return _logonCredentials; }
    }
}

class D
{
    public void functionB(LogonCredentials credentials)
    {
       //do stuff
    }
}

///other stuff
///other function ...
    ...
    instanceC = C();
    instanceC.functionA();
    ///more stuff here
    instangeD = D();
    instanceD.functionB(instanceC.logonCredentials); 
```

# python - 任何人都可以推荐一个支持 OpenType (.OTF) 的 Python PDF 生成器吗？

> ID：895596
> 
> 赞同：4
> 
> 时间：2009-05-21T22:32:35.013
> 
> 标签：python, pdf-generation, opentype

在 11 月问[这个问题](https://stackoverflow.com/questions/279129/can-anyone-recommend-a-decent-foss-pdf-generator-for-python)后，我对 ReportLab 非常满意我所有的 python pdf 生成需求。

然而，事实证明，虽然 ReportLab 将使用常规 TrueType (TTF) 字体，但它不支持 OpenType (OTF) 字体。

我正在处理的当前小部件之一将需要使用一些 OpenType 字体，因此可悲的是，ReportLab 刚刚从运行中删除了自己。

任何人都可以为 Python 推荐一个兼容 OpenType 的 PDF 生成器吗？

它不需要花哨 - 我只需要能够将 UTF-8 文本放到页面上。

* * *

更新：OpenType 字体大致有两种风格：TrueType 风格和 PostScript 风格，这取决于它们存储字形轮廓的方式。ReportLab 只支持 TypeType 样式。事实证明，在 Windows 上，您可以通过扩展名区分：TrueType 样式的 TrueType 和 OpenType 是 .TTF，PostScript 样式的 OpenType 是 .OTF。

所以，我真正的问题是，谁能推荐一个支持 .otf 字体的 Python PDF 生成器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T22:51:45.707

That sort of depends... OpenType was intended to extend TrueType (and [uses the general structure of TrueType internally](http://en.wikipedia.org/wiki/OpenType)) - so much so that some folks have [reported success using OpenType fonts](http://two.pairlist.net/pipermail/reportlab-users/2008-August/007120.html) in reportlab; I suppose it all depends on whether or not there are any special OTF characteristics that your use of the font requires.

In fact, some [comments in the TTFontFile class source for reportlab](http://www.reportlab.org/apis/reportlab/reportlab.pdfbase.ttfonts-pysrc.html) mention OpenType by name, so it's probably worth a shot.

* * *

EDIT: The comments reference an error message that pretty much summarizes the case where reportlab can't support an OTF font. OTF fonts can store outline data in several formats (see the wikipedia link above). In this case, the font appears to be using the CFF format, for which reportlab specifically checks in its font parser, and which reportlab specifically rejects with the error message "postscript outlines are not supported".

That pretty much ends my font and PDF-generator expertise. Sorry! Looking forward to seeing any suggestions of alternatives.

* * *

EDIT 2: Ok, looking at the docs for Django, I see they reference another full PDF api: [pdflib](http://www.pdflib.com/). I have no direct experience with PDFlib, and it's not free (neither price nor license). I also find their docs annoying as I couldn't just see the English API without downloading the whole bloomin package (don't know if there's a free trial or what). I did look at the German docs, though, which ARE mysteriously available for free, separate downlod. My second-language-in-university german did allow me to discern that they claim support for unicode and 8-bit OpenType fonts with postscript outlines.

Do I sound enthused about them? Nope :-) Hopefully someone who uses and loves them will correct me, as I repeat I have no first-hand experience with them. It may be an option if your budget allows and all else fails.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T23:27:48.537

如果 reportlab 有原生的 OTF 支持，那就太好了，但大多数人真正需要的是特定 OpenType 字体的 TrueType 版本。我使用这个 fontforge 脚本将我需要的字体转换为 TrueType 并获得了完美的结果。

来自[http://www.se.eecs.uni-kassel.de/~thm/OpenOffice.org/bugs.html](http://www.se.eecs.uni-kassel.de/~thm/OpenOffice.org/bugs.html)：

```
#!/usr/bin/fontforge
# Quick and dirty hack: converts a font to truetype (.ttf)
Print("Opening "+$1);
Open($1);
Print("Saving "+$1:r+".ttf");
Generate($1:r+".ttf");
Quit(0); 
```

# c# - 如何处理错误数据？

> ID：895600
> 
> 赞同：1
> 
> 时间：2009-05-21T22:33:00.317
> 
> 标签：c#, sanitization

您如何处理需要限制为特定值集的用户输入（unicode），并且您希望将数据传递给应用程序的风险降到最低。例如，如果我要将数据存储在 SQL 中，我希望消除任何 SQL 注入的可能性。如果我要通过 HTTP 通过网络发送它，我想确保它不会使请求不正确，等等。

我想我要问的是有什么通用的数据清理方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:47:42.190

Each interface has its own problems when it comes to ways to compromise the system. If you want to play it safe you will need to tailor the validations to suit the problems and/or threats that are relevant in the current context.

If a certain text box in a user interface should be used for numeric input, make sure that the user cannot type (or paste) anything non-numeric into it. If a certain control is used to collect a date from the user, validate that the given value is indeed a valid date (perhaps it should even fall within a certain range; validate that too).

Make sure to url encode anything that is being passed as a query string value in a http request. Use stored procedures and pass the values as parameters to them.

And so on. There is no free lunch, unfortunately.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T22:39:48.057

如果保存到数据库，这非常简单。只需使用参数（DbParameter 对象） - 它们将保护您免受 SQL 注入，并且在必要时还会添加转义符号。

代码可以是这样的：

```
OleDbConnection cn = new OleDbConnection(strConn);
cn.Open();
strSQL = "INSERT INTO customers (Name) VALUES (@Name)";
OleDbCommand cmd = new OleDbCommand(strSQL, cn);
cmd.Parameters.Add("@Name", "John O'Brian");
cmd.ExecuteNonQuery();
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T01:25:18.657

就像 nightcoder 建议的那样，参数是避免 SQL 注入的方法。但是，如果您使用的是 SQL，请考虑使用 SqlClient 命名空间，因为它比其 OleDb 对应物更有效，并且是专门为 SQL Server 7 及更高版本创建的。

使用 nightcoder 上面的例子：

```
SqlConnection cn = new SqlConnection(strConn);
cn.Open();
strSQL = "INSERT INTO customers (Name) VALUES (@Name)";
SqlCommand cmd = new SqlCommand(strSQL, cn);
cmd.Parameters.Add(new SqlParameter("@Name", SqlDbType.Varchar)).Value = "John O'Brian";
cmd.ExecuteNonQuery(); 
```

关于 SqlClient 命名空间要记住的一点是，如果您正在为旧系统 (Win98) 编写代码，那么可能存在兼容性问题，这使得 OldDBxxx 成为更好的选择。

干杯!

# continuous-integration - 如何清理符号存储？

> ID：895605
> 
> 赞同：4
> 
> 时间：2009-05-21T22:33:53.573
> 
> 标签：continuous-integration, symbols

我们正在从 TFS 运行持续集成构建，并生成大量使用 symstore.exe 存储的符号文件（去年左右价值 67GB）。其他人如何清理他们的符号文件？你自动化这个过程吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T22:49:26.537

[AgeStore](http://msdn.microsoft.com/en-us/library/windows/hardware/ff538002(v=vs.85).aspx)可用于此 - 您可以定期运行它以从旧的日常构建中删除不再使用的符号。但是，您需要确保归档您需要保留更长时间的里程碑或已发布的构建，因为 AgeStore 也会删除它们。

# vim - Screen 的复制模式无法使用类似 Vim 的 CW f

> ID：895608
> 
> 赞同：1
> 
> 时间：2009-05-21T22:36:19.670
> 
> 标签：vim, gnu-screen, copy-mode

我想通过 Screen 的复制模式打开一条到 vim 的路径

```
Ctrl-A f 
```

就像我可以在 Vim 中打开外部文件一样

```
Ctrl-W f 
```

**如何在 Screen 的复制模式下在 Vim 中打开路径？**

* * *

*--- 感谢 Samuil 解决问题*

假设鼠标位于以下代码中的 PATH/file 处，表示屏幕开启时的显示

```
text[space]PATH/file[space]text 
```

我在 PATH/file 处按 ^A f。它应该将文件的 PATH 保存到 /tmp/screenCopyFile 以便我们可以`cat`在以下`^A f`应该启动的命令中使用：

```
^A: exec vim `cat PATH/file` 
```

我手动运行命令失败。它没有扩展 cat 命令，但它打开了一个名为 cat 的文件。

换句话说，我们想让字母`f`代表

```
exec vim `cat /tmp/screenCopyFile` 
```

通过在 .screenrc 中绑定。

**感谢 Rampion 的回答！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T11:03:31.277

我不知道 vim 太好了，但是用一些命令应该很容易完成。当您的粘贴缓冲区中已有文件名时，您可以使用这些有用的命令：

```
^A : writebuf /tmp/.screenpomfile
^A : exec vim parameters 
```

我不知道如何`vim`从文件中读取文件名（我认为这是可能的），但你可以`:exec`用你自己的脚本编写一个能够解析``expr`` 表达式的 shell：

```
#!/bin/sh
vim `cat /tmp/.screenpomfile` 
```

稍后您可以将自己的键绑定到这些操作，并非常有效地使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-02T07:18:59.407

好的，这是一个解决方案：

将以下内容放入`/path/to/edit-file-under-cursor.screen`：

```
# edit-file-under-cursor.screen

# prevent messages from slowing this down
msgminwait 0
# copy path starting at cursor
stuff " Ebe "
# write the path to a file
writebuf /tmp/screen-copied-path
# open that file in vim in a new screen window
screen /bin/sh -c 'vim `cat /tmp/screen-copied-path`'
# turn message waiting back on
msgminwait 1

# vi: ft=screen 
```

然后将此行添加到您的`.screenrc`：

```
# bind CTRL-f to open the file starting at the cursor
# when in copy mode
bindkey -m ^f source /path/to/edit-file-under-cursor.screen 
```

（`/path/to/`适当地改变）

然后，要使用，请确保您重新启动`screen`（或重新加载`.screenrc`）。使用 进入复制模式`^A[`，将光标移至文件名的第一个字符，然后按`CTRL-f`。

我已经对此进行了测试，它对我有用，所以如果您有任何问题，请告诉我。

如果您想了解我是如何知道如何执行此操作的，请`man screen`查看所有各种命令是如何工作的。

可以进行的一项改进是能够找到路径的开头，但仅使用屏幕的复制模式移动命令（例如，移动到“”的第一个`/`移动`/a/path`到`|`“ `|/a/path`”的任何东西）我无法可靠地做到这一点)

这是由于`screen`复制模式下的移动命令的限制：

```
移动键：
  h, j, k, l 逐行或逐列移动光标。
  0、^ 和 $ 移动到最左边的列，移动到该行的第一个或最后一个非空白字符。
  H、M 和 L 将光标移动到窗口顶部、中心或底部线的最左列。
  + 和 - 上下放置一行。
  G 移动到指定的绝对行（默认：缓冲区结束）。
  | 移动到指定的绝对列。
  w, b, e 逐字移动光标。
  B、E 逐字移动光标（如在 vi 中）。
  Cu 和 Cd 将显示向上/向下滚动指定的行数，同时保留光标位置。（默认：半屏全屏）。
  Cb 和 Cf 向上/向下滚动显示全屏。
  g 移动到缓冲区的开头。
  % 跳转到缓冲区的指定百分比。
...
搜索：
  /vi 似的向前搜索。
  ? 类似 vi 的向后搜索。
  Ca s Emacs 风格的增量搜索向前。
  Cr Emacs 风格的反向 i-search。

```

因此，如果我们将`stuff`上面的行更改为

```
stuff "Bw Ebe " 
```

它将移动到路径的开头，但它也将包括路径之前的任何非空白垃圾。因此，只要您的所有路径都是用空格分隔的（在两边），这应该可以工作。

实际上

```
stuff "B//^M E?/^Me " 
```

似乎工作得很好，因为它使用搜索来查找第一个和最后一个`/`（`^M`通过按 CTRL-v 在 vi​​m 中键入，然后输入）。我还没有测试所有的边缘情况，但它似乎适用于：

```
/一条路径
 ＃/一条路径
 /一条路径＃

```

但是，它会失败

```
一个/相对/路径

```

# c - 数组成员被最后一个元素覆盖

> ID：895628
> 
> 赞同：1
> 
> 时间：2009-05-21T22:41:32.093
> 
> 标签：c

使用以下代码，我得到了一个非常奇怪的结果。为什么最后一个元素的值会覆盖所有先前的数组元素？我怀疑有一个比这个直接问题更大的问题。

```
#include <stdio.h>

main()
{
    int i, cases;
    char num[1000000];

    scanf("%d", &cases);
    char* array[cases];

    //store inputs in array
    for(i=0; i<cases; i++)
    {
        scanf("%s", &num);
        array[i] = &num;
    }

    //print out array items and their memory addresses
    for(i=0; i<cases; i++)
    {
        printf("%d %s\n", i, array[i]);  //print (array index) (array value) 
        printf("%d %p\n", i, &array[i]); //print (array index) (array address) 
    }
}

Inputs:
3 <-- number of lines to follow
0   <-- put in array[0]
1   <-- put in array[1]
2   <-- put in array[2]

Outputs
0 3         <-- why is this being overwritten with the last element?
0 0013BCD0
1 3         <-- why is this being overwritten with the last element?
1 0013BCD4
2 3
2 0013BCD8 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T22:46:58.243

The upshot here is the line `array[i] = &num;` you're setting the value of the `array[i]` element to the address of the `num` array; since `array` is a char array, I suspect it's truncating your `num` array address, and the low-order byte just happens to be a 3.

However. That said, your char num[1000000] is hideous form, and you should not do that, at all. Allocate on the heap, and choose a smaller number, for heaven's sake. Also, the scanf("%s", &num) won't actually give you what you want. Here's a hint; use a getc() loop to read the numbers; this avoids needing to do any preallocation of an array for scanf().

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T23:23:50.337

这是因为您在数组的每个索引中都放入了相同的地址（char num[1000000]; 的地址）。

这是一个错误，会导致您进行动态分配（calloc、malloc、new 等）。

干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:46:15.703

在您的第一个循环中，您应该（但不是）将每个输入写入 num 数组的不同元素；相反，您总是写信到同一个地方，即`&num`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:53:46.170

char* array[cases];

This is allocated at compile-time, not run-time. And cases isn't initialized (although I think you want it to work dynamically anyway.) So you either need to preallocate the memory, or get familiar with the malloc family of library functions.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T23:07:17.203

那就是你的代码是固定的：

```
#include <stdio.h>

main(void)
{
    int i, cases;

    scanf("%d", &cases);
    char* array[cases];

    //store inputs in array
    for(i=0; i<cases; i++)
    {
        char *num = malloc(100000);
        scanf("%s", num);
        array[i] = num;
    }

    //print out array items and their memory addresses
    for(i=0; i<cases; i++)
    {
        printf("%d %s\n", i, array[i]);  //print (array index) (array value)
        printf("%d %p\n", i, (void*)&array[i]); //print (array index) (array address)
    }
    return 1;
} 
```

你也可以使用

```
char *num = calloc(100000, sizeof(char)); 
```

这有点防御性。我不知道你为什么需要 100000。你可以使用 malloc 动态地做到这一点。这将涉及更多工作，但非常强大。

您的代码中发生的事情是将字符串 %s 存储到 num 的地址，该地址不会更改，然后将 array[i] 元素分配给该地址。在 C 中分配只是存储引用，您不存储元素本身 - 这将浪费空间。因此，由于所有数组元素都指向地址（仅存储引用），因此地址中的值会发生变化，因此引用也会发生变化，这就是为什么它们都更改为 2（而不是您在帖子中所说的 3）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T00:37:42.980

代替

```
//store inputs in array
for(i=0; i<cases; i++)
{
    scanf("%s", &num);
    array[i] = &num;
} 
```

和

```
array[0] = num;
//store inputs in array
for(i=0; i<cases; i++)
{
    scanf("%s", array[i]);
    array[i+1] = array[i] + strlen(array[i]) + 1;
} 
```

将每个字符串扫描到 中的第一个可用空间`num[]`，并将 的下一个元素设置`array[]`为指向下一个可用空间。现在你`printf()`的字符串可以工作了。原始文件将每个字符串扫描到`num[]`.

注意：不`scanf()`加修饰`%s`和 一样糟糕`gets()`，因为它对将被吞入的数据量没有限制。不要在实际代码中使用它。

代替

```
 printf("%d %p\n", i, &array[i]); //print (array index) (array address) 
```

和

```
 printf("%d %p\n", i, (void*)(array[i])); //print (array index) (array address) 
```

实际打印存储在 中的地址`a[]`，而不是 的元素的地址`a[]`。强制转换是必需的，因为`%p`需要一个指针，`void`因此您必须提供一个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T16:16:10.350

C++ 似乎就是为这样的事情而制作的。用户输入解析和动态分配更安全，更轻松。我想不出一个系统，你有那种用户界面，你不能切换到 C++。

当然，如果这只是其他存在问题的代码的测试摘录，那么当然......

* * *

对于 C 初学者来说，你的代码存在几个常见的错误，以及现在不应该这样做的事情。

如果我理解正确，您想保存 sereval 用户输入字符串（您的示例输出有点误导，因为您只显示数字）。

您正在准备数组以保存指向字符串的所有（案例计数）指针，但您只为一个字符串保留内存。你需要对每个字符串都这样做，所以情况。为了在“动态内存分配”课程中保持简单，我建议这样做：`char* array[cases][10000];`这会给你 10k 个字符的 case 字符串。

您可能也不希望有指向数组元素的单独指针。如果要在数组元素大于指针本身时对数组元素进行排序，这开始有意义。在这种情况下，您的性​​能提升不是移动（复制）大块，而是只有指针（通常是 4 个字节）。在您的情况下， int 也是 4 个字节长。而且你无论如何都不排序:)

`scanf()`至少可以说是危险的。在您的第二个应用程序中，您指示它将一个字符串写入数组的地址。这似乎是一个简单的错误，但会导致很多问题。你可能想这样做：（`scanf("%d", &array[i]);`不幸的是，我手头没有编译器，所以我不是 100% 确定）。删除下一行:)

* * *

向 Markdown 专家提出的问题：为什么将 LISTS 与 CODE-blocks 结合起来如此该死？

# database - 如何有效地存储/访问翻译？

> ID：895633
> 
> 赞同：0
> 
> 时间：2009-05-21T22:42:09.970
> 
> 标签：database, internationalization

我正在尝试将我网站上的一些短语翻译成各种语言。所以，在我的数据库中，我有一个包含行的表

ID//文本//dest_language//text_in_dest_language

目前，我一一检索每个翻译：

获取 text_in_dest_language 其中 text="Hello World" 和 dest_languge="zh"

这导致每页 40-50 db 调用，这在应用引擎上相当慢。

我能做些什么来缓解这种放缓？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:46:37.497

1.  Cache them in the application server layer (in ASP.NET, you can store it in the Application object or in the Session object).

or

2.  Make a single DB call to get a single recordset of all the phrases used in the page.

# python - 求帮助，今天刚开始接触Python。(3.0)

> ID：895637
> 
> 赞同：1
> 
> 时间：2009-05-21T22:45:27.747
> 
> 标签：python, python-3.x

我只是想进入 python，但我发现很难找到 Python 3 的任何资源。到目前为止，我所拥有的只是diveintopython3.org，而且它是有限的。无论如何，我只是想通过做一些非常基本的事情来感受一下这门语言，但我不明白为什么这个小程序不会做我想要的，那就是添加 2 个数字。我敢肯定这里有人知道如何修复它，但任何其他包含 Python 3 教程的资源将不胜感激：

```
def add(num=0,num2=0):
    sumEm = (num+num2)
    print (sumEm)

if __name__ == '__main__':
    num = input("Enter a number: ")
    num2 = input("Enter a number: ")
    add(num,num2) 
```

输出：

```
Enter a number: 23
Enter a number: 24
23
24 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T22:50:00.563

[A Byte of Python](http://www.swaroopch.com/notes/Python_en:Table_of_Contents)详细介绍了 Python 3。这本书还有一个 2.X 版本，可以帮助比较和对比语言的差异。

要解决您的问题，您需要将输入转换为整数。它默认存储为字符串。

```
num = int(input("Enter a number: "))
num2 = int(input("Enter a number: ")) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T22:53:31.087

你没有说你*得到*了什么- 我猜测`num`并`num2`连接，因为[`input`](http://docs.python.org/3.0/library/functions.html#input)返回一个字符串。添加两个字符串只是将它们连接起来。如果您期望`num`并`num2`表示整数，则可以使用[`int`](http://docs.python.org/3.0/library/functions.html#int)将字符串转换为整数：

```
num = int(input("Enter a number:")
num2 = int(input("Enter a number:") 
```

你可能会得到更好的结果。请注意，仍有更好的错误检查空间，但这可能会让您入门。

要尝试的另一件事-在您的末尾添加一行，`__main__`如下所示：

```
add(4, 3) 
```

看看打印了什么。这将告诉您故障是与您的输入例程有关`add`还是与您的输入例程有关。

当然，这些都没有为您提供资源——在线文档没有帮助吗？如果您还没有，我将从[教程开始。](http://docs.python.org/3.0/tutorial/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T22:59:46.190

有趣，3 个答案，但没有一个能正确解决您的问题。

您所要做的就是：

```
def add(num=0,num2=0):
    sumEm = (int(num)+int(num2)) # may need the int() because in python 3.0 the manual says it only returns strings
    return sumEm # use return here not print 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T22:54:11.007

Mark Summerfield 有一本 Addison-Wesley 的书，名为“Programming in Python 3”，我发现它是我读过的最好的 Python 书。我想对你来说一件好事是，Summerfield 没有提出 2.X 和 3.x 之间的差异，所以刚开始使用 Python 的人可以不间断地了解（新的和改进的）Python。除此之外，他还解释了其他书籍——在我的情况下是 1.X ——要么从未触及或（我认为）错误陈述的事情。关于自定义异常的段落让我摆脱了困境，他将 * 和 ** 作为拆包操作员的处理方式为我清除了相当大的精神迷雾。一流的书。

顺便说一句，有一个名为 sys 的模块可以做一些有用的事情，比如让你访问命令行参数。这些 args 是（子）字符串，前几天我不得不使用 int()，正如评论者 dkbits 所说，使用它们。（type() 函数告诉你 Python 认为变量是什么类型。）我有：

```
import sys

#Parse the command line.
if len(sys.argv) != 4:
    print "Usage: commandName maxValueInCell targetSum nCellsInGroup"
    exit()
else:
    maxv = int( sys.argv[1])
    tgt = int( sys.argv[2])
    nc = int( sys.argv[3])
print "maxv =",maxv, "; tgt = ",tgt, "; nc = ",nc
print type(sys.argv[1])   #strings
print type(sys.argv[2])
print type(sys.argv[3])
print type(maxv)          #ints
print type(tgt)
print type(nc) 
```

# java - Java 等效于 OpenLayers

> ID：895653
> 
> 赞同：9
> 
> 时间：2009-05-21T22:49:20.267
> 
> 标签：java, api, swing, gis, geotools

我正在寻找一个 Java 库来显示来自各种来源的地图数据，包括 shapefile、WMS、WFS、Google 地图，可能还有 ArcIMS 等。似乎 OpenLayers 是最接近我想要的东西，除了它是一个 JavaScript 库，并且我正在编写一个 Swing 应用程序。

GDAL 看起来很有希望，但据我所知，在未来“某个时候”之前不会有 Java 绑定。

为了清楚起见，我正在寻找一个单一的 Java API，我可以使用它来显示来自多个地图服务器/源的地图。

有谁知道这样的事情是否存在，如果没有，从这里去哪里？我应该在 GeoTools 之上构建这个 API 吗？或者...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T23:00:27.933

GeoTools 是一个不错的选择。Google Maps[服务条款](http://code.google.com/apis/maps/terms.html)禁止访问 Google Maps 磁贴，除非通过 (JavaScript) Google Maps API，因此您不太可能找到免费可用的代码库来在 Java 应用程序中访问它们。类似的限制可能适用于其他商业层。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-06T13:58:17.883

这是一个你有很多选择的情况。GeoTools 确实是一个低级库，是一些动手工作的绝佳选择。我们最近开始在示例代码中使用 Swing，以使教程[更加直观](http://geotoolsnews.blogspot.com/2009/11/foss4g-geotools-tutorials.html)。也就是说，它们只是教程代码，并不代表 uDig 等多线程系统。

如果您正在寻找从 Swing 应用程序开始的形式，那么 Jump 家族（遗憾的是分散在一个封闭的开发过程中 - OpenJump 代表了各种分叉的集合）、在 Span 中拥有出色财务支持的 gvSig 等等。

您可能还希望查看 deegree 项目的库方面（我似乎记得它也生成了一个桌面应用程序？）。

我还建议查看一些围绕 Nasa World Wind 和 Open Street Map 数据集制作的平铺地图查看器。这些将更类似于 OpenLayers 体验。

免责声明我是 GeoTools 和 uDig 指导委员会的成员。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T13:46:16.310

如果您可以在 RCP 框架内工作，uDig 可能会很好地满足您的需求。我对 uDig 或 NASA World Wind 没有任何经验，但如果您需要将地图功能放入现有应用程序中，[NASA 的 World Wind Java SDK](http://worldwind.arc.nasa.gov/java/index.html)是另一种选择。它是可扩展的并支持地理空间数据的行业标准。他们在[这里](http://worldwindcentral.com/wiki/Java)有一个内容丰富的 wiki 。我第一次看到 NASA World Wind 是在 JavaOne 2007 上，它看起来 Java SDK 并没有真正起飞，看起来 .Net 版本也没有看到很多新版本，但如果它们是基本的，它可以满足您的需求.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-23T03:58:26.020

[OpenMap](http://www.openmap.org/)应该是相当不错的。

警告：他们使用的“开放”许可证被 Fedora 和 GNU[认为](http://www.mail-archive.com/legal@lists.fedoraproject.org/msg00173.html) [是非免费的。](http://www.gnu.org/licenses/license-list.html#ArtisticLicense)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T07:57:28.103

我使用[MapXtreme for Java](http://www.mapinfo.com/products/developer-tools/desktop%2c-mobile-%26-internet-offering/mapxtreme-java)，它非常好，支持多种格式。它并不便宜，但它提供。

它适用于渲染矢量数据格式。

您可以在服务器端或客户端使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T11:03:31.737

尝试 java 的 mapscript www.mapserver.org

铜

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T06:37:12.293

看看UDig

[http://udig.refractions.net/](http://udig.refractions.net/)

它基于 eclipse RCP 与 Geotools 配合使用，可以显示大多数类型的空间数据。

它是开源的，似乎有相当多的活动

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-24T19:39:11.323

[ArcGIS Engine Java](http://www.esri.com/software/arcgis/arcgisengine/index.html)将满足您的需求。它集成到一个完全集成的 GIS 平台中。有一些工具可以创建制图质量地图、发布它们、托管它们或构建自定义应用程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-18T19:22:36.137

它不能处理您提到的所有格式，但我成功地使用了用于[处理的](http://processing.org/learning/eclipse/)[适度地图显示了 Web 地图（在](http://modestmaps.com/)[此处](http://www.tom-carden.co.uk/wp-content/uploads/2008/11/modest_maps_interactive.zip)找到它）。处理 PApplet 可以嵌入到摆动 GUI 中，如此[处](http://forum.processing.org/topic/how-to-embed-processing-into-java-awt-based-gui)所述。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-03T15:06:14.723

如果您可以在 Java swing 应用程序中嵌入 Web 浏览器，则可以使用 GoogleMaps，尝试 JDIC 或 DJ Project。另请参阅[有没有办法在 Java 中嵌入浏览器？](https://stackoverflow.com/questions/48249/is-there-a-way-to-embed-a-browser-in-java)我一直在使用 C# 中的此类解决方案 - 嵌入 IE。但是，您必须嵌入一个好的网络浏览器，通常是一些本地网络浏览器，这限制了您的此类解决方案。

# jquery - How do I block or restrict special characters from input fields with jquery?

> ID：895659
> 
> 赞同：137
> 
> 时间：2009-05-21T22:50:42.293
> 
> 标签：jquery, special-characters, alphanumeric

How do I block special characters from being typed into an input field with jquery?

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-01-12T10:52:42.777

一个使用正则表达式的简单示例，您可以更改为允许/禁止任何您喜欢的内容。

```
$('input').on('keypress', function (event) {
    var regex = new RegExp("^[a-zA-Z0-9]+$");
    var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
    if (!regex.test(key)) {
       event.preventDefault();
       return false;
    }
}); 
```

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-02-06T00:59:37.907

我正在寻找一个将输入限制为仅字母数字字符的答案，但仍允许使用控制字符（例如，退格、删除、制表符）和复制+粘贴。我尝试提供的答案都没有满足所有这些要求，因此我使用该`input`事件提出了以下问题。

```
$('input').on('input', function() {
  $(this).val($(this).val().replace(/[^a-z0-9]/gi, ''));
}); 
```

**编辑：**
正如[rinogo](https://stackoverflow.com/questions/895659/how-do-i-block-or-restrict-special-characters-from-input-fields-with-jquery/14719818#comment26555967_14719818)在评论中指出的那样，上面的代码片段在输入文本的中间键入时强制光标到输入的末尾。我相信下面的代码片段可以解决这个问题。

```
$('input').on('input', function() {
  var c = this.selectionStart,
      r = /[^a-z0-9]/gi,
      v = $(this).val();
  if(r.test(v)) {
    $(this).val(v.replace(r, ''));
    c--;
  }
  this.setSelectionRange(c, c);
}); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2013-02-07T11:55:08.297

**简短回答：**防止“按键”事件：

```
$("input").keypress(function(e){
    var charCode = !e.charCode ? e.which : e.charCode;

    if(/* Test for special character */ )
        e.preventDefault();
}) 
```

**长答案：**使用像[jquery.alphanum这样的插件](https://github.com/KevinSheedy/jquery.alphanum)

选择解决方案时需要考虑几件事：

*   粘贴文本
*   上面的代码可能会阻止退格或 F5 等控制字符。
*   é、í、ä 等
*   阿拉伯文或中文...
*   跨浏览器兼容性

我认为这个领域足够复杂，可以保证使用 3rd 方插件。我尝试了几个可用的插件，但发现每个插件都有一些问题，所以我继续编写[jquery.alphanum](https://github.com/KevinSheedy/jquery.alphanum)。代码如下所示：

```
$("input").alphanum(); 
```

或者为了更细粒度的控制，添加一些设置：

```
$("#username").alphanum({
    allow      : "€$£",
    disallow   : "xyz",
    allowUpper : false
}); 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-03-04T20:08:24.110

使用 HTML5 的模式输入属性！

```
<input type="text" pattern="^[a-zA-Z0-9]+$" /> 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-06-28T21:21:49.137

使用正则表达式来允许/禁止任何事情。此外，对于一个比接受的答案更强大的版本，允许没有与之关联的键值的字符（退格键、制表符、箭头键、删除等）可以通过首先传递 keypress 事件和根据键码而不是值检查键。

```
$('#input').bind('keydown', function (event) {
        switch (event.keyCode) {
            case 8:  // Backspace
            case 9:  // Tab
            case 13: // Enter
            case 37: // Left
            case 38: // Up
            case 39: // Right
            case 40: // Down
            break;
            default:
            var regex = new RegExp("^[a-zA-Z0-9.,/ $@()]+$");
            var key = event.key;
            if (!regex.test(key)) {
                event.preventDefault();
                return false;
            }
            break;
        }
}); 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2017-07-10T15:44:07.570

你的文本框：

```
<input type="text" id="name"> 
```

你的JavaScript：

```
$("#name").keypress(function(event) {
    var character = String.fromCharCode(event.keyCode);
    return isValid(character);     
});

function isValid(str) {
    return !/[~`!@#$%\^&*()+=\-\[\]\\';,/{}|\\":<>\?]/g.test(str);
} 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2021-01-19T04:15:22.080

使用简单的 onkeypress 事件内联。

```
 <input type="text" name="count"  onkeypress="return /[0-9a-zA-Z]/i.test(event.key)">
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-05-21T23:07:37.860

看看 jQuery 字母数字插件。[https://github.com/KevinSheedy/jquery.alphanum](https://github.com/KevinSheedy/jquery.alphanum)

```
//All of these are from their demo page
//only numbers and alpha characters
$('.sample1').alphanumeric();
//only numeric
$('.sample4').numeric();
//only numeric and the .
$('.sample5').numeric({allow:"."});
//all alphanumeric except the . 1 and a
$('.sample6').alphanumeric({ichars:'.1a'}); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-21T23:02:35.700

this is an example that prevent the user from typing the character "a"

```
$(function() {
$('input:text').keydown(function(e) {
if(e.keyCode==65)
    return false;

});
}); 
```

key codes refrence here:
[http://www.expandinghead.net/keycode.html](http://www.expandinghead.net/keycode.html)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-10-03T15:13:38.857

我使用此代码修改我看到的其他代码。只有在按键或粘贴的文本通过模式测试（匹配）时才向用户写入（此示例是仅允许 8 位数字的文本输入）

```
$("input").on("keypress paste", function(e){
    var c = this.selectionStart, v = $(this).val();
    if (e.type == "keypress")
        var key = String.fromCharCode(!e.charCode ? e.which : e.charCode)
    else
        var key = e.originalEvent.clipboardData.getData('Text')
    var val = v.substr(0, c) + key + v.substr(c, v.length)
    if (!val.match(/\d{0,8}/) || val.match(/\d{0,8}/).toString() != val) {
        e.preventDefault()
        return false
    }
}) 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-02-12T12:03:53.593

```
$(function(){
      $('input').keyup(function(){
        var input_val = $(this).val();
        var inputRGEX = /^[a-zA-Z0-9]*$/;
        var inputResult = inputRGEX.test(input_val);
          if(!(inputResult))
          {     
            this.value = this.value.replace(/[^a-z0-9\s]/gi, '');
          }
       });
    }); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-05-23T05:49:56.227

在文本框的 onkeypress 事件上编写一些 javascript 代码。根据要求允许和限制文本框中的字符

```
function isNumberKeyWithStar(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57) && charCode != 42)
        return false;
    return true;
}
function isNumberKey(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;
    return true;
}
function isNumberKeyForAmount(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57) && charCode != 46)
        return false;
    return true;
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-06-12T18:54:50.703

替换特殊字符，空格并转换为小写

```
$(document).ready(function (){
  $(document).on("keyup", "#Id", function () {
  $("#Id").val($("#Id").val().replace(/[^a-z0-9\s]/gi, '').replace(/[_\s]/g, '').toLowerCase());
 }); 
}); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-01-15T10:20:17.570

想评论亚历克斯对戴尔回答的评论。不可能（首先需要多少“代表”？这不会很快发生......奇怪的系统。）所以作为答案：

可以通过将 \b 添加到正则表达式定义来添加退格，如下所示：[a-zA-Z0-9\b]。或者您只是允许整个拉丁语范围，或多或少包括任何“非异国情调”字符（也可以控制退格等字符）：^[\u0000-\u024F\u20AC]+$

只有在拉丁语之外的真正的 unicode char 有欧元符号（20ac），添加您可能需要的任何其他内容。

要处理通过复制和粘贴输入的输入，只需绑定到“更改”事件并检查那里的输入 - 删除它或删除它/给出错误消息，如“不支持的字符”..

```
if (!regex.test($j(this).val())) {
  alert('your input contained not supported characters');
  $j(this).val('');
  return false;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-07-30T14:18:32.457

只是数字：

> $('input.time').keydown(function(e) { if(e.keyCode>=48 && e.keyCode<=57) { return true; } else { return false; } });

或时间包括“：”

> $('input.time').keydown(function(e) { if(e.keyCode>=48 && e.keyCode<=58) { return true; } else { return false; } });

还包括删除和退格：

> $('input.time').keydown(function(e) { if((e.keyCode>=46 && e.keyCode<=58) || e.keyCode==8) { return true; } else { return错误的; } }）;

不幸的是没有让它在 iMAC 上工作

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-09-20T06:58:26.310

是的，你可以通过使用 jQuery 来做到：

```
<script>
$(document).ready(function()
{
    $("#username").blur(function()
    {
        //remove all the class add the messagebox classes and start fading
        $("#msgbox").removeClass().addClass('messagebox').text('Checking...').fadeIn("slow");
        //check the username exists or not from ajax
        $.post("user_availability.php",{ user_name:$(this).val() } ,function(data)
        {
          if(data=='empty') // if username is empty
          {
            $("#msgbox").fadeTo(200,0.1,function() //start fading the messagebox
            { 
              //add message and change the class of the box and start fading
              $(this).html('Empty user id is not allowed').addClass('messageboxerror').fadeTo(900,1);
            });
          }
          else if(data=='invalid') // if special characters used in username
          {
            $("#msgbox").fadeTo(200,0.1,function() //start fading the messagebox
            { 
              //add message and change the class of the box and start fading
              $(this).html('Sorry, only letters (a-z), numbers (0-9), and periods (.) are allowed.').addClass('messageboxerror').fadeTo(900,1);
            });
          }
          else if(data=='no') // if username not avaiable
          {
            $("#msgbox").fadeTo(200,0.1,function() //start fading the messagebox
            { 
              //add message and change the class of the box and start fading
              $(this).html('User id already exists').addClass('messageboxerror').fadeTo(900,1);
            });     
          }
          else
          {
            $("#msgbox").fadeTo(200,0.1,function()  //start fading the messagebox
            { 
              //add message and change the class of the box and start fading
              $(this).html('User id available to register').addClass('messageboxok').fadeTo(900,1); 
            });
          }

        });

    });
});
</script>
<input type="text" id="username" name="username"/><span id="msgbox" style="display:none"></span> 
```

您的**user_availability.php**的脚本将是：

```
<?php
include'includes/config.php';

//value got from the get method
$user_name = trim($_POST['user_name']);

if($user_name == ''){
    echo "empty";
}elseif(preg_match('/[\'^£$%&*()}{@#~?><>,|=_+¬-]/', $user_name)){
    echo "invalid";
}else{
    $select = mysql_query("SELECT user_id FROM staff");

    $i=0;
    //this varible contains the array of existing users
    while($fetch = mysql_fetch_array($select)){
        $existing_users[$i] = $fetch['user_id'];
        $i++;
    }

    //checking weather user exists or not in $existing_users array
    if (in_array($user_name, $existing_users))
    {
        //user name is not availble
        echo "no";
    } 
    else
    {
        //user name is available
        echo "yes";
    }
}
?> 
```

我试图添加**/**和**\**但没有成功。

* * *

您也可以使用 javascript 来完成此操作，代码将是：

```
<!-- Check special characters in username start -->
<script language="javascript" type="text/javascript">
function check(e) {
    var keynum
    var keychar
    var numcheck
    // For Internet Explorer
    if (window.event) {
        keynum = e.keyCode;
    }
    // For Netscape/Firefox/Opera
    else if (e.which) {
        keynum = e.which;
    }
    keychar = String.fromCharCode(keynum);
    //List of special characters you want to restrict
    if (keychar == "'" || keychar == "`" || keychar =="!" || keychar =="@" || keychar =="#" || keychar =="$" || keychar =="%" || keychar =="^" || keychar =="&" || keychar =="*" || keychar =="(" || keychar ==")" || keychar =="-" || keychar =="_" || keychar =="+" || keychar =="=" || keychar =="/" || keychar =="~" || keychar =="<" || keychar ==">" || keychar =="," || keychar ==";" || keychar ==":" || keychar =="|" || keychar =="?" || keychar =="{" || keychar =="}" || keychar =="[" || keychar =="]" || keychar =="¬" || keychar =="£" || keychar =='"' || keychar =="\\") {
        return false;
    } else {
        return true;
    }
}
</script>
<!-- Check special characters in username end -->

<!-- in your form -->
    User id : <input type="text" id="txtname" name="txtname" onkeypress="return check(event)"/> 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-06-30T07:53:24.100

> 您不需要 jQuery 来执行此操作

您可以使用纯 JavaScript 来实现这一点，您可以将其放入`onKeyUp`事件中。

**限制 - 特殊字符**

```
e.target.value = e.target.value.replace(/[^\w]|_/g, '').toLowerCase() 
```

**接受 - 仅数字**

```
e.target.value = e.target.value.replace(/[^0-9]/g, '').toLowerCase() 
```

**接受 - 仅限小字母**

```
e.target.value = e.target.value.replace(/[^0-9]/g, '').toLowerCase() 
```

我可以写一些更多的场景，但我必须保持具体的答案。

**注意**它适用于 jquery、react、angular 等。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-09-07T12:15:13.993

```
 $(this).val($(this).val().replace(/[^0-9\.]/g,''));
    if( $(this).val().indexOf('.') == 0){

        $(this).val("");

    } 
```

//这是最简单的方法

indexof 用于验证输入是否以“.”开头

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-05-16T15:34:28.747

限制按键上的特殊字符。这是关键代码的测试页面：[http ://www.asquare.net/javascript/tests/KeyCode.html](http://www.asquare.net/javascript/tests/KeyCode.html)

```
var specialChars = [62,33,36,64,35,37,94,38,42,40,41];

some_element.bind("keypress", function(event) {
// prevent if in array
   if($.inArray(event.which,specialChars) != -1) {
       event.preventDefault();
   }
}); 
```

在 Angular 中，我需要在我的文本字段中使用正确的货币格式。我的解决方案：

```
var angularApp = angular.module('Application', []);

...

// new angular directive
angularApp.directive('onlyNum', function() {
    return function( scope, element, attrs) {

        var specialChars = [62,33,36,64,35,37,94,38,42,40,41];

        // prevent these special characters
        element.bind("keypress", function(event) {
            if($.inArray(event.which,specialChars) != -1) {
                prevent( scope, event, attrs)
             }
        });

        var allowableKeys = [8,9,37,39,46,48,49,50,51,52,53,54,55,56
            ,57,96,97,98,99,100,101,102,103,104,105,110,190];

        element.bind("keydown", function(event) {
            if($.inArray(event.which,allowableKeys) == -1) {
                prevent( scope, event, attrs)
            }
        });
    };
})

// scope.$apply makes angular aware of your changes
function prevent( scope, event, attrs) {
    scope.$apply(function(){
        scope.$eval(attrs.onlyNum);
        event.preventDefault();
    });
    event.preventDefault();
} 
```

在 html 中添加指令

```
<input only-num type="text" maxlength="10" id="amount" placeholder="$XXXX.XX"
   autocomplete="off" ng-model="vm.amount" ng-change="vm.updateRequest()"> 
```

在相应的角度控制器中，我只允许只有 1 个句点，将文本转换为数字并在“模糊”上添加数字舍入

```
...

this.updateRequest = function() {
    amount = $scope.amount;
    if (amount != undefined) {
        document.getElementById('spcf').onkeypress = function (e) {
        // only allow one period in currency
        if (e.keyCode === 46 && this.value.split('.').length === 2) {
            return false;
        }
    }
    // Remove "." When Last Character and round the number on blur
    $("#amount").on("blur", function() {
      if (this.value.charAt(this.value.length-1) == ".") {
          this.value.replace(".","");
          $("#amount").val(this.value);
      }
      var num = parseFloat(this.value);
      // check for 'NaN' if its safe continue
      if (!isNaN(num)) {
        var num = (Math.round(parseFloat(this.value) * 100) / 100).toFixed(2);
        $("#amount").val(num);
      }
    });
    this.data.amountRequested = Math.round(parseFloat(amount) * 100) / 100;
}

... 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-10-15T22:14:20.887

在 HTML 中：

```
<input type="text" (keypress)="omitSpecialChar($event)"/> 
```

在 JS 中：

```
omitSpecialChar(event) {
    const keyPressed = String.fromCharCode(event.keyCode);
    const verifyKeyPressed = /^[a-zA-Z\' \u00C0-\u00FF]*$/.test(keyPressed);
    return verifyKeyPressed === true;
} 
```

在此示例中，可以键入重音符号。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-05-19T13:24:50.920

```
/**
     * Forbids special characters and decimals
     * Allows numbers only
     * */
    const numbersOnly = (evt) => {

        let charCode = (evt.which) ? evt.which : evt.keyCode;
        if (charCode === 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {
            return false;
        }

        let inputResult = /^[0-9]*$/.test(evt.target.value);
        if (!inputResult) {
            evt.target.value = evt.target.value.replace(/[^a-z0-9\s]/gi, '');
        }

        return true;
    } 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-01-24T08:04:45.703

**仅允许 TextBox 中的数字（限制字母和特殊字符）**

```
 /*code: 48-57 Numbers
          8  - Backspace,
          35 - home key, 36 - End key
          37-40: Arrow keys, 46 - Delete key*/
        function restrictAlphabets(e){
            var x=e.which||e.keycode;
            if((x>=48 && x<=57) || x==8 ||
                (x>=35 && x<=40)|| x==46)
                return true;
            else
                return false;
        } 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2017-01-20T16:39:22.010

```
[User below code to restrict special character also    

$(h.txtAmount).keydown(function (event) {
        if (event.shiftKey) {
            event.preventDefault();
        }
        if (event.keyCode == 46 || event.keyCode == 8) {
        }
        else {
            if (event.keyCode < 95) {
                if (event.keyCode < 48 || event.keyCode > 57) {
                    event.preventDefault();
                }
            }
            else {
                if (event.keyCode < 96 || event.keyCode > 105) {
                    event.preventDefault();
                }
            }
        }

    });] 
```

# forms - 接收一些无意义的垃圾邮件 - 它的目的是什么？

> ID：895661
> 
> 赞同：5
> 
> 时间：2009-05-21T22:50:45.443
> 
> 标签：forms, spam, spam-prevention

从技术上讲，这可能不属于编程问题，因为我已经实现了一个解决方案。但这仍然是技术领域的一个有趣问题。

无论如何...我设置了一个基本的联系表格，没有任何垃圾邮件保护。在发现它不起作用时，我忽略了它并设置了一个 Javascript 来更改所有指向联系页面的链接以使用 mailto: 链接。（我打算用有关与我联系的适当消息替换该表单。）我昨天发现该表单现在突然起作用了，因为我从中收到了垃圾邮件。这是一个例子：

> 从联系表格收到的消息。
> 
> **姓名**：`pvenvoqks`
> **电子邮件**：`allceh@bxyzsn.com`
> 
> **留言**：`Mx7orZ iafgvohkzxmv, [url=http://wxmrsloamyhf.com/]wxmrsloamyhf[/url], [link=http://gloukuwmttnj.com/]gloukuwmttnj[/link], http://vmekxmqouktx.com/`

这显然只是胡言乱语。我检查了链接，但它们不起作用。似乎有一个机器人只是在表单中提交随机数据——尽管请注意，它设法发现应该在适当的字段中提交一封电子邮件。

我的问题是，**这种垃圾邮件是否有目的？**我会理解这些链接是否会指向真正的药物或恶意软件网站，但它们不会。它似乎完全随机。

另外：如果有人感兴趣，我使用“隐藏字段”解决方案来对抗垃圾邮件。我使用了一个名为“网站”的隐藏字段，如果填写，则不会发送电子邮件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-07-14T16:18:51.953

这是我在另一个网站上发现的似乎有道理的东西：

“我可能是错的，但我认为这些是黑帽 SEO 垃圾邮件发送者，他们正在寻找博客评论表单或 Wiki。通过使用随机生成的独特“词”，他们可以进行谷歌搜索，以找到其内容未经审核发布的网站。

然后他们可以返回这些网站，确定是否在没有 rel="nofollow" 属性的情况下发布了链接（这将阻止他们对 Google 的算法做出贡献），如果没有，他们可以在这些网站上发布他们喜欢的任何垃圾邮件链接，为了提高某些网站的谷歌排名。或者更糟的是，用它在这些网站上发布他们想要的任何内容（嵌入式恶意软件？）

所以我认为这与邮件服务器漏洞和更多网站漏洞的关系不大。”

来源 [http://www.aota.net/forums/showthread.php?t=25205](http://www.aota.net/forums/showthread.php?t=25205)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-22T04:08:24.807

一种可能是发送这种乱七八糟的垃圾邮件是为了误导垃圾邮件过滤器并降低其有效性。一些垃圾邮件过滤器旨在更改其策略和设置以响应他们收到的数据——过滤器捕获哪些垃圾邮件，以及用户标记为垃圾邮件的内容。这只是为了混淆事物并添加垃圾数据点 - 实质上是向垃圾邮件过滤器发送垃圾邮件！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:54:36.090

电子邮件的目的可能是确定您的地址是否被退回，如果没有，则该地址可能会被转售。

也可能是 URL 在过去的某一时刻有效，但已被删除。

# vim - 如何在没有 python 或 ruby 的情况下在 Vim 中获取计数器变量？

> ID：895663
> 
> 赞同：6
> 
> 时间：2009-05-21T22:51:20.090
> 
> 标签：vim, macros, repeat

我没有启用 python/ruby。我的问题：我经常需要写如下内容：

```
%macro(200701);x gzip /home/test/200701.txt;run;
%macro(200702);x gzip /home/test/200702.txt;run;
%macro(200703);x gzip /home/test/200703.txt;run;
%macro(200704);x gzip /home/test/200704.txt;run;
%macro(200705);x gzip /home/test/200705.txt;run;
%macro(200706);x gzip /home/test/200706.txt;run;
%macro(200707);x gzip /home/test/200707.txt;run;
%macro(200708);x gzip /home/test/200708.txt;run;
%macro(200709);x gzip /home/test/200709.txt;run;
%macro(200710);x gzip /home/test/200710.txt;run;
%macro(200711);x gzip /home/test/200711.txt;run;
%macro(200712);x gzip /home/test/200712.txt;run;

%macro(200801);x gzip /home/test/200801.txt;run;
%macro(200802);x gzip /home/test/200802.txt;run;
%macro(200803);x gzip /home/test/200803.txt;run;
%macro(200804);x gzip /home/test/200804.txt;run;
%macro(200805);x gzip /home/test/200805.txt;run;
%macro(200806);x gzip /home/test/200806.txt;run;
%macro(200807);x gzip /home/test/200807.txt;run;
%macro(200808);x gzip /home/test/200808.txt;run;
%macro(200809);x gzip /home/test/200809.txt;run;
%macro(200810);x gzip /home/test/200810.txt;run;
%macro(200811);x gzip /home/test/200811.txt;run;
%macro(200812);x gzip /home/test/200812.txt;run; 
```

在 Vim 中有没有快速的方法来做到这一点？

我通常会输入：

```
%macro(200701);x gzip /home/test/200701.txt;run; 
```

然后发出以下命令：

```
yy11p10<up>13<right>r2<down>r3<down>r4<down>... 
```

所以换句话说，我再粘贴 11 次该行，然后使用“替换字符”命令遍历日期列表。然后我将复制整个块并在新块中输入

```
:s/2007/2008/<enter>12&11<up>12& 
```

在第二个区块中用 2007 代替 2008。

Vim 是如此强大，我认为必须有一种更好的方法，然后不断手动替换每行上的 1 到 12。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T23:03:20.863

写第一行：

```
%macro(200701);x gzip /home/test/200701.txt;run; 
```

然后，仍然在该行上，进入命令模式并记录一个宏*a*复制该行 ( `yyp`)，增加第一个数字 (ctrl-a,written `^A`)，将一个字符向右移动 ( `l`)，然后增加另一个数字：

```
qayyp^Al^Aq 
```

（请注意，开始和停止宏录制发生在*。*`q`）现在播放宏110 次：

 *```
110@a 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T02:00:35.437

也可以使用 vim 7 函数来完成：

```
:let t=map(range(200801,200815), '"macro(".v:val.");x gzip /home/test/".v:val.".txt;run;"')
:put=t 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-22T07:01:21.453

如果您拥有 Unix/Linux 核心实用程序，那么有一种方法更容易记住，至少在您习惯使用块命令的情况下：

(1) 使用 seq(1) 生成序列

```
:r!seq 200801 200812 
```

seq 还允许像这样格式化：

```
:r!seq -f "\%03.0f"  10 121 
```

百分号必须转义。

(2) 用 Vim 块命令将该块加倍：Mark with Cv, yank, put

(3) 在这些块之间插入（或附加）文本：用 CV 标记，用 I 插入

有关更多信息，请参阅 :help blockwise-visual。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T11:10:19.807

另见[Vimtip#150](http://vim.wikia.com/wiki/Generating_a_column_of_increasing_numbers "Vim 提示#150")。

这解释了如何标记文本块并自动增加标记块中的数字。

# jquery - 为什么我可以使用 appendTo 添加对象但不能在 jQuery 中追加？

> ID：895681
> 
> 赞同：1
> 
> 时间：2009-05-21T22:55:04.360
> 
> 标签：jquery

这是怎么回事：

```
var items = [];
$.each([1, 2, 3, 4], function () {
    items.push($('<li />').html('test' + this));
});
// clearing/appending as two seperate calls
$('ul').empty();
$(items).appendTo('ul'); 
```

但这不是吗？

```
var items = [];
$.each([1, 2, 3, 4], function () {
    items.push($('<li />').html('test' + this));
});
// clearing/appending in one fluent call
$('ul').empty().append($(items)); 
```

这种方式会引发以下错误：

> 不支持这样的接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T23:55:14.470

我相信这是由于实施。如果您查看 AppendTo 的编写方式，它实际上是获取 items 数组中的每个项目并运行 $("ul").append(items[i])。

附加虽然似乎不适用于数组。您会注意到，即使没有空，您的线路仍然无法工作。我不完全理解附加的工作原理，但我相信会发生什么是函数按顺序浏览所有参数，但从不尝试将元素从数组中分解出来。所以发生的事情是它试图将一个数组附加到一个元素并失败。具有讽刺意味的是，这会起作用： $("ul").empty().append(items[0], items[1], items[2], items[3]);

无论如何，你必须做这样的事情来完成你似乎打算做的事情：

> $("ul").empty(); $(items).each(function(e, elem) {$('ul').append(elem);})

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:02:21.113

如果您将第二个示例的最后一行更改为此

```
 $('ul').empty().append(items); 
```

# algorithm - Group combinations with different group capacities

> ID：895694
> 
> 赞同：0
> 
> 时间：2009-05-21T22:58:30.543
> 
> 标签：algorithm

Well, I have a question about what algorithm would be most appropriate for my problem. Let's say that I have 3 groups:

```
Group A) 1 2 3 
Group B) 5 4
Group C) 9 6 7 8 
```

Now I would like to get all possible groups with this members (1-8) and groups with capacity 3, 2, 4.

Note:

```
Group A) 3 1 2
Group B) 5 4
Group C) 7 8 9 6 
```

counts as the same group combination as above combination.

I tried with all possible combinations of this numbers (1-8) but knowing that I might have a groups with total of 30 members I would came up with 265252859812191058636308480000000 different combinations, but that is too many.

I tried to search for non-isomorphics groups, but had no luck.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T23:10:46.370

我假设没有数字可以输入两次（第一个示例中有两个 3，第二个示例中有两个 5...），所以我将只使用数字 1-9 和每个组中相同数量的元素.

根据您对组合学的了解程度，您或多或少会理解这一点-如果您不理解，请询问，我会尽力更详细地解释。

您的问题是一个非常标准的问题 - 您想将一组 9 个元素分别划分为 3、2 和 4 个元素的子集。这被称为[多项式](http://en.wikibooks.org/wiki/Probability/Combinatorics#Partitions)*，计算如下：

```
n = 9! / (3!*2!*4!) 
```

基本上，你要做的是：

1) 为 A 组选择 3 个元素：`n1 = 9 choose 3.`
2) 为 B 组选择 2 个元素：`n2 = 6 choose 2.`
3) 其余四个元素为 C 组。

全部的：

```
n = n1 * n2 = 9!/(3!6!) * 6!/(2!4!) = 9! / (3!*2!*4!) 
```

*) 请参阅“分区”部分

**编辑：**我在对问题的评论中注意到了一些关于特殊要求的内容（例如 6 讨厌 9）。如果有，请先照看他们（将 9 个放在一组中，将 6 个放在另外两组中的一组中），然后再照看剩菜。

# macos - 从 Windows -> OSX 复制文件时如何设置默认权限

> ID：895700
> 
> 赞同：2
> 
> 时间：2009-05-21T22:59:48.717
> 
> 标签：macos, permissions

我正在 OSX 上开发一个 ruby​​ on rails 应用程序，并且我以管理员用户身份登录。

在我的 Windows 机器上，我正在创建我的图像，但每次我将它们复制到 OSX 机器时，权限都很弱（我猜是可以理解的）。

所以每张照片我都必须右键单击，信息并授予每个人读写权限，否则我的网络服务器不会为他们服务。

什么是最简单的解决方案？一个Applescript自动给予它完全许可？是否有设置可能导致每天执行 25 次很烦人。

是的，我可以将 shell 与 chmod 一起使用，但这仍然很烦人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T23:55:47.277

类 Unix 系统上的每个进程都有一个名为“umask”的字段，用于控制默认权限。它通常是八进制 0022，这意味着拒绝对组和其他的写权限。如果您使用终端窗口复制文件，请尝试输入

```
umask 0000 
```

预先。或者，让终端窗口保持打开状态，并运行以下 bash 命令：

```
while true; do chmod 0666 *; sleep 1; done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:51:41.247

如果所有图像都进入同一个目录，您可以向该目录添加一个可继承的访问控制列表 (ACL)；然后复制到其中的任何文件（即图像）都会自动获得该 ACL。使用以下内容进行设置：

```
chmod +a "group:_www allow read,write,readattr,writeattr,file_inherit" /path/to/imagedir 
```

请注意，您可能必须使用访问权限来获取 Web 服务器所需的一切。例如，如果它需要读取/写入扩展属性、删除文件等，您需要向 ACL 添加适当的权限。同样，如果您还需要它继承到添加到子目录的文件，您将需要添加更多类型的继承（并且可能重新创建子目录以便它们接受更改）。另外，我假设这是标准的 OS X 10.5 Apache 安装，以 _www 用户身份运行，它是 _www 组的成员；如果不是，请相应调整。有关详细信息，请参阅 chmod 的手册页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-03T10:38:02.167

如果您要复制许多文件/目录，请将它们打包在 windows 中的 zip 中，然后在 mac 中解压缩。提取的文件将具有适当的权限（至少，与 unarchiver 一起使用）

# javascript - jQuery 问题

> ID：895709
> 
> 赞同：0
> 
> 时间：2009-05-21T23:02:30.910
> 
> 标签：javascript, jquery

下面我向您展示一些完全被我屠杀的代码。

```
$(".gig").hover(function() {
    var id = $(this).attr("id");
    var time = $(this).attr("title");

    function () {
        if (time > 0)
        {
            var answer = $('<div class="roll">Are you attending? <a href="' + id + '">Yes</a></div>').hide();

        }
        else
        {
            var answer = $('<div class="roll">Did you attend?<a href="' + id + '">Yes</a> </div>').hide();              
        }

        answer.appendTo($(this)).fadeIn("fast");
    } 
    function () {
        $(this).find("div:last").fadeOut("fast", function() {
            $(this).remove()
        });
    }
}); 
```

我知道，这很可怕。它基本上就像现在的伪代码。任何人都可以帮助我将我的混乱重新编写成实际运行的代码吗？

基本上对于每个名为 div 的类，它应该将变量 answer 附加到该 div 的末尾，并在 mouseout 时删除变量 answer。变量 time 将从翻转 div 的标题中获取，从而影响添加的新 div 中显示的内容。.gig 的 id 应该简单地传递到 url 中。

悬停答案添加/删除函数自己工作，但我无法将它们放入带有 if 和 new 变量的新函数中。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T23:14:35.973

**编辑**

您已编辑您的问题。我认为这应该做你想要的：

```
$(".gig").hover(function() {
    var $this = $(this);
    var id = $this.attr("id");
    var time = $this.attr("title");
    var a = $('<a />').text('Yes').attr('href', id);
    var div = ('<div />').addClass('roll');
    if(time > 0){
        div.text('Are you attending?');
    } else {
        div.text('Did you attend?');
    }
    var answer = div.append(a).hide();
    answer.appendTo( this ).fadeIn('fast');
}, function(){
    $(this).find("div.roll:last").fadeOut("fast", function() {
            $(this).remove()
    });
}); 
```

不过，您可以使用一些缓存来创建 DOM 节点来改进它，如下所示：

```
$(".gig").hover(function() {
    var $this = $(this);
    if(typeof $this.data('attendingLink') === 'undefined'){
        var id = $this.attr("id");
        var time = $this.attr("title");
        var a = $('<a />').text('Yes').attr('href', id);
        var div = ('<div />').addClass('roll');
        if(time > 0){
            div.text('Are you attending?');
        } else {
            div.text('Did you attend?');
        }
        var answer = div.append(a);
        $this.data('attendingLink', answer);
    } else {
        var answer = $this.data('attendingLink');
    }
    answer.hide();
    answer.appendTo( this ).fadeIn('fast');
}, function(){
    $(this).find("div.roll:last").fadeOut("fast", function() {
            $(this).remove()
    });
}); 
```

然而，这只会在用户将鼠标悬停在 .gig 元素上很多时提高性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T23:17:28.587

这部分让我大吃一惊：`. id .`- 你不要`.`在 Javascript 中连接字符串，你使用`+`.

您使用该错误发布此代码的事实告诉我 A）您的编辑器乏善可陈，和/或 B）您没有使用[Firebug](http://www.getfirebug.com)之类的工具调试 Javascript 。你可能应该继续这样做。:)

您还试图错误地使用悬停的两个函数参数，因为您将所有代码放在一个巨大的函数中，然后只声明两个匿名函数（我什至不确定语法是否有效？？）

以下是您的代码的正确版本（*就语法*和我*认为*的逻辑而言）。试一试。

```
$(".gig").hover(function () {
    var id = $(this).attr("id");
    if (time > 0) {
        var answer = $('<div class="roll">Are you attending? <a href="' + id + '">Yes</a></div>').hide();
    } else {
        var answer = $('<div class="roll">Did you attend?<a href="' + id + '">Yes</a> </div>').hide();                          
    }
    answer.appendTo($(this)).fadeIn("fast");
}, function () {
    $(this).find("div:last").fadeOut("fast", function() {
        $(this).remove()
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T23:23:50.587

就个人而言，我会为每个元素初始化它 onDOMReady，而不是在悬停时。但是你可以按照你的意愿去做。这就是我要做的。

```
$(function() {
  $('.gig').each(function() {
    id = $(this).attr('id');
    time = $(this).attr('title');
    answer = '<div class="roll">' + 
      (time > 0 ? 'Are you attending?' : 'Did you attend?') +
      ' <a href="' . id .'">Yes</a></div>';
    $(this).append(answer);
  }).hover(
    function() { $('.roll', this).show('fast'); },
    function() { $('.roll', this).hide('fast'); }
  );
}); 
```

# javascript - 使用 Prototype 的 Class.create 定义私有/受保护的属性和方法

> ID：895712
> 
> 赞同：1
> 
> 时间：2009-05-21T23:03:29.770
> 
> 标签：javascript, oop, prototypejs, private, protection

有一个很好的通用方法可以在 Javascript 中定义私有和受保护的属性和方法，[在网站上](https://stackoverflow.com/questions/55611/javascript-private-methods)。但是，当前版本的 Prototype (1.6.0) 没有内置的方法来通过其[`Class.create()`](http://www.prototypejs.org/learn/class-inheritance)语法定义它们。

我很好奇当开发人员想要在使用 Prototype 时定义私有和受保护的属性和方法时，最佳实践是什么。有没有比通用方法更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T05:29:18.017

[Prototype的](https://prototype.lighthouseapp.com/projects/8886/tickets/152-implement-private-variables-for-classes)灯塔中有一个讨论，它解释了为什么你不能使用 Prototype 的 Class.create 获得这种效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:54:50.130

您可以做的是在您的构造函数（初始化）中使用局部变量作为原型，然后创建一个闭包，该闭包将访问/公开此变量给您的公共方法。

这是一个代码示例：

```
// properties are directly passed to `create` method
var Person = Class.create({
   initialize: function(name) {
      // Protected variables
      var _myProtectedMember = 'just a test';

      this.getProtectedMember = function() {
         return _myProtectedMember;
      }

      this.name = name;
   },
   say: function(message) {
      return this.name + ': ' + message + this.getProtectedMember();
   }
}); 
```

这是Douglas Crockford关于这个主题的理论。

[http://www.crockford.com/javascript/private.html](http://www.crockford.com/javascript/private.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-18T23:52:29.953

关键是将公共方法添加为闭包，如下例所示：

```
 Bird = Class.create (Abstract,(function () {
    var string = "...and I have wings"; //private instance member
    var secret = function () {
        return string;
    } //private instance method
    return {
        initialize: function (name) {
            this.name = name;
        }, //constructor method
        say: function (message) {
            return this.name + " says: " + message + secret();
        } //public method
    }
})());

Owl = Class.create (Bird, {
    say: function ($super, message) {
        return $super(message) + "...tweet";
    } //public method
})

var bird = new Bird("Robin"); //instantiate
console.log(bird.say("tweet")); //public method call

var owl = new Owl("Barnie"); //instantiate
console.log(owl.say("hoot")); //public method call inherit & add 
```

# iphone - viewDidLoad 被调用，viewWillAppear 没有被调用，视图没有出现在屏幕上

> ID：895713
> 
> 赞同：8
> 
> 时间：2009-05-21T23:05:57.113
> 
> 标签：iphone, cocoa-touch, uikit

**更新**

已经提到，根据文档不会调用 viewWillAppear 和 viewDidAppear。但是，我没有在这些方法中执行初始化，也没有向视图添加 UI 元素。

我只是用它们来放置断点来尝试调试它。

还有其他想法吗？

* * *

**原始问题**

我难住了。我正在重构一些代码并且遇到了一些奇怪的行为......

我在没有 nib 的情况下初始化 viewController A 并以编程方式设置视图。

控制器 A 中的 viewDidLoad 被调用。

在 viewController A 的 viewDidLoad 中，我从一个 nib 初始化 viewController B。

我将 viewControllerB.view 添加为 viewControllerA.view 的子视图

控制器 B 的 viewDidload 被调用。

* * *

然后就很奇怪了：

1.  viewController B 的 viewWillAppear 和 viewDidAppear**永远不会**被调用。

2.  viewControllerB.view**永远不会**出现在屏幕上。

3.  **没有**错误。

* * *

我检查的事情：

viewControllerBs Nib 的名称是正确的。

viewControllerB 的视图出口连接到一个视图。

viewControllerB 及其视图都不是零。

最重要的是，SDK [redacted] beta 5 中一切正常！

有任何想法吗？一定是有点傻。。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T01:38:04.933

如果通过代码将视图控制器添加到视图层次结构中，则视图控制器将不会获取`viewWillAppear`（或`viewDidAppear`）消息。如果您自己添加它，您必须自己向视图控制器发送消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-13T14:50:29.977

别忘了打电话

```
[super viewWillAppear:animated]; 
```

无论你在哪里重新定义它。

文档说：

> 如果你重写了这个方法，你必须在你的实现中调用 super 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T23:50:25.010

尝试

```
-(void) viewDidAppear:(BOOL)animated {
// whatever
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T13:06:59.623

我猜你的观点不是根观点。您可能正在使用 UINavigationController 所以尝试实现这个方法

```
- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated 
```

或者这个

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated 
```

并添加您的 viewDidLoad

```
this.navController.delegate = self; 
```

（不要忘记在 .h 文件中添加 UINavigationControllerDelegate 协议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-24T23:11:52.313

关闭问题：

我永远找不到解决方案，但从那时起 SDK 3.0 成为标准，这一点已变得毫无意义。该代码在当前版本的 SDK 中可以正常工作。

# hibernate - 根据相关实体属性是否为空来对实体进行休眠查询？

> ID：895718
> 
> 赞同：0
> 
> 时间：2009-05-21T23:07:54.147
> 
> 标签：hibernate, hql

我有以下映射：

```
<class name="Customer">
  <!-- actually one-to-one for all intents and purposes-->
  <many-to-one name="specialProperty" class="SpecialProperty" cascade="all" not-found="ignore" insert="false" update="false" column="id" unique="true"/>
</class

<class name="SpecialProperty" lazy="false">
        <id name="id" column="customer_id">
            <generator class="foreign">
                <param name="property">customer</param>
            </generator>
        <one-to-one name="customer" class="Customer" constrained="true"></one-to-one>
</class> 
```

**使用此映射，当 special_properties 表中没有特定客户的条目时，customer.specialProperty 为空。** （使用常规的一对一映射会导致 specialProperty 持有代理对象，因此我无法测试 null）因此在代码中我可以简单地执行 customer.specialProperty == null 来查看客户是否具有 SpecialProperty。

我正在尝试编写一个查询，该查询将返回所有具有非空 SpecialProperty 的客户，另一个查询将返回所有具有空 SpecialProperty 的客户。

我可以获得具有非空 SpecialProperty 的客户，如下所示：

```
from Customer customer inner join customer.specialProperty 
```

但是，我无法获得没有 SpecialProperty 的客户（例如 customer.specialProperty == null）

**我已经尝试了几件事。基本上我想要的是**

```
from Customer customer where customer.specialProperty is null 
```

但这会生成用于测试 customer.id 是否为空的 sql，无论出于何种原因。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T23:26:20.300

您的 specialProperty 定义中有 column="id"

# c# - Environment.GetFolderPath(...CommonApplicationData) 在 Vista 上仍然返回“C:\Documents and Settings\”

> ID：895723
> 
> 赞同：86
> 
> 时间：2009-05-21T23:09:11.693
> 
> 标签：c#, .net

据我了解，您应该使用该`Environment.GetFolderPath`方法，以便拥有独立于操作系统的代码...

Windows XP 使用`C:\Documents and Settings\`. Windows Vista 使用`C:\ProgramData`和`C:\Users`.

我在 Windows Vista 计算机上使用下面的代码，它返回一个`C:\Documents and Settings\`目录而不是`C:\ProgramData`它应该的......有什么想法吗？

```
 string commonAppData = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData);
    try
    {
        File.CreateText(
            Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) +
            "\\mycompany\\uid");
        log.Debug("Created file successfully");
    }
    catch (Exception ex)
    {
        log.Error("Unable to create the uid file: ", ex);
    } 
```

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2009-05-22T21:51:46.463

我的安装程序复制了一个在 XP 计算机上生成的 log.txt 文件。我正在查看那个日志文件，认为它是在 Vista 上生成的。一旦我将我的 log4net 配置修复为“Vista 兼容”。Environment.GetFolderPath 正在返回预期结果。因此，我要关闭这篇文章。

以下 SpecialFolder 路径参考可能有用：

Windows Server 2003 上的输出：

```
SpecialFolder.ApplicationData：C:\Documents and Settings\blake\Application Data
SpecialFolder.CommonApplicationData：C:\Documents and Settings\All Users\Application Data
SpecialFolder.ProgramFiles：C:\Program 文件
SpecialFolder.CommonProgramFiles：C:\Program Files\Common Files
SpecialFolder.DesktopDirectory: C:\Documents and Settings\blake\Desktop
SpecialFolder.LocalApplicationData：C:\Documents and Settings\blake\Local Settings\Application Data
SpecialFolder.MyDocuments：C:\Documents and Settings\blake\My Documents
SpecialFolder.System: C:\WINDOWS\system32`

```

Vista上的输出：

```
SpecialFolder.ApplicationData: C:\Users\blake\AppData\Roaming
SpecialFolder.CommonApplicationData: C:\ProgramData
SpecialFolder.ProgramFiles：C:\Program 文件
SpecialFolder.CommonProgramFiles：C:\Program Files\Common Files
SpecialFolder.DesktopDirectory: C:\Users\blake\Desktop
SpecialFolder.LocalApplicationData: C:\Users\blake\AppData\Local
SpecialFolder.MyDocuments: C:\Users\blake\Documents
SpecialFolder.System: C:\Windows\system32

```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2010-06-08T18:57:35.863

**Ubuntu 9.10 -> Ubuntu 12.04 和单声道 2.10.8.1 上的输出：**

```
SpecialFolder.ApplicationData: /home/$USER/.config
SpecialFolder.CommonApplicationData: /usr/share
SpecialFolder.ProgramFiles: 
SpecialFolder.DesktopDirectory: /home/$USER/Desktop
SpecialFolder.LocalApplicationData: /home/$USER/.local/share
SpecialFolder.MyDocuments: /home/$USER
SpecialFolder.System: 

SpecialFolder.Personal: /home/$USER 
```

**在带有单声道 4.2.1 的 Ubuntu 16.04 上输出**

```
SpecialFolder.ApplicationData: /home/$USER/.config
SpecialFolder.CommonApplicationData: /usr/share
SpecialFolder.ProgramFiles:
SpecialFolder.DesktopDirectory: /home/$USER/Desktop
SpecialFolder.LocalApplicationData: /home/$USER/.local/share
SpecialFolder.MyDocuments: /home/$USER
SpecialFolder.Desktop: /home/$USER/Desktop
SpecialFolder.Personal: /home/$USER

SpecialFolder.System: 
SpecialFolder.Programs: 
SpecialFolder.Favorites: 
SpecialFolder.Startup: 
SpecialFolder.Recent: 
SpecialFolder.SendTo: 
SpecialFolder.StartMenu: 
SpecialFolder.MyMusic: /home/$USER/Music
SpecialFolder.MyVideos: /home/$USER/Videos
SpecialFolder.MyComputer: 
SpecialFolder.NetworkShortcuts: 
SpecialFolder.Fonts: /home/$USER/.fonts
SpecialFolder.Templates: /home/$USER/Templates
SpecialFolder.CommonStartMenu: 
SpecialFolder.CommonPrograms: 
SpecialFolder.CommonStartup: 
SpecialFolder.CommonDesktopDirectory: 
SpecialFolder.PrinterShortcuts: 
SpecialFolder.InternetCache: 
SpecialFolder.Cookies: 
SpecialFolder.History: 
SpecialFolder.Windows: 
SpecialFolder.MyPictures: /home/$USER/Pictures
SpecialFolder.UserProfile: /home/$USER
SpecialFolder.SystemX86: 
SpecialFolder.ProgramFilesX86: 
SpecialFolder.CommonProgramFiles: 
SpecialFolder.CommonProgramFilesX86: 
SpecialFolder.CommonTemplates: /usr/share/templates
SpecialFolder.CommonDocuments: 
SpecialFolder.CommonAdminTools: 
SpecialFolder.AdminTools: 
SpecialFolder.CommonMusic: 
SpecialFolder.CommonPictures: 
SpecialFolder.CommonVideos: 
SpecialFolder.Resources: 
SpecialFolder.LocalizedResources: 
SpecialFolder.CommonOemLinks: 
SpecialFolder.CDBurning: 
```

其中 $USER 是当前用户

**使用 dotnet core (3.0.100) 在 Ubuntu 16.04 上输出**

```
ApplicationData: /home/$USER/.config
CommonApplicationData: /usr/share
ProgramFiles: 
DesktopDirectory: /home/$USER/Desktop
LocalApplicationData: /home/$USER/.local/share
MyDocuments: /home/$USER
System: 
Personal: /home/$USER 
```

**使用 Xamarin 7.2 在 Android 6 上输出**

```
Environment.SpecialFolder.ApplicationData: /data/user/0/$APPNAME/files/.config
Environment.SpecialFolder.CommonApplicationData: /usr/share
Environment.SpecialFolder.ProgramFiles: 
Environment.SpecialFolder.DesktopDirectory: /data/user/0/$APPNAME/files/Desktop
Environment.SpecialFolder.LocalApplicationData: /data/user/0/$APPNAME/files/.local/share
Environment.SpecialFolder.MyDocuments: /data/user/0/$APPNAME/files
Environment.SpecialFolder.Desktop: /data/user/0/$APPNAME/files/Desktop
Environment.SpecialFolder.Personal: /data/user/0/$APPNAME/files

Environment.SpecialFolder.Startup: 
Environment.SpecialFolder.Recent: 
Environment.SpecialFolder.SendTo: 
Environment.SpecialFolder.StartMenu: 
Environment.SpecialFolder.MyMusic: /data/user/0/$APPNAME/files/Music
Environment.SpecialFolder.MyVideos: /data/user/0/$APPNAME/files/Videos
Environment.SpecialFolder.MyComputer: 
Environment.SpecialFolder.NetworkShortcuts: 
Environment.SpecialFolder.Fonts: /data/user/0/$APPNAME/files/.fonts
Environment.SpecialFolder.Templates: /data/user/0/$APPNAME/files/Templates
Environment.SpecialFolder.CommonStartMenu: 
Environment.SpecialFolder.CommonPrograms: 
Environment.SpecialFolder.CommonStartup: 
Environment.SpecialFolder.CommonDesktopDirectory: 
Environment.SpecialFolder.PrinterShortcuts: 
Environment.SpecialFolder.InternetCache: 
Environment.SpecialFolder.Cookies: 
Environment.SpecialFolder.History: 
Environment.SpecialFolder.Windows: 
Environment.SpecialFolder.MyPictures: /data/user/0/$APPNAME/files/Pictures
Environment.SpecialFolder.UserProfile: /data/user/0/$APPNAME/files
Environment.SpecialFolder.SystemX86: 
Environment.SpecialFolder.ProgramFilesX86: 
Environment.SpecialFolder.CommonProgramFiles: 
Environment.SpecialFolder.CommonProgramFilesX86: 
Environment.SpecialFolder.CommonTemplates: /usr/share/templates
Environment.SpecialFolder.CommonDocuments: 
Environment.SpecialFolder.CommonAdminTools: 
Environment.SpecialFolder.AdminTools: 
Environment.SpecialFolder.CommonMusic: 
Environment.SpecialFolder.CommonPictures: 
Environment.SpecialFolder.CommonVideos: 
Environment.SpecialFolder.Resources: 
Environment.SpecialFolder.LocalizedResources: 
Environment.SpecialFolder.CommonOemLinks: 
Environment.SpecialFolder.CDBurning: 
```

其中 $APPNAME 是 Xamarin 应用程序的名称（例如 MyApp.Droid）

**使用 Xamarin 7.2 在 iOS 模拟器 10.3 上输出**

```
ApplicationData: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/.config
CommonApplicationData: /usr/share
ProgramFiles: /Applications
DesktopDirectory: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/Desktop
LocalApplicationData: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents
MyDocuments: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents
Desktop: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/Desktop
MyDocuments: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents
Startup: 
Recent: 
SendTo: 
StartMenu: 
MyMusic: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/Music
MyVideos: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/Videos
MyComputer: 
NetworkShortcuts: 
Fonts: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/.fonts
Templates: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/Templates
CommonStartMenu: 
CommonPrograms: 
CommonStartup: 
CommonDesktopDirectory: 
PrinterShortcuts: 
InternetCache: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Library/Caches
Cookies: 
History: 
Windows: 
MyPictures: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Documents/Pictures
UserProfile: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID
SystemX86: 
ProgramFilesX86: 
CommonProgramFiles: 
CommonProgramFilesX86: 
CommonTemplates: /usr/share/templates
CommonDocuments: 
CommonAdminTools: 
AdminTools: 
CommonMusic: 
CommonPictures: 
CommonVideos: 
Resources: /Users/$USER/Library/Developer/CoreSimulator/Devices/$DEVICEGUID/data/Containers/Data/Application/$APPLICATIONGUID/Library
LocalizedResources: 
CommonOemLinks: 
CDBurning: 
```

其中 $DEVICEGUID 是模拟器 GUID（取决于所选的模拟器）

**使用 Xamarin 7.2 在 ipad 10.3 上输出**

```
SpecialFolder.MyDocuments: /var/mobile/Containers/Data/Application/$APPLICATIONGUID/Documents 
```

**使用 Xamarin 16.4 在 ipad 13.3 上输出**

```
SpecialFolder.MyDocuments: /var/mobile/Containers/Data/Application/$APPLICATIONGUID/Documents
SpecialFolder.UserProfile: /private/var/mobile/Containers/Data/Application/$APPLICATIONGUID/Documents 
```

**使用 .net core 3.1 在 Windows 10 上输出**

```
SpecialFolder.MyDocuments: C:\Users\$USER\Documents 
```

**使用 .net core 3.1 在 Ubuntu 18.04 上输出**

```
SpecialFolder.MyDocuments: /home/$USER 
```

**使用 .net core 3.1 在 MacOS Catalina 上输出**

```
SpecialFolder.Desktop: /Users/$USER/Desktop
SpecialFolder.Programs: 
SpecialFolder.MyDocuments: /Users/$USER
SpecialFolder.Favorites: /Users/$USER/Library/Favorites
SpecialFolder.Startup: 
SpecialFolder.Recent: 
SpecialFolder.SendTo: 
SpecialFolder.StartMenu: 
SpecialFolder.MyMusic: /Users/$USER/Music
SpecialFolder.MyVideos: 
SpecialFolder.DesktopDirectory: /Users/$USER/Desktop
SpecialFolder.MyComputer: 
SpecialFolder.NetworkShortcuts: 
SpecialFolder.Fonts: /Users/$USER/Library/Fonts
SpecialFolder.Templates: 
SpecialFolder.CommonStartMenu: 
SpecialFolder.CommonPrograms: 
SpecialFolder.CommonStartup: 
SpecialFolder.CommonDesktopDirectory: 
SpecialFolder.ApplicationData: /Users/$USER/.config
SpecialFolder.PrinterShortcuts: 
SpecialFolder.LocalApplicationData: /Users/$USER/.local/share
SpecialFolder.InternetCache: /Users/$USER/Library/Caches
SpecialFolder.Cookies: 
SpecialFolder.History: 
SpecialFolder.CommonApplicationData: /usr/share
SpecialFolder.Windows: 
SpecialFolder.System: /System
SpecialFolder.ProgramFiles: /Applications
SpecialFolder.MyPictures: /Users/$USER/Pictures
SpecialFolder.UserProfile: /Users/$USER
SpecialFolder.SystemX86: 
SpecialFolder.ProgramFilesX86: 
SpecialFolder.CommonProgramFiles: 
SpecialFolder.CommonProgramFilesX86: 
SpecialFolder.CommonTemplates: 
SpecialFolder.CommonDocuments: 
SpecialFolder.CommonAdminTools: 
SpecialFolder.AdminTools: 
SpecialFolder.CommonMusic: 
SpecialFolder.CommonPictures: 
SpecialFolder.CommonVideos: 
SpecialFolder.Resources: 
SpecialFolder.LocalizedResources: 
SpecialFolder.CommonOemLinks: 
SpecialFolder.CDBurning: 
```

**Snap 包上的输出 - 使用 .net core 3.1 的 Core 18**

```
Desktop: 
Programs: 
MyDocuments: /home/$USER/snap/$APPNAME/x$VERSIONNUMBER
MyDocuments: /home/$USER/snap/$APPNAME/x$VERSIONNUMBER
Favorites: 
Startup: 
Recent: 
SendTo: 
StartMenu: 
MyMusic: 
MyVideos: 
DesktopDirectory: 
MyComputer: 
NetworkShortcuts: 
Fonts: 
Templates: 
CommonStartMenu: 
CommonPrograms: 
CommonStartup: 
CommonDesktopDirectory: 
ApplicationData: /home/$USER/snap/$APPNAME/x$VERSIONNUMBER/.config
PrinterShortcuts: 
LocalApplicationData: 
InternetCache: 
Cookies: 
History: 
CommonApplicationData: /usr/share
Windows: 
System: 
ProgramFiles: 
MyPictures: 
UserProfile: /home/$USER/snap/$APPNAME/x$VERSIONNUMBER
SystemX86: 
ProgramFilesX86: 
CommonProgramFiles: 
CommonProgramFilesX86: 
CommonTemplates: 
CommonDocuments: 
CommonAdminTools: 
AdminTools: 
CommonMusic: 
CommonPictures: 
CommonVideos: 
Resources: 
LocalizedResources: 
CommonOemLinks: 
CDBurning: 
```

（不是我发现如果`/home/$USER/snap/$APPNAME/x$VERSION/.local/share`存在快照环境，`LocalApplicationData`则将返回该路径。但是，如果该路径不存在，则返回空字符串。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2016-07-20T21:54:52.363

**Windows 10 上的输出**

```
Fonts: C:\Windows\Fonts
CommonStartMenu: C:\ProgramData\Microsoft\Windows\Start Menu
CommonPrograms: C:\ProgramData\Microsoft\Windows\Start Menu\Programs
CommonStartup: C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup
CommonDesktopDirectory: C:\Users\Public\Desktop
CommonApplicationData: C:\ProgramData
Windows: C:\Windows
System: C:\Windows\system32
ProgramFiles: C:\Program Files (x86)
SystemX86: C:\Windows\SysWOW64
ProgramFilesX86: C:\Program Files (x86)
CommonProgramFiles: C:\Program Files (x86)\Common Files
CommonProgramFilesX86: C:\Program Files (x86)\Common Files
CommonTemplates: C:\ProgramData\Microsoft\Windows\Templates
CommonDocuments: C:\Users\Public\Documents
CommonAdminTools: C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Administrative Tools
CommonMusic: C:\Users\Public\Music
CommonPictures: C:\Users\Public\Pictures
CommonVideos: C:\Users\Public\Videos
Resources: C:\Windows\resources
LocalizedResources:
CommonOemLinks: 
```

**如果您想记录自己的代码片段**

```
foreach(Environment.SpecialFolder f in Enum.GetValues(typeof(Environment.SpecialFolder)))
{
    string commonAppData = Environment.GetFolderPath(f);
    Console.WriteLine("{0}: {1}", f, commonAppData);
}
Console.ReadLine(); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-10-13T13:39:22.917

**Windows 7（64 位）上的输出**

```
SpecialFolder.CommonApplicationData: C:\ProgramData 
SpecialFolder.CommonDesktopDirectory: C:\Users\Public\Desktop
SpecialFolder.CommonStartMenu: C:\ProgramData\Microsoft\Windows\Start Menu
SpecialFolder.CommonPrograms: C:\ProgramData\Microsoft\Windows\Start Menu\Programs
SpecialFolder.CommonProgramFiles: C:\Program Files\Common Files
SpecialFolder.CommonProgramFilesX86: C:\Program Files (x86)\Common Files
SpecialFolder.CommonStartup: C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup
SpecialFolder.ProgramFiles: C:\Program Files
SpecialFolder.ProgramFilesX86: C:\Program Files (x86)
SpecialFolder.System: C:\Windows\system32
SpecialFolder.SystemX86: C:\Windows\SysWOW64 
```

**Windows XP 上的输出**

```
SpecialFolder.CommonApplicationData: C:\Documents and Settings\All Users\Application Data
SpecialFolder.CommonDesktopDirectory: C:\Documents and Settings\All Users\Desktop
SpecialFolder.CommonPrograms: C:\Documents and Settings\All Users\Start Menu\Programs
SpecialFolder.CommonProgramFiles: C:\Program Files\Common Files
SpecialFolder.CommonProgramFilesX86:
SpecialFolder.CommonStartMenu: C:\Documents and Settings\All Users\Start Menu
SpecialFolder.CommonStartup: C:\Documents and Settings\All Users\Start Menu\Programs\Startup
SpecialFolder.ProgramFiles: C:\Program Files
SpecialFolder.ProgramFilesX86:
SpecialFolder.System: C:\WINDOWS\system32
SpecialFolder.SystemX86: C:\WINDOWS\system32 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-11T23:55:06.793

我一直在寻找 macOS 的列表，但一无所获，也许这对某人有帮助。

**使用 net5.0 在 macOS Catalina (10.15.7) 上输出**

```
# SpecialFolders (Only with value)
SpecialFolder.ApplicationData: /Users/$USER/.config
SpecialFolder.CommonApplicationData: /usr/share
SpecialFolder.Desktop: /Users/$USER/Desktop
SpecialFolder.DesktopDirectory: /Users/$USER/Desktop
SpecialFolder.Favorites: /Users/$USER/Library/Favorites
SpecialFolder.Fonts: /Users/$USER/Library/Fonts
SpecialFolder.InternetCache: /Users/$USER/Library/Caches
SpecialFolder.LocalApplicationData: /Users/$USER/.local/share
SpecialFolder.MyDocuments: /Users/$USER
SpecialFolder.MyMusic: /Users/$USER/Music
SpecialFolder.MyPictures: /Users/$USER/Pictures
SpecialFolder.ProgramFiles: /Applications
SpecialFolder.System: /System
SpecialFolder.UserProfile: /Users/$USER

# SpecialFolders (All)
SpecialFolder.AdminTools: 
SpecialFolder.ApplicationData: /Users/$USER/.config
SpecialFolder.CDBurning: 
SpecialFolder.CommonAdminTools: 
SpecialFolder.CommonApplicationData: /usr/share
SpecialFolder.CommonDesktopDirectory: 
SpecialFolder.CommonDocuments: 
SpecialFolder.CommonMusic: 
SpecialFolder.CommonOemLinks: 
SpecialFolder.CommonPictures: 
SpecialFolder.CommonProgramFiles: 
SpecialFolder.CommonProgramFilesX86: 
SpecialFolder.CommonPrograms: 
SpecialFolder.CommonStartMenu: 
SpecialFolder.CommonStartup: 
SpecialFolder.CommonTemplates: 
SpecialFolder.CommonVideos: 
SpecialFolder.Cookies: 
SpecialFolder.Desktop: /Users/$USER/Desktop
SpecialFolder.DesktopDirectory: /Users/$USER/Desktop
SpecialFolder.Favorites: /Users/$USER/Library/Favorites
SpecialFolder.Fonts: /Users/$USER/Library/Fonts
SpecialFolder.History: 
SpecialFolder.InternetCache: /Users/$USER/Library/Caches
SpecialFolder.LocalApplicationData: /Users/$USER/.local/share
SpecialFolder.LocalizedResources: 
SpecialFolder.MyComputer: 
SpecialFolder.MyDocuments: /Users/$USER
SpecialFolder.MyMusic: /Users/$USER/Music
SpecialFolder.MyPictures: /Users/$USER/Pictures
SpecialFolder.MyVideos: 
SpecialFolder.NetworkShortcuts: 
SpecialFolder.PrinterShortcuts: 
SpecialFolder.ProgramFiles: /Applications
SpecialFolder.ProgramFilesX86: 
SpecialFolder.Programs: 
SpecialFolder.Recent: 
SpecialFolder.Resources: 
SpecialFolder.SendTo: 
SpecialFolder.StartMenu: 
SpecialFolder.Startup: 
SpecialFolder.System: /System
SpecialFolder.SystemX86: 
SpecialFolder.Templates: 
SpecialFolder.UserProfile: /Users/$USER
SpecialFolder.Windows: 
```

我已将我的用户名替换为 $USER。

**[来自pogosama](https://stackoverflow.com/a/38491499/8552750)的代码片段。**

```
foreach(Environment.SpecialFolder f in Enum.GetValues(typeof(Environment.SpecialFolder)))
{
    string commonAppData = Environment.GetFolderPath(f);
    Console.WriteLine("{0}: {1}", f, commonAppData);
}
Console.ReadLine(); 
```

# find - 如何组合查找命令？

> ID：895724
> 
> 赞同：1
> 
> 时间：2009-05-21T23:09:13.673
> 
> 标签：find

*这个问题出现了我原来的问题[here。](https://stackoverflow.com/questions/895501/union-intersection-and-exclude-with-the-find-command)*

我尝试使用 find-command 找到两个 find-commands 的输出之间的共同元素。我怎样才能让命令工作？

```
find `find ~/bin/FilesDvorak/.* -maxdepth 0` -and `find ~/.PAST_RC_files/.*` 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T23:18:29.320

像这样的东西会起作用，而不是重新发明轮子吗？

```
diff -qrs ~/bin/FilesDvorak/ ~/.PAST_RC_files/ | grep -P "are identical|differ" 
```

您可以使用 grep 来获取仅存在于其中一个目录中的文件等。

差异

*   -q --brief 仅输出文件是否不同。
*   -r --recursive 递归比较找到的任何子目录。
*   -s --report-identical-files 当两个文件相同时报告。

grep

*   -P：Perl 风格的正则表达式。没有它你可能会很好地删除它，我通常会自动添加它。

# java - Java 实时性能

> ID：895725
> 
> 赞同：12
> 
> 时间：2009-05-21T23:10:24.203
> 
> 标签：java, performance, real-time

我正在处理需要对图像进行非常高级操作的 Java 项目。事实上，我正在使用 OpenCV 进行大部分操作，并且我正在使用 JNI 来包装我需要的 OpenCV 函数。我对 OpenCV 提供的性能非常满意，编写 OpenCV 代码的人应该对代码给予极大的赞誉。与我对 Java 开发人员编写的代码的体验形成鲜明对比。

我开始对我的编程语言的选择持乐观态度，我的项目的第一次工作迭代运行良好，但它的性能远不接近实时（每 2 秒获得大约 1 帧。）我已经对我的代码和它帮助很大。我已经能够将帧速率提高到大约每秒 10-20 帧，这很棒，但我发现要进行任何进一步的优化，我必须重写 Java 代码来做同样的事情，但 10 -20 倍更高效。

我对 Java 的开发人员很少关注性能感到震惊，尤其是在为与媒体相关的类编写类时。我已经下载了 OpenJDK，并且正在探索我正在使用的功能。例如，在 Raster 类下有一个名为 getPixels(...) 的函数，它获取图像的像素。我期待这个函数在源代码中是一个高度优化的函数，通过多次调用 System.arrayCopy 来进一步优化性能。相反，我发现的是非常“优雅”的代码，它们调用 5-6 个不同的类和 10-20 个不同的方法，只是为了完成我可以在一行中做的事情：

```
for (int i =0; i < n; i++) {
  long p = rawFrame[i];
  p = (p << 32) >>> 32;
  byte red = (byte) ((p >> 16) & 0xff);
  byte green = (byte) ((p >> 8) & 0xff);
  byte blue = (byte) ((p) & 0xff);
  byte val = (byte)(0.212671f * red + 0.715160f * green + 0.072169f * blue);
  data[i] = val;
  grayFrameData[i] = (val & 0x80) + (val & (0x7f)); 
} 
```

上面的代码将图像转换为灰度并获取浮点像素数据，大约需要 1-10 毫秒。如果我想对 Java 内置函数做同样的事情，转换为灰度本身需要 200-300 毫秒，然后抓取浮动像素大约需要 50-100 毫秒。这对于实时性能来说是不可接受的。请注意，为了加快速度，我大量使用了 Java 开发人员回避的位运算符。

我知道他们需要处理一般情况，但即便如此，他们至少不能提供优化选项，或者至少警告这段代码的执行速度有多慢。

我的问题是，在开发的这个后期（我已经进行了第一次迭代，而不是我正在研究实时执行更多的第二次）我是否应该硬着头皮切换到我可以很好的 C/C++更多地调整事情，或者我应该坚持使用 Java 并希望事情变得更加实时友好，这样我就不必重写已经实现的 Java 代码来获得加速。

我真的开始厌恶 Java 的“优雅”和缓慢。那里的课程数量似乎有点过头了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T15:38:41.693

我已经使用 Java 完成了计算机视觉工作，我可能会因为这样说而被否决，但它非常适用于计算机视觉和实时的东西，你只需要知道如何使用它。

### 潜在的优化：

如果您在优化代码方面需要帮助，我很乐意提供帮助——例如，我可以告诉您，您可能会通过创建一个方法来提高性能

```
`public static final int getGrayScale(final int pixelRGB){
    return (0.212671f * ((pixelRGB >> 16) & 0xff) + 0.715160f * ((pixelRGB >> 8) & 0xff) + 0.072169f * ((pixelRGB) & 0xff));
}` 
```

并在你的 for{pixels} 循环中使用它。通过使用方法调用，JVM 可以更加优化此操作，并且可能也可以更加优化 for 循环。

如果您需要刻录 RAM，您可以为所有可能的 24 位像素像素颜色创建一个静态的、最终的输出灰度字节查找表。这将在 RAM 中约为 16 MB，但是您不必执行任何浮点运算，只需访问单个数组即可。这*可能*会更快，具体取决于您使用的 JVM，以及它是否可以优化数组边界检查。

### 可以找到类似的、更快的图像处理代码的地方：

我强烈建议您查看 ImageJ 图像处理应用程序的代码（由于 StackOverflow 被延迟，无法链接）及其库，特别是 ij.process.TypeConverter。就像您的代码一样，它在很大程度上依赖于**直接数组操作以及位旋转**和**最少的额外数组创建**。Java2D 库（标准 JRE 的一部分）和 Java Advanced Imaging (JAI) 库（由于 StackOverflow 延迟而无法链接）提供了其他方法来直接对图像数据进行快速图像处理，而无需每次都滚动您自己的操作时间。对于 Java2D，您只需要小心使用哪些函数。

### 为什么 Java2D 库如此间接：

大多数“类”是由于支持多种颜色模型和存储格式（IE HSB 图像、基于浮点的颜色模型、索引颜色模型）。间接存在是有原因的，有时实际上会提高性能 - BufferedImage 类（例如）直接连接到最近 VM 中的图形内存中，以使某些操作更快。间接允许它在很多时候向用户掩盖这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T23:25:27.073

> 我的问题是，在开发的这个后期（我已经进行了第一次迭代，而不是我正在研究实时执行更多的第二次）我是否应该硬着头皮切换到我可以很好的 C/C++更多地调整事情，或者我应该坚持使用 Java 并希望事情变得更加实时友好，这样我就不必重写已经实现的 Java 代码来获得加速。

你问我应该

1.  切换到我可以满足我的性能要求的语言。
2.  坚持使用 Java，希望情况有所改善。

可能还有其他选项....但是选项 2 似乎不现实，您不能只是“希望”代码变得更快：p

需要注意的几点：

1.  OpenJDK 不一定具有与 Sun JDK 相同的性能，您是否尝试过 Sun JDK？
2.  如果您需要通过几种方法进行性能优化，那么可能值得重新编写它们并坚持使用 Java...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T23:19:56.727

我的建议是这取决于图像操作与整个项目相比的重要性，以及相对于 java 带来的任何优势。显然，如果需要，您可以在 java 中编写快速代码（如您所演示的）。但是，如果您的项目的 80% 都包含这种优化，我肯定会重新考虑 Java 作为这里的语言选择。

另一方面，如果这代表了应用程序的 20%，而另外 80% 是围绕提供这种转换的用户功能，那么也许必须做一些工作来完成操作是一个值得的权衡，而不是必须处理使用您自己的内存管理，并拥有 java 为您提供的任何其他 API 用于用户交互（Web、Swing、SWT，无论您使用什么）。

由于垃圾收集器，Java 的实时能力并不为人所知。那也可能会咬你，所以要小心。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T05:38:43.297

我不知道你会得到多少性能提升，但如果你有一个长时间运行的进程在做重复的事情，你应该尝试使用`java -server`. 它的性能比 Windows 上的默认客户端 VM[好得多](http://java.sun.com/docs/hotspot/HotSpotFAQ.html#compiler_types)，后者针对快速启动时间进行了优化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-23T14:59:12.337

目前尚不清楚您是否真的在询问实时。实时和真正快速之间是有区别的。对于真正的快速，考虑平均案例行为就足够了。吞吐量是主要问题。实时意味着每次都能够在固定的时间内完成某些任务。或者，当然，有些应用程序需要两者。

在传统的 Java 实现中，例如 OpenJDK，垃圾收集器是实现实时行为的最大问题。这是因为垃圾收集器可以在任何时候中断程序来完成它的工作。我的公司 aicas 实现了不需要单独的垃圾收集线程的 Java。相反，在分配时会完成一些 GC 工作。实际上，分配是通过为每个释放的块标记或清除几个块来支付的。这需要完全重新实现虚拟机。

编译是实时 Java 与传统 Java 实现不同的另一点。实时 Java 技术倾向于使用静态或提前 (AoT) 编译而不是 JIT 编译。JiT 可能适合您的应用程序，因为您可能能够容忍传统 VM 编译最常用的类所需的“预热”时间。如果是这样，那么您可能没有实时要求，只有吞吐量要求。

如果您有兴趣确保帧解码不会被垃圾收集中断，那么使用 Java 的实时实现以及 AoT 编译也是有意义的。Java 实时规范 (RTSJ) 还为实时和嵌入式编程提供其他支持，例如 RelatimeThread、AsyncEventHandler 和 RawMemoryAccess。

当然，要获得良好的性能，无论是实时还是真正快速，都需要注意细节。过度使用临时对象没有帮助。分配总是需要额外的成本，所以应该尽量减少。这对于不允许更改对象状态的函数式语言来说是一个重大挑战。但是，应该注意理解正在编写的代码的关键路径，以避免不必要的优化。分析对于了解优化工作的最佳使用位置至关重要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T23:30:41.963

过早的优化是万恶之源。

与其抱怨，不如编写一组优化的库并发布它们，但是创建一个针对某些不存在的目标预先优化的“参考”java 实现是错误的。

参考实现的要点是制作可理解、可维护的代码——它必须如此。我认为总是期望供应商在必要时分析这个可理解的版本并重新实现部件以提高速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T23:52:34.587

除了其他人所说的之外，您还可以为 JDK 贡献优化。如果您可以提供一个不牺牲通用性或可读性的强大优化，我希望您能够在未来的 JDK 版本中包含您的补丁。

因此，您不必*希望*JDK 会变得更好。你可以帮助实现它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T23:56:10.087

据我了解，最新版本的 Java（或者可能是 JavaFX）具有允许您访问系统视频硬件中的高级功能的方法。很抱歉我这么笼统，我相信我在 Java Posse 上听说过它，而且由于我被困在 Java 1.3 领域，我从来没有真正有机会检查它——但我确实记得听到过类似的话。

这是关于它的一些事情：[但它看起来只会在 Java 7 中 :(](http://www.javalobby.org/java/forums/m92155244.html)

看起来它最初只支持播放流和基本的流操作——但也许“等一下，Java 会改进”的方法可能真的有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-22T00:04:30.863

是什么阻止您编写您希望使用的方法的优化版本而不是使用内置方法？如果这不可能，为什么不使用更本地的语言编写您的对象，并将其导入您现有的应用程序？

# .net - .Net 加密

> ID：895739
> 
> 赞同：20
> 
> 时间：2009-05-21T23:14:01.030
> 
> 标签：.net, encryption, clickonce, connection-string, app-config

我想知道的是在配置文件中加密连接字符串的明确方法。以下是我的问题：

1.  使用机器级加密，访问我的服务器的任何人都不能编写一个小的 .Net 程序来读取连接字符串的内容吗？

2.  如果我将我的应用程序部署到企业环境中的用户计算机，并且应用程序在配置文件中有连接字符串，我如何确保只有我的应用程序可以解密它？该场景在 ClickOnce 部署场景中特别有趣。我读过有人在发布服务器上存储未加密的配置，并在首次下载、安装和执行应用程序时在机器级别加密。这对我来说听起来很不对 - 连接字符串在电线上不受保护地压缩，并且在下载和应用程序执行之间的短时间内不受保护。

3.  我可以拥有公钥和私钥，签署我的应用程序，使用密钥加密配置文件，并且当用户执行它时，只能从签名的应用程序中解密吗？

4.  由于我使用的是 ClickOnce，我可以在代码中或嵌入我的加密敏感信息，因为除非版本 # 更改，否则 ClickOnce 不会检测到更改。因此，如果我在更改连接字符串时需要重新编译，则 app.config 的点将被静音。除了使用配置文件之外，我还可以采取哪些其他方法来保护服务器、客户端以及它们之间的连接字符串？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-21T23:54:56.390

1.  是的。使用机器密钥加密的秘密可以被任何有权访问机器密钥的进程解密。使用用户密钥加密的秘密可以被同一用户启动的任何进程解密。
2.  这是不可能的。所有相反的说法都是蛇油。您的应用程序需要一个秘密来解密某些东西。没有已知的方案可以在应用程序中隐藏秘密。有各种混淆方案，但没有什么是万无一失的。你能做的最好的就是提高标准。
3.  不。要么应用程序有解密某些东西的密钥，在这种情况下你回到第 2 点，或者你的应用程序有公钥，在这种情况下任何人都可以解密相同的秘密，所以你基本上对配置进行验证（未被篡改），但配置不是秘密。
4.  您无法在应用程序中安全地部署嵌入式机密。只是价格有多高的问题，如果您的受保护资产（秘密）值得，那么黑客就会得到它。

加密基础设施旨在保护当前用户的秘密免受其他用户的侵害。它并非旨在保护应用程序的机密不被使用它的用户。您要求的不是加密，而是 DRM，您需要查看 DRM 基础架构以寻求答案。我不知道[DRM API](http://msdn.microsoft.com/en-us/library/aa391568(VS.85).aspx)周围的托管库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T23:30:47.610

其实是个好问题

您不能确定没有人会解密您的连接字符串（或密码）。当然，您可以对其进行加密，但人们将能够反编译您的应用程序并查看您使用的加密算法以及用于解密连接字符串/密码的密钥。也许这更像是极端情况，但有可能（我在学生时代是一个邪恶的饼干:)）。因此，如果您害怕这种情况，您必须保护您的应用程序，使其更难反汇编。这是另一个讨论的主题，但例如，您可以使用[Dotfuscator](http://en.wikipedia.org/wiki/Dotfuscator "点熔器")或其他好的混淆器 - 它会使破解者更难理解您的应用程序内部发生的事情。
因此，一种可能的解决方案是“加密连接字符串 + 使用混淆器”，但正如我所说，它不会为您提供 100% 的保护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T23:35:20.393

只要您不想提示输入密码或使用其他技术解决方案来解密您的秘密（如特殊硬件），使用对称加密存储秘密总是有问题的。当您必须将完整的密钥存储在系统的任何位置时，其他人将有办法检索它。

我肯定会尝试使用操作系统的机制。当您使用 MS-SQL 在纯 Windows 环境中工作时，您应该使用集成安全性而不是用户/密码。其他数据库也可能具有类似的功能。
另一个（较弱的）选项是使用操作系统的安全设置来保护明文文件 - 只有用户才能访问该文件。但是，您和您的用户必须信任管理员。在这种情况下，您应该另外使用对称加密。但是请参阅我的第一个论点-它不会真正安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T14:56:39.680

Gustavo 你也许可以实现这个，（这是我基于登录的应用程序的计划）。

用户在 .Net 应用程序中输入凭据。凭据被传递给 .php 服务器端应用程序，该应用程序使用它们登录数据库并检索密钥并将其传递回 .Net 应用程序。然后将密钥用于 .Net 应用程序中硬编码的加密连接字符串，以允许完整的数据库访问。

# unix - AND 运算符在 FIND 命令中如何工作？

> ID：895743
> 
> 赞同：1
> 
> 时间：2009-05-21T23:14:50.963
> 
> 标签：unix, shell, find

*我的[最后一个问题](https://stackoverflow.com/questions/895501/union-intersection-and-exclude-with-the-find-command/895652#895652)扩展了，所以让我们分开分析。*

**AND 运算符，交叉点？**

我举个例子：

```
$ find . | awk -F"/" '{ print $2 }'

.zcompdump
.zshrc
.zshrc_copy
.zshrc_somequy
.bashrc
.emacs

$ find ~/bin/FilesDvorak/.* -maxdepth 0 | awk -F"/" '{ print $6 }'

.bashrc
.emacs
.gdbinit
.git
.profile 
```

当我将输出保存到单独的列表时，我无法理解为什么该命令不采用常见的东西：

```
find -f all_files -and -f right_files . 
```

我只想：

```
.bashrc
.emacs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T23:19:41.313

- 并且仅适用于测试。如果你想找到两个列表的共同元素，你应该做类似的事情

```
sort all_files > all_files.sorted
sort right_files > right_files.sorted
comm -12 all_files right_files > common_files 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T23:35:31.033

稍微扩展戴夫的回答：

您似乎想要两个查找命令的交集。Find 不做集合操作。Find 向下（或向上，取决于您如何看待）一组路径遍历，并将表达式应用于它遇到的每个项目。它采取的默认操作是打印它找到的针对表达式评估为 true 的项目的路径。（我相信某些旧版本的 find 要求您显式添加 -print 表达式。）它不会整理结果。对于交叉点分析，您可以使用**diff、sdiff、comm**等工具。

我假设您正在尝试在两个单独的目录中查找具有相同名称的项目，而不是在子目录中。

假设 bash 你可以做类似的事情

```
comm -12 <(find .  -maxdepth 1 | sort) <(cd ~/bin/FilesDvorak/; find . -maxdepth 1 | sort) 
```

我相信 -and in find 命令几乎总是多余的。前任。

```
find . -type f ! -type d 
```

是相同的

```
find . -type f -and ! -type d 
```

此外，-f 标志是添加到要遍历的路径的选项。我不相信这是一种表达。请“人查找”进行澄清。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:35:04.003

man 中的 AND 选项

> -and 运算符是逻辑 AND 运算符。由于两个表达式的并列暗示了它，因此不必指定它。如果两个表达式都为真，则表达式的计算结果为真。如果第一个表达式为假，则不计算第二个表达式。

手册的这一部分对我来说相当神秘。不过，我们来分析一下。

**第 1 句：**像数学中的 AND 运算符。只有两个两个1 **！**

**第二句：**这表明您不需要使用该命令，正如您在 Dave 的回答中看到的那样。伟大的！- - 似乎将第一个表达式与 -AND 与没有 -AND 的表达式并列。**请向我解释一下这个希腊语。**

**第 3 句：**重复：在第 1 句中用“逻辑”一词表示相同。

**第 4 句：**重复：它说 01 意味着假

英文也一样：

令 p 和 q 是具有以下真值的两个表达式

```
p q pANDq
1 1 1
1 0 0
0 1 0
0 0 0 
```

其中 1 表示正确，而 0 表示错误。

请注意，这些手册通常包含多余的描述，有时还包含错误。

# .net - 帮助：使用 SQLIte 发现同一依赖程序集的不同版本之间存在冲突

> ID：895746
> 
> 赞同：1
> 
> 时间：2009-05-21T23:15:06.080
> 
> 标签：.net, visual-studio, sqlite, reference, elmah

我的一个项目使用引用 SQLite 的 Elmah。Elmah 是针对 .Net 版本 1.0.44.0 的 SQLite 构建的

好吧，我正在试验一些 64 位的东西（我的开发盒是 32 位的），所以我需要 .Net 的 64 位版本的 SQLite。我抓住了它的最新版本（当时是 1.0.51.0）并使用他们的安装程序来安装它。对于我的 32 位项目，我更新了对 System.Data.SQLite 的引用以指向较新的版本。一旦我意识到我的错误，我就卸载了它并获取了适当的原始版本，并将我的参考指向 1.0.44.0

现在，当我构建时，我收到有关同一依赖程序集的不同版本的警告。单击它会询问我是否希望它编辑我的 app.config 并插入以下内容：

```
<runtime>
 <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
  <dependentAssembly>
   <assemblyIdentity name="System.Data.SQLite" publicKeyToken="DB937BC2D44FF139" culture="neutral"/>
   <bindingRedirect oldVersion="0.0.0.0-1.0.51.0" newVersion="1.0.51.0"/>
  </dependentAssembly>
 </assemblyBinding>
</runtime> 
```

嗯..我的系统上没有安装或存在 1.0.51.0 了！冲突在哪里？为什么视觉工作室认为它存在于某个地方？我在 GAC 中进行了检查，发现任何地方都没有 System.Data.SQLite。

我想摆脱这个烦人的警告。我在同一个解决方案中有另一个项目也引用了 SQLite，但我从未更新对较新版本的引用（并且随后从未将引用更改回来）..它一直引用 1.0.44.0。该项目根本没有抱怨......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T01:15:39.973

使用 ildasm.exe 查看应用程序和程序集中的清单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-26T06:00:33.030

这是一个帮助识别违规参考的实用程序：

[http://www.brianlow.com/index.php/2010/01/25/find-conflicting-assembly-references/](http://www.brianlow.com/index.php/2010/01/25/find-conflicting-assembly-references/)

# ruby - Ruby的attr_accessor如何产生类变量或类实例变量而不是实例变量？

> ID：895747
> 
> 赞同：29
> 
> 时间：2009-05-21T23:15:22.617
> 
> 标签：ruby, instance-variables, class-variables, class-instance-variables

如果我有一个带有 的类`attr_accessor`，它默认创建一个实例变量以及相应的 getter 和 setter。但是不是创建一个实例变量，有没有办法让它创建一个类变量或类实例变量呢？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-21T23:18:29.227

像这样：

```
class TYourClass
  class << self
    attr_accessor :class_instance_variable
  end
end 
```

您可以将其视为打开类的元类（该类本身就是一个实例）并向其添加属性。

`attr_accessor`是 class 的一个方法`Class`，它向类添加了两个方法，一个读取实例变量，另一个设置它。这是一个可能的实现：

```
class Class
  def my_attr_accessor(name)
    define_method name do
      instance_variable_get "@#{name}"
    end 
    define_method "#{name}=" do |new_val|
      instance_variable_set "@#{name}", new_val
    end
  end
end 
```

完全未经测试的类属性访问器：

```
class Class
  def class_attr_accessor(name)
    define_method name do
      class_variable_get "@@#{name}"
    end 
    define_method "#{name}=" do |new_val|
      class_variable_set "@@#{name}", new_val
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-11-03T07:26:19.940

在 Rails 中（或任何你做的地方`require 'active_support'`）你可以使用`cattr_accessor :name`来获取真正的类变量访问器。

其他人指出的类实例变量通常更有用。APIdock[页面有一些有用的讨论，阐明了您](http://apidock.com/rails/Class/cattr_accessor)[何时`cattr_accessor`](http://apidock.com/rails/Class/cattr_accessor)需要一个而不是另一个，以及`cattr_accessor`,`cattr_reader`和`cattr_writer`函数的源代码。

# javascript - Google Chrome Javascript 调试器和内容脚本

> ID：895751
> 
> 赞同：44
> 
> 时间：2009-05-21T23:17:59.163
> 
> 标签：javascript, google-chrome, script-debugging

[这个问题之前](https://stackoverflow.com/questions/66420/how-do-you-launch-the-javascript-debugger-in-google-chrome)也有人问过类似的问题，但我似乎无法在 Google Chrome 中调试 Javascript。

如果我转到页面 > 开发人员，则“调试 Javascript”（`Ctrl`++ `Shift`）`L`被禁用。 `Alt`+```不起作用。

我正在开发一个“内容脚本”扩展，所以我正在使用`--enable-extensions`.

我最想做的是设置断点并在我的脚本执行时单步执行/运行。当谈到 JavaScript 时，我有点不知所措，所以任何指导都值得赞赏。

我可以进入“JavaScript 控制台”，但在其中找不到内容脚本。我也不确定这与“JavaScript 调试器”有何不同。

我在 Windows XP 上使用最新的 Chrome 开发版本（2.0.181.1）。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2010-10-13T10:39:41.197

将以下命令放入您的脚本中：

```
debugger; 
```

这将在到达该点时启动 Javascript 调试器

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2014-02-12T17:15:53.093

这些答案似乎都已经过时了，因为这在谷歌中排名很高，所以这是最新的答案：

在 Chrome 中按下`CTRL+SHIFT+i`以调出开发者工具。

选择“来源”

单击允许您从脚本中进行选择的小箭头 ![在此处输入图像描述](https://i.stack.imgur.com/jyX6Z.png)

然后选择“内容脚本”

![在此处输入图像描述](https://i.stack.imgur.com/4s8B1.png)

然后，您需要知道您的扩展程序的 ID（可从 chrome 管理扩展程序页面获得）才能访问您的脚本并正常调试它们。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-21T23:36:58.113

右键单击并选择 Inspect Element，您将在其中找到 JS 调试器以及其他调试工具。JS 调试器应该允许您设置断点等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-02T06:17:17.203

您需要做的是启用您的扩展程序，然后在 Chrome 中单击“开发人员”->“Javascript 控制台”。然后单击“脚本”选项卡。之后，您应该会在所有已加载脚本的下方看到一个列表。您将看到当前页面的脚本以及您已安装的任何扩展的所有脚本。（如果打开控制台后没有看到列出的任何脚本，则可能需要刷新）

似乎所有 Chrome 扩展程序都被分配了一个唯一的 ID。您可以通过在开发人员模式下查看 Chrome 扩展页面来找到您的 ID。

然后只需在下拉列表中搜索脚本即可。选择你的脚本，你可以设置断点等。

有更多关于 Chrome 开发工具的信息：http: [//www.chromium.org/devtools](http://www.chromium.org/devtools)

# asp.net-mvc - DropDownList SelectedValue 未正确绑定

> ID：895756
> 
> 赞同：0
> 
> 时间：2009-05-21T23:18:59.020
> 
> 标签：asp.net-mvc, data-binding, drop-down-menu

我有一个 DropDownList，其中填充了从（匿名类型）生成的 SelectList，该 SelectList 具有两个属性“CountryId”（int）和“Description”（string）。我希望列表中选定的国家是默认国家。

```
Countries = new SelectList(countries, "CountryId", "Description", defaultCountry.CountryId); 
```

其中“国家”是来自 Linq 查询的匿名类型的 IQueryable。Country 是视图模型上的公共属性：

```
public class CountryBaseViewModel
{
     public SelectList Countries { get; set; }
     public Contact Contact { get;set; }
     ....
} 
```

HTML 如下所示：

```
<p>
<label for="CountryId">Home Country:</label>
<%= Html.DropDownList("CountryId", Model.Countries)%>
</p> 
```

这很好，当我加载页面时，选择了正确的国家。

但是当我将更改提交到控制器上的 Edit 方法时，绑定似乎失败了。

例如，当我使用以下 HTML

```
<p>
<label for="Contact.Job">Job/Post:</label>
<%= Html.TextBox("Contact.Job", Model.Contact.Job) %>
</p> 
```

我称之为方法

```
public ActionResult Create(Contact contact) 
```

在控制器上，然后从 TextBox 正确填写了 contact.Job 值，但 CountryId 不是。

我假设 MVC 使用“Contact.Job”（TextBox 1st）参数来设置它。但是 DropDownList 的第一个参数是“CountryId”而不是“Contact.CountryId”，因为如果是，那么当我加载它时，所选值不会显示在列表中。

看起来 TextBox 的第一个参数是用于数据绑定，而 DropDownList 的第一个参数是查找所选项目。

如何使用这种数据绑定样式在 DropDownList 中获取我想要的选定值，然后将其绑定到 Model.Contact.Country？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T07:00:29.893

您必须手动绑定下拉列表中的选定值，在 POST 上调用的控制器操作中查找您实际需要绑定的实体。您可以按照第二篇文章中的建议在 ViewModel 中使用强类型值，也可以在 ViewData 包中查找下拉列表的值。

所以，你已经准备好了所有的东西，但是在处理 POST 的控制器操作中，你需要获取下拉列表的值，加载与该值关联的实体，然后将该实体附加到你的对象'重新尝试更新。根据您的架构，它通常只是对存储库或数据访问服务的简单调用。在为您正在使用的主要对象保留更改之前，您将执行该手动绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T23:37:32.917

它可能不是可用的最优雅的解决方案，但我这样做的方式是手动设置 ActionResult 中对象的选定值：

```
contact.CountryID = Request.Form("CountryId") 
```

我觉得可能有更好的解决方案，但我不知道它是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T23:39:21.710

也找到了另一种方法，虽然我真的不认为它是理想的！

如果我将 CountryId 添加到视图模型并使用它来设置所选项目，那么它会在它更改时被填充。

然后我做

```
contact.CountryId = Model.CountryId 
```

感觉还是不是很好。

# remoting - 如何在 IronRuby 中使用远程处理

> ID：895760
> 
> 赞同：0
> 
> 时间：2009-05-21T23:20:39.970
> 
> 标签：remoting, ironruby

我试图在 IronRuby 中使用远程服务，但出现此错误。

试图在暴露“Contracts.SomeManager”的对象上调用在“IronRuby.Runtime.IRubyObject”类型上声明的方法。

你能帮我解决这个问题吗？

这是我的代码。

```
require "netincludes"

some_manager = System::Activator.get_object ISomeManager.to_clr_type, "tcp://localhost:8080/SomeManager"
some_manager.get_message "hello" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-23T05:41:18.683

在尝试编写一个简单的 IronRuby 远程处理示例时，我遇到了类似的情况（实际上是绑定错误），但我可能搞砸了我的示例，我没有玩太多远程处理。您能否在此处（或某处）发布完整的代码（连同 netincludes）

也许我们可以识别一个错误（或正在进行的实现）并添加到[IronRuby 的 codeplex 问题跟踪器中](http://ironruby.codeplex.com/WorkItem/List.aspx)。

如果事实证明不是错误，我将在此处编辑我的答案，我可以帮助您解决此问题。

# wpf - 如何控制 FlowDocument 缩放控件的高度

> ID：895761
> 
> 赞同：2
> 
> 时间：2009-05-21T23:21:42.340
> 
> 标签：wpf, wpf-controls, flowdocument

在下面，缩放控件最终与 Expander 控件中设置的 FontSize 成比例：

```
<ScrollViewer>
  <StackPanel>
    <Expander MaxHeight="500" Margin="5" Padding="5" FontSize="40pt" Header="Test Header">
      <FlowDocumentReader ViewingMode="Scroll" >
        <FlowDocument  Foreground="Black" FontSize="18pt">
          <List>
              <ListItem>
                <Paragraph>Test</Paragraph>
              </ListItem>
            </List>
        </FlowDocument>
      </FlowDocumentReader>
    </Expander>
  </StackPanel>
</ScrollViewer> 
```

我希望能够独立于 Expander 控件中的设置来控制缩放控件的高度。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:55:30.430

想出了一种方法来做到这一点。设置 FlowDocumentReader 的 FontSize。然后缩放按钮的大小将取决于 FlowDocumentReader 中的 FontSize。

可能不是理想的方法，但它确实有效。

# database - MongoDB 或 CouchDB - 适合生产？

> ID：895762
> 
> 赞同：485
> 
> 时间：2009-05-21T23:22:23.540
> 
> 标签：database, mongodb, couchdb

我想知道是否有人可以告诉我*[MongoDB](http://www.mongodb.org/display/DOCS/Home)*或*[CouchDB](http://couchdb.apache.org/)*是否已准备好用于**生产**环境。

我现在正在研究这些存储解决方案（目前我更喜欢 MongoDB），但是这些项目还很年轻，所以我预见我将不得不非常努力地说服我的经理我们应该采用这个新技术。

我想知道的是：

1.  现在谁在生产环境中使用 MongoDB 或 CouchDB？

2.  您如何使用 MongoDB/CouchDB？

3.  当您采用这种新的存储机制时，您遇到了哪些问题（如果有的话）（以及您是如何克服这些问题的）？

4.  您是如何处理必须处理的任何迁移问题的？

5.  您对这些解决方案中的任何一个有什么好的/坏的经验，您想分享吗？

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2009-05-23T00:07:08.563

我是 10gen（MongoDB 的开发人员）的 CTO，所以我有点偏见，但我也管理一些在生产中使用 MongoDB 的站点。

[businessinsider](http://www.businessinsider.com)已经在生产中使用 mongo 一年多了。他们将它用于从用户和博客文章到网站上的每张图片的所有内容。

[shopwiki](http://shopwiki.com)将它用于一些事情，包括实时分析和缓存层。他们每秒对一个相当大的数据库进行超过 1000 次写入。

如果您转到[mongodb 生产部署页面](http://www.mongodb.org/about/production-deployments/)，您会看到一些在生产中使用 mongo 的人。

如果您对生产部署的规模或范围有任何疑问，请在我们的用户列表上发帖，我们将非常乐意提供帮助。

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-07-23T22:16:58.723

[BBC](http://BBC.co.uk)和[meebo.com](http://meebo.com)在生产中使用 CouchDB，我的一位客户也是如此。以下是使用 Couch 的其他人的列表：[CouchDB in the wild](http://wiki.apache.org/couchdb/CouchDB_in_the_wild)

主要挑战是知道如何组织文档并停止思考关系数据。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-07-20T07:12:05.790

[SourceForge](http://sourceforge.net/)使用 MongoDB。请参阅[此演示文稿](http://www.infoq.com/presentations/MongoDB-at-SourceForge)或[阅读此处](http://compoundthinking.com/blog/index.php/2009/07/18/serving-developers-and-users-at-sourceforge/)。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2012-02-16T22:56:25.890

我们正在为我们的商店运行 CouchDB 作为 MySQL 的替代品（70.0000 个商品/商店，所有商品的总共 400 万个属性，商品之间的交叉连接）。

我们的目标是：

1.  从主数据库轻松复制到具有不同文档的多个客户端。

2.  快速预先计算的数据，例如“我有多少具有此属性和过滤器的零件，适合这些条件”

事实：

1.  我们的商店现在运行速度比 MySQL 快得多（并且 mysql-database 需要额外 1-3 天的预计算（因此每月更新两次），使数据准备好进行产品计数和过滤，CouchDB 需要 5 小时，所以我们可以每晚更新产品数据）
2.  为商店节点设置（过滤的）数据分发和备份既快速又简单

但是也：

1.  理解 map/reduce 和没有连接的限制是相当困难的
2.  在没有外部程序的情况下，无法对“删除位置”或“更新位置”等数据进行操作
3.  除非出现问题，否则复制效果很好；那么真的很难找出原因（对于初学者）
4.  如果您不是 Linux 极客，那么安装没有二进制文件的 CouchDB（是的，有一些，但不是针对每个操作系统/版本）可能会很困难。但是 CouchDB 社区很有帮助（#couchdb），幸运的是，那里有一些公司（cloudant、iriscouch）提供从免费到大企业的服务。
5.  CouchDB 正在向前发展，因此正在进行许多更改（改进），可能会改变他们的工作方式。但基本情况保持稳定。

结果：MySQL作为数据创建和维护的数据库是可靠且易于理解和处理的。我认为我们不会改变这一点。但我也不想错过 CouchDB 视图的强大功能和复制设置的简易性。

由于配置错误和忘记了 logrotates（视图构建需要太长时间或挂起，复制停止），生产沙发有时会在工作数月后引起麻烦，但不会丢失数据，并且总是可以轻松重置。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-07-14T00:35:54.063

我在生产中使用 CouchDB。目前它存储了所有那些不在原始数据库模式中的“可选”字段。现在我正在考虑将所有数据移动到 CouchDB。

我承认，这是一个相当冒险的步骤。首先，因为它还不是 v1.0。其次，因为它需要驱动器空间。根据我的计算，CouchDB 文件（带索引）比具有相同行的 MySQL 数据库大 30 倍左右。但我很确定它会很好。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-04-06T05:37:25.407

CouchDB 0.11（3 月底发布）是 1.0 的功能冻结版本。这意味着我们将保持与 1.0 的当前 API 的兼容性，所以如果您有一段时间没有再看一下 CouchDB，那么现在是时候重新审视一下 CouchDB。

[CouchDB 0.11 源代码版本可在此处获得](http://couchdb.apache.org/downloads.html)。这里[链接了二进制安装程序和其他好东西。](http://www.couch.io/downloads)

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2009-05-21T23:37:24.553

我对 MongoDB 一无所知，但来自[CouchDB 常见问题解答](http://wiki.apache.org/couchdb/Frequently_asked_questions#is_couchdb_ready_for_production)：

> **CouchDB 准备好投入生产了吗？**
> 
> 是的，请参阅[InTheWild](http://wiki.apache.org/couchdb/InTheWild)了解使用 CouchDB 的部分项目列表。另一个很好的概述是[CouchDB 案例研究](http://www.couchone.com/case-studies)

另外，一些链接：

*   [回复：当前的 CouchDB 状态？](http://osdir.com/ml/couchdb-user/2009-01/msg00015.html)
*   [SimpleDB、CouchDB 和其他“新”数据存储 - 反馈](http://discuss.joelonsoftware.com/default.asp?biz.5.727383.8)

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2009-05-22T09:26:57.600

我们在生产中使用 couchdb，并且在项目进入 Apache 保护伞之前就已经使用了。

我们使用它来存储我们可能会使用 dbms 的所有内容，以及各种非结构化数据。就个人而言，我真的很喜欢您如何将各种数据放入其中并根据情况使用视图来剔除您不需要的内容。

最困难的部分是摆脱 dbms 的思维方式。为了安全起见，当存储格式发生变化时，我们编写了自己的迁移工具，所以这并不是真正的问题。

我们还没有任何负面的经历，但话又说回来，我们还没有在任何类型的巨大负载下进行设置。我*认为*事情会很好，因为我们有两个从属服务器，它们从一个获取所有写入的主服务器复制。我很确定我们不必那样做才能使复制正常工作，但这就是我们一开始就设置它的方式，然后它就卡住了。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2009-05-25T21:10:05.887

我们使用 CouchDB 存储移动入站和出站消息，并通过我编写的一些自定义视图报告此流量。前端是用 Python 编写的。我们没有遇到任何真正的技术问题，它自 12 月底以来一直在运行。我遇到的唯一障碍是最初考虑 MapReduce，但是一旦我学会了如何做到这一点，其他一切都很顺利。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2010-12-01T21:09:55.000

我们目前在生产中使用 MongoDB 作为缓存层以及产品导入和操作产品数据的存储引擎。我们是一家电子商务公司，管理超过 200 万个产品（100+ 百万个属性），跨越 10 多个分销商，如果没有 MongoDB，这项任务几乎是不可能的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-06T10:40:01.747

我们目前正在使用 mongodb 作为我们通过 LAN 进行协作的文件存储服务。此外，像[trello](http://trello.com)这样的项目正在使用 mongodb 作为他们的后端数据存储。我之前使用过couchdb，但没有生产能力。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-06-25T11:25:01.510

我们在我们的移动后端服务[Netmera 的生产环境中使用 MongoDB。](http://netmera.com/)我们使用它来存储所有用户和内容数据。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-28T08:54:39.090

我已经在生产环境中使用 CouchDB 将近 2 年了。由于项目直接从 CouchDB 实施开始，因此没有迁移工作。它作为一个数据库，存储单个电子产品从开始到包装的数据。

由于我们销售的传感器需要高精度，因此我们在不同阶段进行了大量测试，所有这些都将存储在 CouchDB 上的一个文档中。

我从我的经验中学到了一些学习曲线，那就是充分利用视图（或也称为永久视图）。视图应该是经常调用的数据库的一部分的“小过滤器”。

我的 CouchDB 数据库不像其他大公司那么疯狂。但到目前为止，我仍然做得很好。目前我有 700MB 的 24000 个文档。

我喜欢 CouchDB 的功能是“复制”，“存储文档的修订版”。

我读过很多关于 MongoDB 的好评，如果有机会我会想尝试一下。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-11-22T08:18:23.650

我们在生产中使用 mongodb

www.beachfront.io - 每秒接近 5k 写入请求 www.beachfrontbuilder.com - 每秒 500 次读取/写入请求，维护 1000 万用户数据和 olap。

数据归档面临的唯一挑战是我们通过实施自定义组件来克服。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-20T06:22:43.407

这个问题已经接受了答案，但现在又多了一个**NoSQL DB**的趋势，因为它的许多强大功能。它是`Couchbase`；它`CouchbaseLite`在移动平台和`Couchbase Server`服务器端运行。

**以下是 Couchbase Lite 的一些主要功能。**

Couchbase Lite 是一个轻量级、面向文档 (NoSQL)、可同步的数据库引擎，适合嵌入到移动应用程序中。

**轻量级的意思：**

嵌入式——数据库引擎是链接到应用程序的库，而不是单独的服务器进程。小代码量——对于通常通过蜂窝网络下载的移动应用程序很重要。快速启动时间——这很重要，因为移动设备的 CPU 相对较慢。内存使用率低——典型的移动数据集相对较小，但某些文档可能包含大型多媒体附件。良好的性能——当然，确切的数字取决于您的数据和应用程序。

**面向文档的意思是：**

以灵活的 JSON 格式存储记录，而不需要预定义的模式或规范化。文档可以有任意大小的二进制附件，例如多媒体内容。应用程序数据格式可以随着时间的推移而发展，而无需显式迁移。MapReduce 索引提供快速查找，无需使用特殊的查询语言。

**可同步的意思：**

通过高效、可靠、经过验证的复制算法，可以使数据库的任意两个副本同步。同步可以是按需或连续的（延迟几秒钟）。设备可以与远程服务器上的大型数据库的子集同步。同步引擎支持间歇性和不可靠的网络连接。可以检测和解决冲突，应用程序逻辑完全控制合并。修订树允许复杂的复制拓扑，包括服务器到服务器（用于多个数据中心）和对等，而不会丢失数据或错误冲突。Couchbase Lite 为无缝 iOS (Objective-C) 和 Android (Java) 开发提供原生 API。此外，它还包括用于 PhoneGap 的 Couchbase Lite 插件，

[您可以在Couchbase Lite](http://docs.couchbase.com/couchbase-lite/cbl-concepts/)上探索更多信息

和 [Couchbase 服务器](http://www.couchbase.com/couchbase-server/overview)

这将是下一件大事。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-02-28T19:35:41.633

说到生产，无缝故障转移/恢复都需要保姆
1-Couchbase，没有无缝故障转移/恢复，需要人工干预。
如果不止一个节点丢失，重新平衡需要太多时间，风险太大。

2- 带有分片的 Mongo，从丢失配置服务器中恢复数据，不是一件容易的事

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-05-16T17:06:27.087

[Adobe](http://Adobe.com)在即将发布的*Adob​​e Experience Manager*（以前称为*Day CQ* ）中使用**MongoDB**作为核心数据库引擎。

 **我工作的机构的几个客户正在为大客户的项目使用**CouchDB**。

在我看来，两者都是伟大且可行的数据库。:)

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2014-08-05T06:07:36.710

这是使用 mongoDB 的生产部署站点列表

*   **The New Yorks Times** : 在表单构建应用程序中使用它来提交照片。Mongo 缺少模式使生产者能够定义自定义表单字段的任意组合。
*   **SourceForge**：用于SourceForge首页、项目页面和所有项目的下载页面的后端存储。
*   **比特.ly**
*   **易趣**
*   **IGN**：为 IGN 的实时流量分析和 RESTful 内容 API 提供支持。
*   **Justin.tv**：为 Justin.tv 的内部分析工具提供动力，以实现开箱即用的解决方案无法提供的病毒式传播、用户保留和一般使用统计数据。
*   **后世**
*   **直觉**
*   **Foursquare** : 分片的 Mongo 数据库用于foursquare 的大多数数据。
*   **Business Insider**：从 2008 年初开始使用它。网站的所有数据，包括帖子、评论甚至图像，都存储在 MongoDB 上。
*   **Github**：用于内部报告应用程序。
*   **Examiner**：将他们的站点从 Cold Fusion 和 SQL Server 迁移到 Drupal 7 和 MongoDB。
*   **Grooveshark**：目前每天使用 Mongo 管理超过一百万个独立用户会话。
*   **嗡嗡声**
*   **铁饼**
*   **Evite**：用于分析和快速报告。
*   **广场空间**
*   **Shutterfly**：用于Shutterfly 中的各种持久数据存储需求。MongoDB 帮助 Shutterfly 构建了无与伦比的服务，使客户与生活中最重要的人之间建立更深入、更私人的关系。
*   **颠倒**
*   **分享这个**
*   **Mongohq**：为 MongoDB 提供托管平台，并使用 MongoDB 作为其服务的后端。我们的托管中心页面提供了有关 MongoHQ 和其他 MongoDB 托管选项的更多信息。

和更多...

摘自： http: [//lineofthought.com/tools/mongodb](http://lineofthought.com/tools/mongodb)

您也可以在那里查看其他数据库或工具。

* * *

## 回答 #19

> 赞同：-6
> 
> 时间：2013-03-23T16:41:59.613

MongoDB 在对企业的许可方面存在一些问题，我不确定细节，但我们的法律部门没有明确地告诉我们，我们不允许在我们的任何产品中使用 MongoDB。

# c# - .Net 远程处理而不使用 .Net 远程处理？

> ID：895767
> 
> 赞同：3
> 
> 时间：2009-05-21T23:25:02.783
> 
> 标签：c#, .net, wcf, remoting

我寻求一些建议比什么都重要。

我有以下示例：

Appication1.exe - 有对象 MyList

Application2.exe - 需要访问 MyList 并与对象交互，就好像它是从 Application2 创建的一样。

我应该使用 .NET Remoting（即 2.0）还是 WCF 或其他技术堆栈？有哪些框架可以支持这一点？每个人的优点/缺点是什么？

我应该注意，这更像是一个“帮助”应用程序，开发团队之外的任何人都不会使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T18:17:06.820

如果不了解有关您的应用程序的更多详细信息，很难说，但我个人不会在这种情况下使用 WCF。WCF 有一个非常重量级的管道，并且需要付出相当大的努力来设置和使用。它的 API 也非常适合 Web 服务，在您的情况下这似乎有点过头了。微软声称 WCF 取代了远程处理，因为他们不想再支持远程处理，但是在两者都使用之后，我可以说 WCF 不如远程处理在同类应用程序中移动数据。

然而，有许多方法可以将数据从一个应用程序移动到另一个应用程序，它们各有优缺点。对所有这些方法的全面讨论超出了本评论的范围。你能添加更多关于你的使用场景的细节吗？这个列表中有什么样的数据，有多大，它来自哪里，正在进行什么样的修改，App 1 是否需要查看更改，App 2 是否会将数据发送到其他地方完成等...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T18:41:10.837

我假设应用程序 1 是生产应用程序，应用程序 2 是仅开发帮助应用程序。如果是这种情况，您的目标应该是最小化或消除应用程序 1 中与支持应用程序 2 相关的任何额外开销。因此，非常重的 WCF 应该作为一个选项被消除。远程处理也会增加开销。

您可以序列化对象 - 也许 XML 适合这个？

这个问题有太多变数，无法完全回答。您能否提供更多关于应用程序 1 和应用程序 2 的信息？他们跑到哪里去？你感兴趣的对象经常变化吗？他们如何维护国家？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T01:12:48.277

很难说。WCF当然是一种可能性。当然，您必须控制这两个应用程序并更改 App1 以支持（在推或拉模型上）将数据传输到 App2。如果您不一定需要按需交换数据，则可以考虑将数据库作为传输数据的方法，尤其是。如果 App1 已经将一些数据写入数据库。然后你可以让 App2 从那里获取它需要的数据。或者，如果交换不经常发生，您甚至可以使用文件系统。序列化列表并使用 App2 抓取它。（我只建议这样做，因为这听起来像是您正在尝试将开发工具挂钩到已经存在的东西中）。

远程处理是一种较老的技术，它充满了难以实施和部署的问题。WCF 更干净，更容易实现。所以，如果它介于两者之间，我肯定会推荐 WCF 而不是远程处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T01:04:19.403

我认为合理的选择是使用 .NET 远程处理。您必须在 Application1 上启动一个 Web 服务，以便 Application2 与之通信。唯一真正的缺点是“MyList”需要用 MarshalByRefObject 标记。MSDN 说 Remoting 现在是传统的东西（.NET 3.0），有利于 WCF。但据我所知，Remoting 是城里唯一的跨应用程序通信游戏。

# asp.net - JS/CSS 包括部分替换、调试与发布

> ID：895768
> 
> 赞同：9
> 
> 时间：2009-05-21T23:25:04.517
> 
> 标签：asp.net, javascript, msbuild, compression

我很想听听人们如何处理条件标记，特别是在发布和调试构建之间的母版页中。

这适用于处理连接的 js 和 css 文件的特定场景。我目前正在使用 YUI compress 的 .Net 端口从大量单独的文件中生成单个 site.css 和 site.js。

我想到的一个想法是将 js 和 css 包含部分放在用户控件或面板集合中，并根据程序集的 Debug 或 Release 状态有条件地显示`<link>`和标记。`<script>`类似于以下内容：

```
#if DEBUG
    pnlDebugIncludes.visible = true
#else
    pnlReleaseIncludes.visible = true       
#endif 
```

面板在语义上真的不是很好 - 将`<script>`标签包装在 a`<div>`中有点恶心；必须有更好的方法。我还认为像 inside 这样的块级元素`<div>`将`<head>`是无效的 html。

另一个想法是这可以使用 web.config 部分替换来处理，但我不确定我将如何去做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T23:54:30.090

我刚刚在我的 ASP.NET MVC 项目的母版页中尝试了这个并且它有效。如果在 DEBUG 模式下我使用 jQuery 的开发版本，如果不是在 DEBUG 模式下，我使用缩小版的 jQuery：

```
<head runat="server">
<% #if DEBUG %>
    <script type="text/javascript" src="<%= Url.Content("~/Scripts/jquery.js") %>"></script>
<% #else %>
    <script type="text/javascript" src="<%= Url.Content("~/Scripts/jquery.min.js") %>"></script>
<% #endif %>
</head> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T23:56:52.907

这里有一个关于 web.config 设置更改的不错的讨论：

[在开发和生产环境中使用不同的 Web.config](https://stackoverflow.com/questions/305447/using-different-web-config-in-development-and-production-environment)

注意：您问的是一个不同的问题，但我建议还是看一下，因为它是关于如何在实时设置和调试设置之间切换的很棒的建议集合，并且所有答案（IMO）都有一些价值 - 不仅仅是最高投票/接受的答案。

**就个人**而言，我使用这里解释的一种方法，并认为它是最灵活的，并且适用于所有类型的配置更改，因为它是基于文件的，但允许它们根据解决方案配置自动交换：

[http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)

本质上，您运行预构建事件以将 Web 配置与磁盘上的另一个配置交换，并将解决方案配置名称附加到文件名。例如，我有 web.config.release、web.config.debug 甚至是 web.config.neilathome。

然后，我通过创建部分类并将在我的解决方案配置之间更改的内容放在他们自己的文件中，对条件代码位使用完全相同的方法。例如，我有 sync_timersettings.cs，它是一个包含一些常量的部分类，这些常量定义了我的更新代码调用 Web 服务的频率。或者您可以将所有设置放在 app.settings 文件中，然后这样做。

我发现它是一个非常灵活的解决方案，它让我可以交换大量的 javascript 和 css，只要您花时间将配置之间更改的内容放在它们自己的文件中，您就可以进入可以调试的状态在调试解决方案配置中，然后切换到一键发布和部署。

进一步说明：

```
#if DEBUG
    pnlDebugIncludes.visible = true
#else
    pnlReleaseIncludes.visible = true       
#endif 
```

**对评论的回应：**

这仅在您有调试解决方案配置和另一个是您的实时部署时才有用。当您（像我一样）有暂存、发布和 neilonhislaptop 解决方案配置时，它将不起作用，因为只有在启用调试时才会设置 DEBUG 符号。解决方法是转到 Web 应用程序的属性页面，然后在构建选项卡中，为每个构建配置放置一个条件符号。IE，将您的构建配置设置为发布并将“发布”放在该选项卡的条件符号框中。然后对不同的构建配置执行相同的操作，其中的条件符号框将根据您的构建配置自动更改。#if 条件编译指令将按预期工作。

Bayard 询问有关如何使用它来更改配置之间的标记的更多信息。好吧，您*可以*使用 to 换出整个 .aspx 页面 - 有 home.aspx.release 和 home.aspx.debug 但这意味着您必须在每个文件中重复大量标记。我的解决方案是在我的应用程序中添加一个部分类。例如，我的“ViewImage”页面中包含以下类定义：

```
public partial class ViewImage : System.Web.UI.Page 
```

..所以我创建了一些具有相同签名的类文件并将它们命名为“ViewImage_titleset.cs.debug”和“ViewImage_titleset.cs.staging”：

```
namespace Website
{
    public partial class ViewImage : System.Web.UI.Page
    {
        public void SetTitle()
        {
            Page.Title = "Running in debug mode";
        }
    }
} 
```

和

```
namespace Website
{
    public partial class ViewImage : System.Web.UI.Page
    {
        public void SetTitle()
        {
            Page.Title = "Running in staging mode";
        }
    }
} 
```

..在 ViewImage 的页面加载事件中调用 SetTitle 将根据构建配置的到位来更改标题。这仅在您以编程方式更改页面时才有效。

最好使用上面的条件编译方法来更改这样的代码，并保留文件交换方法来更改图像或 web.configs 等非代码文件。只要确保您没有设置要在发布时部署的替代文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T04:55:58.643

关于 JS 文件，我所做的是使用[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)来预编译 Web 应用程序。如果配置为 Release，则构建完成后，我会缩小 JS 文件并替换输出目录中的文件。这一切都是通过[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)完成的，因为 Web 部署项目是 MSBuild 文件。

# f# - F# 使用自定义类设置

> ID：895769
> 
> 赞同：4
> 
> 时间：2009-05-21T23:25:18.790
> 
> 标签：f#, set, icomparable

我正在尝试将 Set 操作与我拥有的类一起使用。此类的每个实例都有一个唯一的 ID。我是否需要实现 System.IComparable 接口，如果需要，我该怎么做？

```
type SomeClass(id : int) =
    member this.ID = id

let someSet = Set.of_list [SomeClass(1); SomeClass(2)]
let test = someSet.Contains(SomeClass(2)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T23:50:50.953

这是一个应该有效的实现：

```
type SomeClass(id : int) =    
    member this.ID = id
    override this.Equals(o) =
        match o with
        | :? SomeClass as sc -> this.ID = sc.ID
        | _ -> false
    override this.GetHashCode() =
        id.GetHashCode()
    interface System.IComparable with
        member this.CompareTo(o) =
            match o with
            | :? SomeClass as sc -> compare this.ID sc.ID
            | _ -> -1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T23:37:46.190

我相信你需要实现`IComparer<T>`集合理解（例如`Set.of_list`）才能工作。（*Not* `IComparable<T>`，这往往不太广泛使用 - 尽管我可能是错的。）

这篇[博](http://bugsquash.blogspot.com/2009/01/implementing-interfaces-in-f.html)文大体上解释了如何在 F# 中实现接口。它还包括一个实现 的类型的具体示例`IComparer<T>`，这实际上并不像您希望的那样简单。

```
type Comp() =  
    interface IComparer with  
        member x.Compare(a, b) = 0  
    member x.Compare(a, b) = (x :> IComparer).Compare(a,b) 
```

让我知道是否适合您。我怀疑您实际上可能需要实现`IEqualityComparer<T>`，因为据我所知，这是 LINQ 集扩展方法所基于的。（在 BCL 中进行比较的所有这些接口真的让人感到困惑！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T11:41:20.527

关于对我的其他答案的评论，您可以将其纳入可重用的基类，但我不确定这是否真的是一个好主意：

```
type EqCompBase<'EqKey, 
        'DerivedType when 'DerivedType :> EqCompBase<'EqKey,'DerivedType> >
        (id : 'EqKey) =    
    member this.ID = id
    override this.Equals(o) =
        match o with
        | :? EqCompBase<'EqKey, 'DerivedType> as sc -> this.ID = sc.ID
        | _ -> false
    override this.GetHashCode() =
        id.GetHashCode()
    interface System.IComparable with
        member this.CompareTo(o) =
            match o with
            | :? EqCompBase<'EqKey, 'DerivedType> as sc -> compare this.ID sc.ID
            | _ -> -1

type SomeClass(id : int, otherFieldThatDoesNotMatterForEquality : string) =
    inherit EqCompBase<int, SomeClass>(id)

let someSet = Set.of_list [SomeClass(1,"yadda"); SomeClass(2,"blah")]
let test = someSet.Contains(SomeClass(2,"foo"))
printfn "%A" test  // true 
```

# c# - 如何执行滚动差异？

> ID：895772
> 
> 赞同：2
> 
> 时间：2009-05-21T23:25:37.103
> 
> 标签：c#, diff, patch

您如何在 2 个文件之间执行滚动差异来仅确定已更改的文件部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T23:39:44.270

rsync 是您正在寻找的一个示例。甚至还有关于它的技术报告：http: [//www.samba.org/rsync/tech_report/tech_report.html](http://www.samba.org/rsync/tech_report/tech_report.html)

# document - 大容量扫描和ocr自动解决方案？

> ID：895773
> 
> 赞同：1
> 
> 时间：2009-05-21T23:26:17.570
> 
> 标签：document, ocr, scanning, kofax

我们需要大容量扫描和 ocr 解决方案

我们正在谈论每天将大约 4000 个文档数字化，并使用 ocr（带有隐藏文本）将它们保存为 pdf 文件...

该解决方案应该让操作员扫描文档并自动将文件保存到特定的网络资源，由将其上传到数据库的应用程序获取......

我们正在评估来自 kofax [http://www.kofax.com/的企业解决方案](http://www.kofax.com/)

您还知道哪些其他产品？

有类似要求的经验吗？

任何开源（或至少可访问）解决方案？

com，activex api支持吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-18T01:19:00.303

有许多扫描产品供应商可以做你想做的事——扫描、索引、生成带有 OCR 覆盖的 PDF（我个人更喜欢 PDF 中的 OCR 底层）。对于专门从事扫描的供应商来说，这些要求是微不足道的。除了 Kofax 之外，仅举几个其他供应商/产品：

*   EMC/Captiva 的 InputAccel 产品
*   数据帽
*   eCopy ShareScan
*   真理/卡迪夫/自治

许多文档管理解决方案还具有内置扫描前端，但它们通常不如专用捕获产品功能强大。几乎所有这些解决方案都支持 COM/ActiveX API。我不知道任何用于扫描的开源解决方案，但我也从未真正搜索过任何解决方案。

大多数扫描软件供应商确实使用“批量”或“容量”许可证。通常，卷在期限结束时更新（即每年 100 万页 - 每年自动更新，无需额外费用）。因此，从某种意义上说，如果您每年购买 100 万张图像并且最终只扫描 500K 页，则您不会严格按照“每页”付费，您不会获得退款。一次性卷不会自动续订并且当它用完时，您将需要购买额外的卷，尽管这种情况不太常见。大多数供应商正在从加密狗转向控制数量，并转向软件许可。

**关于 Kofax 的旁注：**

Kofax 历来是通过增值经销商系统销售的，因此各种实施的质量可能差别很大。此外，它还具有高度可定制性，并具有多种风格和大量附加模块，因此一个客户的 Kofax 系统可能与其他系统有很大不同。

Kofax 用于企业级系统，每年扫描和自动捕获数以百万计的文档。它在文档扫描市场份额中占有相当大的份额。不，我不是 Kofax 的粉丝，如果我是的话，我就不会提到竞争产品了。但是，我对它非常熟悉。与市场上的其他产品一样，它也有优点和缺点。我意识到迈克尔只是在转述他所听到的内容，但我不能不发表评论就让这种笼统的概括通过。说具有很大市场份额的产品对于扫描“没有用处或用户友好”有点像说“Windows 不是有用的服务器操作系统”。笼统的概括太笼统了。

干杯，

布赖恩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T12:30:06.053

你可以试试 ChronoScan，它通过 tesseract 有免费的 OCR，并且有 Forms Recognition Options，而且它对于非商业用途是免费的。

该软件处于高级开发阶段，您有一个论坛可以直接与开发人员交谈。

[http://www.chronoscan.org](http://www.chronoscan.org) [短视频阅读表格](http://youtu.be/sKUjaGfV9FE)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-10T22:18:41.990

PSIGEN 是 Kofax 的绝佳替代品，功能丰富且价格合理。

[Kofax 替代扫描和捕获应用程序](http://www.psigen.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T23:37:41.433

Kofax 不是很有用或用户友好（根据我与县合作的同行）。它足够，但不是很好。

我们使用全 Adob​​e 解决方案。要遵循的详细信息（我不负责管理该区域，因此我必须为您收集一些信息）。

更新：我们使用

Adobe Acrobat Capture 3.0
两台带有 ADF Acrobat Standard 或 Professional 的 RICOH 彩色扫描仪 IS760D
（取决于用户）

我们拥有一个庞大的图书馆（近 6,000 个文档），其中包含数十万个可用的扫描页面。进行扫描的计算机上有一个我们购买的加密狗（250,000 次扫描，直到我们需要购买“更新”）；自从处理那一天的绅士回家以来，我没有可用的成本，但我记得它是每页微美分。

我们经常扫描数百页需要当天完成的文档，完成这项任务没有问题。

如果您想了解什么是我们的一些工作（网络前端或排序，我们的库）的链接，请访问[http://acequia.ccrfcd.org/FileLibrary2/FileLibrary.aspx](http://acequia.ccrfcd.org/FileLibrary2/FileLibrary.aspx)我们已经完成了。

至于将这些 PDF 放入数据库，创建一个应用程序（可能是一个服务）来监控目录并抓取 Capture 运行后弹出的每个 PDF，将信息复制到数据库中，然后删除是很容易的或将其移至新家。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-25T13:02:10.423

你希望你的 OCR 有多好？您是否需要所有内容都是人类可读的，或者您只需要一些内容才能对文档进行分类（客户编号；文档类型；条形码......）。

[http://www.irislink.com](http://www.irislink.com)是一家开发文档扫描和分类解决方案的公司。
他们的软件包含在多个品牌的多功能和消费扫描仪中。该公司更倾向于提取信息并使用它（将发票自动输入会计软件）。
我的经验是它比 Kofax（我们两者都使用）更好地处理 OCR 文本（更正单词等）；尽管 Kofax 可以进一步扩展以达到更好的水平（这意味着更多的设置工作和更多的维护）。

这两种软件对于它们如何处理文档都非常有用。
如果您只想扫描文件；转换为 pdf 并保存在网络共享中；您可能已经足够购买一台好的扫描仪并使用随附的软件了。
您可能还希望查看 tesseract 项目；这是一个开源的ocr引擎，效果很好。

# ruby-on-rails - 为什么 Rails 不能与 mod_ruby 一起工作？

> ID：895776
> 
> 赞同：8
> 
> 时间：2009-05-21T23:26:34.093
> 
> 标签：ruby-on-rails, ruby, mongrel

如果这听起来像一个愚蠢的问题，我很抱歉，因为它似乎是那些“不废话”的事情之一，但有人可以向我解释为什么 Rails 需要它自己的服务器（Mongrel、WEBrick、mod_rails 等）并且不能t 简单地使用 mod_ruby？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T02:49:41.890

已经回答说 mod_ruby 会导致共享 Ruby 解释器，但这特别成问题的原因是它意味着类相互践踏。例如，考虑定义与某个数据库的连接的 ActiveRecord::Base。这个类的状态在不同的 Rails 应用程序之间是不同的，所以一旦在同一个解释器上运行多个 Rails 应用程序，就会发生严重的类冲突。

另一个答案表明 Rails 是单线程的，但在 Rails 2.2.2 中不一定如此。我会将此作为对该答案的评论，但我穿着业力紧身衣:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T23:52:35.460

所有运行 mod_ruby 的 apache 实例共享一个 Ruby 解释器。这意味着它根本不能在共享主机上使用，或者在每台机器运行多个 Rails 应用程序的任何环境中使用。可能可以在一台机器上运行同一应用程序的多个副本，但您也可能很容易遇到难以追踪的错误。因为 rails 是单线程的，所以每台机器只运行一个 ruby​​ 进程是不可想象的。

此外，它的表现也不是那么好。

如需更深入的讨论，请查看[此 Phusion 员工的博客](http://izumi.plan99.net/blog/index.php/2008/03/27/passenger-and-other-ruby-frameworks/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T00:01:50.043

“mod_ruby 每个 Apache 进程使用一个解释器，这意味着应用程序在命名空间中相互遍历。至少对于 Rails，这是不可接受的，所以如果你想要 mod_ruby，每个 Apache 设置只有 1 个应用程序。” ——[大卫·海涅迈尔·汉森](http://groups.google.com/group/comp.lang.ruby/msg/a7401bf72086eeab)

现在它已经被一些人嘲笑了，如果你仍然想使用它，请查看[mod_ruby 常见问题解答](http://wiki.modruby.net/en/?FAQ)

[Dreamhost](http://blog.dreamhost.com/2008/01/07/how-ruby-on-rails-could-be-much-better/)确实尝试将 ruby​​ 包含到他们的托管环境中，这是从他们的博客中关于他们从这项努力中得出的结论。

# regex - 禁止字符组合的正则表达式

> ID：895777
> 
> 赞同：2
> 
> 时间：2009-05-21T23:26:55.120
> 
> 标签：regex

除了非常基本的正则表达式之外，我不太熟悉使用任何东西。我有一个允许除单引号、双引号和问号之外的所有字符的字段（我知道，这不是一个好主意，但我能说什么。我的客户不会在这个要求上让步。）现在，添加了一个新要求。@# 的字符组合也是不允许的。我当前的正则表达式是 ^[^?'"]{0,1000}$ 我现在如何将 @# 的要求包含为不允许的特定字符组合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T23:33:23.453

没有长度限制，你可以做

```
^([^"'?@]|@+[^"#'?@])*@*$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T00:04:51.050

注意：如果支持前瞻、后瞻，另一种选择是：

```
^(?:(?<!@)#|@(?!#)|[^'"?@#]){0,1000}$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T01:03:34.240

Dave 有一个问题 - OP 的要求是禁止原始字符和 @# 的特定组合。此外，在这种情况下，如果正则表达式测试为假，而不是测试为真，则允许更简单，因为正则表达式变得更易于阅读。它还否定了长度要求，如果需要，可以作为单独的测试来完成。

```
!val.test(/[^"'?]|@#/) 
```

# c# - 如何在 DataGridView 中获取选定的 DataRow？

> ID：895778
> 
> 赞同：18
> 
> 时间：2009-05-21T23:27:39.487
> 
> 标签：c#, winforms, data-binding, ado.net, datagridview

我有一个绑定到 DataGridView 的 DataTable。我在 DGV 中启用了 FullRowSelect。有没有办法将所选行作为 DataRow 获取，以便我可以对所选行的值进行强类型访问？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-21T23:31:57.590

```
DataRowView currentDataRowView = (DataRowView)dgv1.CurrentRow.DataBoundItem
DataRow row = currentDataRowView.Row 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T23:30:51.277

我不确定如何使用 oa BindingSource 来做到这一点，以下是如何使用 BindingSource 来做到这一点：

```
var drv = bindingSoure1.Current as DataRowView;
if (drv != null)
  var row = drv.Row as MyRowType; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-03T15:57:40.473

通过获得以下属性是可能的：

```
this.dataGridView.SelectedRows 
```

一个获得类型的集合：**DataGridViewSelectedRowCollection**。它包含以下类型的项目：**DataGridViewRow**。

然后可以通过以下方式获得具有自己类型的bounditem：

```
DataGridViewSelectedRowCollection list = this.dataGridViewInventoryRecords.SelectedRows;
MyType selectedItem = (MyType)list[0].DataBoundItem; //[0] ---> first item 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T23:31:45.300

您应该能够直接将您选择的行转换为绑定到 DataGridView 的强类型行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-29T10:12:17.753

尝试这个：

```
DataRow row = gridView1.GetDataRow(gridView1.FocusedRowHandle); `        
if (row != null)
{
     XtraMessageBox.Show(row["ID"].ToString());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-01T19:57:08.517

如果数据集中没有使用 tableadapter，则不可能对 datagridview 进行强类型访问。

要在通过 bindingsource 将 datagridview 绑定到数据表时访问强类型变量，请执行以下操作：

创建一个新项目。

插入一个名为 ds1 的数据集和一个名为 dt99 的数据表，其中包含名为 DataColumn1 和 DataColumn2 的列，它们都是字符串类型。

[![在此处输入图像描述](https://i.stack.imgur.com/fyY9U.png)](https://i.stack.imgur.com/fyY9U.png)

在主窗体中添加一个datagridView并绑定到dt99

[![在此处输入图像描述](https://i.stack.imgur.com/9tYlG.png)](https://i.stack.imgur.com/9tYlG.png)

以便 dt99BindingSource 连接 datagridview 和 datatable

[![在此处输入图像描述](https://i.stack.imgur.com/00QyS.png)](https://i.stack.imgur.com/00QyS.png)

为datagridview的Selection Change添加和事件处理程序，并插入以下代码

私人无效dataGridView1_SelectionChanged（对象发送者，EventArgs e）{

```
 ds1.dt99Row d= ((ds1.dt99Row)((DataRowView)dt99BindingSource.Current).Row);

  Debug.WriteLine(d.DataColumn1 + " " + d.DataColumn2); 
```

}

现在您有强类型变量（d.DataColumn1 和 d.DataColumn2）来访问在 datagridview 上选择的单元格

另一个有趣的特性是，插入数据集中的数据表提供了一组公共类，这些类在处理数据表时有很大帮助，例如

```
 private void Form1_Load(Object sender, EventArgs e)
    {
        ds1.dt99.Adddt99Row("K", "B");
        ds1.dt99.Adddt99Row("L", "D");
        ds1.dt99.Adddt99Row("M", "F");
        ds1.dt99.Adddt99Row("N", "H");

        ds1.dt99Row dr = ds1.dt99.Newdt99Row();
        dr.DataColumn1 = "X";
        dr.DataColumn2 = "Y";
        ds1.dt99.Adddt99Row(dr);

    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-29T19:52:49.753

如果您已将 datagridview 绑定到数据库中的表或视图，则可以将数据作为强类型对象获取。

此答案适用于在设计时使用 DataSet 连接到数据库的 Windows 窗体。示例名称为 DataSet1，示例表名称为 Customer_Info。

```
// cast the data bound item to DataRowView so you have
// access to "Row", which
// has the actual data for the row in typed fields. 
DataRowView drv = dgv.SelectedRows(0).DataBoundItem as DataRowView;
// run the code and look at the debugger value of drv.Row -- 
// the type will be shown
// which is the type created by the data binding, representing 
// your table or view
//{YourDataSetName.YourTableOrViewType} tmpTableData = drv.Row as {YourDataSetName.YourTableOrViewType};
DataSet1.Customer_InfoRow tmpTableData = drv.Row as DataSet1.Customer_InfoRow; 
```

这个链接就是答案。我希望我在上面添加了清晰度和示例。 [https://social.msdn.microsoft.com/Forums/windows/en-US/f252e395-58e6-4703-ba7b-0740efcbecf3/can-i-convert-the-selected-row-in-a-bound-datagridview- to-a-typed-datarow?forum=winformsdatacontrols](https://social.msdn.microsoft.com/Forums/windows/en-US/f252e395-58e6-4703-ba7b-0740efcbecf3/can-i-convert-the-selected-row-in-a-bound-datagridview-to-a-typed-datarow?forum=winformsdatacontrols)

此链接显示以编程方式添加到数据源的数据，而不是从现有数据库中提取该数据。这让我找到了答案： [https ://msdn.microsoft.com/en-us/library/4wszzzc7(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/4wszzzc7(v=vs.110).aspx)

# php - 如何从 php curl 获取 cookie 到变量中

> ID：895786
> 
> 赞同：137
> 
> 时间：2009-05-21T23:31:11.773
> 
> 标签：php, cookies, curl

因此，其他公司的某个人认为，如果不使用soap、xml-rpc、rest或任何其他合理的通信协议，而是将他的所有响应作为cookies嵌入到标题中，那将是非常棒的。

我需要从这个 curl 响应中提取这些 cookie 作为一个数组。如果我不得不为此浪费大量时间编写解析器，我会非常不高兴。

有谁知道如何简单地做到这一点，最好不向文件写入任何内容？

如果有人能帮助我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2009-05-21T23:55:42.957

```
$ch = curl_init('http://www.google.com/');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
// get headers too with this line
curl_setopt($ch, CURLOPT_HEADER, 1);
$result = curl_exec($ch);
// get cookie
// multi-cookie variant contributed by @Combuster in comments
preg_match_all('/^Set-Cookie:\s*([^;]*)/mi', $result, $matches);
$cookies = array();
foreach($matches[1] as $item) {
    parse_str($item, $cookie);
    $cookies = array_merge($cookies, $cookie);
}
var_dump($cookies); 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-08-02T19:50:28.643

虽然这个问题很老，而且接受的响应是有效的，但我觉得它有点不舒服，因为 HTTP 响应的内容（HTML、XML、JSON、二进制或其他）与标头混合在一起。

我找到了一个不同的选择。CURL 提供了一个选项 ( `CURLOPT_HEADERFUNCTION`) 来设置将为每个响应标题行调用的回调。该函数将接收 curl 对象和带有标题行的字符串。

您可以使用这样的代码（改编自 TML 响应）：

```
$cookies = Array();
$ch = curl_init('http://www.google.com/');
// Ask for the callback.
curl_setopt($ch, CURLOPT_HEADERFUNCTION, "curlResponseHeaderCallback");
$result = curl_exec($ch);
var_dump($cookies);

function curlResponseHeaderCallback($ch, $headerLine) {
    global $cookies;
    if (preg_match('/^Set-Cookie:\s*([^;]*)/mi', $headerLine, $cookie) == 1)
        $cookies[] = $cookie;
    return strlen($headerLine); // Needed by curl
} 
```

该解决方案具有使用全局变量的缺点，但我想这对于短脚本来说不是问题。如果 curl 被包装到一个类中，你总是可以使用静态方法和属性。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-08-24T16:49:54.287

这不需要正则表达式，但需要[PECL HTTP 扩展](https://pecl.php.net/package/pecl_http)。

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HEADER, 1);
$result = curl_exec($ch);
curl_close($ch);

$headers = http_parse_headers($result);
$cookobjs = Array();
foreach($headers AS $k => $v){
    if (strtolower($k)=="set-cookie"){
        foreach($v AS $k2 => $v2){
            $cookobjs[] = http_parse_cookie($v2);
        }
    }
}

$cookies = Array();
foreach($cookobjs AS $row){
    $cookies[] = $row->cookies;
}

$tmp = Array();
// sort k=>v format
foreach($cookies AS $v){
    foreach ($v  AS $k1 => $v1){
        $tmp[$k1]=$v1;
    }
}

$cookies = $tmp;
print_r($cookies); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-21T23:36:41.060

如果您使用 CURLOPT_COOKIE_FILE 和 CURLOPT_COOKIE_JAR，curl 将从文件中读取/写入 cookie。curl 完成后，您可以根据需要阅读和/或修改它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-06T21:26:24.770

libcurl 还提供了 CURLOPT_COOKIELIST 来提取所有已知的 cookie。您只需要确保 PHP/CURL 绑定可以使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-05T17:53:54.853

这里的某人可能会发现它很有用。hhb_curl_exec2 的工作方式与 curl_exec 非常相似，但 arg3 是一个数组，将填充返回的 http 标头（数字索引），而 arg4 是一个数组，将填充返回的 cookie（$cookies["expires"]=>" Fri, 06-May-2016 05:58:51 GMT")，并且 arg5 将填充...有关 curl 发出的原始请求的信息。

缺点是它需要 CURLOPT_RETURNTRANSFER 开启，否则会出错，并且如果您已经将它们用于其他用途，它将覆盖 CURLOPT_STDERR*和CURLOPT_VERBOSE ..（我可能会稍后修复）*

如何使用它的示例：

```
<?php
header("content-type: text/plain;charset=utf8");
$ch=curl_init();
$headers=array();
$cookies=array();
$debuginfo="";
$body="";
curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,false);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);
$body=hhb_curl_exec2($ch,'https://www.youtube.com/',$headers,$cookies,$debuginfo);
var_dump('$cookies:',$cookies,'$headers:',$headers,'$debuginfo:',$debuginfo,'$body:',$body); 
```

和功能本身..

```
function hhb_curl_exec2($ch, $url, &$returnHeaders = array(), &$returnCookies = array(), &$verboseDebugInfo = "")
{
    $returnHeaders    = array();
    $returnCookies    = array();
    $verboseDebugInfo = "";
    if (!is_resource($ch) || get_resource_type($ch) !== 'curl') {
        throw new InvalidArgumentException('$ch must be a curl handle!');
    }
    if (!is_string($url)) {
        throw new InvalidArgumentException('$url must be a string!');
    }
    $verbosefileh = tmpfile();
    $verbosefile  = stream_get_meta_data($verbosefileh);
    $verbosefile  = $verbosefile['uri'];
    curl_setopt($ch, CURLOPT_VERBOSE, 1);
    curl_setopt($ch, CURLOPT_STDERR, $verbosefileh);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    $html             = hhb_curl_exec($ch, $url);
    $verboseDebugInfo = file_get_contents($verbosefile);
    curl_setopt($ch, CURLOPT_STDERR, NULL);
    fclose($verbosefileh);
    unset($verbosefile, $verbosefileh);
    $headers       = array();
    $crlf          = "\x0d\x0a";
    $thepos        = strpos($html, $crlf . $crlf, 0);
    $headersString = substr($html, 0, $thepos);
    $headerArr     = explode($crlf, $headersString);
    $returnHeaders = $headerArr;
    unset($headersString, $headerArr);
    $htmlBody = substr($html, $thepos + 4); //should work on utf8/ascii headers... utf32? not so sure..
    unset($html);
    //I REALLY HOPE THERE EXIST A BETTER WAY TO GET COOKIES.. good grief this looks ugly..
    //at least it's tested and seems to work perfectly...
    $grabCookieName = function($str)
    {
        $ret = "";
        $i   = 0;
        for ($i = 0; $i < strlen($str); ++$i) {
            if ($str[$i] === ' ') {
                continue;
            }
            if ($str[$i] === '=') {
                break;
            }
            $ret .= $str[$i];
        }
        return urldecode($ret);
    };
    foreach ($returnHeaders as $header) {
        //Set-Cookie: crlfcoookielol=crlf+is%0D%0A+and+newline+is+%0D%0A+and+semicolon+is%3B+and+not+sure+what+else
        /*Set-Cookie:ci_spill=a%3A4%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%22305d3d67b8016ca9661c3b032d4319df%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A14%3A%2285.164.158.128%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A109%3A%22Mozilla%2F5.0+%28Windows+NT+6.1%3B+WOW64%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F43.0.2357.132+Safari%2F537.36%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1436874639%3B%7Dcab1dd09f4eca466660e8a767856d013; expires=Tue, 14-Jul-2015 13:50:39 GMT; path=/
        Set-Cookie: sessionToken=abc123; Expires=Wed, 09 Jun 2021 10:18:14 GMT;
        //Cookie names cannot contain any of the following '=,; \t\r\n\013\014'
        //
        */
        if (stripos($header, "Set-Cookie:") !== 0) {
            continue;
            /**/
        }
        $header = trim(substr($header, strlen("Set-Cookie:")));
        while (strlen($header) > 0) {
            $cookiename                 = $grabCookieName($header);
            $returnCookies[$cookiename] = '';
            $header                     = substr($header, strlen($cookiename) + 1); //also remove the = 
            if (strlen($header) < 1) {
                break;
            }
            ;
            $thepos = strpos($header, ';');
            if ($thepos === false) { //last cookie in this Set-Cookie.
                $returnCookies[$cookiename] = urldecode($header);
                break;
            }
            $returnCookies[$cookiename] = urldecode(substr($header, 0, $thepos));
            $header                     = trim(substr($header, $thepos + 1)); //also remove the ;
        }
    }
    unset($header, $cookiename, $thepos);
    return $htmlBody;
}

function hhb_curl_exec($ch, $url)
{
    static $hhb_curl_domainCache = "";
    //$hhb_curl_domainCache=&$this->hhb_curl_domainCache;
    //$ch=&$this->curlh;
    if (!is_resource($ch) || get_resource_type($ch) !== 'curl') {
        throw new InvalidArgumentException('$ch must be a curl handle!');
    }
    if (!is_string($url)) {
        throw new InvalidArgumentException('$url must be a string!');
    }

    $tmpvar = "";
    if (parse_url($url, PHP_URL_HOST) === null) {
        if (substr($url, 0, 1) !== '/') {
            $url = $hhb_curl_domainCache . '/' . $url;
        } else {
            $url = $hhb_curl_domainCache . $url;
        }
    }
    ;

    curl_setopt($ch, CURLOPT_URL, $url);
    $html = curl_exec($ch);
    if (curl_errno($ch)) {
        throw new Exception('Curl error (curl_errno=' . curl_errno($ch) . ') on url ' . var_export($url, true) . ': ' . curl_error($ch));
        // echo 'Curl error: ' . curl_error($ch);
    }
    if ($html === '' && 203 != ($tmpvar = curl_getinfo($ch, CURLINFO_HTTP_CODE)) /*203 is "success, but no output"..*/ ) {
        throw new Exception('Curl returned nothing for ' . var_export($url, true) . ' but HTTP_RESPONSE_CODE was ' . var_export($tmpvar, true));
    }
    ;
    //remember that curl (usually) auto-follows the "Location: " http redirects..
    $hhb_curl_domainCache = parse_url(curl_getinfo($ch, CURLINFO_EFFECTIVE_URL), PHP_URL_HOST);
    return $html;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-04-28T01:33:01.413

接受的答案似乎将搜索整个响应消息。如果“Set-Cookie”一词位于行首，这可能会给您的 cookie 标头错误匹配。虽然在大多数情况下应该没问题。更安全的方法可能是从头到尾通读消息，直到第一个空行指示消息标题的结尾。这只是一个替代解决方案，它应该查找第一个空白行，然后在这些行上使用 preg_grep 仅查找“Set-Cookie”。

```
 curl_setopt($ch, CURLOPT_HEADER, 1);
    //Return everything
    $res = curl_exec($ch);
    //Split into lines
    $lines = explode("\n", $res);
    $headers = array();
    $body = "";
    foreach($lines as $num => $line){
        $l = str_replace("\r", "", $line);
        //Empty line indicates the start of the message body and end of headers
        if(trim($l) == ""){
            $headers = array_slice($lines, 0, $num);
            $body = $lines[$num + 1];
            //Pull only cookies out of the headers
            $cookies = preg_grep('/^Set-Cookie:/', $headers);
            break;
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T23:37:35.380

我的理解是`curl`必须将来自的 cookie 写入文件 ( `curl -c cookie_file`)。如果您正在运行`curl`PHP`exec`或`system`函数（或该系列中的任何内容），您应该能够将 cookie 保存到文件中，然后打开文件并读入它们。

# flash - 是否可以保存通过 RTMP 流式传输的 flv 视频？

> ID：895787
> 
> 赞同：3
> 
> 时间：2009-05-21T23:31:28.793
> 
> 标签：flash, http, rtmp

在使用 http 服务的网站上很容易找到 flv 文件，但是当他们使用 RTMP 时呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T23:35:09.020

据我所知，没有直接/简单的方法可以自己完成此任务。你可以试试[回放媒体捕捉器](http://all-streaming-media.com/faq/recording-media-stream/faq-record-download-capture-save-flash-flv-video-rtmp.htm)（虽然不是免费的）。[这](http://stream-recorder.com/forum/record-rtmp-flash-video-flv-stream-embedded-t2324.html?s=48ccb5592ef07660cd98197253abcc27&)是一个类似于回放媒体捕捉器的软件列表。

编辑：我刚刚尝试了软件[flv 记录器](http://www.downloadatoz.com/howto/save-record-capture-flv-video-audio-steaming-through-http-rtmp-protocol.html)，并且能够通过 rtmp 轻松下载 flv 文件。只需按照页面上描述的说明进行安装即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-02T08:51:59.730

搜索*rtmpdump*或*flvstreamer*（无加密更“免费”的替代方案）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-23T08:44:46.547

Follow these instructions (RTMPDump): [Videohelp.com](http://forum.videohelp.com/threads/311893-How-to-download-flash-video-RTMP-RTMPE-streams-using-free-software)

# html - 为什么 Visual Studio 的 Format Document 工具将标题标签放在两行上？

> ID：895790
> 
> 赞同：13
> 
> 时间：2009-05-21T23:31:55.110
> 
> 标签：html, visual-studio, formatting

所以如果我有一个这样的 HTML 标题

```
<h2>A Heading</h2> 
```

我运行`Edit -> Format Document`它最终看起来像这样

```
<h2>
    A Heading</h2> 
```

为什么是这样？它不会对其他块元素执行此操作，但对其他内联元素（例如`<label>`）会执行此操作。

**更新**：为了澄清，我的意思是为什么这是默认设置，而不是设置更改它的位置

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T00:02:52.927

它这样做是因为这些是它的默认设置。在较旧的浏览器中，有时在子元素之后的新行中包含块或内联元素的结束标记（有效地留下空白，例如不间断空格或空文本节点）会影响页面的呈现方式。我以前遇到过这个问题。例如，如果您的锚点有边框或填充，则以下内容可能会出现问题：

```
<a>
    <img src="..." />
</a> 
```

有时链接底部会有额外的间距。将其更改为以下内容会删除额外的间距：

```
<a><img src="..." /></a> 
```

基本上，傻傻的格式解决了浏览器中的一些渲染问题，像 IE6 这样的劣质 CSS 支持。如果您有 IE6，请查看我创建的[这个 JSFiddle](http://jsfiddle.net/JRehY/2/)来说明问题。图像底部有额外的间距，锚标记存在于它们自己的行中。

来自[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/archive/2006/07/07/Tip_2F00_Trick_3A00_-Custom-formatting-HTML-in-Visual-Web-Developer-and-Visual-Studio-2005.aspx)：

> 如果您格式化选择的标记并看到关闭标记没有移动到单独的行 - 这是因为前面标记的末尾和终止标记之间没有空格，因此 VS 小心不要更改它以避免更改渲染语义。

因此，尽管 Visual Studio 中设计器的格式或输出可能很丑陋，但与正确格式化的标记（例如 XHTML）相比，它更有可能在更多浏览器中工作。

要更改 Visual Studio 中的默认格式设置，请转到：

```
Tools > Options > Text Editor > HTML > Format > Tag Specific Options... 
```

在“默认设置”下，将客户端和服务器“标签支持内容”选项的“换行符”选项更改为“之前和之后”。

# objective-c - 单例的 Objective-C 版本

> ID：895792
> 
> 赞同：5
> 
> 时间：2009-05-21T23:32:05.563
> 
> 标签：objective-c, singleton, release

我对 Objective-C 编程很陌生，对象的释放是我最头疼的事情。我总是怀疑需要发布什么，而我最终发布了错误的变量并导致 BAD EXEC 崩溃。我已经阅读了苹果的内存管理指南，但我不能总是从他们的示例到我的代码。

其中一种情况是我的单身人士（我是个单身人士）。

我有一个这样的定义：

```
static Configuration* _instance;

+(Configuration*)getInstance{
    if (_instance == NULL){
        _instance = [Configuration alloc];
        [_instance initConfig];
    }
    return _instance;
} 
```

在我的代码中，我这样使用它：

```
//Store configuration       
Configuration* conf = [Configuration getInstance];  
conf.userName = self.userName.text;
conf.cellPhone = self.phoneNumber.text; 
```

我需要释放“conf”变量吗？

我应该什么时候释放 _instance？

由于我在 iPhone 上运行此代码，我未发布的变量会发生什么？它们会影响 iPhone 的性能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T06:07:29.850

当您使用“_instance = [Configuration alloc]; [_instance initConfig];”创建配置实例时 它在 alloc 调用中的保留计数为 1。如果你在 "conf.cellPhone = self.phoneNumber.text;" 之后释放 conf 那么它将在那时被释放。

当您第一次使用 alloc、copy 或 mutableCopy 创建对象时，它的保留计数将为 1。每次调用保留都会使保留计数增加 1。每次调用 release 都会减少保留计数 1。调用 autorelease 只是意味着“稍后为我调用 release”，所以如果保留和释放就像支票，那么 autorelease 就像未来约会支票。

您访问配置单例的代码不会保留、复制或可变复制它，因此不应释放它。

由于您现在编写代码，Configuration 对象将永远不会被释放，并且将在整个应用程序生命周期中存在，这通常是您想要的单例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T00:44:45.387

你不需要释放你的`conf`变量，因为你没有保留它。

根据经验，您需要平衡对增加保留计数的方法与减少保留计数的方法的调用。

`init`, `retain`, 增加它，同时`release`减少它。

main _instance 在类卸载时释放，所以我认为您不需要关心它。

# ruby-on-rails - 在开发模式下绕过身份验证和/或授权的好方法是什么？

> ID：895799
> 
> 赞同：2
> 
> 时间：2009-05-21T23:35:50.173
> 
> 标签：ruby-on-rails, ruby, authentication, authorization

如果测试失败，我有几个受过滤器保护的操作，这些过滤器分别检查`logged_in?`并`admin?`吐出 401 或 403 错误。**什么是仅在开发模式下**绕过这些过滤器的好方法，以便我可以测试我的应用程序？

我无法完成实际的登录过程，因为它依赖于我在开发过程中无法访问的基础设施。

我还希望能够正确检查 401s 和 403s，所以我不想完全关闭所有 auth 过滤器。而且我希望在尽可能少的地方定义它，这样我就不会意外地让世界绕过生产中的过滤器。

有没有人找到一个好的覆盖机制？我提出的一些想法：

*   分别在过滤器中添加`params[:logged_in] && RAILS_ENV =~ /dev/`和检查。`params[:admin] && RAILS_ENV =~ /dev/`这适用于`GET`s，但我必须在我的所有表单和 AJAX 请求中添加额外的隐藏字段。
*   添加一个在开发模式下可用的链接，仅模拟普通用户或管理员的登录。这似乎是一个更好的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T00:42:29.367

如果在开发中，您可以添加一些代码来返回 true 的 auth 函数。

```
 def logged_in?
     return true if Rails.env.development?
     ... etc
   end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T01:45:06.027

当你这样做时，你需要两件事：

1.  在开发过程中传递身份验证信息的另一种方法，以及
2.  一种确保在生产中关闭此功能的方法。

第二个我通常使用默认为“关闭”的配置文件中的某种开关。但是您也可以只检查是否存在具有特殊名称的文件，或者任何适合您的名称。只是为了真正确保它永远不会在生产中打开，您还可以添加进一步的检查，例如当服务器以特定用户身份运行时拒绝启用它（如果您有一个特定的用户名，您可以在该用户名下运行生产系统），或者如果请求不是来自本地主机地址，则拒绝使用它。

至于你做什么，你有很多选择。您可以从开发人员根据自己的喜好编辑的文件中读取信息（YAML 是一种很好的格式，文件本身的存在可以作为打开它的开关。您还可以在其中包含授权的 IP 地址如果您确实需要从 localhost 以外的主机进行测试，请使用此文件）。如果你有一个浏览器插件，比如 Firefox 的 Web Developer，设置标题很容易，而且对于通过 HTTP 进行的功能测试也很方便。向 URL 添加额外的参数很流行，但我自己觉得不太方便。

一旦您获得了身份验证信息，您需要做的就是选择适当的点来插入模拟对象，而不是与您在开发中不可用的身份验证系统通信的真实对象。如果您现在没有这样的位置，则必须重构代码来创建它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T09:51:03.307

在 config/environments 中，每个环境都有脚本，允许您应用特定于环境的设置。

如果这些设置在 Rails 启动过程中应用得足够晚，那么我会考虑在那里覆盖您的身份验证机制的相关方面。这避免了在您的生产应用程序中包含特定于开发的代码，这对我来说似乎是个好主意！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T00:11:30.803

在开发时，将脚本添加到模拟真实身份验证框架的环境中，或重新定义基本功能（例如 #is_logged_in 方法）以始终返回 ture，这样您就只需更改环境之间不同的部分。

# c# - 如何从 .NET Dll 或 Exe 访问正在运行的 .NET 独立可执行文件实例？

> ID：895801
> 
> 赞同：0
> 
> 时间：2009-05-21T23:36:25.413
> 
> 标签：c#, .net, memory, executable

我有一个应用程序，它由一个 Windows 窗体项目和一个类库项目组成。当它启动可执行文件时，它会在 dll 中设置一个静态值。

```
using MyClassLibrary;
namespace MyExeApplication
{
   public partial class MainForm : Form
   {
        Hashtable ht = null;
        void Form_Load(...)
        {
          ht = new Hashtable();
          ht.add("1", "Open");
          ht.add("2", "Close");
          Calculate.BasicValues = ht;
        }
        public Hashtable GetBasicValues()
        {
          return ht;
        }
   }

}     
namespace MyClassLibrary
{
   public class Calculate()
   {
       public static Hashtable BasicValues {get; set;}
   }
} 
```

现在假设应用程序正在内存中运行（可执行文件）。我的目的是创建另一个独立的应用程序并使用类库中函数 Calculate 中的值 BasicValues。

```
using MyClassLibrary;
namespace TestApplication
{
  public partial class MainForm : Form
  {
     private void TestValueFromDll()
     {
          System.Windows.Forms.MessageBox.Show("Values of Hashtable");
          Hashtable ht = Calculate.BasicValues;
          //The hashtable is null and values are not there
          //The above will not work. Could I say something like
          //Get the running instance of MyExeApplication 
          //and invoke GetBasicValues() ?                
     }
  }
} 
```

我猜它不起作用，因为我的 TestApplication 已将 MyClassLibrary.dll 复制到可执行文件 TestApplication.exe 所在的 bin 文件夹中。因此使用了不同的 dll（不是第一个应用程序 MyExeApplication 使用的 dll）。

我的问题是如何解决这个问题？是否可以使用反射并获取 MyExeApplication 的实例并从那里读取值？还有其他方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T00:55:23.447

这与 DLL 的位置无关。听起来真正的问题是DLL被加载到“MyExeApplication”应用程序域中，您需要从“TestApplication”应用程序域获得访问权限。事实证明，.NET Remoting 旨在用于跨应用程序域的通信。在[MSDN](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.85).aspx)上有很多关于它的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:43:03.123

如果您将 TestApplication、MyExeApplication 和 MyClassLibrary 构建到同一个文件夹（在项目的“属性”菜单中设置输出文件夹），我想您可以避免使用反射。另外，我很好奇你为什么需要做这样的事情？BasicValues 是可以被 SQL 表甚至注册表设置替换的东西吗？

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T00:57:19.620

据我所知，没有办法做到这一点，除非作为调试器附加到另一个进程。

您最好的选择是让第一个应用程序将 Hashtable 存储在某个共享空间中。可以作为磁盘上的文件，数据库中的文件，具有某种形式的共享内存，或者通过使用远程处理来传递它。

您要使用哪个选项实际上取决于每个应用程序将如何使用数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T12:48:26.693

谢谢大家的回复。我目前使用注册表作为临时存储来存储值。我将阅读有关远程处理和应用程序域的信息，并将尝试这样做。

我想要它的原因是我有一个在后台运行的 exe 应用程序（最小化到 Windows 托盘）。此 exe 应用程序充当中央 API 并生成一些 Web 登录信息，这些信息必须可从任何使用 MyClassLibrary.dll 的 TestApplication 访问。

如果我将我的 dll 类中的所有代码都放到 exe 中，然后只有一个包含所有内容的可执行文件，会不会很好？

然后在 MyTestApplication 我可以添加对 exe 的引用。但我仍然会遇到同样的问题。因为如果我想创建另一个与 exe API 集成的应用程序，例如 MyTestApplication2 并添加对 exe 的引用，我还会遇到同样的问题吗？

我想这从反思中是不可能的。但是在 VB6 中，您可以说类似 object o = GetObject(,"MyExeApplication.Class") 的内容，然后我可以说 o.GetBasicValues())。

# c++ - Linux 上的 tchar.h

> ID：895804
> 
> 赞同：23
> 
> 时间：2009-05-21T23:37:22.183
> 
> 标签：c++, linux, internationalization, tchar

我正在尝试编写跨平台 i18n C++ 代码。由于大多数 linux 系统更喜欢使用 UTF-8 作为字符编码，我认为我应该在 linux 上使用 string，在 Windows 上使用 wstring。tchar.h 在 Linux 上可用吗？Linux 上 tchar.h 的等效替代品是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T23:42:54.450

您可能会发现[这篇](http://linuxgazette.net/147/pfeiffer.html)文章很有用。特别是，在接近尾声时，他们讨论了一些关于使用 TCHAR 和处理 Windows 代码的问题。

文章总结如下：

> 使用 GNU C 编译器编译此代码时，TCHAR 将被转换为宽字符数据类型（大多数可移植库在其头文件中定义 TCHAR 并参考 wchar_t）。事实上，这就是我如何将 C++ 程序变成一个字谜生成器的方法：我使用标准 C++ 字符串填充了 UTF-8，并使用转换为 wchar_t 的指针将数据提供给库函数。解释为 UTF-32 的 UTF-8 数据等于垃圾（但它对于混淆数据和错误非常有用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-29T16:40:39.923

为了构建以 Windows 为中心的源代码，我可以使用 Cygwin 的 tchar.h 文件，该文件位于 cygwin\usr\include\w32api 文件夹中。

我实际上是在使用 Android NDK 构建的。出于我的目的，我制作了 tchar.h 的副本并对其进行了修补。

```
//#include <crtdefs.h>

#define _CRTIMP

//#define _strninc(_pc,_sz) (((_pc)+(_sz)))
//  _CRTIMP size_t __cdecl __strncnt(const char *_Str,size_t _Cnt); 
```

# asp.net - 哪个更适合依赖关系：Web 服务与 XML？

> ID：895812
> 
> 赞同：2
> 
> 时间：2009-05-21T23:38:15.067
> 
> 标签：asp.net, xml, web-services, dependencies

我正在创建一个数据依赖于另一个组的数据馈送的应用程序。他们可以给我一个数据的每日 xml 转储，我可以每天简单地将其加载到缓存中，或者我可以调用 Web 服务以这种方式获取数据。如果数据提供者不关心我使用哪个（无论哪种方式对他们都一样），我应该要求哪个，为什么？使用 asp.net 缓存网站等...</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T23:43:47.130

这完全取决于他们的 Web 服务公开的 API。如果您需要所有信息，一次一次，一天一次，并且不再需要任何其他信息，那么您可能只需要一个简单的 XML 阅读器。

另一方面，更可扩展的解决方案是连接到他们的 Web 服务，因为这样您就可以自定义您正在收集的信息类型。如果您的需求可以在一天中更新，或者您不需要所有信息，只需要在任何给定时间的子集，那么通过 Web 服务可能会更好。

最终，更好的选择取决于业务需求。他们的 Web 服务是否能够为您提供格式更有用并以相关方式过滤的信息？如果是这样，你应该走那条路。如果您只需要所有数据，那么 XML 可能会更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T01:11:00.793

为此，我选择获取一个 Atom 提要，您可以从中利用 HTTP 进行缓存和更新的好处，它也是一个有效的 XML 提要。这样，您不必处理比实际需要更多的数据。XML 转储对于更新、分析和实现来说可能很糟糕，而 Web 服务通常很糟糕，因为您需要深入了解 WS-* 标准堆栈，直到满足您的要求（并且可能会使用您很少需要的工具污染您的开发环境）。或者，我会要求一个基本的 REST 接口进入数据，比如一个 URL pr。更新日或您认为需要的任何内容。

# .net - 如何让 OpenFileDialog 接受“有效”的 URI

> ID：895818
> 
> 赞同：1
> 
> 时间：2009-05-21T23:42:26.447
> 
> 标签：.net, uri, openfiledialog

我需要用来`OpenFileDialog`输入 URI 或本地路径。问题是 URL 的架构不是 windows 知道的（或者应该知道，因为它是用于测试的 hack）。

我可以关闭所有验证，只要我不给它提供它返回的无效字符，但它会很乐意吃其他任何东西，这也不是我想要的。

我想要的是它接受有效的本地路径和正确格式化的 URI，而不验证 Uri 的架构组件，即`http`,`ftp`或开头的任何内容。

* * *

我目前的代码是：

```
var dialog = new System.Windows.Forms.OpenFileDialog();

dialog.CheckFileExists = false;
dialog.CheckPathExists = false;
dialog.ValidateNames = false;

var result = dialog.ShowDialog();
if (result == System.Windows.Forms.DialogResult.OK)
    return dialog.FileName; 
```

如果我输入对话框`foo://127.0.0.1/foo`，它将运行文件到最后一行并以“ `The given path's format is not supported.`”崩溃

为什么它仍在尝试验证内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T23:59:35.447

我假设您在谈论 C#/.NET，因为您将其称为“OpenFileDialog”。

我假设您需要做的是对对话框本身进行子类化（毕竟，它是一个 Win32 对话框）。不幸的是，我不知道如何去做，但希望它能把你推向正确的方向。

# git - 克隆一个空的 *bare* git 存储库最直接的方法是什么？

> ID：895819
> 
> 赞同：20
> 
> 时间：2009-05-21T23:42:28.443
> 
> 标签：git, clone, git-bare

我刚刚浏览完谷歌搜索结果，其中包含所有关于 git 无法克隆空存储库是多么愚蠢的电子邮件咆哮。某个善良的灵魂甚至提交了补丁。*在 git 升级之前，克隆一个空的裸*git 存储库的最简单、最直接的方法是什么？

理想的解决方案将支持为`-o`远程 repo 指定除 之外的名称的选项`origin`，并且可以作为简单的 shell 脚本实现，例如`git-clone-empty-repo`.

（我为什么要这样做：我已经在我们的 NetApp 文件管理器上设置了一个裸露的空 git 存储库，它将被备份，但我想在我的本地硬盘驱动器上使用一个克隆并来回推拉. 与我一起工作的其他人也会这样做。我创建了很多新的 git repos，但我无法克隆一个空的 repo，这让我发疯了。）

* * *

**编辑**：VonC 的线程表明

```
$ git-init
$ git-remote add origin server:/pub/git/test.git 
```

相当于repo为空时克隆远程repo。这不是我想要的，因为我总是使用`-o`git clone 的选项；我根据远程仓库所在的机器或其他一些令人难忘的标准来命名远程仓库。（如果它们都被调用的话，我有太多的存储库无法保持它们的正确性`origin`。）

* * *

**编辑**：以下答案将被标记为接受:-)

*要在path*克隆一个空的、裸仓库，

1.  保存在`~/git/onefile`包含一个无害文件的非裸 git 存储库中，例如`.gitignore`. （或者，动态创建这样的存储库。）
2.  `(cd ~/git/onefile; git push` *小路* `master)`
3.  `git clone -o` *名称* *路径*

换句话说，不要试图克隆空的 repo，而是在创建它之后，向它推送一个包含一个无害文件的简单 repo。然后它不再是空的，可以克隆了。

如果有人没有打败我，我会发布一个 shell 脚本。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-21T23:45:05.007

可能只是有一个包含最少文件数的 git repo：

一：`.gitignore`有明显的忽略模式。

然后克隆那个“几乎是空的”存储库。
请注意，这样一个“几乎空”的存储库（“几乎”，因为它在 .git 目录旁边仍然有一个最小的工作目录）然后可以通过 ' `git clone --bare`' （如此[处所示](https://stackoverflow.com/questions/738154/what-does-git-updating-currently-checked-out-branch-warning-mean)），使其成为真正的裸仓库（但不是“空的” “ 一）。
这就是你可以的裸仓库：

*   克隆任何你想要的地方。
*   或者（更重要的是）推送到（因为它是一个裸仓库）

* * *

你在[这个线程](http://kerneltrap.org/mailarchive/git/2007/7/13/251504/thread)中有一个很好的总结“其他方式”（我保留在这里供参考）。

```
$ git-init
$ git-remote add origin server:/pub/git/test.git 
```

> 对于一个新项目（还没有代码），我想
> 在远程公共服务器上创建一个空的、裸存储库（没有工作副本）作为起点
> ，将其克隆到本地，然后逐步在本地创建内容并将
> 其推送到远程，公共服务器。

Junio C Hamano 对此作出回应：

> 您为发布准备了一个空的裸存储库，这非常好。
> 
> 下一步是您在别处准备内容。那将是您的私人工作场所，即您通常工作的地方）。
> 您从您的私人工作场所推送到该发布存储库。
> 您的工作地点是最初提交的来源，因为您是启动项目的人。
> 
> **请注意，私人工作场所不必是空工作场所的克隆。这实际上是倒退。您的工作从您的私人工作场所开始到出版场所。**
> 
> 您甚至可以克隆您的私有存储库以发布一个，以明确谁是主存储库，谁是副本，如果您愿意的话，但是因为您已经拥有用于发布的裸存储库，只需将其推入即可。

# silverlight-3.0 - 在 Prism/silverlight 3 中使用 DataForm 控件时出现 AG_E_PARSER_BAD_TYPE 错误

> ID：895822
> 
> 赞同：1
> 
> 时间：2009-05-21T23:42:58.007
> 
> 标签：silverlight-3.0, prism, dataform

我正在使用 prism 和 SL3，只要我在任何模块中放置一个 DataForm 控件，我就会收到此错误：

```
AG_E_PARSER_BAD_TYPE [Line: 6 Position: 31]
at System.Windows.Application.LoadComponent(Object component, Uri 
  resourceLocator)
at HelloWorldModule.Views.HelloWorldView.InitializeComponent()
at HelloWorldModule.Views.HelloWorldView..ctor() 
```

如果我将 DataForm 控件放到我的 Shell.xaml 中，我不会收到此错误，只有当我放入模块中的任何视图时。任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T23:52:10.187

您需要将 Microsoft.Windows.Controls 添加到 ModuleManifest.xaml..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-27T13:09:12.213

是的...您需要添加 dll 的引用。它对我有用。

# .net - .NET 2.0 程序 (VS 2005) 在 Visual Studio 中运行，但不能从 Windows 资源管理器中运行

> ID：895824
> 
> 赞同：1
> 
> 时间：2009-05-21T23:43:10.003
> 
> 标签：.net, visual-studio-2005, gac

有人见过这个吗？

有几秒钟的延迟，然后其中一个对话框显示“雅达雅达遇到问题，需要关闭。对于给您带来的不便，我们深表歉意。” （这很奇怪，因为我的程序有一个异常处理系统，如果在我的代码中抛出异常，它会提供有用的错误消息，但显然没有达到这一点：这个对话框与你尝试运行时看到的相同未安装 .NET 的机器上的 .NET 程序。）同样的二进制文件可以在其他 Windows 系统上运行。

我尝试重新安装 .NET 2.0。我试过删除它（不允许我）。我尝试“更改”它（显然没有任何变化）。我尝试重新发布我的项目（ClickOnce），它仍然可以在其他机器上运行，但不能在我的开发机器上运行，除了在 Visual Studio 中。我尝试删除已安装的 ClickOnce 项目并重新安装，但它仍然无法启动该程序。

我发现的最接近的是[这个](https://stackoverflow.com/questions/738327/c-app-runs-with-debugging-but-not-without)（阅读他的澄清），但这些解决方案都没有奏效。

我正在考虑重命名程序并重新发布和重新安装，看看它是否与神秘的 GAC 或邪恶的注册表有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T01:43:25.783

你有什么可以在应用程序事件部分捕获和报告未处理的异常吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:01:54.053

使用事件查看器检查应用程序事件日志。您可能不会获得很多信息，但有时它可以为您指明正确的方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-26T04:23:01.873

我还建议将 EXE 和 Dll 手动复制到一个目录，并为自己获取 Reflector 的副本并使用反射器打开您的主应用程序 exe，然后浏览所有引用。也许存在一些依赖关系，它期望不同的版本或 Gac 中较旧的东西，而你认为​​你已经删除了它。

还要在你的程序中找到入口点，看看 Reflector 认为它在做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T23:47:08.467

您是否尝试过可再发行组件（vcredist_x86.exe）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-23T11:52:09.840

您是否尝试过手动将 exe 和支持文件复制到机器而不是使用发布？也不是您想经历麻烦，而是在我们偶尔遇到此类问题的机器上，我们安装了 Visual Studio 的副本，因此它会出现调试或关闭提示，我们点击调试并复制源代码它要求的代码文件，我们可以看到更多细节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-25T19:36:47.063

当您直接双击编译器输出时它不会运行？如果是这样，通常为我解决这个问题的方法是为项目中引用的所有 DLL 指定 Copy Local = True。

# php - apc_define_constants vs hidef vs define

> ID：895826
> 
> 赞同：3
> 
> 时间：2009-05-21T23:44:51.183
> 
> 标签：php, performance

有没有人使用 apc_define_constants 或 hidef 与使用定义。最新版本中是否有任何真正的好处或可能存在的错误？

apc-define-constants - [http://us2.php.net/manual/en/function.apc-define-constants.php](http://us2.php.net/manual/en/function.apc-define-constants.php)

hidef - [http://pecl.php.net/package/hidef](http://pecl.php.net/package/hidef)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-02-18T13:34:56.843

我知道这是一个老字号，但由于它在 SO 自己的搜索引擎和谷歌中都很高：一篇关于 OP 提到的方法的相对性能的好文章可以在这里找到：[http ://shwup.blogspot.com /2010/04/about-constants.html](http://shwup.blogspot.com/2010/04/about-constants.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T00:32:32.727

我已经使用`apc_define_constants`了很多，没有任何麻烦——我从来没有尝试过 hidef，因为它的“alpha”状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T15:55:00.363

我们已经在生产环境中使用 hidef 三年了，一旦您习惯了 hidef ini 文件的怪癖，并在 hidef 中定义数组，它就非常棒、稳定且易于使用。

# c++ - C++ 中的 _tmain() 和 main() 有什么区别？

> ID：895827
> 
> 赞同：232
> 
> 时间：2009-05-21T23:45:01.560
> 
> 标签：c++, unicode, arguments

如果我使用以下 main() 方法运行我的 C++ 应用程序，一切正常：

```
int main(int argc, char *argv[]) 
{
   cout << "There are " << argc << " arguments:" << endl;

   // Loop through each argument and print its number and value
   for (int i=0; i<argc; i++)
      cout << i << " " << argv[i] << endl;

   return 0;
} 
```

我得到了我期望的结果，我的论点也被打印出来了。

但是，如果我使用 _tmain：

```
int _tmain(int argc, char *argv[]) 
{
   cout << "There are " << argc << " arguments:" << endl;

   // Loop through each argument and print its number and value
   for (int i=0; i<argc; i++)
      cout << i << " " << argv[i] << endl;

   return 0;
} 
```

它只显示每个参数的第一个字符。

造成这种情况的区别是什么？

* * *

## 回答 #1

> 赞同：368
> 
> 时间：2009-05-22T00:09:28.873

`_tmain`在 C++ 中不存在。`main`做。

`_tmain`是微软的扩展。

`main`根据 C++ 标准，是程序的入口点。它具有以下两个签名之一：

```
int main();
int main(int argc, char* argv[]); 
```

微软添加了一个 wmain 来替换第二个签名：

```
int wmain(int argc, wchar_t* argv[]); 
```

然后，为了更容易在 Unicode (UTF-16) 和它们的多字节字符集之间切换，他们定义`_tmain`了，如果启用 Unicode，编译为`wmain`，否则编译为`main`.

至于你问题的第二部分，谜题的第一部分是你的主要功能是错误的。`wmain`应该`wchar_t`争论，而不是`char`。由于编译器不对`main`函数强制执行此操作，因此您会得到一个程序，其中将字符串数组`wchar_t`传递给`main`函数，函数将它们解释为`char`字符串。

现在，在 UTF-16（启用 Unicode 时 Windows 使用的字符集）中，所有 ASCII 字符都表示为`\0`后跟 ASCII 值的一对字节。

由于 x86 CPU 是 little-endian，因此这些字节的顺序是交换的，因此 ASCII 值首先出现，然后是空字节。

而在 char 字符串中，字符串通常如何终止？是的，通过一个空字节。因此，您的程序会看到一堆字符串，每个字符串长一个字节。

通常，在进行 Windows 编程时，您有三种选择：

*   显式使用 Unicode（调用 wmain，并且对于每个接受 char 相关参数的 Windows API 函数，调用`-W`函数的版本。而不是 CreateWindow，调用 CreateWindowW）。而不是使用`char`use`wchar_t`等
*   明确禁用 Unicode。调用 main 和 CreateWindowA，并`char`用于字符串。
*   允许两者。（调用 _tmain 和 CreateWindow，它们解析为 main/_tmain 和 CreateWindowA/CreateWindowW），并使用 TCHAR 代替 char/wchar_t。

这同样适用于 windows.h 定义的字符串类型：LPCTSTR 解析为 LPCSTR 或 LPCWSTR，并且对于包括 char 或 wchar_t 的所有其他类型，始终存在可以使用的 -T- 版本。

请注意，所有这些都是 Microsoft 特定的。TCHAR 不是标准的 C++ 类型，它是 windows.h 中定义的宏。wmain 和 _tmain 也仅由 Microsoft 定义。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-05-23T08:39:32.263

_tmain 是一个宏，它会根据您是使用 Unicode 还是 ASCII 进行编译而重新定义。它是 Microsoft 扩展，不保证可以在任何其他编译器上工作。

正确的声明是

```
 int _tmain(int argc, _TCHAR *argv[]) 
```

如果定义了宏 UNICODE，则扩展为

```
int wmain(int argc, wchar_t *argv[]) 
```

否则它会扩展为

```
int main(int argc, char *argv[]) 
```

您的定义适用于每个，并且（如果您定义了 UNICODE）将扩展到

```
 int wmain(int argc, char *argv[]) 
```

这是完全错误的。

std::cout 适用于 ASCII 字符。如果您使用宽字符，则需要 std::wcout 。

尝试这样的事情

```
#include <iostream>
#include <tchar.h>

#if defined(UNICODE)
    #define _tcout std::wcout
#else
    #define _tcout std::cout
#endif

int _tmain(int argc, _TCHAR *argv[]) 
{
   _tcout << _T("There are ") << argc << _T(" arguments:") << std::endl;

   // Loop through each argument and print its number and value
   for (int i=0; i<argc; i++)
      _tcout << i << _T(" ") << argv[i] << std::endl;

   return 0;
} 
```

或者您可以提前决定是使用宽字符还是窄字符。:-)

**2013 年 11 月 12 日更新：**

将传统的“TCHAR”更改为“_TCHAR”，这似乎是最新的时尚。两者都工作正常。

**结束更新**

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-21T23:47:41.960

_T 约定用于指示程序应使用为应用程序定义的字符集（Unicode、ASCII、MBCS 等）。您可以用 _T( ) 将字符串括起来，以使它们以正确的格式存储。

```
 cout << _T( "There are " ) << argc << _T( " arguments:" ) << endl; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-15T09:30:39.327

好的，这个问题似乎已经得到了很好的回答，UNICODE 重载应该将一个宽字符数组作为它的第二个参数。因此，如果命令行参数`"Hello"`最终可能会是，`"H\0e\0l\0l\0o\0\0\0"`并且您的程序只会`'H'`在它看到它认为是空终止符之前打印。

所以现在你可能想知道为什么它甚至可以编译和链接。

好吧，它可以编译，因为您可以定义函数的重载。

链接是一个稍微复杂的问题。在 C 中，没有修饰符号信息，所以它只找到一个名为 main 的函数。argc 和 argv 可能总是作为调用堆栈参数存在，以防万一您的函数是使用该签名定义的，即使您的函数碰巧忽略了它们。

尽管 C++ 确实有修饰符号，但几乎可以肯定它使用 C 链接作为 main，而不是一个聪明的链接器依次查找每个符号。所以它找到了你的 wmain 并将参数放到调用堆栈中，以防它是`int wmain(int, wchar_t*[])`版本。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-07-02T09:45:39.633

稍加努力就可以将其模板化，它可以与任何对象列表一起使用。

```
#include <iostream>
#include <string>
#include <vector>

char non_repeating_char(std::string str){
    while(str.size() >= 2){
        std::vector<size_t> rmlist; 
        for(size_t  i = 1;  i < str.size(); i++){        
            if(str[0] == str[i]) {
                rmlist.push_back(i);
            }      
        }          

        if(rmlist.size()){            
            size_t s = 0;  // Need for terator position adjustment   
            str.erase(str.begin() + 0);
            ++s;
            for (size_t j : rmlist){   
                str.erase(str.begin() + (j-s));                
                ++s;
            }
         continue;
        }
        return str[0];
   }
    if(str.size() == 1) return str[0];
    else return -1;
}

int main(int argc, char ** args)
{
    std::string test = "FabaccdbefafFG";
    test = args[1];
    char non_repeating = non_repeating_char(test);
    Std::cout << non_repeating << '\n';
} 
```

# linq - Linq 将 IEnumerable(Of Struct) 连接到 IEnumerable(of object)

> ID：895829
> 
> 赞同：2
> 
> 时间：2009-05-21T23:45:14.460
> 
> 标签：linq, join, linq-to-objects

使用类 RoleRecord (Guid RoleId, string RoleName,...) 我试图获取一个新的 Name 列表，其中 RoleId 与 Guid 列表匹配

```
IEnumerable<RoleRecord> roles;
IEnumerable<Guid> roleIds; 
```

我正在考虑避免嵌套的 for 循环，并且沿着：

```
 var query = 
            from rowA in roles
            join rowB in roleIds
            on rowA.RoleId equals rowB.????
            select { rowA.RoleName }; 
```

我也尝试将 guid 包装在一个类中，但由于语法错误，甚至无法构建它。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T05:42:15.900

如果您有大量 Guid，我个人*不会使用 Jeremy 的答案。*如果 join 是您真正想要表达的 - 您只需要：

```
var query = from rowA in roles
            join rowB in roleIds on rowA.RoleId equals rowB
            select rowA.RoleName; 
```

或者，首先创建一组角色 ID：

```
HashSet<Guid> validRoleIds = new HashSet<Guid>(roleIds);
var query = from rowA in roles
            where validRoleIds.Contains(rowA.RoleId)
            select rowA.RoleName; 
```

The advantage is that then you don't need to do a linear search through every valid role ID for every role. That's not an issue if you *know* you don't have many roles or role IDs, but generally a hashing approach will be more effective.

Note that the join will use a hash as well internally.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T00:04:06.373

试试这个：

```
var query = 
            from rowA in roles
            where roleIds.Contains(rowA.RoleId)
            select  rowA.RoleName; 
```

# iphone - 如何更改 UIPickerView 中选定行的颜色

> ID：895830
> 
> 赞同：21
> 
> 时间：2009-05-21T23:45:45.160
> 
> 标签：iphone, uipickerview

好的，也许我错过了一些非常简单的东西，如果是这种情况，我深表歉意，但是，我已经用谷歌搜索了标题的所有排列，但没有找到！所以这就是我想要做的：在选择该行时更改我用作 2 组件选取器视图中的行视图的标签的背景颜色。所以我认为这会起作用：

```
if (row == [pickerview selectedRowForComponent])
    viewlabel.backgroundColor = redcolor; 
```

但这不起作用。它似乎随意选择要着色的行，有时甚至会出现错误的访问错误。我试过所有不同的条款都没有效果！任何建议将不胜感激！！

这是完整的方法：

```
- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{

    if (component == kNumberComponent) {

#define PICKER_LABEL_FONT_SIZE 24
#define PICKER_LABEL_ALPHA 1.0
        // UIFont *font = [UIFont boldSystemFontOfSize:PICKER_LABEL_FONT_SIZE];
        UIFont *font = [ UIFont fontWithName:@"AppleGothic"  size:24];
        UILabel *carsLabel =[ [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 75, 50) ]autorelease];
        //[picker selectRow:row inComponent:component animated:YES];
        NSString *pickerText = [self.numbers objectAtIndex:(int)row];
        carsLabel.text = pickerText;
        carsLabel.textAlignment = UITextAlignmentCenter;
        NSLog(@"carsLabel = %@",carsLabel.text);
        //carsLabel.text = @"maybe because the string isn't long enough";
        carsLabel.textColor = [UIColor blackColor];
        carsLabel.font = font;

        carsLabel.opaque = YES;

        [view addSubview:carsLabel];

        return carsLabel;   
    } else {
        UIFont *font = [ UIFont fontWithName:@"AppleGothic"  size:18];

        UILabel *carsLabel = [[[UILabel alloc] initWithFrame:CGRectMake(0, 0, 225, 50)] autorelease];
        id fact = [self.facts objectAtIndex:(int)row];
        NSString *pickerText = @"Dictionary Entry";
        if ( [fact isKindOfClass:[NSString class]]) {

            pickerText = [self.facts objectAtIndex:(int)row];

        } 
        carsLabel.text = pickerText;
        carsLabel.textAlignment = UITextAlignmentCenter;
        NSLog(@"carsLabel = %@",carsLabel.text);
        //carsLabel.text = @"maybe because the string isn't long enough";
        carsLabel.textColor = [UIColor blackColor];
        carsLabel.font = font;
        if ( row == 0) {
        carsLabel.backgroundColor = [UIColor redColor];

        }
        //carsLabel.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"blackboard.png"]];;
        carsLabel.opaque = YES;

        [view addSubview:carsLabel];

        return carsLabel;
    }

    return nil;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-08-21T14:31:45.277

通常，我使用这种方法：

我使用自定义视图来显示行项目

```
-(UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{

    UILabel *label = (id)view;

    if (!label)
    {

        label= [[UILabel alloc] initWithFrame:CGRectMake(0.0f, 0.0f, [pickerView rowSizeForComponent:component].width, [pickerView rowSizeForComponent:component].height)];
        label.textAlignment = NSTextAlignmentCenter;
        label.textColor = [UIColor whiteColor];
        label.text = _arrayStringPicker[row];

    }  

    return label; 
```

我改变选择的行的颜色：

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{

    UILabel *labelSelected = (UILabel*)[pickerView viewForRow:row forComponent:component];
    [labelSelected setTextColor:[UIColor redColor]];

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-05T08:45:23.197

快速实施

```
extension PickerViewController: UIPickerViewDelegate {
    func pickerView(pickerView: UIPickerView, attributedTitleForRow row: Int, forComponent component: Int) -> NSAttributedString? {
        var color: UIColor!
        if pickerView.selectedRowInComponent(component) == row {
            color = UIColor.redColor()
        } else {
            color = UIColor.blackColor()
        }

        let attributes: [String: AnyObject] = [
            NSForegroundColorAttributeName: color,
            NSFontAttributeName: UIFont.systemFontOfSize(15)
        ]

        return NSAttributedString(string: rows[row], attributes: attributes)
    }

    func pickerView(pickerView: UIPickerView, didSelectRow row: Int, inComponent component: Int) {
        //this will trigger attributedTitleForRow-method to be called
        pickerView.reloadAllComponents()
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-09-12T18:55:07.400

viewForPicker 的正确格式是：

```
- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{
    UILabel *label = (UILabel*) view;
    if (label == nil)
    {
        label = [[UILabel alloc] init];
    }

    [label setText:@"Whatever"];

    // This part just colorizes everything, since you asked about that.

    [label setTextColor:[UIColor whiteColor]];
    [label setBackgroundColor:[UIColor blackColor]];
    CGSize rowSize = [pickerView rowSizeForComponent:component];
    CGRect labelRect = CGRectMake (0, 0, rowSize.width, rowSize.height);
    [label setFrame:labelRect];

    return label;
} 
```

上面代码的问题是：它为标签着色，而不是选择器本身。因此，当您滚动到一端或另一端时，会有一个空白点，您可以在其中看到白色背景。设置 [myPicker setBackgroundColor...] 并不像人们希望的那样。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-05T06:20:33.367

// 我们想要的帧的 CGRectMake 值

```
UIPickerView *myPickerView = [[UIPickerView alloc] initWithFrame:CGRectMake(0,0, self.view.bounds.size.width, self.view.bounds.size.height)];

// add the UIPickerView to your viewcontroller [mainView addSubview:myPickerView];

// set the selectionindicator to none myPickerView.showsSelectionIndicator = NO; 
```

// 定义我们想要使用的图像

```
UIImage *selectorImage = [UIImage imageNamed:@"selectionIndicator.png"];

UIView *customSelector = [[UIImageView alloc] initWithImage:selectorImage]; 
```

// 将 x 和 y 值设置为 UIPickerView 上要放置图像的点

// 将宽度和高度值设置为图像的宽度和高度

```
customSelector.frame = CGRectMake(10,(myPickerView.bounds.size.height / 2) + 16, self.view.bounds.size.width – 10, 47); 
```

// 将自定义 selectionIndicator 也添加到同一个视图控制器

```
[mainView addSubview:customSelector]; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-22T18:18:41.530

解决了！声明 2 个实例变量：selectedView 和 oldView。然后下面的代码就可以了：

```
if (self.oldView != nil)
        self.oldView.backgroundColor = [UIColor clearColor];

self.selectedView = [picker viewForRow:row forComponent:kNumberComponent];
        self.selectedView.backgroundColor = [UIColor redColor];
        [self.selectedView setNeedsDisplay];
        self.oldView = self.selectedView; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T00:14:31.623

调用`UIPickerView`实例的`-viewForRow:forComponent:`方法获取`UIView *`对象。然后设置该视图的背景`UIColor`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-02-20T10:35:15.460

@alessandro-pirovano 答案的 Swift 版本

```
func pickerView(_ pickerView: UIPickerView, viewForRow row: Int, forComponent component: Int, reusing view: UIView?) -> UIView {

    let rowSize = pickerView.rowSize(forComponent: component)
    let width = rowSize.width
    let height = rowSize.height
    let frame = CGRect(x: 0, y: 0, width: width, height: height)
    let label = UILabel(frame: frame)
    label.textAlignment = .center
    label.text = rows[row]

    return label
}

func pickerView(_ pickerView: UIPickerView, didSelectRow row: Int, inComponent component: Int) {

    guard let label = pickerView.view(forRow: row, forComponent: component) as? UILabel else {
        return
    }
    label.backgroundColor = .orange
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T00:09:03.070

目前尚不清楚您将上述代码放在哪里。在`-pickerView:viewForRow:forComponent:reusingView:`吗？这是它应该在的地方。您确定要维护指向该特定视图标签的指针吗？您正在崩溃的事实表明您可能不是。更大的代码块，包括你把它放在哪里，会很有帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-31T14:24:40.650

这对我有用：

1.  将 a`UIView`作为子视图添加到您的`UIPickerView`
2.  将其限制为与您输入的 Y`UIPickerView`并且 具有相同的宽度
3.  给它高度等于返回的高度`pickerView(_ pickerView: UIPickerView, rowHeightForComponent component: Int) -> CGFloat`
4.  使其半透明并按照您想要的方式着色

*其余的解决方案（行的自定义视图或行的属性字符串）在快速滚动时有问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-04-28T07:37:37.510

UIPickerView 有委托为行和组件的标题设置 NSAttributeString，我们可以设置属性颜色，如下所示：

```
- (NSAttributedString *)pickerView:(UIPickerView *)pickerView attributedTitleForRow:(NSInteger)row forComponent:(NSInteger)component {
    NSDictionary *attrs = @{NSForegroundColorAttributeName : [UIColor redColor]};
    NSString *title = @"title"
    return [[NSAttributedString alloc] initWithString:title attributes:attrs]; 
```

}

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-12T09:00:11.827

扩展 Alessandro Pirovano 的答案；

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{

    UILabel *labelSelected = (UILabel*)[pickerView viewForRow:row forComponent:component];
    [labelSelected setTextColor:[UIColor redColor]];
    labelSelected.superview.backgroundColor = [UIColor yellowColor];
} 
```

# html - 对齐没有css或表格的复选框？

> ID：895833
> 
> 赞同：0
> 
> 时间：2009-05-21T23:47:02.723
> 
> 标签：html, css

如果我有如下的 html 表单：

```
<form name="statusForm" action="post.php" method="post" enctype="multipart/form-data">
Test:
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
TestTestTest:
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
TestTestTestTestTestTest:
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
TestTestTestTestTestTestTestTestTestTestTest:       
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
<input name="Submit" value="submit" type="submit">
</form> 
```

是否可以在不使用表格或 css 而是使用纯 html 的情况下对齐复选框以使它们结合在一起？否则，应该使用哪个css？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T23:49:21.660

是的。用标签包围每个标签`<label>`：

```
<label for="checkboxes1">Test:</label>
<input id="checkboxes1" name="checkboxes[]" value="Test" type="checkbox"> 
```

然后给标签一个宽度：

```
label {
    display: inline-block; /* try "block" instead if this fails in IE */
    min-width: 5em;
} 
```

那应该很好地填充文本框。作为一个额外的好处，点击标签现在应该将浏览器焦点放在文本框中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:24:28.723

文章[将 CSS 应用于表单](http://www.webcredible.co.uk/user-friendly-resources/css/css-forms.shtml)有一些样式标签的示例，以使右侧的输入沿垂直边缘排列。

也就是说，将标签放置在**右侧**或单选按钮和复选框是用户界面设计中的惯例。如果您遵循该约定，那么它们将自行排列（因为所有复选框都将共享一个宽度）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T11:47:34.600

你可以把你的标签和输入放在一个无序列表中。为了获得对齐，文本必须在输入/的右侧

```
<ul>
    <li>
        <label><input /> Some Text</label>
    </li>
</ul> 
```

或者

```
<ul>
    <li>
        <input /><label for="">Some Text</label>
    </li>
</ul> 
```

富有的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T23:49:43.390

我不明白你为什么要这样做。

它不符合您的 no css 指令，但如果您真的不想要*外部*css，您可以使用内联样式。

也许你可以使用`&nbsp;`

CSS（以及在较小范围内的表格）是您正在寻找的工具。

*编辑*：您可以这样做的另一种方法是使用鬼像素图像。1x1 alpha 透明 png 的图像，您使用其中的 height 和 width 属性来告诉它您想要多少空间。您可能需要一些内联 css 来确保事情正确清晰。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T23:56:46.560

最简单的方法就是将它们全部向右对齐。我不确定“align”属性是否适用于表单元素，但您可以尝试一下，或者使用 ) 将代码包装在 div 或 p 元素中`align="right"`。

CSS 是一个更好的解决方案。在表单上放置一个类，然后使用 CSS 规则`text-align: right;`或直接添加`style="text-align: right"`到表单元素。

# oracle - 有没有一种简单的方法可以将 HTTP_ACCEPT_LANGUAGE 转换为 Oracle NLS_LANG 设置？

> ID：895839
> 
> 赞同：1
> 
> 时间：2009-05-21T23:50:06.383
> 
> 标签：oracle, internationalization, cgi, environment-variables, nls

在向 Oracle Web 应用程序（基于 mod_plsql 构建）添加国际化功能时，我想解释 HTTP_ACCEPT_LANGUAGE 参数并使用它来设置 Oracle 会话中的各种 NLS_* 设置。

例如：

```
HTTP_ACCEPT_LANGUAGE=de

alter session set nls_territory=germany;
alter session set nls_lang=... 
```

但是，我想你可以得到更复杂的东西......

```
HTTP_ACCEPT_LANGUAGE=en-us,en;q=0.5 
```

人们以前是如何处理这种事情的？

**编辑 - 以下是 Curt 的详细回答**

感谢Curt清晰详细的回复。不过，我并没有真正说清楚，因为我真的在问是否有任何现有的 Oracle 小部件可以处理这个问题。

我已经在手动解析 HTTP_ACCEPT_LANGUAGE 变量的道路上，并且 - 正如 Curt 在他的回答中指出的那样 - 有一些微妙的复杂领域。*感觉*就像以前必须做过很多次的事情。随着我编写越来越多的代码，我有一种下沉的“我在重新发明轮子”的感觉。:)

必须有一个现有的 Oracle 方法来解决这个问题——可能在 iAS 中？

**编辑 - 偶然发现了答案**

在寻找其他东西时，我偶然发现了 UTL_I18N 包，这正是我所追求的：

[有没有一种简单的方法可以将 HTTP_ACCEPT_LANGUAGE 转换为 Oracle NLS_LANG 设置？](https://stackoverflow.com/questions/895839/is-there-an-easy-way-to-convert-httpacceptlanguage-to-oracle-nlslang-settings/1820331#1820331)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T01:30:30.973

当然，如果你正确地解决问题并且一开始不要雄心勃勃，这并不太难。

本质上，您需要两个功能：一个用于解析`HTTP_ACCEPT_LANGUAGE`并生成语言代码，另一个用于获取并生成适当的`set`命令。

前者可以变得非常复杂；如果你只给出'en'，你可能想要生成'en-us'，当没有完美匹配时，你需要处理选择多个选项之一，你需要处理格式错误的标题值，等等。不要试图一次解决所有问题：先做一些非常简单的事情，然后再扩展它。

生成命令的另一半或多或少也是如此`set`，但这本身就很简单；它实际上只是一个查找函数，尽管根据提供给它的内容，它可能会变得更复杂一些。

真正会成就或破坏您在此类事情上的编程体验的是您的单元测试。这是单元测试和测试驱动开发的理想问题。单元测试将确保当您更改内容时，旧功能继续工作，并更容易添加新功能和修复错误，因为您只需添加另一个测试，您就可以从那时起指导您。（如果您发现自己在某些时候出现了严重错误，您还会发现完全重写其中一个功能会更容易，因为您可以轻松确认新版本没有破坏任何东西。）

你如何在你的环境中进行单元测试可能有点超出这个问题的范围，但让我添加一些提示。首先，如果您的环境有可用的单元测试框架（“pl-sql-unit？”），那就太好了。如果没有，请不要惊慌。您不需要任何复杂的东西：只需要一组输入和预期输出，以及通过函数运行它们的方法，或者说“一切正常！” 或显示任何不正确的结果。您可能可以编写一个简单的 PL/SQL 函数，从表中读取输入和预期输出并为您执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-30T15:01:41.217

终于偶然发现了答案。Oracle 包 UTL_I18N 包含从浏览器语言代码映射到 Oracle NLS 设置的函数：

```
utl_i18n.map_language_from_iso;
utl_i18n.map_territory_from_iso; 
```

该映射似乎不能很好地处理多语言设置，例如 en-us,en;q=0.5，但只要您只使用前 5 个字符，这些功能似乎就可以正常工作。

```
HTTP_ACCEPT_LANGUAGE: ar-lb,en-gb;q=0.5
v_language: 
v_territory: 

HTTP_ACCEPT_LANGUAGE: ar-lb
v_language: ARABIC
v_territory: LEBANON 
```

# excel - ODBC 与专有驱动程序/Excel 信任设置连接

> ID：895840
> 
> 赞同：2
> 
> 时间：2009-05-21T23:50:10.940
> 
> 标签：excel, vba, odbc, drivers, excel-2008

我在 Excel 中有一个电子表格，它使用软件的 odbc 驱动程序（操作请求系统）连接到内部数据库。这很好用。现在，我正在尝试将 Excel 文件移动到 SharePoint 网站，以便我们的团队可以在同一个电子表格中查看数据并做笔记。

因此，首先我尝试将 Excel 文件移动到服务器，但意识到文件中保存的连接指向我计算机上的连接文件。所以我把它移到了 SharePoint 网站，这似乎正在工作......除了：

1）在某些计算机上，它可以正常打开。但是，如果要求数据库登录和密码的对话框是自定义的，我会更喜欢它。

2) 在其他电脑上，安装了软件和驱动程序，但是没有出现在用户源列表中，所以会报错。当用户去创建一个新连接时，驱动程序就在那里，（所以它不在第一个列表中，但它在更大的列表中）。

3) Mac 可以打开文件，但 Excel 2008 不能做宏和连接。

4) 从同一站点打开同一文件每次都会引发信任中心警告，即使在同一台计算机/同一用户上也是如此。

有没有办法做以下任何事情？

*   有一个非宏来阻止用户保存（并因此覆盖）工作表，直到确认用户不会更改连接/宏？

*   允许用户从本地配置进行连接（以防他们可以设置一个在主配置失败时工作），以便他们可以使用该配置进行连接，但不会为其他人搞砸。

*   设置信任设置（我想是本地或服务器上的），以便始终信任来自特定 SharePoint 的任何文件？

最后，这是一个大...

您可以使用不在本地计算机上的驱动程序创建连接吗？如果驱动程序安装在远程服务器上，Excel 可以使用那个吗？如果是这样，那将解决几乎所有其他问题（除非您使用的是 Mac）。

我觉得我在这有点错误，但由于团队都需要看到彼此的笔记，我们唯一的其他解决方案是将数据（从数据库）上传到 MySQL 数据库，以便他们可以从他们的笔记浏览器。这使它更普遍可用，但迫使我们编写许多 Excel 中标准的函数并创建冗余 DB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T17:38:55.110

听起来您正在使用用户 DSN 进行连接。您可以使用连接字符串切换到无 DSN 连接。如果您需要一些帮助，您可以发布需要修改的代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T23:16:03.727

首先，感谢提供答案的两位用户。你们两个都对我解决这个问题很有帮助。

因此，事实证明，虽然您不能轻松地直接连接到 Action Request DB，但 AR 确实支持 Web 服务。

我没有尝试让 Excel、Access、PHP 或任何其他系统处理创建 Soap 客户端并自己处理工作，而是想出了一个我认为相当聪明的替代方案，如果我自己这么说的话：

1) 创建一个 php 脚本，用请求的数据调用 Web 服务，

2) 脚本将响应解析为更通用的 XML 形式，

3) 脚本回显 xml

4) 将脚本命名为“AR_Data_Request.xml”

5）通过.htaccess文件配置目录，将xml文件视为php

现在，我有一个静态 xml 文件，它始终包含来自 Action Request 的最新数据。我可以将任何其他应用程序（特别是 Excel）指向该 xml 文件，而不必编写 VBA 代码来直接查询 Web 服务（对于 php，仍然必须再次执行此操作）。

唯一的问题是我无法让 php 连接到 Web 服务（doh！），但这将是我的下一个问题。

再次感谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T01:44:41.770

哇！通过 ODBC 访问 ARS！九十年代我在 Remedy HQ 工作时，我向架构师提出了这个功能。伟大的时代。

无论如何，我认为您共享连接到 ODBC 源的 Excel 工作表的方法并不是最简单的方法。（正如你所发现的那样。）]

ODBC 始终是本地驱动程序，afaik。客户端*本地*连接到 ODBC。然后 ODBC 可以使用网络连接到 DB。

相反，我建议您调查使用远程连接到 ARS 系统的表设置 Access。然后，您可以通过文件共享而不是 dbms 连接远程打开 Access 表。我相信这会比你目前的道路更容易上手。

高温下，

拉里

# escaping - 通过串行转义字符

> ID：895842
> 
> 赞同：3
> 
> 时间：2009-05-21T23:50:44.637
> 
> 标签：escaping, serial-port, character, arduino

我正在控制 Arduino 的串行打印机。现在它工作得很好，但我需要向它发送转义字符来控制打印机的某些特定功能。有没有办法做到这一点？

我需要发送“ESC i”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T00:05:39.317

Escape 是 ASCII 字符代码 27。如果你在[C](http://en.wikipedia.org/wiki/C_%28programming_language%29)中编程，你可以这样做：

```
putchar(27);
putchar('i'); 
```

或者，如果您想将整个内容放在一个字符串中，您可以执行以下操作：

```
printf("\033i"); 
```

将`\033`被替换为 33 八进制，编译器是 27 十进制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T10:38:00.793

```
Serial.print(27, BYTE); // ASCII code for the Escape character
Serial.print("i"); 
```

# iphone - iPhone 表格单元格：如何让它们变得透明和复杂

> ID：895850
> 
> 赞同：0
> 
> 时间：2009-05-21T23:53:45.707
> 
> 标签：iphone, cocoa-touch

我想构建一个看起来几乎与 iPhone 联系人应用程序中的表完全相同的表。当您单击联系人时，它会显示相关信息。当我尝试构建它时，最大的问题出现了：一个包含复杂单元格的表格，包含透明单元格和带有两个按钮的单元格。

你会怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T00:01:52.540

您将需要学习[Table View Programming Guide](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/Introduction/Introduction.html)，它将引导您完成各个部分。除此之外，您还应该研究[TableViewSuite](http://developer.apple.com/iphone/library/samplecode/TableViewSuite/)中的示例代码。此示例代码包括一系列五个增加复杂性的示例。

但是，我不确定您所说的“透明单元格”是什么意思。通讯录中没有任何透明单元格。您可能指的是被称为分组表，您将在编程指南中了解它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T22:31:56.930

如果您所指的“透明单元格”是显示联系人图片和姓名的“联系信息”页面的顶部，那么[本](http://blog.jameshiggs.com/2009/03/01/transparent-table-header-uitableview/)教程可能会对您有所帮助。可以在表格的每个部分上方和下方插入自定义页眉和页脚视图。该教程详细介绍了如何将标题视图添加到第一个表格部分以显示图片和标签，就像在联系人应用程序中一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T06:31:35.277

我建议您查看有关以绘制自定义 UITableViewCells 为起点[的 Cocoa with Love 文章。](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)

# sql - 如何计算 MySQL 中值的非唯一组合？

> ID：895876
> 
> 赞同：0
> 
> 时间：2009-05-22T00:02:17.063
> 
> 标签：sql, mysql

我有一张表，其中包含一些我怀疑可能有点混乱的遗留数据。这是一个多对多连接表。

```
LIST_MEMBERSHIPS
----------------
list_id
address_id 
```

我想运行一个查询来计算每对的出现次数`list_id`，`address_id`并从最高到最低的出现次数显示每对的出现次数。

我知道它必须涉及`COUNT()`，`GROUP BY`对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T00:09:54.660

```
select list_id, address_id, count(*) as count
from LIST_MEMBERSHIPS
group by 1, 2
order by 3 desc 
```

您可能会发现添加有用

```
having count > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T00:12:24.077

```
select count(*), list_id, address_id
from list_membership
group by list_id, address_id
order by count(*) desc 
```

# .net - 从javascript向.NET应用程序发送消息？

> ID：895877
> 
> 赞同：0
> 
> 时间：2009-05-22T00:02:41.647
> 
> 标签：.net, javascript

我正在开发一个 HTML 帮助系统，我希望用户可以单击链接以在用 .NET 编写的应用程序中执行命令（例如，完成教程或工作流程中的步骤）。我查看了 HTML 帮助的 TCard() 方法，但它仅适用于编译帮助 (.chm)，我想在可以从 IE 以外的浏览器查看的纯 html 中执行此操作。

这可能吗？如果是这样，最简单/最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T00:21:44.060

您可以使用 asp.net ajax 网络服务。这是一个教程：

[http://www.asp.net/Ajax/Documentation/Live/tutorials/ASPNETAJAXWebServicesTutorials.aspx](http://www.asp.net/Ajax/Documentation/Live/tutorials/ASPNETAJAXWebServicesTutorials.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T00:37:07.477

如果您仅在 Windows 上执行此操作，您可能需要查看[自定义应用程序协议](http://msdn.microsoft.com/en-us/library/aa767914(VS.85).aspx)。该页面可以链接到“myhelp3000:LoadStage(2)”，您的应用程序可以做一些特殊的响应。

# sql - 为什么我会导致聚集索引更新？

> ID：895879
> 
> 赞同：27
> 
> 时间：2009-05-22T00:03:25.173
> 
> 标签：sql, sql-server-2005

我正在执行以下语句：

```
UPDATE TOP(1) dbo.userAccountInfo
SET           Flags = Flags | @AddValue
WHERE         ID = @ID; 
```

'ID' 列是一个带有 IDENTITY 约束的 INT PRIMARY KEY。标志是 BIGINT NOT NULL。

执行路径指示正在发生聚集索引更新。非常昂贵的手术。除了主键之外，没有涵盖标志或 ID 的索引。我觉得实际的执行路径应该是：

聚集索引搜索 => 更新

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-22T00:13:21.813

表有两种形式：聚集索引和堆。您有一个 PRIMARY KEY 约束，因此您已经隐式创建了一个聚集索引。您必须在创建表期间花费额外的时间才能避免这种*情况*发生。“表”的任何更新都是聚集索引的更新，因为聚集索引**就是**表。至于聚集索引更新是一项“非常昂贵的操作”，现在这是一个关于数据库如何工作的基本错误信息的都市传说。正确的说法是“影响聚集键的聚集索引更新必须更新所有非聚集索引”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-22T00:09:29.137

聚集索引*是*物理表，因此无论何时更新*任何*行，都在更新聚集索引。

请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms177434(SQL.90).aspx)

# javascript - jQuery 基于像素宽度截断文本

> ID：895888
> 
> 赞同：16
> 
> 时间：2009-05-22T00:08:43.057
> 
> 标签：javascript, jquery

我正在尝试使用 jquery 编写一个快速函数来计算 html 页面上字符串的像素宽度，然后截断字符串直到它达到理想的像素宽度......

但是它不起作用（文本不会截断）......

这是我的代码：

```
 function constrain(text, original, ideal_width){

    var temp_item = ('<span class="temp_item" style="display:none;">'+ text +'</span>');
    $(temp_item).appendTo('body');
    var item_width = $('span.temp_item').width();
    var ideal = parseInt(ideal_width);
    var smaller_text = text;

    while (item_width > ideal) {
        smaller_text = smaller_text.substr(0, (smaller_text-1));
        $('.temp_item').html(text);
        item_width = $('span.temp_item').width();
    }

    var final_length = smaller_text.length;

    if (final_length != original) {
        return (smaller_text + '&hellip;');
    } else {
        return text;
    }
} 
```

这是我从页面调用它的方式：

```
 $('.service_link span:odd').each(function(){
    var item_text = $(this).text();
    var original_length = item_text.length;
    var constrained = constrain(item_text, original_length,175);
    $(this).html(constrained);
}); 
```

关于我做错了什么的任何想法？如果有一种方法可以更快地做到这一点（即冒泡排序），那也很棒。

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-11-19T14:24:35.093

为什么不直接使用 CSS 来指定要放入此字符串的元素的宽度，而不是将其与脚本一起破解？您可以使用[`text-overflow`](http://www.quirksmode.org/css/textoverflow.html)它来告诉浏览器它应该用省略号截断。

```
.truncated { display:inline-block; max-width:100px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; } 
```

`text-overflow`是 CSS3 声明，但在 IE 6+、WebKit 312.3+ (Safari 1.3+/Chrome) 和 Opera 9+ 中受支持（版本 < 10.7 需要`-o-text-overflow`声明）。

请注意，直到 7.0版本[才在 Firefox 中实现这一点，](https://bugzilla.mozilla.org/show_bug.cgi?id=312156)[不到 4%](http://en.wikipedia.org/wiki/Template:Firefox_usage_share)的 Firefox 用户仍在使用旧版本（主要是 3.6）。您的文本在旧版本中仍将被截断，只是不会呈现省略号。如果你关心这小部分用户，你可以使用[这个 jQuery 插件](http://www.bramstein.com/projects/text-overflow/)，它在 IE/WebKit/Opera/Firefox ≥ 7 中没有任何作用，但会`text-overflow`在 Firefox ≤ 6 中进行模拟。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T00:21:19.317

在这条线上：

> `smaller_text = smaller_text.substr(0, (smaller_text-1));`

你可能打算

> `smaller_text = smaller_text.substr(0, (smaller_text.length-1));`

这能解决问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T00:32:33.350

谢谢，我让它工作了 - 但它只适用于第一项并停止，这与我声明变量的方式有关吗？

这是当前代码：

```
 function constrain(text, original, ideal_width){

    var temp_item = ('<span class="temp_item" style="display:none;">'+ text +'</span>');
    $(temp_item).appendTo('body');
    var item_width = $('span.temp_item').width();
    var ideal = parseInt(ideal_width);
    var smaller_text = text;

    while (item_width > ideal) {
        smaller_text = smaller_text.substr(0, (smaller_text.length-1));
        $('.temp_item').html(smaller_text);
        item_width = $('span.temp_item').width();
    }

    var final_length = smaller_text.length;

    if (final_length != original) {
        return (smaller_text + '&hellip;');
    } else {
        return text;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-19T13:19:40.497

如果你有文本，并且知道你想要的大小，为什么不直接使用 substr 呢？

我做了类似的事情

```
$('#history-1').text( $('#history-1').text().trim().substr(0,32) + "..." ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-09T15:15:32.357

该函数接受要检查的文本、以像素为单位的理想宽度和 css 的类名。如果 Ideal_width 小于文本宽度，它会截断并添加 hellip，否则返回未修改的文本。简单而有效！:-)

```
function constrain(text, ideal_width, className){

    var temp_item = ('<span class="'+className+'_hide" style="display:none;">'+ text +'</span>');
    $(temp_item).appendTo('body');
    var item_width = $('span.'+className+'_hide').width();
    var ideal = parseInt(ideal_width);
    var smaller_text = text;

    if (item_width>ideal_width){
        while (item_width > ideal) {
            smaller_text = smaller_text.substr(0, (smaller_text.length-1));
            $('.'+className+'_hide').html(smaller_text);
            item_width = $('span.'+className+'_hide').width();
        }
        smaller_text = smaller_text + '&hellip;'
    }
    $('span.'+className+'_hide').remove();
    return smaller_text;
} 
```

# java - 在 JAVA 中使用哪个 NLP 工具包？

> ID：895893
> 
> 赞同：7
> 
> 时间：2009-05-22T00:09:24.520
> 
> 标签：java, nlp, text-mining

我正在开展一个项目，该项目由一个连接到 NCBI（国家生物技术信息中心）并在那里搜索文章的网站组成。问题是我必须对所有结果进行一些文本挖掘。我正在使用 JAVA 语言进行文本挖掘，并使用带有 ICEFACES 的 AJAX 来开发网站。我有什么：从搜索返回的文章列表。每篇文章都有一个 ID 和一个摘要。这个想法是从每个抽象文本中获取关键字。然后比较所有摘要中的所有关键词，找出重复次数最多的关键词。然后在网站上显示搜索的相关词。有任何想法吗 ？我在网上搜索了很多，我知道有命名实体识别，词性标记，基因和蛋白质上有 NER 的 GENIA 词库，我已经尝试过词干... 停用词列表等...我只需要知道解决此问题的最佳方法。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T01:32:16.430

我建议您结合使用 POS 标记和字符串标记来从每个摘要中提取所有名词。然后使用某种字典/哈希来计算每个名词的频率，然后输出 N 个最多产的名词.. 将它与其他一些智能过滤机制结合起来应该可以很好地为您提供
用于 POS 标记的摘要中的重要关键字，请查看[http://nlp.stanford.edu/software/index.shtml上的 POS 标记器](http://nlp.stanford.edu/software/index.shtml)

但是，如果您希望语料库中有很多多词术语.. 而不是只提取名词，您可以采用n=2 到 4的最多产的[n-gram](http://en.wikipedia.org/wiki/N-gram)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-12T10:44:25.277

这也可能是相关的： [https ://github.com/jdf/cue.language](https://github.com/jdf/cue.language)

它有停用词、单词和 ngram 频率，...

它是[Wordle](http://www.wordle.net/)背后软件的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-15T15:43:37.840

有一个 Apache 项目……我没有使用它，但是[OpenNLP](http://incubator.apache.org/opennlp/index.html)是一个开源 Apache 项目。它在孵化器里，所以它可能有点生。

[杰夫的搜索引擎咖啡馆的](http://www.searchenginecaffe.com/2007/03/java-open-source-text-mining-and.html)这篇文章有许多其他建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T17:18:46.960

我最终使用了[Alias`i Ling Pipe](http://alias-i.com/lingpipe/)

# polygon - 从多边形内的点到多边形边的距离

> ID：895900
> 
> 赞同：3
> 
> 时间：2009-05-22T00:11:33.347
> 
> 标签：polygon, point

我正在使用 NLCD 数据处理一个巨大的区域、7 个森林和非森林状态。在一些森林区域内有一块地块（这是我正在研究的硕士论文）。我用这个大数据集难倒了我问过的每个人，但我们确信那里有一个解决方案。森林/非森林区域是带符号的离散栅格。通过对森林区域进行细分，我能够将森林区域变成多边形。我无法将非森林区域变成多边形（太大）。所以我试图让点距离（点在多边形内）到森林多边形的边缘。您对获取点到森林边缘的距离有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T09:31:58.840

这是一些输出从点到边的距离的代码，无论多边形是否凸面，CCW 与否。您必须测试所有多边形的边缘。对于大量边缘来说，它可能会有点慢。

```
- (double) distanceFromPoint:(yourPoint)testPoint
{

double pointX = edgePointB.x - edgePointA.x;
double pointY = edgePointB.y - edgePointA.y;

double k = pointX * pointX + pointY * pointY;
double u = ((testPoint.x - edgePointA.x) * pointX + (testPoint.y - edgePointA.y) * pointY) / k;

if (u > 1)
    u = 1;
else if (u < 0)
    u = 0;

double x = edgePointA.x + (u * pointX);
double y = edgePointA.y + (u * pointY);

double dx = x - testPoint.x;
double dy = y - testPoint.y;

return sqrt((dx * dx) + (dy * dy));

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T00:18:16.623

好吧，这确实取决于几件事；具体来说，你想要哪个边缘？你想找到最近的边，还是你有一些其他的标准来选择边（例如，基本方向）？

如果你想找到最近的边，你基本上想遍历多边形定义的所有线段，进行线段到点的距离计算；这会找到你的距离。[在这个](https://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment)问题上， Python 中有一个很好的算法实现，并且那里的算法有一些很好的描述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T00:21:57.087

如果您不确定该点是否在外部多边形内，请先对其进行测试。然后，为了测试到最近的森林边缘的距离，你可以尝试这样的事情：

[http://www.bdcc.co.uk/Gmaps/BdccGeo.js](http://www.bdcc.co.uk/Gmaps/BdccGeo.js)

谷歌有大量关于“从点到多边形边缘的距离”的结果

# asp.net - 使用 ELMAH 的 WCF 服务的异常日志记录

> ID：895901
> 
> 赞同：62
> 
> 时间：2009-05-22T00:11:38.137
> 
> 标签：asp.net, wcf, exception, logging, elmah

我们正在使用出色的[ELMAH](http://code.google.com/p/elmah)来处理 ASP.NET 3.5 Web 应用程序中未处理的异常。除了使用 REST 功能使用的 WCF 服务之外，这对于所有站点都非常有效。当应用程序代码未处理的操作方法中发生异常时，WCF 会根据服务协定和配置设置以各种方式处理它。这意味着异常不会最终触发[ELMAH](http://code.google.com/p/elmah)使用的 ASP.NET HttpApplication.Error 事件。我知道解决这个问题的两个解决方案是：

*   将所有方法调用包装在 try { } catch(Exception ex) { Elmah.ErrorSignal.FromCurrentContext().Raise(ex); 扔; } 在 catch 块中显式调用 Elmah。
*   使用[Will Hughes 的](http://will.hughesfamily.net.au/about/)博客文章[使 WCF 和 ELMAH 很好地协同](http://will.hughesfamily.net.au/20090505/making-wcf-and-elmah-play-nice-together/)工作中所述的[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)将对 ELMAH 的调用分解为单独的 ErrorHandler。

第一个选项非常简单，但并不完全是[DRY](http://en.wikipedia.org/wiki/Don't_repeat_yourself)。第二个选项只需要你在实现属性和ErrorHandler之后用自定义属性来装饰每个服务。我是根据[Will 的](http://will.hughesfamily.net.au/about/)工作完成的，但我想在发布代码之前验证这是**正确的方法。**

**我错过了更好的方法吗？**

[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)的 MSDN 文档说**HandleError**方法是进行日志记录的地方，但[ELMAH](http://code.google.com/p/elmah)访问 HttpContext.Current。**ApplicationInstance**，即使 HttpContext.Current 可用，在此方法中也为 null。在 ProvideFault 方法中调用 Elmah 是一种解决方法，因为 ApplicationInstance 已设置，但这与 API 文档中描述的意图不匹配。**我在这里错过了什么吗？**该文档确实声明您不应依赖在操作线程上调用的 HandleError 方法，这可能是 ApplicationInstance 在此范围内为 null 的原因。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-25T12:11:14.800

我的博客文章中的解决方案（在 OP 中引用）基于我们在错误状态期间用于更改 HTTP 响应代码的现有解决方案。

因此，对我们来说，将异常传递给 ELMAH 是一项更改。如果有更好的解决方案，我也很想知道。

对于后代/参考和潜在的改进 - 这是当前解决方案的代码。

### HttpErrorHandler 和 ServiceErrorBehaviourAttribute 类

```
using System;
using System.ServiceModel;
using System.ServiceModel.Dispatcher;
using System.ServiceModel.Channels;
using System.ServiceModel.Description;
using System.Collections.ObjectModel;
using System.Net;
using System.Web;
using Elmah;
namespace YourApplication
{
    /// <summary>
    /// Your handler to actually tell ELMAH about the problem.
    /// </summary>
    public class HttpErrorHandler : IErrorHandler
    {
        public bool HandleError(Exception error)
        {
            return false;
        }

        public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
        {
            if (error != null ) // Notify ELMAH of the exception.
            {
                if (System.Web.HttpContext.Current == null)
                    return;
                Elmah.ErrorSignal.FromCurrentContext().Raise(error);
            }
        }
    }
    /// <summary>
    /// So we can decorate Services with the [ServiceErrorBehaviour(typeof(HttpErrorHandler))]
    /// ...and errors reported to ELMAH
    /// </summary>
    public class ServiceErrorBehaviourAttribute : Attribute, IServiceBehavior
    {
        Type errorHandlerType;

        public ServiceErrorBehaviourAttribute(Type errorHandlerType)
        {
            this.errorHandlerType = errorHandlerType;
        }

        public void Validate(ServiceDescription description, ServiceHostBase serviceHostBase)
        {
        }

        public void AddBindingParameters(ServiceDescription description, ServiceHostBase serviceHostBase, Collection<ServiceEndpoint> endpoints, BindingParameterCollection parameters)
        {
        }

        public void ApplyDispatchBehavior(ServiceDescription description, ServiceHostBase serviceHostBase)
        {
            IErrorHandler errorHandler;
            errorHandler = (IErrorHandler)Activator.CreateInstance(errorHandlerType);
            foreach (ChannelDispatcherBase channelDispatcherBase in serviceHostBase.ChannelDispatchers)
            {
                ChannelDispatcher channelDispatcher = channelDispatcherBase as ChannelDispatcher;
                channelDispatcher.ErrorHandlers.Add(errorHandler);
            }
        }
    }
} 
```

### 使用示例

使用 ServiceErrorBehaviour 属性装饰您的 WCF 服务：

```
[ServiceContract(Namespace = "http://example.com/api/v1.0/")]
[ServiceErrorBehaviour(typeof(HttpErrorHandler))]
public class MyServiceService
{
  // ...
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-06-17T13:42:38.073

创建 BehaviorExtensionElement 时，甚至可以使用配置激活行为：

```
public class ErrorBehaviorExtensionElement : BehaviorExtensionElement
{
    public override Type BehaviorType
    {
        get { return typeof(ServiceErrorBehaviourAttribute); }
    }

    protected override object CreateBehavior()
    {
        return new ServiceErrorBehaviourAttribute(typeof(HttpErrorHandler));
    }
} 
```

配置：

```
<system.serviceModel>
    <extensions>
      <behaviorExtensions>
        <add name="elmah" type="Namespace.ErrorBehaviorExtensionElement, YourAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
      </behaviorExtensions>
    </extensions>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <elmah />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

这样也可以将 ELMAH 与 RIA 服务结合使用！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-05T16:47:14.080

这对某些人来说可能很明显，但我只是花了很长时间试图弄清楚为什么我的 HttpContext.Current 为空，尽管遵循了 Will Hughes 的所有出色答案。尴尬的是，我意识到这是因为我的 WCF 服务是由 MSMQ 消息激活的。

我最终重写了`ProvideFault()`方法：

```
if (HttpContext.Current == null)
{
    ErrorLog.GetDefault(null).Log(new Error(error));
}
else
{
    ErrorSignal.FromCurrentContext().Raise(error);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T05:25:14.727

> 我是根据 Will 的工作完成的，但我想在发布代码之前验证这是正确的方法。

我认为这是一个很好的方法（感谢 Will 发表这篇文章！）。我不认为威尔或你在这里错过了什么。实现 IErrorHandler 是捕获所有可能的服务器端异常的首选方法，否则这些异常可能会导致通信通道出现故障（拆除），因此它是挂钩某些日志记录（如 ELMAH）的自然场所。

马克

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-05T19:40:19.137

我无法使用 WCF 数据服务获得建议的答案。我连接了行为属性等，但仍然没有记录任何错误。相反，我最终将以下内容添加到服务实现中：

```
protected override void HandleException(HandleExceptionArgs args)
{
    Elmah.ErrorSignal.FromCurrentContext().Raise(args.Exception);
    base.HandleException(args);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T02:11:03.807

我没有尝试使用 REST 明确地执行此操作，并且我自己也没有使用 ELMAH，但另一个值得研究的选项可能是使用[IDispatchMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.idispatchmessageinspector.aspx)而不是 IErrorHandler 连接到 WCF。

# css - 在 HTML 中选择输入和文本输入 - 使宽度相等的最佳方法？

> ID：895904
> 
> 赞同：73
> 
> 时间：2009-05-22T00:13:07.243
> 
> 标签：css, xhtml

我有一个像这样的简单表格（仅用于说明目的）......

```
<form>

   <div class="input-row">
      <label>Name</label>
      <input type="text" name="name" />
   </div>

   <div class="input-row">
      <label>Country</label>
      <select name="country">
         <option>Australia</option>
         <option>USA</option>
      </select>
   </div>

</form> 
```

我使用CSS的布局方法如下...

```
form  {
    width: 500px;
}

form .input-row {
    display: block;
    width: 100%;
    height: auto;
    clear: both; 
    overflow: hidden; /* stretch to contain floated children */
    margin-bottom: 10px;
}

form .input-row label {
    display: block;
    float: left;
}

form .input-row input,
form .input-row select {
    display: block;
    width: 50%;
    float: right;
    padding: 2px;
} 
```

这一切都很好地对齐，除了我的`select`元素（无论如何在 Firefox 中）并不总是与我的其他`input`元素的宽度相同。它通常窄几个像素。

我尝试将宽度更改为像素大小（例如`200px`），但并没有什么不同。

让这些都具有相同宽度的最佳方法是什么？我希望它不会求助于我单独设置`select`'`width`或将它们放入表中......

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2009-05-22T18:25:49.520

解决方案是为表单元素指定盒子模型，当你使用border-box时，浏览器倾向于同意：

```
input, select, textarea {
  -webkit-box-sizing: border-box;
     -moz-box-sizing: border-box;
          box-sizing: border-box;
} 
```

* * *

有一个[normalize.css](http://necolas.github.io/normalize.css/)项目聚合了这些技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T00:30:53.463

填充将使文本更靠近框的边缘。

尝试将边距设置为 0px，如果看起来正确，请尝试使用它（就像只设置 margin-left 一样）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-28T15:59:09.507

100% 宽度的表格和单元格有同样的问题，文本框（宽度也为 100%）比表格单元格宽。

这解决了我在css中的问题：

```
table td
{
    padding-right: 8px;
} 
```

不是有史以来最好的解决方案，因为您可能会在右侧获得一些额外的空间。但至少它不再隐藏了！

# wpf - WPF Grid 中子控件之间的间距

> ID：895909
> 
> 赞同：58
> 
> 时间：2009-05-22T00:14:50.093
> 
> 标签：wpf, layout, grid

我有一组要在 WPF 窗口上显示的键/值对。我正在使用网格来布置它们，如下所示：

```
<Grid Margin="4">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <Label Grid.Row="0" Grid.Column="0">Code</Label>
    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Code}"/>

    <Label Grid.Row="1" Grid.Column="0">Name</Label>
    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Name}"/>
</Grid> 
```

但是，当我显示它时，TextBoxes 被压扁，它们的顶部和底部边框接触到 TextBox 上方/下方。向此布局中的行添加垂直空间的最佳方法是什么？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-05-22T00:19:27.667

最简单的方法是在各个控件上设置边距。将它设置在 TextBoxes 上应该就足够了，因为一旦它们被隔开，标签将垂直设置在每行的中心并且无论如何都有足够的空间。

您可以使用样式设置一次：

```
<Grid Margin="4">
    <Grid.Resources>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="Margin" Value="0,0,0,4" />
        </Style>
    </Grid.Resources>

    ...
</Grid> 
```

这将在网格内任何 TextBox 的底部添加一个 4 像素的边距。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2011-05-29T20:30:13.623

可以在[这里](http://blogs.microsoft.co.il/blogs/eladkatz/archive/2011/05/29/what-is-the-easiest-way-to-set-spacing-between-items-in-stackpanel.aspx)看到另一个不错的方法。

您创建用于设置`Margin`属性的类：

```
public class MarginSetter
{
    public static Thickness GetMargin(DependencyObject obj) => (Thickness)obj.GetValue(MarginProperty);

    public static void SetMargin(DependencyObject obj, Thickness value) => obj.SetValue(MarginProperty, value);

    // Using a DependencyProperty as the backing store for Margin. This enables animation, styling, binding, etc…
    public static readonly DependencyProperty MarginProperty =
        DependencyProperty.RegisterAttached(nameof(FrameworkElement.Margin), typeof(Thickness),
            typeof(MarginSetter), new UIPropertyMetadata(new Thickness(), MarginChangedCallback));

    public static void MarginChangedCallback(object sender, DependencyPropertyChangedEventArgs e)
    {
        // Make sure this is put on a panel
        var panel = sender as Panel;

        if (panel == null) return;

        panel.Loaded += Panel_Loaded;
    }

    private static void Panel_Loaded(object sender, EventArgs e)
    {
        var panel = sender as Panel;

        // Go over the children and set margin for them:
        foreach (FrameworkElement fe in panel.Children.OfType<FrameworkElement>())
            fe.Margin = GetMargin(panel);
    }
} 
```

现在你已经附加了属性行为，这样这样的语法就可以工作了：

```
<StackPanel local:MarginSetter.Margin="5">
   <TextBox Text="hello" />
   <Button Content="hello" />
   <Button Content="hello" />
</StackPanel> 
```

这是设置`Margin`面板的多个子项的最简单和最快的方法，即使它们不是同一类型。（即`Button`s、`TextBox`es、`ComboBox`es 等）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-07T09:53:26.393

将 TextBox 的 VerticalAlignment 设置为 Center 怎么样？

```
<Grid Margin="4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Grid.Column="0">Code</Label>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Code}" VerticalAlignment="Center"/>

                <Label Grid.Row="1" Grid.Column="0">Name</Label>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Name}" VerticalAlignment="Center"/>
            </Grid> 
```

# c - 声明指向 C 字符串数组的指针时应该使用多少个星号？

> ID：895911
> 
> 赞同：1
> 
> 时间：2009-05-22T00:16:37.737
> 
> 标签：c, dll, vb6, pointers, reference

我有一个 VB 应用程序从 C DLL 请求用户列表：
VB 将询问 DLL 有多少用户，然后将数组初始化为适当的大小。
然后，VB 将通过引用一个 DLL 函数来传递它的数组，该函数将用用户名填充它。

我开始像这样编写 C 函数：`foo(char **bar);`它将被视为字符串数组。但后来我意识到，我要让数组中的每个项目都指向不同的 C 字符串（链表中`char *username`的），而不是修改已经指向的数据。`struct userlist`数组数组按值传递：地址列表的副本，因此地址指向原始数据，但修改该副本中的地址不会更改调用者的地址列表（我认为，无论如何）。那么，我应该声明它`foo(char ***bar);`吗？这将是一个指向字符串数组的指针，因此如果我更改该数组指向的字符串，它将修改调用者（VB）正在使用的字符串数组......对吗？

这是我到目前为止的用法（还没有测试过......我仍然只是编写 DLL，到目前为止还没有 VB 前端可以调用它）

```
EXPORT void __stdcall update_userlist(char ***ulist){

  int i = 0;
  userlist *cur_user = userlist_head; //pointer to first item in linked list

  for(; i < usercount_; ++i){
    *ulist[i] = cur_user->username;
    cur_user = cur_user->next;
  }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T00:40:31.213

一般来说，按照你的要求去做并不简单，因为 VB 只是不理解 C 风格的 ASCIIZ 字符串和数组。

如果您的 DLL 不期望 BSTR 的 VB SafeArray，那么您将很难填充它。

让 VB 通过引用第一个元素传入一个 Long (C int) 数组是很简单的，你可以用指向单个字符串的指针来填充它。VB 端可以将它们复制到 VB 字符串中。但在那种情况下，谁处理 C 字符串，什么时候处理？

如果您创建 VB 数组并用预先确定的字符串填充它，您仍然必须在 C 端处理 SafeArray，因为您无法通过引用传递单个 VB 字符串数组元素并期望找到剩余的在内存中与它相邻的字符串。

最好、最安全的方法是让您的 DLL 创建一个所谓的“Ansi BSTR”的 SafeArray，并在 VB 中将该函数声明为返回一个字符串数组。然后你不需要两次调用，因为数组边界将说明整个故事。

===== 编辑 =====

当 VB 将字符串数组传递给已声明的函数时，它会在幕后进行一些巫术。它首先将所有字符串从 Unicode 转换为通常称为“Ansi BSTR”的混蛋形式。对于 C，这些看起来像并且可以被视为 ASCIIZ 或 LPSTR，除了您不能以正常 C 方式创建或延长它们，您只能填充它们。在 C 端，传递的数组看起来像 ppSA (SAFEARRAY **)。Ansi BSTR 是 SafeArray 的 pData 成员引用的一系列指针。

您绝对不能从数组中传递单个字符串（作为 char*）并期望在内存中找到与其相邻的其余字符串。您必须传递数组本身并使用 SafeArray API（或 SA 结构的知识）对其进行操作。

这就是为什么总体上最好的选择是直接在 DLL 中完成所有这些操作。使用 SafeArrayCreate 创建数组，然后使用 SysAllocStringByteLen 创建 Ansi BSTR，并将这些字符串（它们是 BSTR，因此是 4 字节指针）放入数组槽中。返回时，VB 会执行它的巫术并为您将字符串转换为 Unicode。

在 VB 中，您的函数将被声明为返回 String()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T00:27:13.813

两个星号是要走的路。

```
char*   // is a pointer to a char
char**  // is a pointer to a char pointer
char*** // is a pointer to a pointer to a char pointer - e.g. multi-dimensional array (err...) 
```

我自己都糊涂了：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T00:46:04.087

所以让我直截了当。您的函数从链接列表中包含的数据中填充字符串数组？

如果你事先知道列表的大小，你可以只传递一个 char **，但如果你不知道列表的大小并且需要能够增长列表，你将需要一个 char ***。

通过查看您的代码，您似乎已经知道长度，因此您只需在调用函数之前分配一个正确长度的数组。这是一个例子：

```
void update_userlist(char **ulist)
{
    int i = 0;
    userlist *cur_user = userlist_head;

    for(; i < usercount_; ++i)
    {
        ulist[i] = cur_user->username; // I am assuming that username is a char *
        cur_user = cur_user->next;
    }
}

// This sets up the array and calls the function.
char **mylist  = malloc(sizeof(char*) * usercount_);
update_userlist(mylist); 
```

**更新：这是各个级别的指针之间的区别：**

1.  void func1(char *data)
    这会将指针的副本传递给 C 字符串。如果将指针更改为指向不同的字符串，调用函数仍将指向原始字符串。

2.  void func2(char **data)
    这将指针的副本传递给指向 C 字符串的指针数组。您可以替换指向数组中任何字符串的指针，调用函数的数组将被更改，因为它没有复制数组，它只指向调用者的数组。

3.  void func3(char ***data)
    这将一个指针传递给一个指向 C 字符串指针数组的指针。有了这个，您可以完全替换整个阵列。如果您需要增加数组，您只需要这种间接级别，因为 C 数组无法重新调整大小。

# architecture - 如何将事件日志数据保存在数据库中？

> ID：895912
> 
> 赞同：3
> 
> 时间：2009-05-22T00:16:41.527
> 
> 标签：architecture, domain-driven-design

在我的应用程序中，我强烈要求记录实体的每个事件，并且我正在考虑使用[事件源](http://www.martinfowler.com/eaaDev/EventSourcing.html)模式，即所有域更改都有明确的类，并且对域对象的任何更改都只能使用这些事件类。然后，您可以根据需要回滚并重新应用这些更改，就像在源代码控制系统中一样。

这将为我解决许多问题，但我不知道如何将事件对象持久化到数据库。我可能会有数百种事件类型，所以我的选择有限：

*   为每种事件类型构建一个表（数百个表？对实体的引用呢？）
*   为所有事件构建一个巨大的表（有数千列？）
*   以某种方式将事件的二进制表示形式存储在 db (??)
*   将其存储在某个单独的文件中（？？）

你有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T01:08:48.690

你的基本问题是你有一个完全非关系的模型，你试图匹配一个关系数据库。这不会很好地工作。所以从细节上移开一秒钟，想想你的两个基本方向选择：

1.  您可以尝试构建一个更相关的模型。如果你走这条路，最好从数据库本身的角度来考虑，暂时或多或少地忽略编程方面：哪种模式最能表达你的业务领域？

2.  您可以坚持使用 OO 模型，并使用任何东西进行存储。

对于第二个选项，您有多种可用的存储选项，您可以随意选择它们。

RDBMS 是一种选择，尽管您的模式将是相当非关系的，并且您将无法利用 RDBMS 为您提供的一些强大的关系工具。我不会对此感到难过：如果您考虑了这两种模型，并决定采用 OO，那么您已经有意识地做出了选择。您的架构很可能最终看起来像一个事件表，每个事件都有一个类型名称，以及每个事件的键值形式的属性表。

对象数据库将让您以或多或少与内部使用相同的形式保存您的东西，这可能很方便。但请注意，如果您遇到性能问题，此选项可能是最难分析和加速的。

平面文件是一个有趣的选择：只需将对象序列化为某种合理的形式并将它们写出来。这通常是最快的处理方式，因为它提供了（特别是如果您 gzip 文件）对数据进行全面扫描的最快格式之一。如果您有需要经常执行的特定查询，只选择分布在整个集合中的数据的一个非常小的子集，那么使用某种可以使用索引的 DBMS 可能会有所帮助，但是如果您在无论如何，您大部分时间都在扫描的位置，DBMS 只会减慢您的速度。请注意，您可以（并且可能会）通过将它们放在不同的文件中来将它们划分为一个甚至可能是两个维度。如果您有十几个基本业务领域，在其中记录您经常单独查询的事件，

我经常在这类事情上受到很多反对，但正如 Unix 管道、文本处理工具和脚本语言的成功所证明的那样，这些东西确实有效。十五年后，Web 服务器日志的标准仍然是文本格式，看看它产生的所有分析工具。

无论如何，一旦您进行序列化，您就有很多其他的存储选项。您也可以将序列化的块存储在 Berkeley DB 中或 RDBMS 中的列中。

至于序列化本身，您在这里也有各种选择，您应该考虑一下。大多数语言都有某种标准的二进制序列化格式，可以序列化所有内容并返回完整的对象。这些通常很复杂，并且存在版本控制问题等等。我通常发现使用简单的自定义格式要容易得多。我可以像一条带有名称和键值列表的 ASCII 行一样简单：

```
InvoiceCreate invoice_number=12345 date=2009-05-21 salesperson="Jill Gaines" ... 
```

这有很多优点：

*   它是人类可读的，因此易于调试。
*   像这样的文件可以使用 grep、sed、awk 等进行处理以进行临时查询。
*   它是人工可写的，有利于调试、测试和修复损坏的数据。
*   很容易解析。
*   它不与任何特定的对象结构、格式甚至语言相关联，因此您可以轻松更改应用程序，而不必担心与序列化数据的兼容性。
*   当您需要更改数据格式时，可以轻松更新数据本身（通常使用简单的 sed 脚本！）。

（再次强调一下，你会惊讶于 grep 对这样的文件的操作速度有多快：除非你有千兆字节的数据，或者你需要每秒执行几十个查询，否则这可能会提供你需要的所有性能。）

关于这种方法的最后一件事：它是一种很好的、​​灵活的方式来体验您需要什么样的实体和属性。虽然现在您在该领域中似乎有数百种不同的东西，但您可能会发现，经过几个月的工作一段时间后，您的理解已经发展到足以以更简单的方式对其进行建模。如果达到这一点，如果现在更适合您的模型，您可以考虑切换到 RDBM。

这也可以用作卖点：如果您最终有人反对您不使用 RDBMS（无论您是否需要它），只需在您制定模型时将其作为“实验阶段”出售，并在模型安定下来后告诉他们您已经搬家了。即使它不动，一旦你有一个运作良好的系统，他们也不太可能给你很大的压力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T00:23:25.677

有一个很好的现实模拟，这是一个会计系统。每个专业会计系统基本上都基于交易日志，这些日志断言财务状况的每次变化的背景 - 相当于您实体的状态变化。

我已经多次使用这种模式，它通常是一组（不是太多）表，其中至少有一个表的主键、一个时间戳和一个用户名。

如果您想稍微分享一下您的实体模型，我们可以讨论具体案例。但通常表的结构会从与正在记录的真实事件相关的用例中删除。

几个好处 -

> 1.  对于您的设计，他是一个很好的用户关系钩子，因为它是数据库中为数不多的不言自明的表之一。（“是的，这就是人们所做的事情，并且在他们这样做时需要记录下来。”）
>     
>     
> 2.  它构建了一些现实生活中的灵活性，用于处理来自多个来源的交易，这些来源可能无法实时集成，但您需要重建年表。（例如从 A 点到 B 点和 C 点到 D 点的运输。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T02:13:58.920

另一种选择是将相关键和常用搜索值存储在常规列中，并将其余部分放在 XML 列中（或等效的格式化文本，例如 JSON 或适用于您的应用程序的任何内容）

这假设大多数时候您需要做的就是从数据库中重构原始事件（如序列化/反序列化），而不是（有效地）搜索每个可能的属性

# database - JSP网站前置库配置

> ID：895914
> 
> 赞同：0
> 
> 时间：2009-05-22T00:18:53.207
> 
> 标签：database, jsp, configuration

我正在使用 JSP 开发一个网站（实际上是在 GWT 中，但在服务器端，它实际上只是 JSP），我需要配置我的数据库。

我知道如何在数据库连接等中编码，但我想知道应该如何/在哪里保存数据库配置。

为了澄清我的疑问，让我举个例子；在 PHP 中，网站通常有一个 config.php，用户在其中配置数据库、用户等（或 install.php 生成它）。

但是，由于 JSP 是字节码，我不能将此信息编码到我的站点中并让用户对其进行修改，也不能将其修改为类似于 install.php。

我该如何处理？最好/最常见的做法是什么？我没有找到**这样**的例子。主要是配置文件应该存放**在哪里？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T00:51:45.700

有几种可能性可以做到这一点，我所看到的包括：

*   在特殊文件中包含数据库凭据，通常`db.properties`是包含所需信息（驱动程序、url、用户名、密码、任何 ORM 参数（如果需要））的简单 XML 文件。属性文件将放置在`WEB-INF`或下`WEB-INF/classes`；这种方法的缺点是用户必须先修改 WAR 中的文件*，*然后才能将其部署到应用程序服务器。
*   通过 JNDI 获取数据库连接，并期望它由应用服务器提供。这似乎是最常见的方法；从好的方面来说，您的 WAR 不必更改，但是，缺点是配置 JNDI 数据源对于每个应用程序服务器都是不同的，如果您的系统管理员没有 Java 技术经验，可能会感到困惑。

# git - 我如何发布到 .github.com？

> ID：895918
> 
> 赞同：8
> 
> 时间：2009-05-22T00:20:06.870
> 
> 标签：git, branch, github

我已阅读[指南](http://pages.github.com/)，它告诉您执行以下操作：

1.  创建一个 .github.com 存储库
2.  检查出来`path/to/repo`
3.  cd /path/to/repo
4.  git symbolic-ref HEAD refs/heads/gh-pages
5.  rm .git/索引
6.  git clean -fdx
7.  回显“我的 GitHub 页面”> index.html
8.  混帐添加。
9.  git commit -a -m "首页提交"
10.  git push origin gh-pages

我已经做到了。页面出现了。然后我转移到另一台计算机并再次检查了存储库。现在我`master`在本地有一个 " " 分支，但没有 " `gh-pages`." 按照上面的步骤 3-6，我在该分支中没有文件。如何从“ `master`”获取文件到将发布到 GitHub 的分支中？

我试过`git checkout master && git push origin gh-pages`了，但这会产生

```
error: src refspec gh-pages does not match any.
fatal: The remote end hung up unexpectedly
error: failed to push to 'git@github.com:<me>/<me>.github.com.git' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T00:51:28.523

显然随后推送到“ `origin master`”实际上可以解决问题！但是，它没有记录在指南中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-08T16:30:43.910

正如 Gaius 所说，您正在按照“项目页面”的说明进行操作，但您不是在尝试创建项目页面，而是在尝试创建用户页面。创建用户页面要容易得多 - 您只需创建一个“.github.com”存储库，然后将您的网站文件推送到它的主分支，就像您对任何其他普通项目一样。

您尝试遵循的说明是将包含网站文件的并行分支添加到现有项目中。我们不想让您在项目中添加“网站”子目录或其他内容，因此我们让您创建一个全新的分支并将您的网站推送到该不相关的分支 - 因此那里的 Git 诡计。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T00:47:03.383

要在新的远程存储库签出的分支上工作，您首先需要在本地创建分支。这是“<code>gh-pages”分支的示例：

```
git checkout --track -b gh-pages origin/gh-pages 
```

本文[“将项目网站迁移到 github 页面”中的更多详细信息](http://drnicwilliams.com/2008/12/21/migrating-project-websites-to-github-pages-with-sake-tasks-new-websites-with-jekyll_generator/)

# c# - 如何确定一组值的标准偏差 (stddev)？

> ID：895929
> 
> 赞同：47
> 
> 时间：2009-05-22T00:26:54.157
> 
> 标签：c#, math, statistics, numerical

我需要知道与一组数字相比的数字是否在平均值的 1 stddev 之外，等等。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-05-22T11:46:25.430

虽然平方和算法在大多数情况下都可以正常工作，但如果您处理非常大的数字，它可能会造成很大的麻烦。你基本上可能会得到一个负方差......

另外，永远不要将 a^2 计算为 pow(a,2)，a * a 几乎肯定会更快。

到目前为止，计算标准差的最佳方法是[Welford 方法](http://www.johndcook.com/standard_deviation.html)。我的 C 非常生锈，但它可能看起来像：

```
public static double StandardDeviation(List<double> valueList)
{
    double M = 0.0;
    double S = 0.0;
    int k = 1;
    foreach (double value in valueList) 
    {
        double tmpM = M;
        M += (value - tmpM) / k;
        S += (value - tmpM) * (value - M);
        k++;
    }
    return Math.Sqrt(S / (k-2));
} 
```

如果您有*整个*总体（而不是*样本*总体），则使用`return Math.Sqrt(S / (k-1));`.

**编辑：**我已经根据 Jason 的评论更新了代码......

**编辑：**我还根据亚历克斯的评论更新了代码......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-10-30T20:18:04.373

**比 Jaime 的解决方案**快 10 倍，但****请注意**，正如 Jaime 指出的那样：**

 **> “虽然平方和算法在大多数情况下都能正常工作，但如果处理**非常大**的数字，它可能会造成很大的麻烦。你基本上可能会得到一个负方差”

如果您认为您正在处理非常大的数字或非常大量的数字，您应该使用这两种方法进行计算，如果结果相等，您肯定知道您可以使用“我的”方法来处理您的情况。

```
 public static double StandardDeviation(double[] data)
    {
        double stdDev = 0;
        double sumAll = 0;
        double sumAllQ = 0;

        //Sum of x and sum of x²
        for (int i = 0; i < data.Length; i++)
        {
            double x = data[i];
            sumAll += x;
            sumAllQ += x * x;
        }

        //Mean (not used here)
        //double mean = 0;
        //mean = sumAll / (double)data.Length;

        //Standard deviation
        stdDev = System.Math.Sqrt(
            (sumAllQ -
            (sumAll * sumAll) / data.Length) *
            (1.0d / (data.Length - 1))
            );

        return stdDev;
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-25T12:44:47.563

Jaime 接受的答案很好，除了您需要在最后一行除以 k-2（您需要除以“number_of_elements-1”）。更好的是，从 0 开始 k：

```
public static double StandardDeviation(List<double> valueList)
{
    double M = 0.0;
    double S = 0.0;
    int k = 0;
    foreach (double value in valueList) 
    {
        k++;
        double tmpM = M;
        M += (value - tmpM) / k;
        S += (value - tmpM) * (value - M);
    }
    return Math.Sqrt(S / (k-1));
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-02-19T00:42:43.340

Math.NET 库为您提供了此功能。

> PM> 安装包 MathNet.Numerics

```
var populationStdDev = new List<double>(1d, 2d, 3d, 4d, 5d).PopulationStandardDeviation();

var sampleStdDev = new List<double>(2d, 3d, 4d).StandardDeviation(); 
```

有关详细信息，请参阅[PopulationStandardDeviation](https://numerics.mathdotnet.com/api/MathNet.Numerics.Statistics/Statistics.htm#PopulationStandardDeviation)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T00:44:46.650

您可以通过累积均值和均方来避免对数据进行两次传递

```
cnt = 0
mean = 0
meansqr = 0
loop over array
    cnt++
    mean += value
    meansqr += value*value
mean /= cnt
meansqr /= cnt 
```

并形成

```
sigma = sqrt(meansqr - mean^2) 
```

一个因素`cnt/(cnt-1)`通常也是合适的。

[顺便说一句 - Demi](https://stackoverflow.com/questions/895929/how-do-i-determine-the-stddev-of-a-set-of-values/896070#896070)和[McWafflestix](https://stackoverflow.com/questions/895929/how-do-i-determine-the-stddev-of-a-set-of-values/895939#895939)答案中数据的第一次传递隐藏在对`Average`. 这种事情在一个小列表上肯定是微不足道的，但如果列表超过缓存的大小，甚至超出工作集的大小，这将成为一个投标交易。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T01:44:37.293

代码片段：

```
public static double StandardDeviation(List<double> valueList)
{
    if (valueList.Count < 2) return 0.0;
    double sumOfSquares = 0.0;
    double average = valueList.Average(); //.NET 3.0
    foreach (double value in valueList) 
    {
        sumOfSquares += Math.Pow((value - average), 2);
    }
    return Math.Sqrt(sumOfSquares / (valueList.Count - 1));
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-25T01:12:46.680

我发现 Rob 的有用答案与我使用 excel 看到的不太匹配。为了匹配 excel，我将 valueList 的平均值传递给 StandardDeviation 计算。

这是我的两分钱......显然你可以从函数内部的 valueList 计算移动平均线（ma） - 但我碰巧在需要标准偏差之前已经有了。

```
public double StandardDeviation(List<double> valueList, double ma)
{
   double xMinusMovAvg = 0.0;
   double Sigma = 0.0;
   int k = valueList.Count;

  foreach (double value in valueList){
     xMinusMovAvg = value - ma;
     Sigma = Sigma + (xMinusMovAvg * xMinusMovAvg);
  }
  return Math.Sqrt(Sigma / (k - 1));
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-05T05:40:25.987

使用扩展方法。

```
using System;
using System.Collections.Generic;

namespace SampleApp
{
    internal class Program
    {
        private static void Main()
        {
            List<double> data = new List<double> {1, 2, 3, 4, 5, 6};

            double mean = data.Mean();
            double variance = data.Variance();
            double sd = data.StandardDeviation();

            Console.WriteLine("Mean: {0}, Variance: {1}, SD: {2}", mean, variance, sd);
            Console.WriteLine("Press any key to continue...");
            Console.ReadKey();
        }
    }

    public static class MyListExtensions
    {
        public static double Mean(this List<double> values)
        {
            return values.Count == 0 ? 0 : values.Mean(0, values.Count);
        }

        public static double Mean(this List<double> values, int start, int end)
        {
            double s = 0;

            for (int i = start; i < end; i++)
            {
                s += values[i];
            }

            return s / (end - start);
        }

        public static double Variance(this List<double> values)
        {
            return values.Variance(values.Mean(), 0, values.Count);
        }

        public static double Variance(this List<double> values, double mean)
        {
            return values.Variance(mean, 0, values.Count);
        }

        public static double Variance(this List<double> values, double mean, int start, int end)
        {
            double variance = 0;

            for (int i = start; i < end; i++)
            {
                variance += Math.Pow((values[i] - mean), 2);
            }

            int n = end - start;
            if (start > 0) n -= 1;

            return variance / (n);
        }

        public static double StandardDeviation(this List<double> values)
        {
            return values.Count == 0 ? 0 : values.StandardDeviation(0, values.Count);
        }

        public static double StandardDeviation(this List<double> values, int start, int end)
        {
            double mean = values.Mean(start, end);
            double variance = values.Variance(mean, start, end);

            return Math.Sqrt(variance);
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-09T12:50:11.720

```
/// <summary>
/// Calculates standard deviation, same as MATLAB std(X,0) function
/// <seealso cref="http://www.mathworks.co.uk/help/techdoc/ref/std.html"/>
/// </summary>
/// <param name="values">enumumerable data</param>
/// <returns>Standard deviation</returns>
public static double GetStandardDeviation(this IEnumerable<double> values)
{
    //validation
    if (values == null)
        throw new ArgumentNullException();

    int lenght = values.Count();

    //saves from devision by 0
    if (lenght == 0 || lenght == 1)
        return 0;

    double sum = 0.0, sum2 = 0.0;

    for (int i = 0; i < lenght; i++)
    {
        double item = values.ElementAt(i);
        sum += item;
        sum2 += item * item;
    }

    return Math.Sqrt((sum2 - sum * sum / lenght) / (lenght - 1));
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-13T06:57:45.423

所有其他答案的问题在于他们假设您将数据放在一个大数组中。如果您的数据是即时进入的，这将是一种更好的方法。无论您如何或是否存储数据，此类都有效。它还为您提供了华尔道夫方法或平方和方法的选择。两种方法都使用单次通过。

```
public final class StatMeasure {
  private StatMeasure() {}

  public interface Stats1D {

    /** Add a value to the population */
    void addValue(double value);

    /** Get the mean of all the added values */
    double getMean();

    /** Get the standard deviation from a sample of the population. */
    double getStDevSample();

    /** Gets the standard deviation for the entire population. */
    double getStDevPopulation();
  }

  private static class WaldorfPopulation implements Stats1D {
    private double mean = 0.0;
    private double sSum = 0.0;
    private int count = 0;

    @Override
    public void addValue(double value) {
      double tmpMean = mean;
      double delta = value - tmpMean;
      mean += delta / ++count;
      sSum += delta * (value - mean);
    }

    @Override
    public double getMean() { return mean; }

    @Override
    public double getStDevSample() { return Math.sqrt(sSum / (count - 1)); }

    @Override
    public double getStDevPopulation() { return Math.sqrt(sSum / (count)); }
  }

  private static class StandardPopulation implements Stats1D {
    private double sum = 0.0;
    private double sumOfSquares = 0.0;
    private int count = 0;

    @Override
    public void addValue(double value) {
      sum += value;
      sumOfSquares += value * value;
      count++;
    }

    @Override
    public double getMean() { return sum / count; }

    @Override
    public double getStDevSample() {
      return (float) Math.sqrt((sumOfSquares - ((sum * sum) / count)) / (count - 1));
    }

    @Override
    public double getStDevPopulation() {
      return (float) Math.sqrt((sumOfSquares - ((sum * sum) / count)) / count);
    }
  }

  /**
   * Returns a way to measure a population of data using Waldorf's method.
   * This method is better if your population or values are so large that
   * the sum of x-squared may overflow. It's also probably faster if you
   * need to recalculate the mean and standard deviation continuously,
   * for example, if you are continually updating a graphic of the data as
   * it flows in.
   *
   * @return A Stats1D object that uses Waldorf's method.
   */
  public static Stats1D getWaldorfStats() { return new WaldorfPopulation(); }

  /**
   * Return a way to measure the population of data using the sum-of-squares
   * method. This is probably faster than Waldorf's method, but runs the
   * risk of data overflow.
   *
   * @return A Stats1D object that uses the sum-of-squares method
   */
  public static Stats1D getSumOfSquaresStats() { return new StandardPopulation(); }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-25T13:12:34.493

我们也许可以在 Python 中使用统计模块。它有 stedev() 和 pstdev() 命令分别计算样本和总体的标准差。

详细信息：[https ://www.geeksforgeeks.org/python-statistics-stdev/](https://www.geeksforgeeks.org/python-statistics-stdev/)

将统计信息导入为 st print(st.ptdev(dataframe['column name']))

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-02-28T13:08:03.620

这是人口标准差

```
private double calculateStdDev(List<double> values)
{
    double average = values.Average();
    return Math.Sqrt((values.Select(val => (val - average) * (val - average)).Sum()) / values.Count);
} 
```

对于示例标准偏差，只需将上述代码中的 [values.Count] 更改为 [values.Count -1]。

确保您的集合中没有只有 1 个数据点。

# html - 哪个 javascript 库或框架支持“目录”生成？

> ID：895932
> 
> 赞同：0
> 
> 时间：2009-05-22T00:28:38.240
> 
> 标签：html, javascript, javascript-framework

我正在寻找从 HTML（带锚点）动态生成“目录”的 javascript。

例子：

```
<h1>First level1 heading</h1>
lorem ipsum
<h2>1a heading</h2>
lorem ipsum
<h2>1b heading</h2>
lorem ipsum
<h1>Second level1 heading</h1>
lorem ipsum 
```

应该返回类似的东西

```
 First level1 heading   
   1a heading   
   1b heading 
 Second level1 heading 
```

带有链接到标题的行，并且应该返回原始的 html 并插入锚点。

大型 javascript 库或框架之一中是否包含某些内容？

如果他们都没有，是否有人为此目的看到了一个好的 JS 模块？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T00:34:09.043

[jQuery](http://www.jquery.org)是你的朋友，有这个插件：[目录](http://plugins.jquery.com/project/table-of-contents)。主页是[http://code.google.com/p/samaxesjs/](http://code.google.com/p/samaxesjs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T01:11:39.857

自己做，我写的:)，希望对你有帮助

添加一个 div 元素作为 body 元素的第一个子元素，并将 id 指定为“tableOfContents”

并将下面的脚本添加为 body 元素的最后一个子元素

```
<script>
    var el = document.getElementsByTagName("*") || [];
    var toc = "<ul>";
    var lvl = 1;
    for(var i=0;i<el.length;i++)
    {
        var ce = el[i];
        var tag = ce.tagName + "";
        var m = tag.match(/^h([1-5])$/i);
        if(m)
        {
            var n = Number(m[1]);
            if(lvl > n)
            {
                while(lvl-->n)toc+="</ul></li>";  
            }else if(lvl < n){
                while(lvl++<n)toc+="<li style='list-style:none'><ul>";
            }
            toc +=  '<li><a href="#toc_' + i + '">' + 
                    (ce.innerText || ce.text()) +
                    '</a></li>';
            var ta = document.createElement("div");
            ta.innerHTML = '<a name="toc_' + i + '" />';
            ce.insertBefore(ta, ce.firstChild);
        }
    }
    while(lvl-->1)toc+="</ul></li>";
    toc+="</ul>";
    document.getElementById("tableOfContents").
        innerHTML = toc;
</script> 
```

此脚本将检测每个 H（1 到 5）并生成您的目录

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-22T00:52:26.430

这是一个非常简单的问题，可以通过 10-20 行函数来解决。不需要框架。要么使用 getElementsByTagName('h1')、getElementsByTagName('h2') 遍历 DOM，要么使用正则表达式。加载框架会带来性能影响和风险，因此我建议不要为简单的问题安装框架。

# php - 使用 PHP 的 SQL 语句出现问题

> ID：895951
> 
> 赞同：0
> 
> 时间：2009-05-22T00:41:13.707
> 
> 标签：php, mysql

我目前正在尝试使用 PHP 从 MYSQL 中提取数据，但我不断收到以下错误：

*“无法检索记录：您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '%PC4198% OR oem LIKE %Fluke%' 附近使用正确的语法”*

我的SQL语句如下：

```
$sql = "SELECT * FROM account WHERE `NSC ID` LIKE %".$nscid."% OR oem LIKE %".$oem."%"; 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T00:43:35.497

你的字符串应该被引用：

```
$sql = "SELECT * FROM account WHERE NSC ID LIKE '%".$nscid."%' OR oem LIKE '%".$oem."%'"; 
```

也就是说，您应该真正考虑使用 PDO 或 ORM。

编辑：

正如比尔所说，使用 PDO 的主要目的是防止 SQL 注入（由将可能的脏字符串连接到 SQL 中引起）。

PDO 样式中的相同查询将是：

```
$query = $connection->prepare('SELECT * FROM account WHERE NSCID LIKE :nscid OR oem LIKE :orm');
$query->bindValue(':nscid', '%'.$nscid.'%', PDO::PARAM_STR);
$query->bindValue(':oem', '%'.$oem.'%', PDO::PARAM_STR); 
```

它还有一些代码，但它会通过让库进行转义来保护您免受大多数（全部？）SQL 注入的影响。

（bindValue 的参数类型是可选的，但很好的做法。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T00:52:45.010

更好的是，运算符 { 和 } 可以让你这样做

```
$sql="SELECT * FROM account WHERE NSC ID Like '%{$nscid}%' OR oem LIKE '%{$oem}%'"; 
```

如果它是像这样的单个变量，则不需要 {}，但如果您使用对象，则确实需要它们：

```
$hi_example="yarg i am a {$person->type}"; 
```

# windows - 在 MSVS 的 .msi 项目中定位第 3 方应用程序的安装位置

> ID：895962
> 
> 赞同：0
> 
> 时间：2009-05-22T00:45:32.293
> 
> 标签：windows, dll, installation, visual-c++

背景：我有一些插件（实际上只是具有不同扩展名的 DLL）需要安装在 3rd 方应用程序的子文件夹中。通常只需将它们复制到所述文件夹就足够了，但有时还需要安装其他库。我想让这个过程对用户来说不太容易出错，所以我研究了在 Visual Studio 中使用安装程序项目来创建 .msi，但是我无法正确配置安装位置。

似乎它假定安装程序适用于完整的应用程序，并且默认为 C:\Program Files\MyApp\ 等位置，但我真正需要的是 C:\Program Files\\Plugins。我不想假设用户在任何特定位置安装了第 3 方应用程序，所以我想要的是一种定位其他应用程序安装位置的方法。我已经搜索了 Microsoft 的文档并自己进行了一些实验，但没有任何成功。

假设这是可能的，有人知道如何完成我想要的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-20T22:38:14.573

如果您的应用程序使用了 Windows 安装程序，您可以尝试以下方法 (C#)：

```
 Type type = Type.GetTypeFromProgID("WindowsInstaller.Installer");
    Installer msi = (Installer)Activator.CreateInstance(type);
    foreach (string productcode in msi.Products)
    {
        string productname = msi.get_ProductInfo(productcode, "InstalledProductName");
        if (productname.Contains("<YOUR PRODUCT NAME HERE>"))
        {
            string installdir = msi.get_ProductInfo(productcode, "InstallLocation");
            Console.WriteLine("{0}: {1} @({2})", productcode, productname, installdir);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T23:41:43.233

大多数应用程序会将其安装位置写入注册表中的某个位置。我们读取以下注册表项下的值以查找 Microsoft Word 安装位置。

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\Winword.exe] 
```

不幸的是，没有标准的方法来检索特定应用程序的安装位置。您必须搜索注册表才能找到所需的内容。

# iphone - iPhone 相当于 -doCommandBySelector:?

> ID：895963
> 
> 赞同：2
> 
> 时间：2009-05-22T00:45:47.363
> 
> 标签：iphone, cocoa, cocoa-touch

我想将一些东西推送到 iPhone 的响应者链上。也就是说，我想将一个选择器发送到一个`UIResponder`子类，如果它不响应所述选择器，让它传递给它的`nextResponder`.

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T01:53:55.433

请参阅 -[UIApplication sendAction:to:from:forEvent:] 的文档。

> ID：895971
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# php - MYSQL SUM 按数量和值

> ID：895980
> 
> 赞同：0
> 
> 时间：2009-05-22T00:53:01.203
> 
> 标签：php, mysql

我想知道是否可以使用表值从一个查询中获得 2 个总和，然后将它们加在一起。

这是一些可能有帮助的简单表格和数据。

```
 CREATE TABLE `cartcontents` (
  `id` int(11) NOT NULL auto_increment,
  `code` varchar(40) NOT NULL,
  `qty` int(10) NOT NULL,
  `price` decimal(30,2) NOT NULL,
  `cart_id` int(11) NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `zone` (`zone_code`,`cart_id`)
) ENGINE=MyISAM AUTO_INCREMENT=8 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Records 
-- ----------------------------
INSERT INTO `cartcontents` VALUES ('5', '011242077783866125432', '1', '36.00', '2');
INSERT INTO `cartcontents` VALUES ('4', '011242077793513596890', '3', '33.00', '4');
INSERT INTO `cartcontents` VALUES ('6', '011242077649557011493', '1', '110.00', '4');
INSERT INTO `cartcontents` VALUES ('7', '011242077724922511037', '1', '177.00', '5'); 
```

所以我希望能够收集给定购物车 ID 的总数量和总价值。

因此，这意味着如果我在提交的数量中有 3 个，则每个区域的总和需要为（数量 * 价格），然后将它们加起来作为 cart_id。

所以在上面的例子中，如果我正在寻找 cart_id 4 的值，我希望我能返回的值是 qty = 4 & total value = 209

希望这是有道理的，如果你能提供帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T00:58:50.520

像这样的东西应该工作：

```
SELECT SUM(qty) AS qty, SUM(qty * price) AS total
FROM cartcontents
GROUP BY cart_id 
```

# wcf - WCF 应用程序中的 NHibernate 会话管理

> ID：895988
> 
> 赞同：15
> 
> 时间：2009-05-22T00:58:08.447
> 
> 标签：wcf, nhibernate

我正在构建一个 WCF 应用程序，使用 NHibernate 作为持久层。那里有很多关于在 ASP.NET 应用程序中使用 NHibernate 的文档。但很少有关于在 WCF 应用程序中管理 NHibernate 会话的最佳方法。

在阅读了 WCF 应用程序中的[实例管理技术](http://msdn.microsoft.com/en-us/magazine/cc163590.aspx)之后，我将使用“每次调用服务”。与 ASP.NET 并行绘制，这就像`Application_BeginRequest`在`Application_EndRequest`. Billy McCafferty 的[S#arp Architecture](http://code.google.com/p/sharp-architecture/)有一个很好的例子，可以非常优雅地做到这一点。但是我发现在 WCF 应用程序中使用类似的概念有点困难。

任何代码示例或指向带有示例的博客的指针，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T01:04:42.240

[http://www.igloocoder.com/archive/2009/04/23/wcf-and-nhibernate-redux.aspx](http://www.igloocoder.com/archive/2009/04/23/wcf-and-nhibernate-redux.aspx) -> [https://igloocoder.net:8443/svn/IglooCommons/trunk/src/IglooCoder.Commons /Wcf休眠/](https://igloocoder.net:8443/svn/IglooCommons/trunk/src/IglooCoder.Commons/WcfNhibernate/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-12T22:06:29.813

我发现了另一个很好的例子——

[http://realfiction.net/go/133](http://realfiction.net/go/133)

# javascript - 提高jQuery函数的效率

> ID：895992
> 
> 赞同：0
> 
> 时间：2009-05-22T00:59:17.243
> 
> 标签：javascript, jquery

此函数中的 while 语句在 IE/firefox 中运行速度太慢（阻止页面加载 4-5 秒），但在 safari 中运行速度太快...

它测量页面上文本的像素宽度并截断直到文本达到理想宽度：

```
function constrain(text, ideal_width){

    $('.temp_item').html(text);
    var item_width = $('span.temp_item').width();
    var ideal = parseInt(ideal_width);
    var smaller_text = text;
    var original = text.length;

    while (item_width > ideal) {
        smaller_text = smaller_text.substr(0, (smaller_text.length-1));
        $('.temp_item').html(smaller_text);
        item_width = $('span.temp_item').width();
    }

    var final_length = smaller_text.length;
    if (final_length != original) {
        return (smaller_text + '&hellip;');
    } else {
       return text;
    }
} 
```

有什么方法可以提高性能？我如何将其转换为冒泡排序函数？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T01:12:20.027

将调用移到循环外 $()，并将其结果存储在临时变量中。除了调用 .html() 之外，运行该函数将是代码中最慢的事情。

他们非常努力地使库中的选择器引擎快速运行，但与正常的 javascript 操作（例如在本地范围内查找变量）相比，它仍然很慢，因为它必须与 dom 交互。特别是如果您使用这样的类选择器，jquery 必须遍历文档中的每个元素，查看每个类属性并在其上运行正则表达式。每次循环！尽可能多地从你的紧密循环中取出这些东西。Webkit 运行速度很快，因为它有 .getElementsByClassName 而其他浏览器没有。（然而）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T01:28:05.050

[您可以使用二分搜索](http://cplus.about.com/od/glossar1/g/binary_chop.htm)，而不是一次删除一个字符，直到找到理想的宽度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T01:33:32.963

我看到问题在于您通过设置 temp_item 的 html 来不断修改循环中的 DOM，然后重新读取宽度。

我不知道您的问题的背景，但是从我的角度来看，尝试通过测量渲染元素来调整布局并不是一个好习惯。

也许你可以从不同的角度来解决这个问题。截断到固定宽度是常见的。

其他可能性（hack？）如果没有选择，可能是使用容器元素的溢出 css 属性并将 ... 放在文本旁边的其他元素中。尽管我建议您重新考虑以您打算的方式解决问题的必要性。

雨果

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T01:33:34.617

除了 Breton 的建议之外，加快算法速度的另一种可能性是对文本长度使用二进制搜索。目前，您一次将长度减少一个字符 - 这是字符串长度的 O(N)。相反，使用 O(log(N)) 的搜索。

粗略地说，是这样的：

```
function constrain(text, ideal_width){ 
```

...

```
 var temp_item = $('.temp_item');
    var span_temp_item = $('span.temp_item');

    var text_len_lower = 0;
    var text_len_higher = smaller_text.length;

    while (true) {
          if (item_width > ideal)
          {
            // make smaller to the mean of "lower" and this
            text_len_higher = smaller_text.length;
            smaller_text = text.substr(0, 
                ((smaller_text.length + text_len_lower)/2));
          }
          else
          {
            if (smaller_text.length>=text_len_higher) break;

            // make larger to the mean of "higher" and this
            text_len_lower = smaller_text.length;
            smaller_text = text.substr(0, 
                ((smaller_text.length + text_len_higher)/2));
          }
          temp_item.html(smaller_text);
          item_width = span_temp_item.width();
    } 
```

... }

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T05:15:06.530

需要注意的一点是，每次向 DOM 添加内容或更改节点中的 html 时，页面都必须重新绘制自身，这是一项昂贵的操作。将任何 HTML 更新移到循环之外可能有助于加快速度。

正如其他人所提到的，您可以将对 $() 的调用移到循环之外。您可以创建对元素的引用，然后只需在循环中调用其上的方法，如 1800 INFORMATION 所述。

如果您将 Firefox 与 Firebug 插件一起使用，则有一种很好的方法来分析代码以查看耗时最长的部分。只需单击第一个选项卡下的配置文件，执行您的操作，然后再次单击配置文件。它将显示一个表格，其中包含代码的每个部分所花费的时间。您可能会在列表中看到很多在您的 js 框架库中的东西；但是您也可以通过一些试验和错误来隔离它。

# multithreading - wxpython & 线程：如何模拟 wx.EVT_BUTTON 的触发器？

> ID：895993
> 
> 赞同：0
> 
> 时间：2009-05-22T01:01:14.573
> 
> 标签：multithreading, wxpython

如果我有一个“父”窗口（wxFrame）和一个插件窗口。

（父.py）

```
class App(wx.App):
            wxctrl = xrc.XRCCTRL( self.x_panel, "BUTTON")
            wx.EVT_BUTTON(wxctrl, wxctrl.GetId(),
                       self.OnButton) 
```

如何从 plugin.py 发送一个模拟单击“按钮”的事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T01:42:11.510

类[`wx.Control`](http://docs.wxwidgets.org/stable/wx_wxcontrol.html#wxcontrol)（的基类`wx.Button`）具有`Command`模拟命令事件的功能。试试这个

```
event = wx.CommandEvent(wx.EVT_COMMAND_BUTTON_CLICKED, self.wxctrl.GetId())
self.wxctrl.Command(event) 
```

我不确定 python 语法（通常在 C++ 版本的 wxWidgets 中编程）。但这是粗略的计划。

# .net - OracleConnection 在托管 C++ 中引发 EEMessageException

> ID：895994
> 
> 赞同：1
> 
> 时间：2009-05-22T01:01:34.650
> 
> 标签：.net, c++

我有一个本机 C++ 应用程序，它需要连接到 Oracle 数据库。Oracle 数据层是用 C# 编写的，所以我希望将代码重用为 DLL。

我决定尝试使用托管 C++ 来弥合原生 C++ 和 C# 之间的差距。托管 C++ 适配器层工作正常（几乎）；非托管 C++ 可执行文件可以毫无问题地调用 C# 代码中的各种类和方法。

## 错误：

**除了`System.Data.OracleClient.OracleConnection`**，这当然是一个非常重要的部分。

当我调用`Open()`它时，`EEMessageException`被抛出。我在 Windows XP 上使用 Oracle 9。

从 C# exe 调用时，我的 C# 数据对象 dll 工作正常。因此，我认为将程序集或 oracle 驱动程序加载到在 dll 中托管 CLR 的本机进程中存在某种问题。

这是在普通 C# 应用程序中正常工作的 C# dll。

> ………………<br> 'OracleTest.vshost.exe'（托管）：加载 'C:\WINDOWS\assembly\GAC_MSIL\System.Configuration\2.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll'，跳过加载符号. 模块已优化，调试器选项“仅我的代码”已启用。
> 'OracleTest.vshost.exe'（托管）：已加载 'C:\WINDOWS\assembly\GAC_32\System.Transactions\2.0.0.0__b77a5c561934e089\System.Transactions.dll'，跳过加载符号。模块已优化，调试器选项“仅我的代码”已启用。
> 'OracleTest.vshost.exe'（托管）：已加载 'C:\WINDOWS\assembly\GAC_32\System.EnterpriseServices\2.0.0.0__b03f5f7f11d50a3a\System.EnterpriseServices.dll'，跳过加载符号。模块已优化，调试器选项“仅我的代码”已启用。

在这里，它在通过托管 C++ 层调用的本机 C++ 应用程序中“爆炸”：

> 'QFeedTest.exe'：已加载 'C:\app\Oracle\bin\oci.dll'，二进制文件未使用调试信息构建。
> MyUnmanagedCPP.exe 中 0x7c812afb 处的第一次机会异常：Microsoft C++ 异常：内存位置 0x0012d014 处的 EEMessageException。

## 问题：

我可以做任何项目设置来让它正确加载 Oracle 驱动程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T01:17:51.933

您可以使用[Fusion 日志查看器](http://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx)(fuslogvw.exe) 记录 .Net 尝试加载程序集时发生的情况。另一件事是将您的应用程序作为托管代码而不是本机代码进行调试，然后您应该能够看到实际的托管异常并了解发生了什么。如果由于某种原因无法做到这一点，您可以使用 Windows 调试工具并加载 SOS 扩展 - 这使您可以更轻松地在 WinDBG 中调试 .Net 代码（您也可以在 Visual Studio 中使用 SOS）。**************`**