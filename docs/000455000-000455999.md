# StackOverflow 问答 000455000-000455999

# sql - 如何在 SQL Server 2005 中使用 LIMIT 关键字？

> ID：455008
> 
> 赞同：29
> 
> 时间：2009-01-18T11:44:28.737
> 
> 标签：sql, sql-server, sql-server-2005, limit

我在[这篇文章](https://stackoverflow.com/questions/19412/how-to-request-a-random-row-in-sql)中找到了一种从表中选择随机行的方法。建议使用以下查询：

```
SELECT * FROM employee ORDER BY RAND() LIMIT 1 
```

但是当我在 MS SQL 2005 中运行此查询时，我收到以下错误消息

```
Msg 102, Level 15, State 1, Line 1
Incorrect syntax near 'LIMIT'. 
```

谁能告诉我我错在哪里？MS SQL 不支持 LIMIT 吗？如果是这样，那我该怎么做？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-18T11:47:20.087

如果您查看 SQL Server 联机丛书中的 SELECT 语句，您会发现可以使用 TOP 关键字来限制结果集。

```
SELECT TOP 1 * FROM employee 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-18T13:09:09.063

```
SELECT TOP 1 * FROM Employee ORDER BY newid() 
```

您必须使用 newid() 每行对其进行一次评估。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-11T10:32:28.357

我正在使用这个相当简单的方法（SQL2005）来限制返回的行数，这也适用于存储过程参数提供的值。

```
DECLARE @Limit int
SET @Limit = 10
SELECT TOP (@Limit) Col1, Col2 FROM SomeTable 
```

# c# - Windows 窗体应用程序“设计”

> ID：455011
> 
> 赞同：1
> 
> 时间：2009-01-18T11:46:03.913
> 
> 标签：c#, .net, winforms

我正计划编写一个“中等大小”的 WinForms 应用程序，我将使用 C#、.NET 3.5 编写该应用程序。我有一些“通用设计问题”，我希望在这里得到解决。

1.  一般的异常处理。处理异常的最佳方法是什么？到处使用 try/catch 块？[这个](https://stackoverflow.com/questions/154597/is-there-a-way-to-define-an-action-for-unhandled-exceptions-in-a-winforms-net-3)？
2.  本土化。如果我想在我的应用程序中支持多种语言，我应该使用什么？我发现“卫星程序集”是一个非常......好吧，“笨重”的解决方案 - 我不想要资源文件“地狱”，我不想在 VS UI 中输入翻译。
3.  在本地存储数据。以前，我在一个项目中使用过[System.Data.SQLite](http://sqlite.phxsoftware.com/)，但我发现自己想知道是否还有其他需要考虑的东西。
4.  还有什么我应该记住的吗？

谢谢（？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T15:18:38.440

1）不要捕获任何异常。他们中的绝大多数会告诉您代码中的错误，您会想立即了解它们。如果在测试和部署期间，您发现您认为可以处理的错误情况（数量不多），您可以随时添加 try/catch 块。如果您计划处理异常，请确保在代码中随意添加 try/finally 块，以便保留类的状态，即使存在阻止清理代码运行的异常。使用 try without catch 没有显着的成本。

2) 卫星组件并不笨重。只是部署文件夹子目录中的一个小 DLL。不需要特殊代码，一切都是自动的。最重要的是，它是一个标准解决方案。您可以将 .resx 文件发送到本地化服务，他们将使用标准工具（如 Winres.exe）为您提供翻译。要求他们处理一些定制的事情会很昂贵并且可能很麻烦。

3) 替代方案是 SQL Server CE（与 SQLite 相同的方法）和 SQL Server Express。后者为您带来最大的收益，但必须安装。这并不难。

4）这取决于您的目标受众，但如果外观是购买决定的一个因素，请聘请 UI 设计师。他/她会抓住 UI 的花絮，让它看起来很漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T14:01:06.257

#1 - 如果您关心应用程序的性能，请避免尝试/捕获。使用一些分析器，例如来自 RedGate 的分析器（ANTS - 可悲的是它不是免费软件）来亲自查看 try/catch 块消耗大量 CPU 时间，尤其是在需要跳入“catch”时。只是尝试找到任何其他方法，.net 有很多其他方法可以用来确保不会发生异常，我知道使用 try/catch 更容易，但决定你的目标是什么。

#2 - 我猜你可以使用与你的应用程序一起编译的资源文件，这样你就不会有任何单独的文件，如果你问的是什么？

#3 - 我真的必须回答那个:)，我个人认为没有比使用 XML 更好/更舒适的本地存储数据的方式，正如之前提到的，你可以使用 LINQ to XML 来查询这个文件，这非常简单。它体积小、速度快、易于创建、维护，更重要的是，您可以通过 Internet 发送它，而不会出现使用其他存储数据方式（例如防火墙或任何 ISD）可能出现的任何问题，因为它基本上是一个文本文件。我只是喜欢xml。

那有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T11:56:40.367

关于第一个问题 - 看看[企业库](http://www.codeplex.com/entlib)异常处理块。微软在提供文档和代码来解决这个问题方面做得很好。

关于其他问题（尤其是#4），在不了解您的应用程序细节的情况下很难推荐一些东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T13:02:58.267

对于第一个问题，我的答案几乎与 aku 相同，您可能想看一下 Enterprise Library，因为有几个有用的块，例如 Logging 和 Validation 块。

无法帮助第二个，因为我没有参与任何需要支持任何类型本地化的项目。

如果没有更好地了解您正在开发哪种数据/应用程序，那么推荐本地数据存储有点困难。我有几个想法（没有特别的顺序）是：

1.  Xml 文件是可移植的，可以使用 LINQ->XML 进行操作。
2.  你的物体稳定吗？你总是可以序列化它们......（虽然我不推荐这个）
3.  虽然现在是本地的，但将来是否可以更好地在服务器上与其他用户共享数据（部分或全部）。
4.  您提到了 SQLite，您是否考虑过 SQL Server CE？
5.  你的数据层需要支持什么样的查询性能？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T15:31:34.263

1.  如前所述，异常处理块
2.  本地化不多，但是VS 2008的资源处理比VS 2003好很多
3.  [SQL Server Compact Edition](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)、 [VistaDB](http://www.vistadb.net/)和[Codegear Blackfish](http://www.codegear.com/products/blackfish)是您可能会研究的产品。SQL CE 是免费的，但其他的要花钱

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-03T02:19:15.170

为什么不下载 Visual C# 2005 或 2008 Express Edition？设计很容易

1.  打开 Visual C#
2.  打开创建
3.  打开创建项目对话框
4.  设计它
5.  编码
6.  发布它

[下载 2005 ->](http://microsoft.com/express/2005)

[下载 2008 ->](http://microsoft.com/express)

# programming-languages - 命名约定：寻找混合英语和领域/工作流程术语的替代方法

> ID：455013
> 
> 赞同：2
> 
> 时间：2009-01-18T11:47:22.770
> 
> 标签：programming-languages

尽管在我们公司，所有人都是非英语母语的人，但我们努力用英语编写文档、代码和评论，当然，除了与用户相关的内容之外，几乎所有内容。这是可以的，只要业务术语是可翻译的并且不是太特定于领域。但是一旦业务术语变得过于具体，要么没有适当的翻译，要么翻译听起来很愚蠢和毫无意义。这在编写代码时会导致糟糕的语言混合。

你对这个话题有什么经验？你是尽量避免在代码中使用愚蠢的名字，还是只是忍受它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T12:20:08.227

我认为，当所有开发人员和用户都使用一种共同的非英语母语时，试图将所有内容都保留为英语不仅没有用，而且实际上是有害的。领域术语只是最明显的例子。

IMO 所有领域术语都应使用母语，文档和评论也应如此。这使开发人员可以专注于代码的逻辑而不是翻译问题。在代码中混合使用两种语言可能看起来很愚蠢，即使在单一方法名称中也是如此，但 IMO 这并不是一个真正的问题，而且比在没有人真正从中受益的情况下努力让所有东西都用英语更好。

当然，这只适用于所描述的场景。如果你是一家大型国际公司的部门，或者计划在国际上拓展你的市场，或者你的母语没有很多人说，那就另当别论了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T11:59:47.177

我没有这方面的经验，因为我是一个以英语为母语的人。但是，当领域很复杂时，极限编程建议您使用程序员和客户都熟悉的隐喻。

这可以应用于您的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T12:51:45.777

我们公司也有同样的问题。我们尝试用英语编写代码和示例，但我们经常发现无法解决的情况，即我们母语中的直接常用名称没有直接或未知的翻译或等价物。所以从我的角度来看，几乎不可能避免混合语言（尽管我愿意，西班牙语实际上会成为未来的语言吗？）。

基本上这是两件事：

*   一般英语语言知识不足。
*   不是每个人都是完美主义者，会花一些时间在互联网上找出如何正确表达某事，所以首先想到的就是代码。

这些的效果是：

*   评论不能被以英语为母语的人理解（因为使用的词不存在或句子是源语言的直译）。
*   错误的翻译充满了虚假的朋友或虚构的词。一个典型的例子是使用“实际”一词来表示“当前”的意思，因为它是西班牙语中“实际”的意思。

对此的实际解决方案是尝试纠正此问题，即攻击问题的根源：

*   英语培训课程（包括应用技术英语）应该是公司必须的，这样每个工人都可以达到最低可接受的英语知识水平。
*   通过定义代码样式表来强制不那么完美的人遵循一些编码规则，或者甚至更好地拥有一个 QA 部门来强制执行代码质量、注释语法和可读性。

# c# - 扩展 GDI+ 中支持的图像格式列表

> ID：455018
> 
> 赞同：8
> 
> 时间：2009-01-18T11:48:55.170
> 
> 标签：c#, .net, gdi+

引用[System.Drawing.Imaging 命名空间的文档](http://msdn.microsoft.com/en-us/library/system.drawing.imaging(VS.80).aspx)

> Encoder 类使用户能够扩展 GDI+ 以支持任何图像格式。

然而，我找不到任何文档、示例或其他任何东西来解释我将如何实现我自己的自定义文件格式——大多数搜索返回大量关于传递 EncoderParameters 的信息，但没有关于实现我们自己的编码器的信息？

理想情况下，我希望能够在 C# 中实现这一点，但如果需要的话，我准备清理我的 ATL :)

有没有人遇到过任何文档或能够提供有关如何处理此问题的任何指示？

**更新：**
我可能应该提到到目前为止我尝试过的事情，但无济于事：

*   [查找ImageCodecInfo](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.imagecodecinfo(VS.80).aspx)类中返回的 GUID以查看它是否是普通的 COM 接口（但似乎不是），目的是查看实现的接口，或者查看它是否只是一个注册表项。
*   进入[Image.FromFile](http://msdn.microsoft.com/en-us/library/system.drawing.image.fromfile.aspx)方法发现它只是 gdiplus.dll 的包装器
*   很多谷歌搜索，似乎提供了很多使用现有的例子并指定你自己的 ImageEncoderParamerters；以及少数人通过其他方式实现[自己的](http://www.codeproject.com/KB/graphics/TargaImage.aspx) [编解码器的案例。](http://www.codeproject.com/KB/graphics/readandrenderpgmpbm.aspx)
*   甚至在[新闻中问过：//microsoft.public.win32.programmer.gdi](http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.win32.programmer.gdi&tid=a302c363-3891-4e2d-bbbf-c02b2de12fd2&cat=en_US_da48b8fe-0981-4869-b053-0c3a6b27a0a5&lang=en&cr=US&sloc=&p=1)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T00:36:11.373

好的，这是我设法挖掘的一些信息。似乎（Microsoft）推荐的方法是为您的格式[开发支持 WIC 的编解码器。](http://msdn.microsoft.com/en-us/library/ee719883(v=vs.85).aspx)Windows 映像组件 (WIC) API 内置于 Vista 中，但也可用于 XP 和 Win Server 2003，在 .NET 3 中或作为单独下载。

然而，似乎还存在另一种扩展 GDI+ 编解码器列表的方法，但这些水域更加模糊。如果您在十六进制编辑器中打开 gdiplus.dll，您将找到对以下注册表项的引用：

```
Software\Microsoft\Imaging\Codecs 
```

谷歌搜索该密钥会将您发送到[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa911052.aspx)，该文章讨论了在 Windows CE 和 Windows Mobile 平台上注册您自己的图像编解码器。有趣的是，XP 上的 gdiplus.dll 中硬编码了上述注册表项。不过，我还没有检查它是否使用它，也没有尝试为 WIC 或 GDI+ 开发自己的编解码器。

我希望这些信息至少可以帮助您入门。

# sql-server - 如何在 Sql Server Analysis Services 中使用渐变维度

> ID：455021
> 
> 赞同：1
> 
> 时间：2009-01-18T11:51:22.887
> 
> 标签：sql-server, ssas, olap

在数据仓库中，我希望有一个事实表来跟踪大学申请的某些指标（例如标准化考试的平均分数）以及一年中不同时间的申请状态。为简单起见，假设给定的应用程序通过 3 个状态进行：

1.  新的
2.  被评估
3.  已评估

这些状态会随着时间而改变。

我相信我想在这里使用一个缓慢变化的维度，但我不知道如何才能正常工作。

有人可以给我一个事实表和维度表的例子，它在两个应用程序通过这些状态时跟踪它们？

我正在使用 SQL Server 分析服务 2005。

目标是能够对每个州的申请数量进行逐年分析。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T22:38:35.977

这听起来像是一个经典示例，说明您将使用累积快照类型的事实表而不是缓慢变化的维度。当您希望能够通过管道分析应用程序的进度时，累积快照是对具有已定义生命周期的业务流程进行建模的标准方法。

谷歌“累积快照”事实表，你会发现很多关于它们用法的好文章，但这里有一篇你可能会觉得有帮助。 [http://blog.oaktonsoftware.com/2007/03/accumulating-snapshot-use-accumulating.html](http://blog.oaktonsoftware.com/2007/03/accumulating-snapshot-use-accumulating.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T22:29:50.267

我们在 SQLServerPedia 上有几篇关于慢慢改变维度的文章：

[http://sqlserverpedia.com/wiki/SSIS_-_Slowly_Changing_Dimension_Wizard](http://sqlserverpedia.com/wiki/SSIS_-_Slowly_Changing_Dimension_Wizard)

[http://sqlserverpedia.com/wiki/Data_Warehousing__-_Slowly_Changing_Dimensions](http://sqlserverpedia.com/wiki/Data_Warehousing_-_Slowly_Changing_Dimensions)

这些可能会帮助您加快速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T13:51:01.360

你的问题提到了标准化考试成绩和评估状态。当然，那将是你的两个维度，以及无所不在的时间。Ralph Kimball 有一个很好的时间维度的例子。如果您的考试分数维度是 SAT，它将有 2400-700 = 1700 行，因为您在签名时获得 700 分，并且三个部分的满分均为 800。正如您所描述的，您的评估维度可能是三行。

因此，每次分数或评估发生变化时，您的事实表中都会有一条记录，并带有时间维度的键来告诉您更改发生的时间。

# notepad++ - 在 Notepad++ 中将制表符转换为空格

> ID：455037
> 
> 赞同：1208
> 
> 时间：2009-01-18T12:10:16.063
> 
> 标签：notepad++, whitespace, indentation

如何在 Notepad++ 中将制表符转换为空格？

我发现[一个网页](http://www.texteditors.info/notepad-replacements-compared.php)表明它是可能的，但我找不到任何关于如何做到这一点的信息。

我希望能够做到这一点，因为某些 Web 表单不尊重其中包含选项卡的代码。

* * *

## 回答 #1

> 赞同：1212
> 
> 时间：2011-09-19T12:52:26.627

要将现有制表符转换为空格，请按`Edit->Blank Operations->TAB to Space`。

如果将来您想在按制表键时输入空格而不是制表符：

1.  转到`Settings->Preferences...->Language`（自 7.1 版起）或`Settings->Preferences...->Tab Settings`（以前的版本）
2.  查看`Replace by space`
3.  （*可选*`Tab size`）您可以通过更改字段来设置用于代替 Tab 的空格数。

[![按空格替换的截图](https://i.stack.imgur.com/cDrHP.png)](https://i.stack.imgur.com/cDrHP.png)

* * *

## 回答 #2

> 赞同：589
> 
> 时间：2009-01-18T20:37:54.300

*已过时：此答案仅适用于旧版本的 Notepad++。现在在 Notepad++ 中内置了制表符/空格之间的转换，并且 TextFX 插件在插件管理器对话框中不再可用。*

*   首先在 中设置***“用空格替换”***设置`Preferences -> Language Menu/Tab Settings`。
*   接下来，打开要替换选项卡的文档。
*   突出显示所有文本 ( `CTRL`+ `A`)。
*   然后选择`TextFX -> TextFX Edit -> Leading spaces to tabs or tabs to spaces`。

**注意：**确保已安装**TextFX Characters**插件（`Plugins -> Plugin manager -> Show plugin manager`,`Installed`选项卡）。否则，将没有 TextFX 菜单。

* * *

## 回答 #3

> 赞同：232
> 
> 时间：2009-01-18T12:14:36.023

设置`->`首选项`->`编辑组件（选项卡）`->`选项卡设置（组）`->`替换为空格

**在版本 5.6.8（及更高版本）中：**

设置`->`首选项...`->`语言菜单/选项卡设置`->`选项卡设置（组）`->`用空格替换

* * *

## 回答 #4

> 赞同：159
> 
> 时间：2009-01-18T12:15:35.257

您需要更换`\t` - 确保您使用扩展模式！

![代替](https://i.stack.imgur.com/cp9j1.gif)

* * *

## 回答 #5

> 赞同：87
> 
> 时间：2013-07-16T07:24:03.977

按照以下过程将空格转换为制表符，反之亦然：

![空格 - 制表符](https://i.stack.imgur.com/hPQn8.jpg)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-02-24T22:44:24.957

简单的方法：

1.  突出显示单个选项卡区域
2.  复制
3.  调出查找/替换
4.  粘贴到查找字段
5.  单击替换字段并按空格键
6.  然后全部更换。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-04-10T17:43:44.373

我没有阅读所有答案，但我没有找到我正在寻找的答案。

我使用[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)并且不想每次我想编译代码时都进行查找/替换或“空白操作”...

所以对我来说最好的解决方案是它**发生在飞行中**！

**这是我找到的简单解决方案**：

去：

1.  菜单设置 -> 首选项
2.  选择选项卡设置
3.  选择您的语言类型（例如 Python）
4.  选中复选框“使用默认值”
5.  选中复选框“按空格替换”

![在此处输入图像描述](https://i.stack.imgur.com/8srV8.png)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2011-03-09T05:05:05.850

在版本 5.8.7 中：

菜单*设置*->*首选项...* ->*语言菜单*/*选项卡设置*->*选项卡设置*（您可以选择将选项卡替换为空格的语言。这很酷！） -> 取消选中*Use default value*并选中*Replace by space*。

[![“首选项”对话框的屏幕截图](https://i.stack.imgur.com/msdhb.png)](https://i.stack.imgur.com/msdhb.png)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-11-12T17:05:30.000

首选项设置中没有“编辑组件”选项卡。您需要转到“语言菜单/选项卡设置”，那里有一个选项可以控制选项卡的行为。您甚至可以根据文件的语言将其设置为不同的工作方式。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-15T09:40:54.037

如果你碰巧在 Unix 环境中工作，[expand](http://linux.die.net/man/1/expand)命令就是你所需要的：

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-01-26T05:32:50.233

我遵循这个简单的方法：

*   双击（突出显示）*单个选项卡*（即：*\t*）。
*   按`ctrl + F`( `Find/repace`)。
*   您可能看不到*\t*或字段上的*单个选项卡区域*`Find What:`。但别担心。
*   输入一个输入`space`字段`Replace With:`。
*   单击`Replce All`。

**完毕！*:)***

看：

![在 <code>Notepad++</code> 中将 *Tab* 替换为 *Space*](https://i.stack.imgur.com/nTHxq.jpg)

**注意：** 此方法也适用于反转（用制表符替换空格*）**的*情况。

 ** * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-09-06T02:00:32.990

设置 > 首选项 > 选项卡设置 选中“用空格替换”。注意上面有选项卡大小： 4 单击四个，将打开一个窗口，其中包含将值更改为另一个整数的选项。

输入您想要的整数，然后按 ENTER 键。

你有它<3。

# asp.net - 有没有办法在 ASP.NET 中访问当前会话的集合？

> ID：455038
> 
> 赞同：6
> 
> 时间：2009-01-18T12:13:41.970
> 
> 标签：asp.net, session

有没有办法从应用程序全局访问 ASP.NET 中当前会话的集合？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T12:18:36.967

不，会话是沙盒的，它们彼此完全分开。您可以做的是在共享的 Application 对象中管理一个伪会话集合，并实现 Session_Start 方法来填充该集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T12:41:26.500

如果您将会话状态存储在 SQL Server 中，您将可以通过 SQL Server 访问所有会话。

还有应用程序状态 - 可用于跨应用程序访问信息，但这有很多警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T12:24:18.017

我不这么认为，但是您可以在 global.asax 中管理自己的列表

```
void Session_Start(object sender, EventArgs e) 
{
    //add current session to your own application shared collection
}

void Session_End(object sender, EventArgs e) 
{
    //remove session
} 
```

# unit-testing - 代码覆盖工具如何以不同的语言工作？

> ID：455046
> 
> 赞同：9
> 
> 时间：2009-01-18T12:24:05.363
> 
> 标签：unit-testing, language-agnostic, code-coverage

大多数成熟的语言都有可靠的测试覆盖工具可供它们使用，但功能的深度因人而异。

此外，所有不同的 VM 和编译器都具有如此异构的结构，例如，在 C 中编写代码覆盖工具肯定是与在 Lisp 中非常不同的工作。

*   Python 必须`sys.settrace`直接告诉你正在执行哪些行
*   [Clover](http://www.atlassian.com/software/clover/) (for Java) 使用它自己的编译器并添加调试元数据（我上次使用它，无论如何）
*   [Emma](http://emma.sourceforge.net/) (for Java) 有一个 ClassLoader 可以动态重写字节码
*   [COVER](http://www-2.cs.cmu.edu/afs/cs/project/ai-repository/ai/lang/lisp/code/testing/cover/0.html)（对于 Lisp）有一个注释传递来检测代码

我对不同语言的代码覆盖率的实现感兴趣：

1.  获得[C0](http://eigenclass.org/hiki.rb?rcov#l15)覆盖率的主要方法是什么，您可以在其中跟踪哪些代码行已被执行？我在上面提到了本机 VM 内省以及静态和动态代码检测 - 还有其他方法吗？

2.  与 C0 相比，获取更多开明的覆盖数据，如[C1 或 C2](http://eigenclass.org/hiki.rb?rcov#l15)，似乎是一项与语言无关的任务。对我来说是大[卡诺图](http://en.wikipedia.org/wiki/Karnaugh_map)操纵的味道；是否有关于如何实际执行的最佳实践？[模糊](http://en.wikipedia.org/wiki/Fuzzy_logic)性等更现代的逻辑技术是否起作用？

3.  测试覆盖率的一个被忽视的方面是将结果显示给程序员，这对 C1 和 C2 数据变得越来越困难。坦率地说，虽然他们完成了 C0 的工作，但我对大多数测试覆盖率接口并不满意。你见过哪些新颖直观的覆盖数据界面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T10:47:20.623

本质上，所有代码覆盖工具都会对代码进行检测，以检查代码的哪些部分被执行。

正如您提供的链接中所定义的那样，从编写仪器的人的角度来看，C0 和 C1 非常相似。唯一的区别是您放置代码的位置。我将进一步推测 C1 甚至比 C0 更容易，因为检测发生在抽象语法级别，其中行尾并不重要。

我说 C1 更容易的另一个原因是因为它处理句法实体而不是词法实体：你将如何检测：

```
if
c > 1 && c
< 10
then
blabla
end 
```

嗯，只是一个想法。

至于C2，我在实践中从未见过。原因是你可以得到指数级的爆炸：

```
if c1 then * else * end
if c2 then * else * end
...
if cn then * else * end 
```

对于 n 行代码，您需要 2^n 次测试。另外，你对循环做什么？通常，您将它们抽象为简单的 if 语句（即，对于您测试的每个循环，它的主体在一个测试中执行了 0 次，而在另一个测试中至少执行了一次）。

我相信对 PC 进行采样是一种特别糟糕的代码覆盖方式，因为您可能会因为执行速度太快而错过一些语句：D 模糊逻辑也是如此，它用于推理近似值；通常，您希望代码覆盖率具有确定性。

卡诺图用于最小化布尔函数，我没有看到与代码覆盖工具的任何有用链接。

此外，您的问题有时也不是很清楚：您想要实现更好的代码覆盖率的技术，还是只是您感兴趣的代码覆盖率工具的实现？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-14T04:06:01.437

一种几乎适用于所有语言的方法是使用程序转换系统插入检测。

在此处找到的技术论文： [http](http://www.semdesigns.com/Company/Publications/TestCoverage.pdf) ://www.semdesigns.com/Company/Publications/TestCoverage.pdf 解释了一般如何做到这一点。

我的公司 Semantic Designs 提供了大量的测试覆盖工具，这些工具提供了上面所谓的 C1 覆盖（例如，“分支覆盖”），所以是的，它*通常*是这样做的），用于不同的语言（C、C++、C#、Java、 COBOL，PHP，都在多种方言中）。请参阅 www.semdesigns.com/Products/TestCoverage/index.html

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-18T13:00:52.827

在 .NET 中，首选方法是使用[.NET Profiling API](http://www.blong.com/Conferences/DCon2003/Internals/Profiling.htm#ProfilingAPI)，它基本上在 CLR 本身中提供了一堆关节点。

# c# - 将 T 限制为字符串和 int？

> ID：455050
> 
> 赞同：25
> 
> 时间：2009-01-18T12:25:43.473
> 
> 标签：c#, class, generics, types

我已经为自己构建了一个这样定义的通用集合类。

```
public class StatisticItemHits<T>{...} 
```

此类只能与`int`and`string`值一起使用。然而这

```
public class StatisticItemHits<T> where T : string, int {...} 
```

不会编译。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-18T12:30:51.093

类型限制旨在与接口一起使用。您的示例表明您希望允许**从 int 和 string 继承的**类，这有点胡说八道。我建议您设计一个接口，其中包含您将在泛型类 StatisticItemHits 中使用的方法，并将该接口用作限制。但是我在这里并没有真正看到您的要求，也许您可​​以发布有关您的方案的更多详细信息？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-18T12:39:19.187

您可以创建`StatisticItemHits<T>`一个抽象类并创建两个子类：

`StatisticItemHitsInt : StatisticItemHits<int>{}`

`StatisticItemHitsString : StatisticItemHits<string>{}`

这样只能有 StatisticItemHits 的 int 和字符串表示形式

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-18T12:41:18.950

正如其他人所说，您不能以这种方式使用类型限制。您可以做的是从您的基本类型中进行专业化，如下所示：

```
public class StatisticItemHits <T> { }

public class StringStatisticItemHits : StatisticItemHits<string> { }

public class IntegerStatisticItemHits : StatisticItemHits<int> { } 
```

此外，由于您的基类是通用的，因此您将无法以多态方式使用它。如果您需要这样做，请让 StatisticItemHits 实现一个接口并使用它来引用实例。就像是：

```
public class StatisticItemHits <T> : IStaticticItemHits { }

public interface IStatisticItemHits { } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T12:32:24.083

您不能将其限制为 where 子句中的 string 和 int。您可以在构造函数中检查它，但这可能不是一个检查的好地方。我的方法是将类专门化并将类创建抽象为（半）工厂模式：

```
class MyRestrictedGeneric<T>
{
    protected MyRestrictedGeneric() { }

    // Create the right class depending on type T
    public static MyRestrictedGeneric<T> Create<T>()
    {
        if (typeof(T) == typeof(string))
            return new StringImpl() as MyRestrictedGeneric<T>;

        if (typeof(T) == typeof(int))
            return new IntImpl() as MyRestrictedGeneric<T>;

        throw new InvalidOperationException("Type not supported");
    }

    // The specialized implementation are protected away
    protected class StringImpl : MyRestrictedGeneric<string> { }
    protected class IntImpl : MyRestrictedGeneric<int> { }
} 
```

这样，您可以将类的使用限制为仅在类*内部*使用 string 和 int 。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-18T16:00:52.830

鉴于您在这里只有两种类型，我会在这里走一条 OO 路线，而这两种类型只有两个类。

泛型最好在可以应用它们的环境是泛型的情况下*使用*。在这种情况下，它们的用途要少得多。

您只能限制为结构或类类型，我认为需要有基于数字或运算符的限制（例如必须支持 +=）

int 和 string 真的很不一样，肯定比 int 和 double 更不同。泛型类支持字符串的不可变引用类型和 int 的值类型而不支持与它们中的任何一个更相似的其他类型是没有多大意义的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T12:30:36.537

用'where'不可能做到这一点。你不能做一个“或”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-01-14T18:13:14.133

只需使用：

```
where TSource : IEquatable<string> 
```

# python - 在python中使用有序字典作为对象字典

> ID：455059
> 
> 赞同：9
> 
> 时间：2009-01-18T12:33:03.443
> 
> 标签：python, ordereddictionary

我不知道为什么这不起作用：

我正在使用[PEP 372中的](http://www.python.org/dev/peps/pep-0372/)[odict](http://dev.pocoo.org/hg/sandbox/raw-file/tip/odict.py)类，但我想将其用作成员，即：`__dict__`

```
class Bag(object):
    def __init__(self):
        self.__dict__ = odict() 
```

但由于某种原因，我得到了奇怪的结果。这有效：

```
>>> b = Bag()
>>> b.apple = 1
>>> b.apple
1
>>> b.banana = 2
>>> b.banana
2 
```

但是尝试访问实际的字典不起作用：

```
>>> b.__dict__.items()
[]
>>> b.__dict__
odict.odict([]) 
```

它变得更奇怪了：

```
>>> b.__dict__['tomato'] = 3
>>> b.tomato
3
>>> b.__dict__
odict.odict([('tomato', 3)]) 
```

我觉得非常愚蠢。你能帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-18T12:59:34.590

我可以在[http://mail.python.org/pipermail/python-bugs-list/2006-April/033155.html](http://mail.python.org/pipermail/python-bugs-list/2006-April/033155.html)找到与您的问题最接近的答案。

基本上，如果`__dict__`不是实际的`dict()`，那么它会被忽略，并且属性查找会失败。

另一种方法是使用 odict 作为成员，并相应地覆盖 getitem 和 setitem 方法。

```
>>> class A(object) :
...     def __init__(self) :
...             self.__dict__['_odict'] = odict()
...     def __getattr__(self, value) :
...             return self.__dict__['_odict'][value]
...     def __setattr__(self, key, value) :
...             self.__dict__['_odict'][key] = value
... 
>>> a = A()
>>> a
<__main__.A object at 0xb7bce34c>
>>> a.x = 1
>>> a.x
1
>>> a.y = 2
>>> a.y
2
>>> a.odict
odict.odict([('x', 1), ('y', 2)]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T01:30:16.507

sykora 答案中的所有内容都是正确的。这是具有以下改进的更新解决方案：

1.  `a.__dict__`即使在直接访问的特殊情况下也有效
2.  支持`copy.copy()`
3.  支持`==`和`!=`运算符
4.  [`collections.OrderedDict`](http://docs.python.org/2/library/collections.html#collections.OrderedDict)从 Python 2.7 开始使用。

...

```
from collections import OrderedDict

class OrderedNamespace(object):
    def __init__(self):
        super(OrderedNamespace, self).__setattr__( '_odict', OrderedDict() )

    def __getattr__(self, key):
        odict = super(OrderedNamespace, self).__getattribute__('_odict')
        if key in odict:
            return odict[key]
        return super(OrderedNamespace, self).__getattribute__(key)

    def __setattr__(self, key, val):
        self._odict[key] = val

    @property
    def __dict__(self):
        return self._odict

    def __setstate__(self, state): # Support copy.copy
        super(OrderedNamespace, self).__setattr__( '_odict', OrderedDict() )
        self._odict.update( state )

    def __eq__(self, other):
        return self.__dict__ == other.__dict__

    def __ne__(self, other):
        return not self.__eq__(other) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-03T14:07:06.337

如果您正在寻找对 OrderedDict 具有属性访问权限的库，[orderedattrdict](https://pypi.python.org/pypi/orderedattrdict)包提供了此功能。

```
>>> from orderedattrdict import AttrDict
>>> conf = AttrDict()
>>> conf['z'] = 1
>>> assert conf.z == 1
>>> conf.y = 2
>>> assert conf['y'] == 2
>>> conf.x = 3
>>> assert conf.keys() == ['z', 'y', 'x'] 
```

披露：我创作了这个库。认为它可能会帮助未来的搜索者。

# linux - 如何检查linux中的两个文件夹是否相同

> ID：455061
> 
> 赞同：27
> 
> 时间：2009-01-18T12:36:32.797
> 
> 标签：linux, web

我已将网站从一台服务器移动到另一台服务器，并使用 SCP 复制了文件

我现在想检查所有文件是否都已复制好。

我如何比较这些网站？

计算文件夹的文件？

获取文件夹树的总文件大小？

还是有更好的方法来比较这些网站？

保罗

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-05-06T18:06:24.540

将 diff 与递归`-r`和快速`-q`选项一起使用。这是最好的也是迄今为止最快的方法。

```
diff -r -q /path/to/dir1 /path/to/dir2 
```

它不会告诉你有什么区别（删除 -q 选项以查看），但它会很快告诉你所有文件是否相同。

如果它没有显示输出，则所有文件都相同，否则它将列出不同的文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-18T12:57:31.180

如果您使用的是 scp，您可能已经使用了[rsync](http://samba.anu.edu.au/rsync/)。

rsync 不会传输已经是最新的文件，因此您可以使用它来验证副本是否是最新的，只需再次运行 rsync。

如果你在旧主机上做这样的事情：

```
scp -r from/my/dir newhost:/to/new/dir 
```

然后你可以做类似的事情

```
rsync -a --progress from/my/dir newhost:/to/new/dir 
```

'-a' 是 'archive' 的缩写，它执行递归复制并保留权限、所有权等。查看[手册页](http://samba.anu.edu.au/ftp/rsync/rsync.html)以获取更多信息，因为它可以做很多聪明的事情。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-18T12:43:42.453

```
cd website
find . -type f -print | sort | xargs sha1sum 
```

将生成文件的校验和列表。然后您可以`diff`查看是否有任何丢失/添加/不同的文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-18T12:45:17.163

也许你可以使用类似的东西：

```
find <original root dir> | xargs md5sum  > original
find <new root dir> | xargs md5sum  > new
diff original new 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T12:57:05.983

如果您使用 scp，您可能还可以通过 ssh 使用 rsync。

```
rsync -avH --delete-after 1.example.com:/path/to/your/dir 2.example.com:/path/to/your/ 
```

rsync 为你做校验和。

请务必使用 -n 选项执行试运行。检查手册页。

每次我可以使用它时，我都更喜欢 rsync 而不是 scp 甚至是本地 cp。

如果 rsync 不是一个选项，md5sum 可以生成 md5 摘要并且 md5sumc --check 将检查它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-14T10:05:07.880

补充西德尼的回复。过滤掉-type f 并产生哈希码不是很必要。作为对 zidarsk8 的回复，您不需要排序，因为 find 与 ls 一样，默认按字母顺序对文件名进行排序。它也适用于空目录。

总而言之，前 3 个最佳答案是：（PS Nice to do a dry run with rsync）

```
diff -r -q /path/to/dir1 /path/to/dir2

diff <(cd dir1 && find) <(cd dir2 && find)

rsync --dry-run -avh from/my/dir newhost:/to/new/dir 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T12:40:44.537

对所有文件进行校验和，例如使用[md5sum](http://linux.about.com/library/cmd/blcmdl1_md5sum.htm)。如果所有文件都相同并且没有文件丢失，则一切正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-18T12:42:33.923

尝试[递归地区分](http://unixhelp.ed.ac.uk/CGI/man-cgi?diff)你的目录。如果其中一个目录有不同之处，您会得到一个很好的总结。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T12:57:12.177

> 我已经将网站从一台服务器移动到另一台服务器我使用 SCP 复制了文件

你可以用 rsync 来做到这一点，如果你只是想镜像一些东西，那就太好了。

/约翰

更新：似乎@rjack 用 6 秒的 rsync 答案击败了我 :-)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-10T00:43:27.520

我会将此添加到 Douglas Leeder 或 Eineki，但遗憾的是，没有足够的声誉来发表评论。无论如何，他们的答案都很棒，除了它们不适用于带有空格的文件名。为了使这项工作，做

```
find [dir1] -type f -print0 | xargs -0 [preferred hash function] > [file1]

find [dir2] -type f -print0 | xargs -0 [preferred hash function] > [file2]

diff -y [file1] [file2] 
```

只是从实验中，我也喜欢在 diff 上使用 -W ### 论证并将其输出到文件中，更容易在终端中解析和理解。

# .net - 当我的 .net 程序集不再位于同一位置时，如何取消注册它？

> ID：455073
> 
> 赞同：5
> 
> 时间：2009-01-18T12:47:33.383
> 
> 标签：.net, interop, registration, regasm

我有一个为 com interop 注册的 dll，因此在 HKLM\Software\Classes\CLSID[my guid]\InprocServer32[my version no]\Codebase 下它具有注册 dll 的路径。但是，我重新排列了我的文件夹结构，使路径不再正确。有没有办法注销该dll而不将其放回原处，然后注销，然后再次删除文件？

如果我不再有那个 dll，或者只有一个版本号不同的 dll，该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T21:07:19.063

不同的版本号（通常）无关紧要。只要较新的 DLL 包含旧版本中出现的所有 GUID，它就会被正确地注销（使用带有 regasm、exe 的新 DLL）。当然，为 COM 互操作重新注册程序集将正确地重新定位必要的注册表项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T20:56:58.927

据我所知 - 您只需在新位置注册 DLL。
您可以使用 MS 工具[oleview.exe](http://www.microsoft.com/downloads/details.aspx?familyid=5233b70d-d9b2-4cb5-aeb6-45664be858b6&displaylang=en)来验证 COM 注册点是否指向正确的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-20T10:59:06.130

我们在注册新 dll 时遇到的问题是，它的版本比之前注册的版本低。你最终在注册表中得到了这个：

```
HKCR\MyLib.MyClass\CLSID:(Default)=<my guid>

and 

HKCR\CLSID\<my guid>:Assembly=<string containing version number> 

and 

HKCR\CLSID\<my guid>\InprocServer32\<version number>\ ... more details 
```

我认为运行时会尝试加载 中标识的程序集`HKCR\CLSID\<my guid>:Assembly`，因此您希望尽可能取消注册该程序集。

这不是关于如何取消注册的答案，但是如果您无法取消注册，我发现进入那里并删除您不再拥有的版本号的密钥很有用，并且可能`Assembly`手动更新值如果你敢。

# python - 对于 Python 程序员来说，什么是好的中/大型项目？

> ID：455075
> 
> 赞同：4
> 
> 时间：2009-01-18T12:51:35.933
> 
> 标签：python

就像标题问的那样。我已经学习 Python 有一段时间了，我会说我对它很满意。我正在寻找一个中型或大型项目来让我忙碌一段时间。非常感谢您的建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-18T14:10:00.683

找一个网络糟糕的当地慈善组织。解决他们的问题。帮助其他人。了解更多 Python。每个人都赢了。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-18T13:25:10.827

您可以发明一个游戏并使用[pygame](http://www.pygame.org/)对其进行编码。编写代码总是很有趣，并且在编写游戏代码时您仍然可以学到很多东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-18T13:45:46.630

你有兴趣做什么？你可以编写一大堆数据库程序，用于跟踪食谱、CD、联系人、自检等......

基本上制作代码以加载/保存到数据库并强制执行一些业务规则，然后通过 Web 服务将其公开。然后制作与 Web 服务对话的 Web 前端和应用程序图形前端（使用 TK/WxWidgets/Qt（4.5 将是 LGPL YAY））。

这应该让您练习创建/与 Web 服务交谈（越来越多的公司正在这样做）以及创建 GUI 的两种主要方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T14:08:02.153

您可以尝试复制一个让您印象深刻的应用程序，只是为了猜测它在幕后是如何工作的。

如果我必须这样做，我可能会尝试使用 Django 克隆以下 webapp：

*   [大本营](http://www.basecamphq.com/)
*   [d粘贴](http://dpaste.com/)
*   [红迪网](http://www.reddit.com/)
*   [Mint.com](http://www.mint.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T14:27:55.810

在stackoverflow，已经有人要求解决他们的问题：

eg：如果你对 GUI 编程感兴趣：[thumbnailctrl](https://stackoverflow.com/questions/215052/efficient-image-thumbnail-control-for-python#455191)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T02:03:58.463

任何尚未完成的事情......不需要另一个流行应用程序x的克隆

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-02T00:30:38.520

我喜欢做的是（用我的 ti 83）而不是手工做所有的数学，我喜欢用我的计算器编写问题，然后用新程序解决剩下的问题。这很有趣，你完成了你的作业，所以你可以在 python 中为一个有趣的项目做这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-18T13:14:05.903

考虑执行以下操作：

*   是多线程的，最好包括同步的需要
*   读取/写入数据到远程数据库（甚至本地数据库）
*   从 Web 服务读取并包括 xml 解析
*   输出 xml/html

您可以做许多示例项目，但是如果您完成了上述所有操作，那么它肯定会提供足够的曝光率。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T13:24:30.283

如果我有时间仅仅为了乐趣和体验而编写一些代码，我会亲自启动一个开源项目，用于人们需要但尚不存在的东西。

您可以在 Web 上搜索缺失的开源项目列表，或者您可以根据自己的经验（例如，我个人希望有一些方法可以将我的 iPhone 与 Thunderbird+lightning 同步：我听说 Google 有解决方案日历，但我想要一个没有外部服务器的解决方案）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-18T14:25:59.277

我认为你现在能做的最好的事情就是花时间学习一门新技术，最好包括一门新的编程语言。

# windows - 如何创建右键单击上下文 shell 快捷方式“使用 Emacs 编辑”？

> ID：455077
> 
> 赞同：24
> 
> 时间：2009-01-18T12:51:48.943
> 
> 标签：windows, emacs, windows-shell, windows-explorer

Notepad++ 会自动添加一个 shell 快捷方式，这样当您在 Windows 资源管理器中时，您可以右键单击文件并选择“使用 Notepad++ 编辑”。我怎样才能对 emacs 做同样的事情？我正在为 Windows 使用 GNU Emacs 22.3。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-18T14:48:38.483

这就是我所拥有的 - 类似于其他一些答案。在某处创建一个名为 emacs-conextmenu.reg（或任何你想要的.reg）的新文本文件，并将以下内容粘贴到：

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell]
[HKEY_CLASSES_ROOT\*\shell\openwemacs]
@="&Edit with Emacs"
[HKEY_CLASSES_ROOT\*\shell\openwemacs\command]
@="Absolute\\Path\\to\\your\\emacs\\bin\\emacsclientw.exe -n \"%1\""
[HKEY_CLASSES_ROOT\Directory\shell\openwemacs]
@="Edit &with Emacs"
[HKEY_CLASSES_ROOT\Directory\shell\openwemacs\command]
@="Absolute\\Path\\to\\your\\emacs\\bin\\emacsclientw.exe -n \"%1\"" 
```

将路径更改为您的 emacs 安装路径；记住要转义“\”（只要有 \，就将其更改为 \\）。

现在您需要做的就是在资源管理器中双击这个 *.reg 文件，您将拥有一个适用于任何文件和任何目录的 emacs 上下文菜单条目（如果您是一个狂热的粉丝！）。

请注意，要使其正常工作，必须启动 emacs 并且还必须启动 emacs-server (Mx server-start)。我建议使用 Windows 启动 emacs 并将 (server-start) 放入您的 .emacs 文件中。

作为奖励，当您在 Windows 资源管理器中按 ctrl-shift-enter 时，自动热键 ( [http://www.autohotkey.com/ ) 的以下代码段将启动在 emacs 中选择的文件。](http://www.autohotkey.com/)如果您在 emacs 中编辑大量文件但不一定要导航到 emacs 本身中的文件，这可能会更方便。

```
#IfWinActive ahk_class CabinetWClass 
^+Enter::
  GetText(tmpvar)
  If (tmpvar != "")
     Run, d:/path/to/your/emacs/bin/dir/emacsclientw.exe -n "%tmpvar%"
Return
Return 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-11T19:36:43.237

就像多语言的答案一样，但不需要启动服务器或任何混乱。

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell]
[HKEY_CLASSES_ROOT\*\shell\openwemacs]
@="&Edit with Emacs"
[HKEY_CLASSES_ROOT\*\shell\openwemacs\command]
@="C:\\Program Files (x86)\\Emacs\\bin\\emacsclientw.exe --alternate-editor=\"C:\\Program Files (x86)\\Emacs\\bin\\runemacs.exe\" -n \"%1\""
[HKEY_CLASSES_ROOT\Directory\shell\openwemacs]
@="Edit &with Emacs"
[HKEY_CLASSES_ROOT\Directory\shell\openwemacs\command]
@="C:\\Program Files (x86)\\Emacs\\bin\\emacsclientw.exe --alternate-editor=\"C:\\Program Files (x86)\\Emacs\\bin\\runemacs.exe\" -n \"%1\"" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-18T14:17:02.930

如果您不喜欢研究注册表，您可以从 Windows 资源管理器中执行此操作（任何编辑器的说明，而不仅仅是 Emacs）：

1.  打开 Windows 资源管理器并选择`Tools\Folder Options...`菜单项。

2.  单击`File Types`选项卡并选择要与编辑器关联的文件类型的扩展名。对于此示例，我将使用 TXT 扩展名。

3.  单击`Advanced`详细信息框中的按钮以显示`Edit File Type`对话框。

4.  您可以更改当前`open`操作，也可以指定一个新操作，例如`Open with MyEditor`.

    如果您选择编辑，请单击`Edit...`按钮并在`Application used to peform action`文本框中输入编辑器的完整路径，然后添加`"%1"`. 例如，`C:\SciTe\wscite\SciTE.exe "%1"`。

    如果要创建新动作，请单击`New...`按钮，为动作命名，并提供编辑器的完整路径，后跟`"%1"`.

5.  如果您想将某个操作设为该文件类型的默认操作，请选择该操作，然后单击该`Set Default`按钮。

6.  `OK`在所有对话框中。

另一种选择是在您的`Send To`文件夹中放置编辑器可执行文件的快捷方式，`%USERSPROFILE%\SendTo`. 我通常在这里创建一个名为“Editors”的新文件夹，并为我使用的各种编辑器放置快捷方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-19T14:50:20.540

稍加添加，也可以通过单击背景在 emacs 中打开当前目录。

```
<<<Code as posted by polyglot>>>

[HKEY_CLASSES_ROOT\Directory\Background\shell\openwemacs]
@="Open &with Emacs"
[HKEY_CLASSES_ROOT\Directory\Background\shell\openwemacs\command]
@="C:\\Program Files\\emacs-24.2\\bin\\runemacs.exe \"%V\"" 
```

这`%V`是当前目录。在这种情况下使用`%1`不起作用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-26T22:57:57.297

这是做同样事情的另一种方法。适用于 WinXP 和 Vista。

将此添加到您的注册表：

**用 emacs.reg 编辑**

```
Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOT\*\shell\Emacs]
@="Edit With &Emacs"
[HKEY_CLASSES_ROOT\*\shell\Emacs\command]
@="Wscript.exe C:\\emacs\\emacs-22.3\\bin\\launch-emacs-client.vbs \"%1\"" 
```

将此文件放在您的 emacs bin 目录中：

**启动-emacs-client.vbs**

```
Set objShell = WScript.CreateObject("WScript.Shell")
Set fso = CreateObject("Scripting.FileSystemObject")

If WScript.Arguments.Count = 1 Then

  strComputer = "."

  Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

  Set colItems = objWMIService.ExecQuery("Select * From Win32_Process")

  Dim isRunning
  isRunning = False

  For Each objItem in colItems
    If InStr(objItem.CommandLine, "emacs.exe") Then
      isRunning = True
    End If
  Next

  If isRunning Then
    objShell.Run(fso.GetParentFolderName(WScript.ScriptFullName) & "/emacsclientw.exe -n """ & WScript.Arguments(0) & """")
  Else
    objShell.Run(fso.GetParentFolderName(WScript.ScriptFullName) & "/runemacs.exe """ & WScript.Arguments(0) & """")
  End If

Else
  objShell.Run(fso.GetParentFolderName(WScript.ScriptFullName) & "/runemacs.exe")
End If 
```

注意：[W32 安装程序](http://ourcomments.org/Emacs/EmacsW32.html)在安装时运行类似的脚本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-18T13:39:03.647

[这个网站](http://www.mydigitallife.info/2007/05/07/add-notepad2-to-windows-vista-or-xp-right-click-context-menu/)解释了如何使用另一个应用程序来做到这一点。只需更改路径，您就应该准备就绪。

创建此键/值：

```
[HKEY_CLASSES_ROOT\*\shell\Edit with AppName\command]
@=”\”C:\\Program Files\\Notepad2\\Notepad2.exe\” \”%1\”" 
```

这是[另一个参考](http://www.howtogeek.com/howto/windows-vista/add-open-with-notepad-to-the-context-menu-for-all-files/)，它更容易理解。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-18T14:55:33.557

查看带有 Windows 集成的 Emacs 发行版：http: [//ourcomments.org/Emacs/EmacsW32.html](http://ourcomments.org/Emacs/EmacsW32.html)

它的安装程序会创建一个资源管理器菜单条目，它可以满足您的需求。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-05T13:37:37.750

我想在上面的 polyglot 的答案中添加 - 他提到的 AutoHotkey 快捷方式非常方便，但代码不完整：GetText() 函数是由 AutoHotkey 论坛上的某个人编写的（[http://www.autohotkey.com/forum /viewtopic.php?p=279576#279576](http://www.autohotkey.com/forum/viewtopic.php?p=279576#279576)），它是：

```
GetText(ByRef MyText = "")
{
   SavedClip := ClipboardAll
   Clipboard =
   Send ^c
   ClipWait 0.1
   If ERRORLEVEL
   {
      Clipboard := SavedClip
      MyText =
      ERRORLEVEL := 1
      Return
   }
   MyText := Clipboard
   Clipboard := SavedClip
   Return MyText
}

;to test: 
#k::
GetText(FileName)
msgbox clipboard=%FileName%
return 
```

请注意，可能需要修改 ClipWait 延迟：我必须将其设置为 2！

# multithreading - 什么样的应用程序需要多线程？

> ID：455084
> 
> 赞同：27
> 
> 时间：2009-01-18T12:57:29.900
> 
> 标签：multithreading

有哪些应用程序需要多线程或不需要多线程的**具体示例，但这样会好得多？**

如果以每个帖子一个应用程序的形式，最适用的将浮到顶部，答案将是最好的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-18T13:05:30.507

没有硬性和快速的答案，但大多数时候您不会看到工作流/计算是顺序的系统的任何优势。但是，如果可以将问题分解为可以并行运行的任务（或者问题本身是大规模并行的[就像一些数学或分析问题一样]），您会看到很大的改进。

如果您的目标硬件是单处理器/内核，那么您不太可能看到多线程解决方案的任何改进（因为无论如何一次只运行一个线程！）

编写多线程代码通常更难，因为您可能需要花费时间来创建线程管理逻辑。

一些例子

*   **图像处理**通常可以并行完成（例如，将图像分成 4 个并在 1/4 的时间内完成工作），但这取决于运行的算法是否有意义。
*   **动画的渲染**（来自 3DMax 等）是大规模并行的，因为每一帧都可以独立渲染——这意味着可以将 10 或 100 台计算机链接在一起以提供帮助。
*   **GUI**编程通常有助于在做一些缓慢的事情时拥有至少两个线程，例如处理大量文件 - 这允许界面在工作人员进行艰苦工作时保持响应（在 C# 中，BackgroundWorker 就是一个例子）

GUI 是一个有趣的领域，因为如果工作算法通过给它时间来保持主 GUI“活动”，则可以在没有多线程的情况下保持界面的“响应性”，在 Windows API 术语中（在 .NET 之前等），这可能是通过原始循环实现，无需线程：

```
MSG msg;
while(GetMessage(&msg, hwnd, 0, 0))
{
    TranslateMessage(&msg);
    DispatchMessage(&msg);

    // do some stuff here and then release, the loop will come back
    // almost immediately (unless the user has quit)
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-18T13:05:30.507

*服务器*通常是多线程的（Web 服务器、radius 服务器、电子邮件服务器、任何服务器）：您通常希望能够同时处理多个请求。如果您不想在开始处理新请求之前等待请求结束，那么您主要有两种选择：

1.  运行具有多个线程的进程
2.  运行多个进程

启动一个进程通常比启动一个线程（或在线程池中选择一个）更耗费资源，因此服务器通常是多线程的。此外，线程可以直接通信，因为它们共享相同的内存空间。

多线程的问题在于它们通常比多进程更难正确编码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-18T16:17:36.027

应用多线程实际上有三类原因：

*   **执行并发以提高计算性能**：如果您有一个可以分解为多个部分的问题，并且您还有多个可用的执行单元（处理器内核），那么将这些部分分派到单独的线程中是能够同时使用两个一次或多个核心。
*   **CPU 和 IO 操作的并发性**：这与第一个类似，但在这种情况下，目标是保持 CPU 忙碌并且 IO 操作（即：磁盘 I/O）并行移动，而不是在它们之间交替移动。
*   **程序设计和响应性**：许多类型的程序可以利用线程作为程序设计的好处，使程序对用户的响应更快。例如，程序可以通过 GUI 进行交互，也可以在后台执行某些操作。

具体例子：

*   **Microsoft Word**：在后台语法和拼写检查器工作时编辑文档以添加所有绿色和红色波浪线下划线。
*   **Microsoft Excel**：单元格编辑后自动后台重新计算
*   **Web 浏览器**：调度多个线程以在单个页面加载期间并行加载多个 HTML 引用中的每一个。加快页面加载并最大化 TCP/IP 数据吞吐量。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-18T13:49:53.610

这些天来，答案应该是**任何应用程序都可以**。

单线程的执行速度几乎在几年前就达到了顶峰——处理器通过增加内核而不是提高时钟速度而变得更快。有一些架构改进可以更好地利用可用的时钟周期，但实际上，未来正在利用线程。

有大量的研究正在寻找并行化我们传统上不会考虑并行化的活动的方法。甚至像在字符串中查找子字符串这样简单的事情也可以并行化。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-18T13:41:57.870

多线程基本上有两个原因：

1.  能够并行执行处理任务。这仅适用于您有多个核心/处理器的情况，否则在单核心/处理器计算机上，与没有线程的版本相比，您将减慢任务速度。

2.  I/O 无论是网络 I/O 还是文件 I/O。通常，如果您调用阻塞 I/O 调用，则进程必须等待调用完成。由于处理器/内存比磁盘驱动器快几个数量级（并且网络更慢），这意味着处理器将等待很长时间。计算机将处理其他事情，但您的应用程序不会取得任何进展。但是，如果您有多个线程，则计算机将安排您的应用程序并且其他线程可以执行。一种常见的用途是 GUI 应用程序。然后，当应用程序执行 I/O 时，GUI 线程可以不断刷新屏幕，而不会看起来应用程序被冻结或没有响应。即使在单个处理器上将 I/O 放在不同的线程中，也会倾向于加快应用程序的速度。

2 的单线程替代方案是使用异步调用，它们立即返回并且您继续控制您的程序。然后您必须查看 I/O 何时完成并管理使用它。使用同步调用使用线程来执行 I/O 通常更简单，因为它们往往更容易。

使用线程而不是单独的进程的原因是因为线程应该能够比多个进程更容易地共享数据。有时线程之间的切换比进程之间的切换成本更低。

另请注意，对于#1 Python 线程将不起作用，因为在 Python 中一次只能执行一条 python 指令（称为 GIL 或全局解释器锁）。我以此为例，但您需要检查您的语言。在python中，如果要进行并行计算，则需要进行单独的进程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-18T13:12:25.330

许多 GUI 框架都是多线程的。这使您可以拥有更具响应性的界面。例如，您可以在运行长时间计算时随时单击“取消”按钮。

请注意，还有其他解决方案（例如，程序可以每半秒暂停一次计算以检查您是否单击了“取消”按钮），但它们不提供相同级别的响应（GUI 可能在读取文件或进行计算时似乎冻结了几秒钟）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-18T16:13:16.863

到目前为止，所有答案都集中在多线程或多处理是充分利用现代硬件所必需的事实。

然而，还有一个事实是多线程可以使程序员的生活更轻松。在工作中，我编写软件来控制制造和测试设备，其中一台机器通常由多个并行工作的位置组成。对这种软件使用多线程是很自然的，因为并行线程很好地模拟了物理现实。线程大多不需要交换任何数据，因此很少需要同步线程，并且多线程难以实现的许多原因因此不适用。

**编辑：**

这并不是真正的性能改进，因为（也许 5 个，也许 10 个）线程大部分都在休眠。然而，当各种并行过程可以编码为彼此不知道的动作序列时，这对程序结构来说是一个巨大的改进。我对 16 位 Windows 时代的记忆非常不好，那时我会为每个机器位置创建一个状态机，确保不会花费超过几毫秒的时间，并不断将控制权传递给下一个状态机。当有需要按时服务的硬件事件，以及需要一段时间的计算（如 FFT）时，事情就会变得非常糟糕。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-18T13:34:23.173

不直接回答您的问题，我相信在不久的将来，几乎每个应用程序都需要多线程。**如今，CPU 性能的增长速度并没有那么快，但内核数量的增加**弥补了这一点。因此，如果我们希望我们的应用程序在性能方面保持最佳状态，我们需要找到方法来利用所有计算机的 CPU 并使它们保持忙碌，这是一项艰巨的工作。

这可以通过告诉您的程序要做什么而不是告诉他们确切的方式来完成。现在，这是我个人最近觉得非常有趣的一个话题。一些函数式语言，如 F#，能够很容易地并行化许多任务。好吧，不是那么容易，但仍然没有更多程序式环境所需的必要基础设施。

请将此作为补充信息来考虑，而不是试图回答您的问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-18T13:01:50.110

***需要***线程化的应用程序是您想要一次做不止一件事的应用程序。除此之外，没有应用程序需要是多线程的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-18T16:23:56.107

具有大量工作负载的应用程序，可以轻松地进行并行处理。不应低估申请并这样做的难度。当您操作的数据不依赖于其他数据时，这很容易，但是当存在依赖关系时很难安排跨线程工作。

我做过的一些例子是很好的多线程候选者..

*   运行场景（例如股票衍生品定价、统计）
*   批量更新数据文件（例如向 10,000 条记录添加值/条目）
*   其他数学过程

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-18T13:04:21.663

例如，当您想要使用多个内核和/或 CPU 时，您希望您的程序是多线程的，即使这些程序*不一定*同时做很多事情。

编辑：使用多个进程是一回事。使用哪种技术取决于平台以及您将如何在程序中进行通信等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-18T13:29:49.953

虽然轻浮，但游戏通常每年都变得越来越线程化。在工作中，我们的游戏使用了大约 10 个线程来处理物理、AI、动画、重新渲染、网络和 IO。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-18T13:55:20.057

只是想补充一点，如果您共享任何资源，则必须谨慎处理，因为这可能导致一些非常奇怪的行为，并且您的代码无法正常工作，甚至线程相互锁定。

互斥锁将帮助您，因为您可以对受保护的代码区域使用互斥锁，受保护代码区域的一个示例是读取或写入线程之间的共享内存。

只是我的 2 美分。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-02-16T15:57:18.357

多线程的主要目的是*分离时域*。因此，使用无处不在，您希望在它们自己明显独立的时域中发生几件事。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-11-03T19:26:31.617

这是一个完美的用例

如果您喜欢联属网络营销，多线程是必不可少的。通过多线程应用程序启动整个过程。

通过 FTP 下载商家文件，解压缩文件，枚举执行清理的每个文件，例如从 Unix 到 PC CRLF 的 EOL 终止符，然后通过批量插入将每个文件猛烈插入 SQL Server，然后当所有线程完成后，为环境实例创建全文搜索索引以明天活，你就完成了。全部自动在晚上 11:00 开始。

繁荣！快如闪电。哎呀，您还有很多时间，您甚至可以在本地为您下载的产品下载商家图片，将图片保存为 webp 并将产品网址设置为使用本地图片。

是的，我做到了。用 C# 写的。奇迹般有效。购买具有 256gb 内存和 nvme 等快速驱动器的 AMD Ryzen Threadripper 64 核，吃午饭回来看看这一切都完成了，或者只是呆在一边看所有核心都固定在 95%+，听 pc 的粉丝踢，热身当你完成工作时，房间和外面的邻居灯会从电源漏极闪烁。

未来也会将处理推向 GPU。

好吧，我在邻居灯闪烁的情况下稍微推了一下，但其他一切都是绝对正确的。:)

# linux - Linux 上的进程洪水

> ID：455092
> 
> 赞同：5
> 
> 时间：2009-01-18T13:03:12.243
> 
> 标签：linux, sysadmin

我在我的 Linux 桌面上尝试了这个实验：

```
int main()
{
  while(1)
    fork();
  return 0;
} 
```

我以普通用户（不是 root）的身份运行该程序，我惊讶地发现它关闭了我的系统，它变得无响应。我曾希望由于资源限制耗尽我的进程会被杀死，但显然情况并非如此。任何想法为什么？

谢谢，席德。

PS：这是我在家里试验的办公室Linux机器，我希望明天重启时一切都会好起来....

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T13:10:19.123

你重新发明了[叉形炸弹](http://en.wikipedia.org/wiki/Fork_bomb)。

我认为大多数 Linux 发行版默认情况下都没有设置每个用户的资源限制。您当然可以配置它们，但您可能没有。

重新启动后机器会很好 - 除非 CPU 使用率导致过热问题。

为了防止普通用户产生太多进程，您需要将配置添加到[/etc/security/limits.conf](http://linux.die.net/man/5/limits.conf)

`ulimit`如果您认为要运行的程序可能会启动过多进程或占用过多其他资源，则可以使用设置适用于当前会话的限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T13:11:58.887

您可以在[wikipedia](http://en.wikipedia.org/wiki/Fork_bomb#Prevention)上找到有关该内容的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T13:09:42.777

很可能，您的系统管理员没有设置用户限制。如果没有设置用户限制，那么他们就无法保护任何人。

# php - var 用于 PHP 中的类

> ID：455109
> 
> 赞同：-1
> 
> 时间：2009-01-18T13:13:21.240
> 
> 标签：php, mysql, session, login, var

我正在使用 PHP 类进行登录。登录进程检查用户的 MySQL 数据库定义如下：

```
 class flexibleAccess{

  var $dbName = 'mydatabase'; 
```

但是，当我为不同的人安装应用程序时，这个 $dbName 需要不断地更改。我决定制作一个配置文件来保存我的数据库信息，这样我就不得不在那里更改，因为这个登录类被“隐藏”在某个地方。问题是我想做这样的事情：

```
class flexibleAccess{

      var $dbName = $_SESSION['mydatabase']; 
```

我收到错误：“解析错误：第 43 行的*路径*/access.class.php 中的解析错误” 第 43 行是 $dbName 的行...为什么我不能使用它从会议 ？我应该如何使用它？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T16:02:47.710

您可能不应该将数据库配置放在会话中。我觉得有点冒险。

我将创建一个包含信息的配置文件，并将其包含在一个常量中：

dbconfig.php：

```
constant("DBNAME", 'mydatabase'); 
```

灵活访问.php：

```
require_once 'dbconfig.php';

class flexibleAccess {
  private $dbname;

  // set the default database name to the constant DBNAME
  // but allow override
  public function __construct ( $dbname = DBNAME )
  {
    $this->dbname = $dbname;
  }
} 
```

任何需要数据库访问的文件：

```
require_once 'flexibleaccess.php';

$db = new flexibleaccess(); 
```

当然，您不需要将其设置为常数。关键是您将配置放在与代码不同的文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T13:18:08.343

在[构造函数](http://uk.php.net/manual/en/language.oop5.decon.php)中执行（我假设这里是 php5 ......）

```
class flexibleAccess{

   private $dbName;

   function __construct() {
         $this->dbName = $_SESSION['mydatabase'];
   }
} 
```

对于 php4，将 __construct 替换为类的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T13:20:03.550

您必须在类的构造函数中分配这个变量，因为[PHP 4 只允许常量值作为初始化器](http://docs.php.net/manual/en/keyword.class.php)：

> 在 PHP 4 中，只允许 var 变量的常量初始化器。要使用非常量值初始化变量，您需要一个初始化函数，该函数在从类构造对象时自动调用。这样的函数称为构造函数（见下文）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T14:18:12.057

或者，您可以在调用类时指定类应从何处读取此信息，例如：

```
<?php
$login = new flexibleAccess();
$login->dbName = $_SESSION['mydatabase'];
?> 
```

这样你的类就保持干净，它可以接受来自你喜欢的任何来源或方法的数据库名称（以及任何其他可能不同的信息）。作为额外的奖励，您不必注意您使用的是哪个版本的 PHP，它在两个版本中都可以正常工作。

希望这可以帮助！

-戴夫

# c# - .NET 中的事后分析有哪些可能性（例如在程序崩溃后）？

> ID：455122
> 
> 赞同：5
> 
> 时间：2009-01-18T13:27:49.457
> 
> 标签：c#, .net, maintenance

假设有一个 C# 程序，它被用作 Windows 服务。让我们假设服务变得疯狂并且疯狂地消耗 CPU 和内存。它需要尽快重新启动，因为它是一个生产系统。所以我没有太多时间来收集运行时信息。也许快速浏览一下任务管理器......就是这样。

之后，我只有 log4net 日志文件和用于事后分析的 Windows 事件日志。

假设我找到了问题的原因。其他人修复了它，也许程序员添加了一些额外的日志记录，这样我下次可以更快地找到类似的问题。尽管如此：我仍然依赖于日志文件的质量，并希望下次出现问题时会以某种方式在日志中显示出来。

还有其他方法可以进行事后分析吗？也许像线程转储（如在 java 中）、内存转储或其他可能有助于事后分析的东西？也许一些内置的 .NET 框架工具可以提供帮助？

我对真实的项目经验以及您将如何尝试解决这个维护问题非常感兴趣，我认为这对大多数程序员来说都是非常真实的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T13:33:01.523

您可以使用 .NET 进行故障转储，并使用 windbg / sos（和 sosassist）查看它们。不简单，但它有效。但相当铁杆。搜索“+windbg +.NET”应该会很有趣。

除此之外 - 资源计数器？日志文件？您可能会看到很多可以相当容易地启用的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T13:59:16.400

正如 Marc 所说，WinDbg + SoS 将让您调试很多问题，您无法在 Visual Studio 中真正解决。[这个博客](http://blogs.msdn.com/tess/)有一些很棒的教程。

对于内存问题，您还可以查看 Perfmon 中的 .NET 性能计数器。您可以查看对象的位置（哪一代）以及垃圾收集花费了多少时间。这应该会给你一些有用的信息。如果您想知道为什么没有收集对象，WinDbg 和 SoS 是您的最佳选择。为了引导您完成一个简单的会话，步骤如下：

1.  使用 检查堆`!dumpheap -stat`，查找大量实例。您可能对在任何给定时刻会在堆上找到什么有所了解，所以如果有什么不寻常的地方，请调查一下。

2.  选择随机实例并对实例`!gcroot`的地址执行操作。这将告诉您为什么没有收集对象。

3.  重复

使东西保持比应有的时间更长的可能候选者是：事件、静态和终结器队列等等。

您可能还想查看我对[这个问题](https://stackoverflow.com/questions/372547/where-do-java-and-net-string-literals-reside#372559)的回答，以了解更多 WinDbg 内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T13:56:17.730

使用 WinDbg 和 SOS 进行事后分析的一个很好的资源是 Tess Ferrandez 关于该主题的[一系列博客文章](http://blogs.msdn.com/tess/pages/net-debugging-demos-information-and-setup-instructions.aspx)。

编辑：链接已更新

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T15:18:18.720

不幸的是，我不得不做很多这样的事情——我遇到的最好的工具是 sdk 附带的 cordbg（你需要正确的 .net 版本）。[http://msdn.microsoft.com/en-us/library/a6zb7c8d.aspx](http://msdn.microsoft.com/en-us/library/a6zb7c8d.aspx)了解详情。

附加到 cordbg (a <[pid]>) 中正在运行的进程，附加到每个正在运行的线程 (t <[tid]>)，然后转储每个线程 (w) 的堆栈。

使用一个小的 vb 脚本自动执行此任务，然后转储到文件中，您可以多次运行此工具，将输出捕获到文件中。比较所有线程堆栈可以让您很好地了解应用程序将时间花在哪里。

这种方法的好处是，尤其是自动转储，您可以非常快速地获取所有信息并在最短的时间内重新启动您的流程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T14:09:55.317

如果该过程仍然存在，那么您可以针对它运行[托管堆栈资源管理器](http://www.codeplex.com/Wiki/View.aspx?ProjectName=MSE)以快速了解它正在做什么。您可以在没有显式安装的情况下运行它。

除此之外，完整的转储 + windbg + SOS 可以为您提供最多的信息，但获得它并非易事。

# c++ - 如何在接收器对象上实现传出接口（C++）

> ID：455125
> 
> 赞同：0
> 
> 时间：2009-01-18T13:29:55.850
> 
> 标签：c++, com, event-handling

我有一个**预定义**的TLB 文件，其中包含 IS8SimulationEvents 包装器方法实现，例如：

```
inline HRESULT IS8SimulationEvents::S8SimulationReset ( ) {
    HRESULT _result = 0;
    _com_dispatch_method(this, 0x1, DISPATCH_METHOD, VT_ERROR, (void*)&_result, NULL);
    return _result;
} 
```

使用 Oleview，我可以看到附加到 COM 对象的**IConnectionPointContainer接口。**

**问题：**

*   如何在接收器对象上实现传出接口，以便客户端接收来自 COM**对象的事件通知**

**没有：**

*   ATL
*   MFC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T13:52:51.403

本文解释了如何在纯 C 中实现连接点源/汇[http://www.codeproject.com/KB/COM/com_in_c5.aspx](http://www.codeproject.com/KB/COM/com_in_c5.aspx)

如果您想了解底层的 COM，那么 Jeff Glatt 的整个系列文章“COM in plain C”可能是非常值得推荐的。

PD：Lambdasoft Comet 是一个实现 COM 包装器的框架，它不使用 ATL/MFC，它已经过时了，但如果你想要一些简单的东西，值得一看[https://bitbucket.org/sofusmortensen/comet/](https://bitbucket.org/sofusmortensen/comet/)或[http://www.lambdasoft.dk/comet/](http://www.lambdasoft.dk/comet/)。

# asp.net - ASP.NET Web 应用程序本地化的最佳实践

> ID：455132
> 
> 赞同：7
> 
> 时间：2009-01-18T13:37:46.553
> 
> 标签：asp.net, localization, web-applications

我正在开发一个需要本地化为英语和葡萄牙语（以后可能还有更多语言）的网络应用程序。我知道 .NET Framework 提供对 UI 本地化的全面支持，但是，我不太确定实现它的最佳方法是什么。

您认为 Web 应用程序本地化的最佳实践是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-18T14:04:25.030

也看看

[ASP.NET 2.0 中的全球化和本地化揭秘](http://www.codeproject.com/Kb/aspnet/localizationByVivekTakur.aspx)

很好的报道和解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T13:53:05.303

阅读MSDN 中的*[ASP.NET Globalization and Localization](http://msdn.microsoft.com/en-us/library/c6zyy3s9.aspx)*和*[ASP.NET Globalization and Localization](http://msdn.microsoft.com/en-us/magazine/cc163566.aspx)*。我发现遵循 Microsoft 在本地化方面的做法很容易并且可以完成工作。

# html - 你会给你妈妈哪个编辑器让她编辑自己的网站？

> ID：455140
> 
> 赞同：7
> 
> 时间：2009-01-18T13:40:54.767
> 
> 标签：html, web, editor, publishing

我的意思是字面意思。一位近亲想为她的企业创建自己的网站，并向我寻求帮助。我已经让她建立网站，处理域名注册等所有事宜，但我没有时间为她设计网站。所以，我想给她一个软件，她可以在其中编辑页面并自行发布。

我的功能愿望清单。该软件应

*   当然，要易于使用，因为她不是计算机专家
*   输入 ftp 连接后，即可发布网站
*   有一些预定义的主题，还有定义自定义主题的可能性
*   提供德语用户界面，因为她不懂英语

到目前为止，我看了 Nvu（太复杂）、zeta Producer（甚至在我开始编辑第一页之前就崩溃了）、CityDesk（非常有前途，但仍然太复杂，而且不是德语）。我对[Namu6](http://namu6.com)很满意，但不幸的是，它只有英文版。

我很乐意提出任何建议。

[编辑]

有些人要求一个平台：她只使用 Windows，所以 Mac 或 Linux 不是一个选项。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-18T14:26:36.673

我妈妈为此使用 vi

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-18T13:54:33.913

考虑为她设置一个 CMS 并让她在浏览器中编辑页面。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-18T13:50:30.007

我对 imachines.com 的 citydesk 很满意，但最近我开始倾向于建议一个博客工具并这样做（例如 wordpress、blogger 等）。网站很复杂，因为它们是“网络”。我不确定我妈妈能不能做到。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-18T13:49:54.110

Google 有一个网页服务，除了 Blogger，我想它叫 Pages。或者，如果她有 Mac，iLife 为普通的非技术用户提供了不错的工具集

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-18T13:53:33.617

你没有提到哪个平台。如果可以使用 Mac，请查看 iWeb，它是 iLife 套件的一部分。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-18T14:33:03.867

取决于她需要该站点的用途以及您能够为她设置的内容。[Google 网站](http://sites.google.com)是免费且易于设置/使用的，但它们非常丑陋。

设置免费的 Blogger 或 WordPress 帐户或运行托管的 WordPress 安装。

像 Joomla 这样的引擎在管理后端往往有点技术性，但从前端编辑器的角度来看也很容易编辑 - 他们的 WYSIWYG 编辑器允许您从前端编辑内容，我发现这很有用对于非技术类型。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-18T22:31:43.197

Wordpress 实际上是一个不错且功能强大的基本 CMS 系统，它恰好内置了一个博客引擎。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-18T14:01:53.727

非技术人员很有可能会与任何编辑器打交道。我的意思是，你希望她怎么做布局？你希望她如何编辑模板？您希望她如何将网站从她的本地计算机发布到托管该网站的服务器？

来吧伙计，我知道这些事情对我们来说似乎是常识，但实际上，我能想到的每个非技术人员都不知道从哪里开始，即使是我知道的姐姐如何使用 Photoshop 不会有关于运行网站的线索。（我不得不花很多时间辅导她，即使那样我也不确定她会明白）。

只需给她一个 CMS 或 wordpress 之类的博客应用程序（我假设您必须为她设置它）。

**编辑**

即使您确实找到了一个简单友好的编辑器，那么将她的更改部署到服务器呢？问题不仅在于编辑 HTML，还在于运行网站、管理网站内容。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-18T14:52:38.663

如果你母亲的生意是她赖以谋生的合法生意，她难道不想让专业人士来做吗？一个非专业的网站，就像她的网站一样，只会让她的生意看起来不专业。

如果这不是一个“真正的”业务，而更像是一个爱好业务，也许她会从 www.blogspot.com [或 Wordpress] 获得她需要的东西，它使用起来非常简单。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-18T14:56:14.367

我已经与非技术人员尝试过几次。对于那些可以处理桌面软件的人，我使用 RapidWeaver（仅限 OS X）。（我不会让非技术人员使用 Windows PC。）

但更多时候，我发现像 WordPress 这样的东西效果更好。他们可以轻松地在线编辑该站点，并且其有限的功能使他们不会感到困惑。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-18T14:16:47.317

如果她不是极客，也许一个简单的 cms 对她来说就足够了。编辑 html 和布局的东西可能非常痛苦，以及为普通用户管理服务器上的文件。我会选择 wordpress，它具有简单的管理 ui，并且由于它是 php，因此几乎可以在您找到的所有托管服务上运行。此外，使用基于小部件的侧边栏和页面布局使她能够使用 html 编辑器（其中，imo dreamweaver 是迄今为止最好的）几乎可以做任何事情 - 甚至更多！想想已经完成的插件可以通过一个简单的插件管理器获得！我想也有德语翻译。（我找到了一个匈牙利的，一定还有一个德国的）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-18T14:28:27.573

WordPress 可能是一个不错的选择，它有一些以德语和其他语言安装的选项。有关更多信息，请参阅[您的语言中的 WordPress 。](http://codex.wordpress.org/WordPress_in_Your_Language)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-18T22:18:32.880

像 GoDaddy's Website Tonight 这样的在线网站创建者呢？它为简单的网站提供模板和大量支持。有月费，但这是相当合理的，对于不想深入研究复杂性的人来说可能是一个很好的解决方案。

我不知道他们是否提供德语用户界面，但可能值得一试。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-18T22:59:08.667

你试过[http://goodbarry.com](http://goodbarry.com)吗？

这是一个专注于企业主的易于使用的 CMS。

正如 hasen j 所说：“问题不仅在于编辑 HTML，还在于运行网站，管理其上的内容。”</p>

但是我不确定是否有德语翻译。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-05T10:40:33.013

Movable Type is another option for a simple CMS.

My mother is using TextMate. I set her up with Subversion, so to publish her site she just commits and a hook on the Subversion server will update the site. The big benefit here is that when something goes wrong I have a record of every change she made which makes it much easier to sort out. There's some simple PHP (that was what was easily supported on her MacBook for testing and on the webhost she uses) to minimize the boilerplate stuff on each page.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-06T12:45:01.670

[CushyCMS](http://www.cushycms.com/) is the only thing I would let a totally non-tech person near. It's very easy to setup an manage, and there's very little chance she can actually break stuff.

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2009-01-18T22:25:30.120

Dot Net Nuke，只需复制、安装和她的方式......

# php - 自定义电子商务网站 - ASP.Net 还是 PHP？

> ID：455142
> 
> 赞同：0
> 
> 时间：2009-01-18T13:41:13.580
> 
> 标签：php, asp.net, ruby-on-rails, magento

我目前有一个用 ASP 从头开始​​编写的功能非常强大的定制在线订购网站。这是大约 4 年前建造的，效果非常好。

我需要为另一家公司建立一个类似的。我是否只需升级并获得在 ASP.Net 2.0 中开发的类似产品，还是需要对 PHP、Rails、Django、Magento 等其他选项做一些功课？

新站点将需要使用我知道 ASP.Net 可以处理的 Ajax（或类似的东西）和其他 Web 2.0 功能。

是否有其他简单的框架可用于创建定制的在线订购类型的应用程序？例如，我听说 Rails 和 Magento 很难定制等。

我会使用我认识的魔鬼吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-17T13:24:16.480

我认为这一切都围绕着您打算对该项目投入何种程度的关注和资源。

如果这是一个您将在未来几年内只专注于的项目，那么自己编程是最有意义的，但如果这只是您忙于的众多项目之一，那么我建议您尝试像 Magento 这样的项目.

我遇到了类似的情况并选择了 Magento，从那时起这个决定已经被批准了很多次。诚然，一开始有一个学习曲线，但你无法将社区开发项目的力量与你自己偶尔开发的项目进行比较。该软件一直在不断改进，包括对 iPhone 友好的购物界面和 ajax 交互，所有这些都是我没有时间了解的。

无论如何，这只是我的30c价值。

关于自己编码时使用哪种语言，我认为这纯粹是个人决定，我们的回答只能是主观的。

但是，既然，你问：我开始使用 ASP 进行 Web 编程，但在 7 年前尝试了 PHP，并且喜欢它的每一分钟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T13:44:37.117

如果您正在查看 AJAX，而不是普通的 ASP.NET，我会查看[ASP.NET MVC](http://www.asp.net/mvc/)；这是一个更简洁的模型（IMO 也更合乎逻辑） - 它与[jQuery的 ajax 配合](http://docs.jquery.com/Downloading_jQuery)**得非常**好，因为您可以更好地控制 html 和路径。

此外，jQuery 现在[在 VS20008](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)中具有智能感知功能，使其更具吸引力。

我无法对 PHP 发表评论——但 ASP.NET MVC 至少处于*大致*熟悉的领域。但请注意，ASP.NET（包括 MVC）不仅仅是直接升级到 ASP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T15:51:47.170

如果您当前的解决方案有效并且这个新项目不需要重大更改和/或任何您无法使用 ASP 做的事情，那么您应该考虑不要切换而是继续使用 ASP。关于 AJAX，你不应该对 ASP 有任何问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T01:00:50.730

ASP.NET MVC all the way.

Easier port, more professional, safer and better for large projects.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T15:33:21.717

我的工作分为 ASP.Net 和 PHP。我想说，一般来说，我更喜欢前者用于大型项目，而后者用于小型快速（就开发时间而言）事情。根据我的经验，PHP 相对于 ASP.Net 的优势在于更便宜的托管和更大的用户群（如果您将来无法使用，客户端更容易找到在应用程序上工作的人）。如果这些不是首要任务，我会说坚持使用.Net。正如 Marc 推荐的那样，一定要看看 ASP.Net MVC 和 jQuery。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-18T09:44:13.630

这是个有趣的问题。

比较编译语言和解释语言 - 除了 PHP 比 Asp.Net 更快之外，还有一个神话，但在某些时候，这看起来是真的。在这里找到详细的解释， [http://naspinski.net/post/AspNet-vs-php--speed-comparison.aspx](http://naspinski.net/post/AspNet-vs-php--speed-comparison.aspx)

此外，电子商务网站包含大量产品和数据库，因此应明智地选择asp.net和PHP这两个技术进行开发。

如果您想深入了解电子商务的 asp 或 php 选择，请查看这些页面， [http: //www.ydeveloper.com/asp-dot-net-ecommerce.html](http://www.ydeveloper.com/asp-dot-net-ecommerce.html)

# algorithm - 你将如何处理 Netflix 大奖？

> ID：455178
> 
> 赞同：3
> 
> 时间：2009-01-18T14:03:25.703
> 
> 标签：algorithm, language-agnostic

所以，我只是刺入野外。我真的不是一个数据挖掘者。我纯粹是出于兴趣才问的，因为我真的没有时间尝试参加这个比赛。

但只是为了它的乐趣，你会如何解决它？

它的工作原理是这样的：你会得到大量的电影 ID 和用户投票。现在某个用户给了几票，还有一部电影，他会给这部电影打几分？

*所述奖品的编辑网址是[http://www.netflixprize.com/](http://www.netflixprize.com/)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T15:10:33.480

好的，这是我的想法：

我的统计课少了一点。但是您可以使用混合模型进行线性回归，即使用虚拟组变量来找出每个用户的个人偏见。

所以，这将是我的第一步，拥有如下模型：

用户的电影评分 = 电影评分 + 用户偏差。

每个用户对所有电影都有相同的偏见。

现在，构建一个像这样的图：每部电影都是一个节点，并且对于每个用户，在该用户喜欢的所有电影对之间添加一条边，或者将其权重增加一个。

在图表上运行加权集群编辑以识别电影集群。调整上面“喜欢”的定义，以获得相当大的集群。

现在，我们改进模型：

用户的电影评分 = 电影评分 + 用户偏差 + 聚类偏差。

好吧，我会去预测。

*编辑：* 最好进行 5 聚类。一方面，只为 5 星投票添加边。在下一个中，获得 4 星和 5 星投票。等等。

现在模型是：

用户的电影评分 = 电影评分 + 一般偏差 + 5 星偏差 + 4-5 星偏差 + ... + 5-4-3-2-1 星偏差

回归和预测！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T15:50:16.177

显然我没有一个足够好的想法，否则我会努力而不是在这里发布它:)

例如，Wired 报道了在奖品中的[进展](http://www.wired.com/techbiz/media/magazine/16-03/mf_netflix)。大多数团队会在一段时间后分享他们的知识，所以他们都非常接近，但似乎（通常）最后 20% 将花费 80% 的努力。

我会尝试解决像[拿破仑炸药](http://www.imdb.com/title/tt0374900/)这样的电影不适合任何当前使用的图表的问题。无论您是否喜欢那部电影似乎与您对超人或沉默的羔羊等的感受没有任何关系......我认为足够大的“训练”集可以解决这个问题，但这样的集是不可行的所以相反，我会尝试专注于寻找一种方法来聚集这些古怪的电影，然后我会以不同的方式处理它们，这似乎是一种你喜欢或讨厌的电影，而不是你认为可以的电影，所以我不会使用非线性评级算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T23:06:09.693

您可以在此处阅读有关以 5 万美元获得进步奖的团队以及他们是如何做到的：http: [//www.netflixprize.com/assets/ProgressPrize2008_BellKor.pdf](http://www.netflixprize.com/assets/ProgressPrize2008_BellKor.pdf)

我不明白其中的大部分。在比赛之前，我会猜测遗传算法会是最好的方法，但看起来他们没有使用这个。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-18T19:47:09.457

所以，也许对于像我这样不完全熟悉线性回归的 3 位读者来说：他们要求将预测提高 10%。这很难。这很难，因为我认为仅仅通过其他用户给出的平均选择来估计用户的选择可能已经是一个很好的估计器了。我想说的是：没有太多的改进空间。

# java - 我可以从哪里开始学习规则引擎？

> ID：455182
> 
> 赞同：10
> 
> 时间：2009-01-18T14:07:36.820
> 
> 标签：java, rule-engine

我目前正在设计一个规则引擎可能有用的 Java 应用程序。我可以在哪里学习如何使用它们、它们如何工作、如何实现它们、查看示例等？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-18T14:11:19.153

Drools[文档](http://www.drools.org/learn/documentation.html)包含许多有用的通用信息。特别是第 2 章，它涵盖了规则引擎基础知识、知识表示等。它还包括一个不错的推荐阅读清单，用于快速了解规则引擎和专家系统。

[对于大多数规则引擎来说，对rete](http://en.wikipedia.org/wiki/Rete_algorithm)算法的基本了解通常对编写有效的规则很有用。我个人发现维基百科文章中引用的[Doorenbos](http://reports-archive.adm.cs.cmu.edu/anon/1995/CMU-CS-95-113.pdf)论文是最清晰的技术解释。

此外，[这里](http://java-source.net/open-source/rule-engines)是 Java 中的开源规则引擎列表。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-18T17:36:35.650

您可能想阅读 Martin Fowler 博客中的“[我应该使用规则引擎吗？](http://martinfowler.com/bliki/RulesEngine.html) ”。

我参与了一个项目，我们构建了自己的（非常简单的）规则引擎，目的是在事情变得太复杂时转向通用规则引擎。虽然从未达到这一点，但该系统已经使用简单的国产引擎运行了好几年了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-18T14:53:22.810

我发现[这个网站](http://ai-depot.com/Tutorial/RuleBased.html)很有帮助。您是在考虑构建自己的库还是使用 3rd 方库？

# clojure - Clojure cond 部分的评估

> ID：455184
> 
> 赞同：6
> 
> 时间：2009-01-18T14:08:09.563
> 
> 标签：clojure, functional-programming

尝试使用 Clojure 在“计算机程序的结构和解释”中做练习 1.16（fast-exp 的迭代版本）我想出了这个：

```
(defn fast-it-exp [base exp res]
  (cond (= exp 0) res
  (odd? exp) fast-it-exp base (- exp 1) (* base res)
  :else fast-it-exp base (/ exp 2) (* base base res))) 
```

尝试一下：

```
user=> (fast-it-exp 0 0 10)
10   ;yep
user=> (fast-it-exp 2 2 2)
1     ;no...
user=> (fast-it-exp 1 1 1)
#<user$fast_it_exp__59 user$fast_it_exp__59@138c63>    ;huh?! 
```

似乎 cond 表达式的“奇数”部分返回一个函数而不是评估。为什么？我试过在谓词后面的表达式周围加上括号，但这似乎是不正确的语法，这是我能想到的最好的。我正在使用 Clojure 的 rev 1146。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T14:20:16.280

试试这个：

```
 (defn fast-it-exp [base exp res]
  (cond (= exp 0) res
        (odd? exp) (fast-it-exp base (- exp 1) (* base res))
        :else (fast-it-exp base (/ exp 2) (* base base res)))) 
```

我手边没有 REPL，但看起来像你想要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T11:01:07.320

基本上，您写的内容可以重新格式化为：

```
(defn fast-it-exp [base exp res]
  (cond
    (= exp 0) res
    (odd? exp) fast-it-exp
    base (- exp 1)
    (* base res) :else
    fast-it-exp base
    (/ exp 2) (* base base res))) 
```

所以：

```
user=> (fast-it-exp 0 0 10) ; (= exp 0) => res
10   ;yep
user=> (fast-it-exp 2 2 2)  ; base => (- exp 1)
1     ;no...
user=> (fast-it-exp 1 1 1)  ; (odd? exp) => fast-it-exp
#<user$fast_it_exp__59 user$fast_it_exp__59@138c63>    ;huh?! 
```

# 64-bit - 软件开发问题的 32 位与 64 位机器

> ID：455201
> 
> 赞同：3
> 
> 时间：2009-01-18T14:19:22.350
> 
> 标签：64-bit, hardware, virtualization

我正在为新的软件开发机器定价，并查看戴尔 Precision 系列。

当我到达这个屏幕时：

[http://www.dell.com/content/topics/reftopic.aspx/pub/products/precn_kat?c=us&cs=555&l=en&s=biz&~section=T7400](http://www.dell.com/content/topics/reftopic.aspx/pub/products/precn_kat?c=us&cs=555&l=en&s=biz&~section=T7400)

第一个选择是：立即购买 Precision WorkStation T7400 32bit！
第二个选择是：立即购买 Precision WorkStation T7400 64bit！

那时我真的只是决定要安装哪个软件吗？或者实际上是否有不同的芯片组，具体取决于选择。

我不想通过选错来限制我的选择——我总是可以升级软件——但我不想更换硬件。

顺便说一句：这将适用于 Microsoft 堆栈、asp.net、vs 2008、sql server 等的 SD，我想在购买这台机器时开始使用虚拟化（可能来自 MS）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-18T14:28:52.550

这两个选项都为您提供相同的处理器选择，它们都支持 64 位。只是预装了 32 位还是 64 位版本的操作系统的问题。

我会选择 64 位选项，因为根据我的经验，您可以在 64 位平台上轻松运行 32 位和 64 位 VM，但仅限于 32 位平台上的 32 位 VM .

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-18T14:24:56.970

100% 64 位。RAM 很便宜，您最终会想要使用超过 4GB 的内存，尤其是在您要运行虚拟机的情况下。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-18T14:47:57.953

64 位，但不是 XP64（戴尔提供的降级版本）。驱动情况非常糟糕，[软件中存在一些不兼容问题](http://en.wikipedia.org/wiki/Windows_XP_Professional_x64_Edition#Known_issues)。如果您需要/想要坚持使用 XP，请选择 32 位，如果您想使用 Vista 或 Windows Server 2008，则 64 位就可以了。

唯一的区别是操作系统，所以您可以在安装 32 位或 64 位 Windows 之间自由切换，您可能只需要购买另一个许可证。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-18T14:41:04.537

一路64位。Vista64在这一点上已经成熟了，我还没有遇到任何问题。如果您可能拥有的任何较旧的外围设备都需要 32 位，请将 XP32 安装为 VM。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T14:28:37.057

据我所知，如今您无法真正购买 32 位 PC。我认为操作系统是 32 位和 64 位版本之间的唯一区别。

对于 .NET 开发，您是否使用 64 位操作系统并不重要。但是 64 位 SQL Server 可能运行得更快。

而且您还需要超过 4GB 的 RAM（特别是如果您运行虚拟机），所以我真的看不出有任何理由选择 32 位操作系统而不是 64 位操作系统。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T15:01:05.683

我会选择带有 64 位操作系统的 64 位。到目前为止我遇到的唯一问题是 32 位应用程序无法访问 64-dll -> 例如，TotalCommander 的上下文菜单不会显示 64 位应用程序（例如颠覆），这可能不方便开发。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T14:34:43.457

为异国情调或非常新的硬件获得 64 位驱动程序可能很困难，因此如果您担心这一点，您可能希望坚持使用 32 位操作系统。

# regex - 替换 CDATA 中的 HTML 标签

> ID：455203
> 
> 赞同：1
> 
> 时间：2009-01-18T14:20:40.100
> 
> 标签：regex, xslt

我想替换 CDATA 元素中的一些 HTML 标记，但我很难在 XSLT 中正确使用语法。我收到此错误消息：

```
net.sf.saxon.trans.XPathException: Error at character 9 in regular 
expression "<img(\s+(?![^<>]*alt=["\'])[^<...": expected ()) (line 51) 
```

我猜它不喜欢正则表达式的`<>`内部。有谁知道如何在 XSLT 中编写这个？

这是正则表达式：

```
<xsl:variable name="imgTagWithoutAltAttributePattern">
<xsl:text disable-output-escaping="yes">&lt;img(\s+(?![^&lt;&gt;]*alt=["\'])[^&lt;&gt;]+)/&gt;</xsl:text></xsl:variable> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T17:04:35.637

我不认为转义`<>`括号是问题的根源。

查看错误消息，错误在 char 9 处，其中应有右括号`")"`：

```
<img(\s+(?![^<>]*alt=["\'])[^<...
--------^ 
```

如您所见，`"&lt;&gt;"`结果很好。我怀疑正则表达式引擎不以其他方式理解正则表达式（也许负面的前瞻是问题？）。

我建议首先尝试一个更简单的正则表达式，在不同的测试中分解你原来的正则表达式以找出问题：

```
<img\s[^>]+/>                          // test without look-ahead
<img(?=\s)[^>]+/>                      // test with positive look-ahead
<img(?!\S)[^>]+/>                      // test with negative look-ahead
<img((?!\S))[^>]+/>                    // negative look-ahead in parentheses 
<img\s(?![^>]+alt=["'])[^>]+/>         // your intention, expressed differently 
```

这样你就可以慢慢找到错误的原因。

## 编辑

根据OP自己的说法，在正则表达式中使用look-ahead会导致错误，因此这个regex引擎显然不支持look-ahead。

仅匹配*不*包含属性的`<img>`标签并不是*绝对*需要的。我提出了一种不同的方法：*`alt`*

 **```
<img\s(a[^l]|al[^t]|alt\s*[^=]|[^a>])*> // 文字形式
<img\s(a[^l]|al[^t]|alt\s*[^=]|[^a>])*> // XML 编码的表单

```

这只小野兽的功劳归功于：[JF Sebastian](https://stackoverflow.com/questions/466053/regex-matching-by-exclusion-without-look-ahead-is-it-possible#466167)。这是解释：

```
<img\s ....... img 标签的开始
  ( ....... 备选方案的开始：要么
    a[^l] .......“a”，后面不跟“l”
    | ....... 或者
    al[^t] ....... "al"，后面不跟 "t"
    | ....... 或者
    alt\s*[^=] ....... "alt"，后面不跟等号
    | ....... 或者
    [^a>] .......既不是“a”也不是“>”
  )* ....... 替代方案结束，尽可能多地重复
> ....... 图像标签结束

```

*标准免责声明适用：Regex 不是处理 HTML 的最佳工具。使用风险自负。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T17:56:55.873

唔！只有第一次测试通过了。是的，问题似乎从括号开始。

明天会更深入地研究它。感谢到目前为止。

吨

# java - Eclipse 编辑器插件：在项目外打开文件时出现“错误”

> ID：455210
> 
> 赞同：8
> 
> 时间：2009-01-18T14:25:47.140
> 
> 标签：java, eclipse-plugin, eclipse-pde

我正在为 Eclipse 开发一个编辑器插件。它在 eclipse 项目中的文件上工作正常，但是当通过“文件 - > 打开文件”菜单打开外部文件时（它适用于文件，例如 Java 文件），我得到一个页面只显示一条水平蓝线和单词“错误”。eclipse的错误日志是空的，.metadata目录下的日志文件也是空的。

什么可能导致这种情况？当我没有告诉我在哪里查看的错误消息时，如何诊断错误？似乎没有办法从 eclipse 中获取更详细的日志记录。

**编辑：**

我发现问题的根源与 jamesh 提到的很接近，但不是 ClassCastException -因为返回 null `IDocument`，所以文本查看器根本没有实例可以显示。`StorageDocumentProvider.createDocument()`这样做的原因是它只知道如何为 的实例创建文档`org.eclipse.ui.IStorageEditorInput`，但在这种情况下，它会得到一个 的实例`org.eclipse.ui.ide.FileStoreEditorInput`，它没有实现该接口，而是实现`org.eclipse.ui.IURIEditorInput`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T13:12:09.033

我遇到了同样的问题，终于找到了适合我的解决方案。您必须提供 2 个不同的文档提供程序 - 首先为工作台内的文件扩展**FileDocumentProvider**，其次为工作空间外的其他资源扩展**TextFileDocumentProvider**。然后根据编辑器**doSetInput**方法中的输入注册正确的提供程序，如下所示：

```
private IDocumentProvider createDocumentProvider(IEditorInput input) {
    if(input instanceof IFileEditorInput){
        return new XMLTextDocumentProvider();
    } else if(input instanceof IStorageEditorInput){
        return new XMLFileDocumentProvider();
    } else {
        return new XMLTextDocumentProvider();
    }
}

@Override
protected final void doSetInput(IEditorInput input) throws CoreException {
    setDocumentProvider(createDocumentProvider(input));
    super.doSetInput(input);
} 
```

然后在您的新文档提供程序（扩展 TextFileDocumentProvider）中插入如下内容：

```
protected FileInfo createFileInfo(Object element) throws CoreException {
        FileInfo info = super.createFileInfo(element);
        if(info==null){
            info = createEmptyFileInfo();
        }
        IDocument document = info.fTextFileBuffer.getDocument();
        if (document != null) {

            /* register your partitioner and other things here 
                       same way as in your fisrt document provider */
        }
        return info;
    } 
```

这对我有用:) 最后我不得不提一下，我不是很聪明，我从 Amateras 项目中复制了这个解决方案（Eclipse 的开源 HTML 编辑器插件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T08:56:29.193

我现在离源代码有点远，虽然我怀疑问题是`ClassCastException`：

*   对于工作区文件，`IEditorInput`是`org.eclipse.ui.IFileEditorInput`.
*   对于本地非工作区文件，`IEditorInput`是`org.eclipse.ui.IStorageEditorInput`

不同之处在于您如何从`IEditorInput`. JDT 进行显式`instanceof`检查以进行切换。

如果你提供它，我认为`getAdapter(Class clazz)`不会返回 a 。`java.io.InputStream`

我不太明白他们为什么这样做，但感觉很难看。

**编辑：** 关于调试 Eclipse 应用程序的更一般的观点 - 尝试将所有日志组合到一个地方（即控制台）确实非常有用。

为此，请确保使用命令行选项`-console`和`-consoleLog`. 后者帮助节省了无数小时的时间。如果您还没有，请了解有关如何使用控制台的最基本知识（`ss`也是`start`我最常用的）。这将节省诊断某一类问题的更多时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T17:57:45.013

您是否尝试在工作区之外使用编辑器创建 JAVA 文件？

使用文件路径调用编辑器时，在文件路径的开头加上“file://”。例如：如果路径是C://temp//Sample.java，则修改为file://C ://temp//Sample.java。

# .net - WPF 设计器不会加载实体框架

> ID：455214
> 
> 赞同：1
> 
> 时间：2009-01-18T14:27:54.390
> 
> 标签：.net, wpf, visual-studio-2008, entity-framework

当我使用实体框架时，让 WPF 设计器在 VS 2008 中工作时遇到了真正的问题。我有一个从实体模型获取数据的用户控件。用户控件设计器加载正常，但主窗口抛出以下错误“无法创建类型为 'CampaignList”的实例。当我编译项目时没有问题。

我已经开始使用一种解决方法，我检测它何时处于设计模式并且在设计模式下不创建“实体”对象。然而，这似乎有点丑陋。有没有更好的方法来做到这一点，还是我们只需要等待 VS 更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T15:31:39.380

这正是你需要做的。它可能看起来像一个丑陋的 hack，甚至可能是一个丑陋的 hack，但这正是框架处理设计时渲染的方式。几乎每个标准框架控件（表单、wpf 和 web）都确定它是在运行时还是在设计时显示，并且行为不同。[这就是基于组件的设计](http://msdn.microsoft.com/en-us/library/0ffkdtkf.aspx)背后的主要思想。您的类存在于两种不同的环境中——运行时环境和设计时环境，它们应该在这两种环境中都提供丰富且方便的用户体验。做到这一点的唯一方法是让控件作者编写控件来执行此操作。

最理想的情况是，您希望在堆栈中尽可能高地处理这种情况。最确定的是，您需要确定您的用户控件是否处于设计时间，并用虚拟数据源替换实体框架。您将显示在某些数据绑定表单和 wpf 控件中看到的那种假数据。

这就是它的完成方式。VS 永远不会被“更新”，因为它的工作原理……以及，设计的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T21:53:08.033

您是否尝试在用户控件的构造函数中加载数据？如果是这样，是的，您需要检查“设计模式”。如果您将负载放入其他一些方法中（例如您在代码中的其他地方调用的专用“Load”方法），设计器会更加友好。

或者，如果您使用带参数的构造函数，您可以为用户控件创建一个默认构造函数（无参数），通过不调用其中的加载方法，它对您的设计者更加友好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:06:39.240

问题可能是类（或基类）被定义为抽象的。这会导致设计者失败。这个问题在 Laurent Bugnion 博客的评论部分有更详细的描述：http: [//geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx](http://geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx)

# windows - 向 Windows 服务发送密码

> ID：455220
> 
> 赞同：1
> 
> 时间：2009-01-18T14:29:37.883
> 
> 标签：windows, service, passwords, ipc, startup

向 Windows 服务发送密码的最佳方式是什么？我们的应用程序需要密码才能启动。我不在乎服务“通常”应该在没有用户交互的情况下运行。操作员可以启动应用程序然后注销，这对我们来说已经足够了。

在 unix 系统上，我只会通过标准输入回显密码，但服务没有标准输入。

目前，我们使用 DPAPI 仅使用 CryptProtectData 存储密码。虽然这可行，但它提出了其他开始变得麻烦的问题。

我猜我需要在服务和发送密码的应用程序之间使用某种形式的 IPC，但我不确定哪种方法合适（如果有的话）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T16:53:07.047

两个主要选项：

您可以在启动时侦听套接字并等待提供所需的密码（可能在其中嵌入一个 SSH 服务器，这样密码就无法通过网络窥探）

我的首选选项是从配置文件（可以保护到最低读者群）或注册表设置（同样，足够安全，只有您的服务和管理员可以读取/更改它）中读取密码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T23:48:46.023

You can use [kerberos mutual authentication](http://msdn.microsoft.com/en-us/library/ms677600(VS.85).aspx). There are few options and examples there.

But just wondering. On a compromised machine, There may be a key logger. So typing the password is never secure if you want to maintain security in this environment. The same problem exist afaik for unix terminals.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T17:06:52.417

感谢您回复罗兰。

> 您可以在启动时侦听套接字并等待提供所需的密码（可能在其中嵌入一个 SSH 服务器，这样密码就无法通过网络窥探）

我考虑过，但如果没有证书验证，那不会让我们对中间攻击的人开放吗？

> 我的首选选项是从配置文件（可以保护到最低读者群）或注册表设置（同样，足够安全，只有您的服务和管理员可以读取/更改它）中读取密码

我们正在尝试尽可能地遵循“深度防御”，这样如果攻击者破坏了机器，他将无法访问我们的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T06:56:49.340

UserMode 中的 DPAPI 确实是最好的选择，并将加密数据存储在受保护的位置，例如具有有限 ACL 的注册表项。
究竟是什么问题开始变得麻烦？也许我们可以解决那些...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T13:38:56.970

> 究竟是什么问题开始变得麻烦？也许我们可以解决那些...

目前，应用程序作为本地系统帐户运行。

我们的应用程序将许多凭据存储在加密文件中，并使用 DPAPI（在 UserMode 中）进行加密。

因此，安装应用程序时，安装程​​序将作为本地系统帐户运行。我们还有一组随应用程序提供的工具，其中一些需要访问此加密文件，因此它们也需要作为本地系统帐户运行。

在安装和启动应用程序时，我们严重依赖该帐户。

我们遇到了问题，因为我们的一位用户想要使用该应用程序访问共享网络驱动器。本地系统帐户没有这样的权限，我们不能简单地以不同的用户身份运行我们的服务，因为我们的加密信息受到本地系统帐户的保护。

我们试图避免仅为我们的应用程序设置用户帐户的过程，因为它安装在许多不同的客户和环境中，所有这些客户和环境都有截然不同的安全策略。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T05:47:31.050

您可以从系统帐户下运行的服务访问远程驱动器。但是，您需要有凭据和共享信息才能连接到远程计算机。您可以使用 API wnetaddconnection 来获得访问权限。可能您的加密文件也可以存储此凭据。

# open-source - 未经雇主许可发布开源

> ID：455221
> 
> 赞同：18
> 
> 时间：2009-01-18T14:31:20.470
> 
> 标签：open-source

我正在开发一个项目，并看到了提取和抽象项目一部分的一些功能并将其作为开源发布的机会。

我很难接受这个功能应该保持专有的想法，并相信开源社区会从中受益匪浅。

如果不咨询我的雇主，这会是不道德的吗？

另外，我的老板有点控制欲，喜欢定期谷歌，所以我怀疑他迟早会发现我的开源版本。

由于他严格反对将任何功能作为开源发布并且会因此而解雇我，我还有其他途径可以用来发布此代码吗？

其他人是如何解决这个困境的？

我正在考虑重写代码，使其与我雇主的代码在功能上无法区分 - 这会有所帮助还是我会因为这种想法而入狱（这段代码需要发布！ - 这让我发疯了！）？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-18T15:51:30.743

看来您已经回答了自己的问题，因为您知道您的老板会反对。但是，如果这还不足以让您重新考虑发布您在受雇于关心这一点的雇主时编写的代码，那么请考虑 Perl 开发人员“Tilly”的真实示例[——Slashdot：当心雇佣合同](http://developers.slashdot.org/article.pl?sid=02/03/21/0139244)。

Tilly 编写了用于 Perl 的重要代码。Perl 社区开始依赖他的工作，以至于他的雇主威胁要起诉他发布在他签订合同期间开发的代码，这震惊了 Perl 开发社区。最终，雇主决定不为已经发布的代码寻求其权利，但事情可能很快就出错了。

帮自己、你的雇主和你的代码的潜在用户一个忙：不要发布你不拥有的东西。如果您想争取在受雇期间发布代码的权利，请在获得依赖您代码的毫无戒心的用户群之前赢得该权利。

您可能想阅读 Tilly 对[Professional Employees 和 Works for Hire](http://www.perlmonks.org/index.pl?lastnode_id=26179&node_id=153046)主题的看法。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-01-18T14:36:51.910

即使您重写了代码，我也看不出您在未经雇主同意的情况下将您的雇主的代码作为开源发布有任何法律或道德依据。如果你这样做并且你的雇主发现了，最好的情况是你被解雇了。最坏的情况是你被起诉。如果我是你的雇主，我会选择后者。

顺便说一句，既然你说你的雇主经常用谷歌搜索员工，那么以你自己的名义在这里发布这个问题可能不是一个好主意。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-18T15:01:55.040

某事是否**合乎道德**取决于您对什么是对或错的想法。在这种情况下，您和您的老板可能有不同的想法，因此我不确定这个问题是否有意义。

你真正想知道的是它是否**合法**。这取决于您当地的法律和雇佣合同的条款。至少在比利时，除非您的合同条款另有明确规定，否则公司将对您为公司所做的所有工作拥有版权。我相信这通常也是其他地方的规则。例如，美国版权法将此定义为“[为雇佣而制作的作品](http://www.copyright.gov/title17/92chap2.html)”：

> (b) 为雇佣而制作的作品。— 对于为雇佣而制作的作品，就本篇而言，雇主或为其准备作品的其他人被视为作者，并且除非双方在其签署的书面文件中另有明确约定，否则拥有版权中包含的所有权利。

因此**，不，您不能只是接受这项工作并在其上贴上免费软件许可证**。

但是，版权仅涵盖实现，而不包括想法。再次[来自美国版权法](http://www.copyright.gov/title17/92chap1.html#102)：

> 在任何情况下，对原创作品的版权保护都不会扩展到任何想法、程序、过程、系统、操作方法、概念、原则或发现，无论其描述、解释、说明或体现的形式如何在这样的工作中。

这就是专利和版权的区别。因此**，如果这些想法没有专利，您可以自由地创建一个新的实现。**

**编辑**：正如一些评论者所说，您的雇佣合同可能包括竞业禁止或保密条款，这些条款甚至可能适用于重新实施。

**编辑**2 ：如果违反了[保密条款](http://www.ndasforfree.com/NDAS/GetEmployee.html)，则可能适用[商业秘密法。](http://www.law.cornell.edu/uscode/18/usc_sec_18_00001832----000-.html)正如您在该法律（或 Tim Howland 的[回答](https://stackoverflow.com/questions/455221/releasing-open-source-without-the-permission-of-your-employer/455281#455281)）中所读到的那样，对“盗窃商业机密”的处罚可能相当严厉。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-18T15:16:35.213

这是非法和不道德的，如果你甚至自己编写它而不“重写”原始代码，你就违反了你的雇佣合同。

顺便说一句，开始找工作。我是你的老板。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-18T15:09:04.603

你不仅在欺骗付钱给你创建代码的雇主，你也在欺骗任何善意地采用你的代码作为他们项目的一部分的人。如果您将代码传递给您没有合法使用权的其他人，那么当您发现您的盗窃（而且是盗窃）时，您将迫使他们撕掉您的代码并从头开始重新实现它。

**编辑：**下面的几位评论者似乎很困惑，认为这是版权法的问题，并且不要将借用雇主源代码归类为盗窃，因为雇主仍然拥有他们的原始财产。然而，雇主失去了一些对他们的业务可能非常有价值的东西——对他们的代码的独家访问，为他们提供了竞争优势。这与版权没有任何关系（尽管如果您使用自己的版权发布您雇主的代码，正如大多数开源许可证所要求的那样，您显然是在进行欺诈） - 问题是这是对商业机密的盗窃。如果代码是雇主业务不可或缺的一部分，那么它可以被视为商业秘密。商业秘密不必在政府登记，因此，如果您的雇主足够生气，您可能会上法庭。如果你有一个好的律师，你会立即和解以避免被起诉。

故意泄露商业机密（也称为商业机密盗窃）是联邦和州的犯罪行为，最高可判处 10 年监禁和 500,000 罚款。换句话说，你不仅仅是在欺骗你的雇主，在欺骗任何善意采用你的代码的项目，而且你也在为自己的重大法律危险做准备。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-18T14:59:41.533

那是知识产权盗窃，除非你住在中国，否则这是非法的。

我钦佩您对开源社区的考虑。不幸的是，您受到法律的约束——该代码实际上是您雇主的财产，因此释放它相当于将他们的办公家具带到楼下交给陌生人。

甚至代码背后的概念也可能属于他们，所以如果你重新编写它并不重要。

这个论坛上没有人会推荐非法或不道德的活动，所以如果你确实试图规避这一点 - 我相信有办法 - 你会靠自己，除非你决定咨询当地的犯罪社区以获取提示。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-18T14:34:37.793

我不是律师。最好咨询一位。

但这对我来说确实不道德。

我不知道你的雇佣协议，但如果你是在你公司的时间写的并且得到了报酬，我会说软件属于他们。如果你有一个竞业禁止条款，即使是重写对你来说也是冒险的。

最好咨询律师。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-18T14:35:04.423

是的，未经雇主许可将您的代码作为开源发布是不道德的。不幸的是，您无能为力。我不建议您制作您正在处理的专有代码的开源版本。诉讼的空间太大了。

**免责声明**：我不是律师。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-14T16:37:55.883

这可能是我们大多数人所说的“X 文件”，比如响应 ;-)

只是为了记录，我还认为 - 至少在概述的情况下 - 这将归结为“智力盗窃”，所以它真的归结为你合同中的细节。

另外，我个人会问自己几个问题，比如：

*   为什么我真的想向公众发布这个源代码？
*   它有什么革命性的意义？
*   是否值得可能的麻烦（即失业/被起诉）？

所以，我不仅与您的情况有关，而且与您雇主的情况有关——事实上，我会***非常***厌倦一个简单地将我的 IP 发布到开放/公共领域（或作为开源）的员工，当然如果那样的话意味着我可能会牺牲竞争优势。您是否签署了任何 NDA？

因此，这确实是一个道德困境。

另一方面，我也能理解确实需要让人类知道某些事情的情绪（如果真的是这样的话），所以如果你的代码要解决像“世界饥饿”、“世界贫困”这样的重大世界性问题， “癌症”、“艾滋病”或“能源危机”通过提出清洁核能，然后看在上帝的份上：到底是什么 ;-)

不，老实说：如果我处于类似的情况，我会相信将信息公开——我根据合同开发的——为了可能以某种主要方式帮助人类，我会考虑将其提炼成非常抽象的，算法基础知识，可以轻松匿名地发布到[wikileaks.org](http://www.wikileaks.org)等网站。

事实上，仅仅用小众语言重新实现算法（想想brainfuck ;-)）也可能有助于混淆起源，有很多小众语言不是主流，而且许多开发人员不一定能理解。事实上，您甚至可以对您的信息进行加密或密码保护，以便任何对它感兴趣的第 3 方都需要对其进行解锁，这样您就不会真正直接提供任何东西。使用可以在可预见的时间范围内被相应的计算能力破解的加密方案，可以保证你的代码最终会被某人解锁。

但是，无论如何，我肯定会避免发布与我的姓名相关的任何内容或任何其他可能在最坏情况下对我不利的个人信息。事实上，我什至不会在我的工作地点、家里或任何可以直接与我联系起来的地方从事与这种努力有关的任何活动。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-18T19:33:49.593

首先，我可能会在律师的帮助下重新阅读您的合同，以了解究竟什么是允许的，什么是不允许的。

您可能被允许暗示其他人可以做类似的事情。这通常足以刺激独立发展。请确保此提示是私下/匿名完成的，并且不包含只有您才能拥有的任何信息。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-10T03:04:30.247

我不同意这里的大多数回复，我的思维方式是这样的：如果你自己开发一些东西，在你自己的时间，这是你的智力在工作，因此你的知识产权因此你完全有权利用你的产品做任何你想做的事。您不能仅仅因为您过去曾为雇主 X 工作过而放弃并忘记您编程的好想法/实现。如果我们都这样做了，OSS 可能就不存在了。

但是，如果代码背后的想法不是您的，或者代码库本身不是您的，您需要获得参与生产的所有各方的同意。

我并不是说你不会被解雇，但这是你自己的决定，你可以自由地做出决定。但是，我严重怀疑如果您能证明（或反驳另一个）这个想法和实施来自您的头脑并且是在您的空闲时间完成的，那么您会遇到任何法律问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-09-10T03:51:56.890

这可能是它自己的问题，但在这里似乎相当主题。每个人都在说要检查你的工作合同并谈论保密和竞业禁止......如果你被录用时你从未签署任何东西并且没有合同或协议怎么办？您不是该代码的所有者并且可以随意发布它吗？在其中一个 SO 播客中，Joel 提到在这种情况下，程序员是所有者并且可以发布它。我知道一切都有问题，但是在这种情况下有什么信息可以看吗？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-18T14:35:46.730

大多数合同都可能包含一个条款，说明书面项目属于您的雇主。如果你这样做，我认为你最终会很快被解雇。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-18T14:44:51.410

简短的回答：窃取你雇主的代码几乎可以肯定是非法**和**不道德的，无论你是否将其开源。

简短的解决方案：在家中和自己的时间从头开始重写。

简短的警告：您的雇佣协议/合同可能**专门**防止这种事情发生。行动前阅读。

从定义您认为需要创建的要求和规范的文档开始。如果你坐下来思考你的第一个原型（你是有钱建造的）的结果，你很有可能会看到改进的机会。创建一个具有该使命的开源项目并开始针对这些要求进行编码。在每个人都可以看到和贡献的地方编写一个满足您要求的全新产品，您可能会做出一些有用的东西，而且对您的原始工作几乎没有可追溯性。

棺材上的短钉子：当你重写它时，先用另一种语言写它。如果该项目很受欢迎，请稍后再返回该项目并创建不同的语言版本（包括您在工作中使用的那个）。

**tl;dr**：您的雇佣协议/合同有可能**专门**防止这种事情发生。行动前阅读。注意：这与上面的警告有意相同。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-19T04:34:23.653

我认为你有一种让自己陷入困境的独特才能。回头看看你在做什么，亲眼看看你对自己和经济造成了多大的伤害！

1.  你没有得到雇主的同意
2.  你必须重写你的代码
3.  你可能会失去工作。

（一旦发生这种情况，就会产生一长串后果——您将停止支出，开始拖欠贷款，增加失业人数并造成混乱）

所以在做这些事情之前先想想自己的判断力是否正确。每个人每天都能找到挑战规则的机会。但这不是我们被雇用的目的。所以拜托了！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-22T13:46:02.647

你可以（不应该）做几件事。

a) 在没有许可证的情况下发布源。如果您的雇主拥有来源，这就是版权侵权。没有许可证的源不是开源的，它只是一个可以复制想法但不能复制的想法的存储库

b) 使用许可证发布源。如果您的雇主拥有来源，这就是版权侵权，也可能是其他东西，例如欺诈 (IANAL)。它还完全破坏了人们对开源许可证的信任。

没有多少我能想到的事情会让我的一名员工当场被解雇，但发布我拥有的软件，表面上是开源的，就可以了！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-05T22:46:07.013

你的雇主拥有你在他的雇佣下制作的代码。这是您出售开发技能以换取金钱时签订的合同；你为你的雇主生产代码并放弃对他的所有权，他为你的代码生产金钱并放弃它的所有权给你。这是一个交易。在这种情况下，未经适当同意就发布代码是完全不道德的，除非是特殊情况（生死等）。

但是，使用您的知识和积累的经验和培训来编写完成类似目的的完全独​​立的软件并不是不道德的。您的雇主可能认为这是利益冲突并因此解雇您，但只要此代码完全没有您雇主代码库中的任何代码，他几乎无能为力（据我所知；IANAL）（假设标准的雇员-雇主关系，没有特别合同）。

如果你真的觉得类似的代码会给开源社区带来如此大的好处，我相信我们都鼓励你继续构建和发布该项目，但是请确保你以完全合法、明确的方式这样做; 确保*没有*原始代码出现在您的克隆中，并且您不受无关法规或合同的约束。围绕您的项目的不明确、不干净或其他可疑的许可会使它对更大的开源社区毫无用处。

祝你好运！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-15T08:16:37.420

只是想我会添加我的意见：

我认为保持代码闭源是不道德的，如果这样做对您几乎没有好处，而发布它会使许多人受益。

然而，如果你的雇主拥有代码，那是他的决定，他做出不道德的选择并不会给你任何对他的代码的权利。

但是，我看到了一个解决方案：如果您的合同允许您在工作时间之外编写并拥有此类代码的所有权利，您可以编写代码，将其作为开源发布，然后使用开源雇主代码中的库（作者恰好是您的库）。

但是，您必须为代码选择适当的开源许可证（例如，GPL 代码不能真正在其他闭源软件中使用）。

但是，如果您**已经获得**了编写代码的报酬，那么雇主拥有最终决定权。

请注意，伊纳尔。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-02-01T04:44:04.660

如果您将雇主的代码作为“自由软件”发布，您将危害您正在参与的自由软件项目。这是自由软件基金会要求对版权进行预先验证的原因之一，并且在必要时要求一个人的雇主提供免责声明。使用表格和免责声明，他们可以很好地抵御侵犯版权的索赔。如果有人试图贡献其雇主的代码，不仔细检查贡献者对代码所有权的项目将面临法律纠纷。

# internet-explorer - IE 自动化：如何确定用户启动的导航何时发生/已经发生？

> ID：455230
> 
> 赞同：1
> 
> 时间：2009-01-18T14:35:57.683
> 
> 标签：internet-explorer, navigation, webbrowser-control, bho

我有一个 Internet Explorer BHO（在 c# .net 中）并且想要识别用户何时启动导航或用户启动导航何时完成。用户发起我的意思是点击一个链接或类似的动作。特别是如果正在加载的文档中有多个框架，我想将它们视为一个“导航”，但我想不出任何简单的方法来做到这一点。我知道 BeforeNavigate2 和 DocumentComplete 事件，但是看不到任何方法来区分用户单击链接时触发的 BeforeNavigate/DocumentComplete 和由于框架正在加载而触发。

我在想的一种可能的解决方案是，顶部框架的 BeforeNavigate2 总是在内部框架之前被触发（显然），然后子框架的 DocumentComplete 在顶部的 DocumentComplete 之前被调用，它总是最后调用. 因此，例如，我可以在 BeforeNavigates 中增加一个计数器并在 DocumentComplete 中减少它，只有当它为 0 时，它才是用户启动的导航。

但我不确定我是否可以依靠这个，或者是否有更好的方法来做到这一点。例如，如果用户在其中一帧后按下 ESC 但并非所有帧都完成加载会发生什么情况：是否曾调用顶部帧的 DocumentComplete？

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T11:05:00.983

您可以通过针对您存储在 BHO 的*SetSite*方法中的浏览器对象的指针测试*pDispParams参数来测试**BeforeNavigate/NavigateComplete/DocumentComplete*事件是来自 ineere 框架还是来自最简单的框架。

 **这是执行此操作的 C++ 代码，我希望您可以轻松地将其转换为 C#：

```
STDMETHODIMP MyBHO::Invoke(DISPID dispidMember,
  REFIID riid, 
  LCID lcid,
  WORD wFlags,
  DISPPARAMS* pDispParams,
  VARIANT* pvarResult,
  EXCEPINFO* pExcepInfo,
  UINT* puArgErr)
{
  if( dispidMember != DISPID_BEFORENAVIGATE2 &&
      dispidMember != DISPID_NAVIGATECOMPLETE2 &&
      dispidMember != DISPID_DOCUMENTCOMPLETE )
    return S_OK;

  CComQIPtr<IWebBrowser2, &IID_IWebBrowser2> frame =
    pDispParams->rgvarg[ 1 ].pdispVal;

  if( webBrowser2 != frame )
    return S_OK;
} 
```

*webBrowser2*是指向您在*SetSite*方法中获得的浏览器对象的指针，

# security - 有关于不同 CMS 安全性的研究吗？

> ID：455234
> 
> 赞同：2
> 
> 时间：2009-01-18T14:37:11.690
> 
> 标签：security, content-management-system

我喜欢发布指向 Secunia 搜索结果的链接，以（以数字形式）展示某个 CMS（或博客软件）的不安全性。

请参阅[Drupal 的一些缺点是什么？](https://stackoverflow.com/questions/447878/what-are-some-of-drupals-shortcomings#450002)

但是这个答案有一个有趣的评论：

[伊顿](https://stackoverflow.com/users/19411/eaton)：

> 还需要注意的是，Secunia 仅发布明确宣​​布的漏洞报告。我与其他 CMS 软件包合作过，这些软件包在次要版本中添加了重要的安全修复，根本没有任何公告。Drupal 有一个 15 人的团队，负责审查核心和所有 3500 个插件，并根据政策正式宣布安全补丁，无论多么小。

在比较内容管理系统时，是否有任何研究或文章考虑到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T01:07:28.063

我有少量文章加了书签（[比如我同事的这篇](http://www.lullabot.com/articles/drupal-and-expressionengine-security-models)），但它们几乎都是由人们为他们选择的 CMS 辩护，以免受到安全性差的指控。（包括我自己在您的帖子中的评论！）其中一个困难是，我认为没有人已经解决了构成“合理比较”的问题——每个人都对不好的比较感到恼火，但在任何人确定什么之前就走开了一个公平的竞争环境。

大多数“快速概述”都错过了几件事：

*   产品开发团队的安全策略
*   负责安全的特定人员或团队（取决于项目的规模）的存在。显然，项目中的每个人都应该关心
*   是否有针对第三方开发人员的书面安全最佳实践
*   按类型和严重性比较漏洞

也许这个线程将是一个集思广益的好地方，什么将构成一个好的比较研究？

*更新*- 一位同事对 Secunia 有相反的挫败感：第三方针对 OSS 项目提交的不准确和错误的报告。Secunia 显然拒绝更新或修改它们。这是一项有用的服务或公告，但我听到的一切都让我在使用它们进行比较时感到畏缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T18:45:15.433

使用这些 Secunia 搜索的另一个主要问题是，它们包括所有贡献的模块以及 Drupal Core，即使特定[公告可能是针对](http://secunia.com/advisories/30934/)[大约 30 人](http://drupal.org/project/usage/tinytax)使用的模块。

除了按类型和严重性划分的漏洞之外，您还需要考虑“核心”与“附加”模块以及偶尔将多个漏洞放入单个公告中的做法（经常发生）。

我的感觉是，伊顿的一些政策措施比具体的漏洞数量或严重程度更重要。

我要添加到该列表中的最后一个好措施是在过去 X 年的几个月中，在没有任何项目修复的情况下公开披露了漏洞。这种情况很少见，但却是安全过程真正失败的标志。

# ajax - 带有 ASP.NET MVC 的 Ajax ModalPopup 扩展器

> ID：455235
> 
> 赞同：2
> 
> 时间：2009-01-18T14:38:39.003
> 
> 标签：ajax, asp.net-mvc, modalpopupextender

我正在尝试实现 Ajax ModalPopup Extender，但我不知道从哪里开始。有人可以告诉我如何去做，或者至少引导我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T23:51:54.113

我最近使用 JQuery 发送模式弹出窗口。看看这个。看起来很容易使用。

[http://www.ericmmartin.com/projects/simplemodal/](http://www.ericmmartin.com/projects/simplemodal/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T15:33:36.397

我不确定 AJAX 控件工具包对 MVC 有多满意（我不是 MVC 用户），但如果您正在寻找有关控件使用的信息，请观看此视频。它非常容易实现：

[视频](http://www.asp.net/learn/ajax-videos/video-85.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T15:22:55.730

我不认为 Ajax Control Toolkit 中的控件与 ASP.NET MVC 完全兼容。Ajax Control Toolkit 小部件的实现方式与传统 Web 控件类似，因此很可能需要 viewstate，而 ASP.NET MVC 中不存在这种情况。

为了在 ASP.NET MVC 中完成模态，你必须走老路，采用更裸机的方法，开始破解尖括号、JavaScript 和 CSS。我过去使用的是一个 jQuery 插件[jqModal](http://dev.iceburg.net/jquery/jqModal/)，但那里有很多。

# c# - 在 C# 中弹出数组

> ID：455237
> 
> 赞同：28
> 
> 时间：2009-01-18T14:41:39.620
> 
> 标签：c#, arrays

我在 C# 中有一个字符串数组，我想从数组中弹出顶部元素（即删除第一个元素，并将所有其他元素向上移动）。有没有一种简单的方法可以在 C# 中做到这一点？我找不到 Array.Pop 方法。

我需要使用像 ArrayList 这样的东西吗？我的数组中项目的顺序很重要。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-18T14:42:18.420

改用[List](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)、[Queue](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)或[Stack](http://msdn.microsoft.com/en-us/library/3278tedw.aspx) ..

```
List<String>
Queue<String>
Stack<String> 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-01-18T14:54:00.813

[`Queue<T>`](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)（先进先出）或[`Stack<T>`](http://msdn.microsoft.com/en-us/library/3278tedw.aspx)（后进先出）是您所追求的。

.NET 中的数组是固定长度的 - 您不能从中删除元素或确实向其中添加元素。您*可以*`List<T>`使用but来执行此操作，`Queue<T>`并且`Stack<T>`在您需要队列/堆栈语义时更合适。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-18T14:45:51.157

来自 MSDN：

```
using System;
using System.Collections.Generic;

namespace ConsoleApplication1
{
    class MSDNSample
    {
       static void Main()
       {
          string input = "a b c d";

          Stack<string> myStack = new Stack<string>(
             input.Split(new string[] { " " }, StringSplitOptions.None));

          // Remove the top element (will be d!)
          myStack.Pop();

          Queue<string> myQueue = new Queue<string>(

          input.Split(new string[] { " " }, StringSplitOptions.None));

          // Remove the first element (will be a!)
          myQueue.Dequeue();

       }
    }
} 
```

[http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/a924097e-3d72-439d-984a-b371cd10bcf4/](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/a924097e-3d72-439d-984a-b371cd10bcf4/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-04-11T21:28:04.397

由于我们有***linq***很容易做到：

```
string[] array = ...;
array = array.Skip(1).ToArray(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-11T21:11:15.297

我遇到了上面提到的问题，但是当集合为空时，Queue 的默认行为会引发异常（并不是真正的异常情况）。这是我对 SafeQueue 的实现，它将大多数操作推迟到基类，但实现 new`Dequeue()`和如果队列为空则`Peek()`返回的操作。`default(T)`在可能`default(T)`被添加到队列中的情况下（对于对象类型不太可能，但对于值类型很可能），仅使用 是不可能判断队列是否为空的`Peek`。一个新的`IsEmpty`属性可以告诉你什么时候完成。

```
public class SafeQueue<T>: Queue<T>
{
    public SafeQueue() : base() { }

    public SafeQueue(int count) : base(count) { }

    public SafeQueue(IEnumerable<T> collection) : base(collection) { }

    public bool IsEmpty {get { return Count == 0; }}

    public new T Dequeue()
    {
        return IsEmpty ? default(T) : base.Dequeue();
    }

    public new T Peek()
    {
        return IsEmpty ? default(T) : base.Peek();
    }
}

[TestClass]
public class SafeQueueTests
{
    [TestMethod]
    public void SafeQueue_int_constructor_works()
    {
        var q = new SafeQueue<string>(5);
        Assert.IsNotNull(q);
        Assert.AreEqual(0, q.Count);
        q.Enqueue("a");
        Assert.AreEqual(1, q.Count);
        q.Enqueue("b");
        Assert.AreEqual(2, q.Count);
        q.Enqueue("c");
        Assert.AreEqual(3, q.Count);
        q.Enqueue("d");
        Assert.AreEqual(4, q.Count);
        q.Enqueue("e");
        Assert.AreEqual(5, q.Count);
        q.Enqueue("f");
        Assert.AreEqual(6, q.Count);
    }

    [TestMethod]
    public void SafeQueue_dequeue_works()
    {
        var q = new SafeQueue<string>();
        Assert.IsNotNull(q);
        Assert.AreEqual(0, q.Count);
        q.Enqueue("a");
        Assert.AreEqual(1, q.Count);
        q.Enqueue("b");
        Assert.AreEqual(2, q.Count);
        var result = q.Dequeue();
        Assert.AreEqual("a", result);
        result = q.Dequeue();
        Assert.AreEqual("b", result);
        result = q.Dequeue();
        Assert.AreEqual(null, result);
    }
    [TestMethod]
    public void SafeQueue_peek_works()
    {
        var q = new SafeQueue<string>();
        Assert.IsNotNull(q);
        Assert.AreEqual(0, q.Count);
        q.Enqueue("a");
        Assert.AreEqual(1, q.Count);
        var result = q.Peek();
        Assert.AreEqual("a", result);
        result = q.Dequeue();
        Assert.AreEqual("a", result);
        result = q.Dequeue();
        Assert.AreEqual(null, result);
    }

    [TestMethod]
    public void SafeQueue_isEmpty_works()
    {
        var q = new SafeQueue<string>();
        Assert.IsNotNull(q);
        Assert.AreEqual(0, q.Count);
        Assert.AreEqual(true, q.IsEmpty);
        q.Enqueue("content");
        Assert.AreEqual(false, q.IsEmpty);
        var result2 = q.Dequeue();
        Assert.AreEqual("content", result2);
        Assert.AreEqual(true, q.IsEmpty);
        result2 = q.Dequeue();
        Assert.AreEqual(true, q.IsEmpty);
        Assert.AreEqual(null, result2);
    }
    [TestMethod]
    public void SafeQueue_passedThroughQueueOperationContains_work()
    {
        var q = new SafeQueue<string>(5);
        Assert.IsNotNull(q);
        Assert.AreEqual(0, q.Count);
        q.Enqueue("a");
        Assert.AreEqual(1, q.Count);
        q.Enqueue("b");
        Assert.AreEqual(2, q.Count);
        q.Enqueue("c");
        Assert.AreEqual(3, q.Count);
        Assert.IsTrue(q.Contains("a"));
        Assert.IsFalse(q.Contains("asdfawe"));
        var outval = q.Dequeue();
        Assert.IsFalse(q.Contains("a"));
    }
    [TestMethod]
    public void SafeQueue_CantTellByDequeueIfQueueIsEmptyOrContainsNull()
    {
        var q = new SafeQueue<string>();
        Assert.IsNotNull(q);
        Assert.AreEqual(true, q.IsEmpty);
        q.Enqueue(null);
        Assert.AreEqual(false, q.IsEmpty);
        var result2 = q.Peek();
        Assert.AreEqual(null, result2);
        Assert.AreEqual(false, q.IsEmpty);
        result2 = q.Dequeue();
        Assert.AreEqual(true, q.IsEmpty);
        Assert.AreEqual(null, result2);
    }

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-11T21:17:43.497

这在 Array 中完全可以实现，但效率不高。您实际上必须使用循环向下移动数组并在 for 循环中设置 arr[i] = arr[i+1] 。在此之后，如果需要，您必须调整数组的大小。

由于这些警告，数组不是处理问题的最佳数据结构。数组最适合静态数据，或者大小不会改变的数据。

既然要删除数据，数组显然不是答案。具体来说，您想从集合中弹出第一个/顶部元素，并且已经有一个有效的数据结构可以执行此操作：[Stack](http://www.dotnetperls.com/stack)。

这是数据结构的美妙之处，它们为您提供了一种根据您的要求处理集合的有效方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-22T14:17:52.637

我同意上述观点，但我有一点改进..

```
 public static class ArrayExtensions
    {
        /// <summary>
        /// Removes the last element.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="array">The array.</param>
        /// <returns>T[].</returns>
        public static T[] RemoveLastElement<T>(this T[] array)
        {
            var stack = new Stack<T>(array);
            stack.Pop();
            return stack.ToArray().Reverse().ToArray();
        }

        /// <summary>
        /// Removes the first element.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="array">The array.</param>
        /// <returns>T[].</returns>
        public static T[] RemoveFirstElement<T>(this T[] array)
        {
            var queue = new Queue<T>(array);
            queue.Dequeue();
            return queue.ToArray();
        }
    } 
```

为了使它完整，这里是测试：

```
 [Test]
        public void ExtensionsTests_ArrayExtensionTests()
        {
            var data = new[] { 'A', 'B', 'C', 'D' };

            Assert.AreEqual("BCD", string.Join("", data.RemoveFirstElement()));
            Assert.AreEqual("ABC", string.Join("", data.RemoveLastElement()));
        } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-04-06T05:28:56.857

你真正想要的是一个队列，你可以从你的数组中创建一个队列，如下所示：

```
var args = { "value1", "value2" };
var queue = new Queue<string>(args);
var arg1 = queue.Dequeue();
var arg2 = queue.Dequeue(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-06-15T23:42:48.870

为了完整起见，这也很快；

```
 /// <summary>
    /// Pop value from top of string[] array
    /// </summary>
    public void PopStringArray(ref string[] array)
    {
        int newLength = array.Length;
        string[] temp = new string[array.Length];

        for (int i = array.Length - 1; i >= 1; i--)
            temp[i - 1] = array[i];

        array = temp;
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-09T15:29:36.047

以防万一有人遇到这种情况，pop() 函数类似于 typescript 中的函数，即从数组中弹出最后一项并返回其值

```
 public static T Pop<T>(this IList<T> collection) where T : class
    {
        if (collection == null || !collection.Any())
        {
            throw new ArgumentException($"Failed to pop list of {typeof(T)}, cannot be empty or null");
        }

        var lastItemAsJson = JsonSerializer.Serialize(collection.Last());
        collection.Remove(collection.Last());
        return JsonSerializer.Deserialize<T>(lastItemAsJson);
    } 
```

# ide - 更高版本的 S60 平台 SDK 可以为更低版本构建吗？

> ID：455246
> 
> 赞同：0
> 
> 时间：2009-01-18T14:47:03.823
> 
> 标签：ide, nokia, s60

使用[Carbide C++](http://www.forum.nokia.com/Resources_and_Information/Tools/IDEs/Carbide.c++/) **IDE**安装[S60 3rd Edition FP1](http://www.forum.nokia.com/info/sw.nokia.com/id/4a7149a5-95a5-4726-913a-3c6f21eb65a5/S60-SDK-0616-3.0-mr.html) Platform **SDK**后，

 **您**可以**为支持的手机构建程序：

*   3rdE-FP1

但是**您也可以**针对支持以下功能的手机吗？

*   3rdE
*   2ndE-FP3
*   2ndE-FP2
*   2ndE-FP1
*   2ndE
*   第一E

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T07:04:54.317

您可以构建 3rdE，但对于较旧的手机，您必须为 1st 和 2nd 安装 SDK。如果您的应用程序没有使用任何花哨的 FP3 设置，那么拥有一个第二个 SDK 就足够了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-19T13:58:07.027

我原以为只要您只使用最旧版本中可用的 API，那么由于 Symbian 的二进制兼容性，任何新的 SDK 都应该能够为旧版本构建。

# jquery - JQuery DatePicker，如何突出显示当前输入的日期？

> ID：455247
> 
> 赞同：4
> 
> 时间：2009-01-18T14:47:14.243
> 
> 标签：jquery, css, jquery-plugins, datepicker

我正在为 jquery 使用 datepicker 控件，一切都很好，只是我无法让它突出显示当前选择的输入值（或当前日期）。即使我的文本输入中有有效的日期值，并且可以让日期选择器返回正确的月/年，我也无法让它在日历上突出显示该日期。

这是我的代码：

```
$('.date_picker').datepicker({ dateFormat: 'dd/mm/yy', duration: '', gotoCurrent: true, defaultDate: -1}); 
```

..这是样式表：

```
/*datepicker*/
/* Main Style Sheet for jQuery UI date picker */
.ui-datepicker-div, .ui-datepicker-inline, #ui-datepicker-div {
    /*resets*/margin: 0; padding: 0; border: 0; outline: 0; line-height: 1.3; text-decoration: none; font-size: 100%; list-style: none;
    font-family: Verdana, Arial, sans-serif;
    background: #ffffff url(images/ffffff_40x100_textures_01_flat_0.png) 0 0 repeat-x;
    font-size: 0.80em;
    border: 4px solid #dddddd;
    width: 15.5em;
    padding: 2.5em .5em .5em .5em;
    position: relative;
}
.ui-datepicker-div, #ui-datepicker-div {
    z-index: 9999; /*must have*/
    display: none;
}
.ui-datepicker-inline {
    float: left;
    display: block;
}
.ui-datepicker-control {
    display: none;
}
.ui-datepicker-current {
    display: none;
}
.ui-datepicker-next, .ui-datepicker-prev {
    position: absolute;
    left: .5em;
    top: .5em;
    background: #e6e6e6 url(images/e6e6e6_40x100_textures_02_glass_75.png) 0 50% repeat-x;
}
.ui-datepicker-next {
    left: 14.6em;
}
.ui-datepicker-next:hover, .ui-datepicker-prev:hover {
    background: #dadada url(images/dadada_40x100_textures_02_glass_75.png) 0 50% repeat-x;
}
.ui-datepicker-next a, .ui-datepicker-prev a {
    text-indent: -999999px;
    width: 1.3em;
    height: 1.4em;
    display: block;
    font-size: 1em;
    background: url(images/888888_7x7_arrow_left.gif) 50% 50% no-repeat;
    border: 1px solid #d3d3d3;
    cursor: pointer;
}
.ui-datepicker-next a {
    background: url(images/888888_7x7_arrow_right.gif) 50% 50% no-repeat;
}
.ui-datepicker-prev a:hover {
    background: url(images/454545_7x7_arrow_left.gif) 50% 50% no-repeat;
}
.ui-datepicker-next a:hover {
    background: url(images/454545_7x7_arrow_right.gif) 50% 50% no-repeat;
}
.ui-datepicker-prev a:active {
    background: url(images/222222_7x7_arrow_left.gif) 50% 50% no-repeat;
}
.ui-datepicker-next a:active {
    background: url(images/222222_7x7_arrow_right.gif) 50% 50% no-repeat;
}
.ui-datepicker-header select {
    border: 1px solid #d3d3d3;
    color: #555555;
    background: #e6e6e6;
    font-size: 1em;
    line-height: 1.4em;
    position: absolute;
    top: .5em;
    margin: 0 !important;
}
.ui-datepicker-header option:focus, .ui-datepicker-header option:hover {
    background: #dadada;
}
.ui-datepicker-header select.ui-datepicker-new-month {
    width: 7em;
    left: 2.2em;
}
.ui-datepicker-header select.ui-datepicker-new-year {
    width: 5em;
    left: 9.4em;
}
table.ui-datepicker {
    width: 15.5em;
    text-align: right;
}
table.ui-datepicker td a {
    padding: .1em .3em .1em 0;
    display: block;
    color: #555555;
    background: #e6e6e6 url(images/e6e6e6_40x100_textures_02_glass_75.png) 0 50% repeat-x;
    cursor: pointer;
    border: 1px solid #ffffff;
}
table.ui-datepicker td a:hover {
    border: 1px solid #999999;
    color: #212121;
    background: #dadada url(images/dadada_40x100_textures_02_glass_75.png) 0 50% repeat-x;
}
table.ui-datepicker td a:active {
    border: 1px solid #dddddd;
    color: #222222;
    background: #ffffff url(images/ffffff_40x100_textures_02_glass_65.png) 0 50% repeat-x;
}
table.ui-datepicker .ui-datepicker-title-row td {
    padding: .3em 0;
    text-align: center;
    font-size: .9em;
    color: #222222;
    text-transform: uppercase;
}
table.ui-datepicker .ui-datepicker-title-row td a {
    color: #222222;
}
.ui-datepicker-cover {
    display: none;
    display/**/: block;
    position: absolute;
    z-index: -1;
    filter: mask();
    top: -4px;
    left: -4px;
    width: 193px;
    height: 200px;
} 
```

我正在使用 IE7 进行测试，但我在 Firefox 中看到了相同的行为。

关于这个问题的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T17:46:27.970

首先，您在哪个浏览器中查看日期选择器？我注意到日期选择器中日期/部分的某些颜色在**IE6**中与后来的浏览器（**Firefox 3、Chrome、IE7**）相比看起来不同。

例如，IE6 似乎忽略了周末的背景颜色。

当前选定日期和今天日期的背景颜色都是通过 CSS 控制的。[最后一个日期选择器](http://docs.jquery.com/UI/Datepicker)的默认 CSS是[主要植物群样式表](http://ui.jquery.com/latest/themes/flora/flora.datepicker.css)，虽然我看到日期选择器有一个[新版本/样式表](http://ui.jquery.com/demos/datepicker)（我还没有正确阅读，我相信它可能是一个新版本）本周的[jQuery网站。](http://jquery.com/)

您需要更改背景颜色的样式表中类的相关默认名称是 -

```
 /* current input value background color */
.ui-datepicker-current-day
{
    background: #83C948
}
/* today's background color */
.ui-datepicker-today 
{
    background: #83C948
} 
```

**编辑：**

如果您[按原样使用旧的 Datepicker](http://docs.jquery.com/UI/Datepicker)，那么这些是插件 js 文件中的相关行 -

```
this._currentClass = 'ui-datepicker-current-day'; 
// The name of the current day marker class

(printDate.getTime() == today.getTime() ? ' ui-datepicker-today' : '')) + '"' + ...
// highlight today (if different) 
```

因此，您要么

*   需要在您的 CSS 样式表中使用这些 CSS 类来突出显示今天和当前选定的日期

或者

*   您将需要更改插件 js 文件中的名称，并为 CSS 样式表中的类使用相同的名称

就个人而言，我会选择前者，因为它们是众所周知的类名。

**编辑2：**

似乎[新的日期选择器](http://ui.jquery.com/demos/datepicker)使用稍微不同的 CSS 来为当前选定的日期和今天的日期着色。之前的版本设置了表格单元格 ( *td* ) 元素的样式，而新版本设置了单元格内的锚点 ( *a* ) 元素的样式。

在 Firefox 3 中使用[Firebug](http://getfirebug.com/)（强烈推荐），今天要着色的 CSS 似乎是

```
.ui-state-highlight, .ui-widget-content .ui-state-highlight 
{
    background:#FFE45C url(../images/?new=ffe45c&w=1&h=100&f=png&q=100&fltr[]=over|textures/03_highlight_soft.png|0|0|75) repeat-x scroll 50% top;
    border:1px solid #FED22F;
    color:#363636;
} 
```

对于输入中当前选定的日期，它是

```
.ui-state-active, .ui-widget-content .ui-state-active 
{
    background:#FFFFFF url(../images/?new=ffffff&w=1&h=400&f=png&q=100&fltr[]=over|textures/02_glass.png|0|0|65) repeat-x scroll 50% 50%;
    border:1px solid #FBD850;
    color:#EB8F00;
    font-weight:bold;
    outline-color:-moz-use-text-color;
    outline-style:none;
    outline-width:medium;
} 
```

这些都来自[jQuery UI CSS 框架](http://ui.jquery.com/applications/themeroller/css/parseTheme.css.php?ctl=themeroller&tr=&ffDefault=Trebuchet+MS,+Tahoma,+Verdana,+Arial,+sans-serif&fwDefault=bold&fsDefault=1.1em&cornerRadius=4px&bgColorHeader=f6a828&bgTextureHeader=12_gloss_wave.png&bgImgOpacityHeader=35&borderColorHeader=e78f08&fcHeader=ffffff&iconColorHeader=ffffff&bgColorContent=eeeeee&bgTextureContent=03_highlight_soft.png&bgImgOpacityContent=100&borderColorContent=dddddd&fcContent=333333&iconColorContent=222222&bgColorDefault=f6f6f6&bgTextureDefault=02_glass.png&bgImgOpacityDefault=100&borderColorDefault=cccccc&fcDefault=1c94c4&iconColorDefault=ef8c08&bgColorHover=fdf5ce&bgTextureHover=02_glass.png&bgImgOpacityHover=100&borderColorHover=fbcb09&fcHover=c77405&iconColorHover=ef8c08&bgColorActive=ffffff&bgTextureActive=02_glass.png&bgImgOpacityActive=65&borderColorActive=fbd850&fcActive=eb8f00&iconColorActive=ef8c08&bgColorHighlight=ffe45c&bgTextureHighlight=03_highlight_soft.png&bgImgOpacityHighlight=75&borderColorHighlight=fed22f&fcHighlight=363636&iconColorHighlight=228ef1&bgColorError=b81900&bgTextureError=08_diagonals_thick.png&bgImgOpacityError=18&borderColorError=cd0a0a&fcError=ffffff&iconColorError=ffd27a&bgColorOverlay=666666&bgTextureOverlay=08_diagonals_thick.png&bgImgOpacityOverlay=20&opacityOverlay=50&bgColorShadow=000000&bgTextureShadow=01_flat.png&bgImgOpacityShadow=10&opacityShadow=20&thicknessShadow=5px&offsetTopShadow=-5px&offsetLeftShadow=-5px&cornerRadiusShadow=5px)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-12-09T13:47:23.707

这是最好的解决方案：

![在此处输入图像描述](https://i.stack.imgur.com/wAmqE.png)

输入字段，选择星期。

[https://github.com/Prezent/jquery-weekpicker](https://github.com/Prezent/jquery-weekpicker)

# c++ - 我需要一个稍微不同的多图

> ID：455251
> 
> 赞同：2
> 
> 时间：2009-01-18T14:50:03.287
> 
> 标签：c++, string, data-structures, multimap

我正在寻找一个 C++ 容器类，它很像多图，但略有不同。容器将存储成对的字符串。但是当我使用键 K 从容器中检索项目时，我想找到 K 以项目自己的键开头的所有项目。

EG 如果我使用键“abcde”，我想查找键为“adc”和“abcde”的项目，而不是“abcqz”。

或以伪 C++ 形式：

```
multimap2<string, string>  myMultiMap;
myMultiMap.insert( pair("abcde", "hello"));
myMultiMap.insert( pair("abc",   "Hi"));
myMultiMap.insert( pair("abcqz", "goodbye"));

// prints 2
cout << myMultiMap.count("abcde") << endl;

// prints "hello"  and  "Hi"
cout << myMultiMap.everything_which_matches("abcde") << endl;

// prints "Hi"
cout << myMultiMap.everything_which_matches("abc") << endl;

// prints "goodbye"
cout << myMultiMap.everything_which_matches("abcqz") << endl; 
```

插入时间并不重要，但我需要快速访问这些项目。是否可以通过创建特殊的 < 运算符来使用普通的 Multimap 执行此操作？我的预感是，我需要普通的 < 操作符来进行插入，并需要一个特殊的操作符来进行检索。

谢谢

雨果

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T14:56:11.043

我建议使用[trie](http://en.wikipedia.org/wiki/Trie)。

基本上你有一棵树，每个唯一字符有 1 个节点。对于查找和插入，您的算法都是 O(m)，其中 m 是字符串的长度。

所以按照你的例子：

```
"abcde", "hello" 
 "abc",  "Hi"
"abcqz", "goodbye" 
```

然后你会有以下尝试：

```
 a
       |
       b
       |
       c       (c holds data of hi)
     /  \
    d    q
    |    |
    e    z (z holds data of goodbye)    (e holds data of hello) 
```

要进行查找，您只需从根节点（上面未显示根节点）开始，然后跟随输入字符串中的下一个字符。每次到达具有数据结果的节点时，您都​​会将其作为输出字符串之一。

因此，搜索 abcde 会为您提供：“hi”、“hello”，如您所愿。它不会给你“再见”，因为你没有遍历那个结果节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T15:25:08.487

首先，使用 std::multimap，插入和检索不能有不同的顺序。

其次，任何总排序都不足以满足您的目的，这意味着它不会将您想要的答案集呈现为间隔。

我要么使用一个查找来搜索所有前缀（您可以通过记住下一个较短前缀的长度等来优化它）或使用 Trie（而是需要更少空间的 PATRICIA trie）。

# java - 从 .NET 中的 java Web 服务调用获取原始 XML

> ID：455255
> 
> 赞同：0
> 
> 时间：2009-01-18T14:55:03.323
> 
> 标签：java, .net, service, client

我正在使用 .NET 客户端调用 Java Web 服务，由于反序列化过程引发异常，因此返回消息格式错误。有没有办法在 .NET 客户端中查看 Web 服务返回的原始 xml 数据。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T19:56:22.857

我强烈推荐你[SoapUI](http://www.soapui.org/)。它是一个很棒的工具，允许您调用 Web 服务并检查生成的 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T17:36:36.430

您可能想查看位于客户端和服务器之间的 http 嗅探软件。搜索 http 嗅探。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-25T04:05:10.957

您可以使用 Fiddler ( [http://fiddler2.com/](http://fiddler2.com/) ) 拦截来自您计算机的入站和出站 Web 服务调用。

运行 Fiddler。然后使用您的 .NET 客户端或浏览器调用 Web 服务。在 Fiddler 中，您可以在左侧看到 Web 服务端点。单击该端点以查看右侧的请求和响应。 .

![这是 Fiddler UI 的屏幕截图。](https://i.stack.imgur.com/TXABN.jpg)

# firefox - Firefox 如何知道扩展（插件）的更新何时可用

> ID：455260
> 
> 赞同：1
> 
> 时间：2009-01-18T14:56:44.753
> 
> 标签：firefox, plugins

我正在创建我的第一个 Firefox 扩展，并开始考虑部署。

[关于在此处创建模板和在](https://stackoverflow.com/questions/129920/how-do-you-sign-your-firefox-extensions)[此处](https://stackoverflow.com/questions/274639/how-to-create-a-quick-minimal-firefox-extension)签名扩展有一个很好的讨论

但是后来……Firefox如何知道扩展已更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T15:02:52.153

来自[developer.mozilla.org](https://developer.mozilla.org/en/Extension_Versioning%2c_Update_and_Compatibility#Automatic_Add-on_Update_Checking)：

> 应用程序将通过检索 updateURL 定期检查已安装插件的更新。返回的信息可用于通知用户插件的更新版本，以及通知应用程序插件兼容的新应用程序版本。

[有关updateURL](https://developer.mozilla.org/en/Install.rdf#updateURL)的更多详细信息。

# php - 如何使用 MySQL SELECT 创建虚拟列？

> ID：455261
> 
> 赞同：76
> 
> 时间：2009-01-18T14:57:59.293
> 
> 标签：php, mysql, select

如果我 SELECT a AS b 并且 b 不是表中的列，查询会创建“虚拟”列吗？

实际上，我需要将一些虚拟列合并到查询中，并将一些信息处理到查询中，以便以后可以将其与每个项目一起使用。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-01-18T15:01:06.633

就像是：

```
SELECT id, email, IF(active = 1, 'enabled', 'disabled') AS account_status FROM users 
```

这允许您进行操作并将其显示为列。

编辑：

您还可以将连接和显示操作用作列：

```
SELECT u.id, e.email, IF(c.id IS NULL, 'no selected', c.name) AS country
FROM users u LEFT JOIN countries c ON u.country_id = c.id 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2011-07-09T09:42:27.917

如果你想在 select 语句中创建一个虚拟列“age”，试试这个：

```
select brand, name, "10" as age from cars... 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-01-01T06:11:24.453

您可以将虚拟列添加为

```
SELECT '1' as temp 
```

但是，如果您尝试将 where 条件添加到额外生成的列，它将不起作用并且会显示错误消息，因为该列不存在。

我们可以通过将 sql 结果作为表返回来解决这个问题。即，

```
SELECT tb.* from (SELECT 1 as temp) as tb WHERE tb.temp = 1 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-18T15:07:24.687

SELECT 仅从数据库中检索数据，它不会更改表本身。

如果你写

```
SELECT a AS b FROM x 
```

“b”只是查询中的别名。它不会创建额外的列。您在示例中的结果将只包含一个名为“b”的列。但表中的列将保持“a”。“b”只是另一个名字。

我真的不明白你的意思是“所以我以后可以在每个项目上使用它”。您是指稍后在 select 语句中还是在您的应用程序中稍后。也许您可以提供一些示例代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-06-27T23:36:50.760

您可以使用 CASE 语句，例如

```
SELECT name
       ,address
       ,CASE WHEN a < b THEN '1' 
             ELSE '2' END AS one_or_two
FROM ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T15:08:08.583

您的语法将为 a 创建一个别名作为 b，但它的范围不会超出语句的结果。听起来您可能想创建一个[VIEW](http://dev.mysql.com/doc/refman/5.0/en/create-view.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-06T19:22:48.760

请参阅[MariaDB 文档](https://mariadb.com/kb/en/generated-columns/#:%7E:text=Values%20for%20VIRTUAL%20generated%20columns,column%27s%20value%20is%20not%20generated)。虚拟列是通过在`VIRTUAL`列中添加关键字同时在其之前添加表达式来创建的。好消息：您可以向虚拟列添加索引。如果您需要实际值并且担心存储速度过快，请使用`PERSISTENT`列。

# winforms - ObservableCollection(Of T) vs BindingList(Of T)？

> ID：455284
> 
> 赞同：24
> 
> 时间：2009-01-18T15:10:46.893
> 
> 标签：winforms, data-binding, observablecollection, bindinglist

在过去的两年里，我开发了一些基于数据的 Winforms 应用程序，一切正常。此应用程序建立在层（数据访问、业务逻辑和 UI）之上。对于业务逻辑，我的所有对象都继承自一个名为 BaseEntity 的基类，其定义如下（有一些自定义对象和接口，结合框架元素）：

```
Public MustInherit Class BaseEntity
    Inherits SerializableObject
    Implements IEntity
    Implements IComparer,  _
               IEditableObject,  _
               INotifyPropertyChanging, INotifyPropertyChanged,  _
               IApplicationSecurity
End Class 
```

在同一个核心库中，我有一个通用基础集合 BaseEntityCollection。这些集合允许我为每个对象定义他相关的强类型集合，这在基于数据的应用程序中非常有趣。这是它的基本定义：

```
 Public MustInherit Class BaseEntityCollection(Of T As BaseEntity)
    Inherits BindingList(Of T)
    Implements IEntityCollection
    Implements INotifyPropertyChanged, INotifyPropertyChanging, ICopyable(Of T)
    Implements IDisposable
    Implements ISerializable
  End Class 
```

如您所见，我使用了 Winforms 中正确数据绑定所需的所有内容：

*   对象的 INotifyPropertyChanged、INotifyPropertyChanging、IEditableObject。
*   我的收藏基于 BindingList(Of T) 的收藏。

我对新技术也很感兴趣，所以我最近看了一些关于 WPF 的网络广播。在这些网络广播中，它们用作收集和数据绑定支持 ObservableCollection(Of T) 的基类。

我正在考虑将我的一些应用程序从 Winforms 迁移到 UI 层的 WPF。

我的问题是，对于我的业务逻辑，是更好地保留基于 BindingList(Of T) 的集合还是应该更改我的基本集合类以使其继承自 ObservableCollection(Of T)。我想为我的所有项目保留一个独特的基础集合，它也可以在 Winforms 应用程序、WPF 应用程序或 ASP.NET 中使用。我还在我的项目中使用 Linq to Objects，所以我的项目仅基于框架 2.0 并不受限制。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-11-05T13:50:26.723

我认为你的答案在那里：http: [//xceed.com/CS/blogs/dontpanic/archive/2009/04/01/i-notify-we-notify-we-all-wait-no-we-don- t.aspx](http://xceed.com/CS/blogs/dontpanic/archive/2009/04/01/i-notify-we-notify-we-all-wait-no-we-don-t.aspx)

简而言之，ObservableCollection 不会监听其子节点的变化，而只会监听 Insert 和 Remove 事件。

另一方面，BindingList 确实会监听其子级引发的更改和更新。但是因为绑定列表必须监听它的所有子节点来传播更改通知，这会导致更多的内存负载。

希望这会有所帮助:)

- 布鲁诺

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-18T19:46:11.923

克拉伯，

我会保留 BindingList，因为 BindingList 比 ObservableCollection 支持更多的接口和更丰富的功能。例如：

1.  BindingList 实现了 T 的 IList，而 ObservableCollection 没有。
2.  BindingList 实现了 ICancelAddNew 接口，数据绑定机制使用该接口取消新添加的项（当您在 DataGridView 中添加一行后单击转义时，该行将消失）。

我自己对 WPF 很陌生，不知道 ObservableCollection 提供的具体优势。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-13T19:56:36.863

将我的两分钱添加到一个较旧的主题中：

当将这些通用集合中的任何一个数据绑定到 WinForms DataGridView，然后更新源数据中多个选定行的属性时，您将看到：

1.  `ObservableCollection<T>`只会更新最近选择的行的单元格值。
2.  这`BindingList<T>`将更新所有选定行的单元格值。

我认为它们各有优缺点，但是对于那些不知道的人来说，上面的例子可能是一个陷阱。

# visual-studio - 我可以在 VisualStudio 中有一个跳行的命中点吗？

> ID：455290
> 
> 赞同：6
> 
> 时间：2009-01-18T15:16:19.037
> 
> 标签：visual-studio, debugging

我经常遇到这样的情况，即我想在调试时禁用某些代码而不实际更改代码。

我最终做的是有一个断点（通常是有条件的），然后当断点触发时，我执行*Set Next Statement*。当代码多次到达时，这可能会非常耗费人力，因此我创建了一个宏：

```
Sub Skip3Lines()
    DTE.ActiveDocument.Selection.LineDown(False, 3)
    DTE.Debugger.SetNextStatement()
End Sub 
```

然后我将断点更改为命中点 ( `right-click -> When Hit...`) 并告诉它执行这个宏。

Visual Studio 非常高兴地吐出以下对话框：

> `---------------------------`
> `Error`
> `---------------------------`
> `A macro called a debugger action which is not allowed while responding to an event or while being run because a breakpoint was hit.`
> `---------------------------`
> `OK`
> `---------------------------`

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-07-08T13:13:49.907

DTE.ExecuteCommand("Debug.SetNextStatement")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T15:24:53.480

它不能绕过不断变化的代码位，但是本地布尔值呢？用 if 语句包装要有条件地跳过的代码。将其默认为 true 并每次重新初始化。然后，假设您可以编写一个将该值更改为 false 的宏，您可以按需启用/禁用命中点。

以前从来没有这样做过，所以如果宏不能这样工作，你可以告诉我。我通常只使用编辑并继续，注释掉我想跳过的代码。当然，如果代码中包含 lambda 或匿名类型/方法，则它不起作用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-18T15:26:18.690

您可能能够检测它是否处于调试模式，然后使用 if 语句使代码不运行，这里有更多信息

[http://weblogs.asp.net/jkey/archive/2003/11/23/39383.aspx](http://weblogs.asp.net/jkey/archive/2003/11/23/39383.aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-04T12:19:05.720

在这种情况下你不能使用编译器条件吗？

```
#IF Config = "Debug" Then
    ' do my debug code here
#Else
   ' do my normal coding here
#End if 
```

# javascript - 是否可以在 sqlite 中创建 javascript 用户定义函数

> ID：455292
> 
> 赞同：13
> 
> 时间：2009-01-18T15:16:29.317
> 
> 标签：javascript, sqlite

背景：

*   Firefox 3 包括 [SQLite](http://sqlite.org)版本 3.5.9。Firefox 还允许扩展，这些扩展是用 javascript 编写的，可以调用嵌入式 SQLite 引擎。

*   正如所料，执行以下 SQL 语句 'SELECT "TEXT" REGEXP "T*";' 给出错误，因为 SQLite 中没有原生包含 REGEXP 函数。

*   javascript 包含一个内置的正则表达式函数。

*   SQLite 允许通过 SELECT load_extension('filename'); 加载扩展

问题： **是否可以在 SQLite 中加载一个用 javascript 编写的可以执行 REGEXP 的扩展？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T21:42:42.377

是的。可以调用javascript函数

```
//(thanks to Mirnal Kant, SQLManager)
//Version 2 -- Prevent Firefox crashing 
//          -- Suspect a problem with continual creation of Regex objects

var g_RegExpString = null;
var g_RegExp = null;

//functions to be created for the db
var smDbFunctions = { 
  // (0) = Regex Expression
  // (1) = Column value to test
    regexp: {
        onFunctionCall: function(val) {
            if (g_RegExp == null || val.getString(0) != g_RegExpString) 
            {
                g_RegExpString = val.getString(0);
                g_RegExp = new RegExp(g_RegExpString);
            }
            if (val.getString(1).match(g_RegExp)) return 1;
            else return 0;
        }
    }
}; 
```

实例化 SQLite 实例后：

```
Database.createFunction("REGEXP", 2, smDbFunctions.regexp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-01T17:50:34.810

Noah 所说的内容已包含在 Firefox 的[SQLite Manager](http://code.google.com/p/sqlite-manager/)插件中。

当您启动此插件时，您可以单击标记为*f(x)*的图标以打开用户定义的函数选项卡。从那里，选择一个目录，其中有一个名为 smFunctions.sqlite 的 SQLite 数据库，其架构如下：

```
CREATE TABLE "functions"          ( "name"        TEXT    PRIMARY KEY  NOT NULL
                                  , "body"        TEXT                 NOT NULL
                                  , "argLength"   INTEGER
                                  , "aggregate"   INTEGER              NOT NULL DEFAULT 0
                                  , "enabled"     INTEGER              NOT NULL DEFAULT 1
                                  , "extraInfo"   TEXT
                                  );

CREATE TABLE "aggregateFunctions" ( "name"        TEXT    PRIMARY KEY  NOT NULL
                                  , "argLength"   INTEGER
                                  , "onStepBody"  TEXT
                                  , "onFinalBody" TEXT
                                  , "enabled"     INTEGER              NOT NULL DEFAULT 1
                                  , "extraInfo"   TEXT
                                  ); 
```

在该表中，您可以定义自定义函数。参数将作为名为 的数组传递`aValues`。例如：

```
INSERT INTO "functions" ("name", "body", "argLength", "aggregate", "enabled", "extraInfo")
VALUES('regexp_replace'
      ,'// exemple : SELECT regexp_replace(''FOOBAR'',''o+'',''a'',''gi'')
        var input      = new String(aValues.getString(0));
        var regex      = new String(aValues.getString(1));
        var substitute = new String(aValues.getString(2));
        var flags      = new String(aValues.getString(3));

        return input.replace(new RegExp(regex,flags), substitute);
       '
      ,4
      ,0
      ,1
      ,''
      ); 
```

*   如果`argLength`== -1，则参数数量没有限制。您可以使用 获得计数`aValues.numEntries`。
*   您可以使用`aValues.getTypeOfIndex(i)`来了解参数的类型：0 => NULL, 1 => Integer ( `aValues.getInt64(i)`), 2 => Real ( `aValues.getDouble(i)`), 3 => String，参见示例。

对于聚合函数，您可以将`this._store`其用作初始空数组以在 onStepBody 阶段推送元素，并从中读取`onStepFinal`以计算最终结果。

下面是一个 bash 脚本，它将`smFunctions.sqlite`使用一些自定义函数创建（这是`.dump`我自己的 smFunctions.sqlite）：

```
sqlite smFunctions.sqlite << EOF
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE "functions" ("name" TEXT PRIMARY KEY  NOT NULL, "body" TEXT NOT NULL, "argLength" INTEGER, "aggregate" INTEGER NOT NULL  DEFAULT 0, "enabled" INTEGER NOT NULL  DEFAULT 1, "extraInfo" TEXT);
INSERT INTO "functions" VALUES('accumulate','var sum = 0;
for (var j = 0; j < aValues.numEntries; j++) {
    sum += aValues.getInt32(j);
}
return sum;
',-1,0,1,NULL);
INSERT INTO "functions" VALUES('concatenate','var valArr = [];
var delim = new String(aValues.getString(0));
for (var j = 1; j < aValues.numEntries; j++) {
    switch (aValues.getTypeOfIndex(j)) {
    case 0:
        //NULL
        valArr.push(null);
        break;
    case 1:
        //INTEGER
        valArr.push(aValues.getInt64(j));
        break;
    case 2:
        //REAL
        valArr.push(aValues.getDouble(j));
        break;
    case 3:
        //TEXT
    default:
        valArr.push(aValues.getString(j));
    }
}
return valArr.join(delim);',-1,0,1,NULL);
INSERT INTO "functions" VALUES('regexp_match','var regExp = new RegExp(aValues.getString(0));
var strVal = new String(aValues.getString(1));

if (strVal.match(regExp)) {
    return 1;
}
else {
    return 0;
}

',2,0,1,NULL);
INSERT INTO "functions" VALUES('regexp_replace','// exemple : regexp_replace(''toto'',''o+'',''a'',''g'')
var input      = new String(aValues.getString(0));
var regex      = new String(aValues.getString(1));
var substitute = new String(aValues.getString(2));
var flags      = new String(aValues.getString(3));

return input.replace(new RegExp(regex,flags), substitute);
',4,0,1,NULL);
INSERT INTO "functions" VALUES('instr','var char = new String(aValues.getString(0));
var str  = new String(aValues.getString(1));
return str.indexOf(char, 0) + 1;',2,0,1,NULL);
INSERT INTO "functions" VALUES('rinstr','var char = new String(aValues.getString(0));
var str  = new String(aValues.getString(1));
return str.lastIndexOf(char) + 1;
',2,0,1,NULL);
CREATE TABLE "aggregateFunctions" ("name" TEXT PRIMARY KEY  NOT NULL, "argLength" INTEGER, "onStepBody" TEXT, "onFinalBody" TEXT, "enabled" INTEGER NOT NULL DEFAULT 1, "extraInfo" TEXT);
INSERT INTO "aggregateFunctions" VALUES('stdDev',1,'this._store.push(aValues.getInt32(0));','var iLength = this._store.length;
let total = 0;
this._store.forEach(function(elt) { total += elt });
let mean = total / iLength;
let data = this._store.map(function(elt) {
  let value = elt - mean;
  return value * value;
});
total = 0;
data.forEach(function(elt) { total += elt });
this._store = [];
return Math.sqrt(total / iLength);',1,NULL);
INSERT INTO "aggregateFunctions" VALUES('longest_prefix',1,'this._store.push(aValues.getString(0));','if (this._store.length == 0) {
        return "";
}
var prefix = this._store[0];
var prefixLen = prefix.length;
for (var i = 1; i < this._store.length && prefixLen > 0; i++) {
        var word = this._store[i];
        // The next line assumes 1st char of word and prefix always match.
        // Initialize matchLen to -1 to test entire word.
        var matchLen = 0;
        var maxMatchLen = Math.min(word.length, prefixLen);
        while (++matchLen < maxMatchLen) {
                if (word.charAt(matchLen) != prefix.charAt(matchLen)) {
                        break;
                }
        }
        prefixLen = matchLen;
}
return prefix.substring(0, prefixLen);',1,NULL);
COMMIT;
EOF 
```

# c - 在 Windows 上创建大文件

> ID：455297
> 
> 赞同：19
> 
> 时间：2009-01-18T15:18:19.000
> 
> 标签：c, windows, file, file-io

我需要创建相对较大（1-8 GB）的文件。在 Windows 上使用 C 或 C++ 最快的方法是什么？我需要即时创建它们，速度确实是个问题。文件将用于存储仿真，即将在不同的偏移量中随机访问，我需要所有存储都将被预分配但未初始化，目前我们正在使用虚拟数据写入所有存储，并且花费的时间太长。

谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-18T15:21:01.413

使用 Win32 API、[CreateFile](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)、[SetFilePointerEx](http://msdn.microsoft.com/en-us/library/aa365542(VS.85).aspx)、[SetEndOfFile](http://msdn.microsoft.com/en-us/library/aa365531(VS.85).aspx)和[CloseHandle](http://msdn.microsoft.com/en-us/library/ms724211(VS.85).aspx)。以同样的顺序。

诀窍在于 SetFilePointerEx 函数。来自 MSDN：

> 请注意，将文件指针设置为超出文件末尾的位置并不是错误。在调用 SetEndOfFile、WriteFile 或 WriteFileEx 函数之前，文件的大小不会增加。

在将文件从一个位置复制到另一个位置时，Windows 资源管理器实际上会执行相同的操作。这样做是为了使磁盘不需要为碎片磁盘重新分配文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T15:31:50.767

检查[内存映射文件](http://msdn.microsoft.com/en-us/library/ms810613.aspx)。

它们非常符合您描述的用例、高性能和随机访问。

我相信它们不需要创建为大文件。您只需在它们上设置一个较大的最大尺寸，当您写入以前未触及的部分时，它们将被扩展。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-04T14:18:10.130

好吧，[这个](https://stackoverflow.com/a/455302/1237747)解决方案还不错，但是您要寻找的是[SetFileValidData](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365544%28v=vs.85%29.aspx)

正如 MSDN 所说：

> SetFileValidData 函数允许您在非顺序写入文件时避免用零填充数据。

所以这总是让磁盘数据保持原样，`SetFilePointerEx`应该将所有数据设置为零，所以大分配需要一些时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-23T13:16:25.153

使用“fsutil”命令：

E:\VirtualMachines>fsutil file createnew 用法：fsutil file createnew 例如：fsutil file createnew C:\testfile.txt 1000

雷格兹

PS 适用于 Windows：2000/XP/7

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T16:13:37.220

如果您使用的是 NTFS，则可以使用[稀疏文件](http://msdn.microsoft.com/en-us/library/aa365564(VS.85).aspx)：

> 大部分数据为零的文件被称为包含稀疏数据集。此类文件通常非常大——例如，包含要处理的图像数据的文件或高速数据库中的矩阵。包含稀疏数据集的文件的问题是文件的大部分不包含有用的数据，因此，它们对磁盘空间的使用效率低下。
> 
> NTFS 文件系统中的文件压缩是该问题的部分解决方案。文件中未显式写入的所有数据都显式设置为零。文件压缩压缩这些零范围。然而，文件压缩的​​一个缺点是访问时间可能会由于数据压缩和解压缩而增加。
> 
> NTFS 文件系统中引入了对稀疏文件的支持，这是提高磁盘空间使用效率的另一种方式。启用稀疏文件功能后，系统不会为文件分配硬盘空间，除非文件包含非零数据的区域。当尝试写入操作时缓冲区中的大量数据为零时，不会将零写入文件。相反，文件系统会创建一个内部列表，其中包含文件中零的位置，并且在所有读取操作期间都会查询此列表。当在零所在的文件区域中执行读取操作时，文件系统会在为读取操作分配的缓冲区中返回适当数量的零。这样，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-04T15:03:52.803

我知道您的问题被标记为 Windows，如果您确定不必将应用程序移植到其他平台，Brian R. Bondy 会为您的问题提供最佳答案。但是，如果您可能必须将您的应用程序移植到其他平台，您可能想要做一些更像 Adrian Cornish 提出的作为“如何创建“x”大小的文件？”问题的答案的事情。在[如何创建“x”大小的文件？](https://stackoverflow.com/questions/7775027/how-to-create-file-of-x-size).

```
FILE *fp=fopen("myfile", "w");
fseek(fp, 1024*1024, SEEK_SET);
fputc('\n', fp);
fclose(fp); 
```

当然，还有一个额外的转折。Adrian Cornish 提出的答案利用了具有以下签名的 fseek 函数。

```
int fseek ( FILE * stream, long int offset, int origin ); 
```

问题是您想要创建一个文件大小超出 32 位整数范围的非常大的文件。您需要使用 fseek 的 64 位等效项。不幸的是，在不同的平台上它有不同的名称。

[在http://mosaik-aligner.googlecode.com/svn-history/r2/trunk/src/CommonSource/Utilities/LargeFileSupport.h](http://mosaik-aligner.googlecode.com/svn-history/r2/trunk/src/CommonSource/Utilities/LargeFileSupport.h)中找到的头文件 LargeFileSupport.h为这个问题提供了解决方案。

这将允许您编写以下函数。

```
#include "LargeFileSupport.h"
/* Include other headers. */

bool createLargeFile(const char * filename, off_type size)
{
    FILE *fp = fopen(filename, "w");
    if (!fp)
    {
        return false;
    }
    fseek64(fp, size, SEEK_SET);
    fputc('\n', fp);
    fclose(fp);
} 
```

我想我会添加这个，以防这些信息对你有用。

# c# - DataGridViewComboBoxColumn

> ID：455299
> 
> 赞同：0
> 
> 时间：2009-01-18T15:19:57.890
> 
> 标签：c#

如何将数据源设置为 DataGridViewComboBoxColumn 的特定单元格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T15:34:42.993

> 设置列 DataSource、DisplayMember 和 ValueMember 属性会自动设置该列中所有单元格的相应属性，包括 CellTemplate。要覆盖特定单元格的这些属性值，请先设置列属性，然后设置单元格属性。

请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.aspx) 希望这会有所帮助...

# php - 在 Windows 下运行的 PHPLint 有哪些替代方案？

> ID：455303
> 
> 赞同：5
> 
> 时间：2009-01-18T15:21:25.110
> 
> 标签：php, windows, validation

我刚刚完成了一个 5000 行的 PHP 应用程序，现在正在进行测试和调试。在结束前不久，我偶然发现了 PHPLint。我真的很喜欢这个想法——通过一些特殊的注释，我可以指定变量类型，然后该工具会检查我的代码是否存在各种错误。整洁的。我认为在开发结束时我会评论我的代码并在其上运行 PHPLint。

不幸的是，我遇到了一个小问题——PHPLint 在 Windows 下无法编译。嗯，它是，但仅限于 Cygwin，我不想再次安装那个东西。我也不想用 Linux 什么的虚拟机。当然，如果没有其他选择，我会的，但首先我想探索其他选择。

那么 - 在 Windows 下运行的 PHPLint 有什么替代品吗？我的意思是在代码检查的意义上。我不关心文档生成部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-22T17:46:51.827

PHPLint 现在在 Windows 下运行。下载页面目前在这里： http: [//www.icosaedro.it/phplint/download-windows.html](http://www.icosaedro.it/phplint/download-windows.html)

它是一个命令行实用程序，但还有一个小 GUI 工具，需要从[http://www.tcl.tk单独下载 Tcl/Tk 解释器](http://www.tcl.tk)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T17:08:10.933

[它们的工作方式与 PHPLint 不完全相同，但本文](https://stackoverflow.com/questions/378959/is-there-a-static-code-analyzer-like-lint-for-php-files)列出了一些静态分析工具

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-18T20:37:23.320

好的，因为似乎没有任何好的替代品（据我所知，那些静态分析工具不会检查变量类型），我安装了一个 Slackware 虚拟机。干净，把事情做好。:)

如果还有其他一些不错的选择，请不要犹豫，将它们发布在这里。即使我找到了我的解决方案，其他人也可能从中受益！

# excel - 如何在 com 自动化中启动特定的 excel 版本？

> ID：455326
> 
> 赞同：2
> 
> 时间：2009-01-18T15:33:53.290
> 
> 标签：excel, com, automation

我通过 COM 自动化（在 c# 中）使用 Excel，但似乎问题无法控制在盒子上启动的 excel 版本 - 我们同时使用 Excel 9 和 Excel 11，并且一组特定的电子表格需要 excel 9 否则他们不会工作。

我包括了 excel 9 com 参考，但在另一个人的机器上启动了 excel 11。我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-29T15:27:55.193

这与 CurVer 无关。这是COM。与所有 COM 应用程序一样，Windows 通过参考注册表中相关 CLSID 键中的 LocalServer 或 InprocServer 设置来了解如何启动它们。

Excel 的 CLSID 是：

```
{00024500-0000-0000-C000-000000000046} 
```

如果您查看 HKCR\CLSID 下的这个键（HKCR\Wow6432Node\CLSID 是您运行的是 64 位版本的 Windows），您将看到这些键。如果安装了 Excel 2003 和 Excel 2007，则所有这三个键：

```
HKCR\Excel.Appplication
HKCR\Excel.Appplication.11
HKCR\Excel.Appplication.12 
```

将指向相同的 CLSID，这就是为什么 Windows 只知道如何启动一个版本的 Excel。

如果您发现 Excel 2003 正在启动，那是因为 CLSID 的子项指向了 OFFICE11 安装。

要更改此行为，请将路径更改为指向 OFFICE12（或 OFFICE14）路径。Windows 将优先使用该命令的 Unicode 变体（难以理解）。因此，除非您知道如何更新 Unicode，否则只需删除“命令”值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T21:32:04.300

这篇文章可能有用：

[http://forums.devx.com/showthread.php?p=457900#post457900](http://forums.devx.com/showthread.php?p=457900#post457900)

就像上面的评论者一样，我不清楚为什么 Excel 11 会在 Excel 9 电子表格中出现问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T22:15:26.023

我不确定用于 Excel 的 ProgId（CLSID Guids 上的友好名称），但快速浏览会引导我找到“Excel.Application”，作为您可能激活的类型。

在 HKEY_CLASSES_ROOT 下查看，在我的机器上我看到“Excel.Application”和“Excel.Application.12”，我怀疑您正在激活“Excel.Application”，如果您查看“Excel.Application”下的“CurVer”键。应用程序”它指向“Excel.Application.12”，在你的复制机器上检查这个值。

我的猜测是您正在启动 Excel.Application，如果目标计算机上存在 prog id，您可能希望强制它启动 Excel.Application.9。

这是一个小代码示例：

```
Type excel9Type = Type.GetTypeFromProgID("Excel.Application.9");
Type excelType = Type.GetTypeFromProgID("Excel.Application");

if (excelType == excel9Type)
{
    Console.WriteLine("Default Excel.Application is pointing to 'Verion 9' yay");
}
else
{
    Console.WriteLine("Excel is installed, but it's not 'Version 9'");
}

if (excel9Type == null)
{
    throw new InvalidOperationException("Excel.Application.9 is not a registered progid");
}

object excelApplication = Activator.CreateInstance(excel9Type);

// Cast excelApplication to whatever you are using as your application type. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T04:08:07.060

好的，所以在切换到 Phils 建议的 Activator 解决方案后，我检查了两台给出不同行为的机器。两台机器的 CurVer regkey 中都有 Excel.Application.9；但是一个从 11 开始，一个从 9 开始。到目前为止，我仍然有点茫然。

我在调试器中注意到，从 Excel.Application.9 返回的 Type 对象内部有一些 XL11 的证据。

有什么进一步的建议吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T20:43:24.237

Excel.Application.9 和 .11 的 progid 中的 Class ID Guids 在两台不同的机器上说什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T23:38:19.833

要获得特定的 Excel 版本，您可以使用直接启动二进制可执行文件

```
System.Diagnostics.Process process = System.Diagnostics.Process.Start(@"C:\Program Files\Microsoft Office\Office11\Excel.exe");
int processId = process.Id; 
```

这将为您提供 Excel 进程的 ID。您现在可以连接到这个 Excel 实例，并且可以通过调用来获取对象模型`AccessibleObjectFromWindow`。

此方法要求您使用 P/Invoke，并且您还必须首先获取 Excel 窗口的句柄。由于这是一项更多工作，我将简单地参考以下问题，其中详细描述了所有内容：

> **[如何使用后期绑定获取excel实例？](https://stackoverflow.com/questions/779363/how-to-use-use-late-binding-to-get-excel-instance/779710#779710)**

# php - 将错误作为异常处理。最好的方法？

> ID：455331
> 
> 赞同：3
> 
> 时间：2009-01-18T15:36:02.820
> 
> 标签：php, exception-handling

我试图弄清楚是否有比我在下面所做的更好或更好的方法来处理 PHP 中的错误。`parse_ini_file`如果调用有问题，我想抛出一个异常。这行得通，但是有没有更优雅的方法来处理错误？

```
public static function loadConfig($file, $type)
{
    if (!file_exists($file))
    {
        require_once 'Asra/Core/Exception.php';
        throw new Asra_Core_Exception("{$type} file was not present at specified location: {$file}");
    }

    // -- clear the error
    self::$__error = null;
    // -- set the error handler function temporarily
    set_error_handler(array('Asra_Core_Loader', '__loadConfigError'));
    // -- do the parse
    $parse = parse_ini_file($file, true);
    // -- restore handler
    restore_error_handler();

    if (!is_array($parse) || is_null($parse) || !is_null(self::$__error))
    {
        require_once 'Asra/Core/Exception.php';
        throw new Asra_Core_Exception("{$type} file at {$file} appears to be    
    }
} 
```

__`loadConfigError`函数只是将 设置`__error`为错误字符串：

```
private static function __loadConfigError($errno, $errstr, $errfile, $errline)
{ 
   self::$__error = $errstr;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T16:56:46.477

我通常会安装一个全局错误处理程序来将错误转换为异常：

```
function exceptions_error_handler($severity, $message, $filename, $lineno) {
  if (error_reporting() == 0) {
    return;
  }
  if (error_reporting() & $severity) {
    throw new ErrorException($message, 0, $severity, $filename, $lineno);
  }
}
set_error_handler('exceptions_error_handler'); 
```

在极少数情况下，我实际上想要收集一堆警告，我暂时关闭了上述处理程序。它在课堂上很好地打包：

```
/**
 * Executes a callback and logs any errors.
 */
class errorhandler_LoggingCaller {
  protected $errors = array();
  function call($callback, $arguments = array()) {
    set_error_handler(array($this, "onError"));
    $orig_error_reporting = error_reporting(E_ALL);
    try {
      $result = call_user_func_array($callback, $arguments);
    } catch (Exception $ex) {
      restore_error_handler();
      error_reporting($orig_error_reporting);
      throw $ex;
    }
    restore_error_handler();
    error_reporting($orig_error_reporting);
    return $result;
  }
  function onError($severity, $message, $file = null, $line = null) {
    $this->errors[] = $message;
  }
  function getErrors() {
    return $this->errors;
  }
  function hasErrors() {
    return count($this->errors) > 0;
  }
} 
```

# javascript - 如何检查对象是否在 JavaScript 中有键？

> ID：455338
> 
> 赞同：1646
> 
> 时间：2009-01-18T15:42:58.593
> 
> 标签：javascript, object

哪个是正确的做法？

```
if (myObj['key'] == undefined) 
```

或者

```
if (myObj['key'] == null) 
```

或者

```
if (myObj['key']) 
```

* * *

## 回答 #1

> 赞同：2913
> 
> 时间：2009-01-18T16:03:00.720

试试[JavaScript **in** operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/in)。

```
if ('key' in myObj) 
```

而反过来。

```
if (!('key' in myObj)) 
```

**当心！**`in`运算符匹配所有对象键，包括对象原型链中的键。

用于检查对象自己的键，只有在直接可用时`myObj.hasOwnProperty('key')`才会返回：`true``key``myObj`

```
myObj.hasOwnProperty('key') 
```

除非您有特定的理由使用该`in`运算符，否则 using`myObj.hasOwnProperty('key')`会产生大多数代码正在寻找的结果。

* * *

## 回答 #2

> 赞同：728
> 
> 时间：2009-01-18T15:44:20.027

你应该使用[`hasOwnProperty`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty). 例如：

```
myObj.hasOwnProperty('myKey'); 
```

**注意：**如果你使用的是 ESLint，上面可能会给你一个违反[no-prototype-builtins](https://eslint.org/docs/rules/no-prototype-builtins)规则的错误，在这种情况下，解决方法如下：

```
Object.prototype.hasOwnProperty.call(myObj, 'myKey'); 
```

# sql - 给定主键选择大量行

> ID：455342
> 
> 赞同：7
> 
> 时间：2009-01-18T15:45:51.910
> 
> 标签：sql, sql-server

我需要从一个更大的表中选择大量行，该表以自动增量标识列为键。我有我试图选择的每一行的主键值，但它可能非常大。

通常，但不总是，被选择的行是连续的，所以我实现了一种机制，将选择转换为一组范围子句，用于所有聚集在一起的条目（[PrimaryKey] BETWEEN 151 AND 217），并且一个后备方法，它使用 IN 子句选择所有孤立的条目。

最后我得到这样的东西

```
SELECT * FROM Table WHERE ([PrimaryKey] BETWEEN 151 AND 217) OR ([PrimaryKey] BETWEEN 314 AND 378) OR ...
OR [PrimaryKey] IN (1,3,7,14,147...) 
```

这对于我的范围很大但随着查询变大而崩溃的情况非常有用。我刚刚遇到了一个退化的案例，我有大量的“对”条目，一次生成 2 个条目的 BETWEEN 语句，在我放弃之前花了 15 多分钟试图描述执行计划。

首先想到的是，我可以将开始生成范围而不是单个值的阈值更改为大于 2（也许是 10？），但我想知道是否有更好的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-18T15:51:25.940

使用您要选择的值创建一个临时表并执行从主表到临时表的联接。这样你几乎没有限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T16:55:07.450

我能理解你的机制的意图。然而，在实践中，索引的存在和对优化器的信任通常更好。

如果要在 WHERE 子句中创建十几个条件，则查询引擎需要检查每个条件，直到找到匹配项。

同样，创建多个查询并将它们联合起来意味着对表进行多次索引扫描或索引查找。

然而，当列表很大时，IN 子句确实会变得非常慢。在这种情况下，使用连接通常更快。根据经验，这始终是我的首选。

然而，使用 BETWEEN 对于更大的范围确实特别有效。考虑到这一点，使用 UNION 机制可能是有益的，其中第一个 recorset 使用 JOIN，其余使用 BETWEEN，前提是 BETWEEN 的范围很大。

一个重要的考虑因素是准备此类查询的时间。如果 SQL Server 必须生成动态查询，使用 T-SQL，将会有两个开销；生成查询的时间，以及解析它的时间，然后生成执行计划。第一个将在大型列表中占主导地位，并且可能比使用 BETWEEN 节省的时间更多。

如果客户端生成动态查询，您可能会争辩说您正在将一些负载从服务器转移到客户端。尽管我仍然怀疑这些好处是否会显着。

因此，除非我看到非常显着的性能提升，否则我会坚持加入。主要原因是工程原因；
- 开发时间
- 代码的可靠性（简单总是更可靠的技巧）
- 代码的可维护性（后续维护者会理解这个技巧吗？）

如果您确实测试了 JOIN 和 BETWEEN 的各种组合，有或没有 UNION 等，我很想看看您的性能结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T16:00:44.687

正如用户 ocdecio 正确建议的那样，您可以加入一个包含所有 ID 的临时表。您还可以尝试将 OR 拆分为不同的**UNION**部分：

```
SELECT * FROM Table WHERE [PrimaryKey] BETWEEN 151 AND 217
UNION
SELECT * FROM Table WHERE [PrimaryKey] BETWEEN 314 AND 378
UNION
...
UNION
SELECT * FROM Table WHERE [PrimaryKey] IN (1,3,7,14,147...) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T15:00:07.687

这与我最近遇到的问题类似。我需要从表中选择与大量主键相交的那些行。问题是如何以一种快速有效的形式将大量密钥列表有效地发送到 SQL 服务器。

XML 数据类型非常适合这种情况。如果您创建一个采用 XML 类型参数的存储过程，您可以将输入预格式化为 XML 片段。例如，假设 XML 片段如下所示：

```
<a>
  <b>1</b>
  <b>3</b>
  <b>7</b>
  <b>14</b>
  <b>147</b>
</a> 
```

我给了元素短名称（“a”和“b”），因为更长的名称意味着从客户端传输到 SQL 服务器的字节数更多。以下是选择“b”元素的所有内容作为记录集的方法：

```
declare @x xml
set @x = '<a><b>1</b><b>3</b><b>7</b><b>14</b><b>147</b></a>'
select t.item.value('.', 'int') from @x.nodes('//a/b') as t(item) 
```

尽管语法很神秘，但可以像查询表一样查询 XML 类型。现在你应该看到这是怎么回事。如果我们可以像查询表一样查询 XML 类型，我们可以将其与另一个表相交：

```
select * from MyTable where ID in 
  (select t.item.value('.', 'int') from @x.nodes('//a/b') as t(item)) 
```

或使用连接

```
;with cte as
  (select ID = t.item.value('.', 'int') from @x.nodes('//a/b') as t(item)) 
select * from MyTable inner join cte on MyTable.ID = cte.ID 
```

您需要运行这两个版本以查看哪个版本对您的数据更快。我发现 JOIN 可以更快地处理我的数据。这是一个将 XML 类型作为输入并返回我们选择的行的存储过程：

```
create procedure MyProc @x xml as
begin
  set nocount on
  ;with cte as
    (select ID = t.item.value('.', 'int') from @x.nodes('//a/b') as t(item)) 
  select * from MyTable inner join cte on Table.ID = cte.ID
end 
```

新存储过程的示例调用：

```
exec MyProc '<a><b>1</b><b>3</b><b>7</b><b>14</b><b>147</b></a>' 
```

我还发现为输入片段添加 XML 模式有助于稍微加快存储过程。我不会在这里详细介绍 XML 模式，但想法是事先告诉 SQL XML 片段会是什么样子。以下是我们输入模式的方式：

```
create xml schema collection MyInputSchema as
  '<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="a">
      <xsd:complexType>
        <xsd:complexContent>
          <xsd:restriction base="xsd:anyType">
            <xsd:sequence>
              <xsd:element name="b" type="xsd:integer" maxOccurs="unbounded" />
            </xsd:sequence>
          </xsd:restriction>
        </xsd:complexContent>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>' 
```

现在我们可以将此模式与存储过程的输入相关联，如下所示：

```
create procedure MyProc @x xml(MyInputSchema) as
begin
  set nocount on
  ;with cte as
    (select ID = t.item.value('.', 'int') from @x.nodes('//a/b') as t(item)) 
  select * from MyTable inner join cte on Table.ID = cte.ID
end 
```

有了这一切，我就能够从我的客户端机器向 SQL 服务器发送一个包含 43,016 个字符的 XML 片段，并很快得到一个结果集。我对 10 个线程上的 1000 个请求进行了测试，总共有 10000 个请求。结果是每秒处理 72 个请求。当然，您的机率会因您的硬件和软件而异。

注意：此代码适用于 SQL 2005，也应该适用于 2008。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-17T15:05:47.360

您如何确定要选择的主键值列表？我想知道我们是否应该进一步研究这个“上游” - 是否有一些较早的查询或您运行的查询以到达密钥列表？如果是这样，也许您可​​以从中进行连接并完全跳过键查找。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-17T15:15:07.853

我的第一个想法是看看你是如何拉入密钥列表的。是来自其他地方的查询吗？如果是这样，您是否尝试过

```
SELECT * FROM Table WHERE [PrimaryKey] in
(
    SELECT PrimaryKey from SomeOtherTable where Condition = 'met'
) 
```

或者如果您的条件在同一张表中，那就更简单了

```
SELECT * FROM Table WHERE condition = 'met' 
```

当然，如果您的密钥都来自另一个来源（可能是您的应用程序），那么我个人会坚持使用之前建议的方法之一，或者可能硬着头皮使用一个大的 IN 子句。

顺便说一句 - 对不起，如果我教任何人吸鸡蛋，只是我的经验是，有时最简单的解决方案会被忽视。

# emacs - 在 Emacs 中，如何在 shell 命令中插入文件名？

> ID：455345
> 
> 赞同：20
> 
> 时间：2009-01-18T15:50:21.790
> 
> 标签：emacs

我经常使用 shell-command（默认绑定到 M-！），但我经常对我当前正在编辑的缓冲区做一些事情。与其键入缓冲区名称（在 shell 命令中没有文件名补全，唉！），最好有一个快捷键，比如 f3，以便在我按下该键时为我插入该名称。

问题是我不想全局绑定密钥（我在其他上下文中将 f3 用于其他事情），仅在 shell 命令提示时在 minibuffer 中。编写一个 lisp 函数来插入当前缓冲区名称很容易，但是我应该修改什么模式的键映射以将键绑定到该函数？

或者，是否有任何 lisp 代码/包在 shell 命令中提供文件名补全，类似于 bash 的做法？我知道普通的 Mx shell 可以完成，但是在 minibuffer 中输入命令的便利性很难放弃；）

**编辑：**

这就是我想要的，取自[huaiyuan](https://stackoverflow.com/questions/455345/in-emacs-how-to-insert-file-name-in-shell-command#455368)的回答，其中一些修复的灵感来自[http://osdir.com/ml/emacs.sources/2002-04/msg00022.html](http://osdir.com/ml/emacs.sources/2002-04/msg00022.html)

```
(define-key minibuffer-local-map
  [f3] (lambda () (interactive) 
       (insert (buffer-name (current-buffer-not-mini)))))

(defun current-buffer-not-mini ()
  "Return current-buffer if current buffer is not the *mini-buffer*
  else return buffer before minibuf is activated."
  (if (not (window-minibuffer-p)) (current-buffer)
      (if (eq (get-lru-window) (next-window))
          (window-buffer (previous-window)) (window-buffer (next-window))))) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T16:05:44.507

```
(define-key minibuffer-local-map
  [f3] (lambda () (interactive) (insert (buffer-name)))) 
```

### 编辑：

正如评论部分和其他地方所指出的，上面的代码片段不起作用。（抱歉，我应该在发布之前对其进行测试。:) 一些修复已经发布；这是另一个：

```
(define-key minibuffer-local-map [f3]
  (lambda () (interactive) 
     (insert (buffer-name (window-buffer (minibuffer-selected-window)))))) 
```

关于发出时的文件名完成`shell-command`，也许这个 kludge 会起作用（它在 Emacs 23.0.60 上适用于我）：

```
(require 'shell)
(define-key minibuffer-local-map (kbd "C-i") 'comint-dynamic-complete) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-18T17:19:56.837

以下是如何修复怀远的解决方案：

```
(define-key minibuffer-local-map [f3]
  (lambda() (interactive) (insert (buffer-file-name (nth 1 (buffer-list)))))) 
```

如果“其他”缓冲区没有设置文件名并且 (buffer-file-name) 返回 nil，您可能应该添加某种错误检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T16:16:52.987

关于您所问的确切内容，我将听从[huaiyuan](https://stackoverflow.com/questions/455345/in-emacs-how-to-insert-file-name-in-shell-command#455368)，但您也可以查看[通过 Emacs 中的 shell 命令过滤文本](https://stackoverflow.com/questions/206806/filtering-text-through-a-shell-command-in-emacs)作为一种可能的替代方法。

# c++ - 错误的“控制到达非无效函数的结尾”gcc警告怎么办？

> ID：455346
> 
> 赞同：6
> 
> 时间：2009-01-18T15:51:01.947
> 
> 标签：c++, gcc, warnings

```
$ cat t.cpp
int sign(int i) {
    if(i > 0) return 1;
    if(i == 0) return 0;
    if(i < 0) return -1;
}
$ g++ -c t.cpp -Wall
t.cpp: In function ‘int sign(int)’:
t.cpp:5: warning: control reaches end of non-void function
$ 
```

我该怎么办？

停止使用 -Wall 因为它显然是错误的？最后添加一个虚假的返回0？用“else”子句弄乱代码？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-18T15:58:34.473

如果您不想添加“else”子句，因为它们会使代码更长，那么也许您想删除最后的“if”并使代码更短：

```
int sign(int i) {
    if(i > 0) return 1;
    if(i == 0) return 0;    
    return -1; // i<0
} 
```

或者，如果您真的在自己计算“符号”，并且这不是一些较长示例的简化：

```
int sign(int i) {
    return (i>0) ? 1 : ((i<0)?-1:0);
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-18T16:01:44.750

你的`sign()`功能不是很有效。试试这个

```
int sign(int i) {
    return (i > 0) - (i < 0);
} 
```

资料来源：[Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-18T17:36:28.350

在这种情况下，我会寻求解决方案：

```
int sign(int i)
{
    if (i > 0)
        return 1;
    else if (i == 0)
        return 0;    
    else
        return -1; // i<0
} 
```

也就是说，我将添加两个 else 子句 - 使代码更加对称，而不是因为它对生成的目标代码有任何影响。

我做了一些实验。我期望使用三元运算符的单行版本两次生成与更长的代码相同的代码。但是，使用 GCC v4.3.2 在 Solaris 10 (SPARC) 上进行的测试表明，三元运算符版本始终比“if”版本小 12-16 个字节。但是，是否存在额外的 else 并没有区别。（正如我所料，添加寄存器没有任何可能性。） *补充*说，我还用'return（i> 0）-（i < 0）；'查看了克里斯托夫的解决方案。- 我以前没见过的变种。代码大小为：

```
 Unoptimized     Optimized (-O5)
 if      166             110
 ?:      150              98
 >-<     122              98 
```

这主要表明测量是个好主意！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T00:02:40.487

`else`子句不是“杂乱无章”的，它们是表达您意图的更明显的方式。

# c - 检测 WAN 无线电电源关闭

> ID：455360
> 
> 赞同：2
> 
> 时间：2009-01-18T16:01:13.330
> 
> 标签：c, winapi, wifi

像大多数笔记本电脑一样，我的（戴尔 Inspiron 1420）有一个小按钮，可用于打开和关闭 wifi 卡。有什么方法可以检测到在 Win32 C 程序或服务中无线电已关闭？我正在寻找一种比获取可见接入点列表更好的方法，这仅取决于该按钮的状态。

*更新*- 解决方案是使用 Windows 服务监视硬件事件。[您可以在此处](http://www.codeproject.com/KB/system/Windows_Services.aspx)获得一些执行此操作的代码。

*更新 2* - 经过更多研究后，似乎在您按下无线电关闭开关时为蓝牙设备发送了硬件事件。因此，硬件监控仅适用于同时具有内部蓝牙和 wifi（可能在同一张卡上）的笔记本电脑。我从来没有找到解决这个问题的明确方法，不得不接受基于蓝牙的启发式方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T16:15:55.390

我认为它只是禁用了 Windows 中的卡 - 这与检测设备管理器中是否有当前禁用的 WLAN 卡不同吗？

我是一名 VB 程序员，所以我无法提供具体细节，但只是想给出一个开始的地方。

# sql-server - Excel 数据连接可以锁定数据库表吗？

> ID：455365
> 
> 赞同：1
> 
> 时间：2009-01-18T16:02:54.777
> 
> 标签：sql-server, database, excel

如果我将一个简单的 Sql Server 表数据连接添加到 Excel 工作表，如果连接从未关闭，它是否可以锁定该表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T16:20:58.157

通常的答案：是的，但这取决于情况......

..主要取决于您的数据库采用的锁定策略（再次取决于配置）。我的假设是 Excel 会打开与数据库的“常规”连接。如果您现在查询一个表，如果您有悲观锁定策略，那可能已经锁定了该表。

希望这会有所帮助.. 与许多数据库系统相关的锁定有大量信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T18:03:36.263

尽管我认为可以锁定表格，但我会说 Excel 通常不会，因为您只是在选择数据。如果您尝试更新某些内容，请确保您会锁定基础表，但只要您只是查看数据，就应该没问题。

为了确保，为什么不对系统中用户较少的表进行一些测试，或者可能是另一个数据库中以相同方式配置的表？然后您可以在 SQL Server 上使用 SP_LOCK 来查看您的 Excel 连接是否已锁定表，或者您可以尝试对您的表执行另一个查询以查看它是否被阻止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:00:22.150

微软论坛上也提出了类似的问题。根据那篇文章，默认情况下，Excel 会要求对表中的行进行完全锁定。所以，是的，它可以锁定桌子。

MSDN 帖子讨论了 SQL 2005 中可用的各种隔离级别，因此如果您正在运行该版本，这可能会很有用。

[MSDN上的类似问题](http://social.msdn.microsoft.com/Forums/en-US/sqldataaccess/thread/2fab026f-16d0-443e-a447-4a544a26269e/)

[MSDN 的隔离级别](http://msdn.microsoft.com/en-us/library/ms189122%28v=sql.90%29.aspx)

[有关隔离级别的更多信息](http://msdn.microsoft.com/en-us/library/ms173763%28v=sql.90%29.aspx)

# php - 你能在 Perl 文件中包含 PHP 吗？

> ID：455369
> 
> 赞同：4
> 
> 时间：2009-01-18T16:05:49.157
> 
> 标签：php, perl

我有一个由其他人用 Perl 编写的页面。我不知道 Perl，所以我写了一个 PHP 文件，现在只是从 Perl 页面链接。如果 perl 页面已经传递了某个变量，我想做的是在 Perl 文件中嵌入 PHP 文件。如果我同时使用 PHP，我可以这样做

```
if ($_GET['sidebar']) include "embedded.php"; 
```

我知道有一些方法可以在 Perl 中读取文本文件，但是我可以在 Perl 文件中包含 PHP 文件吗？

我假设它不起作用，因为它们是由服务器的不同部分处理的，所以没有很高的期望，但也许有人尝试过类似的东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-18T16:54:07.653

如果您只是想将 PHP 脚本的结果输出（HTML 等）包含到 perl 生成的页面中，您可以使用反引号通过 php-cli 调用 PHP 脚本，如下所示：

首先，test.pl 脚本：

```
[root@www1 cgi-bin]# cat test.pl
#!/usr/bin/perl
print "This is a perl script\n";
my $output = `php test.php`;
print "This is from PHP:\n$output\n";
print "Back to perl...\n";
exit 0; 
```

接下来，test.php 脚本：

```
[root@www1 cgi-bin]# cat test.php
<?php

echo "PHP generated this";

?> 
```

这是运行“test.pl”的输出：

```
[root@www1 cgi-bin]# perl test.pl
This is a perl script
This is from PHP:
PHP generated this
Back to perl... 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-18T16:11:11.063

有[PHP](http://search.cpan.org/perldoc?PHP)和[PHP::Interpreter](http://search.cpan.org/perldoc?PHP::Interpreter)模块，它们都有一个`include`方法。不过，我自己都没有尝试过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T18:37:57.757

Perl 解释器可以执行 Perl 语法命令，尽管 Perl 和 PHP 语法有一些相似之处，但您需要一个 PHP 解释器来运行 PHP 代码。相反，您可以使用一些 Perl 命令来使用 PHP 脚本的输出。您应该在 Perl 代码中使用系统 PHP 解释器执行 PHP 脚本，然后使用该执行的输出。您的 PHP 代码需要是一些命令行代码，它将返回（如回显或打印）输出。如果您需要将参数传递给 PHP 代码，请在您的 Perl 代码中执行 PHP 脚本时使用命令行参数。所以你的 Perl 代码将是这样的：

```
 // your code before PHP call
 $php_output = `php /path/to/php/script -param1 -param2 -param3`;
 // your code after PHP call 
```

并且您的 PHP 脚本可以接收如下参数：

```
<?php
// argv() is defined by PHP and contains all command line params
$params = argv();
// first index of argv is the name of the PHP script you are running.
array_shift($params);
// now you have all parameters.
// your code here generates some results.
echo $resutls;
?> 
```

我不是 Perl 程序员，所以可能有其他（更好的）方法可以在 Perl 中执行外部程序。但一般步骤是这样的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T16:11:26.210

你可以看看这个项目：

[http://metacpan.org/pod/PHP::包括](http://metacpan.org/pod/PHP::Include)

> **HP::Include**建立在 Filter::Simple 和 Parse::RecDescent 的基础上，提供了一个 Perl 实用程序，用于包含来自 Perl 程序的非常简单的 PHP 文件。
> 
> 在使用 Perl 和 PHP 时，能够在用两种语言编写的程序之间共享配置数据通常很方便。一种解决方案是使用独立于语言的配置文件（我听到有人说 XML 吗？）。另一种解决方案是利用 Perl 的灵活性来读取 PHP 并将其重写为 Perl。PHP::Include 在 Filter::Simple 和 Parse::RecDescent 的帮助下将非常简单的 PHP 重写为 Perl。
> 
> Filter::Simple 用于启用宏（目前只有一个），这些宏会导致 PHP 被插入到您的 Perl 源代码中，然后使用 Parse::RecDescent 语法对其进行解析以生成适当的 Perl。
> 
> PHP::Include 旨在允许更具冒险精神的人添加语法，以扩展可能包含的 PHP 复杂性。

# uml - 用例图——箭头是绝对必要的吗？

> ID：455373
> 
> 赞同：7
> 
> 时间：2009-01-18T16:07:52.363
> 
> 标签：uml, diagram, use-case

在用例图中是否绝对有必要使用“箭头”来显示参与者和用例之间的关联？

我最近不得不为我的软件工程作业画一张。但是，在对来自许多其他大学的许多文章、论文、在线书籍和讲义进行了一些在线研究之后，似乎大多数用例图，无论它们有多少潜力显示某种“流程”或“可导航性” "，没有箭头，而有些例子有箭头。

所以我咨询了我的朋友，他是最后一年的学生，并且已经研究了我告诉我的我的演员和用例之间不应该有箭头，甚至他的需求工程讲师也教学生不要使用箭头。所以我有意识地决定不使用箭头，而是使用实线来显示我的用例关联。

这是我的图表-[点击](http://i41.tinypic.com/2ccuo90.jpg)

然而，当我收到作业的分数时，我惊讶地发现我因为不使用箭头而得了零分。即使强制使用它们，也有大量证据表明实线可用于双向关联。所以我不应该得到至少一些分数吗？

显然，我要求我的讲师做出解释，我将在下周见到他来讨论这一点，但如果她告诉我我应该使用箭头，我能提出什么反对意见？如果有人可以适当地参考一些专业资源，给我很好的建议，我将不胜感激。

非常感谢您的阅读，我希望尽快阅读您的回复。

* * *

**编辑**

谢谢你们。我真的很感谢你给我的答案。这整个混乱开始了，因为讲师提供的唯一符号是一个单一的、非常简单的图书馆用例图示例，其中一个讲义有箭头。但并不清楚它是否是最终的符号。我不认为它是强制性的另一个原因是因为在解释绘制数据流图的符号时，她非常清楚地使用了她的特定符号，但 DFD 有不同的符号并不少见不同的来源，而我发现很少有证据表明在用例图中使用箭头是必要的。

也就是说，即使在没有箭头的情况下，我记得在辅导课上问过一位导师（不是讲师），有箭头线和实线有什么区别，他说没有，我可以同时使用。显然，我只有我的话，从你们所说的来看，我怀疑任何处于学术地位的人都会承认说出可能使他们处于防御位置的事情。我的错误是没有直接与讲师交谈，但事后看来我显然会这样做。

无论如何，我会就所有这些信息与她交谈，并要求她考虑到这个“诚实的错误”。不仅是用例图，还有其他几个问题，我的分数不寻常，尤其是当我的答案与她提供的模型答案几乎相同时。我也知道很多其他要求他们的作业的学生都被评论了。

希望她会善良并使用良好的判断力来提高我的分数。当我发现时，我会回到这里。

再次感谢您的帮助，请发布您可能拥有的任何其他信息/建议。:)

* * *

**编辑 2**

对不起各位，我还有一个问题。

这是作业中给出的用于绘制用例图的场景。

> CONTHETICKET 是一家经营音乐会和剧院门票的票务代理机构。**音乐会和剧院场地为 CONTHETICKET 提供关于即将举行的活动的源源不断的信息流，**然后经理使用这些信息来编制一份固定清单，供销售人员使用，以响应客户的电话。经理选择了一些活动，CONTHETICKET 将为其提前购买多张门票，从而从与场馆协商的折扣中受益。
> 
> 他亲自将门票订单连同约定的款项一起发送到场馆，一旦收到门票，他就会将其归档在门票档案中。
> 
> 当客户打电话给销售团队时，他们的票证请求将根据票证文件进行检查。如果有预购票，则将它们放入标有客户姓名和地址的信封中，并归档在临时订单文件中。如果没有，销售团队会填写一张票务申请表并将其放入托盘中，以供邮递员收集。
> 
> 付款部分每天检查临时订单文件。他们向客户发送发票并等待付款。发票的副本保存在档案中。收到付款后，付款部分会将付款与相应的发票进行匹配，如果满意，则将发票的另一份副本放入发货文件中，并附上发送机票的说明。
> 
> 邮递员每天检查发货文件并从临时订单文件中检索相应的票证并将其发送给相应的客户。

正如您从我的[图表](http://i41.tinypic.com/2ccuo90.jpg)中看到的那样，我有一个“音乐会和剧院场地”作为演员。

来自 UML 2.0 风格的元素，Scott W. Ambler：

“参与者是在与您的系统的一个或多个交互中发挥作用的个人、组织或外部系统（参与者通常在 UML 用例图上绘制为简笔画）。”

然而，在我的标记作业中，讲师评论说它不应该是演员。你能告诉我你是否认为它应该是一个演员，为什么。

我的理由是 CT&V 提供事件信息，然后经理使用这些信息来订购/归档门票，也由 CT&V 提供。

非常感谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T17:18:06.390

# 好消息

你的图表是正确绘制的，你的老师是错误的：

*   箭头在用例关联中不合适，因为它们是二元关联
*   Extends、Includes 和 Uses 关系需要箭头 - 请参阅[此图](http://www.visual-paradigm.com/VPGallery/diagrams/UseCase.html)以获取所有这三个关系的示例

[UML 规范 v1.4.2](http://www.omg.org/docs/formal/05-04-01.pdf) [PDF 警告]第4.11.3 节格式良好规则和 5.42.2 二进制关联在以下几点上非常清楚：

> 4.11.3 格式良好的规则：“参与者只能有与用例、子系统和类的关联，并且这些关联是二元的。”

> 5.42.2 二元关联：“二元关联被绘制为连接两个分类符号的实心路径”

# 坏消息

话虽如此，如果您的老师告诉您使用箭头而您没有使用，那么您可能没有追索权 - 这是学术界的缺点之一：一些教授希望学生仅仅反刍他们被告知的内容，即使它是错误的. 你可以向系主任提出上诉，辩称教授对学生的指导违反了既定标准，但这很可能只会给你带来悲伤。不过，我确实认为你会有一个强有力的案例，因为在正确的图表上给你一个零，因为你没有画出不正确的箭头，这似乎过分、苛刻和不合理。

但是我遇到过那些*总是正确*的教授，即使他们显然是错误的。然而，大多数是理性/合乎逻辑的人，他们乐于适当地纠正错误信息。

# 注意：轻踩

假设这是一个诚实的错误，并要求教授解释为什么当官方 OMG UML 规范说不使用箭头时他期望箭头（因此*每个*符合用例的 UML 工具都*不会*在二元关系上绘制箭头）。如果你在那里开枪，你可能会或可能不会得到满足，但你也可能会产生敌意，这可能会使学期的剩余时间（甚至可能超过）变得非常不愉快。

编辑：我确实相信旧的工具和标准在用例图上使用单箭头（不是三角形或填充，只是“翅膀”），但现在不再这样做了。也许教授的标准 - 或软件 - 刚刚过时;-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T18:27:57.900

其他人都已经回答了关于箭头的事情。让我给你一些关于学术界的建议。

你学到的大部分技术知识要么是错误的，要么就是无用的。在您的职业生涯中，您将作为专业人士使用的任何东西都将是您在那里学习的东西，然后根据该情况的特定需求来学习。

你将学到的是事物的一般概述，这是你在职业生涯中不会学到的东西，因为没有人有时间这样看待它。在那里，您将使用错误的工具来解决错误的问题，通常是因为一些愚蠢的原因，例如“因为上级决定那样做”。

所以把它当作学习经验。要成为一名成功的专业人士，您只需要了解正确的做事方式是一件很难实现的事情，而在这种情况下，您自己做这件事可能会给您带来更多的麻烦，而不仅仅是得分为零。

练习做错误的事情来实现你的目标：做箭头的事情并得到你的分数。

整合每个人（包括您）总是会出错的知识：不要把您的教导说成是什么，阅读其他观点并在您有经验后形成意见。

练习参与政治方面的艺术，以便在此类问题上发表意见。有一种方法可以让其他人做正确的事情，但这需要大量的社会工程和艰苦的工作。

只是不要浪费你的时间。有些事情不值得努力纠正......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T16:36:48.267

虽然很不幸，但我必须坚持“如果他们是这样告诉你的，而你没有那样做，那就是你得到的分数”。

根据我的经验，这种关系可能是单向的，也可能是双向的，所以我认为你必须区分这两者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T03:19:59.840

你的导师因为在你的使用图中没有使用箭头而给你一个 0，这是他教你关于软件工程的错误知识的一个例子。

Creating a spec for a software product, out in the real world, is not getting your arrows right.

It's about creating a living document that forms the foundation behind your project. The key aspects of any spec is that:

1.  The project team actually reads it
2.  The document is effective at capturing your intent

The idea that what you should be learning is how to draw in your arrows the right way is ridiculous. If you get a chance, you should read this article:

[http://www.joelonsoftware.com/articles/fog0000000024.html](http://www.joelonsoftware.com/articles/fog0000000024.html)

It captures my sentiments excellently.

It sounds like to get through your class you need to pretend to be interested in UML arrows. My advice to you is:

1.  Do what is necessary to get a good grade in the class
2.  The second you finish the final exam PLEASE forget everything you learned in that class, because it's only going to harm you.
3.  Pickup up a copy of [this book](https://rads.stackoverflow.com/amzn/click/com/1590593898), and read it. The whole thing.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T16:37:11.057

[看这里：](http://www.agilemodeling.com/style/useCaseDiagram.htm#Relationships)

指示调用来源的箭头是可选的，因此它似乎由您的讲师自行决定，但这可能是一个有争议的观点。

顺便说一句，在我的经验中，研究生院是学习软件工程的最糟糕的地方。YMMV。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T16:50:51.060

我认为你在这里有强有力的理由;）

引用当前的[UML 规范 (2.1.2)](http://www.omg.org/spec/UML/2.1.2/Superstructure/PDF/)

> 第 595 页，约束，2
> **用例只能参与二进制关联。**

考虑到这一点，在*关联*上显示可导航性有什么意义？由于主体之间的交互（例如用例和参与者）根据定义是双向的（例如参与者做某事，系统响应等等）。

您还将在本文档中找到示例用例图来进一步说明您的观点。

当然，对于其他用例结构（例如*包含*和*扩展*箭头）来说是有意义的并且是必需的。但是，从您包含的用例图中，您没有使用这些，不应该因此受到惩罚。

祝你好运

PS：使用我选择的 UML 建模工具 Enterprise Architect，它不允许我直观地指示关联上的可导航性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T01:49:06.187

谢谢你们。我真的很感谢你给我的答案。这整个混乱开始了，因为讲师提供的唯一符号是一个单一的、非常简单的图书馆用例图示例，其中一个讲义有箭头。但并不清楚它是否是最终的符号。我不认为它是强制性的另一个原因是因为在解释绘制数据流图的符号时，她非常清楚地使用了她的特定符号，但 DFD 有不同的符号并不少见不同的来源，而我发现很少有证据表明在用例图中使用箭头是必要的。

也就是说，即使在没有箭头的情况下，我记得在辅导课上问过一位导师（不是讲师），有箭头线和实线有什么区别，他说没有，我可以同时使用。显然，我只有我的话，从你们所说的来看，我怀疑任何处于学术地位的人都会承认说出可能使他们处于防御位置的事情。我的错误是没有直接与讲师交谈，但事后看来我显然会这样做。

无论如何，我会就所有这些信息与她交谈，并要求她考虑到这个“诚实的错误”。不仅是用例图，还有其他几个问题，我的分数不寻常，尤其是当我的答案与她提供的模型答案几乎相同时。我也知道很多其他要求他们的作业的学生都被评论了。

希望她会善良并使用良好的判断力来提高我的分数。当我发现时，我会回到这里。

再次感谢您的帮助，请发布您可能拥有的任何其他信息/建议。:)

# c# - 更新对象后刷新 wpf 数据绑定

> ID：455376
> 
> 赞同：3
> 
> 时间：2009-01-18T16:10:14.340
> 
> 标签：c#, wpf, data-binding, xaml

我在连接到视图的演示者中有一个对象。在我的 XAMTL 中，我有以下内容：

```
<Label Content="{Binding ElementName=PSV, Path=Presenter.Portfolio.Name}"/> 
```

现在，当创建控件时，Portfolio 为空，然后我运行另一个设置 Portfolio 的方法。我已经实现了 INotifyPropertyChanged 但到目前为止，我无法触发连接到绑定。

有人可以给我提示吗？我可以绑定到属性的属性吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-14T14:50:52.830

绑定始终适用于您需要将 Presenter 设置到本地 DataContext 中的 DataContext。例如，您可以在 Window 或 UserControl 的构造函数中执行此操作：

```
this.DataContext = new Presenter(); 
```

然后您的绑定将更改为：

```
<Label Content="{Binding ElementName=PSV, Path=Portfolio.Name}"/> 
```

以前路径的 Presenter 部分隐含在 DataContext 中。

这样，DataContext 正在监视 NotifyChanged 事件，并在 Portfolio 从 null 变为具有值时正确更新视图。

在回答问题的最后一部分时，绑定到属性的属性确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T16:36:10.623

也许 [http://msdn.microsoft.com/en-us/library/system.windows.data.bindingoperations.getbindingexpression.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingoperations.getbindingexpression.aspx) 和 [http://msdn.microsoft.com/en-us/library/system.windows.data .bindingexpression.updatetarget.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingexpression.updatetarget.aspx) 帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T17:17:45.110

如果您已`INotifyPropertyChanged`正确实施，这将正常工作。一些事情要尝试：

1.  尝试在演示者的构造函数中设置一个带有虚拟名称的虚拟投资组合，以便确保绑定实际上是正确的。
2.  如果在 #1 之后它仍然不起作用，请在输出窗口中查看任何绑定错误。
3.  如果它在 #1 之后确实有效，请确保您设置的投资组合在构建时具有名称。如果没有，您的投资组合类还需要在设置`INotifyPropertyChanged`时实现并引发事件`Name`。

失败了，请发布您的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T22:01:00.560

既然您已经实现了 INotifyPropertyChanged，您是否确保在 Portfolio.Name 设置器中触发 PropertyChanged 事件？

```
string _name;
public string Name
{
get 
{
   return _name;
}
set
{
   _name = value;
   // Alert the databinding engine about changes to the source value
   OnPropertyChanged("Name");
}

void OnPropertyChanged(string propertyName)
{
   if (PropertyChanged != null)
      PropertyChanged(propertyName);
}

#region INotifyPropertyChanged members
public event PropertyChangedEventHandler PropertyChanged;
#endregion 
```

# ruby - 如何测试 Ruby 对象是否不可变？

> ID：455379
> 
> 赞同：5
> 
> 时间：2009-01-18T16:12:44.133
> 
> 标签：ruby, immutability

有没有一种简单的方法来测试一个对象是否是不可变的（数字，零）（数组，哈希，对象）？换句话说，它会被其他代码的副作用改变吗？

动机：我想创建一个版本化的值存储，但有些数据是数组。一些数组将存储自定义对象，我可以通过存储“in”属性并搜索它来反转关系。但我也希望能够存储符号数组、其他数组等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-18T16:35:56.473

我发现了一种低效的方法：

```
class Object
  def primitive?
    begin
      self.dup
      false
    rescue TypeError
      true
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-18T16:53:57.013

Ruby 中没有原始对象。因此，这不能以直接的方式检测到。

您不能简单地将 Marshal 或 YAML 用于您的版本化存储吗？然后，您将免费加载和保存所有对象类型。为什么要重新发明轮子？

我不知道你想要实现什么，但是查看 YAML 的源代码可能会很有趣，看看他们如何处理这个问题。Ruby YAML 编码实现只是`to_yaml`为所有相关类实现了该方法。请参阅[yaml/rubytypes.rb](http://github.com/why/syck/blob/5debcaad95cd5d4ba5b35ed2ef5fd674fba10426/ext/ruby/lib/yaml/rubytypes.rb)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T20:53:29.793

可变性的概念在 Ruby 中的应用方式与在其他语言中的应用方式不同。唯一不可变的对象是冻结的对象。您甚至可以将方法和实例变量添加到 Fixnums。例如：

```
class Fixnum
  attr_accessor :name
end
1.name = "one"
2.name = "two" 
```

显然，绝大多数时候，人们不会病态到给 Fixnum 添加属性，但关键是，没有一个解冻对象是真正不可变的。

如果你能想出一个你想假设是不可变的类的规范列表，你可以通过并给它们一个`immutable?()`返回 true 的方法（和 Object 一个返回 false 的版本）。但就像 wvanbergen 所说，确保您的对象副本不会更改的最佳方法是使用 Marshal 对其进行深度复制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T20:44:48.843

另一个区别：本机不可变对象不能被冻结，但它们仍然从冻结​​返回 false？

```
5.freeze.frozen? == false 
```

冻结不会引发异常（与 dup 不同）但是它会（永久！）修改可变对象。

我发现我可以（至少在当前状态下）安排我的应用程序处理冻结的对象，如果我尝试直接修改它们，ruby 会给我一个例外。但是**freeze 只影响 object 的第一层**，存储在其中的数组等仍然可以修改。

这仅适用于 1.8 - 5.frozen？在 ruby​​1.9 中返回 true（但在 irb1.9 中不返回）

# c# - 我可以在 C# .NET 中做哪些好的示例桌面应用程序项目

> ID：455389
> 
> 赞同：4
> 
> 时间：2009-01-18T16:18:19.707
> 
> 标签：c#, .net

我可以编写哪些好的桌面应用程序项目，这是一种很好的做法？我浏览了 .NET Framework 命名空间结构，确定了一些我没有使用过的命名空间和类，这样我就可以想出一个或两个项目来使用它们来创建。

但是，我在考虑具有实际用途的项目时遇到了麻烦。

我想听听涵盖这些标准的项目的想法：

1.  使用 .NET Framework 中的许多命名空间
2.  成为“真实”：如果它没有真正的实际用途，我发现很难进入
3.  如果所有提交的项目的总和几乎涵盖了与桌面应用程序相关的每个命名空间，那将是理想的（我的目标很高）

此处的目的是让自己接触到 .NET 框架的大部分内容，以便成长为一名开发人员。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T16:30:15.813

从我的头顶一对夫妇：

加载提要并将它们保存到数据库的 RSS 聚合器。然后向它添加一些搜索和过滤，您应该进入几个不同的命名空间。在我的脑海中，System、System.Net、System.XML、System.Data、System.Linq、System.Collections.Generic、System.Threading、System.Configuration（如果你想要配置文件）、System。印刷。

我花了一些时间研究的一个项目是一个基于 IDictionary 的对象，它是一种配置工具，我可以使用它来将配置设置存储到数据库中。每次我到达“中途”标记时，我最终都会发现更多我需要的功能并添加到其中。它的命名空间使用非常有限，但这是一项具有挑战性的练习，从长远来看你会发现很多用途。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T16:27:41.873

担心您将使用框架的多少 API 作为选择要开发的应用程序的标准，这很奇怪，

但是，如果您必须有答案，也许您可​​以考虑创建一种类似 Outlook 的应用程序，您可以在其中使用：

*   系统：这很简单。
*   System.Drawing：控件的自定义绘图，日历绘图。
*   System.Diagnostics：调试和代码分析的东西。
*   System.Globalization、System.Resources：用于国际化。
*   System.IO：您需要保留电子邮件、便笺等数据的地方。
*   System.Security：敏感个人电子邮件、约会等的加密。
*   System.Media：用于播放基于音频的附件的内置简单媒体播放器？
*   System.Net：检索电子邮件，还有什么。
*   System.Text：文本处理，你几乎总是需要这个。
*   System.Threading：在大多数现实世界的应用程序中，您很少会逃离线程。
*   System.Timers：可能每隔 x 分钟就会在某个地方检查一次您的电子邮件……
*   System.Configuration、System.Data：您可能需要持久化应用程序配置，部分使用 System.Configuration 命名空间，部分使用本地 sql 服务器。
*   System.Collections：您几乎肯定需要使用的一些数据结构。
*   System.Management：在关于窗口中显示 CPU 资源状态或磁盘空间指示器。

此外，它的一部分可以在 WPF 中开发，假设您有一个功能，您可以为人们生成图表以可视化他们的日常电子邮件/约会活动。您可能还会了解 Windows CardSpace，因为它肯定会涉及身份管理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T16:27:01.513

我目前正在编写一个应用程序，它是个人资金管理器（如 microsoft money），我打算试用 dot net 的很多部分，包括以下内容

*   WPF
*   WCF
*   SQL 服务器
*   标准泛型
*   安全
*   Linq 对数据和 sql 数据的查询

我认为这对我来说是一个不错的开始。我有很多东西要学，而且在工作中不能经常使用所有这些项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T16:27:52.137

简短的回答是找出差距并填补它；例如，您可以编写一个应用程序来渲染和打印来自[OpenStreetMap](http://www.openstreetmap.org/)的地图。

这将涵盖实现 REST 客户端、图形区域中的大量内容以及打印总是有用的。这有一个现实世界的用途（哎呀，您甚至可以开源结果以与其他 OSM 编码器共享）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T16:31:11.193

如果您正在寻找*真正的*.NET 桌面应用程序，我会考虑下载众多**开源**项目之一。例如，Dare Obasanjo 和其他人编写的免费**RSS 提要聚合器。**

[RSS 强盗](http://rssbandit.org/)

我还想看看[MSDN上的](http://msdn.microsoft.com/en-us/vcsharp/aa336742.aspx)[**C# starter kit 应用程序**](http://msdn.microsoft.com/en-us/vcsharp/aa336742.aspx)：

*   支持亚马逊的电影收藏入门套件
*   纸牌游戏入门套件
*   教师入门套件

以下是一些用 C# 编写的开源软件综合列表的链接：

*   [http://csharp-source.net/](http://csharp-source.net/)
*   [CodePlex](http://www.codeplex.com/site/search?TagName=C%23)（标记为 C#）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T16:39:55.733

我目前正在为 MS Project 编写扩展。.NET Visual Studio 让它变得太容易了，我玩得很开心。所以，我想说为一些 MS 应用程序编写一个有用的扩展......他们需要它！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-18T16:48:01.427

用于管理特定业务领域的文章和客户的桌面应用程序！（例如，它可以是一个图书馆，其中文章主要是书籍，您必须为客户开发 2 个 UI，为管理员开发另一个 UI！让用户有可能进行研究以找到特定的图书，了解库存图书的数量、图书的价格、同一作者的图书在该图书馆可用等。您还可以通过添加帮助图书馆所有者了解其客户的实际需求一个反馈系统，用户将在其中推荐他最喜欢的书（如果图书馆里没有！），顺便说一下，您可以让经理查看一些统计数据，以便找出最喜欢的书最高要求等

该项目将涉及许多 .NET 功能，例如：

Winforms / WPF WCF SQL server Regex XML 序列化 Security Linq ...

# c - windows下格式化文件

> ID：455408
> 
> 赞同：1
> 
> 时间：2009-01-18T16:31:40.537
> 
> 标签：c, windows, linux, file, file-io

按照[我](https://stackoverflow.com/questions/455297/creating-big-file-on-windows)关于创建文件的问题。
快速创建大文件后，现在我需要在这个文件上创建一个文件系统。我如何在 Linux 上创建类似[Loop 设备的东西。](https://en.wikipedia.org/wiki/Loop_device)在此之后，我猜格式化将非常容易。欢迎使用任何替代方法（而不是安装）将文件格式化为不同的 FAT（12/32）和 ext3 :)

我更喜欢用 C/C++ 来做，但在最坏的情况下，我可以使用外部命令，即从我的应用程序运行准备好的可执行文件。

**编辑：**
似乎Windows本身不允许这样做，因此最好找到一些**完全**执行 此操作的应用程序，即将文件挂载为文件系统。否则我对开源许可证有疑问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T22:17:14.273

看看[TrueCrypt 的源代码](http://www.truecrypt.org/)。它是适用于 Windows Vista/XP、Mac OS X 和 Linux 的开源磁盘加密软件。它可以在文件中创建虚拟加密磁盘并将其作为真实磁盘安装。

因此其源代码必须包含“在此文件上创建文件系统”部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T12:42:04.103

[Eldos](http://eldos.com/)制作了一个组件，即[实体文件系统](http://eldos.com/solfs/)，可以满足您的需求

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T12:38:08.030

这不是一个真正的答案，但可能足以让您感兴趣：

Windows 7 应该能够[从 VHD（虚拟硬盘）启动，](http://blogs.technet.com/aviraj/archive/2009/01/18/windows-7-boot-from-vhd-first-impression-part-2.aspx)因此如果您寻找类似 Windows 的方法来解决此问题，这可能会引导您朝着正确的方向前进。

# version-control - 你为你的家庭项目使用源代码控制吗？

> ID：455409
> 
> 赞同：9
> 
> 时间：2009-01-18T16:32:28.150
> 
> 标签：version-control

人们发表评论的一个简单问题，以及他们的选择是什么以及为什么。

看看是什么促使您使用它也会很有趣？对我来说，我使用源代码管理，以便

*   我在工作中使用相同的，所以我可以熟悉*如何*使用它
*   如果我把代码搞砸了，我会得到保护，因为可以回去
*   它在异地，因此如果我的电脑死机，我不会丢失所有家庭代码项目。

对我来说，我使用 Perforce，简单的 2 客户端“演示”版本。这是因为我们最近在工作中从使用 IBM Rational Clearcase 转向了它。到现在为止还挺好！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-18T16:37:07.687

我使用 git 和 Subversion - git 用于我的 C# Protocol Buffers 端口（我在工作时间使用，但使用家用笔记本电脑）和 Subversion 用于其他一些事情。

我曾经在本地 NAS 服务器上拥有我的 Subversion 存储库，但我最近将其移至 csharpindepth.com，主要是为了让 NAS 退役，但也可以从家外轻松访问它，而无需在防火墙上打孔.

至于为什么：

*   万一我的笔记本电脑死了
*   如果我想回到早期版本
*   所以我可以跟踪我所做的事情
*   这样其他人也可以参与（例如，Marc Gravell 为 MiscUtil 贡献了很多东西）
*   在适当的地方分支

我还使用 Subversion 来管理 csharpindepth.com 和 yoda.arachsys.com 的大部分内容——我有每个站点的本地副本，并且在每个服务器（存储库所在的位置）上都有提交后挂钩，以便在何时更新 Web 服务器目录我承诺。

哦，我在深度编写 C# 时也使用了 Subversion - 再次，我可以跟踪写入的时间等等。我不需要经常使用该方面，但它是一种方便的备份解决方案。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-18T16:37:28.607

是的，我使用 SVN。

为什么？为了练习。因为错误发生了。有时我检查代码，开始工作，并在四个小时后意识到我已经搞砸了，需要退出。当我有 SVN 支持时，我只损失了四个小时的工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-18T16:38:20.323

我在家中使用 subversion 进行跨平台项目，因此不同的开发环境（Win-Laptop 和 Linux-PC 始终是最新的 .

顺便说一句，SVN 服务器正在我的[WLAN 路由器](http://www.asus.com/products.aspx?l1=12&l2=43&l3=0&model=1121&modelmenu=1)上运行，无论我在笔记本电脑还是 PC 上工作，都可以访问它。

* * *

编辑：因为有人问我：默认情况下，wlan 路由器不支持 SVN，但使用以下固件（[http://oleg.wl500g.info/](http://oleg.wl500g.info/)）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-18T16:39:12.130

是的。我没有很长时间，但我被烧毁了，如下所述： [another SO thread](https://stackoverflow.com/questions/63668/confessions-of-your-worst-wtf-moment-what-not-to-do#64895 "任何 SO 线程")。

现在，我开始将它用作开发工具，而不仅仅是源代码备份。分支以尝试新功能、错误修复等。

我从家里的 darcs 开始（我当时工作的公司——不寒而栗——SourceSafe），我正在考虑改用 git 或 mercurial。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-18T16:38:10.243

当然是。出于您上面提到的相同原因，我在所有个人项目中都使用颠覆。

无论项目多么小，我什至不会考虑在没有 VCS 的情况下进行任何编码。我有一个大存储库，其中包含许多用于我所有小项目的文件夹，如果我正在处理一个更大的项目，它将拥有自己的存储库。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-18T16:47:49.803

是的，我在我的家庭项目中使用颠覆。我使用它是因为我可以确定我在不同计算机和操作系统上的版本是相同的，如果我在一台计算机上做一些愚蠢的事情也没问题，因为我可以回滚。它在另一台服务器上，所以如果我的电脑死了，我仍然有这个项目。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-18T16:58:10.080

由于 Git 或 Mercurial 的简单性和去中心化的性质，我将它们用于我的爱好项目。一个 quck hg/git init 并且我要提交我的更改。如果我在空闲时间写一些东西，通常是因为我需要一些东西，而没有任何东西可以满足我的需要。所以，如果结果证明有用的话，我很有可能会分享我编造的任何东西，在这种情况下，有一个修订历史是很好的。

但是有一个中断..如果我编写一个 100 行的 shell 脚本来执行一些只对我有用的奇怪任务.. 使用 VCS 没有意义。

在这个时代......我认为使用它们是如此普遍，以至于不这样做会让你觉得你在没有裤子的情况下出现在学校。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-18T17:19:45.480

我不能不使用 VCS。我改变主意，或者需要尝试一些事情——我需要 VCS 的安全网来保护我免受自己的伤害。

我仍然使用 RCS——我不需要复杂的分支策略。我正在考虑迁移到 Git（或者可能是 SVN），尽管我还没有完全相信我需要这样做。在这一点上，我更喜欢 Git 而不是 SVN，因为它是一个分布式 VCS。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-18T18:45:33.793

我的 ubuntu 笔记本电脑上有 Subversion。为什么？我认为没有人愿意存储带有日期扩展名或类似名称的文件的多个副本，除非它们不是严肃的项目。任何具有良好代码库的项目都需要版本控制，因此您可以随时返回，而不必担心两天前我的更改中丢失了什么。此外，由于我将 fsfs 与 SVN 一起使用，因此我可以随时备份它们，并在我的笔记本电脑崩溃时将其重新加载到另一个盒子中。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-18T19:18:59.717

一旦我开始工作，我使用的所有东西，无论是工作还是与家庭相关，都会受到版本控制（如果它涉及编程，但并非总是如此）。很多原因，包括历史、分支、与诸如[Redmine](http://redmine.org/)之类的软件的集成，特别是如果我打算分发某些东西，恢复某些东西的简单方法等等。

任何 VCS 都比没有好（包括 RCS），但我长期以来一直支持 DVCS。我自己使用[Mercurial](http://selenic.com/wiki/Mercurial/)，因为它是去中心化的（我有几台机器，包括两台笔记本电脑），支持离线工作（想想飞机或火车），比 git 更快更容易使用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-18T16:39:18.853

是的。颠覆，和我在工作中使用的一样。方便学习，因为我们刚刚在工作中迁移到 Subversion。

*   所以我可以回到旧代码。与其说是为了解决问题，不如说是为了解决问题。如果我不久前签入，我感觉更像是重构。如果没有源代码控制，我习惯于注释掉大量代码并且从不删除它。
*   我必须将我的存储库移动到我结帐所在的磁盘以外的其他地方......

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-18T16:40:19.430

我使用 git，是的，几乎每个项目都处于源代码控制之下，并且至少有一个分支。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-18T16:41:13.670

是的，我使用 Subversion，这样我不仅可以拥有一个备份代码存储库，而且如果家庭项目在工作中有用（例如代码示例或片段），我将始终可以访问它。当然，这对我来说成本很低，因为我的工作项目已经在 SVN 服务器上。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-18T17:07:56.050

在工作中我使用了 SVN，一切都很好。对于我的家庭项目，我有以下习惯：

*   当我到达一个“检查点”时，我会用一个“暗示性”的名字来归档我的资源（它描述了整体进展）

*   到我完成项目时，我通常有大约 20 个档案（这在一定程度上很有帮助，但让我们面对现实吧，谁想要浏览所有这些档案，按创建/修改时间对它们进行排序，尝试代码，请参阅如果它有效......糟糕的过程，不是吗？）

这就是为什么我也在我的家庭项目中使用 SVN :)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-18T17:08:46.687

是的，水星。当我大约一年前查看时，它似乎与 git 差不多，并且有更好的 windows 支持。从那以后，git 似乎赢得了人气竞赛，但事实就是如此。我有一个异地备份和一个用于公共项目的[Bitbucket 。](http://bitbucket.org/)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-18T17:29:26.133

我无法想象不在家里使用 VCS。尽管答案很明显，但我这样做的一个很好的理由是我经常在家里的不同项目之间被拉扯，很高兴记录我所做的事情和原因，并且我可以回到它。

它还有助于能够在多台机器之间同步并始终拥有一个工作副本（好吧，让我的代码工作.. :)）。

就个人而言，我开始使用 Perforce，因为那是我们在工作中使用的，我喜欢它。我发现离线编码太有问题了（谁不喜欢在咖啡店编码？？）所以我切换到 SVN。然而，我的下一个重大转变可能是使用 Mercurial，因为分布式的东西让我很感兴趣。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-18T17:55:58.870

是的。

我曾经将 CVS 用于我的家庭项目，然后我将所有内容都转换为**Mercurial**。

我可以访问通过 SSH 推送/拉取我的工作的服务器，这是我的主要项目存储库，使用 RAID 1 和定期备份非常安全。当然，大多数项目都分散在几个地方——在我家的电脑上，一些重要的工作中，在一个随身碟上。DVCS FTW！;)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-18T18:08:55.803

Subversion 已经为我工作了好几年，但我进入了一个高级阶段，我拥有几台开发机器并且 Subversion 遇到了一些挑战。例如，如果我从服务器获得最新版本并带着笔记本电脑去办公室，我可能想在代码上做更多工作。由于无法访问服务器，因此无法签入代码。这使得很难有信心回滚来尝试事情。

当然，也有一些技巧，比如拥有另一个本地存储库，但最好还是硬着头皮看看[分布式源代码控制系统](http://www.selenic.com/mercurial/wiki/index.cgi/UnderstandingMercurial)。在过去的几个月里，我一直在使用 mercurial，它就像一个魅力。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-18T17:10:26.623

是的，我使用 git + github.com

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-18T17:20:56.413

当然，我使用它是因为我想要它在工作中给我带来的所有好处，正如许多其他人所提到的。

一旦你习惯了这些好处，为什么没有它们？

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-18T17:25:07.887

是的，事实上我使用了多个 svn 存储库，而不是像我以前那样使用一个大的存储库（一个可能用于公共代码，另一个可能是个人的，其他可能是在线存储库）。我使用 svn，我在 :/dev 中拥有所有内容，并且我有某些文件夹，例如：/dev/external 或 /dev/prv 不在任何存储库中。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-18T17:30:30.263

我之前将[Beanstalk](http://beanstalkapp.com/)的免费版用于个人项目，它提供了一个高达 20mb 的 SVN 存储库。

我还使用[mozy](https://mozy.com/)进行每日备份。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-18T17:30:35.257

如果它们足够大，我将它们放在[Codeplex](http://codeplex.com)上并在 VS 中使用 TFSC，就像我在工作中使用的一样。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-18T18:27:22.927

我发誓我正在尝试，但很难找到适合我的环境的东西......

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-18T18:37:17.617

我目前没有，但我想。我在 Beanstalk 有一个免费帐户，我正在考虑是否要获得一个付费帐户，或者转移到 GitHub。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-01-18T18:53:51.437

我主要使用源代码管理，因此我可以在多台计算机（台式机、笔记本电脑）上处理同一个项目。但是，它也非常有用，可以让我对项目进行广泛的更改，而不必担心必须备份重要文件以防万一我想撤消某些更改。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-01-18T19:29:29.867

我愿意，而且我想在这方面做得更好。最初，我想在某处远程安装上使用 TFS，但现在我已经中断了几天的互联网，我很高兴我带着一个家庭服务器运行，猜猜看，Subversion。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-01-18T19:41:06.583

最近我只使用Git。之前和现在都经历过 CVS、SVN，我觉得它需要的工作量比它节省的工作量要少。以前从来没有过那种感觉。:)

```
 $ mkdir newproject
 $ cd newproject
 $ git init
 $ vim README
 $ git commit -m "Readme file" README 
```

完毕。我认为它并没有变得更容易。它的美妙之处在于，我不需要设置任何东西。它可以立即工作。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-18T21:36:42.793

是的。对于小事，我使用[darcs](http://darcs.net)，因为它的界面简单。因为 darcs 无法扩展，所以我将 git 用于任何严重的事情。两者都允许我在断开连接时提交更改。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-18T22:35:50.960

我在工作中使用 SVN，现在我切换到集市（bzr）可能是出于错误的原因。

一开始，我正在寻找一种方法来在断开连接的笔记本电脑上继续我的工作。Bzr 是唯一能够以双向方式（拉和推）与颠覆服务器交互的分布式 vcs。

现在对于我的家庭项目，我仍在使用 bzr，因为设置新存储库比使用 SVN 更容易。但是 svn 可能也能满足我的需求。这就是为什么我告诉我因为错误的原因而切换......只是太懒了。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-22T09:00:29.090

我使用 Beanstalk SVN 和版本。当我做了一些愚蠢的事情时，它不止一次救了我的培根。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-06-12T07:57:00.120

我对一切都使用 mercurial 和 subversion，因为：

1）它可以进行彻底的重构或更改，而不必担心丢失工作代码 2）它保留我的工作备份 3）它可以在多台计算机上同时处理同一个项目而无需担心同步。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2009-01-18T17:10:14.097

其他不为家庭项目使用源代码控制的人，请投票。我不。

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2009-06-12T07:43:18.810

我将 git 用于任何大于一个文件的项目。我不上传，因为我的笔记本电脑有时间机器支持。

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2009-12-30T08:49:51.777

是的，知乎！:)

# mysql - 我可以更改 DBD::mysql 使用的数据包大小吗？

> ID：455412
> 
> 赞同：3
> 
> 时间：2009-01-18T16:34:40.470
> 
> 标签：mysql, perl

我跑进

```
DBD::mysql::st execute failed: Got a packet bigger than 'max_allowed_packet' bytes 
```

尝试使用 Perl 和 MySQL 进行大型插入时出错。我知道增加`max_allowed_packet`my.cnf 中的设置可以解决这个问题，但是是否可以告诉 DBI（或 DBD::mysql，因为我的应用程序真的只需要使用 MySQL）使用更小的数据包？甚至可以将一个大的插入分解成更小的数据包吗？

我无法完全控制数据库服务器，因为它需要在共享托管环境中运行，所以如果我可以在不请求对服务器进行全局更改的情况下处理这个问题，那将是理想的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T17:08:25.580

尝试`";max_allowed_packet=1MB"`在 DBI->connect 的第一个参数中添加类似的内容。

如果这不起作用，您可以使用`";mysql_read_default_file=/somewhere/my.cnf"`指向具有正确配置的 my.cnf 文件的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T17:35:56.307

如果这不起作用，解决问题的一种方法是首先插入最大长度的字符串（插入语句的 1MB 长度）。然后，您使用 1MB 的数据包进行更新，如下所示：

```
$data = "whatever data needs inserting";
my $ins_sth=$dbh->prepare("insert into table_name (datacol) values(?)");
my $upd_sth=$dbh->prepare("update table_name set datacol=datacol||? where id=?");
my $max_size = 900_000; # Really max_packet_size - 200bytes
my $pos = 0;
$ins_sth->execute(substr($data,$pos,$max_size));
my $id = $dbh->{'mysql_insertid'};
$pos += $max_size;
while ( $pos < length($data) ) {
  $upd_sth->execute(substr($data,$pos,$max_size));
  $pos+=$max_size;
} 
```

我没有测试这段代码，但你应该明白了。

# java - 编程问题 - 传真压缩

> ID：455420
> 
> 赞同：0
> 
> 时间：2009-01-18T16:37:41.773
> 
> 标签：java, algorithm, binary, compression, fax

我正准备通过完成过去比赛中的问题来参加计算机科学比赛。他们中的大多数都很容易，但是这个让我很烦……看起来很简单，但我就是做不到。

如果你有一串一和零：

```
100111010001111100101010 
```

将其作为输入然后输出的代码是什么：

```
1:1 2:0 3:1 1:0 1:1 3:0 5:1 2:0 1:1 1:0 1:1 1:0 
```

其中每个冒号左边的数字是冒号后面的数字出现的次数。

所以，另一个例子......输入：

```
1100011 
```

会输出：

```
2:1 3:0 2:1 
```

根据问题，这类似于用于压缩传真传输的算法。

java中的答案是最好的，但我真正在寻找的是伪代码，甚至是关于如何去做的想法。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T16:41:20.690

这称为运行长度编码 (RLE)，用于许多事物（例如 Windows 位图文件格式）以提供非常基本的压缩（尤其是如果原始文件包含大量重复值（例如位图或传真） ) 包含相同颜色的长期运行)。

```
int[] array = { ........ }; // your values...
for ( int i=0; i < array.Length; i++ )
{
   int count = 1;
   int value = array[i];

   // Consume until different..
   while ( i+1 < array.Length && array[i] == array[i+1] )
   { 
       count++; 
       i++ 
   }

   Console.WriteLine("{0}:{1}", count, value);
}

// OR, as suggested by @jon  [done in my head, so could probably be improved a lot...]
int count = 0;
int oldValue = -1;
for ( int i=0; i<array.Length; i++ )
{
   int newValue = array[i];
   count = ( newValue != oldValue ) ? 1 : count+1;

   if ( i+1 >= array.Length || array[i+1] != newValue)
   {
      Console.WriteLine("{0}:{1}", count, newValue);
   }

   oldValue = newValue;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T16:40:59.117

就像一个想法：你为什么要打扰右边的数字？它总是在 1 和 0 之间交替，不是这样，所以假设它以 1 开头，如果实际序列以 0 开头，则编码一个初始 0。换句话说，你最终会得到：

1 2 3 1 1 3 5 2 1 1 1 1

但基本上你需要跟踪“我目前在看什么？” 和“我见过多少”？如果它发生变化，写下你一直在看的内容和计数，然后将“我正在看的内容”更新为新值并将计数更新为 1，然后继续。不要忘记在数据末尾写出最后一个值。

（我没有给出伪代码或 Java，因为我认为你会通过接受小提示而不是提供工作代码来了解更多信息。如果你需要进一步的提示，尽管说。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T17:14:46.817

> 我真正在寻找的只是伪代码，甚至是关于如何去做的想法。

以下是一些想法：

*   如何测试字节中的一位是一还是零：使用“按位与”运算来屏蔽其他位
*   如何测试字节中的不同位是一还是零：
    *   要么，使用不同的位掩码
    *   或者，在屏蔽之前移动或旋转字节中的位

使用上述方法，对第一个字节中的 8 位进行处理。然后重复此操作以处理下一个字节中的下一个 8 位。

一些伪代码可能类似于以下内容：

```
main()
{
  Encoder encoder = new Encoder;
  foreach (byte b in inputStream)
  {
    encoder.input(b);
  }
  //tell the encoder that the stream is finished
  //that there will be no subsequent bytes
  ///and that the final bits should be flushed now
  encoder.finished();
}

class Encoder
{
  //member data
  bool m_b; //value of the most-recently-processed bit
  int m_n; //number of the most-recently-processed bits

  //public methods
  void finished()
  {
    //TODO format and write the {m_n}:{m_b} value to output
    //and reset m_n to zero
  }

  void input(byte b)
  {
    for int (i = 0; i < 8; ++i)
    {
      //get the bit value
      bool bit = getbit(b, i);
      //see whether we can append it
      bool canAppend =
        (bit == m_b) || //new bit is same as previous bit
        (0 == m_n); //no previous bit
      //flush previous bits if can't append
      if (!canAppend)
        finished();
      //append current bit
      m_b = bit;
      ++m_n;
    }
  }

  //private helper method
  bool getbit(byte b, int i)
  {
    //TODO return the bit value using a mask
  }
} 
```

当您编写代码时，不要忘记**使用各种输入数据对其进行测试**，包括特殊情况（包括例如一个字节中具有相同值的所有位）。

# sql-server - 如何在不使用游标的情况下将表的一列转换为 SQL Server 中的 csv 字符串

> ID：455423
> 
> 赞同：34
> 
> 时间：2009-01-18T16:39:03.237
> 
> 标签：sql-server, tsql

我想`select Column from Table`使用 SQL Server 将结果返回到逗号分隔的字符串中。

有问题的列相当大 ( `nvarchar(2000)`)，因此解决方案必须能够处理非常大的结果值。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2018-12-05T17:38:15.003

STRING_AGG 在 sql 2017 中添加

[https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql?view=sql-server-2017)

```
SELECT STRING_AGG (ColumnName, ',') AS csv 
FROM TableName
GROUP BY ColumnName2 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-18T16:42:22.297

```
DECLARE @result nvarchar(max)
SET @result = ''

SELECT @result = @result + [Column] + N','
FROM [TABLE]

--TODO: trim last ',' if you require

PRINT @result 
```

如果`Column`可以为空，则要么先排除它，要么使用`ISNULL`/ `COALESCE`- 否则单个`NULL`将破坏整个序列。用 排除它更有效`WHERE`：

```
SELECT @result = @result + [Column] + N','
FROM [TABLE]
WHERE [Column] IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-18T17:27:43.530

没有尾随逗号版本：

```
declare @s varchar(max);

select @s = isnull(@s + ', ' + lastname, lastname)
from person
order by lastname;

print @s; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-08-09T17:35:41.963

我对建议答案中讨论的方法有疑问。我从 SQLAuthority 获取代码。但是，如果您有问题建议的解决方案，这每次都有效

```
SELECT SUBSTRING(
(SELECT ',' + s.ColumnName
FROM dbo.table s
ORDER BY s.ColumnName
FOR XML PATH('')),2,200000) AS CSV
GO 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-07-22T16:01:56.700

我创建了一个 proc，它将从任意表中动态创建一个 CSV，而无需显式指定列。如果您不想每次将 SQL 表转换为 CSV 字符串时都编写自定义代码，这将非常有用。

```
-- Description: Turns a query into a formatted CSV.
-- Any ORDER BY clause needs to be passed in the separate ORDER BY parameter.
CREATE PROC [dbo].[spQueryToCsv] 
(
  @query nvarchar(MAX), --A query to turn into CSV format. It should not include an ORDER BY clause.
  @orderBy nvarchar(MAX) = NULL, --An optional ORDER BY clause. It should contain the words 'ORDER BY'.
  @csv nvarchar(MAX) = NULL OUTPUT --The CSV output of the procedure.
)
AS
BEGIN   
  SET NOCOUNT ON;

  IF @orderBy IS NULL BEGIN
    SET @orderBy = '';
  END

  SET @orderBy = REPLACE(@orderBy, '''', '''''');  

  DECLARE @realQuery nvarchar(MAX) = '
    DECLARE @headerRow nvarchar(MAX);
    DECLARE @cols nvarchar(MAX);

    SELECT * INTO #dynSql FROM (' + @query + ') sub;    

    SELECT @cols = ISNULL(@cols + '' + '''','''' + '', '''') + ''''''"'''' + ISNULL(REPLACE(CAST(['' + name + ''] AS nvarchar(max)), ''''"'''', ''''""''''), '''''''') + ''''"''''''
    FROM tempdb.sys.columns 
    WHERE object_id = object_id(''tempdb..#dynSql'')
    ORDER BY column_id;        

    SET @cols = ''
      SET @csv = (SELECT '' + @cols + '' FROM #dynSql ' + @orderBy + ' FOR XML PATH(''''m_m''''));
      ''
    EXEC sys.sp_executesql @cols, N''@csv nvarchar(MAX) OUTPUT'', @csv=@csv OUTPUT    

    SELECT @headerRow = ISNULL(@headerRow + '','', '''') + ''"'' + REPLACE(name, ''"'', ''""'') + ''"''
    FROM tempdb.sys.columns 
    WHERE object_id = object_id(''tempdb..#dynSql'')
    ORDER BY column_id;

    SET @headerRow = @headerRow + CHAR(13) + CHAR(10);

    SET @csv = @headerRow + @csv;    
    ';

  EXEC sys.sp_executesql @realQuery, N'@csv nvarchar(MAX) OUTPUT', @csv=@csv OUTPUT
  SET @csv = REPLACE(REPLACE(@csv, '<m_m>', ''), '</m_m>', CHAR(13) + CHAR(10))
END

GO 
```

用法：

```
DECLARE @csv nvarchar(max)
EXEC [dbo].[spQueryToCsv]  @query = 'SELECT * FROM Customers', @csv = @csv OUTPUT, @orderBy = 'ORDER BY CustomerId'
SELECT @csv 
```

这是基于我编写的将任意表转换为[HTML 字符串](https://stackoverflow.com/a/29708178/1195036)的类似代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-13T00:29:11.443

如果您卡在旧数据库上并且无法使用 STRING_AGG 并且不想在生成字符串后进行修剪：

选项1：

```
DECLARE @Comma varchar(10) = '';
DECLARE @Result varchar(MAX) = '';

SELECT @Result = @Result + @Comma + Column, @Comma = ','
FROM Table; 
```

选项 2：

```
DECLARE @Result varchar(MAX) = '';

SELECT @Result = @Result + CASE WHEN LEN(@Result) > 0 THEN ',' ELSE '' END + Column
FROM Table; 
```

我喜欢选项 1，因为它更短。我没有做过任何性能测试，所以我不能说在这方面哪个更好。

如果使用选项 1，请确保在 @Result 之后设置了 @Comma，否则您将在字符串的开头得到一个额外的逗号。

在 SQL Server 2008 上测试

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-21T09:10:41.920

内部`SELECT`将创建 CSV，`STUFF()`并将修剪第一个逗号和空格

```
SELECT STUFF( 
    (SELECT ', ',  Column FROM Table FOR XML PATH(''))
, 1, 2, '' ) 
```

您可以将分隔符替换为您想要的任何内容，只需调整`STUFF()`以在开始时对其进行修剪。

# c++ - 我应该如何在 C++ 中正确使用 FormatMessage()？

> ID：455434
> 
> 赞同：92
> 
> 时间：2009-01-18T16:43:36.707
> 
> 标签：c++, windows, error-handling, formatmessage

**没有**：

*   MFC
*   ATL

我如何使用[`FormatMessage()`](http://msdn.microsoft.com/en-us/library/ms679351.aspx)来获取错误文本`HRESULT`？

```
 HRESULT hresult = application.CreateInstance("Excel.Application");

 if (FAILED(hresult))
 {
     // what should i put here to obtain a human-readable
     // description of the error?
     exit (hresult);
 } 
```

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-01-18T17:32:16.423

这是从系统返回错误消息的正确方法`HRESULT`（在这种情况下名为 hresult，或者您可以将其替换为`GetLastError()`）：

```
LPTSTR errorText = NULL;

FormatMessage(
   // use system message tables to retrieve error text
   FORMAT_MESSAGE_FROM_SYSTEM
   // allocate buffer on local heap for error text
   |FORMAT_MESSAGE_ALLOCATE_BUFFER
   // Important! will fail otherwise, since we're not 
   // (and CANNOT) pass insertion parameters
   |FORMAT_MESSAGE_IGNORE_INSERTS,  
   NULL,    // unused with FORMAT_MESSAGE_FROM_SYSTEM
   hresult,
   MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
   (LPTSTR)&errorText,  // output 
   0, // minimum size for output buffer
   NULL);   // arguments - see note 

if ( NULL != errorText )
{
   // ... do something with the string `errorText` - log it, display it to the user, etc.

   // release memory allocated by FormatMessage()
   LocalFree(errorText);
   errorText = NULL;
} 
```

这与大卫哈纳克的答案之间的主要区别在于`FORMAT_MESSAGE_IGNORE_INSERTS`标志的使用。MSDN 对如何使用插入有点不清楚，但[Raymond Chen 指出，](https://devblogs.microsoft.com/oldnewthing/20071128-00/?p=24353)在检索系统消息时永远不要使用它们，因为您无法知道系统期望哪些插入。

FWIW，如果您使用的是 Visual C++，则可以使用[`_com_error`](http://msdn.microsoft.com/en-us/library/0ye3k36s.aspx)该类使您的生活更轻松：

```
{
   _com_error error(hresult);
   LPCTSTR errorText = error.ErrorMessage();

   // do something with the error...

   //automatic cleanup when error goes out of scope
} 
```

据我所知，它不是 MFC 或 ATL 的一部分。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-09-16T22:15:28.663

请记住，您不能执行以下操作：

```
{
   LPCTSTR errorText = _com_error(hresult).ErrorMessage();

   // do something with the error...

   //automatic cleanup when error goes out of scope
} 
```

当类在堆栈上创建和销毁时，errorText 指向无效位置。在大多数情况下，此位置仍将包含错误字符串，但在编写线程应用程序时，这种可能性会很快消失。

因此，请***始终***按照上面 Shog9 的回答执行以下操作：

```
{
   _com_error error(hresult);
   LPCTSTR errorText = error.ErrorMessage();

   // do something with the error...

   //automatic cleanup when error goes out of scope
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-18T16:57:41.313

试试这个：

```
void PrintLastError (const char *msg /* = "Error occurred" */) {
        DWORD errCode = GetLastError();
        char *err;
        if (!FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM,
                           NULL,
                           errCode,
                           MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), // default language
                           (LPTSTR) &err,
                           0,
                           NULL))
            return;

        static char buffer[1024];
        _snprintf(buffer, sizeof(buffer), "ERROR: %s: %s\n", msg, err);
        OutputDebugString(buffer); // or otherwise log it
        LocalFree(err);
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-06-04T22:59:43.823

从 c++11 开始，您可以使用标准库而不是`FormatMessage`：

```
#include <system_error>

std::string message = std::system_category().message(hr) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-07-21T13:57:25.693

这更多是对大多数答案的补充，但不是使用`LocalFree(errorText)`使用`HeapFree`函数：

```
::HeapFree(::GetProcessHeap(), NULL, errorText); 
```

[从 MSDN 网站](https://msdn.microsoft.com/en-us/library/windows/desktop/ms679351(v=vs.85).aspx)：

> **Windows 10**：
> LocalFree 不在现代 SDK 中，因此不能用于释放结果缓冲区。相反，使用 HeapFree (GetProcessHeap(),allocateMessage)。在这种情况下，这与在内存上调用 LocalFree 相同。

**更新**
我发现它`LocalFree`位于 SDK 的 10.0.10240.0 版本中（WinBase.h 中的第 1108 行）。但是，警告仍然存在于上面的链接中。

```
#pragma region Desktop Family or OneCore Family
#if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP | WINAPI_PARTITION_SYSTEM)

WINBASEAPI
_Success_(return==0)
_Ret_maybenull_
HLOCAL
WINAPI
LocalFree(
    _Frees_ptr_opt_ HLOCAL hMem
    );

#endif /* WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP | WINAPI_PARTITION_SYSTEM) */
#pragma endregion 
```

**更新 2**
我还建议使用该`FORMAT_MESSAGE_MAX_WIDTH_MASK`标志来整理系统消息中的换行符。

[从 MSDN 网站](https://msdn.microsoft.com/en-us/library/windows/desktop/ms679351(v=vs.85).aspx)：

> **FORMAT_MESSAGE_MAX_WIDTH_MASK**
> 该函数忽略消息定义文本中的常规换行符。该函数将消息定义文本中的硬编码换行符存储到输出缓冲区中。该函数不生成新的换行符。

**更新 3**
似乎有 2 个特定的系统错误代码未使用推荐的方法返回完整消息：

[为什么 FormatMessage 只为 ERROR_SYSTEM_PROCESS_TERMINATED 和 ERROR_UNHANDLED_EXCEPTION 系统错误创建部分消息？](https://stackoverflow.com/questions/37613267/why-does-formatmessage-only-create-partial-messages-for-error-system-process-ter)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-02-23T19:36:48.550

这是处理 Unicode 的 David 函数的一个版本

```
void HandleLastError(const TCHAR *msg /* = "Error occured" */) {
    DWORD errCode = GetLastError();
    TCHAR *err;
    if (!FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM,
                       NULL,
                       errCode,
                       MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), // default language
                       (LPTSTR) &err,
                       0,
                       NULL))
        return;

    //TRACE("ERROR: %s: %s", msg, err);
    TCHAR buffer[1024];
    _sntprintf_s(buffer, sizeof(buffer) / sizeof(buffer[0]), _T("ERROR: %s: %s\n"), msg, err);
    OutputDebugString(buffer);
    LocalFree(err); 
```

}

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-04-15T01:34:25.080

正如其他答案中指出的那样：

*   `FormatMessage``DWORD`结果不是 a （`HRESULT`通常是`GetLastError()`）。
*   `LocalFree`需要释放分配的内存`FormatMessage`

我采取了以上几点，并为我的答案添加了更多内容：

*   将 包装`FormatMessage`在一个类中以根据需要分配和释放内存
*   使用运算符重载（例如`operator LPTSTR() const { return ...; }`，以便您的类可以用作字符串

```
class CFormatMessage
{
public:
    CFormatMessage(DWORD dwMessageId,
                   DWORD dwLanguageId = MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT)) :
        m_text(NULL)
    {
        Assign(dwMessageId, dwLanguageId);
    }

    ~CFormatMessage()
    {
        Clear();
    }

    void Clear()
    {
        if (m_text)
        {
            LocalFree(m_text);
            m_text = NULL;
        }
    }

    void Assign(DWORD dwMessageId,
                DWORD dwLanguageId = MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT))
    {
        Clear();
        DWORD dwFlags = FORMAT_MESSAGE_FROM_SYSTEM
            | FORMAT_MESSAGE_ALLOCATE_BUFFER
            | FORMAT_MESSAGE_IGNORE_INSERTS,
        FormatMessage(
            dwFlags,
            NULL,
            dwMessageId,
            dwLanguageId,
            (LPTSTR) &m_text,
            0,
            NULL);
    }

    LPTSTR text() const { return m_text; }
    operator LPTSTR() const { return text(); }

protected:
    LPTSTR m_text;

}; 
```

在此处找到上述代码的更完整版本：[https ://github.com/stephenquan/FormatMessage](https://github.com/stephenquan/FormatMessage)

有了上面的类，用法很简单：

```
 std::wcout << (LPTSTR) CFormatMessage(GetLastError()) << L"\n"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-15T04:26:16.093

下面的代码是我写出的与[Microsoft 的 ErrorExit()](https://msdn.microsoft.com/en-us/library/windows/desktop/ms680582%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396)对比的 C++ 等效代码，但稍作修改以避免所有宏并使用 unicode。这里的想法是避免不必要的强制转换和 malloc。我无法逃脱所有的 C 演员阵容，但这是我能召集的最好的。与 FormatMessageW() 相关，它需要由格式函数分配的指针和来自 GetLastError() 的错误 Id。static_cast 之后的指针可以像普通的 wchar_t 指针一样使用。

```
#include <string>
#include <windows.h>

void __declspec(noreturn) error_exit(const std::wstring FunctionName)
{
    // Retrieve the system error message for the last-error code
    const DWORD ERROR_ID = GetLastError();
    void* MsgBuffer = nullptr;
    LCID lcid;
    GetLocaleInfoEx(L"en-US", LOCALE_RETURN_NUMBER | LOCALE_ILANGUAGE, (wchar_t*)&lcid, sizeof(lcid));

    //get error message and attach it to Msgbuffer
    FormatMessageW(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL, ERROR_ID, lcid, (wchar_t*)&MsgBuffer, 0, NULL);
    //concatonate string to DisplayBuffer
    const std::wstring DisplayBuffer = FunctionName + L" failed with error " + std::to_wstring(ERROR_ID) + L": " + static_cast<wchar_t*>(MsgBuffer);

    // Display the error message and exit the process
    MessageBoxExW(NULL, DisplayBuffer.c_str(), L"Error", MB_ICONERROR | MB_OK, static_cast<WORD>(lcid));

    ExitProcess(ERROR_ID);
} 
```

# c# - String.Split 的对面，带分隔符 (.net)

> ID：455438
> 
> 赞同：104
> 
> 时间：2009-01-18T16:45:33.130
> 
> 标签：c#, .net, arrays, string

有没有办法`String.Split`在.Net中做相反的事情？也就是说，将数组的所有元素与给定的分隔符组合起来。

接受`["a", "b", "c"]`和给予`"a b c"`（用 分隔符`" "`）。

**更新：**我自己找到了答案。这就是`String.Join`方法。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-01-18T16:46:19.963

找到了答案。它被称为[String.Join](http://msdn.microsoft.com/en-us/library/System.String.Join(v=vs.110).aspx "String.Join 的 MSDN 页面")。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-07-14T18:13:28.853

您可以使用[`String.Join`](https://msdn.microsoft.com/en-us/library/System.String.Join(v=vs.110).aspx)：

```
string[] array = new string[] { "a", "b", "c" };
string separator = " ";
string joined = String.Join(separator, array); // "a b c" 
```

虽然更冗长，但您也可以使用以下[`StringBuilder`](https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx)方法：

```
StringBuilder builder = new StringBuilder();

if (array.Length > 0)
{
    builder.Append(array[0]);
}
for (var i = 1; i < array.Length; ++i)
{
    builder.Append(separator);
    builder.Append(array[i]);
}

string joined = builder.ToString(); // "a b c" 
```

# javascript - setTimeout () 使用 iframe 移动 div 仅在 firefox 中导致闪烁

> ID：455446
> 
> 赞同：1
> 
> 时间：2009-01-18T16:49:38.490
> 
> 标签：javascript, firefox, settimeout, flicker

我有一个在 IE 和 Chrome 中工作的 javascript 中创建的水平滚动，但是在 Firefox 2 和 3 中我得到一个闪烁。正在移动的 div 包含一个 iframe，其中包含绝对定位的 div 的图像和文本。（见下面的代码。）

问题：

1) 出现在动画 div 左侧或右侧的 div 中的内容似乎在 style.left 移动到相邻 div“下方”的一侧闪烁。这只发生在 Firefox 中。

2）似乎当使用鼠标悬停处理程序大约 10 秒（仅在 Firefox 中）时，动画会暂停大约一秒钟，然后重新开始。这在 IE 或 Chrome 中都不会发生。

javascript是：

```
<script type="text/javascript">
//outtake
function scrollframeleft() {
    var divmenuleft = getLeft("divMenu");
    var framewidth = parent.frames["framecontent"].scrollwidth;
    var scrollportal = 740;
    var scrollCatch = 13;

    if (!noScroll && divmenuleft <=scrollCatch) {
        divMenuObjStyle.left=(divmenuleft+scrollDistVar)+'px'
        t = setTimeout("scrollframeleft();",scrollSpeedVar)
    }
}
</script> 
```

HTML 是：

```
<div id="divBg" style="position:absolute; z-index:10; top:415px; left:13px; width:740px; height:100px; clip:rect(0px 740px 102px 13px); visibility:visible;"> 
    <div id="divMenu" style="position:absolute; z-index:10; top:0px; left:13px; color:#FFFFFF; visibility:visible;">
        <iframe name="framecontent" id="framecontent" frameborder="0" 
        height="100" width="5000" scrolling="no"  src="/content.php">
        </iframe>
    </div>`
</div>
<div id="divArrowLeft" style="position:absolute; z-index:204; left: 136px; top:398px;">
    <a href="#" onmouseover="noScroll=false;scrollframeleft()"
    onmouseout="noMove()" onclick="void blur()"><img
    src="/images/leftarrow_sm.gif" width="14" height="14" alt="more news scroll left" border="0"></a>
</div> 
```

谢谢你的支持！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T18:03:25.067

对我来说，IE（和 Chrome）实现了*真正*的抢占。我的意思是 IE litteraly 停止它正在做的事情（其他 Javascript 执行或内部代码来呈现页面或获取它或......）以立即提供 javascript 功能。

相反，Firefox 在为计时器“中断”服务之前完成了他正在做的事情。结果，就会发生抖动。但是函数调用并没有丢失，仍然是可靠的。

也有可能只是显示在 FF 中由于不明原因而被冻结。

埃里克 [http://codevault.agilityhoster.com](http://codevault.agilityhoster.com)

# sqlalchemy - IronPython db-api 2.0

> ID：455469
> 
> 赞同：2
> 
> 时间：2009-01-18T17:05:56.630
> 
> 标签：sqlalchemy, ironpython, python-db-api, sqlobject

有谁知道是否有任何 db-api 2.0 驱动程序可与 IronPython 一起使用？如果是这样，有没有人尝试将它与 SQLAlchemy、SQLObject 或 Django ORM 一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T02:50:21.270

我知道这是一个很晚的答案，但我今天才看到这个问题——所以我今天才回答。 [http://sourceforge.net/projects/adodbapi](http://sourceforge.net/projects/adodbapi) 包含一个完全兼容的 db-api-2 模块，可与 IronPython 一起使用。它仅限在 Windows 中使用，因为它使用经典 ADO，使用 COM 调用，而不是 ADO.NET。[我尝试了一个真正的 .NET 版本，但效果很差。如果有人想跟进，它的分支仍然存在。] 该模块的分支适用于 MS-SQL 的 django 扩展。我已将这些改编重新拉回主叉。我不知道是否有人尝试过在 django 中使用结果，但它应该可以工作，前提是明确将 paramstyle 切换为“格式”。

导入 adodbapi 作为数据库

Database.paramstyle = '格式'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T16:26:25.633

以下是 sqlalchemy 的一些答案：

[http://groups.google.com/group/sqlalchemy/browse_thread/thread/ea3ee246680c9d14?pli=1](http://groups.google.com/group/sqlalchemy/browse_thread/thread/ea3ee246680c9d14?pli=1)

在线程的最后，有人在去年 9 月尝试了 IronPython 的 beta 版，并且它正在运行。

也在这里： [SqlAlchemy 讨论。](http://groups.google.com/group/sqlalchemy/browse_thread/thread/55f78bc78801c13/4b0fae2190c4af57?lnk=gst&q=ironpython#4b0fae2190c4af57)

> 对 jython、ironpython 等的支持更像是一个插件，因为可以重用现有的 SQL 编译代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T02:41:33.350

[pypyodbc](https://code.google.com/p/pypyodbc)在 IronPython 下运行，它符合 db-api 2.0。可以参考这篇[文章](https://code.google.com/p/pypyodbc/wiki/Enable_SQLAlchemy_on_IronPython)了解如何在 IronPython 下启用 SQLAlchemy。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-06T23:39:04.883

通过遵循此处的步骤（有一处更改），我已经能够在 Ironpython 2.7 上使用 MSSQL 2008 使用 sqlalchemy：[ [https://code.google.com/p/pypyodbc/wiki/Enable_SQLAlchemy_on_IronPython][1]](https://code.google.com/p/pypyodbc/wiki/Enable_SQLAlchemy_on_IronPython][1])

我必须在第 4 步中更改下面的最后一行。删除除 pypyodbc 之外的所有内容

第四步：修改 IronPython 2.7\Lib\site-packages\sqlalchemy\dialects\mssql__init__.py，在最上面的 import 行中，在 mxodbc 之后添加 pypyodbc，如下所示：

```
#from sqlalchemy.dialects.mssql import base, pyodbc, adodbapi, \ 
                                       pymssql, zxjdbc, mxodbc, pypyodbc
from sqlalchemy.dialects.mssql import base, pypyodbc 
```

现在您可以通过以下代码使用 SQLAlchemy：

```
import sqlalchemy
engine = sqlalchemy.create_engine('mssql+pypyodbc://MSSQL_DSN')
for row in engine.execute('select * from aTable'):
    print (row) 
```

# mysql - 当您知道只有 1 个结果时，向 MySQL 查询添加“LIMIT 1”是否会使它们更快？

> ID：455476
> 
> 赞同：96
> 
> 时间：2009-01-18T17:08:37.843
> 
> 标签：mysql, optimization, limit

当我将 LIMIT 1 添加到 MySQL 查询时，它是在找到 1 个结果后停止搜索（从而使其更快）还是仍然获取所有结果并在最后截断？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-01-18T17:21:39.517

根据查询，添加限制子句会对性能产生巨大影响。如果您只想要一行（或者知道只有一行可以满足查询的事实），并且不确定内部优化器将如何执行它（例如，WHERE 子句未命中索引等），那么您绝对应该添加一个 LIMIT 子句。

至于优化查询（在小表上使用索引），它的性能可能并不重要，但同样 - 如果您只对一行感兴趣，而不是添加一个 LIMIT 子句。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-18T17:22:05.257

限制会影响查询的性能（请参阅下面的评论和链接），它还会减少 MySQL 输出的结果集。对于您期望单个结果的查询，这是有好处的。

此外，限制结果集实际上可以加快总查询时间，因为传输大型结果集会占用内存并可能在磁盘上创建临时表。我提到这一点是因为我最近看到一个应用程序由于结果集巨大而没有使用限制杀死服务器，并且由于限制到位，资源利用率大大下降。

查看此页面以获取更多详细信息：[MySQL 文档：限制优化](http://dev.mysql.com/doc/refman/5.0/en/limit-optimization.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-18T17:24:14.300

如果只有 1 个结果返回，那么不，LIMIT 不会使其更快。如果有很多结果，而您只需要第一个结果，并且没有 GROUP 或 ORDER by 语句，那么 LIMIT 会使其更快。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-09-28T15:34:26.200

**简而言之，答案是肯定的。**如果您将结果限制为 1，那么即使您“期待”一个结果，查询也会更快，因为您的数据库不会查看所有记录。一旦找到与您的查询匹配的记录，它就会停止。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-18T17:18:02.707

如果您真的只期望一个结果，那么将 LIMIT 附加到您的查询中确实很有意义。我不知道 MySQL 的内部工作原理，但我确信它不会收集 100'000+ 条记录的结果集，只是在最后将其截断回 1..

# c++ - 从字符串到字符串流再到向量

> ID：455483
> 
> 赞同：10
> 
> 时间：2009-01-18T17:11:47.993
> 
> 标签：c++, string, vector, stringstream

我有一个我想在我的应用程序上实现的步骤的示例程序。我想将字符串上的 int 元素分别 push_back 到一个向量中。我怎样才能？

```
#include <iostream>
#include <sstream>

#include <vector>

using namespace std;

int main(){

    string line = "1 2 3 4 5"; //includes spaces
    stringstream lineStream(line);

    vector<int> numbers; // how do I push_back the numbers (separately) here?
    // in this example I know the size of my string but in my application I won't

    } 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-18T17:22:21.857

这是一个经典的例子`std::back_inserter`。

```
copy(istream_iterator<int>(lineStream), istream_iterator<int>(),
     back_inserter(numbers)); 
```

如果您愿意，您可以从一开始就创建矢量

```
vector<int> numbers((istream_iterator<int>(lineStream)), 
                    istream_iterator<int>()); 
```

请记住在第一个参数周围加上括号。编译器认为这是一个函数声明，否则。如果您使用向量来获取数字的迭代器，则可以直接使用 istream 迭代器：

```
istream_iterator<int> begin(lineStream), end;
while(begin != end) cout << *begin++ << " "; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-18T17:14:35.287

```
int num;
while (lineStream >> num) numbers.push_back(num); 
```

# unix - 如何一次杀死 Unix 中的所有 shell？

> ID：455484
> 
> 赞同：2
> 
> 时间：2009-01-18T17:12:58.410
> 
> 标签：unix, shell, sysadmin, kill

随着时间的推移，我的 Mac 变得很慢。原因是我的贝壳数量巨大，例如 Bashes 和 Fishes。每个shell都有不同的PID。一个个地杀贝壳太麻烦了。我怎样才能一次杀死他们？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-18T17:15:14.193

[killall](https://ss64.com/bash/killall.html)命令可以杀死具有给定名称的所有进程：

```
killall bash 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-18T17:18:25.733

如果他们拒绝，请尝试“killall bash”或“killall -9 bash”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-18T17:28:00.707

根据其他答案，通常的命令是`killall`.

请注意，尽管在某些版本的 UNIX（例如 DEC Unix）上，此命令实际上会杀死*所有*进程。

在使用它之前，请确保您知道您的 UNIX 有哪些行为！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T08:03:36.040

我强烈怀疑你的初步诊断。在 Unix 中，非活动进程不会占用资源。它没有被调度，它的内存被换出等等。如果出现缓慢的问题，它可能有另一个原因。跑顶是第一步。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T17:16:38.513

知道可执行文件的文件名吗？您可以在许多 Unix 系统上使用“killall”。

```
# killall <name> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T23:29:07.327

我认为你不能一次杀死所有的贝壳。你必须使用许多 killalls，像上面 Rjamestaylor 所说的那样对每个 Shell 分别使用：

```
killall bash
killall fish 
```

等等。

# c++ - C++ 中“const”的用途有多少？

> ID：455518
> 
> 赞同：143
> 
> 时间：2009-01-18T17:25:23.067
> 
> 标签：c++, constants

作为一个新手 C++ 程序员，有一些结构对我来说仍然很模糊，其中之一是`const`. 您可以在如此多的地方使用它，并具有如此多不同的效果，这对于初学者来说几乎是不可能的。一些 C++ 大师会永远解释各种用途以及是否和/或为什么不使用它们吗？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-01-18T17:33:21.693

试图收集一些用途：

**将一些临时绑定到引用到常量，以延长其生命周期。**引用可以是一个基 - 它的析构函数不需要是虚拟的 - 仍然调用正确的析构函数：

```
ScopeGuard const& guard = MakeGuard(&cleanUpFunction); 
```

*解释*，使用代码：

```
struct ScopeGuard { 
    ~ScopeGuard() { } // not virtual
};

template<typename T> struct Derived : ScopeGuard { 
    T t; 
    Derived(T t):t(t) { }
    ~Derived() {
        t(); // call function
    }
};

template<typename T> Derived<T> MakeGuard(T t) { return Derived<T>(t); } 
```

这个技巧在 Alexandrescu 的 ScopeGuard 实用程序类中使用。一旦临时超出范围，就会正确调用 Derived 的析构函数。上面的代码遗漏了一些小细节，但这是最重要的。

* * *

**使用 const 告诉其他方法不会改变这个对象的逻辑状态。**

```
struct SmartPtr {
    int getCopies() const { return mCopiesMade; }
}; 
```

* * *

**将 const 用于写时复制类**，以使编译器帮助您决定何时以及何时不需要复制。

```
struct MyString {
    char * getData() { /* copy: caller might write */ return mData; }
    char const* getData() const { return mData; }
}; 
```

*解释*：只要原始对象和复制对象的数据保持不变，您可能希望在复制某些内容时共享数据。一旦其中一个对象更改了数据，您现在需要两个版本：一个用于原始版本，一个用于副本。也就是说，您在*写入时**复制*到任一对象，这样它们现在都有自己的版本。

 **使用代码*：

```
int main() {
    string const a = "1234";
    string const b = a;
    // outputs the same address for COW strings
    cout << (void*)&a[0] << ", " << (void*)&b[0];
} 
```

上面的代码片段在我的 GCC 上打印了相同的地址，因为使用的 C++ 库实现了 copy-on-write `std::string`。两个字符串，即使它们是不同的对象，它们的字符串数据共享相同的内存。制作`b`非常量会优先使用非常量版本，`operator[]`而 GCC 将创建后备内存缓冲区的副本，因为我们可以更改它并且它一定不会影响`a`!

```
int main() {
    string const a = "1234";
    string b = a;
    // outputs different addresses!
    cout << (void*)&a[0] << ", " << (void*)&b[0];
} 
```

* * *

**对于复制构造函数从 const 对象和临时对象进行复制**：

```
struct MyClass {
    MyClass(MyClass const& that) { /* make copy of that */ }
}; 
```

* * *

**用于制作无法更改的常量**

```
double const PI = 3.1415; 
```

* * *

**用于通过引用而不是按值传递任意对象**- 以防止可能昂贵或不可能的按值传递

```
void PrintIt(Object const& obj) {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-18T17:34:43.530

C++ 中 const 的主要用途有 2 个。

**常量值**

如果一个值是在其生命周期内不会（或不应）更改的变量、成员或参数的形式，则应将其标记为 const。这有助于防止对象发生突变。例如，在以下函数中，我不需要更改传递的 Student 实例，因此我将其标记为 const。

```
void PrintStudent(const Student& student) {
  cout << student.GetName();
} 
```

至于你为什么要这样做。如果您知道基础数据无法更改，那么推理算法会容易得多。"const" 有帮助，但不保证会实现。

显然，将数据打印到 cout 不需要太多思考:)

**将成员方法标记为 const**

在前面的示例中，我将 Student 标记为 const。但是 C++ 怎么知道在 student 上调用 GetName() 方法不会改变对象呢？答案是该方法被标记为 const。

```
class Student {
  public:
    string GetName() const { ... }
}; 
```

将方法标记为“const”会做两件事。主要是它告诉 C++ 这个方法不会改变我的对象。第二件事是所有成员变量现在都将被视为被标记为 const。这有助于但不会阻止您修改类的实例。

这是一个非常简单的示例，但希望它能帮助回答您的问题。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-22T06:25:04.490

注意理解这 4 个声明之间的区别：

以下 2 个声明在语义上是相同的。您可以更改*ccp1*和 ccp2 指向的位置，但不能更改它们指向的内容。

```
const char* ccp1;
char const* ccp2; 
```

接下来，指针是 const，所以为了有意义，它必须初始化为指向某个东西。你不能让它指向别的东西，但是它指向的东西是*可以*改变的。

```
char* const cpc = &something_possibly_not_const; 
```

最后，我们将两者结合起来——所以被指向的东西不能被修改，指针也不能指向其他任何地方。

```
const char* const ccpc = &const_obj; 
```

顺时针螺旋规则可以帮助解开声明[http://c-faq.com/decl/spiral.anderson.html](http://c-faq.com/decl/spiral.anderson.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-05-11T12:00:37.967

作为一个小提示，正如我[在这里](http://duramecho.com/ComputerInformation/WhyHowCppConst.html)所读到的，注意到这一点很有用

> `const`适用于它最左边的任何东西（除非那里没有任何东西，在这种情况下它适用于它最右边的任何东西）。

# deployment - 如何计算 ClickOnce 程序的安装/更新次数？

> ID：455526
> 
> 赞同：7
> 
> 时间：2009-01-18T17:28:00.143
> 
> 标签：deployment, clickonce

计算 ClickOnce 部署的程序安装或更新次数的最佳方法是什么？此外，是否有可能以某种方式跟踪*谁*在安装或更新它（例如，地理上）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T12:56:38.413

ClickOnce 有一个您可以使用的 API。[在应用程序启动时检查ApplicationDeployment.IsFirstRun](http://msdn.microsoft.com/en-us/library/system.deployment.application.applicationdeployment.isfirstrun.aspx)的值并在那里执行您需要执行的操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-18T17:35:45.027

我的 ClickOnce 应用程序需要登录，因此很容易从他们的注册以及他们的 IP 地址中分辨出谁在使用该程序。

另一种方法是检查服务器日志以查找对您的包的命中。如果您将其设置为在每次执行时检查更新，它每次都会点击 .application 并且当有更改时，点击包。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T17:37:30.407

有一些关于 MSDN [Administering ClickOnce Deployments的信息](http://msdn.microsoft.com/en-us/library/aa480721.aspx#adminc_topic4)

企业使用 ClickOnce 的一个常见要求是需要跟踪哪些用户已启动或安装了哪些应用程序。这方面的一个例子是查询用户最近启动的应用程序的特定版本。可能需要在部署服务器上进行此类跟踪，以避免需要监视分布在网络上的大量客户端机器。在客户端进行跟踪还需要自定义软件开发和安装，因为 ClickOnce 运行时不会公开任何挂钩来插入自定义启动事件跟踪解决方案。

为了跟踪哪些用户从服务器端安装或启动了哪些应用程序，您需要验证用户的身份并检测和拦截文件下载请求。你做这些事情的能力受到许多因素的影响。

一个关键因素是使用的网络协议。ClickOnce 支持 HTTP（和 HTTPS）或网络文件共享（UNC 路径）。HTTP 提供了最大的灵活性，因为您可以轻松地拦截服务器上的入站文件请求。您仍然可以使用 Windows 文件审核和事件日志实现某种程度的跟踪，但是这些选项很难设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T17:37:04.713

可能最好的方法是在您的 Web 服务器上使用日志记录工具。将下载记录到 .application 等（或者可能是实际的 dll/exe 文件，因为 .application 可能会被用于自动更新检查）。

也许通过 http 模块，但任何网络服务器日志工具都应该足够了。您可以从 IP 中*大致*推断出位置（但您需要找到自己的提供商）。

但是，ClickOnce 是被动的 - 无法向其中注入额外的*代码*。你也许可以在第一次运行时运行一些代码，但是......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T15:09:52.897

托管记录请求者 IP 地址的 Web 服务。在启动时调用应用程序中的 Web 服务。位置与 IP 地址相关联，您可能可以从那里弄清楚。:)

# emacs - 如何加载程序读取标准输入并在 gdb 中获取参数？

> ID：455544
> 
> 赞同：111
> 
> 时间：2009-01-18T17:36:20.157
> 
> 标签：emacs, gdb, redirect, command-line-arguments

> 我有一个从标准输入获取输入并从命令行获取一些参数的程序。它看起来像这样：
> 
> ```
> cat input.txt > myprogram -path "/home/user/work" 
> ```
> 
> 我尝试在 emacs 中使用 gdb 调试代码，通过 Mx gdb，我尝试使用以下命令加载程序：
> 
> ```
> gdb cat input.txt > myprogram -path "/home/user/work" 
> ```
> 
> 但是，gdb 不喜欢它。

从[这里](http://answers.yahoo.com/question/index?qid=20071102162016AASqPeB)抄袭的问题。不幸的是，我不了解解决方案，并且不确定除了使用`-g`选项编译和运行命令 Mx gdb 之外还能做什么。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-01-18T17:53:37.207

如果你是从 shell 做的，你会这样做：

```
% gdb myprogram
gdb> run params ... < input.txt 
```

这似乎也适用于 emacs。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-09-19T15:39:03.840

有几种方法可以做到：

```
$ gdb myprogram
(gdb) r -path /home/user/work < input.txt 
```

或者

```
$ gdb myprogram
(gdb) set args -path /home/user/work < input.txt
(gdb) r 
```

或者

```
$ gdb -ex 'set args -path /home/user/work < input.txt' myprogram
(gdb) r 
```

其中 gdb`run`命令 ( `r`) 默认使用之前设置的参数`set args`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-20T03:05:07.263

为了完整起见，在启动调试会话时，还有 --args 选项。IE）

```
gdb gdbarg1 gdbarg2 --args yourprog arg1 arg2 -x arg3 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-11-21T07:03:09.757

十一年后了，这个问题已经有了答案，但是对于以后像我这样的人，我只是想补充一点。

运行后`gdb your_program`，如果只键入`run < file_containing_input`，程序将一直运行到最后，您可能无法发现问题，所以在您做之前先`run < file_containing_input`休息一下。像这样的东西

```
$ gdb your_program
gdb> break main
gdb> run < file_containing_input 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T00:57:41.210

如果您不需要从一开始就进行调试，您还可以使用以下方法附加到已经运行的进程：

```
$ gdb myprogram xxx 
```

其中 xxx 是进程 ID。然后你不需要告诉 gdb 起始参数。

# wpf - 为什么这个 WPF RoutedCommand 绑定的 Context MenuItem 被禁用？

> ID：455551
> 
> 赞同：7
> 
> 时间：2009-01-18T17:38:55.380
> 
> 标签：wpf, menuitem

目前，我仍在摸索 WPF，无法弄清楚为什么禁用此上下文菜单项：

```
<Window x:Class="DisabledMenuItemProblem.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:DisabledMenuItemProblem"
        Title="Window1" Height="300" Width="300">
    <TextBlock Text="fooooobaaaaaar">
        <TextBlock.ContextMenu>
            <ContextMenu>
                <MenuItem Header="Foo" Command="{x:Static local:MyCommands.FooBar}" />
            </ContextMenu>
        </TextBlock.ContextMenu>
    </TextBlock>
</Window>

using System.Windows;
using System.Windows.Input;

namespace DisabledMenuItemProblem
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
            CommandBindings.Add(new CommandBinding(MyCommands.FooBar, FooExecuted, CanFooExecute));
        }

        public void FooExecuted(object sender, ExecutedRoutedEventArgs e)
        { MessageBox.Show("Foo!"); }

        public void CanFooExecute(object sender, CanExecuteRoutedEventArgs e)
        { e.CanExecute = true; }
    }

    public static class MyCommands
    { 
        public static RoutedCommand FooBar = new RoutedCommand(); 
    }
} 
```

我错过了什么？

让我感到困惑的是，如果我在窗口中抛出一个按钮并将其命令设置为 FooBar 它就可以工作，一旦它被执行，上下文菜单就会启用！

干杯，克里斯。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T05:51:09.537

这是我使用的一般模式....

首先，将您的命令保存在自己的静态类中，这可以促进重用等......

```
public static class MyCommands
{
    public static RoutedUICommand CmdFoo = new RoutedUICommand("CmdFoo", 
                                                               "CmdFoo", 
                                                               typeof(MyCommands));
} 
```

其次，在control/window/etc中注册命令。你想使用它，通常在构造函数中

```
public MyControl
{
    public MyControl()
    {
        CommandBindings.Add( 
            new CommandBinding( MyCommands.CmdFoo,   // this is the command object
                                XCutFooCommand,      // execute
                                CanXCuteFooCommand));// can execute?
    } 
```

第三，在控件/窗口/等中创建您的处理程序......

```
 public void CanExecuteRerollCommand(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = true;  // can this command be executed?
        e.Handled = true;     // has this event been handled?
    }
    public void ExecuteRerollCommand(object sender, ExecutedRoutedEventArgs e)
    {
    // do stuff
    }
} 
```

最后，您的 xaml 应该如下所示：

```
 <ContextMenu>
        <ContextMenu.CommandBindings>
            <CommandBinding Command="foo:MyCommands.CmdFoo" 
                            CanExecute="CanExecuteRerollCommand" 
                            Executed="ExecuteRerollCommand" />
        </ContextMenu.CommandBindings>
        <MenuItem Header="Reroll"  Command="foo:MyCommands.CmdFoo"/>
    </ContextMenu> 
```

请注意，没有约束力。另外，请注意`<CommandBinding>`. `<ContextMenu>`这是一个参考...... [http://www.wiredprairie.us/journal/2007/04/commandtarget_menuitem_context.html](http://www.wiredprairie.us/journal/2007/04/commandtarget_menuitem_context.html)

被禁用的命令在[这个站点上得到解决](http://www.wpftutorial.net/RoutedCommandsInContextMenu.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-09-11T22:32:00.597

对于任何寻找这个问题的答案的人 - 在搜索互联网之后，我发现最有效的答案是将以下内容包含在需要其“所有者”听到其命令的 MenuItem 的任何声明中。

通俗地说；如果您希望右键单击的内容可以听到上下文菜单的命令。添加此代码：

CommandTarget="{绑定路径=PlacementTarget，RelativeSource={RelativeSource AncestorType=ContextMenu}}"

例子：

```
 <ContextMenu>
        <MenuItem Header="Close" Command="Application.Close" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource AncestorType=ContextMenu}}" />
    </ContextMenu> 
```

这也适用于模板（我发现很多其他解决方案不支持）。这是对从其他地方获取的语句含义的解释（我对解释事情感到震惊）：

> 每个 FrameworkElement 都有一个 DataContext，它是一个任意对象。数据绑定的默认源是 DataContext。您可以使用 RelativeSource.Self 来更改绑定到 FrameworkElement 本身而不是其 DataContext 的源。因此，RelativeSource 部分只是将您从 FrameworkElement 的 DataContext 移到 FrameworkElement 本身“上一级”。进入 FrameworkElement 后，您可以指定其任何属性的路径。如果 FrameworkElement 是 Popup，它将具有 PlacementTarget 属性，该属性是 Popup 相对定位的另一个 FrameworkElement。
> 
> 简而言之，例如，如果您有一个相对于 TextBox 放置的 Popup，则该表达式会将 Popup 的 DataContext 设置为 TextBox，结果 {Binding Text} 在 Popup 主体中的某处将绑定到 TextBox 的文本.

老实说，我希望这些信息可以为 WPF 新手节省我这个周末经历的头痛……尽管它确实教会了我很多东西！

史蒂夫

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T06:14:39.380

据我了解，这就是发生的事情。当显示 ContextMenu 时，它会显示在一个 Popup 中，它基本上是一个单独的窗口。弹出窗口与窗口中的主要内容不属于同一可视树，因此命令不会“冒泡”到您的主窗口中。这就是为什么永远不会调用您的 CanExecute 方法的原因。例如，如果您将 CommandBindings 附加到 ContextMenu 本身，CanExecute 将被正确调用。

但是，我确实记得在某处读过，在某些情况下，弹出窗口不应该像普通窗口那样表现，某些事情应该“冒泡”。

我认为一定有一些内在的魔力在发生。例如，如果您只是将 TextBlock 更改为 TextBox，它似乎可以工作。我敢打赌，Reflector 会在 TextEditorBase 或类似的东西中向您展示一些额外的逻辑。

如果您真的需要使用 TextBlock，我可能会手动将 CommandBinding 添加到 ContextMenu 本身而不是窗口上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-25T15:34:54.813

我发现解决此问题的最简单方法是将上下文菜单移动到窗口资源并从那里引用它

```
<ContextMenu x:Key="ControlContextMenu">
    <ContextMenu.CommandBindings>
        <CommandBinding Command="{StaticResource CloseCommand}" Executed="CloseExecuted" CanExecute="CloseCanExecute" />
    </ContextMenu.CommandBindings>          
    <MenuItem Command="{StaticResource CloseCommand}" />
</ContextMenu> 
```

然后在 UIElement 上设置 ContextMenu 属性

```
<TextBlock ContextMenu="{StaticResource ControlContextMenu}"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T07:11:59.503

一个更简单的答案是在 Window 的构造函数中添加对*Focus()的调用。*我昨天遇到了这个问题，花了很多时间弄清楚发生了什么。我在这里写了一篇博客：[http ://cebla5.spaces.live.com/blog/cns!1B8262ED00250003!206.entry](http://cebla5.spaces.live.com/blog/cns!1B8262ED00250003!206.entry)

博客文章将解释为什么在构造函数中调用*Focus()*有效。

# python - 打破pydev中的异常

> ID：455552
> 
> 赞同：48
> 
> 时间：2009-01-18T17:39:09.497
> 
> 标签：python, eclipse, debugging, exception, pydev

是否可以让 pydev 调试器在异常时中断？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2011-07-11T20:09:05.963

这是 PyDev 作者在 Run > Manage Python Exception Breakpoints 下添加的

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-18T17:43:29.973

~~有**什么**例外吗？~~

如果我没记错的话，在 PyDev（在 Eclipse 中）这是可能的。

* * *

**编辑：**再次检查，检查[pdb 文档](http://docs.python.org/library/pdb.html)，找不到设置异常断点的方法。

如果我可能会建议一个非常粗略的解决方法，但如果你必须，你可以从一个`try-except`块中调用你的程序，在那里设置一个断点，一旦它在`except`块中中断，就进入堆栈并调试你的错误。

**另一个编辑**此功能[已添加到 PyDev](https://stackoverflow.com/a/6655894/17523)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-28T11:57:27.397

我尝试了大的 try-except 技巧，但它没有按预期工作，你得到了它中断的堆栈，即在 except: 块中，你无法到达从那里引发异常的堆栈，这是没有意义的。

更新： pydev 自 1.6.0 以来确实具有异常中断功能，但还没有 UI，需要一些代码： [https ://sourceforge.net/tracker/?func=detail&aid=2970886&group_id=85796&atid=577332](https://sourceforge.net/tracker/?func=detail&aid=2970886&group_id=85796&atid=577332)

# iphone - -[NSString sizeWithFont:forWidth:lineBreakMode:] 有什么用？

> ID：455553
> 
> 赞同：38
> 
> 时间：2009-01-18T17:40:25.330
> 
> 标签：iphone, objective-c, cocoa-touch

在我的问题“[我如何`-[NSString sizeWithFont:forWidth:lineBreakMode:]`去工作？](https://stackoverflow.com/questions/419222/how-do-i-get-nsstring-sizewithfontforwidthlinebreakmode-to-work) ”中，我了解到这`-[NSString sizeWithFont:constrainedToSize:lineBreakMode:]`实际上是我所需要的。

状态文档`-[NSString sizeWithFont:forWidth:lineBreakMode:]`解释说它实际上并没有将文本包装到其他行。那么我将如何使用它呢？（示例会有所帮助。）

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-18T18:32:10.203

它也适用于多行字符串。

基本上，它是一个函数，可以让您查看使用字体和换行模式呈现时字符串的大小。

当我想在某个区域显示可变长度文本时，我会在应用程序的几个位置使用它。

默认情况下，UILabel 将垂直居中文本。要使文本顶部对齐，您需要将标签的大小调整为仅包含其中的字符串所需的高度。

我使用这种方法来做到这一点。

我将如何使用它来做到这一点的示例如下：

```
//Calculate the expected size based on the font and linebreak mode of your label
CGSize maximumLabelSize = CGSizeMake(296,9999);

CGSize expectedLabelSize = [yourString sizeWithFont:yourLabel.font 
                        constrainedToSize:maximumLabelSize 
                        lineBreakMode:yourLabel.lineBreakMode]; 

//adjust the label the the new height.
CGRect newFrame = yourLabel.frame;
newFrame.size.height = expectedLabelSize.height;
yourLabel.frame = newFrame; 
```

您指定必须将文本放入的区域有多大，然后此方法会告诉您它将占用多少空间（根据需要包装）。此外，如果字符串会溢出您提供的矩形的边界，您可以判断然后决定如何显示文本。

对它的引用实际上并未包含文本，因为此方法实际上并未对文本执行任何操作。它只是虚拟地布置它并返回真正布置它需要多大的区域。

标签（或您用于文本的任何容器）负责执行包装/需要完成的其他操作。

希望有帮助。

克里斯。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-07-31T05:37:09.787

有一段时间，我认为这个程序被打破了。听起来这是计算*一段文本在以一定宽度包裹时**有多**高***的完美例程。然而，这不是它的作用。实际上，返回的高度总是单行。（顺便说一句，这是毫无意义的：`UIFont`'`-leading`返回相同的值。）

在撰写本文时引用文档：

> 尽管它会计算换行的位置，但此方法实际上并不将文本换行到其他行；[...]

这句话让我困惑了很久。我的想法是这样的：

*   计算换行符，但不换行。诶？
*   也许他们的意思是接收`NSString`本身不会被改变以反映换行符？但无论如何我都不希望这样？
*   这句话与自己不一致。我别无选择，只能忽略它。

然而，事实证明存在与我们看到的行为相匹配的含义。似乎他们的意思是：

> 此例程将计算第*一个*换行符将出现的位置，并且为了计算边界框而忽略此之后的所有文本。

因此，返回的边界框将具有单行的高度和最大指定的宽度。（宽度可能会更小，具体取决于计算换行符的位置，或者文本是否足够短以至于不需要最大宽度。）

要，嗯，回答实际问题：它有什么用？我自己没有发现任何有用的东西：只有我认为有用但没有用的东西。然而，一些让人想到的事情是：

*   将单行文本居中。我在这里考虑按钮和/或标题。（虽然`UILabel`and`UIButton`可以做到，但有时你想自己画。）
*   计算较长文本“提取”的范围。在这里，我正在考虑您可能希望在哪里显示一段更大的文本片段。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T18:00:50.327

听起来这对单行标签很有用。例如，如果您正在绘制一个可能被截断或有换行符的字符串，但您实际上不会绘制多条线。知道字符串的确切高度和宽度仍然很有帮助，因此您可以将其准确定位在您想要的位置（并在其周围绘制其他 UI 项）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-21T16:11:26.063

这是我在应用 PyjamaSam 示例中的一些原则后得出的结论：

```
AnnotationPin *myAnnotation = (AnnotationPin *)annotation;

self = [super initWithAnnotation:myAnnotation reuseIdentifier:reuseIdentifier];
self.backgroundColor = [UIColor greenColor];
self.frame = CGRectMake(0,0,30,30);
imageView = [[UIImageView alloc] initWithImage:myAnnotation.THEIMAGE];
imageView.frame = CGRectMake(3,3,20,20);
imageView.layer.masksToBounds = NO;
[self addSubview:imageView];
[imageView release];

CGSize titleSize = [myAnnotation.THETEXT sizeWithFont:[UIFont systemFontOfSize:12]];
CGRect newFrame = self.frame;
newFrame.size.height = titleSize.height + 12;
newFrame.size.width = titleSize.width + 32;
self.frame = newFrame;
self.layer.borderColor = [UIColor colorWithRed:0 green:.3 blue:0 alpha:1.0f].CGColor;
self.layer.borderWidth = 3.0;

UILabel *infoLabel = [[UILabel alloc] initWithFrame:CGRectMake(26,5,newFrame.size.width-32,newFrame.size.height-12)];
infoLabel.text = myAnnotation.title;
infoLabel.backgroundColor = [UIColor clearColor];
infoLabel.textColor = [UIColor blackColor];
infoLabel.textAlignment = UITextAlignmentCenter;
infoLabel.font = [UIFont systemFontOfSize:12];

[self addSubview:infoLabel];
[infoLabel release]; 
```

在此示例中，我将自定义引脚添加到 MKAnnotation 类，该类根据文本大小调整 UILabel 的大小。它还在视图的左侧添加了一个图像，因此您会看到一些管理适当间距以处理图像和填充的代码。

关键是使用 CGSize titleSize = [myAnnotation.THETEXT sizeWithFont:[UIFont systemFontOfSize:12]]; 然后重新定义视图的尺寸。您可以将此逻辑应用于任何视图，但它不会像 Pyjama 那样处理换行符。

尽管 Pyjama 的回答对某些人有用，但对我不起作用。这是一个详细的解释，如果你想要一个带有图像和可调整大小的 UILabel 的动态自定义 MKAnnotation pin，你应该在去其他任何地方之前立即尝试。

# php - 日期时间到 Unix 时间戳

> ID：455554
> 
> 赞同：18
> 
> 时间：2009-01-18T17:41:54.750
> 
> 标签：php, timestamp

是否有人坐在 PHP 函数上将格式 0000-00-00 00:00:00(datetimesql) 的日期转换为 unix 时间戳？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-29T03:35:43.137

要在 PHP 5.2 中执行此操作，您可以执行以下操作：

```
$datetime = new DateTime();
echo $datetime->format('U'); 
```

从 PHP 5.3 开始，一种更新的方法是：

```
$datetime = new DateTime();
echo $datetime->getTimestamp(); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-18T17:47:41.057

您使用 SQL 标记此问题的另一个选项：MySQL 函数`FROM_UNIXTIME`和`UNIX_TIMESTAMP`-> [MySQL 手册](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)

```
从表中选择 UNIX_TIMESTAMP(datetime_column)

```

这通常比 PHP 函数调用更快。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-18T17:55:46.017

@bartek - 正如你所指出的，PHP 的[strtotime](http://php.net/strtotime)函数非常适合这个。它可以处理最常见的日期格式，包括像“明天”或“+5 个月”这样的字符串。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-30T16:30:15.627

我在这里为您提供解决方案：

```
/* From MySQL datetime to Unix Timestamp 2003-12-30 23:30:59 -> 1072834230 */
function convertMysqlDateTimeToUnixTimeStamp($date) {
    $yr=strval(substr($date,0,4));
    $mo=strval(substr($date,5,2));
    $da=strval(substr($date,8,2));
    $hr=strval(substr($date,11,2));
    $mi=strval(substr($date,14,2));
    $se=strval(substr($date,17,2));
    return mktime($hr,$mi,$se,$mo,$da,$yr);
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-18T17:44:40.640

用于`strptime()`解析时间并将其转换为结构化数组。

然后将结果传递给`mktime()`函数以获得 UNIX 时间戳。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-08-26T21:33:54.547

将 wvanbergen 的解决方案封装成一个函数（为了您的方便）

```
//Convert SQL datetime to unixtime -- by johnboiles
function datetimeToUnixtime($datetime){
    $result = mysql_query("select unix_timestamp('$datetime')");
    $unixtime = mysql_fetch_array($result);
    return $unixtime[0];
} 
```

# design-patterns - 三层与n层之间的区别

> ID：455555
> 
> 赞同：17
> 
> 时间：2009-01-18T17:42:03.063
> 
> 标签：design-patterns, architecture, n-tier-architecture, tiers

我刚刚遇到以下句子：

> 随着行业从三层模型转变为 n 层模型，对象关系阻抗失配变得更加普遍。

但是我找不到三层和n层之间区别的简明解释。我知道三层是什么，我假设 n 层只是增加一层或多层。我只是不确定这些额外的层级是什么。如果有人有简短的解释或只是一个好的链接，那将不胜感激。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-18T18:27:43.270

在开发中，我们将层理解为“**责任级别**”抽象。

这种级别的责任将概念组合在一起，以提供对现实的连贯语义视图，或者至少与现实相似的东西。

从这个意义上说，所谓的 3 层模型或 n 层模型只是该概念的不同实现。

一个很好的层级示例遵循 jerarquical 模型，其中责任被仔细地分配给适当的人。例如，一个普通的企业有商业、营销、系统、开发和测试部门（例如），它们代表了业务层级。这样一来，职责就很明确了，开发提供产品，测试测试，市场推广和商业销售，所有这些都让系统保持基础设施运行（只是一个例子）。

这个比喻最初是用 3 层模型来处理的，其中确定了三个层。通常这层是**数据库抽象层**，它负责数据库的通信和抽象，**业务规则层**，它保存描述业务流程的规则，以及抽象用户与系统交互的**用户界面层。**

这样，我们对每一层的职责都有角色，这样如果用户需要与系统交互，他将与一层通信，而不是在整个系统中搞砸。

N 层代表了前一个概念的演变，它使用更多层来满足特定需求。通常用户界面层和数据库抽象层都保持不变，因为它们的角色非常明确，而业务规则层则进一步细化。

为此，我们始终考虑问题的特征以及我们现在和将来要提供的功能。例如，如果一个应用程序需要与智能客户端一起工作，或者它预见到与智能客户端一起工作，那么业务层通常分为代理层和后端层，首先将调用路由到它们应该去的地方。

最后，重要的是在不同层之间**抽象职责的概念**，并将所有相关操作从语义视图集中在同一个地方。

请注意，此外，n 层架构允许在开发人员之间分配这些“职责”。这样，一个给定的团队可以负责数据库抽象层，而其他团队负责代理层，另一个团队负责图形抽象层。当团队成员需要访问数据库时，他会查找 DAL 文档并使用所提供的工具之一，或者要求 DAL 团队提供他需要的功能，这样他就不会直接访问数据库，而是**通过人员更好地了解数据库本身的设计和复杂性。**

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-18T19:53:54.203

**如果我们将层级视为蛋糕层；** 每一层都有自己的成分，做自己的事情。每个应用程序的层只与它上面或下面的层交互。

3 层表示蛋糕有 3 层。通常是底部的数据，然后是应用程序逻辑层（PHP/ruby/etc），然后是顶部的表示层（html）

拥有 n 层架构意味着您设计了多层结构。您拥有的层数将取决于您决定如何制作它。

对于更大的或 Web 应用程序，这似乎更有意义。

我通常最终得到一个 5 层的应用程序。每一层只能与其上层或下层交互。这可以在您的应用程序中提供出色的可扩展性和标准化。

**客户层**

网页浏览器

* * *

**表示层**

渲染 HTML - Coldfusion/Flash/Ruby/PHP 等。

* * *

**业务逻辑层**

根据需要运行流程和计算 - Coldfusion/Flash/Ruby/PHP 等。

* * *

**数据集成层**

（来自我的开发语言、存储过程等的查询）

* * *

**数据层**

（数据库 - MySQL 等）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-18T18:01:05.817

报价似乎来自此[代码项目](http://www.codeproject.com/KB/showcase/object_relational_mapping.aspx)页面。它似乎也很好地解释了 n 层以包括 Web 服务、javascript、工作流等。所有 3 层模型不一定包括的东西。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-18T18:17:28.920

n-tier 意味着 n 是*任意*数字 - 当 n=3 时，它与 n-tier 相同。

3 层的通常定义是表示、逻辑和数据（以任何顺序），是的，SOA 可能会使新手感到困惑，因为有时它位于数据层，有时位于逻辑层，有时同时位于逻辑层和数据层。

整个主题是……主观的。如果您需要一些层，则将其称为 n 层 - 如果您知道 n = 7，则将其称为 7 层或 n 层。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-18T17:56:53.877

嘿，我什至无法定义 3 层。有时他们在客户端上打折 javascript，有时在客户端和客户端 Web 浏览器上的 javascript 被认为是另一层。因此，如果您假设数据库 = 第 3 层、Web 服务器 = 第 2 层、客户端 Web 浏览器 = 第 1 层，那么与数据库对话的 ASP 页面可以是 3 层。而其他时候 Web 服务器 = 第 1 层、中间件 = 第 2 层、数据库 =第 3 层。这真的取决于谁在编写定义/书籍。

一般来说，n 层似乎是指更多地拆分中间件层。但除此之外，我没有看到一致的定义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T17:49:26.497

那句话出自哪里？他们指的是什么行业？我不得不想象这与[SOA](http://en.wikipedia.org/wiki/Service-oriented_architecture)有关，因为这是唯一对这种陈述有意义的事情。

我听到的大多数发表这种声明的人都认为，在面向服务的领域中，每个服务在某种程度上都是它自己的层。我不同意，因为大多数情况下，这些不同的服务在逻辑上无论如何都可以分为常见的三层（表示、逻辑和数据）。但同样，这一切都非常主观。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-16T15:23:00.400

嗨，请检查此链接，以便您对此有所了解

[http://msdn.microsoft.com/en-us/library/ms973829.aspx](http://msdn.microsoft.com/en-us/library/ms973829.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-27T15:33:47.090

这个[关于应用程序架构的 Wiki 书籍章节](http://www.guidanceshare.com/wiki/Application_Architecture_Guide_-_Chapter_9_-_Layers_and_Tiers#Cross-Cutting_Components)是关于层、层和决定您需要使用什么的简单指南。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T17:43:53.700

如果没有在上下文中看到这句话，我认为它指的是服务和中间件的爆炸式增长。

# java - 来自 Xpand 的样本 -

> ID：455563
> 
> 赞同：2
> 
> 时间：2009-01-18T17:45:07.707
> 
> 标签：java, eclipse, xtext, oaw, xpand

我能得到一些关于 XPand 的好教程吗？我需要获取有关 LET 等命令的信息。如果有人能在上面贴一些样本就更好了。

我面临的问题就像..我运行一个“for”循环，在检查了一些条件后我需要增加一个计数器。但我不能这样做。当我增加计数器时，它会打印到输出文件中。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T23:57:18.110

有一个模板 Ant 脚本的[工作示例。](http://www.peterfriese.de/using-xpand-in-your-eclipse-wizards/)同一篇文章在 DZone 上重新发布。

更具体地说，[本文](http://www.bar54.de/benjamin.klatt-Xpand.pdf)介绍了这个关于`LET`运算符的示例：

```
<<LET packageName + "." + className AS fqn>>
  the fully qualified name is: <<fqn>>;
<<ENDLET>> 
```

最后，来自[openArchiteureWare 论坛](http://www.openarchitectureware.org/forum/viewtopic.php?forum=2&showtopic=11468&highlight=xpand)上的这篇文章：

> LET 语句非常简单：它创建一个具有指定值的局部常量以及该常量在其中可见的范围。这也意味着 LET 语句不能用于循环行为。
> 
> 事实上，如果你尝试循环，你基本上是在错误的地方解决问题。XPand 模板仅用于生成文本工件，而生成的大多数逻辑应在 Xtensions 中实现。Xtend 也没有循环结构，但如果您愿意遵循函数式编程范式，则可以找到替代方案。另外，请注意 oaw.List 的 'indexOf' 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-14T12:25:35.437

该答案与使用第二段发布的第二个问题有关。您可以使用链运算符 (->) 阻止表达式值被打印。例如：

```
<<counterInc()->"">> 
```

请参阅此处的官方在线帮助文​​档中的 “ *throwError (Object o) ”示例：http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.xpand.doc%2Fhelp%2Fch04s02* [。 html](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.xpand.doc%2Fhelp%2Fch04s02.html)

您可能还会发现“*计数器扩展*”部分对 Xpand 中的计数器操作很有帮助

# c# - 导入 OFX 文件

> ID：455568
> 
> 赞同：4
> 
> 时间：2009-01-18T17:45:56.490
> 
> 标签：c#, currency, ofx

我正在尝试使用 Quicken 和 Money 使用的 OFX​​ 协议导入财务信息。我已经很好地环顾了一个开源库，但到目前为止都是空的。

有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T17:52:22.140

[“将ofx（Microsoft Money）文件转换为DataSet的类”](http://www.codeproject.com/KB/aspnet/Ofx_to_DataSet.aspx)怎么样？

请注意，我对 OFX 不是很熟悉 - 这只是一个快速搜索结果......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T15:37:33.673

[GnuCash](http://www.gnucash.org/)可以做到，而且看起来他们使用[的是 LibOFX](http://libofx.sourceforge.net/)。

[此外，这里](http://www.jongsma.org/gc/)还有一些 python 脚本和 OFX 资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-24T15:15:12.610

PocketSense 是用 Python 编写的，并将 OFX 从服务器获取到 Microsoft Money。

# syntax - 如何在“让”定义中使用模式匹配？

> ID：455571
> 
> 赞同：11
> 
> 时间：2009-01-18T17:46:39.437
> 
> 标签：syntax, f#, pattern-matching

我刚刚注意到 F# 允许我将 let 绑定与文字和其他模式一起使用，如下所示：

```
let fib 0 = 1
let exists item [] = false
let car (hd :: tl) = hd
let cdr (hd :: tl) = tl 
```

F# 正确地将这些函数解释为一种模式匹配，因为给了我以下警告：

> 警告 1 此表达式的模式匹配不完整。例如，值 '1' 将不匹配
> 
> 警告 2 此表达式的模式匹配不完整。例如，值“[_]”将不匹配
> 
> 等等

这些函数按预期工作，但我想以这种样式定义一个具有完整模式匹配的函数，但是我在 F# 手册中找不到关于这种替代模式匹配语法的任何信息。

我知道我可以使用`let whatever = function ...`并`let whatever x = match x with ...`获得我想要的结果，但是我刚刚发现了另一种模式匹配语法，如果我不知道如何使用它，它会一直困扰着我。

**如何使用上面显示的替代模式匹配语法编写函数？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-18T18:25:07.953

AFAIK，在 F# 中无法声明具有相同名称和不同模式匹配签名的多个 let 绑定。我相信与您正在寻找的最接近的构造是函数规则表达式。

以汽车为例

```
let car = function
    | hd::tl -> hd
    | [] -> failwith "empty list" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-18T19:46:35.933

JaredPar 是对的，F# 没有 Haskell 在这里所做的语法形式。

F# 形式对于打破开放的单案例区分联合或定义具有不完全匹配的函数（例如在空列表上失败的“汽车”示例）非常有用。这只是语言中几乎所有名称绑定都是通过模式完成的事实的结果。由于您描述的确切原因，这种语法形式（使用参数模式定义函数）在实践中通常不太有用。

我认为 Haskell 在句法形式方面比 ML 做得更好，但 F# 的根源在于 ML。好处是 F# 的一个很好的子集可以与 OCaml 交叉编译（这有助于引导 F# 语言和用户社区）；缺点是 F# 被一些丑陋/有限的语法“卡住”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-21T22:33:49.747

显然，F# 的模式匹配比我们在普通开发中使用的要强大得多。

首先，您可以一次绑定多个值。通常，您将使用`List.partition`：

```
let data = [7;0;0;0;1;0;1;1;1;1;0;0;1;1;0]
let ones, others = data |> List.partition ((=) 1) // bind two values 
```

作为旁注，您可以将多个标识符绑定到相同的值：

```
let (a & b) = 42 // a = 42; b = 42 
```

`let`为了简单起见，让我们从一个简单的绑定开始。

```
let hd::tl = data 
```

> **警告 FS0025**：此表达式的模式匹配不完整。例如，值“[]”可能表示模式未涵盖的情况。

为了缓解这种情况，我们必须为空列表添加另一个案例：

```
let (hd::tl) | [] = data 
```

> **错误 FS0018**：此“或”模式的两侧绑定不同的变量集

这是真的；如果列表为空，则`hd`保持`tl`未绑定。很容易绑定`tl`同一个空列表：

```
let (hd::tl) | ([] as tl) = data 
```

但是，错误**错误 FS0018**并没有消失。事实上，我们还必须为`hd`.
以下肮脏的技巧将做到这一点。

```
let (hd::tl, _) | ([] as tl , hd) = data, 42 
```

上面的行将绑定`hd`到`data`的头部，以防列表不为空，**或者**使用`tuple`.

**注意**我还没有找到嵌入`42`到`let`构造中的方法。

最后，`car`功能相同：

```
let car ((hd::tl, _) | ([] as tl, hd)) = hd
let foo = car(data, 42) // foo = 7
let bar = car([], 42)   // bar = 42 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-16T14:32:46.530

> 如何使用上面显示的替代模式匹配语法编写函数？

正如您所拥有的，但仅当一种模式详尽无遗时。这很有用的明显示例包括元组和记录以及单例联合和活动模式。

每当您执行以下操作时，您都会使用此语言功能：

```
let f(a, b) = ... 
```

所以这概括为：

```
let f(a, (b, c)) = ... 
```

您甚至可以使用它来选择默认值或`Some value`：

```
let def(x, None | _, Some x) = x 
```

顺便说一句，您建议的样式在 Haskell 之前已在 SML 中使用，而 SML 是一种 ML，因此这显然与 Haskell vs ML 无关。我实际上更喜欢 OCaml/F# 样式，因为它的重复性较低：

```
fun descriptiveFunctionName [] = true
fun descriptiveFunctionName (_::_) = false 
```

对比

```
let descriptiveFunctionName = function
  | [] -> true
  | _::_ -> false 
```

这对于使用自文档标识符具有真正价值的非学术代码来说更好。

# asp.net - 在 asp.net 应用程序中使用的视觉并排文本比较工具/例程

> ID：455574
> 
> 赞同：1
> 
> 时间：2009-01-18T17:47:45.597
> 
> 标签：asp.net, algorithm

我确信必须存在一个通用例程或库来执行此操作，但我需要能够向用户显示字符串/文本文件的两个版本的“之前”和“之后”比较。

例如，旧的视觉源保险箱有一个很棒的工具，它可以显示两个文件并突出显示添加、删除和更改。

我不想重新发明轮子，有人知道我可以使用或用作起点的 VB 或 C# 中的例程吗？如果没有，是否有此类比较的通用搜索词，以便我可以自己搜索...不知道该怎么称呼它，所以很难用谷歌搜索...

顺便说一句：这些将在 asp.net 应用程序中呈现为 HTML。

-谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T19:06:07.247

我猜您正在寻找一种差异算法，我会阅读[差异](http://en.wikipedia.org/wiki/Diff)及其算法。另一个论坛上也有关于它的另一个[讨论](http://discuss.joelonsoftware.com/default.asp?joel.3.109148.6)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T17:57:23.580

我不知道 VS 插件，但也许您正在寻找[Beyond Compare](http://www.scootersoftware.com/)之类的东西？

# javascript - Python 和 JavaScript 之间的 JSON 日期时间

> ID：455580
> 
> 赞同：404
> 
> 时间：2009-01-18T17:51:11.843
> 
> 标签：javascript, python, json

我想使用 JSON 从 Python 以序列化形式发送 datetime.datetime 对象，并使用[JSON](http://en.wikipedia.org/wiki/JSON)在 JavaScript 中反序列化。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2010-04-21T03:09:43.707

您可以将 'default' 参数添加到 json.dumps 来处理此问题：

```
date_handler = lambda obj: (
    obj.isoformat()
    if isinstance(obj, (datetime.datetime, datetime.date))
    else None
)
json.dumps(datetime.datetime.now(), default=date_handler)
'"2010-04-20T20:08:21.634121"' 
```

这是[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)格式。

更全面的默认处理函数：

```
def handler(obj):
    if hasattr(obj, 'isoformat'):
        return obj.isoformat()
    elif isinstance(obj, ...):
        return ...
    else:
        raise TypeError, 'Object of type %s with value of %s is not JSON serializable' % (type(obj), repr(obj)) 
```

更新：添加了类型和值的输出。
更新：也处理日期

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-01-18T22:26:56.610

对于跨语言项目，我发现包含[RfC 3339](http://www.ietf.org/rfc/rfc3339.txt)日期的字符串是最好的方法。RfC 3339 日期如下所示：

```
 1985-04-12T23:20:50.52Z 
```

我认为大多数格式是显而易见的。唯一有点不寻常的可能是结尾的“Z”。它代表 GMT/UTC。您还可以为 CEST（德国夏季）添加一个时区偏移量，例如 +02:00。我个人更喜欢在显示之前将所有内容都保留在 UTC 中。

对于显示、比较和存储，您可以将其保留为所有语言的字符串格式。如果您需要计算日期，则可以轻松地将其转换回大多数语言中的本机日期对象。

所以像这样生成JSON：

```
 json.dump(datetime.now().strftime('%Y-%m-%dT%H:%M:%SZ')) 
```

不幸的是，Javascript 的 Date 构造函数不接受 RfC 3339 字符串，但Internet 上有许多可用的[解析器。](http://blog.dansnetwork.com/2008/11/01/javascript-iso8601rfc3339-date-parser/)

[huTools.hujson](https://github.com/hudora/huTools/blob/master/huTools/hujson.py)尝试处理您在 Python 代码中可能遇到的最常见的编码问题，包括日期/日期时间对象，同时正确处理时区。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2011-05-25T20:55:37.350

我已经解决了。

假设您有一个使用 datetime.now() 创建的 Python 日期时间对象*d 。*其值为：

```
datetime.datetime(2011, 5, 25, 13, 34, 5, 787000) 
```

您可以将其序列化为 JSON 作为 ISO 8601 日期时间字符串：

```
import json    
json.dumps(d.isoformat()) 
```

示例日期时间对象将被序列化为：

```
'"2011-05-25T13:34:05.787000"' 
```

这个值，一旦在 Javascript 层收到，就可以构造一个 Date 对象：

```
var d = new Date("2011-05-25T13:34:05.787000"); 
```

从 Javascript 1.8.5 开始，Date 对象有一个 toJSON 方法，该方法返回标准格式的字符串。因此，要将上述 Javascript 对象序列化回 JSON，命令将是：

```
d.toJSON() 
```

这会给你：

```
'2011-05-25T20:34:05.787Z' 
```

这个字符串，一旦在 Python 中接收，就可以反序列化回一个 datetime 对象：

```
datetime.strptime('2011-05-25T20:34:05.787Z', '%Y-%m-%dT%H:%M:%S.%fZ') 
```

这会产生以下日期时间对象，它与您开始使用的对象相同，因此是正确的：

```
datetime.datetime(2011, 5, 25, 20, 34, 5, 787000) 
```

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2010-06-15T21:45:25.167

使用`json`，您可以继承 JSONEncoder 并覆盖 default() 方法以提供您自己的自定义序列化程序：

```
import json
import datetime

class DateTimeJSONEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, datetime.datetime):
            return obj.isoformat()
        else:
            return super(DateTimeJSONEncoder, self).default(obj) 
```

然后，您可以这样称呼它：

```
>>> DateTimeJSONEncoder().encode([datetime.datetime.now()])
'["2010-06-15T14:42:28"]' 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2010-07-13T09:26:57.907

这是使用标准库`json`模块递归编码和解码 datetime.datetime 和 datetime.date 对象的一个​​相当完整的解决方案。这需要 Python >= 2.6 `%f`，因为从那时起才支持 datetime.datetime.strptime() 格式字符串中的格式代码。对于 Python 2.5 支持，`%f`在尝试转换它之前，从 ISO 日期字符串中删除并去除微秒，但当然，你会失去微秒精度。为了与来自其他来源的 ISO 日期字符串（可能包括时区名称或 UTC 偏移量）进行互操作，您可能还需要在转换之前去除日期字符串的某些部分。有关 ISO 日期字符串（和许多其他日期格式）的完整解析器，请参阅第三方[dateutil](http://labix.org/python-dateutil)模块。

仅当 ISO 日期字符串是 JavaScript 文字对象表示法或对象内的嵌套结构中的值时，解码才有效。ISO 日期字符串是顶级数组的项目，*不会*被解码。

即这有效：

```
date = datetime.datetime.now()
>>> json = dumps(dict(foo='bar', innerdict=dict(date=date)))
>>> json
'{"innerdict": {"date": "2010-07-15T13:16:38.365579"}, "foo": "bar"}'
>>> loads(json)
{u'innerdict': {u'date': datetime.datetime(2010, 7, 15, 13, 16, 38, 365579)},
u'foo': u'bar'} 
```

这也是：

```
>>> json = dumps(['foo', 'bar', dict(date=date)])
>>> json
'["foo", "bar", {"date": "2010-07-15T13:16:38.365579"}]'
>>> loads(json)
[u'foo', u'bar', {u'date': datetime.datetime(2010, 7, 15, 13, 16, 38, 365579)}] 
```

但这并没有按预期工作：

```
>>> json = dumps(['foo', 'bar', date])
>>> json
'["foo", "bar", "2010-07-15T13:16:38.365579"]'
>>> loads(json)
[u'foo', u'bar', u'2010-07-15T13:16:38.365579'] 
```

这是代码：

```
__all__ = ['dumps', 'loads']

import datetime

try:
    import json
except ImportError:
    import simplejson as json

class JSONDateTimeEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, (datetime.date, datetime.datetime)):
            return obj.isoformat()
        else:
            return json.JSONEncoder.default(self, obj)

def datetime_decoder(d):
    if isinstance(d, list):
        pairs = enumerate(d)
    elif isinstance(d, dict):
        pairs = d.items()
    result = []
    for k,v in pairs:
        if isinstance(v, basestring):
            try:
                # The %f format code is only supported in Python >= 2.6.
                # For Python <= 2.5 strip off microseconds
                # v = datetime.datetime.strptime(v.rsplit('.', 1)[0],
                #     '%Y-%m-%dT%H:%M:%S')
                v = datetime.datetime.strptime(v, '%Y-%m-%dT%H:%M:%S.%f')
            except ValueError:
                try:
                    v = datetime.datetime.strptime(v, '%Y-%m-%d').date()
                except ValueError:
                    pass
        elif isinstance(v, (dict, list)):
            v = datetime_decoder(v)
        result.append((k, v))
    if isinstance(d, list):
        return [x[1] for x in result]
    elif isinstance(d, dict):
        return dict(result)

def dumps(obj):
    return json.dumps(obj, cls=JSONDateTimeEncoder)

def loads(obj):
    return json.loads(obj, object_hook=datetime_decoder)

if __name__ == '__main__':
    mytimestamp = datetime.datetime.utcnow()
    mydate = datetime.date.today()
    data = dict(
        foo = 42,
        bar = [mytimestamp, mydate],
        date = mydate,
        timestamp = mytimestamp,
        struct = dict(
            date2 = mydate,
            timestamp2 = mytimestamp
        )
    )

    print repr(data)
    jsonstring = dumps(data)
    print jsonstring
    print repr(loads(jsonstring)) 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-01-18T20:51:42.010

如果您确定只有 Javascript 会使用 JSON，我更喜欢`Date`直接传递 Javascript 对象。

对象上的`ctime()`方法`datetime`将返回 Javascript Date 对象可以理解的字符串。

```
import datetime
date = datetime.datetime.today()
json = '{"mydate":new Date("%s")}' % date.ctime() 
```

Javascript 很乐意将其用作对象文字，并且您已经内置了 Date 对象。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-08-26T10:45:12.237

游戏后期... :)

一个非常简单的解决方案是修补 json 模块默认值。例如：

```
import json
import datetime

json.JSONEncoder.default = lambda self,obj: (obj.isoformat() if isinstance(obj, datetime.datetime) else None) 
```

现在，您可以使用**json.dumps()**就好像它一直支持日期时间...

```
json.dumps({'created':datetime.datetime.now()}) 
```

如果您需要对 json 模块的此扩展始终启动并且不希望更改您或其他人使用 json 序列化的方式（无论是否在现有代码中），那么这是有道理的。

请注意，有些人可能认为以这种方式修补库是不好的做法。如果您希望以多种方式扩展您的应用程序，则需要特别小心——在这种情况下，我建议使用 ramen 或 JT 的解决方案，并在每种情况下选择适当的 json 扩展。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-01-08T19:58:55.057

除了**时间戳**之外，没有太多可以添加到社区 wiki 答案中！

Javascript 使用以下格式：

```
new Date().toJSON() // "2016-01-08T19:00:00.123Z" 
```

Python 端（对于`json.dumps`处理程序，请参阅其他答案）：

```
>>> from datetime import datetime
>>> d = datetime.strptime('2016-01-08T19:00:00.123Z', '%Y-%m-%dT%H:%M:%S.%fZ')
>>> d
datetime.datetime(2016, 1, 8, 19, 0, 0, 123000)
>>> d.isoformat() + 'Z'
'2016-01-08T19:00:00.123000Z' 
```

如果你把那个 Z 去掉，像 angular 这样的前端框架就不能在浏览器本地时区显示日期：

```
> $filter('date')('2016-01-08T19:00:00.123000Z', 'yyyy-MM-dd HH:mm:ss')
"2016-01-08 20:00:00"
> $filter('date')('2016-01-08T19:00:00.123000', 'yyyy-MM-dd HH:mm:ss')
"2016-01-08 19:00:00" 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-12-16T03:22:24.107

在蟒蛇方面：

```
import time, json
from datetime import datetime as dt
your_date = dt.now()
data = json.dumps(time.mktime(your_date.timetuple())*1000)
return data # data send to javascript 
```

在 JavaScript 方面：

```
var your_date = new Date(data) 
```

其中数据是python的结果

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-04-20T10:01:34.320

我的建议是使用图书馆。pypi.org 上有几个可用的。

我用这个，效果很好：[https ://pypi.python.org/pypi/asjson](https://pypi.python.org/pypi/asjson)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-03-21T18:46:45.097

对于 Python 到 JavaScript 的日期转换，日期对象需要采用特定的 ISO 格式，即 ISO 格式或 UNIX 编号。如果 ISO 格式缺少一些信息，那么您可以先使用 Date.parse 转换为 Unix 编号。此外， Date.parse 也适用于 React，而 new Date 可能会触发异常。

如果您有一个没有毫秒的 DateTime 对象，则需要考虑以下内容。：

```
 var unixDate = Date.parse('2016-01-08T19:00:00') 
  var desiredDate = new Date(unixDate).toLocaleDateString(); 
```

示例日期同样可以是 API 调用后 result.data 对象中的一个变量。

有关以所需格式显示日期的选项（例如显示长工作日），请查看[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-06T19:04:42.370

显然[，“正确的”JSON（以及 JavaScript）日期格式](https://stackoverflow.com/questions/10286204/the-right-json-date-format#15952652)是 2012-04-23T18:25:43.511Z - UTC 和“Z”。如果没有此 JavaScript 将在从字符串创建 Date() 对象时使用 Web 浏览器的本地时区。

对于“幼稚”时间（Python 称之为没有时区的时间，并且假设是本地时间），下面将[强制本地时区](https://stackoverflow.com/questions/2720319/python-figure-out-local-timezone)，以便它可以正确转换为 UTC：

```
def default(obj):
    if hasattr(obj, "json") and callable(getattr(obj, "json")):
        return obj.json()
    if hasattr(obj, "isoformat") and callable(getattr(obj, "isoformat")):
        # date/time objects
        if not obj.utcoffset():
            # add local timezone to "naive" local time
            # https://stackoverflow.com/questions/2720319/python-figure-out-local-timezone
            tzinfo = datetime.now(timezone.utc).astimezone().tzinfo
            obj = obj.replace(tzinfo=tzinfo)
        # convert to UTC
        obj = obj.astimezone(timezone.utc)
        # strip the UTC offset
        obj = obj.replace(tzinfo=None)
        return obj.isoformat() + "Z"
    elif hasattr(obj, "__str__") and callable(getattr(obj, "__str__")):
        return str(obj)
    else:
        print("obj:", obj)
        raise TypeError(obj)

def dump(j, io):
    json.dump(j, io, indent=2, default=default) 
```

为什么这么难。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-03-01T22:33:45.503

只需这样做：

```
r = json.dumps(your_json_data, default=str)
your_json_data = json.loads(r) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/i66ok.png)](https://i.stack.imgur.com/i66ok.png)

# graphics - 使用硬件生成的原语进行碰撞检测

> ID：455598
> 
> 赞同：2
> 
> 时间：2009-01-18T18:00:33.027
> 
> 标签：graphics, collision-detection, shader

有很多关于碰撞检测的文献，我已经阅读了至少足够多的部分，以便对大多数技术相当熟悉。但是，有一些事情一直困扰着我，我想，既然 StackOverflow 可以同时访问一大群聪明的头脑，我会先在这里问一下，然后再在书架上四处寻找。

在这个时代，越来越多的工作被委派给 GPU 而不是 CPU，在很多情况下这是一件好事。例如，有几何着色器可以创建新的几何图形，或者（稍微不那么新，但仍然很吸引人）顶点着色器，您可以通过一堆顶点访问它们，并且会从中产生一些优雅的东西。不过我正在考虑的是，由于这些原语仅存在于图形硬件上，您将如何使用这些原语执行可靠的碰撞检测？假设我有某种极其简化的网格，它在顶点着色器中被置换（我没有具体问题，我更喜欢这个想法，而且我还没有深入了解几何着色器）。

到目前为止，我考虑的是从合适的角度单独的“渲染”通道，或多或少地关闭阴影，也许是较低分辨率的网格，渲染我的第二个基元的内部（面向内翻转）以及我想要的网格针对网格进行测试并执行遮挡查询。如果网格完全被遮挡，则不会有交集。这当然需要我的第二个原语是凸的。

不知何故，我觉得随着基元数量的增加，这种测试将非常昂贵（即使可以直接剔除大部分）。还有其他人有其他想法或技术吗？我对opengl和cg比directx更熟悉，但是如果你在directx中有一些例子，我想我可以找出opengl对应的部分。

感谢所有想法，所以请集思广益。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T18:06:51.673

听起来 Dan Horn 在[GPU Gems 2](http://developer.nvidia.com/object/gpu_gems_2_home.html)中的文章“GPGPU 应用程序的流减少操作”正是您想要的。像所有章节一样，它[可以在线](http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Content/36.zip)免费获得。

# c# - 为“车库”软件项目招募虚拟团队的最佳方式？

> ID：455601
> 
> 赞同：2
> 
> 时间：2009-01-18T18:01:21.293
> 
> 标签：c#, windows-mobile, projects, collaboration

我有一个用 C# 为 Windows Mobile 实现的杀手级应用程序的工作原型。它需要包装成商品并有效销售。可能还转换为以网络为中心的平台。

现在，我想组建一个由经验丰富、可能是半退休的 IT 专业人员组成的社区。他们应该愿意为乐趣和自由而工作，着眼于未来的利润。我意识到没有多少人可以选择在这样的事情上冒险，但是 - 嘿 - 在全球范围内应该不止一个。

我用谷歌搜索了上述的变体，但没有骰子。而且我并没有真正将 SourceForge 等人视为招聘的场所，而是更多地作为您在项目进行时放置代码库的地方。我不精通开源，我不确定我是否想在源代码上“打开和服”，直到有一些审查过程（当然是双向的）。

所以，换个说法：为这样的项目招聘人员的最佳网站是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T18:23:25.617

老实说，您可能想使用[LinkedIn 之](http://www.linkedin.com)类的社交网站。

对于这样一个有风险的项目，你最好的选择是与你已经认识并且已经认识你的人一起工作。如果已经建立了一些信任纽带，您将有更大的成功机会，并且会减少很多意想不到的人事问题。将其扩展到二级联系人（认识您认识的人的人）是一个很好的下一步。

只有当你真的没有其他选择时，你才应该开始招募你之前没有联系的人，除非a）你很有名，或者b）你想开始付钱给他们并通过更严格的审查（招聘）过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T18:24:53.180

在这里发帖可能也有帮助:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T18:51:49.973

我不会为任何人免费工作，除非他们已经是亲密的朋友。搞砸的方法太多了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T19:10:26.210

编写一个商业应用程序要求其他人在没有报酬的情况下做出贡献——即使你以后会给他们利润——对我来说这看起来很困难。

我认为你最好发布你的软件的第一个版本，也许有一些限制，例如在[XDA-developers](http://forum.xda-developers.com/forumdisplay.php?f=260)上。如果它变得流行，您将拥有许多免费的 beta 测试人员，并且可能会有很多“剥皮者”，他们可能会免费为图形用户界面做出贡献。在这个阶段，您可能会认识 XDA 的其他开发人员，他们可以提供一些帮助。一开始你可以要求捐款，如果你得到了一些，你就知道你有一个人们愿意为之付费的软件。然后稍后您可以发布一个“专业版”，其中包含您可以收费的更多功能。

只是我的 2 美分

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T18:42:31.303

> 我不精通开源，我不确定我是否想在源代码上“打开和服”，直到有一些审查过程（当然是双向的）。

最好的开源项目往往是那些以没有其他人会加入你的项目的心态开发的项目。从一些简单的东西开始，你可以自己编写代码，然后在你有一个像样的原型后开始宣传（并将[每个用户都视为潜在的志愿者](http://producingoss.com/en/managing-volunteers.html#users-to-volunteers)）。你也可以考虑招募已经在你的网络中的任何人（朋友、同事等），因为理论上他们更倾向于加入这样的项目。

你很难让某人致力于一个有前途但早期代码库的项目。招募没有代码库和没有钱的人会更加困难。

我主要谈论的是开源世界，但我想这也适用于小型共享软件应用程序。话虽如此，如果您想了解有关开源过程的更多信息，我建议您阅读[生产开源软件。](http://producingoss.com/en/index.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T19:56:36.693

要扩展 ceejayoz 的答案：

即使你是朋友，这也是一种被搞砸的方式。事情得到说，承诺，并与朋友喝啤酒讨论。后来，当有一些东西（代码库、现金、客户、选项）丢失时，人们突然对谁会得到什么有了不同的回忆。

即使是你最好的伙伴，也要写下你的协议细节。协议越复杂，你们每个人就越有必要让律师查看。

潜在的问题与陌生人成倍增加。我的一位老板也是总法律顾问，她曾经说过“如果你不信任这个人，就不可能写一份确保他们合规的合同”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T18:48:10.077

听起来你是一名开发人员，这就是你想要继续做的事情。如果是这样的话，我会推荐一个合资企业。

也就是说，与具有营销技能的人合作，将您的产品推向广泛的人群。

至于寻找这类人的地方，我会从 jvnotifypro.com 开始，然后从那里开始寻找其他类似的网站。我相信在那个网站上，他们有一些帖子提到了其他一些网站。

根据您的营销预算，您还可以采用付费安装程序、为潜在客户付费等方式。有很多方法可以营销程序并获得您真正必须跳出框框思考的最佳覆盖范围。

哦，您也可以向支持 PAD 的网站提交软件——我认为有一个名为 AutoSubmitPro 的应用程序可以为您完成这项工作。这是让您的软件稍微普及一下以便人们了解它的好方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-18T18:50:36.280

我同意杰森。我过去的做法是通过我现有的网络来增强我的技能。希望它从那里起飞！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T19:34:07.877

根据我的经验，最好的做法是为您想加入该项目的其他人提出推销建议，您必须像将其出售给客户一样向他们推销想法，人们必须相信如果他们要免费工作的话。

此外，如果您希望专业人士免费工作，您将不得不让他们在公司中持有股份……股份的大小取决于项目的可行性和您的谈判技巧。

# iphone - 如何将文件导入sqlite？

> ID：455606
> 
> 赞同：4
> 
> 时间：2009-01-18T18:08:09.267
> 
> 标签：iphone, macos, sqlite, import, terminal

在 Mac 上，我有一个包含两列的 txt 文件，其中一列是 sqlite 表中的自动增量：

```
, "mytext1"
, "mytext2"
, "mytext3" 
```

当我尝试导入此文件时，出现数据类型不匹配错误：

```
.separator ","
.import mytextfile.txt mytable 
```

应该如何构造 txt 文件以使其使用自动增量？

另外，如何输入有换行符的文本？例如：

```
"this is a description of the code below.
The text might have some line breaks and indents.  Here's
the related code sample:

foreach (int i = 0; i < 5; i++){

  //do some stuff here

}

this is a little more follow up text." 
```

我需要将上述内容插入一行。我需要对格式化做些什么特别的事情吗？

对于一个特定的表，我希望我的每一行都作为一个文件并以这种方式导入它们。我猜这是创建某种运行多个导入的批处理文件的问题。

**编辑**

这正是我发布的语法，因为我使用的是逗号，所以减去了一个制表符。我的帖子中缺少的换行符并没有让它变得很明显。无论如何，这会导致不匹配错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T22:11:55.433

我正在寻找同样的问题。看起来我已经在您问题的第一部分找到了[答案](http://www.nabble.com/Re%3A-import-operation---primary-key-need-to-be-automatically-generated-by-SQLite-(not-from-csv-file)-p9352607.html)——关于将文件导入带有 ID 字段的表中。

所以是的，创建一个没有 ID 的临时表，将文件导入其中，然后执行 insert..select 将其数据复制到目标表中。（从 mytextfile.txt 中删除前导逗号）。

```
-- assuming your table is called Strings and
-- was created like this:
-- create table Strings( ID integer primary key, Code text )

create table StringsImport( Code text );
.import mytextfile.txt StringsImport
insert into Strings ( Code ) select * from StringsImport;
drop table StringsImport; 
```

不知道如何处理换行符。我读过一些提到在 CSV 模式下导入可以解决问题（.mode csv），但是当我尝试时它似乎不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-06T19:10:22.257

我正在将包含带有各种标点符号的长文本字段（它们实际上是关于编码的文章）的数据移动到 SQLite 中，并且我一直在尝试各种文本导入。

我在 SQLite 中创建了一个带有表的数据库：

```
CREATE TABLE test (id PRIMARY KEY AUTOINCREMENT, textfield TEXT); 
```

然后使用 .dump 进行备份。

然后，我在生成的 .dump 文件中手动添加“CREATE TABLE”行下方的文本，如下所示：

```
INSERT INTO test textfield VALUES (1,'Is''t it great to have
                     really long text with various punctaution marks and
          newlines'); 
```

将任何单引号更改为两个单引号（将 ' 更改为 ''）。请注意，需要手动添加索引号（我确信有一个 AWK/SED 命令可以自动添加）。将转储文件中“序列”行中的自动增量编号更改为您添加的最后一个索引编号上方的一个（我面前没有 SQLite 可以为您提供确切的行，但应该很明显）。
使用新文件，我可以对数据库进行还原

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T10:31:57.013

如果有人对此仍有疑问，您可以下载 SQLLite 管理器。

有几个允许从 CSV 文件导入。

这是一个，但谷歌搜索应该会显示一些：[http ://sqlitemanager.en.softonic.com/](http://sqlitemanager.en.softonic.com/)

# python - 将浮点数限制为两位小数

> ID：455612
> 
> 赞同：2082
> 
> 时间：2009-01-18T18:16:41.153
> 
> 标签：python, floating-point, rounding, precision

我想`a`四舍五入到*13.95*。

```
>>> a
13.949999999999999
>>> round(a, 2)
13.949999999999999 
```

该[`round`](https://docs.python.org/2/library/functions.html#round)功能无法按我预期的方式工作。

* * *

## 回答 #1

> 赞同：2056
> 
> 时间：2009-01-18T18:23:53.870

您遇到了浮点数的[老问题，即并非所有数字都可以精确表示。](https://en.wikipedia.org/wiki/IEEE_754)命令行只是向您显示内存中的完整浮点形式。

使用浮点表示，您的四舍五入版本是相同的数字。由于计算机是二进制的，它们将浮点数存储为整数，然后将其除以 2 的幂，因此 13.95 将以类似于 125650429603636838/(2**53) 的方式表示。

双精度数的精度为 53 位（16 位），而普通浮点数的精度为 24 位（8 位）。Python 中的[浮点类型使用双精度](http://docs.python.org/tutorial/floatingpoint.html)来存储值。

例如，

```
>>> 125650429603636838/(2**53)
13.949999999999999

>>> 234042163/(2**24)
13.949999988079071

>>> a = 13.946
>>> print(a)
13.946
>>> print("%.2f" % a)
13.95
>>> round(a,2)
13.949999999999999
>>> print("%.2f" % round(a, 2))
13.95
>>> print("{:.2f}".format(a))
13.95
>>> print("{:.2f}".format(round(a, 2)))
13.95
>>> print("{:.15f}".format(round(a, 2)))
13.949999999999999 
```

如果您只在小数点后两位（例如，显示货币价值），那么您有几个更好的选择：

1.  使用整数并以美分而不是美元存储值，然后除以 100 以转换为美元。
2.  [或者使用像decimal](https://docs.python.org/library/decimal.html)这样的定点数。

* * *

## 回答 #2

> 赞同：722
> 
> 时间：2011-06-30T18:53:13.480

有新的格式规范，[**String Format Specification Mini-Language**](http://docs.python.org/library/string.html#format-specification-mini-language)：

您可以执行以下操作：

```
"{:.2f}".format(13.949999999999999) 
```

**注1：**上面返回一个字符串。为了获得浮动，只需包装`float(...)`：

```
float("{:.2f}".format(13.949999999999999)) 
```

**注意2：**包装`float()`不会改变任何东西：

```
>>> x = 13.949999999999999999
>>> x
13.95
>>> g = float("{:.2f}".format(x))
>>> g
13.95
>>> x == g
True
>>> h = round(x, 2)
>>> h
13.95
>>> x == h
True 
```

* * *

## 回答 #3

> 赞同：366
> 
> 时间：2016-12-31T10:51:43.137

内置`round()`在 Python 2.7 或更高版本中运行良好。

例子：

```
>>> round(14.22222223, 2)
14.22 
```

查看[文档](https://docs.python.org/3/library/functions.html#round)。

* * *

## 回答 #4

> 赞同：190
> 
> 时间：2017-12-12T14:45:44.850

Nobody here seems to have mentioned it yet, so let me give an example in Python 3.6's f-string/template-string format, which I think is beautifully neat:

```
>>> f'{a:.2f}' 
```

It works well with longer examples too, with operators and not needing parens:

```
>>> print(f'Completed in {time.time() - start:.2f}s') 
```

* * *

## 回答 #5

> 赞同：169
> 
> 时间：2015-01-25T22:26:58.153

我觉得最简单的方法是使用`format()`函数。

例如：

```
a = 13.949999999999999
format(a, '.2f')

13.95 
```

这会产生一个浮点数作为四舍五入到小数点后两位的字符串。

* * *

## 回答 #6

> 赞同：99
> 
> 时间：2009-01-18T18:40:03.273

大多数数字不能用浮点数精确表示。如果你想对数字进行四舍五入，因为这是你的数学公式或算法需要的，那么你想使用round。如果您只想将显示限制在某个精度，那么甚至不要使用 round 并将其格式化为该字符串。（如果你想用一些替代的舍入方法来显示它，并且有很多，那么你需要混合这两种方法。）

```
>>> "%.2f" % 3.14159
'3.14'
>>> "%.2f" % 13.9499999
'13.95' 
```

最后，虽然也许最重要的是，如果你想要*精确的*数学，那么你根本不需要浮点数。通常的例子是处理金钱并将“美分”存储为整数。

* * *

## 回答 #7

> 赞同：99
> 
> 时间：2017-08-04T08:40:49.913

利用

```
print"{:.2f}".format(a) 
```

代替

```
print"{0:.2f}".format(a) 
```

因为后者在尝试输出多个变量时可能会导致输出错误（见注释）。

* * *

## 回答 #8

> 赞同：70
> 
> 时间：2013-08-26T06:46:25.387

试试下面的代码：

```
>>> a = 0.99334
>>> a = int((a * 100) + 0.5) / 100.0 # Adding 0.5 rounds it up
>>> print a
0.99 
```

* * *

## 回答 #9

> 赞同：67
> 
> 时间：2016-01-31T18:33:53.200

## TLDR ;)

**Python 3.1 彻底解决**了输入和输出的舍入问题，并且该修复也向后移植到 Python 2.7.0。

**四舍五入的数字可以在浮点数和字符串之间**来回转换：
`str -> float() -> repr() -> float() ...`或`Decimal -> float -> str -> Decimal`

```
>>> 0.3
0.3
>>> float(repr(0.3)) == 0.3
True 
```

`Decimal`存储不再需要类型。

**算术运算的结果必须再次四舍五入，**因为四舍五入的误差可能会比解析一个数字后累积的误差更大。改进的`repr()`算法（Python >= 3.1，>= 2.7.0）没有解决这个问题：

```
>>> 0.1 + 0.2
0.30000000000000004
>>> 0.1, 0.2, 0.3
(0.1, 0.2, 0.3) 
```

* * *

在 Python < 2.7x 和 < 3.1 中，输出字符串函数`str(float(...))`被舍入为 12 个有效数字，以防止类似于未固定 repr() 输出的过多无效数字。减去非常相似的数字后仍然不够，并且在其他操作后四舍五入太多。Python 2.7 和 3.1 使用相同长度的 str() 尽管 repr() 是固定的。一些旧版本的 Numpy 也有过多的无效数字，即使使用固定的 Python。当前的 Numpy 是固定的。Python 版本 >= 3.2 具有 str() 和 repr() 函数的相同结果，并且在 Numpy 中也有类似函数的输出。

* * *

## 测试

```
import random
from decimal import Decimal
for _ in range(1000000):
    x = random.random()
    assert x == float(repr(x)) == float(Decimal(repr(x)))  # Reversible repr()
    assert str(x) == repr(x)
    assert len(repr(round(x, 12))) <= 14         # no excessive decimal places. 
```

* * *

## 文档

请参阅[发行说明 Python 2.7 - Other Language Changes](https://docs.python.org/2.7/whatsnew/2.7.html#other-language-changes)第四段：

> **浮点数和字符串之间的**转换**现在在大多数平台上都可以**正确舍入。**这些转换发生在许多不同的地方：浮点数和复数上的 str()；float 和 complex 构造函数；数字格式；`marshal`使用,`pickle`和`json`模块对浮点数和复数进行序列化和反序列化；解析 Python 代码中的浮点数和虚数文字；和小数到浮点数的转换。**
> 
>  **与此相关，浮点数 x的**repr()现在返回基于****最短十进制字符串的结果，该字符串保证**在正确舍入（使用半舍入到偶数舍入模式）下舍入为 x。以前它给出了一个基于将 x 舍入为 17 位十进制数字的字符串。**

 **[相关问题](https://bugs.python.org/issue7117)

* * *

**更多信息：**`float` Python 2.7 之前的格式与当前的`numpy.float64`. 两种类型都使用相同的 64 位[IEEE 754](https://en.wikipedia.org/wiki/Double-precision_floating-point_format)双精度和 52 位尾数。一个很大的区别是它`np.float64.__repr__`经常使用过多的十进制数进行格式化，因此不会丢失任何位，但在 13.949999999999999 和 13.950000000000001 之间不存在有效的 IEEE 754 数字。结果不是很好，并且转换`repr(float(number_as_string))`是不可逆的 numpy。另一方面：`float.__repr__`已格式化，因此每个数字都很重要；序列没有间隙，转换是可逆的。简单地说：如果您可能有一个 numpy.float64 数字，请将其转换为普通浮点数，以便为人类格式化，而不是为数字处理器格式化，否则 Python 2.7+ 不需要更多。

* * *

## 回答 #10

> 赞同：59
> 
> 时间：2020-11-04T13:08:39.133

```
float_number = 12.234325335563
round(float_number, 2) 
```

这将返回；

```
12.23 
```

**解释：**

round 函数有两个参数；要四舍五入的数字和要返回的小数位数。这里我返回了 2 个小数位。

* * *

## 回答 #11

> 赞同：56
> 
> 时间：2009-01-18T18:31:50.123

您可以修改输出格式：

```
>>> a = 13.95
>>> a
13.949999999999999
>>> print "%.2f" % a
13.95 
```

* * *

## 回答 #12

> 赞同：55
> 
> 时间：2013-12-11T06:37:46.813

对于 Python < 3（例如 2.6 或 2.7），有两种方法可以做到这一点。

```
# Option one 
older_method_string = "%.9f" % numvar

# Option two (note ':' before the '.9f')
newer_method_string = "{:.9f}".format(numvar) 
```

但请注意，对于 3 以上的 Python 版本（例如 3.2 或 3.3），选项二是[首选](http://docs.python.org/2/library/stdtypes.html#str.format)。

有关选项二的更多信息，我建议[使用 Python 文档中关于字符串格式的](http://docs.python.org/2/library/string.html#formatstrings)链接。

有关选项一的更多信息，[此链接就足够了，并且包含有关各种标志的信息](http://docs.python.org/2/library/stdtypes.html#string-formatting)。

参考：*[将浮点数转换为一定精度，然后复制为字符串](https://stackoverflow.com/questions/15263597/convert-floating-point-number-to-certain-precision-then-copy-to-string)*

* * *

## 回答 #13

> 赞同：41
> 
> 时间：2019-02-06T06:37:51.470

您可以使用**格式**运算符在 python 中将值四舍五入到小数点后 2 位：

```
print(format(14.4499923, '.2f')) // output is 14.45 
```

* * *

## 回答 #14

> 赞同：31
> 
> 时间：2018-03-16T10:49:21.650

在 Python 2.7 中：

```
a = 13.949999999999999
output = float("%0.2f"%a)
print output 
```

* * *

## 回答 #15

> 赞同：26
> 
> 时间：2018-02-01T09:43:03.657

正如@Matt 指出的那样，***Python 3.6 提供了 f-strings***，它们也可以使用**[嵌套参数](https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals)**：

```
value = 2.34558
precision = 2
width = 4

print(f'result: {value:{width}.{precision}f}') 
```

这将显示`result: 2.35`

* * *

## 回答 #16

> 赞同：25
> 
> 时间：2020-09-30T04:31:37.360

我们有多种选择：选项1：

```
x = 1.090675765757
g = float("{:.2f}".format(x))
print(g) 
```

选项 2：内置的 round() 支持 Python 2.7 或更高版本。

```
x = 1.090675765757
g =  round(x, 2)
print(g) 
```

* * *

## 回答 #17

> 赞同：24
> 
> 时间：2009-01-19T02:05:53.797

The Python tutorial has an appendix called *[Floating Point Arithmetic: Issues and Limitations](http://docs.python.org/tutorial/floatingpoint.html)*. Read it. It explains what is happening and why Python is doing its best. It has even an example that matches yours. Let me quote a bit:

> ```
> >>> 0.1
> 0.10000000000000001 
> ```
> 
> you may be tempted to use the `round()` function to chop it back to the single digit you expect. But that makes no difference:
> 
> ```
> >>> round(0.1, 1)
> 0.10000000000000001 
> ```
> 
> The problem is that the binary floating-point value stored for `“0.1”</code> was already the best possible binary approximation to `1/10`, so trying to round it again can’t make it better: it was already as good as it gets.`
> 
> Another consequence is that since `0.1` is not exactly `1/10`, summing ten values of `0.1` may not yield exactly `1.0`, either:
> 
> ```
> >>> sum = 0.0
> >>> for i in range(10):
> ...     sum += 0.1
> ...
> >>> sum
> 0.99999999999999989 
> ```

One alternative and solution to your problems would be using the [`decimal`](http://docs.python.org/library/decimal.html) module.

* * *

## 回答 #18

> 赞同：15
> 
> 时间：2019-06-01T02:04:26.543

使用 Decimal 对象和 round() 方法的组合。

```
Python 3.7.3
>>> from decimal import Decimal
>>> d1 = Decimal (13.949999999999999) # define a Decimal
>>> d1 
Decimal('13.949999999999999289457264239899814128875732421875')
>>> d2 = round(d1, 2) # round to 2 decimals
>>> d2
Decimal('13.95') 
```

* * *

## 回答 #19

> 赞同：13
> 
> 时间：2009-01-18T18:33:45.160

它正在做你告诉它做的事情并且工作正常。阅读有关[浮点混淆](http://www.lahey.com/float.htm)的更多信息，也许可以尝试使用[十进制](http://docs.python.org/library/decimal.html)对象。

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2018-12-21T07:55:13.967

```
from decimal import Decimal

def round_float(v, ndigits=2, rt_str=False):
    d = Decimal(v)
    v_str = ("{0:.%sf}" % ndigits).format(round(d, ndigits))
    if rt_str:
        return v_str
    return Decimal(v_str) 
```

结果：

```
Python 3.6.1 (default, Dec 11 2018, 17:41:10)
>>> round_float(3.1415926)
Decimal('3.14')
>>> round_float(3.1445926)
Decimal('3.14')
>>> round_float(3.1455926)
Decimal('3.15')
>>> round_float(3.1455926, rt_str=True)
'3.15'
>>> str(round_float(3.1455926))
'3.15' 
```

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2014-04-02T20:08:01.827

为了修复 Python 和 JavaScript 等类型动态语言中的浮点，我使用了这种技术

```
# For example:
a = 70000
b = 0.14
c = a * b

print c # Prints 980.0000000002
# Try to fix
c = int(c * 10000)/100000
print c # Prints 980 
```

您还可以使用十进制，如下所示：

```
from decimal import *
getcontext().prec = 6
Decimal(1) / Decimal(7)
# Results in 6 precision -> Decimal('0.142857')

getcontext().prec = 28
Decimal(1) / Decimal(7)
# Results in 28 precision -> Decimal('0.1428571428571428571428571429') 
```

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2019-04-28T00:45:47.307

像这样的 lambda 函数怎么样：

```
arred = lambda x,n : x*(10**n)//1/(10**n) 
```

这样你就可以这样做：

```
arred(3.141591657,2) 
```

并得到

```
3.14 
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2019-01-29T17:43:58.700

很简单，比如 1,2,3：

1.  使用[十进制](https://docs.python.org/3/library/decimal.html)模块进行快速正确舍入的十进制浮点运算：

    d=十进制（10000000.0000009）

实现四舍五入：

```
 d.quantize(Decimal('0.01')) 
```

将导致`Decimal('10000000.00')`

2.  使上述干燥：

```
 def round_decimal(number, exponent='0.01'):
        decimal_value = Decimal(number)
        return decimal_value.quantize(Decimal(exponent)) 
```

或者

```
 def round_decimal(number, decimal_places=2):
        decimal_value = Decimal(number)
        return decimal_value.quantize(Decimal(10) ** -decimal_places) 
```

3.  赞成这个答案:)

PS：批评他人：格式化不是四舍五入。

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2017-09-04T12:38:06.983

```
orig_float = 232569 / 16000.0 
```

> 14.5355625

```
short_float = float("{:.2f}".format(orig_float)) 
```

> 14.54

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2021-07-29T05:49:36.590

**这是使用格式功能的简单解决方案。**

```
float(format(num, '.2f')) 
```

> 注意：我们将数字转换为浮点数，因为格式方法返回字符串。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2015-08-26T09:17:52.593

要将数字四舍五入为分辨率，最好的方法是以下一种，它可以用于任何分辨率（0.01 表示两位小数甚至其他步长）：

```
>>> import numpy as np
>>> value = 13.949999999999999
>>> resolution = 0.01
>>> newValue = int(np.round(value/resolution))*resolution
>>> print newValue
13.95

>>> resolution = 0.5
>>> newValue = int(np.round(value/resolution))*resolution
>>> print newValue
14.0 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2020-07-22T13:50:47.437

我看到的答案不适用于 float(52.15) 案例。经过一些测试，有我正在使用的解决方案：

```
import decimal

def value_to_decimal(value, decimal_places):
    decimal.getcontext().rounding = decimal.ROUND_HALF_UP  # define rounding method
    return decimal.Decimal(str(float(value))).quantize(decimal.Decimal('1e-{}'.format(decimal_places))) 
```

（'value' 到 float 和 string 的转换非常重要，这样，'value' 的类型可以是 float、decimal、integer 或 string！）

希望这对任何人都有帮助。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2019-12-17T02:43:53.993

lambda x,n:int(x*10^n+.5)/10^n 多年来为我工作了*很多*语言。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2020-11-20T22:00:48.580

如果要处理金钱，请使用python[十进制](https://docs.python.org/3.6/library/decimal.html)模块

```
from decimal import Decimal, ROUND_HALF_UP

# amount can be integer, string, tuple, float, or another Decimal object
def to_money(amount) -> Decimal:
    money = Decimal(amount).quantize(Decimal('.00'), rounding=ROUND_HALF_UP)
    return money 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2022-02-05T14:23:28.027

简单的解决方案在这里

```
value = 5.34343
rounded_value = round(value, 2) # 5.34 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2021-09-09T08:01:25.697

只需使用此函数并将字节作为输入传递给它：

```
def getSize(bytes):
    kb = round(bytes/1024, 4)
    mb = round(kb/1024, 4)
    gb = round(mb/1024, 4)
    if(gb > 1):
        return str(gb)+" GB"
    elif(mb > 1):
        return str(mb)+" MB"
    else:
        return str(kb)+" KB" 
```

这是我可以将数据大小从字节**动态转换为 KB、MB 或 GB 的最简单方法**

* * *

## 回答 #32

> 赞同：-16
> 
> 时间：2015-12-31T08:05:56.970

我使用的方法是字符串切片。它相对快速和简单。

首先，将浮点数转换为字符串，选择您想要的长度。

```
float = str(float)[:5] 
```

在上面的单行中，我们将值转换为字符串，然后只保留字符串的前四个数字或字符（包括在内）。

希望有帮助！

# system - 鉴于这种期望，您会选择哪种语言或系统来实施该解决方案？

> ID：455618
> 
> 赞同：0
> 
> 时间：2009-01-18T18:18:25.830
> 
> 标签：system, estimation

以下是系统应处理的估计值：

*   3000+ 终端用户
*   全球 150 多个办事处
*   高峰时段 1500+ 并发用户
*   10.000+ 每日更新
*   每秒 4-5 次提交
*   每秒 50-70 个事务（读取/搜索/更新）

这将是内部唯一的业务应用程序，致力于帮助航运公司进行全球货运管理。

您的技术选择是什么，为什么要选择，以及实施它大概需要多长时间？谢谢。

注意：我不是在招聘。:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T07:30:16.013

所以，你问我将如何处理这样的项目。在 Smalltalk 世界中，人们似乎同意 Gemstone 让事物在某种程度上神奇地扩展。

所以，我真正要做的是：我将开始使用[SandstoneDB](http://onsmalltalk.com/sandstonedb-simple-activerecord-style-persistence-in-squeak)在一个简单的 Squeak 图像中进行开发。然后，这一刻将到来，单个图像开始变得太慢。

[GemStone](http://www.gemstone.com/products/smalltalk/)然后负责在所有实例之间来回复制您的公共对象（从某个根目录可见的对象）。您可以获得会话和增强的查询功能，以及相当快的 VM。

它与 C、Java 和 Ruby 共享数据。

事实上，他们有自己[的 ruby​​ 虚拟机](http://ruby.gemstone.com/)，这也值得一看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T18:35:57.433

wikipedia 使用 MySQL 管理更苛刻的要求

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T21:19:42.110

您的数量很大，但*如果*编程有效，则不会对任何可靠的 RDBMS 造成压力。如果您的团队马虎（即随意将 SQL 查询直接放入组件中，然后再组合成更大的组件），您可能会面临“乘数”效应，其中一个逻辑需求（获取此页面所需的数据）变成一个大量的物理数据库查询。

因此，与其关注 RDBMS 的能力，不如关注程序员的能力以及实现语言和环境促进分析和重构的程度。

您提出的方案显然也是 24x7x365 的方案，因此您还应该考虑监控/仪表板要求的需要。

无法根据您提出的需求估算开发工作量；很高兴您已将事务分析到这种粒度级别，但开发工作的主要决定因素将是域和 UI 需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T08:22:05.253

选择您的开发人员了解和熟悉的技术。那里的所有主要技术都将轻松处理这些要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T18:29:25.853

您的每日更新数量与提交不相加。每秒四次提交 = 每小时 14,400 次。

您没有提及有关预期数据库大小的任何内容。

在任何情况下，我都会集中精力选择健壮的后端，如 Oracle、Sybase、MS 等。这种选择将对性能产生最大的影响。根据需要，前端可以是桌面应用程序或 WEB 应用程序。由于这将在世界各地的许多办公室中使用，因此 WEB 应用程序可能最有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T19:18:37.097

我会选择 MySQL 或 PostgreSQL。对于您的要求，任何一个都不太可能出现问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T23:15:48.867

我喜欢对象数据库。就每秒提交和数据库往返而言，没有任何关系数据库可以支撑。查看[db4o](http://www.db4o.com)。这很容易学习，请查看示例！

至于编程语言和 UI 框架：好吧，拿你的团队擅长的。元时间浪费较少的动态语言可能会节省时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-18T23:34:57.517

此处提供的信息不足，无法给出适当的建议。需要进行更多的尽职调查。

*   IT文化是什么样的？他们更喜欢大量的小型服务器还是更少的大型服务器或大铁？他们在虚拟化方面的立场是什么？
*   企业文化是什么样的？政治气候如何？开源产品可以很好地处理负载，但您可能需要与专有供应商合作，因为它们已经习惯于驾驭大公司的政治风向。感知很重要。
*   组织的成熟度是多少？他们是否已经建立了[企业架构](http://ploneglenn.blogspot.com/2009/01/enterprise-architecture-talk-on-second.html)团队？他们甚至知道什么是 EA 吗？
*   您已经描述了操作方面，但分析方面呢？他们期望使用或已经采用的 OLAP 技术是什么？
*   说到集成，您还需要集成哪些其他系统？

# asp.net-mvc - 是否可以在不同的 AppDomain 中运行 ASP.NET MVC 路由？

> ID：455620
> 
> 赞同：3
> 
> 时间：2009-01-18T18:19:36.967
> 
> 标签：asp.net-mvc, url-routing, appdomain, global-asax

我在想出以下解决方案时遇到问题。我有一个最近从 Web 表单升级到 MVC 的博客。该博客在两个不同的域上以瑞典语和英语提供，并且在 IIS 中的同一个网站上运行。

问题是我想要两个网站上的语言特定网址，如下所示：

英文：[http ://codeodyssey.com/archive/2009/1/15/code-odyssey-the-next-chapter](http://codeodyssey.com/archive/2009/1/15/code-odyssey-the-next-chapter)

瑞典语：[http ://codeodyssey.se/arkiv/2009/1/15/code-odyssey-nasta-kapitel](http://codeodyssey.se/arkiv/2009/1/15/code-odyssey-nasta-kapitel)

目前，我通过根据调用的域在每个请求上注册 RouteTable 来实现这一点。我的 Global.asax 看起来像这样（不是整个代码）：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    string archiveRoute = "archive";

    if (Thread.CurrentThread.CurrentUICulture.ToString() == "sv-SE")
    {
        archiveRoute = "arkiv";
    }

    routes.MapRoute(
        "BlogPost",
        archiveRoute+"/{year}/{month}/{day}/{slug}",
        new { controller = "Blog", action = "ArchiveBySlug" }
        );

    routes.MapRoute(
        "Default",                                              // Route name
        "{controller}/{action}/{id}",                           // URL with parameters
        new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
    );

    routes.MapRoute(
        "404-PageNotFound",
        "{*url}",
        new { controller = "Error", action = "ResourceNotFound" }
    );

}

void Application_BeginRequest(object sender, EventArgs e)
{

    //Check whcih domian the request is made for, and store the Culture
    string currentCulture = HttpContext.Current.Request.Url.ToString().IndexOf("codeodyssey.se") != -1 ? "sv-SE" : "en-GB";

    Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(currentCulture);
    Thread.CurrentThread.CurrentUICulture = new CultureInfo(currentCulture);

    RouteTable.Routes.Clear();

    RegisterRoutes(RouteTable.Routes);

    Bootstrapper.ConfigureStructureMap();

    ControllerBuilder.Current.SetControllerFactory(
        new CodeOdyssey.Web.Controllers.StructureMapControllerFactory()
        );
}

protected void Application_Start()
{

} 
```

这目前有效，但我知道这不是一个很好的解决方案。启动此应用程序时，我收到“已添加项目。键入字典”错误，有时似乎不稳定。

我只想在 Application_Start 中设置我的路由，而不是像现在这样在每个请求上清除它们。问题是请求对象不存在，我无法知道我应该注册哪种语言特定的路由。

一直在阅读有关 AppDomain 的信息，但在网站上找不到很多有关如何使用它的示例。我一直在考虑给这样的东西加注星标：

```
protected void Application_Start()
{
   AppDomain.CreateDomain("codeodyssey.se");
   AppDomain.CreateDomain("codeodyssey.com");
} 
```

然后在每个应用程序域中注册每个网站路由，并根据 url 将请求发送到其中一个。找不到任何关于如何以这种方式使用 AppDomain 的示例。

我完全偏离轨道了吗？或者有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T18:55:41.653

ASP.Net 运行时为您管理 AppDomain，因此在您的代码中创建 AppDomain 可能不是一个好主意。

但是，如果可以的话，我建议创建多个 IIS 应用程序（一个用于[http://codeodyssey.com](http://codeodyssey.com)，一个用于[http://codeodyssey.se](http://codeodyssey.se)）。将两个应用程序指向磁盘上的同一目录。这将为您提供您正在寻找的两个 AppDomain。

然后，在 Application_Start 代码中，您可以检查域并相应地构建路由。

# c++ - 'Head First' 风格的数据结构和算法书？

> ID：455627
> 
> 赞同：27
> 
> 时间：2009-01-18T18:22:20.737
> 
> 标签：c++, data-structures, tree, graph-theory

我喜欢关于面向对象设计的 Head First 系列书。这是对该主题的非常温和而有趣的介绍。我目前正在学习数据结构课程，发现我们使用的文本（Kruse/Ryba 数据结构和 C++ 中的程序设计）非常枯燥且难以理解。这主要是由于我认为我自己在数学领域的局限性。

有谁知道以更轻松的风格编写的数据结构文本，带有幽默感，仍然涵盖所有基础知识，如二叉树、B 树和图形？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-18T18:29:09.117

[Steve Skiena](http://www.cs.sunysb.edu/~algorith/)的《[算法设计手册》](https://rads.stackoverflow.com/amzn/click/com/1848000693)并不完全是一个笑话，但它对更深层次的数学的理解相对较浅，并且包含许多他所谓的“战争故事”，这些都是来自真实世界情况的说明性示例，算法工作真正得到了回报（或者，有时，完全失败）。他的[音频和视频讲座也在网上](http://www.cs.sunysb.edu/~algorith/video-lectures/)，而且他的演讲风格很好，还夹杂着一些幽默，所以这可能就是你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T04:29:57.250

这也不是轻的，但它是相当不错的

[Robert Lafore 的算法和数据结构](https://rads.stackoverflow.com/amzn/click/com/1571690956)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T04:46:46.310

在我看来，没有什么比[http://www.amazon.com/Bundle-Algorithms-Parts-1-5-Fundamentals/dp/020172684X更具可读性和意义的了](https://rads.stackoverflow.com/amzn/click/com/020172684X)

它是 2 本书，第 5 部分是图表，不如另一本书有用 - 当然，除非您想使用图表来解决问题。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-22T08:03:22.890

[Dromey 的《如何通过计算机解决问题》](http://en.wikipedia.org/wiki/How_to_Solve_It_By_Computer)虽然不完全是一本算法书，但它采用了*重新发现*多年来获得许多数据结构和算法的过程的方法。这使我们能够了解代码背后的思想流和一些在起作用的力量。

相关：这本书紧随另一本好书的脚步：[G. Polya 的 How to Solve It](http://en.wikipedia.org/wiki/How_to_Solve_It)讲述了伟大的数学家如何解决问题的过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T18:40:53.930

我目前正在使用 Larry Nyhoff 的 ADTs [, Data Structures, and Problem Solving with C++](https://rads.stackoverflow.com/amzn/click/com/0131409093)。

它不像 Head First 系列书那么轻松或令人愉快，但它对二叉树、b 树和图表的细节非常详细。它的代码示例对完成我的作业非常有帮助。理解本书不需要更高的数学知识（当然，除了专门介绍算法分析的章节）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T04:42:52.467

[Harris 和 Ross 的《Beginning Algorithms》](https://rads.stackoverflow.com/amzn/click/com/0764596748)（一本 Wrox Press 的书）是我喜欢的一本，尽管它的示例是用 Java 而不是 C++ 呈现的。可能是您在课堂上艰难阅读的文本的一个很好的伴奏。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-19T04:54:19.790

我听说过关于“算法简介，一种创造性的方法 - Udi Manber”的好消息，但我无法验证它，因为它在本地不可用:(

[http://www.amazon.com/Introduction-Algorithms-Creative-Udi-Manber/dp/0201120372](https://rads.stackoverflow.com/amzn/click/com/0201120372)

# flash - URLLoader 在轮询时卡住

> ID：455656
> 
> 赞同：2
> 
> 时间：2009-01-18T18:30:52.483
> 
> 标签：flash, networking, actionscript

**更新：不知何故，这在浏览器中运行 flash 时有效，但如果从 IDE 运行则不起作用。如果您有同样的问题，您可能想尝试在浏览器中运行。**

我正在制作一个聊天应用程序，它使用 Flash 和 Actionscript 3.0 从我的服务器重复读取文本文件。我正在使用 URLLoader 打开文件，一开始它工作正常。然而，大约 10 次调用后，URLLoader 卡住了。

它不给出完成事件，不给出安全错误，不给出状态事件，也不抛出异常。它根本不会触发任何事件。我什至在 URL 中添加了一个随机值，以确保它不是缓存问题。我当然可以检测到它何时卡住，但似乎没有任何方法可以解开它。即使我在 URLLoader 上调用 close() 然后将其设置为 null 并创建另一个，它也不会恢复轮询。

下面是轮询服务器并每两秒调用一次的函数。

```
private function check_server() {
 var url:String = "http://coworkthailand.com/say/snd/index.php?"+Math.random();
 if (loader != null) {
  trace("was already checking "+loader.bytesLoaded+" / "+loader.bytesTotal);
  return;
 }
 loader =  new URLLoader();
 loader.dataFormat = URLLoaderDataFormat.TEXT;
 loader.addEventListener(Event.COMPLETE, completeHandler);
 loader.addEventListener(flash.events.IOErrorEvent.IO_ERROR, 
  function(e:Event) { loader = null; trace("fail"); })
 loader.addEventListener(flash.events.SecurityErrorEvent.SECURITY_ERROR, 
  function(e:Event) { loader = null; trace("security error"); })
 loader.addEventListener(flash.events.HTTPStatusEvent.HTTP_STATUS,
  function(e:flash.events.HTTPStatusEvent) { trace("status "+e.status); });
 try {
  loader.load(new URLRequest(url));
 } catch (error:Error) {
  trace("Unable to load requested document.");
 }
} 
```

这不是一个重要的项目，但任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T05:15:54.317

对于这种情况，最佳实践要求使用 URLLoader 的单个实例；很有可能你在某个地方被竞争电话阻止了。同样，您可以尝试使用一个简单的标志来检测您的加载程序是否在进行另一个呼叫之前忙于现有呼叫；这是一个使用单个加载器每五秒发出一次请求的工作示例，显示了单个加载器和“isOpen”检查：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" initialize="app_init()">    
    <mx:Script>
        <![CDATA[

            private var timer:Timer;
            private var loader:URLLoader;
            private var isOpen:Boolean;

            private function app_init():void
            {
                timer = new Timer(5000)
                timer.addEventListener(TimerEvent.TIMER, timer_tick, false, 0, true)

                loader = new URLLoader();
                loader.addEventListener(Event.OPEN, loader_open);
                loader.addEventListener(Event.COMPLETE, loader_complete);

                // Start the timer
                timer.start();
            }

            private function timer_tick(event:TimerEvent):void
            {
                // Check if the loader's busy before calling load, and/or close()
                if (!isOpen)
                {
                    // loader.close();
                    loader.load(new URLRequest("http://mydomain.com/myfile.txt"));
                }   
            }

            private function loader_open(event:Event):void
            {
                // Mark as open
                isOpen = true;
            }

            private function loader_complete(event:Event):void
            {
                // Do work

                // Mark as closed
                isOpen = false;
            }

        ]]>
    </mx:Script>    
</mx:Application> 
```

希望能帮助到你！祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T22:32:00.810

我只是在这里猜测，但可能 Flash 引擎被各种并行`URLLoader`s 阻塞（如果由于某种原因一个卡住了两秒多一点，你已经有两个，等等）

我的想法是：使用单个`URLLoader`. 在函数中设置回调和事件挂钩，并在每次检查服务器更改时`init()`调用和重用同一个实例。`load()`这样，当`URLLoader`仍然忙时，新的加载请求将被忽略或取消前一个（不确定哪个）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T13:20:11.097

由于您的对象未连接到主对象图，GC 也可能正在清理您的对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T08:37:20.433

使用 Fiddler 或 Charles 检查您的 HTTP 流量也是值得的，它可能会帮助您更好地了解正在发生的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-28T19:33:09.540

一个浏览器通常只允许 2 个同时的 HTTP KeepAlive 连接。其他连接被推迟。

# sql - 如何对 select 生成的表进行查询？

> ID：455657
> 
> 赞同：1
> 
> 时间：2009-01-18T18:31:49.827
> 
> 标签：sql, mysql

举个例子：

```
SELECT name, address, phone FROM USER; 
```

生成表

```
name | address | phone 
...  |   ...   |  ... 
```

如何使用生成的此表对其进行另一个查询？

例如：

```
SELECT count(address) FROM (SELECT name, address, phone, from user); 
```

我知道这不是最好的例子，但有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T18:37:56.633

使用相同的语法，但给派生表一个别名

```
SELECT count(subadd.address) 
FROM (SELECT name, address, phone, from user) as subadd; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T18:38:37.600

最好的方法是创建一个视图：

```
CREATE VIEW my_view AS SELECT name, address, phone FROM USER;

```

然后您可以将其作为表格起诉：

```
从 my_view 中选择计数（地址）；

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T18:40:32.150

您可以使用临时表：

```
create temporary table t select name, address, phone;
select count(address) from t; 
```

几个特点：
- 表只能由当前线程访问，
- 当当前线程完成时，表将被删除
- 创建这样的表需要适当的权限

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T19:14:29.570

我会避免使用临时表。我可能会创建一个视图。但是，如果需要速度，我会进行解释以查看更快的速度。

# java - 切入点不适用于 Spring AOP

> ID：455659
> 
> 赞同：5
> 
> 时间：2009-01-18T18:31:52.293
> 
> 标签：java, spring, logging, aop, spring-aop

为了使用 Spring AOP 实现 Logging，我遵循了这些简单的步骤。但它似乎不起作用。任何帮助都会很有用

1) 创建**MyLoggingAspect**类

```
 import org.aspectj.lang.ProceedingJoinPoint;

public class MyLoggingAspect
{

    public MyLoggingAspect() {
        super();
        System.out.println("Instantiated MyLoggingAspect");     
    }

    public Object log(ProceedingJoinPoint call) throws Throwable
    {
        System.out.println("from logging aspect: entering method [" + call.toShortString()
                            +"] with param:"+call.getArgs()[0] );

        Object point =  call.proceed();

        System.out.println("from logging aspect: exiting method [" + call.toShortString()   
                            + "with return as:" +point);        

        return point;
    } 
```

}

2）创建了一个我想要记录的类（ **TixServiceImpl ）**

```
public class TixServiceImpl implements TixService{

    @Override
    public void calculateSomething() {
        String s = "did some calculation..";
        System.out.println(s);
    }

    @Override
    public String getTixName() {
        return null;
    }
} 
```

3）创建了一个**spring-aspectj.xml**文件

```
<beans...    
    <bean id="LoggingAspect"  class = "MyLoggingAspect"/>
    <aop:config>
          <aop:aspect ref="LoggingAspect">
             <aop:pointcut id="myCutLogging"
                    expression="execution(* TixService*.*(..))"/>
             <aop:around pointcut-ref="myCutLogging" method="log"/>
          </aop:aspect>
    </aop:config>    
</beans> 
```

4）创建了一个简单的测试客户端（**TixClient**）

```
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.FileSystemXmlApplicationContext;

public class TixClient {

    public static void main(String[] a){

        ApplicationContext context = new FileSystemXmlApplicationContext("conf/spring-aspectj.xml");

        TixService tix = new TixServiceImpl();
        tix.calculateSomething();
        String s = tix.getTixName();

        System.out.println("End of the the client invocation!!"); 
    }   
} 
```

5）它给了我以下**输出**

```
...
Instantiated MyLoggingAspect
did some calculation..
End of the the client invocation!! 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-18T20:46:14.080

我只是在检查您的代码，但我有一种预感，问题是您没有`TixServiceImpl`从 Spring 获取实例，而是您自己在`TixClient`. 我认为您`TixService`需要成为一个从 Spring ApplicationContext 获取的 Spring bean，以便 Spring 有机会在返回的实例上设置方面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T21:23:36.767

Scott Bale 是对的：让 spring 为您实例化 TixServiceImpl。同样在这种情况下，启用 Springs 日志记录可能会有所帮助，因为它会告诉您找到了多少个方面/服务的目标。

# nhibernate - 如何配置 NHibernate 以使用来自的连接字符串 配置部分

> ID：455664
> 
> 赞同：8
> 
> 时间：2009-01-18T18:33:54.490
> 
> 标签：nhibernate

有人知道如何配置 NHibernate 属性文件以使用已在配置元素中指定的连接字符串吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-18T18:39:49.687

我在 google.com 上找到了它：

```
<connectionStrings>
    <add name="connection_string_name" connectionString="[connection string]"/>
</connectionStrings>

<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
        ...
        <property name="connection.connection_string_name">connection_string_name</property>
        ...
    </session-factory>
</hibernate-configuration> 
```

# java - 如何设置 Web 组件和 Java 应用程序之间的连接

> ID：455669
> 
> 赞同：0
> 
> 时间：2009-01-18T18:36:30.490
> 
> 标签：java

我对正在编写的应用程序方法感到困惑。我已经开发了应用程序 jar 并将通过 java webstart 分发。

现在我需要建立一个支持我的应用程序的网站。

我有疑问

1）我可以将此用户名和密码传递给我将要启动的 jar 吗？

2) webcomponent 是否可以计算应用程序启动的时间。

基本上，我需要了解 webcomponents 和我的 java 应用程序如何在传递给应用程序所需的任何数据以及从应用程序重新获取并放到网络上的任何信息方面相互交互。

谢谢克里斯普

我想将用户名之类的参数传递给 JNLP，然后将其传递给主类。

有没有直接的方法而不是使用数据库？

因为 JNLP 只是一个 xml 文件。我找不到这样做的直接方法。

我可以向我推荐一些工作代码示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T04:22:19.607

数据库可能是您在两个应用程序之间共享数据的最佳选择。其他选项是 Web 服务、套接字、RMI 等。最初，您可能需要从表面上研究所有内容，以了解最适合您的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T03:49:33.820

至于我的 java 应用程序中的时间计算，我可以使用 currentTimeMillis() 来计算我的应用程序运行的时间。

但是像应用程序崩溃或强制终止应用程序这样的情况将无法保存。

关于网络和应用程序 jar 之间的数据通信的任何提示？

谢谢

克里斯普

# asp.net-mvc - ASP.NET MVC - 表单和模型绑定器中的多个模型

> ID：455672
> 
> 赞同：6
> 
> 时间：2009-01-18T18:37:44.527
> 
> 标签：asp.net-mvc, model-binders

我有一个需要填充 2 个模型的表单。通常我在表单发布操作上使用 ModelBinderAttribute 即

```
 [Authorize]
    [AcceptVerbs("POST")]
    public ActionResult Add([GigBinderAttribute]Gig gig, FormCollection formCollection)
    {
       ///Do stuff
    } 
```

在我的表单中，这些字段的名称与模型属性相同...

但是在这种情况下，我有 2 个不同的模型需要填充。

我该怎么做呢？有任何想法吗？是否可以？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T22:22:25.683

实际上......最好的方法是这样做：

```
public ActionResult Add([GigBinderAttribute]Gig gig, [FileModelBinderAttribute]File file) { 
```

}

您可以使用多个属性！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-19T15:26:03.057

在这种情况下，我倾向于制作一个模型类型来包装所涉及的各种模型：

```
class AddModel
{
     public Gig GigModel {get; set;}
     public OtherType OtherModel {get; set;}
} 
```

...并绑定*它。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T22:24:49.937

UpdateModel 或 TryUpdateModel 方法可用于执行此操作。您可以通过模型、您希望绑定的模型、您希望绑定到该模型的项目的前缀和表单。例如，如果您的 Item 模型具有“Item.Value”的表单变量，那么您的更新模型方法将是：

```
UpdateMode(modelObject, stringPrefix, formCollection); 
```

如果您使用的是实体框架，值得指出的是 UpdateModel 方法在某些情况下并不总是有效。不过，它确实适用于 POCO。

# c++ - 简而言之，什么是 COM（组件对象模型）？

> ID：455687
> 
> 赞同：96
> 
> 时间：2009-01-18T18:45:46.150
> 
> 标签：c++, com

似乎 COM 对象是由操作系统管理的通用对象。对象遵循严格的接口，允许您查询对象以确定信息。这就是 COM 对象吗？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-01-20T08:51:46.003

[COM](http://en.wikipedia.org/wiki/Component_Object_Model)是一种允许重用对象（或者更确切地说是组件）的机制，与实现组件的程序员和使用它的程序员使用的语言无关，并且与组件是在客户端程序中实现还是在客户端程序中实现无关。机器（或网络）上的其他位置。

从广义上讲，每个 COM 组件都提供一个或多个接口的实现。这些接口是使用[接口定义语言 (IDL)](http://en.wikipedia.org/wiki/Component_Object_Model#Interface_Definition_Language_and_type_libraries)以与语言无关的方式定义的。例如，COM 中的一个基本接口[IUnknown](http://en.wikipedia.org/wiki/IUnknown)是这样定义的：

```
interface IUnknown
{
   virtual HRESULT QueryInterface(REFIID riid, void **ppvObject) = 0;
   virtual ULONG AddRef(void) = 0;
   virtual ULONG Release(void) = 0;
}; 
```

这个小接口是 COM 的基础，因为每个 COM 组件都**必须**实现它。它定义了 COM 机制的两个重要方面：

*   `QueryInterface`允许调用代码获取已知接口的实现。在 COM 中，接口由 GUID（也称为接口标识符，IID）引用。如果一个对象实现了多个接口，这就是客户端代码获取对每个接口的引用的方式。如果您愿意，它可以充当一种类型的转换运算符。
*   `AddRef()`并`Release()`实现COM对象的内存管理机制。顾名思义，最常见的模型是引用计数机制，其中一个实例在最后一个客户端释放对它的引用后被销毁。

所有 COM 组件在安装时都会在系统中注册。如果程序员想要使用某个组件，他需要：

*   确保组件安装在可到达的位置。大多数时候它在运行应用程序的系统上，但 COM+ 也允许组件存在于远程计算机上。
*   知道给定组件的 GUID。使用此 GUID，客户端可以请求系统实例化组件（在 C 中，调用执行此操作的函数`CoCreateInstance()`）。您可以在注册表中查看`HKEY_CLASSES_ROOT\CLSID`：其中的每个 GUID（很可能）都有一个 COM 组件或接口的标识符，该键下方的条目告诉系统应该如何实例化它。

COM 机制极其复杂。例如，在 C 中实现或使用 COM 组件需要大量的工作，但是像 Visual Basic 这样的高级语言在简化 COM 组件的实现和使用方面做了很多工作。然而，好处是非常真实的。它使得使用例如 Visual Basic 编写应用程序成为可能，但仍然可以将 C 或 C++ 中的性能关键算法实现为 COM 对象，这些对象可以直接从 VB 代码中使用。系统负责**编组**方法调用参数，根据需要通过线程、进程和网络连接传递它们，以便客户端代码具有使用普通对象的印象。

Windows 的许多基本部分都基于 COM。例如，Windows 资源管理器（文件管理器）基本上是一个空壳。它定义了一组用于导航和显示树层次结构的 COM 接口，所有实际显示“我的电脑”、驱动器、文件夹和文件的代码都是作为一组实现这些接口的 COM 组件。

随着 .NET 的出现，COM 逐渐过时。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-18T19:23:36.120

COM 是一种机制，它允许人们分发可以重用的二进制文件，即使调用者使用的是其他供应商的 C++ 编译器或（最终）完全不同的语言。

如果您想很好地介绍 COM，请阅读[Don Box](http://en.wikipedia.org/wiki/Don_Box)的[Essential COM](http://books.google.co.uk/books?id=kfRWvKSePmAC&dq=essential+com&printsec=frontcover&source=bn&hl=en&sa=X&oi=book_result&resnum=6&ct=result)。

# java - 在 Java 中一次读取两行文本文件的最佳方法是什么？

> ID：455695
> 
> 赞同：3
> 
> 时间：2009-01-18T18:51:12.237
> 
> 标签：java, text-files, fileparsing

```
BufferedReader in;

String line;
while ((line = in.readLine() != null) {
    processor.doStuffWith(line);
} 
```

这就是我逐行处理文件的方式。然而，在这种情况下，我想在每次迭代中向处理器发送**两**行文本。（我正在处理的文本文件基本上将一条记录存储在两行中，因此我每次都向处理器发送一条记录。）

在 Java 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-18T18:56:59.217

为什么不只读两行？

```
BufferedReader in;
String line;
while ((line = in.readLine() != null) {
    processor.doStuffWith(line, in.readLine());
} 
```

这假设您可以依赖输入文件中包含完整的 2 行数据集。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-18T19:04:43.663

```
BufferedReader in;
String line1, line2;

while((line1 = in.readLine()) != null 
   && (line2 = in.readLine()) != null))
{
    processor.doStuffWith(line1, line2);
} 
```

或者，如果您愿意，可以将它们连接起来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T22:11:17.840

我会重构代码看起来像这样：

```
RecordReader recordReader;
Processor processor;

public void processRecords() {
    Record record;

    while ((record = recordReader.readRecord()) != null) {
        processor.processRecord(record);
    }
} 
```

当然，在这种情况下，您必须以某种方式将正确的记录阅读器注入到此类中，但这应该不是问题。

RecordReader 的一种实现可能如下所示：

```
class BufferedRecordReader implements RecordReader
{
    BufferedReader in = null;

    BufferedRecordReader(BufferedReader in)
    {
        this.in = in;
    }
    public Record readRecord()
    {
        String line = in.readLine();

        if (line == null) {
            return null;
        }

        Record r = new Record(line, in.readLine());

        return r;
    }
} 
```

# php - 合并两个 PHP 对象的最佳方法是什么？

> ID：455700
> 
> 赞同：240
> 
> 时间：2009-01-18T18:55:18.720
> 
> 标签：php, oop, object

我们有两个 PHP5 对象，想将一个的内容合并到第二个中。它们之间没有子类的概念，因此无法应用以下主题中描述的解决方案。

[如何将 PHP 对象复制到不同的对象类型中](https://stackoverflow.com/questions/119281/how-do-you-copy-a-php-object-into-a-different-object-type)

```
//We have this:
$objectA->a;
$objectA->b;
$objectB->c;
$objectB->d;

//We want the easiest way to get:
$objectC->a;
$objectC->b;
$objectC->c;
$objectC->d; 
```

**评论：**

*   这些是对象，而不是类。
*   这些对象包含相当多的字段，因此**foreach**会很慢。
*   到目前为止，我们考虑将对象 A 和 B 转换为数组，然后在重新转换为对象之前使用**array_merge()**合并它们，但我们不能说我们为此感到自豪。

* * *

## 回答 #1

> 赞同：476
> 
> 时间：2009-12-23T14:24:28.140

> 如果您的对象仅包含字段（无方法），则此方法有效：

```
$obj_merged = (object) array_merge((array) $obj1, (array) $obj2); 
```

当对象有方法时，这实际上也有效。（用 PHP 5.3 和 5.6 测试）

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-18T19:18:15.507

```
foreach($objectA as $k => $v) $objectB->$k = $v; 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-18T19:17:33.713

您可以创建另一个对象，它将对魔术方法的调用分派给底层对象。以下是您的处理方式`__get`，但要使其充分发挥作用，您必须覆盖所有相关的魔术方法。您可能会发现语法错误，因为我只是在脑海中输入了它。

```
class Compositor {
  private $obj_a;
  private $obj_b;

  public function __construct($obj_a, $obj_b) {
    $this->obj_a = $obj_a;
    $this->obj_b = $obj_b;
  }

  public function __get($attrib_name) {
    if ($this->obj_a->$attrib_name) {
       return $this->obj_a->$attrib_name;
    } else {
       return $this->obj_b->$attrib_name;
    }
  }
} 
```

祝你好运。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-27T22:12:27.727

我知道使用通用对象 [stdClass()] 并将它们转换为数组可以回答这个问题，但我认为 Compositor 是一个很好的答案。然而我觉得它可以使用一些功能增强，并且可能对其他人有用。

特征：

*   指定参考或克隆
*   指定第一个或最后一个条目优先
*   多个（两个以上）对象合并，语法与 array_merge 相似
*   方法链接：$obj->f1()->f2()->f3()...
*   *动态*组合： $obj->merge(...) /* 在这里工作 */ $obj->merge(...)

代码：

```
class Compositor {

    protected $composite = array();
    protected $use_reference;
    protected $first_precedence;

    /**
     * __construct, Constructor
     *
     * Used to set options.
     *
     * @param bool $use_reference whether to use a reference (TRUE) or to copy the object (FALSE) [default]
     * @param bool $first_precedence whether the first entry takes precedence (TRUE) or last entry takes precedence (FALSE) [default]
     */
    public function __construct($use_reference = FALSE, $first_precedence = FALSE) {
        // Use a reference
        $this->use_reference = $use_reference === TRUE ? TRUE : FALSE;
        $this->first_precedence = $first_precedence === TRUE ? TRUE : FALSE;

    }

    /**
     * Merge, used to merge multiple objects stored in an array
     *
     * This is used to *start* the merge or to merge an array of objects.
     * It is not needed to start the merge, but visually is nice.
     *
     * @param object[]|object $objects array of objects to merge or a single object
     * @return object the instance to enable linking
     */

    public function & merge() {
        $objects = func_get_args();
        // Each object
        foreach($objects as &$object) $this->with($object);
        // Garbage collection
        unset($object);

        // Return $this instance
        return $this;
    }

    /**
     * With, used to merge a singluar object
     *
     * Used to add an object to the composition
     *
     * @param object $object an object to merge
     * @return object the instance to enable linking
     */
    public function & with(&$object) {
        // An object
        if(is_object($object)) {
            // Reference
            if($this->use_reference) {
                if($this->first_precedence) array_push($this->composite, $object);
                else array_unshift($this->composite, $object);
            }
            // Clone
            else {
                if($this->first_precedence) array_push($this->composite, clone $object);
                else array_unshift($this->composite, clone $object);
            }
        }

        // Return $this instance
        return $this;
    }

    /**
     * __get, retrieves the psudo merged object
     *
     * @param string $name name of the variable in the object
     * @return mixed returns a reference to the requested variable
     *
     */
    public function & __get($name) {
        $return = NULL;
        foreach($this->composite as &$object) {
            if(isset($object->$name)) {
                $return =& $object->$name;
                break;
            }
        }
        // Garbage collection
        unset($object);

        return $return;
    }
} 
```

用法：

```
$obj = new Compositor(use_reference, first_precedence);
$obj->merge([object $object [, object $object [, object $...]]]);
$obj->with([object $object]); 
```

例子：

```
$obj1 = new stdClass();
$obj1->a = 'obj1:a';
$obj1->b = 'obj1:b';
$obj1->c = 'obj1:c';

$obj2 = new stdClass();
$obj2->a = 'obj2:a';
$obj2->b = 'obj2:b';
$obj2->d = 'obj2:d';

$obj3 = new Compositor();
$obj3->merge($obj1, $obj2);
$obj1->c = '#obj1:c';
var_dump($obj3->a, $obj3->b, $obj3->c, $obj3->d);
// obj2:a, obj2:b, obj1:c, obj2:d
$obj1->c;

$obj3 = new Compositor(TRUE);
$obj3->merge($obj1)->with($obj2);
$obj1->c = '#obj1:c';
var_dump($obj3->a, $obj3->b, $obj3->c, $obj3->d);
// obj1:a, obj1:b, obj1:c, obj2:d
$obj1->c = 'obj1:c';

$obj3 = new Compositor(FALSE, TRUE);
$obj3->with($obj1)->with($obj2);
$obj1->c = '#obj1:c';
var_dump($obj3->a, $obj3->b, $obj3->c, $obj3->d);
// obj1:a, obj1:b, #obj1:c, obj2:d
$obj1->c = 'obj1:c'; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-06-01T18:45:37.410

考虑到您有对象 A 和 B，一个非常简单的解决方案：

```
foreach($objB AS $var=>$value){
    $objA->$var = $value;
} 
```

就这样。您现在拥有 objA，其中包含来自 objB 的所有值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-12T21:41:49.020

该类`\ArrayObject`有可能*交换*当前数组以断开原始*引用*。为此，它提供了两种方便的方法：`exchangeArray()`和`getArrayCopy()`. 剩下的很简单`array_merge()`，就是提供的带有`ArrayObject`s 公共属性的对象：

```
class MergeBase extends ArrayObject
{
     public final function merge( Array $toMerge )
     {
          $this->exchangeArray( array_merge( $this->getArrayCopy(), $toMerge ) );
     }
 } 
```

用法很简单：

```
 $base = new MergeBase();

 $base[] = 1;
 $base[] = 2;

 $toMerge = [ 3,4,5, ];

 $base->merge( $toMerge ); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-06-08T15:48:52.900

一个解决方案要保留合并对象中的方法和属性，就是创建一个组合子类，它可以

*   在 __construct 上取任意数量的对象
*   使用 __call 访问任何方法
*   使用 __get 访问任何属性

* * *

```
class combinator{
function __construct(){       
    $this->melt =  array_reverse(func_get_args());
      // array_reverse is to replicate natural overide
}
public function __call($method,$args){
    forEach($this->melt as $o){
        if(method_exists($o, $method)){
            return call_user_func_array([$o,$method], $args);
            //return $o->$method($args);
            }
        }
    }
public function __get($prop){
        foreach($this->melt as $o){
          if(isset($o->$prop))return $o->$prop;
        }
        return 'undefined';
    } 
} 
```

* * *

简单使用

```
class c1{
    public $pc1='pc1';
    function mc1($a,$b){echo __METHOD__." ".($a+$b);}
}
class c2{
    public $pc2='pc2';
    function mc2(){echo __CLASS__." ".__METHOD__;}
}

$comb=new combinator(new c1, new c2);

$comb->mc1(1,2);
$comb->non_existing_method();  //  silent
echo $comb->pc2; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-07T10:18:05.233

我会将第二个对象链接到第一个对象的属性中。如果第二个对象是函数或方法的结果，请使用引用。前任：

```
//Not the result of a method
$obj1->extra = new Class2();

//The result of a method, for instance a factory class
$obj1->extra =& Factory::getInstance('Class2'); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-10-10T13:08:56.783

合并任意数量的原始对象

```
function merge_obj(){
    foreach(func_get_args() as $a){
        $objects[]=(array)$a;
    }
    return (object)call_user_func_array('array_merge', $objects);
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-12T23:26:15.877

这段代码将递归地将该数据转换为单个类型（数组或对象），而无需嵌套 foreach 循环。希望它可以帮助某人！

一旦 Object 采用数组格式，您可以使用 array_merge 并在需要时转换回 Object。

```
abstract class Util {
    public static function object_to_array($d) {
        if (is_object($d))
            $d = get_object_vars($d);

        return is_array($d) ? array_map(__METHOD__, $d) : $d;
    }

    public static function array_to_object($d) {
        return is_array($d) ? (object) array_map(__METHOD__, $d) : $d;
    }
} 
```

程序方式

```
function object_to_array($d) {
    if (is_object($d))
        $d = get_object_vars($d);

    return is_array($d) ? array_map(__FUNCTION__, $d) : $d;
}

function array_to_object($d) {
    return is_array($d) ? (object) array_map(__FUNCTION__, $d) : $d;
} 
```

所有功劳归于：杰森·奥克利

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T16:23:01.773

这是一个可以展平对象或数组的函数。仅当您确定您的密钥是唯一的时才使用此选项。如果您有同名的键，它们将被覆盖。您需要将它放在一个类中，并将“函数”替换为您的类的名称。享受...

```
function flatten($array, $preserve_keys=1, &$out = array(), $isobject=0) {
        # Flatten a multidimensional array to one dimension, optionally preserving keys.
        #
        # $array - the array to flatten
        # $preserve_keys - 0 (default) to not preserve keys, 1 to preserve string keys only, 2 to preserve all keys
        # $out - internal use argument for recursion
        # $isobject - is internally set in order to remember if we're using an object or array
        if(is_array($array) || $isobject==1)
        foreach($array as $key => $child)
            if(is_array($child))
                $out = Functions::flatten($child, $preserve_keys, $out, 1); // replace "Functions" with the name of your class
            elseif($preserve_keys + is_string($key) > 1)
                $out[$key] = $child;
            else
                $out[] = $child;

        if(is_object($array) || $isobject==2)
        if(!is_object($out)){$out = new stdClass();}
        foreach($array as $key => $child)
            if(is_object($child))
                $out = Functions::flatten($child, $preserve_keys, $out, 2); // replace "Functions" with the name of your class
            elseif($preserve_keys + is_string($key) > 1)
                $out->$key = $child;
            else
                $out = $child;

        return $out;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-02T20:10:14.473

让我们保持简单！

```
function copy_properties($from, $to, $fields = null) {
    // copies properties/elements (overwrites duplicates)
    // can take arrays or objects 
    // if fields is set (an array), will only copy keys listed in that array
    // returns $to with the added/replaced properties/keys
    $from_array = is_array($from) ? $from : get_object_vars($from);
    foreach($from_array as $key => $val) {
        if(!is_array($fields) or in_array($key, $fields)) {
            if(is_object($to)) {
                $to->$key = $val;
            } else {
                $to[$key] = $val;
            }
        }
    }
    return($to);
} 
```

如果那不能回答您的问题，那肯定会有助于答案。上面的代码归功于我自己:)

# .net - 没有响应的 HttpWebRequest - 可以吗？

> ID：455706
> 
> 赞同：1
> 
> 时间：2009-01-18T18:56:39.293
> 
> 标签：.net

我想知道是否可以在不等待响应的情况下发送 HttpWebRequest（使用 .NET）。

我有兴趣发送信息，但我不在乎回复。

我必须等待回复吗？或者我可以安全地发出请求？

我想这与以下问题相同：

[如何在不等待响应且不占用资源的情况下在 asp.net 中发送 http 请求](https://stackoverflow.com/questions/449506/how-to-send-http-request-in-asp-net-without-waiting-for-a-response-and-without-ty)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T19:29:11.320

不，您不能只是忽略它，以确保服务器处理您需要确保某些东西正在侦听响应的请求。

[另一个问题](https://stackoverflow.com/questions/449506/how-to-send-http-request-in-asp-net-without-waiting-for-a-response-and-without-ty)中的异步解决方案就是答案。正如其他人所说，肯定对请求一定有一定程度的兴趣？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T19:22:17.603

我想这取决于你的价值——以及反应如何影响它。你关心响应可能包含什么吗？你关心用户是否知道结果吗？您是否关心您的应用程序的功能是否正常工作？

如果您根本不关心传出消息的结果，那么您似乎可以忽略结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T14:36:57.850

该行为取决于处理请求的服务器逻辑。例如，在 ASP.NET 中，如果您正在处理长请求，您可以选择定期检查**Request.IsClientConnected**以确保客户端已连接并等待响应。如果客户端已断开连接，您可以决定终止处理。这有助于为长时间运行的请求节省宝贵的服务器资源。

如果您控制服务器，那么您应该可以发送请求并终止而无需等待响应。如果服务器不是您的，您可以尝试反复试验以找出服务器行为。

PS：我假设您不关心任何服务器错误应您的要求。如果您需要确保您的请求成功，则必须等待响应。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-18T19:23:45.340

那么，您不关心您的请求是否已在服务器上*收到吗？*

如果您甚至不关心这一点，那么您似乎一开始就不需要发送任何东西。

你为什么不关心回应？（或者更确切地说，为什么你认为你不关心回应？）

# algorithm - 使用受限功能语言对并行数组进行排序的最有效方法

> ID：455712
> 
> 赞同：2
> 
> 时间：2009-01-18T18:59:22.767
> 
> 标签：algorithm, sorting, scripting

环境：我正在使用一种专有的脚本语言，其中没有用户定义函数之类的东西。我有可以创建和使用的各种循环和原始类型的局部变量。

我有两个相关的数组，“次”和“值”。它们都包含浮点值。我想对“times”数组进行数字排序，但必须确保对“values”数组应用相同的操作。在没有递归之类的好处的情况下，我能做到这一点的最有效方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T20:12:45.083

**您可以维护一个索引表并对索引表进行排序。**

这样您就不必担心时间和价值观是否一致。

每当您需要排序值时，您都可以在排序索引上查找。

如果将来您决定要使用第三个值，则排序代码将不需要任何更改。

这是 C# 中的示例，但它应该不难适应您的脚本语言：

```
static void Main() {

    var r = new Random();

    // initialize random data
    var index = new int[10];      // the index table
    var times = new double[10];   // times 
    var values = new double[10];  // values

    for (int i = 0; i < 10; i++) {
        index[i] = i;
        times[i] = r.NextDouble();
        values[i] = r.NextDouble();
    }

    // a naive bubble sort
    for (int i = 0; i < 10; i++)
        for (int j = 0; j < 10; j++)

            // compare time value at current index
            if (times[index[i]] < times[index[j]]) {

                // swap index value (times and values remain unchanged)
                var temp = index[i];
                index[i] = index[j];
                index[j] = temp;
            }

    // check if the result is correct
    for (int i = 0; i < 10; i++)
        Console.WriteLine(times[index[i]]);

    Console.ReadKey();

} 
```

注意：我在那里使用了一个简单的冒泡排序，小心。在您的情况下，插入排序可能是一个不错的选择。因为你不想要复杂的递归。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T19:08:40.270

只需采用您最喜欢的排序算法（例如 Quicksort 或 Mergesort）并使用它对“值”数组进行排序。每当在“values”中交换两个值时，也要在“times”数组中交换具有相同索引的值。

所以基本上你可以采用任何快速排序算法并修改 swap() 操作，以便交换两个数组中的元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T19:36:44.533

看看[Algorithmist 的自底向上合并排序](http://www.algorithmist.com/index.php/Merge_sort#Bottom-up_merge_sort)。这是一种执行归并排序的非递归方式。那里提供的版本使用函数调用，但可以很容易地内联。

就像 martinus 所说，每次更改一个数组中的值时，在并行数组中执行完全相同的操作。

这是一个类似 C 的稳定非递归合并排序版本，它不进行函数调用，也不使用递归。

```
const int arrayLength = 40;
float times_array[arrayLength];
float values_array[arrayLength];

// Fill the two arrays....

// Allocate two buffers
float times_buffer[arrayLength];
float values_buffer[arrayLength];
int blockSize = 1;

while (blockSize <= arrayLength)
{
    int i = 0;
    while (i < arrayLength-blockSize)
    {
        int begin1 = i;
        int end1 = begin1 + blockSize;
        int begin2 = end1;
        int end2 = begin2 + blockSize;

        int bufferIndex = begin1;
        while (begin1 < end1 && begin2 < end2)
        {
            if ( values_array[begin1] > times_array[begin2] )
            {
                times_buffer[bufferIndex] = times_array[begin2];
                values_buffer[bufferIndex++] = values_array[begin2++];
            }
            else
            {
                times_buffer[bufferIndex] = times_array[begin1];
                values_buffer[bufferIndex++] = values_array[begin1++];
            }
        }
        while ( begin1 < end1 )
        {
            times_buffer[bufferIndex] = times_array[begin1];
            values_buffer[bufferIndex++] = values_array[begin1++];
        }
        while ( begin2 < end2 )
        {
            times_buffer[bufferIndex] = times_array[begin2];
            values_buffer[bufferIndex++] = values_array[begin2++];
        }

        for (int k = i; k < i + 2 * blockSize; ++k)
        {
            times_array[k] = times_buffer[k];
            values_array[k] = values_buffer[k];
        }

        i += 2 * blockSize;
    }
    blockSize *= 2;
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-07-21T17:48:34.973

我不建议编写自己的排序例程，因为作为 Java 语言的一部分提供的排序例程已经过优化。

我解决这个问题的方法是将java.util.Arrays 类中的代码复制到您自己的类中，即org.mydomain.util.Arrays。并添加一些注释，告诉自己不要使用该类，除非您必须具有要添加的附加功能。Arrays 类非常稳定，因此它不像看起来那么理想，但它仍然不太理想。但是，您需要更改的方法是私有的，因此您别无选择。

然后，您希望按照以下方式创建接口：
`public static interface SwapHook {
void swap(int a, int b);
}` 

 `You then need to add this to the sort method you're going to use, and to every subordinate method called in the sorting procedure, which swaps elements in your primary array. You arrange for the hook to get called by your modified sorting routine, and you can then implement the SortHook interface to achieve the behaviour you want in any secondary (e.g. parallel) arrays.` 

`HTH.`

# c# - 有选择地为 RichTextBox 中的文本着色

> ID：455713
> 
> 赞同：8
> 
> 时间：2009-01-18T18:59:49.287
> 
> 标签：c#, format, richtextbox

每次在 RichTextBox 中遇到字母“A”时，如何将其涂成红色？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-18T20:47:31.457

试试这个：

```
static void HighlightPhrase(RichTextBox box, string phrase, Color color) {
  int pos = box.SelectionStart;
  string s = box.Text;
  for (int ix = 0; ; ) {
    int jx = s.IndexOf(phrase, ix, StringComparison.CurrentCultureIgnoreCase);
    if (jx < 0) break;
    box.SelectionStart = jx;
    box.SelectionLength = phrase.Length;
    box.SelectionColor = color;
    ix = jx + 1;
  }
  box.SelectionStart = pos;
  box.SelectionLength = 0;
} 
```

...

```
private void button1_Click(object sender, EventArgs e) {
  richTextBox1.Text = "Aardvarks are strange animals";
  HighlightPhrase(richTextBox1, "a", Color.Red);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-27T07:11:34.320

这是我的包装类中的一个片段来完成这项工作：

```
 private delegate void AddMessageCallback(string message, Color color);

    public void AddMessage(string message)
    {
        Color color = Color.Empty;

        string searchedString = message.ToLowerInvariant();

        if (searchedString.Contains("failed")
            || searchedString.Contains("error")
            || searchedString.Contains("warning"))
        {
            color = Color.Red;
        }
        else if (searchedString.Contains("success"))
        {
            color = Color.Green;
        }

        AddMessage(message, color);
    }

    public void AddMessage(string message, Color color)
    {
        if (_richTextBox.InvokeRequired)
        {
            AddMessageCallback cb = new AddMessageCallback(AddMessageInternal);
            _richTextBox.BeginInvoke(cb, message, color);
        }
        else
        {
            AddMessageInternal(message, color);
        }
    }

    private void AddMessageInternal(string message, Color color)
    {
        string formattedMessage = String.Format("{0:G}   {1}{2}", DateTime.Now, message, Environment.NewLine);

        if (color != Color.Empty)
        {
            _richTextBox.SelectionColor = color;
        }
        _richTextBox.SelectedText = formattedMessage;

        _richTextBox.SelectionStart = _richTextBox.Text.Length;
        _richTextBox.ScrollToCaret();
    } 
```

Now you can call it with `AddMessage("The command failed")` to get it automatically highlight in red. Or you can call it with `AddMessage("Just a special message", Color.Purple)` to define a special color (Helpful e.g. within catch blocks to define a specific color, regardless of the message content)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T19:13:26.063

如果这是您要查找的内容，则在您键入时这将不起作用，但我使用它来突出显示子字符串：

```
Function Highlight(ByVal Search_Str As Object, ByVal InputTxt As String, ByVal StartTag As String, ByVal EndTag As String) As String
    Highlight = Regex.Replace(InputTxt, "(" & Regex.Escape(Search_Str) & ")", StartTag & "$1" & EndTag, RegexOptions.IgnoreCase)
End Function 
```

并这样称呼它：

```
Highlight("A", "我所有 A 的颜色为红色", [span class=highlight]', '[/span]')

```

“highlight”类具有您想要的任何颜色编码/格式：

```
.highlight {文本装饰：无；颜色：黑色；背景：红色；}

```

顺便说一句：您需要将那些方括号更改为有角度的括号...当我键入它们时它们不会通过...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T20:53:33.863

这是 EJ Brennan 的答案的 C# 代码：

```
public string Highlight(object Search_Str, string InputTxt, string StartTag, string EndTag) 
{
    return Regex.Replace(InputTxt, "(" + Regex.Escape(Search_Str) + ")", StartTag + "$1" + EndTag, RegexOptions.IgnoreCase);
} 
```

# python - Python 3 开发和分发挑战

> ID：455717
> 
> 赞同：9
> 
> 时间：2009-01-18T19:01:08.397
> 
> 标签：python, version-control, python-3.x

假设我开发了一个用 Python 编写的通用最终用户实用程序。以前，我只有一个适用于 Python 的版本，该版本晚于 2.3 版左右。说“如果需要，请下载 Python，然后运行此脚本”就足够了。源代码控制中只有一个版本的脚本（我正在使用 Git）来跟踪。

在 Python 3 中，这不再是必然的。在可预见的未来，我需要同时开发两个不同的版本，一个适合 Python 2.x，一个适合 Python 3.x。从开发的角度来看，我可以想到几个选择：

1.  在同一分支中维护两个不同的脚本，同时对两者进行改进。
2.  维护两个独立的分支，并随着开发的进行来回合并常见的更改。
3.  只维护脚本的一个版本，并签入将脚本从一个版本转换为另一个版本的补丁文件。当进行了足够多的更改以致补丁不再干净应用时，请解决冲突并创建新补丁。

我目前倾向于选项 3，因为前两个将涉及很多容易出错的乏味。但是选项 3 似乎很混乱，我的源代码控制系统应该为我管理补丁。

对于配送包装，有更多选项可供选择：

1.  提供两种不同的下载包，一种适用于 Python 2，一种适用于 Python 3（用户必须知道为他们拥有的任何 Python 版本下载正确的下载包）。
2.  提供一个下载包，其中包含两个不同的脚本（然后用户必须知道运行正确的脚本）。
3.  一个包含两个特定于版本的脚本的下载包，以及一个可以在两个 Python 版本中运行的小型存根加载程序，它为已安装的 Python 版本运行正确的脚本。

我现在再次倾向于选项 3，尽管我还没有尝试开发这样的存根加载器。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-18T20:38:22.897

**编辑：**我最初的答案是基于 2009 年的状态，当前版本为 Python 2.6 和 3.0。现在，有了 Python 2.7 和 3.3，还有其他选择。特别是，现在为 Python 2 和 Python 3 使用单一代码库是非常可行的。

请参阅[将 Python 2 代码移植到 Python 3](http://docs.python.org/3/howto/pyporting.html)

**原答案：**

[官方推荐](http://docs.python.org/3.0/whatsnew/3.0.html#porting-to-python-3-0)说：

> 要将现有的 Python 2.5 或 2.6 源代码移植到 Python 3.0，最佳策略如下：
> 
> 1.  （先决条件：）从出色的测试覆盖率开始。
>     
>     
> 2.  移植到 Python 2.6。这应该不会比从 Python 2.x 到 Python 2.(x+1) 的平均端口工作更多。确保所有测试都通过。
>     
>     
> 3.  （还在用2.6：）打开-3命令行开关。这会启用有关将在 3.0 中删除（或更改）的功能的警告。再次运行您的测试套件，并修复您收到警告的代码，直到没有警告留下，并且您的所有测试仍然通过。
>     
>     
> 4.  在源代码树上运行 2to3 源到源转换器。（有关此工具的更多信息，请参阅 2to3 - 自动 Python 2 到 3 代码翻译。）在 Python 3.0 下运行翻译结果。手动修复任何剩余的问题，修复问题，直到所有测试再次通过。
>     
>     
> 
> 不建议尝试编写在 Python 2.6 和 3.0 下都运行不变的源代码；您必须使用非常扭曲的编码风格，例如避免打印语句、元类等等。如果您正在维护一个需要同时支持 Python 2.6 和 Python 3.0 的库，最好的方法是通过编辑 2.6 版本的源代码并再次运行 2to3 转换器来修改上面的步骤 3，而不是编辑 3.0 版本的源代码。

理想情况下，您最终会得到一个与 2.6 兼容的版本，并且可以使用 2to3 转换为 3.0。在实践中，您可能无法完全实现此目标。因此，您可能需要进行一些手动修改才能使其在 3.0 下工作。

我会在一个分支中维护这些修改，就像您的选项 2。但是，我不会在此分支中维护最终的 3.0 兼容版本，而是考虑在 2to3 翻译*之前*应用手动修改，并将修改后的 2.6 代码放入您的分支。这种方法的优点是这个分支和 2.6 主干之间的差异会很小，并且只包含手动更改，而不是 2to3 所做的更改。这样，单独的分支应该更易于维护和合并，并且您应该能够从 2to3 的未来改进中受益。

Alternatively, take a bit of a "wait and see" approach. Proceed with your porting only so far as you can go with a single 2.6 version plus 2to3 translation, and postpone the remaining manual modification until you really need a 3.0 version. Maybe by this time, you don't need any manual tweaks anymore...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T19:06:36.403

对于开发来说，选项 3 过于繁琐。维护两个分支是最简单的方法，尽管不同 VCS 的方法会有所不同。许多 DVCS 会更喜欢单独的存储库（具有共同的祖先来帮助合并），而集中式 VCS 可能更容易与两个分支一起使用。选项 1 是可能的，但您可能会错过一些要合并的东西，而且 IMO 更容易出错。

对于分发，如果可能的话，我也会使用选项 3。无论如何，所有 3 个选项都是有效的，我不时看到这些模型的变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T20:31:32.550

我不认为我会走这条路。无论你怎么看都是痛苦的。真的，除非同时保持两个版本有强烈的商业利益，否则这比收益更令人头疼。

我认为现在继续为 2.x 开发更有意义，至少几个月，最多一年。在某个时间点，正是时候宣布 2.x 的最终稳定版本并为 3.x+ 开发下一个版本

例如，在一些主要框架采用这种方式之前，我不会切换到 3.x：PyQt、matplotlib、numpy 和其他一些。而且我真的不介意他们是否会停止对 2.x 的支持并开始为 3.x 开发，因为我知道在很短的时间内我也可以切换到 3.x。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T19:44:26.640

我将从迁移到非常接近 python 3.0 的 2.6 开始。你甚至可能想要等待 2.7，它会更接近于 python 3.0。

然后，一旦你迁移到 2.6（或 2.7），我建议你只保留一个版本的脚本，在它会出现的少数地方写上“if PY3K:... else:...”之类的东西强制的。当然，这不是我们开发人员喜欢编写的那种代码，但是您不必担心管理多个脚本或分支或补丁或发行版，这将是一场噩梦。

无论您选择什么，请确保您拥有 100% 代码覆盖率的全面测试。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T19:37:11.520

无论选择哪种开发选项，大多数潜在问题都可以通过彻底的单元测试来缓解，以确保两个版本产生匹配的输出。也就是说，选项 2 对我来说似乎是最自然的：将更改从一个源代码树应用到另一个源代码树是（大多数）版本控制系统设计的任务——为什么不利用它们提供的工具来缓解这个问题。

对于发展，如果不“了解你的受众”就很难说。Power Python 用户可能会很高兴不必为更一般的用户群下载您的软件的两个副本，它可能应该“正常工作”。

# java - JTextArea - 非常小的尺寸和长文本

> ID：455753
> 
> 赞同：1
> 
> 时间：2009-01-18T19:28:24.143
> 
> 标签：java, swing, textarea, sizing

我正在使用 JTextArea 来显示长文本

```
JTextArea _definition = new JTextArea(5, 50); 
```

带自动换行

```
_definition.setLineWrap(true);
_definition.setWrapStyleWord(true); 
```

嵌入在 JScrollPane 中

```
add(new JScrollPane(_definition), gbc); 
```

所有这些都是带有 GridBagLayout 的 JPanel 的一部分。

使用较短的文本一切正常，但是当我添加带有换行的长文本并且需要滚动条时，pack() 向南移动并且所有组件都只有最小尺寸并且对话框不可用（不仅仅是 TextArea 是做作的）。

我试图弄清楚发生了什么，但我只能弄清楚这与 TextArea 中的文本有关。我被困住了..有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T19:46:59.927

尝试调用`pack()`两次。JTextArea 有一些奇怪的行为[，如 Java 错误数据库中的此条目所述](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4924163)。它最初将其首选大小报告为非常宽的单行条目（例如，一行，一千列）。一旦它意识到它是一个特定的宽度，它就会为它需要的行数报告一个正确的首选大小。

我不得不做很多不同的事情来解决这种行为，包括继承 JTextArea 并将其行为修改为更智能一些。在这种情况下， Double`pack()`可能对您有用，或者您可能不得不根据布局中的所有内容如何组合在一起进行更复杂的调整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T21:04:53.530

让它工作..罗斯的回答给了我一些更好的搜索条件，所以感谢您通过指出正确的方向来帮助我！

```
 pack();
 _definition.setSize(_definition.getPreferredSize());
 pack(); 
```

所以双重包装加上一些额外的......奇怪的行为。

# c# - 如何从后台线程正确更新数据绑定 datagridview

> ID：455766
> 
> 赞同：8
> 
> 时间：2009-01-18T19:39:22.250
> 
> 标签：c#, multithreading, data-binding, datagridview, inotifypropertychanged

我有一个实现 INotifyPropertyChanged 的​​自定义对象。我有这些对象的集合，其中集合基于 BindingList 我已经为集合创建了绑定源，并设置了 bindingsource 和 datagridview 的数据源。

一切都很好，除了我需要从后台线程更新自定义对象的属性。当我这样做时，我收到以下错误：

> BindingSource 不能是它自己的数据源。不要将 DataSource 和 DataMember 属性设置为引用回 BindingSource 的值

我发现以下帖子似乎有我的确切问题（和解决方案？），但我无法弄清楚。

> [http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/3566f7c7-eb47-422e-ab09-9549a18da360/](http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/3566f7c7-eb47-422e-ab09-9549a18da360/)

我在我的业务对象中创建并初始化每个帖子的操作变量，然后我将两个事件函数放入我的集合类中。这编译正确，但运行时无异常挂起。

我看到很多帖子说要使用 Invoke/Begin Invoke，但我没有在 UI 上调用任何函数，只是更新业务对象，所以我不确定将调用调用放在哪里。

一个限制：我希望业务对象不知道谁在显示它（因为有多个消费者），因此将 GUI 引用发送到业务对象以便我以后能够使用这些引用调用调用不是一种选择。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-18T19:52:43.707

我在一个有效的论坛中找到了这门课。只需使用它而不是 BindingList

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using System.ComponentModel;
using System.Threading;

namespace Utility
{
    public class ThreadedBindingList<T> : BindingList<T>
    {
        SynchronizationContext ctx = SynchronizationContext.Current;

        protected override void OnAddingNew(AddingNewEventArgs e)
        {

            if (ctx == null)
            {
                BaseAddingNew(e);
            }
            else
            {
                ctx.Send(delegate
                {
                    BaseAddingNew(e);
                }, null);
            }
        }
        void BaseAddingNew(AddingNewEventArgs e)
        {
            base.OnAddingNew(e);
        }
        protected override void OnListChanged(ListChangedEventArgs e)
        {
           // SynchronizationContext ctx = SynchronizationContext.Current;
            if (ctx == null)
            {
                BaseListChanged(e);
            }
            else
            {
                ctx.Send(delegate
                {
                    BaseListChanged(e);
                }, null);
            }
        }
        void BaseListChanged(ListChangedEventArgs e)
        {
            base.OnListChanged(e);
        }
    } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T09:40:49.973

由于我花时间为我的需要格式化示例，我不妨将其发布在此处作为可读参考。除了格式没有任何变化。

```
using System.ComponentModel; 
using System.Threading;

namespace Utility 
{
  public class ThreadedBindingList : BindingList 
  {
    SynchronizationContext ctx = SynchronizationContext.Current;
    protected override void OnAddingNew(AddingNewEventArgs e)
    {
      if (ctx == null)
      {
        BaseAddingNew(e);
      }
      else
      {
        ctx.Send(delegate { BaseAddingNew(e); }, null);
      }
    }

    void BaseAddingNew(AddingNewEventArgs e)
    {
      base.OnAddingNew(e);
    }

    protected override void OnListChanged(ListChangedEventArgs e)
    {
      // SynchronizationContext ctx = SynchronizationContext.Current;
      if (ctx == null)
      {
        BaseListChanged(e);
      }
      else
      {
        ctx.Send(delegate { BaseListChanged(e); }, null);
      }
    }

    void BaseListChanged(ListChangedEventArgs e)
    {
      base.OnListChanged(e);
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-14T03:41:08.860

不是完全线程安全的，但是如果您的后台线程修改对象属性的速度比显示它们的速度快，那么对上述答案的这个小改动可能会产生很大的影响；

```
protected override void OnListChanged(ListChangedEventArgs e)
{
  // SynchronizationContext ctx = SynchronizationContext.Current;
  if (ctx == null)
  {
    BaseListChanged(e);
  }
  else if(e.ListChangedType == ListChangedType.ItemChanged)
  {
    ctx.Post(delegate { BaseListChanged(e); }, null);
  }
  else
  {
    ctx.Send(delegate { BaseListChanged(e); }, null);
  }
} 
```

如果同一个对象被多次修改，欢迎提出任何减少已发布呼叫数量的建议，并确保在处理完所有已发布呼叫之前，任何以后的发送呼叫都将被阻止。

# flex3 - 在 mx:TextInput 上的 MouseEvent.MOUSE_DOWN

> ID：455769
> 
> 赞同：1
> 
> 时间：2009-01-18T19:44:04.567
> 
> 标签：flex3, mxml

我正在开发一个简单的 flex / AIR 应用程序，只有一个 mx.TextInput 控件和一些按钮。我没有使用系统镀铬。

或多或少的mxml是这样的：

```
 <mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="495" height="316" creationComplete="init()">
    <mx:TitleWindow width="481" height="84" layout="absolute" horizontalCenter="0" showCloseButton="false" id="win" top="10">
        <mx:Label text="blahhh" id="label1" left="0" top="0"/>
        <mx:TextInput id="textinput1" left="155" top="0" right="5"  editable="true" />
        <mx:Label text="expand" right="36" bottom="0" click="toggleState()"/>
        <mx:Label text="exit" click="stage.nativeWindow.close()" right="0" bottom="0"/>
    </mx:TitleWindow>
</mx:Application> 
```

为了使窗口可拖动，我在 TitleWINdow 中添加了一个 MouseEvent.MOUSE_DOWN 侦听器：

```
win.addEventListener(MouseEvent.MOUSE_DOWN, function(e:MouseEvent):void { stage.nativeWindow.startMove();}); 
```

现在的问题是，内部的textinput控件似乎继承了eventlistner，所以你可以输入文本，但是你不能选择它（因为按住鼠标会触发NativeWindow.move()函数）。

我错过了什么吗？我希望只有当我在 TitleWindow 上鼠标按下时才可以拖动窗口，而不是在其他控件上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T22:22:34.450

您应该检查`target`事件对象的属性，如下所示：

```
win.addEventListener(MouseEvent.MOUSE_DOWN, function(e:MouseEvent):void {
    if (e.target == win)
        stage.nativeWindow.startMove();
}); 
```

否则，您还会捕获从内部元素（如 TextInput）冒泡的 mouseDown 事件。

# sql-server - SQL Server 2005 备份策略

> ID：455771
> 
> 赞同：1
> 
> 时间：2009-01-18T19:44:31.583
> 
> 标签：sql-server, backup, virtualhost

我为具有以下规格的客户端管理 Web 应用程序：

*   在虚拟 Windows 2003 Web 服务器上运行的 ASP.net 3.5
*   托管数据库的 SQL Server Standard
*   数据库当前大小为 6Gb，增长率为 1Gb/月
*   一张表负责 98% 的大小，为客户保存最关键的数据
*   这个大表不保存日志，只在这个表中进行选择
*   50 Gb FTP 空间可用于备份

考虑到这种情况，SQL 备份的最佳策略是什么？什么工具最适合这个任务（包括商业应用程序，客户可以支付许可费）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T19:58:25.363

这取决于数据的重要性。然而，这就是我的做法。1\. 每天运行一次完整备份。2\. 每 4 小时运行一次差异备份。3\. 每 15 分钟运行一次事务日志备份 4\. 在站点上保留一份副本，并在备份完成后立即将一份副本移出站点。

数据库不是太大，这很容易做到。

[使用Redgate SQL Backup](http://www.red-gate.com/products/sql_backup/index_2.htm)等第三方工具，它会自动为您压缩和加密数据库备份。我已经广泛使用它并且是它的忠实粉丝。

此外，如果您有另一个可用站点，并且数据非常关键，您可能还需要考虑设置日志传送。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T23:03:10.123

这是我们用于 CodePlex.com 的策略：

*   所有 SQL 服务器都与使用 SQL 镜像的对等服务器一起运行
*   每周完整备份（存储在与数据库不同的驱动器上）
*   每日差异备份（存储在与数据库不同的驱动器上）
*   每 5 分钟备份一次事务日志（存储在与数据库不同的驱动器上）
*   每日磁带备份
*   每周在异地进行磁带备份

***测试您的备份***也非常重要！ 研究表明，超过 30% 的未经测试的备份程序存在缺陷。这是我们的备份测试策略：

*   每 30 分钟验证完整备份文件是否存在（使用计划任务）
*   每 30 分钟验证差异备份文件是否存在（使用计划任务）
*   每 30 分钟验证一次事务日志备份文件是否存在（使用计划任务）
*   每 30 分钟验证一次数据库镜像是否已配置（使用计划任务）
*   每天，对完整+差异备份进行测试还原并报告表行数（使用计划任务）
*   每月对最近的磁带备份进行一次测试还原并验证数据

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T23:07:14.827

这是VPC？可以安装应用吗？

[http://www.jungledisk.com/](http://www.jungledisk.com/)

这就是我们使用的 - 制作一个每天推送备份的 sql 作业，然后使用该服务将副本推送回 Amazon S3 服务。如果不是，也许你可以有一个本地应用程序将备份拉到一台机器上，然后将它推送到 /w S3 webservice，或者仍然使用 Jungledisk。

这个很重要！如果您的应用程序出现故障，那会很痛苦！还要确保备份您部署的应用程序和存储在那里的资源......即上传内容到您的应用程序存储目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T22:44:12.050

[我应该输入我对您问题的答案，但我意识到在 SQLServerCentral.com 中的这篇文章](http://www.sqlservercentral.com/articles/Disaster+Recovery/backupscenariosforsuccessfulsqlserverrestoresandre/1421/)之类的地方有很多更多的资源。您还可以找到很多[像这样](http://www.brentozar.com/archive/2007/10/backing-up-sql-server-my-own-mediocre-practices/)的“备份最佳实践” 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T22:57:58.433

您可能还需要考虑您可以承受丢失多少数据以及恢复数据库需要多长时间。您的客户可能会决定他们永远不想丢失超过 15 分钟的数据，或者他们可能会认为丢失长达一天的数据对他们来说是可以接受的。

# algorithm - 是否存在不依赖连续存储的 O(1) 随机访问数据结构？

> ID：455781
> 
> 赞同：10
> 
> 时间：2009-01-18T19:51:58.823
> 
> 标签：algorithm, arrays, memory, data-structures, complexity-theory

经典的 O(1) 随机访问数据结构是数组。但是数组依赖于使用的编程语言来支持有保证的连续内存分配（因为数组依赖于能够获取基的简单偏移量来查找任何元素）。

这意味着语言必须具有关于内存是否连续的语义，而不是将其作为实现细节。因此，可能需要一个具有 O(1) 随机访问但不依赖于连续存储的数据结构。

有这样的事吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-18T20:15:01.523

如何将键的长度限制为某个常量 K（例如，4 个字节，以便您可以使用 32 位整数作为索引）[。](http://en.wikipedia.org/wiki/Trie)那么查找时间将是 O(K)，即 O(1) 与非连续内存。对我来说似乎很合理。

回想一下我们的复杂度类，不要忘记每个大 O 都有一个常数因子，即 O(n) + C，这种方法肯定会有比实际数组大得多的 C。

**编辑**：实际上，现在我考虑一下，它是 O(K*A) 其中 A 是“字母”的大小。每个节点必须有一个最多包含 A 个子节点的列表，该列表必须是一个链表，以保持实现不连续。但是 A 仍然是常数，所以它仍然是 O(1)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-18T21:01:52.660

In practice, for small datasets using contiguous storage is not a problem, and for large datasets O(log(n)) is just as good as O(1); the constant factor is rather more important.

In fact, For REALLY large datasets, O(root3(n)) random access is the best you can get in a 3-dimensional physical universe.

**Edit:** Assuming log10 and the O(log(n)) algorithm being twice as fast as the O(1) one at a million elements, it will take a trillion elements for them to become even, and a quintillion for the O(1) algorithm to become twice as fast - rather more than even the biggest databases on earth have.

All current and foreseeable storage technologies require a certain physical space (let's call it v) to store each element of data. In a 3-dimensional universe, this means for n elements there is a minimum distance of root3(n*v*3/4/pi) between at least some of the elements and the place that does the lookup, because that's the radius of a sphere of volume n*v. And then, the speed of light gives a physical lower boundary of root3(n*v*3/4/pi)/c for the access time to those elements - and that's O(root3(n)), no matter what fancy algorithm you use.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-18T19:55:14.527

哈希表？

编辑：一个数组是`O(1)`查找的，因为`a[i]`它只是`*(a+i)`. 换句话说，要获得`O(1)`，您需要一个指向每个元素的直接指针或一个易于计算的指针（以及您将要查找的内存用于您的程序的良好感觉）。在没有指向每个元素的指针的情况下，如果没有连续的内存，就不可能有一个易于计算的指针（并且知道内存是为您保留的）。

当然，有一个 Hashtable 实现是合理的（如果很糟糕），其中每个查找的内存地址只是`*(a + hash(i))`没有在数组中完成，即如果你有这种控制，则在指定的内存位置动态创建。关键是最有效的实现将是一个底层数组，但是在其他地方进行点击以进行 WTF 实现仍然可以让您进行恒定时间查找当然是合理的。

Edit2：我的观点是，数组依赖于连续内存，因为它是语法糖，但是 Hashtable 选择数组是因为它是最好的实现方法，而不是因为它是*必需*的。当然，我必须阅读 DailyWTF 太多，因为我想象重载 C++ 的数组索引运算符也可以在没有连续内存的情况下以相同的方式执行此操作..

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-18T20:03:37.413

除了哈希表，您还可以有一个两级数组数组：

*   将前 10,000 个元素存储在第一个子数组中
*   将下一个 10,000 个元素存储在下一个子数组中
*   等等

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-19T14:20:43.157

> 因此，可能需要一个具有 O(1) 随机访问但不依赖于连续存储的数据结构。
> 
> 有这样的事吗？

不，那里没有。证明草图：

如果您对连续块大小有限制，那么显然您必须使用间接来获取数据项。具有有限块大小的固定间接深度只能得到一个固定大小的图（尽管它的大小随深度呈指数增长），因此随着数据集的增长，间接深度将增长（仅对数，但不是 O(1) ）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-18T21:29:22.777

Aside from the obvious nested structures to finite depth noted by others, I'm not aware of a data structure with the properties you describe. I share others' opinions that with a well-designed logarithmic data structure, you can have non-contiguous memory with fast access times to any data that will fit in main memory.

I am aware of an interesting and closely related data structure:

*   Cedar [ropes](http://portal.acm.org/citation.cfm?id=219565) are immutable strings that provide logarithmic rather than constant-time *access*, but they do provide a constant-time concatenation operation and efficient insertion of characters. The paper is copyrighted but there is a [Wikipedia explanation](https://en.wikipedia.org/wiki/Rope_(data_structure)).

This data structure is efficient enough that you can represent the entire contents of a large file using it, and the implementation is clever enough to keep bits on disk unless you need them.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-18T20:18:44.700

当然，您在这里谈论的不是连续的内存存储，而是索引包含数据结构的能力。通常在内部将动态数组或列表实现为指针数组，其中包含内存中其他位置每个元素的实际内容。这样做的原因有很多——尤其是它使每个条目的大小都不同。正如其他人指出的那样，大多数哈希表实现也依赖于索引。我想不出一种方法来实现不依赖于索引的 O(1) 算法，但这至少意味着索引的连续内存。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T09:20:49.283

一些伪 O(1) 答案-

VList是 O(1) 访问（平均[而言](http://en.wikipedia.org/wiki/VList)），并且不需要整个数据是连续的，尽管它确实需要在小块中连续存储。其他基于数值表示的数据结构也摊销 O(1)。

数字表示应用与[基数排序](http://en.wikipedia.org/wiki/Radix_sort)相同的“作弊” ，产生 O(k) 访问结构 - 如果索引有另一个上限，例如它是 64 位 int，那么每个级别的二叉树对应于索引中的某个位需要一个恒定的时间。当然，对于可以与结构一起使用的任何 N，常数 k 都大于 lnN，因此它不太可能是性能改进（如果 k 仅比 lnN 大一点，并且实现基数排序更好地利用了平台）。

如果你使用堆实现中常见的二叉树表示，你最终会回到一个数组。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T21:46:39.357

A bit of a curiosity: the [hash trie](http://en.wikipedia.org/wiki/Hash_trie) saves space by interleaving in memory the key-arrays of trie nodes that happen not to collide. That is, if node 1 has keys A,B,D while node 2 has keys C,X,Y,Z, for example, then you can use the same contiguous storage for both nodes at once. It's generalized to different offsets and an arbitrary number of nodes; Knuth used this in his most-common-words program in [*Literate Programming*](http://www-cs-faculty.stanford.edu/~knuth/lp.html).

So this gives O(1) access to the keys of any given node, without reserving contiguous storage to it, albeit using contiguous storage for all nodes collectively.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-18T19:56:26.583

分布式哈希映射具有这样的属性。好吧，实际上，不完全是，基本上哈希函数会告诉您要查看的存储桶，在那里您可能需要依赖传统的哈希映射。它并不能完全满足您的要求，因为包含存储区域/节点的列表（在分布式场景中）通常是哈希映射（本质上使其成为哈希表的哈希表），尽管您可以使用其他一些算法，例如，如果存储区域的数量是已知的。

**编辑：**
忘了一点花絮，你可能想为不同的级别使用不同的哈希函数，否则你最终会在每个存储区域内得到很多相似的哈希值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-18T20:23:29.930

可以不为整个数据分配内存块，而仅为数据片段的引用数组分配内存块。这带来了必要的连续内存长度的急剧~~减少~~。

另一种选择，如果元素可以用键标识并且这些键可以唯一地映射到可用的内存位置，则可以不将所有对象连续放置，在它们之间留出空间。这需要控制内存分配，因此当您必须为第一优先对象使用该内存位置时，您仍然可以分配空闲内存并将第二优先对象重新定位到其他地方。但是，它们在子维度中仍然是连续的。

我可以命名一个常见的数据结构来回答您的问题吗？不。

# delphi - 在delphi中快速读取/写入文件

> ID：455790
> 
> 赞同：8
> 
> 时间：2009-01-18T19:57:12.557
> 
> 标签：delphi, file, binary

我正在以二进制形式将文件加载到数组中，这似乎需要一段时间是否有更好更快更有效的方法来做到这一点。我正在使用类似的方法写回文件。

```
procedure openfile(fname:string);
var
    myfile: file;
    filesizevalue,i:integer;
begin
  assignfile(myfile,fname);
  filesizevalue:=GetFileSize(fname); //my method
  SetLength(dataarray, filesizevalue);
  i:=0;
  Reset(myFile, 1);
  while not Eof(myFile) do
    begin
      BlockRead(myfile,dataarray[i], 1);
      i:=i+1;
    end;
  CloseFile(myfile);
end; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-19T08:17:38.727

如果您真的想快速读取二进制文件，请让 Windows 担心缓冲 ;-) 使用[Memory Mapped Files](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dngenlib/html/msdn_manamemo.asp)。使用它，您可以简单地将文件映射到一个内存位置，就像它是一个数组一样读取。

您的功能将变为：

```
procedure openfile(fname:string);
var
    InputFile: TMappedFile;
begin
  InputFile := TMappedFile.Create;
  try
    InputFile.MapFile(fname);
    SetLength(dataarray, InputFile.Size);
    Move(PByteArray(InputFile.Content)[0], Result[0], InputFile.Size);
  finally
    InputFile.Free;
  end;
end; 
```

但我建议不要使用全局变量`dataarray`，而是将其作为 var 传递给参数，或者使用返回结果数组的函数。

```
procedure ReadBytesFromFile(const AFileName : String; var ADestination : TByteArray);
var
    InputFile : TMappedFile;
begin
  InputFile := TMappedFile.Create;
  try
    InputFile.MapFile(AFileName);
    SetLength(ADestination, InputFile.Size);
    Move(PByteArray(InputFile.Content)[0], ADestination[0], InputFile.Size);
  finally
    InputFile.Free;
  end;
end; 
```

TMappedFile 来自我的文章[Fast reading of files using Memory Mapping](http://landman-code.blogspot.com/2006/04/it-has-been-six-months-since-i-last.html)，本文还包含一个示例，说明如何将其用于更“高级”的二进制文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-18T20:03:02.810

您通常不应该逐字节读取文件。使用具有较大值的 BlockRead（512 或 1024 通常是最好的）并使用它的返回值来找出读取了多少字节。

如果大小不是太大（并且您对 SetLength 的使用似乎支持这一点），您还可以使用一个 BlockRead 调用一次读取完整的文件。因此，修改您的方法，这将是：

```
AssignFile(myfile,fname);
filesizevalue := GetFileSize(fname);
Reset(myFile, 1);
SetLength(dataarray, filesizevalue);
BlockRead(myFile, dataarray[0], filesizevalue);
CloseFile(myfile); 
```

也许您也可以将过程更改为名为 OpenAndReadFile 的布尔函数，如果无法打开或读取文件，则返回 false。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-18T20:38:26.610

这取决于文件格式。如果它包含多个相同的记录，您可以决定创建该记录类型的文件。

例如：

```
type
  TMyRecord = record
    fieldA: integer;

    ..
  end;
  TMyFile = file of TMyRecord;

  const
    cBufLen = 100 * sizeof(TMyRecord);
  var
    file: TMyFile;
    i : Integer;

  begin
    AssignFile(file, filename);
    Reset(file);
    i := 0;
    try
      while not Eof(file) do begin
        BlockRead(file, dataarray[i], cBufLen);
        Inc(i, cBufLen);
      end;
    finally
      CloseFile(file);
    end;
  end; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T05:49:39.040

如果文件足够长，以这种方式读取它需要相当长的时间，我会改用流。块读取会快很多，而且不用担心循环。像这样的东西：

```
procedure openfile(fname:string);
var
    myfile: TFileStream;
    filesizevalue:integer;
begin
  filesizevalue:=GetFileSize(fname); //my method
  SetLength(dataarray, filesizevalue);
  myFile := TFileStream.Create(fname);
  try
    myFile.seek(0, soFromBeginning);
    myFile.ReadBuffer(dataarray[0], filesizevalue);
  finally
     myFile.free;
  end;
end; 
```

从您的代码中可以看出，您的记录大小为 1 个字节长。如果不是，则将读取行更改为：

```
 myFile.ReadBuffer(dataarray[0], filesizevalue * SIZE); 
```

或类似的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T09:32:23.473

寻找缓冲的 TStream 后代。由于磁盘读取速度很快，它将使您的代码更快，但您可以轻松地循环通过缓冲区。有各种各样的，或者你可以自己写。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T16:41:34.557

如果你觉得很头疼，你可以完全绕过 Win32 并调用 NT Native API 函数 ZwOpenFile() 在我的非正式测试中确实会减少一点。否则，我会使用上面的 Davy 的内存映射文件解决方案。

# c++ - 使用 VC++ 以编程方式从 Excel 复制单元格

> ID：455793
> 
> 赞同：0
> 
> 时间：2009-01-18T20:02:16.137
> 
> 标签：c++, visual-studio-2008, excel, com

**没有**：

*   MFC
*   ATL

使用**COM**和**纯 C++**，到目前为止采取的步骤：

```
//steps above omitted

_ApplicationPtr application(__uuidof(Excel::Application));

//omitted

const BSTR wcharFileName = SysAllocString(L"...");

application->Workbooks->Open(wcharFileName);

application->put_Visible(10, true); 
```

**问题：**

*   然后如何将单元格（例如 A4、B4 和 C4）复制到数组中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T20:30:07.903

试试这个[http://support.microsoft.com/kb/216388/en-us](http://support.microsoft.com/kb/216388/en-us)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-13T20:49:41.390

我之前发过那个

“对于 Excel - COM 使用 C++

[http://shaktisaran.tech.officelive.com/ExcelCOM.aspx](http://shaktisaran.tech.officelive.com/ExcelCOM.aspx)

它还有 Windows 编程教程。”

我删除了那个帖子，因为它不会轻易帮助。

我在网站上提供与示例相关的更多信息，

在 ExcelProcessor.cpp

ReadRange 函数读取一系列 Excel 单元格，但您需要读取一个单元格的数据。

ShowAddedCells 函数写入您可以使用的 Excel 单元格，如下所示。

在 ShowAddedCells 函数中，

```
//Comment the following
/*
DISPID dispidPUT = DISPID_PROPERTYPUT;

DISPPARAMS dparams = {vDblVal, &dispidPUT, 1, 1};

EXCEPINFO excepinfo;

hr = pXlCell->Invoke(dispID,
    IID_NULL,
    LOCALE_SYSTEM_DEFAULT,
    DISPATCH_PROPERTYPUT,
    &dparams,
    NULL,
    &excepinfo,
    NULL);
*/

//Add the following
DISPPARAMS dparams = {NULL, NULL, 0, 0};

EXCEPINFO excepinfo;

VARIANT vResult;
VariantInit(&vResult);

hr = pXlCell->Invoke(dispID,
    IID_NULL,
    LOCALE_SYSTEM_DEFAULT,
    DISPATCH_PROPERTYGET,
    &dparams,
    &vResult,
    &excepinfo,
    NULL);

//You get the cell value in vResult 
```

因此，您创建了一个 ReadCell 函数，例如 ShowAddedCells 函数。

# macos - 如何使用国际键盘消除 Mac OS X 上的死键？

> ID：455799
> 
> 赞同：4
> 
> 时间：2009-01-18T20:05:15.287
> 
> 标签：macos

^¨~ ´` 等键是我在 Mac OS X 上的瑞典语键盘上的死键（或半死键，因为它们开始键入字母，然后等待下一个字符，直到做出决定）。

我怎样才能将其关闭以使它们完全正常运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T20:46:06.813

[Ukelele](http://scripts.sil.org/ukelele)是 Mac OS X 键盘布局的编辑器。我没有用它来消除死键，但它知道它们并提供对布局的非常详细的访问。我很乐观，您可以创建一个没有死键的新键盘布局（从现有的键盘布局）。（我正在使用自己的增强型键盘布局来访问美国键盘上的德语变音符号。）键盘布局进入`~/Library/Keyboard Layouts`并可以在国际系统首选项窗格中激活。

根据来自[Ukelele](http://scripts.sil.org/ukelele)网站的信息：

> 用于 macOS 10.7 (Lion) 及更高版本的更灵活、跨平台的键盘实用程序是[Keyman](https://keyman.com)。但是，Keyman 不使用与 Ukelele 相同的 .keylayout 文件，并且需要使用其他软件。

# php - PHP 是否具有对象的简写语法？

> ID：455800
> 
> 赞同：42
> 
> 时间：2009-01-18T20:07:00.917
> 
> 标签：php, object

在 javascript 中，您可以轻松地创建对象和数组，如下所示：

```
var aObject = { foo:'bla', bar:2 };
var anArray = ['foo', 'bar', 2]; 
```

PHP中是否有类似的事情？
我知道您可以使用数组函数轻松创建一个数组，这几乎没有 javascript 语法更多的工作，但是创建对象是否有类似的语法？还是我应该只使用关联数组？

```
$anArray = array('foo', 'bar', 2);
$anObjectLikeAssociativeArray = array('foo'=>'bla',
                                      'bar'=>2); 
```

总结一下：
PHP 是否有类似对象创建的 javascript 或者我应该只使用关联数组？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-18T20:15:06.670

对于简单对象，您可以使用关联数组语法和强制转换来获取对象：

```
<?php
$obj = (object)array('foo' => 'bar');
echo $obj->foo; // yields "bar" 
```

但是看着它，你可以很容易地看到它是多么无用（如果你的结构那么简单，你只需将它作为关联数组保留）。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-01-18T20:13:31.260

有一个[实现这种数组语法的提议](http://wiki.php.net/rfc/shortsyntaxforarrays)。~~但被拒绝了。~~

* * *

**更新**    数组的缩短语法已被重新讨论、接受，并且现在正在[与 PHP 5.4 一起发布](https://wiki.php.net/todo/php54)。

但是仍然没有对象的简写。您可能需要显式转换为*object*：

```
$obj = (object) ['foo'=>'bla', 'bar'=>2]; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-09-20T22:19:10.390

从 PHP 5.4 开始，您可以这样做：

```
$array = ['foo'=>'bla', 'bar'=>2]; 
```

它并不短，但如果您需要使用大量硬编码的嵌套数组（这并不罕见），您会很感激。

如果你想要一个对象，你仍然需要转换每个数组：

```
$object = (object) ['foo'=>'bla', 'bar'=>2]; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-11T10:51:01.403

根据新的 PHP 语法，

您可以使用

```
$array = [1,2,3]; 
```

对于关联数组

```
$array = ['name'=>'Sanket','age'=>22]; 
```

对于对象，您可以将数组类型转换为对象

```
$object = (object)['name'=>'Sanket','age'=>22]; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-18T20:15:13.520

PHP 中没有对象简写，但您可以使用 Javascript 的确切语法，只要您使用[json_encode](http://us.php.net/json_encode)和[json_decode](http://us.php.net/json_decode)函数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-29T19:50:23.437

crescentfresh 提供的方法效果很好，但是我在向对象附加更多属性时遇到了问题。为了解决这个问题，我实现了 spl ArrayObject。

```
class ObjectParameter extends ArrayObject  {
     public function  __set($name,  $value) {
        $this->$name = $value;
    }

    public function  __get($name) {
      return $this[$name];
    }
}

//creating a new Array object
$objParam = new ObjectParameter;
//adding properties
$objParam->strName = "foo";
//print name
printf($objParam->strName);
//add another property
$objParam->strUser = "bar"; 
```

你可以用这种方法做很多事情，让你即使从数组中也能轻松创建对象，希望对你有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-05T01:13:26.300

就像 json_decode 的想法一样，这样写：

```
function a($json) {
 return json_decode($json, true); //turn true to false to use objets instead of associative arrays
}

//EXAMPLE
$cat = 'meow';

$array = a('{"value1":"Tester", 
  "value2":"'.$cat.'", 
  "value3":{"valueX":"Hi"}}');

print_r($array); 
```

# c# - 起订量有问题

> ID：455801
> 
> 赞同：2
> 
> 时间：2009-01-18T20:08:51.303
> 
> 标签：c#, unit-testing, moq

我正在尝试最小起订量，但在以下测试机构中遇到了问题：

```
var child = new Mock<ZooNode>();
var parent = new Mock<ZooNode>();
child.Object.Parent = parent.Object;
parent.Expect(p => p.Children.Contains(child.Object)).Returns(true); 
```

抛出：

> System.ArgumentException：对不可覆盖成员的期望无效：p => p.Children.Contains(value(ZooCms.Core.Tests.Model.ZooNodeTest+<>c__DisplayClass0).child.Object)。

而且我不太确定它的起订量，但我正在测试的代码相当简单。我不确定这是否重要，但 ZooNode 是一个抽象类。

提前致谢。

**编辑**

*[这是darin响应](https://stackoverflow.com/questions/455801/having-issues-with-moq#455828)建议修改后的代码：*

```
public abstract class ZooNode : ZooObject
{
    private ZooNode _parent{ get; set;}
    public ZooNode Parent { 
        get
        {
            return _parent;
        }
        set
        {
            if(Parent != null) 
                Parent.Children.Remove(value);
            _parent = value;
            _parent.Children.Add(this);
        }
    }
    public virtual IList<ZooNode> Children { get; private set; }

} 
```

它现在抛出

> 测试方法 ZooCms.Core.Tests.Model.ZooNodeTest.TestSetParentAddsNodeToParentNodeList 抛出异常：System.NullReferenceException：对象引用未设置为对象的实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T20:29:08.030

如果您想在其上定义期望，您的*Children*集合属性需要是虚拟的：

```
public abstract class ZooNode
{
    public ZooNode Parent { get; set; }
    public virtual IList<ZooNode> Children { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T01:35:55.447

机会，您从未真正初始化 Children 集合。所以，要么你需要在构造函数中初始化它，要么你可以告诉 Moq 默认模拟它。

```
var parent = new Mock<ZooNode>() { DefaultValue = DefaultValue.Mock }; 
```

# c# - J2ME 与 MS-SQL 通信

> ID：455803
> 
> 赞同：0
> 
> 时间：2009-01-18T20:11:31.750
> 
> 标签：c#, asp.net, sql-server-2005, web-services, java-me

我正在尝试创建一个集成项目，在该项目中我可以使用 J2ME 的应用程序更新 MS-SQL 的数据库值。

但我需要更多资源/链接，让我完全了解如何为此编写实现。

这些是我想到的几个问题。

1.  如何将我从 J2ME 获得的数据更新到 MSSQL 2005？
2.  如何从数据库中检索和查看更新的值？
3.  我如何向 J2ME 的应用程序发送短信，因为我的其他应用程序需要向 j2me 应用程序发送“警报”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T20:32:44.607

除了为 J2ME 编写自己的 ODBC 库之外，我建议您考虑在数据库上编写一个 Web 服务层，J2ME 应用程序可以通过 HTTP 与之通信。

# delphi - 可以在运行时创建一个 TClientDataSet 嵌套（一对多）数据集吗

> ID：455811
> 
> 赞同：1
> 
> 时间：2009-01-18T20:14:22.413
> 
> 标签：delphi

可以在运行时创建 TClientDataSet 嵌套（一对多）数据集吗？是否有任何代码显示如何执行此操作？

谢谢，

账单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T01:52:34.290

[Nesting DataSets in ClientDataSets](http://dn.codegear.com/article/29825) by Cary Jensen should answer your question. Also look for other articles on this site by Cary for more information on ClientDataSets.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T00:59:02.603

Creating a one-to-many relationship isn't all that difficult. It can be done at design-time or at runtime:

1.  Create the master dataset.
    *   Make sure it contains a primary key field.
    *   Create the detail dataset. Make sure it contains a foreign key field.
    *   Link the detail dataset to the master dataset as follows:
    *   Set the MasterSource property to the master dataset.
    *   Set the MasterField property to the primary key field of the master dataset.
    *   Set the IndexFieldNames property to the foreign key of the detail dataset.
    *   Done!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T20:26:08.803

你是什​​么意思？客户端数据集是单个表。但是您可以创建一个包含另一个客户端数据集（必须提取才能使用）的字段。

# delphi - 重构 TClient 数据集

> ID：455815
> 
> 赞同：3
> 
> 时间：2009-01-18T20:15:54.220
> 
> 标签：delphi, tclientdataset

可以在不丢失数据的情况下重组 TClientDataSet XML 文件吗？是否有任何演示应用程序或源代码显示如何进行这种重组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T21:47:23.957

yes and no, the xml doc is transformed using XLST so it needs to conform to that template to be able to be read by the TClientDataSet.

However that does also mean that you can also transform the doc to any format you like yourself into a separate doc, you just can't load the transformed doc directly into the TClientDataSet.

EDIT: Oops, forgot to post an example.

[This project](http://cc.codegear.com/Item/20313) on code central shows a transform from clientdataset to an ADO recordset.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-05T13:59:45.027

为了更改磁盘上的 CDS 结构，我使用了下面概述的子类。我们以二进制格式将数据写入流（在压缩/加密之前），但它对于 XML 格式的工作方式应该大致相同。

如果您需要从保存的数据集中添加/删除任何字段或更改字段定义，则只需增加数据集表版本。每次打开数据集时，它都会将保存的版本号与当前版本号进行比较。如果保存的表是旧的，它将被复制到新结构中，因此如果您需要进行更改，您将在第一次重新加载表时对性能造成影响，但之后它应该像往常一样从磁盘加载。

因此，如果您在合并后将 CDS 保存回磁盘 - 瞧 - 您的 XML 结构将更新为 CDS 友好格式。

```
TCDS = class(TCustomClientDataset)
private
 fTableVersion: integer;
 /// <summary> Copies records from source with potentially different table
 ///  structure/field defs from self, providing defaults for missing fields</summary>
 procedure CopyFromDataset(const ASource: TCustomClientDataset);
 /// <summary>Provide a default value, if necessary, for any new fields</summary>
 function GetDefaultValue(const AFieldName: string): variant;
public
 procedure LoadFromStream(AStream: TStream);
 procedure SaveToStream(AStream: TStream);
end;

procedure TCDS.LoadFromStream(AStream: TStream);
var
 ATemp: TCDS;
 APersistedVersion: integer;
begin
 AStream.ReadData(APersistedVersion);
 if APersistedVersion = fTableVersion then
 begin
  Close;
  ReadDataPacket(AStream, True);
  Open;
 end
 else if APersistedVersion < fTableVersion then
 begin
  // It's an old table structure:
  // - Load old structure into temp CDS
  // - Merge temp CDS records into new structure
  ATemp := TCDS.Create;
  try
   ATemp.Close;
   ATemp.ReadDataPacket(AStream, True);
   ATemp.Open;
   CopyFromDataset(ATemp);
  finally
   FreeAndNil(ATemp);
  end;
 end;
end;

procedure TCDS.SaveToStream(AStream: TStream);
begin
 AStream.WriteData(fVersionNumber);
 WriteDataPacket(AStream, True);
end;

procedure TCDS.CopyFromDataset(const ASource: TCustomClientDataset);
var
 ACurrentFieldNames: TStrings;
 i: integer;
begin
 // Assuming we don't want to keep any records already in dataset
 EmptyDataSet;
 ACurrentFieldNames := TStringList.Create;
 try
  Fields.GetFieldNames(ACurrentFieldNames);
  for i := 0 to ACurrentFieldNames.Count-1 do
   ACurrentFieldNames.Objects[i] := ASource.Fields.FindField(ACurrentFieldNames[i]);

  ASource.First;
  while not ASource.Eof do
  begin
   Append;
   for i := 0 to Fields.Count-1 do
   begin
    if Assigned(ACurrentFieldNames.Objects[i]) then
     Fields[i].Value := TField(ACurrentFieldNames.Objects[i]).Value
    else if Fields[i].Required then
     Fields[i].Value := GetDefaultValue(ACurrentFieldNames[i]);
    end;
    Post;
    ASource.Next;
   end;
 finally
  FreeAndNil(ACurrentFieldNames);
 end;
end; 
```

# delphi - 将二进制文件与 XML 与 TClientDataSet 一起使用有什么区别或优势？

> ID：455817
> 
> 赞同：4
> 
> 时间：2009-01-18T20:18:18.473
> 
> 标签：delphi

将二进制文件或 XML 文件与 TClientDataSet 一起使用是否有任何区别或优势。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-18T23:30:00.927

Binary will be smaller and faster.

XML will be more portable and human readable.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T21:42:23.313

The Binary file will be a little smaller.

The main advantage of the XML format is that you can pass it around via http(s) protocols.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T20:12:14.650

二进制更小更快，但只能由 TClientDataSets 读取。

XML 更大更慢（两者都不是那么糟糕，即不是更大或更慢的数量级）。XML 可以被人们（一般不推荐，但它*是*可行的）和软件读取。因此它更便携（正如尼克所写）。

TClientDataSets 可以加载和保存自己风格的 XML，或者您可以使用 Delphi XML Mapper 工具来读取和写入任何类型的 XML。

例如，XSLT 可用于将这些 XML 文件转换为任何类型的文本，包括其他 XML、HTML、CSV、固定列等。

与 Tim 所指出的相反，二进制和 XML 都可以通过 HTTP 和 HTTPS 传输。但是，发送 XML 通常会受到赞赏，因为它更容易跟踪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T07:40:37.567

未经测试：我猜二进制格式在读写时会快很多。不过，您最好为此做自己的基准测试。

二进制的另一个优点可能是，它不容易编辑，这可以防止人们在应用程序之外破坏数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T21:19:29.543

在使用 Delphi 2009 时，我们注意到如果文件具有 .XML 扩展名，则它不会以二进制格式保存现有的 dfXMLUTF8 格式，即使使用 LoadFromFile、SaveToFile 也是如此。将文件扩展名更改为其他内容（例如 .DAT）允许将文件保存在 dfBinary 中。我们的经验是，二进制文件除了对最终用户来说更难操作（一个加号！）外，比 dfXMLUTF8 格式文件小大约 50%。

# javascript - 轻量级回显服务器

> ID：455821
> 
> 赞同：-1
> 
> 时间：2009-01-18T20:24:56.433
> 
> 标签：javascript, file-upload

我正在编写一个 JavaScript 应用程序，它应该让用户在他/她的 PC 中加载和保存文件。为此，我需要一个基本服务器，仅用于在客户端和服务器之间回显加载和保存的文件，因为 JavaScript 无法直接访问文件。

这个问题最轻量级的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T20:52:23.413

这取决于您使用的服务器端语言。对于 PHP，[这个答案](https://stackoverflow.com/questions/198346/whats-the-best-way-to-create-a-single-file-upload-form-using-php#198459)很好地概述了上传部分所需的内容。

要下载文件，您只需要一个带有文件名并写入文件内容的页面（从上传文件时保存的任何路径获取文件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T20:52:35.630

这是您打算以某种方式安装在客户端 PC 上的服务器？我对这项技术并不十分熟悉，但听起来这正是浏览器极力阻止的那种能力——来自一个域的代码在另一个域上执行状态更改功能。

你能把数据保存在你的服务器上，然后自动传输文件吗？

或者，如果这是一个独立的 javascript 应用程序，您想在不使用网络的情况下在浏览器中运行，请查看 Adob​​e 的 Flash/Flex 以及 AIR 库；这是为了做你所说的。（注意：Actionscript 是 javascript 的严格超集。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T20:54:53.970

您是否正在寻找一个轻量级的网络服务器？在这种情况下，像[thttpd](http://acme.com/software/thttpd/)这样的东西是合适的。它非常容易编译，所需的配置很少。

另一个更灵活的选择是[twisted](http://twistedmatrix.com/trac/)，“一个用 Python 编写的事件驱动的网络引擎”。我想，你基本上可以相当可靠/稳健地按照这些思路编写任何东西。[本教程](http://twistedmatrix.com/projects/core/documentation/howto/servers.html)可能是一个好的开始。

与许多事情一样，最简单的解决方案通常是最好的。如果您可以将文件传输到“愚蠢的”辅助网络服务器，并将它们作为常规文件检索，那么它可能比在 Python 中实现自己的服务器解决方案要好/扭曲的（或类似的）

# iphone - 在 Objective-C 中实现委托模式

> ID：455822
> 
> 赞同：4
> 
> 时间：2009-01-18T20:25:15.123
> 
> 标签：iphone, objective-c, delegates

我正在构建一个处理 NSURLConnection 请求的类。为了允许其他类使用这个类，我想允许主类在触发 connectionDidFinishLoading 时调用委托。

我查看了很多文档，但找不到任何给出明确示例的内容，并且由于某种原因，我拥有的代码没有调用委托。我到目前为止的代码是（代码不相关已删除）：

界面：

```
@interface PDUrlHandler : NSObject {
id delegate;
}
- (void)searchForItemNamed:(NSString *)searchQuery;
@property (nonatomic, assign) id delegate;
@end
@interface NSObject (PDUrlHandlerDelegate) 
- (void)urlHandler:(PDUrlhandler*)urlHandler searchResultsFinishedLoading:(NSDictionary *)resultData;
@end 
```

执行：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    NSLog(@"Fininshed Loading...");
    resultData = [self parseJSON:jsonData];

    if(delegate && [delegate respondsToSelector:@selector(urlHandler:searchResultsFinishedLoading:)]) {
        NSLog(@"Delegating!");
        [delegate urlHandler:self searchResultsFinishedLoading:resultData];
    } else {
        NSLog(@"Not Delegating. I dont know why.");
    }   

} 
```

另一个类中的委托：

```
- (void)urlHandler:(PDUrlhandler*)urlHandler searchResultsFinishedLoading:(NSDictionary *)resultData;
{
    NSLog(@"Delegating!!!!");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T08:30:55.920

我的第一个想法是你可能没有设置委托，但你有。除此之外，代码看起来是正确的。看不出有什么不对。您是否尝试在检查代理是否响应选择器的位置放置断点？可能是委托值未保留而变为 nil。确保您的委托不是 nil 并且具有正确的对象。

您还确定连接是异步的吗？同步连接不会调用connectionDidFinishLoading方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T22:12:02.863

原来我忘了设置委托：

```
[currentHandler setDelegate:self]; 
```

需要在对 PDUrlHandler 进行初始调用的行之后进行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T23:05:57.773

对于有兴趣查看此示例的任何人，苹果示例应用程序 NSURLCache 在 NSURLCacheConnection.m 中围绕 NSURLConnection 实现了一个简单的委托

示例应用程序可通过此处的苹果开发人员连接获得：http: [//developer.apple.com/iphone/library/samplecode/URLCache/index.html](http://developer.apple.com/iphone/library/samplecode/URLCache/index.html)

我发现它非常有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T20:37:04.927

你在正确的轨道上，你实现委托模式的方式看起来不错。它没有被调用的原因是你在 respondsToSelector 中使用了错误的方法签名；你有`humidorServer:searchResultsFinishedLoading:`你真正想要的时候`urlHandler:searchResultsFinishedLoading:`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T21:46:12.213

可能是委托中方法名称末尾的分号（最右边的底部代码示例）？如果设置了委托并且正在调用 -connectionDidFinishLoading: 方法，那么我看不到任何错误

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T19:16:16.897

由于您使用“iphone”标记了它，我假设您正在开发 iPhone 应用程序并且不需要支持 OS X 10.5 之前的版本。在 Objective-C 2.0 中，Apple 建议您使用带有可选方法的正式协议（使用 @protocol）而不是非正式协议。以下是相关文字：

> 作为非正式的，在类别中声明的协议没有得到太多的语言支持。在编译时没有类型检查，也没有在运行时检查对象是否符合协议。要获得这些好处，您必须使用正式的协议。当所有方法都是可选的（例如对于委托）时，非正式协议可能很有用，但是（在 Mac OS X v10.5 及更高版本上）通常最好将正式协议与可选方法一起使用。

（[来源](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ObjectiveC/Articles/chapter_7_section_7.html#//apple_ref/doc/uid/TP30001163-CH15-TPXREF147)）

# asp.net - 我可以在 CAB WinForms 应用程序中托管 ASP.NET 应用程序吗？

> ID：455825
> 
> 赞同：2
> 
> 时间：2009-01-18T20:26:51.937
> 
> 标签：asp.net, winforms, cab, scsf

我有一个使用复合应用程序块和智能客户端软件工厂开发的 .NET 2.0 WinForms 应用程序。

我正在考虑开发一个包含浏览器控件的模块，该控件将使用用户登录 WinForms 客户端时建立的凭据访问 ASP.NET 网站。

我的目标是使用此策略将客户端中当前的所有模块转换为 ASP.NET 并停用“智能”客户端。WinForms 客户端的安全性当前是使用 ASP.NET Membership 功能实现的。

这可能吗？明智的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-24T20:38:40.520

是的你可以。制作一个承载 WebBrowser 控件的 SmartPart，添加一些用于向前和向后导航的按钮，以及一个 url 文本框；然后将 WebBrowser 控件指向您的 Web 应用程序的 URL。

这是明智的。我们使用 CAB/SCSF 创建了一个我们称为“集成桌面”的应用程序。该应用程序充当公司所有内部应用程序的平台；一切都集成到这个桌面应用程序中。我们添加了一个基础模块，基本上是我在上一段中描述的强大版本，以促进网页浏览，因为一些预先存在的应用程序是基于网络的，我们的用户希望在他们所做的所有事情的同一个地方访问那些其他工作。一件很酷的事情是使用 WebBrowser 的[ObjectForScripting](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.objectforscripting.aspx)属性，它允许在桌面应用程序和托管在其中的 Web 应用程序之间进行某种程度的无缝集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-31T03:31:48.697

你有什么要求？

您将主要选择 Web 应用程序而不是智能客户端

1.  如果您必须联系不在 Windows 平台上的人，或者
2.  你需要一个零安装的应用程序

通过让您的应用程序用户必须通过智能客户端（浏览器控制）访问 Web 应用程序，您将丢失 (1) 和 (2)。在我看来，它会破坏它的目的。

# android - Android：从相机获取文件名？

> ID：455830
> 
> 赞同：7
> 
> 时间：2009-01-18T20:30:58.323
> 
> 标签：android, file, camera

我遇到了一个我可能只是忽略的问题。

我想从相机的表面预览中拍一张照片，并将其保存到`sd_card`. 这几乎是完美的。我给它分配了一个文件名，但它不使用`filename`.

这就是我一直在尝试做的事情：

```
Button imagecapture = (Button) findViewById(R.id.imagecapture);
imagecapture.setOnClickListener(new View.OnClickListener() {
    public void onClick(View view) {
        String filename = null;
        ImageCaptureCallback iccb = null;

        try {
            filename = timeStampFormat.format(new Date());
            ContentValues values = new ContentValues();
            values.put(Media.TITLE, filename);
            values.put(Media.DESCRIPTION, "Image capture by camera");

            Uri uri = getContentResolver().insert(Media.EXTERNAL_CONTENT_URI, values);
            iccb = new ImageCaptureCallback(getContentResolver().openOutputStream(uri));
        } catch (Exception ex) {
            ex.printStackTrace();
            Log.e(getClass().getSimpleName(), ex.getMessage(), ex);
        }
        camera.takePicture(mShutterCallback, mPictureCallbackRaw, iccb);
        com.froogloid.android.gspot.Park.imageFileName = filename;
    }
}); 
```

它不会使用文件名（即我要求它使用的时间/日期戳。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T13:43:55.100

这是通过通过 ImageCaptureCallback 类实现 PictureCallback 并通过文件输出流覆盖正在写入文件的 onPictureTaken 来解决的。您所要做的就是将文件输出流更改为您想要的文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T13:01:10.653

它不保存图像？在我的应用程序中，此代码保存图像，也许您使用变量“filaname”从 sdcard 获取图像？使用来自 sdcard 的图像最好保存在变量中，例如，uri.toString 的“fileUri”值，最后从 sdcard 文件中获取 uri Uri.parse(fileUri)..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:25:57.850

希望这会有所帮助/可能不是最好的方法，但它确实有效。给你：
这是**相机捕捉图像回调**。

```
public class ImageCaptureCallback implements PictureCallback {

    private OutputStream filoutputStream;
    public ImageCaptureCallback(OutputStream filoutputStream) {
        this.filoutputStream = filoutputStream;
    }

    @Override
    public void onPictureTaken(byte[] data, Camera camera) {

        try {
            Log.v(getClass().getSimpleName(), "onPictureTaken=" + data + " length = " + data.length);
            FileOutputStream buf = new FileOutputStream("/sdcard/dcim/Camera/" + CameraActivity.filename + ".jpg");
            buf.write(data);
            buf.flush();
            buf.close();
            // filoutputStream.write(data);
            filoutputStream.flush();
            filoutputStream.close();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

# unix - Unix 中的信号是什么？

> ID：455842
> 
> 赞同：14
> 
> 时间：2009-01-18T20:39:23.457
> 
> 标签：unix, signals, operating-system

这个评论让我感到困惑：“kill -l 通常列出所有信号”。我认为信号意味着量化的能量。

**[已添加]**请澄清 Unix 中的（计算）信号和物理信号。它们是完全不同的概念吗？

**[添加]**范式之间是否存在重大差异？在 C、Python 和 Haskell 等语言中的含义是否相同？信号似乎是一个通用术语。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-18T20:44:42.087

该手册是指一种非常基本的机制，它允许进程或操作系统通过发送信号来通知其他进程。操作系统可以使用它来通知程序关于它们的中止（信号`SIGABRT`）或分段错误（通常由访问空指针引起`SIGSEGV`），举出其中两个。

一些 unix 服务器使用信号，因此管理员可以使用`kill`向它们发送信号，导致它们重新读取其配置文件，而无需重新启动它们。

对某些信号采取了默认操作，而其他信号则被忽略。例如，在接收 a`SIGSEGV`时，程序终止，而在接收 a`SIGCHLD`时，意味着子进程死亡，默认情况下不会产生什么特别的结果。

有一个 ANSI C 标准函数，它安装了一个信号处理程序，它是一个在接收到信号时可以执行一些代码的函数，称为`signal`(read in `man signal`)。在不同的 unix 中，该函数的行为不同，因此不鼓励使用它。它的手册页引用了`sigaction`函数（read `man sigaction`），它的行为一致，也更强大。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-08-28T16:56:09.633

我不敢相信人们在某些时候没有比较*硬件和软件*或强调*操作系统*。

**信号与中断的比较**：

> 不同之处在于，中断是**由硬件发送给操作系统的**，而信号是**由操作系统**或其他进程发送给进程的。*请注意，信号与软件中断无关，软件中断仍由硬件*（在本例中为 CPU 本身）发送。[（来源）](http://users.actcom.co.il/~choo/lupg/tutorials/signals/signals-programming.html)

**定义**

1.  进程=正在执行的程序，根据下面的书

**进一步阅读**

1.  将信号与[中断和异常进行比较](https://stackoverflow.com/questions/125394/interrupts-and-exceptions)

2.  Tanenbaum 的《现代操作系统》一书

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-18T21:58:29.817

物理信号和 Unix 信号确实是不同的概念。当一个 Unix 信号从一个进程发送到另一个进程时，没有特定的对应物理信号。Unix 信号只是一种抽象，因此程序员可以谈论进程之间的通信。

Unix 信号可以被称为消息、事件、通知，甚至是像“frobs”这样的虚构术语。设计师只是选择了“信号”这个名字，然后就卡住了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-18T20:43:00.017

信号是给目标进程或给操作系统的关于目标进程的消息。它是 unix API 的一部分（并在各种 POSIX 标准中定义）。

阅读`man kill`、`man signal`和`man sigaction`。

其他可能有用的 SO 问题：

*   [sigaction 和 signal 有什么区别？](https://stackoverflow.com/questions/231912/what-is-the-difference-between-sigaction-and-signal)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-18T20:57:57.770

**我的一些笔记：**

允许异步通信

*   属于同一用户的进程之间
*   从系统到任何进程
*   从系统管理员到任何进程
*   所有相关信息都在信号本身中
*   许多不同的信号

信号情报

*   从系统到与终端关联的所有进程
*   触发器：按下 ^C
*   停止正在运行的进程的常用方法

SIGFPE

*   从内核到单个进程
*   触发器：浮点运算错误

杀戮

*   到单个进程
*   停止目标进程的执行

SIGALRM

*   从内核到单个进程
*   触发器：定时器到期

SIGTERM

*   到单个进程
*   建议进程优雅终止

SIGUSR1、SIGUSR2

*   从任何过程到任何其他
*   没有预定义的语义
*   程序员可以自由使用

向另一个进程发送信号

*   int kill(pid, signal_ID)

程序员可以决定收到信号时要做什么

*   使用默认行为
*   忽略它
*   执行用户函数

检测中断的写入

```
if (write(fd, buff, SIZE)<0) {
  switch (errno) {
   case EINTR:
    warning(“Interrupted write\n”);
    break;
  }
}… 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-18T20:44:18.530

信号是可以发送到正在运行的进程的消息。

例如，要告诉 Internet 守护程序 (inetd) 重新读取其配置文件，它应该发送一个 SIGHUP 信号。

例如，如果 inetd 的当前进程 ID (PID) 是 1234，您可以键入：kill -SIGHUP 1234

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-18T20:41:23.560

信号是“在计算过程之间传输的事件、消息或数据结构”（来自[Wikipedia](http://en.wikipedia.org/wiki/Signal_(computing))）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-18T20:42:39.643

在这种情况下，信号意味着“消息”。因此，它向一个进程发送一条消息，该消息可以告诉该进程做各种事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T20:59:46.863

unix 信号是一种可以在 unix 进程之间发送和发送的消息。他们可以做一些事情，比如告诉一个进程退出（SIGKILL），或者一个进程有一个无效的内存引用（SIGSEGV），或者这个进程被用户点击 control-c（SIGINT）杀死。

从 *nix 命令行输入：

> 人信号

这将你所有可用的信号。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-26T11:19:05.010

信号基本上是一个中断，它告诉进程某个特定事件已经发生。

信号一般由内核发送，同时一个进程也可以使用 kill 和 killall 命令将信号发送给其他进程（取决于权限和 all ），进程可以使用 raise 向自己发送信号。

信号的主要用途：

1.  处理中断。

2.  进程同步。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-04T04:58:32.533

1.  信号是一个中断，用于提示某个进程已经发生了特定事件。

2.  信号可以由内核发送到正在运行的进程或一个进程到另一个进程。

3.  在 bash 中使用 kill 和 killall 命令发送信号。

# c# - 为什么 Rhino.Mocks 和 Moq 说 Bar 是不可覆盖的成员？

> ID：455853
> 
> 赞同：1
> 
> 时间：2009-01-18T20:45:42.507
> 
> 标签：c#, methods, rhino-mocks, moq, virtual

有人可以解释为什么使用最新版本的 Moq 和 Rhino.Mocks 框架的测试都失败了，抱怨 Bar 不是虚拟/可覆盖的方法：

```
public interface IFoo
{
    string Bar();
}

public class Foo : IFoo
{
    public string Bar()
    {
        return "Bar";
    }
}

[TestMethod]
public void MoqTest()
{
    var foo = new Mock<Foo>();
    foo.Setup(f => f.Bar()).Returns("abc");
    Assert.AreEqual("abc", foo.Object.Bar());
}

[TestMethod]
public void RhinoTest()
{
    var foo = new MockRepository().PartialMock<Foo>();
    foo.Expect(f => f.Bar()).Return("abc");
    foo.Replay();
    Assert.AreEqual("abc", foo.Bar());
} 
```

如果我将 Bar 方法声明为虚拟，则两个测试都会通过。我不明白为什么我必须将 Bar 声明为虚拟的。不是已经是虚拟的了吗？它来自界面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T20:59:06.020

虚拟是类的一部分而不是接口，因此如果您希望覆盖类 Foo 上的方法，您需要将其声明为虚拟。

但是，正如 Krzysztof 提到的，如果您只需要接口 IFoo 上的方法，那么您应该模拟接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T20:54:13.457

因为你在嘲笑 Foo 类。改为模拟 IFoo 接口

```
var foo = new MockRepository().PartialMock<IFoo>(); 
```

# php - Ajax：从“灯箱”窗口部分刷新父页面（更新 div）

> ID：455856
> 
> 赞同：0
> 
> 时间：2009-01-18T20:46:43.597
> 
> 标签：php, mysql, ajax, lightbox, prototypejs

有没有办法从弹出/“灯箱”窗口更新父页面的 div 中的信息。我想创建一个弹出窗口，其中包含一个更新数据库的表单（目前我正在使用带有原型的 php/mysql）。

换句话说......我希望用户能够在弹出窗口中使用表单来更新数据库，并且在不刷新父页面的情况下在父页面上显示所做的更改。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-18T21:56:56.280

呃..你确定你知道你在这里做什么？

您的“模态”弹出窗口从未离开过“父”页面。因此，您可以从您知道 ID 的表单请求中更新任何 DIV，关闭灯箱和 vwalla。

我自己是一个 mootools 人，但由于原型有点相同，我猜它是这样的：

```
<form onsubmit="$(this).send({update: 'yourParentDiv', onComplete: function() { lightBox.close() } })"> 
```

# asp.net - 在哪里可以找到用于 sqlserver 模式会话的 state.sql？

> ID：455874
> 
> 赞同：1
> 
> 时间：2009-01-18T20:55:00.320
> 
> 标签：asp.net

我正在寻找 .NET 框架提供的 state.sql 文件以在 sqlserver 模式下运行 sessionstates。我在哪里可以找到创建所需表和存储过程的 sql 文件。我在 FRAMEWORKS/VERSION2.0 文件夹中尝试过，但找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-12T23:21:31.850

不再`state.sql`是，而是`InstallSqlState.sql`或`InstallPersistSqlSate.sql`。

如果您`InstallSqlState.sql`想将会话数据存储到 tempdb 中（从而在每次 SQL Server 重新启动时丢失所有会话），请选择 。或者选择`InstallPersistSqlState.sql`是否要永久存储它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T20:58:53.603

本文[对这](http://www.dbazine.com/sql/sql-articles/cook9)两种模式（临时数据库和持久数据库）进行了很好的概述，并且脚本也从那里链接到...

# c# - 如何使用反射确定基类的泛型参数

> ID：455880
> 
> 赞同：1
> 
> 时间：2009-01-18T20:59:04.930
> 
> 标签：c#, generics, reflection

我有以下结构

```
public class MyClass : MyBaseClass<System.Int32>
{
} 
```

在静态方法中并且没有实例化新的 MyClass 实例，我如何获得用于构建具体基类的泛型参数的类型？例如在上面的例子 System.Int32

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T21:07:25.020

试试这个

```
public static Type GetBaseTypeGenericArgument(Type type) {
  return type.BaseType.GetGenericArguments()[0];
}

...
GetBaseTypeGenericArgument(typeof(MyClass)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T21:06:40.467

```
Type arg = typeof(MyClass).BaseType.GetGenericArguments()[0]; 
```

# c# - 避免贫血模型和允许序列化之间的冲突

> ID：455884
> 
> 赞同：1
> 
> 时间：2009-01-18T21:00:20.120
> 
> 标签：c#, json, serialization

在[这个](https://stackoverflow.com/questions/452517/does-this-entity-repository-service-example-fit-into-domain-driven-design#452564)对[最近一个问题](https://stackoverflow.com/questions/452517)的回答中，有人建议我

> “小心让你的域模型中的每个属性都有公共的 getter 和 setter。这可能会导致你的域模型贫乏。”

但是，然后我遇到了具有私有设置器的实体的问题，如下所示：

```
公开课短语
{
    公共 int PhraseId { 获取；私人套装；}
    公共字符串 PhraseText { 获取；私人套装；}
}

```

不能从视图到控制器的 JSON 序列化（使用 ASP.NET MVC）。这是由于私人二传手。

您将如何允许使用私有设置器进行序列化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T22:33:00.560

您始终可以覆盖序列化或只编写自己的 JSON 反序列化方法。我个人认为不值得努力。只需将设置器公开并完成即可。什么是私人的二传手真的在买你？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T22:45:40.907

我不知道你是否可以用 MVC 覆盖反序列化过程，但请注意`DataContractSerializer`支持非公共访问器，并且有一个 JSON 版本：[`DataContractJsonSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)- 也许值得一看？

不过，就个人而言，在这种情况下，我只会接受公共设置器……这是 .NET DTO 和基于 .NET 的序列化的一个非常常见的特性。不可变/工厂模式虽然在 java 中很常见，但在 .NET 中并没有真正占据太多。我不能说我过分介意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T03:00:53.043

我是这个问题中引用的人。您可能会注意到我从未建议您使用私人二传手。我只是说，如果您能提供帮助，请不要将其中的每一个都公开。

在您的情况下，我倾向于将它们设为包私有或内部，并将执行序列化的类/将它们保存到后端/为您的 UI 构建 DTO/在同一个包或程序集中的任何内容。

不让每个私有成员都可以公开获取和设置的原因是一个耦合问题，它完全是实用的。您的域模型需要与域概念耦合。如果这些概念是由 getter 体现的，那么就使用它们。

将它们全部公开会使您将域对象与可能在域之外更改的对象的私有部分耦合。它还鼓励其他人提取此类信息，根据该数据做出决策并设置值，这是您正确关注的领域贫血症。

# openid - ID选择器的替代品？

> ID：455887
> 
> 赞同：3
> 
> 时间：2009-01-18T21:04:09.147
> 
> 标签：openid

任何人都知道 ID Selector 的一个很好的替代品，因为它现在是 RPX，至少对我来说，不是很好吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T22:05:55.700

查看[Open-selector](http://open-selector.com/)。它是作为 ID 选择器的替代品而创建的。

从文档中：

> Open-selector 是一段 Javascript 代码，它将获取您现有的 OpenID 登录文本框并将其更改为 Provider 选择列表，用户可以用他们的用户名进行补充以构建他们的 OpenID URL。

您可以完全控制 Open-selector，包括将您自己的提供者添加到列表中的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T00:27:22.503

我是 Open-selector 的开发者 :)

当我第一次制作它时，它在任何 IE 上都不起作用（因此是谷歌代码问题），我只是在 IE6 和 7 上进行了测试，它似乎可以正常工作！（当前结帐）。虽然我正在寻找其他人来证实这一点。

open-selector.com 网站上的样式可能看起来很笨拙，但这只是我笨拙的 CSS，Open-selector 不提供样式，因此您可以根据需要使用 CSS 更改对齐和位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-21T13:23:24.050

您可以使用 GIGYA 作为 RPX 的替代品。这是链接：[http ://www.gigya.com](http://www.gigya.com)

# blackberry - UDP Send Error on BlackBerry

> ID：455895
> 
> 赞同：1
> 
> 时间：2009-01-18T21:11:49.880
> 
> 标签：blackberry, java-me, udp, cldc

I am writing network application for Blackberry. This code is correct on the simulator but not working on a device. When I run my application on the simulator, my server recieves the message but when I run it on a device, I get an Exception, `not IOException`, with message "`NULL`".

```
try {
     byte[] b = msg.getBytes();
     dc = (UDPDatagramConnection)Connector.open("datagram://"+getHIP()+":" + getHPort());
     Datagram dobject = dc.newDatagram(b, b.length);
     dc.send(dobject);
     System.out.println("Addr:" + dobject.getAddress());
     System.out.println("Well Done!");
} catch (IOException e) {
    System.out.println(e.getMessage());
} catch (Exception e) {
    System.out.println(e.getMessage());
} finally { 
    if (dc != null) {
        try {
            dc.close();
        } catch (Exception f) {
            System.out.println("Failed to close Connector: " + f);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T18:30:46.257

从开发人员的角度来看，黑莓上的网络访问远非无缝。您必须在 URL 中指定应如何建立连接，或者设备必须在选项 > 高级选项 > TCP 设置中具有正确的 APN 设置。您可以尝试找到这些并输入它们以查看它是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T16:15:52.723

UDP 要求 APN 设置在`Connector.open()`：

```
(DatagramConnection) Connector.open("udp://<host>:<dest_port>[;<src_port>]/<apn>[|<type>][;tunnelauthusername=<apn username>;tunnelauthpassword=<apn password>]"); 
```

有关这方面的更多信息，请查看[连接器](http://www.blackberry.com/developers/docs/4.7.0api/javax/microedition/io/Connector.html)

它在没有 APN 的模拟器上运行良好，因为模拟器没有 APN，但您需要在真实设备上。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-18T22:07:33.277

我能想到两种可能：

1.  UDP`optional`在[J2ME 规范](http://developers.sun.com/mobility/midp/articles/midp2network/)中——所以也许黑莓不支持它。
2.  设备所在的网络可能不支持，设备可以检测到，并报异常。

# sharepoint - Moving SharePoint MOSS Install

> ID：455898
> 
> 赞同：0
> 
> 时间：2009-01-18T21:12:57.507
> 
> 标签：sharepoint, moss

I have a sharepoint MOSS 2007 Install on a server and need to move it to another new server. Can I just ghost the complete server to the new one or do I need to install and configure the complete server again?

Any suggestions appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T04:16:54.437

您最好的选择是在新机器上进行全新安装。这使您可以自由地正确配置您的机器 - 命名数据库、为 Central Admin 选择端口、SSP 等。

抵制“升级”到更新操作系统（2003 至 2008）、新数据库（2000 - 2005 - 2008）或添加服务包或基础架构更新的诱惑。如果它没有安装在当前的生产系统上 - 那么不要将它安装在你的新机器上。为你所拥有的东西做一面镜子，它会变得更顺畅。

一旦按照您想要的方式配置了新服务器 - 只需从旧机器上的 Central Admin 页面进行完整备份 - 并从新机器上的 Central Admin 运行恢复。这将获取您在旧站点上的所有自定义项等。

一旦它恢复 - 并且您已经对其进行了测试并且它以您期望的方式工作，请从新服务器上的 Central Admin 页面运行完整备份。这将成为您前进的基准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T09:01:23.037

据我所知，您必须在新服务器上重新安装 MOSS，因为在配置过程中，实际服务器的许多设置都存储到 MOSS 配置数据库中。所以仅仅移动MOSS软件和数据库是行不通的。即使只是重命名运行 MOSS 的服务器也可能会导致 MOSS 错误。

为了便于将来将 MOSS 移动到另一台服务器，您应该考虑可视化。通过这种方式，您只需安装可视化软件并将虚拟机移动到新的主机服务器即可将服务器移动到您想要的每台服务器。当 MOSS 服务器因硬件错误而崩溃时，此策略也会在紧急情况下为您提供帮助。

# html - 是否有从 PDF 生成 HTML 表单的应用程序？

> ID：455901
> 
> 赞同：1
> 
> 时间：2009-01-18T21:14:04.993
> 
> 标签：html, forms, pdf, field, auto-generate

是否有从 PDF 文件生成 HTML 表单的应用程序？此外，它还需要生成 HTML 表单，以便能够提交到 PDF 以填写 PDF 中的字段。

PDF 不太擅长验证，它只是一个 kluge 界面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T21:27:03.517

不确定您的全部要求，但[docudesk](http://www.docudesk.com/deskUNPDF_Professional_PDF-to-Word-Converter_2.shtml?gclid=CLv21oqHmZgCFRwDagoddmh2Aw)和其他一些转换一样。

Adobe 也有一个在线转换[工具](http://www.adobe.com/products/acrobat/access_onlinetools.html)可以做到这一点。

# c++ - 以“测试模式”打印信息，但不以“正常执行”打印信息

> ID：455904
> 
> 赞同：6
> 
> 时间：2009-01-18T21:18:00.553
> 
> 标签：c++, testing, printing

我在 c++ 中使用一个应用程序，它使用一个特殊的 dprintf 函数来打印信息，这是一个例子：

```
dprintf(verbose, "The value is: %d", i); 
```

所做的是当我为测试目的定义详细信息时，然后我打印信息，当我在正常执行中工作时，我没有定义它并且我没有在屏幕上看到无用的信息。我的问题是如何实现该功能或实现相同的想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-19T00:12:25.443

我尽量避免使用 var-arg c 风格的函数，主要有两个原因：

*   它们不是类型安全的，不能使用 operator<<
*   他们无法识别何时提供的论点太少或太多

我制作了一种使用 的方法`boost::fusion`，它以类型安全的方式给出参数。它遍历这些参数，在`%`遇到 a 时将它们打印出来。如果给定的参数太少或太多，则会引发异常。

还有一个问题：可变参数宏在 C++ 中还不是标准的。所以，我做了两个版本。适用于当前 C++ 的一种。您必须使用它来调用它

```
dprintf("name: %, value: %\n", ("foo", 42)); 
```

然后。另一个版本，使用可变参数宏，可以通过定义一个预处理器符号来使用，它使您能够编写

```
dprintf("name: %, value: %\n", "foo", 42); 
```

这是代码。提供[`boost.fusion`](http://www.boost.org/doc/libs/1_37_0/libs/fusion/doc/html/index.html)了更多详细信息：

```
#include <boost/fusion/include/sequence.hpp>
#include <boost/fusion/include/make_vector.hpp>
#include <boost/fusion/include/next.hpp>
#include <stdexcept>
#include <iostream>

template<typename IterS, typename IterSeqE>
void print_vec(IterS b, IterS e, IterSeqE, IterSeqE) {
    while(b != e) {
        if(*b == '%') {
            if(++b != e && *b == '%') {
                std::cout << '%';
            } else {
                throw std::invalid_argument("too many '%'");
            }
        } else {
            std::cout << *b;
        }
        ++b;
    }
}

template<typename IterS, typename IterSeqB, typename IterSeqE>
void print_vec(IterS b, IterS e, IterSeqB seqb, IterSeqE seqe) {
    while(b != e) {
        if(*b == '%') {
            if(++b != e && *b == '%') {
                std::cout << '%';
            } else {
                std::cout << *seqb;
                return print_vec(b, e, next(seqb), seqe);
            }
        } else {
            std::cout << *b;
        }
        ++b;
    }
    throw std::invalid_argument("too few '%'");
}

template<typename Seq>
void print_vec(std::string const& msg, Seq const& seq) {
    print_vec(msg.begin(), msg.end(), begin(seq), end(seq));
}

#ifdef USE_VARIADIC_MACRO
#  ifdef DEBUG
#    define dprintf(format, ...) \
         print_vec(format, boost::fusion::make_vector(__VA_ARGS__))
#  else 
#    define dprintf(format, ...)
#  endif
#else
#  ifdef DEBUG
#    define dprintf(format, args) \
         print_vec(format, boost::fusion::make_vector args)
#  else 
#    define dprintf(format, args)
#  endif
#endif

// test, using the compatible version. 
int main() {
    dprintf("hello %, i'm % years old\n", ("litb", 22));
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-18T21:23:44.847

```
#ifdef DEBUG
#define dprintf(format, ...) real_dprintf(format, __VA_ARGS__)
#else
#define dprintf
#endif 
```

这里 real_dprintf() 是被调用的“真实”函数，而 dprintf() 只是一个包装调用的宏。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-18T21:33:29.603

预处理器解决方案可以工作，但必须重建以从一个更改为另一个可能会很烦人。我经常会在运行时做出决定。我首先声明：

```
static void do_nothing(const char *fmt, ...) { (void)fmt; }
extern void real_dprintf(const char *fmt, ...);
void (*dprintf)(const char *fmt, ...) = do_nothing; 
```

然后在初始化代码中我有

```
if (getenv("APPLICATION") && strstr(getenv("APPLICATION"), "dprintf"))
    dprintf = real_dprintf; 
```

这样，我可以通过更改环境变量的值来快速更改模式。

# php - __construct 函数是做什么用的？

> ID：455910
> 
> 赞同：208
> 
> 时间：2009-01-18T21:19:58.833
> 
> 标签：php, constructor

我在`__construct`课堂上注意到了很多。我做了一些阅读和网上冲浪，但找不到我能理解的解释。我只是从 OOP 开始。

我想知道是否有人可以让我大致了解它是什么，然后举一个简单的例子来说明它是如何与 PHP 一起使用的？

* * *

## 回答 #1

> 赞同：307
> 
> 时间：2009-01-18T21:28:26.507

`__construct`是在 PHP5 中引入的，它是定义您的构造函数的正确方法（在 PHP4 中，您使用类的名称作为构造函数）。您不需要在类中定义构造函数，但如果您希望在对象构造中传递任何参数，那么您需要一个。

一个例子可能是这样的：

```
class Database {
  protected $userName;
  protected $password;
  protected $dbName;

  public function __construct ( $UserName, $Password, $DbName ) {
    $this->userName = $UserName;
    $this->password = $Password;
    $this->dbName = $DbName;
  }
}

// and you would use this as:
$db = new Database ( 'user_name', 'password', 'database_name' ); 
```

PHP 手册中解释了其他所有内容：[单击此处](http://php.net/manual/en/language.oop5.decon.php)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-01-18T22:08:03.120

`__construct()`是[构造函数](http://si2.php.net/manual/en/language.oop5.decon.php)的方法名。构造函数在对象创建后被调用，是放置初始化代码等的好地方。

```
class Person {

    public function __construct() {
        // Code called for each new Person we create
    }

}

$person = new Person(); 
```

构造函数可以以正常方式接受参数，这些参数在创建对象时传递，例如

```
class Person {

    public $name = '';

    public function __construct( $name ) {
        $this->name = $name;
    }

}

$person = new Person( "Joe" );
echo $person->name; 
```

与其他一些语言（例如Java）不同，PHP 不支持重载构造函数（即，具有多个接受不同参数的构造函数）。您可以使用静态方法来实现此效果。

**注意**：我是从（在撰写本文时）接受的答案的日志中检索到的。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-18T21:27:57.007

它是另一种声明构造函数的方式。您还可以使用类名，例如：

```
class Cat
{
    function Cat()
    {
        echo 'meow';
    }
} 
```

和

```
class Cat
{
    function __construct()
    {
        echo 'meow';
    }
} 
```

是等价的。每当创建类的新实例时都会调用它们，在这种情况下，将使用以下行调用它们：

```
$cat = new Cat(); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-05-22T16:51:19.590

我认为这对于理解构造函数的目的很重要。
即使在阅读了这里的回复之后，我也花了几分钟才意识到这就是原因。
我已经养成了对所有启动或发生的事情进行显式编码的习惯。换句话说，这将是我的猫类以及我将如何称呼它。

**class_cat.php**

```
class cat {
    function speak() {
        return "meow";  
    }
} 
```

**某页.php**

```
include('class_cat.php');
mycat = new cat;
$speak = cat->speak();
echo $speak; 
```

在@Logan Serman 给出的“类猫”示例中，假设每次创建类“猫”的新对象时，您希望猫“喵喵”而不是等待您调用函数使其喵喵叫。

通过这种方式，我的脑海中明确地思考了构造函数方法在哪里使用隐式，这使得一开始很难理解。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-08-24T17:00:46.693

构造函数是在类实例化时自动调用的方法。这意味着在没有单独的方法调用的情况下处理构造函数的内容。类关键字括号的内容被传递给构造函数方法。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2016-08-10T19:34:07.477

该`__construct`方法用于在您*第一次*创建对象时传入参数——这称为“定义构造方法”，是一种常见的做法。

但是，构造函数是**可选**的——因此，如果您不想在对象构造时传递任何参数，则不需要它。

所以：

```
// Create a new class, and include a __construct method
class Task {

    public $title;
    public $description;

    public function __construct($title, $description){
        $this->title = $title;
        $this->description = $description;
    }
}

// Create a new object, passing in a $title and $description
$task = new Task('Learn OOP','This is a description');

// Try it and see
var_dump($task->title, $task->description); 
```

有关什么是构造函数的更多详细信息，请参阅[手册](http://php.net/manual/en/language.oop5.decon.php)。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2016-05-03T13:34:17.233

我希望这个帮助：

```
<?php
    // The code below creates the class
    class Person {
        // Creating some properties (variables tied to an object)
        public $isAlive = true;
        public $firstname;
        public $lastname;
        public $age;

        // Assigning the values
        public function __construct($firstname, $lastname, $age) {
          $this->firstname = $firstname;
          $this->lastname = $lastname;
          $this->age = $age;
        }

        // Creating a method (function tied to an object)
        public function greet() {
          return "Hello, my name is " . $this->firstname . " " . $this->lastname . ". Nice to meet you! :-)";
        }
      }

    // Creating a new person called "boring 12345", who is 12345 years old ;-)
    $me = new Person('boring', '12345', 12345);

    // Printing out, what the greet method returns
    echo $me->greet(); 
    ?> 
```

欲了解更多信息，您需要访问[codecademy.com](https://www.codecademy.com/tracks/php)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-04-09T19:42:16.407

```
class Person{
 private $fname;
 private $lname;

 public function __construct($fname,$lname){
  $this->fname = $fname;
  $this->lname = $lname;
 }
}
$objPerson1 = new Person('john','smith'); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-02-07T10:38:58.320

__construct 总是在创建新对象时调用，或者在初始化时调用它们。它适用于对象在使用之前可能需要的任何初始化。__construct 方法是类中执行的第一个方法。

```
 class Test
    {
      function __construct($value1,$value2)
      {
         echo "Inside Construct";
         echo $this->value1;
         echo $this->value2;
      }
    }

//
  $testObject  =  new Test('abc','123'); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-04-12T21:25:37.690

我相信 function`__construct () {...}`是一段代码，可以一次又一次地重复使用来代替`TheActualFunctionName () {...}`. 如果您更改类名称，则不必在代码中进行更改，因为通用 __construct 始终引用实际的类名称......不管它是什么。你编码更少......或者？

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-10-29T19:29:46.260

__construct 是一种在使用新对象之前对其进行初始化的方法。
[http://php.net/manual/en/language.oop5.decon.php#object.construct](http://php.net/manual/en/language.oop5.decon.php#object.construct)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-11-18T09:34:45.827

注意：如果子类定义了构造函数，则不会隐式调用父构造函数。为了运行父构造函数，需要`parent::__construct()`在子构造函数中调用。如果子类没有定义构造函数，那么它可以像普通类方法一样从父类继承（如果它没有声明为私有）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-06-19T23:31:54.490

__construct 只是启动一个类。假设您有以下代码；

```
Class Person { 

 function __construct() {
   echo 'Hello';
  }

}

$person = new Person();

//the result 'Hello' will be shown. 
```

我们没有创建另一个函数来回显“Hello”这个词。它只是表明关键字 __construct 在初始化类或对象时非常有用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-11-02T05:15:31.997

构造函数允许您在创建对象时初始化对象的属性。

如果你创建了一个 __construct() 函数，当你从一个类创建一个对象时，PHP 会自动调用这个函数。

[https://www.w3schools.com/php/php_oop_constructor.asp](https://www.w3schools.com/php/php_oop_constructor.asp)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-06T14:20:39.500

让我先解释一下`__construct()`，而不先使用该方法……要知道的一点`__construct()`是它是一个内置函数，那么让我在 PHP 中将其称为方法。就像我们`print_r()`在程序上一样，它`__construct()`是面向 OOP 的内置。

话虽如此，让我们探讨一下为什么应该使用这个名为`__construct()`.

```
 /*=======Class without __construct()========*/
  class ThaddLawItSolution
   {
      public $description;
      public $url;
      public $ourServices;

      /*===Let us initialize a value to our property via the method set_name()==== */
     public function setName($anything,$anythingYouChoose,$anythingAgainYouChoose)
     {
      $this->description=$anything;
      $this->url=$anythingYouChoose;
      $this->ourServices=$anythingAgainYouChoose;
    }
    /*===Let us now display it on our browser peacefully without stress===*/
    public function displayOnBrowser()
    {
       echo "$this->description is a technological company in Nigeria and our domain name is actually $this->url.Please contact us today for our services:$this->ourServices";
    }

 }

         //Creating an object of the class ThaddLawItSolution
$project=new ThaddLawItSolution;
        //=======Assigning Values to those properties via the method created====//
$project->setName("Thaddlaw IT Solution", "https://www.thaddlaw.com", "Please view our website");
      //===========Let us now display it on the browser=======
$project->displayOnBrowser(); 
```

`__construct()`让您的生活变得非常轻松，想象我通过该方法为这些属性分配值所花费的时间。从上面的代码中，我首先创建了一个对象，然后将值分配给第二个属性，最后在浏览器上显示它。但是`__construct()`在创建对象时使用，即`$project= new ThaddLawItSolution;`您将在创建对象时立即为该方法分配值，即

```
$project=new ThaddLawItSolution("Thaddlaw IT Solution", "https://www.thaddlaw.com","Please view our website"); 
```

//===让我们现在使用 __constructor=====

只需删除调用`setName`并放置的方法，`__construct();`然后在创建对象时立即分配值。这就是整个`__construct()`方法背后的要点。但请注意，这是一个内置的方法或函数

# perl - 确保只有一个 Perl 程序实例在运行的最佳方法是什么？

> ID：455911
> 
> 赞同：25
> 
> 时间：2009-01-18T21:19:59.113
> 
> 标签：perl, process, mutual-exclusion

有几种方法可以做到这一点，但我不确定哪一种是最好的。

这是我能想到的：

*   使用 pgrep 查找进程。
*   使用flock 让脚本自己锁定，然后在每次运行时检查它是否被锁定。
*   在 /var/run/program_name.pid 中创建一个 pid 文件并检查是否存在，并在需要时比较 pid。

可能有更多方法可以做到这一点。你认为最好的方法是什么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-18T21:49:16.357

有很多方法可以做到这一点。PID 文件是执行此操作的传统方式。您还可以锁定文件，例如程序本身。这段小代码就可以解决问题：

```
use Fcntl ':flock';
open my $self, '<', $0 or die "Couldn't open self: $!";
flock $self, LOCK_EX | LOCK_NB or die "This script is already running"; 
```

与 PID 文件相比，一个优点是程序退出时文件会自动解锁。以可靠的方式实施要容易得多。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-18T21:26:23.347

做旧的 PID 文件技巧。

*   启动过程
*   查看是否有一个名为“myprog.PID”的文件
*   检查是否存在正在运行的 proc。使用 kill 0, $pid 匹配 PID
*   如果 PID proc 的 prog 名称。比赛，大声抱怨并退出
*   如果没有，清理陈旧的“myprog.PID”
*   创建一个名为“myprog.PID”的文件，然后继续

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T22:02:35.987

您列出的所有选项都很好。不过，其中一件事是要注意，在极少数情况下，您最终可能会得到一个运行很长时间的进程（即，等待某事）。您可能需要考虑关注其他正在运行的实例已经运行了多长时间，如果超过一定时间（例如可能是一天），可能会向自己发送警报。

# c# - ... inside a repeater control code not showing up in the source code on page render

> ID：455912
> 
> 赞同：2
> 
> 时间：2009-01-18T21:20:19.520
> 
> 标签：c#, asp.net, javascript, repeater

I have a repeater control where the `<%#DataBinder.Eval(Container.DataItem, "Display")%>` part doesn't show up. The code that the "Display" stores is set as follows:

```
item.Display = "<script type='text/javascript'>
    AudioPlayer.embed('ffcedea7-4822-465f-85b6-89924f7b81fa',
    {soundFile: 'http://s3.amazonaws.com/blah/af8g7fd3-1793-4b5e-92b7-9d11ad1cc19c.mp3'});
</script>"; 
```

After the page load, the audio embed file doesn't show up. The code doesn't even show up in the source. If I add a random string after the ending script tag, that random string will show up.

```
item.Display = "<script type='text/javascript'>
    AudioPlayer.embed('ffcedea7-4822-465f-85b6-89924f7b81fa',
    {soundFile: 'http://s3.amazonaws.com/blah/af8g7fd3-1793-4b5e-92b7-9d11ad1cc19c.mp3'});
</script> THIS IS THE RANDOM STRING"; 
```

So, on the page source it will have " THIS IS THE RANDOM STRING" but not the script part.

Does anyone know what is causing this issue and how it can be fixed? Thanks!

Edit: Here is the repeater code:

```
<asp:Repeater ID="repeaterAddable" runat="server">
    <ItemTemplate>
        <div class="background-white">
            <div style="padding: 15px;">
                <table style="width: 100%" cellspacing="5">
                    <tr>
                        <td colspan="3" align="right">
                            Include this? <input type="checkbox" name="include<%#DataBinder.Eval(Container.DataItem, "Index")%>" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 30%;" valign="top">

                        </td>
                        <td style="width: 30%;" valign="top">
                            <div class="media">

                                <%#DataBinder.Eval(Container.DataItem, "Display")%>

                            </div>
                        </td>
                        <td style="width: 30%;" valign="top">

                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <br />
    </ItemTemplate>
</asp:Repeater> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-18T21:59:56.757

尝试添加一个 Literal 控件，并将其文本属性绑定到所需的内容。例如：

```
<div class="media">
  <asp:Literal runat="server" Text='<%# Eval("Display") %>' />
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-22T01:34:27.653

也许您的页面或 webconfig 上有一些安全设置...

我试图在一个全新的页面中重现您的情况，但它确实有效。

```
public class A
{
    public string Display { get; set; }
}

protected void Page_Load(object sender, EventArgs e)
{
    var list = new List<A>();

    var a = new A();
    a.Display = "<script>alert('hi')</script>S<br/>";

    list.Add(a);

    rep.DataSource = list;
    rep.DataBind();
} 
```

并且在页面中

```
<asp:Repeater ID="rep" runat="server">
    <ItemTemplate>
        <%# DataBinder.Eval(Container.DataItem, "Display") %>
    </ItemTemplate>
</asp:Repeater> 
```

也许您可以尝试设置`Display`并`HttpUtility.UrlEncode`使用`HttpUtility.UrlDecode`...

# sql - 使用 Null 来表示值是不好的做法吗？

> ID：455924
> 
> 赞同：4
> 
> 时间：2009-01-18T21:25:26.513
> 
> 标签：sql, database-design

如果我使用 null 作为数据库表中所有内容的表示，那是不好的做法吗？

IE

我有表格： myTable(ID) 和 myRelatedTable(ID,myTableID)

myRelatedTable.myTableID 是 myTable.ID 的 FK

我想要完成的是：如果 myRelatedTable.myTableID 为空，那么我的业务逻辑会将其解释为链接到所有 myTable 行。

我想这样做的原因是因为在创建 myRelatedTable 行之后我有未知数量的行可以插入到 myTable 中，并且 myRelatedTable 中的某些行需要引用 myTable 中的所有现有行。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-18T22:00:57.723

我认为您可能同意使用数字**3**来表示 3 以外的值**是**不好的。

因此，出于同样的原因，使用 NULL 来表示除了没有值之外的任何东西都是一个坏主意。

如果您不同意并将 NULL 用于其他目的，那么您之后的维护程序员将不会感激。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T21:32:20.337

这不是一个好主意，因为这样您就根本无法在 SQL 查询中使用“与所有条目相关”的事实。在某些时候，您可能想要/需要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T22:12:22.300

理想情况下根本不应该有空值。应该有另一个表来表示关系。

如果您要分配特殊含义，但 NULL 应该只表示“未分配” - 即不存在关系，请使用负数，即 -1 如果您想触发一些业务层诡计。任何将来遇到此问题的开发人员都应该清楚，-1 是一个非凡的值，不应被视为正常值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T22:03:29.620

我不认为 N​​ULL 是最好的方法，但您可以使用单独的 tinyInt 列来指示 MyRelatedTable 中的行与 MyTable 中的所有内容相关，例如 MyRelatedTable.RelatedAll。这将使其他必须维护它的人更加明确。然后你可以做某种联合查询，例如

```
SELECT M.ID, R.ID AS RelatedTableID,....
FROM MyTable M INNER JOIN MyRelated Table R ON R.myTableId = M.Id
UNION
SELECT M.ID, R.ID AS RelatedTableID,....
FROM MyTable M, MyRelatedTable R
WHERE R.RelatedAll = 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T22:04:26.590

是的，原因很简单，它`NULL`代表**没有价值**。不是特殊值；不是空白值，但什么也没有。

如果外键只是一个简单的整数，并且它是自动生成的，那么您可以使用 0 来表示“魔术”值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T15:58:01.043

您发布的内容，即外键中的 NULL 断言与引用表中所有行的关系，是非常不标准的。在我的脑海中，我认为它充满了危险。

大多数在 FK 中使用 NULL 的人的意思是它断言与引用表中的行的 NONE 的关系。这在可选关系的情况下很常见，可能出现零次。

示例：我们有一个 HR 数据库，其中有一个名为“EMPLOYEES”的表。我们有两列，分别称为“EmpID”和“SupervisorID”。（许多人将第一列简称为“ID”）。表中的每个员工在 SupervisorID 下都有一个条目，唯一的例外是公司的 CEO。CEO 在 SupervisorID 列中有一个 NULL，表示 CEO 没有主管。CEO 对 BOD 负责，但这并没有在 SupervisorID 中表示。

您所说的与引用表中所有行的关系可能是指：有问题的行与引用表中的任何行之间存在可能的关系。当您开始研究现实世界中真实但数据库未知的事实问题时，您会打开一大堆蠕虫。

# c# - .NET 嵌套类

> ID：455928
> 
> 赞同：1
> 
> 时间：2009-01-18T21:28:12.203
> 
> 标签：c#, .net, boo, nested-class, class-structure

我正在研究的当前类库将有一个基类（字段），其中包含 50 多种特定的“字段”类型，这些类型将从“字段”继承并嵌套以保持可读性。例如...

```
abstract class Field
{
    public int Length { get; set; }

    public class FieldA : Field
    {
        public static void DoSomething()
        {
            Console.WriteLine("Did something.");
        }
    }
} 
```

到目前为止，一切看起来都不错，我可以使用如下所示的代码：

```
class Program
{
    static void Main(string[] args)
    {
        Field.FieldA.DoSomething();
    }
} 
```

但是，为什么这也有效？这里发生了什么，允许编译器/IDE 智能感知继续链接这些“FieldA”？

```
class Program
{
    static void Main(string[] args)
    {
        Field.FieldA.FieldA.FieldA.FieldA.FieldA.FieldA.FieldA.DoSomething();
    }
} 
```

无论如何，这不是应用程序破坏，而是认为它很奇怪。在 Boo 中做同样的事情（这是用于库的实际语言）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T21:34:04.093

听起来你想要这样的东西：

```
abstract class Field
{
    public int Length { get; set; }
}

public class FieldA : Field
{
    public static void DoSomething()
    {
        Console.WriteLine("Did something.");
    }
} 
```

否则，您将定义一个包含内部类的基类，继承者也将获得它。因此，当您从外部类继承以创建内部类时，您正在开始一个循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T21:35:16.387

1.  `Field`有一个名为的*公共*嵌套类`FieldA`
2.  `FieldA`继承自`Field`
3.  因此您始终可以`FieldA`从`FieldA`.

引用并没有创建无限链，它只是指向同一个类。（[一些测试代码](http://pastebin.com/f6d5f0e5f)）

当您访问`FieldA.FieldA`时，后者`FieldA`是可访问的，因为前者`FieldA`是一个实例，`Field`因此后者`FieldA`实际访问`Field.FieldA`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T21:37:34.663

FieldA 继承对 FieldA 类的引用，FieldA 继承对 FieldA 类的引用，FieldA 继承对 FieldA 类的引用，FieldA 继承对 FieldA 类的引用，FieldA 继承对 FieldA 类的引用，FieldA 继承对 FieldA 类的引用，FieldA 继承对 FieldA 类的引用...

它之所以有效，是因为*这就是您告诉它要做的事情。*

# ruby-on-rails - A/B testing and stats solutions

> ID：455932
> 
> 赞同：3
> 
> 时间：2009-01-18T21:30:47.097
> 
> 标签：ruby-on-rails, plugins, statistics, ab-testing

I've been looking for a good testing framework for months, not finding anything, so I've just been building my own.

This is what I want to do:
- track arbitrary behaviors (e.g. # of photos viewed, # of comments posted)
- track correlation between arbitrary variables and those behaviors
(e.g, how do different versions of this prompt affect average # of photos viewed?)

This kind of thing should be a core part of agile development. What's out there? I know Google Website Optimizer is one of the answers, but you can only track behaviors that end in a single "success" page.

It'd be great to have a plugin that can work within your code (Rails in my case) and feed into a nice hosted service with pretty graphs...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T06:47:24.600

您可能希望将您的问题划分为分析（印象、操作和可能的页内事件、测试报告）和提供变体的框架（如何在准备它们的实际方面管理 x 个变体，您是否需要存储变体以供将来参考、打开和关闭测试、优化测试的有效性等）。显然存在重叠，例如，Google 网站优化器可以在有数据支持时立即关闭一个不好的变体，但是通过将其视为不同的问题，您也许可以重用 Google Analytics 组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T20:28:26.200

是的，这里：

[http://github.com/paulmars/seven_minute_abs/tree/master](http://github.com/paulmars/seven_minute_abs/tree/master)

# c# - Glass look for MDI windows under Vista

> ID：455934
> 
> 赞同：3
> 
> 时间：2009-01-18T21:32:03.723
> 
> 标签：c#, windows-vista, mdi, aero, aero-glass

I am developing a winforms MDI application in C# in VS 2008. I have noticed that the MDI forms don't have the glass look under Vista.

Is this by design? Is there a simple way to get the glass look for these windows?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T21:37:41.730

By default glass is not enabled on WinForms (or for that matter WPF applications). The only way to enable glass is to PInvoke into native API's. This channel9 site does a tutorial for a great utility that makse it trivial to add Glass effects to your controls.

[http://channel9.msdn.com/playground/Sandbox/201158/](http://channel9.msdn.com/playground/Sandbox/201158/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T21:48:57.217

Nope, Glass is not available for MDI children.

# jquery - 在 HTML 表格中隐藏/显示列

> ID：455958
> 
> 赞同：160
> 
> 时间：2009-01-18T21:46:45.473
> 
> 标签：jquery, html, hide, html-table, show

我有一个包含几列的 HTML 表，我需要使用 jquery 实现一个列选择器。当用户单击复选框时，我想隐藏/显示表格中的相应列。我想在不为表中的每个 td 附加一个类的情况下执行此操作，有没有办法使用 jquery 选择整个列？下面是 HTML 的示例。

```
<table>
    <thead>
        <tr><th class="col1">Header 1</th><th class="col2">Header 2</th><th class="col3">Header 3</th></tr>
    </thead>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
</table>

<form>
    <input type="checkbox" name="col1" checked="checked" /> Hide/Show Column 1 <br />
    <input type="checkbox" name="col2" checked="checked" /> Hide/Show Column 2 <br />
    <input type="checkbox" name="col3" checked="checked" /> Hide/Show Column 3 <br />
</form> 
```

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2011-05-05T16:50:46.087

使用 jQuery 的一行代码隐藏了第二列：

```
$('td:nth-child(2)').hide(); 
```

如果您的表有标题（th），请使用：

```
$('td:nth-child(2),th:nth-child(2)').hide(); 
```

来源：[使用单行 jQuery 代码隐藏表格列](http://www.devcurry.com/2009/07/hide-table-column-with-single-line-of.html)

jsFiddle 测试代码：http: [//jsfiddle.net/mgMem/1/](http://jsfiddle.net/mgMem/1/)

* * *

如果您想查看一个好的用例，请查看我的博客文章：

[使用 jQuery 隐藏表列并根据值对行进行着色](http://www.leniel.net/2012/03/hide-webgrid-column-colorize-rows-value.html)。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-01-19T14:16:12.807

> 我想这样做而不给每个 td 附加一个类

就个人而言，我会采用 class-on-each-td/th/col 方法。然后，您可以使用对容器上的 className 的一次写入来打开和关闭列，假设样式规则如下：

```
table.hide1 .col1 { display: none; }
table.hide2 .col2 { display: none; }
... 
```

这将比任何 JS 循环方法都快；对于非常长的表，它可以对响应能力产生重大影响。

如果您可以不支持 IE6，则可以使用邻接选择器来避免将类属性添加到 tds。或者，如果您关心的是使标记更清晰，您可以在初始化步骤中从 JavaScript 自动添加它们。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-01-23T20:48:38.567

这是一个功能更全面的答案，它在每列的基础上提供一些用户交互。如果这将是一种动态体验，则需要在每列上都有一个可点击的切换开关，指示隐藏该列的能力，然后恢复以前隐藏的列。

在 JavaScript 中看起来像这样：

```
$('.hide-column').click(function(e){
  var $btn = $(this);
  var $cell = $btn.closest('th,td')
  var $table = $btn.closest('table')

  // get cell location - https://stackoverflow.com/a/4999018/1366033
  var cellIndex = $cell[0].cellIndex + 1;

  $table.find(".show-column-footer").show()
  $table.find("tbody tr, thead tr")
        .children(":nth-child("+cellIndex+")")
        .hide()
})

$(".show-column-footer").click(function(e) {
    var $table = $(this).closest('table')
    $table.find(".show-column-footer").hide()
    $table.find("th, td").show()

}) 
```

为了支持这一点，我们将在表格中添加一些标记。在每个列标题中，我们可以添加类似这样的内容，以提供可点击内容的视觉指示器

```
<button class="pull-right btn btn-default btn-condensed hide-column" 
            data-toggle="tooltip" data-placement="bottom" title="Hide Column">
    <i class="fa fa-eye-slash"></i>  
</button> 
```

我们将允许用户通过表格页脚中的链接恢复列。如果默认情况下它不是持久的，那么在标题中动态切换它可能会在桌子周围挤来挤去，但你真的可以把它放在你想要的任何地方：

```
<tfoot class="show-column-footer">
   <tr>
    <th colspan="4"><a class="show-column" href="#">Some columns hidden - click to show all</a></th>
  </tr>
</tfoot> 
```

这就是基本功能。下面是一个演示，其中包含更多内容。您还可以向按钮添加工具提示以帮助阐明其用途，将按钮的样式更加有机地添加到表格标题中，并折叠列宽以添加一些（有些不稳定的）css动画以减少过渡跳动。

[![演示截屏](https://i.stack.imgur.com/r0wDN.gif)](https://i.stack.imgur.com/r0wDN.gif)

### [jsFiddle](https://jsfiddle.net/KyleMit/rr96p4vv/)和 Stack Snippets中的工作演示：

```
$(function() {
  // on init
  $(".table-hideable .hide-col").each(HideColumnIndex);

  // on click
  $('.hide-column').click(HideColumnIndex)

  function HideColumnIndex() {
    var $el = $(this);
    var $cell = $el.closest('th,td')
    var $table = $cell.closest('table')

    // get cell location - https://stackoverflow.com/a/4999018/1366033
    var colIndex = $cell[0].cellIndex + 1;

    // find and hide col index
    $table.find("tbody tr, thead tr")
      .children(":nth-child(" + colIndex + ")")
      .addClass('hide-col');

    // show restore footer
    $table.find(".footer-restore-columns").show()
  }

  // restore columns footer
  $(".restore-columns").click(function(e) {
    var $table = $(this).closest('table')
    $table.find(".footer-restore-columns").hide()
    $table.find("th, td")
      .removeClass('hide-col');

  })

  $('[data-toggle="tooltip"]').tooltip({
    trigger: 'hover'
  })

})
```

```
body {
  padding: 15px;
}

.table-hideable td,
.table-hideable th {
  width: auto;
  transition: width .5s, margin .5s;
}

.btn-condensed.btn-condensed {
  padding: 0 5px;
  box-shadow: none;
}

/* use class to have a little animation */
.hide-col {
  width: 0px !important;
  height: 0px !important;
  display: block !important;
  overflow: hidden !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
}
```

```
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

<table class="table table-condensed table-hover table-bordered table-striped table-hideable">

  <thead>
    <tr>
      <th>
        Controller
        <button class="pull-right btn btn-default btn-condensed hide-column" data-toggle="tooltip" data-placement="bottom" title="Hide Column">
          <i class="fa fa-eye-slash"></i>  
        </button>
      </th>
      <th class="hide-col">
        Action
        <button class="pull-right btn btn-default btn-condensed hide-column" data-toggle="tooltip" data-placement="bottom" title="Hide Column">
          <i class="fa fa-eye-slash"></i>  
        </button>
      </th>
      <th>
        Type
        <button class="pull-right btn btn-default btn-condensed hide-column" data-toggle="tooltip" data-placement="bottom" title="Hide Column">
          <i class="fa fa-eye-slash"></i>  
        </button>
      </th>
      <th>
        Attributes
        <button class="pull-right btn btn-default btn-condensed hide-column" data-toggle="tooltip" data-placement="bottom" title="Hide Column">
          <i class="fa fa-eye-slash"></i>  
        </button>
      </th>
  </thead>
  <tbody>

    <tr>
      <td>Home</td>
      <td>Index</td>
      <td>ActionResult</td>
      <td>Authorize</td>
    </tr>

    <tr>
      <td>Client</td>
      <td>Index</td>
      <td>ActionResult</td>
      <td>Authorize</td>
    </tr>

    <tr>
      <td>Client</td>
      <td>Edit</td>
      <td>ActionResult</td>
      <td>Authorize</td>
    </tr>

  </tbody>
  <tfoot class="footer-restore-columns">
    <tr>
      <th colspan="4"><a class="restore-columns" href="#">Some columns hidden - click to show all</a></th>
    </tr>
  </tfoot>
</table>
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-18T21:52:20.343

你可以使用 colgroups：

```
<table>
    <colgroup>
       <col class="visible_class"/>
       <col class="visible_class"/>
       <col class="invisible_class"/>  
    </colgroup>
    <thead>
        <tr><th class="col1">Header 1</th><th class="col2">Header 2</th><th class="col3">Header 3</th></tr>
    </thead>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
    <tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
</table> 
```

然后你的脚本可以只改变欲望`<col>`类。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-01-18T21:57:03.253

以下应该做到这一点：

```
$("input[type='checkbox']").click(function() {
    var index = $(this).attr('name').substr(2);
    $('table tr').each(function() { 
        $('td:eq(' + index + ')',this).toggle();
    });
}); 
```

这是未经测试的代码，但原则是您在每一行中选择对应于从复选框名称中提取的所选索引的表格单元格。您当然可以使用类或 ID 来限制选择器。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-05-18T13:28:54.467

当然，对于[支持的浏览器，](http://caniuse.com/#feat=css-sel3) `nth-child` CSS 唯一方法：

`table td:nth-child(2) { display: none; }`

这适用于 IE9 和更高版本。

对于您的用例，您需要几个类来隐藏列：

```
.hideCol1 td:nth-child(1) { display: none;}
.hideCol2 td:nth-child(2) { display: none;} 
```

等等...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-18T22:15:35.803

以下是基于 Eran 的代码，有一些小的改动。经过测试，它似乎在 Firefox 3、IE7 上运行良好。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<script>
$(document).ready(function() {
    $('input[type="checkbox"]').click(function() {
        var index = $(this).attr('name').substr(3);
        index--;
        $('table tr').each(function() { 
            $('td:eq(' + index + ')',this).toggle();
        });
        $('th.' + $(this).attr('name')).toggle();
    });
});
</script>
<body>
<table>
<thead>
    <tr>
        <th class="col1">Header 1</th>
        <th class="col2">Header 2</th>
        <th class="col3">Header 3</th>
    </tr>
</thead>
<tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
<tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
<tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
<tr><td>Column1</td><td>Column2</td><td>Column3</td></tr>
</table>

<form>
    <input type="checkbox" name="col1" checked="checked" /> Hide/Show Column 1 <br />
    <input type="checkbox" name="col2" checked="checked" /> Hide/Show Column 2 <br />
    <input type="checkbox" name="col3" checked="checked" /> Hide/Show Column 3 <br />
</form>
</body>
</html> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-02T08:08:16.767

```
<p><input type="checkbox" name="ch1" checked="checked" /> First Name</p>
.... 
<td class="ch1">...</td>

 <script>
       $(document).ready(function() {
            $('#demo').multiselect();
        });

        $("input:checkbox:not(:checked)").each(function() {
    var column = "table ." + $(this).attr("name");
    $(column).hide();
});

$("input:checkbox").click(function(){
    var column = "table ." + $(this).attr("name");
    $(column).toggle();
});
 </script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-13T16:32:44.313

不上课？您可以使用标签然后：

```
var tds = document.getElementsByTagName('TD'),i;
for (i in tds) {
  tds[i].style.display = 'none';
} 
```

并向他们展示使用：

```
...style.display = 'table-cell'; 
```

# c - C中动态分配数组的数组

> ID：455960
> 
> 赞同：17
> 
> 时间：2009-01-18T21:48:06.250
> 
> 标签：c, arrays, memory, dynamic-memory-allocation, allocation

我并不真正了解 C 中的一些基本内容，例如动态分配数组。我知道你可以这样做：

```
int **m; 
```

为了声明一个二维数组（随后将使用一些 *alloc 函数分配）。也可以通过做“轻松”访问它`*(*(m + line) + column)`。但是我应该如何为该数组中的元素赋值呢？使用 gcc 以下语句`m[line][column] = 12;`因分段错误而失败。

任何文章/文档将不胜感激。:-)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-18T21:53:24.850

`m[line][column] = 12`语法没问题（提供并且`line`在`column`范围内）。

但是，您没有编写用于分配它的代码，因此很难判断它是对还是错。它应该是类似的东西

```
m = (int**)malloc(nlines * sizeof(int*));

for(i = 0; i < nlines; i++)
  m[i] = (int*)malloc(ncolumns * sizeof(int)); 
```

一些旁注：

*   这样，您可以为每一行分配不同的长度（例如三角形数组）
*   您可以稍后在使用数组时重新分配（）或释放（）单独的行
*   当您释放（）整个数组时，您必须释放（）每一行

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-18T21:53:54.257

您的语法 m[line][colummn] 是正确的。但是为了在 C 中使用二维数组，您必须为其分配内存。例如，此代码将为给定行和列的表分配内存。

```
int** AllocateArray(int line, int column) {
  int** pArray = (int**)malloc(line*sizeof(int*));
  for ( int i = 0; i < line; i++ ) {
    pArray[i] = (int*)malloc(column*sizeof(int));
  }
  return pArray;
} 
```

请注意，为简洁起见，我省略了 malloc 的错误检查。真正的解决方案应该包括它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-18T21:57:55.263

它不是一个二维数组——它是一个数组数组——因此它需要多次分配。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T00:41:54.370

[这是quinmars 解决方案](https://stackoverflow.com/questions/455960/dynamic-allocating-array-of-arrays-in-c#456090)的修改版本，它只分配一个内存块，并且可以通过以下方式与通用值一起使用`void *`：

```
#include <stdlib.h>
#include <string.h>
#include <assert.h>

void ** array2d(size_t rows, size_t cols, size_t value_size)
{
    size_t index_size = sizeof(void *) * rows;
    size_t store_size = value_size * rows * cols;

    char * a = malloc(index_size + store_size);
    if(!a) return NULL;

    memset(a + index_size, 0, store_size);
    for(size_t i = 0; i < rows; ++i)
        ((void **)a)[i] = a + index_size + i * cols * value_size;

    return (void **)a;
}

int printf(const char *, ...);

int main()
{
    int ** a = (int **)array2d(5, 5, sizeof(int));
    assert(a);
    a[4][3] = 42;
    printf("%i\n", a[4][3]);
    free(a);
    return 0;
} 
```

我不确定转换为是否真的安全`void **`（`int **`我认为标准允许在转换为/从时进行转换`void *`？），但它适用于 gcc。为了安全起见，您应该`void *`用`int *`...

* * *

以下宏实现了先前算法的类型安全版本：

```
#define alloc_array2d(TYPE, ROWS, COLS) \
    calloc(sizeof(TYPE *) * ROWS + sizeof(TYPE) * ROWS * COLS, 1)

#define init_array2d(ARRAY, TYPE, ROWS, COLS) \
    do { for(int i = 0; i < ROWS; ++i) \
        ARRAY[i] = (TYPE *)(((char *)ARRAY) + sizeof(TYPE *) * ROWS + \
        i * COLS * sizeof(TYPE)); } while(0) 
```

像这样使用它们：

```
int ** a = alloc_array2d(int, 5, 5);
init_array2d(a, int, 5, 5);
a[4][3] = 42; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T23:09:47.317

尽管我同意其他答案，但在大多数情况下，最好一次分配整个数组，因为 malloc 非常慢。

```
 int **
array_new(size_t rows, size_t cols)
{
    int **array2d, **end, **cur;
    int *array;

    cur = array2d = malloc(rows * sizeof(int *));
    if (!array2d)
        return NULL;

    array = malloc(rows * cols * sizeof(int));
    if (!array)
    {
        free(array2d);
        return NULL;
    }

    end = array2d + rows;
    while (cur != end)
    {
        *cur = array;
        array += cols;
        cur++;
    }

    return array2d;
} 
```

要释放数组，只需执行以下操作： `free(*array); free(array);`

注意：此解决方案仅在您不想更改行的顺序时才有效，因为您可能会丢失第一个元素的地址，您需要稍后释放数组。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T00:15:59.073

嗯。旧时尚烟雾和镜子作为一种选择怎么样？

```
#define ROWS  5
#define COLS 13
#define X(R, C) *(p + ((R) * ROWS) + (C))

int main(void)
{
    int *p = (int *) malloc (ROWS * COLS * sizeof(int));
    if (p != NULL)
    {
        size_t r;
        size_t c;
        for (r = 0; r < ROWS; r++)
        {
            for (c = 0; c < COLS; c++)
            {
                 X(r,c) = r * c;  /* put some silly value in that position */ 
            }
        }

        /* Then show the contents of the array */ 
        for (r = 0; r < ROWS; r++)
        {
            printf("%d ", r);   /* Show the row number */ 

            for (c = 0; c < COLS; c++)
            {
                 printf("%d", X(r,c));
            }

            printf("\n");
        }

        free(p);
    }
    else
    {
        /* issue some silly error message */ 
    }

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T21:53:22.480

使用`malloc(3)`for 分配第一个数组并将由创建的指针放入`malloc(3)`应该可以使用，`array[r][c]`因为它应该等效于`*(*(array + r) + c)`，它在 C 标准中。

# sql-server - sys.indexes 中的 index_id=0 是否引用表本身？

> ID：455964
> 
> 赞同：3
> 
> 时间：2009-01-18T21:49:17.357
> 
> 标签：sql-server, sql-server-2005, data-dictionary

不幸的是，BOL 在这方面有点模糊，但`index_id = 0`在表上没有聚集索引的情况下`sys.indexes`，`sys.partitions`它似乎是指表本身。是的 - 还是我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-18T22:48:07.330

> sys.indexes 中的 index_id=0 是否引用表本身？

不，对于基于堆的表，它将始终存在并且它指的是 IAM（索引分配映射）。对于具有聚集索引的表，它将不存在。

请注意，“type_desc”是这些索引上的 HEAP，关于[Index Allocation Map](http://blogs.msdn.com/sqlserverstorageengine/archive/2006/06/24/645803.aspx)有一个非常好的博客条目。

因此，堆表（没有聚集索引的）总是有一个带有条目的索引`index_id = 0`，而带有聚集索引的表总是有一个带有 的条目`index_id = 1`。

# c# - C#：异常“输入字符串的格式不正确。” 在 DataSet 中的 Row.Delete 之后

> ID：455987
> 
> 赞同：1
> 
> 时间：2009-01-18T22:02:09.980
> 
> 标签：c#, sql-server, sql-server-ce

在标记要删除的行后尝试更新 DataTable 时，我遇到了一个奇怪的异常。看起来它正在验证我要删除的行中的数据。我能够成功保存同一行，为什么不让我删除它？

在 VS 2008 和 SQL Server CE 中使用 C#。

我的代码的基本部分（我希望）：

```
var listDataTable = new booksDataSet.ListDataTable();
this.tableAdapterManager1.ListTableAdapter.Fill(listDataTable);
listDataTable.Rows[0].Delete();
this.tableAdapterManager1.ListTableAdapter.Update(listDataTable);
booksDataSet1.List.AcceptChanges(); // exception here 
```

例外情况是： System.FormatException 未处理 Message="@p2 : foo - 输入字符串的格式不正确。" 源="系统.数据"

我已将其简化为一个非常简单的表： Id (PK, int, not null) Name (nvarchar(100), not null) Notes (nvarchar(4000), null)

我要删除的行（第一行）中的数据是 Name = "foo"，所以它是正确的行，但为什么它在删除行之前关心数据是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T22:05:43.953

您需要对应用程序进行跟踪（尝试在 SQL Server 的本地副本上运行它并运行“Profiler”）；我的猜测是当 SQL 查询访问您的 SQL Server 时，它的一部分格式不正确。我敢打赌，当您运行跟踪时，您会发现问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-15T16:34:53.913

我得到同样的回应。如果我与 {0:c} 绑定，每次删除都会失败。以为是 $ 我尝试了 {0:N2} 相同的响应。删除它，删除就好了。

# c# - Asp.net updatepanel 清除复选框列表选择

> ID：455988
> 
> 赞同：1
> 
> 时间：2009-01-18T22:02:27.423
> 
> 标签：c#, asp.net, updatepanel, checkboxlist

我在 Ajax UpdatePanel 中有一个 ASP.Net CheckBoxList 控件。

我将在下面的 HTML 中包含代码 (C#)。

我发现这是 CheckBoxList 没有通过回帖持续存在的东西。

顺便说一句，这有点乱。这是一个原型。

这是用于填充原始 CheckBoxList 的方法

```
protected void BindCheckboxes()
{
    chkBuildings.Items.Clear();
    chkNeighborhoods.Items.Clear();
    string city = ddlFindHome_Location.SelectedItem.Value.ToLower();
    ResidentDataContext rdc = new ResidentDataContext(Utility.Lookup.GetResidentConnectionString());
    var neighs = (from n in rdc.spNeighborhoods where n.vchCity.Equals(city) select n);
    foreach (var neighborhood in neighs)
    {
        ListItem li = new ListItem();
        li.Value = neighborhood.intNeighborhoodID.ToString();
        li.Attributes["onclick"] = string.Format("document.getElementById('{0}').click();", btnNeighHack.ClientID);
        li.Text = neighborhood.vchNeighborhood;
        chkNeighborhoods.Items.Add(li);
    }
    var builds = (from b in rdc.spBuildings
                  join nb in rdc.spNeighborhoodBuildings on b.intBuildingID equals nb.intBuildingID
                  join n in rdc.spNeighborhoods on nb.intNeightborhoodID equals n.intNeighborhoodID
                  where n.vchCity.ToLower().Equals(city)
                  select b).Distinct();
    foreach (var buildings in builds)
    {
        ListItem li = new ListItem();
        li.Value = buildings.intBuildingID.ToString();
        li.Text = buildings.vchName;
        chkBuildings.Items.Add(li);
    }
    upNeighs.Update();
    upBuilds.Update();
} 
```

BindCheckboxes() 从以下位置调用：

```
protected void ddlFindHome_Location_SelectedIndexChanged(object sender, EventArgs e)
{
    BindCheckboxes();
} 
```

这是用于填充另一个 CheckBoxList 的复选框的回发方法

```
protected void btnNeighHack_Click(object sender, EventArgs e)
{
    List<int> neighs = new List<int>();

    foreach (ListItem li in chkNeighborhoods.Items)
    {
        if (li.Selected)
            neighs.Add(Convert.ToInt32(li.Value));
    }
    ResidentDataContext rdc = new ResidentDataContext(Utility.Lookup.GetResidentConnectionString());
    var builds = (from b in rdc.spBuildings
                  join nb in rdc.spNeighborhoodBuildings on b.intBuildingID equals nb.intBuildingID
                  where neighs.Contains(nb.intNeightborhoodID)
                  select b.intBuildingID).Distinct();
    foreach (ListItem li in chkBuildings.Items)
    {
        li.Selected = false;
    }
    foreach (ListItem li in chkBuildings.Items)
    {
        if (builds.Contains(Convert.ToInt32(li.Value)))
            li.Selected = true;
    }
    upBuilds.Update();
} 
```

这是 ASP.Net HTML

```
<asp:UpdatePanel ID="upNeighs" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <div style="font-weight: bold;">
            Neighborhood
        </div>
        <div style="padding-top: 7px; padding-left: 3px;">
            <input type="checkbox" id="chkNeighborhood_CheckAll" />Select All
        </div>
        <hr />
        <div>
            <asp:CheckBoxList ID="chkNeighborhoods" runat="server" />
            <asp:Button style="display: none;" ID="btnNeighHack" runat="server" 
                onclick="btnNeighHack_Click" />
        </div>
    </ContentTemplate>
</asp:UpdatePanel>

<asp:UpdatePanel ID="upBuilds" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <div style="padding-left: 6px; padding-top: 5px; font-weight: bold;">
            Building
        </div>
        <div>
            <asp:CheckBoxList ID="chkBuildings" runat="server" />
        </div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

我应该提到 bindcheckboxes() 函数是从

```
protected void ddlFindHome_Location_SelectedIndexChanged(object sender, EventArgs e)
{
    BindCheckboxes();
} 
```

所以它总是一个 PostBack。但我认为你可能会对此有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-18T22:11:00.510

```
 protected void BindCheckboxes()
    {
        if(!IsPostBack)
{
chkBuildings.Items.Clear();
        chkNeighborhoods.Items.Clear();
        string city = ddlFindHome_Location.SelectedItem.Value.ToLower();
        ResidentDataContext rdc = new ResidentDataContext(Utility.Lookup.GetResidentConnectionString());
        var neighs = (from n in rdc.spNeighborhoods where n.vchCity.Equals(city) select n);
        foreach (var neighborhood in neighs)
        {
            ListItem li = new ListItem();
            li.Value = neighborhood.intNeighborhoodID.ToString();
            li.Attributes["onclick"] = string.Format("document.getElementById('{0}').click();", btnNeighHack.ClientID);
            li.Text = neighborhood.vchNeighborhood;
            chkNeighborhoods.Items.Add(li);
        }
        var builds = (from b in rdc.spBuildings
                      join nb in rdc.spNeighborhoodBuildings on b.intBuildingID equals nb.intBuildingID
                      join n in rdc.spNeighborhoods on nb.intNeightborhoodID equals n.intNeighborhoodID
                      where n.vchCity.ToLower().Equals(city)
                      select b).Distinct();
        foreach (var buildings in builds)
        {
            ListItem li = new ListItem();
            li.Value = buildings.intBuildingID.ToString();
            li.Text = buildings.vchName;
            chkBuildings.Items.Add(li);
        }
        upNeighs.Update();
        upBuilds.Update();
}
    } 
```

试试看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T23:06:24.237

好吧，如果您每次更改选择时都清除 CheckBoxList，它也会清除您选择的项目。我会改为在 page_load 加载项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T23:19:41.527

经过进一步研究，我发现控件没有通过回发持续存在，并且正在退出视图状态。因此，每次回发时，都会从以下位置返回一个空对象：

```
protected Control PostBackControl
{
    get { return Page.FindControl(Request.Params.Get("__EVENTTARGET")); }
} 
```

但它发现下拉列表的值不是默认值并开始重新绑定所有内容。

当我只在 PostBackControl 是下拉列表时绑定复选框列表时，控件永远不会被绑定，因为更新面板中的所有内容都超出了范围。

# c# - C# App.Config 位置

> ID：455990
> 
> 赞同：0
> 
> 时间：2009-01-18T22:03:16.530
> 
> 标签：c#, app-config

我有一个包含 10 个左右项目的解决方案，并且开始遇到 SystemConfiguration 返回空配置而不是定位我的 App.Config 文件的问题。

我是否应该有多个 App.Config，每个项目一个（我假设并希望没有），如果没有，它在我的项目中的最佳位置在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T22:07:39.690

选择其中一个项目作为负责维护 App.config 文件的项目。然后对于其他项目，使用“添加现有项目”，导航到 App.config 文件并单击“添加为链接”（它位于添加按钮的右侧）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T22:08:41.763

您可以使用构建事件用存储在“主”项目或位置中的通用配置覆盖所有 app.config**********