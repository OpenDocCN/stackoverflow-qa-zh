# StackOverflow 问答 10687000-10687999

# jquery - jQuery document.write？

> ID：10687007
> 
> 赞同：0
> 
> 时间：2012-05-21T14:17:55.303
> 
> 标签：jquery, html

不确定这是否是正确的发布位置，但是看看我的 HTML5 样板...

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.js"></script>
<script>window.jQuery || document.write('<script src="_includes/js/libs/jquery-1.6.2.min.js"><\/script>')</script> 
```

现在我已经阅读了第二个脚本，如果第一个脚本失败，那么它是一个后备，但是如何？我一直以为|| 是一个 OR 运算符，对我来说，它看起来就像是在页面加载时将旧的 jQuery 库写入页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:19:42.853

`||`仅当左侧为“假”时才评估运算符的后半部分。这被称为“短路评估”*

所以当`window.jQuery`是`undefined`，它会`document.write()`。

* * *

* ，无论 x 的值如何，因此为其左侧操作数指定`true || x == true`的短路运算符将跳过计算表达式的右侧，因为它不会更改结果。`||``true`

反之`false && x == false`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:19:17.377

因为 javascript 是一种虚假语言，如果 jQuery 不可用，`window.jQuery`将返回`undefined`等于`false`.

因此，将执行该语句的第二部分，将`<script>`标记写入包含 jQuery 本地备份版本的文档中。

# apache - HTTPS 图像未缓存

> ID：10687008
> 
> 赞同：3
> 
> 时间：2012-05-21T14:18:06.690
> 
> 标签：apache, caching, browser-cache

我在我的网络应用程序上缓存图像时遇到了一些问题。刷新后图像被缓存，但是当我重新打开浏览器时，它不再被缓存。我正在使用 HTTPS，但我不确定是不是问题所在。这是来自服务器的响应：

```
Response Headers
Accept-Ranges: bytes
Cache-Control: public
Connection: close
Content-Length: 3711
Content-Type: image/png
Date: Mon, 21 May 2012 14:08:46 GMT
ETag: "446b5-e7f-4c0559b8c1c9f"
Expires: Wed, 20 Jun 2012 14:08:46 GMT
Last-Modified: Fri, 18 May 2012 20:43:41 GMT
Server: Apache/2.2.22 (Amazon) 
```

还有我们的 httpd.conf

```
NameVirtualHost *:80
NameVirtualHost *:443

<VirtualHost *:80>
    ServerName [REMOVED]

        RewriteEngine on
        ReWriteCond %{SERVER_PORT} !^443$
        RewriteRule ^/(.*) https://%{HTTP_HOST}/$1 [NC,R,L]
</VirtualHost>

<VirtualHost *:443>

ServerName [REMOVED]

#Force image type
AddType image/png .png
AddType image/jpeg jpeg jpg jpe
AddType font/x-woff .woff

#Cache
ExpiresActive On
ExpiresDefault A0
<FilesMatch "\.(png|jpg|jpeg|gif)$">
    ExpiresDefault "access plus 1 month"
    Header set Cache-Control "public"
</FilesMatch>

#Logs
ErrorLog logs/ssl_error_log
TransferLog logs/ssl_access_log
LogLevel warn

#SSL
SSLEngine on
SSLProtocol all -SSLv2
SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM:+LOW
SSLCertificateFile [REMOVED]
SSLCertificateKeyFile [REMOVED]
SSLCertificateChainFile [REMOVED]
SetEnvIf User-Agent ".*MSIE.*" \
         nokeepalive ssl-unclean-shutdown \
         downgrade-1.0 force-response-1.0
CustomLog logs/ssl_request_log \
          "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"

#Proxy
    DocumentRoot [REMOVED]

    ProxyPreserveHost On
    ProxyRequests Off

    ProxyPass [REMOVED] http://localhost:8081/[REMOVED]
    ProxyPassReverse [REMOVED] http://localhost:8081/[REMOVED]

    ProxyPassReverseCookiePath [REMOVED] /

    Alias [REMOVED] [REMOVED]

</VirtualHost> 
```

有什么线索吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T19:33:43.730

标题很好。`Cache-Control: public`和未来`Expires`应该做的工作。

似乎是浏览器决定不永久存储缓存（这种对 HTTPS 数据的偏执是典型的），我认为您对此无能为力。

# android - 在 ActionbarSherlock 中设置进度条的样式

> ID：10687011
> 
> 赞同：2
> 
> 时间：2012-05-21T14:18:08.820
> 
> 标签：android, progress-bar, actionbarsherlock

ActionbarSherlock 中的水平进度条太细，很难看到。如何将其样式设置为厚几个像素？

我尝试通过从 Widget.Sherlock.Light.ProgressBar.Horizo​​ntal 继承样式来在 styles.xml 中应用自定义样式，但这确实令人困惑，我不知道要设置哪些属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T09:02:02.977

与其尝试使`ProgressBar`颜色更厚，不如尝试使用与颜色形成对比的`ActionBar`颜色以使其突出并引人注目。

这就是我对我的应用程序所做的。我有一个灰色的`ActionBar`，带一个鲜红色的`ProgressBar`。

希望这可以帮助！

# c# - 浮点数中的 E 是什么？

> ID：10687016
> 
> 赞同：14
> 
> 时间：2012-05-21T14:18:20.153
> 
> 标签：c#, .net

是什么`E+3`？这里到底发生了什么？我们可以在其他数据类型中使用这种方法，还是只能在浮点中使用它？

```
static void Main(string[] args)
{
    double w = 1.7E+3;
    Console.WriteLine(w);
} 
```

输出：1700

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-21T14:20:54.763

> [E 符号](http://en.wikipedia.org/wiki/Scientific_notation#E_notation)
> 
> 大多数计算器和许多计算机程序都以科学计数法显示非常大和非常小的结果。^(因为像 10 7)这样的上标指数不能总是方便地显示，所以字母 E 或 e 通常用于表示乘以 10 的次方（可以写为“x 10 ^b ”），然后是指数的值. 请注意，在这种用法中，字符 e 与数学常数*e*或指数函数*e ^(x无关)*（与大写 E 不太可能混淆）；尽管它代表指数，但该符号通常被称为（科学）E 符号或（科学）e 符号，而不是（科学）指数符号（尽管后者也出现）。出版物不鼓励使用这种表示法。

* * *

至于你的第二个问题：

> 我们可以在其他数据类型中使用这种方法还是只能在浮点中使用它？

请参阅[C# 规范](http://msdn.microsoft.com/en-us/library/aa691085(v=vs.71).aspx)：

> 真实字面量 [其中允许的数字字面量类型`E`] 用于写入类型`float`、`double`和`decimal`.

但是，在分配给 a 以外的任何内容时，您必须适当地对文字进行转换或后缀，因为在 Visual Studio中`Double`，任何带有`e`or`E`的文字都被识别为 a 。`Double`我找不到指定此行为的位置。

```
float f1 = 7E1;     // Compile error. Needs F suffix (7E1F)
decimal d1 = 8E2;   // Compile error. Needs M suffix (8E2M)
double d2 = 9E3;    // Works.

int overninethousand = (int)9E3 + 1; // Works 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-21T14:21:01.533

一般来说，这是指数/科学记数法......

1.7E+3 = 1.7 x 10^3 = 1700

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-21T14:21:11.947

E+3 表示小数点向右移动 3 次

1.7 -> 17.0 -> 170.0 -> 1700.0

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T14:21:36.360

```
E+3 = 10^3, so 1.7 * 10^3 = 1700 
```

# ios - 核心数据迁移 - 从以前的版本迁移选定的数据

> ID：10687020
> 
> 赞同：0
> 
> 时间：2012-05-21T14:18:23.440
> 
> 标签：ios, core-data, core-data-migration

我们正在执行我们的第一个 iOS 应用程序更新，以及我们的第一个核心数据迁移。

它似乎比我在网上看到的标准和轻量级核心数据迁移的示例更复杂，但也许我遗漏了一些东西。

我们的场景是我们更新了 .xcdatamodel（只是添加了一个新字段），还有很多我们应用中使用的参考数据（存储在我们的 Core Data 数据库中），但是我们需要保留一些用户数据（存储在同一个核心数据数据库中）。

我已将模型定义的多个版本添加到我们的 .xcdatamodelld 文件中，并使用了轻量级核心数据迁移过程（使用映射模型（一个 .xcmapingmodel 文件）），它成功更新了模型，但我不能看不到任何明显的方式可以让我们将选定的数据（用户的数据）从先前版本的数据库导入到与应用程序的下一版本捆绑在一起的新数据库中（包含我们更新的参考数据）。

非常感谢有关如何处理这种情况的任何建议。

在此先感谢，特德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:14:14.387

您的用户数据库将“就地”升级。不需要任何迁移或导入/导出。当用户运行您的应用程序的新版本时，现有数据库将使用新字段进行升级。我不确定这是否能回答您的问题，但不会进行任何“导入”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:35:14.500

最后，我们通过将用户数据放入 plist 文件（数量相当有限）来解决这种情况，并保留 Core Data 数据库仅用于系统中的参考数据，因此可以覆盖它未来无忧。

轻量级迁移在第一次运行时更新数据模型，然后一次性迁移调用创建并填充用户数据 plist 文件，重命名 v1 核心数据持久存储 *_migrated.sqlite，将 v2 sqlite 数据库从包复制到文档中dir，然后重置 MOM，并将 MOM、MOC 和 Persistent Store 设置为 nil，以便 Core Data 下次启动时使用 v2 sqlite 数据库作为其 Persistent Store。

呸。我希望这对任何阅读它的人都有意义，请随时询问任何其他细节，但老实说，它比听起来简单得多！

# grails - Grails - 一对一关联的例外

> ID：10687021
> 
> 赞同：0
> 
> 时间：2012-05-21T14:18:26.440
> 
> 标签：grails, grails-orm

我在验证域类时遇到问题。我有两个通过一对一关系关联的域：

```
class AssemblyForm {
    Measures measures
    static hasOne = [measures: Measures]
}

class Measures {
    AssemblyForm assemblyForm
} 
```

现在我在控制器和服务中绑定并创建它们：

```
// controller
class AssemblyFormController {
    def save() {
        AssemblyForm assemblyFormInstance = new AssemblyForm()
        assemblyFormInstance.measures = measures
        assemblyFormService.save(assemblyFormInstance)
    }
}

// service
class AssemblyFormService {

    public AssemblyForm save(AssemblyForm assemblyForm) {
        try {
            assemblyForm.save()
        } catch (Throwable t) {
        }
        return assemblyForm
    }
} 
```

现在，如果它的关联有错误，我希望 assemblyForm 实体不会保存在数据库中。但事实是，当Measures 实体出现一些错误时，AssemblyForm 会被持久化到数据库中，而Measures 实体则不会。我做错了什么还是这是标准行为，我应该在保存之前检查关联的实体？谢谢你。

问候，洛伊扎

# ios - XCode 4：如何在 IB 中查看整个 ScrollView？

> ID：10687034
> 
> 赞同：1
> 
> 时间：2012-05-21T14:19:14.273
> 
> 标签：ios, uiscrollview, interface-builder

由于我已经下载了最新版本的 XCode，当我在 IB 中添加 ScrollView 时，我看不到整个视图。例如，如果我添加一个 320x700px 的 ScrollView，我只看到 320x480px 可见。

我能做些什么 ？

# jenkins - 在 Jenkins 中停止构建执行

> ID：10687035
> 
> 赞同：15
> 
> 时间：2012-05-21T14:19:15.387
> 
> 标签：jenkins

我正在使用 Jenkins 在 Sauce Connect 中运行具有 Junit 测试的 Maven 项目。我创建了一个作业并在两者之间停止/中止构建，我单击了进度条附近显示的交叉按钮 (X) 以执行构建。但是构建执行并没有停止。当我移至构建的控制台输出时，它显示消息为“Closing Sauce Connect”，并且花费了太多时间，Jenkins 并没有停止构建过程。

任何人都可以就我们如何手动停止/中止构建执行提出建议。

此外，是否有任何网站可以找到有关 Jenkins for Beginners 的适当文档，因为我在其启动和停止过程方面几乎没有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-17T16:19:37.597

我想现在回答为时已晚，但我帮助了一些人。

1.  安装监控插件。（[http://wiki.jenkins-ci.org/display/JENKINS/Monitoring](http://wiki.jenkins-ci.org/display/JENKINS/Monitoring)）
2.  转到 jenkinsUrl/monitoring/nodes
3.  转到底部的线程部分

4.  单击构建作业的从站左侧的详细信息按钮

5.  按用户时间（毫秒）排序
6.  然后查看线程的名称，你会有构建的名称和编号
7.  杀了它

希望它可以帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T16:48:33.937

Jenkins 将很好地终止构建，即在发送终止信号后等待正在运行的进程结束。如果进程需要很长时间才能终止，它将等待。最简单的方法是更改​​您的构建/代码，使其立即终止，或者关闭连接等超时。

关于更多文档，请查看[Jenkins wiki](https://wiki.jenkins-ci.org/display/JENKINS/Meet+Jenkins)或获取[Jenkins book](http://www.wakaleo.com/books/jenkins-the-definitive-guide)。

# objective-c - iOS 获取属性类

> ID：10687039
> 
> 赞同：6
> 
> 时间：2012-05-21T14:19:29.077
> 
> 标签：objective-c, ios, properties

我正在尝试获取未知类的所有属性和每个属性的类的列表。到那时我得到一个对象所有属性的列表（我递归地做它以获取所有超类）。我在[这篇文章中受到启发](https://stackoverflow.com/questions/9639250/how-to-dynamically-determine-objective-c-property-type)

```
+ (NSArray *)classPropsFor:(Class)klass
{    
    NSLog(@"Properties for class:%@", klass);
    if (klass == NULL || klass == [NSObject class]) {
        return nil;
    }

    NSMutableArray *results = [[NSMutableArray alloc] init];

    unsigned int outCount, i;
    objc_property_t *properties = class_copyPropertyList(klass, &outCount);
    for (i = 0; i < outCount; i++) {
        objc_property_t property = properties[i];
        const char *propName = property_getName(property);
        if(propName) {
            NSString *propertyName = [NSString stringWithUTF8String:propName];
            [results addObject:propertyName];
        }
        NSArray* dict = [self classPropsFor:[klass superclass]];
        [results addObjectsFromArray:dict];
    }
    free(properties);

    return [NSArray arrayWithArray:results];
} 
```

所以现在我想要每个属性的类，我这样做：

```
NSArray* properties = [PropertyUtil classPropsFor:[self class]];
for (NSString* property in properties) {
    id value= [self valueForKey:property];
    NSLog(@"Value class for key: %@ is %@", property, [value class]);
} 
```

问题是它适用于 NSStrings 或但不适用于自定义类，因为它返回我为 null。我想递归地创建一个字典，该字典表示一个可以在其中包含其他对象的对象，并且我认为我需要知道每个属性的类，这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-16T16:12:08.957

刚刚为此做了一个小方法。

```
// Simple as.
Class propertyClass = [customObject classOfPropertyNamed:propertyName]; 
```

可以在很多方面进行优化，但我喜欢它。

* * *

实现如下：

```
-(Class)classOfPropertyNamed:(NSString*) propertyName
{
    // Get Class of property to be populated.
    Class propertyClass = nil;
    objc_property_t property = class_getProperty([self class], [propertyName UTF8String]);
    NSString *propertyAttributes = [NSString stringWithCString:property_getAttributes(property) encoding:NSUTF8StringEncoding];
    NSArray *splitPropertyAttributes = [propertyAttributes componentsSeparatedByString:@","];
    if (splitPropertyAttributes.count > 0)
    {
        // xcdoc://ios//library/prerelease/ios/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection.html
        NSString *encodeType = splitPropertyAttributes[0];
        NSArray *splitEncodeType = [encodeType componentsSeparatedByString:@"\""];
        NSString *className = splitEncodeType[1];
        propertyClass = NSClassFromString(className);
    }
    return propertyClass;
} 
```

它是[eppz!kit](https://github.com/eppz/eppz-kit)的一部分，在一个名为[`NSObject+EPPZRepresentable.h`](https://github.com/eppz/eppz-kit/blob/master/eppz!kit/NSObject%2BEPPZRepresentable.h). 它实际上完成了您最初要实现的目标。

```
// Works vica-versa.
NSDictionary *representation = [customObject dictionaryRepresentation];
CustomClass = [CustomClass representableWithDictionaryRepresentation:representation]; 
```

它编码许多类型，迭代槽集合，表示 CoreGraphics 类型，UIColors，还表示/重构对象引用。

* * *

新版本甚至会吐出**C 类型名称**和**命名结构类型**：

```
NSLog(@"%@", [self typeOfPropertyNamed:@"index"]); // unsigned int
NSLog(@"%@", [self typeOfPropertyNamed:@"area"]); // CGRect
NSLog(@"%@", [self typeOfPropertyNamed:@"keyColor"]); // UIColor 
```

eppz [!model](https://github.com/eppz/eppz.model)的一部分，请随时在[https://github.com/eppz/eppz.model/blob/master/eppz!model/NSObject%2BEPPZModel_inspecting.m#L111使用方法实现](https://github.com/eppz/eppz.model/blob/master/eppz!model/NSObject%2BEPPZModel_inspecting.m#L111)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:53:04.880

**更新**

这不适用于`nil`. 相反，您应该使用运行时 C API 从相应的 ivar 或访问器方法获取类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T15:01:36.693

您可能应该在存储`propertyName`. 也许作为一个字典，属性名作为键，类名作为值，反之亦然。

要获取类名，您可以执行以下操作（在您声明后立即输入`propertyName`）：

```
NSString* propertyAttributes = [NSString stringWithUTF8String:property_getAttributes(property)];
NSArray* splitPropertyAttributes = [propertyAttributes componentsSeparatedByString:@"\""];
if ([splitPropertyAttributes count] >= 2)
{
    NSLog(@"Class of property: %@", [splitPropertyAttributes objectAtIndex:1]);
} 
```

字符串处理代码是因为属性包含许多信息 - 此处指定了确切的详细信息：[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection。 html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-24T19:17:33.103

添加到 NSObject 类别的以下内容可以解决问题。

```
- (Class) classForKeyPath:(NSString*)keyPath {
    Class class = 0;

    unsigned int n = 0;
    objc_property_t* properties = class_copyPropertyList(self.class, &n);
    for (unsigned int i=0; i<n; i++) {
        objc_property_t* property = properties + i;
        NSString* name = [NSString stringWithCString:property_getName(*property) encoding:NSUTF8StringEncoding];
        if (![keyPath isEqualToString:name]) continue;

        const char* attributes = property_getAttributes(*property);
        if (attributes[1] == '@') {
            NSMutableString* className = [NSMutableString new];
            for (int j=3; attributes[j] && attributes[j]!='"'; j++)
                [className appendFormat:@"%c", attributes[j]];
            class = NSClassFromString(className);
        }
        break;
    }
    free(properties);

    return class;
} 
```

# javascript - 如何使用太多嵌套函数优化此代码？

> ID：10687041
> 
> 赞同：2
> 
> 时间：2012-05-21T14:19:41.970
> 
> 标签：javascript, google-chrome, asynchronous, google-chrome-extension

我正在用[socket api](http://code.google.com/chrome/extensions/experimental.socket.html)写一个 Chrome 扩展（虽然这个文档已经过时了，最新版本的 api 在[这里](http://code.google.com/searchframe#OAMlx_jo-ck/src/chrome/common/extensions/api/experimental_socket.idl&type=cs)），我发现代码真的很难组织：

所有方法都在 namespace 下，为了简单起见`chrome.experimental.socket`，我将在`socket`下面使用。

```
socket.create("tcp", {}, function(socketInfo){
    var socketId = socketInfo.socketId;

    socket.connect(socketId, IP, PORT, function(result){
        if(!result) throw "Connect Error";        

        socket.write(socketId, data, function(writeInfo){
            if(writeInfo.bytesWritten < 0) throw "Send Data Error";

            socket.read(socketId, function(readInfo){
                if(readInfo.resultCode < 0) throw "Read Error";
                var data = readInfo.data; // play with the data
                // then send the next request
                socket.write(socketId, data, function(writeInfo){
                    socket.read(socketId, function(readInfo){
                        // ............
                    });
                });
            });
        })
    });
}) 
```

因为`socket.write`和`socket.read`都是异步的，所以我必须嵌套回调以确保在上一个请求得到正确响应之后发送下一个请求。

管理这些嵌套函数真的很难，我该如何改进呢？

**更新**

我想要一个`send`可以用作的方法：

```
send(socketId, data, function(response){
    // play with response
});
// block here until the previous send get the response
send(socketId, data, function(response){
    // play with response
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:27:27.330

（类似的）这个怎么样？

```
var MySocket = {
  obj: null,
  data: null,
  start: function() { ... some code initializing obj data, ending with this.create() call },
  create: function() { ... some code initializing obj data, ending with this.connect() call },
  connect: function() { ... some connection code, ending with this.write() call },
  write: function() { ... some writing code that updates this.data, ending with this.read() call },
  read: function() { ... you probably get the idea at this point )) ... },
}; 
```

这个对象可以`MySocket.start()`和什么一起使用。这个想法是将所有数据（和嵌套调用）封装在单个（但更多或更少全局可用）对象中。

甚至更多，可以创建两个对象：一个纯粹用于写入目的，另一个用于纯粹阅读目的，每个对象都有自己的操作`data`，然后将它们（以及它们之间的调用，可以这么说）包装到单个 SocketManager 对象中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:24:55.237

考虑使用异步延续传递风格，其中函数以 SetInterval 调用结束，调用它们所传递的函数。然后我们构造一个函数，将两个函数缠绕在一起，使用这种机制相互调用。它的胆量是这样的：

```
var handle;
// pairs two functions
function pair(firstfunc, secondfunc, startarg) {
  var callbackToFirst = function(valuetofill) {
    handle = setInterval(firstfunc(valuetofill,callbackToSecond));
  };
  var callbackToSecond = function(valuetofill) {
    handle = setInterval(secondfunc(valuetofill,callbackToFirst));
  };

  callbackToFirst(startarg);
} 
```

我们在这里所做的是构造一对相互调用的回调，它们接受一个参数，每个参数都包含对两个相互调用函数的引用。然后我们通过调用第一个回调来启动该过程。

为示例读取和写入函数对构造该对（假设您已在封闭对象定义中设置了 socketId）：

```
// starts read/write pair, sets internal variable 'handle' to 
//   interval handle for control
function startReadWrite(initialarg, myDataFunc) {
    var readcall = function(value, func) {
        readSocket(getData(myDataFunc(func)));
    };
    var writecall = function(value, func) {
        writeSocket(checkBytesWritten(func));
    };
    handle = pair(readcall, writecall, initialarg);
} 
```

对象的其余部分是这样的：

```
function myIO() {
    var socketInfo, socketId, handle;

    function create(func) {
        socket.create('tcp',{},function(thisSocketInfo) {
            socketInfo = thisSocketInfo;
        }
        setInterval(func(this),0);
    }

    function connect(IP, PORT, func) {
        socket.connect(p_socketId, IP, PORT, function() {
            if(!result) throw "Connect Error";
                setInterval(func(result),0);
            });
    }

    function readSocket(func) {
        socket.read(p_socketId, function(readInfo){ 
            setInterval(func(readInfo),0);
        });
    }

    function writeSocket(data, func) {
        socket.write(p_socketId, data, function(writeInfo){
            setInterval(func(writeInfo),0)
        });
    }

    function checkBytesWritten(writeInfo, func) {
        if(writeInfo.bytesWritten < 0) throw "Send Data Error";
        setInterval(func(writeInfo),0);
    }

    function getData(readInfo, func) {
        if(readInfo.resultCode < 0) throw "Read Error";
        var data = readInfo.data;
        setInterval(func(data),0);
    }

    //** pair and startReadWrite go here **//

} 
```

最后调用设置整个事情：

```
var myIOobj = new myIO();
myIOobj.create(startReadWrite(myDataFunc)); 
```

笔记：

1.  这是为了展示一种风格，而不是准备好的代码！不要只是复制和粘贴它。
2.  不，我没有测试过这个；我做 javascript 但还没有 Chrome API 的东西。我专注于回调机制等。
3.  小心不同类的回调；单参数回调（如读取和写入回调），采用单个值（可能由 API 定义），以及 2 个参数回调（如大多数方法），最后采用一个参数和一个要调用的函数。
4.  getData 方法接受一个回调并传递`data`给它；此回调 (myDataFunc) 是实际使用数据的函数。它需要将回调作为第二个参数并同步或异步调用它。

TLDR：考虑使用异步调用来避免嵌套。我已经给出了一个机制的模糊示例，让两个函数在需要时使用这种风格连续调用对方。

Although I call it asynchonous, the setInterval calls will execute serially, but the key is that the stack is cleared after the parent call is done, rather than adding endless layers with nesting.

# javascript - html5多人游戏建议

> ID：10687044
> 
> 赞同：3
> 
> 时间：2012-05-21T14:19:50.520
> 
> 标签：javascript, html, websocket, socket.io, multiplayer

我希望可以在这里提问，因为它更多的是寻求建议而不是技术问题。

我一直在使用 html5+js 开发游戏，我的目标是让它成为多人游戏。这是一个地牢爬行游戏，我的目的是建立一个主要的村庄，所有在线玩家和村庄里的玩家都可以看到彼此的活动、交谈和组建派对，但是当玩家进入地牢时，他们和他们的派对是一个单独的实例。派对人数最多 4 人。

我的意图是使用 websockets 并用 c# 编写服务器。问题是我刚刚发现 IE 不支持 websockets 并且仍然占据了大约 25% 的浏览器市场份额。

我的选择似乎是无论如何都使用 websockets 并减少 IE 人群，或者可能放弃多人游戏支持。其他人建议我将世界数据写入数据库，让玩家每帧都读取并更新......这听起来很可怕。

我发现这个 socket.io 似乎可以使用 websockets 或以其他方式做同样的事情——但这对我编写服务器有什么影响？如果我使用 websockets 和 socket.io 的 c# 实现，IE 用户可以与我的服务器通信吗？

或者可能还有其他我什至不知道的客户端->服务器通信方式。

老实说，我很想放弃多人游戏的想法！但在我这样做之前，我会向你们寻求关于如何处理这个问题的建议和经验丰富的建议。感谢您抽出宝贵时间，我希望这种问题在这里没问题:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:40:51.383

不要放弃多人游戏的想法！多人游戏更酷。:)

Socket.io 是一个服务器端 JavaScript 库。这意味着您需要[Node JS](http://nodejs.org/)服务器。IE 用户将能够与 Socket.io 服务器对话，因为如果 WebSockets 不可用，它会使用其他协议。例如：FlashSocket 或 XHR 长轮询。最后一种技术在所有支持 XHR 的浏览器中都可用，但效率低下。

socket.io 最大的优势是回退。您可以将其设置为以任何协议（如 WebSockets）开始，如果客户端不支持它，则它会尝试其他协议。这真的很棒，因为您可以使用 WebSockets（它将缓慢但肯定会主导 Web 应用程序）并且仍然可以使用不支持它的浏览器，例如 IE、Opera 或 Safari。我不知道是否有任何其他图书馆具有这种优势。

我不知道任何用于 C# 实时连接的库（我不是 C# 开发人员），但不太可能没有（看看[这个问题](https://stackoverflow.com/questions/9296466/options-for-real-time-web-notifications-and-updates-using-comet-xmpp-vs-websocke)）。另请注意，实时连接需要与普通 HTTP 请求稍有不同的服务器架构，因此您可能需要额外的服务器来处理它们。

此外，我认为 nginx 和 Apache 目前都没有处理 WebSockets（没有一些核心技巧）（但 Node JS 可以！）。不过我不确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:39:13.573

没有理由将自己锁定在平台方面，因为像运输这样简单的事情。对这些事物的支持会随着时间的推移而变化，您将希望尽可能地与它们脱钩。毕竟，您是在制作游戏，而不是网络技术演示。

看看 Orbited/Orbited2 TCPSocket。您可以以任何您喜欢的方式将您的服务器编写为标准 TCP。如果您决定制作本地客户端，这也会让生活更轻松。

# ios - 通过 iOS 通讯簿中的 CardDAV 服务器同步的联系人的单独组

> ID：10687052
> 
> 赞同：1
> 
> 时间：2012-05-21T14:20:18.150
> 
> 标签：ios, contacts, webdav, addressbook

我正在开发一个 CardDAV 服务器（基于 SabreDAV），该服务器将用于同步来自一个组的联系人。

我成功地将我的 CardDAV 帐户添加到 iOS 设置。我的 CardDAV 服务器将一个联系人组添加到地址簿。现在，我只想让属于该组的联系人与我的 CardDAV 服务器同步。

我观察到的行为是添加到“所有联系人”组中的所有联系人也添加到 CardDAV 服务器。是否可以只有一组特定的联系人与远程服务器同步？

iOS 联系人设置中有一个名为“默认帐户”的设置。iOS 似乎总是将“所有联系人”组中的联系人添加到默认服务器。即使我配置了一些帐户，是否可以没有“默认帐户”？

我还注意到我使用 GContact Lite 添加的新组也出现在我的 CardDAV 服务器中。我不希望将新组添加到我的服务器。我应该忽略服务器上的请求吗？在这种情况下，HTTP 响应应该是什么？

# c - 开头双下划线的含义

> ID：10687053
> 
> 赞同：23
> 
> 时间：2012-05-21T14:20:29.117
> 
> 标签：c, linux, gcc, x86-64, glibc

在标准库 (glibc) 中，我看到使用前导双下划线定义的函数，例如`__mmap`in `sys/mman.h`. 什么目的？我们怎么还能调用一个`mmap`似乎没有在任何地方声明的函数。我的意思是我们`sys/mman.h`为此包括，但`sys/mman.h`不声明`mmap`，它只声明`__mmap`。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-21T14:24:16.283

来自 GNU 的手册：

> 除了本手册中记录的名称之外，保留名称还包括以下划线 ('_') 开头的所有外部标识符（全局函数和变量）以及以两个下划线或下划线后跟大写字母是保留名称。这样库和头文件就可以为内部目的定义函数、变量和宏，而不会有与用户程序中的名称发生冲突的风险。

这是 C 和 C++ 供应商也使用的约定。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T14:37:52.837

带有前导双下划线的名称保留供实现内部使用（编译器/标准库/等）。它们不应该出现在您的代码中。这个保留命名空间的目的是为系统头文件提供它们可以使用的名称，而不会与程序中使用的名称发生潜在冲突。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-21T15:31:30.087

ISO 9899:2011

> 7.1.3 保留标识符
> 
> 每个标头声明或定义其相关子条款中列出的所有标识符，并可选地声明或定义其相关的未来库方向子条款中列出的标识符和始终保留用于任何用途或用作文件范围标识符的标识符。
> 
> — 以下划线和大写字母或另一个下划线开头的所有标识符 **始终保留用于任何用途**。
> 
> — 所有以下划线开头的标识符始终保留用作普通和标记名称空间中具有文件范围的标识符。

# dojo - 在 Dojo 中的 EnhancedGrid 顶部插入新添加的 Item

> ID：10687057
> 
> 赞同：1
> 
> 时间：2012-05-21T14:20:53.373
> 
> 标签：dojo, dojox.grid.datagrid

我有一个`EnhancedGrid`绑定到动态商店的。我正在使用延迟加载，因此当我向下滚动时，将获取和绑定更多数据。

我还有一个“添加新项目”功能。这将打开一个弹出窗口，用户在表单中创建新项目，并在保存时将项目添加到商店。和。`dojo.data.ObjectStore.newItem()`_`dojo.data.ObjectStore.save()`

**我的问题，使用这两个功能后，该项目会自动附加到底部**的网格中，这有点令人讨厌。用户必须向下滚动才能找到它，这将触发延迟加载。

在遵循代码之后，我发现`newItem()`调用了该`dojox.grid.DataGrid._addItem(item, index, noUpdate)`函数。

我设法覆盖了它，所以当我添加一个新项目时，_addItem 函数将使用索引 0 调用。但这不起作用，因为它只是用新的替换第一行而不是前置它。

有没有其他的方式来看待这个？有可能真正做到吗？

# python - 解析文件以获得最大值

> ID：10687068
> 
> 赞同：-2
> 
> 时间：2012-05-21T14:21:17.867
> 
> 标签：python, regex

我正在尝试解析文件中包含的一些数据：

```
>in:12 out:8 John

>in:20 out:12 Fred

>in:8 out:2 Danny 
```

我想找到最大值`in`，并找到最大值`in`（弗雷德在我的例子中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:26:40.047

试试这个

```
>in:(\d+) out:\d+ (.*) 
```

第 1 组将包含分数，第 2 组包含名称

您仍然需要在 python 代码中过滤第 1 组的最大值才能获得名称，因为这不是正则表达式的用途。

我不是 python 程序员，但这是一个好的开始

```
for match in re.finditer(r">in:(\d+) out:\d+ (.*)", subject):
# match start: match.start()
# match end (exclusive): match.end()
# matched text: match.group() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:30:50.740

这是一种非标准的数据格式。因此，您必须编写一个非标准解析器（更好的主意是使用像 JSON 这样的标准交换格式并使用标准库中的解析器）。ID

*   使用和属性创建一个`Person`类`in``out`
*   编写一个解析器函数，从输入文件中获取一行，如果该行包含有效数据，则创建一个新的`Person`
*   `Person`从名为`persons`.
*   按升序排序此列表`in`：`persons_sorted = sorted(persons, key=lambda p: p.in)`
*   获得最大值：`max_in_person = persons_sorted[-1]`

# java - 列标题在 Jtable 中不可见

> ID：10687070
> 
> 赞同：0
> 
> 时间：2012-05-21T14:21:19.240
> 
> 标签：java, jtable

使用下面的代码，无法设法让列标题显示..也添加了 Jscroolpane，但没有运气......

```
String[] col = {"COLA","COLB","COLC"};
Object[][] data = {};

DefaultTableModel model = new DefaultTableModel(data,col);

JTable table = new JTable(model);
JScrollPane scrollPane = new JScrollPane(table);

contentPane.add(table);
table.setBounds(295, 11, 512, 411);
contentPane.add(scrollPane,BorderLayout.CENTER); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:26:37.947

当您构造 JScrollPane 时，您将表传递给它，这是它唯一的子组件。但是随后您将表添加到 contentPane，这意味着您将其从 JScrollPane 中删除并将其添加到内容窗格中。不得将表添加到 contentPane。只有滚动窗格，它本身包含表格。

另外，永远不要使用`setBounds()`. 无论如何，这毫无意义，因为您使用的是负责定位组件的布局管理器。在这种情况下，它甚至更有意义，因为表是由 JScrollPane 处理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:39:28.000

这有效：

```
public static void main(String[] args) {
  String[] col = { "COLA", "COLB", "COLC" };
  Object[][] data = { {1, 2, 3}, {4, 5, 6}, {7, 8, 9} };
  DefaultTableModel model = new DefaultTableModel(data, col);
  JTable table = new JTable(model);
  JFrame frame = new JFrame();
  frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
  frame.getContentPane().add(new JScrollPane(table));
  frame.setVisible(true);
} 
```

# java - Findbugs & Ant - 停止特定违规的构建

> ID：10687071
> 
> 赞同：7
> 
> 时间：2012-05-21T14:21:19.683
> 
> 标签：java, ant, findbugs

我正在使用 ANT 构建我的应用程序，并且正在检查我的代码是否存在任何**Findbugs**违规。

现在，我的目标是在我的代码包含特定的 findbug 违规时停止构建。

这可能使用 ANT 和 Findbugs 吗？

注意最好不要写入任何自定义类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:29:16.570

使用[findbugs 任务的 warningsProperty 属性](http://findbugs.sourceforge.net/manual/anttask.html)为任何警告设置属性：

```
<findbugs ... warningsProperty="findbugsFailure"/> 
```

`task`如果产生警告则失败：

```
<fail if="findbugsFailure"> 
```

例如：

```
 <property name="findbugs.home" value="/export/home/daveho/work/findbugs" />

  <target name="findbugs" depends="jar">

    <findbugs home="${findbugs.home}"
              output="xml"
              outputFile="bcel-fb.xml" 
              warningsProperty="findbugsFailure">
      <auxClasspath path="${basedir}/lib/Regex.jar" />
      <sourcePath path="${basedir}/src/java" />
      <class location="${basedir}/bin/bcel.jar" />
    </findbugs>

    <fail if="findbugsFailure">

  </target> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:12:16.710

另一种想法（并且值得努力）是将[Sonar](http://www.sonarsource.org/)集成到您的[ANT 构建](http://docs.codehaus.org/display/SONAR/Analyse+with+Ant+Task)过程中。

Sonar 集成了 Findbugs（以及 checkstyle 和 PMD），您可以使用它的构建断路器插件集中配置它以使构建失败，使其不符合任何标准。看：

[如果违反声纳阈值，我如何让 Hudson/Jenkins 失败？](https://stackoverflow.com/questions/8942960/how-do-i-make-hudson-jenkins-fail-if-sonar-thresholds-are-breeched/8949974#8949974)

# java - 执行 SQLite 查询时未知的记录号

> ID：10687073
> 
> 赞同：0
> 
> 时间：2012-05-21T14:21:22.720
> 
> 标签：java, sqlite

当我执行 SQLite 查询（使用 sqlite4java）时，我遵循逐步执行它并一次获取一行的一般方案。我的最终结果应该是一个二维数组，其长度应该对应于记录的数量。我面临的问题是我事先不知道我的查询要返回多少条记录。所以我基本上将它们存储在一个 ArrayList 中，然后将指针复制到实际的数组中。是否有一种技术可以在完全执行查询之前以某种方式获取查询返回的记录数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:24:15.633

> 我的最终结果应该是一个二维数组，其长度应该对应于记录的数量。

为什么？将结果设为表示“记录”的某个自定义类型`List<E>`通常是一个更好的主意。`E`

听起来您已经在创建一个`ArrayList`- 那么为什么需要一个实际的数组呢？Collections API 通常比直接使用数组更灵活方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:23:59.503

不，如果使用 JDBC。但是，您可以先执行 COUNT() 查询，然后执行真正的查询。

# c - 递归冒泡排序

> ID：10687080
> 
> 赞同：1
> 
> 时间：2012-05-21T14:21:51.550
> 
> 标签：c, recursion, arduino, bubble-sort

我在这方面遇到了一些麻烦。我们基本上被要求创建一个程序的两个版本，对一个包含 50 个项目的数组进行排序，然后在 LED 中显示最大的数字。我已经使用基本的冒泡排序让它工作并显示。我的问题是当我必须使用递归来做到这一点时。不幸的是，我对递归的了解非常有限，因为我错过了关于它的讲座 -.- 他也没有把笔记放到网上。我有一个很长的谷歌但仍然无法理解它。所以我问了几件事。首先，有人可以使用 sedo 代码解释与冒泡排序相关的递归吗？其次，我的尝试完全错了吗？

```
int numbers[49];

void setup()
{                
  pinMode(12, OUTPUT);
  pinMode(11, OUTPUT);
  pinMode(10, OUTPUT);
  pinMode(9, OUTPUT);
  pinMode(8, OUTPUT);
  pinMode(7, OUTPUT);
  pinMode(6, OUTPUT);
  pinMode(5, OUTPUT);
  Serial.begin(9600);
}

void loop()
{
  resetLEDLow();
  genNumbers();
  sortNumbers();
  displayNumber();
  delay(5000);
}

void resetLEDLow()
{
  digitalWrite(12, LOW);
  digitalWrite(11, LOW);
  digitalWrite(10, LOW);
  digitalWrite(9, LOW);
  digitalWrite(8, LOW);
  digitalWrite(7, LOW);
  digitalWrite(6, LOW);
  digitalWrite(5, LOW);
}

void genNumbers()
{
  for( int i = 0 ; i < 50 ; i++ )
  {
    numbers[i] = random(256);
  }
}

void sortNumbers()
{
  int sizeOfArray = sizeof(numbers)/sizeof(int);
  int check = 1;
  if( check != 0 )
  {
    check = 0;
    for( int i = 0 ; i < sizeOfArray ; i++ )
    {
      for ( int j = 1 ; j < sizeOfArray ; j++ )
      {
        if( numbers[j-1] > numbers[j] )
        {
          int temp = numbers[j-1];
          numbers[j-1] = numbers[j];
          numbers[j] = temp;
          check++;
        }
      }
    }
    sortNumbers();
  }
}

void displayNumber()
{   
   int i = 12;
   int a = numbers[49];
   Serial.println(numbers[49]);
   while ( a > 0 )
   {
     int num = a % 2;
     a = a / 2;
     if( num == 1 )
     {
       digitalWrite(i, HIGH);
     }else{
       digitalWrite(i, LOW);
     }
     i--;
   }
} 
```

我知道代码不起作用，因为当它循环时，循环计数被重置为 1，所以条件永远不会为真，这意味着它将永远循环循环。那么，我需要改变什么，或者我所做的根本不是递归？

真的需要一些帮助，让我的大脑转来转去。

编辑：这是我对新递归的尝试。我已删除与问题无关的代码。

```
void loop()
{
  int topLevel = 0;
  int currentSort = 0;
  int sizeOfArray = sizeof(numbers)/sizeof(int);
  int numbers[49];
  sortNumbers(topLevel,currentSort,sizeOfArray,numbers);
}

int sortNumbers(p,c,l,numbers)
{
 // Swap if they are in the wrong order
 if( numbers[c-1] > numbers[c] )
 {
   int temp = numbers[c-1];
   numbers[c-1] = numbers[c];
   numbers[c] = temp;
 }
 // If we have finished this level and need to go to next level
 if( c == l )
 {
   c = 0;
   p++;
 }
 // Finished
 if( p == l+1 )
 {
   return numbers;
 }
 // Continue to the next place
 return sortNumbers(p,c+1,l, numbers);
} 
```

> Sort50Rec:-1: 错误: 'p' 未在此范围内声明 Sort50Rec:-1: 错误: 'c' 未在此范围内声明 Sort50Rec:-1: 错误: 'l' 未在此范围内声明 Sort50Rec: -1：错误：未在此范围内声明“数字”Sort50Rec：-1：错误：初始化表达式列表被视为复合表达式 Sort50Rec.cpp：在函数“无效循环（）”中：Sort50Rec：19：错误：“数字”未在此范围内声明 Sort50Rec:21：错误：“sortNumbers”不能用作函数 Sort50Rec.cpp：在函数“void genNumbers()”中：Sort50Rec:42：错误：“数字”未在此范围内声明 Sort50Rec .cpp：在全局范围内：Sort50Rec：46：错误：重新定义“int sortNumbers”Sort50Rec：-1：错误：“int sortNumbers”之前在这里定义 Sort50Rec：46：错误：'p' 未在此范围内声明 Sort50Rec：46：错误：'c' 未在此范围内声明 Sort50Rec：46：错误：'l' 未在此范围内声明 Sort50Rec：46：错误：' numbers' 未在此范围内声明

我确信其中一部分是我命名我的函数的方式，我认为你只能返回一个值是对的吗？或不？

编辑：修正错误指出新错误。

```
 void loop()
{
  int topLevel = 0;
  int currentSort = 0;
  int numbers [49];
  int sizeOfArray = sizeof(numbers)/sizeof(int);
  numbers = sortNumbers(topLevel,currentSort,sizeOfArray,numbers);
}

int sortNumbers(int p,int c,int l,int numbers)
{
 // Swap if they are in the wrong order
 if( numbers[c-1] > numbers[c] )
 {
   int temp = numbers[c-1];
   numbers[c-1] = numbers[c];
   numbers[c] = temp;
 }
 // If we have finished this level and need to go to next level
 if( c == l )
 {
   c = 0;
   p++;
 }
 // Finished
 if( p == l+1 )
 {
   return numbers;
 }
 // Continue to the next place
 return sortNumbers(p,c+1,l, numbers);
} 
```

> Sort50Rec.cpp：在函数'void loop（）'中：Sort50Rec：19：错误：从'int *'到'int'的无效转换Sort50Rec：19：错误：初始化'int sortNumbers（int，int，int， int)' Sort50Rec：19：错误：将'int'分配给'int [49]'时的类型不兼容 Sort50Rec.cpp：在函数'void genNumbers（）'中：Sort50Rec：40：错误：'numbers'未在这个范围Sort50Rec.cpp：在函数'int sortNumbers（int，int，int，int）'中：Sort50Rec：47：错误：数组下标Sort50Rec：47的无效类型'int [int]'：错误：无效类型'int [ int]' 用于数组下标 Sort50Rec:49：错误：无效类型 'int[int]' 用于数组下标 Sort50Rec:50：错误：无效类型 'int[int]' 用于数组下标 Sort50Rec:50：错误：数组下标 Sort50Rec:51 的无效类型“int [int]”：错误：数组下标 Sort50Rec.cpp 的无效类型“int [int]”：在函数“void displayNumber（）”中：Sort50Rec：71：错误：“数字”在这方面没有申明

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:15:42.360

您有一个导致无限循环的冗余检查。

```
void sortNumbers()
{
  ...
  int check = 1;
  if( check != 0 )
  {
    ...
    sortNumbers();
  }
} 
```

现在，由于这显然是家庭作业，我将提供一些一般性建议。通常，您使用递归来缩小特定大小的问题。找出问题的哪一部分在每次迭代中变得更小，并让每次迭代都成为递归调用而不是循环（提示：这意味着您可能希望将一些值传递给方法以告诉您大小和/或当前迭代的位置）。请记住在方法开始时或在递归检查问题的大小之前进行检查。

* * *

```
void loop()
{
  int topLevel = 0;
  int currentSort = 0;
  /* You never initialize this - what's supposed to be in it? */
  int numbers [49];
  int sizeOfArray = sizeof(numbers)/sizeof(int);
  /* Two things here: you're passing an array (numbers) in where the 
     sortNumbers() function has it declared as an int;
     and the return value is declared as an int, but you're storing it 
     into an array. */
  numbers = sortNumbers(topLevel,currentSort,sizeOfArray,numbers);
}

/* You're going to have to change this method signature - you're working 
   with arrays, not plain ints. You're changing numbers[] inline, so you 
   don't need to return anything. */
int sortNumbers(int p,int c,int l,int numbers)
{
 /* The first iteration has c = 0, so [c-1] is going to be out-of-bounds. 
    Also, when c = l, [c] will be out of bounds. */
 if( numbers[c-1] > numbers[c] )
 {
   int temp = numbers[c-1];
   numbers[c-1] = numbers[c];
   numbers[c] = temp;
 }
 if( c == l )
 {
   c = 0;
   p++;
 }
 if( p == l+1 )
 {
   return numbers;
 }
 return sortNumbers(p,c+1,l, numbers);
} 
```

这不是我的想法，但我相信一旦你解决了我指出的问题（可能还有一些我错过了），它应该会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-25T13:48:58.610

```
def bubbleSort(myArray, lenArray):

    if lenArray==1:
        return myArray

    else:
        for i in range(len(myArray)-1):
            if (myArray[i]>myArray[i+1]):
                myArray[i], myArray[i+1] = myArray[i+1], myArray[i]
        return bubbleSort(myArray, lenArray-1)

myArray= [2,3,56,7]
lenArray= len(myArray)
print(bubbleSort(myArray, lenArray)) 
```

# asp.net-mvc - 每个浏览器选项卡的 MVC 持久模型

> ID：10687083
> 
> 赞同：2
> 
> 时间：2012-05-21T14:22:08.773
> 
> 标签：asp.net-mvc, model-view-controller, model, tabs, persist

我有一个 MVC 应用程序，但在使用现代多选项卡浏览器时遇到了问题。

我有一个创建模型并将其存储在 this.TempData["MyViewModel"] 中的屏幕

然后我在第二个选项卡中打开同一个屏幕，并在它调用相同的控制器方法时再次设置 this.TempData["MyViewModel"]。

如果我然后返回选项卡 1 并刷新页面，我会看到我在选项卡 2 中输入的数据。

有没有办法在 TempData 每个浏览器选项卡中唯一地存储数据？

我玩弄了创建唯一 TempData 键并使用查询字符串或隐藏字段在请求之间保留它的想法，但这看起来很混乱。

任何想法/建议都将受到欢迎。:o)

* * *

到目前为止，我所拥有的是“ProcessID”的概念。

在我的第一个部分视图中，我有一个带有隐藏字段的表单，该字段松散地绑定到我的 Model.ProcessID。发布表单时，此隐藏字段 ProcessID 用作 TempData 键...

例子：

```
public sealed class MyViewModel
{
    public MyViewModel()
    {
        this.ProcessID = Guid.NewGuid().ToString();
    }

    public string ProcessId { get; set; }
    // other fields
} 
```

局部视图 1：

```
@model Models.MyViewModel

@using (Ajax.BeginForm("PartialView1", "Home", new { }, new AjaxOptions() { UpdateTargetId = "myDivToUpdate" }, new { }))
{
    @Html.HiddenFor(m => m.ProcessId);

    // other fields...

    <input type="submit" value="next" />
}

public ActionResult PartialView1(FormCollection form)
{
    return this.PartialView("PartialView1", new Models.MyViewModel());
}

[HttpPost]
public ActionResult PartialView1(FormCollection form)
{    
    Models.MyViewModel vm = new Models.MyViewModel();    

    this.UpdateModel(vm, form);

    this.TempData[vm.ProcessId] = vm;

    return this.PartialView("PartialView2", vm);
} 
```

在我的第二个局部视图表单中，我再次有一个隐藏字段松散地绑定到同一个 Model.ProcessID。发布此表单后，我可以使用 Model.ProcessID 从 TempData 检索我的视图模型并更新它：

局部视图 2：

```
@model Models.MyViewModel

@using (Ajax.BeginForm("PartialView2", "Home", new { }, new AjaxOptions() { UpdateTargetId = "myDivToUpdate" }, new { }))
{
    @Html.HiddenFor(m => m.ProcessId);

    // other fields (different to partial view 1)...

    <input type="submit" value="finish" />
}

[HttpPost]
public ActionResult PartialView2(FormCollection form, Models.MyViewModel vm)
{
    vm = (this.TempData[vm.ProcessId] as Models.MyViewModel);

    this.UpdateModel(vm, form);

    return this.Json(new { result = true, message = "success" }, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:12:12.580

默认情况下，我相信 MVC 使用会话状态来使用 SessionStateTempDataProvider 存储 TempData，因此每个 TempData 都将存储在该会话的同一位置。我能看到的唯一使用 session 是按照您的建议使用一些标识符。

但是，您可以实现 ITempDataProvider 接口以使用您自己的提供程序，然后该提供程序可以将此数据存储在某种其他形式的存储中（例如 cookie 或 sql）。

# ios - 在 iOS 上，如果主视图具有 UITapGestureRecognizer，则不会调用按钮操作。如何让它发挥作用？

> ID：10687086
> 
> 赞同：1
> 
> 时间：2012-05-21T14:22:29.137
> 
> 标签：ios, uiview, interface-builder, uigesturerecognizer, uitapgesturerecognizer

在一个使用 Xcode 4.3.2 的全新 iOS 项目中，如果一个按钮有一个使用 Interface Builder 创建的 Action，并且它打印出来`"button is tapped on"`，那么一切正常。

但是，当主视图为单击添加时`UITapGestureRecognizer`，即使点击了按钮，也会认为主视图被点击，但不会调用按钮 Action。

有没有办法使这项工作？（是否建议不要使用Button Action，而是使用UITapGestureRecognizer作为按钮？但如果是滑块，那么我们确实需要Action）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:28:20.460

排除`[UIGestureRecognizer delegate]`或设置`cancelsTouchesInView`为中的按钮`NO`。

# c# - 通过调用方法将字符串传递给属性参数

> ID：10687091
> 
> 赞同：3
> 
> 时间：2012-05-21T14:22:42.487
> 
> 标签：c#, .net, nunit

我正在尝试使用 NUnit 并将字符串参数传递给 TestCase 属性，但我得到*“属性参数必须是属性参数类型的常量表达式、类型表达式或数组创建表达式”*

这是一个简化版本，但 MyStatic 是一个返回构建的 RegEx 字符串的调用，因此 MyStatic 中被调用的每个方法都附加到一个字符串构建器并隐式转换为字符串。

我想保留这种方法，因为如果我创建单独的单元测试，我将违反 DRY 原则。

```
 [TestCase("","/123",MyStatic.DoThis().And().GetString("ABC"), "id","123")]
  public void MyMehthod(string Root, string Path, string Route, string Param, string Expected)
  {
    var result = SetupRouteResponse(Root, Path, Route, "MatchIt");

    Assert.AreEqual(Expected, (string)result.Context.Parameters[Param]);
  } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T14:24:41.967

尝试对这些参数使用 TestCaseSource：[http ://www.nunit.org/index.php?p=testCaseSource&r=2.5.9](http://www.nunit.org/index.php?p=testCaseSource&r=2.5.9)

文档中的示例：

```
 [Test, TestCaseSource("DivideCases")]
 public void DivideTest(int n, int d, int q)
 {
    Assert.AreEqual( q, n / d );
 }

 static object[] DivideCases =
 {
    new object[] { 12, 3, 4 },
    new object[] { 12, 2, 6 },
    new object[] { 12, 4, 3 } 
 }; 
```

在你的情况下：

```
 [Test, TestCaseSource("MyCaseSource")]
 public void MyMehthod(string Root, string Path, string Route, string Param, string Expected)
 {
   var result = SetupRouteResponse(Root, Path, Route, "MatchIt");

   Assert.AreEqual(Expected, (string)result.Context.Parameters[Param]);
 }

 static object[] MyCaseSource=
 {
    new object[] { "","/123",MyStatic.DoThis().And().GetString("ABC"), "id","123" },
 }; 
```

# javascript - javascript不工作innerhtml

> ID：10687092
> 
> 赞同：-1
> 
> 时间：2012-05-21T14:22:44.027
> 
> 标签：javascript, asp.net, html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Loja do Munícipe</title>
    <link rel="stylesheet" type="text/css" href="<%= stCSSFile %>" />
    <link href="../styles/cmm/main.css" rel="stylesheet" type="text/css" />
    <script language="javascript">

       function getbrowser () {
            var browser_info = {
                name: null,
            };

            if (navigator && (navigator.userAgent.toLowerCase()).indexOf("chrome") > -1) browser_info.name = "chrome";
            else if (navigator && (navigator.userAgent.toLowerCase()).indexOf("msie") > -1) browser_info.name = "ie";
            else if (navigator && (navigator.userAgent.toLowerCase()).indexOf("firefox") > -1) browser_info.name = "firefox";
            else if (navigator && (navigator.userAgent.toLowerCase()).indexOf("msie") > -1) browser_info.name = "other";

            if (browser_info.name == "ie" || browser_info.name =="firefox")
            {
            var linkinst = document.getElementById("ccbox");
                linkinst.innerHTML = "<div class=\"citizenCardCtr\" onmouseover=\"this.style.cursor='pointer';\" onclick=\"redirect();\"><h2>Autenticação com cartão do cidadão</h2> <p>Para escolher esta opção terá de ter em sua posse:</p><ul> <li>- Cartão do Cidadão;</li> <li>- Leitor do cartão, correctamente instalado no seu computador;</li> <li>- PIN da assinatura digital;</li> <li>- PIN da morada.</li></ul></div>";
                }
            else if (browser_info.name == "chrome")
                {
                var linkinst = document.getElementById("ccbox");
                linkinst.innerHTML = "<div class=\"citizenCardCtr\" onmouseover=\"this.style.cursor='pointer';\"><h2>Autenticação com cartão do cidadão</h2> <p> Esta funcionalidade não está desponivel no seu browser </div>";
                }

            }
    </script>
    <style type="text/css">
        .stylenumber
        {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <form id="form1" runat="server">

    <div id="mainCtr">
            <div class="boxesCtr">
                <div id="ccbox" style="font-size: 12px; color: #574529; font-family: Verdana; text-align:justify;"></div> 
            </div>
    </div>
    </form>
</body>
</html> 
```

该`getbrowser`功能不起作用...当我加载页面时，带有 id="ccbox" 的 div 在 IE、Chrome 或 Firefox 中不显示任何文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:27:58.847

尝试在定义之前添加`getbrowser`：

```
window.onload = getbrowser; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:28:29.500

`getbrowser`尝试在函数定义的正下方添加：

```
window.onload=getbrowser; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:32:39.960

在定义 getbrowser 之前添加这个`window.onload=getbrowser;`

所以它看起来像这样。

```
<script language="javascript">
window.onload=getbrowser;
function getbrowser () { 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-05-21T14:27:37.793

将您的脚本放在页脚中。它会起作用的。

# java - JAVA_HOME 和 java -version

> ID：10687093
> 
> 赞同：18
> 
> 时间：2012-05-21T14:22:48.820
> 
> 标签：java, version, environment-variables, java-home

我正在使用 Windows .bat 脚本，我设置`JAVA_HOME`为`C:/Program Files/Java/jdk1.6.0_32` 当我执行 a 时`java -version`，它仍然显示 1.3

我怎样才能解决这个问题？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2017-02-10T10:41:54.577

对我来说，问题出在我的 PATH 变量中，`C:\ProgramData\Oracle\Java\javapath;`是由 java windows install 在我的`%JAVA_HOME%\bin;`. 所以我会`echo %JAVA_HOME%`指向一个JDK7并`java -version`显示jdk8。

我要放在`%JAVA_HOME%\bin;`前面`C:\ProgramData\Oracle\Java\javapath;`，以便`java -version`显示 jdk7。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-21T14:27:34.347

尝试`%JAVA_HOME%\bin\java -version`

如果您修改`JAVA_HOME`，通常最好`java`使用绝对路径调用（使用`JAVA_HOME`），因为新的二进制文件可能不在路径中（然后 Windows 将加载错误的二进制文件）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-21T14:25:13.177

确保`PATH`环境变量指向`%JAVA_HOME%\bin`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-24T21:20:55.797

一定不要混用系统变量路径和用户变量系统路径。在没有绝对路径的情况下调用我感觉很好`java`（当我知道如何配置时）`JAVA_HOME`。`PATH`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T14:26:45.110

`java -version`从命令行调用，会导致 cmd.exe 对“已知”目录进行查找。“已知”表示 PATH 环境变量。您的 PATH 似乎包含一个 java 1.3`bin`文件夹，而不是 1.6。

JAVA_HOME 是另一个变量，它被（例如，但不仅是）java 包装器使用，或者被执行一些java 东西的脚本使用。

尝试这样做：

```
SET JAVA_HOME=C:/Program Files/Java/jdk1.6.0_32
%JAVA_HOME%/bin/java -version 
```

在需要的地方添加引号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-11T10:26:37.397

今天有一个类似的场景 - 两个 Windows 10 设备 - 都有 JRE 1.6 和 1.7。

打字的时候

```
 Java -version 
```

一台设备显示 1.6，另一台显示 1.7。

这阻止了我运行第三方 JAR 在显示 1.6 的设备上安装一些软件（在运行 java -version 时在显示 1.7 的设备上运行良好），使用：

```
 java -jar ThirdParty.jar 
```

因为 JAR 需要由 1.7 运行。

原因是在 PATH 环境变量中 - 一个设备在 PATH 列表中的第一个位置是 1.6，将 1.7 位置移动到 1.6 位置上方导致使用 Java 版本的一致性，并允许我安装软件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-06T15:40:29.053

我有类似的问题，就我而言，我安装了两个版本的 java。它可以通过从系统中完全卸载一个版本的 java 来修复。

# tsql - tsql 动态 where

> ID：10687097
> 
> 赞同：1
> 
> 时间：2012-05-21T14:23:03.810
> 
> 标签：tsql

我正在为这个程序而苦苦挣扎。

如果是周一到周四，我希望​​一切都提前 90 天；

```
SELECT 
        PR.ClientID
        ,PR.NewDealEndDate
    INTO 
      #OriginalRenewalDetails
    FROM  
        Shiva.dbo.ProductRemortgage PR WITH (NOLOCK) 
        LEFT JOIN Shiva.dbo.ClientLead AS CL WITH (NOLOCK) 
        ON CONVERT(VARCHAR(50), CL.OriginatorReferenceID) = CONVERT(VARCHAR(50), PR.ClientID)
    WHERE -- 90 days from now. 
        PR.NewDealEndDate = DATEADD(dd, 90, DATEDIFF(dd, 00, GETDATE()))            
        AND CL.ClientID IS NULL 
```

但是，如果是星期天，我希望在 Where 子句中进行以下更改。这样我也能得到周五和周六的结果。

```
WHERE -- 90 days from now. 
    PR.NewDealEndDate BETWEEN DATEADD(dd, 88, DATEDIFF(dd, 00, GETDATE())) AND DATEADD(dd, 90, DATEDIFF(dd, 00, GETDATE()))
    AND CL.ClientID IS NULL 
```

我找不到这样做的有效方法。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:26:04.430

使用`IF`.

伪：

```
if day = sunday
begin
   select with 88
end
else 
begin
   select with 90
end 
```

* * *

或将 WHERE 子句更改为：

```
WHERE (PR.NewDealEndDate = DATEADD(dd, 90, DATEDIFF(dd, 00, GETDATE()))
       AND CL.ClientID IS NULL AND Datepart(weekday, getdate()) <> 1)
      OR
      (PR.NewDealEndDate BETWEEN DATEADD(dd, 88, DATEDIFF(dd, 00, GETDATE())) 
       AND DATEADD(dd, 90, DATEDIFF(dd, 00, GETDATE()))
       AND CL.ClientID IS NULL
       AND Datepart(weekday, getdate()) = 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:35:30.100

您可以执行以下操作：

```
SELECT PR.ClientID
        , PR.NewDealEndDate
INTO #OriginalRenewalDetails
FROM Shiva.dbo.ProductRemortgage PR WITH (NOLOCK) 
LEFT JOIN Shiva.dbo.ClientLead AS CL WITH (NOLOCK) 
    ON CONVERT(VARCHAR(50), CL.OriginatorReferenceID) = CONVERT(VARCHAR(50), PR.ClientID)
WHERE CL.ClientID IS NULL
AND
(
    (
        PR.NewDealEndDate = DATEADD(dd, 90, DATEDIFF(dd, 00, GETDATE()))
        AND  Datepart(weekday, getdate()) <> 1 -- 1 is Sunday
    )
    OR
    (
        PR.NewDealEndDate BETWEEN DATEADD(dd, 88, DATEDIFF(dd, 00, GETDATE())) 
        AND DATEADD(dd, 90, DATEDIFF(dd, 00, GETDATE()))
        AND Datepart(dayofweek, getdate()) = 1
    )
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:41:16.127

```
declare @adjustment int--SELECT DATEPART(weekday, getdate()) 
set @adjustment =
CASE 
    WHEN DATEPART(weekday, getdate()) 
    in (1,2,3,4,5) THEN 90     
ELSE 88
END

WHERE  
    PR.NewDealEndDate BETWEEN DATEADD(dd, @adjustment... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T14:45:27.500

这里不需要动态 SQL 或两个单独的查询。`**DAY = SUNDAY**`用您当前用于确定星期天的任何逻辑替换该部分：

```
WHERE PR.NewDealEndDate BETWEEN DATEADD(DAY, 
    CASE WHEN **DAY = SUNDAY** THEN 88 ELSE 90 END, 
    DATEDIFF(DAY, 0, GETDATE())) AND DATEADD(DAY, 90, DATEDIFF(dd, 0, GETDATE()))
AND CL.ClientID IS NULL; 
```

您还可以事先计算范围，例如

```
DECLARE @start SMALLDATETIME, @end SMALLDATETIME;

SET @end = DATEADD(DAY, 90, DATEDIFF(DAY, 0, GETDATE()));
SET @start = CASE WHEN **DAY = SUNDAY** THEN DATEADD(DAY, -2, @end) ELSE @end END;

WHERE PR.NewDealEndDate BETWEEN @start END @end
AND CL.ClientID IS NULL; 
```

# javascript - 如何测试 URL 字符串是绝对的还是相对的？

> ID：10687099
> 
> 赞同：94
> 
> 时间：2012-05-21T14:23:29.520
> 
> 标签：javascript, jquery, string, url

如果 URL 是 Javascript 或 jQuery 中的相对或绝对路径，我如何测试它？我想根据传入的 URL 是本地路径还是外部路径进行相应处理。

```
if (urlString starts with http:// or https://)
 //do this 
```

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2013-10-31T14:57:07.580

## 快速地

如果您只需要测试`http://`or`https://`那么*最有效*的方法是：

```
if (urlString.indexOf('http://') === 0 || urlString.indexOf('https://') === 0) 
```

* * *

## 普遍的

但是，我会建议一种*更通用、不区分大小写、与协议无关的*方法：

```
var r = new RegExp('^(?:[a-z]+:)?//', 'i');
r.test('http://example.com'); // true - regular http absolute URL
r.test('HTTP://EXAMPLE.COM'); // true - HTTP upper-case absolute URL
r.test('https://www.exmaple.com'); // true - secure http absolute URL
r.test('ftp://example.com/file.txt'); // true - file transfer absolute URL
r.test('//cdn.example.com/lib.js'); // true - protocol-relative absolute URL
r.test('/myfolder/test.txt'); // false - relative URL
r.test('test'); // false - also relative URL 
```

* * *

### 解释正则表达式

```
^(?:[a-z]+:)?// 
```

`^`- 字符串的
`(?:`开头 - 未捕获组的开头
`[a-z]+`- 'a' 到 'z' 的任何字符 1 次或多次
`:`- 字符串（冒号字符）
`)?`- 未捕获组的结尾。组出现 0 或 1 次
`//`- 字符串（两个正斜杠字符）
`'i'`- 不区分大小写标志

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-05-21T14:27:00.213

```
var pat = /^https?:\/\//i;
if (pat.test(urlString))
{
    //do stuff
} 
```

对于协议相对 url，使用这个正则表达式：

`/^https?:\/\/|^\/\//i`

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-08-16T15:44:42.570

# 原始答案

一个非常**快速**且非常**灵活**的检查是：

```
if (url.indexOf('://') > 0 || url.indexOf('//') === 0 ) {
    // URL is absolute; either "http://example.com" or "//example.com"
} else {
    // URL is relative
} 
```

这将识别绝对 URL，如果：

*   URL 在第一个字符*之后*的任何位置都包含“://” ，或者
*   URL 以“//”开头（相对于协议）

* * *

*   没有正则表达式。
*   没有 jQuery 或其他依赖项。
*   没有使条件区分大小写的硬编码协议名称。
*   没有字符串操作（例如 toLowerCase 或类似的）。
*   仅检查“相对或绝对”但不进行任何其他健全性检查，可用于 Web URL 或任何内部协议。

* * *

# 更新 1（全功能示例）

这是一个返回给定 URL 的 true/false 的快速**函数**：

```
function isUrlAbsolute(url) { 
    return (url.indexOf('://') > 0 || url.indexOf('//') === 0);
} 
```

在 ES6 中也一样：

```
const isUrlAbsolute = (url) => (url.indexOf('://') > 0 || url.indexOf('//') === 0) 
```

* * *

# 更新 2（URL 参数内的 URL）

`/redirect?target=http://example.org`要以我建议使用以下代码的格式另外处理 URL ：

```
function isUrlAbsolute(url) {
    if (url.indexOf('//') === 0) {return true;} // URL is protocol-relative (= absolute)
    if (url.indexOf('://') === -1) {return false;} // URL has no protocol (= relative)
    if (url.indexOf('.') === -1) {return false;} // URL does not contain a dot, i.e. no TLD (= relative, possibly REST)
    if (url.indexOf('/') === -1) {return false;} // URL does not contain a single slash (= relative)
    if (url.indexOf(':') > url.indexOf('/')) {return false;} // The first colon comes after the first slash (= relative)
    if (url.indexOf('://') < url.indexOf('.')) {return true;} // Protocol is defined before first dot (= absolute)
    return false; // Anything else must be relative
} 
```

简写形式和 ES 6 相同

```
// Traditional JS, shortened
function isUrlAbsolute(url) {
    return url.indexOf('//') === 0 ? true : url.indexOf('://') === -1 ? false : url.indexOf('.') === -1 ? false : url.indexOf('/') === -1 ? false : url.indexOf(':') > url.indexOf('/') ? false : url.indexOf('://') < url.indexOf('.') ? true : false;
}

// ES 6
const isUrlAbsolute = (url) => (url.indexOf('//') === 0 ? true : url.indexOf('://') === -1 ? false : url.indexOf('.') === -1 ? false : url.indexOf('/') === -1 ? false : url.indexOf(':') > url.indexOf('/') ? false : url.indexOf('://') < url.indexOf('.') ? true : false) 
```

以下是一些测试用例：

```
// Test
console.log( isUrlAbsolute('http://stackoverflow.com') ) // -> true
console.log( isUrlAbsolute('//stackoverflow.com') ) // -> true
console.log( isUrlAbsolute('stackoverflow.com') ) // -> false
console.log( isUrlAbsolute('Ftp://example.net') ) // -> true
console.log( isUrlAbsolute('/redirect?target=http://example.org') ) // -> false 
```

* * *

# 更新 3（澄清相对 URL）

我看过一些关于无效输出的评论：

*   *解决方案返回 false`localhost`*
*   *答案失败`http:example.com`*

但是，**这些 URL 确实是相对 URL**。很容易测试：

> 1.  在您的 localhost webroot 上创建一些文件夹，比如说`a/b/c/`
> 2.  创建一个 index.html 文件并将以下链接放入其中：`<a href="localhost">test</a>`
> 3.  在浏览器中打开索引页面：[http://localhost/a/b/c/index.html](http://localhost/a/b/c/index.html)并单击链接。您将以[http://localhost/a/b/c/localhost](http://localhost/a/b/c/localhost)结束（而不是[http://localhost](http://localhost)）
> 4.  将链接`http:example.com`放入 index.html 文件时也会发生同样的情况。您以[http://localhost/a/b/c/example.com](http://localhost/a/b/c/example.com)而不是[http://example.com结束](http://example.com)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2019-07-15T22:12:40.393

根据您的需要，我认为确定这一点的更可靠方法是使用[内置 URL 接口](https://developer.mozilla.org/en-US/docs/Web/API/URL)来构造几个 URL 对象并比较来源。

```
new URL(document.baseURI).origin === new URL(urlToTest, document.baseURI).origin; 
```

这允许浏览器为您解析和计算所有这些，而不必担心边缘情况的副作用。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-05-21T14:25:49.200

使用正则表达式：

```
if (/^(?:[a-z]+:)?\/\//i.test(url)) 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2015-08-13T15:00:20.020

# 更通用的符合 RFC 的 URI 方法：

`(?:^[a-z][a-z0-9+\.-]*:|\/\/)` [正则表达式解释](https://regex101.com/r/nR2yL6/3)

此处列出的其他解决方案对于以下链接将失败`mailto:evan@nylas.com`

**RFC 3986**将**方案**定义为：

`scheme = ALPHA *( ALPHA / DIGIT / "+" / "-" / "." )`

**3.1。方案** [https://www.rfc-editor.org/rfc/rfc3986#section-3.1](https://www.rfc-editor.org/rfc/rfc3986#section-3.1)

虽然根据第 4.2 节，相对协议的 url 在技术上是有效的，但 Paul Irish 却反过来认为这是一种反模式。见[http://www.paulirish.com/2010/the-protocol-relative-url/](http://www.paulirish.com/2010/the-protocol-relative-url/)

**4.2\. 相对参考** [https://www.rfc-editor.org/rfc/rfc3986#section-4.2](https://www.rfc-editor.org/rfc/rfc3986#section-4.2)

如果您想要不使用相对协议 url 的正则表达式：

`^[a-z][a-z0-9+\.-]*:`

要查看其他类型的有效 uri 边缘情况的完整列表，请在此处查看列表：[https ://en.wikipedia.org/wiki/URI_scheme](https://en.wikipedia.org/wiki/URI_scheme)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-10-30T19:23:22.193

现在，当很多服务使用[协议相对 URL](https://stackoverflow.com/questions/4831741/can-i-change-all-my-http-links-to-just)（例如*//cdn.example.com/libary.js*）时，这种方法更安全：

```
var isAbsolute = new RegExp('^([a-z]+://|//)', 'i');

if (isAbsolute.test(urlString)) {
  // go crazy here
} 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2014-01-30T16:43:36.747

不要使用正则表达式等低级的东西。这些东西已经被很多其他人解决了。特别是边缘情况。

看看[URI.js](http://medialize.github.io/URI.js/)，它应该可以完成这项工作：[http ://medialize.github.io/URI.js/docs.html#is](http://medialize.github.io/URI.js/docs.html#is)

```
var uri = new URI("http://example.org/");
uri.is("absolute") === true; 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-08-12T10:34:46.377

您可以使用 try, catch 块来帮助解决此问题。您可以在每一步都使用[URL](https://developer.mozilla.org/en-US/docs/Web/API/URL)界面，而不是使用正则表达式。

```
isExternalUrl (urlString) {
  try {
    const url = new URL(urlString) // THROW ON MISSING SCHEME

    // DOES THIS URL ORIGINATE FROM THIS WEBSITE?
    if (url.origin !== new URL(document.URL, document.baseURI).origin) {
      return true // IS EXTERNAL URL
    }
  } catch (_e) {
    // THROWS WHEN URL DOES NOT HAVE A SCHEME
    new URL(urlString, document.baseURL) // THROW AN EXCEPTION IF THE URL IS TRULY MALFORMED IN SOME WAY
  }

  return false
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-11-21T16:36:32.710

这是浏览器环境的一个非常强大的解决方案：

**让浏览器处理一切。**不需要一些复杂/容易出错的正则表达式。

```
const isAbsoluteUrl = (url) => {
  const link = document.createElement('a');
  link.href = url;
  return link.origin + link.pathname + link.search + link.hash === url;
}; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-05-21T14:29:44.593

```
var external = RegExp('^(https?:)?//');
if(external.test(el)){
    // do something
} 
```

编辑：

使用下一个正则表达式，您甚至可以检查链接是指向同一个域还是指向外部域：

```
var external = RegExp('^((f|ht)tps?:)?//(?!' + location.host + ')');
if(external.test(el)){
    // do something
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-05-21T14:27:58.977

```
var adress = 'http://roflmao.com';
if (adress.substr(0,7) == 'http://' || adress.substr(0,8) == 'https://') {
    //
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-11-29T21:45:16.657

上述解决方案都没有解决`redirect_url`黑客进入的黑客攻击`/\/example.com`或`/\\/example.com`. 这是我想出来确定我们的重定向 url 是否是相对的：

```
var isRelative = !redirectUrl.match(/(\:|\/\\*\/)/);  // Don't allow "//" (with optional "\"'s) or ":" 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-05-14T19:19:15.733

它不应该以斜杠或哈希开头，如果前面没有问号或哈希，它不应该包含双斜杠？我不会用一个正则表达式来测试它，匹配“没有双斜杠”会非常复杂。

```
function test(s) {
    return s.charAt(0) != "#"
      && s.charAt(0) != "/"
      && ( s.indexOf("//") == -1 
        || s.indexOf("//") > s.indexOf("#")
        || s.indexOf("//") > s.indexOf("?")
    );
} 
```

会更容易，更清晰，恕我直言更快。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-10-16T15:44:48.210

当超链接上发生单击事件时将调用以下函数，即“a”标签如果标签包含 url 将是相对的或包含相同的主机，那么新页面将被加载到相同的浏览器选项卡中，如果它包含不同的 url，则页面将加载在新的浏览器选项卡中

```
jQuery(document).ready(function() {
    $('a').click(function(){

        var a = this;
        var a_href = $(this).attr('href');
        var regex = new RegExp('^(?:[a-z]+:)?//', 'i');     

        if(a.host == location.host || regex.test(a_href) == false){
            a.target = '_self';
        }else{
            a.target = '_blank';
        }
    }); 
}); 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2016-09-13T12:53:11.290

```
var isExternalURL = url.toLowerCase().indexOf('http://') === 0 || url.toLowerCase().indexOf('https://') === 0 ; 
```

# javascript - 如何编写这个 javascript 正则表达式？

> ID：10687101
> 
> 赞同：0
> 
> 时间：2012-05-21T14:23:31.113
> 
> 标签：javascript, regex

我正在尝试使用 javascript 运行正则表达式检查，以确保字符串遵循模式：

NNNN-NN-NN

（其中 N = 0-9 的任何数字）我需要确保破折号也到位。

因此，任何 4 个数字后跟一个破折号，然后是任何 2 个数字，然后是一个破折号，然后是任意两个数字。

我如何将其写为正则表达式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T14:25:05.010

这里是：

```
^[0-9]{4}-[0-9]{2}-[0-9]{2}$ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T14:29:24.423

最简单的正则表达式就是：

```
/^\d{4}-\d\d-\d\d$/ 
```

[`\d\d`短于`\d{2}`]

你不能忘记锚定正则表达式，否则它将匹配*包含*该模式的所有字符串，而不仅仅是那些完全匹配的字符串。

为了额外的好处，如果您打算随后提取这三个组件，请使用以下命令：

```
var re = /^(\d{4})-(\d\d)-(\d\d)$/;
var test = "1234-56-78";
var vals = test.match(re);

// vals = ['1234-56-78', '1234', '56', '78']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:28:58.137

\d{4}-\d{2}-\d{2} 我认为这相当简洁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T14:26:27.520

```
\d{4}(-\d{2}){2} 
```

我认为上面的正则表达式是合适的。

# crystal-reports - 从 Crystal Reports XI 导出时不使用显示字符串公式

> ID：10687109
> 
> 赞同：0
> 
> 时间：2012-05-21T14:24:01.127
> 
> 标签：crystal-reports, export, crystal-reports-xi, export-to-csv

我在 Crystal Reports XI 中生成了一份报告，其中我在其中一个字段中使用了显示字符串公式来更改某些数据的外观，并将相似的数据值分组为一个值（例如“neg”、“negative”、和“-”现在在报告中都显示为“负面”。）

但是，现在当我将报告导出为 CSV 以交付给客户时，原始数据而不是显示字符串公式结果在导出中。我已经使用 CSV 导出选项中的复选框尝试了所有 4 种设置。

有什么方法可以将显示字符串格式化的数据导出到 CSV？
是否有任何替代方法可以实现所需的格式并在 CSV 导出中保留格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:44:29.743

不幸的是，我还没有找到使用显示字符串公式并达到预期结果的方法。

而是创建一个新公式并将报表上的对象替换为新公式。

大号

# javascript - 数字不断变化

> ID：10687112
> 
> 赞同：0
> 
> 时间：2012-05-21T14:24:13.217
> 
> 标签：javascript

我想通过从 49 个数字中选择 6 个数字来更改数字，所以首先我声明了一个 div 并在其中有六个跨度来包含一个数字。

我想通过 getElementByTagName 对其进行更改，以分配一个与 setInterval 相结合的新数字，使其始终在更改，但它不起作用。

我错在哪里？

谢谢。

```
function computeRandom(){

var value = new Array(49);//declare array

    for ( i = 0; i < 49; i++ )//initial array_value
        value[i] = i+1;

    for ( i = 0 ;i < 100; i++ ) {//random arrange
        x = parseInt(Math.random()*49);
        y = parseInt(Math.random()*49);
        tmp = value[x];
        value[x] = value[y];
        value[y] = tmp;     
    }

var color = new Array(49);

    for ( i = 0; i < 49; i++ )//store color
        color[i] = "rgb(" + parseInt(Math.random()*255) + "," + parseInt(Math.random()*255) + "," + parseInt(Math.random()*255) + ")";      

    var value_tmp = new Array(6);

    for( i = 0; i < 6; i++)
        value_tmp[i] = value[i];

    document.write("<div style = \"text-align:center;\" >");//center the text by div

        for( i = 0; i < 6; i++)
            document.write("<span  style = \"font-size: 2.5em; display:inline-block; text-align:center; width: 1.5em; background: white; color: " + color[i] + " \" > " 
            + value_tmp[i] + "</span>&nbsp&nbsp&nbsp&nbsp&nbsp");

    var spanArray = document.getElementsByTagName("span");

    setInterval("keepMove(value,spanArray)",10);
    }

function keepMove(val,sp){  

var index = parseInt(Math.random()*43);//set a increment to avoid repeatition

for( i = 0; i < sp.length; i++){
    sp[i].innerHTML = val[i+index];
    document.write(sp[i].innerHTML+"  ");
}
} 
```

CSS：

```
#bg {
background: grey;
opacity: 0.8;
}

#hl {
text-align: center;
color: white;
} 
```

HTML：抱歉，我不知道如何发布 HTML？ [http://codepad.org/IrSOsjg7](http://codepad.org/IrSOsjg7)

我已经尝试了评论者的建议，但仍然无效，但谢谢您的帮助！我非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:32:37.233

我认为问题是`setInterval("keepMove(value,spanArray)",10)`

当你传递一个字符串作为 的第一个参数时`setInterval`，它就像 `eval`那个字符串，并且代码将在全局环境中运行，因为没有变量`value`并且`spanArray`在全局环境中，代码将无法正确运行。

例如：

```
function foo(x, y) {
    alert(x + " " + y);
}

function bar() {
    var x = 100, y = 200;

    setInterval("foo(x, y)", 1000);
}

bar(); 
```

这将得到错误`x is not defined`

你可以试试：

```
setInterval(function(){
    keepMove(value, spanArray);
}, 10); 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:37:58.820

尝试改变你使用 setInterval 的方式。您应该使用闭包来访问 value 和 spanArray 变量。

```
setInterval(function(value, spanArray) { 
        return function() {
            keepMove(value,spanArray)
        }
    }(value, spanArray),10);
} 
```

那是因为 setTimeout 将在全局上下文中执行，并且从那里你不能访问那些私有变量。

# java - 如何创建脚本来重新启动 JAR 文件并在终端中获取输出？

> ID：10687115
> 
> 赞同：1
> 
> 时间：2012-05-21T14:24:20.620
> 
> 标签：java, bash, shell, jar

我使用以下脚本来启动和停止 jar 文件。

```
**start.sh**
#!/bin/bash
nohup nice java -jar Server.jar > ./Server.out 2>&1 &

**stop.sh**
#!/bin/bash
kill `ps -ef | grep Server.jar | grep -v grep | awk '{ print $2 }'` 
```

现在我想合并两个脚本并创建一个新的重启脚本。我还希望在终端而不是文本文件（Server.out）中输出此脚本。

将不胜感激任何类型的输入/帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:28:59.803

您可以将两个 scipt 的命令放在一起（`kill`第一个，`java`第二个），也可以按适当的顺序调用两个 scipt。

这个想法是重启基本上相当于杀死当前正在运行的版本并开始一个新的。

为避免输出到文件，请移除该`> ./Server.out`部分。

编辑：删除了关于删除重定向部分的注释，因为我误读了脚本的`grep`一部分`kill`

更新：错过了`nohup`脚本的一部分：`nohup`您*需要*将输出重定向到文件，因为该进程与终端分离（请参阅[文档](http://linux.die.net/man/1/nohup)）。如果您*确实*想在终端中查看输出，请删除`nohup`以及重定向到文件

# ruby - Ruby - 使用 RestClient 上传文件

> ID：10687120
> 
> 赞同：3
> 
> 时间：2012-05-21T14:24:43.933
> 
> 标签：ruby, curl, rest-client

我有一个 cURL，我正在尝试将其翻译成 Ruby。

卷曲是这样的：

```
curl -i -k -H "Accept: application/json" -H "Authorization: token" -H "Content-Type: image/jpeg" -H "Content-Length: 44062" --data-binary "gullfoss.jpg" http://www.someurl.com/objects 
```

我的 Ruby 代码是这样的：

```
image = File.read('uploads/images/gullfoss.jpg')
result = RestClient.post('http://www.someurl.com/objects',image,{'upload' => image, 'Accept' => 'application/json', 'Authorization' => 'token', 'Content-Type' => 'image/jpeg', 'Content-Length' => '44062'}) 
```

Ruby 代码给了我一个 400 Bad Request。这不是授权或其他标头的问题。我认为问题在于将 --data-binary 转换为 Ruby。

任何帮助表示赞赏。

谢谢，阿德里安

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-04T07:04:58.427

有几件事可能会导致问题。

1.  你想使用一个实际的`File`对象`RestClient`，所以使用`File.open`; 它返回一个文件对象。
2.  您在请求中包含两次图像对象；您的问题并未明确说明实际内容。例如，您正在将有效负载元素与标头混合。根据`RestClient.post`带有 arguments的签名`url, payload, headers={}`，您的请求应采用以下两种形式之一：

端点是否需要命名参数？如果是这样，请使用以下内容：

**技术 1：**有效载荷包含一个名为“上传”的字段或参数，并将值设置为图像对象

```
result = RestClient.post(
  'http://www.someurl.com/objects',
  { 'upload' => image },
  'Accept' => 'application/json',
  'Authorization' => 'token',
  'Content-Type' => 'image/jpeg',
) 
```

端点是否需要简单的文件上传？如果是这样，那么使用：

**技术 2：**图像文件对象作为唯一的有效载荷发送

```
result = RestClient.post(
  'http://www.someurl.com/objects',
  image,
  'Accept' => 'application/json',
  'Authorization' => 'token',
  'Content-Type' => 'image/jpeg',
) 
```

请注意，我没有包含`'Content-Length'`标题；使用时通常不需要这样做，`RestClient`因为它会在处理文件时为您插入。

还有另一种发送有效载荷的方法，[这里](https://stackoverflow.com/questions/11388090/ruby-rest-client-file-upload-as-multipart-form-data-with-basic-authenticaion)`RestClient`有解释。

请务必阅读[github 上的官方文档](https://github.com/rest-client/rest-client)。

我也是新手，`RestClient`所以如果我在这种情况下错了，请不要太苛刻；我会立即纠正我的任何误解。希望这可以帮助！

# jquery - jQuery 使用 AND 和 OR 运算符按属性选择

> ID：10687131
> 
> 赞同：111
> 
> 时间：2012-05-21T14:25:23.907
> 
> 标签：jquery, jquery-selectors, find, operators

我正在考虑，是否可以在 jQuery 中通过使用 AND 和 OR 的命名属性来选择元素。

例子：

```
<div myid="1" myc="blue">1</div>
<div myid="2" myc="blue">2</div>
<div myid="3" myc="blue">3</div>
<div myid="4">4</div> 
```

我想选择所有元素，`myc="blue"`但只有那些`myid`设置为 1 或 3 的元素。

所以我尝试了：

```
a=$('[myc="blue"] [myid="1"]  [myid="3"]'); 
```

但它不起作用，这里也一样：

```
a=$('[myc="blue"] && [myid="1"] || [myid="3"]'); 
```

是否可以不编写特殊的过滤器功能？

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2012-05-21T14:27:39.127

**与**运算

```
a=$('[myc="blue"][myid="1"][myid="3"]'); 
```

**OR**操作，使用逗号

```
a=$('[myc="blue"],[myid="1"],[myid="3"]'); 
```

正如@Vega 评论的那样：

```
a=$('[myc="blue"][myid="1"],[myc="blue"][myid="3"]'); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-21T14:31:03.783

[*使用多重选择器*](http://api.jquery.com/multiple-selector/)[^([docs])](http://api.jquery.com/multiple-selector/) (OR)简单地使用[`.filter()` *^([docs])*](http://api.jquery.com/filter/) (AND )：[](http://api.jquery.com/multiple-selector/)

 *```
$('[myc="blue"]').filter('[myid="1"],[myid="2"]'); 
```

一般来说，链接选择器，就像`a.foo.bar[attr=value]`是某种 AND 选择器。

jQuery 有关于支持的选择器的[大量文档](http://api.jquery.com/category/selectors/)，值得一读。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-21T14:27:34.050

写一个像下面这样的过滤器怎么样，

```
$('[myc="blue"]').filter(function () {
   return (this.id == '1' || this.id == '3');
}); 
```

**编辑：** @Jack 谢谢.. 完全错过了..

```
$('[myc="blue"]').filter(function() {
   var myId = $(this).attr('myid');   
   return (myId == '1' || myId == '3');
}); 
```

[**演示**](http://jsfiddle.net/skram/j8kpB/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-21T14:29:41.117

选择器中的 and 运算符只是一个空字符串，而 or 运算符是逗号。

但是，没有分组或优先级，因此您必须重复其中一个条件：

```
a=$('[myc=blue][myid="1"],[myc=blue][myid="3"]'); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-05-21T14:33:12.713

先找出所有情况下出现的条件，然后过滤特殊条件：

```
$('[myc="blue"]')
    .filter('[myid="1"],[myid="3"]'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-21T14:30:35.327

在您的特殊情况下，它将是

```
a=$('[myc="blue"][myid="1"],[myc="blue"][myid="3"]'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-21T14:27:39.507

JQuery 使用 CSS 选择器来选择元素，因此您只需使用多个规则，用逗号分隔它们，如下所示：

```
a=$('[myc="blue"], [myid="1"], [myid="3"]'); 
```

编辑：

抱歉，你想要蓝色和 1 或 3。怎么样：

```
a=$('[myc="blue"][myid="1"],  [myid="3"]'); 
```

将两个属性选择器放在一起给出 AND，使用逗号给出 OR。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-21T14:28:26.413

要使用您所说的逻辑操作正确选择元素，您只需要`jQuery.filter()`操作`AND`，而不是“特殊过滤器功能”。您还需要`jQuery.add()`进行`OR`操作。

```
var elements = $('[myc="blue"]').filter('[myid="1"').add('[myid="3"'); 
```

或者，可以在单个选择器中使用速记来完成，其中干扰选择器一起充当 an `AND`，用逗号分隔充当`OR`：

```
var elements = $('[myc="blue"][myid="1"], [myid="3"]'); 
```*

# google-maps - Google 信息窗口关闭按钮在移动设备中不起作用

> ID：10687133
> 
> 赞同：1
> 
> 时间：2012-05-21T14:25:33.253
> 
> 标签：google-maps, google-maps-api-2

我正在使用以下代码创建自定义信息窗口

```
function format(j,x,q,o,y,g,l,i,n,u){var nn="",uu="",mm=27,m=21,c="Tab2",d="",k="",v="",p="",t="",e="",b="",a="",f="",r,w=6,h=null,s=null;if(u.length==0){c="Tab4"}if(o!=null){if(o.indexOf("?")>0){o=o.substring(1,o.indexOf("?"))}}
y=replaceAll(y,'^','');g=replaceAll(g,'^','');l=replaceAll(l,'^','');y=replaceAll(y,"&amp;amp;","&");g=replaceAll(g,"&amp;amp;","&");l=replaceAll(l,"&amp;amp;","&");y=replaceAll(y,"&amp;","&");g=replaceAll(g,"&amp;","&");l=replaceAll(l,"&amp;","&");y=replaceAll(y,'\\','');g=replaceAll(g,'\\','');l=replaceAll(l,'\\','');
var yyy=replaceAll(y,"'","`");var ggg=replaceAll(g,"'","`");var lll=replaceAll(l,"'","`");y=replaceAll(y,"&quot;","\"");g=replaceAll(g,"&quot;","\"");l=replaceAll(l,"&quot;","\"");
if(y.length>m){v="<a style='cursor:pointer; color:#353535;' onmouseout='UnTip()' onmouseover=\"Tip('&lt;div class=&quot;leftBuble&quot;&gt;&lt;div class=&quot;rightBuble&quot;&gt;&lt;div class=&quot;midBgBuble&quot;&gt;"+yyy+"&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;')\"><b>"+y.substring(0,(m-4)).toUpperCase()+"...</b></a>";}else{d=y.toUpperCase();v="<b>"+d+"</b>"}
if(g.length>m){e="<a style='cursor:pointer; color:#353535;' onmouseout='UnTip()' onmouseover=\"Tip('&lt;div class=&quot;leftBuble&quot;&gt;&lt;div class=&quot;rightBuble&quot;&gt;&lt;div class=&quot;midBgBuble&quot;&gt;"+ggg+"&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;')\">"+g.substring(0,(m-4)).toUpperCase()+"...</a>";}else{p=g;e=p}
if(l.length>m){f="<a style='cursor:pointer; color:#353535;' onmouseout='UnTip()' onmouseover=\"Tip('&lt;div class=&quot;leftBuble&quot;&gt;&lt;div class=&quot;rightBuble&quot;&gt;&lt;div class=&quot;midBgBuble&quot;&gt;"+lll+"&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;')\">"+l.substring(0,(m-4)).toUpperCase()+"...</a>";}else{b=l;f=b}if(ie6){r="margin:-2px 7px 0 0;";w=5}else{if(ie7){r="margin: 2px 11px 0 0;"}else{if(moz||saf||op){r="margin:2px 10px 0 0;"}else{r="margin: 2px 11px 0 0;"}}}
if(u.length!=0){if(u.length>mm){uu="";}else{uu="";}s='<tr><td style="font:normal 10px Arial; color:#353535;padding:0 0 10px 0;" align="left"><table  border="0" cellpadding="0" cellspacing="0"><tr><td></td><td style="padding:0 0 0 6px;">'+uu+"</td></tr></table></td></tr>"}else{s="<tr><td></td></tr>"}
if(n.length!=0){if(n.length>mm){nn="<a style='cursor:pointer; color:#353535; text-decoration:none;' href='javascript:void(0);' onclick=\"javascript:"+c+"('Tab3.aspx?locationid="+i+"');UnTip();\" onmouseout='UnTip()' onmouseover=\"Tip('&lt;div class=&quot;leftBuble&quot;&gt;&lt;div class=&quot;rightBuble&quot;&gt;&lt;div class=&quot;midBgBuble&quot;&gt;"+n+"&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;')\">"+n.substring(0,mm-3)+"...</a>";}else{nn="<a title='"+n+"' href='javascript:void(0)' onclick=\"javascript:"+c+"('Tab3.aspx?locationid="+i+"');\" style='text-decoration:none;'>"+n+"</a>";}h='<tr><td style="font:normal 10px Arial; color:#353535; padding:0 0 2px 0;"><table border="0" cellpadding="0" cellspacing="0"><tr><td><img src="images/arrow.PNG" alt=""/></td><td style="padding:0 0 0 6px;"><a title="'+n+'" href="javascript:void(0)" onclick="javascript:'+c+"('Tab3.aspx?locationid="+i+'\')" style="text-decoration:none;">'+nn+"</a></td></tr></table></td></tr>"}else{h="<tr><td></td></tr>"}return'<div style="width: 202px; height:238px; padding:4px 3px 0 3px; background-image: url(images/map_popwindow.PNG); background-repeat: no-repeat; font:normal 11px/14px Arial; color:#353535;" class="estyle2"><table style="width: 100%" border="0" cellpadding="0" cellspacing="0"><tr><td colspan="5" align="left" valign="top" style="padding:0 0 0 1px;" ><div align="center" id="divPlayer1" name="divPlayer1"><div id="imageName1" name="imageName1"><img src="'+q+'"/></div></div><img src="images/map_closebuttom.PNG" alt="" style="z-index:99; position:absolute; top:1px; right:0px; border:solid 3px #fff; cursor:pointer;'+r+'" onclick="javascript:void closeInfo();" /></td> </tr><tr><td style="width: 21px; height: 30px; padding:3px 0 0 12px;"  valign="top"><img src="'+o+'" style="border:none; width: 21px; height: 27px;" alt="" /></td><td style="width: 151px; padding:0 3px 0 9px;"><table style="width: 100%" border="0" cellpadding="0" cellspacing="0"><tr><td style="padding:9px 0 5px 0;">'+v+"</td></tr><tr><td>"+e+'</td></tr><tr><td style="padding:1px 0 6px 0;">'+f+"</td></tr>"+h+s+"</table></td></tr></table></div>"}; 
```

和下面的代码弹出窗口

```
function b(k,L,M,K){var J=new GMarker(k,L);GEvent.addListener(J,"click",function(){map.panTo(k);ew.openOnMarker(J,M);});if(K==true){map.addOverlay(J);ew.openOnMarker(J,M)}return J}for(var D=0;D<q;D++){var r=new GIcon(G_DEFAULT_ICON);r.image=baseURL+"images/mme_dealer_marker"+f[D][0]+".png";r.shadow="";r.iconSize=new GSize(29,56);r.iconAnchor=new GPoint(0,58);f[D][9]=replaceAll(f[D][9],"&amp;","&");f[D][9]=replaceAll(f[D][9],"&quot;","\"");markerOptions={icon:r,clickable:true,title:f[D][0]+". "+f[D][9]};var v=format(f[D][1],f[D][2],f[D][3],f[D][4],f[D][5],f[D][6],f[D][7],f[D][8],x,H);var B=new GLatLng(f[D][1],f[D][2]);if(D==(p-1)){map.addOverlay(b(B,markerOptions,v,true))}else{map.addOverlay(b(B,markerOptions,v,false))}}}} 
```

保存以下网址可以下载详细的javascript

[http://m3imobile.mydiamondlink.net/m3imobile/list.aspx?city=berlin&postcode=&radius=30&point=52.519171,13.4060912&Services=&pageno=1&flag=0](http://m3imobile.mydiamondlink.net/m3imobile/list.aspx?city=berlin&postcode=&radius=30&point=52.519171,13.4060912&Services=&pageno=1&flag=0)

所有这些在桌面浏览器中都可以正常工作，但关闭按钮在移动浏览器中不起作用。谁能帮我解决这个问题。

这可以使用上面的 URL 在移动设备中进行测试

# c# - WinForm 启动画面和焦点

> ID：10687134
> 
> 赞同：1
> 
> 时间：2012-05-21T14:25:37.993
> 
> 标签：c#, winforms, focus, splash-screen

我为 WinForm 应用程序创建了一个非常基本的启动画面。

应用程序必须在加载时连接到数据库，所以我创建了一个像这样的 OnLoad 方法：

```
private void MainForm_OnLoad(object sender, EventArgs e)
{
    SplashScreen.ShowSplashScreen();
    PerformConnection();
    SplashScreen.CloseSplashScreen();
} 
```

闪屏是一种简单的形式。ShowSplashScreen 方法创建表单并显示它，CloseSplashScreen 关闭表单。

一切似乎都正常，除了当启动屏幕关闭时，主窗体失去焦点并被先前选择的窗口隐藏。

我不明白为什么，也不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:31:00.000

尝试调用[激活](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activate.aspx)后`SplashScreen.CloseSplashScreen();`

```
MainForm.Activate(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:34:45.747

你应该做不同的事情。启动画面可以在主窗体之前调用，这就是你可以做到的（代码如下）。通过使用 DialogResult.OK，将代码返回到 Program 类，并继续创建（和打开）Form1（您的主窗体）。

```
static class Program
{
    [STAThread]
    static void Main()
    {
        using (SplashScreen sp = new SplashScreen())
        {
            sp.StartPosition = FormStartPosition.CenterScreen;
            if (login.ShowDialog() == DialogResult.OK)
            {
                Application.Run(new Form1()); 
            }
        }
    }
}

public partial class SplashScreen : Form
{
    public SplashScreen()
    {
        InitializeComponent();
        DoTheWork();
    }

    private void DoTheWork()
    {
        //...
        //and on the end
        this.DialogResult = DialogResult.OK;
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T14:35:20.380

注册您`Form`的[`OnShown`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.onshown.aspx)事件并调用将[`TopMost`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.topmost.aspx)标志设置为 true：

```
form1.OnShown += OnShownHandler;

private void OnShownHandler(EventArgs e)
{
    form1.TopMost = true;
} 
```

# checkbox - 在 Inno 设置中的许可证向导页面上用复选框替换单选按钮

> ID：10687135
> 
> 赞同：2
> 
> 时间：2012-05-21T14:25:39.110
> 
> 标签：checkbox, radio-button, custom-controls, inno-setup, wizard

是否有任何简单的方法可以在不创建自定义页面的情况下用 Inno Setup 中的单个（选中/未选中）复选框替换许可证向导页面上的标准 2 个单选按钮？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T14:46:45.270

由于没有设置可以在许可证单选按钮和某些许可证复选框之间切换（至少只是因为 上没有它的组件`WizardForm`），您需要自己创建它。

以下代码隐藏了原始许可证单选按钮，并在向导初始化时的同一位置创建了一个复选框。此许可证复选框正在模拟其`OnClick`事件处理程序中的单选按钮选择以保持其原始功能。这是代码，它允许您访问向导初始化事件范围之外的许可证复选框。如果您以后不需要访问此复选框，您可以使用[`this version`](https://stackoverflow.com/revisions/10687494/2)该帖子：

```
[code]

var
  LicenseCheckBox: TNewCheckBox;

procedure OnLicenseCheckBoxClick(Sender: TObject);
var
  LicenseAccepted: Boolean;
begin
  LicenseAccepted := (Sender as TNewCheckBox).Checked;
  WizardForm.LicenseAcceptedRadio.Checked := LicenseAccepted;
  WizardForm.LicenseNotAcceptedRadio.Checked := not LicenseAccepted;
end;

procedure InitializeWizard;
begin
  WizardForm.LicenseAcceptedRadio.Hide;
  WizardForm.LicenseNotAcceptedRadio.Hide;

  LicenseCheckBox := TNewCheckBox.Create(WizardForm);
  LicenseCheckBox.Parent := WizardForm.LicensePage;
  LicenseCheckBox.Left := 0;
  LicenseCheckBox.Top := WizardForm.LicenseMemo.Top + 
    WizardForm.LicenseMemo.Height + 8;
  LicenseCheckBox.Width := WizardForm.LicenseMemo.Width;
  LicenseCheckBox.Caption := ' I accept the license agreement';
  LicenseCheckBox.OnClick := @OnLicenseCheckBoxClick;
end; 
```

# php - jQuery 手风琴菜单扩展页面长度

> ID：10687140
> 
> 赞同：2
> 
> 时间：2012-05-21T14:26:05.873
> 
> 标签：php, javascript, wordpress, jquery-plugins

所以我有一个 jQuery 手风琴菜单，我想在我的 wordpress 主页上实现它，问题是每次我把菜单放在那里时，它都会将我的页面向下扩展 1200 像素高度，而且它是唯一一个这样做的。

我怎样才能阻止它声明那个高度，让我准确地确定菜单延伸了多长时间，或者甚至更好地使用它一次。同样，我在谈论一个 wordpress 插件。

我想在其中实现菜单的主题是：[http ://themeforest.net/item/celta-business-modern-corporate-wordpress-theme/full_screen_preview/218824?ref=lvraa](http://themeforest.net/item/celta-business-modern-corporate-wordpress-theme/full_screen_preview/218824?ref=lvraa)

左栏

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T10:55:52.373

首先，您应该尝试将[autoHeight 设置为 false](http://jqueryui.com/demos/accordion/#no-auto-height)，这将解决高度问题。

然后我可以找到有关 HTML 列表的问题，我抓取了您的 HTML，将其放在本地并使用了jQuery UI 手风琴的[演示源](http://jqueryui.com/demos/accordion/)（第 3 节里面有一些 HTML 列表），它似乎工作正常。

希望它会有所帮助:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T03:06:29.423

我们都需要您的代码来查看实际问题。你可以jsfiddle它。另外，尝试制作`autoHeight`to `false`。

`$(".yourselector" ).accordion({ autoHeight: false });`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T01:07:04.087

当您初始化手风琴时，包括`autoHeight: false`在选项中。然后它将使用每个 div 中指定的本机高度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T19:44:53.987

要克服这个问题，您必须设置如下两个属性：-

```
$( ".selector" ).accordion({ autoHeight: false }); 
```

和

```
$( ".selector" ).accordion({ clearStyle: true }); 
```

参考 -[官方 jQuery 手风琴文档](http://docs.jquery.com/UI/Accordion)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-28T01:36:57.393

如果不知道您使用的是哪个手风琴插件，就不可能给您一个确定的答案。提供一个展示您的问题的 URL 对您非常有帮助。

如果您使用的是[jQuery UI Accordion](http://docs.jquery.com/UI/Accordion)，您可以尝试：

1.  初始化手风琴，将[autoHeight](http://docs.jquery.com/UI/Accordion#option-autoHeight)设置为`false`.
2.  明确设置手风琴容器的高度。例如：

    > <style>
    > #accordion {
    > height:200px !important;
    > }
    > </style>
    > <div id="accordion">...</div>

3.  [将fillSpace](http://docs.jquery.com/UI/Accordion#option-fillSpace)设置为 true初始化手风琴，然后显式设置手风琴父元素的高度。

如果您正在使用其他库或者您自己开发了手风琴功能，请告诉我们您正在使用哪个库并与我们分享您的代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-27T15:14:07.127

您需要更改`autoHeight`为`false`. 这样做可能会降低动画质量，但应该可以解决高度问题。

它是由手风琴占据最大 div 的高度引起的。更多关于它的信息：http: [//docs.jquery.com/UI/Accordion#option-autoHeight](http://docs.jquery.com/UI/Accordion#option-autoHeight)

`$( ".selector" ).accordion({ autoHeight: false });`

# python - Jenkins Python API 和多配置项目

> ID：10687141
> 
> 赞同：4
> 
> 时间：2012-05-21T14:26:12.597
> 
> 标签：python, jenkins, multi-configuration

我在 Jenkins 中建立了一个多配置项目，我正在尝试通过命令行脚本管理这些作业。我正在尝试为此使用 jenkinsapi Python 模块。到目前为止，我已经找到了获得工作的方法，但我不知道如何获得特定的构建配置以查看它们是否成功。

```
from jenkinsapi.jenkins import *
jenkins = Jenkins('http://example.org/jenkins')
job = jenkins.get_job('foobar')

# I can get job info here, but I don't know how to access specific configurations 
```

有没有办法做到这一点？多配置项目中的每一个是单独的“工作”还是都归为同一个工作？将来我将不得不管理许多此类项目，并且我希望能够轻松地将新的硬件配置添加到构建中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:06:37.777

我认为 Python JenkinsAPI 不适合使用 Matrix 作业。通过[Groovy 插件](https://wiki.jenkins-ci.org/display/JENKINS/Groovy+plugin)使用 Groovy 脚本来接入[Jenkins Java API](http://javadoc.jenkins-ci.org/)。

矩阵类位于[hudson.matrix](http://javadoc.jenkins-ci.org/hudson/matrix/package-summary.html)模块中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-21T04:25:05.253

不太清楚你想要什么，给一些提示。

如果您不清楚可以从`job`API 中的对象获取哪些信息，可以使用以下方法检查

**查看**github中的源代码，你的情况是[job.py](https://github.com/salimfadhley/jenkinsapi/blob/master/jenkinsapi/job.py)，你也可以使用python`dir()`方法查看你可以调用哪个`job`

```
>>> from jenkinsapi.jenkins import *
>>> jenkins = Jenkins('http://localhost')
>>> job = jenkins.get_job('foobar')
>>> dir(job)
['RETRY_ATTEMPTS', '__class__', '__delattr__', '__dict__', '__doc__', '__eq__', '__format__', '__getattribute__', '__get
item__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__s
izeof__', '__str__', '__subclasshook__', '__weakref__', '_buildid_for_type', '_config', '_data', '_element_tree', '_get_
config_element_tree', '_mk_json_from_build_parameters', '_poll', '_revmap', '_scm_map', '_scmbranchmap', '_scmurlmap', '
baseurl', 'delete_from_queue', 'disable', 'enable', 'get_build', 'get_build_dict', 'get_build_ids', 'get_build_triggerur
l', 'get_buildnumber_for_revision', 'get_config', 'get_config_xml_url', 'get_data', 'get_delete_url', 'get_description',
 'get_downstream_job_names', 'get_downstream_jobs', 'get_first_build', 'get_first_buildnumber', 'get_jenkins_obj', 'get_
last_build', 'get_last_build_or_none', 'get_last_buildnumber', 'get_last_completed_build', 'get_last_completed_buildnumb
er', 'get_last_failed_buildnumber', 'get_last_good_build', 'get_last_good_buildnumber', 'get_next_build_number', 'get_pa
rams', 'get_params_list', 'get_queue_item', 'get_rename_url', 'get_revision_dict', 'get_scm_branch', 'get_scm_type', 'ge
t_scm_url', 'get_upstream_job_names', 'get_upstream_jobs', 'invoke', 'is_enabled', 'is_queued', 'is_queued_or_running',
'is_running', 'jenkins', 'load_config', 'mk_json_from_build_parameters', 'modify_scm_branch', 'modify_scm_url', 'name',
'poll', 'python_api_url', 'strip_trailing_slash', 'update_config']
>>> print job.get_last_build()
foobar #5 
```

**直接查看配置**，点击job底部的REST API `foobar`，可以直接获取job配置如[http://example.org/jenkins/job/foobar/api/json?pretty=true](http://example.org/jenkins/job/foobar/api/json?pretty=true)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-29T04:03:09.263

我发现处理多/矩阵配置的最简单方法是将其作为作业加载。配置的 .../api/python 数据与普通作业完全相同。所以我们可以像访问它一样访问它，只需对 api 进行一些更改。

编辑 jenkinsbase.py 中的**process_job_folder函数**

和 **job.py**中的 get_full_name_from_url_and_baseurl

编辑 api 代码或仅覆盖函数。（有点难看但有效^_^）

我还对名称的显示方式做了一些小改动。这样命名更符合：jobs，“sub”？作业和配置

例如：

作业名称/作业名称/配置

```
import urlparse
from jenkinsapi import job
from jenkinsapi import jenkins

def process_job_folder(self, folder, folder_path):
    folder_path += '/job/%s' % folder['name']
    data = self.get_data(self.python_api_url(folder_path),
                         tree='jobs[name,color]')
    result = []
    for job in data.get('jobs', []):
        if 'color' not in job.keys():
            result += self.process_job_folder(job, folder_path)
        else:
            job['url'] = '%s/job/%s' % (folder_path, job['name'])
            ## Added to prevent name conflicts
            job['name'] = folder['name'] + "/" + job['name']
            result.append(job)
            ## Added configuration support
            configData = self.get_data(self.python_api_url(job['url']),
                                       tree='activeConfigurations[name,color,url]')
            for config in configData.get("activeConfigurations", []):
                config['url'] = '%s/%s' % (job['url'], config["name"])
                config["name"] = job['name'] + "/" + config["name"]
                result.append(config)
            ## End of edit
    return result

@staticmethod
def get_full_name_from_url_and_baseurl(url, baseurl):
    """
    Get the full name for a job (including parent folders) from the
    job URL.
    """
    path = url.replace(baseurl, '')
    split = path.split('/')
    ## Ignore /job and empty strings
    split = [urlparse.unquote(part) for part in split[::] if not part in ["", "job"]]
    ## End of edit
    return '/'.join(split)

jenkins.JenkinsBase.process_job_folder = process_job_folder
job.Job.get_full_name_from_url_and_baseurl = get_full_name_from_url_and_baseurl

def get_server_instance():
    jenkins_url = SERVER_URL
    server = jenkins.Jenkins(jenkins_url,
                     username = USERNAME, password = PASSWORD_OR_API_KEY,
                     ssl_verify=False,
                     timeout=50)
    return server

s = get_server_instance()
for j in s.get_jobs():
    print j 
```

*编辑：

现在你可以这样做：

```
s = get_server_instance()
myJobName = "foobar/platform=x64"
j = s.get_job(myJobName)

latestBuild = j.get_last_build()
print "Latest build number: ",latestBuild.get_number()
print "\tLatest build status: ",latestBuild.get_status() 
```

# c++ - QtCreator - 使用静态 dll 库

> ID：10687143
> 
> 赞同：1
> 
> 时间：2012-05-21T14:26:22.467
> 
> 标签：c++, static-libraries, qt-creator

我想让我的应用程序对用户没有任何依赖。当我将 dll 文件放入与我的 exe 相同的文件夹中时，它运行良好。我正在尝试将所有这些库设置为静态，在我的 pro 文件（Qt 4.8.1）中使用以下代码：

```
QMAKE_LFLAGS += -static-libgcc
CONFIG += static 
```

前面的代码没有改变任何东西。

这是我包含在我的项目文件夹中的 dll 文件：

*   libgcc_s_dw2-1.dll
*   mingwm10.dll
*   QtCore4.dll
*   QtGui4.dll

事实是我不希望我的应用程序不仅仅是一个文件，也不希望用户下载很重的 libs 文件（最后一个为 9mB）。

有没有办法编译 Qt 项目并使用静态库？

我试图阅读一些我在互联网上找到的教程，但它们都已经过时了。对于我也读到的内容，解决方案是静态重建 Qt 源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T13:52:46.850

为了能够针对 Qt 进行完全静态编译，您需要将框架重建为静态的，使用预编译的框架是不够的 - 除非您拥有商业许可证并且可以获得静态二进制文件。

见：[http](http://www.formortals.com/how-to-statically-link-qt-4/) ://www.formortals.com/how-to-statically-link-qt-4/，http : [//www.formortals.com/build-qt-static-small-microsoft-intel-gcc-compiler /](http://www.formortals.com/build-qt-static-small-microsoft-intel-gcc-compiler/)和[http://doc.qt.nokia.com/4.7-snapshot/deployment.html#static-vs-shared-libraries](http://doc.qt.nokia.com/4.7-snapshot/deployment.html#static-vs-shared-libraries)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:18:43.363

下载已编译的库。如果您正在针对平台进行构建，请使用该平台的交叉编译库。您可以静态链接 Makefile 中的这些库 [在 makefile 中的 #INCLUDE 和 LIBS 变量中]。唯一的缺点是您的 exe 大小会增加。

# maven - 我可以将值从 maven 注入到 persistence.xml 文件中吗？

> ID：10687146
> 
> 赞同：8
> 
> 时间：2012-05-21T14:26:30.250
> 
> 标签：maven, persistence.xml

我希望能够将我的数据库信息存储在 pom.xml 中（作为属性）并将必要的值注入到我的 persistence.xml 文件中。有什么办法可以在 Maven 中实现这一点？

另一种方法是如何将我的数据库连接信息保存在一个文件中，并能够将其提供给我的 pom.xml 和我的 persistence.xml

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T14:37:19.990

您可以将您的 persistence.xml 定位到 src/main/resources/PATH 之类的位置，并使用[过滤选项过滤您的 persistence.xml](http://maven.apache.org/plugins/maven-resources-plugin/examples/filter.html)并放入正确的位置。这可以通过激活资源中的过滤来实现，如下所示：

```
<resource>
  <directory>src/main/resources/PATH</directory>
  <filtering>true</filtering>
</resource> 
```

您的测试资源也是如此：

```
<testResources>
  <testResource>
    <directory>src/main/resources/PATH</directory>
    <filtering>true</filtering>
  </testResource>
</testResources> 
```

基于以上内容，您可以在persistence.xml 中提供类似的内容

```
 <hibernate.url>${database.url}</hibernate.url> 
```

您需要检查的是 persistence.xml 文件的正确目标位置（我记得 META-INF/.. 之类的内容吗？如果是，请将其放入 src/main/resources/META-INF 并相应地更改过滤器目录.

# tridion - 出版商怪异和 DCP

> ID：10687162
> 
> 赞同：1
> 
> 时间：2012-05-21T14:27:24.827
> 
> 标签：tridion

DCP 和 Publisher (2011 SP1) 有一个奇怪的问题。我们已启用发布者日志以尝试获取一些线索：

在我们的 DEV 环境中，我们有一个 CT 标记为 Dynamic & Allow on Page Using Dynamic Assembly。当我们发布页面时，日志条目包含：

```
21/05/2012 14:08:41 <8324> Rendering item [tcm:35-8489] 'Brand Master' with template [tcm:35-2001-32] 'Product Detail' in publication target [tcm:0-4-65537] 'IP.Live' 
21/05/2012 14:08:43 <8324> Rendering of item [tcm:35-8489] 'Brand Master' with template [tcm:35-2001-32] 'Product Detail' in publication target [tcm:0-4-65537] 'IP.Live' took: 00:00:01.9611120 
```

但是在我们的 PROD 上，当我们使用相同的 DCP 发布页面时，日志条目是：

```
21.05.2012 13:37:39 <7416> Resolved item is a Dynamic Component Presentation; only generate a TCDL dynamic link to component [tcm:35-5673] with template [tcm:35-2001-32] 
```

是否有一些我在这里遗漏的配置，这意味着 PROD 会生成这个 TCDL 链接，而不是像 DEV 那样仅仅渲染模板？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:11:09.700

可能是因为有问题的 DCP 之前已经发布过吗？

Publisher 在确定（不）要渲染的内容时会做一些魔术。在我的环境中，我确实看到了 DCPS 的这条消息：

```
4/18/2012 4:10:40 PM <7916> Resolved item is a Dynamic Component Presentation; only generate a TCDL dynamic link to component [tcm:28-2711] with template [tcm:28-2751-32] 
```

想知道您的 DEV 是否有任何不同？出版目标语言？模板输出格式？（如果目标或模板未设置为“动态”语言，我认为 Tridion 不会发布动态内容）

# dependencies - 斯坦福依赖列表

> ID：10687173
> 
> 赞同：3
> 
> 时间：2012-05-21T14:27:40.320
> 
> 标签：dependencies, stanford-nlp

有没有办法列出所有类型的斯坦福依赖项？

[http://nlp.stanford.edu/software/stanford-dependencies.shtml](http://nlp.stanford.edu/software/stanford-dependencies.shtml)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T03:06:26.723

你认为缺少什么？对于基本的依赖关系，手册中的列表应该是完整的。如果没有，那是一个错误。

对于折叠的依赖项，基本上同样适用，但它更复杂，因为两个依赖项（prep_* 和 conj_*）确实有一个开放的插槽。虽然介词和连词通常被认为是封闭的词性，但没有任何预先生成的填充词列表。解析器分析为介词或连词的任何内容都将填充该位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-01T16:32:56.643

我知道这有点晚了，但我一直在寻找同样的东西并找到了列表：[http ://wiki.opencog.org/w/Dependency_relations#Standard_list_of_dependency_relations](http://wiki.opencog.org/w/Dependency_relations#Standard_list_of_dependency_relations)

这也可以在斯坦福依赖手册的后面找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:35:56.607

Take a look at the [Stanford Dependencies Manual](http://nlp.stanford.edu/software/dependencies_manual.pdf). It lists all dependencies with short explanations and examples. Be aware that newer versions of the Stanford Parser might use slightly different dependencies (usually more specialized ones)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-17T09:35:09.340

如果您正在寻找斯坦福依赖解析器的较新版本（3.5.2 和更新）的依赖列表，请查看[通用依赖](http://universaldependencies.org/)，尤其是[英语语法关系页面](http://universaldependencies.org/u/dep/)

这在手册中有链接。

# c - 如何告诉 gcc 停止使用内置函数？

> ID：10687174
> 
> 赞同：8
> 
> 时间：2012-05-21T14:27:45.670
> 
> 标签：c, linux, gcc, x86, glibc

我正在使用我自己修改过的 glibc。我在编译的代码中看到，当我链接它时，编译器没有使用我的 glibc 中的许多标准库函数。然后我放了`-fno-builtin`flag。事情变得更好了，我可以看到许多不是从 glibc 中获取的函数现在都从那里获取了，例如`malloc`.

但是，对于许多功能，例如`mmap`，编译器仍然使用一些内置代码。现在我怎么能要求编译器只使用来自 glibc 的代码而不是使用它的内置函数呢？

在我的 x86-64 函数上，如果我对已编译的 glibc 进行 objdump，以下是生成的 mmap 函数。我在 glibc 源代码中找不到等效代码。

```
0000000000000000 <__mmap>:
   0:   49 89 ca                mov    %rcx,%r10
   3:   b8 09 00 00 00          mov    $0x9,%eax
   8:   0f 05                   syscall 
   a:   48 3d 01 f0 ff ff       cmp    $0xfffffffffffff001,%rax
  10:   0f 83 00 00 00 00       jae    16 <__mmap+0x16>
  16:   c3                      retq 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:46:37.227

您在上面反汇编的包装器来自 sysdeps/unix/sysv/linux/x86_64/sysdep.h 中的 INLINE_SYSCALL 宏。该宏是用于将普通函数调用转换为系统调用的“魔术粘合剂”。

作为 glibc 构建过程的一部分，对于`foo`不在该架构的特殊异常列表中的每个已定义系统调用，它会生成一个`__foo`仅包含单个`INLINE_SYSCALL`宏调用的函数。 `mmap`不在 x86_64 的例外列表中（在 sysdeps/unix/sysv/linux/x86_64/syscalls.list 中），因此它得到了通用处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-12-01T01:25:47.427

[如this](https://stackoverflow.com/a/59612556/4726668) answer中所述，如何将“-ffreestanding”传递给gcc ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:08:32.360

这是`mmap`在我的系统上编译的调用：

```
movl    $1048837, 20(%esp)
movl    $1048836, 16(%esp)
movl    $1048835, 12(%esp)
movl    $1048834, 8(%esp)
movl    $1048833, 4(%esp)
movl    $1048832, (%esp)
call    mmap 
```

我使用了一些常量，如 0x100100 (1048832) 作为`mmap`参数，以便能够更容易地在程序集中找到相应的指令。

这看起来像是对非常普通的库函数的非常普通的调用，而不是内置函数。

的实际代码`mmap`取决于操作系统和体系结构。例如，对于 i386 Linux，它位于`sysdeps/unix/sysv/linux/i386/mmap.S`（是的，它是用汇编语言编写的）。

# python - 有没有像样的css模板生成器？

> ID：10687175
> 
> 赞同：0
> 
> 时间：2012-05-21T14:27:50.273
> 
> 标签：python, css, django

我正在使用 python 开发一个小型网站。在 python 中有很多不错的库，我在尝试样式（尤其是定位/布局）时不禁感到非常低效。有没有像样的 css 模板生成器（如果可能的话，使用 python）？如果需要，您可以从那里对您的 css 代码进行轻微调整。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:32:27.427

不是 python（为什么你想要一个 lib，无论如何？），但是 - [http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T13:16:32.087

还有 django-crispy-forms。[http://django-crispy-forms.readthedocs.org/en/d-0/](http://django-crispy-forms.readthedocs.org/en/d-0/)

最好从预先构建的 CSS 框架开始。

CSS 框架 [http://www.cssdrive.com/index.php/news/resources-cat/C56/](http://www.cssdrive.com/index.php/news/resources-cat/C56/) [http://www.responsivegridsystem.com/](http://www.responsivegridsystem.com/)

CSS 表单框架 [http://www.formee.org/](http://www.formee.org/)和[http://formee.org/demo/index.htm](http://formee.org/demo/index.htm) [http://www.jformer.com/](http://www.jformer.com/)

我希望在 markup.py 中内置一个 CSS 生成组件：http: [//markup.sourceforge.net/](http://markup.sourceforge.net/)

# java - 将 JPanel 更改为另一个 JPanel 不会重新绘制更改

> ID：10687176
> 
> 赞同：1
> 
> 时间：2012-05-21T14:27:54.267
> 
> 标签：java, swing, jframe, jpanel

我`target`在 MainFraim 中有一个主 JPanel 和另一个`currentView`添加到`target`面板中的 JPanel。`target`面板包含带有侦听器的按钮。然后假设这些侦听器更改`curretView`面板的内容，如下所示：

```
private JPanel currentPanel;

public void setView(String type) {

    if (type.equals("overall")) {
        this.currentPanel = getOverallView();
        frame.setTitle("BookingCalendar - Overall View");
        frame.validate();
    } else if (type.equals("guest")) {
        this.currentPanel = getGuestView();
        frame.setTitle("BookingCalendar - Room View");
        frame.validate();
    } else if (type.equals("room")) {
        currentPanel.removeAll();
        this.currentPanel = getRoomView();
        frame.setTitle("BookingCalendar - Guest View");
        frame.validate();
    }
} 
```

我调用的每个方法每次调用时都会返回新的 JPanel：

```
JPanel currentPanel = new JPanel(new MigLayout("","20 [grow, fill] 10 [grow, fill] 20", "20 [] 10 [] 20")) 
```

问题是，每当我调用这些方法时，面板都不会改变。它始终保持不变（默认情况下`getOverallView()`：）

我已经尝试在两个框架以及面板上进行无效、验证、重绘，但没有发生任何变化。有人可以详细说明我需要做什么才能完全改变面板的内容吗`currentView`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T14:32:13.543

您不应该每次都创建一个新的 JPanel()。而是为每种类型的视图创建一个，并使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)在它们之间切换。CardLayout 让您拥有像卡片一样被切换出来的 JPanel。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:33:29.713

看起来您只是想四处移动指针，以`currentView`指向不同的面板。您实际需要做的是`currentView`从中删除`target`然后添加新面板。

如果这是您的 2 个面板...

```
JPanel target = new JPanel();
JPanel currentView = new JPanel(); 
```

然后你添加`currentView`到`target`类似的...

```
target.add(currentView); 
```

然后要更改面板，您需要从 中删除现有面板`target`，然后添加新面板...

```
target.remove(currentPanel);
currentPanel = new JPanel();
target.add(currentPanel); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:35:51.217

此外，如果您不想使用 CardLayout，您可以像您正在做的那样使 JPanel 成为新的 JPanel，然后调用 revalidate()。

# php - 视图应该有多重的服务器逻辑？

> ID：10687182
> 
> 赞同：1
> 
> 时间：2012-05-21T14:28:08.157
> 
> 标签：php, sql, model-view-controller, debugging, codeigniter

我正在调试一个在显示博客文章列表时间歇性崩溃（500 错误）的 codeigniter 应用程序。

崩溃发生在 20-30% 的页面重新加载 - 并且似乎与服务器配置错误的内存问题有关。

***首先***`print_r($array); exit;`，我通过在发送到视图页面的每个数组下方执行控制器如果您只是输出数组（不通过视图）就没有问题——永远不会超时。

所以我不认为查询逻辑有问题。当页面正确加载时，CI 的分析器也会显示查询时间 <.001（当它崩溃时，我会收到 500 错误并且无法读取分析器的信息）。

***接下来***我转到`print_r`视图的 HTML，其中包含控制器发送的数组的循环。这就是偶尔会导致 500 错误的瓶颈所在。

该应用程序的设计方式是，单个视图处理控制器发送的所有数组，并构建一个带有最终输出的 HTML 页面。

正因为如此，视图有很多 PHP 逻辑。在运行 foreach 循环、对 post 参数的条件测试、嵌套的 foreach 循环等之前进行若干数组拆分以插入广告单元。

它非常复杂但完全可读。但是我想知道是不是逻辑太多，这个逻辑的负载是否应该分成更小的片段（多个视图），然后合并成一个最终的 HTML 字符串。

视图有

*   30-50 `if / elseif`, 部分嵌套
*   6-7 `foreach`，一些嵌套
*   5`array_splice`众多`empty`且`isset`

你对这个问题怎么看？您通常会避免逻辑重的视图吗？有什么建议吗？

***请注意，我不是为了网页设计师等而在其他 SO 讨论中询问“清理”视图。我的观点是这种结构是否会导致我的超时以及潜在的解决方案是什么。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:31:55.123

> 你对这个问题怎么看？

这是您指出的瓶颈。现在，如果它是 500（超时），则视图性能是不可接受的。如果要变得可用，则需要对其进行修复。

> 你通常会避免逻辑繁重的视图吗

总是。这就是 MVC 模式的设计目的。尽可能多地为您的控制器保留逻辑，视图应该只是演示。

似乎太多的东西试图放在一种观点中。如果您想发布一些代码，则更容易就需要查看的内容提出建议。对我来说最大的罪魁祸首是`conditionals testing for post parameters`。我认为这几乎肯定属于您的控制器。这些帖子参数是做什么用的？

如果 post 参数规定了输出类型，那么将其分成不同的视图会更干净，而不是在一个超级视图中处理多种不同的输出类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:14:09.463

首先，这不是模板代码可读性的问题——复杂性和错误的存在之间有很强的相关性。[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)是衡量复杂度的一种方法；根据您发布的内容，此模板的圈复杂度至少为 60。在我们所有的项目中，我的目标是圈复杂度 < 8，当我们达到 12 时会感到恐慌。

如果您的视图代码包含错误，我不会感到惊讶 - 不仅仅是超时的事情，而是通过逻辑树的一些奇怪的路线，您无法通过查看代码来完全描绘。

Williams 模板库为您提供了几种工具来执行此操作 - 例如，您可以定义备用视图来处理“如果问题，像这样渲染，如果像那样渲染”逻辑。您还可以在此处使用区域为您带来好处。

有一个假设是因为视图处理用户界面，所以它们不那么重要——但这根本不是真的。

因此，让我们假设您将视图重构为更简单的结构。这会影响处理器负载吗？嗯 - 呃 - 取决于。

通常，“可维护性”和“性能”必须相互权衡。典型的例子是汇编代码与解释语言——对大多数人来说，汇编很难维护，而解释脚本语言更容易处理；另一方面，毫无疑问哪个更快。

在您的情况下，我认为代码总量会增加——例如，作为重构的“提取方法”会将代码量增加几行——但它应该更容易缓存。也应该更容易准确地确定错误发生的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:33:41.973

首先，我首先检查 php 设置中的执行时间限制。您描述的情况看起来很像那个问题：有时脚本设法及时到达那里，有时却没有。) 更多关于[这里](http://www.php.net/manual/en/info.configuration.php#ini.max-execution-time)。

其次，是的，你应该避免逻辑重的观点。老实说，我不知道如何在 CodeIgniter 中做到这一点，但在 Zend Framework 中有所谓的视图助手，可用于将视图相关（但很重）的逻辑与模板分开。

最后，您是否已经使用[XDebug](http://xdebug.org/docs/profiler)或其他类似工具分析了您的脚本？

**更新：**当“后参数的条件测试”舒适地坐在视图中（并且只是抵制所有试图移入控制器的尝试）的情况下......至少可以说很有趣。对不起，那么使用 MVC 框架有什么意义呢？

# asp.net-mvc - 更新 iFrame 时停止刷新页面

> ID：10687184
> 
> 赞同：0
> 
> 时间：2012-05-21T14:28:16.997
> 
> 标签：asp.net-mvc

我是 asp .net MVC 的新手，我的索引页面中有一个 iframe，我正在从视图中设置它的 src。

我在 iframe 之外也有一个文本框，现在我只想更新 iframe 内部的区域而不是整个页面，以便我可以保留文本框的值。我在 iframe 左侧也有一些树形式的链接，所以即使用户点击任何链接，我也想保留文本框的值。

所以请告诉我asp mvc中的任何想法或代码，我一直在研究基于asp .net web表单的模型，这很容易，但是如何在asp .net mvc中实现同样的事情。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:32:06.403

首先，mvc没有这样的更新面板，完全不一样！

您需要在视图中设置控件的值，mvc 没有类似 viewstate 的东西来保持控件的值。我建议你放松一些教程来开始，像书呆子晚餐这样的人。

[http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx](http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx)

[http://nerddinner.codeplex.com/](http://nerddinner.codeplex.com/)

此致

# php - 如何为 Mongo 副本集配置 RockMongo

> ID：10687185
> 
> 赞同：9
> 
> 时间：2012-05-21T14:28:18.660
> 
> 标签：php, mongodb, ide

我最近切换到[RockMongo 浏览器](https://stackoverflow.com/search?q=rockmongo)，但我很难让它与副本集一起使用。

根据[官方文档](http://code.google.com/p/rock-php/wiki/configuration)，我将服务器声明为：

```
$MONGO["servers"][$i]["mongo_name"] = "localhost";//mongo server name
$MONGO["servers"][$i]["mongo_host"] = "127.0.0.1";//mongo host
$MONGO["servers"][$i]["mongo_port"] = "27017";//mongo port
$MONGO["servers"][$i]["mongo_timeout"] = 0;//mongo connection timeout 
```

RockMongo 抱怨以下内容：

```
Execute failed:not master
function (){ return db.getCollectionNames(); } 
```

我还尝试了另一种导致相同错误的变体：

```
$MONGO["servers"][$i]["mongo_host"] = "mongodb://192.168.0.2,192.168.0.3";// multiple hosts 
```

RockMongo 可以使用副本集吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T14:29:09.063

但是，如果您深入研究源代码，您会发现rockmongo 确实可以使用未记录的“mongo_options”键连接到replicaSet：

```
$MONGO["servers"][$i]["mongo_options"] = array('replicaSet' => 'REPLICA_NAME');//mongo server name
$MONGO["servers"][$i]["mongo_host"] = "mongodb://192.168.0.2,192.168.0.3";//mongo host
$MONGO["servers"][$i]["mongo_port"] = false;//mongo port 
```

希望这可以帮助 ！

# environment-variables - Inno Setup - 设置 Java 环境变量

> ID：10687188
> 
> 赞同：6
> 
> 时间：2012-05-21T14:28:20.830
> 
> 标签：environment-variables, inno-setup

我正在使用 Inno Setup 为我正在处理的项目制作安装程序，我需要它来设置 java 环境变量，这样当他们运行 cmd 时，他们就不会收到*java not found*错误或类似的错误。

我发现了一些与 Inno Setup 和设置环境变量相关的其他帖子，但是有人知道这个实例的特定内容吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-21T14:46:17.793

Assuming Java is installed in its default location program files/Java, something like this should work in your case:

```
[Registry]
; set PATH
Root: HKCU; Subkey: "Environment"; ValueType:string; ValueName:"PATH"; ValueData:"{olddata};{pf}\Java\bin"; Flags: preservestringtype
; set JAVA_HOME
Root: HKCU; Subkey: "Environment"; ValueType:string; ValueName:"JAVA_HOME"; ValueData:"{pf}\Java"; Flags: preservestringtype

[Setup]
; Tell Windows Explorer to reload the environment
ChangesEnvironment=yes 
```

I'm not sure which environment variable you want to set -- PATH or JAVA_HOME -- so I've added them both.

Changing PATH shouldn't be necessary since the Java installer tends to add itself to the path; IIRC it copies java.exe and javaw.exe to one of the system directories.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-09T10:27:00.513

加上@Joni 的答案，您可以从注册表中获取 Java 安装目录并使用脚本常量来设置您的环境变量：

（编辑：感谢@TLama 的代码更正！）

```
[Registry]
Root: HKCU; Subkey: "Environment"; ValueType:string; ValueName:"JAVA_HOME"; ValueData:"{code:GetJava32Path|6}"; Flags: preservestringtype

[Code]
const
  RegKeyJRE = 'SOFTWARE\JavaSoft\Java Runtime Environment\';

function GetJava32Path(MinVersion: string): string;
var
  I: Integer;
  Path: string;
  Versions: TArrayOfString;
begin
  Result := '';
  if RegGetSubkeyNames(HKLM, RegKeyJRE, Versions) then
    for I := 0 to GetArrayLength(Versions)-1 do
      if (Versions[I][2] = '.') and (Versions[I][3] >= MinVersion) and
        RegQueryStringValue(HKLM32, RegKeyJRE + Versions[I], 'JavaHome', Path) then
      begin
        Result := Path;
        Exit;
      end;
end; 
```

（注意，我远不是 Pascal 脚本专家，代码可能会好很多，尽管现在它已被 @TLama 更正了 :)）

# css - 如何使vim在一行内按字母顺序对CSS规则进行排序？

> ID：10687191
> 
> 赞同：4
> 
> 时间：2012-05-21T14:28:46.527
> 
> 标签：css, sorting, vim

来源：

```
.foo { line-height: 150px; font-size: 24px; clear: both; } 
```

*vim 魔法在这里，可能是基于视觉选择的东西*

结果：

```
.foo { clear: both; font-size: 24px; line-height: 150px; } 
```

你对 vim 魔法部分有什么建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T15:29:21.130

```
:s/\([{;]\)\s*/\1\r/g | '[+1,']sort | '[,']join 
```

将行拆分`{`或`;`将每个规则分成单独的行，`:sort`它们（省略包含 CSS 定义的第一行），然后将它们重新连接在一起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:30:29.237

非常快速的回答：

```
:s/[{;] /\0\r
vi{
:!sort
va{
J 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:03:58.207

另一个单行：

```
s/{\s*\zs.\{-}\ze\s*}/\=join(sort(split(submatch(0), '\s*;\s*')), '; ').';' 
```

这次我们使用`sub-replace-\=`, 和列表操作函数（`sort()`, `split()`, 和`join()`）

# java - 从eclipse self加载文件

> ID：10687192
> 
> 赞同：0
> 
> 时间：2012-05-21T14:28:51.543
> 
> 标签：java, file, load

我正在与某人一起完成一项任务，我们需要能够加载和保存文件。目前我们这样做：

```
robot1.getComputer().loadAndCompileProgram(new File("C:\\Projects\\IO\\program1.txt")); 
```

然而，这要求他和我在完全相同的位置有这个程序。我们更愿意将它存储在我们的 eclipse 项目中，并且能够加载文件，而不管 program1 在我们的计算机中的“完整”位置是什么。我们想做这样的事情：

```
robot1.getComputer().loadAndCompileProgram(new File("/Project D3 1.15/Progs/program1.txt")); 
```

Project D3 1.15 是 Java 项目，完整字符串是 program1 的 Eclipse 中的路径。然而这不起作用。有没有可能做我们想做的事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:45:12.353

What you need is this:

```
String myProjectDir = System.getProperty("user.dir");
robot1.getComputer().loadAndCompileProgram(new File(myProjectDir +"/myFolder/program1.txt")); 
```

The JVM environment variable "user.dir" points to your project directory (for programs that are run from eclipse)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:38:11.993

好吧，您可以利用诸如 的 Java 系统属性`user.dir`来到达工作区，然后构造路径。

`new File(System.getProperty("user.dir") + File.separator + "program1.txt")`

如果通过 Eclipse 运行，这将期望文件直接存在于您的工作区中。

这将是一种真正独立于平台的做事方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:36:08.917

Try `new File("./Progs/program1.txt")` or `new File("Progs/program1.txt"")`

Besides that: if you are having problems with finding out how to locate files under different IDEs, just create simple class with main method like this:

```
public class ExpMainClass {
    public static void main(final String[] args) throws Exception {
        System.out.println(new File(".").getAbsolutePath());
    }
} 
```

and run it - this should help understanding from where IDE is executing your application.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T14:37:04.410

There is a difference between the Eclipse project name, and the real path on the computer. It is possible to have a project named Foo whose path is C:\Projects\Bar.

However, it is possible to do this, since when you execute from Eclipse, you are in the current directory.

Just do this

```
robot1.getComputer().loadAndCompileProgram(new File("Progs/program1.txt")); 
```

or (if you want to specify the project name)

```
robot1.getComputer().loadAndCompileProgram(new File("../Project D3 1.15/Progs/program1.txt")); 
```

# sql - 如何从 jdbc 连接参数逆向工程 sqlplus 登录？

> ID：10687194
> 
> 赞同：1
> 
> 时间：2012-05-21T14:28:57.900
> 
> 标签：sql, oracle

我正在查看一个程序，它告诉我如何从 Java 连接到一个看起来像这样的 Oracle 数据库

```
 String url = "jdbc:oracle:thin:@a-b.c.d.e:50001:f";
 String user = "username";
 String password = "secret";
 String driverClassName = "oracle.jdbc.driver.OracleDriver";
 ... 
```

这些信息足以弄清楚如何从 sqlplus 命令行工具连接到同一个数据库吗？如果是这样，连接的派生语法是什么？

预先感谢您提出最愚蠢的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:37:20.497

大概是这样的：

```
sqlplus username/secret@//a-b.c.d.e:5001/f 
```

这假设 SID（`f`在 JDBC URL 中使用）与数据库的服务名称相同。

如果不是，我不知道有什么方法可以从 SID 中“逆向”工程服务名称。

# ssl - Java 7 无法生成 DH 密钥对

> ID：10687200
> 
> 赞同：17
> 
> 时间：2012-05-21T14:29:14.860
> 
> 标签：ssl, java, jce

我阅读了一篇关于当服务器发送超过 1024 位的密钥时触发的错误“无法生成 DH 密钥对”的帖子。下载 JCE 无限制的 jar 应该可以解决这个问题。在测试环境中，我遇到了以下问题，对于同一 Web 服务器，如果我使用 Java 6，则在执行 https 查询时不会出现任何错误，但如果我使用 Java 7，则会出现“无法生成 DH 密钥对”。

我尝试替换 JCE 无限的 jar 文件，但仍然得到相同的错误。自 2007 年以来报告了该错误，但为什么它在 Java 6 上运行而不在 Java 7 上运行？要下载的文件不正确吗？我从上一篇文章[Java 中获得了链接：为什么 SSL 握手会给出“无法生成 DH 密钥对”异常？](https://stackoverflow.com/questions/6851461/java-why-does-ssl-handshake-give-could-not-generate-dh-keypair-exception).

在这一点上，我不知道该怎么办。如果我尝试加载 BouncyCastle 提供程序，我会收到 ArrayOutOfIndex 异常。我的服务器只允许 DH 算法，所以我不能使用上面帖子中建议的其他算法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-02-07T00:59:40.383

一些补充或说明：

（Suncle）Java 7 自 7u09 以来默认使用更明智的密码套件一致顺序，这与 7u04 中看似随机的顺序不同。（我在 04 和 09 之间没有测试。）此命令将 ECDHE 和纯 RSA（又名 akRSA）放在 DHE 之前，因此当且仅当服务器支持 ECDHE 或 RSA 并同意客户端偏好时，才能避免该问题。（或 ECDH 固定，但实际上没有人使用它。）如果服务器坚持使用 DHE（无论出于何种原因）并且使用 DH>1024 位，您仍然有问题。

如果询问者（或其他任何人）连接到真正需要整数 DH（而不是 ECDH 或 RSA）的服务器，则在 8 之前使用 Java 的唯一方法是让服务器使用 DH 1024 位。哪个 AFAWK 在技术上可以再安全几年，但由于微薄的优势，它被 NIST 等重要权威机构禁止（参见 csrc.nist.gov 上的 Special Pub 800-57）。（即使 RSA 1024 实际上还没有被破坏，但它可能很快就会被破坏，因此被禁止。）

“无限强度策略”与这个问题无关，或者至少不是直接相关，#6851461 的好答案并没有说它是。它不会改变 SunJCE 中对 DH 参数的限制，这被（错误地）视为标准问题而不是强度问题。（具体来说，它采用了过去对 DSA 正确的限制，并将它们应用于 DH。）它确实启用了 AES-256 和 SHA-2（仅适用于 TLSv1.2）套件，并给出了一个足够奇怪的首选项列表，这可能将选择结果从 DHE（失败）更改为非 DHE（工作）。

您不需要完全回到 Java 6 列表，您只需要将其他密钥交换优先于 DHE，或者对于顽固的服务器完全放弃 DHE。除非旧版服务器绝对需要，否则您绝对不应该重新启用任何 EXPORT 或单 DES 套件；它们已经不安全好几年了，并且在默认情况下保持启用的时间比他们应该拥有的时间长得多。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-27T12:57:30.567

我偶然发现了与 SSLScokets 相同的问题，我想我确定了 Java 7 出现这种回归的原因。原因在于客户端和服务器之间协商的密码。

默认情况下，Java 6 为 TLS 连接启用这些密码（按优先级顺序）：

```
SSL_RSA_WITH_RC4_128_MD5
SSL_RSA_WITH_RC4_128_SHA
TLS_RSA_WITH_AES_128_CBC_SHA
TLS_DHE_RSA_WITH_AES_128_CBC_SHA
TLS_DHE_DSS_WITH_AES_128_CBC_SHA
SSL_RSA_WITH_3DES_EDE_CBC_SHA
SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA
SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA
SSL_RSA_WITH_DES_CBC_SHA
SSL_DHE_RSA_WITH_DES_CBC_SHA
SSL_DHE_DSS_WITH_DES_CBC_SHA
SSL_RSA_EXPORT_WITH_RC4_40_MD5
SSL_RSA_EXPORT_WITH_DES40_CBC_SHA
SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA
TLS_EMPTY_RENEGOTIATION_INFO_SCSV 
```

Java 7 启用了这些密码：

```
TLS_DHE_RSA_WITH_AES_128_CBC_SHA
TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA
SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA
SSL_RSA_WITH_RC4_128_SHA
TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA
TLS_ECDHE_RSA_WITH_RC4_128_SHA
TLS_ECDH_ECDSA_WITH_RC4_128_SHA
TLS_ECDHE_ECDSA_WITH_RC4_128_SHA
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA
TLS_ECDH_RSA_WITH_RC4_128_SHA
TLS_EMPTY_RENEGOTIATION_INFO_SCSV
TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA
TLS_ECDH_RSA_WITH_AES_128_CBC_SHA
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
TLS_RSA_WITH_AES_128_CBC_SHA
TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
SSL_RSA_WITH_RC4_128_MD5
TLS_DHE_DSS_WITH_AES_128_CBC_SHA
SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA
SSL_RSA_WITH_3DES_EDE_CBC_SHA 
```

使用 Diffie-Hellman 的密码在 Java 7 上具有更高的优先级，但它们似乎不支持超过 1024 位的密钥，除非安装了强加密包。

我使用的解决方法是在以下位置指定 Java 6 启用的密码`SSLSocket`：

```
SSLSocketFactory socketFactory = SSLContext.getInstance("TLS").getSocketFactory();
SSLSocket socket = (SSLSocket) socketFactory.createSocket(InetAddress.getByName(hostname), port);
socket.setEnabledCipherSuites(new String[] {
        "SSL_RSA_WITH_RC4_128_MD5",
        "SSL_RSA_WITH_RC4_128_SHA",
        "TLS_RSA_WITH_AES_128_CBC_SHA",
        "TLS_DHE_RSA_WITH_AES_128_CBC_SHA",
        "TLS_DHE_DSS_WITH_AES_128_CBC_SHA",
        "SSL_RSA_WITH_3DES_EDE_CBC_SHA",
        "SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA",
        "SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA",
        "SSL_RSA_WITH_DES_CBC_SHA",
        "SSL_DHE_RSA_WITH_DES_CBC_SHA",
        "SSL_DHE_DSS_WITH_DES_CBC_SHA",
        "SSL_RSA_EXPORT_WITH_RC4_40_MD5",
        "SSL_RSA_EXPORT_WITH_DES40_CBC_SHA",
        "SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA",
        "SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA",
        "TLS_EMPTY_RENEGOTIATION_INFO_SCSV"});

socket.startHandshake(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-03T10:57:40.433

鉴于您使用的是最新的 java 版本并且仍然出现错误，您可以更改 java.security 中的设置（例如在文件夹 C:\Program Files\Java\jre1.8.0_xx\lib\security

```
# Example:
#   jdk.tls.disabledAlgorithms=MD5, SSLv3, DSA, RSA keySize < 2048
    jdk.tls.disabledAlgorithms=SSLv3, RC4 
```

在 jdk.tls.disabledAlgorithms 中添加 DH 作为禁用算法

```
 jdk.tls.disabledAlgorithms=SSLv3, RC4, DH 
```

重新启动 tomcat 或重新运行您的程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-02T14:10:13.057

Java7 和 Java8 也遇到了这个问题。我们还使用了类似于 Emanual Borg 建议的解决方法。但我们的目标是避免对固定的 CipherSuite 列表进行硬编码。所以我们尝试删除导致问题的条目（通过反复试验......）。

```
String[] enabledCipherSuites = socket.getEnabledCipherSuites();

// avoid hardcoding a new list, we just remove the entries
// which cause the exception
List<String> asList = new ArrayList(Arrays.asList(enabledCipherSuites));

// we identified the following entries causeing the problems
// "Could not generate DH keypair"
// and "Caused by: java.security.InvalidAlgorithmParameterException: Prime size must be multiple of 64, and can only range from 512 to 1024 (inclusive)"
asList.remove("TLS_DHE_RSA_WITH_AES_128_CBC_SHA");
asList.remove("SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA");
asList.remove("TLS_DHE_RSA_WITH_AES_256_CBC_SHA");

String[] array = asList.toArray(new String[0]);
socket.setEnabledCipherSuites(array); 
```

问题：有人认为这种方法有问题吗？

顺便说一句：如果您使用的是 Apache HTTPClient，那么[https://issues.apache.org/jira/browse/HTTPCLIENT-1111](https://issues.apache.org/jira/browse/HTTPCLIENT-1111)很有趣，它显示了如何通过该方法设置 CipherSuites（从 HTTPClient v4.2 开始）

```
SSLConnectionSocketFactory() {...}.prepareSocket(SSLSocket) 
```

**2015 年 10 月 31 日更新：** 为了帮助更好地理解使用它的上下文，这里是完整的伪代码示例，您可以在其中看到如何连接以覆盖 prepareSocket() 方法：

```
HttpClientBuilder builder = HttpClients.custom();

SSLContextBuilder sslContextBuilder = SSLContexts.custom();
SSLContext sslContext = sslContextBuilder.build();

SSLConnectionSocketFactory sslsf = new SSLConnectionSocketFactory(sslContext, hostNameVerfier)
{

    protected void prepareSocket(SSLSocket socket) throws IOException {

    // Workaround to use different order of CipherSuites used by Java6 in order
        // to avoid the the problem of java7 "Could not generate DH keypair"
        String[] enabledCipherSuites = socket.getEnabledCipherSuites();

        // but to avoid hardcoding a new list, we just remove the entries
        // which cause the exception (via TrialAndError)
        List<String> asList = new ArrayList(Arrays.asList(enabledCipherSuites));

        // we identified the following entries causeing the problems
        // "Could not generate DH keypair"
        // and "Caused by: java.security.InvalidAlgorithmParameterException: Prime size must be multiple of 64, and can only range from 512 to 1024 (inclusive)"
        asList.remove("TLS_DHE_RSA_WITH_AES_128_CBC_SHA");
        asList.remove("SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA");
        asList.remove("TLS_DHE_RSA_WITH_AES_256_CBC_SHA");

        String[] array = asList.toArray(new String[0]);
        socket.setEnabledCipherSuites(array);

    };
};

Registry<ConnectionSocketFactory> socketFactoryRegistry = RegistryBuilder.<ConnectionSocketFactory> create().register("https", sslsf).build();

PoolingHttpClientConnectionManager conman = new PoolingHttpClientConnectionManager(socketFactoryRegistry);
builder.setConnectionManager(conman);

CloseableHttpClient httpClient =  builder.build(); 
```

**小心** 我们只在用户明确启用信任自签名证书的上下文中使用这段代码（例如，用于测试环境等）。如果您不想这样做，那么最好不要弄乱 SSL 的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-22T08:35:06.727

如果您使用的是 jdk1.7.0_04，请升级到 jdk1.7.0_21。该问题已在该更新中得到解决。

# c++ - 通过 *.dll 文件调用 *.exe 文件并提交参数

> ID：10687205
> 
> 赞同：0
> 
> 时间：2012-05-21T14:29:34.917
> 
> 标签：c++, vb.net, visual-studio-2008, dll, rundll32

我试图在 *.dll 文件的帮助下启动 *.exe 文件，而不是直接调用 *.exe 文件。它将用于能够启动 *.dll 文件但不能启动 *.exe 文件的程序。

在这种情况下： browser.exe 是用 vb.NET 编写的，而 browser.dll 文件是用 C++ 编写的（我找不到任何适用于 vb.NET 的 dll 片段）。

VS2008生成的browser.dll（MFC-DLL）的代码片段，我稍作修改如下：

```
[...]
CBrowserStartApp::CBrowserStartApp()
{
    system("start .\\browser.exe");
}

CBrowserStartApp theApp;

BOOL CBrowserStartApp::InitInstance()
{
    CWinApp::InitInstance();
    system("start .\\browser.exe");
    return TRUE;
} 
```

我可以毫无错误地编译它。

有趣的是，如果我使用 Rundll32.exe 启动 dll 并添加任何参数，则会出现错误消息。然后程序启动，但错误信息仍然存在。`Error in browser.dll. Missing Content v`如果我以“”开头，它会说“ `Rundll32.exe browser.dll v`”。如果我省略参数“v”，则不会发生任何事情。既不会出现错误，也不会出现实际应用。我在这里做错了什么？

我遇到的下一个问题如下： 通常我会使用诸如 URL 之类的参数（例如，“ `browser.exe http://www.google.com`”）来启动 *.exe 文件。如何将此类 URL 添加到 *.dll 文件？与通常程序相同的技巧（例如，`args = Environment.GetCommandLineArgs()`）？那么我如何访问它们并将它们转发到实际的 *.exe 文件呢？

谢谢，马库斯 G.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:32:37.660

由于您已经在使用 WinApi，因此请使用本机`CreateProcess`.

# asp.net-mvc-3 - 使用 MVC3 上传文件

> ID：10687209
> 
> 赞同：2
> 
> 时间：2012-05-21T14:29:42.417
> 
> 标签：asp.net-mvc-3, file-upload, viewmodel

我想上传一个文件。我将 MVC3 与剃须刀一起使用。我有以下视图模型：

```
Public Class ImportL2EViewModel
    <Required(AllowEmptyStrings:=False, ErrorMessage:="L2E name required")>
    Public Property Name As String

    Public Property File As HttpPostedFileBase    
End Class 
```

在我看来，我创建了一个表单：

```
@Using Html.BeginForm("Import", "L2ECreationWizard", FormMethod.Post, New Dictionary(Of String, Object) From {{"enctype", "multipart/form-data"}})
    @<div class="welcome-box acenter"> 
        <div style="display: block; text-align: left; width: 330px; margin: auto;">
            <div class="property">
                @Html.LabelFor(Function(m) m.Name)
                @Html.TextBoxFor(Function(m) m.Name)
            </div> 
            <div class="property">
                @Html.LabelFor(Function(m) m.File)
                @Html.TextBoxFor(Function(m) m.File, New With {.type = "file"})
            </div>            
        </div>
        <div class="actionBar">
            <a class="import fright button" href="#">Import</a>
        </div>
    </div>
End Using 
```

生成的 html 如下所示：

```
<form method="post" enctype="multipart/form-data" action="/L2ECreationWizard/Import" novalidate="novalidate">
    <div class="welcome-box acenter"> 
        <div style="display: block; text-align: left; width: 330px; margin: auto;">
            <div class="property">
                <label for="Name">Name</label>
                <input type="text" value="" name="Name" id="Name" data-val-required="L2E name required" data-val="true">
            </div> 
            <div class="property">
                <label for="File">File</label>
                <input type="file" value="" name="File" id="File">
            </div>            
        </div>
        <div class="actionBar">
            <a href="#" class="import fright button">Import</a>
        </div>
    </div>
</form> 
```

我将表单发布到以下操作方法：

```
<HttpPost()>
Function Import(vm As ImportL2EViewModel) As ActionResult
    ' Nothing yet
End Function 
```

发布后我可以看到`vm.Name`填写，但是。 是。我究竟做错了什么？我在 SO 上看到过类似的问题，但对我没有任何帮助。我搞不清楚了...`vm.File``Nothing``Request.Files.Count``0`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:32:10.883

将参数添加到您的方法中，`HttpPostedFileBase file`如下所示：

```
<HttpPost()>
Function Import(vm As ImportL2EViewModel, file As HttpPostedFileBase) As ActionResult

Dim fileName = Path.GetFileName(file.FileName)
    Dim physicalPath = Path.Combine(Server.MapPath("~/App_Data"), fileName)

    // The files are not actually saved in this demo
    // file.SaveAs(physicalPath)
    ...
End Function 
```

并从您的模型中删除 HttpPostedFileBase 属性。它是 Request 对象的一部分，因此无法添加到您的模型中。

如果您允许选择多个文件，那么这就是您需要能够遍历上传的每个文件

```
<HttpPost()>
Function Import(vm As ImportL2EViewModel, attachments As IEnumerable(Of HttpPostedFileBase)) As ActionResult

    For Each file As var In attachments
        Dim fileName = Path.GetFileName(file.FileName)
        Dim physicalPath = Path.Combine(Server.MapPath("~/App_Data"), fileName)
        ' The files are not actually saved in this demo
        ' file.SaveAs(physicalPath);
    Next
    ...
End Function 
```

# visual-studio - 适用于两名开发人员的 Team Foundation Server

> ID：10687211
> 
> 赞同：3
> 
> 时间：2012-05-21T14:29:46.263
> 
> 标签：visual-studio, tfs

我们是两个拥有 MSDN 订阅的开发人员（每个都有自己的订阅）。对于我们的一位客户，我们想将 TFS 用于源代码存储库、错误跟踪……我们主要使用 VS2010 解决方案。我对所有不同的许可证有点迷茫。

我们有什么（购买？）来安装 TFS 以满足我们的需求？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T15:41:48.703

[**TFS Express 2012**](http://go.microsoft.com/fwlink/?LinkId=251396) is what you need.

From version 2012 (currently available in pre-release RC1), it is free for 5 developers. It is also scalable as your team grows and want to move to an higher license level.

I'm working with the TFS Express 2012 RC, upgraded from the TFS 11 Express Beta released in February and can confirm it is very stable and supports working with Visual Studio 2010 and [2012](http://go.microsoft.com/fwlink/?LinkId=251391) side-by-side.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:40:10.277

> 我们有什么（购买？）来安装 TFS 以满足我们的需求？

假设您打算在单个 Windows 实例上运行数据和应用程序层（在这种情况下，您订阅中的 TFS CAL 涵盖 SQL Server Standard ¹的实例）。

然后，您需要两个用户的 Server 2008 或 2008 R2 许可证以及两个 CAL。该服务器可以提供 AD、DNS 等服务，这将使资源共享更加容易。

但是 TFS 可以安装在客户端操作系统上：在这种情况下，我认为不需要任何进一步的许可证。

（这里的背景：MSDN 许可证包括用于测试和开发应用程序/产品的操作系统许可证，而不是一般用途。与每个订阅的单一许可证不同，在通用级别，Office 可以在应用程序的开发和测试之外使用；或 VS 实例。 )

另一方面：MSDN 许可并不简单，花时间阅读文档和 MSDN 许可（它会覆盖包含的单个产品许可）。

* * *

¹ 2008 或 2008R2（更新了 MSDN 许可规则以涵盖两者）；但检查版本（在这里从记忆中工作）。

# javascript - Google Maps API v3 draggableCursor 选项，例如位置

> ID：10687213
> 
> 赞同：1
> 
> 时间：2012-05-21T14:30:02.193
> 
> 标签：javascript, google-maps, google-maps-api-3, cursor, google-maps-styled

这是一个很长的镜头，但我想知道 Google Maps API v3 中是否有任何设置可以让我在我的自定义“draggableCursor”上设置光标的尖端/末端（因为没有更好的词）应该是. 默认设置似乎是图像的左上角是光标点，但我希望它是左下角。

到目前为止，这是我的代码：

```
map.setOptions({ draggableCursor: 'url(images/markers/you_marker.cur), default' }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T20:05:09.203

Andrew Leach 的回答是正确的，因为光标热点是在 .cur 文件中定义的，但谷歌地图无法识别它。

对于 Google 地图中的自定义光标，您可以通过在 CSS 规则中设置坐标来更改热点：

```
map.setOptions({ draggableCursor: 'url(images/markers/you_marker.cur) 16 16, default' }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:03:28.800

游标的热点应该在`.cur`文件中定义。在没有指定任何其他位置的情况下，它默认为左上角。API 只是指定使用哪个游标文件。

[http://www.axisis.com/tutorials/what-is-a-cursor.html#t8](http://www.axialis.com/tutorials/what-is-a-cursor.html#t8)（其他光标设计程序可用）。

# android - 如何将 glDrawElements (x,y,z) 设置为相对于视口。安卓

> ID：10687216
> 
> 赞同：0
> 
> 时间：2012-05-21T14:30:04.937
> 
> 标签：android, opengl-es

我是 OpenGL 的新手，我只想知道如何将 glDrawElements (x,y,z) 设置为相对于 Android 中的视口？

我一直在使用这个[示例](http://blog.jayway.com/2010/12/30/opengl-es-tutorial-for-android-%E2%80%93-part-vi-textures/)来使用 glDrawElements 绘制我的形状。它看起来像这样：

```
float textureCoordinates[] = {
                0.0f, 1.0f, //
                1.0f, 1.0f, //
                0.0f, 0.0f, //
                1.0f, 0.0f, //
        };

        short[] indices = new short[]{0, 1, 2, 1, 3, 2};

        float[] vertices = new float[]{
                -1f, -1f, 0.0f,
                1f, -1f, 0.0f,
                -1f, 1f, 0.0f,
                1f, 1f, 0.0f}; 
```

平局看起来像这样：

```
// Counter-clockwise winding.
        gl.glFrontFace(GL10.GL_CCW);
        // Enable face culling.
        gl.glEnable(GL10.GL_CULL_FACE);
        // What faces to remove with the face culling.
        gl.glCullFace(GL10.GL_BACK);
        // Enabled the vertices buffer for writing and to be used during
        // rendering.
        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
        // Specifies the location and data format of an array of vertex
        // coordinates to use when rendering.
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, mVerticesBuffer);
        // Set flat color
        gl.glColor4f(mRGBA[0], mRGBA[1], mRGBA[2], mRGBA[3]);
        // Smooth color
        if (mColorBuffer != null) {
            // Enable the color array buffer to be used during rendering.
            gl.glEnableClientState(GL10.GL_COLOR_ARRAY);
            gl.glColorPointer(4, GL10.GL_FLOAT, 0, mColorBuffer);
        }

        // New part...
        if (mShouldLoadTexture) {
            loadGLTexture(gl);
            mShouldLoadTexture = false;
        }
        if (mTextureId != -1 && mTextureBuffer != null) {
            gl.glEnable(GL10.GL_TEXTURE_2D);
            // Enable the texture state
            gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);

            // Point to our buffers
            gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, mTextureBuffer);
            gl.glBindTexture(GL10.GL_TEXTURE_2D, mTextureId);
        }
        // ... end new part.

        gl.glTranslatef(x, y, z);
        gl.glRotatef(rx, 1, 0, 0);
        gl.glRotatef(ry, 0, 1, 0);
        gl.glRotatef(rz, 0, 0, 1);

        // Point out the where the color buffer is.
        gl.glDrawElements(GL10.GL_TRIANGLES, mNumOfIndices,
                GL10.GL_UNSIGNED_SHORT, mIndicesBuffer);
        // Disable the vertices buffer.
        gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);

        // New part...
        if (mTextureId != -1 && mTextureBuffer != null) {
            gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
        }
        // ... end new part.

        // Disable face culling.
        gl.glDisable(GL10.GL_CULL_FACE); 
```

在我的情况下 x = y = z = 0

这就是我在表面上所做的改变：

```
public void onSurfaceChanged(GL10 gl, int width, int height) {
        // Sets the current view port to the new size.
        gl.glViewport(0, 0, width, height);
        // Select the projection matrix
        gl.glMatrixMode(GL10.GL_PROJECTION);
        // Reset the projection matrix
        gl.glLoadIdentity();
        // Calculate the aspect ratio of the window
        GLU.gluPerspective(gl, 45, (float) width / (float) height, -1f, 1f);
        // Select the modelview matrix
        gl.glMatrixMode(GL10.GL_MODELVIEW);
        // Reset the modelview matrix
        gl.glLoadIdentity();
    } 
```

这会在屏幕中间绘制我的纹理（就像在示例中一样）但是我如何使用我的视口控制它，并设置相对于我的视口的 x、y、z？

**编辑：**我想做的只是设置我的屏幕尺寸，并在给定的坐标（x，y，z）中绘制二维图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:00:17.037

如果您只是在绘制纹理，我建议您放弃透视投影并只做一个简单的正交矩阵。

用类似的东西替换 gluPerspective

`glOrtho(0, screen_width, 0, screen_height, -1, 1);`

然后您可以在像素位置绘制顶点，即全屏纹理：

```
float w = screen_width;
float h = screen_height;
float[] vertices = new float[]{
                0, 0,
                w, 0,
                0, h,
                w, h,
} 
```

# objective-c - 如何拍摄屏幕截图并将该屏幕截图保存在相册中

> ID：10687218
> 
> 赞同：0
> 
> 时间：2012-05-21T14:30:05.040
> 
> 标签：objective-c

我正在处理贺卡的应用，我已经拍摄了屏幕截图并保存在图库中，因此请提供适用于我的代码的任何建议和源代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:42:27.613

Like so:

```
- (UIImage *) captureScreen {
    UIWindow *keyWindow = [[UIApplication sharedApplication] keyWindow];
    CGRect rect = [keyWindow bounds];
    UIGraphicsBeginImageContext(rect.size);
    CGContextRef context = UIGraphicsGetCurrentContext();
    [keyWindow.layer renderInContext:context];   
    UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return img;
} 
```

Then save the image to camera roll using the following tutorial [http://mobiledevelopertips.com/camera/save-an-image-to-camera-roll.html](http://mobiledevelopertips.com/camera/save-an-image-to-camera-roll.html)

# php - 一次更新多个站点的文件

> ID：10687220
> 
> 赞同：0
> 
> 时间：2012-05-21T14:30:14.317
> 
> 标签：php

我正在寻找一种解决方案来一次更新我的所有网站。

这是一个定制的脚本，它在一台服务器上运行。

我经常更新我的网站，现在我必须将文件上传到所有这些网站，这需要很长时间。

有没有更简单的方法在所有这些站点上安装新文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:34:53.530

If you are using linux maybe this can help you

[http://sourceforge.net/projects/clusterssh/](http://sourceforge.net/projects/clusterssh/)

> ClusterSSH controls a number of xterm windows via a single graphical console window to allow commands to be interactively run on multiple servers over an ssh connection.

# objective-c - 向左滑动时加载不同的 .XIB

> ID：10687226
> 
> 赞同：0
> 
> 时间：2012-05-21T14:30:42.647
> 
> 标签：objective-c, ios

我试图弄清楚当我使用手势控制时如何加载 xib 文件，当我向左擦拭时，一旦 xib 出现在屏幕上，我就可以在我再次向左擦拭时加载新的 xib 文件是这可能吗？

例如： -

第 1 页： [http ://screensnapr.ryancouch.co.uk/photo%201.PNG](http://screensnapr.ryancouch.co.uk/photo%201.PNG)

第 2 页： [http ://screensnapr.ryancouch.co.uk/photo%202.PNG](http://screensnapr.ryancouch.co.uk/photo%202.PNG)

如果您删除提供的 url 上的 /photo%20x.png 部分，还有更多图片，我如何设置访客控制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:50:13.803

可以将向左滑动手势添加到要使用向左滑动的每个 .xib 中。

```
UISwipeGestureRecognizer *recognizer;
recognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipeFrom:)];
[recognizer setDirection:UISwipeGestureRecognizerDirectionLeft;
[[self view] addGestureRecognizer:recognizer];
[recognizer release]; 
```

左滑动处理程序将是

```
-(void)handleSwipeFrom:(UISwipeGestureRecognizer *)swipeGesture
{
 //Here add subview or navigate .xib left using swipe left
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:03:08.860

我会简单地使用 PageViewController 而不是 UISwipeGestures。它的代码要少得多，它会自动实例化您的视图。

# erlang - EC2 机器的副本使 ejabberd 停止

> ID：10687227
> 
> 赞同：0
> 
> 时间：2012-05-21T14:30:43.603
> 
> 标签：erlang, amazon-ec2, ejabberd

我复制了一个 EC2 映像（从 EBS 创建了一个映像，然后创建了一个 AMI 并从该 AMI 启动了一个新实例）。EC2 映像正在运行 debian。

在旧机器上，有一个 ejabberd 实例正在运行。在新机器上 ejabberd 启动有问题。当我问

```
ejabberctl show 
```

它给

```
RPC failed on the node ejabberd@localhost: node down 
```

我尝试使用 localhost、dns 名称和 ip 更改 ERLANG_NODE 变量，但总是得到相同的错误。

我尝试重新安装 erlang-base 和 ejabberd，但没有改变。

奇怪的是，在新机器上进行一些测试后，旧机器出现问题，如果我停止旧机器，新机器似乎可以正常运行。

看起来这两个副本属于同一个集群并相互干扰。

知道发生了什么吗？

**更新：** 我在文件系统中搜索了 .erlang.cookie 文件，但找不到。但是，我试图在家里创建一个空的，但它没有用。

我试图删除软件包并清除 conf 文件（apt-get remove --purge）并重新安装它们。现在看来它正在工作。看起来当我创建 AMI 时，我还复制了一些使 jabber 连接到旧集群的信息，或者类似的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T01:43:31.790

清理您的 ejabberd 部署。

```
^ejab/var/log/ejabberd/*
^ejab/var/lib/ejabberd/* 
```

lib 中的 Mnesia 剩余部分保存主机信息。检查日志文件并检查失败的原因（如果仍然无法启动）

检查 ps -ef | grep ejabberd 如果进程正在运行。Telnet 到预先配置的 ejabberd 端口。

# python - 带有对象的Python字典到带有字符串的字典中

> ID：10687229
> 
> 赞同：3
> 
> 时间：2012-05-21T14:30:47.027
> 
> 标签：python, dictionary

我有带有对象值和字符串键的字典：

```
dict{
'key1': object_1
'key2': object_2
} 
```

我想把它转换成：

```
dict{
'key1': str(object_1)
'key2': str(object_2)
} 
```

其中 str(object_1) 是 object_1 的字符串表示形式。执行此转换的最简单和最 Pythonic 的方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T14:31:48.247

```
dict((k, str(v)) for k, v in d.iteritems()) 
```

或在 Python2.7+ 中：

```
{k: str(v) for k, v in d.items()} 
```

对于更复杂的字典（以对象元组作为值）：

```
dict((k, tuple(str(x) for x in v)) for k, v in d.iteritems())

{k: tuple(str(x) for x in v) for k, v in d.items()} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T14:34:02.580

eurimo 说了什么，或者如果您不想复制：

```
for k in d:
   d[k] = str(d[k]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T14:33:47.090

使用字典推导：

```
{ k : str(v) for k, v in d.iteritems() } 
```

以上将在 Python 2.7+ 中工作，它将使用生成器生成新字典。对于 Python 3，这将类似地工作：

```
{ k : str(v) for k, v in d.items() } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T14:34:12.987

以下 Python for 循环应该可以解决您的问题。

```
for item in d.keys():
   d[item]=str(d[item]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T15:54:58.657

您也可以使用它来实现它，而无需使用任何内置的字典方法：

x={ z : str(x[z]) for z in x }

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T17:20:47.217

我不得不做与你的问题类似的事情，但我认为我的解决方案有点长。

```
new_dict=dict([(item[0],str(item[1])) for item in d.items()]) 
```

希望这可以帮助

# git - 当 Git 告诉你它未能推送一些 refs 时，

> ID：10687235
> 
> 赞同：2
> 
> 时间：2012-05-21T14:31:04.977
> 
> 标签：git, heroku

我已经安装了 ruby​​installer 和 msysgit，当我尝试将 radiant 部署到 heroku 时，我收到以下警告消息

```
$git push heroku master  //I use windows
  heroku receiving push
!heroku push rejected,repository is empty.
  to git@heroku.com:faculty.git
![remote rejected]master->master(pre-receive hook declined)
Error: failed to push some refs to git@heroku.com:faculty.git 
```

当我

```
$git push git@heroku.com:faculty.git
fatal:Couldn't fine remote ref HEAD 
```

HEAD 确实存在于我之前读过的文件中。

什么时候

```
 $git fetch git@heroku.com:faculty.git
    ssh: no address associated with name  // ssh key had been generated 
    fatal: the remote end hung up unexpectedly 
```

如何解决这个问题呢？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:59:28.590

只是一个疑问，这是你第一次部署这个项目吗？您已经设置了 SSH？

尝试按照以下步骤操作：

下载安装：[https ://toolbelt.herokuapp.com](https://toolbelt.herokuapp.com)

然后执行这个命令 Heroku plugins: heroku plugins:install git://github.com/ddollar/heroku-accounts.git

项目后的箭头：Heroku 帐户：添加教师 - 自动

尝试命令推送后

# windows - Tomcat6 - 作为独立应用程序和服务运行时，数据源有什么不同吗？

> ID：10687238
> 
> 赞同：0
> 
> 时间：2012-05-21T14:31:20.680
> 
> 标签：windows, jdbc, tomcat6

我一直将 tomcat 6 作为独立应用程序运行，并使用通过控制面板>管理工具中的“数据源”工具指定的数据源。

今天，我尝试将tomcat安装为服务，以便在pc启动时自动启动。

但是它无法再识别数据源。当我从命令提示符重新启动 tomcat 时，相同的数据源工作。

以下是堆栈跟踪

```
org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory ([Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1225)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:880)
    com.qc.helpers.connection.ConnectionPool.<init>(ConnectionPool.java:38)
    com.qc.main.servlets.TableView.init(TableView.java:47)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263)
    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:584)
    org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    java.lang.Thread.run(Thread.java:619) 
```

有任何想法吗？提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:12:47.623

问题是您使用的是 ODBC 数据源。您很可能创建了用户 DSN 而不是系统 DSN。如果 TomCat 作为服务运行，则 Java 无法访问为您的普通用户帐户定义的 ODBC 数据源。如果您将其定义为系统 DSN，那么它应该具有访问权限。

顺便说一句：如果可能，我建议不要使用 JDBC/ODBC 桥，而是为您的数据库使用实际的 JDBC 驱动程序。

# delphi - 为什么我的单选按钮不透明？

> ID：10687241
> 
> 赞同：3
> 
> 时间：2012-05-21T14:31:31.263
> 
> 标签：delphi, radio-button, transparency

我想让一个组合框控制单选按钮的背景颜色，但单选按钮不透明。主题已启用，我将单选按钮的 parentbackground 设置为 true。

这就是我得到的：

![单选按钮不透明](../Images/1b59df810d061b05f2fbf07bdf75bd07.png)

我希望通过单选按钮显示蓝色渐变，并且不使用任何颜色作为单选按钮的背景。

我正在调用此方法，使用 GDI+ 在组框上绘图：

```
procedure TMyRadio.PaintBackground(AParentColor : TColor; Graphics: IGPGraphics);
var
  ExpandedRect : TGPRect;
  Path : IGPGraphicsPath;
  GradientBrush : IGPPathGradientBrush;
  SurroundColors : array[0..0] of TGPColor;
begin

  ExpandedRect := TGPRect.Create(ExpandBorder(BoundsRect, 10));
  Path := TGPGraphicsPath.Create;
  Path.AddRectangle(ExpandedRect);
  GradientBrush :=  TGPPathGradientBrush.Create(Path);

  GradientBrush.CenterColor := TGPColor.Create(255,
                                               GetRValue(ColorToRGB(BackgroundColor)),
                                               GetGValue(ColorToRGB(BackgroundColor)),
                                               GetBValue(ColorToRGB(BackgroundColor))
                                               );

  SurroundColors[0].Initialize(0,
                               GetRValue(ColorToRGB(AParentColor)),
                               GetGValue(ColorToRGB(AParentColor)),
                               GetBValue(ColorToRGB(AParentColor))
                               );

  GradientBrush.SetSurroundColors(SurroundColors);
  Graphics.FillRectangle(GradientBrush, ExpandedRect);

end; 
```

从覆盖的绘制函数中，单选按钮所在的组框不会通过单选按钮控件显示。我没有在其他任何地方设置单选按钮的颜色，我已经检查过它`ParentBackground = true`何时运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T15:38:23.687

问题中发布的图片与代码和代码描述之间存在不一致（请参阅我对问题的评论）。组框的背景应该在组框的绘制周期中绘制。下面的作品（用XE2测试，单选按钮是透明的）：

```
type
  TMyGroupBox = class(TGroupBox)
  protected
    procedure Paint; override;
    procedure PaintBackground(AParentColor : TColor; Graphics: IGPGraphics);
  end;

  ..

procedure TMyGroupBox.Paint;
var
  G: IGPGraphics;
begin
  inherited;
  G := TGPGraphics.Create(Canvas.Handle);
  PaintBackground(clYellow, G);
end;

procedure TMyGroupBox.PaintBackground(AParentColor: TColor; Graphics: IGPGraphics);
var
  ..
begin
  // Same as in the question. Of course the rectangle should be calculated
  // based on the positions of radio button...
  .. 
```

* * *

下面是一个如何将其与样式结合的示例（我想知道这是否容易）：

```
uses
  .., gdiplus;

type
  TGroupBoxStyleHook = class(vcl.stdctrls.TGroupBoxStyleHook)
  strict protected
    procedure PaintBackground(Canvas: TCanvas); override;
  end;

  TGroupBox = class(vcl.stdctrls.TGroupBox)
  private
    FButtonSize: Integer;
    FGradientMargin: Integer;
    function GetButtonSize: Integer;
  protected
    procedure Paint; override;
    procedure PaintBackground(AParentColor: TColor; Graphics: IGPGraphics);
    procedure CMWininichange(var Message: TMessage); message CM_WININICHANGE;
    property ButtonSize: Integer read GetButtonSize;
  public
    constructor Create(AOwner: TComponent); override;
  published
    property GradientMargin: Integer
        read FGradientMargin write FGradientMargin default 10;
  end;

  TForm1 = class(TForm)
    GroupBox1: TGroupBox;
    RadioButton1: TRadioButton;
    RadioButton2: TRadioButton;
    Button1: TButton;
  end;

var
  Form1: TForm1;

implementation

uses
  themes, uxtheme;

{$R *.dfm}

{ TGroupBoxStyleHook }

procedure TGroupBoxStyleHook.PaintBackground(Canvas: TCanvas);
var
  G: IGPGraphics;
begin
  inherited;
  G := TGPGraphics.Create(Canvas.Handle);
  (Control as TGroupBox).PaintBackground(clYellow, G);
end;

{ TGroupBox }

constructor TGroupBox.Create(AOwner: TComponent);
begin
  inherited;
  FGradientMargin := 10;
  TCustomStyleEngine.RegisterStyleHook(TCustomGroupBox, TGroupBoxStyleHook);
end;

procedure TGroupBox.CMWininichange(var Message: TMessage);
begin
  FButtonSize := 0;
  inherited;
end;

function TGroupBox.GetButtonSize: Integer;
var
  Size: TSize;
begin
  Result := FButtonSize;
  if StyleServices.Enabled and (Result = 0) then begin
    TStyleManager.SystemStyle.GetElementSize(0,
        TStyleManager.SystemStyle.GetElementDetails(tbRadioButtonCheckedNormal),
        TRect.Empty, esActual, Size);
    FButtonSize := Size.cx;
    Result := FButtonSize;
  end;
end;

procedure TGroupBox.PaintBackground(AParentColor: TColor; Graphics: IGPGraphics);
const
  BackGroundColor = clBlue;
var
  R: TRect;
  i: Integer;

  ExpandedRect : TGPRect;
  Path : IGPGraphicsPath;
  GradientBrush : IGPPathGradientBrush;
  SurroundColors : array[0..0] of TGPColor;
begin
  for i := 0 to ControlCount - 1 do begin
    if Controls[i] is TRadioButton then begin

      // Don't know what ExpandBorder is.
      //  ExpandedRect := TGPRect.Create(ExpandBorder(BoundsRect, 10));
      R := Controls[i].BoundsRect;
      R.Inflate(GradientMargin, GradientMargin);
      R.Right := R.Left + 2 * GradientMargin + ButtonSize;
      ExpandedRect := TGPRect.Create(R);

      Path := TGPGraphicsPath.Create;
      Path.AddRectangle(ExpandedRect);
      GradientBrush :=  TGPPathGradientBrush.Create(Path);

      GradientBrush.CenterColor := TGPColor.Create(255,
                                         GetRValue(ColorToRGB(BackgroundColor)),
                                         GetGValue(ColorToRGB(BackgroundColor)),
                                         GetBValue(ColorToRGB(BackgroundColor))
                                         );
      SurroundColors[0].Initialize(0,
                                   GetRValue(ColorToRGB(AParentColor)),
                                   GetGValue(ColorToRGB(AParentColor)),
                                   GetBValue(ColorToRGB(AParentColor))
                                   );
      GradientBrush.SetSurroundColors(SurroundColors);
      Graphics.FillRectangle(GradientBrush, ExpandedRect);
    end;
  end;
end;

procedure TGroupBox.Paint;
var
  G: IGPGraphics;
begin
  //  'Paint' is not called with styles other than the SystemStyle
  inherited;

  // Do not draw the background with no runtime themes (no default transparency)
  if StyleServices.Enabled then begin
    G := TGPGraphics.Create(Canvas.Handle);
    PaintBackground(clRed, G); // I don't notice any effect of color passed here
  end;
end; 
```

看起来像：
默认![窗户风格](../Images/822b1cfbc7217bbde9ab45d6ba80b014.png)，样式![紫水晶 Kamri 风格](../Images/e69284d1bb08f1b201efaca22d0ca54b.png)

# javascript - 检查返回 true 失败

> ID：10687244
> 
> 赞同：0
> 
> 时间：2012-05-21T14:31:41.867
> 
> 标签：javascript, jquery, jquery-mobile

我遇到了一个让我很生气的问题。这是我的代码：

```
$('.somediv.btn-2').live('click', function() {
    if (addToCart()) {
        var container = $(this).parent();
        container.hide();
        container.next().show();
    }
});

function addToCart() {
    // ...
    return true
} 
```

由于某种原因，容器永远不会被隐藏。

虽然如果我只是隐藏它而没有`if()`它的工作原理。该函数进行 AJAX 调用并`true`在成功时返回。当我查看调用时，它们确实返回了成功，因此它应该返回 true。

非常感谢。

编辑：我尝试使用 console.log(addToCart()) 查看控制台，它显示未定义

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:35:03.187

您不能让函数在异步 AJAX 调用成功时同步返回 true。

像这样将回调作为 ajax 成功函数传递

```
success: function () {
    var container = $(this).parent();
    container.hide();
    container.next().show();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:37:18.470

由于您的`addToCart()`函数是异步的，因此您需要使用回调而不是返回值。您的代码应如下所示：

```
$('.somediv.btn-2').live('click', function() {
    addToCart(function() {
        var container = $(this).parent();
        container.hide();
        container.next().show();
    });
});

function addToCart(successCallback) {
    // instead of return true you'd have
    successCallback();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:36:09.087

为什么不将“if”块的内容作为回调方法发送，以便在 addToCart 中的 ajax 调用成功完成后调用？

所以你的代码看起来更像这样：

```
$('.somediv').live('click', function() {
   $.ajax({
        .
        .
        success: function() {
              var container = $(this).parent();
               .
               .
         }
    });
  }); 
```

# ios - iOS 4 应用程序图标未显示

> ID：10687253
> 
> 赞同：0
> 
> 时间：2012-05-21T14:32:09.250
> 
> 标签：ios, xcode, xcode4, ios4, xcode4.3

我已经在 App Store 应用程序中获得批准，它在 iOS 5 中正确显示它的图标，但在 iOS 4 中没有这样做（至少在 4.2.1 中）。相反，会出现默认值。我相信我在 Info.plist（图标文件和图标文件（iOS 5））中正确设置了图标。我完全不知道会是什么。

我的图标名称确实与“Icon.png”等不同，但我相信 Apple 说这个文件名仅在 iOS < 3.2 中是必需的。

> 如果您的 iPhone 应用程序在 iOS 3.1.3 或更早版本中运行，系统不会使用您的 Info.plist 文件查找图标。CFBundleIcons 键是在 iOS 5.0 中引入的，CFBundleIconFiles 键是在 iOS 3.2 中引入的。

（在[https://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW1](https://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)）

奇怪的是，我将我的图标重命名为该命名方案并且它起作用了。直到我决定将它们添加到 Xcode 摘要项目中的各个字段中。但即使我想要我也不能使用这个方案，因为我有不同的目标和不同的图标。

有谁知道会发生什么？

编辑：

我尝试将名称更改为其他名称（将我以前的命名方案中的`@`an替换`~`为 a - iOS 中图像的默认值）并且它适用于 iOS 4 和 5。不知道为什么。`_`而且我不确定这是问题所在（iOS 4 不能识别带有这些字符的图标的文件吗？）或者我只是弄乱了一些设置，但它可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:06:29.543

额外提示：如果且仅当您遇到图标未显示的问题时，请从模拟器中删除应用程序，然后再次部署到模拟器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:29:34.027

尝试从 GUI 添加它们 - 就像[在这里](http://www.caplexwebclient.cmfirsttech.com/wp-content/uploads/2012/04/ProjectInfo.png)

祝你好运 ！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T19:21:22.100

看看 info.plist

我在 ícon 部分有 13 条记录，包括 default.png 和 icon.png（默认高于 icon）。

这就是为什么它显示错误的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T11:57:33.157

您的 plist 是否有**两个**图标条目？从 iOS 5 开始，应用程序图标有了新的调用。我想知道您是否只设置了此字段，但没有设置旧字段？

plist 中的旧（原始）字段是“**图标文件**”，它是一个*Array*。

plist 中的新（iOS 5）字段是“**图标文件（iOS 5）** ”，它是一个*Dictionary*。其下的第一个值是“**主图标**”，也是*字典*，然后是**图标文件** *数组*。

当您使用 GUI 添加图标时，它们应该会自动生成，但是值得检查它们是否都在那里并且具有正确的信息，因为您遇到了麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T16:26:58.883

不知道发生了什么，但为了解决“即使我想要我也不能使用这个方案，因为我有不同的目标和不同的图标”的断言

您完全可以通过将图标放在单独的文件夹中来做到这一点。例如，您的项目文件夹布局（在磁盘上，而不是 Xcode 项目上）可能如下所示：

*   我的项目/
    *   我的项目.xcodeproj/
    *   我的第一个应用程序/
        *   图标.png
        *   图标@2x.png
    *   我的第二个应用程序/
        *   图标.png
        *   图标@2x.png

您可以将所有这些文件添加到您的项目中，确保每个文件只与正确的目标相关联。当您添加文件时，Xcode 会询问您与哪个目标关联，或者您可以随时在信息面板（窗口右侧）中更改它。

如果您没有意识到这一点，您可能已经将所有图标文件添加到所有目标中，在这种情况下，您会不必要地增大应用程序的大小。

# ios - UITextView 的背景图片

> ID：10687258
> 
> 赞同：1
> 
> 时间：2012-05-21T14:32:17.527
> 
> 标签：ios, xcode, image, uitextview

我在为 UITextView 实现背景图像时遇到问题。我遇到的问题是实际文本的大小未知，背景图像滚动然后变成白屏。如何让背景图像与 textView 的大小相同？我通过 Storyboard 设置了背景图像，并通过代码将子视图添加到 textView。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:40:02.637

使用[resizableImageWithCapInsets:](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/occ/instm/UIImage/resizableImageWithCapInsets%3a)将图像“拉伸”到与 TextView 一样大。

# entity-framework - 更改 t4template 以添加详细说明

> ID：10687261
> 
> 赞同：0
> 
> 时间：2012-05-21T14:32:32.990
> 
> 标签：entity-framework

我使用 t4template 为实体创建 C# 类。这些生成的类中缺少的一件事是我在实体框架设计器中输入的文档。

有谁知道我可以使用哪个语句将属性的长描述添加到生成的代码中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T17:19:16.497

T4 模板中表示实体和属性的对象具有公开此信息的文档属性。请参阅[System.Data.Metadata.Edm.Documentation](http://msdn.microsoft.com/en-us/library/system.data.metadata.edm.documentation.aspx)。

# excel - 动态替换vba中的文本

> ID：10687262
> 
> 赞同：4
> 
> 时间：2012-05-21T14:32:36.497
> 
> 标签：excel, vba

我正在尝试创建一个例程来替换给定字符串中可变数量的值。例如，如果我在电子表格中有一个基本文本：

“您选择的车辆 {0} 表明您应该有 {1} 到 {2} 个轮胎。但是，您已为此车辆输入了 {3} 个轮胎。请相应地更新记录。”</p>

我想用应用程序中的常量值或用户输入的其他变量替换标记。我正在尝试创建一个带有如下签名的例程，其中 RowID 是电子表格中基本文本所在的行，ReplacementValues 是一个包含 n 个变量的数组：

```
Sub ShowMsg(ByVal RowID As Integer, Optional ByVal ReplacementValues As Variant) 
```

我无法弄清楚如何在每次迭代中不重复基本消息的整个文本的情况下遍历文本并替换每个标记。如果可能的话，我想保持例程相当通用，而不是特定于 Excel，以防我以后需要将应用程序移动到数据库中。

希望我已经充分解释了这一点；任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:55:47.197

你可以;

```
Sub ShowMsg(ByVal RowID As Integer, Optional ReplacementValues As Variant)
Dim data As String, i As Long
If Not IsMissing(ReplacementValues) Then
    data = Range("A" & RowID).Value
    For i = 0 To UBound(ReplacementValues)
        data = Replace(data, "{" & i & "}", ReplacementValues(i))
    Next
    msgbox data
End If
End Sub 
```

调用；

```
Dim a() As Variant: a = Array("aa", "bb", "cc")
ShowMsg 8, a 
```

或替代方案：

```
Sub ShowMsg(ByVal RowID As Integer, ParamArray ReplacementValues() As Variant)
Dim data As String, i As Long
If Not IsMissing(ReplacementValues) Then
    data = Range("A" & RowID).Value
    If IsArray(ReplacementValues(0)) Then ReplacementValues = ReplacementValues(0)
    For i = 0 To UBound(ReplacementValues)
        data = Replace(data, "{" & i & "}", ReplacementValues(i))
    Next
    msgbox data
End If
End Sub 
```

可以以相同的方式调用，也可以通过序数参数额外调用；

```
ShowMsg 8, "aa", "bb", "cc" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:55:28.850

首先将您的基本字符串更改为这样的

```
BaseString = "Your vehicle selection of {VEHSEL} indicates you should have " & _
             "between {nTYRE1} and {nTYRE2} tires. However, you have entered " & _
             "{nTotTYRE} tires for this vehicle. Please update the record " & _
             "accordingly." 
```

如果您现在注意到您有特定的**关键字**，例如

```
VEHSEL - Vehicle Selection
nTYRE1 - Lowest selection of tires
nTYRE2 - Highest selection of tires
nTotTYRE - Total tires selected 
```

从电子表格中获取值后，只需使用相关值`REPLACE`替换上述**关键字**

所以你的代码看起来像

```
Option Explicit

Sub Sample()
    Dim lVSell As Long, lT1  As Long, lT2  As Long, ltotT As Long
    Dim lRowID As Long

    lRowID = 5

    With Sheets("Sheet1")
        lVSell = .Range("A" & lRowID).Value
        lT1 = .Range("B" & lRowID).Value
        lT2 = .Range("C" & lRowID).Value
        ltotT = .Range("D" & lRowID).Value

        Debug.Print ShowMsg(lRowID, lVSell, lT1, lT2, ltotT)
    End With
End Sub

Function ShowMsg(ByVal RowID As Integer, ByVal VSel As Long, _
ByVal T1 As Long, ByVal T2 As Long, ByVal totT As Long) As String
    Dim BaseString As String

    BaseString = "Your vehicle selection of {VEHSEL} indicates you should have " & _
                 "between {nTYRE1} and {nTYRE2} tires. However, you have entered " & _
                 "{nTotTYRE} tires for this vehicle. Please update the record " & _
                 "accordingly."

    BaseString = Replace(BaseString, "VEHSEL", VSel)
    BaseString = Replace(BaseString, "nTYRE1", T1)
    BaseString = Replace(BaseString, "nTYRE2", T2)
    BaseString = Replace(BaseString, "nTotTYRE", totT)

    ShowMsg = BaseString
End Function 
```

我假设这些值存储在表 1 中，范围从 A5 到 D5。

**编辑**

**快照**

![在此处输入图像描述](../Images/647dae1aabe9dc9c5d7d6f669b8c8f34.png) 高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:08:12.370

**你可以试试这个**

```
Sub test()
    Dim x As Variant
    x = Split("<String0>,<String1>,<String2>", ",")
    ShowMsg 23, "A", x
End Sub

Sub ShowMsg(ByVal RowID As Integer, ColID As String, Optional ByVal ReplacementValues As Variant)
    Dim nText$
    nText = Cells(RowID, ColID)
    For pos = LBound(ReplacementValues) To UBound(ReplacementValues)
        Dim searchtext$
        searchtext = "{" & CStr(pos) & "}"
        nText = Replace(nText, searchtext, ReplacementValues(pos))
    Next pos
    MsgBox nText
End Sub 
```

# jquery - 如何使用jquery从下到上动画改变div高度

> ID：10687265
> 
> 赞同：6
> 
> 时间：2012-05-21T14:32:38.073
> 
> 标签：jquery, jquery-animate

无论如何我可以动画从下到上而不是从上到下更改 div 框高度？

这个 div 框是绝对定位的，它的作用有点像它下面的内容的窗帘。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T14:46:05.850

为什么不使用`slideUp()`/ `slideDown()`：

因为如果注册了多个/快速鼠标操作，它很容易出现错误。
在演示中尝试，即使使用`.stop()`方法也无法达到如下结果：

* * *

这是使用`.animate()`和高度切换的轻微修改：（只需要`position:absolute; bottom:0px; display:none;`：）

## *[演示 1（一个很好的方法）](http://jsbin.com/udiriv/52/edit)*

```
$('.box').hover(function(){
  $(this).find('.curtain').stop().animate({height: 'toggle'});
}); 
```

* * *

## *[演示 2](http://jsbin.com/udiriv/edit#javascript,html,live)*

另一种方法是：

```
var boxHeight = $('.box').innerHeight();  // get element height

$('.curtain').css({top:boxHeight}); // push 'curtain' down

$('.box').hover(function(){
  $(this).find('.curtain').stop().animate({top: 0});  // animate to desired top distance
},function(){
  $(this).find('.curtain').stop().animate({top: boxHeight}); // and on mouseout - back down
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:35:46.683

```
$('div').slideUp(); 
```

这使用[.slideUp()](http://api.jquery.com/slideUp/)将 div 设置为`0px`从下到上的高度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T18:12:26.643

您可以通过同时为顶部和高度设置动画来实现此效果。您只需要确定最终高度。

例如，假设您有：

```
#mydiv{
    top: 200px;
    height: 300px;
    width: 100px;
    background-color: red;
    position: absolute;
}; 
```

并且您希望最终将 div 动画化为：

```
#mydiv{
    top: 0px; /* new top */
    height: 500px; /* new height */
    width: 100px;
    background-color: red;
    position: absolute;
}; 
```

jquery 代码，当您单击 div 时：

```
$("#mydiv").on("click", function(){
   $('#mydiv').animate( {"top": "0px", "height": "500px" } );
}); 
```

# php - 使用php将图像转换为字节

> ID：10687270
> 
> 赞同：7
> 
> 时间：2012-05-21T14:33:08.320
> 
> 标签：php, bytearray

我必须将图片发送到网络服务。Web 服务应该将图像作为字节（可能是字节数组）接收 - 而不是作为字符串......如何将图像转换为“字节”或字节数组？

我试过这个（没有成功）：

```
$image1 = file_get_contents("LINK TO IMAGE");
$image1BinaryData = "".base64_encode($image1).""; 
```

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T14:41:57.810

Have you tried to directly read the image as binary data?

```
<?php
$filename = "image.png";
$file = fopen($filename, "rb");
$contents = fread($file, filesize($filename));
fclose($file);
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T12:07:24.057

这是等效于 C# 和 Java 中生成的实际字节数组。

```
$data = file_get_contents("test.jpg");

$array = array(); 
foreach(str_split($data) as $char){ 
    array_push($array, ord($char)); 
}
var_dump(implode(' ', $array)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:38:25.980

一个 php 字符串是二进制的，所以它已经是字节。

摆脱 base64_encode() 并使用 urlencode() 或 rawurlencode()

# php - 如何使用 PHP/MySQL 创建和构建虚拟积分系统

> ID：10687274
> 
> 赞同：2
> 
> 时间：2012-05-21T14:33:16.223
> 
> 标签：php, mysql, payment-gateway, payment, credits

在 PHP/MySQL 中构建虚拟积分系统的最佳方法是什么？

我显然需要为每笔交易（借方/贷方）提供一张表格。我想我需要该表中的以下列：

*   `TransactionID`（唯一的交易 ID 从 1 开始，自动递增）

*   `UserID`（主用户表中的用户唯一 ID）

*   `Type`（赚取、购买、花费等）

*   `ItemID`（如果花在一个项目上）

*   `Amount`（正面或负面）。

问题：

**1) 我需要此表中的任何其他列吗？**

**2）为此我需要任何其他表格吗？**

例如，我是否需要另一个表来跟踪每个用户的总数？还是我会简单地将每个用户的总数计算为他们所有交易的总和？

起初，这个信用系统将纯粹是“玩钱”，但我确实希望将来添加一个“购买信用”选项，所以也许我应该为 3rd 方支付处理器 Unique Transaction ID 添加一列？或者我应该为购买的积分创建一个单独的表，然后通过我的脚本将两者联系在一起（例如总积分 = 获得的积分 + 购买的积分 - 花费的积分）？

除了回答我上面的问题之外，我将不胜感激任何和所有的见解和想法，包括指向如何解决这个问题的具体文章的链接，因为我以前从未编写过这样的东西。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:13:02.173

一些笔记。

我认为，如果您想建立一个处理财务的可靠系统，那么使用金融界的一些基本概念是有意义的。我不想说您必须完全实现所有会计功能，但很多事情对我来说似乎是合理的。

首先，金融交易涉及将钱从一个账户转移到另一个账户，所以`user_id`我不会使用`account_id`. 每个用户可能有多个帐户，每个帐户都有一个类型（查找）和货币。另外，我会避免使用“用户”一词来支持“派对”（派对角色关系模型）。

其次，总是至少涉及两方：资金从一个账户转移到另一个账户。购买物品时，个人账户余额减少，组织账户余额增加。

另外，我不会使用`item_id`，而是使用`event_id`. 每笔交易都与一个业务事件相关联。事件是系统中可能发生的各种事件的公共父表。每个`Event`的详细信息表都将保存特定于事件类型的信息。例如，您可以拥有`purchase_event`,`deposit_event`等。

因为`transaction`table 是许多（可能是数千个）插入的主题，所以我不会在每次需要帐户余额时查询它。`account`在表格中保持合并余额是有意义的。

我希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:26:07.857

除非你真的知道系统应该做什么，否则很难说数据库的架构。但我还是试试。

我认为在一张表中存储这么多信息不是一个好主意。

我会以这种方式做得更好 -`transactions(id, user_id, amount, timestamp)`这张表包含有关每笔付款的最少信息。

其他一切都是分开的，例如`transactions_types(transaction_id, type)`和`transactions_items(transaction_id, item)`

关于学分。如果购买的货币相同，您只需再添加一种交易类型，如有必要，将表格添加为`transactions_psid(transaction_id, psid)`.

如果货币不同，则完全取决于系统上的负载。只有一个具有唯一 transaction_id 的表是好的，直到它变得太多记录。

# html - CSS下拉菜单，父级不可点击

> ID：10687277
> 
> 赞同：0
> 
> 时间：2012-05-21T14:33:26.390
> 
> 标签：html, css

我创建了一个[CSS 飞出菜单](http://jsfiddle.net/JsVr4/)。似乎在悬停时飞出子菜单，这就是我需要的。我唯一的问题是当 li a 有一个子菜单时，你不能点击顶级菜单项。我可以在 Firebug 中看到它覆盖在顶部。

有什么建议我可以解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:44:10.423

如果你给子菜单 ul 一个减 z-index 这将解决你的问题。

```
#nav ul ul {
    display: none;
    z-index: -1;
    } 
```

这是更新的 jsfiddle [http://jsfiddle.net/JsVr4/3/](http://jsfiddle.net/JsVr4/3/)

**编辑**

查看该网站后，我对我的答案进行了更改。

`#nav ul ul li`首先在您的from中更改以下内容

```
#nav ul ul li {
    top: 42px;
    } 
```

到

```
#nav ul ul li {
    top: 0px;
    } 
```

然后将以下内容添加到`#nav ul ul`

```
#nav ul ul {
    display: none;
    position: relative;
    margin-top: 32px;
    padding-top: 10px;
    } 
```

这将解决问题。位于`#nav ul ul`导致问题的标签上方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:45:24.110

我认为您的问题与您为 li 标签赋予“顶级”属性的方式有关。只需删除该属性并将其放入嵌套的无序列表标签中将有很大帮助（如下所示），否则您的子菜单会与您的菜单重叠。

```
#nav ul ul {
  left: 0;
  list-style: none outside none;
  padding:0;
  position: absolute;
  top: 38px; /* this is what I added */
} 
```

我在 jsfiddle 中做了我自己的版本。看看这里：http: [//jsfiddle.net/akiryk/EJ8u2/2/](http://jsfiddle.net/akiryk/EJ8u2/2/)

另外，我建议花一点时间查看一些关于使用 CSS 和列表的基础知识的有用教程。

来自 alistapart 的一个好旧的：[http ://www.alistapart.com/articles/horizdropdowns/](http://www.alistapart.com/articles/horizdropdowns/)

# java - 文本区域 (JTextArea) 的自动文本滚动，插入符号位置设置为最后一行的开头

> ID：10687281
> 
> 赞同：13
> 
> 时间：2012-05-21T14:33:33.533
> 
> 标签：java, swing, jtextarea, caret, autoscroll

我在这里有一个简单的 Java 问题。我想将文本自动滚动到使用 JTextArea 创建的文本区域的最后一行的开头。文本区域每行的文本量远大于文本区域的宽度。

这是我用来设置它的代码片段。

```
JTextArea textArea = new JTextArea();
DefaultCaret caret = (DefaultCaret)textArea.getCaret();
caret.setUpdatePolicy(DefaultCaret.ALWAYS_UPDATE); 
```

现在的问题是，使用上面的代码，默认行为是插入符号自动定位到文档的末尾，结果，整个文本区域的开始部分超出了范围。我希望自动滚动发生在文档最后一行的开头。

为了清楚起见，这里有两个屏幕截图，

我想要的是第一个，但正在发生的是第二个。

![我想要的是这个](../Images/c2bb11674c472cf0485e50454798d312.png) ![我得到的是这个](../Images/cb42dce946bf957e771fe86ca58025b3.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-21T14:45:22.480

Simply move the caret to the correct location using `getLineCount` and `getLineStartOffset` after updating the text of the textarea.

Here is a working example illustrating your desired behaviour:

```
import java.util.List;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;
import javax.swing.text.BadLocationException;
import javax.swing.text.DefaultCaret;

public class Test {

    private JFrame frame;
    private JTextArea ta;

    protected void initUI() {
        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        ta = new JTextArea();
        DefaultCaret caret = (DefaultCaret) ta.getCaret();
        caret.setUpdatePolicy(DefaultCaret.ALWAYS_UPDATE);
        frame.add(new JScrollPane(ta));
        frame.setSize(400, 200);
        frame.setVisible(true);
        new UpdateText().execute();
    }

    class UpdateText extends SwingWorker<String, String> {

        @Override
        public String doInBackground() {
            for (int i = 0; i < 1000; i++) {
                publish("Hello-" + i);
                try {
                    Thread.sleep(500);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
            return null;
        }

        @Override
        public void process(List<String> chunks) {
            for (String s : chunks) {
                if (ta.getDocument().getLength() > 0) {
                    ta.append("\n");
                }
                ta.append(s);
            }
            try {
                ta.setCaretPosition(ta.getLineStartOffset(ta.getLineCount() - 1));
            } catch (BadLocationException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        @Override
        public void done() {

        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().initUI();
            }
        });
    }

} 
```

# python - Django 联合框架

> ID：10687285
> 
> 赞同：0
> 
> 时间：2012-05-21T14:33:53.773
> 
> 标签：python, django, django-rss

如何将图像添加到 rss 提要，这是我的代码片段

```
class ArticlesRss(Feed):
    description_template = 'feeds/city_description.html'
    def get_object(self, request, categoryid):
        if categoryid == 'all':
            return False
        else:
            catobj = ArticleCategory.objects.get(id = categoryid)
            return catobj
    # set the category values
    def title(self, obj):
        if obj:
            return obj.name
        else:
            return _('Latest Article')
    def link(self, obj):
        if obj:
            return obj.get_absolute_url()
        else:
            return global_settings.website_url
    #  set the one by one objects
    def item_title(self, item):
        return item.title
    def item_description(self, item):
        return item.summary
    def items(self, obj):
        if obj:
            return Article.objects.filter(category = obj,status='P').order_by('-id')[:15]
        else:
            return Article.objects.filter(status='P').order_by('-id')[:50] 
```

我想在文章提要中添加图片（article_photo 是字段名称），如何将图片添加到提要中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:56:29.807

请参阅[Django 文档中标题为“附件”的部分](https://docs.djangoproject.com/en/dev/ref/contrib/syndication/#enclosures)

# vb.net - How to sort a observablecollection(of String)

> ID：10687291
> 
> 赞同：0
> 
> 时间：2012-05-21T14:34:10.927
> 
> 标签：vb.net, observablecollection

All I need is a simple way to sort the strings in the collection. I can't find anything online. Everybody is using lambda expressions which I don't think works for just a string collection? Thanks,

```
 Public Property FilterCollection As New ObservableCollection(Of String)

  From d In FilterCollection Order By (Function(d) d)() 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-22T19:34:19.517

我的 VB.Net 生锈了，但试试

```
Dim sortedCollection = FilterCollection.OrderBy(Function(s) s) 
```

# quartz-scheduler - How do I declare a one-time simple trigger with the Quartz XML plugin?

> ID：10687304
> 
> 赞同：5
> 
> 时间：2012-05-21T14:35:00.293
> 
> 标签：quartz-scheduler

I'm trying to set up a job such that it runs once the first time my scheduler is started, then once at midnight every day after that. Here is my XML for the job and triggers. The once a day trigger works, but the one-time trigger does not.

```
 <job>
      <name>MyJob</name>
      <group>MyJobGroup</group>
      <job-type>MyScheduledJob, MyJobAssembly</job-type>
      <description>My job, yo</description>
      <durable>true</durable>
      <recover>false</recover>
    </job>
    <trigger>
      <cron>
        <name>MyTrigger</name>
        <group>MyTriggerGroup</group>
        <job-name>MyJob</job-name>
        <job-group>MyJobGroup</job-group>
        <cron-expression>0 0 0 1/1 * ? *</cron-expression>
      </cron>
        <simple>
            <name>MyOneTimeTrigger</name>
            <group>MyTriggerGroup</group>
            <description>Run once at startup, G</description>
            <misfire-instruction>SmartPolicy</misfire-instruction>
            <volatile>false</volatile>
            <job-name>MyJob</job-name>
            <job-group>MyJobGroup</job-group>
            <repeat-count>0</repeat-count>
            <repeat-interval>0</repeat-interval> 
      </simple>
    </trigger> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:29:24.433

不起作用*我*猜你的意思是触发器永远不会触发。也许是因为它没有延迟它会失火？`<start-time-seconds-in-future/>`以后有时间再添加怎么样？

```
<simple>
        <name>MyOneTimeTrigger</name>
        <group>MyTriggerGroup</group>
        <description>Run once at startup, G</description>
        <misfire-instruction>SmartPolicy</misfire-instruction>
        <volatile>false</volatile>
        <job-name>MyJob</job-name>
        <job-group>MyJobGroup</job-group>
        <start-time-seconds-in-future>60</start-time-seconds-in-future>
        <repeat-count>0</repeat-count>
        <repeat-interval>0</repeat-interval> 
</simple> 
```

如果它对您有用，您必须注意一些您可能认为是错误或功能的东西：如果您重新启动服务器，因为触发器已经触发并被删除，它将再次触发。请参阅：[Quartz XML 插件重新安排重新启动后触发的触发器](https://stackoverflow.com/questions/10535203)。

# twitter-bootstrap - 为什么 Twitter Bootstrap 表格总是有 100% 的宽度？

> ID：10687306
> 
> 赞同：155
> 
> 时间：2012-05-21T14:35:05.217
> 
> 标签：twitter-bootstrap

假设这个标记：

```
<table class="table table-bordered" align="center"> 
```

不管我有多少单元格，表格总是 100% 宽度。为什么？

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2012-05-21T15:52:55.810

引导程序中的所有表格都根据它们的容器进行拉伸，您可以通过将表格放置在`.span*`您选择的网格元素中轻松地做到这一点。如果您希望删除此属性，您可以创建自己的表类，然后将其添加到要扩展的表中，其中包含以下内容：

```
.table-nonfluid {
   width: auto !important;
} 
```

您可以在自己的样式表中添加此类，然后将其添加到表的容器中，如下所示：

```
<table class="table table-nonfluid"> ... </table> 
```

这样您的更改不会影响引导样式表本身（您可能希望在文档的其他地方有一个流动表）。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-01-12T23:30:19.590

`<table style="width: auto;" ...`工作正常。在 Chrome 38、IE 11 和 Firefox 34 中测试。

jsfiddle：http: [//jsfiddle.net/rpaul/taqodr8o/](http://jsfiddle.net/rpaul/taqodr8o/)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2018-08-14T14:08:44.753

如果您使用的是 Bootstrap 4，请使用`.w-auto`.

请参阅[https://getbootstrap.com/docs/4.1/utilities/sizing/](https://getbootstrap.com/docs/4.1/utilities/sizing/)

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2018-03-13T13:15:10.800

## 引导程序 3：

为什么要打呢？为什么不简单地使用引导网格来控制表格宽度？

```
<div class="row">
    <div class="col-sm-6">
        <table></table>
    </div>
</div> 
```

这将创建一个包含元素宽度的一半（12 个中的 6 个）的表格。

我有时会根据其他答案使用内联样式，但不鼓励这样做。

## 引导程序 4 和 5：

Bootstrap 4 有一些很好的宽度帮助类，如`w-25`, `w-50`, `w-75`,`w-100`和`w-auto`. 这将使表格宽度为 50%：

```
<table class="w-50"></table> 
```

这是文档：[https ://getbootstrap.com/docs/4.0/utilities/sizing/](https://getbootstrap.com/docs/4.0/utilities/sizing/)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-09-30T20:59:40.143

我遇到了同样的问题，我修复了表格，然后指定了我的 td 宽度。如果你有，你也可以这样做。

```
<style>
table {
table-layout: fixed;
word-wrap: break-word;
}
</style>

<td width="10%" /td> 
```

我对 .table-nonfluid 没有任何运气。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-06-16T14:15:15.853

我已经尝试添加`style="width: auto !important"`并且对我很有用！

# bash - Bash 以声明方式定义要循环的列表

> ID：10687313
> 
> 赞同：3
> 
> 时间：2012-05-21T14:35:31.917
> 
> 标签：bash, loops

在 bash 中，我经常制作脚本，在其中循环遍历我定义的字符串列表。

例如

```
for a in 1 2 3 4; do echo $a; done 
```

但是我想定义列表（在循环之前保持干净），以便它包含空格并且没有单独的文件：

例如（但这不起作用）

```
read -r VAR <<HERE
list item 1
list item 2
list item 3
...
HERE

for a in $VAR; do echo $a; done 
```

上面的预期输出（我想要）：

```
list item 1
list item 2
list item 3
etc... 
```

但是你会得到：

```
list
item
1 
```

我可以使用数组，但我必须索引数组中的每个元素（*编辑阅读下面的答案，因为您可以附加到数组..我不知道你可以*）。

**其他人如何在不使用单独文件的情况下以声明方式在 bash 中定义列表？**

*对不起，我忘了提到我想在 for 循环逻辑之前定义**文件顶部的列表***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:42:57.600

您可以像这样使用“HERE 文档”：

```
while read a ; do echo "Line: $a" ; done <<HERE
123 ab c
def aldkfgjlaskdjf lkajsdlfkjlasdjf
asl;kdfj ;laksjdf;lkj asd;lf sdpf -aa8
HERE 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T14:46:50.040

数组并不难使用：

```
readarray <<HERE
this is my first line
this is my second line
this is my third line
HERE

# Pre bash-4, you would need to build the array more explicity
# Just like readarray defaults to MAPFILE, so read defaults to REPLY
# Tip o' the hat to Dennis Williamson for pointing out that arrays
# are easily appended to.
# while read ; do
#    MAPFILE+=("$REPLY")
# done

for a in "${MAPFILE[@]}"; do
    echo "$a"
done 
```

如果您有需要，这具有允许每个列表项包含空格的额外好处。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T14:50:29.183

```
while read -r line
do
    var+=$line$'\n'
done <<EOF
foo bar
baz qux
EOF

while read -r line
do
    echo "[$line]"
done <<<"$var" 
```

为什么需要索引数组？您可以在不使用索引的情况下附加到数组并对其进行迭代。

```
array+=(value)
for item in "${array[@]}"
do
    something with "$item"
done 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T14:58:21.877

这里有更好的答案，但您也可以使用环境变量在循环中分隔读取`\n`并临时更改变量以在换行符上拆分而不是空格。`for``IFS`

```
read -d \n -r VAR <<HERE
list item 1
list item 2
list item 3
HERE

IFS_BAK=$IFS
IFS="\n"
for a in $VAR; do echo $a; done
IFS=$IFS_BAK 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T14:46:21.603

当您可以使用`while`循环而不是`for`循环时，您可以使用`while read`构造和“此处文档”：

```
#!/bin/bash

while read LINE; do
    echo "${LINE}"
done << EOF
list item 1
list item 2
list item 3
EOF 
```

ref: [`cat << EOF` 在 bash 中是如何工作的？](https://stackoverflow.com/questions/2500436/how-does-cat-eof-work-in-bash)

# groovy - 使用 macports 安装 Groovy Mac OSX (10.6.8)

> ID：10687314
> 
> 赞同：2
> 
> 时间：2012-05-21T14:35:36.203
> 
> 标签：groovy, macports

当我从终端使用命令“sudo port install groovy”时，出现以下错误。

```
MyMachine:~ himalay$ sudo port install groovy
--->  Computing dependencies for groovy
--->  Building groovy
Error: org.macports.build for port groovy returned: command execution failed
Please see the log file for port groovy for details:
    /opt/local/var/macports/logs/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/main.log
To report a bug, follow the instructions in the guide:
    http://guide.macports.org/#project.tickets
Error: Processing of port groovy failed 
```

我确实运行了 "sudo port -v selfupdate" ，这也可以。**这是来自main.log**的日志片段

 **```
version:1
:debug:main Found Dependency: path: /usr/bin filename: unzip regex: ^unzip$
:msg:main --->  Computing dependencies for groovy:info:main .:debug:main groovy has no conflicts
:debug:main Found Dependency: path: /usr/bin filename: unzip regex: ^unzip$
:debug:main Searching for dependency: unzip
:debug:main Didn't find receipt, going to depspec regex for: unzip
:debug:main Found Dependency: path: /usr/bin filename: unzip regex: ^unzip$
:msg:main 
:debug:main Executing org.macports.main (groovy)
:debug:main changing euid/egid - current euid: 0 - current egid: 0
:debug:main egid changed to: 501
:debug:main euid changed to: 502
:debug:main Skipping completed org.macports.archivefetch (groovy)
:debug:main Privilege de-escalation not attempted as not running as root.
:debug:main Skipping completed org.macports.fetch (groovy)
:debug:main Privilege de-escalation not attempted as not running as root.
:debug:main Skipping completed org.macports.checksum (groovy)
:debug:main Privilege de-escalation not attempted as not running as root.
:debug:main Skipping completed org.macports.extract (groovy)
:debug:main Privilege de-escalation not attempted as not running as root.
:debug:main Skipping completed org.macports.patch (groovy)
:debug:main Privilege de-escalation not attempted as not running as root.
:debug:main Skipping completed org.macports.configure (groovy)
:debug:main Privilege de-escalation not attempted as not running as root.
:debug:build build phase started at Sat May 19 09:25:19 EDT 2012
:notice:build --->  Building groovy
:debug:build Executing org.macports.build (groovy)
:debug:build Environment: CPATH='/opt/local/include' CC_PRINT_OPTIONS_FILE='/opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/.CC_PRINT_OPTIONS' LIBRARY_PATH='/opt/local/lib' CC_PRINT_OPTIONS='YES' MACOSX_DEPLOYMENT_TARGET='10.6'
:debug:build Assembled command: 'cd "/opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6" && ant install -DskipTests=true'
:debug:build Executing command line:  cd "/opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6" && ant install -DskipTests=true 
:info:build Buildfile: /opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6/build.xml
:info:build Trying to override old definition of task javac
:info:build 
:info:build -excludeLegacyAntVersion:
:info:build 
:info:build -checkAntVersion:
:info:build 
:info:build -banner:
:info:build      [echo] Java Runtime Environment version: 1.6.0_31
:info:build      [echo] Java Runtime Environment vendor: Apple Inc.
:info:build      [echo] Ant version: Apache Ant(TM) version 1.8.2 compiled on November 19 2011
:info:build      [echo] Operating system name: Mac OS X
:info:build      [echo] Operating system architecture: x86_64
:info:build      [echo] Operating system version: 10.6.8
:info:build      [echo] Base directory: /opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6
:info:build      [echo] Java Home: /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
:info:build 
:info:build -initializeReports:
:info:build 
:info:build -mavenTaskdef:
:info:build 
:info:build -mavenPomDefinitions:
:info:build 
:info:build -mavenInit:
:info:build 
:info:build -mavenFetchAllModules:
:info:build [artifact:dependencies] [WARNING] POM for 'antlr:antlr:pom:2.7.7:compile' is invalid.
:info:build [artifact:dependencies] 
:info:build [artifact:dependencies] Its dependencies (if any) will NOT be available to the current build.
:info:build [artifact:dependencies] [WARNING] POM for 'asm:asm:pom:3.2:compile' is invalid.
:info:build [artifact:dependencies] 
:info:build [artifact:dependencies] Its dependencies (if any) will NOT be available to the current build.
:info:build [artifact:dependencies] [WARNING] POM for 'junit:junit:pom:4.10:compile' is invalid.
:info:build [artifact:dependencies] 
:info:build [artifact:dependencies] Its dependencies (if any) will NOT be available to the current build.
:info:build [artifact:dependencies] [WARNING] POM for 'commons-cli:commons-cli:pom:1.2:compile' is invalid.
:info:build [artifact:dependencies] 
:info:build [artifact:dependencies] Its dependencies (if any) will NOT be available to the current build.
:info:build [artifact:dependencies] [WARNING] POM for 'org.apache.ant:ant:pom:1.8.2:compile' is invalid.
:info:build [artifact:dependencies] 
:info:build [artifact:dependencies] Its dependencies (if any) will NOT be available to the current build.

---
---
---

---
---

:info:build -jvm14BuildWarning:
:info:build 
:info:build stagedcompile:
:info:build     [javac] Compiling 835 source files to /opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6/target/classes
:info:build     [javac] error: error reading /opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6/target/lib/compile/ant-1.8.2.jar; cannot read zip file
:info:build     [javac] /opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6/src/main/groovy/beans/BindableASTTransformation.java:35: package org.objectweb.asm does not exist
:info:build     [javac] import org.objectweb.asm.Opcodes;
:info:build     [javac]                         ^
:info:build     [javac] /opt/local/var/macports/build/_opt_local_var_macports_sources_www.macports.org_files_ports_java_groovy/groovy/work/groovy-1.8.6/src/main/groovy/beans/BindableASTTransformation.java:58: cannot find symbol 
```

……………………

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T23:49:03.130

**sudo port install groovy**根本不适合我，我使用了以下。

```
1\. Download groovy from http://groovy.codehaus.org/Download
2\. Unpack and move to /usr/share'
   ◦$ sudo mv ~/Downloads/groovy-1.8.6 /usr/share/
3\. Change ownership and permissions
   ◦$cd /usr/share
   ◦$sudo chown -R root:wheel groovy-1.8.6
   ◦$sudo chmod 0755 groovy-1.8.6/bin/*
4\. Create symlink 
   ◦$sudo ln -s groovy-1.8.6 groovy
5\. Add GROOVY_HOME and change PATH (in /etc/profile or ~/.profile or ~/.bash_profile)
   ◦export GROOVY_HOME=/usr/share/groovy
   ◦PATH=$GROOVY_HOME/bin:$PATH; export PATH
6\. Test Installation : 
   ◦groovyConsole : Creates an interactive groovy shell where you can type Groovy statements
   ◦groovysh : Swing interactive console 
```**

# javascript - IndexedDb - 检查表是否存在并包含数据

> ID：10687315
> 
> 赞同：2
> 
> 时间：2012-05-21T14:35:37.573
> 
> 标签：javascript, html, indexeddb, jaydata

在我的应用程序第一次运行时使用 IndexedDB 我用一些数据填充它，我想确保在创建数据库和表时它们不存在。

我可以查询表的长度以查看它是否包含 JavaScript 中的数据吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-10-13T14:31:40.240

最好的方法是尝试在 try catch 块中打开 objectStore。它也是同步的。如果出现错误，您可以创建商店，例如：

```
var store;
  try {
    store = request.transaction.objectStore('yourStore');
  }
  catch(e) {
    store = db.createObjectStore('yourStore');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T13:28:53.203

您可以使用[objectStore.count()](https://developer.mozilla.org/en/IndexedDB/IDBObjectStore#count%28%29)函数，但我建议存储某种表示您的本地数据库已初始化的元数据。否则，您可以在数据创建过程中重新加载页面，并且永远不会让您的数据与远程数据完全同步。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-06T04:56:49.810

如果具有指定名称的数据库不存在，则创建数据库，否则将打开它

例如。`var request = indexedDB.open("DataTbl");`

因此，如果您的数据库已经存在，它只会打开它并检查表中的内容是否已经存在，然后您可以创建一个 xyz 对象存储并在其中存储一些键/值标志对，表示插入成功并稍后检查每次重新加载页面时。

您也可以尝试计算@toske 指定的函数

参考：

*   [http://www.ibm.com/developerworks/library/wa-indexeddb/](http://www.ibm.com/developerworks/library/wa-indexeddb/)

*   [http://www.w3.org/TR/IndexedDB/](http://www.w3.org/TR/IndexedDB/)

# c++ - 如何使用 boost bind 组合多个仿函数？

> ID：10687316
> 
> 赞同：2
> 
> 时间：2012-05-21T14:35:41.147
> 
> 标签：c++, boost, lambda, boost-bind

我有一种情况，我有一系列成员函数，它们产生关于目标对象的简单信息：

```
double MyDoc::GetX(thing)
double MyDoc::GetY(thing)
etc. 
```

我在同一个类中做了一些“漂亮的格式化”成员函数：

```
string MyDoc::PrintOne(thing, std::function<double (THING*)>) 
```

您会注意到漂亮打印机函数采用数据函数——即它是可组合的，因此我可以创建有关目标的各种类型的信息并为其生成“漂亮打印”字符串。

在直接使用中，这种技术效果很好。

但是，我目前的应用程序真正想要的是组合这些实体的多层 - 即有效地为上述组合整体创建一个仿函数（函数对象），这样我就可以指定漂亮的打印机函数，它是数据 -获取函数，稍后调用。模式是 z(x) -> f(x, g(x))：

```
auto Z = [&] (THING* thing) {
    return boost::bind(
        &MyDoc::PrintOne,
        this,
        _1,
        boost::bind(MyDoc::GetX, this, _1));
} 
```

这就是我遇到问题的地方。我绕着圈子试图让语法正确，或者我对 boost::bind 语法和 C++ lambda 语法感到困惑，或者我只是从根本上误解了一些东西？

基本上，我想组合一个函数 Z，它接受一个 THING* 和另一个函数 X，它也接受一个 THING*，并且使用它自己的逻辑，为给定的 THING* 生成一个字符串输出。

我有一些变化——有些采用两个数据访问器类型的函数，或者可能是一个 bool + 数据访问器。没关系 - 底线应该是相同的：

**如何在 Z -> F(x, G(x)) 的位置组合 Z？**

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:53:21.493

`boost::bind`(and `std::bind`)*急切地*评估嵌套的绑定表达式，因此您所拥有的将与签名匹配`string MyDoc::PrintOne(THING*, double)`。要防止急切求值并直接返回嵌套的绑定表达式（适合构造 a `std::function<>`），请使用`boost::protect`：

```
boost::bind(
    &MyDoc::PrintOne,
    this,
    _1,
    boost::protect(boost::bind(&MyDoc::GetX, this, _1))
) 
```

[这在标题为“使用嵌套绑定进行函数组合](http://www.boost.org/libs/bind/#nested_binds)”的文档部分中进行了概述。

# sockets - UDP在多个端口上接收数据

> ID：10687323
> 
> 赞同：4
> 
> 时间：2012-05-21T14:35:56.813
> 
> 标签：sockets, udp, port

是否可以在 2 个端口上使用 recvfrom 接收数据？我有一个用于用户请求的端口和另一个用于聊天消息的端口。是否可以绑定两个具有不同端口的套​​接字并使用一个 recvfrom() 接收数据？

问候

**编辑** 此代码有效吗？

```
int socket_fd,socket_fd2;
struct sockaddr_in addr, chat_addr;

addr.sin_family = AF_INET;
addr.sin_port = htons(1234);
addr.sin_addr.s_addr = inet_addr("127.0.0.1");

chat_addr.sin_family = AF_INET;
chat_addr.sin_port = htons(4321);
chat_addr.sin_addr.s_addr = inet_addr("127.0.0.1");

bind(socket_fd2, (struct sockaddr *) &chat_addr, sizeof(struct sockaddr_in));
bind(socket_fd, (struct sockaddr *) &addr, sizeof(struct sockaddr_in)); 
```

所以我想在两个不同的端口上接收数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:40:48.007

不，不可能使用一次调用从两个套接字读取`recvfrom`，因为该函数只接受一个套接字文件描述符参数。

您要么需要每个端口一个线程，要么需要一个机制（例如`select`，`poll`）来告诉哪些套接字有数据等待读取。

在后一种情况下，一旦您知道哪些套接字有待处理的数据，您就可以*调用*该`recvfrom`特定套接字来获取您需要的数据，例如：

```
// set up select parameters
fd_set socks;
FD_ZERO(&socks);
FD_SET(socket_fd, &socks);
FD_SET(socket_fd2, &socks);

// find out which sockets are read - NB: it might be both!
int nsocks = max(socket_fd, socket_fd2) + 1;
if (select(nsocks, &socks, (fd_set *)0, (fd_set *)0, 0) >= 0) {
     if (FD_ISSET(socket_fd, &socks) {
          // handle socket 1
          recvfrom(socket_fd, ...);
     }
     if (FD_ISSET(socket_fd2, &socks) {
          // handle socket 2
          recvfrom(socket_fd2, ...);
     }
} 
```

注意：这只是一个粗略且现成的示例——真实的代码会有错误检查等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T00:51:05.687

选择/轮询方法的答案适用于 UDP。

我之前的回答是一个错误，因为有一段时间我对我的工作代码感到困惑，而在现实生活中，我的工作代码是使用 ICMP 等无端口协议。

然而，回到 UDP 这一切都取决于你是哪一方，服务器或客户端。

当您发送 UDP 数据包时，您通常要么将您正在使用的端口绑定到套接字，要么在使用 sendto() 发送数据时自动为其分配一个临时端口。因此，通常稍后您可以调用 recvfrom() 来接收回复，该回复通常会被发送回绑定或分配的套接字端口。在这种情况下，使用 UDP，您可以使用单个本地套接字和单个本地端口与两个（以及更多）不同的远程地址和端口组合进行通信 - 想想类似反向服务器的东西 :-)

此外，根据协议和系统功能，您可以为一个端口使用两个套接字，或为 ICMP 等无端口协议使用两个套接字 - 在这种情况下，每个套接字都应该接收自己的接收数据副本。

以上只是有趣，不实用。

对您而言，实用的解决方案甚至不是上面建议的两个套接字之间的选择/轮询，而是一个通过内部协议设计分离的单个套接字 - 例如，将通道标识符之类的东西放入您的数据包中，您将节省端口堆栈。

# sql - Querying delimited column value in SQL Server

> ID：10687324
> 
> 赞同：1
> 
> 时间：2012-05-21T14:36:04.267
> 
> 标签：sql, sql-server, tsql

I'm wondering why is this code not returning any result

```
 SELECT A.PermissionGroupID, A.ApplicationID, CONVERT(nvarchar(5),A.PermissionID) AS Permission, A.PermissionName, B.PermissionGroupName, C.ApplicationName 
     FROM Permission AS A 
     JOIN PermissionGroup AS B ON A.PermissionGroupID = B.PermissionGroupID 
LEFT JOIN Application AS C ON A.ApplicationID = C.ApplicationID 
    WHERE (A.Active = 1) 
      AND (CONVERT(nvarchar(2),A.PermissionID) IN (SELECT Permissions 
                                                   FROM UserPermissions 
                                                   WHERE UserID = 1)) 
```

But this one is working

```
 SELECT A.PermissionGroupID, A.ApplicationID, CONVERT(nvarchar(5),A.PermissionID) AS Permission, A.PermissionName, B.PermissionGroupName, C.ApplicationName 
     FROM Permission AS A 
     JOIN PermissionGroup AS B ON A.PermissionGroupID = B.PermissionGroupID 
LEFT JOIN Application AS C ON A.ApplicationID = C.ApplicationID 
    WHERE (A.Active = 1) 
      AND (CONVERT(nvarchar(2), A.PermissionID) IN ('5','6','7','8')) 
```

Here's the content of my Permission table

```
 Permission
--------------------------------
Permission   Permission    Application    Permission
ID           Group         ID             Name
4         1              1            VISA_APPLICATION_DELETE
5         1              1            VISA_APPLICATION_PRINT
6         4              10           APPLICATION_ADD   
7         4              10           APPLICATION_EDIT
8         4              10           APPLICATION_DELETE
9         4              10           APPLICATION_VIEW 
```

Here's the content of my UserPermissions Table

```
UserPermissions
--------------------------
UserPermission      UserID    Permissions
ID
2           1         5,6,7,8   -> I tried to change it manually to this format ('5','6','7','8') but to no avail. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:54:14.967

为什么我怀疑权限看起来像一个字符串“5、6、7、8”。我希望查询是“PermisionId in (Select PermissionId from ...)”，而不是 (select Permissions)。

假设是这种情况，以下版本的查询应该可以解决您的问题：

```
SELECT A.PermissionGroupID, A.ApplicationID, CONVERT(nvarchar(5),A.PermissionID) AS Permission,
       A.PermissionName, B.PermissionGroupName, C.ApplicationName
FROM Permission A JOIN
     PermissionGroup B
     ON A.PermissionGroupID = B.PermissionGroupID LEFT JOIN
     Application AS C
     ON A.ApplicationID = C.ApplicationID cross JOIN
     (SELECT Permissions
      FROM UserPermissions
      WHERE UserID = 1
     ) p1
WHERE (A.Active = 1) AND
      charindex(','+CONVERT(nvarchar(2)+',', A.PermissionID)+',', ','+p1.Permissions+',') > 0 
```

注意我在前面加上逗号，所以“1”不匹配“15”。此外，这假设每个用户在 UserPermissions 中只有一行。

顺便说一句，您应该修复您的架构，以便 UserPermissions 为每个用户和权限都有一个单独的行，这样您的原始公式就可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T06:05:25.273

从评论中，我看到您担心性能。性能问题是由于您存储了一个逗号分隔的值字符串，其中每个值应该有一行。
把表`UserPermissions`改成这样。

```
create table UserPermissions
(
  UserID int references Users(UserID),
  PermissionID int references Permission(PremissionID),
  primary key (UserID, PermissionID)
) 
```

你的查询应该是......

```
SELECT A.PermissionGroupID,
       A.ApplicationID, 
       A.PermissionID,
       A.PermissionName,
       B.PermissionGroupName,
       C.ApplicationName 
FROM Permission AS A 
  JOIN PermissionGroup AS B 
    ON A.PermissionGroupID = B.PermissionGroupID 
  LEFT JOIN Application AS C 
    ON A.ApplicationID = C.ApplicationID 
WHERE A.Active = 1 AND 
      A.PermissionID IN (SELECT PermissionID 
                         FROM UserPermissions 
                         WHERE UserID = 1) 
```

# javascript - AJAX Not Running On Dialog Box Button Click

> ID：10687328
> 
> 赞同：0
> 
> 时间：2012-05-21T14:36:30.807
> 
> 标签：javascript, ajax, alert

I wonder whether someone may be able to help me please.

Firstly, apologies because I've only just started to use Javascript, so I'm perhaps I'm making a very basic mistake, so please bear with me.

I'm trying to implement `Example 2` from [this](http://s3.envato.com/files/293712/index.html) piece of third party software in my gallery page shown [here](http://www.mapmyfinds.co.uk/development/testgallery#/0).

Shown in the code below, I've been able to add the message to the onclick event i.e. when the user clicks the 'bin' icon, but the AJAX piece of code that is supposed to run upon the 'Delete' button being clicked is failing:

```
<script type="text/javascript"> 

    Galleria.ready(function() {
        this.$('thumblink').click();

    $(".galleria-image").append( 
    "<span class='btn-delete ui-icon ui-icon-trash'></span>"); 
    $(".btn-delete").live("click", function(){
    $.msgbox("You are about to delete this image. It cannot be restored at a later date. Do you wish to continue?", {
    type: "alert",
      buttons : [
        {type: "submit", value: "Delete"},
        {type: "cancel", value: "Cancel"}
      ]
      },function(Delete) {
      var img = $(this).closest(".galleria-image").find("img"); 
      // send the AJAX request
      $.ajax({
        url : 'delete.php',
        type : 'post',
        data : { image : img.attr('src'),  userid: "VALUE", locationid: "VALUE"},
        success : function(){
        img.parent().fadeOut('slow');
    }
    });               
    });
    return false;
    });     
    });

</script> 
```

I'm really not sure where I've gone wrong here, despite spending some time disecting the code. I just wondered whether someone could perhaps look at this please and let me know where I've gone wrong.

**POST UPDATE WORKING SOLUTION**

```
<script type="text/javascript"> 

        Galleria.ready(function() {
            this.$('thumblink').click();

        $(".galleria-image").append( 
        "<span class='btn-delete ui-icon ui-icon-trash'></span>"); 
        $(".btn-delete").live("click", function(){  
        var img = $(this).closest(".galleria-image").find("img"); 
        $.msgbox("You are about to delete this image. It cannot be restored at a later date. Do you wish to continue?", {
        type: "alert",
          buttons : [
            {type: "submit", value: "Delete"},
            {type: "cancel", value: "Cancel"}
          ]
          },
          function(result) {
          if(result)

          // send the AJAX request
          $.ajax({
            url : 'delete.php',
            type : 'post',
            data : { image : img.attr('src'),  userid: "VALUE", locationid: "VALUE"},
            success : function(){
            img.parent().fadeOut('slow');

    }
        });               
        });
        return false;
        });     
        });

    </script> 
```

Many thanks and regards

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:04:43.393

我已将变量重命名`Delete`为`result`.

```
function(result) {
  //result variable holds the value of what user clicks 'Delete' or 'Cancel'. 
  //Cancel click will pass false.
  //Delete click will pass Delete.
  alert(result)
  //You can also check if(result=='Delete') instead of if(result)
  if(result)
  {
      var img = $(this).closest(".galleria-image").find("img"); 
      // send the AJAX request
      $.ajax({
        url : 'delete.php',
        type : 'post',
        data : { image : img.attr('src'),  userid: "VALUE", locationid: "VALUE"},
        success : function(){
        img.parent().fadeOut('slow');
    }
  } 
```

看看这是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:56:35.377

似乎`this`在 msgbox 回调中不是一个元素（换句话说，`img`变量是一个空数组。尝试将`var img`声明直接放入 onclick 侦听器中。

```
$(".btn-delete").live("click", function(){
var img = $(this).closest(".galleria-image").find("img"); 
```

有帮助吗？

# java - Android：光标超出范围

> ID：10687329
> 
> 赞同：0
> 
> 时间：2012-05-21T14:36:38.813
> 
> 标签：java, android, database, cursor

在Android中单击我的列表适配器以显示我的数据库中的数据后，我得到一个光标超出范围异常。

这是我单击按钮时执行的代码：

```
@Override
public void onCreate(Bundle contactsState) {
    super.onCreate(contactsState);

 // Set the layout for this activity
    setContentView(R.layout.contacts);
    final Intent openInfo = new Intent(this,contactInfo.class);

    final database info = new database(this);
    info.open();
    getData = info.getData();
    getData.moveToFirst();
    ListAdapter Cview = new SimpleCursorAdapter(this,
                        R.layout.row,
                        getData,
                        new String[]{info.KEY_CONTACT, info.KEY_PHONE},
                        new int[]{R.id.RowText});
    setListAdapter(Cview);

    ListView Vct;
    Vct = getListView();
    Vct.setClickable(true);
    Vct.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(AdapterView<?> a,View v,int position,long id){
            Click = (Cursor) a.getItemAtPosition(position);
            getId = Click.getLong(1);
            info.open();
            String Pdata = info.getRows(getId);
            openInfo.putExtra("data",Pdata);
            info.close();
            //Start the Activity
            startActivity(openInfo);

        }
    });

    info.close();

} 
```

这是我的数据库中管理其中一些代码的部分：

```
 public Cursor getData() {
    // TODO Auto-generated method stub
    String[] columns = new String[]{ KEY_ROWID, KEY_CONTACT, KEY_PHONE, KEY_DAYS};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);

    return c;
}
public String getRows(long id) {
    // TODO Auto-generated method stub
    String[] columns = new String[]{KEY_ROWID,KEY_CONTACT,KEY_PHONE,KEY_DAYS};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);
    String value = c.getString(1) + "\n" + c.getString(2) + "\n" + c.getString(3); 
    return value;
} 
```

这是我得到的错误：

[http://paste.ubuntu.com/1000856/](http://paste.ubuntu.com/1000856/)

这应该做的是，当您单击列表视图中的名称时，如果其中包含来自数据库的数据，它将打开一个新活动，该活动具有传递给它的变量，并且该变量将在活动中显示信息名字。

```
 Thanks in Advance 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:52:23.850

如果您希望光标的行 id 与您单击的列表中的位置相关，则它是`long id`进入方法的参数。

您可以像这样跳过您遇到的整个光标问题（并摆脱不必要的代码）：

```
 public void onItemClick(AdapterView<?> a,View v,int position,long id){
        info.open();
        String Pdata = info.getRows(id);
        openInfo.putExtra("data",Pdata);
        info.close();
        //Start the Activity
        startActivity(openInfo);
    } 
```

**编辑**

有了您的更多信息...问题出在您的 getRows 方法中...您需要`moveToFirst()`在使用光标执行任何操作之前先做。

试试这个：

```
public String getRows(long id) {
     // TODO Auto-generated method stub
    String[] columns = new String[]{KEY_ROWID,KEY_CONTACT,KEY_PHONE,KEY_DAYS};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);
    c.moveToFirst();  // <---- add this
    String value = c.getString(1) + "\n" + c.getString(2) + "\n" + c.getString(3); 
    return value;
} 
```

我的第一个答案也应该适用于此。

**编辑 2**

看起来您还缺少意图声明...您正在使用 putExtra 但我没有看到创建`openInfo`意图的调用。

# cookies - Access javascript cookie in module file in drupal

> ID：10687330
> 
> 赞同：0
> 
> 时间：2012-05-21T14:36:38.810
> 
> 标签：cookies, drupal

Hi i am getting this strange problem. I am setting a cookie in external javascript file with current user time. I want this time to be available to the server so i am retrieving this using a php cookie.

I am able to fetch the value but only if i refresh the browser 2 times. If i change my current system time, and then refresh the page i still see old time,but when i refresh again then i see updated time.

I am doing something like this: enter code here

External js file

```
var now=new Date();
currTime=now.getHours();
document.cookie = "currentTime = " +currTime; 
```

module file

```
$current_time = $_COOKIE["currentTime"];
echo $current_time; 
```

I am calling the external js file in hook_nodeapi() using drupal_add_js

As I said, I am able to get the updated value of current time from cookie but only if I refresh 2 times.

What could be the problem?

thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:41:47.383

Download and use jquery.cookie.js from [https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

Document for jquery.cookie is available at [http://code.google.com/p/cookies/wiki/Documentation](http://code.google.com/p/cookies/wiki/Documentation)

# tcl - tcl tk teacup 从文件安装

> ID：10687333
> 
> 赞同：2
> 
> 时间：2012-05-21T14:36:49.650
> 
> 标签：tcl, tk

您好我正在尝试安装最新版本的 treectrl ( [http://tktreectrl.sourceforge.net/](http://tktreectrl.sourceforge.net/) ) 但是如果我运行`teacup install file://C:/tktreeunzipFolder`它错误不能覆盖文件。

该文件是临时文件夹中由脚本生成的文件。用茶杯从目录/tar.gz 安装软件包的正确方法是什么？

（我想使用本地版本，因为我想以 2.4.1 的新方式使用列标题，因为我希望其他方法很快就会贬值）

我还想知道如何在不安装的情况下使用带有预编译部分的包。即，一旦我将包文件放在我运行的脚本的子目录中，我是否需要任何特殊步骤来使包可访问。（我不允许在一台机器上安装软件包，但我想在一个脚本中使用它们）。我是否必须以某种方式注册文件（dll/so）？（注意我不能在 linux 上使用 sudo）。

将 dll/package 添加到工作目录的子目录会产生以下错误（在 windows 下）：

> 无法加载库“Z:/files/tcl/encounterXtract/treectrl_win/treectrl24.dll”：执行“load Z:/files/tcl/encounterXtract/treectrl_win/treectrl24.dll tr​​eectrl”时参数无效（“package ifneeded treectrl 2.4 .1” 脚本）从“package require treectrl”中调用

**边注：**

> 在 linux/unix 下，只需将文件放在子目录中并将其添加到 auto_path 就可以了`lappend auto_path path_to_sub_dir`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:49:26.040

首先，您*必须*以有权写入已安装软件包的本地存储库的用户身份运行该命令。对于 Windows，这*可能*需要您以`teacup install`管理员身份运行（注意，我不确定 tktreectrl 的安装包是否被调用`tktreectrl.dll`；我怀疑它被称为其他名称，但不知道是什么）：

```
runas /user:administrator "茶杯安装 C:\path\to\tktreectrl.dll"
```

然而，主要的茶杯档案没有携带 treectrl 2.4.1 包的事实本身就是一个问题。你有没有试过给[ActiveState](http://community.activestate.com/forums/activetcl-discussion)的人打个招呼？

# c++ - 编译器生成的无效 DWARF

> ID：10687334
> 
> 赞同：1
> 
> 时间：2012-05-21T14:36:53.267
> 
> 标签：c++, xcode, dwarf

> 警告：编译器生成的无效 DWARF：DIE 0x000629bb 在 '/Code/test/Mac1.7to1.8Test/build/Mac1.7to1.8Test.build/Release/Mac1.7to1.8Test.build/Objects- 中有多个 AT_decl_line 属性正常/x86_64/OgreFramework.o'。

我在构建 C++ 项目的 XCode 3.2.6 中得到了这个，作为 Mac 上的新手，我什至从未*听说过*Dwarf！这个警告是关于什么的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:44:51.647

这是调试信息（[参见维基百科](http://en.wikipedia.org/wiki/DWARF)）。我想说这要么是编译器本身的错误，要么是编译器和链接器版本不匹配。

[这个已知且已修复的错误](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=45171)可能是原因。看看你是否可以获得更新的编译器。

# google-maps - 缩放 1 中的谷歌地图 API 重复视图

> ID：10687335
> 
> 赞同：0
> 
> 时间：2012-05-21T14:36:57.297
> 
> 标签：google-maps, google-maps-api-3

当我尝试使用缩放 1 或 2 仅查看大洲时，我可以看到屏幕重复了几次，并且大洲在屏幕中重复出现。（屏幕分成3帧）

我可以在屏幕上控制并只显示一次大陆而不重复吗？

问候，

约西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:48:00.387

你所描述的是正常的；这就是谷歌地图处理非常低的缩放级别的方式。我还以全球缩放开始我的地图以显示所有大陆。另一个因素是用户的屏幕分辨率。我最初以 3 级缩放开始我的地图，但事实证明，一些屏幕分辨率设置较低的用户在首次加载地图时无法看到放置在我的地图上的所有内容。正因为如此，我现在从缩放 2 开始。屏幕分辨率较高的用户只是明白他们可能会在边缘看到世界地图的重复运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:53:00.563

写一个黑客！[这是缩放 0 的示例](http://jsbin.com/ijojip/2/edit#preview)（查看页面时，缩小一次）。

该机制是监听缩放变化，并在低缩放时启用两个绝对定位的灰色 div（每侧一个）以覆盖“重复”。固定宽度的地图实际上是必要的。你需要新的 div 对来进行缩放 1 和 2。

最大的缺点是控件被 div 覆盖，将它们放在中心很难看（我试过了）。你可以只遮住地图的右半边，但效果也不太好。（见这里[http://jsbin.com/ijojip/3/edit#preview](http://jsbin.com/ijojip/3/edit#preview)）

```
 google.maps.event.addListener(map, 'zoom_changed', function() {
      if(map.getZoom() == 0) {
        document.getElementById("leftcover").style.display = "block";
        document.getElementById("rightcover").style.display = "block";
      }
      else {
        document.getElementById("leftcover").style.display = "none";
        document.getElementById("rightcover").style.display = "none";
      }
    });

    #leftcover { position: absolute; height: 100%; background-color: #e5e3df; left: 0px; width: 128px; z-index: 2; display: none }
    #rightcover { position: absolute; height: 100%; background-color: #e5e3df; left: 384px; width: 128px; z-index: 2; display: none } 
```

# php - MySQL query in PHP with '&' returns different results than phpMyAdmin does

> ID：10687339
> 
> 赞同：1
> 
> 时间：2012-05-21T14:37:08.237
> 
> 标签：php, mysql

Records which contain an ampersand (`&`) are not returned by MySQL (connected to via PHP), but the same query works fine in phpMyAdmin. I am not sure if it is a collate/charset problem. Here is the sample query:

```
SELECT distinct(pcs.shop_name) AS shopName 
FROM shops AS ps 
LEFT JOIN category_shop AS cs 
   ON ps.shop_id = cs.shop_id 
WHERE 1=1 
   AND (ps.shop_name LIKE '%P&G%') 
   AND ps.is_active!=2 
ORDER BY ps.shop_display_name ASC 
```

The `shop_name` I am trying to search for is `P&G`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:54:40.490

试试这个（我猜如果你对 & 有问题，你正在使用 GET 提交表单）：

```
$shop_name = urlencode('P&G'); 
```

在您的页面上获取该字段值（这意味着您在生成表单时为每个字段值调用 urlencode）。然后在 GET 完成后，只需执行以下操作：

```
$shop_name = mysql_real_escape_string($_GET['shop_name']);
$query = "SELECT distinct(pcs.shop_name) as shopName 
    FROM shops AS ps 
    LEFT JOIN category_shop AS cs ON ps.shop_id = cs.shop_id 
    WHERE 1=1 
        AND (ps.shop_name LIKE '%{$shop_name}%') 
        AND ps.is_active!=2 
    ORDER BY ps.shop_display_name ASC"; 
```

这对你有用吗？

# python - 小部件中的 tkinter 默认按钮

> ID：10687346
> 
> 赞同：6
> 
> 时间：2012-05-21T14:37:34.497
> 
> 标签：python, widget, tkinter

这似乎很容易......

我写了一个对话框小部件，我在其中放置了一些条目、按钮等——其中一个按钮我想通过鼠标单击激活，但也可以通过按回车键来激活。我前段时间读到只需要设置其*默认*选项，但我认为它在最近的版本中发生了变化。

你知道如何设置它吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T14:50:18.170

将事件的回调绑定`'<Return>'`到窗口（通常`root`在 Tkinter 中调用）或包含框架。让回调接受一个事件参数（您可以忽略它）并将其作为`invoke()`按钮的回调。

```
root.bind('<Return>', (lambda e, b=b: b.invoke())) # b is your button 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-12T04:45:06.080

```
def myaction():
    print('Your action in action')

def myquit():
    root.destroy()

root = Tk()
label = Label(root, text='Label Text').pack(expand=YES, fill=BOTH)
label.bind('<Return>', myaction)
label.bind('<Key-Escape>', myquit)
ok = Button(label, text='My Action', command=myaction).pack(side=LEFT)
quit_but = Button(label, text='QUIT', command=myquit).pack(side=RIGHT)
root.mainloop() 
```

1.  您必须首先声明您的函数。
2.  请注意，“我的操作”按钮和返回键都调用`myaction`和“退出”，`Esc`键都调用`myquit`。

希望有帮助。

# javascript - 如何使用 Javascript 对链接+显示消息进行编码

> ID：10687350
> 
> 赞同：0
> 
> 时间：2012-05-21T14:37:48.017
> 
> 标签：javascript, encryption, hyperlink

我希望保护我的主题作者链接不被删除。大多数人已经知道如何删除 base64 和 rot13 链接，所以我需要一些更高级的东西。

如果链接被删除，如何使用 javascript + 显示消息或破坏主题来加密页脚链接？

我是 JS 新手。我已经阅读了这个页面：[你什么时候应该使用转义而不是 encodeURI / encodeURIComponent？](https://stackoverflow.com/questions/75980/best-practice-escape-or-encodeuri-encodeuricomponent)但由于我是 JS 新手，所以我不知道如何使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:46:58.703

You simply cannot make sure that the links aren't removed. It is always possible to delete the something, that prints the links or that breaks the theme, if the link is removed.

Therefore the best way is IMO to make the links acceptable for people, who use your theme.

If you really want to make your users problems, you can either somehow make your CSS depend on the link, or provide an important Javascript file with a subtle and difficult to find check, whether the link is present or not.

# php - 将 $_GET 中的字符串与数组中的字符串进行比较

> ID：10687352
> 
> 赞同：-1
> 
> 时间：2012-05-21T14:37:51.050
> 
> 标签：php, arrays, string, foreach, compare

这让我很沮丧，因为我对 PHP 还很陌生，而且我确信我错过了一些关于语言本质的非常基本的东西。但是为什么哦，为什么这不起作用？

```
$tag = $_GET['id'];
$openfile = fopen($files[$i], "r");
$tagsraw = fgets($openfile);
$tag_array = explode(",",$tagsraw);
foreach ($tag_array as $a) {
    if ($a == $tag) {
        echo $a." matches ".$tag;
    }
} 
```

**编辑：**顺便说一句，文件打开工作正常；`print_r()`显示`$tag_array`了它的含义。

**编辑：**这是来自`print_r()`. 有五个文件，每个文件的第一行都有自己的标签。

```
Array
(
    [0] => webdesign

)
Array
(
    [0] => personal

)
Array
(
    [0] => recipes
    [1] => vegan

)
Array
(
    [0] => personal

)
Array
(
    [0] => personal

) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:42:15.150

my magic crystal ball tells me that "doesn't work" means

```
if ($a == $tag) { 
```

is never true?

you probably have whitespace characters around one of them. use [var_dump](http://www.php.net/var_dump)() to inspect the values of variables. Notice that var_dump tells you the data type, and for strings, the string length in bytes.

If there is whitespace, you can remove it using PHP's `trim` function:

```
if (trim($a) == trim($tag)) { 
```

# java - Java Socket InputStream read() 总是返回 -1，就在结束之前

> ID：10687358
> 
> 赞同：0
> 
> 时间：2012-05-21T14:38:09.490
> 
> 标签：java, http, sockets, inputstream

我正在编写下载器应用程序。我只想使用 java Socket 来请求文件。所以我在我的套接字中写入 HTTP 协议规则。我的应用程序创建一个连接，并在读取标头后，使用我的套接字的`read()`方法`InputStream`。一切顺利。有时连接可能会丢失。但我存储了我正在读取的字节，所以它再次使用 HTTP Ranged GET 创建一个新的 Socket 并继续它的工作。但是当下载即将完成时，我的意思是当剩余不到 10 KB 时，所有连接都会丢失，它会再次（按计划）尝试打开新的 Socket 并继续它的工作。它完全读取响应的标头，但在读取正文的任何​​字节之前，`read()`方法返回 -1 并再次尝试打开一个新的 Socket 并`read()`剩余字节，但问题仍然存在。关键是每次可以完全读取响应标头。我看到`Content-Length:`响应头的字段正是文件的剩余字节。我忘了提：我的代码有问题，因为我检查了来自许多服务器的许多文件，结果是相同的。这是代码：

```
// Some fields:
int state;
long start, current, end;

// in a thread:
while (state != FINISHED) {
    if (state == DOWNLOADING) {
        try {
            // fill a new socket with Ranged GET [current, end]
            Socket s = initConnection();
            InputStream in = s.getInputStream();
            int readNo = 0;
            FileOutputStream out = getTempFile();
            byte[] buffer = new byte[1024];
            // read response headers successfully and prints them, request range is OK. a sample of its print is at the end of page
            readHeaders(in);
            while (state == DOWNLOADING && (readNo = in.read(buffer)) != -1) {                      
                current += readNo;
                out.write(buffer, 0, readNo);
            }
            if (readNo == -1) {
                // at nearly end of download always print this and values never changes, where usually they have 3000 byte difference
                System.out.println("**************> (" + current + " - " + end + ")");
            }
            if (currentByte == endByte) {
                state = FINISHED;
                //mergeParts();
                // code never reaches here
                dlInfo.checkAllPartsFinished();
            }
            out.flush();
            out.close();
            s.close();
        } catch (Exception e) {
            e.printStackTrace();
            state = ERROR;
            error = e.getMessage();
            errorRetry++;
        }
    } else if (state == PAUSED) {
        // ...
    } else ...
    }
} 
```

文件末尾的响应标头示例，没有任何变化：

```
HTTP/1.1 206 Partial Content
Date: Mon, 21 May 2012 14:34:27 GMT
Server: Apache
Last-Modified: Sat, 21 Apr 2012 02:16:20 GMT
ETag: "4006d32e-f691e0-4be26fda00500"
Accept-Ranges: bytes
Content-Length: 7859
Content-Range: bytes 2012041-2019899/16159200
Connection: close
Content-Type: application/octet-stream

**************> (2012041 - 2019899) 
```

我不知道是什么问题，但不管它是什么，它几乎发生在流的末尾。经过几个小时的花费时间，我完全感到困惑。我将不胜感激任何帮助！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:53:25.910

您是否在方法中的 InputStream 之上分层了缓冲读取器/流`readHeaders()`？我的猜测是你正在这样做，并且这个缓冲流读取的 InputStream 比你预期的要多（因为它是*缓冲*的）。`readHeaders()`当您从该方法 返回时，这些字节会丢失。

更新：

刚看到你最后的评论。这正是你的问题。BufferedReader 正在消耗部分正文字节。

# html - 绝对路径是如何确定的？

> ID：10687362
> 
> 赞同：2
> 
> 时间：2012-05-21T14:38:16.453
> 
> 标签：html, windows, anchor, href, absolute-path

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T14:42:42.023

如果您的 HTML 文件位于`C:\Users\name\folder1\...some folders\`，则只需删除前导斜杠即可使其成为相对路径。

否则，您必须在地址前加上前缀`file:///C:/Users/name/folder1/...some folders`以保持绝对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:40:20.197

```
<link type="text/css" rel="stylesheet" href="./s/2036/21/2/_/download/superbatch/css/batch.css" media="all"> 
```

注意开头的`.`（点），表示它的相对路径，从文档/文件的当前执行目录开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:51:11.993

`First`- 我在你的例子中没有看到任何锚。

`Second`，它只能在 IE 中工作。

您必须通过`UNC`--->访问该项目`\\myShare\lalala`

这是一个工作示例：

```
 <a type="text/css" rel="stylesheet" href="\\dev-8\c$\1.txt" >fsdfsd</a> 
```

`dev-8`我的电脑的名字在哪里。

在您的根目录中创建 1.txt 文件 - 它会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T09:50:28.033

最后我不得不把文件放在网络服务器的 htdocs 文件夹中。我有点希望有一个不同的解决方案

# iphone - iPhone facebook 应用程序 - 在 facebook 应用程序中打开链接时，safari 规则被忽略 - 为什么？

> ID：10687363
> 
> 赞同：0
> 
> 时间：2012-05-21T14:38:22.740
> 
> 标签：iphone, facebook, mobile, safari

我使用一些 js 在我正在制作的网站上插入 safari 特定样式。当我在 iPhone 上的移动 Safari 中打开该网站时，样式工作正常。

但由于某种原因，当我在 facebook 上发布指向该网站的链接，然后通过我的 facebook 应用程序打开链接时，样式被忽略 - 为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:41:13.270

If you mean in the internal web frame of Facebook before you click 'Open This Link in Safari' then it's because it's not Safari, it's just a stock and standard Web View with no access to any of the other Safari features (that's why it's often quicker to open the link in Safari).

EDIT: I decided to dig a bit further (this has probably been done before but I didn't find it on the first page of Google so). I have a site with practically zero traffic so I used that, monitored through Google Analytics to see what my browser agent would come back as. The only device connect was my iPhone at that point and it sends the browser agent as 'Mozilla Compatible Agent' for Browser, with iPhone as the OS. I then logged on through Safari and checked again.

Looks like for the UIWebView Apple decided not to bother putting the Safari user agent, which is weird. Or weirdish, I suppose it has a lot less functionality so not showing it as a stock agent might be a good thing.

Picture: ![the two agents under Analytics](../Images/d66ce78e008a472b62552e1f4f93dbcc.png)

# ruby - Ruby：数组操作

> ID：10687364
> 
> 赞同：-7
> 
> 时间：2012-05-21T14:38:23.577
> 
> 标签：ruby, arrays

```
test = Array.new
test[0] = "foo" 
```

工作正常

```
test[] = "foo" 
```

返回错误。让数组自动生成索引的 Ruby 语法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T14:40:46.017

```
test << "foo" 
```

or

```
test.push("foo"). 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T14:40:26.633

This format:

```
test << "foo" 
```

will append an element to an array as you're describing.

# c++ - 控制台应用程序不打印“按任意键继续......”

> ID：10687370
> 
> 赞同：3
> 
> 时间：2012-05-21T14:39:05.853
> 
> 标签：c++, visual-studio-2010, console-application

我有用 C++（控制台应用程序）编写的第三方 SDK 代码示例。当我从 Visual Studio 2010 运行它们中的任何一个时（不调试就开始），它不会打印“按任意键继续......” 最后，控制台窗口刚刚关闭。

他们是如何设法获得这种行为的？更重要的是：我怎样才能获得标准的“按任意键继续......” 到底？当然，在不改变程序代码的情况下......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-11-03T10:57:31.200

按 Ctrl+F5 运行您的程序，而不仅仅是 F5。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T14:40:18.130

在链接设置中将子系统更改为 Console

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T14:57:20.423

尝试

```
system(PAUSE); 
```

它应该打印您要查找的内容

# json - 使用 .NET 客户端使用 JIRA 5.0.1 REST JSON API 获取 JIRA 问题

> ID：10687371
> 
> 赞同：0
> 
> 时间：2012-05-21T14:39:06.363
> 
> 标签：json, jira, asp.net-web-api, dotnet-httpclient

我是使用基于 REST 的服务的新手，但我想做的是我希望很容易的事情，即获取 JIRA 问题并使用 .NET Framework 4.5 客户端显示它。

我发现我可以通过将以下 URI 粘贴到浏览器中来获得 JSON 响应： [https ://jira.atlassian.com/rest/api/latest/issue/JRA-9](https://jira.atlassian.com/rest/api/latest/issue/JRA-9)

我需要做的是从 .net 应用程序中调用它。因此，经过一些研究，我发现在 .NET 4.5 中使用 HTTPClient 是可行的方法。

为了运行以下测试代码，您需要引用 .NET Framework 4.5 并添加对 System.Net.Http 和扩展 System.Net.Http 和 System.Json 的引用：

```
using System;
using System.Collections.Generic;
using System.Json;
using System.Linq;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;

namespace JIRAClient3
{
    class Program
    {
        static string _address = "https://jira.atlassian.com/rest/api/latest/issue/JRA-9";

        static async void Run()
        {
            // Create an HttpClient instance
            HttpClient client = new HttpClient();
            client.MaxResponseContentBufferSize = int.MaxValue;

            // Send a request asynchronously continue when complete
            HttpResponseMessage response = await client.GetAsync(_address);

            // Check that response was successful or throw exception
            response.EnsureSuccessStatusCode();

            // Read response asynchronously as JsonValue
            JsonArray content = await response.Content.ReadAsAsync<JsonArray>();

            // Exception occurs at the above line, which is:
            //System.InvalidOperationException was unhandled by user code
            //HResult=-2146233079
            //Message=The input stream contains too many delimiter characters which may 
            //be a sign that the incoming data may be malicious.
            //Source=System.Net.Http.Formatting

            // I then need to write out the contents of the JSON/JIRA issue.
      }

        static void Main(string[] args)
        {
             Run();
             Console.WriteLine("Hit ENTER to exit...");
             Console.ReadLine();
        }
    }
} 
```

所以我被困在与太多分隔符有关的例外。因此，我的问题是：

*   我是否朝着正确的方向前进？
*   如何解决太多分隔符异常。
*   解决异常后，访问部分 JSON 响应（例如 JIRA 问题磁贴和描述等）的最佳方式是什么？

非常感谢

保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:10:26.627

You can avoid this error by following the instructions posted here: [http://forums.asp.net/post/4845421.aspx](http://forums.asp.net/post/4845421.aspx).

However, it is advisable to use a Json.NET based formatter which will ship out of the box upon the next drop of ASP.NET Web API. If you're not willing to wait and comfortable compiling the code yourself, you can get it now by pulling latest from Microsoft's open source repository: [http://aspnetwebstack.codeplex.com/](http://aspnetwebstack.codeplex.com/). The formatter you want can specifically be found here: [http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5ac8586b78b3#src%2fSystem.Net.Http.Formatting%2fFormatting%2fJsonMediaTypeFormatter.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5ac8586b78b3#src%2fSystem.Net.Http.Formatting%2fFormatting%2fJsonMediaTypeFormatter.cs).

# wcf - 无法在异步服务调用中捕获 CommunicationException

> ID：10687373
> 
> 赞同：1
> 
> 时间：2012-05-21T14:39:19.073
> 
> 标签：wcf, silverlight, exception-handling, asynccallback, communicationexception

我有 WCF 服务，我的客户端是 Silverlight 应用程序。当服务出现故障（网络错误等）时，我在客户端代理上收到此异常：

> CommunicationException：通信对象 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel 无法用于通信，因为它处于故障状态。

准确地说，在下面代码的第 5 行：

```
public System.IAsyncResult BeginPublishVideo(byte[] data, System.AsyncCallback callback, object asyncState) {
                object[] _args = new object[1];
                _args[0] = data;
                //Below is when the exception is received
                System.IAsyncResult _result = base.BeginInvoke("PublishVideo", _args, callback, asyncState);
                return _result;
            } 
```

因此，我尝试将服务调用（来自堆栈跟踪）包装在 try/catch 中，但无济于事，try/catch 永远不会被执行。基本上是这样的：

```
 try
        {
            _videoClient.PublishVideoAsync(codedVideoBuffer);
        }
        catch (Exception) { } 
```

但是 try catch 永远不会被击中。我怎样才能捕捉到这个异常并优雅地处理它？

TIA。

# java - JSTL：从数组中删除最后一项

> ID：10687374
> 
> 赞同：1
> 
> 时间：2012-05-21T14:39:20.020
> 
> 标签：java, jstl

想知道是否可以使用 JSTL 从数组中删除最后一项？目前我正在使用 c:url 将参数（来自数组）附加到超链接。我也希望能够删除最后一个参数......

这是 c:url 附加参数的代码

```
 <c:url value="search" var="url">
    <c:param name="q" value="${q}"/>
    <c:forEach var="field" items="${fq}">
        <c:param name="fq" value="${field}"/>
    </c:forEach>
</c:url> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T14:42:54.247

不，那是不可能的。您不能在 JSTL 中操作数组。您最多可以将最后一项设置为`null`，但这不会改变数组的长度。

但是，在*您的特定情况下*，还有另一种方法：您可以通过检查来检查您当前是否正在遍历最后一个数组项[`LoopTagStatus#isLast()`](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/jstl/core/LoopTagStatus.html#isLast%28%29)，然后完全跳过该项`<c:param>`

```
<c:url value="search" var="url">
    <c:param name="q" value="${q}"/>
    <c:forEach var="field" items="${fq}" varStatus="loop">
        <c:if test="${not loop.last}">
            <c:param name="fq" value="${field}"/>
        </c:if>
    </c:forEach>
</c:url> 
```

请注意，我删除了`fn:length()`检查，因为那是不必要的。`<c:forEach>`如果没有项目，则已经不会迭代。

# jquery - jQuery Mobile - 多页模板中的缓存问题

> ID：10687377
> 
> 赞同：1
> 
> 时间：2012-05-21T14:39:32.993
> 
> 标签：jquery, jquery-mobile

我正在使用的 jquery 移动应用程序有问题。

基本上在应用程序的一个特定部分，我有搜索结果，其中每页列出 6 个项目，以及 x 个 JQM 页面，所有这些都在同一个实际页面中。我已将其作为多页模板完成，因此您可以在结果中左右滑动和滑动，它看起来既漂亮又光滑。

搜索结果需要按日期和字母顺序排序，因此您可以在两者之间切换。这一切的逻辑都是在服务器端完成的，我只是链接到相同的物理 url，但使用查询字符串切换到日期顺序。像这样......

```
<div data-role="controlgroup" data-type="horizontal" data-mini="true" class="orderOptions">       

  <a href="/Default.aspx?orderBy=atoz" id="MainContent_rptBrochures_BrochureList_2_btnAtoZ_2" data-role="button" data-theme="a" class="sortOptions ui-btn-active ">A-Z</a>       

  <a href="/Default.aspx?orderBy=date" id="MainContent_rptBrochures_BrochureList_2_btnDate_2" data-role="button" data-theme="a" class="sortOptions">Date</a> 

</div> 
```

问题是，如果我单击“日期”按钮，转换会从重新排序的新结果集中加载到第一个 JQM 页面中，而不是其他页面。它还保留了 AtoZ 结果集中的所有其他页面。我需要所有 Date 结果集，而不需要 AtoZ 集（这些需要删除）。

我希望添加一个查询字符串会让它看起来像一个新的页面请求，并避免所有缓存的东西，但它看起来不是！

我不想做的是让单击链接进行完全刷新（这确实有效），因为我们失去了漂亮的过渡。想知道是否有人能想到解决办法？或者遇到类似的事情？

干杯，威尔

# php - php datetime->diff 计算错误的小时数（3 太多）

> ID：10687379
> 
> 赞同：0
> 
> 时间：2012-05-21T14:39:38.077
> 
> 标签：php, datetime

我在 php 中有以下 DateTime 对象：

```
[start1] => DateTime Object ( 
    [date] => 2012-05-21 12:59:59
    [timezone_type] => 3
    [timezone] => Europe/Berlin
)

[end1] => DateTime Object ( 
    [date] => 2012-05-21 22:36:00
    [timezone_type] => 3
    [timezone] => Europe/Berlin
) 
```

和结果：

```
$time->end1->diff($time->start1 
```

是：

```
DateInterval Object ( [y] => 0 [m] => 0 [d] => 0 [h] => 12 [i] => 36 [s] => 2 [invert] => 1 [days] => 0 ) 
```

为什么我得到的是 12 小时而不是 9 小时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T07:57:04.567

我找到了解决方案......在做差异之前，我在 start1 对象上做了一个 sub() 。现在我明白了为什么我的结果是错误的......这是答案，但我真的不知道为什么会发生这种情况。 [http://www.php.net/manual/en/datetime.sub.php#101175](http://www.php.net/manual/en/datetime.sub.php#101175)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:28:04.750

我知道这实际上可能是您创建两个 DateTime 对象所做的事情，但我想我会把对我有用的东西放在上面，看看它是否能帮助你。

要创建我所做的两个对象：

```
$start1 = new DateTime('2012-05-21 12:59:59', new DateTimeZone('Europe/Berlin'));
$end1   = new DateTime('2012-05-21 22:36:00', new DateTimeZone('Europe/Berlin')); 
```

并打印出两个对象和差异：

```
print_r($end1->diff($start1)); 
```

我有：

```
DateTime Object
(
    [date] => 2012-05-21 12:59:59
    [timezone_type] => 3
    [timezone] => Europe/Berlin
)
DateTime Object
(
    [date] => 2012-05-21 22:36:00
    [timezone_type] => 3
    [timezone] => Europe/Berlin
)
DateInterval Object
(
    [y] => 0
    [m] => 0
    [d] => 0
    [h] => 9
    [i] => 36
    [s] => 1
    [invert] => 1
    [days] => 0
) 
```

我看到 start1 和 end1 对象的两个输出是相同的，但我的差异反映了正确的 9 小时差异。也许您在您的 PHP 版本中创建 DateTime 对象的方式有些奇怪？

# iphone - 如何管理 iPhone 上的意外震动事件

> ID：10687381
> 
> 赞同：2
> 
> 时间：2012-05-21T14:40:00.097
> 
> 标签：iphone, event-handling

我开始尝试使用抖动事件处理程序来擦除我的应用程序中的一些数据。我的抖动处理程序首先拦截子类 UIApplication 中的抖动事件。

我发现如果我在运行应用程序的情况下将手机放在口袋里，它会震动并启动擦除操作。我使用模式警报来等待用户确认，但从口袋中取出此警报时总是看到此警报似乎是不可取的。

有人可以提供一个想法，当它出现在口袋里时如何自动禁用它？

我的一个想法是使用超时。如果在一定时间内忽略警报，则忽略震动。我想知道是否还有其他解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:36:20.827

您可以等待多个摇晃手势发生。如果您在超时内没有得到第二个（或第三个或第 n 个）手势，那么忽略该手势？大多数故意摇晃会导致多个手势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:16:36.633

您可以使用环境光/接近传感器。轮询它以查看它是否检测到光，如果它确实启动了擦除，如果不是则不。这将解决“口袋里”的问题。

# git - 为什么 git svn show-ignore / show-externals 这么慢？

> ID：10687382
> 
> 赞同：3
> 
> 时间：2012-05-21T14:40:09.893
> 
> 标签：git, svn, git-svn, svn-externals, svnignore

我正在编写一个通用的 svn `->`git 迁移脚本，它允许比标准更多的`git svn clone`脚本，并且在我的脚本的一个阶段，我正在检查迁移存储库中每个分支的输出`git svn show-externals`，`git svn show-ignore`并根据这些命令的输出采取各种步骤。

我现在的问题是，虽然我的脚本的其余部分执行得非常快，但这两个命令似乎占据了我绝大多数的运行时间。在某些情况下，`git svn show-externals`运行需要超过 10 分钟（在包含大约 5000 个文件的 repo 上）。当在具有 10 个或更多分支的这种大小的存储库上运行时，您可以想象这会大大增加。

为什么这个操作需要这么长时间才能执行？我能做些什么来加快它的执行速度吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:31:40.790

“git svn show-ignore”对每个目录执行一个额外的 SVN 请求。

出于迁移目的，您可能想看看[SubGit](http://subgit.com)工具。它为每个修订版翻译 svn:ignore -> .gitignore（并且它还翻译 svn:eol-style、标签等）。唯一的限制：它需要本地访问 SVN 到存储库。因此它可以与[svnrdump](http://rsvndump.sourceforge.net/)工具结合使用。如果您在本地拥有 SVN 存储库，则只需一步即可完成迁移：

```
$ subgit install path/to/svn/repo 
```

# jquery - jquery simple drop down content issue

> ID：10687386
> 
> 赞同：1
> 
> 时间：2012-05-21T14:40:19.533
> 
> 标签：jquery, css

I'm trying to code a simple jQuery drop down nav using `slideDown` and `slideUp` function, but it doesn't seem to be working properly, please find the css and js code below:

```
.programsnav ul li{
    float:left;
    margin-left:120px;
    display:block;
    position:relative;
    cursor:pointer;
    padding-bottom:5px;
}
.programsnav ul li:hover{
    border-bottom:dashed 1px #fcfe93;
}
.programsnav ul li span{
    display:none;
    position:absolute;
    width:930px;
    top:42px;
    left:-371px;
    background:#fcfe93;
    color:#161527;
    padding:10px 15px 15px 15px;
}
.programsnav ul li span a{
    display:inline-block;
    padding:0 10px;
    border-right:dotted 1px #161527;
    color:inherit;
    font-size:12px;
    text-transform:uppercase;
} 
```

**js**

```
$(document).ready(function(){
     $('#downloadnav li').hover(function() {
            $('span', this).slideDown(100);
        }, function () {
            $('span', this).slideUp(100);       
     });
}); 
```

**html**

```
<ul id="downloadnav">
<li>Movies<span><a href="#">Movie1</a><a href="#">Movie2</a></span></li>
<li>Songs<span><a href="#">Song1</a><a href="#">Song2</a></span></li>
<li>Games<span><a href="#">Game1</a><a href="#">Game2</a></span></li>
</ul> 
```

Its keeps animating if i do mouseover on span>a, please help, thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:09:10.583

老实说，这段代码有几个问题。对于初学者来说，这个标记不利于下拉菜单导航。通常，那些遵循此约定：

```
<ul id="downloadNav">
    <li>Movies
        <ul>
            <li><a href="#">Movie 1</a></li>
            <li><a href="#">Movie 2</a></li>
        </ul>
    </li>
    <li>Songs
        <ul>
            <li><a href="#">Song 1</a></li>
            <li><a href="#">Song 2</a></li>
        </ul>
    </li>
    <li>Games
        <ul>
            <li><a href="#">Game 1</a></li>
            <li><a href="#">Game 2</a></li>
        </ul>
    </li>
</ul>​ 
```

此外，样式使元素向右，而不是“下拉”。我冒昧地做了一个简单的例子，希望你能研究它，以更好地理解解决这个问题的更明智的方法。

小提琴：http: [//jsfiddle.net/LRBqJ/1/](http://jsfiddle.net/LRBqJ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:00:13.387

使用**jQuery 1.7.2**

## JavaScript

```
$(document).ready(function(){
     $('#downloadnav li').hover(function() {
            $('span', this).stop().slideDown(100);
        }, function () {
            $('span', this).stop().slideUp(100);       
     });
}); 
```

* * *

## CSS

```
ul#downloadnav {
    position: relative;
}
ul#downloadnav  li{
    float:left;
    margin-left:120px;
    display:block;
    position:relative;
    cursor:pointer;
    padding-bottom:5px;
}
ul#downloadnav  li:hover{
    border-bottom:dashed 1px #fcfe93;
}
ul#downloadnav  li span{
    display:none;
    position:absolute;
    width:930px;
    top:0px;
    margin-top: 41px;
    left:-371px;
    background:#fcfe93;
    color:#161527;
    padding:10px 15px 15px 15px;
}
ul#downloadnav  li span {
        display: none;
}
ul#downloadnav  li span a{
    display:none;
    padding:0 10px;
    border-right:dotted 1px #161527;
    color:inherit;
    font-size:12px;
    text-transform:uppercase;
} 
```

* * *

## HTML

```
<ul id="downloadnav">
<li>Movies<span><a href="#">Movie1</a><a href="#">Movie2</a></span></li>
<li>Songs<span><a href="#">Song1</a><a href="#">Song2</a></span></li>
<li>Games<span><a href="#">Game1</a><a href="#">Game2</a></span></li>
</ul> 
```

在我的 FF 中工作正常

**[这](http://jsfiddle.net/RuZYu/)**是工作演示。

# java - Java、FTP服务器和客户端

> ID：10687390
> 
> 赞同：2
> 
> 时间：2012-05-21T14:40:31.220
> 
> 标签：java, multithreading

我正在尝试“编写两个实现 FTP 服务器的 Java 程序，分别响应 USER 和 PASS，每个客户端线程和线程池。” 我只是想在上交之前确保一切都井井有条。这是我的源代码。我遇到的唯一麻烦是弄清楚如何处理“FTPProtocol 客户端”；我应该在拥有 thread.start 后将其销毁吗？

FTPServer.java

```
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

 public class FTPserver
{   
public static void main(String [] args)
{
    if (args.length != 1) 
        throw new IllegalArgumentException( "Parameter(s): <Port>");

    int threadPoolSize = 10;
    int port = Integer.parseInt(args[0]); 

    final ServerSocket server;
    try 
    {
        server = new ServerSocket(port);
    } 
    catch (IOException e1) 
    {
        return;
    }

    for (int i = 0; i < threadPoolSize; i++) 
    {
        Thread thread = new Thread() 
        {
            public void run() 
            {
                while (true) 
                {
                    try 
                    {
                        Socket sock = server.accept();
                        FTPProtocol client = new FTPProtocol(sock);
                    } 
                    catch (IOException e)
                    {
                        System.err.println(e.getMessage());
                        return;
                    }
                }
            }
        };
        thread.start();
    }
}
} 
```

FTP协议.java

```
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

class FTPProtocol implements Runnable
{
static String greeting = "220 Service Ready.\r\n";
static String needPassword = "331 User name ok, need password.\r\n";
static String closing = "421 Service not available, closing control connection.\r\n";
static byte[] reply220 = null;
static byte[] reply331 = null;
static byte[] reply421 = null;

    Socket sock = null;
    public FTPProtocol(Socket so)
    {
        sock = so; 
        reply220 = greeting.getBytes();
        reply331 = needPassword.getBytes();
        reply421 = closing.getBytes();
    }

    public void run()
    { 
        handleFTPClient(sock); 
    }

    void handleFTPClient(Socket sock)
    {
        InputStream is = null;
        OutputStream os = null;
        byte[] inBuffer = new byte[1024];

        try 
        {
            is = sock.getInputStream();
            os = sock.getOutputStream();
            os.write(reply220);
            int len = is.read(inBuffer);
            System.out.write(inBuffer, 0, len);
            os.write(reply331);
            len = is.read(inBuffer);
            System.out.write(inBuffer, 0, len);
            os.write(reply421);
            sock.close();
        } 
        catch (IOException e)
        {
            System.err.println(e.getMessage());
            return;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:44:15.493

我在这里错过了什么吗？您正在创建一个其类型实现的 on 对象`Runnable`（没有明显的原因）：

```
FTPProtocol client = new FTPProtocol(sock); 
```

然后你什么也不做。

你的意思是用那个开始一个线程`Runnable`吗？或者将其传递给线程池：

```
ExecutorService exec = Executors.newFixedThreadPool(threadPoolSize);

while (true) {
   try {
      Socket sock = server.accept();
      exec.submit(new FTPProtocol(sock));
   } catch (IOException e) {
      System.err.println(e.getMessage());
      return;
   }
} 
```

这将确保您不会启动更多线程，并且为每个对象调用`threadPoolSize`适当`run`的方法。`FTPProtocol`

# mysql - MYSQL 导出值而不是 ID

> ID：10687392
> 
> 赞同：1
> 
> 时间：2012-05-21T14:40:34.900
> 
> 标签：mysql, excel, export-to-excel

我有一个名为“wp_quotes”的 MYSQL 数据库表，其中一个字段包含一个名为“media”的列，如下所示。

'wp_quotes' 表

“媒体” - 此列显示“1”或“2”（ID 号），具体取决于用户在表单上选择的内容。

我有另一个名为“wp_quote_forms_fields_values”的表，它为这个 ID 分配了一个值——“CD”或“DVD”

'wp_quote_forms_fields_values' 表

ID 1 的值为“CD”

ID 2 的值为“DVD”

当我运行查询（导出文件）时，如何让媒体列显示“CD”或“DVD”而不是“1”或“2”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:43:23.600

您需要加入具有描述的表，如下所示：

```
SELECT a.ID,a.time,a.quote,b.value as MediaDesc,a.quantity,
c.value As PackDesc,a.username,
a.email,a.company,a.contact_number,a.found_us‌​,a.additional_info 
FROM wp_quotes a
INNER JOIN wp_quote_forms_fields_values b ON b.ID = a.media
INNER JOIN wp_quote_forms_fields_values c ON c.ID = a.pack 
```

# c# - Use of LINQ on Arbitrary Tables

> ID：10687393
> 
> 赞同：1
> 
> 时间：2012-05-21T14:40:45.760
> 
> 标签：c#, linq, linq-to-sql

I love LINQ esp. LINQ to SQL. The use of LINQ for static tables (where the structure of the table is known before hand) is great.

I now have a list of tables where I only know the Table Name (as a string). I also know that each row in the table would have an ID/Primary Key(int) and a number of undetermined columns whose datatypes are varchar/string. I can get the names of the columns using [SMO](http://msdn.microsoft.com/en-us/library/ms162169.aspx).

I am wondering what is the best way to query these columns e.g. run a distinct on each of them? LINQ to SQL seems to be pretty efficient by converting the query directly to SQL. I would prefer not to write the SQL by hand.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:15:26.057

LINQ 与类型一起工作——如果你没有为你的表生成类，你就不能真正使用 LINQ。您正在尝试在非强类型场景中使用强类型工具。

您可能需要一个 SQL 构建器库，例如[http://www.codeproject.com/Articles/13419/SelectQueryBuilder-Building-complex-and-flexible-S](http://www.codeproject.com/Articles/13419/SelectQueryBuilder-Building-complex-and-flexible-S)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:18:48.403

也许动态 linq 会满足您的需求

[动态 LINQ（第 1 部分：使用 LINQ 动态查询库）](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

从[MSDN下载](http://msdn.microsoft.com/en-us/vstudio//bb894665.aspx)

片段：

```
// your columnnames would be more dynamic :)
string columnName1 = "id";
string columnName2 = "someOther";

// to execute a dynamic query simple put the columnnames with your 
yourContext.SomeItems
    .Where(string.Format("{0} == 123 and {1} > 4",columnName1, columnName2); 
```

# c++ - GSL 中的静态虚拟解决方法

> ID：10687397
> 
> 赞同：4
> 
> 时间：2012-05-21T14:40:50.703
> 
> 标签：c++, static, virtual

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T14:45:21.757

I presume the `void*` in your function definition is a user-specified callback parameter. In that case, use this parameter to pass a pointer to your object and make your callback a static function. Inside this static function, cast this pointer back to the proper type (`Experiment*`) and call the non-static version of the function.

```
class Experiment
{
public:
    Experiment();
    ~Experiment();

    void setupExperiment();
    static int static_func(double t, const double y[], double f[], void *params);
    static int static_jac (double t, const double y[], double *dfdy, double dfdt[], void *params);
    virtual int func(double t, const double y[], double f[]);
    virtual int jac (double t, const double y[], double *dfdy, double dfdt[]);
};

void Experiment::setupExperiment()
{
    gsl_odeiv2_system sys = {static_func, static_jac, 2, this}; //Here is the problem with virtual functions
}

int Experiment::static_func(double t, const double y[], double f[], void *params)
{
  return ((Experiment*)params)->func(t, y, f);
}

int Experiment::static_jac (double t, const double y[], double *dfdy, double dfdt[], void *params)
{
  return ((Experiment*)params)->jac(t, y, dfdy, dfdt);
}

class aSpecificProblem: public Experiment
{
public:
    virtual int func(double t, const double y[], double f[]);
    virtual int jac (double t, const double y[], double *dfdy, double dfdt[]);
}; 
```

# ios - UIGesturerecognizer 不调用 shouldRecognizeSimultaneouslyWithGestureRecognizer

> ID：10687399
> 
> 赞同：0
> 
> 时间：2012-05-21T14:40:56.767
> 
> 标签：ios, cocoa-touch, ipad, uigesturerecognizer

这是我添加手势识别器的代码

```
 UIImage *img = [UIImage imageWithContentsOfFile:media.thumbnailPath];
    UIImageView *imageView = [[UIImageView alloc] init];  
    imageView.image = img;  
    imageView.contentMode = UIViewContentModeScaleToFill;
    imageView.backgroundColor =[UIColor blackColor];  

    //Add tap guesture
    UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTap:)];
    UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleDoubleTap:)];

    [singleTap setNumberOfTapsRequired:1];
    [singleTap setDelegate:self];

    [doubleTap setNumberOfTapsRequired:2];
    [doubleTap setDelegate:self];

    [singleTap requireGestureRecognizerToFail:doubleTap];

    [imageView addGestureRecognizer:singleTap];
    [imageView addGestureRecognizer:doubleTap];
    [singleTap release];
    [doubleTap release]; 
```

我已经实施了

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer
{
     NSLog(@"Gesturing");
     return YES;
} 
```

但是在处理单击手势时不调用委托方法，但它适用于双击手势

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:41:18.000

查看[Iphone SDK 中的同步手势识别器](https://stackoverflow.com/a/3319426/1378447)

> 在大多数情况下，您不需要：
> 
> ```
> setup a delegate
> permit simultaneous gesture recognition (unless you want simultaneous swipes; not likely) 
> ```

设置手势识别器

```
UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] 
                                     initWithTarget:self 
                                     action:@selector(handleSingleTapOnMainImageView:)];

[imageView addGestureRecognizer:singleTap];
[singleTap release];

UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] 
                                     initWithTarget:self 
                                     action:@selector(handleDoubleTapOnMainImageView:)];
[doubleTap setNumberOfTapsRequired:2];
[singleTap requireGestureRecognizerToFail:doubleTap];
[imageView addGestureRecognizer:doubleTap];
[doubleTap release]; 
```

方法实现

```
-(void)handleSingleTapOnMainImageView:(UIGestureRecognizer*)gestureView
{
NSLog(@"handleSingleTapOnMainImageView");
}

-(void)handleDoubleTapOnMainImageView:(UIGestureRecognizer*)gestureView
{
NSLog(@"handleDoubleTapOnMainImageView");
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-08-19T03:38:28.367

添加`imageView.userInteractionEnabled = YES;`将是工作！

# sql-server - sql server：查找具有相同列中其他值的确切子字符串的字符串的记录

> ID：10687403
> 
> 赞同：0
> 
> 时间：2012-05-21T14:41:13.943
> 
> 标签：sql-server, string, tsql

我有一个名为“comments”的列，并希望在“comments”列中查找包含字符串的所有记录，这些字符串是同一列中*任何其他单元格的确切子字符串。*这些确切的子字符串必须是完整的单词，即它们应该与作为子字符串的字符串的其余部分用空格分隔。

我想我需要使用类似于数组函数的东西。这在 SQL Server 2005 中怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:21:36.283

也许是这样的：

```
WITH data (id, str) AS (
  SELECT 1, 'some' UNION ALL
  SELECT 2, 'thing' UNION ALL
  SELECT 3, 'somethings' UNION ALL
  SELECT 4, 'something else' UNION ALL
  SELECT 5, 'two things' UNION ALL
  SELECT 6, 'twenty two things'
)
SELECT str
FROM data d
WHERE EXISTS (
  SELECT *
  FROM data
  WHERE str     LIKE '%'     + d.str +     '%'
    AND str NOT LIKE '%[^ ]' + d.str +     '%'
    AND str NOT LIKE '%'     + d.str + '[^ ]%'
    AND id <> d.id
) 
```

这将查找在同一列的另一个值中被空格包围的值（单词或短语），或者位于同一列的另一个值的开头或结尾。

这个特定的例子只产生一个结果：

```
str
----------
two things 
```

至少可以说，该查询几乎不会非常有效，但希望可以激发您或其他人提出更好的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:42:20.840

给定模糊规格的粗略猜测：

```
SELECT col1, col2, col3, comments
  FROM dbo.your_table
  WHERE comments LIKE '% ' + col1 + ' %'
     OR comments LIKE '% ' + col2 + ' %'
     OR comments LIKE '% ' + col3 + ' %'; 
```

请注意，这不会令人印象深刻。

# android - LocationManager's getBestProvider returning null

> ID：10687409
> 
> 赞同：24
> 
> 时间：2012-05-21T14:41:37.017
> 
> 标签：android, android-location

I have a bunch of people reporting an error that I cannot reproduce. When trying to open a `MapView` it's reporting that the `getBestProvider` is returning null and I know that means that that no provider is found that fulfills my criteria which is `ACCURACY_COARSE` so if there is no GPS then it should fall back on either `network or passive` but it obviously doesn't on those user devices. What would that even mean then that GPS is off and there is no network connection?

I tried turning GPS off and putting the phone into airplane mode to try to reproduce the problem but still I was able to open the mapview without a force close so I don't know how to handle this problem.

```
locationManager = (LocationManager) this.getSystemService(LOCATION_SERVICE);
geocoder = new Geocoder(this);

Criteria criteria = new Criteria();
criteria.setAccuracy(Criteria.ACCURACY_COARSE);
List<String> lProviders = locationManager.getProviders(false);
for(int i=0; i<lProviders.size(); i++){
    Log.d("LocationActivity", lProviders.get(i));
}
String provider = locationManager.getBestProvider(criteria, true); // null

long minTime = 60000;
float minDistance = 5;

locationManager.requestLocationUpdates(provider, minTime, minDistance, this); 
```

error

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{ecm2.android/ecm2.android.LocationActivity}: 
java.lang.IllegalArgumentException: provider==null
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
at android.app.ActivityThread.access$2300(ActivityThread.java:125)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:4627)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:521)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.IllegalArgumentException: provider==null
at android.location.LocationManager.requestLocationUpdates(LocationManager.java:625)
at ecm2.android.LocationActivity.onCreate(LocationActivity.java:142)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-21T16:01:48.637

在您的呼叫中，`getBestProvider()`您**只要求启用提供程序**（这是您设置为的方法调用中的第二个参数`true`）。如果用户禁用了所有提供程序，您将获得`null`.

在任何情况下，您都需要能够处理没有可用提供程序的情况，因此您需要检查`null`并告诉用户他没有启用任何位置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-08-02T19:40:12.290

**androidManifest.xml**

```
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/> 
```

**MapsActivity.java**

```
 @Override
public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {
    if (permissions.length == 1 &&
            permissions[0] == android.Manifest.permission.ACCESS_FINE_LOCATION &&
            grantResults[0] == PackageManager.PERMISSION_GRANTED) {
        if (ActivityCompat.checkSelfPermission(this, android.Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, android.Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
            // TODO: Consider calling
            //    ActivityCompat#requestPermissions
            // here to request the missing permissions, and then overriding
            //   public void onRequestPermissionsResult(int requestCode, String[] permissions,
            //                                          int[] grantResults)
            // to handle the case where the user grants the permission. See the documentation
            // for ActivityCompat#requestPermissions for more details.
            return;
        }
        mMap.setMyLocationEnabled(true);
    } else {
        // Permission was denied. Display an error message.
    }
} 
```

**MapsActivity.java/onCreate()**

```
if (ContextCompat.checkSelfPermission(this, android.Manifest.permission.ACCESS_FINE_LOCATION)
            == PackageManager.PERMISSION_GRANTED) {
        mMap.setMyLocationEnabled(true);
    } else {
        ActivityCompat.requestPermissions(this,new String[]{android.Manifest.permission.ACCESS_FINE_LOCATION}, 1);
    } 
```

这对我有用；

# svn - Locking the local SVN files

> ID：10687410
> 
> 赞同：0
> 
> 时间：2012-05-21T14:41:42.367
> 
> 标签：svn, locking

I want to:

1.  update the file to a certain revision
2.  lock the working copy so no one else can update or modify it
3.  run a compile script (seperate to svn and quite slow)
4.  unlock file so other users can modify again

this is what I wrote (in windows command line syntax):

```
svn update file.cpp --force -r 320
svn lock file.cpp 
Call CompileScript.exe
svn unlock file.cpp 
```

However unfortunately another user ran an update on file.cpp whilst I was compiling, and it reverted to the latest version in the repository again i.e. it wasn't stopped by the lock.

Is there any way of locking the working copy so this doesn't happen?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:50:56.143

svn lock 命令是在存储库结束时停止提交/合并，它不会阻止某人修改或更改您的本地文件。你可以让它在DOS下只读吗？我认为它是 attrib +r，然后用 attrib -r 将其删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T19:33:18.643

您想锁定文件的本地副本吗？这是操作系统的事情，与 Subversion 无关。在每个人和他们的表亲都对您需要控制的文件具有读/写权限的情况下，您要做什么？

版本控制系统已经内置了做你想做的事情的方法，但是你需要使用一个直接在你控制之下的工作目录。用户不应该仅仅因为这个原因而共享工作目录。如果您需要合作空间，请创建一个分支，但不要共享工作目录。

我想您可以使用[cacls](http://ss64.com/nt/cacls.html)命令删除读/写权限，但如果您使用与其他人相同的用户 ID，其他人可以简单地授予自己权限。

# git - 路由：在内部将 dynDNS 主机名解析为本地 ip

> ID：10687413
> 
> 赞同：1
> 
> 时间：2012-05-21T14:41:59.283
> 
> 标签：git, networking, dns, dyndns

下面的问题容易解决吗？

我有一些 git repos 并添加了一个遥控器。从外面有一个存储库地址 git@my.externhostname.com/~/git/ ...

从里面是 git@192.168.1.10/~/git

有什么方法可以动态配置它，即当我在我的个人网络中时，我想将地址 my.externhostname.com 解析为上述 IP。

但是，如果地址不可访问（我在网络之外），我想使用基本的 DNS 服务器来解决它。

有任何想法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:54:26.237

您需要配置一个[拆分 DNS](http://en.wikipedia.org/wiki/Split-horizon_DNS)，如果它响应以太网接口上转到 192.168.1.10 的查询，它会假装拥有 externhostname.com 的区域。换句话说，如果您在专用网络上，您的 DNS 永远不应该转发到 DynDNS.com。

# php - joomla- js file calling

> ID：10687414
> 
> 赞同：0
> 
> 时间：2012-05-21T14:42:03.863
> 
> 标签：php, jquery, joomla

```
<script type="text/javascript" src="<?php echo $this->baseurl ?>/templates/eurostar/js/jquery-1.5.min.js" /></script> 
```

any error?

but if I just type `<` which file automatically closing again and again,

Why repeating this closing tag - `</script> </script> </script>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:54:52.207

削减

```
<script type="text/javascript" src="<?php echo $this->baseurl ?>/templates/eurostar/js/jquery-1.5.min.js"></script> 
```

# c# - Conditionally wrapping content with a Razor Helper

> ID：10687417
> 
> 赞同：4
> 
> 时间：2012-05-21T14:42:12.493
> 
> 标签：c#, asp.net-mvc, razor

Using Razor I want to conditionally wrap some content in a `<span>` element based on a boolean property of my model. My guess is that I will need to use [Templated Razor Delegates](http://haacked.com/archive/2011/02/27/templated-razor-delegates.aspx), but I'm finding it tricky to get them right.

My model goes something like:

```
public class Foo
{
    public bool IsBar { get; set; }
} 
```

and in my view I'd like to be able to use something similar to:

```
<a href="/baz">
    @Html.WrapWith(Model.IsBar, "span", @This content may be wrapped, or not)
</a> 
```

where it would render:

```
<!-- Model.IsBar == True -->
<a href="/baz">
    <span>This content may be wrapped, or not</span>
</a>

<!-- Model.IsBar == False-->
<a href="/baz">
    This content may be wrapped, or not
</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:56:29.713

我总是用 span 包装内容，让 css 处理所有的表示逻辑，如果有的话

```
<a href="/baz">
    <span class="@(Model.IsBar ? "bar" : "")">This content may be wrapped, or not</span>
</a> 
```

并将css规则应用于`.bar`

```
span.bar
{
   //some style rules
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:45:22.833

you could do an If in your editor Template view with Razor

```
@if(Model.IsBar)
{
      <span>This content may be wrapped, or not</span>
}
else
{
       This content may be wrapped, or not
} 
```

**UPDATE**

or you could do your custom helper

```
@helper Foo(bool bar)
{
     @if(bar)
     {
      <span>This content may be wrapped, or not</span>
     }
     else
     {
       This content may be wrapped, or not
     }

} 
```

# sql - 使用 SELECT 语句中的计算值更新空列？

> ID：10687422
> 
> 赞同：0
> 
> 时间：2012-05-21T14:42:28.333
> 
> 标签：sql, sql-server

我有一个表，6 列，第 6 列是空的，但其他 5 列有数据。我使用第 4 列和第 5 列来计算一个值，然后我希望将此值插入到第 6 列中。

这是我到目前为止所拥有的：

```
UPDATE Table_Name 
SET Change = tab3.Difference
FROM
    (SELECT COBDate, FileName, ID, ScenarioID FROM Table_Name WHERE COBDate = '2012-05-18' AND FileName = 'GBP.csv') tab0
INNER JOIN
    (SELECT  tab1.ID, tab1.ScenarioID,tab1.COBDate, tab1.FileName, Val1 - Val2 AS Difference FROM
        (SELECT COBDate, FileName, ScenarioID, ID, CASE WHEN Value IS NULL THEN 0 ELSE Value END AS Val1 FROM Table_Name WHERE COBDate = '2012-05-18' AND FileName = 'GBP.csv') tab1
    JOIN
        (SELECT COBDate, FileName, ScenarioID, ID, CASE WHEN Value IS NULL THEN 0 ELSE Value END AS Val2  FROM Table_Name WHERE COBDate = '2012-05-17' AND FileName = 'GBP.csv') tab2
    ON tab1.ScenarioID = tab2.ScenarioID AND tab1.ID = tab2.ID) tab3
ON tab0.COBDate = tab3.COBDate
AND tab0.FileName = tab3.FileName
AND tab0.ID = tab3.ID
AND tab0.ScenarioID = tab3.ScenarioID 
```

编辑：上面的代码没有工作。无论主键如何，它都为每一行设置了相同的值....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:47:47.093

这能解决你的问题吗？

```
UPDATE Table_Name SET Column6 = Column4 + Column5 
```

要获得正确的行，请使用 WHERE 语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:48:04.703

重新编写您的语句，使 from 语句直接引用您正在更新的表。例如，使用`where`子句删除您的第一个子选择，类似于：

```
UPDATE Table_Name
SET Change = tab3.Difference 
FROM Table_Name tab0

    INNER JOIN     

    (SELECT  tab1.ID, tab1.ScenarioID,tab1.COBDate, tab1.FileName, Val1 - Val2 AS Difference 
        FROM
            (SELECT COBDate, FileName, ScenarioID, ID, CASE WHEN Value IS NULL THEN 0 ELSE Value END AS Val1 
            FROM Table_Name 
            WHERE COBDate = '2012-05-18' AND FileName = 'GBP.csv'
        ) tab1     
        JOIN         
            (SELECT COBDate, FileName, ScenarioID, ID, CASE WHEN Value IS NULL THEN 0 ELSE Value END AS Val2  
            FROM Table_Name 
            WHERE COBDate = '2012-05-17' AND FileName = 'GBP.csv'
        ) tab2 ON 
                tab1.ScenarioID = tab2.ScenarioID 
                AND tab1.ID = tab2.ID
    ) tab3 ON 

    tab0.COBDate = tab3.COBDate 
    AND tab0.FileName = tab3.FileName 
    AND tab0.ID = tab3.ID 
    AND tab0.ScenarioID = tab3.ScenarioID 

WHERE tab0.COBDate = '2012-05-18'
    and tab0.FileName = 'GBP.csv' 
```

# javascript - 将 xmlhttprequest 中的 jpg 数据放入标签中

> ID：10687427
> 
> 赞同：2
> 
> 时间：2012-05-21T14:42:45.477
> 
> 标签：javascript, xmlhttprequest, jpeg, httpresponse, binary-data

这是我的代码的一部分

```
xmlhttp.open("GET", theUrl, true);
document.imglive.innerHTML = '<img src="data:image/jpeg,' + xmlhttp.responseText + '"/>'; 
```

这似乎不起作用。我也试过

```
document.imglive.src= xmlhttp.responseText; 
```

两者都不起作用

我在这里检查了一些被问到的问题，但没有一个答案可以帮助解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:49:36.347

对这些事情使用 base64。在现代浏览器中，有这个本`btoa`机功能可以帮助您：

```
document.imglive.innerHTML = "<img src='data:image/jpeg;base64," + btoa(xmlhttp.responseText) + "'/>"; 
```

对于其他浏览器，有简单的模拟实现，只需查看它们即可。

PS：不要污染`document`对象，使用单独的变量或命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-09T10:22:37.293

如果您对 IE10+ 感到满意，您可以`xhr.responseType = 'blob'`结合使用`window.URL.createObjectURL()`（以获得获得正确 mime 类型的免费支持）。

```
xhr.responseType = 'blob';
xhr.onload = function(response) {
  var url = window.URL.createObjectURL(response);
  document.imglive.src = url; // from your example code
}
xhr.open("GET", theUrl, true); 
```

# apache - 如何重定向完全编码的 url htaccess？

> ID：10687428
> 
> 赞同：0
> 
> 时间：2012-05-21T14:42:48.970
> 
> 标签：apache, .htaccess, redirect

我想重定向[http://www.site1.com/%D7%94%D7%92%D7%9C%D7%99%D7%9C/%D7%AA%D7%9C-%D7%A7%D7 %93%D7%A9](http://www.site1.com/%D7%94%D7%92%D7%9C%D7%99%D7%9C/%D7%AA%D7%9C-%D7%A7%D7%93%D7%A9)

到

[http://www.site2.com/history](http://www.site2.com/history)

尝试了许多不同的规则，机器人不起作用。

需要帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:47:30.943

mod_rewrite 取消编码 url，以便您可以使用它：

```
RewriteEngine On
RewriteBase /
RewriteRule "הגליל/תל-קדש" http://site2.com/history [R,L] 
```

# pisa - 如何使用比萨 xhtml2pdf 设置 3 列布局

> ID：10687434
> 
> 赞同：2
> 
> 时间：2012-05-21T14:43:07.733
> 
> 标签：pisa, xhtml2pdf

我有一个要在三列中布局的项目列表。该列表很长（使用 3 列布局可能需要 5 页）。条件如下：

1.  第一个页面有一个大约 200px 高和 100% 宽的页眉。在第一页的标题之后，页面应该开始以 3 列显示列表。
2.  “中间和最后”页面不包含任何标题。
3.  最后一页包含图像。

我试图为第二帧和第三帧设置页边距，第一页看起来正确，但“中间”页没有。margin-top 应用于所有页面。

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-23T21:17:04.200

当一帧被填满时，pisa 会自动使用下一帧。该示例在[usage.rst](https://github.com/chrisglass/xhtml2pdf/blob/master/doc/usage.rst)中进行了解释：

```
<html>
<head>
<style>
    @page {
        size: letter portrait;
        @frame header_frame {           /* Static frame */
            -pdf-frame-content: header_content;
            left: 50pt; width: 512pt; top: 50pt; height: 40pt;
        }
        @frame col1_frame {             /* Content frame 1 */
            left: 44pt; width: 245pt; top: 90pt; height: 632pt;
        }
        @frame col2_frame {             /* Content frame 2 */
            left: 323pt; width: 245pt; top: 90pt; height: 632pt;
        }
        @frame footer_frame {           /* Static frame */
            -pdf-frame-content: footer_content;
            left: 50pt; width: 512pt; top: 772pt; height: 20pt;
        }
    }
</style>
<head>

<body>
    <div id="header_content">Lyrics-R-Us</div>
    <div id="footer_content">(c) - page <pdf:pagenumber>
        of <pdf:pagecount>
    </div>
    <p>Old MacDonald had a farm. EIEIO.</p>
    <p>And on that farm he had a cow. EIEIO.</p>
    <p>With a moo-moo here, and a moo-moo there.</p>
    <p>Here a moo, there a moo, everywhere a moo-moo.</p>
</body>
</html> 
```

> HTML 内容将从 Page1.Col1 流向 Page1.Col2 再到 Page2.Col1 等。生成的 PDF 文档如下所示：

```
+-------------------------------+    +-------------------------------+
| Lyrics-R-Us                   |    | Lyrics-R-Us                   |
|                               |    |                               |
| Old MacDonald   farm he had a |    | a moo-moo       everywhere a  |
| had a farm.     cow. EIEIO.   |    | there.          moo-moo.      |
| EIEIO.          With a moo-   |    | Here a moo,                   |
| and on that     moo here, and |    | there a moo,                  |
|                               |    |                               |
| (c) - page 1 of 2             |    | (c) - page 2 of 2             |
+-------------------------------+    +-------------------------------+ 
```

# sql - 需要关于看似简单的 SQL 查询的提示

> ID：10687436
> 
> 赞同：2
> 
> 时间：2012-05-21T14:43:21.407
> 
> 标签：sql, select, count, sql-server-2008-r2

我正在尝试做类似的事情：

```
SELECT c.id, c.name, COUNT(orders.id)
FROM customers c
JOIN orders o ON o.customerId = c.id 
```

但是，SQL 不允许使用 COUNT 函数。执行时给出的错误是 c.Id 在选择列表中无效，因为它不在 group by 子句中或未聚合。

我想我知道问题所在， COUNT 只计算表中的**所有**行`orders`。我如何计算每个客户的数量？

# 编辑

完整的查询，但它是荷兰语......这是我试过的：

```
select k.ID,
       Naam,
       Voornaam,
       Adres,
       Postcode,
       Gemeente,
       Land,
       Emailadres,
       Telefoonnummer,
       count(*) over (partition by k.id) as 'Aantal bestellingen',
       Kredietbedrag,
       Gebruikersnaam,
       k.LeverAdres,
       k.LeverPostnummer,
       k.LeverGemeente,
       k.LeverLand
from klanten k
  join bestellingen on bestellingen.klantId = k.id 
```

没有错误，但也没有结果..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T14:45:45.157

使用这样的聚合函数时，您需要按任何非聚合的列进行分组：

```
SELECT c.id, c.name, COUNT(orders.id)
FROM customers c
JOIN orders o ON o.customerId = c.id
GROUP BY c.id, c.name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:53:29.187

如果您真的希望能够在`Customers`不指定名称的情况下选择所有列（[请完整阅读此博客文章](https://sqlblog.org/2009/10/10/bad-habits-to-kick-using-select-omitting-the-column-list)以避免这种情况以及简单的解决方法），那么您可以改用这种懒惰的速记：

```
;WITH o AS 
(
  SELECT CustomerID, CustomerCount = COUNT(*)
  FROM dbo.Orders GROUP BY CustomerID
)
SELECT c.*, o.OrderCount
FROM dbo.Customers AS c
INNER JOIN dbo.Orders AS o
ON c.id = o.CustomerID; 
```

**编辑**您的真实查询

```
SELECT 
  k.ID, 
  k.Naam, 
  k.Voornaam, 
  k.Adres, 
  k.Postcode, 
  k.Gemeente, 
  k.Land, 
  k.Emailadres, 
  k.Telefoonnummer,
  [Aantal bestellingen] = o.klantCount, 
  k.Kredietbedrag, 
  k.Gebruikersnaam, 
  k.LeverAdres, 
  k.LeverPostnummer, 
  k.LeverGemeente, 
  k.LeverLand
FROM klanten AS k 
INNER JOIN 
(
  SELECT klantId, klanCount = COUNT(*)
  FROM dbo.bestellingen 
  GROUP BY klantId
) AS o
ON k.id = o.klantId; 
```

我认为这个解决方案比按所有列分组要干净得多。首先对订单表进行分组，然后将每个客户行加入一次可能比先加入然后分组更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:50:03.970

以下将计算每个客户的订单，而不需要按 customer.id 对整体查询进行分组。但这也意味着对于有多个订单的客户，每个订单都会重复该计数。

```
 SELECT c.id, c.name, COUNT(orders.id) over (partition by c.id)
 FROM customers c
   JOIN orders ON o.customerId = c.id 
```

# c# - 如何让一个方法接受两种类型的数据作为参数？

> ID：10687438
> 
> 赞同：3
> 
> 时间：2012-05-21T14:43:28.013
> 
> 标签：c#, .net, arguments

这与我前段时间提出的问题有些相同： [如何让方法接受两种类型的数据作为参数？](https://stackoverflow.com/questions/10128823/how-to-let-a-method-accept-two-types-of-data-as-argument)

然而，目前的情况不同......很多。

拿着这个：

```
public FormResourceSelector(Dictionary<string, Effect> resourceList, string type) 
```

好吧，没什么不好的。现在我尝试运行它：

```
FormResourceSelector frs = new FormResourceSelector(AreaEffect.EFFECTS, "Area effect");
FormResourceSelector frs2 = new FormResourceSelector(DistanceEffect.EFFECTS, "Distance effect"); 
```

AreaEffect 和 DistanceEffect（自定义类）都派生自 Effect。

```
public class AreaEffect : Effect
{
    public static Dictionary<string, AreaEffect> EFFECTS = new Dictionary<string, AreaEffect>();
    ...
} 
```

由于某种原因，在创建新的 FormResourceSelector 实例时出现以下错误：

```
Argument 1: cannot convert from 'System.Collections.Generic.Dictionary<string,SCreator.AreaEffect>' to 'System.Collections.Generic.Dictionary<string,SCreator.Effect>' 
```

在：

```
new FormResourceSelector(AreaEffect.EFFECTS, "Area effect"); 
```

我怀疑字典是一种骚扰，但我真的不知道如何解决这个问题。

编辑：最简单的方法是在我给出的第一个代码片段中允许将 Dictionary 和 Dictionary 作为 resourceList 输入。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T14:46:11.647

为什么不让你的类通用？

```
public class FormResourceSelector<T>
    where T : Effect
{
    public FormResourceSelector(Dictionary<string, T> resourceList, string type)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:05:14.873

评论太大，所以这里是 llia 的答案更新编译：

```
public class FormResourceSelector<T> where T : Effect
{
    // Constructor
    public FormResourceSelector(
       Dictionary<string, T> resourceList, string type) 
    {

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:48:04.597

考虑以下：

```
public FormResourceSelector(Dictionary<string, Effect> resourceList, string type)
{
    resourceList.Add(new Effect());
} 
```

您是否要在以下位置传递派生类型的字典：

```
var effects = new Dictionary<string, AreaEffect>();
new FormResourceSelector(effects, ""); 
```

尝试将 an 设置`Effect`为*真正*的 an时会遇到问题`AreaEffect`，编译器正在阻止这种情况发生。

正如其他答案所述，您可以使用泛型在编译时指定类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T14:48:30.450

这里的概念被称为方差 - 你遇到了 Dictionary 不支持协方差的问题，因为它不是只读的 - 这将是不安全的，例如：

```
IDictionary<string, object> myDict = new Dictionary<string, string>();
myDict["hello"] = 5; // not an string 
```

请参阅：[IDictionary<TKey, TValue> in .NET 4 not covariant](https://stackoverflow.com/questions/2149589/idictionarytkey-tvalue-in-net-4-not-covariant)

# jquery - 菜单在 IE8/7 中无法正常工作

> ID：10687443
> 
> 赞同：-4
> 
> 时间：2012-05-21T14:44:02.957
> 
> 标签：jquery, html, css

我在 IE7/8 中遇到菜单问题.. 当我将鼠标悬停在导航上时.. 子菜单也显示在主菜单列表中..

请检查 IE8 中的第二个菜单

[http://www.mulberrydesignerkitchens.com/](http://www.mulberrydesignerkitchens.com/)并给我一些修复..

请帮帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:00:48.830

你根本没有定位你的子菜单。试试这个：

```
nav#primary-menu ul#menu-mainnav li ul.sub-menu {
    position: absolute;
    left: 0;
    top: 100%;
} 
```

# linux - 修复不连贯编码的文本文件的编码

> ID：10687447
> 
> 赞同：5
> 
> 时间：2012-05-21T14:44:13.007
> 
> 标签：linux, perl, character-encoding, iconv, bibtex

我有一个长文本文件，它在随后的文本块（iso 或 utf-8）中使用明显不同的编码。它是使用`>> file.bib`来自不同来源（网页）的附加文本以及复制和粘贴的结果。

原则上可以区分块，因为它们是`bibtex`条目

```
 @article{key, author={lastname, firstname}, ...} 
```

我想将其转换为连贯的 utf-8 文件，因为它似乎使我的 bibtex 查看器（kbibtex）崩溃。我知道我可以`iconv`用来转换整个文件的编码，但我想知道是否有办法修复我的文件而不破坏某些条目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:28:34.050

如果您可以为每一行假设统一编码并且您知道备用编码：

```
#!/usr/bin/perl
use Encode;
while(<>) {
      my $line;
      eval {
        $line=Encode::decode_utf8( $_ );
      }
      if ($@) $line=Encode::decode( 'iso-8859-1', $_ ); #not UTF-8
      # Now $line is UNICODE.Do something to it

} 
```

如果行是混合编码，您仍然可以通过单词执行相同的操作，但您仍然知道什么是替代编码。如果不知道备用编码，或者如果你有多个，你需要使用一些编码猜测库，这很可能会猜错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T20:00:02.087

我为此使用 vim，但我想它可以在任何编辑器中完成。

*   选择 (shift+v) 要更改编码的文本块。

*   type :!enca -L lang -（用你的语言替换'lang'，我使用'enca -L cs'。enca实用程序应该告诉你所选块的最可能编码）

*   按 u（这样您就可以撤消文本中出现的 enca 的答案）

*   再次选择块，这次运行 :!iconv -f denied_encoding -t UTF-8

请注意，当您处于可视模式时，vim 会自动将按下的 : 扩展为 :\<,>，这正是您在文本块上运行程序所需要的。

# xcode - Xcode 4.3.2 显示隐藏文件

> ID：10687449
> 
> 赞同：10
> 
> 时间：2012-05-21T14:44:24.680
> 
> 标签：xcode, file, hidden, finder

我正在使用 Xcode 4.3.2，并且正在尝试向我的项目添加一些 SDK 引用。我可以使用 Finder 查看文件，因为我使用终端脚本查看隐藏文件。然而，当我在 Xcode finder 中转到我的用户主目录时，它不会在我的用户配置文件下显示存储我的 SDK 文件的“隐藏”“库”文件夹。

*抓头*

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-06-29T12:23:25.357

按住`⌘</kbd> + `shift` and `.` keys at the same time.`

然后您可以切换到查看隐藏/非隐藏文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-23T16:39:44.510

9 个月后从 OS X 10.8 Mountain Lion 回复您...

按`⌘</kbd>`Shift``G` from within Xcode's Open dialog -- this is the Go To Folder command from Finder. This works in XCode's Open dialog as well. You could go to 'Library' or, as I did below, go to the otherwise hidden .config directory by typing '.config'`

[此屏幕截图](https://www.flickr.com/photos/_complex_/8499908883/)显示了打开 .config 文件夹的过程和结果。请注意，我已经“转到”了一次 .config 文件夹，这就是它显示在左侧应用程序上方的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T18:42:46.100

您正在使用哪个命令？使用 Bellow 命令对我有用。

如果您的文件夹中看不到库文件夹，请在终端（应用程序->实用程序->终端）应用程序上输入命令“chflags nohidden ~/Library/”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-27T05:02:04.117

有一个类似的问题（但到达此页面寻找答案）。

我删除了对 XCode 中我实际上想要保留的文件的引用，但该文件仍然存在于 finder 中。

即使文件位于正确的文件夹中，Xcode 也不会确认它，直到您通过**File > Add Files To "YourProject"重新添加它**

我要说的是，代码项目文件夹中的文件与 XCode 项目中实际包含的文件是两个不同的东西

# java - 数据源属性

> ID：10687453
> 
> 赞同：0
> 
> 时间：2012-05-21T14:44:35.303
> 
> 标签：java, jdbc

为什么 `DataSource`接口没有定义 JDBC- [DataSource](http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/getstart/datasource.html)指定的标准数据源属性？

`ds`使用该类型的引用，`DataSource`我无法像这样设置以下属性：

```
public DbUtil(DataSource ds, String dbName, String port){
  ds.setServerName(dbName);
  ds.setPortNumber(port); 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:47:51.503

因为与普通 old 不同，您不*应该*传递这些值`DriverManager`。DataSource 通常在容器上配置，并且仅使用 JNDI 进行查找。

如果您再次开始传递这些值，它将破坏具有可配置数据源的全部意义。

这是来自 API 的引用。

> DataSource 接口由驱动程序供应商实现。
> 
> DataSource 对象具有可在必要时修改的属性。例如，如果将数据源移动到不同的服务器，则可以更改服务器的属性。好处是因为可以更改数据源的属性，因此无需更改访问该数据源的任何代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:51:28.277

因为在数据源上手动设置数据库名称或数据库配置没有意义，如果允许，它将在运行时破坏数据源功能，而在使用 Oracle 时，您想要更改服务器详细信息并且您将开始指向 Sybase .

这些参数应该提供给容器，您可以在运行时使用它们，允许覆盖或更改这些细节的机制太危险了。

这里要注意的另一件事是，如果这些属性成为合同的一部分，那么对于调用者来说它就是太多的信息，这不利于封装。

您的代码不需要知道这些细节是其配置的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:18:01.067

JDBC 4.1 规范，第**9.4.1节** *DataSource Properties*回答了您的问题：

> DataSource 属性不打算由 JDBC 客户端直接访问。通过在实现类上而不是在应用程序使用的公共 DataSource 接口上定义访问方法，这种设计得到了加强。此外，客户端操作的对象可以是仅实现 DataSource 接口的包装器。属性的 setter 和 getter 方法不需要暴露给客户端。

驱动程序实现者也可以添加特定于其数据库的 setter/getter

# java - 如何防止在使用页面上的任何按钮时触发 rowSelector 的 clickAction 方法？

> ID：10687455
> 
> 赞同：0
> 
> 时间：2012-05-21T14:44:42.150
> 
> 标签：java, jsf, facelets, icefaces

我在一列中`ice:dataTable`有一个，在另一列中有一个。已设置为假。 如果我在一行中选择一个复选框（单击），则不会触发 clickAction（因为- 到目前为止，非常好）。 但是，如果我在此之后单击同一页面上的按钮，无论它们具有什么操作绑定，都会触发 rowSelector。为什么？ 有什么想法可以防止这种情况吗？`ice:rowSelector``ice:selectBooleanCheckbox``ice:rowSelector``toggleOnInput`
`toggleOnInput`
`clickAction`

这是我的页面定义：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html">
    <f:view>
        <ice:form>
            <ice:commandButton value="Test" />

            <ice:dataTable id="dataTable"
                       value="#{PageBean.data}"
                       var="entity">
                <ice:column>
                    <ice:selectBooleanCheckbox />
                </ice:column>
                <ice:column>
                    <ice:outputText value="#{entity.name}" />
                    <ice:rowSelector clickAction="#{PageBean.clickAction}" toggleOnInput="false" />                 
                </ice:column>
            </ice:dataTable>
       </ice:form>
    </f:view>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:14:30.820

您可以尝试为页面中的其他按钮和数据表中的其他按钮制作不同的表单，我们不应该有嵌套表单但可以有多个表单

`selectionAction`另外，如果您在单击相应行时执行要调用的 Action 方法，我建议使用属性。

希望这可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:11:09.497

我可以看到您正在使用一个命令按钮，该按钮指定为：

```
ice:commandButton

The ice:commandButton tag displays a button which can be linked to an action in 
a backing bean method by specifying the bean and the method in the actionListener
attribute. The button can be replaced by an image by specifying the URL of the  
image in the image attribute. 
```

我清楚地看到它由 bean 方法支持。彻底检查您的代码。

# php - PHP $_POST 在 IE9 和 IIS7 上为空

> ID：10687457
> 
> 赞同：6
> 
> 时间：2012-05-21T14:44:50.603
> 
> 标签：php, forms, iis, post

以下形式`$_POST`在 IE9 上导致一个空变量。

```
<form id='login' action='login.php' method='POST' accept-charset='UTF-8'>
<input type='text' name="username" id='username'  />
<input type='password' name='password' id='password' />
<input type="text" name="store" />
<input type='submit' name='Submit' value='Submit' />
</form> 
```

该表单在 Firefox 和 Chrome 上完美运行。所有变量都出现在`$_POST`变量中，没有问题。

然而，在 IE9 上，表单已正确提交，但`$_POST`它是空数组。即，在 login.php 中：

```
print_r($_POST); 
```

打印空数组。我试图弄清楚 IE9 可能有什么不同，这使它的行为与 Firefox 和 Chrome 不同，但我无法弄清楚。

我发现提到 Apache 下的一些模块会导致人们出现问题，但我正在运行`IIS7`，而不是 Apache，所以不是这样。Ruby 论坛上有人提到在注册表中将 DisableNTLMPreAuth 设置为 1，但这也没有修复它。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T10:45:47.483

接受字符集在 Internet Explorer 中不受支持。删除它，看看是否可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T17:25:10.913

我认为这与双重打击有关 - 即 IE 正在以某种方式重新加载页面。您是否有一些客户端的东西（jQuery？）会意外地重新加载页面作为错误？尝试发布到一个全新的页面并`<?PHP die ('<pre>'.print_r($_REQUEST,true).'</pre>');?>`在第一行写下，看看会发生什么。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-19T04:04:02.777

请输入表单的“名称”属性。

```
<form id='login'  name='login' action='login.php' method='POST' accept-charset='UTF-8'>
<input type='text' name="username" id='username'  />
<input type='password' name='password' id='password' />
<input type="text" name="store" />
<input type='submit' name='Submit' value='Submit' />
</form> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-19T04:19:37.607

原因是您没有维护会话。在 Firefox 和 Chrome 中，它们非常聪明，它们维护会话而不考虑开发代码，这给用户带来了好东西。但是在 IE6-9 中，IE 无法维护会话，开发人员必须检查它，如果会话没有维护，则加载的每个页面都是一个新会话，因此没有帖子。

# objective-c - 实现相似场景的最有效方式

> ID：10687459
> 
> 赞同：0
> 
> 时间：2012-05-21T14:44:53.277
> 
> 标签：objective-c, ios, cocos2d-iphone

所以我正在用 cocos2d 创建一个游戏，我的很多场景（不是全部，而是很多）都会有一种你可以称之为“记分牌”的东西，它们会有基本的原则。我想知道，我怎样才能使“游戏场景”都可以实现记分牌？

我在想这可以使用类似类别的东西，但我对 iOS/obj-c 还很陌生，所以我不知道这是否是正确的方法。

在 Java 中，我可能只是将所有场景创建为子类，并让超类完成所有记分牌处理，但我不知道如何在 iOS/obj-c 中做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:26:24.603

子类 CCNode 或任何其他合适的类（CCScene、CCLayer，这并不重要）。将此类命名为 MyScoreboard。通过向其添加节点并定位它们来设计您的记分牌节点，就像任何其他场景一样。

然后，只要您需要记分板，只需创建一个实例并将其添加到节点层次结构中：

```
MyScoreboard* scoreboard = [[MyScoreboard alloc] init];
[self addChild:scoreboard]; 
```

根据需要使用参数 (initWithScore:Player:WhatNot:) 修改 init。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:18:36.380

您可以在此处使用相同的解决方案。创建 CCScene 的子类。然后在那里实现你的分数逻辑。场景的所有子类都可以调用这些方法。例如，您可以创建方法 showScore/hideScore 或其他方法。在那里，您可以在当前场景中构建和添加/删除您的分数实例。

# c - problems when writing a C proxy

> ID：10687469
> 
> 赞同：-1
> 
> 时间：2012-05-21T14:45:30.477
> 
> 标签：c, http, proxy

I am now writing a simple c version proxy. As am a beginning. I don not know how it works. I've got the header from request.

> GET [http://www.google.com/intl/zh-CN/options/](http://www.google.com/intl/zh-CN/options/) HTTP/1.1 Host: www.google.com User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:11.0) Gecko/20100101 Firefox/11.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Proxy-Connection: keep-alive Cookie: __utma=173272373.193679248.1334660049.1334660049.1334660049.1; __utmz=173272373.1334660049.1.1.utmcsr=google.com|utmccn=(referral)|utmcmd=referral|utmcct=/; PREF=ID=fa48aeea1d8f76b9:U=a085cdf552ee303a:FF=0:TM=1329307863:LM=1334660032:S=rrb7tn0TSlZxymZj; NID=57=eF8kg0Geq6xPrc4flrw-ps5WXffeSS16kpTjTUXb_7-4tw0wXKbXKeWsa2UXr7o2gvV0o4-D9nVO5JV8PBFY5wT25oesLvlg7UiDwNM1wdC90WC3IqoZi3Kk0Pyh7Aj

_

What the next step should I do. Need I modify the header and send it to the web server. I've parser the URL from the header and connected to the WEBSERVER, and I just got another header. How can I get the body of the page?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:48:47.667

正文与标题之间用空行分隔（从技术上讲，是`\r\n\r\n`）。继续阅读远程服务器发送的内容。

# jakarta-ee - How to use the actor model in a Java EE servlet environment?

> ID：10687470
> 
> 赞同：0
> 
> 时间：2012-05-21T14:45:38.300
> 
> 标签：jakarta-ee, servlets, model, actor

I am reading about the actor model recently, and I found it's a good programming model for concurrent issues. There are many program languages or tools that use this, like Scala, Jetlang, Klimi, etc.

But how can use these be used in a common web application (a Servlet based one for example)? Servlets are executed in multi-threaded style. Can we use the actor model to eliminate shared date like member variables in a Servlet (or SpringMVC controller etc..)?

Are there any Servlet containers that handle concurrent requests using the actor model?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:51:32.617

这是一种误解。您不能“在 servlet 环境中使用 actor 模型”，因为应用服务器已经实现了并发模型，它必须遵守 Java EE 规范。

特别是禁止在 servlet 中共享数据（可以修改），因为一个 servlet 对象用于处理所有来往的请求。另一方面，如果你有有状态的 EJB 组件，那么你就不需要关心并发问题 - 线程管理是由 EJB 容器完成的，事实上，你不能乱用它。

如果您想编写自己的服务器（而不是使用现有的基于 Java EE 的服务器），那么在这种情况下，值得考虑选择并发模型。

尽管演员是“热门话题”并且现在似乎是“本周流行语”，但请在网上搜索与演员模型的使用相关的问题和陷阱。现实并不像宣传的理论那么光明。

如果您搜索可以构建的高性能服务器-客户端解决方案，例如在 Netty 上查找 - 这是一款非常酷的软件，对于我们大多数人来说可能就足够了，即使有人想构建第二个 Twitter。

# javascript - Android Browser, when changing DOM body height, browser scrolls back to top

> ID：10687471
> 
> 赞同：1
> 
> 时间：2012-05-21T14:45:41.197
> 
> 标签：javascript, android, dom, browser

Happens using android 2.3.5\. Having an element at the bottom of the site - that when you click it, expands. But when this gets clicked, the browser jumps back to top, thus losing 'focus' of the element. Any chance this can be avoided?

The browser also jumps back when just changing the height on the body element with javascript.

# matlab - Usage of Libsvm model

> ID：10687472
> 
> 赞同：2
> 
> 时间：2012-05-21T14:45:41.070
> 
> 标签：matlab, model, svm, libsvm, prediction

I've developed a model using Libsvm in Matlab. I've choose best parameters using CV and I obtained the model training the whole dataset. I use normalization to get better results:

```
 maximum=max(TR)+0.00001;
 minimum=min(TR);

 for i=1:size(TR,2)
             training(1:size(TR,1),i)=double(TR(1:size(TR,1),i)-maximum(i))/(maximum(i)-minimum(i));
 end 
```

Now how can I use directly my model to obtain classification for new data? I mean for records that haven't class label. Do I have to manually build functions from model information?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:34:02.710

您是否正在使用`libsvmtrain`您的训练数据进行训练？如果是这样，则有一个输出参数可用于对测试/未来数据进行分类。`svmpredict`然后将该输出结构与测试数据一起传递。

# javascript - 使 requirejs 模块与 AMD 兼容

> ID：10687476
> 
> 赞同：3
> 
> 时间：2012-05-21T14:45:57.767
> 
> 标签：javascript, requirejs, modularity, commonjs, js-amd

我目前正在构建一个应用程序，前端正在做很多繁重的工作。为了保持一切整洁有序，我想使用[requirejs](http://requirejs.org/)。但是，要充分使用 require.js，我使用的所有模块都应该符合 AMD 标准。

这意味着每次更新我使用的模块时，我都需要等待兼容 AMD 的版本出现或自己制作一个（我目前不知道如何）。

这是一个真正的转折点。

看看这个[https://github.com/jrburke/backbone/blob/optamd/backbone.js](https://github.com/jrburke/backbone/blob/optamd/backbone.js)在我看来，制作一个像 Backbone AMD 兼容的模块并不像将插件包装成一个通用函数那么简单。

**是否有一种或多或少直接的方法可以使模块符合 AMD 标准？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:13:08.353

好吧，他的版本非常防弹，因此可以在各种情况下运行。由于您知道您正在运行的环境以及可用/不可用的环境，因此您可以做出一些假设，让您做一些更直接的事情。

查看这个要点，我将 bacbkonejs 设为 AMD 模块，假设 jQuery、下划线和定义在全局范围内，我不需要 commonjs 支持： [https ://gist.github.com/2762813](https://gist.github.com/2762813)

我只是添加

```
define(function() {
  var obj = {};
  obj._ = window._;
  obj.jQuery = window.jQuery; 
```

到顶部和

```
.call(obj);
   return obj.Backbone;
}); 
```

至底部。

* * *

感谢@SimonSmith 让我注意到了 UseJS。UseJS 是一个 AMD 加载器插件，它允许您加载非 amd 格式的模块而无需修改它们。我自己还没有使用过，但它看起来很有希望：[https ://github.com/tbranyen/use.js/](https://github.com/tbranyen/use.js/)

**更新**

RequireJS 2.0 现在直接支持您通过 shim 配置寻找的功能：[https ://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0#wiki-shim](https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0#wiki-shim)

# javascript - javascript 在每次点击时替换 div

> ID：10687479
> 
> 赞同：3
> 
> 时间：2012-05-21T14:46:05.930
> 
> 标签：javascript, replace

以下作品用新的 div 替换 div ...

```
<div id = "div1" style="display:block" onclick = "replace()"><img src="1.jpg" /></div>

<div id = "div2" style="display:none"><img src="2.jpg" /></div>

<script type = "text/javascript">
function replace() {
document.getElementById("div1").style.display="none";
document.getElementById("div2").style.display="block";
}

</script> 
```

我想不通的是如何使它工作，所以当你点击`div2`它时，它会被替换为`div3`等等。

换句话说，我想在每次点击时替换 div 不止一次。解决这个问题的最佳方法是什么？我是新手，所以不确定以上是否是一个好的开始。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:50:41.367

你可以做一个更通用的功能：

```
function replace( hide, show ) {
  document.getElementById(hide).style.display="none";
  document.getElementById(show).style.display="block";
} 
```

然后您可以创建许多 div 并使用相同的功能：

```
<div id = "div1" style="display:block" onclick = "replace('div1','div2')">...</div>
<div id = "div2" style="display:none" onclick = "replace('div2','div3')">..</div>
<div id = "div3" style="display:none" onclick = "replace('div3','div4')">..</div>
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:10:49.910

我会在这个答案中向您建议一些最佳实践：

*   使用类而不是样式属性，这对浏览器来说更好。
*   不要使用内联事件处理程序。请参见下面的示例。
*   您正在寻找的不是“替换”，而是“切换”。
*   我建议你使用事件冒泡。这样，您就可以在所有 div 的容器上添加一个事件，然后就可以处理它了。

好的，现在举个例子：

HTML：

```
<div id="container">
    <div id="div1">..</div>
    <div id="div2" class="hidden">..</div>
    <div id="div3" class="hidden">..</div>
</div> 
```

JS：

```
// Notice how I declare an onclick event in the javascript code
document.getElementById( 'container' ).onclick = function( e ) {

    // First, get the clicked element
    // We have to add these lines because IE is bad.
    // If you don't work with legacy browsers, the following is enough:
    //     var target = e.target;
    var evt = e || window.event,
        target = evt.target || evt.srcElement;

    // Then, check if the target is what we want clicked
    // For example, we don't want to bother about inner tags
    // of the "div1, div2" etc.
    if ( target.id.substr( 0, 3 ) === 'div' ) {

        // Hide the clicked element
        target.className = 'hidden';

        // Now you have two ways to do what you want:
        //     - Either you don't care about browser compatibility and you use
        //       nextElementSibling to show the next element
        //     - Or you care, so to work around this, you can "guess" the next
        //       element's id, since it remains consistent
        // Here are the two ways:

        // First way
        target.nextElementSibling.className = '';

        // Second way
        // Strip off the number of the id (starting at index 3)
        var nextElementId = 'div' + target.id.substr( 3 );
        document.getElementById( nextElementId ).className = '';
    }
}; 
```

当然，CSS：

```
.hidden {
    display: none;
} 
```

我强烈建议您阅读 javascript 代码中的注释。

如果你仔细阅读，你会发现在现代浏览器中，JS 代码只有 5 行。不再。要支持旧版浏览器，它需要 7 行代码。

# android - Android 在 NFC 标签上多次启动活动

> ID：10687482
> 
> 赞同：3
> 
> 时间：2012-05-21T14:46:13.320
> 
> 标签：android, android-intent, nfc

我的 Android 应用程序有 2 个活动，一个主要用于获取信息，一个用于接收 NFC。

首次启动该应用程序时，我可以多次读取 NFC 标签 - 每次都会启动一个新活动并显示一些信息。

如果应用程序关闭但手机被带到 NFC 标签 - 它会第一次显示 NFC 标签活动，但不再响应任何其他标签。

我究竟做错了什么？！

第二个活动的清单部分和代码：

```
<uses-sdk android:minSdkVersion="10" />
<uses-permission android:name="android.permission.NFC" />
<uses-feature android:name="android.hardware.nfc" android:required="true" />

<application
android:icon="@drawable/aaa"
android:label="@string/app_name" 
    android:theme="@android:style/Theme.NoTitleBar">

<activity
    android:label="@string/app_name"
    android:name=".MainActivity">
    <intent-filter >
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity>

<activity 
    android:name=".TagDiscoveredActivity"
    android:screenOrientation="portrait">
    <intent-filter >
        <action android:name="android.nfc.action.TECH_DISCOVERED" />
        <action android:name="android.nfc.action.TAG_DISCOVERED" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
    <meta-data
        android:name="android.nfc.action.TECH_DISCOVERED"
        android:resource="@xml/filter_nfc" />
</activity>
</application>

</manifest> 
```

编码

```
public class TagDiscoveredActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.info);
        etc
    }

@Override
public void onNewIntent(Intent intent) {
    setIntent(intent);
    resolveIntent(intent);
}

private void resolveIntent(Intent intent) {
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            //| Intent.FLAG_ACTIVITY_SINGLE_TOP);        

    boolean handled = false;

    // Parse the intent
    final String action = intent.getAction();
    if (NfcAdapter.ACTION_TECH_DISCOVERED.equals(action) ||
                NfcAdapter.ACTION_TAG_DISCOVERED.equals(action)) {

        // When a tag is discovered we send it to the service to be save. We
        // include a PendingIntent for the service to call back onto. This
        // will cause this activity to be restarted with onNewIntent(). At
        // that time we read it from the database and view it.
        Parcelable nfctag = intent.getParcelableExtra(NfcAdapter.EXTRA_TAG);
        if (nfctag != null) {
                        //read tag and display here
                    }
                }
            }

    if (!handled) {
        Log.e(logTag, "Unknown intent " + intent);
        finish();
        return;
    }
} 
```

当我运行它并记录第二个场景时 - 直接从 NFC 启动而不运行应用程序 - 日志显示它第一次工作，但第二次，没有任何功能记录任何内容。

感谢您提供任何有用的建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-28T11:48:54.420

在尝试了一切之后，我终于找到了答案。

答案是将活动设置为 android:launchmode="singleTask"，并在 onNewIntent 的代码中添加以下行：

```
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T10:22:56.460

您可能正在寻找的是[本示例](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/nfc/ForegroundDispatch.html)中的前台调度。我还编写了一个您可能会觉得有趣的 Android[样板](http://code.google.com/p/nfc-eclipse-plugin/downloads/list)文件（无耻插件）。

# php - RedBean ORM 是否能够创建唯一键？

> ID：10687484
> 
> 赞同：5
> 
> 时间：2012-05-21T14:46:16.257
> 
> 标签：php, sqlite, redbean

我希望 RedBean 在生成模式时创建唯一键/索引。以下代码确实-与我对文档的理解相反-不要这样做：

R::setup('sqlite:rss_loader.db3');

```
$bean = R::findOne(IMG);
if (!$bean->id) {
    $bean = R::dispense(IMG);
    $bean->setMeta("buildcommand.unique.0", array('url'));
    $bean->url      = 'text';
    R::store($bean);
    $bean->wipe();

    R::freeze(); //no more schema changes!
} 
```

sqlite 中发生的事情是这样的：

```
create table img (id integer primary key autoincrement, url) 
```

我所期待的是：

```
create table img (id integer primary key autoincrement, url text unique) 
```

这可以在不针对 RedBean 编写 SQL 的情况下实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:24:02.693

你用的是什么版本的红豆？看起来他们更新`buildcommand`了最新版本。手册是这样说的：

```
$bean->setMeta("buildcommand.unique" , array(array($property1, $property2))); 
```

插入你所拥有的：

```
$bean->setMeta("buildcommand.unique" , array(array('url'))); 
```

如果这不起作用，您可能必须阅读`setMeta`函数下的实际代码，看看实际发生了什么。

要在现有表上执行此操作，只需像这样“存储”一个空 bean 就足够了——不需要将数据添加到数据库中：

```
$bean = R::dispense(IMG);
$bean->setMeta("buildcommand.unique", array(array(...)));
R::store($bean); 
```

（警告，如果你这样做后冻结，你不能保证拥有所有的列）

# php - PHP 类和错误消息

> ID：10687492
> 
> 赞同：0
> 
> 时间：2012-05-21T14:46:42.160
> 
> 标签：php, oop, error-handling

我对 OOP 和课程很陌生。我正在努力解决的一件事是，如果类的方法中有错误，则不会显示错误消息，页面就会中断。有谁知道这是为什么或者我怎样才能让它显示错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:48:34.427

[http://us.php.net/manual/en/function.error-reporting.php](http://us.php.net/manual/en/function.error-reporting.php)

将其放在包含您的班级的页面顶部。

```
<?php
error_reporting(E_ALL);
?> 
```

# php - Opencart 1.5.2 Show Category's In One Drop Down

> ID：10687496
> 
> 赞同：0
> 
> 时间：2012-05-21T14:46:57.860
> 
> 标签：php, jquery, css, drop-down-menu, opencart

I want to show all the category's in one drop down. Currently it shows each category in as its own drop down, I want one master drop down link then all the category's listed in that drop down and all there children.

categories - cat 1 - cat 2 - cat 3 --- cat 3 child 1 - cat 4 - cat 3 child 2 - cat 5 - cat 3 child 3 - cat 6 - cat 7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:44:37.450

这主要是关于 HTML+CSS 和 JS - 只需将当前类别 HTML 标记包含在一个新的 UL 中 - 所以从

```
<ul>
    <li>Cat 1</li>
    <li>Cat 2
        <ul>
            <li>Cat 2 child 1</li>
        </ul>
<ul> 
```

你会得到

```
<ul>
    <li>Categories
        <ul>
            <li>Cat 1</li>
            <li>Cat 2
                <ul>
                    <li>Cat 2 child 1</li>
                </ul>
            </li>
        <ul>
    </li>
</ul> 
```

现在只需对 JS 和 CSS 进行一些修改就足够了。当然，这些类别是由 PHP 编写的，因此只需将当前标记封装到一个新的 UL-LI 中。

我不能给你整个代码示例和 JS 脚本，因为我花钱实施和编程 OpenCart eshop 解决方案:-)。

# image - updating HorizontalList icon in flex 3

> ID：10687498
> 
> 赞同：0
> 
> 时间：2012-05-21T14:47:05.297
> 
> 标签：image, actionscript-3, apache-flex, flex3, horizontallist

i have a HorizontalList filled with a dataProvider (ArrayCollection) like :

```
[Bindable]
[Embed(source="assets/empty.jpg")]
public var empty:Class;

private function init(nbr){
    var myArray : ArrayCollection = new ArrayCollection;

    for( var i=0 ; i<nbr ; i++){
        myArray.addItem({label:"Page" + i , icon:"empty"});
    }
    myHorizontalList.dataProvider = myArray;
} 
```

for some reason i have to do the following, when an item is clicked the icon image of this very item must change to some other image.

can anybody help me please. i'm new to flex thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:05:16.433

您应该使用列表中的更改事件。那应该调用一种方法来更改所选图像。像这样的东西：

```
<mx:List id="imageList" dataProvider="{dataList}" change="{onChange(event)}" />

public function onChange(event:Event):void
{
    image.source = imageList.selectedItem.url; 
} 
```

如果您需要任何进一步的解释，请告诉我。

# c# - Debug file used by another process

> ID：10687500
> 
> 赞同：1
> 
> 时间：2012-05-21T14:47:28.987
> 
> 标签：c#, debugging

Using Visual Studio 2010 and im getting "File is used by another process" almost randomly when trying to read a file. Im reading about 10 xml files into memory with the same procedure

The code that breaks is

```
private static TextReader CreateTextReader(IsolatedStorageFile isolatedStorageFolder, string path)
        {
            TextReader textReader = null;

            if (isolatedStorageFolder == null)
                textReader = new StreamReader(path);
            else
                textReader = new StreamReader(new IsolatedStorageFileStream(path, FileMode.Open, isolatedStorageFolder));

            return textReader;
        } 
```

The code breaks 10 percent of the time on

```
 textReader = new StreamReader(path); 
```

I personally think its some kind of garbage collection problem, anyone has any tips on how to debug this kind of problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:49:23.377

请务必在所有可能锁定文件的 Steam 阅读器操作上调用 .Dispose 或 .Close。这可能是您的问题，因为该代码对我来说是一个平面程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:49:56.063

您需要处理`TextReader`. 使用如下`using`语句

```
using (TextReader r = CreateTextReader(...))
{
} 
```

否则，当您关闭应用程序时，文件将保持打开状态。

**编辑**
您在对您实际上已经在使用的问题的评论中说`using`-您尝试读取的文件是否实际上是由另一个应用程序打开的？有时防病毒解决方案会在扫描文件或类似的东西时锁定文件 - 它会在片刻后工作还是你必须重新启动或类似的东西？

# grid - 3d网格适应gnuplot中的非矩形数据

> ID：10687502
> 
> 赞同：1
> 
> 时间：2012-05-21T14:47:36.160
> 
> 标签：grid, plot, gnuplot, envelope

我想在 3d 图中绘制点并创建一个可以处理非矩形数据的网格。更具体地说，我的数据是

### 数据.dat

```
-1 0 0
-1 1 0
0 -1 0
0 0 0
0 1 0
1 -1 0
1 0 0 
```

和我的 gnuplot 文件

### 绘图.plt

```
set dgrid3d 3,3
splot 'data.dat' w l
pause -1 
```

不幸`dgrid3d`的是，我的数据似乎变成了矩形，并且绘制了一个矩形网格（实际上是一个方形网格）。有没有办法绘制我的数据的受限信封？理想情况下，我想绘制我的一组点的[正交凸包](http://en.wikipedia.org/wiki/Orthogonal_convex_hull)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:47:16.050

你有几个选择来做这样的事情——不幸的是，它们都需要你做一些工作。

首先，重要的是要注意**gnuplot 可以处理用于表面绘图的非矩形网格**（即使在此示例中您只需要一个矩形表面）。对于曲面绘图，数据文件看起来像（注意空白记录）：

```
x11 y11 z11
x21 y21 z21
x31 y31 z31
...

x12 y12 z12
x22 y22 z22
x23 y23 z23
... 
```

然后它形成四边形。在这种情况下，第一个四边形将由点 (x11,y11),(x21,y21),(x12,y12),(x22,y22) 形成。第二个四边形将由 (x21,y21),(x31,y31),(x22,y22),(x23,y23) 等组成。因此，给定您的一组点，您可以轻松创建一个“矩形网格”来保存所有数据点。它不会均匀分布，但这完全没有问题。现在我们需要弄清楚如何删除点，以便 gnuplot 不会绘制它们。这就是“诀​​窍”。`set datafile missing "string"`您可以在数据文件 ( )中将特定字符串标记为“缺失数据” 。在这种情况下，gnuplot 不会绘制该点，但它仍会跟踪丢失数据的坐标以生成表面。

因此，在一天结束时，您的数据文件将如下所示：

```
x11 y11 ?
x21 y21 ?
x31 y31 z31
...

x12 y12 ?
x22 y22 z22
x23 y23 z23
... 
```

绘制它的脚本是：

```
set datafile missing '?'
set surf
set view map #Not sure about this...depends on the view you want
splot "mydata.dat" u 1:2:3 w lines 
```

如果你想让 gnuplot 计算“正交凸包”，我认为你在那里不走运。

**简单的方法**

另请注意，如果您想要二维空间中的纯色对象（如您发布的维基百科链接上的图片），则此问题变得容易得多。如果您可以仅使用要绘制的对象的顶点创建一个数据文件（以便 (x1,y1) 连接到 (x2,y2) 连接到 (x3,y3)...），那么您可以绘制该数据文件为：

```
set fillstyle #However you want the object to appear
plot "datafile.dat" u 1:2 with filledcurves closed 
```

# format - UUID 格式：8-4-4-4-12 - 为什么？

> ID：10687505
> 
> 赞同：96
> 
> 时间：2012-05-21T14:47:37.300
> 
> 标签：format, guid, uuid

为什么 UUID 以“8-4-4-4-12”（数字）格式显示？我已经四处寻找原因，但找不到需要它的决定。

格式化为十六进制字符串的 UUID 示例：58D5E212-165B-4CA0-909B-C86B9CEE0111

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-05-21T14:57:33.887

它由 分隔`time, version, clock_seq_hi, clock_seq_lo, node`，如下面的 rfc 所示。

来自[IETF RFC4122：](http://www.ietf.org/rfc/rfc4122.txt)

```
4.1.2\.  Layout and Byte Order

   To minimize confusion about bit assignments within octets, the UUID
   record definition is defined only in terms of fields that are
   integral numbers of octets.  The fields are presented with the most
   significant one first.

   Field                  Data Type     Octet  Note
                                        #

   time_low               unsigned 32   0-3    The low field of the
                          bit integer          timestamp

   time_mid               unsigned 16   4-5    The middle field of the
                          bit integer          timestamp

   time_hi_and_version    unsigned 16   6-7    The high field of the
                          bit integer          timestamp multiplexed
                                               with the version number  

   clock_seq_hi_and_rese  unsigned 8    8      The high field of the
   rved                   bit integer          clock sequence
                                               multiplexed with the
                                               variant

   clock_seq_low          unsigned 8    9      The low field of the
                          bit integer          clock sequence

   node                   unsigned 48   10-15  The spatially unique
                          bit integer          node identifier

   In the absence of explicit application or presentation protocol
   specification to the contrary, a UUID is encoded as a 128-bit object,
   as follows:

   The fields are encoded as 16 octets, with the sizes and order of the
   fields defined above, and with each field encoded with the Most
   Significant Byte first (known as network byte order).  Note that the
   field names, particularly for multiplexed fields, follow historical
   practice.

   0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          time_low                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       time_mid                |         time_hi_and_version   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |clk_seq_hi_res |  clk_seq_low  |         node (0-1)            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         node (2-5)                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-30T17:21:21.047

格式在[IETF RFC4122](http://www.ietf.org/rfc/rfc4122.txt)第 3 节中定义。输出格式定义为“UUID = ...”

> 3.- 命名空间注册模板
> 
> Namespace ID：UUID 注册信息：注册日期：2003-10-01
> 
> 命名空间的声明注册人：JTC 1/SC6（ASN.1 报告人组）
> 
> 句法结构声明：UUID 是一个标识符，它在空间和时间上都是唯一的，相对于所有 UUID 的空间。由于 UUID 是固定大小并包含时间字段，因此值可能会翻转（大约 AD 3400，取决于所使用的特定算法）。UUID 可用于多种用途，从标记生命周期极短的对象到可靠地识别网络中非常持久的对象。
> 
> ```
>  The internal representation of a UUID is a specific sequence of
>   bits in memory, as described in Section 4\.  To accurately
>   represent a UUID as a URN, it is necessary to convert the bit
>   sequence to a string representation.
> 
>   Each field is treated as an integer and has its value printed as a
>   zero-filled hexadecimal digit string with the most significant
>   digit first.  The hexadecimal values "a" through "f" are output as
>   lower case characters and are case insensitive on input.
> 
>   The formal definition of the UUID string representation is
>   provided by the following ABNF [7]:
> 
>   UUID                   = time-low "-" time-mid "-"
>                            time-high-and-version "-"
>                            clock-seq-and-reserved
>                            clock-seq-low "-" node
>   time-low               = 4hexOctet
>   time-mid               = 2hexOctet
>   time-high-and-version  = 2hexOctet
>   clock-seq-and-reserved = hexOctet
>   clock-seq-low          = hexOctet
>   node                   = 6hexOctet
>   hexOctet               = hexDigit hexDigit
>   hexDigit =
>         "0" / "1" / "2" / "3" / "4" / "5" / "6" / "7" / "8" / "9" /
>         "a" / "b" / "c" / "d" / "e" / "f" /
>         "A" / "B" / "C" / "D" / "E" / "F" 
> ```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-05-11T23:31:40.873

# 128 位

“8-4-4-4-12”格式仅供人类阅读。[UUID](https://en.wikipedia.org/wiki/Universally_unique_identifier)实际上是一个[128 位的](https://en.wikipedia.org/wiki/128-bit)数字。

考虑到字符串格式在存储或在内存中时需要的字节数是 128 位数的两倍。我建议在内部使用该数字，当需要在 UI 上显示或在文件中导出时，使用字符串格式。

# spring - 无法加载 spring 3 模式

> ID：10687511
> 
> 赞同：2
> 
> 时间：2012-05-21T14:47:58.467
> 
> 标签：spring, applicationcontext

我正在使用**Spring 3.0.5.RELEASE** ，今天在使用 maven 构建项目时，我在**appicationContext.xml**文件中遇到以下错误：

```
 - cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 
     'context:component-scan'.
 - cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'context:annotation-
 config'.
 - cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'tx:annotation-
     driven'. 
```

我试图打开架构链接：

*   [Spring XML Beans 模式](http://www.springframework.org/schema/beans/spring-beans-3.0.xsd)
*   [Spring Framework 的声明式事务管理基础架构](http://www.springframework.org/schema/tx/spring-tx-3.0.xsd)
*   [Spring Framework 的应用程序上下文支持](http://www.springframework.org/schema/context/spring-context-3.0.xsd)

但我总是得到禁止的页面！

这是我配置**applicationContext.xml**的方式：

```
<?xml version="1.0" encoding="UTF-8"?> 
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx" 
    xmlns:p="http://www.springframework.org/schema/p"
    xsi:schemaLocation="
           http://www.springframework.org/schema/beans     
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/tx 
           http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
           http://www.springframework.org/schema/context 
           http://www.springframework.org/schema/context/spring-context-3.0.xsd"> 
```

请告知如何解决此错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T15:34:55.463

似乎公共模式不再可用，所以我从类路径上的 jar 中加载模式，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?> 
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx" 
    xmlns:p="http://www.springframework.org/schema/p"
    xsi:schemaLocation="  
           http://www.springframework.org/schema/beans 
           classpath:/org/springframework/beans/factory/xml/spring-beans-3.0.xsd
           http://www.springframework.org/schema/tx
           classpath:/org/springframework/transaction/config/spring-tx-3.0.xsd
           http://www.springframework.org/schema/context  
           classpath:/org/springframework/context/config/spring-context-3.0.xsd"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T14:51:33.257

似乎您遇到了这个问题：[Web 上不再提供 Spring Beans Schema？](https://stackoverflow.com/questions/10681864)您是否`schemaLocation`明确定义？

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/context/spring-context-3.0.xsd
                        "> 
```

# google-analytics - 将 _trackEvent 传递给多个分析跟踪代码

> ID：10687514
> 
> 赞同：0
> 
> 时间：2012-05-21T14:48:03.103
> 
> 标签：google-analytics, accounts, event-tracking

我在一个域中设置了多个 Google Analytic 帐户。该站点具有在第一个配置文件中正确跟踪的不同事件。但是……我希望将事件传递给每个帐户，而无需为每个配置文件创建 onclick 事件。

```
<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(
    ['_setAccount', 'UA-xxxxxxx30-1'], ['_trackPageview'],  ['_gat._anonymizeIp'],
    ['b._setAccount', 'UA-xxxxxxx33-1'], ['_trackPageview'], ['_gat._anonymizeIp'],
    ['c._setAccount', 'UA-xxxxxxx76-1'], ['_trackPageview'], ['_gat._anonymizeIp']
);

(function () {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

感谢您的支持迈克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:00:44.980

首先，您粘贴的代码片段不正确。每个跟踪器之后的 _trackPageview 调用将只为第一个跟踪器对象触发 _trackPageview。此外，您的 _anonymizeIp 设置被错误地使用，因为它需要在第一个 _trackPageview 之前出现，并且它适用于所有跟踪器对象。

更正的语法：

```
_gaq.push(
    ['_setAccount', 'UA-xxxxxxx30-1'], ['_gat._anonymizeIp'], ['_trackPageview'],
    ['b._setAccount', 'UA-xxxxxxx33-1'], ['b._trackPageview'],
    ['c._setAccount', 'UA-xxxxxxx76-1'], ['c._trackPageview']
); 
```

对于事件跟踪，您可以创建一个函数，在一个函数调用中对所有跟踪器进行事件跟踪调用。就像是：

```
function gaTrackEventAllTrackers(category,action,optLabel,optValue,optInteraction) {
    _gaq.push(
        ['_trackEvent',category,action,optLabel,optValue,optInteraction],
        ['b._trackEvent',category,action,optLabel,optValue,optInteraction],
        ['c._trackEvent',category,action,optLabel,optValue,optInteraction]
    );
} 
```

然后只需在您的代码或 onclick 中调用此函数。

# svn - 来自svn的Mercurial pull内存不足

> ID：10687517
> 
> 赞同：0
> 
> 时间：2012-05-21T14:48:07.690
> 
> 标签：svn, mercurial

我一直在运行 mercurial 来与我们的 subversion 存储库交互，今天，当拉取一个大的变更集 ( `hg pull --rebase`) 时，我得到一个内存不足的错误。

变更集相当大：大约 570 万行，一个 csv 文件中除了 10 行（280 万插入，2.8 删除），我仍然想坚持使用 mercurial，而不必降级回 svn。

有没有办法可以增加 Mercurial 可以使用的内存量，或者其他方式来拉取提交？

我正在运行 Mercurial 2.0.1 版，它与稍旧的 TortoiseHg 版本捆绑在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:20:22.677

原则上，Mercurial 使用尽可能多的内存，因此听起来您的机器没有足够的内存来保存 SVN-Mercurial 转换所需的所有数据结构。

我建议您尝试的是，将您的 repo 复制到 USB 记忆棒上，然后在具有更多内存的机器上从 SVN 中提取。然后将存储库复制（或拉取）回您的计算机。

# php - 有没有办法通过将 php 保存到数据库来清理 HTML 代码？

> ID：10687521
> 
> 赞同：11
> 
> 时间：2012-05-21T14:48:20.543
> 
> 标签：php, mysql, html, xss

> **可能重复：**
> [使用 PHP 清理用户输入的最佳方法是什么？](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)

我正在使用**TinyMCE**来允许用户编辑网页的一小部分。

该字段被保存到数据库中。

是否有一个正则表达式可以用来清理传入的 HTML 代码，从而避免任何**XSS/NULL/DROP** TABLES 类型的攻击？

我已经在单行输入文本/数字等上完成了此操作，但不确定在接收 HTML 字符串时如何处理。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T14:51:49.633

我建议玩[HTMLPurifier](http://htmlpurifier.org/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T14:50:07.127

您可以使用 PHP 函数：`striptags`和`htmlspecialchars`：

[http://php.net/manual/en/function.strip-tags.php](http://php.net/manual/en/function.strip-tags.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T15:57:56.113

你可以使用这个 -

```
 function safe_sql($obj)
{
    $obj = htmlspecialchars($obj);
    $obj = str_replace('"',"&quot;",$obj);
    $obj = str_replace("'","&#39;",$obj);
    $obj = str_replace("`","&#96;",$obj);
    $obj = mysql_real_escape_string($obj);
    return $obj;
} 
```

我正在使用它，它工作正常。并且您也可以使用此功能使其正常（从数据库中提取数据后）-

```
 function to_Normal($data)
{
    $data = htmlspecialchars_decode($data);

    $data = str_replace("&quot;",'"',$data);
    $data = str_replace("&#39;","'",$data);
    $data = str_replace("&#96;","`",$data);
    $data = nl2br($data);
    return $data;
} 
```

# javascript - 如何实现 JavaScript 对象继承？

> ID：10687527
> 
> 赞同：2
> 
> 时间：2012-05-21T14:48:41.373
> 
> 标签：javascript, jquery

我想基于现有的 JavaScript 对象创建一个新的 JavaScript 对象。
到现在为止，我的研究使我想到了 jQuery 扩展功能。

例子：

```
var object1 = {
    name:'same name',
    age:'1',
    occupation:'programmer'
}
var object2 = {
    name:'same new name'
} 
```

现在，当我打电话时：

```
$.extend({},object1,object2); 
```

它工作得很好，我的问题是当我在对象中有对象成员时！

```
var object1 = {
    name:'same name',
    age:19,
    occupation:'programmer',
    parent:{
        name:'parent name',
        age:35
    }
}
var object2 = {
    name:'same new name',
    parent:{
        age:40
    }
} 
```

现在，当我打电话时

```
$.extend({},object1,object2); 
```

object1.parent 是：

```
{
    age:40
} 
```

我希望它是：

```
{
    name:'same new name',
    age:40
} 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T14:49:58.080

为 jQuer.extend() 方法使用**deep**参数，您的代码应为：

```
$.extend(true,{},object1,object2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:51:01.510

你要做的是执行一个深度扩展

```
$.extend(true, {},object1,object2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:53:01.693

您可以像这样强制`$.extend`执行深层复制：

```
$.extend(true, {},object1,object2); 
```

虽然`$.extend`没有创建继承层次结构，但它只是复制属性。

# image - 如何在 JS 上预加载图片

> ID：10687528
> 
> 赞同：1
> 
> 时间：2012-05-21T14:48:42.463
> 
> 标签：image, preload

如何制作像 Tumblr 中的预加载器图像。示例 - [http://micp.ru/kl4hb](http://micp.ru/kl4hb)

谢谢。

# hibernate - @OneToOne 与 @JoinColumn 的双向映射

> ID：10687529
> 
> 赞同：4
> 
> 时间：2012-05-21T14:48:45.880
> 
> 标签：hibernate, primary-key, one-to-one

假设我有人

```
class Person{
    @Id Integer id;

    @OneToOne
    @JoinColumn(name = "person_id")
    Job myJob;
} 
```

和工作

```
class Job{
    @Id Integer id;
    Integer person_id;

    @OneToOne
    @PrimaryKeyJoinColumn(name = "person_id")
    Person currentWorker;
} 
```

获取时，我无法将 Person 和 Job 映射到其他实体。
我在做什么错？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T15:06:24.560

您的代码应该是：

```
@Entity
public class Person implements Serializable {

    @Id Integer id;

    @OneToOne
    @JoinColumn(name = "id")
    Job myJob;
}

@Entity
public class Job implements Serializable {

    @Id Integer id;

    @OneToOne(mappedBy = "myJob")
    Person currentWorker;
} 
```

（尝试从 Job 中删除重复的列“person_id”）

或其他共享主键的方法：

```
@Entity
public class Person {
    @Id Integer id;

    @OneToOne(cascade = CascadeType.ALL)
    @PrimaryKeyJoinColumn
    Job myJob;
}            

@Entity
public class Job {
    @Id Integer id;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-02T23:01:53.683

本讨论假设在 persistence.xml 中为 hibernate.hbm2ddl.auto 分配了诸如“update”之类的属性，以使 Hibernate 能够建立一对一关系并在拥有实体中为非拥有实体创建外键，以及对应表中的外键标识列。但是，只有在创建表时建立了关系，此过程才会成功。将@JoinColumn 和@OneToOne(mappedBy) 添加到现有实体将导致Hibernate 抱怨FK 列在拥有表中不存在。所以在实现包含实时数据的表之间的关系时，需要手动添加FK列。然后，Hibernate 将能够使用像 FKg6wt3d1u6o13gdc1hj36ad1ot 这样的奇怪名称来建立 FK 约束。

所涉及的细微差别通过一个稍微更详细的示例来说明。考虑一个数据库，其中实体联系人将是连接 OneToOne 的各种表（员工、客户、供应商等）的公共组件。作为初步考虑，虽然 OneToOne 关系可能是双向的，但它在 Hibernate 中的实现要求为公共实体分配非拥有名称，以便在每个拥有实体的表中创建 FK。反过来实现 OneToOne 将导致 Hibernate 在 NON-owning 类中查找外键，并在找不到时抛出错误。（去过也做过。）

```
@Entity // common, non-owning entity
public class Contact implements Serializable {

private static final long serialVersionUID = 1L;

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name = "id", updatable = false, nullable = false)

private Integer id;

    @Column(name="fn")
    private String firstName;

    @Column(name="ln")
    private String lastName;

// "person" is the Contact entity as declared in Director
  @OneToOne(optional=false, mappedBy = "person")    
  private Director director;

 // GETTERS & SETTERS 
```

和

```
@Entity // owning entity
public class Director implements Serializable {

private static final long serialVersionUID = 1L;

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name = "id", updatable = false, nullable = false)

private Integer id;

    @Column(name="title")
    private String title;

@OneToOne
    @JoinColumn
    private Contact person;

public Integer getId() {
        return id;
}   
public String getTitle() {
        return title;
}
public void setTitle(String title) {
        this.title = title;
}
public Contact getPerson() {
        return person;
}
public void setPerson(Contact person) {
        this.person = person;
} 
```

假设 Director 中存在 FK 列，代码生成：

```
alter table Director 
   add constraint FKg6wt3d1u6o13gdc1hj36ad1ot 
   foreign key (person_id) 
   references Contact (id) 
```

Hibernate 分配给 Director 中的 Contact 实体的 FK 名称的派生有点模糊。它是分配给拥有实体（此处为人员）中的联系人实例变量的变量名 +“_”+ 实体的主键“id”的串联，从而产生 person_id。另请注意，@OneToOne(mappedBy = "person") 注释引用了相同的 Contact 实例变量。最后，Hibernate 直接访问 FK 列，而不需要 Director 类中对应的 getter 和 setter。

# jquery - jQuery插件；无法正常工作

> ID：10687530
> 
> 赞同：1
> 
> 时间：2012-05-21T14:48:46.250
> 
> 标签：jquery, plugins, default, options

如何让这个插件代码接受默认选项？

```
// Utility
if ( typeof Object.create !== 'function' ) {
object.create = function( obj ) {
    function F(){};
    F.prototype = obj;
    return new F();
};
}

(function( $, window, document, undefined ) {
var Super = {
    init: function( options, elem ) {
        var self = this;

        self.elem = elem;
        self.$elem = $( elem );

        //self.alertbox( options.alertmsg );    
        self.loadingBar( options.duration );

        if ( typeof options === 'string' ) {
            self.search = options;
        } else {
            // object was passed
            self.search = options.search;
        }

        self.options = $.extend({}, $.fn.superHero.options, options );

    },

    alertbox: function( message ) {
        var self = this;

        alert(message);

    },

    loadingBar: function( duration ) {
        var self = this;

        $('#loadingBar').animate({
            width:  699             
        }, duration);

    },

};

$.fn.superHero = function( options ){
    return this.each(function() {

        var hero = Object.create( Super );
        hero.init( options, this );

        $.data( this, 'superHero', hero);

    });

};

$.fn.superHero.options = {
    alertmsg:   'Hello World!',
    duration:   8000,
};

})( jQuery, window, document ); 
```

仅当我在调用插件时在索引页面中定义它们时，这些选项才有效。

如何使选项具有由用户覆盖而不是用户要求的默认值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:13:57.070

原来我需要打电话；

```
self.loadingBar( self.options.duration ); 
```

与

```
self.loadingBar( options.duration ); 
```

不知道有什么区别；我只知道它有效。

# actionscript-3 - 粒子阵列和盒子之间的碰撞

> ID：10687532
> 
> 赞同：0
> 
> 时间：2012-05-21T14:48:53.957
> 
> 标签：actionscript-3, flash, collision, particles

我正在做一个学校项目，我需要在一组粒子和一个盒子之间进行碰撞，这是我当前的代码：

```
for(var i : int = 0; i < particles.length; i++)
{
    particles[i].update();

    if(Particle.hitTestPoint(Square))
    {
        particle = particles.shift();
        particle.destroy();
    }
} 
```

我收到一条错误消息，告诉我我试图通过静态类型类的引用来调用未定义的方法（命中点）。

任何帮助将不胜感激，谢谢！

这是粒子的代码。

```
package 
```

{ 导入 flash.display.*;

```
public class Particle
{
    public var clip : DisplayObject;

    public var xVel : Number = 0;
    public var yVel : Number = 0;

    public var drag : Number = 1;

    public var gravity : Number = 0.0;
    public var shrink : Number = 1;
    public var fade : Number = 0;
    public function Particle(symbolclass : Class, target : DisplayObjectContainer, xpos : Number, ypos : Number)
    {
        clip = new symbolclass();

        target.addChild(clip);

        clip.x= xpos;
        clip.y= ypos;

    }       
    public function update() : void
    {
        clip.x += xVel;
        clip.y += yVel;

        xVel *= drag;
        yVel *= drag;

        yVel+=gravity;

        clip.scaleX *= shrink;
        clip.scaleY *= shrink;

        clip.alpha -= fade;
    }
    public function destroy() :void
    {
        clip.parent.removeChild(clip);
    }

} 
```

}

我将[本教程](http://www.computerarts.co.uk/tutorials/cool-particle-effects-flash)用于粒子，我的目标是为它们添加碰撞

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:16:00.423

**编辑：**现在更新了我的答案，`Particle`代码已经发布。

你的`Particle`班级没有定义`hitTestPoint`. 除此之外，您正在调用一个我认为您不需要的静态方法......您需要一个实例方法。

确保你`hitTestPoint`在你的`Particle`类中定义。然后，不是 ，而是`Particle.hitTestPoint`try `particle.hitTestPoint`(注意大写，它指的是类被更改为小写，它指的是实例。

尝试这个：

```
for(var i : int = 0; i < particles.length; i++)
{
    var particle:Particle = particles[i];
    particles.update();

    if(particle.hitTestPoint(Square))
    {
        particle = particles.shift();
        particle.destroy();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:11:49.370

我不确定`particle`该代码中指的是什么，因为它没有在您发布的内容中定义，而是`particles[i]`您要测试的粒子。

您的`Particle`课程没有`hitTestPoint`功能 - 但它包含一个`DisplayObject`功能。因此，考虑到这两件事，您可以使用`particles[i].clip.hitTestPoint`.

下一个问题：您试图将*类* `Square`传递给 hitTest 而不是实例。而且，它仍然`hitTestPoint`以单个点为参数，而不是像正方形所代表的对象。所以你可能想`hitTestObject`改用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T17:04:49.193

Particle 类必须扩展 MovieClip 以具有 hitTestPoint 方法。尝试将课程更改为：

```
import flash.display.MovieClip;
public class Particle extends MovieClip
{
    //code here 
```

并在您的代码中导入特定类（请参阅 MovieClip 类，因为这是您正在使用的类及其方法）以获得更好的结果作为良好实践。

# android - 如何在 BroadcastReceiver 中更改屏幕的亮度？

> ID：10687535
> 
> 赞同：4
> 
> 时间：2012-05-21T14:49:00.023
> 
> 标签：android, screen-brightness

我想改变亮度，我可以使用这个方法：

```
public static void SetBright(int brightness, Context context) {
    if (isAutoBrightness(context)) {
        stopAutoBrightness(context);
    }
    WindowManager.LayoutParams lp = ((Activity) context).getWindow()
            .getAttributes();
    lp.screenBrightness = Float.valueOf(brightness) * (1f / 255f);
    ((Activity) context).getWindow().setAttributes(lp);
} 
```

我需要一个 Activity 来传递`SetBright(int brightness, Context context);`

但现在我必须`SetBright(int brightness, Context context)`在 Brocastreceiver 中调用该方法。我可以在 onReceive(Context context, Intent intent) 方法中使用上下文，但如果我退出应用程序，它就不起作用。

是否有另一种方法可以用来改变亮度而不是使用活动？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T08:54:39.747

启动虚拟活动并使用亮度设置窗口参数（0 到 1 范围 - 1 为 255）。运行 50、100 或 500 毫秒的计时器。之后完成活动。

```
TimerTask finishTask = new TimerTask() {

        @Override
        public void run() {
            BrightActivity.this.finish();
            timer.cancel();
            if (timer != null) {
                timer = null;
            }
        }
    };
    timer.schedule(finishTask,Constants.BRIGHTNESS_REFRESH_DELAY); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T10:45:11.767

我主要使用 500 毫秒的屏幕刷新时间，但在 Galaxy s3 中它不起作用。但是1000是可以的。所以屏幕刷新时间可能取决于设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:51:39.807

如果要保存，请在设置亮度后尝试此操作：

```
public static void saveBrightness(Context context, int brightness) {
   ContentResolver resolver= context.getContentResolver();
    Uri uri = android.provider.Settings.System
            .getUriFor("screen_brightness");
    android.provider.Settings.System.putInt(resolver, "screen_brightness",
            brightness);
    resolver.notifyChange(uri, null);
} 
```

# foreign-keys - Dynamics AX 2012：将 RecId 转换为值

> ID：10687537
> 
> 赞同：1
> 
> 时间：2012-05-21T14:49:08.000
> 
> 标签：foreign-keys, x++, axapta

我之前问过一个与此类似的问题（[如何在表单中使用 RecId 作为外键](https://stackoverflow.com/questions/10281031/how-to-use-recid-as-a-foreign-key-in-a-form)），但想在更复杂的场景中进一步探索它。

当您设置了索引并将允许重复设置为 no 时，替换键效果很好，但它们似乎根本不适用于多字段索引或允许重复设置为 yes。

有没有办法以编程方式在不使用替换键的情况下用翻译值替换网格中的外键？我尝试编写一个显示方法来覆盖该字段，但是导致了一些奇怪的行为——字段在网格中移动，并且显示方法不知道要使用哪一行，因此整个列中的所有值都是相同的。

表 A: Bob:1, Sally:1, Sue:3 表 B: 1:Apples, 2:Apples, 3:Oranges “人”通过食物 RecId 与他们最喜欢的“食物”联系在一起，在 People 表中引用. 假设其他列中存在使这些记录唯一的附加数据，因此合并“1:Apples”和“2:Apples”是不可能的。

似乎应该有一种方法可以编写一个显示方法来覆盖网格中的字段值。有什么建议么？示例代码？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T19:36:05.360

首先，代理 FK 替换确实（或至少应该）使用复合键（例如，{First Name, Last Name}）。

其次，您说“其他列中的附加数据”使这些记录独一无二……那么为什么不将这些列与食物名称结合起来形成备用键？数据模型似乎不正确（或者至少某些元数据与您所说的条件不一致）

第三，可以选择任何字段组作为参考组控件上的 ReplacementFieldGroup。仅此一项就可以让您基本上做任何您想做的事情。也就是说，由于代理 FK 替换的语义，我强烈建议您尽可能使用备用键作为替换字段组。

流动：

1) 用户在参考组中键入一个值。

2）用户的标签。

3) 用户键入的值用于在相关表中查找记录。

4a) 如果用户输入的值被唯一地映射到选择该记录的记录，否则，

4b) 如果用户输入的值不是唯一的，则显示查找以允许用户选择他们“意指”的记录。请注意，因此查找必须呈现一组唯一可识别的记录，以便用户知道要选择哪个记录（如果在查找中所有记录看起来都一样，那么他们将不知道应该选择什么。）

5) 成功解析键入的值后，将记录设置回源表单。

鉴于此流程，很明显，如果表上没有唯一索引（键），则步骤 3-5 将被破坏。（如果记录无法唯一标识（假设您不想向用户显示 RecId），用户应该如何指定对记录的唯一引用？）

在您决定仍要使用非唯一索引作为替换字段组的特殊情况下，您*必须*实现 resolveReference 和 lookupReference 为用户提供独特的解析/查找体验（处理上述流程中的步骤 3-5 ）。注意：常见的用例是希望有效地消除在参考组中显示的非选择性字段，而是让一些外部上下文或模式隐式设置该值。例如，如果备用键是 {Size, Color}，则可能使“Color”成为全局表单上下文——也许通过让用户在表单顶部选择一种颜色——并且只让用户输入 Size参考组...然后可以通过 resolveReference 和 lookupReference 覆盖隐式添加颜色。

# javascript - MVC - 通过 JS 将值传递给控制器

> ID：10687538
> 
> 赞同：3
> 
> 时间：2012-05-21T14:49:15.877
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-3

我有一个下拉

```
 <%=Html.DropDownList("genre", Model.genres, "", new { @onchange = ChangeMovie()" })%> 
```

JavaScript 看起来像（不完整）

```
function ChangeMovie() {
    var genreSelection = container.find( '#genre' ).val();

    $.ajax({  
        "url" : "/Movies/GetGenre" ,
        "type" : "get" ,
        "dataType" : "json" ,
        "data" : { "selectedValue" : $( "#genre").val() },
        "success" : function (data) {}
    });
}; 
```

控制器代码

```
public ActionResult GetGenre(string genreName)
{
   //Need to get the `genreName` from the JavaScript function above.. which is
   // in turn coming from the selected value of the drop down in the beginning.

} 
```

我想通过 js 函数将下拉列表的选定值传递给控制器​​代码中的操作结果。我需要帮助来处理 JavaScript 代码和 AJAX 调用代码，以便将正确的值传递给控制器​​。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:59:31.000

您在 Ajax 请求中发布的值的参数名称与 Action 参数名称不匹配。**selectedValue**应该是**genreName**。

改变这个：

```
"data" : { "selectedValue" : $( "#genre").val() }, 
```

对此：

```
data : { genreName : $("#genre").val() }, 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T15:00:02.303

为了使模型绑定正常工作，传递的 json 对象的字段名称应与控制器操作的参数名称匹配。所以，这应该工作

```
"data" : { "genreName" : $( "#genre").val() }, 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T15:06:51.603

您有很多不必要的引号，也没有在您的操作中返回 JSON

```
$.ajax({
    url: "/Movies/GetGenre/",
    dataType: "json",
    cache: false,
    type: 'GET',
    data: {genreName: $("#genre").val() },             
    success: function (result) {
        if(result.Success) {
            alert(result.Genre);
        }
    }
}); 
```

另外，您的控制器没有返回 Json，请将您的操作修改为此

```
public JsonResult GetGenre(string genreName) {
    // do what you need to with genreName here 
    return Json(new { Success = true, Genre = genreName }, JsonRequestBehavior.AllowGet);
} 
```

# iphone - 加载背景数据和启动图像

> ID：10687539
> 
> 赞同：0
> 
> 时间：2012-05-21T14:49:20.850
> 
> 标签：iphone, objective-c, xcode

我已经阅读了苹果指南，我知道它说你不应该这样做，但请听我说，因为我想知道我所做的是否是不好的做法。

当我的应用程序加载时，在应用程序委托中，会进行网络调用，用于设置选项卡的顺序以及其中的内容。网络电话是这样的

```
WebCalls *wc = [[WebCalls alloc] init];
[wc setWebCallDidFinish:^(NSString * json) {    
    // set up tab order here, as well as stores the JSON in a file on the phone
    // Also code here to download images and cache them on phone
    self.window.rootViewController = self.tabBarController;
    [self.window makeKeyAndVisible];
}
[wc getData:phoneNumber]; 
```

现在这段代码很好用，但问题是应用程序启动时会发生什么

1.  启动图像显示一秒钟（不是很长，有时是半秒或更短，所以很烦人）
2.  解析 json 并下载图像等时屏幕变黑约 2 秒
3.  然后显示第一个选项卡控制器

我想要的是启动屏幕和第一个屏幕之间的无缝过渡，因此用户永远不会看到黑屏。

我想做的是这样的

[更改 iPhone 闪屏时间](https://stackoverflow.com/questions/7511353/change-iphone-splash-screen-time)

在给出的答案中，这个人将一个视图向前推为启动屏幕。将视图向前推，然后在该屏幕中执行获取 json 数据并下载图像的网络调用，然后关闭视图并使 tabcontroller 视图成为主视图，这是不好的做法吗？

或者我还能如何防止这种延迟？在 AppDelegate 中像这样进行足够大的网络调用是不好的做法吗？

如果在进行后台加载时将视图向前推进是一种不好的做法，那么您还有什么建议？如果我先将 tabController 设为主 rootViewController 并在显示的第一个选项卡中执行 webCall，然后在此 Web 调用完成时更新选项卡，会更好吗？我正在考虑这个，但是在进行网络通话后，标签顺序可以是任何顺序，所以不确定首先显示哪个标签。

将不胜感激您的意见

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:05:20.750

> 在给出的答案中，这个人将一个视图向前推为启动屏幕。将视图向前推，然后在该屏幕中执行获取 json 数据并下载图像的 Web 调用，然后关闭视图并使 tabcontroller 视图成为主视图，这是不好的做法吗？

这是做到这一点的方法。从 applicationDidFinishLaunching 下载东西通常是不好的做法，如果手机没有连接到互联网会发生什么？

呈现一个简单的视图控制器（使用`presentModalViewController:controller animated:NO`UIActivityIndi​​cator 和一个描述正在发生的事情的标签，然后在加载完成时将其关闭（或者它失败，只显示错误并拒绝访问应用程序）。记住还要检查飞行模式并通知用户。

# constructor - Quartz.net IJobDetails 使用手动创建的 IJob 实现

> ID：10687541
> 
> 赞同：2
> 
> 时间：2012-05-21T14:49:25.567
> 
> 标签：constructor, castle-windsor, jobs, quartz.net, parameterized

我在使用 Quartz.net 时遇到问题。IJob 有限制，这个对象必须通过无参数构造函数来构造。但我需要将它们与参数一起使用。我可以从已经实例化的 IJob 类中创建 Job 实例吗？我使用 Windsor 来创建这样的课程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:59:06.857

我不太了解[quartz.net](/questions/tagged/quartz.net "显示标记为“quartz.net”的问题")，但似乎您可以插入自己的[`IJobFactory`](http://quartznet.sourceforge.net/apidoc/2.0/html/topic2882.html)实现。同样的方法适用于[spring](/questions/tagged/spring "显示标记为“春天”的问题")框架和[`SpringBeanJobFactory`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/scheduling/quartz/SpringBeanJobFactory.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:47:06.027

如果您已经在使用 Windsor 创建 Job 实例，则可以像通过 IoC 容器创建的任何其他实例一样传递参数构造函数。由于 IoC 控制创建作业实例，因此创建取决于您如何将其注册到容器中。

例如，如果您的作业构造器参数是其他对象/组件实例，则它们也必须注册到容器中。如果它们是静态参数，则可以在将组件注册到容器中时使用“DependsOn”...

# r - 如何在for循环中使用tapply（）并在R中打印输出？

> ID：10687543
> 
> 赞同：0
> 
> 时间：2012-05-21T14:49:33.610
> 
> 标签：r, for-loop, tapply

我正在使用 tapply() 将函数应用于我的数据

```
Myrepfun <- function(x,n){
    nstudents <- replicate(1000,sum(sample(x, size=n,replace=TRUE)))
    quantile(nstudents,probs=0.95)
}

tapply(weight,schoolcode,Myrepfun,n=2) 
```

我想在 for 循环中使用它并打印输出。我尝试了以下方法并收到错误消息：`Error: unexpected symbol in "for(n in 12:13) (t=tapply(ow,sc,ndropfunction,n,p=0.95) output`

```
for(n in 1:25) {t=tapply(weight,schoolcode,Myrepfun,n,p=0.95) print(c=(t,n))} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:54:20.847

[可重复的例子](https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example)让世界运转起来。但是，您的问题是您的代码在语法上无效。如果要将所有内容放在一行中，则需要用分号分隔命令：`;`。或者，将它们放在两条不同的线上。两个例子：

```
> x <- runif(100)
> for (i in 1:3){out <- mean(x);print(c(out,i))}
#-----
[1] 0.4958944 1.0000000
[1] 0.4958944 2.0000000
[1] 0.4958944 3.0000000
> for (i in 1:3){
+   out <- mean(x)
+   print(c(out,i))
+ }
#-----
[1] 0.4958944 1.0000000
[1] 0.4958944 2.0000000
[1] 0.4958944 3.0000000 
```

# javascript - Jquery，知道带有滚动条的div的宽度和高度

> ID：10687547
> 
> 赞同：9
> 
> 时间：2012-05-21T14:49:44.367
> 
> 标签：javascript, jquery, html, css

我想要使​​用 JQuery 滚动的完整 div 的宽度和高度，但我只能有可见内容的大小，而不是滚动条的可见 + 隐藏内容的大小。

无论如何，有人知道有这个值（宽度和高度）吗？

```
<div id="area" class="divLeftCem area">
    <div id="panelArea" class="areaBackground"
        style="width: 1004px; height: 613px; background: #FFFFFF url('Images/background.png') repeat;">
    </div>
</div>

.area
{
    margin-left: 10px;
    width: 1004px;
    height: 613px;
    border: 1px solid #AFAFAF;
    overflow: auto;
    position: absolute;
    top: 145px;
} 
```

PS：抱歉英语不好。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T14:53:27.593

获取元素的`.scrollHeight`：

```
$(".el").get(0).scrollHeight; 
```

​ 不言而喻，您也可以`.scrollWidth`用于 x 轴。

小提琴：http: [//jsfiddle.net/spN6n/](http://jsfiddle.net/spN6n/)

# c++ - 向量的容量何时会减少？

> ID：10687549
> 
> 赞同：4
> 
> 时间：2012-05-21T14:49:50.653
> 
> 标签：c++, stl

（这个问题与`shrink_to_fit`技巧无关（使用`swap()`或`shrink_to_fit()`在 C++11 中）。）

如果我只通过`insert()`, `erase()`, `push_back()`, `pop_back()`,使用一个向量`clear()`，当容量不够时，它会增加并且会发生对向量的重新分配。但是在什么情况下容量会减少呢？容量减少是否一定会导致重新分配？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T15:13:22.507

该标准保证在例如`pop_back`. 来自 [container.requirements.general]：

> 除非另有规定（明确地或通过根据其他函数定义函数），调用容器成员函数或将容器作为参数传递给库函数不应使该容器内对象的迭代器无效或更改其值.

并且没有其他规范，例如`pop_back`。

所以这意味着不会发生重新分配。¹

* * *

[1.在对另一个答案的评论中建议，也许可以释放与弹出元素相对应的内存，这不会使对“活动”元素的任何引用无效。

但这会阻止数组重新增长，因为标准明确指出插入不能引发重新分配，直到大小超过容量。来自 [vector.capacity]：

> 保证在调用之后的插入过程中不会发生重新分配，`reserve()`直到插入会使向量的大小大于 的值`capacity()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T14:52:32.370

不，`pop_back()`不这样做。其他人当然不会。唯一的方法就是你提到的方法。

```
template< typename T, class Allocator >
void shrink_capacity(std::vector<T,Allocator>& v)
{
   std::vector<T,Allocator>(v.begin(),v.end()).swap(v);
} 
```

在`shrink_to_fit()`c++11 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:54:16.787

C++ 标准在其存在期间的任何时间点都不需要`std::vector`减少。`capacity()`这严格依赖于实现，因此实现可能是独立的，但您不应该依赖这种行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T14:52:15.187

当使用量低于容量的 1/4 时，它**可能**会减少（这将给出重新分配的摊销不变成本）。但是，当您仅使用列出的方法时，STL 实现没有义务随时减少向量。]

# javascript - 如何在忽略空值的同时扩展对象？

> ID：10687550
> 
> 赞同：12
> 
> 时间：2012-05-21T14:49:54.750
> 
> 标签：javascript, jquery

比如说我有一个对象

```
var user = { 
    "Name": "Dan", 
    "Age": 27, 
    "Hobbies": null 
}; 
```

我想将其合并到以下基础对象中，以便我的用户对象具有所有必需的属性

```
var base = { 
    "Name": null, 
    "Height": null, 
    "Age": null, 
    "Hobbies": [
        { "Name": "Tennis", "Location": null },
        { "Name": "Football", "Location": null },
        { "Name": "Rugby", "Location": null }
    ]
}; 
```

合并到两个对象的最简单方法是使用用户对象扩展基础对象，如下所示

```
$.extend(true, base, user); 
```

这会将基础对象修改为

```
{ 
    "Name": "Dan", 
    "Height": null, 
    "Age": 27, 
    "Hobbies": null
}; 
```

我的问题是如何让扩展方法不覆盖空值？例如，在这种情况下，如果用户爱好列表为空，我如何仍然获得爱好列表，所以我最终得到以下内容

```
{ 
    "Name": "Dan", 
    "Height": null, 
    "Age": 27, 
    "Hobbies": [
        { "Name": "Tennis", "Location": null },
        { "Name": "Football", "Location": null },
        { "Name": "Rugby", "Location": null }
    ]
}; 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-21T14:56:04.793

您可以使用`undefined`as 将被忽略的值`jQuery.extend`。

```
var user = { "Name": "Dan", 
             "Age:" 27, 
             "Hobbies": undefined 
           };
$.extend(true, base, user); 
```

# ios - 带角度的图层

> ID：10687556
> 
> 赞同：0
> 
> 时间：2012-05-21T14:50:06.410
> 
> 标签：ios, core-animation, layer

我怎样才能绘制一个固定角度的图层，而不是像这样水平的：

```
CALayer *layer1 = [CALayer layer];
UIImage *image1 = [UIImage imageNamed:@"cuore2.png"];
[layer1 setPosition:CGPointMake(50,50)];
[layer1 setBounds:CGRectMake(10, 10, 40, 40)];
layer1.contents=(id)image1.CGImage;
[self.view.layer addSublayer:layer1]; 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:54:21.230

如果您只想显示按角度 alpha 旋转的图层（即不需要任何伪 3D 透视效果），您可以设置图层的变换：

```
[CATransaction setDisableActions:YES]; // Disable animation
layer1.transform = CATransform3DMakeRotation(alpha, 0, 0, 1); // Rotate layer 
```

# liferay - Liferay - AutoLogin + Authenticator - 从请求标头获取凭据

> ID：10687562
> 
> 赞同：1
> 
> 时间：2012-05-21T14:50:14.773
> 
> 标签：liferay

我需要 Liferay 自动登录和自定义身份验证方面的帮助。

我的目标是从标头（由不同的身份验证框架填充）获取凭据，然后自动登录。用户登录时我还必须调用一些服务。

我已经阅读了一些文档（也是[http://www.liferay.com/community/wiki/-/wiki/Main/Developing+a+Custom+Authentication+System](http://www.liferay.com/community/wiki/-/wiki/Main/Developing+a+Custom+Authentication+System)上的那个），但我仍然不明白。

我用portal.properties做了一个钩子：

```
auto.login.hooks=it.mypackage.filter.AutoLoginFilter 
```

和班级：

```
public class AutoLoginFilter implements AutoLogin {

    public AutoLoginFilter() {
        super();
    }

    @Override
    public String[] login(HttpServletRequest req, HttpServletResponse arg1) throws AutoLoginException {
        String[] credentials = new String[] { "test@liferay.com" };
        return credentials;
    }
} 
```

在示例类 AutoLogin 中，我想只返回用户名（我不需要验证其他凭据）。

然后我用portal-ext.properties创建一个分机：

```
auth.pipeline.pre=it.mypackage.auth.MyAuthenticator
auth.pipeline.enable.liferay.check=false 
```

和身份验证器：

```
public class MyAuthenticator implements Authenticator {

    private static Log _log = LogFactory.getLog(SwaFiamAuthenticator.class);

    @Override
    public int authenticateByEmailAddress(long companyId, String emailAddress, String password,
            Map<String, String[]> headerMap, Map<String, String[]> parameterMap) throws AuthException {
        return authenticate();
    }

    @Override
    public int authenticateByScreenName(long companyId, String screenName, String password,
            Map<String, String[]> headerMap, Map<String, String[]> parameterMap) throws AuthException {
        return authenticate();
    }

    @Override
    public int authenticateByUserId(long companyId, long userId, String password, Map<String, String[]> headerMap,
            Map<String, String[]> parameterMap) throws AuthException {
        return authenticate();
    }

    protected int authenticate() {
        _log.debug("returning SUCCESS");
        return SUCCESS;
    }

} 
```

我对代码的期望是：

每个进入门户的用户都会自动进行身份验证，而不会看到任何登录页面，并被识别为用户“test@liferay.com”

我得到什么：

AutoLoginFilter.login 被调用，但用户仍被重定向到登录页面。MyAuthenticator 从未调用过（仅当我删除 AutoLogin-hook 并删除 auth.pipeline.enable.liferay.check=false 属性时才会调用它）。

感谢帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:57:38.043

返回的数组必须首先包含 userId，这样的东西必须有效：

```
 String[] credentials = new String[3];
            credentials[0] = userId;
            credentials[1] = "undefined";
            credentials[2] = Boolean.FALSE.toString(); 
```

您可以在控制面板 -> 用户 ->... 中找到的用户 ID

或（更好的方法）以编程方式加载它`UserLocalServiceUtil.getUserByEmailAddress(companyId, emailAddress);`

这种`auth.pipeline`方法不需要。

# jsp - 如何在 MediaWiki 和 JSP 网站之间设置单点登录

> ID：10687563
> 
> 赞同：1
> 
> 时间：2012-05-21T14:50:15.833
> 
> 标签：jsp, single-sign-on, session-cookies, mediawiki, jsessionid

就是这样：我有一个使用 JSP 并部署在 tomcat 上的网站。我现在要做的是设置一个带有 sso 系统的 MediaWiki。即，我希望用户使用同一个帐户访问我的第一个站点和我的 MediaWiki，并且在从一个站点移动到另一个站点时不需要再次登录。

目前，这两个系统使用 Ldap 系统（使用 openldap 设置）共享帐户列表。在 JSP 上连接时，它在 cookie 中存储了一个 JSESSIONID 参数，而在连接到 MediaWiki 时，它似乎存储了 3 个参数：wikidb_session、wikidbUserID 和 wikidbUserName。

使两个系统共享会话 cookie 的最佳方法是什么？

亚历克西斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T14:30:37.477

您不能共享会话 cookie，因为每个应用程序（Mediawiki 和您的 JSP 站点）都有自己的。

您可以做的是拥有一个可供您的每个应用程序使用的单点登录模块。

您可以查看 JASIG CAS（中央身份验证服务）[http://www.jasig.org/cas](http://www.jasig.org/cas)。

脚步 ：

1.  安装将处理身份验证的 CAS 服务器应用程序。这是一个 Java Web 应用程序，您可以将其安装在已经运行 JSP 站点的同一个 servlet 引擎上。CAS 服务器有多个身份验证处理程序，如 LDAP。

2.  将 CAS 客户端添加到您的 JSP 站点。CAS 客户端可用作 servlet 过滤器，它将未经过身份验证的用户重定向到用户将进行身份验证的 CAS 服务器，然后 CAS 服务器将使用特殊参数（服务票证）将用户重定向到初始应用程序。CAS Client 过滤器将使用该参数联系 CAS Server 以获取用户的登录信息。这可能需要您做一些工作，因为您必须将 JSP 站点中的身份验证部分移动到 CAS 服务器。

3.  将 CAS 客户端添加到您的 Mediawiki。CAS 客户端也可用作 PHP 客户端 (PHPCas)。Mediawiki 似乎已准备好 CAS：[http ://www.mediawiki.org/wiki/Extension:CASAuthentication](http://www.mediawiki.org/wiki/Extension:CASAuthentication)

# c# - 有人知道如何将 Facebook.Json 转换为一组可理解的 C# 对象吗？

> ID：10687571
> 
> 赞同：-1
> 
> 时间：2012-05-21T14:50:38.260
> 
> 标签：c#, .net, facebook, facebook-graph-api

我厌倦了研究如何将 Facebook.Json 的东西转换为一些 C# 类。

是否有一些适用于 Facebook 的所有实体的开源即用型解决方案？

只是将帖子解析为某些`List<Post>`或类似的东西？

谢谢！

```
dynamic p = (IDictionary<string, object>)fb.Get(userID + "/posts");

        foreach (dynamic value in p.Values) 
        {
            Post post = new Post();
            foreach (dynamic item in value) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:16:21.500

创建自己的对象集并编写自定义反序列化器？

FB 没有 C# SDK 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:23:07.300

查看[JSON.Net](http://json.codeplex.com/) - 它的 Linq 命名空间有一些对象，您可以使用它们来动态访问 JSON 格式的数据。如果您想要强类型的对象，JsonConvert 类也可以轻松地将 JSON 数据反序列化为您自己的类。

# javascript - javascript从处理复选框的表单元素创建url

> ID：10687577
> 
> 赞同：0
> 
> 时间：2012-05-21T14:51:03.697
> 
> 标签：javascript

所以我一直在使用这个通用代码从表单元素创建一个 URL

```
function submiturl() {
    url="Search.do?call=JS"; 
    var elem = document.getElementById('searchInput').elements;
    for(var i = 0; i < elem.length; i++) {
        url = url + "&" + escape(elem[i].name) + "=" + escape(elem[i].value);
    }
    url = url.substring(0,(url.length-1));
   alert(url);
} 
```

但是它不能正确处理复选框 - 如果选中了复选框，我只想添加到 URL。所以如果你有这个 html

```
<html>
<body>
<form name="searchInput" id ="searchInput">
    <input name="first" type="checkbox" value="123"/>One two three
    <input name="second" type="checkbox" value="456"/>Four five six
    <button type="button" onClick="submiturl();">Submit</button>
</form>
</body>
</html> 
```

它将使用两个复选框的值创建 URL，无论它们是否被选中。

那么如何修改我的 javascript 以检查它是否是一个复选框并被选中？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:54:59.613

在你的 for 循环中这样做：

```
if (elem[i].type != "checkbox" || elem[i].checked)
    url = url + ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:55:41.400

是复选框吗？

```
typeof elem[i].attributes['type'] != 'undefined' &&
elem[i].attributes['type'].value == 'checkbox' 
```

检查了吗？

```
typeof elem[i].attributes['checked'] != 'undefined' &&
elem[i].attributes['checked'].value == 'checked' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T14:57:31.830

```
function submiturl() {
    var url="Search.do?call=JS", 
        els = document.getElementById("searchInput").elements
    ;
    for(var el, i = 0, n = els.length; i < n; i++) {
        el = els[i];
        if (el.checked || el.type !== "checkbox") {
            url += "&" + encodeURIComponent(el.name) + 
                   "=" + encodeURIComponent(el.value)
            ;
        }
    }
    alert(url);
} 
```

# entity-framework - 实体框架代码优先忽略特定模式

> ID：10687580
> 
> 赞同：5
> 
> 时间：2012-05-21T14:51:16.870
> 
> 标签：entity-framework, entity-framework-4, ef-code-first

使用 Entity Framework 4.3.1 CodeFirst 并且没有运气让迁移或脚本尊重我希望我的表最终所在的架构。

似乎默认行为（无论我做什么，我都会看到）是从实际运行的 SQL 中完全省略模式，这会导致在默认模式中为运行迁移或脚本的用户创建表。

我的 DBA 告诉我，他们无法更改我的默认架构，因为我是 AD 组的一部分而不是本地用户，因此更改运行脚本的用户的默认架构（通常推荐的解决方法）不是一个选择。

我试过使用这样的注释：

```
[Table("MyTable", Schema = "dbo")]
public class MyTable
{
    public int Id { get; set; }

    public string MyProp1 { get; set; }

    public string MyProp2 { get; set; }
} 
```

而且我也尝试过使用同一事物的流利变体：

```
modelBuilder.Entity<YourType>().ToTable("MyTable", "dbo"); 
```

生成的脚本（和迁移）忽略了我尝试指定模式的事实。脚本如下所示：

```
CREATE TABLE [MyTable] (
    [Id] [int] NOT NULL IDENTITY,
    [MyProp1] [nvarchar](max),
    [MyProp2] [nvarchar](max),
    CONSTRAINT [PK_MyTable] PRIMARY KEY ([Id])
) 
```

当**应该**像这样藏在那里的 [dbo] 时：

```
CREATE TABLE [dbo].[MyTable] (
    [Id] [int] NOT NULL IDENTITY,
    [MyProp1] [nvarchar](max),
    [MyProp2] [nvarchar](max),
    CONSTRAINT [PK_MyTable] PRIMARY KEY ([Id])
) 
```

有没有其他人幸运地让实体框架尊重架构？这种行为几乎完全扼杀了我们在企业环境中使用代码优先的能力。

提醒：将我的用户更改为具有不同的默认架构根本不是一种选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T16:59:24.980

*由于我的评论似乎已经回答了这个难题，我正在重新创建它作为答案。*

似乎因为 SQL Server 提供程序使用“dbo”作为默认架构，它不会显式地将“dbo”添加到创建表的 TSQL，即使您在配置中指定它也是如此。

这回答了基本问题。但是现在我很好奇 dbo 是否是默认值，你（Bob）还有理由指定它吗？如果您只是希望默认值对阅读代码的人来说是显而易见的，那么在配置中使用它并没有什么坏处。但是这种行为会产生另一个副作用吗？

补充：啊哈！已在 EF5 中修复！:) （我刚刚更新了我的测试项目以使用 EF5RC（针对 .NET 4.0），并且我在 TSQL 中明确获得了“dbo”来创建表。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T15:18:24.843

I tried all of the stuff that Bob Bland tried with a similar lack of success (I was also using Entity Framework 4.3.1 CodeFirst). Then I changed the generated migration to look like this and it worked. Maybe this will save somebody a few minutes of pain?

**So my solution was to generate the migration as normal, then hack it by hand to include `dbo.` as shown below.**

```
 public override void Up()
    {
        CreateTable(
            "dbo.UploadedFiles", // See? I have added dbo. to the front of my table name :-)
            c => new
                {
                    UploadedFileId = c.Guid(nullable: false, identity: true),
                    // other columns omitted for brevity...
                    FileData = c.Binary(),
                })
            .PrimaryKey(t => t.UploadedFileId);
    } 
```

and the Down bit looks like this

```
 public override void Down()
    {
        DropTable("dbo.UploadedFiles"); // See? I have added dbo. to the front of my table name here too :-)
    } 
```

# postgresql - PostgreSQL 触发器不起作用 - 既不是 BEFORE 也不是 AFTER DELETE

> ID：10687582
> 
> 赞同：8
> 
> 时间：2012-05-21T14:51:23.847
> 
> 标签：postgresql, triggers, plpgsql

我刚刚离开 MySQL 支持 PostgreSQL，我有一个关于触发器的问题。如果删除了“流程”表中的行，则此触发器旨在更新“工作流”表中的字段。

```
CREATE OR REPLACE FUNCTION fn_process_delete() RETURNS TRIGGER AS $$
BEGIN
    UPDATE workflow SET deleted_process_name = OLD.process_name
    WHERE process_id = OLD.process_id;
    RETURN NULL;
END;
$$ LANGUAGE plpgsql;

DROP TRIGGER IF EXISTS process_delete ON processes;
CREATE TRIGGER process_delete
AFTER DELETE ON processes
FOR EACH ROW 
EXECUTE PROCEDURE fn_process_delete(); 
```

我的问题有两个：

1.  如果我如上所述使用 AFTER DELETE，该行将被删除，但更新语句不会更新“工作流”表中的字段。

2.  如果我使用 BEFORE DELETE，则进程表将根本不执行删除，并提供一条错误消息“该行没有唯一标识符”。

任何人都可以建议吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-21T15:16:15.197

### 问题2：

您的触发功能以：

```
RETURN NULL; 
```

这样您就可以跳过触发事件的执行。[根据有关触发程序的文档](http://www.postgresql.org/docs/current/interactive/plpgsql-trigger.html)：

> 触发的行级触发器**`BEFORE`**可以返回 null 以指示触发器管理器跳过该行的其余操作（即，不触发后续触发器，并且//`INSERT`不会针对该行发生）。`UPDATE``DELETE`

您需要将其替换为：

```
RETURN OLD; 
```

以便系统继续删除该行。原因如下：

> **在前触发**on的情况下`DELETE`，返回值没有直接影响，但它必须**为非空**才能允许触发操作继续进行。请注意，触发器中`NEW`为 null `DELETE`，因此返回它通常是不明智的。**触发器中的常用习语`DELETE`是 return`OLD`**。

大胆强调我的。

### 问题 1

我看不出为什么您的触发器和触发器功能不应该作为`AFTER DELETE`. 不用说，`process_id`表中必须存在匹配的行`workflow`。

# git - Git：如何在命令行上指定包含八进制符号的文件名

> ID：10687589
> 
> 赞同：5
> 
> 时间：2012-05-21T14:51:40.950
> 
> 标签：git, encoding, notation, octal

对于文件名中的非 ASCII 字符，Git 会以*八进制*输出。例如：

```
> git ls-files
"\337.txt" 
```

如果这样的字节序列不代表合法的编码（对于命令行的当前编码），我无法在命令行上输入相应的字符串。我怎样才能在这些文件上调用 Git 命令？显然，使用显示的字符串`git ls-files`不起作用：

```
> git rm "\337.txt"
fatal: pathspec '337.txt' did not match any files 
```

在 Windows 上测试，使用 msysgit 1.7.10（git 版本 1.7.10.msysgit.1）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T14:56:20.923

在 Bash 中，您可以[`printf`](http://www.manpagez.com/man/1/printf/)用于这种目的：

```
$ printf "\337.txt"
▒.txt

$ git rm `printf "\337.txt"`  # this would pass the awkward filename to git 
```

显然，问题在于 shell 不执行八进制转义，git 也不执行。但`printf`确实如此。

* * *

此外，`echo -e`可以进行八进制转义：

```
$ echo -e '\0337.txt'
▒.txt 
```

但是这种用法有点不鼓励，您应该尽可能选择`printf`。

# c# - 从 mdb Access 应用程序到 windows 应用程序 C#

> ID：10687590
> 
> 赞同：-2
> 
> 时间：2012-05-21T14:51:43.837
> 
> 标签：c#, ms-access

我必须使用 c# 重新编码一个小型访问 mdb 应用程序。重用和存储现在存储在访问表中的数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:56:59.607

您可以使用 Microsoft 的[升迁向导](http://office.microsoft.com/en-us/access-help/use-the-upsizing-wizard-HP005273009.aspx)将数据库迁移到 SQL Server。如果您的连接用户数量和数据库大小足够小，您可以使用Microsoft 免费提供的[SQL Server Express 。](http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:02:42.393

最简单的方法是将其保留为 Access (JET) MDB 格式。AC# 应用程序可以很好地处理这种格式。

最终使用哪个数据库的决定主要取决于您的项目要求。您使用 C# 的事实并不是您选择哪一个的主要考虑因素。

# iphone - 使用 iOS Addressbook api 搜索交换联系人

> ID：10687595
> 
> 赞同：3
> 
> 时间：2012-05-21T14:52:06.137
> 
> 标签：iphone, ios, abpeoplepickerview

我正在开发应用程序，我想按名称搜索交换联系人（类似于电话联系人应用程序），通过 iOS 的 AddressBook API 并搜索网络我仍然无法理解如何使用 iOS 通讯录 API搜索交换联系人。我只能发现地址簿提供了 ABSource 可搜索但不提供如何搜索的信息。如果有任何机构可以提供帮助，我们将不胜感激。非常感谢您..我已经为此苦苦挣扎了很长时间..

我也尝试自定义 ABPeoplePicker，但没有太多帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T23:31:34.853

我解决这个问题的方法是找到我想要的 ABSource 记录，然后使用这些记录来获取源中的 ABPerson 记录，然后构建一些数据结构并使用 NSPredicate 过滤它们。也许有点令人费解，但它似乎有效。

```
ABAddressBookRef addressBook = ABAddressBookCreate();
CFArrayRef sources = ABAddressBookCopyArrayOfAllSources(addressBook);
CFIndex sourcesCount = CFArrayGetCount(sources);
ABRecordRef sourceToSearch = NULL;
for (CFIndex index = 0; index < sourcesCount; index++)
{
    ABRecordRef record = (ABRecordRef)CFArrayGetValueAtIndex(sources, index);
    NSNumber *sourceTypeNumber = (__bridge NSNumber *)(CFNumberRef)ABRecordCopyValue(record, kABSourceTypeProperty);
    ABSourceType sourceType = [sourceTypeNumber intValue];
    if (sourceType == 4) //this was the only source type with people on my phone, I guess you'll use kABSourceTypeExchange instead
    {
        sourceToSearch = record;
        break;
    }
}

CFArrayRef peopleInRecord = (CFArrayRef)ABAddressBookCopyArrayOfAllPeopleInSource(addressBook, sourceToSearch);
CFIndex peopleCount = CFArrayGetCount(peopleInRecord);
NSMutableArray *peopleDictionaries = [NSMutableArray array];
for (CFIndex index = 0; index < peopleCount; index++)
{
    ABRecordRef personRecord = CFArrayGetValueAtIndex(peopleInRecord, index);
    ABRecordID recordID = ABRecordGetRecordID(personRecord);
    NSString *personName = (__bridge NSString *)(CFStringRef)ABRecordCopyValue(personRecord, kABPersonFirstNameProperty);
    if (personName)
    {
        NSDictionary *personDictionary = @{ @"recordID" : [NSNumber numberWithInt:recordID], @"name" : personName };
        [peopleDictionaries addObject:personDictionary];
    }
}

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%K like %@",@"name",@"Kyle"];
NSArray *kyles = [peopleDictionaries filteredArrayUsingPredicate:predicate];
NSLog(@"filtered dictionarys = %@",kyles);
/*
 2012-08-27 17:26:24.679 FunWithSO[21097:707] filtered dictionaries = (
 {
 name = Kyle;
 recordID = 213;
 }
 )*/
//From here, get the recordID instance and go get your ABPerson Records directly from the address book for further manipulation. 
```

希望这会有所帮助，如果您有任何问题，请告诉我！

# c# - 在纯 XAML 中创建 WPF 水印

> ID：10687596
> 
> 赞同：3
> 
> 时间：2012-05-21T14:52:08.273
> 
> 标签：c#, wpf, xaml

这是用于登录屏幕上的 TextBox 控件，其中 TextBox 包含用户名。我希望 TextBox 以下列方式执行：

*   当内容为空时，内容应设置为“用户名”。

*   单击文本框时，我希望将内容设置为“”，即；什么都没有（除非内容已经被用户编辑过）。

这是当今非常标准的功能，例如这个[wordpress 登录](http://en.support.wordpress.com/tag/login/)（在页面顶部）。*恐怕想不出比这更好的例子了：）*

所以，无论如何，我已经使用 ViewModel 完成了这项工作，并且效果很好，但我想知道这是否可以**纯粹从 XAML end**完成。不关心业务逻辑，所以我认为没有虚拟机会更好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T15:25:18.907

查找以下示例可帮助您找到自己的方式。

[http://bendewey.wordpress.com/2008/09/27/wpf-shadowed-textbox-watermark/](http://bendewey.wordpress.com/2008/09/27/wpf-shadowed-textbox-watermark/)

[http://www.c-sharpcorner.com/uploadfile/rahul4_saxena/watermark-textbox-in-wpf/](http://www.c-sharpcorner.com/uploadfile/rahul4_saxena/watermark-textbox-in-wpf/)

[http://www.codeproject.com/Articles/26977/A-WatermarkTextBox-in-3-lines-of-XAML](http://www.codeproject.com/Articles/26977/A-WatermarkTextBox-in-3-lines-of-XAML)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:45:19.557

扩展的[WPF 工具包](http://wpftoolkit.codeplex.com/)有一个[水印文本框](http://wpftoolkit.codeplex.com/wikipage?title=WatermarkTextBox)，它可以满足您在纯 XAML 中的要求。那里还有其他图书馆。

使用扩展 WPF 工具包的好处是您可以在 Nuget 上获取它并直接通过 Visual Studio 安装和安装更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-16T05:09:30.777

纯 XAML：

```
<Grid>
    <TextBox  Width="250"  VerticalAlignment="Center" HorizontalAlignment="Left" x:Name="SearchTermTextBox" Margin="5"/>
    <TextBlock IsHitTestVisible="False" Text="Enter Search Term Here" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0" Foreground="DarkGray">
        <TextBlock.Style>
            <Style TargetType="{x:Type TextBlock}">
                <Setter Property="Visibility" Value="Collapsed"/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Text, ElementName=SearchTermTextBox}" Value="">
                        <Setter Property="Visibility" Value="Visible"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </TextBlock.Style>
    </TextBlock>
</Grid> 
```

取自：[https ://stackoverflow.com/a/21672408/4423545](https://stackoverflow.com/a/21672408/4423545)

# compilation - 如何检查 auto_ptr 是否已经指向一个对象

> ID：10687597
> 
> 赞同：0
> 
> 时间：2012-05-21T14:52:09.530
> 
> 标签：compilation, null, g++, compare, auto-ptr

我目前有一个 auto_ptr：

```
auto_ptr<ClassA> classA_; 
```

如何检查 classA_ 是否指向某物。如果我做：

```
if (classA_ == NULL) 
```

检查它是否指向NULL，它给出一个编译错误：错误：'classA_ == 0'中的'operator =='不匹配

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:55:26.777

关于什么

```
classA_.get() == 0 
```

?

# sql-server-2012 - SQL Server 2012 慢

> ID：10687600
> 
> 赞同：0
> 
> 时间：2012-05-21T14:52:15.590
> 
> 标签：sql-server-2012

我最近将我的 .NET 开发从旧的 Core2Duo 2.93 GHz PC 转移到了新的 Core i7-3820 3.6 GHz 机器上。没有对项目代码或数据库布局进行任何更改。两台机器都使用相同的 SQL Server 2012 Express 和高级服务（不是 LocalDB）。

我观察到 INSERT INTO 命令的速度显着下降：以前在旧机器上每行需要 1-2 毫秒，现在在新机器上需要 8-9 毫秒。我能找到的唯一解决方法是在一个命令中使用多行插入，这似乎将命令的开销分散到多行上。与 SQL Server 2008 R2 中一样，在 SQL Server 2012 中，一个此类命令中的行数限制为 1000：http: [//msdn.microsoft.com/en-us/library/dd776382.aspx](http://msdn.microsoft.com/en-us/library/dd776382.aspx)

但是，多行变通方法并非适用于所有场景；例如，逐行更新的表适配器更新需要很长时间才能完成。

有没有人遇到过这个问题？我将如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T20:13:37.430

老实说，一次写一条记录总是很慢。考虑-如果它适合您的体系结构-将行写入文本文件然后批量插入，您的性能将大大提高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:02:37.237

cpu 肯定更好，但磁盘 io 呢？插入显然依赖于该子系统。

碰巧我只是在读这篇文章[http://www.altdevblogaday.com/2012/05/16/sql-server-high-performance-inserts/](http://www.altdevblogaday.com/2012/05/16/sql-server-high-performance-inserts/)

似乎表值参数可以显着提高性能

评论导致下一页有一些令人印象深刻的数字。

在评论[http://florianreischl.blogspot.de/2012/03/performance-comparison-of-sql-server.html](http://florianreischl.blogspot.de/2012/03/performance-comparison-of-sql-server.html)

我自己还没有使用过这个，但如果你有 2008 年或更高版本，tvp 似乎是将数据从客户端泵送到 sql 服务器的方法。

# c# - 对象引用的 ArrayList

> ID：10687601
> 
> 赞同：-2
> 
> 时间：2012-05-21T14:52:15.893
> 
> 标签：c#, pass-by-reference

拥有一个用户定义的类，如下所示：

```
class Foo
    {
        public int dummy;

        public Foo(int dummy)
        {
            this.dummy = dummy;
        }
    } 
```

然后有这样的东西：

```
ArrayList dummyfoo = new ArrayList();

Foo a = new Foo(1);
dummyfoo.add(a);

foreach (Foo x in dummyfoo)
    x.dummy++; 
```

a.dummy 多少钱？

如何创建我的 ArrayList 以使 a.dummy 等于 2，这意味着我的 ArrayList 基本上包含指向我的对象而不是副本的指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:53:52.460

它已经包含参考，而不是副本。这样做时：

```
Foo a = new Foo(1);
dummyfoo.Add(a); 
```

传递了对的引用`a`，而不是副本。

因此，`dummy`最初将为 1，然后在增量后为 2。

无论如何，你最好使用泛型：

```
List<Foo> dummyfoo = new List<Foo>();

Foo a = new Foo(1);
dummyfoo.Add(a);

foreach (Foo x in dummyfoo)
    x.dummy++; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:11:01.807

它已经是 2，因为数组/集合（准确地说是任何 .NET 类/引用类型）默认通过引用传递。

事实上，引用变量是按值传递的，但表现得就像按引用传递一样。

为什么->

```
 Consider var arr = new ArrayList(); 
```

上述语句首先创建了一个 ArrayList 对象，并为 arr 分配了一个引用。（这对于任何类都是相似的，因为类是引用类型）。

现在打电话的时候，

```
example ->    DummyMethod(arr) , 
```

引用是按值传递的，也就是说，即使将参数分配给方法内的不同对象，原始变量也保持不变。
但是由于变量指向（引用）相同的对象，对底层指向对象所做的任何操作都会反映在被调用方法之外。
在您的示例中，对每个所做的任何修改都将反映在 arrayList 中。

**如果您想避免这种行为，您必须创建对象的副本/克隆。**

例子：

代替

```
foreach (Foo x in dummyfoo)
        x.dummy++; 
```

利用

```
foreach (Foo x in (ArrayList)dummyfoo.Clone())
        x.dummy++; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T14:56:44.427

你声明`Foo`为一个类。类是[引用类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)。它已经像这样工作了。试试看：

```
class Program
{
    static void Main(string[] args)
    {
        ArrayList dummyfoo = new ArrayList();

        Foo a = new Foo(1);
        dummyfoo.Add(a);

        foreach (Foo x in dummyfoo)
            x.dummy++;

        Console.WriteLine(a.dummy); //Prints 2!
    }
}

class Foo
{
    public int dummy;

    public Foo(int dummy)
    {
        this.dummy = dummy;
    }
} 
```

顺便说一句，泛型`List<T>`优于已弃用的`ArrayList`类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T14:57:19.073

它已经是`2`：这是[您在 ideone](http://ideone.com/8j4YA)上的代码，可以验证这一点。

与*值类型*（即`struct`s）不同，引用（即`class`）对象是通过引用传递的。

PS 泛型自 C#2.0 起可用，因此请考虑使用`List<Foo>`代替`ArrayList`以提高类型安全性。

# linux-kernel - linux内核等待队列 - printk未显示在消息日志中

> ID：10687603
> 
> 赞同：3
> 
> 时间：2012-05-21T14:52:21.083
> 
> 标签：linux-kernel

我注意到内核模块中有一些奇怪的行为。当我运行以下代码（使用等待队列）时。在finish_wait() 之后，printk() 不会出现在内核日志中。第 5 行也只打印一次。有什么想法吗？

```
DEFINE_WAIT(wait);
DECLARE_WAIT_QUEUE_HEAD(wait_q);
flags |= O_NONBLOCK;
while (( err = kthread->sock->ops->accept(kthread->sock, kthread->sock_send, flags) ) < 0){
    printk("%s: before prepare_to_wait err = -%d\n", __func__,err);
    prepare_to_wait(&wait_q, &wait, TASK_INTERRUPTIBLE);
    if(kthread_should_stop()){
        printk("%s: killing thread\n", __func__);
        msleep(1000);   
        finish_wait(&wait_q, &wait);
        goto close_and_out;
    }
    schedule();
}
finish_wait(&wait_q, &wait);
printk("after finish wait: This doesn't show up in kernel logs...\n"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:31:26.760

将优先级添加到日志消息中：

喜欢： printk(KERN_ALERT 你的消息); KERN_ALERT 和您的消息之间也不会有“逗号”，如果不是 KERN_ALERT ，请尝试使用不同的 LEVELS 。

Rgds，软软的

# php - PHP：时差为三个时区的时间

> ID：10687609
> 
> 赞同：0
> 
> 时间：2012-05-21T14:52:33.267
> 
> 标签：php, time

我有一个我不知道如何解决的问题。这是示例：

```
$time_start = "13:30";
$time_finish = "03:00"; 
```

工人 13:30 开始工作，次日 3:00 结束。三个区域（收费不同）：6:00-13:59,14:00-21:59,22:00-5:59

我需要以小时为单位的输出，它会告诉我工人在哪个区域工作了多少小时。只需半个小时。

所以在这个例子中它将是：

> 第 1 区 - 0.5 , 第 2 区 - 8 , 第 3 区 - 5

我希望它可以理解。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:59:11.507

如下您可以计算时间差。

```
$t1=mktime(13,0,0,5,20,2012);
$t2=mktime(13,0,0,5,30,2012);

echo date("H:s:i", ($t2-$t1)); 
```

看看[http://php.net/manual/es/function.mktime.php](http://php.net/manual/es/function.mktime.php)

# c# - RadioButtonList 中 ListItems 的选项卡索引

> ID：10687610
> 
> 赞同：0
> 
> 时间：2012-05-21T14:52:34.757
> 
> 标签：c#, javascript, asp.net, html

是否可以为 RadioButtonList 中的 ListItems 设置选项卡索引。这是我的代码：

```
 <asp:RadioButtonList ID="radGender" runat="server">
      <asp:ListItem Value="M">Male</asp:ListItem>
      <asp:ListItem Value="F">Female</asp:ListItem>
      <asp:ListItem Value="U">Not Specified</asp:ListItem>
 </asp:RadioButtonList> 
```

谢谢， 普拉文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:01:35.040

有什么问题？

```
<asp:RadioButtonList ID="radGender" runat="server">
  <asp:ListItem Value="M" tabindex="1">Male</asp:ListItem>
  <asp:ListItem Value="F" tabindex="2">Female</asp:ListItem>
  <asp:ListItem Value="U" tabindex="3">Not Specified</asp:ListItem>
</asp:RadioButtonList> 
```

似乎至少在 IE9 和 FF 中工作（不确定与其他人）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:59:25.557

[选择时，ASP.Net 无法通过所有单选按钮进行选项卡](https://stackoverflow.com/questions/2103904/asp-net-cannot-tab-through-all-radio-buttons-when-selected)

和你类似的问题。这应该有助于满足您的需求，并解决您在选择单选按钮后遇到的问题。

编辑

只是为了指定他们的解决方案。似乎在选择了一个选项后，使用箭头键可以让您移动到选项卡不会的其他选项。解决此问题的另一个解决方案是使用单独的单选按钮并使用组名属性对它们进行分组。

# string - 迭代MATLAB中的字符串列表

> ID：10687611
> 
> 赞同：29
> 
> 时间：2012-05-21T14:52:43.577
> 
> 标签：string, matlab, loops

我正在尝试遍历 MATLAB 中的字符串列表。问题是，在“for”循环中，我的迭代器被认为是“单元格”而不是字符串。

```
for str = {'aaa','bbb'}
  fprintf('%s\n',str);
end

??? Error using ==> fprintf
Function is not defined for 'cell' inputs. 
```

解决此问题的正确\优雅方法是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-21T14:57:06.713

`str{1}`您应该通过如下方式调用单元格的内容以使其正确：

```
for str = {'aaa','bbb'}
  fprintf('%s\n',str{1});
end 
```

这是一个关于打印元胞数组内容的[更复杂的示例。](http://www.mathworks.com/help/techdoc/import_export/f5-15544.html#br2ypq2-1)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T15:01:20.990

```
str={'aaa','bbb'};
fprintf('%s\n',str{:}); 
```

不需要`for`循环。

编辑：另见：`cellfun`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-27T08:41:46.640

从 R2016b 开始，您可以使用[字符串数组](https://se.mathworks.com/help/matlab/ref/string.html)：

```
for str = ["aaa" "bbb"]
  fprintf('%s\n',str);
end 
```

# php - 从Objective c调用php函数

> ID：10687614
> 
> 赞同：0
> 
> 时间：2012-05-21T14:52:57.613
> 
> 标签：php, objective-c

我可以从 Objective-c 调用 Web 服务器中的 php 函数吗？我需要调用这个函数并传递变量。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-25T02:47:09.420

是的，您可以，您只需向服务器发出带有参数的获取请求，服务器端将获取参数`$_GET`然后处理它。

# php - 从Mysql DB中的文本字段中检索一段文本，直到找到一个特殊字符

> ID：10687618
> 
> 赞同：0
> 
> 时间：2012-05-21T14:53:03.873
> 
> 标签：php, mysql, sql, database

我想知道是否以及如何从 MSQL DB 的文本字段中检索部分文本数据。我可以在查询语句中使用什么 SQL 函数。

例如，我有一个包含如下数据的文本字段；

(firstname1,lastname1,23,,district1,state1,province1),(firstname2,lastname2,23,,district2,state2,province2), (firstname3,lastname3,23,,district3,state3,province3),...等

例如，我将如何选择一条数据从

"lastname1" to ")" 括号结束第一组。

我试图弄清楚我怎么能做到这一点，但仍然失败。问题是我不想检索文本字段中的所有数据......所以我想知道 MySQL 查询语句是否有帮助......

尽管我认为正则表达式在这种情况下会很有用，但我不知道如何构造它们，我是一个新的 Bi...请至少在这种情况下帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:01:14.657

也可以直接在 MYSQL 中进行。像这样的东西会起作用：

```
SELECT SUBSTR( YOUR_COLUMN, INSTR( YOUR_COLUMN,  'START_CHAR_GOES_HERE' ) , INSTR( YOUR_COLUMN,  'END_CHAR_GOES_HERE' ) - INSTR( YOUR_COLUMN,  'START_CHAR_GOES_HERE' ) ) 
FROM YOUR_TABLE 
```

参考： http: [//dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr) [http://dev.mysql.com/doc/refman/5.5/en/string-functions.html #function_instr](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_instr)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T14:58:47.140

在 mysql 中使用`locate()`,`substr()`和`char_length()`

也读[这个](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html)。

# java - 远程验证颠覆

> ID：10687626
> 
> 赞同：1
> 
> 时间：2012-05-21T14:53:33.547
> 
> 标签：java, svn, authentication, jenkins

我正在开发一个基于 java 的应用程序，它允许远程管理 jenkins 作业。

创建新作业时如何插入 svn 用户和密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:29:50.383

我不知道这样做的任何方法，但是您可以在成功验证一次后获得主缓存凭据。

这可以在以下位置找到：管理 Jenkins>配置系统>Subversion。只需选中指定“成功验证后更新默认 Subversion 凭据缓存”的框。

如果您有多个存储库，这将无济于事，但如果您的作业使用相同的存储库，那么您应该能够通过 api 创建一个新作业，而无需明确指定 SVN 凭据。

# import - 从父目录相对导入

> ID：10687627
> 
> 赞同：47
> 
> 时间：2012-05-21T14:53:35.490
> 
> 标签：import, go, relative-path

如何从父目录进行相对导入？

来自`meme/cmd/meme`：

```
import "../../../meme" 
```

这给出了一个模棱两可的错误：

```
matt@stanley:~/gopath/src/bitbucket.org/anacrolix/meme/cmd/meme$ go get bitbucket.org/anacrolix/meme/cmd/meme

can't load package: /home/matt/gopath/src/bitbucket.org/anacrolix/meme/cmd/meme/main.go:8:2: local import "../../../meme" in non-local package

matt@stanley:~/gopath/src/bitbucket.org/anacrolix/meme/cmd/meme$ echo $GOPATH

/home/matt/gopath 
```

如何从父目录本地导入？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-21T15:23:24.217

**编辑：**相对导入路径不是 Go 的方式。缺乏文档显示了相对路径的流行程度，我看不出使用它们的理由。Go 推荐的代码组织效果很好。每个包都应该有一个唯一的导入路径，并使用相同的导入路径*在任何地方导入。*

看看像这样的包是如何`github.com/ha/doozerd/peer` [导入它的邻居的](https://github.com/ha/doozerd/blob/master/peer/peer.go)。这是 Go 项目中的常见做法，我已经见过很多次了。包[`camlistore.org/pkg/auth`](http://camlistore.org/code/?p=camlistore.git;a=blob;f=pkg/auth/auth.go;h=30d4f8bcff2efb4fb6760c8f0842178c0ef5aa87;hb=HEAD)（也在[GitHub 上](https://github.com/bradfitz/camlistore/blob/master/pkg/auth/auth.go)；由 Go 的主要作者之一编写）`camlistore.org/pkg/netutil`按完整路径导入。

即使您在同一个项目中同时拥有命令和库，这种方法也有效。在您最初的问题中，您明智地要求最佳实践。我尽力解释了有关此问题的最佳实践。

* * *

~~导入路径在 Go 中不能是相对的。~~我推荐阅读[如何编写 Go 代码](http://golang.org/doc/code.html)，这是组织 Go 项目的基本读物。这是一个简短的概述：

`~/go`为您的 Go 开发创建一个目录。然后说：

```
$ export GOPATH=~/go
$ mkdir $GOPATH/{src,bin,pkg} 
```

`$GOPATH/src`包含所有 Go 包的源代码，即使是使用`go get`. `bin`并`pkg`保留编译的输出。具有包名的包`main`是命令并产生可执行二进制文件，这些二进制文件转到`$GOPATH/bin`. 其他包是库，它们的编译目标文件放在`$GOPATH/pkg`.

现在如果你把你的代码放进去`$GOPATH/src/matt/meme`，你就可以通过`import "matt/meme"`. 建议为您的包名称使用前缀，并为标准库保留简短的包名称。这就是为什么我使用`$GOPATH/src/matt/meme`而不是`$GOPATH/src/meme`.

围绕这个想法组织你的代码。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-05-22T19:29:36.280

感谢您添加问题。首先是一个答案，然后是一些解释。我通过以下方式构建了您的代码

1.  去拿，就像你拥有它一样。（我忽略了错误消息。）
2.  如您所愿，将导入行设置`main.go`回“../../../meme”。
3.  （注释掉一些包含未使用变量的代码。）
4.  然后在 meme/cmd/meme 目录中，`go run main.go`或者`go build main.go`工作。

当我说 go install 有效时，我之前的评论是错误的；我应该说去建造。

然而，关键是`go build`单独是行不通的。您必须键入`go build main.go`. 这是因为 go 命令不允许“在非本地包中进行本地导入”。你是对的，规范在这里没有什么帮助。它说，“ImportPath 的解释是依赖于实现的。” 当前的实现行为是使用[CL 5787055](http://codereview.appspot.com/5787055)设置的，随后在 Go-nuts 上进行[了详细讨论。](https://groups.google.com/d/topic/golang-nuts/1XqcS8DuaNc/discussion)

“本地”表示用文件系统相对路径表示。显然，以 .. 开头的相对路径是本地的，所以诀窍就是让`go`命令也将 main 视为本地包。它显然在您键入时不会这样做`go build`，但在您键入时会这样做`go build main.go`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T15:17:30.633

直接手动使用编译器、链接器等时支持相对导入。'go'（构建）工具不支持相同的（在某种程度上可与例如 Java 相媲美）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-10T14:52:40.487

这可能无法回答最初的问题，但是当我真的不需要时，我正在尝试执行上述操作，我需要做的就是`go.mod`暂时使用以下内容进行更新`replace`：

```
module github.com/pselle/foo

replace github.com/pselle/bar => /Users/pselle/Projects/bar

require (
    github.com/pselle/bar v1.0.0
) 
```

参考： [https ://thewebivore.com/using-replace-in-go-mod-to-point-to-your-local-module/](https://thewebivore.com/using-replace-in-go-mod-to-point-to-your-local-module/)

# azure - Windows Azure 服务总线队列：限制和 TOPAZ

> ID：10687628
> 
> 赞同：1
> 
> 时间：2012-05-21T14:53:38.157
> 
> 标签：azure, enterprise-library

今天在一个客户那里，我们分析了前几周的日志，我们发现了以下关于 Windows Azure 服务总线队列的问题：

> 由于实体受到限制，请求已终止。请等待 10 秒，然后重试。

在验证了代码后，我告诉他们使用瞬态故障处理应用程序块 (TOPAZ) 来实现这样的重试策略：

```
 var retryStrategy = new Incremental(5, TimeSpan.FromSeconds(1), TimeSpan.FromSeconds(2));
 var retryPolicy = new RetryPolicy<ServiceBusTransientErrorDetectionStrategy>(retryStrategy); 
```

客户回答：

> “啊，太好了，所以它还可以处理在节流时它应该等待 10 秒的事实。”

想一想，我从来没有验证过是否是这样。我一直以为是这样。在**Microsoft.Practices.EnterpriseLibrary.WindowsAzure.TransientFaultHandling**程序集中，我查找了在节流情况下会等待 10 秒但没有找到任何内容的代码。

这是否意味着 TOPAZ 不足以创建弹性应用程序？这是否应该与一些自定义代码结合使用来处理限制（即：在发生特定异常时等待 10 秒）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T12:49:31.030

就节流而言，[Topaz](http://aka.ms/topaz)提供了一组内置的重试策略，包括： - 固定间隔 - 增量间隔 - 随机指数回退间隔

您还可以编写自定义重试策略并将其插入 Topaz。

此外，正如布伦特所指出的，10 秒的等待不是强制性的。在许多情况下，立即重试可能会成功，无需等待。默认情况下，Topaz 在使用策略定义的重试间隔之前立即执行第一次重试。

有关更多信息，请参阅[“](http://msdn.microsoft.com/en-us/library/hh680901%28PandP.50%29.aspx)构建弹性和弹性云应用程序”开发人员指南的第 6 章，也可从[此处](http://go.microsoft.com/fwlink/?LinkID=234700)获取 epub/mobi/pdf 格式。

[如果您对 Topaz 有建议/功能请求，请通过uservoice](http://entlib.uservoice.com/forums/101257-windows-azure-integration-pack/)提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:59:54.657

我记得，“10 秒”等待不是必需的。此外，我相信 TOPAZ 还具有退避功能，可以帮助您克服困难。

就个人而言，我认为仅仅使用像 TOPAZ 这样的东西不足以创建一个真正有弹性的解决方案。弹性不仅仅是限制单个连接点，您还需要能够处理故障转移到 TOPAZ 不会做的冗余端点。

# service - 在后台运行 URL 作为服务

> ID：10687632
> 
> 赞同：0
> 
> 时间：2012-05-21T14:53:56.357
> 
> 标签：service, scripting, batch-file

我正在寻找一种方法来创建在特定时间在后台运行特定 URL 的文件。我将在计时器上运行服务，并且用户不会登录。基本上，服务器每天都会重新启动，我想在早上 6 点运行一个服务，它只是转到一个 URL（这将自动完成一些任务）。我在想批处理文件甚至 AHK ..但是有没有简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:56:26.000

将它包装在一个批处理文件中并创建一个 Windows 计划任务来执行它？

编辑：大量假设你在 Windows 中运行......但你明白了要点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:37:04.007

我的评论：您只是想打开一个本身启动某些任务的 URL？尝试将 iexplore.exe“您的网址”作为 Windows 任务？

添加：如果这不起作用，您可以在 vbscript 中编写一个小脚本，将其作为任务调度程序任务触发。这个脚本只是打开你的网址：

```
Dim l_lTimeoutResolve, l_lTimeoutConnect, l_lTimeoutSend, l_lTimeoutReceive, l_sUrl
l_lTimeoutResolve = 5000
l_lTimeoutConnect = 60000
l_lTimeoutSend    = 10000
l_lTimeoutReceive = 10000
l_sUrl            = "http://yoururl"

'Dim l_sRequestText : l_sRequestText = "stuff you want to send"
Dim l_oXML : Set l_oXML = CreateObject("MSXML2.ServerXMLHTTP")
l_oXML.setTimeouts l_lTimeoutResolve, l_lTimeoutConnect, l_lTimeoutSend, l_lTimeoutReceive
l_oXML.open "POST", l_sUrl, False
l_oXML.setRequestHeader "Content-Type", "text/xml"
' you can post data and als get a result then to write to a logfile e.g.
'l_oXML.send l_sRequestText
'l_sResponseText = l_oXML.responseText 
```

Pro 的 prolly 帖子说您最好将其作为 powershell .NET 脚本执行，但我现在从未习惯过。如果您想在 .NET 中进行编码（vbscript 在 Windows 2008 服务器上设置安全性有点棘手），那么最好在您刚开始的 .NET 中编写一个简单的 .exe 文件。

# json - JSON序列化/解析的时间复杂度

> ID：10687638
> 
> 赞同：3
> 
> 时间：2012-05-21T14:54:27.417
> 
> 标签：json, optimization, time, complexity-theory

我有一个项目使用 JSON 作为跨语言序列化来传递数据。最近数据的大小变得有点庞大（10k 长度的对象列表）。序列化数据需要 python 标准 json 库大约 20 秒。

我正在努力优化时间。虽然切换到其他 json 序列化程序（cjson、simplejson、ujson）可以加快速度，但我开始怀疑 JSON 序列化的时间复杂度。如果关系不是线性的（比如说如果它是 n^2），我可以轻松地将数据分成块并显着减少时间。

从我的猜测来看，复杂性应该真的取决于输入数据。但是是否有最坏情况/平均估计可用？参考链接也将受到高度赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:08:50.720

我用这段代码对时间复杂度进行了基准测试：

```
import json
import random
import time

Ns = 10, 100, 1000, 10000, 100000, 200000, 300000, 600000, 1000000
for N in Ns:
    l = [random.random() for i in xrange(N)]
    t0 = time.time()
    s = json.dumps(l)
    t1 = time.time()
    dt = t1-t0
    print "%s %s" % (N, dt) 
```

在我的机器上，结果是：

```
10 7.20024108887e-05
100 0.000385999679565
1000 0.00362801551819
10000 0.036504983902
100000 0.366562128067
200000 0.73614192009
300000 1.09785795212
600000 2.20272803307
1000000 3.6590487957 
```

第一列：列表长度；第二列：序列化时间。绘图（例如 xmgrace）揭示了理想的线性关系。

# java - 是否可以使用调用 Java 方法（回调）的 JNI 本机线程来更新 Swing UI 组件？

> ID：10687639
> 
> 赞同：2
> 
> 时间：2012-05-21T14:54:37.267
> 
> 标签：java, multithreading, swing, image-processing, java-native-interface

我正在开发一个使用 GStreamer 和 OpenCV 进行视频处理的应用程序。任务是从 OpenCV 源中获取图像，将它们推/拉到 GStreamer 管道中（进行转换和解码，稍后我必须流式传输视频数据）并在 Java 语言环境中处理图像。

所以我用 C 语言构建了一个本地框架来管理这个任务。现在我使用 JNI 访问我的 C-Library，并将正在执行的 GStreamer 主循环附加到 JVM。有些线程与我使用 SDL 库的图像处理无关，但没有调用任何 Java 方法。显然它到目前为止有效。我将原始图像导入 Java，我还可以使用`ByteBuffer`（在本机端创建的）`get`方法和`System.err.println`.

问题是在 GUI 中以某种方式显示这些图像。我将 Swing 框架用于我的图形环境。

因此，我像往常一样通过扩展 an 来制作一个快速而肮脏的图像视图，`JPanel`并且通常仅在我使用 Java 时才有效。

我重写了使用该方法`paint`绘制图像的`Graphics.drawImage`方法。图像是通过将原生回调传递的原始数据复制到一个整数数组中，然后将该整数数组分配给一个`MemoryImageSource`. 我使用`createImage`（JFrame 的）方法来获取`Image`对象。一切都返回显然有效的参考。没有异常被抛出。至少我看不到。

尝试了几种方法，并且`MemoryImageSource`到目前为止只对未生成的图像使用字节数组。但是数据在那里，我可以读取它！

我可以复制数据，显示字节数据，但我无法在我的自定义`JPanel`视图区域中显示可显示的图像。就像图像完全是黑色或透明的一样。

这个问题真的打败了我，我不知道如何说服这件事起作用。我认为这里的线程存在几个问题。但是对于这种特定情况，我没有更多资源。

我做错了什么，或者更好地如何以正确的方式去做。

**附加**：如果我更改窗口大小，应用程序有时也会崩溃或 GUI 冻结，所以我暂时避免这样做。因此，本机线程存在问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T09:03:55.060

我使用 OpenCV-Library 来访问安装在系统上的摄像头。我从每个抓取的帧中获取尺寸、颜色信息和 BGR-Samples，并让 GStreamer AppSrc 根据初始化整个事物的帧速率将图像拉入视频处理管道。初始管道如下所示：

OpenCV-Camera --> AppSrc --> VideoRate --> ffmpegcolorspace --> AppSink

它很快就会变得更加复杂，但现在这就是它的样子。

AppSink 在 Gstreamer“新缓冲区”信号上调用一个函数（其中一些与我的问题无关）。这些回调实现调用提供图像颜色和尺寸以及样本缓冲区的 Java 对象函数。所以这是关于我在做什么的简要信息。

现在我的问题：

看来我解决了我的问题。我现在使用另一种方式来创建我的图像，现在它可以工作了。

而不是像这样使用内存图像源：

```
//constructor, callback whatever
imageSource = new MemoryImageSource(data.width,data.height,rawdata,0,data.width);
...
//Paint method of a JFrame or what ever ...
...
image img = createImage(imageSource);
setBounds(100,100,img.getWidth(null),img.getHeight(null));
createBufferStrategy(2);

BufferStrategy strategy = getBufferStrategy();

Graphics gr = strategy.getDrawGraphics();           
gr.drawImage(img, 0, 0, null);
gr.dispose();

strategy.show(); 
```

我现在使用这几行适合我的行：

```
int[] nBits = {8, 8, 8};
ComponentSampleModel sampleModel = new ComponentSampleModel(DataBuffer.TYPE_BYTE, width, height, channels, width * channels, new int[] {2, 1, 0});
ColorSpace colorSpace = ColorSpace.getInstance(ColorSpace.CS_sRGB);
ColorModel colorModel = new ComponentColorModel(colorSpace, nBits, false, false,Transparency.OPAQUE,DataBuffer.TYPE_BYTE);

DataBufferByte db = new DataBufferByte(new byte[][] {buffer}, buffer.length);

WritableRaster raster = Raster.createWritableRaster(sampleModel, db, new Point(0, 0));
BufferedImage image = new BufferedImage(colorModel, raster, false, null); 
```

缓冲区在这里表示我通过从本机端调用的方法获得的原始字节样本数组。

我还遇到了其他几个使用 swing 的问题，例如冻结 UI 或抛出这些错误消息的崩溃：

```
[xcb] Unknown request in queue while dequeuing
[xcb] Most likely this is a multi-threaded client and XInitThreads has not been called
[xcb] Aborting, sorry about that.
java: ../../src/xcb_io.c:178: dequeue_pending_request: assertion »!xcb_xlib_unknown_req_in_deq« failed. 
```

这是因为我使用该`UIManager.setLookAndFeel()`方法将窗口外观设置为系统默认值。我没有将此与问题联系起来，因为如果您使用默认系统“外观和感觉”，我不知道 Swing 使用本机 UI 框架。删除它可以解决问题。我的研究将我带到了一个论坛[帖子](http://forum.ubuntuusers.de/topic/java-look-and-feel-uimanager-setlookandfeel-ui/#post-3965857)（德语），该帖子描述了这种情况仅发生在 Linux（Ubuntu）机器上的 Java（无本机部分）上，而相同的应用程序无需修改即可在 Windows 机器上运行。所以删除它解决了我的问题。我认为我的“图像未显示问题”与此有关，但我不知道，我不在乎，因为我现在工作。

# objective-c - Objective C 中的对象类型转换

> ID：10687643
> 
> 赞同：1
> 
> 时间：2012-05-21T14:54:46.257
> 
> 标签：objective-c, types, casting

因此，Objective C 中的对象类型转换不是一个好的做法（不是一个好的设计），只有在真正需要时才必须使用它。对或错 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:06:04.000

类型转换目标 c 对象根本不起作用，因为没有像 c++ 中那样重载转换运算符。所以基本上你只能安全地对具有公共超类的对象进行类型转换，例如 NSMutableString 和 NSString 等。

但你不需要这样做。

通常不需要对 objc 对象进行类型转换。

# jquery - jQuery将相同的功能设置为不同的动作

> ID：10687644
> 
> 赞同：0
> 
> 时间：2012-05-21T14:54:49.700
> 
> 标签：jquery, html

我有很多动作应该具有相同的功能

```
<ul>
    <li>
        <select id="s1">
            <option>Name</option>
            <option>Year</option>
        </select>
    </li>
    <li>
        <select id="s2">
            <option>Day</option>
            <option>Month</option>
        </select>
    </li>
</ul> 
```

并且该选择器的 jQuery 调用是

```
$(document).ready(function(){
    $("#s1").on('change',function(){
        var value = $("#s1").val();
        alert(value);
    });
    $("#s2").on('change',function(){
        var value = $("#s2").val();
        alert(value);
    });
}); 
```

看电话，它们是一样的，我怎么能把它们作为一个电话？ [代码](http://jsfiddle.net/WHmGj/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:56:47.187

尝试这个：

```
$("#s1, #s2").on('change', function() {
    var value = this.value; // use native code where possible
    alert(value);
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T14:56:00.667

对于你所拥有的，你可以像下面这样写，

```
$("#s1m, #s2").on('change',function(){
    var value = $(this).val(); //Note using this
    alert(value);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T14:56:42.017

这应该有效：

```
$(function() {
    $("#s1, #s2").on("change", function() {
        var value = $(this).val();
        alert(value);
    });
}); 
```

用于`this`获取当前关注的对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T14:56:51.563

试试这个-->

```
$(document).ready(function(){
$("#s1, #s2").on('change',function(){
        var value = $(this).val();
        alert(value);
    });
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T15:05:29.460

这应该有帮助

```
$("#s1, #s2").on('change',function(){
    var value = $(this).val();
    alert(value);
}); 
```

if `'#s1`' 触发该函数，因此`$(this)`引用 select 标记`'#s1'`，因此该语句`var value = $(this).val()`将为您提供 select 中的选定选项`'#s1'`

和选择相同的东西`'#s2'` [看到这个](http://jsfiddle.net/WHmGj/5/)

# mongodb - 如何使用 php 计算 mongo 集合中的文档元素？

> ID：10687650
> 
> 赞同：2
> 
> 时间：2012-05-21T14:55:01.797
> 
> 标签：mongodb, mongodb-query, nosql

我有一个 mongo 文档的以下结构：

```
{
 "_id": ObjectId("4fba2558a0787e53320027eb"),
 "replies": {
    "0": {
      "email": ObjectId("4fb89a181b3129fe2d000000"),
      "sentDate": "2012-05-21T11: 22: 01.418Z" 
    } 
    "1": {
     "email": ObjectId("4fb89a181b3129fe2d000000"),
     "sentDate": "2012-05-21T11: 22: 01.418Z" 
    } 
    "2" ....
 }

} 
```

如何计算集合中所有文档的所有回复？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:12:01.433

在以下答案中，我正在使用一个简单的数据集，该数据集在整个集合中有五个回复：

```
> db.foo.find()
{ "_id" : ObjectId("4fba6b0c7c32e336fc6fd7d2"), "replies" : [ 1, 2, 3 ] }
{ "_id" : ObjectId("4fba6b157c32e336fc6fd7d3"), "replies" : [ 1, 2 ] } 
```

因为我们不是简单地计算文档，所以[db.collection.count()](http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Count)在这里帮不了我们。我们需要[借助 MapReduce](http://www.mongodb.org/display/DOCS/MapReduce)来扫描每个文档并聚合回复数组的长度。考虑以下：

```
db.foo.mapReduce(
    function() { emit('totalReplies', { count: this.replies.length }); },
    function(key, values) {
        var result = { count: 0 };
        values.forEach(function(value) {
            result.count += value.count;
        });
        return result;
    },
    { out: { inline: 1 }}
); 
```

map 函数（第一个参数）在整个集合中运行，并在一个常量键下发出每个文档中的回复数。然后，Mongo 将考虑所有发出的值并多次运行 reduce 函数（第二个参数）以合并（字面意义上的 reduce）结果。希望这里的代码很简单。如果您不熟悉 map/reduce，需要注意的一点是 reduce 方法必须能够处理自己的输出。这在上面链接的 MapReduce 文档中有详细说明。

注意：如果你的集合非常大，你可能不得不使用另一种输出模式（例如集合输出）；但是，`inline`它适用于小型数据集。

最后，如果您使用的是 MongoDB 2.1+，我们可以利用[Aggregation Framework](http://www.mongodb.org/display/DOCS/Aggregation+Framework)来避免编写 JS 函数并使这变得更加容易：

```
db.foo.aggregate(
    { $project: { replies: 1 }},
    { $unwind: "$replies" },
    { $group: {
        _id: "result",
        totalReplies: { $sum: 1 }
    }}
); 
```

这里正在发生三件事。首先，我们告诉 Mongo 我们对该`replies`领域感兴趣。其次，我们想要展开数组，以便我们可以遍历投影中跨字段的所有元素。最后，我们将在“结果”桶下汇总结果（任何常量都可以），并添加`1`到`totalReplies`每次迭代的结果中。执行此查询将产生以下结果：

```
{
    "result" : [{
        "_id" : "result",
        "totalReplies" : 5
    }],
    "ok" : 1
} 
```

虽然我写了上面关于 Mongo 客户端的答案，但你应该可以毫不费力地将它们翻译成 PHP。您需要使用[MongoDB::command()](http://php.net/manual/en/mongodb.command.php)来运行 MapReduce 或聚合查询，因为 PHP 驱动程序目前没有任何帮助方法。PHP 文档中目前有一个 MapReduce 示例，您可以参考[此 Google 组帖子](https://groups.google.com/d/topic/mongodb-user/Ct7grUaxT7Q/discussion)以通过相同的方法执行聚合查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T09:23:37.653

I've did it again using the group command of the PHP Mongo Driver. It's similar to a MapReduce command.

```
$keys = array("replies.type" => 1); //keys for group by
$initial = array("count" => 0); //initial value of the counter
$reduce = "function (obj, prev) { prev.count += obj.replies.length; }";
$condition = array('replies' => array('$exists' => true), 'replies.type' => 'follow');
$g = $db->foo->group($keys, $initial, $reduce, $condition);
echo $g['count']; 
```

Thanks jmikola for giving links to Mongo.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:44:28.377

我还没有检查你的代码，可能也可以。我做了以下，它只是工作：

```
$replies = $db->command(
   array(
       "distinct" => "foo",
       "key" => "replies"
        ) 
   );
$all = count($replies['values']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-28T22:49:16.900

JSON应该是

```
{
  "_id": ObjectId("4fba2558a0787e53320027eb"),
  "replies":[
             {
             0: {
                     "email": ObjectId("4fb89a181b3129fe2d000000"),
                     "sentDate": "2012-05-21T11: 22: 01.418Z" 
                 }, 
             1: {
                     "email": ObjectId("4fb89a181b3129fe2d000000"),
                     "sentDate": "2012-05-21T11: 22: 01.418Z" 
                }, 
             2: {....}
           ]

} 
```

# android - 想要在 android 中显示来自 RSSFeed 的印度地区语言（泰卢固语、印地语、泰米尔语和马拉雅拉姆语）的数据？

> ID：10687653
> 
> 赞同：3
> 
> 时间：2012-05-21T14:55:13.413
> 
> 标签：android, android-intent, indic

我正在为报纸开发应用程序。我想从 RSSfeed 获取数据，并且想以 ListView 方式使用区域语言显示数据。这怎么能在android中完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:13:16.273

您需要为一种语言使用特定的字体。在 android ListView 中检查[自定义字体](https://stackoverflow.com/questions/4576441/custom-font-in-android-listview)

* * *

## 将自定义字体设置为 TextView 的代码：

假设您在**assets**文件夹下的**fonts文件夹中有****your_font.ttf**字体：

 ****```
 Typeface tf = Typeface.createFromAsset(getAssets(), "fonts/your_font.ttf");               
    TextView tv = (TextView) findViewById(R.id.CustomFontText);
    tv.setTypeface(tf); 
```****

# ruby-on-rails - Ruby on rails rake 任务不返回最新的模型信息

> ID：10687654
> 
> 赞同：1
> 
> 时间：2012-05-21T14:55:19.700
> 
> 标签：ruby-on-rails, ruby, scheduled-tasks, rake-task

在构建计费系统时，我遇到了以下问题：

在 scheduler.rake ：

```
@users.each do |user|
begin
  puts "CALCULATING COSTS =========="
  costs = user.total_billable_price_per_month(Time.now)
  lead_count = user.total_billable_leads_count(Time.now)
  click_count = user.total_billable_clicks_count(Time.now)

  puts "CREATING NEW INVOICES ======="
  @invoice = user.invoices.new

  # if user.free_credits
  #         invoice.total_price_in_cents = 0
  #       else
  #         invoice.total_price_in_cents = costs.cents
  #       end

  @invoice.total_leads = lead_count
  @invoice.total_clicks = click_count
  @invoice.total_price_in_cents = costs.cents

  # Als de vorige factuur onder de 10 euro was, dan geld bij huidige factuur optellen
  if user.invoices.last && user.invoices.last.total_price_in_cents < 1000
    puts "Bedrag onder 10 euro"
    puts "Last invoice = #{user.invoices.last.total_price_in_cents}"
    @invoice.total_price_in_cents += user.invoices.last.total_price_in_cents
  end

  puts "SAVING INVOICE FOR #{user.name} with ID = #{user.id}"
  # Factuur saven
  @invoice.save

  #Als de factuur hoger of gelijk is als 10euro, dan factuur aanmaken
  if @invoice.total_price_in_cents >= 1000
    #Moneybird factuur versturen
    puts "COSTS ARE HIGHER THAN 10 EURO, CREATING MONEYBIRD INVOICE"

    moneybird_invoice = MoneybirdInvoice.new
    sleep(15)
    moneybird_invoice.contact_id = MoneybirdContact.find_by_customer_id(user.id).id
    sleep(15)
    moneybird_invoice.details_attributes = [
         { :description => "Aantal leads", :amount => lead_count, :price => user.lead_price.cents.to_f/100},
         { :description => "Aantal clicks", :amount => click_count, :price => user.click_price.cents.to_f/100}
    ]

    puts "TRYING TO SAVE MONEYBIRD INVOICE"
    if moneybird_invoice.save && moneybird_invoice.put(:send_invoice)
      puts "SUCCESFULLY SAVED INVOICE"
      #GET UPDATED PAY URL
      @sent_mb_invoice =  MoneybirdInvoice.get(moneybird_invoice.id)
      sleep(15)
      @invoice.update_attributes(:moneybird_invoice_id => @sent_mb_invoice['invoice_id'], :moneybird_pay_url => @sent_mb_invoice['pay_url'])
    else
      puts "MONEYBIRD INVOICE FAILED"
      puts moneybird_invoice.errors.inspect
    end
  else
    # GEEN MONEYBIRD FACTUUR AANMAKEN
  end

rescue
  puts "ER IS IETS FOUT GEGAAN MET FACTUREREN USER ID = #{user.id} & NAME = #{user.name}"
  puts @invoice.errors.inspect
end
end 
```

这段代码应该在每次运行 rake 任务时不断增加，除非总量达到 > 1000。

```
if user.invoices.last && user.invoices.last.total_price_in_cents < 1000
  puts "Bedrag onder 10 euro"
  puts "Last invoice = #{user.invoices.last.total_price_in_cents}"
  @invoice.total_price_in_cents += user.invoices.last.total_price_in_cents
end 
```

上面的代码总是把“Last invoice = 100”=> 每次运行 rake 任务时都会增加

每张新发票仍然具有相同的 total_price_in_cents （当我期望它应该增加时）。

到底是怎么回事 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:58:09.973

编辑：在代码更新后添加：

在您更新的代码中，看起来您在调用 user.invoices.new 之后调用了 user.invoices.last，这就是为什么它总是返回相同的值。

在调用 user.invoices.new 之前创建一个变量 @last_invoice = user.invoices.last。

原始答案：

`save`在您的原始代码发布中，您的调用似乎`@invoice`发生在循环之外——我相信您只保存了一次。

```
task :create_invoices => :environment do  

  # Begin the loop for each use
  User.all.each do |user|
    @invoice = user.invoices.build
    #If last bill < 1000
    if user.invoices.last && user.invoices.last.total_price_in_cents < 1000

      puts "Last invoice = #{user.invoices.last.total_price_in_cents}"
      @invoice.total_price_in_cents += user.invoices.last.total_price_in_cents
      @invoice.save

    end # end 'if' statement
  end # end loop for all users
end # end task definition 
```

因此，您循环遍历 users 表，但从不保存更新 - 除了您退出循环后的最后一次

# wpf - 带有文本和图像的 Wpf ListBox

> ID：10687658
> 
> 赞同：1
> 
> 时间：2012-05-21T14:55:30.713
> 
> 标签：wpf, image, listbox

我需要创建一个以字符串和图像为元素的排序列表（一些项目是文本，其他 - 图像）。我必须从后面的代码中配置此列表，而不是在 xaml 中。我创建了一个类：

```
public class SimpleChoicePair
{
    public SimpleChoice Choice { get; set; }
    public FrameworkElement Content { get; set; }
} 
```

作为内容，我有 TextBlock 或 Image 对象。我的列表框看起来像：

```
var listboxChoices = new ListBox(); 
```

var list = new ObservableCollection();

listboxChoices.DisplayMemberPath = "内容";

listboxChoices.ItemsSource = 选择列表；

但列表中的项目只显示 TextBlock 或 Image 的类名。如何显示 uiElements 本身？谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:12:19.363

如果我是对的，您正在根据您的内容查找 itemtemplateselector，例如，如果内容类型文本则显示文本框，或者如果其图像类型则显示图像。见下面的例子。

[http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector.aspx)

[http://www.switchonthecode.com/tutorials/wpf-tutorial-how-to-use-a-datatemplateselector](http://www.switchonthecode.com/tutorials/wpf-tutorial-how-to-use-a-datatemplateselector)

# image - cakephp 2.1 显示 habtm 列表复选框及其分配的图像

> ID：10687662
> 
> 赞同：1
> 
> 时间：2012-05-21T14:55:48.920
> 
> 标签：image, cakephp, checkbox, has-and-belongs-to-many

召集所有 Cakephp 大师！

好吧，这个真的让我觉得又短又卷。

我在表格中有一个 habtm 列表。添加（add.ctp）时，我想显示多个复选框及其图像引用（图像字段名称）。实际插图是需要看到的，以便做出选择。我不需要图像来激活复选框。我只需要显示带有图像的复选框并选择复选框就可以了。

如果有人遇到过这样的问题并提出了解决方案，请告诉。

下面是一个例子

亲切的问候。

```
<?php echo $this->Form->input('ListShExPainImage', array(
        'label' => false, 'multiple' => 'checkbox'));?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:08:22.707

$this->Form->input('ListShExPainImage', array('label' => false, 'type' => 'select', 'multiple' => 'checkbox'));

# java - 如何获取 Alfresco Action 状态

> ID：10687676
> 
> 赞同：0
> 
> 时间：2012-05-21T14:56:43.777
> 
> 标签：java, alfresco

我有个问题。我有 Alfresco 4。我正在为我的特定文件夹创建一个规则（用于 INBOUND、OUTBOUND、UPDATE）和操作。但是当我在我的 java 类（从 ActionExecuterAbstractBase 扩展）中挂钩操作时，我不知道如何获取节点的状态（发生了什么 - 删除、修改或创建的节点）。解决此问题的一种方法是比较节点的 upload_date 和 modified_date 属性。但这并不好。如果有人知道怎么做，请回答。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T08:06:44.750

2 种方法来做到这一点：1）创建 3 个类，它们由正确的类型触发。

2）我只想为您的操作添加一个额外的参数，例如状态。并在入站规则设置入站等。然后您可以阅读 action.getParameterValue （查看[自定义操作 Wiki](http://wiki.alfresco.com/wiki/Custom_Actions)）。

# git - 将一个暂存文件与一个在存储中的文件进行比较

> ID：10687682
> 
> 赞同：3
> 
> 时间：2012-05-21T14:57:01.330
> 
> 标签：git, git-diff, git-stash, git-stage

是否有用于比较来自 git stash 的文件的 --staged（又名 --cached）选项？

在这里，我将最近的提交与暂存文件进行比较（我使用显式的 @{} 语法，但我知道可以推断出 @{0}）：

```
git diff stash@{0}:spec/blueprints.rb HEAD:spec/blueprints.rb 
```

在这里，我将隐藏的文件与磁盘上的文件进行比较：

```
git diff stash@{0}:spec/blueprints.rb spec/blueprints.rb 
```

我如何将当前上演的内容与隐藏的内容进行比较？这不起作用：

```
git diff --staged stash@{0}:spec/blueprints.rb spec/blueprints.rb 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T15:30:17.477

`git diff --cached 'stash@{0}' -- spec/blueprints.rb`

... 可能不需要引号，但您永远不知道您的外壳如何让您感到惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:05:04.693

> `:<n>:<path>, e.g. :0:README, :README`
> 
> 一个冒号，可选地后跟一个阶段号（0 到 3）和一个冒号，后跟一个路径，在给定路径的索引中命名一个 blob 对象。缺少的阶段编号（及其后面的冒号）命名阶段 0 条目。在合并期间，阶段 1 是共同祖先，阶段 2 是目标分支的版本（通常是当前分支），阶段 3 是正在合并的分支的版本。

来自[git help rev-parse](http://man.github.com/git/git-rev-parse.html)

# user-interface - 鼠标（左/中/右键）用ui自动化框架调用？

> ID：10687684
> 
> 赞同：0
> 
> 时间：2012-05-21T14:57:18.090
> 
> 标签：user-interface, frameworks, automation, click, mouse

使用 ms ui 自动化框架，我们可以使用 InvokePattern 调用例如按钮：

```
InvokePattern invokePattern = ae.GetCurrentPattern(InvokePattern.Pattern) as InvokePattern;
invokePattern.Invoke(); 
```

但是有没有办法使用自动化框架来模拟例如右键单击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-05-11T18:48:06.287

我从来没有找到使用 UIAutomation 在按钮上执行鼠标右键单击的直接方法，但这是我的工作。

```
[DllImport("user32.dll", EntryPoint = "SetCursorPos")] 
```

[return: MarshalAs(UnmanagedType.Bool)] private static extern bool SetCursorPos(int X, int Y);

```
 Rect BoundingRect = (Rect)aeButton.GetCurrentPropertyValue(AutomationElement.BoundingRectangleProperty);
      Mouse.MouseRightClick(BoundingRect);

    public void MouseRightClick(System.Windows.Rect BoundingRectangle)
    {
        int X = (int)BoundingRectangle.Left + ((int)(BoundingRectangle.Right - BoundingRectangle.Left) / 2);
        int Y = (int)BoundingRectangle.Top + ((int)(BoundingRectangle.Bottom - BoundingRectangle.Top) / 2);
         MouseClick(MOUSEEVENTF_RIGHTDOWN, MOUSEEVENTF_RIGHTUP,X, Y);
    }
    protected void MouseClick(uint ButtonDown, uint ButtonUp, int X, int Y)
    {
        try
        {
            SetCursorPos(X, Y);
            //Call the imported function with the cursor's current position
            mouse_event(ButtonDown | ButtonUp, X, Y, 0, 0);
        }
        catch (Exception e)
        {
            throw new InvalidOperationException("MouseClick", e);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:10:19.350

也许这样：[http ://bytes.com/topic/c-sharp/answers/268148-c-equivalent-javas-robot-class](http://bytes.com/topic/c-sharp/answers/268148-c-equivalent-javas-robot-class)

是你在找什么？

# silverlight - Silverlight 数据网格模板列

> ID：10687687
> 
> 赞同：0
> 
> 时间：2012-05-21T14:57:23.057
> 
> 标签：silverlight, datagrid, datagridtemplatecolumn

我对 Silverligt 5 和 xaml 还很陌生，我遇到了一个问题。我有一个包含模板列的数据网格。该模板包含一堆 TextBlock、图像和其他控件。我通过使用 VisualStateManager 覆盖网格/行/单元格样式来自定义网格的外观。更改例如 MouseOver 上的行背景和边框时，一切正常。但是，我没有找到一种方法来更改列模板中的一个 TextBlocks 的前景色。所以我不是试图设置它自己的单元格的前景，而只是为列模板中的许多控件（一个 TextBlock）之一。当用户悬停在网格行时，我希望 - 除了更改整行的背景之外，还要更改此特定 TextBlock 的前景色。

希望这是有道理的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T08:11:49.853

您需要`DataGridColumnHeader`在这里定义模板样式：[MSDN](http://msdn.microsoft.com/en-us/library/cc278066%28v=vs.95%29.aspx)

# c# - 有没有更好的方法来检查某个记事本文件是否已打开？

> ID：10687691
> 
> 赞同：1
> 
> 时间：2012-05-21T14:57:38.850
> 
> 标签：c#, winapi, process

我目前的工作：

-在不同的线程中工作-

```
while (true)
{
  foreach (Process myProc in Process.GetProcessesByName("Notepad"))
  {
    if (myProc.MainWindowTitle.Contains("*MyTitle*"))
    {
      Process.GetCurrentProcess().Kill();
    }
  }
  Thread.Sleep(500);
} 
```

这种方法的问题是，当我在 TaskManager 中运行时，启动时的内存使用量大约为 6000，然后在 5 秒内上升到 9000，然后下降到 6000。我猜问题出在`Thread.Sleep()`.

我想要的是稳定的东西，它检查某个记事本标题是否已打开，以及它是否已关闭应用程序。

您也可以给我 C++ 提示，因为我可以通过 PInvoke 调用非托管。

# c# - 当 GC 删除类时，它只处理事件

> ID：10687692
> 
> 赞同：0
> 
> 时间：2012-05-21T14:57:43.340
> 
> 标签：c#, garbage-collection

我使用 MVP 设计模式创建 Windows 窗体应用程序。例子：

```
IViewInterface view = new FormSome();
IPresenter presenter = new Presenter(view); 
```

在演示者构造函数中，我执行以下操作：

```
public Presenter( IViewInterface view ) {
    this.view = view;

    this.view.someEvens += myMethod;
} 
```

现在我的问题是：当我做这样的事情时会发生什么：

```
IViewInterface view;
{
    view = new FormSome();
    IPresenter presenter = new Presenter(view);
}
// if my presenter exists here? 
```

我不想显式地调用演示者的任何方法。我只想让我的演示者处理视图的事件。GC 是从内存中删除我的 Presenter，还是 GC 知道我的 Presenter 处理视图事件，所以只要视图存在，我的 Presenter 也会存在？

# 编辑

我测试了它并且它有效。但我不确定它是否有效，因为 GC 还没有破坏我的演示者，或者 GC 比我想象的更聪明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:07:33.723

演示者仍将保持“活动”状态，因为它通过此处设置的事件被引用

```
this.view.someEvens += myMethod; 
```

如果视图被 GC 收集，那么 Presenter 也会被销毁。

But please note that you do not have a reference to the presenter at the moment! You can not access it anymore after the code snipped you've posted.

**EDIT**
This, by the way, happened to be a problem for me when I thought I had destroyed all instances of a class, but they were still active because I had accidentially used them as event targets. I had TCP commands being handled even though they shouldn't have been handled.

That's why I can tell that what you're asking is actually the case :-)

# c# - 在 C# 中设计全屏应用程序的最佳方法是什么？

> ID：10687693
> 
> 赞同：1
> 
> 时间：2012-05-21T14:57:54.527
> 
> 标签：c#, controls

我想知道设计全屏表单的最佳方式，例如以一种在用户分辨率不同时不会弄乱的方式定位控件。

这是我的全屏代码：

```
int w = Screen.PrimaryScreen.Bounds.Width;
int h = Screen.PrimaryScreen.Bounds.Height;

this.Location = new Point(0, 0);
this.Size = new Size(w, h); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:03:29.500

锚和码头。

Anchor 将绑定控件。Dock 属性设置它如何扩展/收缩。

因此，如果您将按钮锚分配给“顶部，左侧”，则它的大小和位置将锁定在这些侧面。因此，如果您将窗体窗口拖得更宽，对象将向右和向下扩展。

# php - PHP 未定义索引错误。怎么修？

> ID：10687694
> 
> 赞同：0
> 
> 时间：2012-05-21T14:57:54.370
> 
> 标签：php

> **可能重复：**
> [PHP：“注意：未定义的变量”和“注意：未定义的索引”](https://stackoverflow.com/questions/4261133/php-notice-undefined-variable-and-notice-undefined-index)

我收到此通知：

> PHP 通知：未定义索引：第 2 行 /home/.../savevote.php 中的 votefor

我怎样才能解决这个问题？

这是我在 savevote.php 中的第 2 行：

```
<?php
  $votefor = $_REQUEST["votefor"]; 
```

谢谢

这是代码：

```
<?php
  $votefor = $_REQUEST["votefor"];

  // Returns a random RGB color (used to color the vote bars)
  function getRandomColor()
  {
       $r = rand(128,255); 
       $g = rand(128,255); 
       $b = rand(128,255); 
       $color = dechex($r) . dechex($g) . dechex($b);
       echo "$color";
  }
  //Get the IP of the user
  $domain = $_SERVER["REMOTE_ADDR"];
  $today = date("m/d/Y");

  echo "<table id=\"tblResults\" align=\"center\">";

  //If votefor is null, then we're just viewing results, so don't log the IP
  if ($votefor != "")
  {

    //Load the addresses XML file
    $doc = new DOMDocument();
    $doc->load("../vote_dir/xml/addresses.xml");
    $addresses = $doc->getElementsByTagName("address");
    $pVoted = false;
    $pFound = false;

    //Loop through the addresses nodes and see if the person has voted before
    foreach( $addresses as $address )
    {
    $lastvisits = $address->getElementsByTagName("lastvisit");
    $lastvisit = $lastvisits->item(0)->nodeValue;

    $ips = $address->getElementsByTagName("ip");
    $ip = $ips->item(0)->nodeValue;

    if ($ip == $domain)
    {
         $pFound = true;
         if ($lastvisit == $today)
              $pVoted = true;
         else
         {
        $lastvisits->item(0)->nodeValue = $today;
        $doc->save("../vote_dir/xml/addresses.xml");
         }
         break;
    }
    else
         continue;
    }

    if ($pVoted == true) //Already voted
    {
        echo "<tr><td colspan=\"3\" class=\"message\">Έχετε ήδη ψηφίσει!</td></tr>";
    }
    else //Update the XML files
    {
    if ($pFound == false) //Add new node for IP and date to addresses.xml
    {
         echo "<tr><td colspan=\"3\" class=\"message\">Ευχαριστούμε που ψηφίσατε!</td></tr>";

         $newAddy = $doc->getElementsByTagName('addresses')->item(0);
         $newAddressElement = $doc->createElement('address');

         $newLastVisitElement = $doc->createElement('lastvisit');
         $newAddressElement->appendChild($newLastVisitElement);
         $newIPElement = $doc->createElement('ip');
         $newAddressElement->appendChild($newIPElement);

         $dayvalue = $doc->createTextNode($today);
         $dayvalue = $newLastVisitElement->appendChild($dayvalue);

         $ipvalue = $doc->createTextNode($domain);
         $ipvalue = $newIPElement->appendChild($ipvalue);

         $newAddy->appendChild($newAddressElement);

         $doc->save("../vote_dir/xml/addresses.xml");
    }
    else
    {
         echo "<tr><td colspan=\"3\" class=\"message\">Ευχαριστούμε για την ψήφο σας.</td></tr>";
    }
    // Update the vote
    $doc = new DOMDocument();
    $doc->load("../vote_dir/xml/results.xml");
    $pollitems = $doc->getElementsByTagName("pollitem");
    foreach( $pollitems as $pollitem )
    {
        $entries = $pollitem->getElementsByTagName("entryname");
        $entry = $entries->item(0)->nodeValue;
        if ($entry == $votefor)
        {
             $votes = $pollitem->getElementsByTagName("votes");
             $count = $votes->item(0)->nodeValue;
             $votes->item(0)->nodeValue = $count + 1;
             break;
        }
    }
    $doc->save("../vote_dir/xml/results.xml");
    }
  }
  else
  {
     echo "<tr><td colspan=\"3\" class=\"message\">Αποτελέσματα Ψηφοφορίας Μέχρι Στιγμής</td></tr>";
  }

  // Get max vote count
  $doc = new DOMDocument();
  $doc->load("../vote_dir/xml/results.xml");
  $maxvotes = 0;
  $pollitems = $doc->getElementsByTagName("pollitem");
  foreach( $pollitems as $pollitem )
  {
    $votes = $pollitem->getElementsByTagName("votes");
    $vote = $votes->item(0)->nodeValue;
    $maxvotes = $maxvotes + $vote;
  }
  // Generate the results table
  $doc = new DOMDocument();
  $doc->load("../vote_dir/xml/results.xml");
  $pollitems = $doc->getElementsByTagName("pollitem");
  foreach( $pollitems as $pollitem )
  {
    $entries = $pollitem->getElementsByTagName("entryname");
    $entry = $entries->item(0)->nodeValue;
    $votes = $pollitem->getElementsByTagName("votes");
    $vote = $votes->item(0)->nodeValue;
    $tempWidth = $vote / $maxvotes;
    $tempWidth = 300 * $tempWidth;
    $votepct = round(($vote / $maxvotes) * 100);
    echo "<tr><td width=\"20%\" class=\"polls\">$entry</td>";
    echo "<td width=\"30%\" class=\"resultbar\"><div class=\"bar\" style=\"background-color: ";
        getRandomColor();
        echo "; width: $tempWidth px;\">$votepct%</div></td><td width=\"20%\">($vote votes)</td></tr>";
  }
  echo "<tr><td class=\"total\" colspan=\"3\">$maxvotes άτομα ψήφισαν μέχρι τώρα.</td>";
  echo "</table>";
?> 
```

@布莱恩

```
<script language="javascript">
         function setVote(voteName)
         {
            document.getElementById("votefor").value = voteName;
         }
         function confirmSubmit() 
         { 
        if (document.getElementById("votefor").value == "")
        {
             var agree=confirm("Παρακαλώ επιλέξτε μια απάντηση, για να ψηφίσετε"); 
             return false; 
        }
         } 
    </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:03:02.760

请求参数没有被传递。如果您知道为什么它可能会丢失并且只是想阻止通知，您可以说：

```
$votefor = isset( $_REQUEST["votefor"] ) ? $_REQUEST["votefor"] : null; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:04:15.577

使用它是不安全的，`$_REQUEST`因为它可以是`$_GET`or `$_POST`，更好的是指定您想要的。

其次，您需要检查数组键是否存在。这可以通过[`array_key_exists()`](http://php.net/array-key-exists). 但不幸的是，这个功能有点慢。您可以使用该[`isset()`](http://php.net/isset)函数替换它，但这表示`null`未设置值并`false`在它为空时返回。最好的方法是同时使用它们，首先是`isset`，然后是`array_key_exists`：

```
<?php
if (isset($_POST['votefor']) || array_key_exists($_POST['votefor'])) {
    // do something
}
?> 
```

或者仅`isset`在您确定该值不会为`null`.

* * *

如果您几乎 100% 确定`votefor`数组中存在索引，则需要对其进行调试。[`var_dump`](http://php.net/var-dump)数组以查看其中有`$_REQUEST`哪些项目（和索引）并查看您做错了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:02:03.387

像这样处理它：

```
if(array_key_exists("votefor", $_REQUEST)) {
...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T14:59:46.743

1/ 检查你有一个名为的请求参数`votefor`

2/ 检查你没有拼错

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-05-21T15:01:50.017

您可以通过设置 error_reporting no 来忽略通知报告以显示它们

`error_reporting(E_ALL & ~E_NOTICE);`

# excel - 无法将 MS Access 查询与子查询链接

> ID：10687703
> 
> 赞同：1
> 
> 时间：2012-05-21T14:58:29.720
> 
> 标签：excel, ms-access

我在 Access 中创建了一个带有子查询的查询，但无法在 Excel 2003 中链接它：当我使用菜单`Data`-> `Import External Data`->`Import Data...`并选择 mdb 文件时，列表中不存在该查询。如果我使用菜单`Data`-> `Import External Data`-> `New Database Query...`，我可以在列表中看到我的查询，但在导入向导结束时我收到此错误：

```
Too few parameters. Expected 2. 
```

我的猜测是查询语法导致了问题，实际上查询包含一个子查询。因此，我将尝试描述查询目标和生成的语法。

**表位置**

*   ID（自动编号，主键）
*   位置（双）
*   currency_id (long) (参考 Currency.ID)
*   投资组合（长）

**表币种**

*   ID（自动编号，主键）
*   代码（文本）

**查询目标**

*   加入2张桌子
*   按投资组合过滤 = 1
*   按 ("A", "B") 中的货币.code 过滤
*   按货币分组并计算每个货币组的头寸总和并调用结果：sumOfPositions
*   计算每个货币组的 abs(sumOfPositions)
*   计算之前结果的总和作为单个结果

**询问**

可以使用设计视图创建没有最终总和的查询。生成的 SQL 是：

```
SELECT Currency.code, Sum(Positions.position) AS SumOfposition
FROM [Currency] INNER JOIN Positions ON Currency.ID = Positions.currency_id
WHERE (((Positions.portfolio)=1))
GROUP BY Currency.code
HAVING (((Currency.code) In ("A","B"))); 
```

为了计算最终的 SUM，我执行了以下操作（在 SQL 视图中）：

```
SELECT Sum(Abs([temp].[SumOfposition])) AS sumAbs
FROM [SELECT Currency.code, Sum(Positions.position) AS SumOfposition
FROM [Currency] INNER JOIN Positions ON Currency.ID = Positions.currency_id
WHERE (((Positions.portfolio)=1))
GROUP BY Currency.code
HAVING (((Currency.code) In ("A","B")))]. AS temp; 
```

所以，问题是：有没有更好的方法来构建查询以使导出工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:34:23.813

我看不出它有太多错误，但我会取出一些垃圾访问放入并将查询缩小到这个，希望这应该运行正常：

```
SELECT Sum(Abs(A.SumOfPosition)) As SumAbs
FROM (SELECT C.code, Sum(P.position) AS SumOfposition
      FROM Currency As C INNER JOIN Positions As P ON C.ID = P.currency_id
      WHERE P.portfolio=1
      GROUP BY C.code
      HAVING C.code In ("A","B")) As A 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:36:43.513

可能值得尝试在 MS Access 查询定义中声明您的参数并定义它们的数据类型。当您尝试在 MS Access 本身之外使用查询时，这一点尤其重要，因为它无法自动检测参数类型。这种方法有时会成功或失败，但值得一试。

```
PARAMETERS [[Positions].[portfolio]] Long, [[Currency].[code]] Text ( 255 );
SELECT Sum(Abs([temp].[SumOfposition])) AS sumAbs
FROM [SELECT Currency.code, Sum(Positions.position) AS SumOfposition
FROM [Currency] INNER JOIN Positions ON Currency.ID = Positions.currency_id
WHERE (((Positions.portfolio)=1))
GROUP BY Currency.code
HAVING (((Currency.code) In ("A","B")))]. AS temp; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T07:35:27.010

我已经解决了我的问题，这要归功于外部查询的总和是微不足道的。在 Excel 中选择`New Database Query...`时，在过程结束时，按 后，会弹出`Finish`一个表单，询问`Import Data`

> 你想把数据放在哪里？

你可以点击`Create a PivotTable report...`。如果正确定义数据透视表，Excel 将仅显示外部总和。

# rubygems - 在 bitnami redmine 1.4.1 上安装 redmine-hudson 插件时遇到问题

> ID：10687705
> 
> 赞同：0
> 
> 时间：2012-05-21T14:58:45.807
> 
> 标签：rubygems, redmine, redmine-plugins, pg

每个人。

我试图在 bitnami redmine 1.4.1 上安装 redmine-hudson 插件（1.0.8）。

我只是按照下面的安装指南进行操作。

```
>Installing a plugin
>
>1\. Copy your plugin directory into #{RAILS_ROOT}/vendor/plugins. If you are downloading the plugin directly from GitHub, you can do so by changing into your plugin directory and issuing a command like git clone git://github.com/user_name/name_of_the_plugin.git.
>
>2\. If the plugin requires a migration, run the following command to upgrade your database (make a db backup before):
>>rake db:migrate_plugins RAILS_ENV=production
>
>3\. Restart Redmine
>
>You should now be able to see the plugin list in Administration -> Plugins and configure the newly installed plugin (if the plugin requires to be configured). 
```

当我执行“rake”时，它会向我显示这样的错误。

```
>[root@localhost ~]# rake db:migrate RAILS_ENV=production
> 
>Some gems may need to be installed or updated.
> 
>Please run 'bundle install --without development test'. 
```

接着....

```
>[root@localhost redmine]# bundle install --without development test
>
>Using rake (0.9.2.2) 
>
>Using activesupport (2.3.14) 
>
>Using rack (1.1.3) 
>
>Using actionpack (2.3.14) 
>
>Using actionmailer (2.3.14) 
>
>Using activerecord (2.3.14) 
>
>Using activeresource (2.3.14) 
>
>Using cgi_multipart_eof_fix (2.5.0) 
>
>Using coderay (1.0.6) 
>
>Using daemons (1.0.10) 
>
>Using fastercsv (1.5.4) 
>
>Using fastthread (1.0.7) 
>
>Using gem_plugin (0.2.3) 
>
>Using i18n (0.4.2) 
>
>Using mongrel (1.1.5) 
>
>Using mysql (2.8.1) 
>
>Using net-ldap (0.3.1) 
>
>Installing pg (0.13.2) with native extensions
>
>Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
> 
>> /usr/local/bin/ruby extconf.rb
> 
>checking for pg_config... yes 
>
>Using config values from /usr/bin/pg_config 
>
>checking for libpq-fe.h... yes 
>
>checking for libpq/libpq-fs.h... yes 
>
>checking for pg_config_manual.h... yes
>
>checking for PQconnectdb() in -lpq... yes 
>
>checking for PQconnectionUsedPassword()... no 
>
>Your PostgreSQL is too old. Either install an older version of this gem or upgrade your database.
> 
>*** extconf.rb failed ***
> 
>Could not create Makefile due to some reason, probably lack of
> 
>necessary libraries and/or headers.  Check the mkmf.log file for more details. You may need configuration options.
> 
>Gem files will remain installed in /usr/local/lib/ruby/gems/1.8/gems/pg-0.13.2 for inspection. 
>
>Results logged to /usr/local/lib/ruby/gems/1.8/gems/pg-0.13.2/ext/gem_make.out
>
>An error occured while installing pg (0.13.2), and Bundler cannot continue. 
>
>Make sure that 'gem install pg -v '0.13.2'' succeeds before bundling.
> 
```

所以，我尝试使用 gem 安装“pg”。但...！

```
>[root@localhost redmine]# gem install pg -v '0.13.2'
> 
>Building native extensions.  This could take a while...
> 
>ERROR:  Error installing pg:
> 
>>ERROR: Failed to build gem native extension.
>>
>>/usr/local/bin/ruby extconf.rb
> 
>checking for pg_config... yes 
>
>Using config values from /usr/bin/pg_config 
>
>checking for libpq-fe.h... yes 
>
>checking for libpq/libpq-fs.h... yes 
>
>checking for pg_config_manual.h... yes
>
>checking for PQconnectdb() in -lpq... yes 
>
>checking for PQconnectionUsedPassword()... no
> 
>Your PostgreSQL is too old. Either install an older version of this gem or upgrade your database.
> 
>*** extconf.rb failed ***
> 
>Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers.  
>
>Check the mkmf.log file for more details.  You may need configuration options. 
```

在此之后，我无法弄清楚如何设置。

有人知道这个问题吗？

Bitnami Redmine 包有 Redmine(1.4.1)、RubyGem(1.3.6)、Ruby(1.8.7)、Rails(2.3.5)。

这些都安装在 CentOS 5.5 上。

没有 redmine-hudson 插件，redmine、hudson 工作正常。

我该怎么做才能使用它？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-22T17:57:11.987

呃，错误输出说：

```
Your PostgreSQL is too old. Either install an older version of this gem 
or upgrade your database. 
```

您需要遵循该建议。

# freemarker - Freemarker - 英镑符号显示不正确

> ID：10687707
> 
> 赞同：0
> 
> 时间：2012-05-21T14:58:49.110
> 
> 标签：freemarker

我正在开发一个包含 Hibernate、JPA、Spring 的应用程序。

我有一个在流程结束时使用 Freemarker 发送电子邮件的流程。

免费标记模板中的数据是从数据库中填充的。数据在数据库中有一个英镑符号，但是当 freemarker 处理它时，它被转换成？象征。

代码如下

```
final StringWriter writer = new StringWriter();
Template template= freemarkerConfiguration.getTemplate("sampleReport.ftl");
template.process(this, writer);
System.out.println(writer.toString()); 
```

* * *

打印从数据库中检索到的数据，结果如下

```
INFO  05-22 10:08:18 Printing ?-- Hex :a3 
```

a3 - 是磅符号的十六进制代码，但它的打印？也是。

我无法发现错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:40:33.540

FreeMarker 可以在任何地方使用 UNICODE，因此它本身不会生成`?`-s。打印它的字符代码`String`而不是它`String`本身，并查看它是否已经包含 0x3F（的 UCS 代码`?`）。如果不是，则`System.out.println`说明使用了错误的编码，并且任何对电子邮件进行编码以供发送的内容也是如此。如果它确实包含 0x3F，则可能是那里的 JDBC 出现了问题（同样，您可以通过打印字符代码来检查来自 JDBC 的字符串），因此 FreeMarker 已经收到了`?`.

# parameters - 可以修改vala函数参数变量吗？

> ID：10687708
> 
> 赞同：1
> 
> 时间：2012-05-21T14:58:51.563
> 
> 标签：parameters, vala

我是 Vala 的新手，但是当我尝试修改函数中的参数变量时，我似乎遇到了一个奇怪的问题。例如，这不起作用：

```
public string changeString(string input) {
    input = input.down();
    return input;
} 
```

（我得到这个错误：）`Invalid assignment from owned expression to unowned variable: input = input.down();`

但是，这确实有效：

```
public string changeString(string input) {
    string temp = input;
    temp = temp.down();
    return temp;
} 
```

我认为参数变量不能在 Vala 中修改是否正确？如果是这样，为什么？还有比上述更好的解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T20:12:14.013

是和不是。默认情况下，Vala 中的参数是无主的（如果您不知道这意味着什么，请参阅[https://live.gnome.org/Vala/Tutorial#Ownership ）。](https://live.gnome.org/Vala/Tutorial#Ownership)您可以分配给无主变量（包括参数），但您只能将无主值分配给无主变量。这里的问题是 string.down 的返回值是拥有的，并且您试图将它分配给一个无主的变量。这是不允许的，因为 Vala 将无法知道它是否应该在方法结束时释放字符串。

有几种方法可以解决这个问题。首先是让参数拥有：

```
public string changeString (owned string input) {
  input = input.down ();
  return input;
} 
```

这通常不是一个好主意，因为这意味着当您调用 changeString 时，Vala 必须复制 (g_strdup) 输入字符串，这有点浪费。

一个相关的特性是参数方向（参见[https://live.gnome.org/Vala/Tutorial#Parameter_Directions](https://live.gnome.org/Vala/Tutorial#Parameter_Directions)）。如果要就地修改输入，可以执行以下操作：

```
public void changeString (ref string input) {
  input = input.down ();
} 
```

将输入的副本放在临时变量中（就像您在第二个示例中所做的那样）并没有真正的意义......它复制方法的第一行中的字符串，然后在下一个覆盖 temp 时立即释放它线）。这样的事情更有意义：

```
public string changeString (string input) {
  string temp = input.down ();
  return temp;
} 
```

当然，你真的不需要一个临时变量......

```
public string changeString (string input) {
  return input.down ();
} 
```

# scons - 如何跟踪哪个文件导致语法错误？

> ID：10687713
> 
> 赞同：1
> 
> 时间：2012-05-21T14:59:00.837
> 
> 标签：scons

我不完全知道我做了什么，但似乎我破坏了我的构建系统。

```
$ scons install
scons: Reading SConscript files ...
File "<string>", line 1

I_���.�K
        H�4����Ǐ��U)�f���R�f���ў�U)�f���R�f���ў�

   ^

SyntaxError: invalid syntax 
```

不可打印的字符是有意的。

坏事是：即使在“已知的工作”版本上重置也无济于事，以及使用`--debug=stacktrace`. 我的版本控制系统（mercurial）没有显示`SCons`文件中的更改，我不知道如何继续。任何提示如何让 mercurial 打印它正在处理的文件的名称以找出发生了什么？

我的下一步是对该项目进行新的克隆（希望能够构建），但我很好奇这里出了什么问题。

**更新**

当我更新到 Ubuntu 12.04 时问题消失了。在这种情况下，“消失”意味着我突然能够执行`scons --clean`命令，之后我能够再次重建我的项目。可悲的是，我无法重现该错误，因此最后我不知道是什么原因造成的，因为它工作了几个月，而且我的同事之前都没有遇到过如此奇怪的错误。

这是我的脚本的摘录：

```
vars = Variables( "variables.cache" )
vars.Add( "CXX", "use this c++ compiler", "/usr/bin/g++" )
# (other stuff added to vars)

env = Environment( variables = vars )  # <-- this line caused the error 
```

在解决这个问题的过程中，我得到的印象是，在更新之后，Python 能够给我一个更好的错误消息，并且该消息（试图记住它）`vars`在某种程度上是无效的。所以也许问题出在`variables.cache`，我不知道。也许我应该删除这个文件（我没有删除）以消除错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:15:19.607

尝试执行带有警告的 scons，如下所示：

```
# scons --warn=all 
```

如果这没有帮助，您可以尝试一种更老式的方法，并在 SConstruct 中放置一些打印语句，以查看发生了什么以及问题发生的时间/地点。

您还可以尝试清理整个项目并删除/重命名根项目中的 .sconsdb.lite。

更新：

我最近遇到了一个问题，因为 Python 的版本从 2.6 更改为 2.7，并且错误处理完全改变了。因此，尝试在 SConstruct 中的所有内容（或至少是战略部分）周围放置一个 python try/except 块，并打印抛出的异常（如果有）。

如果这些都不起作用，请尝试在此处发布 SConstruct。

我的代码示例`SConstruct`演示了我如何使用 Python try/except 块发现我的错误。BuildError 异常给了我一个堆栈跟踪。您可以“捕捉”更多例外情况。

```
...
try:
    SConscript(
        os.path.join(moduleDir, 'SConscript'),                        # sub-directory SConscript to load
        variant_dir = '#%s' % os.path.join(env['variantDir'], dir),   # path relative to this script where to put built files
        exports = ['env'],                                         # which variables to export to sub-directory build
        duplicate = 0)                                             # dont duplicate source files in variant_dir
except SCons.Errors.BuildError as be:
    print "*** BuildError exception processing module: %s, %s" % (moduleDir, be.__str__())
    raise
except:
    print "*** Unhandled exception processing module: %s" % moduleDir
    raise 
```

# c# - Rhino Mocks，设置存根属性后如何执行操作

> ID：10687715
> 
> 赞同：1
> 
> 时间：2012-05-21T14:59:03.433
> 
> 标签：c#, unit-testing, mocking, rhino-mocks

我有一个简单的要求，但我似乎很挣扎。

我创建了一个`stub`模拟一个`interface`，其中包括一个`Property`：

```
public interface IMockIRuleRuningViewModel : IRuleRunningViewModel
{
    int Id { get; set; }
} 
```

而且`mock`是：

```
var mock = MockRepository.GenerateStub<IMockIRuleRuningViewModel>(); 
```

现在我想要`mock`一个我会为此设置一个 setter 的操作，这`Property`是我的尝试：

```
mock.Stub(x => x.Id).WhenCalled(
    o =>
        {
            var engine = new RulesEngine(mock);
            mock.ProcessRuleEngineResults(engine.RunRule("Id"));
        }); 
```

但我不断得到这个`Exception`：

> 您正在尝试对定义为使用 PropertyBehavior 的属性设置期望。而不是编写这样的代码：mockObject.Stub(x => x.SomeProperty).Return(42); 您可以直接使用该属性来达到相同的结果：mockObject.SomeProperty = 42;

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T12:56:23.950

以下对我有用：

```
HttpResponseBase response = MockRepository.GenerateMock<HttpResponseBase>();

// stub the getter
response.Stub(r => r.StatusCode).Return((int)HttpStatusCode.OK);

// Stub the setter
response.Stub(r => r.StatusCode = Arg<int>.Is.Anything).WhenCalled( o =>
  {
    Console.WriteLine("called");
  }); 
```

由于我实际上想要做的是模拟可以获取但不能设置状态代码的情况（因为已经发送了标头），所以我不这样做`WhenCalled()`，我这样做：

```
 response.Stub(r => r.StatusCode = Arg<int>.Is.Anything)
   .Throw(new HttpException("Server cannot set status after HTTP headers have been sent")); 
```

你必须使用`MockRepository.GenerateMock`not `MockRepository.GenerateStub`。我不知道为什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T09:06:20.190

如果您想验证 SUT（被测系统）的行为，您应该使用具有适当期望的模拟，并进行验证。如果您只想传递一个可能需要以某种方式执行的值，但不是此测试的重点，您将使用存根（存根不会导致测试失败）。

我假设您正在`RulesEngine`此测试中进行测试（因为它只是我看到的真实对象）。这是一个示例测试，它在执行“Id”规则时验证引擎的行为：

```
// Arrange
var model = MockRepository.GenerateMock<IMockIRuleRuningViewModel>();
model.Expect(m => m.ProcessEngineResults(42));
RulesEngine engine = new RulesEngine(model);

// Act
engine.RunRule("Id");

// Assert
model.VerifyAllExpectations(); 
```

# ios - XCode 自定义 segue 类卡住了

> ID：10687726
> 
> 赞同：12
> 
> 时间：2012-05-21T14:59:33.793
> 
> 标签：ios, xcode, uistoryboard, uistoryboardsegue

这个问题可能看起来有点奇怪，但我无法理解为什么会这样。

我所做的是重命名了一个自定义 segue 类，并将其反映在“自定义类”下的情节提要中，但它仍然试图调用旧的。

我已经清理了构建文件夹并在项目中搜索了旧的自定义类名，但至少在 xcode 中没有找到任何东西。我查看了故事板文件，它也不存在。

即使我一起删除了自定义 segue，我也会得到：

```
'Could not find a segue class named 'xxxxxxxxx'' 
```

问题是我无法理解它从上面得到“xxxxxxxxx”的位置，它不在情节提要文件或代码中..

```
[[[self view] viewWithTag:1] resignFirstResponder]; 
```

当我调试时，这是线程终止显示错误的地方。我已经删除了文本字段上的所有出口、事件和转场。我没有在任何地方使用'xxxxxxxxx'作为类的自定义segue。

我还能做些什么来更彻底地清理项目吗？从哪里开始？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2014-11-05T11:00:01.863

这对我有用 - 我必须在界面构建器中选择 segue 并将模块从“无”设置为我的项目名称，该名称出现在下拉列表中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T16:28:15.220

答案是重置故事板目标成员，然后重置模拟器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-11T17:19:45.530

对于其他从网络上搜索答案的人：检查您是否在构建阶段中包含了实现文件。就我而言，我有几个目标，而第二个目标缺少这个实现文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-11T22:38:25.400

看看这个其他的问题。通过将 custom-sequ-class 声明为和 objective-c 类来回答“问题 #1”

[类似的 SO Q&A - 谈到 XCode 中的一个缺陷](https://stackoverflow.com/questions/24185345/custom-segue-in-swift)

答案摘要：

```
@objc(CustomSequeLeft2Right)
class CustomSequeLeft2Right {
.
.
.
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-16T08:17:39.523

我的问题是我在界面生成器中明确设置了**“类”名称；**这不是必需的。它由 Xcode 管理，默认为 UIStoryboardSegue。

# c# - ASP.NET ListView - 如何对项目进行分组？

> ID：10687729
> 
> 赞同：1
> 
> 时间：2012-05-21T14:59:50.227
> 
> 标签：c#, asp.net, listview

我有一组对象，例如：

> 名称：Foo 组：1
> 
> 名称：Fuu 组：1
> 
> 名称：酒吧组：2
> 
> 名称：Baz 组：2
> 
> 名称：Bap 组：2
> 
> 名称：Qux 组：3

我想使用列表视图显示这些对象，并且必须对它们进行修饰，例如：

> 福福
> 
> 酒吧，巴兹，巴普
> 
> 曲克斯

我查找了 GroupTemplate 但唯一的分组选项是按项目数。任何想法如何通过自定义属性进行组合？

# jquery - SelectBox (Clavinska) 附加动态生成的下拉菜单

> ID：10687732
> 
> 赞同：1
> 
> 时间：2012-05-21T14:59:57.613
> 
> 标签：jquery, jquery-plugins

如何使用 SelectBox (Clavinska) 附加生成的 DropDown 元素？

我的例子：

```
$(document).on("mouseenter", function() {
$("#countries").selectBox();
}).trigger('mouseenter'); 
```

这项工作，但仅限于鼠标输入，我想附加“加载”！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:04:31.700

```
$(function () {
     $("#countries").selectBox();
}) 
```

# jquery - 如何在 jQuery 验证插件中按功能切换数字验证器？

> ID：10687738
> 
> 赞同：0
> 
> 时间：2012-05-21T15:00:09.113
> 
> 标签：jquery, jquery-plugins, jquery-validate

在 jQuery 站点[Plugins/Validation/Methods/digits](http://docs.jquery.com/Plugins/Validation/Methods/digits) 上有示例：

```
$("#myform").validate({
  rules: {
    field: {
      required: true,
      digits: true
    }
  }
}); 
```

我想确定功能是否需要验证。当我接下来尝试时，我只对**数字**有问题：

```
$("#myform").validate({
  rules: {
    field: {
      required: true,
      digits: function() { return false; }
    }
  }
}); 
```

验证插件仍然只需要我的输入字段的数字。如何在 jQuery 验证插件中按功能切换**数字验证器？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:39:52.540

有点晚了，但是以防万一您永久想要替换默认的“必需”功能-您可以这样做-

```
 $.validator.addMethod("required", function(value, element, param) {
    // your logic here

    // return the result
    return false;
  }, "custom message" /* or the default message - jQuery.validator.messages.required */
  ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:05:23.090

我想你需要

```
digits: {
depends: function(){
      return false;                            
   }
} 
```

试试这个

```
$("#myform").validate({
  rules: {
    field: {
      required: true,
          digits: {
         depends: function(){
                 return (some_condition());
             }
         }
      }
  }
}); 
```

# c# - 数据绑定出错的自定义 UserControl

> ID：10687742
> 
> 赞同：0
> 
> 时间：2012-05-21T15:00:27.800
> 
> 标签：c#, wpf, data-binding, user-controls

我有一个`UserControl`我写的基本可以正常工作，但现在我想改进它。最初的设计只是一个`Grid`带有几个`FrameworkElements`，like `Rectangle`and的`TextBlock`。问题是为了让它工作，我创建了大量冗余的依赖属性。例如，我没有使用这些属性设置控件的`Width`and ，而是创建了名为and的新控件，这真的很糟糕。`Height``MyControlWidth``MyControlHeight`

我已经开始使用 a 重写控件`Label`，并将我的`Rectangles`and`TextBlock`放在`Label`'s`ControlTemplate`中。现在我的问题是，虽然`Height`看起来`Width`工作正常，但我的其他一些依赖属性却没有。

例如，我希望我的控件具有用户指定的圆角，因此我创建了一个名为的依赖属性，并`OutlineRadius`使用它来设置. 好吧，现在当我运行我的应用程序时，我收到一个数据绑定错误，上面写着：`RadiusX``RadiusY``Rectangle`

> System.Windows.Data 错误：40：BindingExpression 路径错误：在“对象”“MyTestApplication”（名称=“”）上找不到“OutlineRadius”属性。绑定表达式：路径=轮廓半径；DataItem='MyTestApplication'（名称=''）；目标元素是'矩形'（名称=''）；目标属性是“RadiusX”（类型“双”）

谁能告诉我哪里可能出错了，在这里？我也在考虑在我的应用程序中创建 a`Style`并将其应用于`Label`s ，但我仍然会遇到问题，`OutlineRadius`因为我不知道在使用`Style`'s 时是否可以向现有控件添加属性。

# multithreading - Silverlight 线程池

> ID：10687745
> 
> 赞同：1
> 
> 时间：2012-05-21T15:00:45.180
> 
> 标签：multithreading, silverlight, threadpool

我对 Silverlight 中的线程有疑问。我主要来自 winForms 背景，通常使用以下包装类来执行我的线程：http:

[//msdn.microsoft.com/en-us/magazine/cc163644.aspx](http://msdn.microsoft.com/en-us/magazine/cc163644.aspx)

它适用于进行窗口开发，但我不能在 Silverlight 中使用它。原因是 ExecutionContext 标记有 [SecurityCritical] 属性，因此无法从 Silverlight 调用。

Silverlight 是否有类似的包装类，或者有什么方法可以解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:12:29.413

即使在 WinForm 应用程序中，我也不会使用您引用的类。它仍然使用`Thread.Abort`可以（并且可能会）破坏应用程序域的内容。相反，请使用任务并行库中的新[取消](http://msdn.microsoft.com/en-us/library/dd997364.aspx)机制。不过，您将不得不重新考虑取消工作项的整个方法。这是因为您不能再依赖强制终止，而必须使用合作终止。优点是后者可以保证避免破坏应用域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:21:27.323

查看仅在 SL5 中可用的取消令牌（通过 CancellationTokenSource）。它使用与您的 MSDN mag ref 中使用的机制类似的机制。

这是一篇[很好的“操作方法”文章](http://msdn.microsoft.com/en-us/library/dd537607.aspx)。此处的一些[MSDN 参考资料](http://msdn.microsoft.com/en-us/library/system.threading.cancellationtokensource%28v=vs.95%29.aspx)，以及此处[的冗长但很棒的文章](http://blogs.msdn.com/b/pfxteam/archive/2009/05/22/9635790.aspx)

一切顺利，欢迎来到 XAML 编程 :) 你不会回头！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:03:17.597

重写现有代码以使用“任务”（[Task Link](http://msdn.microsoft.com/en-us/library/dd537609)）或 BackgroundWorker（[BackgroundWorker Link](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)）。

我们应该使用最新的技术，这给了我们一个技术进化。

# javascript - GetCookie 返回 NULL

> ID：10687746
> 
> 赞同：1
> 
> 时间：2012-05-21T15:00:45.790
> 
> 标签：javascript, jquery, jquery-plugins, cookies

我尝试在 Javascript 和 Jquery 中设置和获取 Cookie，但这两种方法都返回**null 。**我的代码看起来正确，但我不知道为什么它对我不起作用。

> ***厨师.js***

```
function setCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else 
        var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) 
                return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function deleteCookie(name) {
    setCookie(name,"",-1);
} 
```

和我的 html 页面：

> ***fin.html：***

```
<!DOCTYPE html>
<html>
    <head>
        <title>My Page</title> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="jquery.cookie.js"></script>
        <script type="text/javascript" src="cook.js"></script>
    </head>
    <body>
        <a id="setcookie" href="fin2.html">SET COOKIE</a>
        <script>
            $("#setcookie").click(function() {
                // Using javascript function
                setCookie("mycookie", "itsvalue", 1) ;

                // Using jQuery plugin
                $.cookie('myCookie2': "myValue");
            });
        </script>
     </body>
</html> 
```

> ***fin2.html***

```
<!DOCTYPE html>
<html>
    <head>
        <title>My Page</title> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="jquery.cookie.js"></script>
        <script type="text/javascript" src="cook.js"></script>      
    </head>
    <body>
        <a id="get" href="#">YOO</a>
        <script>
            $("#get").click(function() {
                alert(getCookie("mycookie")) ;
                alert($.cookie('myCookie')) ;
            }) ;
        </script>
    </body>
</html> 
```

但它使用 jquery 插件和 javscript 的函数返回 null。你对这个问题有什么想法吗？十分感谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:41:18.820

Have you tried running this in Apache/IIS? Cookies will only be set when run from a server. I've put together a quick jsfiddle based on your code at: [http://jsfiddle.net/ZuCEC/](http://jsfiddle.net/ZuCEC/)

You should be able to set, get and delete cookies and see the value changing as you go.

Hope that helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:03:26.570

默认情况下，jQuery cookie 插件使用当前路径作为路径的默认值设置 cookie。这意味着 cookie 将仅在设置它的同一页面上可用。如果您希望 cookie 可以从您网站上的任何页面读取，请这样做。

```
$.cookie('the_cookie', 'the_value', { path: '/' }); 
```

另外，请注意我使用的是 a`,`而不是 a`:`

# javascript - 是否可以捕获内部创建的必应地图实体的事件？

> ID：10687747
> 
> 赞同：0
> 
> 时间：2012-05-21T15:00:46.647
> 
> 标签：javascript, bing-maps

我正在使用 Bing Maps AJAX Control 7.0

我想向作为行驶路线一部分的图钉添加自定义事件处理程序。

我知道如何将自定义事件添加到我自己创建并引用的映射实体。但是构成行驶路线的实体是在内部创建并自动添加到地图中的。有没有一种方法可以在将它们添加到地图之前或之后附加和事件处理程序？

具体来说，我想将自定义 onmouseover 事件添加到行驶路线上的航点图钉，以便在悬停时显示自定义图标。我已经阅读了一个建议，通过 中的属性将带有伪`:hover`选择器的 css 类添加到图钉，但这不起作用。AJAX 控件本身使用 javascript 事件来更改鼠标悬停时的图标图像，因此设置css 属性永远不会起作用，它会被默认的悬停图标覆盖。`typeName``PushpinOptions``background``:hover`

我需要向`onmouseover`驾驶航点图钉添加自定义事件，以便我可以显示自定义图标并禁用默认行为。我该怎么做呢？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:13:05.533

我能想到的唯一解决方案是检查驱动路线图钉的 HTML 输出并破解它们的事件冒泡。我检查了驱动路线图钉的 HTML，并且使用 V7 ajax api，它们`id`似乎都以前缀开头`DDWaypointPushpin`。因此，hacky 的解决方案是在 DOM 中找到这些图钉并以某种方式覆盖它们的默认事件处理程序。例如，如果您想阻止图钉上 mouseover 事件的默认行为，您可以使用 jquery 匹配 id 字符串并绑定到 mouseover 事件，并防止它冒泡。

```
 $("div[id*='DDWaypointPushpin']").bind('mouseover', function (e) {
            //$(this) will match your pushpin div, do whatever you want with it
            // Stop the event from bubbling up, so the default MS mouseover behavior is prevented
            e.stopPropagation();
        }); 
```

如果要显示自定义图标，请在`mouseover`处理程序中查找 下的`<img>`元素`$(this)`，并将其`src`属性更改为您喜欢的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T23:13:14.027

我发现该对象有一个未记录的属性`PushpinOptions`-`hoverIcon`

我向遍历地图上实体`directionsUpdated`的对象的事件添加了一些代码。`DirectionsManager`我查看了这些`Waypoint`实体，发现它们既有内部属性`_icon`又有`_hoverIcon`内部属性。因为里面有一个`icon`属性，所以`PushpinOptions`我检查了一个`hoverIcon`属性是否也可以使用，它可以！

据我所知，该`hoverIcon`物业没有记录在案。但这是一种更简单的方法，并且可能是将自定义悬停图像添加到图钉的正确方法。

如果将此情况报告给 Micorsoft 会有所帮助，以便他们更新文档。我以前从未向 Microsoft 报告过文档错误，所以如果您知道执行此操作的最佳方法，请告诉我。

# ruby-on-rails - Ruby on rails 文件下载链接

> ID：10687749
> 
> 赞同：2
> 
> 时间：2012-05-21T15:01:05.437
> 
> 标签：ruby-on-rails, ruby-on-rails-3, download

我使用回形针创建了文件上传！文件按预期上传。比我添加的文件下载方法是这样的：

```
def download
    sample = Sample.find(params[:id])

    send_file  upload.sample.path,
    :filename => upload.sample_file_name,
                :type => upload.sample_content_type,
    :disposition => 'attachment'
    flash[:notice] = "Your file has been downloaded"
  end 
```

但我不知道，我应该在我的表演动作中放什么，这样我才能下载文件？

我做到了这一点：

```
<td><%= @sample.upload_file_name =%></td>
    <%= link_to 'Download', :action => :download, :path =>@sample.upload.url, :type => @sample.upload_content_type %> 
```

但它显示错误：找不到带有 id=download 的示例

谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:13:49.480

认为您需要更改您的 link_to 以发送 :id （这就是控制器操作使用 params [:id] 寻找的内容）

```
<%= link_to 'Download', :action => :download, :id => @sample.id %> 
```

Soz Karlis 在你发帖时正在写作：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:20:01.903

=link_to 'download', @sample.upload.path 这是最简单的方法））

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:35:28.973

假设您正确设置下载命名路由，您可以说

```
<%= link_to 'Download', download_sample_path(@sample) %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T16:36:16.533

看起来您的路线不匹配。

这就是为什么，你必须：

1.  为您的**routes.rb**添加额外的**路由**以进行下载操作。
***   如前所述，您必须将链接添加到您的视图 (link_to)。**

 **阅读这篇文章以获得更高级的**下载**功能： [http ://thewebfellas.com/blog/2009/8/29/protecting-your-paperclip-downloads](http://thewebfellas.com/blog/2009/8/29/protecting-your-paperclip-downloads)**

# linux - 如何使用带有 bitbake 的 uclibc 构建包 - Bitbake 在尝试构建 uclibc 时引发 MultipleMatches 异常

> ID：10687750
> 
> 赞同：0
> 
> 时间：2012-05-21T15:01:06.257
> 
> 标签：linux, uclibc, angstrom-linux, openembedded

我正在尝试通过 bitbake 构建`uclibc`架构`arm7a`，但我得到以下输出

```
user@ubuntu:~/stuff$ bitbake -b uclibc
ERROR: Unable to match uclibc (19 matches found):
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_git.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.30.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.30.2.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/bfin-uclibc_svn.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.31.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.30.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.29.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.30.2.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.31.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.29.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_git.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.28.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.30.1.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.30.3.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.28.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc++/uclibc++_git.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/elf2flt_svn.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc-initial_0.9.30.1.bb
ERROR:     /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.30.3.bb
ERROR: Command execution failed: Traceback (most recent call last):
  File "/home/user/stuff/bitbake/lib/bb/command.py", line 102, in runAsyncCommand
    commandmethod(self.cmds_async, self, options)
  File "/home/user/stuff/bitbake/lib/bb/command.py", line 190, in buildFile
    command.cooker.buildFile(bfile, task)
  File "/home/user/stuff/bitbake/lib/bb/cooker.py", line 608, in buildFile
    buildfile = self.matchFile(fn)
  File "/home/user/stuff/bitbake/lib/bb/cooker.py", line 591, in matchFile
    raise MultipleMatches
MultipleMatches 
```

我也在尝试建立一个特定的食谱（我做错了吗？）但我明白了

```
user@ubuntu:~/stuff$ bitbake -b /home/user/stuff/openembedded/recipes/uclibc/uclibc_0.9.31.bb 
ERROR: Command execution failed: Traceback (most recent call last):
  File "/home/user/stuff/bitbake/lib/bb/command.py", line 102, in runAsyncCommand
    commandmethod(self.cmds_async, self, options)
  File "/home/user/stuff/bitbake/lib/bb/command.py", line 190, in buildFile
    command.cooker.buildFile(bfile, task)
  File "/home/user/stuff/bitbake/lib/bb/cooker.py", line 618, in buildFile
    self.status.add_from_recipeinfo(vfn, info)
  File "/home/user/stuff/bitbake/lib/bb/cache.py", line 583, in add_from_recipeinfo
    for provide in info.provides:
TypeError: 'NoneType' object is not iterable 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:58:36.410

我回答我自己的问题是因为我在搜索这个论点时发现的信息不足。我希望这不是不合适的。所以..

首先，`bitbake`应该在没有`-b`选项的情况下调用以计算包依赖关系

```
bitbake package 
```

然后，无需`uclibc`直接构建，因为 bitbake 在必要时会自动构建它（因为您必须在`bitbake`没有`-b`选项的情况下使用）。此时它还没有完成，因为对于我的 Angstrom 发行版 (2010.x) 版本，uclibc 不是由 bitbake 构建的默认库，而是构建了 eglibc。所以你必须添加到你的`stuff/build/conf/local.conf`这一行：`ANGSTROMLIBC = "uclibc"`，在[这个常见问题解答中找到](http://www.openembedded.org/wiki/Uclibc_FAQ)

最后，您可以在您的`stuff/tmp/deploy/uclibc`.

# apache-flex - Spark Datagrid：滚动问题（selectionChange 事件）

> ID：10687754
> 
> 赞同：1
> 
> 时间：2012-05-21T15:01:19.720
> 
> 标签：apache-flex, datagrid, flex-spark, flex-mobile

我有一个灵活的**移动**项目。在我的主页视图中，我有一个火花数据网格。selectionMode 是“singleCell”。我在数据网格上有一个事件监听器，它监听 selectionChange 事件。当有人单击单元格时，会显示带有列表的标注视图。

现在，当我想在数据网格中滚动时（如果它有很多行），显然会触发 selectionChange 事件而不是正常滚动。有人对此有解决方案吗？

**奇怪的是，当您使用带有更改事件 (spark.components.supportClasses.ListBase.change) 的列表（代替 spark 数据网格）时，该列表能够毫无问题地说明滚动和选择之间的区别！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T12:30:09.080

正确，问题是由 singleCell 编辑模式@Al_Birdy 引起的。

我已经通过在数据网格上使用双击事件来半解决它。该应用程序还将在最后阶段导出为桌面应用程序，因此这不是一个真正的坏主意。

正如 www.Flextras.com 所指出的，数据网格尚未针对移动使用进行优化。如果我可以添加一些东西，它也不是那么成熟。为了解决这个问题，基本上应该像列表控件一样实现类似的方法。在这个控件中，实现了这个行为（滚动事件和触摸/点击事件的区别）。火花数据网格没有这种行为让我有点惊讶。但话又说回来，他们采用了“ol good desktop”组件并将其移植，这可能解释一切，这并不让我感到惊讶。

# objective-c - NSImage drawInRect:fromRect:operation:fraction 导致图像翻转

> ID：10687757
> 
> 赞同：4
> 
> 时间：2012-05-21T15:01:32.007
> 
> 标签：objective-c, cocoa

当我使用：

```
[iconImage drawInRect:NSMakeRect(cellFrame.origin.x+5,yOffset+3,cellFrame.size.height-6, cellFrame.size.height-6)
                     fromRect:NSMakeRect(0,0,[iconImage size].width, [iconImage size].height)
                    operation:NSCompositeSourceOver
                     fraction:1.0]; 
```

为了在 NSOutlineView 单元格中绘制一些图像，图像被垂直翻转。我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T15:17:55.627

使用方法

```
- (void)drawInRect:(NSRect)dstSpacePortionRect
          fromRect:(NSRect)srcSpacePortionRect
         operation:(NSCompositingOperation)op
          fraction:(CGFloat)requestedAlpha
    respectFlipped:(BOOL)respectContextIsFlipped
             hints:(NSDictionary *)hints 
```

随着`- (void)lockFocusFlipped:(BOOL)flipped`

将图像倒置。来自[NSImage 参考](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/nsimage_Class/Reference/Reference.html)手册。

# c# - 哪个是通过 Internet 同步 SQL Server (2008) 的最佳方式？

> ID：10687765
> 
> 赞同：0
> 
> 时间：2012-05-21T15:01:57.833
> 
> 标签：c#, sql-server, wcf

我有两个相同的 SQL 服务器数据库。一个是主数据库，另一个是远程数据库，它位于远程位置。两台计算机都使用 VPN 连接。远程数据库中的某些表必须每 10 分钟更新一次。

数据库同步是更好的选择吗？我们是否必须使用 C# 或其他编程语言开发软件？我们必须使用 WCF 吗？

# php - php邮件功能弄乱了我的电子邮件css

> ID：10687766
> 
> 赞同：0
> 
> 时间：2012-05-21T15:02:00.563
> 
> 标签：php, email

我使用了一个简单的电子邮件功能，它弄乱了我所有的 css.. 它把所有的 div 放在另一个下面而不是在包装 div 中.. 有没有办法克服它？

```
 function email_template($app_link, $img_link, $app_name){
       $message='<html>
        <head>

    <title>Purchase Successful!</title>
         </head>
            <body>

      <div id="pic" style="position:relative; text-align:center; margin:0px auto;width:320px; height: 480px;">
       <a href="http://1111111111111edapps.com">  
       <div id="logo" style="position:absolute; width:130px; height:35px; z-index:99999;top:5;">
       </div>
       </a>
        <div id="clickHere" style=" position:absolute;width:320px;height:50px;z-index:99999;top:60px;text-align: center;">
            <span id="clickHereText" style="font-size:140%; color:white;"> <a href="'.$app_link.'" style="color:yellow">Click Here</a> to Download<br/>
                 your phonemate app
                 </span>
        </div>

        <div id="appImg" style="position:absolute;width:50px; height:50px;z-index:99999; left:50px;top:210px;">
            <img src="http://1111111111111edapps.com/'.$img_link.'" width="53px" height="53px"/>
        </div>
        <div id="appLabel" style="position:absolute; width:50px; height:10px; z-index:99999; text-align: center; left:50px; top:260px;">
            <span style="color:white; font-size: 50%;">'.$app_name.'</span>
        </div>

        <div id="downloadLink" style="position:absolute; width:320px; height:30px;  z-index:99999; bottom:0px; text-align: center;">
            <a href="'.$app_link.'" style="color:yellow">Download our app on 1111111111111edApps.com</a>
        </div>
       <img src="http://1111111111111edapps.com/email/images/1111111111111edAppEmail.jpg"/>
    </div>
       </body>
   </html>';

  return $message;

 } 
```

电子邮件功能有效.. 但是 div 应该在内部 ..pic div .. 但它们在外部.. 有没有办法传递电子邮件并使其呈现与我在常规页面上测试时相同？

额外说明：我的 php：

```
 $to = /*TO EMAIL ADDRESS*/"";
 $subject = "Hi!";
$body=email_template('http://1111111111111edapps.com/app_dl.php?app_id=34', $app_pic, $app_name);
echo $body;
 $headers  = 'MIME-Version: 1.0' . "\r\n";
 $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
 if (mail($to, $subject, $body,$headers)) {
   echo("<p>Message successfully sent!</p>");
  } else {
   echo("<p>Message delivery failed...</p>");
  }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:20:51.083

我通过 W3C 标记验证器运行了您的代码，看来您可能需要在这里重新考虑您的方法：

```
<a href="http://1111111111111edapps.com">
<div id="logo" style="position:absolute; width:130px; height:35px; z-index:99999;top:5;">
</div>
</a> 
```

在 a 元素内放置一个内联元素（例如带有 display: block; applied 的 span）。我愿意（此时此刻）打赌非法 div 会给你带来一些问题。

请记住，电子邮件客户端的设计不像 Web 浏览器那样处理 HTML 错误，虽然某些客户端的支持非常好，但其他客户端可能远远落后（我在看着你，Outlook 2007+）。

您没有提及您测试了哪些电子邮件客户端以及哪些给您带来了问题，因此如果更正您的标记不能解决问题，请给我们更多信息。

# mysql - 如何计算每个类别的项目？

> ID：10687773
> 
> 赞同：8
> 
> 时间：2012-05-21T15:02:32.987
> 
> 标签：mysql, sql, count

我想对网站上的产品进行过滤。像这样的东西：

```
Department
- lassics (13,395)
- Literary (111,399)
- History (68,606)
...

Format
- HTML (3,637)
- PDF (8)
- Audio CD (443)
...

Language
- English (227,175)
- German (10,843)
- French (10,488)
... 
```

如何计算每个类别的产品？每个类别单独的 SQL 查询会太慢，因为产品和类别太多。我建议缓存也不是一种选择。

也许使用 MySQL EXPLAIN 查询是有意义的（尽管它并不总是提供足够的信息）？或者也许使用狮身人面像搜索引擎进行计数？......最好的方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T15:05:26.020

尝试：

```
SELECT category, COUNT(*) as count FROM table GROUP BY category 
```

响应应该是所有不同的`category`值，以及每个值的出现次数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-21T15:08:32.120

这个怎么样

```
SELECT field1, count(1) as Total
FROM myTable
GROUP BY field1 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-21T15:04:16.933

`COUNT()`与一起使用[`GROUP BY`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)按类别将它们组合在一起

# javascript - 将参数传递给事件触发器中的函数调用

> ID：10687782
> 
> 赞同：0
> 
> 时间：2012-05-21T15:03:13.597
> 
> 标签：javascript, jquery

现在我有这个

```
jQuery('.widget-prop').keyup(function() {
    var prop = jQuery(this).attr('id');
    var val = jQuery(this).val();

    stuff;
} 
```

和

```
jQuery('.widget-prop').click(function() {
    var prop = jQuery(this).attr('id');
    var val = jQuery(this).val();

    stuff;
} 
```

两个函数是相同的，所以我想通过定义外部函数并调用它来简化它

```
jQuery('.widget-prop').click('myFunction'); 
```

但是我如何将参数传递给 myFunction？

```
function myFunction(element) {
    stuff;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:04:05.513

摆脱那些引用...

```
jQuery('.widget-prop').click(myFunction); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:06:06.637

首先，您可以将两个处理程序合并为一个：

```
jQuery('.widget-prop').on('click keyup', function() {
    var prop = jQuery(this).attr('id');
    var val = jQuery(this).val();
    // stuff;
}); 
```

或者对于旧版本的 jQuery：

```
jQuery('.widget-prop').bind('click keyup', function() { // ... }); 
```

其次，jQuery 会自动将当前元素应用到您提供的任何函数中，因此`this`当您执行此操作时，关键字仍将是引发事件的元素：

```
jQuery('.widget-prop').on('click keyup', myHandler);

function myHandler() {
    var prop = jQuery(this).attr('id');
    var val = jQuery(this).val();
    // stuff;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:07:19.097

在上下文中`MyFunction` `this`是您单击的元素。此外，`click`处理程序需要 1 个参数，因此您的函数签名应该是`function MyFucntion(event)`事件参数保存有关操作的数据的位置（例如`event.target`，被单击的元素）。

所以这就是你定义你的处理程序的方式：

```
function myFunction(event){
    var element = event.target;
    // Note: event.target == this
    //do stuff
} 
```

这就是您将其绑定到事件的方式：

```
$(".widget-prop").click(myFunction); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T15:07:59.973

使用`.on`函数而不是快捷方式`.click`并将所有必需的事件作为参数传递：

```
jQuery('.widget-prop').on('click keyup', function() {
  var prop = jQuery(this).attr('id');
  var val = jQuery(this).val();
  //stuff;
}); 
```

编辑：不推荐使用=>快捷方式

# json - Coldfusion SerializeJSON 创建空白值

> ID：10687788
> 
> 赞同：1
> 
> 时间：2012-05-21T15:03:30.147
> 
> 标签：json, coldfusion, coldfusion-9

我正在尝试使用 SerializeJSON() 将 CFC 的实例转换为字符串，我可以将其存储在数据库中，然后稍后再拉回。

我遇到的问题是使用以下代码：

```
<cfdump var="#THIS#">

    <!--- Convert CFC to JSON --->
    <cfset thisJSON = SerializeJSON(THIS)>

    <cfdump var="#DeserializeJSON(thisJSON)#"> 
```

给了我以下内容：

![THIS 的 CFDump 和序列化/反序列化过程之后](../Images/33f08a25896f2f1ee565e77d2f1da9cb.png)

红色转储显示了 CFC，其中包含一个调用的数组，其中`controls`包含 7 个项目，每个项目都是另一个更简单的 CFC。当我运行`serializeJSON`并在将结果传递回来后转储结果时`deserializeJSON`，项目 3 - 7 已成为空字符串。

这是 JSON：

```
{
    "MESSAGE":"",
    "CONTROLS":            
    [
        {
            "INDEX":"1.0",
            "NAME":"maxP11D",
            "SELWHERE":"",
            "DEF":"7940.0",
            "MMD":true,
            "ORDER":"7",
            "APP":"",
            "PRE":"",
            "MAXCAP":"35946.0",
            "FORMAT":"pound",
            "VALUE":"",
            "DESC":"List price exc FRF & VED",
            "MINCAP":"7939.0",
            "MINVAL":"7939.0",
            "MAXVAL":"35946.0",
            "TYPE":"range",
            "TITLE":"P11D"
        },            
        {
            "INDEX":"2.0",
            "NAME":"Y13Taxat22",
            "SELWHERE":"",
            "DEF":"0.0",
            "MMD":true,
            "ORDER":"6",
            "APP":" pa",
            "PRE":"Tax at 20%",
            "MAXCAP":"1904.1099853515625",
            "FORMAT":"pound",
            "DESC":"Personal tax rate",
            "VALUE":"",
            "MINVAL":"0",
            "MINCAP":"0.0",
            "MAXVAL":"1904.1099853515625",
            "TYPE":"range",
            "TITLE":"Company car tax"
        },
        "",
        "",
        "",
        "",
        ""
    ],
    "SELECTRESTRICT":"
        (taxtype<6)AND (t.Make=@Peugeot@)\r\nAND t.model NOT LIKE @%407%@\r\nAND
        t.model NOT LIKE @% old@\r\nAND t.model != @107 3 door@\r\nAND
        t.model != @107 5 door@\r\nORDER BY \r\nt.model = @%iOn%@ 
        DESC,\r\nt.model = @107 3 door New@ DESC,\r\nt.model = @107 5 door New@
        DESC,\r\nt.model LIKE @%207%@ DESC,\r\nt.model LIKE @%RCZ%@
        DESC,\r\nt.model LIKE @%308%@ DESC,\r\nt.model LIKE @%3008%@
        DESC,\r\nt.model LIKE @%4007%@ DESC,\r\nt.model = @508 Saloon@
        DESC,\r\nt.model = @508 SW@ DESC,\r\nt.model = @508 RXH@ 
        DESC,\r\nt.model LIKE @%5008%@ DESC,\r\nt.model LIKE @%807%@
        DESC,\r\nt.model LIKE @%Bipper%@ DESC,\r\nt.model LIKE @%Partner%@
        DESC,\r\nt.model ASC
    ",      
    "SHOWNOTES":true,
    "MYSQL": {         
        "WHERE":"",
        "COLS":"
            t.maxP11D, t.Y13Taxat22, t.Y13Taxat40, t.CO2gpkm,
            t.fuelConsumptionDf, t.bodyStyle, t.fuelType, 
        ",
        "EXCLUDE":""
    }
} 
```

为什么前 2 个项目会成功转换，但其余 5 个项目会变成字符串？

我很肯定这段代码曾经可以工作，我最近升级到 CF 9.0.1，还有其他人在 9.0.1 中遇到 JSON 问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:03:06.050

ACF 9 中的 serializeJSON 存在一些重大问题。请确保您已安装累积修补程序 2：

[http://helpx.adobe.com/coldfusion/kb/cumulative-hot-fix-2-coldfusion-1.html](http://helpx.adobe.com/coldfusion/kb/cumulative-hot-fix-2-coldfusion-1.html)

不过老实说，serializeJSON 是一个 POS。我一直在使用一个名为 CFJSON 的旧项目，并且没有任何问题。我建议只是切换到那个并忘记serializeJSON：

[http://www.epiphantastic.com/cfjson/](http://www.epiphantastic.com/cfjson/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:22:39.427

您是否与使用 serializeJson() 结婚，或者 - 如果您所追求的只是序列化一个对象 - [objectSave()](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSf01dbd23413dda0e613c53881225a218cab-7fff.html)会是更好的选择吗？

# c# - ComboBoxEdit SelectedIndex 总是 -1

> ID：10687790
> 
> 赞同：1
> 
> 时间：2012-05-21T15:03:36.257
> 
> 标签：c#, winforms, combobox, devexpress, selectedindex

当我设置 comboBoxEdit.selectedindex = 某个值时，它永远不会采用这个值。它的值总是-1。我已经在 Constructor 或 Form_Load 中设置了它。

```
if (oPersclientEntrp.TypPrint == 1) {
  comboBoxEdit_Print.SelectedIndex = 0;
} else {
  comboBoxEdit_Print.SelectedIndex = 2;
} 
```

听说在将控件添加到表单之前，无法设置 SelectedValue、SelectedIndex、SelectedItem 属性。控件添加到窗体后，可以设置 selectedValue、-Index 和 -Item 属性。

但我在设计模式上绑定了值![设计模式](../Images/83622fbf6105cc5439f0477d5331e88a.png)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:08:51.567

尝试将您的代码更新为：

```
if (oPersclientEntrp.TypPrint == 1) { comboBoxEdit_Print.SelectedIndex = 0; }
else { comboBoxEdit_Print.SelectedIndex = 1; } 
```

如果你只有 2 个项目，你`SelectIndex`应该是 1，而不是 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:10:32.180

您有 2 个项目，并且索引`SelectedIndex`以`0`（因为它访问一个内部数组，当然它以 0 开头）开头。因此，您必须编辑代码以使用 index`0`而不是 1 和 index `1`insead of `2`.

顺便说一句，这是大多数`SelectedIndex`属性的常见行为，即`TabControl`.

# jsf - “渲染”为假后，Ajax“更新”是否正常？

> ID：10687792
> 
> 赞同：3
> 
> 时间：2012-05-21T15:03:40.460
> 
> 标签：jsf, primefaces

我可以将 Ajax“更新”命令发送到由于以前设置为 false 的渲染选项而尚未渲染的 JSF 组件：

```
render="#{BackingBean.doRender}" 
```

doRender 设置为`true`就在“更新”发送之前。

这是正确的方法吗？

我正在使用 PrimeFaces 并且在此期间`update`甚至`doRender`设置为 true 后一个组件不显示。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-21T15:12:20.970

ajax 更新通过 JavaScript 与 JSF 生成的 HTML DOM 树一起工作（正如 web 浏览器检索到的那样）。如果一个 JSF 组件没有被渲染，那么它根本不会出现在 HTML DOM 树中，因此 JavaScript 找不到任何要更新的东西。

相反，您需要更新*总是*呈现的父组件。

例如

```
<h:panelGroup id="foo">
    <h:someComponent rendered="#{bean.rendered}" />
</h:panelGroup> 
```

和

```
<p:commandButton ... update="foo" /> 
```

# java - 哪种豆类是可注射的？

> ID：10687795
> 
> 赞同：2
> 
> 时间：2012-05-21T15:03:54.027
> 
> 标签：java, dependency-injection, ejb, cdi, ejb-3.1

使用 EJB3.X 中的 CDI 概念，您可以注入 bean 或实体。我想知道的是：您可以注入哪些类型的 bean。

实体中的会话 Bean？MDB中的实体等？？？

我怎样才能找到一个表格来显示我在 CDI 概念中可以做什么/注入的可能性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:16:10.693

看看 DZone 参考卡可以在[这里](http://refcardz.dzone.com/refcardz/dependency-injection-in-ejb3#refcard-download-social-buttons-display)找到。

快速浏览：

Session Beans可以被注入到Session Beans中，MDBs可以被注入到SessionBean中，实体可以被注入到SessionBean中。

有状态的 bean 不应该被注入到无状态的 bean 中。

# javascript - “匿名”出现在我的 Wordpress 页面的左上角

> ID：10687797
> 
> 赞同：0
> 
> 时间：2012-05-21T15:04:07.740
> 
> 标签：javascript, wordpress, anonymous

对于我的网页[here](http://sagecanada.com/)，Wordpress 页面继续在左上角显示“匿名”一词。

我已经尝试禁用所有插件，但这并没有影响它。我也改变了主题，它消失了，所以我确定这是一个主题问题。

我已禁用 javascript 以查看那里是否存在冲突，但对这种情况没有帮助。我想知道是否有人在我尝试搜索时对他们的任何主题有这个问题，但我没有看到任何结果。

非常感谢您的参与！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:10:43.300

根据它在 HTML 中的位置以及您将其缩小到主题问题的事实，查看有问题的主题`header.php`文件。如果有流氓`echo`输出登录用户的名称或其他内容，我会说你已经找到了。

# php - JavaScript 跨浏览器窗口关闭问题

> ID：10687799
> 
> 赞同：2
> 
> 时间：2012-05-21T15:04:15.633
> 
> 标签：php, javascript, jquery, cross-browser

我在这里有这段代码：

```
<?php
    error_reporting(0);
    if(isset($_GET['bd'])){
?>

<script>
    window.close();
</script>

<?php

} 
```

在 Chrome 中可以正常工作，但在 FireFox 中无法正常工作。这有一个已知问题吗？如何让它在上述浏览器中始终如一地工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T15:08:57.173

在大多数浏览器中，`window.close()`只有当有`window`问题的有`opener`. 通过 an `opener`，我的意思是你有一个`parent` `window`打开 a 的 a `child` `window`。只有`child` `window`可以由 a 关闭`window.close()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T15:10:03.560

对于 Firefox，权威参考是 MDN。从那里引用：

*仅允许为使用 window.open 方法的脚本打开的窗口调用此方法。如果窗口不是由脚本打开的，JavaScript 控制台中会出现以下错误：脚本可能不会关闭不是由脚本打开的窗口。*

来源：[https ://developer.mozilla.org/en/DOM/window.close](https://developer.mozilla.org/en/DOM/window.close)

由于您的网页是在服务器端构建并定期打开的，而不是通过 javascript，因此它不适用于您的情况。

还要注意 Internet Explorer 中的不同行为：

*在未使用脚本打开的窗口上调用 window.close 方法会显示一个确认对话框。使用脚本关闭最后运行的 Windows Internet Explorer 实例也会打开确认对话框。*

所以这将起作用，但需要确认。

最后，我在 Opera 上对其进行了测试，它甚至可以在定期打开的窗口上运行，就像你在 Chrome 中所说的那样。

# oracle - 数据库表设计问题

> ID：10687801
> 
> 赞同：0
> 
> 时间：2012-05-21T15:04:30.293
> 
> 标签：oracle, database-design

我对表格设计有疑问。

第一个名为`products_mast`contains 的表

```
CONTRACTS_ID (PK),
AGREEMENT_NO,
SUPPLIER_CODE,
START_DATE,
END_DATE
PROD_EXTENSION_NO 
```

第二个表名为`products_det`contains

```
HIRING_ID (PK),
CONTRACTS_ID(FK),
PRODUCT_CODE,
RATE 
```

上述表格与`CONTRACTS_ID`. `Start Dates`并且`End Dates`在一张表中，产品`rates`在第二张表中。

在我的第三张表`TRANSACTIONS`中包含，

```
TRANS_ID,
TRANS_REF_NO,
HIRING_ID FK (products_det),
REMARKS 
```

一个问题通常是协议_no 可以延长一段时间，延长协议的新产品费率。因此，我在 products_mast 和 products_det 中添加了这些详细信息，协议号与扩展 002 相同（用于新扩展）。在 TRANSACTIONS 中，如果我将 HIRING_ID 与 products_det 链接起来，我该如何参考正确的费率，因为 HIRING_ID 会随着新的扩展而增加。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:29:13.387

我不太确定我是否完全按照您所建议的关于协议没有扩展 002 的价值（新扩展）但是如果是每个协议唯一标识交易的情况，那么将 FK 添加到表交易链接它回来怎么样到 products_mast 表中的 AGREEMENT_NO 字段？

# php - 如何使用 spl_autoload() 而不是 __autoload()

> ID：10687804
> 
> 赞同：40
> 
> 时间：2012-05-21T15:04:52.963
> 
> 标签：php, deprecated, autoload, spl-autoloader

根据[http://php.net/manual/en/language.oop5.autoload.php](http://php.net/manual/en/language.oop5.autoload.php)，魔术函数`__autoload()`自 PHP 7.2.0 起已弃用，并从 PHP 8.0.0 起删除。

官方的替代方案是`spl_autoload()`. 请参阅[http://www.php.net/manual/en/function.spl-autoload.php](http://www.php.net/manual/en/function.spl-autoload.php)。但是PHP手册并没有说明这个宝贝的正确使用方法。

**我的问题**：如何用一个版本替换这个（我的自动类自动加载器）`spl_autoload()`？

```
function __autoload($class) {
    include 'classes/' . $class . '.class.php';
} 
```

**问题**：我无法弄清楚如何为该函数提供路径（它只接受名称空间）。

顺便说一句，这里有很多关于这个主题的主题，但没有一个提供一个干净简单的解决方案来取代我性感的单线。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-05-21T15:11:19.207

您需要使用 注册自动加载功能[`spl_autoload_register`](http://www.php.net/manual/en/function.spl-autoload-register.php)。您需要提供一个[“可调用”](http://www.php.net/manual/en/language.types.callable.php)。从 5.3 开始，最好的方法是使用匿名函数：

```
spl_autoload_register(function($class) {
    include 'classes/' . $class . '.class.php';
}); 
```

这样做的主要优点`__autoload`当然是您可以`spl_autoload_register`多次调用，而`__autoload`（像任何函数一样）只能定义一次。如果你有模块化代码，这将是一个很大的缺点。

* * *

2018 年对此的更新：实际上不应该有那么多场合*需要*滚动自己的自动加载器。有一个被广泛接受的标准（称为[PSR-4](https://www.php-fig.org/psr/psr-4/)）和几个符合要求的实现。这样做的明显方法是使用[Composer](https://getcomposer.org/)。

# groovy - Groovy：如何在屏幕上的同一位置写一行？（视窗）

> ID：10687805
> 
> 赞同：6
> 
> 时间：2012-05-21T15:05:02.690
> 
> 标签：groovy

我想在 groovy 中显示Advance %，所以我想写在同一个位置，这意味着而不是看到：

```
1%
2%
3%
... 
```

用户将看到数字在同一位置发生变化。我怎么做？（我在窗户上工作）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T18:37:00.263

我经常这样做，只是使用没有换行的回车：

```
printf "%5d\r", loopval 
```

每次通过您的循环，打印将在行首重新开始。

如果在发生这种情况时应该打印出任何其他消息，尤其是当其他消息包含换行符时，它可能会变得有点混乱。但这是一个廉价而肮脏的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:10:14.590

你可以使用 Groovy 自带的 jline：

```
(1..5).each {
  print "Done $it of 5"
  Thread.sleep( 1000 )
  print jline.ANSIBuffer.ANSICodes.left( 9999 )
} 
```

只要您的控制台支持 ANSI 转义序列，那应该可以工作......

PS：我使用 9999 因为（[如左文档中所述](http://jline.sourceforge.net/apidocs/jline/ANSIBuffer.ANSICodes.html#left%28int%29)）

> 如果 n 大于或等于当前游标列，则游标移动到第一列

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-30T20:04:06.867

对于遇到此问题的任何人-我发现使用以下方法是最佳解决方案：

```
(0..100).each {
    print "\r$it%"
}
println() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T08:02:54.500

正如 Danny Y. 已经说过的，换行将起作用，退格也可以解决问题：

```
(0..100).each {
  print "\b"*20+it+"%"
  sleep 100
} 
```

我曾经不得不覆盖多行输出 - 我找到的解决方案是

```
print "\r\n"*80 
```

为了将所有旧内容滚动出屏幕 - 这不是一个好的解决方案，但它适用于 Windows shell :-)

# c# - 由 ASP.NET Web 应用程序设置的 Cookie 的安全性如何？

> ID：10687812
> 
> 赞同：2
> 
> 时间：2012-05-21T15:05:35.230
> 
> 标签：c#, asp.net, security, cookies, encryption

我想知道 cookie 的安全性以及它是否可以被设置它的应用程序以外的其他应用程序读取。

我想设置一个 cookie 来存储一些敏感数据供我的站点随时读取。

其他应用程序可以读取我的应用程序设置的 cookie 吗？如果是这样，我是否需要加密存储在 cookie 中的数据？

注意：我无权访问 SSL。

编辑：我要存储的信息是用户详细信息。我正在创建一个白标网站。根据特定 url 的请求（例如 www.mysite.com/joebloggs），我希望将有关 Joe Bloggs 的用户数据存储在客户端计算机上。当客户端返回 www.mysite.com 时，我希望从 cookie 中读取 Joe Bloggs 上的数据，以便跟踪它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T15:07:03.093

用户计算机中运行的任何代码（包括浏览器插件）始终可以读取和写入 cookie，您对此无能为力。（加密除外）

任何嗅探网络的人都可以读取和写入（如果适用）非 HTTPS 站点的所有 cookie。

其他域上的 Web 应用程序无法读取或写入 cookie，除非在兄弟域（例如`x.cloudapp.net`和`y.cloudapp.net`）的有限情况下（参见 cookie 抛掷）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:28:45.837

如果您可以避免在 cookie 中包含敏感数据，那将是最好的。由于正如在另一个答案中所说，用户计算机上的任何内容都可能受到损害。

但是，如果确实需要，则应始终加密数据。表单身份验证 cookie 的默认加密是通过 DPAPI 进行的，它使用运行 Web 应用程序的用户上下文和机器密钥，因此它不适合负载平衡环境。

在这种情况下，您应该通过数字证书（例如 RSA）进行加密。

对于您自己管理的 cookie，您必须使用 Crypto API，或者一些包装器或实用程序类，例如[这个](http://www.codeproject.com/Articles/13665/HttpSecureCookie-A-Way-to-Encrypt-Cookies-with-ASP)。对于表单身份验证 cookie，有一些[保护](http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx)设置可让您配置加密机制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:12:19.830

如果您对使用 SSL 的安全性不够关注，那么一个简单且相对直接的选择是为用户生成一个新的 Guid，将该 Guid 存储在您的数据库中，并将该 Guid 写入 cookie。

我绝对不会用它来保护信用卡或银行业务或任何高度敏感的东西，但如果您需要保护此类数据，那么 SSL 是最低要求。

归根结底，可以在没有 SSL 的情况下嗅探流量，因此任何通过网络发送的 cookie 都可能被具有恶意意图的人嗅探，如果该 cookie 用于识别您系统上的用户，那么他们可以非常轻松冒充该用户。使用 Guid 的好处是，如果有人确实找到了 1 个人的 cookie，他们将无法猜测模式来找出其他人的 cookie，因此虽然 1 个人可能会受到损害，但至少您的整个用户群不会！

Probably a reasonable approach would be to generate a guid, and an expiry date, encrypt them both and set that as the cookie - then check the expiry date when the user comes back with the cookie, and periodically change the guid. Again, this is by no means secure against network sniffing, but it does give some measure of security as well as the convenience of remembering users across sessions.

# javascript - Javascript - 取消选中数组未列出的所有元素

> ID：10687813
> 
> 赞同：0
> 
> 时间：2012-05-21T15:05:40.963
> 
> 标签：javascript, jquery, checkbox

给定一个值数组，我希望我的代码禁用与该值相关的所有元素（复选框），并取消选中之前检查过的任何它禁用的元素。最初我的代码只是禁用了它们并且没有取消选中它们：

```
function allow(j, extended){
    $('[id^="'+j+'_extended_"]').attr('disabled', 'disabled');
    for (var k = 0; k < extended.length; k++) {
        $("#"+j+"_extended_"+extended[k]).attr("disabled", ""); //IE
        $("#"+j+"_extended_"+extended[k]).removeAttr('disabled'); //Other Browers
    }
} 
```

但是，这将首先禁用每个元素，然后重新启用允许的元素。这不适用于检查/取消检查，因为它不应该检查新的，而只取消选中那些不再允许的。什么是最好的方法来取消选中最后被禁用的那些，让其他人保持选中/未选中？

感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:21:02.380

要更改对象的道具，请在 jquery 中使用此方法

```
$("#checkboxname").prop("checked","")// to uncheck
$("#checkboxname").prop("checked","checked")// to check 
```

在你的代码中

```
$("#"+j+"_extended_"+extended[k]).prop("checked", ""); 
```

我希望有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T00:06:34.870

我没有传入要启用的元素的数组，而是传入要禁用的元素的数组。这样我也可以明确地说取消选中它们。生成的代码如下所示：

```
function disallow(j, extended){
    //First, allow all.
    $('[id^="'+j+'_extended_"]').attr("disabled", ""); //IE
    $('[id^="'+j+'_extended_"]').removeAttr('disabled'); //Other Browers
    //Then remove any that are not allowed.
    for (var k = 0; k < extended.length; k++) {
        $("#"+j+"_extended_"+extended[k]).attr('disabled', 'disabled');
        $("#"+j+"_extended_"+extended[k]).attr("checked", ""); //IE
        $("#"+j+"_extended_"+extended[k]).removeAttr('checked'); //Other Browers
    }
} 
```

非常感谢那些花时间回复的人。

# c# - WPF。使用网格。单元格的大小已更改

> ID：10687814
> 
> 赞同：1
> 
> 时间：2012-05-21T15:05:47.883
> 
> 标签：c#, wpf, xaml

```
<Window x:Class="DemoWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" SizeToContent="WidthAndHeight" >
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Button Grid.Row="0" Grid.Column="0" Margin="2">Button</Button>
    </Grid>
</Window> 
```

启动后我看到窗口：

![在此处输入图像描述](../Images/5bf411456eb632f9625fb1a580b8ed57.png)

如果我稍微改变窗口的大小，我会看到下一个窗口：

![在此处输入图像描述](../Images/868466dc832df1124a5dff1db07a9635.png)

为什么按钮的大小会发生变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:11:28.863

这可能是（但有争议的）WPF 中的一个错误。您将您的网格声明为具有三个相同大小的行。该按钮仅占一排。

当触发调整大小时，WPF 会挤压您的按钮，因为它应该只显示在第一行。启动时*应该*是这样的：

![在此处输入图像描述](../Images/e0fc198fd24d3530934627684f3a91e7.png)

`MinHeight`您可以通过在 Window 上指定 a 来解决此问题：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" SizeToContent="WidthAndHeight" MinHeight="100"> 
```

# css - 将 CSS/JS 与单独页面上的冲突合并

> ID：10687823
> 
> 赞同：1
> 
> 时间：2012-05-21T15:06:39.797
> 
> 标签：css, optimization, request

这个问题的答案可能是“视情况而定”，但问它永远不会有坏处。

基本上，我有几个逻辑 css/js 文件（`everything`, `index`, `user`）。我无法将所有 CSS 合并到一个文件中，因为一些单独的页面共享样式规则并覆盖其中的一些组件。例如

```
/* everything.css */
body {
   /* lots of important rules here */
}

/* index.css */
body {
   background-color: blue;
}

/* user.css */
body {
   background-color: red;
} 
```

如您所见，由于这些冲突，我无法将所有 CSS 合并到一个文件中。这更适用于 JavaScript。

我的问题是：将每个页面的 CSS/JS 合并到一个文件中以减少请求数量是否更好，或者这是否超过了缓存单个文件以访问其他页面的好处。

`everything.css`相当大，但是一旦您访问`index`或`user`，它将被**缓存**，因此如果您访问另一个，则不必再次加载。 *另一方面*，将其分开会导致**额外**的请求。

对于每个页面有一个 CSS/JS 请求与切换页面时缓存的好处是否更好，是否有共识？

还有其他我忽略的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T20:16:57.600

一般情况下，您只希望每页只有一个 CSS 文件，您也可以将其设置为跨站点全局，以便可以对其进行缓存。

浏览器在开始渲染页面之前需要 CSS，并且初始 TCP 连接将受到启动缓慢和其他连接开销的影响（尽管现代浏览器会推测性地打开 TCP 连接以尝试克服其中的一些问题）

慢启动意味着将 CSS 作为两个文件检索可能比将其作为一个更大的文件检索要慢，而且它会释放连接以开始接收其他内容。

我真的会推荐阅读 John Rauser 的[TCP 和 Web 性能的下限](http://assets.en.oreilly.com/1/event/44/TCP%20and%20the%20Lower%20Bound%20of%20Web%20Performance%20Presentation.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:14:28.460

正如您所说，这取决于 - 如果您没有太多要链接的 css 和 javascript 文件，那么您实际上可以从拥有多个文件中看到一些性能优势。虽然每个文件都会产生一个单独的请求，但这些请求是由大多数浏览器并行完成的，这通常会为客户端带来轻微的性能提升（当然，由于额外的请求，服务器会受到更多的影响，但实际上这应该可以忽略不计）。

如果您正在查看每页 2 个 css 文件 - 1 个用于您的站点范围样式，1 个用于您的页面特定文件，我不会担心将它们组合成 1 个。但是，如果您有大约 20 个 css 文件，那么也许您应该将它们结合起来。

此外，您显然应该缩小您的 css 文件并在您的 Web 服务器上启用 gzip/deflate 压缩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:16:43.807

对于 JavaScript，我会说，*总是*将其连接并缩小到一个文件中。唯一的例外是带宽很重要（移动）。如果你有冲突，你可能没有正确组织你的 JavaScript。[在学习 JavaScript 设计模式](http://addyosmani.com/resources/essentialjsdesignpatterns/book/#detailnamespacing)中有一个很好的介绍如何在 JavaScript 中使用命名空间和模块。

对于 CSS，这取决于。我总是尝试将核心样式框架保持在一起，然后根据需要加载自定义样式。像[Less](http://lesscss.org/)这样的工具可以使这变得容易得多。

# ruby-on-rails - Sphinx 搜索：连接到 9312 上的 127.0.0.1 失败。连接被拒绝 - 连接(2)

> ID：10687828
> 
> 赞同：2
> 
> 时间：2012-05-21T15:07:17.720
> 
> 标签：ruby-on-rails, sphinx

我尝试在生产模式下在我的 Rails 应用程序中使用 Sphinx，但没有任何成功。每次，当我尝试运行我的搜索操作时，我都会收到一个错误：

> 连接到 9312 上的 127.0.0.1 失败。连接被拒绝 - 连接(2)

我也尝试将端口从 9312 更改为 9845，但没有更改（

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T07:47:06.397

所以，问题出在 searchd 守护进程上。我只是 pkill 旧进程并重新启动

> RAILS_ENV=生产 rake ts:restart

# hl7 - 如何访问用 nHapi 解析的 hl7 消息中的信息

> ID：10687837
> 
> 赞同：1
> 
> 时间：2012-05-21T15:08:05.487
> 
> 标签：hl7, nhapi

我正在学习如何使用 nHapi。正如许多人指出的那样，没有太多的文档。按照[这个](ftp://ftp.heanet.ie/disk1/sourceforge/n/project/nh/nhapi/Documentation/1.0/nHapi_1_0.pdf)文档，我已经能够使用库解析消息。但我不知道如何使用对象模型访问该消息（这是我真正希望 nHapi 做的）。本质上，我想将 HL7 消息作为字符串并使用对象模型访问它，就像 LINQ to SQL 获取数据库记录并让您将其作为对象访问一样。我发现[Parsing an HL7 without a priori messageType knowledge](https://stackoverflow.com/questions/8567345/parsing-an-hl7-without-apriori-messagetype-knowledge)，但它似乎是关于别的东西，因为帖子中的代码返回一个字符串而不是一个 HL7 对象（就像我需要的那样）。在[我上面链接的文档中](ftp://ftp.heanet.ie/disk1/sourceforge/n/project/nh/nhapi/Documentation/1.0/nHapi_1_0.pdf)他们似乎使用“查询”访问消息的各个部分——但我在库中找不到查询 IMessage 的材料。

这是我正在使用的代码，其中一行显示了我想要做什么......

导入 NHapi.Base 导入 NHapi.Base.Parser 导入 NHapi.Base.Model

```
Module Module1

Sub Main()

    Dim msg As String = "MSH|^~\&|SENDING|SENDER|RECV|INST|20060228155525||QRY^R02^QRY_R02|1|P|2.3|QRD|20060228155525|R|I||||10^RD&Records&0126|38923^^^^^^^^&INST|||"
    Dim myPipeParser As PipeParser = New PipeParser()
    Dim myImsg As IMessage = myPipeParser.Parse(msg)
    Dim msgType As String = myImsg.GetStructureName
    Dim mySendingFacilityName As String = myImsg.getSendingFacility()  //this is what I want

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:47:18.173

记住 HL7 消息，每个段必须以换行结束。

此外，您需要将消息解析回其实际类型，以便正确填充对象模型（请注意，当我使用 myPipeParser.Parse 时，它​​会从 NHapi.Model 转换回 QRY_R02 消息类型。 V23 库）。所以代码应该是这样的：

```
Imports NHapi.Model.V23.Message
Imports NHapi.Base.Parser
Imports NHapi.Base
Module Module1

Sub Main()
    Dim msg As String = "MSH|^~\&|SENDING|SENDER|RECV|INST|20060228155525||QRY^R02^QRY_R02|1|P|2.3" & vbNewLine & _
    "QRD|20060228155525|R|I||||10^RD&Records&0126|38923^^^^^^^^&INST|||"
    Dim myPipeParser As PipeParser = New PipeParser()
    Dim myImsg As QRY_R02 = myPipeParser.Parse(msg)
    Dim msgType As String = myImsg.GetStructureName
    Dim mySendingFacilityName As String = myImsg.MSH.SendingFacility.NamespaceID.Value
    Console.WriteLine(mySendingFacilityName)
    Console.ReadLine()

End Sub

End Module 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-08T16:47:57.233

我知道那是很久以前的事了，但是我最近在寻找这个资源，发现几乎没有关于如何使用这个 API 的文档。优秀的示例源代码可以在项目 NHapi.NUnit 的源代码测试部分中找到。来源可以在[这里找到](https://github.com/duaneedwards/nHapi)

# ruby-on-rails - 如何将 Ruby on Rails 3.2 与“yui 3.5”一起使用？

> ID：10687838
> 
> 赞同：0
> 
> 时间：2012-05-21T15:08:06.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, yui

我正在用 YUI 框架编写我的第一个 RoR 应用程序。我尝试用谷歌搜索 ror+yui 手册，但没有成功。所以我去了YUI网站。[YUI](http://yuilibrary.com/yui/quick-start/)说：

```
// Put the YUI seed file on your page.
<script src="http://yui.yahooapis.com/3.5.1/build/yui/yui-min.js"></script> 
```

它应该放在 RoR 应用程序的哪个位置？

我试过了`app/assert/javascripts/yui-min.js`。

结果我进入`<html class="yui3-js-enabled">`了每一页。假设 YUI 现在正在工作，我尝试将“*使用 DOM* ”示例从[YUI 的页面](http://yuilibrary.com/yui/quick-start/)复制粘贴到`app/public/index.html`.

我收到的错误是：

`Uncaught ReferenceError: YUI is not defined`.

我尝试了此链接中的信息，但对我没有帮助：

[https://stackoverflow.com/questions/1452829/tutorial-suggestions-on-yui-with-ruby-on-rails](https://stackoverflow.com/questions/1452829/tutorial-suggestions-on-yui-with-ruby-on-rails)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:39:11.610

在任何 Rails 应用程序中，您的第一步是删除 app/public/index.html ...然后在 Rails 内的页面中工作。

所以这意味着创建一个 app/views/layouts/application.html，这就是你添加你的

```
<html>
  <head>
    <script src="http://yui.yahooapis.com/3.5.1/build/yui/yui-min.js"></script> 
```

根据链接，您可能没有它，`<head>`它需要。

更新：（更改 h1 的示例 javascript 代码）

```
<script>
    YUI().use('node', function (Y) {
      var headerElement     = Y.one('h1');
      headerElement.setHTML("I have been updated");
    });
</script> 
```

# facebook - 如何获取发送请求的用户的 id？

> ID：10687839
> 
> 赞同：0
> 
> 时间：2012-05-21T15:08:07.977
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

在我的应用程序中有一个 MultiFriendSelector 来邀请朋友。

我希望收件人在画布页面中看到通过 MultiFriendSelector 发送请求的用户的 ID。

我需要在不使用 PHP 或其他服务器端语言的情况下获取 id，但我可以使用 javascript 或 fbml 例如。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:01:50.943

我相信 Multifriend 选择器是一个**[用户-用户请求](https://developers.facebook.com/docs/requests/)**，一个典型的请求如下所示（from 属性会告诉你请求发件人信息）

```
{
  "id": "REQUEST_OBJECT_ID", 
  "application": {
    "name": "APP_DISPLAY_NAME", 
    "canvas_name": "APP_NAME",  // This is identical to the app namespace
    "namespace": "APP_NAMESPACE", 
    "id": "APP_ID"
  }, 
  "from": {
    "name": "SENDER_USER_NAME", 
    "id": "SEND_USER_ID"
  }, 
  "message": "Check out this Awesome Request!", 
  "created_time": "2012-01-24T00:43:22+0000", 
  "type": "apprequest"
} 
```

# c# - 在没有 3rd 方库的情况下设置 Twitter OAuth

> ID：10687841
> 
> 赞同：6
> 
> 时间：2012-05-21T15:08:15.100
> 
> 标签：c#, oauth, twitter-oauth, sha1, hmac

继续[获取 twitter 公共时间线，json+C#，无 3rd 方库](https://stackoverflow.com/questions/10673158/get-twitter-public-timeline-jsonc-no-3rd-party-libraries)

我还是 C# 和 oAuth 的新手，所以如果我什么都不懂，请多多包涵

我创建了一个名为 oAuthClass 的 C# 类，这些是我目前拥有的变量：

```
 static class oAuthClass
{
    public static void run()
    {
        int oauth_timestamp = GetTimestamp(DateTime.Now);
        string oauth_nonce = PseudoRandomStringUsingGUID();
        string oauth_consumer_key = "consumer key here";
        string oauth_signature_method = "HMAC-SHA1";
        string oauth_version = "1.0";
    }
} 
```

我已经阅读了 OAuth 签名，我现在选择使用 HMAC-SHA1，我不知道如何生成签名，在阅读和看到诸如 HTTP-Encodings 和 Base-Strings 之类的东西后我也非常困惑等等（我根本不知道它们是什么意思），但我的猜测是创建一个“Http 编码”的 URL，比如空格->“%20”？

总而言之：-什么是基本字符串？

-我在空格->%20 示例上是否正确？

-HMAC-SHA1 涉及消息和密钥，消费者对消息保密吗？那么消费者钥匙是钥匙吗？

-如何通过使用 HMAC-SHA1 算法创建签名

- 如果我确实创建了签名，我如何将这些值传递给 Twitter？

我可以使用

```
http://example.com?consumer_key=asdf&oauth_signature=signaturevalue&etc., 
```

但我读过并且显然人们使用 HTTP-Headers 或其他东西（同样，我真的不知道这是什么）

谢谢！同样，不允许使用 3rd 方库:(

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-21T19:35:46.577

很难以简短的方式回答您的问题，因为实现完整的 OAuth 客户端并非易事，并且需要真正了解 OAuth1.0a 规范。这不是火箭科学，但它确实需要整理所有的点点滴滴。

我将尝试逐条回答您的问题。

> 什么是基本字符串？

OAuth 中的签名基本字符串是这样构建的：

*   从您发送的请求的 HTTP 方法开始，大写。例如`POST`或`GET`。
*   向其中添加与号 ( `&`) 字符
*   添加您在请求中调用的 URL 编码（百分比编码）URL（此处不要包含参数）
*   在此处添加另一个与号 ( `&`) 字符
*   最后添加 URL 编码的参数字符串

我将描述如何在最后一步创建您需要的参数字符串。

收集请求中包含的所有参数。您可以在 URL 中作为查询字符串的一部分找到它们，也可以在您执行请求时在请求正文中找到它们`POST`。例如，假设您正在`POST`将参数`parameter1=value1`添加到 URL `http://example.com/?parameter2=value2`。这使得包含两个参数。

现在，您还必须总结协议满意所需的所有 OAuth 参数。这些将导致参数列表看起来像这样：

*   `oauth_consumer_key=fffffaaaafffaaaff`
*   `oauth_nonce=aaaaabbbbbcccccaaaaudi2313`
*   `oauth_signature_method=HMAC-SHA1`
*   `oauth_timestamp=1319633599`
*   `oauth_token=bbbbbbbbbfsdfdsdfsfserwerfsddffdsdf`
*   `oauth_version=1.0`
*   `parameter1=value1`
*   `parameter2=value2`

所有这些单独的字符串都需要按参数名称按字典顺序排序（按字母顺序就足够了），并连接成一个字符串。那是你的参数字符串。

> 我在空格->%20 示例上是否正确？

是的。您在谈论百分比编码，它也称为 HTTP 编码和 URL 编码。[http://en.wikipedia.org/wiki/Percent-encoding](http://en.wikipedia.org/wiki/Percent-encoding)。

> HMAC-SHA1 涉及到消息和密钥，消费者对消息是保密的吗？那么消费者钥匙是钥匙吗？

该消息是您在上面创建的签名基本字符串。关键是你的消费者秘密和你的访问令牌秘密的组合。所以键应该是这样的：（`CONSUMER_SECRET&TOKEN_SECRET`注意与号）。在您执行的绝对第一个请求中，您还没有令牌秘密，那么密钥只有`CONSUMER_SECRET&`（再次注意＆符号）。

> 如何通过使用 HMAC-SHA1 算法创建签名。

我从[http://oauth.googlecode.com/svn/code/csharp/OAuthBase.cs](http://oauth.googlecode.com/svn/code/csharp/OAuthBase.cs)获取了这个，并且假定秘密和基本字符串可用于代码。

基本上为 HMACSHA1 实例提供密钥和消息，呈现该哈希并将其转换为 base64 字符串。

```
HMACSHA1 hmacsha1 = new HMACSHA1();
hmacsha1.Key = Encoding.ASCII.GetBytes(string.Format("{0}&{1}", UrlEncode(consumerSecret), string.IsNullOrEmpty(tokenSecret) ? "" : UrlEncode(tokenSecret)));
byte[] dataBuffer = System.Text.Encoding.ASCII.GetBytes(signatureBaseString);
byte[] hashBytes = hmacsha1.ComputeHash(dataBuffer);

return Convert.ToBase64String(hashBytes); 
```

> 如果我确实设法创建了签名，我如何将这些值传递给 Twitter？

您应该能够轻松研究什么是 HTTP 标头。

但是您可以选择将参数和签名的最终结果添加到 URL，我认为 Twitter 甚至在某些请求的请求正文中接受它们。但首选方式是通过`Authorization`HTTP 标头，因为它允许明确区​​分协议特定参数和请求特定参数。

它应该看起来像这样（直接取自[OAuth 1.0a 规范](https://www.rfc-editor.org/rfc/rfc5849#section-3.5.1)）：

```
Authorization: OAuth realm="Example",
    oauth_consumer_key="0685bd9184jfhq22",
    oauth_token="ad180jjd733klru7",
    oauth_signature_method="HMAC-SHA1",
    oauth_signature="wOJIO9A2W5mFwDgiDvZbTSMK%2FPY%3D",
    oauth_timestamp="137131200",
    oauth_nonce="4572616e48616d6d65724c61686176",
    oauth_version="1.0" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:31:51.243

如果您真的很困惑并且只想使用一个简单的库，我建议您查看[Twitterizer](http://www.twitterizer.net/)

那里的文档有示例，而且很容易设置。

[编辑] 哎呀，抱歉刚刚读到您不是在寻找第 3 方库。对不起

# performance - 放入 PDF 中的图像格式以快速渲染

> ID：10687843
> 
> 赞同：1
> 
> 时间：2012-05-21T15:08:23.780
> 
> 标签：performance, image, pdf, rendering, mupdf

我想知道 PDF 中哪种图像格式的渲染速度最快。我测试了 mupdf 代码，发现图像解码在渲染时间中起着重要作用。所以我想知道是否有图像格式不会对 cpu 负载产生太大影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:31:41.710

我不认为这真的是一个问题，即在 PDF 中什么是最好的，但是：

作为一般规则，我一直发现将图像的大小预渲染为您希望在屏幕上呈现的实际大小是使大小和渲染速度达到您想要的大小和渲染速度的最佳方式。简单地将图像拖入文档不会降低像素数（因此大小），因为大多数文档类型只是在整个图像周围放置一个显示大小标签。这导致显示程序必须实时调整图像的大小以进行显示。显示程序需要实时调整图像大小的次数越少，它显示的速度就越快。

至于文件类型：位图通常被认为是显示速度最快的，因为它们（大部分）是将每个像素的颜色复制并粘贴到屏幕像素上。它们通常被认为是最大的文件。根据您的图像，如果它们不嘈杂（有很多相同颜色的纯色运行），那么它们可以进行 RLE 编码。我见过很多 RLE 编码的图像确实比 JPEG 图像还要小，但它是非常有情景的。

JPEG 往往是最小的传输格式，而且通常显示得很快。作为一种观点，它们也是质量最低的图像（仔细看，如果你从一个非常干净的图像开始，除非使用无损压缩，否则 JPEG 压缩会增加噪声）

PNG往往是我的最爱。它们可以是无损压缩的，如果使用扁平的 PNG（即不是 ADOBE FIREWORKS PNG），它们可以相当小，并且可以生成快速渲染的清晰图像。

总结一下：我可能会推荐已预先调整大小并保存为您希望在屏幕上显示的大小的扁平 PNG。

# c# - 将列表与具有共同超类的自定义对象进行比较

> ID：10687844
> 
> 赞同：3
> 
> 时间：2012-05-21T15:08:28.563
> 
> 标签：c#, list, comparison

我有一个像这样构建的元模型：

```
class ModelElement
{
    string id;
}

class Package : ModelElement
{
     List<Package> nestedPackages;
     List<Class> ownedClasses;
}

class Class : ModelElement
{
} 
```

现在我已经建立了两个模型，我想检查它们是否相同。我想比较元素的 ID，我不想为任何类型的元素编写方法。

```
Package a; //pretend both have classes
Package b; //and nested packages
compare(a.nestedPackages, b.nestedPackages);
compare(a.ownedClasses; b.OwnedClasses); 
```

由于 Class 和 Package 都继承自 ModelElement，因此都有 ID。所以我想写一个比较ID的函数“比较”。我想过使用泛型，但泛型数据类型没有属性“id”。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:10:51.407

您可以查看`Enumerable.SequenceEqual`，结合自定义比较器。

```
bool equal = Enumerable.SequenceEqual(a.nestedPackages, b.nestedPackages,
    new ModelElementComparer());

public class ModelElementComparer : IEqualityComparer<ModelElement>
{
    public bool Equals(ModelElement x, ModelElement y)
    {
        return x.id == y.id;
    }

    public int GetHashCode(ModelElement obj)
    {
        return x.id;
    }
} 
```

以下是指向[此特定 SequenceEqual 覆盖](http://msdn.microsoft.com/en-us/library/bb342073)和[IEqualityComparer 接口](http://msdn.microsoft.com/en-us/library/ms132151.aspx)的 MSDN 链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:22:46.957

您可以覆盖 ModelElement 类上的 Object.Equals() 方法，而不是编写比较方法

```
public override bool Equals(Object obj) 
{
   //Check for null and compare run-time types.
   if (obj == null || GetType() != obj.GetType()) 
      return false;
   ModelElement m = (ModelElement)obj;
   return (id == m.id);
} 
```

如果您这样做，您还需要覆盖 Object.GetHashCode()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:10:07.750

`Except`带有自定义比较器的 Linq 之类的东西可能在这里工作：

[http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)

一个空的结果可枚举将意味着没有差异。

# c# - Task.Factory.StartNew 或 Parallel.ForEach 用于许多长时间运行的任务？

> ID：10687850
> 
> 赞同：11
> 
> 时间：2012-05-21T15:08:38.303
> 
> 标签：c#, .net, c#-4.0, task-parallel-library, parallel-for

> **可能重复：**
> [Parallel.ForEach vs Task.Factory.StartNew](https://stackoverflow.com/questions/5009181/parallel-foreach-vs-task-factory-startnew)

我需要`ThreadPool`每晚运行大约 1,000 个任务（这个数字将来可能会增加）。每个任务都在执行长时间运行的操作（从 Web 服务读取数据）并且**不是 CPU 密集型**的。`Async I/O`不是此特定用例的选项。

给定一个`IList<string>`参数，我需要`DoSomething(string x)`. 我试图在以下两个选项之间进行选择：

```
IList<Task> tasks = new List<Task>();
foreach (var p in parameters)
{
    tasks.Add(Task.Factory.StartNew(() => DoSomething(p), TaskCreationOptions.LongRunning));
}
Task.WaitAll(tasks.ToArray()); 
```

或者

```
Parallel.ForEach(parameters, new ParallelOptions {MaxDegreeOfParallelism = Environment.ProcessorCount*32}, DoSomething); 
```

哪个选项更好，为什么？

***笔记 ：***

答案应包括 和 的用法之间的`TaskCreationOptions.LongRunning`比较`MaxDegreeOfParallelism = Environment.ProcessorCount * SomeConstant`。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-21T18:02:40.990

也许您没有意识到这一点，但`Parallel`类中的成员只是对象周围的简单（复杂）包装器`Task`。如果您想知道，`Parallel`该类`Task`使用`TaskCreationOptions.None`. 但是，`MaxDegreeOfParallelism`无论将什么创建选项传递给任务对象的构造函数，都会影响这些任务对象。

`TaskCreationOptions.LongRunning`给底层一个“提示” `TaskScheduler`，它可能在线程超额订阅时表现更好。超额订阅适用于高延迟的线程，例如 I/O，因为它会将多个线程（是线程，不是任务）分配给单个内核，以便它始终有事可做，而不是等待当线程处于等待状态时完成的操作。在`TaskScheduler`使用 的情况下`ThreadPool`，它将*在*自己的专用线程上运行 LongRunning 任务（每个任务都有一个线程的唯一情况），否则它将正常运行，调度和工作窃取（真的，无论如何你想要什么）

`MaxDegreeOfParallelism`控制运行的并发操作数。它类似于指定数据将被拆分和处理的最大分区数。如果`TaskCreationOptions.LongRunning`能够被指定，所有这一切都会限制一次运行的任务数量，类似于将`TaskScheduler`最大并发级别设置为该值的 a，[类似于此示例](http://msdn.microsoft.com/en-us/library/ee789351.aspx)。

你可能想要`Parallel.ForEach`. 但是，添加`MaxDegreeOfParallelism`等于这么大的数字实际上并不能保证同时运行那么多线程，因为任务仍然由`ThreadPoolTaskScheduler`. 该调度程序将一次运行的线程数尽可能减少，我认为这是两种方法之间的最大区别。您可以编写（并指定）您自己的`TaskScheduler`模仿最大程度的并行行为，并拥有两全其美，但我怀疑您有兴趣做的事情。

我的猜测是，根据延迟和您需要执行的实际请求的数量，使用任务在许多（？）情况下会表现得更好，尽管最终会使用更多的内存，而并行在资源使用方面会更加一致。当然，异步 I/O 的性能将比这两个选项中的任何一个都好，但我知道你不能这样做，因为你使用的是遗留库。所以，不幸的是，无论你选择哪一个，你都会陷入平庸的表现。

一个真正的解决方案是想办法让异步 I/O 发生。由于我不了解情况，因此我认为没有比这更有帮助的了。您的程序（读取、线程）将继续执行，内核将等待 I/O 操作完成（这也称为使用 I/O 完成端口）。因为线程不处于等待状态，所以运行时可以在更少的线程上做更多的工作，这通常最终会在内核数和线程数之间达到最佳关系。正如我所希望的那样，添加更多线程并不等同于更好的性能（实际上，由于上​​下文切换之类的原因，它通常会损害性能）。

但是，整个答案对于确定您的问题的*最终*答案是没有用的，尽管我希望它会给您一些需要的方向。在您对其进行分析之前，您不会知道什么表现更好。如果您不同时尝试它们（我应该澄清我的意思是没有 LongRunning 选项的任务，让调度程序处理线程切换）并分析它们以确定最适合*您的特定用例的方法*，那么您就是在卖空自己。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T18:13:32.593

这两个选项都完全不适合您的方案。

`TaskCreationOptions.LongRunning`对于不受 CPU 限制的任务来说，这无疑是一个更好的选择，因为 TPL（`Parallel`类/扩展）几乎专门用于通过在多个内核（而不是线程）上运行受 CPU 限制的操作来最大化其吞吐量。

然而，1000 个任务是一个不可接受的数字。它们是否同时运行并不是问题所在。即使 100 个线程在同步 I/O 上等待也是站不住脚的。正如其中一条评论所暗示的那样，您的应用程序将使用大量内存并最终将几乎所有时间都花在上下文切换上。TPL 不是为这种规模设计的。

如果您的操作受 I/O 限制——并且如果您正在使用 Web 服务，*那么它们就是*——那么异步 I/O 不仅是正确的解决方案，而且是*唯一*的解决方案。如果您必须重新设计您的某些代码（例如，将异步方法添加到原来没有的主要接口），*请执行此操作*，因为 I/O 完成端口是Windows 或 .NET 中*唯一*的机制可以适当地支持这种特定类型的并发。

我从未听说过异步 I/O 以某种方式“不是一种选择”的情况。我什至无法为这个约束设想任何有效的用例。如果您无法使用异步 I/O，那么这表明存在必须*尽快*修复的严重设计问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T19:17:11.030

虽然这不是直接比较，但我认为它可能会对您有所帮助。我做了类似于你描述的事情（在我的情况下，我知道在另一端有一个负载平衡的服务器集群服务于 REST 调用）。**如果我还使用以下代码**告诉我的操作系统它可以连接到比通常数量更多的端点，我可以使用`Parrallel.ForEach`启动最佳数量的工作线程来获得良好的结果。

 **```
 var servicePointManager = System.Net.ServicePointManager.FindServicePoint(Uri);
    servicePointManager.ConnectionLimit = 250; 
```

请注意，您必须为连接到的每个唯一 URL 调用一次。**

# javascript - fb.login 响应始终返回 true

> ID：10687851
> 
> 赞同：0
> 
> 时间：2012-05-21T15:08:48.663
> 
> 标签：javascript, jquery, facebook, facebook-login

为了检查 suer 是否提供了所有需要的权限，我这样做：

```
 FB.login(function(response){
             console.log(response.status);
            if (response.status == 'connected') {
               /* user gave permssions */
            }else{
                 /* user didnt, unmark the checkbox */
                 $('input:checkbox').removeAttr('checked');
            }
    }, { scope: 'publish_stream' }); 
```

问题是这总是返回 true，如果用户：登录、省略或关闭弹出窗口无关紧要。

知道为什么吗？

还尝试过： if (response.authResponse) { 没有成功..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:31:06.333

这里的问题是`publish_stream`扩展[权限](https://developers.facebook.com/docs/authentication/permissions/#extended_perms)，这意味着用户可以选择退出该权限。一般来说，当用户点击回调中的代码块时，他们已经验证了您的应用程序，但不一定具有您要求的所有权限，因为其中一些权限可以[扩展权限](https://developers.facebook.com/docs/authentication/permissions/#extended_perms)。`response.status`仅用于传达用户是否已对应用程序进行身份验证的状态，而不是他们是否已接受您请求的所有对话框提示/权限。在您的情况下，`publish_stream`是扩展权限，因此您不能保证在回调中拥有该用户的权限。如果您要求`publish_stream`作为用户已经通过身份验证后的增量权限，那么您的条件检查`response.status`将始终返回 true（因为根据定义，用户已经对您的应用程序进行了身份验证）。

如果要验证您在回调中是否具有权限，请使用图形 api 上的端点`publish_stream`检查权限。`/me/permissions`

你想要的是这样的：

```
FB.login(function(response){
    if (response.status == 'connected') {
        FB.api('/me/permissions', function(response) {
            var permsArray = response.data[0];
            // Permissions that are needed for the app
            var permsNeeded = ['publish_stream'];
            var permsToPrompt = [];
            for (var i in permsNeeded) {
                if (permsArray[permsNeeded[i]] == null) {
                    permsToPrompt.push(permsNeeded[i]);
                }
            }

            if (permsToPrompt.length > 0) {
                $('input:checkbox').removeAttr('checked');
            }
         }
    } else {
        /* user didnt, unmark the checkbox */
        $('input:checkbox').removeAttr('checked');
    }
}, { scope: 'publish_stream' }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:47:57.173

我不知道为什么，但至少下面的代码对我来说很好用~

```
window.fbAsyncInit = function() {
  FB.init({
  appId      : '<?php echo FACEBOOK_APP_ID ?>',
  status     : true, 
  cookie     : true,
  xfbml      : true,
  oauth      : true,
  });
 FB.getLoginStatus(function(response){
  if (response.status === 'connected') {
    // the user is logged in and has authenticated your
    // app, and response.authResponse supplies
    // the user's ID, a valid access token, a signed
    // request, and the time the access token 
    // and signed request each expire
    var uid = response.authResponse.userID;
    var accessToken = response.authResponse.accessToken;
    var signed_request = response.authResponse.signedRequest;
    // avoid using cookie
    self.location= "<?php echo site_url()?>/signup/fb_login/"+uid;

  } else if (response.status === 'not_authorized') {
    // the user is logged in to Facebook, 
    // but has not authenticated your app
    FB.login(function(response) {
    if (response.authResponse) {
      self.location="<?php echo site_url()?>/signup/fb_register";
      /* FB.api('/me', function(response) { */
      /*   }); */
    }  }, {scope: 'email,user_hometown'});
  } else { // unknown
    // the user isn't logged in to Facebook.
  }
});
  FB.Event.subscribe('auth.login', function(response) {
      window.location.reload();
    });
    FB.Event.subscribe('auth.logout', function(response) {
      window.location.reload();
    });
 };
(function(d){
 var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
  js = d.createElement('script'); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js";
  d.getElementsByTagName('head')[0].appendChild(js);
  }(document)); 
```

`

# sql-server - 如何在 SQL Server 中将多行组合成逗号分隔的列表？

> ID：10687857
> 
> 赞同：5
> 
> 时间：2012-05-21T15:09:19.920
> 
> 标签：sql-server, tsql

> **可能重复：**
> [SQL Server：我可以用逗号将多行分隔为一列吗？](https://stackoverflow.com/questions/2046037/sql-server-can-i-comma-delimit-multiple-rows-into-one-column)

我有表 X(X_ID, X_Name) 是 1-M 表 Y(Y_ID, Y_Value)

表十：

```
X_ID    X_Name
----    ------
12      foo
14      foo2
16      foo3 
```

表 Y：

```
X_ID    Y_Value
----    -------
12      A
12      B
14      C
14      D
14      E
16      F
16      G 
```

如何使用 T-Sql 获得以下结果？

```
X_ID   X_Name   Y_Value
----   ------   ------
12     foo      A,B
14     foo2     C,D,E
16     foo3     F,G 
```

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-21T15:14:22.250

```
SELECT X.X_ID, X.X_Name, Y_Values = STUFF((SELECT N',' + Y_Value FROM dbo.Y
  WHERE Y.X_ID = X.X_ID
  FOR XML PATH(''), 
  TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'')
  FROM dbo.X; 
```

在 SQL Server 2017 和 Azure SQL 数据库中，您可以使用新[`STRING_AGG()`](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql)功能：

```
SELECT x.X_ID, x.X_Name, 
    Y_Values = STRING_AGG(Y.Y_Value,',')
  FROM dbo.X
  INNER JOIN dbo.Y
  ON X.X_ID = Y.X_ID
  GROUP BY x.X_ID, x.X_Name; 
```

如果您不喜欢默认顺序，可以使用以下命令指定`WITHIN GROUP`：

```
SELECT x.X_ID, x.X_Name, 
    Y_Values = STRING_AGG(Y.Y_Value,',') WITHIN GROUP (ORDER BY Y.Y_Value)
  FROM dbo.X
  INNER JOIN dbo.Y
  ON X.X_ID = Y.X_ID
  GROUP BY x.X_ID, x.X_Name; 
```

# c# - C#中特定html标签的正则表达式

> ID：10687858
> 
> 赞同：-6
> 
> 时间：2012-05-21T15:09:20.473
> 
> 标签：c#, html, regex, web-scraping

我正在尝试从谷歌产品页面抓取特定的 html 标签，包括它们的数据。我想得到这个有序列表中的所有 <li> 标签并将它们放在一个列表中。

这是代码：

```
 <td valign="top">
        <div id="center_col">
          <div id="res">
            <div id="ires">
              <ol>
                   <li class="g">
                  <div class="pslires">
                    <div class="psliimg">
                      <a href=
                      "https://www.google.com">
                     </a>
                    </div>

                    <div class="psliprice">
                      <div>
                        <b>$59.99</b> used
                      </div><cite>google auctions</cite>
                    </div>

                    <div class="pslimain">
                      <h3 class="r"><a href=
                      "https://www.google.com">
                      google</a></h3>

                      <div>
                 dummy data     </div>
                    </div>
                  </div>
                </li>

                 <li class="g">
                  <div class="pslires">
                    <div class="psliimg">
                      <a href=
                      "https://www.google.com">
                     </a>
                    </div>

                    <div class="psliprice">
                      <div>
                        <b>$59.99</b> used
                      </div><cite>google auctions</cite>
                    </div>

                    <div class="pslimain">
                      <h3 class="r"><a href=
                      "https://www.google.com">
                      google</a></h3>

                      <div>
                 dummy data     </div>
                    </div>
                  </div>
                </li>

              <li class="g">
                  <div class="pslires">
                    <div class="psliimg">
                      <a href=
                      "https://www.google.com">
                     </a>
                    </div>

                    <div class="psliprice">
                      <div>
                        <b>$59.99</b> used
                      </div><cite>google auctions</cite>
                    </div>

                    <div class="pslimain">
                      <h3 class="r"><a href=
                      "https://www.google.com">
                      google</a></h3>

                      <div>
                 dummy data     </div>
                    </div>
                  </div>
                </li>
                <li class="g">
                  <div class="pslires">
                    <div class="psliimg">
                      <a href=
                      "https://www.google.com">
                     </a>
                    </div>

                    <div class="psliprice">
                      <div>
                        <b>$59.99</b> used
                      </div><cite>google auctions</cite>
                    </div>

                    <div class="pslimain">
                      <h3 class="r"><a href=
                      "https://www.google.com">
                      google</a></h3>

                      <div>
                 dummy data     </div>
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>
        </div>

        <div id="foot">
          <p class="flc" id="bfl" style="margin:19px 0 0;text-align:center"><a href=
          "/support/websearch/bin/answer.py?answer=134479&amp;hl=en">Search Help</a>
          <a href=
          "/quality_form?q=Pioneer+Automotive+PF-555-2000&amp;hl=en&amp;tbm=shop">Give us
          feedback</a></p>

          <div class="flc" id="fll" style="margin:19px auto 19px auto;text-align:center">
            <a href="/">Google&nbsp;Home</a> <a href=
            "/intl/en/ads">Advertising&nbsp;Programs</a> <a href="/services">Business
            Solutions</a> <a href="/intl/en/policies/">Privacy &amp; Terms</a> <a href=
            "/intl/en/about.html">About Google</a>
          </div>
        </div>
      </td> 
```

我想获取每个`<li class="g">`标签中的所有标签和数据。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:18:01.313

而不是使用 xml 解析器之类的正则表达式可能对您的情况更有用。将其加载到 xml 文档中，然后使用 SelectNodes 之类的东西来获取您正在寻找的数据

[http://msdn.microsoft.com/en-us/library/4bektfx9.aspx](http://msdn.microsoft.com/en-us/library/4bektfx9.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:41:07.353

I wouldn't use regex for this particular problem.

Instead I would attack it thus:

1)Save off page as html string. 2)Use aforementioned htmlagilitypack or htmltidy(my preference) to convert to XML. 3)Use xDocument to navigate through Dom object by tag and save data.

Trying to create a regex to extract data from a possibly fluid HTML page will break your heart.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:35:10.383

您可以使用正则表达式[`HtmlAgilityPack`](http://htmlagilitypack.codeplex.com/)来解析 HTML，而不是使用正则表达式。

```
var doc = new HtmlDocument();
doc.LoadHtml(html);
var listItems = doc.DocumentNode.SelectNodes("//li"); 
```

上面的代码将为您提供文档中的所有`<li>`项目。要将它们添加到列表中，您只需迭代集合并将每个项目添加到列表中。

# excel - excel vba自动过滤器不过滤日期

> ID：10687860
> 
> 赞同：1
> 
> 时间：2012-05-21T15:09:41.127
> 
> 标签：excel, vba

我有一列日期，它是数据库的输出。有一个在此日期上过滤的宏，旨在显示从当前日期起超过 14 天的所有日期，不包括空值。应用过滤器时过滤整个工作表并且不显示任何内容。当我取消 - 14 时，我确实得到了日期，我什至尝试使用 alt a、e、f 来确保该列的格式正确，但没有运气。

这是我的代码片段：

```
ActiveSheet.UsedRange.AutoFilter Field:=34, Criteria:="<>NULL", _
Operator:=xlAnd, Criteria2:="<" & Now()-14 
```

我试过`criteria2`改变`"<" & Date - 14 & "# 00:00:00 AM#"`

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:17:04.497

尝试这个

更改`Criteria:="<>NULL"`为`Criteria1:="<>NULL"`

**跟进**

代码不起作用，因为标题不在第 1 行中。一旦指定了确切的范围，它就开始工作了。

```
Option Explicit

Sub Sample()
    Dim lRow As Long

    lRow = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row

    ActiveSheet.AutoFilterMode = False

    ActiveSheet.Range("$A$2:$BV$" & lRow).AutoFilter Field:=34, Criteria1:="<>NULL" _
    , Operator:=xlAnd, Criteria2:="<" & Format(Date - 14, "0")
End Sub 
```

# hash - SHA1 无法生成的字符串

> ID：10687861
> 
> 赞同：0
> 
> 时间：2012-05-21T15:09:43.547
> 
> 标签：hash, passwords, sha1

如何生成或查找任何输入字符串的 SHA1 加密都无法生成的字符串？

我问这个的原因是因为我需要用户表中的全局密码占位符。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:12:57.780

实际上，这取决于您用于存储 SHA1 哈希的表示形式。但是就像有时在 /etc/passwd 中使用的 * 一样，应该可以工作。实际上空字符串也可以，但我会使用更明确的东西——比如 '*invalid'

如果您使用标准的十六进制表示（例如 '68ac906495480a3404beee4874ed853a037a7a8f'），您实际上可以使用不是 40 位十六进制数字的所有内容。使用一些 ascii char，最好不要在 [0-9a-f] 中，但不要在 [0-9a-zA-Z] 中。

# django - Django csrf 禁止在 url 变化

> ID：10687862
> 
> 赞同：0
> 
> 时间：2012-05-21T15:09:47.550
> 
> 标签：django, internationalization, csrf

嗨，我有一个用于在我的网站上切换语言的 html 模板：

```
<form action="{{ SITE_URL }}i18n/setlang/" name="postlink" method="post">{% csrf_token %}
    <ul class="lang">
        <li class="lang">
            {% for lang in LANGUAGES %}
                {% if lang.0 != LANGUAGE_CODE %}
                    <input type="hidden" name="language" value="{{ lang.0 }}">
                    <a class="active" href=# onclick="submitPostLink()">{{ lang.1 }}</a>
                {% else %}
                    {{ lang.1 }}
                {% endif %}
                {% if forloop.last %}{% else %} &nbsp; | &nbsp;{% endif %}
            {% endfor %}
        </li>
    </ul>
</form> 
```

**所有这些都可以在开发服务器以及生产和生产中正常工作，在www.mysite.com/project/**的正常 url

 **但是，如果我尝试 **project.mysite.com**或**mysite.com.project**，我会正常访问我的主页，但更改语言会导致 403 Forbidden 失败。

我是否需要在`setlang`某个地方定义我需要的根 url 变体？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:43:45.900

由于这些 url 在不同的子域上运行，您应该检查 CSRF cookie 的域设置`CSRF_COOKIE_DOMAIN`：[https ://docs.djangoproject.com/en/1.3/ref/contrib/csrf/#subdomains](https://docs.djangoproject.com/en/1.3/ref/contrib/csrf/#subdomains)**

# dependency-injection - 使用 DI 在 NLog 目标中设置属性

> ID：10687866
> 
> 赞同：2
> 
> 时间：2012-05-21T15:10:06.290
> 
> 标签：dependency-injection, inversion-of-control, nlog

我正在使用 NLog 并有一个自定义目标。我想在这个目标中注入一个依赖项。依赖项已在 Unity 容器中注册。我在 MVC 应用程序中，并且正在 Application_Start 中设置 DI 容器

这里有一个类似问题的答案[https://stackoverflow.com/a/9704442](https://stackoverflow.com/a/9704442)但我不确定如何将其应用于我的代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-29T17:41:53.777

重要的部分是设置这个自定义处理程序，这将为 nlog 使用的类型调用。确保在完成此操作并注册依赖项后初始化 nlog

```
register your instances
.....
ConfigurationItemFactory.Default.CreateInstance = (Type type) =>
{
    object instance;
    if(unity/ninject/etc.TryResolve(type, out instance))
      return instance;
    else
      return Activator.CreateInstance(type); //this is to support the other types that come with NLog
};
......
 ConfigureNLog(...) 
```

# python - 从多处理转向线程

> ID：10687870
> 
> 赞同：6
> 
> 时间：2012-05-21T15:10:14.517
> 
> 标签：python, multithreading, multiprocessing

在我的项目中，我使用`multiprocessing`该类来并行运行任务。我想`threading`改用它，因为它具有更好的性能（我的任务是 TCP/IP 绑定的，而不是 CPU 或 I/O 绑定的）。

`multiprocessing`具有出色的功能， as`Pool.imap_unordered`和`Pool.map_async`，在类中不存在`threading`。

将我的代码转换为使用的正确方法是什么`threading`？该文档介绍了`multiprocessing.dummy`该类，即该类的包装器`threading`。然而，这会引发很多错误（至少在 python 2.7.3 上）：

```
 pool = multiprocessing.Pool(processes)
  File "C:\python27\lib\multiprocessing\dummy\__init__.py", line 150, in Pool
    return ThreadPool(processes, initializer, initargs)
  File "C:\python27\lib\multiprocessing\pool.py", line 685, in __init__
    Pool.__init__(self, processes, initializer, initargs)
  File "C:\python27\lib\multiprocessing\pool.py", line 136, in __init__
    self._repopulate_pool()
  File "C:\python27\lib\multiprocessing\pool.py", line 199, in _repopulate_pool
    w.start()
  File "C:\python27\lib\multiprocessing\dummy\__init__.py", line 73, in start
    self._parent._children[self] = None
AttributeError: '_DummyThread' object has no attribute '_children' 
```

**编辑：**实际发生的是我有一个运行不同线程的 GUI（以防止 GUI 卡住）。该线程运行具有`ThreadPool`失败的特定搜索功能。

**编辑 2：**错误修复[已修复](http://bugs.python.org/issue14881)，并将包含在未来的版本中。很高兴看到一个崩溃修复！

```
import urllib2, htmllib, formatter
import multiprocessing.dummy as multiprocessing
import xml.dom.minidom
import os
import string, random
from urlparse import parse_qs, urlparse

from useful_util import retry
import config
from logger import log

class LinksExtractor(htmllib.HTMLParser):
    def __init__(self, formatter):
        htmllib.HTMLParser.__init__(self, formatter)
        self.links = []
        self.ignoredSites = config.WebParser_ignoredSites

    def start_a(self, attrs):
        for attr in attrs:
            if attr[0] == "href" and attr[1].endswith(".mp3"):
                if not filter(lambda x: (x in attr[1]), self.ignoredSites):
                    self.links.append(attr[1])

    def get_links(self):
        return self.links

def GetLinks(url, returnMetaUrlObj=False):
    '''
    Function gather links from a url.
    @param url: Url Address.
    @param returnMetaUrlObj: If true, returns a MetaUrl Object list.
                             Else, returns a string list. Default is False.

    @return links: Look up.
    '''
    htmlparser = LinksExtractor(formatter.NullFormatter())

    try:
        data = urllib2.urlopen(url)
    except (urllib2.HTTPError, urllib2.URLError) as e:
        log.error(e)
        return []
    htmlparser.feed(data.read())
    htmlparser.close()

    links = list(set(htmlparser.get_links()))

    if returnMetaUrlObj:
        links = map(MetaUrl, links)

    return links

def isAscii(s):
    "Function checks is the string is ascii."
    try:
        s.decode('ascii')
    except (UnicodeEncodeError, UnicodeDecodeError):
        return False
    return True

@retry(Exception, logger=log)
def parse(song, source):
    '''
    Function parses the source search page and returns the .mp3 links in it.
    @param song: Search string.
    @param source: Search website source. Value can be dilandau, mp3skull, youtube, seekasong.

    @return links: .mp3 url links.
    '''
    source = source.lower()
    if source == "dilandau":
        return parse_dilandau(song)
    elif source == "mp3skull":
        return parse_Mp3skull(song)
    elif source == "SeekASong":
        return parse_SeekASong(song)
    elif source == "youtube":
        return parse_Youtube(song)

    log.error('no source "%s". (from parse function in WebParser)')
    return []

def parse_dilandau(song, pages=1):
    "Function connects to Dilandau.eu and returns the .mp3 links in it"
    if not isAscii(song): # Dilandau doesn't like unicode.
        log.warning("Song is not ASCII. Skipping on dilandau")
        return []

    links = []
    song = urllib2.quote(song.encode("utf8"))

    for i in range(pages):
        url = 'http://en.dilandau.eu/download_music/%s-%d.html' % (song.replace('-','').replace(' ','-').replace('--','-').lower(),i+1)
        log.debug("[Dilandau] Parsing %s... " % url)
        links.extend(GetLinks(url, returnMetaUrlObj=True))
    log.debug("[Dilandau] found %d links" % len(links))

    for metaUrl in links:
        metaUrl.source = "Dilandau"

    return links

def parse_Mp3skull(song, pages=1):
    "Function connects to mp3skull.com and returns the .mp3 links in it"
    links = []
    song = urllib2.quote(song.encode("utf8"))

    for i in range(pages):
        # http://mp3skull.com/mp3/how_i_met_your_mother.html
        url = 'http://mp3skull.com/mp3/%s.html' % (song.replace('-','').replace(' ','_').replace('__','_').lower())
        log.debug("[Mp3skull] Parsing %s... " % url)
        links.extend(GetLinks(url, returnMetaUrlObj=True))
    log.debug("[Mp3skull] found %d links" % len(links))

    for metaUrl in links:
        metaUrl.source = "Mp3skull"

    return links

def parse_SeekASong(song):
    "Function connects to seekasong.com and returns the .mp3 links in it"
    song = urllib2.quote(song.encode("utf8"))

    url = 'http://www.seekasong.com/mp3/%s.html' % (song.replace('-','').replace(' ','_').replace('__','_').lower())
    log.debug("[SeekASong] Parsing %s... " % url)
    links = GetLinks(url, returnMetaUrlObj=True)
    for metaUrl in links:
        metaUrl.source = "SeekASong"
    log.debug("[SeekASong] found %d links" % len(links))

    return links

def parse_Youtube(song, amount=10):
    '''
    Function searches a song in youtube.com and returns the clips in it using Youtube API.
    @param song: The search string.
    @param amount: Amount of clips to obtain.

    @return links: List of links.
    '''
    "Function connects to youtube.com and returns the .mp3 links in it"
    song = urllib2.quote(song.encode("utf8"))
    url = r"http://gdata.youtube.com/feeds/api/videos?q=%s&max-results=%d&v=2" % (song.replace(' ', '+'), amount)
    urlObj = urllib2.urlopen(url, timeout=4)
    data = urlObj.read()
    videos = xml.dom.minidom.parseString(data).getElementsByTagName('feed')[0].getElementsByTagName('entry')

    links = []
    for video in videos:
        youtube_watchurl = video.getElementsByTagName('link')[0].attributes.item(0).value
        links.append(get_youtube_hightest_quality_link(youtube_watchurl))

    return links

def get_youtube_hightest_quality_link(youtube_watchurl, priority=config.youtube_quality_priority):
    '''
    Function returns the highest quality link for a specific youtube clip.
    @param youtube_watchurl: The Youtube Watch Url.
    @param priority: A list represents the qualities priority.

    @return MetaUrlObj: MetaUrl Object.
    '''
    video_id = parse_qs(urlparse(youtube_watchurl).query)['v'][0]
    youtube_embedded_watchurl = "http://www.youtube.com/embed/%s?autoplay=1" % video_id

    d = get_youtube_dl_links(video_id)
    for x in priority:
        if x in d.keys():
            return MetaUrl(d[x][0], 'youtube', d['VideoName'], x, youtube_embedded_watchurl)
    log.error("No Youtube link has been found in get_youtube_hightest_quality_link.")
    return ""

@retry(Exception, logger=log)
def get_youtube_dl_links(video_id):
    '''
    Function gets the download links for a youtube clip.
    This function parses the get_video_info format of youtube.

    @param video_id: Youtube Video ID.
    @return d: A dictonary of qualities as keys and urls as values.
    '''
    d = {}

    url = r"http://www.youtube.com/get_video_info?video_id=%s&el=vevo" % video_id

    urlObj = urllib2.urlopen(url, timeout=12)
    data = urlObj.read()
    data = urllib2.unquote(urllib2.unquote(urllib2.unquote(data)))
    data = data.replace(',url', '\nurl')
    data = data.split('\n')

    for line in data:
        if 'timedtext' in line or 'status=fail' in line or '<AdBreaks>' in line:
            continue

        try:
            url = line.split('&quality=')[0].split('url=')[1]
            quality = line.split('&quality=')[1].split('&')[0]
        except:
            continue
        if quality in d:
            d[quality].append(url)
        else:
            d[quality] = [url]

    try:
        videoName = "|".join(data).split('&title=')[1].split('&')[0]
    except Exception, e:
        log.error("Could not parse VideoName out of get_video_info (%s)" % str(e))
        videoName = ""

    videoName = unicode(videoName, 'utf-8')
    d['VideoName'] = videoName.replace('+',' ').replace('--','-')
    return d

class NextList(object):
    "A list with a 'next' method."
    def __init__(self, l):
        self.l = l
        self.next_index = 0

    def next(self):
        if self.next_index < len(self.l):
            value = self.l[self.next_index]
            self.next_index += 1
            return value
        else:
            return None

    def isEOF(self):
        " Checks if the list has reached the end "
        return (self.next_index >= len(self.l))

class MetaUrl(object):
    "a url strecture data with many metadata"
    def __init__(self, url, source="", videoName="", quality="", youtube_watchurl=""):
        self.url = str(url)
        self.source = source
        self.videoName = videoName # Youtube Links Only
        self.quality = quality # Youtube Links Onlys
        self.youtube_watchurl = youtube_watchurl # Youtube Links Onlys

    def __repr__(self):
        return "<MetaUrl '%s' | %s>" % (self.url, self.source)

def search(song, n, processes=config.search_processes):
    '''
    Function searches song and returns n valid .mp3 links.
    @param song: Search string.
    @param n: Number of songs.
    @param processes: Number of processes to launch in the subprocessing pool.
    '''
    linksFromSources = []
    pool = multiprocessing.Pool(processes)

    args = [(song, source) for source in config.search_sources]
    imapObj = pool.imap_unordered(_parse_star, args)
    for i in range(len(args)):
        linksFromSources.append(NextList(imapObj.next(15)))
    pool.terminate()

    links = []
    next_source = 0
    while len(links) < n and not all(map(lambda x: x.isEOF(), linksFromSources)):
        nextItem = linksFromSources[next_source].next()
        if nextItem:
            log.debug("added song %.80s from source ID %d (%s)" % (nextItem.url.split('/')[-1], next_source, nextItem.source))
            links.append(nextItem)

        if len(linksFromSources) == next_source+1:
            next_source = 0
        else:
            next_source += 1

    return links

def _parse_star(args):
    return parse(*args) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:29:27.173

我无法在我的机器上重现您的问题。你的`processes`变量中有什么？是`int`吗？

```
Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import multiprocessing.dummy as multiprocessing
>>> pool = multiprocessing.Pool(5)
>>> pool
<multiprocessing.pool.ThreadPool object at 0x00C7DF90>
>>> 
```

- - 编辑 - -

您可能还想仔细检查您是否弄乱了标准库，尝试在不同的文件夹中全新安装 python 2.7.3。

----编辑2----

您可以像这样快速修补它：

```
import multiprocessing.dummy
import weakref
import threading

class Worker(threading.Thread):
    def __init__(self):
        threading.Thread.__init__(self)

    def run(self):
        poll = multiprocessing.dummy.Pool(5)
        print str(poll)

w = Worker()
w._children = weakref.WeakKeyDictionary()
w.start() 
```

# activiti - 如何使用 Activiti Explorer 越过 404

> ID：10687873
> 
> 赞同：1
> 
> 时间：2012-05-21T15:10:31.880
> 
> 标签：activiti

我会问 Activiti 论坛，但这三个可怜的不幸者都问无济于事：

*   [http://forums.activiti.org/en/viewtopic.php?f=9&t=3940](http://forums.activiti.org/en/viewtopic.php?f=9&t=3940)
*   [http://forums.activiti.org/en/viewtopic.php?f=9&t=3606](http://forums.activiti.org/en/viewtopic.php?f=9&t=3606)
*   [http://forums.activiti.org/en/viewtopic.php?f=9&t=2667](http://forums.activiti.org/en/viewtopic.php?f=9&t=2667)

所以，我问你，StackOverflow ......你能帮忙吗？antfile 看起来正在执行，没有任何问题：

```
C:\activiti-5.9\setup>ant demo.start
Buildfile: C:\activiti-5.9\setup\build.xml

demo.install:

internal.cfg.create:
     [copy] Copying 1 file to C:\activiti-5.9\setup\build\activiti-cfg
      [zip] Building zip: C:\activiti-5.9\setup\build\activiti-cfg.jar
     [echo] copying configuration to ../workspace/activiti-engine-examples/src/main/config
    [unzip] Expanding: C:\activiti-5.9\setup\build\activiti-cfg.jar into C:\activiti-5.9\workspace\activiti-engine-examples\src\ma
in\config

internal.classpath.libs:

internal.taskdef.launch:

h2.start:
     [echo] starting H2 database...
   [launch] launching cmd 'C:\activiti-5.9\apps\h2\h2.start.bat ' in dir 'C:\activiti-5.9\apps\h2'
   [launch] waiting for launch completion msg 'TCP server running on'...
   [launch]   TCP server running on tcp://192.168.168.62:9092 (others can connect)
     [echo] H2 database started

tomcat.start:
   [launch] launching cmd 'C:\activiti-5.9\apps\apache-tomcat-6.0.32\bin\startup.bat ' in dir 'C:\activiti-5.9\apps\apache-tomcat-
6.0.32\bin'
   [launch] waiting for launch completion msg 'Using CLASSPATH:'...
   [launch]   Using CATALINA_BASE:   "c:\tomcat"
   [launch]   Using CATALINA_HOME:   "c:\tomcat"
   [launch]   Using CATALINA_TMPDIR: "c:\tomcat\temp"
   [launch]   Using JRE_HOME:        "C:\Program Files\Java\jdk1.7.0_03\jre"
   [launch]   Using CLASSPATH:       "c:\tomcat\bin\bootstrap.jar;c:\tomcat\bin\tomcat-juli.jar"

explorer.browser.open:

demo.start:

BUILD SUCCESSFUL
Total time: 5 seconds 
```

雄猫报告：

```
May 21, 2012 10:08:21 AM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
May 21, 2012 10:08:21 AM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-443"]
May 21, 2012 10:08:21 AM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
May 21, 2012 10:08:21 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 619 ms
May 21, 2012 10:08:21 AM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
May 21, 2012 10:08:21 AM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.20
May 21, 2012 10:08:21 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory docs
May 21, 2012 10:08:21 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory examples
May 21, 2012 10:08:21 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory host-manager
May 21, 2012 10:08:22 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory manager
May 21, 2012 10:08:22 AM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
May 21, 2012 10:08:22 AM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-443"]
May 21, 2012 10:08:22 AM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
May 21, 2012 10:08:22 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 562 ms 
```

当我请求时，控制台没有添加任何内容`http://localhost:8080/activiti-explorer`，但我确实得到：

```
HTTP/1.1 404 Not Found

Server: Apache-Coyote/1.1

Content-Length: 0

Date: Mon, 21 May 2012 15:09:09 GMT 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:02:37.560

这是我的决议：

CATALINA_* 变量指向我的 tomcat 版本，而不是 Activiti 附带的那个。

环境

```
set CATALINA_BASE="C:\activiti-5.9\apps\apache-tomcat-6.0.32"
set CATALINA_HOME=%CATALINA_BASE%
set CATALINA_TEMP="C:\activiti-5.9\apps\apache-tomcat-6.0.32\temp" 
```

从那里工作正常。

不确定是否同样适用于 *nix 系统，但值得一看。

# java - 你如何在eclipse中导入一个maven EJB项目？（不含 m2e）

> ID：10687878
> 
> 赞同：1
> 
> 时间：2012-05-21T15:10:59.723
> 
> 标签：java, eclipse, jakarta-ee, maven, ejb-3.0

我使用“org.codehaus.mojo.archetypes:ejb-jee5”最新版本通过 Maven 创建了一个 EJB 项目。

然后我输入“mvn install”和“mvn eclipse:eclipse”。

最后，我将它作为 eclipse 中的一般 java 项目导入，但该项目未被识别为具有 EJB 功能。

我做错什么了？

谢谢

# 编辑

按照 awnser 的建议尝试了这个，不起作用

```
<build>
    <plugins>   
        <plugin>
            <artifactId>maven-eclipse-plugin</artifactId>
            <configuration>
                <buildcommands>
                    <buildcommand>org.eclipse.wst.common.project.facet.core.builder</buildcommand>
                    <buildcommand>org.eclipse.jdt.core.javabuilder</buildcommand>
                    <buildcommand>org.eclipse.wst.validation.validationbuilder</buildcommand>
                </buildcommands>
                <additionalProjectnatures>
                    <projectnature>org.eclipse.jem.workbench.JavaEMFNature</projectnature>
                    <projectnature>org.eclipse.wst.common.modulecore.ModuleCoreNature</projectnature>
                    <projectnature>eclipse.jdt.core.javanature</projectnature>
                    <projectnature>org.eclipse.wst.common.project.facet.core.nature</projectnature>
                </additionalProjectnatures>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

# 编辑

显然，将这​​些构建器和性质添加到您的 .project 中还不够，还必须生成一个描述启用了哪个方面的 xml 文件，为此我应该在“标签”之间添加以下代码

```
<additionalProjectFacets>
    <jst.java>1.6</jst.java>
    <jst.ejb>3.0</jst.ejb>
</additionalProjectFacets> 
```

但是，这 4 行会产生“构建失败”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:48:56.803

您可以在 pom.xml 中添加所需的性质（这就是它在 Eclipse 世界中的命名方式）

请参阅[将项目性质添加到您的 Maven pom](http://vikashazrati.wordpress.com/2007/12/22/adding-project-nature-to-your-maven-pomxml/)以创建一个空的 EJB 项目，并在 .project 中查看性质是如何命名的（它可能具有不止一种性质）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T09:08:03.967

所以我发现，正如预期的那样，修改项目性质是不够的，你还必须生成其他文件描述的东西，比如激活的方面等。

将此添加到您的 EJB 项目中，它将被识别为没有 m2e 的 EJB。

```
 <build>
        <plugins>
            <plugin>
                <artifactId>maven-eclipse-plugin</artifactId>
                <configuration>
                    <additionalBuildcommands>
                        <buildCommand>
                            <name>org.eclipse.jdt.core.javabuilder</name>
                        </buildCommand>
                        <buildCommand>
                            <name>org.eclipse.wst.common.project.facet.core.builder</name>
                        </buildCommand>
                        <buildCommand>
                            <name>org.eclipse.wst.validation.validationbuilder</name>
                        </buildCommand>
                        <buildCommand>
                            <name>org.eclipse.ui.externaltools.ExternalToolBuilder</name>
                            <arguments>
                                <LaunchConfigHandle>&lt;project&gt;/.settings/MavenBuilder.launch</LaunchConfigHandle>
                            </arguments>
                        </buildCommand>
                    </additionalBuildcommands>
                    <additionalProjectnatures>
                        <projectnature>org.eclipse.wst.common.project.facet.core.nature</projectnature>
                        <projectnature>org.eclipse.jdt.core.javanature</projectnature>
                        <projectnature>org.eclipse.wst.common.modulecore.ModuleCoreNature</projectnature>
                        <projectnature>org.eclipse.jem.workbench.JavaEMFNature</projectnature>
                    </additionalProjectnatures>
                    <additionalConfig>
                        <file>
                            <name>.settings/org.eclipse.wst.common.project.facet.core.xml</name>
                            <content>
                                <![CDATA[<faceted-project>
    <runtime name="my JBoss Runtime" />
    <fixed facet="jst.ejb" />
    <fixed facet="jst.java" />
    <installed facet="jst.java" version="6.0" />
    <installed facet="jst.ejb" version="3.0" />
</faceted-project>]]>
                            </content>
                        </file>
                        <file>
                            <name>.settings/org.eclipse.wst.common.component</name>
                            <content>
                                <![CDATA[
<project-modules id="moduleCoreId" project-version="1.5.0">
    <wb-module deploy-name="${project.artifactId}">
        <wb-resource deploy-path="/" source-path="/src/main/java" />
        <wb-resource deploy-path="/" source-path="/src/main/resources" />
        <property name="java-output-path" value="target/classes" />
    </wb-module>
</project-modules>]]>
                            </content>
                        </file>
                        <file>
                            <name>.checkstyle</name>
                            <content>
                                <![CDATA[<fileset-config file-format-version="1.2.0" simple-config="true">
    <fileset name="all" enabled="true" check-config-name="Myproject Checks" local="false">
        <file-match-pattern match-pattern="." include-pattern="true" />
    </fileset>
</fileset-config>]]>
                            </content>
                        </file>
                        <file>
                            <name>.settings/MavenBuilder.launch</name>
                            <content>
                                <![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<launchConfiguration type="org.eclipse.ui.externaltools.ProgramBuilderLaunchConfigurationType">
<stringAttribute key="org.eclipse.debug.core.ATTR_REFRESH_SCOPE" value="$${working_set:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#13;&#10;&lt;launchConfigurationWorkingSet editPageId=&quot;org.eclipse.ui.resourceWorkingSetPage&quot; factoryID=&quot;org.eclipse.ui.internal.WorkingSetFactory&quot; label=&quot;working set&quot; name=&quot;working set&quot;&gt;&#13;&#10;&lt;item factoryID=&quot;org.eclipse.ui.internal.model.ResourceFactory&quot; path=&quot;/acces-services/target/test-classes&quot; type=&quot;2&quot;/&gt;&#13;&#10;&lt;item factoryID=&quot;org.eclipse.ui.internal.model.ResourceFactory&quot; path=&quot;/acces-services/target/classes&quot; type=&quot;2&quot;/&gt;&#13;&#10;&lt;/launchConfigurationWorkingSet&gt;}" />
<booleanAttribute key="org.eclipse.debug.core.capture_output" value="false" />
<booleanAttribute key="org.eclipse.debug.ui.ATTR_CONSOLE_OUTPUT_ON" value="false" />
<booleanAttribute key="org.eclipse.debug.ui.ATTR_LAUNCH_IN_BACKGROUND" value="false" />
<stringAttribute key="org.eclipse.ui.externaltools.ATTR_BUILD_SCOPE" value="$${working_set:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#13;&#10;&lt;launchConfigurationWorkingSet editPageId=&quot;org.eclipse.ui.resourceWorkingSetPage&quot; factoryID=&quot;org.eclipse.ui.internal.WorkingSetFactory&quot; label=&quot;workingSet&quot; name=&quot;workingSet&quot;&gt;&#13;&#10;&lt;item factoryID=&quot;org.eclipse.ui.internal.model.ResourceFactory&quot; path=&quot;/acces-services/src/test/resources&quot; type=&quot;2&quot;/&gt;&#13;&#10;&lt;item factoryID=&quot;org.eclipse.ui.internal.model.ResourceFactory&quot; path=&quot;/acces-services/src/main/resources&quot; type=&quot;2&quot;/&gt;&#13;&#10;&lt;/launchConfigurationWorkingSet&gt;}" />
<stringAttribute key="org.eclipse.ui.externaltools.ATTR_LOCATION" value="${env.M2_HOME}\bin\mvn.bat" />
<stringAttribute key="org.eclipse.ui.externaltools.ATTR_RUN_BUILD_KINDS" value="full,incremental,auto,clean" />
<stringAttribute key="org.eclipse.ui.externaltools.ATTR_TOOL_ARGUMENTS" value="resources:resources resources:testResources --offline" />
<booleanAttribute key="org.eclipse.ui.externaltools.ATTR_TRIGGERS_CONFIGURED" value="true" />
<stringAttribute key="org.eclipse.ui.externaltools.ATTR_WORKING_DIRECTORY" value="$${workspace_loc:/acces-services}" />
</launchConfiguration>]]>
                            </content>
                        </file>
                    </additionalConfig>
                </configuration>
            </plugin>
        </plugins>
    </build> 
```

请注意，我们正在定义正在使用的服务器运行时，这意味着您必须在之前配置服务器运行时并将其名称放入其中。

# sql - 根据相关行中的值更新列

> ID：10687879
> 
> 赞同：2
> 
> 时间：2012-05-21T15:11:00.247
> 
> 标签：sql, sql-server-2008, sql-update, rows

我在 SQL Server 2008 中有如下表

```
 AMID                TierLevel
 --------            -------------
  999                 GOLD
  1000                SILVER   
  1000                GOLD
  1000                PLATINUM
  1000                BRONZE
  1001                GOLD
  1001                SILVER
  1002                SILVER
  1003                GOLD 
```

现在我想像下面这样更新这个表

```
 AMID                TierLevel
 --------            -------------
  999                 GOLD
  1000               PLATINUM  
  1000               PLATINUM
  1000               PLATINUM
  1000               PLATINUM
  1001                GOLD
  1001                GOLD
  1002                SILVER
  1003                GOLD 
```

这里的条件是

*   我想要同一个 AMID 的唯一层级值，并且层级值应该在优先级基础中选择，例如

    1.  铂
    2.  金子
    3.  银
    4.  青铜
*   这意味着如果它的等级值中存在最高的等级，则选择该等级。就像我在第二张表中显示的那样，白金代表 1000，黄金代表 1001..

请在这件事上给予我帮助

谢谢，
哈利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:33:49.747

```
DECLARE @amid TABLE (Amid INT, TierLevel VARCHAR(20));

INSERT @amid VALUES
(999 ,'GOLD'),
(1000,'SILVER'), (1000,'GOLD'),   (1000,'PLATINUM'), (1000,'BRONZE'),
(1001,'GOLD'),   (1001,'SILVER'),
(1002,'SILVER'), (1003,'GOLD');

;WITH [priority](r, n) AS
(
    SELECT 1, 'PLATINUM'
    UNION ALL SELECT 2, 'GOLD'
    UNION ALL SELECT 3, 'SILVER'
    UNION ALL SELECT 4, 'BRONZE'
),
per_amid(amid, h) AS
(
    SELECT a.amid, MIN(p.r)
      FROM @amid AS a
      INNER JOIN [priority] AS p
      ON a.TierLevel = p.n
      GROUP BY a.amid
)
UPDATE a
  SET TierLevel = p.n
  FROM @amid AS a
  INNER JOIN per_amid AS pa
  ON a.Amid = pa.amid
  INNER JOIN [priority] AS p
  ON pa.h = p.r
  -- added where clause to address question brought up on other answer
  WHERE a.TierLevel <> p.n;

SELECT Amid, TierLevel FROM @amid; 
```

结果：

```
Amid  TierLevel
----  ---------
999   GOLD
1000  PLATINUM
1000  PLATINUM
1000  PLATINUM
1000  PLATINUM
1001  GOLD
1001  GOLD
1002  SILVER
1003  GOLD 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:25:03.080

我会使用一个临时表来存储每个层的等级：

```
DECLARE @Rank TABLE (ID INT NOT NULL PRIMARY KEY, Name VARCHAR(10) NOT NULL)
INSERT @Rank VALUES (1, 'PLATINUM'), (2, 'GOLD'), (3, 'SILVER'), (4, 'BRONZE')

;WITH T AS
(   SELECT  AMID, TierLevel, MIN(ID) OVER(PARTITION BY AMID) [MinID]
    FROM    #T
            INNER JOIN @Rank
                ON Name = TierLevel
)
UPDATE  T
SET     TierLevel = Name
FROM    T
        INNER JOIN @Rank
            ON ID = MinID
WHERE   TierLevel <> Name 
```

* * *

这是使用以下示例数据完成的：

```
CREATE TABLE #T (AMID INT, TierLevel VARCHAR(10))
INSERT #T VALUES 
    (999, 'GOLD'), 
    (1000, 'SILVER'), 
    (1000, 'GOLD'), 
    (1000, 'PLATINUM'), 
    (1000, 'BRONZE'),
    (1001, 'GOLD'),
    (1001, 'SILVER'),
    (1002, 'SILVER'),
    (1003, 'GOLD') 
```

# java - 通过 Jersey 和 x-www-form-urlencoded 发送文件

> ID：10687886
> 
> 赞同：3
> 
> 时间：2012-05-21T15:11:14.137
> 
> 标签：java, jersey

我正在尝试使用以下客户端代码调用 REST 服务，以发送一些字符串消息详细信息以及附件文件：

```
ClientConfig config = new DefaultClientConfig();
config.getClasses().add(FormProvider.class);
Client client = Client.create(config);
WebResource webResource = client.resource("http://some.url/path1/path2");

File attachment = new File("./file.zip");

FormDataBodyPart fdp = new FormDataBodyPart(
            "content", 
            new ByteArrayInputStream(Base64.encode(FileUtils.readFileToByteArray(attachedLogs))),
            MediaType.APPLICATION_OCTET_STREAM_TYPE);
form.bodyPart(fdp);

ClientResponse response = webResource.type(MediaType.APPLICATION_FORM_URLENCODED).post(ClientResponse.class, form); 
```

我的目标服务器接受 Base64 编码的内容，这就是从 File 到 ByteArray 的额外传输的原因。

此外，我发现 com.sun.jersey.core.impl.provider.entity.FormProvider 类在“x-www-form-urlencoded”请求的生产和消费方面都有所记录。

```
@Produces({"application/x-www-form-urlencoded", "*/*"})
@Consumes({"application/x-www-form-urlencoded", "*/*"}) 
```

但我最终还是得到了以下堆栈跟踪：

```
com.sun.jersey.api.client.ClientHandlerException: com.sun.jersey.api.client.ClientHandlerException: A message body writer for Java type, class com.sun.jersey.multipart.FormDataMultiPart, and MIME media type, application/x-www-form-urlencoded, was not found at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:149) ~[jersey-client-1.9.1.jar:1.9.1]
at com.sun.jersey.api.client.Client.handle(Client.java:648) ~[jersey-client-1.9.1.jar:1.9.1]
at com.sun.jersey.api.client.WebResource.handle(WebResource.java:670) ~[jersey-client-1.9.1.jar:1.9.1]
at com.sun.jersey.api.client.WebResource.access$200(WebResource.java:74) ~[jersey-client-1.9.1.jar:1.9.1]
at com.sun.jersey.api.client.WebResource$Builder.post(WebResource.java:563) ~[jersey-client-1.9.1.jar:1.9.1] 
```

对这个有帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T07:57:26.813

我设法让事情在客户端工作。问题是我强制将文件作为单独的消息正文部分发送，而[x-www-form-urlencoded 实际上将所有数据打包为查询中的参数，即整个 body](http://en.wikipedia.org/wiki/Application/x-www-form-urlencoded)。

因此，如果您想通过 Jersey 发布方法发送附件，则工作客户端代码将是：

```
ClientConfig config = new DefaultClientConfig();
Client client = Client.create(config);
WebResource webResource = client.resource("http://some.url/path1/path2");

MultivaluedMapImpl values = new MultivaluedMapImpl();
values.add("filename", "report.zip");
values.add("text", "Test message");
values.add("content", new String(Base64.encode(FileUtils.readFileToByteArray(attachedLogs))));
ClientResponse response = webResource.type(MediaType.APPLICATION_FORM_URLENCODED).post(ClientResponse.class, values); 
```

在我的情况下，Apache Commons 的 Base64 编码器需要将文件转换为编码字节数组，不确定这是否是一般要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:55:06.903

尝试使用`Multipart/form-data`而不是`application/x-www-form-urlencoded`. [本教程](http://aruld.info/handling-multiparts-in-restful-applications-using-jersey/)可能会有所帮助。

# javascript - JQuery表单注入未出现在提交中

> ID：10687890
> 
> 赞同：0
> 
> 时间：2012-05-21T15:11:22.157
> 
> 标签：javascript, jquery, html, forms

我在创建表单后使用 JQuery 将输入添加到表单中时遇到问题。初始形式如下所示：

```
<form class="purchase-product" >
<div id="purchase_quantity_discounts"></div>
<input type="hidden" name="product_id" value="1" id="label" >
<input type"button" name "submitme" id="product-quantity-button"></button>
</form> 
```

以及用于附加的 JQuery

```
$('#purchase_quantity_discounts').append('Quanity: </strong> <input type="text" name="quantity" placeholder="Enter Quantity" value="1" />'); 
```

现在我正在尝试获得数量：

```
$('#' + purchase_page).on('click', '#product-quantity-button', function() {
  var formData = Utilities.parseForm(".purchase-product");
  var amount = formData.quantity;
  var product_id = formData.product_id;

  alert(amount);
  alert(product_id);

}); 
```

所以 product_id 总是显示，但数量永远不会出现。为什么会这样，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:12:41.457

您的追加缺少`>`输入的结束，请参阅：

```
('#purchase_quantity_discounts')
    .append('Quanity: </strong> <input type="text" name="quantity"
        placeholder="Enter Quantity" value="1" /'); //> needed before the ') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T06:44:50.433

From what I see, there are several typos in your example code. Have a look at this jsFiddle that works.

Not sure of that form-parsing utility you're using `Utilities.parseForm`, but I've recreated the functionality with jQuery

Here's the fiddle: [http://jsfiddle.net/pavsaund/Pt2R2/2/](http://jsfiddle.net/pavsaund/Pt2R2/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:33:37.923

我建议将`id`s 添加到您的输入中并以这种方式获取值。

# regex - 包含 Perl 单行的 Shell 脚本的结果为空白

> ID：10687892
> 
> 赞同：3
> 
> 时间：2012-05-21T15:11:26.993
> 
> 标签：regex, linux, perl, command-line

我有一个在命令行上运行良好的 Perl 单行代码：

```
perl -nle 'm"\w+:x:\d+:\d+:\S+:/S+:(\S+)$" and $h{$1}++; END{ print "$_: $h{$_}" foreach sort { $h{$b} <=> $h{$a} } keys %h }' /etc/textfile 
```

我已经把它放到了一个名为的 shell 文件`shell.sh`中，这样下一个人就不必复制/粘贴并且可以运行它：

```
#!/bin/sh
perl -nle 'm"\w+:x:\d+:\d+:\S+:/S+:(\S+)$" and $h{$1}++; END{ print "$_: $h{$_}" foreach sort { $h{$b} <=> $h{$a} } keys %h }' /etc/textfile 
```

我尝试在命令行上运行它并没有得到任何结果；它只是加载一个没有输出的新提示。有人看到我做错了什么吗？

以下是一些系统规格：

> Linux 版本 2.6.32-220.13.1.el6.x86_64
> 
> (gcc 版本 4.4.6 20110731 (Red Hat 4.4.6-3) (GCC)
> 
> GNU bash，版本 4.1.2(1)-release (x86_64-redhat-linux-gnu)

这是文本文件中的一些内容：

```
rfink:x:140:140:rat fink:/var/lib/rfink:/sbin/nologin                                 
edible:x:16252:10001:eric idle:/users/eidle/:/bin/bash                                       
tsawyer:x:30855:10001:tom sawyer:/users/tsawyer/:/bin/bash                                
karthur:x:30886:10001:King Arthur:/users/karthur/:/bin/bash                                         
karthur:x:30886:10001:king arthur:/users/karthur/:/bin/bash                                         
jcash:x:30887:10001:john cash:/users/jcash/:/bin/bash                              
hpotter:x:30887:10001:harry potter:/users/hpotter/:/bin/bash                              
triddle:x:30956:10001:tom riddle:/users/triddle/:/bin/bash 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T15:48:02.003

## 快速回答

```
perl -nle 'm"\w+:x:\d+:\d+:[^:]+:\S+:(\S+)\s*$" and $h{$1}++;
  END{ print "$_: $h{$_}" foreach sort { $h{$b} <=> $h{$a} } keys %h }' \
  /etc/textfile 
```

您的正则表达式有三个问题。

1.  组 ID 后面的字段可能包含空格，因此将该子模式替换为`[^:]+`以匹配一个或多个非冒号字符。
2.  您在子模式中使用了错误的斜杠来匹配主目录。
3.  `\s*`在每行之前插入`$`以允许可选的尾随空格。

输出：

```
/bin/bash: 7
/sbin/nologin: 1
```

## 其他方法

Perl 有一个 awk 模式，它允许

```
perl -F: -lane '++$sh{$F[-1]};
  END{print "$_: $sh{$_}" for sort { $sh{$b} <=> $sh{$a} } keys %sh}' \
  /etc/textfile 
```

必须删除尾随空格似乎取消了语法优势。

```
perl -F: -lane '($sh = pop @F) =~ s/\s+$//; ++$sh{$sh};
  END{print "$_: $sh{$_}" for sort { $sh{$b} <=> $sh{$a} } keys %sh}' \
  /etc/textfile 
```

您可以使用管道来获得所有世界中最好的：

```
perl -pe 's/[^\S\n]+$//' /etc/textfile |
  perl -F: -lane 'print $F[-1]' |
    sort | uniq -c | sort -nr 
```

输出转置列，但您得到相同的信息。

请注意在管道的第一个命令中使用[正则表达式双重否定技术](https://stackoverflow.com/a/3469155/123109)来删除除换行符以外的所有空格。

```
      7 /bin/bash
      1 /sbin/nologin
```

## 作为 shell 脚本

你的问题需要一个 shell 脚本，所以——为了让[daxim 的回答](https://stackoverflow.com/a/10689018/123109)更动听——那就是

```
#! /bin/sh

perl -MUser::pwent -le \
  '$_->shell && print $_->shell while $_ = getpwent' |
  sort | uniq -c | sort -nr 
```

请注意，这不处理名为`0`.

如果您不一定要阅读系统*/etc/passwd*，那么您的脚本将变为

```
#! /bin/sh

if [ $# -eq 0 ]; then
  echo Usage: $0 passwd-file .. 1>&2
  exit 1
fi

perl -pe 's/[^\S\n]+$//' "$@" |
  perl -lne 'm|\w+:x:\d+:\d+:[^:]+:\S+:(\S+)$| && print $1' |
    sort | uniq -c | sort -nr 
```

不同的系统使用不同的格式，所以我建议像上面那样确定你的期望，而不是盲目地打印最后一个字段，不管它是什么。这可能意味着应对偶尔的空输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:31:57.053

[当存在专门的解析器](http://p3rl.org/User%3a%3apwent)时，避免使用临时正则表达式。

```
perl -MUser::pwent=getpwent -e'
    while (my $pwent = getpwent) { $h{ $pwent->shell }++; }
    END { print "$_: $h{$_}\n" for sort { $h{$b} <=> $h{$a} } keys %h }
' 
```

`split`当更简单的结构（例如, `index`/ `substr`）可以使用时，请避免使用 reg-ex `unpack`。在这里，我利用了[autosplit](http://p3rl.org/run#%2a-a%2a)：

```
perl -F: -lane'
    $h{ $F[-1] }++;
    END { print "$_: $h{$_}" for sort { $h{$b} <=> $h{$a} } keys %h }
' /etc/textfile 
```

这使得程序更短、更易读。

# jquery - jQuery控制台说gmap函数不存在？这是添加 jQuery 脚本文件吗？

> ID：10687897
> 
> 赞同：0
> 
> 时间：2012-05-21T15:11:38.827
> 
> 标签：jquery, google-maps

以下是地图的简单再现，测试添加了 Google 地图 jQuery v.3：

```
<!DOCTYPE html>
<head>
    <title>Google Maps JQuery Plugin Test</title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery /1.7/jquery.min.js"></script>
    <script type="text/javascript" src="PATH_TO_PLUGIN/jquery.ui.map.js"></script>
    <script type="text/javascript">
        $('#map_canvas').gmap({
            'some_option': 'some_value'
        }); // Add the contructor
        // addMarker returns a jQuery wrapped google.maps.Marker object 
        var $marker = $('#map_canvas').gmap('addMarker', {
            'position': '57.7973333,12.0502107',
            'bounds': true
        });
        $marker.click(function () {
            $('#map_canvas').gmap('openInfoWindow', {
                'content': 'Hello World!'
            }, this);
        });
    </script>
</head>
<body>
    <div id="map_canvas" style="width:250px;height:250px"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:24:22.650

首先，您需要确保正确加载了以下库：

```
<script type="text/javascript" src="PATH_TO_PLUGIN/jquery.ui.map.js"></script> 
```

因为它包含`.gmap()`函数 - 所以如果库未正确加载，您将收到确切的错误消息（即`gmap function does not exist`）...

其次 - 您试图在完全加载之前访问 DOM - 标签中的`<head>`代码将在`<div>`实际加载之前执行。

所以你应该这样做：

```
$(function() {
    $('#map_canvas').gmap({
        'some_option': 'some_value'
    }); // Add the contructor
    // addMarker returns a jQuery wrapped google.maps.Marker object 
    var $marker = $('#map_canvas').gmap('addMarker', {
        'position': '57.7973333,12.0502107',
        'bounds': true
    });
    $marker.click(function() {
        $('#map_canvas').gmap('openInfoWindow', {
            'content': 'Hello World!'
        }, this);
    });
}); 
```

将代码包装在`$(function() {`块中将确保它仅在 DOM 准备好时执行 -[请参阅文档`ready()`](http://api.jquery.com/ready/)

[这里的工作示例](http://jsfiddle.net/X5r8r/451/)

# java - Java：使用 HTable 连接到 HBase - 处理连接丢失

> ID：10687898
> 
> 赞同：0
> 
> 时间：2012-05-21T15:11:40.053
> 
> 标签：java, hadoop, connection, hbase

我有一个问题。我使用 Java 程序在我的 HBase 中写入数据。我在那里有 HTable 对象，我调用了以下方法（伪代码）：

```
// creates a Put object with new data
Put put = createNewPutObject(); 
htable.put(put);
htable.flushCommits(); 
```

clearBufferOnFail 设置为 true：

`this.htable.setAutoFlush(false, true);`

代码的第一部分被一遍又一遍地调用。我们做一些事情，创建一个 Put 对象，刷新 htable，做更多的事情，创建一个 Put 对象......等等。

如果我的 HTable 对象失去与 HBase 的连接会怎样？这是内部处理的吗？或者我是否需要关闭我的 HTable 对象并打开一个新的 HTable 对象？到目前为止，我认为连接是通过连接池在内部从 HTable 对象处理的，所以我必须做任何事情。我认为捕获异常然后重试就足够了。由于 clearBufferOnFail 设置为 true，因此不会写入重复的数据。

但是会不会有太多的连接以某种方式打开？还是这一切都处理好了？

# compiler-construction - 静态单一分配：并非所有可能的路径都定义一个变量 - 如何插入 PHI？

> ID：10687899
> 
> 赞同：4
> 
> 时间：2012-05-21T15:11:41.860
> 
> 标签：compiler-construction, ssa

我正在为我正在编写的编译器实现*SSA 构造。*SSA 算法中有一些我不理解的东西（使用[Cytron 论文](https://dl.acm.org/citation.cfm?id=115320)和《*Java 中的现代编译器实现*》一书，AW Appel 的第二版）。如果一个变量`y`第一次在一个直接的控制流路径中定义（并使用）但从未在另一个并行路径中定义，该怎么办？我是否必须在连接点（块定义的优势边界`y`）插入 PHI 函数？

```
x = 1;            // A
if (P)            // A
    y = x + 1;    // B
    y = y + 1;    // B
x = x + 1;        // C
return;           // C 
```

例如，在块 B 中有 的第一个定义`y`。我是否必须在块 C 的开头插入一条 PHI 指令，带有两个操作数（一个用于每个传入的控制流路径）？然后在 SSA 重命名：我将如何命名来自从未定义的路径`A -> C`（而不是通过 B）的操作数？`y`

```
Entry --- A --------- C --- Exit
           \         /
            \-- B --/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:27:02.687

再次阅读材料后，我在AW Appel 的*Modern Compiler Implementation in Java, second edition*一书中发现了一个关于变量的隐式定义的小提示`c0`。进一步搜索发现，算法期望所有变量在第一个基本块之前都有一个隐式定义。这个隐含的定义表示变量是全局的、参数或未初始化的变量。

添加这个隐式定义解决了我的问题，示例将变为：

```
x1 = 1;           // A
if (P)            // A
    y1 = x1 + 1;  // B
    y2 = y1 + 1;  // B
y3 = φ(y0, y2)    // C
x2 = x1 + 1;      // C
return;           // C 
```

# android - 如何将双精度值与数据库中的小数进行比较，如果它们相似，则返回 true

> ID：10687902
> 
> 赞同：2
> 
> 时间：2012-05-21T15:11:54.840
> 
> 标签：android, mysql, sql

例子：

数据库纬度值：33.3360705

来自 android 设备纬度值的位置：33.33607

这些在技术上是不一样的，但差异是如此之小，以至于我想将它们视为相同。

我该怎么做？:)

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T15:14:31.707

从数据库中获取值时只需`ROUND`在 MySQL 中使用。以下将四舍五入到小数点后 5 位（与您的 android 设备值匹配）：

```
SELECT ROUND(myValue, 5) 
FROM myTable 
```

# c++ - 与 boost::locale 一起使用时，std::isalpha 会抛出 bad_cast

> ID：10687907
> 
> 赞同：3
> 
> 时间：2012-05-21T15:12:01.063
> 
> 标签：c++, boost, locale, boost-locale

我在 Debian 7 GNU/Linux（GCC 版本为 4.6.3-1）上使用 boost::locale (1.49) 时遇到了一些麻烦。代码保存在cp1251中。使用诸如“isalpha”（或“boost::algorithm::is_alpha”）之类的函数会导致异常（bad_cast）。看起来这个检查没有合适的方面。这是代码：

```
#include <iostream>

#include <boost/locale.hpp>

int main ()
{
  boost::locale::generator gen;
  std::locale loc(gen.generate("ru_RU.cp1251"));
  unsigned char debug501 = 'Б';
  bool debug500 = std::isalpha(debug501, loc);
  std::cout<< debug500;

  return 0;
} 
```

它在装有 Visual Studio 2008 的 Windows 7 上毫无例外地运行。但是，仍然存在一个问题：在这种情况下，“debug500”设置为 false。仅当像这样生成语言环境时它才能正常工作：`std::locale loc(".1251")`. 但是当 locale 由 boost: 生成时，也会出现同样的问题`std::locale loc(boost::locale::generator().generate("ru_RU.cp1251"));`。如果有人能解释代码有什么问题和/或我如何使用 boost 和 std 和 cp1251 语言环境进行类似的检查（isalpha），我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:37:14.157

代替：

```
unsigned char debug501 = 'Б'; 
```

和：

```
char debug501 = 'Б'; 
```

# java - 带有 TestNg 的 Maven-surefire-plugin：如何指定存储测试套件 xml 文件的目录？

> ID：10687909
> 
> 赞同：5
> 
> 时间：2012-05-21T15:12:06.680
> 
> 标签：java, unit-testing, testng, maven-surefire-plugin

我目前正在开发一个由 Maven 支持的项目。我选择了 TestNg 来实现我的单元测试。为了在每个 Maven 构建中运行我的单一测试，我已将 maven-surefire-plugin 添加到我的 pom.xml 中：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.12</version>
            <configuration>
            <!-- Configuring the test suites to execute -->
                <suiteXmlFiles>
                     <suiteXmlFile>testsuite-persistence-layer.xml</suiteXmlFile>
                </suiteXmlFiles>
            </configuration>
        </plugin> 
```

此外，我想使用 TestNg 的 TestSuiteXmlFile 指定要执行的测试。例如，在我的 pom.xml 中，我配置了 surefire 插件，以便它将执行名为“testsuite-persistence-layer.xml”的 xml 文件中定义的测试。

问题是，默认情况下，surefire 插件似乎在我的项目的根目录中寻找这个 xml 文件。**如何指定 surefire 插件应在其中查找 TestSuite xml 文件的目录？**

根据 TestNg 文档，这可以通过“maven.testng.suitexml.dir”属性指定，但 Surefire 插件似乎没有考虑到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T19:31:47.110

我不确定我是否理解你的问题。您可以轻松地指定 xml 文件的确切位置，包括相对路径和完全限定路径。

```
<suiteXmlFile>c:/some/dir/testsuite-persistence-layer.xml</suiteXmlFile> 
```

或者

```
<suiteXmlFile>src/test/java/com/something/project/testsuite-persistence-layer.xml</suiteXmlFile> 
```

但这太容易了，所以我猜你正在寻找一种方法来参数化 xmls 所在的目录。我想到的快速解决方案是

```
<suiteXmlFile>${xmlPath}/testSuite.xml</suiteXmlFile> 
```

现在你可以运行

```
mvn test -DxmlPath=c:/some/path 
```

当然 xmlPath 只是虚构的名称，您可以使用任何其他您想要的变量名称。

如果您不想从命令行将路径作为参数传递，您可以在 POM 的属性部分中指定 xmlPath 变量的值。属性是位于 <project> 分支下的主要部分之一。

```
<project ... >
    ...

    <properties>
        <xmlPath>c:/some/path</xmlPath>
    </properties>
        ...

    <build>
        ...
        <plugins>
        ...
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.9</version>
                <configuration>
                    <suiteXmlFiles>
                        <suiteXmlFile>${xmlPath}/testSuite.xml</suiteXmlFile>
                    </suiteXmlFiles>                                        
                    ...
                </configuration>
            </plugin>
        ...
        </plugins>
        ...
    </build>
    ...

</project> 
```

# java - Eclipse，Tomcat 7 NoClassDefFoundError

> ID：10687911
> 
> 赞同：0
> 
> 时间：2012-05-21T15:12:15.800
> 
> 标签：java, tomcat7

尝试在 Tomcat 7.0.12 上的 Eclipse 中运行程序，但出现此错误：

```
java.lang.NoClassDefFoundError: and
Caused by: java.lang.ClassNotFoundException: and
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
Exception in thread "main" 
```

我不知道是什么原因造成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:24:36.403

您必须将麻烦的程序安装到全名中没有空格的文件夹中。

# xforms - 检测对 xform 中的实例执行的操作

> ID：10687912
> 
> 赞同：0
> 
> 时间：2012-05-21T15:12:17.063
> 
> 标签：xforms

我想知道如何检测用户是否对表单中的任何输入字段进行了更改。这样做的原因是启用复选框以保存对数据库的更改。我想避免为每个字段编写触发器。为什么可以对模型实例执行此操作，将加载的实例与用户更新的实例进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:27:49.690

如果您为表单中的所有输入控件添加一个组元素，则由于冒泡机制，它可以捕获 xforms-value-changed 事件。

-阿兰

# sharepoint-2010 - 将新的 SPView 添加到 SPList

> ID：10687916
> 
> 赞同：0
> 
> 时间：2012-05-21T15:12:24.360
> 
> 标签：sharepoint-2010

我需要创建视图并以编程方式将它们添加到列表中。在 SPList 方法中有一个 SPViewCollection 类型的 Views 属性。
这有一个添加方法。但此方法不接受完整的 XML 模式。它分为许多参数（您在其中设置查询、连接等）。我需要一种可以传递完整 XML 的方法。

我正在考虑首先使用此 Add 方法创建一个“虚拟”视图，然后读回视图，最后使用 SetViewXml。

但这是一种有点肮脏的方法——也许我缺少更好更简单的方法。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:12:47.023

尝试这个。我不相信你需要 XML。您应该只需要使用字符串集合添加列。

```
 using (SPWeb web = properties.Feature.Parent as SPWeb)
  {

     System.Diagnostics.Debug.WriteLine("Creating the list");

     //web.AllowUnsafeUpdates = true; //use this in an application page no need in a dll

     web.Lists.Add("Customers", "Store informations about my Company Customers", SPListTemplateType.GenericList);

     web.Update();

     System.Diagnostics.Debug.WriteLine("Creating the Fields");

     SPList myNewList = web.Lists["Customers"];

     myNewList.Fields.Add("First Name", SPFieldType.Text, false);

     myNewList.Fields.Add("Last Name", SPFieldType.Text, false);

     myNewList.Fields.Add("Adress", SPFieldType.Text, false);

     myNewList.Fields.Add("City", SPFieldType.Text, false);

     myNewList.Fields.Add("Latest Purchase Date", SPFieldType.DateTime, false);

     myNewList.Fields.Add("Sales Comments", SPFieldType.Note, false);

     myNewList.Update();

     System.Diagnostics.Debug.WriteLine("Creating the view");

     System.Collections.Specialized.StringCollection strColl = new System.Collections.Specialized.StringCollection();

     strColl.Add("Title");

     strColl.Add("First Name");

     strColl.Add("Last Name");

     strColl.Add("Adress");

     strColl.Add("City");

     strColl.Add("Latest Purchase Date");

     strColl.Add("Sales Comments");

     myNewList.Views.Add("Summary", strColl, @"", 100, true, true, Microsoft.SharePoint.SPViewCollection.SPViewType.Html, false);

     myNewList.Update();

 } 
```

# java - Jmenu 手风琴

> ID：10687917
> 
> 赞同：0
> 
> 时间：2012-05-21T15:12:28.353
> 
> 标签：java, user-interface, accordion, jmenu

我正在尝试制作一个可以有子类的菜单（看起来像一个网上商店），目的是在 GUI 中过滤一些东西。！

因此，例如，当您单击菜单项时，它会打开也可以选择的子菜单，而当您取消选择主菜单项时，它会关闭。

就像是：

```
Cars
  -bmw
  -vw
bikes
skateboards 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:30:29.510

你在找树吗？

[http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)

您可以轻松扩展此类以满足您的需求，我认为它几乎可以满足您的需求。

有关更多信息，您需要使您的问题更清楚。

# ruby-on-rails - 需要 Rails mongoDB 单连接

> ID：10687919
> 
> 赞同：0
> 
> 时间：2012-05-21T15:12:30.073
> 
> 标签：ruby-on-rails, mongodb, mongodb-ruby

我正在使用 rails 应用程序，我的 rails 应用程序日志应该存储在 mongoDB 中。

我正在记录每个控制器的方法调用及其参数、调用日期等。

这是我的应用程序控制器中的代码，用于记录信息

```
db = Mongo::ReplSetConnection.new([MONGODB_PROP['host'],MONGODB_PROP['port']],:refresh_mode => :sync).db(MONGODB_PROP['database'])
au = db.authenticate(MONGODB_PROP['username'],MONGODB_PROP['password'])

if au
  coll = db.collection("log_info")
  doc = { :tab_name => "#{params[:controller}",:date =>"#{Time.now}"}
  coll.insert(doc)
end 
```

显然，我的代码需要一些标准问题。从我的实现来看，每次调用方法发生时，mongoDB 连接都会建立。所以连接对象会自动增加，这将成为性能问题。我需要 Single DB 连接，只要它需要我需要获取连接对象并执行插入操作。我怎样才能做到这一点。

请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:31:41.513

最简单的方法是使用[Mongoid](http://mongoid.org/)并创建一个 LogInfo 类。让 mongoid 处理您的数据库连接，您只需调用：

```
LogInfo.create(:tab_name => "#{params[:controller}",:date =>"#{Time.now}") 
```

# python - 将 nltk.FreqDist 单词分成两个列表？

> ID：10687920
> 
> 赞同：2
> 
> 时间：2012-05-21T15:12:33.327
> 
> 标签：python, list, nltk, set

我有一系列文本，它们是自定义 WebText 类的实例。每个文本都是一个具有等级（-10 到 +10）和与之关联的字数（nltk.FreqDist）的对象：

```
>>trainingTexts = [WebText('train1.txt'), WebText('train2.txt'), WebText('train3.txt'), WebText('train4.txt')]
>>trainingTexts[1].rating
10
>>trainingTexts[1].freq_dist
<FreqDist: 'the': 60, ',': 49, 'to': 38, 'is': 34,...> 
```

您现在如何获得两个列表（或字典），其中包含仅在正面评价文本中使用的每个单词（trainingText[].rating>0），另一个列表包含仅在负面文本中使用的每个单词（trainingText[].rating< 0)。并让每个列表包含所有正面或负面文本的总字数，这样你就会得到这样的结果：

```
>>only_positive_words
[('sky', 10), ('good', 9), ('great', 2)...] 
>>only_negative_words
[('earth', 10), ('ski', 9), ('food', 2)...] 
```

我考虑过使用集合，因为集合包含唯一的实例，但我看不出如何使用 nltk.FreqDist 来完成，而且最重要的是，集合不会按词频排序。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:39:49.730

好的，假设您出于测试目的从这里开始：

```
class Rated(object): 
  def __init__(self, rating, freq_dist): 
    self.rating = rating
    self.freq_dist = freq_dist

a = Rated(5, nltk.FreqDist('the boy sees the dog'.split()))
b = Rated(8, nltk.FreqDist('the cat sees the mouse'.split()))
c = Rated(-3, nltk.FreqDist('some boy likes nothing'.split()))

trainingTexts = [a,b,c] 
```

然后您的代码将如下所示：

```
from collections import defaultdict
from operator import itemgetter

# dictionaries for keeping track of the counts
pos_dict = defaultdict(int)
neg_dict = defaultdict(int)

for r in trainingTexts:
  rating = r.rating
  freq = r.freq_dist

  # choose the appropriate counts dict
  if rating > 0:
    partition = pos_dict
  elif rating < 0: 
    partition = neg_dict
  else:
    continue

  # add the information to the correct counts dict
  for word,count in freq.iteritems():
    partition[word] += count

# Turn the counts dictionaries into lists of descending-frequency words
def only_list(counts, filtered):
  return sorted(filter(lambda (w,c): w not in filtered, counts.items()), \
                key=itemgetter(1), \
                reverse=True)

only_positive_words = only_list(pos_dict, neg_dict)
only_negative_words = only_list(neg_dict, pos_dict) 
```

结果是：

```
>>> only_positive_words
[('the', 4), ('sees', 2), ('dog', 1), ('cat', 1), ('mouse', 1)]
>>> only_negative_words
[('nothing', 1), ('some', 1), ('likes', 1)] 
```

# google-maps-api-3 - google maps api 3 路线查找器（POI 与路线的距离）

> ID：10687927
> 
> 赞同：3
> 
> 时间：2012-05-21T15:13:20.787
> 
> 标签：google-maps-api-3

我有以下代码成功绘制了两点之间的路线。但是，我希望搜索记录集以查看哪些地理参考位于此路线的范围内。例如，距离主要路线 50 码

```
function plot_route() {

         var rendererOptions = { map: map };
    directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);

    var org = new google.maps.LatLng ( $("#start_lat").html(), $("#start_long").html() );
    var dest = new google.maps.LatLng ( $("#finish_lat").html(), $("#finish_long").html() );

        if ($("#via_lat").html() != "") {
       var point1 = new google.maps.LatLng($("#via_lat").html(), $("#via_long").html());
        }
        else
        {
         point1 = dest;
        }

    var wps = [{ location: point1 }];

    if (($("#start_lat").html() != "") && ($("#finish_lat").html() != "")) {
    var request = {
            origin: org,
            destination: dest,
            waypoints: wps,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
            };

    directionsService = new google.maps.DirectionsService();
    directionsService.route(request, function(response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                }
                else
                    alert ('failed to get directions');
            });
    }
} 
```

我试过分解响应，但它表明计算没有返回一个值数组来组成路由。

有没有人征服过这个？

编辑

深入挖掘，似乎响应确实包含路线点数组。对于那些正在寻求帮助而不是通过 -1 按钮从人们那里寻求帮助的人，我附上了以下内容

```
function plot_route() {

         var rendererOptions = { map: map };
    directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);

    var org = new google.maps.LatLng ( $("#start_lat").html(), $("#start_long").html() );
    var dest = new google.maps.LatLng ( $("#finish_lat").html(), $("#finish_long").html() );

        if ($("#via_lat").html() != "") {
       var point1 = new google.maps.LatLng($("#via_lat").html(), $("#via_long").html());
        }
        else
        {
         point1 = dest;
        }

    var wps = [{ location: point1 }];

    if (($("#start_lat").html() != "") && ($("#finish_lat").html() != "")) {
    var request = {
            origin: org,
            destination: dest,
            waypoints: wps,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
            };

    directionsService = new google.maps.DirectionsService();
    directionsService.route(request, function(response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                                   var myroute = response.routes[0];
                                   if(myroute)
                                   {
                                       $.each(myroute, function(key, value) {
                                       if (key == "overview_path") {
                                          alert(value); //the array of points for the route
                                       }
                                     });
                                    }
                    directionsDisplay.setDirections(response);
                }
                else
                    alert ('failed to get directions');
            });
    }
} 
```

# jquery - 如何在Jquery中的if else语句中调用函数

> ID：10687930
> 
> 赞同：0
> 
> 时间：2012-05-21T15:13:24.100
> 
> 标签：jquery

我有一个 jquery 消息框的以下代码。如果我单击以下链接，则会出现一个消息框。

```
<p><a id="msgup" class="">Demo Top</a></p>
<script>
    $("#msgup").bar({
        color            : '#1E90FF',
        background_color : '#FFFFFF',
        removebutton     : false,
        message          : 'Your profile customization has been saved!',
        time             : 2000
    }); 
</script> 
```

现在我想要实现的是当我在我的 ajax 服务器响应中获得“冷”作为值时显示消息框。为此，我尝试了以下代码。但它不工作。可能是因为调用 jquery 函数失败。请问如何使它工作？

```
$.ajax({  
    type: "POST",
    url: "<?php echo base_url(); ?>contents/hello",
    data: "id="+a_href,
    success: function(server_response) {
        if (server_response == 'cold') {

        //Beginning of the code for message box
        $("#msgup").bar({
            color            : '#1E90FF',
            background_color : '#FFFFFF',
            removebutton     : false,
            message          : 'Your profile customization has been saved!',
            time             : 2000
        });
        //End of the code for message box

        // Instead of the message box code I have tried 
        // alert('Message'); and it worked
        }                       
        else {
            $("#result").html(server_response);
        }               
    }                              
}); //$.ajax ends 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:48:11.280

```
$("#msgup").bar(…) 
```

将单击事件绑定到#msgup（只是猜测），因此从 ajax 代码中调用它将无济于事。实现目标的一种可能方法是初始化 $.bar 并从 ajax 代码触发点击，可能是这样：

```
<p><a id="msgup" class="">Demo Top</a></p>
<script>
    $("#msgup").bar({
        color            : '#1E90FF',
        background_color : '#FFFFFF',
        removebutton     : false,
        message          : 'Your profile customization has been saved!',
        time             : 2000
    });
    $.ajax({
        type: "POST",
        url: "<?php echo base_url(); ?>contents/hello",
        data: "id="+a_href,
        success: function(server_response){
            if (server_response == 'cold'){
                //Beginning of the code for message box
                $("#msgup").click();
                //End of the code for message box
           } else {
              $("#result").html(server_response);}                   
           }
        }                             
    });   
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:19:49.663

您可以在您的成功函数中放置一个`alert()`或。`console.log()`打电话`alert(server_response)`。甚至，`alert(typeof(server_response))`. 您还可以通过添加错误来查看 AJAX 是否正常返回：条件（使用它自己的函数调用，就像成功一样:)。

我的猜测是你会想要检查而不是''，对于文字'null'甚至是对象null，只要它进入成功函数。

if (server_response == '' || server_response == 'null' || server_response == null || typeof(server_response) == 'undefined') {...

一旦你知道你期望它如何回来，你就可以只使用你需要的支票。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:34:59.123

您是否尝试将其包装在 setTimeout(function() { $("#msgup").bar({}); }, 100); 看看是不是时间问题？如果是这样，而不是将其放入成功：，也许将其放入完整：？

此外，如果您在 if() 中放置了一个警报，并且它被调用，那么 ID 为 #msgup 的 HTML 元素在当时存在（再次回到时间考虑）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T16:22:48.143

看`jquery.bar.js`，`$("#msgup").bar(…)`只是`"#msgup"`为点击事件绑定初始化元素。如果点击事件被触发，`jquery.bar`插件将创建新元素并将其显示为消息框。所以，你需要触发点击事件。试试这个

```
$.ajax({  
    type: "POST",
    url: "<?php echo base_url(); ?>contents/hello",
    data: "id="+a_href,
    success: function(server_response) {
        if (server_response == 'cold') {

        //Beginning of the code for message box
        $("#msgup").bar({
            color            : '#1E90FF',
            background_color : '#FFFFFF',
            removebutton     : false,
            message          : 'Your profile customization has been saved!',
            time             : 2000
        });
        $("#msgup").click(); //fire click event
        //End of the code for message box

        // Instead of the message box code I have tried 
        // alert('Message'); and it worked
        }                       
        else {
            $("#result").html(server_response);
        }               
    }                              
}); //$.ajax ends 
```

# jquery - 使用自动完成填充多个字段

> ID：10687931
> 
> 赞同：0
> 
> 时间：2012-05-21T15:13:26.657
> 
> 标签：jquery, list, autocomplete

我正在尝试通过 jquery 自动完成插件实现自动完成。我已经使用了这里的脚本[jQuery UI autocomplete](http://jqueryui.com/demos/autocomplete/)。我目前有一个名为“搜索感染”的字段，其中存储了“**描述**”。

```
<tr>
<td>Search Infection</td>
<td>
<input id="tags" type="text"  size="80" /></td>
</tr> 
```

这适用于自动完成。

我还有一个名为“短代码”的字段，我想在其中存储**Code**。

```
<tr>
<td>Short Code</td>
<td>
<input id="" type="text"  size="15" /></td>
</tr> 
```

当用户在感染字段中搜索描述时，有没有办法可以将代码存储在“短代码”字段中？

请，请帮助。

```
 CODE and DESCRIPTION list.

  ---------------------------------------------------------
  Code  Description
  ---------------------------------------------------------
  ID01  Actinomycosis
  ID02  Aspergillosis
  ID03  Bacteraemia / blood stream infection/ Septicaemia
  ID04  Bacterial meningitis
  ID05  Bronchiectasis
  ID06  Candidiasis
  ID07  Carotid patch infection
  ID08  Cellulitis
  ID09  Cerebral abscess
  ID10  Cholangitis
  ---------------------------------------------------------------------
  =====================================================================

  <script>
  $(function() {
    var availableTags = [
                  "Actinomycosis",
                  "Aspergillosis",
                  "Bacteraemia / blood stream infection/ Septicaemia",
                  "Bacterial meningitis",
                  "Bronchiectasis",
                  "Candidiasis",
                  "Carotid patch infection",
                  "Cellulitis",
                  "Cerebral abscess",
                  "Cholangitis" 
                    ];
    $( "#tags" ).autocomplete({
        source: availableTags
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T15:32:58.163

试试这个链接。

那是示例代码：

```
var availableTags = [
    {key:"ID01",value:"Actinomycosis"},
    {key:"ID02",value:"Aspergillosis"},
    {key:"ID03",value:"Bacteraemia / blood stream infection/ Septicaemia"}
]; 
```

[http://jsfiddle.net/5EsAb/3/](http://jsfiddle.net/5EsAb/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:44:17.700

我为你做了这个：

我还为文本事件使用了一个插件：

[http://www.zurb.com/playground/javascripts/plugins/jquery.textchange.min.js](http://www.zurb.com/playground/javascripts/plugins/jquery.textchange.min.js)

（当感染与更少的代码不匹配时清理短代码）

**现场演示：http:** [//jsfiddle.net/oscarj24/SUckd/1/](http://jsfiddle.net/oscarj24/SUckd/1/)

# jquery - jQuery改变一个 image source when clicking and/or hovering over an - what am I doing wrong?

> ID：10687932
> 
> 赞同：2
> 
> 时间：2012-05-21T15:13:29.647
> 
> 标签：jquery, image, mapping, hover, imagemap

我已经使用基本`map`和`area`标签创建了一个图像映射。我已经测试了地图，所有区域的行为都符合预期，因此 HTML 绝对正确。

我现在正在尝试使用 JQuery 在悬停和/或单击它们时根据不同区域获取地图（源）的图像。通过这种方式，我希望获得一种“交互式”地图，显示地图上不同位置的连接方式。
我定义的所有区域都有一个唯一的 ID。

这是我用于点击版本的脚本：

```
$(document).ready(function() {
    $('#area1').click(function() {
        $('#londonmap').css('src', 'area1map.png');
    });
});​ 
```

#area id 名称根据悬停的区域而变化，而 #londonmap 是用作地图的图像的 ID，其来源需要根据悬停/单击的区域而变化。

我不是 JQuery 专家，所以我需要问一下——我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:16:40.697

'src' 不是 CSS 属性，而是`<img>`标签的属性。

```
$(document).ready(function() {
    $('#area1').click(function() {
        $('#londonmap').attr('src', 'area1map.png');
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:17:58.580

您正在尝试使用`$.css()`jQuery 的方法更改图像源。图像的来源不是用 CSS 设置的，它是图像本身的属性。因此，您应该使用`$.attr()`来修改此值：

```
$("#londonmap").attr("src", "area1map.ong"); 
```

# php - PHP：如何使用输出缓冲区缓存页面？

> ID：10687933
> 
> 赞同：0
> 
> 时间：2012-05-21T15:13:29.307
> 
> 标签：php, mysql, output-buffering

我正在尝试缓存一个从非常慢的 API 获取/处理数据的页面 - 所以我可以快速将其加载给用户。但是由于某种原因，输出缓冲区是空的？

```
<?php

ob_start();

// here I have php scripting accessing api's for information

?>

// Here I have HTML content with some php conditions and echos to filter and display the gathered information

// then I try to save the buffered page to the database:

<?php

//connect to database
$page = ob_get_contents();

mysql_query("UPDATE `pages` SET `page_cache` = '" . $page . "' WHERE `page_id` = '" . $page_id . "'");

?> 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:14:57.880

您是否确保您的 $page 仅包含数据库安全字符？

例如，如果输出包含单个会发生什么`'`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:25:49.013

您可能想让 MySQL 对该 $page 变量进行编码：

```
mysql_query(sprintf(
    "UPDATE `pages` SET `page_cache`='%s' WHERE `page_id`=%s",
    mysql_real_escape_string( $page ),
    intval( $page_id )  // assuming it's an int
)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:14:36.517

检查 /etc/php.ini 中的输出缓冲是否打开： [http ://www.php.net/manual/en/outcontrol.configuration.php](http://www.php.net/manual/en/outcontrol.configuration.php)

另外，做一个：

```
<?php echo ob_get_contents(); ?> 
```

如果它打印 FALSE，则可能未启用输出缓冲：http: [//php.net/manual/en/function.ob-get-contents.php](http://php.net/manual/en/function.ob-get-contents.php)

# android - android在图像上的“固定”位置上定位TextView

> ID：10687935
> 
> 赞同：0
> 
> 时间：2012-05-21T15:13:32.897
> 
> 标签：android, image, textview, location, fixed

我正在尝试显示用户在图像上输入的值，有 4 个版本的图像（ldpi、mdpi、hdpi 和 xhdpi）。我想将 textViews 放置在调整为正确屏幕尺寸的“固定”位置。

有没有人对我如何实现这一目标提出一些建议？

这是我正在尝试做的事情的草图。

[http://dl.dropbox.com/u/251053/stackoverflow.png](http://dl.dropbox.com/u/251053/stackoverflow.png)

*编辑*

感谢您的快速回复。上传了一张新图片，我猜这对于相对布局是不可能的？

[http://dl.dropbox.com/u/251053/stackoverflow1.png](http://dl.dropbox.com/u/251053/stackoverflow1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:17:11.217

查看“RelativeLayout”文档：http: [//developer.android.com/reference/android/widget/RelativeLayout.html](http://developer.android.com/reference/android/widget/RelativeLayout.html)

您将能够将您的 textView 放在您的 ImageView 周围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T11:52:59.493

我认为最好的方法是通过扩展 View 类来创建自定义视图。它并不像看起来那么复杂。[在这里](http://developer.android.com/guide/topics/ui/custom-components.html)，您可以找到有关自定义 UI 组件的更多信息。

主要思想是重写 onDraw(Canvas canvas) 和 onMeasure(int widthMeasureSpec, int heightMeasureSpec) 方法。在 onMeasure 中，您应该返回视图的尺寸，还可以计算矩形的大小和角度以及要绘制的文本的大小。或者您可以实现自定义 resize() 方法，该方法将在您从活动中查看并进行文本和图像计算时显式调用。

当您知道所有测量值时，您可以在 onDraw(Canvas canvas) 方法中定位和绘制图像和文本。

```
@Override
    protected void onDraw(Canvas canvas) {

    myImageDrawable.setBounds(0,0,50,50);
    myImageDrawable.draw(canvas);

    canvas.drawText(myText, 10, 10, myTextPaint);
} 
```

[您可以在此处](http://developer.android.com/reference/android/graphics/Canvas.html)找到有关 Canvas 类的更多信息。您也可以使用[StaticLayout](http://developer.android.com/reference/android/text/StaticLayout.html)来测量文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:55:00.120

我认为解决这个问题的最好方法是创建一个自定义布局，期望 ImageView 作为它的第一个孩子。

所有其他孩子都将是 TextView，您可以：

*   相对于 ImageView 位置的位置
*   位置与您的父自定义布局的高度/宽度成比例，该布局与您的 ImageView 的高度/宽度相匹配

子 TextView 的左/上位置信息可以通过适合您需要的自定义 LayoutParams 类给出。

# asp.net-mvc - Razor MVC 应用程序无法加载 FreeTextBox，但它没有 FreeTextBox

> ID：10687941
> 
> 赞同：0
> 
> 时间：2012-05-21T15:13:54.537
> 
> 标签：asp.net-mvc, filenotfoundexception, assembly-loading, freetextbox

我将 MVC3 Razor 应用程序上传到了 webhost 提供程序（在 Visual Studio 2010 下的开发服务器上运行良好）。

在部署的站点上，我得到一个

```
"Could not load file or assembly 'FreeTextBox, Version=3.3.1.12354, Culture=neutral, PublicKeyToken=5962a4e684a48b87' or one of its dependencies. The system cannot find the file specified." 
```

但我完全感到困惑，我的应用程序中没有任何 FreeTextBox！我什至没有引用那个 DLL。不幸的是，“Detaile”IIS 错误甚至没有提到谁或什么试图加载该 DLL，所以我不知道它来自哪里。

为了三重检查，我在我的自建应用程序上使用搜索掩码对 FreeTextBox 进行了搜索*。*在整个解决方案上，Visual Studio 找不到任何东西。

**这里的实际解决方案** 确实是继承了父应用程序的程序集。Ketan 根据您的建议，我通过这样做解决了它：

```
 <system.web>
     <assemblies>
        <clear/>
        ... here standard MVC3 assemblies of template project ...
     </assemblies>**
   </system.web> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:28:17.740

共享主机上的应用程序文件夹是否配置为“应用程序”？如果不是，那么它可能在更高级别使用 machine.config 或 web.config，其中有该控件的引用。FreeTextBox 是一个 ASP.NET WYSWYG 文本编辑器，网络主机通常免费包含在其托管包中。我会联系他们的技术支持来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:28:03.220

您正在引用依赖于“FreeTextBox”的程序集。

将包含“FreeTextBox”程序集的 .dll 部署到您的 /bin 目录，或者使用类似的工具找到有问题的程序集

*   [.NET 反射器](http://www.ndepend.com/)
*   [依赖](http://www.reflector.net/)
*   [点窥](http://www.jetbrains.com/decompiler/)

# asp.net - 如何使用 ASP.Net 图表控件确定数据点的高度？

> ID：10687943
> 
> 赞同：0
> 
> 时间：2012-05-21T15:14:03.387
> 
> 标签：asp.net, mschart

我有一个像这样的堆积柱形图：

![在此处输入图像描述](../Images/a1d8fc6965eb4ecab92a283d83dfbe77.png)

我正在使用文本注释在最右边的堆叠列中显示 2495 美元。我已经通过实验确定了正确的 y 位置 - 显然这不适用于动态生成的内容。

有谁知道我如何确定组成列的数据点的高度？我认为它会是这样的：

```
Chart1.Series[0][0].Height + Chart1.Series[1][0].Height + Chart1.Series[3][0].Height + Chart1.Series[4][0].Height 
```

但是，唉，这显然不是那么简单。任何想法或见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:04:12.747

看看这个链接

[http://support2.dundas.com/OnlineDocumentation/WebChart2005/Custom_Drawing_Using_the_Paint_Event.html](http://support2.dundas.com/OnlineDocumentation/WebChart2005/Custom_Drawing_Using_the_Paint_Event.html)

请参阅底部的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:54:09.103

事实证明，这一切都比我想象的要简单得多……注释使用*图表*坐标。这意味着您所要做的就是对实际*值*求和并将其用作 y 坐标。我最终这样做是为了计算各个系列的高度：

```
private int CalculateHeight(int i, ChartGraphics graphics)
{
    var height = 0.0;

    // find the respective heights of series i, add them together
    for (var x = 0; x < this.Chart1.Series.Count(); x++)
    {
        height += this.Chart1.Series[x].Points[i].YValues[0]; 
    }

    return (int)height;
} 
```

然后我像这样调用该函数：

```
 for (var i = 0; i < chart.Series[0].Points.Count(); i++ )
        {
            var height = this.CalculateHeight(i, e.ChartGraphics);

            this.Chart1.Annotations[i].Y = height + verticalPadding;
        } 
```

比我想象的要简单得多。

# java - Java + jar 文件

> ID：10687944
> 
> 赞同：0
> 
> 时间：2012-05-21T15:14:04.370
> 
> 标签：java, eclipse

我编写了一个快速的 Java 包装器，它启动 NMAP 可执行文件并等待它完成。我正在使用 Eclipse。我想在我的 Java jar 文件中包含 NMAP 源/可执行文件，以便我有一个独立的包。

在 Eclipse 中，我添加了 NMAP 文件夹层次结构。在 Eclipse 中，我可以看到 Java 正确地触发了 NMAP 实用程序，并在退出之前等待实用程序结束。
到现在为止还挺好。然后我用 eclipse 导出一个 JAR 文件。我可以看到 NMAP 文件夹层次结构存在。但是，当我尝试运行 JAR 文件时，找不到 nmap.exe。可以使用 jar 文件调用外部可执行文件吗？如果没有，我有什么选择？如果是这样，为什么它不能在 jar 文件中找到它，而它可以在 Eclipse 中找到它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:23:13.597

您需要将 .exe 及其所需的支持文件提取到磁盘上，然后才能将它们作为常规文件访问（我相信通过标准方法执行需要）。您可以查找有关如何使用 jar 中的一个`getResourceAsStream()`类文件将资源从 jar 复制到文件的示例。

提取后，您可以像现在一样执行（您可能需要根据您的操作系统确保执行权限等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T15:23:41.753

“执行本机程序”工具不了解如何在其他文件（如 ZIP 或 JAR）中调用 EXE 文件。

如果要执行此操作，您必须将文件提取到文件系统位置并在那里调用它。由于 Linux 发行版（PowerPC？其他库版本等）的多样性，您可能应该要求用户安装它并调用它，而不是自带。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T15:23:50.107

据我所知，您无法执行嵌入在 jar 文件中的可执行文件。

一种解决方案是将可执行文件嵌入到 jar 文件中。然后用于`getClass().getResourceAsStream("/path/to/executable")`检索字节并将它们输出到临时文件 ( `File.createTempFile()`)。在 UN*X 系统上，您必须`chmod u+x file`在尝试执行之前进行。最终，您可以删除临时文件或创建一次文件并每次重用它并调用`deleteOnExit()`.

当然，此解决方案意味着您拥有可在所有平台上运行的可执行文件。

您的解决方案可能适用于 Eclipse，因为您的“可执行”文件不在 jar 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T03:22:20.497

您可能还必须注意如何分发它，因为 Nmap 不是免费用于商业软件的。

有一个用于 Java 的开源库来调用 Nmap，但它假定 Nmap 安装在您运行代码的操作系统上。该 API 是 Nmap4j，它位于 sourceforge.net 上。

# android - 安卓：闪光灯

> ID：10687945
> 
> 赞同：-1
> 
> 时间：2012-05-21T15:14:05.680
> 
> 标签：android, toast

```
if(camera == null){

Toast.makeText(getBaseContext(),"without camera",Toast.LENGTH_LONG).show(); 

return;
  } 
```

-------------------------------------------------- ------------------------------------------ 添加完整代码

```
button.setOnClickListener(new OnClickListener() {

   public void onClick(View v) {

    if (isLightOn) {

     p.setFlashMode(Parameters.FLASH_MODE_OFF);

     camera.setParameters(p);
     camera.stopPreview();
     isLightOn = false;
     Toast.makeText(context, R.string.off, Toast.LENGTH_SHORT).show();

    } else {

     p.setFlashMode(Parameters.FLASH_MODE_TORCH);

     camera.setParameters(p);
     camera.startPreview();
     isLightOn = true;
     Toast.makeText(context, R.string.on, Toast.LENGTH_SHORT).show();
    }

   }
  }); 
```

对不起我的英语。

当您单击按钮以检查手机是否闪光时，我该怎么做？当没有闪烁时 - 显示一条消息（吐司）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:19:59.343

制作一个按钮对象

添加一个 onclicklistener

在 onclicklistener 的 onClick 函数中，在此处添加您的逻辑。

# mysql - 最佳数据库模式

> ID：10687949
> 
> 赞同：6
> 
> 时间：2012-05-21T15:14:17.950
> 
> 标签：mysql, database-design, orm, schema, laravel

我即将重新设计数据库架构，并且正在考虑在我的应用程序中使用 ORM，下面的架构是否可以与例如 Eloquent ORM 一起使用，还是我还必须添加 JOIN 表？

```
ISSUES(ID, ORGANIZATION_ID, DATE, TIME, CATEGORY_ID, TYPE_ID, ISSUE_DETAILS_ID)
ISSUE_DETAILS(ID, NAME, STATUS, EMAIL)
ORGANIZATIONS(ID, NAME, ADDRESS, CONTACT)
CATEGORIES(ID, CATEGORY)
TYPES(ID, TYPE, CATEGORY_ID) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T03:23:14.667

我可能会做的唯一不同的事情是将`issue_id`外键放在`issue_details`桌子上，这样你就可以建立**一对一的**关系。

所以如果你使用 Eloquent，你可以做这样的事情。

```
echo $issue->details->name; 
```

不过，我不完全确定您将在详细信息表中存储什么，也许一个问题会有多个详细信息，在这种情况下，您会有**多对多的**关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:48:36.790

除了 Jason 的建议之外，您还可以`category_id`从`issues`表中删除 ，因为每个都`type`已经有一个`category`，您已经可以通过类型访问该类别。

IE`$issue->type->category`

# mysql - 使用 JOIN、GROUP BY 和 HAVING 从表中删除

> ID：10687956
> 
> 赞同：0
> 
> 时间：2012-05-21T15:14:43.187
> 
> 标签：mysql

我有一张桌子`carts`，`cartitems`第二张桌子有一个外键。现在我想删除所有`carts`超过 3 个月且没有相关的行`cartitems`。以下查询给了我正确的结果：

```
SELECT * 
FROM  `carts` c
LEFT OUTER JOIN  `cartitems` i ON (  `c`.`id` =  `i`.`cart_id` ) 
WHERE  `c`.`last_updated` < DATE_SUB(NOW() , INTERVAL 3 MONTH) 
GROUP BY  `c`.`id` 
HAVING COUNT(  `i`.`id` ) = 0; 
```

但我不知道如何将此查询转换为`DELETE`.

此外，由于表中有大约 1000 万行`carts`，我会感谢有关如何改进此查询的建议 :-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:08:54.687

您可以在不带`LIMIT`或带 a的情况下运行以下`LIMIT`命令以批量删除行。

```
DELETE c
FROM  carts c
WHERE c.last_updated < DATE_SUB(NOW() , INTERVAL 3 MONTH)
  AND NOT EXISTS
      ( SELECT *
        FROM cartitems i 
        WHERE c.id = i.cart_id
     ) 
LIMIT 10000 ;                           --- optional 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:16:56.967

存在的查询应该可以工作：

```
DELETE FROM `carts` WHERE EXISTS (SELECT * 
FROM  `carts` c
LEFT OUTER JOIN  `cartitems` i ON (  `c`.`id` =  `i`.`cart_id` ) 
WHERE  `c`.`last_updated` < DATE_SUB(NOW() , INTERVAL 3 MONTH) 
GROUP BY  `c`.`id` 
HAVING COUNT(  `i`.`id` ) = 0); 
```

此查询应删除结果集中的所有行。

请注意，您可以将星号与 null 或任何其他值交换。

第二次尝试：

```
DELETE FROM `carts` WHERE `carts`.`id` IN (SELECT `c`.`id` 
FROM  `carts` c
LEFT OUTER JOIN  `cartitems` i ON (  `c`.`id` =  `i`.`cart_id` ) 
WHERE  `c`.`last_updated` < DATE_SUB(NOW() , INTERVAL 3 MONTH) 
GROUP BY  `c`.`id` 
HAVING COUNT(  `i`.`id` ) = 0); 
```

那会生成一个 id 列表（我希望 c.id 是您的主键）并删除与该 id 相关的所有行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:04:43.800

你可以试试这个

```
DELETE FROM 
(
    SELECT * 
    FROM  `carts` c
    LEFT OUTER JOIN  `cartitems` i ON (  `c`.`id` =  `i`.`cart_id` ) 
    WHERE  `c`.`last_updated` < DATE_SUB(NOW() , INTERVAL 3 MONTH) 
    GROUP BY  `c`.`id` 
    HAVING COUNT(  `i`.`id` ) = 0
); 
```

不过我不确定:)

# asp.net-mvc-3 - 在控制器动作执行期间显示模态弹出窗口

> ID：10687957
> 
> 赞同：0
> 
> 时间：2012-05-21T15:14:56.073
> 
> 标签：asp.net-mvc-3

我有一个控制器操作，在其 HTTP Post 操作期间，应在特定业务条件下显示一个模态弹出窗口。

它基本上是一个产品条款和条件弹出窗口，用户应该接受它才能继续执行。

有关如何实施此弹出窗口的任何建议？

一旦用户接受条款和条件，执行应该继续在同一个控制器动作中是否可能？

任何建议都会有很大帮助。

提前致谢

# linq - 将 WPF DataGrid 绑定到 LINQ 查询（实体框架）

> ID：10687959
> 
> 赞同：0
> 
> 时间：2012-05-21T15:14:59.643
> 
> 标签：linq, entity-framework, wpf-controls, ef-code-first

这一定很简单，但我似乎遗漏了一些东西。我已经搜索了几个小时，没有遇到任何可以解决我的问题的东西。问题是，虽然我可以将我的 LINQ 查询分配给 WPF DataGrid，但当我尝试编辑 DataGrid 的值之一时，我收到以下错误：

> System.InvalidOperationException 未处理 Message='EditItem' 不允许用于此视图。Source=PresentationFramework StackTrace：在 System.Windows.Controls.ItemCollection.System.ComponentModel.IEditableCollectionView.EditItem(Object item) 在 System.Windows.Controls.DataGrid.EditRowItem(Object rowItem) 在 System.Windows.Controls.DataGrid.OnExecutedBeginEdit( ExecutedRoutedEventArgs e) 在 System.Windows.Controls.DataGrid.OnExecutedBeginEdit(Object sender, ExecutedRoutedEventArgs e) 在 System.Windows.Input.CommandBinding.OnExecuted(Object sender, ExecutedRoutedEventArgs e)

我的 DataGrid 的 XAML 如下所示：

```
<DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" Height="565" HorizontalAlignment="Left" Margin="6,92,0,0" Name="translatedStringsDataGrid1" RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Top" Width="602">
    <DataGrid.Columns>
    <DataGridTextColumn x:Name="stringsIDColumn2" Binding="{Binding Path=StringsID}" Header="Strings Name" Width="SizeToHeader" />
    <DataGridTextColumn x:Name="translatedStringsValueColumn1" Binding="{Binding Path=TranslatedStringsValue}" Header="Translated Strings Value" Width="SizeToHeader" />
    </DataGrid.Columns>
</DataGrid> 
```

我在 ComboBox 的 SelectedChange 事件中执行 LINQ 查询，如下所示：

```
private void cbSelectLang_SelectionChanged(object sender, SelectionChangedEventArgs e)
{

    var query = from o in _context.TranslatedStrings.Local 
                where o.LanguagesID == cbSelectLang.SelectedIndex + 1
                join r in _context.Strings.Local on o.StringsID equals r.StringsID into SubSet2

                from s in SubSet2.DefaultIfEmpty()

                select new { StringsID = s.StringsName, TranslatedStringsValue = o.TranslatedStringsValue };

    this.translatedStringsDataGrid1.ItemsSource = query;

} 
```

如果有人认为有更简单的方法可以实现这一点，我将使用“POCO 实体”。我真的觉得我错过了一些非常基本和明显的东西，如果有人愿意向我指出的话！:-)

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:12:13.010

我没有对此进行测试，但我相当确定您的问题是因为您从查询中返回了匿名类型。尝试将其更改为

```
...
from s in SubSet2.DefaultIfEmpty()
select new MyRealType 
{ 
    StringsID = s.StringsName, 
    TranslatedStringsValue = o.TranslatedStringsValue 
}; 
```

您需要在其中定义 MyRealType。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T19:20:26.567

部分感谢 Phil，我现在有了一种可行的技术，其中涉及 ObservableCollection 和新的持有者类型：

```
 private class JoinClass
    {
        public string StringsID { get; set; }
        public string TranslatedStringsValue { get; set; }
    }

    private void cbSelectLang_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        ObservableCollection<JoinClass> collection = new ObservableCollection<JoinClass>();

        var query = from o in _context.TranslatedStrings.Local
                                where o.LanguagesID == cbSelectLang.SelectedIndex + 1
                                join r in _context.Strings.Local on o.StringsID equals r.StringsID into SubSet
                                from s in SubSet.DefaultIfEmpty()
                                select new JoinClass { StringsID = s.StringsName, TranslatedStringsValue = o.TranslatedStringsValue };

        foreach (var item in query)
        {
            collection.Add(item);
        }

        this.translatedStringsDataGrid1.ItemsSource = collection;
    } 
```

谢谢！

# mod-rewrite - 如何将所有 /?[xyz] 重定向到 404

> ID：10687960
> 
> 赞同：1
> 
> 时间：2012-05-21T15:15:01.320
> 
> 标签：mod-rewrite, redirect, http-status-code-404

我已经尝试了很多东西......我知道我错过了一些东西。帮助！！

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^\? - [R=404,L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:50:20.040

`RewriteRule`不能直接在查询字符串上工作，您必须使用`RewriteCond`它们来访问它们（或内部重写的技巧，但这不是必需的）。

尝试

```
RewriteCond %{QUERY_STRING} .+
RewriteRule ^/?$ - [R=404,L] 
```

任何对根路径的查询都将以 404 响应结束。

# asp.net-mvc-3 - 返回 CSV 文件的 MVC 操作

> ID：10687962
> 
> 赞同：3
> 
> 时间：2012-05-21T15:15:07.553
> 
> 标签：asp.net-mvc-3, model-view-controller, csv, controller, action

我有一个 Action 负责从数据库中提取一些数据并将其作为 CSV 文件返回。

我知道我可以通过返回一个大字符串来做到这一点，但我在想是否有一种干净有效的方法可以用来通过 MVC 控制器操作返回 CSV 文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T15:20:28.353

FileResult 是您要查找的内容：

[http://msdn.microsoft.com/en-us/library/system.web.mvc.fileresult.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.fileresult.aspx)

```
public ActionResult GetFile()
{
    var stream = new StreamReader("thefilepath.txt");
    return File(stream.ReadToEnd(), "text/plain");
} 
```

此致

# ruby - 将编码为 UTF-8 的字符串写入文件

> ID：10687963
> 
> 赞同：1
> 
> 时间：2012-05-21T15:15:19.863
> 
> 标签：ruby, character-encoding

我在 Ruby (v1.9.2) 中有一个以 UTF-8 编码的字符串。我通过字符串和每个字符检查这个：

```
enc = __ENCODING__
=> #<Encoding:UTF-8>

s.encoding 
# => #<Encoding:UTF-8>

s.each_char{|c| return false unless c.encoding == enc }
# this passes 
```

我将字符串写入文件：

```
File.open("/path/to/file.rb", "w:UTF-8") do |f|
  f.write s
end
# => 39939

File.open("/path/to/file.rb", "rb").read.encoding
# => #<Encoding:ASCII-8BIT>

File.open("/path/to/file.rb", "r").read.encoding
# => #<Encoding:UTF-8> 
```

该文件还由我正在使用的文本编辑器 (TextWrangler) 设置以使用 UTF-8，并且它也设置了魔术注释。**如何确保读取此文件的任何 ruby​​ 程序（不一定在我的控制之下）认为编码是 UTF-8？**

*注意：我确实有一个我正在尝试修复的特定错误，但是这个问题出现得足够多，我想得到一个一般性的答案。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:52:44.897

通常 Ruby 将`$LANG`env 变量作为启动器，如果该变量设置为 utf-8，则 ruby​​ 默认应以 utf-8 读取文件。

# bioinformatics - 通过在文件中添加数字 (100) 来替换字符串（如 g1），如文件中的 (g101)

> ID：10687965
> 
> 赞同：0
> 
> 时间：2012-05-21T15:15:23.367
> 
> 标签：bioinformatics

我有一个文件，其中包含基因名称，如 g1、g2、g3、g1.t1、g2.t1、g3.t1 ...，我需要在“g”旁边的每个数字上加 100 为 g101、g102、g103， g101.t1, g102.t1, g103.t1 ... 下面是文件中的一些行

起始基因g1

Chr1 AUGUSTUS 基因 3656 5929 0.1 + . g1 Chr1 AUGUSTUS 成绩单 3656 5929 0.1 + . g1.t1 Chr1 AUGUSTUS tss 3656 3656。+ . 成绩单ID“g1.t1”；基因ID“g1”；Chr1 AUGUSTUS 外显子 3656 3926。+ . 成绩单ID“g1.t1”；基因ID“g1”；

我需要使用 sed 命令将文件中的所有 g1、g2、.. 替换为更新后的值。有人有想法吗？

最好的，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T15:06:10.390

一种使用方式`perl`：

```
perl -pe 's/g(\d+)/"g".($1+100)/ge' file 
```

结果：

```
start  gene      g101
Chr1   AUGUSTUS  gene        3656  5929  0.1  +  .  g101
Chr1   AUGUSTUS  transcript  3656  5929  0.1  +  .  g101.t1
Chr1   AUGUSTUS  tss         3656  3656  .    +  .  transcript_id  "g101.t1";  gene_id  "g101";
Chr1   AUGUSTUS  exon        3656  3926  .    +  .  transcript_id  "g101.t1";  gene_id  "g101"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:32:22.653

它很丑，我敢肯定还有更优雅的解决方案，但这里有一些东西可以开始。

```
sed -i -e "s/[g]\([0-9]\)/g10\1/g" file 
```

我正在研究用 sed 做实际算术，这似乎不太理想。我建议研究 awk。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T04:57:24.983

```
snafu$ touch g1 g2 g3 g1.t1 g2.t1 g3.t1
snafu$ prename -v 's/g(\d+)/sprintf("g%03d",$1+100)/e' g* 
g1 renamed as g101
g1.t1 renamed as g101.t1
g2 renamed as g102
g2.t1 renamed as g102.t1
g3 renamed as g103
g3.t1 renamed as g103.t1 
```

-n 是一个试运行——它会在不执行的情况下向您显示建议的重命名。

perl 中包含 prename。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T13:01:23.197

这适用于提供的测试数据。如果同一行中有多个基因名称，即 g1 和 g10，则可能是错误的，但看起来并非如此。

```
gawk '{match($0,"g[0-9]+",ary);i=0;while(length(ary[i])>0){ gsub(ary[i],"g"(int(substr(ary[i],2))+100));i+=1}; print $0}' file 
```

返回：

起始基因g101

Chr1 AUGUSTUS 基因 3656 5929 0.1 + . g101 Chr1 AUGUSTUS 成绩单 3656 5929 0.1 + . g101.t1 Chr1 AUGUSTUS tss 3656 3656。+ . 成绩单ID“g101.t1”；基因ID“g101”；Chr1 AUGUSTUS 外显子 3656 3926。+ . 成绩单ID“g101.t1”；基因ID“g101”；

# asp.net - 在 EditItemTemplate 内的 ControlParameter 中找不到控件

> ID：10687972
> 
> 赞同：12
> 
> 时间：2012-05-21T15:15:44.963
> 
> 标签：asp.net, data-binding, linq-to-entities, dynamic-data

我在一个动态数据网站上工作，我遇到了墙。我有一个详细信息页面，可以看到每个员工的详细信息，然后我有一个单独的页面来编辑每个员工。我这样做是因为我需要在每个部门中为 Department 和 Job 使用 DropDownList 框。尽管如此，我在访问部门 ddl 时遇到问题，我认为这是因为它位于 EditItemTemplate 中。这是我所拥有的：

```
<asp:DetailsView ID="dvEmployee" 
                    DataSourceID="EmpDVds" 
                    AutoGenerateRows="false" 
                    DataKeyNames="Id" 
                    GridLines="None" 
                    CellSpacing="10" 
                    runat="server" DefaultMode="Edit">
                    <Fields>
                        <asp:TemplateField HeaderStyle-Font-Bold="true" HeaderText="Department: ">
                            <EditItemTemplate>
                                <asp:DropDownList ID="ddlDept" DataSourceID="DeptDDLds" DataTextField = "DepartmentName" DataValueField = "Id" runat="server" SelectedValue='<%#Bind("DeptID") %>' />
                            </EditItemTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderStyle-Font-Bold="true" HeaderText="Job Code: ">
                            <EditItemTemplate>
                                <asp:DropDownList ID="ddlJob" DataSourceID="JobDDLds" DataTextField = "JobName" DataValueField = "Id" runat="server" />
                            </EditItemTemplate>
                        </asp:TemplateField>
                    </Fields> 
```

然后我尝试使用 ddlDept SelectedValue 来填充 ddlJob。这是我尝试使用的数据源。

```
<asp:SqlDataSource ID="JobDDLds"
                    SelectCommand="
                        SELECT 
                        Id, 
                        Code+' - '+[Desc] AS JobName,
                        Department_Id 
                        FROM 
                        JobCodes 
                        WHERE
                        JobCodes.Department_Id = @DeptID"
                    ConnectionString="<%$ConnectionStrings:TrainingDatabaseConnection %>" runat="server" >
                        <SelectParameters>
                            <asp:ControlParameter ControlID="ddlDept" PropertyName="SelectedValue"
                                    Name="DeptID" Type="Int32" />
                        </SelectParameters>
                    </asp:SqlDataSource> 
```

我知道 Select 参数的格式是正确的，因为我正在使用另一个 ddl 来填充 DetailsView，并且我知道 Departments 和 JobCodes 之间的关系是正确的，因为我在 AddEmployee 页面中成功使用了它。

这是我得到的错误：

在 ControlParameter 'DeptID' 中找不到控件 'ddlDept'。

我假设它无法通过它的 ID 访问 ddlDept 是正确的，因为它位于 EditItemTemplate 中？我怎样才能解决这个问题？关于如何实现这一目标的其他建议？非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-25T15:40:41.780

我发现此链接有助于在没有服务器端的情况下解决：[解决错误“在 ControlParameter 'xxx' 中找不到控件 'xxx'。”](http://geekswithblogs.net/AzamSharp/archive/2006/08/27/89475.aspx)

作者说您可以使用美元字符（**$**）来访问内部控件。

前任：

`ControlID="dvEmployee$ddlDept"`

将获得 ddlDept 的值，它是 dvEmployee 的内部控件

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T15:44:39.770

你的假设是正确的；`<ControlParameter`> 无法识别您的 ddlDept，因为它位于不同的`ContentTemplate`.

解决此问题的一种方法是删除`<ControlParameter>`从标记中删除 并在运行时以编程方式添加它，以便您可以使用 ddlDept 的实际`UniqueID`属性。

像这样的东西：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        // Create your ControlParameter
        ControlParameter deptParam = new ControlParameter();
        deptParam.ControlID = ddlDept.UniqueID;
        deptParam.PropertyName = "SelectedValue";
        deptParam.Name = "DeptID";
        deptParam.Type = TypeCode.Int32;
        // Add it to your SelectParameters collection
        JobDDLds.SelectParameters.Add(deptParam);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-28T02:55:02.277

我发现通过数据源对象在 DetailsView 或 GridView 控件的上下文中查找控件来解决此问题的一种方法是将数据源控件实际放置在具有您希望引用的控件的项/编辑项模板中. 这可能不适用于所有情况，但它确实有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-13T18:24:16.703

另一种选择是将下拉列表客户端 ID 模式设置为静态。那么您的下拉列表 id 将不会被修改。

```
 ClientIDMode="Static" 
```

谢谢，

埃森。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-10T19:06:24.257

确保您的利益控制具有 runat="server"。啊。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-02T07:41:35.950

如果您谈论 gridview（添加新记录按钮），请使用

```
 <asp:Parameter Name="Type" Type="String"/> 
```

代替

```
 <asp:ControlParameter    Name="Type"    ControlID="rddType"   PropertyName="SelectedValue" /> 
```

# javascript - Javascript - 从排序 DOM 集合中获得的好处

> ID：10687973
> 
> 赞同：2
> 
> 时间：2012-05-21T15:15:47.717
> 
> 标签：javascript, sorting, css-selectors

我正在做我的个人项目，即创建一个 javascript 选择器引擎。引擎将使用 CSS2 - CSS3 语法来选择元素节点。我正在将我的引擎的选择结果与其他选择器引擎的结果（主要是 Sizzle）进行比较。我还将它与称为 querySelectorAll (QSA) 的本机选择器方法进行了比较。我注意到一个区别。

文档的 HTML 结构很简单：

`<code><span></span></code>`

我使用的选择器是：

> '跨度，代码'

当我使用 Sizzle 或 QSA 进行选择时，我得到的结果是：

`[<code>...</code>, <span></span>]`

当我使用我的选择器引擎时，结果是这样的：

`[<span></span>, <code>...</code>]`

看起来，Sizzle 和 QSA 根据文档上元素的位置对集合进行排序。我的选择器引擎不这样做。我发现，可以使用 compareDocumentPosition 和 Array 排序方法来实现排序。显然这会对性能产生一点影响，虽然我还没有测试过。（来源：[http](http://ejohn.org/blog/comparing-document-position/) ://ejohn.org/blog/comparing-document-position/ ）。

我想知道排序节点是否比“未排序”节点提供一些好处。例如，在对元素进行排序时，将 css 样式添加到集合的节点（即循环中）是否更有效。还有其他情况，使用排序集合可能更好吗？

示例（elementNodes 包含选择结果）：

> for (var i = 0, il = elementNodes.length; i < il; i++) {
> 
> ```
>  elementNodes[i].style.height = '100px';
> 
>  elementNodes[i].style.width = '100px';
> 
>  elementNodes[i].style.background = 'red'; 
> ```
> 
> }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:29:24.137

首先，我喜欢你在这里所做的事情，尤其喜欢你正在与其他开源引擎进行比较。

实际上，这两个示例的“排序”方式不同。

除非你找到一个令人信服的理由（我想不出一个）以与嘶嘶声相同的方式对你的进行排序，否则不要这样做。只要您清楚自己的引擎的顺序，并且其他人也可以理解，那才是最重要的。

# php - 将数据从表单发布到电子邮件

> ID：10687974
> 
> 赞同：6
> 
> 时间：2012-05-21T15:15:51.820
> 
> 标签：php, html, forms, email

我想制作一个表格，将数据发布到我的电子邮件中。

我找到了以下代码，它工作正常，但我想删除一些不需要的字段。例如，如何在不破坏工作代码的情况下删除“姓氏”和“电子邮件”字段？

HTML：

```
<html>
<head>
    <title>Форма</title>
</head>

<body>
<form name="contactform" method="post" action="send_form_email.php">
    <table width="450px">
        <tr>
            <td valign="top">
                <label for="first_name">Name *</label>
            </td>
            <td valign="top">
                <input  type="text" name="first_name" maxlength="50" size="30">
            </td>
        </tr>

        <tr>
            <td valign="top">
                <label for="telephone">Phone number</label>
            </td>
            <td valign="top">
                <input  type="text" name="telephone" maxlength="30" size="30">
            </td>
        </tr>
        <tr>
            <td valign="top">
                <label for="comments">Comments *</label>
            </td>
            <td valign="top">
                <textarea  name="comments" maxlength="1000" cols="25" rows="6"></textarea>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="text-align:center">
                <input type="submit" value="Send">
            </td>
        </tr>
    </table>
</form>
</body>

</html> 
```

PHP：

```
<?php
    if(isset($_POST['email'])) {

    // EDIT THE 2 LINES BELOW AS REQUIRED
    $email_to = "mymail@gmail.com";
    $email_subject = "Order";

    function died($error) {
        // your error code can go here
        echo "We are very sorry, but there were error(s) found with the form you submitted. ";
        echo "These errors appear below.<br /><br />";
        echo $error."<br /><br />";
        echo "Please go back and fix these errors.<br /><br />";
        die();
    }

    // validation expected data exists
    if(!isset($_POST['first_name']) ||
        !isset($_POST['telephone']) ||
        !isset($_POST['comments'])) {
        died('We are sorry, but there appears to be a problem with the form you submitted.');       
    }

    $first_name = $_POST['first_name']; // required
    $telephone = $_POST['telephone']; // not required
    $comments = $_POST['comments']; // required

    $error_message = "";
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
    $string_exp = "/^[A-Za-z .'-]+$/";
  if(!preg_match($string_exp,$first_name)) {
    $error_message .= 'The First Name you entered does not appear to be valid.<br />';
  }
  if(strlen($comments) < 2) {
    $error_message .= 'The Comments you entered do not appear to be valid.<br />';
  }
  if(strlen($error_message) > 0) {
    died($error_message);
  }
    $email_message = "Form details below.\n\n";

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "First Name: ".clean_string($first_name)."\n";
    $email_message .= "Telephone: ".clean_string($telephone)."\n";
    $email_message .= "Comments: ".clean_string($comments)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

<!-- include your own success html here -->

Thank you for contacting us. We will be in touch with you very soon.

<?php
}
?> 
```

按下发送按钮后没有任何反应。没有电子邮件，没有消息。只是干净的页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T15:20:04.127

HTML

```
<form name="contactform" method="post" action="send_form_email.php">
<table width="450px">
<tr>
 <td valign="top">
  <label for="first_name">Name *</label>
 </td>
 <td valign="top">
  <input  type="text" name="first_name" maxlength="50" size="30">
 </td>
</tr>
<tr>
 <td valign="top">
  <label for="telephone">Telephone Number</label>
 </td>
 <td valign="top">
  <input  type="text" name="telephone" maxlength="30" size="30">
 </td>
</tr>
<tr>
 <td valign="top">
  <label for="comments">Comments *</label>
 </td>
 <td valign="top">
  <textarea  name="comments" maxlength="1000" cols="25" rows="6"></textarea>
 </td>
</tr>
<tr>
 <td colspan="2" style="text-align:center">
  <input type="submit" value="Submit">
 </td>
</tr>
</table>
</form> 
```

PHP

```
<?php
if(isset($_POST['first_name'])) {

    // EDIT THE 2 LINES BELOW AS REQUIRED
    $email_to = "you@yourdomain.com";
    $email_subject = "Your email subject line";

    function died($error) {
        // your error code can go here
        echo "We are very sorry, but there were error(s) found with the form you submitted. ";
        echo "These errors appear below.<br /><br />";
        echo $error."<br /><br />";
        echo "Please go back and fix these errors.<br /><br />";
        die();
    }

    // validation expected data exists
    if(!isset($_POST['first_name']) ||
        !isset($_POST['telephone']) ||
        !isset($_POST['comments'])) {
        died('We are sorry, but there appears to be a problem with the form you submitted.');       
    }

    $first_name = $_POST['first_name']; // required
    $telephone = $_POST['telephone']; // not required
    $comments = $_POST['comments']; // required

    $error_message = "";
    $string_exp = "/^[A-Za-z .'-]+$/";
  if(!preg_match($string_exp,$first_name)) {
    $error_message .= 'The Name you entered does not appear to be valid.<br />';
  }
  if(strlen($comments) < 2) {
    $error_message .= 'The Comments you entered do not appear to be valid.<br />';
  }
  if(strlen($error_message) > 0) {
    died($error_message);
  }
    $email_message = "Form details below.\n\n";

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "Name: ".clean_string($first_name)."\n";
    $email_message .= "Telephone: ".clean_string($telephone)."\n";
    $email_message .= "Comments: ".clean_string($comments)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
echo (int) mail($email_to, $email_subject, $email_message, $headers);  
?>

<!-- include your own success html here -->

Thank you for contacting us. We will be in touch with you very soon.

<?php
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:17:05.737

只需删除对您不想要的字段的所有引用。当您遇到错误时，是时候发布问题了。

还要在调试时添加错误报告，将此行放在脚本顶部：

`error_reporting(E_ALL);`

# model-view-controller - MVC 中数据表的服务器端无法进行部署

> ID：10687981
> 
> 赞同：1
> 
> 时间：2012-05-21T15:16:20.127
> 
> 标签：model-view-controller, asp.net-mvc-2, controller, datatables

我在 MVC 2.0 中对我的数据表使用服务器端处理。我有一个控制器用来处理传入的请求。当我在 localhost 上查看页面时，它工作正常，这是它发送的请求标头的示例

```
http://localhost:42417/EmissionByRegion/DataProviderAction?_=1337611318226&sEcho=1&iColumns=40&sColumns=&iDisplayStart=0&iDisplayLength=10&mDataProp_0=0&mDataProp_1=1&mDataProp_2=2&mDataProp_3=3&mDataProp_4=4&.......[it goes on till 39 columns] 
```

这会得到一个有效的 json 响应，并且一切正常。但是当我在使用 IIS 7.5 的服务器上发布此代码时，当有相同请求参数的服务器回发时：

```
http://domain.com/EmissionByRegion/DataProviderAction?_=1337612368137&sEcho=1&iColumns=40&sColumns=&iDisplayStart=0&iDisplayLength=10&mDataProp_0=0&mDataProp_1=1&mDataProp_2=2&mDataProp_3=3&mDataProp_4=4&........ 
```

我得到一个 404 - 找不到文件或目录。

如果我只是输入这个：domain.com/EmissionByRegion/DataProviderAction

，它表明控制器在那里并且正在寻找有效的参数。所以它正在拿起控制器，但是当参数被传递时，它不起作用。为什么同一个项目即使在本地机器上工作，它也不能在服务器上工作，我该怎么做才能让它工作？请帮忙 。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:14:52.163

I would suggest using a POST request instead of a GET, there is really not much work that you need to do. [See this post.](http://datatables.net/release-datatables/examples/server_side/post.html)