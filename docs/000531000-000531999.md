# StackOverflow 问答 000531000-000531999

# c# - 在浏览器关闭时运行服务器端功能

> ID：531001
> 
> 赞同：7
> 
> 时间：2009-02-10T03:48:21.203
> 
> 标签：c#, asp.net, onbeforeunload

背景：我正在使用 C# Code-Behind 创建一个非常简单的类似聊天室的 ASP.NET 页面。当前用户/聊天消息显示在位于 AJAX 更新面板内的控件中，并使用计时器 - 他们每隔几秒钟从数据库中提取信息。

我试图找到一种简单的方法来处理当用户退出浏览器时将用户的状态设置为“离线”，而不是点击“注销”按钮。IsOnline 的“离线”状态目前只有 1 个字符 (y/n)。

到目前为止，我已经用 Javascript 研究了 window.onbeforeunload，在这个事件上设置了一个带有函数的隐藏表单变量 -> 当然问题是，我仍然需要在我的代码隐藏中测试这个隐藏的表单变量。最终的服务器端数据库查询，有效地将用户设置为离线。

我可能完全混淆了这个可能很简单的问题！当然，我会很感激任何完全不同的替代建议。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T03:54:34.027

我怀疑你在叫错树。请记住，用户可能会突然失去他们的互联网连接，他们的浏览器可能会崩溃，或者使用大红色开关关闭他们的计算机。在某些情况下，服务器根本就再也不会从浏览器中听到了。

最好的方法是使用“死人开关”。既然您说他们每隔几秒钟就从数据库中提取信息，请利用这个机会存储（在数据库中）您最后一次从给定客户端听到的时间戳。

每隔一分钟左右，在服务器上进行一次查询以查找几分钟没有轮询的客户端，并将用户设置为离线......全部在服务器上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T03:55:00.563

Javascript 不可靠，因为我可以通过异常关闭浏览器。

更可靠的方法可能是从浏览器定期向服务器发送“嗨，我还活着”消息，并让服务器在停止接收这些消息时更改状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T04:00:11.237

我只能同意乔尔的观点。没有可靠*的*方法让您知道 HTTP 代理何时想要终止对话。

# sharepoint - Sharepoint SSL Web.Config 访问问题

> ID：531003
> 
> 赞同：1
> 
> 时间：2009-02-10T03:50:37.623
> 
> 标签：sharepoint, ssl, web-config, gac

我有一个奇怪的场景：

我有一个 webpart 调用 GAC 中的一个 dll，它试图从 web.config 文件中读取一个部分。这正常工作，但在 SSL 下它失败了，说它无权访问（配置文件的）路径。但是，它在 mosssvc 帐户下，该帐户可以完全控制 webconfig 文件。

80 web.config 文件和 443 web.config 文件都具有 dll 正在寻找的相同条目，并且 mosssvc 可以完全控制这两个配置。

我尝试将 443 上的信任级别提升到完全，但没有奏效。

有什么想法，或者你能想到的任何我可以尝试的东西吗？

编辑：我应该更清楚：SSL 站点已经创建并且工作正常，直到 GAC 程序集中的一种方法尝试检查 Web 配置。

完整的错误信息是：

```
Event Type:        Warning
Event Source:    ASP.NET 2.0.50727.0
Event Category:                Web Event 
Event ID:              1310
Date:                     2/9/2009
Time:                     1:44:49 PM
User:                     N/A
Computer:          XXXXX
Description:
Event code: 3008 
Event message: A configuration error has occurred. 
Event time: 2/9/2009 1:44:49 PM 
Event time (UTC): 2/9/2009 9:44:49 PM 
Event ID: 2d7180cdfbb34acfa6c61f95df12ddde 
Event sequence: 26 
Event occurrence: 1 
Event detail code: 0 

Application information: 
    Application domain: YYYYYYYYYYYYYYYYYYYYYYY
    Trust level: Full 
    Application Virtual Path: / 
    Application Path: C:\Inetpub\wwwroot\wss\VirtualDirectories\8443\ 
    Machine name: XXXXXXXX 

Process information: 
    Process ID: 5168 
    Process name: w3wp.exe 
    Account name: XXXXXXXXX\mosssvc 

Exception information: 
    Exception type: ConfigurationErrorsException 
    Exception message: An error occurred loading a configuration file: Access to the path 'C:\Inetpub\wwwroot\wss\VirtualDirectories\8443\web.config' is denied. (C:\Inetpub\wwwroot\wss\VirtualDirectories\8443\web.config) 

Request information: 
    Request URL: https://XXXXXXX:443/training/Pages/smartregister.aspx?c=383 
    Request path: /training/Pages/smartregister.aspx 
    User host address: 64.34.27.186 
    User:  
    Is authenticated: False 
    Authentication Type:  
    Thread account name: XXXXXXX\mosssvc 

Thread information: 
    Thread ID: 10 
    Thread account name: XXXXXXX\mosssvc 
    Is impersonating: True 
    Stack trace:    at System.Configuration.ConfigurationSchemaErrors.ThrowIfErrors(Boolean ignoreLocal)
   at System.Configuration.BaseConfigurationRecord.ThrowIfParseErrors(ConfigurationSchemaErrors schemaErrors)
   at System.Configuration.Configuration..ctor(String locationSubPath, Type typeConfigHost, Object[] hostInitConfigurationParams)
   at System.Configuration.Internal.InternalConfigConfigurationFactory.System.Configuration.Internal.IInternalConfigConfigurationFactory.Create(Type typeConfigHost, Object[] hostInitConfigurationParams)
   at System.Web.Configuration.WebConfigurationHost.OpenConfiguration(WebLevel webLevel, ConfigurationFileMap fileMap, VirtualPath path, String site, String locationSubPath, String server, String userName, String password, IntPtr tokenHandle)
   at System.Web.Configuration.WebConfigurationManager.OpenWebConfigurationImpl(WebLevel webLevel, ConfigurationFileMap fileMap, String path, String site, String locationSubPath, String server, String userName, String password, IntPtr userToken)
   at System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(String path)
   at XXXXXXXXX.RegistrationHelper.RegisterStudents(Boolean sendEmail, String Time, String Title, String bFirstName, String bLastName, String bAddress, String bPostalCode, String bCity, String bTelephone, String bCompany, String bEmail, List`1 Registrants, Int32 courseDateID, String pType, String CCNumber_, String NameOnCard, String cExpiry, Double Discount, String DiscountCode, Double CostPerRegistrant, String PurchaseOrder)
   at ASP.SmartEventRegistration.lnkSubmit_Click(Object sender, EventArgs e) in c:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\CONTROLTEMPLATES\SmartEventRegistration\SmartEventRegistration.ascx:line 401
   at System.Web.UI.WebControls.LinkButton.OnClick(EventArgs e)
   at System.Web.UI.WebControls.LinkButton.RaisePostBackEvent(String eventArgument)
   at System.Web.UI.WebControls.LinkButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)
   at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)
   at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at Microsoft.SharePoint.Publishing.TemplateRedirectionPage.ProcessRequest(HttpContext context)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T03:59:24.140

试试这个，从[Faranz Kan SharePoint 博客](http://faraz-khan.blogspot.com/2007/07/right-way-to-enable-ssl-on-moss-web.html)中了解如何在 MOSS 中启用 SSL：

> 1.  转到中央管理 --> 创建或扩展一个新的 Web 应用程序 --> 创建一个新的 Web 应用程序。
> 2.  像往常一样填写 Web 应用程序、数据库和应用程序池名称。选择是以在 Web 应用程序上启用 SSL。如果您为此 Web 应用程序使用主机标头，请也输入这些标头。（重要提示：确保将端口设置为 443，而不是 80）。
> 3.  创建 Web 应用程序后，重置 IIS，然后打开 IIS mmc。滚动到 MOSS 刚刚为您创建的 IIS 网站，然后从可用证书中选择正确的 SSL 证书（要求您的网络人员为您生成内部或外部 SSL 证书，具体取决于这是测试服务器还是生产服务器）。重要提示：转到主目录选项卡并单击高级。确保为端口 80 设置主机标头和正确的 IP。对于 SSL 条目，选择端口 443 和 IP。（如果您在服务器上有多个 IP，我通常会在这里为这些条目选择一个）。单击 SSL 条目的编辑按钮并选中“需要 SSL”框。还要检查“需要 128 位加密”以使其更安全。
> 4.  现在继续为这个 Web 应用程序创建您的第一个网站集。MOSS 将自动为您创建一个新的网站集，并在完成后向您显示“https://..”链接。您现在应该有一个支持 SSL 的 Web 应用程序。
> 5.  默认情况下，如果您希望多个 Web 应用在同一服务器上使用 SSL
>     *   这在 IIS 6 中不起作用。如果您希望多个 MOSS 2007 Web 应用程序启用 SSL，有两种方法可以解决此问题。一种方法是为该 Web 服务器获取尽可能多的 IP，并在 IIS 网站属性 --> 主目录 --> 高级下为端口 80 和 443 的端口 80 和 443 为每个主机头设置分配一个 IP。另一种选择是修改 IIS 元数据库以允许同一 IP 上的多个 SSL Web 应用程序。小心第二个选项，并确保你知道你在做什么。

# seo - 网址名称在非英语国家/地区的相关性如何？

> ID：531009
> 
> 赞同：1
> 
> 时间：2009-02-10T03:55:20.873
> 
> 标签：seo, internationalization, search-engine

如果我有一个属于日本公司的商业网站，它将使用片假名或日本汉字*（非 ASCII 字符）*作为他们希望在 google 中获得良好搜索结果的关键字，那么在网站上放置最接近的英文单词是否仍然重要 DNS 名称?

像：

如果搜索词是片假名的“主页”：ホームページ

DNS 名称会对结果产生影响吗？

更好，它有一个包含“主页”的DNS名称有什么影响吗？

谢谢，瑞克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T07:15:14.950

什么名字会带来更高的点击率是一种艺术，而不是一门科学。由于许多工具对 IDN（国际域名）的支持仍然很薄弱，我认为日文 DNS 名称带来的点击率会低于英文域名。

另一方面，根据我的经验，内容和内容的正确标记比域名本身吸引流量更重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T04:07:56.383

DNS 国际域被翻译成不可读的 ascii，所以我想将它用于 SEO 是没有意义的。

# asp.net - 在 ASP.NET 中使用 System.Web.Caching.Cache 类的问题

> ID：531014
> 
> 赞同：7
> 
> 时间：2009-02-10T03:58:22.130
> 
> 标签：asp.net, caching

所以我正在开发一个使用 ASP.NET 的项目。我正在尝试调用 Cache["key"] 但编译器抱怨 System.Web.Caching.Cache 如何“此时有效”。

如果我调用 Cache obj = new Cache(); obj 始终为空。

我可以访问 HttpContext.Current.Cache - 但这不允许我在 Insert() 方法中指定绝对过期和滑动过期。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T04:17:32.943

您应该能够在 HttpRuntime.Cache 上调用插入的绝对或滑动到期。它有几个重载。前任：

```
HttpRuntime.Cache.Insert("EXAMPLE_KEY", 
                        exampleItem, 
                        Nothing,                           
                        DateTime.Now.AddHours(1),
                        System.Web.Caching.Cache.NoSlidingExpiration); 
```

完全相同的代码也应该适用于 HttpContext.Current.Cache。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-17T21:23:01.990

我建议你尝试 PokeIn 库下的 PCache[类](http://pokein.codeplex.com)。即使您使用该库的免费版，这个类也没有限制。与 ASP.NET Cache 类相比，它具有更多功能，您不必处理这些问题。网站上有一个简单的示例项目。

# c# - 在 C# 2005 中动态获取/设置对象的属性

> ID：531025
> 
> 赞同：4
> 
> 时间：2009-02-10T04:10:12.600
> 
> 标签：c#, reflection

我继承了一个代码库，并且正在编写一个小工具来为其更新数据库。该代码使用像 SubSonic 这样的数据访问层（但它是自产的）。一个对象有很多属性，比如“id”、“templateFROM”和“templateTO”，但有50个。

在屏幕上，我无法在各自的文本框中显示所有 50 个属性以供数据输入，因此我有一个包含所有可能属性的列表框和一个用于编辑的文本框。当他们在列表框中选择一个属性时，我用该属性对应的值填充文本框。然后我需要在他们完成编辑后更新属性。

现在我正在使用 2 个巨大的 switch case 语句。这对我来说似乎很愚蠢。有没有办法动态地告诉 C# 我想要设置或获取什么属性？也许像：

```
entObj."templateFROM" = _sVal; 
```

??

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T04:14:21.670

您需要使用 System.Reflection 来完成该任务。

```
entObj.GetType().GetProperty("templateFROM").SetValue(entObj, _sVal, null); 
```

这应该可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T04:14:58.753

你想要的叫做[反射](http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T04:18:21.957

我认为您正在寻找的是反射。这是一个小片段：

```
Type t = entObj.GetType();
t.GetProperty("templateFROM").SetValue(entObj, "new value", null); 
```

在更多的可用性说明（而不是回答您的问题的说明）上，您可能想要研究使用[PropertyGrid](http://msdn.microsoft.com/en-us/library/aa302326.aspx)控件。该列表框/文本框听起来使用起来可能非常乏味。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T04:15:19.203

```
PropertyInfo[] properties = typeof(YourClass).GetProperties(BindingFlags.Instance | BindingFlags.Public) 
```

您可以将其绑定到您的下拉列表，然后：

```
PropertyInfo property = typeof(YourClass).GetProperty(propertyName, BindingFlags.Instance | BindingFlags.Public)
property.SetValue(class, textBox.Text, null); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T04:55:54.083

在相关的说明中，如果您的用户需要一次更新大量属性，他们会*讨厌这个界面。*您能否将属性划分为用户可以更快地浏览的组或页面？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T04:23:43.317

这个样本很有帮助

```
public class aa
{
    private string myVar;

    public string value
    {
        get { return myVar; }
        set { myVar = value; }
    }   
}

private void button1_Click(object sender, EventArgs e)
{
    aa a1 = new aa();
    System.Reflection.PropertyInfo pt = typeof(aa).GetProperty("value");
    pt.SetValue(a1, "hi",null);
    this.Text = a1.value;
} 
```

# .net - 有谁知道 MS Excel 求解器的更好替代方案？

> ID：531026
> 
> 赞同：4
> 
> 时间：2009-02-10T04:10:35.503
> 
> 标签：.net, excel, open-source, solver

我的公司必须处理大量数据，其中一部分过程涉及运行求解器并通过生成的数据点绘制图表。显然，这涉及到大量的复​​制和粘贴，整个过程不稳定，容易出错，而且是全盘捏造的。我想知道是否可以使用求解器的替代方案，这样即使我们必须使用 excel 来绘制最终图形，需要来回复制和粘贴的数据也会少得多。如果该工具可以很容易地集成到 .NET 应用程序中，那就太好了，但我愿意接受可能需要一点代码才能使其工作的建议。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T04:34:23.433

求解器本质上是一种用于查找函数根的迭代技术。根据您尝试查找根的函数的特定形式，您可以滚动您自己的或使用二分法或牛顿法（或许多其他迭代求根技术）的现有实现。如果您发布更多关于您要解决的特定问题的信息，我可能会为您指出更具体的技术。或者，您可以阅读有关[寻根的](http://en.wikipedia.org/wiki/Root_finding)信息并查看 Extreme Optimization[库](http://www.extremeoptimization.com)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-14T18:06:39.067

查看 Microsoft Solver Foundation，他们提供 .Net 库来解决不同类型的优化问题 [http://code.msdn.microsoft.com/solverfoundation](http://code.msdn.microsoft.com/solverfoundation)

您可以很容易地将它集成到您​​的代码中

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T04:54:29.827

[Netlib](http://www.netlib.org/master/expanded_liblist.html)提供了用于各种目的的开源求解器的完整列表。你可能会找到一些你喜欢的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-08T09:37:47.477

你可能想看看这个，我没有仔细看。

> [Eureqa](http://ccsl.mae.cornell.edu/eureqa)是一种软件工具，用于检测数据中的方程式和隐藏的数学关系。其主要目标是确定可以描述产生数据的基本机制的最简单的数学公式。Eureqa 可以免费下载和使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-11T01:59:37.660

您可能对我们为 Excel 开发的开源 OpenSolver 感兴趣；可从[http://www.opensolver.org](http://www.opensolver.org)获得。这使用免费的 COIN-OR CBC 求解器，可以求解线性和整数问题（但不是非线性模型）。它作为 Excel 加载项安装。它可以解决更大的问题，而且通常比 Solver 更快。希望你觉得它有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-14T18:23:03.573

OpenOffice 有一个新的非线性求解器插件，它使用与 Excel 求解器中使用的最速下降法完全不同的方法来寻找优化问题的解决方案。

根据您的描述，您的数据听起来有很多异常值。为此，您需要某种坚固的配件。

Matlab 是做所有这些事情的最佳程序，它可以从 .NET 链接

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T04:13:13.997

[gretl](http://gretl.sourceforge.net/)，Gnu 回归计量经济学和时间序列库，可以做你需要的事情，而且效率很高并且有据可查。我怀疑是否存在 .NET API，但如有必要，您可以通过脚本对其进行控制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-26T07:31:35.500

我已经为不同的项目自动化了求解器界面。您是否考虑过某种 VBA 宏？MS 的这篇支持文章贯穿了整个 VBA 界面： http: [//support.microsoft.com/kb/843304](http://support.microsoft.com/kb/843304)。我假设它也可以通过 .NET 访问。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-09-16T16:18:32.797

在您将 Excel 电子表格（引用 Solver 界面）带到另一台机器之前，Solver/Excel VBA 界面中的一个主要错误是不可见的。

在那里你会得到一个错误，基本上说解算器加载项没有加载。您必须进入 VBA 并进入 Tools、References 并重新建立对 Solver 库的引用。

很烦人。

# sql-server-2005 - SQL Server 上的高 PF 使用率

> ID：531027
> 
> 赞同：0
> 
> 时间：2009-02-10T04:11:39.150
> 
> 标签：sql-server-2005

我们在 64 位上运行 SQL Server 2005。PF Usage 每周接近 25 GB。在此期间，通常运行不到一秒的查询会变得非常慢。这可能是什么原因造成的？

运行 PerfMon 后，Total Server Memory 和 Target Server Memory 这两个计数器分别显示 20 GB 和 29 GB。处理器队列长度和磁盘队列长度为零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T04:22:58.390

听起来你没有足够的内存，服务器上有多少？超过您的页面文件？

也可能意味着 Sql Server 已“分页”，这意味着 Windows 决定将其存储在内存中的所有信息交换到磁盘上。

打开 Perfmon（转到命令提示符，然后键入 perfmon）并添加这些计数器：

*   SQLServer:Buffer Manager - 缓冲区缓存命中率
*   SQLServer:Buffer Manager - 页面预期寿命
*   SQLServer:Memory Manager - 内存授予挂起

如果 Buffer Cache Hit Ratio < 95% 这意味着 Sql 大量使用磁盘而不是内存，您需要更多内存。

如果您的页面预期寿命小于 500，则意味着 SqlServer 没有将结果缓存在内存中，您需要更多内存。

如果您有很多待处理的内存授予，则需要更多内存。

还有两个统计数据可以让您知道 SqlServer 需要多少内存以及它实际使用了多少。它们被称为“使用的总内存”和“请求的总内存”。如果 Requested > Used，猜猜看，你需要更多内存。

您还可以使用一些 dmv 来确定您的查询是否在等待内存释放时被搁置。我认为它的 sys_dmv.os_wait_stats，类似的东西。

我在社区对此进行了维基百科，因此真正的 dba 可以进来并清理它。不知道我头顶上的统计数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T04:49:24.613

这是关于如何使用 DMV 来确定 sql 上的内存消耗的精彩读物：[http](http://technet.microsoft.com/en-us/library/cc966540.aspx) ://technet.microsoft.com/en-us/library/cc966540.aspx - 查找“内存瓶颈”部分。

一件大事是确定内存压力是 SQL 内部的（通常是这种情况）还是外部的（很少见，但可能）。例如，您的服务器可能没有任何问题，但是您的防病毒程序安装的驱动程序正在泄漏内存。

# performance - 如何使用 Perl 修剪日志文件？

> ID：531029
> 
> 赞同：4
> 
> 时间：2009-02-10T04:13:03.560
> 
> 标签：performance, perl, file-io

我最近遇到了一种情况，一旦它们超过一定大小，我需要修剪一些相当大的日志文件。每个文件中除了最后 1000 行之外的所有内容都会被处理掉，作业由 cron 每半小时运行一次。我的解决方案是简单地浏览文件列表，检查大小并在必要时进行修剪。

```
for $file (@fileList) {
  if ( ((-s $file) / (1024 * 1024)) > $CSize) {
      open FH, "$file" or die "Cannot open ${file}: $!\n";
      $lineNo = 0;
      my @tLines;

      while(<FH>) {
        push @tLines, $_;
        shift @tLines if ++$lineNo < CLLimit;
      }
      close FH;

      open FH, ">$file" or die "Cannot write to ${file}: $!\n";
      print FH @tLines;
      close FH;
} 
```

这在当前形式下有效，但是对于大型日志文件（尤其是具有 100_000+ 行的日志文件）有很多开销，因为需要读取每一行并在必要时进行移位。

有什么方法可以读取文件的一部分，例如，在这种情况下，我希望能够仅访问最后的“CLLimit”行。由于该脚本部署在一个已经过得更好的系统上（想想 Celeron 700MHz 和 64MB RAM），我正在寻找使用 Perl 的更快替代方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T04:27:50.687

我知道您想使用 Perl，但如果这是一个 UNIX 系统，为什么不使用“tail”实用程序进行修整？你可以用一个非常简单的脚本在 BASH 中做到这一点：

```
if [ `stat -f "%z" "$file"` -gt "$MAX_FILE_SIZE" ]; then
    tail -1000 $file > $file.tmp
    #copy and then rm to avoid inode problems
    cp $file.tmp $file
    rm $file.tmp
fi 
```

话虽如此，如果您打算为此使用 Perl ，您可能会发现[**这篇文章非常有帮助。**](http://www.perlmonks.org/index.pl?node_id=162034)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T04:25:11.800

估计日志中一行的平均长度——称之为 N 字节。

从文件末尾向后搜索 1000 * 1.10 * N（因子 1.10 的误差为 10%）。从那里向前阅读，只保留最近的 1000 行。

* * *

有人问了这个问题 - 哪个功能或模块？

内置函数[seek](http://perldoc.perl.org/functions/seek.html)看起来像我用的工具吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T15:07:55.867

考虑简单地使用 logrotate 实用程序；它包含在大多数现代 Linux 发行版中。BSD 系统的相关工具称为 newsyslog。这些工具或多或少是为您的预期目的而设计的：它以原子方式将日志文件移出位置，创建一个新文件（与以前的名称相同）来保存新的日志条目，指示生成消息的程序使用新文件，然后（可选）压缩旧文件。您可以配置要保留多少轮换日志。这是一个潜在的教程： http: [//www.debian-administration.org/articles/117](http://www.debian-administration.org/articles/117)

这不是您想要的界面（保留一定数量的行），但该程序可能比您自己编写的程序更健壮；例如，这里的答案不涉及以原子方式移动文件并通知日志程序使用新文件，因此存在丢失某些日志消息的风险。

# c# - 帮助流 (.net)

> ID：531032
> 
> 赞同：1
> 
> 时间：2009-02-10T04:13:20.597
> 
> 标签：c#, .net, streaming, stream, iostream

我有一个流对象，我想根据输入流中的数据使用某种 xml 流创建和输出 xml。我没有对流做太多的工作，所以我正在努力学习如何尽可能有效地做到这一点。这个想法是我不想将整个输入流加载到内存中，然后在内存中创建整个输出流，因为在某些时候你最终会占用至少两倍的输入流大小。

必须有一些方法，以便在输入流中读取数据时，构建 xml 流并丢弃从输入流中读取的数据。此外，我想对其进行架构，以便 xml 流没有完全构建然后传递出去，而是可以在构建时读取 xml 流。有没有人有一些代码示例或学习这方面的好资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T04:25:13.517

如果您需要将 XML 作为原始数据访问，而不需要内存中文档对象模型 (DOM) 的开销，则使用 XmlTextReader

XmlTextReader 为读取 XML 提供了一种更快的机制。以下代码从流中加载 XmlTextReader。

```
using (XmlTextReader reader= new XmlTextReader (stream)) {

while (reader.Read()) 
{
    switch (reader.NodeType) 
    {
        case XmlNodeType.Element: // The node is an Element.
            Console.Write("<" + reader.Name);
   Console.WriteLine(">");
            break;
  case XmlNodeType.Text: //Display the text in each element.
            Console.WriteLine (reader.Value);
            break;
  case XmlNodeType. EndElement: //Display end of element.
            Console.Write("</" + reader.Name);
   Console.WriteLine(">");
            break;
    }
}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T06:02:03.300

要将 XML 作为流写出，请使用[XmlTextWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmltextwriter.aspx)。

您可以给它一个要写入的流。这将为您提供您想要的（流输出）并为您提供很大的灵活性。通过将要使用的流作为参数传递给代码，您可以连接内存流、文件流或几乎任何东西，而无需了解 XML 格式化代码。XmlTextWriter 将定期刷新数据（因此除非没有任何内容从流中读取数据，否则它不会一直存在），只需记住在最后进行最终刷新/关闭。

流也是您处理输入的方式。当您处理该输入并可以决定要写入哪些 XML 元素时，使用 XmlTextWriter 来编写它们，它将负责将该数据流式传输给将要读取它的任何人。因此，您最终会得到一个循环（或多个循环），该循环正在读取一点，进行一些处理，然后一次全部写入 XmlTextWriter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T04:35:43.740

您可以使用 XmlReader.Create 方法创建一个 XmlReaderObject 实例。使用 XmlReaderSettings 指定 XML 设置（XSD、IgnoreComments 等）

```
 XmlReaderSettings settings = new XmlReaderSettings(){
        settings.IgnoreComments = true;
        using (XmlReader reader = XmlReader.Create("Test.xml",settings)){
            while(reader.Read()){

                // Construct/Evaluate XML Here....
            }
            reader.Close();
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T06:31:29.517

如果您使用的是 .net 3.5，则可以使用 XLINQ。这是来自[http://blogs.msdn.com/wriju/archive/2007/02/20/xlinq-create-xml-from-object-using-linq.aspx的示例](http://blogs.msdn.com/wriju/archive/2007/02/20/xlinq-create-xml-from-object-using-linq.aspx)

如果您在[“xlinq create”](http://www.google.com/search?hl=en&safe=off&rlz=1C1GGLS_enUS310US310&q=xlinq+create&btnG=Search)上进行谷歌搜索， 您会发现很多示例（我在想，您可能对 RSS 示例最感兴趣。

```
var objCust = new[]
{
 new {CustID = 2, CustName = "Sumitra", Phone = "123-123-1236"},
 new {CustID = 3, CustName = "Wriju", Phone = "123-123-1235"},
 new {CustID = 4, CustName = "Writam", Phone = "123-123-1234"},
 new {CustID = 1, CustName = "Debajyoti", Phone = "123-123-1237"}   
};
XElement _customers = new XElement("customers",
                        from c in objCust
                        orderby c.CustID //descending 
                        select new XElement("customer",
                            new XElement("name", c.CustName),
                            new XAttribute("ID", c.CustID),
                            new XElement("phone", c.Phone)
                                            )
                                    );
Console.WriteLine(_customers); 
```

输出将如下所示：

```
<customers>
  <customer ID="1">
    <name>Debajyoti</name>
    <phone>123-123-1237</phone>
  </customer>
  <customer ID="2">
    <name>Sumitra</name>
    <phone>123-123-1236</phone>
  </customer>
  <customer ID="3">
    <name>Wriju</name>
    <phone>123-123-1235</phone>
  </customer>
  <customer ID="4">
    <name>Writam</name>
    <phone>123-123-1234</phone>
  </customer>
</customers> 
```

# sql - SQLite中如果不存在怎么办

> ID：531035
> 
> 赞同：83
> 
> 时间：2009-02-10T04:14:48.907
> 
> 标签：sql, sqlite

我正在尝试将此行从 MS SQL Server 移植到 SQLite

```
IF NOT EXISTS(SELECT 1 FROM EVENTTYPE WHERE EventTypeName = 'ANI Received') 
    INSERT INTO EVENTTYPE (EventTypeName) VALUES ('ANI Received'); 
```

似乎 SQLite 不支持 IF NOT EXISTS 或者至少我无法使其工作。我错过了一些简单的东西吗？有解决方法吗？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-02-10T05:30:34.793

这个怎么样？

```
INSERT OR IGNORE INTO EVENTTYPE (EventTypeName) VALUES 'ANI Received' 
```

（未经测试，因为我没有 SQLite ......但是[这个链接](http://www.sqlite.org/lang_insert.html)很有描述性。）

此外，这也应该有效：

```
INSERT INTO EVENTTYPE (EventTypeName)
SELECT 'ANI Received'
WHERE NOT EXISTS (SELECT 1 FROM EVENTTYPE WHERE EventTypeName = 'ANI Received'); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-04-23T05:04:00.193

如果你想忽略现有值的插入，你的表中必须有一个 Key 字段。只需创建一个带有主键字段的表，例如：

```
CREATE TABLE IF NOT EXISTS TblUsers (UserId INTEGER PRIMARY KEY, UserName varchar(100), ContactName varchar(100),Password varchar(100)); 
```

然后在表上插入或替换/插入或忽略查询，如：

```
INSERT OR REPLACE INTO TblUsers (UserId, UserName, ContactName ,Password) VALUES('1','UserName','ContactName','Password'); 
```

它不会让它重新输入现有的主键值......这就是您可以检查表中是否存在值的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T10:29:48.307

您还可以使用 KEY 字段在表上设置约束并设置 On Conflict "Ignore"

> 当发生适用的约束违例时，IGNORE 解析算法会跳过包含约束违例的一行并继续处理 SQL 语句的后续行，就好像没有出错一样。包含违反约束的行之前和之后的其他行被正常插入或更新。使用 IGNORE 冲突解决算法时不返回错误。

[SQLite 文档](http://www.sqlite.org/lang_conflict.html)

# css - IE CSS 对齐问题

> ID：531048
> 
> 赞同：3
> 
> 时间：2009-02-10T04:24:07.637
> 
> 标签：css, internet-explorer

我有以下CSS，我用PHP“破解”了它，因为它在IE7中没有正确对齐。有没有更好的方法可以在不使用 PHP 的情况下做到这一点？

```
 #Menu
    {
        width: 100%;
        height: 32px;
        padding-top: <?php if(preg_match('/msie/i', $_SERVER['HTTP_USER_AGENT'])){echo '22px';}else{echo '40px';}?>;
        padding-left: 13px;
    } 
```

我想避免使用条件注释并且必须维护多个 css 文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T05:08:16.907

哇。是的，不要那样做。你会想看看使用“条件注释”来包含你想要的 css。您的第一位评论者bendewey 已经向您展示了如何轻松定位IE7。还有其他类型的条件注释可以让您定位其他版本的 IE。

他们来了：

```
<!--[如果是 IE]>
根据有条件的评论，这是 Internet Explorer
<![endif]-->
<!--[如果 IE 5]>
根据有条件的评论，这是 Internet Explorer 5
<![endif]-->
<!--[如果 IE 5.0]>
根据有条件的评论，这是 Internet Explorer 5.0
<![endif]-->
<!--[如果 IE 5.5]>
根据有条件的评论，这是 Internet Explorer 5.5
<![endif]-->
<!--[如果 IE 6]>
根据有条件的评论，这是 Internet Explorer 6
<![endif]-->
<!--[如果 IE 7]>
根据有条件的评论，这是 Internet Explorer 7
<![endif]-->
<!--[如果 gte IE 5]>
根据有条件的评论，这是 Internet Explorer 5 及更高版本
<![endif]-->
<!--[if lt IE 6]>
根据条件评论，这是 Internet Explorer 低于 6
<![endif]-->
<!--[如果 lte IE 5.5]>
根据条件评论，这是 Internet Explorer 低于或等于 5.5
<![endif]-->
<!--[如果 gt IE 6]>
根据条件评论，这是 Internet Explorer 大于 6
<![endif]-->

```

如果您打算对不同版本的 IE 进行大量调整，您可能会提前计划并使用“body class”技巧。它在标记中看起来有点难看，但它是一种经过验证的技术，有时它胜过拥有大量样式表和样式标签。

这里是：

```
<!--[if !IE]>--><body><!--<![endif]-->
<!--[if IE 6]><body class="ie6"><![endif]-->
<!--[如果 IE 7]><body class="ie7"><![endif]-->
<!--[如果 IE 8]><body class="ie8"><![endif]-->

```

在您的样式表中，您只需通过在选择器上添加一个类来重置您想要的任何样式。像这样：

```
#some_div {
     边距顶部：30px；
}
.ie6 #some_div {
     边距顶部：40px；
}
.ie7 #some_div {
     边距顶部：50px；
}

```

希望这是有道理的。无论哪种方式，您都希望使用条件注释而不是 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T04:49:16.453

此方法仍然使用一些条件注释，但至少您没有通过 PHP 评估您的代码。为了获得更多帮助，我需要查看完整的代码示例。

```
<style type="text/css">
#Menu    {
    width: 100%;
    height: 32px;
    padding-top: 40px;
    padding-left: 13px;
}
</style>

<!--[if IE]>
<style type="text/css">
#Menu    {
    padding-top: 22px;
}
</style>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T05:09:14.033

如果没有演示页面，真的很难判断这里发生了什么，但是页面上的另一个元素是否会将其额外降低 18 像素？可能是元素上有一些默认边距吗？我想不出你给出的CSS还有什么问题。子元素在 IE 和其他浏览器中的大小可以不同吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T23:47:56.673

通常，当我看到开发人员在做这种事情时，那是因为他们不明白发生了什么。然后他们最终得到了 3 个基本相同的巨大 CSS 文件的单独副本；和很多头痛。

IE 条件注释朝着正确的方向迈出了安全的一步；特别是您的 php 示例中的浏览器嗅探注定要失败，因为不能保证用户代理字符串。

我最好的建议是花时间阅读非常无聊的 W3C CSS 文档，如果只有关于 DISPLAY BLOCK 和 INLINE 模式的章节。读完之后，你 90% 的 CSS 布局问题都将迎刃而解。剩下的就是习惯最常见的 IE6 错误，即无名的“布局”模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T21:47:00.170

```
#some_div {
     _margin-top:40px; //Only works on IE6
     *margin-top:30px; //Only works on IE7-IE6
      margin-top:20px\9; //Only works on IE8-IE7-IE6
      margin-top:10px; //Works on all others
} 
```

# java - Java 库？- 单纯形/线性规划/优化

> ID：531049
> 
> 赞同：5
> 
> 时间：2009-02-10T04:24:52.270
> 
> 标签：java, mathematical-optimization, linear-programming

我正在寻找一个优化库。我的两个要求是它不使用 JNI，并且它没有许可证限制阻止它在商业上用于多台计算机。我发现满足这些要求的唯一一个是 Choco，但它是无法使用的越野车。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-14T02:31:21.580

由于我在 Java 中找不到任何优化软件，我编写了自己的 Simplex Method 实现并将其提交给 Apache Commons Math 库：[https ://issues.apache.org/jira/browse/MATH-246](https://issues.apache.org/jira/browse/MATH-246)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-31T08:56:05.280

[http://ojalgo.org/generated/org/ojalgo/optimisation/linear/LinearSolver.html](http://ojalgo.org/generated/org/ojalgo/optimisation/linear/LinearSolver.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-22T20:05:35.307

SuanShu 有一套优化算法，基本的和高级的：

[Java 优化](http://www.numericalmethod.com/javadoc/suanshu/com/numericalmethod/suanshu/optimization/Minimizer.html)

[线性规划算法](http://www.numericalmethod.com/javadoc/suanshu/com/numericalmethod/suanshu/optimization/multivariate/constrained/convex/sdp/socp/qp/lp/simplex/solver/package-summary.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-02T22:25:19.547

最近[JOptimizer](http://www.joptimizer.com)是免费的纯 java，可用于线性规划和所有其他类型的凸数学优化。它使用简单，文档齐全，在线站点提供了很多示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-19T16:04:04.467

您是否需要任何好的、稳定的优化库，还是特别需要应用 Simplex 算法？

[Drools Planner](http://www.jboss.org/drools/drools-planner)是纯 Java（无 JNI）和 Apache 许可（适合您的商业需求），但它不使用 Simplex，而是使用元启发式（可扩展性良好并提供出色的结果）。

# c# - 处理时更新 ASP.NET 标签

> ID：531056
> 
> 赞同：0
> 
> 时间：2009-02-10T04:27:28.317
> 
> 标签：c#, asp.net, ajax

我有一个在单击按钮时运行的方法，带有 4 个标签。我需要做的是在每个代码块执行后更新一个标签。我已经尝试过线程、更新面板等，但似乎无法正常工作。我认为计时器会起作用，但它只会在你不在方法中时才会滴答作响。代码看起来像这样：

```
private void SomeMethod()
{
     label1.text = "Processing...";
     AnotherMethod();
     label1.text = "Done.";
     label2.text = "Processing...";
     AnotherAnotherMethod();
     label2.text = "Done.";

     //etc...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T04:42:57.170

您对 asp.net 的工作方式有误解。您的服务器代码响应来自浏览器的对*完整*html 页面的请求而运行。即使您真正想做的只是运行一些按钮单击代码，情况也是如此。无论如何，整个*页面*都必须从头开始重建，即使在回发时也是如此。这就是 Web 表单的设计方式。

一旦页面呈现给浏览器，页面类的实例就会被*销毁*。在下一次回发中，您将再次从头开始，会话、视图状态和应用程序缓存的明显例外。甚至浏览器中页面之前的 DOM 实例也会被替换。

因此，当您设置标签的 text 属性时，您不会直接在浏览器中直观地更新任何内容。您所做的只是更新页面类中的一些临时存储。作为执行服务器代码的最后阶段，所有这些临时变量都用于呈现完整的 html，并且最终将响应发送到浏览器并显示给用户。

这应该足以让您了解为什么您的代码没有按预期运行。*在您的任何*属性更改进入浏览器之前，它会运行该方法中的*所有*代码。因此，用户唯一看到的是操作的最终状态。

 *现在 ajax 可以使事情变得有点复杂。使用 ajax 控件时，您可能不再更新整个页面，但该概念仍然适用：发出一个请求，收到一个响应并用于更新请求的整个上下文。如果您有很多 javascript 来处理 ajax 请求的结果，您可能会进一步混淆事情。

不幸的是，您发布的代码没有快速修复。您需要考虑这实际上是如何工作的，并决定您希望您的页面如何流动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T04:38:45.013

您能否将这 3 个方法公开给客户端脚本，然后从客户端代码顺序调用它们，当方法 1 完成时，客户端脚本将更新 ui 然后调用方法 2，依此类推...

# java - Injector.getInstance(..) 为单例返回一个新实例

> ID：531061
> 
> 赞同：8
> 
> 时间：2009-02-10T04:30:23.910
> 
> 标签：java, dependency-injection, guice

我的模块：

```
bind( Translator.class ).to( TranslatorImpl.class ).in( Scopes.SINGLETON ); 
```

现在我希望每次都能得到相同的实例

```
Injector injector = ...;
injector.getInstance( Translator.class ); 
```

但如果我这样做

```
injector.getInstance( TranslatorImpl.class ); 
```

我每次都会得到一个新实例。这是错误还是预期行为？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-10T04:39:29.207

这是预期的行为，因为`TranslatorImpl.class`没有绑定到单例范围，只有`Translator.class`。

如果您希望两者都`getInstance(..)`返回相同的实例，则可以将实现绑定到单例范围：

```
bind(Translator.class).to(TranslatorImpl.class);
bind(TranslatorImpl.class).in(Scopes.SINGLETON);
assertEquals(injector.getInstance(Translator.class), injector.getInstance(TranslatorImpl.class)); 
```

有关更多详细信息，请参阅[https://github.com/google/guice/wiki/Scopes#applying-scopes](https://github.com/google/guice/wiki/Scopes#applying-scopes)。

# iphone - CoreAudio：为什么 ExtAudioFileCreateWithURL 返回 0xFFFFFFCE？

> ID：531066
> 
> 赞同：2
> 
> 时间：2009-02-10T04:34:24.820
> 
> 标签：iphone, macos, core-audio

它的意思是返回一个`OSType`，但我只是得到-50。有谁知道这代表什么错误？我在任何地方都找不到它。

上下文的代码片段（错误是如此模棱两可，我不知道要粘贴什么片段，这几乎是所有内容）：

```
ExtAudioFileRef cafFile;
AudioStreamBasicDescription cafDesc;

cafDesc.mBitsPerChannel = 16;
cafDesc.mBytesPerFrame = 4;
cafDesc.mBytesPerPacket = 4;
cafDesc.mChannelsPerFrame = 2;
cafDesc.mFormatFlags = 0;
cafDesc.mFormatID = 'ima4';
cafDesc.mFramesPerPacket = 1;
cafDesc.mReserved = 0;
cafDesc.mSampleRate = 44100;

OSType status = ExtAudioFileCreateWithURL(
                   fileURL,                    // inURL
                   'caff',                     // inFileType
                   &cafDesc,                   // inStreamDesc
                   NULL,                       // inChannelLayout
                   kAudioFileFlags_EraseFile,  // inFlags
                   &cafFile                    // outExtAudioFile
                   );    // returns 0xFFFFFFCE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T04:48:23.820

[`ExtAudioFileCreateWithURL()`](http://developer.apple.com/iphone/library/documentation/MusicAudio/Reference/ExtendedAudioFileServicesReference/Reference/reference.html#//apple_ref/c/func/ExtAudioFileCreateWithURL)返回一个`OSStatus`，而不是一个`OSType`。请参阅文件`MacErrors.h`以了解各种错误代码。在这种情况下，-50 是`paramErr`（用户参数列表中的错误），因此您将一个或多个参数错误地传递给函数。

# asp.net - Ajax 控制工具包 Rating Control- Override RatingBehavior.js

> ID：531072
> 
> 赞同：2
> 
> 时间：2009-02-10T04:39:14.467
> 
> 标签：asp.net, javascript, ajax

如果用户单击当前评级星，Ajax 控制工具包中的评级控制不会引发事件，因为在行为 js 中它已检查 `if (this._ratingValue != this._currentRating)`，所以我想在不更改 js 和构建工具包的情况下覆盖此方法。我该怎么做，我可以扩展评级控制和覆盖`RatingBehavior.js`或任何其他解决方案。

```
_onStarClick : function(e) {
    /// <summary>
    /// Handler for a star's click event
    /// </summary>
    /// <param name="e" type="Sys.UI.DomEvent">
    /// Event info
    /// </param>
    if (this._readOnly) {
        return;
    }
    if (this._ratingValue != this._currentRating) {
        this.set_Rating(this._currentRating);
    }
}, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T05:36:48.367

我已经通过将代码放在上面来解决它

```
 function AddNewRatingHandler() {

        AjaxControlToolkit.RatingBehavior.prototype._onStarClick =
            function(e) {
                if (this._readOnly) {
                    return;
                }
                //   if (this._ratingValue != this._currentRating) {                    
                this.set_Rating(this._currentRating);
                // }
            };
            AjaxControlToolkit.RatingBehavior.prototype.set_Rating = function(value) {                    
                //   if (this._ratingValue != value) {
                this._ratingValue = value;
                this._currentRating = value;
                if (this.get_isInitialized()) {
                    if ((value < 0) || (value > this._maxRatingValue)) {
                        return;
                    }

                    this._update();

                    AjaxControlToolkit.RatingBehavior.callBaseMethod(this, 'set_ClientState', [this._ratingValue]);
                    this.raisePropertyChanged('Rating');
                    this.raiseRated(this._currentRating);
                    this._waitingMode(true);

                    var args = this._currentRating + ";" + this._tag;
                    var id = this._callbackID;

                    if (this._autoPostBack) {
                        __doPostBack(id, args);
                    }
                    else {
                        WebForm_DoCallback(id, args, this._receiveServerData, this, this._onError, true)
                    }

                }
                //  }
            };                
    }
    AddNewRatingHandler();

</script>

</div>

</form> 
```

# .net - WIA.DeviceManager.DeviceInfos.Count = 0。为什么？

> ID：531076
> 
> 赞同：2
> 
> 时间：2009-02-10T04:42:46.423
> 
> 标签：.net, windows-xp, wia, image-scanner

我正在尝试识别连接到计算机的扫描仪。一种可能的解决方案是使用 WIA（Windows 图像采集自动化库）。

到目前为止，这些是我的行动：

*   下载 wiaaut.dll
*   复制到system32
*   使用“regsvr32 wiaaut.dll”注册它（成功）
*   在 Visual Studio.NET 中添加对我的项目的引用
*   检查 Windows 图像采集 (WIA) 服务是否正在运行

接下来，我添加并调试以下代码：

```
WIA.DeviceManager manager = new WIA.DeviceManagerClass();
string deviceName = "";
foreach (WIA.DeviceInfo info in manager.DeviceInfos)
{
    if (info.Type == WIA.WiaDeviceType.ScannerDeviceType)
    {
        foreach (WIA.Property p in info.Properties)
        {
            if (p.Name == "Name")
                {
                    deviceName = ((WIA.IProperty)p).get_Value().ToString();
                    Console.WriteLine(deviceName);
                }
        }
    }
} 
```

但是，manager.DeviceInfos 始终为空。我连接了 2 台扫描仪，其中一台显示在控制面板-> 扫描仪和相机中，一台没有，并且都显示在设备管理器的“成像设备”下。

关于为什么没有出现在 WIA.DeviceManager.DeviceInfos 中的任何建议？

在 Windows XP Service Pack 2 上运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T04:19:27.080

```
 foreach (WIA.Property p in info.Properties)
     {
         if (p.Name == "Name") <-- p is a property why cast like you doing above.
         {
             deviceName = ((WIA.IProperty)p).get_Value().ToString();
             Console.WriteLine(deviceName);
         }
     } 
```

试试这个：

```
deviceName = p.get_Value(); 
```

这将在 Visual Studio 上显示为错误，但当您按 f5 时将编译。并将运行..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-18T09:47:17.923

试试这个类：

```
using System;
using System.Collections.Generic;
using System.Text;
using WIA;
using WIAVIDEOLib;
namespace Scanner
{
public class ImageAcquisition
{

    private WIALib.WiaClass WiaClass;
    private WIALib.ItemClass ItemClass;
    private WIALib.CollectionClass CollectionClassDevices;
    private WIALib.CollectionClass CollectionClassPics;

    #region SelectDevice
    public bool SelectDevice()
    {
        try
        {
            object selectUsingUI;

            WiaClass = new WIALib.WiaClass();
            CollectionClassDevices = (WIALib.CollectionClass)WiaClass.Devices;

            if (WiaClass.Devices.Count == 0)
                return false;

            selectUsingUI = System.Reflection.Missing.Value;

            ItemClass = (WIALib.ItemClass)WiaClass.Create(ref selectUsingUI);

            if (ItemClass == null)
                return false;

            return true;
        }
        catch (System.Exception exp)
        {
            return false;
        }
    }
    #endregion

    #region Capture
    public System.Drawing.Image Capture()
    {
        try
        {
            CollectionClassPics = ItemClass.GetItemsFromUI(WIALib.WiaFlag.SingleImage, WIALib.WiaIntent.ImageTypeColor) as WIALib.CollectionClass;
            if (CollectionClassPics == null)
                return null;

            ItemClass = (WIALib.ItemClass)System.Runtime.InteropServices.Marshal.CreateWrapperOfType(CollectionClassPics[0], typeof(WIALib.ItemClass));
            string imageFileName = System.IO.Path.GetTempFileName();
            ItemClass.Transfer(imageFileName, false);
            System.Drawing.Image Image = System.Drawing.Image.FromFile(imageFileName);

            System.Runtime.InteropServices.Marshal.ReleaseComObject(CollectionClassPics[0]);
            return Image;
        }
        catch (System.Exception exp)
        {
            return null;
        }
    }
    #endregion
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-23T14:42:29.327

我在java中使用这个，所以我的提示可能不正确，但我只将你提到的方式用于windows vista及更高版本......所以看起来你正在使用wia 2.0但对于windows ME和XP你应该使用wia 1.0

在[MSDN](http://msdn.microsoft.com/en-us/library/ms630368%28VS.85%29.aspx)它被描述..
也许它会有所帮助

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-08-30T03:59:56.170

尝试更改行：

```
foreach (WIA.DeviceInfo info in manager.DeviceInfos) 
```

并替换为：

```
foreach (manager.DeviceInfo info in manager.DeviceInfos) 
```

我希望我对你有所帮助。

# assembly - MASM32 循环

> ID：531085
> 
> 赞同：1
> 
> 时间：2009-02-10T04:48:07.517
> 
> 标签：assembly, crash, masm

我试图在 Windows Vista 下运行的 masm32 中创建一个循环，但是我这样做了，即使它实际上完成了循环，它也会崩溃，我看不出有什么明显的原因......任何想法？

```
.386
.model flat, stdcall
option casemap :none

include \masm32\include\windows.inc
include \masm32\include\kernel32.inc
include \masm32\include\masm32.inc
includelib \masm32\lib\kernel32.lib
includelib \masm32\lib\masm32.lib

.data
ProgramText db "Looping!", 0

.data?
loop_stopper   dd      ?

.code
start:

mov loop_stopper,2

loop_start:
invoke StdOut, addr ProgramText
cmp loop_stopper, 0
dec loop_stopper                 
jg loop_start

end start 
```

* * *

**编辑**

做过

```
invoke StdOut, offset ProgramText 
```

还是崩溃...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T05:01:22.963

您需要有一个“退出”来结束您的应用程序。此外，我的个人风格是将所有内容都放在子程序中，但这只是我。

就像是：
`.code`

 `start:

```
call main
inkey        
exit 
```

main proc

```
mov loop_stopper,2
loop_start:

invoke StdOut, addr ProgramText
cmp loop_stopper, 0 
dec loop_stopper
jg loop_start
ret 
```

main endp` 

`end start`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T06:23:40.283

在我看来，您的指示顺序是错误的。您进行比较，然后递减，然后进行条件跳转。比较中的标志值可能会因减量而改变。

```
 loop_start:

  invoke StdOut, addr ProgramText
  cmp loop_stopper, 0 
  dec loop_stopper
  jg loop_start

  ret 
```

当我在做汇编编程时，我是这样做的：递减计数器，如果非零则循环。

```
 loop_start:

  invoke StdOut, addr ProgramText

  dec loop_stopper
  jnz loop_start

  ret 
```

当然，根据处理器的不同，您可以将循环变量放在一个寄存器中，这样您就可以使用一条指令进行递减和循环。（例如，Z80 'djnz' 指令。我不记得它实际上是哪个寄存器，尽管'B' 寄存器似乎敲响了钟声）。

此外，正如其他一些人所建议的那样，您似乎没有清理您的内存空间。大多数程序实际上是对您的代码的“调用”。因此，您需要保留代码和堆栈指针，以便您可以优雅地“返回”到操作系统的调用部分。如果您还没有这样做，您的“返回”可以将您带到堆栈顶部恰好指向的任何地方，通常会带来灾难性的后果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T04:56:50.773

ClubPetey 是对的。MASM 不会为您的代码生成结语。因此，处理器继续执行它在最后一条写入指令后面找到的内容。exit 明确要求操作系统停止执行程序。

# java - 有哪些使用 Spring 和 Hibernate 的优秀示例应用程序？

> ID：531096
> 
> 赞同：12
> 
> 时间：2009-02-10T04:53:57.910
> 
> 标签：java, hibernate, spring, spring-security

我需要快速开始使用 Spring 和 Hibernate，并且我正在寻找一些示例代码来修改和扩展。Struts2 和 Spring Security 集成的奖励积分。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T05:02:06.797

[官方文档是Spring](http://static.springframework.org/spring/docs/2.5.x/reference/index.html)和[Hibernate](http://www.hibernate.org/docs)的最佳选择。但是，您可以查看[When Spring Meets Hibernate](http://www.ibm.com/developerworks/web/library/wa-spring2/)和[Spring and Hibernate with MyEclipse](http://www.myeclipseide.com/documentation/quickstarts/hibernateandspring/)教程来帮助您入门。

最好的选择是，如果您正在使用 Netbeans 或使用它没有问题，只需启动一个全新的应用程序并按照[Web 应用程序向导并分别指定 Spring 和 Hibernate](http://www.netbeans.org/kb/trails/web.html)作为应用程序框架和 ORM。它将生成一个完整的骨架供您使用。您甚至可以稍后在 project->properties->framework 中将 Struts2 添加为 Web 框架。

对于后者，您可能想查看[Struts2 Spring Plugin 。](http://struts.apache.org/2.x/docs/spring-plugin.html)此外，[Spring 安全集成](http://www.acegisecurity.org/guide/springsecurity.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-11T06:16:14.047

看看[AppFuse](http://appfuse.org/display/APF/Home)

它有很多入门网络应用程序材料。您还可以使用 Struts2-Spring-Hibernate。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-11T04:08:51.667

Struts2 网站上提供了一个包含 Spring、Hibernate 和 Struts2的[示例项目](http://struts.apache.org/2.0.14/docs/struts-2-spring-2-jpa-ajax.html)，它似乎包含了我想要的大部分内容。它包括一个基本的 JPA 配置，但不提供 DAO 类。

通用 DAO 模式记录在 Hibernate 站点[此处](http://www.hibernate.org/328.html)。这提供了良好的 DAO 基础，但代码直接使用 Hibernate，没有 JPA 或 Spring。

以下[帖子](http://icoloma.blogspot.com/2006/11/jpa-and-spring-fucking-cooltm_26.html)（**警告：**语言）提供了一些有关将 Spring 与 JPA 结合使用而不是 HibernateTemplate 类的信息。

把这些信息放在一起，我就可以顺利完成我的骨架项目。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-12-01T19:05:33.873

SpringSource 本身在此处提供了大量优秀的示例应用程序：

[https://src.springframework.org/svn/spring-samples/](https://src.springframework.org/svn/spring-samples/)

最好的开始可能是：

[http://static.springsource.org/docs/petclinic.html](http://static.springsource.org/docs/petclinic.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-05T20:02:02.973

Spring Roo 使用 JPA 2 创建了 Spring - Hibernate 骨架。您可以继续使用 Roo，也可以将其关闭，而无需进行太多手动操作。它下载最新的 Hibernate 和 Spring 版本，您可以确定它们会一起工作。

Spring Roo 使用“提示”命令为您提供建议，您可以很快开始。您可以按照[http://static.springsource.org/spring-roo/reference/html/beginning.html](http://static.springsource.org/spring-roo/reference/html/beginning.html)上的教程进行操作，前两个步骤就足够了。

但是 Roo 不会帮助 Struts，而是提供 JSF。

# c# - 如何在 SQL Server 2008 上运行定期进程

> ID：531104
> 
> 赞同：3
> 
> 时间：2009-02-10T04:59:28.303
> 
> 标签：c#, asp.net, sql, sql-server-2008

我构建了一个非常简单的类似聊天室的 ASP.NET 应用程序，它显示当前的在线/离线用户：

我有一个带有用作时间戳的 DateTime 列的表。每次用户引发 Postback 或类似的 Get 事件时，我都会更新 TimeStamp。我想在服务器上创建一个定期进程，我可以使用它来检查用户处于非活动状态的时间，因为我知道他们最后一次处于活动状态。一旦它们被认为是不活动的（可以说几分钟后），我想设置另一列的值以将它们标记为“离线”。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T05:01:38.593

您可以创建一个定期运行的 Sql Server 代理作业。

[http://msdn.microsoft.com/en-us/library/ms187910.aspx](http://msdn.microsoft.com/en-us/library/ms187910.aspx)

[http://msdn.microsoft.com/en-us/library/ms186273.aspx](http://msdn.microsoft.com/en-us/library/ms186273.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T05:40:55.723

虽然上面给出的使用 SQL Server 代理的答案是一个非常好的解决方案，但您是否考虑过在服务器上拥有一个组件（可能是 WCF 组件）来执行所有状态管理，而不是直接管理数据库中的状态？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T08:53:06.803

我们通过向 Asp.Net 应用程序添加一个简单的 web 服务来做类似的事情，并以可配置的时间间隔从运行在同一 web 服务器上的 windows 服务调用它。这允许我们使用我们的业务逻辑，同时将其全部保存在一个地方 - Web 应用程序。

# sqlite - 如何使用VB6在SQLite中返回AUTO INCREMENT列的值

> ID：531109
> 
> 赞同：13
> 
> 时间：2009-02-10T05:03:37.090
> 
> 标签：sqlite, vb6, auto-increment

我在 SQLite 中有一个表：

```
CREATE TABLE "EventType" 
(
[EventTypeID] INTEGER PRIMARY KEY, 
[EventTypeName] VARCHAR(50) NOT NULL UNIQUE
); 
```

由于 EventTypeID 是一个整数和一个主键，它会自动使其成为一个自动递增的列，并且工作正常。

我想在表中插入一行并从 VB6 中获取新增加的值。

```
Dim oRs as Recordset
dim oCmd as new Command

oCmd.ActiveConnection = GetConnection()
oCmd.Source = "insert into EventType (EventTypeName) values ('blah')"
oCmd.Execute 
```

是否有一种自动方法来检索新创建的 EventTypeID 而无需发出另一个查询（从 EventType 中选择 max(EventTypeID)）？

我似乎记得很久以前的VB6，有一种方法可以做到这一点。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-10T05:15:56.717

[SQLite 是否支持 SCOPE_IDENTITY？](https://stackoverflow.com/questions/304543/does-sqlite-support-scopeidentity)

> 查看[常见问题解答](http://www.sqlite.org/faq.html#q1)。[sqlite3_last_insert_rowid()](http://www.sqlite.org/c3ref/last_insert_rowid.html) 函数会做到这一点。 不过要小心触发器

未经测试，但您应该能够在一次调用中发送两个语句。自从我编写任何 VB6 以来已经有一段时间了。这也不是 SQL 注入安全的。

```
Dim oRs as Recordset
dim sSql as String
sSql = "INSERT INTO EventType (EventTypeName) VALUES ('blah'); SELECT last_insert_rowid() FROM EventType"
oRs.Open sSql oConn 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-11-19T04:24:04.537

在您的代码中运行此查询：

```
SELECT SEQ from sqlite_sequence WHERE name='tablename' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T05:20:22.993

我不使用VB，所以我不知道您在数据库中使用的接口，但是，正如bendewey 所说，c API 中有一个函数`sqlite3_last_insert_rowid()`将返回最后插入的行的主整数键，因此您可以在界面中寻找类似的功能。

如果这不起作用，您可以使用特定于 SQLite 的查询：

```
SELECT last_insert_rowid() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T05:21:09.467

您可以`SELECT last_insert_rowid()`在插入后致电

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-03-20T08:15:00.277

如果使用

```
SELECT last_insert_rowid() 
```

返回最后一个`rowid`，您可以使用：

```
SELECT last_insert_rowid() AS rowid FROM table_name LIMIT 1 
```

获取`rowid`单个表的最后一个

# image-manipulation - 图像处理问题 - 将 Standard-Def 转换为 Hi-Def，我必须丢失图像数据吗？

> ID：531111
> 
> 赞同：0
> 
> 时间：2009-02-10T05:05:29.160
> 
> 标签：image-manipulation

我正在编写一个小程序来将标准清晰度 4:3 视频转换为高清视频 16:9，并且我正在经历严重的拉伸效果，正如我所想的那样（尽管直到我代码开始工作）。无论如何，我能想到绕过这种拉伸效果并仍然填充整个 16:9 屏幕的唯一方法是切断图像的顶部和底部。

1）所以我的问题是，当从标清转换为高清时，我是否必须丢失图像的图像部分才能填满整个屏幕而没有任何拉伸效果？

2) 从 HD 转换为 SD 的问题相同。

我是新的图像处理，有没有流行的方法来减少这些操作中的拉伸？有没有比仅仅切断图像的一部分或在图像中引入黑条更聪明的方法来解决这个问题？

提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T05:13:46.847

除了明显的裁剪、信箱和邮筒方法（会丢失图像数据或需要可能不希望出现的黑条）之外，还有自适应图像调整大小。基本上，这些技术的目的是能够创建具有任意纵横比的图像版本，而不会丢失图像的基本特征或扭曲图像。一种技术称为缝雕，可以在[这里](http://www.youtube.com/watch?v=6NcIJXTlugc)看到。

如果您想在自己的一些图像上测试该技术，该功能包含在[ImageMagick](http://www.imagemagick.org)的最新版本中，如此[处](http://imagemagick.org/Usage/resize/#liquid-rescale)所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-22T23:24:39.343

在调整图像或视频大小时，质量下降或内容丢失始终是一个问题。通常，您在一个方向上缩放图像，然后修剪或填充另一个方向。

在电视上，通常将 16:9 帧的左侧和骑行侧切掉以放置在 4:3 屏幕上，并添加黑色边条以从 4:3 变为 16:9。电视剪辑师不会剪掉 4:3 帧的顶部和底部以适应 16:9，因为那里几乎总是存在场景的重要部分。16:9 帧的最左边和最右边通常没有重要元素，尽管在某些电影场景中丢失边会产生巨大的差异。

# string - Xcode 调试器：显示长字符串

> ID：531114
> 
> 赞同：32
> 
> 时间：2009-02-10T05:07:31.450
> 
> 标签：string, xcode, macos, debugging

在 Xcode 中调试程序时，我有几个`CFStringRef`变量指向长度在 200 个字符标记左右的字符串。

在调试器中，它仅将这些字符串的值显示到一定长度，然后将它们省略掉。我真的很想看到字符串的全部价值。

有没有我可以配置的选项，所以它不会以任意长度终止它们？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-10T05:17:02.533

在调试控制台中，您可以通过执行以下操作来获取字符串值：

```
(gdb) print (void)CFShow(myCFString) 
```

或者：

```
(gdb) po (NSString*)myCFString 
```

其中任何一个都会将整个字符串的内容显示到调试控制台。这可能是处理大型、可变长度字符串或任何类型的数据结构的最简单方法。

有关更多信息，`print`调试器中的命令基本上将一些数据结构转储到控制台。您也可以调用任何函数或其他任何东西，但由于 print 无法访问函数声明，因此您必须确保隐式提供它们（如上例所示），否则 print 命令会报错。

`po`除了 Objective-C 对象之外，它是 print的快捷方式`print-object`并且与 print 相同。它的功能基本上是这样的：

```
(gdb) print (const char *)[[theObject debugDescription] UTF8String] 
```

这对于检查`NSData`对象和`NSArray`/`NSDictionary`对象之类的东西非常有用。

有关调试主题的更多信息，请参阅[技术说明 TN2124 - Mac OS X Debugging Magic](http://developer.apple.com/technotes/tn2004/tn2124.html)，并且（从调试器控制台）您也可以发出`help`命令。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-05-04T17:04:13.823

[在 xcode 6 调试控制台中](https://stackoverflow.com/questions/31402092/print-long-string-in-xcode-6-debugging-console)从 print long string 显示真正的长字符串使用方法

1.  在 lldb 控制台中增加*max-string-summary-length*

```
setting set target.max-string-summary-length 10000 
```

2.  `print`用or`po`命令打印你的字符串

```
print my_string 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-18T04:49:19.250

如果您在 xcode 中编译 c++ 项目，只需使用此命令

po 字符串名称

# java - 如何从窗口服务注册表运行 jar 应用程序？

> ID：531116
> 
> 赞同：1
> 
> 时间：2009-02-10T05:07:50.433
> 
> 标签：java

**DUPE：[如何从 Java 应用程序创建 Windows 服务](https://stackoverflow.com/questions/68113/how-to-create-a-windows-service-from-java-app)**

我开发了一个 Java jar 应用程序，它处理输入文件并转换为 csv 文件。现在我的要求是从 Windows 服务运行该 jar 应用程序。我不知道该怎么做。

如何将 Java 应用程序变成 Windows 服务？

# c++ - 需要 IPv6 流量生成器

> ID：531122
> 
> 赞同：1
> 
> 时间：2009-02-10T05:11:05.200
> 
> 标签：c++, networking, ipv6

我正在寻找生成 IPv6 流量的工具。它应该允许我手动提供其所有标题值。

如果有源代码就太好了。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T12:39:56.177

我相信[mgen](http://cs.itd.nrl.navy.mil/work/mgen/index.php)和[iperf](http://sourceforge.net/projects/iperf/)都支持 IPv6。两者都是开源的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-15T01:35:28.410

正如 bortzmeyer 在对另一个答案的评论中指出的那样，您想要手动控制所有标题值的工具是 Scapy。在这里获取：http: [//hg.secdev.org/scapy/](http://hg.secdev.org/scapy/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T12:05:04.963

卷曲应该做你想做的事。你可以在这里得到它：http: [//curl.haxx.se/](http://curl.haxx.se/)

它是开源的，因此代码可供您检查，并且支持 IPv6

curl --header "Content-Type: text/xml" ... --ipv6 [http://www.example.com/](http://www.example.com/)应该完全符合 OP 的要求。

curl -h 给出命令行选项的完整列表

# java - 如何在嵌套集合中添加内部映射？

> ID：531126
> 
> 赞同：1
> 
> 时间：2009-02-10T05:15:41.150
> 
> 标签：java, collections, map, nested

鉴于：

```
Object nestKey;
Object nestedKey;
Object nestedValue;

Map<T,Map<T,T>> nest;
Map<T,T> nested; 
```

如何将映射添加到嵌套 where：

> nest.containsKey(nestKey) == true;

?

或者是否有一个更有效的现有馆藏库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T05:32:44.557

这是一个相当普遍的习语：

*   按照你的建议有一张地图
*   有一个映射，其中您的键组合了“主”键和“子键”（可能更有效地利用空间，但如果您需要*迭代*键和子键，通常不太适合）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T05:58:47.583

您的意思是类似于以下*通用方法*？

```
static <U,V,W> W putNestedEntry(
        Map<U,Map<V,W>> nest,
        U nestKey,
        V nestedKey,
        W nestedValue)
{
    Map<V,W> nested = nest.get(nestKey);

    if (nested == null)
    {
        nested = new HashMap<V,W>();
        nest.put(nestKey, nested);
    }

    return nested.put(nestedKey, nestedValue);        
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T05:31:27.850

不明白你的意思。我认为您想添加到嵌套地图中，如下所示：

```
nest.get(nestKey).put(nestedKey, nestedValue); 
```

这是不可能的，因为外部地图上的 get 返回类型为 的地图`Map<?, ?>`。您不能对其调用 put 方法。无界通配符 '?' 如果您不知道集合内容的类型但想将它们视为对象，则应使用。如果你想读取和修改内容，并且 Map 有异构对象，你可以使用 raw 类型。那是这样的：

```
Map<?, Map> nest; 
```

最好的方法当然是（如果可能的话），使用同质 Map 并指定其类型。例如。`Map<String, String>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T05:33:27.223

试试这个

if (nest.containsKey(nestKey)) { ((Map) nest.get(nestKey)).put(nestedKey, nestedValue); }

# c++ - 我应该将许多功能放在一个文件中吗？或者，或多或少，每个文件一个函数？

> ID：531133
> 
> 赞同：11
> 
> 时间：2009-02-10T05:20:08.533
> 
> 标签：c++, build-process, compilation, code-organization, file-organization

我喜欢组织我的代码，所以理想情况下我希望每个文件一个类，或者当我有非成员函数时，每个文件一个函数。

原因是：

1.  当我阅读代码时，我总是知道应该在哪个文件中找到某个函数或类。

2.  如果每个头文件是一个类或一个非成员函数，那么我 `include`在头文件时不会包含一团糟。

3.  如果我对一个函数做一个小的改动，那么只有那个函数需要重新编译。

但是，将所有内容拆分为许多头文件和许多实现文件会大大减慢编译速度。在我的项目中，大多数函数访问一定数量的模板化其他库函数。这样代码将被一遍又一遍地编译，每个实现文件一次。目前在一台机器上编译我的整个项目需要 45 分钟左右。大约有 50 个目标文件，每个目标文件都使用相同的昂贵编译头文件。

*也许，每个头*文件有一个类（或非成员函数）是否可以接受，但是将许多或所有这些函数的实现放入*一个*实现文件中，如下例所示？

```
// foo.h
void foo(int n);

// bar.h
void bar(double d);

// foobar.cpp
#include <vector>
void foo(int n) { std::vector<int> v; ... }
void bar(double d) { std::vector<int> w; ... } 
```

同样，优点是我可以仅包含 foo 函数或仅包含 bar 函数，并且整个项目的编译会更快，因为`foobar.cpp`是*一个*文件，所以`std::vector<int>`（这只是其他一些昂贵的示例compile 模板化构造）必须只编译一次，而不是如果我单独编译 a`foo.cpp`和两次`bar.cpp`。当然，我上面的理由 (3) 不适用于这种情况：在更改 foo(){...} 之后，我必须重新编译整个可能很大的 file `foobar.cpp`。

我很好奇你的意见是什么！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T05:25:06.570

恕我直言，您应该将项目组合成逻辑分组并基于此创建文件。

当我编写函数时，通常有六个左右紧密相关的函数。我倾向于将它们放在一个头文件和实现文件中。

当我编写类时，我通常将自己限制为每个头文件和实现文件一个重量级类。我可能会添加一些便利功能或小型辅助类。

如果我发现一个实现文件长达数千行，这通常表明那里有太多内容，我需要将其分解。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T05:34:16.300

在我看来，每个文件的一个功能可能会变得混乱。想象一下，如果 POSIX 和 ANSI C 标头以相同的方式制作。

```
#include <strlen.h>
#include <strcpy.h>
#include <strncpy.h>
#include <strchr.h>
#include <strstr.h>
#include <malloc.h>
#include <calloc.h>
#include <free.h>
#include <printf.h>
#include <fprintf.h>
#include <vpritnf.h>
#include <snprintf.h> 
```

不过，每个文件一个类是个好主意。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T10:50:05.660

我们使用每个文件一个外部函数的原则。但是，在这个文件中，可能有几个其他“帮助”函数位于未命名的命名空间中，用于实现该函数。

根据我们的经验，与其他一些评论相反，这有两个主要好处。首先是构建时间更快，因为模块只需要在修改其特定 API 时重新构建。第二个优点是通过使用通用命名方案，无需花时间搜索包含您希望调用的函数的标头：

```
// getShapeColor.h
Color getShapeColor(Shape);

// getTextColor.h
Color getTextColor(Text); 
```

我不同意标准库是每个文件不使用一个（外部）函数的一个很好的例子。标准库永远不会改变并且具有明确定义的接口，因此上述两点均不适用于它们。

话虽如此，即使在标准库的情况下，拆分单个函数也有一些潜在的好处。首先是编译器可以在使用**不安全**版本的函数时生成有用的警告，例如*strcpy*与*strncpy*，其方式类似于 g++ 用于警告包含 <iostream.h> 与 <iostream> 的方式。

另一个优点是，当我想使用*memmove*时，我不会再因为包含*内存*而陷入困境！

 ** * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-22T15:37:33.950

如果您正在制作一个静态库，则每个文件一个函数具有技术优势（我想这是像[Musl-libc](http://musl-libc.org)项目这样的项目遵循这种模式的原因之一）。

静态库与目标文件粒度链接，因此如果您有一个`libfoobar.a`由以下组成的静态库：

```
 foo.o
     foo1
     foo2
 bar.o
     bar 
```

然后，如果您链​​接该`bar`函数的库，则`bar.o`存档成员将被链接，但不是该`foo.o`成员。如果您为 链接`foo1`，则该`foo.o`成员将被链接，从而带来可能不必要的`foo2`功能。

可能还有其他方法可以防止在 (`-ffunction-sections -fdata-sections`和`--gc-sections`) 中链接不需要的函数，但每个文件一个函数可能是最可靠的。

还有将少量相关函数/数据对象放在文件中的中间立场。这样，与 -ffunction-sections/-fdata-sections 相比，编译器可以更好地优化符号间引用，并且您仍然可以获得静态库的至少一些粒度。

* * *

*   为了简单起见，我在这里忽略了 C++ 名称修改

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T05:34:37.813

您可以将您的一些函数重新声明为一个或多个类的**静态方法**：这为您提供了一个机会（也是一个很好的借口）将其中的几个分组到一个源文件中。

如果该源文件与目标文件是一对一的，并且链接器链接整个目标文件，则在一个源文件中具有或不具有多个函数的一个很好的理由是：如果可执行文件可能需要一个函数而不需要另一个函数，则将它们在单独的源文件中（以便链接器可以链接一个而不链接另一个）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T05:36:08.527

我还尝试在每个文件的函数中拆分文件，但它有一些缺点。有时函数往往会变得比它们需要的大（你不想每次都添加一个新的 .c 文件），除非你勤奋地重构你的代码（我不是）。

目前，我将一到三个函数放在一个 .c 文件中，并将所有 .c 文件分组为一个目录中的一个功能。对于我拥有的头文件`Funcionality.h`，`Subfunctionality.h`这样我可以在需要时一次包含所有功能，或者如果不需要整个包，则可以只包含一个小实用程序功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T05:48:24.270

我的一位老编程教授建议每隔几百行代码就分解模块以提高可维护性。我不再使用 C++ 开发，但在 C# 中，我将自己限制为每个文件一个类，只要没有与我的对象无关的文件大小，文件的大小就无关紧要。您可以使用#pragma 区域来优雅地减少编辑器空间，不确定C++ 编译器是否有它们，但如果有，那么肯定会使用它们。

如果我仍在使用 C++ 编程，我会使用每个文件的多个函数按用途对函数进行分组。所以我可能有一个名为“Service.cpp”的文件，其中包含一些定义该“服务”的函数。每个文件拥有一个函数反过来会导致遗憾地以某种方式重新回到您的项目中。

不过，有时并不需要每个文件包含数千行代码。函数本身最多不应该超过几百行代码。永远记住，一个函数应该只做一件事并保持最小。如果一个函数做不止一件事，它应该被重构为辅助方法。

拥有多个定义单个实体的源文件也没有什么坏处。即：'ServiceConnection.cpp''ServiceSettings.cpp'，等等。

有时，如果我创建一个对象，并且它拥有其他对象，我会将多个类组合到一个文件中。例如，包含“ButtonLink”对象的按钮控件，我可能会将其组合到 Button 类中。有时我不这样做，但这是“当下的偏好”决定。

做最适合你的事情。在较小的项目上尝试不同的风格会有所帮助。希望这对您有所帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T07:14:38.803

对于*标题*部分，您应该将项目组合成逻辑分组并基于此创建您的*头文件。*恕我直言，这似乎并且非常合乎逻辑。

对于*源代码*部分，您应该将每个函数实现放在一个单独的*源*文件中（在这种情况下静态函数是例外）。起初这似乎不合逻辑，但请记住，编译器知道函数，但链接器只知道 .o 和 .obj 文件及其导出的符号。这可能会显着改变输出文件的大小，这对于嵌入式系统来说是一个非常重要的问题。

签出 glibc 或 Visual C++ CRT 源代码树...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T08:17:55.797

我可以看到您的方法有一些优点，但也有几个缺点：

1.  包括一个包裹是一场噩梦。您最终可以使用 10-20 个包含来获得所需的功能。例如，想象一下如果 STDIO 或 StdLib 是以这种方式实现的。

2.  浏览代码会有点痛苦，因为通常滚动文件比切换文件更容易。显然，太大的文件很难，但即使使用现代 IDE，也很容易将文件折叠到您需要的内容，并且其中很多都有功能快捷方式列表。

3.  使文件维护是一种痛苦。

4.  我是小功能和重构的忠实粉丝。当您增加开销时（创建一个新文件，将其添加到源代码管理，...），它鼓励人们编写更长的函数，而不是将一个函数分成三个部分，您只需制作一个大的。

# c# - 如何在 C# 中删除注册表值

> ID：531151
> 
> 赞同：49
> 
> 时间：2009-02-10T05:32:41.467
> 
> 标签：c#, registry

我可以使用 Microsoft.Win32.Registry 类获取/设置注册表值。例如，

```
Microsoft.Win32.Registry.SetValue(
    @"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run",
    "MyApp", 
    Application.ExecutablePath); 
```

但我不能删除任何值。如何删除注册表值？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-02-10T07:17:15.913

要删除问题中设置的值：

```
string keyName = @"Software\Microsoft\Windows\CurrentVersion\Run";
using (RegistryKey key = Registry.CurrentUser.OpenSubKey(keyName, true))
{
    if (key == null)
    {
        // Key doesn't exist. Do whatever you want to handle
        // this case
    }
    else
    {
        key.DeleteValue("MyApp");
    }
} 
```

查看文档[`Registry.CurrentUser`](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry.currentuser.aspx)，[`RegistryKey.OpenSubKey`](http://msdn.microsoft.com/en-us/library/xthy8s8d.aspx)了解[`RegistryKey.DeleteValue`](http://msdn.microsoft.com/en-us/library/dk8b3th2.aspx)更多信息。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-07-02T13:34:38.167

要删除树中的所有子键/值（〜递归），这是我使用的扩展方法：

```
public static void DeleteSubKeyTree(this RegistryKey key, string subkey, 
    bool throwOnMissingSubKey)
{
    if (!throwOnMissingSubKey && key.OpenSubKey(subkey) == null) { return; }
    key.DeleteSubKeyTree(subkey);
} 
```

用法：

```
string keyName = @"Software\Microsoft\Windows\CurrentVersion\Run";
using (RegistryKey key = Registry.CurrentUser.OpenSubKey(keyName, true))
{
   key.DeleteSubKeyTree("MyApp",false);   
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-10T07:30:02.120

```
RegistryKey registrykeyHKLM = Registry.LocalMachine;
string keyPath = @"Software\Microsoft\Windows\CurrentVersion\Run\MyApp";

registrykeyHKLM.DeleteValue(keyPath);
registrykeyHKLM.Close(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T05:38:18.457

[`RegistryKey.DeleteValue`](http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.deletevalue.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-29T12:18:35.883

```
 string explorerKeyPath = @"Software\TestKey";
 using (RegistryKey explorerKey = Registry.CurrentUser.OpenSubKey(explorerKeyPath, writable: true))
 {
     if (explorerKey != null)
     {
         explorerKey.DeleteSubKeyTree("TestSubKey");
     }
 } 
```

# python - 在 Python 2.5 中用微秒解析日期时间字符串

> ID：531157
> 
> 赞同：14
> 
> 时间：2009-02-10T05:35:08.997
> 
> 标签：python, datetime, parsing, python-2.5

我有一个文本文件，其中包含许多 isoformat 的日期时间字符串。字符串与此类似：

```
'2009-02-10 16:06:52.598800' 
```

这些字符串是使用生成的`str(datetime_object)`。问题是，由于某种原因，`str(datetime_object)`当 datetime 对象的微秒设置为零并且某些字符串看起来像这样时，会生成不同的格式：

```
'2009-02-10 16:06:52' 
```

如何解析这些字符串并将它们转换为[日期时间对象](http://docs.python.org/library/datetime.html#datetime.datetime)？

获取对象中的所有数据非常重要，包括微秒。

注意：我必须使用**Python 2.5**，微秒格式指令`%f`在 2.5 中不存在。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-10T06:16:21.457

或者：

```
from datetime import datetime

def str2datetime(s):
    parts = s.split('.')
    dt = datetime.strptime(parts[0], "%Y-%m-%d %H:%M:%S")
    return dt.replace(microsecond=int(parts[1])) 
```

使用`strptime`自身来解析日期/时间字符串（因此无需考虑正则表达式的极端情况）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-10T06:23:30.283

使用 dateutil 模块。它支持比 Python 内置的更广泛的日期和时间格式。

您需要**easy_install dateutil**才能使以下代码正常工作：

```
from dateutil.parser import parser

p = parser()
datetime_with_microseconds = p.parse('2009-02-10 16:06:52.598800')
print datetime_with_microseconds.microsecond 
```

结果是：

```
598799 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T06:07:10.697

有人已经为此问题提交了一个错误：[Issue 1982](http://bugs.python.org/issue1982)。由于您需要它与 python 2.5 一起使用，您必须手动解析值，然后操作 datetime 对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T06:14:45.767

这可能不是最好的解决方案，但您可以使用正则表达式：

```
m = re.match(r'(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(?:\.(\d{6}))?', datestr)
dt = datetime.datetime(*[int(x) for x in m.groups() if x]) 
```

# ide - 便携式编程IDE

> ID：531162
> 
> 赞同：10
> 
> 时间：2009-02-10T05:36:20.537
> 
> 标签：ide, programming-languages, portability, portable-applications

我经常头脑风暴，想直接编写代码。或多或少像“哇，那个算法会摇滚！我现在需要写它！”。

对于这种“冲动”的写作，我使用[http://www.jarte.com/](http://www.jarte.com/)这是一个很酷的便携式文本编辑器。如果我在 cybecafe 或朋友的电脑附近，我只需插入 USB 笔式驱动器并开始写...

所以，我想要：1) 一个可移植的极简 IDE 2) 具有最低操作系统要求（即：我想从 XP、Vista 等运行...） 3) 任何现代语言（如果需要，我可以学习一门新语言。我只想编写/测试算法）4）语法高亮/智能感知很好，但不是必需的 5）免费

有这样的事情吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T05:39:44.960

Eclipse 不是“极简主义者”，但它确实无需安装。因此，只要您的 USB 密钥或其他任何东西足够大，您就可以将 Eclipse 放入其中并准备就绪。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T05:54:19.793

[替代文字 http://sts.bkukr.de/l-davoss/blog/Lists/Blog/Attachments/21/SharpdevelopPortable.jpg](http://sts.bkukr.de/l-davoss/blog/Lists/Blog/Attachments/21/SharpdevelopPortable.jpg)

夏普开发便携：

戴夫写了所有你需要知道的[博客，让你开始！](http://sts.bkukr.de/l-davoss/blog/default.aspx?BlogId=21)

运行中的 C# 支持，等等。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-02T21:33:23.503

请查看[ideone.com](http://ideone.com) - 支持 40 多种语言

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T06:15:12.083

嗯，IDE 通常更适合您想要使用的编程语言。我不确定您是在寻找文本编辑器还是 IDE，但是：

就我而言，我会使用：

**Java：** [Eclipse](http://www.eclipse.org)（虽然不是很简约）

**C/C++：** [vim](http://www.vim.org/)和[g++](http://gcc.gnu.org/)，[代码::块](http://www.codeblocks.org/)

**Ruby/Python/Perl：** [vim](http://www.vim.org/) + 解释器

[Mac OS X 上的TextMate](http://macromates.com/)（有史以来最好的编辑器）（39.99 美元）和[e 编辑器](http://www.e-texteditor.com/)（Windows 的 TextMate 等价物）我还发现 NotePad++ 是一个不错的文本编辑器，非常简约。

有些人疯狂地爱上了[emacs](http://www.gnu.org/software/emacs/)，你可能想看看。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T05:46:56.083

您还可以在 USB 驱动器上携带 NetBeans：http: [//nbide.blogspot.com/2008/03/portable-netbeans.html](http://nbide.blogspot.com/2008/03/portable-netbeans.html)和[http://nbide.blogspot.com/2008/04/portable-netbeans-part- ii.html](http://nbide.blogspot.com/2008/04/portable-netbeans-part-ii.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-28T20:33:50.070

我来晚了，但值得一提的是 Squeak Smalltalk，或者它的衍生产品之一，如 Pharo 或 Croquet。无需更改注册表或操作系统，无需安装程序，无需服务，无需管理员权限，并且只需要几个文件 - 完全安装在六个文件中。

1）二进制和源可移植代码；不错的 IDE，但磁盘占用极少（5-50 MB）

2) 几乎可以在任何操作系统上运行 - 一个跨平台二进制映像和一个适用于每个平台的小型虚拟机可执行文件 - 一个用于 95/98/ME/XP/2k/XP/Vista/7/2003/2008；一种用于 WinCE，一种用于 OS X，一种用于 Linux x86，等等；(0.5-2 MB) 每个平台。如果你是铁杆，你甚至可以启动到裸机。

3）它是Smalltalk。大多数值得关注的 Ruby 功能的诞生地......

4) 内置语法高亮和一定程度的智能感知。

5）免费的演讲和啤酒。

Smalltalk 并不适合所有人，但它是我个人的最爱。我可以在我的 XP 桌面、Linux 服务器、iPhone 和 WinCE PDA 上使用相同的二进制映像而无需重新编译，这一事实是一个很大的好处。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T05:38:29.050

Emacs + 编译器/解释器听起来像你想要的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T05:40:33.040

对于 C/C++，DevC++ 使用 USB 驱动器。它运行在 XP 上，我相信 Vista 也是如此（从未尝试过）。它还具有语法突出显示。

唯一的问题是（我假设这个）是它不适用于其他语言。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T06:01:45.780

![替代文字](https://www.bluej.org/images/screenshots/screen-small.jpg)

试试[BlueJ](http://www.bluej.org/about/what.html)（[从 USB（拇指）驱动器运行 BlueJ](http://www.bluej.org/help/archive.html#tip24)）。

其他选择；

1.  [片段编译器](http://www.sliver.com/dotnet/SnippetCompiler/) [（来源：][[sliver.com](http://www.sliver.com/dotnet/SnippetCompiler/SnippetCompiler3.PNG)][）][![替代文字](https://i.stack.imgur.com/hUZxI.png)](https://i.stack.imgur.com/hUZxI.png)

2.  [CodeIDE](http://www.codeide.com/)一个在线 IDE。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T06:04:16.897

当我想快速组合某些东西时，我经常使用 Firefox + Firebug。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-10T06:10:58.410

您可能正在寻找[vim](http://www.vim.org/)。现在，学习如何使用 vim 并不容易，但我认为这是值得的。这是一个 unix 实用程序，基本上已被移植到每个体系结构和操作系统，请参阅[Portable GVim](http://portablegvim.sourceforge.net/)的便携版本。有关将 vim 用作 IDE 的信息，请参见[此处](http://clipboarded.blogspot.com/2007/10/vim-as-ide.html)和[此处](http://vim.wikia.com/wiki/Best_Vim_Tips)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-05-31T22:57:14.863

我在我的 stik 中使用带有 netbeans 的 Instant rails

# delphi - 为什么 GenTLB 重命名符号（附加“_”）

> ID：531171
> 
> 赞同：0
> 
> 时间：2009-02-10T05:41:01.323
> 
> 标签：delphi, delphi-2009

我正在使用 GenTLB.exe 将 ridl 文件编译为 .tlb 和 _TLB.pas 文件。

在生成的 _TLB.pas 文件中，提示它通过在名称末尾附加下划线重命名了许多符号。

提示示例如下：

```
// Errors:
//   Hint: Symbol 'Assign' renamed to 'Assign_'
//   Hint: Enum Member '_amStretch' of 'EnumVRSAppliedMaterial' changed to '_amStretch_'
//   Hint: Enum Member '_amTile' of 'EnumVRSAppliedMaterial' changed to '_amTile_' 
```

我使用 GenTLB 的命令行是：

```
GenTLB -P -Pt+ <ridl file> 
```

如果我也使用 tlibimp 工具，我也会遇到同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T07:33:20.477

我不确定，但如果名称与现有名称冲突（例如，reserwed 单词等），通常会在名称前附加下划线。可能是这样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T10:19:18.063

由于 tlibimp.sym 中的映射，Assign 被重命名为 Assign_，这是一个与`tlibimp`.

另一段逻辑不断地附加“_”，直到该名称相对于先前的全局名称`tlibimp`已找到为止是唯一的。所有枚举成员都被解释为全局变量。生成的 .pas 文件中是否还有其他 _amTile 等实例？

# c# - 如何检测正在执行应用程序的上下文？无论是从命令提示符还是从 Windows 窗体中

> ID：531176
> 
> 赞同：1
> 
> 时间：2009-02-10T05:46:51.807
> 
> 标签：c#, command-line, testing-strategies

我正在尝试通过我们的一个内部应用程序运行一组测试用例。我需要能够自动化这些测试并通过命令行运行它们并记录各种事情。问题是现有代码没有将视图与控制器分开，并且在要求用户单击按钮的所有地方都抛出 MessageBoxes 和 Alerts（在我的情况下只是 OK/CONTINUE）。目前，已经决定引入状态标志，这将有助于确定应用程序正在运行的上下文，以便人们可以决定是执行 a`Console.WriteLine()`还是 a `MessageBox.Show()`。但正如你可以想象的那样，这已经导致了很多变化和脏 if-else 块。

可悲的是，在这个阶段坐下来将逻辑与视图分开看起来并不可行。所以我想知道是否有办法检测应用程序正在执行的上下文。我想将每个 MessageBox() 调用替换为 Notify() 调用，它本身可以检测上下文 - 无论是在命令提示符下显示输出还是弹出表单。

EDIT_1：也欢迎任何其他建议这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T05:55:25.093

在我的应用程序中，我解析命令行参数并设置一些内部标志。如果您将这种类型的解析添加到应用程序的入口点，例如，命令行参数的存在设置为“Y” - 可以在应用程序中设置适当的标志，用于确定将输出发送到何处。

就个人而言，我将所有“STDOUT”（控制台）输出捕获到一个日志文件中，然后如果不是在“预定”模式下运行 - 我会弹出一个`msgbox()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T06:31:20.017

在使用 Win32 API 的 C 语言中（在我脑海中，未经测试）：

```
// requires Windows 2000 or later (for GetConsoleWindow)
int parent_owns_the_console()
{
    DWORD pid=0;
    GetWindowThreadProcessId(GetConsoleWindow(), &pid);
    return pid && pid != GetCurrentProcessId();
} 
```

# syntax - 将 F# 管道符号与对象构造函数一起使用

> ID：531178
> 
> 赞同：15
> 
> 时间：2009-02-10T05:47:33.833
> 
> 标签：syntax, f#, constructor, pipe

我试图找出正确的语法来使用管道运算符 |> 来创建对象。目前我正在使用一个静态成员来创建对象并只是通过管道传递给它。这里是简化版。

```
type Shape = 
    val points : Vector[]

    new (points) =
        { points = points; }

    static member create(points) =
        Shape(points)

    static member concat(shapes : Shape list) =
        shapes
            |> List.map (fun shape -> shape.points)
            |> Array.concat
            |> Shape.create 
```

我想做的事 ...

```
 static member concat(shapes : Shape list) =
        shapes
            |> List.map (fun shape -> shape.points)
            |> Array.concat
            |> (new Shape) 
```

这样的事情可能吗？我不想通过使用静态成员创建重复我的构造函数来复制代码。

**从 F# 4.0 开始，更新** 构造函数是一流的函数

在 F# 4.0 中，正确的语法是。

```
 static member concat(shapes : Shape list) =
        shapes
            |> List.map (fun shape -> shape.points)
            |> Array.concat
            |> Shape 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T06:21:28.400

总有

```
(fun args -> new Shape(args)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T06:34:23.190

显然，对象构造函数是不可组合的。可区分的联合构造函数似乎没有这个问题：

```
> 1 + 1 |> Some;;
val it : int option = Some 2 
```

如果您想使用管道，Brian 的答案可能是最好的。在这种情况下，我会考虑用 Shape() 包裹整个表达式。

# http - 在 Yahoo Pipes 中使用 HTTPS 资源？

> ID：531179
> 
> 赞同：4
> 
> 时间：2009-02-10T05:47:35.223
> 
> 标签：http, https, yahoo-pipes

是否可以在 Yahoo Pipes 的 URLBuilder 中使用 HTTPS: 资源？

我已经轻松地使用了 HTTP：，但是当我将其更改为 HTTPS：时出现错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-05-03T13:39:37.523

[您可以通过支持 https 的YQL (Yahoo! Query Language)](http://developer.yahoo.com/yql) “代理”您的 https url 来解决不支持 https 的 yahoo 管道。yahoo 管道具有 Sources > YQL 模块，您可以通过如下 YQL 查询传递 https url：

```
select * from rss where url='https://example.com/example.rss' 
```

使用此查询，YQL 模块将返回原始 https 提要中的所有项目。

[通过[*HTTPS、管道和 YQL*](http://discuss.pipes.yahoo.com/Message_Boards_for_Pipes/threadview?bn=pip-genDiscuss&tid=1870&mid=-1) ]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T02:36:04.033

你目前被卡住了。至少截至 2009 年 2 月 9 日，[Yahoo Pipes 不支持 https](http://discuss.pipes.yahoo.com/Message_Boards_for_Pipes/threadview?bn=pip-DeveloperHelp&tid=7376&mid=7377)。

有可能设置您自己的代理服务器来为您获取 SSL 并通过 http 重新提供内容，但这不是我曾经尝试过的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T23:22:17.637

雅虎！Pipes 目前不支持 HTTPS。我解决这个问题的方法是在我自己的网络服务器上设置一个 PHP 页面，该页面将获取 HTTPS 提要并通过 HTTP 回显它。然后我把管子指向那个。

这将完成这项工作：

```
<?php
    $feed_contents = file_get_contents('https://example.com/feed.rss');
    header('Content-Type: application/rss+xml');
    echo $feed_contents;
?> 
```

# performance - SQLEXPRESS：适用于主要读取数据的生产网站

> ID：531186
> 
> 赞同：0
> 
> 时间：2009-02-10T05:55:14.923
> 
> 标签：performance, web-applications, sql-server-express

是否有人在 Web 服务器上使用本地 SQLEXPRESS 实例来提供只读/主要内容？似乎没有参照完整性、非规范化表、大量索引等的只读数据库可以很好地执行。这是一个完全可怕的想法吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T06:01:59.807

非常相似的问题已经在[这里](https://stackoverflow.com/questions/180537/sql-express-for-production)

[在此处](http://www.microsoft.com/Sqlserver/2005/en/us/compare-features.aspx)查看比较功能

快速回答是：没有真正的问题。

# sql - 清除 SQL Server 中的优先重叠范围

> ID：531187
> 
> 赞同：1
> 
> 时间：2009-02-10T05:55:24.487
> 
> 标签：sql, sql-server

这个解决起来很麻烦。

我有一个包含日期范围的表格，每个日期范围都有一个优先级。最高优先级意味着这个日期范围是最重要的。

或者在 SQL 中

```
create table #ranges (Start int, Finish int,  Priority int) 

insert #ranges values (1 , 10, 0)
insert #ranges values (2 , 5 , 1)
insert #ranges values (3 , 4 , 2)
insert #ranges values (1 , 5 , 0)
insert #ranges values (200028, 308731, 0)

Start       Finish      Priority
----------- ----------- -----------
1           10          0
2           5           1
3           4           2
1           5           0
200028      308731      0 
```

我想在该表上运行一系列 SQL 查询，这将导致该表没有重叠范围，即优先级最高的范围优先于较低的范围。根据需要拆分范围，并删除重复的范围。它允许间隙。

所以结果应该是：

```
Start       Finish      Priority    
----------- ----------- -----------
1           2           0
2           3           1
3           4           2
4           5           1
5          10           0
200028     308731       0 
```

有人愿意试一试 SQL 吗？我也希望它尽可能高效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T11:12:44.060

这是大部分的方式，可能的改进是连接具有相同优先级的相邻范围。它充满了很酷的诡计。

```
select Start, cast(null as int) as Finish, cast(null as int) as Priority 
into #processed  
from #ranges
union  
select Finish, NULL, NULL 
from #ranges

update p 
set Finish = (
    select min(p1.Start) 
    from #processed p1 
    where p1.Start > p.Start
)
from #processed p 

create clustered index idxStart on #processed(Start, Finish, Priority) 
create index idxFinish on #processed(Finish, Start, Priority) 

update p
set Priority = 
    (
        select max(r.Priority) 
        from #ranges r
        where 
        (
            (r.Start <= p.Start and r.Finish > p.Start) or 
            (r.Start >= p.Start and r.Start < p.Finish)  
        )
    )
from #processed p

delete from #processed
where Priority is null 

select * from #processed 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T06:37:02.060

我对你最终想要什么感到有点困惑。这是否与简单地拥有一组日期相同，其中一个范围一直持续到下一个范围开始（在这种情况下，您实际上并不需要完成日期，对吗？）

或者一个范围可以完成并且有时直到下一个开始之前有一个差距？

如果明确设置了范围开始和结束，那么我倾向于同时保留两者，但有逻辑在重叠期间应用更高的优先级。我怀疑如果日期开始调整，你最终需要回滚一个被剃光的范围，原来的设置就会消失。

而且你永远无法解释“它是如何做到的”。

您是否想要一个表格，每个日期都有一行，包括其优先级值？那么当你有一个新规则时，你可以改变那些会被新规则压倒的日期吗？

一旦从工作/假期/等开始，我就做了一个医疗办公室调度应用程序。带有范围类型数据的请求（加上一个默认的工作周模板。）一旦我想出将活动的日程安排信息存储为用户/日期/时间范围记录，事情就容易多了。YMMV。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T07:22:00.847

这里有一些东西可以帮助您入门。如果您使用日历表会很有帮助：

```
CREATE TABLE dbo.Calendar  
(  
    dt SMALLDATETIME NOT NULL 
        PRIMARY KEY CLUSTERED
) 
GO

SET NOCOUNT ON 
DECLARE @dt SMALLDATETIME 
SET @dt = '20000101' 
WHILE @dt < '20200101' 
BEGIN 
    INSERT dbo.Calendar(dt) SELECT @dt 
    SET @dt = @dt + 1 
END
GO 
```

**设置问题的代码：**

```
create table #ranges (Start DateTime NOT NULL, Finish DateTime NOT NULL,  Priority int NOT NULL) 
create table #processed (dt DateTime NOT NULL, Priority int NOT NULL) 

ALTER TABLE #ranges ADD PRIMARY KEY (Start,Finish, Priority)
ALTER TABLE #processed ADD PRIMARY KEY (dt)

declare @day0 datetime,
    @day1 datetime, 
    @day2 datetime, 
    @day3 datetime, 
    @day4 datetime, 
    @day5 datetime

select @day0 = '2000-01-01', 
    @day1 = @day0 + 1, 
    @day2 = @day1 + 1,  
    @day3 = @day2 + 1,
    @day4 = @day3 + 1,
    @day5 = @day4 + 1

insert #ranges values (@day0, @day5, 0)
insert #ranges values (@day1, @day4, 1)
insert #ranges values (@day2, @day3, 2)
insert #ranges values (@day1, @day4, 0) 
```

**实际解决方案：**

```
DECLARE @start datetime, @finish datetime, @priority int

WHILE 1=1 BEGIN
    SELECT TOP 1 @start = start, @finish = finish, @priority = priority
    FROM #ranges 
    ORDER BY priority DESC, start, finish

    IF @@ROWCOUNT = 0
        BREAK

    INSERT INTO #processed (dt, priority)
        SELECT dt, @priority FROM calendar 
        WHERE dt BETWEEN @start and @finish
        AND NOT EXISTS (SELECT * FROM #processed WHERE dt = calendar.dt)

    DELETE FROM #ranges WHERE @start=start AND @finish=finish AND @priority=priority
END 
```

**结果：** SELECT * FROM #processed

```
dt                      Priority
----------------------- -----------
2000-01-01 00:00:00.000 0
2000-01-02 00:00:00.000 1
2000-01-03 00:00:00.000 2
2000-01-04 00:00:00.000 2
2000-01-05 00:00:00.000 1
2000-01-06 00:00:00.000 0 
```

解决方案的格式不完全相同，但想法就在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:43:11.510

这可以在 1 个 SQL 中完成（我首先使用滞后和超前在 Oracle 中进行查询，但由于 MSSQL 不支持这些函数，我使用 row_number 重写了查询。我不确定结果是否符合 MSSQL，但它应该非常接近）：

```
with x as (
select rdate   rdate
,      row_number() over (order by rdate)   rn 
from   (
       select start    rdate
       from   ranges
       union
       select finish   rdate
       from   ranges
       )
)
select d.begin
,      d.end
,      max(r.priority)
from   ( 
       select begin.rdate    begin
       ,      end.rdate      end
       from   x      begin
       ,      x      end
       where  begin.rn = end.rn - 1
       )          d
,      ranges     r
where  r.start    <= d.begin
and    r.finish   >= d.end
and    d.begin    <> d.end
group by d.begin
,      d.end
order by 1, 2 
```

我首先制作了一个包含所有日期的表格 (x)。然后我通过将 x 与自身连接并取 2 行来将其变成存储桶。在此之后，我将所有可能的优先级与结果联系起来。通过获取最大（优先级），我得到了请求的结果。

# ruby-on-rails - 提供静态资产的路线（如 .jpgs 等？）

> ID：531189
> 
> 赞同：14
> 
> 时间：2009-02-10T05:55:59.990
> 
> 标签：ruby-on-rails, jpeg, routes

我已经解决了许多有趣的路由问题——将请求 URL 转换为哈希等，但出于好奇，有没有办法告诉路由系统你想要某个 url 下的任何东西从字面上提供子路径 - 无需通过控制器？

例如，如果我有 /home/me/public_html/rails_proj/images/foo.jpg 和 .../rails_proj/images/other/bar.jpg，我可以插入一条路线，上面写着“图像下的任何东西都应该是作为默认 mime 类型的对象？”

可能很有趣。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-10T06:34:46.280

如果将“images”目录放入 Rails 应用程序的“public”文件夹（例如：/public/images/），那么 MIME 类型应该不会有任何问题，除非您的 Web 服务器配置错误。

根据您的示例，您希望应用程序根目录中的图像目录。我不认为 Rails 有办法让这些图像可见，但如果你真的想要，你可以使用 mod_rewrite 让它工作。再一次，由网络服务器来确保图像具有正确的 MIME 类型。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T06:36:58.113

从公共目录提供的东西不会通过 Rails - 它们只会由您的服务器（可能是 apache）处理。您需要通过 rails 系统提供图像的唯一原因是您想要对谁可以访问它们进行某种控制。只需将其他所有内容公开并访问 ala：siteurl.whatever/images/*.jpg

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T08:41:22.933

我通常使用 nginx 作为前端，使用 Apache/Passenger 作为后端。Ngingx 代理所有 Rails 对 Apache 的请求，但自己处理所有静态内容。查看[英文 nginx wiki](http://wiki.codemongers.com/NginxConfiguration)上的示例。这是 nginx 配置的一小段摘录：

```
server {
    listen 80;
    server_name www.domain.com;
    location ~* \.(jpg|jpeg|gif|png|ico|css|bmp|js)$ {
        root   /path/to/static/assets/dir;
    }
    location / {
        proxy_pass http://127.0.0.1:81;
    }
} 
```

所以让 apache 监听 81 端口来处理由 nginx 代理的 Rails 请求，让 nginx 传递静态内容。据说 nginx 不仅在交付静态内容方面比 Apache 更快，而且这也为每个图像、样式表、javascript 或任何其他静态内容卸载了 Rails 应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-17T14:35:03.220

我认为解决这个问题最简单的方法就是使用 image_path 辅助方法，它为您提供要在视图中显示的图像的路径。例如，如果你想引用 /assets/images/logo.png 下的 logo.png，你可以使用 image_path('logo.png')。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T20:24:49.333

警告：如果您的请求 URL 匹配静态资源 WEBrick、mongrel 或任何会很乐意为它服务的东西。无论如何，您都不希望在生产环境中出现这种情况：如果您的流量足够高，您的应用程序将因为它的杂种将忙于提供静态内容而陷入瘫痪。

因此，请确保您的 Web 服务器已正确配置为适用于之前评论者指出的各种静态内容。

# c# - c# 为.NET Queue 类添加 Remove(int index) 方法

> ID：531191
> 
> 赞同：28
> 
> 时间：2009-02-10T05:56:56.323
> 
> 标签：c#, queue

我想使用 .NET 框架 (3.5) 中描述的通用队列类，但我需要一个 Remove(int index) 方法来从队列中删除项目。我可以使用扩展方法实现此功能吗？有人愿意指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-10T06:21:41.427

你想要的是一个[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)当[`RemoveAt(0)`](http://msdn.microsoft.com/en-us/library/c93ab5c9.aspx)你想从`Queue`. 其他一切都是一样的，真​​的（调用`Add`会将一个项目添加到 的末尾`Queue`）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-01-28T21:21:58.980

将 casperOne 和 David Anderson 的建议结合到一个新的水平。下面的类继承自 List 并在添加三个 Queue 方法（Equeue、Dequeu、Peek）的同时隐藏了对 FIFO 概念有害的方法。

```
public class ListQueue<T> : List<T>
{
    new public void Add(T item) { throw new NotSupportedException(); }
    new public void AddRange(IEnumerable<T> collection) { throw new NotSupportedException(); }
    new public void Insert(int index, T item) { throw new NotSupportedException(); }
    new public void InsertRange(int index, IEnumerable<T> collection) { throw new NotSupportedException(); }
    new public void Reverse() { throw new NotSupportedException(); }
    new public void Reverse(int index, int count) { throw new NotSupportedException(); }
    new public void Sort() { throw new NotSupportedException(); }
    new public void Sort(Comparison<T> comparison) { throw new NotSupportedException(); }
    new public void Sort(IComparer<T> comparer) { throw new NotSupportedException(); }
    new public void Sort(int index, int count, IComparer<T> comparer) { throw new NotSupportedException(); }

    public void Enqueue(T item)
    {
        base.Add(item);
    }

    public T Dequeue()
    {
        var t = base[0]; 
        base.RemoveAt(0);
        return t;
    }

    public T Peek()
    {
        return base[0];
    }
} 
```

**测试代码：**

```
class Program
{
    static void Main(string[] args)
    {
        ListQueue<string> queue = new ListQueue<string>();

        Console.WriteLine("Item count in ListQueue: {0}", queue.Count);
        Console.WriteLine();

        for (int i = 1; i <= 10; i++)
        {
            var text = String.Format("Test{0}", i);
            queue.Enqueue(text);
            Console.WriteLine("Just enqueued: {0}", text);
        }

        Console.WriteLine();
        Console.WriteLine("Item count in ListQueue: {0}", queue.Count);
        Console.WriteLine();

        var peekText = queue.Peek();
        Console.WriteLine("Just peeked at: {0}", peekText);
        Console.WriteLine();

        var textToRemove = "Test5";
        queue.Remove(textToRemove);
        Console.WriteLine("Just removed: {0}", textToRemove);
        Console.WriteLine();

        var queueCount = queue.Count;
        for (int i = 0; i < queueCount; i++)
        {
            var text = queue.Dequeue();
            Console.WriteLine("Just dequeued: {0}", text);
        }

        Console.WriteLine();
        Console.WriteLine("Item count in ListQueue: {0}", queue.Count);

        Console.WriteLine();
        Console.WriteLine("Now try to ADD an item...should cause an exception.");
        queue.Add("shouldFail");

    }
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-08-19T12:47:48.103

这是使用一行 Linq 从队列中删除**特定项目的方法（它正在重新创建队列，但由于缺乏更好的方法......）**

```
//replace "<string>" with your actual underlying type
myqueue = new Queue<string>(myqueue.Where(s => s != itemToBeRemoved)); 
```

我知道它不是**按 index**删除的，但仍然有人可能会觉得这很有用（这个问题在 Google 中排名为“从 ac# 队列中删除特定项目”，所以我决定添加这个答案，抱歉）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-07-03T12:12:19.143

这是一个很晚的答案，但我是为未来的读者写的

`List<T>`正是您所需要的，但`Queue<T>`与. 甚至使用一个数组，但有两个索引（用于头部和尾部）。`Dequeue()``Array.Copy``Queue<T>`

在您的情况下，您还需要`Remove`/`RemoveAt`并且它的性能不会很好（出于同样的原因：如果您不从列表尾部删除，则必须分配另一个数组并复制项目）。

具有快速`Dequeue`/`Remove`时间的更好的数据结构是链表（您将牺牲 - 一点点 - 性能，`Enqueue`但假设您的队列具有相同数量的`Enqueue`/`Dequeue`操作，您将获得很大的性能提升，特别是当它的大小时会成长）。

让我们看一个简单的实现框架（我将跳过`IEnumerable<T>`和`IList<T>`其他辅助方法的实现）。

```
class LinkedQueue<T>
{
    public int Count
    {
        get { return _items.Count; }
    }

    public void Enqueue(T item)
    {
        _items.AddLast(item);
    }

    public T Dequeue()
    {
        if (_items.First == null)
           throw new InvalidOperationException("...");

        var item = _items.First.Value;
        _items.RemoveFirst();

        return item;
    }

    public void Remove(T item)
    {
        _items.Remove(item);
    }

    public void RemoveAt(int index)
    {
        Remove(_items.Skip(index).First());
    }

    private LinkedList<T> _items = new LinkedList<T>();
} 
```

快速比较：

```
           队列列表 LinkedList
入队 O(1)/O(n)* O(1)/O(n)* O(1)
出队 O(1) O(n) O(1)
删除 n/a O(n) O(n)

```

^* O(1) 是*典型*情况，但*有时*会是 O(n)（当内部数组需要调整大小时）。

当然，您会为所获得的东西付出一些代价：内存使用量更大（尤其是对于较小的`T`开销会很棒）。必须根据您的使用场景仔细选择正确的实现（`List<T>`vs `LinkedList<T>`），您也可以将该代码转换为使用单链表以减少 50% 的内存开销。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-10T06:06:53.193

有人可能会开发出更好的解决方案，但据我所知，您需要在 Remove 方法中返回一个新的 Queue 对象。您将要检查索引是否超出范围，并且我可能将添加的项目的顺序弄错了，但这里有一个快速而肮脏的示例，可以很容易地变成扩展。

```
public class MyQueue<T> : Queue<T> {
    public MyQueue() 
        : base() {
        // Default constructor
    }

    public MyQueue(Int32 capacity)
        : base(capacity) {
        // Default constructor
    }

    /// <summary>
    /// Removes the item at the specified index and returns a new Queue
    /// </summary>
    public MyQueue<T> RemoveAt(Int32 index) {
        MyQueue<T> retVal = new MyQueue<T>(Count - 1);

        for (Int32 i = 0; i < this.Count - 1; i++) {
            if (i != index) {
                retVal.Enqueue(this.ElementAt(i));
            }
        }

        return retVal;
    }
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-02-20T02:02:55.993

尽管没有内置方式，但您不应该使用 List 结构或其他结构，IFF RemoveAt 不是常用操作。

如果您通常入队和出队但只是偶尔删除，那么您应该能够在删除时重新构建队列。

```
public static void Remove<T>(this Queue<T> queue, T itemToRemove) where T : class
{
    var list = queue.ToList(); //Needs to be copy, so we can clear the queue
    queue.Clear();
    foreach (var item in list)
    {
        if (item == itemToRemove)
            continue;

        queue.Enqueue(item);
    }
}

public static void RemoveAt<T>(this Queue<T> queue, int itemIndex) 
{
    var list = queue.ToList(); //Needs to be copy, so we can clear the queue
    queue.Clear();

    for (int i = 0; i < list.Count; i++)
    {
        if (i == itemIndex)
            continue;

        queue.Enqueue(list[i]);
    }
} 
```

以下方法可能更有效，使用更少的内存，从而减少 GC：

```
public static void RemoveAt<T>(this Queue<T> queue, int itemIndex)
{
    var cycleAmount = queue.Count;

    for (int i = 0; i < cycleAmount; i++)
    {
        T item = queue.Dequeue();
        if (i == itemIndex)
            continue;

        queue.Enqueue(item);
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-10T07:22:13.233

事实上，这违背了 Queue 的全部目的，并且您最终会提出的类将完全违反 FIFO 语义。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-03-26T18:27:28.447

如果 Queue 用于保留集合中项目的顺序，并且您不会有重复的项目，那么[SortedSet](http://msdn.microsoft.com/en-us/library/dd412070.aspx)可能就是您要寻找的。这些`SortedSet`行为很像 a `List<T>`，但保持有序。非常适合下拉选择之类的东西。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-13T12:50:45.237

我不认为我们应该`List<T>`用来模拟队列，对于队列，入队和出队操作应该非常高效，而在使用`List<T>`. 然而，对于该`RemoveAt`方法，可以接受的是非性能，因为它不是 a 的主要目的`Queue<T>`。

我的实现方法`RemoveAt`是 O(n)，但队列仍然保持很大程度上 O(1) 入队（有时内部数组需要重新分配，这使得操作 O(n)）并且总是 O(1) 出队。

这是我对 a 的`RemoveAt(int)`扩展方法的实现`Queue<T>`：

```
public static void RemoveAt<T>(this Queue<T> queue, int index)
{
    Contract.Requires(queue != null);
    Contract.Requires(index >= 0);
    Contract.Requires(index < queue.Count);

    var i = 0;

    // Move all the items before the one to remove to the back
    for (; i < index; ++i)
    {
        queue.MoveHeadToTail();
    }

    // Remove the item at the index
    queue.Dequeue();

    // Move all subsequent items to the tail end of the queue.
    var queueCount = queue.Count;
    for (; i < queueCount; ++i)
    {
        queue.MoveHeadToTail();
    }
} 
```

其中`MoveHeadToTail`定义如下：

```
private static void MoveHeadToTail<T>(this Queue<T> queue)
{
    Contract.Requires(queue != null);

    var dequed = queue.Dequeue();
    queue.Enqueue(dequed);
} 
```

此实现还修改了实际`Queue<T>`而不是返回一个新的`Queue<T>`（我认为这与其他`RemoveAt`实现更一致）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T08:37:58.790

[大卫安德森的解决方案](https://stackoverflow.com/questions/531191/c-adding-a-removeint-index-method-to-the-net-queue-class/531201#531201)可能是最好的，但有一些开销。您是否在队列中使用自定义对象？如果是这样，请添加一个布尔值，如取消

如果设置了该布尔值，请与处理队列的工作人员核实，然后跳过它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-11T01:05:43.183

请注意，如果您不实际删除项目而只是将其“标记”为“已删除”，则使用列表可以使“删除”过程更有效。是的，你必须添加一些代码来处理你是如何做到的，但回报是效率。

举个例子 - 假设你有一个`List<string>`. 然后，例如，您可以将该特定项目设置为 null 并完成它。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2011-11-09T02:42:37.257

队列类很难理解。请改用通用列表。

# c# - how to destroy a Static Class in C#

> ID：531199
> 
> 赞同：18
> 
> 时间：2009-02-10T06:05:23.480
> 
> 标签：c#

I am using .net 1.1\. I have a session class in which I have stored many static variables that hold some data to be used by many classes.

I want to find a simple way of destroying this class instead of resetting every variable one by one. For example if there is a static class MyStatic, I would have liked to destroy/remove this class from the memory by writing MyStatic = null, which is not currently possible,

## Additional question.

The idea of singleton is good, but I have the following questions:

If singleton is implemented, the 'single' object will still remain in the memory. In singleton, we are only checking if an instance is already existing. how can i make sure that this instance variable also gets destroyed.

I have a main class which initializes the variable in the static class. Even if I plan to implement a Rest() method, I need to call it from a method, for eg, the destructor in the main class. But this destructor gets called only when GC collects this main class object in the memory, which means the Reset() gets called very late

thanks pradeep

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T06:08:58.447

Don't use a static class to store your variables. Use an instance (and make it a singleton if you only want one instance at any given time.) You can then implement IDisposible, and just call Dispose() when you want to destroy it.

For more information check out this site: [http://csharpindepth.com/Articles/General/Singleton.aspx](http://csharpindepth.com/Articles/General/Singleton.aspx)

**EDIT**

The object is still subject to garbage collection, so unless you are using lots of unmanaged resources, you should be fine. You can implement IDisposible to clean up any resources that need to be cleaned up as well.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T06:13:44.490

Instead of a static class, have a static instance of a class:

```
class Foo
{
  public int Something;
  public static Foo Instance = new Foo();
  public void Reset()
  {
    Instance = new Foo();
  }
}

void test
{
  int i = Foo.Instance.Something;
} 
```

You can also delegate to an instance of the class:

```
class Foo
{
  public int Something
  {
    get { return instance.something; }
  }
  private int something;
  private static Foo instance = new Foo();
  public void Reset()
  {
    instance = new Foo();
  }
}

void test
{
  int i = Foo.Something;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T06:09:15.000

There's no way to destroy a static unless it resides in a separate AppDomain in which case you can get rid of it by unloading the AppDomain. However it is usually better to avoid statics.

EDIT: Additional question

When the singleton is no longer referenced it will be collected just as everything else. In other words, if you want it collected you must make sure that there are no references to it. It goes without saying that if you store a static reference to your singleton, you will have the same problem as before.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T06:11:26.333

Use a Singleton like ktrauberman said, and have an initialization method or a reset method. You only have to write the code once and call the method.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-07T15:21:32.603

You destroy objects, not classes. There's nothing wrong with static classes--C# provides them for a reason. Singletons are just extra overhead, unless you actually need an object, e.g. when you have to pass the object as a parameter.

Static classes contain only static variables. These variables tend to last for the lifetime of the app, in which case you don't have to worry about disposing referenced objects, unless you have a mild case of OCD. That just leaves the case where your static class allocates and releases resources throughout its lifetime. Dispose of these objects in due course as you usually would (e.g., "using...").

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T06:14:39.073

The best way in your condition is to have an Reset() method built-in as well, which can reset the values of the class.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T06:19:08.000

```
class myclass

{

private static myclass singleobj = null;
private myclass(){}
public static myclass CreateInstance()
{
if(singleobj == null)
  singleobj =  new myclass();

return singleobj
}

} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T07:08:13.390

Building on Ahemd Said's answer: (and props to him!)

```
class Singleton
{
    private static Singleton instance  = null;
    private Singleton(){}   // private constructor: stops others from using

    public static Singleton Instance
    {
        get { return instance ?? (instance = new Singleton()); }
        set {
                if (null != value)
                { throw new InvalidValueException(); }
                else
                { instance = null; }
            }
    }
}

void SampleUsage()
{
    Singleton myObj = Singleton.Instance;
    // use myObj for your work...
    myObj.Instance = null;  // The set-operator makes it ready for GC
} 
```

(untested... but mostly right, I think) You could also add in usage of the IDispose interface for more cleanup.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-18T10:52:00.287

You can create a method in the static class which resets the values of all properties. Consider you have a static class

```
public static class ClassA
{
     public static int id=0;
     public static string name="";

     public static void ResetValues()
     {
         // Here you want to reset to the old initialized value
         id=0;
         name="";
     }
} 
```

Now you can use any of the below approaches from any other class to reset value of a static class

**Approach 1 - Calling directly**

```
ClassA.ResetValues(); 
```

**Approach 2 - Invoking method dynamically from a known namespace and known class**

```
Type t1 = Type.GetType("Namespace1.ClassA");
MethodInfo methodInfo1 = t1.GetMethod("ResetValues");
if (methodInfo1 != null)
{
     object result = null;
     result = methodInfo1.Invoke(null, null);                
} 
```

**Approach 3 - Invoking method dynamically from an assembly/set of assemblies**

```
foreach (var Ass in AppDomain.CurrentDomain.GetAssemblies())
{
     // Use the above "If" condition if you want to filter from only one Dll
     if (Ass.ManifestModule.FullyQualifiedName.EndsWith("YourDll.dll"))
     {
            List<Type> lstClasses = Ass.GetTypes().Where(t => t.IsClass && t.IsSealed && t.IsAbstract).ToList();
            foreach (Type type in lstClasses)
            {
                  MethodInfo methodInfo = type.GetMethod("ResetValues");
                  if (methodInfo != null)
                  {
                       object result = null;
                       result = methodInfo.Invoke(null, null);                                
                  }
             }
             break;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-05T07:02:09.983

Inject the objects into the static class at startup from a non static class that implements IDisposable, then when your non static class is destroyed so are the objects the static class uses.

Make sure to implement something like "Disable()" so the static class is made aware it's objects have just been set to null.

Eg I have a logger class as follows:

```
public static class Logger
{
    private static Action<string, Exception, bool> _logError;

    public static void InitLogger(Action<string, Exception, bool> logError)
    {
        if(logError != null) _logError = logError;
    }

    public static void LogError(string msg, Exception e = null, bool sendEmailReport = false)
    {
        _logError?.Invoke(msg, e, sendEmailReport);
    } 
```

In my constructor of my Form I call the following to setup the logger.

```
Logger.InitLogger(LogError); 
```

Then from any class in my project I can do the following:

```
Logger.LogError("error",new Exception("error), true); 
```

# php - PHP 缩略图

> ID：531202
> 
> 赞同：1
> 
> 时间：2009-02-10T06:07:05.580
> 
> 标签：php, thumbnails

我正在寻找一种使用 PHP 和 GD 动态创建缩略图的方法，但每次我选择一个可能 10MegaPixels 约 4-5MB 的大图像时都会出现错误

```
**images/Surabhi_Cow.jpgimages/tn/Surabhi_Cow.jpg
Fatal error: Allowed memory size of 31457280 bytes exhausted (tried to allocate 10368 bytes) in C:\Program Files\xampp\htdocs\MySite\Staff\test.php on line 51** 
```

将 php.ini 中的 memory_limit 更改为 60 可以解决问题，但我的主机只允许 memory_limit 为 32M。我还有哪些其他选项可以即时生成缩略图？我检查了 phpThumb() 但并没有真正明白。所以欢迎任何其他选择！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T06:10:19.787

你想用[`ImageMagick`](http://us.php.net/imagick). 它在处理大图像方面比 GD 更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:43:18.693

如果您只想生成缩略图。我推荐这个名为***imagethumb.php***的漂亮小脚本。你可以在这里下载：***[http ://www.olivo.net/software/imagethumb/](http://www.olivo.net/software/imagethumb/)***

该脚本可生成出色的缩略图，绝对没有像素化。它接受附加到调用脚本的 URL 的高度或宽度参数。它真的很容易使用并附带文档（您将阅读全部 2 分钟）。

在登陆这个之前，我尝试了其他缩略图脚本，例如“ThumbsUp”（例如）。顺便说一句，它还呈现 .png 图像和 .gif （如果我没记错的话）。如果您有大文件，缓存功能将使您的服务器更容易。另外，我假设您的服务器安装了[GD](http://en.wikipedia.org/wiki/GD_Graphics_Library)库或[ImageMagick](http://en.wikipedia.org/wiki/ImageMagick)。祝你好运 **；）**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T10:22:01.020

我正在对该主题进行一些研究，我发现 Imagick 在处理更大的图像方面效率更高。您将通过允许的内存或最大执行时间。更好的方法是使用 Imagick 库。查看有关如何使用 Imagick 即时使用[php 生成缩略图的信息。](http://awordpress.net/blog/generate-thumbnails-with-php-imagick/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:03:23.587

正如其他人所说，如果图像那么大，是时候放弃 GD 并切换到 ImageMagick 了。不过要警告一句：在命令行上完成所有操作 - 类包装器需要彻底重新发明轮子，每一个轮子都需要重新发明。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T06:11:22.840

考虑使用基于命令行的方法。例如，您可以从命令行调用[ImageMagick](http://www.imagemagick.org/script/index.php)来调整图像大小。

除此之外，在纯 PHP 中，很难看到如何编辑比 RAM 更大（[RGB](http://en.wikipedia.org/wiki/RGB_color_model)格式）的图像......

# linux - Linux 显示上周平均 CPU 负载

> ID：531212
> 
> 赞同：22
> 
> 时间：2009-02-10T06:12:41.167
> 
> 标签：linux, load, cpu, logfiles

在 Linux 机器上，我需要显示上周平均每小时的 CPU 利用率。该信息是否记录在某处？或者我是否需要编写一个每 15 分钟唤醒一次的脚本以将 */proc/loadavg*复制到日志文件？

编辑：我不允许使用除 Linux 附带的工具以外的任何工具。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-10T06:24:16.960

您可能想查看**sar**（[手册页](http://linux.die.net/man/1/sar)），它非常适合您的用例。

**System Activity Reporter (SAR)** - 定期捕获重要的系统性能指标。

[IBM Developer Works 文章](http://www.ibm.com/developerworks/aix/library/au-unix-perfmonsar.html)中的示例：

向您的根 crontab 添加一个条目

```
# Collect measurements at 10-minute intervals
0,10,20,30,40,50   * * * *   /usr/lib/sa/sa1
# Create daily reports and purge old files
0                  0 * * *   /usr/lib/sa/sa2 -A 
```

然后您可以使用 sar 命令简单地查询此信息（显示今天的所有信息）：

```
root ~ # sar -A 
```

或者只是某天的日志文件：

```
root ~ # sar -f /var/log/sa/sa16 
```

你通常可以在你的 linux 发行版的**sysstat**包中找到它

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-10T06:21:25.437

据我所知，它没有存储在任何地方......无论如何，写起来是一件微不足道的事情。只需添加类似

```
cat /proc/loadavg >> /var/log/loads 
```

到你的`crontab`.

请注意，有一些监控工具（例如[Munin](http://munin-monitoring.org/)）可以为您做这种事情，并生成漂亮的图表以启动......不过，它们对于您的情况可能有点矫枉过正。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T06:25:24.413

我建议查看[Multi Router Traffic Grapher (MRTG)](http://oss.oetiker.ch/mrtg/)。

使用 snmpd 读取负载平均值，它将自动计算任何时间间隔和长度的平均值，以及用于分析的漂亮图表。

Someone has already posted a [CPU usage example](http://www.debianhelp.co.uk/mrtg.htm).

# sql - SQL Server 中的批量更新和提交频率

> ID：531222
> 
> 赞同：3
> 
> 时间：2009-02-10T06:18:12.933
> 
> 标签：sql, sql-server, oracle

我的数据库背景主要是 Oracle，但我最近一直在帮助一些 SQL Server 工作。我的小组继承了一些 SQL Server DTS 包，这些包每天加载和更新大量数据。目前它在SQL Server 2000 上运行，但很快将升级到SQL Server 2005 或2008。大量更新运行速度太慢。

关于代码，我注意到的一件事是，一些大型更新是在循环中的过程代码中完成的，因此每个语句仅在单个事务中更新表的一小部分。这是在 SQL Server 中进行更新的合理方法吗？并发会话的锁定不应该成为问题，因为在进行批量加载时用户对表的访问被禁用。我搜索了一些，发现一些文章建议这样做可以节省资源，并且每次更新提交时都会释放资源，从而提高效率。在 Oracle 中，这通常是一种不好的方法，我使用单个事务进行非常大的更新，并在 Oracle 中取得了成功。频繁的提交会减慢进程并在 Oracle 中使用更多资源。

我的问题是，对于 SQL Server 中的大规模更新，使用过程代码并提交许多 SQL 语句，或者使用一个大语句进行整个更新通常是一种好习惯吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T04:17:33.223

对不起大家，

以上都没有回答这个问题。它们只是您如何做事的示例。答案是，频繁提交会使用更多资源，但是，事务日志在提交点之前不能被截断。因此，如果您的单个跨越事务非常大，它将导致事务日志增长并可能出现碎片，如果未检测到，稍后会导致问题。此外，在回滚情况下，持续时间通常是原始事务的两倍。因此，如果您的交易在 1/2 小时后失败，则需要 1 小时才能回滚并且您无法停止它:-)

我曾与 SQL Server2000/2005、DB2、ADABAS 合作过，以上对所有人都是正确的。我真的不明白 Oracle 如何以不同的方式工作。

您可以将 T-SQL 替换为 bcp 命令，您可以在其中设置批处理大小，而无需对其进行编码。

在单个表扫描中发出频繁提交比运行具有少量处理数的多次扫描更可取，因为通常如果需要表扫描，即使您只返回一个小子集，也会扫描整个表。

远离快照。快照只会增加 IO 数量，竞争 IO 和 CPU

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T07:32:32.507

一般来说，我发现批量更新更好——通常在 100 到 1000 之间。这完全取决于表的结构：外键？触发器？还是只是更新原始数据？您需要进行试验，看看哪种方案最适合您。

如果我在纯 SQL 中，我会做这样的事情来帮助管理服务器资源：

```
SET ROWCOUNT 1000
WHILE 1=1 BEGIN
    DELETE FROM MyTable WHERE ...
    IF @@ROWCOUNT = 0
        BREAK
END
SET ROWCOUNT 0 
```

在此示例中，我正在清除数据。如果您可以限制或以其他方式选择性地更新行，这仅适用于 UPDATE。（或者只将 xxxx 行插入到可以加入的辅助表中。）

但是，是的，尽量不要一次更新 xx 百万行。它需要很长时间，如果发生错误，所有这些行都将回滚（这需要额外的时间。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:45:51.047

一切都取决于。

但是......**假设**您的数据库处于**单用户模式**或者**您对所有涉及的表都有表锁**（tablockx），批处理可能会执行得更差。特别是如果批处理强制执行表扫描。

需要注意的是，非常复杂的查询通常会消耗 tempdb 上的资源，如果 tempdb 空间不足（因为执行计划需要一个讨厌的复杂哈希连接），那么您将陷入大麻烦。

批量工作是 SQL Server 中经常使用的一种常规做法（当它不处于快照隔离模式时），以增加并发性并避免由于死锁而导致的大量事务回滚（当更新 1000 万行表时，您往往会出现大量死锁）活跃）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T16:25:15.243

当您迁移到 SQL Server 2005 或 2008 时，您将需要在 SSIS 中重做所有这些 DTS 包。我想你会惊喜地发现 SSIS 的速度有多快。

通常，在 SQL Server 2000 中，如果整个集合占用表的时间过长，您希望分批记录运行。如果您在系统上没有用处的晚上运行这些包，您可能能够通过基于集合的整个数据集的插入而侥幸逃脱。逐行总是最慢的方法，所以尽可能避免这种方法（特别是如果所有行-行-行插入都在一个巨大的事务中！）。如果您可以 24 小时不间断地访问，那么您几乎肯定需要分批运行。

# python - 在内部服务器上设置 Django（os.environ() 没有按预期工作？）

> ID：531224
> 
> 赞同：1
> 
> 时间：2009-02-10T06:18:56.067
> 
> 标签：python, django, apache

我正在尝试在内部公司服务器上设置 Django。（没有与 Internet 的外部连接。）

查看服务器设置文档，似乎“[在使用 Apache 的共享主机提供程序上运行 Django](http://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/#running-django-on-a-shared-hosting-provider-with-apache) ”方法似乎最有可能在这种情况下工作。

这是服务器信息：

*   无法安装`mod_python`
*   没有root权限
*   服务器是 SunOs 5.6
*   蟒蛇2.5
*   阿帕奇/2.0.46
*   我已经使用 --[前缀选项安装了 Django （和](http://docs.python.org/install/index.html#alternate-installation-the-home-scheme)[flup](http://trac.saddi.com/flup) ） （再次阅读我可能应该使用 --home ，但目前似乎无关紧要）

如此处所述，我已将`.htaccess`文件和文件添加到我[的](http://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/#running-django-on-a-shared-hosting-provider-with-apache)`mysite.fcgi`根 Web 目录。当我从服务器运行*mysite.fcgi*脚本时，我得到了预期的输出（正确的站点 HTML 输出）。但是，尝试从浏览器访问它时不会。

 *`PYTHONPATH`由于我使用的是前缀选项 ，因此似乎设置有问题。

我注意到，如果我从命令行运行`mysite.fcgi`而不设置`PYTHONPATH`环境变量，则会引发以下错误：

```
prompt$ python2.5 mysite.fcgi 
 ERROR:
 No module named flup   Unable to load
 the flup package.  In order to run
 django   as a FastCGI application, you
 will need to get flup from  
 http://www.saddi.com/software/flup/  
 If you've already   installed flup,
 then make sure you have it in your
 PYTHONPATH. 
```

我已将**sys.path.append(prefixpath)**和**os.environ['PYTHONPATH'] = prefixpath 添加**到`mysite.fcgi`，但是如果我在命令行上将环境变量设置为空然后运行`mysite.fcgi`​​，我仍然会收到上述错误。

以下是一些命令行结果：

```
>>> os.environ['PYTHONPATH'] = 'Null'
>>>
>>> os.system('echo $PYTHONPATH')
Null
>>> os.environ['PYTHONPATH'] = '/prefix/path'
>>>
>>> os.system('echo $PYTHONPATH')
/prefix/path
>>> exit()
prompt$ echo $PYTHONPATH
Null 
```

看起来 Python 正在设置变量 OK，但该变量仅适用于脚本内部。`os.environ['key'] = value`Flup 似乎是作为 .egg 文件分发的，我的猜测是，至少在通过`--prefix`选项安装时，egg 实现没有考虑 (?) 添加的变量。

我对 .pth 文件不太熟悉，但似乎 easy-install.pth 文件是指向 Flup 的文件：

```
import sys; sys.__plen = len(sys.path)
./setuptools-0.6c6-py2.5.egg
./flup-1.0.1-py2.5.egg
import sys; new=sys.path[sys.__plen:]; del sys.path[sys.__plen:]; p=getattr(sys,'__egginsert',0); sy
s.path[p:p]=new; sys.__egginsert = p+len(new) 
```

看起来它正在做一些时髦的事情，无论如何要编辑它或在我的代码中添加一些东西以便它会发现失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T13:10:54.207

在您的设置中，您必须指向实际的 egg 文件，而不是 egg 文件所在的目录。它应该看起来像：

```
sys.path.append('/path/to/flup/egg/flup-1.0.1-py2.5.egg') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T06:42:13.047

尝试使用名为[virtualenv](http://pypi.python.org/pypi/virtualenv)的实用程序。根据官方软件包页面，“virtualenv 是一个创建隔离 Python 环境的工具。”

它会`PYTHONPATH`为你处理好这些事情，并让正确安装 Django 和 Flup 变得容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-20T02:07:28.057

使用 site.addsitedir() 而不是 os.environ['PYTHONPATH'] 或 sys.path.append()。

site.addsitedir 解释 .pth 文件。修改 os.environ 或 sys.path 不会。反正不在 FastCGI 环境中。

```
#!/user/bin/python2.6

import site

# adds a directory to sys.path and processes its .pth files
site.addsitedir('/path/to/local/prefix/site-packages/')

# avoids permissions error writing to system egg-cache
os.environ['PYTHON_EGG_CACHE'] = '/path/to/local/prefix/egg-cache' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T06:45:31.947

要从 python 脚本修改 PYTHONPATH，您应该使用：

```
sys.path.append("prefixpath") 
```

试试这个，而不是用 os.environ() 修改。

我建议使用 mod_python 运行 Django，而不是使用 FastCGI ......

# javascript - 设计顺序：Firefox、IE，还是两者兼而有之？

> ID：531230
> 
> 赞同：9
> 
> 时间：2009-02-10T06:21:31.350
> 
> 标签：javascript, internet-explorer, firefox

在编写新的 javascript 繁重网站时，您为哪个订单或 Web 浏览器编写代码？

我可以看到这些可能的订单，但我不确定我最喜欢哪个：

1.  首先编写一个代码并让它运行良好，然后开始与其他代码一起测试并修复错误。
    *   这将允许最快速的开发（至少使用 Firefox），但我从经验中了解到，一次进行如此多的调试 IE 可能会很痛苦！
2.  同时为两者编码。换句话说，对于每个新功能，在继续之前确保它适用于两种浏览器。
    *   这似乎实际上需要更多时间，所以也许在 Firefox 中做一些功能，然后转移到 IE 来修补它们。

你们都做什么？

**编辑 1：**在这里回复几个答案。：@JQuery 用法：出于某种原因，我没想到会有这种回复，但是，既然这似乎是压倒性的接受答案，我想我应该告诉大家一个关于我的应用程序细节的更多信息。这实际上是我开始另一个问题的[DynWeb](https://stackoverflow.com/questions/521723/reflective-web-application)，并且随着我的开发，许多重要的代码似乎要求我使用 document.whatever() 而不是我能找到的任何 JQuery 或 Prototype 函数。具体来说，当动态导入变化的 CSS 时，我必须使用一些类似于：

```
var cssid = document.all ? 'rules' : 'cssRules';  //found this to take care of IE and Firefox
document.styleSheets[sheetIndex][cssid][cssRule].style[element] = value; 
```

而且我希望将来我将不得不继续使用目前不受 JQuery 或 Prototype 支持的这种原始编码。因此，虽然我通常会接受 JQuery 作为答案，但我不能，因为它不是这个特定 webapp 的解决方案。

@Wedge 和 bigmattyh：由于 webapp 应该构建其他 webapps，部分标准是它构建的任何东西在我支持的任何浏览器中看起来和功能都相同（现在我在想 Firefox 和 IE7/8 atm，也许稍后再说）。所以这是一个更有趣（也更复杂）的问题；对于特定的问题领域（css 实体、特定的 javascript 陷阱和差异等），您是否有任何站点、参考资料或见解，以及如何避免它们？我几乎可以肯定我将不得不拥有某种`isIE`变量并基于它简单地执行不同的操作，但我想尽可能避免它。

感谢您迄今为止的意见！我将在今天剩下的时间里保持开放状态，看看其他人可能要说什么，并在今晚的某个时候接受答案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T07:30:38.860

这是一个棘手的问题。我认为您需要按以下顺序工作：

**1：符合标准**

这使您最接近在每个浏览器中工作，而无需针对每个浏览器进行测试。此外，您的网站可以与任何新出现的浏览器一起使用（Chrome 就是一个很好的例子），只要它制作精良且符合标准，您就会获得巨大的好处。它还可以更轻松地调整您的网站以在特定浏览器中工作，因为流行浏览器偏离标准合规性的方式是众所周知的。

**2：支持最常用的浏览器*（适用于您的站点）***

*仔细注意互联网上浏览器使用情况与您网站上*浏览器使用情况之间的区别。在整个互联网上，IE 是最流行的浏览器，Firefox 紧随其后，而 Safari、Opera 和 Chrome 占据了其余的大部分。但是，您网站访问者的人口统计数据可能会颠倒这些数字。在迎合更精通技术的人群的网站上，Firefox 成为主流浏览器很常见，而 IE 则占少数。

**3：根据需要支持其他浏览器**

您需要非常明确地了解浏览器兼容性是您网站的运营成本这一事实，并且您需要决定在哪里划清界限。根据您网站的目的和业务模式，可能只支持最流行的浏览器，甚至是其中的一部分。另一方面，支持 Sun 下的所有内容（包括 IE5）可能是一个至关重要的业务关注点。如果您认为成本/收益比太高而无法证明它的合理性，可以有意识地决定不完全支持每个浏览器。事实上，互联网上许多最受欢迎的网站在旧版和小众浏览器中都无法正常运行。尽管您应该努力使您的网站在最不流行的浏览器中仍然可以运行，即使存在严重的外观或可用性问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T06:28:17.713

首先是火狐，然后是 IE。如果它在 FireFox 中工作，它更有可能在其他非 IE 浏览器中工作，IE 有时需要特殊的魔法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-10T06:23:09.037

使用[jQuery](http://jquery.com)并一次完成所有操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T07:12:07.250

首先为 Firefox 编写代码，但随时使用 IE 进行测试。这使您可以在出现任何怪癖时对其进行修复。首先使用 Firefox 进行测试很重要，因为它更符合标准。您应该学习如何以正确的方式编写 HTML/JS。随时修复问题，以更好地了解 IE 如何以不同方式呈现事物。

您可能不需要为添加的每个功能都使用 IE 进行测试，但要经常进行测试，以免问题相互叠加。重复使用其他浏览器/浏览器版本，以全面了解您网站的兼容性。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T09:49:19.417

我总是在 FireFox 和 IE7 上进行测试。然后修复和破坏 IE6 和其他浏览器。

如果它可以在 FireFox 上运行，它几乎肯定可以在 Opera、Safari、Chrome 等上运行，只需进行一些小的调整

IE7 和 IE6 也是如此，如果它适用于 7，则在 IE6 上获得合理的渲染不会花费太多

我通常使用 Firefox 作为我的主要开发浏览器，因为它具有出色的调试工具，并且我非常增量地编写代码，编写几行代码并每小时测试几次。但至少每隔一两个小时，我就会确保我所做的工作也适用于 IE7。

一旦我进入 IE7 导致问题的领域，我就会开始重新考虑我的工作方式，根据我的经验，修复往往会成倍增加并且很快就会失控。接受失败并继续使用更简单的设计通常会更好。

过去，我开发一些在 FireFox 上完美运行的东西，却发现它需要彻底重新考虑才能让它在 IE7 中运行，反之亦然。整理可能需要几天时间，而且可能非常令人沮丧。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T18:39:41.740

> 对于特定的问题领域（css 实体、特定的 javascript 陷阱和差异等），您是否有任何站点、参考资料或见解，以及如何避免它们？

[quirksmode](http://www.quirksmode.org/)是一个很好的资源。作者（Peter-Paul Koch，或 PPK）有很多 CSS 和 JavaScript 支持的兼容性表。他也有文章处理特定问题以及如何编写跨浏览器代码。

他们不处理 JavaScript，但[Position is Everything](http://www.positioniseverything.net/)是解决 CSS 问题（主要是 IE6）的宝贵资源。

就像其他人提到的那样，我只是使用 jQuery 来避免这些问题。如果它不支持某些东西，编写自定义插件非常容易。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T06:24:37.490

我先做IE，然后添加Firefox。

我的经验是，一旦它在 IE 中运行，它就会在 IE 中继续运行，而为什么某些东西在 Firefox 中不起作用的问题通常很容易回答。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T06:31:47.270

如果你必须为 IE6 编写代码，最令人沮丧的部分是编写 CSS 和 HTML。jQuery 和其他库使行为编码变得更容易——但你通常无法绕过这样一个事实，即 IE6 有这么多奇怪的渲染问题，以至于你会经常敲击键试图让它做 Firefox 的事情，Safari 和 Opera 第一次做对了。

所以 Javascript 并不是最难的部分。处理 HTML 和 CSS 是。根据我的经验，如果您正在使用任何相当有趣的设计，**您最好先为 IE 编码**，然后在 Firefox 上进行测试。如果你先做 IE，你可能不需要做很多调整，但如果你只在 Firefox 中编码，你肯定需要花一些时间来修改你的代码，让 IE 做你想做的事情。这就像在重复自己。这是一种痛苦。所以最好先完成它，这样你就不会浪费太多时间。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T18:36:24.150

我为两者编写代码，并编写（或使用）浏览器之间存在差异的抽象层。恕我直言，从长远来看，在跨平台环境中持续测试要容易得多。这使我无法做一些针对一种浏览器而在另一种浏览器中无法正常工作的事情：我在开发周期的早期就发现了兼容性问题。

当我做一个小改动时，我可能会先为一个浏览器做，但在我认为该功能或更改完成之前，它必须至少在 firefox 和 IE 中工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T19:07:40.737

为了最大限度地减少你现在和下游的问题，**从最坏的情况到最好的情况，在他们存在的规模上工作。**

编辑：如果您可以执行以下操作，请记住“如何通过修改后的 jQuery 元素等优雅地降级到 ie6 ......它可能会更清晰......”

因此，今天基于市场份额，它是：

1) IE 6

2) IE 7

3) 火狐

4) Safari..等。

巧合的是，浏览器的主要问题也按此顺序发生。

这意味着您的用户将面临的大多数问题都将按照该顺序和比例进行。

**在我们的团队中，我已经禁止在 Firefox 中进行初始开发测试。它必须在最薄弱的环节中生存下来，而不是最强的环节。** 不人道，我知道，但我们已经减少了 80% 的浏览器相关 bug 修复，因为 80% 的浏览器 bug 是 IE。是的，一旦我们在 IE 中发现问题，就可以使用 Firefox 中的大量调试工具。

另一方面，我们添加了 Firefox 的额外功能，仅用于奖励 Firefox 用户。一个简单的浏览器类型检查，它会处理其余的事情。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T06:34:52.613

如果您查看 Web 浏览器的市场份额，您会发现 IE 和 Firefox 位居榜首，而且彼此如此接近，因此，您应该使用 JQuery 之类的跨浏览器 Javascritp 或继续您的考虑将它们都考虑在内通过测试他们两个的方式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T07:06:38.167

我认为最好为 Firefox 设计，但就像其他人提到的那样，JavaScript 并不是最难的部分，CSS 才是最难的部分。就个人而言，我曾经同时为 FF 和 IE 编写代码，但我发现这需要更长的时间，因为您可能会在开发周期中进行重大更改，所以甚至不要同时为两者编写代码，这可能是浪费精力。

选择在哪个浏览器下开始开发时要考虑的另一件事是，您是否更熟悉 W3C 标准或其大多数用户群强加的 IE“标准”。关于 Web 标准，这是一件很有趣的事情，如果不是大多数 Web 开发人员对 IE 的标准支持不满意，但同时 IE 支持的任何代码都是 Web 的真正标准。

# c# - 动态数据模板 Silverlight 事件

> ID：531236
> 
> 赞同：1
> 
> 时间：2009-02-10T06:23:55.430
> 
> 标签：c#, silverlight, events, datatemplate

寻找有关如何仅使用代码将事件挂钩到 Silverlight 的 DataTemplate 的信息。这会使我的浏览器在渲染时崩溃。

```
private DataTemplate Create(Type type)        
{            
  DataTemplate dt = new DataTemplate();            
  string xaml = "<DataTemplate x:Name='dt' xmlns='http://schemas.microsoft.com/client/2007' xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' xmlns:basics='clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls'  >"
                + "<Border Height='135' Width='110' HorizontalAlignment='Left' VerticalAlignment='Top' Background='#7FFCFAFA' CornerRadius='5,5,5,5'>"
                + "<StackPanel Orientation='Vertical' Width='110' Height='135'>"
                + "<Image Source='{Binding Path=ThumbnailPath}' Width='64' Height='64' Margin='5'  HorizontalAlignment='Left' />"
                + "<TextBlock Text='{Binding Path=Title}' Margin='5' FontFamily='Verdana' HorizontalAlignment='Left' TextWrapping='Wrap' Foreground='#FFFAF8F8' Width='100' FontSize='9' />"
                + "<TextBlock Text='{Binding Path=FileDuration}' Margin='5' FontFamily='Verdana' HorizontalAlignment='Left' Foreground='#FFFAF8F8' Width='100' FontSize='9'/>"
                + "<StackPanel Orientation='Horizontal' Background='{x:Null}' x:Name='GridMenuBar'>"
                + "<Button ClickMode='Press' x:Name='play_buttons' HorizontalAlignment='Left' Template='{StaticResource GlassPlay}'  BorderBrush='{x:Null}' Foreground='#FFF9F7F7' Background='{x:Null}' />"
                //+ "<Button Height='Auto' HorizontalAlignment='Left' VerticalAlignment='Top' Width='Auto' Content='Button' x:Name='addPlayListItemButton' Template='{StaticResource GlassAddPlaylist}' Click='addPlayListItemButton_Click' />"
                + "</StackPanel>"
                + "</StackPanel>"
                + "</Border>"
                + "</DataTemplate>"; 
    dt = (DataTemplate)XamlReader.Load(xaml);
    return dt;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T19:50:47.147

你得到什么样的例外？您可以通过查看浏览器状态栏中的脚本错误图标来找到它。除非你的意思是这实际上完全杀死了浏览器进程。这不应该发生，但如果发生这种情况，您可以在导航到页面之前将 Visual Studio 附加到浏览器进程。

现在，我对问题所在有一些猜测。首先，您在模板中引用了一些仅存在于页面范围内的组件。例如，您的按钮引用了一个静态模板“GlassPlay”，并且它（尽管已注释掉）还引用了一个处理程序 addPlayListItemButton_Click，该处理程序将驻留在代码隐藏中。XamlReader 没有上下文来了解在哪里连接这些东西。

* * *

只是一个内部提示，用户控件不使用 XamlReader 加载自己，而是使用 Application.LoadComponent 加载。LoadComponent 确实有一些范围，但它仍然希望所有标记都作为一个单元加载，并希望它全部来自资源 URI（无法从字符串加载）。

* * *

动态数据模板是可能的，甚至引用模板之外的资源也应该没问题。我知道这在 WPF 中有效，并且在将模板添加到可视化树时会解析资源。我不肯定它在 Silverlight 中有效，但我很确定它确实有效。

点击处理程序是您最大的问题。不要尝试在标记中分配处理程序。相反，为按钮命名并使用[FindName](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.findname(VS.95).aspx)来获取按钮。从那里您可以订阅代码中的事件。

希望有帮助。

# ajax - 当我把它放在我的服务器上时，如何解决我的应用程序中的这个错误？

> ID：531239
> 
> 赞同：1
> 
> 时间：2009-02-10T06:24:41.483
> 
> 标签：ajax, asp.net-2.0

当我将 ASP.NET 应用程序部署到我的服务器时，我收到此错误： `add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"`

我已经安装了 IIS 和 AJAX，但还是会出现这个错误。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:29:01.790

您是否在服务器上安装了正确版本的 .Net。

您的应用似乎针对 System.Web.Extensions dll 的 .Net 1.1 版本。您的服务器上是否安装了此版本的框架？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T06:30:58.737

System.Web.Extensions.dll 在服务器上的位置与在客户端计算机上的位置是否相同？尝试将其复制到服务器上的解决方案 bin 目录。

# remoting - 注销 RemotingConfiguration 注销众所周知的类型

> ID：531240
> 
> 赞同：2
> 
> 时间：2009-02-10T06:24:48.923
> 
> 标签：remoting

如何取消注册 RemotingConfiguration 取消注册众所周知的类型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T21:57:50.363

这可能对你有帮助吗？

[http://www.codeproject.com/KB/dotnet/Advanced_Remoting.aspx](http://www.codeproject.com/KB/dotnet/Advanced_Remoting.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-17T18:06:06.977

尝试 ChannelServices.UnregisterChannel

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-09T18:43:29.160

我刚刚通过以下方式实现了这一目标：

```
RemotingServices.Disconnect(registeredTypeInstance); 
```

注册后使用：

```
RemotingServices.Marshal(registeredTypeInstance, name, type); 
```

有关 RemotingService.Marshal 的更多信息，请参阅此[问题](https://stackoverflow.com/questions/456628/net-remoting-how-to-access-server-application-objects-from-remotable-object)

# mysql - 使用 MEDIUMTEXT 和页面在 mySQL 中丢失数据

> ID：531242
> 
> 赞同：0
> 
> 时间：2009-02-10T06:26:42.367
> 
> 标签：mysql, concatenation, group-concat

不知何故，GROUP_CONCAT 能够将一篇文章的六个“页面”（每页存储为 TEXT）并将它们折腾到一个单独的 MEDIUMTEXT 中而不会丢失任何数据，但是有些单页文章比正常的要长（但仍然明显适合在 TEXT 数据类型中）会丢失大量数据。有谁知道怎么回事？

原始查询：

```
SET group_concat_max_len = 16000000;
UPDATE Threads t SET t.Content = (SELECT GROUP_CONCAT(a.Content ORDER
BY a.PageID SEPARATOR '<!-- pagebreak -->') FROM MSarticlepages a
WHERE a.ArticleID = t.MSthreadID GROUP BY a.ArticleID); 
```

再次感谢您花时间指导我无知的自己！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T07:01:16.387

MySQL 5.0 的参考手册（[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)）指出：

> 从 MySQL 5.0.19 开始，GROUP_CONCAT() 返回的类型始终为 VARCHAR，除非 group_concat_max_len 大于 512，在这种情况下，它返回一个 BLOB。（以前，只有当查询包含 ORDER BY 子句时，它才会返回 group_concat_max_len 大于 512 的 BLOB。）

根据此数据，返回类型将是 BLOB，而不是 MEDIUMTEXT。总的串联是否有可能超过 2^16（65536 字节），这是 BLOB 的限制？

# django - 我的 Django URL 没有显示破折号

> ID：531243
> 
> 赞同：31
> 
> 时间：2009-02-10T06:26:56.750
> 
> 标签：django, django-urls

我正在尝试制定一个与 domain.com\about-us\ 和 domain.com\home\ 匹配的网址

我有一个网址正则表达式：

```
^(?P<page>\w+)/$ 
```

但它不会将 url 与其中的 - 匹配。

我试过了

```
^(?P<page>\.)/$
^(?P<page>\*)/$ 
```

但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-10T06:32:19.513

尝试： `^(?P<page>[-\w]+)/$`

[-\w] ​​将接受 az 1-9 和破折号

# wxwidgets - 如何删除从 wxHtmlListBox 派生的类中的滚动条？

> ID：531248
> 
> 赞同：0
> 
> 时间：2009-02-10T06:30:54.917
> 
> 标签：wxwidgets

在小部件中，我有一个名为 CListCtr 的类，它派生自 wxHtmlListBox。该列表包含 100 个项目，但我只想在一页中显示 10 个项目，当我按下按钮 pagedown 时，我将获得另一个页面以显示另外 10 个项目。我不需要滚动条。但它总是在创建类时添加。如何删除或不创建滚动条？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T18:13:23.363

wxHtmlListBox 是一个专门的 wxVScrolledWindow，它自己处理滚动条。自然地，当列表中的列表项多于在客户区中同时显示的数量时，将出现滚动条。

但是请注意，没有什么可以说您的 wxHtmlListBox 需要包含所有可用项目。如果你给它足够的空间容纳 10 个项目，只需调用 SetItemCount(10) 而不是 SetItemCount(100)，你将不会得到滚动条。您可以自己处理向上翻页/向下翻页或任何其他导航键，并使 wxHtmlListBox 的内容无效。由于它是一个虚拟控件，您不需要更改任何数据，您只需在派生类的 OnGetItem() 和 OnGetItemMarkup() 方法中返回列表中的下一个或前 10 个项目。

请注意，这只是一个如何实现的想法，我认为这不是一件好事。滚动条指示存在更多数据以及用户相对于数据开始和结束的位置。不要打破用户的假设。他怎么知道向上/向下页面会滚动可见数据？

# jsp - Apache Tomcat 在第一次请求之前预编译 JSP

> ID：531254
> 
> 赞同：1
> 
> 时间：2009-02-10T06:32:12.323
> 
> 标签：jsp, tomcat

Apache Tomcat Web 服务器中是否有任何选项可以**在部署时编译 WAR 中的 JSP**，而不是第一个请求实例。

因此，当用户第一次请求它时，他不应该得到性能滞后。

我们正在使用 Apache Tomcat 5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T06:36:01.923

[http://tomcat.apache.org/tomcat-5.5-doc/jasper-howto.html](http://tomcat.apache.org/tomcat-5.5-doc/jasper-howto.html)

一个简单的谷歌搜索给了我这个答案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-02T12:08:31.673

您不能在部署时编译所有 JSP。您只能在编译时使用 ant、maven 或 gradle（或任何您喜欢的工具）等构建工具预编译它们。

# matrix - 三维矩阵：实际使用

> ID：531259
> 
> 赞同：7
> 
> 时间：2009-02-10T06:34:30.087
> 
> 标签：matrix

除了图形应用，3d 矩阵还有哪些实际应用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T06:42:52.547

作为一种数据结构，三维矩阵可能适用于一些具有三维空间数据的应用，例如 MRI 数据。

理论构造称为张量。（张量是向量和矩阵向更高维度的推广。）

[http://en.wikipedia.org/wiki/Tensor](http://en.wikipedia.org/wiki/Tensor)

编辑：其中一个维度完全有可能代表时间。例如，一个偏微分方程（一种经常用于诸如热量等随空间变化的量的模型）可能有两个空间维度和一个时间维度。它的模拟将由一个 3 维矩阵表示。

[http://en.wikipedia.org/wiki/Partial_differential_equation](http://en.wikipedia.org/wiki/Partial_differential_equation)

还有更高维矩阵的商业应用：OLAP 多维数据集就像多维电子表格。

[http://en.wikipedia.org/wiki/OLAP_cube](http://en.wikipedia.org/wiki/OLAP_cube)

在大多数情况下，维数为 3 并没有什么独特之处。矩阵可以很容易地具有更多维度，并且它仅取决于特定问题。（尽管人们希望数据是稀疏的，否则所需的内存量可能会令人望而却步。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T06:36:32.873

任何需要操作 3D 坐标集的应用程序——因此除了图形之外，还包括建模和分析。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T06:39:26.690

许多[有限元分析](http://en.wikipedia.org/wiki/Finite_element_method)方法需要三个甚至更高维的矩阵。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T20:37:16.340

很容易设计出对 3D 矩阵的需求——它与 1D、2D、4D 或 nD 矩阵一样有用。

*   随时间变化的二维数据
*   大量的物理测量（你看过温度/湿度/个人舒适度的图表吗？有趣的东西！）
*   任何物理表示（CAD/CAM/FEA）
*   一个 3 词搜索引擎（学生学习 map/reduce 与其他搜索算法）
*   网络拓扑结构
*   分形公式（可以是 nD）
*   曲线拟合、曲面分析

事实上，任何数据都可以从下方或从上方进入第三维并获得良好的结果 - 通常会将低阶数据移动到 3D 中，以查看其他信息与现有信息之间是否存在相关性。或者，可以将更高维度的表示投影到 3D 以进行可视化、简化，或者只是为了使其更容易理解而不会造成混乱。

-亚当

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-21T19:22:38.923

想象一下按国家、产品线、年份、月份和分销渠道来表示销售额。
知道了 ？恭喜，您刚刚发现了 5D 矩阵的用途！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-23T22:06:36.093

高阶马尔可夫模型将具有更高维的转换矩阵（我猜这将是一个转换张量）。例如，对于二阶马尔可夫模型，您有一个数字“立方体”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-03T17:46:22.287

a) 3x3 矩阵（rank-2 张量）？b）3个指数（rank-3张量）？

a) 许多物理特性使用 3x3 矩阵建模 - 分子极化率、变换/旋转矩阵、任何操纵 3d 矢量的量子力学算子、电化率等。

b）在处理诸如非线性光学之类的高阶物理现象时，可能会遇到诸如超极化率之类的事情，它是在电场上运行的 3 阶张量……等等。

很难确定你的意思，但两者最终在物理学中有无数的应用，计算科学花费大量时间设计算法来确定或建模这些属性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-03T18:10:32.237

图形矩阵（即变换矩阵）实际上是对矩阵的一种非常狭义的使用；矩阵数学的应用非常非常广泛。它们在统计中有很多用途，从回归求解到随机分析（查找马尔可夫矩阵，我觉得它们很酷）。在一般工程应用、求解约束方程等中有许多用途。线性规划也是如此......这个列表是无穷无尽的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-03T18:19:44.287

我的网页上有四个下拉菜单，用户从每个下拉菜单中选择一些内容，然后索引到一个四维矩阵并检索所需的答案。

它就像一个数组数组......实际上这就是 javascript 处理我的情况的方式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-03T18:24:50.303

在数据挖掘中。您需要 n 维的数据结构，但要在 3D 空间中显示它们，您可能需要 3D 矩阵。

# file - 如何在 Google Search Appliance 上搜索多种文件类型

> ID：531269
> 
> 赞同：6
> 
> 时间：2009-02-10T06:39:42.740
> 
> 标签：file, google-search-appliance

我想一次搜索多种文件类型。例如，当我想搜索“.htm”文件时，我将“filetype:htm”添加到查询中，效果很好。同样，“filetype:html”也可以。但是，如何指定返回所有 htm AND html 文件的查询参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T06:54:40.803

> 查询前缀文件类型：过滤结果以仅包含具有指定文件扩展名的文档。filetype: 和指定的扩展名之间不能有空格。
> 
> 您可以通过将 filetype: 项添加到搜索查询并结合布尔​​ OR 来指定多种文件类型。

[搜索协议参考](https://developers.google.com/custom-search/docs/structured_search#filetype)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-10-13T12:38:54.930

小心，有括号，它不起作用！

如果您的查询是`filetype:doc OR filetype:pdf`您将在结果中包含 .pdf 或 .doc，

但如果您键入`(filetype:doc OR filetype:pdf)`，您将只有 .doc 文件类型！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T06:56:54.290

查询文件类型：html 或文件类型：htm

# java - 应该在构造函数中放入多少代码？

> ID：531282
> 
> 赞同：21
> 
> 时间：2009-02-10T06:44:49.797
> 
> 标签：java, constructor

我在想应该在 Java 的构造函数中放入多少代码？我的意思是，您通常会创建辅助方法，在构造函数中调用这些方法，但有时会有一些较长的初始化内容，例如对于从文件读取的程序、用户界面或其他程序，您不这样做'不要只初始化实例变量，其中构造函数可能会变长（如果你不使用辅助方法）。我有一些想法，构造函数通常应该简短明了，不是吗？有例外吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T06:47:59.897

如果你遵循[SOLID](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)原则，每个班级应该有一个改变的理由（即做一件事）。因此，构造函数通常不会读取文件，但您将有一个单独的类来从文件构建对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T06:55:31.080

看看[这个 SO question](https://stackoverflow.com/questions/293967/how-much-work-should-be-done-in-a-constructor)。尽管另一个是针对 C++ 的，但概念仍然非常相似。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T06:50:21.407

只需完成对象的初始化。

如果您可以将构造函数的一部分（我的指导原则是 5 行左右）作为逻辑块或特定过程来讨论，那么为了清晰和组织目的，最好将其拆分为单独的方法。

但每一个他自己。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T08:20:19.083

我的习惯做法是，如果构造函数所要做的只是在对象上设置一些字段，那么它可以任意长。如果它变得太长，则意味着无论如何都破坏了类设计，或者需要将数据打包成一些更复杂的结构。

另一方面，如果在初始化类字段之前输入数据需要一些更复杂的处理，我倾向于将处理后的数据提供给构造函数并将处理移动到静态工厂方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T06:54:30.677

构造函数应该足够长，但不再 =)

如果你定义了多个重载的构造函数，不要重复代码；相反，将功能整合到其中之一以提高清晰度和易于维护。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T06:55:10.677

正如 Knuth 所说，“过早的优化是万恶之源。”

你应该在构造函数中投入多少？你需要的一切。这是“急切”的方法。当——并且只有当——性能成为一个问题时，您才会考虑对其进行优化（针对“懒惰”或“过度渴望”的方法）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-26T12:07:58.057

> **构造函数**就像一个*应用程序设置向导*，您只需在其中进行*配置*。如果**Instance**准备好对其自身采取任何（可能的）*Action*，那么**Constructor**做得很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T08:58:34.403

您的类可能需要初始化到某个状态，然后才能使用它完成任何有用的工作。

考虑一下。

```
public class CustomerRecord
{
    private Date dateOfBirth;

    public CustomerRecord()
    {
        dateOfBirth = new Date();
    }

    public int getYearOfBirth()
    {
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(dateOfBirth);
        return calendar.get(Calendar.YEAR);
    }   
} 
```

现在，如果您不初始化 dateOfBirth 成员变量，则任何后续调用 getYearOfBirth() 都将导致 NullPointerException。

所以可能涉及的最小初始化

1.  赋值。
2.  调用辅助函数。

确保在稍后调用其成员时该类的行为正确，这就是需要做的一切。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T07:55:47.020

构造函数应该创建对象的最小、通用实例。通用到什么程度？选择从类继承的每个实例或对象必须通过才能有效的测试用例 - 即使“有效”仅意味着正常失败（以编程方式生成的异常）。

维基百科有一个很好的描述：

[http://en.wikipedia.org/wiki/Constructor_(computer_science)](http://en.wikipedia.org/wiki/Constructor_(computer_science))

Valid 对象是构造函数的目标，valid 不一定有用 - 可以在初始化方法中完成。

# java - Websphere Portlet 迁移，DispatchAction 中缺少参数

> ID：531284
> 
> 赞同：0
> 
> 时间：2009-02-10T06:47:37.170
> 
> 标签：java, migration, struts, portlet, websphere-portal

我正在将旧的 portlet 应用程序从 WPS5 迁移到 WPS6。该应用程序正在使用 IBM 旧容器。根据迁移指南，我只更新了一些门户库和一些标签引用。该应用程序仍在使用 IBM 遗留容器和修改后的 Struts Portlet。

当我创建如下链接时：

```
<html:link page="/page1.do?method=display">Go to Page 1</html:link> 
```

该链接呈现这样的网址：

```
/wps/.../...[hash-like chars]_spf_strutsAction=!2fpage1.do!3fmethod%3ddisplay#[hash-like chars] 
```

我正在使用`DispatchAction`，它将查找参数“**方法**”以进行调度。但是，点击上面的链接无法将' **method** '参数传递给dispatchAction。对请求参数的进一步调查发现了这个键值对：

```
name: spf_strutsAction
value: !2fpage1.do!3fmethod=display 
```

所以很明显`request.getParameter('method')`返回 null 因为参数被埋在下面`request.getParameter('spf_strutsAction')`，因此无法调度动作。

当然我可以通过读取隐藏参数来强制调度动作。**但问题是除了“方法**”之外还有许多其他参数。

我认为门户服务器应该提供 PortletRequest 的实现。PortletRequest.getParameter() 是否不正确？还是 Portlet Struts 问题？如何将这些参数放回请求对象中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-06T05:56:14.170

一些想法：

1.  您可以使用 portlet 标记来生成链接。
2.  查看 IBM Portal 6.0 附带的“较新”的 struts jar
3.  考虑使用更好的 Portlet Web 框架，例如符合 jsr168 的 Spring Portlet MVC。IBM 将来不会支持它的旧 portlet 模型。

# php - php - 如何强制下载文件？

> ID：531292
> 
> 赞同：22
> 
> 时间：2009-02-10T06:51:40.577
> 
> 标签：php, download, remote-server

我希望在我的一个网站上的每个视频下方添加一个“下载此文件”功能。我需要强制用户下载文件，而不仅仅是链接到它，因为它有时会开始在浏览器中播放文件。问题是，视频文件存储在单独的服务器上。

有什么办法可以强制在 PHP 中下载？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-10T06:53:35.360

你可以尝试这样的事情：

```
$file_name = 'file.avi';
$file_url = 'http://www.myremoteserver.com/' . $file_name;
header('Content-Type: application/octet-stream');
header("Content-Transfer-Encoding: Binary"); 
header("Content-disposition: attachment; filename=\"".$file_name."\""); 
readfile($file_url);
exit; 
```

我刚刚测试了它，它对我有用。

请注意，为了`readfile`能够读取远程 url，您需要[`fopen_wrappers`](http://us.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)启用您的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-08T05:07:16.440

测试的 download.php 文件是

```
function _Download($f_location, $f_name){
  $file = uniqid() . '.pdf';

  file_put_contents($file,file_get_contents($f_location));

  header('Content-Description: File Transfer');
  header('Content-Type: application/octet-stream');
  header('Content-Length: ' . filesize($file));
  header('Content-Disposition: attachment; filename=' . basename($f_name));

  readfile($file);
}

_Download($_GET['file'], "file.pdf"); 
```

下载链接是

```
<a href="download.php?file=http://url/file.pdf"> Descargar </a> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T07:57:18.280

试试这个：

```
<?php
$FileName = '/var/ww/file.txt';
header('Content-disposition: attachment; filename="'.$FileName.'"');
readfile($FileName); 
```

关键是`header()`. 您需要将标题与下载一起发送，它将强制用户浏览器中的“保存文件”对话框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-05T22:56:54.813

```
<?php
$FileName = '/var/ww/file.txt';
header('Content-disposition: attachment; filename="'.$FileName.'"');
readfile($FileName); 
```

使用此代码。是否可以将文件名保存为您想要的名称。例如，您有 url：[http:](http://remoteserver.com/file.mp3) //remoteserver.com/file.mp3 而不是“file.mp3”，您可以使用此脚本将文件下载为“newname.mp3”吗

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-25T23:52:48.367

```
<?php

    $file_name = 'video.flv';
    $file_url = 'http://www.myserver.com/secretfilename.flv';
    header('Content-Type: application/octet-stream');
    header("Content-Transfer-Encoding: Binary"); 
    header("Content-disposition: attachment; filename=\"".$file_name."\""); 
    echo file_get_contents($file_url);
    die;

?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-20T08:21:17.703

我不知道这是否是最好的方式，但我喜欢这样，简短而简单。

如果你想在访问**URL时****下载**文件，你可以这样做

 **```
<a href="resume.pdf" download></a>
<script>document.querySelector('a').click();</script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-19T21:43:12.840

索引.php

```
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>download</title>
</head>

<body>
        <a href="download.php?file=ID_do_arquivo"> download </a>
</body>
</html> 
```

.htaccess

```
Options -Indexes
Options +FollowSymlinks
deny from all 
```

下载.php

```
$file = "pdf/teste.pdf";
 if (file_exists($file)) {
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename='.basename($file));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    exit();
} 
```

# html - 如何根据 jsp 页面生成的输出在特定位置创建 xml 文件

> ID：531304
> 
> 赞同：0
> 
> 时间：2009-02-10T06:57:06.523
> 
> 标签：html, xml, jsp

运动.jsp：

```
<?xml version="1.0" encoding="UTF-8"?>

<%@ page contentType="text/xml;charset=ISO-8859-1" %>
<% response.setHeader("Content-Disposition", "attachment; filename=\"playlist.xml\""); %>
<playlist version="1" xmlns = "http://xspf.org/ns/0/">
   <title>My Band Rocks Your Socks</title>
   <trackList>
   <%! String[] sports; %>
   <%
      sports = request.getParameterValues("sports");
      if (sports != null)
      {
         for (int i = 0; i < sports.length; i++)
         {
            // out.println (sports[i]);
            String total=sports[i];
            String[] sa=total.split("[,]");
            // String[] sub=new String();
            out.print("<track>");
            for (int j=0;j<sa.length;j++)
            {
               // out.println(sa[j]);
               // out.println("sa["+j+"]="+sa[j]);
               if( j == 0)
               {
                  out.print("<location>" + sa[0] +"</location>");
               }
               else if (j == 1)
               {
                  out.print("<image>" + sa[1] +"</image>");
               }
               else if( j==2)
               {
                  out.print("<title>" + sa[2] +"</title>");
               }
            }// end of inner for loop()
            out.print("</track>");
            //out.println();
         }// end of outer for()
      }
      //else out.println ("<b>none<b>");
   %>
   </trackList>
</playlist> 
```

此代码正在生成一个 xml 文件，但它提示我提及保存它的位置。我想在没有任何提示的情况下在特定位置创建和存储 xml 文件，并且每次下一个输入值当前 xml 文件应该被覆盖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T07:02:33.280

由于安全限制，您不能这样做。未经用户许可，您无法访问用户系统并开始写入文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T18:51:56.343

由于安全风险，您要求浏览器不希望提供的功能。您不希望浏览器能够在没有用户提示的情况下覆盖系统上的任意文件。

如果您确实需要这样做，您需要运行已签名的 Applet 或 Web Start 应用程序。有了这个，您就可以在没有用户提示的情况下进行本地写入。如果您不想购买官方证书，可以使用自签名证书对 JAR 文件进行签名。如果您这样做，用户将在遇到您的有关证书的应用程序时收到提示。但是，一旦 Applet/Web Start 应用程序运行，您就可以自由地在本地编写。

注意：您需要编辑您的问题，在 JSP 的每一行前面插入四个空格，这样 StackOverflow 就会正确自动地对其进行格式化。

# jquery - 我将如何从 jquery.autocomplete 修改此替换/正则表达式，使其仅加粗第一个匹配项？

> ID：531308
> 
> 赞同：0
> 
> 时间：2009-02-10T07:01:13.313
> 
> 标签：jquery, regex, jquery-plugins, autocomplete

我不知道如何更改以下内容，以便它只放置`<strong>`与该术语匹配的第一个找到的字符串：

```
highlight: function(value, term) {
    return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)(" + term.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\]){1}/gi, "\\$1") + ")(?![^<>]*>)(?![^&;]+;)", "gi"), "<strong>$1</strong>");
} 
```

这是来自 jQuery 自动完成插件：[http](http://docs.jquery.com/Plugins/Autocomplete) ://docs.jquery.com/Plugins/Autocomplete或[http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)

默认情况下，如果您在字段中键入“a”，以下结果将类似于“ **A** pple **A** te Ants” **，**而我只想要“ **A** pple Ate Ants”。

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T07:21:07.447

尝试将最后一个“gi”更改为“i”（“g”告诉它替换所有匹配项）。

# php - 如何生成动态 Javascript？

> ID：531311
> 
> 赞同：9
> 
> 时间：2009-02-10T07:02:57.787
> 
> 标签：php, javascript, yui

我使用 YUI 呈现页面。并且根据用户我需要更改它的呈现方式。这种变化不是可以参数化的，它对每个用户来说都是剧烈的和不同的。

请告诉我如何动态生成 Javascript？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T23:01:15.293

我个人使用 PHP 文件来传递由一些基本会话和内部设置组成的 JavaScript 对象，没有什么是关键任务，因为将信息传递给客户端并不太安全，但我相信它可能遵循与您相同的原则寻找。

同样，一旦客户端登录，我使用它来显示某些元素，尽管所有授权仍然在服务器端完成。如果我的会话处理程序允许 PHP 文件，它会使用 PHP heredoc 字符串输出一个 JavaScript 对象，否则，它不会输出任何内容。您可以使用此对象的属性进行比较，或者您可以根据 PHP 文件中的设置仅输出 JavaScript 以了解应如何呈现特定页面。

HTML：

```
<script src="common/javascript/php_feeder.php" type="text/javascript"></script> 
```

PHP：

```
//my session handler authorisation check has been removed
//although you could place your own up here.

//assuming session was authorised
//set content type header
header("content-type: application/x-javascript"); 

$js_object = <<<EOT
var my_object = {
    my_attr: '{$my_attr}',
    my_attr2: '{$my_arrt2}',
    etc: '{$etc}'
}
EOT;

print($js_object); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T07:07:37.543

您可能可以创建两个单独的 Java 脚本文件，并根据用户类型包含所需的文件。

**伪代码**

```
If user_type is One
    <Script src='one.js' type='javascript'></script>
else
    <Script src='other.js' type='javascript'></script>
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T07:09:54.743

JavaScript 有一个`eval`函数，所以我认为（我没有尝试过）您可以通过将其写入字符串变量（然后调用`eval`该字符串变量）来生成 JavaScript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T07:24:23.290

在这里进行一些详细说明肯定会帮助您获得更具描述性和有用的答案。不过请记住，您可以轻松地使用在 if 语句中声明的函数来为不同的用户提供截然不同的体验。

一个*非常*基本的例子：

```
<script>
function do_something(userType)
 {
if (userType == 'A')
 {
// everything you need to do for userType A
 }
if (userType == 'B')
 {
// everything you need to do for userType B
 }
 }
</script> 
```

# asp.net - 删除互操作的 CompilerOptions 指令

> ID：531315
> 
> 赞同：0
> 
> 时间：2009-02-10T07:05:14.397
> 
> 标签：asp.net, interop, rcw

我已经为 COM dll 创建了一个互操作，`tlbimp`并将其添加到程序集缓存中。要在 ASP.net 页面中使用它，我需要包含以下内容

```
<%@ Page Language="VB" Debug="true" CompilerOptions='/R:"C:\Program Files\blah\blah\LIBRARY.dll"'%>
<%@ Import Namespace=LIBRARY %> 
```

如果 CompilerOptions 指令位于程序集缓存中，为什么我需要它？我可以简化和集中这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T07:08:37.103

您应该能够像添加任何其他程序集引用一样添加引用。这就是 /R: 所做的一切。

编辑：如果您没有在其他地方明确构建网络应用程序，那么在 aspx 文件中使用 /R 可能是您最好的选择。您需要它的原因是 ASP.NET 正在为您有效地构建应用程序，并且*需要*告诉它要引用哪个库，即使该库在 GAC 中。这就像 Visual Studio 项目中的普通程序集引用 - 如果删除对 的引用`System.Xml`，即使该程序集在 GAC 中，您也将无法使用 XML 类。

# c# - 覆盖控制台关闭

> ID：531318
> 
> 赞同：3
> 
> 时间：2009-02-10T07:07:24.907
> 
> 标签：c#, console, overriding

我知道 GUI 有

```
private void Form1_Closing(object sender, System.ComponentModel.EventArgs e)
{
  //do stuff
}
```

但是我怎样才能在控制台应用程序中做同样的事情呢？

C#/.NET3.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T07:24:31.620

就是这样：

```
// Declare the SetConsoleCtrlHandler function
// as external and receiving a delegate.
[DllImport("Kernel32")]
public static extern bool SetConsoleCtrlHandler(HandlerRoutine Handler, bool Add);

// A delegate type to be used as the handler routine
// for SetConsoleCtrlHandler.
public delegate bool HandlerRoutine(CtrlTypes CtrlType);

// An enumerated type for the control messages
// sent to the handler routine.
public enum CtrlTypes
{
    CTRL_C_EVENT = 0,
    CTRL_BREAK_EVENT,
    CTRL_CLOSE_EVENT,
    CTRL_LOGOFF_EVENT = 5,
    CTRL_SHUTDOWN_EVENT
}

private static bool ConsoleCtrlCheck(CtrlTypes ctrlType)
{
    // Put your own handler here
    return true;
}

...

SetConsoleCtrlHandler(new HandlerRoutine(ConsoleCtrlCheck), true); 
```

# .net - 互操作和 RCW（运行时可调用包装器）有什么区别？

> ID：531322
> 
> 赞同：4
> 
> 时间：2009-02-10T07:09:13.327
> 
> 标签：.net, interop, terminology, rcw, ccw

互操作和 RCW（运行时可调用包装器）有什么区别？

只是术语吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T07:31:31.620

互操作用于调用原始 DLL 导出。

RCW（运行时可调用包装器）用于将 COM 对象公开给 .NET 类 - 即，使 COM 对象可被 .NET 代码调用。RCW 是一个 .NET 代理，它使用互操作来连接 COM 对象。

您可以将 Interop 直接用于 COM，但这只是困难的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T07:19:47.420

它们相互连接。互操作是在 .NET 中使用本机 dll 的总称。RCW 是在 .NET 中使用特定组件/类/对象所需的包装器。

# android - Android：Location.distanceTo 无法正常工作？

> ID：531324
> 
> 赞同：13
> 
> 时间：2009-02-10T07:09:49.033
> 
> 标签：android, location, distance

我在使用该`Location.distanceTo`方法计算距离时遇到问题。

```
private class MyLocationOverlay1 extends MyLocationOverlay {
    @Override
    public void drawMyLocation(Canvas canvas, MapView mapView, Location lastFix, GeoPoint myLocation, long when) 
        super.drawMyLocation(canvas,mapView,lastFix,myLocation,when);

        Location bLocation = new Location("reverseGeocoded");
        bLocation.setLatitude(FindList.gpslat);           // Value = 3.294391E7
        bLocation.setLongitude(FindList.gpslong);         // Value = -9.6564615E7
        Location aLocation = new Location("reverseGeocoded");
        aLocation.setLatitude(myLocation.getLatitudeE6());   // Value = 3.2946164E7
        aLocation.setLongitude(myLocation.getLongitudeE6()); // Value = -9.6505141E7
        aLocation.set(aLocation);    // Don't think I need this   
        bLocation.set(bLocation);    // Don't think I need this either

        int distance = (int)aLocation.distanceTo(bLocation);  // Value = 12637795 ???
        String str = " (" + String.valueOf(distance) + " meters)";
    }
} 
```

有人能告诉我为什么我的距离计算显示为 12,637,795 米吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T08:25:33.970

您应该修改行：

```
aLocation.setLatitude(myLocation.getLatitudeE6() / 1e6);
aLocation.setLongitude(myLocation.getLongitudeE6() / 1e6); 
```

并删除这些行：

```
aLocation.set(aLocation);
bLocation.set(bLocation); 
```

# c# - ASP.net AJAX 动画的多个目标控件？

> ID：531333
> 
> 赞同：1
> 
> 时间：2009-02-10T07:14:37.400
> 
> 标签：c#, asp.net, asp.net-ajax

我正在尝试将相同的动画应用于多个 TargetControlID——例如，在模式对话框中，我想在右上角有一个取消按钮*和一个小“x”图形，其中任何一个都会关闭对话框。*

编写两个相同的动画似乎很不雅，每个目标一个。我想要一个 <AnimationExtender> 并将其应用于两个控件。

明白我的意思了吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-11T04:03:46.340

动画扩展器向目标控件添加（VIA JavaScript）单击处理程序以启动动画。一种简单的方法来做你想做的事情是通过在你的第二个控件被点击时模拟对目标控件的点击。AjaxControlToolkit 包含一个可以帮助您执行此操作的函数。

将此 javascript 添加到您的页面。设置第二个控件的“onclick”以调用此函数：

```
function secondControlClick() {
    $common.tryFireEvent(yourtargetcontrol, 'click');
} 
```

让我知道这对你有什么影响。

加布里埃尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-15T10:44:49.057

听起来您想使用 UpdateProgress 控件。它可以连接到 UpdatePanel 以获取您那里的任何按钮。

（或者也许我误解了你）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-18T20:27:24.943

……两年后……

因此，诀窍在于按照您的猜测更改动画的 TargetControlId 属性。虽然它不像 jQuery 的`$["#MyControl"].hover(function {});`语法那么简单，但它可以做到。

您需要使用的 javascript 对象上有几个隐藏的属性。特别是 _onHoverOver、_animation 和 _target 属性。

例如，假设你有一个按钮，如果有人将鼠标悬停在它上面，你想调整它的大小，你需要创建你的动画扩展器和你在 onmouseover 事件中引用的几个 javascript 调用：

```
 <ajaxToolkit:AnimationExtender id="aeAnimateClaimButtons"
    runat="server" BehaviorID="showHover" TargetControlID="ctlNonExistent" >
    <Animations>
      <OnHoverOver>
        <Sequence Duration=".4">
          <Resize Width="500" Height="100" Unit="px" />
        </Sequence>
      </OnHoverOver>
      <OnHoverOut>
        <Sequence Duration=".4">
          <Resize Width="200" Height="100" Unit="px" />
        </Sequence>
      </OnHoverOut>
    </Animations>
  </ajaxToolkit:AnimationExtender> 
```

然后你需要创建你的函数：

```
 <script type="text/javascript">
    function hoverOverButton(senderId) {
      var ae = $find("aeAnimateClaimButtons");
      ae._onHoverOver._animation._target = $get(senderId);
      ae._onHoverOver.play();
    }

    function hoverOutButton(senderId) {
      var ae = $find("aeAnimateClaimButtons");
      ae._onHoverOut._animation._target = $get(senderId);
      ae._onHoverOut.play();
    }
  </script> 
```

然后你的按钮：

```
<input type="button" onmouseover="hoverOverButton(this)" onmouseout="hoverOutButton(this)" /> 
```

这里要注意一点。ctlNonExistent 可能会使您的页面抛出异常。这只是说明原理的一个例子。另外我不知道 _variables 是否会最终消失。对我来说，它们似乎不像公共 API 的东西。

# mobile - SMPP（二进制 SMS）协议死了吗？

> ID：531340
> 
> 赞同：8
> 
> 时间：2009-02-10T07:17:38.610
> 
> 标签：mobile, sms, smpp

有人处理过 SMPP 二进制 SMS 协议吗？我知道这项技术仍然被消息聚合器和运营商广泛使用，但似乎 SMPP 规范没有更新，并且对 SMPP 库的支持正在慢慢消失。“短信论坛”（[http://www.smsforum.net](http://www.smsforum.net/)）于2007年关闭。

对我来说，感觉该协议正在为 Web 服务接口而死，但我很好奇其他人的想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-13T11:45:23.940

由于 SMPP 主要由无线运营商使用，因此您的问题的答案在很大程度上取决于您所处理的市场/地区/国家。

我有与拉丁美洲无线公司合作的经验，并且可以告诉您，尽管越来越多的公司将其 SMPP 服务器隐藏在 HTTP Web 服务（为他们提供更大的灵活性）中，但 SMPP 协议仍然是连接到许多无线公司的要求，所以它肯定没有死。

如果你看看那些无线公司的内部，smpp 协议在他们的内部网络和与其他运营商的互连中非常活跃。

确实，SMPP 规范已经很久没有改变了，但这实际上并不是一件坏事。该协议已经成熟，运营商似乎对扩展它以包含新功能没有兴趣，特别是因为他们已经在自定义 HTTP API 中找到了所需的灵活性

关于 SMPP 的库实现，[Kannel](http://www.kannel.org/news.shtml)正在积极开发中，尽管我不推荐使用它。不幸的是，我看到的大多数 SMPP 客户成功的长期实施都是本土实施

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T12:11:59.920

SMPP 是一个很好的简单消息发送协议。我希望它不会因为任何基于 HTTP 的协议而消失。我同意 HTTP 协议将提供灵活性，但是，这可能意味着基于 XML 的某些变体或某些其他文本协议的胖有效负载，这将极大地影响性能/功耗。

只要 SMPP 遵循规范，它就应该很好用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T07:22:40.703

不幸的是，我们仍在使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T07:34:37.447

我们也仍在使用它，但我们正在为新项目使用 HTTP 协议来替换它！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T21:31:15.700

Ricardo Reyes 的回答几乎完全涵盖了（ [https://stackoverflow.com/a/545651/467545 ）这个问题。](https://stackoverflow.com/a/545651/467545)只是在这件事上添加我自己的经验。

### 评论二进制消息

我在一家运行 SMPP 集线器的公司工作。我们确实处理处理二进制 SMS 的业务逻辑。百分比很低，但它们存在。智能手机（例如 iPhone）可以为长消息创建二进制 SMS。我们看到了一些用例。

### 评论 SMPP 规范

SMPP 规范已经更新了好几年。我在美国还没有看到任何主要的运营商支持 SMPP 5.0 规范。几乎无处不在，它是 SMPP v3.4。对我来说，原因是：

*   SMPP v3.4 满足大多数要求。公司已经找到了绕过这些限制的方法。
*   SMS 的增长趋势趋于平缓。在这个领域花费资源可能没有意义。尽管 SMPP v5.0 没有获得太大的吸引力，但没有开发替代方案。
*   智能手机应用程序可以使用数据计划发送 SMS（不是通过 SMPP）并绕过运营商的 SMS 通信渠道。iPhone 的 iMessage 是这里最大的趋势改变者。

尽管增长趋势下降，但作为核心通信协议的基于 SMPP 的 SMS 可能会在运营商领域继续存在几十年。这完全是我个人的观察。

### 评论 SMPP 的用法

SMPP 需要有关协议的特定知识，并且需要时间和耐心来获得这些知识。它可能影响了其他替代品的兴起。

我已经看到开发人员越来越倾向于基于 HTTP 的通信。实现是自定义的。我见过：

*   使用 GET 参数的 HTTP 通信。如果需要同步确认，则调用变为阻塞，否则使用回调来报告确认。
*   使用 POST 参数的 HTTP。XML 被用来描述 SMS。
*   网络服务

一些很少使用的替代品是：

*   SMTP。从实体发送。
*   地图。用于接收。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T22:42:48.127

尽管许多 SMS 聚合器都有 HTTP API。我认为 SMPP 在您想要进行大量发送时非常有用，因为它是一个连接协议。

# javascript - 是否可以对 jQuery UI 对话框小部件的显示/隐藏方法进行更精细的控制？

> ID：531344
> 
> 赞同：4
> 
> 时间：2009-02-10T07:20:03.860
> 
> 标签：javascript, jquery, jquery-ui, dialog, effects

目前，在使用 Dialog 小部件时，我似乎只能以最基本的形式使用效果。例如，以下将使用拖放效果来显示和隐藏对话框：

```
$('#dialog').dialog({show:'drop', hide:'drop'}); 
```

但是，drop 方法的默认值总是下降到左侧。我真正想要的是让它向右下降。像这样的东西：

```
$('#dialog').dialog({
   show:{effect:'drop', direction:'right'},
   hide:{effect:'drop', direction:'right'}
}); 
```

这可能吗？

我目前正在使用 1.6rc6。我也尝试过 1.5.3（稳定），但没有任何运气。

* * *

在深入研究了源代码之后，我认为 1.5.3 和 1.6rc* 版本都不支持此功能。在支持上述功能之前，可能需要对 API 进行更改。Steerpike 找到了一个可能应该在主线中的[版本。](http://labs.cloudream.name/jquery/dialog/dialog.html)如果有人知道，请纠正我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T09:41:45.673

实际上，您可以使用任何 jQuery UI 效果；例如脉动：

```
$("#dialog").dialog({ show: "pulsate" }); 
```

有很多可以在这里找到：http: [//docs.jquery.com/UI/Effects/](http://docs.jquery.com/UI/Effects/)

请注意，它依赖于 effects.core.js。

我尝试将一个选项（就像你做的那样）传递给“显示”，它没有用。我还试图让“显示”成为一个功能，但没有运气。

然而有效的是：

```
$("a").click(function() {
    $("#dialog").hide("drop", { direction: "right" }, 1000);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T06:12:50.940

这目前在 1.6 和 1.7.1 中是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T09:10:28.183

您可能会发现此[对话框示例](http://labs.cloudream.name/jquery/dialog/dialog.html)链接很有用。尤其是右边第二个。我不确定它是否使用标准对话插件，但您应该能够从他们使用的示例中弄清楚。

# jquery - 如何使用 jQuery opacity 在容器上覆盖 div

> ID：531352
> 
> 赞同：2
> 
> 时间：2009-02-10T07:23:23.353
> 
> 标签：jquery, html, css

我有一个不透明度为 0.3 的容器

```
$('#containerFeatured').css('opacity',0.3) 
```

事实是，当我尝试用图像覆盖 DIV 包装时，不透明度会占用整个 DIV。我尝试使用 z-index 但没有任何反应。

[我的例子在这里](http://ivorbluecss.s3.amazonaws.com/index.html)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T07:43:41.027

当您指定一个元素（即 div）的不透明度时，该不透明度也将应用于其子元素。解决此问题的一个明显方法是将您的非透明内容放在 div 之外并使用 CSS 定位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:23:01.023

你可以试试这个：

```
$(document.createElement('div'))
    .width($('#containerFeatured').width())
    .height($('#containerFeatured').height())
    .css({backgroundColor:'white', opacity:0.4, position:'absolute',left:0, top:0})
    .prependTo($('#containerFeatured'))
$('#containerFeatured').css('position','relative') 
```

您可能想要更多地调整高度，但本质上，会做到这一点:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T07:53:56.183

除了将子元素移出并使用定位之外，您还可以使用 30% 不透明的 PNG 作为容器 div 的背景图像，但是您必须使用 IE6。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:57:55.500

我使用不透明的 png 作为背景，然后应用 Unit Interactives PNG 修复

[http://labs.unitinteractive.com/unitpngfix.php](http://labs.unitinteractive.com/unitpngfix.php)

我认为这是最干净、最简单的解决方案。

# java - 您可以在一个 jar 文件中添加多个 jar，然后启动该 jar 文件吗

> ID：531353
> 
> 赞同：8
> 
> 时间：2009-02-10T07:24:04.583
> 
> 标签：java, jar

我正在开发一个 GUI 应用程序，宁愿只分发一个 jar 而不是多个。

你能用清单来控制它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T07:42:08.317

另一种选择是使用自定义类加载器，例如这个：

[http://one-jar.sourceforge.net/](http://one-jar.sourceforge.net/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T07:30:48.187

将你的罐子合并到一个罐子里。看到这个[线程](https://stackoverflow.com/questions/81260/java-easiest-way-to-merge-a-release-into-one-jar-file)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T08:19:55.793

执行此操作时需要小心。如果您要合并的 jar 包含包含关键信息的清单文件 - 这些文件可能会丢失，只有最后一个文件会被合并。

例如，如果您合并 JavaMail - 清单文件很重要。如果你失去它 - 坏事就会发生。

最安全的做法是查看每个 jar 文件并检查清单文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-10T09:51:31.960

看看[这里](http://java.sun.com/developer/technicalArticles/java_warehouse/single_jar/)。使用 Netbeans 6.7.1 将多个 jar 合并为 1 个 jar

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-19T01:40:36.683

创建一个将多个罐子组合成一个罐子的阴影罐子。Maven 开箱即用地支持此功能。

[https://maven.apache.org/plugins/maven-shade-plugin/](https://maven.apache.org/plugins/maven-shade-plugin/)

# java - Eclipse 颜色主题 - java 和 flex

> ID：531358
> 
> 赞同：0
> 
> 时间：2009-02-10T07:25:02.040
> 
> 标签：java, apache-flex, eclipse, color-scheme

我使用 Eclipse 进行 Java 和 Flex 开发。最近，我更改了它的配色方案以使 java 代码看起来更好。但这以某种方式搞砸了 flex 配色方案。
是否可以使用我的新 java 配色方案和 flex 代码的默认配色方案？或者，我如何也可以编辑 flex 代码的配色方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T07:58:33.753

您可以通过 Window -> Preferences -> Flex -> Editors -> Syntax Coloring 访问 Flex 语法着色。它不应干扰位于 Window -> Preferences -> Java -> Editor -> Syntax Coloring 下的 Java 语法着色。

也许您更改了常规 -> 外观和常规 -> 编辑器下的常规字体和颜色设置，这可能会导致问题。在那里应用的设置将全局应用于所有编辑器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T08:03:12.057

能够在这篇文章的帮助下解决它：http: [//polygeek.com/302_flex_sharing-font-colors-in-flex-buildereclipse](http://polygeek.com/302_flex_changing-font-colors-in-flex-buildereclipse)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T07:35:02.687

您是否尝试过使用两个不同的工作区？每个工作区似乎都有自己的一组选项。

# java - 什么是 JUnit @Before 和 @Test

> ID：531371
> 
> 赞同：23
> 
> 时间：2009-02-10T07:34:55.807
> 
> 标签：java, junit, annotations

java中的Junit`@Before`和`@Test`注释有什么用？如何将它们与 netbeans 一起使用？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-10T07:48:25.807

你能更精确一点吗？您需要了解什么是`@Before`和`@Test`注释吗？

`@Test`annotation 是一个注释（从 JUnit 4 开始），指示附加的方法是一个单元测试。这允许您使用任何方法名称进行测试。例如：

```
@Test
public void doSomeTestOnAMethod() {
  // Your test goes here.
  ...
} 
```

`@Before`注释表明附加的方法将在类中的任何测试**之前运行。**它主要用于设置测试所需的一些对象：

*（编辑添加进口）：*

```
import static org.junit.Assert.*; // Allows you to use directly assert methods, such as assertTrue(...), assertNull(...)

import org.junit.Test; // for @Test
import org.junit.Before; // for @Before

public class MyTest {

    private AnyObject anyObject;

    @Before
    public void initObjects() {
        anyObject = new AnyObject();
    }

    @Test
    public void aTestUsingAnyObject() {
        // Here, anyObject is not null...
        assertNotNull(anyObject);
        ...
    }

} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-10T07:45:51.570

1.  如果我理解正确，您想知道注释的[`@Before`](http://junit.sourceforge.net/javadoc_40/org/junit/Before.html)含义。注释将方法标记为在*每个*测试执行之前执行。在那里您可以实施旧`setup()`程序。

2.  注释将[`@Test`](http://junit.sourceforge.net/javadoc_40/org/junit/Test.html)以下方法标记为 JUnit 测试。测试运行程序将识别每个带有注释的方法`@Test`并执行它。例子：

    ```
    import org.junit.*;

    public class IntroductionTests {
        @Test
        public void testSum() {
          Assert.assertEquals(8, 6 + 2);
        }
    } 
    ```

3.  `How can i use it with Netbeans?`在 Netbeans 中，包含用于 JUnit 测试的测试运行程序。您可以在执行对话框中选择它。

# python - 用 Python 创建 Flash 动画的方法是什么？

> ID：531377
> 
> 赞同：1
> 
> 时间：2009-02-10T07:39:57.527
> 
> 标签：python, flash

我有一组处理照片的 Python 脚本。我想要的是能够从这些图像中创建某种闪存演示。
是否有任何包或“框架”可以帮助做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T07:52:48.650

我不知道任何特定于 Python 的解决方案，但有多种工具可以处理这个问题：

您可以使用虚拟图片创建一个 Flash 文件，然后使用 mtasc、swfmill、SWF 工具或类似工具进行替换。这种方式意味着很多麻烦，但允许您创建动态闪存文件。

但是，如果您不需要动态内容，最好使用 ffmpeg 创建视频。它可以从多个图像中创建视频，因此如果您能够以某种方式在演示文稿中呈现您想要的帧，您可以使用 ffmpeg 从中制作视频。

如果您只想要图表，请使用 SWF 图表。

您可以使用具有用于创建 Flash 文件的库的外部语言。

最后还有另一种脚本语言可以编译成其他几种语言，其中 swf 是目标之一，但我现在不记得它的名字了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T08:59:48.193

您应该生成一个格式化列表，其中包含照片、路径以及演示文稿中需要的其他数据。

您加载到 SWF 中的数据，您的演示将在其中进行。

就像这样，你可以让 python 做它做的事情，并让 flash 做最好的事情。

您可能会找到适用于 Flash 画廊/幻灯片的现成解决方案。[http://airtightinteractive.com/simpleviewer/](http://airtightinteractive.com/simpleviewer/)是一个著名的。您可以在其中加载自定义 xml。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T07:51:19.527

查看[Ming](http://www.libming.org/)，它似乎有 Python 绑定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T21:55:54.090

[Ming](http://www.libming.org/)很强大，但你可能不会发现它是 pythonic 的。

我更喜欢[Haxe](https://haxe.org) for Flash 工作。（它是 MTASC 的继任者）

# java - 使用类中的方法初始化实例变量

> ID：531380
> 
> 赞同：0
> 
> 时间：2009-02-10T07:43:10.157
> 
> 标签：java, initialization, instance-variables

我可以在Java中初始化一个实例变量，当我声明它时初始化它，并使用我稍后在类中定义的方法的返回值来初始化它。

像这样的东西：

```
public class MyClass {

     integers[] myArray = new integers[length()];

     int length() {
     ....

     }
} 
```

`length()`给我一些数字，我希望这个数字确定数组中元素的数量。这对我来说似乎是合理的，但我得到`NullPointerException`（我不知道这个错误初始化是否导致异常，但我不知道究竟是什么，而且因为我以前从未做过这个初始化，我不确定它是否正确）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T07:52:03.597

对我来说似乎工作正常，使用静态或非静态方法：

```
public class test
{
    public int[] myarray = new int[this.length()];

    public int length() {
        return 5;
    }

    public static void main(String[] args)
    {
        test foo = new test();
        for (int element : foo.myarray) {
            System.out.println(element);
        }
    }
} 
```

产生：

```
0
0
0
0
0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T08:37:37.763

问题可能出在`length()`方法的某个地方。我怀疑它指的是一个尚未适当初始化的变量。这是一个程序示例，它显示：

```
public class MyClass {

    int[] myArray = new int[length()];

    // This is only initialized *after* myArray
    String myString = "Hi";

    int length() {
        return myString.length();
    }

    public static void main(String[] args) {
        new MyClass(); // Bang!
    }
} 
```

如果这*是*问题所在，我建议您改为在构造函数中进行初始化 - 这样排序会更加清晰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T07:54:38.117

在执行此操作之前，可能值得考虑此语法是否会稍微令人困惑，并且在构造函数或初始化块中初始化数组可能更合适。

```
private final int[] myArray;

public MyClass() {
    myArray = new int[length()];
} 
```

或者

```
private final int[] myArray;
{
    myArray = new int[length()];
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-02-10T07:49:56.083

您必须使方法静态：

```
static int length() { … } 
```

# python - 运行我的python脚本时添加shebang会导致没有这样的文件或目录错误

> ID：531382
> 
> 赞同：32
> 
> 时间：2009-02-10T07:43:51.980
> 
> 标签：python, shell

我正在尝试运行 python 脚本。当我运行它时它工作正常：

```
python2.5 myscript.py inpt0 
```

当我添加一个 shebang 时，问题就开始了：

```
#!/usr/bin/env python2.5 
```

导致：

```
$ myscript.py inpt0
: No such file or directory 
```

尝试2：

```
#!/usr/local/bin/python2.5 
```

导致：

```
$ myscript.py inpt0
: bad interpreter: No such file or directoryon2.5 
```

当我直接在终端中运行它们时，它们都可以正常工作：

```
$ /usr/local/bin/python2.5
Python 2.5.4 (r254:67916, Feb  9 2009, 12:50:32)
[GCC 3.2.3 20030502 (Red Hat Linux 3.2.3-52)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>>

$ /usr/bin/env python2.5
Python 2.5.4 (r254:67916, Feb  9 2009, 12:50:32)
[GCC 3.2.3 20030502 (Red Hat Linux 3.2.3-52)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

关于如何使用shebang进行这项工作的任何提示？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-02-10T07:47:12.690

我遇到了类似的问题，结果证明是行尾问题。你使用 windows/linux/mac 行尾？

编辑：忘记了脚本名称，但正如 OP 所说，它是`dos2unix <filename>`

# reporting-services - 报告服务正确的项目对齐

> ID：531383
> 
> 赞同：7
> 
> 时间：2009-02-10T07:44:09.827
> 
> 标签：reporting-services, ssrs-2008

有没有办法使项目正确对齐，比如与页面或报告中的其他项目，使用报告服务 2008 ？现在，我通过手动将项目向右移动以使它们看起来右对齐来模拟这种行为，但是，当有一个具有动态宽度的项目（例如，具有水平方向数据的tablix）时，显然，这个方法失败。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-18T09:57:43.580

不幸的是，它们在 RDL 规范中没有可用的水平对齐属性（有垂直对齐和文本对齐），所以没有最好的方法来做到这一点。

您可以使用一些技巧来使视觉效果更接近或更完美（文本框可以完美运行，tablix 更强大，并且取决于它们的许多设置）：
- 将右边缘放置在您想要的位置并将左边缘拖动到您想要的最大尺寸想要满足，将文本对齐属性设置为正确，将 CanGrow 设置为 false（在 tablix 上，您需要在列本身上执行此操作，在文本框上直接可用）：这将允许文本看起来与处理的增长正确对齐并且没有出口问题。
- 另一个技巧是将你的元素放在一个矩形中，这有助于约束它。

这些选项可以与动态生成的 RDL 或 BIDS 或 Report Builder 中的设置一起正常工作，所有选项也应如此，因为 RDL 是限制因素，而不是创建它的工具/方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-03T17:30:33.047

将页眉和页脚文本框放在[报表区域的右侧，](https://i.stack.imgur.com/smoaZ.png)远离子报表对齐方式，使它们在子报表的右侧。

# .net - 如何遍历一个类的所有属性？

> ID：531384
> 
> 赞同：171
> 
> 时间：2009-02-10T07:44:42.150
> 
> 标签：.net, vb.net, class, reflection, properties

我有一堂课。

```
Public Class Foo
    Private _Name As String
    Public Property Name() As String
        Get
            Return _Name
        End Get
        Set(ByVal value As String)
            _Name = value
        End Set
    End Property

    Private _Age As String
    Public Property Age() As String
        Get
            Return _Age
        End Get
        Set(ByVal value As String)
            _Age = value
        End Set
    End Property

    Private _ContactNumber As String
    Public Property ContactNumber() As String
        Get
            Return _ContactNumber
        End Get
        Set(ByVal value As String)
            _ContactNumber = value
        End Set
    End Property

End Class 
```

我想遍历上述类的属性。例如;

```
Public Sub DisplayAll(ByVal Someobject As Foo)
    For Each _Property As something In Someobject.Properties
        Console.WriteLine(_Property.Name & "=" & _Property.value)
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：305
> 
> 时间：2009-02-10T07:47:37.710

使用反射：

```
Type type = obj.GetType();
PropertyInfo[] properties = type.GetProperties();

foreach (PropertyInfo property in properties)
{
    Console.WriteLine("Name: " + property.Name + ", Value: " + property.GetValue(obj, null));
} 
```

对于 Excel - 必须添加哪些工具/参考项才能访问 BindingFlags，因为列表中没有“System.Reflection”条目

编辑：您还可以将 BindingFlags 值指定为`type.GetProperties()`：

```
BindingFlags flags = BindingFlags.Public | BindingFlags.Instance;
PropertyInfo[] properties = type.GetProperties(flags); 
```

这会将返回的属性限制为公共实例属性（不包括静态属性、受保护的属性等）。

您不需要指定`BindingFlags.GetProperty`，在调用时使用它`type.InvokeMember()`来获取属性的值。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-02-10T09:00:29.737

请注意，如果您正在谈论的对象具有自定义属性模型（例如`DataRowView`等`DataTable`），那么您需要使用`TypeDescriptor`; 好消息是这仍然适用于常规课程（甚至可以[比反射快得多](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)）：

```
foreach(PropertyDescriptor prop in TypeDescriptor.GetProperties(obj)) {
    Console.WriteLine("{0} = {1}", prop.Name, prop.GetValue(obj));
} 
```

`TypeConverter`这也提供了对格式化等内容的轻松访问：

```
 string fmt = prop.Converter.ConvertToString(prop.GetValue(obj)); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-02-10T07:53:47.510

Brannon 给出的 C# 的 VB 版本：

```
Public Sub DisplayAll(ByVal Someobject As Foo)
    Dim _type As Type = Someobject.GetType()
    Dim properties() As PropertyInfo = _type.GetProperties()  'line 3
    For Each _property As PropertyInfo In properties
        Console.WriteLine("Name: " + _property.Name + ", Value: " + _property.GetValue(Someobject, Nothing))
    Next
End Sub 
```

使用绑定标志代替第 3 行

```
 Dim flags As BindingFlags = BindingFlags.Public Or BindingFlags.Instance
    Dim properties() As PropertyInfo = _type.GetProperties(flags) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-11-17T12:46:16.380

反射相当“重”

也许试试这个解决方案：

C＃

```
if (item is IEnumerable) {
    foreach (object o in item as IEnumerable) {
            //do function
    }
} else {
    foreach (System.Reflection.PropertyInfo p in obj.GetType().GetProperties())      {
        if (p.CanRead) {
            Console.WriteLine("{0}: {1}", p.Name, p.GetValue(obj,  null)); //possible function
        }
    }
} 
```

VB.Net

```
 If TypeOf item Is IEnumerable Then

    For Each o As Object In TryCast(item, IEnumerable)
               'Do Function
     Next
  Else
    For Each p As System.Reflection.PropertyInfo In obj.GetType().GetProperties()
         If p.CanRead Then
               Console.WriteLine("{0}: {1}", p.Name, p.GetValue(obj, Nothing))  'possible function
          End If
      Next
  End If 
```

反射减慢了方法调用速度的 +/- 1000 倍，如[The Performance of Everyday Things中所示](http://weblogs.asp.net/craigshoemaker/archive/2008/06/17/the-performance-of-everyday-things.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-21T18:33:19.437

这是使用 LINQ lambda 的另一种方法：

C＃：

```
SomeObject.GetType().GetProperties().ToList().ForEach(x => Console.WriteLine($"{x.Name} = {x.GetValue(SomeObject, null)}")); 
```

VB.NET：

```
SomeObject.GetType.GetProperties.ToList.ForEach(Sub(x) Console.WriteLine($"{x.Name} = {x.GetValue(SomeObject, Nothing)}")) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-10-06T15:17:56.233

我就是这样做的。

```
foreach (var fi in typeof(CustomRoles).GetFields())
{
    var propertyName = fi.Name;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-22T08:17:12.343

```
private void ResetAllProperties()
    {
        Type type = this.GetType();
        PropertyInfo[] properties = (from c in type.GetProperties()
                                     where c.Name.StartsWith("Doc")
                                     select c).ToArray();
        foreach (PropertyInfo item in properties)
        {
            if (item.PropertyType.FullName == "System.String")
                item.SetValue(this, "", null);
        }
    } 
```

我使用上面的代码块来重置我的 Web 用户控件对象中的所有字符串属性，这些属性的名称以“Doc”开头。

# http - 如何检测服务器端cookie是否被禁用

> ID：531393
> 
> 赞同：95
> 
> 时间：2009-02-10T07:49:51.077
> 
> 标签：http, cookies, server-side

如何在服务器（服务器端）上检测浏览器中的 cookie 是否被禁用？是否可以？

**详细解释：**我在服务器上处理一个HTTP请求。我想通过`Set-Cookie`标题设置一个cookie。那时我需要知道 cookie 是由客户端浏览器设置，还是我设置 cookie 的请求会被忽略。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-02-10T07:54:09.007

发送带有 cookie 集的重定向响应；在处理 cookie 的（特殊）重定向 URL 测试时 - 如果它在那里重定向到正常处理，否则重定向到错误状态。

请注意，这只能告诉您浏览器允许设置 cookie，但不能告诉您设置多长时间。我的 FF 允许我强制所有 cookie 进入“会话”模式，除非该站点被明确添加到例外列表中 - 当 FF 关闭时，无论服务器指定的到期时间如何，此类 cookie 都将被丢弃。这就是我一直运行 FF 的模式。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-02-10T08:11:27.530

您可以使用 Javascript 来实现这一点

**图书馆：**

```
function createCookie(name, value, days) {
    var expires;
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toGMTString();
    }
    else expires = "";
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name, "", -1);
}

function areCookiesEnabled() {
    var r = false;
    createCookie("testing", "Hello", 1);
    if (readCookie("testing") != null) {
        r = true;
        eraseCookie("testing");
    }
    return r;
} 
```

**要运行的代码：**

```
alert(areCookiesEnabled()); 
```

**记住**

这仅在启用 Javascript 时有效！

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-10T07:56:36.240

我认为没有直接的方法可以检查。最好的方法是在 cookie 中存储一个值并尝试读取它们并决定是否启用 cookie。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-26T12:28:36.587

***下面的答案是很久以前写的。现在，无论好坏，由于不同国家/地区的法律，除非必要，否则至少在用户有机会同意此类机制之前，*不要求使用 cookie 已成为一种良好做法或法律要求。****

仅当用户尝试执行某些会启动会话的操作（例如登录或将某些内容添加到他们的购物车）时才这样做是个好主意。否则，根据您的处理方式，您可能会阻止不支持 cookie 的用户或机器人访问您的整个站点。

首先，服务器正常检查登录数据——如果登录数据错误，用户正常接收反馈。如果正确，则服务器立即响应 cookie 并重定向到旨在检查该 cookie 的页面 - 这可能只是相同的 URL，但在查询字符串中添加了一些标志。如果第二个页面没有收到 cookie，那么用户会收到一条消息，指出他们无法登录，因为 cookie 在他们的浏览器上被禁用。

如果您已经在为您的登录表单遵循 Post-Redirect-Get 模式，那么此 cookie 设置和检查不会添加任何额外的请求 - cookie 可以在现有重定向期间设置，并由加载的目的地检查重定向后。

现在解释为什么我只在用户启动的操作之后而不是在每次页面加载时进行 cookie 测试。我已经看到网站在每个页面上都实施了 cookie 测试，但没有意识到这会对尝试爬取网站的搜索引擎产生影响。也就是说，如果用户启用了 cookie，则测试 cookie 设置一次，因此他们只需要在他们请求的第一个页面上忍受重定向，从那时起就没有重定向了。但是，对于不返回 cookie 的任何浏览器或其他用户代理（如搜索引擎），每个页面都可能简单地导致重定向。

另一种检查 cookie 支持的方法是使用 Javascript——这种方式，不需要重定向——你可以写一个 cookie 并立即读回它，看看它是否被存储然后检索。这样做的缺点是它在*客户端*的脚本中运行- 即，如果您仍然希望有关是否支持 cookie 的消息返回到服务器，那么您仍然必须组织它 - 例如使用 Ajax 调用。

对于我自己的应用程序，我通过在用户登录之前在登录屏幕上设置一个包含随机令牌的 cookie 并在用户提交登录时检查该令牌来实现对“登录 CSRF”攻击（CSRF 攻击的一种变体）的一些保护细节。阅读更多关于谷歌登录 CSRF 的信息。这样做的一个副作用是，当他们登录时，我可以检查该 cookie 的存在 - 不需要额外的重定向。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T07:53:46.230

尝试将某些内容存储到 cookie 中，然后读取它。如果您没有得到您期望的结果，那么 cookie 可能已被禁用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-08T08:43:18.837

我一直用这个：

```
navigator.cookieEnabled 
```

根据[w3schools](http://www.w3schools.com/jsref/prop_nav_cookieenabled.asp) “所有主要浏览器都支持 cookieEnabled 属性。”。

但是，当我使用表单时，这对我有用，我可以指示浏览器发送附加信息。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-11-13T08:36:57.080

检查此代码，它将对您有所帮助。

```
<?php
session_start();

function visitor_is_enable_cookie() {
    $cn = 'cookie_is_enabled';
    if (isset($_COOKIE[$cn]))
        return true;
    elseif (isset($_SESSION[$cn]) && $_SESSION[$cn] === false)
        return false;

    // saving cookie ... and after it we have to redirect to get this
    setcookie($cn, '1');
    // redirect to get the cookie
    if(!isset($_GET['nocookie']))
        header("location: ".$_SERVER['REQUEST_URI'].'?nocookie') ;

    // cookie isn't availble
    $_SESSION[$cn] = false;
    return false;
}

var_dump(visitor_is_enable_cookie()); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-19T00:49:35.703

**NodeJS - 服务器端**- Cookie 检查重定向中间件 - 快速会话/Cookie 解析器

**依赖项**

```
var express = require('express'),
    cookieParser = require('cookie-parser'),
    expressSession = require('express-session') 
```

**中间件**

```
return (req, res, next) => {
  if(req.query.cookie && req.cookies.cookies_enabled)
    return res.redirect('https://yourdomain.io' + req.path)
  if(typeof(req.cookies.cookies_enabled) === 'undefined' && typeof(req.query.cookie) === 'undefined') {
    return res.cookie('cookies_enabled', true, {
      path: '/',
      domain: '.yourdomain.io',
      maxAge: 900000, 
      httpOnly: true,
      secure: process.env.NODE_ENV ? true : false
    }).redirect(req.url + '?cookie=1')
  }
  if(typeof(req.cookies.cookies_enabled) === 'undefined') {
    var target_page = 'https://yourdomain.io' + (req.url ? req.url : '')
    res.send('You must enable cookies to view this site.<br/>Once enabled, click <a href="' + target_page + '">here</a>.')
    res.end()
    return
  }
  next()
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T08:39:57.540

cookie 是否“启用”的问题太布尔了。我的浏览器 (Opera) 具有每个站点的 cookie 设置。此外，该设置不是是/否。最有用的形式实际上是“仅会话”，忽略服务器的到期日期。如果设置后直接测试它，它就会在那里。明天就不行了

此外，由于它是您可以更改的设置，因此即使测试 cookie 是否仍然存在，也只会告诉您*测试时*的设置。我可能已经决定手动接受那个 cookie。如果我不断收到垃圾邮件，我可以（有时会）关闭该网站的 cookie。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-03T15:01:41.533

如果您只想检查是否启用了会话 cookie（会话期间存在的 cookie），请在 web.config 文件中将会话模式设置为**AutoDetect**，然后 Asp.Net 框架会将 cookie 写入客户端浏览器称为**AspxAutoDetectCookieSupport**。然后，您可以在 Request.Cookies 集合中查找此 cookie，以检查客户端上是否启用了会话 cookie。

例如在您的 web.config 文件集中：

```
<sessionState cookieless="AutoDetect" /> 
```

然后检查客户端是否启用了cookie：

```
if (Request.Cookies["AspxAutoDetectCookieSupport"] != null)  { ... } 
```

**旁注：**默认情况下，它设置为 UseDeviceProfile，只要客户端***支持***它们，它就会尝试将 cookie 写入客户端，即使 cookie 被禁用。我觉得这是默认选项有点奇怪，因为它似乎毫无意义 - 会话将无法在客户端浏览器中禁用 cookie 并将其设置为 UseDeviceProfile，并且如果您支持不支持 cookie 的客户端的无 cookie 模式，那么为什么不对禁用它们的客户端使用自动检测并支持无cookie模式...

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-10-02T21:32:18.610

我正在使用上面“balexandre”答案的更简化版本。它尝试设置和读取会话 cookie，其唯一目的是确定是否启用了 cookie。是的，这也需要启用 JavaScript。所以如果你想有一个标签，你可能想要一个标签。

```
<script>
// Cookie detection
document.cookie = "testing=cookies_enabled; path=/";
if(document.cookie.indexOf("testing=cookies_enabled") < 0)
{
    // however you want to handle if cookies are disabled
    alert("Cookies disabled");
}
</script>
<noscript>
    <!-- However you like handling your no JavaScript message -->
    <h1>This site requires JavaScript.</h1>
</noscript> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-06T12:10:07.650

该`cookieEnabled`属性返回一个布尔值，指定是否在浏览器中启用 cookie

```
<script>
if (navigator.cookieEnabled) {
    // Cookies are enabled
}
else {
    // Cookies are disabled
}
</script> 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-01-19T18:19:38.327

```
<?php   session_start();
if(SID!=null){
  echo "Please enable cookie";
}
?> 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2013-02-10T22:41:07.723

使用 navigator.CookieEnabled 启用 cookie（它将返回 true 或 false）和 Html 标签 noscript。顺便说一下 navigator.cookieEnabled 是 javascript 所以不要把它输入为 HTML

# php - jQuery forms.js，每页有多个表单

> ID：531395
> 
> 赞同：2
> 
> 时间：2009-02-10T07:50:23.883
> 
> 标签：php, javascript, jquery, mysql, ajax

我想使用 php 和 ajax 向 mySql 数据库提交信息。

从 (form.php) 发送信息的页面有多个从“while()”循环生成的表单。

成功后，我会响应更新提交数据的特定表单上方的 div。

我目前正在使用 jQuery 和[jquery 表单插件](http://malsup.com/jquery/form/#getting-started)。

我已经成功地将数据输入数据库，但是我无法将响应发送回正确的 div。我已经成功地获得了对 while() 循环之外的 div 的响应。但是，我还没有成功地在循环中获得对 div 的响应。我已将代码放在一个名为的 div 下方："> 我希望放置注释的位置。

我知道这与我的 javascript 函数有关：

```
<script type="text/javascript">
jQuery(document).ready(function() {
    jQuery('form').ajaxForm({
        target: '#noteReturn',
        success: function() { $('#noteReturn').fadeIn('slow'); }
    });
});
</script> 
```

#noteReturn 函数没有指定它应该放置在哪些业务 div 中。

我希望这是有道理的。

感谢您的帮助。

代码如下：

```
<!-- the form.php page -->
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/forms.js"></script> 
<script type="text/javascript"> 
jQuery(document).ready(function() { 
    jQuery('form').ajaxForm({ 
    target: '#noteReturn',
    success: function() { 
    $('#noteReturn').fadeIn('slow'); } 
    }); 
});
</script>  
<?php
$query = mysql_query("SELECT * FROM businesses");
while( $row = mysql_fetch_assoc( $query ) ):
    $b_id = $row['bid'];
?>

<div class='notes'> 

<?php  
// query the db for notes associated with business... return notes texts and notes dates
$notesQuery = mysql_query("SELECT business_id, notes, messageDate FROM notes WHERE notes.business_id = $b_id ORDER BY messageDate");
while( $NoteRow = mysql_fetch_assoc( $notesQuery ) ) { 
extract($NoteRow); 
echo "$notes<br/><span class='noteDate'>$messageDate</span><br />"; 
}  // end while$notesQuery
?> 
<!-- this is where i would like jQuery to return the new note -->
<div id="noteReturn<?php echo $b_id; ?>"></div> 

<!-- begin note form -->
<form name="noteForm" action="notesProcess.php" method="post">
    <input type="text"  name="note" />
    <input type="hidden" value="<?php echo $b_id ?>" name="bid" />
    <input type="submit" class="button"  value="Send" />
</form>

</div> <!-- end div.notes --> 
<?php
endwhile;
?> 

<!-- /////////////////////////////////////////////////////
The page that the form submits to is this (notesProcess.php): 
///////////////////////////////////////////////////// -->
<?php
$note = $_POST['note'];
$id = $_POST['bid'];
$sql = "INSERT INTO notes (business_id, notes) VALUES ('$id', '$note')";
$result = mysql_query( $sql );
if( $result ) {
echo " $note"; }
?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T08:08:06.460

更改此代码：

```
jQuery('form').ajaxForm({ 
    target: '#noteReturn',
    success: function() { 
        $('#noteReturn').fadeIn('slow');
    } 
}); 
```

对此：

```
jQuery('form').ajaxForm({ 
    target: '#noteReturn',
    dataType: 'json',
    success: function(data) { 
        $('#noteReturn' + data.id).html(data.note).fadeIn('slow');
    } 
}); 
```

而这段代码：

```
<?php
$note = $_POST['note'];
$id = $_POST['bid'];
$sql = "INSERT INTO notes (business_id, notes) VALUES ('$id', '$note')";
$result = mysql_query( $sql );
if($result) {
    echo " $note";
}
?> 
```

对此：

```
<?php
$note = mysql_real_escape_string($_POST['note']);
$id = mysql_real_escape_string($_POST['bid']);
$sql = "INSERT INTO notes (business_id, notes) VALUES ('$id', '$note')";
$result = mysql_query( $sql );
if($result) {
    print json_encode(array("id" => $id, "note" => $note));
}
?> 
```

## 发生了什么？

对 PHP 代码的更改是利用 PHP 的[`json_encode`](http://us3.php.net/json_encode)函数打印出添加注释的企业的 id 以及实际的注释文本。在 javascript 代码中，我添加了`dataType`“json”来告诉脚本期望的响应格式。一旦在`success`回调中接收到请求，`data`变量就是一个带有我们传递的值的对象`json_encode`。`data.id`业务 ID 和`data.note`新注释也是如此。使用 jQuery 的[`html()`](http://docs.jquery.com/Attributes/html)操作功能，将 div 的内部 html 更新为最新的注释。div选择器使用我们传递的id，所以我们可以更新对应的div。

Also, this is slightly off topic, but make sure you always use [`mysql_real_escape_string`](http://us2.php.net/mysql_real_escape_string) when putting values into a query like you are. If you do not use this, your queries will be vulnerable and susceptible to injection attacks, and they are not pretty. If a customer decided to enter a note value of `');DROP TABLE businesses;` you'd really feel the pain. Preferably, switch to [`PDO`](http://us.php.net/pdo) or [`MySQLi`](http://us.php.net/mysqli) and use [`prepared statements`](http://us.php.net/manual/en/pdo.prepared-statements.php), as they are the 'correct' way of doing queries nowadays.

# c# - 处理异常与首先防止它们发生 - C#

> ID：531397
> 
> 赞同：1
> 
> 时间：2009-02-10T07:50:57.330
> 
> 标签：c#, .net-2.0, error-handling, try-catch

我有一个带日期时间的 asp:BoundColumn？asp:GridView 中的数据（我将其称为 X 列）。我遍历网格中的所有行，并将 .Text 属性转换为 X 列到 DateTime（我需要它来做一些检查并在需要时更改单元格背景颜色）。

我有两个选择：

1.  将强制转换包装在 try/catch ... 处理 FormatException （以防 X 列在其中呈现一些垃圾）... 并且仅使用有效的 DateTime 值。

2.  在大小写之前检查 X 列以确保其格式正确（如何？），并且仅在格式正确时才进行转换。

我应该采取哪种方法，为什么？

谢谢你。

**ps 1 投票赞成所有解释，接受 TryParse 的答案**

**Edit2：即使我使用了 TryParse，我也没有选中接受的答案以继续讨论。**

**我的“好数据”/“坏数据”比率约为 2/1 - 这意味着大量错误输入**

如果没有其他问题，我将在几天内重新接受答案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T07:53:43.297

你可以做第二个选项。DateTime.TryParse 可以提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T07:54:15.573

我认为这在一定程度上取决于您期望它以错误格式出现的频率。如果很少引发异常，则将某些内容包装在 try-catch 中根本不会产生任何影响。但是，如果您期望它会被提高很多，那么您应该给它添加一张支票。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T07:55:40.000

我会选择第二种选择。我*从不*对常规代码使用异常，因为这样我就可以使用 Visual Studio 选项“抛出异常时进入调试器”运行。

这在识别代码中的真正问题时为我节省了大量时间，因为调试器将停止在实际问题而不是其他地方。如果异常用于非问题问题，我无法可靠地做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T07:58:03.800

异常需要大量资源来引发和捕获。当有更优雅的选项可用时，您应该避免让它们被抛出。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T07:59:52.470

我遵循的一条规则： *始终尝试尽可能多地手动捕获错误，并将异常作为最后的手段。*

异常对性能有影响。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T14:27:32.267

需要注意的一件事是，“TryParse”不一定比在“Parse”周围有一个 Try Catch 性能更好。

这取决于你的失败率。Try-Catch 会对性能产生影响，尽管大部分影响是在您失败时。但是，如果您有 95% 甚至更高的成功率，并且性能是一个考虑因素，那么您可能需要考虑将循环包装在 try-catch 中，以便仅在出现失败。

```
int i = 0;
List<String> prePopulated;
List<DateTime> toPopulate;

while(i < prepopulated.Length)
{
   Try
   {
      while(i < prepopulated.Length)
      {
         List<DateTime>.add(DateTime.Parse(prePopulated[i]));
         i++;
      }
   }
   Catch(Exception ex)
   {
      //log if necessary
      i++;
   }
} 
```

请记住，只有当您的数据主要是干净且性能是关键时，该解决方案才会更好。否则，更简单的一行“TryParse”会更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T08:36:51.477

我同意 DateTime.TryParse。我在一个流量很大的网站上工作，我们永远不允许在 UI 中捕获异常！这有助于我们防止错误。我们非常努力地确保我们调用的代码不会抛出异常。

# iis - IHttpHandler 处理 IIS 6、IIS 7 和 ASP.NET 开发服务器中的所有 URL 扩展

> ID：531402
> 
> 赞同：0
> 
> 时间：2009-02-10T07:53:06.810
> 
> 标签：iis, url, ihttphandler, asp.net-development-serv

我们有一个负责文件下载的自定义 IHttpHandler。处理程序映射到 URL /downloadfile.rem

浏览器将用户重定向到格式如下的 URL：
/downloadfile.rem/[fileID]/[mimeType]/[fileName].[extension]
示例：
/downloadfile.rem/54923876129874545456621/text$plain/data.txt

我们的处理程序从 URL 获取提供的信息并使用文件数据进行响应。

此方法在 IIS 6 和 IIS 7 中有效，但我们遇到了 ASP.NET 开发服务器的问题。看来，IIS 6 和 IIS 7 从左到右查看 URL 并停止和“downloadfile.rem”部分并正确调用我们的自定义处理程序。ASP.NET 开发服务器似乎从右到左查看 URL，并根据 URL 末尾的扩展名决定如何处理文件。这给出了 404 响应。当我们从 URL 的末尾删除扩展名时，一切都按预期工作。

这是我们在 httpHandlers 部分的条目：

> <add verb="GET" path="downloadfile.rem" type="OurNamespace.DownloadFileHandler"/>

这是我们在处理程序部分的条目：

> <add name="DownloadFile" verb="GET" path="downloadfile.rem" type="OurNamespace.DownloadFileHandler"/>

**如何使其在 ASP.NET 开发服务器中正常工作？**

> 基本原理 - 为什么我们这样做？
> 下载文件是 Ajax 请求的结果动态生成的。由于是Ajax请求，我们不能直接将文件返回给浏览器，而是存储在磁盘上供浏览器稍后请求。服务器端的文件名是文件内容的 SHA-1（不带扩展名）。 我们可以简单地让浏览器向/downloadfile.rem?fileID=37452834576542345676234?mimeType=text$plain?fileName=data.csv之
> 类的 URL 发送 GET 请求， 然后在服务器端返回带有“附件；文件名”的 Content-Disposition 标头=...”，但是在某个版本的 IE 6（我们必须支持）中存在一个错误，它忽略了标题的文件名部分，并且将要求用户保存一个 downloadfile.rem 文件。
> 
> 因此，我们的 URL 必须以应该提供给文件的文件名结尾。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-14T10:30:31.910

好吧，我敢打赌你从来没有在开发服务器上部署过这样的 Web 应用程序，是吗？

我不知道是否有办法配置该服务器不验证链接的存在（因为该服务器发现您的链接未指向磁盘上的有效文件）。

但是，我们可以在 IIS 上轻松做到这一点。

# c# - 在类库中包含视图

> ID：531416
> 
> 赞同：2
> 
> 时间：2009-02-10T07:56:42.010
> 
> 标签：c#, asp.net, asp.net-mvc, visual-studio-2008

在[上一个问题](https://stackoverflow.com/questions/340183/plug-in-architecture-for-asp-net-mvc)中，我发现了如何为 MVC 创建插件架构。我还没有完全走这条路，但我确实有一种很好的方式来分解事情。

不过，困扰我的一件事是视图在类库中时的智能感知。在核心 MVC 项目中开发它们然后复制它们是一件痛苦的事情。

基本上我遇到的问题是我不太了解 Visual Studio 如何处理 aspx 文件。我目前处于 Beta 版，我想我可能能够利用 RC1 附带的显式视图构建。

任何帮助，将不胜感激。

更新：

我在实际运行时整理了所有视图的发现，它在我感兴趣的 Visual Studio 中对其进行编辑。它们必须在 Web 类型的项目中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T06:05:38.787

视图可以在任何你喜欢的地方。有一个 ViewLocator，您可以替换它并将它们放在您喜欢的任何地方：http: [//blogs.teamb.com/craigstuntz/2008/07/31/37827/](http://blogs.teamb.com/craigstuntz/2008/07/31/37827/)。

如果它让您满意，您可以将它们放入二进制文件或数据库中。

# android - 如何在首选项摘要中显示 Android 首选项的当前值？

> ID：531427
> 
> 赞同：473
> 
> 时间：2009-02-10T08:02:50.933
> 
> 标签：android, user-interface, android-preferences

这必须经常出现。

当用户在 Android 应用程序中编辑首选项时，我希望他们能够在`Preference`摘要中看到当前设置的首选项值。

示例：如果我有一个“丢弃旧邮件”的首选项设置，它指定了邮件需要在多少天后被清理。在`PreferenceActivity`我希望用户看到：

*“丢弃旧消息”* <- 标题

***“在x**天后清理邮件*” <-[摘要](http://code.google.com/android/reference/android/preference/Preference.html#setSummary(java.lang.CharSequence))，其中**x**是当前的首选项值

额外的功劳：使其可重用，因此我可以轻松地将其应用于我的所有偏好，而不管它们的类型如何（这样它就可以与 EditTextPreference、ListPreference 等一起使用，并且只需要最少的编码）。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2010-05-22T15:12:22.057

如果适合您的需要，有多种方法可以使其成为更通用的解决方案。

例如，如果您希望通常让所有列表首选项将其选择显示为摘要，则可以将其用于您的`onSharedPreferenceChanged`实现：

```
public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
    Preference pref = findPreference(key);

    if (pref instanceof ListPreference) {
        ListPreference listPref = (ListPreference) pref;
        pref.setSummary(listPref.getEntry());
    }
} 
```

这很容易扩展到其他偏好类。

通过使用 and 中的`getPreferenceCount`and`getPreference`功能`PreferenceScreen`，`PreferenceCategory`您可以轻松编写一个通用函数来遍历首选项树，设置您想要的类型的所有首选项的摘要以`toString`表示它们

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2010-12-01T14:15:17.833

这是我的解决方案... FWIW

```
package com.example.PrefTest;

import android.content.SharedPreferences;
import android.content.SharedPreferences.OnSharedPreferenceChangeListener;
import android.os.Bundle;
import android.preference.EditTextPreference;
import android.preference.ListPreference;
import android.preference.Preference;
import android.preference.PreferenceActivity;
import android.preference.PreferenceGroup;
import android.preference.PreferenceManager;

public class Preferences extends PreferenceActivity implements
        OnSharedPreferenceChangeListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
        PreferenceManager.setDefaultValues(Preferences.this, R.xml.preferences,
            false);
        initSummary(getPreferenceScreen());
    }

    @Override
    protected void onResume() {
        super.onResume();
        // Set up a listener whenever a key changes
        getPreferenceScreen().getSharedPreferences()
                .registerOnSharedPreferenceChangeListener(this);
    }

    @Override
    protected void onPause() {
        super.onPause();
        // Unregister the listener whenever a key changes
        getPreferenceScreen().getSharedPreferences()
                .unregisterOnSharedPreferenceChangeListener(this);
    }

    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
            String key) {
        updatePrefSummary(findPreference(key));
    }

    private void initSummary(Preference p) {
        if (p instanceof PreferenceGroup) {
            PreferenceGroup pGrp = (PreferenceGroup) p;
            for (int i = 0; i < pGrp.getPreferenceCount(); i++) {
                initSummary(pGrp.getPreference(i));
            }
        } else {
            updatePrefSummary(p);
        }
    }

    private void updatePrefSummary(Preference p) {
        if (p instanceof ListPreference) {
            ListPreference listPref = (ListPreference) p;
            p.setSummary(listPref.getEntry());
        }
        if (p instanceof EditTextPreference) {
            EditTextPreference editTextPref = (EditTextPreference) p;
            if (p.getTitle().toString().toLowerCase().contains("password"))
            {
                p.setSummary("******");
            } else {
                p.setSummary(editTextPref.getText());
            }
        }
        if (p instanceof MultiSelectListPreference) {
            EditTextPreference editTextPref = (EditTextPreference) p;
            p.setSummary(editTextPref.getText());
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：103
> 
> 时间：2012-03-30T06:47:48.977

Android[文档](http://developer.android.com/reference/android/preference/ListPreference.html#getSummary%28%29)说可以在以下位置使用字符串格式标记`getSummary()`：

> 如果摘要中有一个字符串格式标记（即“%s”或“%1$s”），那么当前条目值将被替换为它的位置。

只需`android:summary="Clean up messages after %s days"`在 ListPreference xml 声明中指定对我有用。

**注意：**这仅适用于`ListPreference`.

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2013-09-14T23:45:50.940

如果你使用`PreferenceFragment`，这就是我解决它的方法。这是不言自明的。

```
public static class SettingsFragment extends PreferenceFragment implements OnSharedPreferenceChangeListener {
    @Override
    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      addPreferencesFromResource(R.xml.settings);
      getPreferenceScreen().getSharedPreferences().registerOnSharedPreferenceChangeListener(this);
    }

    @Override
    public void onResume() {
      super.onResume();
      for (int i = 0; i < getPreferenceScreen().getPreferenceCount(); ++i) {
        Preference preference = getPreferenceScreen().getPreference(i);
        if (preference instanceof PreferenceGroup) {
          PreferenceGroup preferenceGroup = (PreferenceGroup) preference;
          for (int j = 0; j < preferenceGroup.getPreferenceCount(); ++j) {
            Preference singlePref = preferenceGroup.getPreference(j);
            updatePreference(singlePref, singlePref.getKey());
          }
        } else {
          updatePreference(preference, preference.getKey());
        }
      }
    }

    @Override
    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
      updatePreference(findPreference(key), key);
    }

    private void updatePreference(Preference preference, String key) {
      if (preference == null) return;
      if (preference instanceof ListPreference) {
        ListPreference listPreference = (ListPreference) preference;
        listPreference.setSummary(listPreference.getEntry());
        return;
      }
      SharedPreferences sharedPrefs = getPreferenceManager().getSharedPreferences();
      preference.setSummary(sharedPrefs.getString(key, "Default"));
    }
  } 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2011-11-04T03:10:13.057

我的选择是扩展 ListPreference 并且它很干净：

```
public class ListPreferenceShowSummary extends ListPreference {

    private final static String TAG = ListPreferenceShowSummary.class.getName();

    public ListPreferenceShowSummary(Context context, AttributeSet attrs) {
        super(context, attrs);
        init();
    }

    public ListPreferenceShowSummary(Context context) {
        super(context);
        init();
    }

    private void init() {

        setOnPreferenceChangeListener(new OnPreferenceChangeListener() {

            @Override
            public boolean onPreferenceChange(Preference arg0, Object arg1) {
                arg0.setSummary(getEntry());
                return true;
            }
        });
    }

    @Override
    public CharSequence getSummary() {
        return super.getEntry();
    }
} 
```

然后你添加你的 settings.xml：

```
<yourpackage.ListPreferenceShowSummary
    android:key="key" android:title="title"
    android:entries="@array/entries" android:entryValues="@array/values"
    android:defaultValue="first value"/> 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2012-07-23T09:29:28.033

您可以覆盖默认的 Preference 类并实现该功能。

```
public class MyListPreference extends ListPreference  {
    public MyListPreference(Context context) { super(context); }
    public MyListPreference(Context context, AttributeSet attrs) { super(context, attrs); }
    @Override
    public void setValue(String value) {
        super.setValue(value);
        setSummary(getEntry());
    }
} 
```

稍后在您的xml中，您可以使用自定义首选项，例如

```
<your.package.name.MyListPreference 
    android:key="noteInterval"
    android:defaultValue="60"
    android:title="Notification Interval"
    android:entries="@array/noteInterval"
    android:entryValues="@array/noteIntervalValues"
    /> 
```

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2012-06-26T15:08:18.357

几个小时后，我一直在解决这样的问题，我已经实现了这个代码：

[更新：最终版本列表]

```
public class MyPreferencesActivity extends PreferenceActivity {
    ...
    ListPreference m_updateList;
    ...
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);

        m_updateList = (ListPreference) findPreference(getString(R.string.pref_update_interval_key));
        String currentValue = m_updateList.getValue();
        if (currentValue == null) {
            m_updateList.setValue((String)m_updateList.getEntryValues()[DEFAULT_UPDATE_TIME_INDEX]);
            currentValue = m_updateList.getValue();
        }
        updateListSummary(currentValue);    

        m_updateList.setOnPreferenceChangeListener(new OnPreferenceChangeListener() {
            @Override
            public boolean onPreferenceChange(Preference preference, Object newValue) {
                updateListSummary(newValue.toString());
                return true;
            }       
        });     
    }

    private void updateListSummary(String newValue) {
        int index = m_updateList.findIndexOfValue(newValue);
        CharSequence entry = m_updateList.getEntries()[index];
        m_updateList.setSummary(entry);
    }
} 
```

那是唯一对我有用的解决方案。在我尝试从 ListPreferences 子类化并实现 android:summary="bla bla bla %s" 之前。都没有奏效。

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2014-08-01T15:09:39.167

也许像 ListPreference: 修改 getSummary 以获得你想要的：

```
package your.package.preference;

import android.content.Context;
import android.util.AttributeSet;

public class EditTextPreference extends android.preference.EditTextPreference{
        public EditTextPreference(Context context, AttributeSet attrs, int defStyle) {
            super(context, attrs, defStyle);
        }

        public EditTextPreference(Context context, AttributeSet attrs) {
            super(context, attrs);
        }

        public EditTextPreference(Context context) {
            super(context);
        }

        @Override
        public CharSequence getSummary() {
            if(super.getSummary() == null) return null;

            String summary = super.getSummary().toString();
            return String.format(summary, getText());
        }
    } 
```

并在您的 xml 中使用它：

```
<your.package.EditTextPreference
                android:key="pref_alpha"
                android:summary="Actual value: %s"
                android:title="Title"
                android:defaultValue="default"
                /> 
```

因此，您可以使用`%s`而不是实际值编写摘要。

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2010-11-10T18:14:30.353

这是将摘要设置为所选值所需的代码。它还在启动时设置值并尊重默认值，而不仅仅是在更改时。只需将“R.layout.prefs”更改为您的 xml 文件并根据您的需要扩展 setSummary 方法。它实际上只处理 ListPreferences，但很容易自定义以尊重其他 Preferences。

```
package de.koem.timetunnel;

import android.content.SharedPreferences;
import android.content.SharedPreferences.OnSharedPreferenceChangeListener;
import android.os.Bundle;
import android.preference.ListPreference;
import android.preference.Preference;
import android.preference.PreferenceActivity;
import android.preference.PreferenceGroup;

public class Prefs 
    extends PreferenceActivity 
    implements OnSharedPreferenceChangeListener {

   @Override
   protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);

       this.addPreferencesFromResource(R.layout.prefs);
       this.initSummaries(this.getPreferenceScreen());

       this.getPreferenceScreen().getSharedPreferences()
           .registerOnSharedPreferenceChangeListener(this);
    }

  /**
    * Set the summaries of all preferences
    */
  private void initSummaries(PreferenceGroup pg) {
      for (int i = 0; i < pg.getPreferenceCount(); ++i) {
          Preference p = pg.getPreference(i);
          if (p instanceof PreferenceGroup)
              this.initSummaries((PreferenceGroup) p); // recursion
          else
              this.setSummary(p);
      }
  }

  /**
    * Set the summaries of the given preference
    */
  private void setSummary(Preference pref) {
      // react on type or key
      if (pref instanceof ListPreference) {
          ListPreference listPref = (ListPreference) pref;
          pref.setSummary(listPref.getEntry());
      }
  }

  /**
    * used to change the summary of a preference
    */
  public void onSharedPreferenceChanged(SharedPreferences sp, String key) {
     Preference pref = findPreference(key);
     this.setSummary(pref);
  }

  // private static final String LOGTAG = "Prefs";
} 
```

库姆

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2014-02-20T11:46:26.560

## 对于 EditTextPreference：

```
public class MyEditTextPreference extends EditTextPreference {
    public MyEditTextPreference(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public MyEditTextPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    public void setText(String text) {
        super.setText(text);
        setSummary(text);
    }
} 
```

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2019-08-29T06:08:48.307

根据[Android 文档](https://developer.android.com/guide/topics/ui/settings/customize-your-settings#dynamically_update_summaries)，您可以`app:useSimpleSummaryProvider="true"`在 ListPreference 和 EditTextPreference 组件中使用。

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2010-09-03T18:01:02.843

实际上，[CheckBoxPreference](http://developer.android.com/reference/android/preference/CheckBoxPreference.html)确实能够根据复选框值指定不同的摘要。请参阅 android:summaryOff 和 android:summaryOn 属性（以及相应的 CheckBoxPreference 方法）。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2015-07-27T09:58:35.387

如果有人仍在寻找此问题的答案，您应该查看[三十三](https://stackoverflow.com/a/24772748/765679%20%22thirtythreeforty%22s)的答案。

```
<ListPreference
    android:key="pref_list"
    android:title="A list of preferences"
    android:summary="%s"
    android:entries="@array/pref_list_entries"
    android:entryValues="@array/pref_list_entries_values"
    android:defaultValue="0" /> 
```

> Android 会将 %s 替换为首选项的当前字符串值，如 ListPreference 的选择器所示。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2010-11-21T15:17:43.023

感谢您的提示！

我有一个首选项屏幕，并希望将每个列表首选项的值显示为摘要。

这是我现在的方式：

```
public class Preferences extends PreferenceActivity implements OnSharedPreferenceChangeListener {

@Override
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
}

@Override
protected void onResume() {
    super.onResume();

    // Set up initial values for all list preferences
    Map<String, ?> sharedPreferencesMap = getPreferenceScreen().getSharedPreferences().getAll();
    Preference pref;
    ListPreference listPref;
    for (Map.Entry<String, ?> entry : sharedPreferencesMap.entrySet()) {
        pref = findPreference(entry.getKey());
        if (pref instanceof ListPreference) {
            listPref = (ListPreference) pref;
            pref.setSummary(listPref.getEntry());
        }
    }

    // Set up a listener whenever a key changes            
    getPreferenceScreen().getSharedPreferences().registerOnSharedPreferenceChangeListener(this);
}

@Override
protected void onPause() {
    super.onPause();

    // Unregister the listener whenever a key changes            
    getPreferenceScreen().getSharedPreferences().unregisterOnSharedPreferenceChangeListener(this);    
}

public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
    Preference pref = findPreference(key);

    if (pref instanceof ListPreference) {
        ListPreference listPref = (ListPreference) pref;
        pref.setSummary(listPref.getEntry());
    }
} 
```

这对我有用，但我想知道什么是最好的解决方案（性能、稳定性、可扩展性）：Koem 展示的那个还是这个？

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2012-05-18T09:55:15.130

我已经看到所有投票的答案都显示了如何使用确切的当前值设置摘要，但 OP 还想要类似的东西：

> **“在x**天后清理邮件”* <- 摘要，其中**x**是当前首选项值

**这是我实现这一目标的答案**

根据以下[文档](http://developer.android.com/reference/android/preference/ListPreference.html#getSummary%28%29)`ListPreference.getSummary()`：

> 返回此 ListPreference 的摘要。如果摘要中有一个字符串格式标记（即“%s”或“%1$s”），那么当前条目值将被替换为它的位置。

但是，我在几个设备上尝试了这个，它似乎不起作用。通过一些研究，我在[这个答案](https://stackoverflow.com/a/7018053/824430)中找到了一个很好的解决方案。它只是包含扩展`Preference`您使用和覆盖的所有内容`getSummary()`，使其按照 Android 文档的规定工作。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2010-05-28T21:40:05.450

谢谢Reto，详细的解释！

如果这对任何人有任何帮助，我必须更改 Reto Meier 提出的代码，以使其与适用于 Android 1.5 的 SDK 一起使用

```
@Override
protected void onResume() {
    super.onResume();

    // Setup the initial values
    mListPreference.setSummary("Current value is " + mListPreference.getEntry().toString()); 

    // Set up a listener whenever a key changes            
    ...
} 
```

同样的变化也适用于回调函数`onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key)`

干杯，

克里斯

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2019-12-12T19:01:26.383

在 Android Studio 中，打开“root_preferences.xml”，选择设计模式。选择所需的 EditTextPreference 首选项，然后在“所有属性”下，查找“useSimpleSummaryProvider”属性并将其设置为 true。然后它将显示当前值。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2012-07-04T22:35:31.767

我用 ListPreference 的以下后代解决了这个问题：

```
public class EnumPreference extends ListPreference {

    public EnumPreference(Context aContext, AttributeSet attrs) {
        super(aContext,attrs);
    }

    @Override
    protected View onCreateView(ViewGroup parent) {
        setSummary(getEntry());
        return super.onCreateView(parent);
    }

    @Override
    protected boolean persistString(String aNewValue) {
        if (super.persistString(aNewValue)) {
            setSummary(getEntry());
            notifyChanged();
            return true;
        } else {
            return false;
        }
    }
} 
```

似乎在 1.6 到 4.0.4 中对我来说工作正常。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2013-04-27T12:02:37.533

```
public class ProfileManagement extends PreferenceActivity implements
OnPreferenceChangeListener {
    EditTextPreference screenName;
    ListPreference sex;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            addPreferencesFromResource(R.layout.profile_management);

            screenName = (EditTextPreference) findPreference("editTextPref");
            sex = (ListPreference) findPreference("sexSelector");

            screenName.setOnPreferenceChangeListener(this);
            sex.setOnPreferenceChangeListener(this);

    }   

    @Override
    public boolean onPreferenceChange(Preference preference, Object newValue) {
        preference.setSummary(newValue.toString());
        return true;
    }
} 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2012-12-28T04:29:53.903

如果你只想将每个字段的纯文本值显示为它的摘要，那么下面的代码应该是最容易维护的。它只需要两个更改（第 13 和 21 行，标有“此处更改”）：

```
package com.my.package;

import android.content.SharedPreferences;
import android.content.SharedPreferences.OnSharedPreferenceChangeListener;
import android.os.Bundle;
import android.preference.EditTextPreference;
import android.preference.ListPreference;
import android.preference.Preference;
import android.preference.PreferenceActivity;

public class PreferencesActivity extends PreferenceActivity implements OnSharedPreferenceChangeListener {

    private final String[] mAutoSummaryFields = { "pref_key1", "pref_key2", "pref_key3" }; // change here
    private final int mEntryCount = mAutoSummaryFields.length;
    private Preference[] mPreferenceEntries;

    @SuppressWarnings("deprecation")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences_file); // change here
        mPreferenceEntries = new Preference[mEntryCount];
        for (int i = 0; i < mEntryCount; i++) {
            mPreferenceEntries[i] = getPreferenceScreen().findPreference(mAutoSummaryFields[i]);
        }
    }

    @SuppressWarnings("deprecation")
    @Override
    protected void onResume() {
        super.onResume();
        for (int i = 0; i < mEntryCount; i++) {
            updateSummary(mAutoSummaryFields[i]); // initialization
        }
        getPreferenceScreen().getSharedPreferences().registerOnSharedPreferenceChangeListener(this); // register change listener
    }

    @SuppressWarnings("deprecation")
    @Override
    protected void onPause() {
        super.onPause();
        getPreferenceScreen().getSharedPreferences().unregisterOnSharedPreferenceChangeListener(this); // unregister change listener
    }

    private void updateSummary(String key) {
        for (int i = 0; i < mEntryCount; i++) {
            if (key.equals(mAutoSummaryFields[i])) {
                if (mPreferenceEntries[i] instanceof EditTextPreference) {
                    final EditTextPreference currentPreference = (EditTextPreference) mPreferenceEntries[i];
                    mPreferenceEntries[i].setSummary(currentPreference.getText());
                }
                else if (mPreferenceEntries[i] instanceof ListPreference) {
                    final ListPreference currentPreference = (ListPreference) mPreferenceEntries[i];
                    mPreferenceEntries[i].setSummary(currentPreference.getEntry());
                }
                break;
            }
        }
    }

    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
        updateSummary(key);
    }

} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2013-07-15T20:24:47.467

这是我的解决方案：

## 构建首选项类型的“getter”方法。

```
protected String getPreference(Preference x) {
    // http://stackoverflow.com/questions/3993982/how-to-check-type-of-variable-in-java
    if (x instanceof CheckBoxPreference)
        return "CheckBoxPreference";
    else if (x instanceof EditTextPreference)
        return "EditTextPreference";
    else if (x instanceof ListPreference)
        return "ListPreference";
    else if (x instanceof MultiSelectListPreference)
        return "MultiSelectListPreference";
    else if (x instanceof RingtonePreference)
        return "RingtonePreference";
    else if (x instanceof SwitchPreference)
        return "SwitchPreference";
    else if (x instanceof TwoStatePreference)
        return "TwoStatePreference";
    else if (x instanceof DialogPreference) // Needs to be after ListPreference
        return "DialogPreference";
    else
        return "undefined";
} 
```

## 构建一个“setSummaryInit”方法。

```
public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
        Log.i(TAG, "+ onSharedPreferenceChanged(prefs:" + prefs + ", key:" + key + ")");
        if( key != null ) {
            updatePreference(prefs, key);
            setSummary(key);
        } else {
            Log.e(TAG, "Preference without key!");
        }
        Log.i(TAG, "- onSharedPreferenceChanged()");
    }

    protected boolean setSummary() {
        return _setSummary(null);
    }

    protected boolean setSummary(String sKey) {
        return _setSummary(sKey);
    }

    private boolean _setSummary(String sKey) {
        if (sKey == null) Log.i(TAG, "Initializing");
        else Log.i(TAG, sKey);

        // Get Preferences
        SharedPreferences sharedPrefs = PreferenceManager
                .getDefaultSharedPreferences(this);

        // Iterate through all Shared Preferences
        // http://stackoverflow.com/questions/9310479/how-to-iterate-through-all-keys-of-shared-preferences
        Map<String, ?> keys = sharedPrefs.getAll();
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            String key = entry.getKey();
            // Do work only if initializing (null) or updating specific preference key
            if ( (sKey == null) || (sKey.equals(key)) ) {
                String value = entry.getValue().toString();
                Preference pref = findPreference(key);
                String preference = getPreference(pref);
                Log.d("map values", key + " | " + value + " | " + preference);
                pref.setSummary(key + " | " + value + " | " + preference);
                if (sKey != null) return true;
            }
        }
        return false;
    }

    private void updatePreference(SharedPreferences prefs, String key) {
        Log.i(TAG, "+ updatePreference(prefs:" + prefs + ", key:" + key + ")");
        Preference pref = findPreference(key);
        String preferenceType = getPreference(pref);
        Log.i(TAG, "preferenceType = " + preferenceType);
        Log.i(TAG, "- updatePreference()");
    } 
```

## 初始化

创建 PreferenceActivity 并实现 OnSharedPreferenceChangeListener 的公共类

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    PreferenceManager.setDefaultValues(this, R.xml.global_preferences,
    false);
    this.addPreferencesFromResource(R.xml.global_preferences);
    this.getPreferenceScreen().getSharedPreferences()
        .registerOnSharedPreferenceChangeListener(this);
}

protected void onResume() {
    super.onResume();
    setSummary();
} 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2015-08-06T05:05:47.763

简单地：

```
listPreference.setSummary("%s"); 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2015-09-06T20:03:31.577

供参考：

```
findPreference(CharSequence key)
This method was deprecated in API level 11\. This function is not relevant
for a modern fragment-based PreferenceActivity. 
```

更有理由看看`Answer`上面的 @ASD 非常漂亮（[来源在这里找到](https://stackoverflow.com/questions/4823442/android-list-preferences-have-summary-as-selected-value/24772748#24772748)）说使用`%s`in`android:summary`中的每个字段`preferences.xml`。（当前偏好值替换为`%s`。）

[![在此处输入图像描述](https://i.stack.imgur.com/NIC8l.png)](https://i.stack.imgur.com/NIC8l.png)

```
<ListPreference
 ...        
 android:summary="Length of longest word to return as match is %s"
 ...
 /> 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2019-02-16T11:10:05.793

由于在androidx Preference 类中有[SummaryProvider](https://developer.android.com/reference/androidx/preference/Preference.SummaryProvider)接口，它可以在没有OnSharedPreferenceChangeListener 的情况下完成。为 EditTextPreference 和 ListPreference 提供了简单的实现。基于[EddieB 的答案](https://stackoverflow.com/questions/531427/how-do-i-display-the-current-value-of-an-android-preference-in-the-preference-su/4325239#4325239)，它看起来像这样。在 androidx.preference:preference:1.1.0-alpha03 上测试。

```
package com.example.util.timereminder.ui.prefs;

import android.os.Bundle;

import com.example.util.timereminder.R;

import androidx.preference.EditTextPreference;
import androidx.preference.ListPreference;
import androidx.preference.Preference;
import androidx.preference.PreferenceFragmentCompat;
import androidx.preference.PreferenceGroup;

/**
 * Displays different preferences.
 */
public class PrefsFragmentExample extends PreferenceFragmentCompat {

    @Override
    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {
        addPreferencesFromResource(R.xml.preferences);

        initSummary(getPreferenceScreen());
    }

    /**
     * Walks through all preferences.
     *
     * @param p The starting preference to search from.
     */
    private void initSummary(Preference p) {
        if (p instanceof PreferenceGroup) {
            PreferenceGroup pGrp = (PreferenceGroup) p;
            for (int i = 0; i < pGrp.getPreferenceCount(); i++) {
                initSummary(pGrp.getPreference(i));
            }
        } else {
            setPreferenceSummary(p);
        }
    }

    /**
     * Sets up summary providers for the preferences.
     *
     * @param p The preference to set up summary provider.
     */
    private void setPreferenceSummary(Preference p) {
        // No need to set up preference summaries for checkbox preferences because
        // they can be set up in xml using summaryOff and summary On
        if (p instanceof ListPreference) {
            p.setSummaryProvider(ListPreference.SimpleSummaryProvider.getInstance());
        } else if (p instanceof EditTextPreference) {
            p.setSummaryProvider(EditTextPreference.SimpleSummaryProvider.getInstance());
        }
    }
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2013-12-14T18:07:13.397

在这里，所有这些都是从 Eclipse 示例中截取的`SettingsActivity`。我必须复制所有这些太多的代码来展示这些 android 开发人员如何完美地选择更通用和更稳定的编码风格。

我留下了适应`PreferenceActivity`平板电脑和更大 API 的代码。

```
public class SettingsActivity extends PreferenceActivity {

@Override
protected void onPostCreate(Bundle savedInstanceState) {
    super.onPostCreate(savedInstanceState);

    setupSummaryUpdatablePreferencesScreen();
}

private void setupSummaryUpdatablePreferencesScreen() {

    // In the simplified UI, fragments are not used at all and we instead
    // use the older PreferenceActivity APIs.

    // Add 'general' preferences.
    addPreferencesFromResource(R.xml.pref_general);

    // Bind the summaries of EditText/List/Dialog preferences to
    // their values. When their values change, their summaries are updated
    // to reflect the new value, per the Android Design guidelines.
    bindPreferenceSummaryToValue(findPreference("example_text"));
    bindPreferenceSummaryToValue(findPreference("example_list"));
}

/**
 * A preference value change listener that updates the preference's summary
 * to reflect its new value.
 */
private static Preference.OnPreferenceChangeListener sBindPreferenceSummaryToValueListener = new Preference.OnPreferenceChangeListener() {

    private String TAG = SettingsActivity.class.getSimpleName();

    @Override
    public boolean onPreferenceChange(Preference preference, Object value) {
        String stringValue = value.toString();

        if (preference instanceof ListPreference) {
            // For list preferences, look up the correct display value in
            // the preference's 'entries' list.
            ListPreference listPreference = (ListPreference) preference;
            int index = listPreference.findIndexOfValue(stringValue);

            // Set the summary to reflect the new value.
            preference.setSummary(
                index >= 0
                ? listPreference.getEntries()[index]
                : null);
        } else {
            // For all other preferences, set the summary to the value's
            // simple string representation.
            preference.setSummary(stringValue);
        }
        Log.i(TAG, "pref changed : " + preference.getKey() + " " + value);
        return true;
    }
};

/**
 * Binds a preference's summary to its value. More specifically, when the
 * preference's value is changed, its summary (line of text below the
 * preference title) is updated to reflect the value. The summary is also
 * immediately updated upon calling this method. The exact display format is
 * dependent on the type of preference.
 *
 * @see #sBindPreferenceSummaryToValueListener
 */

private static void bindPreferenceSummaryToValue(Preference preference) {
    // Set the listener to watch for value changes.
    preference.setOnPreferenceChangeListener(sBindPreferenceSummaryToValueListener);

    // Trigger the listener immediately with the preference's
    // current value.
    sBindPreferenceSummaryToValueListener.onPreferenceChange(preference,
                                                             PreferenceManager
                                                             .getDefaultSharedPreferences(preference.getContext())
                                                             .getString(preference.getKey(), ""));
}

} 
```

`xml/pref_general.xml`

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

<!-- NOTE: EditTextPreference accepts EditText attributes. -->
<!-- NOTE: EditTextPreference's summary should be set to its value by the activity code. -->
<EditTextPreference
android:capitalize="words"
android:defaultValue="@string/pref_default_display_name"
android:inputType="textCapWords"
android:key="example_text"
android:maxLines="1"
android:selectAllOnFocus="true"
android:singleLine="true"
android:title="@string/pref_title_display_name" />

<!-- NOTE: Hide buttons to simplify the UI. Users can touch outside the dialog todismiss it.-->
<!-- NOTE: ListPreference's summary should be set to its value by the activity code. -->
<ListPreference
android:defaultValue="-1"
android:entries="@array/pref_example_list_titles"
android:entryValues="@array/pref_example_list_values"
android:key="example_list"
android:negativeButtonText="@null"
android:positiveButtonText="@null"
android:title="@string/pref_title_add_friends_to_messages" />

</PreferenceScreen> 
```

`values/strings_activity_settings.xml`

```
<resources>
<!-- Strings related to Settings -->

<!-- Example General settings -->

<string name="pref_title_display_name">Display name</string>
<string name="pref_default_display_name">John Smith</string>

<string name="pref_title_add_friends_to_messages">Add friends to messages</string>
<string-array name="pref_example_list_titles">
<item>Always</item>
<item>When possible</item>
<item>Never</item>
</string-array>
<string-array name="pref_example_list_values">
<item>1</item>
<item>0</item>
<item>-1</item>
</string-array>
</resources> 
```

**注意：**实际上我只想评论“Google 的 PreferenceActivity 示例也很有趣”。但是我没有足够的声望点所以请不要怪我。

（抱歉英语不好）

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2016-03-19T13:42:19.320

我的解决方案是创建一个自定义的`EditTextPreference`，在 XML 中使用，如下所示：`<com.example.EditTextPreference android:title="Example Title" />`

**EditTextPreference.java** :-

```
package com.example;

import android.content.Context;
import android.util.AttributeSet;

public class EditTextPreference extends android.preference.EditTextPreference
{
    public EditTextPreference(Context context, AttributeSet attrs, int defStyle)
    {
        super(context, attrs, defStyle);
    }

    public EditTextPreference(Context context, AttributeSet attrs)
    {
        super(context, attrs);
    }

    public EditTextPreference(Context context)
    {
        super(context, null);
    }

    @Override
    protected void onDialogClosed(boolean positiveResult)
    {
        super.onDialogClosed(positiveResult);

        setSummary(getSummary());
    }

    @Override
    public CharSequence getSummary()
    {
        return getText();
    }
} 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2019-04-03T12:29:11.593

如果您使用的是 AndroidX，则可以[使用自定义`SummaryProvider`](https://developer.android.com/guide/topics/ui/settings/customize-your-settings#use_a_custom_summaryprovider). 这种方法可用于任何`Preference`.

文档中的示例（Java）：

```
EditTextPreference countingPreference = (EditTextPreference) findPreference("counting");

countingPreference.setSummaryProvider(new SummaryProvider<EditTextPreference>() {
    @Override
    public CharSequence provideSummary(EditTextPreference preference) {
        String text = preference.getText();
        if (TextUtils.isEmpty(text)){
            return "Not set";
        }
        return "Length of saved value: " + text.length();
    }
}); 
```

来自文档（Kotlin）的示例：

```
val countingPreference = findPreference("counting") as EditTextPreference

countingPreference.summaryProvider = SummaryProvider<EditTextPreference> { preference ->
    val text = preference.text
    if (TextUtils.isEmpty(text)) {
        "Not set"
    } else {
        "Length of saved value: " + text.length
    }
} 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2015-12-05T09:00:28.733

您必须在 onCreate 方法上使用 bindPreferenceSummaryToValue 函数。

例子：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // Add 'general' preferences, defined in the XML file
        addPreferencesFromResource(R.xml.pref_general);

        // For all preferences, attach an OnPreferenceChangeListener so the UI summary can be
        // updated when the preference changes.
        bindPreferenceSummaryToValue(findPreference(getString(R.string.pref_location_key)));
        bindPreferenceSummaryToValue(findPreference(getString(R.string.pref_units_key)));
    } 
```

请参阅 Udacity Android 课程的第 3 课：[https ://www.udacity.com/course/viewer#!/c-ud853/l-1474559101/e-1643578599/m-1643578601](https://www.udacity.com/course/viewer#!/c-ud853/l-1474559101/e-1643578599/m-1643578601)

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2016-01-13T11:42:38.323

对于**EditTextPreference**：

当然，我来到了这个解决方案，只是如果你需要特定的 edittextpreference 但你可以对每个 Preference 执行此操作：

…………

```
private static final String KEY_EDIT_TEXT_PREFERENCE2 = "on_a1";
public static  String value = ""; 
```

…………

```
private void updatePreference(Preference preference, String key) {

            if (key.equals(KEY_EDIT_TEXT_PREFERENCE2)) {
                preference = findPreference(key);
                if (preference instanceof EditTextPreference) {
                    editTextPreference = (EditTextPreference) preference;
                    editTextPreference.setSummary(editTextPreference.getText());
                    value = editTextPreference.getText().toString();
                    return;
                }
                SharedPreferences sharedPrefs = getPreferenceManager().getSharedPreferences();
                preference.setSummary(sharedPrefs.getString(KEY_EDIT_TEXT_PREFERENCE2, ""));

            }
} 
```

然后在 onResume();

```
@Override
        public void onResume() {
            super.onResume();

            SharedPreferences etext = getPreferenceManager().getSharedPreferences();
            String str = etext.getString("value", "");
            editTextPreference = (EditTextPreference) findPreference(KEY_EDIT_TEXT_PREFERENCE2);
            editTextPreference.setText(str);
            editTextPreference.setSummary(editTextPreference.getText());

            getPreferenceScreen().getSharedPreferences()
                    .registerOnSharedPreferenceChangeListener(this);
        } 
```

在：

```
@Override
        public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
            updatePreference(findPreference(key), key);
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2012-01-31T11:49:38.677

要将 a 的摘要设置为`ListPreference`在对话框中选择的值，您可以使用以下代码：

```
package yourpackage;

import android.content.Context;
import android.util.AttributeSet;

public class ListPreference extends android.preference.ListPreference {

    public ListPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    protected void onDialogClosed(boolean positiveResult) {
        super.onDialogClosed(positiveResult);
        if (positiveResult) setSummary(getEntry());
    }

    protected void onSetInitialValue(boolean restoreValue, Object defaultValue) {
        super.onSetInitialValue(restoreValue, defaultValue);
        setSummary(getEntry());
    }
} 
```

`yourpackage.ListPreference`并在您`preferences.xml`记住要在其中指定您的对象时引用该对象，`android:defaultValue`因为这会触发对`onSetInitialValue()`.

`setSummary()`如果您愿意，您可以在调用适合您应用程序的任何内容之前修改文本。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2017-08-10T20:45:42.717

因为我使用的是 custom `PreferenceDataStore`，所以我无法为一些添加监听器，`SharedPreference`所以我不得不编写一个有点 hacky 的解决方案来监听每个偏好：

```
class SettingsFragment : PreferenceFragmentCompat(), Preference.OnPreferenceChangeListener {
    private val handler: Handler by lazy { Handler(Looper.getMainLooper()) }

    override fun onCreatePreferences(savedInstanceState: Bundle?, rootKey: String?) {
        preferenceManager.preferenceDataStore = prefs
        addPreferencesFromResource(R.xml.app_preferences)
        onPreferenceChange(preferenceScreen, null)
    }

    override fun onPreferenceChange(preference: Preference, newValue: Any?): Boolean {
        preference.onPreferenceChangeListener = this

        when (preference) {
            is PreferenceGroup -> for (i in 0 until preference.preferenceCount) {
                onPreferenceChange(preference.getPreference(i), null)
            }
            is ListPreference -> {
                if (preference.value == null) {
                    preference.isPersistent = false
                    preference.value = Preference::class.java.getDeclaredField("mDefaultValue")
                            .apply { isAccessible = true }
                            .get(preference).toString()
                    preference.isPersistent = true
                }

                postPreferenceUpdate(Runnable { preference.summary = preference.entry })
            }
        }
        return true
    }

    /**
     * We can't directly update the preference summary update because [onPreferenceChange]'s result
     * is used to decide whether or not to update the pref value.
     */
    private fun postPreferenceUpdate(r: Runnable) = handler.post(r)
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2017-02-05T03:59:48.367

这是一个基于@tdeveaux 答案的适用于所有`EditTextPreference`s 内部的工作解决方案：`PreferenceFragment`

```
public class SettingsFragment extends PreferenceFragment implements SharedPreferences.OnSharedPreferenceChangeListener {
    private static final String TAG = "SettingsFragment";

    @Override
    public void onCreate (Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
        getPreferenceScreen().getSharedPreferences().registerOnSharedPreferenceChangeListener(this);
    }

    @Override
    public void onResume () {
        super.onResume();

        for (int i = 0; i < getPreferenceScreen().getPreferenceCount(); ++i) {
            Preference preference = getPreferenceScreen().getPreference(i);
            updatePreference(preference);
        }
    }

    @Override
    public void onSharedPreferenceChanged (SharedPreferences sharedPreferences, String key) {
        updatePreference(findPreference(key));
    }

    private void updatePreference (Preference preference) {
        if (preference instanceof EditTextPreference) {
            EditTextPreference editTextPreference = (EditTextPreference)preference;
            editTextPreference.setSummary(editTextPreference.getText());
        }
    }
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2018-05-06T13:23:28.413

我发现这种方法可以`EditTextPreference`从支持库句柄`"%s"`中总结（就像`ListPreference`已经处理的那样）：

```
public class EditTextPreference extends android.support.v7.preference.EditTextPreference {
    public EditTextPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    public void setText(String text) {
        super.setText(text);
        notifyChanged();
    }

    @Override
    public CharSequence getSummary() {
        String text = super.getText();
        String summary = super.getSummary().toString();
        return String.format(summary, text == null ? "" : text);
    }
} 
```

在 xml 中，它将如下所示：

```
<com.example.yourapp.EditTextPreference
    android:defaultValue="1"
    android:key="cleanup_period"
    android:summary="Clean up messages after %s days"
    android:title="Clean up period" /> 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2018-08-27T10:18:43.413

1行代码的简洁解决方案：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.preferences);

    bindPreferenceSummaryToValue(findPreference("mySetting"));

    // initialize summary
    sBindPreferenceSummaryToValueListener.onPreferenceChange(findPreference("mySetting"), 
        ((ListPreference) findPreference("mySetting")).getEntry());
} 
```

# asp.net - 增量或按需 sitemap.xml

> ID：531429
> 
> 赞同：0
> 
> 时间：2009-02-10T08:03:16.863
> 
> 标签：asp.net, seo, httphandler, sitemap

在阅读了[Jeff](http://www.codinghorror.com/blog/archives/001174.html)关于站点地图重要性的文章后，我决定为我的动态网站生成一个。

我看到了一些关于如何使用 ASP.NET 实现它的文章，但我看到的每个解决方案都展示了如何[使用 HTTP Handler 动态](https://stackoverflow.com/questions/9336/generate-sitemap-on-the-fly/9533#9533)生成它。

但是该解决方案意味着每次有人要求文件时，我的代码都必须迭代所有条目以重新生成一个？

增量生成它不会减少资源消耗吗？例如在 stackoverflow 上，每次用户添加问题时，都会附加新的 URL 节点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T08:09:22.870

您可能希望缓存生成的 XML，并在您的站点结构更改时使缓存无效。这可能会导致您的网站组件具有发布/订阅机制，但如果应用程序结构正确，这将不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T08:09:39.857

你的意思是缓存结果？是的，你没有理由不能这样做。根据您的网站获得的流量，这可能是不必要的，但如果您只是为了提高您的技术而这样做，那么有很多方法可以解决它。

# database - 任何用于存储过程的静态代码分析工具？

> ID：531430
> 
> 赞同：20
> 
> 时间：2009-02-10T08:04:01.620
> 
> 标签：database, tsql, stored-procedures, plsql, static-analysis

是否有任何用于[存储过程的](http://en.wikipedia.org/wiki/Stored_procedure)[静态代码分析](http://en.wikipedia.org/wiki/Static_code_analysis)工具，特别是用[PL/SQL](http://en.wikipedia.org/wiki/PL_SQL)和[T-SQL](http://en.wikipedia.org/wiki/Transact-SQL)编写的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T15:14:03.043

对于 T-SQL，Microsoft 拥有 VS Team Suite 的数据库版本（尽管我相信它现在在 dev SKU 中）。此链接讨论为 T-SQL 编写自己的静态代码分析规则：http: [//blogs.msdn.com/gertd/archive/2009/01/01/creating-t-sql-static-code-analysis-rules。 aspx](http://blogs.msdn.com/gertd/archive/2009/01/01/creating-t-sql-static-code-analysis-rules.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T11:27:54.287

Oracle 内置了一些鲜为人知的东西。

在 10g Release 2 或更高版本中试试这个：

```
ALTER SESSION PLSQL_WARNINGS = 'ENABLE:ALL'; 
```

然后编译你的 PL/SQL 包（不是匿名块）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T20:07:47.953

Toad 具有[CodeXpert](http://www.toadsoft.com/get2know9/#Xpert)实用程序来静态检查您的 PL/SQL 代码。

该实用程序可以扫描文件或直接连接到 Oracle 数据库。据我所见，仅适用于 Windows。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-02T10:12:17.567

试用免费的[Sql Code Guard](http://sqlcodeguard.com/)。它为 T-Sql 代码提供快速和全面的静态分析，显示代码复杂性和对象依赖关系

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-27T08:53:26.507

对于 PL/SQL，Toad CodeXpert 可以使用 Sonar 进行[扩展，Sonar](http://www.toadworld.com/BLOGS/tabid/67/EntryID/400/Default.aspx)是一种通过插件管理代码质量的开源工具。

我想也可以为 T-SQL 编写一个插件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T08:18:02.723

我所知道的最接近的是[SQL Server Management Studio中可用的](http://en.wikipedia.org/wiki/SQL_Server_Management_Studio)[估计和实际查询计划](http://technet.microsoft.com/en-us/library/ms178071.aspx)功能，但我猜[其他](http://www.dba-oracle.com/t_sql_execution_plan_tips.htm)SQL 引擎也有[类似](http://dev.mysql.com/doc/refman/5.1/en/explain.html)的功能。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-06T19:30:20.040

我们的[SD 源代码搜索引擎](http://www.sematnicdesigns.com/Products/SearchEngine)是一种工具，可通过源代码文件的标记（标识符、数字等）对源代码文件进行预索引，从而有效地以多种计算机语言（包括 PL/SQL）交互式搜索大型源代码库。作为预索引步骤的副作用，它为每个文件计算标准指标：SLOC、Cyclomatic、Halstead ……并生成报告。有关示例，请参见该站点。

我们的[SD CloneDR](http://www.semanticdesigns.com/Products/Clone)是一种用于分析大型代码库以查找冗余代码的工具。我们已经将它应用于 PL/SQL，并且已经看到了 45% 的代码涉及克隆。YMMV。CloneDR 适用于多种语言；请参阅站点以了解在其他一些语言上运行的示例克隆检测。

编辑 2010 年 10 月 4 日：

我们的[源代码搜索引擎](http://www.semanticdesigns.com/Products/SearchEngine)旨在实现对混合语言的大型代码进行非常快速的搜索。它通过对源代码进行预索引来成功。作为索引步骤的副作用，它计算各种指标，包括复杂性的 Cyclomatic 和 Halstead 度量。

刚刚补充：不是静态分析工具，而是对软件质量感兴趣的人普遍感兴趣的工具：我们的[TestCoverage for PLSQL 存储过程](http://www.semanticdesigns.com/Products/TestCoverage/PLSQLTestCoverage.html)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T09:34:33.553

不是我知道的。关于 PL/SQL，由于 Oracle 没有公开太多他们的 PL/SQL 编译引擎，因此很难找到工具支持。

我能做的最多的是查询数据字典来做一些事情，比如映射包依赖关系。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-24T19:08:52.420

作为 T-SQL 帖子的后续；VS2010和VS2008数据库开发版自带静态分析规则。这些是用户可扩展的，即您可以用.net 语言编写自己的分析规则。开源项目 Neznayka 带有一套初始的 22 条规则，并为您开始贡献自己的规则提供了一个有用的基础。

诚然，您必须购买 Visual Studio 并准备使用 VS 项目开发 db 代码，但最近发布的 SSDT 作为 SSMS 插件提出了微软可能的前景，如果它有这样做的意愿的话，允许将用户编写的规则分发到使用 MS SQL 项目“免费”开发数据库代码的环境。

[Neznayka](http://neznayka.codeplex.com/)的链接。

或者在网上搜索。

# .net - 如何根据属性过滤或查找属性

> ID：531431
> 
> 赞同：0
> 
> 时间：2009-02-10T08:04:14.770
> 
> 标签：.net, vb.net, reflection, properties, attributes

我有一堂课如下

```
Public Class Foo
    Private _Name As String
    <ShowInDisplay()> _
    Public Property Name() As String
        Get
            Return _Name
        End Get
        Set(ByVal value As String)
            _Name = value
        End Set
    End Property

    Private _Age As String
    Public Property Age() As String
        Get
            Return _Age
        End Get
        Set(ByVal value As String)
            _Age = value
        End Set
    End Property

    Private _ContactNumber As String
    <ShowInDisplay()> _
    Public Property ContactNumber() As String
        Get
            Return _ContactNumber
        End Get
        Set(ByVal value As String)
            _ContactNumber = value
        End Set
    End Property
End Class 
```

我只需要处理那些具有特定属性的属性，例如：ShowInDisplay

```
Public Sub DisplayOnlyPublic(ByVal Someobject As Foo)
    For Each _Property As something In Someobject.Properties
        If _Property.HasAttribute("ShowInDisplay") Then  
           Console.WriteLine(_Property.Name & "=" & _Property.value)
        End If
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T08:07:30.190

**编辑**：使用正确的 VB`GetType()`调用更新：

```
If _Property.IsDefined(GetType(ShowInDisplayAttribute), True) Then 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T08:09:09.233

除了能够使用扩展方法/lambda（无论如何在 c# 中）使其更好之外，没有比在每个可用属性上使用 MemberInfo.IsDefined 更简单的方法了。

# c# - C#：将对象添加到队列时触发事件

> ID：531438
> 
> 赞同：19
> 
> 时间：2009-02-10T08:08:09.347
> 
> 标签：c#, events, delegates, queue

**每当将对象添加到`Queue<Delegate>`.**

我创建了一个扩展的新类`Queue`：

```
public delegate void ChangedEventHandler(object sender, EventArgs e);

public class QueueWithChange<Delegate> : Queue<Delegate>
{
    public event ChangedEventHandler Changed;

    protected virtual void OnChanged(EventArgs e) {
        if (Changed != null)
        {
            Changed(this, e);
        }
    }
} 
```

然后从另一个类附加事件，如下所示：

```
QueueWithChange<TimerDelegate> eventQueue = new QueueWithChange<TimerDelegate>();

//

eventQueue.Changed += new ChangedEventHandler(delegate(object s, EventArgs ex) {
    //This event is not being triggered, so this code is unreachable atm...and that is my problem

    if (eventQueue.Count > 0)
    {
        eventQueue.Dequeue().Invoke(new DispatcherTimer() { Interval = TimeSpan.FromMilliseconds(5) });
        actionTimer.Stop();
    }
}); 
```

但是，每当我将一个对象 ( `eventQueue.Enqueue(something)`) 加入队列时，附加的事件就不会被触发。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-10T08:15:03.120

如果你的意思是非泛型`Queue`类，那么你可以覆盖`Enqueue`：

```
public override void Enqueue(object obj)
{
    base.Enqueue(obj);
    OnChanged(EventArgs.Empty);
} 
```

但是，如果您指的是泛型`Queue<T>`类，请注意没有合适的虚拟方法可以覆盖。您可能会更好地用自己的类**封装队列：**

(** 重要编辑：删除基类!!! **)

```
class Foo<T>
{
    private readonly Queue<T> queue = new Queue<T>();
    public event EventHandler Changed;
    protected virtual void OnChanged()
    {
        if (Changed != null) Changed(this, EventArgs.Empty);
    }
    public virtual void Enqueue(T item)
    {
        queue.Enqueue(item);
        OnChanged();
    }
    public int Count { get { return queue.Count; } }

    public virtual T Dequeue()
    {
        T item = queue.Dequeue();
        OnChanged();
        return item;        
    }
} 
```

但是，查看您的代码，您似乎可能在这里使用了多个线程。如果是这种情况，请考虑使用[线程队列](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-09T20:27:22.747

我刚刚写了我所谓的 TriggeredQueue。它启发了 Marc Gravell 的答案。

你可以在这里找到我的帖子：http: [//joesauve.com/triggeredqueuet](http://joesauve.com/triggeredqueuet)

这里的要点：http: [//gist.github.com/jsauve/b2e8496172fdabd370c4](https://gist.github.com/jsauve/b2e8496172fdabd370c4)

它有四个事件：

*   将入队
*   将出队
*   入队
*   出队

您可以像这样挂钩任何这些：

```
YourQueue.WillEnqueue += (sender, e) => {
    // kick off some process
};
YourQueue.DidEnqueue += (sender, e) => {
    // kick off some process
    // e.Item provides access to the enqueued item, if you like
};
YourQueue.WillDequeue += (sender, e) => {
    // kick off some process
};
YourQueue.DidDequeue += (sender, e) => {
    // kick off some process
    // e.Item provides access to the dequeued item, if you like
}; 
```

一个巧妙的技巧是，您可以使用 DidDequeue 方法启动一些进程，以通过发出 Web 请求或从文件系统加载一些数据等来确保队列已满。我在 Xamarin 移动应用程序中使用这个类来确保数据并且图像被预先缓存以提供流畅的用户体验，而不是在图像滚动到屏幕后加载图像（就像您在 Facebook 和无数其他应用程序中看到的那样）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T08:16:55.910

尝试

```
public new void Enqueue(Delegate d)
{
    base.Enqueue(d);
    OnChanged(EventArgs.Empty);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T08:11:03.600

您必须覆盖 Enqueue，才能调用 OnChanged。

# svn - 在 SVN 中存储二进制文件是否可以接受/很好？

> ID：531442
> 
> 赞同：34
> 
> 时间：2009-02-10T08:09:48.033
> 
> 标签：svn, version-control, binary

我们想共享运行时项目二进制文件。所以每个团队成员都可以使用当前的工作版本。在 SVN 中存储运行时二进制文件是否可以接受/很好？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-10T08:24:47.963

您可能希望将二进制文件存储在版本控制系统中的两个常见原因是（写于 2009 年）：

*   **存储外部第三方库**。
    通常将它们存储到 Maven 存储库中，但是将它们存储到 SVN 允许您拥有***一个且只有一个引用***来满足您的所有需求：获取源代码，并获取编译这些源代码所需的库。全部来自一个存储库。

（正如[ivorujavaboy](https://stackoverflow.com/users/2269535/ivorujavaboy)在 2017 年指出的那样：“目前这样做的唯一充分理由是，如果您拥有永远不会改变的 STATIC 库，这是非常罕见的情况”）

*   **存储交付以加快部署**。
    通常交付（您构建以部署到生产中的可执行文件）是按需构建的。
    但是，如果您有很多预生产环境，并且如果您有很多交付，那么为组装、集成、认证、预生产平台构建它们的成本可能会很高。
    一种解决方案是构建一次，将它们存储在 SVN 的交付部分，然后直接在不同的环境中使用它们。
    注意：
    这也适用于开发元素：如果您有一个生成 900 个 POJO 文件（通过 XML 绑定）的[Jaxb](http://jaxb.java.net/)进程，并且您需要在多个环境中下载该开发集，您可能需要 1 个压缩文件复制事务，而不是 900 个那些。

所以是的，出于正确的原因，“在 SVN 中存储运行时二进制文件是可以接受的/很好的”。

* * *

话虽如此：

*   [Wim Coenen](https://stackoverflow.com/users/52626/wim-coenen)正确地[提到了缺点](https://stackoverflow.com/a/4136305/6309)（不好的做法、速度慢、来源和存储交付之间的不匹配）
*   [Vladimir](https://stackoverflow.com/users/9641/vladimir)提倡[使用交付参考](https://stackoverflow.com/a/531710/6309)（Nexus 或 Vladimir 提到的[Apache ivy](http://ant.apache.org/ivy)）
*   [RogerV](https://stackoverflow.com/users/48048/rogerv)说明[了使用所述交付参考的优势](https://stackoverflow.com/a/531509/6309)（在他的案例中为 Nexus）

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-11-09T16:57:40.390

不，不要将二进制文件存储在其源代码旁边（除非您有充分的理由来抵消这些缺点）。

缺点：

*   它鼓励大型项目中的不良构建实践。最佳实践是完全自动化您的构建。提交二进制文件使您可以忽略这一点：“只需手动为已更改的部分进行构建”:-(
*   较慢的更新和提交
*   更改源代码但未更改相应二进制文件的提交会引起开发人员的混淆。您如何检测到不匹配？
*   `svn update`将更新您的二进制文件的时间戳，混淆您的构建工具，从而错误地认为二进制文件比您的源代码更改更新。
*   导致二进制文件的虚假冲突`svn update`和`svn merge`
*   它在存储库中使用更多磁盘空间。（根据您的项目，这可能可以忽略不计。）

通常，避免提交从其他版本化资源以确定性方式自动生成的任何内容。没有冗余 -> 没有出现不一致的机会。

相反，使用持续集成服务器在每次提交时自动重建（并运行测试）。如有必要，让此构建服务器在某处（SVN 之外）发布二进制文件。

现在，这并不意味着您应该将此作为绝对规则或避免使用*所有*二进制文件。无论如何，将您的构建工具和第三方闭源二进制文件放入您的项目中。并在有意义的时候做出例外。理想情况下，新开发人员应该能够进行检查并立即启动构建脚本，而无需花费一两天时间来设置他的环境。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-10T08:18:44.047

我想说，如果它让你的团队的生活更轻松，那就去做吧。如果它减少了设置工作开发环境所需的时间，那就去吧。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-10T23:59:57.930

正如许多人已经说过的，这是可以接受的。

是的，从一个位置将所有东西都放在手边很方便，您可以（例如）从那里签出已经以二进制形式存在的旧标签及其正确的依赖关系。

*但这*并不**好**，尤其是出于备份目的。我们将所有二进制文件（和部分依赖项）存储在 SVN 中，并且随着项目的增长，二进制部分也是如此。

不幸的是，`svnadmin dump`只是转储所有内容，您无法指定要排除的存储库路径。因此，备份（和升级 svn 服务器）变得非常痛苦！

如果您在我们的案例中经过不长的时间添加这些二进制文件不再有用，我敢肯定我不会在类似的情况下再次这样做（但我会为较小的项目做）。

所以我建议在做这件事之前三思而后行，并尝试预测你能成长多大以及可能发生的其他事情。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-10T08:19:36.917

不是为了这个目的，不。您应该使用外部文件存储，例如 FTP 或 Web 服务器。这样就可以轻松下载特定版本的运行时二进制文件，而无需先在 SVN 中更新到该版本。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-10T09:50:02.113

每当我在 Subversion 目录中看到一个库时，我都会问以下问题：

*   它是什么版本？（通常你有`axis.jar`和没有`axis-1.4.jar`）
*   为什么包括在内？（尤其是依赖项的依赖关系）

如果您没有适当的依赖管理系统，您通常无法回答这两个问题。这是通往 Jar Hell 的第一步。

我可以推荐带有 Intranet 存储库的[Apache Ivy （其他人可能对 Maven 发誓）。](http://ant.apache.org/ivy)使用 Ivy，我不必将库存储到 SVN 中，并且总能回答上述问题。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-10T08:25:44.483

是的，存储它。

我们曾经将交付给客户的二进制文件存储在 SVN 存储库中以跟踪它。

将二进制文件存储在 SVN（或源代码控制）中的另一种用途是，如果您向公司中不想构建项目以节省构建时间的其他团队提供一些内部实用程序模块。我相信这是一种普遍的做法。

但是我们从不允许存储 Eclipse 的 .classpath 和 .project 文件（工作空间相关设置）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-10T08:42:35.753

我们的 Java .jar 文件构建绑定在它们的 .jar 文件依赖项中，我们正在检查到 svn。很多这在实践中是多余的，但我们希望确保我们生成的每个 Java 应用程序构建都精确地具有它接受 QA 的库。

然而，真正让我感到恼火的是，当我开始远程连接到存储库并进行同步时。只需翻阅所有二进制库就需要很长时间。

我们已经放弃了这种做法，现在使用 Maven 来管理库依赖项——即使对于我们仍在使用 ant 构建的项目也是如此。没有更多的二进制文件被检入 svn。由于这种战略转变，生活在多个方面都好得多。我们可以严格控制我们想要的库依赖版本。

对于我们的 .NET 构建，我的一位开发人员设计了一个解决方案，该解决方案在很大程度上与 Maven 一样，在所有依赖项管理方面都有效，并且在那里也获得了同样的好处。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-10T09:08:57.017

如果您使用 Java 进行开发，那么您可以设置一个[本地存储库](http://archiva.apache.org/)，然后使用[maven](http://maven.apache.org/)或[ivy](http://ant.apache.org/ivy/) + [ant](http://ant.apache.org/)之类的工具来访问它。

您可以将本地构建工件的更新上传回您的本地存储库，因为它们已准备好供公司中的其他人使用。

对于其他开发环境，我不知道有哪些类似上述的工具可用——我倾向于将它们放在 SVN 中并完成它。

我通常使用单独的存储库来存储第三方库以将它们排除在常规开发存储库之外，并让我的构建文件将它们加载到相对于项目基本文件夹的预期位置。

实际上，我使用了两个存储库。一个用于构建我的项目所需的最小文件（例如，jar、lib 文件），另一个用于我通常存储 tar.bz2 的整个第三方包（包括源代码、文档或其他内容）。

这样，如果您只想获得构建东西所需的最低限度，您可以获取第一个存储库，如果您需要弄清楚发生了什么，或者如何使用第三方包，您可以开始提取东西出第二个存储库。

这不是理想的解决方案，但效果很好。

[这](http://subversion.apache.org/faq.html#binary-files)是有关 svn 如何处理二进制文件的更多信息。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-21T14:10:25.513

存储不是每个人都可以构建的二进制文件。我用 Verilog 和 VHDL 设计芯片，而软件团队没有这些工具。因此，我们将输出二进制文件存储在 SCM 中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-10T08:13:22.657

将二进制文件存储在 SVN 存储库中是完全可以接受的。作为旁注，我不明白为什么有人想在存储库中存储构建工件（我不是说你这样做）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-10T08:27:03.700

我会让我的构建和持续集成系统处理最新的工作版本，通过自动将它们复制到 FTP、Web 或文件共享以方便访问。

更好的是，我会投资一个自动处理构建工件的 CI 系统，我自己喜欢来自 jetbrains 的[TeamCity](http://www.jetbrains.com/teamcity/)，但还有其他人。这样您就可以全自动处理它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-10T08:29:01.667

在版本控制下存储二进制文件可能违背了版本控制的目的。[你最好使用 HTTP/FTP .. 在https://stackoverflow.com/questions/104453/version-control-for-binaries](https://stackoverflow.com/questions/104453/version-control-for-binaries)上关于 SO 的讨论可能很有用！

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-02-10T08:52:54.030

至少我将二进制文件存储在 SVN 中，这样我可以快速恢复到特定版本的二进制文件并查看其中是否发生错误并跟踪引入错误的版本，而不是检查整个项目，设置所有特定项目相关和环境设置，然后编译它。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2009-02-10T08:13:45.853

在这个问题上有一些争论，但我说是的。

# java - apache collection15 中的变压器

> ID：531443
> 
> 赞同：4
> 
> 时间：2009-02-10T08:10:07.267
> 
> 标签：java

apache commons 集合中的 Transformer 函数有什么用？

我如何在程序中使用它以及在什么时候使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T08:30:21.213

`Transformers`是**[函数对象](http://en.wikipedia.org/wiki/Function_object)**（也被称为[“软件”函子](http://chaoticjava.com/posts/functors-in-java-and-beyond/)，尽管函子是范畴论中的一个[数学概念](http://mathworld.wolfram.com/Functor.html)）。
它们表示封装在对象中的函数。

在大多数情况下，可以使用常见的访问器模式设置函数的参数并检索结果，例如`setParameter1(Object value)`or `getResult()`。

这些功能被真实对象封装的事实也是其最大好处的原因：**使用了许多设计模式，包括结构**模式，如装饰者模式和行为模式，如访问者模式。

因此，您可以`Transformers`在 Collections 上应用模式，也可以在[其他对象](http://www.java2s.com/Code/Java/Apache-Common/TransformerExample.htm)上应用模式。

[这是通过 Transformer 使用的](http://apachecommonstipsandtricks.blogspot.com/2009/01/transformer-invoker-for-collection-of.html)[创建模式](http://en.wikipedia.org/wiki/Creational_pattern) 的示例。

# java - 使用 Wicket + Spring + Hibernate 的三层分层应用程序。你会如何处理交易？

> ID：531451
> 
> 赞同：3
> 
> 时间：2009-02-10T08:15:56.270
> 
> 标签：java, hibernate, spring, transactions, wicket

我正在考虑使用 Spring 附带的**Open Session In View (OSIV)**过滤器或拦截器，因为这对我作为开发人员来说似乎是一种方便的方式。如果这是你推荐的，你推荐使用过滤器还是拦截器，为什么？

我还想知道它将如何与**HibernateTemplate**混合，以及我是否会失去将方法标记为**@Transactional(readOnly = true)**等的能力，从而失去获得更细粒度事务控制的能力？

是否有某种最佳实践可以将这种解决方案与使用 Hibernate 和 Spring 的三层架构集成（因为我认为我决定使用 Wicket 进行演示应该无关紧要）？

如果我使用 OSIV，我至少永远不会遇到延迟加载异常，另一方面，我的事务将在能够通过在视图中未提交来提交之前存活更长的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T10:09:21.130

这真的是个人品味的问题。

就个人而言，我喜欢在服务层设置事务边界。如果您开始考虑 SOA，那么对服务的每次调用都应该是独立的。如果您的视图层必须调用 2 个不同的服务（我们可以说这已经是代码异味），那么这 2 个服务应该彼此独立运行，可能有不同的事务配置，等等......没有事务在外部打开services 还有助于确保在服务之外不会发生任何修改。

OTOH，您将不得不更多地考虑您在服务中所做的事情（延迟加载，如果需要共同的事务性，则在同一服务方法中对功能进行分组等......）。

一种有助于减少延迟加载错误的模式是在服务层之外使用值对象。服务应始终加载所需的所有数据并将其复制到 VO。您失去了持久对象和视图层之间的直接映射（这意味着您必须编写更多代码），但您可能会发现您变得更加清晰......

**编辑：**这个决定将基于权衡，所以我仍然认为这至少部分是个人品味的问题。服务层的事务对我来说感觉更干净（更像 SOA，逻辑明确限制在服务层，不同的调用明确分离，...）。这种方法的问题是 LazyLoadingExceptions，可以通过使用 VO 来解决。如果 VO 只是您的持久对象的副本，那么是的，这显然是对 DRY 原则的破坏。如果您像使用数据库视图一样使用 VO，那么 VO 就是对持久对象的简化。仍然需要编写更多代码，但它会让你的设计更清晰。如果您需要插入一些授权方案，这将变得特别有用：如果某些字段仅对某些角色可见，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T09:53:38.750

> 如果我使用 OSIV，我至少永远不会遇到延迟加载异常

这不是真的，实际上它非常容易遇到臭名昭著的 LazyInitializationException，只需加载一个对象，并尝试读取它的属性，查看后，根据您的配置，您将得到 LIE

# math - 什么是SVD（奇异值分解）

> ID：531452
> 
> 赞同：34
> 
> 时间：2009-02-10T08:16:05.553
> 
> 标签：math, matrix, linear-algebra, svd

它实际上是如何降低噪音的……你能推荐一些不错的教程吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-10T14:36:27.173

SVD 可以从方阵的几何意义理解为对向量的变换。

考虑一个 nxn 方阵 M 乘以一个向量 v 以产生一个输出向量 w：

```
w = M*v 
```

奇异值分解 M 是三个矩阵的乘积`M=U*S*V`，所以`w=U*S*V*v`. U 和 V 是正交矩阵。从几何变换的角度来看（通过相乘作用于向量），它们是旋转和反射的组合，不会改变它们相乘的向量的长度。S 是一个对角矩阵，它表示沿 n 个轴中的每一个轴使用不同的缩放因子（对角项）进行缩放或挤压。

因此，将向量 v 左乘矩阵 M 的效果是通过 M 的正交因子 V 旋转/反射 v，然后通过对角因子 S 缩放/压缩结果，然后通过 M 的正交因子 U 旋转/反射结果。

从数值的角度来看，需要 SVD 的一个原因是正交矩阵的乘法是一种可逆且[极其稳定](http://en.wikipedia.org/wiki/Orthogonal_matrix#Benefits)的操作（条件数为 1）。SVD 捕获对角缩放矩阵 S 中的任何病态。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-10T12:16:30.553

使用 SVD 减少噪声的一种方法是进行分解，将接近零的分量设置为零，然后重新组合。

这是关于 SVD的[在线教程。](https://web.archive.org/web/20160304111718/http://www.puffinwarellc.com/index.php/news-and-articles/articles/30-singular-value-decomposition-tutorial.html)

你可能想看看[数字食谱](http://nr.com/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-05-11T14:45:32.933

奇异值分解是一种获取 nxm 矩阵 M 并将其“分解”为三个矩阵的方法，使得 M=U *S* V。S是对角正方形（唯一的非零条目位于从左上角到右下角的对角线上) 包含 M.U 和 V 的“奇异值”的矩阵是正交的，这导致了对 SVD 的几何理解，但这不是降噪所必需的。

在 M=U *S* V 的情况下，我们仍然拥有原始矩阵 M，其所有噪声都完好无损。然而，如果我们只保留 k 个最大的奇异值（这很容易，因为许多 SVD 算法计算分解，其中 S 的条目按非升序排序），那么我们就有了原始矩阵的近似值。这是有效的，因为我们假设小值是噪声，并且数据中更重要的模式将通过与更大奇异值相关联的向量来表示。

事实上，得到的近似值是原始矩阵的最准确的 rank-k 近似值（具有最小二乘误差）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-25T12:05:09.817

回答标题问题：SVD 是将特征值/特征向量推广到非方阵。假设 $X \in N \times p$，那么 X 的 SVD 分解产生 X=UDV^T，其中 D 是对角矩阵，U 和 V 是正交矩阵。现在 X^TX 是一个方阵，X^TX=VD^2V 的 SVD 分解，其中 V 等价于 X^TX 的特征向量，D^2 包含 X^TX 的特征值。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-05-21T07:26:58.090

SVD 还可用于极大地简化任意模型（以公式表示）与数据（关于两个变量并以矩阵表示）的全局（即同时对所有观察值）拟合。
例如，数据矩阵**A** = **D** * **M** ^T其中**D**代表系统的可能状态，**M**代表它在某个变量（例如时间）的演变。
通过 SVD，**A** (x,y) = **U** (x) * **S** * **V** ^T (y) 因此**D** * **M** ^T = **U** * **S** * **V**^T
然后**D** = **U** * **S** * **V** ^T * **M** ^(T+)其中“+”表示伪逆。
然后可以为演化建立一个数学模型并将其拟合到**V**的列中，每个列都是模型组件的线性组合（这很容易，因为每一列都是一维曲线）。这获得了生成**M的模型参数**^？（ ? 表示它基于拟合）。
**M** * **M** ^(?+) * **V** = **V** ^? 允许残差**R** * **S** ²= **V** - **V** ^？被最小化，从而确定**D**和**M**。

很酷，嗯？

**还可以检查U**和**V**列以收集有关数据的信息；例如，**V**列中的每个拐点通常表示模型的不同组件。

最后，实际上解决您的问题，重要的是要注意，尽管每个连续的奇异值（对角矩阵**S**的元素）及其伴随向量**U**和**V**确实具有较低的信噪比，但模型组件的分离这些“不太重要”的向量实际上更明显。换句话说，如果数据是由一组跟随指数总和或其他什么的状态变化来描述的，那么每个指数的相对权重在较小的奇异值中更接近。换句话说，后面的奇异值的向量不太*平滑*（噪声更大），但每个分量表示的变化更*明显*。

# sql-server - Sql Server 2008 - 排序规则类型之间的区别

> ID：531453
> 
> 赞同：6
> 
> 时间：2009-02-10T08:16:22.947
> 
> 标签：sql-server, sql-server-2008, collation

我正在安装一个新的 SQL Server 2008 服务器，并且在获取有关不同排序规则的任何可用信息时遇到了一些问题。我搜索了 SQL Server BOL 并用谷歌搜索了答案，但似乎无法找到任何可用的信息。

1.  `"Finnish_Swedish_100"`Windows 排序规则和有什么区别`"Finnish_Swedish"`？

    我想`"_100"`-version 是 SQL Server 2008 中的更新排序规则，但如果是这种情况，与旧版本相比发生了什么变化？

2.  `"Accent-sensitive"`启用通常是一件好事吗？我知道这取决于任务和所有这些，但是有什么众所周知的利弊需要考虑吗？

3.  和参数`"Binary"`，`"Binary-code point"`在什么情况下应该启用这些？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T08:56:46.517

_100表示​​SQL Server 2008新增的排序规则，_90是2005的，没有后缀的是2000。不知道有什么区别，也找不到文档。除非您正在对另一个不同版本的 SQL 服务器进行链接服务器查询，否则我很想使用 _100 的。抱歉，我无法帮助解决差异。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-23T10:12:35.347

The letters ÅÄÖ/åäö do not mix up with A and O just by setting the collation to AI (Accent Insensitive). That is however true for â and other "combinations" not part of the Swedish alphabet as individual letters. â will mix or not mix depending of the setting in question.

Since I have a lot of old databases I still need to communicate with, also using linked servers, I chose FINNISH _SWEDISH _CI _AS now that I'm installing SQL2008\. That was the default setting for FINNISH _SWEDISH when the Windows collations first appeared in SQL Server.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-23T10:36:35.017

使用下面的查询自己尝试一下。

如您所见，å、ä 等不计为重音字符，并且在使用芬兰语/瑞典语排序规则时根据瑞典语字母进行排序。

`AS`但是，仅当您使用排序规则时才会考虑重音符号。对于`AI`排序规则，它们的顺序没有改变，就好像根本没有重音一样。

```
CREATE TABLE #Test (
    Number int identity,
    Value nvarchar(20) NOT NULL
);
GO

INSERT INTO #Test VALUES ('àá');
INSERT INTO #Test VALUES ('áa');
INSERT INTO #Test VALUES ('aa');
INSERT INTO #Test VALUES ('aà');

INSERT INTO #Test VALUES ('áb');
INSERT INTO #Test VALUES ('ab');

-- w is considered an accented version of v
INSERT INTO #Test VALUES ('wa');
INSERT INTO #Test VALUES ('va');
INSERT INTO #Test VALUES ('zz');
INSERT INTO #Test VALUES ('åä');
GO

SELECT Number, Value FROM #Test ORDER BY Value COLLATE Finnish_Swedish_CI_AS;
SELECT Number, Value FROM #Test ORDER BY Value COLLATE Finnish_Swedish_CI_AI;
GO

DROP TABLE #Test;
GO 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T09:11:09.540

要解决问题 3（来自[MSDN](http://msdn.microsoft.com/en-us/library/ms143515.aspx)的信息；措辞他们的，格式我的）：

二进制 ( `_BIN`):

*   根据为每个字符定义的位模式对 SQL Server 表中的数据进行排序和比较。
*   二进制排序顺序区分大小写和重音。
*   二进制也是最快的排序顺序。
*   如果未选择此选项，SQL Server 将遵循相关语言或字母的字典中定义的排序和比较规则。

二进制代码点 ( `_BIN2`)：

*   对于 Unicode 数据：根据 Unicode 代码点对 SQL Server 表中的数据进行排序和比较。
*   对于非 Unicode 数据：将使用与二进制排序相同的比较。

使用二进制代码点排序顺序的优点是在比较排序的 SQL Server 数据的应用程序中不需要数据重新排序。因此，二进制代码点排序顺序提供了更简单的应用程序开发和可能的性能提升。

有关详细信息，请参阅[使用 BIN 和 BIN2 排序规则的指南](http://msdn.microsoft.com/en-us/library/ms143350.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T14:02:43.777

关于问题 2 和 3

如果您正在接受用户数据，我建议将口音敏感度关闭，如果您有干净、经过消毒的数据，则建议将其打开。我自己不是芬兰人，我不知道有多少单词会根据其中的 ó õ 或 ö 而有所不同。但是如果有用户输入数据，你可以确定他们在使用上不会保持一致，并且你希望能够匹配他们。如果您从一个数据集中收集数据，并且您知道其内容和一致性，那么您将需要打开 Accent Sensitivity ON，因为您知道这些差异是有目的的。

在考虑问题 3 时，同样的问题也适用。（我主要从 Tomalak 提供的链接中得到这个）如果数据区分大小写和重音，那么您需要 _BIN，因为它会更快地排序。如果数据不规则，并且不区分大小写/重音，那么您将需要 _BIN2，因为它是为 Unicode 数据设计的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T08:38:12.677

解决您的问题 1\. 启用芬兰语-瑞典语对口音敏感是一件好事。否则你的 "å"s 和 "ä"s 将被排序为 "a"s 和 "ö"s 作为 "o"s。（假设您将使用这些国际字符）。

更多信息：http: [//msdn.microsoft.com/en-us/library/ms143515.aspx](http://msdn.microsoft.com/en-us/library/ms143515.aspx)（讨论二进制代码点和重音敏感性）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T08:44:32.770

要解决问题 2：

是的，如果给定语言需要重音语法。

# regex - 您如何在 ColdFusion 正则表达式中引用 unicode 字符？

> ID：531461
> 
> 赞同：5
> 
> 时间：2009-02-10T08:21:45.290
> 
> 标签：regex, unicode, coldfusion

我正在尝试匹配这个我可以用 alt-0146 输入的字符。Word 告诉我它是 unicode 0x2019，但我似乎无法使用 ColdFusion 中的正则表达式匹配它。这是我用来匹配 2 到 10 个字母和撇号以及这个字符的片段

```
[[:alpha:]'\x2019]{2,10} 
```

但它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T15:26:02.610

看起来 CF 中的 \x 简写只支持前 255 个 ASCII 字符。为了超过这个数字，你需要像这样使用 chr 命令内联：

```
<cfscript>
   yourString = "’";
   result = refind("[[:alpha:]'" & chr(8217) & "]{2,10}", yourString);
   writeOutput(result);
</cfscript> 
```

那应该给你一个匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:37:29.767

您可以尝试的另一件事是直接包含角色：

```
[[:alpha:]'#Chr(8217)#]{2,10} 
```

但是我不确定这是否适用于 CF 正则表达式。如果没有，您仍然可以选择在 CF 中使用 Java 正则表达式。这很容易做到，并且使您能够使用更广泛的正则表达式功能，几乎可以肯定包括 unicode 支持。

如果要进行替换，可以直接在 CF 字符串上执行 Java 正则表达式，例如：

```
<cfset NewString = OrigString.replaceAll( 'ajavaregex' , 'replacement' )/> 
```

对于其他功能（例如，获取匹配数组、替换回调函数），我创建了[Java RegEx Utilities](http://www.hybridchill.com/projects/jre-utils) - 将这些功能简化为单个函数调用的单个组件。

# html - 如何使文本框和文本区域相同宽度的跨浏览器？

> ID：531462
> 
> 赞同：12
> 
> 时间：2009-02-10T08:21:52.153
> 
> 标签：html, css

将文本框（即输入类型=“文本”）和文本区域的宽度设置为 500px 在 IE6 和 Chrome 中不起作用，仅在 FF2 中可以正常工作（尚未测试其他浏览器），IE 和 Chrome 添加两个像素到文本框。

使用的所有元素的填充和边距设置为 0

```
*
{
margin: 0px;
padding: 0px;
} 
```

将文档类型从 xhtml 1.0 transitional 更改为 strict 也没有用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T08:28:30.360

您需要明确设置 1px 的边框并将宽度设为 498px，或将边框设为 0 和宽度 500px，尽管后者会使输入无法看到，除非您知道它在那里，所以从那里这只是一个样式问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T08:27:56.803

在 CSS 中使用一组**重置样式可能会有一些运气。**它们在消除元素呈现方式之间的跨浏览器差异方面大有帮助。

[Eric Meyer（CSS 网络上最优秀的人之一）在此处](http://meyerweb.com/eric/thoughts/2007/04/18/reset-reasoning/)描述了重置样式以及他使用它们的原因——他的最新版本[在这里](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)。

也就是说，在不知道您要达到的整体效果的情况下，众所周知，表单元素很难以一种跨浏览器平台完全一致的方式设置样式。祝你好运。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-11T04:53:35.230

我使用 CSS3 使文本框和输入工作相同。[请参阅 jsFiddle](http://jsfiddle.net/68Z5J/)。

```
.textarea, .textbox {
    width: 200px;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box; 
} 
```

在 IE8+ 中工作，[请参阅 caniuse](http://caniuse.com/css3-boxsizing)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-15T12:56:29.603

我一直在试验，发现文本输入和文本区域之间的“比率”可以使用 21 * 8 * x 来计算。

如果你有

> < input type="text" size="X" />< br/> <textarea cols="X"></textarea>

...并且您希望它们同样宽，请使用此公式计算输入文本的宽度。

如果 x = 70 那么 21*8*70 = 581px

所以你会写：

> < input type="text" size="70" style="width: 581px" />< br/> < textarea cols="70"></textarea>

两者将变得平等！

这样，在程序/网站/等中，您可以输入相同的值并获得相同的结果（文本区域中的列）！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T14:57:57.437

我也认为问题出在边界上。尝试专门为输入/文本区域定义边框样式及其宽度。

> 输入，textarea{ 边框：1px 纯灰色；宽度：498px；}

如果 input/textarea 未在其他任何地方或在它们自己的标签中定义（例如大小或行/列），也请查看源代码。IE 混乱时的其他选择是使用特殊的 css 文件。但是恕我直言，在您的情况下应该没有必要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T23:41:26.143

我建议首先避免使用“星号”重置规则，因为它只会带来问题。相反，更喜欢特定的重置，例如

ul, ol, p, blockquote, h1, h2 / *etc...* / { margin:0; 填充：0；}

事实上，表格元素是明星规则造成最大伤害的地方。

AFAIK，将填充和宽度显式设置为文本区域和输入元素，将在所有浏览器中提供完全相同的像素宽度。

我相信 IE6 确实为顶部和底部添加了 1px 的边距，而不是边距。

这是一个 RESET 规则的示例，它不会破坏表单元素的默认属性：

```
/*---------------------------*/
/* Base rules & reset */
/*---------------------------*/

body { 
    font-size:11px; line-height:1.2em; font-family:Verdana, Arial, sans-serif; 
    margin:0; padding:0; 
    background:#fff url(/01/images/cassis/body-bg.gif) repeat-x 50% 0;
    color:#303030;
}

p, pre, blockquote, address, ul, ol, li, dl, dt, dd, h1, h2, h3, h4, h5, form, label, fieldset { margin:0; padding:0; }
ul, ol, li { list-style:none; }
input, select, textarea { font:11px Arial, sans-serif; color:#333; line-height:1.2em; }
table, caption, td, th { margin:0; padding:0; font-size:11px; line-height:1.2em; font-weight:normal; }
img { display:inline; }

/* cross-browser clearing of floats (no extra space in IE) */
div.clear { clear:both; overflow:hidden; height:0; } 
```

这些只是随机的，但你明白了。不要清除所有内容的边距和填充，清除您需要的内容会更安全，并将浏览器默认设置保留在其他地方。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T08:26:48.210

尝试

```
input{
border:none;
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-11-30T04:36:31.033

```
<!--***********************CSS**************************-->
<style>

.set_font

{

font-family:verdana;

font-size:10px;

color:#ffffff;

width:250px;

}

.set_font2

{

font-family:verdana;

font-size:10px;

color:#000000;

width:250px;

}
</style>
<!--*******************HTML**************************-->
<input type="text" size="33" class="set_font2" name="inputName" id="inputName" value="inputValue" maxlength="50">
<textarea cols="30" rows="8" class="set_font2" name="inputName" id="inputName">inputValue</textarea> 
```

# java - 在 Java EE 中将 http 重定向到 https

> ID：531463
> 
> 赞同：1
> 
> 时间：2009-02-10T08:24:14.270
> 
> 标签：java, jakarta-ee, web-container

如何在 Sun Application Server / Web Server 中将 http 重定向到 https？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T09:14:54.397

`transport-guarantee`如果您将元素设置为`CONFIDENTIAL`或`INTEGRAL`中，则 servlet 容器应自动将用户重定向到 HTTPS 侦听器`web.xml`，如下所示：

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>All</web-resource-name>
        <url-pattern>*</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
</security-constraint> 
```

`url-pattern`元素内容应与您希望保护的路径匹配。因此，例如，如果您想保护 下的所有内容`/admin`，请指定`/admin/*`为您的`url-pattern`. 这应该表现出以下行为：

```
http://www.example.org/admin/login 
```

将重定向到

```
https://www.example.org/admin/login 
```

有关更多信息，请查看 Servlet 2.5 规范 ( [JSR 154](http://jcp.org/en/jsr/detail?id=154) )。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-02-10T08:40:37.770

一种可能的方法可能是使用 mod_rewrite

我确定还有其他人。

# c# - global.asax 未更新

> ID：531469
> 
> 赞同：0
> 
> 时间：2009-02-10T08:27:20.407
> 
> 标签：c#, asp.net, global-asax

我们有一个 Web 应用程序，我们在其中使用 global.asax 进行 url 重写。我们在实时服务器上使用网站的编译版本。

作为修改请求的一部分，我们必须添加一些自定义的原生 AJAX 代码，其中 javascript 会调用 web 服务来更新页面的内容。为了能够调用扩展名为 .asmx 的 web 服务，我们修改了 url 重写代码以单独处理 asmx 请求。

这种安排在本地机器上运行良好，但是当我们发布站点并将其部署在实时服务器上时，似乎没有包含新代码。它仍然会跳过检查“.asmx”扩展名的条件，并抛出一个找不到页面的异常，考虑到 web 服务名称作为页面名称。

我们已经尝试过到处寻找并在谷歌上搜索这些东西..但无济于事..任何可能出现问题的指针..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T08:31:10.943

假设您的 URL 重写很好（这通常不是作为 HttpModule 实现的吗？）我会检查以确保生产环境中的 IIS 中有一个 ISAPI 映射，该映射将 .asmx 请求发送到 ASP.NET。

如果您认为您对 global.asax 的更改没有被重新调整，那么您可以随时停止应用程序池，在 c:\windows\microsoft.net\framework[version]\temporary asp.net 中查找您的 Web 应用程序编译位文件...并删除jited版本。我以前在 Jitting 更改方面看到过 ASP.NET 错过。

我还考虑在调用 Web 服务的页面之一上运行 http fiddler (IE) 或篡改数据（FireFox 扩展）。它将准确地告诉您页面是如何调用 Web 服务的，并且您可以验证调用的 URL 是否正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T08:55:35.100

有 machine.config 文件，您可以在其中添加 HttpModules。我也认为你可以通过 web.config 做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T09:08:06.037

我能想到的一个原因是，在 Web.config 中，您可能已经在该`system.web`部分配置了路由模块，但没有在其中配置`system.webServer`（或者至少在那里忘记了一些东西）。

我之前遇到过类似的问题，解决方案是删除模块并在`system.webServer`Web.config 的部分中再次添加它，如下所示：

```
<system.webServer>
    <modules>
      <remove name="UrlRoutingModule" />
      <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, e="RoleManager" type="System.Web.Security.RoleManagerModule"/>
    </modules>
</system.webServer> 
```

它可能是不同的模块或处理程序，但想法基本相同。首先“删除”模块很重要。

# internet-explorer - 在 IE 中将图像嵌入到单个 html 文件中

> ID：531476
> 
> 赞同：1
> 
> 时间：2009-02-10T08:30:11.040
> 
> 标签：internet-explorer

在 IE 中将图像嵌入单个 html 文件的最佳方法是什么？，我不希望对 PHP 文件的往返请求来解码 base64 数据。

我读到了 MHTML，这是唯一的方法吗？

如果是，我该如何解决样式“背景图像：url（images/top.png）；”？

问候， 马诺伊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T08:36:23.990

看看[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)

****编辑****

以上不适用于 IE 6-7。只有 IE 支持 MHTML，您可以在此处查看如何实现的示例：[MTHML 文本消息](http://people.dsv.su.se/~jpalme/mimetest/MHTML-test-messages.html)。但是，我建议不要这样做，因为它会变得非常混乱并且没有得到广泛支持。

您可以考虑使用 CSS sprites 将多个小图像组合成一个。关于如何做到这一点的技术散布在网络各处。这是一个很好的指南：[CSS Sprites: Image Slicing's Kiss of Death](http://www.alistapart.com/articles/sprites/)

# c++ - 来自数组 0 初始化的奇怪程序集

> ID：531477
> 
> 赞同：28
> 
> 时间：2009-02-10T08:30:15.877
> 
> 标签：c++, c, compiler-construction, assembly

受问题的启发：[在 c/c++ 中初始化和归零数组的区别？](https://stackoverflow.com/questions/453432/difference-in-initalizing-and-zeroing-an-array-in-c-c)，我决定实际检查 Windows Mobile Professional（ARM 处理器，来自 Microsoft Optimizing Compiler）的优化版本构建的程序集。我的发现有些令人惊讶，我想知道是否有人可以对我的问题有所了解。

这两个例子被检查：

```
byte a[10] = { 0 };

byte b[10];
memset(b, 0, sizeof(b)); 
```

它们在同一个函数中使用，因此堆栈如下所示：

```
[ ] // padding byte to reach DWORD boundary
[ ] // padding byte to reach DWORD boundary
[ ] // b[9] (last element of b)
[ ]
[ ]
[ ]
[ ]
[ ]
[ ]
[ ]
[ ]
[ ] // b[0] = sp + 12 (stack pointer + 12 bytes)
[ ] // padding byte to reach DWORD boundary
[ ] // padding byte to reach DWORD boundary
[ ] // a[9] (last element of a)
[ ]
[ ]
[ ]
[ ]
[ ]
[ ]
[ ]
[ ]
[ ] // a[0] = sp (stack pointer, at bottom) 
```

生成的程序集与我的评论：

```
; byte a[10] = { 0 };

01: mov   r3, #0        // r3 = 0
02: mov   r2, #9        // 3rd arg to memset: 9 bytes, note that sizeof(a) = 10
03: mov   r1, #0        // 2nd arg to memset: 0-initializer
04: add   r0, sp, #1    // 1st arg to memset: &a[1] = a + 1, since only 9 bytes will be set
05: strb  r3, [sp]      // a[0] = r3 = 0, sets the first element of a
06: bl    memset        // continue in memset

; byte b[10];
; memset(b, 0, sizeof(b));

07: mov   r2, #0xA      // 3rd arg to memset: 10 bytes, sizeof(b)
08: mov   r1, #0        // 2nd arg to memset: 0-initializer
09: add   r0, sp, #0xC  // 1st arg to memset: sp + 12 bytes (the 10 elements
                        // of a + 2 padding bytes for alignment) = &b[0]
10: bl    memset        // continue in memset 
```

现在，有两件事让我感到困惑：

1.  第 02 行和第 5 行有什么意义？为什么不给 memset &a[0] 和 10 个字节呢？
2.  为什么没有初始化 0 的填充字节？这仅用于结构中的填充吗？

编辑：我很好奇不测试结构案例：

```
struct Padded
{
    DWORD x;
    byte y;
}; 
```

0 初始化它的汇编器：

```
; Padded p1 = { 0 };

01: mov   r3, #0
02: str   r3, [sp]
03: mov   r3, #0
04: str   r3, [sp, #4]

; Padded p2;
; memset(&p2, 0, sizeof(p2));

05: mov   r3, #0
06: str   r3, [sp]
07: andcs r4, r0, #0xFF
08: str   r3, [sp, #4] 
```

在这里，我们在第 04 行看到确实发生了填充，因为使用`str`了（而不是`strb`）。对？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T08:35:40.373

第 2 行和第 5 行的原因是因为您在数组初始值设定项中指定了 0。编译器将初始化所有常量，然后使用 memset 填充其余的常量。如果您在初始化程序中放入两个零，您会看到它是 strw（字而不是字节），然后是 memset 8 个字节。

至于padding，它只是用来对齐内存访问——正常情况下不应该使用数据，所以memsetting它是浪费的。

编辑：为了记录，我对上面的 strw 假设可能是错误的。我 99% 的 ARM 经验是在 iPhone 上反转 GCC/LLVM 生成的代码，所以我的假设可能不会延续到 MSVC。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-10T08:36:11.697

这两段代码都没有错误。提到的两行并不聪明，但您只是在证明该编译器正在发出次优代码。

填充字节通常仅在简化程序集或加快代码速度时才被初始化。例如，如果您在两个零填充成员之间有填充，则填充填充通常也更容易零填充。此外，如果您在末尾有填充并且您的 memset() 针对多字节写入进行了优化，那么覆盖该填充也可能会更快。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-11T03:32:58.603

一些快速测试表明，如果初始值设定项列表为空，与包含零时相比，Microsoft 的 x86 编译器会生成不同的程序集。也许他们的 ARM 编译器也是如此。如果你这样做会发生什么？

```
byte a[10] = { }; 
```

这是我得到的程序集清单（带有`/EHsc /FAs /O2`Visual Studio 2008 上的选项）。请注意，在初始化列表中包含零会导致编译器使用未对齐的内存访问来初始化数组，而空初始化列表版本和`memset()`版本都使用对齐的内存访问：

```
; unsigned char a[10] = { };

xor eax, eax
mov DWORD PTR _a$[esp+40], eax
mov DWORD PTR _a$[esp+44], eax
mov WORD PTR _a$[esp+48], ax

; unsigned char b[10] = { 0 };

mov BYTE PTR _b$[esp+40], al
mov DWORD PTR _b$[esp+41], eax
mov DWORD PTR _b$[esp+45], eax
mov BYTE PTR _b$[esp+49], al

; unsigned char c[10];
; memset(c, 0, sizeof(c));

mov DWORD PTR _c$[esp+40], eax
mov DWORD PTR _c$[esp+44], eax
mov WORD PTR _c$[esp+48], ax 
```

# iphone - 在 UITableViewCell 中延迟加载图像

> ID：531482
> 
> 赞同：33
> 
> 时间：2009-02-10T08:32:38.150
> 
> 标签：iphone, cocoa-touch, uitableview, image, lazy-loading

我的 UITableView 中有大约 50 个自定义单元格。我想在从 URL 获取图像的单元格中显示图像和标签。

我想做一个延迟加载图像，以便在加载图像时 UI 不会冻结。我尝试在单独的线程中获取图像，但每次单元格再次可见时我都必须加载每个图像（否则重用单元格会显示旧图像）

像 Facebook 这样的应用程序只为当前可见的单元格加载图像，一旦加载了图像，就不会再次加载它们。有人可以告诉我如何复制这种行为。

谢谢。

*编辑*
尝试在 NSMutableDictionary 对象中缓存图像会在用户快速滚动时产生问题。仅当滚动完全停止并清除内存警告时的缓存时，我才会获取图像。但是应用程序总是会收到内存警告（由于缓存的图像大小）并在重新加载之前清除缓存。如果滚动非常快，它会崩溃。

欢迎任何其他建议

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T14:00:39.443

在后台线程上加载图像仍然是一个好主意。如果您不想每次都重新加载它们，我建议您设置一个 NSMutableDictionary 并将图像存储在其中。您可以使用一些唯一标识符，例如行 ID 甚至图像的名称，作为每个图像的键。

加载单元格时，您将向 NSMutableDictionary 发送 objectForKey: 消息以检索该特定单元格的图像（基于您的唯一键）。如果它返回 nil，则意味着图像从缓存中丢失，您需要后台图像加载线程来检索它。否则，您将获得适当的图像以供表格单元格显示。在出现内存警告时，您可以清除此图像缓存而不会产生不利影响（除了根据需要强制重新加载它们）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T12:45:21.647

我刚刚通过使用自定义 NSOperation 以排队方式加载图像并将它们存储到静态 NSMutableDictionary 作为缓存来成功解决了同样的问题。下面是我用来解决问题的代码基础的链接。

[为 UITableViewCell 加载远程图像](http://forums.macrumors.com/showthread.php?s=a16436f953f04b1b122f47935333581e&t=553870&page=2)

最好阅读论坛中的所有主题，以帮助您了解实际情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T17:37:10.187

在运输途中丢失，

我遇到了类似的问题，在探索许多不同的可能解决方案时，我发现了这篇博文：

[davidgolightly.blogspot.com/2009/02/asynchronous-image-caching-with-iphone.html](http://davidgolightly.blogspot.com/2009/02/asynchronous-image-caching-with-iphone.html)

我还建议您从苹果开发者网站下载 URLCache 示例：

[developer.apple.com/iphone/prerelease/library/samplecode/URLCache/](http://developer.apple.com/iphone/prerelease/library/samplecode/URLCache) _

这是关于这个问题的另一篇文章：

[www.markj.net/iphone-asynchronous-table-image/](http://www.markj.net/iphone-asynchronous-table-image/)

我也希望你分享你的发现。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-16T08:42:08.273

延迟加载就像同步类型的请求..意味着等待响应

自我图像按钮是解决方案..

自我图像按钮是异步类型请求..不要等待响应..一次只显示数据....

你可以从github下载文件夹....

添加到您的项目...

在 xib ..在图像视图中，将类更改为自我图像按钮...

在 m 文件中制作它的对象...

您可以使用.....

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-16T23:50:09.810

对于那些有兴趣并且像我一样懒惰的人，我想建议 UIImageView 图像的惰性/缓存网络的开源（MIT 许可）实现：[SDWebImage](http://cocoaobjects.com/sdwebimage/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-13T21:55:36.113

UITableView 在后台线程中具有图像缓存和调整大小/设置：

[http://blog.slaunchaman.com/2011/08/12/gcd-example-updated-now-with-more-speed/](http://blog.slaunchaman.com/2011/08/12/gcd-example-updated-now-with-more-speed/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-18T21:01:46.620

这是关于 NSOperation 的[教程](http://www.raywenderlich.com/19788/how-to-use-nsoperations-and-nsoperationqueues)，示例展示了如何在 UITableViewCell 中延迟加载图像

# sql - 用于更新任何表的动态 SQL ！

> ID：531483
> 
> 赞同：0
> 
> 时间：2009-02-10T08:33:08.537
> 
> 标签：sql

如何创建动态 SQL 语句，它将更新作为参数之一给出的任何表。在这里我相信，我不能使用“Set Column1 = Value .....”，因为列会根据表格而有所不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T15:38:17.447

这是一个非常糟糕的主意。你可以用你的数据库做这样的事情造成巨大的破坏。我无法想象任何 dba 会允许它。您需要知道表格的细节才能正确插入，您需要知道哪些字段是必需的，哪些字段具有默认值。您需要知道每个字段中应该包含什么样的信息和数据类型，这样您就不会向数据库发送不良数据。一个能做所有事情的 proc 无法正确检查这些事情，当然也无法正确测试。此外，这意味着权限必须在表级别，这对于内部安全以及 SQL 注入攻击来说都是一个糟糕的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T08:39:51.237

你能提供更多的上下文吗？您是否在脚本（例如 Perl、PHP 或 Python）中执行任意 SQL 语句？您只是想让命令行 .sql 脚本正常工作吗？您正在使用什么数据库服务器？

根据您的情况，解决方案可能会有很大差异。

# python - DOM 感知浏览器 Python GUI 小部件

> ID：531487
> 
> 赞同：4
> 
> 时间：2009-02-10T08:33:55.713
> 
> 标签：python, browser, widget

我正在寻找一个 python 浏览器小部件（沿着 pyQT4 的[QTextBrowser](http://doc.trolltech.com/3.3/qtextbrowser.html)类或[wxpython 的 HTML 模块](http://www.wxpython.org/docs/api/wx.html-module.html)的行），它具有与 DOM 交互的事件。例如，如果我突出显示一个 h1 节点，小部件类应该有一个方法来通知我某些内容被突出显示以及该节点具有哪些 dom 属性（`<h1>`标签的内容、兄弟标签和父标签等）。理想情况下，小部件模块/类可以访问 DOM 树对象本身，这样我就可以遍历它、修改它并重新渲染新树。

这样的事情存在吗？我试过寻找，但不幸的是我找不到它。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T01:03:00.450

它可能不适合您的目的，但您可能想看看 Python 与 KHTML 的绑定，它是 PyKDE 的一部分。一个开始寻找的地方是 KHTMLPart 类：

[http://api.kde.org/pykde-4.2-api/khtml/KHTMLPart.html](http://api.kde.org/pykde-4.2-api/khtml/KHTMLPart.html)

由于该类的 API 基于 Qt 中使用的信号和插槽范例，因此您需要在自己的代码中将各种信号连接到插槽，以了解文档的某些部分何时发生更改。还有一个 DOM API，因此也应该可以访问文档选定部分的 DOM 节点。

更多信息可以在这里找到：

[http://api.kde.org/pykde-4.2-api/khtml/index.html](http://api.kde.org/pykde-4.2-api/khtml/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:49:45.670

我也会喜欢这样的东西。我怀疑不存在具有 Python 绑定的绑定，但我很高兴对此有误。

我最近看过（但从未尝试过）的一个选项是[Webkit](http://webkit.org/)浏览器。现在这有一些 Python 绑定，并针对不同的工具包构建（我使用 GTK）。但是，对于 C++ 的整个 Javascript 机器，有可用的 API，但没有 Python 绑定，我看不出有任何理由不能为 Python 绑定这些。这是一项相当艰巨的任务，我知道，但这将是一个普遍有用的项目，所以也许值得投资。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T12:25:51.763

如果你不介意被限制在 Windows 下，你可以使用 IE 浏览器控件。来自 wxPython，它位于 wx.lib.iewin.IEHtmlWindow 中（在 wxPython 演示中有一个演示）。这使您可以完全访问 DOM 并能够接收事件，例如

```
ie.document.body.innerHTML = u"<p>Hello, world</p>" 
```

# oracle - 了解 oracle 中的 Lob 段 (SYS_LOB)？

> ID：531488
> 
> 赞同：23
> 
> 时间：2009-02-10T08:34:16.087
> 
> 标签：oracle, blob

大多数表（如果不是全部）都有一个“blob”字段。存储用户操作日志的表之一现在已增长到 8 GB（约 500 万条记录）。

我们的 DBA 已经看到，这种模式现在正以指数方式占用空间。我们调查了一下，发现有一个表（SYS_LOB）需要大约 116GB 的 140GB 数据库。

我们的 DBA 告诉我们，此表与保存用户操作日志的表有关（即 8GB）

有谁知道这个 SYS_LOB 表是做什么的？是保存在我们创建的表中的实际 blob 还是 oracle 实际上将这些 blob 存储在另一个表中（如果是，那么 SYS_LOB 将是那个表）？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-10T08:50:29.963

Oracle 数据库中没有表`SYS_LOB`（至少，没有这样的表是基本数据库安装的一部分。有一个视图`DBA_LOBS`显示有关数据库中所有 LOB 列的信息，但它实际上并不存储任何LOB 数据，只是元数据。数据库中的实际 LOB 段具有系统生成的名称，采用 SYS_LOB*标识符*$$ 的形式。

我的猜测是您的 DBA 已经确定了一个名为`SYS_LOB`*标识符*$$ 的段，它占用了 116 GB 的空间。假设正确，您可以使用视图找出 LOB 列映射到哪个表的哪个列`DBA_LOBS`，即

```
SELECT owner, table_name, column_name
  FROM dba_lobs
 WHERE segment_name = 'SYS_LOB<<identifier>>$$' 
```

# visual-c++ - 将资源构建到 DLL 中以供重用，MFC/VC++

> ID：531493
> 
> 赞同：3
> 
> 时间：2009-02-10T08:36:31.010
> 
> 标签：visual-c++, dll, resources

例如，我想构建一个导出名为 ShowDialog 的函数的 DLL，该函数显示一个对话框并更改其中一个对话框按钮中的文本。对话框和所有其他资源应捆绑在 DLL 中。

我做了一个快速测试，当 DLL 尝试使用某个控件 ID 的 GetDlgItem() 时，它会返回一个空指针。我假设在这种情况下需要更多步骤来正确处理资源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T08:48:47.893

您是否在 DLL 的入口点执行以下操作？

```
AFX_MANAGE_STATE(AfxGetStaticModuleState( )) 
```

在此处查看[有关 MFC 模块状态](http://msdn.microsoft.com/en-us/library/ft1t4bbc.aspx)的技术说明。MFC 模块状态有多种类型，模块状态是您最常与之交互的一种。

> 这会将当前模块状态与从 AfxGetStaticModuleState 返回的状态交换，直到当前范围结束。
> 
> 如果不使用 AFX_MODULE_STATE 宏，则会出现 DLL 中的资源问题。默认情况下，MFC 使用主应用程序的资源句柄来加载资源模板。这个模板实际上存储在 DLL 中。根本原因是MFC的模块状态信息没有被AFX_MODULE_STATE宏切换。资源句柄从 MFC 的模块状态中恢复。不切换模块状态会导致使用错误的资源句柄。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T08:47:40.610

来自[MSDN](http://msdn.microsoft.com/en-us/library/ba9d5yh5(VS.80).aspx)：

> 默认情况下，MFC 使用主应用程序的资源句柄来加载资源模板。如果您在 DLL 中有导出函数，例如在 DLL 中启动对话框的函数，则此模板实际上存储在 DLL 模块中。您需要切换模块状态才能使用正确的句柄。您可以通过将以下代码添加到函数的开头来执行此操作：

```
AFX_MANAGE_STATE(AfxGetStaticModuleState()); 
```

# visual-c++ - 静态库中的 VC++ 资源

> ID：531502
> 
> 赞同：40
> 
> 时间：2009-02-10T08:39:48.817
> 
> 标签：visual-c++, resources, static-libraries

是否可以将资源构建到静态库中并通过简单地与库链接来重用它们？

我主要考虑的是您在库中调用一个函数进而访问资源的情况。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-10-27T14:10:33.893

要在 Visual C++ (2008) 的静态库中使用资源（图像、对话框等），您唯一需要做的就是在项目中**包含静态库的关联 .res 文件**。这可以在“项目设置/链接器/输入/附加依赖项”中完成。

使用此解决方案，静态库的资源被打包到 .exe 中，因此您不需要额外的 DLL。遗憾的是，Visual Studio 没有像 .lib 文件那样自动包含 .res 文件（使用“项目依赖项”功能时），但我认为这个额外的小步骤是可以接受的。

我已经为这个解决方案寻找了很长时间，现在让我惊讶的是它就是这么简单。唯一的问题是它完全没有记录。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-10T10:20:37.017

可以做到，但是比较痛苦：不能简单的通过静态库的链接来做到。

考虑一下：资源嵌入在 EXE 或 DLL 中。当静态库中的某些代码调用（例如）LoadIcon 时，它将从与其链接的 EXE 或 DLL 中获取资源。

所以，如果你的静态库需要可用的资源，你有几个选择：

1.  您可以让库即时构建它们，然后使用 (eg) `CreateDialogIndirect`。请参阅 Raymond Chen 的[“在运行时构建对话框模板”](http://blogs.msdn.com/oldnewthing/archive/2005/04/29/412577.aspx)。
2.  您可以将它们作为简单数组 (ie) 嵌入到库中`char my_dialog_resource[] = { .... };`，然后使用 (eg) `CreateDialogIndirect`。您可能需要找到（或编写）一个将文件转换为`.RES`文件的实用程序`.CPP`。
3.  `.RC`您可以使用资源脚本（文件）和相应的头文件发送 LIB文件。然后，您将`#include`它们视为相关。您需要保留一系列资源 ID 供 LIB 使用，以免它们与主 EXE 或 DLL 的资源 ID 冲突。这就是 MFC 在用作静态库时所做的事情。或者您可以使用字符串资源 ID（这不适用于`STRINGTABLE`资源）。
4.  您的静态库可以附带一个单独的资源 DLL。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-24T18:27:02.507

我刚刚用 MS Visual Studio 编译器完成了这个。我们正在将一些遗留项目从 DLL 转换为静态库。其中一些 DLL 中嵌入了对话框或字符串资源。我能够通过“TEXTINCLUDE”机制将这些 DLL 的 .RC 脚本编译到我们的主应用程序中，方法是将它们包含在主应用程序的 RC 脚本文件中。我发现通过直接编辑 RC 文件最容易做到这一点，但 Visual Studio 也提供了一个稍微“聪明”的机制。其他编译器的实现很可能不同。

* * *

直接操作主 RC 脚本：

.1。在“2 TEXTINCLUDE”部分中，包含定义库的资源 ID 的头文件。语法是

```
2 TEXTINCLUDE 
BEGIN
    "#include ""my_first_lib_header.h""\r\n"
    "#include ""my_second_lib_header.h""\0" 
END 
```

.2\. 在“3 TEXTINCLUDE”部分中，包含您库中的 RC 脚本。

```
3 TEXTINCLUDE
BEGIN
    "#include ""my_first_library.rc""\r\n"
    "#include ""my_second_library.rc""\0"
END 
```

第 3 步和第 4 步应该自动发生，但我发现自己输入它们更可靠，而不是依靠微软的资源脚本编译器来处理。

.3\. 将带有库资源定义的头文件添加到只读符号列表中。此列表通常位于文件顶部附近。

```
#define APSTUDIO_READONLY_SYMBOLS
#include "my_first_lib_header.h"
#include "my_second_lib_header.h"
#undef APSTUDIO_READONLY_SYMBOLS 
```

.4\. 在 APSTUDIO_INVOKED 部分中包含您的库的 RC 脚本。这通常位于文件的底部。

```
#ifndef APSTUDIO_INVOKED
#include "my_first_library.rc"
#include "my_second_library.rc"
#endif 
```

* * *

您也可以通过 Visual Studio IDE 自动完成所有这些操作，但我发现它并不总是在我期望的时候适用。

1.  在 Visual Studio 中打开“资源视图”窗口。
2.  右键单击主应用程序的资源文件，然后从上下文菜单中选择“Resource Includes...”。
3.  在标有“只读符号指令”的框中，为定义库的资源 ID 的 .h 文件添加包含语句。
4.  在标有“编译时指令”的框中，为您的库的 .rc 脚本添加包含语句。
5.  点击确定。您可能还想手动触发 RC 脚本编译，以确保它发生。

* * *

如果您的库的资源脚本引用磁盘上的任何文件（文本文件、图标文件等），您需要确保主应用程序项目知道在哪里可以找到它们。您可以将这些文件复制到应用程序可以找到它们的位置，也可以在编译器设置中添加额外的包含路径。

要添加额外的包含路径：

1.  打开主应用程序的属性对话框。
2.  从左侧导航窗格中选择“配置属性/资源/常规”。
3.  在属性列表中，在“其他包含目录”旁边输入任何相关路径。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-23T22:41:21.810

根据 Visual Studio 2010，微软的开发工具显然根本无法正确处理静态库中的已编译资源数据。

要分发已编译的资源文件（`.res`文件），您有两种选择：

1.  分别分发`.res`文件，并指示客户端代码链接它们；
2.  用于`cvtres`将多个`.res`文件合并为一个对象 ( `.obj`) 文件，并单独提供。

请注意，您不能在使用`cvtres`. 如果提供了多个目标文件，`lib`就好像提供了多个`.res`文件一样抱怨；如果提供了单个目标文件，`lib`则不会抱怨，但链接器会简单地忽略 lib 文件中嵌入的资源数据。

可能有一种方法可以强制链接器读取和链接资源数据中的 libbed（使用一些命令行选项、部分操作等），因为资源数据确实在库中可用（如`dumpbin`揭示）。到目前为止，我还没有找到解决方案，除非有人愿意破解开发工具，否则任何比这个简单解决方案更好的东西都可能不值得付出努力。

在静态库（在这种情况下，*使用*静态库）中传送资源数据的唯一方法是单独分发资源并在客户端代码中显式链接它们。使用`cvtres`可以将分布式资源文件的数量减少到一个，如果你有很多的话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T08:55:43.383

我不这么认为。静态库没有自己的 HINSTANCE。它的代码在链接它的 DLL 或 EXE 的上下文中执行。这就是为什么您将尝试从静态库的代码中加载的所有资源都将属于那个封闭的 DLL/EXE。

不过，我使用 DLL 进行了这种资源重用，只要它有自己的地址空间，您可以使用 DLL 的 HINSTANCE 调用 LoadResource。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T10:17:29.567

推荐的方法是与您的库一起提供包含资源的 dll。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-09-21T15:24:14.990

当使用以下方法时，任何资源（在此示例中为图标）都可以用作静态库的组成部分，并且此类库可以被任何类型的应用程序使用，包括控制台应用程序（没有任何资源段）。

1.  Icon 被转换为 BYTE 的静态数组。[bin2c](https://sourceforge.net/projects/bin2c/)可以用于此。
2.  数据被转换为 HICON 句柄。以下是我的做法：

    ```
    HICON GetIcon()
    { 
       DWORD dwTmp;
       int offset;
       HANDLE hFile;
       HICON hIcon = NULL;
       offset = LookupIconIdFromDirectoryEx(s_byIconData, TRUE, 0, 0, LR_DEFAULTCOLOR);
       if (offset != 0)
       {
          hIcon = CreateIconFromResourceEx(s_byIconData + offset, 0, TRUE, 0x00030000, 0, 0, LR_DEFAULTCOLOR | LR_DEFAULTSIZE);
       }
       return hIcon;  
    } 
    ```

3.  使用 GetIcon 代替 LoadIcon。而不是调用：

`m_hIcon = ::LoadIcon(hInstanceIcon, MAKEINTRESOURCE(pXMB->nIcon));`

然后打电话

```
m_hIcon = GetIcon() 
```

# c# - 如何在c#中将值从X类复制到具有相同属性名的Y类？

> ID：531505
> 
> 赞同：16
> 
> 时间：2009-02-10T08:40:21.250
> 
> 标签：c#, .net, reflection

假设我有两个类：

```
public class Student
{
    public int Id {get; set;}
    public string Name {get; set;}
    public IList<Course> Courses{ get; set;}
}

public class StudentDTO
{
    public int Id {get; set;}
    public string Name {get; set;}
    public IList<CourseDTO> Courses{ get; set;}
} 
```

我想将值从 Student 类复制到 StudentDTO 类：

```
var student = new Student();
StudentDTO studentDTO = student; 
```

我怎样才能通过反思或其他解决方案做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-10T08:42:18.843

列表让它变得棘手......我之前的回复（如下）仅适用于同类属性（而不是列表）。我怀疑您可能只需要编写和维护代码：

```
 Student foo = new Student {
        Id = 1,
        Name = "a",
        Courses = {
            new Course { Key = 2},
            new Course { Key = 3},
        }
    };
    StudentDTO dto = new StudentDTO {
        Id = foo.Id,
        Name = foo.Name,
    };
    foreach (var course in foo.Courses) {
        dto.Courses.Add(new CourseDTO {
            Key = course.Key
        });
    } 
```

* * *

编辑; 仅适用于**浅**拷贝 - 不适用于列表

反射是一种选择，但速度较慢。在 3.5 中，您可以使用`Expression`. [Jon Skeet 在MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)中有一个预卷样本- 只需用作：

```
Student source = ...
StudentDTO item = PropertyCopy<StudentDTO>.CopyFrom(student); 
```

因为这使用了已编译的`Expression`，所以它的性能将大大优于反射。

如果没有 3.5，则使用反射或 ComponentModel。*如果您使用ComponentModel*，您至少可以[`HyperDescriptor`](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)使用*`Expression`*

 *```
Student source = ...
StudentDTO item = new StudentDTO();
PropertyDescriptorCollection
     sourceProps = TypeDescriptor.GetProperties(student),
     destProps = TypeDescriptor.GetProperties(item),
foreach(PropertyDescriptor prop in sourceProps) {
    PropertyDescriptor destProp = destProps[prop.Name];
    if(destProp != null) destProp.SetValue(item, prop.GetValue(student));
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T09:37:46.153

好的，我刚刚查找了 Marc 发布的[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)，它非常棒。我希望马克不介意我在这里添加代码。

```
using System;
using System.Collections;
using System.Collections.Specialized;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Reflection;
using System.ComponentModel;
using System.Linq.Expressions;

namespace ConsoleApplication1
{
    class Program
    {
        public class Student
        {
            public int Id { get; set; }
            public string Name { get; set; }
            public IList<int> Courses { get; set; }
            public static implicit operator Student(StudentDTO studentDTO)
            {
                return PropertyCopy<Student>.CopyFrom(studentDTO);
            }
        }

        public class StudentDTO
        {
            public int Id { get; set; }
            public string Name { get; set; }
            public IList<int> Courses { get; set; }
            public static implicit operator StudentDTO(Student student)
            {
                return PropertyCopy<StudentDTO>.CopyFrom(student);
            }
        }

        static void Main(string[] args)
        {
            Student _student = new Student();
            _student.Id = 1;
            _student.Name = "Timmmmmmmmaaaahhhh";
            _student.Courses = new List<int>();
            _student.Courses.Add(101);
            _student.Courses.Add(121);

            StudentDTO itemT = _student;

            Console.WriteLine(itemT.Id);
            Console.WriteLine(itemT.Name);
            Console.WriteLine(itemT.Courses.Count);
        }

    }

    // COOLEST PIECE OF CODE FROM - http://www.yoda.arachsys.com/csharp/miscutil/

    /// <summary>
    /// Generic class which copies to its target type from a source
    /// type specified in the Copy method. The types are specified
    /// separately to take advantage of type inference on generic
    /// method arguments.
    /// </summary>
    public class PropertyCopy<TTarget> where TTarget : class, new()
    {
        /// <summary>
        /// Copies all readable properties from the source to a new instance
        /// of TTarget.
        /// </summary>
        public static TTarget CopyFrom<TSource>(TSource source) where TSource : class
        {
            return PropertyCopier<TSource>.Copy(source);
        }

        /// <summary>
        /// Static class to efficiently store the compiled delegate which can
        /// do the copying. We need a bit of work to ensure that exceptions are
        /// appropriately propagated, as the exception is generated at type initialization
        /// time, but we wish it to be thrown as an ArgumentException.
        /// </summary>
        private static class PropertyCopier<TSource> where TSource : class
        {
            private static readonly Func<TSource, TTarget> copier;
            private static readonly Exception initializationException;

            internal static TTarget Copy(TSource source)
            {
                if (initializationException != null)
                {
                    throw initializationException;
                }
                if (source == null)
                {
                    throw new ArgumentNullException("source");
                }
                return copier(source);
            }

            static PropertyCopier()
            {
                try
                {
                    copier = BuildCopier();
                    initializationException = null;
                }
                catch (Exception e)
                {
                    copier = null;
                    initializationException = e;
                }
            }

            private static Func<TSource, TTarget> BuildCopier()
            {
                ParameterExpression sourceParameter = Expression.Parameter(typeof(TSource), "source");
                var bindings = new List<MemberBinding>();
                foreach (PropertyInfo sourceProperty in typeof(TSource).GetProperties())
                {
                    if (!sourceProperty.CanRead)
                    {
                        continue;
                    }
                    PropertyInfo targetProperty = typeof(TTarget).GetProperty(sourceProperty.Name);
                    if (targetProperty == null)
                    {
                        throw new ArgumentException("Property " + sourceProperty.Name + " is not present and accessible in " + typeof(TTarget).FullName);
                    }
                    if (!targetProperty.CanWrite)
                    {
                        throw new ArgumentException("Property " + sourceProperty.Name + " is not writable in " + typeof(TTarget).FullName);
                    }
                    if (!targetProperty.PropertyType.IsAssignableFrom(sourceProperty.PropertyType))
                    {
                        throw new ArgumentException("Property " + sourceProperty.Name + " has an incompatible type in " + typeof(TTarget).FullName);
                    }
                    bindings.Add(Expression.Bind(targetProperty, Expression.Property(sourceParameter, sourceProperty)));
                }
                Expression initializer = Expression.MemberInit(Expression.New(typeof(TTarget)), bindings);
                return Expression.Lambda<Func<TSource,TTarget>>(initializer, sourceParameter).Compile();
            }
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-08-09T14:17:08.727

供参考

当我遇到同样的问题时，我发现了 AutoMapper ( [http://automapper.codeplex.com/](http://automapper.codeplex.com/) ) 然后在阅读了 AboutDev 的答案后，我做了一些简单的测试，结果令人印象深刻

这里是测试结果：

测试自动映射器：22322 毫秒

测试隐式运算符：310 ms

测试属性复制：250 毫秒

测试发射映射器：281 毫秒

我想强调一下，它只是类（StudentDTO，Student）的样本，它们只有几个属性，但是如果类有 50-100 个属性会发生什么，我想它会显着影响性能。

更多测试细节在这里： [.net 中的对象复制方法：自动映射器、发射映射器、隐式操作、属性复制](https://stackoverflow.com/questions/3457657/object-copy-approaches-in-net-auto-mapper-emit-mapper-implicit-operation-pro)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T09:23:28.213

在任何类中编写隐式运算符

```
 public static implicit operator StudentDTO(Student student)
    {

        //use skeet's library

        return PropertyCopy<StudentDTO>.CopyFrom(student);

    } 
```

现在你可以做到了

```
StudentDTO studentDTO = student; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-10T07:57:38.967

有一个库可以做到这一点 - [http://emitmapper.codeplex.com/](http://emitmapper.codeplex.com/)

它比 AutoMapper 快得多，它使用 System.Reflection.Emit，因此代码的运行速度几乎与手写代码一样快。

# javascript - getAttribute 不能在 IE7 中返回类？

> ID：531508
> 
> 赞同：10
> 
> 时间：2009-02-10T08:42:34.273
> 
> 标签：javascript, internet-explorer-7

我需要根据随机属性值找到随机节点。为此，我在 getElementsByTagName 的节点上使用 getAtrribute。

似乎当我寻找类名作为属性时，它在 IE 上不起作用（在 FF 上起作用）。

任何人都知道 getAtrribute 是否仅适用于“类”或其他属性？（如果它是唯一的课程，我会做一个解决方法。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T08:47:34.620

如果您不使用[jQuery](http://jquery.com/)之类的东西来减轻痛苦，那么值得测试所有 Javascript 跨平台，但 Class 可能只是一个特例。

这应该是获取类的跨平台方式：

```
element.className 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T14:14:21.533

> 任何人都知道 getAtrribute 是否仅适用于“类”或其他属性？

对于 HTML 属性名称与 DOM 属性名称（className、htmlFor）不同的所有属性，它都会失败，而且您必须使用 DOM 样式的大写字母。它还会为 DOM 属性不是字符串的属性返回错误的数据类型：

```
disabled, readOnly, checked, selected, multiple,
compact, declare, isMap, noHref, defer, noResize,
size, cols, rows, width, height, hspace, vspace,
maxLength, tabIndex, colSpan, rowSpan 
```

可能还有我错过的其他人！

```
element.getAttribute(x) 
```

在 IE 中与说的*完全*一样：

```
element[x] 
```

所以一般来说你应该避免使用getAttribute，而是使用简单的DOM Level 1/2 HTML 接口，比如'element.className'。

这最终在 IE8 中得到修复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T08:48:42.213

IE在这方面被打破了。您可以通过 IE 访问该类，`getAttribute("className")`但这当然不是真正的属性，因此它在 !IE 中不起作用。

这使您可以选择分支以获取 element.className 或分支以获取“className”或“class”上的 getAttribute。不好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-14T20:11:28.927

您可以从元素中获取所有属性的列表并以这种方式测试它们的值。此代码段同时处理 IE 和 WebKit 浏览器，并将返回 CSS 类的字符串值：

```
var value = "";
var elements = document.getElementsByTagName("div");

for(var i = 0; i < elements.length; i++){
    if(typeof elements[i].attributes['class'] == "undefined"){
        value = elements[i].getAttribute("class"); 
    } else {
      value = elements[i].attributes['class'].nodeValue;
    }

    alert(value); // careful, this will be a lot of alerts
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-27T09:38:45.533

在这里您可以获取和设置具有跨浏览器兼容性的类属性。

```
 //also works with IE7 and below

      //get class attribute value
      var class_name = document.getElementById('elem_id').className;

      //set class attribute
      document.getElementById('elem_id').className  = 'new-class-name'; 
```

# c# - 什么时候结构不在堆栈上？

> ID：531520
> 
> 赞同：5
> 
> 时间：2009-02-10T08:48:27.830
> 
> 标签：c#, stack, struct

我正在阅读 Jon Skeet 的书评，他正在研究[Head First C#的](https://rads.stackoverflow.com/amzn/click/com/0596514824)[许多不准确](http://msmvps.com/blogs/jon_skeet/archive/2008/03/21/book-review-head-first-c.aspx)之处。

其中一个引起了我的注意：

> [在错误部分下] 声称结构始终存在于堆栈中。

在什么情况下结构*不会*存在于堆栈中？这与我认为我对结构的了解相反。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T08:51:37.543

一个常见的例子是结构是在堆中分配的对象的成员。这个问题在这里有很多额外的细节。[.Net 中的结构和类有什么区别？](https://stackoverflow.com/questions/13049/whats-the-difference-between-struct-and-class-in-net)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T09:06:52.530

**每当他们是班级的一个领域**

不寻常的例子：

a：当捕获值类型变量时：

```
int i = 2;
Action action = delegate {i++;}
action();
Console.WriteLine(i); 
```

这被编译成更像：

```
class Foo {
    public int i;
    public void Bar() {i++;}
}
...
Foo foo = new Foo();
foo.i = 2;
Action action = foo.Bar;
action();
Console.WriteLine(foo.i); 
```

b：当在迭代器块中使用值类型变量时：

```
IEnumerable<int> GetValues() {
   for(int i = 0 ; i < 5 ; i++) yield return i;
} 
```

（编译器生成状态机来表示迭代器，其中所有的局部变量（如`i`）都是字段）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T08:52:46.773

当[值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)的实例被[装箱](http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx)时，盒子以及实例本身都会被移动到堆中。尽管如此，毫无疑问，第一次创建的非类成员值类型实例总是在堆栈上创建。

结构是一种值类型。所以它的行为如上。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T09:07:35.867

就像[1800 INFORMATION 的答案](https://stackoverflow.com/questions/531520/when-do-structs-not-live-on-the-stack/531529#531529)示例：

```
public class Foo
{
    int x;

    public Foo(int y)
    {
        x = y;
    }
}

...

Foo foo = new Foo(10); 
```

现在，构造函数执行完毕后，值为`foo.x`10。`foo.x`内存在哪里？在堆上。是什么类型的`foo.x`？`int`aka `System.Int32`，这是一个结构。

关于捕获的变量和装箱等的其他答案也是正确的（在装箱案例中“有点” - 我将添加评论），但这个例子是最简单和最重要的一个，IMO。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T12:11:15.650

其他人已经深入提及

*   成员字段值
*   盒装结构（严格来说，它们不再是值类型）

此外：

*   结构数组完全驻留在堆上
*   静态结构（不在堆栈或堆上，而是在它们自己的特殊区域中）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-26T20:38:10.823

这本书犯了将类型机制与作用域机制混淆的错误。值类型不是引用类型。当您调用使用它作为参数的方法时，它的数据被复制（没有 ref 或 out）。值类型将存在于方法范围内的堆栈中，而不是像引用对象那样存在于堆中，但这并不意味着它总是存在于堆栈中。

因此，这本书是在用一个用法说明来代替力学说明，并将两者混淆。这不是完全没有根据的说法，但这是错误的。

值类型将保存在其所有者所在的任何地方。

因此，如果它们的作用域是一个方法，它们就会在堆栈中。如果他们的作用域是一个对象，他们将与堆上的对象一起生活。

这样一来，可以很肯定地说，值类型最好保留为不可变的，因为大多数人很难预测按值的值类型机制。

# java - 在 java 服务包装器的 wrapper.conf 文件中在哪里传递运行时参数？

> ID：531524
> 
> 赞同：2
> 
> 时间：2009-02-10T08:50:06.093
> 
> 标签：java, java-service-wrapper

我正在尝试为我的 jar 应用程序创建窗口服务。应用程序在运行时需要一个参数和系统属性值。我不知道在 wrapper.conf 文件中在哪里给出参数值和系统变量值。请帮我。我收到以下错误

包装 | 启动 JVM...
jvm 1 | WrapperManager：正在初始化...
jvm 1 | 虚拟机 1 | WrapperSimpleApp 用法：
jvm 1 | java org.tanukisoftware.wrapper.WrapperSimpleApp {app_class} [app_arguments]
jvm 1 | 虚拟机 1 | 其中：
jvm 1 | app_class：要运行的应用程序的完全限定类名。
虚拟机 1 | app_arguments：通常会传递给 jvm 的参数 1 | 应用。
包装 | JVM 在加载应用程序时退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-25T08:27:35.197

如果您正在寻找类似命令行参数的参数，那么[wrapper.app.parameter.N](http://wrapper.tanukisoftware.com/doc/english/prop-app-parameter-n.html)（应用程序参数）和[wrapper.java.additional.N](http://wrapper.tanukisoftware.com/doc/english/prop-java-additional-n.html)（JVM 参数）怎么样

例如：

```
wrapper.app.parameter.1=myargument 
```

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T09:40:20.543

查看此[示例配置文件](http://wrapper.tanukisoftware.org/doc/english/props-example-config.html)，您似乎需要设置`wrapper.java.mainclass`属性。

# vb.net - PictureBox的ImageLocation

> ID：531526
> 
> 赞同：0
> 
> 时间：2009-02-10T08:50:32.613
> 
> 标签：vb.net, picturebox

我在代码中遇到问题。

**我的代码：**

```
Imports System.IO

Public Class Form1
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim myPics As New DirectoryInfo("F:\Documents and Settings\Adam\My Documents\My Pictures")
        Dim r As New Random
        Dim i As Integer = r.Next(myPics.GetFiles.Length)
        Dim Pics() As FileInfo = myPics.GetFiles

        PictureBox1.ImageLocation = Pics(i).FullName
    End Sub
End Class 
```

我得到错误：

> imagelocation 不是 windows.forms.picturebox 的成员

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T09:13:25.460

谷歌：[http ://www.daniweb.com/forums/thread127945.html](http://www.daniweb.com/forums/thread127945.html)

在此编码中，仅 Ctrl 是 Control 引用而不是 PictureBox。所以你需要将它投射到 PictureBox 参考

```
If TypeOf ctrl Is PictureBox And ctrl.Name = PictureBoxName Then
   Dim MyPictureBox as PictureBox
   MyPictureBox = ctrl

   MyPictureBox.Imagelocation = sFilename
   MyPictureBox.SizeMode = PictureBoxSizeMode.StretchImage
End If 
```

# linq - LINQ-to-SQL 选择过滤器

> ID：531530
> 
> 赞同：0
> 
> 时间：2009-02-10T08:52:33.327
> 
> 标签：linq, linq-to-sql

有没有办法确保在特定表的每次选择时将特定条件子句添加到表达式树中？

例如，具有删除记录日期的字段的表永远不应返回或包含在任何类型的语句中。

不是每次都包含 where 子句，有没有办法在不创建视图的情况下为每个选择添加条件？

--- 为清楚起见在下面进行编辑 ---

我正在寻找一个我可以部分的函数，就像插入/更新/删除函数一样，但用于选择。我想对针对表的所有查询应用一揽子过滤器。

此外，如果我从父母那里获得一组项目，我希望该集合也被过滤。

就像是：

```
Private Function BaseItems() As IQueryable(Of Item)
    Return (From mi In dataContext.Items Where mi.DeletedAt Is Nothing Select mi)
End Function
Public Function GetItems() as list(of Item)
    Return (From mi in BaseItems() select mi).ToList()
End Function 
```

适用于我编写和调用的函数。例如，ITEMS 可以是 MASTER 的子项。

```
'assume TheMaster is a LinqToSQL data class which has a one to many child of Items
TheMaster.Items.Count '<-- will bring back all Items. 
```

我如何始终过滤由数据类填充的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:05:47.117

您应该能够做到这一点，我将项目放入列表中，然后使用 lambda 表达式过滤列表？

```
MyListObject.Where(x => x == x.Date); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T09:02:04.757

我不确定我是否理解你的问题的上下文。但是，您可以在 linq 查询中添加更多 where 条件。如果您返回一个 IQueryable，您将只返回一个可运行的查询，并且您可以在其上链接其他 LINQ 查询。Afaik 它不会执行，直到您开始将其设置为 IEnumerable 或 List 进行迭代。

LINQ-to-SQL 示例：

```
MyDataContext context = new MyDataContext();

public IQueryable<MyTable> GetTable() {
    return from record in context.Records
           where record.Date > DateTime.Now
           select record;
}

public IEnumerable<MyTable> GetTableWithinWeek() {
    return from record in GetTable()
           where record.Date < DateTime.Now.AddDays(7);
           select record;
} 
```

我希望我的回答有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T10:58:32.393

DataContext 的 DataLoadOptions 中的 AssociateWith 似乎可以满足我的需要。

# sql - 如何使用 SQL 创建多个存储过程

> ID：531535
> 
> 赞同：2
> 
> 时间：2009-02-10T08:54:26.147
> 
> 标签：sql, sql-server, vb.net, sql-server-2005, tsql

我有一个 vb.net 函数，它根据传递给函数的参数创建几个存储过程。

我想将此 vb.Net 移动到单个 SQL 文件中（出于维护原因），但我不确定如何在 SQL 中重新创建它而不创建 7 个单独的存储过程。

我总共创建了 20 个存储过程，我真的不想在 SQL 文件中创建这么多，因为维护将是一场噩梦。我想知道是否有类似于我在下面的 VB.Net 中完成的解决方案：

```
Private Sub CreateStoredProcedures()

        CreateSP("SummaryNone", "YEAR([sale].[DateTime])")
        CreateSP("SummaryUser", "[sale].[User]")
        CreateSP("Summarysale", "[sale].[sale]")
        CreateSP("SummaryBatch", "[sale].[Batch]")
        CreateSP("SummaryDay", "dbo.FormatDateTime([sale].[DateTime], 'yyyy-mm-dd')")
        CreateSP("SummaryMonth", "dbo.FormatDateTime(dbo.DateSerial(YEAR([sale].[DateTime]), MONTH([sale].[DateTime]), 1), 'yyyy-mm-dd')")
        CreateSP("SummaryYear", "Year([sale].[DateTime])")

        Return
    End Sub

    Private Sub CreateSP(ByVal vName As String, ByVal vGroup As String)

        Dim CommandText As String = _
                        "CREATE PROCEDURE " & vName _
                        & " @StartDate varchar(50)," _
                        & " @EndDate varchar(50)" _
                        & " AS " _
                        & " SELECT " & vGroup & "                   AS GroupField," _
                        & " Sum([Project].[NumProject])                AS TotalProject," _
                        & " Sum([Project].[Title])                  AS SumTitle," _
                        & " Sum([Project].[Duration])               AS SumDuration," _
                        & " Sum([Project].[Info])                AS SumInfo," _
                        & " Sum([Customer].[NumCustomer]) AS TotalNumCustomer," _
                        & " Sum([Orders].[NumOrders])   AS TotalNumOrders," _
                        & " Sum([OrderInspection].[NumInspects])          AS TotalNumInspects," _
                        & " Sum([OrderInspection].[NumFails])             AS TotalNumFails," _
                        & " Sum([CustomerInspection].[NumInspects])    AS TotalNumCustomerInspectionInspects," _
                        & " Sum([CustomerInspection].[NumFails])       AS TotalNumCustomerInspectionFails," _
                        & " Sum([Measurements].[NumMeasurements]) AS TotalNumMeasurementss" _
                        & " FROM ((((((sale LEFT JOIN Project   ON [sale].[saleId]=[Project].[saleId])" _
                            & " LEFT JOIN Customer   ON [Project].[PrintId]=[Customer].[PrintId])" _
                            & " LEFT JOIN Orders    ON [Project].[PrintId]=[Orders].[PrintId])" _
                            & " LEFT JOIN OrderInspection       ON [Project].[PrintId]=[OrderInspection].[PrintId])" _
                            & " LEFT JOIN CustomerInspection ON [Project].[PrintId]=[CustomerInspection].[PrintId])" _
                            & " LEFT JOIN Measurements ON [Project].[PrintId]=[Measurements].[PrintId])" _
                        & " WHERE [sale].[DateTime] BETWEEN dbo.FormatDateTime((@StartDate), 'yyyy-mm-dd')" _
                        & " AND dbo.FormatDateTime((@Enddate),'yyyy-mm-dd')" _
                        & " GROUP BY " & vGroup & "" _
                        & " ORDER BY " & vGroup & ";"

        SqlExecuteNonQuery(CommandText)

        return
    End Sub 
```

我期待您的评论和回复。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T11:27:15.710

您可以将模板存储在文本文件中作为 .NET DLL 中的嵌入式资源。为您的动态位设置一些占位符。这将使您当前的解决方案更易于维护。然后从 DLL 加载流并保留当前的实现。

编辑文本文件比嵌入在 C# 文件中的大量 SQL 更容易。

如果将其移至单个 proc，您可能会受到性能影响，您可能会对它感到满意，但请记住，proc 也会有一些维护问题。我们通常喜欢在存储过程中避免使用动态 SQL。7 路 IF 分支是维护的噩梦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T09:00:24.823

我建议您创建一个您调用的存储过程。

然后使用动态SQL构建适当的SELECT语句以在单个存储过程中使用。

有道理？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T09:01:32.977

您可以创建一个名为 Summary 的存储过程，然后将名称和列作为附加参数传入。然后创建动态 SQL 并执行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T09:20:33.150

在我看来，动态构建语句然后执行它（在 T-SQL 中）是你最好的选择。如果一切顺利的话，我也不会在代码中创建存储过程。存储 porcs 的最大优势是它们的执行计划缓存在服务器上。如果您经常删除并重新创建它们，那么这些计划会因为 proc 被删除而被删除。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T11:39:23.327

SP 的优势在于它是预编译的，并且已经创建了执行计划，同时牢记创建 SP 时存在的数据。

因此，动态 SQL 会对性能产生影响，因为 sql server 无法事先找出要使用的索引（或者甚至不使用它们）。由于当前您正在替换*后*创建 sp ，因此正确创建了查询计划。切换到动态 sql 后就不会出现这种情况了。

您还可以使用 if then 条件创建一个 sp 来处理各种情况。但是，这需要维护，以防以后添加更多参数。

# php - ORM 查询结果：数组与结果句柄包装在迭代器接口中

> ID：531536
> 
> 赞同：2
> 
> 时间：2009-02-10T08:55:08.453
> 
> 标签：php, mysql, orm, activerecord, arrayiterator

好的，这是专业人士的：

几年来，我一直在研究我自己的 PHP ORM/ActiveRecord 实现，我将其命名为[Pork.dbObject。](http://www.schizofreend.nl/Pork.dbObject)

它大致基于几年前我们都看过的“在 5 分钟内用 Rails 制作自己的网站”电影。您可以执行以下操作：

```
$clients = dbObject::Search("Client", array("ID > 500")); 
```

或者

```
$client = new Client(218); // fetch row with id 218 from client table 
```

或者

```
$projects = $client->Find('Project'); 
```

这将从数据库中获取一行或多行，将它们包装在一个 dbObject 中并将它们返回到一个数组中，或者返回 false 没有结果。

所有这一切都在几十个站点和后端完美运行，但现在我的同事正在使用它来创建一个巨大的日志解析器，这里开始出现内存使用问题..

他运行的查询可以返回超过 20.000 行，甚至可能更多，这当然不是一件很好的事情，一次包装到一个对象包装器中并作为单个数组返回。

显而易见的解决方案是返回一个实现[Iterator](http://nl3.php.net/manual/en/class.iterator.php)接口的对象，而不是一个数组。它不应该立即从结果集中获取所有记录，而只是保存生成的数据库查询的结果资源，并在您遍历对象时在内部使用 mysql_fetch_* ，就好像它是一个数组一样。

现在我们来解决我真正的问题：我可以毫无问题地这样做吗？数据库是否能够处理多个打开的结果集，并将它们混合并在内存中保存一段时间？

例如，获取 20 个对象，循环它们，让这 20 个对象中的每一个获取另外 5 个对象，然后它们也获取另外 3 个对象。这将创建一个循环，其中许多不同的结果句柄将保存在内存中。

我知道我无法序列化这些对象之一，但我能否在 PHP5 中毫无问题地实现这一点，或者数据库接口会给我带来问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T09:05:17.510

这取决于您使用的数据库和数据库配置。

对于 MySQL，您需要确保使用缓冲查询。在 PDO 中，您可以这样设置：

```
$myPdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, true); 
```

这意味着所有数据都将发送到客户端（与在 PHP 中获取所有数据不同）。

另一种（可能更糟）的替代方法是，只要您检测到正在运行且结果集仍处于打开状态的查询，就打开一个新的数据库连接。

正常[`mysql_query()`](http://www.php.net/mysql_query)使用缓冲查询，因此可以处理多个结果集。

# c# - 顶部、底部、左侧、右侧的 C# 标准类（枚举？）

> ID：531545
> 
> 赞同：11
> 
> 时间：2009-02-10T08:58:58.960
> 
> 标签：c#

是否有一个标准的 c# 类定义了一个概念上的左、右、上和下？

我应该只使用我自己的吗？

```
enum controlAlignment
{
    left = 1,
    top,
    right,
    bottom,
    none = 0
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-10T09:07:09.593

快速搜索显示以下框架枚举已经拥有这些成员（有些还有其他额外成员）：

*   AnchorStyles - System.Windows.Forms
*   Border3Dside - System.Windows.Forms
*   DockStyle - System.Windows.Forms
*   边缘 - System.Windows.Forms.VisualStyles
*   TabAlignment - System.Windows.Forms
*   ToolStripStatusLabelBorderSides - System.Windows.Forms
*   VerticalAlignment - System.Windows.Forms.VisualStyles

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-05T12:23:08.843

一个不错的枚举也可能是：

系统.绘图。**ContentAlignment**（在 System.Drawing.dll 中）

这些是它的成员：

```
public enum ContentAlignment
{
    TopLeft = 1,
    TopCenter = 2,
    TopRight = 4,
    MiddleLeft = 16,
    MiddleCenter = 32,
    MiddleRight = 64,
    BottomLeft = 256,
    BottomCenter = 512,
    BottomRight = 1024,
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-10T09:02:23.710

也许 System.Windows.Forms.AnchorStyles 或 System.Windows.Forms.DockStyles 可以完成这项工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T09:02:35.207

除非您可以使用锚样式（它有更多）。我会为此推出自己的。在标准的 winforms 库中有**单独** `VerticalAlignment`的，`HorizontalAlignment`这可能很有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-29T00:37:40.410

我经常为此使用[System.Windows.Forms.ArrowDirection](http://msdn.microsoft.com/en-us/library/system.windows.forms.arrowdirection.aspx)，因为它并不意味着任何特定的意图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T09:01:39.407

阅读[FlagAttribute](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T09:08:49.373

好吧，除了您需要的四个之外`AnchorStyles`，还有其他值；另外打开了不一定有意义（左上角是什么意思？左上角呢？）`DockStyles``AnchorStyles``FlagAttribute`

由于我想不出任何可以以任何有意义的方式普遍利用标准 Anchor- 和 DockStyles 数据类型的内置函数，因此编写自己的枚举似乎比`Windows.Forms`仅仅为了枚举。

当然，除非您已经在 Windows.Forms 中，并且@Cerebrus 的建议之一在您的上下文中实际上是有意义的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-19T11:13:04.900

由于 .NET 中没有完全符合您要求的标准枚举，因此我建议您创建自己的枚举（就像我所做的那样）：

```
[Flags]
private enum Borders
{
    None = 0,
    Left = 1,
    Top = 2,
    Right = 4,
    Bottom = 8,
    All = Left | Top | Right | Bottom,
} 
```

然后，您可以通过调用该`HasFlag`方法来查询各个边。我同意@dbkk，重用具有相似值但不同含义的枚举可能会让任何阅读代码的人感到困惑。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-12-08T16:59:39.297

对于 WPF 项目（而不是 WinForms），有[`System.Windows.Controls.Dock`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.dock). 它只有`Left`、`Top`和。`Right``Bottom`

# delphi - 在 Delphi 中测量代码覆盖率

> ID：531546
> 
> 赞同：26
> 
> 时间：2009-02-10T08:59:06.400
> 
> 标签：delphi, unit-testing, code-coverage, dunit

有没有办法用 DUnit 测量代码覆盖率？或者有没有免费的工具可以做到这一点？你有什么用？你通常追求什么代码覆盖率？

Jim McKeeth：感谢您的详细回答。我说的是 TDD 方法意义上的单元测试，而不仅仅是发生故障后的单元测试。我对通过一些基本的预写单元测试可以实现的代码覆盖率感兴趣。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-06-25T05:08:29.390

我刚刚使用 Delphi 2010 的基本代码覆盖工具在 Google Code 上创建了一个新的开源项目。 [https://sourceforge.net/projects/delphicodecoverage/](https://sourceforge.net/projects/delphicodecoverage/)

现在它可以测量线路覆盖率，但我也计划添加类和方法覆盖率。

它生成带有摘要的 html 报告以及标记的源代码，向您显示哪些行被覆盖（绿色），哪些行未被覆盖（红色）以及没有为它们生成任何代码的其余行。

**更新：从**[Delphi 代码覆盖率](https://sourceforge.net/projects/delphicodecoverage/) 0.3 版开始，您可以生成与 Hudson EMMA 插件兼容的 XML 报告，以显示[Hudson](http://hudson-ci.org/)中的代码覆盖率趋势。

**更新：** 0.5 版带来了错误修复、增强的可配置性和清理报告

**更新：** 1.0 版支持 emma 输出、类和方法的覆盖以及 DLL 和 BPL 的覆盖

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-10T11:34:50.840

我不知道任何免费工具。 [AQTime](http://www.automatedqa.com/products/aqtime/index.asp)几乎是分析 Delphi 的事实标准。我没用过，但是快速搜索发现了[Discover for Delphi](http://sourceforge.net/projects/discoverd/)，它现在是开源的，但只是进行代码覆盖。

这些工具中的任何一个都应该让您了解单元测试的代码覆盖率。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T09:55:39.417

您是指单元测试的代码覆盖率还是陈旧的代码？一般来说，我认为只有失败的可测试代码才应该被单元测试覆盖（是的，我意识到这可能会开始一场圣战，但这就是我的立场）。所以这将是一个相当低的百分比。

另一方面，现在陈旧的代码是另一回事。陈旧的代码是不被使用的代码。对于很多代码，您很可能不需要工具来告诉您这一点，只需在 Delphi 中编译后查找小蓝点即可。任何没有蓝点的东西都是陈旧的。一般来说，如果代码没有被使用，那么它应该被删除。所以这将是 100% 的代码覆盖率。

陈旧代码还有其他情况，例如如果日期是 2 月 31 日，您需要处理特殊代码。编译器不知道它不会发生，所以它编译它并给它一个蓝点。现在您可以为此编写一个单元测试，并对其进行测试，它可能会起作用，但是您只是第二次浪费了时间（第一次是编写代码，第二次是测试它）。

有一些工具可以跟踪程序运行时使用了哪些代码路径，但这只是比较可靠的，因为并非每次都会使用所有代码路径。就像您必须处理闰年的特殊代码一样，它只会每四年运行一次。所以如果你把它拿出来，那么你的程序每四年就会被打破一次。

我想我并没有真正回答你关于 DUnit 和代码覆盖率的问题，但我想我可能给你留下了比你开始时更多的问题。您正在寻找什么样的代码覆盖率？

**更新：** 如果您采用 TDD 方法，那么在您为其编写测试之前不会编写任何代码，因此本质上您有 100 个测试覆盖率。当然，仅仅因为每个方法都被测试执行并不意味着它的整个行为范围都被执行了。 [SmartInspect](http://www.gurock.com/products/smartinspect/)提供了一种非常简单的方法来测量哪些方法被调用以及时间等。它比 AQTime 少一点，但不是免费的。通过您的更多工作，您可以添加工具来测量每个代码路径（“if”语句的分支等）。当然，您也可以将自己的日志记录添加到您的方法中以获得覆盖率报告，这是免费的（好吧，期待您的时间，这可能比工具更有价值）。如果您使用 JEDI Debug，那么您也可以获得调用堆栈。

如果不进行大量重构，TDD 确实不能轻易地追溯应用到现有代码。尽管较新的 Delphi IDE 能够为每个公共方法生成单元测试存根，从而为您提供 100% 的公共方法覆盖率。您在这些存根中放入的内容决定了覆盖范围的有效性。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-10T15:04:41.413

我使用[Discover for Delphi](http://www.sourceforge.net/projects/discoverd/)，它可以完成工作，用于使用 DUnit 进行单元测试和使用 TestComplete 进行功能测试。

Discover 可以配置为从命令行运行以实现自动化。如：

```
Discover.exe Project.dpr -s -c -m 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T22:40:57.353

Discover 非常适合我。与 AQTime 不同，它几乎不会减慢您的应用程序的速度。当然，这对你来说可能不是问题。我认为最近版本的 AQTime 在这方面表现更好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-05T13:00:03.543

我已经使用 Discover 多年了，在 BDS2006 之前（包括我使用并仍在使用的最后一个预 XE* 版本的 Delphi）工作得非常出色，但它目前的开源状态，尚不清楚如何使它与XE* 版本的 Delphi。真的很遗憾，因为我喜欢这个工具，几乎在所有方面都快速方便。所以现在我正在转向 delphi-code-coverage...

# cocoa-touch - 没有内存泄漏的字符串操作？

> ID：531550
> 
> 赞同：5
> 
> 时间：2009-02-10T09:01:17.910
> 
> 标签：cocoa-touch, memory-management

我想对删除的 xml 转义字符进行一系列字符串替换，例如`'&amp;'`.

1）是否有现有的 UIKit 功能可以做到这一点？

2）如果不是，那么在不泄漏内存的情况下最好的方法是什么？这是想法：

```
-(NSString*) unescape:(NSString*)string
{
    string = [string stringByReplacingOccurrencesOfString:@"&apos;" withString:@"'"];
    string = [string stringByReplacingOccurrencesOfString:@"&amp;" withString:@"&"];
    string = [string stringByReplacingOccurrencesOfString:@"&quot;" withString:@"\""];
    string = [string stringByReplacingOccurrencesOfString:@"&gt;" withString:@">"];
    string = [string stringByReplacingOccurrencesOfString:@"&lt;" withString:@"<"];
    return string;
} 
```

但是每次分配不会泄漏内存吗？还是 stringByReplacingOccurrencesOfString 返回自动释放的字符串？我们如何确认 stringByReplacingOccurrencesOfString 字符串是自动释放的？或者我们应该用 包裹它们`[... autorelease]`？

即使它们是自动发布的，最好避免在 iPhone 上自动发布。（见[这里](http://kosmaczewski.net/2009/01/28/10-iphone-memory-management-tips/)）。那么我们会这样做：

```
-(NSString*) unescape:(NSString*)string
{
    NSString* string2 = [string stringByReplacingOccurrencesOfString:@"&apos;" withString:@"'"];
    // don't release 'string' because we didn't allocate or retain it
    NSString* string3 = [string2 stringByReplacingOccurrencesOfString:@"&apos;" withString:@"'"];
    [string2 release];
    NSString* string4 = [string3 stringByReplacingOccurrencesOfString:@"&apos;" withString:@"'"];
    [string3 release];
    //...and so on
} 
```

但这是非常难看的代码。编写此代码进行多次替换的最佳方法是什么？你会怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T09:18:51.750

`init`任何通过不以单词开头或不包含单词的方法返回新对象的可可方法都`copy`将返回一个自动释放的对象。所以上面的代码应该有noleaks。

虽然在这里使用 NSMutableString 可能更容易。然后，您只需在适当的位置修改字符串，而不是创建一堆自动释放的字符串对象，这应该会使事情变得更干净。

此外，您如何遍历一个映射字典，找到每个项目的`key`并替换为`value`。甚至可以将其保存为应用程序中的 plist，以便以后轻松调整。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T14:19:38.353

正如 Squeegy 所说，您引用的所有上述方法都返回自动释放的对象。第二个代码示例将崩溃，因为您过度释放字符串对象。

Squeegy 指出了一种处理方法，即使用 NSMutableStrings。我会推荐这种方法。例如，以下重写您的方法：

```
-(NSString*) unescape:(NSString*)string
{
    NSMutableString *unescapedString = [[NSMutableString alloc] initWithString:string];
    [unescapedString replaceOccurrencesOfString:@"&apos;" withString:@"'" options:0 range:NSMakeRange(0, [unescapedString length])];
    [unescapedString replaceOccurrencesOfString:@"&amp;" withString:@"&" options:0 range:NSMakeRange(0, [unescapedString length])];
    [unescapedString replaceOccurrencesOfString:@"&quot;" withString:@"\"" options:0 range:NSMakeRange(0, [unescapedString length])];
    [unescapedString replaceOccurrencesOfString:@"&gt;" withString:@">" options:0 range:NSMakeRange(0, [unescapedString length])];
    [unescapedString replaceOccurrencesOfString:@"&lt;" withString:@"<" options:0 range:NSMakeRange(0, [unescapedString length])];
    return [unescapedString autorelease];
} 
```

最后只返回一个自动释放的 NSMutableString。

如果你传入一个指向 NSMutableString 指针 (NSMutableString **) 的指针会更好。这样，您可以修改在方法之外创建的字符串，而无需创建新的临时字符串。如果这看起来很奇怪，请以处理 NSError 实例的方法为例。

编辑：忽略我在上一段中关于需要双指针的声明。正如 erikprice 所指出的，您只需要传入一个 NSMutableString 指针。仅当您在方法中创建一个新的 NSMutableString 实例来替换传入的实例时才需要双指针，这里不是这种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T14:36:53.850

我建议您阅读[Cocoa 内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Tasks/MemoryManagementRules.html)。

# web-services - tomcat轴文件server-config.wsdd从哪里来？

> ID：531557
> 
> 赞同：2
> 
> 时间：2009-02-10T09:03:08.810
> 
> 标签：web-services, apache, soap, axis

我们系统的一部分通过 apache tomcat 提供了一个 web 服务，该服务在 server-config.wsdd 文件中被引用。不幸的是，没有人记得它是如何进入那里的。apache 设置已更改，我需要更新系统以获取新配置。我可以用谷歌搜索哪些神奇的关键字来帮助我弄清楚它如何以及为什么进入现有的 server-config.wsdd，以及它如何适合新的 server-config.wsdd

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T09:08:20.623

server-config.wsdd 文件由 Axis 的 wsdl2java 工具生成。因此，一些开发人员使用了该工具并将该文件复制到了它所属的 Tomcat conf 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T15:09:57.010

server-config.wsdd 是在您通过运行部署 Web 服务时创建的

java org.apache.axis.client.AdminClient \deploy.wsdd

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-11T22:21:10.443

我的知识说它是硬编码的......并且通过使用 java org.apache.axis.client.AdminClient \deploy.wsdd 或通过 ant 脚本显式调用它，您可以将它体现到 server-config.wsdd 并部署服务

# php - 我在哪里可以找到某人（谁知道他们在做什么）编写 PHP 的视频？

> ID：531558
> 
> 赞同：1
> 
> 时间：2009-02-10T09:04:32.753
> 
> 标签：php, video

自从我做任何 PHP 以来已经有好几年了。

我在 .NET 中工作，但应该与一些 PHP 人合作。我真的很想了解一下语言和 IDE 工具的变化——但我真的没有时间也没有精力去学习任何东西。我可能不必编写任何 PHP，但我想。

因此，我正在寻找[像这些 .NET](http://www.asp.net/learn/mvc-videos/video-422.aspx)之类的视频，您可以在其中看到 IDE、基本的工作方式等。我不是在寻找使用记事本的人 - 我想要一些我可以看到的东西真正的专家 PHP 程序员工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T13:00:50.697

问题是 PHP 没有单一的“IDE”和“方式”。有大量的工具、框架、库、扩展、IDE、插件等。

我最喜欢的 PHP IDE 是**Aptana ，关于****[Aptana](http://www.aptana.tv/)**的好处是有 Aptana.tv：http://www.aptana.tv/ ，它有关于 IDE 各个方面的非常好的视频播放...

Video **PHPEditorPart1**非常接近您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T09:16:39.120

我发现[Lynda.com](http://www.lynda.com)是一个非常有用的资源，尽管视频不是免费的。如果您可以让您的公司以登录的成本迅速崛起，那么对于办公室中的任何人来说，它往往是一个相当不错的地方，可以学习一些新技能。

对于免费的东西，我发现[学习列表](http://www.thelearnlist.com/php.php)相当不错，学习列表中的 PHP 链接让我在[这个网站上](http://www.phpvideotutorials.com/)找到了 php 视频。

希望这些链接对您有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T12:41:30.260

我唯一可以建议的是[这里](http://codeigniter.com/tutorials/)的 CodeIgniter 操作视频。它应该让您大致了解典型 PHP 应用程序的架构是如何布局的，以及编码人员如何创建它。

无论您做什么，都不要在 Youtube 上搜索 PHP。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T14:03:33.447

PHP 没有特定的 IDE。如果您愿意，可以将其写在记事本或 vi 中。

你最好的选择是开始阅读书籍。视频很棒，但学习方法比学习任何 IDE 都重要。当您观看视频时，您会错过很多侧面细节，这太疯狂了。

# iphone - iPhone 单元测试挂起；调用 -applicationDidFinishLaunching 失败：

> ID：531561
> 
> 赞同：2
> 
> 时间：2009-02-10T09:05:19.053
> 
> 标签：iphone, unit-testing, ocunit

我为我的 iPhone 项目设置了单元测试，该项目使用基于 OCUnit的[Google Toolkit for Mac框架构建。](http://code.google.com/p/google-toolbox-for-mac/wiki/iPhoneUnitTesting)我有一个名为“单元测试”的依赖项目，它根据需要构建和运行测试。

但后来一切都停止了，我无法理解。突然，我的“单元测试”可执行文件启动并就在那里等待，永远。它永远不会达到应用程序委托的`-applicationDidFinishLaunching:`方法，这就是所谓的实际单元测试。将 NSLog 插入委托的`-init`方法告诉我该方法被调用，但应用程序永远不会“完成”启动。

如果我修改运行“单元测试”可执行文件的 shell 脚本并取出`-RegisterForSystemEvents`参数，可执行文件立即存在（它不运行任何测试）并给我以下消息：

> 由于没有系统事件服务器而终止。
> （如果您想在没有 SpringBoard 的情况下运行，请运行 EventPump 或传递参数“-RegisterForSystemEvents”。

由于它在我删除该参数时终止，所以我很好奇该参数到底是做什么的以及如何，因为它似乎会导致挂起。但由于没有它就无法运行测试，我需要确定如何让它再次工作。但是，Google 没有提供与当前情况相关的任何内容的链接，并且开发文档中的任何内容都没有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-24T17:14:46.840

如果 Xcode 在构建期间挂起（构建结果窗口显示“运行自定义 shell 脚本”但在那里停止），请选择单元测试目标并单击“获取信息”。然后选择属性选项卡并清除“主笔尖文件”的文本字段并清理目标。

单击“构建并开始”现在应该可以成功运行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T17:34:44.187

万一其他人遇到这种情况，这就是我终于开始工作的地方。

我制作了代码的本地副本，然后将整个代码库恢复到我的 Git 存储库中的先前提交。干净的结帐仍然可以正常运行测试。然后我逐个文件重新引入我的更改，检查每次增量合并后单元测试是否有效。

当单元测试表明失败时，我希望能达到某个点，但它从来没有出现过。我合并了所有更改，单元测试仍然运行良好。

显然，这对于没有 SCM 系统和工作副本可恢复的任何人都没有帮助。在这种情况下，创建一个干净的项目并将您的代码拉过来将是最好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-01T19:27:26.830

我们从今天早上开始解决了这个问题。树顶 GTM 不应再挂起。它与委托在有机会获得 applicationDidFinishLaunching 事件之前被切换有关。此线程中的更多详细信息：

[http://groups.google.com/group/google-toolbox-for-mac/browse_thread/thread/513a3252d655e1e3](http://groups.google.com/group/google-toolbox-for-mac/browse_thread/thread/513a3252d655e1e3)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-02T12:53:52.083

我遇到了同样的问题 - 看起来我在 IB 中搞砸了我的 AppDelegate。

确保：

*   您在 NIB 中实例化了 AppDelegate 类。

*   它的`window`出口指向该NIB 中的UIWindow。

*   任何其他出口都指向它们应该指向的位置（在我的情况下，tabBarController 到我的实例化 UITabBarController）。

*   最后，您的 File's Owner 代表出口指向您的 AppDelegate

唷。

# arrays - 暗淡的 ASP 数组

> ID：531564
> 
> 赞同：1
> 
> 时间：2009-02-10T09:06:07.460
> 
> 标签：arrays, vbscript

我想定义一个数组。

我的问题是**Dim x(999)**或**Dim x(9999)**成本相同还是 Dim x(9999) 会浪费更多资源？

非常感谢你！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T09:18:21.940

自然地创建一个包含 9999 个元素的数组将比只有 999 个元素的数组使用更多的内存。我怀疑这不是你的问题。也许您正试图找出一种方法来为动态数据量分配足够的内存？您可以使用 ReDim 语句在经典 ASP (VBScript) 中调整数组的大小 - 一旦知道真实大小，您就可以执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T09:19:25.867

数组分配在连续的内存中。因此，包含 10000 个元素的数组将占用需要 1000 个元素的数组的 10 倍内存。

您可以从小处着手，并在需要时扩展您的阵列。我过去曾使用过这种类来创建可变长度列表类型。

```
Class List
    Dim maItems
    Dim mlCount

    Public Sub Class_Initialize()
       ReDim maItems(8)
       mlCount = 0
    End Sub

    Public Function Add(Item)
       If mlCount = UBound(maItems) ReDim Preserve maItems(mlCount * 2)
       mlCount = mlCount + 1
       maItems(mlCount) = Item
       Add = mlCount
    End Function

   Public Property Get Item(Index)
       If Index < 1 Or Index > mlCount Then Error.Raise 9, "List", "Subscript out of Range"
       Item = maItems(Index)
   End Property

   Public Property Get Count()
       Count = mlCount
   End Property
End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T09:23:28.573

数组有那么大吗？

为什么不将其分配为动态，然后随着它的增长而扩展？

```
<%
Dim myDynArray() 

ReDim myDynArray(1)
myDynArray(0) = "Albert Einstein"
myDynArray(1) = "Mother Teresa"

ReDim Preserve myDynArray(3)
myDynArray(2) = "Bill Gates"
myDynArray(3) = "Martin Luther King Jr."

For Each item In myDynArray
    Response.Write(item & "<br />")
Next
%> 
```

上面代码的输出是

```
Albert Einstein Mother Teresa Bill Gates Martin Luther King Jr. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-23T12:15:25.280

我在 Anthony W Jones 的代码中添加了一些内容，因此它返回了一个大小正确且仅包含相关元素的数组 (ToArray())。

```
Class List    
    Dim maItems    
    Dim mlCount

    Public Sub Class_Initialize()       
        ReDim maItems(8)
        mlCount = 0    
    End Sub    

    Public Function Add(Item)            
        If mlCount = UBound(maItems) Then ReDim Preserve maItems(mlCount * 2)       
        maItems(mlCount) = Item  
        mlCount = mlCount + 1
        Add = mlCount   
    End Function

    Public Property Get ToArray()

        ReDim Result(Params.Count-1)

        Dim i
        For i = 0 to Params.Count-1
            Result(i) = Params.maItems(i)
        Next

        ToArray = Result        
    End Property

    Public Property Get Item(Index)       
        If Index < 1 Or Index > mlCount Then Error.Raise 9, "List", "Subscript out of Range"       
        Item = maItems(Index)   
    End Property   

    Public Property Get Count()       
        Count = mlCount   
    End Property   
End Class 
```

# logging - 寻找免费的日志文件阅读器

> ID：531565
> 
> 赞同：3
> 
> 时间：2009-02-10T09:06:29.410
> 
> 标签：logging

我正在寻找一个可以实时读取日志（例如跟踪日志）的免费文本日志阅读器，因为它们被写入。暂停和恢复功能也会很好。

我应该澄清一下 - 该工具需要在 Windows 上运行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T09:39:04.993

我用[的是baretail](http://www.baremetalsoft.com/baretail/)，有免费版

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T09:15:45.533

在 Windows 中，NotePad++ 可以解决问题（支持实时文本文件监控）...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T09:09:21.430

tail -f 日志文件路径

暂停：ctrl-z
恢复：fg

适用于 unix/linux shell 或 cygwin

或者，使用“less”命令（unix/cygwin）。运行时按“F”（shift+F），“less”将作为“tail”命令工作......将显示日志文件的尾部。暂停：'ctrl-C'，恢复：再次按'F'。

# image - 未压缩纹理的最佳图像格式？

> ID：531574
> 
> 赞同：1
> 
> 时间：2009-02-10T09:08:13.383
> 
> 标签：image, textures

我正在选择一种图像格式，该格式将用作所有内部纹理的存储格式。该格式将用作生成不同平台和配置的压缩纹理的源格式，因此需要涵盖所有可能的纹理类型（2D、立方体、体积测量、不同数量的 mip-map、浮点像素格式、等）并且完全无损。此外，格式必须能够保留一些元数据。

目前为此使用了一种自定义格式，但由于在大多数图像编辑器中都可以查看，因此艺术家可以更容易地使用常用格式。

我曾想过使用 DDS，但据我所知，这种格式不支持元数据。

所有建议表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T09:37:54.560

根据您的要求，您应该保持自制格式。除了支持体积和立方体纹理的 DDS 之外，我不知道任何图像格式。不幸的是，DDS 不支持元数据。

您能找到的最接近的是 TIFF。它不直接支持立方体贴图或体积纹理，但它支持任意数量的子图像。这样，您可以将子图像重新用作切片或立方体。

TIFF 对自定义元数据也有很好的支持。libtiff 图像读/写库工作得很好。如果您来自 OO 方面，它看起来有点过时，但它完成了它的工作。

尼尔斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T09:19:53.480

[在查看各种游戏的资源时，我发现它们中的大多数都在TGA](http://en.wikipedia.org/wiki/Truevision_TGA)中存储了纹理（我不知道它们是否被压缩）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T10:16:30.363

对于支持任意元数据和多帧的格式，TIFF 可能是您最接近的选择，但我认为您最好将资产（在本例中为图像）与它们在引擎中的转换和使用方式分开。

将图像保存为 32 位 PNG 格式，并将类型和元信息放入 XML。这使您的数据保持可见、可读和可编辑。晦涩的自定义格式适用于引擎，而不是人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T11:56:07.590

坚持与您的艺术家合作的任何东西。

*   如果您是 windows/mac 商店并使用带有 .psd 的 Photoshop Stick
*   如果您是 unix 商店并使用带有 .xcf 的 gimp 棒

这些格式将存储图层以及您的艺术家需要和习惯的所有东西。由于您的艺术家将创建大量资产，因此即使这意味着编写一些额外的代码，也可以使他们的生活尽可能轻松。

如果本机格式 (psd/xcf) 不支持元数据（无论它可能是什么），请将其放在图像“沿”的某个位置。

对于立方体贴图之类的东西，mipmaps（如果不是由转换器生成）坚持命名指导线或指导线如何将它们放入一个文件中。

根据您用于创建体积材料的工具，只需坚持使用该工具的原生格式即可。

虽然为目标编写自定义格式通常是一个好主意，但为艺术家编写自定义格式会导致混乱......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T14:54:57.610

我对 DDS 的经验是，它是一种文档记录不充分且难以使用的格式，并且几乎没有优势。通常更简单的方法是为每个图像类存储一个主文件，该文件具有对构成它的源图像的引用（即立方体贴图的 6 个面，体积纹理的任意数量的切片）以及任何其他有用的元数据。将元数据保存在单独的文件（或数据库）中总是一个好主意，因为您不希望在执行搜索、填充浏览器等时加载大量图像。这也很有意义将源图像格式（tiff、tga、jpeg、dds ...）与“元格式”（cube、volume ...）分开，因为您可能会发现需要使用有损压缩来支持 HDR 格式或非常大的源体数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T09:19:11.860

你试过PNG吗？[http://java.sun.com/javase/6/docs/api/javax/imageio/metadata/doc-files/png_metadata.html](http://java.sun.com/javase/6/docs/api/javax/imageio/metadata/doc-files/png_metadata.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T15:02:50.557

作为替代解决方案，也许花一些时间为您的文件格式编写[免费图像编辑器插件？](http://en.wikipedia.org/wiki/Paint.NET#Plugins)我以前从来没有做过，所以我不知道所涉及的工作，但是那里有大量的示例代码供您使用。

# windows - 例如，为什么 Windows 给我的硬盘提供字母 C 而不是 A 或 B？

> ID：531576
> 
> 赞同：57
> 
> 时间：2009-02-10T09:08:23.087
> 
> 标签：windows, operating-system

是因为操作系统是用 C 编程语言编写的吗？我认为 A 和 B 语言没有那么成功？

我 13 岁，正在尝试用 C# 进行计算机编程。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-10T09:14:57.657

[维基百科](http://en.wikipedia.org/wiki/Drive_letter_assignment)对驱动器字母的逻辑给出了很好的解释：

除 CP/M 和早期版本的 MS-DOS 外，操作系统根据以下算法分配驱动器号：

1.  将驱动器号 A：分配给第一个软盘驱动器（驱动器 0），将 B：分配给第二个软盘驱动器（驱动器 1）（如果存在）。
2.  为在第一个物理硬盘上识别的第一个活动主分区分配一个以 C: 开头的驱动器号。
3.  将后续驱动器号分配给每个连续物理硬盘驱动器上的第一个主分区（如果系统中存在）。
4.  将后续驱动器号分配给每个已识别的逻辑分区，从第一个硬盘驱动器开始，一直到后续的物理硬盘驱动器（如果系统内存在）。
5.  将后续驱动器号分配给任何 RAM 磁盘。
6.  将后续驱动器号分配给任何其他软盘或光盘驱动器。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-10T09:14:11.387

它是原始 PC 设计的遗留物。最初 PC 最多只有 2 个标记为 A 和 B 的软盘驱动器。一段时间后，添加了硬盘并成为驱动器 C。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-10T09:11:49.710

硬盘盘符是 C，因为从历史上看，驱动器 A 和 B 用于软盘。它与编写操作系统的语言无关。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-10T09:42:25.050

啊，软盘，还记得吗？

您可能会花一整个下午编写最新的杀手级应用程序，然后发现无法保存它，因为它太大而无法放入 5.25 英寸单密度磁盘。

那是软盘真正软盘的时候。薄而脆弱，通常为 5.25" 或 8" 尺寸，尽管 PC 中出现的第一个内部驱动器是 5.25"。如前所述，早期版本的 MS Dos 用于自动将驱动器 A：分配给第一个软盘驱动器和B: 到第二个。那时硬盘甚至连个人电脑都装不下。你可以买一个 5mb 的温彻斯特硬盘，它重约 30 公斤，装在一个几乎有现代迷你塔式电脑大小的大型外部机柜中。

如果您的 PC 有双软盘，您可以键入类似“复制 a：b：”的命令，将驱动器 A：的内容复制到驱动器 B：

但这一切都回到了比尔盖茨身价约 10,000 美元的时代！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T09:13:03.963

这是因为在软盘驱动器成为常态并且没有硬盘的时代，A 和 B 曾经是软盘驱动器。字母 C 分配给用户安装的任何硬盘。从那时起，驱动器 A 和 B 就被保留用于软盘驱动器。这与编程语言无关。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-01-17T12:14:02.123

虽然软盘驱动器连接到驱动器 0 和 1（`A`和`B`），但如今，存储卡和 SD 卡与任何其他驱动器（硬盘驱动器、CD-ROM 读卡器......）一样，只需*在* `C`.

`A`并`B`出于向后兼容性的原因而保留。

为了更好地说明（最后，2014 年第一季度）软盘驱动器是如何消失的，请考虑新的 Eclipse 图标：

[Lars Vogel刚刚在他的文章“](http://blog.vogella.com/author/vogella/) [Eclipse`org.eclipse.ui`切换到 png 文件并挥手告别软盘](http://blog.vogella.com/2014/01/17/eclipse-org-eclipse-ui-switches-to-png-files-and-waves-good-bye-to-the-floppy-disk/)”中引用了这个 Stack Overflow 问题。

它说明下一个 Eclipse Luna 4.4 将不再显示软盘，而是显示“现在有点像 SD 卡”的图标。

它们由来自[http://www.l33tlabs.com/的](http://www.l33tlabs.com/)[https://twitter.com/enleeten](https://twitter.com/enleeten)设计，使用 png 文件来：

> 支持透明度，因此在深色主题（背景）上也很好看。

我发现差异很微妙：

后：

![http://blog.vogella.com/wp-content/uploads/2014/01/Selection_002-300x53.png](https://i.stack.imgur.com/SGX0F.png)

之前（旧图标）：

![http://blog.vogella.com/wp-content/uploads/2014/01/Selection_003.png](https://i.stack.imgur.com/6pVV0.png)

* * *

这记录在[错误 422175](https://bugs.eclipse.org/bugs/show_bug.cgi?id=422175)中：

> 有人在推特上提到，如今传统的保存“软盘”习语有些不合时宜。因此，在处理 eclipse 图标时，我们创建了一个新版本的保存图标。
> 
> **新图标保留了软盘图标的轮廓，但用一些电子触点取代了软盘滑动门，有效地将图标变成了存储卡**。这确保了图标被大多数用户识别为“保存”，同时仍然代表现代存储媒体。
> 
> 我附上了一张图片进行比较。
> 
> *   第一行是当前图标，
> *   第二行是一个更极端的变化（使它看起来像一张 SD 卡）和
> *   第三行是我们在这个错误中提出的图标。

![在此处输入图像描述](https://i.stack.imgur.com/EuA3G.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-12-10T10:02:22.637

> 在运行 Windows 或 MS-DOS 的计算机上，硬盘驱动器标有驱动器号 C，因为它是硬盘驱动器的第一个可用驱动器号。计算机会为软盘驱动器和可移动媒体（如磁带驱动器）保留 A: 和 B: 驱动器号，即使计算机中没有安装这些设备也是如此。当您安装其他驱动器并创建新分区时，它们将分配给 C 之后的其他驱动器号，例如 D、E、F、G 等。

[资源](https://www.computerhope.com/issues/ch000799.htm)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T09:11:41.660

我会说这是因为 A: 和 B: 驱动器传统上是软盘驱动器，早期的计算机要求您使用可引导软盘引导。

我强烈怀疑字母是否与编程语言有关。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T09:12:54.510

我认为这是旧版本的 Microsoft 操作系统的一种遗留物，其中字母 A 和 B 被分配给软盘驱动器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T09:14:44.880

认为 DOS 是从软盘驱动器工作的，而基于 DOS 构建的 Windows 继续使用相同的驱动器号约定......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-10T09:17:54.170

[驱动器号的起源](http://www.ecprogress.com/index.php?tier=1&article_id=7206)

```
*But why the letter "C"? Why not "A" or "B"? Why not "Z?"* 
```

不出所料，答案在于微软的旧 DOS 根源。早在 Windows 出现之前，大多数与 PC 兼容的计算机系统中只有一个磁盘驱动器——软盘驱动器。当时，用户只需在开机前将 DOS 软盘插入计算机，计算机就会启动，或通过软盘上的软件“启动”。作为安装在计算机中的第一个也是唯一一个磁盘驱动器，软盘被分配了字母表的第一个字母。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-06-24T04:41:06.073

在运行 Windows 或 MS-DOS 的计算机上，硬盘驱动器标有 C: 驱动器号。原因是因为它是硬盘驱动器的第一个可用驱动器号。计算机会为软盘驱动器和可移动介质（如磁带驱动器）保留 A: 和 B: 驱动器号，即使计算机中未安装这些设备也是如此。当您安装其他驱动器并创建新分区时，会将它们分配给 C 之后的其他驱动器号，例如 D、E、F、G 等。

# visual-studio - 如何防止VS2008保存书签？

> ID：531581
> 
> 赞同：1
> 
> 时间：2009-02-10T09:10:04.330
> 
> 标签：visual-studio, visual-studio-2008, editor, text-editor, bookmarks

当我重新打开文档时，VS2008 会自动保存书签并恢复它们。我怎么能告诉它停止保存它们。当我打开一个文档时，我希望它没有任何书签，就像以前版本的 VS 一样。

我浏览了整个选项集两次，但找不到与书签相关的任何内容。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T10:10:20.037

您应该能够编写处理`DocumentEvents`或`WindowEvents`事件接口的宏。

响应 (eg)`DocumentEvents_OnDocumentOpened`获取`Document`对象，您应该能够删除所有书签。

或者，如果书签与窗口相关，您可能需要处理`WindowEvents_OnWindowCreated`.

文档声称这些仅供 Microsoft 内部使用，但它对`BuildEvents`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T22:00:20.787

CTRL+B CTRL+C 组合键清除所有书签。您可以在保存之前使用它，尽管它会清除所有文件中的所有书签并显示确认对话框。

# java - netbeans 6.1 中的 Java bean 事件

> ID：531585
> 
> 赞同：0
> 
> 时间：2009-02-10T09:11:22.737
> 
> 标签：java, netbeans, events, javabeans

我有一个 JPanel bean，里面有两个 JToggle 按钮。我编译这个 bean 并将其添加到 netbeans 调色板，然后我将它添加到一个框架中。然后我右键单击 bean 并从事件中选择一个鼠标事件让我们说'释放'。此事件对应于 JPanel 而不是里面的两个按钮。因此我无法捕获来自 JToggle 按钮的鼠标事件。我怎样才能捕获这些事件？我希望这是一个明确的问题谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:31:32.500

您获取 JPanel 事件的原因是它是当前具有焦点的控件。通过单击表单将焦点移动到面板内的 JToggle 按钮可能很困难或不可能。最好使用 Inspector 视图，在其中找到 JToggle 按钮并右键单击它们。

**编辑：**我错过了您自己创建 bean 然后将其添加到调色板的一点。在这种情况下，您有责任为新 bean 添加所需的事件。

# java - 如何在 GlassFish 中使用属性文件

> ID：531593
> 
> 赞同：10
> 
> 时间：2009-02-10T09:13:05.540
> 
> 标签：java, configuration, jakarta-ee, glassfish

我正在创建一个在 GlassFish 中运行的 Web 服务，并且我想要一些自定义属性。为此，我正在使用该`Properties`课程。我正在使用的代码是：

```
Properties p=new Properties();
File f=new File(System.getProperty("user.dir"), "settings.properties");
p.load(new FileInputStream(f)); 
```

但是如何`settings.properties`在我的配置目录中获取 -file？

我不确定我的类路径，因为它是由 NetBeans 和 GlassFish 管理的。我假设我的`.war`-file 已添加到类路径中，部署时...

我已经添加了自己的解决方案，但如果有人能提出更好的解决方案，那将是非常受欢迎的......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-07T13:16:19.480

将您的属性文件放在***<glassfish-install-dir>/glassfish/domains/<domain-name>/lib/classes***目录中，它们将可以通过*ResourceBundle*类从您的应用程序中访问。例如，将一个名为*settings.properties*的属性文件添加到该目录，然后访问该文件中的值，如下所示：

> ResourceBundle.getBundle("settings").getString("my-property-key");

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T09:35:32.280

有效的解决方案实际上非常简单：

```
URL url =  this.getClass().getResource("/package/name/file.properties");
p = new Properties();
p.load(new FileInputStream(new File(url.getFile()))); 
```

为什么没有人带着这个来？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-17T19:50:57.683

**备择方案：**

根据您的域的配置方式，您可能可以`asadmin create-system-properties`从命令行使用。运行/查看`asadmin create-system-properties --help`以获取更多信息。

或者您可能希望通过 Glassfish 管理界面管理系统属性。这是默认链接：[http://localhost:4848/configuration/systemProperties.jsf?configName=server-config](http://localhost:4848/configuration/systemProperties.jsf?configName=server-config)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T09:36:23.753

请参阅[此处](http://www.spychalski.de/recipe-6.html)了解如何从类路径中读取属性文件：

```
URL url =  ClassLoader.getSystemResource("test.properties");
Properties p = new Properties();
p.load(new FileInputStream(new File(url.getFile()))); 
```

然后，您只需将配置目录添加到类路径。

如果您在使用上述代码时遇到问题，请尝试[ServletContext.getResource](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/ServletContext.html#getResource(java.lang.String))。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T12:04:20.470

我已经尝试了很多，但我解决了这个问题：

```
 // ServletContext ctx
        InputStream stream = ctx.getResourceAsStream("version.properties");
        p = new Properties();
        p.load(stream); 
```

我必须从 jsp 页面传递 ServletContext 并调用`getServletContext()getServletContext()`. 不理想，但这是我让它工作的唯一方法......

如果有人能想出另一个解决方案，那就太好了，如果没有`ServletContext`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T10:57:31.727

+1 将其放入您的类路径中。

如果您正在使用 Spring（如果您因为很多原因还没有使用 Spring，我强烈建议您这样做），那么您可以像这样加载属性文件：

```
database.username=scott
database.password=tiger 
```

并将引用放在您的应用程序上下文中，例如：

```
<property name="username" value="${database.username}"/> 
```

（假设您已经配置了属性配置器）如果无法加载文件或属性不存在，则会导致错误。应用程序将无法启动。这实际上是一件好事。它可以让您真正快速地发现问题，并且比默默地失败要好得多，这有时会产生灾难性的影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-10T08:26:49.147

将您的属性文件复制到 web/WEB-INF/classes 路径

```
Properties p=new Properties();
p.load(Thread.currentThread().getContextClassLoader().getResourceAsStream("myproperty.properties")); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-16T16:40:48.777

请注意，您必须**关闭 InputStream**。否则你迟早会得到一个 SocketException。

```
#|2013-xx-xxTxx:xx:xx.162+0200|WARNING|sun-appserver2.1|sun.rmi.transport.tcp|_ThreadID=431; _ThreadName=RMI TCP Accept-0;_RequestID=xyz;|RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,port=0,localport=42384] throws
java.net.SocketException: Too many open files
    at java.net.PlainSocketImpl.socketAccept(Native Method)
    at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:390)
    at java.net.ServerSocket.implAccept(ServerSocket.java:453)
    at java.net.ServerSocket.accept(ServerSocket.java:421)
    at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:369)
    at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:341)
    at java.lang.Thread.run(Thread.java:662)
|#] 
```

[加载属性](https://stackoverflow.com/questions/333363/loading-a-properties-file-from-java-package)

# algorithm - 快速文本编辑器查找

> ID：531614
> 
> 赞同：9
> 
> 时间：2009-02-10T09:19:49.893
> 
> 标签：algorithm, string, search

有谁知道文本编辑器/程序员编辑器如何能够对非常大的文本文件进行如此快速的搜索。

他们是在加载时索引，还是在查找开始时或其他一些巧妙的技术？

我迫切需要更快地实现我所拥有的，这是从文本的顶部到底部的极其缓慢的步行。

任何想法都非常感谢。

这是针对 C# 实现的，但它是我感兴趣的技术，而不是实际代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T09:23:17.763

从[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer-Moore)搜索算法开始。它需要一些预处理（速度很快）并且搜索效果很好 - 特别是在搜索长子字符串时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T09:36:25.157

如果大多数人只使用基本的、幼稚的搜索技术（扫描第一个字符上的匹配项，然后测试命中是否成功），我不会感到惊讶。

*   [努力的代价：字符串搜索](http://blogs.msdn.com/oldnewthing/archive/2006/01/19/514834.aspx)
*   [Eric Lippert 在上述博文中的评论](http://blogs.msdn.com/oldnewthing/archive/2006/01/19/514834.aspx#516332)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T10:15:19.447

# grep

虽然本身不​​是文本编辑器，但经常被许多文本编辑器调用。我很好奇你是否尝试过 grep 的源代码？即使在搜索大文件时，它对我来说似乎总是非常快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T11:10:03.443

我知道的一种尚未提及的方法是 Knuth-Morris-Pratt-Search (KMP)，但它对语言文本不太好（这是由于算法的前缀属性），但对于像 DNA 这样的东西搭配起来非常非常好。

另一种是hash-Search（不知道有没有正式名称）。首先，计算模式的哈希值，然后制作一个滑动窗口（具有模式的大小）并将其移动到文本上并查看哈希是否匹配。这里的想法是以您不必计算整个窗口的哈希的方式选择哈希，但您只需使用下一个字符更新您的哈希（并且旧的字符从哈希计算中退出）。当您要搜索多个字符串时，此算法的性能非常好（因为您只需事先计算字符串的哈希值）。

# c# - .NET 中的键盘事件

> ID：531618
> 
> 赞同：2
> 
> 时间：2009-02-10T09:20:58.593
> 
> 标签：c#, vb.net, forms, keyboard

释放键时触发键向上事件。这适用于 a、b 等普通键。但是，按住箭头键或退出键会产生不同的结果。不是在释放按键时触发按键向上事件，而是在按键按下事件后立即触发。因此，按住箭头键就等于非常快速地多次按下和释放该键。任何解释和解决方法以确定何时实际释放密钥？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T10:12:00.470

在您释放键之前，实际上不会触发 KeyUp 事件（对于所有键，而不仅仅是箭头键等），只有许多重复的 KeyDown 事件。至少，从一些测试代码来看，我是这样看的。

我的解决方法是在使用检测到 KeyDown 事件后禁用 KeyDown 处理程序

```
RemoveHandler Me.KeyDown, AddressOf Form1_KeyDown 
```

然后在触发 KeyUP 事件时重新启用。

```
AddHandler Me.KeyDown, AddressOf Form1_KeyDown 
```

当然，如果您想同时处理多个按键，那么这是行不通的。您必须存储有问题的 Key 是否已经关闭并忽略相应的 KeyDown 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T07:53:46.773

我刚刚遇到了类似的问题。键盘处理程序的行为很奇怪：

如果焦点和处理程序在文本框中：

*   按住字母数字键时，我得到了多个 Press and Down 事件
*   箭头和功能键产生多个向下事件

如果为启用了 KeyPreview 的表单处理事件，则仅处理箭头键的 KeyUp 事件。

可以通过覆盖 ProcessCmdKey 来处理较低级别的所有键。

如果要处理左箭头键：

```
Protected Overrides Function ProcessCmdKey(ByRef msg As System.Windows.Forms.Message, ByVal keyData As System.Windows.Forms.Keys) As Boolean
    Select Case keyData
        Case Keys.Left
            Debug.WriteLine("Left")
            Return True
        Case Else
            Return MyBase.ProcessCmdKey(msg, keyData)
    End Select
End Function 
```

# wpf - 如何在 XAML 中创建一个简单的超链接？

> ID：531621
> 
> 赞同：56
> 
> 时间：2009-02-10T09:22:02.430
> 
> 标签：wpf, xaml, hyperlink

我要做的就是在 XAML 中创建一个小超链接。我什么都试过了。我放弃。

这个的语法是什么？

```
<StackPanel Width="70" HorizontalAlignment="Center">

    <Hyperlink Click="buttonClose_Click" Cursor="Hand" 
         Foreground="#555" Width="31" Margin="0 0 0 15"  
         HorizontalAlignment="Right">Close</Hyperlink>

    <Button Width="60" Margin="0 0 0 3">Test 1</Button>
    <Button Width="60" Margin="0 0 0 3">Test 2</Button>
    <Button Width="60" Margin="0 0 0 3">Test 3</Button>
    <Button Width="60" Margin="0 0 0 3">Test 4</Button>
</StackPanel> 
```

*Visual Studio 团队：在 Visual Studio 2010 中，我希望 Clippy 弹出并说“您似乎正在尝试创建超链接”并告诉我该怎么做。你不能用 MEF 做到这一点吗？这将是复古的酷，在学习 XAML 的过程中，这些“我如何做我已经知道如何在 HTML 中做的事情”的小问题消耗了很多时间。*

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-08-09T23:06:57.633

您不能将超链接添加到 StackPanel - 您将收到运行时错误。（实际上，我有点惊讶这不是编译时错误。）那是因为超链接不存在于 WPF 的“控件”一侧，`<Button>`以及`<StackPanel>`其他布局在矩形屏幕块上并从`UIElement`. 取而代之的是，它存在于事物的“文本”方面，与`<Bold>`和`<Run>`和`<Paragraph>`以及其他通常是文本的事物一起换行并在行和段落中流动，并从`TextElement`.

一旦您意识到有两个具有不同布局行为的独立类层次结构，超链接将位于事物的“文本”一侧是有道理的（例如，很容易在中间有一个带有超链接的段落，甚至为此用于换行的超链接）。

但是，不，当您刚开始时，它并不是那么容易被发现。

要混合这两个世界并使用超链接作为控件，您只需将其放入 TextBlock 中即可。TextBlock 是一个包含文本的东西（即，可以包含超链接）的控件（即，可以进入 StackPanel）：

```
<TextBlock><Hyperlink Click="buttonClose_Click">Close</Hyperlink></TextBlock> 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-11T12:26:13.907

您可以将 Button 与自定义控件模板一起使用，下面的代码是一个有限的超链接样式按钮（例如，它仅支持文本超链接），但它可能会为您指明正确的方向。

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Page.Resources>
<Style x:Key="Link" TargetType="Button">
    <Setter Property="VerticalAlignment" Value="Center"/>
    <Setter Property="HorizontalAlignment" Value="Center"/>
    <Setter Property="Cursor" Value="Hand"/>
    <Setter Property="Foreground" Value="Blue"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <TextBlock TextDecorations="Underline" 
                    Text="{TemplateBinding Content}"
                    Background="{TemplateBinding Background}"/>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Foreground" Value="Red"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
</Page.Resources>
<Button Content="Click Me!" Style="{StaticResource Link}"/>
</Page> 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-11-26T07:37:47.903

试试这个：

```
<TextBlock>
    <Hyperlink RequestNavigate="Hyperlink_RequestNavigate" 
               NavigateUri="http://www.msn.com">MSN</Hyperlink> 
</TextBlock> 
```

* * *

```
private void Hyperlink_RequestNavigate(object sender,
                                       System.Windows.Navigation.RequestNavigateEventArgs e)
{
    System.Diagnostics.Process.Start(e.Uri.AbsoluteUri);
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-09-20T01:40:49.283

```
<TextBlock>
  <Hyperlink NavigateUri="{Binding YourUri}" RequestNavigate="YourRequestNavigate">
   <TextBlock Text="{Binding YourText}" />
  </Hyperlink>
</TextBlock> 
```

这将链接嵌套文本块中的任何绑定文本，我还没有找到更好的方法，如果可能的话，我希望第一个文本块不存在。这也适用于 DataTemplates。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-08-10T09:56:05.627

您可能会发现，如果您要绑定的不是简单的文本值，您将需要使用`ContentPresenter`其他任何内容，否则不会出现任何内容，如果您绑定的是 XML 数据源，则可能是这样。

IsMouseOver 的属性触发器为文本提供下划线。

下面给出了我绑定到 XML 的示例。

```
<Style x:Key="JobNumberStyleButton" TargetType="{x:Type Button}">
  <Setter Property="VerticalAlignment" Value="Top"/>
  <Setter Property="HorizontalAlignment" Value="Left"/>
  <Setter Property="Cursor" Value="Hand"/>
  <Setter Property="Background" Value="Transparent"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="Button">
        <TextBlock>
          <ContentPresenter
            Margin="0,0,0,0"
            ContentTemplate="{TemplateBinding ContentTemplate}"
            Content="{TemplateBinding Content}"
            ContentStringFormat="{TemplateBinding ContentStringFormat}"
            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
            RecognizesAccessKey="False"
            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </TextBlock>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
  <Style.Triggers>
    <Trigger Property="IsMouseOver" Value="True">
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <TextBlock Padding="0,0,0,0" Margin="0,0,0,0">
              <Underline>
                <ContentPresenter
                  Margin="0,0,0,0"
                  ContentTemplate="{TemplateBinding ContentTemplate}"
                  Content="{TemplateBinding Content}"
                  ContentStringFormat="{TemplateBinding ContentStringFormat}"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  RecognizesAccessKey="False"
                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
              </Underline>
            </TextBlock>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Trigger>
  </Style.Triggers>
</Style> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-21T01:12:20.553

您可以简单地使用[HyperlinkBut​​ton](https://msdn.microsoft.com/en-us/library/system.windows.controls.hyperlinkbutton(v=vs.95).aspx)。单击它时，该 URL 将显示在您的 Web 浏览器中：

```
<HyperlinkButton
    NavigateUri="https://dev.windowsphone.com"
    TargetName="_blank"
    Content="Windows Phone Dev Center" /> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T09:48:07.780

通常，超链接的含义是提供一个锚点以将用户发送到另一个页面或通常与另一个资源交谈，因此它是以这种方式实现的，您必须像这样指定该资源的位置：

```
<HyperLink NavigateUri="http://www.site.com">
   Web Site
</HyperLink> 
```

但是，我发现[这篇博客](http://vivekdalvi.wordpress.com/2007/06/06/hyperlink-control/)文章带有一个自定义的 TextBlock，它用作超链接并支持点击事件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-01T16:08:18.060

在带有 mvvmcross 的 UWP 中我正在使用这个

```
 <HyperlinkButton Content="{Binding TextSource, ConverterParameter=MyUrl, Converter={StaticResource Language},
           FallbackValue=_MyUrl}" NavigateUri="http://www.google.com" /> 
```

# cocoa-touch - 从应用程序通过电子邮件发送图像

> ID：531623
> 
> 赞同：2
> 
> 时间：2009-02-10T09:22:57.310
> 
> 标签：cocoa-touch

将带有图像的电子邮件从应用程序发送到 Mail.app 以供某人发送给他们喜欢的任何联系人的最佳方式是什么？

例如，在我的应用程序 (iMood) 中，您可以选择“心情”，我希望用户能够通过使用导航栏中的按钮将其通过电子邮件发送给朋友。

我可以轻松地创建按钮等，但只需要知道一种使用户能够将图像（即 image.png）从项目发送到 Mail.app 作为电子邮件中的附件或图片的方法。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:15:40.063

这个问题已经回答了很多次，并且以许多不同的形式出现。

简短的回答：你不能。没有 API 允许您访问邮件附件，Apple 的邮件 URL 方案的实现也不支持附件。

要做到这一点，你有几个非常没有吸引力的选择：

1) 内置您自己的 SMTP 客户端。有一些开源库正在朝着这个方向努力，但这仍然很痛苦

2）将图像发送到第三方服务器（您的）并从那里撰写和发送邮件。用户可能不喜欢您出于恶意目的收集电子邮件地址的可能性。

在您的情况下，最好的办法是将图像保存到照片库中。从那里，用户可以发送带有照片的电子邮件。

如果您希望 Apple 启用电子邮件附件，请[提交请求](http://bugreporter.apple.com)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-10T14:32:36.683

[这是可能的，David J. Hinson 在这里](http://davidjhinson.wordpress.com/2009/01/21/embedding-images-in-outbound-email-using-cocoa-touch/)写了一篇很好的博客文章

# c# - C# 文件按照 PDF 或 Excel 或 Word 或记事本文件模板打印

> ID：531627
> 
> 赞同：0
> 
> 时间：2009-02-10T09:23:59.273
> 
> 标签：c#, file, printing

我想按照 PDF 或 Excel 或 Word 或记事本模板从 C# 打印

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:36:22.613

对于 Pdf，我可以推荐你[iTextSharp](http://itextsharp.sourceforge.net/)

我从来没有和别人合作过，对不起。但是对于 iTextSharp，我可以说它真的很容易使用。

# php - mysql多列搜索

> ID：531628
> 
> 赞同：5
> 
> 时间：2009-02-10T09:24:23.827
> 
> 标签：php, mysql

我有一张这样的桌子：

```
`+-------------------+---------------+
| description       | colour        |
+-------------------+---------------+
| Macrame Dress     | Washed Black  |
| Darcelle Gilet    | Dirty Shellac |
| Darcelle Cardigan | Washed Black  |
| Let It Rot Vest   | Optic White   |
| Let It Rot Crew   | Washed Black  |
| Let It Rot Crew   | Optic White   |
| Battalion Short   | Somme         |
| Seine Dress       | Washed Black  |
| Seine Dress       | Cocomotion    |
| Odette V-neck     | Linen Marl    |
+-------------------+---------------+` 
```

`我想搜索“黑色连衣裙”，它只返回第 1 行和第 8 行。如果我输入“黑色”，它将返回第 1、3、5 和 8 行。连衣裙应该返回第 1、8 和 9 行。

谁能想到一个非常优雅、漂亮的 sql，它将接受任意数量的搜索词并返回最简洁的结果集。我可以想到一些非常丑陋的方法来做到这一点，但它们破坏了我的业力。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T09:58:37.583

我能想到的唯一*好的*解决方案（因果报应）将涉及使用[FULLTEXT](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)索引。这将允许您使用如下查询：

```
SELECT * FROM mytable
WHERE MATCH (description,color) AGAINST ('black dress'); 
```

不幸的是，如果我没记错的话，FULLTEXT 索引需要 MyISAM 表类型。

**编辑**

我怀疑这是否是您正在寻找的，但为了讨论，让我添加它。您*可以*将数据复制到临时 MyISAM 表中，然后对其进行全文搜索：

```
CREATE TEMPORARY TABLE mytmptable ENGINE=MyIsam SELECT * FROM mytable;
ALTER TABLE mytmptable ADD FULLTEXT KEY (description,color); 
SELECT * FROM mytmptable WHERE MATCH (description,color) AGAINST ('black dress'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T10:08:55.920

```
where colour+description like '%s1%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T09:51:37.973

理想情况下，我认为您将有两个单独的搜索词，一个用于描述 (s1)，一个用于颜色 (s2)。

然后您的查询变为：

```
select * from tbl where description like '%(s1)%' and colour like '%(s2)%' 
```

当然，代入 s1 和 s2 的值。

空白 s2 会导致 %% 应该匹配所有内容（我认为）。

为了能够在任一字段中搜索多个术语，您需要类似

```
select * from tbl
    where description + colour like '%(s1)%'
      and description + colour like '%(s2)%'
      and description + colour like '%(s3)%' 
```

这必须根据搜索模式中的单词数量动态构建（因此“黑色连衣裙”将有 s1 和 s2，黑色只有 s1）。“描述+颜色”位是连接字段；我的 SQL 有点生疏，所以我不知道你会怎么做，但这个概念是合理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T10:04:29.443

您的列是什么数据类型？如果它们是 VARCHAR 或类似的，你只需做

```
select 
  * 
from 
  tbl 
where 
  description like '%(s1)%' 
  or colour like '%(s1)%' 
```

（这改编自@Pax，我认为他误解了这个问题——我认为它的意思是只要搜索词出现在“描述”或“颜色”中，它就应该匹配。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T17:23:11.370

好吧，只要您可以使用 PHP 来组装查询，这应该可以工作：

```
SELECT * FROM tbl
WHERE (description LIKE '%black%' OR colour LIKE '%black%')
AND (description LIKE '%dress%' OR colour LIKE '%dress%') 
```

...在其中为搜索词中的每个单词添加括号中的条件之一，并将它们与“AND”连接起来。这需要在搜索词中的每个单词的至少一个列中进行匹配。

它不是纯 SQL（实际查询将取决于搜索词中有多少单词），但它感觉*相当*优雅，我认为它应该可以完成这项工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-11T04:47:54.103

```
$node=explode(" ",$keysearch);
$sql="SELECT * FROM tbl_dress WHERE ";
$x=0;
foreach ($node as $key => $ns) {
    $x++;
    if ($x > 1){$sql.=" AND ";}
    $sql.="(CONCAT(description, colour) LIKE '%$ns%')";
} 
```

# asp.net - 在没有 ViewState ASP.Net 的情况下获取当前页面的 HTML

> ID：531631
> 
> 赞同：4
> 
> 时间：2009-02-10T09:25:53.870
> 
> 标签：asp.net, html, rendering

有什么方法可以让我获得当前页面的 HTML。通过当前页面，我的意思是假设我正在处理 Default.aspx 并希望通过在其上提供一个按钮来获取 HTML。

如何得到它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T10:24:41.250

**为响应要求的澄清而编辑**

您可以覆盖页面的渲染方法以在服务器端捕获 HTML 源代码。

```
protected override void Render(HtmlTextWriter writer)
{
    // setup a TextWriter to capture the markup
    TextWriter tw = new StringWriter();
    HtmlTextWriter htw = new HtmlTextWriter(tw);

    // render the markup into our surrogate TextWriter
    base.Render(htw);

    // get the captured markup as a string
    string pageSource = tw.ToString();

    // render the markup into the output stream verbatim
    writer.Write(pageSource);

    // remove the viewstate field from the captured markup
    string viewStateRemoved = Regex.Replace(pageSource,
        "<input type=\"hidden\" name=\"__VIEWSTATE\" id=\"__VIEWSTATE\" value=\".*?\" />",
        "", RegexOptions.IgnoreCase);

    // the page source, without the viewstate field, is in viewStateRemoved
    // do what you like with it
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T04:45:46.710

不知道为什么你想要你想要的，但是......这不是我的想法，即我没有尝试这个代码。

将客户端 onclick 添加到您的按钮以显示标记并执行以下操作：

```
function showMarkup() {
      var markup = "<html>" + document.getElementsByTagName("html")[0].innerHTML + "</html>";

      alert(markup); // You might want to show a div or some other element instead with the markup variable as the inner text because the alert might get cut off.
} 
```

如果您出于某种原因需要将此呈现的标记发回服务器，请将编码的标记存储在隐藏的输入中并将其发回。您可以使用 ClientScriptManager.RegisterOnSubmitStatement 在服务器端注册以下脚本。这是客户端代码。

```
var markup = escape("<html>" + document.getElementsByTagName("html")[0].innerHTML + "</html>");
var hiddenInput = $get('hiddenInputClientId');

if (hiddenInput) {
      hiddenInput.value = markup;
} 
```

希望有帮助，尼克

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-10T09:37:03.267

我仍然不确定您的目标是什么。但是，如果您想要页面的总渲染输出，那么您可能最好查看一些客户端代码，因为一旦服务器返回完全渲染的 HTML，这将运行。

否则，您可能会捕获页面卸载事件并在那里处理呈现的内容。

需要更多关于你想要什么的信息。

# cocoa-touch - 单元格背景颜色只显示到文本

> ID：531633
> 
> 赞同：0
> 
> 时间：2009-02-10T09:26:42.153
> 
> 标签：cocoa-touch

我已经使用以下代码设置 TableView 单元格的背景颜色（在 cellForRowAtIndexPath 中）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
        cell.accessoryType = UITableViewCellAccessoryDetailDisclosureButton;

        cell.backgroundColor = [UIColor yellowColor];
        cell.contentView.backgroundColor = [UIColor yellowColor];

        UIView* backgroundView = [ [ [ UIView alloc ] initWithFrame:CGRectZero ] autorelease ];
        backgroundView.backgroundColor = [ UIColor yellowColor ];
        cell.backgroundView = backgroundView;
        for ( UIView* view in cell.contentView.subviews ) 
        {
            view.backgroundColor = [ UIColor yellowColor ];
        }
    }

    // Set up the cell...
    if ([[menuList objectAtIndex:indexPath.row] isKindOfClass:[Category  class]])
    {
        cell.text = ((Category *)[menuList objectAtIndex:indexPath.row]).name;
    }
    else
    {
        [cell setText: [menuList objectAtIndex:indexPath.row]];
    }

    return cell;
} 
```

但是，当它仅渲染部分单元格时应用了类似这样的背景（其中 z 是背景填充），即使附件的背景是颜色而不是文本。

```
xxxxxxxxxxxxxxxxxxxx
zzzSearch          
xxxxxxxxxxxxxxxxxxxx 
```

我看到能够更改文本背景的唯一方法是在 Interface Builder 中设置整个表格视图的背景颜色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T09:36:47.853

我敢打赌，您的文字是不透明的 UILabel。我记得必须添加`myText.backgroundColor = [UIColor clearColor]`到内容文本 UILabel 才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:41:34.177

我已经设法使用自定义 TableViewCell 对象来做到这一点，但我确信必须有一种方法可以做到这一点

# asp.net - 用于 ASP.NET/Sharepoint 开发的本地 SQL Express？

> ID：531634
> 
> 赞同：0
> 
> 时间：2009-02-10T09:26:49.143
> 
> 标签：asp.net, development-environment, sql-server-express

在您的开发环境中，您是安装本地 SQL Express 还是专用 SQL 服务器？这两个选项的优缺点是什么？

以我目前的经验来看：

*   由于资源消耗，本地安装减慢了自己的开发工作站
*   本地安装更易于调试/管理
*   专用安装简化了中央管理（备份等）

你有什么个人经验和建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:44:04.903

我认为这真的取决于你期望应用程序有多忙以及任何成本限制（盒子数量、机架空间等）。如果它是低流量的内部/内部网服务器，我倾向于将它们放在同一个盒子上。如果 SQL 是繁忙 Web 服务器的一小部分，请将它们分开。如果您将它们封装得足够好，那么部署差异就是配置问题，而不是重新编码。IE。两种可能性的代码。

SQL Express 只能使用 1GB 的 RAM 和 4GB 的数据库——它会变得非常忙碌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T10:11:47.817

在无法访问网络的笔记本电脑/在家中工作时，本地非常有用。

当想要与其他开发人员隔离工作并且不必担心其他人在同一数据库上工作/服务器上的其他活动会减慢您的速度时，这也很有用。

我在服务器上工作，但在上述情况下使用本地实例

# task-management - 您如何跟踪您的编程 TODO？

> ID：531635
> 
> 赞同：56
> 
> 时间：2009-02-10T09:27:17.003
> 
> 标签：task-management

我是那些没有待办事项清单就无法完成任何事情的人之一。如果它不在列表中，则它不存在。

**记事本方法：**

当我编程时，我一直在打开记事本并列出我当前项目的待办事项列表。我会不断地根据优先级重新安排这些，当我完成该特定任务时，我会将它们划掉并将它们移动到已完成的部分。

**代码注释：**

一些程序员在他们的项目源代码中添加：

```
// TODO: Fix this completely atrocious code before anyone sees it 
```

另外，我知道有一些工具也可以显示代码中所有 TODO 的列表。

**网站任务跟踪器：**

*   [记住牛奶](http://rememberthemilk.com)
*   [背包](http://www.backpackit.com/)
*   [满月](https://www.manymoon.com/misc/help)
*   [Voo2do](http://voo2do.com/)
*   [Gmail 任务](http://gmailblog.blogspot.com/2008/12/new-in-labs-tasks.html)
*   [双人间](http://www.teuxdeux.com)
*   [多多多多](http://www.todododo.com)
*   [Ta-da 列表](http://www.tadalist.com) ……还有更多

您发现跟踪多个项目的待办事项列表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-10T09:35:46.530

像其他人一样，我在他们的代码中添加了一些信息，但我也使用警告指令来生成编译器警告：

```
#warning TODO: Implement foobar 
```

这样我仍然可以搜索“TODO”，但他们也会在我构建时对我大喊大叫。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-10T09:34:58.453

**笔和纸。**

结合天才的[PocketMod](http://www.pocketmod.com)，它是完美的。引人注目的 TODO 非常令人满意！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-10T09:31:05.280

我不能代表其他 IDE，但[Eclipse](http://www.eclipse.org/)将在您的项目的源文件中搜索`TODO`注释（以及默认情况下）`FIXME`并`XXX`在任务视图中为您创建任务。

这会导致您检查任务视图、双击`TODO`任务并阅读评论的有趣情况：

```
// TODO: Add this functionality. 
```

Eclipse 还会`TODO`在生成某些代码块时添加注释，例如方法实现、异常捕获块等。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-10T09:30:10.133

*[安装了 Visual Studio 和ReSharper的](http://www.jetbrains.com/resharper/)*TODO*（和其他）注释非常有用：*

 *[![待办事项浏览器](https://i.stack.imgur.com/otOar.png)](https://i.stack.imgur.com/otOar.png)
[（来源：[jetbrains.com](http://www.jetbrains.com/resharper/features/screenshots/40/navigation_todoexplorer.png)）]

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-10T09:37:15.717

虽然我没有尝试过，但我真的很喜欢将[**测试作为 todos**](http://untyped.com/untyping/2008/11/05/tests-as-todos/)的想法。如果不是失败的测试，还有什么能让你继续前进？

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-10T10:10:10.723

### 个人抽象待办事项

我使用[Tomboy Notes](http://projects.gnome.org/tomboy/)或纸来快速列出抽象的高级任务。通常，当我与经理通电话时，我只需要把事情写下来。

### 源代码特定待办事项

我在代码中使用内联 TODO:/@todo 注释标记，然后使用 Netbeans 插件，它为我提供了整个项目中运行的待办事项列表。由于 Netbeans 可以聚合来自多个项目的待办事项标记，因此我正在运行多少个不同的项目并没有什么区别。

### 多人任务/待办事项

一旦我需要跟踪比我自己更多的 todos，我会转向项目管理软件，如 OpenProj、MS Project 等。此外，如果 todos 涉及错误或功能请求，我会使用我们的 bugtracker。其他待办事项也可以由帮助台系统管理。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-10T11:35:58.637

[NextAction](http://www.timesnapper.com/NextAction/) , 来自 TimeSnapper

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-10T16:41:52.177

我用笔和纸来记笔记。我还在代码中使用了 TODO/FIXME 标签，这些标签在 Vim 中以黄色突出显示，并由 Komodo 中的 TODO 扩展跟踪。

对我来说最有用的补充之一是使用 Samurize 将纯文本文件嵌入到我的桌面（[http://lifehacker.com/software/plain-text/geek-to-live--incorporate-text-files-onto -your-desktop-213280.php](http://lifehacker.com/software/plain-text/geek-to-live--incorporate-text-files-onto-your-desktop-213280.php)）。我有 3 个虚拟桌面，它存在于我的电子邮件桌面上，这是我每天早上做的第一件事。它包含一个包含我需要做的项目的文本文件，而且它很少提前一周运行。

2009 年 2 月 11日星期三
- 第 1
项 - 第 2 项 2009 年 2月 12
日星期四
- 第 3 项

我使用具有关键字“todo”的 Executor，当我想编辑/添加/删除项目时，它会自动打开带有此文件的 gvim。这使它大约需要 3 次击键才能打开并准备好修改。它可以帮助我记住星期一早上的生产活动，然后再埋头于电子邮件和会议中。一旦我编辑，它就会反映在桌面上。

显然，对于更长更详细的事情，我依靠 Roundup、Outlook 提醒等，但这是一种方便的方式来记下事情，这样他们就不会在洗牌中迷失方向。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-10T09:47:15.193

我使用AbstractSpoon 的[ToDoList](http://www.abstractspoon.com/ "待办事项列表")。它使您可以将待办事项列表划分为项目，甚至可以由多个用户使用共享网络驱动器用于更大的项目。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-10T09:49:09.433

对于项目中的每一项任务，我都会在问题跟踪器中创建一个新条目（对我来说是[Bugzilla](http://www.bugzilla.org/)）。

*   一个很大的优势是您可以跟踪问题 ID 所做的每一个更改。
*   您可以向客户或项目成员报告您的任务状态。
*   您可以创建一个新的错误类型，如“任务”、“待办事项”或“功能请求”。
*   这是一个中心解决方案。没有本地的东西...

我们的开发团队有一条规则说：“不要在问题跟踪器中没有相应条目的情况下更改任何代码。永远不要！”

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-10T09:31:00.787

我使用内联 TODO：注释，因为 Visual Studio 会为我跟踪这些，当然我仍然需要查看任务列表才能看到它们。我无法计算找到 TODO 的次数：在查看我认为已完成的一些代码时发表评论。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-10T13:07:55.157

我会明确区分 FIXME 和 TODO。FIXME 很关键，必须在提交/发布之前修复。TODO 可以存活一段时间，但最终应该被清除掉。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-10T13:09:54.997

项目 cvs/svn 区域顶层的简单纯文本文件 (TODO) 对我来说适用于简单项目。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-10T09:33:24.743

就像其他人提到的，我在我的代码注释中使用标准的 FIXME/TODO/XXX，然后可以使用他们的各种工具在我的 IDE 中找到任务列表。我还使用[hudson 的任务扫描器插件](http://hudson.gotdns.com/wiki/display/HUDSON/Task+Scanner+Plugin)来跟踪所有内容，因为我很喜欢图表。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-10T11:26:28.083

我创建了一个构建任务，它从我的代码文件中挑选出 //TODO: 行并生成我包含在团队城市中的报告。它使您无需检查即可快速查看项目中的任何未完成项目。

您还可以将[CodeTagsPlugin](http://trac-hacks.org/wiki/CodeTagsPlugin)与[Trac一起使用](http://trac.edgewall.org/)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-10T16:32:45.990

哇，我昨天刚问了这个问题。经过一番搜索，我选择了[ReminderFox](http://reminderfox.mozdev.org/) Firefox 扩展。它完全集成到浏览器中，并在每次打开浏览器时提醒您任务到期。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-11T16:19:19.260

我非常喜欢[Mylyn](http://www.eclipse.org/mylyn/)：集成到 Eclipse 中，可以与许多跟踪器一起使用，也可以不使用（本地任务），并实现了新概念，例如专注的 UI。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-12T10:08:59.653

还有适用于 Hudson 的 Task Scanner Plugin（如果它适合您的环境）。有了它，您可以在持续集成构建报告中跟踪 TODO/FIXME 的数量。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-10T09:31:14.873

在 Eclipse 中编程 Java 时，我发现它非常有用，正如您所说的“用注释给我的源代码添加`// TODO:`注释 - 主要是因为 Eclipse 会查找项目中的每一个并为我编译一个任务列表 =) 在 Visual Studio 中，有一个任务列表面板，我有时会使用它，但我发现它不像 Eclipse 中的注释那样精简。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-10T09:31:54.933

我使用 Eclipse 作为 IDE，它将所有 TODO 收集到一个列表中并在大纲中显示它。非常简单易用。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-10T09:37:24.560

我使用 emacs [org-mode](http://orgmode.org/)不仅可以跟踪代码 TODO，还可以跟踪我的整个生活。它还具有一些电子表格和日历功能，是一个非常强大的大纲工具。我使用 mercurial 进行轻量级版本处理和不同机器之间的简单复制。

它的效果出奇的好。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-17T15:18:28.890

[alt text http://www.86th.org/hudson.jpg](http://www.86th.org/hudson.jpg) 我们使用 Hudson 中的“Open Tasks Trend”功能，它适用于多种语言。对于我们的 C# 项目，我们有 3 个级别的任务，这是通过不同的 TODO：样式注释来完成的。

*   **FIXME:、HARDCODED: 或 HACK: 上的**高优先级匹配****

***   **TODO 上的**中等优先级匹配：****

    ***   **MEH 上的低优先级** 匹配：或 CODEREVIEW：**** 

 ****然后，Hudson 将获取此列表并绘制趋势图，如图所示，并有一个可排序、可过滤的任务列表，它将在网页上显示带有链接的消息，这些链接将带您直接进入哈德逊的源代码。

另外，我们可以使用 CODEREVIEW 轻松设置代码审查的兴趣点：并有一个简洁的列表可以打印出来。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-10T11:36:33.877

在对合适的“待办事项列表”应用程序进行了广泛搜索后，我选择了 mylyn——Eclipse 随附的应用程序。

创建和管理任务很容易。可以导入任务并将其链接到 Bugzilla 或许多其他不同的任务存储库。它还有一个“任务上下文”，可以突出显示与任务相关的文件，并隐藏那些不相关的文件（这比我预期的要有用得多）。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-10T12:37:29.130

Eclipse 会自动跟踪您的 TODO 并在适当的窗口中列出它们。如果您不需要高级功能，我发现它足够强大。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-02-10T12:59:18.157

我很喜欢[曲目](http://getontracks.org/)。它具有[GTD](http://en.wikipedia.org/wiki/GTD)的味道，但又不会过于拘谨。

我可以在我想到的时候快速地把东西打进去，然后不用担心之后会忘记。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2012-06-04T07:50:14.290

对于 C++ 项目（本机/ATL）：

```
#ifndef _TODO_H_
#define _TODO_H_
#pragma once

// from atldef.h:
#ifndef _ATL_STRINGIZE
#define __ATL_STRINGIZE(_Value) #_Value
#define _ATL_STRINGIZE(_Value) __ATL_STRINGIZE(_Value)
#endif

// put x in quotes, no need to use #pragma!
#define __TODO(x)           __pragma(message(__FILE__"("_ATL_STRINGIZE(__LINE__)") : TODO: "x)) 
#define __WTF(x)            __pragma(message(__FILE__"("_ATL_STRINGIZE(__LINE__)") : WTF?! "x)) 
// prefer to use ISO-formatted date
#define __BUGFIX(date, x)   __pragma(message(__FILE__"("_ATL_STRINGIZE(__LINE__)") : BUGFIX: "#date" "x)) 
#define __CHANGE(date, x)   __pragma(message(__FILE__"("_ATL_STRINGIZE(__LINE__)") : CHANGE: "#date" "x)) 

#endif _TODO_H_ 
```

为 C# 寻找类似的东西。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-08-13T18:24:02.967

我现在使用 Sandglaz 并将我的待办事项放在 3 列中，下一个和以后（有点像他们的[博客](http://sandglaz.com/blog_posts/10-The-art-of-product-backlog-prioritization-How-we-manage-our-backlog)，但只有一行）......而且它使用起来简单快捷。我是一名自由职业者，所以我一次从事多个项目，所以它对我有用

我只使用挂起的测试来提醒自己编写测试。我使用 Rspec，所以它可以构建它。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-02-10T16:25:47.130

[OmniFocus](http://www.omnigroup.com/applications/omnifocus/) - 我尝试了很多跟踪 ToDo 的方法，这是迄今为止最好的。如果你有一台 Mac，这就是你要走的路。iPhone应用程序也很棒。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-02-10T09:29:44.750

doxygen 可以跟踪此类问题

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-02-10T09:36:12.223

我们的源代码模块之一绝对是内联`#pragma todo`行。构建输出被污染了，所以我们永远无法真正判断何时有任何新的编译器警告。一些待办事项已经存在多年，而最初的开发人员早已离开公司。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-03-18T15:55:44.340

如果您使用 continouis 集成，它可以为您完成工作。例如，我将 hudson 与这个插件[http://wiki.hudson-ci.org/display/HUDSON/Task+Scanner+Plugin](http://wiki.hudson-ci.org/display/HUDSON/Task+Scanner+Plugin)一起使用，这是非常好的 imo。您有一个图表，显示在构建之间是否添加了新任务，您可以浏览它们或旧任务以了解“打开”的内容。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-02-10T09:53:07.440

当我有很多待办事项时，我发现跟踪它们是没有用的。你最终会得到数百个无法完成的待办事项。

只写你被问到的（老板），做每天带来最大利益的事情。

然而，我有一个下一个列表。我在顶部写了我目前正在做的事情以及我需要修复以完成它的事情。我的下一个清单通常可以在几小时或几天内完成。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2009-02-10T09:46:40.467

对于小型项目，我使用来自我的 SCM 的提交评论。这些评论看起来像这样：

> MyProjectName：完成了这个，修复了那个。杀手级功能将被实施。另一个功能已编码但尚未测试。应该重构这个模块。

# web-services - Web 服务的客户端授权

> ID：531637
> 
> 赞同：1
> 
> 时间：2009-02-10T09:28:35.223
> 
> 标签：web-services, authorization

如何授权客户端（在这种情况下，客户端是应用程序）在 .NET 中使用 Web 服务，

例如：我希望第三方应用程序调用一个方法，但不允许网络内的其他应用程序调用此方法。

我想避免传输层授权并使用基于消息的授权。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:31:50.847

最简单（也是最“便携”）的事情是使用[HTTP Authentication](http://en.wikipedia.org/wiki/HTTP_Authentication)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T10:23:41.533

您应该查看 WS-Security 和 WS-Policy 标准。最好的方法是让客户端应用程序签署所有请求（使用私钥）并在服务器端检查此签名。

我们使用这样的设置，在 WSDL 中有以下 WS-Policy 定义：

```
<!--Endpoint Policy-->
<wsp:Policy wsu:Id="Endpoint_policy"
            xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"
            xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
  <wsp:ExactlyOne>
    <wsp:All>

      <sp:AsymmetricBinding
         xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
        <wsp:Policy>
          <sp:InitiatorToken>
            <wsp:Policy>
              <sp:X509Token
                 sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">
                <wsp:Policy>
                  <sp:WssX509V3Token10 />
                </wsp:Policy>
              </sp:X509Token>
            </wsp:Policy>
          </sp:InitiatorToken>

          <sp:RecipientToken>
            <wsp:Policy>
              <sp:X509Token
                 sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never">
                <wsp:Policy>
                  <sp:WssX509V3Token10 />
                </wsp:Policy>
              </sp:X509Token>
            </wsp:Policy>
          </sp:RecipientToken>

          <sp:AlgorithmSuite>
            <wsp:Policy>
              <!-- sp:Basic256/-->
              <sp:TripleDesRsa15 />
            </wsp:Policy>
          </sp:AlgorithmSuite>

          <sp:Layout>
            <wsp:Policy>
              <sp:Lax />
            </wsp:Policy>
          </sp:Layout>

        </wsp:Policy>
      </sp:AsymmetricBinding>

      <sp:Wss10
         xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
        <wsp:Policy>
          <sp:MustSupportRefKeyIdentifier />
          <sp:MustSupportRefIssuerSerial />
        </wsp:Policy>
      </sp:Wss10>

    </wsp:All>
  </wsp:ExactlyOne>
</wsp:Policy>
<!--End of Endpoint Policy-->

<!--Message Policy1-->
<wsp:Policy wsu:Id="Sign_message_policy"
            xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"
            xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
  <wsp:ExactlyOne>
    <wsp:All>

      <sp:SignedParts
         xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
        <sp:Body />
      </sp:SignedParts>

    </wsp:All>
  </wsp:ExactlyOne>
</wsp:Policy>

<!--End of Message Policy1--> 
```

然后在 WSDL 的绑定部分引用这些策略。例子：

```
 <binding name="ExampleServiceSOAP" type="foobar:ExampleServicePort">
    <!-- WS-Security -->
    <wsp:PolicyReference URI="#Endpoint_policy" />
    <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <operation name="getSomething">
      <soap:operation soapAction="getSomething" style="document"/>
      <input>
        <!-- WS-Security -->
        <wsp:PolicyReference URI="#Sign_message_policy" />
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
    </operation>
  </binding> 
```

# c# - C#：如何知道是否安装了某些 Office 2003 或 2007 应用程序？

> ID：531659
> 
> 赞同：2
> 
> 时间：2009-02-10T09:36:09.667
> 
> 标签：c#, .net, ms-office

我需要知道 Microsoft Word、Excel、Outlook、Project 等是否安装在 Windows Forms .net 2.0 C# 应用程序中。
第一次尝试是简单地尝试创建应用程序对象并捕获任何异常，但这太耗时了。
有没有更快的方法来检测这个？比如检查注册表值，或者使用 COM 包装器的其他技术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T09:59:00.623

这应该有效，如此[处](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/f84ec9fb-3b32-408f-b1ea-7041ed33962a/)所述。不过，这不是一个非常优雅的解决方案，因为它是特定于版本的，并且会在下一个办公版本中中断。此示例适用于 Office 2003，因此如果不进行更新，它将无法与 Office 2007 一起使用。

```
const string ASSEMBLY2003 = "Microsoft.Office.Interop.Excel, Version=11.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c";  

static bool IsAssemblyInstalled(string assembly)  
{  
   try 
   {  
       s_assemblyExcel = Assembly.Load(assembly);  
       return true;  
   }   
   catch 
   {  
       return false;  
   }  
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T10:01:10.823

您可以使用 MSI (Windows Installer) API 来查明机器上是否存在相关的产品/包/组件代码。这些通过 P/Invoke 使用起来相当简单。

或者，您可以查看注册表。例如，Word 2007 将其安装位置放在`HKLM\SOFTWARE\Microsoft\Office\12.0\Word\InstallRoot`.

如果您打算使用互操作组件，这对您没有帮助，但它*确实*可以合理确定地告诉您是否安装了各种东西。

# asp.net - gridview asp.net 将鼠标悬停在 TR 上查找在服务器端代码上单击了哪一行

> ID：531666
> 
> 赞同：3
> 
> 时间：2009-02-10T09:37:09.727
> 
> 标签：asp.net, javascript, gridview

我对整个 JavaScript 事情还是很陌生。我有一个gridview，我希望用户能够将鼠标悬停在整行上（相信它是整个TR）并且能够单击任何地方并且能够选择该行。我需要服务器端代码才能知道点击了哪一行。

我真的不知道从哪里开始，并希望得到一些指导：

1.  添加显示用户悬停在一行上的能力的最佳方法（更改背景颜色或其他内容）

2.  如何连接单击该行上任意位置的能力并触发服务器端代码以了解单击了哪一行。

正在阅读这篇关于从客户端触发服务器端代码的文章[http://www.dotnetcurry.com/ShowArticle.aspx?ID=109](http://www.dotnetcurry.com/ShowArticle.aspx?ID=109) ，但不知道如何弄清楚它来自哪一行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T09:43:44.967

这应该可以解决问题，只需使 gridview 可选

```
protected void Gridview1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            e.Row.Attributes["onmouseover"] = "this.style.background = '#CCCCCC';";
            e.Row.Attributes["onmouseout"] = "this.style.background = '#FFFFFF';";

            e.Row.Attributes["onclick"] = ClientScript.GetPostBackClientHyperlink(this.Gridview1, "Select$" + e.Row.RowIndex);
        }
    } 
```

GridView 单击事件将在服务器端检测到单击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T09:45:15.760

我总是使用中继器控制，对于中继器上的悬停效果我使用 jQuery

这在`<head>`标签之间

```
$(document).ready(function() {
    $(".tr-base").mouseover(function() {
        $(this).toggleClass("trHover");
    }).mouseout(function() {
        $(this).removeClass("trHover");
    });
}); 
```

这是CSS类。

```
.trHover{background-color: #D5E5ED;} 
```

如果单击该行时您不会在服务器端执行任何操作，则可以再次使用 jQuery 来获得选定的效果。

# recursion - 哪些递归函数不能用循环重写？

> ID：531668
> 
> 赞同：41
> 
> 时间：2009-02-10T09:37:16.217
> 
> 标签：recursion

据我所知，大多数递归函数都可以使用循环重写。有些可能比其他的更难，但大多数都可以重写。

在哪些情况下不可能使用循环重写递归函数（如果存在这种情况）？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-02-10T09:54:13.227

当您递归地使用函数时，编译器会为您处理堆栈管理，这使递归成为可能。任何可以递归执行的操作，都可以通过自己管理堆栈来完成（对于间接递归，您只需确保不同的函数共享该堆栈）。

所以，不，没有什么可以用递归来完成，也不能用**循环和堆栈**来完成。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-10T09:48:53.020

任何递归函数都可以进行迭代（进入循环），但您需要自己使用堆栈来保持状态。

通常，尾递归很容易转换为循环：

```
A(x) {
  if x<0 return 0;
  return something(x) + A(x-1)
} 
```

可以翻译成：

```
A(x) {
  temp = 0;
  for i in 0..x {
    temp = temp + something(i);
  }
  return temp;
} 
```

其他可以翻译成尾递归的递归也很容易改变。另一个需要更多的工作。

以下：

```
treeSum(tree) {
  if tree=nil then 0
  else tree.value + treeSum(tree.left) + treeSum(tree.right);
} 
```

不是那么容易翻译。您可以删除递归的一部分，但如果没有保持状态的结构，则另一部分是不可能的。

```
treeSum(tree) {
  walk = tree;
  temp = 0;
  while walk != nil {
    temp = temp + walk.value + treeSum(walk.right);
    walk = walk.left;
  }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-10T12:49:27.120

**每个递归函数都可以用一个循环来实现。**

想想处理器做了什么，它在一个循环中执行指令。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-10T09:44:08.367

我不知道递归函数无法转换为迭代版本的示例，但不切实际或效率极低的示例是：

*   树遍历

*   快速傅里叶

*   快速排序（和其他一些 iirc）

基本上，任何你必须开始跟踪无限潜在状态的地方。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-10T09:40:14.587

与其说它们不能使用循环来实现，不如说是递归算法的工作方式，它更清晰、更简洁（在许多情况下可以通过数学证明）一个函数是正确的。

许多递归函数可以写成尾循环递归，可以优化为循环，但这取决于所使用的算法和语言。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-10T09:39:55.210

它们都可以写成一个迭代循环（但有些可能仍然需要一个堆栈来保持以前的状态以供以后的迭代使用）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-10T09:51:00.487

[Ackermann function](http://en.wikipedia.org/wiki/Ackermann_function)是一个极难从递归转换为迭代的示例。

![替代文字](https://upload.wikimedia.org/math/0/a/e/0ae4053de098cc9554752b190a38bc56.png)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-10T10:03:07.120

间接递归仍然可以转换为非递归循环；只需从其中一个函数开始，然后内联对其他函数的调用，直到您有一个直接递归函数，然后可以将其转换为使用堆栈结构的循环。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-08-08T04:42:04.403

在[SICP](https://mitpress.mit.edu/sicp/)中，作者挑战读者想出一种纯粹的迭代方法来实现“计数变化”问题（这里有一个来自 Project Euler[的示例）。](http://projecteuler.net/index.php?section=problems&id=31)

但是已经给出了对您问题的严格答案-循环和堆栈可以实现任何递归。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T09:40:01.030

您总是可以使用循环，但您可能需要创建更多数据结构（例如模拟堆栈）。

# c++ - 在 Windows 中使用 C++ 截取窗口的最佳方式是什么？

> ID：531684
> 
> 赞同：42
> 
> 时间：2009-02-10T09:42:13.940
> 
> 标签：c++, windows, screenshot

在 Windows 下使用 C++ 截取正在运行的应用程序的最佳（最简单）方法是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-10T09:56:02.957

您必须获取窗口 ( [`GetWindowDC()`](http://msdn.microsoft.com/en-us/library/dd144947(VS.85).aspx)) 的设备上下文并从中复制图像 ( [`BitBlt()`](http://msdn.microsoft.com/en-us/library/dd183370(VS.85).aspx))。根据您对应用程序的其他了解，您将使用不同的方法来查找要传递到的窗口句柄`GetWindowDC()`。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-04-09T11:37:01.690

`GetDC(NULL)`+`BitBlt()`

要捕获半透明/alpha/分层窗口，您必须将`CAPTUREBLT`标志传递给`BitBlt`，如果这样做，光标会闪烁，请阅读[这篇 technet 文章](http://technet.microsoft.com/en-us/magazine/2009.02.windowsconfidential.aspx)以找出原因。

在 NT6+ 上，您也许可以使用[Magnification API](http://msdn.microsoft.com/en-us/library/ms692402(VS.85).aspx)来做您想做的事。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T07:16:07.607

在[keybd_event](http://msdn.microsoft.com/en-us/library/ms646304(VS.85).aspx)函数文档中，它声明您可以使用它来截取屏幕截图并将其保存到剪贴板。例如：

```
keybd_event(VK_SNAPSHOT, 0, KEYEVENTF_SILENT, 0); 
```

在我的版本中（我的计算机上安装了 Visual Studio 2005 帮助），它指出您可以通过将第二个参数设置为 0 来截取整个桌面的屏幕截图，或者通过将其设置为 1 来截取当前应用程序的屏幕截图。

将其从剪贴板缓冲区中取出留作读者练习。

但是，在这样做之前我会仔细考虑，因为它会破坏剪贴板中已经存在的任何图像数据。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-13T08:42:10.597

这是一个示例[代码](https://msdn.microsoft.com/en-us/library/windows/desktop/dd183402(v=vs.85).aspx)
， 您可以执行`CaptureAnImage(GetDesktopWindow());`屏幕截图。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2020-04-14T00:52:21.983

桌面是与用户交互的“虚拟”设备。因此，它可能包含与隐私相关的信息。我建议在可执行文件尝试截屏时添加来自操作系统的安全检查/警告提示，除非最终用户明确表示他（她）知道发生了什么。

# biztalk - 用于 CRM 4.0 响应的 BizTalk 2006 适配器

> ID：531687
> 
> 赞同：0
> 
> 时间：2009-02-10T09:43:35.280
> 
> 标签：biztalk, dynamics-crm, dynamics-crm-4

你好，

我正在使用 MS CRM 4.0 的 BTS 2006 适配器来创建记录并从 MS CRM 4.0 获取数据。我想在创建记录后从 CRM 获取响应或从 CRM 获取数据为此，我使用带有用于 MS CRM 4.0 的 BTS 2006 适配器的**response.xsd**来接收来自 MS CRM 的响应，我为响应设置了目标命名空间。 xsd as: targetNamespace= **" [http://schemas.microsoft.com/crm/2007/BizTalkAdapter/MicrosoftCRM/Response](http://schemas.microsoft.com/crm/2007/BizTalkAdapter/MicrosoftCRM/Response) "**根据此处的组织名称**orgName: "MicrosoftCRM"** （有关更多详细信息，我指的是[http:// www.ascentium.com/blog/crm/Post398.aspx](http://www.ascentium.com/blog/crm/Post398.aspx)）

*现在我收到一个错误：*

引发异常：段 -1，进度 -1 *内部异常：收到意外消息类型“与**预期类型不匹配**” [http://schemas.microsoft.com/crm/2007/BizTalkAdapter/MicrosoftCRM/Response#Response](http://schemas.microsoft.com/crm/2007/BizTalkAdapter/MicrosoftCRM/Response#Response)*

异常类型：UnexpectedMessageTypeException 来源：Microsoft.XLANGs.Engine 目标站点：Void VerifyMessage(Microsoft.XLANGs.Core.Envelope, System.String, Microsoft.XLANGs.Core.Context, Microsoft.XLANGs.Core.OperationInfo)

这是在 Visual Studio 2005 中生成的 response.xsd 的 Schema 实例

```
 - <ns0:Response xmlns:ns0="http://schemas.microsoft.com/crm/2007/BizTalkAdapter/MicrosoftCRM/Response">
    - <Header>
      <ReturnCode>ReturnCode_0</ReturnCode>
      <ErrorCode>ErrorCode_0</ErrorCode>
      <ErrorString>ErrorString_0</ErrorString>
      <Retryable>Retryable_0</Retryable>
      </Header>
    - <Body>
      <Message>Message_0</Message>
      </Body>
      </ns0:Response> 
```

这是来自 CRM 的响应的暂停消息详细信息

```
<ns0:Response xmlns:ns0="http://schemas.microsoft.com/crm/2007/BizTalkAdapter/MicrosoftCRM/Response">
    <Header>
        <ReturnCode>1</ReturnCode>
        <ErrorCode></ErrorCode>
        <ErrorString></ErrorString>
        <Retryable></Retryable>
    </Header>
    <Body>
        <Message><prefix:CreateResponse xmlns:prefix="http://localhost/schemas.microsoft.com/crm/2007/MicrosoftCRM/CreateResponse"><id>f0650fb5-3ff7-dd11-b0f0-0003ff1a2a3c</id></prefix:CreateResponse></Message>
    </Body>
</ns0:Response> 
```

谢谢，

库尔迪普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:28:25.597

从 Microsoft BizTalk CRM 4.0 适配器开始，使用适配器自动生成的架构“CRMAdapterResponse_Response.xsd”，而不是“response.xsd”。此模式将特定于所考虑的组织。

使用模式将解决您的“模式与预期类型不匹配”问题。

谢谢。

# macos - Applescript 问题 - 将曲目添加到播放列表

> ID：531692
> 
> 赞同：7
> 
> 时间：2009-02-10T09:44:38.507
> 
> 标签：macos, applescript

说真的，我连问这个都不好意思。

我有一个 Applescript，它应该建立一个包含整张专辑的播放列表。一切正常，除了将曲目实际添加到播放列表中。以下是相关代码：

```
repeat with theAlbum in randAlbums
    set these_tracks to (tracks of library playlist 1 whose album is theAlbum)
    repeat with the_track in these_tracks
        add the_track to playlist thePlaylist  (* doesn't work *)
    end repeat
end repeat 
```

我得到的错误是“iTunes 出错：发生描述符类型不匹配”。

randAlbums 是唯一专辑名称的列表，而 thePlaylist 是在脚本前面创建的播放列表。

一个星期以来，我一直在努力解决这个问题，但我一直无法弄清楚。提前感谢您提供的任何帮助:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T15:00:04.560

重复是您想要的命令。试试这个：

```
repeat with theAlbum in randAlbums
    duplicate (tracks of library playlist 1 whose album is theAlbum) to thePlaylist
end repeat 
```

在 iTunes 界面内，`add`用于使用文件系统路径将新曲目添加到 iTunes 库，同时`duplicate`用于在播放列表中放置对现有曲目的引用。

当使用 add 命令时，iTunes 最终会发现该曲目已经是库的一部分并执行您想要的操作，但不是在它读取文件的元数据、安排它以进行专辑封面检索等之前。所有这些都相当于一个运行速度非常慢，因此如果您在循环中使用它来播放大量曲目，iTunes 会慢得像爬行一样。

Duplicate 执行本地数据库查找并将结果一次性添加到播放列表中，因此速度非常快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T00:59:23.920

尝试：

```
copy the_track to end of playlist thePlaylist 
```

反而。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T09:51:52.403

Applescript 真的很奇怪......但是在[这里查看脚本 dougscripts.com](http://dougscripts.com/itunes/index.php)

看起来他在添加到播放列表时使用*重复*而不是*添加。*我正在看每个剧本中的[一首歌](http://dougscripts.com/itunes/scripts/ss.php?sp=onesongfromeach)

嗯……怎么样？

```
add (a reference to the_track) to playlist thePlaylist 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T09:55:46.453

尝试将该行更改为：

```
add (get location of the_track) to playlist thePlaylist 
```

或者，如果`thePlaylist`已经是播放列表引用（而不仅仅是播放列表的字符串名称）：

```
add (get location of the_track) to thePlaylist 
```

# java - 如何在 Java 中获取系统变量值？

> ID：531694
> 
> 赞同：203
> 
> 时间：2009-02-10T09:45:33.543
> 
> 标签：java, environment-variables

如何获取系统变量值存在于

```
MyComputer -> Properties -> Advanced -> Environment Variables -> System Variables 
```

在 Java 中？

*编辑*

我用过`System.getenv()`方法。

如果我给，它是印刷价值

```
System.out.println(System.getenv("JAVA_HOME")); 
```

`null`如果我对我创建的系统变量尝试相同的操作，它就会显示价值

```
System.out.println(System.getenv("DBE")); 
```

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2009-02-10T09:48:10.637

使用[`System.getenv(String)`](http://docs.oracle.com/javase/8/docs/api/java/lang/System.html#getenv-java.lang.String-)方法，传递要读取的变量的名称。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-02-10T10:26:14.320

为了澄清，系统变量与环境变量相同。用户环境变量是按用户设置的，并且在不同用户登录时会有所不同。无论用户登录，系统范围的环境变量都是相同的。

要在 Java 中访问系统范围变量或用户变量的当前值，请参见下文：

```
String javaHome = System.getenv("JAVA_HOME"); 
```

有关环境变量的更多信息，请参阅此[维基百科页面](http://en.wikipedia.org/wiki/Environment_variable)。

还要确保在调用 Java 之前正确设置了您尝试读取的环境变量，方法是：

```
echo %MYENVVAR% 
```

您应该看到环境变量的值。如果没有，您可能需要重新打开 shell (DOS) 或注销并重新登录。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-02-11T09:50:05.263

There are a few details of interest when getting system/environment properties.

First, `System.getenv(String)` was introduced way-back-when, then deprecated. The deprecation (foolishly, IHMO) continued [all the way into JSE 1.4](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/System.html#getenv(java.lang.String)).

It got [re-introduced in JSE 5](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getenv(java.lang.String)).

Those are set using the Environment Variables panel in Windows. Changes to the variables may not get picked up until your current VM is shutdown, and the CMD.exe instance is exited.

In contrast to the environment properties, Java also has Java system properties, accessible through [`System.getProperties()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getProperties()). These variables can be initialized when the VM is started using a series `-D*name*=*value*` command line arguments. For example, the values for the properties `maxInMemory` and `pagingDirectory` are set in the command below:

```
C:\> java.exe -DmaxInMemory=100M -DpagingDirectory=c:\temp -jar myApp.jar

```

These properties can be modified at runtime, barring security policy restrictions.

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2016-06-17T14:51:30.730

实际上变量可以设置或不设置，因此，在 Java 8 或更高版本中，它的可为空值应该被包装到一个`Optional`对象中，这样可以提供非常好的特性。在下面的示例中，我们将尝试获取变量`ENV_VAR1`，如果它不存在，我们可能会抛出一些自定义异常来警告它：

```
String ENV_VAR1 = Optional.ofNullable(System.getenv("ENV_VAR1")).orElseThrow(
  () -> new CustomException("ENV_VAR1 is not set in the environment")); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-10T09:49:47.963

谷歌说要检查[getenv()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getenv())：

> 返回当前系统环境的不可修改的字符串映射视图。

但是，我不确定系统变量与环境变量有何不同，因此，如果您能澄清一下，我可以提供更多帮助。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-10T13:13:08.543

设置环境变量后，您是否尝试过重新启动？

似乎 Windows 将其环境变量保存在某种缓存中，重新启动是刷新它的一种方法。我不确定，但可能有不同的方法，但如果您不打算太频繁地更改变量值，这可能就足够了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-11-21T10:04:57.083

正如上面 sombody 所提到的，对于用户定义的环境变量，重新启动 eclipse 对我有用。在我重新启动 Eclipse IDE 后，`System.getenv()`正在获取我的环境变量。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-02-19T03:27:01.423

你是linux系统吗？如果是这样，请确保您正在导出变量。

```
myVar=testvalue; export myVar 
```

除非我使用 export 来全局定义值，否则我会得到 null。

# c# - 如何在 .NET 中毫无例外地打印当前的堆栈跟踪？

> ID：531695
> 
> 赞同：399
> 
> 时间：2009-02-10T09:45:34.933
> 
> 标签：c#, .net, logging, stack-trace, printstacktrace

我有一个常规的 C# 代码。***我没有例外***。我想以编程方式记录当前堆栈跟踪以进行调试。例子：

```
public void executeMethod() 
{
    logStackTrace();
    method();
} 
```

* * *

## 回答 #1

> 赞同：453
> 
> 时间：2009-02-10T09:47:02.930

看一下[`System.Diagnostics`](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics)命名空间。里面好多好吃的！

```
System.Diagnostics.StackTrace t = new System.Diagnostics.StackTrace(); 
```

可以四处探索以了解引擎盖下发生的事情真是太好了。

我建议您查看日志解决方案（例如 NLog、log4net 或 Microsoft 模式和实践企业库），这些解决方案可能会达到您的目的，然后是一些。

* * *

## 回答 #2

> 赞同：250
> 
> 时间：2011-07-08T12:38:02.003

另一种方法`System.Diagnostics.StackTrace`是使用[System.Environment.StackTrace](https://docs.microsoft.com/en-us/dotnet/api/system.environment.stacktrace)，它返回堆栈跟踪的字符串表示形式。

另一个有用的选项是[在 Visual Studio](https://docs.microsoft.com/en-us/visualstudio/debugger/using-breakpoints#BKMK_Print_to_the_Output_window_with_tracepoints)`$CALLER`中使用和调试变量，因为这可以在运行时启用而无需重新构建应用程序。`$CALLSTACK`

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-02-10T10:05:37.037

有两种方法可以做到这一点。这`System.Diagnostics.StackTrace()`将为您提供当前线程的堆栈跟踪。如果你有一个`Thread`实例的引用，你可以通过`StackTrace()`.

您可能还想查看堆栈溢出问题*[如何获取非当前线程的堆栈跟踪？](https://stackoverflow.com/questions/285031/how-to-get-non-current-threads-stacktrace/528043#528043)*.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-12-09T18:19:27.393

您也可以在 Visual Studio 调试器中执行此操作，而无需修改代码。

1.  在要查看堆栈跟踪的位置创建断点。
2.  右键单击断点并在 VS2015 中选择“Actions...”。在 VS2010 中，选择“When Hit...”，然后启用“Print a message”。
3.  确保选择“继续执行”。
4.  输入一些你想打印出来的文本。
5.  在要查看堆栈跟踪的任何位置添加 $CALLSTACK。
6.  在调试器中运行程序。

当然，如果您在另一台机器上运行代码，这无济于事，但是能够自动吐出堆栈跟踪而不影响发布代码甚至不需要重新启动程序会非常方便。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-12-20T01:24:30.803

```
Console.WriteLine(
    new System.Diagnostics.StackTrace().ToString()
    ); 
```

输出将类似于：

> 在 YourNamespace.Program.executeMethod(String msg)
> 
> 在 YourNamespace.Program.Main(String[] args)

替换`Console.WriteLine`为您的`Log`方法。实际上，不需要`.ToString()`Console.WriteLine 案例，因为它接受 `object`. 但是您的 Log(string msg) 方法可能需要它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-02T11:19:19.853

这对我有用：

```
Debug.WriteLine(Environment.StackTrace); 
```

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2018-05-29T18:02:22.303

```
 private void ExceptionTest()
    {
        try
        {
            int j = 0;
            int i = 5;
            i = 1 / j;
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
            var stList = ex.StackTrace.ToString().Split('\\');
            Console.WriteLine("Exception occurred at " + stList[stList.Count() - 1]);
        }
    } 
```

似乎对我有用

# c# - 手动编写解析器的最佳方法是什么？

> ID：531707
> 
> 赞同：23
> 
> 时间：2009-02-10T09:49:19.993
> 
> 标签：c#, .net, parsing, f#

我们使用 ANTLR 为类似 SQL 的语法创建了解析器，虽然在大多数情况下结果令人满意，但我们需要修复一些边缘情况；而且由于我们自己没有编写解析器，因此我们对它的理解还不够好，无法做出明智的改变。

所以，我们想编写自己的解析器。手动编写解析器的最佳方法是什么？我们应该使用什么样的解析器——推荐使用递归下降；是对的吗？我们将使用 C# 编写它，因此任何使用该语言编写解析器的教程都将受到欢迎。

更新：我也对涉及 F# 的答案感兴趣——我一直在寻找在项目中使用它的理由。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-08-10T11:13:28.717

我强烈推荐 F# 语言作为您在 .NET 平台上解析的首选语言。它源于 ML 语言家族，这意味着它对面向语言的编程具有出色的支持。

可区分的联合和模式匹配允许对您的 AST 进行非常简洁和强大的规范。高阶函数允许定义解析操作及其组合。对 monadic 类型的一流支持允许隐式处理状态管理，从而大大简化了解析器的组合。强大的类型推断极大地帮助了这些（复杂）类型的定义。所有这些都可以交互指定和执行，让您快速制作原型。

[Stephan Tolksdorf 通过他的解析器组合库FParsec](http://www.quanttec.com/fparsec/)将其付诸实践

从他的示例中，我们可以看到指定 AST 是多么自然：

```
type expr =
    | Val of string
    | Int of int
    | Float of float
    | Decr of expr

type stmt =
    | Assign of string * expr
    | While of expr * stmt
    | Seq of stmt list
    | IfThen of expr * stmt
    | IfThenElse of expr * stmt * stmt
    | Print of expr

type prog = Prog of stmt list 
```

解析器的实现（部分省略）同样简洁：

```
let stmt, stmtRef = createParserForwardedToRef()

let stmtList = sepBy1 stmt (ch ';')

let assign =
    pipe2 id (str ":=" >>. expr) (fun id e -> Assign(id, e))

let print = str "print" >>. expr |>> Print

let pwhile =
    pipe2 (str "while" >>. expr) (str "do" >>. stmt) (fun e s -> While(e, s))

let seq =
    str "begin" >>. stmtList .>> str "end" |>> Seq

let ifthen =
    pipe3 (str "if" >>. expr) (str "then" >>. stmt) (opt (str "else" >>. stmt))
          (fun e s1 optS2 ->
               match optS2 with
               | None    -> IfThen(e, s1)
               | Some s2 -> IfThenElse(e, s1, s2))

do stmtRef:= choice [ifthen; pwhile; seq; print; assign]

let prog =
    ws >>. stmtList .>> eof |>> Prog 
```

在第二行，作为示例，`stmt`and`ch`是解析器，并且`sepBy1`是一个单子解析器组合器，它采用两个简单的解析器并返回一个组合解析器。在这种情况下`sepBy1 p sep`，返回一个解析器，该解析器解析一个或多个由`p`分隔的事件`sep`。因此，您可以看到一个强大的解析器可以多快地从简单的解析器中组合起来。F# 对重写运算符的支持还允许使用简洁的中缀表示法，例如，可以将排序组合器和选择组合器指定为`>>.`和`<|>`。

祝你好运，

丹尼

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T10:00:15.147

唯一可以由理智的人手写的解析器是递归下降。也就是说，手动编写自下而上的解析器仍然是可能的，但非常不可取。

如果您准备使用 RD 解析器，则必须验证 SQL 语法不是左递归的（并在必要时消除递归），然后基本上为每个语法规则编写一个函数。请参阅[此](http://www.mollypages.org/page/grammar/index.mp)以供进一步参考。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T09:58:40.830

递归下降将为您提供最简单的方法，但我必须同意 mouviciel 的 flex 和 bison 并且绝对值得学习。当你发现你的语法有错误时，在 flex /bison 中修复语言的定义将比重写你的递归下降代码容易得多。

仅供参考，C# 解析器是编写递归下降的，它往往非常健壮。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-10T18:19:49.773

将我的声音添加到合唱中以支持递归下降（LL1）。它们简单、快速且 IMO，一点也不难维护。

但是，请仔细查看您的语言以确保它是 LL1。如果你有任何像 C 一样的语法，比如**((((type))foo)[ ])**，你可能必须在你发现你是否正在查看一个类型、变量或表达式之前将多层括号递减，那么LL1将非常困难，并且自下而上获胜。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-10T18:07:07.777

递归下降解析器确实是最好的，也许是唯一可以手工构建的解析器。你仍然需要弄清楚什么是正式的、上下文无关的语言，并将你的语言置于正常形式。我个人建议您删除左递归并将您的语言放在[Greibach Normal Form](http://www.scribd.com/doc/7193282/Greibach-Normal-Form)中。当你这样做时，解析器就会自己写。

例如，这个生产：

```
A => aC 
A => bD
A => eF 
```

变得很简单，例如：

```
int A() {
   chr = read();
   switch char
     case 'a': C();
     case 'b': D();
     case 'e': F();
     default: throw_syntax_error('A', chr);
} 
```

而且这里没有任何更困难的情况（更困难的是确保您的语法完全正确，但这可以让您控制您提到的）。

[安东的链接](http://www.mollypages.org/page/grammar/index.mp)似乎也很棒。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-10T10:01:52.397

如果您想手动编写，递归体面是最明智的方法。

您可以使用表解析器，但这将非常难以维护。

例子：

```
Data = Object | Value;
Value = Ident, '=', Literal;
Object = '{', DataList, '}';
DataList = Data | DataList, Data;

ParseData {
  if PeekToken = '{' then 
    return ParseObject;
  if PeekToken = Ident then
    return ParseValue;
  return Error;
}

ParseValue {
  ident = TokenValue;
  if NextToken <> '=' then 
    return Error;
  if NextToken <> Literal then
    return Error;
  return(ident, TokenValue);
 }

ParseObject {
  AssertToken('{');
  temp = ParseDataList;
  AssertToken('}');
  return temp;
}

ParseDataList {
  data = ParseData;
  temp = []
  while Ok(data) {
    temp = temp + data;
    data = ParseData;
  }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-10T18:33:44.810

我建议您不要手动编写词法分析器 - 使用 flex 或类似的。识别令牌的任务不是手工完成，但我认为你不会有太多收获。

正如其他人所说，递归下降解析器最容易手工编写。否则，您必须维护每个令牌的状态转换表，这不是人类可读的。

我很确定 ANTLR 无论如何都实现了递归下降解析器：[在一次关于 ANTLR 3.0 的采访中](http://www.artima.com/lejava/articles/antlr_3.html)提到了它。

我还发现了一系列关于[用 C# 编写解析器](http://tommycarlier.blogspot.com/2007/05/writing-parser-overview.html)的博客文章。看起来很温柔。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-10T03:52:23.147

冒着冒犯 OP 的风险，当有好的解析器生成器工具（如 ANTLR）可用时，手动为大型语言（如某些特定供应商的 SQL）编写解析器简直是疯了。与使用解析器生成器修复“边缘情况”相比，您将花费更多时间手动重写解析器，并且随着 SQL 标准的移动或您发现自己误解了，您总是不得不返回并修改解析器别的东西。如果您对解析技术不够了解，请花时间了解它。你不需要几个月的时间来弄清楚如何使用解析器生成器处理边缘情况，而且你已经承认你愿意花几个月的时间手工完成。

话虽如此，如果您一心想手动重做，使用递归下降解析器是手动完成的最佳方法。

（注意：OP 在下面澄清说他想要一个参考实现。恕我直言，您永远不应该在程序上编写语法的参考实现，因此递归下降已经过时了。）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-11T14:05:12.257

没有“最好的”方式。根据您的需要，您可能需要自下而上 (LALR1) 或递归下降 (LLk)。[诸如此类的](http://etymon.blogspot.com/2006/09/why-i-prefer-lalr-parsers.html)文章给出了偏爱 LALR(1)（自下而上）而不是 LL(k) 的个人理由。然而，每种类型的解析器都有其优点和缺点。通常 LALR 会更快，因为将[有限状态机](http://en.wikipedia.org/wiki/Finite-state_machine)生成为查找表。

选择适合您的情况检查您的情况；熟悉工具和技术。从一些[LALR](http://en.wikipedia.org/wiki/LALR_parser)和[LL](http://en.wikipedia.org/wiki/LL_parser) Wikipedia 文章开始是不错的选择。在这两种情况下，您都应该始终从指定[BNF](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)或[EBNF](http://en.wikipedia.org/wiki/EBNF)中的语法开始。我更喜欢EBNF，因为它简洁。

一旦您对您想要做什么以及如何将其表示为语法进行了思考，（BNF 或 EBNF）尝试使用几种不同的工具，并在要解析的代表性文本样本中运行它们。

**轶事：**

但是，我听说 LL(k) 更灵活。我从来没有费心自己去发现。从我为数不多的解析器构建经验中，我注意到无论是 LALR 还是 LL(k)，选择最适合您需求的最佳方法是从编写语法开始。我编写了自己的 C++ EBNF RD 解析器构建器模板库，使用了 Lex/YACC 并编写了一个小型 RD 解析器。这跨越了 15 年的大部分时间，我在三个项目中最长的一个项目上花了不超过 2 个月的时间。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T09:55:56.873

在 C/Unix 中，传统的方式是使用 lex 和 yacc。对于 GNU，等效的工具是 flex 和 bison。我不知道 Windows/C#。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-10T15:07:41.967

如果我是你，我会使用 GUI ANTLRWorks 再一次尝试 ANTLRv3，它为你提供了一种非常方便的语法测试方法。我们在我们的项目中使用了 ANTLR，虽然一开始学习曲线可能会有点陡峭，但是一旦你学会了它就很方便了。在他们的电子邮件通讯中也有很多人非常乐于助人。

PS。IIRC 他们也有一个 SQL 语法，你可以看看。

hth

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T10:00:13.977

好吧，如果您不介意使用其他编译器编译器工具，例如**ANTLR**，我建议您看看[Coco/R](http://www.ssw.uni-linz.ac.at/Research/Projects/Coco/)

我以前用过，还不错。。。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T18:28:58.130

您不想要表驱动解析器的原因是您将无法创建合理的错误消息。这对于一种生成的语言来说是可以的，但对于人类参与的语言来说却不是这样。类 c 语言编译器产生的错误消息提供了充分的证据，证明人们可以适应任何事情，无论多么糟糕。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-11T10:16:17.837

我也会投票支持使用现有的解析器 + 词法分析器。

我可以看到手动操作的唯一原因：

*   如果你想要一些相对简单的东西（比如验证/解析一些输入）
*   学习/理解原则。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-11T12:19:28.400

JFlex 是 Java 的 flex 实现，现在该项目有一个 C# 端口[http://sourceforge.net/projects/csflex/](http://sourceforge.net/projects/csflex/)。似乎还有一个 CUP 的 C# 端口正在进行中，可以在这里找到：http: [//sourceforge.net/projects/datagraph/](http://sourceforge.net/projects/datagraph/)

我也建议避免手工制作自己的解决方案。我曾经自己尝试过这种非常简单的语言（大学项目的一部分），而且非常耗时且困难。一旦编写完成，维护和更改也非常困难。

使用现有的解析器生成器是可行的方法，因为大部分艰苦的工作已经完成并且多年来经过了很好的测试。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-11T12:23:13.307

查看用于 .NET 的 gplex 和 gppg、词法分析器和解析器生成器。它们运行良好，并且基于与 lex 和 yacc 相同（且几乎兼容）的输入，相对容易使用。

# python - 使用 (wx)python 记录外部程序的输出

> ID：531708
> 
> 赞同：2
> 
> 时间：2009-02-10T09:49:39.803
> 
> 标签：python, oracle, wxpython, sqlplus

我正在编写一个用于使用 oracle exp/imp 命令并通过 sqlplus 启动 sql-scripts 的 GUI。subprocess 类使启动命令变得容易，但我需要一些额外的功能。我想在使用我的 wxPython GUI 时摆脱命令提示符，但我仍然需要一种方法来显示 exp/imp 命令的输出。

我已经尝试过这两种方法：

```
command = "exp userid=user/pwd@nsn file=dump.dmp"

process = subprocess.Popen(command, stdout=subprocess.PIPE)
output = process.communicate()[0]

process = subprocess.Popen(command, stdout=subprocess.PIPE)
process.wait()
output = process.stdout.read() 
```

通过其中一种方法（忘了哪一种），我确实得到了 exp/imp 的输出，但只有在命令完成之后，这对我来说毫无价值，因为在这些可能长时间运行的操作期间我需要经常更新。并且 sqlplus 提出了更多问题，因为 sqlplus 在发生错误时主要需要一些输入。当发生这种情况时，python 等待进程完成但用户看不到提示，所以你不知道要等待多长时间或做什么......

我想要的是一个包装器，它输出我在标准命令行上可以看到的所有内容。我想将它记录到一个文件中并在 wxPython 控件中显示它。

我还尝试了此页面中的代码： http: [//code.activestate.com/recipes/440554/](http://code.activestate.com/recipes/440554/) 但这也无法读取输出。此答案中的 OutputWrapper 也不起作用：[How can I capture all exceptions from a wxPython application?](https://stackoverflow.com/questions/166198/how-can-i-capture-all-exceptions-from-a-wxpython-application)

任何帮助，将不胜感激！

**编辑：**
子进程似乎没有刷新它们的输出。我已经用 .readline() 试过了。
我的工具必须在 windows 和 unix 上运行，所以如果没有 windows 版本，pexpect 是没有解决方案的。并且使用 cx_oracle 将是极端的矫枉过正，因为我将不得不重建 exp、imp 和 sqlplus 的整个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T10:59:05.980

解决方案是为您的命令使用列表

```
command = ["exp", "userid=user/pwd@nsn", "file=dump.dmp"]
process = subprocess.Popen(command, stdout=subprocess.PIPE) 
```

然后你逐行阅读 process.stdout ：

```
line = process.stdout.readline() 
```

这样，您无需等待即可更新 GUI。**如果**您正在运行的子进程 (exp) 刷新输出。输出可能被缓冲，然后在输出缓冲区已满之前您将看不到任何内容。如果是这种情况，那么您可能不走运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:51:25.510

如果您使用的是 Linux，请查看[pexpect](http://www.noah.org/wiki/Pexpect)。它完全符合您的要求。

如果您需要在 Windows 上工作，也许您应该硬着头皮使用 Python 绑定到 Oracle，例如[cx_Oracle](http://sourceforge.net/projects/cx-oracle/)，而不是通过`subprocess`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T13:49:28.597

这些解决方案是否也能够捕获标准错误？我看到你上面有 stdout= 选项。您如何确保也获得 stderr ？另一个问题是有没有办法使用 import logging/import logging.handlers 来捕获命令 stdout/stderr。能够在格式化程序/旋转器等中使用带有其构建的记录器会很有趣。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T10:55:30.683

尝试这个：

```
import subprocess

command = "ping google.com"

process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE)
output = process.stdout
while 1:
    print output.readline(), 
```

# python - python，sqlite错误？db被锁定了？但不是吗？

> ID：531711
> 
> 赞同：3
> 
> 时间：2009-02-10T09:50:22.347
> 
> 标签：python, sqlite, locking

我的 sqlite3 数据库中出现“数据库表已锁定”错误。我的脚本是单线程的，没有其他应用程序正在使用该程序（我确实在“SQLite Database Browser.exe”中打开过一次）。我复制了文件，删除了原始文件（成功）并重命名了副本，所以我知道当我运行我的脚本时没有进程锁定它，表 B 中的所有内容都无法写入，看起来表 A 很好。发生了什么？

-edit- 我修复了它，但不确定如何。我注意到代码没有做正确的事情（我复制了错误的字段），在修复并清理它之后，它神奇地再次开始工作。

-edit2-

其他人发了，所以我还不如更新。我认为问题是我试图用正在使用的命令/光标做一个语句。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-06-28T21:40:13.170

我以前也遇到过这个问题。当您打开游标和连接，然后您的程序在您可以正确关闭它之前崩溃时，通常会发生这种情况。在某些情况下，可以使用以下函数来确保数据库已解锁，即使在事先未正确提交和关闭数据库之后：

```
from sqlite3 import dbapi2 as sqlite

def unlock_db(db_filename):
    """Replace db_filename with the name of the SQLite database."""
    connection = sqlite.connect(db_filename)
    connection.commit()
    connection.close() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T11:22:35.003

也许您的应用程序在 SQLite 事务开始后过早终止。在目录中查找过时`-journal`的文件并将其删除。

可能也值得浏览一下[文档](http://www.sqlite.org/lockingv3.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-22T15:03:26.403

删除 -journal 文件听起来像是个坏建议。请参阅[此说明](https://stackoverflow.com/questions/151026/how-do-i-unlock-a-sqlite-database/1027493#1027493)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-14T14:52:50.763

当 db 文件位于 NFS 安装的文件系统上时，我也看到了此错误。

# iphone - 在 iphone 上使用 xcode 读取 cookie

> ID：531712
> 
> 赞同：3
> 
> 时间：2009-02-10T09:50:37.463
> 
> 标签：iphone, xcode, cookies, mobile-safari

> **可能重复：**
> [iPhone xcode 应用程序能否读取 Safari Mobile 先前存储的 cookie？](https://stackoverflow.com/questions/532117/can-an-iphone-xcode-application-read-cookies-previously-stored-by-safari-mobile)

我正在尝试使用为 iphone 编写的 xcode 应用程序读取 cookie，并在模拟器上进行测试。但是，当我运行下面的代码时，numcookies 中存储的值是 0。通过 iphone 设置允许使用 cookie，我还使用移动 safari 导航到 gmail、hotmail 和其他 cookie 设置站点以增加模拟器上的 cookie 计数，但没有运气。

非常感谢您的想法，真的希望我没有做一些真正愚蠢的事情:(

```
NSHTTPCookieStorage *jar = [NSHTTPCookieStorage sharedHTTPCookieStorage];
NSInteger numcookies  = [[jar cookies] count]; 
```

托尼

# .net - 如何以可靠和自动的方式测量 .NET 中的内存泄漏？

> ID：531717
> 
> 赞同：1
> 
> 时间：2009-02-10T09:52:48.813
> 
> 标签：.net, memory-leaks

我编写了一个自动化测试，以确保我们的应用程序现在和以后随着开发的发展不会泄漏（托管和非托管内存）。问题是我的测试似乎并不可靠，但我不知道这是否是.NET 和泄漏定义或测试所固有的。

它是这样发生的：

```
 long start = PrivateBytes;
 // here is the code for an action which is expected to be memory-constant
 long difference= PrivateBytes-start;
 Console.WriteLine(difference); // or Assert(difference < MyLimit);

private static long PrivateBytes
    {
        get
        {                
            GC.Collect();
            GC.WaitForPendingFinalizers();
            GC.Collect();
            return Process.GetCurrentProcess().PrivateMemorySize64;
        }
    } 
```

我的问题是：为什么我会得到巨大的差异？（例如：一次运行 11 个月，下一次运行 33 个月）。这些变化是正常的还是我可以删除它们？

精度：我不是在寻找分析工具！（我已经用了一个！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T10:00:35.317

您可以尝试使用外部分析器，它们适合您查找应用程序中的内存泄漏和瓶颈的目的。依靠垃圾收集器调用和打印值并不像使用分析器那样准确。.NET 有很多，您可以在 Google 上搜索它们。只是引用一些：

来自微软[官方一](http://www.microsoft.com/downloads/details.aspx?familyid=86ce6052-d7f4-4aeb-9b7a-94635beebdda&displaylang=en)

给别人

[你的套件](http://www.yourkit.com/.net/profiler/index.jsp)

[内存分析器](http://memprofiler.com/download.aspx)

[JetBrains](http://www.jetbrains.com/profiler/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T10:00:47.627

PrivateBytes 是进程的内存占用。对于托管代码，您只在托管堆上分配空间。但是，操作系统对托管堆一无所知。对于 Windows，.NET 应用程序只是另一个进程。

但是，进程本身显然需要托管堆的内存。即运行时将使用标准操作系统调用分配内存段。如果可能，这些段会被重用，并且不一定会在垃圾收集后释放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T10:04:09.053

使用 GC.GetTotalMemory() 获取当前在托管堆上分配的估计字节数。

对于真正的内存泄漏检测，我建议您使用特殊的分析器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T10:01:29.277

您会发现内存泄漏本身只存在于您的 P/Invoke 代码中。.Net 中的“新”内存泄漏是死引用。.Net 中似乎是泄漏的大多数内存问题实际上都与持有对您不再使用的对象的引用有关，这意味着它永远不会被垃圾收集。

也要小心线程，我会提防你达到可以可靠地调用你指定的函数并保证所有对象现在都超出范围的地步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T10:13:05.413

我最近发现了这个用于捕获异常的工具，它是 beta 版，并且只在 XP 中使用。您可以使用它来了解应用程序的运行方式。阅读包装中的说明：

[ExcpHook 版本 0.0.5-rc2](http://gynvael.coldwind.pl/?id=148&lang=en)

和这个 ：

[.NET 的静态分析工具，Matt Berseth 的博客](http://msdn.microsoft.com/en-us/magazine/dd263071.aspx)

# java - 将 KeyEvent 发布到焦点组件

> ID：531720
> 
> 赞同：1
> 
> 时间：2009-02-10T09:54:00.747
> 
> 标签：java, swing, events

将 Button Press 发布到组件的最佳方式是什么？我尝试使用 Robot 类，它正常工作。但是，这个类在某些 Linux 平台下存在一些问题，所以我想知道将事件发布到组件的最佳纯 Java 方式是什么。

在这种特殊情况下，我想在按下按钮时将退格事件发布到 JTextField。

**编辑：毕竟我用过 Robot 类。我修复了阻止此类在 Linux 下正常工作的问题**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T11:15:24.990

您可以在此类中找到此类关键发布事件的[示例](http://www.koders.com/java/fid0A047C32296B5D1311C4B7D28D7A663F37068D02.aspx?s=backspace+dispatchEvent#L52)

这些帖子正在使用[dispatchEvent()](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Component.html#dispatchEvent%28java.awt.AWTEvent%29)函数

```
public void mousePressed(MouseEvent event) {
    KeyboardButton key = getKey(event.getX(), event.getY());

[...]

      KeyEvent ke;
      Component source = Component.getFocusComponent();
      lastPressed = key;
      lastSource = source;
      key.setPressed(true);

      if(source != null) {

        if((key == k_accent || key == k_circle) && (lastKey instanceof KeyboardButtonTextJapanese)) {
          int accent = ((KeyboardButtonTextJapanese)lastKey).getAccent();
          if(accent >= 1 && key == k_accent) {

            /*
            ** First send a backspace to delete the previous character, then send the character with the accent.
            */

            source.dispatchEvent(new KeyEvent(source, KeyEvent.KEY_PRESSED, System.currentTimeMillis(), 0, k_backspace.getKeyEvent(), k_backspace.getKeyChar()));
            source.dispatchEvent(new KeyEvent(source, KeyEvent.KEY_TYPED,   System.currentTimeMillis(), 0, k_backspace.getKeyEvent(), k_backspace.getKeyChar())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:57:26.800

我最终使用了机器人类，毕竟这是最简单的方法。问题是在我使用的特定 Linux 发行版中，Robot 类的实例化会挂起虚拟机。查看日志文件，我发现 java 试图加载一个不可用的 DLL：

libXi.so.6

将此库添加到发行版后，我能够继续

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T06:00:24.503

还有一种方法可以避免在机器人中中继：

```
import java.awt.*;
import java.awt.event.KeyEvent;
import javax.swing.*;

public class KeyEventTest
{
    public static void main(String[] args)
    {
        final JTextField textField = new JTextField(8);
        textField.setFont(textField.getFont().deriveFont(18f));
        JPanel panel = new JPanel(new GridBagLayout());
        panel.add(textField, new GridBagConstraints());
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.getContentPane().add(panel);
        f.setSize(300,160);
        f.setLocation(200,200);
        f.setVisible(true);
        new Thread(new Runnable()
        {
            public void run()
            {
                Toolkit toolkit = Toolkit.getDefaultToolkit();
                EventQueue queue = toolkit.getSystemEventQueue();
                try {
                    Thread.sleep(1500);
                } catch(InterruptedException ie) { }
                char newChar = 'x';
                queue.postEvent(new KeyEvent(textField,
                                             KeyEvent.KEY_TYPED,
                                             System.currentTimeMillis(),
                                             0,
                                             KeyEvent.VK_UNDEFINED,
                                             newChar));
                try {
                    Thread.sleep(1500);
                } catch(InterruptedException ie) { }
                queue.postEvent(new KeyEvent(textField,
                                             KeyEvent.KEY_PRESSED,
                                             System.currentTimeMillis(),
                                             0,
                                             KeyEvent.VK_BACK_SPACE,
                                             KeyEvent.CHAR_UNDEFINED));
            }
        }).start();
    }
} 
```

我必须警告你，如果组件失去焦点，生成的事件将会丢失！丁：

# c++ - 面向 C# 程序员的 C++

> ID：531722
> 
> 赞同：9
> 
> 时间：2009-02-10T09:54:23.960
> 
> 标签：c++, programming-languages

我对 java 和 C# 中的 OO 有很好的理解，我很幸运在我的工程课程中接触到了汇编程序和 C 的弊端（指针是我的游乐场：D）。

但是，我尝试过研究 C++，而让我感兴趣的是库代码。有很多很好的例子来说明如何在 java 和 C# 中执行基本任务，但是我无法找到一个很好的解释来说明如何在 C++ 中完成这些事情。

我很想将我的知识扩展到 C++ 以增加我的技能，但我没有机会接触到热衷于这些东西的人和社区。

这里有人可以推荐一些有用的开源项目或教程。如果涉及从 java 或 C# 进入此环境，则加分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T10:10:23.780

我建议您阅读优秀的 Andrew Koenig 和 Barbara Moo 的书籍“Accelerated C++”（经过[消毒的亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/020170353X)）。这本书教你 C++，而不是假设你知道 C，然后看看 C++ 的部分。

事实上，您在前面的章节中已经深入并正在使用 STL 容器。

强烈推荐。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T10:00:46.173

不幸的是，我没有任何此类资源可供您使用，因为我花了很长的时间慢慢发现事物。

不过，我确实有一个警告：请记住，在 C++ 世界中，标准库在提供有用服务方面非常缓慢。基本上，您会发现一些算法、数据结构、一些与字符串相关的类和一些与 I/O 相关的基本类。与 Java 或 .Net 不同，没有用于各种用途（网络、文件系统服务、密码学、并发等）的扩展类库——最接近的可能是[Boost](http://www.boost.org)，它看起来和感觉就像是对标准库，但它仍然是外部的（尽管它的某些部分正在泄漏回标准库）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T11:17:08.700

除了这里的其他答案，我认为你应该看看[QT](http://en.wikipedia.org/wiki/Qt_(toolkit))工具包。它不仅有 GUI 小部件，它还有库来处理诸如数据库、多线程和套接字之类的东西。

恕我直言，BOOST 和 QT 的组合为您提供了在 C++ 中解决您可能遇到的任何问题的工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T11:24:19.507

值得牢记的是，C++ 主要是一种系统编程语言。因此，它的主要重点不是执行基本任务，而是编写用于执行这些任务的工具。例如，C++ 不是提供开箱即用的数据库访问库，而是旨在用于编写数据库引擎本身。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T10:20:44.737

假设您已经对 C++ 语法有所了解，并且有良好的面向对象经验，我会选择[Effective c++](https://rads.stackoverflow.com/amzn/click/com/0321334876)系列。

它是一个“技巧和窍门”的集合，解释了 C++ 如何在后台工作。这是来自其他语言的人们的常见误解，以及为什么 c++ 以这种方式工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T15:58:13.173

这取决于你在什么平台上编程。C++ 本身没有 Java 或 C# 所拥有的那种库。这种功能传统上由操作系统提供。我建议你从一本书中学习 C++（我喜欢 Lippman 的 C++ Primer，但它针对初学者可能有点慢），如果你在 Windows 上编程，然后前往 MSDN。有用于网络、XML 解析、加密等几乎所有您需要的 API。它们只是与操作系统而不是语言本身相关联。

我不知道 Linux 或 Mac 的等效资源，但我确信有人可以提供它们。

# .net - 将 FixedPage 内容渲染到位图上

> ID：531747
> 
> 赞同：4
> 
> 时间：2009-02-10T10:03:22.783
> 
> 标签：.net, wpf, bitmap, render, fixedpage

我的以下代码取自[http://www.codeplex.com/XPS2Image/](http://www.codeplex.com/XPS2Image/)，而这些代码又取自 Microsoft Developer's Network 论坛上的讨论。

```
 int[] pages = new int[] { 0, 1, 2, 3, 4 };
        XpsDocument xpsDoc = new XpsDocument(@"c:\tmp\sample.xps", System.IO.FileAccess.Read);
        FixedDocumentSequence docSeq = xpsDoc.GetFixedDocumentSequence();

        // You can get the total page count from docSeq.PageCount

        foreach (int pageNum in pages)
        {
            DocumentPaginator paginator = docSeq.DocumentPaginator;
            DocumentPage docPage = paginator.GetPage(pageNum);
            BitmapImage bitmap = new BitmapImage();
            RenderTargetBitmap renderTarget =
                new RenderTargetBitmap((int)docPage.Size.Width,
                                        (int)docPage.Size.Height,
                                        96, // WPF (Avalon) units are 96dpi based

                                        96,
                                        System.Windows.Media.PixelFormats.Pbgra32);

            renderTarget.Render(docPage.Visual);

            PngBitmapEncoder encoder = new PngBitmapEncoder();  // Choose type here ie: JpegBitmapEncoder, etc

            encoder.Frames.Add(BitmapFrame.Create(renderTarget));

            FileStream pageOutStream = new FileStream("c:\\tmp\\xpsdocPage" + pageNum + ".jpg", FileMode.Create, FileAccess.Write);
            encoder.Save(pageOutStream);
            pageOutStream.Close();
        } 
```

这工作正常，除了未渲染`ResourceDictionaries`中使用的遥控器。`FixedPage`有任何想法吗？

# c# - 如何让禁用的 ToolStripButton 将其图像绘制成彩色？

> ID：531748
> 
> 赞同：1
> 
> 时间：2009-02-10T10:03:48.727
> 
> 标签：c#, .net, winforms, toolstripbutton

我们有一个允许用户“锁定”表单的按钮。不允许用户“解锁”表单，因此当按下时，我们希望禁用按钮，以便用户收到适当的视觉反馈。

但是，客户报告说灰色的“锁定”图标向他们表明表单未锁定，因此我们希望将按钮显示为按下状态，但图标为彩色，即使按钮被禁用。

我们如何做到这一点，以绝对最小数量的覆盖绘画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T10:19:34.787

您可以设置`ToolStripButton Image`为`BackgroundImage`
，然后设置`DiplayStyle`为`None`。

无论按钮`Enabled`值是多少，图片都应保持颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T10:23:29.583

其实我不同意这种做法。您的客户可能有一个有效的观点，但我认为他们没有正确的修复建议。您应该研究使表单显示为“锁定”的其他方法。更改边框或字体颜色，出现大挂锁图标或从打开变为关闭等。按钮看起来有一定的方式，因为这是用户所期望的。如果你有一个禁用的按钮，看起来它可能已启用，这会让用户感到困惑，他们可能不明白为什么他们不能点击它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-09T10:25:23.513

几周前我遇到过这种情况，这个问题没有答案，所以这是我 4 年后的解决方案：

在许多情况下，我使用此解决方案重新绘制 ToolStripButton：禁用、选中、选中

1.  覆盖 OnPaint 事件或更改 ToolStrip 的渲染器
2.  使用此方法绘制没有灰色滤镜的图像，只需在按钮上设置按钮的图像和图像的位置：http: [//msdn.microsoft.com/en-us/library/chas0s9c (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/chas0s9c(v=vs.110).aspx)

两个帮助我的好例子：

*   [http://tutorials.csharp-online.net/Tool,_Menu,_and_Status_Strips%E2%80%94Customizing_a_Renderer](http://tutorials.csharp-online.net/Tool,_Menu,_and_Status_Strips%E2%80%94Customizing_a_Renderer)

*   [http://jskiles1.wordpress.com/2009/08/22/33/](http://jskiles1.wordpress.com/2009/08/22/33/)）

工具条类：

```
ToolStrip ts = new ToolStrip();
//[...]
ts.RenderMode = ToolStripRenderMode.Professional; //Professional is just an example
ts.Renderer = new CustomRenderer(); 
```

自定义渲染器类：

```
public class CustomRenderer: ToolStripProfessionalRenderer
{
    protected override void OnRenderButtonBackground(ToolStripItemRenderEventArgs e)
    {
        if (!e.Item.Enabled) //in this case you will just have the image in your button, you need to add text etc in this if
        {
             //to draw the image
             Graphics g = e.Graphics;
             g.DrawImageUnscaled(e.Item.Image, new Point(2, 2)); //you need to specify the correct position
        }
        else //other cases
            base.OnRenderButtonBackground(e);
     }
} 
```

问题是要知道 ToolStripButton 中所有元素的正确位置，这就是我在每种情况下都绘制 ToolStripButton 的原因

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T10:23:57.350

另一种方式：根本不设置`button.Enabled = false`。只需设置`button.Checked = true`或`false`和当有人点击按钮测试`Checked`状态并做任何你做的事情。然后，该按钮将按照您的意愿运行并保持彩色。

# c# - C# 易失双

> ID：531759
> 
> 赞同：10
> 
> 时间：2009-02-10T10:10:36.900
> 
> 标签：c#, .net, volatile

因为只有引用类型和一些原语（包括浮点数，但不是双精度数，我不确定原因，我很高兴听到为什么）可以声明为易失性，如果我在一个类中包装一个双精度然后声明它作为易失性（如下），双重属性是否像任何其他易失性一样是“读写”线程安全的，还是我仍然应该关注锁定？

```
public class MyThreadedClass
{
    volatile VolatileDouble voldub;
}

public class VolatileDouble
{
    public double Double { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T10:15:10.477

不能将 double 声明为 volatile 的原因：它是 64 位，这使得它超过了 x86 上的字长，如果我没记错的话，这可以防止它在 CLI 中被声明为 volatile。

根据您当前的答案，只有*参考*被视为易失性。这意味着内存模型将确保它始终使用最新的引用，但它仍然可以使用陈旧的值。

如果我是你，我会选择锁定，但另一种选择是使用[`Interlocked.Read`](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.read.aspx)和[`Interlocked.Exchange`](http://msdn.microsoft.com/en-us/library/dk0121zy.aspx)作用于多头，与[`BitConverter.Int64BitsToDouble`](http://msdn.microsoft.com/en-us/library/system.bitconverter.int64bitstodouble.aspx)and结合使用[`BitConverter.DoubleToInt64Bits`](http://msdn.microsoft.com/en-us/library/system.bitconverter.doubletoint64bits.aspx)。您可以将其封装在一个`VolatileDouble`结构中。（我可能会把它变成一个结构而不是一个类。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T10:15:35.703

要像上面那样工作，你需要让它不可变（没有设置器）——为了方便起见，可能使用一些隐式转换运算符。否则，人们可以在不更改（易失性）引用的情况下更改值。

```
public class MyThreadedClass
{
    volatile Box<double> volDouble = 123.45;
}

public class Box<T> where T : struct
{
    private readonly T value;
    public Box(T value) { this.value = value; }
    public T Value {get {return value;}}

    // explicit as nulls are a problem...
    public static explicit operator T(Box<T> box) {
        return box.value; }
    public static implicit operator T?(Box<T> box) {
        return box == null ? new T?() : new T?(box.value); }
    public static implicit operator Box<T>(T value) {
        return new Box<T>(value); }
    public static implicit operator Box<T>(T? value) {
        return value.HasValue ? new Box<T>(value.Value) : null; }
} 
```

除此之外 - 锁定将是最好的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T10:15:38.917

您只是声明引用是 volatile 而不是实例，所以这不会解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T11:26:53.073

不稳定的文档有些误导...

当 msdn 文档说它使用最新值时，这是什么意思？？？我敢肯定，在一个简单的值中，这不会导致混淆，但是引用呢，就像 Brian Rasmussen 一样，您只是在谈论 ref 而不是实际实例（因此是有趣的数据）。

从我的角度来看，使用 volatile 不是一个好主意，我会去锁定，无论如何这篇文章可能会帮助你： http: [//www.bluebytesoftware.com/blog/PermaLink,guid,dd3aff8a-7f8d-4de6- a2e7-d199662b68f4.aspx](http://www.bluebytesoftware.com/blog/PermaLink,guid,dd3aff8a-7f8d-4de6-a2e7-d199662b68f4.aspx)

# css - CSS 特殊性和在紧迫的截止日期后规范化您的样式表

> ID：531760
> 
> 赞同：1
> 
> 时间：2009-02-10T10:10:37.430
> 
> 标签：css, normalization

我刚刚完成了一个重量级的长销售页面，页面上有很多元素和不同的样式。CSS 的选择器最终变得过于具体，并且有许多圆角框、背景图像等。简而言之， CSS有点乱。（只能怪我自己！）

任何人都可以建议一种有条不紊地浏览此样式表的方法，以结合我的重复属性等吗？我怀疑是否有任何工具可以为我做到这一点，但我想知道其他人如何处理这种情况？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T10:23:05.513

1.  如果可能，将 CSS 与其速记属性结合起来。
2.  利用唯一的 dom id 将样式应用于该元素的子元素。
3.  您可以在同一个元素上使用多个 CSS 类，例如 class="somestyle some-other-style"。使用它，您可以采用重复的 CSS 样式并将它们定义为一个。
4.  使用 * 选择器将样式应用于所有子项。
5.  如果它全部在一个大 CSS 文件中，请将代码拆分为样式与您网站上的页面相关的部分，即 /* MEMBERS PAGE */
6.  通过在线压缩器运行样式以减少代码大小。有些甚至会自动为您组合元素，从而进一步降低复杂性。

那应该让你开始。很难进一步添加，这实际上取决于您的 html 代码和结构的设置方式。如果你能提供一个想法，我们可以提供进一步的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T10:25:08.877

事实上，有一些[CSS 重构工具](https://stackoverflow.com/questions/449145/css-refactoring-tool)，在 SO 上被很好地介绍了。

不过，我不能保证它们，因为我总是手动重构。我的技术是将现有样式分为：

*   布局
*   排版
*   颜色（外观和感觉）
*   黑客

这通常是一个快速的复制和粘贴工作。从那里开始，相似性和冗余更加明显，因此组合和简化变得更加容易。

完成后，在页面顶部有一个目录可以让你的部分很容易找到，并且通常更容易搜索。

# sharepoint - 如何在您的自定义列表中启用“连接到 Outlook”功能？

> ID：531766
> 
> 赞同：3
> 
> 时间：2009-02-10T10:12:56.287
> 
> 标签：sharepoint, outlook, synchronization

如何启用将自定义列表与 Outlook 2007 待办事项或日历列表同步的功能？我认为自定义列表也可以，但我找不到任何文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T07:40:24.250

据我所知，这是不可能的。如果您需要同步待办事项列表，请创建任务列表。然后，您可以删除所有您不感兴趣的列，并添加您想要使用的任何列。

日历也是如此，如果您想要一个与 Outlook 日历同步的列表，则创建一个日历列表并根据您的需要对其进行自定义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-02-29T18:41:50.887

扩展菲利普的好答案。. .

根据这篇[MSDN 帖子](http://blogs.msdn.com/b/syedi/archive/2008/08/30/connect-to-outlook-feature-is-missing-in-the-calendar-of-custom-calendar-list-definition.aspx)，自定义列表模板与任务模板（上面文章中的 106，我对 SP2010 的研究中的 107）具有不同的类型名称（100）。这是 UI 查看禁用 Outlook 同步按钮的内容。因此，如果您的自定义列表基于您创建的自定义内容类型，那么您可以重新创建您的列表以与 Outlook 兼容。

1.  如果您的列表已包含数据，请将其导出到 Excel
2.  基于任务模板（而不是自定义）创建一个新列表
3.  添加您的 CT 并删除任务 CT（如果您的内容类型基于任务 CT，即具有列）以及您的列表不需要的任何其他内容
4.  添加您的列表需要但可能不属于您的 CT 的任何其他列（或者如果您不使用自定义 CT）
5.  使用数据表视图将数据复制并粘贴到新列表中（观察列顺序）

注意事项：并非所有数据列都可以使用此方法复制（例如附件、系统字段等）

希望这有助于澄清

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-25T13:47:01.990

这是可用的/可能的（需要一些编程来实现它） - 见[这里](https://stackoverflow.com/questions/1231725/sync-list-with-outlook-only-with-items-in-current-view/1477355#1477355)。

对于我的解决方案，我在站点之间汇总数据并将它们与 Outlook 同步。有一些棘手的事情，比如将项目的 uniqueId 映射到整数 ID（可能是具有映射的数据库表）以正确引用特定项目，但这并非不可能。

但这不是您可以立即使用的东西 - 需要编码。但是，如果您真的，真的需要它，那么它是一条路要走。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-11T02:51:43.397

如果您的自定义列表基于共享点列表，则可以通过生成基于 stssync 协议格式化的链接将其连接到 Outlook。

我根据事件（日历）列表创建了一个自定义列表定义。

它使用基本日历列表模板以及一些自定义字段和表单。

我创建了一个按照stssync协议格式化的链接，并与outlook连接成功：

stssync://sts/?ver=1.1&type=calendar&cmd=add-folder&base-url=[站点 url]&list-url=[您的列表 url]&guid=[列表的 GUID]&site-name=[SiteName]&list-name =[列表名称]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T16:26:17.387

是的，可悲的是不可能。此外，如果您在任务列表或日历中创建自定义列，Outlook 将不会同步这些列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-23T15:31:32.463

我一直在努力解决同样的问题，发现无法使用 SharePoint 的内置功能来完成，但是有一个 3rd 方程序可以做到这一点。您可以尝试使用 ProperSync。它将允许您从 SharePoint 连接自定义列表的自定义字段，并使用 Outlook 查看和编辑它们。

这是主站点的链接：http: [//propersync.com/default.aspx](http://propersync.com/default.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-17T09:39:17.360

您可以覆盖包含同步逻辑的列表功能区按钮，并在其上创建自定义操作。

这是关于创建功能区的好文章：http: [//blogs.msdn.com/b/sharepointdeveloperdocs/archive/2009/12/07/sharepointfoundationhowtoaddtabtoribbon.aspx](http://blogs.msdn.com/b/sharepointdeveloperdocs/archive/2009/12/07/sharepointfoundationhowtoaddtabtoribbon.aspx)

对于列表视图 OutlookSyncButton，您应该在 CommandUIDefinition 中指定 Location="Ribbon.List.Actions.ConnectToClient"。对于日历视图 - 您应该指定 Location="Ribbon.Calendar.Calendar.Actions.ConnectToClient"。

现在，在 CommandUIHandler/CommandAction 中指定连接到 Outlook 的 JS 代码（我只是从 SP 中获取 :)）：

```
alert("Let's go!");

var listid = '{ListId}';           
var list;

ExecuteOrDelayUntilScriptLoaded(GetParamsAndSync, 'sp.js');

function GetParamsAndSync()
{
  var clientContext = new SP.ClientContext.get_current();
  var web = clientContext.get_web();
  list = web.get_lists().getById(listid);
  clientContext.load(list);
  clientContext.load(web);

  rf = list.get_rootFolder()
  clientContext.load(rf);

  clientContext.executeQueryAsync(
   function() {
      viewUrl=rf.get_serverRelativeUrl();
      ExportHailStormOverride('calendar','{SiteUrl}','{ListId}', web.get_title(),list.get_title(),viewUrl,viewUrl,'')
    }, 
    function() {alert('Error')});
}

//This function was taken from SharePoint sp.init.js
function  ExportHailStormOverride(type,weburl,guid,webname,listname,viewurl,passport,listrooturl,folderurl,folderid)
{ULSA13:;
    var strAppName=GetCookie('stsSyncAppName');
    var strIconName=GetCookie('stsSyncIconPath');
    var maxLinkLength=500;
    var maxNameLength=20;
    var link='stssync://sts/?ver=1.1'
            +'&amp;type='+escapeProperly(type)
            +'&amp;cmd=add-folder'
            +'&amp;base-url='+escapeForSync(weburl)
            +'&amp;list-url='+escapeForSync('/' 
            + makeAbsUrl(viewurl).substr(weburl.length+1)+'/')
            +'&amp;guid='+escapeProperly(guid);
    if (window.self.offlineBtnUser !=undefined)
        link+='&amp;user-id='+offlineBtnUser;
    var names='&amp;site-name='+escapeForSync(webname)
            +'&amp;list-name='+escapeForSync(listname);
    var context='';
    if (folderurl)
        context+='&amp;folder-url='
             + escapeForSync('/'+folderurl.substr(listrooturl.length+1));
    if (folderid)
        context+='&amp;folder-id='+folderid;
    if (link.length+names.length+context.length > maxLinkLength &amp;&amp;
        (webname.length > maxNameLength || listname.length > maxNameLength))
    {
        if (webname.length > maxNameLength)
            webname=webname.substring(0, maxNameLength-1)+'...';
        if (listname.length > maxNameLength)
            listname=listname.substring(0, maxNameLength-1)+'...';
        names='&amp;site-name='+escapeForSync(webname)
             +'&amp;list-name='+escapeForSync(listname);
    }
    link=link+names+context;
    var L_StssyncTooLong_Text='The name of site or list is too long. Make it shorter.';
    if (link.length > maxLinkLength)
        alert(L_StssyncTooLong_Text);
    else
    {
        try
        {
            window.location.href=link;

        }
        catch (e)
        {
            alert('Sync error.');
        }
    }
} 
```

# asp.net - 帮助 DataGrid/CheckBoxes/双重提交

> ID：531768
> 
> 赞同：0
> 
> 时间：2009-02-10T10:13:12.587
> 
> 标签：asp.net, vb.net, datagrid, checkbox, double-submit-prevention

我们有一个简单的数据网格。每行都有一个复选框。复选框设置为自动回发，并且代码隐藏具有复选框选中更改事件的事件处理程序。这一切都按预期工作，没有什么复杂的。

但是，我们希望在选中复选框后立即禁用复选框以防止重复提交，即选中复选框，通过客户端 javascript 禁用所有复选框，提交表单。

为了实现这一点，我们将一些代码注入到 onclick 事件中，如下所示（请注意，警报仅用于测试！）：

```
Protected Sub DgAccounts_ItemCreated(ByVal sender As System.Object, ByVal e As System.Web.UI.WebControls.DataGridItemEventArgs) Handles DgAccounts.ItemCreated
    If e.Item.ItemType = ListItemType.Item Or e.Item.ItemType = ListItemType.AlternatingItem Then
        Dim chk As CheckBox = CType(e.Item.FindControl("chkItemChecked"), CheckBox)            
        chk.Attributes.Add("onclick", "alert('fired ...');DisableAllDataGridCheckBoxes();")
    End If
End Sub 
```

在检查渲染页面的来源时，我们得到以下信息：

```
<input id="DgAccounts__ctl2_chkItemChecked" type="checkbox" name="DgAccounts:_ctl2:chkItemChecked" onclick="alert('fired ...');DisableAllDataGridCheckBoxes();setTimeout('__doPostBack(\'DgAccounts$_ctl2$chkItemChecked\',\'\')', 0)" language="javascript" /> 
```

这一切都按顺序显示，但是服务器端事件不会触发 - 我相信这是由于复选框被禁用，就好像我们只是将警报留在其中并删除禁用复选框的调用它一切正常。

即使复选框被禁用，我是否可以强制触发 check-changed 事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T10:56:13.163

我自己没有对此进行测试，但是当您调用“DisableAllDataGridCheckBoxes”方法时，是否需要禁用已选中的复选框？如果没有，您可以传递调用复选框的 id，然后只禁用所有其他复选框。

```
chk.Attributes.Add("onclick", "alert('fired ...');DisableAllDataGridCheckBoxes(" + chk.ClientId + ");") 
```

我认为这将允许服务器端代码触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T11:53:20.390

服务器端事件未触发的原因是禁用的复选框不会与表单的其余部分一起提交。

我使用的解决方法是将复选框的 onclick 事件设置为 null 而不是禁用它们 - 虽然这不会为用户提供后续点击被忽略的视觉线索，但它确实阻止了双重提交，并且复选框被设置为顶部呈现响应时的正确状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T11:27:08.913

不要禁用复选框（然后不会提交），只需“阻止”它们被选中。通过更改其 onclick 处理程序以重置选中状态来执行此操作。您可以将所有其他复选框设置为禁用，并仅为正在处理的复选框执行此操作。就像是：

```
function stopChanges(cbCurrent) {
   $('INPUT[type=checkbox]').disable(); // disable all checkboxes

   $(cbCurrent)
       .disable(false) // enable this checkbox, so it's part of form submit
       .click(function() {
           // reset to previous checked - effectively preventing change
           $(this).checked = !$(this).checked; 
       }
   );
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T11:08:18.377

一种可能的解决方法是在数据网格的 RowCommand 的服务器端代码中执行所有这些操作。

（在 C# 中发布示例，但我希望在 VB 中不会有太大不同）

```
protected void myGrid_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if(((CheckBox)e.Item.FindControl("chkItemChecked")).Checked)
    {
        foreach(GridViewRow dvRow in myGrid.Rows)
             ((CheckBox)dvRow.FindControl("chkItemChecked")).Enabled = false;
   }
} 
```

或者你可以使用

```
((CheckBox)e.Item.FindControl("chkItemChecked")).Enabled = false; 
```

如果您只想禁用特定项目。

但是，如果您只想在客户端代码中实现这一点，那将无济于事。

# asp.net - CollapsiblePanelExtender 在初始页面加载时不会一直打开

> ID：531769
> 
> 赞同：4
> 
> 时间：2009-02-10T10:13:33.197
> 
> 标签：asp.net, .net-2.0, ajaxcontroltoolkit, collapsiblepanelextender

我正在使用 AjaxControlToolkit 中的 CollapsiblePanelExtender，当我单击它时它工作正常，但它不会在初始页面加载时一直扩展（扩展约 90%）。

我必须折叠它并手动展开它才能完全打开。

我没有设置 ExpandedSize 属性，因为面板内容是动态的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T16:47:08.050

在扩展器的目标上使用以下样式：

```
.collapsiblePanelContainer {
  height: 0;
  overflow: hidden;
} 
```

CollapsiblePanelExtender 将负责其余的工作。

Joe Stagner 在[CollapsiblePanelExtender 视频](http://www.asp.net/learn/ajax-videos/video-89.aspx)中提到了这个技巧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T02:50:01.317

如果可折叠面板中的数据是固定的，不需要调用页面回发，请将 CollapsiblePanelExtender 的“SuppressPostBack”属性设置为 true。这将使展开动作能够更快、更顺利地完成。你不会注意到延迟。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-10T10:21:17.840

尝试在实际面板的样式中设置“最小高度”的值。否则，您可以在 PreRender 事件中以编程方式设置高度或 ExpandSize

```
protected override void OnPreRender(EventArgs e)
{
    base.OnPreRender(e);
    // Set the size here
    myCollapsiblePanelExtender.ExpandedSize = sizeValue;
} 
```

# c# - WCF 内存性能实例上下文模式

> ID：531770
> 
> 赞同：0
> 
> 时间：2009-02-10T10:13:40.123
> 
> 标签：c#, .net, performance

我一直在学习有关 WCF 的方法，并且我有一个关于 InstanceContextMode 的问题。

如果我错了，请纠正我，但 WCF 将实例化您的对象，然后默认情况下在每次调用时调用它的服务方法。

然后，您可以将其设置为 PerSession 或 Single。

在我看来，在 session 和 call 之间有一些可以重用你的对象的东西会更有意义。即，如果我的服务是可重入的，那么我可以在构造函数中打开与数据库等的连接，然后将对象留在内存中以同时响应调用。

但是在当前的 WCF 实现中，似乎无论如何它都会重新创建对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T10:22:53.360

这里的样本

[http://msdn.microsoft.com/en-us/library/aa967565.aspx](http://msdn.microsoft.com/en-us/library/aa967565.aspx)

展示如何使用可扩展性对实例的创建和销毁方式进行更细粒度的控制（例如池化）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T20:45:38.637

即使在使用 PerCall 实例模式时，如果它们是静态的，您仍然可以重用繁重的数据结构。请记住，静态对象将具有 appdomain 的生命周期，因此假设您初始化了一个静态对象（这需要昂贵的操作），每个调用实例对其他 WCF 也是可见的，并且在 appdomain 被销毁之前将保持活动状态（ appdomain 的生命周期取决于您的服务器设置）。

小心处理同步问题，并且不要在这个静态类中包含您不想在所有每次调用实例之间共享的任何信息。

我的 0.02 美元

# java - 请告诉我我在这个jsp程序中哪里出错了

> ID：531776
> 
> 赞同：0
> 
> 时间：2009-02-10T10:15:35.733
> 
> 标签：java, debugging, jsp

```
<%@ page import="java.io.*" %>
<%-- <%@ page contentType="text/html;charset=ISO-8859-1" %> --%>
<%
int iLf = 10;
char cLf = (char)iLf;
File outputFile = new File(generate.xml);
outputFile.createNewFile();
FileWriter outfile = new FileWriter(outputFile);
outfile.write(" <?xml version='1.0' encoding='UTF-8'?> "+cLf);
outfile.write(" <playlist version='1' xmlns = 'http://xspf.org/ns/0/' > " +cLf);
outfile.write(" <title>My Band Rocks Your Socks</title> "+cLf); 
outfile.write("<trackList>"+cLf); 
%>
 <%! String[] sports; %>
 <%
    sports = request.getParameterValues("sports");
    if (sports != null)
    { 
         for (int i = 0; i < sports.length; i++)
         { 
              // outfile.writeln (sports[i]); 
              String total=sports[i];
              String[] sa=total.split("[,]");
              // String[] sub=new String();
              outfile.write("<track>"+cLf);
              for (int j=0;j<sa.length;j++)
              {
                // outfile.writeln(sa[j]);
                // outfile.writeln("sa["+j+"]="+sa[j]);
                if( j == 0)
                {
                     outfile.write("<location>" + sa[0] +"</location>"+cLf); 
                }
                else if (j == 1)
                     {
                        outfile.write("<image>" + sa[1] +"</image>"+cLf); 
                     }
                     else if( j==2)
                          {
                            outfile.write("<title>" + sa[2] +"</title>"+cLf);
                          }

               }// end of inner for loop()       
               outfile.write("</track>"+cLf);
         //outfile.writeln();
      }// end of outer for()
    } 
    //else outfile.writeln ("<b>none<b>");

  outfile.write(" </trackList> "+cLf);
  outfile.write(" </playlist> "+cLf);
  outfile.close();

  %> 
```

## 抛出的异常是

```
An error occurred at line: 7 in the jsp file: /sports3.jsp
generate.xml cannot be resolved to a type
4: <%
5: int iLf = 10;
6: char cLf = (char)iLf;
7: File outputFile = new File(generate.xml);
8: outputFile.createNewFile();
9: FileWriter outfile = new FileWriter(outputFile);
10: outfile.write(" <?xml version='1.0' encoding='UTF-8'?> "+cLf); 
```

* * *

请告诉我如何纠正。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T10:18:03.933

我会说罪魁祸首是

```
File outputFile = new File( generate.xml ); 
```

我怀疑您可能希望将该字符串包含在引号 ("") 中，否则它将被视为标识符，运行时将对此一无所知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T10:18:15.383

```
File outputFile = new File(generate.xml); 
```

我猜 generate.xml 应该在双引号内，至少那是我的两分钱。

说真的，请格式化您的代码，使其看起来更好，否则它太难阅读了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T10:20:09.623

哇，这简直无法阅读！

有罪的线是

```
File outputFile = new File(generate.xml); 
```

假设 generate.xml 是文件名，你需要引用它，因为它是一个字符串

```
File outputFile = new File("generate.xml"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T10:20:37.890

generate.xml 需要用引号引起来。它不会将其视为字符串，它认为您的意思是有一个名为“generate”的对象具有“xml”属性。

# java - 将字符串与空字符串进行比较（Java）

> ID：531779
> 
> 赞同：39
> 
> 时间：2009-02-10T10:16:51.440
> 
> 标签：java, string, comparison, string-comparison

我有一个关于将字符串与 Java 中的空字符串进行比较的问题。`==`如果我将字符串与空字符串与or进行比较，是否有区别`equals`？例如：

```
String s1 = "hi";

if (s1 == "") 
```

或者

```
if (s1.equals("")) 
```

我知道应该将字符串（和一般的对象）与`equals`和 not进行比较`==`，但我想知道它是否对空字符串很重要。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-10T10:51:51.940

```
s1 == "" 
```

不可靠，因为它测试引用相等而不是对象相等（并且 String 不是严格规范的）。

```
s1.equals("") 
```

更好，但可能会遭受空指针异常的影响。更好的是：

```
"".equals(s1) 
```

没有空指针异常。

**编辑：**好的，关于[规范形式](http://en.wikipedia.org/wiki/Canonical_form)的问题。本文将其定义为：

> 假设我们有一些具有等价关系的对象集合 S。通过将 S 的一些对象指定为“规范形式”来给出规范形式，使得所考虑的每个对象都恰好等价于规范形式的一个对象。

给你一个实际的例子：取一组有理数（或“分数”，它们通常被称为）。有理数由分子和分母（除数）组成，两者都是整数。这些有理数是等价的：

3/2、6/4、24/16

有理数通常写成 gcd（最大公约数）为 1。所以它们都将简化为 3/2。3/2 可以看作是这组有理数的**规范形式。**

那么当使用术语“规范形式”时，它在编程中意味着什么？这可能意味着几件事。以这个虚构的类为例：

```
public class MyInt {
  private final int number;

  public MyInt(int number) { this.number = number; }
  public int hashCode() { return number; }
} 
```

MyInt 类的哈希码是该类的规范形式，因为对于 MyInt 的所有实例的集合，您可以取任意两个元素 m1 和 m2，它们将遵循以下关系：

```
m1.equals(m2) == (m1.hashCode() == m2.hashCode()) 
```

这种关系是规范形式的本质。出现这种情况的一种更常见的方式是当您在类上使用工厂方法时，例如：

```
public class MyClass {
  private MyClass() { }

  public MyClass getInstance(...) { ... }
} 
```

实例不能直接实例化，因为构造函数是私有的。这只是一种工厂方法。工厂方法允许您执行的操作如下：

*   总是返回相同的实例（抽象单例）；
*   每次调用都创建一个新实例；
*   **以规范形式**返回对象（稍后会详细介绍）；或者
*   随你喜欢。

基本上，工厂方法抽象了对象的创建，我个人认为强制所有构造函数为私有以强制使用这种模式将是一个有趣的语言特性，但我离题了。

您可以使用此工厂方法执行的操作是缓存您创建的实例，以便对于任何两个实例 s1 和 s2，它们都遵循以下测试：

```
(s1 == s2) == s1.equals(s2) 
```

因此，当我说 String 不是严格规范时，这意味着：

```
String s1 = "blah";
String s2 = "blah";
System.out.println(s1 == s2); // true 
```

但是正如其他人指出的那样，您可以使用以下方法更改此设置：

```
String s3 = new String("blah"); 
```

并且可能：

```
String s4 = String.intern("blah"); 
```

所以你不能完全依赖引用相等，所以你根本不应该依赖它。

作为对上述模式的警告，我应该指出，使用私有构造函数和工厂方法控制对象创建并不能保证引用相等意味着对象相等，因为序列化。序列化绕过了正常的对象创建机制。Josh Bloch 在 Effective Java 中介绍了这个主题（最初是在第一版中，当时他谈到了类型安全枚举模式，后来成为 Java 5 中的一种语言特性），您可以通过重载（私有）readResolve() 方法来绕过它。但这很棘手。类加载器也会影响这个问题。

无论如何，这是规范的形式。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-10T10:20:01.837

这将取决于字符串是否为文字。如果您使用创建字符串

```
new String("") 
```

那么它永远不会匹配“”与等号运算符，如下所示：

```
 String one = "";
    String two = new String("");
    System.out.println("one == \"\": " + (one == ""));
    System.out.println("one.equals(\"\"): " + one.equals(""));
    System.out.println("two == \"\": " + (two == ""));
    System.out.println("two.equals(\"\"): " + two.equals("")); 
```

--

```
one == "": true
one.equals(""): true
two == "": false
two.equals(""): true 
```

基本上，您希望始终使用 equals()

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-05-21T15:17:14.033

**简短的回答**

```
s1 == ""         // No!
s1.equals("")    // Ok
s1.isEmpty()     // Ok: fast (from Java 1.6) 
"".equals(s1)    // Ok: null safe 
```

我会保证 s1 不为空并使用 isEmpty()。

注意：空字符串“”不是特殊的字符串，而是算作任何其他“值”。

**再长一点的答案**

对 String 对象的引用取决于它们的创建方式：

**使用操作符new**创建的字符串对象总是引用单独的对象，即使它们存储相同的字符序列，所以：

```
String s1 = new String("");
String s2 = new String("");
s1 == s2 // false 
```

使用操作符 = 创建的字符串对象后跟一个用双引号括起来的值 ( **= "value"** ) 存储在字符串对象池中：在池中创建新对象之前，会在池中搜索具有相同值的对象并在找到时引用。

```
String s1 = ""; // "" added to the pool
String s2 = ""; // found "" in the pool, s2 will reference the same object of s1
s1 == s2        // true 
```

对于用双引号 ("value") 括起来的值创建的字符串也是如此，因此：

```
String s1 = "";  
s1 == "";        //true 
```

String equals 方法检查两者，这就是编写安全的原因：

```
s1.equals(""); 
```

如果 s1 == null，此表达式可能会抛出 NullPointerException，因此，如果您之前不检查 null，则编写起来更安全：

```
"".equals(s1); 
```

另请阅读[如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

希望它可以帮助没有经验的用户，他们可能会发现其他答案有点太复杂了。:)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-10T18:39:45.560

这与你原来的问题有点偏离，但总有

```
if(s1.length() == 0) 
```

我相信这相当于 1.6 中的 isEmpty() 方法。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-10T10:54:32.310

```
"".equals(s) 
```

似乎是最好的选择，但也`Stringutils.isEmpty(s)`包含在 Apache commons lang 库中

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-10T10:23:24.623

一个字符串，就是一个字符串，就是一个字符串，不管它是不是空字符串。使用`equals()`.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-12-21T10:36:04.530

如果需要空检查，请使用[String.isEmpty()](http://download.oracle.com/javase/6/docs/api/java/lang/String.html#isEmpty%28%29)或[StringUtils.isEmpty(String str) 。](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#isEmpty%28java.lang.String%29)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T01:26:53.227

给定两个字符串：

```
String s1 = "abc";
String s2 = "abc"; 
```

-或者 -

```
String s1 = new String("abc");
String s2 = new String("abc"); 
```

对两个 Object 执行的 == 运算符检查对象身份（如果两个运算符返回同一个对象实例，则返回 true。）应用于 java.lang.Strings 的 == 的实际行为并不总是一致的，因为字符串实习。

在 Java 中，字符串是[被实习](http://en.wikipedia.org/wiki/String_interning)的（至少部分由 JVM 决定）。在任何时间点，s1 和 s2 可能会或可能不会被实习成相同的对象引用（假设它们具有相同的值。）因此`s1 == s2`可能会或可能不会返回 true，这仅取决于 s1 和 s2 是否都已被实习。

使 s1 和 s2 等于空字符串对此没有影响 - 它们可能仍然或可能没有被拘留。

简而言之，如果 s1 和 s2 具有相同的内容， == 可能会或可能不会返回 true。如果 s1 和 s2 具有相同的内容，则 s1.equals(s2) 保证返回 true。

# batch-file - 批处理文件的问题

> ID：531780
> 
> 赞同：0
> 
> 时间：2009-02-10T10:17:02.873
> 
> 标签：batch-file, uninstallation, subdirectory

我创建了一个批处理文件来卸载我的应用程序。我的问题是，因此，此卸载删除了一些文件但保留了其他文件。

例如，我在`C:\\Documents and settings\User-Name\myCompanyName\My Application name\` 此文件夹中创建了一个文件夹，其中包含我的应用程序的所有文件。现在当我卸载时，所有这些文件都被删除了。但我也想从“C:\Documents and settings\User-Name”中删除“myCompanyName”文件夹

与前一个问题相关的另一个问题是我在开始菜单中添加了一个新文件夹，名为`myComapny`它包含 4 个文件：

1.  exe文件
2.  配置文件
3.  帮助文件，以及
4.  卸载文件

当我单击卸载文件时，它会删除所有内容，但**仍将文件夹保留**在开始菜单中，其中包含我刚刚列出的四个文件。

如何通过**批处理文件**删除不需要的文件夹？

这是我的批处理文件代码：

```
 @echo off
   msiexec /x {DD75996F-C279-420A-9A19-48EF9EFE70C2} 

   RD /s "C:\Program Files\ASGATech"
   RD /s "C:\Documents and Settings\%userprofile%\start menu\programs\ASGATech"
   pause 
```

注意：我尝试将批处理文件的扩展名从 更改`bat`为`cmd` 我还尝试让当前登录用户 %userprofile% 进入他/她的开始菜单。如果这种方式是错误的，请告知我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T10:26:19.763

删除 C:\Documents and Settings - 这已经在 %userprofile% 标记中。

`RD /s "%userprofile%\start menu\programs\ASGATech"`

# html - 通过 html 框架渲染远程内容！

> ID：531783
> 
> 赞同：0
> 
> 时间：2009-02-10T10:18:36.850
> 
> 标签：html

我想使用 html 'frame' 显示远程内容。假设我想在框架上显示 www.news.google.com 的内容......怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T10:21:14.440

W3Schools 有一个[解释](http://www.w3schools.com/TAGS/tag_iframe.asp)`<iframe>`标签基础知识的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T00:41:08.093

```
<iframe src="http://news.google.com" height="500" width="500">
text here if iframe is unable to display
</iframe> 
```

相应地更改大小值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T00:38:01.940

将或的`src`属性设置为要从中显示内容的 URL。`<iframe>``<frame>`

# javascript - 自动下载的优雅解决方案

> ID：531786
> 
> 赞同：2
> 
> 时间：2009-02-10T10:19:39.810
> 
> 标签：javascript, html, pdf, download, meta-tags

我目前正在使用 meta http-equiv='Refresh' 来自动开始 PDF 下载。但是，这对每个浏览器都有不同的影响。

主要问题是 IE（6 和 7）一旦用户被重定向到 PDF，如果用户单击后退按钮，他们将被发送回启动下载的页面，然后立即再次重定向到 PDF。

Windows 上的 Firefox 效果更好，但仍不完美，用户进入下载页面并被重定向到 PDF。但是，如果他们使用后退按钮，则会完全错过下载页面。

目前 Linux 上的 Firefox 具有我想要的确切效果。因为下载页面会将您重定向到 PDF，而 PDF 中的后退按钮会将您发送回下载页面，然后您就可以停留在那里。

我尝试使用 javascript setTimeout() 函数来延迟 PDF 的弹出窗口，但是延迟似乎在任何浏览器中都不起作用，并且弹出窗口似乎在 IE7 中不起作用。

有没有人为我可以使用的问题实施了一个优雅的解决方案？

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T10:59:09.693

## 推荐人

您可以检查推荐人：

```
if (document.referrer != "http://homepage.com/file.pdf") {
    // go to the file
} 
```

它有点复杂，因为您必须与引用者的绝对 URL 进行比较，但这应该不是问题。

## 饼干

您可以在第一次进入下载页面时设置 cookie。如果设置了 cookie（对于每个文件 cookie 中的另一个条目），那么您不应该重定向。

一个缺点是，如果有人重新加载页面（因为他想再次查看该文件），他将无法再访问该文件。围绕它有一些可能性：

*   在 cookie 中设置一个过期的时间戳。
*   添加指向用户可以手动单击的页面的链接。

设置/获取 cookie：

```
if (document.cookie && document.cookie == "I was here!") {
    alert(document.cookie);
} else { // set a cookie
    document.cookie = "I was here!";
} 
```

Javascript 可以像这样重定向：

```
window.location.href = "http://www.google.com"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T13:09:55.420

使用 javascript 弹出窗口

这样，当用户访问 pdf 时，它位于不同的浏览器中，您可以将其关闭。完成此操作后，您可以继续浏览该站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T14:13:44.223

如果我理解你需要正确，你想做*类似*文件共享行为的事情：用户等待几秒钟的计数器，超时后你将他重定向到开始下载的页面。

也许您应该简单地*显示*下载页面的链接而不是重定向？此页面应发送标题“强制下载”以避免浏览器在其上导航。如果有人会尝试直接访问此页面——检查引荐来源网址或标题或您可以想象的任何其他保护（如动态链接），也许您已经有了。

这个解决方案可以让你避免 JS 魔法，并且应该让你的代码跨浏览器没有麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-09T18:32:47.217

您可以通过 javascript 将 iframe 添加到 DOM，并将 src 设置为您要下载的 url。浏览器根本不会改变页面，下载只会开始。它可以使用 CSS 隐藏，用户甚至不会知道它的存在。

# vb.net - Microsoft Reporting：检查某个值是否存在

> ID：531787
> 
> 赞同：1
> 
> 时间：2009-02-10T10:19:39.857
> 
> 标签：vb.net, reporting-services

使用 Microsoft Reporting Services，具有本地处理模式。加载数据源，一切正常。我想要的是，在报告定义中，检查数据源中是否存在某个值。这可能吗？就像，如果我有一个只有一列“名称”的数据源。我可以以某种方式检查加载的数据中是否存在名称“John”吗？

原因是如果存在某些值，我想调整一些东西。例如，如果该数据中存在某个值，我想隐藏一列并调整一些宽度等。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T10:49:43.430

使用这样的表达式：

```
SUM(IIF(myData!Name.Value = "John", 1, 0)) 
```

您可以将它放在某个不可见的字段中，然后让动态控件测试该字段的值。

# php - 我怎样才能给大量的类方法“几乎”相同的代码

> ID：531796
> 
> 赞同：2
> 
> 时间：2009-02-10T10:21:36.733
> 
> 标签：php, oop

我有这个 PHP 类

```
 class myclass{
       function name($val){
           echo "this is name method and the value is".$val;
       }

       function password($val){
           echo "this is password method and the value is".$val;
       }
   } 
```

以下是如何使用它：

```
 $myclass= new myclass();
  $myclass->name("aaa")//output: this is name method and the value is aaa 
```

它工作正常，因为我只有 2 个方法“名称”和“密码”如果我有大量方法，将这些方法添加到我的类并为每个方法编写相同的代码并不容易，我想更改我的类以让每个方法除了方法名称之外都提供相同的输出？而且我不想写所有方法的所有细节，因为它们几乎相似，这在 PHP 中可能吗？我希望我清楚:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T10:25:12.667

您可以覆盖[`__call()`](http://www.php.net/manual/en/language.oop5.overloading.php#language.oop5.overloading.methods)该类的方法，这是一种“魔术方法”，将在调用不存在的方法时使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T11:04:33.877

使用 __call 魔术方法，如下所示：

```
class myclass
{
    function __call($func, $args)
    {
        echo 'this is ', $func,  'method and the value is', join(', ', $args);
    }
} 
```

任何没有明确函数定义的函数都会调用此函数。

请注意，$args 是一个数组，其中包含调用该函数的所有参数。

# .net - 在 WPF 中处理时间驱动事件的最佳方式是什么

> ID：531805
> 
> 赞同：5
> 
> 时间：2009-02-10T10:24:19.800
> 
> 标签：.net, wpf, timer

我有一个简单的应用程序，其中包含媒体元素，它会一个接一个地播放一些电影。我想在一部电影停止播放和下一部电影开始之间有 15 秒的延迟。我是 WPF 的新手，虽然我知道如何使用 Timer 和 control.Invoke 以旧的（WinForms）方式执行此操作，但我认为 WPF 中必须有更好的方法。有没有？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T11:12:41.703

[DispatcherTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)就是你想要的。在本例中，您将创建一个间隔为 15 秒的 DispatcherTimer，开始播放第一个视频。然后当该视频完成时启用计时器并在滴答事件中显示下一个视频，并将计时器设置为禁用，使其不会每 15 秒触发一次。DispatcherTimer 位于 System.Windows.Threading 命名空间中。

```
DispatcherTimer yourTimer = new DispatcherTimer();

yourTimer.Interval = new TimeSpan(0, 0, 15); //fifteen second interval
yourTimer.Tick += new EventHandler(yourTimer_Tick);
firstVideo.Show(); 
```

假设您在视频完成时触发了一个事件，然后设置

```
yourTimer.Enabled = True; 
```

然后在 yourTimer.Tick 事件处理程序中

```
private void yourTimer_Tick(object sender, EventArgs e)
{
    yourTimer.Enabled = False;//Don't repeat every 15 seconds
    nextVideo.Show();
} 
```

# svn - SVN 在 OS X 上使用 bash/terminal 解析多个文件

> ID：531816
> 
> 赞同：1
> 
> 时间：2009-02-10T10:46:24.730
> 
> 标签：svn, bash, macos

我在已合并的工作副本中有很多冲突，我知道每个冲突都希望在合并的右侧解决。是否可以在 OSX 的 bash/terminal 中执行此操作，例如（在伪代码中：）

```
find . -name '*.merge-right.*'
   rm original-filename.filetype
   cp original-filename.filetype.merge-right.r123 original-filename.filetype
   svn resolved original-filename.filetype 
```

我知道所有这些文件的文件类型，如果有帮助，它们都一样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T11:04:47.463

我认为 svn [resolve](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.resolve.html)会做你想做的事：

```
svn resolve --accept --recursive base . 
```

（或工作，我的满，他们的满）

# xml - 如何使用 XML 根据图像大小调整 Android 组件的大小

> ID：531819
> 
> 赞同：4
> 
> 时间：2009-02-10T10:47:19.847
> 
> 标签：xml, android, layout

我使用 XML 布局创建器在 Android 中创建了一个自定义图标栏，使用 LinearLayout 中的 RadioGroup（XML 包含在下面）。RadioGroup 中的每个 RadioButton 都有一个自定义可绘制对象（具有选中和未选中状态）作为其`android:button`属性。

线性布局本身在 a`RelativeLayout`中，因此它可以出现在屏幕上的任意位置（在本例中作为侧边栏）。

可绘制对象是 55 像素宽，`android:layout\_width`所有这些视图的属性都是`wrap\_content`.

当我使这个组件可见时，对齐到屏幕的左下角，只有大约四分之三的 RadioButton 图像宽度是可见的。将 的 设置`layout\_width`为`RelativeLayout`纠正`fill\_parent` 此问题并导致出现完整按钮。

然而，这意味着按钮组在整个屏幕宽度上消耗点击事件。

如何使整个按钮出现，并且只有按钮区域响应点击？硬编码drawable的宽度并不是一个特别理想的解决方案。

```
<RelativeLayout android:id="@+id/RelativeLayout01" android:layout_width="wrap_content" android:layout_height="wrap_content">
    <LinearLayout android:id="@+id/LinearLayout02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:orientation="vertical" android:layout_alignParentBottom="true" android:layout_alignParentLeft="true" android:layout_below="@+id/LinearLayout01" android:visibility="invisible">
        <RadioGroup android:id="@+id/RadioGroup01" android:layout_height="wrap_content" android:checkedButton="@+id/RB01" android:layout_width="fill_parent">
            <RadioButton android:id="@+id/RB01" android:layout_width="fill_parent" android:layout_height="wrap_content" android:button="@drawable/DR01"/>
            <RadioButton android:id="@+id/RB02" android:layout_width="fill_parent" android:layout_height="wrap_content" android:button="@drawable/DR02"/>
            <RadioButton android:id="@+id/RB03" android:layout_width="fill_parent" android:layout_height="wrap_content" android:button="@drawable/DR03"/>
            <RadioButton android:id="@+id/RB04" android:layout_width="fill_parent" android:layout_height="wrap_content" android:button="@drawable/DR04"/>
        </RadioGroup>
    </LinearLayout>
    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T00:47:22.897

在 dp（密度独立像素）中设置 LinearLayout、RadioGroup 或 RadioButton 的宽度可能对您有用。根据你上面所说的，我认为它必须是布局的宽度。尺寸是“硬编码”的，但它们会随着屏幕的大小而缩放。

所以xml看起来像：

```
android:layout_width="55dp" 
```

dps 的官方文档在[这里](http://developer.android.com/guide/topics/resources/available-resources.html#dimension)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T03:54:55.223

我无法想象为什么另一个答案有 6 个赞成票，这是完全错误的

> 尺寸是“硬编码”的，但它们会随着屏幕的大小而缩放。

**不**，它们会根据屏幕的*密度进行缩放。*我非常希望我们可以使用 XML 中的百分比，而不必编写它们。

# c# - 动态网络参考真的是动态的吗？

> ID：531822
> 
> 赞同：2
> 
> 时间：2009-02-10T10:48:52.043
> 
> 标签：c#, web-services, visual-studio-2005, dynamic, .net-2.0

目前我正在查看 vs2005 .net 中的网络引用问题

我有多个具有多个动态 Web 引用的 Web 应用程序，现在在 web.config 中我看到以下代码：

```
<applicationSettings>
    <MainWeb.Properties.Settings>
        <setting name="MainWeb_localhost_WebService" serializeAs="String">
            <value>http://localhost/test/WebService.asmx</value>
        </setting>
    </MainWeb.Properties.Settings>
</applicationSettings> 
```

但是因为我在不同的应用程序中使用相同的 Web 服务我希望将 Web 引用放在 machine.config 中，但是正如您所看到的，Web 引用的名称是从 Web 应用程序名称中转移过来的，所以名称是一点也不动态。

而且我不想在 machine.config 中为同一个 Web 服务放置 10 个不同的 Web 引用。

所以现在是我的问题，如果有人知道这个问题的一个好的解决方案/解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T10:53:01.800

如果您[`wsdl.exe`](http://msdn.microsoft.com/en-us/library/7h3ystb6(VS.80).aspx)在命令行中使用，您可以选择带有`/appsettingurlkey:<key>`开关的键。这`MainWeb_localhost_WebService`正是 IDE 选择的默认值；这样，您可以在多个应用程序中使用相同的密钥。

在这种情况下，听起来您可能还想创建一个纯粹代表 Web 服务（所有 Web 应用程序引用）的程序集；这将恰当地表明它们代表相同的基本服务这一事实。

# sharepoint - MOSS Web 解决方案包在移动时中断

> ID：531827
> 
> 赞同：0
> 
> 时间：2009-02-10T10:52:50.660
> 
> 标签：sharepoint, moss, web-parts

我在单个共享点服务器上安装了 moss .wsp，并且在预览模式下可以正常工作。

我现在已将 SharePoint 网站移至另一台服务器并添加/部署了相同的 .wsp，但在此新服务器上尝试预览库中的 Web 部件时出现以下错误：

预览 Web 部件时发生错误。在 Microsoft.SharePoint.WebPartPages.WebPartPreview.CreateChildControls() 在 System.Web.UI.Control.EnsureChildControls() 在 System.Web.UI.Control.PreRenderRecursiveInternal() 在 System.Web.UI.Control.PreRenderRecursiveInternal() 在 System .Web.UI.Control.PreRenderRecursiveInternal() 在 System.Web.UI.Control.PreRenderRecursiveInternal() 在 System.Web.UI.Control.PreRenderRecursiveInternal() 在 System.Web.UI.Control.PreRenderRecursiveInternal() 在 System.Web .UI.Page.ProcessRequestMain（布尔型 includeStagesBeforeAsyncPoint，布尔型 includeStagesAfterAsyncPoint）

任何人都可以建议如何找到可能导致问题的原因，记住这是一个生产环境？

祝一切顺利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:53:50.100

您是在测试环境中测试您的包，还是只是将构建 WSP 从您的开发服务器复制到生产？

各种各样的事情都可能出错，所以很难从上面猜测发生了什么。

有根据的猜测是您的包不包含您的开发环境中存在的所有相关工件（第三方 dll，用户控制，任您选择！）

因此，拥有一个测试环境被认为是一种很好的做法（我们的客户通常有 5 个环境，所有环境都是脚本化的，因此我们可以确保它们尽可能地相同），这样您就可以在部署到之前测试您的包是否实际工作生产！

我还可以推荐开发环境的快照，这样你就可以每周刮擦你的开发服务器。它们很快就会与测试和生产环境不同，这就是事情开始变得丑陋并且包在测试服务器上损坏的地方。

安德斯拉斯克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T05:07:51.733

如果您只是将内容数据库移过来，您可能需要重新部署 WSP。

WSP 在 SharePoint 配置单元中本地部署文件 (C:\Program Files\Common Files\Microsoft Shared\Web server extensions\12)，并且很可能需要运行。

如果您没有将新服务器加入场，然后断开旧服务器的连接，则文件很可能丢失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T03:28:39.953

检查 12 hive 中的日志，有时它们包含有用的信息。

# java - JProgressBar 的完美替代品？

> ID：531831
> 
> 赞同：11
> 
> 时间：2009-02-10T10:55:10.000
> 
> 标签：java, user-interface, jprogressbar

对于长时间运行的进程，我想要一个不错的进度条。有没有 JProgressBar 的漂亮替代品，特别是对于不确定的进程？

我正在考虑看起来像 Web-2.0 的旋转、旋转的轮子，你有什么。

免费获得想象中的奖励积分，获得 LGPL 许可的东西。;)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T11:02:31.980

您可能想[等待风格](http://www.jroller.com/gfx/entry/wait_with_style_in_swing);）

这是一个 WebStart[演示应用程序](http://www.progx.org/users/Gfx/apps/InfiniteProgressDemo.jnlp)

这是一个屏幕截图：

[![替代文字](https://i.stack.imgur.com/t8RRV.png)](https://i.stack.imgur.com/t8RRV.png)
[（来源：[progx.org](http://www.progx.org/users/Gfx/waitwithstyle2.png)）]

# java - JavaService 和 QTP

> ID：531833
> 
> 赞同：0
> 
> 时间：2009-02-10T10:55:53.727
> 
> 标签：java, qtp

我可以从 QTP 测试/调用 Java 服务吗？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T02:16:36.130

您可以查看用于测试“非基于 GUI 的服务”的 QTP 服务测试插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:35:37.310

You can also test directly from VBScript in QTP, without the Service Test add-in. See this [SQAForums](http://www.sqaforums.com/showflat.php?Number=434429) post.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-29T11:58:56.757

**To call the jar fil**e:

To call the jar file, you can use QTP’s SystemUtil.Run like this:

SystemUtil.Run “cmd”,”/c java -jar parsingclass.jar”,””</p>

**To call the java class:**

For a java class you would do something like this:

SystemUtil.Run “cmd”,”/K java D:\HL7Parser\bin\CORUExtractorFlow1151.class”,””</p>

**Explanation About the Code:**

SystemUtil Object is a QTP object that can be used to control an application or process during a test run.

The Run method runs a file or application. cmd starts a new instance of a command interpreter.

/K is a parameter that runs the command and leaves the command window open. (If you want to close the command window instead of keeping it open, you would need to replace the /K parameters with the /C parameter.) For more info on CMD and its parameters, check out Microsoft’s documentation website

For move complicate Java calls

If you have a more complicated Java DLL that you need to interact with, you could use Service Test 11, which contains a call java class activity. With a “Unified Functional license ,” you could call Service Test from QTP; in our case, however, this would have been overkill, so we kept it simple by using the method described above.

# email - 电子邮件主题需要什么转义或净化？

> ID：531845
> 
> 赞同：2
> 
> 时间：2009-02-10T11:00:39.970
> 
> 标签：email, escaping

像 Facebook 这样的网站在向您发送消息的主题行中包含用户的姓名。

因此，您会对用户在消息主题中输入的值进行什么转义？或者，除了 az、0-9、句点、逗号和单引号之外，您是否不允许使用任何其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T11:10:39.150

如果有禁止字符，则需要转义。主题由 NL 终止，因此这是唯一不应该放在标题中的 (ASCII) 字符。

另见[rfc821](http://www.ietf.org/rfc/rfc0821.txt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:11:37.353

联系表格也有同样的问题。

如果您查看电子邮件标题，您会得到以下信息：

```
Subject: user123 has sent you an invite
From: "User123" <user123@example.org> 
```

您必须确保用户名与电子邮件标题的值不同。如果用户可以将自己命名为“收件人：spamreceiver1@example.org, spamreceiver2@example.org, spamreceiver3@example.org, spamreceiver4@example.org”，您必须清理输入。

搜索“联系表单垃圾邮件”应该会告诉您该怎么做。您至少应该删除所有出现的“收件人：”、“主题：”、“发件人：”等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T11:28:13.913

您需要小心电子邮件标题，8 位字符有点禁忌。（邮件服务器将拒绝它们）。

正确的方法是对您的主题行进行 MIME 编码并确保 ASCII 字符 \n 不在主题行中（技术上多行主题是可能的，但我想很多邮件客户端都会遇到问题）

有关详细信息，请参阅[http://en.wikipedia.org/wiki/MIME#Encoded-Word](http://en.wikipedia.org/wiki/MIME#Encoded-Word)。

# c# - 如何使用 XmlSerializer 反序列化为现有实例？

> ID：531852
> 
> 赞同：6
> 
> 时间：2009-02-10T11:04:02.583
> 
> 标签：c#, .net, serialization, .net-2.0

是否有可能使用 XmlSerializer 将其数据反序列化为类的现有实例而不是新实例？

这在两种情况下会有所帮助：

1.  轻松将两个 XML 文件合并到一个对象实例中。
2.  让对象构造器本身成为从 XML 文件加载其数据的人。

如果默认情况下不可能，它应该通过使用反射（在反序列化后复制每个属性）来工作，但这将是一个丑陋的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T11:08:41.247

基本上，你不能。`XmlSerializer`是严格建设性的。您可以定制的唯一有趣的事情`XmlSerializer`是自己实现`IXmlSerializable`和做所有事情 - 这不是一个有吸引力的选择（它仍然会使用默认构造函数创建新实例等）。

有`xml`严格要求吗？如果您可以使用不同的格式，[protobuf-net](http://code.google.com/p/protobuf-net/)支持将片段合并到现有实例中，就像：

```
Serializer.Merge(source, obj); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T12:10:09.180

我认为你在反射的想法上走在了正确的轨道上。

由于无论如何您可能都有一个围绕 XML 操作的包装器，因此您可以接收目标对象，将反序列化正常地转换为一个新对象，然后通过仅一个一个地复制包含非默认值的属性来执行类似于克隆的操作。

实现它不应该那么复杂，并且它会像就地反序列化一样从应用程序的其余部分中寻找消费者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T00:00:29.910

几周前我遇到了同样的问题。

我在我的一个实体类实现的 ISelfSerializable 接口中放置了一个方法 Deserialize(string serialized form)。我还确保接口强制类具有默认构造函数。

在我的工厂中，我创建了一个该类型的对象，然后将字符串反序列化到其中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-09T19:00:51.610

这不是线程安全的事情......但你可以这样做：

```
[Serializable]
public class c_Settings
{
    static c_Settings Default;
    public static SetExistingObject(c_Settings def)
    {
        Default = def;
    }

    public string Prop1;
    public bool Prop2;

    public c_Settings()
    {
        if (Default == null)
            return;
        MemberInfo[] members = FormatterServices.GetSerializableMembers(typeof(c_Settings));
        FormatterServices.PopulateObjectMembers(this, members, FormatterServices.GetObjectData(Default, members));
    }
} 
```

这样，您将对象提供给反序列化器，反序列化器只会覆盖 .xml 中写入的任何内容。

# mfc - 对话框上的 CMFCRebar

> ID：531856
> 
> 赞同：0
> 
> 时间：2009-02-10T11:04:54.500
> 
> 标签：mfc, pack

我们可以在对话框上创建一个 CMFCRebar 吗？如果是，那么如何？我需要在带有工具栏和菜单栏的对话框上绘制一个 CMFCReBar。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T21:51:23.743

有很多关于如何将工具栏添加到 CDialog 的示例。您是否尝试过使用其中一个示例并使用新的 CDialogEx 修改 CDialog 并使用 CMFCReBar 修改 CRebar？我没有尝试过，但也许它有效。

顺便说一句，有一个特定于 MFC 功能包问题的标签 (mfc-feature-pack)。也许你应该添加这个标签。

问候，

哈维尔

# c# - .NET 自己的配置文件

> ID：531859
> 
> 赞同：7
> 
> 时间：2009-02-10T11:06:30.767
> 
> 标签：c#, .net, app-config

有什么方法可以在运行时指定我想使用的配置文件（App.config 除外）？例如，我想从命令行读取第一个参数，该参数将成为应用程序配置的路径，并且我希望我的应用程序在使用 ConfigurationManager.AppSettings 时引用它（这可能是不可能的，但仍然值得一问）。
我确实找到了这段代码：

```
System.Configuration.Configuration config
    = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
        config.AppSettings.File = myRuntimeConfigFilePath;
        config.Save(ConfigurationSaveMode.Modified);
        ConfigurationManager.RefreshSection("appSettings"); 
```

它有效，但它覆盖了原始 App.config 的 AppSettings 部分，我的应用程序不应该写任何东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T11:19:24.597

我发现了这个并且它有效。“路径”是配置文件的路径。

```
AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", path); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T11:23:18.060

不是直接的。

间接地，您可以：

*   启动第二个`AppDomain`，为该 ( [`AppDomainSetup.ConfigurationFile`](http://msdn.microsoft.com/en-us/library/system.appdomainsetup.configurationfile.aspx)) 指定配置文件，然后在应用程序域中执行代码
*   有两个前任；第一个 ( `foo.exe`) 只是复制配置 ( 到`bar.exe.config`) 并壳第二个 exe ( `bar.exe`) [警告：线程竞争]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:28:26.813

如果您使用 log4net，您可以在 AssemblyInfo.cs 中指定您的配置文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T11:38:38.210

另一种解决方案是重构并创建自己的`ConfigurationRepository`. 然后您可以在运行时更改您将使用的特定存储库实现。

例如，`AppConfigRepository : ConfigurationRespository`将只是旧的外观`ConfigurationManager.AppSettings["key"]`。

# php - 使用 CMS 加快网站开发的最佳实践是什么？

> ID：531860
> 
> 赞同：2
> 
> 时间：2009-02-10T11:07:04.993
> 
> 标签：php, drupal, content-management-system, joomla

如果我需要构建大量网站，如何使用特定的 CMS 加快网站开发速度？如果需要类似的站点进行生产，我是否应该准备一些基于准系统 CMS 但带有预构建组件的不同解决方案并部署它们？或者我应该使用像[Joomla-Builder](http://Joomla-Builder.Com)这样的解决方案生成器吗？是否有任何工具可用于协作开发基于 CMS 的网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T11:24:32.720

版本控制有助于协作。我使用 git。一个好的错误跟踪器可以让每个人都了解情况。

对于我反复执行的任务（如安装和升级），我将这些任务捕获在构建文件中并使用 Apache Ant 运行它。

Drupal 的安装配置文件没有太多文档，但是一旦你掌握了它们就会非常有用。这使您可以根据需要打开各种组件。我还通过它们运行导入脚本，这些脚本从 CSV 文件中获取内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:48:31.977

通过示例找到了对 Drupal 配置文件的良好描述：http: [//drupal.org/node/67921](http://drupal.org/node/67921)

在为自己的站点构建器工具箱准备自定义 Drupal 构建时，它应该很有帮助，并且预装了组件。不知道Joomla有没有这样的东西。

# asp.net - 在 URL 中使用非拉丁字符

> ID：531863
> 
> 赞同：1
> 
> 时间：2009-02-10T11:08:29.063
> 
> 标签：asp.net, iis-6, url-rewriting, friendly-url, non-ascii-characters

我正在一个客户已经翻译成克罗地亚语和斯洛文尼亚语的网站上工作。为了与我们现有的 URL 模式保持一致，我们生成了模仿应用程序布局的 URL 重写规则，这导致 URL 中有许多非 ascii 字符。

示例 š ž č

有些链接是使用 getURL 从 Flash 触发的，有些是标准的 HTML 链接。有些是程序化的 Response.Redirects，有些是通过向响应中添加 301 状态代码和位置标头来实现的。我正在 IE6、IE7 和 Firefox 3 中进行测试，并且浏览器会显示非拉丁字符 url 编码。

```
š = %c5%a1
ž = %c5%be
č = %c4%8d 
```

我猜这与 IIS 以及它处理 Response.Redirect 和 AddHeader("Location ...

有谁知道强制 IIS 不对这些字符进行 URL 编码的方法，或者我最好的选择是用非变音符号替换这些字符？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T11:17:28.493

问问自己你是否*真的*想要它们非 url 编码。当一个不支持安装这些字符的用户出现时会发生什么？我不知道，但我不想冒险让世界上大部分计算机无法访问我网站的大部分内容......

相反，请关注您*为什么*需要此功能。是为了让网址看起来不错吗？如果是这样，使用常规 z 而不是 ž 就可以了。您是否使用 url 进行用户输入？如果是这样，在将其解析为链接输出之前对所有内容进行 url 编码，并在使用输入之前对其进行 url 解码。但不要在 url 中使用 ž 和其他本地字母...

附带说明一下，在瑞典，我们有 å、ä 和 ö，但没有人在 url 中使用它们——我们使用 a、a 和 o，因为浏览器不支持这些 url。这并不让用户感到惊讶，并且很少有人仅仅因为 å 中的环在 url 中丢失而无法理解我们的目标是什么。文本仍将正确显示在页面上，对吗？;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:18:11.840

> 有谁知道强制 IIS 不进行 URL 编码的方法

您必须进行 URL 编码。在 HTTP 标头中传递原始 'š' (\xC5\xA1) 是无效的。浏览器可能会为您修复高达 '%C5%A1' 的错误，但如果是这样，结果与您刚开始编写 '%C5%A1' 时的结果没有任何不同。

在链接中包含原始“š”并没有错，浏览器应该按照 IRI 规范将其编码为 UTF-8 和 URL 编码。但要确保这确实有效，您应该确保带有链接的页面以 UTF-8 编码提供。同样，手动 URL 编码可能是最安全的。

我对 UTF-8 URL 没有任何问题，你能链接到一个不起作用的例子吗？

> 您是否有指向参考的链接，其中详细说明了包含有效 HTTP 标头的内容？

规范地，[RFC 2616](http://www.faqs.org/rfcs/rfc2616.html)。然而，在实践中它有些无益。关键段落是：

> 仅当根据 RFC 2047 的规则进行编码时，*TEXT 的字可能包含来自 ISO-8859-1 以外的字符集的字符。

问题是根据 RFC 2047 的规则，只有“原子”可以容纳 2047 的“编码字”。TEXT，在大多数情况下，它包含在 HTTP 中，不能被设计成一个原子。无论如何，RFC 2047 是为 RFC 822 系列格式明确设计的，尽管 HTTP 看起来很像 822 格式，但实际上并不兼容；它有自己的基本语法，但有细微但显着的差异。HTTP 规范中对 RFC 2047 的引用没有提供任何线索来说明人们如何能够以任何一致的方式解释它，并且据我所知的任何人都可以解决，这是一个错误。

在任何情况下，实际浏览器都不会尝试在其 HTTP 处理的任何地方找到解释 RFC 2047 编码的方法。虽然 RFC 2616 将非 ASCII 字节定义为 ISO-8859-1，但实际上浏览器在处理 HTTP 时可以在不同的地方使用许多其他编码（例如 UTF-8，或任何系统默认编码）标题。因此，即使依赖 8859-1 字符集也不安全！无论如何，这不会给你'š'......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:17:27.433

这些字符在 URL 中应该是有效的。我在一个大型旅游网站上做了 URL SEO 的东西，那时我才知道。当您将变音符号强制为 ascii 时，如果您不小心，您可以更改单词的含义。通常没有翻译，因为变音符号只存在于它们的上下文中。

# cocoa-touch - UIAlertView中的iPhone键盘弹出问题

> ID：531864
> 
> 赞同：1
> 
> 时间：2009-02-10T11:08:39.607
> 
> 标签：cocoa-touch

我想使用警报视图接受密码。以下是我正在使用的代码。但我无法弄清楚为什么键盘弹出两次而不是一次？有任何想法吗？

```
UIAlertView *passwordAlert = [[UIAlertView alloc]
         initWithTitle:@"Enter Password" message:@"" 
         delegate:self cancelButtonTitle:@"Cancel"          
         otherButtonTitles:@"Submit",nil];

[passwordAlert addTextFieldWithValue:@"" label:@"Password"];

UITextField *textfield = [passwordAlert textFieldAtIndex:0];
textfield.secureTextEntry = YES;
[passwordAlert setTag:10];
[passwordAlert show]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T11:19:14.420

不完全确定 addTextFieldWithValue 的定义位置，但您可能需要检查 .xib 文件以确保您没有在“舞台”上放置双重视图，如本文所述：

[http://www.iphonedevsdk.com/forum/iphone-sdk-development/1479-uialertview-popping-up-twice.html](http://www.iphonedevsdk.com/forum/iphone-sdk-development/1479-uialertview-popping-up-twice.html)

另外，看看这篇文章。看起来您可能必须“在显示警报视图之前告诉文本字段成为第一响应者，您最终会得到两个键盘”：

[http://www.iphonedevsdk.com/forum/iphone-sdk-development/2753-new-info-adding-text-fields-alerts.html#post14701](http://www.iphonedevsdk.com/forum/iphone-sdk-development/2753-new-info-adding-text-fields-alerts.html#post14701)

# html - 单个网页上有多个 Flash 对象？

> ID：531869
> 
> 赞同：2
> 
> 时间：2009-02-10T11:09:57.640
> 
> 标签：html, apache-flex, flash, streaming, load

如果单个网页将加载 10 个相同的 Flash 对象，是否会对性能/加载时间产生**重大影响？**20？30?.. 任何关于这种设置可持续性的证据数据？

这将是同一个 Flash 应用程序，每个实例都提供自己的流。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T11:17:21.273

在大小上肯定会有一些开销，因为每个 swf 中都包含一定数量的代码，而不管它是开发人员创建的内容。

我几乎可以肯定还会存在速度问题，即您添加到页面的 swf 越多，帧速率就会下降。

老实说，这个概念有点可疑，我认为必须有更好的解决方案来解决您的问题。

编辑

此外，每个域有两个流通过 http 也有限制。当然你可以解决这个问题，但这肯定是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:52:44.400

从设计上讲，这听起来是个坏主意。您将在浏览器中运行 Flash 播放器的多个实例，每个实例都有单独的成本，并且主机（在本例中为浏览器）将在同一线程上运行所有这些实例（某些可选异步除外进程），因此您几乎肯定会遇到各种问题——播放抖动、UI 阻塞、处理器负担、内存膨胀、随之而来的主机不稳定等。

除非 SWF 非常小，而且做的工作很少，否则这似乎是一种自找麻烦的设计。事实上，你可以很容易地测试这样的东西；你有没有进行任何测试？只是好奇。

对要求也很好奇；如果我们对您的目标有更多了解，我们或许能够提供更具建设性的替代方案。您是否考虑过简单地将所有 SWF 加载到一个容器 SWF 中，只需要一个浏览器托管的 Flash 播放器实例？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:20:46.613

我发现[这篇文章](http://www.prateekdayal.net/tech/2008/07/08/embedding-multiple-swf-files-in-same-html-page/)可能会有所帮助。诀窍是使用[SWFObject](http://code.google.com/p/swfobject/)嵌入您的 swf 文件。

> 我今天遇到了一个奇怪的问题。在 Muziboo 的音乐排行榜页面上，我在右侧显示了歌曲列表和播放列表。每首歌曲都有一个在 OpenLaszlo 中完成的小按钮播放器。在 Firefox 中一切都很好，在 IE 中（并不罕见），页面会冻结一段时间。这只会发生一次，并且只有在我删除缓存并重试时才会重复。我用谷歌搜索了一下，了解到**嵌入给每个 swf 一个唯一的 id 是个好主意，否则浏览器会出现错误行为**。然后我继续使用 swfobject 嵌入 swf 文件，一切都开始正常工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T11:20:57.473

是的，如果您在这条路上走得太远，它可能会破坏浏览器。

如果您想处理多个流，也许将所有可能的小程序组合成一个巨大的小程序可能会更好。它肯定会抵消 10 到 40 只小病虫的严重开销。

如果这是一个音乐播放器，那么您需要认真考虑做一些 JavaScript 远程处理。通过 JS 控制 Flash 应用程序相当简单，因此您可以拥有标准的 HTML/CSS 控件，而无需加载十亿个 Flash 实例。

# delphi - Delphi：如何自动删除未使用的变量（“变量'x'已声明但从未使用”提示）

> ID：531873
> 
> 赞同：6
> 
> 时间：2009-02-10T11:11:20.367
> 
> 标签：delphi, syntax

是否有任何工具（最好是免费软件）可以分析 Pascal/Delphi 语法并自动删除未使用的变量？

就我而言，我正在使用一个非常大的 Delphi 代码库，编译器提示报告了超过一千个“声明了变量'x'但从未使用过”的案例。

我需要几个小时才能手动删除它们，而且我可能会出错，但正确的工具应该能够安全且自动地做到这一点。

我在网上搜索但没有找到......这里有人知道这样的工具吗？

谢谢...

马克布拉福德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T11:29:43.397

我明白你的观点，并且完全同意这样的工具在处理遗留代码时会很有用。不幸的是，我不知道任何现有的工具（我应该在这里添加免费软件工具，静态分析工具当然应该能够轻松完成，但我不知道任何免费的静态代码分析工具）能够做到这一点.

但我想你可以在几分钟内轻松编写出这样的工具。一个带有备忘录和按钮的小 GUI 就足够了。然后只需将编译器提示复制到备忘录中并按下按钮。然后该工具解析每一行。它可以很容易地检查该行是否包含您要查找的提示，并且每个这样的行具有相同的结构，因此解析应该相对容易。然后它可以提取文件名和行号，打开文件并删除变量声明。如果一行中有多个变量声明，这可能有点棘手，但我认为这是可行的。

我不知道与自己删除所有变量声明的任务相比，这对您来说是否付出了太多努力。但是我很想看到这样的工具，所以随意写吧:)

希望至少有一点帮助。

好吧，我真的看不出这里有什么问题。对于解析部分：

```
function ParseHint (const HintText : String; out HintInfo : THintInfo) : Boolean;
var
  I, J     : Integer;
  HintName : String;
begin
  Result := False;
  for I := 1 to Length (HintText) do
  begin
    if (HintText [I] = '(') then
    begin
      J := I + 1;
      while (HintText [J] <> ')') do Inc (J);
      HintInfo.LineNumber := StrToInt (MidStr (HintText, I+1, J-(I+1)));
      HintInfo.SourceFile := MidStr (HintText, 12, I-12);
      HintName := MidStr (HintText, J+3, 5);
      if (HintName <> 'H2164') then Exit (False);
    end;
    if (HintText [I] = '''') then
    begin
      J := I + 1;
      while (HintText [J] <> '''') do Inc (J);
      HintInfo.VarName := MidStr (HintText, I+1, J-(I+1));
      Exit (True);
    end;
  end;
end; 
```

好吧，阅读源文件应该很容易，所以唯一剩下的部分就是从它的声明行中删除变量。我们可以简单地搜索该行中出现的 HintInfo.VarName 并检查出现前后的字符是否不是字母而只有''、'、'或':'。如果是这种情况，我们可以将其删除。这涵盖了所有这些情况：

```
var UnusedVar : Integer;
var
  UnusedVar,
  AnotherVar : Integer;
var
  UnusedVar, AnotherVar : Integer; 
```

如果我错了或者我忘记了任何情况，请告诉我，但我认为这会起作用，并且会解决使用编译器生成的提示从 delphi 源文件中删除未使用变量的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T09:30:33.157

解决方案很简单，但需要这些时间来确保您不会犯错。首先，您可以使用 Alt-F8 一个接一个地浏览每个报告（而 Alt-F7 可以后退）。这使得定位它们变得非常容易。光标为您放在行上。然后只需按两次“/”键即可将其注释掉。不要删除它，评论它。这样，如果您犯了错误，您就不会丢失任何信息。变量的存在及其数据类型仍然被记录下来。您可以稍后在某个时候整理它。

所有这一切的一个警告：条件编译可能会在以不同方式构建时使某些变量未使用。如果发生这种情况，那么只需再次取消注释变量，并将条件也放在声明周围。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T12:01:23.477

如果没有这样的工具并且你有一些耐心，我正在构建一个Delphi分析和修复工具。删除未使用的符号也在列表中。这是一个低优先级的项目，所以我无法估计它什么时候准备好。

只是为了解释为什么这不是一项微不足道的任务：

1.  阅读源代码
2.  创建一个模型，其中包含每个符号使用的足够信息。
3.  标记所有未使用的符号。
4.  在没有不需要的符号的情况下重写源代码。

任务 1 和 2 很难（幸运的是我已经完成了）。Delphi 语言相当复杂。您需要所有语言元素才能重新创建源代码。

任务 3 很简单。只需标记所有未使用的符号。但要注意单元接口部分中的符号。它们可能不被使用，但以后需要（或其他项目）。

任务 4 取决于。

方法 A 使用中间格式（例如字符串列表），然后您可以使用模型查找每个未使用符号的声明（自下而上，否则您可能会更改行号）。你删除所有不需要的。如果它是列表中的最后一个 var，请不要忘记删除 var 关键字！

方法 B 完全重写源文件。在这种情况下，您必须保留所有不太有趣的评论（但我的模型也需要这样做）。您只需从模型中删除未使用的符号并重写它。始终确保创建备份，因为这可能会导致灾难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T15:55:47.513

你确定不应该使用变量吗？我知道编译器发现它们现在没有被使用，但这是正确的，也许应该使用其中的许多，但是开发人员使用 x2 而不是 x1，例如复制和粘贴？

虽然您可能想要删除所有未经审查的变量，但我不会这么仓促，它们可能表明您想要修复的代码中的错误。

例子：

```
procedure PlotPixelAtCenter(rect: Rectangle)
var
    x, y: Integer;
begin
    x := (rect.Left + rect.Right) div 2;
    x := (rect.Top + rect.Bottom) div 2; // <-- bug here, should be y :=
    PlotPixel(x, y);
end; 
```

在此示例中，您将收到有关未使用变量的错误，但这是一个潜伏的错误。当然，在这个例子中，错误应该很容易找到，因为绘图可能会关闭，但其他类似的错误可能更难发现。

# winapi - 如何区分 Win32 套接字句柄和其他管道句柄？

> ID：531874
> 
> 赞同：5
> 
> 时间：2009-02-10T11:11:26.620
> 
> 标签：winapi, winsock

我需要确定我的代码未创建的句柄是否`GetFileType()==FILE_TYPE_PIPE`是套接字。似乎没有用于此的 API。

我尝试了以下方法。总体思路是使用特定于套接字的函数，并将失败视为非套接字。

*   `getsockopt()`——这是我的第一次尝试。不幸的是，当被同一个（非套接字）句柄上的许多线程调用时，它似乎挂起。
*   `WSAEnumNetworkEvents()`*-- 这就是 Gnulib 所做的，但如果句柄是*套接字，则会产生不良的副作用。
*   `getpeername()`- 这就是 cygwin 所做的，但对于某些套接字也会失败。猜测错误是否意味着套接字性似乎并不可靠且未来安全。

我不介意该解决方案是否仅适用于某些版本的 Windows，例如 Vista，在一般情况下我总是可以使用其他方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T12:30:55.917

我在想也许你可以尝试在你的句柄上调用**GetNamedPipeInfo() 。**如果调用成功就知道句柄是管道句柄，否则一定是套接字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:40:33.430

Have you tried `WSADuplicateSocket`. Then just check `WSAPROTOCOL_INFO` to see if it is in fact a named pipe...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-20T11:58:09.563

您也可以使用 GetNamedPipeHandleState()，使用 GetLastError() 评估结果。

# php - jQuery 中的 JavaScript 函数参数

> ID：531876
> 
> 赞同：0
> 
> 时间：2009-02-10T11:11:38.913
> 
> 标签：php, javascript, jquery, ajax, events

我正在使用 jQuery 和 JavaScript。我有一个调用 JavaScript 函数的 onclick 事件。如何在 jQuery 中提取 function_A 和 function_B 的参数？

这是最好的方法吗？

单击 JavaScript 后，我​​需要进行 Ajax 调用。使用 jQuery 是否存在性能问题？

我的代码：

```
<html>
    <head>
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script>
            $(document).ready(function(){
                //Here need to extract the JavaScript function arguments
                var id1=from_javascript_function_A
                var id2=from_javascript_function_B

                var link1=from_javascript_function_A
                var link2=from_javascript_function_B
                //
        </script>
    </head>
    <body>
        <a href='#' onclick=javascript:function_A('first',1)>link1</a>
        <a href='#' onclick=javascript:function_B('second',2)>link2</a>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T19:50:05.830

这样的事情呢？

```
<script>
        $(document).ready(function(){
            $("a.a").click(function(e){
                DoWork('a',1,function_a);
            });
            $("a.b").click(function(e){
                DoWork('b',2,function_b);
            });
        });

        function DoWork(s,i,f){
            f(s,i);
            alert("after click:" + s + " " + i);
        }

        function function_a(s,i){
            alert("a:" + s + " " + i);
        }
        function function_b(s,i){
            alert("b:" + s + " " + i);
        }

    </script>

</head>
<body>

    <a href="#" class="a">a</a>
    <a href="#" class="b">b</a>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T11:24:02.067

如果你真的很想从函数调用中提取参数，你需要做一堆手动解析，例如，

```
$("a").each(function(){
  var onclicktext = $(this).attr("onclick");
  if(onclicktext.indexOf("function_A") > -1){
    // Do more parsing here
  }
  if(onclicktext.indexOf("function_B") > -1){
    // Do more parsing here
  }  
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:37:37.637

函数参数仅在该函数中可见。通常它们是变量，并且它们的值仅在调用函数时才有意义（在您的示例中，当单击相应的链接时）。在 内`$(document).ready`，它们的值不相关。

如果参数不是变量，它们是已知的，无论如何你都不会问这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T12:22:53.703

如果您无法编辑[HTML](http://en.wikipedia.org/wiki/HTML)代码，那么您所能做的就是一些丑陋的 hack：

```
$("a").each(function(){
  fnStr = ($(this).attr('onclick')).toString();
  re = /\"[^\"]+\"/
  alert(re.exec(fnStr));
  re = /\'[^\"]+\'/
  alert(re.exec(fnStr));
}); 
```

上面的代码使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)来获取引号之间的参数。自己试试；不同的浏览器可能有不同的行为。

# c# - Windows XP 上的 WPF 视频撕裂

> ID：531878
> 
> 赞同：2
> 
> 时间：2009-02-10T11:12:42.563
> 
> 标签：c#, wpf, graphics

我使用 C# 创建了一个 WPF 应用程序，它呈现大约 50 个 3D 元素并为相机设置动画以便在场景中移动。

虽然一切正常，但我注意到随着相机的移动，会出现难看的视频撕裂。

我很清楚撕裂的标准原因，即应用程序以与监视器/适配器垂直同步不同的速率更新帧。

我还读到 WPF 中的默认屏幕更新速率是每秒 60 帧，而 XP WPF 更新的默认屏幕更新速率[与 montior v-sync 无关](https://stackoverflow.com/questions/438741/wpf-mediaelement-video-playback-tearing)。

对于某些场景，撕裂不太明显，但通常足以分散注意力，成为一个真正的问题。

我真的希望有一个解决方案，毕竟 Windows 窗体多年来一直有双缓冲。如果没有解决方案，迁移到 WPF 实际上是许多类型的应用程序的倒退。

那么，在 Windows XP 上，如何配置 WPF 来消除撕裂？

我正在寻找更多有用的答案，然后“移至 Vista”。对于该应用程序的许多未来用户来说，这完全是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T11:42:27.777

还没有答案，肯定有很多 WPF 开发人员已经看到了这个问题？

与此同时，我已经调查/阅读了更多内容，并遇到了[Timeline.DesiredFrameRate](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.timeline.desiredframerate.aspx)属性。

当我的显示器以 50hz 垂直刷新运行时，我尝试将其设置为 50 FPS，希望这会使事情同步。不幸的是，这对撕裂没有影响。

但是，我确实必须将它应用于我使用 BeginAnimation() 创建的（在代码中）的单个特定动画。我不确定这将如何影响“全局”帧速率。

相反，我本来希望需要在更全局的级别上执行此操作，例如在视口上，但是我在视口对象上找不到 DesiredFramerate 属性。

另一个要查看的区域可能是[RenderCapability.Tier](http://msdn.microsoft.com/en-us/library/system.windows.media.rendercapability.tier.aspx)，但我还没有时间详细查看。

[更新]

没有解决方案，但有用的提示。要全局设置 DesiredFramerate（即对于视口中的所有动画），您可以覆盖 Timeline.DesiredFrameRateProperty 依赖属性的 PropertyMetadata：

```
// Set the global desired framerate to 50 frames per second
Startup += delegate(object sender, StartupEventArgs e)
{
Timeline.DesiredFrameRateProperty.OverrideMetadata(typeof(Timeline),
     new PropertyMetadata(50));
}; 
```

最好将它放在标准 WPF Application 类的构造函数中。

Unfortunately this didn't solve my problem because even setting it to FPS, it must not be synced accurately enough with monitor v-sync.

It is handy to know about though, particularly if you have slow moving animations and want to save CPU usage by setting the FPS much lower then the default 60fps.

[Update]

Setting the DesireFrameRate to some very high value such as 100+ seems to reduce but not remove the flicker. One big drawback however is that the CPU (on my 4 yo PC) goes to 35%.

# html - 如何将参数从html页面传递到批处理文件

> ID：531882
> 
> 赞同：-3
> 
> 时间：2009-02-10T11:13:10.113
> 
> 标签：html, xml, batch-file

我有以下要求。我需要将参数从 html 页面传递到批处理文件，然后将参数传递给 xml 文件。我需要知道如何将参数从 html 传递到批处理文件以及从批处理文件传递到 xml 文件谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T15:35:58.390

m.mahesh.2000，可能值得你画一张拼图各个部分的小图。HTML 和 XML 文件不是程序！

考虑这些可能的图表：

```
CGI Approach:

+--------------+     +----------------+
|    Browser   |     |    Web Server  |
|              |     | (eg: Apache)   |
| +----------+ |     | +------------+ |
| |HTML      | | --> | | CGI        | |
| |Javascript| |     | |            | |
| +----------+ |     | | +-------+  | |
+--------------+     | | | Perl  |  | |
                     | | +-------+  | |
                     | +------------+ |
                     +----------------+

Servlet Container Approach:

+--------------+     +------------------+
|    Browser   |     |      Tomcat      |
|              |     |                  |
| +----------+ |     | +-------------+  |
| |HTML      | | --> | | Servlet     |  |
| |Javascript| |     | | Container   |  |
| +----------+ |     | | +---------+ |  |
+--------------+     | | | Servlet | |  |
                     | | +---------+ |  |
                     | +-------------+  |
                     +------------------+ 
```

浏览器呈现您的 HTML，执行任何 javascript，并将 HTTP 请求发送到您的服务器 - 这是 Apache、Tomcat 还是其他？你知道你有什么样的服务器吗？

Apache 生成子 CGI 进程来处理某些 HTTP 请求。CGI 进程通常是 PHP 或 Perl 脚本。

Tomcat 有许多线程来处理 HTTP 请求。一些请求由托管在 Servlet 容器中的 Servlet 实例处理。

CGI 进程或 servlet 将完成在服务器上创建 XML 文件和联系数据库的工作。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T11:24:39.663

什么样的“参数”？什么样的“html页面”？什么样的“批处理文件”？什么样的“xml文件”？

假设您的意思是 HTML 表单中的数据应由批处理文件处理并作为 XML 写入磁盘：

*   来自 HTML 表单的数据始终使用[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)协议进行处理，并且可以使用批处理脚本来处理，甚至可能是 Windows 批处理文件。
*   但是，这将非常不舒服，容易出错且不安全。最好有一种专门针对 Web 应用程序的语言或框架来为您处理低级 CGI 内容。
*   常见的选择是：PHP、Perl、Java servlet 或 ASP。
*   虽然可以简单地通过输出字符串来编写 XML，但实际上可以保证最终得到格式错误的 XML。
*   使用真正的 XML 框架来生成 XML 要好得多——对于几乎任何值得使用的语言，都有多种可供选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:17:11.943

批处理文件和xml文件是客户端还是服务器端？

无论哪种方式，您都需要向 html 文件添加一些脚本。甚至使用服务器端脚本来生成 html...

# c# - 作为 WebService 使用的 WCF 添加了一个布尔参数？

> ID：531886
> 
> 赞同：10
> 
> 时间：2009-02-10T11:14:05.303
> 
> 标签：c#, visual-studio-2008, wcf, .net-3.5, .net-2.0

我在 VS2008 中创建了默认的 WCF 服务。它被称为“服务1”

```
public class Service1 : IService1
{
    public string GetData( int value )
    {
        return string.Format("You entered: {0}", value);
    }

    public CompositeType GetDataUsingDataContract( CompositeType composite )
    {
        if ( composite.BoolValue )
        {
            composite.StringValue += "Suffix";
        }
        return composite;
    }
} 
```

它工作正常，接口是IService1：

```
[ServiceContract]
public interface IService1
{

    [OperationContract]
    string GetData( int value );

    [OperationContract]
    CompositeType GetDataUsingDataContract( CompositeType composite );

    // TODO: Add your service operations here
} 
```

这都是默认的；Visual Studio 2008 创造了这一切。

然后我创建了一个简单的 Winforms 应用程序来“测试”它。我将服务参考添加到上述服务中，一切正常。我可以实例化并调用 myservice1.GetData(100); 我得到了结果。

但有人告诉我，该服务必须由 Winforms .NET 2.0 应用程序通过 Web 服务使用，因此我继续添加对从头开始创建的新 Winforms .NET 2.0 应用程序的引用（只有一个名为 form1 的 winform）。这一次，在添加“web reference”时，它添加了属于webservices的典型“localhost”；向导看到了 WCF 服务（在后台运行）并添加了它。

当我尝试使用它时，我发现 GetData(int) 方法现在是 GetData(int, bool)。

这是代码

```
 private void button1_Click( object sender, EventArgs e )
    {
        localhost.Service1 s1 = new WindowsFormsApplication2.localhost.Service1();
        Console.WriteLine(s1.GetData(100, false));
    } 
```

注意到 GetData 调用中的错误了吗？

我不知道那个参数是什么或从哪里来的，它被称为“bool valueSpecified”。

有人知道这是从哪里来的吗？我还应该做些什么来将 WCF 服务作为 .NET 2.0 中的 WebService 使用？（winforms）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T13:11:10.843

好吧……显然[这](http://blogs.msdn.com/eugeneos/archive/2007/02/05/solving-the-disappearing-data-issue-when-using-add-web-reference-or-wsdl-exe-with-wcf-services.aspx)是答案和可能的解决方案或解决方法。

# python - Django：默认执行不区分大小写的查找

> ID：531892
> 
> 赞同：8
> 
> 时间：2009-02-10T11:16:41.647
> 
> 标签：python, django, django-models, django-orm

`username`使用 Django Auth 框架时，我需要默认执行不区分大小写的查询。

我尝试通过编写自定义子类`Queryset` 并覆盖该`_filter_or_exclude`方法，然后在用户模型的自定义管理器中使用该子类来解决该问题-

```
from django.db.models import Manager
from django.db.models.query import QuerySet
from django.contrib.auth.models import UserManager

class MyQuerySet(QuerySet):
    def _filter_or_exclude(self, negate, *args, **kwargs):
        if 'username' in kwargs:
            kwargs['username__iexact'] = kwargs['username']
            del kwargs['username']
        return super(MyQuerySet, self)._filter_or_exclude(negate, *args, **kwargs)

class MyUserManager(UserManager):
    def get_query_set(self):
        return MyQuerySet(self.model)

User.objects = MyUserManager() 
```

但是这种方法不起作用，当我尝试做`User.objects.get(username='Foo')`.

任何帮助，将不胜感激。

**更新**：我包括了我得到的确切错误。

```
/usr/lib/python2.5/site-packages/django/db/models/query.py in get(self, *args, **kwargs)
    295         keyword arguments.
    296         """
--> 297         clone = self.filter(*args, **kwargs)
    298         num = len(clone)
    299         if num == 1:

/usr/lib/python2.5/site-packages/django/db/models/query.py in filter(self, *args, **kwargs)
    481         set.
    482         """
--> 483         return self._filter_or_exclude(False, *args, **kwargs)
    484 
    485     def exclude(self, *args, **kwargs):

/home/ghoseb/src/git/ocricket.git/ocricket/user/models.py in _filter_or_exclude(self, negate, *args, **kwargs)
     38             kwargs['username__iexact'] = kwargs['username']
     39             del kwargs['username']
---> 40         return super(MyQuerySet, self)._filter_or_exclude(negate, *args, **kwargs)
     41 
     42 class MyUserManager(UserManager):

/usr/lib/python2.5/site-packages/django/db/models/query.py in _filter_or_exclude(self, negate, *args, **kwargs)
    499             clone.query.add_q(~Q(*args, **kwargs))
    500         else:
--> 501             clone.query.add_q(Q(*args, **kwargs))
    502         return clone
    503 

/usr/lib/python2.5/django/db/models/sql/query.py in add_q(self, q_object, used_aliases)

/usr/lib/python2.5/django/db/models/sql/query.py in add_filter(self, filter_expr, connector, negate, trim, can_reuse, process_extras)

/usr/lib/python2.5/django/db/models/sql/query.py in get_meta(self)

<type 'exceptions.AttributeError'>: 'NoneType' object has no attribute '_meta' 
```

**更新**：顺便说一句，我只想提一下，当我将`_filter_or_exclude`方法中的逻辑复制到实际`QuerySet`类中时，它可以完美运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T12:08:56.467

你不想弄乱 Django 类的内部特性。这样一来，以后每次升级都会遇到麻烦。

如果您想更改人们的身份验证方式，请编写自定义身份验证后端。

这里有两个食谱。

[http://www.davidcramer.net/code/224/logging-in-with-email-addresses-in-django.html](http://www.davidcramer.net/code/224/logging-in-with-email-addresses-in-django.html)

[http://www.djangosnippets.org/snippets/577/](http://www.djangosnippets.org/snippets/577/)

这两个我们都是电子邮件而不是用户名。使用不区分大小写的查询而不是电子邮件查询并不难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T13:17:26.430

无法通过简单的属性分配 ( `User.objects = MyManager()`) 将管理器添加到类中。查看 ModelBase 元类 (db/models/base.py) 以了解当您对 Model 进行子类化时在幕后为您做了什么。

您应该能够使其与`User.add_to_class('objects', MyManager())`. 或者，您可以创建User的[代理子类并在那里添加管理器。](http://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-11T03:24:20.750

这是 auth 用例的秘诀： [Django : Case insensitive matching of username from auth user?](https://stackoverflow.com/questions/13190758/django-case-insensitive-matching-of-username-from-auth-user/18731796#18731796) 您可能最好为每个用例使用单独的解决方案。

# windows - 在受控环境下运行应用程序的问题 (Win32)

> ID：531893
> 
> 赞同：0
> 
> 时间：2009-02-10T11:16:49.417
> 
> 标签：windows, limit, low-level

我不确定如何标记这个问题或如何写标题，所以如果有人有更好的主意，请编辑它

**这是交易：**

前段时间，我编写了一个*计算奥赛管理系统*的一个小而关键的部分。系统的工作是获取参与者的提交（代码文件），编译它们，针对预定义的测试用例运行它们，并返回结果。加上你能想象到的所有其他事情。

我写的那部分叫做**Limiter**。这是一个小程序，它的工作是获取另一个程序并在受控环境中运行它。在这种情况下，受控意味着对可用内存、计算时间和对系统资源的访问的限制。另外，如果程序崩溃，我应该能够确定异常的类型并将其报告给用户。此外，当进程终止时，应注意它执行了多长时间（分辨率至少为 0.01 秒，最好更多）。

当然，最理想的解决方案是虚拟化，但我没有这么写的经验。

我对此的解决方案分为三个部分。

最简单的部分是对系统资源的访问。该程序将简单地使用有限的访问令牌执行。我结合了一些可用于所有进程的基本（每个人、匿名等）访问令牌，以便实际上提供对系统的只读访问，但它正在执行的文件夹除外。

内存限制是通过作业对象完成的——它们允许指定最大内存限制。

最后，为了限制执行时间并捕获所有异常，我的限制器作为调试器附加到进程。因此，我可以监控它花费的时间，如果花费的时间太长，我可以终止它。请注意，我不能为此使用 Job 对象，因为它们只报告作业的内核时间和用户时间。一个进程可能会做一些`Sleep(99999999)`不会计算在内的事情，但仍然会禁用测试机器。因此，虽然我没有将进程空闲时间计入其最终执行时间，但它仍然必须有一个限制。

现在，我不是这种低级事物的专家。我花了几天时间阅读 MSDN 并玩弄，并尽我所能想出了一个解决方案。不幸的是，它似乎没有像预期的那样运行。在大多数情况下，它似乎工作正常，但奇怪的情况不断出现。刚才我有一个小 C++ 程序，它自己在瞬间运行，但我的限制器报告了 8 秒的用户模式时间（取自作业计数器）。这是代码。它在大约半秒内打印输出，然后花费超过 7 秒的时间等待：

```
#include <iostream>
#include <vector>
using namespace std;

int main()
{
    vector< vector<int> > dp(50000, vector<int>(4, -1));
    cout << dp.size();
} 
```

限制器的代码很长，所以我不在这里包括它。我也觉得我的方法可能有问题——也许我不应该做调试器的事情。也许有一些我不知道的常见陷阱。

我想要一些关于其他人如何解决这个问题的建议。也许已经有一些东西可以做到这一点，而我的限制器已经过时了？

* * *

**补充：**问题似乎出在我上面贴的那个小程序上。我为它提出了一个[新问题](https://stackoverflow.com/questions/532092/weird-behaviour-of-c-destructors)，因为它有些无关。我仍然想对这种限制程序的方法发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T15:30:14.720

在附加调试器的情况下运行可以改变应用程序的特性。性能可能会受到影响，代码路径甚至可能会发生变化（如果目标进程基于调试器的存在来执行操作，即[`IsDebuggerPresent`](http://msdn.microsoft.com/en-us/library/windows/apps/ms680345.aspx)）。

我们使用的另一种方法是将我们自己的应用程序配置为作为 JIT 调试器运行。通过设置`AeDebug`注册表项，您可以控制应用程序崩溃时调用的调试器。这样，您仅在目标进程崩溃时才介入，并且在正常运行时不会影响该进程。

这个站点有一些关于设置事后调试器的细节：[配置自动调试](http://msdn.microsoft.com/en-us/library/windows/desktop/bb204634.aspx)。

您限制内存、获取时间等的方法听起来都很好。

# c# - PDF-Adobe 数字版

> ID：531901
> 
> 赞同：1
> 
> 时间：2009-02-10T11:18:13.313
> 
> 标签：c#, pdf, adobe

我想使用 Adob​​e Digital Edition 保护 pdf 文档。我认为它目前被用来保护电子书以防止非法流通。

任何人都可以对此有所了解。是否可以使用 C# 或其他东西来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T16:57:17.783

您可能想查看[Adob​​e Content Server](http://www.adobe.com/products/contentserver/)和[Adob​​e Digital Publishing Technology Center](http://www.adobe.com/devnet/digitalpublishing/)网站以了解某些方向。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T05:13:43.103

是的，您可以使用 C#：[请参阅 SDK 信息文档](http://web.archive.org/web/20100604014756/http://www.adobe.com/devnet/digitalpublishing/pdfs/ADE_LauncherSDK_DevNet.pdf)。您可以使用任何服务器端处理语言。

# c# - .NET 的 Uri 实现的替代方案？

> ID：531914
> 
> 赞同：9
> 
> 时间：2009-02-10T11:22:39.793
> 
> 标签：c#, .net, ftp, uri

我对 .NET 的 Uri 实现有疑问。似乎如果方案是“ftp”，则查询部分不会被解析为查询，而是作为路径的一部分。

以下面的代码为例：

```
Uri testuri = new Uri("ftp://user:pass@localhost/?passive=true");
Console.WriteLine(testuri.Query); // Outputs an empty string
Console.WriteLine(testuri.AbsolutePath); // Outputs "/%3Fpassive=true" 
```

在我看来，Uri 类错误地将查询部分解析为路径的一部分。但是将方案更改为http，结果符合预期：

```
Uri testuri = new Uri("http://user:pass@localhost/?passive=true");
Console.WriteLine(testuri.Query); // Outputs "?passive=true"
Console.WriteLine(testuri.AbsolutePath); // Outputs "/" 
```

有没有人对此有解决方案，或者知道可以按预期工作的替代 Uri 类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T14:01:08.460

好吧，问题不在于我无法创建 FTP 连接，而是 URI 没有根据 RFC 2396 进行解析。

我真正打算做的是创建一个工厂，它基于给定的连接 URI 提供通用文件传输接口（包含 get 和 put 方法）的实现。URI 定义了协议、用户信息、主机和路径，任何需要传递的属性都应该通过 URI 的 Query 部分（例如 FTP 连接的 Passive 模式选项）。

然而，使用 .NET Uri 实现证明这很困难，因为它似乎根据架构以不同的方式解析 URI 的查询部分。

所以我希望有人知道解决这个问题的方法，或者是看似损坏的 .NET Uri 实现的替代方法。在花几个小时实施我自己的之前知道会很高兴。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-24T16:44:47.510

我一直在为同样的问题苦苦挣扎一段时间。尝试使用“ftp”方案替换现有的 UriParser`UriParser.Register`会抛出一个错误，`InvalidOperationException`因为该方案已经注册。

我提出的解决方案涉及使用反射来修改现有的 ftp 解析器，以便它允许查询字符串。这是基于[另一个 UriParser 错误](http://connect.microsoft.com/VisualStudio/feedback/details/386695/system-uri-incorrectly-strips-trailing-dots#)的解决方法。

```
MethodInfo getSyntax = typeof(UriParser).GetMethod("GetSyntax", System.Reflection.BindingFlags.Static
                                                              | System.Reflection.BindingFlags.NonPublic);
FieldInfo flagsField = typeof(UriParser).GetField("m_Flags", System.Reflection.BindingFlags.Instance
                                                           | System.Reflection.BindingFlags.NonPublic);
if (getSyntax != null && flagsField != null)
{
    UriParser parser = (UriParser)getSyntax.Invoke(null, new object[] { "ftp"});
    if (parser != null)
    {
        int flagsValue = (int)flagsField.GetValue(parser);

        // Set the MayHaveQuery attribute
        int MayHaveQuery = 0x20;
        if ((flagsValue & MayHaveQuery) == 0) flagsField.SetValue(parser, flagsValue | MayHaveQuery);
    }
} 
```

在初始化的某个地方运行它，您的 ftp Uris 将使查询字符串进入`Query`参数，正如您所期望的那样，而不是`Path`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T11:44:39.897

您应该使用[FtpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)和[FtpWebResponse](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.aspx)类，除非您有特定的理由不这样做。

```
FtpWebRequest.fwr = (FtpWebRequest)FtpWebRequest.Create(new Uri("ftp://uri"));
fwr.ftpRequest.Method = WebRequestMethods.Ftp.UploadFile;
fwr.ftpRequest.Credentials = new NetworkCredential("user", "pass");

FileInfo ff = new FileInfo("localpath");
byte[] fileContents = new byte[ff.Length];

using (FileStream fr = ff.OpenRead())
{
   fr.Read(fileContents, 0, Convert.ToInt32(ff.Length));
}

using (Stream writer = fwr.GetRequestStream())
{
   writer.Write(fileContents, 0, fileContents.Length);
}

FtpWebResponse frp = (FtpWebResponse)fwr.GetResponse();
Response.Write(frp.ftpResponse.StatusDescription); 
```

[参考](http://www.asp.net/LEARN/videos/video-448.aspx) [1 参考 2](http://wiki.asp.net/page.aspx/283/ftpwebrequest/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T11:27:21.187

您必须为 FTP 协议使用特定类，例如 FtpWebRequest，它具有像 RequestUri 这样的 Uri 属性。

你应该在这些类中搜索我认为的 Uri 解析器。

# c++ - 错误 C2039：“memchr”：不是“全局命名空间”的成员

> ID：531916
> 
> 赞同：17
> 
> 时间：2009-02-10T11:23:11.773
> 
> 标签：c++

自从我在标准 <cstring> 头文件中无缘无故地收到此错误以来已经有一段时间了。谷歌搜索带来了许多答案，但没有一个有效。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-10T11:26:03.810

好的，我自己修好了。这是一个愚蠢的错误！我在一个库项目中有一个名为“String.h”的文件，该文件被 <cstring> 标头拾取。可能是因为我已将 <String.h> 的路径添加为我的测试项目中的附加包含目录（我收到此错误。）希望这对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:33:46.223

您的编译器可能（正确地）将 memchr 函数放置在 C++ std 命名空间中。尝试使用 std:: 为 memchr 调用添加前缀，如果失败，请发布导致问题的代码。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-02-10T20:35:54.610

当您想避免此类错误时，预处理器定义非常方便。

```
//whatev.h
#ifndef WHATEV
#define WHATEV

// your code here

#endif 
```

# java - JYaml：转储对象而不包括类名

> ID：531920
> 
> 赞同：1
> 
> 时间：2009-02-10T11:23:34.877
> 
> 标签：java, yaml, jyaml

我有一个`ArrayList`对象被转储到 YAML 字符串中，并且一直在比较 JYaml 和 SnakeYaml 在处理此问题时的性能。

```
 ArrayList<HashMap> testList = new ArrayList<HashMap>();
    HashMap<String, String> testMap1 = new HashMap<String, String>();
    HashMap<String, String> testMap2 = new HashMap<String, String>();

    testMap1.put("1_1", "One");
    testMap1.put("1_2", "Two");
    testMap1.put("1_3", "Three");

    testMap2.put("2_1", "One");
    testMap2.put("2_2", "Two");
    testMap2.put("2_3", "Three");

    testList.add(testMap1);
    testList.add(testMap2);

    System.out.println(jYaml.dump(testList));
    System.out.println(snakeYaml.dump(testList)); 
```

JYaml 的输出包括序列化对象的类名，而 SnakeYaml 的输出不包括：

JYaml 输出：

```
- !java.util.HashMap
  1_1: One
  1_3: Three
  1_2: Two
- !java.util.HashMap
  2_1: One
  2_2: Two
  2_3: Three 
```

SnakeYaml 输出：

```
- {'1_1': One, '1_3': Three, '1_2': Two}
- {'2_1': One, '2_2': Two, '2_3': Three} 
```

我更喜欢 SnakeYaml 更“干净”的无类名输出，因为这更适合语言中立的环境。

我更喜欢 JYaml 的*速度*。序列化/反序列化时间随着正在处理的数据量 *线性*增加，而SnakeYaml 则*呈指数增长。*

我想强迫 JYaml 给我无类名的输出，但是对于如何实现这一点我很迷茫。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-02-10T21:22:58.163

你如何测量速度？你是什​​么意思'数据量'？它是 YAML 文档的大小还是文档的数量？

JYaml 输出**不正确**。根据规范，数字中的下划线被忽略并且 1_1 = 11（至少对于 YAML 1.1）。因为它实际上是一个字符串而不是一个整数，所以表示应该是：

*   '1_1'：一个

或规范地

*   !!str "1_1": !!str "一"

否则在解析文档时，它将创建 Map< **Integer** , String> 而不是 Map< **String** , String>

JYaml 有许多未解决的问题并且没有实现完整的 YAML 1.1

JYaml 可能确实更快，但这是由于简化的解析和发出。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-02-19T16:24:39.983

检查 SnakeYAML 最新源。[现在可以](http://trac-hg.assembla.com/snakeyaml/wiki/Documentation#ImplicitTypes)（与 JYaml 中相同）忽略隐式类型并始终将标量解析为字符串。这快了几倍。查看[此处](http://trac-hg.assembla.com/snakeyaml/browser/src/test/java/org/yaml/snakeyaml/StressTest.java)和[此处](http://trac-hg.assembla.com/snakeyaml/browser/src/test/java/org/yaml/snakeyaml/NoRegularExpressionsTest.java)以了解如何使用新功能。

（在关闭正则表达式的情况下，序列化/反序列化时间随着正在处理的数据量线性增加。）

# complexity-theory - 函数的复杂度

> ID：531932
> 
> 赞同：0
> 
> 时间：2009-02-10T11:27:18.377
> 
> 标签：complexity-theory

什么是时间和空间复杂度：

```
int superFactorial4(int n, int m)
{
    if(n <= 1)
    {
        if(m <= 1)
            return 1;
        else 
            n = m -= 1;
    }

    return n*superFactorial4(n-1, m);
} 
```

它通过将 n 的值减 1 直到等于 1 来递归运行，然后它将 m 的值减 1 或在 m 等于 1 的情况下返回 1。

我认为复杂性取决于 n 和 m，所以可能是 O(n*m)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T11:32:49.770

时间复杂度为`O(n+m^2)`，空间复杂度相同。

推理：对于固定的值`m`，函数`n`对自身进行递归调用，每个都做恒定的工作，所以固定调用的复杂度`m`是`n`。现在，当 n 达到零时，它变成`m-1`并且`m`变成`m-1`了。因此，下一个固定 m 阶段将采用`m-1`，下一个`m-2`，依此类推。所以你得到一个`(m-1)+(m-2)+...+1`总和`O(m^2)`。

空间复杂度是相等的，因为对于每个递归调用，递归都占用恒定空间，并且您永远不会从递归返回，除非在结尾处，并且没有尾递归。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T11:33:27.893

实际上，对我来说，它看起来更接近 O(N+m^2)。n 仅用于第一个“循环”。

此外，在任何不进行尾调用优化的语言中，空间复杂度都可能“失败”。在支持优化的语言中，空间复杂度更像 O(1)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-09-23T14:42:06.690

使用递归伪代码的阶乘函数的时间复杂度：

```
int fact(n)
{ 
   if(n==0)
   { 
      return 1;
   }
   else if(n==1)
   {
        return 1;
   }
   else if
   {
      return n*f(n-1);
   }
}

time complexity;     
let T(n) be the number of steps taken to compute fact(n).

we know in each step F(n)= n*F(n-1)+C

F(n-1)= (n-1)*F(n-2)+c

substitute this in F(n), we get

F(n)= n*(n-1)*F(n-2)+(n+1)c 
```

现在使用大 o 表示法我们可以说

```
F(n)>= n*F(n-1)
F(n)>= n*(n-1)*F(n-2)
.
.
.
.
.
F(n)>=n!F(n-k)

T(n)>=n!T(n-k)

n-k=1;
k=n-1;

T(n)>=n!T(n-(n-1))
T(n)>=n!T(1)
since T(1)=1
T(n)>=1*n! 
```

现在它的形式是

```
 F(n)>=c(g(n)) 
```

所以我们可以说使用递归的阶乘的时间复杂度是

```
T(n)= O(n!) 
```

# c++ - 如何使用 Visual Studio 2005 设置 Google C++ 测试框架 (gtest)

> ID：531941
> 
> 赞同：83
> 
> 时间：2009-02-10T11:32:28.553
> 
> 标签：c++, visual-studio, unit-testing, visual-studio-2005, googletest

它没有在网站上记录，人们似乎在设置框架时遇到了问题。有人可以展示示例项目设置的分步介绍吗？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2010-11-19T04:48:15.783

（这些说明使测试框架适用于 Debug 配置。将相同的过程应用于 Release 配置应该非常简单。）

**获取 Google C++ 测试框架**

1.  下载最新的[gtest 框架](http://code.google.com/p/googletest/downloads/list)
2.  解压到`C:\gtest`

**构建框架库**

1.  `C:\gtest\msvc\gtest.sln`在 Visual Studio 中打开
2.  将配置设置为“调试”
3.  构建解决方案

**创建和配置您的测试项目**

1.  创建一个新的解决方案并选择模板 Visual C++ > Win32 > Win32 Console Application
2.  右键单击新创建的项目并选择属性
3.  将配置更改为调试。
4.  配置属性 > C/C++ > 常规 > 附加包含目录：添加`C:\gtest\include`
5.  配置属性 > C/C++ > 代码生成 > 运行时库：如果您的代码链接到运行时 DLL，请选择多线程调试 DLL (/MDd)。如果没有，请选择多线程调试 (/MTd)。
6.  配置属性 > 链接器 > 常规 > 附加库目录：添加`C:\gtest\msvc\gtest\Debug`或`C:\gtest\msvc\gtest-md\Debug`，具体取决于 gtestd.lib 的位置
7.  配置属性 > 链接器 > 输入 > 附加依赖项：添加`gtestd.lib`

**验证一切正常**

1.  `main()`在包含该函数的测试项目中打开 cpp 。
2.  粘贴以下代码：

    ```
    #include "stdafx.h"  
    #include <iostream>

    #include "gtest/gtest.h"

    TEST(sample_test_case, sample_test)
    {
        EXPECT_EQ(1, 1);
    }

    int main(int argc, char** argv) 
    { 
        testing::InitGoogleTest(&argc, argv); 
        RUN_ALL_TESTS(); 
        std::getchar(); // keep console window open until Return keystroke
    } 
    ```

3.  调试 > 开始调试

如果一切正常，您应该会看到控制台窗口出现并向您显示单元测试结果。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-02-10T17:37:13.247

Arlaharen 所说的基本上是正确的，除了他遗漏了解释您的链接器错误的部分。首先，您需要在*没有*CRT 作为运行时库的情况下构建您的应用程序。无论如何，您应该始终这样做，因为它确实简化了您的应用程序的分发。如果您不这样做，那么您的所有用户都需要安装 Visual C++ 运行时库，而那些不这样做的用户会抱怨他们的系统上缺少神秘的 DLL……因为链接需要额外的几百 KB静态的 CRT，您在以后的支持中可以省去很多麻烦（相信我——我已经学会了很难！）。

无论如何，要做到这一点，您需要转到目标的属性 -> C/C++ -> 代码生成 -> 运行时库，并且需要为您的发布版本设置为“多线程”，为您的发布版本设置为“多线程调试”你的调试版本。

由于 gtest 库是以相同的方式构建的，因此您需要确保链接到它的正确版本*，*否则链接器将拉入运行时库的另一个副本，这是您看到的错误（顺便说一句，这个无论您是否使用 MFC，都不应该有所作为）。您需要将 gtest 构建为**Debug 和 Release**模式并保留两个副本。然后，在 Release 构建中链接 gtest.lib/gtest_main.lib，在 Debug 构建中链接 gtestd.lib/gtest_maind.lib。

此外，您需要确保您的应用程序指向存储 gtest 头文件的目录（在属性 -> C/C++ -> 常规 -> 附加包含目录中），但如果遇到链接器错误，我假设您已经设法使这部分正确，否则您将首先处理更多编译器错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-08-25T04:02:32.323

我做了一个关于设置的视频教程： [http ://www.youtube.com/watch?v=mzSzwQOmMRs](http://www.youtube.com/watch?v=mzSzwQOmMRs)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-10T12:36:00.677

构建了 gtest，这就是我所做的：

1.  将 \mypath\gtest-1.0.1\Debug（或 Release）添加到 Common Properties->Linker->General->Additional Library Directories
2.  将 gtest.lib 和 gtest_main.lib 添加到 Common Properties->Linker->Input->Additional Dependencies

之后，我只需根据需要使用 TEST 或 TEST_F 编写测试，并将它们与我的 main 函数一起编译：

```
int main(int argc, char** argv)
{
    testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-25T23:51:20.440

如果您不想编写自己的 main() 进行测试，可以使用 gtest_main.lib 中定义的 main() 函数，但是在 VS2012 中会出现链接器错误“必须定义入口点”。在您的测试项目中，将 ProjectProperties->Linker->System->SubSystem 设置为“Console”，因为这将强制 VS2012 寻找一个名为“main()”的入口点，并在 gtest_main.lib 中找到它（前提是您已经链接它正确）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-14T07:01:56.120

在 Microsoft Visual Studio 中，错误配置的运行时库类型会导致链接错误。

VS 2005（和 2008）默认使用多线程 DLL 或多线程调试 DLL。但谷歌测试库默认使用多线程或多线程调试运行时。

因此，为谷歌测试库选择合适的运行时库类型。（在配置属性 -> 代码生成 -> 运行时库中）。

# sql - Ms-Access 查询被自动删除。可能是什么原因？

> ID：531943
> 
> 赞同：1
> 
> 时间：2009-02-10T11:32:57.287
> 
> 标签：sql, ms-access, vba, ms-office

我在 MS-Access 中编写的一些查询会被自动删除。当我通过代码运行查询时，我收到了这个错误：

> 查询应该有一个目标字段

可能的原因是什么？

**解释**：我在 MS-access 中创建了一个查询。从代码中运行它。关闭数据库。再次启动它，现在对于该特定查询，它只显示`'SELECT ;'`。

奇怪的。我现在处于恐慌模式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T11:50:36.857

检查您的查询实际上是否在查询设计网格中有任何字段。当您在设计视图中打开查询时，您很可能会注意到它没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T15:33:30.423

当您不运行代码（但仍关闭并重新打开数据库）时，查询是否仍然存在？

如果是这样，我会怀疑您的代码中的某些内容正在覆盖查询。

# oop - 多重继承批评

> ID：531946
> 
> 赞同：2
> 
> 时间：2009-02-10T11:33:44.400
> 
> 标签：oop, multiple-inheritance

我正在研究多重继承的概念（自从我愤怒地编写 C++ 代码以来已经快 10 年了，并且只是在学术上对这个概念感兴趣）。我在维基百科上找到了这个[参考](http://en.wikipedia.org/wiki/Multiple_inheritance#Criticisms)。

他们列出的对 MI 的一个批评是“不能从一个类中显式地多次继承”。我对这个声明感到困惑，并且不能 100% 确定这是指什么。

当然，类继承描述了一个类的结构，并且从同一个类多次继承只会重复同一个类契约，所以我看不出它会给批评带来什么好处。显式继承会假设类函数和属性的多个实例吗？

我想了解这种批评指的是什么，以及为什么它隐含地不适用于启用多重继承的语言。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T12:49:44.483

这称为[钻石问题](http://en.wikipedia.org/wiki/Diamond_problem)。大多数允许 MI 的现代语言对此都有解决方案。

简而言之，你有这个类树：

```
class A { public int f = 0; };

class B extends A { f = 1; };

class C extends A { f = 2; };

class D extends B, C {}; 
```

Df 会打印什么？如果你给 Df 赋值，它应该存储在哪里？两个字段 B(A).f 和 C(A).f 应该合并为一个还是应该分开？如果在 B 和 C 中覆盖 A 的方法 x，Dx() 应该做什么？两个都叫？按什么顺序？返回值呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:52:33.700

同样，我已经 5 年多没有愤怒地编写 C++ 了，现在已经切换到 C#。我真的不记得我是否经常使用多重继承，但我不会错过它，特别是因为我可以对接口进行编码并且这些天我更多地使用组合。

但是，在[有史以来最好的 OO 书籍中](https://rads.stackoverflow.com/amzn/click/com/0136291554)- 可能 ;) - Betrand Meyer 很好地捍卫了多重继承。[他在这里](http://www.eiffel.com/general/column/2006/October.html)也做了类似的防御。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T11:53:16.957

我认为它们的意思是类 Car 不能从它的四个轮子继承（例如，继承类 Wheel 的四倍）。[参见同一维基百科页面上的 C++ 节]

但是，我认为这种“省略”实际上是一个积极的特征，因为继承是为了表达子类型，而没有“单一类型的多个子类型”。这种“显式多重继承”不会比简单的组合更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T12:22:34.267

我认为问题在于那篇特定的维基百科文章。它包含不止一个尴尬或模糊的陈述，例如这些珠宝：

> Tcl 允许多个父类——它们的序列会影响类成员的名称解析。

和

> 然而，这六种语言允许类从多个接口继承，重新创建了一些提到的问题，同时避免了其他问题。

坦率地说，我不知道作者在您问题中的这句话是什么意思。这只是一篇写得不好的文章中含糊不清的另一个例子，恕我直言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T13:31:05.757

多重继承是面向对象编程的 GOTO。它的出现是因为早期 OOP 语言（C++ 等）采用的方法。它在右手中效果很好，但在其他大部分时间里它会让人困惑。

OOP 的主要目标之一是重用行为。原来这是一个嵌合体。在某些情况下很有用，但在其他情况下，我们真正感兴趣的是定义对象如何交互。看看设计模式中有多少模式使用接口而不是继承。

实现接口，然后是显式聚合是执行与多重继承相同的事情的更清晰、更易于维护的方式。几乎所有的 OOP 都有一些定义接口的方法，几乎​​所有的 OOP 都可以将对象聚合在一起。然而，OOP 以微妙的不同方式处理多重继承引发的问题（钻石问题等）。就像 GOTO 一样，当您使用多重继承查看代码时，不清楚发生了什么。然而，就像 GOTO 一样，它在不同的情况下很有用。

对我来说，使用任何困难的语言结构的主要考虑因素是我是否必须长期维护应用程序。如果我这样做了，那么即使现在需要更多的编程，我也会选择最清晰、更容易维护的方法。像其他一切一样，这是一个判断电话。请注意，在大多数情况下，我们最终会坚持使用我们开发的程序比我们想象的要长得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:00:03.090

实际上，在 C++ 中，一个类*可以*从同一个类多次继承：

A类{}；

B类：公共A（）；

C类：公共A（）；

类 D：公共 B，公共 C {}；

现在 D 以 A 的两个副本结束。这通常被认为是“一个坏主意”，C++ 提供了虚拟继承来控制它。

# .net - .NET 中的 .resx 和 .config 文件有什么区别？

> ID：531954
> 
> 赞同：4
> 
> 时间：2009-02-10T11:37:30.973
> 
> 标签：.net, configuration, localization, configuration-files

我应该什么时候使用 .resx 文件，什么时候使用 .config 文件？

两者在使用方面的基本区别是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T11:44:58.240

如果您希望在页面中有一些文本以不同的语言显示，或者能够在不重新编译应用程序的情况下进行修改，则可以将其放入资源文件中。

配置文件包含应用程序配置。配置文件是保存信息的（更）安全位置，应尽可能小。每个应用程序实例（或至少项目）也只有一个配置文件，而您可能有许多资源文件，例如，一个 Web 项目可能每个网页都有一个资源文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:39:06.103

resx 用于可本地化的资源。对于非字符串资源，您还需要它们。.config，顾名思义就是配置信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T11:42:50.400

对适用于所有人的应用程序设置使用配置，对可能因语言/文化而异的资源数据和信息（例如标签和错误字符串）使用 resx

# c++ - 编辑器核心缓冲区类型和语法高亮

> ID：531957
> 
> 赞同：2
> 
> 时间：2009-02-10T11:37:46.730
> 
> 标签：c++, vim, editor, syntax-highlighting, buffer

我一直在考虑如何让编辑器核心功能明智地兼容 vim，类似于 yzis。

最大的问题是使用什么缓冲区类型。

要求是：

*   实现快速语法高亮的可能性，在它之上的正则表达式。
*   在单个文件中实现多个语法突出显示的可能性。类似于 textmates 范围
*   删除插入上的正确移动标记。以便他们在列中正确调整。不像在vim中。
*   处理并突出显示至少 100 mb 的文件，而不会出现太大的问题和内存开销。

可能的缓冲区类型：

*   间隙缓冲区
*   基于行的编辑

我读到间隙缓冲区会在较长时间运行时导致相当大的内存碎片。此外，emacs 语法高亮引擎非常慢。（不知道为什么，可能与缓冲区类型无关）

所以问题：

1.  哪种缓冲区类型最适合快速编程编辑器？
2.  什么是快速/完整的正则表达式引擎？（也许这包括下一点）。TextMate 使用 oniguruma，这是一个明智的选择吗？
3.  什么是快速语法高亮引擎？
4.  关于标记和语法高亮。emacs 覆盖如何工作，它们有帮助吗？

谢谢，礼萨

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T16:18:49.620

一个好的文本编辑器应该对程序员可能做的各种工作都有用，包括打开有时可能有几 GB 大小的文件。因此，我不建议将所有内容都缓存在 RAM 中的思维定势。

我建议设置一个表示文件的切片搜索树，其中单个切片可能是：

1.  对磁盘上实际文件中字节范围的引用，或
2.  对已编辑“页面”的引用。

当您打开一个文件时，您首先将单个项目插入到树中，这只是一个代表整个文件的范围，例如对于 10-MiB 文件：

```
std::map<size_t, slice_info> slices;
slices[0].size = 10*1024*1024; 
```

当用户编辑文件时，在编辑点周围创建一个合理大小的“页面”，比如 4 KiB。树在那个点被拼接。在示例中，编辑点位于 5 MiB：

```
size_t const PAGE_SIZE = 4*1024;
slices[0].size = 5*1024*1024;
slices[5*1024*1024].size = PAGE_SIZE;
slices[5*1024*1024].buffer = create_buffer(file, 5*1024*1024, PAGE_SIZE);
slices[5*1024*1024 + PAGE_SIZE].size = 5*1024*1024 - PAGE_SIZE 
```

您可以将内存映射文件用于只读缓冲区（源文件）和复制的可编辑缓冲区（后者将放置在临时目录中）。如果编辑器崩溃，这也允许恢复。

使用固定大小的页面将大大减少内存堆的碎片，因为所有块都具有相同的大小，并且插入文本永远不需要移动超过 4 KiB 的数据。

这是一个简化的描述，给出了一般的想法，而不涉及太多的细节。真正的实现很可能需要更复杂，例如允许页面中的可变数据量以应对溢出的页面，并将许多小切片合并在一起，以便在大文件中运行正则表达式替换不会创建太多许多小缓冲区。可能需要对树中应该同时拥有的切片数量进行限制，但关键是当您开始在某处插入时，您应该确保使用的切片不太大。

对于正则表达式，只要整个编辑器在运行时不挂起，我认为性能不会有太大问题。试试[Boost.Regex](http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/index.html "升压正则表达式")，它很可能足够快满足您的需求，而且它也足够通用，可以插入您需要的任何缓冲策略。

这同样适用于语法高亮，如果你在后台运行它，它不会在用户打字时对他造成太大的干扰。您可以在这里使用切片方法为您带来好处：

*   每个切片都可以有一个互斥锁，可以在编辑操作期间锁定，从而允许语法突出显示或“智能感知”类型分析在后台线程中运行。
*   您可以存储语法高亮引擎的状态，这样每当您在切片中进行编辑时，您都可以从该切片的开头重新开始语法高亮，而不是从文件的开头。

我不知道有任何独立的语法高亮引擎，但它们通常基于正则表达式替换（参见例如 vim 中的语法高亮文件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T15:20:29.767

您可以使用 Scintilla 类。您的视图可以从 Scintilla 视图派生，它提供语法突出显示。

# url - 获取用户在使用 .htaccess 时输入的 URL 字符串

> ID：531965
> 
> 赞同：0
> 
> 时间：2009-02-10T11:40:48.533
> 
> 标签：url, .htaccess, redirect, vbscript, url-rewriting

我目前正在使用 htaccess 文件来重定向用户

```
 detail.asp?CategoryID=XX&SubCategoryID=XX&ProductID=XX 
```

至

```
 catid-XX-subcatid-xx-productid-xx 
```

但我现在需要检查他们是否到达了正确的页面。我通过检查查询字符串值是否正确来做到这一点。但是我宁愿检查用户是否到达

```
 catid-XX-subcatid-xx-productid-xx 
```

这样 Google 就不会索引重复的内容。

所以我想知道是否有一种方法可以在 htaccess 重写之前从 URL 栏中找出字符串。

如果我在页面上

```
 catid-XX-subcatid-xx-productid-xx 
```

然后使用 VBScript，如果我检查

```
 Request.ServerVariables("URL") & Request.ServerVariables("QUERY_STRING") 
```

我明白了

```
 detail.asp?CategoryID=XX&SubCategoryID=XX&ProductID=XX 
```

有什么方法可以获取正确的 URL 字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:59:59.340

环境变量`REQUEST_URI`应包含请求的 URI。

* * *

您可以尝试使用[`PATH_INFO`](http://httpd.apache.org/docs/2.2/mod/core.html#acceptpathinfo)ASP 并解析请求的 URI 路径：

```
RewriteRule !^detail\.asp detail.asp%{REQUEST_URI} [L] 
```

然后，请求的 URI 路径应在以下位置可用：

```
Request.ServerVariables("PATH_INFO") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T11:56:57.120

这让我想起了这样的事情；

```
var i = 1+1;
/* lets double check to make sure the cpu has calculated it right.. 
   just in case, I mean, you never know... */

if (i != 2) return ZOMG END OF THE WORLD!! 
```

# sql - Oracle 10g express 主页没有出现

> ID：531969
> 
> 赞同：10
> 
> 时间：2009-02-10T11:42:21.603
> 
> 标签：sql, oracle, oracle-xe

我安装了Oracle 10g express。安装很顺利，就是首页打不开。我可以使用 sqlplus 进行连接，但不能使用 Sql Developer。我检查了 tnsnames.ora 和 listener.ora 一切看起来都很好。侦听器也已启动。我总是可以重新安装并查看。但我想最好问问原因。

关于主页。这是浏览器中出现的地址。localhost:8080 [http://127.0.0.1:8080/apex](http://127.0.0.1:8080/apex) 我做了一个netstat，看看8080是否有端口冲突，但是那个端口没有被使用。

有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T22:12:11.150

是的。它实际上是 XE Oracle 论坛上的一个常见问题解答。首先，您可以使用连接到 Oracle

```
sqlplus user/pass 
```

如果是这样，Oracle 正在运行（这似乎是您的情况，但可能不适用于有类似问题的未来读者）。如果没有，你可以试试

```
sqlplus / as sysdba
startup 
```

Oracle 启动后，通过 sqlplus user/pass@xe 检查监听器是否可以看到 Oracle 实例。如果没有，则要么监听器未启动，要么“监听器不知道服务”。确保侦听器已启动（lsnrctl，然后启动）。确保数据库已向侦听器注册

```
sqlplus / as sysdba
alter system register; 
```

现在您应该可以使用“@xe”语法进行连接了。值得验证嵌入式 PL/SQL 网关设置为使用 8080 端口

```
select dbms_xdb.GETHTTPPORT from dual; 
```

在 Windows 上，您可以使用 netstat -ab 查看 tnslsnr.exe 是否正在侦听端口。

然后我建议查看浏览器设置（特别是任何可能将您的请求转发到不知道如何处理的机器的代理设置）和防火墙（很可能设置为忽略或隐藏对端口的任何访问）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-21T09:48:02.127

检查你的windows防火墙，如果它在它阻止主页的打开。要么关闭windows防火墙，要么允许以下端口：1521：Oracle数据库监听器

2030：适用于 Microsoft 事务服务器的 Oracle 服务

8080：用于 Oracle XML DB 和 Oracle Database XE 图形用户界面的 HTTP 端口

请参阅以下 URL 中的软件要求：

[http://download.oracle.com/docs/cd/B25329_01/doc/install.102/b25143/toc.htm#BABEBCDB](http://download.oracle.com/docs/cd/B25329_01/doc/install.102/b25143/toc.htm#BABEBCDB)

它对我有用！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-06T20:39:35.907

我有同样的问题。我试过这个，它解决了我的问题... 1.转到开始->运行
2.键入 services.msc 并按回车
3.在打开的小程序中，向下滚动（在右窗格中）找出“ OracleServiceXE”并右键单击它。4.在一般选项卡do->>>启动类型“自动”，然后单击“启动按钮”。5\. 对选项“OracleXETNSListener”重复步骤 4。关闭窗口。

现在，我希望问题应该得到解决......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T05:23:09.820

谢谢大家的回复。我终于想出了如何解决这个问题，但不是真正的根本原因。

问题 1 - 无法登录到 oracle 管理控制台。问题是在 IE 内网站点中没有添加 127.0.0.1。转到工具>互联网选项>安全>本地Intranet站点>高级>添加[http://127.0.0.1:8080/apex](http://127.0.0.1:8080/apex)。

在此之后它工作正常。但是，如果我再次回到同一个地方并查看这些网站，我有时会找不到我添加的网址......不知道为什么会这样。可能是某些公司的安全出了问题。无论如何，管理控制台现在正在出现。

问题 2 - 无法使用 SQL Developer 连接。在我解决了问题 1 之后，这也神奇地起作用了。我仍然不知道 IE 中的安全设置如何影响 SQL Developer？对此有何评论？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T22:20:16.060

试试这个（我假设是 Windows 系统）

使用

```
netstat 
```

没有任何其他参数会告诉你端口 8080 是否已经打开。

你也可以试试这个：

```
telnet localhost 8080 
```

如果服务器应答（屏幕变为空白 [或黑色]），则服务器已启动并正在运行。

尝试使用您的主机名而不是 localhost。

查看您是否使用代理而不跳过本地地址。

您还可以查看启动主页的可执行文件是什么，看看它是否可以成功启动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T12:55:21.260

对于 Windows 8，只需单击`Get Started With OracleXE...`。当 Internet Explorer 打开时，选择图标中的`View on the desktop`选项`Page View`（带有扳手的图标）。

您现在应该可以查看您的页面了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T11:59:09.253

我遇到了类似的问题，我能够使用终端连接到 SQLPLUS，但是在浏览器中访问时，它显示了您所描述的错误。所以，我回到终端并使用

> 启动

它解决了我的问题。可能是这种情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-03T17:31:59.927

嘿伙计们，如果您使用 IE7 (explorer7)，那么您在使用 10g 时会遇到某些问题，例如不显示主页。

# svn - 尝试设置 Apache+svn，但遇到了麻烦。http://localhost 不起作用

> ID：531972
> 
> 赞同：0
> 
> 时间：2009-02-10T11:43:03.427
> 
> 标签：svn, ubuntu, apache2

我正在运行 Ubuntu 8.10，并且我已经尽可能快地安装了必要的软件包。在系统 > 管理 > 服务下，我在列表中看到“Webserver (Apache2)”。

谷歌搜索表明 /etc/hosts 文件可能存在问题，没有一行读取“127.0.0.1 localhost”，但我检查了该文件，它就在那里。我不知道下一步该做什么。

更清楚地说，尝试访问[http://localhost/](http://localhost/)不会加载任何页面。浏览器只是继续加载，但页面永远不会出现。

这是我的 access.log：

```
192.168.1.101 - - [09/Feb/2009:09:59:54 -0800] "HEAD / HTTP/1.0" 200 - "-" "-"
192.168.1.101 - - [10/Feb/2009:02:10:26 -0800] "HEAD / HTTP/1.0" 200 - "-" "-" 
```

和error.log（主要是我在重置，试图通过摆弄它来让它工作）

```
[Mon Feb 09 08:17:47 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Mon Feb 09 15:40:27 2009] [notice] caught SIGTERM, shutting down
[Mon Feb 09 15:42:13 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Mon Feb 09 15:58:27 2009] [notice] caught SIGTERM, shutting down
[Mon Feb 09 15:59:57 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Mon Feb 09 16:31:12 2009] [notice] caught SIGTERM, shutting down
[Mon Feb 09 16:32:45 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Mon Feb 09 16:46:26 2009] [notice] caught SIGTERM, shutting down
[Mon Feb 09 16:49:53 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Mon Feb 09 22:54:51 2009] [notice] caught SIGTERM, shutting down
[Mon Feb 09 22:58:19 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 00:02:04 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 00:04:54 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 00:18:24 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 00:18:25 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 00:28:58 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 00:28:59 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 00:32:10 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 00:32:11 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 00:43:45 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 00:43:46 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 00:45:51 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 00:45:52 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 02:21:34 2009] [notice] SIGUSR1 received.  Doing graceful restart
[Tue Feb 10 02:21:34 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 02:24:39 2009] [notice] SIGUSR1 received.  Doing graceful restart
[Tue Feb 10 02:24:40 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 04:00:33 2009] [notice] SIGUSR1 received.  Doing graceful restart
[Tue Feb 10 04:00:33 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 04:29:03 2009] [notice] SIGUSR1 received.  Doing graceful restart
[Tue Feb 10 04:29:03 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 04:31:12 2009] [notice] SIGUSR1 received.  Doing graceful restart
[Tue Feb 10 04:31:12 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 04:39:45 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 04:41:23 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 04:48:42 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 04:48:43 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations
[Tue Feb 10 04:48:45 2009] [notice] caught SIGTERM, shutting down
[Tue Feb 10 04:48:50 2009] [notice] Apache/2.2.9 (Ubuntu) DAV/2 SVN/1.5.1 mod_ssl/2.2.9 OpenSSL/0.9.8g configured -- resuming normal operations 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T12:16:19.400

为了让 SVN 在 Ubuntu 下与 apache 一起工作，您需要：

*   安装正确的软件包
*   启用正确的 apache 模块
*   为 apache 提供一个工作配置文件
*   创建存储库

我已经在各种版本的 Ubuntu 和 Debian 下通过 apache 安装了 SVN，但从未使用最新的 Ubuntu。希望我的配置对你有帮助。

**安装正确的包**

确保您安装了以下软件包“libapache2-svn”和“subversion”。

**启用正确的 apache 模块**

转到文件夹“/etc/apache2/mods-enabled”并验证文件“dav_svn.conf”和“dav_svn.load”是否存在。如果它们丢失了，只需执行以下操作：

```
sudo a2enmod dav_svn 
```

**为 apache 提供一个工作配置文件**

这就是乐趣的开始。我决定为我自己的存储库使用虚拟主机，即使它对外界不可见。假设您决定在[http://svn.localhost/repos/](http://svn.localhost/repos/)下提供您的存储库。首先将以下条目添加到 '/etc/hosts'

```
127.0.0.1 svn.localhost 
```

然后为 apache 创建一个配置文件并将其保存到 '/etc/apache2/sites-enabled/' ：

```
<VirtualHost *>
    ServerName svn.localhost

    ErrorLog /var/log/apache2/svn-error.log
    CustomLog /var/log/apache2/svn-access.log combined

    <Location /repos>

        # Enable the repository
        DAV svn

        # Path to your repository
        SVNPath /home/subversion

        # The following allows for basic http authentication.
        AuthType Basic
        AuthName "Subversion Repository"
        AuthUserFile /etc/apache2/dav_svn.passwd

        # Allow anonymous read, but make committers authenticate themselves
        <LimitExcept GET PROPFIND OPTIONS REPORT>
            Require valid-user
        </LimitExcept> 

        # Have the network shares autocomit their modifications
        SVNAutoversioning on

        # Needed because Microsoft Web Folders defaults to a timeout of 120, a higher number will work better
        DAVMinTimeout 600

        #
        # Broken WebDAV for Windows XP
        #
        BrowserMatch "^WebDAVFS/1.[012]" redirect-carefully
        BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
        BrowserMatch "Microsoft-WebDAV-MiniRedir/5.1.2600" redirect-carefully
        BrowserMatch "^WebDrive" redirect-carefully
        BrowserMatch "^WebDAVFS" redirect-carefully

        <IfModule mod_headers.c>
            Header add MS-Author-Via "DAV"
        </IfModule>

        <IfModule mod_encoding.c>
            EncodingEngine on
            NormalizeUsername on
        </IfModule>
    </Location>

</VirtualHost> 
```

**创建存储库**

使用以下命令创建您的存储库：

sudo mkdir -p /home/subversion/ sudo svnadmin create /home/subversion/ sudo chown -R www-data:www-data /home/subversion/

如果您决定将存储库定位在不同的文件夹下，请确保更新配置文件中 /home/subversion/ 的 apache 设置。

使用命令 htpasswd 更新您的密码文件 /etc/apache2/dav_svn.passwd。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T11:50:25.403

如果我没记错的话，您可以配置 Apache 绑定到的网络接口，`localhost`默认情况下可能不包括在内。

您是否尝试过连接机器的外部主机名或 IP（例如`192.168.x.y`）？

[此外，尝试阅读本指南](http://ubuntuexperiment.wordpress.com/2008/11/10/installing-apache-php-mysql/)中针对 Ubuntu 8.10的“安装 Apache”部分。

# jquery - 如何在 jQuery 中设置滑块的值？

> ID：531973
> 
> 赞同：0
> 
> 时间：2009-02-10T11:43:57.823
> 
> 标签：jquery, slider

我的页面上有一个 jQuery 滑块，最小值为 -100，最大值为 100，startValue 为 0。我想提供一个重置按钮，它将滑块值重置为 0。

我找不到任何 setter 函数来做到这一点，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T11:54:23.693

如我所见，您可以获取或设置滑块的值：

```
$("#slider).slider('value', 0); 
```

[http://docs.jquery.com/UI/Slider/slider#.22value.22value](http://docs.jquery.com/UI/Slider/slider#.22value.22value)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T12:04:51.143

这会奏效吗？

```
$("#slider").slider("value",0); 
```

# c# - C# - 这个声明的字符串是否被视为常量？

> ID：531976
> 
> 赞同：6
> 
> 时间：2009-02-10T11:44:33.017
> 
> 标签：c#, clr, constants, readonly

帮我在这里解决一个争论。

这是：

```
SqlCommand cmd = new SqlCommand( "sql cmd", conn); 
```

处理方式与此完全相同：

```
const string s = "sql cmd";
SqlCommand cmd = new SqlCommand( s, conn); 
```

IE。如果我明确指出字符串 s 是一个常量，它会有所不同吗？

而且，如果不以同样的方式对待它，为什么不呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T11:47:46.330

在后一个片段中，不是*字符串*是 const 而是*变量*是 const。这与 C++ 中的 const 不太一样。（字符串在 .NET中*始终是不可变的。）*

是的，这两个片段做同样的事情。唯一的区别是，在第一种形式中，您也将拥有一个元数据条目`s`，如果变量是在类型级别声明的（而不是局部变量），那么其他方法也可以使用它。当然，由于字符串实习，如果您在其他地方使用“sql cmd”，您在内存中仍然只有一个字符串*对象*......但是如果您通过反射查看类型，您会发现 const 作为字段元数据与第二个片段，如果它被声明为一个常量字段，如果它只是一个局部变量，如果你构建一个，它将在 PDB 文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T11:49:10.790

a 的值`const`总是直接写入调用者，所以是的，它们是相同的。

此外，在源代码中找到的编译器实习生字符串 -`const`如果您多次使用相同的字符串（纯粹从维护角度来看 - 两种方式的结果都是相同的），a 会很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T11:47:06.973

SqlCommand 的构造函数不会“看到”任何差异，因此会以相同的方式进行操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T11:47:43.990

是的，它们完全一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T12:01:10.403

Yes, feel free to use [Reflector](http://www.red-gate.com/products/reflector/) to look at the assembly, const strings will be replaced with literal strings on compilation. I also have a [blog post](http://www.stum.de/2009/01/14/const-strings-a-very-convenient-way-to-shoot-yourself-in-the-foot/) about this to safe you the work of using Reflector :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T11:49:03.210

我不是 100% 确定这一点，但我敢打赌它是一样的。

const 只会确保您不会重新评估变量，但这是可以在编译时完成的。

Morover，字符串是不可变的，所以我认为声明变量与否不会有任何区别。

然而，明确的证明将是研究两种情况下生成的 IL 代码。

# sql - SQL 复合键查询

> ID：531991
> 
> 赞同：2
> 
> 时间：2009-02-10T11:49:03.707
> 
> 标签：sql, aggregate-functions, composite-key

再次引用此[SQL products/productsales](https://stackoverflow.com/questions/501347/sql-products-productsales)

当主键由两列而不是一列组成时，我怎么能做这样的事情？

所以 products 有两列作为 PK，productsales 有两列作为 FK。

这是使用 1 列键的解决方案：

```
SELECT p.[name]
FROM products p
WHERE p.product_id in (SELECT s.product_id
    FROM productsales s
    WHERE s.[date] between @dateStart and @dateEnd
    GROUP BY s.product_id
    HAVING Sum(s.quantity) > @X ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T11:54:40.607

这些方面的东西可能会起作用

```
SELECT p.[name]
FROM products p
JOIN (SELECT s.key1, s.key2
    FROM productsales s
    WHERE s.[date] between @dateStart and @dateEnd
    GROUP BY s.product_id
    HAVING Sum(s.quantity) > @X ) as a on a.key1 = p.key1 and a.key2 = p.key2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T15:17:23.503

看起来上面有一些答案会起作用，但只是为了向您抛出另一个解决方案，以防它在您的情况下效果更好：

```
SELECT
     P.name
FROM
     Products P
WHERE
     EXISTS
     (
          SELECT
               *
          FROM
               ProductSales PS
          WHERE
               PS.product_id = P.product_id AND
               PS.date BETWEEN @date_start AND @date_end
          GROUP BY
               PS.product_id
          HAVING
               SUM(PS.quantity) > @cutoff_quantity
     ) 
```

此方法的性能往往比使用 Brownstone 先生给出的 GROUP BY 方法的 INNER JOIN 更差，但在某些情况下，取决于您的 @cutoff_quantity 值和表大小，它可能会执行得更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T11:58:03.920

也许这样的事情会做：

```
SELECT p.first_col_id,p.second_col_id 
FROM products p
JOIN productsales s
   ON s.first_col_id = p.first_col_id 
  AND s.second_col_id = p.second_col_id 
  AND s.[date] between @dateStart and @dateEnd
GROUP BY p.first_col_id,p.second_col_id 
HAVING Sum(s.quantity) > @X ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T12:01:42.257

尝试：

```
SELECT p.[name]
FROM products p
WHERE (p.product_key1, p.product_key2) in
   (SELECT s.product_key1, s.product_key2
    FROM productsales s
    WHERE s.[date] between @dateStart and @dateEnd
    GROUP BY s.product_key1, s.product_key2
    HAVING Sum(s.quantity) > @X ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T12:05:26.680

我喜欢这样做：

```
;WITH t 
     AS (SELECT s.product_id 
         FROM   productsales s 
         WHERE  s.[date] BETWEEN @dateStart AND @dateEnd 
         GROUP  BY s.product_id 
         HAVING Sum(s.quantity) > @X) 
SELECT p.[name] 
FROM   products p 
       JOIN t 
         ON p.pk1 = t.fk1 
            AND p.pk2 = t.fk2 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:02:29.243

一键重构

```
SELECT s.product_id, p.[name]
FROM products p JOIN productsales s ON p.product_id=s.product_id
WHERE s.[date] between @dateStart and @dateEnd
GROUP BY s.product_id, p.[name]
HAVING Sum(s.quantity) > @X ) 
```

两个键相同：

```
SELECT s.k1, s.k2, p.[name]
FROM products p JOIN productsales s ON (p.k1=s.k1 AND p.k2=s. k2)
WHERE s.[date] between @dateStart and @dateEnd
GROUP BY s.k1, s.k2, p.[name]
HAVING Sum(s.quantity) > @X ) 
```

# javascript - 我如何知道浏览器何时关闭？

> ID：531994
> 
> 赞同：1
> 
> 时间：2009-02-10T11:49:12.070
> 
> 标签：javascript, asp.net-2.0

我正在编写一个 ASP.NET 应用程序来跟踪用户的分数和信息（它是一个培训应用程序）到一个访问数据库，如果有人直接关闭浏览器我想显示一条警报消息。我的问题是我不能使用卸载事件，因为当我按下任何 ASP.NET 按钮时，就会发生卸载事件。我应该使用什么事件对 IE 和 FF 有效？我想处理事件浏览器关闭（X）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T12:10:04.530

[onbeforeunload](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)事件只会为您提供带有消息的确认框。你不能把更多的功能放进去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:54:39.420

您应该做的是让窗口卸载事件处理程序*和*注销按钮单击事件处理程序调用相同的注销方法。您不需要阻止用户并要求他们按下您的按钮，您的按钮应该只是做同样事情的另一种方式。

另外：你考虑过[SCORM](http://www.adlnet.gov/scorm/index.aspx)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T04:53:41.237

我认为其他人已经充分回答了您的具体问题，但 Tooney 提出了一些好的观点。扩展这些。您目前在哪里维护您的状态？分数是存储在 cookie 中，在服务器端会话中，还是在数据库中逐页保存。

假设这不是一个便宜且令人愉快的解决方案，那么我建议您考虑逐页保留结果，因为它可以最大限度地减少因过早退出（设计或意外）导致的信息丢失。当然，您随后需要一个过程来清理不完整的培训课程。

您仍然可以使用 onbeforeunload 函数来捕获用户退出，但我个人不喜欢仔细检查用户操作的 UI。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:15:29.333

不确定你知道你想在这里做什么。;-)

你想阻止用户在训练中的某个点之前完全关闭浏览器吗？如果是这样，您是否考虑过使用模态和最大化窗口？您应该能够在没有标题栏、按钮和菜单的情况下最大化窗口。

或者，如果您只想跟踪进度、分数或类似信息，则可以使用浏览器通过 JavaScript 处理的 cookie。请记住，这只会将数据保留在学生的一台机器上。

如果你只是想警告用户他即将离开培训课程，你可以使用[onbeforeunload](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)

# linux - 是否可以从linux控制台调用应用程序选择窗口（右键单击->打开方式->其他）？

> ID：531997
> 
> 赞同：2
> 
> 时间：2009-02-10T11:49:53.643
> 
> 标签：linux, console-application

在 Gnome/KDE 上，您可以选择要在哪个应用程序中打开文件（右键单击文件 -> 打开方式 -> 其他）。是否可以以这种方式打开文件，但从控制台？

例如：您打印“file.ext”，而不是在具体应用程序中打开，而是强制应用程序选择窗口，然后用户选择 - 启动选定的程序。

我试图弄清楚自己，但没有找到类似的东西。

“edit file.ext”不符合我的需要，因为它启动了首选应用程序，您无法选择哪个。而且在我的桌面上还显示：“错误：没有为类型“image/jpeg”找到“编辑”邮件封盖规则

那么，我是否能够从控制台强制打开那个“打开方式”窗口？如果是，你能说怎么做吗？在 windows 和 mac 上你都可以做这样的事情。

//编辑于 2009-02-10 14:17

非常感谢您的回答。命令将在程序代码中使用，所以很遗憾我可能无法制作一些额外的 bash 脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T12:35:46.187

对于 GNOME：

```
gnome-open <file> 
```

对于 KDE：

```
kfmclient exec <file> 
```

这些命令*应该*分别在 GNOME 或 KDE 的首选应用程序中打开`<file>`，尽管我没有安装任何一个来测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T12:45:18.517

Take a look at `man run-mailcap`, you can change or add selected applications for each mimetype modifying the `/etc/mailcap`, `~/.mailcap` files and some others.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T12:35:55.047

传统上，在 Unix 系统（因此也包括 Linux）上，您从控制台（而不是从 UI）启动应用程序。命令行（或控制台）希望您输入应用程序的名称，然后输入文件名（加上一些选项）。

这允许在 shell 脚本中使用应用程序（或命令）。

On Windows, there is no real console (the DOS box is just a reminiscence of the dark ages of MS DOS). So the MS developers came up with the idea to have the OS treat anything as a command. If it's not a real command or application, the OS will determine the file type (by extension on Windows and by some header information on Mac). For each file type, there will be an associated application in a look up table.

This is why on Windows, it appears that you can enter the name of a file on the console and you will get the application to edit that file.

If you want a quick way to fix this in the Unix console, create a script called "open" or "o" and use the file command with the option --mime to identify the file type. You can then use a [case statement](http://www.tech-recipes.com/rx/212/bourne_bash_shell_scripts_case_statement/) to launch your favorite editor.

As for the error about "mailcap rules": There is a file called "mailcap" on Unix where you can define abstract "commands" (open, edit, view, print) for file types. See the [mailcap man page](http://linux.about.com/library/cmd/blcmdl4_mailcap.htm).

# c++ - 有没有办法在 Windows 上的 C++ 中以编程方式设置环境路径？

> ID：531998
> 
> 赞同：19
> 
> 时间：2009-02-10T11:50:15.500
> 
> 标签：c++, winapi, path, environment-variables

有没有办法以编程方式（C++）设置全局 Windows 路径环境变量？

据我所知， putenv 只为当前应用程序设置它。
直接在注册表`(HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment)`中更改也是一种选择，但如果有的话我更喜欢 API 方法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-10T12:35:12.193

MSDN[说](http://msdn.microsoft.com/en-us/library/ms682653(VS.85).aspx)：

> 调用 SetEnvironmentVariable 对系统环境变量没有影响。**要以编程方式添加或修改系统环境变量，请将它们添加到 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment 注册表项，然后广播 WM_SETTINGCHANGE 消息，并将 lParam 设置为字符串“Environment”。**这允许应用程序（例如 shell）获取您的更新。请注意，此键中列出的环境变量的值限制为 1024 个字符。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-11T02:39:16.563

如前所述，要在*机器级别*更改 PATH只需更改此注册表项：

```
HLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment 
```

但您也可以通过更改此注册表项在*用户级别设置 PATH：*

```
HKEY_CURRENT_USER\Environment\Path 
```

您还可以通过将 application\Path 详细信息添加到此注册表项来在*应用程序级别设置 PATH：*

```
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T12:02:30.400

没有 API - 更改注册表就是这样做的方法。更改后的值将用于更改后开始的流程。

另外：请注意，正在运行的应用程序必须主动处理设置更改消息，并且许多（大多数？）不这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T12:12:36.600

如果您想通过注册表进行操作，您可能需要查看[该](http://www.codeproject.com/KB/applications/SetEnv.aspx)程序的源代码。

Microsoft 还提供了一个名为 setx 的小型命令行实用程序及其[资源工具包](http://www.microsoft.com/downloads/details.aspx?FamilyID=49ae8576-9bb9-4126-9761-ba8011fabf38&displaylang=en)，可让您执行此操作。顺便说一句，我认为常规的 set 命令只允许您定义本地环境变量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T12:43:49.550

是的，你是对的。您还需要在不注销的情况下影响这些设置

使用 SendMessageTimeout API 使用 SMTO_ABORTIFHUNG 将 borad 转换消息发送到所有窗口 SETTINGCHANGE 参数（LPARAM）“环境”，持续几毫秒（5000）。

这就是资源工具包提供的 setX.exe 所做的。*****`********