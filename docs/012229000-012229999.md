# StackOverflow 问答 12229000-12229999

# c# - 在 Nginx 上使用 HttpClient 发布数据。错误 411 C#

> ID：12229000
> 
> 赞同：0
> 
> 时间：2012-09-01T15:24:37.640
> 
> 标签：c#, post, nginx, httpclient

我正在测试引入新类的新 Framework .Net 4.5，例如 HttpClient。我正在尝试登录 vbulletin 论坛并发布主题。

它使用 WampServer 可以完美运行，但是当我尝试使用 Nginx 时出现 411 错误，需要 Content-Lenght。

这是我的代码：

```
HttpClient client = new HttpClient();

/* login part skipped, it works */

postData = new List<KeyValuePair<string, string>>();
postData.Add(new KeyValuePair<string, string>("do", "postthread"));
postData.Add(new KeyValuePair<string, string>("f", "8"));
postData.Add(new KeyValuePair<string, string>("loggedinuser", "1"));
postData.Add(new KeyValuePair<string, string>("message", "myMessage"));
postData.Add(new KeyValuePair<string, string>("subject", "mySubject : " + new Random().Next()));
postData.Add(new KeyValuePair<string, string>("securitytoken", secure_id));
postData.Add(new KeyValuePair<string, string>("vbseo_is_retrtitle", "1"));
postData.Add(new KeyValuePair<string, string>("vbseo_retrtitle", "1"));
postData.Add(new KeyValuePair<string, string>("posthash", posthash));
postData.Add(new KeyValuePair<string, string>("poststarttime", poststarttime));

HttpContent content = new FormUrlEncodedContent(postData);
HttpRequestMessage msg3 = new HttpRequestMessage(HttpMethod.Post, "http://localhost/newthread.php?do=postthread&f=8");

// Adding all headers from the resp2, containing cookie value to stay connected
// I think, here is the problem, when passing the 'Transfer-Encoding' and 'Transfer-EncodingChunked' values
foreach (var header in resp2.Headers)
   msg3.Headers.Add(header.Key, header.Value);

msg3.Content = content;
var resp3 = client.SendAsync(msg3).Result;
resp3.EnsureSuccessStatusCode();
string html = resp3.Content.ReadAsStringAsync().Result; 
```

当我看到 msg3.Content.Headers.ContentLength 时，我有一个值.. 所以我不明白为什么 Nginx 会抛出这个错误：/

谷歌搜索后，我看到了[http://wiki.nginx.org/HttpChunkinModule](http://wiki.nginx.org/HttpChunkinModule)但我不想修改服务器..

谢谢你的帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T16:57:25.347

我刚刚遇到了类似的问题，但就我而言，我将 Nginx 升级到了 1.4.x。

nginx 出现错误 411 有多种原因（[fix-nginx-411-length-required-error](http://www.lamnk.com/blog/computer/fix-nginx-411-length-required-error/)）

*   客户端发送了无效的“Content-Length”标头
*   客户端发送...没有“Content-Length”标头的方法
*   **客户端发送“Transfer-Encoding：chunked”标头**

在 nginx 1.3.9 之前，不支持“Transfer-Encoding: chunked”

# html - Html 实体到 Html 标签

> ID：12229003
> 
> 赞同：0
> 
> 时间：2012-09-01T15:24:51.023
> 
> 标签：html, encoding, web, wysiwyg, html-entities

我正在使用`wysiwyg`名为“ `niceEdit`”的文本编辑器。
当我想呈现从数据库中提取的内容时，html 标签采用[html 实体](http://www.w3schools.com/html/html_entities.asp)的形式。例如：`&lt;`

因此，结果（在网页中）可能类似于：

```
<b>hello world</b> 
```

代替：

> **你好世界**

转换它的简单/优雅的方法是什么？

PS
我在后端使用 JAVA（Play！框架）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:12:28.647

这是一种方法：http: [//jsfiddle.net/QSJxW/](http://jsfiddle.net/QSJxW/)

简而言之，您创建了一个不执行任何操作且没有提交按钮的表单。在表单中添加一个 textarea 并将所有代码放在 和`<textarea>`之间`</textarea>`。您可以使用 CSS 来设置文本区域的样式，使其看起来不像文本区域。

我的 jsFiddle 中有 2 个示例。一种无样式，一种有样式。如果将溢出：隐藏添加到 textarea CSS，它会关闭滚动。

希望这可以帮助！

辛西娅

# c++ - 为什么将对象插入向量会导致 C2679

> ID：12229004
> 
> 赞同：0
> 
> 时间：2012-09-01T15:24:56.643
> 
> 标签：c++, vector

抱歉，没有示例，所以我们必须在这里查看真实代码。发生的事情是，我有课`CItemElem`（注意这是一个旧的来源，请不要考虑匈牙利符号、类名等）。如下例所示，我正在尝试做同样的事情`CItemElem`

```
class A
{
public:
    int value;
};

int _tmain( int argc, _TCHAR* argv[] )
{
    std::vector<A> hold;
    A a;
    hold.push_back(a);
} 
```

尽管`CItemElem`编译器在尝试使用类时给了我 C2679

`vector<CItemElem>hold; CItemElem item; hold.push_back(item);`

`Error C2679: '=' binary :no operator found which takes a right-hand operand of type 'const CItemElem' (or there is no acceptable conversion)`

通过单击错误，它会将我带到`*_First = _Val;` 此功能上的这一行`xutility`

```
template<class _FwdIt,
    class _Ty> inline
    void fill(_FwdIt _First, _FwdIt _Last, const _Ty& _Val)
    {   // copy _Val through [_First, _Last)
    for (; _First != _Last; ++_First)
        *_First = _Val;
    } 
```

CItemElem 类太长且派生，因此我决定将其上传到 pastebin，而不是在这里粘贴大量代码。 [Pastebin：类 CItemElem 标题 (item.h)](http://pastebin.com/Kc4LwdeM)

请注意，CItemElem 派生自 CItemBase 并且重载了 = 运算符，它也通过 CItemBase = 运算符。这是来自`item.cpp`：

```
CItemElem& CItemElem::operator =( CItemElem & ie )
{
    CItemBase::operator =( ie ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T15:32:17.750

看起来好像没有`=`为`CItemElem`. STL 容器（例如`vector`）期望它们包含的内容具有某些属性，包括赋值运算符。如果可以修改类，可以加一个：

```
class CItemElem
{
...
public:

  CItemElem & operator=(const CItemElem &other)
  {
    // copy whatever must be copied
    x = other.x;

    return *this;
  }
} 
```

**编辑：**
我现在看到标题包含赋值运算符的声明：

```
virtual CItemElem&      operator = ( CItemElem & ie ); 
```

但签名是错误的——它不见了`const`。如果您可以更改它（在声明和定义中），它应该可以工作。

**编辑：**
如果你不能编辑基类，你有几个选择。可能最安全的方法是将代码从复制`CItemBase::operator=`到`CItemElem::operator=`. 不漂亮，但那是原作者的错；争论应该一直存在`const &`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T15:28:12.867

CItemElem 有`operator=(CItemElem&)`. 此函数不能接受`const`参数（正如编译器准确告诉您的那样）并且不符合`std::vector`作为元素类型的要求。不可能在`std::vector`.

# scala - 获取对具有冲突名称的外部函数的参数的引用

> ID：12229005
> 
> 赞同：5
> 
> 时间：2012-09-01T15:25:20.480
> 
> 标签：scala, scope

请考虑以下代码：

```
trait A {
  def a : Int
}

def f ( a : Int ) = {
  def a0 = a
  new A {
    def a = a0
  }
} 
```

问题很明显：这`def a0 = a`是一个典型的烦人的样板代码，当引入更多参数时情况只会变得更糟。

我想知道是否有可能以某种方式`a`在 trait 实例的声明中直接引用外部范围的变量，从而摆脱中间`a0`.

*请记住，不允许更改函数输入参数的名称，因为更改特征也是如此。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T15:54:30.997

我认为没有*直接*的方法可以做到这一点，因为它需要一些特殊的（假设的）标识符`thisMethod`。但是，根据您的上下文，可能有以下两种避免名称隐藏的方法：

(1) 将匿名类替换`A`为实现类：

```
case class AImpl(a: Int) extends A

def f(a : Int): A = AImpl(a) 
```

(2)`f`在抽象特征中定义并为其使用具体实现：

```
trait F {
  def f(a: Int): A
}

object FImpl extends F {
  def f(a0: Int): A = new A { val a = a0 }
}

def test(factory: F): A = factory.f(a = 33) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T15:59:11.180

我认为你能得到的最接近（不改变你的 API）是：

```
def f(a: Int) = {
  def ff(a0: Int) = {
    new A {
      def a = a0
    }
  }
  ff(a)
} 
```

在 Scala 中，方法不是类型。因此，不可能使用类型系统或其中的任何成员来引用它们。

```
scala> class X{def f = 0}
defined class X

scala> import reflect.runtime.universe._
import reflect.runtime.universe._

scala> typeOf[X].member(newTermName("f")).isType
res9: Boolean = false 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-02T20:51:13.527

这是一个匿名的解决方案。

```
package eyeshadow

trait A {
  def a: Int
}

class B {
  def f(a: Int) = {
    val fa: A = new {
      //private val b = a
      private[this] val b = a // crashes, sorry scalac. edit: ok in 2.11
    } with A {
      def a = b
    }
    fa.a
    /*
     * This seems far-fetched, but compare the initial objections in
     * https://issues.scala-lang.org/browse/SI-3836
     * All I want is to alias a symbol, right?
     * Maybe the override means "do not shadow."
    val fa: A = new A {
      //import fa.{ a => b }
      import this.{ a => b }
      override def b = a
    }
     */
  }
}

object Test {
  def main(args: Array[String]) {
    val b = new B
    println(b f 7)
  }
} 
```

# ruby-on-rails - Rails 嵌套表单：f.input 和 input(f) 的区别

> ID：12229007
> 
> 赞同：0
> 
> 时间：2012-09-01T15:25:24.660
> 
> 标签：ruby-on-rails, forms, ruby-on-rails-3.2, nested-forms

我做了一些表格，并尝试以这种方式制作嵌套表格：

```
<%= form_for(@birth) do |f| %>
    <%= f.text_area(:obs) %>
    <%= f.fields_for :child_attributes do |ff| %>
        <%= text_field(:child_attributes, :earring) %>
    <% end %>
<% end %> 
```

然后，在 BirthsController 中，我可以通过这种方式获取嵌套属性：

```
child = params[:child_attributes] 
```

但是，如果我将嵌套形式更改为：

```
<%= form_for(@birth) do |f| %>
    <%= f.text_area(:obs) %>
    <%= f.fields_for :child_attributes do |ff| %>
        <%= ff.text_field(:earring) %>
    <% end %>
<% end %> 
```

这没用。它们之间到底有什么区别，为什么第二种方式（我认为更优雅）不起作用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T15:33:18.627

该`text_field`方法对您的 object 一无所知`@birth`，因此该字段的名称将只是`child_attributes`，这就是您可以通过 访问它的原因`params[:child_attributes]`，但这不是您想要的。

你应该使用`ff.text_field`. 然后在您的`Birth`模型中，添加：

```
accepts_nested_attributes_for :child_attributes
attr_accessible :child_attributes_attributes 
```

# sql-server-2008 - JPA-SQL Server 存储过程？

> ID：12229008
> 
> 赞同：1
> 
> 时间：2012-09-01T15:25:39.577
> 
> 标签：sql-server-2008, hibernate, jpa, stored-procedures

在 Sql server 存储过程中，我使用以下代码从**JPA调用时插入语句：**

```
em.createNativeQuery("{call dbo.sp_xxx(:v1,:v2)}");
finQuery.setParameter("v1", 123); 
finQuery.setParameter("v2", "durga");
finQuery.getResultList(); 
```

在我的存储过程中

```
ALTER PROCEDURE [dbo].[sp_xxxx](
@v1 int,
@v2 nvarchar(10)
)
AS

BEGIN TRANSACTION   
BEGIN         

    INSERT INTO dbo.XXXX
           (v1,v2)
        VALUES
           (@v1,@v2)     
COMMIT TRANSACTION 
END 
```

执行存储过程后

```
Exception sp_xxxx...javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: could not execute query. 
```

我能够在 sql server 窗口中运行。**来自JPA**的 Bur 正在克服错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T15:59:09.297

代替 getResultList()，尝试 executeUpdate()，它期望 SQL 代码返回更新计数（INSERT/UPDATE/DELETE 操作的结果）。getResultList() 期望 SQL 代码返回结果集（SELECT 操作的结果）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T22:46:56.137

试试这个代码片段。**注意**：我使用的是 SQL Server 2005 和 OpenJPA

```
Query query = entityManager.createNativeQuery("EXEC ps_GeneraSecuenciaClaveCentrales ?, ?, ? ");
query.setParameter(1, "VE");
query.setParameter(2, new Integer(48));
query.setParameter(3, new Integer(42));
String res = (String)query.getSingleResult(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:21:08.037

尝试这个：

```
finQuery = em.createNativeQuery("exec sp_xxx :v1,:v2");
finQuery.setParameter("v1", 123);
finQuery.setParameter("v2", "durga");
finQuery.getResultList(); 
```

# sphinx - 使用 Sphinx 查询 2 个不同表的 2 个索引

> ID：12229010
> 
> 赞同：1
> 
> 时间：2012-09-01T15:26:28.150
> 
> 标签：sphinx

我一直试图让 sphinx 通过链接 2 个索引来搜索 2 个表。以下是这些索引的来源：

```
source gSrc 
{ #General Source
type                    = mysql

sql_host        = localhost
sql_user        = (blahblahblah)
sql_pass        = (blahblahblah)
sql_db          = (blahblahblah)
sql_port        = 3306  # optional, default is 3306

sql_ranged_throttle = 0
}

source mentionActivitySrc : gSrc
{
sql_query       = \
    SELECT id, author, thesis, body, created, updated \
    FROM activity

sql_attr_uint       = id
sql_attr_timestamp  = updated

sql_query_info      = SELECT * FROM activity WHERE id=$id
}

source mentionUserSrc : gSrc
{
sql_query       = \
    SELECT id, first, last, username, email, updated \
    FROM user

sql_attr_uint       = id
sql_attr_timestamp  = updated

sql_query_info      = SELECT * FROM user WHERE id=$id
} 
```

以下是索引本身：

```
index gIndex
{ #General Index
docinfo         = extern
mlock           = 0
morphology      = none
min_word_len        = 1
charset_type        = sbcs
html_strip      = 0
}

index activityMentionIndex : gIndex 
{
source          = mentionActivitySrc
path            = /var/lib/sphinxsearch/data/activityMentionIndex
}

index userMentionIndex : gIndex 
{
source          = mentionUserSrc
path            = /var/lib/sphinxsearch/data/userMentionIndex
} 
```

我正在使用[sphinxapi.php](http://code.google.com/p/sphinxsearch/source/browse/trunk/api/sphinxapi.php?r=2014)，当我这样做时

```
->query('some keywords', 'activityMentionIndex userMentionIndex'); 
```

返回数组的字段索引显示它只识别了第二个索引（在这种情况下，userMentionIndex，如果我切换它们，它将识别activityMentionIndex）

谁能告诉我我可能做错了什么，或者是否可以查询 2 个不同表的 2 个索引？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:23:30.923

我很确定它已经搜索了两个索引。只是

1) 文档 ID 必须是唯一的。因此，如果第二个索引中的文档在第一个索引中具有相同的 id，则只有第二个会显示在结果中。为了解决这个问题，您需要安排 id 是唯一的。

2）它不会尝试合并字段列表（也不会合并属性） - 它只使用最后一个。搜索多个索引的正常方法是使用相同的字段名（例如在 main+delta 中），因此它实际上并不重要。

--

还有你的

```
 sql_attr_uint       = id 
```

是错误的。它不应该在那里。文档 ID 是自动的 - 它始终是 mysql 结果集中的第一列。Sphinx 应该足够聪明，可以完全忽略它，但最好将其删除以避免混淆。

# makefile - 从源代码安装时在 Ubuntu 12.04 上出现 0.4.2 编译错误

> ID：12229013
> 
> 赞同：0
> 
> 时间：2012-09-01T15:26:36.393
> 
> 标签：makefile, ubuntu-12.04, libpng, ming

我正在尝试从源代码安装 ming 0.4.2 并且**它之前可以在 Ubuntu 10.04 上编译**，但是现在当我尝试使用命令安装时它会给出以下编译错误`sudo make install`（`libpng`已安装）。

```
/bin/bash ../libtool --tag=CC   --mode=link gcc  -g -O2 -Wall -DSWF_LITTLE_ENDIAN   -o img2swf img2swf.o ../src/libming.la 
libtool: link: gcc -g -O2 -Wall -DSWF_LITTLE_ENDIAN -o .libs/img2swf img2swf.o  ../src/.libs/libming.so
gcc -DHAVE_CONFIG_H -I. -I../src -I../src    -g -O2 -Wall -DSWF_LITTLE_ENDIAN -MT png2dbl.o -MD -MP -MF .deps/png2dbl.Tpo -c -o png2dbl.o png2dbl.c
png2dbl.c: In function ‘readPNG’:
png2dbl.c:64:8: warning: ignoring return value of ‘fread’, declared with attribute warn_unused_result [-Wunused-result]
mv -f .deps/png2dbl.Tpo .deps/png2dbl.Po
/bin/bash ../libtool --tag=CC   --mode=link gcc  -g -O2 -Wall -DSWF_LITTLE_ENDIAN   -o png2dbl png2dbl.o ../src/libming.la 
libtool: link: gcc -g -O2 -Wall -DSWF_LITTLE_ENDIAN -o .libs/png2dbl png2dbl.o  ../src/.libs/libming.so
png2dbl.o: In function `readPNG':
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:69: undefined reference to `png_create_read_struct'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:74: undefined reference to `png_create_info_struct'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:82: undefined reference to `png_create_info_struct'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:97: undefined reference to `png_init_io'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:98: undefined reference to `png_set_sig_bytes'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:99: undefined reference to `png_read_info'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:101: undefined reference to `png_get_IHDR'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:127: undefined reference to `png_get_valid'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:156: undefined reference to `png_read_update_info'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:158: undefined reference to `png_get_IHDR'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:162: undefined reference to `png_get_channels'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:187: undefined reference to `png_get_rowbytes'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:194: undefined reference to `png_read_image'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:128: undefined reference to `png_set_expand'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:135: undefined reference to `png_set_strip_16'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:143: undefined reference to `png_set_gray_to_rgb'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:151: undefined reference to `png_set_filler'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:125: undefined reference to `png_set_packing'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:107: undefined reference to `png_get_valid'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:117: undefined reference to `png_get_PLTE'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:78: undefined reference to `png_destroy_read_struct'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:92: undefined reference to `png_destroy_read_struct'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:86: undefined reference to `png_destroy_read_struct'
png2dbl.o: In function `writeDBL':
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:278: undefined reference to `floor'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:280: undefined reference to `compress2'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:278: undefined reference to `floor'
/home/gmuhammad/Downloads/ming-0.4.2/util/png2dbl.c:280: undefined reference to `compress2'
collect2: ld returned 1 exit status
make[1]: *** [png2dbl] Error 1
make[1]: Leaving directory `/home/gmuhammad/Downloads/ming-0.4.2/util'
make: *** [install-recursive] Error 1 
```

# c# - Plinq 的范围分区与块分区？

> ID：12229016
> 
> 赞同：5
> 
> 时间：2012-09-01T15:27:00.853
> 
> 标签：c#, .net, .net-4.0, parallel-processing, plinq

在哪些场景下*Range*分区会比*Chunk*分区更好？（和虎钳诗句）

我已经知道了

*   块分区：从输入中抓取小块元素进行处理，然后从小块开始，然后增加块大小。

*   范围分区为每个工作人员预分配相等数量的元素

另外，*为什么*这个代码：（找到直到 100000 的素数）

```
IEnumerable<int> numbers = Enumerable.Range (3, 100000-3);
var parallelQuery =    from n in numbers.AsParallel()
                       where Enumerable.Range (2, (int) Math.Sqrt (n)).All (i => n % i > 0)
                       select n; 
```

*范围*分区可能表现不佳*？*

 *虽然这段代码：（找到前一百万个数字的 sqrt 总和）

```
ParallelEnumerable.Range (1, 10000000).Sum (i => Math.Sqrt (i)) 
```

*与范围*分区一起使用会是更好的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T15:41:10.283

在第一个示例中，每个项目所需的时间取决于`n`. 寻找 90000 之后的下一个素数比寻找 11 之后的素数花费更多的时间。

结果，当划分为相等的范围时，最后一个范围将比第一个范围执行更多的工作。

在第二个样本中，每次操作的时间在整个范围内都是相等的。所以范围分区会很好地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-20T18:56:26.213

微软 PFX 团队的成员在 PFX 开发博客上给出了很好的解释：

[PLINQ 中的分区](https://devblogs.microsoft.com/pfxteam/partitioning-in-plinq/)

> 基于许多因素，我们有 4 种主要算法单独用于分区。它们值得了解，因为我们将在未来的技术讨论中更多地讨论它们以及我们对它们所做的调整。
> 
> 1.  范围分区——这是一种非常常见的分区方案，类似于我在上面的示例中描述的那个。这适用于许多查询形状，尽管它仅适用于可索引的数据源，例如列表和数组（即 IList 和 T[]）。如果您为 PLINQ 提供类型为 IEnumerable 或 IEnumerable 的内容，PLINQ 将查询 ILIst 接口，如果找到，将使用该接口实现和范围分区。这些数据源的好处是我们知道确切的长度并且可以直接访问数组中的任何元素。在大多数情况下，使用这种类型的分区有很大的性能优势。
> 
> [![范围分区](../Images/5e72590a409c96519eeb053376fc354e.png)](https://i.stack.imgur.com/DSq3m.png)
> 
> 2.  块分区 - 这是适用于任何数据源的通用分区方案，并且是不可索引数据源的主要分区类型。在这个方案中，工作线程请求数据，并以块的形式提供给线程。IEnumerables 和 IEnumerables 没有固定的 Count 属性（有一个 LINQ 扩展方法，但不一样），因此无法知道数据源何时或是否会完全枚举。可以是 3 个元素，可以是 300 万个元素，也可以是无限的。单个系统需要考虑所有这些可能性，并考虑不同的委托大小、不均匀的委托大小、选择性等。块分区算法非常通用，必须调整 PLINQ 的算法才能在各种查询上获得良好的性能。我们已经尝试了许多不同的增长模式，目前使用的计划是在一定数量的请求后翻倍。当我们调整性能时，这可能会发生变化，所以不要依赖于此。另一个重要的优化是块分区平衡了核心之间的负载，因为每个核心的任务会根据需要动态地请求更多的工作。这确保了在整个查询过程中使用了所有核心，并且都可以同时越过终点线，而不是一个参差不齐的顺序进入到最后。
> 
> [![块分区](../Images/5aed3cb799c49cdb5fc490f5b28459c5.png)](https://i.stack.imgur.com/MLY2I.png)
> 
> 3.  条带分区——该方案用于 SkipWhile 和 TakeWhile，并针对处理数据源头部的项目进行了优化（这显然适合 SkipWhile 和 TakeWhile 的需求）。在条带分区中，n 个工作线程中的每一个都从 n 个项目的每个块中分配了少量项目（有时是 1）。属于单个线程的一组项目称为“条带”，因此得名。该方案的一个有用特性是不需要线程间同步，因为每个工作线程都可以通过简单的算术确定其数据。这实际上是范围分区的一种特殊情况，仅适用于实现 IList 的数组和类型。
> 
> [![条带分区](../Images/518c1ebacca74a4bf70d8528fd8d86d8.png)](https://i.stack.imgur.com/ZeaNm.png)
> 
> 4.  哈希分区 – 哈希分区是一种特殊类型的分区，供必须比较数据元素的查询运算符使用（这些运算符是：Join、GroupJoin、GroupBy、Distinct、Except、Union、Intersect）。当散列分区发生时（就在提到的任何运算符之前），所有数据都被处理并引导到线程，这样具有相同散列码的项目将由同一个线程处理。这种哈希分区工作的成本很高，但这意味着所有的比较工作都可以在没有进一步同步的情况下执行。散列分区基于从每个元素的键计算的散列将每个元素分配给输出分区。这可以是一种有效的同时构建哈希表的方法，并且可以用于为哈希连接算法完成分区和哈希。好处是 PLINQ 现在可以对用于探测的数据源使用相同的哈希分区方案；这样所有可能的匹配最终都在同一个分区中，这意味着更少的共享数据和更小的哈希表大小（每个分区都有自己的哈希表）。哈希分区有很多事情要做，所以它不像其他类型那么快，尤其是在查询中涉及排序时。因此，与更简单的运算符相比，依赖它的查询运算符具有额外的开销。所以它不像其他类型那么快，尤其是在查询中涉及排序时。因此，与更简单的运算符相比，依赖它的查询运算符具有额外的开销。所以它不像其他类型那么快，尤其是在查询中涉及排序时。因此，与更简单的运算符相比，依赖它的查询运算符具有额外的开销。
> 
> [![哈希分区](../Images/662e2be001b59022fcf44611b4212ab6.png)](https://i.stack.imgur.com/R4pGR.png)*

# vb.net - RDLC - 报告正文中的上一页总计

> ID：12229017
> 
> 赞同：2
> 
> 时间：2012-09-01T15:27:04.783
> 
> 标签：vb.net, visual-studio-2010, rdlc

使用我的报告 Tablix，我希望在报告正文中当前页面的第一行有一个上一页总数......这可能吗？当我制作一些发票时，在第 2 页上，我希望将第 1 页的总数如下所示...我要求在报告正文中...但是对于页眉和页脚没问题...因此我的 TextBox 表达式看起来像下面..但它给出了错误

```
"PageNumber or TotalPages can be used in Header or Footer"

=IIF(Globals!PageNumber >1,"Brought Forward - PAGE - " & Globals!PageNumber -1," ") ??????? 
```

我的价值 TexBox 表达式将是

```
=SUM(Fields!amount_value.Value )   ??????????? 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-07T17:45:56.257

只需找到整个数据集的总和，然后从主数据集中减少组级总数。

SUM(Price,"dsFullData") - SUM(Price,"grplevelTotal)

这应该工作

谢谢， 纳加拉詹

# c# - “绑定生成器”不询问嵌套的 ICustomTypeDescriptor（路径为空）？

> ID：12229018
> 
> 赞同：19
> 
> 时间：2012-09-01T15:27:12.957
> 
> 标签：c#, .net, wpf, visual-studio-2010, data-binding

我正在试验`ICustomTypeDescriptor`接口和`PropertyDescriptor`类，以便在对象上创建动态属性。我在简单对象方面取得了很大成功，但我无法让嵌套对象创建它们的动态属性？

例如，在下面的数据绑定对话框中，我将我的 Person 类添加为`StaticResource`，然后尝试将数据绑定`Person.Child.Name`到测试框：

![](../Images/894d9ae410ebd8951adbd21c3e6575e0.png)

对于`Person.Child`我希望看到我动态创建的属性（`Name`和`Age`），但正如您所见，它没有按预期工作？就好像数据绑定对话框没有`ICustomTypeDescriptor`询问`Person.Child`？

有关如何使这些嵌套属性“可见”的任何指导？

**外层**

```
public class Person : ICustomTypeDescriptor, INotifyPropertyChanged
{
    private readonly List<CustomPropertyDescriptor> propertyDescriptors = new List<CustomPropertyDescriptor>();
    private readonly Dictionary<string, object> properties = new Dictionary<string, object>();

    public Person()
    {
        // 'Dynamic' Property
        string name = "Name";
        object value = "Person's Name";
        this.properties.Add(name, value);
        var propertyDescriptor = new CustomPropertyDescriptor(
            typeof(Person), 
            name, 
            value, 
            value.GetType().GetCustomAttributes(true).Cast<Attribute>().ToArray());
        this.propertyDescriptors.Add(propertyDescriptor);

        // 'Dynamic' Property
        name = "Child";
        value = new Child();
        this.properties.Add(name, value);
        propertyDescriptor = new CustomPropertyDescriptor(
            typeof(Child),
            name,
            value,
            value.GetType().GetCustomAttributes(true).Cast<Attribute>().ToArray());
        this.propertyDescriptors.Add(propertyDescriptor);

        propertyDescriptor.PropertyChanged += this.PropertyDescriptorPropertyChanged;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    // Test Property (shouldn't be visible)
    public string NotDynamic { get; set; }

    public override string ToString()
    {
        return string.Format("{0} ({1})", this.properties["Name"], this.properties["Age"]);
    }

    public AttributeCollection GetAttributes()
    {
        return TypeDescriptor.GetAttributes(this, true);
    }

    public string GetClassName()
    {
        return TypeDescriptor.GetClassName(this, true);
    }

    public string GetComponentName()
    {
        return TypeDescriptor.GetComponentName(this, true);
    }

    public TypeConverter GetConverter()
    {
        return TypeDescriptor.GetConverter(this, true);
    }

    public EventDescriptor GetDefaultEvent()
    {
        return TypeDescriptor.GetDefaultEvent(this, true);
    }

    public PropertyDescriptor GetDefaultProperty()
    {
        try
        {
            return this.propertyDescriptors.First();
        }
        catch (InvalidOperationException)
        {
            return null;
        }
    }

    public object GetEditor(Type editorBaseType)
    {
        return TypeDescriptor.GetEditor(this, editorBaseType, true);
    }

    public EventDescriptorCollection GetEvents(Attribute[] attributes)
    {
        return TypeDescriptor.GetEvents(this, attributes, true);
    }

    public EventDescriptorCollection GetEvents()
    {
        return TypeDescriptor.GetEvents(this, true);
    }

    public PropertyDescriptorCollection GetProperties(Attribute[] attributes)
    {
        return new PropertyDescriptorCollection(this.propertyDescriptors.ToArray());
    }

    public PropertyDescriptorCollection GetProperties()
    {
        return this.GetProperties(null);
    }

    public object GetPropertyOwner(PropertyDescriptor pd)
    {
        return this;
    }

    protected void OnPropertyChanged(string name)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(name));
        }
    }

    private void PropertyDescriptorPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        this.OnPropertyChanged(e.PropertyName);
    }
} 
```

**内部类**

```
[TypeConverter(typeof(ExpandableObjectConverter))]
public class Child : ICustomTypeDescriptor, INotifyPropertyChanged 
{
    private readonly List<CustomPropertyDescriptor> propertyDescriptors = new List<CustomPropertyDescriptor>();
    private readonly Dictionary<string, object> properties = new Dictionary<string, object>();

    public Child()
    {
        // 'Dynamic' Property
        string name = "Name";
        object value = "Person's Child";
        this.properties.Add(name, value);
        var propertyDescriptor = new CustomPropertyDescriptor(
            typeof(Person),
            name,
            value,
            value.GetType().GetCustomAttributes(true).Cast<Attribute>().ToArray());
        propertyDescriptor.PropertyChanged += this.PropertyDescriptorPropertyChanged;
        this.propertyDescriptors.Add(propertyDescriptor);
    }

    public event PropertyChangedEventHandler PropertyChanged;

    // Test Property (shouldn't be visible)
    public string NotDynamic { get; set; }

    public override string ToString()
    {
        return string.Format("{0} ({1})", this.properties["Name"], this.properties["Age"]);
    }

    public AttributeCollection GetAttributes()
    {
        return TypeDescriptor.GetAttributes(this, true);
    }

    public string GetClassName()
    {
        return TypeDescriptor.GetClassName(this, true);
    }

    public string GetComponentName()
    {
        return TypeDescriptor.GetComponentName(this, true);
    }

    public TypeConverter GetConverter()
    {
        return TypeDescriptor.GetConverter(this, true);
    }

    public EventDescriptor GetDefaultEvent()
    {
        return TypeDescriptor.GetDefaultEvent(this, true);
    }

    public PropertyDescriptor GetDefaultProperty()
    {
        try
        {
            return this.propertyDescriptors.First();
        }
        catch (InvalidOperationException)
        {
            return null;
        }
    }

    public object GetEditor(Type editorBaseType)
    {
        return TypeDescriptor.GetEditor(this, editorBaseType, true);
    }

    public EventDescriptorCollection GetEvents(Attribute[] attributes)
    {
        return TypeDescriptor.GetEvents(this, attributes, true);
    }

    public EventDescriptorCollection GetEvents()
    {
        return TypeDescriptor.GetEvents(this, true);
    }

    public PropertyDescriptorCollection GetProperties(Attribute[] attributes)
    {
        return new PropertyDescriptorCollection(this.propertyDescriptors.ToArray());      
    }

    public PropertyDescriptorCollection GetProperties()
    {
        return this.GetProperties(null);
    }

    public object GetPropertyOwner(PropertyDescriptor pd)
    {
        return this;
    }

    protected void OnPropertyChanged(string name)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(name));
        }
    }

    private void PropertyDescriptorPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        this.OnPropertyChanged(e.PropertyName);
    }
} 
```

**属性描述符**

```
public class CustomPropertyDescriptor : PropertyDescriptor, INotifyPropertyChanged
{
    private readonly Type componentType;
    private string name;
    private object value;

    public CustomPropertyDescriptor(Type componentType, string name, object value, Attribute[] attributes)
        : base(name, attributes)
    {
        this.componentType = componentType;
        this.name = name;
        this.value = value;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    public override bool IsBrowsable
    {
        get
        {
            return true;
        }
    }

    public override Type ComponentType
    {
        get { return this.componentType; }
    }

    public override bool IsReadOnly
    {
        get { return false; }
    }

    public override Type PropertyType
    {
        get { return this.value.GetType(); }
    }

    public override object GetValue(object component)
    {
        return this.value;
    }

    public override bool CanResetValue(object component)
    {
        return false;
    }

    public override void ResetValue(object component)
    {
    }

    public override void SetValue(object component, object value)
    {
        this.value = value;
        this.OnPropertyChanged(this.Name);
    }

    public override bool ShouldSerializeValue(object component)
    {
        return false;
    }

    private void OnPropertyChanged(string name)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(name));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-11T15:33:51.533

我认为您错误地设置了 ComponentType 属性。

1.  属性：Person.Child 应该将 ComponentType 设置为 typeof(Person) 而不是 typeof(Child)。就像属性：Person.Name。
2.  属性：Child.Name 应该将 ComponentType 设置为 typeof(Child)。

ComponentType 用于定义属性所有者类型。

# javascript - 在jquery中防止从父元素到子元素的事件

> ID：12229019
> 
> 赞同：2
> 
> 时间：2012-09-01T15:27:14.093
> 
> 标签：javascript, jquery

我有如下绑定事件：

```
 $(document).delegate('.budget', 'click', function(e){
        if ($(this).hasClass('collapsed')) {
           $(this).removeClass('collapsed');
           $(this).addClass('expanded');
        }
        else if ($(this).hasClass('expanded')) {
           $(this).removeClass('expanded');
           $(this).addClass('collapsed');
        }
    }); 
```

基本上，这在展开和折叠之间切换。

我有另一个事件绑定如下：

```
 $('[id^="tree"]').delegate('.collapsed', 'click', function(e){
        var elementId = $(this).attr('id');
        hideChildElement(elementId);
    }); 
```

由第二个事件绑定绑定的元素是由第一个事件绑定绑定的元素的父元素。发生的情况是，从第一个绑定事件方法中单击元素也会触发由第二个事件绑定绑定的事件。我想防止任何事件从第二个事件绑定到第一个事件绑定方法。

如果元素 A 绑定到来自第一个事件绑定的单击事件，并且 B 绑定到第二个事件绑定（A 在 B 内部或 A 是 B 的子级），我不希望 B 的任何事件传播到 A。注意我试过`e.stopImmediatePropagation();`但没有没用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T15:46:32.040

我认为您想防止在单击元素时`[id^="tree"]`触发事件处理程序。`.budged`在这种情况下，您可以测试点击事件的来源：

```
$('[id^="tree"]').delegate('.collapsed', 'click', function(e){
    if($(e.target).closest('.budget').length === 0) {
        // not from inside budget element
        var elementId = $(this).attr('id');
        hideChildElement(elementId);
    }
}); 
```

或者，如果您将两个事件处理程序绑定到同一个元素，即两者`document`或两者`[id^="tree"]`之间的任何元素，`event.stopImmediatePropagation()`将可以正常工作。

如果这不是您想要的，请澄清您的问题，这不容易理解。

# java - Java 和堆栈：正确的实现？

> ID：12229020
> 
> 赞同：0
> 
> 时间：2012-09-01T15:27:18.137
> 
> 标签：java, stack

我创建了这个非常简单的堆栈概念的实现。你能告诉我它是否正确和干净吗？您是否看到任何不良的编码习惯？

```
public class MyStack
{
    private static final int MAXELEMENTS = 10;
    private int[] elements;
    private int numElements;

    public MyStack()
    {
        numElements = 0;
        elements = new int[MAXELEMENTS];
    }

    public boolean isEmpty()
    {
        return (numElements == 0);
    }

    public boolean isFull()
    {
        return (numElements == MAXELEMENTS);
    }

    public void push(int e)
    {
        if (!isFull())
            elements[numElements++] = e;
    }

    public int top()
    {
        if (!isEmpty())
            return elements[numElements - 1];
        else
            return -1;
    }

    public void pop()
    {
        if (!isEmpty())
            numElements--;
    }
} 
```

您可以将其与以下代码一起使用：

```
class MyStackTestDrive
{
    public static void main(String[] args)
    {
        MyStack s1 = new MyStack();
        MyStack s2 = new MyStack();
        s1.push(2);
        s2.push(4);
        System.out.println(s1.top());
        System.out.println(s2.top());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T15:42:44.460

我的评论是：

1.  这将只是一个堆栈`int`。你应该让它通用
2.  这是一个只有 10 个元素的堆栈。没有多大用处
3.  `numElements`栈顶变量的名字不好
4.  `top`空堆栈的应该`throw`和异常（传统上）
5.  `pop`应该返回栈顶。现在是`void`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T15:46:39.963

我会做一些事情，其中​​一些只是偏好问题：

*   将“numElements”重命名为“head”以更好地体现其功能。
*   添加一个构造函数，可以指定堆栈的最大大小。
*   pop 方法应该返回堆栈的顶部元素并将其删除。那是标准语义。
*   top 和 pop 在空堆栈上调用时应该抛出异常。这是为了防止在没有先检查空堆栈的情况下操作空堆栈的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T15:46:21.147

您应该尝试使您的堆栈通用（如果您想允许添加任何其他类型），您应该尝试使其自动增长，通过在您的推送方法中使用检查，如果它已满，那么您重新分配空间它（创建另一个数组，可能是先前空间的两倍并逐个重新分配）。例如，您使用数组而不是链表的任何方式，恕我直言，这是个好主意。

# wpf - 如何在使用绑定的 XAML 中格式化字符串？

> ID：12229024
> 
> 赞同：7
> 
> 时间：2012-09-01T15:27:32.850
> 
> 标签：wpf, xaml, winrt-xaml

在 WPF 中，我可以这样做：

```
<TextBlock Text="{Binding Products.Count, StringFormat='{0} Products'}" 
```

Windows 8 / WinRT 中的等效项是什么，因为不再支持此语法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-11T18:00:01.327

你可以使用这个：

```
<TextBlock>
    <Run Text="{Binding Path=Products.Count}" />
    <Run Text=" Products" />
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T15:35:24.070

根据 MSDN 上的文档，此功能（例如`StringFormat`，在[Binding 类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.data.binding.aspx)上）在 WinRT 中不存在。

所以在你的 ViewModel 上进行格式化

```
public class MyViewModel
{
    public IList<Product> Products { get; set; }

    public string ProductsText 
    { 
        get 
        { 
            return string.Format("{0} Products", Products.Count); 
        } 
    }
} 
```

请注意，您可以挂钩以跟踪`Products`集合中的更改并通知`ProductsText`属性更改。

并绑定到格式化属性：

```
<TextBlock Text="{Binding ProductsText}" /> 
```

# assembly - 在原始文件中包含单独的文件会导致原始文件无法运行

> ID：12229025
> 
> 赞同：0
> 
> 时间：2012-09-01T15:27:38.977
> 
> 标签：assembly, x86, dos, nasm

基本上，我使用 NASM 创建简单的 .COM 文件来使用。对于其中一个文件（ttcb.asm），它从清除屏幕开始。这是通过调用另一个文件中的例程来完成的，所以我使用了`%include 'video.asm'`. 这包括预期的文件。当我包含此文件时，即使我不调用单独的例程`%include`，原始文件（包含的文件）中的语句之后也不会执行任何其他操作。`video.asm`我还看到 video.asm 中的代码会自动执行。但是当我删除该`%include`语句时，一切运行正常。我什至尝试删除**video.asm 中的所有内容**，但它仍然没有工作。然后我尝试将 video.asm 制作为一个空白文件，并且它起作用了，但这毫无意义。然后我尝试移动 include 语句，但也失败了。有什么解决方案，还是我必须将子程序直接插入到原始文件中？

**ttcb.asm：**

```
[BITS 16]

section .text

%include 'video.asm'

call screen_clear

jmp $    ;should've frozen the .COM, but it didn't, meaning it failed to execute.

section .data

welcomeMsg db 'Welcome to the TitaniumCube ©.',13,10,0,'$'

section .bss 
```

**视频.asm：**

```
;===================================
;-----------------------------------
;Clears the screen to black
;No input or output
;-----------------------------------

screen_clear:
mov ah,0Fh
int 10h
push ax
mov ah,00
mov al,00
int 10h
pop ax
mov ah,00
int 10h
ret

;-----------------------------------
;=================================== 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T00:45:28.420

对于 COM 文件，用于`org 100h`指定二进制基地址。该`.text`部分将是代码的起始地址。所以把所有函数放在*主程序*块结束之后。

下面是代码。编译：`nasm -fbin -o ttcb.com ttcb.asm`

```
[BITS 16]

org 100h ;set base address. must be 100h for COM files

section .text ;start of code is always start address for COM files

call screen_clear

mov ax, word welcomeMsg ;put welcomeMsg offset in register AX
;if above "org 100h" isn't specified, the above instruction would produce:
;"mov ax, 001Ch" instead of "mov ax, 011Ch"

;jmp $    ;should've frozen the .COM, but it didn't, meaning it failed to execute.
int 20h ;terminate program

%include 'video.asm'

section .data

welcomeMsg db 'Welcome to the TitaniumCube ©.',13,10,0,'$'

section .bss 
```

PS）在纯DOS下，没有`©`（版权）字符。

# javascript - 预览远程链接

> ID：12229029
> 
> 赞同：0
> 
> 时间：2012-09-01T15:27:50.450
> 
> 标签：javascript, jquery, ajax

任何人都知道如何预览未本地保存在服务器上的链接。我已经阅读了[这篇](http://books.gigatux.nl/mirror/javascriptandajax/0321430328/ch15lev1sec5.html)关于动态预览链接的文章，但它说它只能在本地文件中工作。

我想预览一个链接，如[http://www.google.com](http://www.google.com)等。我在想我可以使用类似于 PHP 的读取功能的东西，`file_get_contents`或者什么都不做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:18:58.837

您可以使用`$("#preview").hover()`事件并创建 iframe 来预览它们：

[http://jsfiddle.net/mQhX5/1/](http://jsfiddle.net/mQhX5/1/)

根据您的需要调整位置和大小。

这是调整 iframe 内容大小以使其变小的 css：

```
iframe {
    width: 800px;
    height: 520px;
    border: none;
    position:absolute;
    -moz-transform: scale(0.5);
    -moz-transform-origin: 0 0;
    -o-transform: scale(0.5);
    -o-transform-origin: 0 0;
    -webkit-transform: scale(0.5);
    -webkit-transform-origin: 0 0;
} 
```

# jquery - Wobbly jQuery 缩略图滚动器 CSS

> ID：12229033
> 
> 赞同：0
> 
> 时间：2012-09-01T15:28:06.610
> 
> 标签：jquery, css, jquery-ui

我正在开发缩略图滚动器：[https ://dl.dropbox.com/u/2241201/jquery-thumbnail-scroll/index.html](https://dl.dropbox.com/u/2241201/jquery-thumbnail-scroll/index.html)

如果将鼠标悬停在缩略图上，它会从左向右摆动。

我觉得我已经尝试了所有方法，但无法防止图像缩略图看起来不稳定。

我认为这是一个 CSS 问题，因为默认滚动条较小，并且没有摆动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T15:50:39.933

这不是 Css 问题，而是更改`.jTscroller`'`left`属性的 JavaScript 问题。

代码是

```
$this.mousemove(function(e){
    mouseCoords=(e.pageX-pos[1]);
    mouseCoordsY=(e.pageY-pos[0]);
    var mousePercentX=mouseCoords/$this.width(); if(mousePercentX>1){mousePercentX=1;}
    var mousePercentY=mouseCoordsY/$this.height(); if(mousePercentY>1){mousePercentY=1;}
    var destX=Math.round(-((totalWidth-$this.width())*(mousePercentX)));
    var destY=Math.round(-((totalHeight-$this.height())*(mousePercentY)));
    $scroller.stop(true,false).animate({left:destX,top:destY},options.scrollEasingAmount,options.scrollEasing); 
}); 
```

采用

```
$this.mousemove(function(e){
    var obj=new Object();
    if(options.scrollerOrientation=="horizontal"){
        mouseCoords=(e.pageX-pos[1]);
        var mousePercentX=mouseCoords/$this.width(); if(mousePercentX>1){mousePercentX=1;}
        var destX=Math.round(-((totalWidth-$this.width())*(mousePercentX)));
        obj.left=destX;
    }else{
        mouseCoordsY=(e.pageY-pos[0]);
        var mousePercentY=mouseCoordsY/$this.height(); if(mousePercentY>1){mousePercentY=1;}
        var destY=Math.round(-((totalHeight-$this.height())*(mousePercentY)));
        obj.top=destY;
    }
    $scroller.stop(true,false).animate(obj,options.scrollEasingAmount,options.scrollEasing); 
}); 
```

在这里看到它：http: [//jsfiddle.net/rUCXg/2/](http://jsfiddle.net/rUCXg/2/)

# linq - 在 Tags 属性中获取我所有带有特定标签的项目

> ID：12229037
> 
> 赞同：0
> 
> 时间：2012-09-01T15:28:20.757
> 
> 标签：linq, entity-framework

我在我的 ASP.NET MVC 项目中使用 EntityFramework。

假设我有以下实体：

```
public class Project 
{ 
    public int ProjectID { get; set; } 
    public string Description { get; set; } 
    public string Tags { get; set; } 
} 
```

假设我的数据库中有以下数据：

```
ProjectID: 1 
Description: "My first element" 
Tags: "one, three, five, seven" 

ProjectID: 2 
Description: "My second element" 
Tags: "one, two, three, six" 

ProjectID: 3 
Description: "My third element" 
Tags: "two, three, four" 
```

我想返回包含特定数量标签的所有项目。因此，例如，我想获得所有带有标签“一”和“三”的项目。要搜索的标签列表是动态的，并存储在如下变量中：`searchFor = "one, three";`.

我能怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T15:39:45.023

在控制器中创建您的 ObjectContext 实体对象并调用其方法“Where”示例： `db.Projects.Where(p => p.Tags.indexOf("one") > -1 && p.Tags.indexOf(three) > -1);`

并将其作为列表发送到视图。例子：

```
List projects = db.Projects.Where(p => p.Tags.IndexOf("one") > -1 && p.Tags.IndexOf(three) > -1).ToList();
return View(projects);
```

# c++ - 以下代码片段中是否存在内存泄漏？

> ID：12229038
> 
> 赞同：2
> 
> 时间：2012-09-01T15:28:42.790
> 
> 标签：c++, memory-leaks

我有以下代码片段：

```
int nWidth = 10;
int *pData = new int[nWidth];
//I do something here
//then I free memory by:
delete pData; 
```

这段代码是否会产生内存泄漏？我必须使用：

```
delete[] pData; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-01T15:31:38.137

如果您不使用`delete[] pData`，则行为未定义。可能导致内存泄漏，可能导致程序崩溃，在您为最重要的客户演示程序之前可以正常运行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-01T15:35:47.013

> 这段代码会产生内存泄漏吗？

不，它具有未定义的行为，这要糟糕得多。

> 我必须使用：`delete[] pData;`

是的，所有分配的内存都`new[]`必须用`delete[]`. 但是，如果提前返回或异常阻止程序到达删除表达式，它仍然会产生内存泄漏。

除非您正在做一些不寻常的事情，否则很少需要显式管理内存。在这种情况下，标准库提供了一种方便的动态数组类型：

```
#include <vector>

std::vector<int> data(nWidth);
// Do something here.
// Memory is freed automatically when data goes out of scope. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-01T15:30:53.707

是的，您必须使用：

```
delete[] pData; 
```

请注意以下关于动态分配的要点：

1.  尽可能避免动态分配
2.  `delete[]`如果您使用分配内存，则需要使用`new[]`
3.  `delete`如果您使用分配内存，则需要使用`new`
4.  `free()`如果您使用分配内存，则需要使用`malloc()`
5.  您需要将相同的地址传递给上述所有 3 ^([note])中分配函数返回的解除分配函数。

^([注意])
正如大卫在评论中的示例中正确指出的那样，该规则的一个例外是多重继承，其中基类指针可能与子类具有不同的地址，并将基类指针地址传递给`delete`而不是子类指针地址仍然可以正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T15:30:52.037

是的，它确实如此，是的，你确实......

# php - 如何从PHP中的数组中获取以给定字母开头的随机单词？

> ID：12229042
> 
> 赞同：1
> 
> 时间：2012-09-01T15:29:26.717
> 
> 标签：php

我在 PHP 中包含 20 个单词的数组。有没有办法从这个数组中提取一个以特定字母开头的随机单词？

例如，如果我想要一个以 B 开头的单词，请说。

```
$arr=array('apple','almond','banana','boat','carrot'); 
```

然后它会一半时间返回香蕉，或一半时间乘船。

如何从该数组中获取以给定字母开头的随机单词？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T15:41:26.983

以下甚至适用于选择符合条件的单词的方法，这些方法比“检查第一个字母”更复杂，并且不依赖于例如所有符合条件的单词在数组中是连续的。

```
$candidatestested = 0;
foreach ($arr as $candidate) {
   if ($candidate[0] == 'b' && rand(0,$candidatestested++)==0) {
       $result = $candidate;
   }
}
if (!$candidatestested) {
   trigger_error("There was no word matching the criterion");
}
return $result; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:18:32.830

这应该有效。在对数组进行洗牌后，每个以“B”或任何字母开头的单词将有随机机会成为洗牌数组中的第一个。依赖 PHP 的 shuffle() 可能比我们自己的实现更高效、更快。

```
function returnWithFirstLetter($words, $letter) {
    shuffle($words);
    foreach($words as $word)
        if($word[0] == $letter)
            return $word;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T15:37:36.523

又快又脏，给你：

```
function returnRandomWithLetter($words, $letter)
{

    // put all words in different bins, one for each different starting letter
    $bins = array();

    foreach($words as $word)
    {

        $bins[$word[0]][] = $word;

    }

    // return random component from chosen letter's bin 
    return $bins[$letter][array_rand($bins[$letter])];

} 
```

# ios - UITableView 入门？

> ID：12229043
> 
> 赞同：0
> 
> 时间：2012-09-01T15:29:45.780
> 
> 标签：ios, uitableview

我的应用程序试图通过简单地在彼此下方添加小子视图来模仿 UITableView 的功能。由于某些原因，这不再起作用（当用户删除“行”时，其上方的行与下方的行之间存在空白，用户需要“无限”行数，而我只构建了 20） .

那么，有人知道任何很棒的 UITableView 教程吗？具体来说，我需要： - 自定义外观 - 点击按钮添加行 - 将 2 个按钮附加到每一行 - 将 UITextField 附加到每一行（或者只是让标签可编辑） - 保存每个文本/文本字段行（与 NSUserDefaults 一样）。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T15:50:26.457

我强烈建议您观看所有关于表格视图的 WWDC 视频。它们的范围从入门到一些有趣的高级技术。此外，iTunes 中还有免费的斯坦福视频。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:00:53.507

如果您使用故事板，请查看本教程[http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

# c# - c#控制台stdin输入流读取

> ID：12229045
> 
> 赞同：-4
> 
> 时间：2012-09-01T15:30:11.583
> 
> 标签：c#, stream, inputstream, stdin

我有这个线程运行以下形式的代码，其中 strm1 在我正在测试的情况下是控制台标准输入。

```
while (true) { strm1.Read(buffer, 0, 1); dosomething1(buffer); } 
```

如果按下回车，则`dosomething1()`调用`dosomething2()`. 但是，即使我按下回车键，我仍然必须按下其他键`dosomething2()`才能运行。我怎样才能解决这个问题？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T15:42:55.707

我不知道您的代码执行什么检查，但请记住，在 Windows 中，Environment.NewLine 是两个字符：CR (\r)、LF (\n)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T04:59:15.010

最后，我解决了问题：将 s 替换`Stream`为`StreamReader`s! 可能是微软的实现问题，但至少它解决了这个问题。

# ruby-on-rails - 克隆记录并将远程文件复制到新位置？

> ID：12229048
> 
> 赞同：5
> 
> 时间：2012-09-01T15:30:33.553
> 
> 标签：ruby-on-rails, ruby, amazon-s3, ruby-on-rails-3.2, carrierwave

我有一个`Job`可以有很多附件的模型。该`Attachment`模型上安装了一个 CarrierWave 上传器。

```
class Job < ActiveRecord::Base
  has_many :attachments
end

class Attachment < ActiveRecord::Base
  mount_uploader :url, AttachmentUploader

  belongs_to :job
end 
```

可以克隆作业，克隆作业应创建新的作业和附件记录。这部分很简单。

然后系统需要将物理文件复制到与克隆作业关联的上传位置。
有没有一种简单的方法可以使用 CarrierWave 做到这一点？该解决方案应同时支持本地文件系统和 AWS S3。

```
class ClonedJob
  def self.create_from(orig_job)
    @job_clone = orig_job.dup

    if orig_job.attachments.any?
      orig_job.attachments.each do |attach|
        cloned_attactment = attach.dup
        # Need to physically copy files at this point. Otherwise
        # this cloned_attachment will still point to the same file 
        # as the original attachment.
        @job_clone.attachments << cloned_attachment
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T09:49:02.683

我已经粘贴在我拼凑在一起来完成此任务的模块下方。它有效，但如果它足够重要，我仍然会改进一些事情。我只是把我的想法留在了代码中。

```
require "fileutils"

# IDEA: I think it would make more sense to create another module
# which I could mix into Job for copying attachments. Really, the
# logic for iterating over attachments should be in Job. That way,
# this class could become a more generalized class for copying
# files whether we are on local or remote storage.
#
# The only problem with that is that I would like to not create
# a new connection to AWS every time I copy a file. If I do then
# I could be opening loads of connections if I iterate over an
# array and copy each item. Once I get that part fixed, this
# refactoring should definitely happen.

module UploadCopier
  # Take a job which is a reprint (ie. it's original_id
  # is set to the id of another job) and copy all of 
  # the original jobs remote files over for the reprint
  # to use.
  #
  # Otherwise, if a user edits the reprints attachment
  # files, the files of the original job would also be
  # changed in the process.
  def self.copy_attachments_for(reprint)
    case storage
    when :file
      UploadCopier::LocalUploadCopier.copy_attachments_for(reprint)
    when :fog 
      UploadCopier::S3UploadCopier.copy_attachments_for(reprint)
    end
  end

  # IDEA: Create another method which takes a block. This method
  # can check which storage system we're using and then call
  # the block and pass in the reprint. Would DRY this up a bit more.

  def self.copy(old_path, new_path)
    case storage
    when :file
      UploadCopier::LocalUploadCopier.copy(old_path, new_path)
    when :fog 
      UploadCopier::S3UploadCopier.copy(old_path, new_path)
    end
  end

  def self.storage
    # HACK: I should ask CarrierWave what method to use
    # rather than relying on the config variable.
    APP_CONFIG[:carrierwave][:storage].to_sym 
  end

  class S3UploadCopier
    # Copy the originals of a certain job's attachments over
    # to a location associated with the reprint.
    def self.copy_attachments_for(reprint)
      reprint.attachments.each do |attachment|
        orig_path = attachment.original_full_storage_path
        # We can pass :fog in here without checking because
        # we know it's :fog since we're in the S3UploadCopier.
        new_path = attachment.full_storage_path
        copy(orig_path, new_path)
      end
    end

    # Copy a file from one place to another within a bucket.
    def self.copy(old_path, new_path)
      # INFO: http://goo.gl/lmgya
      object_at(old_path).copy_to(new_path)
    end

  private

    def self.object_at(path)
      bucket.objects[path]
    end

    # IDEA: THis will be more flexible if I go through
    # Fog when I open the connection to the remote storage.
    # My credentials are already configured there anyway.

    # Get the current s3 bucket currently in use.
    def self.bucket
      s3 = AWS::S3.new(access_key_id: APP_CONFIG[:aws][:access_key_id],
        secret_access_key: APP_CONFIG[:aws][:secret_access_key])
      s3.buckets[APP_CONFIG[:fog_directory]]
    end
  end

  # This will only be used in development when uploads are
  # stored on the local file system.
  class LocalUploadCopier
    # Copy the originals of a certain job's attachments over
    # to a location associated with the reprint.
    def self.copy_attachments_for(reprint)
      reprint.attachments.each do |attachment|
        # We have to pass :file in here since the default is :fog.
        orig_path = attachment.original_full_storage_path
        new_path = attachment.full_storage_path(:file)
        copy(orig_path, new_path)
      end
    end

    # Copy a file from one place to another within the
    # local filesystem.
    def self.copy(old_path, new_path)
      FileUtils.mkdir_p(File.dirname(new_path))
      FileUtils.cp(old_path, new_path)
    end
  end
end 
```

我这样使用它：

```
# Have to save the record first because it needs to have a DB ID.
if @cloned_job.save
  UploadCopier.copy_attachments_for(@cloned_job)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T15:46:20.047

```
class Job < ActiveRecord::Base
  has_many :attachments
end

class Attachment < ActiveRecord::Base
  mount_uploader :attachment, AttachmentUploader
  belongs_to :job
end

class ClonedJob
  def self.create_from(orig_job)
    @job_clone = orig_job.dup

    if orig_job.attachments.any?
      orig_job.attachments.each do |attach|
        cloned_attachment = attach.dup
        @job_clone.attachments << cloned_attachment
        # !!! Here is the trick
        cloned_attachment.remote_attachment_url = attach.attachment_url
      end
    end
  end
end 
```

# magento - Magento 索引锁表

> ID：12229049
> 
> 赞同：0
> 
> 时间：2012-09-01T15:30:35.170
> 
> 标签：magento

我在 Magento EE 1.12 上运行索引时遇到问题。一些表在索引期间被锁定，客户无法完成订单。他们在提交订单时收到 SQL 错误。

索引也花费了太长时间。

有任何想法吗？

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:20:17.557

理想情况下，您永远不应该发生表锁。您能否验证您的表设置为 InnoDB 而不是 MySIAM。MySIAM 会锁定整个表，而 InnoDB 应该只锁定行。

# c# - 如何授予 SQL 服务权限？

> ID：12229054
> 
> 赞同：0
> 
> 时间：2012-09-01T15:30:57.203
> 
> 标签：c#, winforms, sql-server-2008

我正在用 c# 开发一个程序，并使用 SQL Server 2008 作为数据库，在开发人员机器上一切正常。

但是在客户端机器上，当我尝试备份数据库时，它只允许将 DB 备份保存在 D:\, E:\, ... 目录中

当我尝试将数据库的备份保存在 C:\ 上时，它只允许在 SQL 服务器安装文件夹的备份文件夹中

我的问题是如何授予写入权限或允许 SQL 服务将数据库备份保存在任何目录中。

我知道一些关于控制面板 > 管理工具 > 服务的东西，但我不知道如何处理它。

错误片段

```
Cannot open backup device 'C:\User\Saleh\Documents\12.bak'. Operating system error 5 (failed to rerieve text for this error. Reason: 15105). 
```

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T15:34:57.887

对于要写入的文件夹，您需要在客户端计算机上具有写入权限。您需要要求客户端以管理员身份登录或授予您对特定文件夹的写入权限。

它可以在您的开发人员机器上运行，因为您可能是它的本地管理员，因此对所有文件夹都有写访问权限。

# javascript - 输入选择框值并在文本框上显示值进行更新

> ID：12229058
> 
> 赞同：-1
> 
> 时间：2012-09-01T15:31:07.103
> 
> 标签：javascript, html

我有选择框和输入框，当我选择任何值时我想它会显示在文本上以进行更新..

谢谢， 阿布舍克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:07:55.390

检查此[http://jsfiddle.net/kxqJN/](http://jsfiddle.net/kxqJN/) 当用户在下拉菜单中选择一个值时，该值将在文本框中可见

这由一个简单的完成`JQuery`

下边是`HTML`

```
<select id="data">
 <option value="One">One</option>
 <option value="Tow">Tow</option>
 <option value="Three">Three</option>
</select>    
<input type="text" id="dataval" /> 
```

下边是`Jquery`

```
$("#data").change(function(){
   var item = $(this).val();        
   $("#dataval").val(item);
}); 
```

# javascript - 如何将 javascript 字典推送到多维数组或另一个字典？

> ID：12229059
> 
> 赞同：1
> 
> 时间：2012-09-01T15:31:09.513
> 
> 标签：javascript, arrays, dictionary, multidimensional-array

我是javascript开发的新手。我有类似的东西：

```
var array1=[];
array1[0][0]={};
var dic={'title':'111','url':'222'};
array1[0][0]=dic; 
```

但它没有工作？有什么问题？如何将字典推送到多维数组或另一个字典？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T15:32:31.553

你跳过了一个步骤：

```
var array1 = [[]];
array1[0][0] = {}; 
```

您的声明只是创建一个一维数组（好吧，JavaScript 中的所有数组都是一维的）。在上面的版本中，我创建了一个一维数组并将其初始化为包含另一个一维数组。

像这样可能更清楚：

```
var array1 = [];
array1[0] = [];
array1[0][0] =  {}; 
```

如果您没有将另一个数组放在第一个数组的第一个位置，那么在随后的赋值中引用它的尝试将失败。这个说法：

```
array1[0][0] = {}; 
```

涉及*获取*的值，`array1[0]`以便它可以反过来用作数组。因为您没有在其中放置数组，所以该语句会导致异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T15:35:29.640

它不起作用，因为`array1[0]`is `undefined`（因为没有具有此类索引的元素）并且`undefined`不是数组或对象，它没有任何属性，您不能为某些属性分配 valye。

# spring - 使用 context:annotation-config 扫描哪些注释？

> ID：12229061
> 
> 赞同：1
> 
> 时间：2012-09-01T15:31:23.940
> 
> 标签：spring

`<context:annotation-config/>`当我在我的 bean 配置 xml 中定义时处理的注释列表是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T15:33:48.020

请参阅[文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/xsd-config.html#xsd-config-body-schemas-context-ac)：

> 为要在 bean 类中检测到的各种注释激活 Spring 基础结构：Spring 的 @Required 和 @Autowired，以及 JSR 250 的 @PostConstruct、@PreDestroy 和 @Resource（如果可用），以及 JPA 的 @PersistenceContext 和 @PersistenceUnit（如果可用） . 或者，您可以选择为这些注释显式激活单个 BeanPostProcessor。

# ruby-on-rails - 调用延迟作业定义的正确方法

> ID：12229062
> 
> 赞同：0
> 
> 时间：2012-09-01T15:31:28.867
> 
> 标签：ruby-on-rails, ruby-on-rails-3, delayed-job

我正在为我的应用程序中的某些进程使用delayed_job。它没有任何效果并即时运行代码。以下是代码。

```
Module1::some_definition(param).delay(priority=>3, :run_at=>2.minutes.from_now) 
```

我做错了吗？

**更新：** 这是 dimitko 建议我所做的。但我仍然得到错误。

```
class User < ActiveRecord::Base
  def do_something
      #Google is my module and the do_some_process is definition.
      Google.delay.do_some_process
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T15:36:04.750

的想法`.delay`是将它与您要调用的真实作业方法链接起来。

```
class User < ActiveRecord::Base
  def do_something
  # ... do something long which you want to be in the background...
  end
end 
```

延迟此代码的“正确”方法`delayed_job`是：

```
User.current.delay(priority=>3, :run_at=>2.minutes.from_now).do_something 
```

正如您的示例代码所建议的那样，我不认为`delayed_job`打算将该方法注入模块中。`.delay`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-01T15:44:29.403

您也可以尝试设置 Cron 作业。我通常创建一个 rake 任务，然后使用 Cron 作业运行它。

谢谢

# python - 映射python字典中的值

> ID：12229064
> 
> 赞同：302
> 
> 时间：2012-09-01T15:31:37.497
> 
> 标签：python, dictionary, map-function

`{ k1: v1, k2: v2 ... }`给定我想要得到的字典，`{ k1: f(v1), k2: f(v2) ... }`只要我传递一个函数`f`。

有没有这样的内置功能？还是我必须做

```
dict([(k, f(v)) for (k, v) in my_dictionary.iteritems()]) 
```

理想情况下我会写

```
my_dictionary.map_values(f) 
```

或者

```
my_dictionary.mutate_values_with(f) 
```

也就是说，原始字典是否发生变异或创建副本对我来说并不重要。

* * *

## 回答 #1

> 赞同：447
> 
> 时间：2012-09-01T15:33:08.040

没有这样的功能；最简单的方法是使用字典理解：

```
my_dictionary = {k: f(v) for k, v in my_dictionary.items()} 
```

在 python 2.7 中，使用`.iteritems()`方法而不是`.items()`节省内存。dict 理解语法直到 python 2.7 才引入。

请注意，列表中也没有这种方法；你必须使用列表理解或`map()`函数。

因此，您也可以使用该`map()`函数来处理您的 dict：

```
my_dictionary = dict(map(lambda kv: (kv[0], f(kv[1])), my_dictionary.iteritems())) 
```

但这不是那么可读，真的。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2014-05-15T20:16:39.583

这些工具非常适合这种简单但重复的逻辑。

[http://toolz.readthedocs.org/en/latest/api.html#toolz.dicttoolz.valmap](http://toolz.readthedocs.org/en/latest/api.html#toolz.dicttoolz.valmap)

让你在你想去的地方。

```
import toolz
def f(x):
  return x+1

toolz.valmap(f, my_list) 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-08-24T08:36:20.557

您可以就地执行此操作，而不是创建新的字典，这对于大型字典可能更可取（如果您不需要副本）。

```
def mutate_dict(f,d):
    for k, v in d.iteritems():
        d[k] = f(v)

my_dictionary = {'a':1, 'b':2}
mutate_dict(lambda x: x+1, my_dictionary) 
```

结果`my_dictionary`包含：

```
{'a': 2, 'b': 3} 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2016-09-22T13:36:10.537

由于[PEP-0469](http://legacy.python.org/dev/peps/pep-0469/)将 iteritems() 重命名为 items() 和[PEP-3113](http://legacy.python.org/dev/peps/pep-3113/)删除了*Tuple 参数 unpacking*，在 Python 3.x 中，您应该像这样编写[Martijn Pieters♦ 答案](https://stackoverflow.com/a/12229070/3338479)：

```
my_dictionary = dict(map(lambda item: (item[0], f(item[1])), my_dictionary.items())) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-07T12:22:47.613

[虽然我的原始答案没有抓住重点（通过尝试使用在 defaultdict 工厂中访问密钥](https://stackoverflow.com/questions/19399032/)的解决方案来解决这个问题），但我已经对其进行了重新设计，以提出当前问题的实际解决方案。

这里是：

```
class walkableDict(dict):
  def walk(self, callback):
    try:
      for key in self:
        self[key] = callback(self[key])
    except TypeError:
      return False
    return True 
```

用法：

```
>>> d = walkableDict({ k1: v1, k2: v2 ... })
>>> d.walk(f) 
```

这个想法是对原始 dict 进行子类化以赋予它所需的功能：在所有值上“映射”一个函数。

优点是该字典可用于存储原始数据，就好像它是 a 一样`dict`，同时根据请求使用回调转换任何数据。

当然，您可以随意命名类和函数（此答案中选择的名称受 PHP[`array_walk()`](http://php.net/manual/en/function.array-walk.php)函数的启发）。

*注意：`try`-`except`块和`return`语句都不是该功能所必需的，它们是为了进一步模仿 PHP 的`array_walk`.*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-03-29T09:12:30.903

为了避免从 lambda 内部进行索引，例如：

```
rval = dict(map(lambda kv : (kv[0], ' '.join(kv[1])), rval.iteritems())) 
```

你也可以这样做：

```
rval = dict(map(lambda(k,v) : (k, ' '.join(v)), rval.iteritems())) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-06T08:40:10.897

刚刚遇到这个用例。我实现了[gens's answer](https://stackoverflow.com/a/25469948/5471051)，添加了一种递归方法来处理也是 dicts 的值：

```
def mutate_dict_in_place(f, d):
    for k, v in d.iteritems():
        if isinstance(v, dict):
            mutate_dict_in_place(f, v)
        else:
            d[k] = f(v)

# Exemple handy usage
def utf8_everywhere(d):
    mutate_dict_in_place((
        lambda value:
            value.decode('utf-8')
            if isinstance(value, bytes)
            else value
        ),
        d
    )

my_dict = {'a': b'byte1', 'b': {'c': b'byte2', 'd': b'byte3'}}
utf8_everywhere(my_dict)
print(my_dict) 
```

这在处理在 Python 2 中将字符串编码为字节的 json 或 yaml 文件时很有用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-20T10:16:42.877

*   我映射字典的方式

```
def f(x): return x+2
bill = {"Alice": 20, "Bob": 10}
d = {map(lambda x: f(x),bill.values())}
print('d: ',dict(d)) 
```

结果

```
: d:  {22: 12} 
```

*   映射字典中的值中的可迭代

```
bills = {"Alice": [20, 15, 30], "Bob": [10, 35]}
d= {map(lambda v: sum(v),bills.values())}
g= dict(map(lambda v: (v[0],sum(v[1])),bills.items()))
# prints
print('d: ',dict(d))
print('g: ',g) 
```

结果

```
d:  {65: 45}
g:  {'Alice': 65, 'Bob': 45} 
```

# java - 编译 ExamPeekableQueueImpl 程序时出错

> ID：12229072
> 
> 赞同：-1
> 
> 时间：2012-09-01T15:33:19.613
> 
> 标签：java

`ExamPeekableQueueImpl`编译程序时出现错误。它向我显示了界面预期的错误并且找不到符号`ExamPeekableQueue`。请帮我解决这些问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T15:50:49.743

如果它们在不同的包中，请确保将您的接口导入到类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T15:36:35.813

您的实现类`ExamPeekableQueueImpl`找不到接口`ExamPeekableQueue`。如果接口在另一个包中，则需要将其导入`ExamPeekableQueueImpl`.

# tinymce - 在 TinyMCE 编辑器中显示 iframe 的内容（不是占位符）

> ID：12229076
> 
> 赞同：3
> 
> 时间：2012-09-01T15:33:33.973
> 
> 标签：tinymce

有没有办法在 TinyMCE 编辑器中显示嵌入 iframe 的实际内容/渲染，而不仅仅是默认设置的占位符？请参阅下面的附加屏幕截图：

![iframe 占位符](../Images/ac157df629904fc9c685e1850b53d03d.png)

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-06T09:04:47.077

占位符是由[媒体插件](http://www.tinymce.com/wiki.php/Plugin%3amedia)引起的。检查您的[插件](http://www.tinymce.com/wiki.php/Configuration%3aplugins)配置。然而，禁用它也会导致 Flash 对象等的占位符消失。

# ios - 点击时如何将 UISegmentControl 添加到 UITableView 中的 CustomCell？

> ID：12229078
> 
> 赞同：0
> 
> 时间：2012-09-01T15:33:49.500
> 
> 标签：ios, uitableview, uisegmentedcontrol

我有带有图像的自定义单元格（来自情节提要）和 UILabel，单元格的正常高度为 44。当我单击自定义单元格时，我展开单元格高度，再次单击单元格，它折叠到正常高度。展开后，在额外的空间中，我想添加 UISegment 控件。在 didSelectRowAtIndexPath 方法中，我添加了segmentedControl，但这是为了在我每次单击时使分段控件遍布整个位置。我不知道该怎么做。我是否应该使用分段控件制作另一个自定义单元格，并根据单元格是否展开加载适当的自定义单元格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T15:40:43.830

我认为你的第二种方法会很好。您必须在某些条件下添加分段控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T15:44:03.713

如果我是你，我会在创建单元格时添加 UISegmentControl，使用 hidden = YES 或将其置于单元格边界之外并在单元格上设置 clipToBounds = YES。

# javascript - 在 Node.js 服务器和浏览器之间共享二进制缓冲区

> ID：12229079
> 
> 赞同：18
> 
> 时间：2012-09-01T15:34:11.677
> 
> 标签：javascript, node.js, socket.io

存在如何在 node.js 和包含二进制数据的浏览器之间共享缓冲区的问题。我对[Socket.io](http://socket.io)作为传输层非常满意，但问题是没有为浏览器移植[Buffer 类。](http://nodejs.org/api/buffer.html)无论如何我都找不到

我也遇到过[binary.js](http://binaryjs.com/)，我想知道是否有一种好的方法可以将它们组合在一起，将 socket.io 作为传输层，将 Binary.js 作为数据介质。我也看到了这个[问题](https://stackoverflow.com/questions/8880571/convert-nodejs-buffer-to-browsers-javascript)，这是一种主题，但并没有真正解决问题。

我知道 socket.io 添加了二进制支持，但我没有找到关于该主题的任何文档。

**更新：**

看来 binary.js 不会是解决方案。我想要的基本要求是与浏览器共享 Buffer 在节点中具有的相同功能。

我的需求包括两件事：

1.  在服务器和浏览器中以相同的方式处理缓冲区。

2.  支持二进制数据。

我可能会使用数组缓冲区。

编辑：由于 node.js 在 V8 上运行，您可以使用 ArrayBuffer。好像问题已经解决了。然而，据我所知，节点人员认为创建缓冲区模块并在他们创建的 C 绑定中管理它是一个好主意（来自 Ryan Dahl 的演讲）。我认为这与如何通过网络进行缓冲有关。这意味着 ArrayBuffer 仍然不是服务器和浏览器之间共享的良好数据介质。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T22:33:52.417

[浏览器缓冲区](https://github.com/arextar/browser-buffer)在浏览器中模拟 Node 的`Buffer`API。

它由支持[`Uint8Array`](https://developer.mozilla.org/en-US/docs/JavaScript_typed_arrays/Uint8Array)，因此[浏览器支持](http://caniuse.com/#feat=typedarrays)是粗略的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T04:15:50.500

JavaScript 的内置字符串在内部使用宽字符。所以他们可以很容易地在每个字符位置存储一个从 0 到 255 的值。这是一个 JavaScript 语言特性，所以它在浏览器或`node.js`.

您可以使用它`charCodeAt`来提取字符串中特定位置的值，并`fromCharCode`创建一个值从 0 到 255 的字符（可以添加到字符串中）。

您可以使用各种字符串函数来操作此表单中的数据。您可以像这样使用 JavaScript 字符串常量创建常量`"\x00\x12\x34\x56"`。

# google-drive-api - 我应该多久看到一次“由于 401 导致刷新”和“刷新 access_token”

> ID：12229081
> 
> 赞同：0
> 
> 时间：2012-09-01T15:34:34.983
> 
> 标签：google-drive-api

我在任务队列中有一个 Google App Engine 任务，对我的应用最近上传到 Google Drive 帐户的文件和通过调整原始文件大小创建的新文件执行以下四个步骤。

```
1- file = service.files().get(fileId=googleDriveFileId).execute()

2- resizedImage = resizeImage(theImage,currentWidth,currentHeight,135,90);
   newImage = putGoogleDriveFile(user,resizedImage,imageName,'image/jpeg',None,"image")

3- service.permissions().insert(fileId=file_id, body=new_permission).execute()

4- service.files().delete(fileId=googleDriveFileId).execute() 
```

所有步骤都有效，所有文件都在它们应该具有正确权限的位置，等等。

但是，我的日志文件显示每一步都刷新了 access_token。

```
 URL being requested: https://www.googleapis.com/discovery/v1/apis/drive/v2/rest?userIp=0.1.0.2
2012-09-01 07:51:10.578 URL being requested: https://www.googleapis.com/drive/v2/files/0Bx4nwQIkoY_7OVE4U3JtcUVPMzQ?alt=json
2012-09-01 07:51:10.602 Refreshing due to a 401
2012-09-01 07:51:10.602 Refresing access_token
2012-09-01 07:51:11.222 putting drive file
2012-09-01 07:51:11.231 have credentials
2012-09-01 07:51:11.232 URL being requested:  https://www.googleapis.com/discovery/v1/apis/drive/v2/rest?userIp=0.1.0.2
2012-09-01 07:51:11.478 URL being requested: https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&alt=json
2012-09-01 07:51:11.505 Refreshing due to a 401
2012-09-01 07:51:11.505 Refresing access_token
2012-09-01 07:51:13.676 setting permissions
2012-09-01 07:51:13.682 have credentials
2012-09-01 07:51:13.684 URL being requested: https://www.googleapis.com/discovery/v1/apis/drive/v2/rest?userIp=0.1.0.2
2012-09-01 07:51:13.777 URL being requested: https://www.googleapis.com/drive/v2/files/0Bx4nwQIkoY_7dXhUbWdLaU9feUU/permissions?alt=json
2012-09-01 07:51:13.803 Refreshing due to a 401
2012-09-01 07:51:13.803 Refresing access_token
2012-09-01 07:51:14.484 have credentials
2012-09-01 07:51:14.485 URL being requested: https://www.googleapis.com/discovery/v1/apis/drive/v2/rest?userIp=0.1.0.2
2012-09-01 07:51:14.656 URL being requested: https://www.googleapis.com/drive/v2/files/0Bx4nwQIkoY_7UUJadzNGa2oxRjA
2012-09-01 07:51:15.098 Refreshing due to a 401
2012-09-01 07:51:15.098 Refresing access_token 
```

这是我应该期待的吗？在我看来，在一个循环中运行的四个操作的一个 access_token 就足够了。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:19:48.730

一个典型的 access_token 持续一小时。我的猜测是每个请求仍在使用过期的令牌而不是闪亮的新令牌。

# python - python 正则表达式 findall

> ID：12229082
> 
> 赞同：0
> 
> 时间：2012-09-01T15:34:41.567
> 
> 标签：python, regex

我想找到和之间的所有 `<span class="">` 东西`</span>`

```
p = re.compile('<span class=\"\">(.*?)\</span>', re.IGNORECASE)
text = re.findall(p, z) 
```

例如在这种情况下`<span class="">foo</span>`预期返回 foo 但它返回任何东西！为什么我的代码出错了？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T15:39:26.047

由于[HTML 不是常规语言，因此您确实应该使用 XML 解析器](https://stackoverflow.com/a/1732454)。

Python有几个可供选择：

*   [ElementTree](http://docs.python.org/library/xml.etree.elementtree.html)是标准库的一部分
*   [BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)是一个流行的第三方库
*   [lxml](http://lxml.de/)是一个快速且功能丰富的基于 C 的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T15:42:47.150

您的原始代码按原样工作。不过，您应该使用 HTML 解析器。

```
import re
p = re.compile('<span class=\"\">(.*?)\</span>', re.IGNORECASE)
z = '<span class="">foo</span>'
text = re.findall(p, z)
print text 
```

输出：

```
['foo'] 
```

**编辑**

正如蒂姆指出的那样，`re.DOTALL`应该使用，否则以下将失败：

```
import re
p = re.compile('<span class="">(.*?)\</span>', re.IGNORECASE|re.DOTALL)
z = '''<span class=""> a more
complicated foo</span>'''
text = re.findall(p, z)
print text 
```

即使这样，嵌套跨度也会失败：

```
import re
p = re.compile('<span class="">(.*?)\</span>', re.IGNORECASE|re.DOTALL)
z = '''<span class=""> a more
complicated<span class="other">other</span>foo</span>'''
text = re.findall(p, z)
print text 
```

输出（失败）：

```
[' a more\ncomplicated<span class="other">other'] 
```

所以使用像[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)这样的 HTML 解析器：

```
from BeautifulSoup import BeautifulSoup
soup = bs(z)
p = re.compile('<span class="">(.*?)\</span>', re.IGNORECASE|re.DOTALL)
z = '''<span class=""> a more
complicated<span class="other">other</span>foo</span>'''
soup = BeautifulSoup(z)
print soup.findAll('span',{'class':''})
print
print soup.findAll('span',{'class':'other'}) 
```

输出：

```
[<span class=""> a more
complicated<span class="other">other</span>foo</span>]

[<span class="other">other</span>] 
```

# c# - 如何在知道同一条目中的其他值的同时获取表中的值？

> ID：12229085
> 
> 赞同：1
> 
> 时间：2012-09-01T15:34:49.623
> 
> 标签：c#, asp.net, sql, database, search

我有一张`membership`桌子，其中包括

```
MemberID(int), 
Username(varchar16), 
Password... etc. 
```

如果我只知道用户名，我将如何获得 MemberID？我正在使用 SQL ASP.Net C#。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T15:36:07.230

既然你知道`username`. 将其用作 where 子句中的条件。我在这里假设它`username`是唯一的，否则您将拥有与指定用户名匹配的所有成员 ID。

```
SELECT MemberID
FROM Membership
WHERE Username = 'usernameHere' 
```

试试这个，因为您使用的是 ADO.Net

```
// other codes heres 
string MemberID = cmd.ExecuteScalar().ToString();
// the MemberID variable already holds the value of the ID
// that matches your username. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T15:49:25.347

```
SELECT MemberId FROM Member WHERE UserName = 'username' 
```

假设 UserName 不是唯一列，它将返回与用户名匹配的多行，因此您最好在查询中添加 TOP(1)。否则，您可以执行 SqlCommand.ExecuteScalar()，这将返回与用户名匹配的第一个 MemberId

```
SqlCommand.ExecuteScalar() 
```

# sql - 使用 perl dbi 处理长时间运行的大型事务

> ID：12229091
> 
> 赞同：5
> 
> 时间：2012-09-01T15:35:33.253
> 
> 标签：sql, database, perl, dbi

我有一个大事务，包括从数据库 A 获取大量数据，对这些数据进行一些操作，然后将操作后的数据插入数据库 B。我只有在数据库 A 中选择的权限，但我可以创建表和在数据库 B 中插入/更新等。

操作和插入部分是用 perl 编写的，并且已经用于从其他数据源将数据加载到数据库 B 中，因此所需的只是从数据库 A 获取必要的数据并使用它来初始化 perl 类。

如果在操作或插入过程中发生任何错误（数据库断开连接、由于无效值导致的类初始化问题、硬盘故障等），我该如何着手执行此操作，以便我可以轻松地追溯并从错误发生的位置找到错误发生的位置。 .)？一次性完成交易似乎不是一个好的选择，因为来自数据库 A 的大量数据意味着数据操作和插入数据库 B 至少需要一两天的时间。

来自数据库 A 的数据可以使用唯一键分为大约 1000 个组，每个键包含 1000 行。我认为我可以做的一种方法是编写一个每个组执行提交的脚本，这意味着我必须跟踪哪个组已经插入到数据库 B 中。我能想到的唯一方法是跟踪哪些组的进度是否被处理在日志文件或数据库 B 的表中。我认为可行的第二种方法是将加载类以进行操作和插入到平面文件中所需的所有必要字段转储，读取文件以进行初始化类并插入数据库 B。这也意味着我必须进行一些日志记录，但如果发生任何错误，应将其缩小到平面文件中的确切行。该脚本将如下所示：

```
use strict;
use warnings;
use DBI;

#connect to database A
my $dbh = DBI->connect('dbi:oracle:my_db', $user, $password, { RaiseError => 1, AutoCommit => 0 });

#statement to get data based on group unique key
my $sth = $dbh->prepare($my_sql);

my @groups; #I have a list of this already

open my $fh, '>>', 'my_logfile' or die "can't open logfile $!";

eval {
    foreach my $g (@groups){
        #subroutine to check if group has already been processed, either from log file or from database table
        next if is_processed($g);

        $sth->execute($g);
        my $data = $sth->fetchall_arrayref;

        #manipulate $data, then use it to load perl classes for insertion into database B
        #.
        #.
        #.
    }
    print $fh "$g\n";
};
if ($@){
   $dbh->rollback;
   die "something wrong...rollback";
} 
```

So if any errors do occur, I can just run this script again and it should skip the groups or rows that have been processed and continue.

Both these methods is just variations on the same theme, and both require going back to where I've been tracking my progress (in table or file), skip the ones that've been commited to database B and process the remaining data.

I'm sure there's a better way of doing this but am struggling to think of other solutions. Is there another way of handling large transactions between databases that require data manipulation between getting data out from one and inserting into another? The process doesn't need to be all in Perl, as long as I can reuse the perl classes for manipulating and inserting the data into the database.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:37:21.247

很抱歉这么说，但我真的不明白你怎么可能通过走捷径来解决这个问题。对我来说，听起来你已经考虑了最合理的方法：

*   在每个步骤中将状态保存在某个临时表/文件中（我会查看“perldoc -f tie”或 sqlite）
*   正确处理错误 TryCatch.pm、eval 或任何你喜欢的
*   正确记录您的错误，即您可以阅读的结构化日志
*   将一些“恢复”标志添加到您的脚本中，该标志会读取以前的日志和数据并重试

这可能与您一直在考虑的思路一致，但正如我所说，我认为没有一种通用的“正确”方法来处理您的问题。

# php - 将分类过滤器添加到自定义帖子类型

> ID：12229095
> 
> 赞同：0
> 
> 时间：2012-09-01T15:35:50.340
> 
> 标签：php, wordpress

大约两年前在 Wordpress Answer 网站上进行了一次[精彩的对话](https://wordpress.stackexchange.com/questions/578/adding-a-taxonomy-filter-to-admin-list-for-a-custom-post-type)，其中许多人提出了很好的解决方案，可以为您的自定义帖子类型添加分类过滤器到管理屏幕（请参阅我所指的屏幕的 URL） ：

```
http://[yoursite.com]/wp-admin/edit.php?s&post_status=all&post_type=[post-type] 
```

无论如何，我喜欢 Michael 的出色贡献，但最终还是使用了 Somatic 的实现以及 Manny 的层次结构选项。我把它放在一个班级里——因为这就是我喜欢做的事情——而且它几乎可以工作。下拉列表出现，但下拉列表中的值都在 $_GET 属性中查找您正在过滤的分类 slug-name。出于某种原因，我什么也得不到。我查看了下拉列表的 HTML，对我来说似乎没问题。这是一些上下文的快速屏幕截图：

![在此处输入图像描述](../Images/34bc9c43484993a1716d78a752d33288.png)

您可以从中看出我的帖子类型称为“锻炼”，而我试图用作过滤器的分类法是“动作”。下面是下拉列表周围的 HTML：

```
<select name="actions" id="actions" class="postform">
   <option value="">Show all Actions</option>
   <option value="ate-dinner">Ate dinner(1)</option>
   <option value="went-running">Went running(1)</option>
</select> 
```

我还确认所有表单元素都在 DOM 的一部分内。然而，如果我选择“开始运行”并单击过滤器按钮，URL 查询字符串会返回，而不会引用我选择的内容。

更明确地说，页面首先使用以下 URL 加载：

```
/wp-admin/edit.php?post_type=exercise 
```

在从动作过滤器中选择“开始运行”作为选项的同时按下过滤器按钮后：

```
/wp-admin/edit.php?s&post_status=all&post_type=exercise&action=-1&m=0&actions&paged=1&mode=list&action2=-1 
```

实际上，您可以看到对“操作”变量的引用，但它被设置为空，正如我现在详细查看的那样，当我在页面上点击“过滤器”时，它会将过滤器下拉重置为默认的“显示全部”行动”。谁能帮我这个？

顺便说一句，我在这里附上了 PHP 代码（尽管我现在开始倾向于它是一个 js 问题）：[gist](https://gist.github.com/3576599)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:35:33.457

我遇到了同样的问题并添加了一个小修复，基本上检查是否设置了分类 $_GET 参数。我希望它有帮助：

```
add_action( 'restrict_manage_posts', 'my_restrict_manage_posts' );
function my_restrict_manage_posts() {
    global $typenow;
    $taxonomy = 'mytaxonomy'; // Change this

    if( $typenow != "page" && $typenow != "post" ){
        $filters = array($taxonomy);

        foreach ($filters as $tax_slug) {
            $tax_obj = get_taxonomy($tax_slug);
            $tax_name = $tax_obj->labels->name;
            $terms = get_terms($tax_slug);

            echo "<select name='$tax_slug' id='$tax_slug' class='postform'>";
            echo "<option value=''>Show All $tax_name</option>";

            foreach ($terms as $term) { 
                $label = (isset($_GET[$tax_slug])) ? $_GET[$tax_slug] : ''; // Fix
                echo '<option value='. $term->slug, $label == $term->slug ? ' selected="selected"' : '','>' . $term->name .' (' . $term->count .')</option>';
            }

            echo "</select>";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-24T13:58:20.027

[试试这门课](http://en.bainternet.info/add-taxonomy-filter-to-custom-post-type/)，效果很好

# java - 排序数组，排序数组列表，使用集合

> ID：12229098
> 
> 赞同：0
> 
> 时间：2012-09-01T15:36:13.553
> 
> 标签：java, arrays, string, primitive-types

好的，还在学习数组。我编写了这段代码，它用 0 到 1（不包含）之间的随机数填充名为“rand”的数组。我想开始学习复杂性。For循环执行n次（100次），每次都需要O（1）时间，所以最坏的情况是O（n），对吗？此外，我使用 ArrayList 来存储 100 个元素，并导入“Collections”并使用 Collections.sort() 方法对元素进行排序。

```
import java.util.Arrays;
    public class random
    {
        public static void main(String args[])
        {
            double[] rand=new double[10];

                    for(int i=0;i<rand.length;i++)
                    {
                        rand[i]=(double) Math.random();
                        System.out.println(rand[i]);
                    }   

                    Arrays.sort(rand);
                    System.out.println(Arrays.toString(rand));
        }
    } 
```

数组列表：

```
import java.util.ArrayList;
import java.util.Collections;

public class random
{
    public static void main(String args[])
    {
        ArrayList<Double> MyArrayList=new ArrayList<Double>();

        for(int i=0;i<100;i++)
        {               
            MyArrayList.add(Math.random());
        }

        Collections.sort(MyArrayList);

        for(int j=0;j<MyArrayList.size();j++)
        {
            System.out.println(MyArrayList.get(j));
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T15:48:46.673

是的，你是对的，添加 N 个项目的复杂度是 O(N)。根据文档，在大多数情况下，排序需要额外的 O(N * log(N)) ：

> 排序算法是一种调整过的快速排序，改编自 Jon L. Bentley 和 M. Douglas McIlroy 的“Engineering a Sort Function”，Software-Practice and Experience，Vol。23(11) P. 1249-1265（1993 年 11 月）。该算法在许多数据集上提供 n*log(n) 性能，导致其他快速排序降低到二次性能。

`ArrayList`仍然由数组支持，因此复杂性将是相同的，除非偶尔调整大小，否则无论如何都会摊销。

# client-server - 了解分布式系统中的遗漏失败

> ID：12229099
> 
> 赞同：0
> 
> 时间：2012-09-01T15:36:18.520
> 
> 标签：client-server, distributed-computing

以下文字说明了这一点，我不能完全同意：

客户端 C 向服务器 S 发送请求 R。通信链路通过该链路传输 R 所花费的时间为 D。P 是 S 接收、处理和回复 R 所需的最长时间。如果假设遗漏失败；那么如果在 2(D+P) 内没有收到对 R 的回复，那么 C 将永远不会收到对 R 的回复。

为什么这里的时间是 2(D+P)。据我了解，它不应该是 2D+P 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:07:49.413

通过超时检测由于进程崩溃或由于通信链路故障而导致的遗漏故障。
但是在异步系统中，超时仅*表明*进程没有响应。由于繁重的处理负载，另一个进程*可能*已经崩溃或只是*变慢了。*
所以通常作为超时，我们选择一个*最大*时间段。所以这可能是 the`2(D+P)`而不是你的 strict `2D+P`。最大时间允许考虑网络变得拥塞，因此响应返回速度变慢/过程中的处理速度变慢以及处理响应的时间`R`客户端从传入缓冲区读取消息并进行处理需要将其传递到应用程序级别。
因此，我无法准确地告诉您书中的公式中的哪些帐户，但我可以告诉您，尽管在超时时我们并不像您期望的那样严格。

# python - 在 IDAPro 之外调试 IDAPython 脚本

> ID：12229101
> 
> 赞同：0
> 
> 时间：2012-09-01T15:36:57.947
> 
> 标签：python, debugging, reverse-engineering, ida

我对 IDA 脚本编写有点陌生——不过，我编写了一个需要调试的复杂脚本，因为它不能正常工作。

它由包含几个不同类的几个不同文件组成。由于显而易见的原因，在命令行中逐行编写是无效的。从文件运行整个脚本不允许调试。

**有没有办法在 IDA 之外使用 idc、idautils、idaapi？**

我已经在 Eclipse 的 PyDev 上编写了脚本，我希望有一种方法可以在其中运行脚本。

一个类似的问题是，**我提到的 api 类可以在没有 IDA 加载的情况下处理 idb 文件吗？**

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:12:37.670

现在我可能错了，因为我很久没有写任何 IDA 脚本了。但据我记得你的第一个问题的答案是否定的。有一部分会加载 IDA 脚本并准备整个环境，以便您可以重新实现它并创建自己的环境，但我不建议这样做。

我可以告诉您的是，如果您的目标是自动化，请考虑从命令行运行您的脚本。IDA python（以及任何其他 IDA 插件）对从命令行运行脚本有很好的支持。为了提高性能，您还可以运行 IDA 的 TUI 版本。

还有一个 hack 可以让你在 IDA 脚本的中间启动一个新的 python 解释器。它对于调试当前状态很有用，但您仍然需要每次编辑 python 文件来启动解释器。这是黑客：

```
import code
all = globals()
all.update(locals())
code.interact(local = all) 
```

无论如何-日志很好，调试打印也可以。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T09:03:35.987

我们刚刚收到一位用户的通知，最新版本的 WingIDE 支持调试 IDAPython 脚本。我认为有几个其他程序使用相同的方法（导入一个模块来进行 RPC 调试）可能会起作用。

# integer - 乘整数.MAX_VALUE

> ID：12229104
> 
> 赞同：1
> 
> 时间：2012-09-01T15:37:04.883
> 
> 标签：integer

我正在尝试将`integer.MAX_VALUE`（即 2147483647）乘以 2。当我执行程序时，它显示`integer.MAX_VALUE`为 -2。

为什么是-2？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T15:39:12.000

许多现代计算机体系结构将二进制整数表示为二进制[补码](http://en.wikipedia.org/wiki/Two%27s_complement)。

将 2147483647 添加到自身会导致溢出，从而导致 -2 表示。

```
 011111111111111111111111
+011111111111111111111111
-------------------------
 111111111111111111111110 
```

从上面你可以看到符号位（第一个）现在是 1，表示负数，除最后一个之外的所有其他位都是 1，一起表示二进制补码中的 -2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T15:45:53.240

带符号的 32 位整数。0111 1111 1111 1111 1111 1111 1111 1111 *2 1111 1111 1111 1111 1111 1111 1111 1110

第一位代表符号。溢出会导致符号改变。

1111 1111 1111 1111 1111 1111 1111 1110 为-2

[http://en.wikipedia.org/wiki/Integer_%28computer_science%29](http://en.wikipedia.org/wiki/Integer_%28computer_science%29)

我推荐的另一个实验是使用无符号整数 (uint) 进行尝试。

# php - 如何消除 php5 Strict 标准错误？

> ID：12229113
> 
> 赞同：26
> 
> 时间：2012-09-01T15:39:13.893
> 
> 标签：php, cakephp, cakephp-1.3

将我的 PHP 升级到 5.4.3（WAMP 服务器 2.2）后，我在 CakePHP 1.3 中制作的 Web 应用程序在我的索引中显示以下错误：

> 严格标准：在第 63 行重新定义 C:...\cake\cake\libs\object.php 中已定义的类 Object 的构造函数
> 
> 严格标准：非静态方法 Configure::getInstance() 不应在第 49 行的 C:...\cake\cake\bootstrap.php 中静态调用

我发现有些人通过将`error_reporting`php.ini 中的设置为`E_ALL & ~E_STRICT`.

我在我的计算机上的两个 php.ini 文件（C:\wamp\bin\php\php5.4.3 和 C:\wamp\bin\apache\apache2.4.2\bin）中都这样做了，但它没有解决问题.

我也尝试`php_value error_reporting 6143`输入 C:...\cake.htaccess 但没有成功。

有谁知道我该如何解决这个问题？由于火鸟，我无法升级我的 CakePHP。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-01T15:50:53.490

php 5.4 的变化之一是 E_STRICT 现在是 E_ALL 的一部分

因此，在您的 /cake/bootstrap.php 中，您可以从错误报告中删除 E_STRICT：

```
error_reporting(E_ALL ^ E_STRICT); 
```

并再次与 5.4 之前的版本兼容。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-18T22:28:41.323

如果你想更新你的蛋糕版本，那么不要修改蛋糕核心文件，这很糟糕，进入你的 Config/core.php 文件并查找错误处理程序配置：

```
Configure::write('Error', array(
    'handler' => 'ErrorHandler::handleError',
    'level' => E_ALL & ~E_DEPRECATED,
    'trace' => true
)); 
```

并将“级别”替换为：

```
...
'level' => E_ALL & ~E_STRICT & ~E_DEPRECATED,
... 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-18T16:21:55.837

请更换

```
error_reporting = E_ALL 
```

在你的*php.ini*中，用

```
error_reporting = E_ALL & ~E_STRICT 
```

为了我

```
error_reporting(E_ALL ^ E_STRICT); 
```

这在该问题的已接受答案中显示不起作用，并在我的 Joomla 网站**的 JError 错误中检测到无限循环。**

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-10T18:09:19.420

您正在使用较新的 php 版本。在 php 5.4 中，E_STRICT 是 E_ALL 的一部分

在 cake 1.3 中，打开文件 /cake/bootstrap.php 并像这样更改 error_reporting

```
error_reporting(E_ALL & ~E_STRICT & ~E_DEPRECATED); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-23T19:08:12.243

如果您在蛋糕控制台输出中遇到 PHP Strict 警告，请查看您的`app/config/core.php`.

在 CakePhp 1.3`error_reporting(...)`中被`'log'`选项覆盖，因此请确保您在此处排除`E_STRICT`：

```
/**
 * CakePHP Log Level:
 *
 * In case of Production Mode CakePHP gives you the possibility to continue logging errors.
 *
 * The following parameters can be used:
 *  Boolean: Set true/false to activate/deactivate logging
 *    Configure::write('log', true);
 *
 *  Integer: Use built-in PHP constants to set the error level (see error_reporting)
 *    Configure::write('log', E_ERROR | E_WARNING);
 *    Configure::write('log', E_ALL ^ E_NOTICE);
 */
Configure::write('log', E_ALL & ~E_DEPRECATED & ~E_STRICT & ~E_NOTICE); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-01T15:42:54.240

确保您已更新正确的 php.ini 文件 - 如果您使用以下代码在根目录中创建 php 文件

```
<?php

phpinfo();

?> 
```

并将其加载到您的网络浏览器中，它会告诉您正在使用哪个 ini 文件，以防您错过了一个。

htaccess 文件也可能通过值设置该`php_flag error_reporting`值，也可以按目录设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-27T18:37:55.600

从文件夹（根）cake 文件 bootstrap.php

```
if (!defined('E_ALL')) {
    define('E_ALL', 8192);
} 
```

File debugger.php from folder (root)cake\libs

```
error_reporting(E_ALL ^ ~E_STRICT ^ ~E_DEPRECATED); 
```

# jquery - jQuery 滑块 | 数量取决于两个滑块的值

> ID：12229116
> 
> 赞同：0
> 
> 时间：2012-09-01T15:40:03.373
> 
> 标签：jquery, uislider

我坚持以下几点：

根据尺寸和订单大小，我有不同价格的产品。例子。1x 小号 = $10,-- 2x 小号 = $17,50 3x 小号 = $20,--

我在一个滑块中有这个，其中句柄设置订单大小和金额显示订单的价格。但现在我想添加另一个滑块来选择其他产品尺寸（中、大）

第二个滑块的值将影响总价。

```
If slider1 = 1 (piece)
and if slider2 = Small
then Price =  $ 10,--

If slider1 = 1 (pieces)
and if slider2 = Medium
then Price = $ 12,50 
```

等等等等

所以总订单价格取决于两个滑块的值。请有人帮我解决这个问题吗？

现在我有这个：

```
$(function() {
    var sizes1 = ["10", "17,50", "20"];
    $("#slider").slider({
        value: 0,
        min: 0,
        max: sizes1.length - 1,
        step: 1,
        slide: function(event, ui) {
            $("#amount").val(sizes1[ui.value]);
        }
    });
    $("#amount").val('10');
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:01:39.623

移动滑块时，更改总值：

```
var sizes1 = ["10", "17,50", "20"];
var sizes2 = ["12,50", "...", "..."];
var sizes3 = ["...", "...", "..."];

function calculateprice() {
    var slider1 = $("#slider1").slider("value");
    var slider2 = $("#slider2").slider("value");

    if (slider2 == 1) $("#amount").val(sizes1[slider1]); //Small
    if (slider2 == 2) $("#amount").val(sizes2[slider1]); //Medium
    //etc
}

//create your 2 slides
$("#slider1").slider({
    value: 0,
    min: 0,
    max: sizes1.length - 1,
    step: 1,
    slide: function(event, ui) {
        calculateprice();
    }
});

//etc 
```

# php - 为什么 Symfony2 不捕获异常

> ID：12229120
> 
> 赞同：3
> 
> 时间：2012-09-01T15:40:51.493
> 
> 标签：php, symfony, exception-handling

我有一个存储库

```
class TurnoRepository extends EntityRepository
{
    public function findTurnoActivo()
    {
        $q = $this
            ->createQueryBuilder('t')
            ->where('t.activo = :activo')
            ->setParameter('activo', true)
            ->getQuery();

        return $q->getSingleResult();
    }
} 
```

此方法抛出 NoResultException 但如果我尝试在我的控制器中捕获

```
private function obtenerTurno()
{
    $em = $this->getDoctrine()->getEntityManager();
    $turno = null;

    try {
        $turnoActivo = $em->getRepository('MyBundle:Turno')->findTurnoActivo();
    } catch (NoResultException $e) {
        return false;
    }

    return $turno; 
```

}

我总是在我的页面上收到 500 Internal Server Error

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T15:44:09.060

Symfony2 代码是命名空间的，所以你必须为类添加正确的命名空间`NoResultException`，尝试使用：

```
catch (\Doctrine\ORM\NoResultException $e) 
```

注意 Doctrine 命名空间前面的反斜杠或`NoResultException`使用`use`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T16:24:11.200

`$q->getOneOrNullResult();`如果您不想`NoResultException`在控制器中捕获，则可以使用。

# closures - 为什么这个（javascript）关闭失败？

> ID：12229122
> 
> 赞同：0
> 
> 时间：2012-09-01T15:40:54.003
> 
> 标签：closures, qunit

变量“被调用”是假的，什么时候应该设置为真..为什么会这样？当被插件调用时它被设置为 true，但在闭包之外它仍然是 false。有点莫名其妙。在此先感谢您的任何指点。

```
(function() {
    module("when InitializedApplication() is called");
    test("it should call the success function", function () {
    // arrange
    $("#qunit-fixture").append(
        '<script id="events-catalog-view-template"' +
        '        type="text/html"'+
        '        src="_events-catalog.view.html">' +
        '</script>' +
        '<div id="events-catalog-view-container"' +
        '     data-bind="template: {' +
        '             name="events-catalog-view-template" ' +
        '             afterRender="tpw.mediator.eventscatalog.setupViewDataBinding" ' +
        '          }"' + 
        '</div>'
    );              

    var called = false;

    // act
    var init = TPW.InitializeApplication();

    init({
        logLevel: "debug",
        success: function (successfullResolution) {                               
            called = true;
        },
        error: function (failedResolution) {                            
        }
    });

    // assert                
    ok(called, "success function called");
    });    
})(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T09:11:53.557

`ok()`在成功回调之前调用了qunit函数。异步问题。

# python - 堆叠numpy数组？

> ID：12229124
> 
> 赞同：3
> 
> 时间：2012-09-01T15:41:12.047
> 
> 标签：python, arrays, numpy

我正在尝试使用 numpy hstack 水平堆叠数组，但无法使其正常工作。相反，它全部出现在一个列表中，而不是一个“矩阵外观”的二维数组。

```
import numpy as np
y = np.array([0,2,-6,4,1])
y_bool = y > 0
y_bool = [1 if l == True else 0 for l in y_bool] #convert to decimals for classification
y_range = range(0,len(y))
print y
print y_bool
print y_range
print np.hstack((y,y_bool,y_range)) 
```

打印这个：

```
[ 0  2 -6  4  1]
[0, 1, 0, 1, 1]
[0, 1, 2, 3, 4]
[ 0  2 -6  4  1  0  1  0  1  1  0  1  2  3  4] 
```

我如何让最后一行看起来像这样：

```
[0 0 0
 2 1 1
-6 0 2
 4 1 3] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T15:43:08.563

如果要创建二维数组，请执行以下操作：

```
print np.transpose(np.array((y, y_bool, y_range)))
# [[ 0  0  0]
#  [ 2  1  1]
#  [-6  0  2]
#  [ 4  1  3]
#  [ 1  1  4]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T15:43:21.523

好吧，h 足够接近水平/列，如果你检查它的帮助，你会在*See Also*

```
vstack : Stack arrays in sequence vertically (row wise).
dstack : Stack arrays in sequence depth wise (along third axis).
concatenate : Join a sequence of arrays together. 
```

编辑：首先想到`vstack`的是它，但它会是 if`np.vstack(...).T`或`np.dstack(...).squeeze()`. 除此之外，“问题”是数组是一维的，你希望它们像二维一样，所以你可以这样做：

```
print np.hstack([np.asarray(a)[:,np.newaxis] for a in (y,y_bool,y_range)]) 
```

是否`np.asarray`存在以防万一变量之一是列表。这`np.newaxis`使它们成为 2D 以更清楚地连接时发生的情况。

# jsf - 部署到 JBoss 时忽略 JSF 注释

> ID：12229128
> 
> 赞同：1
> 
> 时间：2012-09-01T15:42:09.473
> 
> 标签：jsf, jboss, application-server

我的简单 JSF 应用程序在 JBoss 7 上运行，但是当我将它部署到 Jetty 时 - JSF 注释被忽略，我必须在 faces-config.xml 中定义 ManagedBean 以使其工作，因为当我提交表单时 managedBean 解析为 null。在 pom.xml 依赖项中没有提到 JBoss，所以看起来 JSF 默认与 JBoss 绑定。

如何让项目不再与 JBoss 成为好朋友？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:13:40.420

JSF 2.0 是 Java EE 规范的一部分，因此它绝对不会特别绑定到应用程序服务器。您应该检查 Web 容器 (Jetty) 的版本是否支持 JSF 2.0，并且您已经添加了所有必需的依赖项。希望它可以帮助弗朗西斯科

# iphone - 为 UITableViewCellAccessoryCheckmark 选择一个单元格，其他单元格自动取消选中

> ID：12229138
> 
> 赞同：0
> 
> 时间：2012-09-01T15:43:05.923
> 
> 标签：iphone, ios, xcode, uitableview

一旦我在 UITableView 中选择了一个单元格，我希望取消选中其他单元格。准确地说，我希望在编辑模式下只检查一个单元格的 UITableViewCellAcessoryCheckmark 。这怎么可能？我尝试通过故事板和代码中的检查器进行操作，但没有任何效果。

任何有不同解决方法的人？

PS：我在 Messages.app 中添加类似于编辑的复选标记。

# sharepoint-2010 - 将反馈文本框添加到 sharepoint 2010 wiki 库中的所有页面

> ID：12229146
> 
> 赞同：0
> 
> 时间：2012-09-01T15:44:25.983
> 
> 标签：sharepoint-2010

我正在创建一个 SharePoint 2010 网站，我已在其中放置了 wiki 库中的内容。我想在每一页上都有一个反馈文本框。单击提交时，有两个选项，我可以将反馈文本存储在另一个自定义 SharePoint 列表中或将其配置为发送电子邮件。

请指导我如何添加反馈文本框？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:15:30.990

您可以使用“社交协作”部分中的开箱即用“记事板”Web 部件来执行此操作。如果您启用了发布，您可以将其添加到页面布局中。这会将它添加到每个 wiki 页面。

如果未启用发布，则必须将 Web 部件单独添加到每个页面。

这具有利用 SharePoint 2010 中现有社交功能的额外优势。这意味着您将能够看到您从 MySite 添加的笔记，并将与同事共享。

# php - Hiphop PHP：CodeError.js 总是包含 0 个错误

> ID：12229150
> 
> 赞同：1
> 
> 时间：2012-09-01T15:44:34.347
> 
> 标签：php, hiphop

我使用 Ubuntu 12.04（64 位）。

我使用本手册从源代码编译 hiphop：[https ://github.com/facebook/hiphop-php/wiki/Building-and-installing-HHVM-on-Ubuntu-12.04](https://github.com/facebook/hiphop-php/wiki/Building-and-installing-HHVM-on-Ubuntu-12.04)

hphp 运行良好，但我总是看到我的 CodeError.js 是这样的：

```
[0,{}
] 
```

为了了解发生了什么，我创建了一个“errors.php”文件：

```
<?php
// just in case
error_reporting(E_ALL);

// undefined variable
$a = $b;

// wrong optional params order
function test($x=false, $y)
{
    // undefined variable
    return $value;
}

// wrong function call
test();

// undefined function call, etc...
test_bad_function();

echo $undefined_variable;
?> 
```

之后，我让 HipHop 使用命令分析文件：

```
$HPHP_HOME/src/hphp/hphp  /home/frost/errors.php --output-dir=$OUTPUT_DIR --log=4 --force=1 --keep-tempdir=1 --target=analyze 
```

控制台输出：

```
running hphp...
Analyzing Includes
Analyzing All
Corrected function return type Boolean -> Variant
Corrected function return type [0x1] -> Variant
Corrected function return type [0x1] -> Object - iterator
Analyzing Includes
Analyzing All
Analyzing Includes
Analyzing All
parsing inputs...
parsing /home/frost/errors.php ...
Analyzing Includes
Analyzing All
parsing inputs took 0'00" (5 ms) wall time
pre-optimizing...
pre-optimizing took 0'00" (4 ms) wall time
analyze includes...
analyze includes took 0'00" (0 ms) wall time
inferring types...
inferring types took 0'00" (3 ms) wall time
post-optimizing...
post-optimizing took 0'00" (7 ms) wall time
saving code errors and stats...
saving stats...
saving stats took 0'00" (9 ms) wall time
all files saved in /home/frost/hiphop/reports ...
running hphp took 0'00" (195 ms) wall time 
```

HipHop 创建了 2 个文件：Stats.js 和 CodeError.js

Stats.js 内容：

```
{
"FileCount":1,
"LineCount":21,
"CharCount":363,
"FunctionCount":2,
"ClassCount":0,
"TotalTime":0,
"AvgCharPerLine":17,
"AvgLinePerFunc":10,
"SymbolTypes":
{
    "Array":20,
    "Boolean":8,
    "Double":19,
    "Int64":2248,
    "Object":3,
    "Object - Specific":20,
    "Primitive":13,
    "String":134,
    "Variant":306,
    "_all":2771,
    "_strong":2452,
    "_weak":319
    }
    ,"VariableTableFunctions":[]
} 
```

CodeError.js 内容：

```
[0,{}
] 
```

怎么会这样？我错过了什么？

* * *

有趣的事实：Stats.js 每次都会创建，即使我设置了 --gen-stats=0

# ruby-on-rails - 在 Rails 中调用私有方法？

> ID：12229153
> 
> 赞同：11
> 
> 时间：2012-09-01T15:44:50.977
> 
> 标签：ruby-on-rails

我有两种这样的方法

```
def process
  @type = params[:type]
  process_cc(@type)
end

private

def process_cc(type)
  @doc = Document.new(:type => type)
  if @doc.save
    redirect_to doc_path(@doc)
  else
    redirect_to root_path, :notice => "Error"
  end
end 
```

我想要，当我从进程调用 process_cc 时，它会创建文档并随后重定向到 doc_path。也许我期待行为，这是 rails 无法处理的，但是 process 方法不会调用 process_cc 方法，而是尝试渲染模板......

对此有何建议？

谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-08-14T02:43:32.930

`Object#send`使您可以访问对象的所有方法（甚至是受保护的和私有的）。

```
obj.send(:method_name [, args...]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T20:59:24.210

Action Controller 有一个内部方法，称为`process`您的方法正在屏蔽。为您的操作选择一个不同的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-11T15:19:41.150

改变这个：

```
def process_cc(type)
  @doc = Document.new(:type => type)
  if @doc.save
    redirect_to doc_path(@doc)
  else
    redirect_to root_path, :notice => "Error"
  end
end 
```

至：

```
def process_cc(type)
  @doc = Document.new(:type => type)
  if @doc.save
    redirect_to doc_path(@doc) and return
  else
    redirect_to root_path, :notice => "Error" and return
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T15:52:01.453

您可以像这样调用任何（不仅仅是私有）方法

```
class SomeClass

  private
  def some_method(arg1)
    puts "hello from private, #{arg1}"
  end
end

c=SomeClass.new

c.method("some_method").call("James Bond") 
```

或者

```
c.instance_eval {some_method("James Bond")} 
```

顺便说一句，在您的代码中，尝试使用

```
self.process_cc(...) 
```

# python - 如何在 python 中发送原始以太网帧？

> ID：12229155
> 
> 赞同：5
> 
> 时间：2012-09-01T15:45:09.137
> 
> 标签：python, sockets, ethernet

我需要在几天内完成一个项目，它是一个基本的客户端和服务器接口。问题是它必须是所有原始套接字。我创建它没有问题，我只是坚持发送数据包。

首先，我尝试将其绑定到接口*“en1”*，但它一直给我一个错误`nodename not known`。当我将它绑定到我的本地 IP 地址时，它工作正常。完成此操作后，我创建了一个原始数据包类，全部为十六进制。然后我做了一个 sendto 调用以通过网络发送它。

问题是当我使用wireshark捕获数据包时，它显示为ipv4数据包的有效负载。我不希望它自动生成标题，这就是我的原始数据包类的用途。你知道我有什么办法可以取出这些标题吗？

这是我的代码 - 只有原始函数：

```
def raw():
    HOST = gethostbyname('192.168.1.10')

    s = socket(AF_INET, SOCK_RAW, IPPROTO_IP)
    s.bind((HOST, 0))

    s.setsockopt(IPPROTO_IP, IP_HDRINCL, 0) #no headers - it wont work!!

    pckt = packet("\x68\x65\x6c\x6c\x6f")
    netpacket = pckt.getpacket()

    print "Sending.. "
    print ""

    s.sendto(netpacket, ('192.168.1.1', 80))
    data = s.recv(4096)
    print data 
```

这是捕获的数据包，最后带有一个*hello*：

```
007f 2809 6da2 28cf daee 2156 0800 4500 004d 1bfc 0000 4000 db59 c0a8 010a c0a8 0101* 007f     

2809 6da2 28cf daee 2156 0800 4500 0036 2352 4000 4006 0000 c0a8 010a c0a8 0101 15c0 0050 

0000 0000 0000 0000 8010 813b 0000 68656c6c6f -hello 
```

*这个 (the `0101`) 是有效载荷的开始，即使它应该是数据包的开始。另外我不会使用任何其他模块，我必须使用套接字。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T23:42:37.510

感谢对这个问题的评论，我设法与服务器建立了连接。只需将地址族更改为 linux 中的 af_packet 即可。然后我将它绑定到我的网卡并发送。有效。感谢人们的帮助！这是一些示例代码：

```
s = socket(AF_PACKET, SOCK_RAW)
s.bind(("en1", 0))
pckt = packet() #my class that initializes the raw hex
data = pckt.getpacket()
s.send(data)
message = s.recv(4096)
print s
print s.decode('hex') 
```

它需要在linux或debian中。据我所知，它在 mac osx 中不起作用。对窗户不以为然。如果你有一个使用 pycap 或 scapy 的 mac，它们可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-31T08:52:27.527

为了回答你的问题安德鲁，这里有一个例子：

这个答案帮助我让 WoL 工作。在这种情况下，数据是：

```
preamble = bytearray((0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF))
MAC = bytearray((0x00, 0x14, 0x85, 0xa4, 0x73, 0xce))
data = PREAMBLE + 16*MAC 
```

# struts2 - 严重：异常启动过滤器 struts2

> ID：12229157
> 
> 赞同：2
> 
> 时间：2012-09-01T15:45:36.517
> 
> 标签：struts2

![在此处输入图像描述](../Images/c98d762e346c0df325459a044a17015b.png)启动我的 struts2 应用程序时出现错误。以下是我得到的错误：

```
2 Sep, 2012 12:17:31 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jre6\bin;.;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Program Files (x86)\Java\jre7\bin\client;C:\Program Files (x86)\Java\jre7\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\WIDCOMM\Bluetooth Software\;C:\Program Files\WIDCOMM\Bluetooth Software\syswow64;C:\Program Files (x86)\ATI Technologies\ATI.ACE\Core-Static;C:\Program Files (x86)\Common Files\Roxio Shared\10.0\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\QuickTime\QTSystem\
2 Sep, 2012 12:17:32 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.j2ee.server:MateExpenseCalculator' did not find a matching property.
2 Sep, 2012 12:17:33 AM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
2 Sep, 2012 12:17:33 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 2364 ms
2 Sep, 2012 12:17:33 AM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
2 Sep, 2012 12:17:33 AM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.35
2 Sep, 2012 12:17:33 AM org.apache.catalina.core.StandardContext filterStart
SEVERE: Exception starting filter struts2
java.lang.ClassNotFoundException: org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:269)
at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:422)
at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
at org.apache.catalina.core.StandardContext.start(StandardContext.java:4726)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
at org.apache.catalina.core.StandardService.start(StandardService.java:525)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
2 Sep, 2012 12:17:33 AM org.apache.catalina.core.StandardContext start
SEVERE: Error filterStart
2 Sep, 2012 12:17:33 AM org.apache.catalina.core.StandardContext start
SEVERE: Context [/MateExpenseCalculator] startup failed due to previous errors
2 Sep, 2012 12:17:34 AM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
2 Sep, 2012 12:17:34 AM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
2 Sep, 2012 12:17:34 AM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/73  config=null
2 Sep, 2012 12:17:34 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 1233 ms 
```

我在类路径中添加了以下 jar 文件：

*   struts2-core-2.3.4.1.jar
*   commons-beanutils-1.8.0.jar
*   commons-chain-1.2.jar
*   commons-collections-3.1.jar
*   commons-digester-2.0.jar
*   commons-fileupload-1.2.2.jar
*   commons-io-2.0.1.jar
*   commons-lang-2.4.jar
*   commons-lang3-3.1.jar
*   commons-logging-1.1.1.jar
*   commons-logging-api-1.1.jar
*   freemarker-2.3.19.jar
*   xwork-core-2.3.4.1.jar
*   javassist-3.11.0.GA.jar
*   ognl-3.0.5.jar

网页.xml：

```
<filter>
    <filter-name>struts2</filter-name>
    <filter-class>
        org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter
    </filter-class>
</filter>

<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

我已经关注[了这个](https://stackoverflow.com/questions/5256939/error-filterstart-severe-exception-starting-filter-struts2-java-lang-classnot)线程，但没有成功。

请帮忙。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-17T01:59:50.207

有点奇怪。你有所有的罐子，但你可以尝试使用它`web.xml`来使用 version `2.4`。我正在使用带有tomcat 7的netbeans。

```
<?xml version="1.0" encoding="UTF-8"?> <web-app id="WebApp_ID" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <filter>
    <filter-name>struts2</filter-name>
    <filter-class>
        org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter
    </filter-class>
    </filter>
    <filter-mapping>
        <filter-name>struts2</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping> </web-app> 
```

但是，您可以查看 apache 日志以找到确切的问题，如下所示：

```
Caused by: java.lang.ClassNotFoundException: org.apache.commons.lang3.StringUtils
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
    ... 55 more 
```

# java - 何时使用 Eclipse 64 位

> ID：12229158
> 
> 赞同：8
> 
> 时间：2012-09-01T15:45:36.437
> 
> 标签：java, eclipse

据我了解，我可以从 Eclipse 32 和 Eclipse 64 位开发 32 位或 64 位应用程序。它是否正确？如果是这样，在 64 位 JRE 上运行 Eclipse 64 位有什么好处？

我将主要使用 Python 插件 PyDev 来开发 Python 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:06:17.167

任何软件 64 位版本在内存寻址（也是指令集）方面都优于 32 位版本。这适用于 Java，因此也适用于 eclipse。

要运行 64 位 eclipse，您将需要 64 位 jdk

最后，对于 JVM 参数 -Xmx，32 位 JDK 的堆空间不能超过 ~1.5GB。但是，64 位支持更高的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T19:01:21.973

好处是可用堆/内存的增加。

64 位 JVM 的缺点是性能下降：

> [当您迁移到 64 位 VM 时，比较在 64 位平台上运行的应用程序与在 SPARC 上运行的 32 位平台的性能差异大约为 10-20%。](http://www.oracle.com/technetwork/java/hotspotfaq-138619.html#64bit_performance)

这种性能下降显然是由于频繁使用 64 位地址来管理对象引用。移动两倍的数据比使用 32 位地址。

坦率地说，如果您对受限的内存空间没有问题，那么您可能不需要担心它。您可以使用 32 位 JVM/Eclipse*走得更远。*

# nlp - IOB 格式作为解析器的输出

> ID：12229163
> 
> 赞同：0
> 
> 时间：2012-09-01T15:46:06.623
> 
> 标签：nlp

Standford NLP 和 OpenNLP 中是否有任何功能可以获取 IOB 格式的解析输出？我需要使用解析器对句子进行 NP 分块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:53:48.887

如果您只需要 NP 块，请使用 OpenNLP 分块器而不是解析器。

听起来它可能会帮助您了解更多关于分块和解析之间的差异，例如在[部分解析的 NLTK 文档中](http://nltk.sourceforge.net/doc/en/ch06.html)。尽管您可以根据需要从解析器的输出中提取 NP，但普通解析无法以 IOB 格式表示或转换为 IOB 格式。

# android - 在 ExpandableListView 下方查看内容

> ID：12229164
> 
> 赞同：5
> 
> 时间：2012-09-01T15:46:09.243
> 
> 标签：android, textview, scrollview, expandablelistview, android-ui

我的文件中有一组`TextView`低于 an 的 s 。当列表展开时，所有s 都隐藏在屏幕下方。我试着把我的清单放在一个，结果证明这是一个非常糟糕的主意。`ExpandableListView``.xml``TextView``ScrollView`

有什么方法可以让我滚动和查看我`TextView`的 s？

这是我的示例 xml 布局，可能会有一些用处..

```
<RelativeLayout 
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/textview1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="10dp"
            android:layout_alignParentTop="true" />

        <ExpandableListView
            android:id="@+id/elv"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/textview1"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:groupIndicator="@null" />

        <TextView
                android:id="@+id/tvone"
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_marginTop="1dp"
                android:layout_below="@id/elv"
                android:background="@android:color/white"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="xyz" />

        <LinearLayout
            android:id="@+id/middle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@id/tvone"
            android:layout_margin="10dp"
            android:orientation="vertical" >

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:background="@drawable/number" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:background="@android:color/white"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="number1" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_marginTop="1dp"
                android:background="@android:color/white"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="number2" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_marginTop="1dp"
                android:background="@android:color/white"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="number3" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_marginTop="1dp"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="number4" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/bottom"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="10dp"
            android:layout_below="@id/middle"
            android:orientation="vertical" >

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:background="@drawable/my_account" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:background="@android:color/white"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="number5" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_marginTop="1dp"
                android:background="@android:color/white"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="number6" />

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_marginTop="1dp"
                android:background="@drawable/white_lable_bottom_"
                android:drawableRight="@drawable/arrow_left_grey"
                android:gravity="center_vertical"
                android:paddingLeft="15dp"
                android:paddingRight="20dp"
                android:text="Log out" />
        </LinearLayout>
    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-21T23:06:19.737

我遇到了类似的问题并用这个布局解决了它。`layout_height`重要的部分是`layout_weight`在`ExpandableListView`.

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context="com.gp.MyFragment">

    <ExpandableListView
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="1"
            android:id="@+id/expandableListView"
            android:layout_gravity="left|top"
            android:headerDividersEnabled="true"
            android:footerDividersEnabled="true"/>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">

        <TextView
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="3"/>
        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Bailout"/>

    </LinearLayout>
</LinearLayout> 
```

[![在此处输入图像描述](../Images/5ac0a17fdcd119b975eed27782418fd5.png)](https://i.stack.imgur.com/qxTNc.png)

# android - 杀死android中的服务？

> ID：12229168
> 
> 赞同：1
> 
> 时间：2012-09-01T15:46:21.903
> 
> 标签：android, android-service

在我的应用程序中，我试图使用服务将我的应用程序重定向到另一个应用程序。

我正在 onPause 方法中启动此服务，并尝试在 onResume 方法中停止此服务，但该服务仍在继续运行并自动重定向。

```
protected void onPause() {
    Intent in = new Intent(HelloappActivity.this,SimpleService.class);
    in.putExtra("qwe", k);      
    startService(in);
    super.onPause();
}

protected void onResume() {
    stopService(new Intent(HelloappActivity.this,SimpleService.class));
} 
```

那么我应该如何停止这项服务呢？

# asp.net-mvc - 51Degrees 仅重定向根目录

> ID：12229169
> 
> 赞同：3
> 
> 时间：2012-09-01T15:46:24.220
> 
> 标签：asp.net-mvc, redirect, 51degrees

如何[按照文档中的说明](http://51degrees.codeplex.com/wikipage?title=User%20guide)`<redirect>`配置 51Degrees元素，以仅将向根地址发出的请求重定向到移动地址（例如），而不是向任何其他地址发出的请求，例如？`http://mydomain.com/``http://mydomain.com/m``http://mydomain.com/page123`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:43:04.607

我目前为 51degrees.mobi 工作。

您在问题中指出的文档很旧，将被移动。我很抱歉造成混乱。.NET 的当前文档可以在我们的[网站](http://51degrees.mobi/Support/Documentation/Foundation.aspx?CATReferrer=1758)上找到。

要执行您需要的操作，我建议您设置一个位置规则并使用“origUrl”属性。[这](http://51degrees.mobi/Support/Documentation/Foundation/UserGuide.aspx?CATReferrer=1758#Redirect)在第 2.1.2 节中进行了概述

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:48:14.297

这个对我有用

```
<redirect firstRequestOnly="false"
          mobileHomePageUrl="~/m"
          mobilePagesRegex="^~/\S+$">
</redirect> 
```

任何匹配 mobilePagesRegex 的 url 都被认为是移动友好的，而不是重定向的。“^~/\S+$”表示除“~/”（站点根目录）以外的任何内容。所以只有站点根目录被重定向。

希望这可以帮助。

# java - 传递对 Arraylist 中对象的引用？

> ID：12229171
> 
> 赞同：0
> 
> 时间：2012-09-01T15:46:30.407
> 
> 标签：java, object, arraylist

我想为 2 个类中的每一个创建对象，并将对这些对象的引用放在 arrayList<> 中，然后遍历 arrayList。

```
 ArrayList<CarbonFootprint> myCarbon = new ArrayList<CarbonFootprint>(); 
```

我该如何实施？我可以不用 ArrayList。

```
 CarbonFootprint myCarbon = new Car(150332.00);
    System.out.printf("My Car emits %.2f pounds per year\n",
            myCarbon.getCarbonFootprint()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T15:52:56.223

您可以像这样添加它们：

```
ArrayList<CarbonFootprint> myCarbonList = new ArrayList<CarbonFootprint>();
CarbonFootprint myCarbon1 = new Car(150332.00);
myCarbonList.add(myCarbon1);
CarbonFootprint myCarbon2 = new Car(13434.00);
myCarbonList.add(myCarbon2); 
```

并显示：

```
for (CarbonFootprint footPrint: myCarbonList) {
    System.out.printf("My Car emits %.2f pounds per year\n", footPrint.getCarbonFootprint());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:09:46.887

```
 ArrayList<CarbonFootprint> myCarbonList = new ArrayList<CarbonFootprint>();
    CarbonFootprint myCarbon1 = new Car(150332.00);
    myCarbonList.add(myCarbon1);
    CarbonFootprint myCarbon2 = new Car(13434.00);
    myCarbonList.add(myCarbon2);

    // Enhanced Loop to display the answer.
    for (CarbonFootprint x : myCarbonList) {
        System.out.printf("My Car emits %.2f pounds per year\n",
                myCarbon1.getCarbonFootprint());
        System.out.printf("My House produces %.2f pounds per year\n",
                myCarbon2.getCarbonFootprint());
    }
} 
```

我的车每年排放 118762.28 磅

我的房子每年生产 10612.86 磅

我的车每年排放 118762.28 磅

我的房子每年生产 10612.86 磅

# python - sqlalchemy 多个外键

> ID：12229172
> 
> 赞同：0
> 
> 时间：2012-09-01T15:46:30.557
> 
> 标签：python, sqlalchemy

在 SQLAlchemy 中，我想在表 A 中写一组记录。然后在表 BI 中写一个引用 A 中（先验）未知数量的记录的记录。

在 python 术语中，我将创建类 A 和 B，然后在 B 中有一个包含 A 类型对象的列表。

可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:04:58.003

这不是一个真正的 SQLAlchemy 问题，而是一个基本的关系表问题。

您要么谈论一对多关系，要么谈论多对多关系，这两种关系 SQLAlchemy 都支持开箱即用。

# 一对多

一对多关系是一种基本的遏制关系；一个部门有很多员工，但每个员工只有一个部门。在这种情况下，只有一个传出关系的类获得外键，因此员工指的是部门，而不是相反。

[SQLAlchemy 文档](http://docs.sqlalchemy.org/en/rel_0_7/orm/relationships.html#one-to-many)中的示例如下所示：

> ```
> class Parent(Base):
>     __tablename__ = 'parent'
>     id = Column(Integer, primary_key=True)
>     children = relationship("Child")
> 
> class Child(Base):
>     __tablename__ = 'child'
>     id = Column(Integer, primary_key=True)
>     parent_id = Column(Integer, ForeignKey('parent.id')) 
> ```

因此，如果您的`A`类只能是一`B`组的一部分，请使用此模式。

# 多对多

多对多关系是双方可以引用另一方的多个实例的关系。考虑员工和项目；一个员工可以是多个项目的一部分，一个项目可以涉及多个员工。

在 SQL 中，这种关系需要一个关联表，一个额外的数据库表，用于保存两个链接类型之间的映射。[关于多对多关系](http://docs.sqlalchemy.org/en/rel_0_7/orm/relationships.html#many-to-many)的SQLAlchemy 文档清楚地记录了如何做到这一点；这是示例：

> ```
> association_table = Table('association', Base.metadata,
>     Column('left_id', Integer, ForeignKey('left.id')),
>     Column('right_id', Integer, ForeignKey('right.id'))
> )
> 
> class Parent(Base):
>     __tablename__ = 'left'
>     id = Column(Integer, primary_key=True)
>     children = relationship("Child",
>                     secondary=association_table)
> 
> class Child(Base):
>     __tablename__ = 'right'
>     id = Column(Integer, primary_key=True) 
> ```

如果每个`A`对象可以是多个`B`集合的一部分，请使用此模式。

# susy-compass - 在容器内部添加填充

> ID：12229173
> 
> 赞同：1
> 
> 时间：2012-09-01T15:46:30.750
> 
> 标签：susy-compass

我设计了一个布局，使用 978px 作为网格宽度，网格填充为 12px。老实说，我从来没有真正理解网格填充的目的，现在我更加困惑，因为我认为网格填充将应用于我的总宽度的内部，所以事情不会停留在边缘网格。

例如，我的标题的背景颜色为`#333`. 我跨越了徽标部分的 3 列，但它看起来不太好，因为它就在边缘。如果我在标题内部添加 12px 的填充，显然它会扰乱我的列流。我尝试将它添加到 span-columns mixin 中，例如`@include span-columns(3, 12, 12px 0px)`，但是填充太宽了，我认为这不会有效，因为我希望它在左右两边的所有东西上。

那么在网格*内部获得填充的最佳方法是什么？*

这是一个小结构：

```
page-wrapper (container)
 #page
  header#header
  main
  footer#footer 
```

我尝试向`#page-wrapper`和`#page`div 添加填充，但这不起作用。

/ ***** ** *** ***更新***** ** *** *** /

这是我要实现的目标的屏幕截图：

![截屏](../Images/650f4d66958c0f6dc40c9f844e7416ef.png)

这是我想要响应式的桌面布局，所以我希望在整个布局中保持相同的填充效果。基本上，屏幕截图中的网格总宽度为 1002，侧边为 12px，列为 12-54px，排水沟为 11-30px。

这是一个烟花模板，所以我的 320 页面是 8 列、27 像素宽、12 像素间距和 10 像素间距宽度。我开始认为我设计错了，正如我之前提到的，我并不真正理解网格填充的意义。

如您所见，我希望在容器的侧面有填充物，默认情况下所有东西都位于边缘。

这是我设置的代码片段：

```
$total-columns  : 8;
$column-width   : 27px;
$gutter-width   : 12px;
$grid-padding   : 10px;
$container-style: fluid;
$full: 747px 12;
$tablet: 747px 12 977px;
$desktop: 978px 12;

#page-wrapper{
@include container;
@include susy-grid-background;
@include at-breakpoint(747px 12 977px){
    @include set-container-width;
    max-width: 747px;
    @include susy-grid-background;
}
@include at-breakpoint(978px 12){
    @include set-container-width;
    max-width: 1002px;
    @include susy-grid-background;
} 
```

现在这是我通过检查其他帖子所做的事情，它似乎有效，但我不确定这是否是正确的方法：

```
#header{
margin-left: -$grid-padding;
margin-right: -$grid-padding;
padding: 0 $grid-padding;
margin-bottom: 1em;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:44:16.280

您的屏幕截图链接已损坏，但如果我理解正确，您只是希望您的外部网格元素跨越网格填充。为此，我使用了您提到的技术，尽管如果您希望网站上有太多地方，手动操作可能会很痛苦。这是我创建的一个 mixin，用于以灵活的方式处理这种“出血”：

```
@mixin bleed($padding: $grid-padding, $sides: left right) {
  @if $sides == 'all' {
    margin: - $padding;
    padding: $padding;
  } @else {
    @each $side in $sides {
      margin-#{$side}: - $padding;
      padding-#{$side}: $padding;
    }
  }
} 
```

默认设置是向`$grid-padding`左右添加出血。您可以更改出血的大小，以及它应该应用于的侧面。您可以像这样应用它：

```
#header { @include bleed; }
#nav { @include bleed($sides: left); }
#main { @include bleed($sides: right); } 
```

你还有一些其他奇怪的代码。默认情况下，Susy 构建了我所说的魔法网格：具有最大宽度的流体。而不是默认情况下允许这种情况发生，而是强制您的网格完全流动（`$container-style: fluid;`），包括`set-container-width`（如果您没有将其关闭，它将设置最大宽度，但现在对您没有任何用处）然后添加手动最大宽度。

您还提到想要不同尺寸的不同列和装订线宽度。为此，您需要在断点内使用[with-grid-settings 。](http://susy.oddbird.net/guides/reference/#ref-with-settings)例如：

```
@include at-breakpoint($desktop){
  @include with-grid-settings(12,54px,30px,12px) {
    @include set-container-width;
    @include susy-grid-background;
  }
} 
```

# .net - Google Chrome 或 Firefox 可以嵌入到 WPF 中吗？

> ID：12229179
> 
> 赞同：7
> 
> 时间：2012-09-01T15:47:22.997
> 
> 标签：.net, wpf, google-chrome, firefox, chromium-embedded

有没有办法在 WPF 中嵌入 Chrome 或 Firefox？换句话说，可以使用其中任何一个创建用户控件吗？如果一些已经存在，你会推荐哪个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T15:48:27.887

是的。您可以在 WPF 应用程序中嵌入 Chrome (Chromium)。

您可以使用 ：

*   [Chromium Embedded Framework (CEF)](http://code.google.com/p/chromiumembedded/)（与 Github for Windows 中使用的相同。可与任何 .Net 语言一起使用）
*   [Awesomium](https://awesomium.com/)（非商业应用和独立开发者免费（[年收入低于 10 万美元](https://awesomium.com/buy/)））

# node.js - 模块化编程和节点

> ID：12229180
> 
> 赞同：12
> 
> 时间：2012-09-01T15:47:38.220
> 
> 标签：node.js, mongodb, express, mongoose, modularity

**更新 1**：我在这方面取得了很大进展。我几乎放弃了（至少现在，但可能是长期的）允许用户上传模块的想法。但是，我正在开发一种结构，以便可以定义和加载多个模块。一个模块将被初始化，设置它自己的路由，并有一个“公共”目录供 Javascript 服务。我看到的越多，我就越意识到我可以（应该）也移动现在系统范围内的调用在一个名为“系统”的模块中。

**更新2**：我在这方面取得了*巨大*进展。我即将在 GitHub 上提交大量代码，这将允许人们使用 Node 和 Express 进行非常非常好的模块化编程（使用暴露客户端和服务器端代码的模块）。敬请期待。

**更新3**：我将这个东西重写为一个系统来注册模块并使它们能够通过事件/挂钩系统进行通信。它进展得*非常*好。我有大量的代码已经可以使用了——我只是将它移植到新系统中。随意查看 GitHub 上的项目：[https](https://github.com/mercmobily/hotplate) ://github.com/mercmobily/hotplate ）

**更新4**：这很好。事实证明，我关于将模块作为客户端和服务器的想法确实有效。

**更新 5**：该模块越来越接近可用的东西。我实现了一个新的加载器，它将考虑 init() 函数将调用All() 的内容——并确保*首先*加载提供该挂钩的模块。这将电炉打开到一个全新的水平。

**更新 6**：Hotplate 现在接近 12000 行代码。到它完成时，也就是 2 月的某个时候，我想它会接近 20000 行代码。它做了很多事情，这一切都是从 StackOverflow 开始的！我需要它来开发自己的 SaaS，所以我真的需要在 2 月之前完成它（这样我就可以冲刺到 7 月并完成 BookingDojo 的第一个版本）。谢谢大家！

我正在写一些可能会变成一个相当大的软件的东西。简而言之，它是 nodejs + Express + Mongodb/Mongoose + Dojo（客户端）。

注意：本文中的问题标记为 [Q1]、[Q2] 等。

来自 Drupal 背景（并且知道它的 coooomplex 是如何演变的，这是我想避免的），我有点模块狂。目前，我已经完成了应用程序的样板（hotplate：[https](https://github.com/mercmobily/hotplate) ://github.com/mercmobily/hotplate ）。它完成了所有无聊的事情（用户、工作区、密码提醒等），并且缺少很多部分。

我想提出一种设计，允许模块采用与 Drupal 类似的方式（但可能更好）。那是：

*   模块可以定义新的路由，并处理它们
*   模块在系统范围内安装，然后每个工作区都可以启用它们的集合列表

最初的架构可能是这样的：

*   一个“模块”目录，其中每个模块有一个目录
*   每个模块都有一个用于 Javascript 方面的“公共”文件的目录
*   每个模块都有 public/startup.js ，它会包含在应用程序的 javascript 中
*   每个模块都有 server/node.js ，如果/需要时，服务器会动态包含它
*   将定义一个路由，例如 /app/:workspaceid/modules/MODULE_NAME/.* 带有一个中间件，该中间件检查该工作区是否启用了 MODULE_NAME - 如果启用，则使用传递的参数调用模块的函数

[Q1]：这是否有些模糊？

问题：

*   我想让这个动态。我希望在现场需要时需要模块。这应该很容易做到，只需即时要求。

*   server/node.js 会调用一个函数，但该函数感觉/看起来非常像路由器本身

【Q2】你对这个有什么具体的提示吗？

这些似乎都不是什么大问题。但是，当您谈论*安全性*时，真正的问题来了。

*   隐私。这是一个讨厌的。目前，所有的调用都会对 mongoDb 过滤通过 workspaceId 进行正确的查询。我想以某种方式强制执行，以便模块无法明确访问数据库，因此每个模块都无法访问属于其他工作区的数据

*   用户定义的模块。我很*乐意*让用户能够上传他们自己的模块（也许让其他用户可以使用它们）。但是，这实际上意味着允许人们上传将由节点本身*执行的代码！*你会怎么做？

[Q3] 你会如何处理这些隐私/安全问题？有什么方法可以在某种节点沙箱中运行用户上传的代码？访问文件系统等呢？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T00:20:26.080

最后，我自己回答了这个问题 - 艰难的方式。答案：热板，[https ://github.com/mercmobily/hotplate](https://github.com/mercmobily/hotplate)

它完成了我上面描述的大部分工作。更重要的是，使用 hotPlate（使用 hotPage 和 hotClientPages，默认可用），您可以编写一个模块

1.  定义一些路由
2.  用 UI 定义一个“公共”目录
3.  定义加载该模块时必须加载的特定 CSS 和 JS 文件
4.  如果需要，可以添加特定于路由的 JSes

**状态**：我正在接受这个答案，因为我已经完成了 Hotplate 的“核心”的开发，这就是这个答案的重点。我仍然需要“做”一些事情（例如，一旦我编写了文档，我将确保“hotplate”是模块中唯一的目录，而那里没有示例服务器）。不过，基础是有的。就“核心”而言，它只是真正缺少故事的“身份验证”方面（这需要很多思考，因为我想让它与 db 无关并与护照接口）。Dojo 小部件是一个很大的好处，尽管这个框架可以与*任何东西*一起使用（事实上，特定于主干的代码会很可爱）。

**什么电炉不做**：

hotplate 不做的是让*用户*能够上传模块，然后将这些模块加载到应用程序中。这是*非常*棘手的。客户端不会那么糟糕（用户可以定义要上传的Javascript，并且可以有一个模块来做到这一点，不用担心）。然而，服务器端充其量是棘手的。有太多事情可能出错（客户端可能会上传一段阻塞代码，或者他们可以开始读取文件系统，他们可以访问*完整*的数据库，等等）。这些问题的解决方案是*可能的*，但是它们都不是容易的（例如，您可以将用户的节点环境笼罩并让它在不同的端口上运行，等等），但有些问题会继续存在。但是，总是有希望的。

# php - Facebook iframe - 如何发送表单（POST 方法）？

> ID：12229184
> 
> 赞同：1
> 
> 时间：2012-09-01T15:47:59.870
> 
> 标签：php, facebook, facebook-graph-api, facebook-iframe

我有非常简单的形式（文件称为`message.php`）：

```
<?php
  print_r($_POST);
?>
<form method="post" target="_top" action="<?php echo CANVAS_URL;?>message.php">
  <input type="text" name="your_name" />
  <input type="hidden" name="signed_request" value="<?php echo $_REQUEST['signed_request'];?>" />
  <input type="submit" name="send" />
</form> 
```

我找到了这个问题的一个解决方案 - 将隐藏输入放入表单`signed_request`- 我做到了，但不幸的是我仍然面临这个问题 - 我无法检索发送的 POST 数据。

如果我将方法更改为`method="get"`，一切正常，但我需要从 POST 获取数据。

谁能帮助我，如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:32:45.350

尝试这个。我认为您不再需要`target`在 FB 画布应用程序中使用。表单ID也很好。

```
<form method="POST" id="my_form" action="message.php">
    <input type="text" name="your_name" />
    <input type="hidden" value="<?php print $_POST["signed_request"] ?>" name="signed_request" />
    <input type="submit" name="submit" />
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T00:21:39.680

根本不支持发布到 Canvas URL（如[http://apps.facebook.com/namespace ）。](http://apps.facebook.com/namespace)但是为什么要发布到顶部窗口而不是简单地留在 iframe 中呢？它更好，因为它不需要重新加载整个页面，只需要重新加载 iframe。

# c - qsort 排序行，获取未释放的块

> ID：12229186
> 
> 赞同：1
> 
> 时间：2012-09-01T15:48:02.137
> 
> 标签：c, free

问题是 - 我正在尝试使用 qsort 对几行进行排序，一切都在 outfile 中工作。不幸的是`valgrind`，给了我关于不释放一些内存块的错误。

起初我想——我需要，`free(lines)`但它已经在那里了。我错过了什么？

```
qsort(lines, linenumber, sizeof(char*), compare_string);
 for(c=0; c<linenumber; c++) {
    fputs(lines[c], outfile);
 }
 free(lines); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:04:08.323

你是如何为行分配内存的？如果它是一个二维数组，那么您必须在 for 循环中分别 malloc 每一行。

做这样的事情-

```
for(counter=Max_lines;counter>0;counter--){
     free(lines[counter]);
} 
```

# ruby-on-rails - 如何从 Rails 关联中取消定义/删除方法

> ID：12229187
> 
> 赞同：1
> 
> 时间：2012-09-01T15:48:05.550
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

当您在 Rails 中定义关联时，它会为您在该关联上创建一些方法。例如，考虑以下情况：

```
class Person
  has_many :friends
end 
```

你得到的方法之一是`person.friends.clear`

我怎样才能删除这个方法，这样`person.friends.clear`会引发一个`NoMethodError`？

**注意：**我尝试了一些事情，包括运气`undef_method`和`remove_method`没有运气。请只提供**已知的**答案，而不是猜测。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:20:31.193

虽然我自己没有尝试过，但可以请检查以下是否有效

```
has_many :friends do
    def clear 
       raise NoMethodError, "Some reason text"
    end     
end 
```

# linux - 重击 | 卷曲 | 卷曲 2 个 URL 然后停止

> ID：12229198
> 
> 赞同：0
> 
> 时间：2012-09-01T15:49:37.573
> 
> 标签：linux, bash, curl

我正在尝试编写一个简单的 bash 脚本，该脚本将使用文本文档中的列表并卷曲列表中的每个 URL，以便查看每个 URL 的内容。它允许我卷曲 2 个站点并为其余站点创建文本文档，但是它只下载前 2 个站点。我已经设法编写了脚本，该脚本将 IP 拉到那里并使用 grep 命令将它们放在单独的文件中。起初我试过

```
#!/bin/bash
for var in `cat host.txt`; do
curl -s $var >> /tmp/ping/html/$var.html
done 
```

我试过有无静音开关。然后我尝试了以下方法：

```
#!/bin/bash  
for var in `head -2 host.txt`; do  
curl $var >> /tmp/ping/html/$var.html  
wait  
done  
for var in `head -4 host.txt | tail -2`; do  
curl $var >> /tmp/ping/html/$var.html  
done 
```

这将尝试同时执行所有操作，然后在 2 之后再次停止

```
#!/bin/bash  
for var in `head -2 host.txt`; do  
curl $var >> /tmp/ping/html/$var.html   
done 
wait 
for var in `head -4 host.txt | tail -2`; do  
curl $var >> /tmp/ping/html/$var.html  
done 
```

这会做同样的事情，我是 bash 脚本的新手，只知道一些基础知识，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:02:19.790

您通过管道输入 $var，这可能会导致错误的文件名，因为 URL 中有两个斜杠。另外，我会引用 URL。例如，它适用于 URL 的基本名称。

```
#!/bin/bash
for var in `cat host.txt`; do
  name=$(basename $var)
  curl -v -s "$var" -o "/tmp/ping/html/$name.html"
done 
```

您可能还想跳过空行和注释 (#)

```
#!/bin/bash

file="host.txt"
curl="curl"

while read -r line
  do
    [[ $line = \#* ]] || [[  -z "${line}" ]]  && continue
    filename=$(basename $line)
    $curl -s "$line" >> "/tmp/ping/html/$filename.html"
done < "$file" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:40:19.153

从简单的开始：验证您实际上是在遍历整个列表：

```
# This is the recommended way to iterate over the file. See
# http://mywiki.wooledge.org/BashFAQ/001
while read -r var; do
    echo "$var"
done < hosts.txt 
```

然后添加对 的调用`curl`，检查其退出状态

```
while read -r var; do
    echo "$var"
    curl "$var" >> /tmp/ping/html/$var.html || echo "curl failed: $?"
done < hosts.txt 
```

# iphone - 添加多个滑动手势不起作用

> ID：12229208
> 
> 赞同：0
> 
> 时间：2012-09-01T15:51:18.840
> 
> 标签：iphone, objective-c, cocoa-touch, uigesturerecognizer, uistoryboard

我有三种观点，

```
View1 <-- View2 --> View3 
```

现在 View2 on`leftSWipeGesture`将把我发送到 VIew3 而在右侧 Gesture 发送到 View1

我的问题是，`LeftGesture`工作正常但不是正确的手势。我在两者上都使用 push Segue

这是我的代码

```
- (void) screenSwiped
{
    [self performSegueWithIdentifier:@"tourSegue1" sender:self];

}

- (void) screenSwipedRight
{
    [self performSegueWithIdentifier:@"tourSegue2" sender:self];

}

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad
{
UISwipeGestureRecognizer *swipeLeft = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(screenSwiped)];
swipeLeft.numberOfTouchesRequired = 1;
swipeLeft.direction = UISwipeGestureRecognizerDirectionLeft;
    [self.view addGestureRecognizer:swipeLeft];

UISwipeGestureRecognizer *swipeRight = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(screenSwipedRight)];
swipeRight.numberOfTouchesRequired = 1;
swipeRight.direction = UISwipeGestureRecognizerDirectionRight;
[self.view addGestureRecognizer:swipeRight];

    [super viewDidLoad];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:06:03.013

您在帖子开头呈现的视图结构有点误导。从那个小图中，您似乎已经在视图 2 中，如果您在导航控制器中，则转到视图 1 应该是“popViewController”。

所以首先 - 请验证此信息并确保您不需要“popViewController”而不是 performWithSequeIdentifier（因为它不能像那样倒退）。

# javascript - 应用过渡时的 D3js 排序问题

> ID：12229209
> 
> 赞同：1
> 
> 时间：2012-09-01T15:51:23.280
> 
> 标签：javascript, d3.js

我有一个数据集已经`svg:g`通过`d.id`

```
var categorized = g1.selectAll("g.node")
                    .data(dataset, function(d){return d.id})
                    .classed('filtered', false);
categorized.enter()
           .append("g")
           .attr("class", "node")
... 
```

我使用一个函数从这样的数据值中对其进行排序：

```
var sorted = dataset
                 .filter(function(d) { return d.notation[3].value >=50 } )
                 .sort(function(a, b) { return d3.descending(a.notation[3].value,
                                        b.notation[3].value) }); 
```

当我返回正确的`console.log`顺序

```
var filtered = g1.selectAll("g.node")
                 .data(sorted, function(d) {return d.id})
                 .classed('filtered', true); 
```

如果我这样做，仍然是正确的顺序`console.log`，但是如果我应用延迟，它会反转结果顺序

```
scored.transition()
      .delay(500).duration(1000)
      .attr("id", function(d) {
          console.log(d.id);
      }); 
```

但如果我消除延迟，它会保持良好的排序。

我的问题：我是不是在做坏事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:37:32.870

我认为您观察到 d3.js 通常使用反向迭代的“优化” for 循环（请参阅[Are loops really faster in reverse？](https://stackoverflow.com/questions/1340589/javascript-are-loops-really-faster-in-reverse)以及其他参考资料）。

简单地颠倒您的选择会起作用吗？我不确定您正在转换什么，因此您需要以特定顺序应用补间步骤。

# netty - 关闭 Netty 服务器

> ID：12229210
> 
> 赞同：2
> 
> 时间：2012-09-01T15:51:44.773
> 
> 标签：netty

我有一个关于关闭 Netty Server 的小问题。文档说关于关闭服务器是这样的；

```
public class TimeServer {

static final ChannelGroup allChannels = new DefaultChannelGroup("time-server");

public static void main(String[] args) throws Exception {
    ...
    ChannelFactory factory = ...;
    ServerBootstrap bootstrap = ...;
    ...
    Channel channel = bootstrap.bind(...);
    allChannels.add(channel);
    waitForShutdownCommand();
    ChannelGroupFuture future = allChannels.close();
    future.awaitUninterruptibly();
    factory.releaseExternalResources();
} 
```

}

然后在搜索“waitForShutDownCommand”是什么之后，我发现它类似于 ShutdownHook 方法。那么我在我的服务器上添加了一个shutdownhook方法，

```
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
        @Override
        public void run() {
            nettyServer.shutDown();
        }
    }, "shutDownHook")); 
```

但是后来，我意识到当我尝试使用 ctrl-c 退出服务器时，它并不总是被调用。因为当服务器关闭时，我想做一些与该服务器相关的操作。（比如从 Redis 中删除与该服务器相关的所有数据。）

所以..我想出了一个想法，但我还没有实现，我只是想确保它是否是一个好方法。所以，要关闭服务器，我需要一个客户端（管理员客户端），它将 SHUTDOWN 命令发送到该服务器。实际上，我不想创建一个管理员客户端，因为我不想关心另一个客户端应用程序和安全问题等...

那么你的解决方案是什么？有任何想法吗？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T11:50:33.210

如果你足够幸运的话，CTRL + C 不会执行关闭钩子。使用“kill”它会起作用。

# macos - mac os雪豹上freeglut的问题（它通过macports构建得很好）

> ID：12229211
> 
> 赞同：3
> 
> 时间：2012-09-01T15:51:47.550
> 
> 标签：macos, opengl, glfw, freeglut

我在 mac os 雪豹 gcc 4.5.4 上 | gcc 4.2.1，尝试构建教程[http://www.arcsynthesis.org/gltut/](http://www.arcsynthesis.org/gltut/)

需要先构建目录 glsdk。我通过macports freeglut @2.8.0_1（活动）安装freeglut（先决条件）并手动复制并粘贴其lib并将文件夹包含在dir glsdk中，以便 ls ..../Tutorial_0_3_8/glsdk/freeglut -> include lib（我不能' t构建freeglut，这就是为什么我用macports替换它的原因）

在修复了许多错误之后（主要是由于包含的遗留代码片段），我正在测试目录中测试构建，当我尝试运行生成的可执行文件 ./TestD 时，我得到：

> X Error of failed request: BadRequest (invalid request code or no such operation) Major opcode of failed request: 34 (X_UngrabKey) Serial number of failed request: 28 Current serial number in output stream: 28

这是什么？一些搜索表明这是驱动程序的问题（？）..当我将 glut 与其他 gl 代码一起使用时，它运行得很好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T14:21:16.310

我的 X11 坏了**，这似乎是问题所在。由于构建这套教程很棘手，我重复我遵循的步骤，为任何面临类似问题的人

1.  获取源[https://bitbucket.org/alfonse/gltut/downloads](https://bitbucket.org/alfonse/gltut/downloads)，解压缩并填补空白，以便您拥有 Tutorial_0_3_8 而不是 Tutorial 0 3 8
2.  在 glsdk 目录中`--"freeglut/freeglut.lua`，在 premake4.lua 中注释掉
3.  在 glsdk 目录中，`./premake gmake`然后`make config=release`
4.  在框架目录framework.cpp中，手动将宏`LOCAL_FILE_DIR`&分别替换`GLOBAL_FILE_DIR`为“./data/”&`"./data/"`并`"../data/"`注释掉`#include "directories.h"`
5.  从根目录或您需要的内容一步构建所有教程，例如在测试目录中放置正确的路径以包含 freeglut 头文件并链接到：在 Test.make 中替换`-I../glsdk/glutil/include`和`-L../glsdk/glutil/lib`通过 macports 构建的 freeglut 路径。同样在同一个makefile链接中，`-lglut`而不是`-lfreeglut`

**`dyld: Symbol not found: __cg_DGifGetLine Referenced from: /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO Expected in: /opt/local/lib/libGIF.dylib in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO`

# scala - 使用并行集合时的 JBoss Scala 模块和 NoClassDefFoundError

> ID：12229217
> 
> 赞同：0
> 
> 时间：2012-09-01T15:53:07.197
> 
> 标签：scala, jboss7.x

我通过创建文件夹 /modules/org/scala/main 为 Scala 创建了一个 JBoss 模块（JBoss 7.1.1.Final），将 Scala 2.9.2 的 scala-library.jar 和 module.xml 一起放入其中：

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.1" name="org.scala">
    <resources>
        <resource-root path="scala-library.jar"/>
    </resources>
</module> 
```

然后在我的 webapp 中，我添加了 /WebContent/WEB-INF/jboss-deployment-structure.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure>
    <deployment>
        <dependencies>
            <module name="org.scala" />
        </dependencies>
    </deployment>
</jboss-deployment-structure> 
```

几乎所有的 Scala 都可以工作——而且好处是我不必将 scala-library.jar 添加到每个 web 应用程序中。

但是，非常奇怪的是，当我尝试调用以下 def 时，出现错误：

```
def reserveOffer(event: EventOffer, tarifs: Seq[Tarif]) = {
    val reservations = tarifs.par.map{ t =>
        getAdapter(t.bookingSystem) match {
            case Some(a) => a.reserveOffer(event, t)
            case _ => throw new 
                    IllegalStateException(
                            "Unknown adapter " + 
                            t.bookingSystem)
        }
    }
    reservations.seq
} 
```

错误是：

```
Caused by: java.lang.NoClassDefFoundError: Could not initialize class scala.collection.parallel.package$
at scala.collection.parallel.Combiner$class.$init$(Combiner.scala:37) [scala-library.jar:]
at scala.collection.parallel.mutable.ResizableParArrayCombiner$$anon$1.<init>(ResizableParArrayCombiner.scala:96) [scala-library.jar:]
at scala.collection.parallel.mutable.ResizableParArrayCombiner$.apply(ResizableParArrayCombiner.scala:96) [scala-library.jar:]
at scala.collection.parallel.mutable.ResizableParArrayCombiner$.apply(ResizableParArrayCombiner.scala:98) [scala-library.jar:]
at scala.collection.parallel.mutable.ParSeq$.newCombiner(ParSeq.scala:58) [scala-library.jar:]
at scala.collection.mutable.SeqLike$class.parCombiner(SeqLike.scala:27) [scala-library.jar:]
at scala.collection.mutable.ListBuffer.parCombiner(ListBuffer.scala:44) [scala-library.jar:]
at scala.collection.Parallelizable$class.par(Parallelizable.scala:40) [scala-library.jar:]
at scala.collection.mutable.ListBuffer.par(ListBuffer.scala:44) [scala-library.jar:]
at ch.maxant.scalabook.services.EventService.reserveOffer(EventService.scala:190) [classes:] 
```

EventService 的第 190 行是：

```
 val reservations = tarifs.par.map{ t => 
```

即创建并行序列的方法调用导致异常。

如果我不使用 JBoss 模块，并且将 scala-library.jar 粘贴到 WEB-INF/lib 中，那么我就没有这个问题。

我怀疑它与模块中的类加载有关，但我不知道在哪里修复它，或者它是否是 JBoss 模块中的错误？

问题是：谁能给我任何解决方案，或者这是一个已知问题？

# java - java中的引用混淆

> ID：12229220
> 
> 赞同：-2
> 
> 时间：2012-09-01T15:53:55.287
> 
> 标签：java, reference

```
class blabla extends JPanel
{
    public blabla()
    {
    //code
    }
}

class Main
{
    public static void main(String[] args)
    {
        JPanel b;
        ArrayList<blabla> c;

        blabla a = new blabla();

        b = new JPanel();
        c = new ArrayList<blabla>();

        b.add(a);
        c.add(a);

        blabla d = (blabla) b.getComponent(0);
        System.out.println(c.indexOf(d));
     }
} 
```

是`ArrayList a`和`JPanel a`相同的对象吗？代码输出应该是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T15:59:26.467

**该答案基于您在未提供代码片段且问题为...时在问题中提到的内容。**

> 我创建了一个组件实例，将其绘制到屏幕上，并将其添加到 ArrayList。我通过使用它的孩子（getParent（）方法）引用绘制的来访问它。但是，当我将此引用传递给 ArrayLists indexOf(); 方法，它返回-1。我想这意味着该组件在 ArrayList 中不存在。这是应该发生的事情，还是我可能在我的程序中搞砸了？我没有为您提供 SSCCE，也没有要求您进行任何编码，只是为了告诉我这是否是正常的 Java 行为......

**这是我的回应**

的javadoc`indexOf()`说...

> 返回此列表中指定元素第一次出现的索引，如果此列表不包含该元素，则返回 -1。更正式地说，返回满足 (o==null ? get(i)==null : o.equals(get(i))) 的最低索引 i，如果没有这样的索引，则返回 -1。

如您所见，这取决于`equals()`您的组件的实现。检查您的实现，因为它拥有从列表中检索值的关键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:18:53.470

好的，这里是您修改后问题的答案...

> ArrayList a 和 JPanel 是同一个对象吗？

不，但它们包含相同的 class 对象`blabla`。

> 代码输出应该是什么？

输出是

```
0 
```

当您在 and 中放置相同的组件时，这是正确的`JPanel`，`ArrayList`并且`0`是元素的索引。

# php - 使用 HTACCESS 将斜线后的文本转换为变量

> ID：12229222
> 
> 赞同：6
> 
> 时间：2012-09-01T15:53:57.013
> 
> 标签：php, .htaccess, redirectstandardoutput

我需要使用 URL 但使用斜杠传递 3 个变量。因此，例如，我将使用此 URL：

[http://www.example.com/variable1/variable2/variable3](http://www.example.com/variable1/variable2/variable3)

我在我的 HTACCESS 中有这个，它允许传递第一个变量之后的文本，但我无法让其他两个通过，即使我添加 &$2

```
<IfModule mod_rewrite.c>
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule /?([A-Za-z0-9_-]+)/?$ process.php?width=$1&height=$2 [QSA,L] 
```

任何链接或帮助都会很棒

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T15:57:19.127

您只在重写规则中捕获一个变量。

你需要类似的东西：

```
RewriteRule ^([A-Za-z0-9_-]+)/([A-Za-z0-9_-]+)/([A-Za-z0-9_-]+)/?$ process.php?width=$1&height=$2&third=$3 [QSA,L] 
```

或者，更短一点：

```
RewriteRule ^([\w-]+)/([\w-]+)/([\w-]+)/?$ process.php?width=$1&height=$2&third=$3 [QSA,L] 
```

（`\w`单词字符包括字母、数字和下划线）

我只将结尾斜杠设为可选，所以这个重写规则只有在恰好有 3 个变量时才会起作用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-01T16:21:21.230

您可能会发现通过以下方式获取 .php 文件中的参数更容易：

```
$pathinfo = isset($_SERVER['PATH_INFO'])
    ? $_SERVER['PATH_INFO']
    : $_SERVER['REDIRECT_URL'];

$params = preg_split('|/|', $pathinfo, -1, PREG_SPLIT_NO_EMPTY);

echo "<pre>";
print_r($params); 
```

所以用这个调用脚本：

[http://www.example.com/variable1/variable2/variable3](http://www.example.com/variable1/variable2/variable3)

会返回：

```
Array
(
    [0] => variable1
    [1] => variable2
    [2] => variable3
) 
```

这对两者都有效：

[http://www.example.com/variable1/variable2/variable3](http://www.example.com/variable1/variable2/variable3)和 [http://www.example.com/process.php/variable1/variable2/variable3](http://www.example.com/process.php/variable1/variable2/variable3)

# android - Android会将快速单点触控视为移动？

> ID：12229224
> 
> 赞同：3
> 
> 时间：2012-09-01T15:54:18.007
> 
> 标签：android, touch

我编写了一个非常简单的 android 应用程序，我可以在 pad 上画一些东西。用手指触摸屏幕，你会看到一个绿球，移动你的手指，你会看到一条红线。

但是我发现了一件很奇怪的事情：如果我用两根手指一个接一个地快速触摸屏幕，它会在它们之间划出一条线！（想象您正在按键盘`jkjkjkjkjkjjkjkjkjkjkjkj`上的两个键）

关键代码非常简单：

```
public boolean onTouch(View v, MotionEvent event) {
    int action = event.getAction();
    switch (action & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN:
            multiTouch = false;

            id = event.getPointerId(0);
            PointF p = getPoint(event, 0);
            path = new Path();
            path.moveTo(p.x, p.y);
            paths.add(path);

            points.add(copy(p));
            break;
        case MotionEvent.ACTION_POINTER_DOWN:
            multiTouch = true;
            for (int i = 0; i < event.getPointerCount(); i++) {
                int tId = event.getPointerId(i);
                if (tId != id) {
                    points.add(getPoint(event, i));
                }
            }
            break;
        case MotionEvent.ACTION_MOVE:
            if (!multiTouch) {
                p = getPoint(event, 0);
                path.lineTo(p.x, p.y);
            }
            break;
    }

    invalidate();

    return true;
} 
```

完整来源在这里：[https ://github.com/freewind/TouchTest/blob/master/src/com/example/MyImageView.java](https://github.com/freewind/TouchTest/blob/master/src/com/example/MyImageView.java)

这是一个工作演示：[https ://github.com/freewind/TouchTest](https://github.com/freewind/TouchTest)

或者你可以在你的安卓设备上下载签名的apk，然后自己测试：[https ://github.com/freewind/TouchTest/blob/master/TouchTest.apk?raw=true](https://github.com/freewind/TouchTest/blob/master/TouchTest.apk?raw=true)

您可以在我的代码中看到，我已经检查了它是否是多点触控并在这种情况下禁用了绘图。

我的android版本是4.0，我的代码目标是2.3.3

我的android pad上有一张图片：

![在此处输入图像描述](../Images/afac8c443ac855e8761e5371146341bd.png)

你可以看到有一些线，但它不应该是，红线的左边应该有一个绿球。

我不确定为什么 android 将快速单点触摸视为移动，我考虑了 3 个原因：

1.  我的代码有问题
2.  Android sdk 有问题
3.  我的 android pad 有问题，例如缺少 ACTION_DOWN 事件

如何找出真正的原因？

* * *

**更新**

我的一个朋友用他的android手机（android 2.1）测试了这个应用程序，发现没有红线，另一个使用android 2.3.5，发现有红线。

请查看我的代码，我已经检查了多点触控，如果超过 1 点将`ACTION_POINTER_DOWN`不执行任何操作。`ACTION_MOVE`所以`id`不需要of点。（实际上，在此代码的第一个版本中，我使用`id`了但有同样的问题）。

而且我不认为这是一种预期的行为，因为它使触摸程序的开发变得困难。我发现这个问题是因为在我的另一个应用程序中（用户可以用手指拖动/缩放/旋转图像），图像有时会在屏幕上“跳跃”。

我什至在我的 android pad 和 iTouch 上尝试了一个流行的游戏（Fruit Ninja），发现 android 版本有问题，但 iTouch 没有。

现在我确定有什么问题（**当第一根手指竖起时****错过了一个`ACTION_UP`**事件），但我仍然不知道是什么原因造成的。我的安卓平板？还是安卓sdk？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:00:30.917

这就是它适用于多点触控的方式。当您按下快速 android 将其作为手势处理时，您将有 2 个按下的指针。为避免它尝试处理 action_up，或改用 action_pointer_down

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:42:27.217

您可以检查 touch 的 id ，以便您只处理第一次触摸。

或者，您可以监视所有触摸并一起处理它们。

# c# - 获取实例化另一个类的类名

> ID：12229226
> 
> 赞同：0
> 
> 时间：2012-09-01T15:54:31.450
> 
> 标签：c#, .net

> **可能重复：**
> [如何在 C# 中获取调用函数的名称？](https://stackoverflow.com/questions/12098267/how-can-i-get-the-name-of-the-calling-function-in-c)

我正在寻找有关如何最好地获取一些信息的一些见解。

这个应用程序是 C#.net

我们有一系列的类都派生自一个抽象基类。这一系列类在一组业务规则类中的其他方法中实例化。

我正在添加一些日志记录，并希望能够记录哪个类实例化了该类。最合适的地方是抽象基类。

我知道如何获取 stackTrace 并检查框架，但不太确定确定谁创建了类的正确方法。在基类和创建从基类派生的类之间有很多“构建器”和其他抽象级别。

任何想法或见解都值得赞赏。

# audio - 生成.WAV 声音频率？

> ID：12229227
> 
> 赞同：0
> 
> 时间：2012-09-01T15:54:34.713
> 
> 标签：audio, visualization, waveform

是否有任何脚本/工具（任何语言）可以将 .wav 文件生成为波形图像？

基本上我想在网上上传一个小 wav 文件，然后它将显示波形图像，包括秒数（持续时间）。

PS：我做了谷歌，但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:08:38.570

[https://bitbucket.org/corfr/wavegenerator/src](https://bitbucket.org/corfr/wavegenerator/src)

一个朋友做了这个：

你需要 linux（我成功使用 Centos 和 Ubuntu） Libmad

如果我记得这已经足够了，它会使用 libmad 从一个 .mp3 文件生成一个 .png 。代码很简单易懂，随时提交改进！

它会生成一个非常接近的波形，例如您可以在 soundcloud 上找到的波形...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:24:27.930

编辑：由于您正在寻找*波形*，因此这个问题非常相关。

[https://stackoverflow.com/questions/2381243/how-does-soundcloud-com-generate-the-waveform-for-their-mp3-player](https://stackoverflow.com/questions/2381243/how-does-soundcloud-com-generate-the-waveform-for-their-mp3-player)

编辑：如果您正在寻找一种以图形方式显示*频率的方法，这个答案是有效的。*

SoX ( [http://sox.sourceforge.net/](http://sox.sourceforge.net/) ) 可以在 Windows 上运行，并且几乎在所有 Linux 发行版中都已安装或可用。

它可以生成 .png 格式的频谱图。就这样称呼它：

```
sox <inputfile> -n spectrogram 
```

您将 `spectrogram.png` 在同一目录中找到。

以下是 SoX 生成的频谱图示例：![在此处输入图像描述](../Images/19eae65d28e47263dd0969f1a80cb765.png)

# python - django_facebook 应用程序中的链接导致错误请求：缺少签名请求

> ID：12229232
> 
> 赞同：2
> 
> 时间：2012-09-01T15:56:07.457
> 
> 标签：python, django, facebook, django-facebook

我正在使用安装在 pythonanywhere 上的 django_facebook 库。当我单击从一个视图到另一个视图的链接时，我收到一条错误消息：

> 400 错误请求
> 
> 缺少签名请求。

有人可以简要介绍一下链接在 Facebook 应用程序中的工作原理吗？

删除 @canvas_only 装饰器并不能解决问题，因为我需要访问图形 api。

这是代码：

视图.py：

```
from django.shortcuts import render
from django_facebook.decorators import canvas_only
#from django_facebook.decorators import facebook_required
#from django.utils.decorators import method_decorator

from models import Poem, Share
from django import forms
from django.views.generic import View

class PoemEntryForm(forms.Form):
    words = forms.CharField( widget=forms.widgets.Textarea(), initial='ENTER\nPOEM\nHERE\nONE\nWORD\nPER\nLINE' )

@canvas_only
def home(request):
    me = request.facebook.graph.get_object('me')
    my_username = me['username']
    request.session['username'] = my_username

    try:
        poems = Poem.objects.filter(user=my_username)
    except Poem.DoesNotExist:
        poems = []

    # convert poems into tuples of information relevant to the home page
    # sort them in reverse chronological order
    # ie: title and created
    poems = [(poem.title(), poem.created) for poem in sorted(poems, key=lambda poem: poem.created, reverse=True)]

    try:
        shared = Share.objects.filter(shared_to=my_username)
    except Share.DoesNotExist:
        shared = []

    shared = [(poem.title(), poem.user, poem.created) for poem in sorted(shared, key=lambda poem: poem.created, reverse=True)]

    return render(request, 'home.html', {
        'me': me,
        'my_poems': poems,
        'shared': shared,
    })

class Create(View):
    #@method_decorator(canvas_only)
    def get(self, request, *args, **kwargs):
        #self.me = request.facebook.graph.get_object('me')
        form = PoemEntryForm(request.GET)
        return render(request, 'create.html', {
            'form': form,
            'debug': request.session['username']
        })

    #@method_decorator(canvas_only)
    def post(self, request, *args, **kwargs):
        if request.session['username']:
            form = PoemEntryForm(request.POST)
            poem = Poem()
            poem.user = request.session['username']
            poem.text = request.POST['words']
            poem.save()
            return render(request, 'submitted.html', {})
        else:
            return render(request, 'error_submitting.html', {}) 
```

提交的.html：

```
<html>
    <body>
        <h3>You submitted a poem</h3>
        <a href="https://finebitstrings.pythonanywhere.com/">Home</a>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:49:58.723

所以交易是这样的。当 django 或任何正在回复的回复：`missing signed_request.`时，它的真正含义是会话不包含 key 条目`'signed_request'`。您可以在初始请求的 POST 数据中找到此请求。将其保存在会话中，您就可以开始了。

# qt - 从 Qt 运行程序

> ID：12229239
> 
> 赞同：0
> 
> 时间：2012-09-01T15:57:15.553
> 
> 标签：qt, terminal, qprocess

我在 Linux 中使用 Qt。我需要从 Qt 运行“evince”pdf 阅读器。

我一直在搜索，据我所知，我可以使用 Qpr​​ocess 来使其工作。像这样的东西：

```
QStringList args;
    args.append("/home/user/presentacion0.pdf");
    QProcess p(this);
    p.start("/usr/bin/evince", args, QIODevice::ReadWrite);
    p.waitForFinished();
    QString p_stdout = p.readAllStandardOutput();
    QString p_stderr = p.readAllStandardError(); 
```

但我总是收到以下错误：

*未指定协议无法解析参数：无法打开显示：*

所以我尝试了`system(char *cmd)`from `stdlib.h`and doesn't work system("/usr/bin/evince /home/user/presentacion0.pdf");

我认为 system() 不起作用，因为“evince”是一个图形应用程序。`system()`但是我可以毫无问题地运行“ls”、“mkdir”等命令。

请我需要有关此主题的帮助。

我真的很感谢您提前提供的帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:16:51.677

您正在从没有`DISPLAY`正确设置环境变量（通常是`:0`）的应用程序（很可能是 shell）运行 Qt 应用程序。QProcess 使用调用进程的环境。

如果您对获取`evince`的 stdout 和 stderr 并不真正感兴趣，并且您不需要等待它完成，那么我会选择`QProcess::startDetached()`.

# xcode - Popover segue 到静态单元 UITableView 导致编译错误

> ID：12229243
> 
> 赞同：9
> 
> 时间：2012-09-01T15:58:02.880
> 
> 标签：xcode, ios5, uitableview, uistoryboardsegue

我目前有一个带有两个视图控制器的应用程序。第一个是具有嵌入式表格视图的视图控制器，该表格视图具有动态单元格。第二个是带有静态单元格的表格视图控制器。如果我从选择一个动态表格的单元格到静态表格视图控制器（使用 Push 或 Modal 样式设置）添加一个转场，我可以看到转场按预期工作。但是，当我将样式更改为 Popover 时，出现以下编译错误：

```
Couldn't compile connection: <IBCocoaTouchOutletConnection:0x4004c75a0 <IBProxyObject: 0x400647960> => anchorView => <IBUITableViewCell: 0x400f58aa0>> 
```

有没有其他人遇到过这个问题，或者有谁知道这个错误信息可能意味着什么？除非 Popover 中不支持静态表视图控制器，否则在编译时发生这种情况似乎很奇怪......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-03T00:51:23.087

我想出了如何做到这一点。您不能从情节提要中将其连接起来，但可以像这样以编程方式进行：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    UIStoryboard *sb = [UIStoryboard storyboardWithName:@"MainStoryboard_iPad"
                                                 bundle:nil];
    UITableViewController *detailController = [sb instantiateViewControllerWithIdentifier:@"TableSettingDetails"];

    self.popoverController = [[UIPopoverController alloc] initWithContentViewController:detailController];

    self.popoverController.popoverContentSize = CGSizeMake(320, 416);
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    [self.popoverController presentPopoverFromRect:cell.bounds inView:cell.contentView
                          permittedArrowDirections:UIPopoverArrowDirectionAny
                                          animated:YES];
} 
```

只需确保您在控制器中有对弹出框的引用，否则它将立即被处理 - 导致一些其他有趣的异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T16:01:05.080

您必须为非静态单元格的 Popover 选择一个锚点。我的建议是将 UIButton 设置为不可见（自定义类型）。然后选择 Popover Segue 并将 Anchor 连接拖到该按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:02:03.893

我知道这个问题已经得到解答，但如果它有帮助，我有一个解决方案，同时使用 segues 保留情节提要流程。您可以在这里查看 [是否可以手动执行 Popover Segue（从动态 UITableView 单元格）？](https://stackoverflow.com/questions/13845508/is-it-possible-to-perform-a-popover-segue-manually-from-dynamic-uitableview-cel/14514837#14514837)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-27T12:10:29.270

从 iOS 10 开始，@lehn0058 的正确且被接受的答案不再有效。这是他为 iOS 10 更新的解决方案...

```
override func tableView(_ tableView: UITableView, accessoryButtonTappedForRowWith indexPath: IndexPath) {
    // *** Next line doesn't work with popover, only full screen detail
    //self.performSegue(withIdentifier: "editRow", sender: self) 
    // Hence, do it by hand...
    let sb = UIStoryboard(name: "Main", bundle: nil)
    let detailVC: MyDetailViewController = sb.instantiateViewController(withIdentifier: "itemEditor") as! MyDetalViewController
    detailVC.modalPresentationStyle = .popover
    detailVC.popoverPresentationController?.sourceView = tableView.cellForRow(at: indexPath)
    detailVC.detailItem = self.itemAtIndexPath(indexPath)

    self.present(detailVC, animated: true, completion: {})
} 
```

# javascript - 跨域/跨浏览器，ajax调用

> ID：12229247
> 
> 赞同：1
> 
> 时间：2012-09-01T15:58:31.447
> 
> 标签：javascript, jquery, ajax, cross-browser, cross-domain

这是场景，

我有一个`main.js`文件，可以在`abc.com`其中`$.post("index.php")`访问`index.php`来自同一域 ( `abc.com`) 的内容。

这很好用，因为它是同一个域 ajax 调用。

但是现在，任何人都可以加入`main.js`他们的网站（比如 domain `xyz.com`）。

现在，路径`index.php`(in `$.post("index.php")`) 指的是域中的文件`xyz.com`(not `abc.com`)。如果我放一个绝对路径`http://www.abc.com/index.php`，这在某些浏览器中不起作用（跨域 ajax 限制）

现在，

如果我将允许跨域的标头放在 php 文件中，它也不起作用，在 ie 7 及以下版本中失败。

ps 我需要将内容放在 index.php 文件中（不在 main.js 中）。另外，我不想包含一个 php 文件

`<script type='text/javascript' src='http://abc.com/index.php'></script>`

而且我不希望在服务器中添加`.js`文件以将其视为`php`文件（因此我可以将 php 代码放入 js 文件中）。

内容很大，我不能做`get`请求或jsonp（我认为，jsonp不允许大数据）

我错过了什么吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:00:02.380

您可以使用[JSONP](http://json-p.org/)或[CORS](http://enable-cors.org/)来实现此目的。

我用过 JSONP，下周打算试试 CORS。我认为 CORS 仍然是异步的，所以这对我来说可能有优势。至少这是我的希望...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:08:59.337

我认为你需要去`server side solution`。在 php 中读取文件（即`index.php`）并保存所需的输出以用于 a`hidden field`和 DOM 就绪 您可以使用来自该隐藏字段的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T16:17:09.167

服务器端的 curl 请求也应该可以工作。我会说先尝试 JSONP，但如果它不起作用，请使用 curl 请求

# objective-c - 如何在数组对象中使用 objectAtIndex

> ID：12229248
> 
> 赞同：0
> 
> 时间：2012-09-01T15:58:33.870
> 
> 标签：objective-c, cocoa, nsmutablearray

我正在尝试掌握 Objective C 和 Cocoa，所以我可能在这里使用了错误的术语。

我已经为我的主 AppDelegate.h 和 AppDelegate.m 读取的一副纸牌制作了一个 Objective C 类，它有两个方法，deckOfCards 和 pickACard。deckOfCards 只是一个 NSMutableArray，每种卡片类型都以字符串形式写出，然后在 pickACard 中创建一个新数组，如下所示：

```
-(void)pickACard
{
    DeckOfCards *newDeck = [[DeckOfCards alloc] init];
    int r = arc4random() % 52;
    NSLog (@"The card you picked is: %@, and there are %i cards left", [newDeck     objectAtIndex:r], [newDeck count]);
    [newDeck removeObjectAtIndex:r];
} 
```

但是 XCode 说我不能在这个新数组上使用 objectAtIndex 和 removeObjectAtIndex，所以我不能随机选择一张卡片，然后通过删除数组的那部分来“从包中删除它”。

这在deckOfCards 中确实有效，但是当它被AppDelegate.m 调用时，它会创建一个新数组，所以我会得到不同的卡片，但永远不会从包中删除超过一张。

我猜我没有正确创建这个新数组。

为了更清楚起见，DeckOfCards.h 是这样的：

```
#import <Foundation/Foundation.h>

@interface DeckOfCards : NSObject
{
@private
}
-(void) deckOfCards;
-(void) pickACard;

@end 
```

DeckOfCards.m 是这样的：

```
@implementation DeckOfCards
-(void)deckOfCards
{
NSMutableArray *deckOfCards = [NSMutableArray arrayWithObjects:
    @"One of Hearts", @"Two of Hearts"..., nil];
}
-(void)pickACard
{
    DeckOfCards *newDeck = [[DeckOfCards alloc] init];
    int r = arc4random() % 52;
    NSLog (@"The card you picked is: %@, and there are %i cards left",[newDeck     objectAtIndex:r], [newDeck count]);
    [newDeck removeObjectAtIndex:r];
}

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:39:53.330

我在这里看到了一些问题。编译器问题的直接原因是您试图`NSMutableArray`在`DeckOfCards`. `NSMutableArray`相反，您希望在 method 的返回值上调用这些方法`-[DeckOfCards deckOfCards]`。它看起来像这样：

```
DeckOfCards *newDeck = [[DeckOfCards alloc] init];
NSMutableArray *deckArray = [newDeck deckOfCards];
int r = arc4random() % 52;
NSLog (@"The card you picked is: %@, and there are %i cards left",[deckArray objectAtIndex:r], [deckArray count]);
[deckArray removeObjectAtIndex:r]; 
```

但这将我们引向下一个问题——`-deckOfCards`实际上并不返回任何东西——它的返回类型被定义为`void`. 因此，为了将该`NSMutableArray`实例返回到程序的其余部分，您将不得不使用`return`它，并使用适当的返回类型定义方法。如果我们只是为了解决这个问题，我们会`-deckOfCards`像这样改变你的方法：

```
-(NSMutableArray *)deckOfCards
{
    NSMutableArray *deckOfCards = [NSMutableArray arrayWithObjects:
        @"One of Hearts", @"Two of Hearts"..., nil];

    return deckOfCards;
} 
```

好的，所以现在应该编译。但是这里有一些严重的错误。恐怕我现在没有更多时间来回答这个问题，但我建议你阅读一些介绍性的 Objective-C，重点关注对象和类之间的区别，以及对象的生命周期和内存管理。本质上，没有什么是持久的。无论您调用`-pickACard`的任何实例多少次`DeckOfCards`，您总是会获得一个单独的实例实例化，然后该实例将获得一个全新的`NSMutableArray`实例化。但是这些对象都不会被保留（假设您使用的是自动引用计数）并且它们都会立即消失。因此，您每次都能从`-pickACard`.

希望这会有所帮助。花一些时间阅读和学习 Objective-C 和面向对象编程的基础知识，您将顺利地使该程序按您的意愿运行。如果您有任何问题，请告诉我，我会尽力回答。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T07:21:48.850

> 但是 XCode 说我不能在这个新数组上使用 objectAtIndex 和 removeObjectAtIndex，...</p>

不，这是说您没有尝试在阵列上使用它。

您尝试使用的是 DeckOfCards：

> ```
> DeckOfCards *newDeck = [[DeckOfCards alloc] init];
> int r = arc4random() % 52;
> NSLog (@"The card you picked is: %@, and there are %i cards left", [newDeck     objectAtIndex:r], [newDeck count]);
> [newDeck removeObjectAtIndex:r]; 
> ```

`newDeck`是`DeckOfCards`您在第一行创建的。

A`DeckOfCards`不是数组：

> ```
> @interface DeckOfCards : NSObject 
> ```

A`DeckOfCards`只是一个对象。不只是任何物体；你已经添加了一些东西（`deckOfCards`和`pickACard`方法）。但它不是一个数组，因此不响应，`objectAtIndex:`也不是可变数组，因此也不响应`removeObjectAtIndex:`。

那么你在哪里*有*一个数组？好吧，你在你的`deckOfCards`方法中创建一个：

> ```
> -(void)deckOfCards
> {
> NSMutableArray *deckOfCards = [NSMutableArray arrayWithObjects:
>     @"One of Hearts", @"Two of Hearts"..., nil];
> } 
> ```

但是那个数组会发生什么？

没有。您创建它，然后将其放在地板上。你不会把它归还给任何叫你的人；事实上，你不能，因为这个方法返回`void`.

暂时搁置架构问题，假设您对编程非常陌生，这可以原谅，您需要做几件事：

1.  更改`deckOfCards`方法的声明以声明它将返回一个`NSMutableArray *`，而不是`void`。
2.  在创建返回数组的数组后立即添加一行：

    ```
    return deckOfCards; 
    ```

    （请注意，`deckOfCards`这里指的是数组*。）

3.  改为`pickACard`调用`deckOfCards`。这将创建数组并（一旦您进行了更改#2）将其返回给您。在 中声明一个变量`pickACard`，类似于您在中声明的变量`deckOfCards`，并将结果分配`deckOfCards`给它。

4.  现在您在 中拥有一个数组`pickACard`，您可以尝试检索其中一项、记录并删除它。通过将`objectAtIndex:`and`removeObjectAtIndex:`消息发送到数组来做到这一点，而不是发送到不是数组的对象。
5.  当您使用它时，请更正`r`. NSArray 索引的类型是`NSUInteger`，而不是`int`。

现在程序应该可以编译、运行并且几乎可以工作了。

几乎？好吧，你还有一件事要做。

`deckOfCards`每次创建一个新的牌组；您从该套牌中取出一张牌，但随后忘记了该套牌的所有内容，并且下一次将使用另一个新套牌。

这是您的下一个挑战：更改程序以在初始化时创建一个套牌，并记住并在每次后续抽签时重复使用该套牌。一定要正确处理套牌用尽（没有更多牌）的情况，可能是通过在那一刻创建一个新的套牌。

（您的第一直觉是复制和粘贴。仅作为初稿进行。然后对其进行更改，以使甲板创建代码仅在一个地方，一种用于此目的的方法，并且您从两个地方调用该方法你需要创建一个新的牌组。）

我给你一个提示：实例变量。

* * *

*在您的`deckOfCards`方法中，您将看到两个名为 的东西`deckOfCards`：该方法和您在其中声明的数组。同名的两个不同的东西。编译器不在乎；方法和变量存在于不同的命名空间中，因此在任何给定时刻知道哪个是哪个都没有问题。但是您可能应该更改其中一个以帮助您自己的理解，更不用说其他人对更改什么的建议（`deckOfCards`我说“用 做这个”——但`deckOfCards`我的意思是什么？）。

我建议重命名数组变量。只需命名它就`array`可以开始了。（但只要它是在该方法中声明的局部变量。）

当您将其设为实例变量时，将名称改回更具体的名称。`_deckOfCards`是当今常见的命名约定——下划线告诉你（同样，编译器并不关心）这个名字是一个实例变量的名字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T17:25:56.357

正如其他评论者所说，您的应用程序结构存在多个问题。我创建了一个示例应用程序来向您展示如何着手解决这个问题。首先，在您的 DeckOfCards 类中，您需要一个属性，该属性指向保存您的牌组的可变数组——我称这只是牌组。然后，您需要一个 init 方法，它不仅返回 DeckOFCards 类的实例，而且还创建和填充该卡片数组。所以这就是我放在 DeckOfCards 类中的内容。

在 .h 中，就是这样：

```
@interface DeckOfCards : NSObject

@property (retain,nonatomic) NSMutableArray *deck;

@end 
```

而且，在 .m 中：

```
-(id)init {
    if (self = [super init]) {
        NSArray *cardNames = [NSArray arrayWithObjects:@"Two",@"Three",@"Four",@"Five",@"Six",@"Seven",@"Eight",@"Nine",@"Ten",@"Jack",@"Queen",@"King",@"Ace",nil];
        NSArray *suits = [NSArray arrayWithObjects:@" of Hearts",@" of Diamonds",@" of Spades",@" of Clubs",nil];
        self.deck = [NSMutableArray array];
        for (NSString *aCard in cardNames) {
            for (NSString *aSuit in suits) {
                [self.deck addObject:[aCard stringByAppendingString:aSuit]];
            }
        }
    }
    return self;
} 
```

你想创建这个类的一个实例，并从另一个类中挑选卡片，而不是从 DeckOfCards 类本身中挑选卡片。在本例中，我在应用程序委托中完成了此操作（为简单起见），但最好在某些控制器类中执行此操作。所以，我有一个属性 aNewDeck 来保留对该实例的引用（编译器不会让您使用以“new”开头的名称，不知道为什么，或者这是否是山狮中的新事物）。我在 applicationDidFinishLoading 方法中创建了该新实例，然后将 IBAction 连接到选择卡片的按钮。请注意，我将随机数生成器更改为不使用 52，而是使用数组的计数——如果你不这样做，你将选择比数组更大的数字，因为它变得更小。你应该注意到，为了访问数组，我使用 aNewDeck.deck，这是访问实例 aNewDeck 的属性、deck 的方法。这是.h文件：

```
@class DeckOfCards;
#import <Cocoa/Cocoa.h>

@interface AppDelegate : NSObject <NSApplicationDelegate>

@property (assign) IBOutlet NSWindow *window;
@property (strong) DeckOfCards *aNewDeck;

-(IBAction)pickACard:(id)sender ;

@end 
```

这是.m：

```
#import "AppDelegate.h"
#import "DeckOfCards.h"

@implementation AppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {
    self.aNewDeck = [[DeckOfCards alloc] init];
}

-(IBAction)pickACard:(id)sender {
    if (self.aNewDeck.deck.count != 0) {
        int r = arc4random() % [self.aNewDeck.deck count];
        NSLog (@"The card you picked is: %@, and there are %li cards left", [self.aNewDeck.deck  objectAtIndex:r], [self.aNewDeck.deck count] - 1 );
        [self.aNewDeck.deck removeObjectAtIndex:r];
    }else{
        NSLog(@"Game Over!");
    }
} 
```

我希望这可以帮助您入门。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T16:39:38.467

DeckOfCards 不是 NSMutableArray 的子类，它也没有实现`- objectAtIndex:`and`- removeObjectAtIndex:`方法 - 所以你不能使用这些方法很好。

# perl - 在分叉进程中嵌入 Mojolicious::Server

> ID：12229253
> 
> 赞同：3
> 
> 时间：2012-09-01T15:59:10.840
> 
> 标签：perl, mojolicious

在一个小的 netflow 收集器（如 ntop）上工作，我想在我的程序启动时生成一个 Web 服务器（不想强迫人们配置一个外部 Web 服务器）。我在弄清楚如何让我的应用程序在 fork 中启动时遇到了一些麻烦。这就是我正在做的事情：

```
#This is basically what the child process is doing.
#running this outside of my fork does the same thing.
use myApp;
use Mojo::Server;
use Mojo::Server::Daemon;
use Mojolicious::Commands;
my $daemon = Mojo::Server::Daemon->new( listen => ['http://*:5656'] );

Mojolicious::Commands->start_app('myApp'); 
```

myApp.pm 包含

```
sub startup
{
    my $self = shift();

    my $r = $self->routes;

    $r->get('/') => sub {
        my $self = shift;

        $self->render( text => "Howdy!!" );
    };

} 
```

当我运行它时，我得到以下信息。. .

```
usage: ./FlowTrack.pl COMMAND [OPTIONS]

Tip: CGI and PSGI environments can be automatically detected very often and
     work without commands.

These commands are currently available:
  cgi        Start application with CGI.
  cpanify    Upload distribution to CPAN.
  daemon     Start application with HTTP and WebSocket server.
  eval       Run code against application.
  generate   Generate files and directories from templates.
  get        Perform HTTP request.
.
.
etc
. 
```

我还没有找到做我想做的事情的文档/示例。我确定我只是没有找对地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:18:25.440

弄清楚了。无论如何，如果其他人试图这样做，输入问题似乎总是会播下修复的种子。（我的应用程序中仍然有一个错误，即停止测试工作，但我已经启动了服务器循环）

```
use MyApp;
use Mojo::Server;
use Mojo::Server::Daemon;
use Mojolicious::Commands;

my $daemon = Mojo::Server::Daemon->new( app => MyApp, listen => ['http://*:5656'] );

$daemon->run(); 
```

终于找到了一个将应用程序放入守护进程新调用的示例。然后我意识到新的调用可能也没有启动循环，所以我在那里挖了一点。考虑删除该问题，但我认为其他人可能会觉得它有用。

# android - 数组共享首选项重建 TableLayout OnDestroy

> ID：12229254
> 
> 赞同：1
> 
> 时间：2012-09-01T15:59:17.427
> 
> 标签：android, arrays, android-tablelayout, ondestroy

我有一个应该用作日记的应用程序，用户可以在其中输入一些文本并将其存储以供将来阅读。每个条目一个接一个地存储在一个 tableLayout 中。

我在一个数组中有这些文本，我希望 tableLayout 是永久的，我的意思是即使调用了销毁，所以我需要使用共享首选项。

例如，如果用户在重启后打开我的应用程序，我如何恢复所有行？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:25:00.663

如果您使用 API 级别 11 或更高级别，则可以使用[`getStringSet()`](http://developer.android.com/reference/android/content/SharedPreferences.html#getStringSet%28java.lang.String,%20java.util.Set%3Cjava.lang.String%3E%29)和[`putStringSet()`](http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#putStringSet%28java.lang.String,%20java.util.Set%3Cjava.lang.String%3E%29)函数。这是一个例子：

```
SharedPreferences prefs = context.getSharedPreferences("YourApp", Context.MODE_PRIVATE);
SharedPreferences.Editor editor = prefs.edit();

String yourArray = new String [] {"Hello", "World", "How", "Are", "You"};
editor.putStringSet(new HashSet(Arrays.asList(yourArray)), "test"); 
```

把它拿回来：

```
Set<String> data = prefs.getStringSet("test", null); 
```

如果您使用较低级别的 API：

## 写下来：

```
//context - a context to access sharedpreferences
//data[] - the array you want to write
//prefix - a prefix String, helping to get the String array back.

public static void writeList(Context context, String [] data, String prefix)
{
    SharedPreferences prefs = context.getSharedPreferences("YourApp", Context.MODE_PRIVATE);
    SharedPreferences.Editor editor = prefs.edit();

    int size = data.length;

    // write the current list
    for(int i=0; i<size; i++)
        editor.putString(prefix+"_"+i, data[i]);

    editor.putInt(prefix+"_size", size);
    editor.commit();
} 
```

## 检索它：

```
public static String[] readList (Context context, String prefix)
{
    SharedPreferences prefs = context.getSharedPreferences("YourApp", Context.MODE_PRIVATE);

    int size = prefs.getInt(prefix+"_size", 0);

    String [] data = new String[size];
    for(int i=0; i<size; i++)
        data[i] = prefs.getString(prefix+"_"+i, null);

    return data;
} 
```

## 删除整个列表：

```
public static int removeList (Context context, String prefix)
{
    SharedPreferences prefs = context.getSharedPreferences("YourApp", Context.MODE_PRIVATE);
    SharedPreferences.Editor editor = prefs.edit();

    int size = prefs.getInt(prefix+"_size", 0);

    for(int i=0; i<size; i++)
        editor.remove(prefix+"_"+i);

    editor.commit();
    return size;
} 
```

## 用它：

（这应该在您的活动中）

```
//write it:
String yourArray = new String [] {"Hello", "World", "How", "Are", "You"};
writeList(this, yourArray, "test");

//get it back:
String yourArray = readList(this, "test");

//delete it:
removeList(this, "test"); 
```

# jsf-2 - JSF 对话框未打开

> ID：12229255
> 
> 赞同：0
> 
> 时间：2012-09-01T15:59:19.277
> 
> 标签：jsf-2, primefaces

好的，伙计们，我有一个问题：我的面板和 ajax 行为突然停止工作。他们跑得很好，但突然停下来工作。在我的 JSF 页面中，我有一个对话框面板（**confirmPanel、newPanel**），它必须在 commandButtons（**btnNew、btnExclude**）的单击事件上打开。这是 JSF 页面的代码。

```
 <ui:define name="content">
        <f:view>
            <h:form id="frmPublico">
                <p:panelGrid columns="2" styleClass="ui-main-div">
                    <f:facet name="header">
                        <p:panelGrid columns="2">
                            <p:commandButton id="btnNew" value="Novo" onclick="wvNew.show();" type="button"/>
                        </p:panelGrid>
                    </f:facet>
                    <p:growl id="gGlobalMsgs" globalOnly="true" redisplay="false"/>
                    <p:dataTable id="dtPublico" value="#{publicoBean.lstDataTablePublico}" 
                             var="publico" paginator="true" rows="#{publicoBean.maximoLinhasTablePublico}" 
                             paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="5,10" >

                        <f:facet name="header">
                            Públicos
                        </f:facet>
                        <p:column>
                            <p:commandButton type="button" id="btnEdit" image="ui-icon-pencil" /> 
                        </p:column>
                        <p:column>
                            <p:commandButton type="button" id="btnExclude" image="ui-icon-circle-close" onclick="wvConfirm.show()" /> 
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                Nome
                            </f:facet>
                            <h:outputText value="#{publico.nmePublico}" />
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                Tipo de público
                            </f:facet>
                            <h:outputText value="#{publico.tdTipoPublico}"  />
                        </p:column>

                        <f:facet name="footer">
                            Públicos
                        </f:facet>
                    </p:dataTable>

                    <f:facet name="footer">

                    </f:facet>
                </p:panelGrid>

                <!-- Caixas de diálogos -->
                <p:dialog id="dialogNovo" header="Novo público" widgetVar="wvNew" modal="true" appendToBody="false" >
                    <p:panelGrid columns="1">

                        <p:panelGrid columns="2" id="pnlNovoPublico">
                            <!-- Cabeçalho do grid -->
                            <f:facet name="header">
                                <!-- <p:messages id="info"/> -->
                                Cadastrar público
                            </f:facet>

                            <!-- Linha 1 -->
                            <h:outputLabel for="txtNomePublico" value="*Nome:"/>
                            <p:inputText id="txtNomePublico" value="#{publicoBean.nome}" required="true" requiredMessage="Digite o nome do público." />
                            <p:message for="txtNomePublico" redisplay="false" id="msgNomePublico" />

                            <!-- Linha 2 -->
                            <h:outputLabel for="ddlTipoPublico" value="*Tipo de público:"/>
                            <p:selectOneMenu id="ddlTipoPublico" value="#{publicoBean.tipoPublicoSelecionado}" effect="fade" 
                                         converter="#{publicoBean.conversor}" 
                                         required="true" requiredMessage="Selecione um tipo de público."> 
                                <f:selectItem itemLabel="Selecione um item..." itemValue=""/>
                                <f:selectItems value="#{publicoBean.lstMenuTipoPublico}" var="pt" itemLabel="#{pt.label}" itemValue="#{pt}"></f:selectItems>
                        </p:selectOneMenu>
                            <p:message for="ddlTipoPublico" redisplay="false" id="msgDdlTipoPublico" />

                        <!-- Rodapé do grid -->
                            <f:facet name="footer">
                                <p:commandButton actionListener="#{publicoBean.cadastrarPublico}" value="Cadastrar" icon="ui-icon-check" ajax="true" update="pnlNovoPublico, msgGlobal"/>
                            </f:facet>
                        </p:panelGrid>
                    </p:panelGrid>
                </p:dialog>

                <!-- Caixa de diálogo de confirmação -->
                <p:confirmDialog id="dialogConfirmExclusao" message="Tem certeza que deseja excluir este item?"
                             header="Confirmar exclusão" severity="alert" widgetVar="wvConfirm">
                    <p:commandButton id="btnConfirm" value="Continuar" oncomplete="wvConfirm.hide()"
                                 actionListener="#{publicoBean.excluirPublico}" />
                    <p:commandButton id="btnCancel" value="Cancelar" onclick="wvConfirm.hide()" type="button" /> 

                </p:confirmDialog>
            </h:form>
        </f:view>
    </ui:define>
</ui:composition> 
```

**Id**和WidVar**属性**不同。当我打开 Javascript 控制台并点击**wvNew**和**wvConfirm**时，它们是未定义的。可能会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T06:01:47.557

来自 PrimeFaces 文档：

> 小心使用 appendToBody，因为页面定义和 html dom 会有所不同，例如，如果对话框位于 h:form 组件内并且启用了 appendToBody，则浏览器上的对话框将超出表单并可能导致意外结果。在这种情况下，在对话框中嵌套一个表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:04:00.067

我更改了我的 xhtml，使其现在遵循建议：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
            xmlns:h="http://java.sun.com/jsf/html"
            xmlns:f="http://java.sun.com/jsf/core"
            xmlns:p="http://primefaces.org/ui"
            template="./../../resources/templates/baseTemplate.xhtml">

<ui:define name="content">
    <f:view>
        <h:form id="frmPublic">
            <!-- Show general msgs -->
            <p:growl id="gMessages" globalOnly="true" sticky="false" />

            <!-- Show public list -->
            <p:dataTable id="dtPublics" value="#{publicBean.publics}"
                         paginator="true" rows="5" rowsPerPageTemplate="5,10"
                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         var="actual">
                <f:facet name="header">
                    <p:commandButton id="cbViewNew" value="New" type="button" styleClass="cbViewNew" onclick="dlgNewPublic.show();" />
                </f:facet>
                <!-- Edit and delete columns -->
                <p:column>
                    <p:commandButton id="cbViewEdit"  image="ui-icon-pencil" 
                                     oncomplete="dlgEditPublic.show()"  title="Edit">
                        <f:setPropertyActionListener value="#{actual}" target="#{publicBean.selectedPublic}" />
                    </p:commandButton>
                </p:column>
                <p:column>
                    <p:commandButton id="cbViewDelete" type="button" image="ui-icon-circle-close" onclick="dlgConfirm.show()" title="Delete" /> 
                </p:column>
                <p:column>
                    <f:facet name="header">
                        Name
                    </f:facet>
                    <h:outputLabel id="olViewPublicName" value="#{actual.publicName}"/>
                </p:column>
                <p:column>
                    <f:facet name="header">
                        Public type
                    </f:facet>
                    <h:outputLabel id="olViewPublicType" value="#{actual.publicType}"/>
                </p:column>
            </p:dataTable>
        </h:form>
        <!-- Caixa de diálogo de inclusão -->
        <p:dialog id="newPublicDialog" widgetVar="dlgNewPublic" modal="true" header="New"
                  resizable="false">
            <h:form id="frmNew">
                <p:panelGrid columns="2">
                    <p:outputLabel id="olNewPublicName" value="Name:" for="itNewPublicName"/>
                    <p:inputText id="itNewPublicName" value="#{publicBean.name}" required="true"
                                 requiredMessage="Enter the name"/>
                    <p:outputLabel id="olNewPublicType" for="somNewPublicType" value="Public type:"/>
                    <p:selectOneMenu id="somNewPublicType" value="#{publicBean.selectedPublicType}" effect="fade" 
                                     converter="#{publicBean.converter}" 
                                     required="true" requiredMessage="Select a public type"> 
                        <f:selectItem itemLabel="-- Select --" itemValue=""/>
                        <f:selectItems value="#{publicoBean.lstPublicType}" var="actual" itemLabel="#{actual.label}" itemValue="#{actual}"></f:selectItems>
                    </p:selectOneMenu>
                    <p:commandButton id="cbNewSave" value="Save" update=":dlgNewPublic" actionListener="#{publicBean.save}" icon="ui-icon-check" 
                                      oncomplete="dlgNewPublic.hide();" />
                    <p:commandButton value="Cancel" immediate="true" onclick="dlgNewPublic.hide()"/>
                    <f:facet name="footer">
                        <p:message id="mNewPublicName" for="itNewPublicName" redisplay="false" />
                        <p:message id="mNewPublicType" for="somNewPublicType" redisplay="false"  /> 
                    </f:facet>
                </p:panelGrid>
            </h:form>
        </p:dialog>
    </f:view>
</ui:define> 
```

我的bean保存方法如下：

```
...

private String name;
private PublicType publicType;
private PublicDao publicDao;
private List<Public> publics;
// Getters and Setters

...

// Actions e listeners
public void save(ActionEvent ex) {
    FacesContext context = FacesContext.getCurrentInstance();
    FacesMessage msg = new FacesMessage();
    try {
        TbPublic p = new TbPublic();
        p.setName(getName() );
        p.setTdTipoPublico(getPublicType());

        publicDao.save(p);

        // Showing success msg
        msg.setSummary("Success!");
        msg.setSeverity(FacesMessage.SEVERITY_INFO);
        context.addMessage(null, msg);

        // Load the list of public again
        publicList = publicDao.getAll();

    } catch (Exception e) {
        msg.setSummary("Error !");
        msg.setSeverity(FacesMessage.SEVERITY_ERROR);
        context.addMessage(null, msg);
    }
} 
```

当我单击新建按钮时，我的对话框完美打开。但是在我填写必要的信息并单击“保存”按钮后，什么也没有发生。为什么会这样？

# windows-phone-7 - 将 Team build 输出文件夹中的文件包含到 XAP 中

> ID：12229262
> 
> 赞同：3
> 
> 时间：2012-09-01T16:00:00.670
> 
> 标签：windows-phone-7, silverlight-4.0, msbuild, tfsbuild

我正在尝试使用 TFS 2010 为 Windows Phone 7.1 项目进行持续集成。有 2 个资源项目（[用于本地化的 Win32 项目](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff967550%28v=vs.92%29.aspx)）和主要的 Windows 手机项目。

我已将上述 2 个项目的项目输出复制到主 WP 项目中的一个文件夹（在“MUI”文件夹内），并在构建操作中将文件标记为“内容”。从 Visual Studio 2010 构建和运行 WP7 项目时一切正常。

但是，当我尝试使用 TFS 2010 构建系统构建项目时，构建失败并出现以下错误*“Xap 打包失败。对象引用未设置为对象的实例”*。在研究了错误之后，我发现在 TFS 代理机器上构建文件时，TFS 二进制文件（输出文件夹）文件夹没有“MUI”文件夹，但 2 个资源项目的输出直接复制到二进制文件中文件夹，因此构建失败。

我还注意到，如果我将文件直接添加/包含到主 WP 项目中，则 TFS 构建成功。（换句话说，如果我将项目输出配置为复制到 WP7 项目文件夹，则失败。由于 TFS 将所有内容构建到“二进制”文件夹)

如何将这些文件包含在 TFS 二进制文件夹中的 WP7 XAP 文件（引用它们）中？（使用 MSBuild 任务？）同样适用于 VS2010 中的本地构建。

还有其他方法可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T23:14:45.930

这就是我使用[SlowCheetah](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5)解决它的方法。

* * *

## 测试：

**地点**

*   本地
*   构建服务器 (TFS 2012)

**Visual Studio 版本**

*   视觉工作室 2010
*   视觉工作室 2012

**Silverlight 版本**

*   银光4

* * *

## 过程

*   使用 SlowCheetah 创建变换
*   在项目结束时使用以下信息更新 Visual Studio 项目：

    ```
    <PropertyGroup>
        <XapPackagerDependsOn>
          TransformAllFiles;
          IncludeTransformedFileInXapFile;
          $(XapPackagerDependsOn);
        </XapPackagerDependsOn>
    </PropertyGroup>
    <Target Name="IncludeTransformedFileInXapFile">
        <ItemGroup>
          <XapFilesInputCollection Include="$(OutDir)YOUR-FILES.CONFIG" />
        </ItemGroup>
    </Target> 
    ```

    *   确保配置文件和转换文件没有被复制到输出文件夹：

        ![在此处输入图像描述](../Images/6f2c091144d06050221963d04800d9e9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:32:55.550

通过将资源项目的输出路径设置为WP7项目的输出路径，然后使用XapFilesInputCollection将它们包含在xap中解决了这个问题。

还更改了 WMAppManifest.xml 中应用程序标题的引用路径。

**所做的更改**：

*一个*。在每个资源项目文件中添加/替换了 OutDir 标记。

```
<OutDir>$(SolutionDir)$(SolutionName)\bin\Debug</OutDir> 
```

这会将资源项目输出复制到主项目输出 AppResLib.dll 和 AppResLib.dll.040b.mui

*乙*。然后在主 Windows Phone 项目文件 (.csproj) 中添加

```
 <Target Name="AfterCompile">
         <ItemGroup>
           <XapFilesInputCollection Include="$(OutDir)\AppResLib.dll"/>
           <XapFilesInputCollection Include="$(OutDir)\AppResLib.dll.040b.mui"/>
         </ItemGroup>
   </Target> 
```

这适用于 VS 2010 构建以及 TFS 2010 构建系统。

参考[Silverlight MSBuild Task - Xap 复制到 ClientBin 后执行命令行](https://stackoverflow.com/questions/10073600/silverlight-msbuild-task-execute-command-line-after-xap-copied-to-clientbin)

# java - 加密和解密 ArrayList

> ID：12229265
> 
> 赞同：5
> 
> 时间：2012-09-01T16:00:02.867
> 
> 标签：java, encryption, file-io, aes

我需要通过加密将字符串数组列表存储在文件中。然后我解密文件内容并将它们恢复到一个数组列表。但是当我解密内容时，内容中存在“空”块。没有“空”块，其余文本与我编码的相同。

```
public static void encryptFile(List<String> moduleList, File fileOut) {
    try {
        OutputStream out = new FileOutputStream(fileOut);
        out = new CipherOutputStream(out, encryptCipher);
        StringBuilder moduleSet = new StringBuilder();
        for (String module : moduleList) {
            moduleSet.append(module + "#");
        }
        out.write(moduleSet.toString().getBytes(Charset.forName("UTF-8")));
        out.flush();
        out.close();
    } catch (java.io.IOException ex) {
        System.out.println("Exception: " + ex.getMessage());
    }
}

public static List<String> decryptFile(File fileIn) {
    List<String> moduleList = new ArrayList<String>();
    byte[] buf = new byte[16];

    try {
        InputStream in = new FileInputStream(fileIn);
        in = new CipherInputStream(in, decryptCipher);

        int numRead = 0;
        int counter = 0;
        StringBuilder moduleSet = new StringBuilder();
        while ((numRead = in.read(buf)) >= 0) {
            counter++;
            moduleSet.append(new String(buf));
        }

        String[] blocks = moduleSet.split("#");
        System.out.println("Items: " + blocks.length);

    } catch (java.io.IOException ex) {
        System.out.println("Exception: " + ex.getMessage());
    }
    return moduleList;
} 
```

我尝试使用 UTF-16，因为字符串是在 UTF-16 中用 java 编码的，但这只会使输出变得最差。您的建议将不胜感激...谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:32:05.543

我会删除将列表内容转换为字符串和从字符串转换的代码，并将其替换为[ObjectOutputStream](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)：

```
FileOutputStream out1 = new FileOutputStream(fileOut);
CipherOutputStream out2 = new CipherOutputStream(out1, encryptCipher);
ObjectOutputStream out3 = new ObjectOutputStream(out2);
out3.writeObject(moduleList); 
```

然后，回读：

```
FileInputStream in1 = new FileInputStream(fileIn);
CipherInputStream in2 = new CipherInputStream(in1, decryptCipher);
ObjectInputStream in3 = new ObjectInputStream(in2);
moduleList = (Set<String>)in3.readObject() 
```

# php - 将时间转换为 DataInterval 实例

> ID：12229270
> 
> 赞同：0
> 
> 时间：2012-09-01T16:00:52.323
> 
> 标签：php

我正在尝试将间隔转换为单词。我遇到了这个错误`Argument 1 passed to Database::intervalToWords() must be an instance of DateInterval, string given`。我该如何解决这个问题，所以我没有收到错误消息？

```
//query from database

function one() {
            $posted = htmlspecialchars(strtotime($row['posted']),ENT_QUOTES);
                            $time_now = time(); //current date/time

                        $newposted = date('Y-m-d h:i:s',($time_now-$posted));

                        $newposted = $this->intervalToWords($newposted);

}

function intervalToWords(DateInterval $interval)
{
    $intervalStr = '';
    if ($interval->y > 0) {
    //if over a year
        $intervalStr = 'Over ' . $interval->y . ' year' . ($interval->y > 1 ? 's' : ''); //years or year
    } else {
        if ($interval->m > 2) {
        //if over 2 months
            $intervalStr = $interval->m . ' months';
        } else if ($interval->m > 0) {
            //if a month
            $intervalStr = $interval->m . ' month' . ($interval->m > 1 ? 's' : '') . ' and ' . $interval->d . ' day' . ($interval->d > 1 ? 's' : '');
        } else {
            if ($interval->d > 1) {
              //if over a day
                $intervalStr = $interval->d . ' days';
            } else if($interval->d == 1) {
              //if a day
                $intervalStr = '1 day, ' . $interval->h . ' hour' . ($interval->h > 1 ? 's' : '');
            } else {
                if ($interval->h > 0) {
                //if over an hour   
                    $intervalStr = $interval->h . ' hour' . ($interval->h > 1 ? 's' : '') . ', ';
                }
                if ($interval->i > 0) {
                //if over a minute
                    $intervalStr .= $interval->i . ' minute' . ($interval->i > 1 ? 's' : '');
                } else {
                    $intervalStr = 'less than 1 minute';
                }
            }
        }
    }

    return $intervalStr . ' ago';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:06:17.403

您可能正在寻找：[`DateTime::diff()`](http://www.php.net/manual/en/datetime.diff.php)

但是你需要一个基线`DateTime`来区分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:14:46.530

而且您可能忘记创建 DateInterval 对象的实例：

```
//query from database    
function one() {
            $posted = htmlspecialchars(strtotime($row['posted']),ENT_QUOTES);
                            $time_now = time(); //current date/time

                        //$newposted = date('Y-m-d h:i:s',($time_now-$posted));
                        $dv = new DateInterval('PT'.($time_now-$posted).'S');

                        $newposted = $this->intervalToWords($dv);

} 
```

# android - PagerTabStrip setDrawFullUnderline 不起作用

> ID：12229272
> 
> 赞同：3
> 
> 时间：2012-09-01T16:01:01.213
> 
> 标签：android

调用 setDrawFullUnderline(false) 仍会绘制下划线。还尝试将颜色设置为透明使其变黑。

它可以通过继承 PageTapStrip 并覆盖 onDraw 并且不调用 super 来解决。我也在遍历孩子们能够设置字体。

这是限制组件与其他应用程序一致的错误还是默认行为？我虽然看到一些代码忽略了下划线颜色的 alpha 值。

# android - 从 externalStorage 加载位图后为空

> ID：12229277
> 
> 赞同：1
> 
> 时间：2012-09-01T16:01:17.513
> 
> 标签：android, bitmap

在我的参考活动中，我使用以下代码从用户选择创建位图：

```
Uri selectedImage = imageReturnedIntent.getData(); // uri from user selection.
File tempFile; // temporary File
Uri tempUri; // temporary Uri

try 
{
    // initializing File
    tempFile = File.createTempFile("crop", "png", Environment.getExternalStorageDirectory());
}
catch (IOException e1)
{
    tempFile = null;
}

if(tempFile != null)
{
    // initializing Uri
    tempUri = Uri.fromFile(tempFile);   
}
else
{
    tempUri = selectedImage;
}

// creating new crop intent
final Intent intent = new Intent("com.android.camera.action.CROP");
intent.setData(selectedImage); // original image Uri
intent.putExtra("outputX", width);
intent.putExtra("outputY", height);
intent.putExtra("aspectX", width);
intent.putExtra("aspectY", height);
intent.putExtra("scale", true);
intent.putExtra("noFaceDetection", true);
intent.putExtra("output", tempUri);  // cropped image Uri
intent.putExtra("outputFormat", "PNG");
startActivityForResult(intent, 23);

InputStream imageStream;
Bitmap yourSelectedImage;
try
{
    // initializing InputStream
    imageStream = getContentResolver().openInputStream(tempUri);
}
catch (FileNotFoundException e) 
{
    imageStream = null;
}

if(imageStream != null)
{
    // getting Bitmap from Uri
    yourSelectedImage = BitmapFactory.decodeStream(imageStream);
}
else
{
    yourSelectedImage = null;
} 
```

然后在我的其他活动中，我尝试检索这个裁剪的图像并绘制它。但它始终显示为 null 并绘制默认位图。

这是检索部分：

```
File tempF = new File(Environment.getExternalStorageDirectory().getAbsolutePath() + File.separator + "crop.png"); // also tried using only "crop" as filename.

Uri uri = Uri.fromFile(tempF);

InputStream imageStream;
Bitmap yourSelectedImage;
try
{
imageStream = getContentResolver().openInputStream(uri);
}
catch (FileNotFoundException e) 
{
    imageStream = null;
}

if(imageStream != null)
{
    yourSelectedImage = BitmapFactory.decodeStream(imageStream);
}
else
{
    yourSelectedImage = null;
}

if(yourSelectedImage == null)
{
    drawable = BitmapFactory.decodeResource(getResources(),R.drawable.bg);  // bg is default bitmap if image is not found.
}
else
{
    drawable = yourSelectedImage;
}

// *all drawing happens here*

tempF.delete(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:03:19.743

十分钟前我遇到了同样的问题，直到我发现这个：

```
Intent intent = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
             startActivityForResult(intent, TFRequestCodes); 
```

在你的结果方法中添加：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) { 

if (requestCode == TFRequestCodes && resultCode == RESULT_OK) {  

        selectedImage = data.getData();
        String[] filePathColumn = {MediaStore.Images.Media.DATA};

        Cursor cursor = getContentResolver().query(selectedImage, filePathColumn, null, null, null);
        cursor.moveToFirst();

        int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
        filePath = cursor.getString(columnIndex);
        cursor.close();

       thumbnail=decodeSampledBitmapFromResource(getResources(), filePath,
                120, 85);

        i1.setImageBitmap(thumbnail);
    } 
} 
```

希望这可以帮助。

# java - Spring注解的区别

> ID：12229282
> 
> 赞同：44
> 
> 时间：2012-09-01T16:02:24.253
> 
> 标签：java, spring, spring-annotations

**问题：**

`@Component`1)和之间的区别`@Configuration`？

我已经读过两者都消除了将代码放入 XML 中的必要性，但没有得到它们之间的区别。

`@Autowired`2 )`@Inject`和之间有什么区别`@Resource`？
- 什么时候使用？
- 各自的优缺点是什么？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-09-01T20:06:35.343

`@Component`并且`@Configuration`确实是非常不同类型的注释。

`@Component`和类似的注解（`@Service`,`@Repository`等）及其对应的[JSR-330](http://jcp.org/aboutJava/communityprocess/final/jsr330/index.html)`@Named`允许您声明要通过自动扫描获取的 bean， `<context:component-scan/>`或者`@ComponentScan`它们为类注册 bean 定义，因此它们大致相当于用XML 中的`<bean ... />`标记。此 bean 类型将遵守标准代理创建策略。

`@Configuration`annotation 被设计为 XML 配置文件的替换。为了创建带`@Configuration`注释的 bean，Spring 将始终使用`CGLIB`子类化带`@Configuration`注释的类，覆盖其`@Bean`带注释的方法以将其替换为 bean 查找方法，以使单例 bean 仅创建一次。（Spring 不`CGLIB`用于拦截*普通Spring bean 的**内部*方法调用，而是创建一个单独的代理实例（与 JDK 代理相同）。这样做允许使用代理来避免基数不匹配 - 例如代理单例可以获取当前会话 bean，仅通过类继承是不可能的。）。尽管如此，带注释的类仍然可以使用带注释的（，*`@Configuration``@Autowired``@Inject`等）从容器中请求 bean（甚至还有其他`@Configuration`带注释的 bean）的字段和属性。*

 ***[来自文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-java)4.12.5 部分的**示例****

 **```
@Configuration
public class AppConfig {

  @Bean
  public ClientService clientService1() {
    ClientServiceImpl clientService = new ClientServiceImpl();
    clientService.setClientDao(clientDao());
    return clientService;
  }
  @Bean
  public ClientService clientService2() {
    ClientServiceImpl clientService = new ClientServiceImpl();
    clientService.setClientDao(clientDao());
    return clientService;
  }

  @Bean
  public ClientDao clientDao() {
    return new ClientDaoImpl();
  }
} 
```

在上面的示例中，只会创建一个`ClientDao`实例。

`@Autowired`是 Spring 注解，而`@Inject`是 JSR-330 注解。 `@Inject`等效于`@Autowired`or `@Autowired(required=true)`，但您无法`@Autowired(required=false)`使用 JSR-330`@Inject`注释获得行为。此注释始终使用按类型自动装配。

Spring 以一种相当特殊的方式实现[JSR-250](http://jcp.org/en/jsr/detail?id=250) `@Resource`注释。`@Resource`最初是为在 Java EE 中定位 JNDI 资源而设计的，但 Spring 扩大了它的适用性，使其可以连接到容器中的任何 bean（JNDI 资源在[SimpleJndiBeanFactory](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/jndi/support/SimpleJndiBeanFactory.html)的帮助下作为 bean 可用）。对应bean的名称可以指定为注解的`name`属性`@Resource`，如果没有指定名称，则使用被注解的字段或属性的名称。另一个奇怪的特性是，如果没有找到具有属性名称的 bean，spring 将回退到按类型布线。

**示例** 假设我们在容器中有一个`AlphaClass`名为*beanAlpha*的 bean和一个`BetaClass`bean *beanBeta*。

```
@Resource 
BetaClass something;  // Wires to beanBeta - by-type

@Resource 
BetaClass beanAlpha;  // Will throw exception, because "beanAlpha" is not BetaClass -> it's a bad idea to use @Resource as a replacement of @Autowired

@Resource 
Object beanAlpha;  //Wires to beanAlpha - by-name 
```

因此，在使用`@Resource`注释时始终明确指定资源名称是一个好习惯。

**文档**

[弹簧注解](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-java)

[Bean标准注解](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-standard-annotations)

***正如shevchik*所指出的，**更新**固定的 JSR 引用。DI 特定注解由 Google（Guice Framework）和 SpringSource（Spring Framework）工程师开发的 JSR-330 提供。`@Resource`是基于 JNDI 并由[JSR-250](http://jcp.org/en/jsr/detail?id=250)提供的。**

 *** * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-09-02T03:59:22.040

`@Component`等价于`<bean>`，
`@Configuration`等价于`<beans>`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-04T10:11:40.653

在上面的大多数答案中，用户建议说@Component 和@Configuration 用于不同的目的。但我没有看到它在现实中发生。

但我有一个简单的 Spring MVC 应用程序。

```
@Configuration
    public class SpringConfiguration {

@Bean
public  InternalResourceViewResolver initViewResolver(){
    InternalResourceViewResolver x = new InternalResourceViewResolver();
    x.setPrefix("/WEB-INF/jsp/");
    x.setSuffix(".jsp");
    return x;
}

} 
```

即使这个主类被注释为@Component 而不是@Configuration，它也能正常工作。

类似地，如果您有使用@Bean 注释的方法，则在注释为@Component 的类中，这些bean 是在加载上下文时创建的。

所以我认为，只是为了代码的可读性，我们应该将主配置类标记为@Configuration，其他类使用@Component。实际执行明智似乎没有区别。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-01T16:14:27.643

关于两者的区别`@Autowired`，你可以看[这里](http://blogs.sourceallies.com/2011/08/spring-injection-with-resource-and-autowired/)。在这里您可以进行详尽的描述和比较。`@Inject``@Resource`

与第一个区别有关的`@Configuration`是：用作`XML`基于 - 的配置的替代品，即。它将类标记为用于`Java`基于配置的类，请参见[此处](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-java)。反过来，`@Component`实际上用于将类标记为要实例化的类，`Spring`并由注释`@Configuration`进行元`@Component`注释。

`@Component`并`@Configuration`服务于不同的目的，因此比较它们没有意义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-02T08:31:18.477

1) 如果您想要 XML 配置，则忽略 @Configuration，因为这仅对基于 Java 的配置有用。XML 配置可能最适合不熟悉 Spring 的人，因为有更多示例可用。

@Component 注解的类在组件扫描期间被拾取。使用它们来标记您想要作为 Spring bean 公开的类。同样，您可以在 XML 配置中声明所有 bean 并完全忽略 @Component。

2) 如果您乐于将应用程序绑定到 Spring，请使用 @Autowire 而不是 javax 等效的 @Inject。我建议接受对 Spring 的依赖是最好的开始方式。*****

# android - [ViewFlipper 在动画中剪辑透明孩子

> ID：12229285
> 
> 赞同：2
> 
> 时间：2012-09-01T16:03:19.870
> 
> 标签：android, animation, view, clip

目前我面临着非常丑陋的问题。

我有几个半透明孩子的 ViewFlipper。ViewFlipper 的 In 和 Out 动画是这样制作的，以便这些孩子相互叠加（即它们的 alpha 值混合在一起）。孩子们被制作成半透明的，这样他们下面的背景就可以看到了，所以我不能为每个孩子设置背景。

问题是我现在确实希望那些孩子相交 - 稍后绘制的孩子应该被剪裁。基于这种需要，我重写了 ViewFlipper.drawChild 方法，并将动画变换矩阵应用于视图边界。接下来，我使用对先前计算的边界的补充来剪辑画布绘图区域。然而，无论我做什么，似乎仍然有一个小矩形覆盖。有什么办法可以解决吗？

我的代码如下：

```
public class ChartsTabsLayout extends ViewFlipper {
private Rect[] mDrawTMPParent;
private Rect mDrawTMPChild;
private Rect mDrawTMP;
private RectF mDrawTMPRectF;

public ChartsTabsLayout(final Context aContext) {
    super(aContext);
    initialize(aContext, null);
}

public ChartsTabsLayout(final Context aContext, final AttributeSet aAttributes) {
    super(aContext, aAttributes);
    initialize(aContext, aAttributes);
}

private void initialize(final Context aContext, final AttributeSet aAttributes) {
    mDrawTMPParent = new Rect[] { new Rect(), new Rect(), new Rect(), new Rect() };
    mDrawTMPChild = new Rect();
    mDrawTMP = new Rect();
    mDrawTMPRectF = new RectF();
}

@Override
protected void dispatchDraw(final Canvas aCanvas) {
    getDrawingRect(mDrawTMP);
    mDrawTMPParent[0].set(mDrawTMP);
    for(int i = 1; i < 4; i++) {
        mDrawTMPParent[i].setEmpty();
    }
    super.dispatchDraw(aCanvas);
}

private void countRectCompliment(final Rect aInside, final Rect aOutside, final Rect[] aOut) {
    for(int i = 0; i < 4; i++) {
        aOut[i].set(aOutside);
    }
    aOut[0].right = aInside.left;
    aOut[0].top = aInside.top;
    aOut[0].bottom = aInside.bottom;
    aOut[1].left = aInside.right;
    aOut[1].top = aInside.top;
    aOut[1].bottom = aInside.bottom;
    aOut[2].top = aInside.bottom;
    aOut[3].bottom = aInside.top;
    for(int i = 0; i < 4; i++) {
        if(aOut[i].left >= aOut[i].right || aOut[i].top >= aOut[i].bottom) {
            aOut[i].setEmpty();
        }
    }
}

@Override
protected boolean drawChild(final Canvas aCanvas, final View aChild, final long aDrawingTime) {
    final Transformation transformation = new Transformation();
    aChild.getDrawingRect(mDrawTMPChild);
    mDrawTMPRectF.set(mDrawTMPChild);

    final Animation animation = aChild.getAnimation();
    if(animation != null) {
        if(animation.willChangeTransformationMatrix()) {
            //if I change aDrawingTime to aDrawingTime-50 
            //animations seems to look ok, but it is "magic number" 
            //solution I would like to avoid by any means 
            animation.getTransformation(aDrawingTime, transformation); 
            transformation.getMatrix().mapRect(mDrawTMPRectF);
        }
    }
    mDrawTMPRectF.round(mDrawTMPChild);

    boolean ret = true;

    for(int i = 0; i < 4; i++) {
        if(!mDrawTMPParent[i].isEmpty()) {
            aCanvas.save();
            aCanvas.clipRect(mDrawTMPParent[i].left, mDrawTMPParent[i].top, mDrawTMPParent[i].right, mDrawTMPParent[i].bottom);
            ret |= super.drawChild(aCanvas, aChild, aDrawingTime);
            aCanvas.restore();
        }
    }
    countRectCompliment(mDrawTMPChild, mDrawTMPParent[0], mDrawTMPParent);
    return ret;
}
} 
```

# android - 如何保存配置布局android

> ID：12229288
> 
> 赞同：2
> 
> 时间：2012-09-01T16:04:03.097
> 
> 标签：android, android-layout

我有一个从 xml 文件加载主布局的应用程序。

**加载的布局是：**

带有 5 个按钮的**相对布局。**当用户单击按钮时，会出现一个菜单，他可以在其中选择一种视图类型。选择视图后，按钮将不可见并出现选择视图。

**重新启动**应用程序后，系统会加载默认布局（带有 5 个按钮的相对布局）。我希望在应用程序重新启动系统时加载最后选择的布局。

有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:20:26.050

您应该可以通过在 Android 中使用 Shared Preferences 来做到这一点：http: [//developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)

您可以存储一个布尔值来跟踪布局的状态（无论是具有 5 个按钮的相对布局，还是具有 4 个按钮的视图选择状态）。这样当你加载activity时，你可以先检查这个标志来决定你要加载哪个布局。您还可以使用首选项，这样您就不需要初始化此标志变量，而是可以使用默认值。

```
public class MyActivity extends Activity {
    public static final String PREFS_NAME = "MyPrefsFile";
    public enum ViewState {
        NO_CLICK, VIEW_A, VIEW_B, ...
    };

    @Override
    protected void onCreate(Bundle state){
       super.onCreate(state);
       . . .

       // Restore preferences
       SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
       int currentView = settings.getInt("viewClicked", NO_CLICK);

       switch(currentView)
       {
           case VIEW_A: // Load the view if button A was clicked
               loadViewA();
               break;
           case VIEW_B: // Load the view if button B was clicked
               loadViewB();
               break;
           ...
           case NO_CLICK: // Load the RelativeLayout with 5 Buttons
           default:
               loadDefaultView();
               break;
       }
    } 
```

在按钮 A 的 OnClickListener 中：

```
public void onClick(View v) {

  ...

  // Get the settings
  SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
  SharedPreferences.Editor editor = settings.edit();
  editor.putInt("viewClicked", VIEW_A);

  // Commit the edits!
  editor.commit();

  // Load the view
  loadViewA();
} 
```

其他按钮的其他 onClick() 方法可以类似地实现。

**编辑：**更新为使用整数而不是布尔值

# c++ - std::vector 的容量是如何确定的

> ID：12229290
> 
> 赞同：3
> 
> 时间：2012-09-01T16:04:20.697
> 
> 标签：c++, stdvector

我知道在 std::vector 中，每次空间用完时大小都会增加。然而，我没有注意到它的增长模式。有人可以向我解释一下这种模式以及为什么选择它。

```
#include <iostream>
using namespace std;

#include <iostream>
#include <vector>
int main()
{
    vector<int> myVector;
    for(int i =0 ; i < 100; ++i)
    {
        myVector.push_back(i);
        cout << myVector.capacity();
    cout << ", ";
    }
} 
```

结果：

```
1, 2, 3, 4, 6, 6, 9, 9, 9, 13, 13, 13, 13, 19, 19, 19, 19, 19, 19, 28, 28, 28, 2
8, 28, 28, 28, 28, 28, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 6
3, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 6
3, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 9
4, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 141, 141, 141, 141, 141, 141 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:06:58.930

这取决于实现，因此在切换操作系统、编译器等时不要期望相同的模式。

最常见的增长模式是`1.5 * previous_capacity`和`2 * previous_capacity`。在您的示例中，似乎是前者。

有关为什么选择该因素的可能解释，请参阅[https://stackoverflow.com/a/1100426/784668 。](https://stackoverflow.com/a/1100426/784668)关键是它显然允许重用以前用于存储数组的空闲内存块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:08:16.637

这是一个实现细节，你不应该关心它。在您的情况下，它似乎类似于

```
i += i/2 
```

但更复杂一些。

# php - 无法使用索引器获取 PHP 表单值

> ID：12229292
> 
> 赞同：1
> 
> 时间：2012-09-01T16:04:23.200
> 
> 标签：php

这让我发疯了，因为我收到了一个表单帖子，其中包含一个名称-值对，如下所示：

```
&transaction[0].id=5TH49195SG993903B 
```

在我的 php 接收器文件中，我试图这样获取值：

```
$txnid =  $_POST["transaction[0].id"]; 
```

然而它每次都是空白的。这是来自贝宝 IPN 传输。我没有为贝宝标记这个问题，因为我认为它与贝宝无关。我可以登录贝宝并查看他们所说的表单帖子，因此显然他们正在发送该表单（以及许多其他值）。

我犯了某种愚蠢的错误吗？我认为这与 [0] 索引器有关，因为当它们没有索引器时，我可以在同一个 POST 中成功获取其他表单值。如：

```
$buyer_email =  $_POST["sender_email"]; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:09:16.897

如果你尝试`var_dump($_POST)`，你会得到这样的输出：

```
array(1) { ["transaction"]=> array(1) { [0]=> string(17) "5TH49195SG993903B" } } 
```

因此，为了捕获该参数，您需要使用`$_POST['transaction'][0];`

# python - 将站点地址 http://127.0.0.1:8000/ 更改为 http://www.google.com

> ID：12229296
> 
> 赞同：0
> 
> 时间：2012-09-01T16:05:17.310
> 
> 标签：python, django, django-1.3

如何将默认地址更改为`http://127.0.0.1:8000/`有用的东西，例如正确的站点名称。

我正在使用 Django 附带的开发服务器。

我用谷歌搜索了大约 1 小时，但找不到合适的解决方案。我是初学者，所以请帮帮我。

我怎样才能在我的本地机器上使用主机名而不是环回地址？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T16:14:09.737

更改您的[主机文件](http://en.wikipedia.org/wiki/Hosts_%28file%29)添加如下条目：

```
127.0.0.1 www.google.com 
```

此时，无论何时尝试`www.google.com`，您都会重定向到您自己的机器。

您可能仍需要使用相同的端口，因此将端口更改为端口`80`（http 流量的默认值）将意味着 URL 不需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:49:00.330

[DNS](http://en.wikipedia.org/wiki/Domain_Name_System)是你的朋友……
或者 /etc/hosts……

# c# - WebApi Controller 找不到控制器的操作

> ID：12229297
> 
> 赞同：11
> 
> 时间：2012-09-01T16:05:24.953
> 
> 标签：c#, asp.net, asp.net-mvc-3

这是一个真正令人头疼的问题。我创建了两个用作 JSON 网络服务的 ApiController：-

```
namespace ControlTower.Controllers
{
    public class AirlinesController : ApiController
    {
        private static IEnumerable<Airline> MapAirlines()
        {
            return (Jetstream.AirlineObject.GetAirlines()).Select(x => x);
        }

        [HttpGet]
        public IEnumerable<Airline> GetAirlines()
        {
            return MapAirlines().AsEnumerable();
        }

        [HttpGet]
        public Airline GetAirlineByCode(string code)
        {
            return Jetstream.AirlineObject.GetAirline(code);
        }
    }
} 
```

和：-

```
namespace ControlTower.Controllers
{
    public class ReviewsController : ApiController
    {
        private static IEnumerable<Review> MapReviews(int airline)
        {
            return (Jetstream.ReviewObject.GetReviews(airline)).Select(x => x);
        }

        [HttpGet]
        public IEnumerable<Review> GetReviews(int airline)
        {
            return MapReviews(airline).AsEnumerable();
        }

        [HttpGet]
        public Review GetReviewById(int review)
        {
            return Jetstream.ReviewObject.GetReview(review);
        }
    }
} 
```

使用此路由：-

```
config.Routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/get/{code}",
                defaults: new { code = RouteParameter.Optional }
            ); 
```

在访问`/api/airline/get/ba`或`/api/airline/get/`完美运行的同时，访问**Review**的任何变体都不会。谁能看到我在这里遗漏的任何明显的东西？

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-09T02:06:47.197

您的默认路由需要一个名为“code”的参数。您要么需要添加一条路线以接受名为航空公司和/或审查的参数，要么明确告诉控制器参数的名称。

前任。/api/reviews/get?airline=1

# java - 使用 Tomcat 保存作品，码头给了我一个 java.lang.NoSuchMethodError for Persistence.getPersistenceUtil()

> ID：12229299
> 
> 赞同：0
> 
> 时间：2012-09-01T16:05:53.110
> 
> 标签：java, spring, tomcat, jetty

我正在运行一个使用休眠的 spring mvc 应用程序。

当我保存表单时，它在 Tomcat 7 中运行良好。

当我使用 jetty 的嵌入式实例运行相同时，我收到此错误：

访问 /users/update 时出现问题。原因：

```
 javax.persistence.Persistence.getPersistenceUtil()Ljavax/persistence/PersistenceUtil;
Caused by:

java.lang.NoSuchMethodError: javax.persistence.Persistence.getPersistenceUtil()Ljavax/persistence/PersistenceUtil;
    at org.hibernate.validator.engine.resolver.JPATraversableResolver.isReachable(JPATraversableResolver.java:33)
    at org.hibernate.validator.engine.resolver.DefaultTraversableResolver.isReachable(DefaultTraversableResolver.java:112)
    at org.hibernate.validator.engine.resolver.SingleThreadCachedTraversableResolver.isReachable(SingleThreadCachedTraversableResolver.java:47)
    at org.hibernate.validator.engine.ValidatorImpl.isValidationRequired(ValidatorImpl.java:764)
    at org.hibernate.validator.engine.ValidatorImpl.validateConstraint(ValidatorImpl.java:331)
    at org.hibernate.validator.engine.ValidatorImpl.validateConstraintsForRedefinedDefaultGroup(ValidatorImpl.java:278)
    at org.hibernate.validator.engine.ValidatorImpl.validateConstraintsForCurrentGroup(ValidatorImpl.java:260)
    at org.hibernate.validator.engine.ValidatorImpl.validateInContext(ValidatorImpl.java:213)
    at org.hibernate.validator.engine.ValidatorImpl.validate(ValidatorImpl.java:119)
    at org.springframework.validation.beanvalidation.SpringValidatorAdapter.validate(SpringValidatorAdapter.java:101)
    at org.springframework.validation.DataBinder.validate(DataBinder.java:722)
    at org.springframework.web.method.annotation.ModelAttributeMethodProcessor.validateIfApplicable(ModelAttributeMethodProcessor.java:154)
    at org.springframework.web.method.annotation.ModelAttributeMethodProcessor.resolveArgument(ModelAttributeMethodProcessor.java:107)
    at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:74)
    at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:155)
    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:117)
    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:900)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:565)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1031)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:406)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:965)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
    at org.eclipse.jetty.server.Server.handle(Server.java:349)
    at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:452)
    at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:894)
    at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:948)
    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:857)
    at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)
    at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:77)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:609)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:45)
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599)
    at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534)
    at java.lang.Thread.run(Thread.java:680) 
```

我正在使用以下版本的库（使用 Maven）：

```
java: 1.6
spring 3.1.0.RELEASE
Hibernate: 4.1.1.Final 
```

# java - 创建独立的jar文件

> ID：12229300
> 
> 赞同：4
> 
> 时间：2012-09-01T16:06:01.083
> 
> 标签：java, swing, deployment, installation, executable-jar

我已经`jar`使用 Netbeans 构建了一个文件，它在我的系统中运行良好。但是我想制作`jar`能够在所有具有 JRE 的系统中运行的文件，即使`classpath`没有在该系统中设置它也应该可以正常工作。

```
package circle;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Circle {

    public static void main(String[] args) {

        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new Circle().createAndShowGUI(); 
            }
        });
    }

    private void createAndShowGUI() {
        JFrame f = new JFrame("Swing Paint Demo");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        f.add(new MyPanel());
        f.pack();
        f.setVisible(true);

    }

    class MyPanel extends JPanel {

        public MyPanel() {

        setBorder(BorderFactory.createLineBorder(Color.black));

        addMouseListener(new MouseAdapter() {
            public void mousePressed(MouseEvent e) {
               startX=e.getX();
               startY=e.getY();
            }
        });

        addMouseMotionListener(new MouseAdapter() {
            public void mouseDragged(MouseEvent e) {
               X=e.getX();
               Y=e.getY();
               repaint();
            }
        });

    }

        public Dimension getPreferredSize() {
        return new Dimension(250,200);
    }

    protected void paintComponent(Graphics g) {
        super.paintComponent(g);       
        //g.setColor(Color.RED);
        //g.fillRect(squareX,squareY,squareW,squareH);
        g.setColor(Color.BLACK);
        g.drawOval(startX,startY,X-startX,Y-startY);
        g.fillOval(startX,startY,X-startX,Y-startY);
    }  

    }

        private int startX,startY,X,Y;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:11:35.717

您可以使用`ant`脚本来构建可运行的 JAR。

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jar" name="Create Runnable Jar for Project SimpleApp with libraries in sub-folder">
    <!--ANT 1.7 is required -->
    <target name="create_run_jar">
        <jar destfile="C:/Workspaces/SimpleApp/SimpleApp.jar">
            <manifest>
                <attribute name="Main-Class" value="SimpleApp"/>
                <attribute name="Class-Path" value=". SimpleApp_lib/lib1.jar SimpleApp_lib/lib2.jar"/>
            </manifest>
            <fileset dir="C:/Workspaces/SimpleApp/bin"/>
        </jar>
        <delete dir="C:/Workspaces/SimpleApp/SimpleApp_lib"/>
        <mkdir dir="C:/Workspaces/SimpleApp/SimpleApp_lib"/>
        <copy file="C:/path/to/lib/lib1.jar" todir="C:/Workspaces/SimpleApp/SimpleApp_lib"/>
        <copy file="C:/path/to/lib/lib2.jar" todir="C:/Workspaces/SimpleApp/SimpleApp_lib"/>
    </target>
</project> 
```

在这个例子中，项目`SimpleApp`依赖于两个库：`lib1.jar`和`lib2.jar`，它们被输出到`bin`具有`MANIFEST.MF`指定属性的 a 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T01:13:05.067

以下帖子简要说明了如何使用 ANT创建[可执行 jar ：](http://www.ibm.com/developerworks/library/j-jar/)

*   [使用 Ant 在新的 jar 文件构建中包含外部 jar 文件](https://stackoverflow.com/questions/3770071/including-external-jar-files-in-a-new-jar-file-build-with-ant/3772029#3772029)

这篇文章解释了[manifestclasspath](http://ant.apache.org/manual/Tasks/manifestclasspath.html)任务如何帮助创建类路径清单条目（使可执行 jar 的构建更加健壮且不易出错）：

*   [Ant - 如何在特定文件夹中获取所有文件的名称](https://stackoverflow.com/questions/3796824/ant-how-to-get-all-files-name-in-a-specific-folder/3797767#3797767)

最后一个更复杂的示例演示了在创建可执行 jar 时使用[ivy来管理项目的第 3 方依赖项：](http://ant.apache.org/ivy/)

*   [从默认模板 ant 生成类路径时出错](https://stackoverflow.com/questions/11457392/error-in-classpath-generation-from-default-template-ant/11459634#11459634)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T16:20:49.103

只需执行以下命令即可创建 JAR 文件：

```
jar -c excel.jar MANIFEST.MF *.class 
```

MANIFEST.MF 文件应包含以下行：

```
Main-Class: createExcel 
```

但也要考虑以下提示：

有几种方法：

1.  创建一个 jar 文件并将您的类（没有依赖项）放在那里。使用一些工具（任何 IDE 都有）来执行此操作并使用 main 函数指定类。您也可以从命令行手动执行此操作。当用户想要运行它时，他应该指定类路径并且所有依赖项都应该在该类路径中。

2.  创建相同的 jar 并创建 .bat 或 .sh 文件，在其中设置类路径并运行您的 jar。

3.  使用一些特殊工具创建跨平台安装程序（但好的工具不是免费的）。

请记住，Netbeans 可以为您提供很多帮助；）

# c++ - c++ 指向另一个类错误的指针“没有运算符匹配这些操作数”。

> ID：12229302
> 
> 赞同：0
> 
> 时间：2012-09-01T16:06:07.497
> 
> 标签：c++, compiler-errors, operators

编辑*我很笨...感谢您帮助我解决了这个问题。* 在我的**汽车**类中，下面的代码不断在 << 运算符上给我一个错误

```
cout << "Driver: " << driver->print(); 
cout << "Owner: " << owner->print(); 
```

错误提示“没有运算符与这些操作数匹配”。这是我的家庭作业，所以我确实需要从驱动程序中以某种方式调用打印功能。在主要功能中，我实际上还没有设置驱动程序或所有者，但我认为这无关紧要。提前致谢。

```
#include <iostream>
#include <string>
#include <vector>

using namespace std;

class Person
{
public:
Person(string _name,int _age)
{
    _name = name;
    _age = age;
    cout << "Name: " << name << endl;
    cout << "Age: " << age << endl;
}
string getName()
{
    return name;
}
int getAge()
{
    return age;
}
int incrementAge()
{
    age +=1;
    return age;
}
void print()
{
    cout << "Name: " << name << endl;
    cout << "Age: " << age << endl;

}

private:
string name;
int age;

};

class Car
{
public:
Car (string m)
{
    model = m;
}
void setDriver(Person *d)
{
    *driver = *d;
}
void setOwner(Person *o)
{
    *owner = *o;
}
void print()
{
    cout << "Model: " << model << endl;
    cout << "Driver: " << driver->print();
    cout << "Owner: " << owner->print();
}

private:

string model;
Person *owner;
Person *driver;

};

int main()
{
vector<Person*>people;
vector<Car*>cars;
string name = "";
int age = 0;
string model = 0;
int sentValue = 0;
while (sentValue != -1)
{
    cout << "Enter name: ";
    cin >> name;
    cout << "Enter age: ";
    cin >> age;

    people.push_back(new Person(name, age));
    cout << "Enter car model: ";
    cin >> model;
            cars.push_back(new Car(model));
    cout << "Press -1 to stop, or 1 to enter info for others: ";
    cin >> sentValue;
}

//display car model, 
//owner’s name and age,
//and driver’s name and age.

system("pause");
return 0;
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:15:09.053

执行此操作的 C++ 方法是为和实现`std::ostream&<<`运算符。例如，`Person``Car`

```
#include <iostream>

std::ostream& operator<<(std::ostream& o, const Person& p) {
  return o << "Name: " << p.getName() << " Age: " << p.getAge();
} 
```

然后像这样使用：

```
Person p("Bob", 23);
std::cout << p << "\n"; 
```

顺便说一句，我认为您真的不需要代码中的所有这些指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:08:14.940

您的 print() 函数已经将输出发送到`cout`，因此无需再次尝试将其发送到那里。代替

```
cout << "Driver: " << driver->print(); 
```

你可能想要

```
cout << "Driver:" << endl;
driver->print(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T16:25:16.300

成员函数`print`返回`void`。您不能将 a`void`插入流中。如果您更改打印函数以获取流引用并添加调用 print 的重载运算符，您可以将对象本身插入流中；那会更惯用。

```
template <class Elem, class Traits>
void Car::print(std::ostream<Elem, Traits>& out) {
    out << "Model: " << model << '\n';
    out << "Driver: " << *driver;
    out << "Owner: " << *owner;
}

template <class Elem, class Traits>
std::ostream<Elem, Traits>& out, const Car& car) {
    return out << car;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T16:08:16.373

```
cout << "Driver: " << driver->print(); 
```

您`<<`正在等待适当的对象进行处理。那是你的问题。与其实现 ，不如`print()`通过实现来重载运算符，`operator<<(std::ostream&, const Person&);`然后让 C++ 完成其余的工作。然后你可以这样打印：

```
 cout << "Driver: " << driver; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T16:55:20.853

```
const std::string& Person::print() const
{
    return "Name " + name + "\n" + "Age " + age + "\n";    
} 
```

# java - 寻找基于无 cron 的 Java 调度程序

> ID：12229307
> 
> 赞同：0
> 
> 时间：2012-09-01T16:06:23.750
> 
> 标签：java, scheduler, jobs

我正在寻找一个 Java 调度框架，它不是计时器驱动的，也不是像 Quartz 和其他任何类型的 cron 风格的调度器。这里有很多问题和答案都解决了计时器驱动的调度程序，但是这样的调度程序并不能解决我的问题。

我遇到的问题是我有几个线程，每个线程都从分配给它的阻塞队列中获取消息。当阻塞队列为空时，从它读取的线程被阻塞并且不能分配给其他线程。这样我的系统可能会遇到一些饥饿问题。因此，JDK5 线程池不适合，因为它们只能将未被阻塞的空闲线程分配给另一个需要服务的队列。

我在 Internet 上发现 hawt dispatch 这正是我所需要的，但它的高级功能（如期货）让我感觉更舒服，只有在使用 Scala API 时才可用。有人知道一些类似于 hawt dispatch 的 Java 框架吗？任何提示都非常赞赏。

问候，奥利弗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:28:21.270

老实说，我不知道有任何框架在做你所描述的事情，但我宁愿更改线程的实现以不阻塞队列。

即使队列实现了[`BlockingQueue`接口](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)，仍然可以使用[method以](http://docs.oracle.com/javase/6/docs/api/java/util/Queue.html#peek%28%29)*非阻塞*方式检查它们。[`Queue#peek()`](http://docs.oracle.com/javase/6/docs/api/java/util/Queue.html#peek%28%29)

# database - SPOOL objects_log.log PROMPT SCRIPT: //.sql @.sql

> ID：12229314
> 
> 赞同：-2
> 
> 时间：2012-09-01T16:07:33.297
> 
> 标签：database, oracle, shell, sqlplus

我正在审查一些代码。它包含一个 .sql 文件，其中包含此

```
****SPOOL install_cg_objects_log.log
PROMPT SCRIPT: /cg/synonyms/cretate_synonyms_for_cg.sql
@cg/sy/cretate_synonyms_for_cg.sql
PROMPT SCRIPT: /cg/packages/in.sql
@cg/packages/in.sql
PROMPT SCRIPT:/cg/triggers/tr.sql
@cg/triggers/trg.sql
SPOOL OFF**** 
```

谁能解释一下这个脚本在做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:25:23.460

您拥有的该`*.sql`文件打算在`sqlplus`（oracle 命令行实用程序）中执行

1.  **SPOOL**将查询结果存储在指定的文件中 - 创建排序的日志文件。
2.  **PROMPT**`sqlplus`在环境中显示消息
3.  **@**执行存储在文件中的脚本（例如`@/somepath/scriptfile.sql`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-12T16:55:48.130

我不知道 **** 在这里是什么意思，只是假装你在这里使用它来明确代码的开始和结束。因此，让我们详细说明您的代码。

**SPOOL filename.log** --To 将查询结果存储在您在空格后指定的文件中。

**PROMPT "Some message"** --To 表示要在执行时显示的运行时文本消息。

**@** --这里这个符号用于从给定路径的 SQL> 提示符中执行 .sql，就像你从 main.sql 文件调用多个 .sql 文件一样。

**.sql** -- 它是一个脚本，包含一组多个 DML、DDL、DCL 语句和其他 Oracle 对象定义。

```
[oracle@OLE1 Desktop]$ vi yourmainfile.sql 
SPOOL install_cg_objects_log.log
PROMPT SCRIPT: /cg/synonyms/cretate_synonyms_for_cg.sql
select 'test' from dual;
PROMPT SCRIPT: /cg/packages/in.sql
select sysdate from dual;
PROMPT SCRIPT:/cg/triggers/tr.sql
select * from dual;
--@/cg/triggers/tr.sql
SPOOL OFF

[oracle@OLE1 Desktop]$ 
[oracle@OLE1 Desktop]$ sqlplus -s scott/tiger
@yourmainfile.sql
SCRIPT: /cg/synonyms/cretate_synonyms_for_cg.sql

'TES
----
test

SCRIPT: /cg/packages/in.sql

SYSDATE
---------
12-JUL-17

SCRIPT:/cg/triggers/tr.sql

D
-
X

exit
[oracle@OLE1 Desktop]$ 
```

# sharepoint-2010 - 将工作流添加到 SharePoint 2010 以删除早于特定时期的页面

> ID：12229322
> 
> 赞同：0
> 
> 时间：2012-09-01T16:08:18.990
> 
> 标签：sharepoint-2010

我正在创建一个 SharePoint 2010 网站。我想为 wiki 库内容创建一个工作流程，如果内容超过特定时期（例如任何 6 个月大的页面），则内容会自动删除。另外，在删除之前，我想向一个群组发送一封电子邮件，告知某某项目将自动删除。

怎么能做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:37:29.933

这可以使用 SharePoint 2010 开箱即用地完成。如果您转到“信息管理策略设置”，您可以在 wiki 页面内容类型上设置或在库级别覆盖，这将让您做您想做的事。

您可以设置不同的保留阶段。所以你可以让它在不同的阶段启动不同的动作。以下操作可用于您创建的阶段。

*   移动到回收站
*   永久删除
*   转移到另一个位置（不适用于页面）
*   启动工作流程
*   跳到下一阶段
*   申报记录
*   删除以前的草稿
*   删除所有以前的版本

[更多信息请点击这里](http://office.microsoft.com/en-us/sharepoint-server-help/create-and-apply-information-management-policies-HA101631505.aspx)

# javascript - Javascript 有像 FindControlRecursive 这样的功能吗？

> ID：12229324
> 
> 赞同：0
> 
> 时间：2012-09-01T16:08:30.330
> 
> 标签：javascript, asp.net

ListView 的每一行都有一个复选框。当用户单击**Delete Selected row(s)** LinkBut​​ton 时，仅删除选中复选框的行。我正在考虑首先获取数组中的所有复选框，然后循环查看哪个复选框被选中。

这是我尝试过的。

```
 function CheckBoxBeforeDeleteing() {
        var lv = document.getElementById("MainContent_ListView1");
        //var inputs = lv.childNodes;
        //alert(inputs.Length);
        alert("Test");
    } 
```

如果我不注释掉这两行，则该函数甚至不会执行。看来我需要更深入了。Javascript 是否具有类似于 C# 的**FindControlRecursive**的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T16:16:26.663

您可以使用 javascript 中的循环遍历表单中的元素，如下所示。假设您`form1`在页面中有`runat="server"`然后获取表单并使用循环遍历其控件并在表单中找到复选框。

```
var elem = document.getElementById('<%= form1.ClientID %>').elements;

function CheckBoxBeforeDeleteing() 
{
    for(var i = 0; i < elem.length; i++)
    {
          if(elem[i].id.indexOf('chkBoxId') != -1)
          {
               if(elem[i].checked)
               {
                     //Your code here
               }
          }   
    }
} 
```

**使用索引访问表单**

```
function CheckBoxBeforeDeleteing() 
{
    for(i=0;i<document.forms[0].length;i++)
    {
          e=document.forms[0].elements[i];
          if (e.id.indexOf("chkBoxId") != -1 )
          {
           if(e.checked)
               {    
              //Your code goes here     
               }        
          } 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:20:43.523

就在这里。

```
var inputs = lv.getElementsByTagName("INPUT"); 
```

# ios - 点击并按住图像时向上滚动的视图的名称是什么？苹果手机

> ID：12229327
> 
> 赞同：-1
> 
> 时间：2012-09-01T16:08:51.833
> 
> 标签：ios, cocoa-touch, user-interface

在我的 iPhone 应用程序上，我允许用户编辑他们的个人资料图片。当他们按下编辑按钮时，我希望他们可以选择拍照或获取现有图像。我的问题不是“我该怎么做”我敢肯定还有其他问题。我知道我想怎么做。我想要一个小视图向上滚动大约一半的屏幕，让用户从那里的两个选项中进行选择。当您点击并按住图像并且视图向上滚动时，我希望它看起来类似于 iPhone 上的视图。我会附上一张图片。

所以我的问题是，我可以使用一些已经存在的功能来使用相同的向上滚动视图吗？还是我必须自己建造？如果它存在，它的名称是什么，所以我可以在 SO 上的某个地方找到它？![我希望我的应用程序执行此操作，我可以重用现有功能来实现此功能吗？](../Images/a10ce131575113fd3aca9ef8dafb23dc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:10:58.317

这是一个`UIActionSheet`。有关文档，请参见[此处](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIActionSheet_Class/)。

# opengl - 使用 glutBitmapCharacters 绘制更大的文本

> ID：12229329
> 
> 赞同：1
> 
> 时间：2012-09-01T16:09:08.060
> 
> 标签：opengl, text, drawing, glut

我设法使用 glutBitmapCharacters 在 opengl 中绘制文本。现在我想画一个标题，但它必须有更大的尺寸。我怎么做？这是我的drawtext函数的代码：

```
 void drawText(const char *text,int length , int x , int y)
 {
   glMatrixMode(GL_PROJECTION);
   double *matrix = new double[16];
   glGetDoublev(GL_PROJECTION_MATRIX,matrix);
   glLoadIdentity();
   glOrtho(0,800,0,600,-5,5);
   glMatrixMode(GL_MODELVIEW);
   glLoadIdentity();
   glPushMatrix();
   glLoadIdentity();
   glRasterPos2i(x,y);
   for ( int i = 0 ; i < length ; i++)
       glutBitmapCharacter(GLUT_BITMAP_9_BY_15,(int)text[i]);
   delete matrix;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T07:22:41.643

`glutBitmapCharacter``glBitmap`在引擎盖下使用。所以你*不能*改变文字大小；它将是文本的确切像素大小。

如果你想改变文字的大小，你需要使用“Stroke”字符功能（如`glutStrokeCharacter`）。这些绘制实际的三角形等，可以通过矩阵缩放操作（`glScale`）调整谁的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T07:31:00.350

作为@NicolBolas 答案的补充，您*始终*可以缩放原始位图数据（就像成像程序，例如 Photoshop 一样），尽管结果（尤其是关于字体）可能并不总是令人满意。不过，按自然数缩放将始终是像素完美的。

要使用这种缩放，您需要将字体渲染为纹理。然后，您可以将它们作为纹理四边形渲染到屏幕上，并使用内置的 OpenGL 缩放。

请注意，我**不**推荐这种方法。如果您需要更复杂的功能，也许更大、功能更强大的库（如`freetype-gl`）将是合适的。

# c# - 在 Visual Studio 2010 中，在单行 c# 代码中搜索两个字符串

> ID：12229330
> 
> 赞同：10
> 
> 时间：2012-09-01T16:09:15.267
> 
> 标签：c#, .net, visual-studio-2010, visual-studio, search

我正在使用带有 c# 的 Visual Studio 2010。我需要搜索我的代码库以查找在单行代码中找到两个字符串的所有代码行（代码行可以跨越 c# 允许的多行）。两个字符串没有连接，我不知道它们之间会是什么。我只想找到它在代码行中找到两个字符串的所有事件。有没有办法做到这一点？Visual Studio 之外是否有其他工具可以进行这种类型的搜索？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-01T16:12:41.627

您可以使用[正则表达式在 Visual Studio 中搜索文件](http://msdn.microsoft.com/en-us/library/dechx2tz)- 无需为此使用外部工具（当然，`grep`如果您愿意，也可以使用）。

请参阅[在 Visual Studio 中使用正则表达式](http://msdn.microsoft.com/en-us/library/2k3te2cs.aspx)- 语法有点深奥，因为它不符合当前使用的大多数正则表达式方言（它肯定不同于 .NET 方言）。

就像是：

```
string1.+string2 
```

应该管用。如果你需要这个顺序，请尝试：

```
string1.+string2|string2.+string1 
```

# c# - 如何从 C# 执行使用远程处理的 PS 脚本

> ID：12229332
> 
> 赞同：1
> 
> 时间：2012-09-01T16:09:28.933
> 
> 标签：c#, powershell, powershell-2.0, powershell-remoting

我有一系列功能齐全的 powershell 脚本，这些脚本利用了我希望能够从 C# WinForm 调用的远程处理。这是我到目前为止的代码

```
 private void button1_Click(object sender, EventArgs e)
    {
        _runspace = RunspaceFactory.CreateRunspace();
        _runspace.Open();
        _ps = PowerShell.Create();

        _ps.Runspace = _runspace;

        var output = new PSDataCollection<PSObject>();
        output.DataAdded += DataAdded;

        _ps.AddScript(@"C:\projects\Acme\trunk\PowerShell\deploy-qa-p5.ps1");
        _invokeResult = _ps.BeginInvoke<PSObject, PSObject>(null, output);

    } 
```

当我运行此代码时，我看到脚本中任何旨在针对远程会话执行的 powershell 命令实际上都在我的本地 PC 上执行。

例如，当直接从 Powershell.exe 执行这段代码时，会从远程服务器上卸载应用程序。从上面的 C# 代码运行时，相同的代码会**在我的本地计算机上**卸载所述应用程序：

`Invoke-Command -Session $remoteSession -scriptblock $uninstallScript -ArgumentList $applicationGuid`

同样，我的 C# 代码中引用的完全相同的 PS 脚本，当直接从 powershell.exe 执行时，对远程服务器按预期工作。

通过谷歌搜索，我发现了如何从 C# 创建远程运行空间。但是，这将需要我大量重构我的 PS 脚本以提取任何远程处理代码，这些代码将移至 C#。由于我仍然需要能够以独立模式（即直接从 powershell.exe）运行我的 PS 脚本，因此这不是一个可行的解决方案。

任何人都可以提出一个不需要重新调整我的 PS 脚本的解决方案吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-03T16:44:24.047

创建`Runspace`对象时，需要向它传递一个`WSManConnectionInfo`对象以创建远程运行空间。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/ee706560%28v=vs.85%29.aspx)详细介绍了如何执行此操作。与本主题中的示例不同，请确保您使用 WSManConnectionInfo 构造函数，该构造函数接受允许您指定远程端点的参数，例如

```
_runspace = RunspaceFactory.CreateRunspace("http://ComputerName:5985/wsman"); 
```

对不起，我误读了这个问题。调用恰好执行远程处理的脚本应该与从 PowerShell 控制台调用时一样有效。以下稍作修改的版本在我的家庭工作组中对我来说很好：

```
private void button1_Click(object sender, EventArgs e)
{
    _runspace = RunspaceFactory.CreateRunspace();
    _runspace.Open();
    _ps = PowerShell.Create();

    _ps.Runspace = _runspace;

    var output = new PSDataCollection<PSObject>();
    //output.DataAdded += DataAdded;

    var netCreds = new System.Net.NetworkCredential("Keith", Settings.Default.Password);
    var creds = new PSCredential(netCreds.UserName, netCreds.SecurePassword);

    _ps.AddScript("param($creds) Invoke-Command -cn Kids-PC -Scriptblock {hostname} -Credential $creds").AddArgument(creds);
    _invokeResult = _ps.BeginInvoke<PSObject, PSObject>(null, output);
    _invokeResult.AsyncWaitHandle.WaitOne();
    _ps.EndInvoke(_invokeResult);
    textBox1.Text = output[0].ToString();
} 
```

顺便说一句，不确定为什么要添加`DataAdded`到脚本的输出集合中？我把它注释掉了。由于我在工作组而不是域中，因此我还必须传递凭据。

为了调试它，当它失败时，请查看调试器中的 _ps.Streams.Error 对象。滚动到底部并打开`Results View`.

# c++ - 如何在带有 L （或不带）的变量中传递 unicode 字符串

> ID：12229333
> 
> 赞同：2
> 
> 时间：2012-09-01T16:09:39.473
> 
> 标签：c++, c, string, unicode

我有

```
MessageBoxW(hwnd, L"Καλημέρα", L"Τέστ", MB_OK|MB_APPLMODAL); 
```

那行得通，但是现在我如何传递变量“消息”和“标题”中的值？我不能再使用 L 因为它是一个变量，

```
MessageBoxW(hwnd, Lmessage, Lcaption, MB_OK|MB_APPLMODAL); //doesn't work 
```

有L（消息）还是什么？消息和标题是 WCHAR。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:23:36.483

如果您的变量是 type `WCHAR*`，它们自然是长字符串格式。

您可以按`MessageBoxW`原样传递它们。

```
MessageBoxW(hwnd, message, caption, MB_OK|MB_APPLMODAL); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:38:42.977

工作示例：

```
#define WIN32_LEAN_AND_MEAN
#include <windows.h>
#include <string>

int main()
{
    std::wstring message = L"Καλημέρα";
    std::wstring header = L"Τέστ";
    MessageBoxW(NULL, message.c_str(), header.c_str(), MB_OK);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T16:14:10.907

```
std::wstring s1 = L"Καλημέρα";
std::wstring s2 = L"Τέστ";
MessageBoxW(hwnd, s1, s2, MB_OK|MB_APPLMODAL); 
```

要获得等效的 C 字符串：

```
usual_c_string=s1.c_str(); 
```

[字符串类型之间有各种转换。](http://msdn.microsoft.com/en-us/library/ms235631%28v=vs.80%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T16:55:59.753

更好的：

```
MessageBoxW(hwnd, boost::widen(message).c_str(), boost::widen(caption).c_str(), MB_OK|MB_APPLMODAL); 
```

有关这背后的解释，请参见 utf8everywhere.org。另外：我会避免在 MSVC 上使用非 ascii 字符串文字。如果源文件以不同的编码保存，此代码的结果可能会发生变化。

# c# - 如何测试表达式是否相等

> ID：12229338
> 
> 赞同：1
> 
> 时间：2012-09-01T16:11:02.903
> 
> 标签：c#, lambda, expression

> **可能重复：**
> [测试 lambda 表达式相等性的最有效方法](https://stackoverflow.com/questions/283537/most-efficient-way-to-test-equality-of-lambda-expressions)
> [如何检查两个 Expression<Func<T, bool>> 是否相同](https://stackoverflow.com/questions/673205/how-to-check-if-two-expressionfunct-bool-are-the-same)

如何像这个示例一样测试两个表达式是否相同

```
 string firstname = "Ahmed";
        Expression<Func<string, bool>> exp1 = (s) => s.Contains(firstname);
        Expression<Func<string, bool>> exp2 = (s) => s.Contains(firstname);

        Console.WriteLine(exp1 == exp2);//print false as two references are no equal 
```

现在如何确保 expression1 等于 expression2 ，因为它们具有相同的标准？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T17:04:54.177

如果你想检查表达式是否相等，而不仅仅是它们总是以相同的方式计算，你可以这样做：

```
exp1.ToString() == exp2.ToString() 
```

请注意，即使是微不足道的更改也会导致它返回 false，例如制作它`j => j.Contains(firstname)`或`exp2`从此类中使用：

```
public class Test
{
    static string firstname;
    public static Expression<Func<string, bool>> exp2 = s => s.Contains(firstname);
} 
```

(even though the lambdas look the same in the code, the `ToString`s show that one is using `Test.firstname` and the other is using a compiler-generated class's `firstname`)

Still, this might be useful depending on where your expressions come from.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:12:37.163

这是`ExpressionEqualityComparer`可以显示如何执行此操作的代码。

[https://source.db4o.com/db4o/trunk/db4o.net/Db4objects.Db4o.Linq/Db4objects.Db4o.Linq/Expressions/](https://source.db4o.com/db4o/trunk/db4o.net/Db4objects.Db4o.Linq/Db4objects.Db4o.Linq/Expressions/)

# node.js - 包含父目录中的 Jade 块

> ID：12229342
> 
> 赞同：3
> 
> 时间：2012-09-01T16:11:38.820
> 
> 标签：node.js, pug

我想在这个目录结构中创建一个 Jade 文件`include.jade`作为其他 Jade 文件的包含`file.jade`：`layout.jade`

```
layouts/layout.jade
documents/file.jade
includes/include.jade 
```

以下不工作：

```
include ../includes/include.jade
include /includes/include.jade
include "../includes/include.jade" 
```

有没有办法在 Jade`include`指令中指定父文件夹？
还是有另一种方法可以实现包含在不同目录中的文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:35:15.320

你不需要`.jade`扩展。尝试：

```
include ../includes/include 
```

# c - c中2个无符号字符*之间的memcpy

> ID：12229343
> 
> 赞同：2
> 
> 时间：2012-09-01T16:11:49.267
> 
> 标签：c, memcpy

如何使用`memcpy`两个指针复制使用`a`，`b`两者都是`unsigned char *`：

1.  `a`指向充满数据的内存（无符号字符）
2.  `b`甚至没有分配

如何复制`a`使用？第三个参数需要指向的内存大小，以字节为单位；如何得到它？`b``memcpy``memcpy``a`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T16:19:55.060

```
unsigned char* b = (unsigned char*)malloc(length_of_a);
memcpy(b, a, length_of_a); 
```

当然，我不能告诉你如何得到“a”的长度。你不能可靠地调用 memcpy 如果你不知道它或者没有它作为变量。否则，任何调用 memcpy 的尝试本质上都是不安全的。

你真正想做什么？

“a”也完全有可能根本不是一个数组。在这种情况下，您不需要 memcpy：

```
char b = '\0';
if (a != NULL)
{
    b = *a;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T16:40:43.677

我们必须假设它`a`是 NUL 终止的（以 结尾`'\0'`），否则我们无法确定它的大小/长度（除非您知道`a`自己的长度）。

```
char *a = "Hello World"; /* say for example */
size_t len = strlen(a)+1; /* get the length of a (+1 for terminating NUL ('\0') character) */ 
```

请注意，如果您知道指向（或保存在）的字符串的长度，`a`那么您将把它分配给`len`，而不是使用上面的语句。

```
char *b = calloc(1, len); /* */
memcpy(b, a, len); /* now b contains copy of a */ 
```

如果您的意图只是复制一个字符串（NUL 终止），您可以使用`strdup()`（在 中声明`string.h`）：

```
char *b = strdup(a); /* b now has a copy of a */ 
```

注意：`strdup()`在 POSIX 中。如果你想要严格的 ANSI C，那么你可以像我之前提到的那样制作一个包装器：

```
unsigned char *my_strdup(const unsigned char *a)
{
  size_t len = strlen(a)+1;
  unsigned char *b = calloc(1, len);
  if (b) return (unsigned char *) memcpy(b, a, len);
  return NULL; /* if calloc fails */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T16:15:26.257

假设“a”以空值结尾，您应该能够使用 strlenb(a) 来获取它的长度，使用 calloc 为目标指针分配内存，然后按照您的说明使用 memcpy。

# objective-c - MGSplitViewController 更改细节视图控制器

> ID：12229351
> 
> 赞同：3
> 
> 时间：2012-09-01T16:14:08.900
> 
> 标签：objective-c, ios, cocoa-touch, uisplitviewcontroller

使用 MGSplitViewController，如何更改详细视图控制器？声明了一个属性：

```
@property (nonatomic, retain) IBOutlet UIViewController *detailViewController; // convenience. 
```

做`splitVC.detailViewController = myVC;`没有效果。相反，我必须这样做`splitVC.viewControllers = @[masterVC, myVC];`。它有效，但这是正确的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:23:17.343

你做得对。来自[UISplitViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UISplitViewController_class/Reference/Reference.html)参考：

> 拆分**视图控制器没有自己的重要接口**。它的工作是管理其两个子视图控制器的呈现以及不同方向之间的转换。

还：

> 您必须将两个视图控制器分配给一个拆分视图控制器。通常你在故事板中配置这些视图控制器；如果您以编程方式创建拆分视图控制器，**则使用 viewControllers 属性分配它们**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:02:49.893

使用[MGSplitViewController](https://github.com/mattgemmell/MGSplitViewController)时，一种在`detailViewController`不重置所有内容的情况下设置的方法（这似乎非常低效）是设置`detailViewController`然后调用`layoutSubviews`

```
splitViewController.detailViewController = myVC;
[splitViewController layoutSubviews]; 
```

这避免了删除主视图控制器的视图然后重置它的浪费开销。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-01T16:27:34.787

不，这不是正确的方法，而是在导航控制器中分配你的主视图控制器和细节视图控制器，就像 `UINavigationController *nav1 = [UINavigationController alloc]initwithrootviewcontroller:masterviewcontroller];` 同样的 nav2 一样。然后写

```
splitViewController = [[UISplitViewController alloc] init];
splitViewController.viewControllers = [NSArray arrayWithObjects:nav1,nav2, nil];
splitViewController.delegate = detailViewController; 
```

就是这样。希望有帮助。

# uitableview - 如何根据表格视图框架调整自定义单元格宽度

> ID：12229354
> 
> 赞同：0
> 
> 时间：2012-09-01T16:14:15.120
> 
> 标签：uitableview, custom-cell

我在 tableview 中使用包含标签和图像的自定义单元格。按钮操作正在缩小 tableview 框架，但自定义单元格宽度没有相应缩小。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:46:37.260

对于那个特定的细胞这样做，

```
UIView *contentView = cell.contentView;
contentView.frame = tableview.frame; 
```

希望这会帮助你。获取该单元格的内容视图并为其设置框架。

# ember.js - 如何在 1.0 之前的版本中创建和扩展 Ember.ArrayController

> ID：12229361
> 
> 赞同：1
> 
> 时间：2012-09-01T16:15:17.750
> 
> 标签：ember.js

我有一个简单的 ember.js hello world，只有 1 条路线

```
(function() {

  window.PersonApp = Ember.Application.create({

    ApplicationController: Ember.ObjectController.extend({}),

    ApplicationView: Ember.View.extend({
      templateName: 'application'
    }),

    Person: Ember.Object.extend({
      username: null,
      isActive: false
    }),

    PersonController: Ember.ArrayController.extend({
      content: [],

      addPerson: function(username) {
        var person = PersonApp.Person.create({ username: username });
        this.pushObject(person);
      },

      removePerson: function(person) {
        this.removeObject(person);
      }
    }),

    AddPersonTextField: Ember.TextField.extend({
      insertNewline: function() {
        var value = this.get('value');

        if (value) {
          PersonApp.PersonController.addPerson(value);
          this.set('value', '');
        }
      }
    }),

    RemovePersonCheckbox: Ember.Checkbox.extend({
      content: null,
      change: function(event) {
        PersonApp.PersonController.removePerson(this.content);
      },
    }),

    HomeController: Ember.Controller.extend(),
    HomeView: Ember.View.extend({
      templateName: 'home'
    }),

    Router: Ember.Router.create({
      root : Ember.Route.extend({
        index: Em.Route.extend({
          route: '/',
          connectOutlets: function(router){
            router.get('applicationController').connectOutlet('home');
          }
        })
      })
    })

  });

  $(function() {
    PersonApp.initialize(PersonApp.Router);
  });

})(); 
```

我的 html 模板非常基本，只定义了一个出口和 1 个“主页”视图以按用户名显示用户

```
<!DOCTYPE html>
<html>
<title>Users</title>
<link href="{{ STATIC_URL }}css/default.css" rel="stylesheet" type="text/css">
<script src="{{ STATIC_URL }}script/vendor/jquery-1.7.2.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}script/vendor/handlebars-1.0.0.beta.6.js" type="text/javascript"></script>
<body>
{% load templatetag_handlebars %}

<script type="text/x-handlebars" data-template-name="application">
  <div class="container">
  {% verbatim %}
    {{outlet}}
  {% endverbatim %}
  </div>
</script>

<script type="text/x-handlebars" data-template-name="home">
  {% verbatim %}
  {{view PersonApp.AddPersonTextField placeholder="username"}}
    <ul>
      {{#each PersonApp.PersonController}}
        <li>
          <label>
            {{view PersonApp.RemovePersonCheckbox contentBinding="this" checkedBinding="isActive"}}
            {{username}}
          </label>
        </li>
      {{/each}}
    </ul>
{% endverbatim %}
</script>

<script type="text/javascript" >
ENV = {
  CP_DEFAULT_CACHEABLE: true,
  VIEW_PRESERVES_CONTEXT: true
};
</script>

<script src="{{ STATIC_URL }}script/vendor/ember-1.0.pre.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}script/app/person.js" type="text/javascript"></script>
</body>
</html> 
```

当它运行时，我收到错误

未捕获的错误：断言失败：Ember.CollectionView 的内容必须实现 Ember.Array。你通过了 PersonApp.PersonController

如果我尝试将 Ember.ArrayController.extend 切换到 Ember.ArrayController.create 我收到错误

未捕获的类型错误：对象没有“创建”方法

环顾四周后，似乎最新的 ember 可能希望我首先在 ArrayController 上调用 .create({})，然后是 .extend({})，但我找不到任何使用 1.0 前版本的好例子。有谁知道我在上面可能做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:30:51.010

这是一个有效的小提琴。[http://jsfiddle.net/feCYT/4/](http://jsfiddle.net/feCYT/4/)

在 Ember pre 中，使用路由器逻辑，您**`extending`**可以`ArrayController`制作`PersonApp.PersonController`.

所以你`PersonApp.PersonController`是将军`Class`。您必须使用`create`此类的实例来处理数据。

Ember`router`会为你做这件事，作为路由器`initializes`，它会创建当时可用的控制器实例。因此，您已经为您准备好了一个实例，`PersonApp.router.personController`请参阅小型大写字母的人物指示实例。

（值得一看 DOM 检查器上的 `App.router'）

类似的功能应该需要一些更改，请参见注释行（这是一个快速修复）：

```
 AddPersonTextField: Ember.TextField.extend({
        insertNewline: function () {
            var value = this.get('value');
            if (value) {
                PersonApp.router.personController.addPerson(value);//check this
                this.set('value', '');
            }
        }
    }), 
```

这是一个快速修复，路由器的实际方法是，事件默认针对路由器，从路由器我们将它们委托给视图或控制器。深入研究路由器以找到它。

**免责声明：这就是我的想法:)**

## 评论 bt @Luke Melia：

> 正如您所指出的，您的事件处理程序示例并不理想。当应用程序初始化时，每个控制器实例都会将其目标属性设置为路由器。当视图处理像 insertNewLine 这样的浏览器事件时，它应该将其转换为发送到路由器的语义操作。例如 this.get('controller.target').send('addPerson', this.get('value'))。然后当前路由可以处理“addPerson”操作来修改模型和控制器，这反过来会触发数据绑定来更新视图，一切都会很好，没有任何全局变量。

# html - CSS文件从单独到单个

> ID：12229362
> 
> 赞同：0
> 
> 时间：2012-09-01T16:15:23.423
> 
> 标签：html, css

我有几个页面的 2 个 CSS 文件，如果我将所有内容都放在一个 css 文件中，我的页面不会加载我已删除的 css 文件的内容，但实际上我已将其移动到主 css (style.css)

如果我将它们分开，页面会加载 2 个 css 文件的内容

这里的例子：

[http://tommywebdesigner.com/Vision%20General.html](http://tommywebdesigner.com/Vision%20General.html) - 它加载 2 个单独的 css 文件 nav.css 和 style.css

当我删除 nav.css 文件并将内容移动到一个名为 style.css 的单个 css 文件中时，页面不再将 nav.css 内容读入 style.css

这里的例子：[http ://tommywebdesigner.com/Home%20Page.html](http://tommywebdesigner.com/Home%20Page.html)

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:04:03.513

对我来说，导航看起来一样。你有什么浏览器？？尝试删除缓存。它有时不会加载新的 CSS 样式。

# node.js - socket.io 二进制支持文档

> ID：12229364
> 
> 赞同：3
> 
> 时间：2012-09-01T16:15:40.440
> 
> 标签：node.js, socket.io

任何人都可以指出任何关于如何在 socket.io 上实现二进制文件的文档吗？它列出了他们在几个月前添加了支持，但我找不到任何文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:11:07.733

Socket.IO 不支持二进制数据，因为并非所有传输都支持这一点。你应该做的是看看[http://binaryjs.com/](http://binaryjs.com/)

如果您不想要这样的解决方案，则必须将所有二进制数据打包成一个字符串并在客户端再次对其进行解码。但这与 binaryjs 所做的基本相同。它使用定制的消息包（编码器）发送数据见[https://github.com/binaryjs/js-binarypack](https://github.com/binaryjs/js-binarypack)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-12T16:44:33.170

截至目前，[从 2014 (v1.0) 开始，Socket.IO 支持二进制文件](http://socket.io/blog/introducing-socket-io-1-0/#binary)。我还写了[一篇](http://blog.castillobg.co/programming/tutorial/golang/2015/11/10/socket-io-file-transfer.html)关于如何使用它的博客文章（因为我发现文档有些缺乏）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T08:47:41.637

还有一个模块可以极大地帮助使用 socket.io 发送二进制数据

试试deliveryjs

> [https://github.com/liamks/Delivery.js](https://github.com/liamks/Delivery.js)

它提供了客户端和服务器之间通过socket.io进行二进制数据通信的方法。（但使用base64转换方法）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-03T19:10:50.173

更新到这里的人，看看[socket.io-stream](https://www.npmjs.org/package/socket.io-stream "socket.io 流")

# algorithm - 如何将一个数字序列转换为单个数字？

> ID：12229374
> 
> 赞同：9
> 
> 时间：2012-09-01T16:17:13.670
> 
> 标签：algorithm, math, numbers

我想将一系列数字转换为单个数字，该数字将保留各个值及其位置。例如，提供了以下序列-

> 1,6,7,8,9,45,67

在这里，例如，如果我应用简单的加法，即 1+6+7+8+9+45+67，那么将生成一个数字。但从那个没有。我们无法通过它们的顺序提取单个数字[即 1,6,7,8,9,...]。

有没有什么方法可以在不进行任何模棱两可的扣除的情况下实现此功能[即从一个数字中只提取一组唯一的数字。]？是否有任何数学函数有助于从该数字中取回单个元素？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T16:19:12.193

您可以将其转换为以 N 为底的数字，其中 N 比输入序列中出现的最大值大一。

**更新**

根据各种评论，我想提供一个可能更容易实施的替代解决方案。您可以将序列视为 UTF-8 编码字符串，并使用[Huffman 编码](http://en.wikipedia.org/wiki/Huffman_coding)和自定义字典来实现紧凑表示。

自定义字典允许您用很少的位存储非常常见的字符（例如，序列分隔符 ',' 和单个字符 '0'..'9' 可以存储低至 3 位，但也可以存储其他数字您发现统计上可能发生的可以存储在一个短的位序列中。例如，如果您发现“42”经常出现，您可以将“42”存储在几个位中。

如果只为“,”和“0”到“9”分配特殊代码，则输入字符串中的每个字符平均少于 4 位，同时保留逗号分隔的序列成员。查找常见的多字符子字符串并将它们添加到字典中只会提高该比率。

使用自定义字典还意味着您不必*将*字典存储在压缩数据的标头中，因为它对您来说是众所周知的。

我使用 SharpZipLib 做了这样的事情

[http://www.icsharpcode.net/opensource/sharpziplib/](http://www.icsharpcode.net/opensource/sharpziplib/)

[http://community.sharpdevelop.net/forums/p/8255/23219.aspx](http://community.sharpdevelop.net/forums/p/8255/23219.aspx)

用zlib也很容易做到

[压缩小块数据](https://stackoverflow.com/questions/11962959/compressing-small-piece-of-data)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T18:28:13.723

在数学上可以为有限序列做到这一点，但不是很实用，因为所需的数字很快就会变得非常大：从 1 ... 67 有 67 ⁷（大约 2 ^(42)）个不同的长度为 7 的整数序列，更不用说更长了序列和更大的整数。

对于此类函数的简单示例，将序列 [1,6,7,8,9,45,67] 映射到值 2 ¹ * 3 ⁶ * 5 ⁷ * 7 ⁸ * 11 ⁹ * 13 ^(45) * 17 ^(67) . 基数是素数，幂是数列中的元素。

反向映射是通过除法计算的 - 您可以将值除以`2`序列中的第一个元素等的次数。该值的最大素数告诉您序列的长度。

如果要`0`在序列中允许正数，则在将质数提高到幂时将所有元素加 1。或者使用 的幂`2`来给出序列的长度，然后开始对以 开头的元素进行编码`3`。

Goedel 在他的不完备性定理证明中使用了这样的编码。

正如 Kendall Frey 所说，不可能定义一个函数将每个*无限*的整数序列映射到不同的整数。这是康托尔证明自然数的幂集不可数的结果：您甚至不能将所有无限的元素序列从整数映射`{true, false}`到整数，更不用说整数的所有无限元素序列了。

对于更实用的方法，请考虑将整数序列编码为字节序列，而不是数字。一个有限的字节序列可以很容易地被认为是一个二进制值，因此它是一个数字，你只是没有真正使用它。您的示例序列的常见表示是字节序列：`[1,6,7,8,9,45,67]`，例如在 JSON 中使用。这是一个 136 位的数字。反转此映射的数学函数涉及 256 的算术模幂、数字 48 的减法、10 的乘法等:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T16:23:42.277

假设您的序列被调用`s` ，我将定义`len(n)`为 n 中的位数。

那么你的结果的第一位数字是`len(s[0])`，后面的`len(s[0])`数字是数字`s[0]`；然后你追加`len(s[1])`and `s[1]`，依此类推。

这适用于最多 9 位数字的数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T16:20:34.390

你不能，如果你的数字范围是无限的。

不可数自然数的幂集。这意味着您无法提供数字集和数字之间的映射。

如果您的数字被限制为 32 位，您可以做的是将这些数字连接成一个长二进制数，并将它们存储为字节序列，可能作为 BigNum。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-25T00:38:15.853

这是上面 Steve Jessop 描述的[Godel 编号](http://en.wikipedia.org/wiki/G%C3%B6del_numbering)的基本 PHP 实现：

```
<?php

$sec = array(5,9,8,4);

$n = count($sec);
$max = max($sec);

$enc = encode($sec);
$dec = decode($enc, $n, $max);

echo "Input sequence:  " . implode(",", $sec) . "\n";
echo "Output sequence: " . implode(",", $dec) . "\n";
echo "Godel number:    " . $enc;
echo (PHP_INT_MAX/$enc < 20 ? " - too big to decode.\n" : "\n");

function encode($sec) {
    $primes = array(2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53);
    $enc = 1;
    $i = 0;
    foreach ($sec as $v) {
        $enc = $enc * pow($primes[$i], $v+1);
        $i++;
    }
    return $enc;
}

function decode($enc, $n, $max) {
    $primes = array(2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53);
    $sec = array();
    for ($i = 0; $i < $n; $i++) {
        for ($v = 2; $v <= $max+1; $v++) {
            if ($enc/pow($primes[$i], $v) != round($enc/pow($primes[$i], $v))) {
                break;
            }
        }
        $sec[] = $v-2;
    }
    return $sec;
}

?> 
```

此脚本仅适用于小序列中的小数字。它不能处理非常大的数字，我想与任何其他实现相同。存储连接它们的数字更加容易和高效：[01,05,15,17] -> 1051517。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-01T16:19:46.437

更新以检查 0,1 案例。

用 001 分隔不同的数字。

为避免与号码中的 00 混淆，每次号码中出现 0 时，将其替换为 01。

要解码，除以 001。将所有 01 替换为 0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-14T03:31:23.517

这使用[通用代码](http://en.wikipedia.org/wiki/Universal_code_(data_compression))，例如[Elias omega 编码](http://en.wikipedia.org/wiki/Elias_omega_coding)（或任何前缀代码——但通用代码是具有一些理想属性的前缀代码）。前缀代码将位序列（即数字）编码为前缀，该前缀基本上提供了必要的信息来确定有多少位构成数字的其余部分。

1）用代码表示序列中的元素个数。2）然后使用代码来表示每个元素。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-14T14:49:05.900

我想到的另一个答案。将每个数字编码为[平衡的三进制，每个三元](http://en.wikipedia.org/wiki/Balanced_ternary)组有两位（例如，0=00；+1=01；-1=10）。剩余的位对（例如，11）是元素结束标记，重复用于序列结束。缺点：当预期值较大时，空间效率低于前缀代码；优点：1）空间效率更高，价值大多较小；2）编码/解码更简单；3) 直接表示负值。

# javascript - 带教程的 Raphael.js 条形图

> ID：12229375
> 
> 赞同：0
> 
> 时间：2012-09-01T16:17:42.713
> 
> 标签：javascript, jquery, html, css

我目前正在我的投资组合网站和关于我的页面上工作，我想以信息图形（文本、图像/插图、图表等）的形式显示它。

[在Raphaël.js](http://raphaeljs.com/)的帮助下，我一直在按照[本教程](http://tympanus.net/codrops/2011/04/22/animated-skills-diagram/)创建图表，一切似乎都很好，但是，我现在正处于创建另一个图表的阶段，只是这次是以条形图的形式。它需要具有与第一个相同的特征（颜色和悬停效果），但我不知道如何做到这一点。

我知道[gRaphaël](http://g.raphaeljs.com/)，在这些例子中，你没有得到相同的效果，而且我发现它更难风格化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T19:55:12.180

这是你想要的？

我已经评论了该脚本，并使其与您提供的链接中的原始内容接近。

[提琴手](http://jsfiddle.net/mori57/FhSrn/5/)

（决定在此处添加脚本，出于存档目的，并且 b/c Stack Overflow 一直鼓励包含相关来源。）

使用的 HTML 源代码：

```
<div id="diagram"></div>
<div class="get">
    <div class="skill">
        <span class="text">jQuery</span>
        <input type="hidden" class="percent" value="95" />
        <input type="hidden" class="color" value="#97BE0D" />
    </div>
    <div class="skill">

        <span class="text">CSS3</span>
        <input type="hidden" class="percent" value="90" />
        <input type="hidden" class="color" value="#D84F5F" />
    </div>
    <div class="skill">
        <span class="text">HTML5</span>
        <input type="hidden" class="percent" value="80" />
        <input type="hidden" class="color" value="#88B8E6" />

    </div>
    <div class="skill">
        <span class="text">PHP</span>
        <input type="hidden" class="percent" value="53" />
        <input type="hidden" class="color" value="#BEDBE9" />
    </div>
    <div class="skill">
        <span class="text">MySQL</span>
        <input type="hidden" class="percent" value="45" />
        <input type="hidden" class="color" value="#EDEBEE" />
    </div>
</div> 
```

Javascript：

```
var o = {
    init: function(){
        this.diagram();
    },
    random: function(l, u){
        return Math.floor((Math.random()*(u-l+1))+l);
    },
    diagram: function(){
        var originX = 10;
        var originY = 50;
        var barHeight = 30;
        var barMargin = 10;

        var r = Raphael('diagram', 600, 600);

        // We don't need the customAttributes, so we drop that, 
        // and replace with a simple call to rect()
        r.rect(10,10,300,barHeight,6).attr({ stroke: 'none', fill: '#193340' });
        // Similarly, we reposition the title to center
        // it with our new rectangle.
        var title = r.text(160, 25, 'Skills').attr({
            font: '20px Arial',
            fill: '#fff'
        }).toFront();

        $('.get').find('.skill').each(function(i){
            // I've added in a width field, and calculate
            // it based on turning its value to a percentage
            // of the width of the Raphael element.
            var t = $(this),
                color = t.find('.color').val(),
                value = t.find('.percent').val(),
                width = r.width * (t.find('.percent').val() *.01),
                text = t.find('.text').text();
            // create a new rectangle, providing X, Y, width, 
            // and height. Base the fill and stroke on the color
            var z = r.rect(originX, originY, width, barHeight).attr({ 'fill': color, 'stroke': color, 'stroke-width':0 });
            // update our originY to accomodate shifting the next
            // bar down by the barHeight + barMargin
            originY = originY + barHeight + barMargin;

            z.mouseover(function(){
                // I added X in to animation, so that it would
                // appear to expand from the left, and the 
                // expansion would not bleed off-canvas
                this.animate({ 'x': 10, 'stroke-width': 20, opacity: .75 }, 1000, 'elastic');
                if(Raphael.type != 'VML') //solves IE problem
                    this.toFront();
                title.animate({ opacity: 0 }, 500, '>', function(){
                    this.attr({ text: text + ': ' + value + '%' }).animate({ opacity: 1 }, 500, '<');
                });
            }).mouseout(function(){
                // and here I revert back to the originX after the
                // mouse has moved on...
                this.animate({ x: originX, 'stroke-width': 0, opacity: 1 }, 1000, 'elastic');
            });
        });
    }
}

$(function(){ o.init(); }); 
```

# backbone.js - 主干视图内的FB发送按钮未加载

> ID：12229379
> 
> 赞同：0
> 
> 时间：2012-09-01T16:18:13.583
> 
> 标签：backbone.js

我的一个视图中有一个 FB 发送按钮。

我环顾四周，有一个关于 SO 的问题，说用于`FB.XML.parse();`重新渲染页面上的所有按钮。

我试着把它放在我的渲染函数中，但仍然没有运气：

```
render: function() {
      var created_at = this.model.pretty_created_at();
      var share_url = this.model.share_url();
      var html = this.template({model:this.model.toJSON(), created_at: created_at, share_url: share_url});
      Galleria.configure({
          initialTransition: false,
          clicknext: true,
      });
      Galleria.run('#galleria', {wait: true});
      $(this.el).html(html);
      this.$('abbr.timeago').timeago();
      FB.XML.parse();
      return this;
}, 
```

另外，请评论我的渲染功能，我应该把这些东西移到初始化吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T07:05:43.260

如果它没有抛出像'FB is undefined'这样的错误，如果你的脚本在'FB'加载之前执行，这可能会发生 - 你可能会调用错误的脚本，或者在将Like按钮占位符插入DOM之前调用它。

在此页面[http://www.vitalmtb.com](http://www.vitalmtb.com) FB 之类的按钮是异步创建的，并使用`FB.XFBML.parse(document.getElementById("sp-a"));`它进行解析，并且可以正常工作。

# hibernate - Hibernate Duplicate entry for pirmarky key on using Composite Primary key and @MapsId

> ID：12229385
> 
> 赞同：3
> 
> 时间：2012-09-01T16:18:35.700
> 
> 标签：hibernate, jpa

我有以下实体，并且使用 hibernate 4.1.* 作为 JPA 提供程序，但是在映射到用户的客户表中使用复合主键给了我 **com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry for key 'PRIMARY '**

实体映射如下。

```
@Entity
class Customer {
@EmbeddedId CustomerId id;
boolean preferredCustomer;

@MapsId("userId")
@JoinColumns({
    @JoinColumn(name = "first_name_", referencedColumnName = "first_name"),
    @JoinColumn(name = "last_name", referencedColumnName = "last_name")
    })
@ManyToOne(optional = false)
private User user;
  -----
 }

 @Embeddable
 private UserPK userId;

  @Basic(optional = false)
  @NotNull
  @Column(name = "customer_number")
 private int customerNumber;
  ----
}

@Entity 
class User {
 @EmbeddedId UserId id;
 @Basic(optional = false)
 @NotNull
 @Column(name = "age")
 private int age;  
 ------
 }

@Embeddable
class UserId implements Serializable {     
 @Basic(optional = false)
 @NotNull
 @Size(min = 1, max = 45)
 @Column(name = "first_name")
 private String firstName;
 @Basic(optional = false)
 @NotNull
 @Size(min = 1, max = 45)
 @Column(name = "last_name")
 private String lastName;
-------
  } 
```

相同的映射适用于 eclipselink。如果我从 CustomerId 中删除 UserId 并仅引用它，它也可以工作，但我想使用 hibernate 和 @MapsId 解决这个问题

我尝试按照[JPA 2 中的建议使用不同的级联选项 - 外键仅包含复合主键中的一个字段？](https://stackoverflow.com/questions/4832544/jpa-2-foreign-key-that-only-includes-one-field-from-a-composite-primary-key) 但没有运气。

# android - android获取联系人图片、姓名和手机号码

> ID：12229389
> 
> 赞同：5
> 
> 时间：2012-09-01T16:19:07.160
> 
> 标签：android, android-contacts

我正在尝试从联系人选择器中检索联系人图片、联系人姓名和手机号码。在联系人选择器中选择联系人后，我希望能够检索这三件事。

我已经成功地从联系人选择器中检索到联系人 ID，但我似乎无法使用该 ID 进行任何其他工作。

我查看了各种示例代码，它们都使用光标，并用光标做不同的事情，但我不明白它是如何工作的。有人可以帮我吗？

这是我尝试过的一些代码：

```
public void launchContactPicker(View view) {
    Intent contactPickerIntent = new Intent(Intent.ACTION_PICK,
            ContactsContract.Contacts.CONTENT_URI);
    startActivityForResult(contactPickerIntent, CONTACT_PICKER_RESULT);
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_OK) {
        switch (requestCode) {
            case CONTACT_PICKER_RESULT:
                Cursor cursor;
                Bundle extras = data.getExtras();
                if(extras != null)
                {
                    Set<String> keys = extras.keySet();
                    for (String key : keys) {
                        extras.get(key);
                    }
                }
                else
                {
                    Log.v("Auto Respond", "No extras returned from contact.");
                }

                Uri result = data.getData();
                String id = result.getLastPathSegment();

                cursor = getContentResolver().query(
                        ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                        null,
                        ContactsContract.CommonDataKinds.Phone.CONTACT_ID +" = ?",
                        new String[]{id}, null);

                contactName = cursor.getString(cursor.getColumnIndex((ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME)));

                Uri photo = Uri.withAppendedPath(result, ContactsContract.Contacts.Photo.CONTENT_DIRECTORY);
                //contactPicture = Contacts.People.loadContactPhoto(this, getStuff, R.drawable.ic_contact_picture, null);
                contactNumber = cursor.getString(cursor.getColumnIndex((ContactsContract.CommonDataKinds.Phone.NUMBER)));

                //Log.v(DEBUG_TAG, "Got a result: " + result.toString());
                cursor.close();
                break;
        }

    } else {
        // gracefully handle failure
        Log.w("Auto Respond", "Warning: activity result not ok");
    }
} 
```

它一直有效，直到分配了光标。我正确获取了 ID，但是当我尝试检索姓名、号码或联系人图片时，我得到了 FC。

这是我从 logcat 得到的：

```
E/AndroidRuntime(23957): FATAL EXCEPTION: main
E/AndroidRuntime(23957): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=1001, result=-1, data=Intent { dat=content://com.android.contacts/contacts/lookup/1760i2bd7c02a0fcd76ea/407 flg=0x1 }} to activity {com.havens1515.autorespond/com.havens1515.autorespond.NoResponse}: android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 1
E/AndroidRuntime(23957):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3264)
E/AndroidRuntime(23957):    at android.app.ActivityThread.handleSendResult(ActivityThread.java:3307)
E/AndroidRuntime(23957):    at android.app.ActivityThread.access$1100(ActivityThread.java:139)
E/AndroidRuntime(23957):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1253)
E/AndroidRuntime(23957):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(23957):    at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(23957):    at android.app.ActivityThread.main(ActivityThread.java:4896)
E/AndroidRuntime(23957):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(23957):    at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(23957):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
E/AndroidRuntime(23957):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
E/AndroidRuntime(23957):    at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(23957): Caused by: android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 1
E/AndroidRuntime(23957):    at android.database.AbstractCursor.checkPosition(AbstractCursor.java:418)
E/AndroidRuntime(23957):    at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:136)
E/AndroidRuntime(23957):    at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:50)
E/AndroidRuntime(23957):    at android.database.CursorWrapper.getString(CursorWrapper.java:114)
E/AndroidRuntime(23957):    at com.havens1515.autorespond.NoResponse.onActivityResult(NoResponse.java:206)
E/AndroidRuntime(23957):    at android.app.Activity.dispatchActivityResult(Activity.java:5192)
E/AndroidRuntime(23957):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3260)
E/AndroidRuntime(23957):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:55:30.490

您的光标正在尝试访问**-1 索引**，因此出现错误。**`cursor.moveToFirst()`**在尝试从列中获取详细信息之前尝试使用。

# function - 为什么我不能在 MATLAB 匿名函数中定义变量？

> ID：12229394
> 
> 赞同：2
> 
> 时间：2012-09-01T16:19:59.480
> 
> 标签：function, matlab, anonymous-function

我一定错过了一些非常简单的东西，因为这看起来不应该这么难。

这段代码是正确的：

```
clear all
whatever = @(x) deal(max(x), size(x));
input = randn(1,1000);
[a b] = whatever(input) 
```

但是，我真正想做的是这样的：

```
clear all
whatever = @(x) deal(q = 3; q*max(x), size(x));
input = randn(1,1000);
[a b] = whatever(input) 
```

为什么会中断？我不能在函数内部定义 q ？？我想使用匿名函数的全部原因是我实际上可以在其中执行多行代码，然后返回答案。我想匿名函数的最后一条语句是返回的，但是如何在其中定义变量呢？我不想在定义匿名函数之前定义 q 。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T16:34:48.067

您不能在匿名函数中声明变量，因为它必须由表达式构造，*即*：`*handle = @(arglist)expr*`

如果您想要可读性，请`q`在函数外部定义，如下所示：

```
q = 3;
whatever = @(x) deal(q * max(x), size(x)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:34:38.967

你没有。匿名函数只有一个语句。您为此使用子函数（不是嵌套函数，这些是具有奇怪范围规则的病态）。

```
function whatever = not_anonymous (x)
  % your code here
end 
```

如果你需要传递函数句柄，你可以使用`@not_anonymous`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T19:11:13.393

您如何看待以下构造：

```
tmpfun = @(x,q) deal...
whatever = @(x) tmpfun(x,3) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T16:29:26.493

我很确定 deal 不能接受多个命令。多个参数，当然，但你正在尝试传递命令。这行得通吗？

```
whatever = @(x) q=3; deal(q*max(x), size(x)); 
```

还有，你为什么不吃这个？

```
whatever = @(x) deal(3*max(x), size(x)); 
```

如果你要在函数中定义它，你最好把实际值放在那里，如果你不能让其他任何东西起作用。

# c++ - 未解析的外部符号静态变量（头文件中定义的方法使用的变量）

> ID：12229396
> 
> 赞同：4
> 
> 时间：2012-09-01T16:20:24.077
> 
> 标签：c++, linker

这是.h：

```
class Logger
{
private:
    static int mTresholdSeverity;

public:
    static __declspec(dllexport) void log(const char* message);
    static __declspec(dllexport) void logFormat(const char* format, ...);

    static __declspec(dllexport) int getTresholdSeverity() { return mTresholdSeverity; }
    static __declspec(dllexport) void setTresholdSeverity(int tresholdSeverity) { mTresholdSeverity = tresholdSeverity; }
}; 
```

和.cpp：

```
#include "Logger.h"
#include <cstdarg>

int Logger::mTresholdSeverity = 200;

void Logger::log(const char* message)
{
    //...
}

void Logger::logFormat(const char* format, ...)
{
    //...
} 
```

我收到此错误：
错误 LNK2001：未解析的外部符号“私有：静态 int TransformationViewer_Utility_Logging::Logger::mTresholdSeverity”(?mTresholdSeverity@Logger@TransformationViewer_Utility_Logging@@0HA) ...

显然，mTresholdSeverity 已初始化。如果我注释掉 getTresholdSeverity() 和 setTresholdSeverity() 或者如果我将它们的定义移到 .cpp 文件中，则会删除该错误。

当头文件中定义的静态方法（getTresholdSeverity() 或 setTresholdSeverity()）使用静态变量（mTresholdSeverity）时，为什么会出现链接错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:08:27.383

下面是它的工作原理。

每个 DLL（或 EXE）或其他完整的“完全链接”二进制文件必须具有所有引用名称的定义，包括静态变量，包括 C++ 类中的静态数据成员。

它们将在应用程序中的 DLL 中分开。这意味着，这个变量值会有所不同，具体取决于您查看的 DLL。将函数移动到 CPP 文件将使它们执行**不同的**操作：它们现在将看到 DLL 的变量副本，而不是 EXE 的副本。

为了使您编写的内容能够编译，必须在一个位置的所有用户二进制文件中存在来自 CPP 的定义。这意味着，DLL 和 DLL 的用户（EXE 或 DLL）必须拥有一个具有此定义的 CPP 文件。

这是一个非常大的麻烦，因为它使单例模式成为不可能（在程序中为所有用户提供共享数据对象）并且每个 DLL 副本都必须有自己的静态状态。此类问题仅存在于 Windows 上，DLL 是动态 **加载 **库。在 UNIX 系统上，有一种称为共享对象 (SO) 的不同技术。它们支持真正的动态链接，这意味着运行链接器以在运行时解析外部名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:34:51.507

问题是`mThresholdSeverity`不是从 DLL 导出的，而是两个访问器是内联定义的，所以无论它们被调用到哪里，它们都必须能够看到`mThresholdSeverity`. 有两种解决方案：要么`mThresholdSeverity`从 DLL 导出（抱歉，我不记得怎么做），或者使访问器成为非内联函数，在 DLL 中定义它们，然后从动态链接库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:57:46.180

这样就不会迷失在噪音中：您可以将访问器更改为普通的非内联函数，并将它们定义在与静态数据成员相同的源文件中。只要您将它们导出，您就可以从任何地方调用它们，并且它们会很好地访问静态数据。

# ruby-on-rails-3 - 没有任何数据库的 Rails 应用程序

> ID：12229397
> 
> 赞同：3
> 
> 时间：2012-09-01T16:20:24.850
> 
> 标签：ruby-on-rails-3

我们可以在没有任何数据库的情况下启动（或）运行 Rails 应用程序吗？

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:27:41.243

在`config/application.rb`文件的开头，您应该有这样的内容：

```
require File.expand_path('../boot', __FILE__)

# Pick the frameworks you want:
require "active_record/railtie"
require "action_controller/railtie"
require "action_mailer/railtie"
#require "active_resource/railtie"
require "sprockets/railtie"
# require "rails/test_unit/railtie" 
```

当您删除此行时：

```
require "active_record/railtie" 
```

`ActiveRecord`将消失，您的应用将不需要数据库连接。

`--skip-activerecord`如果它是一个新项目，您也可以创建项目。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-01T16:28:12.707

检查此链接[Rails 3 - 我如何完全避免使用数据库？](https://stackoverflow.com/questions/3954307/rails-3-how-do-i-avoid-database-altogether).

您只需要确保在配置中未使用数据库相关类。网上可能有更多帮助。

# c++ - 构建基本 C++ 程序时“找到多个定义的符号”

> ID：12229407
> 
> 赞同：0
> 
> 时间：2012-09-01T16:21:09.553
> 
> 标签：c++, fatal-error

我是 C++ 新手。

所以我正在创建一个程序，它收集然后显示有关书籍等的信息。首先，我想了解更多关于我正在做的代码的信息，但我不熟悉 c++ 错误代码。

我创建了 2 个类 Book 和 Publisher，每个类都包含自己的构造函数和方法。在我尝试让我的程序包括我在类图中给出的所有类和方法之后，当我收到错误消息时我停止了：

```
1>Publisher.obj : error LNK2005: "class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl getPublisherInfo(void)" (?getPublisherInfo@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ) already defined in Book.obj
1>Publisher.obj : error LNK2005: "void __cdecl setAddress(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setAddress@@YAXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Book.obj
1>Publisher.obj : error LNK2005: "void __cdecl setCity(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setCity@@YAXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Book.obj
1>Publisher.obj : error LNK2005: "void __cdecl setName(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setName@@YAXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Book.obj
1>C:\Users\pc\Desktop\School\ITS 340\Labs\Lab 1\Lab 1\Debug\Lab 1.exe : fatal error LNK1169: one or more multiply defined symbols found 
```

这是我的 Publisher.cpp 文件：

```
#include <iostream>
using namespace std;

class Publisher
{
    public: 
        Publisher();
        Publisher(string name, string address, string city);
        string getPublisherInfo();
        void setName(string name);
        void setAddress(string address);
        void setCity(string city);

    private:
        string name;
        string address;
        string city;
};

Publisher::Publisher()
{
}

Publisher::Publisher(string name, string address, string city)
{
}

string getPublisherInfo()
{
    return 0;
}

void setName(string name)
{
}

void setAddress(string address)
{
}

void setCity(string city)
{
} 
```

我怎样才能避免这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:23:12.627

你打破了[单一定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)。您需要在头文件中声明类和函数，使用[include guards](http://en.wikipedia.org/wiki/Include_guard)保护它们，并且只将函数和类成员函数的实现或*定义*`.cpp`放在您的文件中。

例如：

富.h：

```
#ifndef FOO_H_
#define FOO_H_
class Foo {
  Foo();
  void foo() const;
};
#endif 
```

Foo.cpp：

```
#include "Foo.h"
Foo::Foo() { .... }
void Foo::foo() const { .... } 
```

主文件

```
#include "Foo.h"
int main()
{
  Foo f;
  f.foo();
} 
```

这完全独立于 OOP。你必须对自由函数做同样的事情。

# jquery - jQuery对话框中的Google Adsense？

> ID：12229411
> 
> 赞同：2
> 
> 时间：2012-09-01T16:21:27.900
> 
> 标签：jquery, dialog, adsense

我有一个使用 jquery 打开对话框的网站

```
function showDialogUser(url, options){
    if (!$('#myDialogUser').dialog('isOpen')) {
    $("#mydialogUser").dialog("close");
}
   options = options || {};
   var tag = $('#myDialogUser');
 //This tag will the hold the dialog content.
   $.ajax({
     url: url,
     type: (options.type || 'GET'),
     beforeSend: options.beforeSend,
     error: options.error,
     complete: options.complete,
     success: function(data, textStatus, jqXHR) {
       if(typeof data == "object" && data.html) { //response is assumed to be JSON
         tag.html(data.html).dialog({modal: options.modal, title: data.title, height: 550, width: 1000}).dialog('open');
       } else { //response is assumed to be HTML
    var matches = data.match(/<title>(.*?)<\/title>/);
        var spUrlTitle = matches[1];
         tag.html(data).dialog({modal: true, title: spUrlTitle, height: 560, width: 1000}).dialog('open');
       }
       $.isFunction(options.success) && (options.success)(data, textStatus, jqXHR);
     }
   });
} 
```

它加载另一个包含 google adsense 代码的 page.asp 文件。

问题是它没有显示广告。

当我尝试在浏览器上访问 page.asp 时，会出现广告。

我该怎么做 ？我尝试了几种方法，但没有奏效

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:24:00.850

Google adsense 无法在 jQuery UI 对话框中正常工作，因为它需要移动 adsense html，这反过来又会产生无效的展示次数，从而导致您的帐户被关闭。

我建议反对。

# c# - 为什么这个函数必须是静态的？

> ID：12229412
> 
> 赞同：2
> 
> 时间：2012-09-01T16:21:40.207
> 
> 标签：c#

```
public void AppendText(this RichTextBox box, string text, Color color)
{
    box.SelectionStart = box.TextLength;
    box.SelectionLength = 0;

    box.SelectionColor = color;
    box.AppendText(text);
    box.SelectionColor = box.ForeColor;
} 
```

它是`public static void`

但后来我在 Form1 的这一行出现了错误：

```
public partial class Form1 : Form 
```

错误在 Form1 上说：

> 错误扩展方法必须在非泛型静态类中定义

如果我从函数中删除静态，我在 AppendText 上遇到错误说：

> 错误扩展方法必须是静态的

我该如何处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:22:20.043

因为它是 RichTextBox 上的[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)，所以它需要是静态的，也需要在静态类中。

`this`方法参数中的关键字将其定义为 RichTextBox 上的扩展方法

```
AppendText(this RichTextBox box....... 
```

来自[MSDN - 扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

> 扩展方法定义为静态方法，但使用实例方法语法调用。它们的第一个参数指定方法操作的类型，参数前面是**this**修饰符。

来自[MSDN - 这个关键字](http://msdn.microsoft.com/en-us/library/dk1507sz.aspx)

> this 关键字引用类的当前实例，也用作**扩展方法的第一个参数的修饰符。**

如果要在 RichTextBox 上创建扩展方法，则必须将此方法定义为静态方法，并将其放在静态非泛型类中，例如：

```
public static class MyExtensions
{
   public static void AppendText(this RichTextBox box, string text, Color color)
   {
    box.SelectionStart = box.TextLength;
    box.SelectionLength = 0;

    box.SelectionColor = color;
    box.AppendText(text);
    box.SelectionColor = box.ForeColor;
   } 
} 
```

以后你可以这样称呼它：

```
RichTextBox yourRichTextBox = new RichTextBox();
yourRichTextBox.AppendText("Some Text",Color.Blue); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:23:10.007

`this`第一个参数之前的关键字用于[定义扩展方法](http://msdn.microsoft.com/en-us/library/bb311042)。

```
public void AppendText(this RichTextBox box, string text, Color color)
//                     ^^^^ 
```

扩展方法必须在静态类中。

删除`this`关键字使其成为普通方法。

# javascript - Javascript：动态更改 CSS 文件 + Cookie

> ID：12229413
> 
> 赞同：3
> 
> 时间：2012-09-01T16:21:54.457
> 
> 标签：javascript, jquery, cookies, jquery-cookie, dynamic-css

我想**仅**使用 javascript动态更改使用的**CSS 文件**( )并保存 cookie 中的更改。`<link href="..." />`

 **这是一个 jQuery 版本，可以满足我的要求（[ref](http://www.jquery4u.com/dynamic-css-2/jquery-change-css-file-2/)），但我如何在 javascript 中做到这一点？

```
if($.cookie("css")) {
    $("link").attr("href",$.cookie("css"));
}
$(document).ready(function() {
    $("#nav li a").click(function() {
        $("link").attr("href",$(this).attr('rel'));
        $.cookie("css",$(this).attr('rel'), {expires: 365, path: '/'});
        return false;
    });
}); 
```

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T16:28:43.280

也许这可以帮助你..

```
(function() {
    var e = document.createElement('link'); 
    e.href = document.location.protocol + '//example.com/file.css';
    e.type = 'text/css';
    e.rel = 'stylesheet';
    e.media = 'screen';
    document.getElementsByTagName('head')[0].appendChild(e);      
}()); 
```

* * *

编辑，没有 jQuery 的完整 JavaScript

```
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

document.addEventListener('DOMContentLoaded',function(){

    if(readCookie('css')){
        var e = document.getElementById('test-css'); // <link href="..." id="test-css"/>
        e.href = readCookie('css'); 
    }

    var element = document.getElementById('change-css'); // <a herf="#" id="change-css" rel="file.css">Click Here</a>
    element.addEventListener('click', function (event) { 
        var e = document.getElementById('test-css');
        e.href = this.rel;
        if(readCookie('css')){  
            eraseCookie('css');     
        }
        createCookie('css',this.rel,365); 
        event.preventDefault(); 
    }, false);
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:43:15.857

**阅读**：[http ://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

**并且**：[http ://www.hunlock.com/blogs/Howto_Dynamically_Insert_Javascript_And_CSS](http://www.hunlock.com/blogs/Howto_Dynamically_Insert_Javascript_And_CSS)

首先，让我们制作一个示例 html 布局。

```
<html> <!--#include javascript.js styles.css-->
    <body>
        <span>sometext</span>
        <p>somemoretext</p>
    </body>
</html> 
```

接下来，让我们制作一个示例 css 布局。

```
span {
    color: red;
}

p {
    color: blue;
}

body {
    background: black;
} 
```

现在是javascript。在我们做任何事情之前，cookies 不能存储 css 信息。我们将使用 cookie 名称来确定要加载的样式类型。上面的 quirksmode 资源让我们可以轻松使用 cookie。

```
if(readCookie("newStyle")) {
    // do something
} else {
    // do something else
} 
```

在这种情况下，我们要更改样式。我们可以使用两种方法：`document.element.style.property` *或者* `appendChild`使用另一个 CSS 表单的 href。在本例中，我们使用`document.element.style.property`.

```
if(readCookie("newStyle")) {
    eraseCookie("newStyle")
    document.getElementsByTagName("span")[0].style.color = "purple"
    document.getElementsByTagName("p")[0].style.color = "pink"
} else {
    createCookie("newStyle",0000,60)
} 
```

***现场示例***：http: [//jsfiddle.net/5HGsH/3/](http://jsfiddle.net/5HGsH/3/)

多次刷新页面以查看不同颜色的单词。**

# asp.net-mvc-3 - HttpPost 和 HttpGet 不工作？

> ID：12229415
> 
> 赞同：1
> 
> 时间：2012-09-01T16:22:01.817
> 
> 标签：asp.net-mvc-3

在 Mvc 应用程序中，我创建了一个简单的应用程序 HttGet、HttpPost 但无法正常工作。这是我的代码：

模型：

```
public class SasiClass
{
    public int SasiId { get; set; }
    public string SasiName { get; set; }
    public string SasiAddress { get; set; }
} 
```

控制器：

```
 [HttpGet]
    public ActionResult CreateSasi()
    {
        SasiClass objSasi = new SasiClass();
        return View(objSasi);
    }

    [HttpPost]
    public ActionResult CreateSasi(SasiClass obj)
    {
        return View("Show",obj); 

    } 
```

视图：创建萨西：

```
@using (Html.BeginForm("CreateSasi", "Home"))
{
 <table >
   <tr>
      <td>Sasi ID</td>
      <td>@Html.TextBox("SasiId",@Model.SasiId ) </td>
   </tr>
  <tr>
      <td>Sasi Name</td>
     <td>@Html.TextBox("SasiName",@Model.SasiName) </td>
 </tr>
    <tr>
      <td>Sasi Address</td>
     <td>@Html.TextBox("SasiAddress",@Model.SasiAddress) </td>
 </tr>
  <tr>
       <td colspan="2">@Html.ActionLink("Submit","CreateSasi")  </td>  
  </tr>
 </table>
 } 
```

显示：查看

```
 <table>
 <tr>
  <td>Id: </td>
  <td>@Model.SasiId</td>
 </tr>
 <tr>
  <td>Name: </td>
  <td>@Model.SasiName</td>
   </tr>
   <tr>
     <td>Address: </td>
     <td>@Html.TextBox("address", @Model.SasiAddress)</td>
   </tr> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:02:46.347

你应该看到 SasiId 而不是 Id

```
<td>@Html.TextBox("SasiId",@Model.SasiId ) </td> 
```

编辑！！！

您应该提交表单，而不是链接到操作！在这种情况下这是错误的：

```
<td colspan="2">@Html.ActionLink("Submit","CreateSasi")  </td> 
```

这样做：

```
<td colspan="2"><input type="submit"/>  </td> 
```

# jquery - jquery动画增长和缩小问题

> ID：12229418
> 
> 赞同：0
> 
> 时间：2012-09-01T16:22:43.620
> 
> 标签：jquery, animation, html, shape

我已经制作了一个基本的 html 网站，我有两个按钮，一个使 J 查询正方形 ( `<div id="ccal" style="background:#2E2EFE;height:150px;width:150px;">`) 更大 (id="ccalicon")，另一个按钮 (id="ccalmax") 使其更大。

**第一个按钮**

```
$("#ccalicon").click(function(){
  $("#ccal").animate({width:500,height:300},"slow");
}); 
```

但是，当我单击第二个按钮时，我希望它使正方形变大，但它会再次增长和缩小（宽度：50，高度：300）！

```
$("#ccalmax").click(function(){
$("#ccal").animate({width:700,height:700},"slow");
}); 
```

任何人都可以对此有所了解，为什么会发生这种情况以及我应该做些什么来阻止它再次缩小？
谢谢，

# java - Java EE 安全

> ID：12229419
> 
> 赞同：1
> 
> 时间：2012-09-01T16:22:53.730
> 
> 标签：java, web-services, jakarta-ee, ws-security

我是一名 iOS 开发人员，我需要开发 Web 服务，因为 iOS App 需要从存储在服务器中的数据库中检索一些信息。

我想使用 Java EE 开发这个 Web 服务，但是我想了解一些关于 Java EE 安全性的信息，因为我需要确保存储到服务器上数据库中的数据的安全性。

你有什么关于 Java EE 安全性的书或很棒的教程可以推荐吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:52:54.027

这是Java EE安全官方教程的链接：http: [//docs.oracle.com/javaee/6/tutorial/doc/gijrp.html](http://docs.oracle.com/javaee/6/tutorial/doc/gijrp.html)

这是Java EE Web服务官方教程的链接：http: [//docs.oracle.com/javaee/6/tutorial/doc/bnayk.html](http://docs.oracle.com/javaee/6/tutorial/doc/bnayk.html)

请记住，在开发 Web 服务时，netbeans 会为您提供很多帮助。

netbeans 的一些教程：

*   [http://netbeans.org/kb/docs/websvc/jax-ws.html](http://netbeans.org/kb/docs/websvc/jax-ws.html)
*   [http://netbeans.org/kb/docs/websvc/intro-ws.html](http://netbeans.org/kb/docs/websvc/intro-ws.html)

这是 REST Web 服务教程： http: [//netbeans.org/kb/docs/websvc/rest.html](http://netbeans.org/kb/docs/websvc/rest.html)

# python - 即时替换部分功能代码

> ID：12229424
> 
> 赞同：1
> 
> 时间：2012-09-01T16:23:22.007
> 
> 标签：python

[在这里](https://stackoverflow.com/a/12227731/862380)，我想出了解决我提出的另一个问题的解决方案，该问题是如何删除分散在函数代码中的所有昂贵的调试输出函数调用（使用空函数时减速是 25 倍`lambda *p: None`）。

解决方案是动态编辑函数代码并在所有函数调用前加上注释符号`#`。

```
from __future__ import print_function

DEBUG = False

def dprint(*args,**kwargs):
    '''Debug print'''
    print(*args,**kwargs)

def debug(on=False,string='dprint'):
    '''Decorator to comment all the lines of the function code starting with string'''
    def helper(f):      
        if not on:
            import inspect
            source = inspect.getsource(f)
            source = source.replace(string, '#'+string) #Beware! Swithces off the whole line after dprint statement
            with open('temp_f.py','w') as file:
                file.write(source)
            from temp_f import f as f_new
            return f_new            
        else:
            return f #return f intact
    return helper

def f():
    dprint('f() started')
    print('Important output')
    dprint('f() ended')

f = debug(DEBUG,'dprint')(f) #If decorator @debug(True) is used above f(), inspect.getsource somehow includes @debug(True) inside the code.

f() 
```

我现在看到的问题是：

*   `#`commets 所有行到最后；但可能还有其他语句以 . 分隔`;`。这可以通过删除所有`pprint`调用来解决`f`，而不是评论，但它可能不是那么微不足道，因为可能存在嵌套的括号。
*   `temp_f.py`被创建，然后`f`从中加载新代码。应该有更好的方法来做到这一点，而无需写入硬盘驱动器。我找到[了这个食谱](http://code.activestate.com/recipes/550804-create-a-restricted-python-function-from-a-string/)，但没能成功。
*   如果使用特殊语法应用装饰器，`@debug`则`inspect.getsource`在函数代码中包含带有装饰器的行。此行可以手动从字符串中删除，但如果有多个装饰器应用于`f`. 我通过使用旧式装饰器应用程序解决了这个问题`f=decorator(f)`。

您在这里看到了哪些其他问题？

如何解决所有这些问题？

这种方法的优点和缺点是什么？

这里有什么可以改进的？

有没有更好的方法来做我试图用这段代码实现的目标？

* * *

我认为在编译为字节码之前预处理函数代码是一种非常有趣且有争议的技术。奇怪的是没有人对此感兴趣。我认为我给出的代码可能有很多不可靠的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:40:01.603

装饰器可以返回包装器，也可以返回未更改的装饰函数。使用它来创建更好的调试器：

```
from functools import wraps

def debug(enabled=False):
    if not enabled:
        return lambda x: x  # Noop, returns decorated function unaltered

    def debug_decorator(f):
        @wraps(f)
        def print_start(*args, **kw):
            print('{0}() started'.format(f.__name__))
            try:
                return f(*args, **kw)
            finally:
                print('{0}() completed'.format(f.__name__))
        return print_start
    return debug_decorator 
```

该`debug`函数是一个装饰器*工厂*，当被调用时它会产生一个装饰器函数。如果调试被禁用，它只返回一个 lambda，它返回它的参数不变，一个无操作装饰器。启用调试后，它会返回一个调试装饰器，该装饰器在装饰函数启动时打印，并在返回时再次打印。

然后将返回的装饰器应用于装饰函数。

用法：

```
DEBUG = True

@debug(DEBUG)
def my_function_to_be_tested():
    print('Hello world!') 
```

重申一下：当`DEBUG`设置为 false 时，`my_function_to_be_tested`保持不变，因此运行时性能完全不受影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T22:56:00.643

这是我在对我在 StackOverflow 上提出的另一个问题的回答后提出的解决方案。

此解决方案不评论任何内容，只是删除独立`dprint`语句。它使用[`ast`](http://docs.python.org/library/ast.html)模块并与抽象语法树一起使用，它让我们避免解析源代码。这个想法写在[这里](https://stackoverflow.com/questions/12238511/preprocessing-function-text-in-runtime-bofore-compilation#comment16402435_12238511)的评论中。

在必要的环境中，写入`temp_f.py`被替换为执行。[此处](https://stackoverflow.com/a/12238725/862380)`f`提供了此解决方案。

此外，最后一个解决方案解决了装饰器递归应用程序的问题。它通过使用`_blocked`全局变量来解决。

此代码解决了问题中要求解决的问题。但是，[建议不要在实际项目中使用](https://stackoverflow.com/questions/12238511/preprocessing-function-text-in-runtime-bofore-compilation#comment16403281_12238725)：

> 你是对的，你永远不应该诉诸于此，有很多方法可能出错。首先，Python 不是为源代码级别的转换而设计的语言，很难在不破坏有效代码的情况下将其编写为诸如 comment_1 之类的转换器。其次，这种 hack 会在各种情况下中断——例如，在定义方法时、定义嵌套函数时、在 Cython 中使用时、inspect.getsource 因任何原因而失败时。Python 是动态的，你真的不需要这种 hack 来定制它的行为。

```
from __future__ import print_function

DEBUG = False

def dprint(*args,**kwargs):
    '''Debug print'''
    print(*args,**kwargs)

_blocked = False
def nodebug(name='dprint'):
    '''Decorator to remove all functions with name 'name' being a separate expressions'''
    def helper(f):      
        global _blocked
        if _blocked:
            return f

        import inspect, ast, sys

        source = inspect.getsource(f)        
        a = ast.parse(source) #get ast tree of f

        class Transformer(ast.NodeTransformer):
            '''Will delete all expressions containing 'name' functions at the top level'''
            def visit_Expr(self, node): #visit all expressions
                try:
                    if node.value.func.id == name: #if expression consists of function with name a
                        return None #delete it
                except(ValueError):
                    pass
                return node #return node unchanged
        transformer = Transformer()
        a_new = transformer.visit(a)
        f_new_compiled = compile(a_new,'<string>','exec')

        env = sys.modules[f.__module__].__dict__
        _blocked = True
        try:
            exec(f_new_compiled,env)
        finally:
            _blocked = False
        return env[f.__name__]         
    return helper

@nodebug('dprint')        
def f():
    dprint('f() started')
    print('Important output')
    dprint('f() ended')
    print('Important output2')

f() 
```

## 其他相关链接：

*   [关闭调试打印](https://stackoverflow.com/questions/12223204/switching-off-debug-prints)

# objective-c - NSFilemanager attributesOfItemAtPath 挫折

> ID：12229427
> 
> 赞同：1
> 
> 时间：2012-09-01T16:24:00.130
> 
> 标签：objective-c

我正在使用用户在此处发布的一些代码为我的设置修改了带有进度条的文件复制（来自 Cocoa is my Girlfriend [http://www.cimgf.com/2008/05/03/cocoa- tutorial-file-copy-with-progress-indicator/](http://www.cimgf.com/2008/05/03/cocoa-tutorial-file-copy-with-progress-indicator/)）。

我试图修复一些不推荐使用的方法，并且在此过程中破坏了检测文件大小。我昨天大部分时间都在尝试不同的方法来修复它，但没有任何运气。我还应该注意 sourceFilePath 是从 NSTextField 获得的。

我知道错误消息说该文件不存在，但它确实存在。它的路径不包含任何符号链接，并确保我使用了 NSString 方法 stringByResolvingSymlinksInPath。任何想法这里出了什么问题？这是代码，以及我收到的错误消息。

```
- (IBAction)startCopy:(id)sender;
{
NSError *attributeserror = nil;

NSString *accountsourcestring = [sourceFilePath stringValue];
NSString *accountsourcestringpath =[accountsourcestring stringByStandardizingPath];

// Use the NSFileManager to obtain the size of our source file in bytes.
NSFileManager *fileManager = [NSFileManager defaultManager];
NSDictionary *sourceAttributes = [fileManager     attributesOfItemAtPath:accountsourcestringpath error:&attributeserror];
NSNumber *sourceFileSize= [sourceAttributes objectForKey:NSFileSize];
long long fileSize = [sourceFileSize longLongValue];

NSLog(@"Filesize = %lld", fileSize);
NSLog(@"sourcefilepath: %@", accountsourcestring);

if ((sourceFileSize = [sourceAttributes objectForKey:NSFileSize]) )
{
    // Set the max value to our source file size
    [progressIndicator setMaxValue:(double)[sourceFileSize unsignedLongLongValue]];
}
    else
{
    // Couldn't get the file size so we need to bail.
    NSLog(@"Unable to obtain size of file being copied. Error %@ Source file size: %@,   sourceAttributes: %@", attributeserror, sourceFileSize, sourceAttributes);
    return;
} 
```

这是控制台中记录的错误消息：

```
2012-09-01 11:23:07.061 Copy File[1004:303] Filesize = 0
2012-09-01 11:23:07.062 Copy File[1004:303] sourcefilepath:     file://localhost/Users/daniel/Lion%20plists/
2012-09-01 11:23:07.072 Copy File[1004:303] Unable to obtain size of file being copied.    Error Error Domain=NSCocoaErrorDomain Code=260 "The file “Lion%20plists” couldn’t be opened   because there is no such file." UserInfo=0x100173770   {NSFilePath=file:/localhost/Users/daniel/Lion%20plists, NSUnderlyingError=0x100140240 "The   operation couldn’t be completed. No such file or directory"} Source file size: (null),   sourceAttributes: (null) 
```

# iphone - 在列中添加图像

> ID：12229429
> 
> 赞同：0
> 
> 时间：2012-09-01T16:24:00.430
> 
> 标签：iphone, objective-c, ios, image, animation

请帮忙。在列中组织一些图像的最佳方法是什么，以便轻松计算img添加的动画，这取决于已经添加了多少张图片。图片 - [http://bit.ly/OBK8xk](http://bit.ly/OBK8xk) 非常感谢。抱歉英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:52:39.127

您可以使用 for loop.for 例如。动态图像可以通过在数组（imagearray）中获取来实现。然后试试这个代码

```
static int statvar = 0;
for(int i=0;i<[imagearray count];i++)
{
    UIImageView* imgView = [[UIImageView alloc] initWithFrame:CGRectMake(10, 10+statvar, 50, 50)];
    [imgView  setImage:[UIImage imageNamed:@"arrow.png"]]
    statvar+=55;
    [self.view addsubview:imgView];
} 
```

# android - DataBaseHelper 没有获取 ListFragment 的上下文

> ID：12229434
> 
> 赞同：2
> 
> 时间：2012-09-01T16:24:31.370
> 
> 标签：android, database, sqlite

我查看了上下文信息，它在活动组的已知间接子类中说，“这个类已被弃用。改用新的 Fragment 和 FragmentManager API”那么为什么在下面的代码中它不能在我扩展 ListFragment 的类中工作？当我在我的类中尝试扩展 Activity 虽然它可以工作时（它应该在已知的间接子类中）。我需要做什么才能打开数据库并在 AFragmentTab 中获取信息？提前谢谢您，如果可能，请提供邮政编码。

**数据库助手类：**

```
public class DataBaseHelper extends SQLiteOpenHelper{

private static String DB_PATH = "/data/data/com.example.alotoftesting/databases/";    
private static String DB_NAME = "library1_dev.db"; 
private SQLiteDatabase myDataBase;  
private final Context myContext;
Cursor cursor;

public DataBaseHelper(Context c){
    super(c, DB_NAME, null, 1);
    this.myContext = c;
}

public void createDataBase() throws IOException{

    boolean dbExist =  checkDataBase();

    if(dbExist){
        //do nothing since the database already exist.
        System.out.println("Database Exist");
    }
    else{
        System.out.println("2.5");
        this.getReadableDatabase();

        try{
            System.out.println("3.");
            copyDataBase();
            System.out.println("We just copied the database.");
        }catch(IOException e){
            throw new Error("Error Copying Database");
        }
    }       
}

private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;
    System.out.println("1.");
    try{
        String myPath = DB_PATH + DB_NAME;
        System.out.println("2.");
        checkDB =  SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
        System.out.println("We are in here");
    }catch(SQLiteException e){
        //database doesn't exist yet.
    }

    if(checkDB != null){
        checkDB.close();
        System.out.println("Database Closed");

    }

    return checkDB != null ? true : false;
}

private void copyDataBase()throws IOException{

    //Opens your local db as the input stream.
    InputStream myInput =  myContext.getAssets().open(DB_NAME);

    //Path to the just created empty DB.
    String outFileName =  DB_PATH + DB_NAME;

    //Opens the empty DB as the output stream.
    OutputStream myOutput = new FileOutputStream(outFileName);

    //transfer bytes from the inputfile to the outputfiles.
    byte[] buffer = new byte[1024];
    int length;
    while((length = myInput.read(buffer)) > 0){
        myOutput.write(buffer, 0, length);
    }

    //Close the Streams.
    myOutput.flush();
    myOutput.close();
    myInput.close();        
}

public void openDatabase() throws SQLException{

    //Open the database.
    String myPath = DB_PATH + DB_NAME;
    myDataBase = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
}    

public void closeDatabase() throws SQLException{

    //Close the database.
    myDataBase.close();
}

public ArrayList<String> getTableColumn(String tableName, String[] column){

    ArrayList<String> aL = new ArrayList<String>();

    cursor = myDataBase.query(tableName, column, null, null, null, null, null);

    cursor.moveToFirst();
    while (!cursor.isAfterLast()) {
      aL.add(cursor.getString(0));
      cursor.moveToNext();
    }

    System.out.println(aL);
    cursor.close();
    return aL;
}

@Override
public void onCreate(SQLiteDatabase db){

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion){

}

} 
```

我要在其中打开数据库的类，**AFragmentTab 类：**

```
public class AFragmentTab extends ListFragment{

DataBaseHelper myDB;

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onActivityCreated(savedInstanceState);

    myDB = new DataBaseHelper(this);  //<------The error is here.   
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:27:12.237

`Fragment`不扩展`Activity`和间接`Context`。所以改变你的代码如下：

```
myDB = new DataBaseHelper(getActivity()); 
```

**getActivity()**方法返回您的片段所附加到的活动的引用，因此提供了传递上下文的解决方案。

# c++ - 指向 A 类的指针被传递给 B 类，但是当 B 被删除时，A 也是如此。如何保持A？

> ID：12229435
> 
> 赞同：0
> 
> 时间：2012-09-01T16:24:49.680
> 
> 标签：c++, qt

在 Qt-creator 的 C++ 项目中，我有一个类 Settings，它存储了一些我想在类 App 中使用的设置（App 可以操作设置，删除 App 后我需要这个更新的数据）。首先，我为每个类定义一个指针，声明它并将设置传递给 App。

设置.h：

```
class Settings {
public:
  Settings();
// ...
} 
```

应用程序.h：

```
class App {
public:
  App(Settings *set);
private:
  Settings *s;
// ...
} 
```

应用程序.cpp：

```
App::App(Settings *set){
s = set;
// manipulate s...
} 
```

主文件

```
Settings* s;
App* a; 
```

主文件

```
// ...
s = new Settings;
a = new App(s);

// ...
if(!aIsNeeded)
 delete a;
// from here, s is deleted too 
```

这很好，直到我再次需要具有相同设置的应用程序。当我调用 a = new App(s); 有一个例外，因为 s 似乎也被删除了。

有更好的方法吗？为什么要删除s？

感谢您的回答！

编辑：问题是设置为 QWidget 被添加到 App 的 ui 中，因此成为 App 的子项。`a`我通过在before的析构函数中添加这一行来解决它`delete ui;`：

```
s->setParent(0); 
```

感谢所有提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:28:11.597

默认情况下不应该发生这种情况。似乎`App`有一个析构函数正在删除该指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:30:16.543

显然，该成员在 的析构函数中被释放`a`，在这种情况下，由您来定义`Settings`. 由于它是在 之外创建的`App`，我会说它的所有权不属于`App`，所以`App`不应该删除它。

当然，如果你使用智能指针，你就不会遇到这个问题。

# c++ - 添加多个 QTreeWidgetItem

> ID：12229445
> 
> 赞同：1
> 
> 时间：2012-09-01T16:27:04.473
> 
> 标签：c++, qt, user-interface

我正在尝试构建一个具有多个 QTreeWidgetItems 的 QTreeWidget，我尝试手动添加其中一些并且它可以工作。我的问题是如何使用 for 或 while 循环添加项目。

这是我的代码的一部分

```
Dwidget= new QDockWidget(this);
Dwidget->setAllowedAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea);

treeWidget= new QTreeWidget(Dwidget);

Titem= new QTreeWidgetItem(treeWidget);
Titem1= new QTreeWidgetItem();
Titem2= new QTreeWidgetItem();
Titem3= new QTreeWidgetItem();

Titem->setText(0,"WriterIdenSystem");
Titem->setIcon(0,*(new QIcon("D:/Users/200656336/Documents/Writer Identification/data_repository_icon.jpg")));

Titem1->setText(0,"Database for Writer Identification");
Titem1->setIcon(0,*(new QIcon("D:/Users/200656336/Documents/Writer Identification/card_file.png")));
Titem2->setText(0,"0001");
Titem2->setIcon(0,*(new QIcon("D:/Users/200656336/Documents/Writer Identification/Folder Open.png")));

Titem3->setText(0,"0002");
Titem3->setIcon(0,*(new QIcon("D:/Users/200656336/Documents/Writer Identification/Folder Open.png")));

Titem->addChild(Titem1);
Titem1->addChild(Titem2);
Titem1->addChild(Titem3);
treeWidget->addTopLevelItem(Titem);

connect(treeWidget, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(on_actionRetrieve_Documents_triggered()));

Dwidget->setWidget(treeWidget);
addDockWidget(Qt::LeftDockWidgetArea,Dwidget);
Dwidget->show(); 
```

有任何想法吗？？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:01:19.333

根据你的代码，可以做这样的事情。

```
QTreeWidgetItem* items[ITEM_COUNT]; // Must be multiple of 3
QTreeWidget* treeWidget = new QTreeWidget;
if(!treeWidget){ /* operating system out of memory, handle the error */ }
for(int i=0;i<=(ITEM_COUNT-3);i+=3)
{
   items[i  ] = new QTreeWidgetItem(treeWidget);
   if(!items[i]){ /* operating system out of memory, handle the error */ }
   items[i+1] = new QTreeWidgetItem(treeWidget);
   items[i+2] = new QTreeWidgetItem(treeWidget);
   /* set text here */
   items[i  ]->addChild(items[i]);
   items[i+1]->addChild(items[i+1);
   items[i+1]->addChild(items[i+2);
   treeWidget->addTopLevelItem(items[i]);
} 
```

# css - 完整的背景图片；内容不滚动

> ID：12229446
> 
> 赞同：4
> 
> 时间：2012-09-01T16:27:09.403
> 
> 标签：css

我已经用 CSS 实现了一个完整的、非滚动的背景图像。但是，当内容本身溢出页面时，不会出现滚动条，也无法看到内容。我曾尝试在我的一些 div 中使用“溢出：滚动”的各种变体，但无济于事；出现滚动条，但它们不滚动，或滚动不正确。我认为我的 div 可能存在结构性问题，但我对 CSS 并不是特别有经验，并且在 StackOverflow 上找不到与此类似的线程。

[http://jsfiddle.net/YXp5p/](http://jsfiddle.net/YXp5p/)

```
<body>

<div id="bg">
    <img src="images/background.jpg">
</div>

<div id="wrapper">
    <div id="header">
        thread #6bUp0
    </div>

    <div id="sidebar">
        <div id="content">
            <div id="post">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec erat ante, placerat accumsan aliquam at, rhoncus eget nunc.
            </div>
        </div>
    </div>

</div>

</body>

body{
    margin: 0px;
    color: #000;
    font-family: helvetica, times;
    font-size: 16px;
}

#bg {
    position:fixed; 
    top:-50%; 
    left:-50%;
    width:200%; 
    height:200%;
}
#bg img {
    position:absolute; 
    top:0; 
    left:0; 
    right:0; 
    bottom:0; 
    margin:auto; 
    min-width:50%;
    min-height:50%;
}

#wrapper {
    position: fixed;
    top:0%; 
    left:18%;
    width: 59%;
    height:200%;
    padding: 0%;
}

#header {
    background: url(images/header.gif) repeat-x;
    border: 1px solid black;
    width: 100%;
    height:29px;
    padding-left: 3%;
    padding-right: 3%;
    padding-top: 6px;
    font-family: "Lucida Console", "Courier New", sans-serif;
    text-align: center;
    font-size: 20px;
    font-weight: bold;
}   

#sidebar {
    background-color: #EEEEEE;
    width: 100%;
    height: 100%;
    padding-left: 3%;
    padding-right: 3%;
    right: 3%;
    border-left: 1px solid #000;
    border-right: 1px solid #000;
}

#content {
    background-color: #FFFFFF;
    width: 100%;
    height: 100%;
    border-left: 1px solid #000;
    border-right: 1px solid #000;
    opacity: 1;
    padding-top: 8px;
}

#post{
    margin-left: 8px;
    margin-right: 8px;
    margin-bottom: 5px;
    background-color: #FFF;
    opacity: 1;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T16:31:06.090

您正在寻找的`background-attachment:fixed`不是`position:fixed`您可以像这样实现您想要的东西：

```
身体{
    背景图像：url（'图像/背景.jpg'）；
    背景位置：中心顶部；
    背景附件：固定；
    边距：0px；
    颜色：#000；
    字体系列：helvetica，时代；
    字体大小：16px；
}

```

哦，删除：

```
<div id="bg">
    <img src="images/background.jpg">
</div> 
```

文件的一部分。

# android - Android imageView id 不显示

> ID：12229451
> 
> 赞同：0
> 
> 时间：2012-09-01T16:27:58.213
> 
> 标签：android, imageview, r.java-file, findviewbyid

我的 main.xml 文件中有一个 imageView，最初没有使用源设置。我希望能够在代码中动态更改图像资源。所以让我有这样的imageView设置：

```
 <ImageView
            android:id="@+id/countryImage"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:contentDescription="@string/CountryImageContent"/> 
```

所以我尝试像这样在我的代码中访问：

```
ImageView img = (ImageView) findViewById(R.id.countryImage); 
```

问题就在这里。Eclipse 给我一个错误，说“countryImage 无法解析或不是字段”。快速查看我的 R.java 文件显示 imageView 实际上并不存在。为什么会这样？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:32:04.277

如果有任何错误，请查看您的可绘制对象和布局

如果没有尝试清理你的项目

转到项目>清理>选择您的项目

如果没有，请查看您的进口商品

your.packagename.R 删除它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:30:06.483

**项目 -> 清理。**

这是解决这个问题的唯一方法。

还要确保在你的导入语句中，你**没有**这个：`import android.R`

检查此[链接](http://www.mybringback.com/travis-android-help/1/hello-world/)以获取详细过程。

注意：我假设您的布局和可绘制文件中没有错误，因为它们中的错误也可能导致此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:37:44.487

确保所有资源文件只有小写字母、数字和下划线字符（“_”）。

只有在创建 R 文件（在“gen”文件夹中）没有错误的情况下，您才能使用它的 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T18:53:47.780

我认为给出名字是个问题`@string`

请删除所有大写字符 `@string/CountryImageContent`并用小字符替换。

R.java 文件不支持任何大写字符。当您声明任何资源的文件名时，它会给出相同的错误：- `Image, XML, @string, etc..`。

只需重`CountryImageContent`命名`country_image_content`. 它会完美运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-07T09:22:42.533

在这种情况下尝试的另一个选项是：**文件 --> 使缓存无效/重新启动...**

# java - 验证构造函数和设置器中的字段是否被认为是错误的冗余代码？

> ID：12229457
> 
> 赞同：6
> 
> 时间：2012-09-01T16:28:23.547
> 
> 标签：java, coding-style, getter-setter

我有以下课程：

```
public class Project {

    private int id;
    private String name;  

    public Project(int id, String name) {
        if(name == null ){
            throw new NullPointerException("Name can't be null");
        }

        if(id == 0 ){
            throw new IllegalArgumentException("id can't be zero");
        }

            this.name = name;
            this.id = id;

    }

    private Project(){}

    public int getId() {
        return id;
    }

    public void setId(int id) { 
        if(id == 0 ){
            throw new IllegalArgumentException("id can't be zero");
        }
        this.id = id;
    }

    public String getName()
        return name;
    }

    public void setName(String name) {
        if(name == null ){
            throw new NullPointerException("Name can't be null");
        }
        this.name = name;
    }

} 
```

如果您注意到 setName 和 setId 与构造函数共享其字段的相同验证。这个冗余代码是否会在将来导致问题（例如，如果有人编辑 setter 以允许 0 为 id 并阻止 -1 但没有更改构造函数）？. 我是否应该使用私有方法进行检查并在构造函数和设置器之间共享它，如果有很多字段，这似乎太多了。

注意：这就是为什么我不在构造函数中使用设置器的原因。[https://stackoverflow.com/a/4893604/302707](https://stackoverflow.com/a/4893604/302707)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:42:13.613

这是修改后的代码：

```
public class Project {

    private int id;
    private String name;  

    public Project(int id, String name, Date creationDate, int fps, List<String> frames) {

        checkId(id);
            checkName(name);
            //Insted of lines above you can call setters too.

            this.name = name;
            this.id = id;

    }

    private Project(){}

    public int getId() {
        return id;
    }

    public void setId(int id) { 
        checkId(id);
        this.id = id;
    }

    public String getName()
        return name;
    }

    public void setName(String name) {
            checkName(name);
        this.name = name;
    }

    private void checkId(int id){
       if(id == 0 ){
            throw new IllegalArgumentException("id can't be zero");
        }
    }

    private void checkName(String name){
            if(name == null ){
            throw new NullPointerException("Name can't be null");
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:30:27.980

我建议您应该为每个字段定义一个方法`isValid()`，然后在您的 setter 和 Constructor 中调用相同的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T16:35:14.237

如果您使`Project`不可变，它将消除冗余代码。但是现在，我认为在构造函数和 mutator 方法中显式抛出异常是可以的。

由于很多原因，我不会在构造函数中调用 mutator 方法，包括[this](https://stackoverflow.com/questions/3404301/whats-wrong-with-overridable-method-calls-in-constructors)。另外，我会删除访问器方法中的验证代码......这不是必需的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T16:34:37.103

我会说是的。而不是这样，只需从构造函数中调用设置器：

```
public Project(int id, String name, Date creationDate, int fps, List<String> frames) {
    setName(name);
    setId(id);
    // other stuff with creationDate, fps and frames?
} 
```

此外，您不应该检查空值-`name`在. 否则，错误将很难追踪——您希望在无效名称出现时立即捕获它，而不是在使用它时（可能要晚得多）。`getName``setName`

# ruby - Ruby在recv时检测套接字关闭

> ID：12229466
> 
> 赞同：1
> 
> 时间：2012-09-01T16:30:07.837
> 
> 标签：ruby, sockets

我有一个 ruby​​ 套接字客户端连接到将随时关闭连接的服务器。这是我的代码：

```
@conn = TCPSocket.new address[0], address[1]
while xml = @conn.recv(4096)
  // do something
end 
```

如何在这里检测到套接字关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T10:11:53.463

您可能已经为自己回答了这个问题，但为了记录......

recv 方法阻塞，直到至少有一个字节可用，或者套接字关闭。因此，您可以循环直到 recv 返回空字符串：

```
@conn = TCPSocket.new address[0], address[1]
while true
  xml = @conn.recv(4096)
  break if xml.empty?
  // do something
end 
```

# r - 复制（）在data.table，R

> ID：12229467
> 
> 赞同：1
> 
> 时间：2012-09-01T16:30:09.740
> 
> 标签：r, data.table

`data.table`在我对 a 进行子集化并将返回值分配给另一个之后，我试图通过引用分配一列`data.table`（玩具示例）：

```
> x <- data.table(a=1:10, b=11:20, c=21:30)
> x
     a  b  c
 1:  1 11 21
 2:  2 12 22
 3:  3 13 23
 4:  4 14 24
 5:  5 15 25
 6:  6 16 26
 7:  7 17 27
 8:  8 18 28
 9:  9 19 29
10: 10 20 30
> y <- x[a==1 | a == 2, list(a,b,c)]
> y[,d:=a+b]
Error in `[.data.table`(y, , `:=`(d, a + b)) : 
  It appears that at some earlier point, names of this data.table have been reassigned.     Please ensure to use setnames() rather than names<- or colnames<-. Otherwise, please report     to datatable-help. 
```

我不完全理解这个问题：返回`y`的只是一个“视图”到相同的内存中`x`，因此`copy` `x`在通过引用设置列之前应该这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T01:20:11.527

无法使用 R 2.15.1 中的 data.table 1.8.2 重现错误：

```
> x <- data.table(a=1:10, b=11:20, c=21:30); x
     a  b  c
 1:  1 11 21
 2:  2 12 22
 3:  3 13 23
 4:  4 14 24
 5:  5 15 25
 6:  6 16 26
 7:  7 17 27
 8:  8 18 28
 9:  9 19 29
10: 10 20 30
> 
>  y <- x[x$a==1 | x$a == 2, list(a,b,c)]
> 
> y
   a  b  c
1: 1 11 21
2: 2 12 22

> y[,d:=a+b]
   a  b  c  d
1: 1 11 21 12
2: 2 12 22 14 
```

# javascript - 从回调内部填充对象

> ID：12229468
> 
> 赞同：0
> 
> 时间：2012-09-01T16:30:10.910
> 
> 标签：javascript, node.js, mongoose

很简单，可以从回调内部填充对象符号吗？

被诅咒的 javascript 闭包！

```
var symbols = {};
markets.find(function(err, markets) {
   for(var market in markets) {
     symbols[markets[market].symbol] = markets[market].label;
   }
});

console.log(symbols); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:40:46.530

[async/waterfall](https://github.com/caolan/async#waterfall)是解决这个问题的正确方法。由于 .find() 是异步的，你也可以做一个 forEach ：

```
markets.forEach(function(m) {
  symbols[m.symbol] = m.label;
}); 
```

# php - PHP中用于流控制的Switch vs Classes

> ID：12229471
> 
> 赞同：1
> 
> 时间：2012-09-01T16:30:30.303
> 
> 标签：php, oop, control-flow, procedural-programming

最近，我写了一个简单的 Web 应用程序。我目前有。

*   提供 html 标记和我需要的资源的静态页面
*   与服务器通信并在客户端呈现响应的 javascript 路由处理机制。

对于我需要操作的每个对象，服务器都提供了一个 php 脚本，在`/app/object.php`该脚本中接受 POST 数据并返回 JSON 结果。

例如（不是实际响应）：

```
POST /app/comments.php?a=add&page_id=43&author=A&text=Some%20Text
{"s":"OK"}

POST /app/comments.php?a=list&page_id=43
[{ "author": 'A', "text": "Some text"}, { "author": "B", "text": "Other text"}]

POST /app/users.php?a=list
["A", "B", "C"] 
```

在引擎盖下 JSON api 是这样实现的：

```
//comments.php
require('init.php'); 
// start sessions, open database connections with data in config.php

switch(POST('a')){
case "list":
    //.... retrieving data
    echo json_encode($data)
break;
case "add":
    //.... inserting data
    echo '{"s":"OK"}';
break;
} 
```

最大的对象有 7 个方法和 200 个（缩进良好，未压缩）的 LOC，而平均每个对象大约有 3 个方法。

我的一位开发者朋友建议用对象替换开关，使其“更简单”、“更可扩展”和“更可维护”。

坦率地说，我不知道这样的系统如何变得更简单（尤其是通过使用对象），但我很想知道其他开发人员的意见。

忽略在 PHP 中使用对象的性能影响，我应该使用基于类的方法吗？

**如果是**，我如何构建我的 JSON API 以使用对象，而不添加太多代码（从而降低项目的可维护性）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T16:42:14.783

```
<?php

class Controller {
  protected $post;
  public function __construct() {
     $this->post = $post;
  }
  public function __call($name, $arguments) {
    if(!method_exists($this, $name)) {
      die("Unknown action!");
    }
  }
  public function whatever() {
    echo json_encode($this->post['page_id']);
  }
  public function data() {
    echo '{"s":"OK"}';
  }
  // new action? just add another method
}

$controller = new Controller();
$controller->{$_POST('a')}(); // example 1

$controller->data(); // you can't do it using switch 
```

1.  易于添加新方法
2.  易于维护
3.  您可以随时触发您的方法
4.  代码很整洁
5.  这真的是很常见的做法

# c++ - 对于正值，int(doubleValue) 是否保证小于或等于 doubleValue

> ID：12229472
> 
> 赞同：0
> 
> 时间：2012-09-01T16:30:51.973
> 
> 标签：c++, floating-point, integer, type-conversion

我知道应该避免这种情况，但不幸的是我必须在混合计算中使用整数和浮点（双精度）。标题已经说明了这个问题：只要没有溢出，无论数值如何，以下代码是否保证可以与所有 c++ 浮点实现一起工作（无断言）？

编辑：忘了提到价值观总是积极的

```
double realSplit = seg.squareLength() / sqr(maxLength);
int split = realSplit; 
assert(realSplit-split >= 0.0); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T16:38:05.310

将浮点值转换为整数值会丢弃小数部分。对于大于或等于 0 的值，您的断言成立。对于小于 0 的值，则相反。

# java - 从子类中的抽象类扩展嵌套类并使方法使用嵌套类的新定义

> ID：12229473
> 
> 赞同：2
> 
> 时间：2012-09-01T16:31:01.817
> 
> 标签：java, abstract-class, nested-class

我有一个基本抽象类，里面有一个嵌套类。在其中一个子类中，我需要扩展嵌套类，但从基类继承的抽象方法需要嵌套类的基类定义（用于返回类型和参数）。我怎样才能让他们使用嵌套类的新定义？此外，非抽象方法（我没有覆盖）也不能正常工作（在我将它们移到抽象类之前它们工作得很好）。

```
abstract class Base {
    protected class Nested{
        ....
    }
    protected abstract Nested someMethod();
    protected void anotherMethod(Nested x){
        ......
    }
}
class Derived {
    class Nested extends Base.Nested {
        ....
    }
    protected Nested someMethod() {
        ......
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:34:19.563

我认为最好的方法是声明一个`protected`可选的抽象工厂方法来创建`Nested`类。

像这样的东西：

```
abstract class Base {
    protected class BaseNested {
        ....
    }
    protected abstract BaseNested newNested();
}

class Derived extends Base {
    class DerivedNested extends BaseNested {
        ....
    }

    protected BaseNested newNested() {
       return new DerivedNested();
    }
} 
```

然后，当您的基类想要一个 new`BaseNested`时，它会调用`newNested`而不是`new DerivedNested()`.

如果由于某种原因您`Derived`只需要处理`Derived.Nested`这些方法，而不是`Base.Nested`（您应该仔细评估该决定），那么您可以使用泛型。键入`Base`它处理的嵌套类的类型：

```
abstract class Base<T extends BaseNested> {
    protected abstract T newNested();
    protected abstract T someMethod();
    protected void anotherMethod(T nested) {
        //...
    }
}

class Derived extends Base<DerivedNested> {
    protected DerivedNested newNested() {
       return new DerivedNested();
    }
    //...
} 
```

# jquery - css 或 jquery 选择器排除孩子

> ID：12229475
> 
> 赞同：0
> 
> 时间：2012-09-01T16:31:14.857
> 
> 标签：jquery, css

如何在这里选择标题而不是副标题：

```
<h1 id="banner">
This is the Title 
<span id="subtitle">and the subtitle</span>
</h1> 
```

我想做类似的事情

```
h1 < span#subtitle {font-weight:bold} 
```

或者

```
h1:not(#subtitle) {font-weight:bold} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:37:05.570

要仅提取标题文本而不是副标题，请使用以下命令：

```
var text = $("#banner").contents().filter(function () {
  if (this.nodeType == 3) { // Text Node
    return this;
  }        
})[0]; 
```

**[演示](http://jsfiddle.net/3zL27/)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:34:02.593

见[http://jsfiddle.net/PhSBE/](http://jsfiddle.net/PhSBE/)

只需使用

```
#banner{font-weight:bold} /* Title's rules */
#banner>#subtitle{font-weight:normal} /* Subtitle's rules */ 
```

**编辑：**

如果你想提取文本，你可以看到[https://stackoverflow.com/a/12135377/1529630](https://stackoverflow.com/a/12135377/1529630)

这是一个从元素中提取文本的函数，忽略 HTML 元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T16:34:20.267

如果你改成`h1`粗体，你需要改成`span`普通，因为子元素是从父母那里继承css的

如果你想`This is the Title`只为它创建一些属性，你需要`<span>`为它创建另一个。

# ruby-on-rails - Apache+Passenger == HAProxy + Mogrel 服务器（M/M/C 队列）

> ID：12229476
> 
> 赞同：2
> 
> 时间：2012-09-01T16:31:16.577
> 
> 标签：ruby-on-rails, passenger, thin, mongrel

我最近阅读了 SoundCloud Team 的一篇很棒的博文。这篇文章讨论了软件架构演进。

[http://backstage.soundcloud.com/2012/08/evolution-of-soundclouds-architecture/](http://backstage.soundcloud.com/2012/08/evolution-of-soundclouds-architecture/)

在**“负载分配和一点队列理论”**部分中，Sean Treadway 谈到了队列理论以及如何更好地使用队列。

他写了：

> 我们想要一个从不排队的系统，但如果它确实排队，排队的等待时间是最短的。将 M/M/c 模型发挥到极致，我们问自己“如何才能让 c 尽可能大？”</p>
> 
> 为此，我们需要确保单个 Rails 应用程序服务器一次不会收到多个请求
> 
> 我们将 HAProxy 添加到我们的基础架构中，将每个后端配置为最大连接数 > 1，并在所有主机上添加我们的后端进程，通过将 HTTP 请求排队到任何后端来获得美妙的 M/M/c 减少 > 驻留等待时间任何主机上的进程变为可用

显然，他们正在使用 HAProxy + Rails 服务器（可能是 Mongrel）。好的，HAProxy 对传入请求进行排队，并且仅在可用时分派给 Mogrel/Thin。

也许我完全错了；），但是 Apache + Passenger 做同样的事情，对吗？一个队列（Apache 处理传入请求）和 C Workers（子进程）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T16:34:54.413

Apache + Passenger 确实将传入请求分发到机架后端（除非请求引用静态资源，Apache 自己处理）。

只要单个主机可以运行所有（！）机架实例，此模型就可以工作。当您需要更多实例时，apache 无法再处理它，您必须在上面放置一些东西（通常是 HAProxy）。但是，Apache 的功能远不止提供基于机架的应用程序。所以用更轻量级的东西（例如 nginx）替换它是有意义的，特别是因为你为你拥有的每台主机部署一次。

我希望这会有所帮助。

# verilog - 为什么还需要将输出网络重新声明为“wire”或“reg”？

> ID：12229477
> 
> 赞同：4
> 
> 时间：2012-09-01T16:31:33.047
> 
> 标签：verilog

为什么我们必须采用与输出相同的变量名并连线来获取值？例如：

```
 module TEST(INP1,INP2,CIN,COUT,SUM);
 input [31:0] INP1;
 input [31:0] INP2;
 output [31:0] SUM;
 input CIN;
 output COUT;

 wire [31:0] SUM;// Again redefined 
 wire COUT; // Again Redefined
 assign {COUT,SUM} = INP1 + INP2 + CIN ; 
```

获取两个数字的进位和总和以及将进位作为输入的示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T23:18:34.180

**Verilog 1995**确实要求在后面列出端口方向。输出线类型是隐式的，并且可以将 regs 声明为与方向一致。

```
module TEST(A,B,C,D);
  input  [31:0] A;
  input  [31:0] B;
  output [31:0] C;
  output        D;

  reg D; 
```

可以写成：

```
module TEST(A,B,C,D);
  input      [31:0] A;
  input      [31:0] B;
  output     [31:0] C;
  output reg        D; //Only declared twice 
```

自**Verilog 2001**以来，不再需要额外的定义，并且可以将它们声明为内联（ANSI 样式）。

```
module TEST(
  input      [31:0] A,
  input      [31:0] B,
  output     [31:0] C,
  output reg        D  // Declared Once
); 
```

从**SystemVerilog** (2009) 开始，我们有了逻辑类型，您不再需要在 reg 和 wire 类型之间切换。唯一的要求是，如果您需要三态使用wire 或tri。

```
module TEST(
  input        [31:0] A,
  input        [31:0] B,
  output logic [31:0] C,
  output logic        D
); 
```

我对具有 reg 和 wire 类型的最初要求的理解是为了仿真速度或仿真器设计的简易性。每个模拟增量周期都会评估导线的值，而仅在由敏感度列表触发时评估 reg。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T02:03:37.817

没有必要将 an`output`也声明为`wire`。此外，您可以通过使用 ANSI 风格的端口声明来避免重复端口列表：

```
module TEST (
    input [31:0] INP1,
    input [31:0] INP2,
    output [31:0] SUM,
    input CIN,
    output COUT
);

    assign {COUT,SUM} = INP1 + INP2 + CIN ;
endmodule 
```

在您的示例中，您不需要将输出声明为`reg`. 但是，如果您需要另一个电路，您可以在同一行声明类型，例如：

```
output reg [31:0] Q; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-01T20:45:50.403

因为仅将网络声明为`output`并不能描述它是`reg`类型还是`wire`类型。

输出可以由电线或 reg 驱动，您必须告诉它驱动程序将是什么类型。

# android - 更改实际 Spinner 按钮对象的字体大小

> ID：12229481
> 
> 赞同：4
> 
> 时间：2012-09-01T16:32:09.743
> 
> 标签：android, text, size, spinner

我知道可以更改单击按钮时弹出的 Spinner 菜单的字体大小，并且我知道可以更改普通按钮的字体大小 - 但我似乎找不到任何关于更改的内容**实际微调按钮本身的文本**大小。这可能吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T16:39:38.870

这是来自 simple_spinner_item.xml 的通用布局，我`textSize`在底部添加了一个属性，让我们将其保存为 spinner_item.xml：

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    style="?android:attr/spinnerItemStyle"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ellipsize="marquee"
    android:singleLine="true" 
    android:textSize="36sp" /> 
```

您可以像使用适配器中的任何其他布局一样使用它：

```
Spinner spinner = (Spinner) findViewById(R.id.spinner);
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.spinner_item, list);
adapter.setDropDownViewResource(android.R.layout.spinner_dropdown_item);
spinner.setAdapter(adapter); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:36:53.650

*除了您*放在那里的内容外，没有“实际微调按钮本身中的文本” 。*您*`Spinner`通过您的设置方式`SpinnerAdapter`（例如，通过提供给构造函数和的布局文件）确定了在关闭和打开状态下出现在 中的布局`setDropDownViewResource()`。如果您想更改有关这些布局的任何内容，则需要更改布局资源或更改您的`SpinnerAdapter`.

# jsf-2 - h:SelectOneMenu onchange 事件不起作用

> ID：12229482
> 
> 赞同：0
> 
> 时间：2012-09-01T16:32:12.610
> 
> 标签：jsf-2, onchange, selectonemenu

我有两个 oneSelectMenu 根据登录详细信息加载了默认值，然后第二个 selectonemenu 应该根据第一个 selectonemenu 的 onchangeEvent 菜单加载值。我尝试在 onchange 事件之前清除默认值，但该值仍然存在并且不适用于 onchange 事件。

```
<h:selectOneMenu id="blS" value="#{BoardAction.serviceAreaId}" >
<f:ajax event="valueChange" render="blSearchFacilityInput" listener="#{BoardAction.svaValueChangeEvent}"/> 
 <f:selectItems value="#{BoardAction.serviceAreaList}" var="c"  itemLabel="#{c.svaCode}" itemValue="#{c.id}"/> </h:selectOneMenu>

 <h:selectOneMenu id="blSearchFacilityInput" value="#{BoardAction.facilityId}">                                                         <f:ajax event="valueChange" render="blSearchSectorInput" listener="#{BoardAction.facValueChangeEvent}"/> 
<f:selectItems value="#{BoardAction.svaFaciltyList}" var="c" itemLabel="#{c.facCode}" itemValue="#{c.id}"/></h:selectOneMenu> 
```

动作豆：

```
private List<FacilityEBean> svaFaciltyList=null;

public List<FacilityEBean> getSvaFaciltyList() {
svaFaciltyList = facilityBusServ.getFacilityListBySVAId(session.getLoginUser());
return svaFaciltyList;
    }

public List<FacilityEBean> svaValueChangeEvent(){
        if(svaFaciltyList!=null){
            svaFaciltyList.clear();
            svaFaciltyList=null;
        }

  svaFaciltyList = facilityBusServ.getFacilityList(Integer.parseInt(serviceAreaId));
  return svaFaciltyList;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:18:48.803

Your code logic flow is wrong. You seem to expect that input components are in some way directly bound to properties and that the ajax action listener methods can return (changed) property values. This is thus actually not true.

For example, the EL expression `#{BoardAction.serviceAreaList}` actually invokes the **getter** method for the property. In your particular case, the getter method fills the list with the results from the DB everytime. So whatever you're setting in the ajax listener method is overridden everytime by the business logic in the getter method.

Those getter methods should **not** contain business logic at all. You need to rewrite your code as follows:

```
private List<FacilityEBean> svaFaciltyList;

@PostConstruct
public void init() {
    svaFaciltyList = facilityBusServ.getFacilityListBySVAId(session.getLoginUser());
}

public void svaValueChangeEvent() {
    svaFaciltyList = facilityBusServ.getFacilityList(Integer.parseInt(serviceAreaId));
}

public List<FacilityEBean> getSvaFaciltyList() {
    return svaFaciltyList;
} 
```

# django - PostgreSQL 数据库服务器无响应

> ID：12229484
> 
> 赞同：2
> 
> 时间：2012-09-01T16:32:24.737
> 
> 标签：django, postgresql, postgresql-9.1

您如何诊断 PostgreSQL 性能问题？

我有一个基于 Django 的 webapp，在 Ubuntu 12 上使用 PostgreSQL 作为数据库后端，在重负载下，数据库似乎刚刚消失，导致 Django 接口无法访问并导致如下错误：

```
django.db.utils.DatabaseError: error with no message from the libpq

django.db.utils.DatabaseError: server closed the connection unexpectedly
    This probably means the server terminated abnormally
    before or while processing the request. 
```

奇怪的是 /var/log/postgresql 中的日志没有显示任何异常。日志 /var/log/postgresql/postgresql-9.1-main.log 显示的唯一内容是很多行，例如：

```
2012-09-01 12:24:01 EDT LOG:  unexpected EOF on client connection 
```

运行`top`表明 PostgreSQL 似乎没有消耗任何 CPU，即使`service postgresql status`表明它仍在运行。

执行“service postgresql restart”可以暂时解决问题，但一旦数据库负载过重，问题就会再次出现。

我检查了 dmesg 和 syslog，但没有看到任何可以解释问题所在的内容。我应该检查哪些其他日志？如何确定我的 PostgreSQL 服务器出了什么问题？

编辑：我的 max_connections 设置为 100。虽然我正在做很多手动交易。在手动模式下使用 PostgreSQL 阅读 Django 的 ORM 行为，看起来我可能必须显式地执行 connection.close()，而我没有这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-03T01:15:15.570

我发现这是由于 Django 的错误 Postgres 后端与多处理相结合。本质上，Django 没有正确地自动关闭它的连接，从而导致一些奇怪的行为，比如大量的“空闲事务”连接。我通过添加`connection.close()`到我的多处理启动函数的末尾并在某些引发此错误的查询之前修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:43:32.777

```
2012-09-01 12:24:01 EDT LOG:  unexpected EOF on client connection 
```

此消息显示，因此客户端出现了一些问题-可能是*libpq*的一些异常？可能存在相关问题 - 当客户端在没有正确注销的情况下挂起时，您有很多空闲连接，并且您会提前收到其他错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:44:12.557

程序 pg_ctl 有一些*可能*有帮助的选项。( `man pg_ctl`)

```
 -c
       Attempt to allow server crashes to produce core files, on platforms
       where this is possible, by lifting any soft resource limit placed
       on core files. This is useful in debugging or diagnosing problems
       by allowing a stack trace to be obtained from a failed server
       process.

   -l filename
       Append the server log output to filename. If the file does not
       exist, it is created. The umask is set to 077, so access to the log
       file is disallowed to other users by default. 
```

程序 postgres 也有一些调试选项。( `man postgres`)

```
 -d debug-level
       Sets the debug level. The higher this value is set, the more
       debugging output is written to the server log. Values are from 1 to
       5\. It is also possible to pass -d 0 for a specific session, which
       will prevent the server log level of the parent postgres process
       from being propagated to this session. 
```

在“半内部选项”部分。. .

```
 -n
       This option is for debugging problems that cause a server process
       to die abnormally. The ordinary strategy in this situation is to
       notify all other server processes that they must terminate and then
       reinitialize the shared memory and semaphores. This is because an
       errant server process could have corrupted some shared state before
       terminating. This option specifies that postgres will not
       reinitialize shared data structures. A knowledgeable system
       programmer can then use a debugger to examine shared memory and
       semaphore state.

   -T
       This option is for debugging problems that cause a server process
       to die abnormally. The ordinary strategy in this situation is to
       notify all other server processes that they must terminate and then
       reinitialize the shared memory and semaphores. This is because an
       errant server process could have corrupted some shared state before
       terminating. This option specifies that postgres will stop all
       other server processes by sending the signal SIGSTOP, but will not
       cause them to terminate. This permits system programmers to collect
       core dumps from all server processes by hand. 
```

# image - JavaFX：非 GUI 线程中的画布到图像

> ID：12229487
> 
> 赞同：12
> 
> 时间：2012-09-01T16:33:28.283
> 
> 标签：image, canvas, javafx

我必须可视化大量数据（实时）并且我使用的是 JavaFX 2.2。因此，我决定在将数据插入 GUI 线程之前对其进行“预可视化”。

在我看来，最快的方法（使用抗锯齿等）是让一些非 GUI 线程生成图像/位图，然后放入 GUI 线程（因此 UI 仍然对用户做出响应）。

但我找不到如何将 Canvas 转换为 Image 的方法，然后使用：

```
Image imageToDraw = convert_tmpCanvasToImage(tmpCanvas);

Platform.runLater(new Runnable() {

            @Override
            public void run() {
                canvas.getGraphicsContext2D().drawImage(imageToDraw, data.offsetX, data.offsetY);
            }
        }); 
```

谢谢一些有用的答案。:-)

顺便说一句：我制作了测试应用程序来显示我的问题。

```
package canvasandthreads02;

import java.util.Random;
import javafx.application.Application;
import javafx.application.Platform;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.Scene;
import javafx.scene.canvas.Canvas;
import javafx.scene.canvas.GraphicsContext;
import javafx.scene.control.Button;
import javafx.scene.image.Image;
import javafx.scene.layout.AnchorPane;
import javafx.scene.paint.Color;
import javafx.stage.Stage;

public class CanvasAndThreads02 extends Application {

@Override
public void start(Stage primaryStage) {
    Button btn = new Button();
    btn.setText("Paint");

    final AnchorPane root = new AnchorPane();
    final Canvas canvas = new Canvas(900, 800);
    canvas.setLayoutX(50);
    canvas.setLayoutY(50);
    root.getChildren().add(canvas);
    root.getChildren().add(btn);

    Scene scene = new Scene(root, 900, 800);

    primaryStage.setTitle("Painting in JavaFX");
    primaryStage.setScene(scene);
    primaryStage.show();

    btn.setOnAction(new EventHandler<ActionEvent>() {
        @Override
        public void handle(ActionEvent event) {
            System.out.println("Start painting");
            /**
             * Start Thread where some data will be visualized
             */
            new Thread(new PainterThread(canvas, new DataToPaint())).start();
        }
    });
}

private class PainterThread implements Runnable{
    private final DataToPaint data;
    private final Canvas canvas;
    public PainterThread(Canvas canvas, DataToPaint data){
        this.canvas = canvas;
        this.data = data;
    }

    @Override
    public void run() {
        long currentTimeMillis = System.currentTimeMillis();

        Canvas tmpCanvas = new Canvas(data.width, data.height);
        GraphicsContext graphicsContext2D = tmpCanvas.getGraphicsContext2D();
        graphicsContext2D.setFill(data.color;);
        for (int i = 0; i < data.height; i++) {
            for (int j = 0; j < data.width; j++) {
                graphicsContext2D.fillRect(j, i, 1, 1); //draw 1x1 rectangle
            }
        }

        /**
         * And now I need still in this Thread convert tmpCanvas to Image,
         * or use some other method to put result to Main GIU Thread using Platform.runLater(...);
         */
        final Image imageToDraw = convert_tmpCanvasToImage(tmpCanvas);

        System.out.println("Canvas painting: " + (System.currentTimeMillis()-currentTimeMillis));
        Platform.runLater(new Runnable() {

            @Override
            public void run() {
                //Start painting\n Canvas painting: 430 \n Time to convert:62
                //long currentTimeMillis1 = System.currentTimeMillis();
                //Image imageToDraw = tmpCanvas.snapshot(null, null);
                //System.out.println("Time to convert:" + (System.currentTimeMillis()-currentTimeMillis1));
                canvas.getGraphicsContext2D().drawImage(imageToDraw, data.offsetX, data.offsetY);
            }
        });     
    }
}

private class DataToPaint{
    double offsetX = 0;
    double offsetY = 0;
    Color color;
    int width = 500;
    int height = 250;

    public DataToPaint(){
        Random rand = new Random();
        color = new Color(rand.nextDouble(), rand.nextDouble(), rand.nextDouble(), rand.nextDouble());
        offsetX = rand.nextDouble() * 20;
        offsetY = rand.nextDouble() * 20;
    }
}

/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    launch(args);
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T22:14:14.650

使用 Canvas 的 snapshot(...) 方法从 Canvas 的内容创建 WritableImage。^^ 对我来说很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-11-28T16:37:51.137

我知道这是一个非常古老的问题，但只针对关心的人：现在有第二个版本的 canvas.snapshot 接受回调并异步工作！

```
public void snapshot(Callback<SnapshotResult,Void> callback,
                     SnapshotParameters params,
                     WritableImage image) 
```

# lisp - 在 Common Lisp 中删除类型

> ID：12229488
> 
> 赞同：5
> 
> 时间：2012-09-01T16:33:43.567
> 
> 标签：lisp, common-lisp

Common Lisp 是否提供了取消定义使用 [deftype](http://clhs.lisp.se/Body/m_deftp.htm)创建的类型的工具？

我在 Hyperspec 中没有找到任何关于它的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T19:15:15.343

我只是`unintern`派生类型说明符：

```
T1> (deftype foo () 'fixnum)
FOO
T1> (let ((bar 1))
      (check-type bar foo))
NIL
T1> (unintern 'foo)
T
T1> (let ((bar 1))
      (check-type bar foo))

Unknown type specifier: FOO
   [Condition of type SIMPLE-ERROR] 
```

* * *

此外，如果您真的担心出于某种原因删除该类型的每个痕迹，您始终可以编写依赖于实现的代码来实现它，即使标准中未提及此类功能。例如，在 CCL 中（未经测试，我只是略读了相关代码）：

```
(defun delete-type (derived-type-specifier)
  (ccl::clear-type-cache)
  (remhash derived-type-specifier ccl::%deftype-expanders%)
  (setf (documentation derived-type-specifier 'type) nil)) 
```

现在我们开始：

```
T1> (deftype foo () "frob" 'fixnum)
FOO
T1> (documentation 'foo 'type)
"frob"
T1> (let ((bar 1))
      (check-type bar foo))
NIL
T1> (delete-type 'foo)
NIL
T1> (documentation 'foo 'type)
NIL
T1> (let ((bar 1))
      (check-type bar foo))

Unknown type specifier: FOO
   [Condition of type SIMPLE-ERROR] 
```

# ruby-on-rails - Rails 中优雅的 API 版本控制

> ID：12229499
> 
> 赞同：6
> 
> 时间：2012-09-01T16:35:02.153
> 
> 标签：ruby-on-rails, ruby, api, versioning

目前，我正在 Rails 应用程序中为我们的 REST API 实现版本控制。有没有一种方法可以实现，所以你只在新版本中定义新功能？比如说：

我有一个用户控制器和一个产品控制器。V1 和 V2 之间的产品保持不变，但用户发生了变化。如果我们可以设置它，这样当我调用 V2 产品时，我的应用程序知道它不存在并简单地使用最新的控制器版本（在本例中为 V1），那就太好了。这将使我们不必为每个版本都创建一套全新的控制器；我们只会为已更改的特定功能创建新控制器。

下面是我们 Routes.rb 的一个片段，诚然我不知道如何解决这个问题。任何帮助将不胜感激！

```
namespace :api do
    scope module: :v1, constraints: ApiConstraints.new(version: 1) do
      resources :users
      resources :products
    end
    scope module: :v2, constraints: ApiConstraints.new(version: 2) do
      resources :users
    end 
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T18:18:23.723

我曾经使用过相同的策略并且最近改变了方法——我承认我有偏见，因为我也是我们的[VersionCake](https://github.com/bwillis/versioncake)新方法的作者之一。

这种方法是仅对我们的有效负载或视图进行版本控制，毕竟视图是客户端之间的合同，如果有违反合同的更改，则需要更改版本。在 VersionCake 中，您可以像这样对视图进行版本控制：

```
app/views/products/show.v1.rabl
app/views/products/show.v2.rabl
app/views/users/show.v1.rabl 
```

根据您的问题，重要的特定功能是 VersionCake 将优雅地降级到最新的支持版本。鉴于上面的示例，请求`users/1.json`版本 2 的客户端将收到`users/show.v1.rabl`.

话虽如此，它需要采用新的版本控制方法，所以它可能不是最好的答案，但我认为这是一个值得考虑的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:43:07.870

你已经看过[葡萄](https://github.com/intridea/grape)了吗？

我对我所构建的 API 所做的事情是，当所有这些 API 发生变化时（如身份验证），我只是让它们全部从特定版本的 API 控制器继承，并在`Api::V1::BaseController`其中放置常见的行为和控件。

由于更改 API 通常也意味着更改表示，因此使用为您生成表示的工具也非常重要，因此有很多宝石：

*   [RABL](https://github.com/nesquena/rabl)
*   [怒吼](https://github.com/apotonick/roar)
*   [Jbuilder](https://github.com/rails/jbuilder)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T16:43:26.607

这就是[Grape](https://github.com/intridea/grape)的设计初衷。

此外，您可以选择将 API 挂载到您的 routes.rb 文件中或将其映射到 config.ru 中，绕过 Rails 堆栈并大大提高 API 的性能。

# jquery - Jquery 可折叠面板 - 回发问题

> ID：12229500
> 
> 赞同：0
> 
> 时间：2012-09-01T16:35:03.937
> 
> 标签：jquery, asp.net

我需要在脚本中进行一些修改，但由于我对 jquery 不太友好，所以无法这样做

当页面回发时，我想保持面板的状态。现在，如果我刷新页面，所有面板都已折叠，

我正在使用下面的代码

```
$(document).ready(function() {
    $(“DIV.ContainerPanel > DIV.collapsePanelHeader > DIV.ArrowExpand”).toggle(function() {
        $(this).parent().next(“div.Content”).show(“slow”);
        $(this).attr(“class”, “ArrowClose”);
    },function() {
        $(this).parent().next(“div.Content”).hide(“slow”);
        $(this).attr(“class”, “ArrowExpand”);
    });
}); 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:28:27.203

该答案将完全符合您的要求，我不知道您在创建什么，或者回发的原因-但您可能会发现最好的方法是消除回发并处理它 ajax jQuery ，这将阻止所有解决您遇到的问题并创建更快、更友好的用户体验。

我不知道你在做什么或者你可能有什么安全问题，但如果可以的话，看看 ajax ，那是一大堆代码，只是为了记住页面状态

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:54:27.197

您要求的是记住当前打开的面板。

由于此面板不是本机 asp.net 控件，因此 asp.net 不会在回发时记住该值。

一种解决方案是在容器中保留一个隐藏的输入控件，并在该输入中维护当前打开的 div 的值。

然后，即使在回发时，Asp.net 也会接收并发送回这些数据。

在准备好文档后，您可以通过读取此值重新打开打开的面板。

**编辑：**添加了一些代码

从您的选择器中，我假设您的 html 看起来像这样。

```
<div class="ContainerPanel">
    <div class="collapsePanelHeader">
        <div class="ArrowExpand"">

        </div>
    </div>
    <div id="content1" class="Content"">

    </div>
    <div class="collapsePanelHeader">
        <div class="ArrowExpand"">

        </div>
    </div>
    <div id="content2" class="Content"">

    </div>
    <input id="selectPanel1" runat="server" class="selectPanel"/>
</div> 
```

我为每个内容块添加了一个 ID。如果您没有 ID，则必须添加它们才能使此代码正常工作。

请注意 ContainerPanel 底部的输入标记。这将需要记住哪个 div 是打开的。asp.net 要求每个元素都有唯一的 id 标签。

```
<input id="selectPanel1" runat="server" class="selectPanel"/> 
```

js会是这样的：

```
$(document).ready(function() {
    $("div.ContainerPanel > div.collapsePanelHeader > div.ArrowExpand").toggle(function() {
        $(this).parent().next("div.Content").show("slow");
        $(this).attr("class", "ArrowClose");
        //Put the id of the selected content into an input
        //This is so that it goes to the server
        var inputBox = $(this).parent().parent().find(".selectPanel");
        inputBox.val("#" + $(this).parent().next("div.Content").attr("id"));
    },function() {
        $(this).parent().next("div.Content").hide("slow");
        $(this).attr("class", "ArrowExpand");
    });
    //This supports multiple ContainerPanel divs.
    $("div.ContainerPanel").each(function(e){
        //retrive value of div open before postback and show it
        var selectedContentId = $(this).find(".selectPanel").val();
            if(selectedContentId != "")
            $(selectedContentId).show();
    }); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T03:31:40.170

在过去的两天里，我用自己的代码处理了这个挑战。我需要能够从 jQuery 或 Code behind 甚至从展开/折叠图标展开或折叠九个不同的面板，并将回发保持在最低限度。我还需要在输入时捕获每个文本框、ddl、复选框值。

我的解决方案是一个与 jQuery 交互并在会话中管理结构的 Web 服务。然后，后面的代码和 jQuery 代码可以与 Web 服务共享数据。

我在结构中保留的一组值是一个标志，它告诉我面板是展开还是折叠。

尽管这对您的问题来说可能是多余的，但该解决方案的灵活性非常强大。通过将大块数据定义为单个类结构，我可以在 1-3 行代码中读取和更新任何内容。

# php - 从 Swiffy 动画代码中读取 PHP var

> ID：12229506
> 
> 赞同：2
> 
> 时间：2012-09-01T16:35:54.227
> 
> 标签：php, html, google-swiffy

我刚刚制作了一个 Flash 动画并将一个动态 URL 放在一个 AS2 按钮中......然后我使用 SWIFFY 将动画导出为 HTML 5，如果我在将扩展名更改为 php 后从原始 Swiffy 文件中调用 URL，它工作正常，但是我文档的开头部分太大了，你知道 swiffy 将图像转换为代码 ant 东西太大了：

[因此，我尝试将 swiffy 代码移动到外部 js 文件，这就是问题所在，所以我尝试使用 href http://mysite.com/index?myvar=var](http://mysite.com/index?myvar=var)将 swiffi 文件放入 Iframe 中，结果总是相同在 url 上获取 php 标签和 $var，在 Google 中进行了两个小时的搜索，但没有找到我的问题的答案。

```
 http://mysite.com/index?myvar=<?= $var ?> 
```

代替：

```
 http://mysite.com/index?myvar=var 
```

Swiffy 代码显示如下：

```
 {"body":[{"value":"document.php?myvar=<?=$var;?>","type":305} 
```

是的，我进行了搜索，两个小时后决定发布问题

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T15:31:21.133

Swiffy 常见问题解答 [https://www.google.com/doubleclick/studio/swiffy/faq.html](https://www.google.com/doubleclick/studio/swiffy/faq.html)

说（转述）：

> 您可以在 URL 中将参数传递给您的 Swiffy 文件，例如 ?{variableName}=http://www.google.com，或者在 Swiffy 输出中插入以下代码片段，就在调用 stage.start() 之前：

或者在调用 stage.start(); 之前使用这样的 JS；

```
stage.setFlashVars("{variableName}=http://www.google.com"); 
```

在您的 ActionScript 代码或 Flash 时间轴中，将分配给 _root 或 _level0 对象：

```
_root.{variableName} or _{variableName} 
```

我现在没有时间做一个测试用例，但这应该根据文档工作。

# unit-testing - VS2012 - 添加测试丢失？

> ID：12229509
> 
> 赞同：6
> 
> 时间：2012-09-01T16:36:36.080
> 
> 标签：unit-testing, visual-studio-2012

在 VS 2010 中，我可以右键单击一个方法并让 MSTest 为我创建一个单元测试。VS2012 pro的这个功能在哪里？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-01T18:22:46.217

命令还在。转到工具->选项->环境->键盘。搜索 createunittests 的快捷方式。相应的命令出现在对话框中。只需为其分配一个键盘快捷键即可使用。使用您创建的快捷方式后，其工作方式与 VS2010 完全相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-05T12:03:05.513

刚才我自己也遇到了这个。这是解释： [http ://connect.microsoft.com/VisualStudio/feedback/details/748493/missing-funtionality-of-creating-a-new-unit-test-from-editor](http://connect.microsoft.com/VisualStudio/feedback/details/748493/missing-funtionality-of-creating-a-new-unit-test-from-editor)

“'New Test' 菜单没有任何可以插入 3rd 方适配器的扩展点。因此我们决定将其删除。我们将所有 New Test Project 类型移至 File -> New -> Project 对话框中。”

所以它似乎被删除了，因为它只是为 MSTest 制作的，现在它们支持几个开箱即用的框架。但我仍然想念它......应该能够默认为MSTest och NUnit......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T09:18:35.897

应在 FILE 菜单中选择`Add`not`New`项以将测试项目添加到当前解决方案中。

以下步骤复制自[演练：为托管代码创建和运行单元测试](http://msdn.microsoft.com/en-us/library/ms182532.aspx)

创建单元测试项目：

1.  在“文件”菜单上，选择“添加”，然后选择“新建项目...”。

2.  在“新建项目”对话框中，展开“已安装”，展开“Visual C#”，然后选择“测试”。

3.  从模板列表中，选择单元测试项目。

希望它有帮助。

# objective-c - UIButton点击没有响应

> ID：12229513
> 
> 赞同：4
> 
> 时间：2012-09-01T16:37:13.893
> 
> 标签：objective-c, ios, cocoa-touch

我添加了一个新的 UIButton

```
 UIButton *newButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [newButton setFrame:CGRectMake(x, y, width, height)];
    [newButton setTitle:@"" forState:UIControlStateNormal];
    [newButton setTag:x+INDEX_OFFSET];
    [newButton setBackgroundImage:image forState:UIControlStateNormal];
    [newButton addTarget:self action:@selector(buttonPressed) forControlEvents:UIControlEventTouchUpInside];

    [self addSubview:newButton];
    [self bringSubviewToFront:newButton]; 
```

我可以在屏幕上看到它，但它没有响应点击手势。它应该调用“buttonPressed”。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T16:58:24.100

可能的问题之一是您将按钮添加到其父视图之外的框架位置。只是为了轻松检查它，尝试`clipToBounds`在其超级视图边界中将属性设置为 YES，然后运行应用程序。如果您没有看到按钮，则表示您将按钮位置设置为超视位置，这就是它不响应触摸的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-16T07:37:44.690

另一个可能的问题是，如果您将`UIButton`as a添加`subview`到 an `UIImageView` *(您不应该这样做，但它确实有效)*。在这种情况下，您可以将其添加到 a`UIView`或将`UIImageView`的`userInteractionEnabled`属性设置为`YES`。

# android - 是否需要将 onDestroy() 方法放入每个活动？

> ID：12229514
> 
> 赞同：0
> 
> 时间：2012-09-01T16:37:13.517
> 
> 标签：android, android-activity

是否总是需要节省手机内存？我想知道，这样我就可以优化我目前正在开发的 android 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:38:19.780

> 是否需要将 onDestroy() 方法放入每个活动？

不，您继承了一个默认实现`onDestroy()`，它将处理由活动本身创建的内容的清理。`onDestroy()`如果您创建了要清理的其他内容，您将覆盖，并且您确定等待`onDestroy()`是正确的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:44:02.767

您的 Activity 始终在扩展系统`Activity`类，它也实现了所有“核心”方法（并且您通常会覆盖`onCreate()`，因为您只需要设置一些东西，例如 Activity 的布局。所以除非您做一些更复杂的事情（例如，您在`onCreate()`) 您不需要编写自己的`onDestroy()`。如果是上述侦听器，您应该取消注册您的侦听器，`onDestroy()`否则其他代码将尝试与不再存在的对象通信并出现崩溃。请注意，如果您要创建自己的`onDestroy()`实现，您有在您的实现中`super.onDestroy()`作为**最后一**件事调用（这是扩展构造函数/析构函数类似方法时的通用规则）。

# java - 将布尔数组初始化为 false

> ID：12229516
> 
> 赞同：30
> 
> 时间：2012-09-01T16:37:21.100
> 
> 标签：java, arrays

我在下面有这段代码。如何初始化每个元素 = false？

```
boolean[] seats = new boolean[10] 
```

我看到了一个类似的问题。但是，第二行对我来说没有意义（你能解释一下第二行吗？）。

```
 Boolean[] array = new Boolean[size];
 Arrays.fill(array, Boolean.FALSE); 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-01T16:38:31.457

a 中元素的默认值为`boolean[]`false。你不需要做任何事情。

之所以需要，`Boolean[]`是因为默认值为`null`.

* * *

要初始化为 true，请使用接受 a的[重载](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#fill%28boolean%5b%5d,%20boolean%29)。`Arrays.fill``boolean[]`

```
boolean[] seats = new boolean[10];
Arrays.fill(seats, true); 
```

在线查看它：[ideone](http://ideone.com/pvoFP)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T16:40:19.507

A默认`boolean`初始化为`false`。所以你不需要在这里做任何具体的事情。当您创建一个布尔数组并且不对其进行初始化时，所有元素都将是`false`.

> 那么如何将其初始化为 True 呢？

简单的`Arrays.fill(array, Boolean.TRUE);`

# git - git commit 自动更新最新内容？

> ID：12229518
> 
> 赞同：-1
> 
> 时间：2012-09-01T16:37:38.097
> 
> 标签：git

我知道`git add`命令会使文件处于“暂存”状态。如果我更改暂存文件的内容，**我应该`git add`再次更新索引中的内容。**

这个概念来自书本。但是颠覆不需要这样做。所以我只是`git commit`为了说服。

我发现内容在`git add`正常提交后发生了变化。那么，这意味着`git commit`即使没有`git add`?

为什么书上说我们应该`git add`再次更新分阶段文件中的更改内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:41:05.730

有两种可能。

您运行了`git commit -a`它将在提交之前自动暂存修改过的文件。

您提交了对文件的*部分*修改。演示：在 1 处修改文件，`git add`它。然后在不同的地方再次修改文件，当你运行时，`git status`你会在“staged”区域和“unstaged”区域看到相同的文件。然后，如果您运行`git diff --cached`，您可以看到执行时将提交的分阶段更改`git commit`。如果您运行`git diff`，您可以看到不会提交的未暂存更改。

# web-services - Weblogic 10.3.5 中的 jax-ws：IllegalAnnotationsException：2 个 IllegalAnnotationExceptions 计数

> ID：12229523
> 
> 赞同：2
> 
> 时间：2012-09-01T16:38:29.663
> 
> 标签：web-services, jaxb, weblogic, jax-ws, jaxb2

我们在 Weblogic 10.3.5 中部署了一个测试 Web 应用程序。Web 应用程序包含一个 servlet，它使用 jax-ws 调用部署在同一 weblogic 中的 Web 服务。访问 servlet 会引发以下异常：

```
Two classes have the same XML type name "address". Use @XmlType.name and @XmlType.namespace to assign different names to them.
this problem is related to the following location:
    at com.sun.xml.ws.developer.MemberSubmissionEndpointReference$Address
    at public com.sun.xml.ws.developer.MemberSubmissionEndpointReference$Address com.sun.xml.ws.developer.MemberSubmissionEndpointReference.addr
    at com.sun.xml.ws.developer.MemberSubmissionEndpointReference
this problem is related to the following location:
    at javax.xml.ws.wsaddressing.W3CEndpointReference$Address
    at private javax.xml.ws.wsaddressing.W3CEndpointReference$Address javax.xml.ws.wsaddressing.W3CEndpointReference.address
    at javax.xml.ws.wsaddressing.W3CEndpointReference 
```

我将 servlet 的逻辑复制到一个通用的 java 类中，然后运行它。测试成功。所以问题应该出在Web应用程序上。

我尝试了很多方法，修改 weblogic-application.xml 以添加如下所示的 prefer-application-packages 部分，但仍然不起作用。

```
<prefer-application-packages>
    <package-name>javax.xml.ws.*</package-name>
    <package-name>javax.xml.bind.*</package-name>
    <package-name>javax.jws.*</package-name>
    <package-name>javax.namespace.xml.*</package-name>
    <package-name>javax.xml.soap.*</package-name>
    <package-name>org.apache.xerces.*</package-name>
    <package-name>org.apache.commons.*</package-name>
    <package-name>com.sun.xml.*</package-name>
</prefer-application-packages> 
```

任何人都可以帮助我，在这个错误上花了几天时间，一点进展都没有。感谢您提前回复一百万。

**更新 1**

在web应用中，我们不想用metro，直接用从java.net下载的jax-ws，把jaxws-rt.jar、jaxws-api.jar、jaxb等相关jar放到ear/APP -INF/库。

WebLogic Classloader Analysis Tool (wls-cat) 告诉有一些类冲突，并建议在weblogic-application.xml 中添加prefer-application-packages。所以我们添加了 prefer-application-packages 来告诉 weblogic 从我们的应用程序加载它们，而不是从 weblogic jax-ws/metro 实现。

但还是不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:04:07.600

问题可能来自您想在 Weblogic 中使用 Metro JaxWs，它有自己的实现，称为 Oracle JaxWS（基于 Metro）。

这是一个链接，其中解释了如何将 Metro 与 Weblogic 一起使用：http: [//metro.java.net/guide/ch02.html#weblogic-10](http://metro.java.net/guide/ch02.html#weblogic-10)

如果您不使用 Metro 并依赖 Oracle JaxWS，则不必使用首选库或任何特殊包装。

# c# - 如何将对象数组从 javascript 传递到服务器

> ID：12229530
> 
> 赞同：0
> 
> 时间：2012-09-01T16:39:37.290
> 
> 标签：c#, javascript, jquery, asp.net-mvc-3

我正在从 javascript 到 MVC 控制器进行 ajax 调用，将对象数组传递给控制器​​操作。

**JS代码：**

```
function Constructor(p1, p2) {
    this.foo = p1;
    this.bar = p2;
}

var Obejct_Array = new Array();

Obejct_Array[Obejct_Array.length] = new Constructor("A", "B");
Obejct_Array[Obejct_Array.length] = new Constructor("C", "D");

$.post("/_Controller/_Action", { ObjectArray : Obejct_Array }); 
```

**C# 代码**

```
public Class Example
{
  public string foo { get; set; }
  public string bar { get; set; }
  public string Prop3 { get; set; }
}

 //Action in Controller
 public void _Action(Example[] ObejctArray)
 {
  //Here the size of ObjectArray is 2 but the properties are all null. Whats the problem ?
 } 
```

javascript 数组中的两个条目都传递给控制器​​的操作方法，但属性值显示为 null。谁能告诉我这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:43:26.420

您必须使用[JSON](http://www.json.org)来执行此操作。根据您`Constructor`班级的实际代码，这将在 Javascript 方面为您提供类似的内容：

```
[{"foo":"A", "bar":"B"}, {"foo":"C", "bar":"D"}] 
```

这是具有属性的 2 个对象数组的 JSON 表示形式`foo`和`bar`.

在服务器端，您必须将 JSON 结构转换回实际的对象结构。当然有图书馆（我不是 C# 人，所以我不知道）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:24:49.213

如果您使用的是 MVC，您可以传递您的数组数据，这样它将直接绑定到您的操作方法中的数组参数。MVC 将期望数据如下：

```
// in js
var data = {
    // could also put the name of the parameter before each [0/1] index
    "[0].foo": "A",
    "[0].bar": "B",
    "[1].foo": "C",
    "[1].bar": "D"
};

// a js function to put the data in this format:
function (array, prefix) {
    var prefixToUse = prefix || "",
        data = {},
        i, key;
    for (i = 0; i < array.length; i++) {
        for (key in array[i]) {
            // might want to do some filtering here depending on what properties your objects have
            data[prefixToUse + "[" + i + "]." + key] = array[i][key];
        }
    }

    return data;
} 
```

# c# - 无法对 ListBox 的选定项使用索引

> ID：12229532
> 
> 赞同：0
> 
> 时间：2012-09-01T16:39:44.333
> 
> 标签：c#, listbox

我有这个：

```
string curr = "";
if (emails.SelectedItem != null)
{
  for (int i = 0; i <= 19; i++)
  {
    curr = (emails.SelectedItem.ToString()[i] + "." + 
            emails.SelectedItem.ToString()[i + 1]);
    clone.Items.Add(curr);
  }
} 
```

但是，每当我运行它时，它都会给我“索引超出数组范围”错误。

为什么？解决方法是什么？

另外，如何让它添加字符串的其余部分（不仅仅是 i + 1）来克隆？

代码说明：

我正在尝试在单词的一个字母后插入句点 (.)，然后将其添加到克隆中。之后，我想在第二个字母之后添加一个句点，添加到克隆，第三个字母之后的句点，添加等等......

但是，我不想让它成为`t.h.i.s.i.s.t.h.e.n.a.m.e`，我希望它一次只有一个时期。

它应该看起来像：

> a.nimatter
> an.timatter
> ant.imatter
> anti.matter
> 等...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:00:19.257

```
if (emails.SelectedItem != null)
{
    var item = emails.SelectedItem.ToString();
    for (int i = 1; i < item.Length; i++)
    {
         clone.Items.Add(item.Insert(i, "."));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:02:43.120

试试这个

```
if (emails.SelectedItem != null) {
    string text = emails.SelectedItem.ToString();
    for (int i = 1; i < text.Length; i++) {
        string textWithPeriod = text.Substring(0, i) + "." + text.Substring(i);
        clone.Items.Add(textWithPeriod); 
    }
} 
```

# python - 在类中的所有实例方法自动调用之后调用方法：元类还是装饰器？

> ID：12229536
> 
> 赞同：2
> 
> 时间：2012-09-01T16:40:03.023
> 
> 标签：python, oop, decorator, metaclass

假设我有一堂课

```
class Foo:
    def __init__(self):
        pass
    def meth1(self, *args):
        do_stuff()
    def meth2(self, **kwargs):
        more_stuff()
    def callme(self):
        print "I'm called!" 
```

我想巧妙地修改它，以便`callme()`在执行之后调用它`meth1`，`meth2`以及其他所有内容。我怎么做？我从来没有使用过类装饰器或元类，所以我不确定哪种方法是正确的，以及如何正确使用它们。

对于元类，我整理了以下内容：

```
from types import FunctionType
def addcall_meta(name, bases, dct):
    newdct = dict(dct)
    for k, v in dct.items():
        if isinstance(v, FunctionType) and k not in ('__metaclass__', 'callme'):
            # the above can include more filters such as not startswith, etc.
            print k, 'is a function!'
            def newmethod(self, *args, **kwargs):
                v(self, *args, **kwargs)
                dct['callme'](self)
            newdct[k] = newmethod
    return type(name, bases, newdct) 
```

使用类装饰器：

```
def addcall_deco(cls):
    dct = {}
    for k, v in cls.__dict__.items():
        if isinstance(v, FunctionType) and k != 'callme':
            def newv(self, *args, **kwargs):
                v(self, *args, **kwargs)
                self.callme()
            cls.k = newv
    return cls 
```

两者似乎都适用于我的超级简单示例：

```
In [75]: Foo()
I'm called!
Out[75]: <__main__.Foo instance at 0x21ed680> 
```

**是否有明显的理由使用一个而不是另一个（例如特定的极端情况等）？**我也认为我可以以某种方式使用`__new__`，但从常识的角度来看，我想修改类，而不是它的所有实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:46:16.493

旧版本的 Python 不支持类装饰器，因此如果考虑向后兼容性，则需要使用元类或将类装饰器转换为包装类的函数调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:29:19.763

实际上，您在这里使用元类作为类装饰器 - 并不真正需要元类允许的更灵活的东西。

因此，两种实现都是相同的，您应该使用更简单的方法——即类装饰器。至于“向后兼容性” - 这不是您在新项目中应该担心的问题。

当然，由于“长期支持”版本，很多服务器都在运行一些非常旧的 Linux，并且具有 2.4 或 2.5 的 Python 版本 - 但如果您的项目确实在这么旧的服务器中使用，那么用户始终可以像普通用户一样安装更新到足以支持 Python 的 Python - 无需使用系统 Python。

附带说明：请注意您的包装器，如果有的话，您将丢弃包装的方法返回值。这样做的方法是：

```
 def newv(self, *args, **kwargs):
      result = v(self, *args, **kwargs)
      self.callme()
      return result 
```

最后，如果您认为在您处理的任何项目中都非常需要这种方法，请查看“[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)” - 有几个项目允许在 Python 中使用面向方面的方法，而无需您的工具链或工作方式发生了许多变化。

# xslt-1.0 - 结合深节点

> ID：12229537
> 
> 赞同：1
> 
> 时间：2012-09-01T16:40:11.190
> 
> 标签：xslt-1.0, xslt-2.0

我有点坚持如何最好地使用以下 XML 示例：我所拥有的是以下内容：

```
<Story>
<Content para="div"><local>This is some (normal) text to start with.</local></Content>
<Content para="div"><local>Connect something (</local></Content>
<Content para="div"><local><refnr value="58236"/></local></Content>
<Content para="div"><local>) to something else (</local></Content>
<Content para="div"><local><refnr value="58237"/></local></Content>
<Content para="div"><local>), and make sure it's connected to this (</local></Content>
<Content para="div"><local><refnr value="58239"/></local></Content>
<Content para="div"><local>).</local></Content>
<Content para="div"><local>If that's ok do the same with this (</local></Content>
<Content para="div"><local><refnr value="58238"/></local></Content>
<Content para="div"><local>) also.</local></Content>
<Content para="div"><local>This is some normal text.</local></Content>
<Content para="div"><local>This also.</local></Content>
</Story> 
```

我想得到的输出如下：

```
<Story>
<Content para="div"><local>This is some (normal) text to start with.</local></Content>
<Content para="div"><local>Connect something (<refnr value="58236"/>) to something else (<refnr value="58237"/>), and make sure it's connected to this (<refnr value="58239"/>).</local></Content>
<Content para="div"><local>If that's ok do the same with this (<refnr value="58238"/>) also.</local></Content>
<Content para="div"><local>This is some normal text.</local></Content>
<Content para="div"><local>This also.</local></Content>
</Story> 
```

或者，要对其进行“编码”：任何以左括号结尾的 [Content para=div][local] 节点都需要与以下 [Content para=div][local] 节点合并，直到包含最后一个右括号的节点和句子的结尾（由结束点标识）。我能够做一些事情，但它变得过于复杂和缓慢，并且没有所有想要的结果。使用 xslt2 有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:21:03.610

我认为您需要嵌套两种方法：

```
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="2.0">

<xsl:output indent="yes"/>

<xsl:template match="Story">
  <xsl:copy>
    <xsl:for-each-group select="Content" group-adjacent="contains(., '(') or contains(., ')') or boolean(self::Content[local[refnr]])">
      <xsl:choose>
        <xsl:when test="current-grouping-key()">
          <xsl:for-each-group select="current-group()" group-ending-with="Content[local[ends-with(., '.')]]">
            <Content para="div">
              <local>
                <xsl:copy-of select="current-group()/local/node()"/>
              </local>
            </Content>
          </xsl:for-each-group>
        </xsl:when>
        <xsl:otherwise>
          <xsl:copy-of select="current-group()"/>
        </xsl:otherwise>
      </xsl:choose>
    </xsl:for-each-group>
  </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

使用该样式表和您的示例输入，我得到了您发布的结果。但是，我不确定我使用的条件对于实际输入是否过于简单，例如，报告是否可以存在包含`refnr`元素的“正常”文本。

[编辑] 使用`matches`as

```
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="2.0">

<xsl:output indent="yes"/>

<xsl:template match="Story">
  <xsl:copy>
    <xsl:for-each-group select="Content" 
      group-adjacent="not(matches(., '\(.*\)')) 
                       or boolean(self::Content[local[refnr]])">
      <xsl:choose>
        <xsl:when test="current-grouping-key()">
          <xsl:for-each-group select="current-group()" group-ending-with="Content[local[ends-with(., '.')]]">
            <Content para="div">
              <local>
                <xsl:copy-of select="current-group()/local/node()"/>
              </local>
            </Content>
          </xsl:for-each-group>
        </xsl:when>
        <xsl:otherwise>
          <xsl:copy-of select="current-group()"/>
        </xsl:otherwise>
      </xsl:choose>
    </xsl:for-each-group>
  </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

我认为编辑后的输入样本会根据需要进行转换。当然，一旦你有例如`<Content para="div"><local>Connect (foo) something (</local></Content>`，这种方法也太简单了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:46:51.037

**这个 XSLT 2.0 转换**（可以很容易地转换为 XSLT 1.0）：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <Story>
   <xsl:apply-templates select="Content[1]/local"/>
  </Story>
 </xsl:template>

 <xsl:template match="Content/local[not(ends-with(., '('))]">
  <Content para="div"><local><xsl:apply-templates/></local></Content>
  <xsl:apply-templates select="../following-sibling::Content[1]"/>
 </xsl:template>

 <xsl:template match="Content/local[ends-with(., '(')]">
  <Content para="div"><local><xsl:apply-templates/>
   <xsl:apply-templates mode="inGroup" select="../following-sibling::Content[1]"/>
  </local></Content>

  <xsl:apply-templates select=
   "../following-sibling::Content
             [local[starts-with(.,')') and ends-with(.,'.')]][1]
               /following-sibling::Content[1]"/>
 </xsl:template>

 <xsl:template match="Content/local" mode="inGroup">
    <xsl:apply-templates/>
    <xsl:apply-templates mode="#current"
         select="../following-sibling::Content[1]"/>
 </xsl:template>

 <xsl:template mode="inGroup" match="Content/local[starts-with(.,')') and ends-with(.,'.')]">
  <xsl:apply-templates/>
 </xsl:template>

 <xsl:template match="refnr"><xsl:copy-of select="."/></xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<Story>
 <Content para="div"><local>This is some (normal) text to start with.</local></Content>
 <Content para="div"><local>Connect something (</local></Content>
 <Content para="div"><local><refnr value="58236"/></local></Content>
 <Content para="div"><local>) to something else (</local></Content>
 <Content para="div"><local><refnr value="58237"/></local></Content>
 <Content para="div"><local>), and make sure it's connected to this (</local></Content>
 <Content para="div"><local><refnr value="58239"/></local></Content>
 <Content para="div"><local>).</local></Content>
 <Content para="div"><local>If that's ok do the same with this (</local></Content>
 <Content para="div"><local><refnr value="58238"/></local></Content>
 <Content para="div"><local>) also.</local></Content>
 <Content para="div"><local>This is some normal text.</local></Content>
 <Content para="div"><local>This also.</local></Content>
</Story> 
```

**产生想要的正确结果**：

```
<Story>
   <Content para="div">
      <local>This is some (normal) text to start with.</local>
   </Content>
   <Content para="div">
      <local>Connect something (<refnr value="58236"/>) to something else (<refnr value="58237"/>), and make sure it's connected to this (<refnr value="58239"/>).</local>
   </Content>
   <Content para="div">
      <local>If that's ok do the same with this (<refnr value="58238"/>) also.</local>
   </Content>
   <Content para="div">
      <local>This is some normal text.</local>
   </Content>
   <Content para="div">
      <local>This also.</local>
   </Content>
</Story 
```

# sql - SQL 2005 比较日期保存为 VARCHAR

> ID：12229540
> 
> 赞同：-4
> 
> 时间：2012-09-01T16:40:27.407
> 
> 标签：sql, sql-server-2005, date, varchar

我已在 sql server 2005 中将日期保存为 VARCHAR 现在我想选择 2013 年之前的所有日期，但我不能。

WDATE 2012 年 9 月 1 日 2012 年 8 月 13 日

我想将这些日期与我使用此查询的任何其他日期进行比较：

```
SELECT * FROM Work_Order
WHERE  WDATE  < '09/02/2012' 
```

但它减去几天然后几个月然后几年这不是我的情况

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:54:09.107

看到您更新的问题，如果您的列定义为`VARCHAR`. 您需要将其存储为一个`DATETIME`值或 CAST 它，可能像这样：

```
SELECT * 
FROM   Work_Order 
WHERE  CAST(WDATE as DATETIME)  < CAST('09/02/2012' as DATETIME) 
```

我自己没有 SQL SERVER 2005，所以语法只是猜测。

# google-chrome - 什么会导致 Chrome 浏览器扩展程序崩溃？

> ID：12229544
> 
> 赞同：9
> 
> 时间：2012-09-01T16:41:27.417
> 
> 标签：google-chrome, google-chrome-extension

我的浏览器扩展偶尔会崩溃。问题是，我找不到一个好的、全面的清单，列出可能导致扩展崩溃的事情，因此很难创建一个可以处理的事情清单。

我的假设是，任何导致标准 Chrome 选项卡崩溃的东西都会导致扩展在 Background.html 文件中运行时崩溃。

在我的脑海中，我假设以下可能会导致问题......

*   无限循环或脚本的其他实例变得无响应
*   未捕获的异常（例如，没有 try/catch 的 JSON.parse）
*   数据库存储错误
*   资源使用过多 (??)

这真的是我能想到的。我正在尝试调试我的扩展，非常感谢任何帮助创建清单...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-03T17:52:19.380

我在问这个问题大约 3 个月后回到这个问题，因为我的第二次扩展也崩溃了。不过，在这种情况下，扩展要简单得多—— background.js 脚本中只有大约 40 行代码。

2 个操作似乎是罪魁祸首：写入 localStorage 并使用 console.log

我之前观察到，如果您长时间保持页面打开，则可能会通过在网站中对大型对象反复使用 console.log 来使正常的 chrome 选项卡崩溃。因为 background.js*总是*打开的，所以这里似乎是罪魁祸首。

**tl;dr 不要在生产环境中使用 console.log。曾经。**

# c++ - listfunction 没有按预期工作

> ID：12229548
> 
> 赞同：0
> 
> 时间：2012-09-01T16:41:56.143
> 
> 标签：c++, oop, vector, switch-statement

我正在尝试列出成分向量。

类成分只有 2 个成员和 2 个成员函数（构造函数除外）。它包含一个名称和一个类别，它具有返回名称的函数“getName”和返回类别的“getCategory”。然后将这些成分存储在矢量柜中。

这是应该列出内阁内容的代码：

```
for(int i = 0; i < cabinet.size(); i++)
{
   cout << cabinet[i].getName();
   switch(cabinet[i].getCategory())
   {
      case 1: cout << "Alcohol" << endl;
              break;
      case 2: cout << "Liqueur" << endl;
              break;
      case 3: cout << "Brew" << endl;
              break;
      case 4: cout << "Non alcohol" << endl;
              break;
      case 5: cout << "Wine" << endl;
              break;
   }
} 
```

我得到了什么：

```
[first ingredient][second ingredient][thrid ingredient]...etc 
```

那么，为什么我的 switch 语句不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T16:56:56.710

谢谢您的帮助！我尝试添加`default: cout << cabinet[i].getCategory();`，发现我不小心将它存储为一个字符。修复了添加功能，现在它可以工作了。再次感谢您的帮助！

# javascript - 关于使用 image.src 进行统计的问题

> ID：12229549
> 
> 赞同：0
> 
> 时间：2012-09-01T16:41:56.143
> 
> 标签：javascript, gif, usage-statistics

当我使用 image.src 在 1x1 gif 上发出请求时，我遇到了一个问题。但是当我使用 chrome 和 safari 时，请求无法登录到我的网络服务器。但是，当我使用 javascript 延迟一些微秒（比如说 300 毫秒）时，它就可以工作了。有谁知道更好的解决方案，而不是使用 300 毫秒延迟（因为它使我的点击变慢）？

我的 javascript 看起来像这样

```
/* Event Capture */
function eventCapture(et,ep,eid,eurl) {     
  var ec=new Image();
  ec.src=cp+cd+cu
  +"&et="+escape(et)
  +"&ep="+escape(ep)
  +"&ei="+escape(eid)
  +"&eu="+escape(eurl)+_do+_vo
  +"&cb="+new Date().getTime();   
} 
```

有谁知道reqson？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:01:19.127

一种可能性是图像立即被垃圾收集，因为没有对图像变量的持久引用`ec`。但是，当您执行 a 时`setTimeout()`，它会创建一个闭包，使变量持续足够长的时间。

您可以测试这个仅在图像实际加载之前创建临时关闭的解决方案以查看它是否解决了问题：

```
/* Event Capture */
function eventCapture(et,ep,eid,eurl) {     
  var ec=new Image();
  ec.onload = function() {
      ec = null;
  }

  ec.src=cp+cd+cu
  +"&et="+escape(et)
  +"&ep="+escape(ep)
  +"&ei="+escape(eid)
  +"&eu="+escape(eurl)+_do+_vo
  +"&cb="+new Date().getTime();   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:54:28.437

你是如何设置延迟的？如果你只是打电话

```
setTimeout("javascript function",milliseconds); 
```

在事件捕获并将延迟放在那里，它不应该阻塞页面的其余部分，并且能够一次处理多次点击，因为每次调用都会调用一个独立于其余部分的新 setTimeout。

就您的代码而言，我假设变量`cp, cd, and cu`是在其他地方全局定义的？如果在第一次调用脚本时未定义某些内容，Chrome 会`ReferenceError`在您创建`src`图像字符串时抛出一段时间，这可能是导致一切都失败的原因。

# php - 仅在从 PHP 上传到 FTP 后 ZIP 存档才会损坏

> ID：12229553
> 
> 赞同：-1
> 
> 时间：2012-09-01T16:42:14.630
> 
> 标签：php, file-upload, ftp, zip, corruption

**编辑：**这完全描述了我的问题，但我无法用 PHP 克服它：http: [//kb.winzip.com/kb/entry/149](http://kb.winzip.com/kb/entry/149)

我正在用 PHP 编写一个自动备份脚本，它会制作我网站文件和数据库的备份副本，并将这些文件发送到远程 FTP 站点以进行灾难恢复。我的 SQL 和 ZIP 文件（My SQL 没有双关语）在服务器上完美生成，但是，当我的 ZIP 存档上传到 FTP 站点时，它会损坏。

我从生成它的服务器下载了 ZIP 文件，打开它没问题。但是，一旦将同一个文件传输到 FTP 站点并从那里下载，似乎没有 ZIP 提取程序能够打开相同的文件。我可以打开我的 SQL 文件没有问题。

我很确定存档没问题，但是错误在于文件的传输：

```
$conn_id = ftp_connect("ftp.example.com");
$login_result = ftp_login($conn_id, "johnny1", "Re@l1y $tr0nG P@5swOrd!");
$dbBackup = fopen('database-backup.sql', 'r');
$filesBackup = fopen('files-backup.zip', 'r');

if (ftp_fput($conn_id, 'database/backup.sql', $dbBackup, FTP_BINARY) && 
    ftp_fput($conn_id, 'files/backup.zip', $filesBackup, FTP_BINARY)) {
  echo "Done!<br>";
} else {
   echo "Failed";
   exit;
}

ftp_close($conn_id);
fclose($dbBackup);
fclose($filesBackup); 
```

从这里可以看到的 ZIP 文件的传输有什么问题吗？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:54:30.913

我已经在我的 Ubuntu 系统上测试了你的代码，它没有问题。
这可能是 FTP 服务器的问题；您应该尝试将文件上传到另一台 FTP 服务器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T16:51:08.797

您可以尝试以二进制模式打开您的 zip 文件。[推荐](http://php.net/manual/en/function.fopen.php)。

> 为了可移植性，强烈建议您在使用 fopen() 打开文件时始终使用“b”标志。

```
fopen('files-backup.zip', 'rb'); 
```

# sorting - JSF2/Primefaces dataTable 排序不适用于 ViewScoped bean

> ID：12229561
> 
> 赞同：2
> 
> 时间：2012-09-01T16:43:28.633
> 
> 标签：sorting, jsf-2, datatable, primefaces

我想将排序添加到 PrimeFaces 3.3 dataTable 并创建以下 ViewScoped bean 来存储列表，因此它不会一直从 EJB 中获取：

```
@Named
@ViewScoped
public class CustomerList implements Serializable {

    private static final long serialVersionUID = 6168621124401208753L;

    @EJB 
    CustomerEJB customerBean;

    List<Customer> allCustomers = null;

    public void loadCustomerList() {
        allCustomers = customerBean.findAll();
    }

    public List<Customer> getList() {
        if (allCustomers == null) {
            loadCustomerList();
        }
        return allCustomers;
    }

} 
```

这是使用 bean 的视图：

```
<ui:composition template="/WEB-INF/templates/template.xhtml">

  <ui:define name="content">

        <h:form id="customerList">

          <p:dataTable id="customer" var="customer"
            value="#{customerList.list}" sortBy="#{customer.id}"
            paginator="true" rows="10" paginatorAlwaysVisible="false"
            paginatorPosition="top">
            <p:column sortBy="#{customer.id}">
              <f:facet name="header">
                <h:outputText value="#{msg.customerIdLabel}" />
              </f:facet>
              <h:outputText value="#{customer.id}" />
            </p:column>
            <p:column sortBy="#{customer.lastName}">
              <f:facet name="header">
                <h:outputText value="#{msg.customerLastNameLabel}" />
              </f:facet>
              <h:outputText value="#{customer.lastName}" />
            </p:column> 
```

问题是我可以单击列标题进行排序，但表格仍然未排序，即使初始排序也不起作用。当您在 getList() 方法中设置断点时，我可以看到在处理请求期间从 EJB 中多次获取列表。只要 ViewScope 处于活动状态，不应该存储 bean 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T05:54:47.057

首先，与您的问题没有直接关系，但是：您永远不应该将您的业务方法放入组件获取器中（即使使用空检查，我认为这是一种不好的做法）。请改用 @PostConstruct 注释：

```
@PostConstruct
public void loadCustomerList() {
    allCustomers = customerBean.findAll();
}

public List<Customer> getList() {
    return allCustomers;
} 
```

每次构造 ViewScoped bean 时都会调用 loadCustomerList。另外，检查您的导入以获取范围注释：

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped; 
```

最后你的课应该是这样的：

```
@ViewScoped
@ManagedBean
public class CustomerList implements Serializable {
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:48:40.903

`@ViewScoped`CDI 不支持，所以如果你需要`@ViewScoped`在 CDI 中使用，你应该

*   使用[seam-faces](http://seamframework.org/Seam3/FacesModule)或[MyFaces CODI](http://myfaces.apache.org/extensions/cdi/download.html)模块。只需将其中一个添加到您的类路径中即可`@ViewScoped`在 CDI 中工作。MyFaces CODI 对@ViewScoped 的支持更加稳固
*   使用 MyFaces CODI's `@ViewAccessScoped`，它是 Apache 在 CDI 之上编写的扩展，只需[下载](http://myfaces.apache.org/extensions/cdi/download.html)它并使用`@ViewAccessScoped`注释而不是`@ViewScoped`.
*   使用 CDI`@ConversationScoped`并使其长期运行。请参阅[此处了解更多信息](http://www.andygibson.net/blog/tutorial/pattern-for-conversational-crud-in-java-ee-6/)。

不幸的是，seam3 解决方案存在内存泄漏问题，所以不要使用 seam3 解决这个特殊问题，更好的解决方案是 CODIs `@ViewAccessScoped`。

请参阅：[ViewScoped bean 的内存泄漏？](https://stackoverflow.com/questions/12182844/memory-leak-with-viewscoped-bean)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-27T08:49:35.493

你需要使用这个 Annotation Bean 组合：

对于@ManagedBean，您需要使用@ViewScoped

对于@Named (CDI) 你需要使用@ConversationScoped

# mysql - 使用 Ruby on Rails 创建新数据库

> ID：12229564
> 
> 赞同：0
> 
> 时间：2012-09-01T16:43:53.203
> 
> 标签：mysql, ruby-on-rails-3

有没有办法在 ROR 应用程序中自动创建新数据库。

我要做的是为每个注册我的网站的新用户创建一个新数据库。因此，如果新用户注册成功，将创建一个包含一些空表的新数据库。

新用户将获得一个新数据库，新数据库将是其中相同的表，但每个用户将存储的信息将不同。

我认为我需要这个的原因是如果用户不再想使用我的系统，我可以向他们提供他们存储在我的数据库中的信息，然后轻松删除数据库和表

我正在寻找的是类似于 mysql_create_db() 在 php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:12:35.657

你不认为你正在使一个简单的系统变得复杂吗？你的思维方式是不可扩展的。例如，如果您有成千上万的用户，您必须创建相同数量的数据库表！大多数表格可能没有用。这绝对是荒谬的……

如果您只想实现以下目标

*   每个用户都有自己的数据。
*   用户可能想要导出数据。
*   如果用户关闭他的帐户，您将删除他的所有数据

那么您最好将整体视为具有单个数据库的单个应用程序。相应地设计您的数据库，并更好地寻找 Rails 的最佳 DRY 实践来实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:21:18.510

这不是将用户存储在关系数据库中的好方法，尤其是在使用像 ruby​​ on rails 这样的应用程序框架时，这*取决于*您的以下约定而不是配置。

拥有一个用户模型并使用 Devise 和 Cancan gem 来管理角色和权限。没有必要在这里重新发明轮子，这就是它要做的事情。

如果还有其他考虑因素，例如尺寸或性能，请详细说明。你给出的理由（易于管理）不是走这条路的好理由。

这是一个有趣的想法，并且在其他领域也有使用，但对于您的标准用户表来说真的不是很好。

# linq - Linq 扩展方法 - 如何包含未加载的对象？

> ID：12229565
> 
> 赞同：1
> 
> 时间：2012-09-01T16:43:53.717
> 
> 标签：linq, entity-framework, ef-code-first

我有这样的事情：

```
var threads = _forumsDb.ForumsAccounts
.Where(a => a.UserName == User.Identity.Name)
.SelectMany(u => u.Threads); 
```

但是这些线程实体具有与之关联的帖子实体，由于延迟加载而未加载。如果我做这样的事情：

```
var threads = _forumsDb.ForumsAccounts
.Include("Posts")
.Where(a => a.UserName == User.Identity.Name)
.SelectMany(u => u.Threads); 
```

它显然不起作用，并且那些线程实体仍然有空的 Posts 实体。我怎样才能正确地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:51:25.813

您不能申请`Include`投影（`Select`或`SelectMany`）中的属性。您需要扩展投影以将帖子作为附加属性包含在内：

```
var threads = _forumsDb.ForumsAccounts
    .Where(a => a.UserName == User.Identity.Name)
    .SelectMany(u => new
    {
        Threads = u.Threads,
        ThreadPosts = u.Threads.Select(t => t.Posts)
    })
    .AsEnumerable()
    .SelectMany(a => a.Threads)
    .ToList(); 
```

`Thread`如果和之间的关系`Post`是一对多 EF 将填充`Posts`线程的集合。

如果您在实体上有一个逆`ForumAccount`属性，查询会容易得多：`Thread`

```
var threads = _forumsDb.Threads
    .Include("Posts")
    .Where(t => t.ForumAccount.UserName == User.Identity.Name)
    .ToList(); 
```

在这种情况下，急切加载`Include`将起作用。

# java - Java没有调用组件的重载paintComponent方法

> ID：12229568
> 
> 赞同：7
> 
> 时间：2012-09-01T16:44:09.520
> 
> 标签：java, swing, paint, repaint

首先，这是创建马赛克图像生成器的家庭作业的一部分。我希望程序在找到图像并将其放置在另一个（源图像）之上时实时重新绘制。

这是在我的主要功能中创建面板的代码。

最后一块 mypanel.create() 是马赛克逻辑。

```
myPanel = new mosiacPanel(sourceFile, sizePercent, pixesize,threads, imageList);
//test.setText(Integer.toString(myPanel.getWidth()));
JFrame frame2 = new JFrame("COS 226 MOSIAC OF AWESOMENESS BY SLUIPMOORD && ELEANORASAURUSS");
myPanel.setVisible( true );
myPanel.repaint();
frame2.add(myPanel);
if(myPanel.getWidth() > menubar.getWidth()){
    frame2.setSize(myPanel.getWidth() , myPanel.getHeight() + menubar.getHeight() );
    frame2.repaint();
} else {
    frame2.setSize(menubar.getWidth() , myPanel.getHeight() + menubar.getHeight() );
}
frame2.setVisible( true );
//  myPanel.setLocation(170, 4);
myPanel.create(); 
```

马赛克面板类代码片段

```
public void create()
{
    ph.createMosiac(imgUrls, this);
}

@Override
protected void paintComponent( Graphics g ) 
{  super.paintComponent(g); 
   g.drawImage( imgToPaint, 0, 0, null );
   // System.out.println("paint");
}

public void paintTile( BufferedImage img ) 
{

    imgToPaint = img;        
    this.repaint();
    // this.paintComponent(this.getGraphics());
} 
```

我在创建马赛克函数中调用了paintTile 函数。

```
public void createMosiac(List<String> fileNames, mosiacPanel parent)
{
    ArrayList<TileImage> srcTiles = new ArrayList<TileImage>();

    for( int i = 0; i < fileNames.size(); i++ ) 
    {
        srcTiles.add( new TileImage( fileNames.get(i), tileSize ) );
    }

    for( int y = 0; y <= (this.getHeight() - tileSize); y += tileSize ) 
    {           
        for( int x = 0; x <= (this.getWidth() - tileSize); x += tileSize ) 
        {
            int location = 0;
            double  dist, high = 2147483647;
            for( int i = 0; i < srcTiles.size(); i++ ) 
            {
                dist = this.getTileImage(x, y).differance( srcTiles.get(i) );

                if( (dist < high) )
                {
                    high = dist;
                    location = i;
                }                       
            }

            this.setTileImage( x, y, srcTiles.get(location) );
            parent.paintTile(this);                   
        }            
    }                        
} 
```

这就是我的程序逻辑。当我在第二个片段中取消注释 // this.paintComponent(this.getGraphics()); 该程序可以工作，但它会以可怕的闪光重新绘制，当我在演示场地内的一些其他学生容易癫痫发作时，我不是医疗费用的人。

如果我跟踪paintComponent函数，它会在程序结束时调用两次，而不是在每次重绘时调用。

先感谢您。

我添加了一个源代码，你们可以复制并运行。选择一个你想测试的图像，默认不可用，因为你们没有它

然后是一个包含一堆jpg的目录来平铺它现在很慢我仍然需要修复 [Google docs链接到java文件](https://docs.google.com/file/d/0B1QbUvYjuQe1LUVDR1NQZlJzQms/edit)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T17:02:09.947

尝试在另一个线程中重新绘制。也许这将解决您的问题。祝你好运！:)

# php - PHP 生成的 XML 显示无效的 Char 值 27 消息

> ID：12229572
> 
> 赞同：35
> 
> 时间：2012-09-01T16:44:43.643
> 
> 标签：php, character-encoding, xml-parsing, runtime-error, tidy

我正在使用 PHP 库生成 XML，如下所示：

```
$dom = new DOMDocument("1.0","utf-8"); 
```

执行上述操作会产生一个页面，该页面在输出顶部显示一条消息。

**此页面包含以下错误： 第 16 行第 274505 列的错误：PCDATA 无效字符值 27 下面是第一个错误之前的页面呈现。**

我尝试使用 Tidy 库进行纠正.. 使用 iconv 来获取 UTF-8 中的汉字。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-09-04T14:44:20.517

> 本网站建议使用一个有用的功能来消除该错误。 [http://www.phpwact.org/php/i18n/charsets#common_problem_areas_with_utf-8](http://www.phpwact.org/php/i18n/charsets#common_problem_areas_with_utf-8)

当您将 utf-8 编码字符串放入 XML 文档时，您应该记住并非所有 utf-8 有效字符都被 XML 文档接受[http://www.w3.org/TR/REC-xml/#charsets](http://www.w3.org/TR/REC-xml/#charsets)

所以你应该去掉不需要的字符，否则你会遇到像上面这样的 XML 致命解析错误

```
function utf8_for_xml($string)
{
    return preg_replace ('/[^\x{0009}\x{000a}\x{000d}\x{0020}-\x{D7FF}\x{E000}-\x{FFFD}]+/u', ' ', $string);
} 
```

希望可以节省别人一些时间..

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-01-16T02:12:28.443

普拉尚特是绝对正确的。您还可以通过执行以下操作去除 Javascript 中的无效字符：

```
function utf8_for_xml(inputStr) {
  return inputStr.replace(/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm, '');
} 
```

# javascript - JQuery 焦点到以前单击的输入错误

> ID：12229575
> 
> 赞同：1
> 
> 时间：2012-09-01T16:45:25.670
> 
> 标签：javascript, jquery

我有两个输入字段。主要思想是，每当您关注其中一个字段时，单击按钮应在其中打印一个随机数。

我的问题是，当您只关注（单击）第一个字段，然后关注第二个（反之亦然）时，按钮单击会打印到两者，而不仅仅是（最后一个）关注的字段。

> 您可以尝试在这里重现问题：http: [//jsfiddle.net/sQd8t/3/](http://jsfiddle.net/sQd8t/3/)

**JS：**

```
$('.family').focus(function(){

var iD = $(this).attr('id');

    $("#sets").one('click',function() {

        var ra = Math.floor((Math.random()*10)+1);

        $('#'+iD).val(ra);

    });

}); 
```

**HTML：**

```
<center class='mid'>
    <input type="text" class="family" id="father" />
    <br/><br>
    <input type="text" class="family" id="mother" />

    <br/>
    <br/>
    <input type='submit' value='Set text' id="sets"/>
</center> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T16:49:33.667

在“focus”处理程序中，取消绑定任何现有的“click”处理程序：

```
$('#sets').unbind('click').one('click', function() { ... }); 
```

按照您的方式，每次字段获得焦点时都会绑定一个额外的一次性“单击”处理程序，因为 jQuery 允许您将任意数量的处理程序绑定到一个事件。换句话说，调用`.one()`不会解除绑定其他处理程序。当点击实际发生时，所有处理程序都会运行。

*编辑*——抱歉——“解除绑定”是旧 API；现在`.off()`是首选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:57:49.537

把变量 iD 放在外面，把函数分开：

[http://jsfiddle.net/sQd8t/8/](http://jsfiddle.net/sQd8t/8/)

这可以防止在每个输入单击/焦点上添加太多事件。无需解绑。

```
var iD;
$('.family').focus(function() {
    iD = $(this).attr('id');
});

$("#sets").on('click', function() {
    var ra = Math.floor((Math.random() * 10) + 1);
    if (iD!="")$('#' + iD).val(ra);
    iD = "";
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:00:41.700

见[http://jsfiddle.net/sQd8t/11/](http://jsfiddle.net/sQd8t/11/)

```
$('.family').focus(function(){

    $("#sets").attr('data-target',$(this).attr('id'))

});

$("#sets").click(function() {

    var target=$(this).attr('data-target');

    if(target){

        var ra = Math.floor((Math.random()*10)+1);

        $('#'+target).val(ra);

    }

}); 
```

您可以创建一个`data-target`包含必须修改的字段的属性。

# java - java HashMap 排序 . 如何排序？

> ID：12229577
> 
> 赞同：7
> 
> 时间：2012-09-01T16:45:26.883
> 
> 标签：java, sorting, hashmap

> **可能重复：**
> [如何对 Java 中的值对 Map<Key, Value> 进行排序？](https://stackoverflow.com/questions/109383/how-to-sort-a-mapkey-value-on-the-values-in-java)

在我的项目中，我采用了这样的 HashMap

> **HashMap 度 = new HashMap();**

假设我有：

```
degree.put("a",5);
degree.put("b",2);
degree.put("c",4);
degree.put("d",2);
degree.put("e",3);
degree.put("f",5); 
```

> 现在我必须根据给定的整数值对这个列表进行排序

排序的 HashMap 应该是：

> **{a=5, f=5, c=4, e=4, b=4, d=2}**

*我怎么能做到这一点？*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-01T16:50:00.893

A`HashMap`是一个*无序*集合。它没有排序顺序。甚至 a`TreeMap`都会按键排序，而不是按值排序。

如果要按值的排序顺序准备排序列表，则必须创建一个适当的对象，例如`ArrayList<Map.Entry<String,Integer>>`，遍历`HashMap`并插入所有条目，然后`Collections.sort`使用排序规则函数调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T16:52:36.650

如果你想要排序的地图，HashMap 不是最好的方法。

我建议看看`TreeMap`它是排序的。您可以将比较器设置为比较值而不是键，就像在此答案中所做的那样：

[https://stackoverflow.com/a/1283722/975959](https://stackoverflow.com/a/1283722/975959)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:03:24.347

```
ArrayList<Integer> sortedHashMap=new ArrayList<Integer>();

for("your Object" m : degree.values())
{
      sortedHashMap.add(m);
}

collections.sort(sortedHashMap); 
```

所以，你可以将你的 hashMap 打印为 sorted hashMap！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T16:56:36.337

您可以进行[插入排序](http://en.wikipedia.org/wiki/Insertion_sort)以从原始哈希图构建新的哈希图（占用 x2 内存并且效率非常低）。因此，您将需要使用哈希图的 .get() 和 .set() 方法几乎 n*n（最坏情况）次，其中 n 是元素的数量。

# indexing - KnockoutJS：从 JavaScript 模板中访问数组中项目的索引

> ID：12229578
> 
> 赞同：2
> 
> 时间：2012-09-01T16:45:42.390
> 
> 标签：indexing, knockout.js, ko.observablearray

我使用 KnockoutJS 从数组中填充一个列表：

```
<div data-bind:"foreach: list">
   <input type="text" data-bind="value: myText" />
</div>

function ViewModel() {
    self.list = ko.observableArray([
        new listItem("sample text")
    ]);
};

function listItem (text) {
    this.myText = text;
}; 
```

我可以像这样为输入的各个实例分配一个 id

```
<input data-bind="attr: { id: $index } ... 
```

如何从我的 listItem 函数中访问此索引？我希望能够做类似的事情

```
function listItem (text) {
    this.myText = text;
    this.index = $index;
}; 
```

以便将其用于进一步处理。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-01T18:10:04.863

您可以创建一个自定义绑定，将您的属性设置为索引，它看起来像：

```
ko.bindingHandlers.setIndex = {
    init: function(element, valueAccessor, allBindings, data, context) {
        var prop = valueAccessor();
        data[prop] = context.$index;
    }        
}; 
```

这假设您正在处理数组中的对象。你会像这样使用它：

```
<ul data-bind="foreach: items">
    <li data-bind="setIndex: 'myIndex', text: name"></li>
</ul> 
```

因此，这会将`$index`observable 复制到您指定的属性名称的对象上。示例：http: [//jsfiddle.net/rniemeyer/zGmcg/](http://jsfiddle.net/rniemeyer/zGmcg/)

您可以在绑定之外执行此操作的另一种方法（这是我以前这样做的方式`$index`）是订阅对 observableArray 的更改并每次重新填充索引。

以下是 observableArray 的扩展可能的样子：

```
//track an index on items in an observableArray
ko.observableArray.fn.indexed = function(prop) {
    prop = prop || 'index';
   //whenever the array changes, make one loop to update the index on each
   this.subscribe(function(newValue) {
       if (newValue) {
           var item;
           for (var i = 0, j = newValue.length; i < j; i++) {
               item = newValue[i];
               if (!ko.isObservable(item[prop])) {
                  item[prop] = ko.observable();
               }
               item[prop](i);      
           }
       }   
   }); 

   //initialize the index
   this.valueHasMutated(); 
   return this;
}; 
```

然后你会像这样使用它：

```
this.myItems = ko.observableArray().indexed('myIndexProp'); 
```

这是一个示例：http: [//jsfiddle.net/rniemeyer/bQD2C/](http://jsfiddle.net/rniemeyer/bQD2C/)

# php - xml节点和节点内的其他信息

> ID：12229579
> 
> 赞同：0
> 
> 时间：2012-09-01T16:45:45.620
> 
> 标签：php, xml, dom

我有一个简单的 xml 文件，其中包含节点和一些其他信息。我想从系列节点中提取索引。

XML:

```
 <record>
    <id>5055</id>
    <uuid>83885ffc-93d8-41ba-aee2-e5c0ae48fc68</uuid>
    <publisher>Now Comics</publisher>
    <size>5803436</size>
    <title sort="Terminator - The Burning Earth 5, The">The Terminator - The Burning Earth 5</title>
    <authors sort="Unknown">
      <author>Unknown</author>
    </authors>
    <timestamp>2012-05-13T19:38:03-07:00</timestamp>
    <pubdate>2012-05-13T19:38:03-07:00</pubdate>
    <series index="5.0">The Terminator: The Burning Earth</series>
    <cover>M:/Comics/Unknown/The Terminator - The Burning Earth 5 (5055)/cover.jpg</cover>
    <formats>
      <format>M:/Comics/Unknown/The Terminator - The Burning Earth 5 (5055)/The Terminator - The Burning Earth 5 - Unknown.cbr</format>
    </formats>
  </record> 
```

PHP：

```
$dom = new DOMDocument();  
$dom->load($loc);  
foreach ($dom->getElementsByTagName('record') as $e) {

$publisher = $e->getElementsByTagName('publisher')->item(0)->textContent; 
$arc = $e->getElementsByTagName('series')->item(0)->textContent;    
$uuid = $e->getElementsByTagName('uuid')->item(0)->textContent;

} 
```

现在在 xml 文件中`<series index="5.0">The Terminator: The Burning Earth</series>`我想把它拉出来`index="5.0"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:01:00.613

您使用[getAttribute()](http://php.net/manual/en/domelement.getattribute.php)方法。

```
$dom = new DOMDocument();
$dom->load($loc);
foreach ($dom->getElementsByTagName('record') as $e) {

    $publisher = $e->getElementsByTagName('publisher')->item(0)->textContent;
    $uuid = $e->getElementsByTagName('uuid')->item(0)->textContent;

    $series = $e->getElementsByTagName('series')->item(0);
    $series_index = $series->getAttribute('index');
    $arc = $series->textContent;
}

echo 'Publisher: '.$publisher.'<br />', //Now Comics
     'UUID: '.$uuid.'<br />', //UUID: 83885ffc-93d8-41ba-aee2-e5c0ae48fc68
     'Index: '.$series_index.'<br />', //Index: 5.0
     'Title: '.$arc.'<hr />'; //Title: The Terminator: The Burning Earth 
```

# python - Python：导入子包或子模块

> ID：12229580
> 
> 赞同：115
> 
> 时间：2012-09-01T16:45:51.440
> 
> 标签：python, import, module, package

已经使用了平面包，我没想到会遇到嵌套包的问题。这里是……</p>

# 目录布局

```
dir
 |
 +-- test.py
 |
 +-- package
      |
      +-- __init__.py
      |
      +-- subpackage
           |
           +-- __init__.py
           |
           +-- module.py 
```

# **init** .py的内容

`package/__init__.py`和都是`package/subpackage/__init__.py`空的。

# 内容`module.py`

```
# file `package/subpackage/module.py`
attribute1 = "value 1"
attribute2 = "value 2"
attribute3 = "value 3"
# and as many more as you want... 
```

# `test.py`（3个版本）的内容

## 版本 1

```
# file test.py
from package.subpackage.module import *
print attribute1 # OK 
```

这是导入东西的糟糕和不安全的方式（批量导入），但它有效。

## 版本 2

```
# file test.py
import package.subpackage.module
from package.subpackage import module # Alternative
from module import attribute1 
```

一种更安全的逐项导入方式，但它失败了，Python 不希望这样：失败并显示消息：“没有名为模块的模块”。不过……</p>

```
# file test.py
import package.subpackage.module
from package.subpackage import module # Alternative
print module # Surprise here 
```

……说`<module 'package.subpackage.module' from '...'>`。所以这是一个模块，但那不是一个模块 /-P 8-O ...呃

## 版本 3

```
# file test.py v3
from package.subpackage.module import attribute1
print attribute1 # OK 
```

这个有效。所以你要么被迫一直使用 overkill 前缀，要么使用版本 #1 中的不安全方式，并且 Python 不允许使用安全方便的方式？更好的方法，即安全且避免不必要的长前缀是 Python 唯一拒绝的方法？这是因为它喜欢`import *`还是因为它喜欢过长的前缀（这无助于实施这种做法）？

抱歉，我用了两天的时间来解决这种愚蠢的行为。除非我在某个地方完全错了，否则这会让我感觉 Python 的包和子包模型中确实存在某些问题。

笔记

*   我不想依赖`sys.path`, 来避免全局副作用，也不想依赖`*.pth`文件，这只是`sys.path`使用相同全局效果的另一种方式。为了使解决方案干净，它必须是本地的。要么 Python 能够处理子包，要么不能，但它不应该需要使用全局配置来处理本地内容。
*   我也尝试过在中使用导入`package/subpackage/__init__.py`，但它什么也没解决，它做同样的事情，并且抱怨`subpackage`不是一个已知的模块，而`print subpackage`说它是一个模块（再次奇怪的行为）。

可能是我完全错了强硬（我更喜欢的选项），但这让我对 Python 感到非常失望。

除了我尝试的三种方法之外，还有其他已知的方法吗？有什么我不知道的？

（叹）

----- %< ----- 编辑 ----- >% -----

# 到目前为止的结论（经过人们的评论）

在 Python 中没有什么像真正的子包，因为所有包引用都转到一个全局字典，只有，这意味着没有本地字典，这意味着没有办法管理本地包引用。

您必须使用完整前缀或短前缀或别名。如：

## 完整前缀版本

```
from package.subpackage.module import attribute1
# An repeat it again an again
# But after that, you can simply:
use_of (attribute1) 
```

## 短前缀版本（但重复前缀）

```
from package.subpackage import module
# Short but then you have to do:
use_of (module.attribute1)
# and repeat the prefix at every use place 
```

或者，上述的变体。

```
from package.subpackage import module as m
use_of (m.attribute1)
# `m` is a shorter prefix, but you could as well
# define a more meaningful name after the context 
```

# 分解版本

如果您不介意一次批量导入多个实体，您可以：

```
from package.subpackage.module import attribute1, attribute2
# and etc. 
```

不是我最喜欢的口味（我更喜欢每个进口实体有一个进口声明），但可能是我个人喜欢的。

*更新（2012-09-14）：*

最终在实践中似乎没问题，除了对布局的评论。而不是上述，我使用：

```
from package.subpackage.module import (

    attribute1, 
    attribute2,
    attribute3,
    ...)  # and etc. 
```

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-09-01T17:09:37.363

您似乎误解了如何`import`搜索模块。当您使用 import 语句时，它*总是*搜索实际的模块路径（和/或`sys.modules`）；它不使用由于先前导入而存在的本地命名空间中的模块*对象。*当你这样做时：

```
import package.subpackage.module
from package.subpackage import module
from module import attribute1 
```

第二行查找一个名为`package.subpackage`并从该包导入`module`的包。该行对第三行没有影响。第三行只是寻找一个名为的模块`module`，但没有找到。它不会“重用”`module`您从上面的行中获得的调用对象。

换句话说`from someModule import ...`，并不意味着“来自我之前导入的名为 someModule 的模块......”它的意思是“来自你在 sys.path 上找到的名为 someModule 的模块......”。没有办法通过导入通向它的包来“增量”构建模块的路径。导入时，您始终必须引用整个模块名称。

目前尚不清楚您要达到的目标。如果您只想导入特定的对象属性 1，只需执行`from package.subpackage.module import attribute1`并完成它。`package.subpackage.module`一旦您从中导入了您想要的名称，您就无需担心冗长的问题。

如果您*确实*希望以后可以访问该模块以访问其他名称，那么您可以这样做`from package.subpackage import module`，并且正如您所见，您可以随心所欲地做`module.attribute1`等等。

如果你想要*两者*——也就是说，如果你想要`attribute1`直接访问*并且*你想要`module`访问，只需执行以上两项：

```
from package.subpackage import module
from package.subpackage.module import attribute1
attribute1 # works
module.someOtherAttribute # also works 
```

如果您不喜欢输入`package.subpackage`两次，您可以手动创建对属性 1 的本地引用：

```
from package.subpackage import module
attribute1 = module.attribute1
attribute1 # works
module.someOtherAttribute #also works 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-01T16:50:33.937

#2 失败的原因是因为`sys.modules['module']`不存在（导入例程有自己的范围，并且看不到`module`本地名称），并且磁盘上没有`module`模块或包。请注意，您可以用逗号分隔多个导入的名称。

```
from package.subpackage.module import attribute1, attribute2, attribute3 
```

还：

```
from package.subpackage import module
print module.attribute1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T16:54:27.033

如果您要做的只是在全局命名空间中获取 attribute1，那么版本 3 似乎还不错。为什么它是矫枉过正的前缀？

在版本 2 中，而不是

```
from module import attribute1 
```

你可以做

```
attribute1 = module.attribute1 
```

# javascript - CSS/.JS 问题，末尾有随机黑线 在超级菜单中

> ID：12229582
> 
> 赞同：2
> 
> 时间：2012-09-01T16:45:58.333
> 
> 标签：javascript, html, css

我几乎已经完成了在我的网站中实现 MegaMenu Reloaded，但是在大多数屏幕分辨率上，最后一个项目的右侧出现一条随机黑线。我已经浏览了几个小时的 css 表，试图找到没有结果的问题。这让我相信问题可能出在 .js 的某个地方？

任何帮助将不胜感激。代码来源可以在这里找到！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:06:18.207

那是因为你有这个：

```
.megamenu > li:last-child {
    -moz-box-shadow: 1px 0 0 #242424;
} 
```

移除那个阴影并对其进行排序。

# objective-c - 在 SplitviewController 中呈现类似于 UIAlertView 的 UIView

> ID：12229585
> 
> 赞同：0
> 
> 时间：2012-09-01T16:46:59.333
> 
> 标签：objective-c, xcode, ipad, uiview, uisplitviewcontroller

我正在使用 SplitViewController。现在，当我在详细视图控制器中选择一行时，我想呈现一个类似于 UIAlertView 的 UIView。

我尝试过这样呈现视图，

```
[self presentModalViewController:view animated:YES]; 
```

但我的观点是从底部加载的。所以任何人都可以给我一些建议或样本来实现这一目标。

我也想增加我的主视图宽度。我试图改变弹出窗口的大小，但它不起作用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:46:23.843

将您的视图作为子视图添加到 (split-)viewcontrollers 视图

```
[splitViewController.view addSubview: yourView]; 
```

您可以将视图背景颜色设置为 clearColor 并在其上创建另一个视图，使其看起来像屏幕中间的较小视图。

# javascript - 使用 window[variablename]() 调用函数；在 document.ready 中

> ID：12229586
> 
> 赞同：0
> 
> 时间：2012-09-01T16:47:00.737
> 
> 标签：javascript

**我在document.ready**中有函数，我想使用变量中的值调用它们。我尝试使用但它在**document.ready**`window[variablename]();`中不起作用，但是当直接调用它时它可以工作。

 **认为这是document.ready里面的功能

```
$(document).ready(function() {

    function jhon(){
         alert('works');
    };
}); 
```

我从变量中获取函数名称，该变量的值是函数的名称..

下面的代码将获取 URL 的散列部分示例：#JHON 并删除 # 并将其存储在 URLHASH 变量中..示例：JHON

```
 var urlhash = document.location.hash;
  urlhash = urlhash.replace(/^.*#/, ''); 
```

当我这样打电话时它不起作用..

```
 window.onload=function() {
      window[urlhash]();
  }; 
```

但是当我像这样调用函数时它工作正常..

```
 window.onload=function() {
      jhon();
  }; 
```

是否可以使用变量值调用函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T16:49:13.420

这个：

```
window.onload=function() {
    window[urlhashed]();
}; 
```

包含一个错字：`urlhashed`应该是`urlhash`

```
window.onload=function() {
    window[urlhash]();
}; 
```

除此之外，您已经`jhon()`在另一个函数内部定义，该函数在该封闭函数范围内捕获它。

如果你想按预期进行这项工作，你应该改变它：

```
$(document).ready(function() {

    function jhon(){
         alert('works');
    };
}); 
```

更像这样：

```
$(document).ready(function() {

    window.jhon = function(){
         alert('works');
    };
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T16:56:10.273

定义`jhon` *外部*的函数`$(document).ready`。否则，它将被隐藏，因此无法通过以下方式访问`window[function_name]`：

```
function jhon(){
     alert('works');
};

$(document).ready(function() {
  var urlhash = document.location.hash;
  urlhash = urlhash.replace(/^.*#/, '');
  window[urlhash]();
}); 
```**

# python - Python，TextCtrl 上的 SetBackgroundColour 不起作用

> ID：12229587
> 
> 赞同：0
> 
> 时间：2012-09-01T16:48:00.407
> 
> 标签：python, wxpython

[http://pastebin.com/z9r43y0L](http://pastebin.com/z9r43y0L)

试试这个例子，然后按“保存”按钮。

TextCtrl 周围的红框仍然存在。我不想要这个红框。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:18:37.677

我已经能够在 Windows 7 上使用 wxPython 2.9.3 重现类似的东西。我没有在 TextCtrl 周围看到一个红色的“框架”，但我确实在每个角落都有一个红色像素。当我将鼠标悬停在 TextCtrl 上时，这些红色像素消失了。

我发现更换线路

```
 self.editname.Refresh() 
```

在`OnClick`函数中

```
 self.editname.Parent.Refresh() 
```

无需悬停即可消除角落处的红色像素。

# java - Java：检查异常的强制处理程序

> ID：12229590
> 
> 赞同：3
> 
> 时间：2012-09-01T16:48:18.930
> 
> 标签：java, exception, checked

java文档说，检查异常必须指定一个可以“捕获”异常或在方法声明中抛出异常的处理程序。但是，如果我这样做，例如：

```
public class DivZero{
 public static void main(String[] args){
   int a=10;
   int[] b={1,2,3,4,0};
   for (int i=0;i<b.length;i++){
    System.out.println(a/b[i]);
   }
 }
} 
```

如果没有“try-catch”或“throws”声明，它也可以正常工作。它抛出一个*java.lang.ArithmeticException*。那么，这不是强制性的吗？编译器以同样的方式隐式抛出合适的 Java“Throwable”类。是这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T16:49:43.107

[`ArithmeticException`](http://docs.oracle.com/javase/7/docs/api/java/lang/ArithmeticException.html)扩展[`RuntimeException`](http://docs.oracle.com/javase/7/docs/api/java/lang/RuntimeException.html)因此它不是一个检查异常。已检查异常是继承自[`Exception`](http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html)但不继承自的异常`RuntimeException`。

引用[JLS，11.1.1。例外的种类](http://docs.oracle.com/javase/specs/jls/se7/html/jls-11.html#jls-11.1.1)：

> [...] 检查异常类都是`Throwable`other`RuntimeException`及其子类和 Error 及其子类的子类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T16:50:40.890

您必须仅捕获已检查的异常：其`java.lang.Exception`子类不是`java.lang.RuntimeException`. `ArithmeticException`是 的子类`RuntimeException`。

`RuntimeException`(s) 通常会在您的应用程序中发出错误信号，因此您必须解决它们，而不是捕获异常。在您的情况下`ArithmeticException`，因为您试图将 int 除以 0 而被抛出。`System.out.println(a/b[i]);`您需要确保在您的程序中不会发生这种划分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T16:52:11.340

Java 中有两种异常：扩展[Exception](http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html)的异常称为已[*检查*](http://en.wikipedia.org/wiki/Exception_handling#Checked_exceptions)并且需要处理（捕获它们或抛出它们） - 例如[IOException](http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html)。[从RuntimeException](http://docs.oracle.com/javase/7/docs/api/java/lang/RuntimeException.html)扩展的那些被称为[*unchecked*](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html)并且不需要显式处理，除非您需要对它们做一些事情 - 例如[NullPointerException](http://docs.oracle.com/javase/7/docs/api/java/lang/NullPointerException.html)。

对于问题中的代码，您可以看到[ArithmeticException](http://docs.oracle.com/javase/7/docs/api/java/lang/ArithmeticException.html)从 RuntimeException 扩展，因此未选中，您不需要显式处理它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T16:50:45.947

ArithmeticException 不是检查异常，这就是它允许您编译的原因。Exception 的子类称为已检查异常，其余所有未检查。

# c# - 检测手机侧面的点击 (Windows Phone)

> ID：12229591
> 
> 赞同：0
> 
> 时间：2012-09-01T16:48:27.833
> 
> 标签：c#, silverlight, windows-phone-7, accelerometer

我想知道如何检测手机任何一侧的敲击（或轻微抖动）。我的意思是说，我想执行一项任务，当手机被点击顶部时，以及其他事情当它被从侧面点击时。如何使用 Windows Phone 上的加速度计检测这种运动？这可能听起来很愚蠢，但解决方案会很棒。

# python - 除 1 行外，按列切片 numpy 数组

> ID：12229595
> 
> 赞同：2
> 
> 时间：2012-09-01T16:49:07.443
> 
> 标签：python, arrays, numpy

如何按列对 numpy 数组进行切片，并排除特定行？

想象一下，您有一个 numpy 数组，其中第一列用作“玩家”的索引，接下来的列是玩家在不同游戏中的得分。如何在排除一名玩家的情况下返回游戏的分数。

例如：

```
[0  0  0  0
 1  2  1  1 
 2 -6  0  2
 3  4  1  3] 
```

如果您想返回第一个分数（第 1 列），您可以：

```
>>score[:,1]
[0,2,-6,4] 
```

但是你怎么能排除一个玩家/行呢？如果该玩家/第 3 行，您如何获得：

```
[0,2,-6] 
```

或者，如果该玩家/第 1 行，您如何获得：

```
[0,-6, 4] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T17:22:19.537

您可以将要作为列表包含的玩家传递给第一个索引，`score`如下所示：

```
>>> import numpy as np
>>> score = np.array([
... [0,0,0,0],
... [1,2,1,1],
... [2,-6,0,2],
... [3,4,1,3]
... ])
>>> players_to_include = [0,2,3]
>>> score[players_to_include, 1]
array([ 0, -6,  4]) 
```

这将只获得玩家 [0,2,3] 的分数。

概括地说，你可以这样做：

```
>>> players = list(xrange(np.size(score, 0)))
>>> players
[0, 1, 2, 3]
>>> excludes = [2,3]
>>> players_to_include = [p for p in players if p not in excludes]
>>> players_to_include
[0, 1]
>>> score[players_to_include, 1]
array([0, 2]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T16:58:21.697

您可以将请求行的范围作为列表输入，例如：

```
score[ range(2) + [4], 1] 
```

对于更一般的谓词函数 p(x) = 1 如果 x 是一个好行，您可以这样做：

```
score [ [x for x in range(score.shape[0]) if p(x)], 1] 
```

# rest - 泽西岛未能为 GET 响应编组对象

> ID：12229598
> 
> 赞同：0
> 
> 时间：2012-09-01T16:49:28.740
> 
> 标签：rest, jaxb, jersey

我正在编写一个 REST 资源，但我遇到了一个对象问题

```
@Entity
@Table(name = "TABLE_A")
@XmlRootElement(name = "typeA")
public class TypeA implements GenericType{

@Id
@Column(name = "COLUMN_ID")
@GeneratedValue
private Integer id;

@OneToMany (mappedBy="person")
private List<TypeB> typeBList;

@XmlAttribute
public Integer getId() {
    return id;
}

public void setId(Integer id) {
    this.id = id;
}

@XmlElement(name="mytypes")
public List<TypeB> getTypeBList() {
    return typeBList;
}

public void setTypeBList(List<TypeB> typeBList) {
    this.typeBList = typeBList;
}
} 
```

该接口没有任何注释。

这是提供服务的资源

```
@Path("user/{id}")
public class PersonResourceImpl {

@GET
@Produces({MediaType.APPLICATION_XML})
public TypeA getPerson(@PathParam("id") String id) {
    LOG.info("doGetPerson() - IN");

    ... get from a datasource ...

    return retrievedPerson;
} 
```

当我尝试使用此资源时，会从数据库返回正确的对象，但是当它尝试将其编组为 xml 时，它会因找不到类的消息正文编写器和 MIME 类型 application/xml 而失败

这就是我必须为其他对象做的所有事情并且它们可以工作，我唯一没有做的就是@XmlAttribute 标记，也许那里有问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T09:17:28.857

这是由我使用 Hibernate 的方式引起的。我正在从数据库加载对象并将其返回到我的 Rest 资源，当时我执行 null 检查该资源是否仍然可用。

当 JAXB 尝试编组此对象时，它失败了，要么该对象已更改并且不再可用，要么在 hibernate 创建它时它没有正确的注释。

我通过创建一个新对象并使用来自一个休眠返回的数据加载它来解决这个问题。

# charts - Jenkins 在仪表板上显示图表

> ID：12229602
> 
> 赞同：2
> 
> 时间：2012-09-01T16:49:44.337
> 
> 标签：charts, jenkins, dashboard, pdepend

> **可能重复：**
> [Jenkins - 将图表添加到作业界面](https://stackoverflow.com/questions/12230542/jenkins-add-chart-to-the-job-interface)

第一个问题是 - 如何将 pdepend 图表添加到 Jenkins 的仪表板（在项目标题下）？

第二个问题（我不能只用第一个提交帖子 - 没有足够的文字：P） - 我如何开始使用 phpmd？我的意思是，好吧..我在 CLI 中输入：phpmd 文件夹/文本命名。它有什么作用？它是否应该创建一些报告文件并检查给定位置中的命名内置约定？我在文档中找不到任何关于此的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:07:50.330

[好吧，最简单的方法是使用仪表板视图](https://wiki.jenkins-ci.org/display/JENKINS/Dashboard+View)插件构建自己的仪表板。您可以将不同的 portlet 添加到包含各种内容的新仪表板中。

否则，您可以使用[Sectioned View](https://wiki.jenkins-ci.org/display/JENKINS/Sectioned+View+Plugin)插件，它具有相似的目标，但构建仪表板的方法不同。

# apache-flex - itemrenderer 函数模型效率低下还是只是示例？

> ID：12229604
> 
> 赞同：3
> 
> 时间：2012-09-01T16:50:07.223
> 
> 标签：apache-flex, datagrid, flex4

我在某处听说或读到出于性能原因应该避免使用 itemRendererFunction 但由于我找不到该评论的来源，是否可能是文档中的示例代码效率低下？我创建了一个我认为效率更高的替代代码示例（尚未进行测试）。

这是文档中的示例代码。请注意，在每次迭代中都会创建一个新的类工厂 [1]：

```
<fx:Script>
    <![CDATA[

        import myComponents.MySimpleItemRendererFunction;
        import spark.skins.spark.DefaultItemRenderer;

        private function selectRenderer(item:Object):ClassFactory {
            var classFactory:ClassFactory;
            if (item is String) {
                // If the item is a String, use DefaultItemRenderer.
                classFactory = new ClassFactory(DefaultItemRenderer);
            }
            else {
                // If the item is an Object, use MySimpleItemRendererFunction.
                classFactory = new ClassFactory(MySimpleItemRendererFunction); 
            }
            return classFactory;
        }
    ]]>  
</fx:Script> 
```

我的代码（未测试）：

```
<fx:Script>
    <![CDATA[

        private var normalItemRendererFactory:ClassFactory = new ClassFactory(DefaultItemRenderer);
        private var editableItemRendererFactory:ClassFactory = new ClassFactory(EditableItemRenderer);

        private function itemRendererFunction(item:Object):ClassFactory {

            if (item is String) {
                // If the item is a String, use DefaultItemRenderer.
                return normalItemRendererFactory;
            }
            else {
                // If the item is an Object, use MySimpleItemRendererFunction.
                return editableItemRendererFactory;
            }
        }
    ]]>  
</fx:Script> 
```

[1] [http://help.adobe.com/en_US/Flex/4.0/UsingSDK/WS03d33b8076db57b9-23c04461124bbeca597-8000.html#WS94F31173-40D5-4ddd-B7B3-17D02BD57EAF](http://help.adobe.com/en_US/Flex/4.0/UsingSDK/WS03d33b8076db57b9-23c04461124bbeca597-8000.html#WS94F31173-40D5-4ddd-B7B3-17D02BD57EAF)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T17:55:21.393

如果您使用的`itemRendererFunction`是 Flex 4.0 到 4.5 SDK，则您的项目渲染器`List`不会被回收。这会对列表的滚动性能产生很大的性能影响。

在 Flex 4.6 中，他们改进了功能，以便在使用项目渲染器功能时可以回收项目渲染器。

通过对上面示例所做的改进，您一针见血。第一个明显的改进是您避免了每次都创建一个新的类工厂。但是还有更重要的事情，它会阻止列表回收渲染器（即使是 Flex 4.6）。

当`itemRendererFunction`每次返回一个新的类工厂时，它会扰乱列表对项目渲染器的内部跟踪，并导致列表创建新的渲染器而不是在可能的情况下重新使用它们。然后，这对滚动具有相同的性能影响，以及将旧渲染器保留在内存中的额外好处。

这个[特殊的问题在这里讨论](http://www.frishy.com/2012/02/mis-using-itemrendererfunction-and-memory-leaks/)。

# ruby-on-rails - 为 rails/heroku 组合 rake 任务不起作用

> ID：12229606
> 
> 赞同：0
> 
> 时间：2012-09-01T16:50:29.737
> 
> 标签：ruby-on-rails, heroku, rake

我从这个（http://stackoverflow.com/questions/1890709/combining-many-rake-tasks-into-one-rake-task）看到你可以像这样组合 rake 任务：

```
desc 'This rebuilds development db'
task :rebuild_dev => ["db:drop", "db:create", "db:migrate", "db:load"] 
```

但是，当我尝试对我的本地应用程序执行此操作以组合相对简单的 rake 任务时，每个任务都只运行 shell 命令，似乎它只执行数组中的第一个 `['heroku:push', 'heroku:migrate', 'heroku:restart']`。

这是代码：

```
desc 'Push to heroku production, db:migrate, and restart app'
task :deploy_production => ['heroku:push', 'heroku:migrate', 'heroku:restart']

namespace :heroku do
  task :push do
    puts 'Deploying app to Heroku...'
    exec 'git push heroku master'
  end

  task :migrate do
    puts 'Running database migrations ...'
    exec 'heroku run rake db:migrate'
  end

  task :restart do
    puts 'Restarting app servers ...'
    exec 'heroku restart'
  end
end 
```

顺便说一下，如果你需要它，这里是 rake 的版本：

```
$ gem list | grep rake                                                               
rake (0.9.2.2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T04:31:01.737

I should use backticks (`) instead of the `exec` ruby command. Here's what the code should like for the `rake deploy_production` to work:

```
desc 'Push to heroku production, db:migrate, and restart app'
task :deploy_production => ['heroku:push', 'heroku:migrate', 'heroku:restart']

namespace :heroku do
  task :push do
    puts 'Deploying app to Heroku...'
    `git push heroku master`
  end

  task :migrate do
    puts 'Running database migrations ...'
    `heroku run rake db:migrate`
  end

  task :restart do
    puts 'Restarting app servers ...'
    `heroku restart`
  end
end 
```

I had problems posting it immediately because I am new to stackoverflow, and I can't post an answer immediately to my own question.

The reason I prefer backticks over `system` in ruby is because of the slight advantage discussed here: [Ruby, Difference between exec, system and %x() or Backticks](https://stackoverflow.com/questions/6338908/ruby-difference-between-exec-system-and-x-or-backticks)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:20:54.827

尝试做

```
desc 'Push to heroku production, db:migrate, and restart app'
task :deploy_production => ['heroku:push', 'heroku:migrate', 'heroku:restart']

namespace :heroku do
  task :push do
    puts 'Deploying app to Heroku...'
    system 'git push heroku master'
  end

  task :migrate do
    puts 'Running database migrations ...'
    system 'heroku run rake db:migrate'
  end

  task :restart do
    puts 'Restarting app servers ...'
    system 'heroku restart'
  end
end 
```

所以基本上只是用电话代替`exec`电话`system`。

# javascript - jquery 可拖动插件在有缺陷的 chrome 中工作

> ID：12229619
> 
> 赞同：0
> 
> 时间：2012-09-01T16:51:55.927
> 
> 标签：javascript, jquery, google-chrome, jquery-plugins, draggable

我使用 jquery 可拖动插件，这是我的简单代码

```
$(document).ready( function () {

    $("#my_div").draggable();           

}); 
```

在 html 中

```
 <div id="my_div" style="width: 100px; height: 100px; background-color: #090"> </div> 
```

问题是这样的：当我开始拖动时，对象自动跳到顶部，大约 20 px。在元素的每一次移动中，元素都会跳到顶部。这种意外跳转只发生在谷歌浏览器中，在其他浏览器中可拖动效果很好。我的 chrome 版本是最后一个，我在 2 台不同的计算机上对此进行了测试，并且在两台计算机中，这种“顶部跳跃”只发生在 chrome 中。有人知道为什么吗？以及如何在chrome中解决这个问题？

# jquery - 通过 jQuery 添加页面标题作为正文类

> ID：12229620
> 
> 赞同：1
> 
> 时间：2012-09-01T16:52:00.800
> 
> 标签：jquery, addclass

如何将 h1 中的文本转换为连字符字符串并使其成为正文中的新类？这是我到目前为止的所有内容：

```
var newClass = $('h1').val().replace(/ /g, '-');
$("body").addClass(newClass); 
```

[小提琴](http://jsfiddle.net/7kbnt/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T16:53:43.633

对于`h1`你应该使用的元素，`text`而不是`val`,`val`用于获取/设置表单元素的值：

```
var newClass = $('h1').text().replace(/\s/g, '-');
$("body").addClass(newClass); 
```

# html - 3 列带文本换行符

> ID：12229622
> 
> 赞同：0
> 
> 时间：2012-09-01T16:52:08.017
> 
> 标签：html, css, xhtml

我想在彼此之间有 2 列。第一个应该是背景图像。与图像的“最小”尺寸。其他 2 个应该具有相同的大小。

如果我在其中写一个文本，`div`应该在他的文本上换行。

其实我是这样做的

```
 <style type="text/css">
    body
      {
        background-color:#484848;
      }

      #wrapper 
      {
        width: auto;
        margin: 0 auto;
        display: inline-block;
      }
     .col 
     {
        display: block;
        background: #FFF;
        float: left;
        height: 200px;
        width:100%;
     }

  </style> 
```

* * *

```
<body>
  <div id="wrapper">
    <div class="col" style=
    "background-image:url(img/Logo.jpg); 
     width:101px; 
     height:200px;
     background-repeat:no-repeat;"><--! in same line actually -->
    </div>

    <div class="col">
      <table border="0">
        <tr>
          <td>username</td>
          <td><input type="text"></td>
        </tr>
        <tr>
          <td>password</td>
          <td><input type="password"></td>
        </tr>
        <tr>
          <td></td>
          <td><input type="submit" value="login"></td>
        </tr>
      </table>
    </div>
    <div class="col">
      text
    </div>
  </div>
</body> 
```

但它真的看起来很糟糕......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:21:47.230

寻找类似[http://jsfiddle.net/hZPDt/](http://jsfiddle.net/hZPDt/)的东西？

请准确说明您想要什么

```
body {
  background-color: #484848;
}

#wrapper {
  margin: 0 auto;
}

.col {
  display: block;
  background: #FFF;
  float: left;
  height: 200px;
  width: 32.1%;
  margin: .6%;
  background-color: #FF0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:20:37.167

JS 小提琴：http: [//jsfiddle.net/6qmvx/](http://jsfiddle.net/6qmvx/)

如果我理解你的问题，那么答案很简单——问题就在这里：

```
.col {
    width: 100%;
} 
```

删除 % 宽度并添加一个绝对宽度，如下所示：

```
.col {
    display: block;
    background: #FFF;
    float: left;
    width: 300px;
    height: 200px;
    border: 1px dotted red;
} 
```

我添加了边框以帮助说明正在发生的事情。由于您手动覆盖了第一个 div 中的宽度，因此这应该按照您的示例工作。

# xslt - 如何编写 XSLT 来提取每次都构造为不同树的 XML 数据（主要来自属性）？

> ID：12229627
> 
> 赞同：-2
> 
> 时间：2012-09-01T16:52:50.103
> 
> 标签：xslt, xslt-1.0

我是 XSLT 新手。我正在尝试开发 XSLT 以按照下面的代码将 XML 数据转换为 HTML。

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:output method="html"/>
    <xsl:key name="Name" match="Item" use="@Name"/>
    <xsl:template match="item">
    <html>
        <body>
            <h1>Course Profile</h1>
            <xsl:apply-templates/>
        </body>
    </html>
    </xsl:template>
    <xsl:template match="Item">
                <xsl:if test="string-length(@Name) &gt; 0 ">
                    <span>Name: </span>
                    <xsl:value-of select="@Name"/>
                    &#160;
                 </xsl:if>
                <xsl:if test="string-length(@Title) &gt; 0 ">
                    <span>Title: </span>
                    <xsl:value-of select="@Title"/>
                        &#160;
                </xsl:if>
                <xsl:if test="string-length(@Description) &gt; 0 and @Description!=@Title">
                    <span>Description: </span>
                    <xsl:value-of select="@Description"/>
                     &#160;
                </xsl:if>
                <xsl:if test="string-length(@Value) &gt; 0 ">
                    <span>Value: </span>
                    <xsl:value-of select="@Value"/>
                    &#160;
                </xsl:if>
                <xsl:if test="string-length(Name) &gt; 0  ">
                    <span>Actual value: </span>
                    <xsl:value-of select="Name"/>
                    &#160;
                </xsl:if>
                <br/>
                <hr/>
            </xsl:template> 
</xsl:stylesheet> 
```

使用来自 XML 数据的数据（不是外观！-我不想使用 XSL-FO）进入 XHTML（这是我的问题 - 它并不总是相同的 xsd）：

```
<?xml version="1.0" encoding="UTF-8"?>
<StructureData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <Object ID="cacms^977" StructureLevel="5" Title="test programme">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.09"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="title" Value="test programme"/>
            <Item Name="description" Value="revalidation"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata>
            <Item Index="1" Name="Programme Type" Value="Appip"/>
            <Item Index="2" Name="Course Type" Value="Adult learning &gt;20"/>
            <Item Index="2" Name="Course Code" Value="xxTT2"/>
            <Item Index="1" Name="Status" Value="01-In development"/>
            <Item Index="1" Name="Metadata Schema" Value="LOM 1.0"/>
            <Item Index="1" Name="Minimum Version" Value="IE 7.0"/>
            <Item Index="1" Name="Maximum Version" Value="IE 8.0"/>
            <Item Index="17" Name="Awarding Body" Value="TT"/>
            <Item Index="1" Name="NQ Award Type" Value="Major Award"/>
            <Item Index="6" Name="NQ Award Level" Value="Level 06"/>
            <Item Index="6" Name="Award Title" Value="none"/>
        </CustomMetadata>
    </Object>
    <Object ID="cacms^978" StructureLevel="4" Title="test phase">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.10"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="title" Value="test phase"/>
            <Item Name="description" Value="revalidation"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
    </Object>
    <Object ID="cacms^979" StructureLevel="3" Title="test module">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.10"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="title" Value="test module"/>
            <Item Name="description" Value="revalidation"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata>
            <Item Index="1" Name="NQ Award Type" Value="Major Award"/>
            <Item Index="6" Name="NQ Award Level" Value="Level 06"/>
            <Item Index="6" Name="Expiry/Review Date" Value="2012-05-09"/>
            <Item Index="10" Name="Typical Learning Time (Duration hours)" Value=""/>
            <Item Index="10" Name="Award Title" Value="non"/>
            <Item Index="17" Name="Awarding Body" Value="T"/>
        </CustomMetadata>
    </Object>
    <Object ID="cacms^980" StructureLevel="2" Title="test unit">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-08-22-10.21.17"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="title" Value="May 9 test unit - Sunny"/>
            <Item Name=" description" Value="revalidation"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
    </Object>
    <Object ID="cacms^1001" StructureLevel="1" Title="test cluster ">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-08-22-10.15.37"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="title" Value="test cluster"/>
            <Item Name="description" Value="delete"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata>
            <Item Name="Phase" Value="NCDB"/>
        </CustomMetadata>
    </Object>
    <Object ID="cacms^1053" StructureLevel="0" Title="test ">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="sound" Value=""/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.11"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
    </Object>
    <Object ID="cacms^1054" StructureLevel="0" Title="reverificaton use of templated - Sunny">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="sound" Value=""/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.11"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
        <ObjectData>
            <Item Description="Advanced Table Title Bar Cover Page" ID="cacms^2879" Title="reverification Template Cover page QA 39/01 Training Plan Title Bar" Type="Advanced Table">
                <row>
                    <col><![CDATA[<p>&#160;</p><p>CACMS Re-verificiation text <em>Version X.Y Month Year italics</em></p><p>&#160;</p>]]></col>
                </row>
            </Item>
        </ObjectData>
    </Object>
    <Object ID="cacms^1055" StructureLevel="0" Title="May 14 test page 1 doc mode">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="sound" Value=""/>
            <Item Name="author" Value=""/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.11"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
        <ObjectData>
            <Item Description="Advanced Table Title Bar Cover Page" ID="cacms^2866" Title="May 9 test page 1 non doc mode_1 - Title Bar" Type="Advanced Table">
                <row>
                    <col><![CDATA[<p>&#160;</p><p>Domestic Appliance Servicing <em>Version 4.6 September 2011</em></p><p>&#160;</p>]]></col>
                </row>
            </Item>
            <Item Description="QA39/01 Training Plan Title Block" ID="cacms^2867" Title="QA39/01 Training Plan Title Block" Type="Advanced Table">
                <row>
                    <col><![CDATA[<p><em></em>&#160;</p>]]></col>
                </row>
                <row>
                    <col>TT - TT</col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<p><em>TRAINING PLAN</em></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<p><em>DESIGNED TO STANDARD NO. QA39/01</em></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
            </Item>
            <Item Description="Domestic Appliance Servicing  QA39/01" ID="cacms^2869" Title="May 9 test page 1 non doc mode_35 -  Domestic Appliance Servicing MANCO QA39/01" Type="Advanced Table">
                <row>
                    <col><![CDATA[<strong>GLM CODE</strong>]]></col>
                    <col><![CDATA[<strong>MANCO CODES</strong> ]]></col>
                    <col/>
                    <col/>
                </row>
                <row>
                    <col><![CDATA[<strong>XX028</strong>]]></col>
                    <col><![CDATA[<strong>76170</strong>]]></col>
                    <col><![CDATA[&#160;]]></col>
                    <col><![CDATA[&#160;]]></col>
                </row>
            </Item>
            <Item Description="Advanced Table QA39 Status Block" ID="cacms^2870" Title="May 9 test page 1 non doc mode_73 - QA39 Status Block" Type="Advanced Table">
                <row>
                    <col>STATUS</col>
                    <col/>
                    <col/>
                    <col/>
                </row>
                <row>
                    <col>PROPOSAL DATE</col>
                    <col>TT INTERNAL APPROVAL DATE</col>
                    <col>AWARD COUNCIL VALIDATION DATE</col>
                    <col>REVIEW BY DATE</col>
                </row>
                <row>
                    <col>AUGUST 1995</col>
                    <col>JUNE 2010</col>
                    <col><![CDATA[&#160;]]></col>
                    <col>JUNE 2005</col>
                </row>
            </Item>
            <Item Description="TT logo with no Tagline at 300 dpi" ID="cacms^TT99" Title="TT Logo no Tagline 300 dpi" Type="Graphic"/>
            <Item Description="Text" ID="cacms^2871" Title="test page 1 non doc mode_107 - Funded statement" Type="Text">       Funded financed   </Item>
            <Item Description="Programme Title Block QA39/01" ID="cacms^2874" Title="May 14 test page 1 doc mode_14 - Programme Title Block" Type="Advanced Table">
                <row>
                    <col><![CDATA[<strong><em>TRAINING TITLE</em></strong>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<p><strong>&#160;Domestic Appliance Servicing</strong></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<em>&#160;&#160; Version 4.6 September 2011</em>]]></col>
                </row>
            </Item>
        </ObjectData>
    </Object>
    <Object ID="cacms^981" StructureLevel="1" Title="test cluster">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="author" Value="rien"/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.10"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="title" Value="test cluster"/>
            <Item Name="description" Value="test"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata>
            <Item Name="Phase" Value="re-verification"/>
        </CustomMetadata>
    </Object>
    <Object ID="cacms^1047" StructureLevel="0" Title="QA39 Test Type codes template - Sunny">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="Adult Training Templates"/>
            <Item Name="sound" Value=""/>
            <Item Name="author" Value=""/>
            <Item Name="last_updated_time" Value="2012-05-28-07.02.11"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
        <ObjectData>
            <Item Description="Key to Test Type Codes" ID="cacms^2881" Title="Training Plan - table of codes" Type="Advanced Table">
                <row isHeader="true">
                    <col><![CDATA[<p>&#160;</p><p>TRAINING PLAN</p><p>&#160;</p>]]></col>
                    <col/>
                </row>
                <row>
                    <col>KEY TO TEST TYPE CODES </col>
                    <col/>
                </row>
                <row>
                    <col>Assignment</col>
                    <col><![CDATA[<p>A</p>]]></col>
                </row>
                <row>
                    <col>Course Work</col>
                    <col>CW</col>
                </row>
                <row>
                    <col>Drawing</col>
                    <col>D</col>
                </row>
                <row>
                    <col>Essay (Written)</col>
                    <col>E</col>
                </row>
                <row>
                    <col>Integrated Assessment</col>
                    <col>IA</col>
                </row>
                <row>
                    <col>Multiple Choice</col>
                    <col>MC</col>
                </row>
                <row>
                    <col>Not Applicable</col>
                    <col>NA</col>
                </row>
                <row>
                    <col>Oral</col>
                    <col>O</col>
                </row>
                <row>
                    <col>Practical</col>
                    <col>P</col>
                </row>
                <row>
                    <col>Profiling</col>
                    <col>PF</col>
                </row>
                <row>
                    <col>Project</col>
                    <col>PR</col>
                </row>
                <row>
                    <col>Short Answer</col>
                    <col>SA</col>
                </row>
                <row>
                    <col>Workplace Observation</col>
                    <col>WO</col>
                </row>
                <row>
                    <col>Written</col>
                    <col>W</col>
                </row>
            </Item>
        </ObjectData>
    </Object>
    <Object ID="cacms^1048" StructureLevel="0" Title=" non-doc mode page">
        <CoreMetadata>
            <Item Name="version" Value="1"/>
            <Item Name="language" Value="English"/>
            <Item Name="subject" Value="UAT testing content"/>
            <Item Name="sound" Value=""/>
            <Item Name="author" Value=""/>
            <Item Name="last_updated_time" Value="2012-05-28-07.39.04"/>
            <Item Name="last_updated_by" Value="rien"/>
            <Item Name="expiry_date" Value=""/>
        </CoreMetadata>
        <CustomMetadata/>
        <ObjectData>
            <Item Description="QA39/01 Training Plan Title Block" ID="cacms^2867" Title="QA39/01 Training Plan Title Block" Type="Advanced Table">
                <row>
                    <col><![CDATA[<p><em></em>&#160;</p>]]></col>
                </row>
                <row>
                    <col>TT - TT</col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<p><em>TRAINING PLAN</em></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<p><em>DESIGNED TO STANDARD NO. QA39/01</em></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
            </Item>
            <Item Description="Programme Title Block QA39/01" ID="cacms^2868" Title="test page 1 non doc mode_14 - Programme Title Block" Type="Advanced Table">
                <row>
                    <col><![CDATA[<p>&#160;</p>]]></col>
                </row>
                <row>
                    <col>TRAINING TITLE</col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<p><strong>&#160;Domestic Appliance Servicing</strong></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col><![CDATA[<em>&#160;&#160;Version 4.6 September 2011</em>]]></col>
                </row>
            </Item>
            <Item Description="Copyright Page - Advanced Table QA39" ID="cacms^2880" Title="Copyright Page - QA 39/01 copyright text" Type="Advanced Table">
                <row>
                    <col><![CDATA[<p>&#160;</p><p>Published by: </p><p>TTT, </p><p>P.O. Box 1, </p><p>TTTT Street, </p><p>TT, TT</p><p>&#169; TT 2011<br /></p>]]></col>
                </row>
                <row>
                    <col><![CDATA[The copyright of this document is the property of TT except where copyright is acknowledged to belong to a third party.]]></col>
                </row>
                <row>
                    <col><![CDATA[&#160;]]></col>
                </row>
                <row>
                    <col>All rights reserved. </col>
                </row>
                <row>
                    <col><![CDATA[<b><font size="2" face="Arial-BoldMT"><font size="2" face="Arial-BoldMT"><p align="left">&#160;</p></font></font></b>]]></col>
                </row>
            </Item>
        </ObjectData>
    </Object>
</StructureData> 
```

**如何编写 XSLT 来提取每次都构造为不同树的 XML 数据（主要来自属性）？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:14:07.337

您只需在 xsd 规则集文档中为每种类型编写一个 xslt 并将足够的内容应用于实例

# android - AlertDialog 和警告消息“窗口已聚焦”

> ID：12229630
> 
> 赞同：1
> 
> 时间：2012-09-01T16:53:05.550
> 
> 标签：android, dialog, window, onresume

在我的应用程序中，我需要从显示列表的 AlertDialog 中获取值。选择一个项目后，我更改按钮文本（显示 AlertDialog 的按钮），对话框被关闭，我需要在 onResume() 中进行处理。

但是 onResume 没有被调用，我收到警告“窗口已经聚焦”。我认为原因是我从对话框中更改了按钮文本，所以我已经在窗口中。但我需要进入 onResume(à . 怎么做？

警报对话框：

```
AlertDialog.Builder mBuilder = new AlertDialog.Builder(this);
    mBuilder.setTitle("Type de l'observation");
    mBuilder.setSingleChoiceItems(titles,-1, new DialogInterface.OnClickListener(){
        public void onClick(DialogInterface dialogInterface, int item) {
            mDescriptor.setmObservationValue(
                    mContext.getResources().getStringArray(R.array.post_values)[item]);
            mObservationButton.setText(titles[item]);
            dialogInterface.dismiss();
            return;
        }
    });
    mDialog = mBuilder.create(); 
```

onClick 方法： public void onObservationClick(View v) { mDialog.show(); }

和 onResume() ：

```
 @Override
protected void onResume() {
    if(!mDescriptor.getmObservationValue().equals(""))
    {
        String value = mDescriptor.getFieldKey();
        Log.v("VALUE : ",value);
        if(value.equals("VentValue"))
        {
            mFieldLayout.setVisibility(View.VISIBLE);
            mUnit.setText("km/h");
        }
        else if(value.equals("PluieValue"))
        {
            mFieldLayout.setVisibility(View.VISIBLE);
            mUnit.setText("mm");
        }   
        else if(value.equals("NeigeValue"))
        {
            mFieldLayout.setVisibility(View.VISIBLE);
            mUnit.setText("mm");
        }
        else if(value.equals("TempValue"))
        {
            mFieldLayout.setVisibility(View.VISIBLE);
            mUnit.setText("°C");
        }
        else if(value.equals("VisValue"))
        {
            mFieldLayout.setVisibility(View.VISIBLE);
            mUnit.setText("m");
        }
        else
        {
            mFieldLayout.setVisibility(View.GONE);
            mUnit.setText("");
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T16:59:02.533

看起来你是在强行调用 onResume()，但你不能这样做。Activity 不会暂停以显示 AlertDialog，因此在 Dialog 关闭后不会调用 onResume()。只需将 onResume() 中的代码移动到另一个方法中，并在对话框关闭时调用此方法。

考虑使用[OnDismissListener](http://developer.android.com/reference/android/app/Dialog.html#setOnDismissListener%28android.content.DialogInterface.OnDismissListener%29)

# java - Glassfish 部署错误，错误消息不详

> ID：12229633
> 
> 赞同：0
> 
> 时间：2012-09-01T16:54:03.780
> 
> 标签：java, deployment, java-ee-6, glassfish-3, netbeans-7

我正在使用 NetBeans IDE 开发 Java EE 企业应用程序。我可以在与 NetBeans IDE 捆绑的 Glassfish 实例上开发和测试我的整个应用程序，但是当我尝试在生产 Glassfish 服务器上部署我的应用程序时会遇到一些模糊的错误。每次我尝试在服务器上部署 .ear 包时，Glassfish 都会报这个错误：

```
SEVERE: Exception while loading the app
SEVERE: Exception while shutting down application container
SEVERE: Exception while shutting down application container : java.lang.NullPointerException
SEVERE: java.lang.RuntimeException: Error occurred during deployment: Exception while shutting down application container : java.lang.NullPointerException. Please see server.log for more details. 
```

该应用程序是在 NetBeans 7.2、Java EE 6、JDK 7 上从头开始开发的，并部署在 GlassFish 3.1.2.2 上。将日志级别更改为 ALL 不会使 GlassFish 产生更有帮助的错误消息。Web 上还提到了其他解决方案，包括创建一个空的 0 字节 beans.xml 文件和使用另一个应用程序服务器，例如 JBoss。我没有尝试 JBoss 或其他应用服务器，但找不到导致 Glassfish 错误的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-19T05:57:46.593

[这不是一个普遍的答案，但是当我在没有实现Serializable](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/Serializable.html)接口的情况下定义会话范围类时遇到了这个问题。NullPointerException 示例：

```
import javax.enterprise.context.SessionScoped;
import javax.inject.Named;

@Named
@SessionScoped
public class someBean(){
} 
```

**没有**NullPointerException 的示例：

```
import javax.enterprise.context.SessionScoped;
import javax.inject.Named;

@Named
@SessionScoped
public class someBean() implements Serializable{
} 
```

**系统环境**：Windows x64、jdk x64、glassfish x64。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-17T21:23:25.217

如果您的应用程序很好，通常 glassfish 无法干净地取消部署。这当然意味着您之前部署了该特定应用程序。我通常做的是解决这个问题：

*   停止玻璃鱼
*   转到您的域和/或实例目录并检查以下目录，如果有类似您的应用程序的名称并将其删除：“应用程序”，“生成”下的所有子文件夹。
*   删除 osgi 下的 felix 目录（确保不要在安装目录中擦除该目录！）
*   开始玻璃鱼
*   部署

如果您正在运行 glassfish 集群，您通常需要在您的 DAS 和您的实例上执行此操作。非常烦人，但这通常只发生在相当多的部署之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T16:54:03.780

奇怪的是，在 64 位 Debian 6 系统上运行的 32 位 JDK 导致了该错误。我已经尝试了所有我能想到的相关和不相关的事情，包括使用相同的 JDK 更新、更改 /etc/hosts 以匹配开发系统、在生产服务器上安装带有捆绑 Glassfish 的 NetBeans（！），使用无效IP地址而不是有效地址，使用Oracle Glassfish服务器而不是社区版本等。它们都没有帮助。只有在我注意到 32 位 JDK 并将其替换为 64 位版本后，问题才得到解决。

这个错误，它模糊的报告和不知何故不相关的原因浪费了我 5 天的时间。我决定分享我的经验，希望它可以帮助处于类似令人沮丧情况的人。

# vim - VimL：如何仅对视觉选择执行一次功能

> ID：12229639
> 
> 赞同：4
> 
> 时间：2012-09-01T16:54:59.633
> 
> 标签：vim

我需要你的帮助。假设我有一个功能：

```
fun! Foo()
    " Do awesome staff
endfunction 
```

以及我的插件中的以下键绑定：

```
vnoremap <LocalLeader>cv :call Foo()<RETURN> 
```

我的问题是 Foo() 会为我的视觉选择的每一行调用。相反，我只希望 Foo() 只执行一次。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T16:09:36.837

看`:help function-range-example`

```
fun! Foo() range
  " Do awesome stuff
endfun
vnoremap <LocalLeader>cv :call Foo()<cr> 
```

# c - 找不到 -llibc

> ID：12229642
> 
> 赞同：0
> 
> 时间：2012-09-01T16:55:10.170
> 
> 标签：c, linker, libc

我是 C 菜鸟，所以这可能是一个愚蠢的问题。我正在尝试编译 C 对象（.o 文件）的 .so 文件（共享库，如果我的术语正确的话），目的是通过 .so 将它们导入 Python `ctypes`。我首先编译了 *.so

```
gcc -shared -o libvARAM.so ARAM.o ARAM_io.o io.o pre.o rule.o stat.o ART.o vARAM.o 
```

这行得通，除了当我尝试通过 ctypes 加载时，我得到了奖励：

```
OSError: ./libvARAM.so: undefined symbol: max 
```

经过一番挖掘，我意识到 max 不是标准的 C 函数。打电话`ldd libvARAM.so`告诉我依赖项之一是`libc.so.6`. 我创建了一个符号链接`libc.so`，`libc.so.6`然后尝试重新编译我的 .so 为

```
gcc -shared -o libvARAM.so ARAM.o ARAM_io.o io.o pre.o rule.o stat.o ART.o vARAM.o -llibc 
```

这产生了

```
/usr/bin/ld: cannot find -llibc 
```

如果我也尝试会产生同样的错误`-L/lib/i386-linux-gnu/ -llibc`。我知道[这个](https://stackoverflow.com/questions/1964880/cannot-find-lib-libc-so-6)线程，但觉得它与我的情况无关，因为解决方案是生成文件。如果这很重要，我正在使用 Xubuntu。

真诚感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:00:50.093

一：链接器标志不能那样工作。对于`libXYZ.so`，相应的链接器标志是 NOT`-llibXYZ`但只是`-lXYZ`。

二：即使这样也不需要，因为 C 标准库 ( `-lc`) 会自动链接到可执行文件。

Three: your problem most likely is that there should be a `max()` **macro** (as opposed to a function) defined in one of the header files, but you don't include this header file, so the compiler doesn't know it's a macro and treats it as a function - thenof course it can't find it in libc.so because it's not there.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:56:16.333

Posting this so that if other newbies see it, they'll see the answer... Basically, my header file was as follows:

```
#ifdef UNIX
#define min(x, y) (x<y ? x : y)
#define max(x, y) (x<y ? y : x)
#endif 
```

Removing the first and last lines (i.e. no `ifdef` check) allowed the compiler to read these definitions. Apparently it had not been reading them.

# boolean - 为什么 Boolean::New() 返回 Handle<> 而其他原语返回 Local<>？

> ID：12229643
> 
> 赞同：5
> 
> 时间：2012-09-01T16:55:12.417
> 
> 标签：boolean, v8, language-implementation

这些是在 V8 C++ API 中创建新原语的函数：

```
Handle<Boolean> v8::Boolean::New(bool value)
Local<Number> v8::Number::New(double value)
Local<String> v8::String::New(const char *data, int length=-1) 
```

我想知道为什么`Boolean`返回 a[`Handle`](http://izs.me/v8-docs/classv8_1_1Handle.html)而其他人返回 a [`Local`](http://izs.me/v8-docs/classv8_1_1Local.html)。

我的假设是它与只有两个可能值的布尔值有关，但不幸的是，文档真的很差，没有提到这样的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T20:03:24.060

这是 Boolean::New: ( [v8.h](http://code.google.com/searchframe#W9JxUuHYyMg/trunk/include/v8.h&q=Boolean%3a%3aNew%20package%3av8%5C.googlecode%5C.com&ct=rc&cd=1&sq=) )的实现

```
Handle<Boolean> Boolean::New(bool value) {
  return value ? True() : False();
} 
```

以下是我们可以从 api.cc 获得的信息：

```
v8::Handle<Boolean> True() {
  i::Isolate* isolate = i::Isolate::Current();
  if (!EnsureInitializedForIsolate(isolate, "v8::True()")) {
    return v8::Handle<Boolean>();
  }
  return v8::Handle<Boolean>(
      ToApi<Boolean>(isolate->factory()->true_value()));
} 
```

看起来他们正在实习每个 Isolate 的 true 和 false 值。AFAIK 这是虚拟机中一种经常使用的技术来减少创建对象的数量 - 例如，Java 实习生所有字符串文字，以及布尔和字节对象（即使在 JVM 规范中只提到了字符串，我我也看到它发生在小整数等）。

# timer - x86 处理器中的时间源

> ID：12229644
> 
> 赞同：6
> 
> 时间：2012-09-01T16:55:14.777
> 
> 标签：timer, x86, computer-architecture

有人知道可用于测量时间的 x86 指令吗？软件可以访问导致任务切换的计时器吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T13:00:07.917

在 x86 平台上测量时间的方法：

*   实时时钟 - 操作系统的时间和日期来源。1 秒精度。标准 PC 中唯一可用于测量绝对时间的时间源。

*   [8254 计数器/定时器](http://en.wikipedia.org/wiki/Intel_8253)- 自 PC 诞生之初就出现在主板上的标准计数器/定时器芯片（现在是芯片组内的功能块）。这是 IRQ0 的传统来源，这是在大多数旧操作系统中执行任务切换的定时器中断。

*   RDTSC 汇编指令 - 计算 CPU 时钟周期。有关一些使用细节，请参阅 Anon ymous 发布的答案。对于 x86 上的时间源，几乎可以找到最高级别的精度。但是，它有一些准确性问题。如果您在汇编中编写，这也是最方便的选择。

*   RDTSCP 汇编指令 - 类似于 RDTSC，但已序列化，这解决了 RDTSC 的一些准确性问题。只能在最新的处理器上找到。

*   [HPET](http://en.wikipedia.org/wiki/High_Precision_Event_Timer) - 在 PC 的 Core Duo 时代推出。旨在替代古老的 8254。现代操作系统将使用它作为他们的任务调度中断（Vista 和更高版本）

*   芯片组中的专有定时器 - 一些芯片组具有内置的特殊定时器，用于电源管理和多媒体功能。假设您正在处理固定功能的嵌入式系统而不是通用 PC，您有时可以将这些用于您自己的应用程序。

请注意，根据您的操作系统和硬件，并非所有这些选项都可供您使用。如果您在现代操作系统（Windows、Linux）下运行，它将控制 8254/HPET 以满足其自身的时间需求，因此您将无法使用它们。

在现代操作系统下，通常最好使用操作系统提供的计时功能。如果您尝试使用它，操作系统开发人员可能已经解决了很多您自己会遇到的问题。（请注意，操作系统可能提供多种计时功能。请选择适合您应用的一种。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T17:07:42.983

您可以使用`rdtsc`.Just 从当前值中减去以前的值来计算时间差。

> 将处理器的时间戳计数器（64 位 MSR）的当前值加载到 EDX:EAX 寄存器中。EDX 寄存器加载了 MSR 的高 32 位，EAX 寄存器加载了低 32 位。（在支持 Intel 64 架构的处理器上，RAX 和 RDX 的高 32 位被清除。）

[这是实现此指令的 C 代码](http://www.cs.utexas.edu/users/habals/blog/index.php/archives/70)：-

```
unsigned long long int rdtsc(void)
{
   unsigned long long int x;
   unsigned a, d;

   __asm__ volatile("rdtsc" : "=a" (a), "=d" (d));

   return ((unsigned long long)a) | (((unsigned long long)d) << 32);;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T05:29:04.770

这是执行此操作的 FORTRAN 可调用例程：

汇编指令 RDTSC 返回一个 64 位整数，它是自年点以来的 CPU 时钟计数数。如果您的 FORTRAN 有 64 位整数，则参数 KOUNT 仅声明为 INTEGER*8。否则将其声明为两个 32 位 INTEGER*4 的数组

所以在你的 FORTRAN 程序中你写

```
CALL TIMERR(KOUNT) 
```

在开始时，保存 KOUNT 的值，然后在结束时重复。然后减去两个 64 位值以确定经过的时间。我通常只费心减去两个较低的单词，因为我的时间通常少于 2^32 系统时钟

它也可以从 C 调用，但我不会说 C。

```
; C This assembler routine looks to FORTRAN like this:
;       SUBROUTINE TIMERR(KOUNT)
;       INTEGER*4 KOUNT(2);  or INTEGER*8 KOUNT
;       ...get a 64-but system time value into KOUNT......
;       RETURN
;       END
;
.Code
_TIMERR@4: RDTSC
         Push Eax
    Push Ecx
    Push Edx
    Mov Ecx, [Esp + 16]
    Mov [Ecx], Eax
    Mov [Ecx + 4], Edx
    Pop Edx
    Pop Ecx
    Pop Eax
    Ret 4 
```

# javascript - html5拖放文件-提交整个表单时上传

> ID：12229649
> 
> 赞同：5
> 
> 时间：2012-09-01T16:55:48.563
> 
> 标签：javascript, html

是否可以在表单提交中包含“拖放”文件？有很多异步上传的选项。

是否可以捕获文件数据并将其包含在表单字段中？

我使用 Rails 作为我的服务器，因此理想情况下，图像的数据将适合如下形式：

```
<form multipart='multipart' >
  <select name='files[type_id]'>
     ...
     ...
  </select>
  <!-- FILE DATA ?  -->
  <div id="file_drop_spot">

  </div>

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:19:49.753

我在上面发现了这个问题：[将文件拖放到标准 html 文件输入中](https://stackoverflow.com/questions/8006715/drag-drop-files-into-standard-html-file-input)

我不相信这是可能的，但你可以达到效果。当您提交表单时，请阻止其默认行为并开始使用 ajax 上传文件。文件上传完成后，您再次指向表单并提交它，而不会阻止其默认行为。

就像是：

```
<form id="form">
     <input type="text" name="someText"></input>
     <input id="submitButton" type="submit" onclick="uploadFile()"></input>
</form> 
```

然后是javascript：

```
function uploadFile() {

    document.getElementById("submitButton").disabled = true;
    // Some ajax code to upload the file and then on the success:
    success: function() {

        document.getElementById("form").submit();

    }
    return false; // Prevent the form from submitting

} 
```

# php - Ajax 请求对 JSON 不成功

> ID：12229656
> 
> 赞同：0
> 
> 时间：2012-09-01T16:57:16.703
> 
> 标签：php, jquery

```
$.ajax({        
    //check all selections are made
    type: "POST",
    url: "checkin_process.php",
    dataType: "json",
    data: dataString,                                    
    sucsess: function(){
        // alert(data.success);
        alert("sucess");
        $("#message").fadeOut(5000);  
    },
    statusCode: {            
        406: function() {                
            alert("sucess");
        },            
        409: function() {                
            alert("err");
        }            
    }
}); 
```

在这段代码中，ajax 请求只返回错误而不是成功。

但在`json`文件中，它会正确返回 json 编码的数据。知道有什么问题吗？

# c# - 使用 nhibernate 进行分页

> ID：12229657
> 
> 赞同：1
> 
> 时间：2012-09-01T16:57:31.837
> 
> 标签：c#, asp.net-mvc-3, nhibernate, pagination

我正在为 asp mvc 应用程序在 nhibernate pagination primary 中搜索最佳使用模式。此外，值得一提的是，查询不应使用期货，因为并非所有数据库都支持。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:14:21.330

将 linq( `session.Query`) 与`Skip`和一起使用`Take`。这应该适用于大多数提供者，它可能是实现它的最简单方法。

例如，要获取长度为 10 的第 3 页，您可以调用：

```
 var pageEntities = session.Query<YourEntityType>().Skip( 20 ).Take( 10 ); 
```

# java - Java/SPNEGO：不需要的 SPN 规范化？

> ID：12229658
> 
> 赞同：3
> 
> 时间：2012-09-01T16:57:36.937
> 
> 标签：java, windows, kerberos, spnego, spn

我目前正在尝试使用 SourceForge 中的[SPNEGO 库](http://spnego.sourceforge.net/)（服务器使用相同的库）将 Java 客户端实现到受 SPNEGO 保护的 Web 服务。我无法让它成功验证，我的请求总是以

```
HTTP/1.1 500 Failure unspecified at GSS-API level (Mechanism level: Checksum failed) 
```

这类似于我从具有不适当主机名的浏览器访问 Web 服务时得到的症状，并且确实 Wireshark 中的一些调试显示客户端发送了错误的 SPN 与请求 - 我发送到`service-test.client.com`注册为 SPN并且在 DNS 中有`A`记录，但在 Windows 域中注册为`server-1234.client.corp`. 即使我将请求发送到`http://service-test.client.com`（请参阅匹配`Host`的标头），Java 请求票证的 SPN 是“内部”Windows 名称：

![HTTP 请求的 Wireshark 解码](../Images/d6e12158f76c3bb8fbc9099c910d32e0.png)

从 Chrome 或 IE 发送的相同内容具有匹配的`Host`标头和 SPN：

![在此处输入图像描述](../Images/1af2fa55e45e3f6db143d446551780ad.png)

由于在我的代码或 SPNEGO 库中没有发生这种转换，我认为它一定是在 JRE 中发生的。我一直在研究 JGSS 源代码，但有点难以理解。谁能告诉我如何跳过这个翻译并获得正确 SPN 的票？

客户端代码：

```
SpnegoHttpURLConnection con = new SpnegoHttpURLConnection("spnego-client", user, password);
con.connect(new URL("http://service-test.client.com:8083/service"));
int rc = con.getResponseCode();
String msg = con.getResponseMessage(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:29:02.660

从上面的评论中总结：

重新检查您的 DNS。进行反向查找。大多数问题是由不正确的反向 DNS 条目引起的。

[RFC2713](http://www.ietf.org/rfc/rfc2743.txt)中的第 85页可能会对您有所帮助并检查[RFC4120](http://www.ietf.org/rfc/rfc4120.txt)并搜索“canon”。

当使用 GSS-API 构建基于主机的服务的 SPN 时，您必须使用目标机制规范化该名称。RFC 说

> 当解析对这种类型的名称的引用时，可以通过尝试 DNS 查找并使用返回的完全限定域名或使用“主机名”来规范化“主机名”（作为示例实施策略）如果 DNS 查找失败，则提供。规范化操作还将主机名映射为小写字符。

Kerberos 5 RFC 说：

> 服务器和传输时。因此，例如，不应依赖未受保护的 DNS 记录将主机别名映射到服务器的主名称，接受主名称作为要联系的一方，因为攻击者可以修改映射并冒充派对。
> 
> Kerberos 和基于 Kerberos 的协议的实现不得使用不安全的 DNS 查询来规范化服务主体名称的主机名组件（即，它们不得使用不安全的 DNS 查询将一个名称映射到另一个名称以确定主体名称的主机部分哪一个是用来交流的）。在没有安全名称服务的环境中，应用程序作者可以在将名称传递给安全机制之前将静态配置的域名附加到不合格的主机名，但他们不应做更多。安全名称服务设施（如果可用）可能会被信任用于主机名规范化，但 KDC 实现不应要求客户端的此类规范化。
> 
> 实施说明：许多当前实施对提供的服务名称进行了一定程度的规范化，通常使用 DNS，即使它会产生安全问题。但是，对于服务名称是否折叠为小写或是否使用反向解析，实现之间没有一致性。为了最大限度地提高互操作性和安全性，应用程序应该提供安全机制，其名称是通过将用户输入的名称折叠为小写而不执行任何其他修改或规范化而产生的。

似乎 GSS-API impls 可能会规范化，但如果 DNS 不受信任，Kerberos 不应该这样做。所以这取决于。完成反向查找是非常自然的。这就是 Kerberos 验证主机名的方式。如果您正在运行 DNS 循环，这实际上是至关重要的。没有它，它将永远无法构建真正的 SPN。

虽然我真的会在 Kerberos 邮件列表中这样做。这是一个非常有趣的观点。

[`krb5_sname_to_principal`](http://web.mit.edu/kerberos/krb5-current/doc/krb_appldev/refs/api/krb5_sname_to_principal.html)我已经检查了 MIT Kerberos 实现，如果您检查以下源代码，那么实际上有一个方法可以做到这一点`sn2princ.c`：

```
if (type == KRB5_NT_SRV_HST) {
        struct addrinfo *ai = NULL, hints;
        int err;
        char hnamebuf[NI_MAXHOST];

        /* Note that the old code would accept numeric addresses,
           and if the gethostbyaddr step could convert them to
           real hostnames, you could actually get reasonable
           results.  If the mapping failed, you'd get dotted
           triples as realm names.  *sigh*

           The latter has been fixed in hst_realm.c, but we should
           keep supporting numeric addresses if they do have
           hostnames associated.  */

        memset(&hints, 0, sizeof(hints));
        hints.ai_flags = AI_CANONNAME;
        err = getaddrinfo(hostname, 0, &hints, &ai);
        if (err) {
#ifdef DEBUG_REFERRALS
            printf("sname_to_princ: failed to canonicalize %s; using as-is", hostname);
#endif
        }
        remote_host = strdup((ai && ai->ai_canonname) ? ai->ai_canonname : hostname);
        if (!remote_host) {
            if(ai)
                freeaddrinfo(ai);
            return ENOMEM;
        }

        if ((!err) && maybe_use_reverse_dns(context, DEFAULT_RDNS_LOOKUP)) {
            /*
             * Do a reverse resolution to get the full name, just in
             * case there's some funny business going on.  If there
             * isn't an in-addr record, give up.
             */
            /* XXX: This is *so* bogus.  There are several cases where
               this won't get us the canonical name of the host, but
               this is what we've trained people to expect.  We'll
               probably fix it at some point, but let's try to
               preserve the current behavior and only shake things up
               once when it comes time to fix this lossage.  */
            err = getnameinfo(ai->ai_addr, ai->ai_addrlen,
                              hnamebuf, sizeof(hnamebuf), 0, 0, NI_NAMEREQD);
            freeaddrinfo(ai);
            if (err == 0) {
                free(remote_host);
                remote_host = strdup(hnamebuf);
                if (!remote_host)
                    return ENOMEM;
            }
        } else
            freeaddrinfo(ai);
    } 
```

所以，我想我们必须通过邮件列表询问。

# nlp - 如何识别形容词或副词？

> ID：12229661
> 
> 赞同：0
> 
> 时间：2012-09-01T16:57:59.613
> 
> 标签：nlp, sentiment-analysis, semantic-analysis

我对 NLP 很陌生……是否有任何 API 或方法可以让我从句子中识别动词、形容词或副词？我在项目中需要它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T23:31:58.347

您将需要一个[词性标注](http://en.wikipedia.org/wiki/Pos-tagging)器 (POSTagger)。这确定了句子中每个单词的作用。维基百科有一个[很好](http://en.wikipedia.org/wiki/List_of_natural_language_processing_toolkits)的 NLP 工具包列表，它们几乎都有 POSTaggers。

如果您的材料是正常的书面英语，POSTaggers 会做得很好。如果它非常口语化（例如在短信中）或非常不寻常（例如行话），它可能会变得更糟。请注意，对于专业语言（我做化学），您可能还需要一个标记器来计算单词标记的位置。

你提到“情绪分析”。这是更多的工作，但绝对需要系统中的 POSTagger。您还提到了语义分析-为此，您可能需要语义词典。但是从 POSTagger 开始，然后练习常用句子。

# php - mysql + php 加速

> ID：12229667
> 
> 赞同：0
> 
> 时间：2012-09-01T16:58:55.333
> 
> 标签：php, mysql, performance

php script 1 -INSERT 500 record per second and php script 2 -UPDATE some data to that table (500 per second)

Web 应用程序 SELECT 数据到数据库以查看数据、绘制统计数据等

我的问题是，在应用程序同时向表中插入/更新数据时，查看数据需要很长时间。

谁能为此提供解决方案？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:05:18.153

您可以只使用一个查询来插入：

例子：

```
INSERT INTO table (id,value) VALUES (1,2), 
                                    (2,3), 
                                    (3,4),
                                     ... 
```

在某些也适用于更新的条件下

## 编辑

根据您的评论，您可以使用`INSERT DELAYED`

或者您可以使用 apccache 或 memcached 将值最初存储在内存中，而不是使用上面的查询每次 X 次将其刷新到 db 中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:11:55.580

如果您的`SELECT`子句主要是聚合数据，或者每次调用它们时都绝对准确不是关键任务，您可以尝试将隔离级别更改为`READ COMMITTED`，或者`READ UNCOMMITTED`这应该可以提高`SELECT`子句的速度。您可以在此处阅读有关差异的信息：

[http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html](http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html)

# iphone - 根据 Admob 横幅大小调整视图 -ios

> ID：12229670
> 
> 赞同：0
> 
> 时间：2012-09-01T16:59:11.090
> 
> 标签：iphone, ios, ipad, admob

我是否需要调整视图中组件的位置以避免将它们隐藏在 Admob 横幅中。或者有什么简单的方法可以在添加接收时自动重新排列视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:58:48.953

一般建议是在应用程序底部为横幅留出空间，这样您就不必将其余元素移入`adViewDidReceiveAd`. 如果您热衷于在没有广告返回的情况下利用此空间，您可能会发现新的 iOS 6 自动布局 API 很有帮助。

# c# - 在 HLSL 中绘制超椭圆

> ID：12229671
> 
> 赞同：3
> 
> 时间：2012-09-01T16:59:26.203
> 
> 标签：c#, math, hlsl, ellipse

**更新：关于如何使用 Superformula 绘制的答案在最后**

[我需要使用SuperEllipse](http://en.wikipedia.org/wiki/Superellipse)绘制一个像这样的圆角矩形。 ![在此处输入图像描述](../Images/7327fd12b80faaafa17be665cb1f2b03.png)

可以在任何地方轻松绘图时绘制一个：

![在此处输入图像描述](../Images/1b539ef755dea815ec8d0c22ac32ac9e.png)

但是在你不能的 HLSL 中，我陷入了绘制或不绘制像素的条件：

![在此处输入图像描述](../Images/10ef08f661edf2d32e006fed6eb95201.png)

这是 HLSL 代码：

```
sampler2D input : register(s0);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>10.0</maxValue>
/// <defaultValue>4.0</defaultValue>
float N : register(C1);

static const float pi = 3.1415926535f;

float2 superEllipse(float n, float a, float b, float theta)      
{
    float ct = cos(theta);
    float st = sin(theta);
    float x = a * sign(ct) * pow(abs(ct), 2.0f / n);
    float y = b * sign(st) * pow(abs(st), 2.0f / n);
    return float2(x, y);
}

float4 main(float2 uv : TEXCOORD) : COLOR 
{
    float2 uv1 = uv * float2(2.0f, 2.0f) - float2(1.0f, 1.0f);
    float angle = degrees(atan2(uv1.y, uv1.x)) + 180.0f;
    float tMax = pi * 2.0f;
    float theta = 1.0f / 360.0f * angle * tMax;
    float2 se = superEllipse(N, 1, 1, theta);
    float angle1 = degrees(atan2(se.y, se.x)) + 180.0f;
    float2 zero = float2(0.0f, 0.0f);
    float dist1 = distance(se, zero);
    float dist2 = distance(uv1, zero);

    float4 color = float4(0, 0, 0, 1);
    if(dist2 <= dist1)
        color += float4(0, 1, 0, 1);
    return color;

} 
```

错误似乎与“dist1”和“dist2”变量有关。

（使用[Shazzam](http://shazzam-tool.com/)创建）

这是有效的 C# 代码：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
        }

        private void Run()
        {
            const double halfPi = Math.PI*2.0d;
            double nValue = trackBar1.Value/10.0d;
            double aValue = trackBar2.Value/100.0d;
            double bValue = trackBar3.Value/100.0d;
            label1.Text = nValue.ToString("F2");
            label2.Text = aValue.ToString("F2");
            label3.Text = bValue.ToString("F2");
            double n = nValue;
            double a = aValue;
            double b = bValue;

            // Build list of points
            const int points = 100;
            const double step = 360.0d/points;
            var list = new List<PointF>();
            for (int i = 0; i <= points; i++)
            {
                double angle = step*i;
                double t = 1.0d/360.0d*angle;
                double theta = t*halfPi;
                double x;
                double y;
                SuperEllipse.Evaluate(n, a, b, theta, out x, out y);
                list.Add(new PointF((float) x, (float) y));
            }

            /* Drawing */
            // Scale and center
            for (int index = 0; index < list.Count; index++)
            {
                PointF pointF = list[index];
                pointF.X++;
                pointF.Y++;
                pointF.X *= (pictureBox1.Width - 10)/2f;
                pointF.Y *= (pictureBox1.Height - 10)/2f;
                pointF.X += 5;
                pointF.Y += 5;
                list[index] = pointF;
            }
            // Draw and show
            var bitmap = new Bitmap(pictureBox1.Width, pictureBox1.Height);
            using (Graphics graphics = Graphics.FromImage(bitmap))
            {
                //graphics.TranslateTransform(1, 1);
                graphics.DrawLines(Pens.Red, list.ToArray());
                // graphics.FillClosedCurve(Brushes.Red, fs, FillMode.Alternate);
            }
            if (pictureBox1.Image != null)
            {
                pictureBox1.Image.Dispose();
            }
            pictureBox1.Image = bitmap;
        }

        private void trackBar1_Scroll(object sender, EventArgs e)
        {
            Run();
        }

        private void trackBar2_Scroll(object sender, EventArgs e)
        {
            Run();
        }

        private void trackBar3_Scroll(object sender, EventArgs e)
        {
            Run();
        }
    }

    public static class SuperEllipse
    {
        public static void Evaluate(double n, double a, double b, double theta, out double x, out double y)
        {
            double cost = Math.Cos(theta);
            double sint = Math.Sin(theta);
            x = a*Math.Sign(cost)*Math.Pow(Math.Abs(cost), 2.0d/n);
            y = b*Math.Sign(sint)*Math.Pow(Math.Abs(sint), 2.0d/n);
        }
    }
} 
```

**更新**

HLSL 中的 SuperFormula（仍然不正确） ![在此处输入图像描述](../Images/1300af742283d3f15e10f8b1084a46ba.png)

```
sampler2D input : register(s0);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>8.0</maxValue>
/// <defaultValue>1.0</defaultValue>
float A : register(C0);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>8.0</maxValue>
/// <defaultValue>1.0</defaultValue>
float B : register(C1);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>8.0</maxValue>
/// <defaultValue>1.0</defaultValue>
float M : register(C2);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0, 0.0, 0.0</minValue>
/// <maxValue>8.0, 8.0, 8.0</maxValue>
/// <defaultValue>1.0, 1.0, 1.0</defaultValue>
float3 N : register(C3);

float4 main(float2 uv : TEXCOORD) : COLOR 
{
    float2 uv1 = uv * float2(2.0f, 2.0f) - float2(1.0f, 1.0f);
    float angle = degrees(atan2(uv1.y, uv1.x)) + 180.0f;
    float mt = M * angle / 4.0f;
    float magnitude = pow((pow((cos(mt) / A), N.y) + pow((sin(mt) / B), N.z)), -(1.0f / N.x));
    float2 zero = float2(0.0f, 0.0f);
    float dist1 = distance(uv1, zero);
    float4 color = float4(0, 0, 0, 1);
    if(dist1 <= magnitude)
        color += float4(dist1, 1, 0, 1);
    return color;
} 
```

最后，感谢 Kevin ，使用[Superformula的圆角矩形：](http://en.wikipedia.org/wiki/Superformula)

![在此处输入图像描述](../Images/8b9eda3baba4fbb41726b640432d3121.png)

```
sampler2D input : register(s0);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>8.0</maxValue>
/// <defaultValue>1.0</defaultValue>
float A : register(C0);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>8.0</maxValue>
/// <defaultValue>1.0</defaultValue>
float B : register(C1);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0</minValue>
/// <maxValue>8.0</maxValue>
/// <defaultValue>8.0</defaultValue>
float M : register(C2);

/// <summary>Explain the purpose of this variable.</summary>
/// <minValue>0.0, 0.0, 0.0</minValue>
/// <maxValue>8.0, 8.0, 8.0</maxValue>
/// <defaultValue>1.0, 1.0, 1.0</defaultValue>
float3 N : register(C3);

float4 main(float2 uv : TEXCOORD) : COLOR 
{
    float2 uv1 = uv * float2(2.0f, 2.0f) - float2(1.0f, 1.0f);
    float angle = atan2(uv1.y, uv1.x);
    float mt = M * angle / 4.0f;
    float magnitude = pow((pow((abs(cos(mt)) / A), N.y) + pow((abs(sin(mt)) / B), N.z)), -(1.0f / N.x));
    float2 zero = float2(0.0f, 0.0f);
    float dist1 = distance(uv1, zero);
    float4 color = float4(0, 0, 0, 1);
    float alpha = 1.0f / magnitude * dist1;
    if(dist1 <= magnitude)
        color += float4(1, 0.5, 0, 1);

    return color;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T16:29:15.837

出现问题是因为`superEllipse(theta)`返回一个角度不一定为 的点`theta`。例如，`superEllipse(3.6)`返回一个角度为 3.2 弧度的点。因此，在您的函数中，比较 和 的大小并`main()`没有真正意义，因为它们具有不同的角度。`uv1``se`

看到[这张图片](https://i.imgur.com/9bZ4r.gif)。扫过的直线表示传入 的角度`superEllipse`，曲线的末端表示新点实际放置的位置。新点很少位于扫描线上。

如果您对超椭圆使用极坐标方程，而不是参数方程，那么您可以使用它来执行距离测试。方便的是，[Wolfram Mathworld](http://mathworld.wolfram.com/Superellipse.html)有这样一个方程：

![在此处输入图像描述](../Images/530dcdfd468259dac53650c71c2f33ab.png)

您只需要编写代码并将其放入您的 main 函数中。

```
float4 main(float2 uv : TEXCOORD) : COLOR 
{
    float2 uv1 = uv * float2(2.0f, 2.0f) - float2(1.0f, 1.0f);
    float angle = degrees(atan2(uv1.y, uv1.x)) + 180.0f;
    //to do: implement equation shown above. Use `angle` for theta.
    //`m` should be 4 if you want a four-pronged shape.
    float magnitude = ??? 

    float2 zero = float2(0.0f, 0.0f);
    float dist1 = distance(uv1, zero);
    float4 color = float4(0,0,0,1);
    if (dist1 <= magnitude) //uv is inside the superellipse
        color += float4(0,1,0,1);
    return color;
} 
```

# c - 使用 c 分割一个数字

> ID：12229672
> 
> 赞同：0
> 
> 时间：2012-09-01T16:59:28.880
> 
> 标签：c

下面的代码片段从用户那里获取一个整数（即数字）并打印该数字中所有数字的计数，但是，如果我在某处输入一个包含 0 的数字，它会立即退出 while 循环（因为while 循环条件）。我尝试修复这个错误，但我不能。你能帮我解决它吗？谢谢你。

```
int count = 0;
int rem = number % 10;

while(rem != 0) {
   number /= 10;
   ++count;
   rem = number % 10;

}//end while

printf("The count is %d", count); 
```

无需共享代码，如果您可以通过文本引导我完成，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:00:43.357

也许应该是：

```
while (number != 0) 
```

* * *

`rem`除非您打算做的不仅仅是数位数，否则您似乎不需要其他东西（等）。无论如何，您可能希望`rem = number % 10;`在除法之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T17:04:31.103

没有必要用剩余的数字来计算每个数字。只需继续除以 10 直到达到 0：

```
while(number != 0) {
  number /= 10;
  ++count;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:03:23.413

（来吧，这是小学数学！）

如果某处有零，那么 0 模 10 将得到 0（您还期望什么？），所以它自然退出循环。您想要的是检查数字*本身*是否已全部向右移动，最终达到 0：

```
while (number != 0) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T17:05:11.097

`while`当您输入带有 0 的数字时，循环结束的原因是循环条件是`rem != 0`. 如果你看一看，`rem`变成 的最后一位`number`。因此`while (number != 0)`，您需要确保遍历每个数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-02T02:05:34.567

正如前面所有 4 个答案中提到的，循环是

```
while(number > 0) {
   ++count;
   number /= 10;
}//end while 
```

另一种选择是将用户输入保留为字符串（假设该数字作为参数提供给程序）并仅打印字符串长度，

```
char number[30];
strcpy(number,argv[1]);
printf("The count is %d\n", strlen(number)); 
```

# c++ - C/C++ 中的调试原理/核心主题

> ID：12229674
> 
> 赞同：10
> 
> 时间：2012-09-01T16:59:50.990
> 
> 标签：c++, c, debugging, testing

我有兴趣投入大量时间来提高我的调试能力，并且正在寻找我需要涵盖的核心主题列表，以便精通常用和高级调试/测试技术的原则。

最初，我想我会通读 gdb 文档并从其功能中收集调试技术；但是，除了跳进去获取段错误的行号并可能运行之外`bt`，几个月后我仍然采用 mass`printf`作为我的默认策略。我觉得这是因为我没有任何明确的策略可以通过更复杂的方式实现。

尽管我的问题与 C/C++ 相关，并且虽然我在 UNIX 环境中操作，但如果它们能提高我对关键概念的理解，我愿意查看通用材料，甚至其他语言涵盖的主题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T17:08:30.390

您应该考虑多种直接策略：

*   大量 printfs 迫切需要**日志记录**解决方案。您在这里有很多选择，但广泛记录并不是一个特别糟糕的策略，它实际上对于任何形式的客户端调试都至关重要。
*   广泛使用**断言**（并且永远不要禁用它们，即使在“发布”代码中）。始终为所有潜在错误编写检查并尽快失败（在 C++ 中使用异常——始终抛出，从不捕获）。
*   在 emacs 中学习**掌握 gdb**很有用。学习如何单步执行程序、如何设置断点以及如何检查局部变量通常绰绰有余。
*   **单元测试**也是需要考虑的事情。特别是因为小型测试更容易调试，因为它们不会被功能齐全的程序的噪音所包围。在代码之前编写测试，或者更好的是让其他人编写测试。

更一般地说，以下几点虽然与调试没有直接关系，但会让您受益：

*   **了解**程序是如何执行的（例如了解堆栈帧和汇编的小介绍）在某些错误正在破坏内存的情况下可能很有用。更一般地说，永远不要停止学习有关您的环境的东西。
*   在 C++ 中，使用**良好实践**：RAII、标准库、尽快失败等。这具有减少调试工作量的强烈趋势，尤其是。因为调试器可以很好地打印标准库中的东西。此外，尽可能简单地编写代码对调试时间有积极影响。
*   使用（分布式）**版本控制**。总是。一旦你习惯了它，你就会看到它的好处（例如，结合单元测试，你可以得到全能[`git bisect`](http://www.kernel.org/pub/software/scm/git/docs/git-bisect.html)的东西）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T17:07:37.910

如果你想成为一个更高级的C/C++调试器，学习一些汇编（你不需要成为专家，只要一些基础知识就可以了），学习机器寄存器，学习你平台的ABI（应用程序二进制接口） ，特别是函数参数和堆栈是如何工作的），这样您就不必`printf`到处依赖 ' 来查看程序在做什么。学习如何检查内存也是一个好主意，并且知道您在内存地址中寻找什么，一旦您在汇编方面做得不错并了解机器指令如何与寄存器集交互，您将很快知道在哪里查找要设置为观察点的指针地址或内存位置或查找为块并查看给定内存位置中的数据结构发生了什么。

例如，如果某些事情发生在几级以下，调试递归算法可能会很困难......取决于多少级，您最终可能会输出大量需要永远筛选的数据，或者您可能会发现自己停在一个永远的断点。但是，如果您了解堆栈如何与递归算法一起工作，则可以设置条件断点来监视堆栈指针寄存器以及堆栈上的其他内存地址，以在递归算法中的错误点正确停止程序发生，而不必筛选无意义的数据。所以你运行你的程序直到它停止，检查回溯，查看堆栈上的一些变量以及堆栈指针寄存器，

顺便说一句，作为一个快速说明，不要使用`printf`... 它被缓冲在 上`stdout`，这意味着当您在输出上看到错误时，您的错误可能已经传播到其他东西，例如奇怪的内存损坏错误等。甚至如果您`stdout`通过放置结束行字符等来刷新缓冲区，您仍然会最终将错误消息与程序的正常输出混合。而不是`printf`使用`fprintf`, 并输出到`stderr`. 这不会被缓冲，它会立即打印到输出，并且如果您希望保存程序的输出，错误消息将不会与程序的输出混合。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T17:35:03.897

我想多介绍一下使用断言的技术。

断言使您可以在代码中的任何位置指定您期望为真的内容。在函数的开头，您可以使用断言来确保参数具有合理的值。这些被称为先决条件。而函数结束时，你可以检查以确保你即将返回的内容与函数的目的一致。这些被称为后置条件。在函数的中间，您可以确保任何中间计算都是合理的（尽管您通常应该尝试使您的函数足够小，以便没有很多中间计算）。

使用类，您可以检查以确保将好的值传递给构造函数。在其他方法中，您可以在方法返回之前确保类的一般状态是合理的。这些被称为不变量。

在调试的时候，我通常会发现 bug 很难找到，因为我错过了一些断言，让崩溃离问题的根源越来越远。我使用调试过程来帮助解决这个问题。我从崩溃实际发生的地方开始，然后思考“在这个抽象级别，出了什么问题？”。如果它在函数中间崩溃，我可能会意识到传递给函数的参数不正确，所以我在函数开头附近添加了额外的断言来捕捉这些。当我下次运行它并且它崩溃时，崩溃发生得更快。如果崩溃现在发生在函数的顶部，我会上一层堆栈并询问“为什么调用者没有传递正确的值？”。然后我可能会意识到一些中间计算是错误的，所以我在那里添加了一个断言以便更早地捕获它。中间计算可能是由于另一个函数返回了错误的值，在这种情况下，我将添加一个后置条件断言来更早地捕获它。可能是由于当前函数没有传递正确的参数，所以我在这个函数中添加了一个前置条件断言。

每次我添加一个断言时，我都会让崩溃更接近问题的真正根源。最终我到达了崩溃发生在真正的逻辑错误的地步，并且修复是显而易见的。但是通过这个过程，我也让未来的问题更容易被发现。

在进行单元测试时，您可以应用类似的推理。问“我的测试出了什么问题，导致这个问题没有被更早发现？”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-01T21:15:19.717

诉诸 没有错`printf`。事实上，它有很多优点：

*   `printf`已被注释掉的语句清楚地表明了*过去*的调试尝试，这表明该代码区域*可能*存在可疑之处。

*   `printf`如果陈述冗长且精心制作，则**易于理解。**即使是初学者也了解它们的含义以及如何使用它们。

*   `printf`陈述实际上**迫使您思考问题**以及*导致*问题的原因。你必须尝试遵循逻辑控制流和数据流来*理解问题*。这会加强你对*整个*系统的理解。

事实上，我认为那些被教导依赖工具来调试他们的代码的人倾向于先查阅他们的工具，然后才真正*试图*找出他们代码中不良行为的原因！当然，在许多情况下，调试器是首选，但很明显，首先**思考**而不是盲目转向调试器的人是天生就能更好地理解问题、更好地理解程序的错误状态并最终**更好地理解问题的原因**。

[让我在这里引用**Rob Pike**的话：](http://www.informit.com/articles/article.aspx?p=1941206)

> “当出现问题时，我会本能地开始深入研究问题，检查堆栈跟踪，坚持打印语句，调用调试器等等。但肯只是站着思考，无视我和我们的代码” d 刚写完。过了一会儿，我注意到一个模式：Ken 经常会先于我理解问题，然后突然宣布，“我知道哪里出了问题。”他通常是正确的。我意识到 Ken 正在建立一个心理模型当代码出现问题时，它就是模型中的错误。通过思考这个问题是*如何*发生的，他会直觉地知道模型在哪里出错，或者我们的代码在哪里不能满足模型。
> 
> Ken 告诉我，调试前的思考非常重要。如果你深入研究 bug，你倾向于修复代码中的局部问题，但如果你首先考虑 bug，bug 是如何产生的，你经常会发现并纠正代码中更高级别的问题，这将改进设计并防止进一步的错误。”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T17:03:40.643

您可能想阅读一本关于“测试驱动开发”(TDD) 的书，例如 Kent Beck 的书。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-02T06:40:59.003

学习如何使用 Valgrind，至少它是默认工具[Memcheck](http://www.valgrind.org/docs/manual/mc-manual.html)。在调试各种内存管理问题时，它将为您节省大量时间，例如：

*   溢出和未运行的堆块
*   使用未定义的值
*   使用已经释放的对象

# google-app-engine - Google Drive 在 python 中读取部分文件

> ID：12229675
> 
> 赞同：2
> 
> 时间：2012-09-01T17:00:11.243
> 
> 标签：google-app-engine, google-drive-api

我有一个 App Engine 站点，我想从 Google Drive 中的文件中获取最后 300 个字节。我尝试将 HTTP Range 标头与 Python 的 urllib2 一起使用，如下所示：

```
req = urllib2.Request(url)
req.headers['Range'] = 'bytes=%s-%s' % (-300, 2)
f = urllib2.urlopen(req)
# This shows you the *actual* bytes that have been downloaded.
range=f.headers.get('Content-Range')
logging.info("range:"+range)
logging.info("read:"+(f.read())) 
```

url 实际上是文件元数据中的“downloadurl”属性。运行它时出现此错误

```
 File "C:\Python27\lib\urllib2.py", line 527, in http_error_default
    raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)
HTTPError: HTTP Error 401: Unauthorized 
```

是否可能不接受 Range 标头？我真的不想下载整个文件。有解决方案的人吗？

编辑

感谢@Claudio Cherubino 的回答！

```
creds = GetSessionCredentials() //from Google Python Client API
size = int('size of my file')
headers = {"Range" : 'bytes=%s-%s' % (size-300, size)} //Range Header
http = httplib2.Http()
http = creds.authorize(http) //add OAuth credentials
resp, content = http.request(url, "GET", body=None, headers=headers)
if resp.status == 206:
   print 'Status: %s' % resp
   print "content:"+content
else:
    print 'An error occurred: %s' % resp 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:32:13.680

您必须按照文档中的说明向您的请求添加 OAuth 令牌：[https ://developers.google.com/drive/credentials](https://developers.google.com/drive/credentials)

# c# - DLL 和内存不足异常

> ID：12229677
> 
> 赞同：3
> 
> 时间：2012-09-01T17:00:31.973
> 
> 标签：c#, matlab, dll, matlab-deployment

我正在研究生成 .Net dll 的 matlab deploytool。当我从 dll 调用函数时，它会因为内存不足异常而崩溃。在matlab中运行正常，没有任何异常。如何避免这种异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T08:17:54.317

Simply, work on Windows 64-bit and this memory exception will be gone.

# php - WAMP 中 Gd 的 PHP 问题（imagejpeg 不起作用）

> ID：12229685
> 
> 赞同：0
> 
> 时间：2012-09-01T17:01:30.860
> 
> 标签：php, gd, wamp

我在 windows XP 32bit 上使用 WAMP 2.2。我尝试制作简单的 php 脚本来绘制图像，但是出了点问题，我回到了 web 上的简单示例。但即便如此，图像也不会显示（只有“空白图像”图标）。

这是示例代码（来自 php 网页）：

```
<?php 
$im = imagecreatetruecolor(120, 20); 
$text_color = imagecolorallocate($im, 233, 14, 91); 
imagestring($im, 1, 5, 5, 'A Simple Text String', $text_color); 

header('Content-Type: image/jpeg');

imagejpeg($im); 
imagedestroy($im); 
?> 
```

最好的事情是当我在“imagejpeg”方法中添加第二个参数时，它是它实际工作的输出文件名：

```
imagejpeg($im, "output.jpg"); 
```

我尝试/检查的事情：

*   php 正在工作 (phpinfo())
*   gd 正在工作（正如 phpinfo() 所说，扩展名已在 wamp 托盘->php->extensions->php_gd2 中检查）
*   没有标题行我得到原始图像数据，这证明 gd 正在工作
*   尝试了许多其他示例，结果相同
*   在其他浏览器上试过
*   试图重新启动 wamp 服务器
*   其他 php 脚本当然可以工作
*   试图启用/检查所有可用的错误日志，没有显示任何错误
*   试图在其他页面上的“img”html对象中使用这个“图像”（相同的结果 - “空白/无图像”图标）

现在我没有想法。

请帮忙，问候;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T12:51:21.083

终于自己找到了解决方案。php脚本保存为“UTF8编码”，但必须是“UTF without BOM”（可以用notepad++完成）。

因此，脚本或 wamp 配置都不是问题，而是编码错误。

# jquery - jQuery 'iOS style' 切换按钮需要可拖动功能

> ID：12229689
> 
> 赞同：0
> 
> 时间：2012-09-01T17:02:39.817
> 
> 标签：jquery, draggable, uiswitch

我已经使用 jQuery、CSS 和 HTML 构建了一个 iOS 样式开关。

目前它在点击时触发。我想保留点击功能，但也希望能够拖动它。如果没有插件，这是否可能？如何完成。

没有拖动功能的工作示例。 [http://jsfiddle.net/buduR/5/](http://jsfiddle.net/buduR/5/)

JS。

```
$(document).ready(function(){
    $('.element.switch').each(function(){
        $(this).css('width',($(this).find('li:first').width() + 40) + 'px');
        $(this).find('span').css('left',($(this).find('li:first').width() + 18) + 'px')
        $(this).find('li:last').css('left',($(this).find('li:first').width() + 30) + 'px').css('text-align','right');
        if($(this).find('li:first').attr('data-val') == $(this).find('input').val()){ $(this).find('ol').css('left',0); }
        else { $(this).find('ol').css('left','-' + ($(this).find('li:first').width() + 20) + 'px'); }
    });

    $('.element.switch').click(function(){
        if($(this).find('li:first').attr('data-val') == $(this).find('input').val()){
            $(this).find('ol').animate({left:- ($(this).find('li:first').width() + 20)},500);
            $(this).find('input').val($(this).find('li:last').attr('data-val'));
        }
        else {
            $(this).find('ol').animate({left:0},500);
            $(this).find('input').val($(this).find('li:first').attr('data-val'));
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:23:52.237

是的，有可能，jquery 有自己的可拖动 pugin，但你需要使用 jquery_ui.min

用这段代码

```
$(".drag").draggable({
    axis: "x",
    cursor: "move",
    containment: "parent",
    start: function(event, ui) {
        // do stuff when you start drag
    },
    stop: function(event, ui) {
        // do stuff when you finish drag
    }
}); 
```

您可以使类“拖动”成为可拖动的，因此如果您必须跨越类 =“拖动”，那么您只需要使用 css

这是[JsFiddle](http://jsfiddle.net/buduR/9/)

**编辑**

我已经更新了 JsFiddle，现在它加载了 jquery.ui.touch-punch 并且它确实可以在 IOS 上工作（在 jsfiddle 中它不是因为 jsfiddle 的工作方式，但在它之外）。此外，我还向可拖动对象添加了包含选项，因此它现在保留在 ol.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:21:06.123

jQuery .draggable 可能不适用于 ios ，您可以查看以下内容：

看看这个：[https ://github.com/furf/jquery-ui-touch-punch](https://github.com/furf/jquery-ui-touch-punch)

您也可能对[jQuery Mobile](http://www.jquerymobile.com/)感兴趣。

编辑：

我不知道我是否正确阅读了您的问题，如果您只是想在网络浏览器中模拟 ios 样式的 UI，jquery .draggable 可以正常工作，但如果您希望它在 mobil 触摸屏上运行，请使用我提供的链接

# python - 访问派生类的参数

> ID：12229692
> 
> 赞同：0
> 
> 时间：2012-09-01T17:03:12.820
> 
> 标签：python

[这是我在这里](https://stackoverflow.com/questions/11547818/access-to-init-arguments)提出的一个问题的后续，但我当时并没有真正知道足够清楚......

所以，我有一个基类和一个派生类。基类需要知道用于创建派生类实例的参数（这样它就可以将它们存储到磁盘上，我们以后可以重新创建派生实例）。基类本身不需要带任何参数。

显而易见的方法是要求派生类的开发人员将其参数传递给基类`__init__()`。但是，如果可能的话，我想让它更加自动化；出现不匹配是一个简单的错误，基类的全部意义在于对那些开发派生类的人隐藏机器。

我想出了这个解决方案 - 这种方法有什么问题吗？

```
class Base(object):
  def __new__(typ, *args, **kwargs):
    obj = object.__new__(typ)
    obj._args = args
    obj._kwargs = kwargs
    return obj

class Derived(Base):
  def __init__(self, arg1, arg2):
    pass # obviously will do stuff here

inst = Derived('salt', arg2='pepper')
print inst, inst._args, inst._kwargs 
```

# java - 初始化一个布尔数组元素为真？

> ID：12229693
> 
> 赞同：0
> 
> 时间：2012-09-01T17:03:21.603
> 
> 标签：java, arrays

如何初始化单个元素为真而不是初始化整个数组。

```
 do {
        if (flightClass == 1) {
            Arrays.fill(seats, true);
        } else if (flightClass == 2) {
            Arrays.fill(seats, true);
        }
    } while (i <= 10); 
```

我的方法是这样做....

```
 do {
        if (flightClass == 1) {
            int enterSeat = input.nextInt();
            Arrays.fill(seats[enterSeat], true);
        } else if (flightClass == 2) {
            Arrays.fill(seats, true);
        }
    } while (i <= 10);

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T17:04:38.163

而不是这个：

```
Arrays.fill(seats[enterSeat], true); 
```

只需这样做：

```
seats[enterSeat] = true; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T17:05:38.147

你可以简单地写

```
seats[enterSeat] = true 
```

设置单个数组元素。

评论：然而，把所有东西都放到while循环中很奇怪，不改变循环内部就更奇怪`i`了。你确定你的逻辑是正确的？

# php - 无法使用 PHP 删除 MySQL 记录

> ID：12229700
> 
> 赞同：0
> 
> 时间：2012-09-01T17:03:47.640
> 
> 标签：php, mysql

抱歉标题措辞不好，我不知道还能称呼这种情况。

这是我的困境，为了好玩，我正在制作一个小玩意儿，这样人们就可以提交战地 3 服务器的名称、平台和位置，这样他们就不再需要依赖口耳相传了。

这个旧代码工作正常，它删除记录并完成它的工作。

```
<?php

mysql_connect('localhost', 'root', 'pass');
mysql_select_db('database');

$server_secret = mysql_real_escape_string($_POST['secret_initial']);
$server_confirm = mysql_real_escape_string($_POST['secret_verify']);

if ($server_secret == $server_confirm) {
    echo "Both matched.";
    if ((strlen($server_secret) < 6) and (strlen($server_verify) < 6)) {
        echo "Password too short.";
    } else {
        echo "Password is of proper length.";
        $sql = "DELETE FROM `servers` WHERE secret='" . sha1($server_secret) . "'";
        mysql_query($sql) or die("Couldn't delete record. " . mysql_error());
    }
} else {
    echo "Mismatch.";
}

?> 
```

但是，如果我使用这个：

```
<?php

mysql_connect('localhost', 'root', 'pass');
mysql_select_db('database');

// Create variables from form
$server_secret = mysql_real_escape_string($_POST['secret_initial']);
$server_confirm = mysql_real_escape_string($_POST['secret_verify']);

// Check for verification
if ($server_secret == $server_confirm) {
    // Delete from database
    $sql = "DELETE FROM `servers` WHERE secret='" . sha1($server_secret) . "'";
    if (mysql_query($sql) or die("Couldn't delete record. " . mysql_error()) {
        $success = true;
    } else {
        $success = false;
    }
}

?> 
```

它总是将 $success 报告为真，即使它是假的，而且让我感到困惑的是，即使秘密和验证都正确，该条目也没有从 MySQL 数据库中删除。

旧版本虽然工作正常。这就是让我感到困惑的地方。

我用于检查成功的相同方法`if (mysql_query($sql)`（

如果有人可以在这里帮助我，我将不胜感激。

请注意：我是 PHP/MySQL 的新手，请见谅。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:16:38.483

从[这篇文章](https://stackoverflow.com/questions/922398/what-does-a-successful-mysql-delete-return-how-to-check-if-delete-was-successfu)

> 即使查询实际上没有删除任何内容，mysql_query 也会返回 TRUE。

所以你总是会从删除查询中得到真实的..

归功于保罗

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:07:47.023

这是因为查询在语法上是正确的，所以永远不会出错。相反，您想查找实际受影响的行数：

```
<?php

mysql_connect('localhost', 'root', 'pass');
mysql_select_db('database');

// Create variables from form
$server_secret = mysql_real_escape_string($_POST['secret_initial']);
$server_confirm = mysql_real_escape_string($_POST['secret_verify']);

// Check for verification
if ($server_secret == $server_confirm) {
    // Delete from database
    $sql = "DELETE FROM `servers` WHERE secret='" . sha1($server_secret) . "'";
    $result = mysql_query($sql);
    if (mysql_affected_rows($result)) {
        $success = true;
    } else {
        $success = false;
    }
}

?> 
```

# networking - 如何在多人游戏关卡中处理多个玩家？

> ID：12229702
> 
> 赞同：2
> 
> 时间：2012-09-01T17:04:08.973
> 
> 标签：networking, network-programming

我想编写一个游戏，其中许多玩家处于同一级别。假设它只是 2D，最多有 65,535 名玩家。将以下数据发送给客户端以获取关卡中一名玩家的信息：

```
8 Bytes - Player ID
8 Bytes - Player X Position
8 Bytes - Player Y Position
8 Bytes - Player Rotation 
```

65,535 名玩家的 32 字节意味着关卡中每个玩家的一次更新需要 2,097,120 字节（约 2 MB）。如果这种情况发生在 30fps，则需要 60MB/秒。那么我怎样才能以较低的带宽使用率在一个级别中处理这么多玩家呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:22:06.430

*   对于 65,535 个玩家，您需要 2 个字节的 id 变量。
*   如果最小旋转角度为 0.005 度，则 0-360 度范围需要 2 个字节。

所以，它是 20 字节（现在数据减少了 %37）。

如果玩家没有移动或旋转，那么就不需要发送 X、Y 或旋转数据，对吧？您可以将 1 字节的告密者添加为“无需更新 X”或“无需轮换”或“玩家离线”

您甚至可以对 X、Y 变量使用 32 位整数，并且仅在浮点变量舍入到下一个整数值时才更新（这不是物理游戏，不是吗？）。

设计你的游戏，让每个玩家都有其他玩家位置的缓存，当他们不移动时，只需使用缓存。

您可以使用[空间索引/八叉树](http://en.wikipedia.org/wiki/Octree)对附近的玩家进行分组，以实现附近玩家的更快更新（其他人在不必要时不会更新（您的玩家视线范围是多少？））。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:31:10.353

通常，大多数玩家看不到其他玩家。

仅向他们可以看到（或将接近能够看到）的玩家发送更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:43:58.563

几件事：

1) 一般来说，并不是每个玩家都会同时看到其他玩家。您可以通过仅向一定距离内的玩家发送数据来优化这一点（可能比他们可以看到的更宽一点，以平滑视觉边缘周围的运动。

2) 仅仅因为您的游戏以 30fps 运行并不意味着它需要每秒从服务器接收 30 次更新。您可以发送不太频繁的更新并在其间插入帧。延迟是可变的，所以你需要做一些。

3) You only need to send information that's changed, so if there were up updates, assume no change. Maybe occasionally (every 5 seconds or something) send the full set of visible data whether a change happened or not to account for lost packets, but only do that if you start seeing issues.

# python - 在python中扩展类

> ID：12229703
> 
> 赞同：0
> 
> 时间：2012-09-01T17:04:15.190
> 
> 标签：python, inheritance

比如说，我有一些`MainClass`在其方法中的某个时刻将 a 的对象实例`OtherClass`化为`MainClass`.

```
mainobj = MainClass()
isinstance(mainobj.otherclassobj, OtherClass) == True 
```

现在，我想扩展`OtherClass`，然后使用`MainClass`新的扩展类。

`MainClass`除了扩展和重新定义所有实例化的方法之外，我是否有更方便`self.otherclassobj`的选择`ExtendedOtherClass`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:08:47.210

如果你还不需要`OtherClass`，你可以做类似的事情

```
from other_class_module import ExtendedOtherClass as OtherClass 
```

如果您需要这两个类，或者更改逻辑/方法 - 您需要重新实现/扩展`MainClass`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:11:06.570

如果你可以稍微改变它的实现`MainClass`，你就不需要继承它。只要有类似的东西

```
class MainClass:
    def __init__(self, ..., otherclass=OtherClass):
        self.otherclassobj = otherclass()
        ...
    ... 
```

然后`MainClass`将默认使用`OtherClass`，但您可以`ExtendedOtherClass`作为关键字参数传入。

# java - 可以跳过 jUnit 测试吗？

> ID：12229707
> 
> 赞同：4
> 
> 时间：2012-09-01T17:04:45.433
> 
> 标签：java, junit

使用[Assumptions](http://junit.sourceforge.net/javadoc/org/junit/Assume.html)，我可以为我的测试添加更多意义，但是当假设为假时，测试会出错而不是失败（这当然更好）。**我想知道，有没有办法在发生这种情况时完全跳过测试？**

例如，当我离线时，测试没有任何意义，也没有任何意义。我想认识到我离线并且根本不运行测试的事实。所以，不`fail()`，不`pass()`，假装这个测试甚至不存在。

```
 AppConnector appConn = new AppConnector(url, RequestType.POLL);
    Assume.assumeTrue(appConn.connect());

    try {
        // stuff
    } catch (Exception e) {
        fail();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:03:52.590

使用[扩展的 jUnit](http://code.google.com/p/junit-ext/)，我修改了我的测试以包含前提条件

```
@RunIf(value = HttpChecker.class, arguments = "http:internal_site_url") 
```

这可以根据需要工作。测试只有在公司内部运行时才会运行，否则根本不会运行。

如果测试失败，它将因正当理由而失败。

# android - Android 更新共享点列表项

> ID：12229712
> 
> 赞同：0
> 
> 时间：2012-09-01T17:05:43.880
> 
> 标签：android, sharepoint

寻找有关如何从 Android 应用程序更新 Sharepoint 列表中的项目的任何方向。我见过几次提到 SOAP 和 Web 服务，但没有显示从 android 更新 Sharepoint 列表项的简单示例或所涉及的步骤。任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T13:52:43.717

据我了解，Android开发其实就是Java开发。因此，您可以查看这篇关于[在 Java 中创建列表项的](http://davidsit.wordpress.com/2010/02/15/creating-sharepoint-list-items-with-java-tutorial/)文章。

# macos - 为 Mac OSX 构建 glew

> ID：12229714
> 
> 赞同：19
> 
> 时间：2012-09-01T17:05:48.963
> 
> 标签：macos, opengl, glew

我花了一天的时间努力让我的简单引擎在 Mac 上工作。我有 SDL 工作，现在唯一给我带来麻烦的是 opengl。该引擎使用现代 opengl（基于着色器），因此需要 GLEW。我已经尝试了从 fink 到 MacPorts 的所有方法来安装它，但没有任何效果。

我取得的最大成功是从源代码构建它。首先，我收到一条错误消息，`'GL/glu.h' no such file or directory found.`因此我将包含内容重命名为`OpenGL/glu.h`并解决了该问题。但是现在我得到了这个错误`ld: unknown option: -shared`，我完全被困在这一点上。

如果有人知道如何做到这一点，我也宁愿静态构建。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-08-13T23:21:06.183

您可以使用[Homebrew](http://brew.sh/)为您完成工作：

```
brew install glew 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-01T18:19:21.430

> 该引擎使用现代 opengl（基于着色器），因此需要 GLEW

GLEW 不是使用现代 OpenGL 功能的先决条件。它是**一种**加载扩展功能的方法，而不是唯一**的方法。**你在 MacOS X 上，所以扩展系统对你来说用处不大，因为支持的 OpenGL 版本完全由操作系统和可用框架决定。Apple 自己开发 OpenGL 驱动程序，它们提供的扩展只是那些用于 OpenGL 规范中没有的功能（即供应商特定和 EXT）。您所需要的只是一个足够新的 OpenGL 框架版本。2006 年之后发布的任何 MacOS X 都可以做到。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-03T17:22:21.057

**更新 20180912 - 不要使用 GLEW。只是不值得麻烦...**

* * *

我已经使用源代码安装了 GLEW：

**制作 GLEW_DEST="$HOME/local" OPT="-march=core2 -O2" install.all**

您的优化和目的地可能会有所不同。这会产生一个 libGLEW.a、libGLEWmx.a 和它们在`$HOME/local/lib`. 该`pkgconfig`子目录还将包括`glew.pc`. GLEW 也不总是与其他人相处得很好。必须设置全局变量，例如`glewExperimental`，以及需要注意包含其他标题的顺序：`<OpenGL/gl3.h>`或`<glfw.h>`等。

如果我能提供一些建议 - 忘记现代 GL 编程的 SDL。如果你想在 OS X 上进入*纯粹的、现代的 GL。*- 考虑类似：

```
#if defined (__APPLE_CC__)
#include <OpenGL/gl3.h>
#else
#include <GL/gl3.h>       /* assert OpenGL 3.2 core profile available. */
#endif

#define GLFW_INCLUDE_GL3  /* don't drag in legacy GL headers. */
#define GLFW_NO_GLU       /* don't drag in the old GLU lib - unless you must. */

#include <GL/glfw.h>      /* simple and easy to use. omit legacy GL. */ 
```

安装 GLFW 也很简单：

> **> env PREFIX="$HOME/local" CFLAGS="-march=core2 -O2" 制作 cocoa cocoa-dist-install**

同样，您的设置可能会有所不同。

* * *

20160412：正如其他人所指出的，我对 SDL 的评论已经过时。特别是如果您正在使用另一个引擎。我认为 glfw3 是在 OSX 上制作现代 OpenGL 应用程序的一种更简单的方法。它的代码编写和维护得非常好，（正确地！）专注于 GL 和事件处理。显然，从“引擎”的角度来看，SDL2 提供了可移植的扩展视频 API、音频 API、线程 API 等。尽管使用 C11 和 C++11，即使是线程 API 抽象层也可能是多余的。

GLEW 的问题在于如果没有大量用户干预就无法处理多个上下文。这对 OSX 来说不是问题，它提供了核心配置文件 API，并且不需要加载“功能点”。IIRC，X 上的 GL（DRI？）也有这个 - 但我可能错了。那里还有其他装载机。我仍在等待一个人来统治它们，这确保在必要时为多个上下文加载不同的函数指针，并使用线程本地（甚至是 pthread 键）进行正确调度，这可以从最新的 gl 生成.xml 来自 Khronos 或任何人......

* * *

**20180912**

我认为现在最简单的方法是使用 GLFW 提供上下文，并使用[GLAD](https://glad.dav1d.de/)来解析 GL 函数指针。唯一的缺点是没有有效管理多个 GL 上下文。这就是 GLFW 目前在其演示中使用的……我现在完全忘记了 GLEW。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-13T22:49:10.827

MacPorts 应该为您安装这些库及其依赖项：

```
sudo port install glew +universal
sudo port install libsdl +universal 
```

构建游戏时，最好在构建和链接步骤中调用 g++；您只需要参考**/opt/local**即可找到 MacPorts 已安装的头文件和库。如果您愿意，还可以静态链接 .a 文件：

```
g++ -c -O3 -I/opt/local/include main.cpp -o main.o
g++ main.o /opt/local/lib/libSDL.a /opt/local/lib/libSDLmain.a /opt/local/lib/libGLEW.a -o mygame 
```

如果您从命令行构建，我建议[使用 Makefile 并使用 make 构建](http://mrbook.org/tutorials/make/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-29T04:27:17.207

我建议您访问[http://glew.sourceforge.net](http://glew.sourceforge.net)并将 ZIP 文件直接下载到您的 Mac 上。然后进入Finder并输入glew.h来查看文件，控制点击它，获取信息，然后复制文件的路径。然后进入包含`#include <GL/glew.h>`依赖项的相应程序文件（例如，commons.h），并将其更改为：

```
#include <path/to/file/that/you/just/copied/glew.h> 
```

然后，尝试再次编译您的程序，这一次您应该不会收到任何 GLEW 错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-15T20:23:10.383

上面的答案都没有给我我正在寻找的东西：一种快速设置和具有静态 Glew 依赖项的 Xcode 项目的方法。

1.  从这里下载 GLEW 源代码[http://glew.sourceforge.net/](http://glew.sourceforge.net/)
2.  类型

    ```
    $sudo make install 
    ```

    从解压缩的目录中（如果您想动态链接，这将安装 .dylib）。您需要安装 CMake。

3.  将 .a 静态库从 /usr/local/lib/ 复制到您的 XCode 项目
4.  在您的目标的 Xcode 构建设置中更新“标题搜索路径”以包含标题（通常放在 /usr/local/include 中）。或者只是将标题复制到您自己的项目中。

# javascript - 更改 el 属性时未触发主干视图事件

> ID：12229719
> 
> 赞同：2
> 
> 时间：2012-09-01T17:07:08.537
> 
> 标签：javascript, backbone.js

我是 Backbone 的新手，并试图做一些例子，但我坚持这个。我有以下主干视图：

```
CommentBoxView = Backbone.View.extend({
    initialize: function () {
        this.render();
    },
    render: function () {
        var template = _.template( $("#comment_box_template").html(), {} );
        this.el.html(template);
    },
    events: {
        "keypress textarea": "doKeyPress"
    },
    doKeyPress: function (event) {
        console.log(event);
    }
}); 
```

一切正常，但如果我更换

> this.el.html(模板);

有了这个：

> this.el = $(模板).replaceAll(this.el);

keypress 事件根本不会被触发。谁能向我解释它为什么会发生以及如何使这段代码起作用？非常感谢大家。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T18:22:56.340

Backbone 使用视图的[`delegateEvents`](http://backbonejs.org/#View-delegateEvents)方法将 jQuery[`delegate`](http://api.jquery.com/delegate/)调用绑定到视图的[`el`](http://backbonejs.org/#View-el)，这`delegate`是处理所有视图事件的方法。如果你这样做：

```
this.el = $(template).replaceAll(this.el); 
```

你失去了`delegate`约束`this.el`，你的事件随之而来。你也会以[`this.$el`](http://backbonejs.org/#View-$el)不匹配`this.el`而告终，这也不好。更改视图的正确方法`el`是使用[`setElement`](http://backbonejs.org/#View-setElement)：

> **设置元素** `view.setElement(element)`
> 
> 如果您想将 Backbone 视图应用到不同的 DOM 元素，请使用**setElement**，它还将创建缓存`$el`引用并将视图的委托事件从旧元素移动到新元素。

所以你应该能够这样做：

```
this.setElement($(template).replaceAll(this.el)); 
```

# php - 使用jquery调整动态url

> ID：12229722
> 
> 赞同：1
> 
> 时间：2012-09-01T17:07:21.890
> 
> 标签：php, jquery, magento

我正在使用以下代码根据下拉选择生成一个 img url。

```
$(document).ready(function() {
    $('select').change(function(){
       var src = $(':selected', this).text()
       $('img').attr('src', location.hostname + "/" + src + '.jpg');
    });
});` 
```

它适用于显示将选择文本添加到静态 URL 即：

```
www.mysite.com/selecttext.jpg 
```

但需要为这样的事情工作：

```
www.mysite.com/<?php text value ?>/selecttext.jpg 
```

PHP 已经运行，只需要知道如何调整 jquery 即可工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:14:14.840

PHP/HTML：

```
<script type="text/javascript"> var dir = '<?php echo "foo"; ?>'; </script> 
```

JS：

```
$(document).ready(function() {
    $('select').change(function(){
       var src = $(':selected', this).text()
       $('img').attr('src', location.hostname + "/" + dir + '/' + src + '.jpg');
    });
});` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:39:47.887

请记住，您可以“清除”类别页面的其他部分以添加到 URL。猜测您正在寻找要进入的产品 SKU - 或者至少是内部 Magento ID。您可以将此信息放在您的类别页面中 - 即使隐藏（可能作为产品名称上的标题标签） - 在其上放置一个 id 并将值提取到您的代码中。

“以 php 方式执行”是 Varien 的方式，即使它定义了一个全局变量（据称不好），彼得的方式看起来也不错 - 只需使用 $_item->getSku( )

# performance - 消除这个 Common Lisp 函数中的“神秘问题”？

> ID：12229723
> 
> 赞同：7
> 
> 时间：2012-09-01T17:07:23.073
> 
> 标签：performance, common-lisp, case

这个 Common Lisp 函数通过极其简单的幼儿园级算法和一些“案例”测试简单地计算墙壁线框边缘的四个顶点，似乎负责为每个渲染帧动态分配 196608 字节；SBCL 的分析器告诉我，就 consing 而言，这是我最有问题的功能。为了大致了解我正在做的事情，这是一个小型的第一人称地牢爬行游戏，地牢是 32x32 的单元格，每个单元格有 4 面墙。32 * 32 * 4 * x = 196608，所以 x 结果是 48，而恰好是 4 * 12（4 个墙 * 12 个浮子/墙？也许不是）。

现在，我可以通过在游戏模式中使用 OpenGL 显示列表轻松缓解这个性能问题，我想这就是我将继续做的事情。尽管如此，1）我通常不会过早地优化，更重要的是 2）我仍然不喜欢让某些像这样的烦人的痒没有被划伤，我想知道我还能做些什么。我的功能原样如下：

```
(defun calculate-wall-points (x y wall)
  (declare (integer x y)
           (keyword wall))
  "Return the 4 vertices (12 floats) of a given dungeon cell wall"
  (let ((xf (coerce x 'float))
        (yf (coerce y 'float)))
    (case wall
      (:SOUTH
       (values xf yf 0.0
               (1+ xf) yf 0.0
               (1+ xf) yf 1.0
               xf yf 1.0))
      (:WEST
       (values xf yf 0.0
               xf yf 1.0
               xf (1+ yf) 1.0
               xf (1+ yf) 0.0))
      (:NORTH
       (values xf (1+ yf) 0.0
               xf (1+ yf) 1.0
               (1+ xf) (1+ yf) 1.0
               (1+ xf) (1+ yf) 0.0))
      (:EAST
       (values (1+ xf) (1+ yf) 0.0
               (1+ xf) (1+ yf) 1.0
               (1+ xf) yf 1.0
               (1+ xf) yf 0.0))

      (otherwise
       (error "Not a valid heading passed for wall in function calculate-wall-points: ~A" wall))))) 
```

总结几件事我试图解决这个问题：

1.  在 3 处为“速度”和其他所有内容在 0 处执行“声明”以“优化”（在此函数中以及调用它的唯一函数中）。奇怪的是，分析器确实报告了这个功能稍微少了一点……但它仍然是 consed。我的目标是零骗局。算术不应该是缺点。

2.  然后我认为“价值观”可能会这样做。也许，我想，它在内部就像函数“list”，毫无疑问，conses（“list”函数在宇宙中的唯一用途）。我做了什么来试图减轻这种情况？只是为了实验，我修改了文件以制作单个*墙顶点缓冲区*全局数组，大小适合 12 个浮点类型的元素，并修改了这个函数来修改它，以及调用函数在调用这个函数后从它读取（所以它会不断更新一组 12 个浮点数，保持不变）放在内存中，而不是分配任何东西）。奇怪的是，这并没有阻止这个功能成为一个小猪！那么……是“案件”在做阴谋吗？我确实觉得有趣的是，前面提到过，那个神秘数字是 48\. 48 = 4 * 12，也许这 4 个案例测试乘以每个“值”调用的 12 个浮点数。或者，这可能是巧合，48 个字节意味着别的东西（因为浮点数不是 1 个字节，我怀疑是 -is- 别的东西）。这似乎很重要，但我无法完全理解我的下一个方法应该是什么。

3.  尝试用“cond”等价物替换“case”，此时只是抓住稻草，也没有做任何事情。

那么这个函数的“神秘阴谋”是从哪里来的呢？更有经验的 Lisp 程序员如何处理这个棘手的问题？

* * *

（编辑）对于@FaheemMitha，是使用计算墙点函数的函数；这个麻烦的函数后来被 (declaim (inline calculate-wall-points)) 在 calculate-wall-points 的定义之前内联：

```
(defun render-dungeon-room (dungeon-object x y)
  (declare (optimize (speed 3) (space 0) (debug 0)))
  (declare (type fixnum x y))
  (let ((cell (cell-at dungeon-object x y)))
    (unless (null cell)
      (dolist (wall-heading +basic-headings+)
    (unless (eq wall-heading (opposite-heading *active-player-heading*))
      (when (eql (get-wall-type cell wall-heading) :NORMAL)
        (multiple-value-bind (v1x v1y v1z v2x v2y v2z v3x v3y v3z v4x v4y v4z)
        (calculate-wall-points x y wall-heading)
          (declare (type float v1x v1y v1z v2x v2y v2z v3x v3y v3z v4x v4y v4z))

      (gl:with-primitive :quads
    (if (is-edit-mode)
        (case wall-heading
          (:NORTH
           (gl:color 0.4 0.4 0.4))
          (:WEST
           (gl:color 0.4 0.0 0.0))
          (:SOUTH
           (gl:color 0.0 0.0 0.4))
          (:EAST
           (gl:color 0.0 0.4 0.0)))
        (gl:color 0.1 0.1 0.1))
    (gl:vertex (the float v1x)
           (the float v1y)
           (the float v1z))
    (gl:vertex (the float v2x)
           (the float v2y)
           (the float v2z))
    (gl:vertex (the float v3x)
           (the float v3y)
           (the float v3z))
    (gl:vertex (the float v4x)
           (the float v4y)
           (the float v4z)))

      (gl:color 1.0 1.0 1.0)
      (gl:with-primitive :line-loop
    (gl:vertex (the float v1x)
           (the float v1y)
           (the float v1z))
    (gl:vertex (the float v2x)
           (the float v2y)
           (the float v2z))
    (gl:vertex (the float v3x)
           (the float v3y)
           (the float v3z))
    (gl:vertex (the float v4x)
           (the float v4y)
           (the float v4z))))))))) 
```

零）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T18:01:42.870

consed内存是由分配浮点数引起的*。*每个函数调用都返回浮点数，实际上是 32 位`single-floats`。*Consing*表示在堆上分配了一些数据：cons 单元格、数字、数组、...

A`single-float`是 32 位内存对象。4字节。

```
(+ 1.0 2.0)  ->  3.0 
```

在上述情况下`3.0`是一个新的浮点数，可能是新的*consed*。

```
(+ (+ 1.0 2.0) 4.0)  -> 7.0) 
```

现在上面的计算是什么？内部`+`操作返回一个 float `3.0`。它会发生什么？

*   它可以在处理器寄存器中返回并在那里用于下一个操作。
*   它可能会返回到堆栈中并在那里用于下一个操作
*   在更复杂的操作中，它可以在堆中分配并作为指向堆值的指针返回。如果没有足够的寄存器用于所有返回值，或者堆栈帧的大小对于所有返回值都不够大，则可能会出现这种情况。

现在这些花车以后会发生什么？它们是否以某种方式存储？在列表中？在一个新的阵列中？在一个新的`structure`？在一个新的 CLOS 对象中？

上面清楚地表明它取决于处理器架构和编译器策略。x86 没有很多寄存器。64位版本有更多。RISC 处理器*可能*有更多的寄存器。那么堆栈有多大，典型的堆栈帧有多大？

对于涉及多个函数的更复杂的计算，优化编译器可能能够优化哪些值保留在寄存器中，从而减少浪费。

上面还清楚地表明，对于 Common Lisp，没有完全通用的方法来使浮点操作成为非 consing。减少 consing 的能力取决于一些一般的想法和许多编译器/架构特定的*技巧*。

由于您使用的是 SBCL，因此最好在 SBCL 邮件列表上寻求建议，并告诉他们操作系统、架构（intel、arm、...）以及它是在 32 位还是 64 位模式下运行。还需要更多的上下文代码来更好地了解如何减少 consing。

一些阅读背景信息：

*   [Common Lisp 中的快速浮点处理](http://www.cs.berkeley.edu/~fateman/papers/lispfloat.ps)
*   Ken Anderson（不幸在几年前去世，一个非常有帮助的 Lisper）收集了一些关于[Lisp 和 Performance](https://web.archive.org/web/20140221233242/http://openmap.bbn.com/~kanderso/performance)[文件](https://web.archive.org/web/*/http://openmap.bbn.com/~kanderso/performance/postscript/*)（存档版本）的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:04:04.570

编译器说什么？如果您针对速度进行优化，它应该大声抱怨无法打开代码算术。

接下来，胁迫发生了什么？这也是开放编码的吗？

最后，请记住，您通常可以检查函数使用 disassemble() 生成的汇编代码

# javascript - 从json数组中查找满足条件的特定元素的值

> ID：12229724
> 
> 赞同：1
> 
> 时间：2012-09-01T17:07:33.097
> 
> 标签：javascript, jquery, json, arrays

我关注的朋友喜欢 json 数组

```
[
   {
      "Rate":100.0,
      "MaterialID":"BOLT",
      "BrandName":"",
      "Description":"",
      "Unit":"KG",
      "TokenNumber":2
   },
   {
      "Rate":null,
      "MaterialID":"PLYWOOD",
      "BrandName":"",
      "Description":"",
      "Unit":"FT",
      "TokenNumber":2
   },
   {
      "Rate":null,
      "MaterialID":"SCREW 1.5 INCH",
      "BrandName":"",
      "Description":"",
      "Unit":"KG",
      "TokenNumber":2
   }
] 
```

我想知道找到具有`materialID`value的元素的最短方法`PLYWOOD`。
我可以使用`for`循环来做到这一点。但我想知道一些捷径，比如

`var unit = jsonArray[<whiere materialID == 'PLYWOOD']['Unit'];`

**`jQuery`如果需要，您可以使用。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T17:15:17.310

你可以使用 $.grep

[http://api.jquery.com/jQuery.grep/](http://api.jquery.com/jQuery.grep/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T18:06:55.643

jQuery 不是必需的，所以你可以这样做：

```
function findItem(arr, key, value) {
    for (var i = 0; i < ARR.length; i++) {
       if (arr[i][key] === value) {
           return(i);
       }
    }
    return(-1);
}

var plywoodIndex = findItem(data, "MaterialID", "PLYWOOD");
if (plywoodIndex !== -1) {
    // do something with the plywoodIndex object here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:54:46.243

正如 Raghaw 所建议的那样。我找到了做我的工作的方法。我设计了以下函数，可以返回具有指定 materialID 的对象。

**假设：`materials`是数组**

```
function getMaterialFromArray(materialID) {
    return $.grep(materials, function (n, i) {
        return(n.MaterialID == materialID);
    })[0];
} 
```

# sql-server - Visual Studio 2012 数据库设计器 - 功能是否已更改？

> ID：12229731
> 
> 赞同：10
> 
> 时间：2012-09-01T17:08:24.340
> 
> 标签：sql-server, visual-studio-2012, sql-server-2012

我最近安装了 Visual Studio 和 SQL Server 2012。我想知道我是否遗漏了什么，因为数据库设计器似乎没有旧版本那么友好。

在 Visual Studio 2010 中，当我在 App_Data 目录中创建 SQL 用户实例 (.mdf) 时，我能够使用与 SQL Server Management Studio 非常相似的漂亮界面来创建表。我会点击保存，一切都更新了。

在新版本中：

1) 似乎是创建 .sql 脚本而不是自动保存我的更改

2）我必须在 TSQL 窗口而不是属性区域中更新某些内容（某些内容，如表名在属性中显示为灰色）

3) 创建诸如外键和索引之类的东西已经远没有以前那么简单了。

我的安装是否遗漏了什么？或者这是做事的“新方式”？如果是这样，以我的拙见，为什么它变得更加复杂？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-02T06:32:25.867

SQL 用户实例设计器已替换为 SQL Server Data Tools (SSDT) 设计器。

这样做的原因是，微软鼓励开发人员转向使用单独的 Visual Studio 项目作为数据库，而不是将其作为资产存储在应用程序项目中。

该项目系统通过在项目构建期间将一组**离线**数据库对象声明（用 T-SQL 编写）与物理数据库同步来工作。

替代设计师似乎有点奇怪，因为他们从离线数据库项目中使用的设计师那里继承了大部分行为。

您可以在此处阅读有关 SSDT 的更多信息：http: [//msdn.microsoft.com/en-us/library/hh272686 (v=vs.103).aspx](http://msdn.microsoft.com/en-us/library/hh272686(v=vs.103).aspx)

当然，您没有理由不能使用这些**在线**设计器来编辑您的数据库：当您对对象进行更改时，不要单击*保存，而是单击**更新*。这会将更改直接应用到您的 .mdf 资产。

或者也许做我所做的，只是使用 SSMS 来编辑你的数据库:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T17:00:08.843

我们不能再在 Visual Studio 2012 中进行可视化查询。对于喜欢打字的人，他们可以输入查询。这使得加入多个表变得很有趣。对于那些不喜欢键入 SQL Server Management Studio 的人来说，仍然有一个可视化查询编辑器。另一种选择是使用旧版本的 Visual Studio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-26T16:47:17.723

**断开您的数据库**并**重新连接，这次使用**：.NET Framework Data Provider for OLE DB 来获得 VS 2012 中的可视化查询设计器！

第一步：

[![在此处输入图像描述](../Images/ce7ae834155457a3ee53cc665ab04387.png)](https://i.stack.imgur.com/EMOjc.png)

第二步：

[![在此处输入图像描述](../Images/43e05046084864a16f64d2d33229fae0.png)](https://i.stack.imgur.com/Pv3im.png)

# bash - 使用 BASH shell 以特定格式列出目录中文件的 Bash 脚本

> ID：12229735
> 
> 赞同：0
> 
> 时间：2012-09-01T17:08:49.157
> 
> 标签：bash, ls

我目前正在 GNU/Linux 系统上编写一些 C++ 代码，我的源代码文件夹中充满了 .cpp 文件和 .h 文件。

一般来说，对于这段代码，每个`.cpp`文件都有一个对应的`.h`头文件，但不一定反之亦然。在下面的输出中`--`表明列出的头文件没有对应的 .cpp 文件

我想通过在我的 .bashrc / .zshrc 中定义一个额外的标志来编写一个 bash 脚本来执行此操作，以便文件列表以这种格式出现。假设我有 7 个文件，一些`.cpp`和一些`.h`

```
$ listscript
hello1.cpp hello1.h
hello2.cpp hello2.h
   --      hello3.h 
hello4.cpp hello4.h 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:07:08.420

```
#!/usr/bin/env bash
declare files=(*)
declare file= left= right= width=10
declare -A listed=()
for file in "${files[@]}"; do
    if [[ $file == *.h ]]; then
        continue
    elif (( ${#file} > width )); then
        width=${#file}
    fi
done
for file in "${files[@]}"; do
    if [[ ${listed[$file]} == 1 ]]; then
        continue
    elif [[ $file == *.cpp ]]; then
        left=$file right=${file%.cpp}.h
    elif [[ $file == *.h ]]; then
        left=${file%.h}.cpp right=$file
    else
        left=$file right=
    fi

    [[ $left ]]     && listed["$left"]=1
    [[ $right ]]    && listed["$right"]=1

    [[ -e $left ]]  || left='--'
    [[ -e $right ]] || right='--'

    printf "%-*s %s\n" "$width" "$left" "$right"
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:09:47.900

由于每个`.h`文件可能有也可能没有相应的`.cpp`文件，因此只需遍历所有`.h`文件。对于每一个，您可以检查相应的`.cpp`文件是否存在，如果不存在则使用“---”。

```
for fh in *.h; do
    fcpp=${fh/%.h/.cpp}
    [ -f "$fcpp" ] || fcpp="---"
    printf "%s\t%s\n" "$fcpp" "$fh"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:35:47.357

怎么样（在`bash`）：

```
for f in $(ls -1 *.{cpp,h} | sed -e 's/.cpp//;s/.h//' | sort -u)
do 
    [ -f "${f}.cpp" ] && printf "%s " "${f}.cpp" || printf " -- "
    [ -f "${f}.h" ] &&  printf "%s" "${f}.h" || printf " -- "; 
    printf "\n"
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T17:49:32.950

这是我在 bash 中的尝试：

```
#!/bin/bash

# run like this:
# ./file_lister DIRECTORY

for i in $1/*.h
do
        name=`basename $i .h`
        if [ -e $name.cpp ]
        then
          ls $name.*
        else
          echo "-- " `basename $i`
        fi
done 
```

# scripting - 将脚本触发器绑定到 Filemaker (pro 12) 中的选项卡

> ID：12229740
> 
> 赞同：0
> 
> 时间：2012-09-01T17:09:22.797
> 
> 标签：scripting, triggers, tabs, filemaker

FileMaker Pro 12 遇到了这个奇怪的问题。我是第一次使用它，所以我很确定我做错了什么，但我不知道是什么。

我创建了一个包含三个选项卡的布局，当我单击一个选项卡时，我试图加载不同的布局。Google 的 vox populi 表示，正确的做法是为每个选项卡设置一个脚本触发器，从而脚本将“转到”我想要的布局。简单的。

问题从这里开始：当我将脚本触发器设置到其中一个选项卡时，由于某种原因，它被设置为所有选项卡。如果我改变一个，它会改变一切。

奇怪的是，当我最初创建选项卡时，我能够为每个选项卡设置不同的触发器，但突然之间这不再可能了。

希望能得到一些帮助，我确信我做了一些事情来触发这种行为，但在谷歌上找不到确切的内容。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T16:02:16.237

为所有选项卡设置一个脚本触发器，当该脚本触发时，检查当前选定的选项卡并执行适当的操作/下标。

# artificial-intelligence - 纸牌游戏的 AI 设计

> ID：12229741
> 
> 赞同：-1
> 
> 时间：2012-09-01T17:09:24.763
> 
> 标签：artificial-intelligence

我目前正在为纸牌游戏开发 AI [Wizard](http://en.wikipedia.org/wiki/Wizard_%28card_game%29)开发 AI 。巫师是一个花样游戏，每个玩家在实际游戏开始之前说明他认为自己会花多少花样。

在阅读了一些论文和本书的某些部分之后[在阅读了《人工智能：一种现代方法](https://rads.stackoverflow.com/amzn/click/com/0137903952)，我决定首先设计我的算法，用于开放纸牌游戏，以便每个玩家都有完整的信息。所以我刚刚开始并使用 UCB 选择策略实现了蒙特卡洛树搜索算法。我已经在 java 中实现了所有东西，它似乎运行得很好，但是我的机器人还没有发挥最佳效果。尤其是预测你得到的技巧似乎是一项艰巨的任务，为此我使用了与演奏相同的 MCTS。

所以基本上我的算法扩展了游戏的当前状态（例如 2 个玩家出价）创建一个新节点（例如 3 个玩家出价），然后随机播放直到游戏结束。然后通过节点评估和备份分数。

我认为改进算法的下一步是在树搜索中添加一些启发式方法，以便从一开始就忽略最有可能导致损失的分支。

我的问题是：你认为这是一个好方法吗？还有哪些其他方法很有希望，或者您还有其他提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:58:14.327

我不知道这个游戏，但我可以给你一般的建议。蒙特卡洛方法是一个很好的解决方案，如果

*   搜索空间非常巨大（即围棋棋盘游戏）
*   你不知道如何建立一个强大的启发式

在这些条件下，MCTS 是您能做的最好的。

但是**，如果您能够构建一个强大的启发式函数**，那么您必须直接使用“Min-Max/Alpha-Beta Pruning”算法（或类似算法）。一般来说，通过这些算法，您可以获得更强大的 AI。

这就是原因，因为在 GO 中我们使用 MCTS，但在 Chess 中我们仍然使用 Min-Max。

但算法只是人工智能的 10%。游戏 AI 编程中最困难（也是最漂亮）的部分是利用游戏机制来修剪搜索空间并构建最强的启发式 :)

例如，您可以从一个著名的纸牌游戏开始了解 AI：扑克 (http://webdocs.cs.ualberta.ca/~games/poker/)。然后，您可以将这些技术扩展到您的游戏。

# java - 使用 PrimeFaces 3.3.1 (JSF 2.0) 通过 p:ajax 发送额外参数

> ID：12229743
> 
> 赞同：1
> 
> 时间：2012-09-01T17:09:44.763
> 
> 标签：java, jsf-2, primefaces

有没有办法用 p:ajax 发送额外的参数？

我懂了：

```
<p:selectOneMenu id="crit">
    <f:selectItem itemLabel="Select one..." itemValue="0" />
    <f:selectItems itemLabel="#{cat.desc}" itemValue="#{cat.id}" value="#{CatBean.cats}" var="cat" />
    <p:ajax event="change" listener="#{ConsBean.proccesCatSelection}" process="crit" update=":list,:crits" />
</p:selectOneMenu> 
```

我需要发送一个带有事件“更改”的 ID，但它似乎只发送一个 AjaxBehaviorEvent。

非常感谢您的关注。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T17:14:16.510

将 ID 放入 an`InputHidden`然后使用：

```
<p:ajax event="change" listener="#{ConsBean.proccesCatSelection}" 
process="crit inputHiddenId" update=":list,:crits" /> 
```

然后`p:ajax`将 InputHidden 内容也发送到服务器。

# jquery - 如何在 Jplayer 中设置默认值

> ID：12229744
> 
> 赞同：0
> 
> 时间：2012-09-01T17:09:50.987
> 
> 标签：jquery, html, jplayer

我不知道如何从 JPlayer 所在的页面设置`nativeSupport`为`false`。

我试图改变的代码是这样的：

```
 $.jPlayer.defaults = {
    cssPrefix: "jqjp",
    swfPath: "js",
    volume: 80,
    oggSupport: false,
    nativeSupport: true,  //I want to change this one to false
    preload: 'none',
    customCssIds: false,
    graphicsFix: true,
    errorAlerts: false,
    warningAlerts: false,
    position: "absolute",
    width: "0",
    height: "0",
    top: "0",
    left: "0",
    quality: "high",
    bgcolor: "#ffffff"
}; 
```

我试过这个没有运气：

```
 $("#jquery_jplayer").jPlayer("option", "nativeSupport", "false"); 
```

任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:31:56.753

好吧，因为没有人发帖。

而不是为 Jplayer 使用一些 javascript 函数。相反，我只是使用 php 来回显两个不同的 javascript 文件。一个有`nativeSupport = false`，另一个`true`。

我知道这不是首选方法，但它有效。这是我使用的代码：

```
 <?php
        if($somthing == $somthingelse) {
           echo'<script type="text/javascript" src="jPlayer/js/jquery.jplayer.nativefalse.js"></script>';
        } else{
           echo'<script type="text/javascript" src="jPlayer/js/jquery.jplayer.js"></script>';
        }
    ?> 
```

# windows - Windows 8 SDK & Directx

> ID：12229746
> 
> 赞同：1
> 
> 时间：2012-09-01T17:10:29.707
> 
> 标签：windows, sdk, directx

我最近才安装了新的 Windows 8 和 Visual Studio 2012 终极版，我正在尝试按照 msdn 说明制作简单的直接 x 应用程序....当我在没有自己的代码的情况下启动项目时，它应该显示空白屏幕而不是它不会编译并返回错误：

错误 1 ​​错误：DEP0800：所需的框架“C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0\ExtensionSDKs\Microsoft.VCLibs\11.0.\AppX\Retail\ARM\Microsoft.VCLibs.ARM.11 .appx”安装失败。Windows 无法安装软件包 Microsoft.VCLibs.110，因为该软件包需要架构 ARM，但此计算机具有架构 x64。Direct3DApp2

我认为这是因为我没有 arm 处理器，但对我来说，visual studio 和 directx 仅限于 arm 处理器并不符合逻辑

当然，如果有人有任何有用的链接到在 windows 8 sdk 中开发的教程

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T21:48:48.707

汉斯·帕桑特是对的。转到项目设置配置属性/MIDL/目标环境并选择您的环境。

此外，解决方案的开放属性转到配置管理器并更改构建平台。

但是一个愚蠢的问题。我应该在哪种环境中发布我的应用程序？

# android - ListView 选择自定义颜色

> ID：12229747
> 
> 赞同：2
> 
> 时间：2012-09-01T17:10:39.213
> 
> 标签：android, android-layout, android-listview, android-ui, android-listfragment

我已经制作了自己的自定义主题，但是有一些主题没有着色，例如我正在处理的 ListView，所以我正在逐个做这些。我已经完成了我的作业，并且知道创建可绘制背景选择器 XML 文件，但它不能正常工作。此外，我尝试了其他一些方法来强制它，但无法让它工作。我将向您展示问题，然后使用我的代码进行操作。

“按下”颜色正在起作用。在此屏幕截图中，我按住了一个项目：

![按下 ListView 项目](../Images/bb57d93a2e3a9b6cc37556a1db10da0d.png)

但是，当我移开手指时，所选项目不会保持颜色。请注意，清单 1 已被选中并显示，但没有突出显示：

![手指被移除，ListView 项目被选中但没有颜色](../Images/e10ee47ff50b6e22702e3dc2f04ce19d.png)

这是我应用于每个列表项视图的背景可绘制对象：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_selected="false" android:state_pressed="false"
    android:drawable="@android:color/transparent" />
<item android:state_pressed="true" android:drawable="@android:color/holo_orange_dark" />
<item android:state_selected="true" android:state_pressed="false"
    android:drawable="@android:color/holo_orange_light" />
</selector> 
```

您会注意到“已选择”应该显示“holo_orange_light”，但不会。下面的代码是我分配背景的地方。我最初是在实例化一个现成的 ArrayAdapter。为了应用这个背景，我从 ArrayAdapter 继承并将代码添加到构建视图的方法中。

这是自定义的 ArrayAdapter：

```
private class CustomArrayAdapter extends ArrayAdapter<Checklist> {

    public CustomArrayAdapter(Context context, int resource, int textViewResourceId,
            List<Checklist> objects) {
        super(context, resource, textViewResourceId, objects);

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        convertView = super.getView(position, convertView, parent);
        convertView.setBackgroundResource(R.drawable.listview_background);
        return convertView;
    }

} 
```

FWIW 这是创建适配器的调用，因此您可以看到我使用的参数：

```
setListAdapter(new CustomArrayAdapter(getActivity(),
                android.R.layout.simple_list_item_activated_1, android.R.id.text1,
                KnowUrStuffApp.getDbHelper().getChecklists())); 
```

所以那个代码离开了我现在的位置。然而，我试图以几种冗余的方式强制它着色。我创建了一个名为 setSelectionHilight 的例程，它将视图背景显式着色为全橙色。然后，我创建了一个分配给名为 setSelectionHilight 的 ListView 的 onItemSelectedListener。然后，一旦所有内容加载完毕，我就会明确地调用该例程。这些都没有任何效果：

```
private void setSelectionHilight(ListView listView, View selectedView) {
    for (int i = 0; i < listView.getChildCount(); i++) {
        View child = listView.getChildAt(i);
        if (child == selectedView)
            child.setBackgroundColor(getActivity().getResources().getColor(android.R.color.holo_orange_light));
        //else
            //child.setBackgroundResource(0);
    }
}

private OnItemSelectedListener onItemSelectedListener = new OnItemSelectedListener() {

    @Override
    public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
        setSelectionHilight((ListView) parent, view);

    }

    @Override
    public void onNothingSelected(AdapterView<?> parent) {
        setSelectionHilight((ListView) parent, null);

    }

}; 
```

再说一次，我只是在直接用上面的块做实验。在考虑解决我的问题时，您可以放心地忽略这一点，但我将其包括在内以获取完整的图片。感谢您对解决此问题的任何帮助。另一点辅助信息是 ListView 封装在 ListFragment 中，我使用的是随附的默认布局。我没有 ListView 的显式 XML 元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:26:45.147

我想做类似的事情并开发了自己的逻辑来实现它。我的代码用于突出显示当前选定的 ChildView，如果您看到代码，您可以为 ParentView 和 ChildViews 实现它。

```
 public int _groupPosition = -1;
    View _lastColored;
    private int _highlightedGroup = -1;
    private int _highlightedChild;

    public boolean onChildClick(ExpandableListView parent, View v,
            int groupPosition, int childPosition, long id) {

        _groupPosition = groupPosition;
        _highlightedGroup = groupPosition;
        _highlightedChild = childPosition;
        if (_lastColored != null) {
            _lastColored.setBackgroundColor(Color.TRANSPARENT);
        }
        _lastColored = v;
        v.setBackgroundColor(Color.rgb(214, 214, 214)); // whatever colour you want to set
             ..... // your code here
} 
```

无需在 XML 文件中使用任何选择器。这段代码完成了所有工作。祝你好运！

# triggers - Knockout.JS：基于 observable 变化的触发器

> ID：12229751
> 
> 赞同：26
> 
> 时间：2012-09-01T17:11:20.370
> 
> 标签：triggers, knockout.js, observable

我有一个输入元素，它绑定到可观察到的淘汰赛：

```
<input type="text" data-bind="value: myText, valueUpdate: 'keyup'" /> 
```

这会更新每个 keyup 上的 observable。我现在想在值更改时触发其他事件。

原则上执行以下操作：

```
this.myTextTrigger = ko.computed( function () {
    console.log( this.myText() );
}, this ); 
```

但是，它似乎有些笨拙。它还会在模板的初始实例化时触发，我只想在此之后处理更改。是否有官方/更简单的方法来根据可观察的变化触发事件？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-01T17:36:16.957

使用订阅：

```
this.myText.subscribe(function (newText) {
   console.log(newText);
}); 
```

如果您想重用此触发器，您可以考虑编写[自定义绑定](http://knockoutjs.com/documentation/custom-bindings.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-03T14:59:13.823

如果您试图在绑定中获取额外信息，请使用并设置参数以引用指向函数的元素中的绑定名称。要么将函数文字放在 HTML 中，要么确保您可以在处理程序定义的范围内找到该函数（如全局附加到对象）。`allBindings.get(`*`nameOfOtherBinding`*`)`**`nameOfOtherBinding`**`window`

[http://knockoutjs.com/documentation/custom-bindings.html](http://knockoutjs.com/documentation/custom-bindings.html)

[JS 小提琴示例 - http://jsfiddle.net/pqb4xubg/](http://jsfiddle.net/pqb4xubg/)

将设置处理程序的 javascript（在*init*或*update*中）：

```
ko.bindingHandlers.generic = {
    init: function(element, valueAccessor, allBindings){
        var val = 'nothing';
        // set your other bindings to get pulled in
        var func = allBindings.get('func');
        // normal check if the binding is actually a function
        if(typeof func === 'function'){
            // use the retrieved function
            val = func(valueAccessor());
        }
        element.innerText = val;
    }
};
var model = {a:'4', b:5};
ko.applyBindings(model); 
```

将使用处理程序的 html（请注意具有“有趣”绑定的元素如何不起作用）：

```
<div data-bind="generic: a, func: function( val ){ return val + 2; }"></div>
<div data-bind="generic: a, fun: function( val ){ return val + 2; }"></div>
<div data-bind="text: a"></div>
<div data-bind="generic: b, func: function( val ){ return val + 2; }"></div>
<div data-bind="generic: b, fun: function( val ){ return val + 2; }"></div>
<div data-bind="text: b"></div> 
```

您也可以只使用绑定的 init 来设置标准 DOM 事件处理程序，并使用 jQuery 之类的东西显式调用这些函数。谢谢你。再会。

# python - 如何在没有 root 的情况下在 Python 中挂载共享驱动器？

> ID：12229752
> 
> 赞同：0
> 
> 时间：2012-09-01T17:11:29.653
> 
> 标签：python, linux, share, root, drive

我正在尝试通过在 python 中使用**os.system()来安装共享驱动器。**问题是，安装的 linux 版本没有 sudo 命令。安装 sudo 包失败。使用命令 su 时，我收到一个错误，它必须与**suid**一起使用。我不能**chmod +s**因为我没有根。

有任何想法吗？模组？或者缓冲区溢出是这里唯一的解决方案？=)

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:24:25.110

如果没有 root 权限，您将无法挂载（在某些情况下除外，请参见下文。）如果您在该机器上没有权限，则必须询问管理员。

管理员可以做的是*将*某些挂载点插入`/etc/fstab`并标记它们`user`。管理员也可以`sudo`为您安装并允许您执行`sudo mount`.

Python 没有办法（也不应该有办法）规避这些基本的安全特性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:27:48.733

你可以试试保险丝： http: [//fuse.sourceforge.net/](http://fuse.sourceforge.net/)

这取决于您到底要安装什么，是否有能够这样做的保险丝模块。

当然，它必须安装。

# jquery - jquery：导航栏：使用z-index的子子菜单列表的堆栈顺序

> ID：12229753
> 
> 赞同：0
> 
> 时间：2012-09-01T17:11:46.823
> 
> 标签：jquery, navigationbar

如何让 subsubmenu1（蓝色背景）堆叠在 submenu1（红色背景）下？我曾尝试使用 z-index，但它不起作用。在下面的 jsfiddle 中，subsubmenu1 堆叠在 submenu1 之上。

[http://jsfiddle.net/vaanipala/rVNQk/3/](http://jsfiddle.net/vaanipala/rVNQk/3/)

html:

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Gama Corporate Services</title>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $("#submenu1,#submenu2").children().hide();
    $("#subsubmenu1").children("ul").hide();

    $("#submenu1,#submenu2").hover( 
        function(){//onmouseover 
            $(this).children("ul").slideDown(); 
        }, 
        function(){//onmouseout 
            $(this).children("ul").slideUp(); 
    });

$("#subsubmenu1").hover(
    function(){//onmouseover

        $(this).children("ul").animate({marginLeft:"50px"});
        $(this).children("ul").show();
    },
    function(){//onmouseout
        $(this).children("ul").animate({marginLeft:"0"});
        $(this).children("ul").hide();
    }); 
});
</script>
</head>

<body>
<div class="contentwrapper">
<div id="header">
<div id="logo">
    <img src="images/small_gama_logo.png" />
</div>
<div id="company_name">
    Gama Corporate Services Sdn Bhd
</div>
<div id="navbar">
    <ul id="menu">
        <li>Home</li>
        <li>About</li>
        <li id="submenu1">Register Company
            <ul>
                <li id="subsubmenu1">New Sendirian Berhad Registration
                    <ul>
                        <li>Company Price</li>
                        <li>Register New Company</li>
                        <li>Steps to Incorporate</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li id="submenu2">Buy Company
            <ul>
                <li>Sendirian Berhad Ready Made Companies in Malaysia</li>
            </ul>
        </li>
        <li>Contact</li>
    </ul>
</div>
</div>

<div id="leftcolumn">hello</div>
<div id="contentcolumn">Welcome to Gama Corporate Services.
This website is under construction</div>
<div id="rightcolumn">how ru</div>
<div id="footer">copyright gama corporate services</div>
</div><!--end contentwrapper-->

</body>
</html> 
```

样式.css

```
 /* CSS Document */
html body{
    padding:0;
    margin:0 auto;
}

.contentwrapper{
    width:900px;
    margin-left:auto;
    margin-right:auto;
    height: auto !important;
}
#header{
/*  height:20%;
*/  width:900px;
    height:280px;
    /*background-color:#009999;*/
    background-image:url('../images/bg_image.png');
    background-repeat:no-repeat;
    float:left;
    text-align:center;
}
#logo{
margin-top:15%;
float:left;
width:30%;
}
#company_name{
float:left;
font:"Times New Roman", Times, serif;
font-size:36px;
margin-top:20%;
}
#navbar{
/*  height:10%;
*/  width:900px;
    color:#ffffff;
    float:left;
    margin-top:2%;
    padding:0;
    z-index:0;
    position:relative;

}
#menu{
    list-style-type:none;
    margin:0;
    padding:0;
    position:absolute;
}

#menu li{
float:left;
    display:block;
    width:120px;
    text-align:center;
    background-color:#FF0000;
    padding:0;
    margin:0;

}
/*#menu li ul ul li*/
#subsubmenu1 ul li
{position:relative;
left:0;
top:-30px;
background:#3399CC;
}

#leftcolumn{
    float:left;
    width:20%;
    background-color:#FF9900;
}
#contentcolumn{
    float:left;
    width:60%;
    background-color:#ffffff;
}
#rightcolumn{
    float:left;
    width:20%;
    background-color:#FF9900;
}
#footer{
/*  height:10%;
*/  width:inherit;
    padding-top:4px;
    background-color:#009999;
    text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:56:28.777

你应该使用`position:absolute`with`z-index`

在悬停事件上尝试此代码：

```
$(this).children("ul").animate({marginLeft:"50px"}).css({"position":"absolute", "z-index":"-1"}); 
```

在顶部导航中隐藏其他元素

`**Replace this** : $("#submenu1,#submenu2").children().hide();`

`**With** : $("#submenu1,#submenu2").children("ul").hide();`在你的脚本中。

祝你好运 ！！

# php - PHP 来自产品数据库的三列表

> ID：12229757
> 
> 赞同：4
> 
> 时间：2012-09-01T17:12:26.197
> 
> 标签：php, loops, foreach

只是想知道是否有人可以为每个循环提供一个厚颜无耻的 php 帮助我......

我目前有一张产品表，我已经在一张表中回显，每张表都有 75% < hr >，但我希望它成为一个三列表。我不介意，例如，产品表中有 4 个产品，它在第一列，接下来的 2 个是空的，等等

当前代码如下...

```
<?php

if($results && mysql_num_rows($results) > 0){
?>

  <?php
    $i = 1;
    while($row = mysql_fetch_assoc($results)){
        $i++;
?><table width="750">
<tr>
    <td id="topbottom" width="220px"><a href="products.php?id=<?php echo($row['productId']); ?>"/><img src="images/<?php echo($row['imageName']); ?>"  width="220px"/></a></td>
    <td id="pad">
    <h1><?php echo($row['productName']); ?></h1>
    <br>
    <h2><?php echo($row['productType']); ?></h2>
    <br>
    <h3> &pound;<?php echo($row['productPrice']); ?></h3>
    <br>
    <?php echo($row['productDesc']); ?>
    <br /><br />
    <a href="products.php?id=<?php echo($row['productId']); ?>"/><img src="images/findout.png"/></a>

    </td>
  </tr></table><hr color="#6c3600" width="75%" />
<?php
    }
?>  

<?php
} else {
    echo("<p>No items found</p>");
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:24:49.930

```
<table width="750">

<?php

if($results && mysql_num_rows($results) > 0){
?>

  <?php
    $i = 0; // Set this to 0, since php is 0 based
    $cols = 3; // Number of cols you want
    while($row = mysql_fetch_assoc($results)){
        // Use the modulus operator to see if i is an even multiple of $cols
        // If it is then we need to open a new table row
        if($i % $cols == 0) 
        {
            echo '<tr>';
        }    
?>
    <td id="topbottom" width="220px"><a href="products.php?id=<?php echo($row['productId']); ?>"/><img src="images/<?php echo($row['imageName']); ?>"  width="220px"/></a></td>
    <td id="pad">
    <h1><?php echo($row['productName']); ?></h1>
    <br>
    <h2><?php echo($row['productType']); ?></h2>
    <br>
    <h3> &pound;<?php echo($row['productPrice']); ?></h3>
    <br>
    <?php echo($row['productDesc']); ?>
    <br /><br />
    <a href="products.php?id=<?php echo($row['productId']); ?>"/><img src="images/findout.png"/></a>

    </td>
    <?php

    $i++;
    // Same as above but we want to close the table row after $cols
    if($i % $cols == 0) 
    {
        echo '</tr>';
    }
    ?>
<?php
    }
?>  

</table><hr color="#6c3600" width="75%" />

<?php
} else {
    echo("<p>No items found</p>");
}
?> 
```

要寻找的关键事项：

设置`$i`为`0`因为 php 使用基于 0 的数组

设置一个名为的 var `$cols`，它允许您轻松更改列数

使用`%`（模数）运算符来查找数字是否是列的偶数倍，以`<tr>`在正确的位置动态添加标签。

# javascript - Javascript onClick 事件未触发

> ID：12229758
> 
> 赞同：5
> 
> 时间：2012-09-01T17:12:27.543
> 
> 标签：javascript

我正在尝试使用 Javascript 来控制 Web 表单。这是我所有的 Javascript 代码以及我想要实现的目标。

```
$(document).ready(function(){
    function loadPage(url){
        $(".body").fadeOut(400, function(){
            $(".body").load(url);
            $(".body").fadeIn(400);
        });
    }
    loadPage("pages/login.html");

    $("#button").on("click", function(){
        var pageTo = this.name;
        loadPage("pages/" + pageTo + ".html");
    });
}); 
```

代码稍后会做更复杂的事情，但它甚至不会运行上面的代码。

我的表格看起来像这样

```
<FORM>
    <SPAN class='header'>Login</SPAN><BR/>
    <LABEL for='username' class='loginLabel'>Username</LABEL>
    <INPUT type='text' id='username' name='username' value='' />
    <LABEL for='password'class='loginLabel'>Password</LABEL>
    <INPUT type='password' id='password' name='password' value='' />
    <INPUT type='hidden' name='process' value='login' />
    <INPUT type='button' value='Login' name='index' id='button' />
</FORM> 
```

它是一个简单的登录表单，但单击按钮时文本不会显示在控制台中。我不想使用提交按钮和 JQuery .submit() 事件，因为我希望相同的代码可以处理多种类型的事物，包括链接和可能的其他元素。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T18:00:38.093

您正在尝试在页面中存在元素之前绑定事件处理程序。

通过将回调传递给添加表单**后**绑定处理程序`.load`：

```
$(document).ready(function(){
    function loadPage(url){
        $(".body").fadeOut(400, function(){
            $(".body").load(url, function() {
                $("#button").on("click", function(){
                    var pageTo = this.name;
                    loadPage("pages/" + pageTo + ".html");
                });
            });
            $(".body").fadeIn(400);
        });
    }
    loadPage("pages/login.html");
}); 
```

或使用事件委托（参见[文档](http://api.jquery.com/on)中的*直接和委托事件*部分）：

```
$(document).on("click", "#button", function(){
    var pageTo = this.name;
    loadPage("pages/" + pageTo + ".html");
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T17:13:27.803

jQuery 对象没有`onClick`方法。使用[`.click`](http://api.jquery.com/click/). 您的代码应如下所示：

```
$("#button").click(function(){
    console.log("Clicked");
}); 
```

[演示](http://jsfiddle.net/amaan/ad3c2/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T17:13:29.120

这不是正确的方法，用 jquery 注册一个处理程序......

尝试

```
$('#button').click(function(){
   console.log('test');
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-01T17:13:55.087

`$("#button")`返回一个没有`onclick`属性/方法的 jQuery 对象。使用`.click`：

```
$('#button').click(function() {

}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-01T17:13:18.773

尝试`.on`

```
$("#button").on('click', function(){
    console.log("Clicked");
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-01T17:15:18.997

您确定在将 onclick 行为分配给按钮之前等待加载文档吗？尝试将作业更改为 inside

```
$(document).ready(function(...)) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-01T17:13:34.543

这不是`onclick`它`click`

```
$("#button").click(); 
```

# matlab - 我怎样才能使这段代码更简单

> ID：12229761
> 
> 赞同：0
> 
> 时间：2012-09-01T17:13:00.207
> 
> 标签：matlab

我想为以下问题编写一个更简单的代码：我有 2 个称为`A`和的矩阵`B`：

```
A=
   [ 1     7    12    24    36    48    51    63    68    73    77    82;
     2     7    12    24    36    48    60    66    70    74    79    83]
B=
   [ 0     2     1     1     1     1     1     1     1     1     0     1;
     1     1     1     1     1     1     1     2     0     0     1     0] 
```

并应用以下内容来获取矩阵`Res`：

```
Res = zeros(2,12);
     for x = 1:2;
        for t = 1:12;
            if B(x,t)~=0
               Res(x,t) = A(x,t) - B(x,t);
            else
               Res(x,t) = B(x,t);
            end
        end
    end

Res=
   [ 0     5    11    23    35    47    50    62    67    72    0    81;
     1     6    11    23    35    47    59    64    0     0    78    0] 
```

如何简化我的代码以获得`Res`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T17:29:20.747

好吧，我喜欢单线，所以这是与马克竞争的另一种解决方案：:)

```
Res = (A - B) .* (B ~= 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T17:22:25.633

嗯，到目前为止，我完全没有做到这一点。分两行：

```
Res = A - B;
Res(B==0) = 0; 
```

# php - PHP 计算特定单词在 h3 标签中出现的次数

> ID：12229766
> 
> 赞同：1
> 
> 时间：2012-09-01T17:13:45.663
> 
> 标签：php

我需要能够计算特定单词在特定 html 标记中出现的次数。目前我只能计算标签中显示的单词总数。而且我可以计算该单词在文档中总共出现了多少次，但我不知道如何计算一个单词仅在 h3 标签中出现的次数。

我需要的示例：

```
Sample text here, blah blah blah, lorem ipsum
<h3>Lorem is in this h3 tag, lorem.</h3>
lorem ipsum dolor....
<h3>This is another h2 with lorem in it</h3> 
```

因此，正如您所见，“lorem”一词在该代码中出现了 4 次，但我只想计算“lorem”一词在 h3 标签中出现的次数。

我宁愿在这个项目上继续使用 PHP。

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:26:32.417

我会像这样使用[DOMDocument](http://www.php.net/manual/en/class.domdocument.php)：

```
$string = 'Sample text here, blah blah blah, lorem ipsum
<h3>Lorem is in this h3 tag, lorem.</h3>
lorem ipsum dolor....
<h3>This is another h2 with lorem in it</h3>';

$html = new DOMDocument(); // create new DOMDocument
$html->loadHTML($string);  // load HTML string
$cnt = array();           // create empty array for words count
foreach($html->getElementsByTagName('h3') as $one){ // loop in each h3
    $words = str_word_count(strip_tags($one->nodeValue), 1, '0..9'); // count words including numbers
    foreach($words as $wo){ // create an key for every word 
        if(!isset($cnt[$wo])){ $cnt[$wo] = 0; } // create key if it doesn't exit add 0 as word count
        $cnt[$wo]++; // increment it's value each time it's repeated - this will result in the word having count 1 on first loop
    }
}

var_export($cnt); // dump words and how many it repeated 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:33:59.080

您还可以使用正则表达式来执行此操作：

```
<?php
    $string = 'Sample text here, blah blah blah, lorem ipsum
    <h3>Lorem is in this h3 tag, lorem.</h3>
    lorem ipsum dolor....
    <h3>This is another h2 with lorem in it</h3>';

     preg_match_all("/lorem(?=(?:.(?!<h3>))*<\/h3>)/i", $string, $matches);

     if (isset($matches[0])) {
        $count = count($matches[0]);
     } else {
        $count = 0;
     }

?> 
```

# c# - C# 忽略数据表中的“重复”

> ID：12229776
> 
> 赞同：1
> 
> 时间：2012-09-01T17:14:49.287
> 
> 标签：c#, sql, linq

我有一个来自某个来源的数据表，其中的构造函数

bookid 标题作者

如果该书有多个作者，则该表可以包含同一本书（重复）。像

```
Book id    title    author    
32         Book1    P. Samsom
45         Book34   R. Englund
45         Book34   H. Granger
56         Book45   F. Lister 
```

等等

现在第二本书和第三本书是相同的（它有两个作者）。显示表格（可以包含数千个项目）时，我不想显示同一本书两次或更多次。显示其中一个就足够了（我不在乎）。

在桌子上做一个 Select distinct 在这里没有帮助。做一个选择不同的忽略作者作品，但我至少需要一个作者。所以我想做的是找到最有效的方法来创建一个新的表或视图，忽略任何“重复”项目，至少保留一个作者。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:18:53.717

```
var books = Books.GroupBy(x=>x.Title).Select(x=>x.First()).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:28:39.093

```
var result =  books.GroupBy(b => b.bookid)
                   .Select(g => 
                        new { 
                            id = g.Key, 
                            title = g.First().title, 
                            authors = g.Select(a=>a.author).ToList() 
                        })
                   .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:08:48.453

`DistinctBy`来自[MoreLINQ](http://www.nuget.org/packages/morelinq)

```
var results = books.DistinctBy(x => x.title).ToList(); 
```

# c# - 数据绑定转换器“未实现接口成员”

> ID：12229777
> 
> 赞同：0
> 
> 时间：2012-09-01T17:14:58.260
> 
> 标签：c#, xaml, data-binding, datatemplate, ivalueconverter

我在使用以代码隐藏编写的绑定转换器以及相应的标记时遇到问题。它一直给我同样的错误：

> 不实现接口成员'System.Windows.Data.IValueConverter.Convert(object, System.Type, object, System.Globalization.CultureInfo)'

当我发现代码没有问题时。我正在尝试为加载页面时设置了 DataContext 的列表框设置 DataTemplate。这是我的应用程序中的一些部分代码

代码背后：

```
namespace Financial_Manager
{
    public class AmountOnScreenConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return "£" + Math.Round((decimal)value, 2).ToString();
        }
        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return null;
        }
    }
} 
```

Xaml：（本地对应命名空间 Financial_Manager）

```
<Page.Resources>
      <local:AmountOnScreenConverter x:Key="amountConvert" />
      <DataTemplate x:Key="recordTemplate">
             <Grid Name="newElement">
                    <TextBlock Name="txtAmount" Height="17" Width="70" Text="{Binding Path=Amount, Mode=OneWay, Converter={StaticResource amountConvert}}"/>
             </Grid>
      </DataTemplate>
</Page.Resources> 
```

我环顾四周，似乎找不到应该显示此错误的任何原因。如果我将转换器移到命名空间之外，则此错误不再存在，但我无法在标记中访问转换器。

有没有人有什么建议？

更新：我现在让 Visual Studio 接受我的代码是正确的，但必须将转换器移动到它自己的命名空间中。不明白为什么必须这样做..

# php - 处理多维数组 - PHP

> ID：12229782
> 
> 赞同：0
> 
> 时间：2012-09-01T17:15:30.313
> 
> 标签：php, multidimensional-array

我有这个循环：

```
 $diffe = $differenz*7;  
    $diff = 0; 
    $n = 0;
    $an = $anzahl-1;
    $z = 0;
    $plus = $periode;
    $oarray = array();
    $sarray = array();
    $parray = array();
    $h = 0;

    while ($n < $ortcount) {
    foreach ($ortearray as $o) {
    $oarray[] = $o;
    }
    $sarray[] = get_start_dates($star, $diff, $wochearray); 
    $diff += $diffe;

    while ($h < $ortcount) {
    $helpingstring= join(";",$sarray[$h]);
    echo $h;
    $sarrayhelp = explode(";", $helpingstring);

    while ($z < $an) {

    foreach ($sarrayhelp as $s) {         
    $parray[] = plustime($s, $plus);        

    }
    $plus = $plus+$periode;
    $z++;

    }
    $h++;
    }

    $n++;

    } 
```

并需要以下内容：

多维数组“$sarray[]”的每个“子数组”都应由 plustime() 函数逐步处理，结果应保存到“$parray[]”。

此时，只处理“$sarray[]”的第一个子数组。

任何帮助将不胜感激。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:18:12.437

制作递归函数：

```
function process(&$parray, $array, $plus){
  foreach($array as $s) {
    if(is_array($s)) {
      // this is subarray
      process($parray, $s, $plus);
      continue ;
    }
    $parray[] = plustime($s, $plus);
  }
}

.....
while ($z < $an) {
  process($parray, $sarrayhelp, $plus);
  .. 
```

请注意，糟糕的缩进和短变量 ( `$a, $az,$n, $an, $h, $z, $parray, $oarray, $diff, $diffe`) 会使您的代码非常难以维护和被他人理解。

# c# - geckofx GeckoElementCollection 对我不起作用

> ID：12229783
> 
> 赞同：1
> 
> 时间：2012-09-01T17:15:41.957
> 
> 标签：c#, geckofx

我是 c# 的新手，我正在尝试用 geckofx 做一些小实验。我可以导航，但是 html 的 DOM 有问题。我不明白为什么这段简单的代码不写链接是在页面上。花了几个小时证明不同的事情，但没有任何效果，有人可以告诉我我错在哪里。

提前感谢您的时间。

对不起我的英语不好，我正在学习它！

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Skybound.Gecko;
using System.Diagnostics;

namespace WindowsFormsApplication8
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            String xulPath = Application.StartupPath + "\\xulrunner\\";
            Xpcom.Initialize(xulPath);
        }

        private void Form1_Load(object sender, EventArgs e)
        {

            web.Navigate("http://es.wikipedia.org/wiki/Blog");
            System.Threading.Thread.Sleep(25000);
            Debug.WriteLine("hola");
            GeckoElementCollection links = web.Document.GetElementsByTagName("a");
            foreach (GeckoElement link in links)
            {
                Debug.WriteLine(link.GetAttribute("href"));
            }

        }

        private void web_Click(object sender, EventArgs e)
        {

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:14:46.823

解决了，问题是程序在搜索链接之前没有时间加载页面，方法thread.sleep没有给程序时间简单地停止它。

# javascript - 何时何地使用数据绑定添加元素

> ID：12229787
> 
> 赞同：0
> 
> 时间：2012-09-01T17:16:07.607
> 
> 标签：javascript, jquery, knockout.js, datatables

我的问题是，我没有添加`$(ele).html('some html')`到我的脚本的位置，因为添加它的时间太早或太晚了。这是我的实际问题：

## 首先我创建 viemModel

```
var mainAdmin = function(){
    var self = this;
    self.pageLanguage = mainAdminDTLanguage;
    self.tableData = ko.observableArray([]);
    self.dataTable = ko.observable(null);
    /*self.tableRowClick = function(data) {
        var checkCode = confirm('Vai atzīmēt šo kuponu?');
        if(checkCode){
            alert(data[0]);
            $.ajax({
                url: '/api/code/mark/'+data[0],
                type: 'GET',
                success: function(data) {
                    console.log(data);
                }
            });
        }
    };*/
    self.tableOptions = { aaSorting: [["1","desc"]] };
    self.dtSelectValue = ko.observable('visus');
    self.initLoad = function() {
        $.ajax({
            url: '/api/item/all',
            dataType: 'json',
            success: function(data) {
                $.each(data, function(index) {
                    self.tableData.push([this.ID,this.Title, Dateformat('M jS, H:i:s',new Date(this.EndDate)),'<button>Dzēst</button>']);
                    console.log(this.ID);
                });
                console.log(data);
            }
        });
    };
    self.recentItemLoad = function() {
        $.ajax({
            url: '/api/item/inactive',
            dataType: 'json',
            success: function(data) {
                self.tableData([]);
                $.each(data, function(index) {
                    self.tableData.push([this.ID,this.Title, Dateformat('M jS, H:i:s',new Date(this.EndDate)),'<button>Dzēst</button>']);
                    console.log(this.ID);
                });
                console.log(data);
            }
        });
    };
    self.activeItemLoad = function() {
        $.ajax({
            url: '/api/item/active',
            dataType: 'json',
            success: function(data) {
                self.tableData([]);
                $.each(data, function(index) {
                    self.tableData.push([this.ID,this.Title, Dateformat('M jS, H:i:s',new Date(this.EndDate)),'<button>Dzēst</button>']);
                    console.log(this.ID);
                });
                console.log(data);
            }
        });
    }
    self.dtSelectValue.subscribe(function(newValue) {
   (newValue == 'visus') ? mainViewModel.mainAdminPage.initLoad() : (newValue == 'aktīvos') ? mainViewModel.mainAdminPage.activeItemLoad() : (newValue == 'neaktīvos') ? mainViewModel.mainAdminPage.recentItemLoad() : false
});
}; 
```

**是的，我知道这有点乱，但实际上我还没有时间优化它**

## 然后我创建 jQuery 的 DataTable 绑定

```
ko.bindingHandlers.dataTable = {
  init: function(element, valueAccessor) {
    var options = valueAccessor();
    var defaults = {
        "aaData": options["data"](),
        "bRetrieve": true,
        "oLanguage": options["language"],
        "bJQueryUI": true,
        "sDom": '<"H"l<"dt-toolbar">fr>t<"F"ip>',
        "fnRowCallback": function(nRow, aData, iDisplayIndex) {
            $(nRow).mouseover(function(){
              $(nRow).attr("style","background-color:yellow !important;");
            });  
            $(nRow).mouseout(function() {
              $(nRow).removeAttr("style");
            });
            if(typeof options["rowClick"] === "function") {
              $(nRow).click(function() {
                options["rowClick"](aData);
              });  
            }  
            return nRow;
        },    
    };
    var tableOptions = $.extend(defaults,options["options"]);
    options["object"]($(element).dataTable(tableOptions));
    $("div.dt-toolbar")
        .html('Rādīt <select data-bind="value: $data.dtSelectValue"><option>visus</option><option>aktīvos</option><option>neaktīvos</option></select> kuponus');
  },
  update: function(element,valueAccessor) {
    var options = valueAccessor();
    options["object"]().fnClearTable();
    options["object"]().fnAddData(options["data"](),true);
  }
}; 
```

**你可以看到我创建了** `$("div.dt-toolbar") .html('Rādīt <select data-bind="value: $data.dtSelectValue"><option>visus</option><option>aktīvos</option><option>neaktīvos</option></select> kuponus');`@ `init`！

## 然后我创建 mainViewModel 并应用绑定

```
// --- mainView viewmodel
var mainViewModel = {
    indexPage: new indexViewModel(),
    itemPage: new itemViewModel(),
    catPage: new categoryViewModel(),
    companyPage: new companyAdmin(),
    mainAdminPage: new mainAdmin()
};

// --Applied bindings
ko.applyBindings(mainViewModel); 
```

**现在**您可以看到我在应用绑定之后创建了 DataTable，基本上是按以下顺序：

1.  视图模型
2.  主视图模型
3.  自定义绑定
4.  创建 HTML
5.  将绑定应用到 html
6.  创建html`data-bind`

## 问题

1.  如何在不进入 int 无限循环的情况下将绑定应用于该确切元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:46:44.473

为什么不使用`foreach`绑定表呢？您将某些“html元素”拉入您的视图模型，我认为这是一种不好的做法。

```
<tbody data-bind="foreach: { data: tableData, afterRender: a function }>
<tr>
 <td></td>
 ...
</tr> 
```

要选择，您可以对选项使用绑定，

```
<select data-bind="options: optionsData">
</select> 
```

这是[knockoutjs foreach的链接](http://knockoutjs.com/documentation/foreach-binding.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:46:51.467

所以基本上我发现我可以制作函数，通过在里面创建新函数来`$("div.dt-toolbar")`动态更新`html``mainAdmin`

```
self.updateDTmenu = function () {
        $("div.dt-toolbar")
        .html('Rādīt <select data-bind="value: dtSelectValue"><option value="visus">visus</option><option value="aktīvos">aktīvos</option><option value="neaktīvos">neaktīvos</option></select> kuponus');
        ko.applyBindings(new mainAdmin(), $("div.dt-toolbar")[0]);
    }; 
```

然后在`dataTable`绑定内部而不是`$("div.dt-toolbar").html('someHtml');`写这个`mainViewModel.mainAdminPage.updateDTmenu();`

这样，它只将自身应用于元素，并且可以动态创建任何元素！

# php - 带有 ASP.net 的 PHP 应用程序

> ID：12229788
> 
> 赞同：1
> 
> 时间：2012-09-01T17:16:20.003
> 
> 标签：php, asp.net, shopping-cart

我对网络开发很陌生，想问这个问题..可能是一个愚蠢的问题:)

我目前正在 ASP.net 中开发一个项目。该网站的主要功能之一是集成购物车。我发现以下购物车完全符合我的需求，但它是用 PHP (http://scripts.jakweb.ch/dragndropshop/) 编写的。是否可以将它们集成在一起？（也许最终将它们发布在同一台服务器上？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:24:31.827

这取决于您需要什么级别的集成，您将无法在同一个页面请求上运行 ASP.NET 和 PHP，但是是的，您可以在同一台服务器上发布它们，并且您应该能够通过一点创意将两者结合起来。

**注意**如果您需要 PHP 购物车在 ASP.NET 中执行逻辑，您可能需要创建一个 Web 服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T18:51:51.377

看来要费一番功夫去。您是否考虑过一个像 nopCommerce 这样的 asp.net 购物车解决方案，在这里可以找到[http://www.nopcommerce.com/default.aspx](http://www.nopcommerce.com/default.aspx)，它的功能很好，我之前在几个商业项目中使用过它并取得了巨大的成功。与其将时间花在 PHP 和 ASP.NET 之间的集成上，不如在项目期间将时间和精力投入到其他更高效的事情上，例如定制、扩展或展示 nop cart 系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T17:32:09.783

只要这个购物车有合适的 API 来将商品添加到购物车并进行结帐，您就可以从您的 asp.net 应用程序中进行这些调用。

与 php 应用程序集成的大部分问题都与安全性有关。由于您不能直接使用 asp.net 会员资格，因此您必须付出额外的努力来确保它的安全。

# c++ - cpp undefined reference to `class::method'

> ID：12229790
> 
> 赞同：0
> 
> 时间：2012-09-01T17:16:56.950
> 
> 标签：c++, gcc

当我尝试编译时

$ gcc -lcurl try.cpp

```
/tmp/ccJs0k9m.o: In function `main':
try.cpp:(.text+0x2d): undefined reference to `getURL::fetch(char*, char*)'
collect2: ld returned 1 exit status 
```

该方法出现在标题和类主体中。究竟有什么问题？

尝试.cpp

```
#include <curl/curl.h>
#include <curl/easy.h>
#include "getURL.h"

int main(void) {

getURL my_getURL;

my_getURL.fetch("http://stackoverflow.com/", "file");
} 
```

获取URL.h

```
#ifndef _getURL
#define _getURL

class getURL {
public:
    void fetch(char *url, char *filename);
};
#endif 
```

获取URL.cpp

```
#include <curl/curl.h>
#include <curl/easy.h>
#include <stdio.h>

class getURL {

private CURL *curl;

public getURL() {
    //code
}

public void fetch(char *url, char *filename) {
    //code
}

private size_t write_data(void *ptr, size_t size, size_t nmemb, FILE *stream) {
    //code
}

public ~getURL() {
    //code
}

} //end class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:25:42.517

您没有使用正确的实现语法；它是

```
getURL::getURL() {
    //code
}

void getURL::fetch(char *url, char *filename) {
    //code
}

size_t getURL::write_data(void *ptr, size_t size, size_t nmemb, FILE *stream) {
    //code
}

getURL::~getURL() {
    //code
} 
```

请注意，您不能`class`在实现中重复该部分（只需包含标题）。另请注意，您不允许在实现中拥有在声明中不可见的私有成员......这很不幸，但这就是语言的定义方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:09:21.547

您只编译您的源文件之一。

改变：

```
gcc -lcurl try.cpp 
```

到：

```
gcc -lcurl try.cpp getURL.cpp 
```

# c++ - 什么时候会出现结构打包问题？

> ID：12229791
> 
> 赞同：0
> 
> 时间：2012-09-01T17:17:53.350
> 
> 标签：c++, struct

我一直在阅读有关 struct bit 打包顺序问题的信息，但由于曝光有限，我自己没有遇到过。但是，我注意到这些讨论主要针对非常复杂的应用程序。

我现在正在编写一个结构来保存来自 ifstream 这样的信息

```
struct MyFileStruct
{
    char data1[40];
    int data2;
    char data3[12];
    // etc..
};

ifstream fin;
// .. snip ..
fin.read((char*)&myfilestruct, sizeof(MyFileStruct)); 
```

只是想如果在这个简单的场景中是否会出现任何问题，可能是在另一个操作系统或 32/64 位架构中。等等。那么，确切地说，什么时候会考虑位包装顺序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:46:55.710

使用该特定结构，您最有可能遇到的问题是字节序。在 little-endian 系统上，最低地址字节`int`包含*最低*有效 8 位。在大端系统上，*最高*有效 8 位。

因此，如果您将该结构的字节写入一种系统上的文件，将文件传输到另一种系统，然后将其读回，那么您将在`data2`.

但是，您可能会在使用其他结构或使用不寻常的系统/编译器时遇到其他问题：

*   基本类型的大小 -`int`通常是 4 个字节，但不是必须的。`long`在不同的常见系统上具有不同的大小（Windows 上为 4 字节，64 位 Linux 上为 8 字节）。显然，如果您尝试从文件中读取结构，并期望与其他 C++ 实现实际写入的字节数不同，那么您就有问题了。
*   padding - 允许编译器将未使用的字节放入成员之间的结构中。这通常发生以确保对齐。例如，在许多编译器中，`int`成员的偏移量始终是 4 的倍数。由于 40 在您的结构中无论如何都是 4 的倍数，这不会有任何区别，但如果第一个数组是 39 字节，那么实现对齐`int`会插入一个未使用的字节，而没有插入的则不会。在某些 CPU（例如 x86）上，`int`对齐是有帮助的，但不是必需的，在这种情况下，编译器通常有办法注释一个结构来说明是否填充它。

由于存在这些差异，通常将结构直接写入文件（或套接字）是不合法的。您可以在特定情况下摆脱它，即读取它的人对该结构具有完全相同的内存表示，这意味着如果您首先准确计算出哪些字节具有什么含义，然后确保所有需要读/写文件的程序可以使用该格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T18:01:34.590

遇到问题的一个典型示例是序列化结构数组。假设结构大小为 12，但它被打包到 4 字节边界或 8 字节边界。如果磁盘上有一个包含 2 个元素的数组，则第一个元素将从偏移量 0 开始。第二个将从位置 12（如果要打包到 4 字节边界）或位置 16（如果要打包到 8 字节边界）开始。因此，当您读取数组时，第一个元素会正确出现，但第二个（以及后续元素）可能会被弄乱。

请注意，在 Visual Studio 中，对于 32 位和 64 位编译，默认打包为 8 字节边界，因此您可能会很幸运并且没有问题。但是，如果您想看到这一点，请将您的 32 位编译器设置为与 4 字节边界对齐，并将您的 64 位编译器设置为与 8 字节边界对齐（例如）。然后像上一段一样创建一个结构数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:38:34.477

打包规则（以及类似的[字节序](http://en.wikipedia.org/wiki/Endianness)）可能会成为考虑因素，**包括您的示例**，当

*   该程序是用不同的编译器编译的
*   程序是用同一个编译器的不同版本编译的*（理论上）*
*   该程序使用不同的编译器选项进行编译，包括但不限于更改目标操作系统、目标硬件或 32/64 位设置
*   编译器指令被添加到源代码中，例如`#pragma pack`.

一个安全的一般规则是，**只有当读取您的结构的可执行文件是由相同的可执行文件编写时，您的代码才能保证工作**。

当这是一个问题时，打包问题（但不是字节顺序）的一种常见解决方案是使用非标准编译器指令以效率为代价来删除打包。

这可以通过[`pragma pack`](http://msdn.microsoft.com/en-us/library/2e70t5y1%28v=vs.80%29.aspx)Microsoft 编译器和[`__attribute__ ((__packed__))`](http://gcc.gnu.org/onlinedocs/gcc/Type-Attributes.html)gcc 来完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T17:23:11.797

一般规则是您可以读取使用由同一编译器编译的代码编写的文件（并且包括编译器选项）。最简单的形式是写出二进制数据的程序，以便以后可以将其读回。除此之外，您将进入特定于实现的行为，并且没有简单的答案。

# php - ImageSX 和 ImageSY 提供的参数不是有效的图像资源

> ID：12229793
> 
> 赞同：1
> 
> 时间：2012-09-01T17:18:05.700
> 
> 标签：php, function, gd, thumbnails

我很难理解这个函数和包含的代码的问题。

我可以告诉它的所有密集目的都应该没有问题。

我正在运行 GD 库 2.034，这是我正在执行的代码：

```
function createthumb($name,$filename,$new_w,$new_h){
$system=explode('.',$name); 
if (preg_match('/jpg|jpeg/',$system[1])){ 
    $src_img=imagecreatefromjpeg($name);
} 
if (preg_match('/png/',$system[1])){ 
    $src_img=imagecreatefrompng($name); 
}

//sizing 
$old_x=imageSX($src_img); 
$old_y=imageSY($src_img); 
if ($old_x > $old_y) { 
    $thumb_w=$new_w; 
    $thumb_h=$old_y*($new_h/$old_x); 
} 
if ($old_x < $old_y) { 
    $thumb_w=$old_x*($new_w/$old_y); 
    $thumb_h=$new_h; 
} 
if ($old_x == $old_y) { 
    $thumb_w=$new_w; $thumb_h=$new_h; 
}

//keep colours 
$dst_img=ImageCreateTrueColor($thumb_w,$thumb_h); 
imagecopyresampled($dst_img,$src_img,0,0,0,0,$thumb_w,$thumb_h,$old_x,$old_y);

//rebuild image 
if (preg_match("/png/",$system[1])) { 
    imagepng($dst_img,$filename); 
} 
else { 
    imagejpeg($dst_img,$filename); 
} 
imagedestroy($dst_img); 
imagedestroy($src_img); 
} 
```

然后用这个执行：

```
$filenameresize = strtolower($_FILES['pic']['name']);
$mkfilename = time() . strrchr($filenameresize, '.');
$newfilename = $imagepath . $mkfilename;
createthumb($newfilename, $imagepath . "/thumbs/tn_" . $mkfilename,100,100); 
```

回响

```
$新文件名
```

如果它在 createthumb 函数之前回显，则给出它的名称，但如果在之后回显则不产生。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:10:18.903

好吧，我修好了！

这是解决方案。

问题在于按代码收集文件类型，而 preg 匹配不正确。

我添加了这些行：

```
list($old_x, $old_y, $type) = getimagesize($name);
switch ($type)
 {
case 1:   //   gif -> jpg
  $src_img = imagecreatefromgif($name);
break;

case 2:   //   jpeg -> jpg
  $src_img = imagecreatefromjpeg($name); 
break;

case 3:  //   png -> jpg
  $src_img = imagecreatefrompng($name);
break;
} 
```

并删除了这些行：

```
$system=explode('.',$name); 
if (preg_match('/jpg|jpeg/',$system[1])){ 
  $src_img=imagecreatefromjpeg($name);
} 
if (preg_match('/png/',$system[1])){ 
  $src_img=imagecreatefrompng($name); 
}

$old_x=imageSX($src_img); 
$old_y=imageSY($src_img); 
```

希望这会对你们中的一些人有所帮助。

# php - 将所有 HTML 标签转换为小写

> ID：12229795
> 
> 赞同：0
> 
> 时间：2012-09-01T17:18:21.020
> 
> 标签：php, regex, preg-replace

我有这段代码，但是 PHP 给了我一个`Unknown modifier '?'`错误。

有谁知道我做错了什么？（我在互联网上找到了代码，因为我不熟悉正则表达式）

```
$old = "<FONT></FONT><P></P><TR></TR>";
$newString = preg_replace("/</?\w+/e/", "strtolower('\\0')", $old);
echo $newString ."<br/>"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T17:20:07.380

PHP *5.4*及更早版本：

```
$old = "<FONT></FONT><P id='P1'></P><TR></TR>"; 
$newString = preg_replace("/(<\/?\w+)(.*?>)/e", "strtolower('\\1') . '\\2'", $old); 
echo $newString ."<br/>"; 
```

自 PHP *5.5.0起***不推荐使用**该`e`修饰符，请改用：***`preg_replace_callback`***

 ***```
$old = "<FONT></FONT><P id='P1'></P><TR></TR>"; 
$newString = preg_replace_callback("/(<\/?\w+)(.*?>)/", function ($m) {
  return strtolower($m[1]) . $m[2]; }, $old); 
echo $newString ."<br/>"; 
```

* * *

输出：

```
<font></font><p id='P1'></p><tr></tr><br/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:20:47.650

`</?\w+>`应用小写后用自身替换正则表达式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:25:25.523

这就是你要找的？

对于后代：此代码将处理属性注释和`<!CDATA[[]]!>`

```
<?php

function lowerTags($matches) {
    return strtolower($matches[1]);
}

$old = "<!--BLAH--><FONT COLOR='BLACK'>extra textCAPITALIZED</FONT><P></P><TR></TR>";

echo preg_replace_callback("/(<\/?[^!][^>]+)/", 'lowerTags', $old); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T17:27:04.447

我不使用也不推荐正则表达式来解析html，但是这里有一些错误：

1.  您正在使用该`/`符号作为分隔符，因此您需要在正则表达式中对其进行转义或使用另一个分隔符；
2.  最后你有一个额外`/`的不应该在那里。

所以你的代码应该看起来像（使用另一个分隔符）：

```
$newString = preg_replace("#</?\w+#e", "strtolower('\\0')", $old); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-05T15:08:40.050

这是一个处理属性名称和标签的解决方案。请注意，这仍然不完全正确；它假定字符 > 永远不会在属性值中找到，例如图像的 alt 文本。要正确执行此操作，请使用 DOMDocument 类（但请注意解析器会遇到输入无效的问题）。

```
<?php

function lowercase_tag_name_callback(array $m) {
  return strtolower($m[1]) . lowercase_attribute_name($m[2]);
}
function lowercase_attribute_name_callback(array $m) {
  return ' ' . strtolower($m[1]) . $m[2];
}
// change each attribute name to lowercase
function lowercase_attribute_name($input) {
  $output = $input;
  $output = preg_replace_callback('# ([a-zA-Z]+)(="[^"]+")#', 'lowercase_attribute_name_callback', $output);
  $output = preg_replace_callback("# ([a-zA-Z]+)(='[^']+')#", 'lowercase_attribute_name_callback', $output);
  $output = preg_replace_callback('# ([a-zA-Z]+)(=[^"\']+[ >])#', 'lowercase_attribute_name_callback', $output);
  return $output;
}

$input = <<<'EOD'
<FONT></FONT><P id="P1"></P><TR></TR><IMG SRC="FourFive.jpg" ID='AnIDHere' ALT="FOUR five" CLASS=FourFive><!-- A Comment Here --><![CDATA[ CDATA Text Here ]]>

EOD;

$output = preg_replace_callback("#(</?\w+)(.*?>)#", 'lowercase_tag_name_callback', $input); 
print "BEFORE: $input";
print " AFTER: $output"; 
```***

# jquery - Seat Geek API 不响应 Jquery

> ID：12229796
> 
> 赞同：0
> 
> 时间：2012-09-01T17:18:26.600
> 
> 标签：jquery, api

我在使用以下对 seageek 的 jquery 调用时遇到问题。我正在尝试获取所有事件的标题信息输出。我想我可能弄乱了一些 jquery 表示法。有谁知道我可能做错了什么？

```
<script>

  $.getJSON("http://api.seatgeek.com/2/events/?callback=?", function(data) {
        var output="<ul>";
    for (var i in data.Title) {
        output+="<li>" + data.Title[i] +"</li>";
    }

    output+="</ul>";
    document.getElementById("placeholder").innerHTML=output;
  });
 </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:24:51.280

访问结果对象中的`events`数组，*然后*才访问属性（区分大小写）：`data`*`title`*

 *```
$.getJSON("http://api.seatgeek.com/2/events/?callback=?", function(data) {
  var output="<ul>";
  for (var i = 0; i < data.events.length; i++) {
    output += "<li>" + data.events[i].title +"</li>";          
  }            
  output += "</ul>";
  document.getElementById("placeholder").innerHTML=output;
});​ 
```

**[演示](http://jsfiddle.net/TTgqu/)**。*

# php - 如何将 mod_rewrite 与 godaddy 一起使用

> ID：12229797
> 
> 赞同：1
> 
> 时间：2012-09-01T17:18:31.907
> 
> 标签：php, .htaccess

我正在使用 godaddy linux 共享主机，我在 mod_rewrite 上遇到了一些问题。我不太熟悉 mod_rewrite 我的代码是

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L] 
RewriteRule readfile.php(.*)$ seceretfile.php?$1 [L,QSA] 
```

此代码在我的本地主机上工作文件但在线它不起作用当我去 readfile.php 它显示文件未找到并且当我输入一个没有 .php 扩展名的文件时它显示错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T15:26:47.357

经过一番研究，我找到了解决方案

```
Options +FollowSymlinks -MultiViews
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L] 
RewriteRule readfile.php(.*)$ lebetafile.php?$1 [L,QSA] 
```

现在这段代码对我有用..但是发生了一个新问题，即原始 404 错误文件无法正常工作，我不知道这样做的安全风险但这与 godaddy 一起工作正常

# facebook - Facebook 喜欢 HTTPS

> ID：12229801
> 
> 赞同：1
> 
> 时间：2012-09-01T17:19:21.437
> 
> 标签：facebook, ssl, https, facebook-like, facebook-social-plugins

我进行了全面的研究，但找不到解决问题的方法。当我将我的网站从 http 切换到 https 时，我失去了很多喜欢，因为显然 facebook 认为它的 URL 不同，但这不是问题。

现在我意识到赞按钮甚至不起作用 - 所有其他按钮都可以，但是[https://www.findyournet.com](https://www.findyournet.com)的主要按钮无法使用。我在调试器上检查了它，我没有收到任何错误，但是当我点击喜欢该页面时它失败了。

facebook喜欢不允许https吗？有没有人遇到过这个？这是有问题页面的链接：[https ://www.findyournet.com/facebook/like.php](https://www.findyournet.com/facebook/like.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T15:56:27.783

Edit (previous response deleted):

I'm not sure why it isn't working but here is a workaround:

Change your Like button code to this (only the URL is different)

```
<fb:like href="http://o-e.us/e.php?o=p43c" layout="button_count" show_faces="false" action="like" colorscheme="light"></fb:like> 
```

I had trouble with like buttons/open graph tags when I was just starting as a developer so I made this tool: [Facebook Like Button Generator](http://o-e.us/fb/lbg)

I used the values in your open graph tags from [https://www.findyournet.com](https://www.findyournet.com) so they should be exactly the same. My tool is pretty much a link shortener with custom open graph field setting and it will redirect back to whichever link you want it to (without the facebook crawler/bot knowing).

It worked for me, give it a shot :)

# php - 我似乎无法在页面上显示我的查询结果？

> ID：12229805
> 
> 赞同：0
> 
> 时间：2012-09-01T17:20:07.240
> 
> 标签：php, mysql

首先，我对 php 相当陌生，但我对它有一个粗略的了解。从字面上看，我一直在寻找数小时到数天到数周来解决这个问题（我认为这是一个简单的功能），我讨厌不得不求助于他人，但我很抱歉，因为我真的不明白为什么它不是工作。

我将给出正在发生的事情的基本布局，我将使用密码=密码用户名=用户名等来演示：

```
 <div id="something>
   <?php

   define ('HOSTNAME', 'hostname');
   define ('USERNAME', 'username');
   define ('PASSWORD', 'password');
   define ('DATABASE_NAME', 'databasename');

   $db = mysql_connect(HOSTNAME, USERNAME, PASSWORD) or die ('I cannot connect to MySQL.');

   mysql_select_db(DATABASE_NAME);

   $query = "SELECT ImageName , ImagePath FROM Thumbnails";

   $result = mysql_query($query);

   $row = mysql_fetch_array($result)

   echo $row['ImageName'];
   echo $row['ImagePath'];

   mysql_close();
   ?>

   </div> 
```

当然，在数据库中有一个名为“Thumbnails”的表，其中有很多行 2，其中“ImageName”和“ImagePath”当前包含 1 个字段，每个字段分别是“example”和“example.jpg”。我试过用 ('"]. 和各种方法让它工作，但没有一个工作。我再次很抱歉打扰了，我相信我应该先研究基础知识，但我认为这一点将是基础，嗯，提前谢谢。ps我还尝试了不同的数据库配置设置和许多不同的布局：

```
 $hostname='hostname';
 $username='username';
 $password='password';
 $dbname='database'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:37:21.687

首先，你应该在'something'之后加上引号。其次，您忘记了行变量行之后的分号。

接下来我很确定你应该把它放在一个这样的while循环中：

```
while ($row = mysql_fetch_assoc($result)) {
    echo $row['ImageName'];
    echo $row['ImagePath'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:35:36.627

你必须把`mysql_fetch_array`函数放在一个循环中

```
// ...   

while ($row = mysql_fetch_array($result)) {
    echo $row['ImageName'];
    echo $row['ImagePath'];
    echo PHP_EOL;
}

// ... 
```

# c - 时间切片问题

> ID：12229806
> 
> 赞同：5
> 
> 时间：2012-09-01T17:20:18.930
> 
> 标签：c, multithreading, pthreads

我试图看看时间切片的效果。以及它如何消耗大量时间。实际上，我试图将某个工作分成多个线程并查看效果。

我有一个两核处理器。所以两个线程可以并行运行。我试图查看我是否有一个由 2 个线程完成的工作，以及我是否有 t 个线程完成的相同工作，每个线程都在做 w/t 的工作。时间切片在其中起多大作用

由于时间切片是耗时的过程，我期望当我使用双线程进程或线程进程执行相同的工作时，t 线程进程所花费的时间会更多

然而，我发现事实并非如此。我尝试使用 t=10。而且它仍然比 2 线程进程快。例如。如果我必须进行 10,000,000 次迭代，使用两个线程进程，我将让 2 个线程进行 5,000,000 次迭代，这样我们总共有 10,000,000 次迭代。如果我必须处理 10 个线程的进程，我会让每个线程进行 1,000,000 次迭代，这样我们总共也有 10,000,000 次。

我期待 10 线程进程消耗更多时间。但事实并非如此。代码中是否有任何错误？对我来说看起来不错

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:00:58.980

您正在按顺序执行 10000000（1000 万）x 1000 次迭代，并为并行版本中的每个线程执行 5000000（500 万）x 1000 次迭代。以我的经验，这足以使启动开销变得微不足道。结果对我来说似乎是正确的。

对于 2 个内核和 2 个线程，不涉及时间片（至少在 2 个工作线程中），因为调度程序足够聪明，可以将线程放在单独的内核上并将它们保留在那里。

为了看到一些降级，您需要在缓存中移动一些内存，这样每个上下文切换实际上会通过导致一些数据从缓存中被逐出来惩罚性能。这是我得到的运行时间：

> ./a.out 2 500000000
> 线程数 = 2
> 每个线程的迭代次数 = 250000000
> 总耗时 = 5.931148
> 
> ./a.out 1000 500000000
> 线程数 = 1000
> 每个线程的迭代次数 = 500000
> 总耗时 = 6.563666
> 
> ./a.out 2000 500000000
> 线程数 = 2000
> 每个线程中的迭代次数 = 250000
> 总时间 = 7.087449

这是代码。我基本上是在给定线程之间划分一个大数组并对数组中的每个项目进行平方：

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

long* array;
int length;
int threads;

void *tfunc(void *arg) {
  int n = (int)arg;
  int i;
  int j;
  int x;
  long sum = 0;
  //printf("%d\n",*n);
  int start = n * (length / threads);
  int end = (n + 1) * (length / threads);

  for (i=start; i<end; i++) {
    array[i] = array[i] * array[i];
    //printf("%d\n",i);
  }
  return(0);

}

double timestamp() {
  struct timeval tp;
  gettimeofday(&tp, NULL);
  return (double)tp.tv_sec + tp.tv_usec / 1000000.;
}

int main(int argc, char *argv[]) {
  int numberOfIterations = atoi(argv[2]);
  int numberOfThreads = atoi(argv[1]);
  int i;
  printf("Number of threads = %d\n",numberOfThreads);
  printf("Number of iterations in each thread = %d \n", numberOfIterations / numberOfThreads);
  pthread_t workerThreads[numberOfThreads];
  int *arg = &numberOfIterations;

  array = (long*)malloc(numberOfIterations * sizeof(long));
  length = numberOfIterations;
  threads = numberOfThreads;
  int result[numberOfThreads];

  double timeTaken;
  timeTaken = timestamp();

  for(i=0; i<numberOfThreads; i++) {
    result[i] = pthread_create(workerThreads+i, NULL, tfunc, (void*)i);
  }

  for(i=0; i<numberOfThreads; i++) {
    pthread_join(workerThreads[i], NULL);
  }

  timeTaken = timestamp() - timeTaken;
  printf("Total time taken = %f\n", timeTaken);
  /*printf("The results are\n");
  for(i=0; i<numberOfThreads; i++) {
    printf("%d\n",result[i]);
  }*/

  free(array);
  exit(0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:22:49.527

要让应用程序在线程数多于处理器的情况下表现出显着的、易于测量的减速，您必须努力：

1）线程必须是CPU密集型的，即。不要阻塞 I/O 或彼此。如果您使用的是简单的计数循环（听起来像您），那么是的，已经完成了。

2) 您必须安排每个线程处理足够大的数据，以便 L1 缓存在上下文交换时需要大量刷新。如果您只增加一个整数，则不会发生这种刷新，并且上下文切换开销将太小（与计时器驱动的调度运行之间的间隔相比），无法轻松演示。

Windows 示例数据，最小缓存刷新，i7，4/8 内核：

```
8 tests,
400 tasks,
counting to 10000000,
using 8 threads:
Ticks: 2199
Ticks: 2184
Ticks: 2215
Ticks: 2153
Ticks: 2200
Ticks: 2215
Ticks: 2200
Ticks: 2230
Average: 2199 ms

8 tests,
400 tasks,
counting to 10000000,
using 32 threads:
Ticks: 2137
Ticks: 2121
Ticks: 2153
Ticks: 2138
Ticks: 2137
Ticks: 2121
Ticks: 2153
Ticks: 2137
Average: 2137 ms

8 tests,
400 tasks,
counting to 10000000,
using 128 threads:
Ticks: 2168
Ticks: 2106
Ticks: 2184
Ticks: 2106
Ticks: 2137
Ticks: 2122
Ticks: 2106
Ticks: 2137
Average: 2133 ms

8 tests,
400 tasks,
counting to 10000000,
using 400 threads:
Ticks: 2137
Ticks: 2153
Ticks: 2059
Ticks: 2153
Ticks: 2168
Ticks: 2122
Ticks: 2168
Ticks: 2138
Average: 2137 ms 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:36:43.770

你的机器上有多少个 CPU 内核？关于 CPU 绑定线程的问题是，即使设置和调度只有一个线程时不存在的线程可能会有开销，但如果这些线程实际上可以同时执行（而不是仅仅出现同时执行），那么线程仍然可以产生大于开销成本的增益。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T17:44:19.937

如果您有多个逻辑核心，您的线程将并行执行。

要检验您的假设，您需要将它们固定到单个逻辑核心。

# html - 使用 Quickrun.vim 插件在 Vim 中打开 HTML

> ID：12229807
> 
> 赞同：1
> 
> 时间：2012-09-01T17:20:21.023
> 
> 标签：html, vim, plugins, browser

有人使用名为[QuickRun](https://github.com/thinca/vim-quickrun)的 Vim 插件吗？有了它，您可以通过键入轻松运行当前代码（多种语言）`:QuickRun`。但是，我怎样才能用它运行 HTML 代码呢？

我正在使用 Ubuntu。我意识到我可以使用它`!gnome-open %`，但是 QuickRun 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:52:41.817

看起来如果你添加

```
let g:quickrun_config = {}
let g:quickrun_config.html = {'command' : 'gnome-open'} 
```

对你`.vimrc`来说，它会做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:35:35.883

阅读简介，我在支持的文件类型列表中看不到 HTML。您需要阅读文档 ( `:help quickrun`) 以添加对 HTML 的支持。

或者使用简单得多的`!gnome-open %`。

# git - 如何锁定 git repos master 分支？

> ID：12229810
> 
> 赞同：4
> 
> 时间：2012-09-01T17:20:34.183
> 
> 标签：git, hook, pre-commit-hook

我需要锁定 git repo 的 master 分支。我尝试了预提交挂钩，但它们只是客户端挂钩，但我想锁定大多数用户的主分支。谁能告诉我在 git 上预接收挂钩的步骤（我使用 github）或任何更好的锁定 master 的方法？

PS：我们的 github 许可版本不支持 gitolite。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:09:03.410

Licensed GitHub 的意思是“ [GitHub`:enterprise`](https://enterprise.github.com/) ”，这也意味着，正如文章“[从 GitHub:FI 迁移](https://support.enterprise.github.com/entries/21179373-migrating-from-github-fi)”中所解释的那样：**不允许自定义挂钩**。
（另请参阅“[如何将自定义 git 挂钩添加到 GitHub Enterprise 存储库？](https://stackoverflow.com/questions/11385076/how-can-i-add-a-custom-git-hook-to-a-github-enterprise-repo) ”）

所以我会以不同的方式处理这个问题，并且不在该服务器上维护一个存储库，而是两个存储库（第二个是第一个的克隆）。

每个人都可以推送到第一个，但只有选定的用户可以推送到第二个，这允许他/她从第一个 repo 中选择有资格推送到第二个的内容。
所以`repo2`''在某种程度上代表你的' `master`'，而' `repo1`'代表所有其他用户可以推送到的任何其他分支。
这有点类似于[GitHub gist 文章](https://gist.github.com/3159952)。

> **我建议将发布工程团队分成他们自己的组织**。
> 开发人员将不得不分叉驻留在发布工程团队中的所有存储库。
> 开发人员将能够`master`在他们的组织内承诺。
> 他们必须发送拉取请求才能将他们的提交提交到`release_engineering`组织中。
> 
> 注意：需要一些时间才能让客户相信提交到 的`master`分支与提交到 的分支`acme_developers/foobar`是不同`master`的`acme_release_engineering/fooba`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:22:08.477

简单的解决方案可能是在 gitolite 或其他支持分支锁定的系统上克隆和托管存储库，并设置一个提交后挂钩以镜像到您当前的 github 存储库（如果您打算保留它）。我们目前正在使用 github 克隆来做到这一点。

# android - 安卓。notifyDataSetChanged() 方法和 ListViews 是如何工作的？

> ID：12229817
> 
> 赞同：63
> 
> 时间：2012-09-01T17:21:17.820
> 
> 标签：android, android-listview, android-adapterview

我正在尝试理解这个`ListView`概念以及它是如何工作的，并且我正在尝试创建自己的扩展`BaseAdapter`. 例如`ArrayAdapter`，`notifyDataSetChanged()`在更新包含所有数据的数组列表后应该调用该方法，以刷新`ListView`.

但我正在创建自己的`BaseAdapter`. 我无法使用该方法，或者是吗？我如何实现这个方法？基本上，那个方法到底是做什么的，也许我会明白。

如果`ArrayAdapter`我猜它会查看`ListView`当前显示的位置，并检查它是否与更新后的位置相同`ArrayList`？或者...

它说该方法：

> 通知附加的观察者底层数据已更改，任何反映数据集的视图都应自行刷新。

但它究竟是如何刷新自己的呢？

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2012-09-02T08:34:10.317

**我想通了**。我无法理解适配器到底是如何启动的，以及它是如何知道从哪里获取数据的。当我扩展`BaseAdapter`类时，在该类的构造函数中，我初始化了我想在`ListView`. 但我无法弄清楚这些值将如何使用以及何时使用。

**所以这就是事情！：**

其中`BaseAdapter`有一些方法需要被覆盖。其中，有`getCount()`。

当`ListView`创建和诸如此类时，它会调用`getCount()`. 如果它返回一个不同于 0 的值（我返回了我之前在构造函数中初始化的 ArrayList 的大小），那么它会调用`getView()`足够的时间来用项目填充屏幕。**例如**，我初始化了`ArrayList`20 个项目。因为最初只有 8 个项目适合屏幕，所以`getView()`被调用了 8 次，每次都要求我返回所需的位置（更准确地说，它想知道该行在该特定位置的列表中的样子，哪些数据它需要包含）。如果我向下滚动列表，`getView()`会被一遍又一遍地调用，直到我到达列表的末尾，在我的情况下是 20 个项目/行。

什么`notifyDataSetChanged()`是......当被调用时，它会查看调用时屏幕上显示的项目（更准确地说是哪些行索引）并`getView()`使用这些位置进行调用。

**即**，如果您正在显示列表中的前 8 个项目（因此那些是屏幕上可见的项目）并且您在列表的第 2 和第 3 个项目之间添加另一个项目，然后您调用`notifyDataSetChanged()`then`getView()`被调用 8 次，位置开始从 0 到 7 结束，并且因为在`getView()`方法中您从 获取数据，`ArrayList`它会自动返回插入到列表中的新项目以及前 8 个中的 7 个（7 而不是 8，因为最后一个项目去了一个位置向下，因此不再可见），并且`ListView`将使用这些项目重绘或其他任何内容。

此外，需要说明的是，如果您已`getView()`正确实施，您最终将回收已显示的项目（对象）（而不是创建新项目）。在 12:00 左右观看***[此视频以了解正确的实施方式](https://www.youtube.com/watch?v=wDBM6wVEO70)***`getView()`

`LogCat`通过在每个方法中调用并跟踪正在发生的事情，我已经弄清楚了这一切。

希望这对刚刚开始了解`ListView`s 工作原理的人有所帮助。

PS***[这个例子](http://developerlife.com/tutorials/?p=327)***对我理解也有很大帮助。

**更新**

现在`ListViews`已经不再使用了。Android 推出了`RecyclerView`which 会为您回收视图，但了解 a 的基础知识`ListView`有助于理解`RecyclerView`.

这是一个参考链接：[https ://developer.android.com/guide/topics/ui/layout/recyclerview](https://developer.android.com/guide/topics/ui/layout/recyclerview)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-01T17:52:49.953

`BaseAdapter`可以被其他类“观察”。当您调用它的方法时，`ListView` `setAdapter()`它是适配器的调用`registerDataSetObserver`。因此，适配器知道谁对新数据感兴趣。

您可以查看`BaseAdapter` [此处](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.1_r2/android/widget/BaseAdapter.java#BaseAdapter.notifyDataSetChanged%28%29)的来源。它很小。

`notifyDataSetChanged` **可供您使用，并且您基本上不应该覆盖它（因为它没有做任何特别的事情，所以您可以在自己的课程中重用它）**。****

 *** * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-01T17:33:10.053

假设您`ListView`显示一些存储在`ArrayList`.

更改 的内容后`ArrayList`，您需要告诉列表数据源已更改，并且需要重新绘制自身以显示新数据。

所以，这就是**`notifyDatasetChanged()`**进来的地方。它告诉`ListView`数据已被修改；为了显示新数据，`ListView`必须重新绘制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-08T09:28:05.770

当您`BaseAdapter`为自己的子类进行扩展时，您也将获得`notifyDataSetChanged()`方法。**

# java - Java Regex 重复（骰子符号解析）

> ID：12229822
> 
> 赞同：3
> 
> 时间：2012-09-01T17:22:07.057
> 
> 标签：java, regex

我正在使用正则表达式来解析某种语法的字符串。

```
Pattern.compile("(\\d+)(d)(\\d+)(([\\+\\-\\*\\/])(\\d+))*"); // The regexp pattern 
```

我希望它匹配以下字符串：

```
2d6
4d4+1
2d12*2-1 
```

问题是，它还匹配以 x-*/ 结尾的字符串，例如：

```
3d4- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:24:27.380

使用这个正则表达式`(\d+)(d)(\d+)(([-+*/])(\d+))`

但是 2d12x2-1 不匹配，x 在你的正则表达式中不存在，你什么也不说，因为包括`x`将正则表达式更改为`(\d+)(d)([\dx]+)(([\+\-\*\/])(\d+))`

编辑：

可能你需要锚？设置`^`并`$`在您的正则表达式中

```
Pattern.compile("^(\\d+)(d)(\\d+)(([-+*/])(\\d+))*$"); 
```

# c# - ASP.NET MVC 中以编程方式“hello world”默认服务器端打印机

> ID：12229823
> 
> 赞同：7
> 
> 时间：2012-09-01T17:22:14.107
> 
> 标签：c#, .net, asp.net-mvc, printing, network-printers

我已安装打印机并在 Intranet 服务器上工作，我想以编程方式将“hello world”发送到该默认打印机。这似乎是最简单的事情，但我已经搜索了几个小时没有成功。（注意：我正在运行 Windows 7 的部署机器上开发 asp.net mvc）

我试图将[此处](https://stackoverflow.com/questions/371384/best-way-to-print-from-c-sharp-net)的 VB 示例翻译成 C#，但它说“没有安装打印机”。

```
public void TestPrint()
{
    var x = new PrintDocument();
    x.PrintPage += new PrintPageEventHandler(PrintPage);
    x.Print();
}
private void PrintPage(Object sender, PrintPageEventArgs e)
{
    var textToPrint = "Hello world";
    var printFont = new Font("Courier New", 12);
    var leftMargin = e.MarginBounds.Left;
    var topMargin = e.MarginBounds.Top;
    e.Graphics.DrawString(textToPrint, printFont, Brushes.Black, leftMargin, topMargin);
} 
```

[我还在这里](http://msdn.microsoft.com/en-us/library/ms552912%28v=vs.100%29.aspx#1)尝试了 MSDN 的一个片段，但它说它无法识别打印机名称。

```
public void TestPrint(string msg)
{
    var server = new LocalPrintServer();
    var queue = LocalPrintServer.GetDefaultPrintQueue();

    // Call AddJob
    var job = queue.AddJob();

    // Write a Byte buffer to the JobStream and close the stream
    var stream = job.JobStream;
    var buffer = UnicodeEncoding.Unicode.GetBytes(msg);
    stream.Write(buffer, 0, buffer.Length);
    stream.Close();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T21:07:40.443

在 .NET 中打印“hello world”服务器端

1.  **共享打印机**
2.  创建一个`PrintDocument`对象
3.  按名称引用打印机
4.  添加提供内容的方法
5.  打印

**代码**

```
using System.Drawing;
using System.Drawing.Printing;

public void Print()
{
  var doc = new PrintDocument();
  doc.PrinterSettings.PrinterName = "\\\\deployment-machine-name\\share-name";
  doc.PrintPage += new PrintPageEventHandler(ProvideContent);
  doc.Print();
}
public void ProvideContent(object sender, PrintPageEventArgs e)
{
  e.Graphics.DrawString(
    "Hello world",
    new Font("Arial", 12),
    Brushes.Black,
    e.MarginBounds.Left,
    e.MarginBounds.Top);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:29:54.863

首先给出选择打印机的选项。您的全部要求已在 Microsoft 支持站点上进行了说明。

[看看这里。](http://support.microsoft.com/kb/322091)

来自那里的样本（以防有一天页面死了）： -

```
private void print_Click(object sender, System.EventArgs e)
{
    string s = "Hello"; // device-dependent string, need a FormFeed?

    // Allow the user to select a printer.
    PrintDialog pd  = new PrintDialog();
    pd.PrinterSettings = new PrinterSettings();
    if( DialogResult.OK == pd.ShowDialog(this) )
    {
        // Send a printer-specific to the printer.
        RawPrinterHelper.SendStringToPrinter(pd.PrinterSettings.PrinterName, s);
    }
} 
```

# c# - 使用 pdf 库在 c#、java、python、c/c++ 和 android 中制作 pdf 查看器

> ID：12229826
> 
> 赞同：-1
> 
> 时间：2012-09-01T17:22:26.263
> 
> 标签：c#

我想做简单的 pdf 查看器，我知道 C#、java、python、c/c++ 和 android，但我更喜欢 C#，dotNetframeWork 或免费 dll 中是否有任何 pdf 库。你们能建议我使用上述语言的 pdf 库吗？这项工作的最佳语言是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:28:31.187

使用 pdflib，这是我在生成 PDF 时使用的。

欲了解更多信息，请[点击此处](http://pdflib.com/)

# qt - QFileDialog 禁用按钮

> ID：12229830
> 
> 赞同：2
> 
> 时间：2012-09-01T17:23:45.407
> 
> 标签：qt, qt4, qfiledialog

我想创建一个 QFileDialog 的子类，它将用于仅打开具有某些特定内容的目录。我可以设置我自己的代理模型来处理文件列表的行为，但是如何禁用/启用确定按钮？我必须创建自己的小部件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:26:37.147

您应该能够通过安装[代理模型](http://qt-project.org/doc/qt-4.8/qfiledialog.html#setProxyModel)来根据您的条件过滤文件和目录来做到这一点。

编辑：

这仅适用于通过隐藏不需要的文件来处理文件。但是您不能隐藏目录，因为您需要允许导航到它们。

对于选择目录，您必须构建自己的对话框。是的，我认为这是 Qt 的缺陷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-05T22:41:05.587

我能够执行以下操作来获得“保存”按钮：

```
QDialogButtonBox *button_box = findChild<QDialogButtonBox *>();
QPushButton *save_button;

if (button_box) {
    save_button = button_box->button(QDialogButtonBox::Save); // depends on acceptMode()
} 
```

# django - 如何将对象传递给表单并在 Django 中提交

> ID：12229832
> 
> 赞同：2
> 
> 时间：2012-09-01T17:23:53.247
> 
> 标签：django, object, django-forms

我有一个允许从 CSV 文件导入的应用程序。CSV 文件中包含一个库列表。我需要先将它们解析成一个库实例列表，在另一个页面上显示它们，用户单击“确认”后，这些库被保存。

这是我的表格：

```
class LibCsvForm(forms.Form):
    lib_csv  = forms.FileField(label='CSV file')

class LibListForm(forms.Form):
    def __init__(self, *args, **kwargs):
        new_libs = kwargs.pop('new_libs')
        super(LibListForm, self).__init__(*args, **kwargs)
        self.fields['new_libs'] = new_libs 
```

还有我的看法：

```
def import_lib_csv(request):
    if request.method == 'POST':
        form = LibCsvForm(request.POST, request.FILES)
        if form.is_valid():
            raw = request.FILES['lib_csv'].read()
            new_libs = []
            # Process string 'raw' and add instances of Library to new_libs
            context = RequestContext(request, {'form': LibListForm(new_libs=new_libs)})
            context.update(csrf(request))
            return render_to_response('master/library.csv.confirm.html', context)
    else:
        form = LibCsvForm()
    variables = RequestContext(request, { 'form': form })
    return render_to_response('master/library.csv.html', variables) 
```

LibCsvForm 仅供用户上传文件。方法“import_lib_csv”是读取文件，创建实例，并将它们传递给另一个表单 LibListForm，它只包含“new_libs”。用户单击“确认”后，我想获取此列表并保存对象。

问题是，在模板中：

```
{{ form.new_libs }}
{% for lib in new_libs %}
     {{ lib.id }}
{% endfor %} 
```

它没有显示任何东西。我想我没有正确地将“new_libs”传递到表单中。有人可以帮忙吗？谢谢。

* * *

编辑：

谢谢，罗汉。正如你所说，我修改了它。现在可以在模板中显示库列表。'new_libs' 是库实例的列表。

但是当我单击“确认”时，它会报告错误。这是我的保存方法：

```
def save_lib_list(request):
    if request.POST:
        form = LibListForm(request.POST)
        print form.cleaned_data['new_libs']
    variables = RequestContext(request, {
        'lib_list': Library.objects.all()
    })
    return render_to_response('master/library.list.html', variables) 
```

姜戈 说

```
"Exception Type:    KeyError
Exception Value:    'new_libs' " 
```

我的模板是：

```
<form method="post" action="/library/savelist/" class="well">
    {% csrf_token %}
    <legend>Libraries to import</legend>
    {% for lib in new_libs %}
        {{ lib.id }}
    {% endfor %}
</form> 
```

我想我在这里错过了一些东西，但不知道如何解决......

* * *

解决了：

首先将上传的 CSV 文件的内容保存在服务器上。将此文件的路径设置为 LibListForm 中的隐藏字段：

```
tmp_lib_file = forms.CharField(widget=forms.HiddenInput(), initial='tmp.lib') 
```

然后当用户单击“确认”时，再次解析文件并获取库实例，保存它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:33:33.847

如果你想在模板中使用它，你应该`new_libs`在模板上下文中添加它。

```
context = RequestContext(request, {'form': LibListForm(new_libs=new_libs), 'new_libs': new_libs}) 
```

另外，`new_libs`您传递给的类型是什么`LibListForm`？如果它不是正确的字段类型，则不会正确显示/处理。

问题编辑后更新：

*   该错误表明`new_fields`. `form.cleaned_data`表单应该有一个具有该名称的字段。`new_field`似乎不是表单域。
*   你的模板也没有表单域？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:38:33.320

完全不清楚`new_libs`应该是什么，但它似乎根本不是一个表单域。

毫不奇怪，表单只会显示表单字段。我不太确定您为什么要将这些对象放在表单上：听起来您真的只想在模板上列出它们，并添加一个“确认”按钮。不需要表单类：只需将它们作为它们实际是的任何对象传递给模板，遍历它们，并将确认按钮放在基本的 HTML 表单中。

# android - 带有图像的 WebView - 调整默认缩放级别

> ID：12229839
> 
> 赞同：0
> 
> 时间：2012-09-01T17:24:35.337
> 
> 标签：android, webview, android-imageview, android-image

我对 WebView 的默认缩放有疑问。当我加载 URL 时，我的图像未调整为屏幕（它太小并且位于右上角）。

我想像在 ImageView 中一样进行初始缩放。

这是我的实际代码：

```
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    WebView webView=new WebView(this);
    webView.getSettings().setUseWideViewPort(true);
    webView.getSettings().setLoadWithOverviewMode(true);
    webView.loadUrl(URL);
    LayoutParams params = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
    addContentView(webView, params);       
} 
```

我得到了这个效果：

![截屏](../Images/2acf22a04832d9db06e734b5c7c8aa09.png)

我想让它看起来像这样（我使用 ImageView 得到它）：

![截屏](../Images/489ee00a8a577c077ad40332dfa627c4.png)

如何使用 WebView 获得这种效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:31:15.943

我会检查两件事：

1.  首先你的 html 可能只是`<img src="...">`，对吧？您可能必须对图像进行样式设置以适应屏幕的宽度。（[见此](http://unstoppablerobotninja.com/entry/fluid-images)）除了使用图像标签，您还可以设置 html 的背景以使用该图像（[见此](http://css-tricks.com/perfect-full-page-background-image/)）
2.  可能发生的另一件事是您的 WebView 没有填满屏幕……但这似乎不太可能。

# python - Python 有内联语句吗？

> ID：12229842
> 
> 赞同：0
> 
> 时间：2012-09-01T17:25:05.423
> 
> 标签：python, inline

python有类似`inline`C的东西吗？

如果没有，我怎样才能加快函数的执行速度？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T17:26:41.300

不，python没有这样的说法。

但是，如果函数调用的开销对您来说是个问题，那么使用像 Python 这样的脚本语言是错误的选择。考虑将相关部分移动到 C 扩展中。如果这是您的选择，请查看[Cython](http://www.cython.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:26:33.773

不，它没有。然而，有几种加速 Python 执行的机制，例如，您可以从 Python 程序调用本机 C 代码，例如使用[Boost.Python](http://www.boost.org/doc/libs/1_49_0/libs/python/doc/)：

> Boost Python 库是一个用于连接 Python 和 C++ 的框架。它允许您快速、无缝地将 C++ 类函数和对象公开给 Python，反之亦然，无需使用特殊工具 - 只需您的 C++ 编译器。它旨在以非侵入方式包装 C++ 接口，因此您根本不必更改 C++ 代码来包装它，这使得 Boost.Python 成为向 Python 公开第 3 方库的理想选择。该库对高级元编程技术的使用为用户简化了其语法，因此包装代码呈现出一种声明性接口定义语言 (IDL) 的外观。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:30:33.793

您可以从 scipy 下载一个名为[Weave](http://www.scipy.org/Weave/)的库，它允许您将 c 或 c++ 代码内联到您的 python 代码中。那会加快速度。

然而，python 本身并没有内联函数。

还有其他旨在加速计算的库，如 scipy、numpy，我认为 matplotlib 是一个非常好的库。还有用于并行计算的 iPython。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T17:27:51.420

我不知道 Python 中有一个等效的内联功能。

假设您已经用尽惯用语言功能（例如列表理解等），您可以做的最好的事情是加速一个函数来检查算法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T17:37:45.167

Python 将为您优化代码，但您对它的执行方式没有任何影响。为了加快任何 python 代码的*加载*时间，您可以在执行之前将其编译为字节码。

# mysql - 使用时间戳索引优化查询

> ID：12229843
> 
> 赞同：1
> 
> 时间：2012-09-01T17:25:06.523
> 
> 标签：mysql, sql, optimization

在 MySql 中，有一个大表，与表a和 a`historical_price`有 2 个`n:1`关系：`instrument``timestamp``price`

```
CREATE TABLE `historical_price` 
(  
    `price_nbr` int(11) NOT NULL AUTO_INCREMENT,  
    `insid` int(11)  NOT NULL,  
    `curr_insid` int(11) NOT NULL,  
    `timestamp_` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  
    `price` float DEFAULT NULL,  
    PRIMARY KEY (`price_nbr`),  
    KEY `insid` (`insid`),  
    KEY `curr_insid` (`curr_insid`),  
    KEY `timestamp_` (`timestamp_`),  
    CONSTRAINT ...
) ENGINE=InnoDB 
```

我想运行很多这样的查询：

```
SELECT price 
FROM historical_price 
WHERE insid=566 AND curr_insid=2 AND timestamp_ > '2012-05-01'
LIMIT 0,1 
```

获取与条件`instrument`匹配的旧记录。`timestamp` `greater than`

`explain`输出是：

```
id | select_type |      table       | type | possible_keys                | key   | key_len | ref   | rows   | Extra 
 1 |   SIMPLE    | historical_price | ref  | insid,curr_insid,timestamp_  | insid |   4     | const | 987190 | Using where 
```

在添加新的多列索引或用于帮助 db 引擎的新列之前，我想询问您对哪个选项可以带来最佳结果的意见（如果有的话）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:26:59.377

您应该添加一个多键，包括`insid,curr_insid,timestamp_`

# css - Amazon S3 CORS（跨域资源共享）和 Firefox 跨域字体加载

> ID：12229844
> 
> 赞同：139
> 
> 时间：2012-09-01T17:25:25.040
> 
> 标签：css, firefox, amazon-s3, font-face, cors

Firefox 无法从与当前网页不同的来源加载字体是一个长期存在的问题。通常，当字体在 CDN 上提供时会出现问题。

在其他问题中提出了各种解决方案：

[CSS @font-face 不适用于 Firefox，但适用于 Chrome 和 IE](https://stackoverflow.com/questions/2856502/css-font-face-not-working-with-firefox-but-working-with-chrome-and-ie)

随着 Amazon S3 CORS 的引入，是否有使用 CORS 来解决 Firefox 中的字体加载问题的解决方案？

编辑：很高兴看到 S3 CORS 配置的示例。

编辑2：我找到了一个可行的解决方案，但并没有真正理解它的作用。如果有人可以提供有关配置的更详细解释以及亚马逊对配置的解释中发生的背景魔法，我们将不胜感激，就像 nzifnab 为它提供赏金一样。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-09-08T12:45:57.507

2014 年 9 月 10 日更新：

由于 Cloudfront 现在正确支持 CORS，因此您不再需要执行以下任何查询字符串破解。有关更多信息，请参阅[http://aws.amazon.com/blogs/aws/enhanced-cloudfront-customization/](http://aws.amazon.com/blogs/aws/enhanced-cloudfront-customization/)和此答案：[https ://stackoverflow.com/a/25305915/308315](https://stackoverflow.com/a/25305915/308315)

* * *

好的，我终于使用下面的配置使字体工作了，并从文档中的示例中进行了一些调整。

我的字体托管在 S3 上，但前端是 cloudfront。

我不确定它为什么起作用，我的猜测可能是`<AllowedMethod>` `GET`and`<AllowedHeader>` `Content-*`是必需的。

如果任何精通 Amazon S3 CORS 配置的人都可以对此有所了解，我们将不胜感激。

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <CORSRule>
        <AllowedOrigin>https://mydomain.com</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
        <AllowedHeader>Content-*</AllowedHeader>
        <AllowedHeader>Host</AllowedHeader>
    </CORSRule>
    <CORSRule>
        <AllowedOrigin>https://*.mydomain.com</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
        <AllowedHeader>Content-*</AllowedHeader>
        <AllowedHeader>Host</AllowedHeader>
    </CORSRule>
</CORSConfiguration> 
```

编辑：

一些开发人员面临 Cloudfront 缓存`Access-Control-Allow-Origin`标头的问题。[AWS 工作人员已在下面的链接 ( https://forums.aws.amazon.com/thread.jspa?threadID=114646](https://forums.aws.amazon.com/thread.jspa?threadID=114646) ) 中解决了此问题，@Jeff-Atwood 对此进行了评论。

从链接的线程中，作为一种解决方法，建议使用**查询字符串**来区分来自不同域的调用。我将在此处重现缩短的示例。

用于`curl`检查响应标头：

域 A：a.domain.com

```
curl -i -H "Origin: https://a.domain.com" http://hashhashhash.cloudfront.net/font.woff?https_a.domain.com 
```

来自域 A 的响应标头：

```
Access-Control-Allow-Origin: https://a.domain.com
Access-Control-Allow-Methods: GET
Access-Control-Max-Age: 3000
Access-Control-Allow-Credentials: true
X-Cache: Miss from Cloudfront 
```

域 B：b.domain.com

```
curl -i -H "Origin: http://b.domain.com" http://hashhashhash.cloudfront.net/font.woff?http_b.domain.com 
```

来自域 B 的响应标头：

```
Access-Control-Allow-Origin: http://b.domain.com
Access-Control-Allow-Methods: GET
Access-Control-Max-Age: 3000
Access-Control-Allow-Credentials: true
X-Cache: Miss from Cloudfront 
```

您会注意到`Access-Control-Allow-Origin`返回了不同的值，这些值通过了 Cloudfront 缓存。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2014-08-14T10:32:22.253

经过一些调整后，我似乎已经让它在没有查询字符串破解的情况下工作。更多信息在这里：[http ://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/RequestAndResponseBehaviorS3Origin.html#RequestS3-cors](http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/RequestAndResponseBehaviorS3Origin.html#RequestS3-cors)

我将完成整个设置，以便轻松查看我所做的工作，希望这对其他人有所帮助。

背景信息：我正在使用具有asset_sync gem 的Rails 应用程序将资产放到S3 上。这包括字体。

在 S3 控制台中，我在此处单击了我的存储桶、属性和“编辑 cors 配置”：![CORS 配置按钮](../Images/f5bb04c60b88b11304da588f632ace8a.png)

在 textarea 里面我有类似的东西：

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <CORSRule>
        <AllowedOrigin>https://*.example.com</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
        <AllowedHeader>*</AllowedHeader>
    </CORSRule>
</CORSConfiguration> 
```

然后在 Cloudfront 面板 ( [https://console.aws.amazon.com/cloudfront/home](https://console.aws.amazon.com/cloudfront/home) ) 中，我创建了一个分配，添加了一个指向我的 S3 存储桶的 Origin ![添加原点](../Images/ee329b11585b47da6c5586b09b532b0a.png)

然后为默认路径添加了一个行为，以指向我设置的基于 S3 的原点。我还做的是单击白名单标题并添加`Origin`： ![添加行为和白名单标头](../Images/5d076bf921385255cbb5bd1e2c60e65d.png)

现在发生的情况如下，我认为这是正确的：

1) 检查 S3 标头是否设置正确

```
curl -i -H "Origin: https://example.com" https://s3.amazonaws.com/xxxxxxxxx/assets/fonts/my-cool-font.ttf
HTTP/1.1 200 OK
x-amz-id-2: Ay63Qb5uR98ag47SRJ91+YALtc4onRu1JUJgMTU98Es/pzQ3ckmuWhzzbTgDTCt+
x-amz-request-id: F1FFE275C0FBE500
Date: Thu, 14 Aug 2014 09:39:40 GMT
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Max-Age: 3000
Access-Control-Allow-Credentials: true
Vary: Origin, Access-Control-Request-Headers, Access-Control-Request-Method
Cache-Control: public, must-revalidate, proxy-revalidate, max-age=180
Last-Modified: Mon, 09 Dec 2013 14:29:04 GMT
ETag: "98918ee7f339c7534c34b9f5a448c3e2"
Accept-Ranges: bytes
Content-Type: application/x-font-ttf
Content-Length: 12156
Server: AmazonS3 
```

2) 检查 Cloudfront 是否与标头一起使用

```
curl -i -H "Origin: https://example.com" https://xxxxx.cloudfront.net/assets/fonts/my-cool-font.ttf
HTTP/1.1 200 OK
Content-Type: application/x-font-ttf
Content-Length: 12156
Connection: keep-alive
Date: Thu, 14 Aug 2014 09:35:26 GMT
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Max-Age: 3000
Access-Control-Allow-Credentials: true
Cache-Control: public, must-revalidate, proxy-revalidate, max-age=180
Last-Modified: Mon, 09 Dec 2013 14:29:04 GMT
ETag: "98918ee7f339c7534c34b9f5a448c3e2"
Accept-Ranges: bytes
Server: AmazonS3
Vary: Origin
X-Cache: Miss from cloudfront
Via: 1.1 77bdacfea247b6cbe84dffa61da5a554.cloudfront.net (CloudFront)
X-Amz-Cf-Id: cmCxaUcFf3bT48zpPw0Q-vDDza0nZoWm9-_3qY5pJBhj64iTpkgMlg== 
```

（请注意，上面是来自云端的缺失，因为这些文件被缓存了 180 秒，但同样适用于命中）

3）使用不同的来源（但在 S3 存储桶的 CORS 上允许的来源）命中云端 -`Access-Control-Allow-Origin`未缓存！耶！

```
curl -i -H "Origin: https://www2.example.com" https://xxxxx.cloudfront.net/assets/fonts/my-cool-font.ttf
HTTP/1.1 200 OK
Content-Type: application/x-font-ttf
Content-Length: 12156
Connection: keep-alive
Date: Thu, 14 Aug 2014 10:02:33 GMT
Access-Control-Allow-Origin: https://www2.example.com
Access-Control-Allow-Methods: GET
Access-Control-Max-Age: 3000
Access-Control-Allow-Credentials: true
Cache-Control: public, must-revalidate, proxy-revalidate, max-age=180
Last-Modified: Mon, 09 Dec 2013 14:29:04 GMT
ETag: "98918ee7f339c7534c34b9f5a448c3e2"
Accept-Ranges: bytes
Server: AmazonS3
Vary: Origin
X-Cache: Miss from cloudfront
Via: 1.1 ba7014bad8e9bf2ed075d09443dcc4f1.cloudfront.net (CloudFront)
X-Amz-Cf-Id: vy-UccJ094cjdbdT0tcKuil22XYwWdIECdBZ_5hqoTjr0tNH80NQPg== 
```

请注意，在没有查询字符串破解的情况下，域已成功更改。

当我更改 Origin 标头时，第一个请求似乎总是有一个`X-Cache: Miss from cloudfront`，然后我得到预期的`X-Cache: Hit from cloudfront`

PS 值得注意的是，当执行 curl -I（大写 I）时，不会显示 Access-Control-Allow-Origin 标头，因为它只是一个 HEAD，我执行 -i 以使其成为 GET 并向上滚动。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-09-14T10:43:50.157

在最后一次推送到 Heroku 之前，我的字体一直正确提供……我不知道为什么，但是 CORS 中的通配符允许原点停止工作。我将我**所有的 prepro 和 pro**域添加到存储桶设置中的 CORS 策略，所以现在它看起来像这样：

```
<CORSConfiguration>
    <CORSRule>
        <AllowedOrigin>http://prepro.examle.com</AllowedOrigin>
        <AllowedOrigin>https://prepro.examle.com</AllowedOrigin>
        <AllowedOrigin>http://examle.com</AllowedOrigin>
        <AllowedOrigin>https://examle.com</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
        <AllowedHeader>Authorization</AllowedHeader>
    </CORSRule>

</CORSConfiguration> 
```

`http://localhost:PORT`更新：也添加你的

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-24T18:51:40.170

好吧，文档指出您可以将配置作为“存储桶中的 cors 子资源”。我认为这意味着我将使用配置在我的存储桶的根目录创建一个名为“cors”的文件，但这不起作用。最后，我必须登录到 Amazon S3 管理区域并在`properties`我的存储桶对话框中添加配置。

S3 可以使用一些更好的文档...

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-03-01T12:56:27.800

在 Amazon S3 **CORS 配置**（S3 存储桶/权限/CORS）中，如果您使用它：

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
<CORSRule>
    <AllowedOrigin>*</AllowedOrigin>
    <AllowedMethod>GET</AllowedMethod>
    <MaxAgeSeconds>3000</MaxAgeSeconds>
    <AllowedHeader>*</AllowedHeader>
</CORSRule> 
```

CORS 适用于 Javascript 和 CSS 文件，但**不适用于字体文件**。

您必须使用@VKen 答案中表达的模式指定域以允许 CORS：[https ://stackoverflow.com/a/25305915/618464](https://stackoverflow.com/a/25305915/618464)

**所以，使用这个**：

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
<CORSRule>
    <AllowedOrigin>*</AllowedOrigin>
    <AllowedMethod>GET</AllowedMethod>
    <MaxAgeSeconds>3000</MaxAgeSeconds>
    <AllowedHeader>*</AllowedHeader>
</CORSRule>
<CORSRule>
    <AllowedOrigin>https://*.mydomain.com</AllowedOrigin>
    <AllowedMethod>GET</AllowedMethod>
    <MaxAgeSeconds>3000</MaxAgeSeconds>
    <AllowedHeader>*</AllowedHeader>
</CORSRule>
</CORSConfiguration> 
```

请记住为您的域替换“mydomain.com”。

在此之后，**使 CloudFront 缓存无效**（CloudFront / Invalidations / Create Invalidation），它将起作用。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-05-21T03:48:00.860

就我而言，我没有在 CORS 配置中定义 XML 命名空间和版本。定义那些工作。

改变了

```
<CORSConfiguration> 
```

到

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/"> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-03-02T14:12:57.857

有更好更简单的方法！

我个人更喜欢使用我的 DNS 子域来解决这个问题。如果我的 CDN 在 cdn.myawesomeapp.com 而不是 sdf73n7ssa.cloudfront.net 之后，那么浏览器就不会因为跨域安全问题而崩溃并阻止它们。

要将您的子域指向您的 AWS Cloudfront 域，请转到 AWS Cloudfront 控制面板，选择您的 Cloudfront 分配并将您的 CDN 子域输入到备用域名 (CNAME) 字段中。像 cdn.myawesomeapp.com 这样的东西就可以了。

现在您可以转到您的 DNS 提供商（如 AWS Route 53）并为 cdn.myawesomeapp.com 创建一个指向 sdf73n7ssa.cloudfront.net 的 CNAME。

[http://blog.cloud66.com/cross-origin-resource-sharing-cors-blocked-for-cloudfront-in-rails/](http://blog.cloud66.com/cross-origin-resource-sharing-cors-blocked-for-cloudfront-in-rails/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-08-02T15:36:12.090

这个配置对我有用。我可以列出对象、检索、更新和删除。

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
  <CORSRule>
    <AllowedOrigin>http://localhost:3000</AllowedOrigin>
    <AllowedMethod>HEAD</AllowedMethod>
    <AllowedMethod>GET</AllowedMethod>
    <AllowedMethod>PUT</AllowedMethod>
    <AllowedMethod>POST</AllowedMethod>
    <AllowedMethod>DELETE</AllowedMethod>
    <AllowedHeader>*</AllowedHeader>
    <ExposeHeader>ETag</ExposeHeader>
    <ExposeHeader>x-amz-meta-custom-header</ExposeHeader>
  </CORSRule>
</CORSConfiguration> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-05-19T20:33:29.563

2021 解决方案，通过允许`"*"`进入而不会危及安全`AllowedDomains`。

## 步骤 1) 允许 S3 接收 CORS

在**S3 存储桶**> 权限 > 跨域资源共享 (CORS) 中，将您的域列表添加到`AllowedOrigins`. 有关示例，请参见[官方文档](https://docs.aws.amazon.com/AmazonS3/latest/userguide/ManageCorsUsing.html#cors-example-1)。你只`GET`需要`AllowedMethods`.

## 步骤 2) 告诉 CloudFront 通过 CORS 标头发送

在您的 CloudFront Behavior < Origin Request Policy 中，确保您选择了发送`origin`和`access-control-request-headers`标头的策略，例如`Managed-CORS-S3Origin`.

[![在此处输入图像描述](../Images/cf8350d7def677e9826c33a401d5fc38.png)](https://i.stack.imgur.com/HD9F8.png)

## 步骤 3) [可选，仅当您拥有多个域时]

请参阅[我的这个答案，](https://stackoverflow.com/a/67610609)了解如何在 CORS 中为 S3+CloudFront 处理多个域。

## 步骤 4) 使您的 CloudFront 分配无效

祝你好运！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-03-08T15:56:17.953

```
<ifModule mod_headers.c>

   Header set Access-Control-Allow-Origin: http://domainurl.com

</ifModule> 
```

简单的解决方案

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-10-02T10:03:49.397

这与字体无关，而是与图像有关，这可能是一种边缘情况，但就像发生在我身上一样，它可能会发生在另一个人身上。我将把它留在这里，希望它能帮助某人：

如果您处于“我已经完成了他们告诉的所有操作，但仍然无法正常工作”的情况，这可能是 Chrome 和 Safari 中与缓存相关的问题。假设您的服务器具有正确的 CORS 配置集：

```
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <CORSRule>
        <AllowedOrigin>*</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
    </CORSRule>
</CORSConfiguration> 
```

在 Firefox 中一切正常，但在 Chrome 和 Safari 中却不行。如果您要从简单标记和 js Image 元素 src访问远程图像路径**，**`<img src="http://my.remote.server.com/images/cat.png">`如下所示：

```
var myImg = new Image()
myImg.crossOrigin = 'Anonymous'
myImg.onload = () => {
  // do stuff (maybe draw the downloaded img on a canvas)
}
myImg.src = 'http://my.remote.server.com/images/cat.png' 
```

您可能会`No 'Access-Control-Allow-Origin'`在 Chrome 和 Safari 中收到错误消息。发生这种情况是因为第一个`<img>`以某种方式弄乱了浏览器缓存，并且当您稍后尝试访问相同的图像时（在代码内的 Image 元素上），它只是中断了。为避免这种情况，您可以在一个 .src 路径中添加一个虚构的 GET 参数，以强制浏览器重新请求图像并避免使用缓存，如下所示：

```
<img src="http://my.remote.server.com/images/cat.png?nocache=true"></img> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-10T11:29:46.280

重新启动我的 Spring Boot 应用程序（服务器）为我解决了这个问题。

我在 S3 上正确配置了 CORS。curl 使用原始标头给出了正确的响应。Safari 正在正确获取字体。只有 chrome 不愿意接受 CORS。

不确定究竟是什么导致了这种行为。必须与If-modified-since有关

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-09-02T05:59:03.183

是的当然。Firefox 支持字体的 CORS，就像[http://dev.w3.org/csswg/css3-fonts/#allowing-cross-origin-font-loading中的规范要求一样](http://dev.w3.org/csswg/css3-fonts/#allowing-cross-origin-font-loading)

# jquery - 什么是el/元素？我该如何使用它？为什么？

> ID：12229848
> 
> 赞同：11
> 
> 时间：2012-09-01T17:25:45.810
> 
> 标签：jquery

请原谅我，如果这是一个 n00b-ish 问题，但如果鞋子合脚，我就必须穿上它。我想说的是，请慢慢打字，这样我才能拿起你放下的东西。

我读过这个：

[什么是与 JavaScript/HTML/jQuery 相关的“.el”？](https://stackoverflow.com/questions/10507100/what-is-el-in-relationship-to-javascript-html-jquery)

但这对我没有帮助（以及我目前在学习曲线上的位置）。

我也尝试过谷歌搜索，但似乎并没有出现太多。也许我没有使用正确的关键字？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-01T17:38:02.850

它只是添加到 jquery 中的一个插件，可以帮助您轻松制作 DOM。
然后

```
$.el.table(
 $.el.tr(
   $.el.th('first name'),
   $.el.th('last name')),
 $.el.tr(
   $.el.td('Joe'),
   $.el.td('Stelmach'))
).appendTo(document.body); 
```

相当于

```
$('body').append("<table><tr>
      <th>first name</th><th>last name</th>
    </tr><tr>
      <td>Joe</td><td>Stelmach</td>
    </tr></table>"); 
```

Notice that the [Laconic Plugin](http://joestelmach.github.com/laconic/) is not a native plugin of jquery.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T17:30:27.447

这是 Laconic 插件在添加到 jQuery 时使用的名称。

它用于创建元素。例如，`$.el.div('text')`与`$('<div/>').text('text')`.

# this - 当我 this.value 返回一个值时，本地存储值为 [object object]。

> ID：12229851
> 
> 赞同：0
> 
> 时间：2012-09-01T17:26:13.920
> 
> 标签：this, local-storage

我正在尝试获取键 1 的本地存储值，将其设置为选中的任何复选框的值，但我的 javascript 函数返回的值在本地存储中显示为 [object object]。任何帮助将不胜感激，在此先感谢您。

```
<html>

<head>

<script type="text/javascript">

function topic_1_status(){

var status = {
    get_value: function(){
         return this.value;
                    }

            };

localStorage.setItem(1, status);

}

</script>

</head>

<body>

<div>Topic no.1   </div>
<form action="">
<input type="checkbox" value="learnt" onclick="topic_1_status()" /> Learnt
<input type="checkbox" value="memorised" onclick="topic_1_status()" /> Memorised
<input type="checkbox" value="understood" onclick="topic_1_status()" /> Understood
<input type="checkbox" value="unlearned" onclick="topic_1_status()" /> Unlearned

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:37:25.860

您正在获取“对象对象”，因为您存储的是对象“状态”而不是复选框的值。

这种修改应该会给你你想要的结果。

```
 **On the html where you call your javascript** 
 <input type="checkbox" value="learnt" onclick="topic_1_status(this);" />
 **As you can see above im passing 'this' to the function 
```

和 javascript

```
 //On the javascript
 function topic_1_status(elem){
     if(!elem.checked){//You may also want to check that you are checking it rather than unchecking
        var checkboxValue = elem.value;
        localStorage.setItem(1,checkboxValue);
     }
 } 
```

还想到提到似乎您想使用单选按钮而不是复选框，因为您计划一次只存储一个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:20:58.217

您的代码将值设置为状态。status 是一个复杂的对象。Local Storage 只能存储字符串。通常你会事先序列化成 JSON，但这并不是你真正想要的。我在想你只想做 localStorage.setItem(1, this.value); 请注意，尽管您绑定到 4 个不同的复选框并且始终写入一个值“1”。我不认为你想那样做。

# java - 将 JSON 参数从 java 发布到 sinatra 服务

> ID：12229855
> 
> 赞同：1
> 
> 时间：2012-09-01T17:26:35.727
> 
> 标签：java, android, json, sinatra

我有一个 android 应用程序发布到我的 sinatra 服务。早些时候，我无法读取我的 sinatra 服务的参数。但是，在我将内容类型设置为“x-www-form-urlencoded”之后。我能够看到参数，但不是我想要的。在我的 sinatra 服务中，我得到了一些作为请求参数的东西。

```
{"{\"user\":{\"gender\":\"female\"},\"session_id\":\"7a13fd20-9ad9-45c2-b308-
8f390b4747f8\"}"=> nil, "splat"=>["update_profile.json"], "captures"=>["update_profile.json"]} 
```

这就是我从我的应用程序发出请求的方式。

```
StringEntity se;                    
se = new StringEntity(getJsonObjectfromNameValueList(params.get_params(), "user");
se.setContentType("application/x-www-form-urlencoded");
postRequest.setEntity(se);

private JSONObject getJsonObjectfromNameValueList(ArrayList<NameValuePair> _params, String RootName) {
    JSONObject rootjsonObject = new JSONObject();
    JSONObject jsonObject = new JSONObject();

    if (_params != null) {
        if (!_params.isEmpty()) {
            for (NameValuePair p : _params) {
                try {
                    if (p.getName().equals(ApplicationFacade.SESSION_ID))
                        rootjsonObject.put((String) p.getName(), (String) p.getValue());
                    else
                        jsonObject.put((String) p.getName(), (String) p.getValue());
                } catch (JSONException e) {
                    e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
                }
            }
        }
    }

    try {
        rootjsonObject.put(RootName, jsonObject);

    } catch (JSONException e) {
        e.printStackTrace();
    }
    return rootjsonObject;
} 
```

我尝试使用以下给出的方法：[How to make an nested Json object in Java?](https://stackoverflow.com/questions/9927514/how-to-make-a-nested-json-object-in-java)

这就是我使用链接中提到的方法提出请求的方式。

```
public ArrayList<NameValuePair> getJsonObjectfromNameValueList(ArrayList<NameValuePair> _params, String RootName){
    ArrayList<NameValuePair> arrayList = new ArrayList<NameValuePair>();
    JSONObject jsonObject = new JSONObject();
    if (_params != null) {
        if (!_params.isEmpty()) {
            for (NameValuePair p : _params) {
                try {
                    if (p.getName().equals(ApplicationFacade.SESSION_ID))
                        arrayList.add(new BasicNameValuePair((String) p.getName(), (String) p.getValue()));
                    else
                        jsonObject.put((String) p.getName(), (String) p.getValue());
                } catch (JSONException e) {
                    e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
                }
            }
        }
    }
    arrayList.add(new BasicNameValuePair(RootName, jsonObject.toString()));
    return arrayList;
} 
```

进行上述更改后，我得到的响应是：

```
{"session_id"=>"958c7dee-f12c-49ec-ab0c-932e9a4ed173",
"user"=>"[gender=male]",
 "splat"=>["update_profile.json"],
 "captures"=>["update_profile.json"]} 
```

非常接近，但“性别=男性”是不可取的。我需要将这些参数盲目地传递给另一个服务，所以我需要正确处理它们。

我在我的 sinatra 服务中想要的参数如下。

```
{"session_id" : "958c7dee-f12c-49ec-ab0c-932e9a4ed173",
 "user": 
 {
   "gender" : "male"
 } 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T08:14:17.023

事实证明，问题在于 Sinatra 获取参数的方式。我能够使用 Kyle 对这篇文章的精彩回复来解决我的问题：[Sinatra 控制器参数方法在 JSON 发布请求中为空](https://stackoverflow.com/questions/12131763/sinatra-controller-params-method-coming-in-empty-on-json-post-request)

代码：

```
before do
  if request.request_method == "POST" and request.content_type=="application/json"
    body_parameters = request.body.read
    parsed = body_parameters && body_parameters.length >= 2 ? JSON.parse(body_parameters) : nil
    params.merge!(parsed)
  end
end 
```

**替代方法**：但是，我找到了一个更好的解决方案来处理它，通过添加一个中间件来为我做同样的事情。我用`rack-contrib`宝石。以下是我在代码中所做的更改：

**编辑**：

使用 git 获取与内容类型相关的问题`application/json;charset=UTF-8`已修复的版本

**宝石文件：**

```
gem 'rack-contrib', git: 'git@github.com:rack/rack-contrib', ref: 'b7237381e412852435d87100a37add67b2cfbb63' 
```

**配置.ru**：

```
use Rack::PostBodyContentTypeParser 
```

来源：http: [//jaywiggins.com/2010/03/using-rack-middleware-to-parse-json/](http://jaywiggins.com/2010/03/using-rack-middleware-to-parse-json/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-29T20:49:05.887

使用以下内容对我来说效果更好。我必须添加 request.body.rewind 和 :symbolize_names => true （在调用 JSON.parse 时）

```
before do
  if request.request_method == "POST" and (request.content_type || '').include? "application/json" 
    request.body.rewind
    body_parameters = request.body.read
    parsed = body_parameters && body_parameters.length >= 2 ? JSON.parse(body_parameters, :symbolize_names => true) : nil
    params.merge!(parsed)
  end
end 
```

# javascript - 从子窗口到父窗口的 Javascript 弹出选择器

> ID：12229858
> 
> 赞同：1
> 
> 时间：2012-09-01T17:26:43.423
> 
> 标签：javascript, html

你好我这里有问题。每当我尝试通过单击子窗口中的按钮来更改文本字段值时......它不起作用。

父窗口

```
<html> 
<script language="javascript"> 
function openWindow() { 
  window.open("target.html","_blank","height=200,width=400, status=yes,toolbar=no,menubar=no,location=no") 
} 
</script> 
<body> 
<form name=frm> 
<input id=text1 type=text> 
<input type=button onclick="javascript:openWindow()" value="Open window.."> 
</form> 
</body> 
</html> 
```

作为 target.html 的子窗口

```
<html> 
<script language="javascript"> 
function changeParent() { 
  window.opener.document.getElementById('text1').value="Value changed.." 
} 
</script> 
<body> 
<form> 
<input type=button onclick="javascript:changeParent()" value="Change opener's textbox's value.."> 
</form> 
</body> 
</html> 
```

我真正想要发生的是当我从子窗口单击按钮时......子窗口将被关闭，然后父窗口中的文本字段将更改为“更改开启者的文本框的值..”这是值我从子窗口中选择了..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:42:53.617

Javascript 基本上仅限于窗口。您不能只将值发送到另一个窗口（这很酷）。

父子窗口可以通过多种方式相互通信，但存在一些跨浏览器问题： http: [//www.codehappiness.com/post/access-parent-window-from-child-window-or-access-child-来自父窗口的窗口使用 javascript.aspx](http://www.codehappiness.com/post/access-parent-window-from-child-window-or-access-child-window-from-parent-window-using-javascript.aspx)

最简单的解决方案不是打开一个新窗口，而是在同一个窗口中打开一个模式框。这只不过是一个样式为弹出框的 div。对于菜鸟来说，最简单的方法可能是使用 jquery ui modal 功能。

祝你好运！！

# ruby-on-rails - 在另一个视图中使用实例变量

> ID：12229868
> 
> 赞同：0
> 
> 时间：2012-09-01T17:28:26.063
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我试图在一个控制器的 create 方法中创建一个实例变量，然后在另一个控制器的视图中使用它。这可能吗？

我正在创建`@content`变量`MicropostsController`：

```
class MicropostsController < ApplicationController
  before_filter :signed_in_user, only: [:create, :destroy]
  before_filter :correct_user, only: :destroy

  def create
    @micropost = current_user.microposts.build(params[:micropost])
    @content = 'test' #params[:micropost][:content]
    #pattern = /\A@\w+/

    #if params[:micropost][:content] =~ pattern
     # @content = params[:micropost][:content]
    #end

    if @micropost.save
      flash[:success] = "Micropost created!"
      redirect_to root_path
    else
      @feed_items = []
      render 'static_pages/home'
    end
  end 
```

我正在尝试在类视图中使用的部分中使用它，`StaticPages`但它不起作用：

```
<li id="<%= feed_item.id %>">
  <%= link_to gravatar_for(feed_item.user), feed_item.user %>
  <span class="user">
      <%= link_to feed_item.user.name, feed_item.user %>
  </span>
  <span class="content"><%= feed_item.content %></span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(feed_item.created_at) %> ago.
    <% if @content %>
      <%= @content %>
    <% else %>
      <%= 'no content' %>
    <% end %>
  </span>
  <% if current_user?(feed_item.user) %>
    <%= link_to "delete", feed_item, method: :delete,
                data: { confirm: "You sure?" },
                title: feed_item.content %>
  <% end %>
</li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:57:56.800

我认为您的问题与在不同控制器的视图中使用实例变量无关，而是在部分使用实例变量：

您可以在由调用 Controller`@content`呈现的视图中使用实例变量。`static_pages/home`但是您不能在部分中使用实例变量。您需要将其作为局部变量提供，并将其用作局部变量。有几种语法可以在局部变量中传递局部变量，请参阅[Rails guide on layouts and rendering 3.4.4](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)中的示例。

在您发布的代码中，`feed_item`很可能是您的局部变量这样的局部变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:37:45.877

如果两种方法一个接一个，则将其放入数据库中，或者使用 flash its ..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:42:33.090

您不能在另一个控制器的视图中使用在一个控制器中设置的实例变量。您需要在 StaticPagesController 中设置它，或者您可以使用帮助程序。

这可能会有所帮助：[Rails：跨多个控制器操作设置一个公共实例变量](https://stackoverflow.com/questions/914226/rails-set-a-common-instance-variable-across-several-controller-actions)

# python - 如何在 parent_application 中发出 sub_application 请求？

> ID：12229870
> 
> 赞同：3
> 
> 时间：2012-09-01T17:28:37.470
> 
> 标签：python, web.py, subapplication

我有两个 Web 应用程序：parent_app 和 sub_app

也就是说，[http://www.some.com/parent.png](http://www.some.com/parent.png)将由 parent_app 处理。

如果是在另一个网站上引用，则 parent_app 得到一个 HTTP_REFERER，说是[http://www.other.com/path?query=value](http://www.other.com/path?query=value)，

我想要一个sub_app把这个HTTP_REFERER的路径和query_string作为他自己的路径和query_string，并将结果返回给parent_app，这样，parent_app的url就不会改变，访问者浏览器也不会得到303跳转。

***子.py：***

```
import web
class Sub(object):
    def GET(self):
        return web.input().query             # I want it to be 'value', from "query=value"
urls = (r'/path', 'Sub')
sub_app = web.application(urls, locals()) 
```

***父.py：***

```
import web
from sub import sub_app
class Parent(object):
    def GET(self):
        return sub_app.request('/path?query=value').data  #=========(1)
urls = (
    r'/parent.png', 'Parent',
    r'', sub_app
    )
parent_app = web.application(urls, locals()) 
```

**并运行：**

```
>>>python parent.py 
```

**当我访问“http://www.some.com/parent.png”时？**

**我收到这些错误：**

```
Traceback (most recent call last):
  File "/home/netroyal/Documents/program/studame/web/wsgiserver/__init__.py", line 1245, in communicate
    req.respond()
  File "/home/netroyal/Documents/program/studame/web/wsgiserver/__init__.py", line 775, in respond
    self.server.gateway(self).respond()
  File "/home/netroyal/Documents/program/studame/web/wsgiserver/__init__.py", line 2018, in respond
    response = self.req.server.wsgi_app(self.env, self.start_response)
  File "/home/netroyal/Documents/program/studame/web/httpserver.py", line 306, in __call__
    return self.app(environ, xstart_response)
  File "/home/netroyal/Documents/program/studame/web/httpserver.py", line 274, in __call__
    return self.app(environ, start_response)
  File "/home/netroyal/Documents/program/studame/web/application.py", line 279, in wsgi
    result = self.handle_with_processors()
  File "/home/netroyal/Documents/program/studame/web/application.py", line 249, in handle_with_processors
    return process(self.processors)
  File "/home/netroyal/Documents/program/studame/web/application.py", line 246, in process
    raise self.internalerror()
  File "/home/netroyal/Documents/program/studame/web/application.py", line 473, in internalerror
    parent = self.get_parent_app()
  File "/home/netroyal/Documents/program/studame/web/application.py", line 458, in get_parent_app
    if self in web.ctx.app_stack:
AttributeError: 'ThreadedDict' object has no attribute 'app_stack' 
```

/home/netroyal/Documents/program/studame/web/ 是 web.py 包路径。

**那么，我怎样才能使（1）正确运行？**

**我想得到与 (1) 在 shell 中运行相同的结果：**

```
>>> import web
>>> class Sub(object):
...     def GET(self):
...         return web.input().query
>>> urls = ('/path', 'Sub')
>>> sub_app = web.application(urls, locals())
>>> sub_app.request('/path?query=value').data             #=========(1)'
'value'
>>> 
```

我知道，我可以使用

```
web.seeother('/path?query=value') 
```

让访问者看到结果，但我不希望浏览器跳转到另一个 url。

我认为

```
urllib2.urlopen('http://www.some.com/path?query=value') 
```

会起作用，但是有没有更好的方法在一个请求中做到这一点？

感谢您的帮助！-----**也阅读本文！** ===========================================编辑======= ================================

好的，经过一些代码破解后，我解决了部分问题：

我添加了一个simulation.py：

```
import web, re
class Simulation(object):
    def __init__(self, urls, fvars):
        self._urls = urls
        self._fvars = fvars
    def request(self, localpart='/', method='GET', data=None, host='0.0.0.0:8080', headers=None, https=False):   
        #nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn    
        # get path and args(parameters from new url)
        try:
            path, query = localpart.split('?', 1)
        except:
            path, query = (localpart, '')
        # get all arguments: args(parameters)
        parts = query.split('&')
        args = {}
        for part in parts:
            try:
                name, value = part.split('=')
            except:
                pass
            else:
                args[name] = value
        #uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu
        patterns = [self._urls[2*i] for i in range(0, len(self._urls)/2)]
        for i in range(0, len(patterns)):
            result = re.match(patterns[i], path)
            if result:
                web.input = lambda: web.storage(args)
                Worker = self._fvars[self._urls[2*i + 1]]
                return Worker().GET(*result.groups())
        #----------------------------------------------------------------------------------------
        raise web.notfound() 
```

在 ***sub.py 中：***

```
from simulation import *
class Sub(object):
    def GET(self):
        return web.input().query             # I want it to be 'value', from "query=value"
urls = (r'/path', 'Sub')
sub_app = web.application(urls, locals())
sub_sim = Simulation(urls, locals())         # new class to run request in parent_app 
```

在 ***parent.py 中添加：***

```
import web
from sub import sub_app, sub_sim               #sub_sim is new
class Parent(object):
    def GET(self):
        return sub_sim.request('/path?query=value')  # sub_app changed to sub_sim, and no (.data)
urls = (
    r'/parent.png', 'Parent',
    r'', sub_app
    )
parent_app = web.application(urls, locals()) 
```

我也可以使用'/sub'来访问sub_app，让它成为一个独立的应用程序。

我解决了我的问题，不是很完美，但有点困难。我想我会用它，当我有更多的时间时，我会找到另一种方式。如果您有更好的解决方案，请告诉我，谢谢。

此致。

========================================== 我觉得我在自言自语，人在哪里？

# php - 无法访问图像

> ID：12229872
> 
> 赞同：0
> 
> 时间：2012-09-01T17:29:02.103
> 
> 标签：php, .htaccess, symfony, shared-hosting

我在共享服务器上安装了 Symfony2，问题是我无法查看我在模板中调用的图像。

我的图片在 ~/myApplication/web/images 目录中。

我在我的树枝模板中尝试了这些方法：

```
<img src="{{ asset('images/t.png') }}" alt="Twitter"/>
<img src="{{ asset('web/images/t.png') }}" alt="Twitter"/>
<img src="http://domain.fr/web/{{ asset('images/t.png') }}" alt="Twitter"/>
<img src="http://domain.fr/web/images/t.png" alt="Twitter"/> 
```

但是每次它被转录到`http://domain.fr/web/images/t.png`那时我都会有`http://domain.fr/web/images/t.png`。

我认为这是一个 .htaccess 问题，但我不知道...

我对应用程序根目录的 .htaccess：

```
SetEnv SHORT_OPEN_TAGS 0
SetEnv REGISTER_GLOBALS 0
SetEnv MAGIC_QUOTES 0
SetEnv SESSION_AUTOSTART 0
SetEnv ZEND_OPTIMIZER 1
SetEnv PHP_VER 5_3
AddType x-mapp-php5 .php

<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ web/app.php [QSA,L]
</IfModule> 
```

有人可能知道这是什么？

我对 CSS 或 JS 文件没有任何问题，因为我将它添加到了我的配置中：

```
framework:
    templating:
        assets_base_urls: http://domain.fr/web/ 
```

谢谢你的帮助

# objective-c - 如何通过双击放大？Xcode

> ID：12229876
> 
> 赞同：0
> 
> 时间：2012-09-01T17:29:24.880
> 
> 标签：objective-c, ios, xcode, interface-builder, uigesturerecognizer

我很难理解如何实现点击手势识别器。

我想双击视图并放大，再次双击并缩小。

我在这里研究过[如何在iOS中点击放大和双击缩小？](https://stackoverflow.com/questions/9008975/how-to-tap-to-zoom-and-double-tap-to-zoom-out)，在网上查看并检查了 Apple 文档，但仍然没有得到这个，因为我只是没有得到任何缩放。我已选中“用户启用”复选框

我在 IB 中添加了一个手势识别器，现在我不确定如何为此实现代码/方法。我没有任何代码可以发布，因为我已经在 IB 中添加了手势。

一如既往的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:15:06.053

在 IB 中添加手势识别器后，只需按住 ctrl 并将其拖动到助手中的代码并为其创建 IBAction。或者将其连接到您已经设置的方法。

然后，当视图识别到手势时，将调用该方法。

我不确定你要放大什么。但是，如果您有这个逻辑，那么只需将其连接到由手势识别器事件启动的工作流。

祝你好运。

# c# - 为什么 CompilerOptions.EmbeddedResources 不将资源文件附加到程序集

> ID：12229878
> 
> 赞同：2
> 
> 时间：2012-09-01T17:29:41.640
> 
> 标签：c#, winforms, embedded-resource, dynamic-compilation

我正在尝试使用 CSharpCodeProvider 生成一个 exe，该 exe 将是一个 Windows 窗体项目。exe 必须有一个资源，生成的程序集将在运行时访问该资源。现在要生成该资源，我使用 ResourceWriter 类，然后将其附加到编译器选项 EmbeddedResources。但它似乎不起作用，我得到了 MissingManifestResourceException。

这是代码：

```
FileStream fs = new FileStream("Form1.resources", FileMode.Create);
        ResourceWriter writer2 = new ResourceWriter(fs);
        writer2.AddResource("bitmap", 3);
        writer2.Generate();
        writer2.Close();

        CSharpCodeProvider code = new CSharpCodeProvider();

        CompilerParameters options = new CompilerParameters();
        options.GenerateExecutable = true;
        options.EmbeddedResources.Add("Form1.resources");

        options.OutputAssembly = @"C:\screen.exe";

        options.GenerateInMemory = false;

        options.TreatWarningsAsErrors = false;

        options.ReferencedAssemblies.Add("System.Windows.Forms.dll");
        options.ReferencedAssemblies.Add("System.dll");
        options.ReferencedAssemblies.Add("System.Drawing.dll");
        //options.ReferencedAssemblies.Add("System.Resources.dll");

        CompilerResults res = code.CompileAssemblyFromFile(options, "Program.cs", "Form1.cs", "Form1.Designer.cs"); 
```

希望有人能够帮助我，因为我已经尝试了一个多星期。谢谢你。

# javascript - 返回关联数组而不是 mongoose 中的文档数组

> ID：12229879
> 
> 赞同：4
> 
> 时间：2012-09-01T17:29:48.967
> 
> 标签：javascript, node.js, mongodb, mongoose

假设我有一个具有此架构的 Word 模型

```
var Word = new Schema({
  name: { type: String, required: true },
  disambiguation: String,
  partOfSpeech: { type: ObjectId, ref: "PartOfSpeech", required: true },
  attributes: [{ type: ObjectId, ref: "Attribute"}],
  root: [{ type: ObjectId, ref: "Word"}],
  language: { type: ObjectId, ref: "Language", required: true }
}); 
```

我想执行一个返回对象的查询，其中单词名称作为键，值作为包含具有相应名称的单词的文档数组。

例如，这是我想要的那种输出。为简洁起见，省略了大多数字段。

```
{
  stick: [{
    _id: "5024216f6df57b2b68834079",
    partOfSpeech: "noun"      
  }, {
    _id: "678451de6da54c2b68837345",
    partOfSpeech: "verb"
  }],
  dog: [{
    _id: "47cc67093475061e3d95369d",
    partOfSpeech: "noun"
  }]
} 
```

这样，我可以随机访问单词列表，因此我不必反复迭代它。猫鼬有内置的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:30:37.550

```
Word.find().lean().exec(function (err, docs) {
    // docs are plain javascript objects instead of model instances
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T00:45:36.090

您不能直接使用 Mongoose 执行此操作，但如果您[流式传输](http://mongoosejs.com/docs/api.html#querystream_QueryStream)查询的结果，则可以非常轻松地构建所需的关联数组：

```
var stream = Word.find().stream(), results = {};
stream.on('data', function(doc) {
    if (results.hasOwnProperty(doc.name)) {
        results[doc.name].push(doc);
    } else {
        results[doc.name] = [doc];
    }
}).on('error', function(doc) {
    // Error handling...
}).on('close', function(doc) {
    // All done, results object is ready.
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T03:43:06.417

您可以使用 reduce 函数将任何数组“重新索引”到字典中。我在示例中使用了下划线 reduce，但我认为稍微调整一下它就可以直接在 mongoose 中工作。[http://techishard.wordpress.com/2012/04/22/reducing-an-array-of-objects-to-a-hash-using-a-property-as-key/](http://techishard.wordpress.com/2012/04/22/reducing-an-array-of-objects-to-a-hash-using-a-property-as-key/)

```
_.reduce (foo, function (reduced, item) {
 reduced[item.name] = item;
 return reduced;
}, {}); 
```

# google-app-engine - 已删除的版本仍在appspot.com 中提供服务

> ID：12229881
> 
> 赞同：1
> 
> 时间：2012-09-01T17:30:24.403
> 
> 标签：google-app-engine, version-control, python-2.7

我不知道为什么我在appspot.com中删除了我的应用程序的某些版本，但是在pagespeed服务下清除了本地浏览器和appspot.com上的缓存之后发生了事件。

旧版本仍然可以访问。删除的版本多久会消失？另外，我有上传更改，但它根本没有显示出来。

那么多久会出现变化呢？如果有办法迫使这些发生，我将不胜感激。预先感谢您在此问题上提供的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-31T11:03:51.300

谷歌的 GSLB 代理会缓存你的静态文件几个小时，即使你禁用了你的 apppot 应用程序然后重新启用它。

我的解决方案是在每个 css、js、jpg url 处附加版本号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:46:44.727

如果您转到 App Engine 管理页面，您应该能够看到您正在运行的所有实例。杀死旧版本的所有实例，它应该停止服务。

# php - 通过仅使用 PHP 和 MySQL 的一行来更新包含多个值的列的确切值？

> ID：12229890
> 
> 赞同：1
> 
> 时间：2012-09-01T17:31:18.667
> 
> 标签：php

如何在 PHP 和 MySQL 中仅使用一行来更新包含多个值的列的确切值？

选择：KPL：“1,2,3,4”

更新和删除旧值：KPL: "1,2,3,5"

不像这样：KPL: "$_POST["kpl"]"

这是我当前的代码，它是这样的： KPL: "1,2,3,4,5"

```
$kpl=$_POST["kpl"];
$today = date("Y-m-d");

$bquery = mysql_query("SELECT kpl FROM table WHERE user='$user' AND date='$today'");
$bresult = mysql_fetch_array($bquery);
$b = $bresult[0];

$data = array();
foreach (explode(",", $b) as $i => $x) {
$data[$i]["kpl"] = $x;
if($data["kpl"] == $id) {
$exact = TRUE;
}
}

foreach ($data as $rivi) {
$kpl2 = $rivi["kpl"];

if(!(empty($kpl))) {
if($elintarvikeonkaytossa == TRUE) {
$b2 = sanitize($b.",".$kpl);
mysql_query("UPDATE table SET kpl='$b2' WHERE user='$user' AND date='$today'") or die(mysql_error());
}
}
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:47:00.833

您必须重新设计您的数据库，因为它不符合[第一范式](http://en.wikipedia.org/wiki/First_normal_form)，即单个字段不能处理多个值 - 我们将使用 CSV 或 txt 代替。

长话短说，您应该用您的`kpl`数据制作一个表格，并将每个数字/ID 存储在不同的行中，而不是弄乱草率的 php 替换代码 - 这是因为您的数据库应该是*关系型*的，而不仅仅是一个大的东西存储库。

# scala - 具有默认参数的可变长度参数列表？

> ID：12229892
> 
> 赞同：7
> 
> 时间：2012-09-01T17:31:31.413
> 
> 标签：scala, arguments

是否可以为可变长度参数列表设置默认参数？

例子：

```
def foo(args: String*) = args.foreach(println) 
```

如何设置默认参数`args`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T17:35:03.427

不，如果你尝试，编译器会告诉你：

> 错误：带有“*”参数的参数部分不允许有默认参数

但是您可以通过方法重载获得相同的结果：

```
class A {
  def foo(args: String*): Unit = args.foreach(println)
  def foo(): Unit = foo("A", "B", "C")
} 
```

这是您提供参数的时候：

```
scala> (new A).foo("A", "B")
A
B 
```

这是“默认”：

```
scala> (new A).foo()
A
B
C 
```

# mysql - 使用 mySQL 为每个类别选择两个不同的随机条目

> ID：12229893
> 
> 赞同：3
> 
> 时间：2012-09-01T17:31:51.353
> 
> 标签：mysql, group-by, left-join

我有一张桌子，看起来像：

```
table: Q
---------------------------
|question| scope |  type  |
---------------------------
|  this  |   A   |   1    |
|  that  |   A   |   1    |
|  them  |   A   |   1    |
---------------------------
|  this  |   A   |   2    |
|  that  |   A   |   2    |
|  them  |   A   |   2    |
---------------------------
|  this  |   B   |   1    |
|  that  |   B   |   1    |
|  them  |   B   |   1    |
--------------------------- 
```

我需要给定一个范围，我需要从每种类型中提取两个条目。如果范围是 A，可能的解决方案是：

```
---------------------------
|  this  |   A   |   1    |
|  them  |   A   |   1    |
---------------------------
|  that  |   A   |   2    |
|  this  |   A   |   2    |
--------------------------- 
```

我目前正在使用以下 SQL 语句：

```
SELECT tmp.question, tmp.type, tmp.scope
FROM Q
LEFT JOIN (
SELECT * FROM Q ORDER BY RAND( )
)tmp ON ( Q.type = tmp.type AND tmp.scope = 'A' ) 
GROUP BY tmp.type
ORDER BY Q.type 
```

但是，这仅返回每种类型的一个条目，并且由于某种原因返回 NULL 行。
因此，我的问题是如何优化语句以返回两行并消除 NULL 行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:10:24.827

您可以将排名从 2 更改为您想要为每个类别获得的任何排名。

[http://www.sqlfiddle.com/#!2/f3946/86](http://www.sqlfiddle.com/#!2/f3946/86)

试试这个：

```
 SELECT x.question,
       x.scope,
       x.type
  FROM (

    SELECT bp.question, bp.scope, bp.type, 
    CASE WHEN bp.type = @type 
         THEN @rownum := @rownum + 1
         ELSE @rownum := 1
         END AS rank,
    @type := bp.type
FROM (select * from Q order by rand()) bp
JOIN (SELECT @rownum := 0, @type := NULL) r
WHERE bp.scope = 'A'
ORDER BY type
    ) x
 WHERE x.rank <= 2
order by x.type 
```

注意：我使用了一个旧答案并改进了随机化。我得到帮助的旧答案是： [为每个类别选择 N 条记录并按 X 排序](https://stackoverflow.com/questions/3832569/select-n-records-for-each-category-and-order-by-x)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:47:39.760

**[SqlFiddle](http://sqlfiddle.com/#!2/ff05c/10)**：

```
(
  SELECT question, scope, type FROM Q
  WHERE  scope = 'A' AND type = 1
  ORDER BY RAND() LIMIT 2
)
UNION
(
  SELECT question, scope, type FROM Q
  WHERE  scope = 'A' AND type = 2
  ORDER BY RAND() LIMIT 2
) 
```

# mysql - MySQL 到 PDO 错误

> ID：12229894
> 
> 赞同：0
> 
> 时间：2012-09-01T17:31:51.837
> 
> 标签：mysql, sql, pdo

我有以下sql代码：

```
$statement = "`maildb`";

$query = "SELECT COUNT(*) as `num` FROM {$statement}";
$row = mysql_fetch_array(mysql_query($query)); 
```

我正在尝试转换为 PDO ...我尝试了以下方法：

```
$statement = "`maildb`";

$query = $db->prepare("SELECT COUNT(*) as `num` FROM {$statement}"); 
$query->execute();
$row = $query->fetchAll(PDO::FETCH_ASSOC); 
```

这导致：致命错误：在第 8 行的 function.php 中对非对象调用成员函数 prepare()。

我以前也试过这个，应该做同样的事情：

```
$query = $db->prepare("SELECT * FROM maildb"); 
$query->execute();
$row = $query->fetchAll(PDO::FETCH_ASSOC);

$num = count($row); 
```

有什么帮助吗？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:55:08.003

我认为错误在于这一行：

```
$query = $db->prepare("SELECT COUNT(*) as `num` FROM {$statement}"); 
```

而是尝试使用：

```
$query = $db->prepare("SELECT COUNT(*) as `num` FROM ?");
$query->execute($statement); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:35:12.843

您可能没有实例化 $db。因此，它不是对象，因此您不能从中调用函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:35:14.637

您正在使用未初始化的 $db 。请先初始化它`$db = new PDO( <connection details here> )`。有关详细信息，请参阅[PHP.net 上的 PDO 手册。](http://www.php.net/manual/en/class.pdo.php)

# android - 在后台运行 Android phonegap 应用程序

> ID：12229896
> 
> 赞同：6
> 
> 时间：2012-09-01T17:32:14.143
> 
> 标签：android, cordova, jquery-mobile, cordova-2.0.0

我正在Phonegap，cordova中开发一个android应用程序。我在应用程序中有一个按钮，点击时我需要在后台运行应用程序并

需要每隔 15 分钟调用一次 Web 服务。

是否有可能在电话间隙，科尔多瓦项目...

我是新手..请帮忙

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T19:17:21.053

您必须创建一个自定义插件才能在后台运行进程。[您可以在此处](https://stackoverflow.com/questions/9412501/how-to-create-plugin-in-phonegap-to-run-the-application-in-background)找到插件实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-26T05:52:40.023

在从 DroidGap 扩展的 Java 类的 onCreate 方法中，确保您已正确设置“keepRunning”。

```
 super.setBooleanProperty("keepRunning", true); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-16T03:13:57.907

从 phonegap 3+ 开始，有一个插件可以将此功能添加到您的应用程序中，这是插件项目和说明的链接，应该适用于 cordova、phonegap 和 phonegap 构建：

[https://github.com/katzer/cordova-plugin-background-mode/blob/ac5fef831dbf9e567277dc900389923bd9bc7714/README.md](https://github.com/katzer/cordova-plugin-background-mode/blob/ac5fef831dbf9e567277dc900389923bd9bc7714/README.md)

# haskell - 以下 foldl 实现有什么问题？

> ID：12229898
> 
> 赞同：4
> 
> 时间：2012-09-01T17:32:28.053
> 
> 标签：haskell

通过任务，我们必须通过 foldr 实现 foldl。通过比较函数签名和 foldl 实现，我得到了以下解决方案：

```
myFoldl :: (a -> b -> a) -> a -> [b] -> a
myFoldl _ acc [] = acc
myFoldl fn acc (x:xs) = foldr fn' (fn' x acc) xs
    where
    fn' = flip fn 
```

只需翻转函数参数以满足 foldr 预期类型并通过递归应用传递的函数来模拟 foldl 定义。这是一个惊喜，因为我的老师给这个答案评分为零分。

我什至检查了这个定义以与标准 foldl 相同的方式堆叠其中间结果：

```
 > myFoldl (\a elm -> concat ["(",a,"+",elm,")"]) "" (map show [1..10])
 > "((((((((((+1)+10)+9)+8)+7)+6)+5)+4)+3)+2)"
 > foldl (\a elm -> concat ["(",a,"+",elm,")"]) "" (map show [1..10])
 > "((((((((((+1)+10)+9)+8)+7)+6)+5)+4)+3)+2)" 
```

正确答案是以下定义：

```
myFoldl :: (a -> b -> a) -> a -> [b] -> a    
myFoldl f z xs = foldr step id xs z
    where step x g a = g (f a x) 
```

只是问为什么我以前的定义不正确？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T17:53:40.397

本质上，你的弃牌顺序是错误的。我认为您没有`foldl`正确复制输出；我得到以下信息：

```
*Main> myFoldl (\ a elem -> concat ["(", a, "+", elem, ")"]) "" (map show [1..10])
"((((((((((+1)+10)+9)+8)+7)+6)+5)+4)+3)+2)"
*Main> foldl (\ a elem -> concat ["(", a, "+", elem, ")"]) "" (map show [1..10])
"((((((((((+1)+2)+3)+4)+5)+6)+7)+8)+9)+10)" 
```

所以发生的事情是您的实现获得了第一个元素 - 基本情况 - 正确，但随后使用 foldr 其余部分，这导致其他所有内容都被向后处理。

[Haskell wiki](http://www.haskell.org/haskellwiki/Fold)上有一些关于折叠工作的不同顺序的漂亮图片：

![文件夹可视化](../Images/31dc5cea6df21352e7c10f6f889a3285.png)

![折叠可视化](../Images/d82728527d779c856c8a15ecdf128a5b.png)

这显示了`foldr (:) []`列表的标识应该如何，并且`foldl (flip (:)) []`应该*反转*列表。在您的情况下，它所做的只是将第一个元素放在最后，但将其他所有元素保持相同的顺序。这正是我的意思：

```
*Main> foldl (flip (:)) [] [1..10]
[10,9,8,7,6,5,4,3,2,1]
*Main> myFoldl (flip (:)) [] [1..10]
[2,3,4,5,6,7,8,9,10,1] 
```

这给我们带来了更深、更重要的一点——即使在 Haskell 中，仅仅因为类型对齐并不意味着你的代码可以工作。Haskell 类型系统不是万能的，通常有许多——甚至是无限数量的——满足任何给定类型的函数。作为一个退化的例子，即使是以下`myFoldl`类型检查的定义：

```
myFoldl :: (a -> b -> a) -> a -> [b] -> a
myFoldl _ acc _ = acc 
```

因此，即使类型匹配，您也必须准确考虑您的函数在做什么。考虑折叠之类的事情可能会让人困惑一段时间，但你会习惯的。

# c++ - 用 std::u16string 替换 std::stringstream 和 boost::format 什么？

> ID：12229900
> 
> 赞同：2
> 
> 时间：2012-09-01T17:32:40.850
> 
> 标签：c++, unicode, c++11

std::iostream 类缺乏对 char16_t 和 char32_t 的专门化，而 boost::format 取决于流。用什么来替换 utf16 字符串的流（最好有本地化支持）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:07:17.230

流处理的基本实体是字符，而不是编码字符。对于 Unicode，决定一个字符可以跨多个实体拆分，使其与流抽象本质上不兼容。

添加新字符类型旨在处理处理 Unicode 字符的标准方法，但它被认为太复杂，无法重做 IOStreams 和语言环境的行为以保持增加的复杂性。这部分是由于人们不太喜欢流，部分是由于这是一项庞大而重要的任务。我认为可以将所需的方面定义为能够处理简单的情况，但我不确定这是否会导致快速解决方案以及它是否会涵盖需要 Unicode 的语言：我可以看到它是如何实现的适用于欧洲文本，但我不知道这是否真的适用于亚洲文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:45:58.273

这很好。encodings 争论已经结束并且基本已经解决了。您不希望在程序中的任何地方使用 utf16 字符串，除非与遗留 API 通信，即转换整个格式化字符串时，最好通过 boost::narrow 和加宽来完成。当然，除非您正在做一些罕见的边缘案例优化。

请参阅[http://utf8everywhere.org](http://utf8everywhere.org)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:45:27.637

当前流通常作为模板实现（我这里没有标准的副本，但我很确定它们必须作为模板实现）所以让它们具有宽字符串意识应该是一个简单的实例化问题具有适当字符类型的模板。

您的实现很可能已经为宽字符串提供了预定义的特化。看看像 std::wstringstream 这样的东西。

也就是说，C++ 中的各种字符类型不会对您放入其中的字符串的编码做出任何假设，因此您可以将其作为“按约定”方式处理 - 例如，您的宽字符串被编码为 utf16按照惯例，但图书馆中没有任何内容强制执行此约定。

# android - 有什么对初学者有用的Android动画教程吗？

> ID：12229901
> 
> 赞同：31
> 
> 时间：2012-09-01T17:32:57.537
> 
> 标签：android, animation, transition

在视图或过渡中是否有任何好的 android 动画教程？完整的教程或指南可能会有所帮助。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-09-01T17:43:41.193

基本上有两种类型的动画：

*   [查看动画](http://developer.android.com/guide/topics/graphics/view-animation.html)：

    > 使用 View Animation，您可以对 View 对象的内容执行一系列简单的转换（位置、大小、旋转和透明度）

*   [可绘制动画](http://developer.android.com/guide/topics/graphics/drawable-animation.html)：

    > Drawable 动画可以让你一个接一个地加载一系列 Drawable 资源来创建动画。从某种意义上说，这是一种传统动画，它是用一系列不同的图像创建的，按顺序播放，就像一卷胶卷

上面两个链接有足够的例子让你开始。

# python - 使用 Python 对包含“无”的列表求和

> ID：12229902
> 
> 赞同：48
> 
> 时间：2012-09-01T17:33:00.050
> 
> 标签：python, sum

基本上我的问题是说您有一个包含“无”的列表，您将如何尝试检索列表的总和。下面是我试过的一个例子，它不起作用，我得到了错误：`TypeError: unsupported operand type(s) for +: 'int' and 'NoneType'`。谢谢

```
def sumImport(self):
    my_list = [[1,2,3,None],[1,2,3],[1,1],[1,1,2,2]]
    k = sum(chain.from_iterable(my_list))
    return k 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-01T17:34:40.823

你可以使用`filter`函数

```
>>> sum(filter(None, [1,2,3,None]))
6 
```

**从评论更新**

通常`filter`用法是`filter(func, iterable)`，但作为第一个参数传递`None`是一种特殊情况，在[Python 文档](http://docs.python.org/library/functions.html#filter)中进行了描述。报价：

> 如果 function 为 None，则假定恒等函数，即移除 iterable 中所有为 false 的元素。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-01T17:35:05.850

`None`使用求和之前删除（和零）元素`filter`：

```
>>> k = sum(filter(None, chain.from_iterable(my_list)))
>>> k
20 
```

要了解其工作原理，请参阅以下[文档`filter`](http://docs.python.org/library/functions.html#filter)：

> `filter(function, iterable)`
> 
> 从那些返回 true 的元素构造一个`iterable`列表`function`。`iterable`可以是序列、支持迭代的容器或迭代器。如果 iterable 是字符串或元组，则结果也具有该类型；否则它总是一个列表。如果 function 是`None`，则假定恒等函数，即所有 iterable 为 false 的元素都被删除。
> 
> 请注意，这`filter(function, iterable)`相当于`[item for item in iterable if function(item)]`if function is not`None`和`[item for item in iterable if item]`if function is `None`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-01T17:41:03.137

另一个建议：

```
from itertools import chain
k = sum(x for x in chain.from_iterable(my_list) if x) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-01T17:34:34.220

假设您想将`None`其视为零，一种简单的方法是

```
sum(x if x is not None else 0 for x in chain.from_iterable(my_list)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-01T18:23:01.943

明确地说，这等效于过滤器：

```
k = sum([x for x in chain.from_iterable(my_list) if x]) 
```

这使我免于记住另一个功能。:P

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-01T17:41:07.420

你总是可以选择只写你想要的循环：

```
k = 0
for sublist in my_list:
    for val in sublist:
        if val is not None:
            k += val 
```

但知道这`filter`两者当然也没有什么坏处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-09T11:12:32.377

只需使用 sum 和 map：

```
sum(map(lambda x: x or 0, [1,2,3,None])) 
# 6 
```

# backbone.js - Backbone.js 将变量从路由器传递到集合

> ID：12229911
> 
> 赞同：1
> 
> 时间：2012-09-01T17:35:09.450
> 
> 标签：backbone.js

如何将名称变量从路由器传递到 FriendInfocollection？每当我浏览到 localhost/app/person/MyName 时，console.log 都会为 localhost/slim/index.php/person/ 返回 404

有人可以指出我与集合共享此变量的正确方向，以便它使用正确的网址吗？

```
<!DOCTYPE html>
<html>
<head>
    <title>I have a back bone</title>
</head>
<body>
    <button id="add-friend">Add Friend</button>
    <button id='view-friends'>View Friends</button>
    <ul id="friends-list">
    </ul>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
<script>
Friend = Backbone.Model.extend({
    name: null,
    age: null,
});
FriendDetailModel = Backbone.Model.extend();
FriendInfoModel = Backbone.Model.extend({
    name: null 
});
FriendDetailCollection = Backbone.Collection.extend({
    url: '../slim/index.php/people/',
    model: FriendDetailModel

});
FriendInfoCollection = Backbone.Collection.extend({
    model: FriendInfoModel,
    url: '../slim/index.php/person/' + name,
});

Friends = Backbone.Collection.extend({
    initialize: function(models, options) {
        this.bind("add",options.view.addFriendLi);
    }
});
AppView = Backbone.View.extend({
    el: $("body"),
    initialize: function() {
        this.friends= new Friends(null, {view:this});
    },
    events: {
        "click #add-friend":  "showPrompt",
    },
    showPrompt: function () {
        var friend_name = prompt("Who is your friend?");
        var friend_age = prompt("What is your friends age?");
        var friend_model = new Friend({name: friend_name, age: friend_age});

        this.friends.add(friend_model);
    },
    addFriendLi: function(model) {
        $("#friends-list").append("<li>" + model.get('name') + " " + model.get('age') + "</li>");
    }
});
var appview = new AppView;
var people = new FriendDetailCollection;
var person = new FriendInfoCollection({name:'Sean'});

FriendView = Backbone.View.extend({
    el: $("body"),
    initialize: function() {
        _.bindAll(this,'render');
        this.collection.bind('reset', this.render);
    },
    events: {
        "click #view-friends": "fetch_list",
    },
    render: function() {

        var results = this.collection.toJSON();
        $.each(results, function(key, value) {
            var msg = results[key]['firstname'] + " " + results[key]['lastname'];
            console.log(msg);
        });
    },
    fetch_list: function() {
                people.fetch({
                        success: function(data) {
                                //console.log("success");
                        }
                });

    }

});

FriendInfoView =  Backbone.View.extend({
        el: $("body"),
        initialize: function(name) {
                _.bindAll(this,'render');
                this.collection.bind('reset', this.render);
        },
        render: function(name) {
                var results = this.collection.toJSON();
                $.each(results, function(key, value) {
                        var msg = results[key]['firstname'] + " " + results[key]['lastname'];
                        console.log(msg);
                });
        }

});

friendview = new FriendView({collection: people});
friendinfoview = new FriendInfoView({collection: person});
AppRouter = Backbone.Router.extend({
    routes: {
        "friends":"people",
        "person/:name":"personDetail"
    },

    people: function() {
        console.log('all the people');
        people.fetch({
            success: function(data) {
                //console.log("success");
            }
        });

    },

    personDetail: function(name) {
        person.fetch({
                        success: function(data) {
                                console.log("success");
                        }
                });

        console.log('one person named ' + name);
    }
});
var approuter = new AppRouter;
Backbone.history.start();
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T12:06:08.163

您应该像这样定义路由器：

```
var AppRouter = Backbone.Router.extend({
    routes: {
        'name/:name'                : 'getPerson'
    },
getPerson: function(name) {
    var callperson = new Person.Details({
        name        :   name
    });
} 
```

dom 准备好时实例化路由

```
 app_router = new AppRouter; 
```

现在您可以在视图中访问这样的名称：

```
 this.options.name 
```

但是您必须在初始化函数中定义选项变量

```
 initialize: function ( options ) 
```

当然，您可以像这样设置模型：

```
 model.set('name', name) 
```

# facebook-graph-api - Restfb - 一次通话获得多个连接

> ID：12229915
> 
> 赞同：3
> 
> 时间：2012-09-01T17:35:34.287
> 
> 标签：facebook-graph-api, rest, search

我正在使用 restfb 使用搜索字符串搜索连接。根据 restfb.com 网站上的示例，搜索只是获取连接的另一个示例。到目前为止，我已经让这个工作了。也就是说，我可以依次在“me/home”或“me/posts”下搜索“honda”。

我无法弄清楚的是如何在一次调用中组合多个搜索（即获取多个连接）。例如，我想在一次调用中在“me/home”和“me/posts”下搜索“honda”。

获取多个对象的 restfb.com 示例如下：

FetchObjectsResults fetchObjectsResults = facebookClient.fetchObjects(Arrays.asList("me", "cocacola"), ....

但是，我似乎没有看到像“fetchConnections”这样可以检索多个连接的东西，因此使我能够在一次调用中组合多个连接搜索。

关于如何在一次调用中组合多个 fetchConnections 的任何想法？

在此先感谢您的帮助！

穆罕默德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T19:04:02.847

您想使用批处理请求对象。像下面这样的东西应该工作

```
LinkedList<BatchRequest> request = new LinkedList<BatchRequest>();
List<Long> working = new LinkedList<Long>();
BatchRequest temp = new BatchRequest.BatchRequestBuilder("me").parameters(Parameter.with("limit", 20)).build();
BatchRequest.BatchRequestBuilder("cocacola").parameters(Parameter.with("limit", 20)).build(); 
```

然后发出请求，只需执行以下操作

```
List<BatchResponse> response = facebookClient.executeBatch(request, Collections.<BinaryAttachment>emptyList()); 
```

将我和可口可乐替换为您实际想要进行的查询。restfb 页面记录了如何发出这些批处理请求。要实现的主要事情是每个批处理请求只能放置 50 个请求。

# xml - 确定 XPath 以检索 XML 中的值

> ID：12229919
> 
> 赞同：2
> 
> 时间：2012-09-01T17:36:20.290
> 
> 标签：xml, xpath

请参考下面的示例 XML

```
<Actions>
    <Action>
        <Name>Forward</Name>
        <Value>Forward Assignment</Value>
        <panelID>Y0192_pnlForwad</panelID>
        <Status>Order Suspended</Status>
        <from>Shop</from>
        <to>Warehouse</to>
    </Action>
</Actions> 
```

如果我知道“from”节点的值，如何使用 XPath 表达式确定“Name”和“Value”节点的对应值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:30:00.777

> 如果我知道“from”节点的值，如何使用 XPath 表达式确定“Name”和“Value”节点的对应值？

**使用**：

```
/*/Action[from='Shop']/*[self::Name or self::Value] 
```

这将选择任何元素 named`Name`或 named `Value`，其父`Action`元素是 XML 文档顶部元素的子元素，并且（`Action`父元素）有一个`from`子元素，其字符串值为 string `"Shop"`。

**如果您想单独选择`Name`and `Value`（不是一起选择，而是）**，可以通过评估两个 XPath 表达式来完成：

```
/*/Action[from='Shop']/Name 
```

和

```
/*/Action[from='Shop']/Value 
```

# django - 共享主机上的 Django 和 AppEngine 速度差异

> ID：12229927
> 
> 赞同：0
> 
> 时间：2012-09-01T17:37:45.520
> 
> 标签：django, google-app-engine, cgi

我知道可以通过 CGI 或 fastCGI 在共享主机上运行 Django，但是它们都非常慢。现在我知道 AppEngine 也通过 CGI 处理 Django 请求。我想知道共享主机上的 Django 不能像在 AppEngine 上那样快有什么区别？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:03:23.563

App Engine 不使用 CGI 处理请求。

Python 2.5 运行时使用类似于 CGI 的接口，实际上更像 FastCGI - 如果您定义一个 main 方法，运行时将调用它而不是重新导入脚本，即使您不这样做，模块也会在请求之间缓存。

Python 2.7 运行时使用 WSGI。

# python - mod_wsgi中python的时差

> ID：12229929
> 
> 赞同：1
> 
> 时间：2012-09-01T17:38:00.727
> 
> 标签：python, mod-wsgi

我已经使用以下代码显示结果和经过的时间以在 mod_wsgi 中找出结果。但是无论我尝试什么，我总是将经过的时间设为 0，即使我将时间四舍五入到纳秒。我现在该怎么做来计算差异？

```
#!D:/Python27/python

from wsgiref.simple_server import make_server
from cgi import parse_qs, escape
import time
import datetime

html = """
<html>
<body>
  <h2>Sum of first n factorials</h2>
   <form method="get" action="Sec1q10.py">
      Number :<input type="text" name="t1">
<br> <input type="submit" value="Submit">
  </form>
   <br>
   Result:%s<br>
   Now:%s<br>
   End:%s<br>
   Time:%s
   </body>
</html>"""

def application(environ, start_response):
 d=parse_qs(environ['QUERY_STRING'])
 now = int(round(time.time()*1000000))
 n=d.get('t1',[''])[0]
 i=1
 p=1
 s=0
 while (i<=int(n)):
  p = p*i
  s =s+p
  i = i+1 
 end= int(round(time.time()*1000000))
 diff=end-now
 status = '200 OK'
 output = html % (s or 'Empty',now or 'Empty',end or 'Empty',diff or 'Empty') 

 response_headers = [('Content-type', 'text/html'),
                    ('Content-Length', str(len(output)))]
 start_response(status, response_headers)

 return [output] 
```

它显示的输出是如果我输入了数字 4：

```
Result:33
Now:1346520500489000
End:1346520500489000
Time:Empty 
```

我还能用什么来找出经过的时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:55:15.150

`time.time()`没有无限分辨率——您正在测试的操作几乎不需要任何时间。尝试使用更大的`n`，或将循环重复大量固定次数（例如，一千次）并将结果除以重复的次数。

# django - django表单验证来自外部数据库的用户名字段

> ID：12229934
> 
> 赞同：1
> 
> 时间：2012-09-01T17:38:36.177
> 
> 标签：django, validation, rawsql

我正在构建这个 django 应用程序，并且我有一个允许用户输入 32 个字符的 api 密钥的表单。我正在使用一个在表中具有这些 api 键值的外部数据库。一旦用户在 CharField 中输入值，我想验证 api 密钥是否正确。

这是我目前正在使用的领域，非常简单。

```
apikey = forms.CharField(label='User api key', required=True) 
```

我在我的 settings.py 中配置了外部数据库，并将一些数据库查找函数导入到我的 forms.py 中。例如，我已经有由数据库值填充的 ChoiceFeilds。

检查 api 密钥是否在我的外部数据库中的最佳方法是什么，如果没有，当用户输入不在数据库中的 api 密钥时显示错误消息？

谢谢 - 奥利

# objective-c - iOS坐标系越界

> ID：12229938
> 
> 赞同：1
> 
> 时间：2012-09-01T17:39:04.180
> 
> 标签：objective-c, ios, uiview

我正在为 iPhone 开发我的第一个游戏并遇到这个问题。坐标系似乎很遥远，很可能我做错了什么。

我有一个 UIViewController，它被设置为 RootViewController。之后 viewController 调用 UIView ；

应用委托；

```
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
MyViewController *myViewController = [[MyViewController alloc] init];
[[self window] setRootViewController:myViewController]; 
```

视图控制器；

```
CGRect frame = [[UIScreen mainScreen] bounds];
MyView *v = [[MyView alloc] initWithFrame:frame];
[self setView:v]; 
```

看法;

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
.
.
.
[myCALayer setBounds:CGRectMake(0.0, 0.0, width, height)];
[myCALayer setPosition:CGPointMake(x, y)]; 
```

所以 0.0 应该是左上角，但是在我的开发环境中，它在可见屏幕之外，仍然在左上角，但是当我在 0.0 处绘制图像时，我只能看到它右下角的一小部分.

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:57:10.860

**位置**

指定接收者在超层坐标系中的位置。动画。

```
@property CGPoint position 
```

**讨论**

该位置是相对于锚点的。此属性的值以磅为单位指定。默认值为 (0.0, 0.0)。

[有关bounds](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/bounds)、[anchorPoint](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/anchorPoint)和[position](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/position)属性之间关系的更多信息，请参阅[Core Animation Programming Guide中的](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)[“Layer Geometry and Transforms”</a> 。](https://developer.apple.com/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/Layers.html)

默认锚点设置为 (0.5,0.5)，它是图层的中心，因此如果将位置设置为 (0,0)，图层的中心将位于 (0,0) - 只有右下角可见，您需要将锚点设置为（0,0），然后将位置设置为（0,0）。

# c - 网上是否有任何 C 术语汇编？

> ID：12229939
> 
> 赞同：3
> 
> 时间：2012-09-01T17:39:23.387
> 
> 标签：c

网上是否有任何 C 术语汇编？我觉得很难用确切的技术术语来解释我想说的话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T17:48:49.640

这是一个汇编：

1.  [C 术语](http://programmingexamples.wikidot.com/c-terminology)
2.  [C 参考](http://www.cprogrammingreference.com/Tutorials/Basic_Tutorials/Expressions.php)
3.  [基础 C](http://randu.org/tutorials/c/basic.php)
4.  [cdecl](http://cdecl.org/)
5.  [编程](http://www.cprogramming.com/cgi-bin/glossary/glossary.pl)
6.  [CLC-wiki](http://clc-wiki.net/wiki/C_language:Terms) <---从`anon ymous`添加
7.  [A 到 Z](http://www.glenmccl.com/glos.htm)（C++，但有一些有用的常用术语）
8.  [A 到 Z](http://cplus.about.com/od/c/Glossary_of_Common_Programming_Terms_and_Phrases_C.htm) (C/C++/C#)
9.  [维基书](https://en.wikibooks.org/wiki/C_Programming)
10.  [大教程](http://www.iu.hio.no/~mark/CTutorial/CTutorial.html)
11.  [技巧和窍门](https://stackoverflow.com/questions/132241/hidden-features-of-c)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T17:49:20.293

C 语言标准确实没有替代品。ISO 的真正优惠相当昂贵，但你可以在

[http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)

理由也可能会有所帮助。

[http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf](http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T17:51:02.590

半编译术语可在

*   [CLC：条款](http://clc-wiki.net/wiki/C_language%3aTerms)
*   [编程示例](http://programmingexamples.wikidot.com/c-terminology)

[和C 标准](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)`3\. Terms, definitions, and symbols`中的佼佼者。

# html - 在 html5 中使用 turn.js

> ID：12229940
> 
> 赞同：0
> 
> 时间：2012-09-01T17:39:29.077
> 
> 标签：html, jquery-plugins, turnjs

我正在尝试在 HTML5 中添加翻书效果我已经为页面和精装书创建了一些 div 标签，但问题是“硬”div 不起作用，因为它们应该就像我无法翻页一样。！

我有这个代码：

```
<html>
<head>
<!--
<style type="text/css">
body
{ overflow:hidden;}
#zoom-viewport
{

background:#E3EDFF;

}

#flipbook.shadow{
    -webkit-box-shadow: 0 4px 10px #666;
    -moz-box-shadow: 0 4px 10px #666;
    -ms-box-shadow: 0 4px 10px #666;
    -o-box-shadow: 0 4px 10px #666;
    box-shadow: 0 4px 10px #666;
}

#flipbook .page-wrapper{
   -webkit-perspective:2000px;
   -moz-perspective: 2000px;
   -ms-perspective: 2000px;
   perspective: 2000px;
}

#flipbook{

    background:#75A3FF;
transition:margin-left 1s;
    -webkit-transition:margin-left 1s;
    -moz-transition:margin-left 1s;
    -o-transition:margin-left 1s;
    -ms-transition:margin-left 1s;
    transition:margin-left 1s;
}
</style>

        -->

<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
 <script src="includes/Turn/turn.js"></script>

</head>

<body>
<div id="zoom-viewport"> 
<div id="flipbook" style="background-color:red;">
    <div class="hard"> Turn.js </div> 
    <div class="hard"></div>
    <div class="double"> Page 1 </div>
    <div class="double"> Page 2 </div>
    <div class="double"> Page 3 </div>
    <div class="double"> Page 4 </div>
    <div class="hard"></div>
    <div class="hard"></div>
</div>
</div>

<script type="text/javascript">

$("#flipbook").turn({width:800, height:500 , autoCenter:true}).bind("turning", function(event, page, view) {
    alert("Turning the page to: "+page);
});
</script>
</body>
</html> 
```

请帮忙解决这个问题

提前致谢

舒迈拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:52:35.323

有几件事要检查。

*   您使用的是哪个版本的 Turn.js？
*   你测试的是什么浏览器？

似乎直到第 4 个版本才发布硬类。在 IE9 中还有一个使用硬类的错误，直到 4.1.0 版才修复。

希望这会有所帮助，快速查看代码看起来很像示例代码。

# c++ - 如何在 gdb 中为函数的所有调用设置断点？

> ID：12229941
> 
> 赞同：5
> 
> 时间：2012-09-01T17:39:42.603
> 
> 标签：c++, gdb

我有一个第三方库函数调用分散在我的可执行文件的很多地方。我的可执行文件是使用调试符号构建的，但第三方库没有调试符号，因此我无法在函数上放置断点。我想在调用库函数时放置一个断点，以检查调用堆栈。如何在可执行文件中对库函数调用的所有调用设置断点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T17:56:13.790

我认为唯一的方法是：

*   在您的代码中找到此函数的任何调用；
*   在该行中创建一个断点；
*   运行调试器并停在那里；
*   写入 gdb`nexti`以获取第一个功能指令；
*   获取当前 eip，它将指向该函数的开头；
*   在eip指向的地址处新建断点；

# ruby-on-rails - 嵌入辅助方法时出现格式错误？

> ID：12229943
> 
> 赞同：0
> 
> 时间：2012-09-01T17:39:57.283
> 
> 标签：ruby-on-rails, formtastic

我正在尝试使用一个小助手在标题输入中生成一些随机占位符文本，但我遇到了麻烦。

这是视图代码：

```
<%= form.input :title, :placeholder => "<%= random_title %>".html_safe %> 
```

这是我收到的错误：

```
/posts/_form.html.erb:9: syntax error, unexpected tSTRING_BEG, expecting ')'
/posts/_form.html.erb:9: unterminated string meets end of file 
```

我对rails很陌生，对formtastic也很陌生。似乎在 formtastic 行中嵌入对助手的调用会导致此语法错误。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:47:57.180

`random_title`是一个变量，对吧？

```
<%= form.input :title, :placeholder => random_title.html_safe %> 
```

问题是您`<%= %>`在另一个`<%= %>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:48:36.743

尝试这个：

```
<%= form.input :title, :placeholder => "#{random_title}".html_safe %> 
```

这应该有效。

# python - Python urllib 请求对象 - 在 GAE 上找出请求是 https 还是 http

> ID：12229946
> 
> 赞同：2
> 
> 时间：2012-09-01T17:40:59.707
> 
> 标签：python, google-app-engine, urllib2

Request 对象具有`url`属性，我可以做一个

```
request.url.startswith('https:') 
```

或者

```
request.url.startswith('http:') 
```

查看请求是否为`https`，但我想知道是否有更清洁/优雅的方式来执行此操作。

我正在 Google App Engine 上执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:57:53.570

GAE 上关于 webapps Request 对象的官方文档，没有提到任何称为协议的属性，所以很可能你需要使用你提到的技巧，或者类似的技巧

```
if request.url[4] == 's' 
```

这比你的更短更丑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T06:54:09.163

如果您使用的是 webapp2，则可以使用 request.scheme。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:17:37.253

你可以检查一下`request.environ.get('wsgi.url_scheme') == 'https'`，但你的方式对我来说似乎并不特别不干净。

# objective-c - 背景图像像素化

> ID：12229948
> 
> 赞同：0
> 
> 时间：2012-09-01T17:41:05.020
> 
> 标签：objective-c, image

我想在我的分组 UITableView 上有一个背景图像，所以我使用了代码：

```
self.tableView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"imageName.png"]]; 
```

但是图像是像素化的。我想我想更改内容模式，但由于它不是 UIImageView ......我似乎无法做到。

有没有另一种方法可以从 UIImageView 中为 UITableViewController 制作背景图像？

![这是正确的图像](../Images/86c997aa2d78d4ecea6cdf5f24a3b9a6.png)

![这是像素化图像](../Images/df0393795a4058872c37602da425c090.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:12:50.283

我创建了一个项目[Patterns](http://dl.dropbox.com/u/60414145/Patterns.zip)，您可以下载并将您的两个图像插入其中 - 它正确地抓取了视网膜 iPhone 模拟器的视网膜图像，以及普通设备的正常图像。将您的木质图像插入其中，看看它是否有效。假设它没有，那么您的图像有问题 - 将它们发布到 Dropbox。

如果它确实有效，那么您在项目中所做的事情是不正确的 - 您忘记在目标中包含视网膜图像等。

# vector - 两个 3D 向量之间的 X 角？

> ID：12229950
> 
> 赞同：6
> 
> 时间：2012-09-01T17:41:18.697
> 
> 标签：vector, geometry, coordinates, space, angle

我有两个名为 A 和 B 的 3D 向量，它们都只有一个 3D 位置。我知道如何使用 atan2 函数找到沿 0-360 度范围内的单位圆的角度，方法是：

编辑：（我的 atan2 函数没有意义，现在它应该找到 2 个向量之间的“y 角”）：

```
toDegrees(atan2(A.x-B.x,A.z-B.z))+180 
```

但这给了我两个向量之间的 Y 角。我需要找到它们之间的 X 角。它与使用 x、y 和 z 位置值有关。不仅仅是 x 和 z，因为这给出了两个向量之间的 Y 角。我需要 X 角，我知道这听起来很模糊，但我不知道如何解释。例如，如果您向上或向下看而不是旋转 x 轴，也许您在 3D 空间中有一个相机。但现在我需要得到两个向量之间的“上/下”角度。如果我沿 y 轴旋转该 3D 相机，x 轴不会改变。因此，对于 2 个向量，无论它们之间的“y 角”是多少，如果 y 角发生变化，两个向量之间的 x 角将保持不变，因为它是“上/下”角，就像在 camara 中一样.

请帮忙？我只需要一行数学/伪代码或解释。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T19:46:35.603

```
atan2(crossproduct.length,scalarproduct) 
```

使用 atan2 而不是 arccos 或 arcsin 的原因是准确性。arccos 在接近 0 度时表现非常糟糕。参数中的小计算错误将导致结果中不成比例的大错误。arcsin 在接近 90 度时也有同样的问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T21:40:37.277

# 计算高度角

好的，我可能终于明白了你在下面关于结果独立于*y*角的评论，以及它与两个向量的关系。您似乎对两个向量以及这*两个向量**之间*的角度并不真正感兴趣，而是对*差分向量*以及一个向量与水平面形成的角度感兴趣。在[水平坐标系中](http://en.wikipedia.org/wiki/Altitude_%28astronomy%29)（通常在天文学中使用），该角度将被称为“高度”或“仰角”，而不是您在（编辑的）问题中使用公式计算的“方位角”。“高度”与相机的“<a href="http://en.wikipedia.org/wiki/Tilt_%28camera%29" rel="noreferrer">倾斜”密切相关，而“方位角”与​​“ <a href="http://en.wikipedia.org/wiki/Panning_%28camera%29" rel="noreferrer">平移”。

我们仍然有一个二维问题。二维向量的一个坐标是差向量的*y*坐标。另一个坐标是向量在水平面上投影后的长度，即`sqrt(x*x + z*z)`。最终的解决方案是

```
x = A.x - B.x
y = A.y - B.y
z = A.z - B.z
alt = toDegrees(atan2(y, sqrt(x*x + z*z)))
az = toDegrees(atan2(-x, -z)) 
```

根据您在下面的评论，选择顺序（`A - B`而不是`B - A`）使得“A 高于 B”产生`y`正的高度，因此产生正的高度。上面方位角计算中的减号应该替换`+ 180`您问题代码中的，除了现在的范围是 [-180, 180] 而不是您的 [0, 360]。只是给你一个选择，选择你喜欢的。实际上，您计算`B - A`任一方式的方位角。您对这两个角度使用不同的顺序这一事实可能会有些混乱，因此请考虑这是否真的是您想要的，或者您是否想要反转高度的符号或将方位角更改 180°。

* * *

# 正交投影

*作为参考，我将在下面包含我的原始答案，对于那些实际上正在寻找围绕某个固定 x 轴的旋转角度的人，就像原始问题所建议的那样。*

如果您在问题中提到的这个*x 角度确实是围绕**x*轴的旋转角度，如相机示例所示，那么您可能想这样考虑：将*x*坐标设置为零，您最终会得到*yz*平面中的二维向量。您可以将其视为在所述平原上的正交投影。现在你又回到了一个二维问题，可以在那里解决它。

就个人而言，我只需调用`atan2`两次，每个向量调用一次，然后减去结果角度：

```
toDegrees(atan2(A.z, A.y) - atan2(B.z, B.y)) 
```

上`x=0`式中隐含的只是因为我只对`y`and进行操作`z`。

我还没有完全理解你的单次`atan2`调用背后的逻辑，但我必须考虑这么久的事实表明我不想维护它，至少在没有很好的解释性评论的情况下不会。

我希望我正确理解了您的问题，这就是您要寻找的东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-01T18:01:23.307

**就像 2D Vectors 一样，您可以通过求解其****点积**的 cos 来计算它们的角度

 **![3d 向量的点积](../Images/6bcb00fe1c6f012f88cfa85bd82ef710.png)
您不需要**atan**，您总是选择点积，因为它是向量的基本运算，然后使用**acos**来获取角度。

```
double angleInDegrees = acos ( cos(theta) ) * 180.0 / PI; 
```**

# android - 通过 url 从部分文本启动活动

> ID：12229954
> 
> 赞同：0
> 
> 时间：2012-09-01T17:42:18.667
> 
> 标签：android, textview

我是安卓新手。我想知道如何使一部分文本像 HTML 链接标签一样，而不是网页，而是启动一个活动。

在我的文本视图中，我需要放置指向其他活动的链接，问题是我的文本视图可以根据用户请求具有不同的文本，并且每个文本都有自己的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:16:56.783

您可以使用此代码将点击侦听器添加到文本视图，然后您可以在该`onClick()`方法中做任何您想做的事情。

```
SpannableString content = new SpannableString("this is spannable string");
        content.setSpan(new ClickableSpan() {

            @Override
            public void onClick (View widget)
            {
                Toast.makeText(Activity.this, "my text", Toast.LENGTH_SHORT).show();
            }
        }, 0, content.length(), 0);

        text.setMovementMethod(LinkMovementMethod.getInstance());
        text.setFocusable(true);
        text.setText(content); 
```

# javascript - 扩展 expressjs res 属性

> ID：12229959
> 
> 赞同：7
> 
> 时间：2012-09-01T17:43:31.217
> 
> 标签：javascript, node.js, express

目前我正在尝试向我的[expressjs](http://expressjs.com/)应用程序添加错误和通知功能。我以为通过打电话

```
app.use(function (req, res, next) {
  res.notice = function (msg) {
    res.send([Notice] ' + msg);
  }
}); 
```

通知功能将附加到我的应用程序中存在的所有 res 对象，使我能够按如下方式使用它：

```
app.get('something', function (req, res) {
  res.notice('Test');
}); 
```

但是，上面的示例不起作用。有没有办法完成我想做的事情？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T19:48:59.900

您需要`next`在将`notice`方法添加到`res`.

```
app.use(function (req, res, next) {
  res.notice = function (msg) {
     res.send('[Notice] ' + msg);
  }
  next();
}); 
```

并且您需要在路由定义之前添加此中间件。

更新：

您需要在路由器之前添加中间件。

```
var express = require('express');
var app = express();

app.use(function (req, res, next) {
    res.notice = function (msg) {
        res.send('[Notice] ' + msg);
    };
    next();
});

app.use(app.router);
app.get('/', function (req, res) {
    res.notice('Test');
});

app.listen(3000); 
```

# facebook - Facebook Graph API，检索用户上传的照片

> ID：12229963
> 
> 赞同：0
> 
> 时间：2012-09-01T17:43:50.717
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我试过这个：

```
SELECT pid, src, src_small, src_big, caption FROM photo WHERE aid IN (
    SELECT aid 
    FROM album 
    WHERE owner=207294952707407
)  ORDER BY created DESC 
```

但是有了这个，我只能获得相册中的照片（我上传的）

我想检索其他用户上传到我的主页墙上的照片。

什么是正确的 fql 查询？有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:02:52.327

好的，然后试试这个图

```
207294952707407?fields=posts.fields(picture) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:46:11.643

```
SELECT message,attachment,comments
FROM stream
WHERE source_id=YOUR_PAGE_ID AND filter_key="others" AND type="" 
```

我所做的就是用贴在墙上的图像来抓取用户的墙上消息，并且像魅力一样工作:-)

# c# - 为什么有些安卓平板不支持silverlight？

> ID：12229965
> 
> 赞同：0
> 
> 时间：2012-09-01T17:44:04.313
> 
> 标签：c#, silverlight, xaml, ipod-touch, nook

我正在使用 Silverlight 5 创建一个业务线应用程序。

该应用程序使用 MEF 作为依赖容器真的很棒。我很担心，因为我必须把这个 LOB 应用程序放到一些平板电脑中，比如 Nook B&N 平板电脑、KindleFire ......而且我发现这款平板电脑与 SL5 不兼容。

我不打算重写所有程序，但是我必须这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:49:49.863

这不是一个理想的解决方案，但如果您不想重写*完整*的应用程序，最好的选择是研究[Mono for Android](http://xamarin.com/monoforandroid)，它在 Kindle Fire 上运行良好，并且在基于 Android 的 Nook 上也应该这样做。

AFAIK 因为不支持 XAML，所以您需要为 Android 几乎完全重写您的 UI，但您的大部分业务相关逻辑应该是可重用的。

# ios - 获取按钮 setTitle 的更好方法？

> ID：12229968
> 
> 赞同：1
> 
> 时间：2012-09-01T17:44:40.590
> 
> 标签：ios, xcode

目前我正在这样做：

```
NSInteger senderTag = [sender tag]; 
```

但我真正想要的是按下按钮的标题/值而不是标签 ID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:46:19.500

您可以通过检查来获取按钮标签的文本

```
NSString *txt = [sender titleLabel].text; 
```

但是，这不如标签可靠，尤其是当您的应用更改标签上的文本以响应用户交互或由于选择新的语言环境时。

另请注意，要设置标签，您需要使用不同的方法：

```
[sender setTitle:@"Hello" forState:UIControlStateNormal]; 
```

# r - 在 ggplot 中指定地图的色阶

> ID：12229969
> 
> 赞同：21
> 
> 时间：2012-09-01T17:44:49.890
> 
> 标签：r, ggplot2

难以在 ggplot 中设置地图的色阶。我需要灰度。非常感谢我出错的地方。我还想知道是否有一种更有效的方法可以将颜色变量放入 ggplot（即，比将其附加到“强化”数据中）？

```
library(ggplot2)
states <- map_data("state")
var <- data.frame(table(states$region)) # using rows as a dummy variable
states$variable <- var$Freq[match(states$region,var$Var1)]

map <- ggplot(states, aes(x=long, y=lat)) + 
  geom_polygon(aes(group=group, fill=variable), col=NA,lwd=0)

map + scale_colour_gradient(low='white', high='grey20')
map + scale_colour_grey() 
```

![在此处输入图像描述](../Images/2709c03d4c0e4e5922c15b7df0a5f35f.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-01T17:46:58.290

你需要使用`scale_fill_*`而不是`scale_color_*`. 对于多边形几何形状，多边形的填充颜色与`fill`美学有关，而不是与`color`美学有关。一般来说，用于改变特定比例细节的函数是`scale_`审美名称`_`type_of_scale，例如`scale_fill_gradient`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T18:16:26.077

这段代码对我有用。

```
library(ggplot2)
states <- map_data("state")
var <- data.frame(table(states$region))
states$variable <- var$Freq[match(states$region,var$Var1)]
map <- ggplot(states, aes(x=long, y=lat,fill=variable,group=group)) + geom_polygon()
map + scale_fill_gradient(low='white', high='grey20') 
```

处理离散变量问题的一种简单方法是使用调色板功能创建“假”连续调色板。请参见下面的示例。

定义调色板，这里我使用了黑色和白色的十六进制代码，但你可以使用任何颜色

```
gs.pal <- colorRampPalette(c("#FFFFFF","#000000"),bias=.1,space="rgb") 
```

现在创建一些假数据

```
x <- rnorm(100)
dat <- data.frame(cbind(x))
dat$fac <- as.factor(sort(rep(1:5,20)))
dat$y <- x * as.numeric(dat$fac) 
```

接下来在这种情况下使用 ggplot 函数`scale_*`类型绘制它，`_manual`因为它的颜色在您使用`scale_colour_manual`但在您使用的上方`scale_fill_manual`

```
ggplot(dat,aes(x=x,y=y,colour=fac))+geom_point()+scale_colour_manual(values=gs.pal(5)) 
```

# php - 在没有 Packagist 的情况下使用 Composer

> ID：12229970
> 
> 赞同：10
> 
> 时间：2012-09-01T17:45:18.930
> 
> 标签：php, symfony, composer-php

例如，假设您想使用其他人的捆绑包，但想要进行一些修改。因此，您在一些新分支中进行修改，并配置 comspoer.json，如下所示：

```
{
    "require": {
        "sylius/assortment-bundle": "dev-soft-deleteable-products-disabled"
    },
    "repositories": [
        {
            "type": "package",
            "package": {
                "name": "sylius/assortment-bundle",
                "version": "1.0",
                "autoload": { "psr-0": { "Sylius\\Bundle\\AssortmentBundle": "" } },
                "target-dir": "Sylius/Bundle/AssortmentBundle",
                "source": {
                    "url": "https://github.com/umpirsky/SyliusAssortmentBundle.git",
                    "type": "git",
                    "reference": "soft-deleteable-products-disabled"
                }
            }
        }
    ]
} 
```

这适用于主分支，但对于自定义分支，它提供：`The requested package sylius/assortment-bundle dev-soft-deleteable-products-disabled could not be found.`

任何想法？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-01T18:52:28.287

您确实应该使用 VCS 存储库而不是包存储库。包适用于没有 composer.json 并且您想内联指定它的情况。在您的情况下，有一个 composer.json，因此您可以使用 VCS 存储库，如下所示：

```
"repositories": [
    {
        "type": "vcs",
        "url": "https://github.com/umpirsky/SyliusAssortmentBundle"
    }
] 
```

在这种情况下，Composer 将使用 GitHub API 来获取分支名称并检查版本是否`dev-soft-deleteable-products-disabled`存在。如果是这样，它将克隆存储库并签出所述分支。

希望如果您这样做是一种副作用，您的问题也将得到解决。

有关更多信息，请阅读[关于存储库的文档章节](http://getcomposer.org/doc/05-repositories.md)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T18:55:10.000

Satis 可以用作 Packagist 的微型版本 - 允许您集中控制私有存储库的 Composer 依赖项。

[Satis 使用作曲家指南](https://getcomposer.org/doc/articles/handling-private-packages-with-satis.md#satis)

# python - 索引numpy多维数组

> ID：12229972
> 
> 赞同：0
> 
> 时间：2012-09-01T17:45:29.553
> 
> 标签：python, arrays, numpy

我需要访问这个 numpy 数组，有时只有最后一列为 0 的行，有时是最后一列值为 1 的行。

```
y = [0  0  0  0
     1  2  1  1 
     2 -6  0  1
     3  4  1  0] 
```

我必须一遍又一遍地这样做，但宁愿避免创建重复的数组或每次都必须重新计算。有什么方法可以识别相关的索引并调用它们吗？这样我就可以做到这一点：

```
>>print y[LAST_COLUMN_IS_0] 
[0  0  0  0
3  4  1  0]

>>print y[LAST_COLUMN_IS_1] 
[1  2  1  1 
2 -6  0  1] 
```

PS 数组中的列数永远不会改变，它总是有 4 列。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T17:49:33.077

您可以使用 numpy 的布尔索引来[识别](http://www.scipy.org/Tentative_NumPy_Tutorial#head-d55e594d46b4f347c20efe1b4c65c92779f06268)要选择的行，并使用 numpy 的精美索引/切片来选择整行。

```
print y[y[:,-1] == 0, :]
print y[y[:,-1] == 1, :] 
```

您可以像往常一样保存`y[:,-1] == 0`，`... == 1`因为它们只是 numpy 数组。

（`y[:,-1]`选择整个最后一列，`==`相等性检查按元素进行，产生一个布尔数组。）

# asp.net-mvc-4 - 为什么在VS2012 MVC4项目骨架中默认启用runAllManagedModulesForAllRequests

> ID：12229973
> 
> 赞同：3
> 
> 时间：2012-09-01T17:45:38.750
> 
> 标签：asp.net-mvc-4

我注意到这`runAllManagedModulesForAllRequests`是`true`默认情况下在 VS2012 MVC4 项目框架中。有人知道为什么吗？什么功能需要这个设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T15:25:48.503

仅当您在 IIS 中以集成管道模式运行时，此设置才有效。如果您在经典模式下运行，它将被忽略。如果您将其设置为，`true`那么所有集成的 HTTP 模块都将在每个请求上运行。例如，不仅适用于 .aspx 页面，还适用于静态文件，例如 .jpg .gif .css .html .pdf，...因此启用此功能可能会对您的网站产生性能影响。

# objective-c - 如何在以编程方式创建的一系列 UILabel 对象的所有迭代中获得等效的功能

> ID：12229974
> 
> 赞同：-1
> 
> 时间：2012-09-01T17:45:46.170
> 
> 标签：objective-c, uilabel

高级问题：如何在 UIView 中以编程方式创建的一系列 UILabel 对象的所有迭代中获得等效的功能（以跨 CGIntersect 和第二个系列的 UILabel 运行）？

以编程方式创建的 UILabel 系列的所有实例都可以拥有等效的标题（self.MYUILABEL）并保留等效的功能吗？

我使用 for 循环以编程方式制作了一系列等效分类的 UILabel，但只有最后一个 UILabel 实例被分配了 UILabel 标题。

如何在 UIView 中以编程方式创建的一系列 UILabel 对象的所有迭代中获得等效的功能？

目标是通过触摸将一系列 UILabel 移动到第二系列 UILabel。

在我看来，这是我制作 UILabel（充当目标区域）的方式。

```
for (int i=0;i<characterCount ;i++){
    self.myBottomLabel=[[UILabel alloc] initWithFrame: CGRectMake((i*60.0)+10, 200.0, 50.0, 50.0)];
    self.myBottomLabel.backgroundColor = [UIColor whiteColor];
    self.myBottomLabel.text= [myword objectAtIndex:i];
    self.myBottomLabel.userInteractionEnabled = NO;
    self.myBottomLabel.tag=300+[[letterToNumber objectForKey:[myword objectAtIndex:i]] integerValue];
    [self.view insertSubview: self.myBottomLabel atIndex:(500)];
} 
```

当我尝试使用 self.myBottomLabel 使用 CGRectIntersectsRect 时，只有最后一个 UILabel 才能与 thisCGRect 使用的 self.myBottomLabel 标题一起正常工作：

```
theReceivingCard = [self.myBottomLabel convertRect:[self.myBottomLabel frame] toView:self.view]; 
```

这里几乎是所有的实现。我是否需要创建多个 CGRect（我不知道该怎么做）？或者有什么方法可以准确地找到这些 UILabel 的标签（当您将相应的 UILabel 移动到它们的顶部时，它们会变成交互式的？）

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSArray* myword=[NSArray arrayWithObjects:@"h",@"e",@"l",@"l",@"o",nil];

    NSDictionary *letterToNumber;
    letterToNumber = [NSDictionary dictionaryWithObjectsAndKeys:
                      @"0", @"a", 
                      @"1", @"b", 
                      @"2", @"c", 
                      @"3", @"d",
                      @"4", @"e", 
                      @"5", @"f", 
                      @"6", @"g", 
                      @"7", @"h", 
                      @"8", @"i", 
                      @"9", @"j", 
                      @"10", @"k", 
                      @"11", @"l", 
                      @"12", @"m", 
                      @"13", @"n", 
                      @"14", @"o", 
                      @"15", @"p", 
                      @"16", @"q", 
                      @"17", @"r", 
                      @"18", @"s", 
                      @"19", @"t", 
                      @"20", @"u", 
                      @"21", @"v", 
                      @"22", @"w", 
                      @"23", @"x", 
                      @"24", @"y", 
                      @"25", @"z", 
                      nil];    

NSUInteger characterCount = [myword count];

    //moveable
    for (int i=0;i<characterCount ;i++){
        self.myTopLabel=[[UILabel alloc] initWithFrame: CGRectMake((i*60.0)+10, 100.0, 50.0, 50.0)];
        self.myTopLabel.backgroundColor = [UIColor whiteColor];
        self.myTopLabel.text= [myword objectAtIndex:i];
        self.myTopLabel.userInteractionEnabled = YES;
        self.myTopLabel.tag=100+[[letterToNumber objectForKey:[myword objectAtIndex:i]] integerValue];
        [self.view insertSubview: self.myTopLabel atIndex:(1)];
    }

    //receiver
    for (int i=0;i<characterCount ;i++){
        self.myBottomLabel=[[UILabel alloc] initWithFrame: CGRectMake((i*60.0)+10, 200.0, 50.0, 50.0)];
        self.myBottomLabel.backgroundColor = [UIColor whiteColor];
        self.myBottomLabel.text= [myword objectAtIndex:i];
        self.myBottomLabel.userInteractionEnabled = NO;
        self.myBottomLabel.tag=300+[[letterToNumber objectForKey:[myword objectAtIndex:i]] integerValue];
        [self.view insertSubview: self.myBottomLabel atIndex:(500)];
    }

}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint locationPoint = [[touches anyObject] locationInView:self.view];
    UIView* viewYouWishToObtain = [self.view hitTest:locationPoint withEvent:event];

    [[viewYouWishToObtain superview] bringSubviewToFront:viewYouWishToObtain];

    if ([touch view] != viewYouWishToObtain && viewYouWishToObtain.tag >= 100 && viewYouWishToObtain.tag <= 200) {
        if ([touch tapCount] == 2) {
        }
        return;
    }
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];   
    CGPoint locationPoint = [[touches anyObject] locationInView:self.view];
    UIView* viewYouWishToObtain = [self.view hitTest:locationPoint withEvent:event];

    if ([touch view] == viewYouWishToObtain && viewYouWishToObtain.tag >= 100 && viewYouWishToObtain.tag <= 200) {
        CGPoint location = [touch locationInView:self.view];
        viewYouWishToObtain.center = location;      

        theMovingCard = [viewYouWishToObtain convertRect:[viewYouWishToObtain frame] toView:self.view];

        theReceivingCard =  [self.myBottomLabel convertRect:[self.myBottomLabel frame] toView:self.view];

        CGRect theZone = CGRectMake(theReceivingCard.origin.x, theReceivingCard.origin.y,theReceivingCard.size.width*2 , theReceivingCard.size.height*2);
        CGRect theCard = CGRectMake(theMovingCard.origin.x, theMovingCard.origin.y,theMovingCard.size.width*2 , theMovingCard.size.height*2);

            if(CGRectIntersectsRect(theCard, theZone))
            {
                NSLog(@"intersect");
            }
        return;
    }
} 
```

问题是在所有代码的末尾，intersect 仅在最后一个 UILabel 上起作用。我需要相交来处理所有充当接收器的 UILabel 系列。超级超级超级超级提前感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:18:30.977

您在循环中制作了大量标签，但您只有一个指向您创建的最后一个标签的指针，因为您将它们全部分配给同一个属性。我对您的其余问题并不完全清楚，但我认为您应该将这些标签添加到数组中，并在您进行命中测试等时遍历该数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T11:31:56.057

这是通过 for 循环迭代“如何以编程方式为多个 CGIntersect 为 UIView 子集匹配创建多个 CGRect 值”的答案。

这是完整的文件。它是一款支持 iOS 触控的纸牌游戏（如纸牌游戏）或火柴游戏（儿童教育）的基础。

该程序制作 10 张卡片，其中顶行必须与底行匹配。如果顶行卡片的文本与底行卡片相同，则 CGIntersect 将“命中”，您可以执行任何其他方法。

应该有更简单的方法来制作变量CGRect，但我找不到答案。如果有人能弄清楚如何不使用 NSMutableArray 和 for 循环来生成 CGrect 代码，那么如果您愿意分享，我将不胜感激。

。H

```
 #import <UIKit/UIKit.h>

    @interface ViewController : UIViewController

        @property NSString* currentCard;
        @property NSArray* myWord;
        @property NSString* myCurrentLetter;
        @property NSMutableArray* myMoverMutableArray;
        @property NSMutableArray* myReceiverMutableArray;

    @end 
```

.m

```
 #import "ViewController.h"

    @interface ViewController ()
    {
        int myLetterTagNumber;
    }
    @end

    @implementation ViewController

        @synthesize currentCard = _currentCard;
        @synthesize myWord = _myWord;
        @synthesize myCurrentLetter = _myCurrentLetter;
        @synthesize myMoverMutableArray = _myMoverMutableArray;
        @synthesize myReceiverMutableArray = _myReceiverMutableArray;

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        [self writer];
    }

    -(void)writer{

        self.myWord=[NSArray arrayWithObjects:@"l",@"i",@"l",@"l",@"y",nil];

        NSUInteger characterCount = [self.myWord count];

        self.myMoverMutableArray = [NSMutableArray arrayWithCapacity:characterCount];
        self.myReceiverMutableArray = [NSMutableArray arrayWithCapacity:characterCount];

        //moveable
        for (int i=0;i<characterCount ;i++){
            UILabel*myTopLabel;
            myTopLabel=[[UILabel alloc] initWithFrame: CGRectMake((i*60.0)+10, 100.0, 50.0, 50.0)];
            myTopLabel.backgroundColor = [UIColor whiteColor];
            myTopLabel.text= [self.myWord objectAtIndex:i];
            myTopLabel.userInteractionEnabled = YES;
            myTopLabel.textAlignment = UITextAlignmentCenter;
            myTopLabel.tag=100+i;
            [self.myMoverMutableArray addObject:[self.myWord objectAtIndex:i]];
            [self.view insertSubview: myTopLabel atIndex:(100)];
        }

        //receiver
        for (int i=0;i<characterCount ;i++){
            UILabel*myBottomLabel;
            myBottomLabel=[[UILabel alloc] initWithFrame: CGRectMake((i*60.0)+10, 200.0, 50.0, 50.0)];
            myBottomLabel.backgroundColor = [UIColor redColor];
            myBottomLabel.text= [self.myWord objectAtIndex:i];
            myBottomLabel.userInteractionEnabled = YES;
            myBottomLabel.textAlignment = UITextAlignmentCenter;
            myBottomLabel.tag=300+i;
            [self.myReceiverMutableArray addObject:[self.myWord objectAtIndex:i]];        
            [self.view insertSubview: myBottomLabel atIndex:(300)];
        }
    }

    - (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
        UITouch *touch = [touches anyObject];
        CGPoint locationPoint = [[touches anyObject] locationInView:self.view];
        UIView* viewYouWishToObtain = [self.view hitTest:locationPoint withEvent:event];

        //clipping
        [[viewYouWishToObtain superview] bringSubviewToFront:viewYouWishToObtain];

        myLetterTagNumber = viewYouWishToObtain.tag;
        UILabel * myTempUILabel = (UILabel*)[self.view viewWithTag:(myLetterTagNumber)];
        self.myCurrentLetter = myTempUILabel.text;

        NSLog (@"text: %@",myTempUILabel.text);
        NSLog (@"Tag: %d",myLetterTagNumber);

        if ([touch view] != viewYouWishToObtain && viewYouWishToObtain.tag >= 100 && viewYouWishToObtain.tag <= 200) {
            if ([touch tapCount] == 2) {
            }
            return;
        }
    }

    - (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
        UITouch *touch = [touches anyObject];

        CGPoint locationPoint = [[touches anyObject] locationInView:self.view];
        UIView* viewYouWishToObtain = [self.view hitTest:locationPoint withEvent:event];

        if ([touch view] == viewYouWishToObtain && viewYouWishToObtain.tag >= 100 && viewYouWishToObtain.tag <= 200) {
            CGPoint location = [touch locationInView:self.view];
            viewYouWishToObtain.center = location;

            //moving card rec
            CGRect theMovingCard;
            theMovingCard = [viewYouWishToObtain convertRect:[viewYouWishToObtain frame] toView:self.view];
            CGRect themovingRect = CGRectMake(theMovingCard.origin.x, theMovingCard.origin.y,theMovingCard.size.width*2 , theMovingCard.size.height*2);

            NSString *myTempString;
            NSUInteger characterCount = [self.myWord count];

            for (int i=0;i<characterCount ;i++){

                myTempString= [self.myReceiverMutableArray objectAtIndex:i];

                if (myTempString == self.myCurrentLetter){
                    UILabel * mytouchMoveUILabel = (UILabel*)[self.view viewWithTag:(i+300)];
                    CGRect theReceivingCard;
                    theReceivingCard =  [mytouchMoveUILabel convertRect:[mytouchMoveUILabel frame] toView:self.view];

                    CGRect spaceToHitRect = CGRectMake(theReceivingCard.origin.x, theReceivingCard.origin.y,theReceivingCard.size.width*2 , theReceivingCard.size.height*2);
                    if(CGRectIntersectsRect(themovingRect, spaceToHitRect))
                    {
                        NSLog (@"Intersect: %d",myLetterTagNumber);
                    }
                }//if
            }//for
            return;
        }
    }

    - (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
        UITouch *touch = [touches anyObject];
        // NSLog(@"3");

        CGPoint locationPoint = [[touches anyObject] locationInView:self.view];
        UIView* viewYouWishToObtain = [self.view hitTest:locationPoint withEvent:event];

        if ([touch view] == viewYouWishToObtain && viewYouWishToObtain.tag >= 100 && viewYouWishToObtain.tag <= 200) {
            return;
        }
    }

                - (void)viewDidUnload
                {
                    [super viewDidUnload];
                    // Release any retained subviews of the main view.
                }

                - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
                {
                    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
                        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
                    } else {
                        return YES;
                    }
                }

    @end 
```

# c# - 正确使用反射和绑定标志

> ID：12229977
> 
> 赞同：-1
> 
> 时间：2012-09-01T17:46:10.623
> 
> 标签：c#, reflection, bindingflags

我想修改下面的代码以便能够使用私有方法

```
 //use reflection to Load the data
    var method =
                    typeof(MemberDataFactory)
                    .GetMethod("LoadData")
                    .MakeGenericMethod(new [] { data.GetType() })
                    .Invoke(this, null); 
```

我试过以下没有运气：

```
 //use reflection to Load the data
    var method =
                    typeof(MemberDataFactory)
                    .GetMethod("LoadData")
                    .MakeGenericMethod(new [] { data.GetType() })
                    .Invoke(this, BindingFlags.Instance | BindingFlags.NonPublic, null , null, null); 
```

就这段代码而言，什么是“var”？我更喜欢指定它的类型而不是使用 var。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T17:55:17.427

你想使用[这个重载](http://msdn.microsoft.com/en-us/library/aa332483%28v=vs.71%29)，`Type.GetMethod()`这是你传递绑定标志的地方。默认`.GetMethod(string)`只查找公共方法，因此它返回 null，因此您的 null 引用异常。

您的代码应该更像：

```
var method =
        typeof(MemberDataFactory)
        .GetMethod("LoadData", BindingFlags.Instance | BindingFlags.NonPublic) // binding flags go here
        ... 
```

# python - python中三角形的用户输入

> ID：12229980
> 
> 赞同：0
> 
> 时间：2012-09-01T17:46:31.443
> 
> 标签：python

我想创建一个三角形并从用户那里获取用户输入。我已经创建了创建三角形的函数。

功能：

```
def triangle(rows):
    PrintingList = list()
    for rownum in range (rows ):     
        PrintingList.append([])
        for iteration in range (rownum):
            newValue = raw_input()
            PrintingList[rownum].append(newValue) 
```

但这需要以这种方式输入..

```
3 
7
4
2 
4 
6
8 
5 
9 
3 
```

我需要它接受这样的输入：

```
3 
7 4
2 4 6
8 5 9 3 
```

它如何改变它以这种方式接受输入？需要一些指导...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T17:50:52.387

```
for rownum in range (rows ):     
    PrintingList.append([])
    newValues = raw_input().strip().split()
    PrintingList[rownum] += newValues 
```

我在这里看不到您是否需要将输入从字符串转换为整数。但是如果您需要，这看起来像

```
for rownum in range (rows ):     
    PrintingList.append([])
    newValues = map(int, raw_input().strip().split())
    PrintingList[rownum] += newValues 
```

# django - 基数为 10 的 int() 的无效文字：'345/add/Caipirinha'

> ID：12229982
> 
> 赞同：0
> 
> 时间：2012-09-01T17:46:53.120
> 
> 标签：django, manytomanyfield

所以，我正在 Django 中开发一个栏标签应用程序，当它在标签中插入一些数据时，我得到了错误：

> /tabs/345/add/Caipirinha/ 处的 ValueError
> 
> 基数为 10 的 int() 的无效文字：'345/add/Caipirinha'

我已经尝试过之前在 Stackoverflow 上提供的一些解决方案，但没有成功。

以下是我的一些文件：

**模型.py**

```
class Tab(models.Model):
  number = models.IntegerField()
  name = models.CharField(max_length='50')
  tabdate = models.DateTimeField('date created')
  consumed = models.ManyToManyField(Product, through='ConsumedRelation')
  def __unicode__(self):
  return self.name

class ConsumedRelation(models.Model):
  tab = models.ForeignKey(Tab)
  product = models.ForeignKey(Product)
  count = models.PositiveIntegerField(blank=True, null=True, default=1)
  def __unicode__(self):
    return str(self.tab) + " | " + str(self.count) + " " + str(self.product) 
```

**视图.py**

```
def addproduct(request, tabnumber, product):
  tabnumber = Tab.objects.get(number=number)
  productadd = Product.objects.get(name=str(product))
  add = ConsumedRelation.objects.create(product=productadd, tab=tabnumber, count=1)
  add.save()
  context = {'tabnumber': tabnumber, 'product': productadd}
  return render_to_response('addproduct.html', context,     context_instance=RequestContext(request)) 
```

**添加产品.html**

```
{% for product in productlist %}
<a href="add/{{ product }}/"<li>{{ product }}</li></a>
{% endfor %} 
```

**网址.py**

```
url(r'^tabs/add/(?P<tabnumber>\d)/(?P<product>\d)/$', 'barcomandas.views.addproduct'), 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T17:52:43.570

您应该[`{% url %}`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#url)在模板中使用，以便 Django 生成正确的 URL。

```
<a href="{% url 'barcomandas.views.addproduct' tabnumber=sometabnumber product=product %}"<li>{{ product }}</li></a> 
```

# css - 谷歌地图全屏

> ID：12229988
> 
> 赞同：4
> 
> 时间：2012-09-01T17:47:52.407
> 
> 标签：css, google-maps

我试图让谷歌地图显示 100% 的宽度和高度。我搜索了几个示例，但无法使其正常工作。它的页面在这里

[http://o-meter.dk/geo2.html](http://o-meter.dk/geo2.html)

我在头脑中使用了这个 css

```
<style type="text/css">
html, body { height:100%; }
</style> 
```

这在地图 div 内联

```
<div id="map" style="width:100%; height:100%;">indenfor</div> 
```

地图不显示

如果我这样做

```
<div id="map" style="width:500px; height:500px;">indenfor</div> 
```

然后地图以 500x500 像素显示。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-02-12T19:42:25.940

我使用了以下CSS：

```
#map_canvas {
    width:100%;
    height:100%;
    position: absolute;
    top: 0px;
    left: 0px;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T18:00:19.593

地图需要高度和宽度。

```
<style type="text/css">
html, body { height:100%; width:100%;}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T17:54:10.710

尝试`min-height: 100%`在地图样式上使用`div`。

[http://www.tutwow.com/htmlcss/quick-tip-css-100-height/](http://www.tutwow.com/htmlcss/quick-tip-css-100-height/)

如果这不起作用，您还可以在 Javascript 中获取窗口的宽度和高度，然后动态设置地图元素上的样式以满足这些参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T17:55:08.083

有一个额外的样式标签，删除它：

```
<style type="text/css" media="screen">
<style type="text/css">
html, body { height:100%; }
</style> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T18:38:27.663

看来你解决了

```
#map { height : 100%; width : 100%; top : 0; left : 0; position : absolute; z-index : 200;} 
```

它之所以有效，是因为`map`没有带有`position:relative`的父级，因此它相对于窗口定位。

但是如果你想`map`相对定位到窗口，即使它有一个父级`position:relative`，你应该使用`position:fixed`而不是`position:absolute`。

而且，您不必使用如此庞大的`z-index`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-20T22:24:03.887

在下面的示例中，应用和`style="height: 100%;"`使谷歌地图全高，因为加载到的地图是. 在您的情况下，您需要添加到.`body``html``div``body``style="height: 100%;"``#map`

有关的：

[http://econym.org.uk/gmap/basic19.htm](http://econym.org.uk/gmap/basic19.htm)

[谷歌地图 API 基本示例](https://stackoverflow.com/questions/4431453/google-maps-api-basic-example/4442786#4442786)