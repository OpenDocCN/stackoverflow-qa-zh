# StackOverflow 问答 000080000-000080999

# java - 是我，还是 Eclipse 非常不可预测？

> ID：80021
> 
> 赞同：11
> 
> 时间：2008-09-17T04:32:57.250
> 
> 标签：java, eclipse, ide, editor

我最近开始在我的 Java servlet 项目中使用 Eclipse。我多年来一直在使用 jEdit，它是一个超级强大的文本编辑器。它具有语法突出显示，但没有任何特定于语言的功能，例如代码完成和智能重构。我发现这阻碍了我的工作效率。我*非常*想喜欢 Eclipse。我真的。但我不断遇到问题。

1.  现在 Eclipse 可以使用 ant 脚本进行构建，而不是仅仅从 ant 脚本创建自己的构建环境然后忽略对它的任何更改，我找到了一些在线指南并进行了设置。不过，它似乎还没有准备好迎接黄金时段。我的 ant 脚本从命令行构建得很好，但是我得到了所有这些构建错误，因为我需要告诉 Eclipse build.xml 中已经包含的所有这些东西，比如 CLASSPATH，以及外部 jar 的位置。
2.  当我让 Eclipse 运行太久，或者有时在我的笔记本电脑从休眠状态唤醒后，UI 开始崩溃。例如，编辑器窗格上的选项卡消失了，所以我一次只能编辑一个文件，它并没有说明它是哪个文件。
3.  我们遇到了几个没有重建本应重建类的情况，导致调试演练中的行号不准确和其他不可预测的行为（这不仅仅是我；与我一起尝试的其他两个开发人员看到了同样的事情）。
4.  我发现工作区与我的源代码位于不同的位置是一个巨大的麻烦。我还有其他需要编辑的文件（xml 文件等），并且对于我要在其中编辑文件的每个目录，我都需要设置一个特殊的条目，它甚至不会默认设置为我的源代码所在的位置到了。

其他人是否面临同样的问题？

有更好的选择吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T06:31:47.060

如果您将项目文件夹结构留给其管理，则 Eclipse 效果最佳。我们正在与 15 位开发人员合作开发一个包含数千个类以及更多 XML 和 .properties 文件的项目。

我同意 ANT 集成存在问题，因此对于生产和夜间构建，我推荐基于从 shell 启动的 ANT 脚本的外部构建系统。

但是，在 Eclipse 中工作时，请确保您启用了自动构建功能（默认情况下应该是，但检查不会造成伤害）。这应该使您不必担心要构建什么以及何时构建。有时（对我来说很少）当我必须切换自动构建、清理所有项目并通过菜单触发手动构建时会出现问题。有时我必须多次触发构建（不是清理！），但是一旦一切都重新构建，打开自动构建再次工作得很好。

至于长时间运行的实例：我的机器基本上一直（白天和黑夜）保持登录状态，并且至少有两个 Eclipse 实例一直在运行。我没有看到这些会议有任何问题，即使它们确实开放了数周。

在我使用 Eclipse 的 5 年中，我看到的大多数问题都源于安装了太多插件的人——我添加的唯一东西是 Checkstyle，“实现者插件”和我们正在使用的应用程序框架的一些专有东西。

也许您可以尝试以“通常的方式”使用相当干净的 Eclipse 安装一段时间（即，将源代码导入工作区文件夹）。

关于 NetBeans：我也经常使用它，但我认为这是个人喜好问题，我更喜欢 Eclipse。这对您来说可能会有所不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T04:35:41.113

我喜欢[IntelliJ](http://www.intellij.com)，但它是商业的。与它相比，Eclipse 感觉就像一个有缺陷的、半心半意的仿制品。以至于 IntelliJ 物有所值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T04:36:24.450

试用[NetBeans](http://www.netbeans.org/)

> 面向软件开发人员的免费、开源集成开发环境。您将获得使用 Java 语言、C/C++ 和 Ruby 创建专业桌面、企业、Web 和移动应用程序所需的所有工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T05:26:17.933

Eclipse 可能会发生很大的变化，尤其是来自文本编辑器或 Visual Studio 之类的东西

1.  尝试让 Eclipse 自己构建项目，而不需要 ant 的帮助。将 ant 留给手写的 build.xml 文件，以便从 eclipse 之外的命令行（例如，在您的构建/发布机器上）构建项目。

2.  内存不足？

3.  您是否在构建项目 w/ant 和让 Eclipse 也尝试构建项目之间来回切换？即，构建是否相互“战斗”？见 1。

4.  是的，你需要习惯的一件事……接受而不是对抗“日食方式”；你必须把你的工作源文件放在某个地方，那为什么不在 Eclipse 的工作区文件夹中呢？

希望有帮助/有意义

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T06:49:03.307

就像其他一些人已经建议的那样：除了 Eclipse，还有更多好的 Java IDE。Eclipse 的强项是插件系统。有很多可用的功能，其中一些确实非常好。也就是说：我现在不使用 Eclipse，而是使用 NetBeans。NetBeans 感觉不那么笨重，响应速度更快，感觉更干净。

当我的主要工作是 Java 编程时，我经常使用 IntelliJ。恕我直言，就编码而言，IntelliJ 击败了 NetBeans 和 Eclipse。它更快，具有更好的重构可能性、更好的搜索、快速导航和列表继续。

在很大程度上，选择一个 IDE 是一个品味问题，也是一个经验问题。很多人对他们认识的魔鬼感到更快乐……

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T11:37:37.433

对于问题 1，您可以为 Eclipse 设置自定义构建器。为此，请右键单击项目并选择属性。在左侧有一个名为 Builders 的项目，选择它。

根据您所说的，您将希望删除 Java 构建器并将其替换为新的 Ant 构建器。这可以通过单击新建并选择 Ant Builder 来完成。这将调出一些配置来填写。

在配置中，两个最重要的部分是 Main 选项卡中的 Build File 和 Targets 选项卡。

For issue 4, I would recommend having your project try to be independent of its location on disc. That way everything is in the same tree. Otherwise, the solution would be to setup external directories. From what it sounds like, not everything is in the same 'source tree', which brings up source control issues.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T04:38:03.917

部分，希望有帮助的答案

> 4 `. 我发现工作区与我的源代码位于不同的位置是一个巨大的麻烦。我还有其他需要编辑的文件（xml 文件等），并且对于我要在其中编辑文件的每个目录，我都需要设置一个特殊的条目，它甚至不会默认设置为我的源代码所在的位置到了。`

 `...如果需要，您可以配置工作区和源代码的位置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T04:40:53.067

我在 Eclipse 中的大部分时间都花在了 ColdFusion 上，所以我不能说 ANT 脚本或编译。我也注意到，如果 Eclipse 运行时间过长，则更有可能发生奇怪的事情。除此之外，大多数其他错误都可以通过确保我的 JRE 是最新版本来解决。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T11:30:38.060

正如其他人提到的，尝试 NetBeans，它与 Eclipse 相似，它是一个支持 IDE 的平台，并且是基于插件的。它的构建系统也已经基于 Ant，允许您利用各种扩展点。总的来说，我发现它也比 Eclipse 更稳定，但是 YMMV。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T18:58:04.147

We have eclipse manage things the way it wants, and use ant4eclipse (a set of ant tasks) for continuous builds. Works great!

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-15T03:26:32.833

Eclipse is a great tool. Hardly ever had problems with it in the many years that I've used it. It always amazes me how so many people can have problems with it. Then again, I'm using it as a fairly basic editor. I'm either lucky or my lack of problems stems from the fact that I'm not expecting it to be much more than a smart editor.

# asp.net - 什么会导致找不到 Web.sitemap？

> ID：80031
> 
> 赞同：3
> 
> 时间：2008-09-17T04:34:25.237
> 
> 标签：asp.net

我有一个 asp:menu 对象，我设置它使用*SiteMapDataSource*但是每次我尝试运行该站点时，我都会从 Firefox 得到一个黄色屏幕，说它找不到`web.sitemap`. 这是*站点地图数据源*和菜单的代码。Web.sitemap 文件位于网站的根目录中。

```
<div>
     <asp:Menu ID="MainMenu" CssClass="wTheme" Orientation="Horizontal" runat="server" DataSourceID="SiteMapDataSource1">
     </asp:Menu>
     <asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" SiteMapProvider="Web.sitemap" />
</div> 
```

这是 Web.sitemap 的样子：

```
<?xml version="1.0" encoding="utf-8" ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T04:40:00.107

我有一个类似的问题，我从我的 DataSource 控件中指定 SiteMap 的路径。我尝试删除它并且它有效。

尝试从 SiteMapDataSource 中删除路径并确保 web.sitemap 位于根目录中，看看是否可以修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T04:40:30.633

您需要在 web.config 中指定使用 XmlSiteMapProvider 并为其提供正确的 .sitemap 文件路径。

# java - 通过 UDP 传输字节缓冲区

> ID：80042
> 
> 赞同：3
> 
> 时间：2008-09-17T04:35:59.990
> 
> 标签：java, udp, datagram

您能否提供一个通过 UDP 数据报在两个 java 类之间传输的字节缓冲区的示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T04:44:13.417

这个怎么样 ？

```
导入 java.io.IOException；
导入 java.net.DatagramPacket；
导入 java.net.DatagramSocket；
导入 java.net.InetSocketAddress；

公共类服务器{

    公共静态 void main(String[] args) 抛出 IOException {
        DatagramSocket socket = new DatagramSocket(new InetSocketAddress(5000));
        字节[]消息=新字节[512]；
        DatagramPacket packet = new DatagramPacket(message, message.length);
        socket.receive(数据包);
        System.out.println(new String(packet.getData(), packet.getOffset(), packet.getLength()));
    }
}

```

```
导入 java.io.IOException；
导入 java.net.DatagramPacket；
导入 java.net.DatagramSocket；
导入 java.net.InetSocketAddress；

公共类客户{

    公共静态 void main(String[] args) 抛出 IOException {
        DatagramSocket 套接字 = 新的 DatagramSocket();
        socket.connect(新 InetSocketAddress(5000));
        byte[] message = "Oh Hai!".getBytes();
        DatagramPacket packet = new DatagramPacket(message, message.length);
        套接字.发送（数据包）；
    }
}

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T04:57:05.400

@没有任何

DatagramSocket 类确实需要改进，DatagramChannel 对客户端稍微好一点，但对服务器编程来说却很混乱。例如：

```
导入 java.io.IOException；
导入 java.net.InetSocketAddress；
导入 java.nio.ByteBuffer；
导入 java.nio.channels.DatagramChannel；

公共类客户{

    公共静态 void main(String[] args) 抛出 IOException {
        DatagramChannel 通道 = DatagramChannel.open();
        ByteBuffer buffer = ByteBuffer.wrap("Oh Hai!".getBytes());
        channel.send(buffer, new InetSocketAddress("localhost", 5000));
    }
}

```

带上[JSR-203](http://jcp.org/en/jsr/detail?id=203 "JSR-203")我说

# vba - 如何在口袋妖怪游戏中添加怪物？

> ID：80062
> 
> 赞同：6
> 
> 时间：2008-09-17T04:40:49.057
> 
> 标签：vba

我和我的朋友们正在开始一个像 Pokemon 这样的游戏，我们想知道我们将如何在游戏中添加怪物？我们使用 VisualBasic 是因为我朋友的兄弟说这样会更容易。

到目前为止，我们可以将怪物的图片放在屏幕上，你可以点击攻击和东西。

现在，当我们想要添加怪物时，我们必须创建一个新窗口。这将花费我们很长时间来为每种类型的怪物制作所有的窗口。是否有工具或其他东西可以使这更快？游戏公司如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T04:50:48.223

我认为最好的解决方案是制作一个通用窗口，它可以采用一些描述怪物的参数。

我不完全是最新的 VB，但在 OO 语言中，我们将有一个 Monster 基类，并继承来创建一个皮卡丘。基类将定义怪物拥有的基本事物（如图片、名称和类型）以及怪物可以做的事情（如攻击、逃跑等）。您甚至可以使用第二个级别，并为每种类型设置基类（例如 ElectricMonster 继承自 Monster，而 Pikachu 继承自 ElectricMonster）。

然后将 Monster 对象传递给窗口变得非常容易，并让窗口知道如何提取所有相关信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T04:49:01.503

我建议列出每个怪物所需的所有属性，并将所有这些属性存储在[MySQL](http://www.mysql.com/)之类的数据库中。这样您就不需要为每个怪物制作窗口，只需每次出现怪物时（在这种情况下，您只需从数据库中获取必要的信息）。

如果您不熟悉任何数据库，请查看[MySQL 教程](http://dev.mysql.com/doc/refman/5.0/en/tutorial.html)以开始学习。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T19:47:00.803

我认为最大的问题将是创建所有不同的角度（当角色转动时等）。您可以根据电视节目/纸牌游戏的不同帧开发角色的 3d 模型吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T21:29:54.987

我建议你应该尝试提取怪物可能拥有的各种属性。想想顶级王牌...

然后，您可以创建一个 Monster 类，其中每个属性由一个 Property/Field 表示。

就像是

```
Class Monster
    Public Name as String 
    Public Filename as String ' Location of graphics file on disk
    Public Strength as Integer 
    Public Speed as Integer 
    Public Sub New(Name as String, Filename as String, Strength as Integer, Speed as Integer)
        Me.Name = Name
        Me.Filename = Filename
        Me.Strength = Strength
        Me.Speed = Speed
    End Sub 
End Class 
```

然后你就可以创造出这样的怪物了。

```
Dim Monster1 as New Monster("monster1", "C:\Graphic1.jpg", 50, 10)  
Dim Monster2 as New Monster("monster2", "C:\Graphic2.jpg", 1, 100)  
Dim Monster3 as New Monster("monster3", "C:\Graphic3.jpg", 60, 17) 
```

但是您不需要每次都创建一个新的“窗口”。

同样，您将能够从其他地方获取“怪物”数据……例如数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T04:49:20.783

一旦你创建了你的作品，我会从硬盘动态加载它，而不是将它编译成一个大的 EXE。您可以使用 PictureBox 控件的 LoadPicture 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T04:50:17.570

你需要了解数据、数据结构和循环。你的怪物应该由数据组成，也许还有一些代码，然后你的怪物显示屏将根据这些数据和代码显示和操作一个怪物。

复制和粘贴小部件不适合您。学习从小部件中抽象数据和逻辑。

现在停止使用 VB 并去玩[http://scratch.mit.edu](http://scratch.mit.edu)它更合适。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T04:50:35.430

“当我们想要添加怪物时”是什么意思？你的意思是每个怪物都有一个单独的窗口，当那个怪物出现时会显示？建立在坐说的基础上；设计，设计，设计。Ad Hoc 设计方法不能扩展到最小的程序之外。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T05:21:22.813

您必须将怪物数据存储在文件或数据库中，然后从通用窗口加载它们。例如，您的硬盘中有一张皮卡丘的照片和一张球茎龙的照片。然后你用空白图片制作一个窗口，当你显示窗口时你告诉图片对象加载你需要的图片。

# c# - 最佳模拟库

> ID：80067
> 
> 赞同：16
> 
> 时间：2008-09-17T04:41:35.500
> 
> 标签：c#, asp.net-mvc, mocking

哪个是 C# 3.0/ASP.NET MVC 的最佳模拟库？为什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-17T04:43:30.830

[起订量](https://github.com/Moq/moq4)

太棒了，完全支持 C# 3.0 的新语言特性，而且很容易上手。我会极力推荐它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T04:44:39.453

很主观的问题。“最好”是什么意思？也许您应该提供更多有关您的情况的背景信息。

[RhinoMocks](http://www.ayende.com/projects/rhino-mocks.aspx)是最受欢迎的之一，至于它是否最适合您，谁知道呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T04:45:06.020

我现在正在经历这个过程，权衡它们以供我的团队使用，我也不得不说起订量，它似乎有最少的学习曲线和一些不错的功能，我喜欢使用起订量仿制药指定一个 Mock 类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:46:04.360

还有关于这个主题的其他帖子：

[可以同时执行 WebForms 和 MVC 的最佳模拟框架？](https://stackoverflow.com/questions/10098/best-mock-framework-that-can-do-both-webforms-and-mvc)

# javascript - 在Javascript中，为什么“this”运算符不一致？

> ID：80084
> 
> 赞同：30
> 
> 时间：2008-09-17T04:46:25.487
> 
> 标签：javascript

在 JavaScript 中，“this”操作符在不同的场景下可以指代不同的事物。

通常在 JavaScript“对象”中的方法中，它指的是当前对象。

但是当用作回调时，它会成为对调用对象的引用。

我发现这会导致代码出现问题，因为如果您使用 JavaScript“对象”中的方法作为回调函数，则无法判断“this”是指当前“对象”还是“this”是指调用对象。

有人可以澄清有关如何解决此问题的用法和最佳实践吗？

```
 function TestObject() {
            TestObject.prototype.firstMethod = function(){
                      this.callback();
                      YAHOO.util.Connect.asyncRequest(method, uri, callBack);

            }

            TestObject.prototype.callBack = function(o){
              // do something with "this"
              //when method is called directly, "this" resolves to the current object
              //when invoked by the asyncRequest callback, "this" is not the current object
              //what design patterns can make this consistent?
              this.secondMethod();
            }
            TestObject.prototype.secondMethod = function() {
             alert('test');
            }
        } 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-09-17T06:14:36.197

在我喋喋不休地谈论*这个*变量的神奇之处之前，对最佳实践的快速建议。如果您希望 Javascript 中的面向对象编程 (OOP) 与更传统/经典的继承模式密切相关，请选择一个框架，了解它的怪癖，不要试图变得聪明。如果你想变得聪明，把 javascript 作为一种函数式语言来学习，避免考虑类之类的东西。

这带来了关于 Javascript 的最重要的事情之一，并且在没有意义时重复给自己听。Javascript没有类。如果某些东西看起来像一个类，这是一个聪明的把戏。Javascript 有**对象**（不需要嘲讽的引号）和**函数**。（这不是 100% 准确，函数只是对象，但有时将它们视为独立的事物会有所帮助）

*this*变量附加到函数。每当你调用一个函数时，*它*都会被赋予一个特定的值，这取决于你调用函数的方式。这通常称为调用模式。

在javascript中有四种调用函数的方法。您可以将函数作为*方法*、*函数*、*构造函数*和*apply*调用。

## 作为一种方法

方法是附加到对象的函数

```
var foo = {};
foo.someMethod = function(){
    alert(this);
} 
```

当作为方法调用时，*this*将绑定到函数/方法所属的对象。在此示例中，这将绑定到 foo。

## 作为一个函数

如果你有一个独立的函数，*this*变量将绑定到“全局”对象，几乎总是浏览器上下文中的*窗口*对象。

```
 var foo = function(){
    alert(this);
 }
 foo(); 
```

**这可能是让你绊倒的原因**，但不要难过。许多人认为这是一个糟糕的设计决定。由于回调是作为函数而不是作为方法调用的，这就是为什么您会看到看似不一致的行为。

许多人通过做类似的事情来解决这个问题，嗯，这个

```
var foo = {};
foo.someMethod = function (){
    var that=this;
    function bar(){
        alert(that);
    }
} 
```

您定义一个*指向*this*的*变量。闭包（它自己的主题）一直`that`存在，所以如果你调用 bar 作为回调，它仍然有一个引用。

## 作为构造函数

您还可以调用函数作为构造函数。根据您使用的命名约定 ( `TestObject`)，这也**可能是您正在做的事情，也是让您绊倒的事情**。

`new`您使用关键字将函数作为构造函数调用。

```
function Foo(){
    this.confusing = 'hell yeah';
}
var myObject = new Foo(); 
```

当作为构造函数调用时，将创建一个新对象，并将*this*绑定到该对象。同样，如果您有内部函数并且它们被用作回调，您将把它们作为函数调用，并且*this*将绑定到全局对象。使用那个`var that = this;`技巧/模式。

有些人认为constructor/new关键字是Java/传统OOP程序员用来创建类似于类的东西的一种方式。

## 使用应用方法。

最后，每个函数都有一个名为`apply`. Apply 可以让你确定*this*的值是什么，还可以让你传入一个参数数组。这是一个无用的例子。

```
function foo(a,b){
    alert(a);
    alert(b);
    alert(this);
}
var args = ['ah','be'];
foo.apply('omg',args); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-17T04:54:52.643

在 JavaScript 中，`this`总是指调用正在执行的函数的对象。因此，如果函数被用作事件处理程序，`this`将引用触发事件的节点。但是，如果您有一个对象并在其上调用一个函数，例如：

```
myObject.myFunction(); 
```

然后`this`里面`myFunction`会提到`myObject`。是否有意义？

要绕过它，您需要使用闭包。您可以按如下方式更改代码：

```
function TestObject() {
    TestObject.prototype.firstMethod = function(){
        this.callback();
        YAHOO.util.Connect.asyncRequest(method, uri, callBack);
    }            

    var that = this;
    TestObject.prototype.callBack = function(o){
        that.secondMethod();
    }

    TestObject.prototype.secondMethod = function() {
         alert('test');
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T05:01:18.057

`this`对应于函数调用的上下文。对于不作为对象一部分调用的函数（无`.`运算符），这是全局上下文（`window`在网页中）。对于称为对象方法的函数（通过 . 运算符），它就是对象。

但是，你可以随心所欲地制作它。所有函数都有 .call() 和 .apply() 方法，可用于通过自定义上下文调用它们。因此，如果我像这样设置智利对象：

```
var Chile = { name: 'booga', stuff: function() { console.log(this.name); } }; 
```

...并调用 Chile.stuff()，它会产生明显的结果：

```
booga 
```

但如果我愿意，我可以接受并*真正搞砸它*：

```
Chile.stuff.apply({ name: 'supercalifragilistic' }); 
```

这个其实挺好用的……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:19:36.390

如果您使用的是 javascript 框架，则可能有一种方便的方法来处理此问题。例如，在 Prototype 中，您可以调用一个方法并将其范围限定为特定的“this”对象：

```
var myObject = new TestObject();
myObject.firstMethod.bind(myObject); 
```

注意：bind() 返回一个函数，所以你也可以用它来预定义类中的回调：

```
callBack.bind(this); 
```

[http://www.prototypejs.org/api/function/bind](http://www.prototypejs.org/api/function/bind)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T04:48:43.237

我相信这可能是由于 [closures]( [http://en.wikipedia.org/wiki/Closure_(computer_science)](http://en.wikipedia.org/wiki/Closure_(computer_science))的想法如何在 Javascript 中工作。

我自己刚刚开始掌握闭包。阅读链接的维基百科文章。

这是[另一篇](http://www.javascriptkit.com/javatutors/closures.shtml)包含更多信息的文章。

有没有人能证实这一点？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T04:53:49.433

一旦从其他上下文调用回调方法，我通常会使用我称之为回调上下文的东西：

```
var ctx = function CallbackContext()
{
_callbackSender
...
}

function DoCallback(_sender, delegate, callbackFunc)
{
 ctx = _callbackSender = _sender;
 delegate();
}

function TestObject()
{
   test = function()
  {
     DoCallback(otherFunc, callbackHandler);
  }

  callbackHandler = function()
{
 ctx._callbackSender;
 //or this = ctx._callbacjHandler;
}
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T05:04:42.650

您还可以使用 Function.Apply( *thisArg* , *argsArray* )... 其中 thisArg 确定函数内*this*的值...第二个参数是一个可选参数数组，您也可以将其传递给您的函数。

如果您不打算使用第二个参数，请不要将任何内容传递给它。如果您将*null*（或任何非数组）传递给 function.apply() 的第二个参数，Internet Explorer 将向您抛出 TypeError...

使用您提供的示例代码，它看起来像：

```
YAHOO.util.Connect.asyncRequest(method, uri, callBack.Apply(this)); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T10:02:27.880

如果你使用 Prototype，你可以使用[bind()](http://www.prototypejs.org/api/function/bind)和[bindAsEventListener()](http://www.prototypejs.org/api/function/bindAsEventListener)来解决这个问题。

# reporting - 最佳报告应用程序

> ID：80088
> 
> 赞同：3
> 
> 时间：2008-09-17T04:47:15.063
> 
> 标签：reporting

设计 Web 应用程序并使用水晶报告报告 iam。有时水晶报告会导致运行时错误。我该怎么做才能让我的报告更快。检索大约 1MB 的数据。这是月末销售报告。解决此问题的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T22:25:53.947

您可以使用**[i-net Clear Reports](http://www.inetsoftware.de/products/crystal-clear)**（以前是 i-net Crystal-Clear）。它可以读取 Crystal Reports 报表文件。这样，您无需重新设计报告。1 MB 的报告不是问题。我们有超过 100MB 的报告。它还有一个txt输出格式。

客户端报告也是可能的，但当然这有点复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T05:22:47.490

我对 CR 没有那么了解，所以这对我来说很难（我是 SSRS 粉丝）。所以你基本上是在要求我攻击我通常会推荐的东西。也许是一个艰难的命令，但这里有。

我从其他人那里得到的反馈（但他们比我聪明得多 :-) 是各种格式化选项/功能现在在水晶中更好。我必须在 SSRS 中处理自己的一个示例是操作日期 - （我听说）还有更多用于在 CR 中操作日期的函数。解决这个问题对某些人来说可能是微不足道的，但不是每个人，也不是我。

还有什么 - 我相信，导出到单词在 CR 中可用，而不是在 SSRS 中。此外，我相信在 CR 中组合数据集结果至少更容易一些。这些在新发布的 2008 版本中可能会更好/

同样，请记住，这更多是基于我偶尔抱怨 SSRS 时被告知的内容——不过我仍然非常喜欢它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T04:58:36.923

您没有注意到您使用的是什么数据库平台，但如果它是基于 MSSQL 的，您可能想尝试使用嵌入式 SQL Reporting Services Reporting。我们发现功能方面它不能做所有水晶可以做的事情，但它易于使用、免费，并且没有我们在水晶中遇到的一些烦人的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:06:37.217

我很想听听您认为 CR 能做什么，而 SSRS 不能。仅包括替代策略无法轻易实现的功能。排除仅在精心设计的供应商演示中有效的“功能”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T22:35:10.370

我要做的第一件事是确保您的查询正确且快速地用完您的报告工具。我还会查看表上的索引并调整查询，可能会创建一个视图来包含数据或其中的一些数据以帮助加快流程

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T20:49:20.697

我使用水晶报告的原因是因为我必须将报告打印到 LG Matrix 打印机中，基本上我必须以文本格式导出报告。我真的不知道在 SSRS 中怎么做，但我发现在水晶报告中更容易。这是我必须切换回水晶的主要原因。如果有人可以建议我替代选择，那么我可以在我的应用程序中尝试。我想做客户端报告而不是服务器端。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T04:51:27.223

1Mb 听起来对于报告来说数据太多了 - 我会尝试在服务器上对其进行更多过滤

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-12T21:08:57.423

您没有提供任何细节，但[如何提高您的报告速度](http://www.sql-reports.net/2011/02/how-to-turbo-charge-your-report-speed.html)有一些一般性建议来提高您的速度。（免责声明 - 我写了博客条目。）

# ruby - 区分一个红宝石字符串或数组

> ID：80091
> 
> 赞同：58
> 
> 时间：2008-09-17T04:47:35.453
> 
> 标签：ruby, diff

如何在 Ruby 中对两个字符串或数组进行比较？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-17T04:53:09.263

对于数组，使用减号运算符。例如：

```
>> foo = [1, 2, 3]
=> [1, 2, 3]
>> goo = [2, 3, 4]
=> [2, 3, 4]
>> foo - goo
=> [1] 
```

在这里，最后一行从 foo 中删除了也在 goo 中的所有内容，只留下元素 1。我不知道如何对两个字符串执行此操作，但在知道有关它的帖子之前，您可以将每个字符串转换为数组，使用减号运算符，然后将结果转换回来。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-06-30T03:40:30.997

我对 ruby​​ 中缺少一个好的库感到沮丧，所以我写了[http://github.com/samg/diffy](http://github.com/samg/diffy)。它`diff`在幕后使用，专注于方便，并提供漂亮的输出选项。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-17T04:52:15.083

diff.rb 是你想要的，可以在~~[http://users.cybercity.dk/~dsl8950/ruby/diff.html](http://users.cybercity.dk/~dsl8950/ruby/diff.html)~~通过互联网档案：

[http://web.archive.org/web/20140421214841/http://users.cybercity.dk:80/~dsl8950/ruby/diff.html](http://web.archive.org/web/20140421214841/http://users.cybercity.dk:80/~dsl8950/ruby/diff.html)

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-01-06T11:11:34.140

对于字符串，我会首先尝试@sam-saffron 下面提到的 Ruby Gem。它更容易安装：http: [//github.com/pvande/differ/tree/master](http://github.com/pvande/differ/tree/master)

```
gem install differ

irb
require 'differ'

one = "one two three"
two = "one two 3"

Differ.format = :color
puts Differ.diff_by_word(one, two).to_s

Differ.format = :html
puts Differ.diff_by_word(one, two).to_s 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-07T02:40:10.227

也有`diff-lcs`可以作为宝石使用的。~~它自 2004 年以来一直没有更新，但~~我们一直在使用它，没有任何问题。

**编辑：** 2011 年发布了一个新版本。看起来它又回到了积极的开发中。

[http://rubygems.org/gems/diff-lcs](http://rubygems.org/gems/diff-lcs)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-10T23:32:52.247

@da01 上面提到的 HTMLDiff 对我有用。

```
script/plugin install git://github.com/myobie/htmldiff.git

# bottom of environment.rb
require 'htmldiff'

# in model
class Page < ActiveRecord::Base
  extend HTMLDiff
end

# in view
<h1>Revisions for <%= @page.name %></h1>
<ul>
<% @page.revisions.each do |revision| %>
  <li>
    <b>Revised <%= distance_of_time_in_words_to_now revision.created_at %> ago</b><BR>
      <%= Page.diff(
        revision.changes['description'][0],
        revision.changes['description'][1]
      ) %>
      <BR><BR>
  </li>
<% end %>

# in style.css
ins.diffmod, ins.diffins { background: #d4fdd5; text-decoration: none; }
del.diffmod, del.diffdel { color: #ff9999; } 
```

看起来还不错。顺便说一句，我用这个`acts_as_audited`插件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-07-26T17:50:20.707

```
t=s2.chars; s1.chars.map{|c| c == t.shift ? c : '^'}.join 
```

这条简单的线给出了`^`不匹配的位置。这通常就足够了，并且可以复制/粘贴。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-31T05:10:21.853

我刚刚发现了一个看起来非常灵活的新项目：

[http://github.com/pvande/differ/tree/master](http://github.com/pvande/differ/tree/master)

尝试一下，并会尝试发布某种报告。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-10-02T21:27:06.670

我也有同样的疑问，我发现的解决方案不是 100% 红宝石，但对我来说是最好的。diff.rb 的问题在于它没有漂亮的格式化程序，无法以人性化的方式显示差异。所以我用这个代码从操作系统中使用了差异：

```
 def diff str1, str2
   system "diff #{file_for str1} #{file_for str2}"
 end

 private
 def file_for text
   exp = Tempfile.new("bk", "/tmp").open
   exp.write(text)
   exp.close
   exp.path
 end 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-02-03T17:53:52.720

只是为了 Windows 人的利益：diffy 看起来很棒，但我相信它只会在 *nix 上工作（如果我错了，请纠正我）。当然，它在我的机器上不起作用。

不同对我来说是一种享受（Windows 7 x64，Ruby 1.8.7）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-07-07T12:43:26.100

也许 Array.diff 通过猴子补丁可以帮助...

[http://grosser.it/2011/07/07/ruby-array-diffother-difference-between-2-arrays/](http://grosser.it/2011/07/07/ruby-array-diffother-difference-between-2-arrays/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-08-08T15:28:50.493

为了逐个字符解析，我向[damerau-levenshtein gem添加了一个新功能](https://rubygems.org/gems/damerau-levenshtein)

```
require "damerau-levenshtein"
differ = DamerauLevenshtein::Differ.new
differ.run "Something", "Smothing"
# returns ["S<ins>o</ins>m<subst>e</subst>thing", 
#  "S<del>o</del>m<subst>o</subst>thing"] 
```

或解析：

```
require "damerau-levenshtein"
require "nokogiri"

differ = DamerauLevenshtein::Differ.new
res = differ.run("Something", "Smothing!")
nodes = Nokogiri::XML("<root>#{res.first}</root>")

markup = nodes.root.children.map do |n|
  case n.name
  when "text"
    n.text
  when "del"
    "~~#{n.children.first.text}~~"
  when "ins"
    "*#{n.children.first.text}*"
  when "subst"
    "**#{n.children.first.text}**"
  end
end.join("")

puts markup 
```

# icalendar - iCal 格式 - 管理器属性

> ID：80101
> 
> 赞同：4
> 
> 时间：2008-09-17T04:50:31.843
> 
> 标签：icalendar, rfc2445, rfc5545

我目前正在编写一个松散地基于 iCalendar 标准的调度应用程序。有谁知道我可以在哪个属性中存储事件创建者的信息？通过浏览 iCalendar RFC 2445，我发现了这个属性：[Organizer](http://www.kanzaki.com/docs/ical/organizer.html)。即使他/她是唯一参与活动的人，我可以将活动创建者的信息存储在属性中吗？或者已经有一个字段来存储事件创建者的信息？？？！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T05:16:20.970

来自 rfc2445 的一些注释

一致性：该属性必须在指定组计划日历实体的 iCalendar 对象中指定。此属性必须在指定日历用户忙碌时间的发布的 iCalendar 对象中指定。此属性**不得**在仅指定时区定义或定义日历实体的 iCalendar 对象中指定，这些**日历实体不是组计划实体，而是仅在单个用户的日历上的实体**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T04:54:34.673

`ORGANIZER;CN="Sally Example":mailto:sally@example.com`

看起来像答案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T08:52:52.643

我正在研究一个类似的应用程序，关注事件跟踪和处理，并得出与 Jeffrey04 相同的结论。

具体来说，为了表示警告或警报，使用 VJOURNAL 组件似乎是合适的，因为事件是过去的，可能会一直持续到现在，但肯定不是会议。VJOURNAL 也不占用日历上的空间。恕我直言，代表发起者的最佳字段是**X-WR-RELCALID**，它不是 RFC5545，但似乎符合创建者 UID 的想法。我会将其链接到 vCard UID。

我不明白为什么事件创建者的想法对于 iCal 规范的编写者来说并不重要。

# windows - 检测“克隆模式”显示设置

> ID：80103
> 
> 赞同：1
> 
> 时间：2008-09-17T04:50:36.930
> 
> 标签：windows, multiple-monitors

如何在 Windows 上不使用 COPP（计算机输出保护协议）或 OPM（输出保护协议）来确定我的显示器是否处于“克隆模式”？

远景解决方案：

```
hMonitor = MonitorFromWindow (HWND_DESKTOP, MONITOR_DEFAULTTOPRIMARY);
bSuccess = GetNumberOfPhysicalMonitorsFromHMONITOR (hMonitor,  &dwMonitorCount); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T08:02:10.837

我假设您已经尝试过 EnumDisplayMonitors() 并且它没有用。因此，如果为每组克隆显示器返回一个 HMONITOR，您可以将这组结果与 EnumDisplayDevices() 的结果进行比较。EnumDisplayDevices() 返回的*连接*到桌面但未*由*EnumDisplayMonitors() 返回的设备应该是克隆的。

# java - 分发 Java 应用程序的最佳方式是什么？

> ID：80105
> 
> 赞同：119
> 
> 时间：2008-09-17T04:50:50.313
> 
> 标签：java, installation, jar, software-distribution

Java 是我选择的编程语言之一。尽管将我的应用程序分发给最终用户，但我总是遇到问题。

给用户一个 JAR 并不总是像我希望的那样用户友好，使用 Java WebStart 需要我维护一个 Web 服务器。

分发 Java 应用程序的最佳方式是什么？如果 Java 应用程序需要将工件安装到用户的计算机上怎么办？有没有好的 Java 安装/打包系统？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-09-17T06:45:54.263

有多种解决方案，具体取决于您的分发要求。

1.  只需使用一个罐子。这假定用户安装了正确的 java 版本，否则用户将得到“类文件格式版本”异常。这对于公司内部的内部分发来说很好。

2.  使用 launch4j 和 NSIS 之类的安装程序。这给了你更多的控制权，尽管用户仍然可以做一些愚蠢的事情，比如卸载 java 运行时。这可能是最流行的方法，也是我目前使用的。

3.  使用网络启动。这也假设用户安装了正确的 java 版本，但它更容易上手。我的经验是，这对于严格控制的 Intranet 环境来说很好，但是对于更大的部署来说会变得很痛苦，因为它有一些奇怪的故障。使用 Java 1.7 中的新插件技术可能会变得更好。

4.  使用 Excelsior JET 等本机代码编译器并将其作为可执行文件分发，或将其包装在安装程序中。昂贵，而且它通常将您与稍旧的 java 版本联系起来，并且动态类加载有些痛苦，但它对于需要最大程度地减少支持麻烦的大规模部署非常有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T06:45:44.577

[高级安装程序](http://www.advancedinstaller.com/)可以轻松地将 Java 应用程序打包为 Windows 可执行文件，并且它的设置方式非常灵活。我发现要将 Java 应用程序分发到 Windows 客户端，这是最简单的方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-21T20:10:32.900

[JSmooth](http://jsmooth.sourceforge.net/)是一个简单的程序，它可以获取你的 jar 并将其包装在一个标准的 Windows 可执行文件中。它带有一个简单的 GUI，允许您配置所需的 JVM，将其与应用程序捆绑在一起，或者在尚未安装时提供下载它的选项。您可以按原样发送 exe 文件或使用可能的依赖项对其进行压缩（或让程序在启动时从网络下载额外的依赖项）。它也是免费的，就像啤酒和演讲一样，这可能（也可能不是）是一件好事。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T05:00:54.767

如果它是一个真正的具有 GUI 的最终用户应用程序，您应该忽略您编写程序的语言 (Java)，并为您选择的每个平台使用本机安装程序。Mac 用户想要一个 .dmg，而在 Windows 上一个 .msi 或 .exe 安装程序是可行的方法。在 Windows 上，我更喜欢 NullSoft 的 NSIS，只是因为它比 InstallShield 或 InstallAnywhere 不那么令人反感。在 OSX 上，您可以指望 JVM 已经存在。在 Windows 上，如有必要，您需要为他们检查并安装它。Linux 人员不会运行 Java GUI 应用程序，而少数会运行可执行 .jar 的人知道如何处理。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-18T12:07:53.930

这取决于您的目标用户的复杂程度。在大多数情况下，您希望将它们与您正在运行基于 Java 的应用程序的事实隔离开来。给他们一个本机安装程序，它可以做正确的事情（创建开始菜单条目、启动器、注册添加/删除程序等）并且已经捆绑了 Java 运行时（因此用户不需要知道或关心它）。我想推荐我们的跨平台安装工具，[BitRock InstallBuilder](http://bitrock.com). 虽然它不是基于 Java 的，但它通常用于打包 Java 应用程序。它可以很容易地与 Ant 集成，您可以从 Unix/Linux/Mac 构建 Windows 安装程序，反之亦然。因为生成的安装程序是本机的，所以它们不需要自解压步骤或 JRE 就已经存在于目标系统中，这意味着安装程序更小，并为您省去了一些麻烦。我还想提一下，我们有开源项目的免费许可证

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T12:57:49.603

虽然我自己没有使用过[NSIS](http://nsis.sourceforge.net/ "国家安全情报局")（Nullsoft Scriptable Installer System），但是有一些安装脚本会检查目标系统上是否安装了所需的 JRE。

[代码示例](http://nsis.sourceforge.net/Category:Code_Examples "代码示例")和[真实世界安装程序](http://nsis.sourceforge.net/Category:Real_World_Installers "真实世界的安装程序")页面提供了许多示例脚本，例如：

*   [具有自动 JRE 安装的 Java 启动器](http://nsis.sourceforge.net/Java_Launcher_with_automatic_JRE_installation "具有自动 JRE 安装的 Java 启动器")
*   [简单的 Java 运行时下载脚本](http://nsis.sourceforge.net/Simple_Java_Runtime_Download_Script "简单的 Java 运行时下载脚本")

（请注意，我实际上并没有使用任何脚本，所以请不要将其视为背书。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T04:55:34.763

可执行文件是最好的，但它们受平台限制，即使用 gcj : [http://gcc.gnu.org/java/](http://gcc.gnu.org/java/)用于 linux 生成可执行文件并使用 launch4j : [http://launch4j.sourceforge.net/](http://launch4j.sourceforge.net/)生成 Windows 可执行文件。要在 linux 上打包，您可以使用任何 rpm 或 deb 打包程序。对于 win32 尝试[http://en.wikipedia.org/wiki/Nullsoft_Scriptable_Install_System](http://en.wikipedia.org/wiki/Nullsoft_Scriptable_Install_System)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-26T21:37:14.683

我需要一种方法将我的项目及其依赖项打包到一个 jar 文件中。

我使用 Maven2 Assembly 插件找到了我需要的东西：[Maven2 Assembly plugin](http://maven.apache.org/plugins/maven-assembly-plugin/descriptor-refs.html#jar-with-dependencies)

这似乎复制了[one-jar](http://one-jar.sourceforge.net/)的功能，但不需要额外的配置即可。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T04:55:29.367

对于简单的 Java 应用程序，我喜欢使用 Jar's。分发一个用户只需单击即可（Windows）的文件非常简单，或者

```
java -jar jarname.jar 
```

恕我直言，当简单是主要要求时，jar 是要走的路。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T07:48:16.067

我开发 Eclipse RCP 应用程序。通常，要启动 Eclipse 应用程序，会包含一个可执行启动器。我将 java 虚拟机包含在 /jre 子目录中的应用程序文件夹中，以确保使用正确的 java 版本。

然后我们用 Inno Setup 打包安装在用户的机器上。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-10T09:22:41.047

> 分发 Java 应用程序的最佳方式是什么？如果 Java 应用程序需要将工件安装到用户的计算机上怎么办？有没有好的 Java 安装/打包系统？

根据我的经验（通过[评估多个选项](https://stackoverflow.com/questions/759855/what-are-good-installanywhere-replacements-for-installing-a-java-ee-application/786307#786307)），[install4j](http://www.ej-technologies.com/products/install4j/overview.html)是一个很好的解决方案。它为任何平台创建本机安装程序，专门用于安装 Java 应用程序。有关详细信息，请参阅其网站上的“[功能”。](http://www.ej-technologies.com/products/install4j/features.html)

不过 install4j 是一个商业工具。特别是如果您的需求相对简单（只需分发应用程序并安装一些工件），还有许多其他不错的选择，包括免费的（如[izPack](http://izpack.org/)或已经提到的[Lauch4j](http://launch4j.sourceforge.net/)）。但是您要求*最好*的方法，据我目前的知识， install4j 就是一种，尤其是用于分发更大或更复杂的 Java (EE) 应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T04:58:58.577

最佳答案取决于平台。对于 Windows 上的部署，我使用[one-jar](http://one-jar.sourceforge.net/)和[launch4j](http://launch4j.sourceforge.net/)的组合取得了不错的效果。正确设置我的构建环境确实需要一些时间（主要是 ant 脚本），但现在它相当轻松。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T06:24:55.283

嗯，从我的角度来看，优越的分发机制是使用[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)或[WebStart](http://en.wikipedia.org/wiki/Webstart)技术之类的东西。您只需将版本部署到服务器，并在版本发布时自动发送到客户端。Eclipse RCP 平台还包含 UpdateManager，它可以做 WebStart 的工作，但还有更多。

由于我使用 Maven2 进行构建，因此部署只是小菜一碟：将构建的 jar 复制到服务器上的位置，如果需要更新 jnlp 文件，就完成了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-24T12:53:42.707

installanywhere 很好但很贵 - 我还没有找到好的免费的

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-09-17T08:08:53.817

我会将 jar 文件与其他依赖的 jar、配置文件和文档以及 run.bat/run.sh 一起压缩。最终用户应该能够将其解压缩到任何位置并在需要时编辑 run.bat（在大多数情况下它应该在不编辑的情况下运行）。如果您想在开始菜单、桌面、系统托盘等中创建条目，安装程序可能会很有用。

作为用户，我更喜欢解压缩并运行安装（请不要输入开始菜单）。然而，IT 行业以外的人可能有不同的偏好。因此，如果应用程序主要针对开发人员 zip-run.bat 路线，而面向公众的应用程序可以使用安装程序进行安装。

# xml - XML-RPC 和 SOAP 有什么区别？

> ID：80112
> 
> 赞同：81
> 
> 时间：2008-09-17T04:52:16.753
> 
> 标签：xml, web-services, soap, xml-rpc

我从来没有真正理解为什么 Web 服务实现者会选择其中一个。XML-RPC 通常出现在旧系统中吗？任何帮助理解这一点将不胜感激。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-09-18T00:23:58.183

差异？

SOAP 功能更强大，并且受到软件工具供应商（MSFT .NET、Java 企业版等）的青睐。

SOAP 长期以来（2001-2007 年）被视为 SOA 的首选协议。xml-rpc 没那么多。REST 是新的 SOA 宠儿，尽管它不是协议。

SOAP 更冗长，但功能更强大。

一些较旧的东西不支持 SOAP。例如，没有经典 ASP 的 SOAP 库（我能找到）。

SOAP 在 python 中没有得到很好的支持。XML-RPC 在标准库中对 python 有很好的支持。

SOAP 支持文档级传输，而 xml-rpc 更多的是关于值传输，尽管它可以传输结构、列表等结构。

xm-rpc 实际上是关于程序到程序语言不可知的传输。它主要通过http/https。SOAP 消息也可以通过电子邮件发送。

xml-rpc 更加统一。它使您可以简单地做事，并且当您知道自己在做什么时，即使使用终端文本编辑器，也可以非常快速地部署高质量的 Web 服务。那样做 SOAP 简直就是动物园。你真的需要一个好的 IDE 才能让它变得可行。

但是，如果您正在争取财富 500 强的 IT 工作，那么了解 SOAP 会在您的简历/CV 上看起来更好。

xml-rpc 在非 ascii 字符集方面存在一些问题。

XML-RPC 不支持命名参数。它们的顺序必须正确。不确定 SOAP，但可以这么想。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-17T05:00:51.053

只是为了添加其他答案，我鼓励您查看 SOAP 和 XML-RPC 调用的实际文本表示，也许通过使用 Ethereal 捕获一个。除非您看到 SOAP 调用是多么冗长，否则整个“XML-RPC 更简单”的论点没有多大意义。许多相当流行的网站都回避 SOAP 作为他们的 API，因为如果人们开始广泛使用它会消耗大量带宽。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T04:56:19.160

[Kate Rhodes 在http://weblog.masukomi.org/2006/11/21/xml-rpc-vs-soap](http://weblog.masukomi.org/2006/11/21/xml-rpc-vs-soap)上有一篇关于差异的精彩文章

# tfs - Cruise Control .Net 与 Team Foundation 构建

> ID：80120
> 
> 赞同：23
> 
> 时间：2008-09-17T04:53:50.883
> 
> 标签：tfs, continuous-integration, build-automation, cruisecontrol.net, build

我们的团队正在设置夜间和持续集成构建。我们拥有 Team Foundation Server，可以使用 Team Foundation Build。我更熟悉 CC.Net 并以这种方式精益求精，但管理层看到了花在 TFS 上的所有资金并希望使用它。

我更喜欢 CC.Net 的一些地方是通知的灵活性以及实现自定义脚本的简易性。

如果您对这两种产品都有经验，您更喜欢哪一种，为什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-17T05:16:03.920

我都用过。我想这取决于您的组织的价值观。

既然你对CC Net很熟悉，我就不多说了。你已经知道是什么让它很酷了。

**以下是我喜欢 Team Foundation Build 的地方：**

*   构建代理。将任何盒子变成构建机器并在其上运行构建非常简单。MSFT 做对了。
*   报告。所有相关的构建结果（包括测试）都存储在 SQL 数据库中，并通过 SQL Server Reporting Services 进行报告。这是一个非常强大的工具，用于绘制随时间变化的构建和测试结果。CC Net 没有内置此功能。
*   您可以通过 MSBUILD 进行类似的自定义。与使用 NAnt 和 CC Net 基本相同

**以下是让我对 Team Foundation Build 不屑一顾的原因：**

*   要构建 C++/CLI 项目（或运行单元测试...？），构建代理必须安装 VSTS Dev 或 Team Suite。朋友们，这简直是疯了。
*   它必须连接到 TFS Mothership

如果你在一个有很多老板的大组织中，他们有大量预算和喜欢报告（不要误会我的意思，这具有巨大的价值）或者你需要扩大到一个多机器构建农场，我会更喜欢 Team Foundation Build。

如果您是一家精益企业，请坚持使用 CC Net 并开发您自己的报告解决方案。这就是我们所做的。

直到我们被收购。并获得了 TFS：P

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-17T06:23:21.307

我假设当您拥有 TFS 时，您将使用它进行版本控制。在那种情况下，我会倾向于 Team Foundation Build。也就是说，我非常同意[尼克](https://stackoverflow.com/questions/80120/cruise-control-net-vs-team-foundation-build#80223)的观点。

我为 TFS 编写了[CruiseControl.NET 集成](http://www.codeplex.com/TFSCCNetPlugin/)。它工作正常，并为您提供与您习惯相同的构建功能。对我来说，CC.NET 的主要优势在于它是完全可扩展的，并且可以与所有主要的 SCM 和构建系统集成。我将 CC.NET 集成到 TFS 的主要原因是，在 TFS2005 中，构建系统没有开箱即用的 CI 支持。然而，TFS2008 版本有了很大的改进，团队继续非常积极地改进它以适应未来的 TFS 版本。

切换到 TFS Build 的主要原因是它可以自动将构建信息报告回 TFS，这有助于在报告方面完成软件开发图。它还与 TFS 的工作项跟踪端和 IDE 内部（在 Visual Studio 和 Eclipse 中）很好地集成。

也就是说，如果您对 Nant 脚本进行了大量投资，而不仅仅是编译和测试您的代码，或者您已经拥有自制的报告解决方案，您可能希望坚持现有的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T07:21:36.970

Team Foundation Build 的真正价值在于它将变更集和工作项与构建相关联。

这实现了几个有用的场景：

*   您可以查看一个工作项并找出它包含在什么构建中
*   您可以查看构建并查看其中包含哪些代码更改（和工作项）

当然还有建立在这些信息之上的报告。但即使这些链接本身对非管理类型也是有用的。

查看 www.tfsbuild.com 以获取有关不同 Team Build 配置的“食谱”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-28T17:36:04.000

SVN 是一个好工具，远远优于不是真的，SVN 与 TFS 类似于福特皮卡与梅赛德斯 500，它完成了工作，但它并不漂亮，也不是很舒服，合并有很多不足之处。我更喜欢 TFS 合并工具，因为分支开发人员似乎就在那里与您一起工作，这就是它的智能。我们内部的 SVN 似乎损坏了很多，这就是我们放弃它并转到 TFS 并且没有回头的原因。变更集的搁置对于敏捷开发商店来说非常棒，目前在 TFS 上有 270 多名工程师没有任何问题或问题，SVN 根本无法在没有人遇到问题的情况下处理这种负载。

我更喜欢 CC.NET 仅仅是因为我们内部开发了一些工具来扩展报告和管理的功能。但是，TFS 构建非常紧密地集成在一起，我们预计在升级到 SQL 2008 时会进行切换

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T05:08:13.097

自 07 年 6 月以来，我们一直在使用 CruiseControl.net，它对我们非常有用。最好的部分，它很容易集成到 SVN，这是一个非常优秀的源代码控制提供商。

所以我们的设置是：

*   [巡航控制网](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)
*   [SVN](http://subversion.tigris.org/)
*   [Trac](http://trac.edgewall.org/) - 用于错误报告和项目管理（与 SVN 完美集成）
*   nunit - 用于单元测试

我们进行了一些主要的并行开发，分支和合并体验非常棒。如果你有选择，我会选择上面的设置！

# algorithm - 存储消息的修订更改

> ID：80141
> 
> 赞同：2
> 
> 时间：2008-09-17T04:57:33.433
> 
> 标签：algorithm, version-control

像 stackoverflow 和 wikipedia 这样的存储修订更改涉及哪些算法和流程？

邮件是否只保留一份？如果是这样，它只是最新的副本吗？然后只从那里存储返回到以前版本的更改？（这将使主要信息的显示速度更快）。或者是否存储了完整的消息？如果是这样，是否在每个显示器上进行了这些比较？

哪些算法最适合用于确定消息中的确切变化？这些数据如何存储在数据库中？

如果有人确切地知道维基百科或stackoverlfow 我很想知道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T10:30:14.880

Mediawiki（维基百科的软件）存储所有修订的全文，请参见[数据库模式](http://www.mediawiki.org/wiki/Image:Mediawiki-database-schema.png)。[Mediawiki中文本表](http://www.mediawiki.org/wiki/Text_table)中的每个条目都有标志，表明内容是否已被 gzip 压缩，使用标准压缩通常是最明智的选择。

我不能告诉你如何在算法上做差异，但无论你使用什么算法，你都应该从两个完整版本的文本中做。那就是从数据库中获取新旧对象的完整版本，然后进行差异。这使得可以轻松地更改差异算法。

[Git](http://git.or.cz/)是一个很好的 Unix 应用程序示例，它可以进行非常便宜（存储和速度方面）的增量存储。有些 wiki 可以使用 git，例如[ikiwiki](http://ikiwiki.info/)，但我猜你想用数据库来做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T04:59:53.723

通常消息存储为完整的快照。以前的版本被禁用，并显示最新的版本。可能会使用一些优化，例如缓存哪个版本是最新的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T05:05:01.933

[最长公共子串算法](http://en.wikipedia.org/wiki/Diff#Algorithm)可用于检测版本之间的差异，但它是有限的。例如，它不会检测到文本的移动，但会将其视为不相关的删除和插入。

我想网站通常会完整存储最新的副本，并从那里应用反向差异。这也是[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)的工作方式，但[Subversion](http://en.wikipedia.org/wiki/Subversion_(software))使用前向差异，这会导致检出速度变慢。

要将其存储在数据库中，可以维护具有最新版本的主表，并具有具有反向差异的单独表。该表将包含格式为 的行`(article_id, revision_id, differences)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:09:30.300

典型的修订更改使用增量算法存储，因此存储的唯一数据是每个修订中相对于原始版本的更改。我不确定 wikipedia 或 stackoverflow 是如何实现的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T07:39:14.293

我会使用以下技术：

*   将当前消息存储为完整文本。
*   使用 delta 算法存储历史记录。

这将使您的性能保持良好的常规显示，同时将历史存储量保持在最低限度。

# mysql - 比较 MySQL 交叉和内连接

> ID：80152
> 
> 赞同：1
> 
> 时间：2008-09-17T04:59:58.480
> 
> 标签：mysql, sql

给定不同的数据库、配置等，每个查询的潜在优缺点是什么？有没有时候一个人比另一个人更有效率？反之亦然？有没有更好的方法呢？你能解释一下为什么吗？

查询一：

```
SELECT 
  *
FROM
  table_a, table_b, table_c
WHERE
  table_a.id = table_b.id AND
  table_a.id = table_c.id AND
  table_a.create_date > DATE('1998-01-01'); 
```

查询 2：

```
SELECT 
  *
FROM
  table_a 
INNER JOIN table_b ON
  table_a.id = table_b.id
INNER JOIN table_c ON
  table_a.id = table_c.id
WHERE
  table_a.create_date > DATE('1998-01-01'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T05:03:32.687

相同的查询，不同版本的 SQL 规范。查询优化器应该为这些提供相同的查询计划。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T05:05:11.153

没有。我只是与一些同事共享一个庞大的、不堪重负的数据库，并试图想出一些方法来获得更多的处理器收益。我一直在网上四处寻找，但对于像这样的一些问题没有找到很好的解释。

对不起，听起来像是功课。我想我作为 TA 的时间太长了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T05:15:38.087

实际上，我认为查询 2 更具可读性。想想当您在查询一中点击 where 子句时说 5、6 或 7 个表。跟随连接可能会变得混乱。

至于性能，我不知道。我敢打赌，如果你去 MySQL 网站，那里会有信息——可能是连接的例子。

专业上，我只参与过一个项目。但这是一个很大的问题，他们总是遵循查询 2 的格式。虽然这是使用 Microsoft SQL Server。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-17T05:02:44.980

我同意，这听起来有点像家庭作业！

如果这不是家庭作业，那么我想最简单的答案是可读性。

如前所述，两个查询将产生相同的执行计划。如果是这种情况，那么您唯一需要担心的是它的可维护性。

# com - COINIT_SPEED_OVER_MEMORY 有什么作用？

> ID：80160
> 
> 赞同：8
> 
> 时间：2008-09-17T05:01:21.613
> 
> 标签：com

调用 时`CoInitializeEx`，您可以为 指定以下值`dwCoInit`：

```
typedef enum tagCOINIT {
    COINIT_MULTITHREADED     = 0x0,
    COINIT_APARTMENTTHREADED = 0x2,
    COINIT_DISABLE_OLE1DDE   = 0x4,
    COINIT_SPEED_OVER_MEMORY = 0x8,
} COINIT; 
```

标题为“内存速度”的暗示性价值有什么作用？这些天在COM中被忽略了吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-17T05:07:43.690

不知道它是否仍在使用，但它旨在改变 COM 算法使用的平衡。

如果你有大量的内存并且不惜一切代价想要速度，你会设置那个标志。

在低内存环境中，关闭该标志将有利于减少内存使用。

* * *

事实证明，了不起的[Raymond Chen](https://stackoverflow.com/users/902497/raymond-chen)（以[“The Old New Thing”](http://blogs.msdn.com/b/oldnewthing/)成名）现在已经对这个主题进行了权衡，尽管这面旗帜的*本意*是什么，但它显然什么也没做。

请参阅*[CoInitializeEx 的 COINIT_SPEED_OVER_MEMORY 标志有什么作用？](http://blogs.msdn.com/b/oldnewthing/archive/2012/11/08/10366704.aspx)*更多细节：

> 何时应启用此模式？没关系，因为据我所知，COM 中没有任何代码可以根据进程是否已置于此模式来更改其行为！看起来标志是在引入 DCOM 时添加的，但它从未与任何东西挂钩。（或者任何连接到它的代码从未发布过。）

还有 来自原始 COM+ 架构师之一 Steve Swartz 的[http://archives.neohapsis.com/archives/microsoft/various/dcom/2001-q1/0160.html ：](http://archives.neohapsis.com/archives/microsoft/various/dcom/2001-q1/0160.html)

> COM 忽略 COINIT_SPEED_OVER_MEMORY。

# asp.net - 如何仅在 ASP.NET 动态数据的列表页上隐藏列？

> ID：80175
> 
> 赞同：2
> 
> 时间：2008-09-17T05:03:49.360
> 
> 标签：asp.net, dynamic-data

这有点类似于[这个问题](https://stackoverflow.com/questions/25653/hide-a-column-in-aspnet-dynamic-data)。

但是，我不想一起隐藏一列，我只是想在 List.aspx 页面上隐藏该列。

我的具体示例是长字段（或至少 nvarchar(MAX)）自动从 List.aspx 页面中隐藏，但在 Edit.aspx 页面上仍然可见。

我想为其他（较短的）列复制这种行为。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T10:26:20.570

您可以为要更改的特定表创建自定义页面。[这里](http://davidhayden.com/blog/dave/archive/2007/12/30/ASPNETDynamicDataWebsitesCustomizingPagesValidation.aspx)有一个例子。

在您的自定义页面中，您可以`AutoGenerateColumns="false"`在`asp:GridView`控件中进行设置，然后准确定义您想要的列，如下所示：

```
<Columns>
    ...
    <asp:DynamicField DataField="Product" HeaderText="Product" />
    <asp:DynamicField DataField="Colour" HeaderText="Colour" />
</Columns> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-26T22:11:31.407

我认为这个解决方案非常有用，因为它允许您使用属性模型来指定哪些列去哪里： [http ://csharpbits.notaclue.net/2008/10/dynamic-data-hiding-columns-in-选定的.html](http://csharpbits.notaclue.net/2008/10/dynamic-data-hiding-columns-in-selected.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-05T08:37:46.350

如果您使用引导程序，您可以这样设置

```
<asp:DynamicField DataField="Id" ItemStyle-CssClass="hidden" HeaderStyle-CssClass="hidden" FooterStyle-CssClass="hidden"/> 
```

# c# - 如何跟踪业务对象的更改？

> ID：80182
> 
> 赞同：7
> 
> 时间：2008-09-17T05:05:42.477
> 
> 标签：c#, business-objects

我得到了创建一个业务对象或实体来表示像一个人这样的东西的概念。然后我可以使用 DTO 序列化 Person 并将其发送给客户端。如果客户端更改了对象，它可以在那里有一个 IsDirty 标志，因此当它被发送回服务器时，我知道要更新它。

但是如果我有一个 Order 对象呢？这有主要的标题信息、客户、供应商、所需日期等。然后它有 OrderItems，它是一个 List<OrderItem>，是要订购的项目。我希望能够在我的 UI 上使用这个业务对象。所以我有一些文本框连接到位置、供应商、所需日期等，还有一个网格连接到 OrderItems。由于 OrderItems 是一个列表，我可以轻松地向其中添加和删除记录。但是我如何跟踪这一点，尤其是已删除的项目。我不希望删除的项目在我的网格中可见，如果我使用 foreach，我不应该能够迭代它们，因为它们已被删除。但我仍然需要跟踪删除的事实。如何跟踪更改。我想我需要使用一个工作单元？但随后代码似乎变得相当复杂。那么我想知道为什么不简单地使用 DataTables 并免费获得更改跟踪？但后来我读到了业务对象是如何发展的。

我在简单的 Person 示例中找到了各种示例，而不是像 Orders 这样的标题细节示例。

顺便说一句，为此使用 C# 3.5。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T05:25:37.983

首先，您可以使用解决这些问题的现有框架，例如 CSLA.NET。这个框架的作者已经解决了这些问题。为此，[请访问 http://www.rockfordlhotka.net/cslanet/](http://www.rockfordlhotka.net/cslanet/)。即使您不使用完整的框架，这些概念仍然适用。

如果你想自己动手，我过去所做的不是使用 List 作为我的集合，而是使用从 BindingList 派生的自定义类型。从 BindingList 继承允许您覆盖添加/删除项目的行为。因此，例如，您可以拥有另一个“删除”项目的内部集合。每次在您的集合上调用覆盖的 Remove 方法时，将项目放入“已删除”集合中，然后调用 Remove 方法的基本实现。您可以对添加的项目或更改的项目执行相同的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T05:41:37.227

你很清楚需要一个工作单元，但不要写一个。使用 NHibernate 或其他一些 ORM。这就是他们的目的。他们内置了工作单元。

业务对象确实是大多数应用程序的“必经之路”。你正在潜入一个很深的领域，并且会有很多学习要做。查看 DDD。

我也强烈建议不要在你的代码隐藏中使用这样的代码。查看 MVP 模式。

我也（虽然我正在费心学习许多新的、非常关键的东西）研究 SOLID。

您可能想查看 JP Boodhoo 的“.net”课程，因为它涵盖了很多此类内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-17T05:23:40.733

数据对象不跟踪更改。更改跟踪发生在 DataContext 和您通过 DataContext 检索的对象上。因此，为了跟踪更改，您需要执行以下操作：

```
public class FooDataContext : DataContext
{
   public Table<Order> Orders;   
}

public class Order
{
    [DbColumn(Identity = true)]
    [Column(DbType = "Int NOT NULL IDENTITY", IsPrimaryKey = true, IsDbGenerated = true)]
    public int Id { get; set; }

    [DbColumn(Default = "(getutcdate())")]
    [Column(DbType = "DateTime", CanBeNull = false, IsDbGenerated = true)]
    public DateTime DateCreated { get; set; }

    [Column(DbType = "varchar(50)", CanBeNull = false, IsDbGenerated = false)]
    public string Name { get; set; }
} 
```

现在在您的代码隐藏中，您可以执行以下操作：

```
public void UpdateOrder(int id, string name)
{
   FooDataContext db = new FooDataContext();
   Order order = db.Orders.Where(o=>o.Id == id).FirstOrDefault();

   if (order == null) return;

   order.Name = name;

   db.SubmitChanges();
} 
```

我不建议在后面的代码中直接使用数据上下文，但这是开始使用 Linq To SQL 的好方法。我建议将所有数据库交互放在一个外部项目中，并从 GUI 调用封装此行为的类。

如果您是 Linq To Sql 的新手，我建议您创建一个 Linq To Sql (dbml) 文件。

在解决方案资源管理器中右键单击您的项目，然后选择添加新项目。选择 Linq To SQL 文件，然后它将让您连接到数据库并选择表。

然后，您可以查看生成的代码，并获得一些关于 Linq To Sql 如何工作以及您可以用它做什么的好主意。

使用它作为使用 Linq to SQL 的指导方针，这将带你走得更远......

# php - 在 Apache/PHP 中使用 X-Sendfile

> ID：80186
> 
> 赞同：20
> 
> 时间：2008-09-17T05:07:08.200
> 
> 标签：php, apache, x-sendfile

我似乎找不到太多关于 X-Sendfile 的文档或 PHP 的示例代码（有一些 rails 代码）。

任何人以前使用过它并且介意提供一段快速的代码和简短的描述吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-17T05:11:19.797

X-Sendfile 是一个 HTTP 标头，所以你想要这样的东西：

```
header("X-Sendfile: $filename"); 
```

如果配置正确，您的 Web 服务器会选择它。以下是更多细节：

[http://www.jasny.net/articles/how-i-php-x-sendfile/](http://www.jasny.net/articles/how-i-php-x-sendfile/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T06:02:09.643

如果无法调整 Web 服务器配置，请考虑 PHP 的标准[readfile() 函数](http://us3.php.net/manual/en/function.readfile.php)。它不会像 sendfile 那样快，但它会更广泛地兼容。另请注意，在执行此操作时，您还应该至少发送一个 Content-Type 标头。

# storage - 高可用性存储

> ID：80195
> 
> 赞同：4
> 
> 时间：2008-09-17T05:09:20.580
> 
> 标签：storage, high-availability

我想通过 NFS 和 CIFS 提供 2 TB 左右的空间。我正在寻找 2 个（或更多）服务器解决方案，以实现高可用性以及尽可能跨服务器进行负载平衡的能力。有关集群或高可用性解决方案的任何建议？

这是商业用途，计划在未来几年增长到 5-10 TB。我们的设施几乎每天 24 小时，每周 6 天。我们可能会有 15-30 分钟的停机时间，但我们希望尽量减少数据丢失。我想尽量减少凌晨 3 点的通话。

我们目前在 Solaris 上运行一台带有 ZFS 的服务器，并且我们正在研究用于 HA 部分的 AVS，但是我们在 Solaris 上遇到了一些小问题（CIFS 实施不适用于 Vista 等），这些问题阻碍了我们。

我们已经开始关注

*   DRDB over GFS（用于分布式锁功能的 GFS）
*   Gluster（需要客户端，没有本地 CIFS 支持？）
*   Windows DFS（文档说仅在文件关闭后复制？）

我们正在寻找一个提供数据的“黑匣子”。

我们目前在 ZFS 中对数据进行快照，并通过网络将快照发送到远程数据中心以进行异地备份。

我们最初的计划是每 10 - 15 分钟拥有第二台机器和 rsync。失败的问题是正在进行的生产过程会丢失 15 分钟的数据并留在“中间”。他们几乎从一开始就比在中间弄清楚从哪里开始要容易得多。这就是促使我们关注 HA 解决方案的原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T17:27:25.783

我最近使用 DRBD 作为后端部署了 hanfs，在我的情况下，我正在运行主动/备用模式，但我也已经在主/主模式下使用 OCFS2 成功测试了它。不幸的是，关于如何最好地实现这一点的文档并不多，存在的大多数文档充其量也几乎没有用处。如果您确实选择了 drbd 路线，我强烈建议您加入 drbd 邮件列表，并阅读所有文档。这是我为处理 ha 的故障而编写的 ha/drbd 设置和脚本：

* * *

需要 DRBD8 - 这是由 drbd8-utils 和 drbd8-source 提供的。一旦安装了这些（我相信它们是由 backports 提供的），您可以使用模块助手来安装它 - ma i drbd8。此时可以使用 depmod -a 或重新启动，如果您使用 depmod -a，则需要 modprobe drbd。

您将需要一个后端分区来用于 drbd，不要将此分区设为 LVM，否则您会遇到各种问题。不要将 LVM 放在 drbd 设备上，否则会遇到各种问题。

汉弗斯1：

```
 /etc/drbd.conf

global {
        usage-count no;
}
common {
        protocol C;
        disk { on-io-error detach; }
}
resource export {
        syncer {
                rate 125M;
        }
        on hanfs2 {
                address         172.20.1.218:7789;
                device          /dev/drbd1;
                disk            /dev/sda3;
                meta-disk       internal;
        }
        on hanfs1 {
                address         172.20.1.219:7789;
                device          /dev/drbd1;
                disk            /dev/sda3;
                meta-disk       internal;
       }
}
```

Hanfs2 的 /etc/drbd.conf：

```
 global {
        usage-count no;
}
common {
        protocol C;
        disk { on-io-error detach; }
}
resource export {
        syncer {
                rate 125M;
        }
        on hanfs2 {
                address         172.20.1.218:7789;
                device          /dev/drbd1;
                disk            /dev/sda3;
                meta-disk       internal;
        }
        on hanfs1 {
                address         172.20.1.219:7789;
                device          /dev/drbd1;
                disk            /dev/sda3;
                meta-disk       internal;
       }
}
```

配置完成后，接下来我们需要启动 drbd。

```
drbdadm create-md 导出
drbdadm 附加导出
drbdadm 连接导出

```

我们现在必须执行数据的初始同步 - 显然，如果这是一个全新的 drbd 集群，那么您选择哪个节点都没有关系。

完成后，您需要在您的 drbd 设备上创建 mkfs.yourchoiceofilesystem - 我们上面的配置中的设备是 /dev/drbd1。[http://www.drbd.org/users-guide/p-work.html](http://www.drbd.org/users-guide/p-work.html)是使用 drbd 时阅读的有用文档。

心跳

安装心跳2。（很简单，apt-get install heartbeat2）。

每台机器上的 /etc/ha.d/ha.cf 应包括：

hanfs1：

```
 logfacility local0
keepalive 2
warntime 10
deadtime 30
initdead 120

ucast eth1 172.20.1.218

auto_failback no

node hanfs1
node hanfs2 
```

hanfs2：

```
 logfacility local0
keepalive 2
warntime 10
deadtime 30
initdead 120

ucast eth1 172.20.1.219

auto_failback no

node hanfs1
node hanfs2 
```

/etc/ha.d/haresources 在两个 ha 盒子上应该是相同的：

```
hanfs1 IPaddr::172.20.1.230/24/eth1
hanfs1 HeartBeatWrapper
```

我编写了一个包装脚本来处理故障转移场景中由 nfs 和 drbd 引起的特性。该脚本应该存在于每台机器上的 /etc/ha.d/resources.d/ 中。

```
 # !/bin/bash

# heartbeat fails hard.

# so this is a wrapper

# to get around that stupidity

# I'm just wrapping the heartbeat scripts, except for in the case of umount

# as they work, mostly

if [[ -e /tmp/heartbeatwrapper ]]; then
    runningpid=$(cat /tmp/heartbeatwrapper)
    if [[ -z $(ps --no-heading -p $runningpid) ]]; then
        echo "PID found, but process seems dead.  Continuing."
    else

        echo "PID found, process is alive, exiting."

        exit 7

    fi

fi                                                            

echo $$ > /tmp/heartbeatwrapper

if [[ x$1 == "xstop" ]]; then

/etc/init.d/nfs-kernel-server stop #>/dev/null 2>&1

# NFS init script isn't LSB compatible, exit codes are 0 no matter what happens.

# Thanks guys, you really make my day with this bullshit.

# Because of the above, we just have to hope that nfs actually catches the signal

# to exit, and manages to shut down its connections.

# If it doesn't, we'll kill it later, then term any other nfs stuff afterwards.

# I found this to be an interesting insight into just how badly NFS is written.

sleep 1

```
#we don't want to shutdown nfs first!
#The lock files might go away, which would be bad.

#The above seems to not matter much, the only thing I've determined
#is that if you have anything mounted synchronously, it's going to break
#no matter what I do.  Basically, sync == screwed; in NFSv3 terms.      
#End result of failing over while a client that's synchronous is that   
#the client hangs waiting for its nfs server to come back - thing doesn't
#even bother to time out, or attempt a reconnect.                        
#async works as expected - it insta-reconnects as soon as a connection seems
#to be unstable, and continues to write data.  In all tests, md5sums have   
#remained the same with/without failover during transfer.                   

#So, we first unmount /export - this prevents drbd from having a shit-fit
#when we attempt to turn this node secondary.                            

#That's a lie too, to some degree. LVM is entirely to blame for why DRBD
#was refusing to unmount.  Don't get me wrong, having /export mounted doesn't
#help either, but still.                                                     
#fix a usecase where one or other are unmounted already, which causes us to terminate early.

if [[ "$(grep -o /varlibnfs/rpc_pipefs /etc/mtab)" ]]; then                                 
    for ((test=1; test <= 10; test++)); do                                                  
        umount /export/varlibnfs/rpc_pipefs  >/dev/null 2>&1                                
        if [[ -z $(grep -o /varlibnfs/rpc_pipefs /etc/mtab) ]]; then                        
            break                                                                           
        fi                                                                                  
        if [[ $? -ne 0 ]]; then                                                             
            #try again, harder this time                                                    
            umount -l /var/lib/nfs/rpc_pipefs  >/dev/null 2>&1                              
            if [[ -z $(grep -o /varlibnfs/rpc_pipefs /etc/mtab) ]]; then                    
                break                                                                       
            fi                                                                              
        fi                                                                                  
    done                                                                                    
    if [[ $test -eq 10 ]]; then                                                             
        rm -f /tmp/heartbeatwrapper                                                         
        echo "Problem unmounting rpc_pipefs"                                                
        exit 1                                                                              
    fi                                                                                      
fi                                                                                          

if [[ "$(grep -o /dev/drbd1 /etc/mtab)" ]]; then                                            
    for ((test=1; test <= 10; test++)); do                                                  
        umount /export  >/dev/null 2>&1                                                     
        if [[ -z $(grep -o /dev/drbd1 /etc/mtab) ]]; then                                   
            break                                                                           
        fi                                                                                  
        if [[ $? -ne 0 ]]; then                                                             
            #try again, harder this time                                                    
            umount -l /export  >/dev/null 2>&1                                              
            if [[ -z $(grep -o /dev/drbd1 /etc/mtab) ]]; then                               
                break                                                                       
            fi                                                                              
        fi                                                                                  
    done                                                                                    
    if [[ $test -eq 10 ]]; then                                                             
        rm -f /tmp/heartbeatwrapper                                                         
        echo "Problem unmount /export"                                                      
        exit 1                                                                              
    fi                                                                                      
fi                                                                                          

#now, it's important that we shut down nfs. it can't write to /export anymore, so that's fine.
#if we leave it running at this point, then drbd will screwup when trying to go to secondary.  
#See contradictory comment above for why this doesn't matter anymore.  These comments are left in
#entirely to remind me of the pain this caused me to resolve.  A bit like why churches have Jesus
#nailed onto a cross instead of chilling in a hammock.                                           

pidof nfsd | xargs kill -9 >/dev/null 2>&1

sleep 1                                   

if [[ -n $(ps aux | grep nfs | grep -v grep) ]]; then
    echo "nfs still running, trying to kill again"   
    pidof nfsd | xargs kill -9 >/dev/null 2>&1       
fi                                                   

sleep 1

/etc/init.d/nfs-kernel-server stop #>/dev/null 2>&1

sleep 1

#next we need to tear down drbd - easy with the heartbeat scripts
#it takes input as resourcename start|stop|status                
#First, we'll check to see if it's stopped                       

/etc/ha.d/resource.d/drbddisk export status >/dev/null 2>&1
if [[ $? -eq 2 ]]; then                                    
    echo "resource is already stopped for some reason..."  
else                                                       
    for ((i=1; i <= 10; i++)); do                          
        /etc/ha.d/resource.d/drbddisk export stop >/dev/null 2>&1
        if [[ $(egrep -o "st:[A-Za-z/]*" /proc/drbd | cut -d: -f2) == "Secondary/Secondary" ]] || [[ $(egrep -o "st:[A-Za-z/]*" /proc/drbd | cut -d: -f2) == "Secondary/Unknown" ]]; then                                                                                                                             
            echo "Successfully stopped DRBD"                                                                                                             
            break                                                                                                                                        
        else                                                                                                                                             
            echo "Failed to stop drbd for some reason"                                                                                                   
            cat /proc/drbd                                                                                                                               
            if [[ $i -eq 10 ]]; then                                                                                                                     
                    exit 50                                                                                                                              
            fi                                                                                                                                           
        fi                                                                                                                                               
    done                                                                                                                                                 
fi                                                                                                                                                       

rm -f /tmp/heartbeatwrapper                                                                                                                              
exit 0 
```

elif [[ x$1 == "xstart" ]]; then

```
#start up drbd first
/etc/ha.d/resource.d/drbddisk export start >/dev/null 2>&1
if [[ $? -ne 0 ]]; then                                   
    echo "Something seems to have broken. Let's check possibilities..."
    testvar=$(egrep -o "st:[A-Za-z/]*" /proc/drbd | cut -d: -f2)       
    if [[ $testvar == "Primary/Unknown" ]] || [[ $testvar == "Primary/Secondary" ]]
    then                                                                           
        echo "All is fine, we are already the Primary for some reason"             
    elif [[ $testvar == "Secondary/Unknown" ]] || [[ $testvar == "Secondary/Secondary" ]]
    then                                                                                 
        echo "Trying to assume Primary again"                                            
        /etc/ha.d/resource.d/drbddisk export start >/dev/null 2>&1                       
        if [[ $? -ne 0 ]]; then                                                          
            echo "I give up, something's seriously broken here, and I can't help you to fix it."
            rm -f /tmp/heartbeatwrapper                                                         
            exit 127                                                                            
        fi                                                                                      
    fi                                                                                          
fi                                                                                              

sleep 1                                                                                         

#now we remount our partitions                                                                  

for ((test=1; test <= 10; test++)); do                                                          
    mount /dev/drbd1 /export >/tmp/mountoutput                                                  
    if [[ -n $(grep -o export /etc/mtab) ]]; then                                               
        break                                                                                   
    fi                                                                                          
done                                                                                            

if [[ $test -eq 10 ]]; then                                                                     
    rm -f /tmp/heartbeatwrapper                                                                 
    exit 125                                                                                    
fi                                                                                              

#I'm really unsure at this point of the side-effects of not having rpc_pipefs mounted.          
#The issue here, is that it cannot be mounted without nfs running, and we don't really want to start
#nfs up at this point, lest it ruin everything.                                                     
#For now, I'm leaving mine unmounted, it doesn't seem to cause any problems.                        

#Now we start up nfs.

/etc/init.d/nfs-kernel-server start >/dev/null 2>&1
if [[ $? -ne 0 ]]; then
    echo "There's not really that much that I can do to debug nfs issues."
    echo "probably your configuration is broken.  I'm terminating here."
    rm -f /tmp/heartbeatwrapper
    exit 129
fi

#And that's it, done.

rm -f /tmp/heartbeatwrapper
exit 0 
```

elif [[ "x$1" == "xstatus" ]]; then

```
#Lets check to make sure nothing is broken.

#DRBD first
/etc/ha.d/resource.d/drbddisk export status >/dev/null 2>&1
if [[ $? -ne 0 ]]; then
    echo "stopped"
    rm -f /tmp/heartbeatwrapper
    exit 3
fi

#mounted?
grep -q drbd /etc/mtab >/dev/null 2>&1
if [[ $? -ne 0 ]]; then
    echo "stopped"
    rm -f /tmp/heartbeatwrapper
    exit 3
fi

#nfs running?
/etc/init.d/nfs-kernel-server status >/dev/null 2>&1
if [[ $? -ne 0 ]]; then
    echo "stopped"
    rm -f /tmp/heartbeatwrapper
    exit 3
fi

echo "running"
rm -f /tmp/heartbeatwrapper
exit 0 
```

fi 
```

完成上述所有操作后，您只需配置 /etc/exports

```
/export 172.20.1.0/255.255.255.0(rw,sync,fsid=1,no_root_squash)
```

那么这只是在两台机器上启动心跳并在其中一台上发出 hb_takeover 的情况。您可以通过确保发出接管的设备是主要设备来测试它是否正常工作 - 检查 /proc/drbd，设备安装正确，并且您可以访问 nfs。

--

祝你好运。对我来说，从头开始设置是一次非常痛苦的经历。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T05:15:32.657

如今 2TB 可装入一台机器，因此您可以选择从简单到复杂的各种选项。这些都假定 linux 服务器：

*   您可以通过设置两台机器并定期从主要机器到备份机器进行 rsync 来获得穷人的 HA。
*   您可以使用[DRBD](http://www.drbd.org)在块级别从另一个镜像。这样做的缺点是将来有点难以扩展。
*   您可以改为使用[OCFS2](http://oss.oracle.com/projects/ocfs2/)对磁盘进行集群，以便将来进行扩展。

也有很多商业解决方案，但现在 2TB 对他们中的大多数人来说有点小。

您还没有提到您的应用程序，但是如果不需要热故障转移，并且您真正想要的是能够承受丢失一两个磁盘的东西，请找到支持 RAID-5 的 NAS，至少 4 个驱动器，和热插拔，你应该很高兴。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T05:13:53.003

我会推荐**NAS 存储。（网络附加存储）。**

惠普有一些不错的供您选择。

[http://h18006.www1.hp.com/storage/aiostorage.html](http://h18006.www1.hp.com/storage/aiostorage.html)

以及集群版本：

[http://h18006.www1.hp.com/storage/software/clusteredfs/index.html?jumpid=reg_R1002_USEN](http://h18006.www1.hp.com/storage/software/clusteredfs/index.html?jumpid=reg_R1002_USEN)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:23:53.480

有两种方法可以解决这个问题。第一种是直接从戴尔或惠普购买 SAN 或 NAS，然后花钱解决问题。现代存储硬件只是让所有这一切变得容易，节省您的专业知识以解决更多核心问题。

如果您想自己动手，请查看将 Linux 与 DRBD 结合使用。

[http://www.drbd.org/](http://www.drbd.org/)

DRBD 允许您创建联网的块设备。考虑跨两台服务器的 RAID 1，而不仅仅是两个磁盘。DRBD 部署通常使用 Heartbeat 进行故障转移，以防一个系统死机。

我不确定负载平衡，但您可能会调查并查看 LVS 是否可用于跨 DRBD 主机的负载平衡：

[http://www.linuxvirtualserver.org/](http://www.linuxvirtualserver.org/)

最后，让我重申一下，从长远来看，您可能会为自己节省大量时间，只需花钱购买 NAS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T05:13:50.867

您在寻找“企业”解决方案还是“家庭”解决方案？从您的问题中很难看出，因为 2TB 对于企业来说非常小，而对于家庭用户（尤其是两台服务器）来说高端一点。您能否澄清一下需求，以便我们讨论权衡？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T06:13:33.720

我从您的问题主体中假设您是商业用户？我从 Silicon Mechanics 购买了一个 6TB RAID 5 单元并连接了 NAS，我的工程师在我们的服务器上安装了 NFS。通过 rsync 执行的备份到另一个大容量 NAS。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T06:23:57.780

看看 Amazon Simple Storage Service (Amazon S3)

[http://www.amazon.com/S3-AWS-home-page-Money/b/ref=sc_fe_l_2?ie=UTF8&node=16427261&no=3435361&me=A36L942TSJ2AJA](http://www.amazon.com/S3-AWS-home-page-Money/b/ref=sc_fe_l_2?ie=UTF8&node=16427261&no=3435361&me=A36L942TSJ2AJA)

- 这可能会引起人们的兴趣。高可用性

尊敬的 AWS 客户：

你们中的许多人都要求我们提前让您了解当前正在开发的功能和服务，以便您可以更好地规划该功能如何与您的应用程序集成。为此，我们很高兴与您分享一些关于我们在 AWS 正在开发的新产品的早期细节 - 内容交付服务。

这项新服务将为您提供一种向最终用户分发内容的高性能方法，从而在您的客户访问您的对象时为他们提供低延迟和高数据传输率。初始版本将帮助需要通过 HTTP 连接交付流行的、公开可读的内容的开发人员和企业。我们的目标是创建一个内容交付服务：

让开发者和企业轻松上手——没有最低费用，也没有承诺。您只需为实际使用的内容付费。简单易用 - 只需一个简单的 API 调用即可开始交付您的内容。与 Amazon S3 无缝协作 - 这为您提供持久存储文件的原始、最终版本，同时使内容交付服务更易于使用。业务遍及全球——我们使用遍布三大洲的全球边缘站点网络，从最合适的位置交付您的内容。

您首先将对象的原始版本存储在 Amazon S3 中，确保它们是公开可读的。然后，您将进行一个简单的 API 调用，以将您的存储桶注册到新的内容交付服务。此 API 调用将返回一个新域名供您包含在您的网页或应用程序中。当客户端使用此域名请求对象时，它们将被自动路由到最近的边缘位置，以便高性能地交付您的内容。就是这么简单。

我们目前正在与一小部分私人测试版客户合作，并希望在今年年底之前广泛提供这项服务。如果您想在我们发布时收到通知，请点击此处告知我们。

真挚地，

亚马逊网络服务团队

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T17:16:25.090

你最好的选择可能是与以做这种事情为生的专家合作。这些人实际上是在我们的办公大楼里……我有机会与他们一起参与我领导的一个类似项目。

[http://www.deltasquare.com/关于](http://www.deltasquare.com/About)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-18T21:40:09.703

我建议您访问 F5 网站并查看[http://www.f5.com/solutions/virtualization/file/](http://www.f5.com/solutions/virtualization/file/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-30T08:01:19.647

您可以查看镜像文件系统。它在文件系统级别进行文件复制。主系统和备份系统上的相同文件是活动文件。

[http://www.linux-ha.org/RelatedTechnologies/Filesystems](http://www.linux-ha.org/RelatedTechnologies/Filesystems)

# javascript - 如何使用 javascript 和 CSS 将类似文本的元素插入到文档中？

> ID：80202
> 
> 赞同：2
> 
> 时间：2008-09-17T05:11:20.077
> 
> 标签：javascript, css

我想使用 javascript 在当前页面中插入一些元素。比如这是原始文件：<p>Hello world!</p>

现在我想在文本中插入一个元素，使其变为：

<p>你好<span id=span1>新</span>世界！</p>

我需要 span 标签，因为我想稍后处理它。显示或隐藏。但是现在问题来了，如果原始页面已经在所有 <span> 标签上定义了一个奇怪的 CSS 样式，那么我刚刚插入的“new”将不会与“Hello”和“world”相同。我怎样才能避免这种情况？我希望“新”与“Hello”和“world”完全相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T05:21:11.067

好吧，我不知道你对使用 <span> 标签有多满意，但为什么不这样做呢？

```
<p style="display: inline">Hello <p id="myIdValue" style="display: inline">new</p> World</p> 
```

这样插入的 html 保留与外部相同的样式，并且您仍然可以对其进行处理，等等。当然，您必须添加内联 CSS 样式，但它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T05:22:43.543

做到这一点的唯一方法是修改其他跨度以包含类名并将样式仅应用于具有该类的跨度，或者覆盖为新跨度的所有跨度设置的样式。

因此，如果您已经完成：

```
span {
  display: block;
  margin: 10px;
  padding: 10px;
} 
```

您可以使用以下命令覆盖：

```
<span style="display: inline; margin: 0; padding: 0;">New Span</span> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T05:58:40.883

只需覆盖任何跨度样式。将布局属性设置回浏览器默认值并将格式设置为从父级继承：

```
span#yourSpan {
  /* defaults */
  position: static;
  display: inline;
  margin: 0;
  padding: 0;
  background: transparent;
  border: none;

  /* inherit from parent node */
  font: inherit;
  color: inherit;
  text-decoration: inherit;
  line-height: inherit;
  letter-spacing: inherit;
  text-transform: inherit;
  white-space: inherit;
  word-spacing: inherit;
} 
```

这应该足够了，尽管如果您不使用 id，您可能需要添加 !important：

```
<span class="hello-node">hello</span>

span.hello-node {
  /* defaults */
  position: static !important;
  display: inline !important;
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:16:39.423

将 CSS 中定义的类定义也包含在您的 JavaScript 版本的`<span>`标记中。

```
<span class="class_defined_in_css"> 
```

（此`<span>`标记将成为您的 JavaScript 代码的一部分。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T05:17:20.827

为什么不给段落一个 id，然后在必要时使用 Javascript 来添加或删除它？当您插入单词“new”或完全更改段落的内容时，它肯定会保留与段落相同的格式。

# c# - 没有 Pervasive 的 Btrieve？

> ID：80215
> 
> 赞同：1
> 
> 时间：2008-09-17T05:15:02.127
> 
> 标签：c#, python, btrieve

是否有任何库可以在不从 Pervasive 购买东西的情况下查询 Btrieve 数据库？我正在寻找用 C# 或 Python 编写代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T02:28:52.560

如果您下载其中一个试用版，您可以获取/安装 odbc 客户端并以这种方式连接。

在我们安装数据库的服务器上的 pervasive 版本（旧版本）中，您也可以找到这个客户端安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T06:45:50.380

据我所知，这是不可能的。它不是一个开源数据库，所以为它编写驱动程序真的很困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T09:39:25.597

这在很大程度上取决于 Btrieve 的版本。我与 btrieve 合作了很长时间，并发现旧 6.15 版本的最佳 API 是帕斯卡。话虽如此，周围肯定也有一个 C api。

Pervasive 最近发布了 6.15 终极补丁。使用这个和 C api 应该可以让你有效地使用旧的 btrieve 数据库。例如，可以使用 C 为 python 构建新模块。

# frameworks - 你使用应用程序框架吗？

> ID：80216
> 
> 赞同：0
> 
> 时间：2008-09-17T05:15:08.990
> 
> 标签：frameworks

应用程序框架，如 DotNetNuke、Eclipse、Websphere 等，现在可用，它们提供可用作仪表板应用程序的可定制框架。您是否使用这些，或者您和您的同行是否继续编写您自己支持的令人惊叹的、模块化、可维护的仪表板框架？

您是否建议使用任何基于 Web 的、独立于操作系统的良好框架来构建您自己的企业级基础架构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T05:18:34.583

我使用的是 Oracle 应用程序开发框架。它是一个完整的、完全受支持的框架，Oracle 自己使用它来构建自己的企业应用程序。它带有许多 JSF 组件，这些组件非常容易绑定到底层数据对象。我会向所有需要数据库数据的 Java 应用程序推荐这个。

您可以在 Oracle Wiki 上找到有关它的讨论： [http ://wiki.oracle.com/page/ADF+Methodology+-+Work+in+Progressent](http://wiki.oracle.com/page/ADF+Methodology+-+Work+in+Progressent)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T05:18:34.757

没有一个正确的答案。看看业务需求......如果您正在做相当典型的事情，那么从一个已建立的框架开始是一个很好的起点。如果您觉得可能需要一些自定义组件或小部件，请使用您内部拥有的知识和技能寻找可扩展的框架。

除非您的业务线是构建应用程序框架或仪表板，否则在构建全新的框架或仪表板之前应该非常努力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T05:19:38.403

在工作中，我们尝试尽可能少地从头开始创建。我们经常使用框架（也许并不总是端到端框架）。我们经常使用 Dot Net Nuke。我们经常使用的另一个框架是 CSLA。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:20:17.543

我个人将 DotNetNuke 广泛用于个人和商业相关的企业。但是，DNN 不满足您的要求之一，因为它是一个 .NET 解决方案，因此它依赖于 Windows。

我发现使用 DotNetNuke 大大减少了我们的交付时间，我们可以专注于我们的核心需求，而不是常见的部分的实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T05:26:14.330

仔细考虑框架的可扩展性。有几个框架喜欢锤你的数据库，因为他们认为它只不过是一个美化的文件系统......这些框架根本不能很好地扩展。

# c# - 以设计器模式打开 .NET 表单 - 获取“路径不是合法形式”

> ID：80234
> 
> 赞同：1
> 
> 时间：2008-09-17T05:17:41.247
> 
> 标签：c#, vb.net, visual-studio, winforms

我试图在设计器模式下打开一个 C#/VB 表单，而不是表单，我收到一条丑陋的错误消息，上面写着“路径不是合法形式”。这种形式曾经有效！发生了什么？

* * *

*感谢所有回答的人。这个问题是我不久前遇到的一个问题，我为此苦苦挣扎了很长时间，直到找到答案，我在下面发布了答案，以帮助其他可能遇到此问题的人。
谢谢！*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T05:20:39.617

我不知道这个错误信息是什么意思，但它似乎与表单上的第三方控件有关。无论如何，解决方案几乎和问题一样荒谬：

1.  关闭设计器/错误消息。
2.  打开表单代码。
3.  右键单击表单代码并选择“视图设计器”。

快！设计师开门！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T05:20:52.410

调试设计模式会有所帮助。从[这里](http://blog.lab49.com/archives/244)：

1.  项目清单
2.  在 Visual Studio 中，选择要调试的项目。
3.  右键单击-> 属性。
4.  选择调试选项卡。
5.  将调试模式更改为程序。
6.  将“启动应用程序”设置为您的 Visual Studio IDE (C:\Program Files\Microsoft Visual Studio .NET 2003\Common7\IDE\devenv.exe)
7.  在“命令行参数字段”中设置您的解决方案文件。
8.  应用 -> 确定
9.  选择要调试的项目作为启动项目。
10.  跑。
11.  在要开始调试的地方设置断点（例如，您的控件构造函数）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-24T22:12:00.337

这个问题发生在我身上，我发现这是因为参考错误。您必须查看应用程序引用的程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T05:23:50.093

通过路径，它可能指的是文件或文件夹的路径。您尝试引用的路径可能格式不正确，即正斜杠而不是反斜杠。另外，自从错误出现后发生了什么变化？你有没有移动任何文件？您是否保存了任何以前未保存的代码？从版本控制系统更新？

# architecture - 测试驱动开发是否将重点放在设计上？

> ID：80243
> 
> 赞同：23
> 
> 时间：2008-09-17T05:20:05.297
> 
> 标签：architecture, tdd, agile

我对 TDD 有复杂的感觉。虽然我相信测试，但我对测试驱动我的开发工作的想法有疑问。

当您编写代码以满足为满足您现在的需求的接口编写的一些测试时，您可能会将注意力从构建可维护的代码、简洁的设计和健全的架构转移。

我在驱动而不是测试方面遇到问题。有什么想法吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-17T05:33:33.737

不。

如果做得对，测试驱动开发就是您的设计工具。

我希望你原谅我链接到[我自己的博客条目，其中我讨论了测试驱动开发的错误，](http://jonlimjap.net/2016/09/01/when-tdd-goes-red/)因为开发人员仅仅将他们的测试视为测试。

在之前的项目中，开发人员使用了一种极具破坏性的单例模式，该模式在整个项目中强制实施依赖关系，当需求发生变化时，这只会破坏整个事情：

> TDD 被视为一项任务，而它本应被视为一种方法。[...]
> 
> 没有认识到 TDD 不是关于测试，而是关于设计。单元测试中滥用单例的猖獗案例使这一点显而易见：而不是测试编写者认为“WTF 是这些单例 = 值；语句在我的测试中做什么？”，测试作者只是将单例传播到测试中。330次。
> 
> 不幸的结果是构建服务器强制测试通过了，不管它采取什么措施。

正确的测试驱动开发应该让开发人员高度意识到设计缺陷，如紧耦合、违反 DRY（不要重复自己）、违反 SRP（单一责任原则）等。

如果你为了通过测试而为测试编写通过代码，那么你已经失败了：你应该把*努力编写*测试当作路标，让你问：为什么要这样做？为什么我不能在不依赖其他代码的情况下测试此代码？为什么我不能重用这段代码？为什么这个代码在单独使用时会中断？

此外，如果您的设计是*真正*干净的，并且您的代码是*真正*可维护的，为什么要为它编写测试并非易事？

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-17T07:19:33.263

TDD 设计或前期设计总是存在过度设计的风险。所以答案是视情况而定。我更喜欢从用户故事/验收测试开始，这是我的测试将有助于生产的要求的基础。只有在我确定了这一点之后，我才开始编写详细的单元测试 TDD 风格。如果您所做的唯一设计和思考是通过 TDD，那么您会冒太多的自下而上方法的风险，这可能会给您提供出色的独立单元和类，但是当您尝试将它们集成到用户故事完成任务中时可能会因为做错了这一切而感到惊讶。有关这方面的更多灵感，请查看[BDD](http://blog.daveastels.com/files/BDD_Intro.pdf)。

Robert C. Martin 和 James Coplien 之间[就此事进行了一场激烈的“辩论” ，前者是 TDD 的倡导者，后者声称它破坏了系统的设计。](http://www.infoq.com/interviews/coplien-martin-tdd)这就是 Robert 关于 TDD 和设计的说法：

> “自 99 年左右以来，敏捷社区一直有一种感觉，即架构是无关紧要的，我们不需要做架构，我们需要做的就是编写大量测试、编写大量故事并进行快速迭代，然后”

James Coplien 指出，仅仅从 TDD 驱动您的设计具有很大的风险：

> “在很多项目中，我们经常看到的一件事是，项目在第三次冲刺时向南走，它们崩溃和燃烧，因为它们不能再进一步了，因为它们在建筑上已经走投无路了。你不能重构你的出路，因为重构必须跨类类别，跨类层次结构，你不能再保证拥有相同的功能。”

此外，他还举了一个很好的例子，说明如果您试驾了银行账户，与使用您的前期知识来推动架构相比，银行账户的外观可能会如何：

> “我记得有一次我和 Kent 谈过，在他提出 TDD 的早期，这是在 YAGNI 的意义上，做最简单的可能可行的事情，他说：‘好吧。让我们做一个银行账户，储蓄账户。什么是储蓄账户？它是一个数字，可以加数字，也可以减去数字。那么储蓄账户是什么，是一个计算器。让我们做一个计算器，我们可以证明你可以加到余额中并从余额中减去。这是可能可行的最简单的事情，其他一切都是它的演变。
> 
> 如果你做一个真正的银行系统，一个储蓄账户甚至不是一个对象，你不会从那个重构到正确的架构。储蓄账户是一个对数据库交易、存款和利息收集以及其他资金转移的审计跟踪进行迭代的过程。这不像储蓄账户是银行某处货架上的一些钱，即使这是从用户的角度来看，你只需要知道在银行系统的基础中有这些相对复杂的结构需要支持税务人员和精算师以及所有其他人，您无法以渐进的方式获得。好吧，你可以，因为银行业当然是在 40 年后走到了这一步。你想给自己40年吗？它不灵活。”

有趣的是，TDD 的支持者和 TDD 的反对者都说你需要预先设计。

如果您有时间，请观看视频。这是两位极具影响力的专家之间的一场精彩讨论，只有 22 分钟。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T05:58:14.083

我完全同意 pjz。没有一种设计软件的正确方法。如果您将 TDD 推向极端，除了下一个单元测试之外没有任何预先考虑，您可能会让自己变得更难。对于那些通过花费数月时间在图表和文档上但没有代码而着手进行大型软件项目的人也是如此。

**缓和。**如果想绘制一个快速图表来帮助您可视化代码的结构，那就去做吧。如果您需要两页，可能是时候开始编写一些代码了。如果你想在编写测试之前这样做，那又怎样。目标是工作、高质量的软件，而不是绝对符合任何特定的软件开发原则。做对你和你的团队有用的事。寻找可以改进的地方。迭代。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T07:00:31.173

在这个问题上我完全同意你的看法。在*实践中*，我认为 TDD 经常对代码库产生一些非常负面的影响（蹩脚的设计、过程代码、没有封装、生产代码中充斥着测试代码、到处都是接口、难以重构生产代码，因为一切都与许多测试紧密耦合等。 ）。

[Jim Coplien](http://en.wikipedia.org/wiki/Jim_Coplien)已经就这个话题发表了一段时间的演讲：

> 最近对 TDD 的研究（Siniaalto 和 Abrahamsson）表明，与传统的后测试开发相比，它可能没有任何好处，并且在某些情况下会恶化代码，并且它具有其他令人担忧的（他们的话）效果。最让我担心的是它会破坏架构。——[吉姆的博客](http://www.artima.com/weblogs/viewpost.jsp?thread=6771)

Robert C. Martin 和 James Coplien 之间也有[关于 InfoQ 的讨论，他们谈到了这个主题。](http://www.infoq.com/interviews/coplien-martin-tdd)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T07:34:49.810

我的想法是，首先编写您希望代码看起来像的样子。一旦你有了目标代码的样本（现在什么都不做），看看你是否可以在上面放置一个测试脚手架。如果你做不到，找出你做不到的原因。大多数情况下，这是因为您做出了错误的设计决定 (99%)，但如果不是这种情况 (1%)，请尝试以下操作：

*   确定你需要遵守哪些疯狂的要求，这不会让你测试你的代码。一个你了解问题的人重新设计你的 API。
*   如果其他人决定此要求，请与他/她讨论。他们可能有充分的理由提出要求，一旦您知道他们的理由，您就可以完善您的设计并使其可测试。如果不是现在，你们都可以重新设计需求，你们都会变得更好。

在您拥有目标代码和测试脚手架之后。实现代码。现在，您甚至可以在通过自己的测试时知道自己的进步情况（这是一个很好的动力！）

从个人经验来看，测试可能是多余的唯一情况是，当您制作早期原型时，因为那时您还没有充分理解问题，无法准确地设计或测试您的代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T05:53:52.470

完成软件分为三个步骤：

1.  让它起作用
2.  改正它
3.  快一点

测试让你#1。您的代码不会因为测试通过而完成。在开始编写测试/代码之前，最好有一些项目结构的概念（实用程序、常用对象、层、框架）。在编写代码以使测试通过之后，您需要重新评估它以查看哪些部分可以重构到应用程序的不同方面。Yuo 可以自信地做到这一点，因为您知道只要您的测试仍然通过，您的代码仍然可以正常工作（或至少满足要求）。

在项目开始时，考虑结构。随着项目的进行，继续评估和重新评估您的代码，以保持设计到位或在设计不再有意义时更改设计。估算时必须考虑所有这些项目，否则最终会得到意大利面条代码，TDD 与否。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-05T13:37:09.507

这里有许多非正式的意见，包括流行的意见（来自 Jon Limjap），即错误的结果来自于做错，以及似乎只有个人经验支持的说法。优势经验证据和已发表的结果指向与该经验相反的方向。

该*理论*认为，一种要求您在代码之前编写测试的方法将导致在单个代码片段的级别上考虑设计——即小型编程。由于程序是您可以测试的全部（您仍然一次测试一种方法，并且您根本无法测试大多数语言中的类），您的设计重点是各个方法以及它们的组合方式。从理论上讲，这会导致自下而上的程序设计，进而导致对象之间的不良耦合和内聚。

广泛的经验数据证实了这一理论。Sniaalto 和 Abrahamsson，（*关于测试驱动开发对程序设计和测试覆盖的影响的比较案例研究*），ESEM 2007，发现“我们的结果表明内聚可能更差（尽管贝克声称 TDD 产生了高度内聚的系统） ). 在我们的第二项研究中，我们注意到 TDD 的复杂性度量更好，但依赖管理度量显然更差。Janzen 和 Saledian（*测试驱动开发真的提高了软件设计质量吗？* IEEE 软件 25(2)，2008 年 3 月/4 月，第 77 - 84 页）发现“[T] 结果不支持关于低耦合和增加与 TDD 的凝聚力”。

文献综述将发现其他出版物进一步推动这些案例。

甚至我亲爱的朋友鲍勃叔叔也写道：“敏捷开发中一个更阴险、更持久的神话是前期架构和设计是不好的；你永远不应该花时间预先做出架构决策。相反，你应该发展你的架构“从零开始设计，一次一个测试用例。对不起，那是马屁。” （“敏捷架构的 Scatology”， [http://blog.objectmentor.com/articles/2009/04/25/the-scatology-of-agile-architecture](http://blog.objectmentor.com/articles/2009/04/25/the-scatology-of-agile-architecture)）

**然而**，值得注意的是，更广泛的失败在于人们认为它是一种测试技术，而不是一种设计技术。Osherov 指出了许多通常被随便等同于 TDD 的方法。我不确定这里的海报是什么意思。请参阅：[http](http://weblogs.asp.net/rosherove/archive/2007/10/08/the-various-meanings-of-tdd.aspx) ://weblogs.asp.net/rosherove/archive/2007/10/08/the-various-meanings-of-tdd.aspx 。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T05:24:29.110

它始终是一种平衡：
- 过多的 TDD，你最终得到的代码可以工作，但工作起来很痛苦。
- 太多“可维护的代码、简洁的设计和健全的架构”，最终你会遇到让自己陷入编码瘫痪的[架构宇航员](http://www.joelonsoftware.com/articles/fog0000000018.html)

凡事适度。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T06:18:39.540

我对 TDD 和单元测试比较陌生，但是在我使用它的两个副项目中，我发现它是设计*助手*而不是设计的替代品。独立测试和验证组件/子组件的能力使我更容易进行快速更改和尝试新的设计理念。

我在 TDD 中体验到的不同之处在于可靠性。在设计过程开始时而不是以后在较小级别的组件上解决组件接口的过程是，我有我可以相信的组件会*更早*地工作，所以我可以不再担心小块，而是得到致力于解决棘手的问题。

当我不可避免地需要回来维护小部件时，我可以花*更少的*时间来做这件事，这样我就可以回到我想做的工作上。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T06:27:05.480

在大多数情况下，我同意 TDD 确实提供了一种设计工具。对我来说最重要的部分是它建立了进行更多更改的能力（你知道，当你有瞬间的洞察力时，你可以通过删除代码来添加功能），同时大大降低了风险。

也就是说，我最近承包的一些算法工作在没有仔细平衡设计思想的情况下在 TDD 下受到了一些影响。上面关于更安全的重构的声明仍然是一个很大的好处，但是对于某些算法，TDD（尽管仍然有用）不足以让您获得理想的解决方案。以排序为例。TDD 很容易导致您使用次优 (N^2) 算法（以及允许您重构为快速排序的大量通过测试），例如冒泡排序。TDD 是一个工具，一个非常好的工具，但就像许多东西一样，需要根据正在解决的问题的上下文来适当地使用它。

# c# - 通过反射实现接口

> ID：80247
> 
> 赞同：40
> 
> 时间：2008-09-17T05:20:42.723
> 
> 标签：c#, reflection, interface

如何通过 C# 中的反射获得接口的所有实现？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-09-17T06:11:51.710

答案是这样的；它搜索整个应用程序域——即应用程序当前加载的每个程序集。

```
/// <summary>
/// Returns all types in the current AppDomain implementing the interface or inheriting the type. 
/// </summary>
public static IEnumerable<Type> TypesImplementingInterface(Type desiredType)
{
    return AppDomain
           .CurrentDomain
           .GetAssemblies()
           .SelectMany(assembly => assembly.GetTypes())
           .Where(type => desiredType.IsAssignableFrom(type));
} 
```

它是这样使用的；

```
var disposableTypes =  TypesImplementingInterface(typeof(IDisposable)); 
```

您可能还希望此函数查找实际的具体类型——即过滤掉抽象、接口和泛型类型定义。

```
public static bool IsRealClass(Type testType)
{
    return testType.IsAbstract == false
         && testType.IsGenericTypeDefinition == false
         && testType.IsInterface == false;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T05:43:42.183

看看`Assembly.GetTypes()`方法。它返回可以在程序集中找到的所有类型。您所要做的就是遍历每个返回的类型并检查它是否实现了必要的接口。

这样做的方法是使用`Type.IsAssignableFrom`方法。

这是示例。`myInterface`是您正在搜索的接口和实现。

```
Assembly myAssembly;
Type myInterface;
foreach (Type type in myAssembly.GetTypes())
{
    if (myInterface.IsAssignableFrom(type))
        Console.WriteLine(type.FullName);
} 
```

我确实相信这不是解决您的问题的一种非常有效的方法，但至少，这是一个很好的起点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T05:49:54.040

```
Assembly assembly = Assembly.GetExecutingAssembly();
List<Type> types = assembly.GetTypes();
List<Type> childTypes = new List<Type>();
foreach (Type type in Types) {
  foreach (Type interfaceType in type.GetInterfaces()) {
       if (interfaceType.Equals(typeof([yourinterfacetype)) {
            childTypes.Add(type)
            break;
       }
  }
} 
```

也许是这样的......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-24T02:43:23.617

[正如Simon Farrow](https://stackoverflow.com/users/35047/simon-farrow)所建议的，这里有一些[`Type`](http://msdn.microsoft.com/en-us/library/system.type.aspx)可能对此有用的扩展方法。此代码只是对已接受答案的重组。

### 代码

```
/// <summary>
/// Returns all types in <paramref name="assembliesToSearch"/> that directly or indirectly implement or inherit from the given type. 
/// </summary>
public static IEnumerable<Type> GetImplementors(this Type abstractType, params Assembly[] assembliesToSearch)
{
    var typesInAssemblies = assembliesToSearch.SelectMany(assembly => assembly.GetTypes());
    return typesInAssemblies.Where(abstractType.IsAssignableFrom);
}

/// <summary>
/// Returns the results of <see cref="GetImplementors"/> that match <see cref="IsInstantiable"/>.
/// </summary>
public static IEnumerable<Type> GetInstantiableImplementors(this Type abstractType, params Assembly[] assembliesToSearch)
{
    var implementors = abstractType.GetImplementors(assembliesToSearch);
    return implementors.Where(IsInstantiable);
}

/// <summary>
/// Determines whether <paramref name="type"/> is a concrete, non-open-generic type.
/// </summary>
public static bool IsInstantiable(this Type type)
{
    return !(type.IsAbstract || type.IsGenericTypeDefinition || type.IsInterface);
} 
```

### 例子

要在调用程序集中获取可实例化的实现者：

```
var callingAssembly = Assembly.GetCallingAssembly();
var httpModules = typeof(IHttpModule).GetInstantiableImplementors(callingAssembly); 
```

获取当前 AppDomain 中的实现者：

```
var appDomainAssemblies = AppDomain.CurrentDomain.GetAssemblies();
var httpModules = typeof(IHttpModule).GetImplementors(appDomainAssemblies); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T10:12:29.930

您必须遍历您感兴趣的所有程序集。从程序集中您可以获得它定义的所有类型。请注意，当您执行 AppDomain.CurrentDomain.Assemblies 时，您只会获得已加载的程序集。直到需要时才会加载程序集，这意味着您必须在开始搜索之前显式加载程序集。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T05:36:34.337

您的意思是 Type 实现的所有接口吗？

像这样：

```
ObjX foo = new ObjX();
Type tFoo = foo.GetType();
Type[] tFooInterfaces = tFoo.GetInterfaces();
foreach(Type tInterface in tFooInterfaces)
{
  // do something with it
} 
```

希望有帮助。

# .net - 如何让某人开始使用 ALT.NET

> ID：80258
> 
> 赞同：5
> 
> 时间：2008-09-17T05:21:58.833
> 
> 标签：.net, alt.net

向 .NET 开发人员或用户组解释的主题顺序是什么，以使他们开始并对 alt.net 工具和实践感兴趣。

*   甲骨文
*   国际奥委会
*   TDD
*   DDD
*   DSL
*   CI
*   MVC-MVP
*   版本控制（我认为这是他们获得最快的版本）
*   敏捷
*   等等等等……

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T05:46:32.723

ALT.NET 与其说是一套工具和实践，不如说是一种态度。

我不知道您本身可以“让某人开始使用 ALT.NET”。

* * *

对我来说，这是一种经验产生的态度，而不是像外套一样可以穿上的东西。但这是*我的*看法，可能会发生变化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T05:47:10.490

开车回家的基本原则是：

*   Microsoft 工具是一个很好的起点，但可以通过使用其他配套产品更快地编写更好的软件
*   改变是好的，所以总是想着可以快速改变和验证代码的方法
*   如果没有经过测试，就不是生产质量

然后，在版本控制（！）之后，我将从持续集成开始，并展示如何从一开始就获得关于构建质量的即时反馈有助于提高质量。先做 CI 不会改变代码库。

然后我会介绍使用 FitNesse、Watin 或类似的应用程序的自动化端到端测试。然后，这应该说明如果您拥有可以验证代码是否仍然有效的良好测试工具，那么重构代码是如何不可怕的。

然后我会进行温和的重构，从 UI 中分离出业务逻辑和域对象（如果它们不存在的话）并引入单元测试。这进一步表明重构是一件好事。

当我们的目标是实现某种关注点分离时，设计模式（例如 IoC）自然会开始变得明显。很明显，我们可以用 ORM 替换数据层。

在我们重构的过程中，我还将展示测试驱动开发如何真正加速创建更好的代码。这可能是新开发的第一次最简单的展示，否则它会引起文化冲击！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T19:02:15.680

我认为这取决于个人或团体。几乎所有商店都接触过这些概念之一。从那里开始，我只会以您认为开发人员或团队可以吸收它们的速度来介绍新概念。看到团队开始拒绝一些重要的原则和概念，因为它们负担过重，这是非常令人沮丧的。并且尽量不要*假设*有人理解使用 CI、IoC 或模拟框架背后的原则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:36:09.173

我并不是说成为*ALT.NETter*只是为了让他们知道这些东西就在那里，而是以一种他们可以理解并觉得它可以帮助他们的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:33:16.620

我想很多人不知道泛型、委托、Linq 和 Lambda 表达式。
如果你会在同一时间告诉他们，那么他们就会放弃一切。

就像您不会教初学者程序员什么是 DSL，但您可以让他了解 SVN。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T16:38:36.837

Alt.NET [Podcast](http://altnetpodcast.com/)可能是获得一些想法的好地方。他们有关于持续改进、敏捷、DI/IoC、ORM、OOP w/Ruby 等的播客（按此顺序）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-05T18:32:08.367

对我来说，是一位支持 IoC/DI 和 TDD 的同事。他还让我加入了 .net 用户组，这样我就可以看出他不仅仅是一个为了使用新技术而喜欢使用新奇奇怪技术的一次性疯子。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-16T12:35:37.243

我将使用 Nancy 和 C#（或 Boo、Iron* 等其他语言）使用 SharpDevelop（有这本书）或 Rider（JetBrains 的 C# IDE）构建一个 Web 应用程序。我将 Alt.NET 视为非 Microsoft .net 开发，特别专注于开源，有时还有开箱即用的思维。现在每年在俄勒冈州波特兰举行的 .NET Fringe 会议，迎合了这种对开发的态度。

# sql-server - 如何使用生产数据库中的数据刷新训练数据库？

> ID：80271
> 
> 赞同：2
> 
> 时间：2008-09-17T05:24:00.920
> 
> 标签：sql-server, ssis

我在网络上有一个特定的系统，我们需要在其中维护培训安装。系统使用SQL Server 2000作为数据库引擎，我需要建立一个系统，定期用生产数据库中的数据刷新训练数据库中的数据。

我想使用 SSIS，因为我们有可以运行该过程的 SQL 2005 服务器。我有相当多的 SQL 经验，但对 SSIS 的经验不多。我一直在尝试使用“传输数据库任务”来执行此操作，但运气不佳，因为它总是会引发错误。

如果我们忽略配置项等的使用并假装所有数据库名称等都是硬编码的，我有以下内容：具有以下属性的单个 SSIS“传输数据库任务”：

*   目的地覆盖：真
*   行动：复制
*   方法：数据库在线

我收到的错误是：

> 错误：任务上的 Execute 方法返回错误代码 0x80131500（错误：errorCode=-1073548784 描述=执行查询“EXEC dbo.sp_addrole @rolename = N'XXXXX'”失败，出现以下错误：“角色'XXXXX'已经存在于当前数据库中。”。可能的失败原因：查询有问题，“ResultSet”属性设置不正确，参数设置不正确，或连接未正确建立。helpFile= helpContext=0 idofInterfaceWithError={8BDFE893-E9D8-4D23- 9739-DA807BCDC2AC}）。Execute 方法必须成功，并使用“out”参数指示结果。

我敢肯定这里发生了一些明显的事情，但是如果任务设置为覆盖角色的预先存在，那么肯定不重要吗？有谁知道我需要做什么才能让这个工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T12:24:12.830

显然这应该在 SQLServer 2005 SP2 中修复，[请参见此处](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=473590&SiteID=1)。如果您从 Visual Studio 中运行 SSIS 包，您似乎也需要确保修补客户端计算机。

# javascript - 在 ColdFusion 中使用 Google 地图

> ID：80278
> 
> 赞同：1
> 
> 时间：2008-09-17T05:25:47.937
> 
> 标签：javascript, google-maps, coldfusion

我正在尝试在作为边框类型 cflayoutarea 容器的 ColdFusion 模板中使用 Google Maps API。但是，地图根本不显示：

```
<cfif isdefined("url.lat")>
    <cfset lat="#url.lat#">
    <cfset lng="#url.lng#">
</cfif>    
<head>
<script src=                        "http://maps.google.com/maps?file=api&amp;v=2&amp;key=xxxx" type="text/javascript">
        function getMap(lat,lng){       
            if (GBrowserIsCompatible()) {        
                var map = new GMap2(document.getElementById("map_canvas"));
                var pt= new GLatLng(lat,lng);
                map.setCenter(pt, 18,G_HYBRID_MAP);      
                map.addOverlay(new GMarker(pt));
            }    
        }    
</script>
</head>  
<cfoutput>
<body onLoad="getMap(#lat#,#lng#)" onUnload="GUnload()">
    Map:<br>
    <div id="map_canvas" style="width: 500px; height: 300px"/>
</body>
</cfoutput>" 
```

其中 lat 和 lng 是 degree.decimal 格式的坐标。我已经追溯到 GBrowserIsCompatible() 以某种方式永远不会返回 TRUE 的行，因此没有采取进一步的行动。

如果单独打开，模板可以完美运行，但作为 cflayoutarea 容器打开时就不行了。有人有这方面的经验吗？任何建议都非常感谢。

劳伦斯

使用 CF 8.01、Dreamweaver 8

* * *

尝试了您的建议，但仍然无效；该地图仅在调用代码内联时显示。但是，如果从另一个 div 调用此容器页面，则地图会再次消失。

我怀疑这个问题与 cflayout 容器有关；我将查找 Extjs 文档以查看是否有任何解决方案的线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T08:08:31.973

成功！（有点...）

终于让它工作了，但不是亚当建议的方式：

```
<script src= "http://maps.google.com/maps?file=api&amp;v=2&amp;key=xxxx" type="text/javascript"></script>
<script type="text/javascript">
    getMap=function(lat,lng){               
        if (GBrowserIsCompatible()){
            var map = new GMap2(document.getElementById("map_canvas"));
            var pt = new GLatLng(lat,lng);
            map.setCenter(pt, 18,G_HYBRID_MAP);      
            map.addOverlay(new GMarker(pt));  
        }    
    }
</script>  

 <cflayout name="testlayout" type="border">
    <cflayoutarea name="left" position="left" size="250"/>
     <cflayoutarea name="center" position="center"> 
            <!--- sample hard-coded co-ordinates --->
        <body onLoad="getMap(22.280161,114.185096)">
        Map:<br />
        <div id="map_canvas" style="width:500px; height: 300px"/>
        </body>
      </cflayoutarea> 
<!---       <cflayoutarea name="center" position="center" source="map_content.cfm?lat=22.280161&lng=114.185096"/> --->
</cflayout> 
```

整个内容必须包含在同一个文件中，否则将无法正常工作。我的怀疑是 getElementByID 函数，就目前而言，不能不引用其自身文件之外的元素。如果 div 在另一个文件中（如在 Adam 的示例中），它会导致未定义的地图，即创建了地图对象但其中没有任何内容。

所以我认为这个问题现在被提升到了一个不同的层次：你如何引用一个 ajax 容器内的元素？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T12:45:14.483

> 所以我认为这个问题现在被提升到了一个不同的层次：你如何引用一个 ajax 容器内的元素？

应该可以引用通过 AJAX 加载的元素——直到元素出现在屏幕上（所以不在页面加载时）。看起来 getMap() 触发了一切。（是对的吗？）

试试这个：将您拥有的内容作为地图选项卡的内联内容，并将其作为 map_content.cfm 的内容；**然后**在定义 div 之后，不要使用 body onload 来触发事件，而是将其写入内联：

```
<body>
    Map:<br />
    <div id="map_canvas" style="width:500px; height: 300px"/>
    <script type="text/javascript">
        getMap(22.280161,114.185096);
    </script>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T05:29:02.593

也许布局区域没有正确的**样式**。我想你可能需要给 map_canvas 一个

```
position: absolute 
```

或者

```
position: relative 
```

那只是一种预感。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:01:45.530

CFLayoutArea 是 ColdFusion 版本 8 中新增的 AJAX 标签。（除了 CFWindow、CFDiv 等标签之外）

在任何这些新标签的 AJAX 加载内容中，必须从包含页面包含外部 JavaScript。在您的情况下，这将是包含 <cflayout> 标记的页面。

尝试这样的事情：

在 index.cfm （或任何包含文件）中：

```
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=xxxx" type="text/javascript">
    function getMap(lat,lng){               
        if (GBrowserIsCompatible()) {        
            var map = new GMap2(document.getElementById("map_canvas"));
            var pt= new GLatLng(lat,lng);
            map.setCenter(pt, 18,G_HYBRID_MAP);      
            map.addOverlay(new GMarker(pt));
        }    
    }
</script>
<cflayout>...</cflayout> 
```

map.cfm（地图 CFLayout 选项卡的内容）：

```
<cfif structKeyExists(url, "lat")>
    <cfset variables.lat = url.lat />
    <cfset variables.lng = url.lng />
</cfif>    
<head></head>  
<cfoutput>
    <body onLoad="getMap(#variables.lat#,#variables.lng#)" onUnload="GUnload()">
        Map:<br>
        <div id="map_canvas" style="width: 500px; height: 300px"/>
    </body>
</cfoutput> 
```

# javascript - 什么工具生成 JavaScript？

> ID：80284
> 
> 赞同：4
> 
> 时间：2008-09-17T05:26:41.350
> 
> 标签：javascript

有没有生成 JavaScript 的好工具？我记得在 .NET 中有 Script# - 今天不知道它的状态。

有人有使用任何工具的经验吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T05:37:51.963

我使用键盘、文本编辑器和大脑来生成 JavaScript。

:P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T06:51:53.657

正如其他人所说，[GWT](http://code.google.com/webtoolkit/)是一个非常好的选择。总结一些优点：

*   **使用延迟绑定**的快速、非常便携的代码；**只加载在用户浏览器上工作的代码，只加载实际调用的函数；而且，它们被压缩了**
***   **可靠性**；很少有已知问题*   **使用基于 Java 的 IDE**更容易调试；**如果您愿意，您也可以直接查看未混淆的 javascript，但似乎（根据我见过的一些报告和个人经验）您基本上不需要这个*****   **良好的库支持**，包括良好的内联 javascript 接口、使用现有 Java 库的能力以及对 ajax / rpc 调用的特殊支持*   **可扩展且风格灵活**；您可以使用自己的 css 规则微调所有样式，并使用自己的 Java 子类扩展 Widget 基础****

 ****所以我谦虚地不同意 dominic 的结果是丑陋的，因为由编码人员用他们自己的 css 规则和其他装饰来“美化”基本功能。将 HTML 称为“丑陋”是同样的错误——如果你不努力，它并不漂亮，但能力和灵活性掌握在编码人员手中。

哦，它也是开源的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T05:32:35.703

[最新版本的 Script#](http://projects.nikhilk.net/ScriptSharp/)是在不到一个月前发布的。Nikhil 继续积极致力于该项目，它是从 C# 生成 JavaScript 代码的非常好的工具。它被积极用于几个不同的内部 Microsoft 项目。

Script# 的一些好处是：

*   智能感知
*   在编译时构建错误
*   重构支持
*   文档支持
*   FxCop 代码分析
*   MSBuild 支持

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-08T12:06:28.367

不错的清单：[https ://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-c​​ompile-to-JS](https://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-compile-to-JS)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T05:32:10.073

目前有很多工具可以生成 JavaScript，比如 GWT。

但是给你一个好的答案真的取决于你的原创语言是什么，以及你想使用什么样的 JavaScript 功能之王。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T05:33:49.883

[Google Web Toolkit](http://code.google.com/webtoolkit/)是一种选择。编写 Java 代码，使用标准 Java 调试器对其进行调试，然后按下“编译”按钮并将其转换为高度优化的 JavaScript。它为每个主要浏览器系列（IE、Firefox、Safari 等）生成完全独立的 JavaScript。

非常成熟，非常强大，并且易于嵌入到现有站点中。一个缺点是它创建的 UI 是丑陋的嵌套表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T19:18:33.847

试试[Haxe](http://haxe.org/)。

它可以针对 JavaScript、ActionScript 和 Neko 字节码。该语言接近Java。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T05:46:36.077

我使用 D 模板（想想 C++ 没有痛苦，你会在那里 50%）生成一个基于 AJAX 的对象代理。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-29T12:41:55.887

Kotlin 可以从 Kotlin 代码生成 JavaScript。对于 Kotlin，请参阅[http://kotlin.jetbrains.org/](http://kotlin.jetbrains.org/)和[http://devnet.jetbrains.com/thread/447468?tstart=0](http://devnet.jetbrains.com/thread/447468?tstart=0)

# .net - 如何从我的 .NET 解决方案构建“依赖关系树图”

> ID：80287
> 
> 赞同：11
> 
> 时间：2008-09-17T05:26:52.973
> 
> 标签：.net, reflection, dependencies

我可以从 Visual Studio .NET 项目中轻松查看单个项目引用的项目和 dll。

是否有任何应用程序或反射的使用可以为我构建一个完整的依赖关系树，我可以使用它来绘制依赖关系的图形图表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-21T09:49:51.690

NDepend 带有一个交互式依赖图和一个依赖矩阵。您可以[下载并使用 NDepend 的免费试用版](http://www.ndepend.com/NDependDownload.aspx)一段时间。

[更多关于 NDepend 依赖图](http://www.ndepend.com/Doc_VS_Arch.aspx) ![在此处输入图像描述](https://i.stack.imgur.com/D3cYI.png)

[更多关于 NDepend 依赖矩阵](http://www.ndepend.com/Doc_Matrix.aspx)： ![在此处输入图像描述](https://i.stack.imgur.com/zVHhe.png)

*免责声明：我是工具团队的一员*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-06T16:54:18.497

我需要类似的东西，但不想支付（或安装）工具来完成它。我[创建了一个快速的 PowerShell 脚本，它遍历项目引用并以](https://blog.dantup.com/2012/05/free-dependency-graph-generation-using-powershell-and-yuml/)[yuml.me](https://yuml.me/)友好格式将它们吐出：

```
Function Get-ProjectReferences ($rootFolder)
{
    $projectFiles = Get-ChildItem $rootFolder -Filter *.csproj -Recurse
    $ns = @{ defaultNamespace = "http://schemas.microsoft.com/developer/msbuild/2003" }

    $projectFiles | ForEach-Object {
        $projectFile = $_ | Select-Object -ExpandProperty FullName
        $projectName = $_ | Select-Object -ExpandProperty BaseName
        $projectXml = [xml](Get-Content $projectFile)

        $projectReferences = $projectXml | Select-Xml '//defaultNamespace:ProjectReference/defaultNamespace:Name' -Namespace $ns | Select-Object -ExpandProperty Node | Select-Object -ExpandProperty "#text"

        $projectReferences | ForEach-Object {
            "[" + $projectName + "] -> [" + $_ + "]"
        }
    }
}

Get-ProjectReferences "C:\Users\DanTup\Documents\MyProject" | Out-File "C:\Users\DanTup\Documents\MyProject\References.txt" 
```

[![示例图](https://i.stack.imgur.com/PH5br.png)](https://i.stack.imgur.com/PH5br.png)
[（来源：[yuml.me](https://yuml.me/4f30e632)）]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T05:30:19.097

除了 NDepend 之外，您还可以尝试使用[Reflector](http://www.codeplex.com/reflectoraddins/Wiki/View.aspx?title=Graph&referringTitle=Home)的这个插件来显示程序集依赖图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-19T00:43:58.570

您可以在 Visual Studio 2010 Ultimate 中创建项目和程序集的依赖关系图，方法是使用体系结构资源管理器浏览您的解决方案，选择您想要可视化的项目和关系，然后根据您的选择创建一个依赖关系图。

有关详细信息，请参阅以下主题：

**如何：从代码生成图形文档**：http : [//msdn.microsoft.com/en-us/library/dd409453%28VS.100%29.aspx#SeeSpecificSource](http://msdn.microsoft.com/en-us/library/dd409453%28VS.100%29.aspx#SeeSpecificSource)

**如何：使用架构资源管理器查找代码**：http : [//msdn.microsoft.com/en-us/library/dd409431%28VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd409431%28VS.100%29.aspx)

**RC 下载**：[http](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=457bab91-5eb2-4b36-b0f4-d6f34683c62a) ://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=457bab91-5eb2-4b36-b0f4-d6f34683c62a 。

**Visual Studio 2010 架构发现和建模工具**论坛：[http ://social.msdn.microsoft.com/Forums/en-US/vsarch/threads](http://social.msdn.microsoft.com/Forums/en-US/vsarch/threads)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-19T10:40:19.583

[Structure101](http://www.headwaysoftware.com/products/structure101/index.php)可以做到这一点。您可以按程序集和/或命名空间浏览模型，单击任何级别的任何依赖项都会为您提供导致依赖项的所有代码级引用。.NET 版本处于测试阶段，但它已可用于其他语言多年，因此非常成熟。这是一个示例屏幕截图。 [替代文字 http://www.headwaysoftware.com/images/assemblies.jpg](http://www.headwaysoftware.com/images/assemblies.jpg)

# sql-server - 授予对数百个 SP 的访问权限？

> ID：80291
> 
> 赞同：2
> 
> 时间：2008-09-17T05:27:06.887
> 
> 标签：sql-server, security, stored-procedures

在 Sql Server 2000/2005 中，我有几个 NT 用户组需要被授予访问数百个存储过程的权限。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T05:42:36.040

*   在 sql server 中创建一个角色。
*   编写一个脚本，授予该角色使用这些存储过程的权限。
*   将那些 NT 用户组添加到该角色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:19:37.533

这是我用于授予许多程序权限的脚本：

```
DECLARE @DB  sysname ; set @DB = DB_NAME()
DECLARE @U  sysname ; set @U = QUOTENAME('UserID')

DECLARE @ID           integer,
        @LAST_ID     integer,
        @NAME        varchar(1000),
        @SQL         varchar(4000)

SET @LAST_ID = 0

WHILE @LAST_ID IS NOT NULL
BEGIN
    SELECT @ID = MIN(id)
    FROM dbo.sysobjects
    WHERE id > @LAST_ID  AND type = 'P' AND category = 0

    SET @LAST_ID = @ID

    -- We have a record so go get the name
    IF @ID IS NOT NULL
    BEGIN
        SELECT @NAME = name
        FROM dbo.sysobjects
        WHERE id = @ID

        -- Build the DCL to do the GRANT
        SET @SQL = 'GRANT EXECUTE ON ' + @NAME + ' TO ' + @U

        -- Run the SQL Statement you just generated
        EXEC master.dbo.xp_execresultset @SQL, @DB

    END   
END 
```

您可以修改选择以获取更具体的一组存储过程。

# php - mysqli_stmt::num_rows() 返回错误值

> ID：80292
> 
> 赞同：1
> 
> 时间：2008-09-17T05:27:09.460
> 
> 标签：php, mysql, mysqli

我正在使用 mysqli 类和准备好的语句在 PHP 中编写数据库处理程序类。我试图打印出结果。它没有立即工作，所以我决定进行一些调试。我尝试使用类中的`num_rows()`方法`mysqli_statement`，但它一直返回 0。我决定编写一小部分测试代码以使其更简单，这样我就可以看到出了什么问题。然后我能够返回我想要的数据，但该`num_rows()`方法仍然返回 0，即使它实际上是在选择和检索一些数据。这是代码：

```
$mysqli = new mysqli('localhost', 'username', 'password', 'database');
if(mysqli_connect_errno())
{
  die('connection failed');
}

$statement = $mysqli->stmt_init();

$query = "SELECT name FROM table WHERE id = '2000'";
if($statement->prepare($query))
{
    $statement->execute();
    $statement->bind_result($name);
    $statement->fetch();
    $statement->store_result();
    echo $statement->num_rows();
    echo $name; 
}
else
{
    echo 'prepare statement failed';
    exit();
} 
```

预期结果是：

```
1name 
```

实际结果是：

```
0name 
```

谁能告诉我这是为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T05:56:09.127

我想知道 num_rows() 是否相对于当前结果集进行报告。在获取数据之前尝试捕获 num_rows() 。例如

```
if($statement->prepare($query))
{
    $statement->execute();
    $statement->store_result();
    echo $statement->num_rows();
    $statement->bind_result($name);
    $statement->fetch();
    echo $name; 
} 
```

这有什么影响吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T00:33:49.523

`num_rows`不是方法，而是属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-05T23:48:44.863

为了能够使用`mysqli_stmt::num_rows(),`，您需要将所有行提取到 PHP 中。有两种获取所有内容的方法：使用缓冲`store_result()`或使用手动获取所有行`fetch()`。

`fetch()`在您的情况下，您已经通过调用一次开始手动获取。`store_result()`当另一个提取过程正在进行时，您无法调用。调用`store_result()`失败并出现错误*。

```
$statement->fetch();
$statement->store_result(); // produces error. See $mysqli->error;
echo $statement->num_rows(); 
```

最简单的解决方案是交换调用这两种方法的顺序。

```
$statement->store_result();
$statement->fetch(); // This will initiate fetching from PHP buffer instead of MySQL buffer
echo $statement->num_rows(); // This will tell you the total number of rows fetched to PHP 
```

[* 由于PHP中的一个bug，在异常报错模式下这个错误不会触发异常。错误消息只能通过`mysqli_error()`函数或其相应的属性看到。]

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-17T05:51:42.460

看起来你没有声明 $name。

另外，请尝试删除 bind_result() 和 fetch() 使其显示如下内容：

```
$statement->execute();

$statement->store_result();

printf("Number of rows: %d.\n", $statement->num_rows); 
```

# vb6 - Visual Basic 项目的测试覆盖率

> ID：80305
> 
> 赞同：3
> 
> 时间：2008-09-17T05:31:00.670
> 
> 标签：vb6, code-coverage

我们正在开发一个 Visual Basic 6.0 项目。我们编写了一个库，我们正在使用 vbunit 和 vbmock 对其进行测试。但很快发现测试是不可维护的。因此，我们决定使用 MBunit 编写测试。现在，我们想知道测试覆盖率。我们该怎么做？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-12T19:37:52.020

我知道的唯一 VB6 测试覆盖工具是[http://www.aivosto.com/vbwatch.html](http://www.aivosto.com/vbwatch.html) Aivisto 似乎因其 VB 工具而享有盛誉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T05:36:28.643

看看NCover

# vb6 - Windows 壁纸：不只是 BMP？

> ID：80307
> 
> 赞同：3
> 
> 时间：2008-09-17T05:31:17.690
> 
> 标签：vb6, registry, desktop-wallpaper

我在几个地方读过桌面壁纸可以设置为 HTML 文档。有没有人成功地以编程方式改变它？

下面的 VB6 片段帮助我设置 BMP，但是当我尝试将它用于 HTML 时，我得到了一个漂亮的蓝色背景，没有别的。

```
Dim reg As New StdRegistry

Public Function CurrentWallpaper() As String
    CurrentWallpaper = reg.ValueEx(HKEY_CURRENT_USER, "Control Panel\Desktop", "Wallpaper", REG_SZ, "")
End Function

Public Sub SetWallpaper(cFilename As Variant)
    reg.ClassKey = HKEY_CURRENT_USER
    reg.SectionKey = "Control Panel\Desktop"
    reg.ValueKey = "Wallpaper"
    reg.ValueType = REG_SZ
    reg.Default = ""
    reg.Value = cFilename
End Sub

Public Sub RefreshDesktop()
    Dim oShell As Object
    Set oShell = CreateObject("WScript.Shell")
    oShell.Run "%windir%\System32\RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 1, True
End Sub 
```

也许还需要一些其他设置。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T05:40:20.490

我认为您需要确保“活动桌面”已打开。

您可以尝试设置`HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\ForceActiveDesktopOn`为`1`（在[此处](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/93205.mspx?mfr=true)找到）。

我没试过，所以不能保证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T01:59:16.457

[好的，感谢Experts Exchange](http://www.experts-exchange.com/OS/Microsoft_Operating_Systems/Windows/XP/Q_23739345.html)上的 egl1044，我找到了问题的答案。本质上，必须与 IActiveDesktop 对象对话。在 VB6 中，一个很好的实现可以在[VB6 - JPEGs as wallpapers (without conversion)](http://www.vbforums.com/showthread.php?t=367342)中找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T15:28:28.423

我不确定是否有官方的 API，但如果你有心，你可以使用 Sysinternal 的[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)并查看当你通过 UI 设置 HTML 桌面背景时会触及哪些注册表项。然后你只需要在你的代码中重复这些编辑。但是，就向后/向前兼容性而言，API 调用会更可取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:37:58.717

越来越近：[http ://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/w2rkbook/gp.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/w2rkbook/gp.mspx?mfr=true)

* * *

但事实证明，我在政策领域偏离了方向。我真正想要的是在用户空间中设置桌面并让策略设置保持不变。在这里找到了一些有用的东西：http: [//blogs.msdn.com/coding4fun/archive/2006/10/31/912569.aspx](http://blogs.msdn.com/coding4fun/archive/2006/10/31/912569.aspx)。

然而，这不是最终的解决方案。HTML 桌面的控制仍然遥不可及。

* * *

似乎 HTML 设置存储在 HKCU\Software\Microsoft\Internet Explorer\Desktop\General 中。但是，仅将它们存储在这里似乎还不够。我仍然需要找到让 Windows 知道要使用哪组注册表值的机制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T15:18:22.380

我只推荐 BMP 格式。不要使用 ActiveDesctop，因为之后您的 PC 会运行缓慢。

# asp.net - 如何使用 ajax 预览 url？

> ID：80313
> 
> 赞同：0
> 
> 时间：2008-09-17T05:33:47.603
> 
> 标签：asp.net, ajax

如何使用 ajax 预览 url？我已经看到使用搜索引擎插件完成此操作，并想了解如何执行此操作。具体来说，我希望能够将鼠标悬停在链接上并使用 ajax 查看网页的预览。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T05:44:21.497

有**简单**的解决方案、**困难**的解决方案和**使用库的**解决方案。

**use-a-library**：我更喜欢总是使用 use-a-library 解决方案，除非你有很好的理由。一个将“硬解决方案”包装为您的服务的可能站点：http: [//thumbnails.iwebtool.com/demo/](http://thumbnails.iwebtool.com/demo/)

**easy**：简单的解决方案是将目标网页加载为缩小的 AJAXy 窗口。您可以为此任务使用许多 Lightbox 类插件，尤其是那些允许您针对 Lightbox 窗口定位任意 HTTP 内容的插件。 [GreyBox](http://www.orangoo.com/labs/GreyBox/)是我以前用过的那些中我最喜欢的。 [Lightbox Gone Wild](http://particletree.com/features/lightbox-gone-wild/)也不错。

**hard**：然后是困难的解决方案：您需要渲染网页服务器端，将渲染缓存为图像，然后使用 Lightbox-esque Javascript 提供该图像（这在其他要求旁边是微不足道的）。你将如何做这件事超出了这个框的范围。你为什么要这样做？预览版为客户端生成的速度要快得多，并且它将客户端的会话与可能在目标网站中破坏它的事物隔离开来——即使在 AJAXy 中打开它们时，行为不佳的 Javascript 和/或恶意软件也会导致非常糟糕的事情窗中窗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T05:46:05.873

我想我知道他在说什么。发生的情况是，他希望在将鼠标悬停在超链接 (javascript) 上时出现一个窗口，并让该窗口显示超链接所引用的网站的快照图像。

ajax 部分以异步方式连接到您托管站点的服务器，并点击一个页面，该页面将获取站点图像以显示在 img 标记中。

现在，如何生成网站的图像？我建议提前完成（例如在创建内容时）并调用已经生成的图像。

如何生成图像开始？我认为这将是另一个问题：“如何生成网站的快照图像？”

# php - 如何在 PHP 中将 00:00:00 转换为小时、分钟、秒？

> ID：80319
> 
> 赞同：5
> 
> 时间：2008-09-17T05:35:41.673
> 
> 标签：php, date

我有以 HH:MM:SS 格式存储的视频时长。我想将其显示为 HH 小时、MM 分钟、SS 秒。如果小于 1，则不应显示小时数。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T05:47:43.920

像这样的东西？

```
$vals = explode(':', $duration);

if ( $vals[0] == 0 )
   $result = $vals[1] . ' minutes, ' . $vals[2] . ' seconds';
else
   $result = $vals[0] . 'hours, ' . $vals[1] . ' minutes, ' . $vals[2] . ' seconds'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T05:51:18.437

尝试使用拆分

```
list($hh,$mm,$ss)= split(':',$duration); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T05:53:16.887

一个小小的改变可能是：

```
$vals = explode(':', $duration);

if ( $vals[0] == 0 )
   $result = "{$vals[1]} minutes, {$vals[2]} seconds";
else
   $result = "{$vals[0]} hours, {$vals[1]} minutes, {$vals[2]} seconds"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T06:06:17.387

很简单：

```
list( $h, $m, $s) = explode(':', $hms);
echo ($h ? "$h hours, " : "").($m ? "$m minutes, " : "").(($h || $m) ? "and " : "")."$s seconds"; 
```

这将只显示小时或分钟（如果有），如果有小时、分钟或两者都显示，则在秒前插入一个“和”。如果你想变得非常花哨，你可以添加一些代码来适当地显示“小时”与“小时”，分钟和秒也是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:57:27.440

当 php 处理时间很好时，为什么还要打扰正则表达式或爆炸？

```
$sTime   = '04:20:00';
$oTime   = new DateTime($sTime);
$aOutput = array();
if ($oTime->format('G') > 0) {
    $aOutput[] = $oTime->format('G') . ' hours';
}
$aOutput[] = $oTime->format('i') . ' minutes';
$aOutput[] = $oTime->format('s') . ' seconds';
echo implode(', ', $aOutput); 
```

The benefit is that you can reformat the time however you like (including am/pm, adjustments for timezone, addition / subtraction, etc).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T06:10:36.783

这是一种不同的方式，具有不同的功能，对新手来说更开放，更循序渐进。它还处理 1 小时和许多小时......您可以尝试使用相同的逻辑来处理 0 分钟和 0 秒。

```
<?php
// your time
$var = "00:00:00";

if(substr($var, 0, 2) == 0){
    $myTime = substr_replace(substr_replace($var, '', 0, 3), ' Minutes, ', 2, 1);
}
elseif(substr($var, 1, 1) == 1){
$myTime = substr_replace(substr_replace($var, ' Hour, ', 2, 1), ' Minutes, ', 11, 1);   
    }
else{
$myTime = substr_replace(substr_replace($var, ' Hours, ', 2, 1), ' Minutes, ', 12, 1);
}
// work with your variable
echo  $myTime .' Seconds';

?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T07:09:32.740

如果您真的想使用内置函数，也许是为了健壮性，您可以尝试

```
 date_default_timezone_set('UTC'); 
 $date = strtotime($hms,0); 
```

并使用任何日期格式化函数（`date()`、`strftime()`等）以您希望的任何方式格式化时间。或者您可以使用`strptime($hms,'%T')`. 对于您拥有的简单场景，两者都可能是矫枉过正。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T08:03:31.520

我会用不同的方法来回答这个问题。我的方法是以秒为单位存储长度。然后根据需要，很容易将这些秒渲染为 hh:mm:ss 使用：

`print gmdate($seconds >= 3600 ? 'H:i:s' : 'i:s', $seconds);`（对于你的问题）

或在数据库中搜索长度：

`SELECT * FROM videos WHERE length > 300;`例如，搜索时长超过 5 分钟的视频。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-17T05:55:51.810

explode() 用于三色紫罗兰。这是[正则表达式](http://regular-expressions.info)的工作！

```
<?php
preg_match('/^(\d\d):(\d\d):(\d\d)$/', $video_duration, $parts);
if ($parts[1] !== '00') {
    echo("{$parts[1]} hours, {$parts[2]} minutes, {$parts[3]} seconds");
}
else {
    echo("{$parts[2]} minutes, {$parts[3]} seconds");
} 
```

完全未经测试，但类似的东西应该可以工作。请注意，此代码假定小时片段将*始终*为两位数（例如，三小时视频将`03:00:00`代替`3:00:00`）。

**编辑：**回想起来，为此使用正则表达式可能是过度设计的情况；explode() 也可以完成这项工作，在这种情况下甚至可能更快。但是当我阅读这个问题时，这是第一个想到的方法。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-17T07:23:21.210

在 PHP 中将 00:00:00 转换为小时、分钟和秒非常容易。

$小时 = 0; $分钟 = 0; $秒 = 0;

# language-agnostic - 波普勒编程

> ID：80320
> 
> 赞同：5
> 
> 时间：2008-09-17T05:35:46.773
> 
> 标签：language-agnostic, pdf, cross-platform, poppler

Poppler 是一个没有文档但您更愿意记录的经典示例。这个问题与语言无关，只是询问一般想法。简而言之，您如何使用 poppler 制作 PDF 查看器控件？
据我所知，您需要使用 poppler 将其渲染到某个表面，这听起来不错，直到您问自己用户将如何选择文本等。poppler 是否为其各种绑定提供了一个窗口，还是您必须自己编写代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T05:49:13.323

你必须自己编写代码——Poppler 只处理 PDF 部分，你必须编写 GUI。查看[Evince](http://www.gnome.org/projects/evince/)的代码以获得一个很好的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T12:59:34.037

poppler 发布下载现在包含一个 Qt4 包装器和一些您可以查看的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T11:16:53.023

如果您在 GLib 中制作应用程序，那么这里有很好的文档。[http://developer.gnome.org/poppler/unstable/index.html](http://developer.gnome.org/poppler/unstable/index.html)

如果您可以通过 doxygen 编译此文档，只需签出代码即可。:)

# sql-server - SQL Server 2008 Reporting Services 报表定义自定义扩展

> ID：80323
> 
> 赞同：0
> 
> 时间：2008-09-17T05:36:17.333
> 
> 标签：sql-server, sql-server-2008, documentation, reporting-services

我最近一直在研究 SQL2K8 中的报表定义自定义扩展 (RDCE)，但我一直找不到很多文档，甚至在 Internet 上都在谈论它。

MSDN有一个简要概述：http: [//msdn.microsoft.com/en-us/library/cc281022.aspx](http://msdn.microsoft.com/en-us/library/cc281022.aspx)

本书[http://www.amazon.com/Applied-Microsoft-Server-Reporting-Services/dp/0976635313/ref=pd_bbs_sr_2?ie=UTF8&s=books&qid=1221629676&sr=8-2](https://rads.stackoverflow.com/amzn/click/com/0976635313)的示例报告是一些东西，但是我想知道是否有人对此有真正的经验，以及它是如何为他们工作的。如果有人有其他值得一看的参考资料，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T22:31:41.550

[通常 MS 在 CodePlex ( http://www.codeplex.com/MSFTRSProdSamples](http://www.codeplex.com/MSFTRSProdSamples) )上发布示例。但我没有看到任何 RDCE 的例子。

抱歉，MS 从来没有很好的文档来报告扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T16:28:43.033

我不确定您要完成什么，但您可以为 SSRS 本地报告动态生成 RDL。

查看 MSDN 中[的这篇文章：创建 RDL 生成器 Visual Studio 项目](http://msdn.microsoft.com/en-us/library/ms167274.aspx)

有关动态 RDL 生成的更多示例，请查看此页面上的可下载示例文件（动态 RDL 示例位于页面右下角）：[gotreportviewer? Visual Studio 2008 中的 ReportViewer 控件](http://www.gotreportviewer.com/)

# c++ - 用于出站 SMTP 数据包捕获的最佳操作系统应用程序？

> ID：80341
> 
> 赞同：2
> 
> 时间：2008-09-17T05:42:59.643
> 
> 标签：c++, windows, smtp, packet-capture, spam-prevention

好的，所以这听起来可能非常邪恶，但我的高级项目需要这样的能力。本质上，我的任务是编写一些东西，通过数据包拦截和评估系统来减少僵尸电脑上的出站垃圾邮件。我们有许多算法将用于捕获的消息，但它是实际的捕获——完全是拦截而不是嗅探——让我有点难过。

该应用程序是为 Windows 设计的，所以我不能使用 IP 表。我可以使用 winpcap 库，但如果不需要，我不想重新发明轮子。Ettercap 似乎是一个不错的选择，但使用非官方二进制文件在 vista 上运行测试只会导致崩溃。

那么，有什么建议吗？

更新：很棒的建议。最终缩小了项目规模，但仍然获得了 A。我认为 Adam Mintz 的答案可能是最好的，尽管我们在应用程序中使用了 WinPcap 和 Wireshark。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T05:56:18.597

听起来您需要编写一个[Winsock LSP](http://en.wikipedia.org/wiki/Layered_Service_Provider)。

> 一旦进入堆栈，分层服务提供者就可以拦截和修改入站和出站 Internet 流量。它允许处理发生在 Internet 和访问 Internet 的应用程序之间的所有 TCP/IP 流量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T05:55:56.070

有人会认为[Wireshark](http://www.wireshark.org/)会解决您的问题 - 无需麻烦安装且非常易于使用。

编辑：啊，我现在看到拦截要求与只是嗅探..在这种情况下，仅 Wireshark 不会削减它。可能在 Windows 上相当于 iptables 的任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T06:02:01.470

DSNIFF包具有 mailsnarf 实用程序[。](http://monkey.org/~dugsong/dsniff/)它也可以抓取 POP3。那里还有各种其他美妙的嗅探工具。在使用这些工具之前，请确保您拥有合法权利（拦截他人流量的合法权利）。我相信文档中有更多关于合法性的信息。根据网页，也有 Windows 和 Mac OS X 端口。

分析程序的文本输出不会太难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T06:02:39.640

Ilkka：我在看 Wireshark，但据我所知，它并没有处理拦截方面——只有嗅探和日志记录。教授正在寻找的东西是防止垃圾邮件进入网络。

Adam: I'll definitely look into Winsock. I haven't checked that out yet. Only thing is the app's due in about 2 months, so if there are any OS apps that build off the WinSock SPI, I might want to tie into those. Know of any off the top of your head?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T06:05:00.807

Thanks, CDV. I'll look into that as well. Good call about the legality check. I've actually been trying to use gnu public license projects so far.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T06:11:05.720

I agree that Wireshark might be all you need. If you want to write your own filter application and can use Vista, then check out the [Windows Filtering Platform](http://www.microsoft.com/whdc/device/network/WFP.mspx).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T11:03:03.337

[tcpdump](http://www.tcpdump.org/) if you need command line or something more visual like [wireshark](http://www.wireshark.org/)

If you want to write something on your own use [libpcap](http://www.tcpdump.org/).

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T20:07:54.697

Use Snort, stripped down, if this is a long-term thing. It's built to watch for particular packets flying by, examining payload where needed, recording data and launching alerts.

It's intended for intrusion detection, but it makes a surprisingly good network monitor for particular things over long term use.

# c# - C# 的 PubSub 库

> ID：80347
> 
> 赞同：1
> 
> 时间：2008-09-17T05:44:30.667
> 
> 标签：c#, python, design-patterns

是否有 ac# 库提供与[Python PubSub](http://wiki.wxpython.org/PubSub)库类似的功能？我认为这是一种观察者模式，它允许我订阅给定主题的消息，而不是使用事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T05:47:09.803

根据您的需要，这些可能对您来说有点重，但是： [http :](http://www.nservicebus.com/) [//www.nservicebus.com/ http://blog.phatboyg.com/masstransit/](http://blog.phatboyg.com/masstransit/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T22:15:14.477

请注意，如果您有消息通知事件，则有许多依赖注入/控制反转的选项。将Spring.Net和[Castle](http://www.springframework.net/) [Windsor](http://www.castleproject.org/container/)视为两个流行的框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T07:42:21.120

再说一次，我有点矫枉过正，但是[OSE](http://ose.sf.net)库允许做一些事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-27T22:13:05.140

看起来 NuGet 上有几个产品： [https ://www.nuget.org/packages?q=pubsub](https://www.nuget.org/packages?q=pubsub)

# c++ - 在 C++ 中，你能有一个修改可变长度元组的函数吗？

> ID：80348
> 
> 赞同：2
> 
> 时间：2008-09-17T05:44:54.693
> 
> 标签：c++, tuples

在 C++0x 中，我想写一个这样的函数：

```
template <typename... Types>
void fun(typename std::tuple<Types...> my_tuple) {
    //Put things into the tuple
} 
```

我首先尝试使用 for 循环`int i`，然后执行以下操作：

```
get<i>(my_tuple); 
```

然后在结果中存储一些值。但是，`get`仅适用于`constexpr`.

如果我可以将变量`tuple`从`get`. 关于如何做到这一点的任何想法？或者有没有人有另一种修改方式`tuple`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T06:39:14.343

由于“我”在

```
get<i>(tup) 
```

需要是编译时常量，模板实例化用于通过值“迭代”（实际上是递归）。Boost 元组具有“长度”和“元素”元函数，在这里可能会有所帮助——我假设 C++0x 也有这些。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T07:05:15.263

[Boost.Fusion](http://www.boost.org/doc/libs/release/libs/fusion/doc/html/index.html)值得一看。它可以“迭代” `std::pair`, `boost::tuple`、其他一些容器和它自己的元组类型，尽管我认为它`std::tuple`还不支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:17:30.260

查看 TR1 的第 6.1.3.4 节，[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1836.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1836.pdf)

get 为 const 和非 const 限定元组定义并返回适当的引用类型。如果您将函数声明更改为以下内容：

```
template 
void fun(typename std::tuple& my_tuple) {
    //Put things into the tuple
}
```

然后，您的函数的参数是一个非常量元组，一旦您使用先前响应中提供的信息编写了迭代，get 将允许您进行必要的分配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:20:49.863

AFAICT，C++元组基本需要递归处理；*除了*使用类型系统唯一的可变参数模板处理之外，似乎没有任何真正的打包/解包元组的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-23T03:52:41.177

在这里查看我的答案，以获取将元组参数展开到函数调用的模板递归示例。

[如何将元组扩展为可变参数模板函数的参数？](https://stackoverflow.com/questions/687490/c0x-how-do-i-expand-a-tuple-into-variadic-template-function-arguments)

# php - 在 OS X 上进行 PHP 调试 - 没希望了？

> ID：80351
> 
> 赞同：27
> 
> 时间：2008-09-17T05:45:22.193
> 
> 标签：php, debugging, macos

我试过了：

1.  Xdebug 和 Eclipse。Eclipse 启动 Web 浏览器，但浏览器尝试访问 Eclipse 的 .app 包中不存在的文件。
2.  Xdebug 和 NetBeans。它做得更好一点；浏览器在 /tmp 中打开一个页面，上面写着“正在启动。请稍候……”但除此之外什么都没有发生。
3.  Xdebug 和 debugclient，Xdebug 自带的 CLI 工具。MacPorts（我用来安装 PHP 和 Xdebug）似乎没有自己安装它，当我尝试手动编译它时，我被告知“你有奇怪的 libedit”。通过 MacPorts 安装 libedit 并不能解决这个问题。
4.  Zend 的调试器（确切的名称现在我不知道）和 Eclipse。我不记得问题是什么，因为这是前一段时间的问题，但它没有用。

关于 Xdebug，至少，我相当有信心我已经正确安装了它。它在 PHP 文件和`php -i`CLI 中都显示为 phpinfo()。

如果有人设法在 Mac 上以某种方式进行 PHP 调试，如果您能与我分享如何做，我将不胜感激。乱扔垃圾的代码`var_dump($foo);die();`很快就会变老。*如果不*使用像 Eclipse 这样的过时软件编辑器或 Zend 想卖给我的昂贵的专有东西，就可以完成加分。

我的服务器正在通过 FastCGI 连接到 PHP，如果这会产生差异。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-17T16:11:48.867

您可能想查看[MacGDBp](http://www.bluestatic.org/software/macgdbp/)。它是新的、免费的，而且 UI 看起来很棒。它也利用了 Xdebug PHP 扩展。您可以在[帮助](http://www.bluestatic.org/software/macgdbp/help.php)部分找到说明，其中包括 Xdebug 配置，这里还有来自 Particletree 的人对应用程序的一个很好的概述：[使用 MacGDBp 使 Echo 静音](http://particletree.com/notebook/silence-the-echo-with-macgdbp/)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-08T23:20:16.900

我是这样做的：

1 - 将最新版本的 xdebug.so 从[http://aspn.activestate.com/ASPN/Downloads/Komodo/RemoteDebugging](http://aspn.activestate.com/ASPN/Downloads/Komodo/RemoteDebugging)复制到 /usr/libexec。

2 - 将以下内容添加到全局 php.ini：

```
zend_extension="/usr/libexec/xdebug.so"
xdebug.remote_enable=1
xdebug.remote_host=localhost
xdebug.remote_port=9000
xdebug.remote_autostart=1 
```

3 - 重新启动 Apache 并运行[MacGDBp](http://www.bluestatic.org/software/macgdbp/help.php)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-16T15:57:41.853

只是想更新这个线程，让你知道这里有一个新的应用程序[http://codebugapp.com/](http://codebugapp.com/)它是商业的，但它是 OSX 的 Xdebug 客户端

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-22T01:01:43.603

我使用 Komodo 5 --- 调试工作非常出色，不仅可以使用 PHP，还可以使用 Ruby 和 Python。我主要使用它来调试在远程服务器上运行的 PHP 脚本，但您也可以在本地执行操作。它不是免费的，但假设你自己的时间是值得的，你会在几个小时内拿回你的钱！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-11T11:13:26.817

### 有一种方法可以使用

*   [PhpStorm](https://www.jetbrains.com/phpstorm/)
*   Homebrew
    ruby​​ -e "$(curl -fsSL [https://raw.githubusercontent.com/Homebrew/install/master/install](https://raw.githubusercontent.com/Homebrew/install/master/install) )"

*   PHP + Xdebug

1）安装php并调试

```
brew install php70   
brew install php70-xdebug 
```

*   在 PhpStorm - 检查首选项 => 语言和框架 => PHP
    Php 语言级别：7
    解释器：PHP 7.0.8 + XDebug（或从 [...] 中选择）

*   检查调试配置：首选项 => 语言和框架 => PHP => 调试 => Xdebug 部分
    应选中所有复选框并将调试端口设置为：9001

2）在您的应用程序目录中运行服务器：

```
php -S localhost:8080 
```

3) 将 localhost:8080 添加到 PhpStorm Preferences => Language and Frameworks => PHP => Servers:
Name: Localhost:8080
Host: localhost
Port: 8080
Debugger: Xdebug

4) 更新 php.ini:
Php => Interpreter => […] => 配置文件 - 在编辑器中打开
添加此部分：（通过 cli 检查 zend_extention 路径）

```
[Xdebug]
zend_extension=/usr/lib/php/extensions/no-debug-non-zts-20121212/xdebug.so
xdebug.remote_enable=1
xdebug.remote_host=localhost
xdebug.remote_port=9001 (same as in Debug preferences) 
```

5）添加调试配置：运行=>编辑配置=>添加-Php Web应用程序

*   选择本地主机：8080 服务器

6) 点击 Start Listening for Php Debug Connections
7) 设置断点
7) 点击 Debug (Green bug)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T15:30:35.550

我想我没有得到奖励积分，但是 Zend Studio 在我的 Mac 上为我工作，连接到在 VMware 中运行的 Apache。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T07:12:00.523

我一直使用 Eclipse 和 ZendDebugger 调试 PHP CLI 脚本和 web probject（通过 apache 等）。

我在以下链接中回答了类似的问题： [单击此处](https://stackoverflow.com/questions/127761/php-debugging-with-aptana-studio-and-xdebug-or-zend-debugger-on-os-x#131722)

希望这就是你要找的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-05T09:08:18.997

如果您使用的是 MAMP，请注意它有 2 个 php.ini 文件需要更新。我花了几个小时才弄明白这个。这两个文件位于 MAMP 4 的以下文件夹中，

```
/Applications/MAMP/bin/php/php5.6.25/conf/php.ini
/Applications/MAMP/conf/php5.6.25/php.ini 
```

如果您使用的是 php7，那么您需要更新这些文件。滚动到文件底部并确保您有以下条目，

```
[xdebug]
zend_extension="/Applications/MAMP/bin/php/php5.6.25/lib/php/extensions/no-debug-non-zts-20131226/xdebug.so"
xdebug.default_enable=1
xdebug.remote_enable=1
xdebug.remote_host=localhost
xdebug.remote_port=9000
xdebug.remote_autostart=1 
```

然后确保重新启动服务器，否则将不会加载新设置。要确保 Xdebug 正常工作，请打开 MAMP 开始页面，然后单击 phpinfo 选项卡。在列表中搜索 xdebug，您应该会看到[Xdebug 部分](http://www.codeforest.net/wp-content/uploads/2013/04/phpinfo.png)显示扩展已加载并启用，否则上述配置有问题。

接下来，您可以启动 MacGDBp，它将连接到端口 9000 并允许您调试文件。

注意：如果您在 Wordpress 上开发，请确保跳过“AJAX”调试会话。这些是常规的，因为仪表板将 ping 服务器以进行更改。如果您在 MacGDBp 设置中启用“第一行中断”，您将看到 ajax 会话在`define ('DOING_AJAX')....`您可以跳过的行上中断。一旦你触发了你的事件来调试你的代码。

# ruby - 如何匹配所有出现的正则表达式

> ID：80357
> 
> 赞同：628
> 
> 时间：2008-09-17T05:46:26.047
> 
> 标签：ruby, regex

有没有一种快速的方法可以在 Ruby 中找到正则表达式的每个匹配项？我查看了 Ruby STL 中的 Regex 对象并在 Google 上搜索无济于事。

* * *

## 回答 #1

> 赞同：868
> 
> 时间：2008-09-17T05:53:10.990

使用[`scan`](http://ruby-doc.org/core-1.9.3/String.html#method-i-scan)应该可以解决问题：

```
string.scan(/regex/) 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2016-03-12T22:42:34.150

要查找所有匹配的字符串，请使用 String 的[`scan`](http://ruby-doc.org/core-2.2.0/String.html#method-i-scan)方法。

```
str = "A 54mpl3 string w1th 7 numb3rs scatter36 ar0und"
str.scan(/\d+/)
#=> ["54", "3", "1", "7", "3", "36", "0"] 
```

如果您想要 ，[`MatchData`](http://ruby-doc.org/core-1.9.3/MatchData.html)这是 Regexp`match`方法返回的对象的类型，请使用：

```
str.to_enum(:scan, /\d+/).map { Regexp.last_match }
#=> [#<MatchData "54">, #<MatchData "3">, #<MatchData "1">, #<MatchData "7">, #<MatchData "3">, #<MatchData "36">, #<MatchData "0">] 
```

使用的好处`MatchData`是您可以使用以下方法`offset`：

```
match_datas = str.to_enum(:scan, /\d+/).map { Regexp.last_match }
match_datas[0].offset(0)
#=> [2, 4]
match_datas[1].offset(0)
#=> [7, 8] 
```

如果您想了解更多信息，请查看以下问题：

*   "[如何获取字符串中所有出现的 Ruby 正则表达式的匹配数据？](https://stackoverflow.com/questions/6804557/how-do-i-get-the-match-data-for-all-occurrences-of-a-ruby-regular-expression-in?lq=1) "
*   “ [Ruby 正则表达式匹配枚举器，支持命名捕获](https://stackoverflow.com/questions/19596382/ruby-regular-expression-matching-enumerator-with-named-capture-support?lq=1)”
*   “[如何在 ruby​​ 中找出每场比赛的起点](https://stackoverflow.com/questions/17185943/how-to-find-out-the-starting-point-for-each-match-in-ruby?lq=1)”

阅读 Ruby 中的特殊变量`$&`, `$'`, `$1`,`$2`也会很有帮助。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-04-20T17:37:16.290

如果您有一个带有组的正则表达式：

```
str="A 54mpl3 string w1th 7 numbers scatter3r ar0und"
re=/(\d+)[m-t]/ 
```

您可以使用 String 的`scan`方法来查找匹配的组：

```
str.scan re
#> [["54"], ["1"], ["3"]] 
```

要查找匹配模式：

```
str.to_enum(:scan,re).map {$&}
#> ["54m", "1t", "3r"] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-03-08T10:24:48.770

您可以使用`string.scan(your_regex).flatten`. 如果您的正则表达式包含组，它将以单个普通数组返回。

```
string = "A 54mpl3 string w1th 7 numbers scatter3r ar0und"
your_regex = /(\d+)[m-t]/
string.scan(your_regex).flatten
=> ["54", "1", "3"] 
```

正则表达式也可以是一个命名组。

```
string = 'group_photo.jpg'
regex = /\A(?<name>.*)\.(?<ext>.*)\z/
string.scan(regex).flatten 
```

您也可以使用`gsub`，如果您想要 MatchData，这只是另一种方式。

```
str.gsub(/\d/).map{ Regexp.last_match } 
```

# asp.net - 你如何让 asp:Menu 遵循 Web.sitemap 中提供的 url？

> ID：80369
> 
> 赞同：8
> 
> 时间：2008-09-17T05:48:44.603
> 
> 标签：asp.net, sitemap

我有一个简单`asp:menu-item`的使用`Web.sitemap`来获取菜单项。该页面将回发，但无法获取与单击项目关联的页面。我会提到导航条代码在母版页文件中。

```
<div>
  <asp:SiteMapDataSource ID="SiteMapDataSource1"  ShowStartingNode="false" runat="server" />
  <asp:Menu ID="Menu1" Orientation="horizontal"  runat="server" BackColor="#a0a080" DataSourceID="SiteMapDataSource1"
      DynamicHorizontalOffset="2" Font-Names="Verdana" Font-Size="0.8em" ForeColor="#a00000"
      StaticSubMenuIndent="10px" Style="z-index: 2; left: 390px; position: absolute;
      top: 281px" Height="20px" Width="311px">
      <StaticSelectedStyle BackColor="#a0a080" />
      <StaticMenuItemStyle HorizontalPadding="5px" VerticalPadding="2px" />
      <DynamicHoverStyle BackColor="#a0a080" ForeColor="White" />
      <DynamicMenuStyle BackColor="#a0a080" />
      <DynamicSelectedStyle BackColor="#a0a080" />
      <DynamicMenuItemStyle HorizontalPadding="5px" VerticalPadding="2px" />
      <DataBindings>
          <asp:MenuItemBinding DataMember="SiteMapNode" EnabledField="Title" TextField="Title" />
      </DataBindings>
      <StaticHoverStyle BackColor="#666666" ForeColor="White" />
  </asp:Menu>
</div>    

<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0" >  
  <siteMapNode url="" title=""  description="">  
    <siteMapNode title="Home"  description="Zombie (be)Warehouse" url="index.aspx" />  
    <siteMapNode title="Armor" description="Anti-Zombie Armor" url="Armor.aspx" />  
    <siteMapNode title="Weapons" description="Anti-Zombie Weapons" url="Weapons.aspx" />  
    <siteMapNode title="Manuals" description="Survival Manuals" url="Manuals.aspx" />  
    <siteMapNode title="Sustenance" description="Prepared food for survival" url="Sustenance.aspx" />  
    <siteMapNode title="Contacts"  description="Contact Us"  url="Contacts.aspx" />  
    <siteMapNode title="About" description="About Zombie (be)Warehouse" url="About.aspx" />  
  </siteMapNode>  
</siteMap> 
```

**更新：**`DataBindings`在菜单项 的部分中发现了问题。注意这一行：

```
<asp:MenuItemBinding DataMember="SiteMapNode" EnabledField="Title" Text="Title" /> 
```

从的文本字段中`Text="Title"`设置菜单的显示文本。`Web.sitemap`我注意到该`MenuItemBinding`项目有一个名为`NavigateUrlField`.

因此，要解决此问题，您只需更改/添加到`asp:MenuItemBinding`

```
<asp:MenuItemBinding DataMember="SiteMapNode" NavigateUrlField="url" EnabledField="Title" TextField="Title" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-05-26T13:06:21.610

您需要将`NavigateUrlField`字段添加到`MenuItemBinding`这样 的`<asp:MenuItemBinding DataMember="SiteMapNode" EnabledField="Title" TextField="Title" NavigateUrlField="url"/>`

# gtk - 在 GTK Notebook 中将窗口重新设置为选项卡

> ID：80370
> 
> 赞同：2
> 
> 时间：2008-09-17T05:48:54.107
> 
> 标签：gtk, gtk#

我将 Mono 与 GTK# 一起使用，并尝试将现有窗口显示为 GTK.Notebook 中的新选项卡。我目前正在将小部件重新设置为笔记本，如下所示：

```
我的窗口 myWindow = new MyWindow();
myWindow.Children[0].Reparent(myNotebook)

```

我应该这样做，还是有更好的方法来重新使用现有窗口，以便您可以在选项卡上显示它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T05:50:30.717

`GtkPlug`您的方式是最好的方式，如果不使用可怕的黑客（我猜如果您使用.NET，您会对此不感兴趣），就无法将窗口嵌入选项卡中。查看代码以`gnome-terminal`获取有关如何执行此操作的示例。

# wpf - WPF 数据触发器和故事板

> ID：80388
> 
> 赞同：27
> 
> 时间：2008-09-17T05:53:11.177
> 
> 标签：wpf, animation, expression-blend

我试图在 ViewModel/Presentation Model 忙碌时触发进度动画。我有一个 IsBusy 属性，并将 ViewModel 设置为 UserControl 的 DataContext。当 IsBusy 属性为真时，触发“progressAnimation”故事板的最佳方式是什么？Blend 只允许 med 在 UserControl 级别添加事件触发器，而我只能在我的数据模板中创建属性触发器。

“progressAnimation”被定义为用户控件中的资源。

我尝试将 DataTriggers 添加为 UserControl 上的样式，但是当我尝试启动 StoryBoard 时，出现以下错误：

```
'System.Windows.Style' value cannot be assigned to property 'Style' 
of object'Colorful.Control.SearchPanel'. A Storyboard tree in a Style 
cannot specify a TargetName. Remove TargetName 'progressWheel'. 
```

ProgressWheel 是我要制作动画的对象的名称，因此删除目标名称显然不是我想要的。

我希望使用数据绑定技术在 XAML 中解决这个问题，而不必通过代码公开事件和启动/停止动画。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-11-14T22:24:52.220

您可以通过在 progressWheel 本身上声明动画来实现您想要的：XAML：

```
<UserControl x:Class="TriggerSpike.UserControl1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Height="300" Width="300">
<UserControl.Resources>
    <DoubleAnimation x:Key="SearchAnimation" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:4"/>
    <DoubleAnimation x:Key="StopSearchAnimation" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:4"/>
</UserControl.Resources>
<StackPanel>
    <TextBlock Name="progressWheel" TextAlignment="Center" Opacity="0">
        <TextBlock.Style>
            <Style>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsBusy}" Value="True">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <StaticResource ResourceKey="SearchAnimation"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                   <StaticResource ResourceKey="StopSearchAnimation"/> 
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.ExitActions>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </TextBlock.Style>
        Searching
    </TextBlock>
    <Label Content="Here your search query"/>
    <TextBox Text="{Binding SearchClause}"/>
    <Button Click="Button_Click">Search!</Button>
    <TextBlock Text="{Binding Result}"/>
</StackPanel> 
```

后面的代码：

```
 using System.Windows;
using System.Windows.Controls;

namespace TriggerSpike
{
    public partial class UserControl1 : UserControl
    {
        private MyViewModel myModel;

        public UserControl1()
        {
            myModel=new MyViewModel();
            DataContext = myModel;
            InitializeComponent();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            myModel.Search(myModel.SearchClause);
        }
    }
} 
```

视图模型：

```
 using System.ComponentModel;
using System.Threading;
using System.Windows;

namespace TriggerSpike
{
    class MyViewModel:DependencyObject
    {

        public string SearchClause{ get;set;}

        public bool IsBusy
        {
            get { return (bool)GetValue(IsBusyProperty); }
            set { SetValue(IsBusyProperty, value); }
        }

        public static readonly DependencyProperty IsBusyProperty =
            DependencyProperty.Register("IsBusy", typeof(bool), typeof(MyViewModel), new UIPropertyMetadata(false));

        public string Result
        {
            get { return (string)GetValue(ResultProperty); }
            set { SetValue(ResultProperty, value); }
        }

        public static readonly DependencyProperty ResultProperty =
            DependencyProperty.Register("Result", typeof(string), typeof(MyViewModel), new UIPropertyMetadata(string.Empty));

        public void Search(string search_clause)
        {
            Result = string.Empty;
            SearchClause = search_clause;
            var worker = new BackgroundWorker();
            worker.DoWork += worker_DoWork;
            worker.RunWorkerCompleted += worker_RunWorkerCompleted;
            IsBusy = true;
            worker.RunWorkerAsync();
        }

        void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            IsBusy=false;
            Result = "Sorry, no results found for: " + SearchClause;
        }

        void worker_DoWork(object sender, DoWorkEventArgs e)
        {
            Thread.Sleep(5000);
        }
    }
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-07-16T07:34:38.140

尽管建议将动画直接附加到要动画的元素的答案在简单的情况下解决了这个问题，但是当您有一个需要针对多个元素的复杂动画时，这实际上并不可行。（当然，您可以将动画附加到每个元素，但管理起来非常糟糕。）

所以有一种替代方法可以解决这个问题，让您可以使用 a`DataTrigger`来运行以命名元素为目标的动画。

在 WPF 中可以在三个位置附加触发器：元素、样式和模板。但是，前两个选项在这里不起作用。第一个被排除，因为 WPF 不支持`DataTrigger`直接在元素上使用 a 。（据我所知，这并没有什么特别好的理由。据我记得，多年前当我向 WPF 团队的成员询问这个问题时，他们说他们很想支持它，但没有有时间让它工作。）样式已经过时了，因为正如您报告的错误消息所说，您不能在与样式关联的动画中定位命名元素。

这样就剩下模板了。您可以为此使用控制或数据模板。

```
<ContentControl>
    <ContentControl.Template>
        <ControlTemplate TargetType="ContentControl">
            <ControlTemplate.Resources>
                <Storyboard x:Key="myAnimation">

                    <!-- Your animation goes here... -->

                </Storyboard>
            </ControlTemplate.Resources>
            <ControlTemplate.Triggers>
                <DataTrigger
                    Binding="{Binding MyProperty}"
                    Value="DesiredValue">
                    <DataTrigger.EnterActions>
                        <BeginStoryboard
                            x:Name="beginAnimation"
                            Storyboard="{StaticResource myAnimation}" />
                    </DataTrigger.EnterActions>
                    <DataTrigger.ExitActions>
                        <StopStoryboard
                            BeginStoryboardName="beginAnimation" />
                    </DataTrigger.ExitActions>
                </DataTrigger>
            </ControlTemplate.Triggers>

            <!-- Content to be animated goes here -->

        </ControlTemplate>
    </ContentControl.Template>
<ContentControl> 
```

通过这种结构，WPF 很乐意让动画引用模板内的命名元素。（我在这里把动画和模板内容都留空了——显然你会用你的实际动画和内容来填充它。）

这适用于模板而不是样式的原因是，当您应用模板时，它定义的命名元素将始终存在，因此在该模板范围内定义的动画引用这些元素是安全的。样式通常不是这种情况，因为样式可以应用于多个不同的元素，每个元素可能具有完全不同的视觉树。（即使在可以确定所需元素会存在的情况下，它也会阻止您执行此操作，这有点令人沮丧，但也许有些东西使得动画很难绑定到右侧的命名元素时间。我知道 WPF 中有很多优化可以使样式的元素能够被有效地重用，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T06:09:36.130

我建议使用 RoutedEvent 而不是您的 IsBusy 属性。只需触发 OnBusyStarted 和 OnBusyStopped 事件并在适当的元素上使用事件触发器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T07:27:37.207

您可以订阅 DataObject 类的 PropertyChanged 事件并从 Usercontrol 级别触发 RoutedEvent。

为了使 RoutedEvent 工作，我们需要从 DependancyObject 派生类

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T08:37:37.880

您可以使用 Trigger.EnterAction 在属性更改时启动动画。

```
<Trigger Property="IsBusy" Value="true">
    <Trigger.EnterActions>
        <BeginStoryboard x:Name="BeginBusy" Storyboard="{StaticResource MyStoryboard}" />
    </Trigger.EnterActions>
    <Trigger.ExitActions>
        <StopStoryboard BeginStoryboardName="BeginBusy" />
    </Trigger.ExitActions>
</Trigger> 
```

# real-time - 什么是“实时”

> ID：80394
> 
> 赞同：10
> 
> 时间：2008-09-17T05:55:08.770
> 
> 标签：real-time, glossary, near-real-time

我无法决定是否将我的应用程序分类为“实时”或“接近实时”，或者甚至是其他的。

该软件在从源生成数据时立即接收数据，然后根据某些规则，在满足某些条件时发出警报。它采用每 30 秒检查最后 30 秒数据的方法，以查看是否满足规则的条件。

那是实时的吗？实时与近实时的定义阈值是什么？

**编辑**

[我认为这是在 web 上为业务定义实时](https://stackoverflow.com/questions/51135/define-realtime-on-the-web-for-business)的副本。

请确定上述线程是否不足以回答您的问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-17T06:05:24.893

实时 = 保证解决的最长时间。根据应用程序的要求，它可能是皮秒或分钟

这是 StackOverflow 最大的问题：不合格的人用“听起来正确”的答案回答了很多问题并获得了投票，关心答案是否真的正确的人不会以足够快的速度胡说八道以赢得代表来修复错误的答案。由于预期的下意识反应而匿名发布。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T08:58:29.483

Real-time is getting a required response to an event completed within the time period specified or *your system fails*.

People are used to thinking this must mean 'small number of milliseconds/microseconds' but that isn't necessarily true - it depends on your system.

If your system will *fail* if it doesn't complete it's required response within 30 seconds then it's 'real-time'.

For some systems, a *fail* could be catastrophic, e.g. causing multiple fatalities - this is described as *safety critical*, e.g. shutting down a nuclear power plant.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T06:39:20.333

“实时”一词涵盖了相当大的范围。

模糊的定义是“在有限的响应时间内运行的软件”。

在边界较硬的情况下，例如在汽车的喷射控制系统中，该软件被称为“硬实时”。

在边界较软的情况下，例如在音乐播放系统中，可以容忍高达 50 毫秒的变化，该系统被称为“软实时”。

所以是的，对于实时的某些定义，您的系统是实时的。

但是如果你在其他任何实际在实时系统上工作的人周围称它为实时，你可能会被嘲笑，因为 30 秒是相当大的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T06:00:53.140

好吧，这可能是一个营销问题，而不是技术问题。

就嵌入式硬件而言，实时涉及用于处理传入信息（中断等）的已知固定最大时间。

您当然可以将 30 秒的延迟称为实时延迟，尤其是在所述信息的传递时间长于该时间的情况下。

例如，如果您的“警报”是一封可能在邮件服务器中花费 10 分钟的电子邮件，或者是用户仅每半小时检查一次的监视器上的红十字，则 30 秒对于实时来说已经足够了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T06:05:08.777

我认为定义实时的一个方面是过程是*确定性*的——也就是说，应用程序的响应时间完全可以根据输入来预测。

因此，使用非常广泛的笔触进行绘画，任何位于 Windows 之上的应用程序充其量只能是“近乎实时的”。如果您的应用程序运行在某种沙箱平台（Java、.NET）上，您对平台功能（例如垃圾收集）没有绝对控制权，那就更是如此。

我个人的规则是“实时”不属于台式电脑。这就是 PLC 的领域（是的，它们可能正在运行诸如 QNX、VxWorx 甚至 RTLinux 之类的操作系统）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T22:16:02.217

我的控制朋友对“硬”实时的定义 - 迟到的信息是错误的信息。如果它需要每 1 秒到达一次，并且在 1.1 秒内到达那里，那么它对计算毫无用处。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T07:30:13.737

定义“实时”的另一种方法是评估许多[RTOS](http://www.google.com/search?q=RTOS)（实时操作系统）的功能。例如，QNX 的定义在[这里](http://www.qnx.com/products/neutrino_rtos/realtime.html)。请注意，它们符合[POSIX](http://en.wikipedia.org/wiki/POSIX) PSE52 实时控制器 1003.13-2003 系统产品标准。大多数嵌入式操作系统将提供类似的功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-05T16:31:34.837

我在我的网站 real-time.org 上提供了一个冗长的论述。主页有一个简报的临时链接。简报讨论了人们如何以及为什么不理解“实时”（以及“硬”、“软”和“可预测”等）的含义。它提供了一些精确和一般的定义。我听到有人不同意我对这个话题的解释，但他们都没有提出像我这样精确和笼统的东西。正如拉里金所说，“拉起椅子，让我们谈谈”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T06:05:27.030

我相信答案是实时系统是主观的，因为“实时”只是需求强加的及时性限制。尽管显然需要 2 小时才能响应请求的事情不是实时的，但 30 秒的延迟可能足以满足实时要求。

我在我认为的实时系统上工作，当系统中发生事件时，它会立即传播到系统上的设备，因此了解设备更新的延迟是网络延迟和所花费时间的产物更新其内存数据。

我个人不会将每 30 秒更新一次的民意调查归类为实时。作为上述系统的一部分，我们有一个 Web 应用程序，它每 30 秒刷新一次，因此向用户呈现的数据最多为 30 秒。将此与在事件发生后立即更新的获胜形式进行对比。

同样，“实时”受您对及时响应的定义的限制。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-17T05:58:44.190

我想说实时的定义取决于上下文。与音乐示例一样，实时时间需要为毫秒，但对于您的示例，实时时间可能在 30 秒左右。都是相对的。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-17T06:00:44.233

我认为您需要查看需要实时响应的特定解决方案或解决方案的一部分。实时响应是接收器（应用程序或基本上是最终用户）认为是实时的响应。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-17T06:01:20.813

实时处理微秒......主要围绕机器人技术。想想'移动手臂 30 微秒; 焊接 1000 微秒；'，就像在汽车装配中一样。

您的 30 秒是基于线程睡眠还是非实时操作系统中的计时器？如果是这样，那么你有一个潜在的变化。如果您超出该差异（30.01 秒），您会认为这是失败吗？如果不是，那么它不是实时的。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-09-17T05:58:42.757

我同意约翰的观点，在您的场景中，您正在查看至少 30 秒的延迟，我会说这几乎是实时的。

# regex - Perl 正则表达式匹配和删除

> ID：80415
> 
> 赞同：5
> 
> 时间：2008-09-17T06:00:50.863
> 
> 标签：regex, perl

我有一个以`//#...`换行符开头的字符串。我已经弄清楚了 which is this 的正则表达式`..#([^\n]*)`。

我的问题是如果以下条件匹配，您如何从文件中删除此行

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-17T07:56:04.033

您的正则表达式在几个方面选择不当：

1.  不是专门匹配两个斜杠，而是`..`用来匹配两个可以是任何字符的字符，大概是因为当您还使用斜杠作为分隔符时，您不知道如何匹配斜杠。（实际上，点*几乎*可以匹配任何东西，正如我们将在 #3 中看到的那样。）

    在斜杠分隔的正则表达式文字中`//`，您可以简单地通过用反斜杠保护斜杠来匹配斜杠，例如。`/\/\//`. 然而，更好的变体是使用较长形式的正则表达式文字，`m//`您可以在其中选择分隔符，例如。`m!!`. 由于您使用斜线以外的其他内容进行分隔，因此您可以在不转义的情况下编写它们：`m!//!`. 请参阅[perldoc perlop](http://p3rl.org/op#Quote-and-Quote-like-Operators)。

2.  它没有锚定到字符串的开头，因此它将匹配任何地方。使用`^`前面的字符串开头断言。

3.  当有一种更简单的写法时，你写`[^\n]`的是匹配“除换行符以外的任何字符”，这就是`.`通配符。它正是这样做的——匹配除换行符以外的任何字符。

4.  您正在使用括号对匹配的一部分进行分组，但该组既没有量化（您没有指定它可以匹配任何其他次数而不是一次），也没有兴趣保留它。所以括号是多余的。

总而言之，这就是它`m!^//#.*!`。但是在正则表达式的末尾放置一个未捕获的`.*`（或任何带有`*`量词的东西）是没有意义的，因为它永远不会改变一个字符串是否匹配：`*`很高兴根本不匹配任何东西。

这样你就可以了`m!^//#!`。

至于从文件中删除该行，正如其他人所解释的那样，逐行阅读并将所有要保留的行打印回另一个文件。如果您不在一个较大的程序中执行此操作，请使用 perl 的命令行开关轻松执行此操作：

```
perl -ni.bak -e'print unless m!^//#!' somefile.txt 
```

在这里，`-n`开关使 perl 围绕您提供的代码放置一个循环，该循环将依次读取您在命令行上传递的所有文件。开关（用于“`-i`就地”）表示收集脚本的输出并用它覆盖每个文件的原始内容。该选项的`.bak`参数`-i`告诉 perl 将原始文件的备份保留在以原始文件名命名的文件中，并`.bak`附加。对于所有这些位，请参阅[perldoc perlrun](http://p3rl.org/run)。

如果您想在较大程序的上下文中执行此操作，最简单的安全方法是打开文件两次，一次用于读取，另外一次使用[IO::AtomicFile](http://p3rl.org/IO::AtomicFile)进行写入。IO::AtomicFile 只有在成功关闭时才会替换原始文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T07:40:15.210

要过滤掉文件中与某个正则表达式匹配的所有行：

```
perl -n -i.orig -e 'print unless /^#/' file1 file2 file3 
```

-i 开关后的“.orig”创建具有给定扩展名 (.orig) 的文件的备份。如果您不需要备份，则可以跳过它（只需使用 -i）。

-n 开关使 perl 为文件中的每一行执行您的指令（-e ' ... '）。该行存储在 $_ 中（这也是许多指令的默认参数，在这种情况下：打印和正则表达式匹配）。

最后，-e 开关的参数说“打印该行，除非它与行首的 # 字符匹配。

PS。还有一个 -p 开关，其行为类似于 -n，除了总是打印行（有利于搜索和替换）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T09:15:07.200

正如其他人指出的那样，如果最终目标只是删除以 开头的行`//#`，出于性能原因，您最好使用`grep`or `sed`：

```
grep -v '^\/\/#' filename.txt > filename.stripped.txt

sed '/^\/\/#/d' filename.txt > filename.stripped.txt 
```

或者

```
sed -i '/^\/\/#/d' filename.txt 
```

如果您更喜欢就地编辑。

请注意，在 perl 中，您的正则表达式将是

```
m{^//#} 
```

它匹配两个斜杠，后跟字符串开头的 #。

请注意，您可以通过使用匹配运算符`m{pattern}`而不是更熟悉的`/pattern/`. 尽早训练自己使用这种语法，因为它是避免过度转义的简单方法。您可以像or`m{^//#}`一样有效地编写，具体取决于您要匹配的内容。力求清晰 - 正则表达式很难在没有可避免的反斜杠的多刺森林破坏可读性的情况下破译。严重的是，它看起来像一条带有缺口的牙齿和填充物的鳄鱼，或者是一幅阿尔卑斯山的小型 ASCII 画。`m%^//#%``m#^//\##``m/^\/\/#/`

您的脚本中可能出现的一个问题是，如果整个文件被拼凑成一个字符串、换行符等等。为了防止这种情况，请在正则表达式上使用 /m（多行）修饰符：

```
m{^//#}m 
```

这允许 ^ 在字符串的开头*和*换行符之后匹配。您会认为有一种方法可以`m{^//#.*$}`使用 regex 修饰符`/g`,来去除或匹配匹配的行`/m`，并且`/s`在您将文件 slurp 成字符串但您不想复制它的情况下（乞求问题为什么它首先被啜饮成一个字符串。）这*应该*是可能的，但已经晚了，我没有看到答案。但是，一种“简单”的方法是：

```
my $cooked = join qq{\n}, (grep { ! m{^//} } (split m{\n}, $raw)); 
```

即使这会创建一个副本而不是对原始字符串进行就地编辑`$raw`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T07:26:46.773

你真的不需要 perl。

```
sed '/^\/\/#/d' inputfile > outputfile 
```

我<3 sed。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T06:06:44.140

逐行读取文件，仅将这些行写入与正则表达式不匹配的新文件。您不能只删除一行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T06:07:04.997

它是从一行的开头开始还是可以出现在任何地方？如果前 s/old/new 是您想​​要的。如果是后者，我将不得不弄清楚这一点。我怀疑可以以某种方式使用反向引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T06:18:54.203

我认为您的正则表达式不正确。

首先，您需要以 ^ 开头，否则它将在行的任何位置匹配此模式。

其次，`..`应该是`\/\/`，否则它将匹配任何两个字符。

`^\/\/#[^\n]*`可能是你想要的。

然后按照 EricSchaefer 所说的去做，逐行读取文件，只写不匹配的行。

--
bmb

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T07:09:22.307

尝试以下操作：

```
perl -ne 'print unless m{^//#}' input.txt > output.txt 
```

如果您使用的是 Windows，则需要双引号而不是单引号。

你可以用 grep 做同样的事情

```
grep -v -e '^//#' input.txt > output.txt 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T07:11:07.997

遍历文件中的每一行，如果它与模式匹配则跳过该行：

```
我的 $fh = new FileHandle '文件名'
    或死“无法打开文件 - $！”；

而（我的 $line = $fh->getline）{
    接下来如果 $line =~ m{^//#};
    打印$行；
}
关闭 $fh;

```

这将打印文件中的所有行，以“//#”开头的行除外。

# ruby-on-rails - 以 DRY 方式覆盖 ActiveRecord 中的“查找”

> ID：80424
> 
> 赞同：5
> 
> 时间：2008-09-17T06:02:33.370
> 
> 标签：ruby-on-rails, ruby, activerecord, metaprogramming, overriding

我有一些模型需要自定义查找条件。例如，如果我有一个 Contact 模型，每次调用 Contact.find 时，我都想限制返回的联系人只属于正在使用的 Account。

我通过谷歌找到了这个（我已经定制了一点）：

```
def self.find(*args)
  with_scope(:find => { :conditions =>  "account_id = #{$account.id}" }) do
    super(*args)
  end
end 
```

这很好用，除了 account_id 不明确的少数情况，所以我将其调整为：

```
def self.find(*args)
  with_scope(:find => { :conditions =>  "#{self.to_s.downcase.pluralize}.account_id = #{$account.id}" }) do
    super(*args)
  end
end 
```

这也很好用，但是，我希望它是干燥的。现在我有几个不同的模型，我希望使用这种功能。做这个的最好方式是什么？

当您回答时，请包含代码以帮助我们理解元编程 Ruby-fu。

（我使用的是 Rails v2.1）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T06:05:55.047

您没有告诉我们您正在使用哪个版本的 rails [编辑 - 它在 rails 2.1 上，因此遵循建议是完全可操作的]，但我建议您使用以下表格而不是重载 find yourself ：

```
account.contacts.find(...) 
```

这将自动将 find 包装在包含 user 子句的范围内（因为您有 account_id 我假设您的帐户在某个附近）

我建议您检查以下有关范围的资源

*   [http://ryandaigle.com/articles/2008/3/24/what-s-new-in-edge-rails-has-finder-functionality](http://ryandaigle.com/articles/2008/3/24/what-s-new-in-edge-rails-has-finder-functionality) （这不再是边缘了:)）
*   [http://ryandaigle.com/articles/2008/8/20/named-scope-it-s-not-just-for-conditions-ya-know](http://ryandaigle.com/articles/2008/8/20/named-scope-it-s-not-just-for-conditions-ya-know)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T13:13:27.953

简的建议是合理的。假设您的模型如下所示：

```
class Contact < ActiveRecord::Base
  belongs_to :account
end

class Account < ActiveRecord::Base
  has_many :contacts
end 
```

您应该使用`contacts`当前帐户的关联来确保您只获取`Contact`范围为该帐户的记录，如下所示：

```
@account.contacts 
```

如果您想为您的联系人查询添加更多条件，您可以使用 find 指定它们：

```
@account.contacts.find(:conditions => { :activated => true }) 
```

如果您发现自己不断地查询激活的用户，您可以将其重构为一个命名范围：

```
class Contact < ActiveRecord::Base
  belongs_to :account
  named_scope :activated, :conditions => { :activated => true }
end 
```

然后你会像这样使用它：

```
@account.contacts.activated 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T06:50:11.383

为了对您的问题给出具体答案，我建议将上述方法移入一个模块中，以包含在相关模型中；所以你会有

```
class Contact
  include NarrowFind
  ...
end 
```

PS。注意 account_id 的 sql 转义，您可能应该使用该`:conditions=>[".... =?", $account_id]`语法。

# string - 如何遍历字符串并检查每个字符的字节值？

> ID：80427
> 
> 赞同：5
> 
> 时间：2008-09-17T06:03:06.303
> 
> 标签：string, excel, for-loop, vba

我有的代码：

```
cell_val = CStr(Nz(fld.value, ""))
Dim iter As Long
For iter = 0 To Len(cell_val) - 1 Step 1
    If Asc(Mid(cell_val, iter, 1)) > 127 Then
        addlog "Export contains ascii character > 127"
    End If
Next iter 
```

此代码不起作用。有人知道怎么做吗？我对VB或VBA一无所知。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T06:10:15.410

我相信您的问题是在 VBA 中，字符串索引从 1 开始，而不是从 0 开始。请尝试以下操作：

```
For iter = 1 To Len(cell_val) 
    If Asc(Mid(cell_val, iter, 1)) > 127 Then
        addlog "Export contains ascii character > 127"
    End If
Next 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T06:27:07.180

使用 VBA、VB6，您只需声明一个字节数组并为其分配一个字符串值，它将为您转换。然后你可以像普通数组一样迭代它。

例如

```
Dim b() as byte
Dim iter As Long
b = CStr(Nz(fld.value, ""))

For iter = 0 To UBound(b)
    if b(iter) > 127 then
        addlog "Export contains ascii character > 127"
    end if
next 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T06:17:45.517

您的示例应该被修改，因此它没有外部依赖项，它现在依赖于 Nz 和 addLog。

无论如何，这里的问题似乎是你从 0 循环到 len()-1。在 VBA 中，这将是 1 到 n。

```
 Dim cell_val As String
 cell_val = "øabcdæøå~!#%&/()"
 Dim iter As Long
 For iter = 1 To Len(cell_val)
    If Asc(Mid(cell_val, iter, 1)) > 127 Then
       'addlog "Export contains ascii character > 127"
       Debug.Print iter, "Export contains ascii character > 127"
    End If
 Next iter 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T06:10:47.063

你调试了吗？;) 你确定 cell_val 不为空吗？此外，您不需要 For 循环中的“步骤 1”，因为它是默认设置。另外，您希望用您的代码完成什么？它记录是否有任何 ascii 值高于 127？但就是这样 - 根据结果没有分支？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T06:11:09.060

试试 AscW()

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T06:13:19.787

VB/VBA 字符串是从 1 而非 0 开始的，因此您需要使用：

```
For iter = 1 To Len(cell_val) 
```

我也放弃了，`step 1`因为这是默认设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T06:27:06.260

> 你调试了吗？;) 你确定 cell_val 不为空吗？此外，您不需要 For 循环中的“步骤 1”，因为它是默认设置。另外，您希望用您的代码完成什么？它记录是否有任何 ascii 值高于 127？但就是这样 - 根据结果没有分支？

我没有调试它，我不知道如何使用 vba 或任何与之配套的工具。是的，我确定 cell_val 不为空。该代码具有代表性，我在编写分支本身之前确保分支条件有效。

> 我相信您的问题是，在 VBA 中，字符串索引从 1 开始，而不是从 0 开始。

啊，我一定会错过的与 vba 相关的确切类型，谢谢。

# workflow - Windows Workflow Foundation (WF) 的最佳资源是什么？

> ID：80429
> 
> 赞同：17
> 
> 时间：2008-09-17T06:03:38.580
> 
> 标签：workflow, workflow-foundation, .net-3.0

我正在寻找一些关于 WWF 的书籍、博客或文章。我读过下面的书；但是，我需要更深入地涵盖该主题的资源。我对本地服务、持久性、跟踪和从网站查看工作流特别感兴趣。有什么建议么？？

[Pro WF：.NET 3.0 中的 Windows 工作流](https://rads.stackoverflow.com/amzn/click/com/1590597788)

[基本 Windows 工作流基础](https://rads.stackoverflow.com/amzn/click/com/0321399838)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-17T08:03:48.510

恕我直言，最好的书是[Essential Windows Workflow Foundation](https://rads.stackoverflow.com/amzn/click/com/0321399838)和[Programming Windows Workflow Foundation: Practical WF Techniques and Examples using XAML and C#](https://rads.stackoverflow.com/amzn/click/com/1904811213)。

我读过的博客：

*   [基思·皮亚诺夫斯基的博客](http://www.keithpij.com/Home/tabid/36/BlogId/4/Default.aspx)
*   [柯克艾伦埃文斯的博客](http://blogs.msdn.com/kaevans/default.aspx)
*   [马特·温克勒](http://blogs.msdn.com/mwinkle/default.aspx)
*   [马特的沉思](http://www.pluralsight.com/community/blogs/matt/default.aspx)
*   [.NET 端点](http://blogs.msdn.com/endpoint/default.aspx)
*   [互联框架规则团队博客](http://blogs.msdn.com/rulesteam/default.aspx)
*   [问题解决者](http://msmvps.com/blogs/theproblemsolver/default.aspx)
*   [卡维塔克](http://blogs.msdn.com/kavitak/default.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T06:09:55.210

这是一个好的开始： http: [//msdn.microsoft.com/en-us/netframework/aa663328.aspx](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx) 这是一个很好的博客： http: [//msmvps.com/blogs/theproblemsolver/](http://msmvps.com/blogs/theproblemsolver/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T21:45:43.840

Jon Flanders 的博客也有很多有价值的信息： http: [//www.masteringbiztalk.com/blogs/jon/](http://www.masteringbiztalk.com/blogs/jon/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-30T11:05:25.170

你可以参考这几个博客......

[TFS(VS 2010)](http://www.ewaldhofman.nl/post/2010/04/20/Customize-Team-Build-2010-e28093-Part-1-Introduction.aspx)

[布兰登的博客](http://blogs.msdn.com/b/brandonhawbaker/)

[Tfs 扩展](https://tfsbuildextensions.codeplex.com/wikipage?title=How%20to%20integrate%20the%20WriteToFile%20build%20activity&referringTitle=Documentation)

[WF4 之旅](http://blogs.msdn.com/b/endpoint/archive/2009/05/29/a-tour-on-the-wf4-activity-palette.aspx)

这些是我在探索 Windows 工作流期间发现的一些非常好的博客和更新的博客。希望它会帮助你。

# computer-science - 什么是期货？

> ID：80447
> 
> 赞同：14
> 
> 时间：2008-09-17T06:07:58.163
> 
> 标签：computer-science, terminology, future

什么是期货？这与惰性评估有关。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T06:23:44.880

有一篇关于期货的[维基百科文章。](http://en.wikipedia.org/wiki/Future_%28programming%29)简而言之，这是一种使用未知值的方法。然后可以按需计算该值（惰性评估），并且可以选择与主计算同时进行。

C++ 示例如下。

* * *

假设您要计算两个数字的总和。您可以使用典型的 Eager 实现：

```
int add(int i, int j) { return i + j; }
// first calculate both Nth_prime results then pass them to add
int sum = add(Nth_prime(4), Nth_prime(2)); 
```

或者您可以使用 C++11 的期货方式`std::async`，它返回一个`std::future`. 在这种情况下，该`add`函数仅在尝试使用尚未计算的值时才会阻塞（也可以创建一个纯粹的惰性替代方案）。

```
int add(future<int> i, future<int> j) { return i.get() + j.get(); }
int sum = add(async(launch::async, [](){ return Nth_prime(4); }),
              async(launch::async, [](){ return Nth_prime(2); })); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T06:12:24.110

当您创建未来时，会启动一个新的后台线程，开始计算实际值。如果你请求future的值，它将阻塞直到线程完成计算。当您需要并行生成一些值并且不想手动跟踪所有值时，这非常有用。

有关Ruby 或[Scala、futures 和惰性求值](http://www.bluishcoder.co.nz/2006/07/scala-futures-and-lazy-evaluation.html)的信息，请参见[lazy.rb。](http://moonbase.rydia.net/software/lazy.rb/)

它们可能可以用任何带有线程的语言来实现，尽管在像 C 这样的低级语言中显然比在高级函数式语言中更困难。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T06:54:40.437

大家为了懒计算而提到期货。然而，另一个没有宣传的用途是使用 Futures for IO。特别是它们对于加载文件和等待网络数据很有用

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T06:11:23.707

Future 封装了延迟计算，通常用于将惰性求值硬塞到非惰性语言中。第一次评估未来时，运行评估它所需的代码，并将未来替换为结果。

由于 future 被替换，后续的评估不会再次执行代码，而只是简单地产生结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T07:14:21.780

[Wiki 文章](http://en.wikipedia.org/wiki/Future_(programming))很好地概述了期货。该概念通常用于并发系统中，用于在可能尚未计算或尚未计算的值上调度计算，此外，其计算可能已经或可能尚未在进行中。

来自文章：

> 未来与计算其值的特定线程相关联。这个计算可以在创建未来时急切地开始，或者在第一次需要它的值时懒惰地开始。

文章中没有提到， future 是[Monad](http://en.wikipedia.org/wiki/Monads_in_functional_programming)，因此可以将未来值的函数投影到 monad 中，以便在可用时将它们应用于未来值，从而产生另一个未来，这反过来又代表了该函数的结果.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-17T12:30:58.370

Futures 也用于某些设计模式，特别是实时模式，例如 ActiveObject 模式，它将方法调用与方法执行分开。未来被设置为等待完成的执行。当您需要从多线程环境迁移到与单线程环境进行通信时，我倾向于看到它。在某些情况下，某个硬件没有内核支持线程，在这种情况下使用期货。乍一看，你将如何沟通并不明显，令人惊讶的是，未来让它变得相当简单。我有一些 c# 代码。我会挖出来贴出来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-05T07:30:26.627

[这篇博](http://vigtig.it/blog/?p=73#more-73)文给出了一个**非常详尽**的解释，以及一个如何自己实现未来的例子。我真的推荐它:)

# c++ - 开发在桌面和浏览器上运行的应用程序的最佳技术？

> ID：80452
> 
> 赞同：1
> 
> 时间：2008-09-17T06:09:24.180
> 
> 标签：c++, client, distributed

微软WPF？Adobe AIR/Flex？Adobe闪存？卷曲编程语言？

AJAX 如何适应？

给定一个用 C++ .NET 编写的服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T08:18:39.737

答案确实取决于您的应用程序实际执行的操作以及您的平台要求。

如果它是像 gmail 这样的常规 Web 应用程序，并且您希望它可以在许多浏览器和平台上运行；那么我推荐 HTML、CSS 和[GWT](http://code.google.com/webtoolkit/)的组合，因为这意味着您的应用程序代码都是 Java，它很容易重构模块化和维护，那里有大量的 Java 程序员，Java 的 IDE 很棒（IntelliJ 或日食等）。

然后，您可以在有意义的情况下使用 Siverlight 或 Flex 等浏览器插件（例如，[Google 财务](http://finance.google.com/finance)使用 Flash 制作交互式图表）。

如果您的应用程序是高度图形化的，例如 Visio 类型的东西或需要嵌入 Microsoft Office 或其他东西；您可能想看看 Silverlight/Flex/AIR，特别是如果您可以为内部应用程序指定浏览器版本和平台。

虽然客户端没有明确的单一答案（只需查看此线程上的评论 :) 有很多选项（Java Applets/Swing/JavaFX、Ajax、GWT、Air/Flex、Silverlight/.Net 等）都有优势和弱点。对于客户端和 C++ 服务器之间的通信，我的建议是将 C++ 应用程序公开为一组 RESTful 资源 - 然后在任何时间点，您都可以轻松地使用任何语言技术或框架编写其他类型的客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T06:11:47.640

使用 WPF，您可以构建桌面，然后几乎 1:1 将其移植到 silverlight 并以网络为目标

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T06:13:47.680

银光呢？

此外，应用 MVP 模式的基于 XAML 的解决方案可能非常好，当 UI 层可以基于前端类型呈现并且与业务模型没有强关系时。

干杯!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T06:17:51.540

我记得看到一个免费的 C++ 库，它为您提供了基于 Web 的 UI。没有尝试过，也不记得它的名字，但如果你想要 C++，这可能是诀窍。

或者我可能会选择 Adob​​e 的 Air 或 Google 的 Gear。如果你想要一些你可以在一个周末做的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T06:22:45.473

考虑在 Silverlight 中开发应用程序，并使用以下 2 种方法中的任何一种来使相同的 Silverlight 应用程序也在桌面中运行。我承认这两个只是愚蠢的技巧，但如果您的应用程序没有太多的层依赖关系，它会有所帮助。

1) [http://jobijoy.blogspot.com/2008/09/desklighter-handy-tool-for-silverlight.html](http://jobijoy.blogspot.com/2008/09/desklighter-handy-tool-for-silverlight.html) 2) [http://geekswithblogs.net/lbugnion/archive/2008/04/24/silverlight-running -standalone-full-trust-applications.aspx](http://geekswithblogs.net/lbugnion/archive/2008/04/24/silverlight-running-standalone-full-trust-applications.aspx)

还有另一种来自微软的名为[Live Mesh](https://www.mesh.com/Welcome/Welcome.aspx)的技术也将支持离线和在线 silverlight 应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T08:04:50.207

我们创建了一个在浏览器中或作为独立应用程序进行 3D 可视化的应用程序。

该应用程序是用 JavaScript（用于应用程序逻辑）和 C++（用于 3D 渲染）编写的，并使用来自[http://www.trolltech.com](http://www.trolltech.com)的 Qt 库。

在浏览器中运行时，应用程序作为 ActiveX 控件（用于 IE）和 Netscape 浏览器插件（用于 Firefox、Mozilla、Netscape、Opera）被包裹在一个薄层中。Qt 会或多或少地自动包装插件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T08:07:38.343

您的两个主要选择是 Silverlight / WPF 和 Flex / Air。

如果您熟悉 .NET 框架，请使用第一个，如果您更熟悉 Flash/ECMA 脚本，请使用后者。

使用最好的工具来完成这项工作。如果两种工具相同，请使用您训练有素的工具，或者使用最简单的工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T20:30:31.243

创建一个 DHTML/Ajax 应用程序并使用[Google Gears](http://gears.google.com/)保存数据，以便它在离线时仍然可以运行。

# performance - 大型目录结构、网络应用程序的性能

> ID：80470
> 
> 赞同：0
> 
> 时间：2008-09-17T06:12:43.657
> 
> 标签：performance, nfs

如果要在共享的 nfs 文件系统上访问深层目录，我正在尝试找出大型目录结构的性能。结构过于庞大，有 4 级嵌套目录，每级包含 1024 个目录。（根目录中的 1024，给定子目录中的 1024，依此类推）。

该文件系统将位于用户将访问以获取其个人信息的网络存储库上。数据将被复制到多台服务器上并进行负载平衡，但每台机器在任何时候都会有不错的负载。

如果第 4 级包含用户正在寻找的信息，性能会有多差？如果所有人都在访问不同的子目录？这可以通过缓存 inode 信息来解决吗？

我已经对此进行了一段时间的搜索，但我主要是在查找有关大文件而不是大型目录结构的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T16:32:33.573

我曾经在工作中这样做过。不记得确切的数字，但我认为它有 8 层深，每层有 10 个子目录（用户 id 87654321 映射到目录 8/7/6/5/4/3/2/1/。结果是不是一个好主意，开始遇到文件系统 inode 数量限制的问题，iirc（10^10 = 10000000000 个目录，不好）。切换到每个级别的子目录更多，级别更少；问题消失了。您的情况听起来更易于管理，但仍然要检查您的文件系统是否支持您预期的文件和目录计数类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T06:17:41.417

这里的答案将高度依赖于您的操作系统，您能否提供更多信息？我发现 Linux 下的文件打开时间在几万个目录大小下是合理的，但我没有尝试过任何与你一样大的目录结构的测试（你知道 1024 的四次方是 1,099,511,627,776 对？那是地球人口的180倍，对吧？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T06:18:41.413

似乎您只想编写一个测试应用程序来生成 1024 个文件夹，向下迭代 8 个级别，每个文件夹包含一些（100 - 1000 个？）大小为 1KB 的文件，然后随机查找并访问这些文件。

跟踪多次通过的访问时间，看看它是否符合您的要求。

# java - 如何在 Java 中连接两个数组？

> ID：80476
> 
> 赞同：1514
> 
> 时间：2008-09-17T06:14:23.763
> 
> 标签：java, arrays, concatenation, add

我需要`String`在 Java 中连接两个数组。

```
void f(String[] first, String[] second) {
    String[] both = ???
} 
```

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1220
> 
> 时间：2008-09-17T06:34:37.023

我从旧的 Apache Commons Lang 库中找到了一个单行解决方案。
[`ArrayUtils.addAll(T[], T...)`](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/ArrayUtils.html#addAll%28T%5B%5D,%20T...%29)

代码：

```
String[] both = ArrayUtils.addAll(first, second); 
```

* * *

## 回答 #2

> 赞同：787
> 
> 时间：2008-09-17T06:20:25.543

这是一个简单的方法，它将连接两个数组并返回结果：

```
public <T> T[] concatenate(T[] a, T[] b) {
    int aLen = a.length;
    int bLen = b.length;

    @SuppressWarnings("unchecked")
    T[] c = (T[]) Array.newInstance(a.getClass().getComponentType(), aLen + bLen);
    System.arraycopy(a, 0, c, 0, aLen);
    System.arraycopy(b, 0, c, aLen, bLen);

    return c;
} 
```

请注意，它不适用于原始数据类型，仅适用于对象类型。

以下稍微复杂的版本适用于对象和原始数组。它通过使用`T`而不是`T[]`作为参数类型来做到这一点。

它还可以通过选择最通用的类​​型作为结果的组件类型来连接两种不同类型的数组。

```
public static <T> T concatenate(T a, T b) {
    if (!a.getClass().isArray() || !b.getClass().isArray()) {
        throw new IllegalArgumentException();
    }

    Class<?> resCompType;
    Class<?> aCompType = a.getClass().getComponentType();
    Class<?> bCompType = b.getClass().getComponentType();

    if (aCompType.isAssignableFrom(bCompType)) {
        resCompType = aCompType;
    } else if (bCompType.isAssignableFrom(aCompType)) {
        resCompType = bCompType;
    } else {
        throw new IllegalArgumentException();
    }

    int aLen = Array.getLength(a);
    int bLen = Array.getLength(b);

    @SuppressWarnings("unchecked")
    T result = (T) Array.newInstance(resCompType, aLen + bLen);
    System.arraycopy(a, 0, result, 0, aLen);
    System.arraycopy(b, 0, result, aLen, bLen);        

    return result;
} 
```

这是一个例子：

```
Assert.assertArrayEquals(new int[] { 1, 2, 3 }, concatenate(new int[] { 1, 2 }, new int[] { 3 }));
Assert.assertArrayEquals(new Number[] { 1, 2, 3f }, concatenate(new Integer[] { 1, 2 }, new Number[] { 3f })); 
```

* * *

## 回答 #3

> 赞同：547
> 
> 时间：2014-04-20T23:52:12.923

[`Stream`](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html)在 Java 8 中使用：

```
String[] both = Stream.concat(Arrays.stream(a), Arrays.stream(b))
                      .toArray(String[]::new); 
```

或者像这样，使用`flatMap`：

```
String[] both = Stream.of(a, b).flatMap(Stream::of)
                      .toArray(String[]::new); 
```

要对泛型类型执行此操作，您必须使用反射：

```
@SuppressWarnings("unchecked")
T[] both = Stream.concat(Arrays.stream(a), Arrays.stream(b)).toArray(
    size -> (T[]) Array.newInstance(a.getClass().getComponentType(), size)); 
```

* * *

## 回答 #4

> 赞同：491
> 
> 时间：2009-04-24T07:28:01.373

可以编写一个完全通用的版本，甚至可以扩展为连接任意数量的数组。这个版本需要 Java 6，因为他们使用[`Arrays.copyOf()`](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#copyOf%28T[],%20int%29)

两个版本都避免创建任何中间`List`对象，并用于`System.arraycopy()`确保复制大型数组尽可能快。

对于两个数组，它看起来像这样：

```
public static <T> T[] concat(T[] first, T[] second) {
  T[] result = Arrays.copyOf(first, first.length + second.length);
  System.arraycopy(second, 0, result, first.length, second.length);
  return result;
} 
```

对于任意数量的数组 (>= 1)，它看起来像这样：

```
public static <T> T[] concatAll(T[] first, T[]... rest) {
  int totalLength = first.length;
  for (T[] array : rest) {
    totalLength += array.length;
  }
  T[] result = Arrays.copyOf(first, totalLength);
  int offset = first.length;
  for (T[] array : rest) {
    System.arraycopy(array, 0, result, offset, array.length);
    offset += array.length;
  }
  return result;
} 
```

* * *

## 回答 #5

> 赞同：200
> 
> 时间：2011-03-09T15:19:39.390

或与心爱的[番石榴](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/collect/ObjectArrays.html#concat(T%5B%5D,%20T%5B%5D,%20java.lang.Class))：

```
String[] both = ObjectArrays.concat(first, second, String.class); 
```

此外，还有原始数组的版本：

*   `Booleans.concat(first, second)`
*   `Bytes.concat(first, second)`
*   `Chars.concat(first, second)`
*   `Doubles.concat(first, second)`
*   `Shorts.concat(first, second)`
*   `Ints.concat(first, second)`
*   `Longs.concat(first, second)`
*   `Floats.concat(first, second)`

* * *

## 回答 #6

> 赞同：140
> 
> 时间：2018-04-11T10:17:49.983

您可以在两行代码中附加两个数组。

```
String[] both = Arrays.copyOf(first, first.length + second.length);
System.arraycopy(second, 0, both, first.length, second.length); 
```

这是一个快速有效的解决方案，适用于原始类型以及所涉及的两种方法被重载。

您应该避免涉及 ArrayLists、流等的解决方案，因为这些将需要分配临时内存而没有任何用处。

您应该避免`for`大型数组的循环，因为它们效率不高。内置方法使用速度极快的块复制功能。

* * *

## 回答 #7

> 赞同：59
> 
> 时间：2008-09-18T20:59:06.157

使用 Java API：

```
String[] f(String[] first, String[] second) {
    List<String> both = new ArrayList<String>(first.length + second.length);
    Collections.addAll(both, first);
    Collections.addAll(both, second);
    return both.toArray(new String[both.size()]);
} 
```

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2011-10-11T10:54:01.030

一个**100% 旧的 java**解决方案，**没有** `System.arraycopy`（例如在 GWT 客户端中不可用）：

```
static String[] concat(String[]... arrays) {
    int length = 0;
    for (String[] array : arrays) {
        length += array.length;
    }
    String[] result = new String[length];
    int pos = 0;
    for (String[] array : arrays) {
        for (String element : array) {
            result[pos] = element;
            pos++;
        }
    }
    return result;
} 
```

* * *

## 回答 #9

> 赞同：34
> 
> 时间：2008-09-17T16:52:36.210

我最近解决了过度记忆旋转的问题。如果已知 a 和/或 b 通常为空，这里是 silvertab 代码的另一种改编（也已生成）：

```
private static <T> T[] concatOrReturnSame(T[] a, T[] b) {
    final int alen = a.length;
    final int blen = b.length;
    if (alen == 0) {
        return b;
    }
    if (blen == 0) {
        return a;
    }
    final T[] result = (T[]) java.lang.reflect.Array.
            newInstance(a.getClass().getComponentType(), alen + blen);
    System.arraycopy(a, 0, result, 0, alen);
    System.arraycopy(b, 0, result, alen, blen);
    return result;
} 
```

编辑：这篇文章的前一个版本指出，这样的数组重用应该被清楚地记录下来。正如 Maarten 在评论中指出的那样，通常最好只删除 if 语句，从而避免需要文档。但话又说回来，那些 if 语句首先是这个特定优化的重点。我会在这里留下这个答案，但要小心！

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2008-09-17T06:52:12.080

[Functional Java](http://functionaljava.org)库有一个数组包装类，它为数组配备了方便的方法，如连接。

```
import static fj.data.Array.array; 
```

...接着

```
Array<String> both = array(first).append(array(second)); 
```

要取出未包装的数组，请调用

```
String[] s = both.array(); 
```

* * *

## 回答 #11

> 赞同：27
> 
> 时间：2013-08-21T06:27:09.633

```
ArrayList<String> both = new ArrayList(Arrays.asList(first));
both.addAll(Arrays.asList(second));

both.toArray(new String[0]); 
```

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2016-02-10T12:48:08.893

Java8 使用 Stream 的另一种方式

```
 public String[] concatString(String[] a, String[] b){ 
    Stream<String> streamA = Arrays.stream(a);
    Stream<String> streamB = Arrays.stream(b);
    return Stream.concat(streamA, streamB).toArray(String[]::new); 
  } 
```

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2008-09-17T16:47:47.547

这是对 silvertab 解决方案的改编，对泛型进行了改造：

```
static <T> T[] concat(T[] a, T[] b) {
    final int alen = a.length;
    final int blen = b.length;
    final T[] result = (T[]) java.lang.reflect.Array.
            newInstance(a.getClass().getComponentType(), alen + blen);
    System.arraycopy(a, 0, result, 0, alen);
    System.arraycopy(b, 0, result, alen, blen);
    return result;
} 
```

注意：请参阅[Joachim](https://stackoverflow.com/questions/80476/how-to-concatenate-two-arrays-in-java/784842#784842)对 Java 6 解决方案的回答。它不仅消除了警告；它也更短、更高效、更易于阅读！

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2017-02-13T10:17:06.880

如果您使用这种方式，那么您无需导入任何第三方类。

如果你想连接`String`

**连接两个字符串数组的示例代码**

```
public static String[] combineString(String[] first, String[] second){
        int length = first.length + second.length;
        String[] result = new String[length];
        System.arraycopy(first, 0, result, 0, first.length);
        System.arraycopy(second, 0, result, first.length, second.length);
        return result;
    } 
```

如果你想连接`Int`

**连接两个整数数组的示例代码**

```
public static int[] combineInt(int[] a, int[] b){
        int length = a.length + b.length;
        int[] result = new int[length];
        System.arraycopy(a, 0, result, 0, a.length);
        System.arraycopy(b, 0, result, a.length, b.length);
        return result;
    } 
```

**这是主要方法**

```
 public static void main(String[] args) {

            String [] first = {"a", "b", "c"};
            String [] second = {"d", "e"};

            String [] joined = combineString(first, second);
            System.out.println("concatenated String array : " + Arrays.toString(joined));

            int[] array1 = {101,102,103,104};
            int[] array2 = {105,106,107,108};
            int[] concatenateInt = combineInt(array1, array2);

            System.out.println("concatenated Int array : " + Arrays.toString(concatenateInt));

        }
    } 
```

我们也可以使用这种方式。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2015-11-14T18:45:36.427

您可以尝试将其转换为 Arraylist 并使用 addAll 方法，然后再转换回数组。

```
List list = new ArrayList(Arrays.asList(first));
  list.addAll(Arrays.asList(second));
  String[] both = list.toArray(); 
```

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2012-07-13T12:08:42.240

请原谅我在这个已经很长的列表中添加另一个版本。我查看了每个答案，并决定我真的想要一个签名中只有一个参数的版本。我还添加了一些参数检查，以便在意外输入的情况下从早期失败中受益，并提供合理的信息。

```
@SuppressWarnings("unchecked")
public static <T> T[] concat(T[]... inputArrays) {
  if(inputArrays.length < 2) {
    throw new IllegalArgumentException("inputArrays must contain at least 2 arrays");
  }

  for(int i = 0; i < inputArrays.length; i++) {
    if(inputArrays[i] == null) {
      throw new IllegalArgumentException("inputArrays[" + i + "] is null");
    }
  }

  int totalLength = 0;

  for(T[] array : inputArrays) {
    totalLength += array.length;
  }

  T[] result = (T[]) Array.newInstance(inputArrays[0].getClass().getComponentType(), totalLength);

  int offset = 0;

  for(T[] array : inputArrays) {
    System.arraycopy(array, 0, result, offset, array.length);

    offset += array.length;
  }

  return result;
} 
```

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2018-10-23T13:29:08.810

使用 Java 8+ 流，您可以编写以下函数：

```
private static String[] concatArrays(final String[]... arrays) {
    return Arrays.stream(arrays)
         .flatMap(Arrays::stream)
         .toArray(String[]::new);
} 
```

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2018-10-27T18:52:33.340

这应该是单行的。

```
public String [] concatenate (final String array1[], final String array2[])
{
    return Stream.concat(Stream.of(array1), Stream.of(array2)).toArray(String[]::new);
} 
```

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2012-01-04T14:35:54.947

这里是由 silvertab 编写的伪代码解决方案的工作代码中的可能实现。

谢谢银牌！

```
public class Array {

   public static <T> T[] concat(T[] a, T[] b, ArrayBuilderI<T> builder) {
      T[] c = builder.build(a.length + b.length);
      System.arraycopy(a, 0, c, 0, a.length);
      System.arraycopy(b, 0, c, a.length, b.length);
      return c;
   }
} 
```

接下来是构建器界面。

注意：构建器是必需的，因为在 java 中无法做到

`new T[size]`

由于泛型类型擦除：

```
public interface ArrayBuilderI<T> {

   public T[] build(int size);
} 
```

这里是一个实现接口的具体构建器，构建一个`Integer`数组：

```
public class IntegerArrayBuilder implements ArrayBuilderI<Integer> {

   @Override
   public Integer[] build(int size) {
      return new Integer[size];
   }
} 
```

最后是应用程序/测试：

```
@Test
public class ArrayTest {

   public void array_concatenation() {
      Integer a[] = new Integer[]{0,1};
      Integer b[] = new Integer[]{2,3};
      Integer c[] = Array.concat(a, b, new IntegerArrayBuilder());
      assertEquals(4, c.length);
      assertEquals(0, (int)c[0]);
      assertEquals(1, (int)c[1]);
      assertEquals(2, (int)c[2]);
      assertEquals(3, (int)c[3]);
   }
} 
```

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2009-04-24T07:12:41.193

这可行，但您需要插入自己的错误检查。

```
public class StringConcatenate {

    public static void main(String[] args){

        // Create two arrays to concatenate and one array to hold both
        String[] arr1 = new String[]{"s","t","r","i","n","g"};
        String[] arr2 = new String[]{"s","t","r","i","n","g"};
        String[] arrBoth = new String[arr1.length+arr2.length];

        // Copy elements from first array into first part of new array
        for(int i = 0; i < arr1.length; i++){
            arrBoth[i] = arr1[i];
        }

        // Copy elements from second array into last part of new array
        for(int j = arr1.length;j < arrBoth.length;j++){
            arrBoth[j] = arr2[j-arr1.length];
        }

        // Print result
        for(int k = 0; k < arrBoth.length; k++){
            System.out.print(arrBoth[k]);
        }

        // Additional line to make your terminal look better at completion!
        System.out.println();
    }
} 
```

它可能不是最有效的，但它不依赖于 Java 自己的 API 以外的任何东西。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2012-10-28T20:23:12.990

哇！这里有很多复杂的答案，包括一些依赖于外部依赖的简单答案。这样做怎么样：

```
String [] arg1 = new String{"a","b","c"};
String [] arg2 = new String{"x","y","z"};

ArrayList<String> temp = new ArrayList<String>();
temp.addAll(Arrays.asList(arg1));
temp.addAll(Arrays.asList(arg2));
String [] concatedArgs = temp.toArray(new String[arg1.length+arg2.length]); 
```

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2018-11-06T23:02:54.220

使用高性能 System.arraycopy 而不需要 @SuppressWarnings 注释的通用静态版本：

```
public static <T> T[] arrayConcat(T[] a, T[] b) {
    T[] both = Arrays.copyOf(a, a.length + b.length);
    System.arraycopy(b, 0, both, a.length, b.length);
    return both;
} 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2009-06-18T12:07:45.397

允许连接多个数组的简单变体：

```
public static String[] join(String[]...arrays) {

    final List<String> output = new ArrayList<String>();

    for(String[] array : arrays) {
        output.addAll(Arrays.asList(array));
    }

    return output.toArray(new String[output.size()]);
} 
```

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2011-06-11T19:59:56.370

这是字符串数组的转换函数：

```
public String[] mergeArrays(String[] mainArray, String[] addArray) {
    String[] finalArray = new String[mainArray.length + addArray.length];
    System.arraycopy(mainArray, 0, finalArray, 0, mainArray.length);
    System.arraycopy(addArray, 0, finalArray, mainArray.length, addArray.length);

    return finalArray;
} 
```

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2011-10-12T00:15:35.327

简单点怎么样

```
public static class Array {

    public static <T> T[] concat(T[]... arrays) {
        ArrayList<T> al = new ArrayList<T>();
        for (T[] one : arrays)
            Collections.addAll(al, one);
        return (T[]) al.toArray(arrays[0].clone());
    }
} 
```

就这样做`Array.concat(arr1, arr2)`。只要`arr1`和`arr2`属于同一类型，这将为您提供另一个包含两个数组的相同类型的数组。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2015-02-11T23:35:38.973

怎么样 ：

```
public String[] combineArray (String[] ... strings) {
    List<String> tmpList = new ArrayList<String>();
    for (int i = 0; i < strings.length; i++)
        tmpList.addAll(Arrays.asList(strings[i]));
    return tmpList.toArray(new String[tmpList.size()]);
} 
```

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2011-06-09T15:48:05.237

这是我稍微改进的 Joachim Sauer 的 concatAll 版本。它可以在 Java 5 或 6 上运行，如果它在运行时可用，则使用 Java 6 的 System.arraycopy。此方法（恕我直言）非常适合 Android，因为它适用于 Android <9（没有 System.arraycopy），但如果可能，将使用更快的方法。

```
 public static <T> T[] concatAll(T[] first, T[]... rest) {
    int totalLength = first.length;
    for (T[] array : rest) {
      totalLength += array.length;
    }
    T[] result;
    try {
      Method arraysCopyOf = Arrays.class.getMethod("copyOf", Object[].class, int.class);
      result = (T[]) arraysCopyOf.invoke(null, first, totalLength);
    } catch (Exception e){
      //Java 6 / Android >= 9 way didn't work, so use the "traditional" approach
      result = (T[]) java.lang.reflect.Array.newInstance(first.getClass().getComponentType(), totalLength);
      System.arraycopy(first, 0, result, 0, first.length);
    }
    int offset = first.length;
    for (T[] array : rest) {
      System.arraycopy(array, 0, result, offset, array.length);
      offset += array.length;
    }
    return result;
  } 
```

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2010-12-29T07:29:11.063

```
public String[] concat(String[]... arrays)
{
    int length = 0;
    for (String[] array : arrays) {
        length += array.length;
    }
    String[] result = new String[length];
    int destPos = 0;
    for (String[] array : arrays) {
        System.arraycopy(array, 0, result, destPos, array.length);
        destPos += array.length;
    }
    return result;
} 
```

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2013-02-27T03:03:56.277

另一种思考问题的方式。要连接两个或多个数组，必须列出每个数组的所有元素，然后构建一个新数组。这听起来像是创建一个`List<T>`然后调用`toArray`它。其他一些答案使用`ArrayList`，这很好。但是如何实现我们自己的呢？这并不难：

```
private static <T> T[] addAll(final T[] f, final T...o){
    return new AbstractList<T>(){

        @Override
        public T get(int i) {
            return i>=f.length ? o[i - f.length] : f[i];
        }

        @Override
        public int size() {
            return f.length + o.length;
        }

    }.toArray(f);
} 
```

我相信以上内容等同于使用`System.arraycopy`. 不过我觉得这个有它自己的美。

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2019-03-24T04:22:43.697

这可能是唯一通用且类型安全的方法：

```
public class ArrayConcatenator<T> {
    private final IntFunction<T[]> generator;

    private ArrayConcatenator(IntFunction<T[]> generator) {
        this.generator = generator;
    }

    public static <T> ArrayConcatenator<T> concat(IntFunction<T[]> generator) {
        return new ArrayConcatenator<>(generator);
    }

    public T[] apply(T[] array1, T[] array2) {
        T[] array = generator.apply(array1.length + array2.length);
        System.arraycopy(array1, 0, array, 0, array1.length);
        System.arraycopy(array2, 0, array, array1.length, array2.length);
        return array;
    }
} 
```

而且用法非常简洁：

```
Integer[] array1 = { 1, 2, 3 };
Double[] array2 = { 4.0, 5.0, 6.0 };
Number[] array = concat(Number[]::new).apply(array1, array2); 
```

（需要静态导入）

无效的数组类型被拒绝：

```
concat(String[]::new).apply(array1, array2); // error
concat(Integer[]::new).apply(array1, array2); // error 
```

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2016-11-28T23:20:24.503

这是[AbacusUtil](https://github.com/landawn/AbacusUtil)的代码。

```
String[] a = {"a", "b", "c"};
String[] b = {"1", "2", "3"};
String[] c = N.concat(a, b); // c = ["a", "b", "c", "1", "2", "3"]

// N.concat(...) is null-safety.
a = null;
c = N.concat(a, b); // c = ["1", "2", "3"] 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2009-06-18T12:13:48.207

与类型无关的变体（已更新 - 感谢 Volley 实例化 T）：

```
@SuppressWarnings("unchecked")
public static <T> T[] join(T[]...arrays) {

    final List<T> output = new ArrayList<T>();

    for(T[] array : arrays) {
        output.addAll(Arrays.asList(array));
    }

    return output.toArray((T[])Array.newInstance(
        arrays[0].getClass().getComponentType(), output.size()));
} 
```

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2009-04-24T15:52:46.060

一种简单但低效的方法（不包括泛型）：

```
ArrayList baseArray = new ArrayList(Arrays.asList(array1));
baseArray.addAll(Arrays.asList(array2));
String concatenated[] = (String []) baseArray.toArray(new String[baseArray.size()]); 
```

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2008-09-17T08:02:41.100

仅使用 Java 自己的 API：

```
 String[] join(String[]... arrays) {
  // calculate size of target array
  int size = 0;
  for (String[] array : arrays) {
    size += array.length;
  }

  // create list of appropriate size
  java.util.List list = new java.util.ArrayList(size);

  // add arrays
  for (String[] array : arrays) {
    list.addAll(java.util.Arrays.asList(array));
  }

  // create and return final array
  return list.toArray(new String[size]);
} 
```

现在，这段代码并不是最高效的，但它只依赖于标准的 java 类，并且很容易理解。它适用于任意数量的 String[]（甚至是零数组）。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2013-06-21T12:59:12.240

```
String [] both = new ArrayList<String>(){{addAll(Arrays.asList(first)); addAll(Arrays.asList(second));}}.toArray(new String[0]); 
```

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2012-04-30T10:55:35.063

我发现我必须处理数组可以为空的情况......

```
private double[] concat  (double[]a,double[]b){
    if (a == null) return b;
    if (b == null) return a;
    double[] r = new double[a.length+b.length];
    System.arraycopy(a, 0, r, 0, a.length);
    System.arraycopy(b, 0, r, a.length, b.length);
    return r;

}
private double[] copyRest (double[]a, int start){
    if (a == null) return null;
    if (start > a.length)return null;
    double[]r = new double[a.length-start];
    System.arraycopy(a,start,r,0,a.length-start); 
    return r;
} 
```

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2016-02-26T05:18:45.123

```
public static String[] toArray(String[]... object){
    List<String> list=new ArrayList<>();
    for (String[] i : object) {
        list.addAll(Arrays.asList(i));
    }
    return list.toArray(new String[list.size()]);
} 
```

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2016-09-04T22:54:10.360

每个答案都是复制数据并创建一个新数组。这不是绝对必要的，如果您的数组相当大，这绝对不是您想要做的。Java 的创建者已经知道数组复制是浪费的，这就是为什么他们提供给我们 System.arrayCopy() 来在我们必须的时候在 Java 之外做这些事情。

与其复制您的数据，不如考虑将其留在原处并从中提取数据。仅仅因为程序员想要组织它们而复制数据位置并不总是明智的。

```
// I have arrayA and arrayB; would like to treat them as concatenated
// but leave my damn bytes where they are!
Object accessElement ( int index ) {
     if ( index < 0 ) throw new ArrayIndexOutOfBoundsException(...);
     // is reading from the head part?
     if ( index < arrayA.length )
          return arrayA[ index ];
     // is reading from the tail part?
     if ( index < ( arrayA.length + arrayB.length ) )
          return arrayB[ index - arrayA.length ];
     throw new ArrayIndexOutOfBoundsException(...); // index too large
} 
```

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2011-01-01T16:27:38.667

另一个基于 SilverTab 的建议，但支持 x 个参数并且不需要 Java 6。它也不是通用的，但我相信它可以通用。

```
private byte[] concat(byte[]... args)
{
    int fulllength = 0;
    for (byte[] arrItem : args)
    {
        fulllength += arrItem.length;
    }
    byte[] retArray = new byte[fulllength];
    int start = 0;
    for (byte[] arrItem : args)
    {
        System.arraycopy(arrItem, 0, retArray, start, arrItem.length);
        start += arrItem.length;
    }
    return retArray;
} 
```

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2011-07-14T10:30:44.890

```
Import java.util.*;

String array1[] = {"bla","bla"};
String array2[] = {"bla","bla"};

ArrayList<String> tempArray = new ArrayList<String>(Arrays.asList(array1));
tempArray.addAll(Arrays.asList(array2));
String array3[] = films.toArray(new String[1]); // size will be overwritten if needed 
```

您可以用您喜欢的类型/类替换​​字符串

我相信这可以做得更短更好，但它有效，我懒得进一步整理......

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2008-09-25T18:57:51.993

如果您想在解决方案中使用 ArrayLists，可以试试这个：

```
public final String [] f(final String [] first, final String [] second) {
    // Assuming non-null for brevity.
    final ArrayList<String> resultList = new ArrayList<String>(Arrays.asList(first));
    resultList.addAll(new ArrayList<String>(Arrays.asList(second)));
    return resultList.toArray(new String [resultList.size()]);
} 
```

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2014-07-29T23:03:01.180

我认为使用泛型的最佳解决方案是：

```
/* This for non primitive types */
public static <T> T[] concatenate (T[]... elements) {

    T[] C = null;
    for (T[] element: elements) {
        if (element==null) continue;
        if (C==null) C = (T[]) Array.newInstance(element.getClass().getComponentType(), element.length);
        else C = resizeArray(C, C.length+element.length);

        System.arraycopy(element, 0, C, C.length-element.length, element.length);
    }

    return C;
}

/**
 * as far as i know, primitive types do not accept generics 
 * http://stackoverflow.com/questions/2721546/why-dont-java-generics-support-primitive-types
 * for primitive types we could do something like this:
 * */
public static int[] concatenate (int[]... elements){
    int[] C = null;
    for (int[] element: elements) {
        if (element==null) continue;
        if (C==null) C = new int[element.length];
        else C = resizeArray(C, C.length+element.length);

        System.arraycopy(element, 0, C, C.length-element.length, element.length);
    }
    return C;
}

private static <T> T resizeArray (T array, int newSize) {
    int oldSize =
            java.lang.reflect.Array.getLength(array);
    Class elementType =
            array.getClass().getComponentType();
    Object newArray =
            java.lang.reflect.Array.newInstance(
                    elementType, newSize);
    int preserveLength = Math.min(oldSize, newSize);
    if (preserveLength > 0)
        System.arraycopy(array, 0,
                newArray, 0, preserveLength);
    return (T) newArray;
} 
```

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2018-09-17T21:02:38.047

非 Java 8 解决方案：

```
public static int[] combineArrays(int[] a, int[] b) {
        int[] c = new int[a.length + b.length];

        for (int i = 0; i < a.length; i++) {
            c[i] = a[i];
        }

        for (int j = 0, k = a.length; j < b.length; j++, k++) {
            c[k] = b[j];
        }

        return c;
    } 
```

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2015-10-08T14:27:34.980

```
public int[] mergeArrays(int [] a, int [] b) {
    int [] merged = new int[a.length + b.length];
    int i = 0, k = 0, l = a.length;
    int j = a.length > b.length ? a.length : b.length;
    while(i < j) {
        if(k < a.length) {
            merged[k] = a[k];
            k++;
        }
        if((l - a.length) < b.length) {
            merged[l] = b[l - a.length];
            l++;
        }
        i++;
    }
    return merged;
} 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2011-07-21T13:58:19.600

**你可以试试这个**

```
 public static Object[] addTwoArray(Object[] objArr1, Object[] objArr2){
    int arr1Length = objArr1!=null && objArr1.length>0?objArr1.length:0;
    int arr2Length = objArr2!=null && objArr2.length>0?objArr2.length:0;
    Object[] resutlentArray = new Object[arr1Length+arr2Length]; 
    for(int i=0,j=0;i<resutlentArray.length;i++){
        if(i+1<=arr1Length){
            resutlentArray[i]=objArr1[i];
        }else{
            resutlentArray[i]=objArr2[j];
            j++;
        }
    }

    return resutlentArray;
} 
```

你可以输入你的数组！

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-04-01T22:15:50.170

我测试了下面的代码并且工作正常

我也在使用库：org.apache.commons.lang.ArrayUtils

```
public void testConcatArrayString(){
    String[] a = null;
    String[] b = null;
    String[] c = null;
    a = new String[] {"1","2","3","4","5"};
    b = new String[] {"A","B","C","D","E"};

    c = (String[]) ArrayUtils.addAll(a, b);
    if(c!=null){
        for(int i=0; i<c.length; i++){
            System.out.println("c[" + (i+1) + "] = " + c[i]);
        }
    }
} 
```

问候

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2011-03-31T09:12:01.283

```
Object[] obj = {"hi","there"};
Object[] obj2 ={"im","fine","what abt u"};
Object[] obj3 = new Object[obj.length+obj2.length];

for(int i =0;i<obj3.length;i++)
    obj3[i] = (i<obj.length)?obj[i]:obj2[i-obj.length]; 
```

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2014-01-03T12:21:08.857

这个只适用于 int 但这个想法是通用的

```
public static int[] junta(int[] v, int[] w) {

int[] junta = new int[v.length + w.length];

for (int i = 0; i < v.length; i++) {            
    junta[i] = v[i];
}

for (int j = v.length; j < junta.length; j++) {
    junta[j] = w[j - v.length];
} 
```

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2011-06-10T04:14:31.870

我能找到的最简单的方法如下：

```
 List allFiltersList = Arrays.asList(regularFilters);
allFiltersList.addAll(Arrays.asList(preFiltersArray));
Filter[] mergedFilterArray = (Filter[]) allFiltersList.toArray(); 

```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2018-04-12T09:53:37.620

在 Java 8 中

```
public String[] concat(String[] arr1, String[] arr2){
    Stream<String> stream1 = Stream.of(arr1);
    Stream<String> stream2 = Stream.of(arr2);
    Stream<String> stream = Stream.concat(stream1, stream2);
    return Arrays.toString(stream.toArray(String[]::new));
} 
```

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2021-09-13T04:54:32.607

使用 Java 集合

好吧，Java 没有提供连接数组的辅助方法。但是，从 Java 5 开始，Collections 实用程序类引入了 addAll(Collection<? super T> c, T... elements) 方法。

我们可以创建一个 List 对象，然后调用该方法两次，将两个数组添加到列表中。最后，我们将生成的 List 转换回数组：

```
static <T> T[] concatWithCollection(T[] array1, T[] array2) {
    List<T> resultList = new ArrayList<>(array1.length + array2.length);
    Collections.addAll(resultList, array1);
    Collections.addAll(resultList, array2);

    @SuppressWarnings("unchecked")
    //the type cast is safe as the array1 has the type T[]
    T[] resultArray = (T[]) Array.newInstance(array1.getClass().getComponentType(), 0);
    return resultList.toArray(resultArray);
} 
```

测试

```
@Test
public void givenTwoStringArrays_whenConcatWithList_thenGetExpectedResult() {
    String[] result = ArrayConcatUtil.concatWithCollection(strArray1, strArray2);
    assertThat(result).isEqualTo(expectedStringArray);
} 
```

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2017-10-27T10:16:04.387

您可以尝试这种连接多个数组的方法：

```
public static <T> T[] concatMultipleArrays(T[]... arrays)
{
   int length = 0;
   for (T[] array : arrays)
   {
      length += array.length;
   }
   T[] result = (T[]) Array.newInstance(arrays.getClass().getComponentType(), length) ;

   length = 0;
   for (int i = 0; i < arrays.length; i++)
   {
      System.arraycopy(arrays[i], 0, result, length, arrays[i].length);
      length += arrays[i].length;
   }

   return result;
} 
```

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2020-12-28T20:58:29.683

我使用下一个方法使用 java 8 连接任意数量的相同类型的数组：

```
public static <G> G[] concatenate(IntFunction<G[]> generator, G[] ... arrays) {
    int len = arrays.length;
    if (len == 0) {
        return generator.apply(0);
    } else if (len == 1) {
        return arrays[0];
    }
    int pos = 0;
    Stream<G> result = Stream.concat(Arrays.stream(arrays[pos]), Arrays.stream(arrays[++pos]));
    while (pos < len - 1) {
        result = Stream.concat(result, Arrays.stream(arrays[++pos]));
    }
    return result.toArray(generator);
} 
```

用法：

```
 concatenate(String[]::new, new String[]{"one"}, new String[]{"two"}, new String[]{"three"}) 
```

或者

```
 concatenate(Integer[]::new, new Integer[]{1}, new Integer[]{2}, new Integer[]{3}) 
```

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2017-10-03T10:31:41.723

算法爱好者的另一个答案：

```
public static String[] mergeArrays(String[] array1, String[] array2) {
    int totalSize = array1.length + array2.length; // Get total size
    String[] merged = new String[totalSize]; // Create new array
    // Loop over the total size
    for (int i = 0; i < totalSize; i++) {
        if (i < array1.length) // If the current position is less than the length of the first array, take value from first array
            merged[i] = array1[i]; // Position in first array is the current position

        else // If current position is equal or greater than the first array, take value from second array.
            merged[i] = array2[i - array1.length]; // Position in second array is current position minus length of first array.
    }

    return merged; 
```

用法：

```
String[] array1str = new String[]{"a", "b", "c", "d"}; 
String[] array2str = new String[]{"e", "f", "g", "h", "i"};
String[] listTotalstr = mergeArrays(array1str, array2str);
System.out.println(Arrays.toString(listTotalstr)); 
```

结果：

```
[a, b, c, d, e, f, g, h, i] 
```

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2020-02-01T13:52:40.363

只是想添加，您也可以使用`System.arraycopy`：

```
import static java.lang.System.out;
import static java.lang.System.arraycopy;
import java.lang.reflect.Array;
class Playground {
    @SuppressWarnings("unchecked")
    public static <T>T[] combineArrays(T[] a1, T[] a2) {
        T[] result = (T[]) Array.newInstance(a1.getClass().getComponentType(), a1.length+a2.length);
        arraycopy(a1,0,result,0,a1.length);
        arraycopy(a2,0,result,a1.length,a2.length);
        return result;
    }
    public static void main(String[ ] args) {
        String monthsString = "JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC";
        String[] months = monthsString.split("(?<=\\G.{3})");
        String daysString = "SUNMONTUEWEDTHUFRISAT";
        String[] days = daysString.split("(?<=\\G.{3})");
        for (String m : months) {
            out.println(m);
        }
        out.println("===");
         for (String d : days) {
            out.println(d);
        }
        out.println("===");
        String[] results = combineArrays(months, days);
        for (String r : results) {
            out.println(r);
        }
        out.println("===");
    }
} 
```

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2021-01-14T21:50:44.533

刚发现这个问题，不好意思很晚，看到很多答案太远了，使用某些库，使用将数据从数组转换为流再返回数组的特性等等。但是，我们可以只使用一个简单的循环，问题就解决了

```
public String[] concat(String[] firstArr,String[] secondArr){
        //if both is empty just return
        if(firstArr.length==0 && secondArr.length==0)return new String[0];

        String[] res = new String[firstArr.length+secondArr.length];
        int idxFromFirst=0;

        //loop over firstArr, idxFromFirst will be used as starting offset for secondArr
        for(int i=0;i<firstArr.length;i++){
            res[i] = firstArr[i];
            idxFromFirst++;
        }

        //loop over secondArr, with starting offset idxFromFirst (the offset track from first array)
        for(int i=0;i<secondArr.length;i++){
            res[idxFromFirst+i]=secondArr[i];
        }

        return res;
    } 
```

就是这样，对吧？他没有说他关心订单或任何事情。这应该是最简单的方法。

* * *

## 回答 #57

> 赞同：0
> 
> 时间：2016-07-19T01:55:15.637

```
Object[] mixArray(String[] a, String[] b)
String[] s1 = a;
String[] s2 = b;
Object[] result;
List<String> input = new ArrayList<String>();
for (int i = 0; i < s1.length; i++)
{
    input.add(s1[i]);
}
for (int i = 0; i < s2.length; i++)
{
    input.add(s2[i]);
}
result = input.toArray();
return result; 
```

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2019-10-28T08:15:27.703

*使用 lambda 连接一系列紧凑、快速且类型安全的数组*

```
@SafeVarargs
public static <T> T[] concat( T[]... arrays ) {
  return( Stream.of( arrays ).reduce( ( arr1, arr2 ) -> {
      T[] rslt = Arrays.copyOf( arr1, arr1.length + arr2.length );
      System.arraycopy( arr2, 0, rslt, arr1.length, arr2.length );
      return( rslt );
    } ).orElse( null ) );
}; 
```

`null`不带参数调用时返回

例如。带有 3 个数组的示例：

```
String[] a = new String[] { "a", "b", "c", "d" };
String[] b = new String[] { "e", "f", "g", "h" };
String[] c = new String[] { "i", "j", "k", "l" };

concat( a, b, c );  // [a, b, c, d, e, f, g, h, i, j, k, l] 
```

*“……可能是唯一通用且类型安全的方式”* ——改编：

```
Number[] array1 = { 1, 2, 3 };
Number[] array2 = { 4.0, 5.0, 6.0 };
Number[] array = concat( array1, array2 );  // [1, 2, 3, 4.0, 5.0, 6.0] 
```

* * *

## 回答 #59

> 赞同：-1
> 
> 时间：2012-03-01T08:18:31.960

在 Haskell 中，您可以执行类似的操作`[a, b, c] ++ [d, e]`来获取`[a, b, c, d, e]`. 这些是串联的 Haskell 列表，但很高兴在 Java 中看到类似的数组运算符。你不这么认为吗？这是优雅、简单、通用的，实现起来并不难。

如果你愿意，我建议你看看 Alexander Hristov 在他的[Hacking the OpenJDK compiler](http://www.ahristov.com/tutoriales/java-compiler/duplicating-lexer.html)中的工作。他解释了如何修改 javac 源代码以创建新的运算符。他的示例包括定义一个 '**' 运算符 where `i ** j = Math.pow(i, j)`。可以举这个例子来实现一个连接两个相同类型数组的运算符。

一旦你这样做了，你就会绑定到你定制的 javac 来编译你的代码，但是生成的字节码将被任何 JVM 理解。

当然，您可以在源代码级别实现自己的数组连接方法，其他答案中有很多关于如何做到这一点的示例！

有很多有用的运算符可以添加，这个就是其中之一。

* * *

## 回答 #60

> 赞同：-1
> 
> 时间：2012-04-07T17:50:13.927

看看这个优雅的解决方案（如果您需要 char 以外的其他类型，请更改它）：

```
private static void concatArrays(char[] destination, char[]... sources) {
    int currPos = 0;
    for (char[] source : sources) {
        int length = source.length;
        System.arraycopy(source, 0, destination, currPos, length);
        currPos += length;
    }
} 
```

您可以连接每个数组。

* * *

## 回答 #61

> 赞同：-1
> 
> 时间：2013-10-29T19:00:10.117

应该做的伎俩。这是假设 String[] 第一和 String[] 第二

```
List<String> myList = new ArrayList<String>(Arrays.asList(first));
myList.addAll(new ArrayList<String>(Arrays.asList(second)));
String[] both = myList.toArray(new String[myList.size()]); 
```

* * *

## 回答 #62

> 赞同：-1
> 
> 时间：2021-06-13T16:22:52.950

我有一个简单的方法。您不想浪费时间研究复杂的 java 函数或库。但返回类型应该是字符串。

```
String[] f(String[] first, String[] second) {

    // Variable declaration part
    int len1 = first.length;
    int len2 = second.length;
    int lenNew = len1 + len2;
    String[] both = new String[len1+len2];

    // For loop to fill the array "both"
    for (int i=0 ; i<lenNew ; i++){
        if (i<len1) {
            both[i] = first[i];
        } else {
            both[i] = second[i-len1];
        }
    }

    return both;

} 
```

很简单...

* * *

## 回答 #63

> 赞同：-1
> 
> 时间：2016-12-06T08:39:26.943

```
 void f(String[] first, String[] second) {
    String[] both = new String[first.length+second.length];
    for(int i=0;i<first.length;i++)
        both[i] = first[i];
    for(int i=0;i<second.length;i++)
        both[first.length + i] = second[i];
} 
```

这个可以在不了解任何其他类/库等的情况下工作。它适用于任何数据类型。只需用,或`String`之类的东西替换。它的工作效率很高。`int``double``char`

* * *

## 回答 #64

> 赞同：-2
> 
> 时间：2020-02-12T12:54:26.737

这对我有用：

```
String[] data=null;
String[] data2=null;
ArrayList<String> data1 = new ArrayList<String>();
for(int i=0; i<2;i++) {
   data2 = input.readLine().split(",");
   data1.addAll(Arrays.asList(data2));
   data= data1.toArray(new String[data1.size()]);
   } 
```

# tfs - 如何在 TFS 的构建中打开代码覆盖率？

> ID：80486
> 
> 赞同：10
> 
> 时间：2008-09-17T06:17:09.030
> 
> 标签：tfs, build-process, code-coverage

在使用 .testrunco​​nfig 文件的解决方案上运行 TFS 构建时，我需要知道如何打开代码覆盖率。

testrunco​​nfig 文件中有一个用于代码覆盖的选项，但是在运行 TFS 构建时没有代码覆盖结果。

我正在使用 *Tests.dll 掩码运行我的测试，而不是使用测试列表 (.vsmdi)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T06:47:15.417

你是如何运行测试的？您是在使用 .vsmdi 文件还是只是指定在 *Tests.dll 程序集中运行所有测试？

如果是后者并且您使用的是 TFS 2008，那么您需要将以下内容添加到 TFSBuild.proj 文件中第一个 PropertyGroup 的和中以进行构建。

```
<RunConfigFile>$(SolutionRoot)\TestRunConfig.testrunconfig</RunConfigFile> 
```

这会将构建指向您的 .testrunco​​nfig，因此它可以获取运行代码覆盖率的指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T20:18:51.453

无论您将 .vsmdi 文件用于测试列表还是仅指定程序集文件模式，都需要 RunConfigFile 条目。在该 .testrunco​​nfig 文件中，您指定要应用代码覆盖的程序集。

# c - 读取无格式数据

> ID：80493
> 
> 赞同：2
> 
> 时间：2008-09-17T06:18:24.847
> 
> 标签：c, windows, disk

在 C 中，使用标准 Windows API，读取未格式化磁盘的最佳方法是什么？具体来说，我有一个带有数据的[MMC](http://en.wikipedia.org/wiki/MultiMediaCard)或[SD 卡](http://en.wikipedia.org/wiki/Secure_Digital_card)，但没有文件系统（不是 FAT16，不是 FAT32，只是原始数据）。如果有一种简单的方法可以打开整个卡以进行逐字节二进制访问，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T09:20:24.893

我会去

```
HANDLE drive = CreateFile(_T("\\.\PhysicalDrive0"), GENERIC_READ, FILE_SHARE_WRITE, 0, OPEN_EXISTING, 0, 0);
// error handling
DWORD br = 0;
DISK_GEOMETRY dg;
DeviceIOControl(drive, IOCTL_DISK_GET_DRIVE_GEOMETRY, 0, 0, &dg, sizeof(dg), &br, 0);
//
LARGE_INTEGER pos;
pos.QuadPart = static_cast<LONGLONG>(sectorToRead) * dg.BytesPerSector;
SetFilePointerEx(drive, pos, 0, FILE_BEGIN);
const bool success = ReadFile(drive, sectorData, dg.BytesPerSector, &br) && br == dg.BytesPerSector;
//
CloseHandle(drive); 
```

请注意，为了验证您是否已成功读取扇区，您必须验证读取的字节数是否与您要读取的字节数相对应，即根据我的经验，物理磁盘上的 ReadFile() 可以返回 TRUE，即使当没有读取任何字节（或者我可能只是有一个错误的驱动程序）。

剩下的问题是确定您的驱动器号（在我的示例中使用的 0 是指 C: 这可能不是您想要的）。我不知道该怎么做，但是如果您只连接了一个未格式化的驱动器，则应该可以通过依次调用打开每个 PhysicalDrive 并使用命令调用 DeviceIOControl() 来`IOCTL_DISK_GET_DRIVE_LAYOUT_EX`实现：

```
DRIVE_LAYOUT_INFORMATION_EX dl;
DeviceIOControl(drive, IOCTL_DISK_GET_DRIVE_LAYOUT_EX, 0, 0, &dl, sizeof(dl), &br, 0);
if(dl.PartitionStyle == PARTITION_STYLE_RAW)
{
  // found correct disk
} 
```

但这只是一个猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T06:27:31.063

您必须使用[CreateFile](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)打开设备文件，然后使用[ReadFile](http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx) / [readFileEx](http://msdn.microsoft.com/en-us/library/aa365468(VS.85).aspx)。不要忘记使用[CloseHandle关闭文件](http://msdn.microsoft.com/en-us/library/ms724211.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T06:29:24.413

[MSDN 上的 CreateFile 函数参考](http://msdn.microsoft.com/en-us/library/aa363858.aspx)

向下滚动到“物理磁盘和卷” - 请注意，Vista 上的安全限制不适用于没有文件系统的卷，因此即使在您给定的条件下使用 Vista 也可以。

# linux - OpenOffice.org 模板在 Linux 中的位置是什么？

> ID：80515
> 
> 赞同：2
> 
> 时间：2008-09-17T06:22:48.500
> 
> 标签：linux, debian, openoffice.org

我想安装一些演示模板，但不知道放在哪里...

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T06:25:38.667

选择工具 > 选项 > OpenOffice.org > 路径并选择模板行。在那里，您可以单击“编辑”并查看它用于搜索模板的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T06:27:15.667

```
/usr/lib/openoffice/share/template/ 
```

那是在 Debian Lenny/testing 上。您可以通过键入找到它们

```
locate .ots 
```

在控制台中（ots 是 OOo 模板的扩展）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:27:14.963

不建议将模板放在 /usr/lib/openoffice/... 中，因为该文件夹的内容可以通过 Debian 软件包管理过程自动更改。对于站点范围的安装，我创建了文件夹“/usr/local/share/templates/ooo2/common”，在其中放置模板，然后将路径添加到上述路径集。

# c++ - 当手写笔在平板电脑上“抬起”时会发生什么？

> ID：80518
> 
> 赞同：0
> 
> 时间：2008-09-17T06:23:34.990
> 
> 标签：c++, windows, events, tablet-pc, stylus-pen

我正在处理一个遗留项目`VC++/Win32/MFC`。**最近，应用程序在平板电脑**上运行成为了一项要求，这带来了许多新问题。我已经能够处理并解决这些问题，**但剩下的问题是我可以使用一些专家建议。**

我有一个特殊的错误，它是由触控笔从活动表面“抬起”引起的。基本上，鼠标光标会消失，然后当您将其“按”回屏幕时重新出现。

这是有道理的，这是在应用程序中下落不明。您无法在台式电脑上**抬起**光标。所以我正在寻找的是一个很好的概述，当电梯发生时会发生什么（在 Windows 消息等方面）。这是否仅转化为焦点更改和鼠标悬停事件？我的错误似乎也涉及光标更改（尽管可能与提升无关）。当然，意外的“提升”正在破坏应用程序工具处理的状态。

**所以具体的问题是：**

1.  当手写笔“抬起”时会发生什么？出版社？
2.  可以使用哪些 API 调用来检测这一点？它是否只是转换为设置了标志/值的标准消息？
3.  当您的开发电脑是台式机时，有什么好方法来测试/模拟这个？我只是在这里瞎飞吗？（我只能定期访问平板电脑）
4.  什么代表平板电脑手写笔意识的正确行为或最佳实践？

谢谢你的考虑，ee

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T06:36:51.027

作为平板电脑用户，我可以回答您的一些问题。

第一的：

> 当触控笔必须拖出焦点窗口以按下虚拟键盘上的键时，您不能很容易地将“键盘焦点”保持在窗口上。

我使用过的大多数虚拟键盘（Windows 平板电脑输入面板和 ubuntu 下的一个）都允许他们输入的程序保持“键盘焦点”。

> 当手写笔“抬起”时会发生什么？出版社？

在 Windows 下，压力值下降，但除此之外，没有任何事件。（我不知道Linux。）

> 可以使用哪些 API 调用来检测这一点？它是否只是转换为设置了标志/值的标准消息？

如上所述，如果您可以获得压力值，则可以使用它。

> 当您的开发电脑是台式机时，有什么好方法来测试/模拟这个？我只是在这里瞎飞吗？（我只能定期访问平板电脑）

当手写笔放在别处时，指针的全局坐标会发生变化，因此，您可以使用任何允许您更改全局指针值的东西来模拟突然的指针移动。（Java 中的 Robot 类使这变得相当容易。）

> 什么代表平板电脑手写笔意识的正确行为或最佳实践？

我建议您阅读 Microsoft 所说的，MSDN 网站上有许多优秀的文章。( [http://msdn.microsoft.com/en-us/library/ms704849(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms704849(VS.85).aspx) ) 我会指出你的应用程序按钮的大小会产生巨大的差异。

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T06:40:38.410

据我了解，没有“抬起”事件——唯一的事件发生在稍后将触控笔带回屏幕时。当然，这取决于您的特定驱动程序等。

更糟糕的是，您描述的错误可能仅用典型的鼠标即可重现。尝试尽可能快地移动鼠标——它几乎肯定会一次跳跃几个像素。如果您将鼠标设置配置为最高指针速度，甚至几十个或数百个。一次更新，鼠标可能在 100,100。下一次更新，可能是 200,300。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T07:59:13.340

> 在 Windows 下，压力值下降，但除此之外，没有任何事件。（我不知道Linux。）

在linux下你会得到“ProximityEvents”

这些事件 WT_PROXIMITY 很可能在 Windows 中可用（请参阅：[http](http://www.wacomeng.com/devsupport/ibmpc/wacomwindevfaq.html) ://www.wacomeng.com/devsupport/ibmpc/wacomwindevfaq.html ）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T08:25:46.897

@Greg - 澄清一下，这是一台内置集成平板电脑和手写笔的笔记本电脑。该设备没有专用键盘（它是触摸屏上的虚拟键盘），也不是 wacom 输入设备。对困惑感到抱歉。

似乎有一个适用于 Microsoft Windows XP Tablet PC Edition 的[SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=B46D4B83-A821-40BC-AA85-C9EE3D6E9699&displaylang=en#RelatedLinks)，它可能具有获取压力等特殊细节的能力。但是，我知道必须与现有的非平板电脑感知应用程序具有某种程度的标准兼容性。我想我可以尝试在平板电脑上安装 Spy++ 并尝试过滤到特定的消息/事件。

# php - 给定两个日期，在 PHP 中查找工作日数的最佳方法是什么？

> ID：80541
> 
> 赞同：1
> 
> 时间：2008-09-17T06:28:36.677
> 
> 标签：php, date

标题几乎是不言自明的。给定两个日期，使用 PHP 查找工作日天数的最佳方法是什么？工作日为周一至周五。

例如，我如何知道`31/08/2008`和之间有 10 个工作日`13/09/2008`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T06:40:33.607

```
 $datefrom = strtotime($datefrom, 0);
        $dateto = strtotime($dateto, 0);

        $difference = $dateto - $datefrom;

        $days_difference = floor($difference / 86400);
        $weeks_difference = floor($days_difference / 7); // Complete weeks

        $first_day = date("w", $datefrom);
        $days_remainder = floor($days_difference % 7);

        $odd_days = $first_day + $days_remainder; // Do we have a Saturday or Sunday in the remainder?
        if ($odd_days > 7) { // Sunday
            $days_remainder--;
        }
        if ($odd_days > 6) { // Saturday
            $days_remainder--;
        }

        $datediff = ($weeks_difference * 5) + $days_remainder; 
```

从这里： http: [//www.addedbytes.com/php/php-datediff-function/](http://www.addedbytes.com/php/php-datediff-function/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T06:52:59.410

如果您正在创建一个发票系统，您必须考虑银行假期、复活节等。计算它并不简单。

我见过的最好的解决方案是预先生成一个包含天数及其类型的表到 SQL 数据库（每天行 = 每年 365 行），然后使用适当的选择（WHERE 子句）执行简单的计数查询。

*您可以在Joe Celko 的 Thinking in Sets: Auxiliary, Temporal, and Virtual Tables in SQL*中找到该解决方案的完整描述

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T06:32:05.220

一种方法是使用 strtotime(...) 将日期转换为 unix 时间戳，减去结果并使用 86400 (24*60*60) 进行除法：

```
$dif_in_seconds = abs(strtotime($a) - strtotime($b));
$daysbetween = $dif_in_seconds / 86400; 
```

ETA：哦..你的意思是周一到周五的工作日..一开始没看到..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T06:33:37.990

最好的方法是遍历给定日期范围之间的所有日期，并获取每个日期的星期几。如果是工作日，请增加某个计数器。在该过程结束时，您将获得工作日数。

PHP 函数 mktime() 和 date()（用于处理 UNIX 时间戳）在这里是您的朋友。

# sql - 除了需要许可证且 DBVisualiser 不支持的 Toad 之外，还有什么好的工具可以用于处理数据库

> ID：80544
> 
> 赞同：1
> 
> 时间：2008-09-17T06:29:32.963
> 
> 标签：sql, database

除了需要许可证且 DBVisualiser 不支持的 Toad 之外，还有什么好的工具可以在数据库上工作吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T10:41:54.493

我会推荐 oracle SQLdeveloper。它具有开发和维护所需的所有功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T06:35:43.307

试试 fabForce 数据库设计器；它也是 GPL。 [http://fabforce.net/dbdesigner4/](http://fabforce.net/dbdesigner4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T09:02:11.613

我正在使用[WinSQL](http://www.synametrics.com/SynametricsWebApp/WinSQL.jsp)的免费版本。
我也在看 Oracle 的[SQLDeveloper](http://www.oracle.com/technology/products/database/sql_developer/index.html)。我听说它和蟾蜍一样被提及。
在紧要关头，我发现 Excel 附带的 Microsoft Query 绰绰有余。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:59:53.563

我一直使用 Benthic 的 Golden 32 - 它简单、便宜，并且具有我需要的最常见的功能（查询、查看关系、编辑数据）。它只是甲骨文。AquaFold 的 Aqua Data Studio 是另一种支持多个数据库并具有大量功能的选项，但价格要贵得多。我使用了一段时间，但由于它的快速和易用性，我一直回到 Golden。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:12:47.107

我发现 SQuirrel SQL Client 是一款出色的工具。它需要 Java，因此取决于您对它可能是好事还是坏事的感觉。我觉得这很好，因为我在 Windows、Linux 和 OS X 上工作，而且它在所有平台上都运行良好。如果您只在一个平台上工作，您可能能够为该特定平台找到更好的客户。

它具有适用于许多不同数据库的插件，允许进行表格编辑，具有数据建模模块，SQL 编辑器中的自动完成功能以及许多其他漂亮的功能。

[http://www.squirrelsql.org/](http://www.squirrelsql.org/)

SQuirrel 目前是在 GNU Lesser General Public License 下发布的。

# asp.net - 传输文件，以奇怪的行为下载

> ID：80548
> 
> 赞同：1
> 
> 时间：2008-09-17T06:30:35.177
> 
> 标签：asp.net, delphi

我正在使用 httpresponse.Transmitfile 下载文件。如果我在文件下载对话框中选择保存在与建议文件夹不同的文件夹中，下载速率会下降到 10 - 20 kb。如果我取消，或者总是选​​择在同一个文件夹中下载，那么传输速率是 200 kb 或更多。这是我的代码：

```
procedure TDefault.LastNedBilde(strURL: string);  
var  
 Outfil: FileInfo;  
begin  
   Outfil:= FileInfo.Create(Server.MapPath(strUrl) );  
   response.Clear();  
   response.ClearContent();  
   response.ClearHeaders();  
   response.Buffer := True;  
   response.ContentType :='image/tiff';  
   response.AddHeader('Content-Disposition',  
                     'attachment; filename=' + filename;');  
   response.AddHeader('Content-Length', Outfil.Length.ToString());  
   response.Transmitfile(strUrl,0,Outfil.Length);  
   response.Flush();  
   response.&End;  
end; 
```

这是在 RadStudio 2007，Delphi for .Net 中编写的。有没有人经历过这样的事情？这在 Opera 或 Firefox 中不是问题，只有 Internet Explorer。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T06:32:29.727

服务器不知道用户将文件保存在哪里，因此服务器代码不是导致此问题的原因。

难道是你的浏览器正在缓存文件，然后如果你再次将它保存到相同的位置，它只使用缓存的版本，而不是从服务器下载？尝试连续两次将文件保存到同一个（但另一个）目录，并查看第二次尝试是否获得更高的下载率。

# deployment - 使用 CrmDeploymentService 的供应问题

> ID：80550
> 
> 赞同：0
> 
> 时间：2008-09-17T06:31:49.587
> 
> 标签：deployment, dynamics-crm-4

我已经为一个组织工作了好几天，并且遇到了一些我成功解决的问题。让我解释一下我面临的问题，MSCrmServices 是一个在网络服务下运行的进程. 当我从控制台应用程序调用服务的“执行”方法时，所有执行的操作都在“网络服务”帐户的上下文中运行。网络服务帐户没有足够的权限来创建组织，因此在操作过程中会出现很多问题。

*   不允许访问注册表。
*   不是正确的 SQL Server 权限
*   没有足够的广告权限。
*   ...

模拟不起作用，服务使用进程帐户执行操作。唯一可行的方法是以具有部署管理员权限（通过部署管理器工具添加）的管理员身份运行 CRMAppPool 身份。但是 CRM 部署中的这个问题似乎并没有引起我的注意 :(。现在我在将池身份更改为系统管理员后遇到了一个新问题，部署服务给出了一个错误，说 Unauthorized!!!! 当我检查记录它说..

> 进程：w3wp |组织：00000000-0000-0000-0000-000000000000 |线程：1 |类别：异常 |用户：00000000-0000-0000-0000-000000000000 |级别：错误 | CrmException..ctor
> 
> 在 CrmException..ctor（字符串消息，异常 innerException，Int32 错误代码，布尔 isFlowControlException，布尔 enableTrace）
> 
> 在 CrmException..ctor（字符串消息，Int32 错误代码）
> 
> 在 CrmObjectNotFoundException..ctor(BusinessEntityMoniker moniker)
> 
> 在 BusinessProcessObject.DoRetrievePublishableSingle（BusinessEntityMoniker moniker，EntityExpression entityExpression，布尔 includeUnpublished，ExecutionContext 上下文）
> 
> 在 BusinessProcessObject.RetrieveUnpublished（BusinessEntityMoniker moniker，EntityExpression entityExpression，ExecutionContext 上下文）
> 
> 在 OrganizationUIService.RetrieveUnpublished（BusinessEntityMoniker 绰号，EntityExpression entityExpression，ExecutionContext 上下文）
> 
> 在 OrganizationUIService.RetrieveOldFormXml（BusinessEntityMoniker 名字对象，ExecutionContext 上下文）
> 
> 在 OrganizationUIService.ExtractAndSaveFormLabels（IBusinessEntity 实体，ExecutionContext 上下文）
> 
> 在 OrganizationUIService.Create（IBusinessEntity 实体，ExecutionContext 上下文）
> 
> 在 ImportFormXmlHandler.createOrgUI(OrganizationUIService orgUIService, XmlNode formNode)
> 
> 在 ImportFormXmlHandler.ImportItem()
> 
> 在 ImportHandler.Import()
> 
> 在 ImportHandler.Import()
> 
> 在 RootImportHandler.RunImport()
> 
> 在 ImportXml.RunImport()
> 
> 在 NewOrgUtility.OrganizationImportDefaultData（Guid 组织 ID，版本 existingDatabaseVersion，字符串 importFile）
> 
> 在 NewOrgUtility.OrganizationImportDefaultData（Guid 组织 ID，字符串 importFile）
> 
> 在 NewOrgUtility.ConfigureOrganization（字符串组织 ID，字符串组织名称，字符串 userAccountName，字符串 userFirstName，字符串 userLastName，字符串 userEmail，字符串 languageCode，字符串 privilegedUserGroup，字符串 sqlAccessGroup，字符串 userGroup，字符串 reportingGroup，字符串 privilegedReportingGroup，布尔 grantNetworkServiceAccess，布尔 autoGroupManagement，字符串 importFileLocation，布尔 sqmOption)
> 
> 在 CreateOrganizationInstaller.Create（Guid 组织 ID，字符串 organizationUniqueName，字符串组织友好名称，字符串 baseCurrencyCode，字符串 baseCurrencyName，字符串 baseCurrencySymbol，字符串 initialUserDomainName，字符串 initialUserFirstName，字符串 initialUserLastName，字符串 sqlServerName，Uri reportServerUrl，字符串 privilegedUserGroupName，字符串 sqlAccessGroupName，字符串 userGroupName，字符串报告组名， String privilegedReportingGroupName, String applicationPath, String languageId, Boolean sqmOption, String organizationCollat​​ion, MultipleTenancy multipleTenancy)
> 
> 在 CreateOrganizationInstaller.Create(ICreateOrganizationInfo 组织信息)
> 
> 在 OrganizationService.Create(DeploymentEntity 实体)
> 
> 在 CreateRequest.Process()
> 
> 在 CrmDeploymentService.Execute（DeploymentServiceRequest 请求）
> 
> 在 RuntimeMethodHandle._InvokeMethodFast（对象目标，Object[] 参数，SignatureStruct& sig，MethodAttributes methodAttributes，RuntimeTypeHandle typeOwner）
> 
> 在 RuntimeMethodHandle.InvokeMethodFast（对象目标，对象 [] 参数，签名 sig，MethodAttributes 方法属性，RuntimeTypeHandle typeOwner）
> 
> 在 RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] 参数, CultureInfo 文化, Boolean skipVisibilityChecks)
> 
> 在 RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] 参数, CultureInfo 文化)
> 
> 在 LogicalMethodInfo.Invoke（对象目标，对象 [] 值）
> 
> 在 WebServiceHandler.Invoke()
> 
> 在 WebServiceHandler.CoreProcessRequest()
> 
> 在 SyncSessionlessHandler.ProcessRequest（HttpContext 上下文）
> 
> 在 CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
> 
> 在 HttpApplication.ExecuteStep(IExecutionStep 步骤，Boolean& completedSynchronously)
> 
> 在 ApplicationStepManager.ResumeSteps（异常错误）
> 
> 在 HttpApplication.System.Web.IHttpAsyncHandler.BeginProcessRequest（HttpContext 上下文，AsyncCallback cb，对象 extraData）
> 
> 在 HttpRuntime.ProcessRequestInternal(HttpWorkerRequest WR)
> 
> 在 HttpRuntime.ProcessRequestNoDemand(HttpWorkerRequest WR)
> 
> 在 ISAPIRuntime.ProcessRequest（IntPtr ecb，Int32 iWRType）

对此有任何想法。

有没有人遇到过这样的问题。我一直在努力解决这个问题，但运气不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T02:52:04.537

编辑：其实你并不孤单。

[http://www.eggheadcafe.com/software/aspnet/31450420/crmdeploymentservice-crm.aspx](http://www.eggheadcafe.com/software/aspnet/31450420/crmdeploymentservice-crm.aspx)

希望有帮助。

# filesystems - 网络托管网站的文件存储策略

> ID：80561
> 
> 赞同：0
> 
> 时间：2008-09-17T06:34:46.943
> 
> 标签：filesystems

我将托管用户提交的文件。我需要从文件中获取一些数据，然后将其移动到某个目录。

此文件的生命周期有两个兴趣点。第一个是数据被抽象化的时候，第二个是文件被归档以便可以共享的时候。

当数据被抽象时，我认为将文件重命名为唯一的文件或将唯一的字符串附加到文件名以防止它覆盖其他现有文件。

当文件要归档时，我想到了三种策略。一种是将从某个数据上传的所有文件保存在一个文件夹中。(2006/sept/04, 2008/jan/05) 另一种方法是保留一个文件夹并继续填充它，直到我想保留在文件夹中的文件达到最大数量，然后再创建一个（/folder001/、/folder002/、 /folder003/ 等）。另一种方法是在达到某个阈值时创建子文件夹。所以就像 (/j/jd/jde/jdelator) 我在 unix 中看到过这个，不知道如何解释。

我的问题是你们发现有用或使用过什么样的策略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T09:17:17.147

当数据被抽象时，我会选择这样的东西：`filename + millisec();` 两次对毫秒的调用不太可能相同，并且文件名在访问时更加用户友好。

如果您决定删除旧的和未使用的文件，日期策略可能会很方便：您只需要获取 2006 文件夹，并根据您的日志删除去年未访问的所有文件。这对您的用户来说也是一个很好的指示，因为他们会知道它是否是一个新文件。folderXYZ 只是这个的一个变种，用每个 N 个文件的标签替换 date。

阈值子文件夹可帮助您将目录的条目数保持在较低水平，因此访问速度更快。请注意，此解决方案有时需要在特定目录增长时移动文件（如果未映射，则破坏某些 url）。

另一种可能性是使用与文件名位置对应的 UID 的数据库，并通过[http://server.com/UID/filename.txt](http://server.com/UID/filename.txt)访问文件。这样，用户将文件保存为“filename.txt”，这对他来说很方便，并且您可以通过 URL 知道在哪里找到文件（使用 DB 将 UID 转换为位置）。请注意，UID 可以是校验和（MD5、SHA-1）来处理同一文件的重复项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T07:01:50.263

我会在数据库中使用 guid 进行投票，然后在必要时使用 Content-Disposition 标头将其命名回原始文件名。我要提倡的一件事是，您使用的文件夹存储在 Web 根目录之外；您不希望用户将文件上传到您的应用程序文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T06:38:37.403

我使用了一个关系数据库，它将 ID（int）标记为文件名 uuid。这样，它们在磁盘上的位置就无关紧要了。它可以帮助我混淆文件。此外，我可以使用 JOIN 任意“重命名”文件。此外，我可以使用不同的文件“名称”。这完全取决于您的应用程序及其运行位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T06:52:35.717

虽然这取决于您的应用程序等，但我建议暂时保持文件存储库方案非常简单，稍后再决定更详细的策略。换句话说，你制造了一段时间的“管理混乱”；结构和策略稍后会出现，当您会发现所有需求和领域细节时。通过保持简单，您可以轻松更改所有内容。

无论如何，改变是不可避免的，你现在能做的最好的事情就是选择**一些策略**并记录一切。

# linux - 对于 Linux 系统有 gdb 的替代品吗？

> ID：80563
> 
> 赞同：20
> 
> 时间：2008-09-17T06:35:49.907
> 
> 标签：linux, gdb, debugging

请考虑商业和免费调试器。还想看看每个人的利弊。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T18:54:32.070

我真的很喜欢[EDB（Evan 的调试器）](http://freshmeat.sourceforge.net/projects/edebugger/)。

它有一种很好的“OllyDBG 感觉”，这很棒，因为当我还在 Windows 平台上工作时，我经常使用它。

> EDB（Evan's Debugger）是一个基于 QT4 的二进制模式调试器，其目标是具有与 OllyDbg 同等的可用性。它使用插件架构，因此可以轻松添加新功能。当前版本适用于 Linux，但未来版本将针对更多平台。

[![](https://i.stack.imgur.com/HR0Wq.png)](https://i.stack.imgur.com/HR0Wq.png)
[（来源：[softpedia.com](http://www.softpedia.com/screenshots/thumbs/EDB-Evan-s-Debugger-19734-thumb.png)）]

（可点击）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T07:23:34.393

nemiver 是 gdb 的一个很好的前端（看起来比 ddd imo 更好，尽管它可能还没有那么先进）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-31T19:13:48.353

在 Linux 上，大多数调试都是通过 GDB 处理的。然而，正如其他人所提到的，没有必要直接使用 GDB。存在多种选择，其中一些在以前的答案中提到：

*   Emacs（有一个 GDB 前端）
*   DDD（基于 Motif 的、有点古怪的图形界面，具有出色的数据检查功能）
*   Nemiver（基于 GTK 的前端）
*   蚀
*   代码::块
*   NetBeans 也可以做到
*   Anjuta（侏儒 IDE）

其中，我使用过 DDD 并尝试过 Nemiver。当时，Nemiver 缺乏功能，因此对我来说效果不佳。不过那是两年前的事了。我经常使用 DDD，发现它的数据查看非常好，值得使用它的 UI。不过，我也经常只从命令行使用 gdb。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T08:20:49.700

emacs 也有一个很棒的 gdb 前端。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T06:42:12.590

我自己没有使用过它，所以我无法评论它的优点/缺点，但一种商业替代品是[TotalView](http://www.roguewave.com/products/totalview.aspx)。

还有[DDD](http://www.gnu.org/software/ddd/)可以为您提供 GDB 的前端，但我想您已经尝试/使用过它？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-02-25T15:46:15.687

Sun `dbx`Studio 的 Sun 也可以在 Linux 中工作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T06:49:02.150

[零错误](http://www.zerobugs.org/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-17T06:52:10.520

对于调试汇编代码，有[ALD](http://ald.sourceforge.net/)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T06:59:08.103

在这里走上一个台阶，但如果你愿意的话，Sun 的 MDB 非常棒，尤其是在你使用大量模板和线程代码的情况下。如果这是您的情况，它会击败 GDB。另一方面，如果您只需要断点，那就不是很好了，在这种情况下我会坚持使用 GDB。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T06:43:30.387

`UndoDB`听起来很有趣，但是它允许“反向步进”；它很贵，而且我很适应`gdb`，所以我不太可能改变。我见过的其他人没有吸引我远离我所知道的环境所需的额外功能。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-12-19T14:34:23.203

没有提到的 GDB 的一个很好的前端是[Insight](http://sourceware.org/insight/)。

# visual-studio - Visual Studio：遇到断点时如何触发警报？

> ID：80564
> 
> 赞同：42
> 
> 时间：2008-09-17T06:36:09.750
> 
> 标签：visual-studio, breakpoints

当我的断点被击中时，有没有办法触发哔声/警报/声音？我正在使用 Visual Studio 2005/2008。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-09-17T06:42:14.413

### 视窗

控制面板 -> 声音和音频... -> 程序事件 - Microsoft 开发人员 -> 断点命中

### Windows 7的

控制面板 -> 所有控制面板项目 -> 声音 -> 声音（选项卡） - Microsoft Visual Studio -> 断点命中

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T07:15:05.397

是的，您可以使用分配给断点的宏来完成。这适用于 VS 2005，我认为 2008 也可以。我假设您不希望在每个断点上都有声音，否则其他答案会正常工作。可能有一种方法可以播放特定的声音，但我没有那么努力。以下是基本步骤：

**添加新的宏模块**（代码下方的步骤）

```
Imports System.Runtime.InteropServices
Public Module Beeps
    Public Sub WindowsBeep()
        Interaction.Beep()
    End Sub
    Public Sub ForceBeep()
        Beep(900, 300)
    End Sub
    <DllImport("Kernel32.dll")> _
    Private Function Beep(ByVal frequency As UInt32, ByVal duration As UInt32) As Boolean
    End Function
End Module 
```

1.  工具 => 宏 => 宏 IDE
2.  我的宏（在项目资源管理器中）=> 添加新模块 => 名称：“Beeps”
3.  复制上面的代码。它有2个方法
    1.  第一个使用窗户“哔”声
    2.  第二个强制“哔”声，而不是 .wav 文件。这适用于禁用所有声音（例如控制面板 -> 声音 -> 声音方案：无声音），但听起来很难看。
4.  在 VS.Net（不是宏 IDE）中查看宏资源管理器以确保它存在 :)

**分配给断点**

1.  在行中添加断点
2.  右键点击小红点
3.  选择“击中时”
4.  选中该框以启用宏
5.  从下拉列表中选择您的宏
6.  **如果要停止，请**取消选中“继续执行”。**默认选中。**

 **此外，还有*一些*方法可以播放任意 wav 文件，但这对于警报来说似乎太过分了。也许强制“哔”是最好的，因为这至少*听起来*与丁不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T06:41:41.200

您可以创建一个响应断点触发而运行的宏。在你的宏中，你可以做任何事情来发出哔哔声。

# java - 方法局部内部类

> ID：80592
> 
> 赞同：2
> 
> 时间：2008-09-17T06:44:10.743
> 
> 标签：java, inner-classes, method-invocation

```
public class Test {
    public static void main(String[] args) {

    }
}

class Outer {
    void aMethod() {
        class MethodLocalInner {
            void bMethod() {
                System.out.println("Inside method-local bMethod");
            }
        }
    }
} 
```

有人可以告诉我如何打印消息`bMethod`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T06:51:26.840

您只能`MethodLocalInner`在`aMethod`. 也一样

```
void aMethod() {

    class MethodLocalInner {

            void bMethod() {

                    System.out.println("Inside method-local bMethod");
            }
    }

    MethodLocalInner foo = new MethodLocalInner(); // Default Constructor
    foo.bMethod();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T06:51:29.417

*在类MethodLocalInner*声明之后的方法*aMethod*中，您可以例如执行以下调用：

 *```
new MethodLocalInner().bMethod(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T06:52:36.777

为什么不直接创建`MethodLocalInner`、 in的实例`aMethod`并调用`bMethod`新实例？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-10T10:07:37.360

您需要在 main 方法中调用 new Outer().aMethod() 。您还需要在 aMethod() 中添加对 MethodLocalInner().bMethod() 的引用，如下所示：

```
public class Test {
    public static void main(String[] args) {
        new Outer().aMethod();
    }
}

void aMethod() {
    class MethodLocalInner {
        void bMethod() {
            System.out.println("Inside method-local bMethod");
        }
    }
    new MethodLocalInner().bMethod();
} 
```

# c# - 在 FlowDocument 中启用嵌入式控件

> ID：80593
> 
> 赞同：4
> 
> 时间：2008-09-17T06:44:45.610
> 
> 标签：c#, .net, wpf, .net-3.5

我在标准 WPF 应用程序窗口中有一个 FlowDocument，其中有一些文本，并且在此文本中有一些超链接和按钮。

问题是，如果我将此 FlowDocument 放在 FlowDocumentPageViewer 以外的任何内容中，[则](http://msdn.microsoft.com/en-us/library/system.windows.controls.flowdocumentpageviewer.aspx)**超**链接和按钮将被禁用（“灰显”）。

```
<FlowDocumentScrollViewer>
  <FlowDocument>
      <Paragraph>
        Hello, World!
        <Hyperlink NavigateUri="some-uri">click me</Hyperlink>
        <Button Click="myButton_Click" Content="Click me too!" />
      </Paragraph>
  </FlowDocument>
</FlowDocumentScrollViewer> 
```

以上将起作用，并且链接将是可点击的。但是，我不想要完整的页面查看器，因为它会显示导航按钮（后退/前进）缩放，并且它还有一个奇怪的列行为。

我希望它在一个简单的[FlowDocumentScrollViewer](http://msdn.microsoft.com/en-us/library/system.windows.controls.flowdocumentscrollviewer.aspx)中（或任何其他只显示文本而没有额外模糊的东西）。

**编辑：** 问题不仅在于超链接。*如果 FlowDocument 位于 FlowDocumentScrollViewer 内，则任何*控件，如 Button、ListBox、ComboBox（用户可以与之交互的任何内容）都将“灰显”，无论 IsEnabled 属性如何。

**EDIT2：** 好吧，这一定是我的错误或什么，因为我最终重写了控件，现在它可以工作了。我猜如果 IsEnabled=False 在视觉树的某处导致了这种情况，我想有某种原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T15:59:17.770

我正在为我的 about 框使用 FlowDocumentScrollViewer：

```
<FlowDocumentScrollViewer VerticalScrollBarVisibility="Auto">
    <FlowDocument>
        <Paragraph>
            <!-- ... --> 
```

我没有你提到的任何控制或问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T07:19:24.637

我想知道你是否期待这样的事情？

```
<TextBlock>
<Hyperlink>
    <Run Text="Test link"/>
</Hyperlink > 
```

```
</TextBlock> 
```

# gcc - 使用 gcc 时跳过了 scanf()（和 cin）语句

> ID：80601
> 
> 赞同：2
> 
> 时间：2008-09-17T06:47:29.393
> 
> 标签：gcc, scanf

当代码中遇到多个`scanf()`语句时，除了第一个语句外，其他所有语句都被跳过，即在代码运行时`scanf()`不会提示输入这些语句。`scanf()`

我尝试了一些建议。例如，`flushall()`在某些站点上建议使用 of，但这会导致编译错误。

非常感谢任何帮助。

[代码作为[答案](https://stackoverflow.com/a/2787189/256431)添加。]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T07:18:49.083

检查scanf()的返回值！

从手册页中：“scanf 返回分配的输入项的数量，如果匹配失败，它可以少于提供的数量，甚至为零。零表示，虽然有可用的输入，但没有分配转换；这通常是由于输入字符无效，例如用于 '%d' 转换的字母字符。如果在任何转换（例如文件结束）之前发生输入失败，则返回值 EOF。如果出现错误或文件结束在转换开始后发生，返回成功完成的转换次数。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:00:17.310

**代码和**输入的示例肯定会提高我们帮助您解决特定问题的能力，因为有很多可能导致问题的潜在情况。

示例（我能很快想到）：

*   格式字符串与输入流中的下一个字符不匹配。scanf 因此没有读取任何内容。
*   仅当遇到 full 或 return 时才会刷新 stdin 输入缓冲区。

*   来自 1 行输入的输入可能被多个 scanf 语句使用。随后的 scanf 语句从最后一个离开的地方开始。因此程序不会因用户输入而停止。
*   %s 在 scanf 和 printf printf 上的行为不同，
    它会打印整个字符串。
    scanf 它读取**一个**空格分隔的单词

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T06:52:50.003

我一直认为 scanf() 很危险，因为它会使您的输入流处于不确定状态。

我更喜欢使用其他（更安全的）命令来引入字符串（fgets 等），然后使用 sscanf 来处理它。然后您可以随时备份到字符串的开头并重新启动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T06:56:32.820

这听起来像是一些转换问题。可能是 %s 转换永远不会结束，或者您指定了一个永远不会输入的字符或类似的东西。我建议如下：尝试类似： int a=0; 诠释 b = 0; scanf("%d", &a); scanf("%d", &b); printf("a=%d, b=%d\n", a, b); 如果这可行，请尝试增加转换，以查看导致问题的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-14T19:07:06.007

总是在任何 "scanf();" 之前使用 ""fflush(stdin);"" 语句，因为除非和直到你不清除标准输入流 scanf 语句将读取 std i/p 中已经存在的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-07T08:27:31.847

代码很简单，因为它是：

```
#include <stdio.h>
int main()
{
long int z,s,n,i,j,m,x;
scanf("%ld ",&z);
for(i=0; i<z; i++)
  {
  scanf("%ld",&s); n=0;
  for (j=0; j<s; j++) { scanf("%ld",&m); n+=m; }
  x=n+s-1;
  printf("%ld\n",n);
  }
return 0;
} 
```

汇编：

```
D:\edycja>gcc WSEGA.c -o WSEGA.exe -Wall

D:\edycja>WSEGA.exe

D:\edycja> [Where was the program!?] 
```

# xml - 合并 XML 文档

> ID：80609
> 
> 赞同：21
> 
> 时间：2008-09-17T06:50:01.667
> 
> 标签：xml

我需要“合并”两个 XML 文档，覆盖重叠的属性和元素。例如，如果我有**document1**：

```
<mapping>
    <key value="assigned">
        <a/>
    </key>
    <whatever attribute="x">
        <k/>
        <j/>
    </whatever>
</mapping> 
```

和**文件2**：

```
<mapping>
    <key value="identity">
        <a/>
        <b/>
    </key>
</mapping> 
```

我想像这样合并两者：

```
<mapping>
    <key value="identity">
        <a/>
        <b/>
    </key>
    <whatever attribute="x">
        <k/>
        <j/>
    </whatever>
</mapping> 
```

我更喜欢**基于 Java**或**XSLT**的解决方案，**ant会做得很好，但如果在****Rake**、**Ruby**或**Python**中有一种简单的方法可以做到这一点，请不要害羞:-)

**编辑：**实际上我发现我宁愿使用自动化工具/脚本，甚至[自己编写](http://web.archive.org/web/20100818203850/http://stackoverflow.com:80/questions/58640/great-programming-quotes)，因为手动合并大约 30 个 XML 文件有点笨拙...... :-(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T12:26:26.977

如果你喜欢 XSLT，我以前使用过一个不错的合并脚本： [Oliver 的 XSLT 页面](http://web.archive.org/web/20160809092524/http://www2.informatik.hu-berlin.de/~obecker/XSLT/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-21T09:41:51.240

我知道这是一个旧线程，但[Project: Merge](http://www.projectmerge.com)可以为您做到这一点。它可以将两个 XML 文件合并在一起，并且可以从命令行运行，因此您可以将所有内容批处理在一起，运行它并手动解决任何冲突（例如在上面的示例中更改 'key' 的属性值）点击几下。（如果没有冲突，您可以让它静默运行。）

它可以执行 XML 文件的双向和三向比较以及双向和三向合并。（三向操作假设被比较/合并的两个文件有一个共同的祖先。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-02T20:54:30.970

检查[XmlCombiner](https://github.com/atteo/xml-combiner)，它是一个以这种方式实现 XML 合并的 Java 库。它松散地基于[plexus-utils](https://github.com/codehaus-plexus/plexus-utils/blob/master/src/main/java/org/codehaus/plexus/util/xml/Xpp3DomUtils.java)库提供的类似功能。

XmlCombiner 默认约定是覆盖重叠的属性和元素。[但是可以使用特殊的“combine.self”和“combine.children”](https://github.com/atteo/xml-combiner#controlling-the-merging-behavior)属性来改变确切的合并行为。

用法：

```
import org.atteo.xmlcombiner.XmlCombiner;

// create combiner
XmlCombiner combiner = new XmlCombiner();
// combine files
combiner.combine(firstFile);
combiner.combine(secondFile);
// store the result
combiner.buildDocument(resultFile); 
```

免责声明：我是作者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T06:58:32.567

不确定是否要以编程方式执行此操作。

编辑：啊，我在编辑之前发布了。我现在看起来不像个白痴！;)

如果您只想将两个文件合并在一起，IBM 有一个[XML Diff and Merge Tool](http://www.alphaworks.ibm.com/tech/xmldiffmerge)，还有 Altova 的[DiffDog](http://www.altova.com/products/diffdog/diff_merge_tool.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-31T22:19:35.810

（也使用[Oliver 的 XSLT 样式表](http://web.archive.org/web/20160809092524/http://www2.informatik.hu-berlin.de/~obecker/XSLT/)）

来自 PowerShell 的 XSLT 合并：

```
param(
[Parameter(Mandatory = $True)][string]$file1,
[Parameter(Mandatory = $True)][string]$file2,
[Parameter(Mandatory = $True)][string]$path
)

# using only abs paths .. just to be safe
$file1 = Join-Path $(Get-Location) $file1
$file2 = Join-Path $(Get-Location) $file2
$path = Join-Path $(Get-Location) $path

# awesome xsl stylesheet from Oliver Becker
# http://web.archive.org/web/20160502194427/http://www2.informatik.hu-berlin.de/~obecker/XSLT/merge/merge.xslt
$xsltfile = Join-Path $(Get-Location) "merge.xslt"

$XsltSettings = New-Object System.Xml.Xsl.XsltSettings
$XsltSettings.EnableDocumentFunction = 1

$xslt = New-Object System.Xml.Xsl.XslCompiledTransform;
$xslt.Load($xsltfile , $XsltSettings, $(New-Object System.Xml.XmlUrlResolver))

[System.Xml.Xsl.XsltArgumentList]$al = [System.Xml.Xsl.XsltArgumentList]::new()
$al.AddParam("with", "", $file2)
$al.AddParam("replace", "", "true")

[System.Xml.XmlWriter]$xmlwriter = [System.Xml.XmlWriter]::Create($path)
$xslt.Transform($file1, $al, $xmlwriter) 
```

使用“plain ol”撒克逊语：

```
java -jar saxon9he.jar .\FileA.xml .\merge.xslt with=FileB.xml replace=true 
```

# perl - 在 shell / Perl 脚本中保存密码的最佳实践？

> ID：80612
> 
> 赞同：11
> 
> 时间：2008-09-17T06:50:46.000
> 
> 标签：perl, oracle, bash, ksh

我最近不得不重新学习我的 Perl 和 shell 脚本技能来帮助一些同事。有问题的同事的任务是提供来自具有大型 Oracle 数据库后端的内部应用程序的一些报告，但他们根本不具备执行此操作的技能。虽然有些人可能会质疑我是否也有这些技能（咧嘴笑），但显然有足够多的人认为我这样做意味着我无法摆脱它。

所以对于我的问题 - 为了从数据库中提取报告，我的脚本显然必须连接并运行查询。到目前为止，我还没有想出一个好的解决方案来存储数据库的用户名和密码，因此它目前在脚本中以纯文本形式存储。

有没有其他人已经写过的很好的解决方案，也许是一个 CPAN 模块？或者还有其他更好的方法 - 比如将用户/密码组合保存在一个完全独立的文件中，该文件隐藏在文件系统的其他地方？或者我应该对它们进行简单的加密，以避免使用系统范围的 grep 将它们从我的脚本中拉出来？

编辑：Oracle 数据库位于 HP-UX 服务器上。
应用程序服务器（运行 shell 脚本）是 Solaris。
将脚本设置为仅由我拥有是不行的，它们必须由多个支持人员可以访问的服务帐户拥有。
这些脚本旨在作为 cron 作业运行。
我很想使用公钥身份验证，但我不知道使用 Oracle 进行验证的方法——如果有这样的方法——请赐教！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T06:55:10.030

恕我直言，最佳做法是不在 shell / Perl 脚本中保存任何密码。这就是公钥认证的用途。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T07:07:16.693

如果脚本从服务器远程运行。

1.  制作您的报告视图
2.  授予您正在登录的用户仅访问以在报告视图上进行选择的权限
3.  只需存储密码。

这样，用户所能做的就是为其报告选择数据。即使有人碰巧得到了密码，他们也将受到限制，他们可以用它做什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T12:58:16.257

我个人将密码保存在配置文件中，然后独立于应用程序分发，并且可以更改为特定的机器/环境。在 shell 脚本中，您可以在主脚本中获取这些资源。

然而，在 Perl 中有多种方法。您可能希望调查[Getopt::Long](http://search.cpan.org/perldoc?Getopt::Long)以获取命令行选项（另外还有[Getopt::ArgvFile](http://search.cpan.org/perldoc?Getopt::ArgvFile)以将它们存储在一个简单的配置文件中），或者查看类似[Config::IniFiles 之类](http://search.cpan.org/perldoc?Config::IniFiles)的东西以获取更多功能。这是我通常使用的两种类型，但还有其他配置文件模块可用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T06:53:38.363

没有好的解决办法。您可以稍微混淆密码，但无法保护它们。

如果您可以控制您的数据库设置，您可以尝试通过命名管道（至少 mysql 支持）连接而不使用密码，并让操作系统处理权限。

您还可以将凭据存储在具有限制权限的文件中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T06:57:09.557

既然你已经标记了 ksh 和 bash，我将假设 Linux。

大多数问题是，如果用户可以阅读脚本并找到您用来隐藏/加密文件的方法，那么他们也可以手动执行相同的操作。

更好的方法可能是执行以下操作：

1.  制作您的脚本，使其只能由您查看/阅读/打开。chmod 700 吧。硬编码密码。
2.  拥有一个可由用户执行并执行 sudo 的“启动器”脚本。

通过这种方式，用户可以看到您的启动器脚本，检查它以查看它只有一个命令行。他们可以运行它并且它可以工作，但他们无权读取 sudo 脚本的源代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T09:19:50.043

我不确定您运行的是什么版本的 Oracle。在旧版本的 Oracle（9i 之前的高级安全性）上，一些 DBA 会`CREATE USER OPS$SCOTT IDENTIFIED BY EXTERNALLY`设置`REMOTE_OS_AUTHENT`为 true。

这意味着您的远程 sun 机器可以将您身份验证为 SCOTT，然后您的 Oracle DB 将接受该身份验证。

**这是一个坏主意。**

正如您可以使用 SCOTT 的本地用户映像任何 Windows XP 一样，然后可以在没有密码的情况下登录到您的数据库。

不幸的是，这是我所知道的 Oracle 9i DB 的唯一选择，即不在您的脚本或客户端计算机可访问的其他地方存储用户名/密码。

无论您的解决方案是什么，都值得在提交之前查看一下 Oracle 的[Project Lockdown 。](http://www.oracle.com/technology/pub/articles/project_lockdown/project-lockdown.pdf)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T16:22:55.767

对于存储密码，您可以执行两步加密例程，首先在脚本本身中使用硬编码密钥，然后可以选择第二次使用存储在文件中的密钥（使用文件权限设置以具有受限访问权限）。

在给定的情况下，您可以使用密钥文件（+ 脚本中的密钥），或者如果情况要求不是很好，他可以使用在脚本中硬编码的密钥使用加密。在这两种情况下，密码都将在配置文件中加密。

没有完美的解决方案，因为您必须以某种方式解密并获得明文密码……如果您能做到，其他人也可以，如果他们有正确的信息。

尤其是在我们给他们一个 perl 脚本（相对于 exe）的情况下，他们可以很容易地看到你是如何进行加密的（以及硬编码的密钥）......这就是为什么你应该允许选择使用密钥文件（可以也受文件系统权限的保护）。

如何实现的一些实际示例是[here](http://www.perl.com/pub/a/2001/07/10/crypto.html "这里。")

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T06:57:56.123

在 UNIX 中，我总是将这些脚本设置为 setuid，并将用户和密码信息存储在一个受到严格保护的文件中（整个目录树对于普通用户来说是不可读/不可搜索的，并且文件本身只能由脚本的所有者读取） .

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T07:01:32.700

将它们保存在单独的文件中，经过简单加密，并在数据库中创建一个单独的用户，对必要的表具有只读访问权限。如果您认为该文件已被读取，那么您可以关闭对该用户的访问。

如果你想变得花哨，SUID 程序可以检查 /proc//exe 和 cmdline（在 Linux 中），然后才释放用户名。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T11:15:07.877

我有一个类似的问题，开发人员使用 Solaris 服务器上的 ANT 将 SQL 代码部署到 MSSQL（实际上是该 MSSQL 服务器上的任何数据库，因此角色必须是 SysAdmin）。同样，我不想将用户名和密码存储在 ANT build.xml 文件中，所以我知道不理想的解决方案如下：

1.  将用户名和密码的名称/值对存储在纯文本文件中
2.  加密文件（在 Solaris 上）并使用只有某些管理员知道的密码短语
3.  在 Solaris 系统上只保留加密文件
4.  ANT build.xml 运行 sudo 解密并提示输入密码，由管理员输入
5.  ANT 源解密文件加载用户名和密码作为 SQL 字符串的变量
6.  ANT立即删除了明文文件
7.  ANT 部署代码并退出

这一切都在几秒钟内发生，并且在服务器上永远无法看到 sql 用户名和密码。由于代码是由允许的管理员在生产环境中部署的，因此开发人员永远不需要将其包含在他们的代码中。

我相信它可能会更好，但是...

JB

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-12T21:31:38.803

很遗憾我以前从未见过这个帖子——它看起来很有趣。我会为将来出现在该线程上的任何人加两分钱。

我建议在数据库服务器本身上使用操作系统身份验证——REMOTE_OS_AUTHENT 仍然是 FALSE。

如果您从另一台机器调用脚本，请设置无短语 SSH 密钥并使用 SSH 到达那里。然后，您可以将 SQL 结果通过管道传回调用机器，它可以进一步处理此信息。

这样做可以避免在任何地方编写密码。当然，如果恶意管理员劫持了无短语密钥并使用它，他或她也可以访问数据库主机上的用户帐户，然后可以执行操作系统认证的数据库用户可以执行的任何操作。为了缓解这种情况，您可以将该操作系统用户的数据库权限降低到最低限度——让我们说“只读”。

英戈

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-14T10:21:23.800

> 在 Windows 上创建一个文件夹和一个文件，其中包含明文密码。将运行计划作业（脚本或批处理）的用户设置为对该文件夹和文件具有读/写访问权限的唯一人员。（甚至删除管理员）。对于所有其他脚本，添加代码以从此受限文件中读取明文密码。

这对少数人来说应该足够了。

关键字：密码硬编码

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-20T22:34:49.467

有商业或更先进的解决方案，例如cyberark AIM，可以做得更好，但是免费且开箱即用，我一直捎带SSH公钥/私钥，因为首先，很可能已经创建的SSH密钥对符合安全政策；其次，SSH 密钥对已经有一套标准协议，通过文件权限、持续系统强化（如tripwire）或密钥轮换来保护密钥。

我是这样做的：

1.  如果尚未生成 ssh 密钥对。默认系统协议/权限将保护密钥对和目录。ssh-keygen –t rsa –b 2048

2.  使用 ssh 公钥加密字符串并存储在同一个 .ssh 目录中 $ echo "secretword" | openssl rsautl -encrypt -inkey ~/.ssh/id_rsa.pub -pubin -out ~/.ssh/secret.dat

3.  使用 ssh 私钥对密钥进行解密，并将参数实时传递给脚本/AP。包含要实时解密的行的脚本/程序：string=`openssl rsautl -decrypt -inkey ~/.ssh/id_rsa -in ~/.ssh/secret.dat`

PS - 我一直在尝试 CYBERARK AIM 无代理解决方案。这是一种痛苦，需要对 API/脚本进行重大更改/API 更改。将让您随时了解情况。

# python - Python Twisted 中的异步编程

> ID：80617
> 
> 赞同：30
> 
> 时间：2008-09-17T06:51:35.750
> 
> 标签：python, asynchronous, twisted

我在 Twisted 中开发反向代理时遇到了麻烦。它有效，但似乎过于复杂和令人费解。很多感觉就像巫毒教一样。

网络上或书中是否有任何*简单、可靠的异步程序结构示例？*一种最佳实践指南？当我完成我的程序时，我希望仍然能够以某种方式看到结构，而不是看着一碗意大利面。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-09-17T09:29:45.977

Twisted 包含[大量示例](http://twistedmatrix.com/projects/core/documentation/howto/index.html)。尤其是[“Finger 的演变”教程](http://twistedmatrix.com/projects/core/documentation/howto/tutorial/intro.html)，其中包含对异步程序如何从非常小的内核发展到具有大量移动部件的复杂系统的详尽解释。您可能感兴趣的另一篇文章是关于简单[编写服务器](http://twistedmatrix.com/projects/core/documentation/howto/servers.html)的教程。

[关于 Twisted 甚至其他异步网络库（例如asyncore](http://www.python.org/doc/current/lib/module-asyncore.html)、[MINA](http://mina.apache.org/)或[ACE](http://www.cs.wustl.edu/~schmidt/ACE-overview.html) ）要记住的关键是，您的代码仅在发生某些事情时才会被调用。我最常听到的听起来像“巫毒”的部分是回调的管理：例如，`Deferred`. 如果您习惯于编写直线运行的代码，并且只调用立即返回结果的函数，那么等待某些东西回叫您的想法可能会令人困惑。但是没有什么神奇的，没有关于回调的“巫毒”。在最低级别，反应器只是坐在那里等待少数事情之一发生：

1.  数据通过连接到达（它将调用`dataReceived`协议）
2.  时间已经过去（它会调用一个用 注册的函数`callLater`）。
3.  已接受连接（它将调用使用or函数`buildProtocol`注册的工厂）。`listenXXX``connectXXX`
4.  连接已断开（它将调用`connectionLost`适当的协议）

每个异步程序都从连接其中一些事件开始，然后启动反应器以等待它们发生。当然，发生的事件会导致更多的连接或断开连接的事件，因此您的程序会继续愉快地进行。除此之外，异步程序结构并没有什么特别有趣或特别的地方。事件处理程序和回调只是对象，您的代码以通常的方式运行。

这是一个简单的“事件驱动引擎”，向您展示了这个过程是多么简单。

```
# Engine
import time
class SimplestReactor(object):
    def __init__(self):
        self.events = []
        self.stopped = False

    def do(self, something):
        self.events.append(something)

    def run(self):
        while not self.stopped:
            time.sleep(0.1)
            if self.events:
                thisTurn = self.events.pop(0)
                thisTurn()

    def stop(self):
        self.stopped = True

reactor = SimplestReactor()

# Application    
def thing1():
    print 'Doing thing 1'
    reactor.do(thing2)
    reactor.do(thing3)

def thing2():
    print 'Doing thing 2'

def thing3():
    print 'Doing thing 3: and stopping'
    reactor.stop()

reactor.do(thing1)
print 'Running'
reactor.run()
print 'Done!' 
```

在 Twisted 等库的核心，主循环中的函数不是`sleep`，而是一个操作系统调用，如`select()`or ，由[Python 选择模块之](http://docs.python.org/lib/module-select.html)`poll()`类的模块公开。我说“喜欢” ，因为这是一个在平台之间变化很大的 API，而且几乎每个 GUI 工具包都有自己的版本。Twisted 目前为这个主题的 14 种不同变体提供了一个抽象接口。这种 API 提供的共同点是提供一种方式来表示“这是我正在等待的事件列表。去睡觉直到其中一个发生，然后醒来告诉我它是其中一个。 "`select`

# c++ - C++ 中的“助手”函数

> ID：80619
> 
> 赞同：30
> 
> 时间：2008-09-17T06:52:06.857
> 
> 标签：c++, class, namespaces

在重构一些旧代码时，我删除了一些实际上应该是静态的公共方法，因为它们 a) 不对任何成员数据进行操作或调用任何其他成员函数，并且 b) 因为它们可能在其他地方证明是有用的。

这让我想到了将“帮助”功能组合在一起的最佳方式。Java/C# 方法是使用带有私有构造函数的静态函数类，例如：

```
class Helper  
{  
private:  
  Helper() { }
public:  
  static int HelperFunc1();  
  static int HelperFunc2();  
}; 
```

但是，作为 C++，您也可以使用命名空间：

```
namespace Helper  
{  
  int HelperFunc1();  
  int HelperFunc2();  
} 
```

在大多数情况下，我认为我更喜欢命名空间方法，但我想知道每种方法的优缺点是什么。例如，如果使用类方法，会有任何开销吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-09-17T06:57:30.913

开销不是问题，虽然命名空间有一些优势

*   您可以在另一个标头中重新打开命名空间，更合理地对事物进行分组，同时保持编译依赖性低
*   您可以使用命名空间别名来发挥自己的优势（调试/发布、特定于平台的帮助程序，......）

    例如，我做过类似的事情

    ```
    namespace LittleEndianHelper {
       void Function();
    }
    namespace BigEndianHelper {
       void Function();
    }

    #if powerpc
       namespace Helper = BigEndianHelper;
    #elif intel
       namespace Helper = LittleEndianHelper;
    #endif 
    ```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-18T00:40:24.930

可能使用`class`（或`struct`）over`namespace`的一种情况是需要一种类型，例如：

```
struct C {
  static int f() { return 33; }
};

namespace N {
  int f() { return 9; }
}

template<typename T>
int foo() {
  return T::f();
}

int main() {
  int ret = foo<C>();
//ret += foo<N>(); // compile error: N is a namespace
  return ret;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T07:30:11.477

为了增加 Pieter 的出色响应，名称空间的另一个优点是您可以转发声明您放在其他地方的名称空间中的东西，尤其是结构......

```
//Header a.h
// Lots of big header files, spreading throughout your code
class foo
{
  struct bar {/* ... */);
};

//header b.h
#include a.h // Required, no way around it, pulls in big headers
class b
{
  //...
  DoSomething(foo::bar);
}; 
```

并使用命名空间...

```
//Header a.h
// Big header files
namespace foo
{
  struct bar {/* ... */);
}

//header b.h
// Avoid include, instead forward declare 
//  (can put forward declares in a _fwd.h file)
namespace foo
{
  struct bar;
}

class b
{
  //...
  // note that foo:bar must be passed by reference or pointer
  void DoSomething(const foo::bar & o);
}; 
```

一旦您最终得到一个跨越数百个源文件的项目，前向声明会对您的编译时间产生很大的影响。

## 从 paercebal 编辑

答案太好了，不能因为枚举错误而死（见评论）。我用结构替换了枚举（只能在 C++0x 中前向声明，而不是在今天的 C++ 中）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T06:55:00.780

使用命名空间的主要优点是您可以稍后重新打开它并添加更多内容，而您不能使用类来做到这一点。这使得这种方法更适合松散耦合的帮助程序（例如，您可以为整个库拥有一个 Helpers 命名空间，就像所有 STL 都在 ::std 中一样）

类的主要优点是你可以将它嵌套在使用它的类中，你不能在类中嵌套命名空间。这使得这种方法更适合紧密耦合的助手。

将它们放在类与命名空间中不会有任何额外的开销。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T09:05:24.787

命名空间提供了 Koenig 查找的额外优势。使用辅助类可能会使您的代码更加冗长——您通常需要在调用中包含辅助类名称。

命名空间的另一个好处是以后的可读性。对于类，您需要包含诸如“Helper”之类的词，以便稍后提醒您特定类不用于创建对象

在实践中，两者都没有开销。编译后，只有使用的名称 mangling 不同。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T13:27:24.587

在创建辅助函数时，我倾向于使用匿名命名空间。因为它们应该（通常）只被关心它们的模块看到，所以它是控制依赖关系的好方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-20T14:30:07.397

复制/修剪/修改了我的答案的一部分，您 [如何在 C++ 中正确使用命名空间？](https://stackoverflow.com/questions/41590/how-do-you-properly-use-namespaces-in-c#81602).

## 使用“使用”

您可以使用“使用”来避免重复辅助函数的“前缀”。例如：

```
struct AAA
{
   void makeSomething() ;
} ;

namespace BBB
{
   void makeSomethingElse() ;
}

void willCompile()
{
   AAA::makeSomething() ;
   BBB::makeSomethingElse() ;
}

void willCompileAgain()
{
   using BBB ;

   makeSomethingElse() ; // This will call BBB::makeSomethingElse()
}

void WONT_COMPILE()
{
   using AAA ; // ERROR : Won't compile

   makeSomething() ; // ERROR : Won't compile
} 
```

## 命名空间组合

命名空间不仅仅是包。另一个例子可以在 Bjarne Stroustrup 的“The C++ Programming Language”中找到。

在“特别版”的**8.2.8 Namespace Composition**中，他描述了如何将两个命名空间 AAA 和 BBB 合并到另一个名为 CCC 的命名空间中。因此 CCC 成为 AAA 和 BBB 的别名：

```
namespace AAA
{
   void doSomething() ;
}

namespace BBB
{
   void doSomethingElse() ;
}

namespace CCC
{
   using namespace AAA ;
   using namespace BBB ;
}

void doSomethingAgain()
{
   CCC::doSomething() ;
   CCC::doSomethingElse() ;
} 
```

您甚至可以从不同的命名空间导入选择符号，以构建您自己的自定义命名空间接口。我还没有找到它的实际用途，但从理论上讲，它很酷。

# user-interface - 标签对导航有用吗（在堆栈溢出或其他方面）？

> ID：80632
> 
> 赞同：2
> 
> 时间：2008-09-17T06:54:04.650
> 
> 标签：user-interface, navigation, tags, usability

[我已经对使用来自社交书签网站的标签进行网络搜索](http://dx.doi.org/10.1016/j.ipm.2007.12.010)进行了一些研究，但我想了解更多关于用户可能使用标签进行信息检索的其他方式。

您是否使用 Stack Overflow 等网站上的标签进行导航？您是否将它们视为过滤器（缩小大量问题列表）或类别（显示网站的组织方式）或其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T07:10:40.413

我使用它们来搜索我的堆栈（C#、ASP.NET、WinForms 等）。我在 Launchy 中将它们设置为快捷方式。

[我在我的StackOverflow 博客文章](http://cantgrokwontgrok.blogspot.com/2008/09/stackoverflow-crackoverflow-or.html)中发布了一些想法- 如果您喜欢，请随时在此处发表评论：

> **搜索支持**
> 
> 搜索功能正在改进。但是，它是否仍然受到限制（例如，没有 OR 搜索）。它还具有有限的过滤选项。对我来说，一个主要问题是它显示搜索的答案和问题。因此，您最终可能会得到一页指向一个问题的结果（这可能对您没有帮助）。标签搜索也在改进，但仍然受到限制，甚至被其创建者误解（见评论）。
> 
> **寻找你的堆栈**
> 
> 我是一名 C# 开发人员。我在 Windows 和 ASP.NET 应用程序上工作。我对 Java、Python、Ruby 和许多其他语言一无所知。我只能提供有限的建筑和设计建议。现在，目前，我很难找到带有适当标签的问题以便我可以提供帮助。我提议：
> 
> “智能列表” - 这些应该是每个用户可以创建的列表，您可以指定要搜索的标签。例如，我可以创建三个“Windows”（搜索标记为“C# WinForms”的项目）、“Web”（标记为“ASP.NET”）和体系结构（标记为“architecture”）。现在，在 LAMP 堆栈上工作的 Web 开发人员可能有一个“Web”标签，但标签完全不同。
> 
> 我目前正在通过为我的堆栈设置 Launchy 快捷方式来解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T06:59:33.360

我在这里使用一个作为过滤器来获取我最感兴趣的内容。我可能对这里的某事有疑问，并想在提出问题之前进一步研究该主题。或者我可能在某个领域知识渊博，并想查看问题以查看我是否可以提供帮助。

在工作中，我们使用类似于标签的东西来标记我们的联系人。标签指示属性的类型，因此如果我们想更轻松地找到某种类型的供应商或客户，我们可以通过标签进行搜索。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T07:19:34.933

我不知道您如何使用标签进行导航——对我来说，导航意味着您正在浏览静态内容。

我绝对认为它们是过滤器。我可以通过一个 html 链接访问特定主题的信息，而不是进入搜索表单并经历输入搜索词或点击单选按钮然后点击提交以获取我想要的数据类型的烦人过程看着。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:55:41.000

是的 - 纯粹是基于我通过寻找可用性标签发现了这个问题。:)

到目前为止，在像这样的网站上，我倾向于将标签视为相互排斥的过滤器。我想在搜索中*结合*标签，但事实上在许多网站上如何做到这一点并不是很明显，例如 Blogger 博客中的标签，这意味着我不想尝试。在具有允许我在搜索字段中输入标签的界面的网站（例如本网站）上，我更倾向于尝试。

无论哪种方式，我都将标签视为简单的过滤器，而不是类别、层次结构或其他方式。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:45:10.033

标签和分层视图（如字典结构）是信息组织的两种主要方法。

由于大多数用户更熟悉字典结构（许多现实生活中的类比存在，例如在图书馆寻找特定的艺术书籍或在商场寻找牛奶），起初他们通常更习惯使用它们。但是在创建实际内容之前必须定义分层视图（至少是一般结构），这不太适合自然的“内容”增长。它也没有提供任何替代视图（例如，我无法在超市根据含糖量寻找食物）。

标签更加有机，在用户习惯之后，提供了一种更自然的方式来查看和排序信息。然而，从长远来看，标签的有机增长可能会变得非常混乱。例如，可能有许多标签具有相同的含义，但拼写或单词不同。此外，很难定义多语言标签系统。虽然在中小型标签上效果很好，但我认为在大规模上它们需要大量维护。

我喜欢标签在这里的工作方式。如果您填写了一个标签（在问题提问表上），一个小的弹出窗口会显示您输入的标签是什么，以及每个单词标记了多少项目。这有助于我确定特定内容的确切标签词应该是什么。

总的来说，我也喜欢并在其他网站上使用标签，因为它们为大量信息提供了快速可定制的视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T23:25:13.500

Del.icio.us 和 GMail 向我出售了标签，而不是其他组织事物的方法。GMail 的实现特别直观：标签就像文件夹，但单个项目可以位于多个文件夹中（Outlook 还没有弄清楚这一点）。Del.icio.us 教会了我第二个概念：标签就像集合，应用联合和交集可以真正缩小您要查找的范围。

所以，是的，IMO，标签对导航很有用。

说到标签，如果有人正在阅读这篇文章并享有添加标签的声誉......

我真的很喜欢“（WhateverTechOrLanguage）的隐藏功能”文章。有一个“隐藏功能”标签，但它并不适用于每一篇文章。如果我有声誉，我会这样做，但我不想添加一个“答案”告诉他们标记。我知道，只要我得到 50 分的“Whoofie”，我至少可以添加一条评论，要求他们标记它，但是......

# java - 关闭后如何在 Firefox 3 中重新打开 Java 控制台

> ID：80634
> 
> 赞同：2
> 
> 时间：2008-09-17T06:54:16.117
> 
> 标签：java, firefox, applet

我正在使用 firefox3 运行 Java Applet（在 Linux 上）。通常，当 JVM 启动时，Java 控制台窗口会打开，因此我可以看到 Applet 的输出（堆栈跟踪等）。

但是，如果我*关闭*控制台，除了重新启动 Firefox 之外似乎没有办法让它恢复（我必须关闭控制台，因为它使小程序的启动由于某种原因而挂起，这是另一个问题）。

有一个名为“Open Java Console”的 Firefox 扩展解决了这个问题，但它还没有被移植到 Firefox3。

有没有办法在 Firefox3 中重新打开 Java 控制台？

请注意，我在*Linux*（Ubuntu 8.04）上使用 Firefox3，其中“工具->Java 控制台”菜单选项由于某种原因没有出现

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T08:00:38.237

我有 Web 开发者插件，所以按 Ctrl-Shift-O 会打开 Java 控制台。（Ubuntu 上的 Firefox 3）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-28T17:44:29.827

我也有 Web Developer 插件，但我无法打开 Java 控制台，所以现在我右键单击任务栏中的 Java 图标，然后单击“打开控制台”，这对我来说是这样的。

# c# - 在 C# 中使事件异步的最佳方法

> ID：80645
> 
> 赞同：15
> 
> 时间：2008-09-17T06:56:35.520
> 
> 标签：c#, events, asynchronous

事件在 C# 中是同步的。我有这个应用程序，我的主窗体启动一个线程，其中有一个循环来监听流。当流中出现某个事件时，会从循环向主窗体触发一个事件。

如果主窗体很慢或显示消息框或其他内容，则循环将被暂停。解决这个问题的最佳方法是什么？通过在主窗体上使用回调和调用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T07:03:00.527

由于您使用的是表单，因此更简单的方法是使用[BackgroundWorker](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.backgroundworker)组件。

> BackgroundWorker 类允许您在单独的专用线程上运行操作。下载和数据库事务等耗时的操作可能会导致您的用户界面 (UI) 在运行时似乎停止响应。当您需要响应式 UI 并且面临与此类操作相关的长时间延迟时，BackgroundWorker 类提供了一种方便的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T07:05:04.093

嗯，我使用了不同的场景，这取决于我当时需要什么。

我相信 BeginInvoke 可能是最容易编写代码的，因为您快到了。无论哪种方式，您都应该已经在使用 Invoke，因此只需更改为 BeginInvoke。在单独的线程上使用回调将完成与使用 BeginInvoke 相同的事情（只要您使用线程池将回调排队）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T07:05:44.263

事件只是[委托](https://docs.microsoft.com/en-us/dotnet/api/system.eventhandler)，所以使用 BeginInvoke。（请参阅[在 .NET 环境中进行异步方法调用](https://docs.microsoft.com/en-us/archive/msdn-magazine/2001/august/net-delegates-making-asynchronous-method-calls-in-the-net-environment)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T07:13:49.033

您有几个选项，正如已经详细说明的那样，但根据我的经验，您最好离开代表和 BeginInvoke，并改用 BackgroundWorker（v2.0+），因为它更易于使用并且还允许您与主窗体就线程的完成。总而言之，我发现了一个非常实施的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T07:58:54.887

**System.ComponentModel.BackgroundWorker**确实是一个很好的起点。它会做你的异步工作，给你重要事件的通知，并有办法更好地与你的表单集成。

例如，您可以通过为 ProgressChanged 事件注册处理程序来激活进度通知。（如果您有一个较长的异步进程并且您不希望您的用户认为应用程序冻结，强烈建议您这样做）

# php - PHP 相等（== 双等）和身份（=== 三等）比较运算符有何不同？

> ID：80646
> 
> 赞同：547
> 
> 时间：2008-09-17T06:56:45.987
> 
> 标签：php

`==`和 和有什么不一样`===`？

*   松散比较究竟是如何`==`工作的？
*   严格比较究竟是如何`===`工作的？

有哪些有用的例子？

* * *

## 回答 #1

> 赞同：678
> 
> 时间：2008-09-17T06:57:19.120

# `==`和之间的区别`===`

`==`松散相等运算符和严格相等运算符之间的区别在[手册](http://php.net/manual/en/language.operators.comparison.php#language.operators.comparison)`===`中有详细说明：

> 比较运算符
> 
> ```
> ┌──────────┬───────────┬──────────────────────── ──────────────────────────────────┐
> │ 例子 │ 名称 │ 结果 │
> ├──────────┼────────────┼──────────────────────── ──────────────────────────────────┤
> │$a == $b │ 等于 │ 如果在类型杂耍之后 $a 等于 $b 则为 TRUE。│
> │$a === $b │ 相同 │ 如果 $a 等于 $b 并且它们属于同一类型，则为 TRUE。│
> └──────────┴───────────┴──────────────────────── ──────────────────────────────────┘
> 
> ```

* * *

# 松散`==`相等比较

如果您正在使用`==`运算符或任何其他使用松散比较的比较运算符，例如`!=`,`<>`或`==`，您总是必须查看**上下文**以了解转换的内容、位置和原因，以了解发生了什么。

### 转换规则

*   [转换为布尔值](http://php.net/manual/en/language.types.boolean.php#language.types.boolean.casting)
*   [转换为整数](http://php.net/manual/en/language.types.integer.php#language.types.integer.casting)
*   [转换为浮点数](http://php.net/manual/en/language.types.float.php#language.types.float.casting)
*   [转换为字符串](http://php.net/manual/en/language.types.string.php#language.types.string.casting)
*   [转换为数组](http://php.net/manual/en/language.types.array.php#language.types.array.casting)
*   [转换为对象](http://php.net/manual/en/language.types.object.php#language.types.object.casting)
*   [转换为资源](http://php.net/manual/en/language.types.resource.php#language.types.resource.casting)
*   [转换为 NULL](http://php.net/manual/en/language.types.null.php#language.types.null.casting)

### 类型对照表

作为参考和示例，您可以在[手册](http://php.net/manual/en/types.comparisons.php#types.comparisions-loose)中查看比较表：

> 松散的比较`==`
> 
> ```
> ┌──────────┬───────┬────────┬────────┬────────┬──────── ┬────────┬────────┬────────┬────────┬──────────┬──────── ┬────────┐
> │ │ TRUE │ FALSE │ 1 │ 0 │ -1 │ "1" │ "0" │ "-1" │ NULL │ array() │ "php" │ "" │
> ├──────────┼────────┼────────┼────────┼────────┼──────── ┼────────┼────────┼────────┼────────┼──────────┼──────── ┼────────┤
> │ TRUE │ TRUE │ FALSE │ TRUE │ FALSE │ TRUE │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │
> │ FALSE │ FALSE │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ TRUE │ TRUE │ FALSE │ TRUE │
> │ 1 │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ 0 │ FALSE │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ TRUE │ FALSE │ TRUE │ TRUE │
> │ -1 │ TRUE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ "1" │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ "0" │ FALSE │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ "-1" │ TRUE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ NULL │ FALSE │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ TRUE │ FALSE │ TRUE │
> │ array() │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ TRUE │ FALSE │ FALSE │
> │ "php" │ TRUE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │
> │ "" │ FALSE │ TRUE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ TRUE │
> └──────────┴───────┴────────┴────────┴────────┴──────── ┴────────┴────────┴────────┴────────┴──────────┴──────── ┴────────┘
> 
> ```

# 严格`===`相同比较

如果您使用`===`运算符或任何其他使用严格比较的比较运算符，例如`!==`or `===`，那么您始终可以确保类型不会*神奇地*改变，因为不会进行转换。因此，通过严格比较，类型和值必须相同，而不仅仅是值。

### 类型对照表

作为参考和示例，您可以在[手册](http://php.net/manual/en/types.comparisons.php#type.comparisons-strict)中查看比较表：

> 严格比较`===`
> 
> ```
> ┌──────────┬───────┬────────┬────────┬────────┬──────── ┬────────┬────────┬────────┬────────┬──────────┬──────── ┬────────┐
> │ │ TRUE │ FALSE │ 1 │ 0 │ -1 │ "1" │ "0" │ "-1" │ NULL │ array() │ "php" │ "" │
> ├──────────┼────────┼────────┼────────┼────────┼──────── ┼────────┼────────┼────────┼────────┼──────────┼──────── ┼────────┤
> │ TRUE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ 1 │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ 0 │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ -1 │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ "1" │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ "0" │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ "-1" │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │ FALSE │
> │ NULL │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │ FALSE │
> │ array() │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │ FALSE │
> │ "php" │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │ FALSE │
> │ "" │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ FALSE │ TRUE │
> └──────────┴───────┴────────┴────────┴────────┴──────── ┴────────┴────────┴────────┴────────┴──────────┴──────── ┴────────┘
> 
> ```

* * *

## 回答 #2

> 赞同：249
> 
> 时间：2009-02-26T07:52:24.817

运算符 == 在两种不同类型之间进行强制转换（如果它们不同），而 === 运算符执行“类型安全比较”。这意味着只有当两个操作数具有相同的类型和相同的值时，它才会返回 true。

例子：

```
1 === 1: true
1 == 1: true
1 === "1": false // 1 is an integer, "1" is a string
1 == "1": true // "1" gets casted to an integer, which is 1
"foo" === "foo": true // both operands are strings and have the same value
```

**警告**：具有等效成员的同一类的两个实例与运算符不匹配`===`。例子：

```
$a = new stdClass();
$a->foo = "bar";
$b = clone $a;
var_dump($a === $b); // bool(false) 
```

* * *

## 回答 #3

> 赞同：112
> 
> 时间：2016-11-03T00:42:17.353

一张图片胜过千言万语：

## PHP Double Equals`==`相等图：

[![在此处输入图像描述](https://i.stack.imgur.com/xI8W7.png)](https://github.com/sentientmachine/php_equality_charts)

## PHP Triple Equals `===`Equality 图表：

[![在此处输入图像描述](https://i.stack.imgur.com/gs1Eh.png)](https://github.com/sentientmachine/php_equality_charts)

创建这些图像的源代码：

[https://github.com/sentientmachine/php_equality_charts](https://github.com/sentientmachine/php_equality_charts)

## 上师冥想

那些希望保持理智的人不要再读下去了，因为这一切都没有任何意义，只是说这就是 PHP 的疯狂分形的设计方式。

1.  `NAN != NAN`但是`NAN == true`。

2.  `==`如果 left 是数字，则将左右操作数转换为数字。所以`123 == "123foo"`，但是`"123" != "123foo"`

3.  引号中的十六进制字符串有时是浮点数，并且会被意外强制转换为违背您的意愿，从而导致运行时错误。

4.  `==`不及物因为`"0"== 0`, 并且`0 == ""`但是`"0" != ""`

5.  尚未声明的 PHP 变量是错误的，即使 PHP 有一种方法来表示未定义的变量，该功能也被`==`.

6.  `"6" == " 6"`, `"4.2" == "4.20"`,`"133" == "0133"`但`133 != 0133`. 但是`"0x10" == "16"`，`"1e3" == "1000"`在没有您的指示或同意的情况下，将意外的字符串转换为八进制会发生，从而导致运行时错误。

7.  `False == 0`, `""`,`[]`和`"0"`.

8.  如果您将 1 加到 number 并且它们已经保持最大值，则它们不会环绕，而是被强制转换为`infinity`.

9.  一个新的类是 == 到 1。

10.  False 是最危险的值，因为 False 对大多数其他变量来说是 == ，主要是违背了它的目的。

## 希望：

如果您使用的是 PHP，则不应使用双等号运算符，因为如果您使用三等号，唯一需要担心的边缘情况是 NAN 和非常接近其数据类型最大值的数字，以至于它们被强制转换为无穷大。使用双重相等，任何东西都可以让`==`任何东西感到惊讶，或者可以违背你的意愿而`!=`让你感到惊讶，并且它显然应该是平等的。

你`==`在 PHP 中使用的任何地方都是一种不好的代码气味，因为其中的 85 个错误被隐式转换规则暴露出来，这些规则似乎是由数百万程序员通过布朗运动编程设计的。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-09-17T07:27:59.483

关于 JavaScript：

=== 运算符的工作方式与 == 运算符相同，但它要求其操作数不仅具有相同的值，而且具有相同的数据类型。

例如，下面的示例将显示“x 和 y 相等”，但不会显示“x 和 y 相同”。

```
var x = 4;
var y = '4';
if (x == y) {
    alert('x and y are equal');
}
if (x === y) {
    alert('x and y are identical');
} 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-02-26T09:12:37.807

关于对象比较的其他答案的补充：

== 使用对象的名称及其值比较对象。如果两个对象属于同一类型并且具有相同的成员值，则`$a == $b`返回 true。

=== 比较对象的内部对象 id。即使成员相等，`$a !== $b`如果它们不是完全相同的对象。

```
class TestClassA {
    public $a;
}

class TestClassB {
    public $a;
}

$a1 = new TestClassA();
$a2 = new TestClassA();
$b = new TestClassB();

$a1->a = 10;
$a2->a = 10;
$b->a = 10;

$a1 == $a1;
$a1 == $a2;  // Same members
$a1 != $b;   // Different classes

$a1 === $a1;
$a1 !== $a2; // Not the same object 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-07-18T16:08:22.997

这都是关于数据类型的。以`BOOL`（真或假）为例：

`true`也等于`1`也 `false`等于`0`

比较`==`时不关心数据类型：因此，如果您有一个变量为 1 （也可能是`true`）：

`$var=1;`

然后比较`==`：

```
if ($var == true)
{
    echo"var is true";
} 
```

但`$var`实际上并不等于`true`，不是吗？相反，它的 int 值`1`等于 true。

使用`===`，检查数据类型以确保两个变量/对象/任何使用相同的类型。

所以如果我这样做了

```
if ($var === true)
{
    echo "var is true";
} 
```

这种情况不会是真的，因为`$var !== true`它只是`== true`（如果你知道我的意思）。

你为什么需要这个？

很简单 - 让我们看一下 PHP 的一个函数`array_search()`：

该`array_search()`函数只是在数组中搜索一个值，并返回找到该值的元素的键。如果在数组中找不到该值，则返回**false**。但是，如果你`array_search()`对存储在数组的**第一个元素中的**`0`值（它的数组键`array_search()`为

所以如果你这样做了：

```
$arr = array("name");
if (array_search("name", $arr) == false)
{
    // This would return 0 (the key of the element the val was found
    // in), but because we're using ==, we'll think the function
    // actually returned false...when it didn't.
} 
```

那么，您知道现在这可能是一个问题吗？

`== false`大多数人在检查函数是否返回 false 时不使用。相反，他们使用`!`. 但实际上，这与 using 完全相同`==false`，所以如果你这样做了：

```
$arr = array("name");
if (!array_search("name", $arr)) // This is the same as doing (array_search("name", $arr) == false) 
```

因此，对于这样的事情，您将使用`===`，以便检查数据类型。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-01-09T16:03:57.197

## PHP 双等号`==`：

在大多数编程语言中，比较运算符 (==) 一方面检查数据类型，另一方面检查变量内容是否相等。PHP 中的标准比较运算符 (==) 的行为有所不同。这会在比较之前尝试将两个变量转换为相同的数据类型，然后才检查这些变量的内容是否相同。得到以下结果：

```
<?php
    var_dump( 1 == 1 );     // true
    var_dump( 1 == '1' );   // true
    var_dump( 1 == 2 );     // false
    var_dump( 1 == '2' );   // false
    var_dump( 1 == true );  // true
    var_dump( 1 == false ); // false
?> 
```

## PHP 三等号`===`：

此运算符还检查变量的数据类型，并且仅当两个变量具有相同的内容和相同的数据类型时才返回 (bool)true。因此，以下是正确的：

```
<?php
    var_dump( 1 === 1 );     // true
    var_dump( 1 === '1' );   // false
    var_dump( 1 === 2 );     // false
    var_dump( 1 === '2' );   // false
    var_dump( 1 === true );  // false
    var_dump( 1 === false ); // false
?> 
```

阅读[PHP 中 == 和 === 之间的区别](https://stackhowto.com/what-is-the-difference-between-equal-and-identity-operator-in-php/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-17T07:07:10.640

您将使用 === 来测试函数或变量是否为假，而不仅仅是等同于假（零或空字符串）。

```
$needle = 'a';
$haystack = 'abc';
$pos = strpos($haystack, $needle);
if ($pos === false) {
    echo $needle . ' was not found in ' . $haystack;
} else {
    echo $needle . ' was found in ' . $haystack . ' at location ' . $pos;
} 
```

在这种情况下 strpos 将返回 0 ，这相当于测试中的 false

```
if ($pos == false) 
```

或者

```
if (!$pos) 
```

这不是你想要的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T07:42:15.470

变量具有类型和值。

*   $var = "test" 是一个包含 "test" 的字符串
*   $var2 = 24 是一个整数 vhose 值是 24。

当您使用这些变量（在 PHP 中）时，有时您没有好的类型。例如，如果你这样做

```
if ($var == 1) {... do something ...} 
```

PHP 必须将 ("to cast") $var 转换为整数。在这种情况下，“$var == 1”为真，因为任何非空字符串都被强制转换为 1。

使用 === 时，您检查值和类型是否相等，因此 "$var === 1" 为假。

这很有用，例如，当您有一个可以返回 false（错误）和 0（结果）的函数时：

```
if(myFunction() == false) { ... error on myFunction ... } 
```

这段代码是错误的，好像`myFunction()`返回 0，它被强制转换为 false，你似乎有一个错误。正确的代码是：

```
if(myFunction() === false) { ... error on myFunction ... } 
```

因为测试是返回值“是布尔值并且是假的”而不是“可以强制转换为假”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-18T00:51:54.747

```
<?php

    /**
     * Comparison of two PHP objects                         ==     ===
     * Checks for
     * 1\. References                                         yes    yes
     * 2\. Instances with matching attributes and its values  yes    no
     * 3\. Instances with different attributes                yes    no
     **/

    // There is no need to worry about comparing visibility of property or
    // method, because it will be the same whenever an object instance is
    // created, however visibility of an object can be modified during run
    // time using ReflectionClass()
    // http://php.net/manual/en/reflectionproperty.setaccessible.php
    //
    class Foo
    {
        public $foobar = 1;

        public function createNewProperty($name, $value)
        {
            $this->{$name} = $value;
        }
    }

    class Bar
    {
    }
    // 1\. Object handles or references
    // Is an object a reference to itself or a clone or totally a different object?
    //
    //   ==  true   Name of two objects are same, for example, Foo() and Foo()
    //   ==  false  Name of two objects are different, for example, Foo() and Bar()
    //   === true   ID of two objects are same, for example, 1 and 1
    //   === false  ID of two objects are different, for example, 1 and 2

    echo "1\. Object handles or references (both == and    ===) <br />";

    $bar = new Foo();    // New object Foo() created
    $bar2 = new Foo();   // New object Foo() created
    $baz = clone $bar;   // Object Foo() cloned
    $qux = $bar;         // Object Foo() referenced
    $norf = new Bar();   // New object Bar() created
    echo "bar";
    var_dump($bar);
    echo "baz";
    var_dump($baz);
    echo "qux";
    var_dump($qux);
    echo "bar2";
    var_dump($bar2);
    echo "norf";
    var_dump($norf);

    // Clone: == true and === false
    echo '$bar == $bar2';
    var_dump($bar == $bar2); // true

    echo '$bar === $bar2';
    var_dump($bar === $bar2); // false

    echo '$bar == $baz';
    var_dump($bar == $baz); // true

    echo '$bar === $baz';
    var_dump($bar === $baz); // false

    // Object reference: == true and === true
    echo '$bar == $qux';
    var_dump($bar == $qux); // true

    echo '$bar === $qux';
    var_dump($bar === $qux); // true

    // Two different objects: == false and === false
    echo '$bar == $norf';
    var_dump($bar == $norf); // false

    echo '$bar === $norf';
    var_dump($bar === $norf); // false

    // 2\. Instances with matching attributes and its values (only ==).
    //    What happens when objects (even in cloned object) have same
    //    attributes but varying values?

    // $foobar value is different
    echo "2\. Instances with matching attributes  and its values (only ==) <br />";

    $baz->foobar = 2;
    echo '$foobar' . " value is different <br />";
    echo '$bar->foobar = ' . $bar->foobar . "<br />";
    echo '$baz->foobar = ' . $baz->foobar . "<br />";
    echo '$bar == $baz';
    var_dump($bar == $baz); // false

    // $foobar's value is the same again
    $baz->foobar = 1;
    echo '$foobar' . " value is the same again <br />";
    echo '$bar->foobar is ' . $bar->foobar . "<br />";
    echo '$baz->foobar is ' . $baz->foobar . "<br />";
    echo '$bar == $baz';
    var_dump($bar == $baz); // true

    // Changing values of properties in $qux object will change the property
    // value of $bar and evaluates true always, because $qux = &$bar.
    $qux->foobar = 2;
    echo '$foobar value of both $qux and $bar is 2, because $qux = &$bar' . "<br />";
    echo '$qux->foobar is ' . $qux->foobar . "<br />";
    echo '$bar->foobar is ' . $bar->foobar . "<br />";
    echo '$bar == $qux';
    var_dump($bar == $qux); // true

    // 3\. Instances with different attributes (only ==)
    //    What happens when objects have different attributes even though
    //    one of the attributes has same value?
    echo "3\. Instances with different attributes (only ==) <br />";

    // Dynamically create a property with the name in $name and value
    // in $value for baz object
    $name = 'newproperty';
    $value = null;
    $baz->createNewProperty($name, $value);
    echo '$baz->newproperty is ' . $baz->{$name};
    var_dump($baz);

    $baz->foobar = 2;
    echo '$foobar' . " value is same again <br />";
    echo '$bar->foobar is ' . $bar->foobar . "<br />";
    echo '$baz->foobar is ' . $baz->foobar . "<br />";
    echo '$bar == $baz';
    var_dump($bar == $baz); // false
    var_dump($bar);
    var_dump($baz);
?> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-05-08T22:05:46.037

到目前为止，所有答案都忽略了 === 的一个危险问题。顺便提一下，但没有强调，整数和双精度是不同的类型，所以下面的代码：

```
$n = 1000;
$d = $n + 0.0e0;
echo '<br/>'. ( ($n ==  $d)?'equal' :'not equal' );
echo '<br/>'. ( ($n === $d)?'equal' :'not equal' ); 
```

给出：

```
 equal
 not equal 
```

请注意，这不是“舍入错误”的情况。这两个数字精确到最后一位，但它们有不同的类型。

这是一个令人讨厌的问题，因为如果所有数字都足够小，使用 === 的程序可以愉快地运行数年（其中“足够小”取决于您运行的硬件和操作系统）。但是，如果碰巧一个整数大到足以转换为双精度数，则其类型将“永远”更改，即使后续操作或许多操作可能会将其恢复为较小的整数值。而且，情况会变得更糟。它可以传播——双重感染可以传递给它接触到的任何东西，一次计算一次。

例如，在现实世界中，这可能是处理 2038 年之后日期的程序中的一个问题。此时，UNIX 时间戳（自 1970-01-01 00:00:00 UTC 以来的秒数）将需要超过 32 位，因此它们的表示将“神奇地”在某些系统上切换为双倍。因此，如果您计算两次之间的差异，您可能会得到几秒钟的结果，但结果是双精度数，而不是 2017 年出现的整数结果。

我认为这比字符串和数字之间的转换要糟糕得多，因为它很微妙。我发现跟踪什么是字符串和什么是数字很容易，但是跟踪数字中的位数却超出了我的范围。

因此，在上面的答案中有一些不错的表格，但 1（作为整数）和 1（微妙的双精度）和 1.0（明显的双精度）之间没有区别。此外，建议您始终使用 === 而永远不要使用 == 也不是很好，因为 === 有时会在 == 正常工作的情况下失败。此外，JavaScript 在这方面并不等价，因为它只有一种数字类型（在内部它可能有不同的按位表示，但它不会对 === 造成问题）。

我的建议 - 两者都不使用。你需要编写自己的比较函数来真正解决这个问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-09-12T16:15:50.360

`==`PHP数组和对象之间有两个`===`没有人提到的区别：两个具有不同键排序的数组和对象。

### 具有不同键排序的两个数组

如果您有两个数组，它们的键排序不同，但具有相同的键值映射，它们是完全不同的（即使用`===`）。如果您对数组进行键排序，并尝试将排序后的数组与原始数组进行比较，这可能会导致问题。

例如：

```
$arr1 = [
    "I" => "we",
    "you" => "you",
];

$arr2 = [
    "you" => "you",
    "I" => "we",
];

$arr1 == $arr2; // true
$arr1 === $arr2; // false 
```

这里的一个典型陷阱是[`ksort()`](http://www.php.net/ksort)对一个数组执行 a 并将其与另一个数组进行严格比较。

### 对象

请记住，主要规则是*两个不同的对象永远不会严格相等*。看下面的例子：

```
$stdClass1 = new stdClass();
$stdClass2 = new stdClass();
$clonedStdClass1 = clone $stdClass1;

$stdClass1 == $stdClass2; // true
$stdClass1 === $stdClass2; // false
$stdClass1 == $clonedStdClass1; // true
$stdClass1 === $clonedStdClass1; // false 
```

**注意**：将对象分配给另一个变量不会创建副本 - 相反，它会创建对同一对象的引用。[见这里](https://stackoverflow.com/a/2144654/4215651)。

**注意**：从 PHP7 开始，引入了[匿名类](http://www.php.net/manual/en/language.oop5.anonymous.php)。在上面的测试中， a`new class {}`和 a没有区别。`new stdClass()`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-02-12T07:14:09.720

**==（相等）和 ===（相等）之间的区别**

PHP 提供了两个比较运算符来检查两个值的相等性。这两者之间的主要区别在于`'=='`检查两个操作数的值是否为`equal or not`. 另一方面，`'==='`检查值以及操作数的类型是`equal or not`.

> ==（相等）
> 
> ===（相等）

**示例 =>**

```
<?php 
    $val1 = 1234;
    $val2 = "1234";
    var_dump($val1 == $val2);// output => bool(true)
    //It checks only operands value
?> 

<?php 
    $val1 = 1234;
    $val2 = "1234";
    var_dump($val1 === $val2);// output => bool(false)
    //First it checks type then operands value
?> 
```

如果我们输入 cast $val2 到 (int)$val2 或 (string)$val1 那么它返回 true

```
 <?php 
        $val1 = 1234;
        $val2 = "1234";
        var_dump($val1 === (int)$val2);// output => bool(true)
        //First it checks type then operands value
    ?> 
```

或者

```
 <?php 
        $val1 = 1234;
        $val2 = "1234";
        var_dump($val1 === (int)$val2);// output => bool(true)
        //First it checks type then operands value
    ?> 
```

# windows - 如何在 Windows 中注册自定义 URL 协议？

> ID：80650
> 
> 赞同：113
> 
> 时间：2008-09-17T06:57:30.150
> 
> 标签：windows, url, protocols, custom-url-protocol

如何在 Windows 中注册自定义协议，以便在单击电子邮件或网页中的链接时打开我的应用程序并将 URL 中的参数传递给它？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2016-07-05T14:26:20.947

1.  然后`Start`输入`Find`类型`regedit`->它应该打开`Registry editor`

2.  `Right Mouse`然后点击`HKEY_CLASSES_ROOT`- `New`>`Key`

[![在此处输入图像描述](https://i.stack.imgur.com/9boI6.png)](https://i.stack.imgur.com/9boI6.png)

3.  在 Key 中给出您希望调用 url 的小写名称（在我的情况下它将是）`testus://sdfsdfsdf`然后单击-> 然后->并添加没有值。`Right Mouse``testus``New``String Value``URL Protocol`

[![在此处输入图像描述](https://i.stack.imgur.com/4wLev.png)](https://i.stack.imgur.com/4wLev.png)

4.  然后像使用协议（`Right Mouse` `New`-> `Key`）一样添加更多条目，并创建像`testus`-> `shell`-> `open`->这样的层次结构`command`，并在内部`command`更改`(Default)`要启动的路径`.exe`，如果要将参数传递给 exe，则将路径包装到 exe并`""`添加 `"%1"`看起来像：`"c:\testing\test.exe" "%1"`

[![在此处输入图像描述](https://i.stack.imgur.com/VbhsZ.png)](https://i.stack.imgur.com/VbhsZ.png)

5.  要测试它是否有效，请转到`Internet Explorer`(not `Chrome`or `Firefox`) 并输入`testus:have_you_seen_this_man`这应该会触发您的`.exe`(给您一些您想要执行此操作的提示 - 说是) 并传递给 args `testus://have_you_seen_this_man`。

这是要测试的示例控制台应用程序：

```
using System;

namespace Testing
{
    class Program
    {
        static void Main(string[] args)
        {
            if (args!= null && args.Length > 0)
            Console.WriteLine(args[0]);
            Console.ReadKey();
        }
    }
} 
```

希望这可以节省您一些时间。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-17T10:48:55.600

MSDN 链接很好，但那里的安全信息不完整。处理程序注册应包含“%1”，而不是 %1。这是一种安全措施，因为某些 URL 源在调用您的自定义协议处理程序之前会错误地解码 %20。

PS。您将获得整个 URL，而不仅仅是 URL 参数。但是除了已经提到的 %20->space 转换之外，URL 可能会受到一些虐待。在您的 URL 语法设计中保持保守会有所帮助。不要随意乱扔 // 否则你会陷入 file:// 的混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-04-30T08:06:12.563

为此目的有一个 npm 模块。

链接：[https ://www.npmjs.com/package/protocol-registry](https://www.npmjs.com/package/protocol-registry)

因此，要在 nodejs 中执行此操作，您只需要运行以下代码：

首先安装它

```
npm i protocol-registry 
```

然后使用下面的代码注册你的入口文件。

```
const path = require('path');

const ProtocolRegistry = require('protocol-registry');

console.log('Registering...');
// Registers the Protocol
ProtocolRegistry.register({
    protocol: 'testproto', // sets protocol for your command , testproto://**
    command: `node ${path.join(__dirname, './index.js')} $_URL_`, // $_URL_ will the replaces by the url used to initiate it
    override: true, // Use this with caution as it will destroy all previous Registrations on this protocol
    terminal: true, // Use this to run your command inside a terminal
    script: false
}).then(async () => {
    console.log('Successfully registered');
}); 
```

然后假设有人打开 testproto://test 然后将启动一个新终端执行：

```
node yourapp/index.js testproto://test 
```

它还支持所有其他操作系统。

# asynchronous - ASP.NET 2.0 中的 SmtpClient.SendAsync 错误

> ID：80653
> 
> 赞同：2
> 
> 时间：2008-09-17T06:58:23.453
> 
> 标签：asynchronous, smtp, asp.net-2.0

我可能错了，但是如果您在 ASP.NET 2.0 中使用 SmtpClient.SendAsync 并且它引发异常，则处理请求的线程会无限期地等待操作完成。

要重现此问题，只需为发送电子邮件时无法解析的主机使用无效的 SMTP 地址。

请注意，您应该设置 Page.Async = true 以使用 SendAsync。

如果 Page.Async 设置为 false 并且 Send 抛出异常，线程不会阻塞，并且页面被正确处理。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T07:45:02.780

 ~~~~> 请注意，您应该设置 Page.Async = true 以使用 SendAsync。~~ 

~~请解释这背后的理由。误解 Page.Async 的作用可能是导致您出现问题的原因。~~

抱歉，我无法找到重现问题的示例。

请参阅[http://msdn.microsoft.com/en-us/magazine/cc163725.aspx](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)（邪恶代码：ASP.NET 2.0 中的异步页面）

**编辑：**查看您的代码示例，我可以看到您没有使用`RegisterAsyncTask()`该类`PageAsyncTask`。`@Async`我认为在设置为 true的页面上执行异步任务时必须这样做。MSDN Magazine 中的示例如下所示：

```
protected void Page_Load(object sender, EventArgs e)
{
    PageAsyncTask task = new PageAsyncTask(
        new BeginEventHandler(BeginAsyncOperation),
        new EndEventHandler(EndAsyncOperation),
        new EndEventHandler(TimeoutAsyncOperation),
        null
        );
    RegisterAsyncTask(task);
} 
```

那么，在里面`BeginAsyncOperation`，您是否应该异步发送邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T15:14:31.710

无法使用 RegisterAsyncTask。查看 BeginEventHandler 委托：

公共委托 IAsyncResult BeginEventHandler（对象发送者，EventArgs e，AsyncCallback cb，对象 extraData）

它应该返回一个 IAsyncResult。现在看一下 SmtpClient.SendAsync 函数：

public void SendAsync( MailMessage 消息，对象 userToken )

没有返回值。

无论如何，只要 SmtpClient.SendAsync 不引发异常，这一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:04:43.103

这是我的。试试看。

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        // Using an incorrect SMTP server
        SmtpClient client = new SmtpClient(@"smtp.nowhere.private");
        // Specify the e-mail sender.
        // Create a mailing address that includes a UTF8 character
        // in the display name.
        MailAddress from = new MailAddress("someone@somewhere.com",
           "SOMEONE" + (char)0xD8 + " SOMEWHERE",
        System.Text.Encoding.UTF8);
        // Set destinations for the e-mail message.
        MailAddress to = new MailAddress("someone@somewhere.com");
        // Specify the message content.
        MailMessage message = new MailMessage(from, to);
        message.Body = "This is a test e-mail message sent by an application. ";
        // Include some non-ASCII characters in body and subject.
        string someArrows = new string(new char[] { '\u2190', '\u2191', '\u2192', '\u2193' });
        message.Body += Environment.NewLine + someArrows;
        message.BodyEncoding = System.Text.Encoding.UTF8;
        message.Subject = "test message 1" + someArrows;
        message.SubjectEncoding = System.Text.Encoding.UTF8;
        // Set the method that is called back when the send operation ends.
        client.SendCompleted += new
        SendCompletedEventHandler(SendCompletedCallback);
        // The userState can be any object that allows your callback 
        // method to identify this send operation.
        // For this example, the userToken is a string constant.
        string userState = "test message1";
        try
        {
            client.SendAsync(message, userState);
        }
        catch (System.Net.Mail.SmtpException ex)
        {
            Response.Write(string.Format("Send Error [{0}].", ex.InnerException.Message));
        }
        finally
        {
        }
    }
    private void SendCompletedCallback(object sender, AsyncCompletedEventArgs e)
    {
        // Get the unique identifier for this asynchronous operation.
        String token = (string)e.UserState;

        if (e.Cancelled)
        {
            Response.Write(string.Format("[{0}] Send canceled.", token));
        }
        if (e.Error != null)
        {
            Response.Write(string.Format("[{0}] {1}", token, e.Error.ToString()));
        }
        else
        {
            Response.Write("Message sent.");
        }
    }

} 
```

# windows-mobile - 如何在 Windows Mobile 上对呼叫转移设置进行编程？

> ID：80654
> 
> 赞同：1
> 
> 时间：2008-09-17T06:58:31.253
> 
> 标签：windows-mobile

有谁知道如何在 Windows mobile 5/6 上运行的代码中获取/设置呼叫转移设置？我是 Windows 移动开发的新手，想知道是否有任何方法可以使用 C# 和 .NET CF 来实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T13:07:41.647

我假设你的意思是呼叫转移？一般而言，[电话 API (TAPI)](http://msdn.microsoft.com/en-us/library/ms899558.aspx)用于以编程方式控制电话接口。呼叫转移由[TSPI_lineForward](http://msdn.microsoft.com/en-us/library/aa451032.aspx)专门处理。

Microsoft 不提供任何内置或 SDK 工具供托管开发人员使用 TAPI，并且 TAPI 使用的结构很麻烦且难以 P/Invoke。有一些[3rd-party 库](http://tapi.codeplex.com/)确实提供了一定程度的 TAPI 交互，您也可能会对其进行调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T00:50:41.317

非常感谢您的帮助。我的意思是呼叫转移，我想做的是有一个简单的应用程序，也许只有 2 个大按钮。按下时，一个应该将来电转接到我的工作电话，另一个应该将它们转接到我的家庭电话。作为一名（桌面应用程序）开发人员，我当然想为它创建自己的解决方案。我曾经尝试过 Microsoft 提供的 TAPI 包装器来尝试拨打 GSM 代码，但当我尝试“拨打”GSM 代码时它无法在代码中工作......也许我应该花更多时间研究移动设备上的 TAPI .

# smtp - Exchange 放弃对 SMTP 的支持？

> ID：80655
> 
> 赞同：2
> 
> 时间：2008-09-17T06:58:31.630
> 
> 标签：smtp, exchange-server, telnet

我想通过使用 telnet 到端口 25 通过 Exchange 发送电子邮件。直到两周前我还能够做到，但现在微软的“安全修复”已经消除了这种可能性。

当我尝试时，我收到以下消息：

421 4.3.2 服务不可用，关闭传输通道

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-24T05:52:13.723

我使用一项服务（Message Labs (ML)）来过滤掉所有的垃圾邮件。我们有一个新的互联网连接，在将 ML 的入站/出站服务重新配置到新 IP 的过程中，我遇到了一个错误。因此，我通过远程登录到端口 25 上的 IP 从外部对其进行了测试，并得到“421 4.3.2 服务不可用，关闭传输通道”错误。起初我没有意识到它失败的原因是因为我在 2007 边缘服务器接收连接器（用于 ML 服务器）上设置了特定的 IP 分组。因此，我添加了我的局域网网络和另外一个用于我正在测试的外部主机的 IP，并且看哪，我可以从两者连接。

我认为 ML 发生的事情是，他们正在测试连接性的服务器位于边缘服务器排除的地址上。

因此，我删除了我的测试 IP，并在边缘服务器上创建了一个新的临时接收连接器，接受来自所有地址 (0.0.0.0 - 255.255.255.255) 的接收连接器。然后我再次将更改提交给 ML 并猜测是什么……这次他们接受了。现在，我将简单地移除测试接收连接器，一切都应该是金色的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T07:00:49.410

SMTP 是用于接收来自世界其他地方的电子邮件的协议，所以我怀疑微软已经放弃了它。您的服务器上必须存在其他一些错误配置。

尝试仔细检查您的中继设置和交换服务器上的事件日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T10:32:38.870

我在网站上找到了答案：

[http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=2900802&SiteID=17](http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=2900802&SiteID=17)

谢谢你的帮助！

基本上，默认情况下此功能已被删除，并且*可以*通过临时配置来恢复 - 但不能保证进一步的“更新”会*再次*破坏系统。谢谢，微软。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-19T11:14:26.700

经过5年多的完美运行，2010 EDG服务器突然停止接受“421 4.3.2服务不可用”。SmtpReceive 日志 ( `Get-TransportServer | select ReceiveProtocolLogPath`) 确认确实是边缘服务器产生了这个错误。

EDGE 服务器在一个 NIC 上有两个 IP 地址。完成以下步骤后一切正常：

1.  从边缘服务器上的 nic 中删除一个 IP 地址
2.  更新 DNS 中的静态条目以指向第二个 IP 地址
3.  `Default internal receive connector`允许在所有可用的 IPv4 地址上接收邮件。

注意：此设置**不是**DMZ 的最佳安全实践。最好使用两个 NIC，每个 NIC 在不同的区域中都有一条腿。

# makefile - 生成文件 CFLAGS

> ID：80657
> 
> 赞同：23
> 
> 时间：2008-09-17T06:58:39.617
> 
> 标签：makefile

在学习[TinyOS](https://en.wikipedia.org/wiki/TinyOS)的过程中，我发现我对 makefile 完全一无所知。

有许多可选的编译时特性可以通过声明预处理器变量来使用。

要使用它们，您必须执行以下操作：

`CFLAGS="-DPACKET_LINK"` 这启用了某个功能。

和

`CFLAGS="-DPACKET_LINK" "-DLOW_POWER"`启用两个功能。

有人可以为我剖析这些线条并告诉我发生了什么吗？不是在 TinyOS 方面，而是在 makefile 方面！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-17T07:07:36.583

CFLAGS 是一个最常用于向编译器添加参数的变量。在这种情况下，它定义了宏。

因此，`-DPACKET_LINK`这相当于将`#define PACKET_LINK 1`项目中所有 .c 和 .h 文件放在顶部。最有可能的是，您的项目中有代码可以查看这些宏是否已定义并根据它执行某些操作：

```
#ifdef PACKET_LINK
// This code will be ignored if PACKET_LINK is not defined
do_packet_link_stuff();
#endif

#ifdef LOW_POWER
// This code will be ignored if LOW_POWER is not defined    
handle_powersaving_functions();
#endif 
```

如果您进一步查看您的 makefile，您应该会看到它`$(CFLAGS)`可能使用如下：

```
$(CC) $(CFLAGS) ...some-more-arguments... 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T07:05:54.700

在 makefile 的某个地方，CFLAG 将在编译行中使用，如下所示：
`$(CC) $(CFLAGS) $(C_INCLUDES) $<`

最终在执行中将被翻译为：

`gcc -DPACKET_LINK -DLOW_POWER -c filename.c -o filename.o`

此定义将按照在头文件中的定义传递给源代码

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T07:12:36.820

-D 选项设置预处理器变量，因此在您的情况下，将编译指定“#ifdef / #endif”块中的所有代码。

IE

```
#ifdef PACKET_LINK
/* whatever code here */
#endif 
```

CFLAGS 是在 makefile 中使用的一个变量，当编译器被调用时，它将被扩展为它的内容。

例如

```
gcc $(CFLAGS) source.c 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T07:11:01.660

-D至少代表*定义（在 gcc 中），它可以让你在命令行上 #define 而不是某个地方的文件。*常见的事情是 -DDEBUG 或 -DNDEBUG 分别激活或禁用调试代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T07:43:54.330

仅出于完整性考虑 - 如果您使用 Microsoft 的 nmake 实用程序，您可能实际上看不到 makefile 中使用的 $(CFLAGS) 宏，因为 nmake 有一些默认值，例如编译 C/C++ 文件。其中，以下是在 nmake 中预定义的（我不确定 GNU Make 是否会这样做），因此您可能在 Windows 上的工作 makefile 中看不到它：

```
.c.exe:
    commands:          $(CC) $(CFLAGS) $<

.c.obj:
    commands:          $(CC) $(CFLAGS) /c $<

.cpp.exe:
    commands:          $(CXX) $(CXXFLAGS) $<

.cpp.obj:
    commands:          $(CXX) $(CXXFLAGS) /c $< 
```

# vim - 和有什么区别 和 在 vim 中？

> ID：80677
> 
> 赞同：17
> 
> 时间：2008-09-17T07:02:39.310
> 
> 标签：vim

到目前为止，我学到的使用 vim 的最佳技巧之一是可以按`Ctrl`+`C`或`Ctrl`+`[`而不是`Esc`键。但是我使用的是德沃夏克键盘，所以`Ctrl`+`[`对我来说也有点遥不可及，所以我主要使用`Ctrl`+ `C`。现在我在某处读到这两个组合键实际上并不具有完全相同的行为，最好使用`Ctrl`+ `[`。到目前为止我还没有遇到任何问题，所以我想知道两者之间到底有什么区别？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T07:20:28.597

根据 Vim 的文档，`Ctrl`+`C`不会检查缩写，也不会触发`InsertLeave`自动命令事件，而`Ctrl`+`[`会。

一种选择是使用以下重新映射`Ctrl`+`C`

```
inoremap <C-c> <Esc><Esc> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T18:25:02.437

非常晚的答案，但我只是有同样的问题，并找到了一个有助于解释差异的实际例子，所以为什么不呢。

如果您选择了一个可视块，然后用 更改它`c`或在其末尾添加一些内容`A`，如果您随后使用 退出`<Esc>`，则该可视块的所有行都会发生相同的更改（这非常有用！请参阅`:help v_b_A`）；如果您使用 退出`<C-c>`，则不会发生这种情况，只有一行得到更改。可能还有其他类似的事情我没有意识到我错过了`<C-c>`......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T07:34:29.890

事实证明，`<C-[>`与 Esc 完全相同，它们是相同的字符。因此，无需怀疑那里有什么不同。:)

# java - 幻像引用的对象

> ID：80690
> 
> 赞同：8
> 
> 时间：2008-09-17T07:06:25.323
> 
> 标签：java, finalize, phantom-reference

幻影参考用于事后操作。Java 规范指出，在清除幻像引用本身之前，不会释放**幻像引用的对象。**

我的问题是：这个功能（对象未释放）有什么用途？

（我想出的唯一想法是允许本机代码对对象进行事后清理，但这并没有多大说服力）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T07:38:38.630

编辑，因为我首先误解了这个问题：

从这里引用[http://www.memorymanagement.org/glossary/p.html](http://www.memorymanagement.org/glossary/p.html)：

> Java 规范说，当引用对象入队时，幻像引用不会被清除，但实际上，语言中没有办法判断这是否已经完成。在某些实现中，JNI 弱全局引用比幻像引用更弱，并提供了一种访问幻像可达对象的方法。

但我发现没有其他参考资料会说同样的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T07:42:39.683

我认为这个想法是让其他对象在原始对象之外进行额外的清理。例如，如果原始对象无法扩展以实现一些终结的东西，您可以使用幻像引用。

更大的问题是 JVM 不能保证一个对象会被最终确定，而且我假设不能保证幻像引用在最终确定后做他们的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:52:44.127

> 幻影引用可用于执行垃圾回收前的操作，例如释放资源。相反，人们通常为此使用 finalize() 方法，这不是一个好主意。终结器对垃圾收集器的性能有可怕的影响，如果你不是很小心，它可能会破坏应用程序的数据完整性，因为“终结器”是在随机线程中随机调用的。
> 
> 在幻影引用的构造函数中，您指定一个 ReferenceQueue，一旦被引用的对象变为“幻影可达”，幻影引用就会在其中排队。幻影可达意味着除了通过幻影引用之外无法访问。最初令人困惑的是，尽管幻像引用继续将被引用对象保存在私有字段中（与软引用或弱引用不同），但它的 getReference() 方法始终返回 null。这样您就不能使对象再次强可达。
> 
> 有时，您可以轮询 ReferenceQueue 并检查是否有任何新的 PhantomReferences 其引用的对象已变为幻影可访问。为了能够做任何有用的事情，例如可以从 java.lang.ref.PhantomReference 派生一个类，该类引用应该在垃圾收集之前释放的资源。仅当幻像引用本身变得无法访问时，才会对引用的对象进行垃圾收集。

[http://www.javalobby.org/java/forums/m91822870.html#91822413](http://www.javalobby.org/java/forums/m91822870.html#91822413)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-13T13:41:30.717

我能想到的唯一一个可以防止解除分配的好用例是某种 JNI 实现的异步数据源正在写入引用的对象，并且必须被告知停止写入对象 - 停止写入对象 -在内存被回收之前。如果允许预先释放，一个简单的 forgot-to-dispose() 错误可能会导致内存损坏。

这是过去使用 finalize() 的情况之一，并且可能引发了它的一些怪癖。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-24T15:54:36.907

对于没有生命周期管理机制但您正在使用需要显式生命周期管理的东西来实现的 API，这是一个完美的解决方案。

特别是过去只使用内存中的对象的任何类型的 API，但是您已经使用套接字连接或文件连接重新实现到其他更大的后备存储，可以使用 PhantomReference 来“关闭”并在之前清理连接信息被 GC 处理的对象并且连接从未关闭，因为没有您可以使用的生命周期管理 API 接口。

考虑将一个简单的 Map 地图移动到数据库中。当地图引用被丢弃时，没有明确的“关闭”操作。然而，如果您已经实现了通过缓存写入，您希望能够完成任何写入并关闭与“数据库”的套接字连接。

下面是我用于这类东西的一个类。请注意，对 PhantomReferences 的引用必须是非本地引用才能正常工作。否则，jit 将导致它们在您退出代码块之前过早排队。

```
    导入 java.lang.ref.PhantomReference；
    导入 java.lang.ref.Reference；
    导入 java.lang.ref.ReferenceQueue；
    导入 java.util.ArrayList；
    导入 java.util.List；
    导入 java.util.concurrent.ConcurrentHashMap；
    导入 java.util.concurrent.atomic.AtomicInteger；
    导入 java.util.logging.Level；
    导入 java.util.logging.Logger；

    /**
     * 该类提供了一种跟踪一种类型的参考丢失的方法
     * 对象以允许使用辅助引用来执行一些清理
     * 活动。最常见的用法是用于一个对象，它可能
     * 包含或引用另一个需要执行一些清理的对象
     * 当不再引用引用者时。
     *
     * 一个例子可能是 Holder 类型的对象，它引用或使用一个
     * 套接字连接。当引用丢失时，套接字应该是
     * 关闭。因此，可以创建一个实例，如下所示
     *

```
     * ReferenceTracker trker = ReferenceTracker() {
     * public void 已发布（Socket s）{
     * 尝试 {
     * s.close();
     * } 捕捉（异常前）{
     * log.log(Level.SEVERE, ex.toString(), ex);
     * }
     * }
     * };
     *
```

     * 在某个地方，可能会有如下调用。
     *

```
     * 接口持有人{
     * public T get();
     * }
     * 类 SocketHolder 实现 Holder {
     * 套接字；
     * 公共 SocketHolder( 套接字 sock ) {
     * s = 袜子；
     * }
     * 公共套接字 get() {
     * 返回 s;
     * }
     * }
     *
```

     * 这定义了持有者接口的实现，它持有
     * 对 Socket 对象的引用。的使用trker
     * 上面的对象可能包括使用创建方法的方法
     * 对象和注册引用如下所示。
     *

```
     * public SocketHolder connect(String host, int port) 抛出 IOException {
     * 套接字 s = 新套接字（主机，端口）；
     * SocketHolder h = 新的 SocketHolder(s);
     * trker.trackReference(h, s);
     * 返回 h;
     * }
     *
```

     * 希望使用套接字连接并传递它的软件
     * 在所有情况下，使用 SocketHolder.get() 来引用 Socket 实例。
     * 然后，当所有 SocketHolder 引用都被删除时，套接字将released(java.net.Socket)* 按所示方法
     关闭
     * 多于。
     *
     * {@link ReferenceTracker} 类对第一个参数使用 {@link PhantomReference} 作为
     * 持有对第二个参数的引用的映射的键。因此，当
     * key instance被释放，key引用入队，可以从中移除
     * 队列，用于从映射中删除值，然后传递给
     * 释放（）。
     */
    公共抽象类 ReferenceTracker {
        /**
         * 正在从引用队列 refqueue 中删除条目的线程实例。
         */
        私有易失性 RefQueuePoll 轮询；
        /**
         * 用于此实例的 Logger 实例。它将包含名称作为后缀
         * 如果使用了该构造函数。
         */
        private static final Logger log = Logger.getLogger(ReferenceTracker.class.getName());
        /**
         * 名称表明这是用于记录和其他分离的实例
         * 需要实例。
         */
        私有最终字符串其中；

        /**
         * 使用传递的名称创建一个新的 ReferenceTracker 实例以区分
         * logging 和 toString() 实现中的实例。
         * @param which 该实例的名称用于区分日志记录等中的多个实例。
         */
        公共参考跟踪器（字符串）{
            这.哪个=哪个；
        }

        /**
         * 创建一个没有限定名称的 ReferenceTracker 新实例。
         */
        公共参考跟踪器（）{
            this.which = null;
        }

        /**
         * 提供对该实例名称的访问。
         * @return 此实例的名称。
         */
        @覆盖
        公共字符串 toString() {
            如果（其中==空）{
                return super.toString()+": ReferenceTracker";
            }
            return super.toString()+": ReferenceTracker["+which+"]";
        }

        /**
         * 子类必须实现此方法。当所有对
         * 关联的持有者对象被删除。
         * @param val 作为第二个参数传递给相应调用 {@link #trackReference(Object, Object) trackReference(T,K)} 的值
         */
        公共抽象无效释放（K val）；

        /** 对持有者对象的引用的引用队列 */
        私有最终 ReferenceQueuerefqueue = new ReferenceQueue();
        /**
         * 已创建并销毁为条目的线程总数
         * 被跟踪。当跟踪引用为零时，没有队列运行。
         */
        私有最终 AtomicInteger tcnt = new AtomicInteger();
        私有 volatile 布尔运行；
        /**
         * 一个线程实现，它轮询 {@link #refqueue} 以随后调用 {@link released(K)}
         * 作为对 T 对象的引用被删除。
         */
        私有类 RefQueuePoll 扩展线程 {
            /**
             * 与此实例关联的线程号。可能有两种情况
             * 此类存在于易失性系统中。如果是这种情况，该值将
             * 在某些日志中可见以区分活动日志。
             */
            私人最终 int mycnt;
            /**
             * 创建这个类的一个实例。
             */
            公共 RefQueuePoll() {
                设置守护进程（真）；
                setName(getClass().getName()+": ReferenceTracker("+which+")");
                mycnt = tcnt.incrementAndGet();
            }
            /**
             * 此方法提供执行`refqueue.remove()`
             * 调用然后调用`released(K)`以让应用程序释放的所有活动
             * 所需资源。
             */
            公共@Override 无效运行（）{
                尝试 {
                    运行（）；
                } 捕捉（可投掷的前） {
                    log.log（完成？Level.INFO：Level.SEVERE，
                        ex.toString()+": phantom ref poll 线程停止", ex);
                } 最后 {
                    运行=假；
                }
            }

            私有易失性布尔完成=假；
            私人无效doRun（）{
                而（！完成）{
                    参考 ref = null;
                    尝试 {
                        运行=真；
                        ref = refqueue.remove();
                        ķctl;
                        同步（参考地图）{
                            ctl = refmap.remove(ref);
                            完成 = actCnt.decrementAndGet() == 0;
                            if(log.isLoggable(Level.FINE)){
                                log.log(Level.FINE, "当前行为 refs={0}, mapsize={1}", new Object[]{actCnt.get(), refmap.size()});
                            }
                            如果（actCnt.get（）！= refmap.size（））{
                                Throwable ex = new IllegalStateException("活动引用计数和映射大小不同步");
                                log.log(Level.SEVERE, ex.toString(), ex);
                            }
                        }

                        if(log.isLoggable(Level.FINER)){
                            log.log(Level.FINER, "参考发布: {0}, dep={1}", new Object[]{ref, ctl});
                        }
                        如果（ctl！= null）{
                            尝试 {
                                释放（ctl）；
                                if(log.isLoggable(Level.FINE)){
                                    log.log(Level.FINE, "发布的依赖对象：{0}", ctl);
                                }
                            } 捕捉（运行时异常前）{
                                log.log(Level.SEVERE, ex.toString(), ex);
                            }
                        }

                    } 捕捉（异常前） {
                        log.log(Level.SEVERE, ex.toString(), ex);
                    } 最后 {
                        如果（参考！=空）{
                            ref.clear();
                        }
                    }
                }

                if(log.isLoggable(Level.FINE)){
                    log.log(Level.FINE, "poll thread {0} shutdown for {1}", new Object[]{mycnt, this});
                }
            }
        }

        /**
         * 活动引用的计数。
         */
        私有最终 AtomicInteger actCnt = new AtomicInteger();
        /**
         * 从 T 引用映射到要用于释放（K）调用的 K 对象
         */
        private final ConcurrentHashMap,K>refmap = new ConcurrentHashMap,K>();
        /**
         * 添加跟踪参考。dep 不应以任何方式引用 ref，除非可能
         * 弱引用。dep 几乎总是 ref 所指的东西。
         * @throws IllegalArgumentException of ref 和 dep 是同一个对象。
         * @param dep 不再引用 ref 时需要清理的依赖对象。
         * @param ref 要跟踪其引用的对象
         */
        公共无效trackReference（T ref，K dep）{
            如果（参考== dep）{
                throw new IllegalArgumentException("引用对象和依赖对象不能相同");
            }
            PhantomReference p = new PhantomReference(ref, refqueue);
            同步（参考地图）{
                refmap.put（p，dep）；
                if(actCnt.getAndIncrement() == 0 || 运行 == false) {
                    if(actCnt.get() > 0 && running == false) {
                        if (log.isLoggable(Level.FINE)) {
                            log.fine("启动停止的幻像 ref 轮询线程");
                        }
                    }
                    轮询 = 新的 RefQueuePoll();
                    poll.start();
                    if(log.isLoggable(Level.FINE)){
                        log.log(Level.FINE, "为 {1} 创建的轮询线程 #{0}", new Object[]{tcnt.get(), this});
                    }
                }
            }
        }

        /**
         * 如果跟踪器所在的 JVM 正在被调用，则可以调用此方法
         * 关闭，或其他上下文正在关闭并跟踪对象
         * 现在应该由跟踪器发布。这种方法会导致
         * {@link #released(Object) deleted(K) } 为每个未完成的引用调用。
         */
        公共无效关机（）{
            利斯特伦；
            // 复制值并清除地图以便释放
            // 只被调用一次，以防 GC 稍后驱逐引用
            同步（参考地图）{
                rem = new ArrayList(refmap.values());
                refmap.clear();
            }
            为（K dep：rem）{
                尝试 {
                    发布（dep）；
                } 捕捉（异常前） {
                    log.log(Level.SEVERE, ex.toString(), ex);
                }
            }
        }
    }

```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-17T07:40:59.920

它可以让你们两个拥有在内存管理方面非常有效的幻象缓存。简单地说，如果您有创建成本高但很少使用的巨大对象，您可以使用幻像缓存来引用它们，并确保它们不会占用更有价值的内存。如果您使用常规引用，则必须手动确保没有对对象的引用。您可以对任何对象进行相同的争论，但您不必手动管理幻像缓存中的引用。只需要小心检查它们是否已被收集。

您也可以使用一个框架（即工厂），其中引用作为幻像引用给出。如果对象很多且寿命很短（即使用然后处置），这将很有用。如果你的程序员认为垃圾收集很神奇，那么清理内存非常方便。

# c++ - 正交变量代码重复问题

> ID：80691
> 
> 赞同：2
> 
> 时间：2008-09-17T07:06:45.400
> 
> 标签：c++, code-duplication

我最近开始重构一些遗留代码并遇到了两个用于绘制坐标网格的函数，问题是这些函数仅在它们处理的正交变量上有所不同，就像这样

```
void DrawScaleX(HDC dc, int step, int x0, int x1, int y0, int y1)
{
    for(int x = x0; x < x1; x += step)
    {
         MoveToEx(dc, x, y0, NULL);
         LineTo(dc, x, y1);
    }
}
void DrawScaleY(HDC dc, int step, int x0, int x1, int y0, int y1)
{
    for(int y = y0; y < y1; y += step)
    {
         MoveToEx(dc, x0, y, NULL);
         LineTo(dc, x1, y);
    }
} 
```

因此，如果我决定添加一些花哨的东西，例如抗锯齿或仅仅更改绘图铅笔或其他任何东西，我将不得不在它们两者中放入相同的代码，这是代码重复，这很糟糕，我们都知道为什么。

我的问题是如何将这两个函数重写为一个函数以避免这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T07:18:39.537

为什么不将 for 循环的主体提取到单独的函数中？然后你可以在提取的函数中做有趣的事情。

```
void DrawScaleX(HDC dc, int step, int x0, int x1, int y0, int y1)
{
    for(int x = x0; x < x1; x += step)
    {
        DrawScale(dc, x, y0, x, y1);
    }
}

void DrawScaleY(HDC dc, int step, int x0, int x1, int y0, int y1)
{
    for(int y = y0; y < y1; y += step)
    {
        DrawScale(dc, x0, y, x1, y);
    }
}

private void DrawScale(HDC dc, int x0, int y0, int x1, int y1)
{
    //Add funny stuff here

    MoveToEx(dc, x0, y0, NULL);
    LineTo(dc, x1, y1);

    //Add funny stuff here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T10:28:21.280

画一条线只是简单地连接两个点，并在特定方向上通过 X 和/或 Y 绘制一个递增 (x0,y0) 和 (x1,y1) 的缩放比例。这归结为，在比例情况下，方向（S）步进发生（可能是两个方向的乐趣）。

```
template< int XIncrement, YIncrement >
struct DrawScale
{
  void operator()(HDC dc, int step, int x0, int x1, int y0, int y1)
  {
    const int deltaX = XIncrement*step;
    const int deltaY = YIncrement*step;
    const int ymax = y1;
    const int xmax = x1;
    while( x0 < xmax && y0 < ymax )
    {
        MoveToEx(dc, x0, y0, NULL);
        LineTo(dc, x1, y1);
        x0 += deltaX;
        x1 += deltaX;
        y0 += deltaY;
        y1 += deltaY;
    }
  }
};
typedef DrawScale< 1, 0 > DrawScaleX;
typedef DrawScale< 0, 1 > DrawScaleY; 
```

模板将完成其工作：在编译时，编译器将删除所有空语句，即关于调用哪个函数的 deltaX 或 deltaY 为 0，并且每个函子中的一半代码消失。

您可以在此 uniq 函数中添加抗锯齿、铅笔内容，并获取编译器正确生成的代码。

这是在类固醇上剪切和粘贴；-)

--ppi

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T07:13:19.097

这是我自己的解决方案

```
 class CoordGenerator
{
public:
    CoordGenerator(int _from, int _to, int _step)
        :from(_from), to(_to), step(_step), pos(_from){}
    virtual POINT GetPoint00() const = 0;
    virtual POINT GetPoint01() const = 0;
    bool Next()
        {
            if(pos > step) return false;
            pos += step;
        }
protected:
    int from;
    int to;
    int step;
    int pos;
};

class GenX: public CoordGenerator
{
public:
    GenX(int x0, int x1, int step, int _y0, int _y1)
        :CoordGenerator(x0, x1, step),y0(_y0), y1(_y1){}
    virtual POINT GetPoint00() const
        {
            const POINT p = {pos, y0};
            return p;
        }
    virtual POINT GetPoint01() const
        {
            const POINT p = {pos, y1};
            return p;
        }
private:
    int y0;
    int y1;
};

class GenY: public CoordGenerator
{
public:
    GenY(int y0, int y1, int step, int _x0, int _x1)
        :CoordGenerator(y0, y1, step),x0(_x0), x1(_x1){}
    virtual POINT GetPoint00() const
        {
            const POINT p = {x0, pos};
            return p;
        }
    virtual POINT GetPoint01() const
        {
            const POINT p = {x1, pos};
            return p;
        }
private:
    int x1;
    int x0;
};

void DrawScale(HDC dc, CoordGenerator* g)
{
    do
    {
        POINT p = g->GetPoint00();
        MoveToEx(dc, p.x, p.y, 0);
        p = g->GetPoint01();
        LineTo(dc, p.x, p.y);
    }while(g->Next());
} 
```

但在我看来，对于这么一个小问题来说太复杂了，所以我仍然期待看到你的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T07:19:19.910

好吧，一个明显的“解决方案”是创建一个函数并添加一个额外的参数（类似枚举的类型）。然后在里面执行 if() 或 switch()，并执行相应的操作。因为嘿，*函数的功能是不同的，所以你必须在**某个地方*做那些不同的动作。

然而，这增加了运行时的复杂性（在运行时检查），而这个地方可以在编译时更好地检查。

我不明白将来在两个（或更多功能）中添加额外参数有什么问题。它是这样的：

1.  为所有函数添加更多参数
2.  编译你的代码，它不会在一堆地方编译，因为它不传递新参数。
3.  通过传递新参数来修复所有调用这些函数的地方。
4.  利润！:)

如果是 C++，当然可以将函数设为模板，而是添加一个额外的参数，添加一个模板参数，然后专门化模板实现来做不同的事情。但在我看来，这只是混淆了这一点。代码变得更难理解了，用更多的参数来扩展它的过程还是*一模一样*的：

1.  添加额外参数
2.  编译代码，它不会在一堆地方编译
3.  修复所有调用该函数的地方

所以你什么也没赢，但让代码更难理解。不是一个有价值的目标，IMO。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T07:20:23.340

我想我会搬家：

```
 MoveToEx(dc, x0, y, NULL);
     LineTo(dc, x1, y); 
```

到他们自己的函数 DrawLine(x0,y0,x0,y0) 中，您可以从每个现有函数中调用该函数。

那么有一个地方可以添加额外的绘图效果吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T07:47:59.077

一些模板... :)

```
void DrawLine(HDC dc, int x0, int y0, int x0, int x1)
{
    // anti-aliasing stuff
    MoveToEx(dc, x0, y0, NULL);
    LineTo(dc, x1, y1);
}

struct DrawBinderX
{
    DrawBinderX(int y0, int y1) : y0_(y0), y1_(y1) {}

    void operator()(HDC dc, int i)
    {
        DrawLine(dc, i, y0_, i, y1_);
    }

private:
    int y0_;
    int y1_;

};

struct DrawBinderY
{
    DrawBinderX(int x0, int x1) : x0_(x0), x1_(x1) {}

    void operator()(HDC dc, int i)
    {
        DrawLine(dc, x0_, i, x1_, i);
    }

private:
    int x0_;
    int x1_;

};

template< class Drawer >
void DrawScale(Drawer drawer, HDC dc, int from, int to, int step)
{
    for (int i = from; i < to; i += step)
    {
         drawer(dc, i);
    }
}

void DrawScaleX(HDC dc, int step, int x0, int x1, int y0, int y1)
{
    DrawBindexX drawer(y0, y1);
    DrawScale(drawer, dc, x0, x1, step);
}

void DrawScaleY(HDC dc, int step, int x0, int x1, int y0, int y1)
{
    DrawBindexY drawer( x0, x1 );
    DrawScale(drawer, dc, y0, y1, step);
} 
```

# java - 自动确定调用者的类名的 Java 记录器

> ID：80692
> 
> 赞同：39
> 
> 时间：2008-09-17T07:06:47.380
> 
> 标签：java, logging, stack-trace

```
public static Logger getLogger() {
    final Throwable t = new Throwable();
    final StackTraceElement methodCaller = t.getStackTrace()[1];
    final Logger logger = Logger.getLogger(methodCaller.getClassName());
    logger.setLevel(ResourceManager.LOGLEVEL);
    return logger;
} 
```

此方法将返回一个记录器，该记录器知道它正在记录的类。有什么反对意见吗？

许多年后：[https ://github.com/yanchenko/droidparts/blob/master/droidparts/src/org/droidparts/util/L.java](https://github.com/yanchenko/droidparts/blob/master/droidparts/src/org/droidparts/util/L.java)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2015-08-21T04:21:27.567

MethodHandles类（从 Java 7 开始）包括一个[Lookup](https://docs.oracle.com/javase/7/docs/api/java/lang/invoke/MethodHandles.html)[类](https://docs.oracle.com/javase/7/docs/api/java/lang/invoke/MethodHandles.Lookup.html)，它可以从静态上下文中找到并返回当前类的名称。考虑以下示例：

```
import java.lang.invoke.MethodHandles;

public class Main {
  private static final Class clazz = MethodHandles.lookup().lookupClass();
  private static final String CLASSNAME = clazz.getSimpleName();

  public static void main( String args[] ) {
    System.out.println( CLASSNAME );
  }
} 
```

运行时会产生：

```
Main 
```

对于记录器，您可以使用：

```
private static Logger LOGGER = 
  Logger.getLogger(MethodHandles.lookup().lookupClass().getSimpleName()); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-19T19:35:43.857

创建堆栈跟踪是一个相对较慢的操作。您的调用者已经知道它所在的类和方法，因此浪费了精力。您的解决方案的这一方面效率低下。

即使您使用静态类信息，也不应为每条消息再次获取 Logger。[来自](http://www.qos.ch/logging/thinkAgain.jsp)Log4j 的作者 Ceki Gülcü：

> 包装类中最常见的错误是对每个日志请求调用 Logger.getLogger 方法。这肯定会对您的应用程序的性能造成严重破坏。真的！！！

这是在类初始化期间获取 Logger 的传统、有效的习惯用法：

```
private static final Logger log = Logger.getLogger(MyClass.class); 
```

请注意，这为层次结构中的每种类型提供了一个单独的 Logger。如果您想出一个`getClass()`在实例上调用的方法，您将看到由基本类型记录的消息显示在子类型的记录器下。也许这在某些情况下是可取的，但我发现它令人困惑（无论如何我倾向于组合而不是继承）。

显然，使用动态类型 via`getClass()`将要求您在每个实例中至少获取一次记录器，而不是像使用静态类型信息的推荐惯用语那样为每个类获取一次。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-17T07:21:05.087

我想它为每个班级增加了很多开销。每个班级都必须“查找”。你创建新的 Throwable 对象来做到这一点......这些 throwable 不是免费的。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-11-10T04:54:49.790

我们实际上在 LogUtils 类中有一些非常相似的东西。是的，这有点恶心，但就我而言，这些优势是值得的。我们想确保我们不会因为它被重复调用而产生任何开销，所以我们的（有点骇人听闻）确保它只能从静态初始化上下文中调用，例如：

```
private static final Logger LOG = LogUtils.loggerForThisClass(); 
```

如果从普通方法或实例初始化程序（即如果上面省略了“静态”）调用它，它将失败，以降低性能开销的风险。方法是：

```
public static Logger loggerForThisClass() {
    // We use the third stack element; second is this method, first is .getStackTrace()
    StackTraceElement myCaller = Thread.currentThread().getStackTrace()[2];
    Assert.equal("<clinit>", myCaller.getMethodName());
    return Logger.getLogger(myCaller.getClassName());
} 
```

任何人问这有什么优势

```
= Logger.getLogger(MyClass.class); 
```

可能永远不必处理从其他地方复制和粘贴该行并忘记更改类名的人，让您处理一个将其所有内容发送到另一个记录器的类。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-08-12T20:44:59.087

假设您要为记录器保留静态引用，这是一个独立的静态单例：

```
public class LoggerUtils extends SecurityManager
{
    public static Logger getLogger()
    {
        String className = new LoggerUtils().getClassName();
        Logger logger = Logger.getLogger(className);
        return logger;
    }

    private String getClassName()
    {
        return getClassContext()[2].getName();
    }
} 
```

用法很好很干净：

```
Logger logger = LoggerUtils.getLogger(); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-17T14:30:57.953

对于您使用它的每个类，无论如何您都必须查找 Logger，因此您不妨在这些类中使用静态 Logger。

```
private static final Logger logger = Logger.getLogger(MyClass.class.getName()); 
```

然后，您只需在需要处理日志消息时引用该记录器。您的方法与静态 Log4J Logger 所做的相同，那么为什么要重新发明轮子呢？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-03-08T09:10:06.000

那么最好的事情就是混合两个。

```
public class LoggerUtil {

    public static Level level=Level.ALL;

    public static java.util.logging.Logger getLogger() {
        final Throwable t = new Throwable();
        final StackTraceElement methodCaller = t.getStackTrace()[1];
        final java.util.logging.Logger logger = java.util.logging.Logger.getLogger(methodCaller.getClassName());
        logger.setLevel(level);

        return logger;
    }
} 
```

然后在每个班级：

```
private static final Logger LOG = LoggerUtil.getLogger(); 
```

在代码中：

```
LOG.fine("debug that !..."); 
```

你得到静态记录器，你可以在每个类中复制和粘贴，没有开销......

阿拉

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-06-23T18:47:45.297

通过阅读该站点上的所有其他反馈，我创建了以下用于 Log4j 的内容：

```
package com.edsdev.testapp.util;

import java.util.concurrent.ConcurrentHashMap;

import org.apache.log4j.Level;
import org.apache.log4j.Priority;

public class Logger extends SecurityManager {

private static ConcurrentHashMap<String, org.apache.log4j.Logger> loggerMap = new ConcurrentHashMap<String, org.apache.log4j.Logger>();

public static org.apache.log4j.Logger getLog() {
    String className = new Logger().getClassName();
    if (!loggerMap.containsKey(className)) {
        loggerMap.put(className, org.apache.log4j.Logger.getLogger(className));
    }
    return loggerMap.get(className);
}
public String getClassName() {
    return getClassContext()[3].getName();
}
public static void trace(Object message) {
    getLog().trace(message);
}
public static void trace(Object message, Throwable t) {
    getLog().trace(message, t);
}
public static boolean isTraceEnabled() {
    return getLog().isTraceEnabled();
}
public static void debug(Object message) {
    getLog().debug(message);
}
public static void debug(Object message, Throwable t) {
    getLog().debug(message, t);
}
public static void error(Object message) {
    getLog().error(message);
}
public static void error(Object message, Throwable t) {
    getLog().error(message, t);
}
public static void fatal(Object message) {
    getLog().fatal(message);
}
public static void fatal(Object message, Throwable t) {
    getLog().fatal(message, t);
}
public static void info(Object message) {
    getLog().info(message);
}
public static void info(Object message, Throwable t) {
    getLog().info(message, t);
}
public static boolean isDebugEnabled() {
    return getLog().isDebugEnabled();
}
public static boolean isEnabledFor(Priority level) {
    return getLog().isEnabledFor(level);
}
public static boolean isInfoEnabled() {
    return getLog().isInfoEnabled();
}
public static void setLevel(Level level) {
    getLog().setLevel(level);
}
public static void warn(Object message) {
    getLog().warn(message);
}
public static void warn(Object message, Throwable t) {
    getLog().warn(message, t);
} 
```

}

现在在您的代码中，您只需要

```
Logger.debug("This is a test"); 
```

或者

```
Logger.error("Look what happened Ma!", e); 
```

如果您需要更多地接触 log4j 方法，只需从上面列出的 Logger 类中委派它们。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-17T07:18:58.820

您当然可以使用具有适当模式布局的 Log4J：

> 例如，对于类名“org.apache.xyz.SomeClass”，模式 %C{1} 将输出“SomeClass”。

[http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-17T07:46:49.877

我更喜欢为每个类创建一个（静态）记录器（带有明确的类名）。我比按原样使用记录器。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-19T20:58:52.963

您不需要创建新的 Throwable 对象。你可以打电话 `Thread.currentThread().getStackTrace()[1]`

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-09-12T08:57:55.743

一个不错的选择是使用（其中一个）lombok 日志注释： [https ://projectlombok.org/features/Log.html](https://projectlombok.org/features/Log.html)

它生成与当前类对应的日志语句。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-08-14T12:41:32.173

我在大多数课程的开头都有以下行。

```
 private static final Logger log = 
     LoggerFactory.getLogger(new Throwable().getStackTrace()[0].getClassName()); 
```

是的，第一次创建该类的对象时会有一些开销，但我主要在 webapps 中工作，因此在 20 秒的启动中添加微秒并不是真正的问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-10-10T15:59:09.497

Google Flogger logging API 支持这个，例如

```
private static final FluentLogger logger = FluentLogger.forEnclosingClass(); 
```

有关详细信息，请参阅[https://github.com/google/flogger 。](https://github.com/google/flogger)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-02-20T13:13:41.973

从 Java 7 开始，一个很好的方法：

```
private static final Logger logger = LoggerFactory.getLogger(MethodHandles.lookup().lookupClass()); 
```

记录器可以`static`，那很好。这里它使用 SLF4J API

```
import org.slf4j.Logger;
import org.slf4j.LoggerFactory; 
```

但原则上可以与任何日志框架一起使用。如果记录器需要一个字符串参数添加`toString()`

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-06-20T10:30:12.513

**简单而琐碎的 OLD SCHOOL：**

只需创建您自己的类并传递类名、方法名+注释（如果类/方法更改，它们会自动重构 Shift+F6）

```
public class MyLogs {    
    public static void LOG(String theClass, String theMethod, String theComment) {
        Log.d("MY_TAG", "class: " + theClass + " meth : " + theMethod + " comm : " + theComment);
    }
} 
```

并且只需在应用程序的任何地方使用它（不需要上下文，不需要初始化，不需要额外的库，也不需要查找）——可以用于任何编程语言！

```
MyLogs.LOG("MainActivity", "onCreate", "Hello world"); 
```

这将在您的控制台中打印：

> MY_TAG 类：MainActivity 方法：onCreate comm：Hello world

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T07:39:18.630

为什么不？

```
public static Logger getLogger(Object o) {
  final Logger logger = Logger.getLogger(o.getClass());
  logger.setLevel(ResourceManager.LOGLEVEL);
  return logger;
} 
```

然后当你需要一个类的记录器时：

```
getLogger(this).debug("Some log message") 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T09:35:22.390

这种机制在运行时会付出很多额外的努力。

如果您使用 Eclipse 作为 IDE，请考虑使用[Log4e](http://log4e.jayefem.de/)。这个方便的插件将使用您最喜欢的日志框架为您生成记录器声明。编码时的工作量要多一点，但运行时的工作量要少**得多。**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-17T14:33:14.250

除非你*真的*需要你的 Logger 是静态的，否则你可以使用

```
final Logger logger = LoggerFactory.getLogger(getClass()); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-08-13T15:29:07.913

请参阅我的静态 getLogger() 实现（在 JDK 7 上使用与默认 java Logger doit 相同的“sun.*”魔法）

*   注意没有丑陋日志属性的静态日志记录方法（使用静态导入）...

    导入静态 my.pakg.Logger.*；

并且它们的速度相当于原生 Java 实现（检查了 100 万条日志跟踪）

```
package my.pkg;

import java.text.MessageFormat;
import java.util.Arrays;
import java.util.IllegalFormatException;
import java.util.logging.Level;
import java.util.logging.LogRecord;

import sun.misc.JavaLangAccess;
import sun.misc.SharedSecrets;

public class Logger {
static final int CLASS_NAME = 0;
static final int METHOD_NAME = 1;

// Private method to infer the caller's class and method names
protected static String[] getClassName() {
    JavaLangAccess access = SharedSecrets.getJavaLangAccess();
    Throwable throwable = new Throwable();
    int depth = access.getStackTraceDepth(throwable);

    boolean lookingForLogger = true;
    for (int i = 0; i < depth; i++) {
        // Calling getStackTraceElement directly prevents the VM
        // from paying the cost of building the entire stack frame.
        StackTraceElement frame = access.getStackTraceElement(throwable, i);
        String cname = frame.getClassName();
        boolean isLoggerImpl = isLoggerImplFrame(cname);
        if (lookingForLogger) {
            // Skip all frames until we have found the first logger frame.
            if (isLoggerImpl) {
                lookingForLogger = false;
            }
        } else {
            if (!isLoggerImpl) {
                // skip reflection call
                if (!cname.startsWith("java.lang.reflect.") && !cname.startsWith("sun.reflect.")) {
                    // We've found the relevant frame.
                    return new String[] {cname, frame.getMethodName()};
                }
            }
        }
    }
    return new String[] {};
    // We haven't found a suitable frame, so just punt.  This is
    // OK as we are only committed to making a "best effort" here.
}

protected static String[] getClassNameJDK5() {
    // Get the stack trace.
    StackTraceElement stack[] = (new Throwable()).getStackTrace();
    // First, search back to a method in the Logger class.
    int ix = 0;
    while (ix < stack.length) {
        StackTraceElement frame = stack[ix];
        String cname = frame.getClassName();
        if (isLoggerImplFrame(cname)) {
            break;
        }
        ix++;
    }
    // Now search for the first frame before the "Logger" class.
    while (ix < stack.length) {
        StackTraceElement frame = stack[ix];
        String cname = frame.getClassName();
        if (isLoggerImplFrame(cname)) {
            // We've found the relevant frame.
            return new String[] {cname, frame.getMethodName()};
        }
        ix++;
    }
    return new String[] {};
    // We haven't found a suitable frame, so just punt.  This is
    // OK as we are only committed to making a "best effort" here.
}

private static boolean isLoggerImplFrame(String cname) {
    // the log record could be created for a platform logger
    return (
            cname.equals("my.package.Logger") ||
            cname.equals("java.util.logging.Logger") ||
            cname.startsWith("java.util.logging.LoggingProxyImpl") ||
            cname.startsWith("sun.util.logging."));
}

protected static java.util.logging.Logger getLogger(String name) {
    return java.util.logging.Logger.getLogger(name);
}

protected static boolean log(Level level, String msg, Object... args) {
    return log(level, null, msg, args);
}

protected static boolean log(Level level, Throwable thrown, String msg, Object... args) {
    String[] values = getClassName();
    java.util.logging.Logger log = getLogger(values[CLASS_NAME]);
    if (level != null && log.isLoggable(level)) {
        if (msg != null) {
            log.log(getRecord(level, thrown, values[CLASS_NAME], values[METHOD_NAME], msg, args));
        }
        return true;
    }
    return false;
}

protected static LogRecord getRecord(Level level, Throwable thrown, String className, String methodName, String msg, Object... args) {
    LogRecord record = new LogRecord(level, format(msg, args));
    record.setSourceClassName(className);
    record.setSourceMethodName(methodName);
    if (thrown != null) {
        record.setThrown(thrown);
    }
    return record;
}

private static String format(String msg, Object... args) {
    if (msg == null || args == null || args.length == 0) {
        return msg;
    } else if (msg.indexOf('%') >= 0) {
        try {
            return String.format(msg, args);
        } catch (IllegalFormatException esc) {
            // none
        }
    } else if (msg.indexOf('{') >= 0) {
        try {
            return MessageFormat.format(msg, args);
        } catch (IllegalArgumentException exc) {
            // none
        }
    }
    if (args.length == 1) {
        Object param = args[0];
        if (param != null && param.getClass().isArray()) {
            return msg + Arrays.toString((Object[]) param);
        } else if (param instanceof Throwable){
            return msg;
        } else {
            return msg + param;
        }
    } else {
        return msg + Arrays.toString(args);
    }
}

public static void severe(String msg, Object... args) {
    log(Level.SEVERE, msg, args);
}

public static void warning(String msg, Object... args) {
    log(Level.WARNING, msg, args);
}

public static void info(Throwable thrown, String format, Object... args) {
    log(Level.INFO, thrown, format, args);
}

public static void warning(Throwable thrown, String format, Object... args) {
    log(Level.WARNING, thrown, format, args);
}

public static void warning(Throwable thrown) {
    log(Level.WARNING, thrown, thrown.getMessage());
}

public static void severe(Throwable thrown, String format, Object... args) {
    log(Level.SEVERE, thrown, format, args);
}

public static void severe(Throwable thrown) {
    log(Level.SEVERE, thrown, thrown.getMessage());
}

public static void info(String msg, Object... args) {
    log(Level.INFO, msg, args);
}

public static void fine(String msg, Object... args) {
    log(Level.FINE, msg, args);
}

public static void finer(String msg, Object... args) {
    log(Level.FINER, msg, args);
}

public static void finest(String msg, Object... args) {
    log(Level.FINEST, msg, args);
}

public static boolean isLoggableFinest() {
    return isLoggable(Level.FINEST);
}

public static boolean isLoggableFiner() {
    return isLoggable(Level.FINER);
}

public static boolean isLoggableFine() {
    return isLoggable(Level.FINE);
}

public static boolean isLoggableInfo() {
    return isLoggable(Level.INFO);
}

public static boolean isLoggableWarning() {
    return isLoggable(Level.WARNING);
}
public static boolean isLoggableSevere() {
    return isLoggable(Level.SEVERE);
}

private static boolean isLoggable(Level level) {
    return log(level, null);
}

} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-02-03T07:58:56.927

看看[jcabi-log](http://www.jcabi.com/jcabi-log/)[`Logger`](http://www.jcabi.com/jcabi-log/apidocs-0.7.7/com/jcabi/log/Logger.html)中的类。它完全符合您的要求，提供一组静态方法。您不再需要将记录器嵌入到类中：

```
import com.jcabi.log.Logger;
class Foo {
  public void bar() {
    Logger.info(this, "doing something...");
  }
} 
```

`Logger`将所有日志发送到 SLF4J，您可以在运行时将其重定向到任何其他日志记录工具。

# xml - YAML 最适合哪种类型的应用程序/使用？

> ID：80693
> 
> 赞同：7
> 
> 时间：2008-09-17T07:06:48.863
> 
> 标签：xml, markup, yaml

为什么要选择[YAML](http://yaml.org/)而不是 XML 或任何其他格式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T07:17:11.913

我同意塞尔吉奥的观点；YAML 提供了一种易于人类编辑的格式，同时也是一种清晰地表示数据结构的好方法。

YAML 往往更具人类可读性，IMO。

YAML 更像是一种数据序列化技术，而不是一种标记语言。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T07:14:43.323

[YAML](http://www.yaml.org/)的主要优点是可读性和紧凑性。哦，它在各种平台和语言中得到广泛支持。

YAML 在 Ruby 社区中非常流行，在 Rails 和 Merb 中，它主要优先用于 XML 配置文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T07:08:32.387

如果需要人工编辑或创建文档，我会选择 YAML。只是一个想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T02:10:08.347

> YAML 最适合哪种类型的应用程序/使用？

这很难明确回答。相反，我将尝试提供一些 YAML*不*适合的示例（以我的拙见）。

```
<name type="string">Orion</name>
<age type="integer">26</age> 
```

这是在 XML 中混合属性和值很有用的情况。YAML 没有属性，因此您必须使用类型推断来确定什么是日期/整数/字符串/等 - 这对于复杂或用户定义的类型会失败。

```
<user>
  .... 10 lines of stuff
  <sub-user>
    ...15 more lines of stuff
  </sub-user>
  .... 10 more lines of stuff belonging to user
</user> 
```

在这种情况下，XML 中的结束标记提供了很多好处。如果您要在 YAML 中格式化上述数据，仅使用缩进来提供“范围”，那么很难判断事情的开始和结束位置。

为了更好地衡量，这是来自[yaml.org 官方 yaml 规范的引用](http://www.yaml.org/spec/1.1/#id856927)

> YAML 主要是一种数据序列化语言。XML 被设计为向后兼容标准通用标记语言 (SGML)，因此有许多 YAML 不共享的设计约束。继承 SGML 的传统，XML 旨在支持结构化文档，其中 YAML 更紧密地针对数据结构和消息传递。XML 是许多领域的先驱，而 YAML 是从 XML 和其他技术中吸取教训的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T02:16:05.327

我使用 YAML 作为编写特定领域语言的廉价且简单的替代品（特别是在其他开发人员将进行维护的情况下；我不确定当非开发人员维护它时我会使用它）

# java - Hibernate 工具和不断变化的数据库

> ID：80697
> 
> 赞同：1
> 
> 时间：2008-09-17T07:07:29.657
> 
> 标签：java, database, hibernate, hibernate-tools

我目前正在使用 Hibernate Tools 3.1；我自定义了命名约定和 DAO 模板。数据库（SQL Server 2005）处于早期开发阶段，我负责重建映射、实体、DAO、配置等。每次我必须对表进行逆向工程，因此我会丢失对映射（*.hbm.xml 文件）所做的所有自定义，例如调整**标识**列、选择**equals**和**toString**中使用的字段。我正在考虑将 diff XML 写入文件并将其“合并”到生成的映射中（请参阅[我的相关问题](https://stackoverflow.com/questions/80609/merge-xml-documents)），但我想知道......是否有任何最佳实践/工具来处理这些烦人的、不可避免的、关键的任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T07:21:11.030

我强烈建议不要进行持续的逆向工程。逆向工程是一件好事，但需要将更改作为对 hbm 和数据库的更改进行管理。

我们使用迁移来管理数据库更改，并将相关更改包含在 hbm.xml 中。如果 Hibernate 有它（我相信它有），您可能想要查看注释而不是 hbm，它们可以更容易维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-22T08:52:04.587

这已经晚了两年半，但我会提出不同的意见。您应该能够通过 hibernate.reveng.xml 文件或自定义 ReverseEngineeringStrategy 对映射文件进行所需的任何自定义。对于类本身，您应该始终生成基类并使用包含自定义代码的类扩展它们。

例如，生成 com.company.vo.generated.CustomerGenerated 并使用 com.company.vo.custom.Customer 对其进行扩展。代码生成应该覆盖生成的包中的所有类，但永远不会覆盖自定义包中的类（尽管您可以让 Hibernate 工具在目标目录中生成这些自定义类，以便您可以根据需要将空白复制并粘贴到自定义目录中）。这样，您可以覆盖自定义类中的 equals、toString 等方法，并且在重新生成时不会丢失您的更改。另请注意，最佳做法是不要将生成的代码签入 SCM。

这个网站上有一些很好的例子，说明如何使用 Maven、Hibernate3 插件和构建助手插件来实现这一点。其中大部分都有 Pascal Thivent 非常有用的答案。这种方法对我来说效果很好，虽然有一点学习曲线，但能够使用单个 Maven 命令将数据库更改传播到应用程序是一件很棒的事情。

# sql - 查询以查找列的 nᵗʰ 最大值

> ID：80706
> 
> 赞同：33
> 
> 时间：2008-09-17T07:10:23.753
> 
> 标签：sql, database

我想找到一列的 2 ^(nd) , 3 ^(rd) , ... n ^(th)最大值。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-15T06:39:38.273

考虑下面的 Employee 表，其中有一列表示薪水。

```
+------+
| 萨尔 |
+------+
| 3500 |
| 2500 |
| 2500 |
| 5500 |
| 7500 |
+------+

```

以下查询将返回第 N 个最大值元素。

```
select SAL from EMPLOYEE E1 where 
 (N - 1) = (select count(distinct(SAL)) 
            from EMPLOYEE E2 
            where E2.SAL > E1.SAL ) 
```

例如。当需要第二个最大值时，

```
 select SAL from EMPLOYEE E1 where 
     (2 - 1) = (select count(distinct(SAL)) 
                from EMPLOYEE E2 
                where E2.SAL > E1.SAL ) 
```

```
+------+
| 萨尔 |
+------+
| 5500 |
+------+

```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-17T07:15:02.480

你没有指定哪个数据库，你可以在 MySQL 上做

```
SELECT column FROM table ORDER BY column DESC LIMIT 7,10; 
```

会跳过前 7 个，然后让你获得下一个最高的 10 个。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-17T07:12:50.940

您可以将列排序为降序格式，然后从第 n 行获取值。

编辑：：

根据评论请求更新。***警告***完全未经测试！

```
SELECT DOB FROM (SELECT DOB FROM USERS ORDER BY DOB DESC) WHERE ROWID = 6 
```

像上面这样的东西应该适用于甲骨文......你可能必须首先获得正确的语法！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-17T08:21:45.423

同样，您可能需要修复您的数据库，但如果您希望数据集中的前第二个值可能具有重复的值，您还需要执行一个组：

```
SELECT column 
FROM table 
WHERE column IS NOT NULL 
GROUP BY column 
ORDER BY column DESC 
LIMIT 5 OFFSET 2; 
```

会跳过前两个，然后会让你获得下一个最高的五个。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-17T12:32:09.377

纯 SQL（注意：我建议使用特定于您的 DBMS 的 SQL 功能，因为它可能会更有效）。这将为您提供第 n+1 个最大值（要获得最小值，请翻转 <）。如果您有重复项，请将其设为 COUNT(DISTINCT VALUE)..

```
select id from table order by id desc limit 4 ;
+------+
| id   |
+------+
| 2211 | 
| 2210 | 
| 2209 | 
| 2208 | 
+------+

SELECT yourvalue
  FROM yourtable t1
 WHERE EXISTS( SELECT COUNT(*)
                 FROM yourtable t2
                WHERE t1.id       <> t2.id
                  AND t1.yourvalue < t2.yourvalue
               HAVING COUNT(*) = 3 )

+------+
| id   |
+------+
| 2208 | 
+------+ 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-20T05:14:30.067

（表名=学生，列名=标记）

```
select * from(select row_number() over (order by mark desc) as t,mark from student group by mark) as td where t=4 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-23T06:23:48.227

您可以使用以下查询找到列的第 n 个最大值：

```
SELECT * FROM TableName a WHERE
    n = (SELECT count(DISTINCT(b.ColumnName)) 
    FROM TableName b WHERE a.ColumnName <=b.ColumnName); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-09-25T15:08:13.740

```
select column_name from table_name 
order by column_name desc limit n-1,1; 
```

其中 n = 1, 2, 3,....第 n 个最大值。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T12:54:51.803

这是Oracle的一种方法。此示例获得第 9 个最高值。只需将 9 替换为包含您要查找的位置的绑定变量。

```
 select created from (
     select created from (
       select created from user_objects
         order by created desc
       )
       where rownum <= 9
       order by created asc
     )
     where rownum = 1 
```

如果您想要第 n 个唯一值，您可以在最里面的查询块上添加 DISTINCT。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-09T15:08:18.767

自己在寻找答案时挖出了这个问题，这似乎适用于 SQL Server 2005（源自[Blorgbeard 的解决方案](https://stackoverflow.com/questions/80706/query-to-find-nth-max-value-of-a-column/80771#80771)）：

```
SELECT MIN(q.col1) FROM (
    SELECT
        DISTINCT TOP n col1
        FROM myTable
        ORDER BY col1 DESC
) q; 
```

实际上，即 a `SELECT MIN(q.someCol) FROM someTable q`，查询检索到的表的前 n 个`SELECT DISTINCT...`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-11-13T15:54:50.067

```
Select max(sal) 
from table t1 
where N (select max(sal) 
        from table t2 
        where t2.sal > t1.sal) 
```

找到第 N 个最大萨尔。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-15T08:02:24.370

```
SELECT * FROM tablename 
WHERE columnname<(select max(columnname) from tablename) 
order by columnname desc limit 1 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-11-28T11:24:50.517

这是从列中获取 nth Highest 的查询，将 n=0 表示为第二高，n=1 表示第三高，依此类推...

```
 SELECT * FROM TableName
 WHERE ColomnName<(select max(ColomnName) from TableName)-n order by ColomnName desc limit 1; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-09-20T13:00:21.800

**`Salary`简单的 SQL 查询以获取表中具有 Nth MAX 的员工详细信息`Employee`。**

```
sql> select * from Employee order by salary desc LIMIT 1 OFFSET <N - 1>; 
```

*将表结构视为：*

> 员工（id [int 主键 auto_increment]，name [varchar(30)]，salary [int]）；

**例子：**

如果您需要`MAX`上表中的第三薪水，则查询将是：

```
sql> select * from Employee order by salary desc LIMIT 1 OFFSET 2; 
```

**相似地：**

如果您需要`MAX`上表中的第 8 个薪水，则查询将是：

```
sql> select * from Employee order by salary desc LIMIT 1 OFFSET 7; 
```

> **注意：** 当您必须获得第*N 个* `MAX`值时，您应该给出`OFFSET`as *(N - 1)*。

*像这样你可以在工资升序的情况下做同样的操作。*

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-08-07T09:53:54.717

**mysql查询**： *假设我想从员工表中找出第n个最大薪水*

```
select salary 
form employee
order by salary desc
limit n-1,1 ; 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-17T07:22:11.370

在 SQL Server 中，只需执行以下操作：

```
select distinct top n+1 column from table order by column desc 
```

然后扔掉第一个值，如果你不需要它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T13:27:57.637

对于 SQL 2005：

```
SELECT col1 from 
     (select col1, dense_rank(col1) over (order by col1 desc) ranking 
     from t1) subq where ranking between 2 and @n 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T19:02:03.573

另一个使用分析函数的 Oracle：

```
select distinct col1 --distinct is required to remove matching value of column
from 
( select col1, dense_rank() over (order by col1 desc) rnk
  from tbl
)
where rnk = :b1 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-02T16:46:41.620

```
select sal,ename from emp e where
 2=(select count(distinct sal) from emp  where e.sal<=emp.sal) or
 3=(select count(distinct sal) from emp  where e.sal<=emp.sal) or
 4=(select count(distinct sal) from emp  where e.sal<=emp.sal) order by sal desc; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-12-27T12:30:08.443

MySQL：

```
select distinct(salary) from employee order by salary desc limit (n-1), 1; 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-09-07T12:48:14.443

答案：前二：

```
select * from (select * from deletetable   where rownum <=2 order by rownum desc) where rownum <=1 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-11-20T08:10:28.957

（表名=学生，列名=马克）：

```
select *
from student 
where mark=(select mark 
            from(select row_number() over (order by mark desc) as t,
                 mark 
                 from student group by mark) as td 
            where t=2) 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-07-26T07:18:59.073

我认为下面的查询将在 oracle sql 上完美运行......我自己测试过......

与此查询相关的信息：此查询使用两个名为的表，`employee`并且`department`员工中的列名为：（`name`员工姓名），`dept_id`（员工和部门通用），`salary`

以及部门表中的列：（`dept_id`对于员工表也很常见），`dept_name`

```
SELECT
  tab.dept_name,MIN(tab.salary) AS Second_Max_Sal FROM (
    SELECT e.name, e.salary, d.dept_name, dense_rank() over (partition BY  d.dept_name          ORDER BY e.salary)  AS   rank FROM department d JOIN employee e USING (dept_id) )  tab
 WHERE
   rank  BETWEEN 1 AND 2
 GROUP BY
   tab.dept_name 
```

谢谢

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-12-17T09:38:03.003

```
Select min(fee) 
from fl_FLFee 
where fee in (Select top 4 Fee from fl_FLFee order by 1 desc) 
```

用 N 更改数字四。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-07-17T10:40:05.160

你可以像这样简化

```
SELECT MIN(Sal) FROM TableName
WHERE Sal IN
(SELECT TOP 4 Sal FROM TableName ORDER BY Sal DESC) 
```

如果 Sal 包含重复值，则使用此

```
SELECT MIN(Sal) FROM TableName
WHERE Sal IN
(SELECT distinct TOP 4 Sal FROM TableName ORDER BY Sal DESC) 
```

4 将是第 n 个值，它可以是任何最高值，例如 5 或 6 等。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-01-01T21:20:40.300

在 PostgreSQL 中，从 Employee 表中找到第 N 个最大的薪水。

```
SELECT * FROM Employee WHERE salary in 
(SELECT salary FROM Employee ORDER BY salary DESC LIMIT N) 
ORDER BY salary ASC LIMIT 1; 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-10-01T12:28:30.057

在 SQL Server 中查找特定列的第 N 个最大值的解决方案：

员工表：

![员工表](https://i.stack.imgur.com/nMqUu.jpg)

销售表：

![销售表](https://i.stack.imgur.com/SqdMi.jpg)

员工表数据：

```
==========
Id  name
=========
6   ARSHAD M
7   Manu
8   Shaji 
```

销售表数据：

```
=================
id  emp_id   amount
=================
1   6        500
2   7        100
3   8        100
4   6        150
5   7        130
6   7        130
7   7        330 
```

查询查找销售额最高/第**N**高的员工的详细信息

```
select * from (select E.Id,E.name,SUM(S.amount) AS 'total_amount' from employee E INNER JOIN Sale S on E.Id=S.emp_id group by S.emp_id,E.Id,E.name ) AS T1 WHERE(0)=( select COUNT(DISTINCT(total_amount)) from(select E.Id,E.name,SUM(S.amount) AS 'total_amount' from employee E INNER JOIN Sale S on E.Id=S.emp_id group by S.emp_id,E.Id,E.name )AS T2 WHERE(T1.total_amount<T2.total_amount) ); 
```

在**WHERE(0)**中，将 0 替换为 n-1

结果：

```
========================
id  name    total_amount
========================
7   Manu    690 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2012-09-03T03:04:08.003

表员工

```
salary 
1256
1256
2563
8546
5645 
```

您通过此查询找到第二个最大值

```
select salary 
from employee 
where salary=(select max(salary) 
                from employee 
                where salary <(select max(salary) from employee)); 
```

您通过此查询找到第三个最大值

```
select salary 
from employee 
where salary=(select max(salary) 
                from employee 
                where salary <(select max(salary) 
                                from employee 
                                where salary <(select max(salary)from employee))); 
```

# servlets - servlet 不在根应用程序的 servlet 上下文中

> ID：80714
> 
> 赞同：2
> 
> 时间：2008-09-17T07:11:49.087
> 
> 标签：servlets, glassfish

我有一个战争文件，我必须在 glassfish 上以 root 身份部署。成功部署使用“/”作为上下文根的应用程序。但是当我尝试通过[http://localhost/](http://localhost/)运行该应用程序时，它会抛出一个 503 表示请求的 service() 当前不可用。日志文件 server.log 有错误提示“javax.servlet.ServletException：站点树不在根 Web 应用程序的 servlet 上下文中”。我没有这个应用程序的源代码。这是我可以尝试解决的配置问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T15:41:34.827

部署到“/”对于将 webapp 放置在根上下文中是正确的。另一种部署到根目录的方法是将您的 webapp 设置为“virtual-server”条目中的“default-web-module”。503 错误是您的 servlet 有问题。假设 glassfish v2，您需要在 glassfish domain.xml 中提高日志记录级别。查找标签“module-log-levels”并将“root”、“server”和“web-container”元素设置为“ALL”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T08:59:18.687

I can't guarantee this, but try undeploying, then renaming the ROOT folder and then deploying again.

# sql-server - 如何同步存在于各种（未联网）SQL Server 2005 实例中的数据库

> ID：80721
> 
> 赞同：0
> 
> 时间：2008-09-17T07:13:09.817
> 
> 标签：sql-server

我正在开发一个在各种独立服务器上运行的数据库应用程序。每台服务器都运行具有相同数据库的 SQL Server 2005 实例。我们将拥有一个主服务器，它是信息的最终来源，以及分布在各处的各种“客户端”服务器（没有任何类型的网络连接）。该客户端服务器将不时返回（假设每周一次）以与主服务器同步。简单地说，过程将是。

1）使用来自客户端服务器的所有修改更新主服务器上的数据库（考虑到不覆盖由不同客户端服务器的更新过程所做的更改[这将更新同一主服务器]）

2) 将主服务器数据库的更新版本复制到客户端服务器。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T07:21:52.977

MS SQL 集成服务可能会有所帮助：

[http://www.microsoft.com/sql/technologies/integration/default.mspx](http://www.microsoft.com/sql/technologies/integration/default.mspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T07:30:47.933

还要检查[数据库复制](http://msdn.microsoft.com/en-us/library/ms151198(SQL.90).aspx)。也检查[Master-Remote](http://msdn.microsoft.com/en-us/library/ms152761(SQL.90).aspx)部分。

# rubygems - 在linux上安装warbler gem的问题

> ID：80726
> 
> 赞同：1
> 
> 时间：2008-09-17T07:13:52.433
> 
> 标签：rubygems, jruby

```
> jruby -S gem install warbler
JRuby limited openssl loaded. gem install jruby-openssl for full support.
Successfully installed warbler-0.9.11
1 gem installed
Installing ri documentation for warbler-0.9.11...
Installing RDoc documentation for warbler-0.9.11...
> jruby -S warble
<snip>/jruby-1.1.4/bin/warble:1: undefined method `warble' for JRuby::Commands:Class (NoMethodError) 
```

为什么我在我的 jruby bin 目录中没有得到 warbler 命令的任何想法？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:59:20.720

我真正能想到的唯一一件事是确保您的 JRuby 实例默认使用 gems。我在使用 gems 时遇到了几次这个问题，我忘记设置环境变量或将 switch 传递给 Ruby。我不知道 JRuby 的情况是否有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-15T08:56:40.833

您的路径中应该有 warble，warble 二进制文件位于 gems 主目录的 bin 目录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-10T17:42:39.667

你试过了`gem install warbler`吗？它对我来说就像魅力一样-

```
C:\>gem install warbler
JRuby limited openssl loaded. gem install jruby-openssl for full support.
http://wiki.jruby.org/wiki/JRuby_Builtin_OpenSSL
Successfully installed jruby-jars-1.3.1
Successfully installed warbler-0.9.14
2 gems installed
Installing ri documentation for jruby-jars-1.3.1...
Installing ri documentation for warbler-0.9.14...
Installing RDoc documentation for jruby-jars-1.3.1...
Installing RDoc documentation for warbler-0.9.14... 
```

# windows - Windows Server 2003 - 像在 Windows XP 中一样通过 RDP 共享当前桌面？

> ID：80756
> 
> 赞同：1
> 
> 时间：2008-09-17T07:19:20.223
> 
> 标签：windows, windows-server-2003

不幸的是，由于 Windows XP 的内存限制，我不得不在我的 32 位工作站上使用 Windows Server 2003。

在 Windows XP 中，当您通过远程桌面连接时，我登录的当前会话会立即在远程桌面上共享。我可以看到我在工作站上打开的所有应用程序，并且可以继续处理我打开的应用程序。

然而，在 Windows 2003 Server 上，每个远程桌面连接都会获得一个新会话。没有打开任何应用程序。所以我必须使用任务管理器并手动连接到我现有的会话来查看打开的应用程序。

是否可以更改此设置以使 Windows 2003 Servers 与 Windows XP 完全一样？我不需要允许多个用户同时连接到盒子。我什至想阻止这种情况，因为它被用作工作站并且不想让其他域用户在我的工作站上启动应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T04:50:31.050

登录到 Windows 2003 服务器上的任何会话。转到管理工具->终端服务配置->服务器设置->将每个用户限制为一个会话（选中此框）

使用 RDP 再次登录，一切顺利。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T07:24:00.257

秘诀是使用 /console 命令启动 Windows 终端服务器客户端：

mstsc.exe /控制台

这会将您连接到现有的 cosole 会话，而不是将您连接到新会话。

XP 默认执行此操作，因为它仅支持单个（控制台）会话。Windows Server 支持多个会话（取决于版本和许可），因此当您想要连接到现有控制台会话时需要指定 /console。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T07:22:45.487

您可以运行 MSTSC /admin 或 MSTSC /console，具体取决于您安装的版本，然后将连接到控制台会话

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T17:26:29.640

mstsc.exe /管理员

# c# - 当其中一种类型发生更改时，如何转换类型化数据集方案？

> ID：80766
> 
> 赞同：1
> 
> 时间：2008-09-17T07:21:38.000
> 
> 标签：c#, ado.net, dataset

我得到了一个类型化（未连接）的数据集，以及使用该数据集创建的许多记录（二进制序列化）。我已经为其中一种类型添加了一个属性，我想用新数据集转换旧记录。我知道如何加载它们：使用旧模式 dll 为 BinaryFormatter 提供自定义绑定器。问题是如何将旧类型的对象转换为新类型的对象 - 两种类型具有相同的名称，但新类型具有更多属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T08:49:25.777

If the only difference between the existing dataset and the new one is an added field then you can "upgrade" them by writing out the old ones to XML and then reading that into the new ones. The value of the added field will be DBNull.

```
MyDataSet myDS = new MyDataSet();
MyDataSet.MyTableRow row1 = myDS.MyTable.NewMyTableRow();
row1.Name = "Brownie";
myDS.MyTable.Rows.Add(row1);

MyNewDataSet myNewDS = new MyNewDataSet();

using(MemoryStream ms = new MemoryStream()){
    myDS.WriteXml(ms);
    ms.Position = 0;
    myNewDS.ReadXml(ms);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T08:42:23.110

你能让新类继承旧类吗？如果是这样，也许您可​​以通过强制转换简单地反序列化为新的。

如果不是，另一种可能的解决方案是实现批处理操作，其中您在不同的命名空间中包含对旧类和新类的引用，水合旧对象，对新类的对象执行深度复制，并序列化新对象.

# xquery - XQuery 是如何实际使用的？

> ID：80770
> 
> 赞同：7
> 
> 时间：2008-09-17T07:22:09.857
> 
> 标签：xquery

我在网站上阅读了很多 XQuery 教程。几乎所有人都在教我 XQuery 语法。假设我已经了解 XQuery 语法，我将如何在我的网站上实际实现 XQuery？

例如，我有**book.xml**：

```
<?xml version="1.0" encoding="iso-8859-1" ?>
<books>
<book>
   <title>Doraemon</title>
   <authorid>1</authorid>
</book>
<book>
   <title>Ultraman</title>
   <authorid>2</authorid>
</book>
</books> 
```

然后，我有**author.xml**

```
<?xml version="1.0" encoding="iso-8859-1" ?>
<authors>
<author id="1">Mr A</author>
<author id="2">Mr B</author>
</authors> 
```

我想生成如下所示的 HTML：

```
<table>
    <tr>  <td>Title</td>     <td>Author</td> </tr>
    <tr>  <td>Doraemon</td>  <td>Mr A</td>   </tr>
    <tr>  <td>Ultraman</td>  <td>Mr B</td>   </tr>
</table> 
```

请给我看一些例子。或者我可以参考的任何网站。非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T03:19:17.543

```
(: file: titles.xqy :)
<table>
<tr><th>title</th><th>author</th></tr>
{
let $books-doc := doc("books.xml")
let $authors-doc := doc("authors.xml")
for $b in $books-doc//book,
    $a in $authors-doc//author
where $a/@id = $b/authorid
return 
<tr>
    <td>{$b/title/text()}</td>
    <td>{$a/text()}</td>
</tr>
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T19:38:48.967

您需要一个服务器或一个库来将 xml 处理为 html。在我看来，当您处理任何稍微复杂的事情时，XQuery 在这类事情上比 XSLT 好得多。它也是一种更干净的语言。这个网站有[一个很好的 XQuery 处理器列表](http://www.sqlsummit.com/XQueryProv.htm)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-20T22:22:20.907

XQuery 与 SQL 的相似之处在于它允许您从大型数据存储库中检索数据的特定部分。SQL 用于关系数据库（MS SQL Server、Oracle、Sybase、MySQL、PostreSQL、SQLite 等），XQuery 用于 XML 数据库（MARKLogic、Sedena、Qexo、Qizx/db 等）。

MARKLogic 为您提供 XDB 服务器和 HTTP 服务器。您可以拥有一个典型的 Web 服务器并通过 XDB 连接到 MARKLogic，或者您可以使用他们的 HTTP 服务器并直接将您的 XQuery 与您的 HTML 混合。

我建议下载 MARKLogic 的开发服务器（允许 100MB 的文档）并尝试一下。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-20T15:35:50.820

老实说，也许您根本不需要使用 XQuery。

如果您需要将中等复杂的 XML 文档从 XML 转换为 HTML，我建议使用 XSL。就个人而言，我发现 XSL 比 XQuery 更容易学习。由于 XSL 的存在时间更长，因此在线提供了大量示例和教程。

我们目前使用 XQuery 只是因为它是我们获得许可的专用 XML 软件的一部分。XQuery 是从大型存储库中选择 XML 片段的绝佳工具，但我们仍然使用 XSL 来转换我们的文档。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-02T15:18:35.143

在网站开发环境中使用 XQuery 可以有很多场景：

**动态生成页面：**

您需要一个库来提供可以从服务器端代码调用的 API，如果您的 XML 数据存储在传统数据库或文件系统中，就会出现这种情况。例如：Zorba 为 PHP 提供了这样的 API，还有用于 Java 的 XQuery API 等。

如果您的 XML 数据存储在支持 XQuery 的 XML 数据库服务器中，那么您将向服务器发出 XQuery 查询并取回结果。此类别中有许多开源和商业产品。BaseX 是一个开源示例。

**静态生成页面：**

您可能希望从 XML 数据静态生成一些 HTML 页面。在这种情况下，您可以运行命令行 XQuery 实用程序，例如 Zorba、Saxon、BaseX 和许多其他提供此类 CLI 工具的公司。或者，您也可以使用 API 从您自己的脚本中执行此操作。

然后，您将在构建系统中定义规则，以便在您的 XML 数据更改时执行这些命令或脚本。

在静态和动态方法中，您都可以设置您的环境，以便 XQuery 与您的模板系统一起使用，例如，您可以基于 XML 生成 HTML 段，然后将它们插入到您的模板系统中，而不是通过 XQuery 生成整个 HTML 页面。模板。

**转换以外的用途：**

上述案例是关于将 XML 转换为 HTML，但 XQuery 可以在 Web 开发过程中以其他方式使用。我发现它有用的一种方法是修改 XML 文档。假设您有一个较长的 XML 文档，并且您想修改字段值或添加字段或属性 - 您可以使用 XQuery Update Facility 扩展来实现这一点。

希望这可以帮助。我没有讨论你的例子，因为我认为这只是为了澄清。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-21T09:47:42.540

请参阅以下链接：

[http://beyondrelational.com/blogs/jacob/archive/2009/08/19/xquery-lab-47-generating-html-table-from-xml-data.aspx](http://beyondrelational.com/blogs/jacob/archive/2009/08/19/xquery-lab-47-generating-html-table-from-xml-data.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:10:37.210

```
<table>
<tr><td>Title<td><td>Author<td></tr>
{
    let $authordoc := fn:doc("author.xml")
    for $book in fn:doc("book.xml")/books/book
    return
        <tr>
                <td>{ $book/title }</td>
                <td>{ $authordoc/authors/author/[@id eq $book/authorid] }</td>
        </tr>
}
</table> 
```

ps：尚未测试/执行它，但这是一种解决方案的样子

# outlook - 解析 pst 电子邮件存档的最佳库是什么？我查找了文件描述，但在 google 上找不到任何内容

> ID：80783
> 
> 赞同：-2
> 
> 时间：2008-09-17T07:24:45.997
> 
> 标签：outlook

我正在寻找一个库，或者一些代码来解析一个 pst 文件。最好在python中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T08:50:52.857

[This blog post](http://blog.clintecker.com/post/148437617/project-parse-an-outlook-pst-using-python/) gives one person's account of doing this in python. If you scroll to the bottom they mention [libPST](http://freshmeat.net/projects/libpst/?topic_id=31):

> Oh yeah, and big props to the libPST guys who figured this all out long before I came along ;) [Their documentation](http://clintology.com/external/FILE-FORMAT) of the format is adequate and should be easy enough to follow. Their application (readpst) also produces some useful output if you enable the debugging in the C source code. Check out their [project](http://sourceforge.net/projects/ol2mbox) at sourceforge.

Something in the above section should get you unstuck. Good luck!

# c# - 使用 C# 在 Little Endian 或 Big Endian 中写入/读取二进制数据的最佳方法？

> ID：80784
> 
> 赞同：3
> 
> 时间：2008-09-17T07:24:58.290
> 
> 标签：c#, .net, file, endianness

好的，如果我在.NET 下有一个以小端或大端编码的二进制文件，那么读取/写入它的最佳方法是什么？

在 .NET 框架中，我只设法找到了默认使用小端序的 BinaryWritters / BinaryReaders，所以我的方法是实现我自己的 BinaryReader / BinaryWritter 用于以大端序读取/写入数据，但我想知道是否有更好的方法.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T07:27:59.373

我喜欢这一个：

[杂项实用程序库](http://www.yoda.arachsys.com/csharp/miscutil/)

# java - ExecutorService 中的活动线程

> ID：80787
> 
> 赞同：69
> 
> 时间：2008-09-17T07:25:13.140
> 
> 标签：java, multithreading, concurrency

任何想法如何确定当前运行的活动线程数[`ExecutorService`](https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/ExecutorService.html)？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-09-17T07:30:37.497

使用[ThreadPoolExecutor](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)实现并调用[getActiveCount()](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#getActiveCount())：

```
int getActiveCount() 
// Returns the approximate number of threads that are actively executing tasks. 
```

ExecutorService 接口没有为此提供方法，它取决于实现。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-09-01T23:30:19.557

假设`pool`是 ExecutorService 实例的名称：

```
if (pool instanceof ThreadPoolExecutor) {
    System.out.println(
        "Pool size is now " +
        ((ThreadPoolExecutor) pool).getActiveCount()
    );
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-17T07:34:34.397

检查源代码`Executors.newFixedThreadPool()`：

```
return new ThreadPoolExecutor(nThreads, nThreads,
                              0L, TimeUnit.MILLISECONDS,
                              new LinkedBlockingQueue<Runnable>()); 
```

ThreadPoolExecutor 有一个 getActiveCount() 方法。因此，您可以将 ExecutorService 转换为 ThreadPoolExecutor，或者直接使用上面的代码获取一个。然后您可以调用`getActiveCount()`.

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-17T07:43:26.933

ExecutorService 接口没有定义检查池中工作线程数量的方法，因为这是一个实现细节

```
public int getPoolSize()
Returns the current number of threads in the pool. 
```

在 ThreadPoolExecutor 类上可用

```
导入 java.util.concurrent.LinkedBlockingQueue；
导入 java.util.concurrent.ThreadPoolExecutor；
导入 java.util.concurrent.TimeUnit；

公共类池大小 {

    公共静态无效主要（字符串[]参数）{
        ThreadPoolExecutor 执行器 = new ThreadPoolExecutor(10, 20, 60L, TimeUnit.SECONDS, new LinkedBlockingQueue());
        System.out.println(executor.getPoolSize());
    }
}

```

但这需要您显式创建 ThreadPoolExecutor，而不是使用返回 ExecutorService 对象的 Executors 工厂。您始终可以创建自己的工厂来返回 ThreadPoolExecutors，但您仍然会留下使用具体类型而不是其接口的糟糕形式。

一种可能性是提供您自己的 ThreadFactory，它在已知线程组中创建线程，然后您可以计算

```
导入 java.util.concurrent.ExecutorService；
导入 java.util.concurrent.Executors；
导入 java.util.concurrent.ThreadFactory；

公共类 PoolSize2 {

    公共静态无效主要（字符串[]参数）{
        final ThreadGroup threadGroup = new ThreadGroup("workers");

        ExecutorService executor = Executors.newCachedThreadPool(new ThreadFactory() {
            公共线程 newThread(Runnable r) {
                返回新线程（线程组，r）；
            }
        });

        System.out.println(threadGroup.activeCount());
    }
}

```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-07-04T10:48:37.663

我有同样的问题，所以创建了一个简单的 Runnable 来跟踪 ExecutorService 实例。

```
import java.util.concurrent.ExecutorService;
import java.util.concurrent.ThreadPoolExecutor;

public class ExecutorServiceAnalyzer implements Runnable
{
    private final ThreadPoolExecutor threadPoolExecutor;
    private final int timeDiff;

    public ExecutorServiceAnalyzer(ExecutorService executorService, int timeDiff)
    {
        this.timeDiff = timeDiff;
        if (executorService instanceof ThreadPoolExecutor)
        {
            threadPoolExecutor = (ThreadPoolExecutor) executorService;
        }
        else
        {
            threadPoolExecutor = null;
            System.out.println("This executor doesn't support ThreadPoolExecutor ");
        }

    }

    @Override
    public void run()
    {
        if (threadPoolExecutor != null)
        {
            do
            {
                System.out.println("#### Thread Report:: Active:" + threadPoolExecutor.getActiveCount() + " Pool: "
                        + threadPoolExecutor.getPoolSize() + " MaxPool: " + threadPoolExecutor.getMaximumPoolSize()
                        + " ####");
                try
                {
                    Thread.sleep(timeDiff);
                }
                catch (Exception e)
                {
                }
            } while (threadPoolExecutor.getActiveCount() > 1);
            System.out.println("##### Terminating as only 1 thread is active ######");
        }

    }
} 
```

您可以简单地将它与您的执行程序一起使用来获取 ThreadPool 的状态

前任

```
ExecutorService executorService = Executors.newFixedThreadPool(4);
    executorService.execute(new ExecutorServiceAnalyzer(executorService, 1000)); 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-09-17T07:31:54.543

在线程上放置一个静态 volatile 计数器，该计数器在线程被激活和停用时更新。另请参阅 API。

# c# - 致命错误 C1083 - 无法打开包含文件：“windows.h”：没有这样的文件或目录

> ID：80788
> 
> 赞同：11
> 
> 时间：2008-09-17T07:25:18.337
> 
> 标签：c#, .net, path, ikvm

我正在尝试构建 IKVM（请参阅[此问题](https://stackoverflow.com/questions/71599/how-to-get-ikvm-to-build-in-visual-studio-2008)），但现在遇到了与 IKVM 无关的问题，因此我提出了一个新问题：

使用 Visual Studio 2008 命令提示符（从“开始”菜单）在 IKVM 目录上运行 nant 时，出现以下错误：

> ```
>  ikvm-native-win32:
> 
>                [cl] Compiling 2 files to C:\ikvm-0.36.0.11\native\Release'.
> 
>                [cl] jni.c
>                [cl] os.c
>                [cl] C:\ikvm-0.36.0.11\native\os.c(25) : fatal error C1083: Cannot open include file: 'windows.h': No such
>                     file or directory
>                [cl] Generating Code...
> 
>         BUILD FAILED
> 
>         C:\ikvm-0.36.0.11\native\native.build(17,10):
>         External Program Failed: cl (return code was 2) 
> ```

我已经安装了平台 SDK。我错过了什么？我确定这很简单...

**编辑#1**我刚刚检查过 - 我确实在路径上有包含 windows.h 的目录。 **编辑 #2**找到答案（请参阅下面的答案）：包含 windows.h 的目录需要位于“包含”路径变量中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T08:48:49.507

好的，这是我最终找到的答案：不是在路径上，而是需要设置带有 windows.h 的目录（在我的情况下是 C:\Program Files\Microsoft SDKs\Windows\v6.0A\Include）包含环境变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T13:08:40.680

顺便说一句，创建环境变量 %LIB%，意思是相同的 - 所有 SDK 库目录的路径

# java - JAX-RS 框架

> ID：80799
> 
> 赞同：50
> 
> 时间：2008-09-17T07:28:37.547
> 
> 标签：java, rest, jax-rs

我一直在使用 JAX-RS 参考实现（Jersey）做一些工作。我知道至少有两个其他框架（Restlet 和 Apache CXF）。

我的问题是：有没有人对这些框架进行过比较，如果有，你会推荐哪个框架，为什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-17T10:46:15.013

FWIW 我们使用 Jersey 作为其包装的全部功能（例如 WADL、隐式视图、XML/JSON/Atom 支持）背后有一个庞大而充满活力的开发人员社区，并且具有出色的[spring 集成](http://www.javakaffee.de/blog/2008/04/21/jersey-spring-integration-mostly-complete/)。

如果您使用 JBoss/SEAM，您可能会发现 RESTeasy 集成得更好——但如果您使用 Spring 进行依赖注入，那么 Jersey 似乎是最简单、最流行、最活跃和功能强大的实现。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-09-24T16:02:05.550

[Restlet](http://www.restlet.org)有一个广泛的 Spring、WADL、XML、JSON 以及更多扩展列表，包括 JAX-RS API 的扩展。

它也是[六个一致版本中唯一可用](http://www.restlet.org/downloads/testing)的框架：

*   Java SE
*   Java EE
*   谷歌网络工具包
*   谷歌应用引擎
*   安卓
*   OSGi 环境

它的主要好处是：

*   当 JAX-RS 设计用于服务器端处理时，完全对称的客户端和服务器 API
*   当 JAX-RS 仅是 HTTP 时，HTTP 以外的其他协议的连接器（映射到 HTTP 语义）
*   更广泛的功能范围，包括通过 Restlet API 的完整 URI 路由控制（但如果需要，可以与 Servlet 集成）
*   为 NIO 提供全面支持

如果您仅限于 JCP 批准的 API（然后不要使用 Spring 或 JAX-RS 项目的任何扩展，如 Jersey 和 RESTeasy！），那么 JAX-RS API 可能是一个不错的选择，但除此之外，Restlet 是最成熟的框架（最初于 2005 年发布），并将在其 2.0 版本中为您提供注释的所有优点以及强大且可扩展的面向类的框架。

如需更长[的功能列表，请查看此页面](http://restlet.com/products/restlet-framework/#features)。

最好的问候，杰罗姆·卢维尔

Restlet ~ 创始人和首席开发者 ~ [http://www.restlet.org](http://www.restlet.org)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T18:37:43.890

我和我的团队广泛使用 Restlet，但没有使用它的 JAX-RS 功能。我可以告诉你，我对 Restlet 开发人员和社区印象深刻。他们非常积极、敬业、反应迅速，并致力于建立一个稳定、高效、可靠和有效的框架。很抱歉，我无法直接解决您的主要兴趣，但我认为您可能会发现我在 Restlet 方面的经验很有价值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-17T08:05:32.217

我的同事提到为什么我们[在 Java EE 中使用 RESTeasy (JAX-RS) 的 RESTful Web 服务中](http://www.lunatech-research.com/archives/2008/03/20/restful-web-sevices-resteasy-jax-rs)使用 RESTeasy 进行当前项目：

> 没有选择它的参考实现 Jersey，因为我们很难将它与 EJB3 和 Seam 2.0 很好地集成。
> 
> 我们正在使用 JAX-RS 的 RESTeasy 实现，因为我们可以毫不费力地将它与我们的 EJB 和 Seam 集成。它也有足够的文档。
> 
> Apache 有另一个实现，但我没有尝试过，因为它使用的是旧版本的 JAX-RS。
> 
> 最后，还有另一个用于 Java 的 RESTful Web 服务框架，称为 Restlet，但我们不喜欢它，因为在撰写本文时，它使用的是自定义架构，尽管适当的 JAX-RS 支持正在开发中。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-28T00:50:40.150

似乎有 4 个不错的 JAX-RS 实现，所以您可能对其中任何一个都满意。就其价值而言，到目前为止，我发现 Jersey (1.0.2) 非常好。我的需求是相当谦虚，简单的后端服务，照顾管道等等。那个泽西做得很好。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-08-17T07:10:34.587

发现 Apache Wink 非常易于使用，支持 JAX-RS 并且具有许多超出标准的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-06T07:47:05.600

I would use no framework. Just the one that comes with your applications server. If you use specifics of one framwork you'll lose portability and you'll be in the hell of what if the vendor of the app server includes a different version of your favourite framework. I'll stick to jax-ws.

# database - 如何合并多个 SQLite 数据库？

> ID：80801
> 
> 赞同：78
> 
> 时间：2008-09-17T07:28:44.800
> 
> 标签：database, sqlite

如果我有大量 SQLite 数据库，它们都具有相同的架构，那么将它们合并在一起以便对所有数据库执行查询的最佳方法是什么？

我知道可以使用[ATTACH](http://www.sqlite.org/lang_attach.html)来执行此操作，但它有32 和 64 个数据库[的限制](http://www.sqlite.org/limits.html#max_attached)，具体取决于机器上的内存系统。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-06-18T18:58:38.477

从DavidM 的回答中的[Nabble 帖子中总结：](https://web.archive.org/web/20120615034014/http://sqlite.1065341.n5.nabble.com/Attempting-to-merge-large-databases-td39548.html)

```
attach 'c:\test\b.db3' as toMerge;           
BEGIN; 
insert into AuditRecords select * from toMerge.AuditRecords; 
COMMIT; 
detach toMerge; 
```

根据需要重复。

*注意：`detach toMerge;`根据麦克的评论添加。*

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-17T08:03:39.273

这将按需完成，可能一天多次。我认为它的工作方式是[http://sqlite.1065341.n5.nabble.com/Attempting-to-merge-large-databases-td39548.html](http://sqlite.1065341.n5.nabble.com/Attempting-to-merge-large-databases-td39548.html)，其中数据库合并到一个大型数据库中，执行查询然后删除了大数据库。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-11-15T06:19:46.053

尽管这是一个非常古老的线程，但这仍然是当今编程需求中的一个相关问题。我在这里发布这个是因为所提供的答案都不是简洁、简单和直截了当的。这是为了最终出现在此页面上的 Google 员工。我们去的GUI：

1.  下载[Sqlitestudio](https://sqlitestudio.pl/index.rvt?act=download)
2.  使用`Ctrl + O`键盘快捷键添加所有数据库文件
3.  双击每个现在加载的 db 文件以打开/激活/展开它们
4.  有趣的部分：只需右键单击每个表并单击`Copy`，然后转到已加载数据库文件列表中的目标数据库（或根据需要创建新的）并右键单击目标数据库并单击`Paste`

我很惊讶地意识到，使用古老的编程技能可以解决如此艰巨的任务：复制和粘贴:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T07:31:30.490

如果您只需要执行一次此合并操作（以创建一个新的更大的数据库），您可以创建一个脚本/程序来循环所有 sqlite 数据库，然后将数据插入到您的主（大）数据库中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-22T11:39:40.107

迟到的答案，但您可以使用：

```
#!/usr/bin/python

import sys, sqlite3

class sqlMerge(object):
    """Basic python script to merge data of 2 !!!IDENTICAL!!!! SQL tables"""

    def __init__(self, parent=None):
        super(sqlMerge, self).__init__()

        self.db_a = None
        self.db_b = None

    def loadTables(self, file_a, file_b):
        self.db_a = sqlite3.connect(file_a)
        self.db_b = sqlite3.connect(file_b)

        cursor_a = self.db_a.cursor()
        cursor_a.execute("SELECT name FROM sqlite_master WHERE type='table';")

        table_counter = 0
        print("SQL Tables available: \n===================================================\n")
        for table_item in cursor_a.fetchall():
            current_table = table_item[0]
            table_counter += 1
            print("-> " + current_table)
        print("\n===================================================\n")

        if table_counter == 1:
            table_to_merge = current_table
        else:
            table_to_merge = input("Table to Merge: ")

        return table_to_merge

    def merge(self, table_name):
        cursor_a = self.db_a.cursor()
        cursor_b = self.db_b.cursor()

        new_table_name = table_name + "_new"

        try:
            cursor_a.execute("CREATE TABLE IF NOT EXISTS " + new_table_name + " AS SELECT * FROM " + table_name)
            for row in cursor_b.execute("SELECT * FROM " + table_name):
                print(row)
                cursor_a.execute("INSERT INTO " + new_table_name + " VALUES" + str(row) +";")

            cursor_a.execute("DROP TABLE IF EXISTS " + table_name);
            cursor_a.execute("ALTER TABLE " + new_table_name + " RENAME TO " + table_name);
            self.db_a.commit()

            print("\n\nMerge Successful!\n")

        except sqlite3.OperationalError:
            print("ERROR!: Merge Failed")
            cursor_a.execute("DROP TABLE IF EXISTS " + new_table_name);

        finally:
            self.db_a.close()
            self.db_b.close()

        return

    def main(self):
        print("Please enter name of db file")
        file_name_a = input("File Name A:")
        file_name_b = input("File Name B:")

        table_name = self.loadTables(file_name_a, file_name_b)
        self.merge(table_name)

        return

if __name__ == '__main__':
    app = sqlMerge()
    app.main() 
```

* * *

SRC : [合并相同 SQLite3 数据库的工具](https://github.com/kd8bny/sqlMerge)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-07-26T08:30:24.243

这是一个简单的 python 代码，用于合并两个数据库文件或扫描目录以查找所有数据库文件并将它们全部合并在一起（只需将其他文件中的所有数据插入找到的第一个数据库文件）。请注意，此代码只是附加具有相同架构的数据库。

```
import sqlite3
import os

def merge_databases(db1, db2):
    con3 = sqlite3.connect(db1)

    con3.execute("ATTACH '" + db2 +  "' as dba")

    con3.execute("BEGIN")
    for row in con3.execute("SELECT * FROM dba.sqlite_master WHERE type='table'"):
        combine = "INSERT OR IGNORE INTO "+ row[1] + " SELECT * FROM dba." + row[1]
        print(combine)
        con3.execute(combine)
    con3.commit()
    con3.execute("detach database dba")

def read_files(directory):
    fname = []
    for root,d_names,f_names in os.walk(directory):
        for f in f_names:
            c_name = os.path.join(root, f)
            filename, file_extension = os.path.splitext(c_name)
            if (file_extension == '.sqlitedb'):
                fname.append(c_name)

    return fname

def batch_merge(directory):
    db_files = read_files(directory)
    for db_file in db_files:
        merge_databases(db_files[0], db_file)

if __name__ == '__main__':
    batch_merge('/directory/to/database/files') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-29T03:51:02.530

如果您已到达此提要的底部，但尚未找到您的解决方案，这也是一种合并 2 个或更多 sqlite 数据库的表的方法。

首先尝试下载并安装[用于 sqlite 数据库的 DB 浏览器](https://sqlitebrowser.org/)。然后尝试在 2 个窗口中打开您的数据库，并尝试通过简单地将表从一个窗口**拖放**到另一个窗口来合并它们。但问题是您一次只能拖放**一个**表，因此它并不是这个答案的真正解决方案，但如果您的数据库很小，它可以用来节省进一步搜索的时间。

* * *

## 回答 #8

> 赞同：-9
> 
> 时间：2008-09-17T09:33:39.183

无意冒犯，就像一个开发人员对另一个开发人员一样，恐怕您的想法似乎非常低效。在我看来，您应该将多个表存储在同一个数据库文件中，而不是联合 SQLite 数据库。

但是，如果我弄错了，我猜您可以附加数据库，然后使用 VIEW 来简化您的查询。或者创建一个内存表并复制所有数据（但这在性能方面更糟糕，特别是如果你有大型数据库）

# javascript - 使用匿名函数会影响性能吗？

> ID：80802
> 
> 赞同：93
> 
> 时间：2008-09-17T07:28:45.207
> 
> 标签：javascript, performance, optimization

我一直在想，在 Javascript 中使用命名函数和匿名函数之间是否存在性能差异？

```
for (var i = 0; i < 1000; ++i) {
    myObjects[i].onMyEvent = function() {
        // do something
    };
} 
```

对比

```
function myEventHandler() {
    // do something
}

for (var i = 0; i < 1000; ++i) {
    myObjects[i].onMyEvent = myEventHandler;
} 
```

第一个更整洁，因为它不会使您的代码与很少使用的函数混淆，但是您多次重新声明该函数是否重要？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-09-17T09:07:24.707

这里的性能问题是在循环的每次迭代中创建新函数对象的成本，而不是您使用匿名函数的事实：

```
for (var i = 0; i < 1000; ++i) {    
    myObjects[i].onMyEvent = function() {
        // do something    
    };
} 
```

您正在创建一千个不同的函数对象，即使它们具有相同的代码体并且没有绑定到词法范围（[闭包](http://www.google.com/search?q=javascript+closure)）。另一方面，以下似乎更快，因为它只是将*相同*的函数引用分配给整个循环中的数组元素：

```
function myEventHandler() {
    // do something
}

for (var i = 0; i < 1000; ++i) {
    myObjects[i].onMyEvent = myEventHandler;
} 
```

如果您要在进入循环之前创建匿名函数，然后仅在循环内将对其的引用分配给数组元素，您会发现与命名函数版本相比没有任何性能或语义差异：

```
var handler = function() {
    // do something    
};
for (var i = 0; i < 1000; ++i) {    
    myObjects[i].onMyEvent = handler;
} 
```

简而言之，在命名函数上使用匿名并没有明显的性能成本。

顺便说一句，从上面看起来可能没有区别：

```
function myEventHandler() { /* ... */ } 
```

和：

```
var myEventHandler = function() { /* ... */ } 
```

前者是*函数声明*，而后者是对匿名函数的变量赋值。尽管它们看起来具有相同的效果，但 JavaScript 对它们的处理确实略有不同。要了解差异，我建议阅读“<a href="http://www.dustindiaz.com/javascript-function-declaration-ambiguity/" rel="noreferrer">JavaScript 函数声明歧义”。

任何方法的实际执行时间很大程度上取决于浏览器对编译器和运行时的实现。有关现代浏览器性能的完整比较，请访问[JS Perf 站点](http://jsperf.com/named-or-anonymous-functions/12)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-17T07:52:48.410

这是我的测试代码：

```
var dummyVar;
function test1() {
    for (var i = 0; i < 1000000; ++i) {
        dummyVar = myFunc;
    }
}

function test2() {
    for (var i = 0; i < 1000000; ++i) {
        dummyVar = function() {
            var x = 0;
            x++;
        };
    }
}

function myFunc() {
    var x = 0;
    x++;
}

document.onclick = function() {
    var start = new Date();
    test1();
    var mid = new Date();
    test2();
    var end = new Date();
    alert ("Test 1: " + (mid - start) + "\n Test 2: " + (end - mid));
} 
```

结果：
测试 1：142ms 测试 2：1983ms

看来JS引擎并没有识别出它是Test2中的同一个函数并且每次都编译它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T07:33:48.143

作为一般设计原则，您应该避免多次实现相同的代码。相反，您应该将通用代码提取到一个函数中，并从多个位置执行该（通用、经过良好测试、易于修改）函数。

如果（与您从问题中推断的不同）您声明了一次内部函数并使用了一次该代码（并且在您的程序中没有其他相同的内容），那么一个匿名函数*可能*（那是猜测的人）被以同样的方式对待编译器作为一个普通的命名函数。

它在特定情况下是一个非常有用的功能，但不应该在很多情况下使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T07:36:49.900

我预计不会有太大差异，但如果有的话，它可能会因脚本引擎或浏览器而异。

如果您发现代码更容易理解，那么性能不是问题，除非您希望调用该函数数百万次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-24T21:29:10.153

我们可以对性能产生影响的地方是声明函数的操作。这是在另一个函数的上下文中或外部声明函数的基准：

[http://jsperf.com/function-context-benchmark](http://jsperf.com/function-context-benchmark)

在 Chrome 中，如果我们在外部声明该函数，操作会更快，但在 Firefox 中则相反。

在其他示例中，我们看到如果内部函数不是纯函数，它在 Firefox 中也会缺乏性能：http: [//jsperf.com/function-context-benchmark-3](http://jsperf.com/function-context-benchmark-3)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T07:44:41.270

在各种浏览器，尤其是 IE 浏览器中，肯定会让你的循环更快的原因是循环如下：

```
for (var i = 0, iLength = imgs.length; i < iLength; i++)
{
   // do something
} 
```

您已经将任意 1000 放入循环条件中，但是如果您想遍历数组中的所有项目，您就会明白我的意思。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T08:40:08.093

@尼克夫

不过，这是一个相当愚蠢的测试，您正在比较执行*和编译*时间，这显然会花费方法 1（编译 N 次，取决于 JS 引擎）和方法 2（编译一次）。我无法想象一个 JS 开发人员会以这种方式通过试用期来编写代码。

一个更现实的方法是匿名分配，因为事实上你正在使用你的 document.onclick 方法更像是下面的，它实际上温和地支持 anon 方法。

使用与您类似的测试框架：

* * *

```
function test(m)
{
    for (var i = 0; i < 1000000; ++i) 
    {
        m();
    }
}

function named() {var x = 0; x++;}

var test1 = named;

var test2 = function() {var x = 0; x++;}

document.onclick = function() {
    var start = new Date();
    test(test1);
    var mid = new Date();
    test(test2);
    var end = new Date();
    alert ("Test 1: " + (mid - start) + "ms\n Test 2: " + (end - mid) + "ms");
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T09:11:32.603

引用几乎总是比它所引用的要慢。这样想——假设你想打印加 1 + 1 的结果。这更有意义：

```
alert(1 + 1); 
```

或者

```
a = 1;
b = 1;
alert(a + b); 
```

我意识到这是一种非常简单的看待它的方式，但它是说明性的，对吧？仅在要多次使用时才使用参考 - 例如，以下哪个示例更有意义：

```
$(a.button1).click(function(){alert('you clicked ' + this);});
$(a.button2).click(function(){alert('you clicked ' + this);}); 
```

或者

```
function buttonClickHandler(){alert('you clicked ' + this);}
$(a.button1).click(buttonClickHandler);
$(a.button2).click(buttonClickHandler); 
```

第二个是更好的练习，即使它有更多的行。希望所有这些都是有帮助的。（并且 jquery 语法并没有让任何人失望）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T09:32:45.363

是的！匿名函数比常规函数更快。也许如果速度是最重要的......比代码重用更重要，然后考虑使用匿名函数。

这里有一篇关于优化 javascript 和匿名函数的非常好的文章：

[http://dev.opera.com/articles/view/efficient-javascript/?page=2](http://dev.opera.com/articles/view/efficient-javascript/?page=2)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T10:14:49.147

@尼克夫

（希望我有代表发表评论，但我才刚刚找到这个网站）

我的观点是，命名/匿名函数与在迭代中执行 + 编译的用例之间存在混淆。正如我所说明的，anon+named 之间的区别本身可以忽略不计 - 我是说这是错误的用例。

这对我来说似乎很明显，但如果不是，我认为最好的建议是“不要做愚蠢的事情”（其中一个用例的恒定块移动 + 对象创建就是其中之一），如果您不确定，请测试！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T14:15:10.440

匿名对象比命名对象快。但是调用更多函数的成本更高，并且在某种程度上使您从使用匿名函数中获得的任何节省都黯然失色。每个被调用的函数都会添加到调用堆栈中，这会引入少量但不重要的开销。

但除非您正在编写加密/解密例程或类似对性能敏感的东西，否则正如许多其他人所指出的那样，优化优雅、易于阅读的代码总是比快速代码更好。

假设您正在编写架构良好的代码，那么速度问题应该是编写解释器/编译器的人的责任。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-06-17T09:21:50.180

正如@nickf answer的评论中指出的那样：答案

> 创建一个函数比创建一个函数快一百万次

是的。但正如他的 JS 性能所显示的那样，它并没有慢一百万倍，这表明它实际上会随着时间的推移而变得更快。

对我来说更有趣的问题是：

> 重复**创建 + 运行**与创建一次 + 重复**运行**相比如何。

如果一个函数执行复杂的计算，那么创建函数对象的时间很可能可以忽略不计。但是在**运行**速度很快的情况下， **create的开销又如何呢？**例如：

 **```
// Variant 1: create once
function adder(a, b) {
  return a + b;
}
for (var i = 0; i < 100000; ++i) {
  var x = adder(412, 123);
}

// Variant 2: repeated creation via function statement
for (var i = 0; i < 100000; ++i) {
  function adder(a, b) {
    return a + b;
  }
  var x = adder(412, 123);
}

// Variant 3: repeated creation via function expression
for (var i = 0; i < 100000; ++i) {
  var x = (function(a, b) { return a + b; })(412, 123);
} 
```

这个[JS Perf](https://jsperf.com/function-creation-performance-overhead/1)表明只创建一次函数会比预期的更快。然而，即使是像简单的加法这样非常快速的操作，重复创建函数的开销也只有百分之几。

差异可能仅在创建函数对象很复杂的情况下变得显着，同时保持可忽略不计的运行时间，例如，如果整个函数体被包装到一个`if (unlikelyCondition) { ... }`.

# flash - 如何：将糟糕文件名中的 & 号传递给网页上的 flash 对象

> ID：80818
> 
> 赞同：3
> 
> 时间：2008-09-17T07:32:19.677
> 
> 标签：flash, encoding, character

啊。我有一个网站，提供在其他地方托管的歌曲的音频预览。一些文件名中有一个＆符号 - 请参阅下面它传递“soundFile”的位置。任何时候有 & 符号，Flash 都无法获取文件 - 我认为它会在 & 符号之后删除文件名。如果我将它作为“&”或 HTML 实体（“& amp ;”）传递并不重要

```
<object type="application/x-shockwave-flash" data="includes/player.swf" id="audioplayer" height="24" width="290">
<param name="movie" value="includes/player.swf"><param name="FlashVars" value="playerID=1&amp;soundFile=http://www.divideandkreate.com/mp3/Divide_&_Kreate_-_Party_Kisser.mp3">
<param name="quality" value="high"><param name="menu" value="false"><param name="wmode" value="transparent">
</object> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T07:43:34.017

听起来您可能必须对其进行 URL 编码，而不是对其进行 HTML 编码。虽然不确定没有代码示例。& 符号的 URL 编码代码是 '%26'。

# c# - 打开文件对话框。“指定目录对话框”怎么样？

> ID：80820
> 
> 赞同：3
> 
> 时间：2008-09-17T07:33:18.317
> 
> 标签：c#, directory, openfiledialog

在文件路径字段上，我想捕获目录路径，例如：

```
textbox1.Text = directory path 
```

任何人？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T07:34:27.753

如果希望用户选择文件夹，可以使用 FolderBrowserDialog 类。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)

```
DialogResult result = folderBrowserDialog1.ShowDialog();
if (result.Equals(get_DialogResult().OK)) {
    textbox1.Text = folderBrowserDialog1.get_SelectedPath();
} 
```

如果您只想从完整路径中获取目录，您可以这样做：

```
textbox1.Text = Path.GetDirectoryName(@"c:\windows\temp\myfile.txt"); 
```

这会将文本属性设置为“c:\windows\temp\”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T08:15:08.887

好吧，我正在使用 VS 2008 SP1。这就是我所需要的：

```
private void button1_Click(object sender, EventArgs e)
{
    FolderBrowserDialog profilePath = new FolderBrowserDialog();

    if (profilePath.ShowDialog() == DialogResult.OK)        
    {
        profilePathTextBox.Text = profilePath.SelectedPath;
    }
    else
    {
        profilePathTextBox.Text = "Please Specify The Profile Path";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-08T16:03:45.733

If you don't want a terrible, non-user friendly dialog*, try [Ookii.Dialogs](http://www.ookii.org/software/dialogs/) or see other answers to [How do you configure an OpenFileDialog to select folders?](https://stackoverflow.com/questions/31059/how-do-you-configure-an-openfiledialog-to-select-folders). The only downside I see to Ookii is that it requires .NET 4 Full, not just Client Profile. But the source is included in the download, so I'm going to work on that. Too bad the license isn't LGPL or similar...

See also: [WinForms message box with textual buttons](https://stackoverflow.com/questions/4342895/winforms-message-box-with-textual-buttons)

*This is what FolderBrowserDialog looks like:

![Ugly, unfriendly folder browser dialog](https://i.stack.imgur.com/NvD6F.png)

# c++ - 如何找出提供给 IExchangeManageStore::GetMailboxTable 的信息存储的可分辨名称？

> ID：80831
> 
> 赞同：2
> 
> 时间：2008-09-17T07:35:06.707
> 
> 标签：c++, outlook, exchange-server, mapi

有一篇[Microsoft 知识库文章](http://support.microsoft.com/?scid=194627)，其中包含用于打开给定信息存储中的所有邮箱的示例代码。到目前为止它可以工作（需要在比 VC++ 6.0 更新的编译器上进行一些[复制和粘贴）。](http://blogs.msdn.com/jasonjoh/archive/2004/08/01/204585.aspx)

在某一时刻，它使用信息存储的可分辨名称调用 IExchangeManageStore::GetMailboxTable。对于 Exchange 2007 试用版虚拟服务器映像，它必须如下所示：

```
"/o=Litware Inc/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Configuration/cn=servers/cn=DC1". 
```

使用[OutlookSpy](http://www.dimastr.com/outspy/)并单击 IMsgStore 和 IExchangeManageStore 会在“Server DN:”旁边显示所需的字符串。

我想避免强迫用户将其放入配置文件中。因此，如果 OutlookSpy 可以做到，我的应用程序如何找出当前打开的邮箱所在的信息存储的可分辨名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T08:36:36.220

认为必须有一个纯 MAPI 解决方案，我相信我已经弄清楚 OutlookSpy 是如何做到的。

下面的代码片段，插入之后

```
printf("Created MAPI session\n"); 
```

在[KB194627](http://support.microsoft.com/kb/194627)的示例中，将显示*服务器 DN*。

```
LPPROFSECT lpProfSect;
hr = lpSess->OpenProfileSection((LPMAPIUID)pbGlobalProfileSectionGuid, NULL, 0, &lpProfSect);
if(SUCCEEDED(hr))
{
    LPSPropValue lpPropValue;
    hr = HrGetOneProp(lpProfSect, PR_PROFILE_HOME_SERVER_DN, &lpPropValue);
    if(SUCCEEDED(hr))
    {
        printf("Server DN: %s\n", lpPropValue->Value.lpszA);
        MAPIFreeBuffer(lpPropValue);
    }
    lpProfSect->Release();
} 
```

**更新：**[EDK 5.5 源代码](http://www.microsoft.com/downloads/details.aspx?FamilyID=36a309c3-8c55-4476-8785-cafc59a2d075&DisplayLang=en)中有*HrGetServerDN*
函数，它从给定会话的*PR_EMS_AB_HOME_MTA*中提取*服务器 DN*。如果其他方式不可靠，我会尝试。

 **** * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:02:38.153

它将位于 Active Directory 中，因此您将使用 ADSI/LDAP 查看 CN=Microsoft Exchange,CN=Services,CN=Configuration,DC= *example* ,DC= *com*。使用 Sysinternals 的 ADExplorer 在其中进行挖掘以找到您正在寻找的价值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T14:50:49.627

我会下载 MFCMapi 的源代码，看看他们是如何做到的。

# ms-access - 重新绑定访问组合框

> ID：80832
> 
> 赞同：1
> 
> 时间：2008-09-17T07:35:08.123
> 
> 标签：ms-access

我有一个可通过组合框搜索的 Access 2007 表单。添加新记录时，我需要更新组合框以包含新添加的项目。

我假设需要在表单的 AfterInsert 事件中完成某些操作，但我不知道是什么。

插入后如何重新绑定组合框，以便新项目出现在列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T08:33:38.077

最简单的方法是保证组合框始终是最新的，只要它获得焦点就重新查询组合框。即使记录集随后在其他地方更新，您的组合框也始终是最新的。OnFocus 事件中的一个简单的 TheCombobox.Requery 就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T01:09:42.707

这里有两个可能的有效答案：

1.  使用 Form 的 AfterInsert 事件重新查询组合框（以及 OnDeleteConfirm 事件）。如果组合框不显示用户可以更新的数据并且如果基础记录更新则需要更新，这将是足够的。

2.  如果数据的更新需要反映在组合框中，那么在用于编辑组合框中显示的数据的控件的 AfterUpdate 事件中添加重新查询是有意义的。

例如，如果您的组合框列出了表中人员的姓名，您将需要使用方法#2，并在 Me!txtFirstName 和 Me!txtLastName 的 AfterUpdate 事件中，重新查询组合框。由于您在四个地方执行相同的操作，因此您需要编写一个子例程来执行重新查询。所以，潜艇看起来像这样：

```
 Private Sub RequerySearchCombo()
    If Me.Dirty Then Me.Dirty = False
    Me!MyCombo.Requery
  End Sub 
```

确保仅在组合框中显示的数据实际更新时重新查询的原因是，如果您使用整个表的列表填充组合框，则重新查询可能需要很长时间有 1000 条记录中的 10 条。

保存所有请求的另一种方法是为组合框设置一个空白行源，仅在输入 1 或 2 个字符后填充它，并根据输入的字符过滤组合显示的结果。为此，您将使用组合框的 OnChange 事件：

```
Private Sub MyCombo_Change()
  Dim strSQL As String

  If Len(Me!MyCombo.Text) = 2 Then
     strSQL = "SELECT MyID, LastName & ', ' & FirstName FROM MyTable "
     strSQL = strSQL & "WHERE LastName LIKE " & Chr(34) & Me!MyCombo.Text & Chr(34) & "*"
     Me!MyCombo.Rowsource = strSQL 
  End If
End Sub 
```

上面的代码假定您在显示“姓氏，名字”的组合框中搜索一个人的姓名。

还有一个重要的警告：如果您正在搜索绑定到完整表的表单（或返回表中所有记录的 SQL 语句）并使用书签导航来定位记录，则此方法不会很好地扩展，因为它需要通过网络拉出搜索字段的整个索引。在上面我想象的组合框的情况下，您将使用 FindFirst 导航到具有相应 MyID 值的记录，因此必须拉出 MyID 的索引（尽管只有尽可能多的索引页才能满足搜索实际上会被取消）。对于有几千条记录的表来说，这不是问题，但超过 15-20K 条记录时，它可能会成为网络瓶颈。

在这种情况下，您可以使用组合框将结果集过滤到单个记录，而不是通过书签导航。当然，这非常有效，无论您使用的是 Jet 后端还是服务器后端。尽快开始将这些效率整合到您的应用程序中是非常可取的。如果你这样做了，那么升级到服务器后端会变得更容易，或者如果你应该用大量新数据达到那个临界点，这会使旧方法效率太低而对用户友好，那么它就会变得非常轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T08:32:25.553

我假设您的组合框是表单上的控件，而不是命令栏中的组合框控件。此组合框有一个名为 rowsource 的属性，它可以是值列表（丈夫；妻子；儿子；女孩）或 SQL SELECT 指令（SELECT relationshipDescription FROM Table_relationType）。

我还假设您的表单记录集与您的组合框记录集有关。您需要做的是，一旦您的表单记录集被**正确更新**（我认为是 afterUpdate 事件），重新初始化组合框控件的 rowsource 属性

如果记录源是一条 SQL 指令：

```
myComboBoxControl.recordsource = _
    "SELECT relationDescription FROM Table_relationType" 
```

或者如果它是一个值列表

```
myComboBoxControl.recordsource = myComboBoxControl.recordsource & ";nephew" 
```

但总的来说，我觉得你的要求很奇怪。你的桌子上有自反（父子）关系吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T09:43:07.460

我通常会使用 NotInList 事件将数据添加到组合中

```
 Response = acDataErrAdded 
```

更新组合。

Access 2007 开发人员参考包含所有详细信息，包括示例代码：http: [//msdn.microsoft.com/en-us/library/bb214329.aspx](http://msdn.microsoft.com/en-us/library/bb214329.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T10:35:09.533

重新查询表单的更新后事件和删除事件中的组合框。每当用户对记录集进行更改时，无论是新记录、更改还是删除，您的组合框都会保持最新状态。

除非用户必须在完成后立即获得其他所有人的更改，否则不要在每次获得焦点时重新查询组合框，因为不仅用户必须等待（这对于大型记录集而言很明显），如果记录集没有改变。但如果是这种情况，则需要在其他任何人进行更改时重新查询整个表单，而不仅仅是组合框。这将是一个非常不寻常的情况。

更新后：

```
Private Sub Form_AfterUpdate()    
    On Error GoTo Proc_Err 

    Me.cboSearch.Requery   

    Exit Sub    
Proc_Err:    
    MsgBox Err.Number & vbCrLf & vbCrLf & Err.Description
    Err.Clear        
End Sub 
```

删除后：

```
Private Sub Form_Delete(Cancel As Integer)    
    On Error GoTo Proc_Err 

    Me.cboSearch.Requery   

    Exit Sub    
Proc_Err:    
    MsgBox Err.Number & vbCrLf & vbCrLf & Err.Description
    Err.Clear        
End Sub 
```

# svn - 核对svn存储库中的巨大文件

> ID：80833
> 
> 赞同：18
> 
> 时间：2008-09-17T07:35:25.580
> 
> 标签：svn, large-files

作为本地颠覆沙皇，我向大家解释说，在存储库中只保留源代码和非巨大的文本文件，而不是巨大的二进制数据文件。可能是作为测试一部分的较小的二进制文件。

不幸的是我和*人类*一起工作！有人可能有一天会不小心提交了一个 800MB 的二进制 hulk。这会减慢存储库操作。

上次我检查时，您无法从存储库中删除文件；只是使它不属于最新版本。存储库永远保留这个怪物，以防有人想回忆那个日期或修订号的存储库状态。

有没有办法真正删除那个怪物文件并最终得到一个大小合适的存储库？我已经尝试过 svnadmin 转储/加载，但它很痛苦。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-17T07:48:34.893

要从 svn 存储库中永久删除怪物文件，除了使用 svnadmin dump/load 没有其他解决方案。（[SVN 书：转储命令](http://svnbook.red-bean.com/en/1.4/svn.ref.svnadmin.c.dump.html)）

为了防止提交大文件，可以使用挂钩脚本。例如，当有人尝试提交到存储库时，您可以拥有一个运行“预提交”的脚本。该脚本可能会检查文件大小或文件类型，如果它包含一个或多个文件太大或属于“禁止”类型，则拒绝提交。

钩子脚本的更典型用途是检查（预提交）提交是否包含日志消息，或（提交后）通过电子邮件发送提交的详细信息或使用新提交的文件更新网站。

挂钩脚本是响应存储库事件响应而运行的脚本（[SVN 书籍：创建挂钩](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.create.html#svn.reposadmin.create.hooks)）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-18T21:34:40.610

关于这方面的一些额外信息可以在博客文章中找到：[Subversion Obliterate, the missing feature](http://blog.projectnibble.org/2008/03/01/subversion-obliterate-the-forgotten-feature/)

一定要仔细阅读评论，卡尔福格尔将文章放在透视图中:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T17:04:48.490

如果您可以在它提交后立即捕获它，那么 svnadmin 转储/加载技术不会太痛苦。假设有人在修订版 3849 中不小心提交了 gormundous-raw-image.psd。你可以这样做：

```
svnadmin dump /var/repos -r 1:3848 > ~/repos_dump 
```

这将创建一个转储文件，其中包含直到并包括修订版 3848 在内的所有内容。此时，您可以使用 svnadmin create 和 svnadmin load 重新构建存储库而不会出现违规提交，需要注意的是您在存储库的目录结构中所做的任何更改 - - 挂钩、符号链接、权限更改、身份验证文件等 - 需要从旧目录复制过来。以下是您可能用来完成操作的 bash 会话的其余部分的示例：

```
svnadmin create /var/repos-new
svnadmin load /var/repos-new < ~/repos_dump
cp -r /var/repos/conf /var/repos-new
cp -r /var/repos/hooks /var/repos-new
mv /var/repos{,-old} && mv /var/repos-new /var/repos 
```

我敢肯定，您的存储库拥有的历史越多，这将越痛苦，但它确实有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T08:14:20.760

从 HEAD 修订中删除文件后，它不会减慢您的操作速度，因为只处理修订之间的增量。（存储库备份当然必须处理负载）。

# screen-scraping - 除了正则表达式之外，还有其他方法可以进行屏幕抓取吗？

> ID：80834
> 
> 赞同：1
> 
> 时间：2008-09-17T07:35:30.743
> 
> 标签：screen-scraping

我正在做一个个人的、只是为了好玩的项目，它使用屏幕抓取来给我一个系统托盘通知，以防 HTML 表上的另一行被添加、修改或删除。

在我想到之前已经这样做了：好吧，让我们使用正则表达式，仅此而已，但是作为一个好奇的人，让我认为可能还有其他东西可以有另一种范式，但使用起来很简单。

我了解 DOM 和 X-Path 以及所有 xml'ish 方法。我正在寻找一些开箱即用的东西，甚至可以在一组规则中定义的东西，这样你就可以制作一个插件系统来聚合各种网站。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T07:42:54.893

请参阅[HTML 抓取选项](https://stackoverflow.com/questions/2861/options-for-html-scraping)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T07:44:51.330

这是一个想法：假设您的主要用例是在 HTML 文件更改时收到通知，为什么不使用标准差异工具，然后循环通过更改的行，应用您的规则？

此外，如果在这种情况下您可以访问服务器和您正在观看的文件，您也许可以使用 CVS（或类似工具）将所有内容置于源代码控制之下，然后只关注提交。如果您想对网络上的随机站点使用这种方法，只需编写一个脚本，该脚本会定期下载适当 URL 的 html，然后将其提交到源代码控制并观察差异。

不是很实用，但在盒子外面。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-17T07:43:04.267

[如果您可以使用SgmlReader](http://wiki.developer.mindtouch.com/Community/SgmlReader)或[HtmlTidy 之](http://tidy.sourceforge.net/)类的东西将源代码转换为有效的 XHTML/XML，那么您可以使用 XSLT。只需为您希望抓取的每个站点创建一个 XSL 模板。

# iis - 如何使用 LogParser 找出 IIS 日志中字段的长度？

> ID：80844
> 
> 赞同：27
> 
> 时间：2008-09-17T07:38:00.800
> 
> 标签：iis, logparser

我试图在我的 IIS 日志中使用 LogParser.exe 查找 LONG UserAgent 字符串。此示例搜索其中包含字符串“poo”的条目。

```
LogParser.exe -i:IISW3C 
"SELECT COUNT(cs(User-Agent)) AS Client 
FROM *.log WHERE cs(User-Agent) LIKE '%poo%'" 
```

我想说“有多少条目的用户代理比'x'长”。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-17T07:47:30.683

好吧，看起来我回答了我自己的问题。

```
LogParser.exe -i:IISW3C 
"SELECT COUNT(cs(User-Agent)) AS Client 
FROM *.log WHERE STRLEN(cs(User-Agent)) > 100" 
```

# php - Zend 框架选择运算符优先级

> ID：80846
> 
> 赞同：0
> 
> 时间：2008-09-17T07:38:23.937
> 
> 标签：php, mysql, zend-framework

我正在尝试使用 Zend_Db_Select 编写一个看起来像这样的选择查询：

```
SELECT * FROM bar WHERE a = 1 AND (b = 2 OR b = 3) 
```

但是，当使用 where() 和 orWhere() 的组合时，似乎不可能像上面那样使用条件分组。

Zend Framework 中是否有任何本机方式来实现上述目标（无需编写实际查询？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T07:43:00.227

来自[手册](http://framework.zend.com/manual/en/zend.db.select.html#zend.db.select.building.where)（示例 11.61。用括号括起来的布尔表达式示例）

```
 // Build this query:
//   SELECT product_id, product_name, price
//   FROM "products"
//   WHERE (price < 100.00 OR price > 500.00)
//     AND (product_name = 'Apple')

$minimumPrice = 100;
$maximumPrice = 500;
$prod = 'Apple';

$select = $db->select()
             ->from('products',
                    array('product_id', 'product_name', 'price'))
             ->where("price < $minimumPrice OR price > $maximumPrice")
             ->where('product_name = ?', $prod); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:33:23.013

上面的参考很好，但是如果你玩的是弦乐呢？

这是上面带有字符串的示例...

```
// Build this query:
//   SELECT product_id, product_name, price
//   FROM "products"
//   WHERE (product_name = 'Bananas' OR product_name = 'Apples')
//     AND (price = 100)

$name1 = 'Bananas';

$name2 = 'Apples';

$price = 100;

$select = $db->select()

->from('products',
                    array('product_id', 'product_name', 'price'))

->where("product_name = '" . $name1 . "' OR product_name = '" . $name2 . "'")

->where("price=?", $price); 
```

我希望这会有所帮助。花了我一些时间让字符串正常工作。

干杯。

# visual-studio - 在 Visual Studio 2008 中，如何让 control+click 执行“转到定义”？

> ID：80857
> 
> 赞同：19
> 
> 时间：2008-09-17T07:40:49.717
> 
> 标签：visual-studio, visual-studio-2008, ide

在 Delphi IDE 中，您可以按住控制并单击方法以跳转到其定义。在 VS2008 中，您必须右键单击并选择“转到定义”。

我经常使用这个功能，所以我真的很想让 VS 在这方面表现得像 Delphi - 它的 ctrl+click 快得多。

我认为没有办法让它在基础 VS2008 中工作 - 我错了吗？或者也许有一个我可以使用的插件？

**编辑**：单击然后 F12 确实有效 - 但对我来说并不是一个很好的解决方案。它仍然比 ctrl+click 慢。我可能会尝试 AutoHotkey，因为我已经在为别的东西运行它了。

**编辑**：[AutoHotkey](http://www.autohotkey.com)为我工作。这是我的脚本：

```
SetTitleMatchMode RegEx
#IfWinActive, .* - Microsoft Visual Studio
^LButton::Send {click}{f12} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-16T08:08:00.413

不适用于 Visual Studio 2008，但如果升级到 Visual Studio 2010，则可以使用 Microsoft 提供的免费 [Visual Studio 2010 Pro Power Tools](http://visualstudiogallery.msdn.microsoft.com/en-us/d0d33361-18e2-46c0-8ff2-4adea1e34fef)来实现此目的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T07:44:51.300

Visual Studio 2008 默认为 F12，但您可以在工具 | 中设置它。选项 | 环境 | 键盘，然后更改 Edit.GoToDefinition - 但是，我不确定如何将其设置为 CTRL+鼠标单击。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T07:45:20.363

[Resharper 会这样做](http://www.jetbrains.com/resharper/)，但它不是免费的。虽然强烈推荐插件，但大多数有经验的 .NET 开发人员都使用它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-17T07:54:17.720

您可以创建一个 Autohotkey 脚本来执行此操作。当您按住 ctrl 键单击一个单词时，双击然后按 F12。

我手边没有 AHK，所以我无法尝试绘制一些代码，但它应该很容易；AHK 记录器应该有足够的功能让你以点“n”点击的方式创建它，而 IIRC 它足够聪明，可以让你将这种行为限制在某个类的窗口中。

准备好脚本后，只需在编写代码时在后台运行脚本即可。它只需要通知栏中的一个图标。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-04-13T22:30:00.813

请注意，以下 AutoHotkey 脚本适用于我在 Visual C++ 2010 Express 中。

```
SetTitleMatchMode 2
#IfWinActive, Microsoft Visual C++ 2010 Express
^LButton::Send {click}{f12} 
```

因为我习惯了 Eclipse，所以我还将 View.NavigateForward 和 View.NavigateBackward 的快捷方式更改为 Alt+Right/Left Arrow。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-25T21:06:11.660

是的，Resharper（必须拥有！）和 Productivity Power Tools 都具有此功能。

不过，有趣的怪癖。

如果您只使用两个工具的默认值（如果您安装了两个工具），您可能会遇到频繁的双跳问题（从您第一次单击的位置跳转到定义，然后在第一次到达时从光标上方的位置再次跳转定义），直到您关闭这些附加组件的 Ctrl-Click 功能之一。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-17T07:42:56.937

将鼠标光标放在方法名称或任何标识符上，然后按`F12`

# ruby-on-rails - 如何在 Rails 中的不同数据库上执行直接 SQL 代码

> ID：80859
> 
> 赞同：4
> 
> 时间：2008-09-17T07:41:28.763
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在编写一个 Rails 应用程序，它将监视某些特定数据库的数据质量。为了做到这一点，我需要能够对这些数据库执行直接 SQL 查询——这当然与用于驱动 Rails 应用程序模型的查询不同。简而言之，这意味着我不能使用通过 ActiveRecord 基本连接的技巧。

我需要连接的数据库在设计时是未知的（即：我不能将它们的详细信息放在 database.yaml 中）。相反，我有一个模型“database_details”，用户将使用它来输入应用程序将在运行时执行查询的数据库的详细信息。

所以到这些数据库的连接真的是动态的，细节只在运行时解决。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T08:45:11.140

您可以使用这样的调用以编程方式建立连接

```
ActiveRecord::Base.establish_connection(
   :adapter  => "mysql",
   :host     => "localhost",
   :username => "myuser",
   :password => "mypass",
   :database => "somedatabase"
) 
```

如您所见，您可以将 somedatabase 替换为一个`database_model.database_name`值。适配器和所有设备也是如此。

有关更多信息，请参阅[`ActiveRecord::Base.establish_connection`文档](http://api.rubyonrails.com/classes/ActiveRecord/Base.html#M001397)。

然后你可以使用：

```
ActiveRecord::Base.find_by_sql("select * ") 
```

执行您的 SQL 查询。

有关更多信息，请参阅[`ActiveRecord::Base.find_by_sql`文档](http://api.rubyonrails.com/classes/ActiveRecord/Base.html#M001302)。

如果不完整[，马特先生是对的。](https://stackoverflow.com/users/12037/mr-matt)

可以在[此处](http://wiki.rubyonrails.org/rails/pages/HowtoUseMultipleDatabases)找到更多过时但对设计方法仍然有用的信息，并记住在完成后重新连接到普通数据库。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-09-17T17:16:56.250

我遇到过这样的情况，我必须连接到外部应用程序的数百个不同实例，并且我执行了类似于以下的代码：

```
 def get_custom_connection(identifier, host, port, dbname, dbuser, password)
      eval("Custom_#{identifier} = Class::new(ActiveRecord::Base)")
      eval("Custom_#{identifier}.establish_connection(:adapter=>'mysql', :host=>'#{host}', :port=>#{port}, :database=>'#{dbname}', " +
      ":username=>'#{dbuser}', :password=>'#{password}')")  
    return eval("Custom_#{identifier}.connection")
  end 
```

这有一个额外的好处，即不更改模型继承的 ActiveRecord::Base 连接，因此您可以针对此连接运行 SQL 并在完成后丢弃该对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T07:56:03.393

您可以通过[`self.establish_connection`](http://blog.whitet.net/articles/2008/01/30/rails-has_many-with-models-over-different-databases).

# apache-flex - 如何处理使用 Flex Sound 类加载的错误

> ID：80863
> 
> 赞同：3
> 
> 时间：2008-09-17T07:42:17.610
> 
> 标签：apache-flex, flash, actionscript-3

我在 Flex 3 中看到 flash.media.Sound 类的奇怪行为。

```
var sound:Sound = new Sound();
try{
sound.load(new URLRequest("directory/file.mp3"))
} catch(e:IOError){
 ...
} 
```

然而，这没有帮助。我收到一个流错误，它实际上似乎在 Sound 构造函数中。

> 错误 #2044：未处理的 IOErrorEvent：。文本=错误 #2032：流错误。在... ]

我在 Flex 文档中看到了一个示例，他们为 IOErrorEvent 添加了一个事件侦听器，当然我不必这样做，并且可以简单地使用 try-catch？我可以设置一个空事件监听器吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T13:33:39.183

[IOError](http://livedocs.adobe.com/flex/3/langref/flash/errors/IOError.html) = 无法找到目标文件（或由于某些其他原因无法读取）。检查文件的路径。

编辑：我刚刚意识到这可能不是你的问题，你只是想捕捉 IO 错误？如果是这样，您可以这样做：

```
变种声音：声音=新声音（）；
sound.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
sound.load(new URLRequest("directory/file.mp3"));

函数ioErrorHandler（事件：IOErrorEvent）：无效{
    trace("发生 IO 错误");
}

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T09:27:14.953

由于 URLRequest 不是即时的，因此您需要添加一个侦听器。如果您从磁盘加载，它会**非常快，但您仍然需要事件侦听器。**[在livedocs](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/media/Sound.html#load())中有一个很好的例子来说明如何设置（完成 IOErrorEvent 处理）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:23:28.940

try...catch 仅适用于调用该函数时引发的错误。任何涉及从网络、磁盘等加载内容的方法都是异步的，也就是说，当您调用它时它不会正确执行，而是在您调用它后不久发生。在这种情况下，您确实需要 addEventListener 来捕获任何错误或事件或知道何时完成加载。

# macos - 在 OS X 中创建硬链接到目录的 Unix 命令是什么？

> ID：80875
> 
> 赞同：56
> 
> 时间：2008-09-17T07:43:32.457
> 
> 标签：macos, bash, filesystems, unix, ln

如何在 OS X 中创建指向目录的硬链接（而不是符号链接或 Mac OS 别名）？我已经知道命令“ln target destination”，但仅当目标是文件时才有效。我知道 Mac OS 与其他 Unix 环境不同，它确实允许硬链接到文件夹（例如，这用于 Time Machine），但我自己不知道该怎么做。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2011-01-16T18:32:44.023

我同意硬链接文件夹/目录如果不小心可能会导致问题，但它们有一个非常明确的优势 - Time Machine 就是一个完美的例子。没有它们，它根本不实用，因为复制冗余版本的文件会很快消耗掉最大的磁盘。

只要您遵循 Amit Singh 的六个规则，Snow Leopard 就可以创建指向目录的硬链接：

1.  文件系统必须记录 HFS+。
2.  源和目标的父目录必须不同。
3.  源的父级不能是根目录。
4.  目标不得位于根目录中。
5.  目标不能是源的后代。
6.  目标不得有任何作为目录硬链接的祖先。

因此，Snow Leopard 失去了创建文件夹硬链接的能力是完全不正确的。

我刚刚验证了链接/取消链接在 Snow Leopard 上确实有效 - 只要您遵循六条规则。我刚刚试了一下，它在我的 Snow Leopard 10.6.6 系统上运行良好 - 在启动卷和单独的 USB 外部卷上试了一下，在这两种情况下都运行良好。

这是“hunlink.c”程序：

```
#include <stdio.h>
#include <unistd.h>
int
main(int argc, char *argv[])
{
   if (argc != 2)
      return 1;
   int ret = unlink(argv[1]);
   if (ret != 0)
      perror("unlink");
   return ret;
}

gcc -o hunlink hunlink.c 
```

所以，如果你尝试它要小心——记住要遵守规则并使用 hlink 创建这些硬链接，然后使用 hunlink 删除硬链接。并且不要忘记记录您为以后或可能需要知道这一点的其他人所做的事情。

我刚刚了解到这些文件夹的“硬链接”的另一个“陷阱”。当您创建它们时，Mac OS X 的“幕后”确实发生了很多事情。一个非常重要的问题是，您创建链接的文件夹实际上被移动到了一个名为 /.HFS+ 的超级神奇的超级隐藏文件夹Private Directory Data%000d/dir_xxx 其中 xxx 是“source_folder”的 inode 编号 - 请记住命令的格式是

```
hlink source_folder target_folder 
```

因此，因此，您必须小心不要在“source_folder”中打开任何文件，因为如果这样做，它们就会被移动到超级神奇的文件夹中，如果您尝试保存任何更改，您可能会遇到问题到那些在“source_folder”中打开的文件。这发生在我身上几次，直到我明白发生了什么并且解决方案非常简单。我注意到您不能再执行“ls -la”命令而不会为原始“source_folder”中的所有文件夹/目录出现有趣的错误，但您可以执行“ls”命令并且一切看起来都很好。

如果您在“磁盘工具”程序中运行“验证磁盘”，您会注意到它可能会抱怨并给出“卷位图需要对孤立块进行小修”，这就是创建超级神奇文件夹时发生的情况“source_folder”向其移动。

如果您确实发现自己处于这种“孤立块”的情况，首先将更改的文件保存到不在包含“source_folder”树的卷中的其他临时位置，然后使用“磁盘工具”卸载并重新安装包含“source_folder”或只是重新启动计算机。然后将您保存到临时位置的文件复制回其原始位置，您应该可以恢复业务。这对我有用，所以不能保证这对你也有用。因此，在您有良好备份的卷上尝试此操作可能是一个好主意，以防万一。

看起来很奇怪，所有这些开销都发生在创建文件夹硬链接的简单任务上。有谁知道为什么 Mac OS X 会为创建到文件夹的硬链接而付出所有这些努力？这与这是一个“日志式”文件系统这一事实有关吗？

通过阅读 Amit Singh 对他的“hfsdebug”实用程序的解释，我发现了有关超级神奇、超级隐藏位置的信息。如果您想了解更多详细信息，请访问他的网站[Amit Singh 的 hfsdebug 实用程序](http://osxbook.com/blog/2008/11/09/hfsdebug-40-and-new-hfs-features/)。这是一个非常有趣的软件，它会告诉你很多关于 HFS+ 文件系统的细节。它是免费的，我鼓励您下载并试用。它不再受支持，但它仍然适用于 Snow Leopard 和 Leopard - 基本上是任何支持 HFS+ 的系统。你真的不能对它造成任何伤害，因为它是一个“只读”工具——所以它非常适合用来查看文件系统的一些细节。

还有一个关于这些“文件夹硬链接”的问题——一旦你创建了一个超级神奇的超级秘密隐藏文件夹，它就永远存在了。即使您取消了最初创建它的文件夹的链接，这个神奇的文件夹仍然存在。不知道为什么，但确实如此。如果您想尝试一下，可以使用“hfsdebug”来查找。您还可以使用“hfsdebug”来找出驱动器上存在多少这些“到文件夹的硬链接”。有关这些详细信息，请参阅 Amit 关于“hfsdebug”实用程序的文章。

他还有另一个受支持但成本较新的实用程序。它被称为 fileXray，一个人在同一家庭的任意数量的计算机上的个人非商业类型许可证的费用为 79 美元。它有一个详尽的 173 页用户指南，您可以在购买前下载它以查看它可以做什么。不幸的是，没有试用版，因此请阅读手册并查看网站以获取更多详细信息，看看它是否可以帮助您摆脱困境。在他们的网站上了解有关它的所有详细信息 - 请参阅[fileXray 网站](http://filexray.com/)了解更多信息。

在使用这些指向文件夹的硬链接时，您应该注意几个问题。如果创建它们的卷安装到远程客户端，则可能会出现严重问题，具体取决于它们的安装方式。如果您使用 AFP 将卷挂载到远程客户端，则存在很大的问题，因为当前有硬链接或曾经有硬链接但后来被删除的任何文件夹将无法用作所有较低级别的文件夹（但不是文件）将无法从 Finder 或终端窗口访问。如果您尝试执行简单的“ls -lR”命令，它将失败并为您提供所有较低级别文件夹的“ls: xxx: No such file or directory”错误消息。如果您使用 Finder 窗口遍历远程卷的目录树，

如果您使用 NFS 挂载远程客户端（并假设您在系统上有一个 NFS 服务器将该卷作为本地 HFS+ 文件系统），则这些问题似乎不会发生（除了错误消息）。此处未提供有关如何使用 NFS 挂载卷的详细信息。我使用了 Marcel Bresink 博士提供的一个名为“NFS Manager”的好程序来帮助在服务器和客户端上安装 NFS。你可以从他的网站上得到它——只需在你最喜欢的搜索引擎中搜索“Bresink NFS Manager”，但他有一个免费试用版，所以你可以在购买前试用。如果您想学习如何进行 NFS 挂载，这没什么大不了的，但是“NFS 管理器”使设置和调整所有不同的设置以帮助优化它变得非常容易。他还有其他几款价格非常合理的简洁 Mac OS X 实用程序 - 一款称为“硬件监视器”，可让您监控和绘制各种数据，如电源使用情况、CPU 温度、风扇速度以及两者的许多其他变量长时间（从几分钟到几天）的本地和远程 Mac 系统。如果您喜欢方便的实用程序，绝对值得一试。

我确实注意到的一件事是，NFS 文件传输比通过 AFP 传输要慢 20%，但是您的“里程可能会有所不同”，所以不能保证一种或另一种方式，但我宁愿有一些可以工作的东西，即使我有与根本没有任何工作相比，要付出 20% 的性能损失。

Apple 意识到硬链接和远程 AFP 文件系统的问题，他们将其称为 AFP 客户端的“实施限制”——我更愿意称它为在我看来的真实情况——一个错误！！！我只能希望 Mac OS X 的下一个版本能解决这个问题，因为我真的很喜欢能够在有意义的时候使用硬链接到文件夹。

这些笔记是我个人的意见，我不保证它们的正确性，所以使用它们需要您自担风险。在使用这些“文件夹的硬链接”之前，请做好备份，以防万一发生意外情况。但是，如果您决定更多地了解 Mac OS X 的这个有趣方面，我希望您会玩得开心。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-04-30T01:20:24.220

那你不能直接在 BASH 中做。但是...我在这里找到了一篇文章，讨论了如何间接地做到这一点：http: [//www.mactech.com/articles/mactech/Vol.23/23.11/ExploringLeopardwithDTrace/index.html](http://www.mactech.com/articles/mactech/Vol.23/23.11/ExploringLeopardwithDTrace/index.html)通过编译一个简单的小 C 程序：

```
#include <unistd.h>
#include <stdio.h>

int main(int argc, char *argv[])
{
   if (argc != 3) return 1;

   int ret = link(argv[1], argv[2]);

   if (ret != 0) perror("link");

   return ret;
} 
```

...并在 Terminal.app 中构建：

```
$ gcc -o hlink hlink.c -Wall 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-01-10T18:41:25.173

废话。**在 10.5 上，它在ln**的手册页中告诉您：

```
 -d, -F, --directory
          allow the superuser to attempt to hard link  directories  (note:
          will  probably  fail  due  to  system restrictions, even for the
          superuser) 
```

所以是的：

```
 sudo  ln  -d  existing_dir  new_hard_link 
```

给它你的密码，**你还没有完成**。你没有记录它，是吗？您**必须**记录硬链接目录；即使它是单用户机器。

删除是另一回事：如果您按照通常的方式删除目录，您将删除内容。所以你**必须**“取消链接”目录：

```
 unlink  new_hard_link 
```

那里。希望你不要破坏你的文件系统！

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-06-10T07:47:54.130

*交叉发布[这个巧妙地解决问题的好工具](https://stackoverflow.com/a/5118678/195835)，最初由[Sam](https://stackoverflow.com/users/634331/sam)发布：*

* * *

要安装 Hardlink，请确保您已安装[homebrew](http://brew.sh/)，然后运行：

```
brew install hardlink-osx 
```

安装后，创建一个硬链接：

```
hln [source] [destination] 
```

我还注意到该`unlink`命令在雪豹上不起作用，所以我添加了一个取消链接的选项：

```
hln -u destination 
```

* * *

有兴趣的人可以在 Github 上找到代码：[https ://github.com/selkhateeb/hardlink](https://github.com/selkhateeb/hardlink)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-17T08:35:34.877

是的，它受到内核和文件系统的支持，但由于它不是为一般用途而设计的，因此它不会暴露给 shell。

您可能可以算出 Time Machine 使用哪些 API 并将它们包装在命令行工具中，但最好听从提示并清楚地引导。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-10-06T08:57:36.440

OSX 版本`ln`无法做到这一点，但是，正如[丰富](https://stackoverflow.com/a/2038065/191246)的另一个答案中所提到的，它的 GNU 版本`ln`可以在[自制软件](http://brew.sh)中作为[coreutils](http://brewformulas.org/Coreutil)公式`gln`的一部分使用。列出了[丰富](https://stackoverflow.com/a/2038065/191246)的答案中提供的带有 OSX 特定警告的选项。换句话说，它并非在所有情况下都有效。究竟是什么决定了它是否有效，似乎并没有在任何地方记录。`man gln``-d`

作为先决条件，安装`coreutils`：

```
 brew install coreutils 
```

现在你可以这样做：

```
 sudo gln -d /original_folder /mirror_folder 
```

**重要提示**：要删除硬链接，您***必须***使用`gunlink`：

```
 sudo gunlink /mirror_folder 
```

> ❗️❗️❗️**使用`rm`或 Finder 也会删除原来的文件夹。**

仅供参考：[coreutils](http://brewformulas.org/Coreutil) homebrew 公式提供了通用 unix 工具的 GNU 兼容版本。用于`brew list coreutils`查看完整列表。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-10-11T07:14:08.573

从 2018 年起不再可能。APFS（在 MacOS High Sierra 10.13 中引入）与目录硬链接不兼容。见[https://github.com/selkhateeb/hardlink/issues/31](https://github.com/selkhateeb/hardlink/issues/31)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-10-14T09:00:11.043

我的情况是，我从 Windows 虚拟机中发现，我无法遵循符号链接。（我想在 Internet Explorer 中测试一些 HTML 页面）。我的目录结构有 CSS 和图像文件夹的符号链接。

我解决问题的解决方法是与其他答案暗示的不同方法。我曾经`rsync`创建文件夹的副本。Rsync 可以解析符号链接并改为复制链接的文件。

这解决了我的问题，而无需使用指向目录的硬链接。如果您只是在处理一小部分文件，这实际上是一个简单的解决方案。

```
rsync -av --copy-dirlinks --delete ../htmlguide ~/src/ 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-15T02:08:40.553

从链接到的文章中，如果您尝试在与原始目录相同的目录中创建硬链接，您将收到该错误。您必须在其他地方创建它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-04-11T04:46:45.483

在 Linux 中，您可以使用绑定挂载来模拟硬链接目录。不确定OSX

```
sudo mount --bind /some/existing_real_contents /else/dummy_but_existing_directory
sudo umount /else/dummy_but_existing_directory 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-09-13T14:28:02.720

这也可以使用内置 Perl（来自终端）来完成，而无需编译任何东西。我的具体用例是针对 Google Drive（不支持符号链接），所以下面的例子反映了这个用例。

要将您的“文档”文件夹链接到 Google Drive 以使其同步：

```
perl -e 'link "/Users/me/Documents", "/Users/me/Google Drive/Documents"' 
```

要从 Google 云端硬盘中删除指向“文档”文件夹的链接：

```
sudo perl -U -e 'unlink "/Users/me/Google Drive/Documents"' 
```

您需要“root”才能取消链接（请参阅“取消链接”perldoc）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-12T21:44:21.537

另一种解决方案是使用可通过端口安装的 bindfs [https://code.google.com/p/bindfs/ ：](https://code.google.com/p/bindfs/)

```
sudo port install bindfs
sudo bindfs ~/source_dir ~/target_dir 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-09-17T08:06:14.243

简短的回答是你不能。:) （除了可能是 root 用户，更准确地说你不应该这样做。）

Unix 只允许一定数量的目录链接——“..”来自其所有子目录和“.”。从自身内部。其他任何东西都可能导致非常混乱的目录树。这显然是/曾经是 Ken Thompson 的设计决定。

（话虽如此，显然Apple的Time Machine确实这样做了:)）

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-12-16T00:24:21.143

如果没有子文件夹，你可以试试

**ln 文件夹路径/*****.* *** 目标文件夹***

 *它在 OSX 10.9 上对我有用

# java - 动态联系信息数据/设计模式：这是否可行？

> ID：80876
> 
> 赞同：0
> 
> 时间：2008-09-17T07:43:33.067
> 
> 标签：java, sql, design-patterns

我目前正在开发一个 Web 业务应用程序，该应用程序具有许多实体（人员、组织）和大量联系信息，即。多个邮政地址、电子邮件地址、电话号码等。

目前，数据库模式是这样的，个人表具有邮政地址列、电话号码列和组织表一样。这不是处理这个问题的好方法。

我已经阅读了关于此的 c2 Wiki，并且有一些关于[联系人和地址模型（](http://c2.com/cgi-bin/wiki?ContactAndAddressModels)[http://c2.com/cgi-bin/wiki?ContactAndAddressModels](http://c2.com/cgi-bin/wiki?ContactAndAddressModels)）以及[物理地址是否过时（](http://c2.com/cgi-bin/wiki?ArePhysicalPostalAddressesArchaic)[http://c2 .com/cgi-bin/wiki?ArePhysicalPostalAddressesArchaic](http://c2.com/cgi-bin/wiki?ArePhysicalPostalAddressesArchaic)）。这两次讨论真的让我对这个问题的范围大开眼界。

我正在考虑将**联系信息字段分隔为单独的表**。但是最好的方法是什么。目前，该应用程序主要处理芬兰地址，但它还需要处理国际地址。

我可以定义一个“地址”表、一个“电话号码”表、一个“电子邮件地址”表等等，这些将与人和组织相关联。但这感觉太像以前的解决方案：预定义的数据库模式不可避免地不够用。

我提议的是创建一个**动态**的联系信息架构/程序逻辑：

*   没有预定义的联系信息字段/字段集
*   用户可以随时定义新的联系信息类型和必填字段，例如
    *   芬兰邮政地址
    *   瑞典邮政地址
    *   ... 邮寄地址
    *   电话号码
    *   电子邮件地址
    *   ICQ号码

**这可行吗？**有没有人做过这样的事情？

可能有一个定义联系信息类型的表：

### 联系信息类型

*   ID：标识符
*   名称：“芬兰邮政地址”
*   描述：“将此联系信息类型用于芬兰邮政地址”

然后可能有一个表来定义每种联系信息类型使用的字段：

### 联系信息类型字段

*   ID：标识符
*   Contact_information_type_id：参考上表
*   字段标题：“地址第 1 行”
*   字段描述：“将此行用于邮政地址的第一行”
*   字段类型：字符串/整数/等。
*   字段格式：用于验证字段数据的正则表达式
*   字段顺序：显示/使用此联系信息类型时，此字段应按什么顺序出现

然后我们将有一个“联系信息表”，它仅用于将联系信息字段映射在一起：

### 联系信息

*   ID：标识符
*   Contact_information_type_id：引用联系信息类型表

然后我们会有一个“人的联系信息” - 将不同的联系信息映射到人的表：

### 人的联系方式

*   ID：标识符
*   Contact_information_id：引用联系信息表
*   人员 id：引用人员

然后我们需要每个联系信息字段类型的表格，例如：

### 联系信息整数字段

*   ID：标识符*   Contact_information_id：引用联系信息表*   值：该字段的值

等等字符串等...

最后，当显示给定人员的不同联系信息时，这将通过**人员的联系信息**- 表来查找用于从**联系信息类型字段**-表到**联系信息**- 表中形成此联系信息的字段。在确定使用了哪些字段之后，所有必要的表将被连接在一起。

我对 in SQL 的可行性表示怀疑。有什么想法吗？

在 Java 中，我可能可以编写一些逻辑来确定需要哪些表来形成联系信息实体，然后我可以使用某种动态 bean 在 Java 中表示这些数据。但这对我来说也有点模糊。对此也有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T07:52:22.967

它开始听起来像你有一个非常好的锤子（即你的 SQL 数据库）并且你正试图用它做另一个锤子（一种用于定义 SQL 模式的元语言）。

在您走这条路之前，市场上有许多旨在将客户详细信息存储在 SQL 数据库中的产品。最好只购买一个现成的并与之集成。然后，您所关心的所有问题都由其他人解决，您可以专注于您的特定业务案例。

编辑：允许您添加自定义联系人字段的软件包的一个示例是[SugarCRM](http://www.sugarcrm.com/crm/about/about-sugarcrm.html) - 它是一种商业产品，您可以在其中购买对购买源的访问权限。我敢肯定还有更多，但这是目前唯一想到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T07:56:45.123

你的设计是可行的，我和下一个人一样非常喜欢规范化，但你真的必须在某个地方找到平衡。因此，首先，我认为拥有地址 1、地址 2、地址 3 等字段是正确的做法......是不好的做法。如果您计划处理来自不同国家的许多不同类型的邮寄地址，那么抽象出各种地址类型可能是有意义的。

想想你想要从系统中取出的数据——例如，有人会询问某个州或省的所有客户吗？在这种情况下，您的设计将非常痛苦。

要记住的另一件事是，数据库模式更改虽然有时会很痛苦，但并不是世界上最糟糕的事情。沿着这条路径走向它的逻辑极端，你最终会得到一个巨大的表，其中包含“key”和“value”等字段以及每个查询中的数千个自联接。

祝你好运找到正确的平衡！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T08:57:00.220

First: Speaking pragmatically, it depends what you want to do with the data. In my experience, 99% of all address data is only ever used as a string to be printed on a letter. If that is the case for you, then you should stop worrying and just store it as a string. Of course, if you're doing deeper work with it then it's not going to be so easy.

Apart from that... I like the way you're thinking. I have done similar things (although not with addresses) to handle dynamic schemas. The problem I run into is (as you've identified) that the SQL to extract the stuff gets complex. Another problem is that this flexibility can lead to spaghetti data, in exactly the same way you can get spaghetti code. I.e. the meaning of what's in your tables can become obscured because you can only understand it by looking at the code which accesses it.

So, what you have to decide is where you are prepared to accept complexity, and what kind of complexity you can best handle. If you don't mind complex SQL, then go ahead and build your dynamic schema. If you do mind complex SQL, then either build the static tables (with one table per address type), or accept that you won't have such an elegant data structure.

So, short answer: you have to call it.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T07:50:43.313

这不是一个信息量很大的帖子；您是否看过 vCard 人员如何处理相同的问题？另外，请注意过度工程，您最终可能会得到[N3](http://en.wikipedia.org/wiki/Notation_3 "N3")。

# java - 获取方法：一对多

> ID：80892
> 
> 赞同：10
> 
> 时间：2008-09-17T07:45:37.193
> 
> 标签：java, oop, jakarta-ee

getEmployeeNameByBatchId(int batchID)
getEmployeeNameBySSN(Object SSN)
getEmployeeNameByEmailId(String emailID)
getEmployeeNameBySalaryAccount(SalaryAccount SalaryAccount)

或者

getEmployeeName(int typeOfIdentifier, byte[] identifier) -> 在此方法中，typeOfIdentifier 告诉标识符是否为 batchID/SSN/emailID/salaryAccount

以上哪一种是实现get方法的更好方法？

这些方法将在一个 Servlet 中，并从一个提供给客户的 API 进行调用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T07:49:00.120

为什么不重载 getEmployeeName(??) 方法？

getEmployeeName(int BatchID)
~~getEmployeeName(object SSN)~~（坏主意）
getEmployeeName(String Email)
等。

对我来说似乎是一个很好的“多”方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T08:10:02.767

你可以使用类似的东西：

```
interface Employee{
    public String getName();
    int getBatchId();
}
interface Filter{
    boolean matches(Employee e);
}
public Filter byName(final String name){
    return new Filter(){
        public boolean matches(Employee e) {
            return e.getName().equals(name);
        }
    };
}
public Filter byBatchId(final int id){
    return new Filter(){
        public boolean matches(Employee e) {
            return e.getBatchId() == id;
        }
    };
}
public Employee findEmployee(Filter sel){
    List<Employee> allEmployees = null;
    for (Employee e:allEmployees)
        if (sel.matches(e))
            return e;
    return null;
}
public void usage(){
    findEmployee(byName("Gustav"));
    findEmployee(byBatchId(5));
} 
```

如果您通过 SQL 查询进行过滤，您将使用该`Filter`接口来编写 WHERE 子句。

这种方法的好处是您可以轻松地将两个过滤器与：

```
public Filter and(final Filter f1,final Filter f2){
    return new Filter(){
        public boolean matches(Employee e) {
            return f1.matches(e) && f2.matches(e);
        }
    };
} 
```

并像这样使用它：

```
findEmployee(and(byName("Gustav"),byBatchId(5))); 
```

你得到的类似于`Criteria`Hibernate 中的 API。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T07:48:55.737

我会采用“多”的方法。这对我来说似乎更直观，更不容易出错。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T08:08:39.650

我不喜欢 getXByY() - 这在 PHP 中可能很酷，但我只是不喜欢在 Java (ymmv) 中。

我会选择重载，除非你有相同数据类型的属性。在这种情况下，我会做类似于你的第二个选项的事情，但我不会使用整数，而是使用 Enum 来确保类型安全和清晰。而不是 byte[]，我会使用 Object（因为自动装箱，这也适用于原语）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T07:59:57.970

这些方法是使用重载的完美示例。

```
getEmployeeName(int batchID)
getEmployeeName(Object SSN)
getEmployeeName(String emailID)
getEmployeeName(SalaryAccount salaryAccount) 
```

如果方法内部有共同的处理，只需再写一个 getEmplyeeNameImpl(...) 并在那里提取共同代码以避免重复

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T07:50:26.357

第一个选项，毫无疑问。明确。它将极大地有助于可维护性，并且确实没有缺点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T07:55:49.870

@Stephan：很难重载这样的情况（通常），因为参数类型可能没有区别，例如，

*   getEmployeeNameByBatchId(int batchId)
*   getEmployeeNameByRoomNumber(int roomNumber)

另请参阅原始帖子中的两个方法getEmployeeNameBySSN，getEmployeeNameByEmailId。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T08:15:49.383

有时使用[规范模式](http://en.wikipedia.org/wiki/Specification_pattern)会更方便。

例如：GetEmployee(ISpecification<Employee> 规范)

然后开始定义您的规格...

NameSpecification : ISpecification<Employee>
{
私有字符串名称；
public NameSpecification(string name) { this.name = name; }
public bool IsSatisFiedBy(Employee employee) { return employee.Name == this.name; }
}

NameSpecification 规范 = 新 NameSpecification("Tim");
员工 tim = MyService.GetEmployee(spec);

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T08:46:52.353

我将使用明确的方法名称。维护该代码的每个人和我以后都会明白该方法在做什么，而无需编写 xml 注释。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T07:49:07.873

我会使用第一个选项，或者在这种情况下重载它，因为你有 4 个不同的参数签名。但是，具体有助于在 3 个月后理解代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T07:52:58.237

第一个可能是 Java 中最好的，因为它是类型安全的（与另一个不同）。此外，对于“普通”类型，第二种解决方案似乎只为用户提供了繁琐的使用。但是，由于您使用 Object 作为 SSN 的类型（它具有 Object 之外的语义含义），您可能无法摆脱这种类型的 API。

总而言之，在这种特殊情况下，我会使用带有许多吸气剂的方法。如果所有标识符都有自己的类类型，我可能会走第二条路线，但在内部切换类而不是提供/应用程序定义的类型标识符。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T07:54:18.780

这些方法中的每一个内部的逻辑是否大致相同？

如果是这样，带有标识符参数的单一方法可能更有意义（简单并减少重复代码）。

如果类型之间的逻辑/过程差异很大，则可能首选每种类型的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T07:55:50.197

正如其他人所建议的那样，第一个选择似乎是好的选择。第二个可能在您编写代码时有意义，但是当其他人稍后出现时，就很难弄清楚如何使用代码。（我知道，你有评论，你总是可以深入挖掘代码，但 GetemployeeNameById 更不言自明）

注意：顺便说一句，在某些情况下可能需要考虑使用枚举。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T07:58:07.273

在像这样的微不足道的情况下，我会选择重载。那是：

```
getEmployeeName( int batchID );
getEmployeeName( Object SSN );

etc. 
```

只有在特殊情况下，我才会在方法名称中指定参数类型，即如果参数的类型难以确定，是否有多种类型的参数具有相同的数据类型（batchId 和employeeId，均为int），或者如果对于每种参数类型，检索员工的方法完全不同。

我不明白为什么我会使用它

```
getEmployeeName(int typeOfIdentifier, byte[] identifier) 
```

因为它要求被调用者和调用者都根据 typeOfIdentifier 转换值。糟糕的设计。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T07:58:59.253

如果你重写这个问题，你最终可能会问：

"SELECT name FROM ..."
"SELECT SSN FROM ..."
"SELECT email FROM ..."
vs.
"SELECT * FROM ..."

我想这个问题的答案很简单，每个人都知道。

如果更改 Employee 类会发生什么？例如：您必须删除电子邮件并添加新的过滤器，例如部门。使用第二种解决方案，如果您只是更改 int 标识符“常量”的顺序，您将有很大的风险不会注意到任何错误。使用第一个解决方案时，您将始终注意到，如果您在一些长期被遗忘的类中使用该方法，否则您会忘记修改为新标识符。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-17T08:09:16.607

我个人更喜欢明确命名“...ByRoomNumber”，因为如果您最终遇到许多“重载”，您最终会引入不需要的错误。直言不讳是最好的方法。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T08:20:45.223

**我同意 Stephan：一项任务，一种方法名称**，即使您可以通过多种方式完成。方法重载功能完全适合您的情况。

*   getEmployeeName(int BatchID)
*   getEmployeeName（字符串电子邮件）
*   等等

并且不惜一切代价**避免您的第二种解决方案。**它闻起来像“你的老空* C”。同样，传递一个Java“对象”几乎和一个C“void *”一样糟糕。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T08:26:56.470

如果你有一个好的设计，你应该能够确定你是否可以使用重载方法，或者你是否会遇到一个问题，如果你重载你最终会得到两个具有相同参数类型的方法。

重载最初似乎是最好的方法，但如果你最终无法在未来添加方法并且将事情弄乱命名，那将是一件麻烦事。

就我个人而言，我希望每个方法都有一个唯一的名称，这样你以后就不会在尝试重载相同的参数 Object 方法时遇到问题。此外，如果将来有人扩展了您的课程并实现了另一个 void getEmployeeName(String name) 它不会覆盖您的课程。

总而言之，为每个方法使用唯一的方法名称，从长远来看，重载只会导致问题。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-17T13:16:59.707

搜索过程与 jrudolf 在他的示例中提出的搜索标准之间的分离非常好。我想知道为什么它不是投票最多的解决方案。我想念什么吗？

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T00:15:20.810

我会选择[Query Objects](http://martinfowler.com/eaaCatalog/queryObject.html)。它们适用于直接访问表。如果您仅限于存储过程，它们会失去一些功能，但您仍然可以使其工作。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-09-17T10:12:48.293

将所有选项都放在一个枚举中，类似于以下内容

```
GetEmployeeName(Enum identifier)
{
    switch (identifier)
    case eBatchID:
    {
        // Do stuff
    }
    case eSSN:
    {
    }
    case eEmailId:
    {
    }
    case eSalary:
    {
    }
    default:
    {
        // No match
        return 0;
    }
}

enum Identifier
{
    eBatchID,
    eSSN,
    eEmailID,
    eSalary
} 
```

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2008-09-17T07:57:07.870

您正在考虑 C/C++。

使用对象而不是标识符字节（或 int）。

**我的坏，重载方法更好，使用 SSN 作为主键不太好**

```
public ??? getEmployeeName(Object obj){

if (obj instanceof Integer){

  ...

} else if (obj instanceof String){

...

} else if .... // and so on

} else throw SomeMeaningFullRuntimeException()

return employeeName
} 
```

我认为最好使用未经检查的异常来表示输入错误。

记录它，以便客户知道期望什么对象。或者创建自己的包装器。我更喜欢第一个选项。

# c# - .Net 2.0：如何使用临时订阅订阅远程计算机上的事件发布者？

> ID：80903
> 
> 赞同：0
> 
> 时间：2008-09-17T07:47:29.547
> 
> 标签：c#, .net, com, comadmin

我的问题是我想要一个服务器应用程序（在远程计算机上）将某些事件发布到几台客户端计算机。服务器和客户端使用 .Net-Remoting 进行通信，因此目前我正在使用远程 .Net-Events 来获取功能。但是有一个缺点：当服务器（事件发布者）下线并重新启动时，客户端会失去连接，因为远程对象引用变得无效。

我正在研究松散耦合事件和瞬态 COM 订阅来解决这个问题。我将一个包含一个发布者和两个订阅者的小型演示应用程序放在一起。它在一台计算机上运行良好。

我正在使用 COMAdmin-Libraries 为事件订阅者创建临时订阅。代码如下所示：

```
MyEventHandler handler = new MyEventHandler();
ICOMAdminCatalog catalog;
ICatalogCollection transientCollection;
ICatalogObject subscription;
catalog = (ICOMAdminCatalog)new COMAdminCatalog();
transientCollection = (ICatalogCollection)catalog.GetCollection("TransientSubscriptions");
subscription = (ICatalogObject)transientCollection.Add();
subscription.set_Value("Name", "SubTrans");
subscription.set_Value("SubscriberInterface", handler);
string eventClassString = "{B57E128F-DB28-451b-99D3-0F81DA487EDE}";
subscription.set_Value("EventCLSID", eventClassString);
string sinkString = "{9A616A06-4F8D-4fbc-B47F-482C24A04F35}";
subscription.set_Value("InterfaceID", sinkString);
subscription.set_Value("FilterCriteria", "");
subscription.set_Value("PublisherID", "");
transientCollection.SaveChanges();
handler.Event1 += OnEvent1;
handler.Event2 += OnEvent2; 
```

我现在的问题是：我必须在订阅中进行哪些更改才能通过网络进行这项工作？甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T10:51:18.777

MSMQ 呢？它似乎非常适合您想要实现的目标？您可以使用传统的发布/订阅模型或多播消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T10:55:14.320

这一步可能有点过头了，但是您是否考虑过使用 WCF 和 WCF 的回调元素？

回调有效地将客户端变成了服务器。老实说，我对回调不是很了解，只是尝试过。不过，也许值得花 10 分钟谷歌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T10:30:14.477

如果您的服务器每隔一段时间就会离线​​，我看不出如何避免轮询它以检查它是否还活着。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T13:46:00.950

当您谈论 COM 和远程计算机时，我怀疑您必须进行一些 DCOM 安全配置。

# web-services - mtom 服务 word 文档

> ID：80908
> 
> 赞同：1
> 
> 时间：2008-09-17T07:48:02.820
> 
> 标签：web-services, java-metro-framework, mtom

有没有人能够使用 Metro (webservices) 作为 mtom 流来提供 word doc？有没有人有示例，或者知道客户端和服务器的示例代码在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T11:13:56.023

[大型附件](https://metro.dev.java.net/guide/Large_Attachments.html)和[二进制附件 (MTOM)](https://metro.dev.java.net/guide/Binary_Attachments__MTOM_.html)示例可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-12T06:29:24.110

不知道为什么 sun 的人会写半生不熟的东西！

尝试给出一个简单的示例代码。希望这可以帮助

[JAX-WS MTOM 示例代码](https://stackoverflow.com/questions/1113656/jax-ws-mtom-sample-code-service-client-need-simple-one)

# windows - 在控制面板中添加我自己的应用程序事件 -> 声音

> ID：80918
> 
> 赞同：7
> 
> 时间：2008-09-17T07:49:54.190
> 
> 标签：windows, language-agnostic, events, audio

我刚刚阅读[了这个问题](https://stackoverflow.com/questions/80564/visual-studio-how-to-trigger-an-alarm-when-a-breakpoint-is-hit)，我真的很喜欢[这个问题](https://stackoverflow.com/questions/80564/visual-studio-how-to-trigger-an-alarm-when-a-breakpoint-is-hit#80587)的答案。很自然地，一个有趣的问题出现在我的脑海里……

如何在控制面板 -> 声音和音频设备 -> 声音 -> 程序事件中添加我自己的事件（我自己的应用程序）？

另一个相关的问题，我想也应该在这里回答......当我的应用程序中的事件发生时，我如何播放控制面板中指定的那些声音？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T08:36:15.293

在 Google 度过的一段美好时光让我看到了一篇名为“[创建您自己的声音警报](http://www.codeproject.com/KB/audio-video/soundalerts.aspx "CodeProject - 创建您自己的声音警报")”的 CodeProject 文章。似乎秘诀都在`HKEY_CURRENT_USER\AppEvents`注册表项下。

来自文章：

> 好的，创建新的声音警报方案非常容易。现在让我们在声音中添加我们自己的声音警报类型。为此，请按照以下步骤操作。
> 
> 1.  在 HKEY_CURRENT_USER\AppEvents\Schemes\App.Default 下创建一个新密钥并将其命名为 XYZAlert
> 2.  在 XYZAlert 键（您在上述步骤中创建的键）下创建另一个键，并将其命名为 .default
> 3.  将 .default 键的默认值设置为某个 .wav 文件的路径。例如。C:\abc\abc.wav
> 4.  在 XYZAlert 下创建另一个键并将其命名为 .current 并将路径设置为某个 wav 文件，或者将其留空。
> 5.  现在在 HKEY_CURRENT_USER\AppEvents\EventLabels 下创建另一个键并将其命名为 XYZAlert
> 6.  将此键的默认值设置为“XYZ Alert Here”之类的任何内容。
> 
> 就这样结束了。现在转到您的控制面板并启动声音小程序。您将看到名为 XYZ 警报的新声音警报类型。

请注意，您还必须使用“ [PlaySound](http://msdn.microsoft.com/en-us/library/ms712879(VS.85).aspx "MSDN - 播放声音") ”本机调用来播放声音。

# c++ - 如何在 linux 上查找大型项目的头文件依赖项

> ID：80923
> 
> 赞同：11
> 
> 时间：2008-09-17T07:51:31.393
> 
> 标签：c++

我正在做一个非常大规模的项目，其中编译时间**很**长。我可以在 Linux 上使用哪些工具（最好是开源的）来查找包含最多的文件并优化它们的使用？为了更清楚，我需要一个工具，它会根据依赖关系向我显示哪些标题包含最多。顺便说一句，我们确实使用分布式编译

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T08:00:31.277

查看[makdepend](http://www.xfree86.org/current/makedepend.1.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T08:12:19.907

[这里](https://stackoverflow.com/questions/42308/tool-to-track-include-dependencies)的答案将为您提供跟踪#include 依赖项的工具。但是没有提到优化等。

旁白：“大规模 C++ 软件设计”一书应该会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T08:09:46.763

使用“将许多小工具粘合在一起”的 Unix 哲学，我建议编写一个简短的脚本，使用 -M（或 -MM）和 -MF（OUTFILE）选项调用 gcc（详见[此处](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Preprocessor-Options.html#Preprocessor-Options)）。这将为 make 工具生成依赖项列表，然后您可以轻松地对其进行解析（相对于直接解析源文件）并提取所需的信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T08:01:45.503

像[doxygen](http://www.doxygen.org)（与 graphviz 选项一起使用）这样的工具可以为包含文件生成依赖关系图......我不知道它们是否会为你正在尝试做的事情提供足够的概述，但它可能值得一试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T08:18:20.470

从源树的根级别执行以下操作（\t 是制表符）：

```
find . -exec grep '[ \t]*#include[ \t][ \t]*["<][^">][">]' {} ';'
    | sed 's/^[ \t]*#include[ \t][ \t]*["<]//'
    | sed 's/[">].*$//'
    | sort
    | uniq -c
    | sort -r -k1 -n 
```

第 1 行获取所有包含行。第 2 行删除了实际文件名之前的所有内容。第 3 行去掉了行尾，只留下文件名。第 4 行和第 5 行计算每个唯一行。第 6 行按行数以相反的顺序排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T08:09:22.083

如果您想知道最重要的是哪些文件，请使用以下 bash 命令：

> 寻找 。-name ' *.cpp' -exec egrep '^[:space:]* #include[[:space:]]+["<][[:alpha:][:digit:]_.]+[">]' {} \;
> 
> > | 排序 | 唯一的-c | 排序-k 1rn,1
> > | 头 -20

它将显示按包含次数排列的前 20 个文件。

说明：第一行查找所有 *.cpp 文件并从中提取带有“#include”指令的行。第 2 行计算每个文件被包含的次数，第 3 行取 20 个主要包含的文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T08:18:57.457

使用[ccache](http://ccache.samba.org/)。它将对编译的输入进行哈希处理，并缓存结果，这将大大提高此类编译的速度。

如果您想检测多个包含，以便您可以删除它们，您可以按照 Iulian Șerbănoiu 的建议使用 makedepend：

```
makedepend -m *.c  -f - > /dev/null 
```

将为每个多重包含发出警告。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T09:11:26.753

在页面中找到的 Bash 脚本不是好的解决方案。它仅适用于简单的项目。事实上，在大型项目中，例如在标题页中描述，C-预处理器（#if，#else，...）经常被使用。只有更复杂的好软件，如[makedepend](http://www.xfree86.org/current/makedepend.1.html)或[scons](http://www.scons.org/)才能提供好的信息。gcc -E 可以提供帮助，但是对于大型项目，其结果分析是浪费时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T07:53:57.970

IIRC gcc 可以创建依赖文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T07:56:43.860

您可能想查看分布式编译，例如[distcc](http://distcc.samba.org/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T08:06:26.537

这并不完全是您要搜索的内容，并且可能不容易设置，但您可能可以看看 lxr ： lxr.linux.no 是一个可浏览的内核树。

在搜索框中，如果您输入文件名，它会告诉您它的包含位置。但这仍然是猜测，它不跟踪链式依赖关系。

也许

```
strace -e trace=open -o outfile make
grep 'some handy regex to match header' 
```

# w3c - 有人在他们的 Web 应用程序中使用 XForms 吗？

> ID：80940
> 
> 赞同：6
> 
> 时间：2008-09-17T07:55:26.827
> 
> 标签：w3c, xforms

几年前，我们开始使用W3C 的[XForms](http://www.w3.org/MarkUp/Forms/)开发一个需要数百个自定义表单的 Web 应用程序。

由于主流浏览器当前不支持它们，您现在在项目中使用哪些解析器/工具？

我对插件不是很感兴趣——这需要是模拟 XForms 的服务器端。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T06:25:03.690

我们使用 XForms 为基于 SOAP 的 Web 服务创建用户界面。目前我们选择了**Chiba** XForms 引擎 ( [http://chiba.sourceforge.net/](http://chiba.sourceforge.net/) )，但**Orbeon** ( [http://www.orbeon.com/](http://www.orbeon.com) ) 实际上看起来更成熟。两者都是服务器端引擎，可以将 XForms 动态转换为 HTML。验证是在 AJAX 的帮助下在服务器端执行的。这对服务器提出了相当高的要求，因此在创建流量很大的网站时，我不会押注这些引擎。XForms Wikipedia 页面上详细记录了替代方案：[http](http://en.wikipedia.org/wiki/XForms) ://en.wikipedia.org/wiki/XForms 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-10T21:48:25.947

也可以仅使用 XSLT 转换将 XForms 转换为 XHTML+Javascript，因此无需插件即可在客户端完成。看看[http://www.agencexml.com/xsltforms/](http://www.agencexml.com/xsltforms/)。这是一个开源项目：http: [//sourceforge.net/projects/xsltforms](http://sourceforge.net/projects/xsltforms)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T03:01:22.143

据我了解，XForms 非常适合当前基于 REST 的架构风格，同时以非常简洁的方式解决了复杂表单开发的大多数主要问题。

很遗憾，人们在很大程度上已经忘记了它:(

也就是说，有一些基于 Javascript 的 xforms 引擎，比如[Ubiquity](http://code.google.com/p/ubiquity-xforms/)，可以帮助获得跨浏览器的 xforms 支持。并且最近开发的高性能 Javascript VM 也将为此类引擎提供出色的性能。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-17T09:57:52.773

我不使用它们，因为它们不受任何主要浏览器的支持，我怀疑其他人也会经常使用它们。

# knowledge-management - 为帮助台存储业务规则知识库的最佳方式是什么？

> ID：80958
> 
> 赞同：1
> 
> 时间：2008-09-17T07:58:32.437
> 
> 标签：knowledge-management, tool-rec

有没有人知道任何软件或开发人员建立业务规则知识库的好方法，这些业务规则内置在软件中供帮助台使用？

我们已经有一个帮助台软件，但我们不打算替换它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T08:08:03.897

维基绝对是要走的路。流程有时会经常发生变化，并且在像帮助台这样的快节奏环境中，允许快速、轻松地访问和管理此类内容的工具对于让人们有效地完成工作极为重要。

我发现的最大好处之一是许多 wiki 的层次结构，允许员工从多个不同的客户角度找到正确的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T13:22:31.020

你可以说得更详细点吗？

这可能属于“政策和程序”管理软件。这里有一些： http: [//www.softscout.com/software/Human-Resources/Policy-and-Procedures.html](http://www.softscout.com/software/Human-Resources/Policy-and-Procedures.html)

我想找到一个更像 wiki 或更容易集成到作为更通用的公司知识库的网站中的一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:08:36.617

我会推荐一个具有“维基园丁”角色的维基——清理重复条目和排序的人。

如果您的支持台不完全是技术性的，那么带有富文本编辑器选项的 Wiki 技术会很有用。

有一些结构是必要的，在任何 Wiki 中开发对一般编辑大众有意义的东西，并且从阅读到编辑的门槛很低。您可能还需要一个迁移策略，将数百个小笔记转换为更易读和可搜索的内容。

# javascript - 处理 Javascript RegEx 子匹配

> ID：80963
> 
> 赞同：1
> 
> 时间：2008-09-17T08:00:11.420
> 
> 标签：javascript, regex, markdown

我正在尝试编写一些 JavaScript 正则表达式来用真正的 html 标签替换用户输入的标签，所以`[b]`会变成`<b>`等等。我正在使用的 RegEx 看起来像这样

```
var exptags = /\[(b|u|i|s|center|code){1}]((.){1,}?)\[\/(\1){1}]/ig; 
```

使用以下 JavaScript

```
s.replace(exptags,"<$1>$2</$1>"); 
```

这适用于单个嵌套标签，例如：

```
[b]hello[/b] [u]world[/u] 
```

但是如果标签相互嵌套，它将只匹配外部标签，例如

```
[b]foo [u]to the[/u] bar[/b] 
```

这只会匹配`b`标签。我怎样才能解决这个问题？我应该循环直到起始字符串与结果相同吗？我也感觉`((.){1,}?)`模式不对？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T13:51:36.877

最简单的解决方案是更换所有标签，无论它们是否关闭，并让`.innerHTML`它们匹配或不匹配，这样会更有弹性..

```
var tagreg = /\[(\/?)(b|u|i|s|center|code)]/ig
div.innerHTML="[b][i]helloworld[/b]".replace(tagreg, "<$1$2>") //no closing i
//div.inerHTML=="<b><i>helloworld</i></b>" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T08:18:53.993

AFAIK 你不能用正则表达式表达递归。

但是，您可以使用 .NET 的 System.Text.RegularExpressions 使用平衡匹配来做到这一点。在此处查看更多信息：http: [//blogs.msdn.com/bclteam/archive/2005/03/15/396452.aspx](http://blogs.msdn.com/bclteam/archive/2005/03/15/396452.aspx)

如果您使用的是 .NET，您可能可以通过回调来实现您所需要的。如果没有，您可能不得不推出自己的小型 javascript 解析器。

再说一次，如果你有能力访问服务器，你可以使用完整的解析器。:)

无论如何，你需要这个做什么？如果它不是用于预览，我强烈建议在服务器端进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:11:35.383

怎么样：

```
tagreg=/\[(.?)?(b|u|i|s|center|code)\]/gi;
"[b][i]helloworld[/i][/b]".replace(tagreg, "<$1$2>");
"[b]helloworld[/b]".replace(tagreg, "<$1$2>"); 
```

对我来说，以上产生：

```
<b><i>helloworld</i></b>
<b>helloworld</b> 
```

这似乎可以满足您的要求，并且具有只需要一次通过的优势。

免责声明：我不经常用 JS 编码，所以如果我犯了任何错误，请随时指出:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T08:27:24.770

是的，你将不得不循环。或者，由于您的标签看起来很像 HTML 的标签，您可以分别替换`[b]`for`<b>`和`[/b]`for `</b>`。(.){1,}？与 (.*?) 相同 - 即任何符号，最小可能的序列长度。

更新：感谢 MrP，(.){1,}？是 (.)+?，我的错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T08:31:21.203

关于内部模式很麻烦，您是对的。

```
((.){1,}?) 
```

那就是至少进行一次捕获的匹配，然后捕获整个事物。标签中的每个字符都将被捕获为一个组。

您还可以在不需要时捕获关闭元素名称，并`{1}`在暗示时使用它。下面是一个清理版本：

```
/\[(b|u|i|s|center|code)](.+?)\[\/\1]/ig 
```

不确定其他问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T09:16:33.793

您可以重复应用正则表达式，直到它不再匹配。那会做一些奇怪的事情，比如 "[b][b]foo[/b][/b]" => "<b>[b]foo</b>[/b]" => "<b><b >foo</b></b>”，但据我所见，最终结果仍然是带有匹配（尽管不一定正确嵌套）标签的合理字符串。

或者，如果您想“正确”地做到这一点，只需编写一个简单的递归下降解析器。尽管人们可能期望 "[b]foo[u]bar[/b]baz[/u]" 能够工作，但使用解析器很难识别。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T09:19:57.217

嵌套块没有被替换的原因是因为 [b] 的匹配将位置放在 [/b] 之后。因此，所有 ((.){1,}?) 匹配的内容都会被忽略。

可以在服务器端编写递归解析器——Perl 使用[qr//](http://perldoc.perl.org/functions/qr.html)并且 Ruby 可能有类似的东西。

不过，您不一定需要真正的递归。您可以使用相对简单的循环来等效地处理字符串：

```
var s = '[b]hello[/b] [u]world[/u] [b]foo [u]to the[/u] bar[/b]';
var exptags = /\[(b|u|i|s|center|code){1}]((.){1,}?)\[\/(\1){1}]/ig;

while (s.match(exptags)) {
   s = s.replace(exptags, "<$1>$2</$1>");
}

document.writeln('<div>' + s + '</div>'); // after 
```

在这种情况下，它将进行 2 次传递：

```
0: [b]hello[/b] [u]world[/u] [b]foo [u]to the[/u] bar[/b]
1: <b>hello</b> <u>world</u> <b>foo [u]to the[/u] bar</b>
2: <b>hello</b> <u>world</u> <b>foo <u>to the</u> bar</b> 
```

* * *

此外，还有一些清理 RegEx 的建议：

```
var exptags = /\[(b|u|i|s|center|code)\](.+?)\[\/(\1)\]/ig; 
```

*   当不存在其他计数说明符时假定为 {1}
*   {1,} 可以缩短为 +

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T09:51:31.433

同意 Richard Szalay，但他的正则表达式没有被正确引用：

```
var exptags = /\[(b|u|i|s|center|code)](.*)\[\/\1]/ig; 
```

更干净。请注意，我也更改`.+?`为`.*`. 有两个问题`.+?`：

1.  你不会匹配 [u][/u]，因为它们之间至少没有一个字符 (+)
2.  非贪婪匹配不会很好地处理嵌套在自身内部的相同标签（？）

# vmware - 如何使用脚本从基础架构客户端获取 VMWARE ESX 3i 映像

> ID：80969
> 
> 赞同：0
> 
> 时间：2008-09-17T08:01:19.090
> 
> 标签：vmware, esx

我已下载 SDK 以尝试将图像从服务器复制到我的 PC，但没有用于复制的 cmdlet，只是获取信息移动等

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T16:54:22.570

您可能在本地运行映像时遇到问题，您需要使用 VMWare 转换器以您可以使用的格式传输映像（在 VMWare 服务器等中）。

否则，请在远程 cli 中使用 vifs：http: [//www.vmware.com/pdf/vi3_35/esx_3/r35u2/vi3_35_25_u2_rcli.pdf](http://www.vmware.com/pdf/vi3_35/esx_3/r35u2/vi3_35_25_u2_rcli.pdf)

# javascript - 在 JavaScript 中创建/修改图像

> ID：80980
> 
> 赞同：7
> 
> 时间：2008-09-17T08:03:31.207
> 
> 标签：javascript, image

是否可以在 JavaScript（在客户端）中按**像素级别****动态创建和修改图像？**还是必须使用基于服务器的语言（例如 PHP）来完成？

 **我的用例如下：

*   用户打开网页并加载本地存储的图像
*   显示图像的预览
*   用户可以使用一组滑块修改图像（像素级操作）
*   最后，他可以将图像下载到本地硬盘

在网上搜索时，我只找到了有关使用 IE 过滤方法的帖子，但没有找到有关 JavaScript 中的图像编辑功能的任何内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T08:06:17.537

一些浏览器支持画布：http: [//developer.mozilla.org/En/Drawing_Graphics_with_Canvas](http://developer.mozilla.org/En/Drawing_Graphics_with_Canvas)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T08:05:28.457

这必须在服务器端完成。您可能会考虑做的一件事是允许所有编辑在客户端进行，然后最后将最终图像（通过 AJAX）发布到服务器，以允许它以正确的 MIME 类型将其返回给您，并且正确打包。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T08:25:42.637

您可能想查看[Processing.js](http://ejohn.org/blog/processingjs/)。jQuery 成名的 John Resig 写了它。它支持像素处理，不幸的是只有 Firefox 3 可以充分处理它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T08:30:48.413

还要查看[数据 URI](http://en.wikipedia.org/wiki/Data:_URI_scheme)（尽管 8 以下的 IE 版本不支持它们，很遗憾！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T08:07:03.960

你可以想象一组 JS 工具可以让用户定义他想要做什么样的转换，但转换的最后工作必须在服务器端完成。出于安全原因，客户端的 JS 无法创建文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T08:15:06.920

试试[Allicorn 的 Image Retargetter](http://ccgi.allicorn.plus.com/retargetter.php) - 听起来这就是你要找的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T08:22:45.420

JavaScript 中的本地图像操作应该是可能的 - 看看[Favicon 的 Defender](http://www.p01.org/releases/DHTML_contests/files/DEFENDER_of_the_favicon/)。;-) 问题是如何将原始图像从文件系统获取到您的页面中（除了首先将 HTTP 上传到服务器之外，我不知道任何其他方式）。

# python - 发生未处理的异常时如何跳过 sys.exitfunc

> ID：80993
> 
> 赞同：5
> 
> 时间：2008-09-17T08:05:18.550
> 
> 标签：python, exception, atexit

正如你所看到的，即使程序应该已经死了，它也会从坟墓里说话。有没有办法在出现异常时“取消注册”exitfunction？

```
import atexit

def helloworld():
    print("Hello World!")

atexit.register(helloworld)

raise Exception("Good bye cruel world!") 
```

输出

```
Traceback (most recent call last):
  File "test.py", line 8, in <module>
    raise Exception("Good bye cruel world!")
Exception: Good bye cruel world!
Hello World! 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T08:21:20.027

我真的不知道您为什么要这样做，但是您可以安装一个异常钩子，只要引发未捕获的异常，Python就会调用该异常钩子，并在其中清除`atexit`模块中已注册函数的数组。

类似的东西：

```
import sys
import atexit

def clear_atexit_excepthook(exctype, value, traceback):
    atexit._exithandlers[:] = []
    sys.__excepthook__(exctype, value, traceback)

def helloworld():
    print "Hello world!"

sys.excepthook = clear_atexit_excepthook
atexit.register(helloworld)

raise Exception("Good bye cruel world!") 
```

请注意，如果从已注册的函数引发异常，它可能会出现不正确`atexit`的行为（但即使未使用此钩子，行为也会很奇怪）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T08:15:58.883

如果你打电话

```
import os
os._exit(0) 
```

退出处理程序将不会被调用，您的或应用程序中其他模块注册的退出处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T08:25:14.713

除了调用 os._exit() 来避免注册的退出处理程序之外，您还需要捕获未处理的异常：

```
import atexit
import os

def helloworld():
    print "Hello World!"

atexit.register(helloworld)    

try:
    raise Exception("Good bye cruel world!")

except Exception, e:
    print 'caught unhandled exception', str(e)

    os._exit(1) 
```

# language-agnostic - 哪些因素决定了开源项目的成功？

> ID：80997
> 
> 赞同：6
> 
> 时间：2008-09-17T08:05:55.227
> 
> 标签：language-agnostic, open-source, project-management

我们有一系列封闭源代码的应用程序和库，我们认为开放源代码是有意义的。

到目前为止，阻碍我们的是在开放之前清理代码库和记录源代码所需的工作。

只有当我们有合理的机会使项目成功时，我们才想开放源代码——即有贡献者。我们相信，大量开发人员会对代码感兴趣。

**除了项目的“趣味性”和“有用性”之外，**哪些因素****决定了开源项目的成功？****

 **例子：

*   代码的清洁度
*   源代码注释的可用性
*   完整或部分记录的 API
*   许可证选择（GPL vs. LGPL vs. BSD 等...）
*   公共存储库的选择
*   投资公共网站

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T08:16:38.167

有几件事决定了代码的成功。所有这些都必须实现，以获得最微小的采用机会。

*   市场——你的开源项目必须有市场。如果你的项目是太空中的橙汁榨汁机，我怀疑你会非常成功。您必须确保您的项目在用户和开发人员中得到广泛采用。如果您可以让其他公司也采用它，那么成功的可能性就会增加一倍。
*   文档 - 正如您之前提到的，文档是关键。该文档中包含注释代码、架构决策和 API 说明。即使您的文档包含错误或有关您的软件的错误，也可以。请记住，透明度是关键。
*   自由——你必须让你的代码“自由”——我的意思是像言论一样自由，而不是像啤酒那样自由。如果您感觉您的市场正在成为其他公司的库，那么 BSD 许可证是最佳选择。如果您的软件要在台式机上运行，​​那么 GPL 是您的选择。
*   透明度 - 您必须在透明的环境中编写软件。一旦你开源，就没有隐藏的秘密。你必须解释你所做的一切，以及你在做什么。这将激怒开发人员，这是独一无二的
*   开发者社区 - 需要一个强大的开发者社区。这必须存在。只有大约 5% 的用户回馈该项目。如果有人注意到一年没有发布任何版本，他们不会认为“哇，这个软件已经完成了”，他们会认为“开发人员必须抛弃它”。让您的开发人员继续努力，即使这意味着他们正在花费您的钱。
*   交流 - 您必须确保您的社区能够交流。他们必须能够提交错误、讨论解决方法和发布补丁。没有反馈，开源项目毫无意义
*   可用性 - 使您的代码易于获取是必要的，即使这意味着惹恼律师。您必须确保您的项目易于下载和使用。您不希望用户必须跳过 18 个唠叨屏幕并签署合同才能执行此操作。你必须让事情变得简单，干净

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T08:26:53.977

我认为最重要的一个因素是使用您的项目的用户数量。否则，它只是一个写得很好、有用且有据可查的一堆东西，它们放在服务器上做的事情并不多......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T08:27:36.157

要获得贡献者，首先需要用户，然后需要一些不完整性。您需要触发“这很酷，但我真的希望它有这个或以这种方式有所不同。” 如果您缺少一个明显的功能，用户极有可能成为添加它的贡献者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T08:34:35.563

最重要的是程序要好。如果它不好，没有人会使用它。你不能希望先有鸡还是先有蛋会逆转，人们会认为这是理所当然的，直到它变得好。

当然，“好”仅仅意味着“对相当多的人来说比任何其他实用选择更好”，这并不意味着它严格来说是最好的，只是它具有一些特性，对于许多人来说，它比其他选项。有时该程序在其他任何地方*都*没有等效项，在这种情况下，几乎没有这方面的要求。

当一个程序好的时候，人们就会使用它。显然，它必须在用户中占有一席之地——一个做没人想要的事情的好程序，不管它设计得多么好，都不是真正的好。人们可以对营销提出观点，但真正好的产品，在某种程度上，倾向于推销自己。推广不好的东西要困难得多，所以很明显，一个人的首要任务应该是产品本身，而不是推广产品。

那么真正的问题是——你如何让它变得更好？答案是一个敬业的、熟练的开发团队。一个人很少能靠自己创造出好的产品；即使他们比其他开发人员要好得多，但多视角对项目的影响也是非常有用的。这就是为什么拥有公司赞助商如此有用的原因——它将其他开发人员（来自公司）的思想放在问题上以给出他们自己的意见。这在开发程序需要社区中不常见的大量专业知识的情况下特别有用。

当然，我说的都是经验。我是 x264（目前最活跃的）的主要开发人员之一，它是最流行的视频编码器之一。我们有两个主要开发人员，社区中提供补丁的各种次要开发人员，以及来自 Joost（维护速率控制算法的Gabriel Bouvigne）和 Avail Media（我有时为他们工作，目前正在招聘合同编码员）的企业赞助添加 MBAFF 隔行扫描支持），以及不时弹出的其他几个。

一个好的开发者不会做一个项目——许多好的开发者会做。这样做的最终结果是一个程序，它比大多数商业竞争对手、硬件或软件，甚至是那些拥有巨额开发预算的竞争对手，都可以更快地编码视频，并且质量要好得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T22:17:42.497

在查看这些问题时，您可能有兴趣查看[加州大学伯克利分校开源课程](http://webcast.berkeley.edu/course_details.php?seriesid=1906978370)的在线版本，该课程名为开源开发和数字信息分发：技术、经济、社会和法律视角。它由 Mitch Kapur（Lotus 创始人）和法学院教授 Paula Samuelson 共同教授。我有很长的通勤时间，去年我把课程的音频放在了我的 iPod 上——他们从一个非常广泛的（虽然显然是学术的）角度谈论了很多关于什么有效，什么无效以及为什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T22:20:30.197

已经写了关于这个主题的书籍。事实上，你可以在这里找到一本免费的书： [生产开源软件](http://producingoss.com/en/index.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T08:12:10.953

真的，我认为答案是“你如何运行项目”。

是的，您的所有示例都很重要，但关键是如何管理开发人员之间的交互，如何处理/接受补丁等，谁“负责”以及他们如何处理该责任等等。

比较和对比（历史不难追查！）Perl 中 Class::DBI 和 DBIx::Class 的开发管理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T08:13:09.250

今晚我刚刚阅读了一篇关于成功与不成功的开源项目可用性方面的优秀文章。

摘抄：

> 大量带宽被浪费在争论开源软件/自由软件（以下简称“OSS”）缺乏可用性的问题上。此刻，博客、论坛和 Slashdot 评论线程上的争论仍在继续。有人说可用性差是整个 OSS 世界的通病，也有人说 OSS 可用性很好，但真正的问题是那些心胸狭窄的用户，他们希望每个程序都克隆微软。有人认为 UI 问题是暂时的成长痛，也有人说 OSS 开发模式系统地产生了糟糕的 UI。有些人甚至认为 GPL 间接奖励了难以使用的软件！（为了记录，我不同意。）
> 
> [http://humanized.com/weblog/2007/10/05/make_oss_humane/](http://humanized.com/weblog/2007/10/05/make_oss_humane/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T09:00:51.350

只需开源它。很可能，还没有人会开始贡献。但至少你可以在新闻稿上写下你的产品是 GPL 或其他什么。

第一步是人们开始使用它......
也许然后，在用户适应之后，他们将开始贡献。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T14:08:04.423

到目前为止，每个人的答案都很好，但是缺少一件事，那就是很好的疏忽。没有什么比没有某种项目管理更能扼杀开源项目了。不要告诉人们该做什么，而是为您希望吸引的开发人员添加一些结构和任务。

杂乱无章的项目很快就会分崩离析。这不是一只鸟，你只是放手看着它飞走。**********~~********`