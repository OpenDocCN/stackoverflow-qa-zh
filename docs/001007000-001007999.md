# StackOverflow 问答 1007000-1007999

# language-agnostic - 为了成为更好的开发人员，我应该写什么？

> ID：1007007
> 
> 赞同：6
> 
> 时间：2009-06-17T13:26:06.283
> 
> 标签：language-agnostic

我倾向于很快完成与工作相关的任务，并且我可以有一些空闲时间。为了成为更好的开发人员，我应该写什么？我熟悉 c++/java/perl/python/ruby。

我自己写了以下内容：

*   简单的网络服务器
*   简单的网络客户端（不同的语言）
*   DSL，内部和外部
*   一些词法分析器
*   代码缩进器（源美化器）
*   简单的IDE

我想要一些关于一些软件的建议，这些软件编写起来既具有挑战性又很有趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T13:28:58.133

一个编译器。

编辑：或模拟器。两者都非常具有挑战性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-17T13:32:22.417

为开源项目做贡献

**编辑：**从[这里开始](http://sourceforge.net/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-17T13:33:41.900

涉及实际用户的东西。尽管听起来很有趣，但在我看来，如果其他人正在使用您的工作并依赖它，那将是一个完全不同的故事！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-17T13:31:45.397

依赖于你目前不具备的知识的东西，这意味着你必须在创造它的过程中自学。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-17T13:30:33.230

代码生成器怎么样，完成后这也对你有用

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-17T14:38:29.007

选择任何需要组件、增强或错误修复帮助的开源应用程序。您的技能可以在开源世界中发挥作用。除此之外，我建议您使用您的技能来开发这些：

1.  用于游戏开发的 IDE（因为您已经熟悉 IDE 开发）
2.  改进现有库
3.  开发模拟器/虚拟机软件
4.  开发文件夹和驱动器保护软件（或更好的加密相关软件）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-17T13:29:49.427

分布式环境中的东西。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-17T13:30:59.953

我会发现一个真正的问题并为它创建一个解决方案。它可以是一个算法或一个完整的项目：Web 项目或客户端应用程序。

重要的是你解决了真正的问题。

这就是编程的全部意义所在。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-17T13:39:15.537

一款游戏，可能是一款简单的游戏，例如 Pacman 或 SpaceInvaders。这不仅有趣，而且您还将进入一个全新的领域。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-17T13:33:47.077

参与一个开源项目，帮助您了解一些软件开发实践，例如使用版本控制系统和错误跟踪系统。

编写一个我认为非常具有挑战性和乐趣的 AI 游戏，例如跳棋。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-06-17T13:34:34.020

编写二叉搜索树并实现插入、删除、搜索等。完成后编写展开树。[如果这不符合您的喜好，请从“算法简介”中](https://rads.stackoverflow.com/amzn/click/com/0262032937)挑选一些内容，然后改写。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-17T14:35:25.393

一本书。一个教程。什么都教。教学是一种很好的学习方式。

试图向人们解释新概念通常会迫使你比平时更深入。试图将你的知识变成一组连贯的句子的行为会在你自己的脑海中强化它，并揭示你可能存在的任何弱点或差距。

你总是可以从你的学生或读者那里学到一些东西。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-07-09T20:29:21.787

你的问题已经得到了很多很好的回答，但我觉得有一个建议被遗漏了：**学习 AS3/Flex！**

我的背景与您的非常相似，但我最近为一个项目学习了 AS3，并且到目前为止很喜欢它。它与您使用过的其他语言（例如Java）具有相同的“感觉”，但它允许强大的视觉/听觉应用程序而没有烦人的框架的膨胀。AS3/Flex 都经过了多次微调，并且非常适合快速开发。

学习 AS3/Flex 的另一个原因是，您似乎对独立运行或在网络环境中作为服务器运行的技术感兴趣。尝试使用 AS3/Flex 可能会让您有机会使用客户端/服务器二重奏的客户端。

不管怎样，玩得开心！:)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-06-17T13:32:17.330

我同意编译器的想法。这将是一个具有挑战性和有趣的项目。选择一种足够简单的语言。甚至可以自己设计 :)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-17T13:41:37.343

天，

什么会开始编写一些片段以在其他软件中重用？这样你就可以：

*   通过不时地修改它们来优化特定的功能，
*   每次您需要将此功能整合到您的主要软件中时，都不必重新发明轮子，
*   开始传播它们并为自己赢得一点名声。

在我的脑海中，我想到的一些事情是：

*   日志记录
*   从文件中读取配置
*   建立一个共同的环境

所有这些，如果你已经写好了它们，将会使你在其他项目上的周转时间更快。该功能也将在多个项目中保持一致。

高温高压

干杯，

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-17T13:47:02.323

你可以去实现自己的版本控制系统......
这将需要大量编码并涵盖算法、协议、操作系统等不同方面。
但为开源项目做出贡献总是比编码一些东西更好已经建成
，你也可以尝试开发一个专家系统，使用人工智能做一些有趣的事情:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-06-17T13:48:41.760

我发现在完全不同的环境中重写之前的项目是了解新环境和旧环境的好方法。

回到学校时，我用 C 语言编写了一个百家乐游戏（我们必须选择一个纸牌游戏，而我想选择一个我从未玩过的游戏）。第二年，我在计划中重写了它。然后是次年的smalltalk。

在这两种情况下，我都对 C 有了更深入的了解。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-06-17T14:12:46.953

你似乎没有做太多的图形。就像已经建议的游戏怎么样，像小行星这样的 2D 简单物理/射击游戏相当容易上手，而且测试起来很有趣。

更好，可能更有用的图像编辑器怎么样？

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-12-04T11:48:34.580

编写更多代码并不会神奇地使您成为更好的开发人员。我的一些建议是：

1.  学习编写*更好*的代码。例如，您对设计模式、重构、单元/自动化测试和持续集成了解多少？

2.  了解软件工程。你知道 Scrum、精益、XP 和其他敏捷实践吗？用例和用户故事，以及项目估算和管理呢？管理（和选择）团队也是另一种技能。你希望它成为你未来的一部分吗？

3.  学习与用户交谈（实际上是敏捷技术的重要组成部分）。您的客户几乎总是错误地认为他们需要什么。你如何跨越他们想/说他们想要的东西和他们实际需要你为他们建立的东西之间的鸿沟？通常在两个方向都存在通信问题:-)

4.  用户界面设计。这比排列文本框和设置标签顺序要困难得多。对于我们大多数人来说，这是一门难以掌握的学科，并且有针对胖客户端、Web 应用程序、小型设备（电话、PDA 等）等的分支。

我相信其他人可以想到我忘记的事情，但我的观点是，编写代码并不是我们作为开发人员所做的全部工作。很多时候，编写代码是我们做的*最少*的事情。

# scala - Scala Actor 可以同时处理多个消息吗？

> ID：1007010
> 
> 赞同：28
> 
> 时间：2009-06-17T13:26:35.267
> 
> 标签：scala, concurrency, actor

[对我最近的一个问题的答复](https://stackoverflow.com/questions/1005659/scala-actors-as-single-threaded-queues/1006491#1006491)表明，一个演员一次处理*一条*消息。这是真的？我没有看到任何明确说明的内容（*在 Scala 编程中*），其中包含以下片段（第 593 页）

> 如果[该`react`方法]找到可以处理的消息，[它]将安排对该消息的处理以**供以后执行**并抛出异常

（强调我自己的）。两个相关（且相互排斥）的问题：

1.  假设一个演员可以同时处理多条消息，我如何强制一个演员一次处理 1 条消息（如果这是我希望做的）？（使用`receive`？）
2.  假设一个演员一次处理一个消息，我将如何最好地实现一个实际上*可以*同时处理消息的演员

*编辑：做一些测试似乎证明我错了，演员确实是连续的。所以这是我需要回答的问题#2*

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-17T17:41:26.417

Actor 一次处理一条消息。处理多条消息的经典模式是在一组消费者参与者的前面设置一个协调参与者。如果你使用 react，那么消费者池可能会很大，但仍然只会使用少量的 JVM 线程。这是一个示例，我创建了一个由 10 个消费者组成的池，并为他们创建了一个协调员。

```
import scala.actors.Actor
import scala.actors.Actor._

case class Request(sender : Actor, payload : String)
case class Ready(sender : Actor)
case class Result(result : String)
case object Stop

def consumer(n : Int) = actor {
  loop {
    react {
      case Ready(sender) => 
        sender ! Ready(self)
      case Request(sender, payload) =>
        println("request to consumer " + n + " with " + payload)
        // some silly computation so the process takes awhile
        val result = ((payload + payload + payload) map {case '0' => 'X'; case '1' => "-"; case c => c}).mkString
        sender ! Result(result)
        println("consumer " + n + " is done processing " + result )
      case Stop => exit
    }
  }
}

// a pool of 10 consumers
val consumers = for (n <- 0 to 10) yield consumer(n)

val coordinator = actor {
  loop {
     react {
        case msg @ Request(sender, payload) =>
           consumers foreach {_ ! Ready(self)}
           react {
              // send the request to the first available consumer
              case Ready(consumer) => consumer ! msg
           }
         case Stop => 
           consumers foreach {_ ! Stop} 
           exit
     }
  }
}

// a little test loop - note that it's not doing anything with the results or telling the coordinator to stop
for (i <- 0 to 1000) coordinator ! Request(self, i.toString) 
```

此代码测试以查看哪个消费者可用并向该消费者发送请求。替代方案是随机分配给消费者或使用循环调度程序。

根据您所做的事情，Scala 的 Futures 可能会为您提供更好的服务。例如，如果你真的不需要演员，那么上述所有机器都可以写成

```
import scala.actors.Futures._

def transform(payload : String) = {      
  val result = ((payload + payload + payload) map {case '0' => 'X'; case '1' => "-"; case c => c}).mkString
  println("transformed " + payload + " to " + result )
  result
}

val results = for (i <- 0 to 1000) yield future(transform(i.toString)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T14:13:53.940

我认为答案是`Actor`不能异步处理消息。如果你有一个`Actor`应该监听**可以异步处理**这些消息的消息，那么它可以这样写：

```
val actor_ = actor {

  loop {
    react {
      case msg =>
        //create a new actor to execute the work. The framework can then 
        //manage the resources effectively
        actor {
          //do work here
        }
      }
    }
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:39:19.907

如果你想做多件事，那么你应该使用多个演员。使用参与者的全部原因是将工作分配给多个独立的进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-04T07:28:59.790

您可以尝试使用期货概念。请使用 Futures 存储所有这些消息，然后尝试处理所有这些消息。

# svn - TortoiseSVN 中的 pre-revprop-change 钩子

> ID：1007012
> 
> 赞同：3
> 
> 时间：2009-06-17T13:27:05.547
> 
> 标签：svn, tortoisesvn

TortoiseSVN 的新手在这里。我需要为我对颠覆所做的一些提交更改日志消息。我只想进行更改，然后让一切恢复到以前的状态，这意味着您在提交后无法更改任何内容。

根据这篇文章（[What is a pre-revprop-change hook in SVN, and how to create it?](https://stackoverflow.com/questions/197224/what-is-a-pre-revprop-change-hook-in-svn-and-how-do-i-create-it/197240)），我知道你必须创建一个 pre-revprop-change.bat 文件才能做到这一点。

我的问题是，如果我只是添加这个 bat 文件，对日志消息进行更改，然后删除 bat 文件，设置是否会恢复到以前的状态（例如日志消息不可编辑）.. 或者我是否已经运行bat 文件自己然后想出另一个脚本来撤消更改？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T13:31:33.197

对不起，我在原来的答案中误解了你的问题。

为了`svn propedit`在修订版上正确使用该命令（例如`svn:log`日志消息属性），您确实需要一个 pre-revprop-change 挂钩，因为默认行为是拒绝修订版属性更改。添加 pre-revprop-change 挂钩的最简单方法是复制 pre-revprop-change.tmpl 文件（您可以在 svn 目录的 /repository-name/hooks 中找到该文件），将其称为 pre- revprop-change 并使其可执行（`chmod a+x`）。

运行`propedit`命令后，您可以删除挂钩以恢复默认行为，或将其更改为始终以非零返回码退出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-24T01:09:45.293

另一种选择是使用 svnadmin 更改日志消息：

```
echo "My new commit message." > newmsg.txt
svnadmin setlog path/to/repository -r nnn newmsg.txt --bypass-hooks 
```

其中 nnn 是修订号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T15:33:53.827

使用[此问题](https://stackoverflow.com/questions/197224/what-is-a-pre-revprop-change-hook-in-svn-and-how-do-i-create-it)中接受的答案来获取 pre-revprop-change 挂钩代码。制作文件并将其放在存储库的 hooks 目录中。现在您可以更改日志消息。如果您不想再更改日志消息，请删除 pre-revprop-change.bat。

# django - 单个 Django 实例上的“站点框架”

> ID：1007017
> 
> 赞同：6
> 
> 时间：2009-06-17T13:27:59.197
> 
> 标签：django, apache, rss, settings, sites

我想在与站点其他部分不同的子域上提供专门的 RSS 提要。

我可以使用站点框架**在单个 django 实例**中使用不同的 urls.py 和 settings.py 文件吗？还是我需要设置两个 apache 位置并在 apache conf 中设置不同的 settings.py 文件。

我需要设置两个 urls.py 文件的原因是为了避免重复的内容。我不希望在 rss.example.com 上提供主站点，也不希望在 example.com 上访问专门的提要

从单个 django 实例为它们提供服务将是理想的，因为我们在内存有限的共享主机上，打开一个只提供 rss 的实例似乎是一种浪费。

**编辑**：我得出的结论是，具有单独 urls.py 文件的多个实例对我来说是最简单的......但我发现这篇文章描述了如何使用单个实例来做到这一点：

[http://effbot.org/zone/django-multihost.htm](http://effbot.org/zone/django-multihost.htm)

# 解决方案：[Django 特百惠](https://bitbucket.org/jiaaro/django-tupperware/src/)

我最终编写了一个框架，用于在单个 django 实例上运行站点的多个副本。

基本思想是动态更改`SITE_ID`每个请求的设置并从数据库加载备用设置。它基于域执行此操作并`SITE_ID = 1`默认使用（当它找不到任何东西时）

settings.py 文件中的所有设置都充当默认设置，这些设置被存储在当前站点数据库中的设置覆盖。

它工作得很好:) 并且它在[http://rootbuzz.com的生产环境中运行](http://rootbuzz.com)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T17:11:20.467

使用股票 Django，您必须`settings.py`为每个站点拥有一个唯一的......因为 SITE_ID 是在`settings.py`其中定义的，并且是站点正在处理此请求的键。

换句话说，SITE_ID 对您的实例是全局的，因此您需要为每个站点创建一个实例。

如果您愿意，您可以有一个共同点`urls.py`，因为没有什么可以阻止您`ROOT_URLCONF`在所有站点`settings.py`文件中使用相同的...或者您可以为每个站点设置不同的一个。在这种情况下，您可能希望包含子 URL，以防止重复任何常见的 URL。

您可以尝试从单个实例提供至少两种方法：

1.  使用 apache + [mod_wsgi](http://code.google.com/p/modwsgi/)并使用[WSGIApplicationGroup](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIApplicationGroup)和/或[WSGIProcessGroup](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIProcessGroup)指令。我以前从来没有需要这些，所以不能完全确定它们会按照你想要的方式工作，但无论如何你绝对可以在守护进程模式下使用 mod_wsgi 来大大改善你的内存占用。

2.  您可以使用 Django 中间件根据请求主机名拒绝/允许 URL（请参阅Django 文档中的[HttpRequest.get_host()](http://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.get_host)）。就此而言，即使它会对性能造成轻微影响，您也可以在所有视图上放置一个装饰器来检查传入的主机。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-27T01:42:06.857

仅供参考 - 我发布了 django-dynamicsites 可以帮助解决这个问题 - [https://bitbucket.org/uysrc/django-dynamicsites/src](https://bitbucket.org/uysrc/django-dynamicsites/src)

# xslt - XSLT 表达式检查变量是否属于元素集

> ID：1007018
> 
> 赞同：22
> 
> 时间：2009-06-17T13:28:03.220
> 
> 标签：xslt

我有这样的代码：

```
 <xsl:if test="$k='7' or $k = '8' or $k = '9'"> 
```

有没有办法把这个表达式放在一个表单中，比如 SQL

```
 k IN (7, 8, 9) 
```

泰:)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-17T13:30:19.627

XSLT / XPath 1.0：

```
<!-- a space-separated list of valid values -->
<xsl:variable name="list" select="'7 8 9'" />

<xsl:if test="
  contains( 
    concat(' ', $list, ' '),
    concat(' ', $k, ' ')
  )
">
  <xsl:value-of select="concat('Item ', $k, ' is in the list.')" />
</xsl:if> 
```

如果需要，您可以使用其他分隔符。

在 XSLT / XPath 2.0 中，您可以执行以下操作：

```
<xsl:variable name="list" select="fn:tokenize('7 8 9', '\s+')" />

<xsl:if test="fn:index-of($list, $k)">
  <xsl:value-of select="concat('Item ', $k, ' is in the list.')" />
</xsl:if> 
```

如果您可以使用文档结构来定义您的列表，您可以这样做：

```
<!-- a node-set defining the list of currently valid items -->
<xsl:variable name="list" select="/some/items[1]/item" />

<xsl:template match="/">
  <xsl:variable name="k" select="'7'" />

  <!-- test if item $k is in the list of valid items -->
  <xsl:if test="count($list[@id = $k])">
    <xsl:value-of select="concat('Item ', $k, ' is in the list.')" />
  </xsl:if>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-07T18:00:37.470

如果您的处理器支持 XPath 2.0，那么您可以与`$k`这样的序列进行比较：

```
<xsl:if test="$k = (7, 8, 9)"> 
```

在这种特殊情况下，您甚至可以使用范围运算符：

```
<xsl:if test="$k = (7 to 9)"> 
```

不需要显式类型转换。使用 Saxon-HE 9.8.0.12N (XSLT 3.0) 测试。

示例 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
    <node>5</node>
    <node>6</node>
    <node>7</node>
    <node>9</node>
    <node>10</node>
    <node>79</node>
    <node>8</node>
</root> 
```

样式表：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="3.0">

    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="root">
        <xsl:copy>
            <xsl:apply-templates select="node"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="node">
        <xsl:variable name="k" select="text()"/>
        <xsl:if test="$k = (7 to 9)">
            <xsl:copy-of select="."/>
        </xsl:if>
    </xsl:template>

</xsl:stylesheet> 
```

结果：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
   <node>7</node>
   <node>9</node>
   <node>8</node>
</root> 
```

# visual-studio - 创建项目后如何让 VS2008 创建不同的 *.DLL 名称？

> ID：1007034
> 
> 赞同：5
> 
> 时间：2009-06-17T13:29:53.310
> 
> 标签：visual-studio, visual-studio-2008

要在 VS2008 中创建项目，您必须在创建项目时为编译的输出分配一个名称。如果您正在创建类库，则此输出为 <输出名称>.DLL。我可以通过 VS2008 界面更改项目中的所有其他名称。如果我后来后悔输出的名称，我找不到更改项目的输出 *.exe 或 *.dll 名称的方法。

当项目已经创建并且输出名称已经定义时，如何更改VS2008 项目的*输出名称？*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T13:31:28.377

在项目属性中更改程序集名称。

在解决方案资源管理器中，找到您感兴趣的项目并双击“属性”（就在项目名称下方）。这将在主编辑器视图中打开项目的属性页面。

在“应用程序”选项卡中有一个“程序集名称”选项 - 这是决定输出文件名的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-18T18:54:25.823

对于 C++，我在 Linker->General->Output File 下找到了这个选项

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T13:32:22.010

在项目属性的应用程序选项卡上，只需更改“程序集名称”属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T13:32:53.960

项目属性，在“应用程序”选项卡下，“程序集名称”字段将更改输出 exe 或 dll 的名称。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T13:33:23.663

右键单击项目，点击属性，应用程序选项卡上有一个名为“程序集名称”的输入，这是您的 dll 名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T13:38:58.067

在 VS2008 中，我通过打开 <project name>.csproj 并将出现在 <Assembly Name> .. 和 .. </Assembly Name> XML 标记之间的文本编辑为所需的输出程序集文件名来解决此问题。

编辑：我发布了这个问题，以便与大家分享我的答案。我得到答案的速度给我留下了深刻的印象。谢谢你。

@John Saunders - 我来自 UNIX 背景，所以当用户界面在几分钟后没有给出答案时，我倾向于使用“emacs”或“vi”进行探索。

# asp.net - ASP.NET MVC Urls 和 IIS 集成 Windows 身份验证

> ID：1007041
> 
> 赞同：6
> 
> 时间：2009-06-17T13:31:24.307
> 
> 标签：asp.net, asp.net-mvc, iis, windows-authentication

我有一个 ASP.NET MVC 应用程序，它完全支持表单身份验证。但是，有一组路由 (/report/%) 我需要强制启用集成 Windows 身份验证，因为这些页面需要模拟当前用户（出于安全原因）。

如果我将整个站点设置为集成 Windows 身份验证，这一切都有效，除了 Firefox 在用户访问站点主页时提示用户输入用户名/密码两次（一次用于 Windows 身份验证，然后再次用于表单身份验证），而 IE 仅提示表单认证。这很好，我知道这是 Firefox 的默认行为，但是为了不惹恼用户，我被要求将 Windows 身份验证要求限制在站点的 /report/* 部分，因此只有在他们转到/report/% 中的任何页面。

在 ASP.NET WebForms 中，这很容易，因为有一个 physcial /report 文件夹可以放置身份验证配置，但在 MVC 中，这个 URL 是虚拟的，所以我不能这样做。有谁知道这样做的好方法？我尝试创建一个“网关”aspx 页面，用户需要先通过该页面才能重定向到相应的报告页面，尽管 Firefox 确实在正确的位置提示用户输入他们的 Windows 凭据，但它似乎并没有保留将后续请求的这些详细信息发送到任何 /report/% 页面。有任何想法吗？将超级感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-22T06:48:15.503

就在最近，我不得不做类似的事情。我的大多数 asp.net MVC 应用程序都需要表单身份验证，其中一部分需要 Windows 身份验证。

我最终做的是将我的网络应用程序分成两个项目。

第一个项目托管在 IIS 下的网站根目录中。这是运行表单身份验证。

第二个项目作为同一网站的虚拟目录托管。这是运行 Windows 身份验证。

唯一的权衡是您最终可能会得到 /reports/reports/% 的 URL（或任何您命名的虚拟目录）

# c++ - 为什么我不能成为模板参数的朋友？

> ID：1007054
> 
> 赞同：6
> 
> 时间：2009-06-17T13:32:56.860
> 
> 标签：c++, templates, friend

在研究问题的答案时（基于[此答案](https://stackoverflow.com/questions/1000908/is-it-possible-to-forbid-deriving-from-a-class-at-compile-time/1000944#1000944)），我尝试执行以下操作：

```
template <class T>
class friendly {
    friend class T;
};

friendly<string> howdy; 
```

这无法编译并出现以下错误：

> 错误：模板参数“T”不能在详细类型说明符朋友类 T 中使用；

从我的好朋友谷歌那里可以了解到，这样我就不会意外地尝试实例化`friendly<int>`，但为什么在编译模板时会出现错误？用无效类型实例化模板时不应该是错误吗（比如我写的`int f() { return T::foo(); }`）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T13:46:32.043

该标准的第 7.1.5.3 节明确地将其描述为一个格式错误的详细类型说明符的示例。

可以在[此处](http://www.cpptalk.net/may-a-template-argument-be-a-friends-of-the-template-class-vt41742.html)找到有关该主题的讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T12:33:15.033

更多的 googleling 带来了C [++0x的](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2565.html)**扩展`friend`声明** [(PDF)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1791.pdf)。

本文档包含以下内容：

```
template <typename T> class R {
    friend T;
};
R<C> rc; // class C is a friend of R<C>
R<int> ri; // OK: “friend int;” is ignored 
```

这比我想象的更进一步（忽略非法`friend`减速而不是在实例化过程中失败）。所以我想答案是没有充分的理由，并且正在纠正中。

# math - UTC 时区的午夜，带有 unix 时间戳

> ID：1007060
> 
> 赞同：4
> 
> 时间：2009-06-17T13:34:04.987
> 
> 标签：math, unix-timestamp

我正在寻找一个日期的数字表示，午夜的 unix 时间（以 UTC 表示）似乎是合理的选择。但是，由于我不确定我的数学技能，所以是

```
date = date - date % (24 * 60 * 60); 
```

unix时间戳在哪里`date`，这样做的方法是什么？有没有更简单的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T19:48:47.893

是的，你的公式是一个非常好的方法。完成同样事情的另一种方法是：

```
date = (date / 86400) * 86400; 
```

值得注意的是，上面的公式假设整数（截断）除法。另外，我觉得这`86400`是一个足够常用的常量，它可以出现在源代码中而无需额外的注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:46:19.053

所需的语言/库？

我将假设 C 与标准 UNIX 库。

[`time.h`](http://linux.die.net/man/3/ctime)将非常合适。

```
#include <time.h>

struct tm date_tm;
time_t date;

localtime_r(NULL, &date_tm);
date_tm.tm_sec = 0;
date_tm.tm_min = 0;
date_tm.tm_hour = 0;

date = mktime(&date_tm); 
```

我想迂回的 to-string/from-string 方法也可以，但我不推荐它。（`%F`并且`%Z`应该是 C99 和/或某些 POSIX 或 SUS 规范所要求的。）

```
#define DATE_FORMAT "%F %Z"  /* yyyy-mm-dd t-z */

char date_str[15];
struct tm date_tm;
time_t date;

localtime_r(NULL, &date_tm);
strftime(date_str, sizeof(date_str), DATE_FORMAT, &date_tm);
strptime(date_str, DATE_FORMAT, &date_tm);

date = mktime(&date_tm); 
```

* * *

嗯，一开始我没有注意到你想要 UTC。由于 UNIX 时间保证 UNIX 日始终为 86400 UNIX 秒，因此我认为您的原始解决方案没有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:39:18.703

只需使用没有时间部分的 strtotime。

# silverlight - 保护我的网络服务

> ID：1007065
> 
> 赞同：0
> 
> 时间：2009-06-17T13:35:12.830
> 
> 标签：silverlight, web-services, security

我有一些网络服务。

它们由 silverlight 应用程序使用，并由其他应用程序单独使用。

保护这些以使黑客无法直接访问它们的最佳方法是什么？

目前，只有当 silverlight 应用程序调用 web 应用程序并且 web 应用程序调用 web 服务本身时，它们才会被阻止到 localhost。

我讨厌这个解决方案，因为它增加了另一层并且会影响性​​能。

尽可能不要更改 Web 服务代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T13:38:27.210

您是否尝试过简单地更改服务和客户端的配置以使用带有 SSL 的 basicHttpBinding？

我不太了解 SilverLight 是否支持 wsHttpBinding，但您也可以尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:11:30.060

如果您使用的是 ASP.NET 和 WCF，则可以使用内置的 ASP.NET 身份验证并将 ASP.NET 身份验证所需标记放在您的 Web 服务上。这里有一个很棒的截屏[视频](http://silverlight.net/learn/learnvideo.aspx?video=56228)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:39:40.840

*   可以将 IIS 配置为仅允许来自特定 IP 地址的连接。我会先以这种方式配置您的网络服务。
*   此外，如果您使用 WCF，您可以使用 https 和证书来管理 WCF 端点配置工具中的安全权限

我自己会使用其中一种或两种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:23:31.143

这是我最喜欢的关于这个主题的参考资料。

[http://timheuer.com/blog/archive/2008/10/14/calling-secure-services-with-silverlight-2-ssl-https.aspx](http://timheuer.com/blog/archive/2008/10/14/calling-secure-services-with-silverlight-2-ssl-https.aspx)

简而言之，将 basicHttpBinding（或 Silverlight 3 中的 customBinding）与 https 一起使用。就像与 ASP.NET 应用程序服务相结合的魅力一样。下面是 Silverlight http 安全性的一个很好的概述：

[http://msdn.microsoft.com/en-us/library/cc838250(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc838250(VS.95).aspx)

# php - 如何将流过滤器附加到回显？

> ID：1007066
> 
> 赞同：2
> 
> 时间：2009-06-17T13:35:31.740
> 
> 标签：php, filter, stream, xss

有没有办法将流过滤器附加到回显，以便回显的任何数据都通过流过滤器？我的想法是编写一个输出转义过滤器来防止 XSS。

我发现了这个错误报告[http://bugs.php.net/bug.php?id=30583](http://bugs.php.net/bug.php?id=30583)但它是从 2004 年开始的，我不知道现在这是否可能。

```
class strtoupper_filter extends php_user_filter 
{
  function filter($in, $out, &$consumed, $closing)
  {
   while ($bucket = stream_bucket_make_writeable($in)) {
     $bucket->data = strtoupper($bucket->data);
     $consumed += $bucket->datalen;
     stream_bucket_append($out, $bucket);
   }
   return PSFS_PASS_ON;
  }
}
stream_filter_register("strtoupper", "strtoupper_filter");

$fp = fopen("php://output", "w");
stream_filter_append($fp, "strtoupper");

echo "echo: testing 123<br>";
print("print: testing 123<br>");
fwrite($fp, "fwrite: testing 123<br>"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T13:43:52.113

您可以将输出缓冲用于任何过滤作业。

```
<?php
function my_filter($data) {
    return strtoupper($data);
}
ob_start('my_filter', 4096);
echo 'test';
ob_end_flush(); // Or end of script 
```

任何更复杂的例子都是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:49:27.900

您总是可以自己制作一个包含过滤器的特殊“回声”功能。然后用您的自定义函数替换代码中的所有回声。

```
<?php
function filtered_echo($data) {
    // filter $data here
    echo $data;
}
?> 
```

# html - 表单中的任何按钮是否会自动提交？如何禁用此功能？

> ID：1007070
> 
> 赞同：0
> 
> 时间：2009-06-17T13:35:50.787
> 
> 标签：html

我试图在 html 表单中有一个清除按钮，但它似乎会自动提交。我该如何解决这个问题？

我觉得我错过了一些明显的东西。

谢谢，我有一个可行的答案......所以现在我只是好奇。是否有任何理由在表单中使用按钮元素，或者有任何理由不使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T13:38:08.130

您必须使输入元素的类型为“ `reset`”，而不是“ `submit`”。

编辑：固定..重置，不清楚

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T13:38:55.943

```
<input type="reset" name="reset" value="Reset Form"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T13:38:29.657

试试这个：

```
<input type="reset" name="reset" value="Clear"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T13:40:26.377

试试这个，而不是提交按钮：

```
<input type="reset" value="Clear Form"> 
```

# iphone - 如何将图像拆分为多个部分？

> ID：1007078
> 
> 赞同：3
> 
> 时间：2009-06-17T13:36:56.727
> 
> 标签：iphone, cocoa-touch, image-manipulation, uiimage

任何人都可以向我解释如何在 iPhone OS 中将图像（均等和不均等地）拆分为多个部分。如果您提供示例代码，这对我很有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T18:22:16.910

我已经改编了一些从[Bill Dudney](http://bill.dudney.net/roller/objc/)的[核心动画书中](http://www.pragprog.com/titles/bdcora)得到的代码来完成这项任务：

```
- (NSArray*)splitImageIntoRects:(CGImageRef)anImage{

    CGSize imageSize = CGSizeMake(CGImageGetWidth(anImage), CGImageGetHeight(anImage));

    NSMutableArray *splitLayers = [NSMutableArray array];

            kXSlices = 3;
            kYSlices = 3;        

    for(int x = 0;x < kXSlices;x++) {
        for(int y = 0;y < kYSlices;y++) {
            CGRect frame = CGRectMake((imageSize.width / kXSlices) * x,
                                     (imageSize.height / kYSlices) * y,
                                     (imageSize.width / kXSlices),
                                     (imageSize.height / kYSlices));

            CALayer *layer = [CALayer layer];
            layer.frame = frame;                                                    
            CGImageRef subimage = CGImageCreateWithImageInRect(drawnImage, frame);
            layer.contents = (id)subimage;
            CFRelease(subimage);
            [splitLayers addObject:layer];
        }
    }
    return splitLayers; 
} 
```

注意：要获得 CGImageRef：

```
CGImageRef anImage = [myUIImage CGImage]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:08:04.903

如果您只想要一个由 an 定义的区域，`NSRect`那么[这段代码](http://www.mail-archive.com/discuss-gnustep@gnu.org/msg01291.html)应该这样做。如果您需要更复杂的区域（非矩形），那么 Apple 的[裁剪图像示例](http://developer.apple.com/SampleCode/Cropped_Image/index.html)包括用于裁剪为贝塞尔曲线的代码（参见`-croppedImage`CroppingImageView.m）。

# wcf - TCP/IP 未能建立传出连接

> ID：1007079
> 
> 赞同：1
> 
> 时间：2009-06-17T13:36:59.520
> 
> 标签：wcf, tcp

我们在我们的 Web 和 SQL 服务器（启用 IPv6 的 Win 2008 SP1）上看到 TCP/IP 警告和相当多的连接失败，当工作进程/SQL 服务器进程连续运行几天时，这种情况更常见. 我想知道是什么导致了这些警告？允许的默认 TCP 连接数是多少，我们如何提高它？

> TCP/IP 未能建立传出连接，因为选定的本地端点最近被用于连接到同一个远程端点。当传出连接以高速率打开和关闭时，通常会发生此错误，从而导致使用所有可用的本地端口并强制 TCP/IP 将本地端口重新用于传出连接。为了最大限度地降低数据损坏的风险，TCP/IP 标准要求在从给定本地端点到给定远程端点的连续连接之间经过的最短时间段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:53:17.367

听起来有点像您的连接开始失败，然后自动重试。如果重试发生得足够快，TCP 可以在整个端口范围内循环，并且您的所有端口都将处于 TIME-WAIT 状态（IIRC 这就是该状态的名称，自从我详细调试 TCP 以来已经有一段时间了）。

首先要了解几点：

1.  谁发起了连接，它们应该用于什么？
2.  验证连接失败率，我倾向于使用 Wireshark 来处理这类事情。

然后，您必须寻找有关连接失败原因的线索。可能传出连接到服务器，服务器是否已启动并正在运行？为什么服务器不接受连接 - 负责接受连接的进程/线程是死锁的、阻塞的还是退出的？发起方和服务器之间的网络是否正常工作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T13:40:37.500

这是该错误的[TechNet 页面](http://technet.microsoft.com/en-us/library/dd408475(WS.10).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:44:56.570

你在用类似的东西吗

```
setsockopt(s, SOL_SOCKET, SO_REUSEADDR, &on, sizeof(on) 
```

它允许您在没有警告的情况下重复使用相同的套接字两次

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T13:45:59.940

在我看来，这与错误消息所暗示的完全一样……您的端口已用尽。这意味着很多传出连接。

默认是不限制tcp连接数（我猜你只受端口数限制，大概是1024到65534端口）

我将开始调查为什么您会在如此短的时间内看到如此多的传出连接。

# xcode - 告诉 AppleScript 构建 XCode 项目

> ID：1007082
> 
> 赞同：13
> 
> 时间：2009-06-17T13:37:58.753
> 
> 标签：xcode, applescript

以下是我想要的步骤：

1.  启动 xcode
2.  打开特定的 xcodeproj 文件
3.  构建和调试它
4.  退出 xcode

以下是我第一次尝试编写 AppleScript：

```
tell application "Xcode"
    tell project "iphone_manual_client"
        debug
    end tell
    close project "iphone_manual_client"
end tell 
```

这仅在 xcode 打开此项目时有效。我希望仅在必要时才打开该项目。

那里的任何 AppleScript 大师都可以为我指明正确的方向吗？谢谢。

-川-

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T14:44:18.120

我想我设法解决了。以下是 AppleScript：

```
tell application "Xcode"
    open "Users:chuan:Desktop:iphone_manual_client:iphone_manual_client.xcodeproj"
    tell project "iphone_manual_client"
            clean
            build
            (* for some reasons, debug will hang even the debug process has completed. 
               The try block is created to suppress the AppleEvent timeout error 
             *)
            try
                debug
            end try
    end tell
    quit
end tell 
```

路径的格式必须是“:”而不是“/”。现在唯一的问题是，在调试控制台完成工作后，AppleScript 似乎“挂起”，就好像在等待某些事情发生一样。我需要对 AppleScript 做更多的研究才能知道脚本有什么问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T13:43:22.347

我不确定 AppleScript 但您可以从命令行编译它，而无需打开 xcode ide，如下所示：

```
xcodebuild -configuration Debug -target WhatATool -project WhatATool.xcodeproj 
```

其中配置是显而易见的选项，target 是 xcode 的 Target 列表中的名称和最后的项目名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T13:42:31.303

有一个名为`xcodebuild`（man page [here](http://developer.apple.com/documentation/Darwin/Reference/Manpages/man1/xcodebuild.1.html)）的命令行实用程序，它可能更适合您想要完成的任务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T17:22:52.463

由于调试可能会花费任意时间，因此您可能需要在调试消息周围设置“超时秒数”/“结束超时”块。

# java - 类与类的区别

> ID：1007084
> 
> 赞同：46
> 
> 时间：2009-06-17T13:38:23.310
> 
> 标签：java, generics

`Class`声明和声明有什么区别`Class<?>`。

*   `Class a;`
*   `Class<?> b;`

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-17T13:46:07.397

它与所有泛型和原始类型相同：

```
Class          // An unknown class (raw type)
Class<?>       // An unknown class (generic version)
Class<String>  // The String class 
```

在这种特殊情况下，和之间没有太大的实际区别`Class`，`Class<?>`因为它们都表示未知类。根据现有的声明，编译器可以要求泛型类型而不是原始类型。

**但是：**从 Java 1.5 开始，您应该尽可能使用泛型形式。`Class<?>`清楚地表明您的意思是“未知的班级”，清楚地表明`Class<String>`您的意思是`String`班级。一个 raw`Class`可能意味着*两者*。

最后，它对编译器没有太大的影响，但它在使代码的意图更易于理解和维护方面产生了巨大的差异。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T13:40:12.087

类[javadoc](http://java.sun.com/javase/6/docs/api/java/lang/Class.html)：

> **类型参数：** `T` - 此`Class`对象建模的类的类型。例如，类型`String.class`是`Class<String>`。`Class<?>`如果要建模的类未知，请使用。

`Class`不带类型参数的使用类似于使用不带类型参数的任何泛型类（ `Map`,`List`等）——要么是 1.5 之前的遗留用法，要么只是一段不关心未经检查的类型转换的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T13:45:52.123

类`<?>`表明您有意编写 Java 5 级代码，而这些代码不知道也不关心您正在处理的是什么类。省略 会使它看起来像旧代码或由尚未学习泛型的人编写的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-30T23:51:49.743

“它看起来像旧代码或由尚未学习泛型的人编写的代码。” 这是一个正确的说法。类（读作“未知类”），即类型匹配任何东西的类。出于显而易见的原因，它被称为通配符类型。

例如：

```
public void drawAll(List<Shape> shapes) {
    for (Shape s: shapes) {
        s.draw(this);
   }
} 
```

类型规则说 drawAll() 只能在正好 的列表上调用`Shape`：例如，它不能在 a 上调​​用`List<Circle>`。这是不幸的，因为该方法所做的只是从列表中读取形状，所以它也可以在`List<Circle>`.

我们真正想要的是接受任何形状列表的方法。

```
public void drawAll (List <? extends Shape> shapes) {

} 
```

阅读更多：[http ://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html](http://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html)

# language-agnostic - 与客户或第三方共同开发时，我需要注意哪些陷阱？

> ID：1007101
> 
> 赞同：1
> 
> 时间：2009-06-17T13:40:08.093
> 
> 标签：language-agnostic

最近我们一直在进行一些共同开发，我认为我没有提出我应该有效地做这件事的建议。我一直在与客户雇佣的第三方承包商、客户的开发人员（当然还有我自己的内部开发人员）合作。认为这些情况甚至可以长期解决是荒谬的吗？如果是这样，我需要注意哪些陷阱？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T13:43:44.810

**最大的陷阱**：不知道谁有什么责任。

除非每个人都聚在一起制定路线图，详细说明谁负责什么，何时何地，否则很可能会有很多人踩到脚。在厨房里有这么多厨师的项目中，适当的职责分配将是至关重要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T13:53:52.777

考虑因素是：

*   **一致性**。事先就使用的语言、代码风格、文档格式达成一致
*   **易于协作**。设置 SVN 或 GIT 以确保记录所有更改并负责
*   **规划**。在您彻底规划出应用程序的功能之前，没有人应该编写任何代码。
*   **沟通**。确保沟通有条不紊。你不希望对不同的人说不同的事情。设置一个电子邮件列表或论坛，以便人们随时了解情况。
*   **变化**。如何添加更改和功能。
*   **责任**。你的责任在哪里结束，承包商从哪里开始。如果承包商发送您的部分无法处理的数据是您的责任还是他们的责任？这是最大的问题，因为很难预见这些事情。特别是不要假设界限很明显，因为职责经常重叠。尽早明确定义您的职责范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:44:09.333

只有有明确的责任和领导线，它才能奏效。除了客户本身，您的公司是否负责监督第三方人员？反之亦然？

如果没有明确的“决定者”，那将是地狱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T13:52:46.667

经常更新。您应该尝试每两到三周让每个人都聚在一起，以确保您的代码一起工作，否则您最终会花费数周时间尝试将它们全部混入一个工作程序。

# unix - 转换补丁条级别

> ID：1007114
> 
> 赞同：4
> 
> 时间：2009-06-17T13:41:42.570
> 
> 标签：unix, patch

假设我有一个可以与 -p0 一起应用的补丁，是否有工具可以自动将此补丁转换为 -p1 补丁。例如，变换

```
Index: stdio-common/_i18n_number.h
===================================================================
--- stdio-common/_i18n_number.h (revision 8348)
+++ stdio-common/_i18n_number.h (working copy)
@@ -116,7 +116,7 @@ _i18n_number_rewrite (CHAR_T *w, CHAR_T
 #else

 static CHAR_T *
-_i18n_number_rewrite (CHAR_T *w, CHAR_T *rear_ptr)
+_i18n_number_rewrite (CHAR_T *w, CHAR_T *rear_ptr, CHAR_T *end)
 {
   return w;
 } 
```

进入相同的补丁，但路径前面的目录名称不同（注意a，b）

```
Index: stdio-common/_i18n_number.h
===================================================================
--- a/stdio-common/_i18n_number.h (revision 8348)
+++ b/stdio-common/_i18n_number.h (working copy)
@@ -116,7 +116,7 @@ _i18n_number_rewrite (CHAR_T *w, CHAR_T
 #else

 static CHAR_T *
-_i18n_number_rewrite (CHAR_T *w, CHAR_T *rear_ptr)
+_i18n_number_rewrite (CHAR_T *w, CHAR_T *rear_ptr, CHAR_T *end)
 {
   return w;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:23:32.563

只需转换 diff 块标头中的文件名就足够了。

```
sed \
    -e 's!^--- !&a/!' \
    -e 's!^+++ !&b/!' \
    < p0.patch \
    > p1.patch 
```

对于其他补丁修改工具，我建议使用[patchutils](http://cyberelk.net/tim/patchutils/)，但这个工具非常简单，没有预先存在的实用程序。

# java - 如何创建带圆角的 JButton 扩展？

> ID：1007116
> 
> 赞同：3
> 
> 时间：2009-06-17T13:42:17.013
> 
> 标签：java, swing, rounded-corners, jbutton

[这是“Java rounded Swing JButton”](https://stackoverflow.com/questions/778222/make-a-button-round)问题的延续。我已经搜索了 javax.swing.JButton 的扩展，它将继承所有运行时行为并仅覆盖角的绘制。

使用[sun 论坛页面](http://forums.sun.com/thread.jspa?threadID=284897&tstart=28696)上[noah.w](http://forums.sun.com/profile.jspa?userID=81148)给出的代码，结果如下所示：

[![替代文字](../Images/851efc7537b52dd40c914db2db79cd17.png)](https://i.stack.imgur.com/sZX30.png)

我希望能够在背景中具有相同的渐变，鼠标悬停变化等。有人知道该怎么做吗？

从图片中创建 Java Swing 窗口的代码是：

```
public class XrButton extends JButton implements MouseListener {

    private static final long serialVersionUID = 9032198251140247116L;

    String text;
    boolean mouseIn = false;

    public XrButton(String s) {
        super(s);
        text = s;
        setBorderPainted(false);
        addMouseListener(this);
        setContentAreaFilled(false);
    }

    @Override
    public void paintComponent(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        if (getModel().isPressed()) {
            g.setColor(g.getColor());
            g2.fillRect(3, 3, getWidth() - 6, getHeight() - 6);
        }
        super.paintComponent(g);

        if (mouseIn)
            g2.setColor(Color.red);
        else
            g2.setColor(new Color(128, 0, 128));

        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setStroke(new BasicStroke(1.2f));
        g2.draw(new RoundRectangle2D.Double(1, 1, (getWidth() - 3),
                (getHeight() - 3), 12, 8));
        g2.setStroke(new BasicStroke(1.5f));
        g2.drawLine(4, getHeight() - 3, getWidth() - 4, getHeight() - 3);

        g2.dispose();
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.getContentPane().setLayout(new FlowLayout());

        XrButton xrButton = new XrButton("XrButton");
        JButton jButton = new JButton("JButton");

        frame.getContentPane().add(xrButton);

        frame.getContentPane().add(jButton);

        frame.setSize(150, 150);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
    }

    public void mouseClicked(MouseEvent e) {
    }

    public void mouseEntered(MouseEvent e) {
        mouseIn = true;
    }

    public void mouseExited(MouseEvent e) {
        mouseIn = false;
    }

    public void mousePressed(MouseEvent e) {
    }

    public void mouseReleased(MouseEvent e) {
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:09:52.060

我认为您在这里有两个选择：

1.在组件的paint方法中实现自己绘制

2.为您的外观和感觉创建新的ButtonUI。在这种情况下，我建议使用同步 LAF

在这两种情况下绘制不同的状态是你的责任

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:35:17.500

我在 Swing 中看到的圆形按钮的最佳实现是在 Substance 外观中：

[https://substance.dev.java.net/](https://substance.dev.java.net/)

并非所有主题都有圆形按钮，因此您可能需要更改演示中的默认设置。该项目是开源的，因此可能值得在代码中寻找一些想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-28T16:33:57.643

我也需要做这个，这就是我最终得到的（仅限金属 LAF！）

```
@Override
    protected void paintComponent(Graphics g)
    {
        Graphics2D g2 = (Graphics2D) g;
        g2.setRenderingHints(new RenderingHints(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON));
        Shape firstClip = g.getClip();
        RoundRectangle2D rect = new RoundRectangle2D.Double();
        double arc = Math.ceil(getSize().getHeight()/3);
        rect.setRoundRect(0, 0, Math.ceil(getSize().getWidth()), Math.ceil(getSize().getHeight()), arc, arc);
        Area secondClip = new Area(getBounds());
        secondClip.subtract(new Area(rect));
        Area finalClip = new Area(firstClip);
        finalClip.subtract(secondClip);
        g2.setClip(finalClip);
        super.paintComponent(g2);
        Color[] gradients;
        if(getModel().isRollover())
        {
            gradients = new Color[] { new Color(184, 207, 229), new Color(122, 138, 153), new Color(184, 207, 229) };
        }
        else
        {
            gradients = new Color[] { new Color(122, 138, 153) };
        }
        for(int i = 0; i < gradients.length; i++)
        {
            arc -= 2;
            g2.setColor(gradients[i]);
            g2.drawRoundRect(i+1, i+1, (int)Math.ceil(getSize().getWidth()-2)-(i*2), (int)Math.ceil(getSize().getHeight()-2)-(i*2), (int)arc, (int)arc);
        }
    } 
```

看起来像这样：http: [//i.stack.imgur.com/unZuc.png](http://i.stack.imgur.com/unZuc.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:08:29.863

你必须自己照顾它：

*   首先，您可以捕获按钮上用于更改状态的各种动作（例如在代码中，其中 mouseIn 用于更改颜色）
*   那么你必须关心你需要的每一个绘画细节，例如你应该指向`GradientPaint`用于绘制渐变的类的渐变。

顺便说一句，您必须注意各种外观和感觉，并且您的解决方案只适合其中一种......

# java - 制作个人编程工具箱

> ID：1007118
> 
> 赞同：3
> 
> 时间：2009-06-17T13:43:18.760
> 
> 标签：java, toolbox

最近我一直在考虑用java为自己创建一种“工具箱”。它将由经常使用但很难实现的标准算法和数据结构组成。（我在想图表、树等）

最好的方法是什么？我正在考虑使用泛型或使用抽象类。这样，我可以让任何想要使用这些方法的对象只需提供一个 getGraphData() 方法或类似的方法。

我认为泛型可能会更好，因为抽象类会迫使我从它继承，这可能会成为问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T13:51:00.600

这叫图书馆……

通用的东西应该在 Java 库中。如果缺少某些您想要的东西，您可以尝试其他库，例如 Google Collections。您可能还需要特定于域的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T13:50:32.817

两种方法：

方式一：

1.  创建类图
2.  在 Graph 类中创建方法，每个方法对应于您的算法。

方式二：

1.  创建类Graph（纯数据结构）
2.  创建类算法
3.  子类算法来定义你的每个新算法。

当然，最好查看 STL 算法并以类似的方式对图形算法进行建模。您甚至可以开源您的数据结构和相关算法。通过这种方式，社区可以处理更新的算法、效率考虑、与现有库的集成/集成等。

jrh

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:05:53.503

*大多数情况下，应该使用由真正*知道自己在做什么的人编写的预先存在的库——这些库已经过彻底的测试，并使用有效的算法实现以获得良好的性能。

但是，如果确实要制作自己的库，我会说尽量模仿最好的——看看[Java 集合](http://java.sun.com/docs/books/tutorial/collections/index.html)和[Google 集合](http://code.google.com/p/google-collections/)是如何设计的。查看提供了哪些类型的接口（`List`、`Map`等）以及存在哪些抽象类和实现。

然后，如果是出于教育目的，请继续编写自己的实现。它应该是有趣和令人兴奋的，并且绝对具有挑战性。尝试查看行为是否符合预期——编写测试以确保涵盖典型用途和边缘情况。

但是，我建议不要将其用于教育用途以外的实际用途。在学校犯错没什么大不了的，但一旦出现在现实世界中，情况就大不相同了。

# math - 拆分基于非二次幂的 int

> ID：1007120
> 
> 赞同：0
> 
> 时间：2009-06-17T13:43:27.010
> 
> 标签：math, bit-manipulation

我知道你可以像这样将一个二的幂数分成两半：

```
halfintR = some32bitint & 0xFFFF
halfintL = some32bitint >> 16 
```

你可以对一个以非两个空间的幂为界的整数做同样的事情吗？

（假设您希望将您的范围限制为适合 4 位基数 52 无符号空间的整数集）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T13:48:06.813

嗯，当然。`& 0xffff`和一样`% 0x10000`和`>> 16`一样`/ 0x10000`。只是在进行移位和屏蔽等位操作时，除以 2 的幂更有效。除法适用于任何数字（在表示范围内）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:00:09.007

你可以使用以下

```
rightDigits = number % 2704 // 52 squared
leftDigits = number / 2704 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:11:05.630

一旦您意识到`&`和`>>`分别用于进行`modulo`und`division`计算，您可以编写您想要的内容：

```
lower = some4DigitsNumberBase52 % (52 * 52)
upper = some4DigitaNumberBase52 / (52 * 52) 
```

这是进行基数计算的基础。您还可以从以特定基数显示数字的算法得出解决方案：您如何得出最右边的两位数字和最左边的 2 位数字。

# jquery - jQuery ThickBox：调用初始化方法时出现多个标题栏

> ID：1007128
> 
> 赞同：0
> 
> 时间：2009-06-17T13:44:30.037
> 
> 标签：jquery, thickbox

我正在使用 jQuery 厚框在我的页面上使用灯箱效果。有时我使用 jQuery 的加载方法加载我的一个 DIV 的内容。当时厚框没有工作，所以我调用了初始化函数（我把在另一个名为 PreLoad() 并调用它的函数中）在我将内容加载到 div 之前在thickbox.js 中可用

```
$(document).ready(function(){   
tb_init('a.thickbox, area.thickbox, input.thickbox');//pass where to apply thickbox
imgLoader = new Image();// preload image
imgLoader.src = tb_pathToImage;
}); 
```

所以此后我的灯箱工作正常。我想在我一次又一次地加载内容时调用 PreLoad() 函数。现在如果我调用 PreLoad 函数 4 次，我的灯箱中有 4 个标题栏。不知道如何继续。有什么想法吗 ？？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-05T13:04:24.653

或添加

```
$("#TB_window").html(""); 
```

文件中`tb_show`函数顶部的某处。`thickbox.js`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:47:21.720

您需要添加对“tb_remove();”的调用 进入你的交互模式。那应该干净地卸载一个厚盒实例。

只需添加“tb_remove();” 到 PreLoad() 函数的顶部。

# wpf - Prism CAG - WPF - 模块的新实例？它只是克隆实例吗？

> ID：1007131
> 
> 赞同：0
> 
> 时间：2009-06-17T13:44:58.723
> 
> 标签：wpf, prism

我正在使用 Prism 的 CAG 开发 WPF 应用程序。我想要实现的是创建模块（ModuleA）的新实例并将它们加载到 TabControl 中。我能够使用 moduleInfo 对象实例化模块并通过 Assembly 加载它们并调用 CreateModule(type) 方法。

我实际上可以在 UI 中看到不同的模块，但问题是当我开始与不同的模块交互时（例如在作用域区域中加载或卸载视图），所有活动似乎只发生在最后加载的模块上。

因此，例如，我将 ModuleA 的 2 个“实例”作为 2 个 TabItems，并且它们都有用于 Load() 新视图的命令按钮。当我选择第一个模块（通过选择第一个 TabItem）并单击按钮加载视图时，视图将加载到第二个模块中。

有谁知道如何解决这个问题？让我相信，即使我在 UI 上“看到”两个单独的模块，实际上只有一个实例或者 CreateModule 创建了克隆？

任何人 ？所有帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-20T21:38:59.463

正如 Erik 所解释的，在 Prism 中加载模块和视图是非常不同的概念。

在理解这一点并处理类似于问题中的场景时，以下线程很有用：

*   [http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=59827](http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=59827)
*   [http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=59040](http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=59040)

我希望这很有用。

谢谢，达米安

# c# - 我应该使用什么 .NET 类来表示子网及其掩码？

> ID：1007135
> 
> 赞同：4
> 
> 时间：2009-06-17T13:46:11.560
> 
> 标签：c#, .net, subnet

我可以`System.Net.IPAddress`用来表示单个 IP 地址，但我可以用什么来表示整个子网，包括网络地址和子网掩码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T13:53:17.117

我相信您也可以使用 System.Net.IPAddress 来表示子网掩码。它具有相同的形式，您需要执行的唯一实际操作是基于子网地址字节的位掩码。

```
System.Net.IPAddress i = System.Net.IPAddress.TryParse("10.10.1.1");
Byte[] b = i.GetAddressBytes(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-08T12:17:19.740

```
struct NetworkIPAddress
{
  public IPAddress IP;
  public uint Mask;
} 
```

# excel - 为什么一个 ADO.NET Excel 查询有效而另一个无效？

> ID：1007137
> 
> 赞同：4
> 
> 时间：2009-06-17T13:46:28.643
> 
> 标签：excel, ado.net, ado

我正在处理 SharePoint 工作流，第一步需要我打开一个 Excel 工作簿并阅读两件事：一个类别范围（来自一个命名范围，足够方便，`Categories`）和一个类别索引（在命名范围中`CategoryIndex`）。`Categories`是大约 100 个单元格的列表，并且`CategoryIndex`是单个单元格。

我正在使用 ADO.NET 来查询工作簿

```
string connectionString =
    "Provider=Microsoft.ACE.OLEDB.12.0;" +
    "Data Source=" + temporaryFileName + ";" +
    "Extended Properties=\"Excel 12.0 Xml;HDR=YES\"";

OleDbConnection connection = new OleDbConnection(connectionString);
connection.Open();

OleDbCommand categoryIndexCommand = new OleDbCommand();
categoryIndexCommand.Connection = connection;
categoryIndexCommand.CommandText = "Select * From CategoryIndex";

OleDbDataReader indexReader = categoryIndexCommand.ExecuteReader();
if (!indexReader.Read())
    throw new Exception("No category selected.");
object indexValue = indexReader[0];
int categoryIndex;
if (!int.TryParse(indexValue.ToString(), out categoryIndex))
    throw new Exception("Invalid category manager selected");

OleDbCommand selectCommand = new OleDbCommand();
selectCommand.Connection = connection;
selectCommand.CommandText = "SELECT * FROM Categories";
OleDbDataReader reader = selectCommand.ExecuteReader();

if (!reader.HasRows || categoryIndex >= reader.RecordsAffected)
    throw new Exception("Invalid category/category manager selected.");

connection.Close(); 
```

不要太苛刻地判断代码本身；它经历了很多。无论如何，第一个命令永远不会正确执行。它不会抛出异常。它只返回一个空数据集。（`HasRows`是`true`，并`Read()`返回`false`，但那里没有数据）第二个命令完美运行。这些都是命名范围。

然而，它们的填充方式不同。有一个网络服务调用已满`Categories`。这些值显示在下拉框中。选定的索引进入`CategoryIndex`. 经过几个小时的努力，我决定编写几行代码，以便下拉列表的值进入不同的单元格，然后我使用几行 C# 将值复制到 中`CategoryIndex`，以便数据设置相同。原来那也是一条死胡同。

我错过了什么吗？为什么一个查询可以完美运行而另一个无法返回任何数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:21:28.390

我发现了这个问题。Excel 显然无法解析单元格中的值，因此它没有返回任何内容。我必须做的是将连接字符串调整为以下内容：

```
string connectionString =
    "Provider=Microsoft.ACE.OLEDB.12.0;" +
    "Data Source=" + temporaryFileName + ";" +
    "Extended Properties=\"Excel 12.0 Xml;HDR=NO;IMEX=1\""; 
```

如果它抛出异常或给出失败原因的*任何*指示会很有帮助，但现在这已经无关紧要了。该选项`IMEX=1`告诉 Excel 仅将所有值视为字符串。我非常有能力解析我自己的整数，非常感谢 Excel，所以我不需要它的帮助。

# sql-server-2008 - 在 SQLServer 中捕获并继续

> ID：1007140
> 
> 赞同：1
> 
> 时间：2009-06-17T13:46:38.377
> 
> 标签：sql-server-2008, stored-procedures

我有这个 sql 过程：

```
create procedure DELETE as
DECLARE VARIABLES
begin TRY
DECLARE CURSOR FOR SELECT ANYTHING
OPEN CURUPD 
FETCH NEXT FROM CURUPD INTO VARIABLES
WHILE @@FETCH_STATUS = 0 BEGIN  
    UPDATE TABLE BASED SON VARIABLES
FETCH NEXT FROM CURUPD INTO VARIABLES
END 
CLOSE CUR
DEALLOCATE CUR
end TRY
begin catch
 DO NOT CARE ABOUT THE ERROR BUT CONTINUE UPDATE ON NEXT RECORD
end catch; 
```

这可能吗？罗伯特:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T13:50:45.047

您必须将 TRY/CATCH 放在 WHILE 循环内。按照你的方式，你不能*继续*WHILE 循环，因为它已经完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-04T05:03:45.150

试试这个代码：

```
create procedure DELETE as
DECLARE VARIABLES
begin TRY
DECLARE CURSOR FOR SELECT ANYTHING
OPEN CURUPD 
FETCH NEXT FROM CURUPD INTO VARIABLES
WHILE @@FETCH_STATUS = 0 BEGIN  
    UPDATE TABLE BASED SON VARIABLES
FETCH NEXT FROM CURUPD INTO VARIABLES
END 
CLOSE CUR
DEALLOCATE CUR
end TRY
begin catch
 FETCH NEXT FROM CURUPD INTO VARIABLES
 continue
end catch; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:51:06.043

有些错误是不可捕获的，即使使用 try 和 catch 也会中止批处理，您可以检查[XACT_STATE()](http://msdn.microsoft.com/en-us/library/ms189797.aspx)然后确定要做什么

为什么你需要一个游标你不能做一个基于 SET 的更新吗？您的尝试也在循环之外，但您仍然会遇到同样的问题，请尝试使用 'A' 更新一个 int 列，n .... BOOM！

# weblogic - 如何配置 WebLogic 10.3 Web 应用以使用 SAML 2 SSO 和身份提供程序？

> ID：1007141
> 
> 赞同：5
> 
> 时间：2009-06-17T13:46:47.270
> 
> 标签：weblogic, single-sign-on, saml, web-applications

我有几个 Web 应用程序都在 WebLogic 10 中运行，我想使用 SSO 和 WebLogic 的内置 SAML 2 SSO 支持对用户进行身份验证。
我在安全领域配置了一个 SAML2IdentityAsserter，并创建了一个 Web SSO 身份提供者合作伙伴，该合作伙伴使用来自我之前设置的身份提供者的元数据。这一切似乎都很顺利。
我部署了一个用于测试的简单 Web 应用程序，该应用程序配置为使用此领域。但是，当我尝试登录网络应用程序时，它似乎甚至没有尝试使用身份提供者。我将 BASIC 和 CLIENT-CERT 都设置为，但两者都表现得好像没有设置 SAM2IdentityAsserter。我尝试更改断言器的顺序并尝试删除默认断言器，但这些都没有产生任何影响。有没有人在 WLS 10.3 下成功做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-24T14:45:52.987

也许您可以看一下[使用 Weblogic 10.3.4 实现 SAML2 SP 发起的用例。和 ADFS](https://stackoverflow.com/questions/6468836/implementing-saml2-sp-initiated-use-case-with-weblogic-10-3-4-and-adfs)

此致，

路易斯

ps：现在，我们的配置似乎是正确的，我们可以登录我们的 SSO 系统，但我们从 Idp 得到错误。您需要通过描述符（web.xml 和 weblogic.xml）在应用程序中设置安全性。看看你的 weblogic 应用程序控制台的配置： $WEBLOGIC_HOME/wlserver/server/lib/consoleapp/webapp/WEB-INF/web.xml 和 $WEBLOGIC_HOME/wlserver/server/lib/consoleapp/webapp/WEB-INF/ weblogic.xml)

# php - 如何计算不同时间跨度内总点数的百分位排名？

> ID：1007146
> 
> 赞同：3
> 
> 时间：2009-06-17T13:47:33.510
> 
> 标签：php, mysql, math, codeigniter

在基于 PHP 和 CodeIgniter 的网站上，用户可以通过各种操作赢得声誉，这与 Stack Overflow 不同。每次授予声誉时，都会在 MySQL 表中创建一个新条目，其中包含`user_id`、被奖励的操作以及那一堆点的值（例如 10 声誉）。同时，更新`users`表中的字段 。`reputation_total`

由于没有参考框架，所有这些都是毫无意义的，我想向用户展示他们在所有用户中的百分位排名。就整体声誉而言，这似乎很容易。假设我的`user_id`是`1138`。只需`users`统计表中`reputation_total`低于我的用户数，统计用户总数，然后除以求信誉低于我的用户的百分比。那将是用户 1138 的百分等级，对吗？简单的！

但我还显示了不同时间跨度内的声望总数——例如，在过去 7 天内获得的声望，这包括查询声望表并将我自给定日期以来获得的所有积分相加。我还想显示不同时间跨度的百分位排名——例如，我总体上可能是第 11 个百分位，但本月是第 50 个百分位，今天是第 97 个百分位。

看来我必须通过并找到给定时间跨度内所有用户的声誉总数，然后查看我属于该组的哪个位置，不是吗？这不是很麻烦吗？最好的方法是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T13:51:40.707

我不明白为什么这会过于复杂。通常，您只需要在 WHERE 子句中添加一个限制结果的查询，例如：

```
WHERE DatePosted between @StartOfRange and @EndOfRange 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:09:21.810

我可以在这里想到几个选项：

1.  正如您所提到的，将在时间范围内获得的声望点加起来，并据此计算百分位排名。

2.  每天跟踪对reputation_total 的更新——这样您就有一个包含user_id、日期、reputation_total 的表。

3.  为每个时间范围向用户表添加一些新列（reputation_total、reputation_total_today、reputation_total_last30days 等）。您还可以将其规范化为一个单独的表 (reputation_totals)，以防止您必须为要跟踪的每个时间跨度添加一个新列。

选项 #1 是最简单的，但是如果您的信誉事务表中有很多行，它可能会变慢 - 它不会很好地扩展，特别是如果您需要实时计算这些。

Option #2 is going to require more storage over time (one row per user per day) but would probably be significantly faster than querying the transaction table directly.

Option #3 is less flexible, but would likely be the fastest option.

Both options 2 & 3 would likely require a batch process to calculate the totals on a daily basis, so that's something to consider as well.

I don't think any option is necessarily the best - they all involve different tradeoffs of speed/storage space/complexity/flexibility. What you do will ultimately depend on the requirements for your application of course.

# c++ - 高斯消元的逻辑错误

> ID：1007151
> 
> 赞同：1
> 
> 时间：2009-06-17T13:48:23.850
> 
> 标签：c++, c, math

高斯消除代码的逻辑错误问题...此代码来自我在 1990 年代的数值方法文本。代码是从书中输入的 - 没有产生正确的输出......

样品运行：

```
 SOLUTION OF SIMULTANEOUS LINEAR EQUATIONS
         USING GAUSSIAN ELIMINATION

 This program uses Gaussian Elimination to solve the
 system Ax = B, where A is the matrix of known
 coefficients, B is the vector of known constants
 and x is the column matrix of the unknowns.
 Number of equations: 3

 Enter elements of matrix [A]
 A(1,1) = 0
 A(1,2) = -6
 A(1,3) = 9
 A(2,1) = 7
 A(2,2) = 0
 A(2,3) = -5
 A(3,1) = 5
 A(3,2) = -8
 A(3,3) = 6

 Enter elements of [b] vector
 B(1) = -3
 B(2) = 3
 B(3) = -4

         SOLUTION OF SIMULTANEOUS LINEAR EQUATIONS

         The solution is
         x(1) = 0.000000
         x(2) = -1.#IND00
         x(3) = -1.#IND00
         Determinant = -1.#IND00
Press any key to continue . . . 
```

从文本中复制的代码...

```
//Modified Code from C Numerical Methods Text- June 2009

#include <stdio.h>
#include <math.h>
#define MAXSIZE 20

//function prototype
int gauss (double a[][MAXSIZE], double b[], int n, double *det);

int main(void)
{
    double a[MAXSIZE][MAXSIZE], b[MAXSIZE], det;
    int i, j, n, retval;

    printf("\n \t SOLUTION OF SIMULTANEOUS LINEAR EQUATIONS");
    printf("\n \t USING GAUSSIAN ELIMINATION \n");
    printf("\n This program uses Gaussian Elimination to solve the");
    printf("\n system Ax = B, where A is the matrix of known");
    printf("\n coefficients, B is the vector of known constants");
    printf("\n and x is the column matrix of the unknowns.");

    //get number of equations
    n = 0;
    while(n <= 0 || n > MAXSIZE)
    {
        printf("\n Number of equations: ");
        scanf ("%d", &n);
    }

    //read matrix A
    printf("\n Enter elements of matrix [A]\n");
    for (i = 0; i < n; i++)
        for (j = 0; j < n; j++)
        {
            printf(" A(%d,%d) = ", i + 1, j + 1);
            scanf("%lf", &a[i][j]);
        }
    //read {B} vector
    printf("\n Enter elements of [b] vector\n");
    for (i = 0; i < n; i++)
    {
        printf(" B(%d) = ", i + 1);
        scanf("%lf", &b[i]);
    }

    //call Gauss elimination function
    retval = gauss(a, b, n, &det);

    //print results
    if (retval == 0)
    {
        printf("\n\t SOLUTION OF SIMULTANEOUS LINEAR EQUATIONS\n");
        printf("\n\t The solution is");
        for (i = 0; i < n; i++)
            printf("\n \t x(%d) = %lf", i + 1, b[i]);
        printf("\n \t Determinant = %lf \n", det);
    }
    else
        printf("\n \t SINGULAR MATRIX \n");

    return 0;
 }

/* Solves the system of equations [A]{x} = {B} using       */
/* the Gaussian elimination method with partial pivoting.  */
/* Parameters:                                             */
/*      n         - number of equations                    */
/*      a[n][n]   - coefficient matrix                     */
/*      b[n]      - right-hand side vector                 */
/*      *det      - determinant of [A]                     */

int gauss (double a[][MAXSIZE], double b[], int n, double *det)
{
    double tol, temp, mult;
    int npivot, i, j, l, k, flag;

    //initialization
    *det = 1.0;
    tol = 1e-30;        //initial tolerance value
    npivot = 0;
        //mult = 0;

    //forward elimination
    for (k = 0; k < n; k++)
    {
        //search for max coefficient in pivot row- a[k][k] pivot element
        for (i = k + 1; i < n; i++)
        {
            if (fabs(a[i][k]) > fabs(a[k][k]))
            {
                //interchange row with maxium element with pivot row
                npivot++;
                for (l = 0; l < n; l++)
                {
                   temp = a[i][l];
                   a[i][l] = a[k][l];
                   a[k][l] = temp;
                }
                temp = b[i];
                b[i] = b[k];
                b[k] = temp;
            }
        }
        //test for singularity
        if (fabs(a[k][k]) < tol)
        {
           //matrix is singular- terminate
           flag = 1;
           return flag;
        }
        //compute determinant- the product of the pivot elements
        *det = *det * a[k][k];

        //eliminate the coefficients of X(I)
        for (i = k; i < n; i++)
        {
            mult = a[i][k] / a[k][k];
            b[i] = b[i] - b[k] * mult;  //compute constants
            for (j = k; j < n; j++)     //compute coefficients
                a[i][j] = a[i][j] - a[k][j] * mult;
        }
    }
    //adjust the sign of the determinant
    if(npivot % 2 == 1)
      *det = *det * (-1.0);

    //backsubstitution
    b[n] = b[n] / a[n][n];
    for(i = n - 1; i > 1; i--)
    {
        for(j = n; j > i + 1; j--)
            b[i] = b[i] - a[i][j] * b[j];
        b[i] = b[i] / a[i - 1][i];
    }
    flag = 0;
    return flag;
} 
```

解决方案应为：1.058824、1.823529、0.882353，det 为 -102.000000

任何见解表示赞赏...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T14:05:27.607

```
//eliminate the coefficients of X(I)
for (i = k; i < n; i++) 
```

这应该是

```
for (i = k + 1; i < n; i++) 
```

现在的方式，我相信这会导致您自己划分枢轴行，将其归零。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:04:41.477

这可能不会以您想要的方式回答您的问题，但是编写自己的数值稳定矩阵算法与自己动手手术一样明智。

有一个非常好的库，称为[TNT/JAMA](http://math.nist.gov/tnt/download.html)，来自一个有信誉的来源 (NIST)，它在 C++ 中进行基本矩阵数学。要解决 Ax=B，首先要考虑因素 A（[QR 分解](http://math.nist.gov/tnt/jama_doxygen/class_JAMA__QR.html)是一种很好的通用方法，您可以使用 LU，但它的数值稳定性较差），然后调用`solve(B)`. 这既适用于精确的方阵（受数值计算问题的影响），也适用于得到最小二乘答案的超定系统。

# c# - ASP.Net MVC 图像上传通过缩小或填充调整大小

> ID：1007158
> 
> 赞同：4
> 
> 时间：2009-06-17T13:49:56.797
> 
> 标签：c#, asp.net, asp.net-mvc, image

用户将能够上传图像。如果图像大于设定尺寸，我想将其缩小到该尺寸。显然，由于比率，它不必完全匹配，宽度将是关键大小，因此高度将是可变的。

如果图像小于设置大小，我想创建一个具有定义颜色背景的设置大小的新图像，然后将上传的图像居中放置在其中，因此结果是带有填充颜色的原始图像。

非常感谢任何代码示例或链接

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T14:07:08.133

这是我快速敲出的一段代码，用于根据宽度调整它的大小。我相信您可以弄清楚如何为位图添加背景颜色。它不是完整的代码，而只是关于如何做事的想法。

```
public static void ResizeLogo(string originalFilename, string resizeFilename)
{
    Image imgOriginal = Image.FromFile(originalFilename);

    //pass in whatever value you want for the width (180)
    Image imgActual = ScaleBySize(imgOriginal, 180);
    imgActual.Save(resizeFilename);
    imgActual.Dispose();
}

public static Image ScaleBySize(Image imgPhoto, int size)
{
    int logoSize = size;

    float sourceWidth = imgPhoto.Width;
    float sourceHeight = imgPhoto.Height;
    float destHeight = 0;
    float destWidth = 0;
    int sourceX = 0;
    int sourceY = 0;
    int destX = 0;
    int destY = 0;

    // Resize Image to have the height = logoSize/2 or width = logoSize.
    // Height is greater than width, set Height = logoSize and resize width accordingly
    if (sourceWidth > (2 * sourceHeight))
    {
        destWidth = logoSize;
        destHeight = (float)(sourceHeight * logoSize / sourceWidth);
    }
    else
    {
        int h = logoSize / 2;
        destHeight = h;
        destWidth = (float)(sourceWidth * h / sourceHeight);
    }
    // Width is greater than height, set Width = logoSize and resize height accordingly

    Bitmap bmPhoto = new Bitmap((int)destWidth, (int)destHeight, 
                                PixelFormat.Format32bppPArgb);
    bmPhoto.SetResolution(imgPhoto.HorizontalResolution, imgPhoto.VerticalResolution);

    Graphics grPhoto = Graphics.FromImage(bmPhoto);
    grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;

    grPhoto.DrawImage(imgPhoto,
        new Rectangle(destX, destY, (int)destWidth, (int)destHeight),
        new Rectangle(sourceX, sourceY, (int)sourceWidth, (int)sourceHeight),
        GraphicsUnit.Pixel);

    grPhoto.Dispose();

    return bmPhoto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T13:58:34.517

您可以将文件加载到位图对象中：

[http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)

然后只需检查对象的宽度。对于问题的第二部分，我建议使用 ImageMagick 之类的工具

[http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php)

准确调整第一张图像的大小或创建背景图像并将两个图像合并在一起。

# project-management - 价格过低的项目（预算紧张）——有什么特点？

> ID：1007159
> 
> 赞同：1
> 
> 时间：2009-06-17T13:50:07.403
> 
> 标签：project-management, sdlc

我正在尝试确定一些指示资源有限项目的标记。

以我的经验，一个项目变成了一个“资源有限”的项目，因为有人急于向客户出售解决方案。结果是预算紧张，功能被剔除，SDLC 流程被削减到最低限度。这些捷径被采用，因此公司有一定的机会获利甚至收支平衡。

这是我看到的与资源有限的项目齐头并进的事情清单：

*   分配给 QA 的最少时间
*   不合规格工作的严格官僚程序
*   变更请求预算可能很小或不存在
*   正式的流程被放弃，有利于利用时间进行开发
*   没有时间进行内容检查等增值质量检查（例如文本中的语法或拼写错误）。
*   不能为客户做任何内容管理或数据输入
*   必须寻求“足够好”的编码解决方案
*   走廊可用性测试没有时间限制。
*   没有编写用户文档或手册的预算。
*   编码前一般没有时间进行技术研究
*   没有时间制作风险分析文件
*   可以使用生产清单代替项目进度表。
*   程序员没有时间在项目进度表中填写他们的“实际”时间与估计时间。
*   提供给客户的进度更新可能不那么频繁或非常基本
*   可用于了解客户业务领域的时间更少
*   程序员可能不得不无偿加班。
*   没有时间分配给项目事后分析

有限资源项目还有哪些其他确定的迹象？

===

**编辑**

我会尝试用一个例子来消除一些混乱。这就是我的意思：给客户一份提案/报价，说他们的项目将花费 2 万美元。然后客户回来说“对不起，我的预算最高为 16,000 美元”。老板说“让提案 16,000 美元——我们想要这项工作”。

所以，实际上，你必须用比它应该有的更少的预算来做一个项目。有一些界限变得荒谬 - 如果客户说“我的预算是 4,000 美元”，那么你不可能做到。

是的，有时紧张的预算会变得如此愚蠢，以至于一开始就接受这个项目是一个糟糕的商业决定（即注定失败的项目）。

我知道没有预算不受限制的项目。业务人员通常会决定是否应开展项目（业务人员通常不是项目经理）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T15:26:47.037

你所说的不是一个“资源有限”的项目，而是一个匆忙和计划外的项目。

我对您列表中的一些项目有异议：

*   不合规格工作的严格官僚程序
*   变更请求预算可能很小或不存在

实际上，这些应该是大多数项目的规范。谁在请求更改并为更改付费，您还是客户？

*   不能为客户做任何内容管理或数据输入
*   没有编写用户文档或手册的预算。

如果这不是合同的一部分，你为什么要这样做？

*   必须寻求“足够好”的编码解决方案

在某些时候，您必须停止在“足够好”，否则您将从现在到时间结束都在打磨。

我要添加到您的列表中的是：

*   办公用品变得稀缺或处于锁定状态。
*   企业供应的食品/饮料消失了
*   停机时间消失。您在时间表上的 100% 时间必须用于项目工作。
*   打印机/复印机正在全口径打印其他工作人员的简历。
*   Boss 的门一天有 90% 的时间都关着。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T13:55:06.707

坦率地说，我从未听说过拥有无限资源的项目。甚至政府也会在一段时间后制止某些事情。

因此，从纯逻辑的角度来看，所有项目的资源都是有限的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T13:53:00.080

有限的资源？我知道的所有项目资源有限：

*   时间
*   开发商
*   预算

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T13:55:48.140

过时的或明显的 beta 文档，与现场产品的任何版本不相符，或者看起来似乎已经通过几代 Xerox 副本下降的文档。

没有现场安装或支持。根据正在实施的系统的规模，一家状况良好的公司可能会派出一名或多名开发人员来监督实施，而一家紧张的公司可能只会以更加“即发即弃”的方式提供电话或电子邮件支持。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T14:05:11.773

*   不断出现的新的、被遗忘的功能，被用户认为是“显而易见的”和“隐含的”，从未在需求中说明，导致讨论 Bug 与变更请求。
*   采用瀑布模型而不是迭代方法。
*   客户抗议修复成本，说：“如果你有错误，那是因为你没有做好你的工作”，不接受在削减时间/预算时对质量的三重约束效应。
*   项目在生产中部署后，维护和支持活动的价格面临降低的压力。
*   采用固定价格项目（外包）转移财务风险和时间风险的压力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T11:16:34.813

*“低价项目”*

如果我正确理解您的意思，那么您实际上是在谈论项目可用资源不适合实现向客户承诺的结果的项目。

对于这种情况，我可以想到四种方式：

1.  编制项目计划时的错误估计
2.  需求蔓延
3.  在不缩小项目范围的情况下减少项目预算
4.  项目范围内资源不足（员工技能、计算机资源等）

当项目中的人意识到这种情况时，他们真的有两个选择：削减成本或削减范围。削减范围可能很难卖，并且可能危及项目的可行性，因此大多数时候人们选择削减范围，特别是因为可以通过多种方式削减成本而不会引起高层的关注：

*   无偿加班
*   降低质量
*   消除文档

等等。

事实上，当您开始削减成本时，您甚至可能看起来像项目经理，因为成本控制是项目经理的职责之一！我假设您想要找到诊断资金不足项目的方法。我认为，与其制定一个广泛的症状列表，我会努力确定一般情况。

在我看来，有一个一般条件可以确定资金不足的项目。对于大多数项目来说，员工是最大的成本——或者至少是项目经理可以管理的第二大成本。每当您发现一位经验丰富的经理正在采取措施降低员工成本，而这些措施并非最初计划的一部分，那么您可以确定您的项目资金不足。

问候，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-09T13:10:51.237

使用你们如此友好地提供的信息，我能够将它们整合在一起并写一篇文章

生病在这里放一个链接，以防将来有人在该主题上寻求帮助：

[在资源不足的项目中幸存下来](http://pm4web.blogspot.com/2009/06/surviving-under-resourced-project.html)

--LM

# vba - 通过 VBA 检测复选框的更改

> ID：1007164
> 
> 赞同：1
> 
> 时间：2009-06-17T13:51:00.507
> 
> 标签：vba, excel

继我之前的问题之后。

客户的要求是在报表上设置复选框以禁用另一张表上的信息行。这些行被定义为命名范围，由 P_XXXXXX 格式化。XXXXXX 是一个唯一标识符，也是行上的一个字段，因此我可以轻松地动态生成范围名称。

我遇到的问题是：

*   单击项目然后关闭表单后，Excel 会询问我们是否要保存。这是不可取的。

我需要以某种方式注册在我生成的复选框上发生的更改事件。因此，如果进行一项或多项更改，我可以运行并隐藏/取消隐藏相关范围。

我添加复选框的代码如下所示：

```
 ' For each row...

        ' check box in column 17(=Q).
        Dim lCenter As Long
        lCenter = rngCurrent.Width / 4 ' not actual centre but close enough
        With ActiveSheet.CheckBoxes.Add(rngCurrent.Left + lCenter, rngCurrent.Top - 2, rngCurrent.Width, rngCurrent.Height)
            .Interior.ColorIndex = xlNone
            .Caption = ""
        End With 
```

**那么如何将复选框中的更改与子/功能联系起来呢？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T17:01:05.033

将 Checkboxes 对象的 OnAction 属性设置为您希望在选中或取消选中复选框时运行的子程序的名称。

```
Sub MakeCB()

    With ActiveSheet.CheckBoxes.Add(ActiveCell.Left + 0, ActiveCell.Top - 2, ActiveCell.Width, ActiveCell.Height)
        .Interior.ColorIndex = xlNone
        .Caption = ""
        .OnAction = "CheckboxChange"
    End With

End Sub

Sub CheckboxChange()

    MsgBox "change"

End Sub
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:04:09.220

我认为 Excel.Checkbox 控件没有可用的任何事件。请尝试改用 MSForms 复选框。您需要参考“Microsoft Forms 2.0 Object Library”——它不可再分发，但如果您使用的是 VBA，那就没问题了。

然后你可以做这样的事情，并以通常的方式处理事件：

```
''class level
Private WithEvents m_Checkbox as MSForms.CheckBox

Public Sub MakeCheckbox()
    Set m_Checkbox = Activesheet.OLEObjects.Add("Forms.Checkbox.1")
End Sub

Private Sub m_Checkbox_Click()
    ''Do stuff
End Sub 
```

显然，您只能以这种方式处理一定数量的复选框 - 我建议创建一个类来保存每个复选框。

# javascript - 是否可以使用 DOH 测试一系列异步函数调用

> ID：1007166
> 
> 赞同：0
> 
> 时间：2009-06-17T13:51:03.220
> 
> 标签：javascript, testing, dojo, doh

我正在尝试使用[doh.Deferred](http://www.dojotoolkit.org/book/dojo-book-0-9/part-4-meta-dojo/d-o-h-unit-testing)编写一个测试来检查以下事件序列：

1.  使用用户 A 登录（异步）
2.  注销（同步）
3.  使用用户 A 登录（异步）

第二个回调函数的返回值是另一个doh.Deferred 对象。我的印象是 d 的回调链会等待 d2 但它不会。测试在 d2.callback 被调用之前完成。

我在哪里错了？

有谁知道我测试这种行为的更好方法？

```
function test() {
    var d = new doh.Deferred();

    d.addCallback(function() {  
        Comm.logout(); /* synchronus */
        try {   
            // check with doh.t and doh.is
            return true;
        } catch (e) {
            d.errback(e);
        }
    });

    d.addCallback(function() {
        var d2 = new dojo.Deferred();
        /* asynchronus - third parameter is a callback */
        Comm.login('alex', 'asdf', function(result, msg) {
                try {
                    // check with doh.t and doh.is
                    d2.callback(true);
                } catch (e) {
                    d2.errback(e);
                }                   
            });
        return d2; // returning doh.Defferred -- expect d to wait for d2.callback
    });     

    /* asynchronus - third parameter is a callback */
    Comm.login('larry', '123', function (result, msg) {
        try {
            // check with doh.t and doh.is 
            d.callback(true);
        } catch (e) {
            d.errback(e);
        }
    }); 

    return d;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T15:31:21.147

这行得通。d2 的范围是问题所在。

```
function test() {
    var d = new doh.Deferred();
    var d2 = new doh.Deferred();

    d.addCallback(function() {  
        Comm.logout(); /* synchronus */
        try {   
                // check with doh.t and doh.is
                return true;
        } catch (e) {
                d.errback(e);
        }
    });

    d.addCallback(function() {
        /* asynchronus - third parameter is a callback */
        Comm.login('alex', 'asdf', function(result, msg) {
                        try {
                                // check with doh.t and doh.is
                                d2.callback(true);
                        } catch (e) {
                                d2.errback(e);
                        }                                       
                });
        return d2; // returning doh.Deferred -- waits for d2.callback
    });         

    /* asynchronus - third parameter is a callback */
    Comm.login('larry', '123', function (result, msg) {
        try {
                // check with doh.t and doh.is 
                d.callback(true);
        } catch (e) {
                d.errback(e);
        }
    }); 

    return d;
} 
```

# java - 在不同情况下使用不同的 Hibernate 用户类型

> ID：1007176
> 
> 赞同：6
> 
> 时间：2009-06-17T13:52:41.127
> 
> 标签：java, hibernate, jpa, annotations, hsqldb

我使用 Hibernate + JPA 作为我的 ORM 解决方案。

我使用 HSQL 进行单元测试，使用 PostgreSQL 作为真正的数据库。

我希望能够在 Hibernate 中使用 Postgres 的本机[UUID](http://www.postgresql.org/docs/8.3/static/datatype-uuid.html)类型，并在其字符串表示中使用 UUID 和 HSQL 进行单元测试（因为 HSQL 没有 UUID 类型）。

我正在为 Postgres 和 HSQL 单元测试使用具有不同配置的持久性 XML。

这是我如何让 Hibernate “看到”我的自定义 UserType：

```
@Id
@Column(name="UUID", length=36)
@org.hibernate.annotations.Type(type="com.xxx.UUIDStringType")
public UUID getUUID() {
    return uuid;
}

public void setUUID(UUID uuid) {
    this.uuid = uuid;
} 
```

这很好用。但我需要的是能够将注释的“com.xxx.UUIDStringType”部分换出 XML 或属性文件，无需重新编译即可更改。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-07-21T06:56:45.453

嗨，对于那些在 Hibernate 4 中寻求解决方案的人（因为 Dialect#addTypeOverride 方法不再可用），我找到了一个，基于[这个 Steve Ebersole 的评论](https://hibernate.atlassian.net/browse/HHH-9574?focusedCommentId=65721&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-65721)

您必须构建一个像这样的自定义用户类型：

```
public class UUIDStringCustomType extends AbstractSingleColumnStandardBasicType {

    public UUIDStringCustomType() {
        super(VarcharTypeDescriptor.INSTANCE, UUIDTypeDescriptor.INSTANCE);
    }

    @Override
    public String getName() {
        return "pg-uuid";
    }

} 
```

要将其绑定到 HSQLDB 方言，您必须构建一个自定义方言来覆盖 Dialect#contributeTypes 方法，如下所示：

```
public class CustomHsqlDialect extends HSQLDialect {

    @Override
    public void contributeTypes(TypeContributions typeContributions, ServiceRegistry serviceRegistry) {
        super.contributeTypes(typeContributions,serviceRegistry);
        typeContributions.contributeType(new UUIDStringCustomType());
    }

} 
```

然后您可以将 @Type(type="pg-uuid") 与两个数据库一起使用。

希望它会帮助某人...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-02T04:18:30.153

这个问题真的很老，已经回答了很长时间，但我最近发现自己处于同样的情况并找到了一个很好的解决方案。对于初学者，我发现 Hibernate 具有三种不同的内置 UUID 类型实现：

1.  `binary-uuid`: 将 UUID 存储为二进制
2.  `uuid-char`: 将 UUID 存储为字符序列
3.  `pg-uuid`: 使用原生 Postgres UUID 类型

这些类型是默认注册的，可以通过`@Type`注释为给定字段指定，例如

```
@Column
@Type(type = "pg-uuid")
private UUID myUuidField; 
```

还有一种机制可以*覆盖*`Dialect`. 因此，如果最终部署是与 Postgres 数据库通信，但单元测试使用 HSQL，则可以`pg-uuid`通过编写自定义方言来覆盖读取/写入字符数据的类型，如下所示：

```
public class CustomHSQLDialect extends HSQLDialect {

    public CustomHSQLDialect() {
        super();

        // overrides the default implementation of "pg-uuid" to replace it
        // with varchar-based storage.
        addTypeOverride(new UUIDCharType() {
            @Override
            public String getName() {
                return "pg-uuid";
            }
        });
    }
} 
```

现在只需插入自定义方言，该`pg-uuid`类型在两种环境中都可用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-27T12:12:08.117

为了避免 UUID 类型之间的问题而不指定`@Type`注释（这基本上意味着当你想从 postgres 更改为 mysql 或其他方式时，你必须调整所有注释......）我正在使用`package-info.java`带有 hibernates`@TypeDef`注释的那个包裹。

这是您的应用程序的示例设置：
假设`module/src/main/java/app.package.domain`包含您的实体。你的测试存储在`module/src/test/java/app.package`.

只需`package-info.java`在您的`domain`包中创建两个。

> 确保 package-info 文件始终在同一个包中（用于测试和生产）。请参见下面的示例：

```
src/main/java
  app
    package
      domain
        package-info.java 

src/test/java
  app
    package
      domain
        package-info.java 
```

您制作的内容`package-info.java`应如下所示（Postgres）：

```
@TypeDef(
  name = "pg-uuid",
  defaultForType = UUID.class,
  typeClass = PostgresUUIDType.class
)
package app.package.domain;

import org.hibernate.annotations.TypeDef;
import org.hibernate.type.PostgresUUIDType;

import java.util.UUID; 
```

这就是您测试“配置”的方式（H2）：

```
@TypeDef(
  name = "uuid-char",
  defaultForType = UUID.class,
  typeClass = UUIDCharType.class
)
package app.package.domain;

import org.hibernate.annotations.TypeDef;
import org.hibernate.type.UUIDCharType;

import java.util.UUID; 
```

希望能帮助到你

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T14:11:54.443

也许您可以在您的用户类型中构建一些智能，以根据数据库功能做正确的事情。Hibernate 本身使用其“本机”ID 生成器采用类似的方法，根据您使用的数据库类型，它的行为会有所不同。像这样的方法消除了在运行时切换映射的需要。

例如，您可以为每个数据库创建一个[策略类。](http://en.wikipedia.org/wiki/Strategy_pattern)然后在您的用户类型类中，检测您第一次被调用时连接到的数据库，为该数据库实例化正确的策略，然后将所有调用委托给策略对象。

# iphone - 应用程序在 iPhone 上崩溃

> ID：1007178
> 
> 赞同：0
> 
> 时间：2009-06-17T13:52:54.323
> 
> 标签：iphone

我正在开发一个游戏，我必须在手指滑动时加载图像。为此，我在加载视图本身时加载了所有大小 (788x525) 的图像 22。然后在手指滑动时，我只是在视图中添加了图像。

这在 iTouch 上运行良好，但在显示近 12 张图像后 iPhone 游戏崩溃。

这就是我添加图像的方式，graphicsArray 是 NSMUTableArray。

```
for ( int i=0; i<=totalNoofPages;i++){
    NSString * graphicsFileName = @"Page";
    graphicsFileName =
                [graphicsFileName
                 stringByAppendingString:[NSString stringWithFormat:@"%d", i]];
    UIImage *image =
               [[UIImage alloc] initWithContentsOfFile:
               [[NSBundle mainBundle] pathForResource:graphicsFileName
                                      ofType:@"jpg"]];
    GraphicsImages =
               [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 480,320 )];
    GraphicsImages.image = image;
    [image release];
    [GraphicsImages setCenter:center];

    GraphicsImages.transform = CGAffineTransformMakeRotation(M_PI/2);
    [graphicsArray insertObject:GraphicsImages atIndex:i];
} 
```

在我写的手指滑动时，pageNo 是将显示的页数。

```
GraphicsImages = [graphicsArray objectAtIndex:pageNo];
[self addSubview:GraphicsImages]; 
```

有什么方法可以从子视图中释放先前加载的图像，因为它可能会保留在堆栈上，还是由于图像尺寸大？？？？

请在这种情况下帮助我。

提前致谢。

问候，维沙尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T14:07:04.623

你是否因为内存不足而崩溃？

您可以尝试仅预加载上一个、当前和下一个图像，并尽快发布它们。在内存中加载 22 张图像会占用大量空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:09:26.430

您能否提供应用程序崩溃时遇到的错误？知道触发了什么异常将有助于弄清楚到底发生了什么。

我可以告诉你，你没有`GraphicsImages`在循环中释放变量`for`，所以这会导致内存泄漏。但是，我想这还不足以导致崩溃。无论如何，请执行以下操作：

```
[ graphicsArray insertObject:GraphicsImages ];
[ GraphicsImages release ]; 
```

请注意，您不需要在您的案例中指定插入索引，因为这些项目将按顺序添加。此外，当您将对象插入数组时，它是`retained`，因此您可以在之后安全地释放它。

# forum - Milw0rm/Packetstorm 新闻机器人

> ID：1007182
> 
> 赞同：0
> 
> 时间：2009-06-17T13:53:46.570
> 
> 标签：forum, bots

我正在创建一个安全论坛，所以我想知道是否有一些论坛机器人可以从 milw0rm 和 packetstorm 获取最新帖子并将它们发布到论坛中？我的一位朋友告诉我，有这样的东西，但经过一些谷歌搜索后，我无法找到它。你能帮助我吗 ？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T13:58:51.457

我会在抓取时使用[XPath](http://www.w3.org/TR/xpath)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T13:58:52.550

如果您描述的站点提供某种形式的 RSS，您可以使用网络上免费提供的 RSS 阅读器将帖子添加到您的论坛。

# c# - 如何标记要删除的文件夹C#

> ID：1007184
> 
> 赞同：7
> 
> 时间：2009-06-17T13:54:45.820
> 
> 标签：c#, windows

当系统重新启动时，我将如何使用 C# 将一个文件夹标记为删除。

谢谢，

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-17T14:03:00.247

最初是从：

[http://abhi.dcmembers.com/blog/2009/03/24/mark-file-for-deletion-on-reboot/](http://abhi.dcmembers.com/blog/2009/03/24/mark-file-for-deletion-on-reboot/)

文档：

[https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-movefileexa#parameters](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-movefileexa#parameters)

```
///
/// Consts defined in WINBASE.H
///
[Flags]
internal enum MoveFileFlags
{
    MOVEFILE_REPLACE_EXISTING = 1,
    MOVEFILE_COPY_ALLOWED = 2,
    MOVEFILE_DELAY_UNTIL_REBOOT = 4, //This value can be used only if the process is in the context of a user who belongs to the administrators group or the LocalSystem account
    MOVEFILE_WRITE_THROUGH  = 8
}

/// <summary>
/// Marks the file for deletion during next system reboot
/// </summary>
/// <param name="lpExistingFileName">The current name of the file or directory on the local computer.</param>
/// <param name="lpNewFileName">The new name of the file or directory on the local computer.</param>
/// <param name="dwFlags">MoveFileFlags</param>
/// <returns>bool</returns>
/// <remarks>http://msdn.microsoft.com/en-us/library/aa365240(VS.85).aspx</remarks>
[System.Runtime.InteropServices.DllImportAttribute("kernel32.dll",EntryPoint="MoveFileEx")]
internal static extern bool MoveFileEx(string lpExistingFileName, string lpNewFileName,
MoveFileFlags dwFlags);

//Usage for marking the file to delete on reboot
MoveFileEx(fileToDelete, null, MoveFileFlags.MOVEFILE_DELAY_UNTIL_REBOOT); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T14:05:00.073

使用 PInvoke 并调用 MoveFileEx，将 null 作为目标传入....

[此链接](http://www.eggheadcafe.com/conversation.aspx?messageid=31656648&threadid=31656596)有一些示例代码：

```
[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
public static extern bool MoveFileEx(string lpExistingFileName, string lpNewFileName, int dwFlags);

public const int MOVEFILE_DELAY_UNTIL_REBOOT = 0x4;

MoveFileEx(filename, null, MOVEFILE_DELAY_UNTIL_REBOOT); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:14:30.413

引自[http://abhi.dcmembers.com/blog/2009/03/24/mark-file-for-deletion-on-reboot/](http://abhi.dcmembers.com/blog/2009/03/24/mark-file-for-deletion-on-reboot/)：

```
///
/// Consts defined in WINBASE.H
///
internal enum MoveFileFlags
{
    MOVEFILE_REPLACE_EXISTING = 1,
    MOVEFILE_COPY_ALLOWED = 2,
    MOVEFILE_DELAY_UNTIL_REBOOT = 4,
    MOVEFILE_WRITE_THROUGH  = 8
}

/// <summary>
/// Marks the file for deletion during next system reboot
/// </summary>
/// <param name="lpExistingFileName">The current name of the file or directory on the     local computer.</param>
/// <param name="lpNewFileName">The new name of the file or directory on the local   computer.</param>
/// <param name="dwFlags">MoveFileFlags</param>
/// <returns>bool</returns>
/// <remarks>http://msdn.microsoft.com/en-us/library/aa365240(VS.85).aspx</remarks>
[System.Runtime.InteropServices.DllImportAttribute("kernel32.dll",EntryPoint="MoveFileEx")]
internal static extern bool MoveFileEx(string lpExistingFileName, string lpNewFileName,
MoveFileFlags dwFlags);

//Usage for marking the file to delete on reboot
MoveFileEx(fileToDelete, null, MoveFileFlags.MOVEFILE_DELAY_UNTIL_REBOOT); 
```

编辑：殴打

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-16T22:50:01.533

问题是使用 MOVEFILE_DELAY_UNTIL_REBOOT 和 MoveFileEx 只会删除空文件夹。 [参考文档。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365240%28v=vs.85%29.aspx)

我的解决方案如下：使用 MoveFileEx 和 MOVEFILE_DELAY_UNTIL_REBOOT “删除”目录中的每个文件，然后以相同的方式“删除”目录。

```
public class Cleanuper
{
    private void PendingDeleteDirectory(string directoryPath)
    {
        foreach (string directory in Directory.GetDirectories(directoryPath, "*", SearchOption.TopDirectoryOnly))
        {
            PendingDeleteDirectory(directory);
        }

        foreach (string file in Directory.GetFiles(directoryPath, "*", SearchOption.TopDirectoryOnly))
        {
            NativeMethods.MoveFileEx(file, null, MoveFileFlags.DelayUntilReboot);
        }
        NativeMethods.MoveFileEx(directoryPath, null, MoveFileFlags.DelayUntilReboot);
    }
}

public static class NativeMethods
{
    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
    internal static extern bool MoveFileEx(string lpExistingFileName, string lpNewFileName, MoveFileFlags dwFlags);
}

[Flags]
public enum MoveFileFlags
{
    DelayUntilReboot = 0x00000004
} 
```

# python - 如何从活动窗口中检索选定的文本

> ID：1007185
> 
> 赞同：15
> 
> 时间：2009-06-17T13:54:58.423
> 
> 标签：python, windows, winapi, pywin32

**我正在尝试使用Python**为 Windows 创建一个简单的开源实用程序，该实用程序可以对当前活动窗口的选定文本执行用户定义的操作。该实用程序应使用预定义的键盘快捷键激活。

以下示例中部分概述了用法：

1.  用户使用鼠标或键盘（在任何应用程序窗口中）选择一些文本
2.  用户按下预定义的键盘快捷键
3.  所选文本由我们的实用程序检索或复制到剪贴板（两种方法都应该没问题）
4.  对选定文本执行与键盘快捷键相关的操作

令我困惑的是**第 3 步**。*如何从活动窗口中检索选定的文本*。这应该适用于所有应用程序。

我使用**pywin32**模块。

提前感谢您的回答和提示。

**更新#1**：

事实证明，有两种方法可以完成任务：

1.  找到活动窗口，然后向其发送消息/击键 (Ctrl-C)，以便将所选文本复制到剪贴板。然后，该实用程序可以通过使用剪贴板相关功能访问文本来处理文本。
2.  找到活动窗口，然后直接检索所选文本（无需将其复制到剪贴板）。这似乎比第一种方法更困难。

作为起点：

[正如 Anurag Uniyal 在他的回复](https://stackoverflow.com/questions/1007185/how-to-retrieve-the-selected-text-from-the-active-window/1007553#1007553)中指出的那样，获取活动窗口 ID 。

或者使用以下代码获取窗口对象：

```
import win32ui
wnd = win32ui.GetForegroundWindow()
print wnd.GetWindowText() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-09-23T23:40:01.163

下面的代码仅适用于简单的文本框（刚刚在 VB6 中完成，并移植到 python）

编辑：**仅在 python 2.6 上测试过**

```
from ctypes import *
import win32gui
import win32api
import win32con

user32 = windll.user32
kernel32 = windll.kernel32

class RECT(Structure):
 _fields_ = [
     ("left", c_ulong),
     ("top", c_ulong),
     ("right", c_ulong),
     ("bottom", c_ulong)
 ]

class GUITHREADINFO(Structure):
 _fields_ = [
     ("cbSize", c_ulong),
     ("flags", c_ulong),
     ("hwndActive", c_ulong),
     ("hwndFocus", c_ulong),
     ("hwndCapture", c_ulong),
     ("hwndMenuOwner", c_ulong),
     ("hwndMoveSize", c_ulong),
     ("hwndCaret", c_ulong),
     ("rcCaret", RECT)
 ]

def get_selected_text_from_front_window(): # As String
    ''' vb6 to python translation '''

    gui = GUITHREADINFO(cbSize=sizeof(GUITHREADINFO))
    txt=''
    ast_Clipboard_Obj=None
    Last_Clipboard_Temp = -1

    user32.GetGUIThreadInfo(0, byref(gui))

    txt = GetCaretWindowText(gui.hwndCaret, True)

    '''
    if Txt = "" Then
        LastClipboardClip = ""
        Last_Clipboard_Obj = GetClipboard
        Last_Clipboard_Temp = LastClipboardFormat
        SendKeys "^(c)"
        GetClipboard
        Txt = LastClipboardClip
        if LastClipboardClip <> "" Then Txt = LastClipboardClip
        RestoreClipboard Last_Clipboard_Obj, Last_Clipboard_Temp
        print "clbrd: " + Txt
    End If
    '''    
    return txt

def GetCaretWindowText(hWndCaret, Selected = False): # As String

    startpos =0
    endpos =0

    txt = ""

    if hWndCaret:

        buf_size = 1 + win32gui.SendMessage(hWndCaret, win32con.WM_GETTEXTLENGTH, 0, 0)
        if buf_size:
            buffer = win32gui.PyMakeBuffer(buf_size)
            win32gui.SendMessage(hWndCaret, win32con.WM_GETTEXT, buf_size, buffer)
            txt = buffer[:buf_size]

        if Selected and buf_size:
            selinfo  = win32gui.SendMessage(hWndCaret, win32con.EM_GETSEL, 0, 0)
            endpos   = win32api.HIWORD(selinfo)
            startpos = win32api.LOWORD(selinfo)
            return txt[startpos: endpos]

    return txt

if __name__ == '__main__':
    print get_selected_text_from_front_window() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:52:30.647

这不是微不足道的，但这是起点

```
import win32gui
hwnd = win32gui.GetForegroundWindow()
print win32gui.GetWindowText(hwnd) 
```

也许您将不得不使用`FindWindow`,`FindWindowEx`来获得焦点的子窗口

编辑：还在试验中使用 spy++ 来查看它如何检索有关各种窗口的信息，请参阅 hwnd、窗口类等

基本上，如果您可以在 C/C++/C# 中找到一个示例，那么将其转换为 pywin32 等价物并不难，所以在某种程度上它是 win32 api 特定问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T20:58:12.357

你最好使用 Ctrl-C 方法。直接获取文本将适用于编辑控件之类的东西，但对于检索应用程序直接在其自己的窗口上绘制的文本是无用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-05T01:14:44.920

看起来，虽然剪贴板和相关的复制和粘贴快捷方式无处不在，但开发人员必须将它们添加到应用程序中。最好的办法是使用监听器来捕获`ctrl`+`c`被激活的时间，检查剪贴板是否没有被使用并且上面有数据，然后从那里操作数据。
你可以在这里查看微软的开发页面：

[https://docs.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard#implementing-the-cut-copy-and-paste-commands](https://docs.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard#implementing-the-cut-copy-and-paste-commands)

# ruby-on-rails - rake db:migrate 到底是做什么的？

> ID：1007187
> 
> 赞同：25
> 
> 时间：2009-06-17T13:55:16.880
> 
> 标签：ruby-on-rails, migration, rake

rake db:migrate 只添加新的迁移，还是放弃所有迁移/更改并构建新的所有内容？

我认为 rake 正在引发错误，因为它试图访问在迁移 042 中删除的迁移 040 中的表属性。不知何故，我的数据库和 rake 不同步，我想修复它们。

对于你们那里的专家 - rake 与迁移不同步是否常见？我怎样才能避免这种情况（不，我不手动编辑我的架构或 rake 文件）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-17T15:17:44.107

当您使用 rails 迁移时，`schema_migrations`会自动创建一个名为的表，该表通过存储每个迁移的版本号（这是文件名中迁移名称前面的数字，即 db/migrate /_20090617111204__migration.rb)。当您运行`rake db:migrate`向上迁移时，只会运行以前没有运行过的迁移（即它们的版本不包含在表中）（因此，更改已执行的迁移在运行时将不起作用`db:migrate`）。向下迁移时，在其中找到的所有`schema_migrations`大于您要回滚到的版本的版本都将被撤消。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-17T14:00:45.573

每次您使用脚本（如脚本/生成模型...）创建迁移时，都会将新迁移添加到正确的目录中，以便与真实数据库同步。

实际上 rake db:migrate 只是检查哪些丢失的迁移仍然需要应用于数据库，而不关心之前的迁移。

当然，如果您使用其他方式修改数据库通常会获得不同步的东西，因为正如您所说，您会发现自己将迁移应用于下面更改的内容。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-04-05T07:31:55.170

迁移意味着您从当前版本移动到更新版本（如第一个答案中所述）。使用 rake db:migrate 您可以将任何新更改应用于您的架构。但是，如果您想回滚到以前的迁移，您可以使用 rake db:rollback 来取消您的新更改（如果它们定义不正确）。注意：这样做您的数据将会丢失。

# c++ - RtlValidateHeap 问题

> ID：1007188
> 
> 赞同：3
> 
> 时间：2009-06-17T13:55:23.057
> 
> 标签：c++, dll

我有一个 Windows DLL，它在某一时刻返回一个指向在 DLL 代码中新建的类的指针。该类本身是一个非常薄的包装器，它围绕着另一个对 DLL 私有的类。

调用可执行文件使用此类没有问题，一切正常，除了调用可执行文件尝试删除此类时，我收到 RtlValidateHeap 错误。

错误背后的原因是有道理的，exe 试图释放 DLL 堆上的内存，这通常是一件坏事。

我想出了一些可能的解决方案：

*   覆盖类的 new 运算符以从可执行文件的堆中分配其内存（假设我什至可以获取该堆空间）。包装器非常薄，所以我只会从 exe 的堆中分配几个字节。
*   为这个类提供一个特殊的破坏函数（yuck）。
*   告诉用户不要破坏类并忍受泄漏（不可能！）

有这样做的“正常”方式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:05:33.177

我已经看到这种行为是当其中一个二进制文件使用调试选项构建时（它使用调试堆，除其他外，使用 RtlValidateHeap）而另一个二进制文件构建为发布二进制文件。可能值得检查您是否只使用 like 和 like ...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T14:08:16.807

大多数使用这种功能的库，无论是 C 还是 C++，实际上都使用您的第二个选项 - 获取和释放对象的特定函数。它允许分发不必与调用可执行文件相同编译的二进制 DLL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T14:29:47.667

到目前为止，最简单的解决方案是（对于 Visual Studio 用户）在任何地方使用 /MD 或 /MDd。如果 CRT 本身在 DLL 中，则只有一个堆。您的应用程序和您的 DLL 将共享它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T15:09:23.843

在 DLL 方面，我会使用以下内容：

```
dll.h:  /* all exported, included by dll user */
class dll_class {
  public:
    virtual void foo() = 0;
}
dll_class* create_class();
void delete_class(dll_class*);

dll.cpp: /* implement the creator and destroyer */
dll_class* create_class() { return new dll_class_imp(); }
void delete_class(dll_class* pClass) { delete pClass; }

dll_imp.h: /* implement the actual dll_class logic */
class dll_class_imp : public dll_class {
  public:
    virtual void foo() {...}
} 
```

现在，在 DLL 用户端，将包含 dll.h，并像这样使用：

```
dll_class* pClass = create_class();
pClass->foo();
delete_class(pClass); 
```

这样，DLL 的部分和用户的部分之间就有了明显的区别。作为一个抽象类，用户不能使用 new 创建一个 dll_class；并且只有以类似于创建对象的方式删除对象才有意义，即使用导出的函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T14:16:08.257

您是在运行时动态加载 DLL（通过调用 LoadLibrary），还是在 exe 的链接阶段链接到使用 .lib 文件？如果您正在动态加载/卸载 DLL，那么当删除发生时，DLL 是否仍然加载？这是插件类型设计的经典问题，典型的解决方案类似于您的第二个建议 - 用于创建和删除相关对象的特定功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T14:22:25.780

选项 2 很正常，例如，一个 Release() 方法只是执行“删除这个”。

请注意，通常 DLL 没有它自己的堆 - 大多数 DLL 将共享进程堆（请参阅 GetProcessHeap），但语言运行时通常会在分配的内存周围装饰或添加填充 - 所以你的 dll 最终的指针是与堆在调用 free 时所期望的指针不同。

一般规则是始终从同一模块中释放分配的内存与匹配的空闲函数。

不过也有一些例外——你知道的内存是直接用 HeapAlloc 从已知堆中分配的，可以从另一个模块中释放出来。GlobalAlloc/GlobalFree 跨模块工作。使用 SysAllocString 分配的字符串可以从另一个模块中释放。您知道已由运行时的同一 DLL 版本分配的内存可以从另一个模块中释放，但我会远离这个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T19:09:07.800

看起来对我们有用的是覆盖问题类的 new 和 delete 运算符。原来有3种情况可能发生：

*   EXE new的对象，EXE删除的对象
*   DLL new 的对象，DLL delete 的对象
*   DLL new 的对象，EXE 删除的对象

new 和 delete 运算符确保 DLL 将分配和释放所有内存分配。到目前为止，一切都很好 - 测试表明操作符一直在被使用，并且内存来自 DLL 的堆。

# iphone - Objective-C Sprite 类 (iPhone SDK)

> ID：1007189
> 
> 赞同：1
> 
> 时间：2009-06-17T13:55:25.023
> 
> 标签：iphone, objective-c, sprite

好的，对于初学者来说，我对 Objective-C 非常陌生，（通常是 C）。我对编程并不陌生，到目前为止，我发现过渡是无缝的，直到现在。我正在尝试实现我在网上找到的 Sprite 类，以便在 iPhone 上开发游戏，但我遇到了很多错误。例如...

```
size = CGSizeMake([image size].width , [image size].height); 
```

其中 size 是一个合成的 CGSize 对象，而 image 是一个合成的 UIImage 对象。它们都在 Sprite.h 文件中声明。我得到的错误是“此分配中的类型不兼容”。任何帮助将不胜感激。我觉得错误似乎很简单，例如#include 或其他东西，因为每个错误都与 CoreGraphics 函数（CGRectMake、CGSizeMake、CGRectIntersectRect 等）有关。我不知道我是否应该在这里发布整个课程，但如果有要求我会很高兴。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T14:02:26.707

当您说“size”是 CGSize *object*时，我认为您有误解。CGSize 是一个常规的 C 结构，CGSizeMake 返回一个“CGSize”而不是“CGSize *”。我的猜测是“size”被声明为“CGSize *”，因为你认为它是一个对象。尝试删除 *.

# javascript - 想要在 Javascript 中触发 Dropdown SelectedIndexChanged 事件

> ID：1007190
> 
> 赞同：5
> 
> 时间：2009-06-17T13:55:27.313
> 
> 标签：javascript, html, asp.net, dom-events

我的页面上有下拉列表，我正在使用 Javascript 从弹出窗口更改下拉列表的选定值。我在下拉事件中有一些逻辑，所以当下拉选择从 Javascript 更改时`SelectedIndexChanged`我需要触发事件。`SelectedIndexChanged`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-18T11:52:32.727

```
document.getElementById('<%= yourDropdown.ClientID %>').onchange(); 
```

这应该可以，如果您仍然遇到一些错误，您可以尝试这样：

```
setTimeout('__doPostBack(\'yourcontrolClientSideID\',\'\')', 0); 
```

`yourcontrolClientSideID`是 Rendered Client ID 的 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-21T08:01:20.263

这是一个工作示例：

```
function fireEvent(element,event){
if(document.createEvent){
 // dispatch for firefox + others
var evt = document.createEvent(”HTMLEvents”);
evt.initEvent(event, true, true ); // event type,bubbling,cancelable
return !element.dispatchEvent(evt);
}
else{
// dispatch for IE
var evt = document.createEventObject();
return element.fireEvent(’on’+event,evt)
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:00:40.707

在客户端调用 onchange 方法：

```
document.getElementById('yourDropdownsClientId').onchange(); 
```

**编辑：**如果您将下拉列表的 AutoPostBack 属性设置为 true，则上面的代码会将您的页面发布到服务器，而不是调用您的服务器端事件。

但是如果你想手动调用你的事件，你可以在页面的代码隐藏中的任何地方都这样：

```
myDropDownList_SelectedIndexChanged(null, new EventArgs()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:04:25.113

是的...我认为 Canavar 所说的会起作用，但它必须看起来像这样

```
document.getElementById('<%=yourDropdown.ClientId%>').onchange(); 
```

# asp.net - ASP.NET 网站攻击：如何应对？

> ID：1007191
> 
> 赞同：6
> 
> 时间：2009-06-17T13:55:31.573
> 
> 标签：asp.net, security

这是我第一次遇到有人试图侵入我创建的网站。我能做些什么来阻止这些尝试？

附带说明一下，他们的 sql 注入永远不可能工作，并且我们拥有的任何数据都没有被正常使用此站点的任何人提供。

附加：

我认为大多数 XSS 和 sql 注入都涵盖了代码部分，但我肯定在考虑进行安全审计。我只是对回应感到好奇。我真的只限于阻止 IP 地址吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T13:59:19.180

如果您已经受到 SQL 注入的保护，那么您就可以应对重大攻击。下一个最大的威胁（在我看来）是跨站点脚本（XSS），因为它允许攻击者让另一个用户做一些恶意的事情，从而难以跟踪该活动。

您还应该注意跨站点请求伪造 (CSRF)，因为这是许多人似乎经常错过的一个。

我将查看[OWASP 的 10 大 Web 安全漏洞](http://www.owasp.org/index.php/Top_10_2007)，并确保您尽可能地防范所有 10 个漏洞。如果您不小心，其中任何一个都可能严重地向攻击者敞开心扉。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T13:58:23.377

除非这是您的第一个公共网站，否则您工作过的所有网站在大约 3 分钟后都受到攻击，无论您是否知道，都可以访问。

您可以开始做的几件事是：

1.  开始阻止攻击来自的 IP。这并不总是可行的，因为 IP 地址经常更改，并且某些类型的攻击可以使用欺骗性地址。

2.  安装[入侵检测系统 (IDS)](http://www.snort.org/)并开始监控一切。

3.  验证您的防火墙是否正常工作并监控攻击媒介。确保他们所追求的一切都得到了很好的保护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T14:06:55.000

这个答案来自另一个我回答的关于 IIS 被黑的问题：

> 希望您已经打开了 IIS 日志文件，并希望黑客没有删除它们。默认情况下，它们位于：c:\winnt\system32\LogFiles\W3SVC1 并且通常以日期命名。
> 
> 然后弄清楚如何使用免费的日志解析器（来自 Microsoft）可能会有所帮助。然后[使用本指南](http://www.securityfocus.com/infocus/1712)帮助您以取证方式查看您的日志文件。您是否有防火墙，因为它的系统日志可能会有所帮助。
> 
> 另一个可以帮助您找到 sql 注入问题的不错的工具是到 [这里](http://www.communities.hp.com/securitysoftware/blogs/spilabs/archive/2008/06/24/finding-sql-injection-with-scrawlr.aspx)下载 HP 的 Scrawlr。
> 
> 如果您对所发现的内容有任何疑问，请回来询问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T13:57:25.110

是很多来源还是只有几个 IP？我们有一些 IP 做了一些隐蔽的事情，并使用 IIS 专门阻止它们。如果这是来自多个来源的协同攻击，这将无济于事。

# java - 在 java 中，commons-Digester 如何处理输入的 XML 文件？

> ID：1007192
> 
> 赞同：1
> 
> 时间：2009-06-17T13:55:41.650
> 
> 标签：java, xml, apache-commons-digester

我是 Java 新手，我在一个 Java 项目中遇到了一个声明：

```
Digester digester = DigesterLoader.createDigester(getClass()
                .getClassLoader().getResource("rules.xml")); 
```

rules.xml 文件包含各种模式，每个模式都有不同的属性，如类名、方法名和其他一些属性。

我用谷歌搜索了消化器，但找不到任何有用的东西可以帮助我完成上述陈述。谁能告诉我执行上述语句的步骤是什么？事实上，这种 XML 东西的优势是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:56:45.413

swapnil，作为我在 Struts 时代的 Digester 用户，老实说，学习/调试很棘手。这是一个很难熟悉的库，本质上您正在为某些元素设置事件处理程序，有点像 SAX 解析器（实际上它在幕后使用 SAX）。因此，您为规则引擎提供一些您感兴趣的节点的 XPath，并设置将实例化的规则，并使用它在 XML 文件中找到的数据设置一些 POJO 的属性。

好主意，一旦你习惯了它就很好，但是如果你有一个用于输入 xml 文件的 xsd，我会尽快推荐你使用 JAXB。

Digester 的一个优点是它只会对你感兴趣的元素做一些事情，所以内存占用最终会很好而且很低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:23:14.263

[这是在此处](http://commons.apache.org/digester/commons-digester-1.6/docs/api/org/apache/commons/digester/xmlrules/DigesterLoader.html#createDigester(java.net.URL))调用的方法。xml 在 Java 中通常用于配置，因为 xml 文件不需要编译。在 java 文件中具有相同的配置意味着您必须编译该文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:25:22.840

我假设您了解如何使用类加载器加载规则文件？它基本上与类本身在同一个包中查找，并创建一个`URL`提供文件绝对位置的包。

至于 Digester，我没有使用过它，但快速阅读一下（[http://commons.apache.org/digester/](http://commons.apache.org/digester/)）应该可以解释一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T15:15:30.057

他们在我的最后一次演出中使用了它，我只记得它非常慢。

# wpf - 在 WPF 应用程序中使用 XAML 矢量图形

> ID：1007199
> 
> 赞同：16
> 
> 时间：2009-06-17T13:57:58.120
> 
> 标签：wpf, xaml, vector-graphics

我有一个在 XAML 中定义的矢量图像。在 WPF 应用程序中使用此资源的正确方法是什么？

我想将矢量图像放在它自己的 XAML 文件中，然后将图像添加到我的应用程序中的其他 UserControls。我的 XAML 矢量图像中的顶级元素应该是什么？如何在其他用户控件中引用该图像？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T14:54:31.063

[http://learnwpf.com/post/2006/06/04/How-do-I-Include-Vector-Based-Image-Resources-in-my-WPF-Application.aspx](http://learnwpf.com/post/2006/06/04/How-do-I-Include-Vector-Based-Image-Resources-in-my-WPF-Application.aspx)解释了如何做到这一点。

```
<ContentControl Template="{StaticResource Credit-Card}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-18T20:08:44.730

在 WPF 和 Silverlight 中以可重用的方式使用矢量图形是极其困难的。

这两个 StackOverflow 问题讨论了一些可用的选项：

[XAML 图标 - 如何使用？](https://stackoverflow.com/questions/4671464/xaml-icons-how-to-use)

[WPF 在WPF中使用SVG文件作为图标的正确方法是什么](https://stackoverflow.com/questions/3526366/wpf-what-is-the-correct-way-of-using-svg-files-as-icons-in-wpf)

在阅读完这些问题和答案后，我认为最好的解决方案是坚持使用像 PNG 这样的位图/光栅格式，直到 Microsoft 决定支持 SVG。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-03T11:41:57.637

以下是如何以可重复使用的样式方式做到这一点：

[https://github.com/alansingfield/VectorIcon/blob/master/README.md](https://github.com/alansingfield/VectorIcon/blob/master/README.md)

```
 <Style x:Key="CarIcon" 
        TargetType="local:VectorIcon">
    <Style.Setters>
      <Setter Property="Geometry">
        <Setter.Value>
          <PathGeometry Figures="M18,18H6V6H18M18,4H6A2,2 0 0,0 4,6V18A2,2 0 0,0 6,20H18A2,2 0 0,0 20,18V6C20,4.89 19.1,4 18,4Z" />
        </Setter.Value>
      </Setter>
    </Style.Setters>
  </Style>

<local:VectorIcon Style="{StaticResource CarIcon}" Foreground="Green"/> 
```

# asp.net - ASP.Net 无法创建/卷影复制

> ID：1007200
> 
> 赞同：41
> 
> 时间：2009-06-17T13:58:03.037
> 
> 标签：asp.net, assemblies, web-config

在开发 ASP.Net 应用程序时，我反复收到此错误：

```
 Cannot create/shadow copy 'XXXXX' when that file already exists 
```

其中 XXXXX 是一个随机 DLL。通常，DLL 是 Microsoft 企业库中的 DLL 之一，但它会有所不同。

这真的很随机​​，而且非常令人沮丧。我会花几个小时没有得到错误，然后每 10-20 分钟得到这个错误。

我见过几种解决方案。比如[这个问题](https://stackoverflow.com/questions/281145/asp-net-hostingenvironment-shadowcopybinassemblies)。我尝试过使用 Clean Solution 选项，并且我也只是重新启动了本地 IIS。但是，它仍然以相同的随机但持续的频率发生。

我还看到很多人提到在配置文件中使用这个选项：

```
<hostingEnvironment shadowCopyBinAssemblies="false" /> 
```

但是，其他人提到它有问题，绝对不应该在生产中使用。

那么，我应该放弃并尝试使用 shadowCopyBinAssemblies 选项吗？（并确保不要将此更改复制到其他环境。）我是唯一经常遇到此问题的人吗？

*注意：*我使用的是 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-06-17T10:40:29.293

等待 10-30 秒，然后点击刷新。出于某种原因，这总是对我有用。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-10-13T04:56:54.663

以下解决方法来自[这个现已失效的连接问题](http://www.connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=227522)：

*   添加`<hostingEnvironment shadowCopyBinAssemblies="false" />`到`<system.web>`web.config 文件的部分。
*   遇到问题时重新启动 Cassini
*   如果出现错误，请停止调试器，右键单击解决方案并“清理解决方案”。按 F5 重新启动调试器。这真的很烦人，因为它对我来说有 >50% 的失败率，而且你会认为*不应该有 CLEAN SOLUTION 的手动选项！*这个 1200 美元的 POS 应用程序应该会自动为您清理！
*   这是另一种可能对某些人更有吸引力的解决方法，由 Gary Farr ( [http://blogs.claritycon.com/blogs/gary_farr/archive/2007/03/09/2888.aspx](http://blogs.claritycon.com/blogs/gary_farr/archive/2007/03/09/2888.aspx) ) 提供。
*   将以下内容添加到您的预构建事件中：

    `IF EXIST $(TargetPath).LOCKED (del $(TargetPath).LOCKED) ELSE (IF EXIST $(TargetPath) (move $(TargetPath) $(TargetPath).LOCKED))`

*   为我完成这项工作的解决方法是使用“构建解决方案”而不是使用“构建”

*   成功构建后，我数到十，然后刷新我的网络表单。
*   我发现通过针对 IIS 重新注册 ASP.NET，问题“消失了”——从那以后我就没有遇到过这个问题。您将需要在命令行上运行以下命令：
    `C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -i`. 这很可能不适用于所有人——这是一个复杂的问题。
*   重启VS。
*   清理解决方案时，发出了一些关于无法删除文件的警告。这些文件具有它们的只读属性集。将这些文件的属性设置为读/写后，问题就解决了。
*   重新启动 IIS

**编辑：从**[旧版本的页面中](http://web.archive.org/web/20101006134513/http://connect.microsoft.com/VisualStudio/feedback/details/227522/cannot-create-shadow-copy-variousfilename-when-that-file-already-exists)检索到的项目（由archive.org 提供）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-14T08:09:57.990

只需重新启动 Visual Studio，这对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T14:48:25.823

打开您的项目属性，打开 Web 选项卡并确保未选中 Enable Edit and Continue 选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-25T07:38:24.367

在我的情况下只`iisreset`工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-21T21:34:51.760

我遇到了同样的问题，通过将此代码放在 <system.web> 部分的 web.config 中，它对我来说效果很好。

```
<hostingEnvironment shadowCopyBinAssemblies="false" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T01:06:39.093

在使用我们创建的导入 DLL 时，我经常遇到这个问题。

尝试停止正在发生失败，甚至引入了不同的问题，但是每当它发生时，我都会做一个重建解决方案，并且该构建的问题会立即消失。

此外，自从使用 Visual Studio 2002 以来，我还没有看到这个问题。2008 没有我知道的这个问题，2005 也没有。你使用的是旧的 VS 吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-06T15:16:45.957

转到设计模式，然后右键单击并在浏览器中点击查看，问题就会消失 Anil Madan

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-12T21:49:08.487

在预构建事件命令行中添加这些行，这基本上可以解锁 Visual Studio 中的 DLL：

```
 IF EXIST $(TargetPath).LOCKED  (del $(TargetPath).LOCKED)
  ELSE (IF EXIST $(TargetPath) (move $(TargetPath) $(TargetPath).LOCKED)) 
```

重新编译不会出现无法复制DLL的错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-13T11:25:25.180

如果您使用实体框架：

**错误消息：** *“当该文件已存在时，无法创建/卷影复制。”*

**解决方案：** *“等待几秒钟，然后刷新页面。”*

有关更多信息，请访问：[MVC 5 Web 应用程序的高级实体框架 6 场景（12 个中的 12 个）](http://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application "用于 MVC 5 Web 应用程序的高级实体框架 6 场景（12 个中的 12 个）")

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-18T05:22:05.837

您只需刷新 (F5) 您的页面。

# .net - 带有 ToolStripStatusLabel 的 UIAutomation

> ID：1007203
> 
> 赞同：1
> 
> 时间：2009-06-17T13:58:30.523
> 
> 标签：.net, windows, winforms, accessibility, ui-automation

我有一个 WinForms 应用程序，我似乎无法`ToolStripStatusLabel`通过 UIAutomation 访问 a 的文本。微软[暗示](http://msdn.microsoft.com/en-us/library/ms744822(VS.85).aspx)对`StatusStrip`s （以及可能其中的项目）的支持是有限的，但这似乎是一个足够基本的用例，它应该可以工作。

该控件显示`ControlType.Edit`在 UISpy 中，并且似乎只是一个只读文本框，但其值始终与其名称相同，而不是其文本。

UISpy中的属性如下：

```
AutomationElement
  General Accessibility
    AccessKey:  ""
    AcceleratorKey: ""
    IsKeyboardFocusable:    "False"
    LabeledBy:  "(null)"
    HelpText:   ""

  State
    IsEnabled:  "True"
    HasKeyboardFocus:   "False"

  Identification
    ClassName:  ""
    ControlType:    "ControlType.Edit"
    Culture:    "(null)"
    AutomationId:   "StatusBar.Pane0"
    LocalizedControlType:   "edit"
    Name:   "My Label"
    ProcessId:  "3972 (*****)"
    RuntimeId:  "42 134002 0"
    IsPassword: "False"
    IsControlElement:   "True"
    IsContentElement:   "True"

  Visibility
    BoundingRectangle:  "(9, 273, 79, 17)"
    ClickablePoint: "48,281"
    IsOffscreen:    "False"

ControlPatterns
  GridItem
    Row:    "0"
    Column: "0"
    RowSpan:    "1"
    ColumnSpan: "1"
    ContainingGrid: ""status bar" "statusStrip""

  Value
    Value:  "My Label"
    IsReadOnly: "True" 
```

基本上，我希望有一些方法可以`myLabel.Text = "something"`通过 UIAutomation 以某种方式获得该价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T03:46:17.173

`AccessibleName`除了`.Text`在`ToolStripStatusLabel`控件上设置属性。它适用于我在类似的场景中使用 White：

`statusLabel.Text = statusLabel.AccessibleName = "New status value";`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T08:51:30.450

我不得不通过使用两个具有不同文本的单独标签并显示和隐藏适当的标签来解决此问题。这对于我的目的来说已经足够了（使用 White 进行测试），但我很惊讶 UIAutomation 没有显示文本值——这基本上意味着屏幕阅读器无法访问 WinForms 应用程序中状态栏中的所有文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-18T03:09:05.187

检索与您描述的标签类似的文本时，我从来没有遇到过问题。事实上，`AutomationId`在我的应用程序中甚至是相同的。`ControlType`显示的事实`ControlType.Edit`具有误导性。例如以下将起作用

```
statusText = (string)automationElement.GetCurrentPropertyValue(ValuePattern.ValueProperty); 
```

使用Find`automationElement`方法对`ControlType.Edit`的`AutomationId`进行定位`"StatusBar.Pane0"`。

# maven-2 - Maven - 添加对工件源的依赖

> ID：1007211
> 
> 赞同：12
> 
> 时间：2009-06-17T14:00:09.677
> 
> 标签：maven-2, dependencies

我有两个 maven 模块，一个以 jar 的形式结束，一个依赖于该 jar 的战争。

我希望 jar 模块将它的源代码与 jar 中的已编译类一起打包，以便第二个模块能够访问它。我曾尝试使用 maven-source-plugin，但我对如何添加对其输出的依赖感到困惑。似乎默认情况下依赖项转到已编译的 jar，而不是 maven-source-plugin 创建的源代码 jar（以“-source.jar”结尾）。

如何将“-source.jar”添加为依赖项，同时仍保留对已编译源的依赖项？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-18T03:24:11.767

我没有尝试过，但我认为您需要在项目中创建两个配置文件。一个构建主罐子。另一个构建源jar。不幸的是，我不确定您将如何构建该配置文件。到目前为止，我找不到一个很好的例子。

（根据评论，您实际上并不需要配置文件。您只需使用将部署源并通过源分类器使它们可用的源插件）

理论上，您将使用第二个配置文件将源附加到项目。这会在您的存储库中为使用该分类器的源创建第二个条目。将源安装/部署到存储库后，您应该能够通过使用依赖项上的分类器标记直接指定源来将源包含为依赖项。

所以你会在你的 webapp POM 中有这样的东西：

```
<dependencies>
  <dependency>
    <groupId>myGroup</groupId>
    <artifactId>myJar</artifactId>
    <version>4.0</version>
    <type>jar</type>
  </dependency>
  <dependency>
    <groupId>myGroup</groupId>
    <artifactId>myJar</artifactId>
    <version>4.0</version>
    <type>jar</type>
    <classifier>sources</classifier>
  </dependency>
</dependencies> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:39:50.803

您是否尝试将 src 目录添加为构建部分中的资源目录？那应该在构建时将源代码复制到 jar 中。

# php - phpeclipse：跳转到函数定义？

> ID：1007213
> 
> 赞同：5
> 
> 时间：2009-06-17T14:00:42.157
> 
> 标签：php, eclipse, function, definition

从zend的IDE我知道`Ctrl`+`left`点击一个函数名会打开相应的源文件并跳转到函数定义

eclipse 中是否有类似的东西，尤其是 phpeclipse 或 CDT？我不确定它是否只是`window->preferences`我看不到的设置，或者我可能禁用了在设置中也找不到的某种源代码索引（如果可用）

谁知道正确的设置？我正在使用带有 pdt 2.0.0.v20081229 的 eclipse 3.4.1。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-09-30T17:25:22.583

使用 Juno 和 PDT（PHP 开发工具），您可以通过以下方式将此有用的功能添加到项目中：

> 右键单击项目 -> 配置 -> 添加 PHP 支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T14:02:08.410

Ctrl+Left 单击通常也可以在 Eclipse 中使用，尽管它的反应速度非常慢。出于这个原因，我通常在将插入符号移动到函数名称后使用 F3。

可以在“常规 > 编辑器 > 文本编辑器 > 超链接”的首选项中找到 Ctrl+Click 的内容。可以关掉的，但是这个功能显然需要相应编辑器/解析器的支持才能完全可用。

F3 键在这里绑定到“Open Declaration”。如果不是这种情况，则可以手动添加此映射，否则可能是 Eclipse 无法使用 PHP 做到这一点。

# python - 你如何让这段代码更 Pythonic？

> ID：1007215
> 
> 赞同：3
> 
> 时间：2009-06-17T14:00:46.510
> 
> 标签：python, machine-learning, scipy

你们能告诉我如何使以下代码更具pythonic吗？

代码是正确的。完全公开 - 这是[本](http://www.stanford.edu/class/cs229/materials.html)机器学习课程的讲义 #4 中的问题 1b。我应该在两个数据集上使用牛顿算法来拟合逻辑假设。但是他们使用 matlab 而我使用的是 scipy

例如，我遇到的一个问题是矩阵一直四舍五入到整数，直到我将一个值初始化为 0.0。有没有更好的办法？

谢谢

```
import os.path
import math
from numpy import matrix
from scipy.linalg import inv #, det, eig

x = matrix( '0.0;0;1'  )
y = 11
grad = matrix( '0.0;0;0'  )
hess = matrix('0.0,0,0;0,0,0;0,0,0')
theta = matrix( '0.0;0;0'  ) 

# run until convergence=6or7
for i in range(1, 6):
  #reset
  grad = matrix( '0.0;0;0'  )
  hess = matrix('0.0,0,0;0,0,0;0,0,0')

  xfile = open("q1x.dat", "r")
  yfile = open("q1y.dat", "r")

  #over whole set=99 items  
  for i in range(1, 100):    
    xline = xfile.readline()
    s= xline.split("  ")
    x[0] = float(s[1])
    x[1] = float(s[2])
    y = float(yfile.readline())

    hypoth = 1/ (1+ math.exp(-(theta.transpose() * x)))

    for j in range(0,3):
      grad[j] = grad[j] + (y-hypoth)* x[j]      
      for k in range(0,3):
        hess[j,k] = hess[j,k] - (hypoth *(1-hypoth)*x[j]*x[k])

  theta = theta - inv(hess)*grad #update theta after construction

  xfile.close()
  yfile.close()

print "done"
print theta 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T14:23:22.470

一个明显的变化是去掉“for i in range(1, 100):”，只遍历文件行。要遍历这两个文件（xfile 和 yfile），请将它们压缩。即用类似的东西替换那个块：

```
 import itertools

 for xline, yline in itertools.izip(xfile, yfile):
    s= xline.split("  ")
    x[0] = float(s[1])
    x[1] = float(s[2])
    y = float(yline)
    ... 
```

（这是假设文件是​​ 100 行，（即你想要整个文件）。如果你故意限制*前*100 行，你可以使用类似的东西：

```
 for i, xline, yline in itertools.izip(range(100), xfile, yfile): 
```

但是，对同一个文件进行 6 次迭代也是低效的——最好提前将其加载到内存中，然后在那里循环，即。在你的循环之外，有：

```
xfile = open("q1x.dat", "r")
yfile = open("q1y.dat", "r")
data = zip([line.split("  ")[1:3] for line in xfile], map(float, yfile)) 
```

在里面：

```
for (x1,x2), y in data:
    x[0] = x1
    x[1] = x2
     ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T14:26:48.953

```
x = matrix([[0.],[0],[1]])
theta = matrix(zeros([3,1]))
for i in range(5):
  grad = matrix(zeros([3,1]))
  hess = matrix(zeros([3,3]))
  [xfile, yfile] = [open('q1'+a+'.dat', 'r') for a in 'xy']
  for xline, yline in zip(xfile, yfile):
    x.transpose()[0,:2] = [map(float, xline.split("  ")[1:3])]
    y = float(yline)
    hypoth = 1 / (1 + math.exp(theta.transpose() * x))
    grad += (y - hypoth) * x
    hess -= hypoth * (1 - hypoth) * x * x.transpose()
  theta += inv(hess) * grad
print "done"
print theta 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T19:19:45.817

> 矩阵一直四舍五入为整数，直到我将一个值初始化为 0.0。有没有更好的办法？

在代码的顶部：

```
from __future__ import division 
```

在 Python 2.6 和更早版本中，整数除法总是返回一个整数，除非其中至少有一个浮点数。在 Python 3.0（以及**未来**的 2.6 中的除法）中，除法的工作方式更像我们人类所期望的那样。

如果您*希望*整数除法返回一个整数，并且您已从**future**导入，请使用双精度 //。那是

```
from __future__ import division
print 1//2 # prints 0
print 5//2 # prints 2
print 1/2  # prints 0.5
print 5/2  # prints 2.5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:02:42.260

您可以使用**[with](http://www.python.org/dev/peps/pep-0343/)**语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T14:25:21.857

将文件读入列表的代码可能要简单得多

```
for line in open("q1x.dat", "r"):
    x = map(float,line.split("  ")[1:])
y = map(float, open("q1y.dat", "r").readlines()) 
```

# html - 哪些浏览器支持html 5 今天在 Windows 上标记？

> ID：1007223
> 
> 赞同：30
> 
> 时间：2009-06-17T14:02:53.150
> 
> 标签：html

现在哪些浏览器支持 Windows 上的 html 5`<audio>`标签？

编辑：尝试[http://moztw.org/demo/audioplayer/](http://moztw.org/demo/audioplayer/)作为测试。Chrome 2 和 Safari 4 不适合我。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-09-11T01:28:44.747

如果计算结果为真：

```
!!document.createElement('audio').canPlayType 
```

，那么您的浏览器中就有音频标签支持。像这样进行特征检测比解析 userAgent 字符串要好得多。

或者，您可以使用[Modernizr 之](http://www.modernizr.com)类的工具来处理此检测和许多其他检测。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T19:14:45.903

Safari 3.1+ 和 Firefox 3.5 都支持音频元素。Opera 10 不*支持*audio 元素，尽管它支持 Audio 对象形式的旧版本。Chrome 3 可能会支持音频元素。

（刚刚看到您想知道对该特定页面的支持。恐怕这主要取决于您使用的编解码器。）

（免责声明：我为 Opera 工作，并且是 HTML WG 的成员。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-07-22T15:44:22.593

[我们的](http://www.scirra.com/blog/44/on-html5-audio-formats-aac-and-ogg)博文。

包含有关现代浏览器对 HTML5 音频的支持的更多最新信息。

**截至 2011 年 7 月**

**IE9**

支持 MP3 和 AAC

**火狐 5**

支持 Ogg 和 Wav

**铬 12**

支持 Ogg、MP3、Wav 和 AAC

**野生动物园 5**

支持 MP3、AAC 和 WAV

**歌剧 11**

支持 Ogg 和 Wav

正如您从上面的数据和阅读博客文章中看到的那样，这有点令人沮丧，因为并非所有浏览器都支持一种音频格式。目前也没有任何解决方案的迹象。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-12-29T18:37:45.440

我汇总了[浏览器何时](http://helephant.com/2011/12/29/the-html5-audio-tag/#browser-support)开始支持音频标签以及它们支持哪些音频格式的列表。

现在支持还不错。自 IE9 以来，所有桌面浏览器和大多数移动浏览器的最新版本都支持音频标签。不使用它的唯一原因是支持旧版本的 IE，但如果这很重要，您可以随时提供备用。

以下是桌面浏览器的详细信息：

```
+---------+-------------------------+----------------------------------+
| Browser | Supported since version |             Formats              |
+---------+-------------------------+----------------------------------+
| IE      | 9.0                     | AAC or .mp3                      |
| Firefox | 3.5                     | .ogg, .wav                       |
| Chrome  | 3                       | .mp3, .ogg                       |
| Safari  | 4                       | Any audio supported by Quicktime |
| Opera   | 9.5                     | .ogg, .wav                       |
+---------+-------------------------+----------------------------------+ 
```

以下是移动浏览器的详细信息（没有格式信息，抱歉）：

```
+--------------+-------------------------+
|   Browser    | Supported since version |
+--------------+-------------------------+
| iOS Safari   | 4                       |
| Opera mobile | 10                      |
| Opera mini   | no support (Dec 2011)   |
| Android      | 2.3                     |
| Blackberry   | 6                       |
+--------------+-------------------------+ 
```

如果您想使用音频，[提供 .ogg 和 .mp3 版本的文件](http://helephant.com/2011/12/29/the-html5-audio-tag/#supporting-different-browsers)以获得良好的跨浏览器支持非常重要。

```
<audio controls>
   <source src="/my-podcast.mp3" />
   <source src="/my-podcast.ogg" />
</audio> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T14:06:30.740

这是一篇比较每个浏览器的 HTML5 支持的[维基百科文章：](http://en.wikipedia.org/wiki/Comparison_of_layout_engines_(HTML5))

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-08T20:27:10.130

要让 Safari 在 Windows 上支持音频，需要安装 Quicktime。javascript 代码段是否支持正确报告。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-12T02:10:44.573

所有这些浏览器都支持标签的功能。您的播放器无法在 Safari 上运行的原因是您使用的是 OGG 文件。Firefox 和 Chrome 支持 OGG。
Firefox 仅支持 WAV 和 OGG。Chrome 支持一切。Opera 仅支持 WAV。Safari 支持除 OGG 之外的所有内容。

祝你好运！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T14:05:18.417

歌剧 10 和 ff 3.5 ，不知道 safari

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-17T14:05:22.520

我确定 Safari 4、来自 RC1 的 Firefox 3.5 和 Chrome 2。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T14:06:29.617

据我所知，gecko、webkit 和 presto 引擎部分或完全支持它。

因此，任何使用这些引擎的最新版本的浏览器都应该支持它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-17T15:17:43.000

Gecko、Webkit 和 Presto 引擎应该支持它，但我认为只是部分支持。所以 Firefox 3.5 和 Opera 是你最好的选择。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-17T16:11:19.723

该页面（moztw.org/demo/audioplayer）在 Chrome 3（开发频道）中运行良好

# vb.net - GUI 到业务对象映射 VB.Net

> ID：1007227
> 
> 赞同：0
> 
> 时间：2009-06-17T14:04:04.520
> 
> 标签：vb.net, user-interface, .net-2.0, mapping, bll

我目前遇到的问题是将多个 GUI 字段映射到对象属性（即表示层到业务逻辑层的映射）。更具体地说，这是在 VB.Net 2.0 WinForms 中。

解决方案的性质要求我们有 4 列在我们的 GUI 上表现出相同类型的行为 - 每列由 11 个文本框组成（我们将只使用这个小样本量，因为问题超出了 11 个文本框）。

我目前正在做的是将所有四列中每个文本框的标签设置为如下值：

```
Textbox1.tag = "name"
Textbox2.tag = "type"
Textbox3.tag = "speed" 
```

当文本框（例如按键）引发事件时，我查看父容器，我还将其标记设置为映射特定对象的字符串。我将它与文本框的标签结合使用来确定我需要设置的对象属性。总的来说，它看起来像这样：

```
dim objectToMapTo //the generic parent object which all my custom myObjects inherit from

select case sender.parent.tag //the parent object that the property needs to map to
    case "column1"
         objectToMapTo = myObject1
    case "column2"
         objectToMapTo = myObject2
    case "column3"
         objectToMapTo = myObject3
    case "column4"
         objectToMapTo = myObject4
end select

select case sender.tag //the actual textbox's tag value which maps to the property
    case "name"
         objectToMapTo.Name = sender.text //sender.text is conceptual for 
        //the data that needs to be set -- i.e. this could be a calculated 
        //number based on the text, or simply a string, etc
    case "type"
         objectToMapTo.Type = sender.text
    case "speed"
         objectToMapTo.Speed = sender.text
    ...
end select 
```

如您所见，这可能会变得非常糟糕，而且很快。目前我们正在设置 43 一些可以映射到的奇怪属性——因此该 select 语句非常长——其中许多嵌入在多种方法中以尝试 DRY（我已将代码淡化为本质上的概念执行）。

问题是：我该如何重构它？我曾尝试在一定程度上使用字典/哈希，但它要么变得过于复杂，要么只是简单地没有实现意义，因为它使问题更加复杂。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:47:05.323

通过将标签设置为对象来解决的第一个问题。由于标签不是字符串而是对象类型。

您通过使用反射解决的第二个问题是标记中的值必须与属性名完全匹配。

```
_objectToMapTo.GetType().InvokeMember(sender.tag,BindingFlags.Instance Or BindingFlags.Public,Nothing, _objectToMapTo, New Object() {sender.text}) 
```

免责声明反射很接近，但可能不是 100% 正确。

# iis - IIS 未正确提供 shtml 文件，而是浏览器尝试下载文件

> ID：1007230
> 
> 赞同：0
> 
> 时间：2009-06-17T14:04:29.857
> 
> 标签：iis, windows-xp, browser, shtml

好的，所以我在一个临时办公室，他们给了我一台装有 XP 的机器来进行开发。惊人的。

我已经在 IIS 中设置了站点，我需要它来提供 shtml 文件。

问题是，当我浏览到 shtml 文件时，浏览器会尝试下载文件，而不是正确显示它。

我尝试了一些我在其他网站上发现的东西都无济于事，现在我只是感到沮丧。

有什么帮助吗？！？！

-EV

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:05:44.440

您是否使用正确的 mime 类型为它提供服务？

shtml 仅使用`text/html`mime 类型，但您的 IIS 可能未配置为将该文件扩展名与该 mime 类型匹配

有关添加 mime 类型的详细信息，请参阅[http://technet.microsoft.com/en-us/library/cc725608](http://technet.microsoft.com/en-us/library/cc725608(WS.10).aspx) (WS.10).aspx （您没有指定 IIS 的版本......这些文档适用于 IIS 7 )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:09:41.890

IIS 可能配置为 .SHTM / .STM 文件扩展名。您可以在 IIS 控制面板中更改扩展名，或重命名文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T14:21:05.673

更新：我从来没有得到这个排序。我怀疑我使用的 CMS 做了一些奇怪的事情。因此，在使用了大约一天之后，我决定我已经在它上面浪费了足够的时间并安装了 Apache 来查看 SSI 文件——对于实际站点仍然使用 IIs 5.1。

在生产/开发/测试/阶段环境中，使用更新版本的 IIS 可以正常工作。这只是我在本地机器上遇到的问题。

所以没有解决，但我不会再为此失去睡眠/时间了！

# iphone - “collect2：ld 返回 1 退出状态”错误 Iphone SDK。请帮我

> ID：1007235
> 
> 赞同：1
> 
> 时间：2009-06-17T14:04:55.720
> 
> 标签：iphone, objective-c, xcode

我是新的 Mac 和 iphone SDK。我基本上写了一个游戏应用程序。我想使用 SQLite 更新和显示游戏分数。

我在网上搜索了我的问题，但没有找到适合我的解决方案。错误是：

```
Ld /Users/Iphone/Desktop/IDRGame/build/Debug-iphonesimulator/IDRGame.app/IDRGame normal i386
cd /Users/Iphone/Desktop/IDRGame
setenv MACOSX_DEPLOYMENT_TARGET 10.5
setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc-4.0 -arch i386 -isysroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk -L/Users/Iphone/Desktop/IDRGame/build/Debug-iphonesimulator -L/Users/Iphone/Desktop/IDRGame -L/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk/System/Library/Frameworks/QuartzCore.framework -F/Users/Iphone/Desktop/IDRGame/build/Debug-iphonesimulator -F/Users/Iphone/Desktop/IDRGame -filelist /Users/Iphone/Desktop/IDRGame/build/IDRGame.build/Debug-iphonesimulator/IDRGame.build/Objects-normal/i386/IDRGame.LinkFileList -mmacosx-version-min=10.5 -framework Foundation -framework UIKit -framework CoreGraphics -framework AudioToolbox -lsqlite3.0 -o /Users/Iphone/Desktop/IDRGame/build/Debug-iphonesimulator/IDRGame.app/IDRGame
Undefined symbols:
".objc_class_name_ScoreDB", referenced from:
literal-pointer@__OBJC@__cls_refs@ScoreDB in IDRGameAppDelegate.o
literal-pointer@__OBJC@__cls_refs@ScoreDB in InterclockView.o
ld: symbol(s) not found
collect2: ld returned 1 exit status 
```

我有 SQLite 的 ScoreDB.h 和 ScoreDB.m 文件。ScoreDB.h 文件

```
//
// ScoreDB.h
// SQLiteTutorial
//
// Created by Iphone App on 6/11/09.
// Copyright 2009 __MyCompanyName__. All rights reserved.
//
#import <UIKit/UIKit.h>
#import <sqlite3.h>

@interface ScoreDB : NSObject {
NSInteger *game_id;
NSString *name;
NSString *score;

BOOL hydrated;
BOOL dirty;
}

@property (nonatomic, readonly) NSInteger *game_id;
@property (nonatomic, copy) NSString *name;
@property (nonatomic, copy) NSString *score;
@property (nonatomic, readwrite) BOOL dirty;
@property (nonatomic, readwrite) BOOL hydrated;

- (id)initWithPrimaryKeyNSInteger)pk;
-(void)UpdateDatabase;
-(void)SelectDatabase;
+ (void) finalizeStatements;
@end 
```

和 ScoreDB.m

```
#import "ScoreDB.h"
static sqlite3 *database = nil;
static sqlite3_stmt *insert_statement = nil;
static sqlite3_stmt *init_statement = nil;
static sqlite3_stmt *delete_statement = nil;
static sqlite3_stmt *hydrate_statement = nil;
static sqlite3_stmt *dehydrate_statement = nil;
static sqlite3_stmt *update_statement = nil;

@implementation ScoreDB
@synthesize game_id,name,score,dirty,hydrated;

- (id)initWithPrimaryKeyNSInteger)pk{    
[super init];
game_id = pk;
return self;
}

// Finalize (delete) all of the SQLite compiled queries.
+ (void)finalizeStatements {
if (database) sqlite3_close(database);
if (insert_statement) {
sqlite3_finalize(insert_statement);
insert_statement = nil;
}
if (init_statement) {
sqlite3_finalize(init_statement);
init_statement = nil;
}
if (delete_statement) {
sqlite3_finalize(delete_statement);
delete_statement = nil;
}
if (hydrate_statement) {
sqlite3_finalize(hydrate_statement);
hydrate_statement = nil;
}
if (dehydrate_statement) {
sqlite3_finalize(dehydrate_statement);
dehydrate_statement = nil;
}

if (update_statement) {
sqlite3_finalize(update_statement);
update_statement = nil;
}
}

-(void)UpdateDatabase {
delegate:self cancelButtonTitle:@"OK" otherButtonTitles: nil];
[alert show];

if(update_statement == nil) {
const char *sql = "UPDATE game Set score = ? Where name = ?";
if(sqlite3_prepare_v2(database, sql, -1, &updateStmt, NULL) != SQLITE_OK)
NSAssert1(0, @"Error while creating update statement. '%s'",
          sqlite3_errmsg(database));
}

sqlite3_bind_text(update_statement, 1,
                 [name UTF8String], -1, SQLITE_TRANSIENT);
sqlite3_bind_text(update_statement, 2,
                 [score UTF8String], -1, SQLITE_TRANSIENT);
// sqlite3_bind_int(update_statement, 3, coffeeID);

if(SQLITE_DONE != sqlite3_step(update_statement))
NSAssert1(0, @"Error while updating. '%s'", sqlite3_errmsg(database));

sqlite3_reset(update_statement);

//Reclaim all memory here.
[score release];
score = nil;
[name release];
name = nil;

}

-(void)SelectDatabase {}

- (void) setGameNameNSString *)newValue {
[name release];
name = [newValue copy];
}

- (void) setGameScoreNSString *)newValue {
[score release];
score = [newNumber copy];
}

- (void)dealloc {
[name release];
[score release];
[super dealloc];
}
@end 
```

我正在使用该代码

```
IDRGameAppDelegate *appDelegate =
         (IDRGameAppDelegate *)[[UIApplication sharedApplication] delegate];

ScoreDB *dbObj = [[ScoreDB alloc] initWithPrimaryKey:0];
dbObj.name = @"reflex";
dbObj.score = @"0.345";

[appDelegate updateScore:dbObj]; 
```

当我关闭此行时：`ScoreDB *dbObj = [[ScoreDB alloc] initWithPrimaryKey:0];`错误消失了。什么问题我不明白。请帮我。我的框架：

*   libsqlite3.0.dylib
*   AudioToolbox.framework
*   UIkit.framework
*   基础框架
*   CoreGraphics.framework。

我希望你能帮助我。

感谢大家。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T14:10:02.433

您可能尚未将 ScoreDB.m 添加到当前目标。右键单击 ScoreDB.m，选择“获取信息”，选择“目标”选项卡并确保它是您正在构建的目标的一部分。

# asp.net-mvc - ASP.NET MVC 和长时间运行的操作

> ID：1007244
> 
> 赞同：2
> 
> 时间：2009-06-17T14:06:11.567
> 
> 标签：asp.net-mvc, multithreading

我有一个控制器操作，它聚合来自多个来源的数据：Web 服务、数据库、文件查找等......并将结果传递给视图。因此，为了呈现页面，所有任务都必须完成。目前它们是按顺序执行的，但由于它们是独立的，我正在考虑并行运行它们，因为这可以提高性能。

那么实现这一目标的最佳方法是什么？为每个任务启动一个新线程并在所有任务完成时阻塞主线程？我应该使用线程池中的线程还是手动生成一个新线程？使用线程池中的线程会限制我的 Web 服务器处理新请求的能力，因此这可能不是一个好主意。手动生成新线程可能会很昂贵，所以最终通过并行这些任务或让它们按顺序运行会带来性能的净收益吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:18:03.667

如果是在生成自己的线程或使用线程池线程之间，我会说使用线程池中的线程。如果您发现线程用完了，您可以随时调整服务器设置以允许池中的更多线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:12:11.180

回答最后一个问题的唯一方法是实际测试它，因为我们不知道单独的聚合任务有多复杂。如果你想给人一种响应式 UI 的错觉，你总是可以显示加载页面并使用 AJAX 启动聚合。即使没有线程，这也可以充分安抚您的用户。

# lisp - 我应该学习哪种 Lisp 方言？

> ID：1007250
> 
> 赞同：99
> 
> 时间：2009-06-17T14:07:00.553
> 
> 标签：lisp, dialect

我知道 Lisp 有几种不同的方言。决定学习 Lisp 将是一种新的智力体验后，我想知道要学习哪种 Lisp 方言，以及为什么。

有没有比其他更受欢迎的？它们中的任何一个是否更“完整”，例如，更好地记录和支持？这种方言的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-06-20T02:49:07.863

您想在简单和整洁、吸引人的功能以及一个允许您编写有趣和有用的软件（对自己）以及作为学习工具的平台之间寻找平衡。（最后一个会让你继续学习更长时间。）这里有一些可能性：

1.  **方案。**可能是所有方言中最干净的。这就是为什么[The Little Schemer](http://www.ccs.neu.edu/home/matthias/BTLS/)从 LISP 翻译成 Scheme 的原因。第五个 Scheme 标准规范[R5RS](http://www.schemers.org/Documents/Standards/R5RS/)本身就是一个很好的教育；它可能是我读过的最好的语言和库规范，也是相当全面的最短的。[PLT Scheme](http://en.wikipedia.org/wiki/Plt_scheme) （现在的Racket）平台包括一个相当不错的解释器和编译器，非常适合编写脚本，并且还有一些可视化工具，非常适合学习。

2.  **常见的 Lisp。**可能是最便携和最全面的变体，如果您想编写诸如商业软件之类的东西，这很可能是您想要的。该标准定义了广泛的库，除此之外还有更多可用的库，它有[CLOS](http://en.wikipedia.org/wiki/CLOS)，它可能会比任何 OO 语言教你更多关于 OO 的知识，并且一些编译器非常好。缺点包括Scheme没有的一些缺点（例如为引用函数的变量提供单独的命名空间），不够干净和简单（就像任何必须具有扩展并做出必要妥协的情况一样对于现实世界中的大型应用程序），没有卫生的宏，并且比 Scheme 强调递归要少得多。

3.  **克洛朱尔。**它在 JVM 上运行，这可能会为 Java 开发人员提供支持。它有一些缺点（例如，您必须明确要求尾调用优化，尽管如果将 TCO 添加到 JVM，这可能会在某一天改变）。宏虽然不卫生，但确实有一些功能可以帮助您避免变量捕获，因此您可以根据需要捕获变量，同时与 CL 相比，意外这样做的风险更小。您可以轻松访问所有 J​​ava 库；这对于“现实世界”的代码来说可能是一件好事，而且在学习方面毫无意义。它有一组用于持久数据结构的库和对 STM 的支持，这从并发的角度来看非常有趣；这可能是你最好的选择，如果你 有兴趣了解有关处理并发和并行编程的新方法的更多信息。看起来 Clojure 与 Java 一样适用于大型生产应用程序，从某种意义上说，它将有能力做你在生产应用程序中做的那些你不想做和不做的“丑陋的事情”在你学习的时候。

4.  **Emacs Lisp。**就 LISP 而言，这不是最好的例子之一。它最大的缺陷之一是动态范围，但还有许多其他缺陷。但是，如果您是 Emacs 用户，这可能是您可以学习的最强大的工具，可以提高您对编辑器的使用。然而，除了如何扩展 Emacs 之外，你从学习 Emacs Lisp 中真正学到了多少，对我来说是一个悬而未决的问题；我不知道在 Emacs Lisp 中真正使用高阶函数等有趣技术的频率有多高。

**2018 更新**

自从我写这篇文章以来已经快十年了，Lisp 语言家族现在似乎在普通程序员的意识中获得了巨大的吸引力。其中大部分似乎与 Clojure 相关，它不仅本身成为了一种适当独立的 Lisp 方言，引入了许多自己的好想法，而且现在有一个几乎相同的针对 JavaScript 的版本，并启发了许多其他 Lisp针对其他平台。例如，[Hy](http://hylang.org)以 CPython AST 和字节码为目标，首先瞄准与 Python 的互操作性，但在“有疑问时”使用 Clojure 思想。（尽管从最新的提交来看，后者可能会有所改变。）

这给您的决策过程带来的重大变化是，您还应该查看可用的任何 Lisp 或类似 Lisp 的语言，并与您已经使用的语言或平台互操作，无论是[Perl](https://metacpan.org/pod/CljPerl)、[Ruby](https://bitbucket.org/dastels/rubylisp)、[Erlang](https://github.com/clojerl/clojerl)、[Go](https://github.com/candid82/joker)甚至是[微控制器上的 C++](https://github.com/nakkaya/ferret)。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-17T14:11:04.663

我会说 Scheme，完全是因为[Little Schemer](https://rads.stackoverflow.com/amzn/click/com/0262560992)，这是我曾经尝试阅读的最令人兴奋但最难读的书之一。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-18T09:06:08.663

[我可以在SBCL](http://www.sbcl.org/)上推荐 Common Lisp 。这种组合快速、强大、成熟且有据可查。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-17T18:06:28.887

Clojure 这些天也获得了很多的关注，这是有充分理由的。伟大的数据结构，非常好的并发支持（在这方面让 Scheme 和 CL 感到羞耻），以及一个伟大的社区。它也比较简单，CL 至少和 C++ 一样复杂。

这并不是说我不喜欢 CL 或 Scheme。我通过 SICP 学习了 Scheme。CL 把我带到了 Clojure。我想这一切都取决于你的目标。如果你想学习一个非常实用的 Lisp，去 Clojure 吧。否则 CL 或 Scheme 都很棒。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-17T14:30:22.860

我在学校学过[Scheme](http://www.gnu.org/software/mit-scheme/)。这是一次很棒的学习经历，我永远不会忘记函数式编程的基础知识。只要您了解其有用性的核心 - 无状态 lambda 演算，您选择哪个版本的 LISP 可能并不重要。

这是一篇关于为什么 MIT在其编程入门课程中[从 Scheme 切换到 Python的有趣文章。](http://www.wisdomandwonder.com/link/2110/why-mit-switched-from-scheme-to-python)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-17T14:11:11.527

我更喜欢 CL，因为我喜欢面向对象的编程，而 CLOS 是最好的对象系统。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-20T01:26:01.603

我会说所有这些，至少一开始是这样。最终，您可能会偏爱 Scheme 或 Common Lisp，但它们都有足够的差异，因此最好掌握其中的所有内容。

例如，Scheme 有延续，学习 Scheme 中的延续是很好的，即使它们可以在 Common Lisp 中实现。

学习词法作用域和动态作用域之间的区别很重要，如果你同时学习 Common Lisp 和 elisp，你就会发现两者的含义。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-30T23:58:31.517

一开始是一种“加载”的问题，但OP可能不知道。一般来说，Common 和 Scheme lispers 就像 PC 和 Apple 计算机的“人”，它们不会混在一起。哪一个最好可能不如哪个对您“有效”那么重要。真的，没有那么大的区别。可能对其中一个的偏好可能会受到您首先学习的影响。（对我来说，一个空列表应该是“无”，在 CL 中称为 NIL，这使我成为 Common Lisper。）我喜欢使用 EMACS 将 SBCL 与 Slime 集成，但 SBCL 并不适合所有人。一方面，SBCL 非常严格。如果您只是想“玩得开心”，GNU clisp 很简单，几乎可用于所有平台。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-08T14:42:56.813

LFE（Lisp Flavored Erlang）会很好。您可以在 Erlang VM 之上使用 lisp 语法。

# java - '==' 和 '=' 有什么区别？

> ID：1007255
> 
> 赞同：0
> 
> 时间：2009-06-17T14:07:22.937
> 
> 标签：java, operators

我知道其中一个是按位的，另一个是合乎逻辑的，但我无法弄清楚：

```
Scanner sc = new Scanner(System.in);
System.out.println("Enter ur integer");
int x=sc.nextInt();
if(x=0)//Error...it can not be converted from int to boolean
System.out.println("..."); 
```

错误表示`x`无法转换为`boolean`或结果`x=0`无法转换为`boolean`。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-17T14:08:21.890

== 检查是否相等。= 是赋值。

您正在做的是： `if( x = Blah )`- 在 Java 中，此语句是非法的，因为您无法测试赋值语句的状态。具体来说，Java 不会将赋值视为 if 语句中需要的布尔运算。这与 C/C++ 形成对比，C/C++ 允许您将赋值视为布尔运算，并且可能是许多令人毛骨悚然的错误的结果。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-17T14:11:17.347

当你写 'x = 0' 时，你说的是“在变量 x 中存储 0”。整个表达式的返回值是 '0'（就像这样，所以你可以说像 x = y = 0 这样的傻话）。

当你写'x == 0'时，它会说“x等于0吗？”。此表达式的返回值将是“真”或“假”。

在 Java 中，您不能只说 if(0)，因为 if 需要一个真/假答案。所以放 if(x = 0) 是不正确的，但 if(x == 0) 很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T14:08:38.443

== 是比较运算符，= 是赋值。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T14:09:17.070

```
== is an equality check. if (x == 0) // if x equals 0
= is an assignment. x = 0; // the value of x is now 0 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T16:02:04.497

我知道这个问题已经得到解答，但这仍然不时出现，不是程序员错误，而是印刷错误（即，程序员知道他的意思，但失败了）。可能很难看到，因为两者看起来非常相似。

我发现一种有助于避免这样做的方法是将常量表达式放在左侧，如下所示：

```
if (0 == x) 
   ... 
```

这样，如果我不小心只使用了一个“=”符号，编译器将失败并出现关于分配给常量表达式的错误，无论赋值运算符是否是左关联的，以及 if 条件是否需要一个强类型的布尔值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T14:10:31.293

```
if(x=0) 
```

在这里，您*将*值 0 分配给变量 x。Java 中的 if 语句不能像在许多其他语言中那样评估整数参数。在 Java 中，如果需要一个布尔值。尝试

```
if(x == 0) 
```

做一个*比较*。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T14:13:09.400

将错误解释为

“表达方式

```
x=0 
```

无法转换为布尔值。”

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T14:19:15.583

只是为了澄清 C/C++ - 赋值被评估为正确的操作数

```
if(a = n) 
```

被评估为 n，因此 (n = 1) 为真 (n = 0) 为假

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-17T23:53:33.063

一个有趣的注释：由于赋值运算符的计算结果是正确的操作数，以下在 Java 中是有效的（虽然不是很漂亮）：

```
if (( x = blah ) > 0) ... 
```

由于运算符优先级（'>' 绑定比 '=' 更强），因此需要括号。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T14:13:12.363

正如其他人已经说过的，'=' 是赋值；'==' 是比较。

在您的程序更改中

> 如果（x=0）

到

> 如果（x==0）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-17T14:30:17.823

```
"==" checks for equality

"=" Is used for assignment. 
```

它给你错误，因为你在 if() 中为 x 赋值，你应该在其中检查是否相等。尝试将其更改为相等而不是赋值运算符。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-09T02:12:18.187

正如其他人所说，在比较时`=`分配。`==`

然而，这些陈述也有它们自己的价值。

运算符返回其`=`右侧操作数的值。这就是类似语句的`a = b = c = 5`工作方式：它们被解析为`a = (b = (c = 5))`，其计算结果为`a = (b = 5)`，然后`a = 5`。

如果其操作数相等，则该`==`运算符返回 a 。如果它的参数是 ，则语句运行它的主体。因此，像translate to之类的标题。这就是为什么有时你会看到带有 header 的无限循环；循环运行“while” toe 参数为真。`boolean``true``if``true``if``if (5 == 5)``if (true)``while``while (true)``while`

如果您`boolean`的`if`语句中有 a ，那么如果分配的值（或“比较”）是`true`. 这就是为什么*永远不要*混淆`=`and`==`运算符如此重要的原因，尤其是在使用`boolean`s 时。

希望这有帮助！

# mfc - 在屏幕一角创建一个 CDialog

> ID：1007258
> 
> 赞同：1
> 
> 时间：2009-06-17T14:08:07.227
> 
> 标签：mfc, cdialog

我有一个创建 CDialog 的 MFC 应用程序。我希望这个 CDialog 不显示在屏幕中间，而是显示在屏幕的一侧，这样它几乎不可见甚至最小化都会很好。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:13:54.890

`SetWindowPos`在您的`OnInitDialog()`函数中使用，如下所示：

```
BOOL CDlg::OnInitDialog()
{
    CDialog::OnInitDialog();
    // (x,y) is the upper-left corner in screen coordinates
    SetWindowPos( NULL, x, y, 0, 0, SWP_NOSIZE | SWP_NOZORDER );
    return TRUE;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:13:59.353

您可以`SW_SHOWMINIMIZED`在 `ShowWindow(SW_SHOWMINIMIZED)`. （SW_SHOWMINIMIZED ==> 以最小化状态打开窗口，将其表示为任务栏上的按钮）

```
pDlg->Create(IDD_DLG_ID1,this);
pDlg->ShowWindow(SW_SHOWMINIMIZED); 
```

# django - 在通用应用程序中实现模板标签 - django

> ID：1007264
> 
> 赞同：0
> 
> 时间：2009-06-17T14:08:43.280
> 
> 标签：django, django-templates

我开发了一些基于 contrib 评论应用程序的代码，例如 ajax 请求的处理程序。此代码位于单独的应用程序中，我们可以将其称为“comments2”。项目的 url 配置的结构使得所有对 /comments 的调用都被定向到这个应用程序的视图。这没有问题。

最近，我创建了一个新页面，显示标记为不适当的评论。

我认为最好通过编写包含模板标签来完成，并写了一个。它是这样工作的：

```
{% display_flagged_comments 'market' %} 
```

此标签放置在主应用程序的相关模板中。

如上面的代码所示，我传递了评论所属的模型（在本例中为**Market**），以便 comments2 应用程序保持通用。

我在这里有三个问题需要指导：

首先，我觉得模型参数在引号（**'market'**）中会使代码不那么优雅。在代码中，参数被转换为模型：

```
#template tag
def show_comments(modelname):
    model = ContentType.objects.get(model=modelname)
    ... # get comments and return them 
```

其次，由于所有带有**/comments**的请求都被定向到 comment2 应用程序，我需要为此页面设计一个不同的 url（它位于主应用程序内），例如 /managecomments。我觉得这样做也很不雅。

第三，我想知道我是否遵循了正确的路径，或者是否有更好的方法来实现我正在尝试做的事情。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T09:18:06.487

ContentTypeManager 在一定程度上为您解决了您的第一个问题。您可以使用 method `get_for_model`，它接受类或实例。[在contettypes 文档](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#the-contenttypemanager)中阅读更多内容。

# java - 我如何找出调用类？

> ID：1007268
> 
> 赞同：3
> 
> 时间：2009-06-17T14:09:25.557
> 
> 标签：java

我如何找出哪个类/方法调用了实际方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T14:11:59.513

您可以尝试创建一个异常来获取它的堆栈跟踪。

```
Throwable t = new Throwable();
StackTraceElement[] stackTraceElements = t.getStackTrace(); 
```

现在`stackTraceElement[0]`包含当前方法的调用者。

但要小心（来自[Throwable.getStackTrace()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Throwable.html#getStackTrace())）：

> 在某些情况下，某些虚拟机可能会从堆栈跟踪中省略一个或多个堆栈帧。在极端情况下，允许没有关于这个 throwable 的堆栈跟踪信息的虚拟机从这个方法返回一个长度为零的数组。一般来说，此方法返回的数组将为 printStackTrace 打印的每一帧包含一个元素。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T14:15:11.783

这是我使用过的一种方法：

```
StackTraceElement element=Thread.currentThread().getStackTrace()[3];
String className=element.getClassName();
String methodName=element.getMethodName(); 
```

[3] 是硬编码的，因为：

[0] 是 Thread.dumpThreads()

[1] 是 Thread.getStackTrace()

[2] 是当前方法

[3] 是当前方法之前的那个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T20:20:16.613

一个更快但非便携式的解决方案是使用以下内容。它不会创建堆栈跟踪，只会为您提供所需的信息。然而，并不是所有的 JVM 都会有这个，未来的 Java 版本也可能没有。

```
Class callerClass = sun.reflect.Reflection.getCallerClass(2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:11:38.890

您可以打印堆栈跟踪来执行此操作。

如果您想动态执行此操作，我不确定这是否可行（除了动态打印和解析堆栈跟踪）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T14:12:12.337

您可以使用调试器或分析器。Netbeans 两者都有，但还有很多其他选择。

否则，如果您可以修改代码，您可以抛出一个新的异常（）并在控制台中打印一个堆栈跟踪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T17:30:24.903

为了回应和详细说明 matt b 和 yishai 的评论：

如果您这样做是因为您正在编写记录器或维护跟踪信息或类似的东西，好吧，很酷。我在生产代码中只使用过一次堆栈跟踪，即使那确实是一个调试问题：我们遇到了数据库连接没有正确关闭的问题，所以我修改了“获取数据库连接”函数来保存调用者的身份，然后定期扫描以查找死连接并查看它们是在哪里创建的。

Java 的内置日志记录功能会进行堆栈跟踪，因此它可以将调用记录器的人写入日志文件。我担心这个开销，因为我知道堆栈跟踪很昂贵，但无论如何。

但是如果你这样做是因为你的函数的行为会根据它被调用的位置而有所不同，比如“如果从类 X 调用更新客户数据，否则如果从类 Y 调用更新员工数据”或类似的东西：真的馊主意。传递参数或编写单独的函数。

# .net - .Net：逻辑线程和线程本地存储？

> ID：1007277
> 
> 赞同：2
> 
> 时间：2009-06-17T14:09:53.823
> 
> 标签：.net, multithreading

我正在阅读有关 CallContext 类（[http://msdn.microsoft.com/en-us/library/system.runtime.remoting.messaging.callcontext.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.messaging.callcontext.aspx)）的信息。该文档说了一些关于“逻辑线程”和“线程本地存储”的内容。

什么是逻辑线程，我不知道存在多种线程？

什么是线程本地存储，它是一个类还是某种原理？

我无法在 MSDN 上找到它，但我确定它在某个地方，所以任何链接都会很棒:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T14:30:43.297

逻辑线程是一个可以追溯到 COM、OLE 和 RPC 的概念，也适用于远程处理场景。逻辑线程跟踪同步调用的执行，因为它传播跨越各种边界，包括 COM 单元、RPC 和远程处理边界。

当您考虑两个完全不相关的组件可能会尝试在同一边界中执行操作的可能性时，这是一个非常重要的概念。COM 等技术必须能够区分进入其边界（单元）的新调用和完全不相关的调用，以保证同步执行之类的事情。

在一个小的 SO 帖子中很难解释逻辑线程。我的建议是在 google / bing 上搜索“RPC 逻辑线程”，然后从那里开始

*   [http://pic.dhe.ibm.com/infocenter/zos/v1r12/index.jsp?topic=%2Fcom.ibm.zos.r12.euvmo00%2Feuva3a00124.htm](http://pic.dhe.ibm.com/infocenter/zos/v1r12/index.jsp?topic=%2Fcom.ibm.zos.r12.euvmo00%2Feuva3a00124.htm)

线程本地存储更容易解释。它是一个存储单元，对于进程中的每个线程都是唯一的。基本思想是您首先分配一个密钥。然后，您可以使用该键查询每个单独的线程以获取项目。每个线程将为键打开不同的空间，因此具有单独的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:15:19.863

[msdn上的线程本地存储](http://msdn.microsoft.com/en-us/library/ms686749.aspx)

# c# - 为什么我的 Winforms 托管的 WCF 服务是单线程的？

> ID：1007279
> 
> 赞同：5
> 
> 时间：2009-06-17T14:10:07.130
> 
> 标签：c#, winforms, wcf, basichttpbinding

我有一个 WCF 服务，用于替换旧的 ASP.NET Web 服务。该服务似乎工作正常，但由于某种原因它无法处理同时请求。我的服务实现具有以下属性：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall, ConcurrencyMode = ConcurrencyMode.Multiple)]
public class HHService : IHHService 
```

我的主机声明如下所示：

```
baseAddress = new Uri("http://0.0.0.0:8888/HandHeld/");
host = new ServiceHost(typeof(HHService), baseAddress);

ServiceMetadataBehavior behavior;
behavior = host.Description.Behaviors.Find<ServiceMetadataBehavior>();
if (behavior == null)
{
    behavior = new ServiceMetadataBehavior();
    behavior.HttpGetEnabled = true;
    behavior.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
    host.Description.Behaviors.Add(behavior);
}
host.AddServiceEndpoint(ServiceMetadataBehavior.MexContractName,MetadataExchangeBindings.CreateMexHttpBinding(), "mex");
host.AddServiceEndpoint(typeof(IHHService), new BasicHttpBinding(), "HHService.asmx");
HHService.LogMessage += new EventHandler<HHService.LogMessageEventArgs>(HHService_LogMessage);
host.Open(); 
```

服务运行并返回正确的结果，但如果两个客户端尝试同时进行调用，一个客户端将阻塞，直到另一个客户端完成，而不是一起执行调用。我没有使用任何配置文件。我正在尝试以编程方式完成所有操作。我是否有错误设置导致此行为？我已经使用 NetTCPBinding 运行其他服务而没有这个问题。

**编辑：** 回应约翰桑德斯：我不熟悉任何 ASP.NET 兼容模式。我没有使用任何会话状态，该服务是无状态的，它只是处理请求。除了实际方法的实现之外，我所做的其他一切都在此处列出的代码中。

**可能的解决方案：**

`host.Open()`我从主窗体的 form_load 事件调用该函数。我将调用移至单独的线程。这个线程所做的只是调用`host.Open()`，但现在该服务的行为似乎与我预期的一样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T16:52:58.100

如果您的实例上下文模式是 PerCall，那么您的服务器始终是单线程的，因为根据定义，每个调用都会获得一个新的服务器实例。

这在 IIS 环境中可以正常工作，其中 IIS 可以启动多个服务器实例来处理 n 个并发调用者，每个调用者作为每个传入请求的单线程服务器。

您在其中一个评论中提到您在表单应用程序中托管 WCF - 这可能是您需要重新考虑的设计决策 - 这并不是最佳选择，因为 Winforms 应用程序无法轻松处理多个调用者并启动多个服务实例代码。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:12:05.473

您的服务功能中是否有锁？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:15:53.187

您使用的是 ASP.NET 兼容模式吗？会话状态？

* * *

我的下一个问题是：是什么让你认为它是单线程的？你是如何确定的，你用什么测试来证明你没有解决这个问题？可能是误报。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-23T19:43:51.493

这在另一个问题中得到了回答：

```
[ServiceBehavior(UseSynchronizationContext = false)] 
```

[Winforms 应用程序中的 WCF - 它总是单线程的吗？](https://stackoverflow.com/questions/4718244/wcf-in-winforms-app-is-it-always-single-threaded)

# c# - 在 C# (linq?) 中固定枢轴转换此数据的最简单方法是什么？

> ID：1007290
> 
> 赞同：0
> 
> 时间：2009-06-17T14:11:26.877
> 
> 标签：c#, .net, linq, transform

鉴于此示例数据（在 Po、Sku、Qty 为属性的 .NET 类中）：

```
PO, Sku, Qty
1,ABC,1
1,DEF,2
1,GHI,1
1,QWE,1
1,ASD,1
1,ZXC,5
1,ERT,1
2,QWE,1
2,ASD,11
2,ZXC,1
3,ERT,1
3,DFG,1
3,DFH,1
3,CVB,4
3,VBN,1
3,NMY,1 
```

我需要将其转换为固定列格式，每行最多 5 个 SKU（如果需要 > 5 则重复 PO）：

```
PO, SkuA, QtyA, SkuB, QtyB, SkuC, QtyC, SkuD, QtyD, SkuE, QtyE
1, ABC, 1, DEF, 2, GHI, 1, QWE, 1, ASD, 1
1, ZXC, 5, ERT, 1, , , , , , 
2, QWE, 1, ASD, 11, ZXC, 1, , , , 
3, ERT, 1, DFG, 1, DFH, 1, CVB, 4, VBN, 1
3, NMY, 1, , , , , , , , 
```

输出可以是 CSV（这就是我要输出的）或 .NET 类——不管在那里。有没有一种简单的方法可以在 Linq 中通过按 PO 分组，然后按 5 进行分组？

编辑：我无法控制目标格式。对于任何感兴趣的人，需要这种废话的是 VendorNet 和 VendorBridge。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:20:56.227

首先，这里的查询将生成正确的对象层次结构。我正在使用匿名类型，但很容易将其更改为使用您自己的适当类。

```
var query = yourData
    .GroupBy
    (
        x => x.PO
    )
    .SelectMany
    (
        x => x.Select
        (
            (y, i) => new { y.PO, y.Sku, y.Qty, Key = i / 5 }
        )
    )
    .GroupBy
    (
        x => new { x.PO, x.Key }
    ); 
```

使用 LINQ 从查询结果创建 CSV 有点小技巧，但它可以完成工作。（使用 LINQ 的“好处”是您可以将原始查询和 CSV 生成链接到一个单一的、大量的语句中，如果您愿意的话。）

```
IEnumerable<string> csvLines = query
    .Select
    (
        x => x.Aggregate
        (
            new { Count = 0, SB = new StringBuilder() },
            (a, y) => new
            {
                Count = a.Count + 1,
                SB = ((a.SB.Length == 0) ? a.SB.Append(y.PO) : a.SB)
                    .Append(", ").Append(y.Sku).Append(", ").Append(y.Qty)
            },
            a => a.SB.ToString() + string.Join(", , ", new string[6 - a.Count])
        )
    );

string csv = string.Join(Environment.NewLine, csvLines.ToArray()); 
```

在我看来，在不使用 LINQ 的情况下创建 CSV 会使代码更具可读性：

```
StringBuilder sb = new StringBuilder();
foreach (var group in query)
{
    int count = 0;
    foreach (var item in group)
    {
        if (count++ == 0)
        {
            sb.Append(item.PO);
        }
        sb.Append(", ").Append(item.Sku).Append(", ").Append(item.Qty);
    }
    while (count++ < 5)
    {
        sb.Append(", , ");
    }
    sb.Append(Environment.NewLine);
}

string csv = sb.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:32:46.230

干得好。我没有按照您想要的方式格式化输出。但这应该让您了解如何旋转行。希望这可以帮助 ：-）

```
public class MyClass
{
        public int PO { get; set; }
        public String SKU { get; set; }
        public int Qty { get; set; }

        public static IEnumerable<MyClass> GetList()
        {
            return new List<MyClass>()
                       {
                           new MyClass {PO = 1, SKU = "ABC", Qty = 1},
                           new MyClass {PO = 1, SKU = "DEF", Qty = 2},
                           new MyClass {PO = 1, SKU = "GHI", Qty = 1},
                           new MyClass {PO = 1, SKU = "QWE", Qty = 1},
                           new MyClass {PO = 1, SKU = "ASD", Qty = 1},
                           new MyClass {PO = 1, SKU = "ZXC", Qty = 5},
                           new MyClass {PO = 1, SKU = "ERT", Qty = 1},
                           new MyClass {PO = 2, SKU = "QWE", Qty = 1},
                           new MyClass {PO = 2, SKU = "ASD", Qty = 1},
                           new MyClass {PO = 2, SKU = "ZXC", Qty = 5},
                       };
        }
 } 
```

编辑：我已经根据卢克的评论修复了查询

```
var lQuery =
            MyClass.GetList()
                .GroupBy(pArg => pArg.PO)
                .Select(pArg => new
                   {
                       Test = pArg.Select((pArg1, pId) => 
                                          new {ID = (pId / 5), 
                                               pArg1.PO, pArg1.SKU, pArg1.Qty})
                                       .GroupBy(pArg1 => pArg1.ID)
                                       .Select(pArg1 => 
                                               pArg1.Aggregate(pArg.Key.ToString(),
                                                               (pSeed, pCur) => 
                                                               pSeed + pCur.SKU + ","))
                        }); 
```

# asp.net - 为什么 JavaScript 在我的站点上的现有虚拟目录下不起作用？

> ID：1007294
> 
> 赞同：0
> 
> 时间：2009-06-17T14:11:42.167
> 
> 标签：asp.net, javascript, iis, virtual-directory

我在现有的虚拟目录下部署了我的 ASP.NET 应用程序。新部署将具有一些使用 JavaScript 的功能。新功能不起作用。

如果我在新的虚拟目录下部署此构建，则使用 JavaScript 的功能正在运行。

我重新启动了 IIS 管理服务。问题还在继续。

这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:14:00.850

由于 javascript 在客户端而不是在服务器上运行，我怀疑 IIS 本身与您的问题有关。

你做了什么来尝试诊断问题？你看过浏览器和服务器之间的网络交互吗？可能找不到某些脚本文件。

您是否打开了任何调试工具（例如，Firebug 或 IE8 中的 F12 命令）？您可能会遇到您不知道的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:18:07.643

听起来这可能是浏览器上的缓存问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:10:29.410

调用 Javascript 例程的代码是动态生成的吗？如果是这样，它可能是一个路径假设。你的描述很模糊。例如，在 ASP.NET 中，您应该使用“~”来表示应用程序的当前路径。这可能会改变。如果您的代码仅引用“/”或另一个（可能是第二个尝试的路径），那么也许这只是一个糟糕的假设？请提供更多细节。有一百种可能的场景符合您的描述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-03T06:07:10.237

Check the IIS APPLICATION POOL on **IIS Manager** and the project Target Framework on **Visual Studio**

try to match it

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-25T05:02:15.347

```
After the deployment if javascript features are not working then it may be beacuse executes the script which already cached. In this case to handle the situation please do the following 
```

尝试更改 JavaScript 文件的 src？

由此：

对此：

此方法应强制您的浏览器加载 JS 文件的新副本。

# asp.net - 为什么 IIS 对其非安全版本的安全 (SSL) 页面请求使用 302 响应？

> ID：1007301
> 
> 赞同：1
> 
> 时间：2009-06-17T14:12:28.763
> 
> 标签：asp.net, iis, redirect, http-status-code-302

我在服务器的根目录下安装了 SSL。我有一个页面，其代码背后的代码应该在经过某些验证后重定向到安全页面。这是重定向代码：

```
switch (PageBase2.GetParameterValue("Environment")) //Retrieves App Setting named Environment from web.config
            {
                case "Server":
                    strURL = @"https://" + HttpContext.Current.Request.Url.Authority + "/checkout/payment.aspx";
                    break;
                case "Local":
                    strURL = @"http://" + HttpContext.Current.Request.Url.Authority + "/checkout/payment.aspx";
                    break;
                default:
                    strURL = @"https://" + HttpContext.Current.Request.Url.Authority + "/checkout/payment.aspx";
                    break;
            }
            Response.Redirect(strURL, false); 
```

但是 IIS 提供的页面是不安全的。我查看了萤火虫控制台，似乎客户端确实向[https://server/checkout/payment.aspx](https://server/checkout/payment.aspx)发出了 get 请求，但 IIS 以 302 响应[http://server/checkout/payment.aspx](http://server/checkout/payment.aspx) 任何线索，至于可能是什么原因造成的。我什至尝试为页面强制使用 SSL，但它不起作用我收到 403.4 错误。（需要 SSL 才能查看此资源。）如果我删除重定向逻辑并将支付页面编码为在使用 Request.IsSecureConnection 连接不安全时重定向到其 SSL 版本，我最终会出现无休止的重定向循环，仅仅是因为如果没有 302，IIS 仍然无法提供安全版本。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T14:26:06.863

听起来您没有正确配置 IIS，并将 SSL 应用于特定网站。

您可以通过 https 链接尝试访问静态资源、图像或 html 文件来对此进行测试。如果这也重定向，我会查看 IIS 配置。

# delphi - Delphi & Vista 拖动表单故障

> ID：1007303
> 
> 赞同：0
> 
> 时间：2009-06-17T14:12:41.227
> 
> 标签：delphi, windows-vista, border, drag, dock

我想知道您是否有解决Vista中停靠表单问题的方法，例如关闭按钮被部分遮挡，被拖动时的灰色边框渲染极慢，出现出现/消失的外观？

德尔福 2007 和 Vista（64 位）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:22:04.337

我相信你这里有两个不同的错误。

模糊的按钮对我来说是新的。不要以为我见过那个。

第二个错误（调整大小）是一个已知错误，即它在 D2009 中已修复，但有一个解决方案。

我在 JEDI VCL 错误修复报告中发现了它，当我将它应用于我的代码时，它运行良好。 [JEDI 问题跟踪报告](http://issuetracker.delphi-jedi.org/view.php?id=4076)

对于本机 Delphi VCL 对接系统的用户而言，该修复可能并非易事。如果您正在使用第三方对接系统，例如 JEDI VCL 中的 JvDock，它已经得到支持。我在我的一个主要应用程序中实现了它，但我使用的是本地 VCL 对接和第三方组件的混合。

我想向您发布我的解决方案，但我研究了我的代码，它跨越了一堆单元和主代码树的部分。

没有简单的答案，除非您想看看 JEDI 对接系统。

vista 下的 DockingTabs 还存在另一个已知错误，即“停靠”窗口在滑动关闭时的模糊区域无法正确重新绘制。滑出工作正常，滑入（隐藏）也没有解决方案，但它需要修改 VCL 源才能使其工作。

对不起，

瑞安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T16:35:13.207

更新：我研究了对接的 JVCL 实现，我认为它会很好地工作，因为它没有任何问题。再次感谢你的帮助。

# html - 调整窗口大小

> ID：1007305
> 
> 赞同：3
> 
> 时间：2009-06-17T14:12:53.270
> 
> 标签：html

我有一个 html 页面。我想确保如果我调整窗口大小，内容也会调整大小，以免水平滚动。我能做些什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T14:15:00.443

不要使用绝对宽度和高度。改为将所有值设置为百分比。这几乎就是你能做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:46:39.107

[A List Apart中的](http://www.alistapart.com/)[流体网格](http://www.alistapart.com/articles/fluidgrids)是如何设计流体布局的一个很好的例子，即使在使用网格时也是如此。

避免在 CSS 中使用`px`and `pt`(and `cm`, `in`, `mm`, `pc`and )。`ex`尝试使用`em`和`%`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T14:15:04.593

尽量减少使用静态宽度。浏览器将为您完成大部分工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T14:16:34.480

在谷歌中查找液体布局。你会得到很多想法、模板和示例 CSS 来使用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T14:19:47.657

避免使用绝对值。

例如：尝试使用 width="50%" 而不是 width="167px"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T22:04:28.120

除了其他答案中提到的许多流畅布局技术外，还有[CSS3 媒体查询](http://www.w3.org/TR/css3-mediaqueries/)（以及适用于旧浏览器的[“Switchy McLayout”脚本](http://www.alistapart.com/articles/switchymclayout/)），允许您根据屏幕分辨率或窗口大小动态应用不同的 CSS 规则（甚至完全不同的布局） .

# oracle - 只允许 oracle db 登录到特定的应用程序？

> ID：1007308
> 
> 赞同：4
> 
> 时间：2009-06-17T14:13:25.953
> 
> 标签：oracle, security, login, single-sign-on

我们希望仅通过我们自己的应用程序允许我们的用户访问数据库（Oracle） - 我们称之为“ourTool.exe”，安装在用户计算机上本地。目前，用户在启动“ourTool”时必须提供用户名/密码。提供的密码密码被解密，我们使用用户名/解密密码最终登录到 Oracle DB。这种方法可以防止用户使用第三方工具（SQLplus、Excel、Access...）直接访问我们的数据库，并且保证数据库中的所有内容都已使用“ourTool”输入/编辑。

现在，我们的一位客户希望允许其用户“单点登录”（使用 SmartCards/Oracle PKI）。这样，用户每次启动“ourTool”时都可以连接到我们的数据库，而无需提供任何密码。但对于 SQLplus、Excel、Access 等具有潜在危险的工具也是如此。

有没有办法防止这种情况？在这种情况下，我们如何确保仅使用“ourTool”创建/编辑/删除数据库中的每条记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:20:30.853

默认情况下，`OCI`传输调用应用程序`EXE`名称，您可以通过查询访问它`v$session`：

```
SELECT  program
FROM    V$SESSION 
```

，您可以在`AFTER LOGON`触发器中执行此操作。

但这很容易被覆盖，不应依赖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:36:23.643

由于它是您的应用程序并且您可以控制源，因此您可以使用受密码保护的数据库角色或从 ourTool.exe 启用的安全应用程序角色。（参见[http://www.oracle.com/technology/obe/obe10gdb/security/approles/approles.htm](http://www.oracle.com/technology/obe/obe10gdb/security/approles/approles.htm)）。

例如，对于受密码保护的数据库角色，初始连接将仅具有 CREATE SESSION 权限，然后 ourTool.exe 将使用只有您知道的密码发出 SET ROLE。任何其他应用程序都没有设置角色的信息。显然，权限仅授予角色，而不是直接授予此配置中的用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:06:33.210

我将我的 sqlplus.exe 重命名为 myTool.exe 并在与 myTool.exe 建立连接后

```
SELECT  program
FROM    V$SESSION
where username = 'SYSTEM'; 
```

返回：myTool.exe

所以请注意，正如 Quassnoi 所说：虽然在某些情况下可用，但它肯定不是万无一失的。

# c# - unity【依赖】注入与继承

> ID：1007325
> 
> 赞同：10
> 
> 时间：2009-06-17T14:15:30.690
> 
> 标签：c#, inheritance, dependency-injection, unity-container

我的问题如下：我有一个名为 ApplicationController 的基本控制器（ASP.Net MVC 控制器），我希望我的所有控制器都继承自它。这个基本控制器有一个 ILogger 属性，用 [Dependency] 属性标记。（是的，我知道我应该使用构造函数注入，我只是对这个属性感到好奇）。

我创建了容器，注册了类型，更改了默认工厂，一切都很好。问题是当我尝试在派生控制器中使用我的 Logger 属性时，它没有得到解决。

我究竟做错了什么？为什么容器在创建派生控制器时不解析基类依赖？

代码示例：

* * *

应用控制器：

```
public class ApplicationController : Controller
{
    [Dependency]
    protected ILogger _logger { get; set; }

} 
```

派生控制器：

```
public class HomeController : ApplicationController
{
    public HomeController()
    {

    }
    public ActionResult Index()
    {
        _logger.Log("Home controller constructor started.");
        ViewData["Message"] = "Welcome to ASP.NET MVC!";

        return View();
    }

    public ActionResult About()
    {
        return View();
    }
} 
```

Unity控制器工厂：

```
public class UnityControllerFactory : DefaultControllerFactory
{
    private readonly IUnityContainer _container;
    public UnityControllerFactory(IUnityContainer container)
    {
        _container = container;
    }

    protected override IController GetControllerInstance(Type controllerType)
    {
        return _container.Resolve(controllerType) as IController;
    }
} 
```

Global.asax.cs 示例：

```
protected void Application_Start()
    {
        _container = new UnityContainer();
        _container.RegisterType<ILogger, Logger.Logger>();
        UnityControllerFactory factory = new UnityControllerFactory(_container);
        ControllerBuilder.Current.SetControllerFactory(factory);

        RegisterRoutes(RouteTable.Routes);
    } 
```

* * *

我对 Unity 很陌生，所以也许我做错了什么。

谢谢，阿米。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-17T14:48:41.873

AFAIK，Unity 只会解析公共属性。因此，您的受保护财产将不会得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:37:46.870

我不确定这是否相关，但通常，我避免使用名称相同的名称空间和类（在你的情况下，Logger.Logger），因为我过去遇到过这个问题。但这可能不是问题。

我也不确定 [Dependency] 属性是否适用于派生类型。如果将其更改为构造函数注入，这仍然不起作用吗？就像是：

```
public class ApplicationController : Controller
{
    protected ILogger _logger { get; set; }

    public ApplicationController(ILogger logger)
    {
         this._logger = logger;

    }
} 
```

和

```
public class HomeController : ApplicationController
{
    public HomeController(ILogger logger) : base(logger)
    {

    }
    public ActionResult Index()
    {
        _logger.Log("Home controller constructor started.");
        ViewData["Message"] = "Welcome to ASP.NET MVC!";

        return View();
    }

    public ActionResult About()
    {
        return View();
    }
} 
```

其余的都一样。代码看起来没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:39:23.530

我对统一也相当缺乏经验，但我认为您需要将 HomeController 注册到 contsaner，而不是记录器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-21T06:42:18.330

我有同样的问题，并通过将 ILogger 更改为 public 来解决它。这是 VS2010 中的 ASP.NET MVC2 项目，.NET 4。从逻辑上讲，这是有道理的，因为 Unity 没有创建代理类或任何东西，它只是设置它可以访问的属性，并具有一个映射 -因此只公开。

# c - 使用openssl加密和解密一个小文件

> ID：1007337
> 
> 赞同：26
> 
> 时间：2009-06-17T14:19:48.623
> 
> 标签：c, openssl

我想用 C/C++ 编写一个小程序，它读取一个小文本文件，并使用“内部”密钥对其进行加密。然后我还想编写另一个小程序，它可以在内部使用相同的密钥解密加密文件。

我查看了 openSSL 站点并用谷歌搜索，但发现不是简单的例子，有人试过做这件事吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-18T06:09:37.607

理想情况下，您可以使用现有的工具，例如`ccrypt`，但这里是：

```
#include <openssl/aes.h>

/* ... */

{
  int bytes_read, bytes_written;
  unsigned char indata[AES_BLOCK_SIZE];
  unsigned char outdata[AES_BLOCK_SIZE];

  /* ckey and ivec are the two 128-bits keys necesary to
     en- and recrypt your data.  Note that ckey can be
     192 or 256 bits as well */
  unsigned char ckey[] =  "thiskeyisverybad";
  unsigned char ivec[] = "dontusethisinput";

  /* data structure that contains the key itself */
  AES_KEY key;

  /* set the encryption key */
  AES_set_encrypt_key(ckey, 128, &key);

  /* set where on the 128 bit encrypted block to begin encryption*/
  int num = 0;

  while (1) {
    bytes_read = fread(indata, 1, AES_BLOCK_SIZE, ifp);

    AES_cfb128_encrypt(indata, outdata, bytes_read, &key, ivec, &num,
           AES_ENCRYPT);

    bytes_written = fwrite(outdata, 1, bytes_read, ofp);
    if (bytes_read < AES_BLOCK_SIZE)
  break;
  }
} 
```

解密是通过调用`AES_cfb128_encrypt`with`AES_DECRYPT`作为最后一个参数来完成的。请注意，此代码只提供了最基本的测试，并且您确实应该为 ckey 和 ivec 使用适当的 8 位随机数据​​。

**编辑**：它似乎`AES_cfb128_encrypt`接受任意长度的数据，因此您不需要以`AES_BLOCK_SIZE`(16) 字节的块进行加密。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-18T13:39:21.623

以前的答案已向您指出如何按照您的要求进行操作。

我想补充一下为什么*你可能不应该这样做*。

您所说的称为“对称加密”（相同的密钥用于加密和解密，而不是非对称加密，使用一个密钥加密的所有内容只能由特定的对应方解密）。

反汇编可执行文件以确定正在使用的硬编码密钥几乎是微不足道的。这意味着，任何人只要掌握了您的一个可执行文件，就可以破解任何曾经交换过的消息的加密。

除非您想到的应用程序非常具体，否则这意味着您的设置可能“看起来”安全，但实际上并非如此。在这些情况下，通常最好根本不加密，以免相关人员陷入这种虚假的安全感……

您正在寻找标准库来进行加密非常好（而不是自己实现/创建算法），但是*协议*（*如何*使用和交换应用程序、密钥和消息）至少与密码本身一样重要。您可能希望让从事密码学的人测试您的想法，以告诉您其中的弱点。（我敢肯定 StackOverflow 有足够的这种类型。;-)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:14:06.157

OpenSSL 特别关注实现 SSL 和 TLS，它们是通过网络加密数据的协议。由于您只是想加密文件，因此可以使用 OpenSSL，但并不理想。

相反，我会使用[BeeCrypt](http://sourceforge.net/projects/beecrypt)或[Crypto++® Library 5.6.0](http://www.cryptopp.com/)之类的东西，它们都提供了使用示例。

# javascript - JavaScript 函数别名似乎不起作用

> ID：1007340
> 
> 赞同：89
> 
> 时间：2009-06-17T14:20:09.153
> 
> 标签：javascript, function, closures, alias

我只是在阅读[这个问题](https://stackoverflow.com/questions/954417/make-alias-to-document-getelementbyid-in-javascript)并想尝试使用别名方法而不是函数包装方法，但我似乎无法让它在 Firefox 3 或 3.5beta4 或 Google Chrome 中工作，无论是在他们的调试窗口和在测试网页中。

萤火虫：

```
>>> window.myAlias = document.getElementById
function()
>>> myAlias('item1')
>>> window.myAlias('item1')
>>> document.getElementById('item1')
<div id="item1"> 
```

如果我把它放在一个网页中，对 myAlias 的调用会给我这个错误：

```
uncaught exception: [Exception... "Illegal operation on WrappedNative prototype object" nsresult: "0x8057000c (NS_ERROR_XPC_BAD_OP_ON_WN_PROTO)" location: "JS frame :: file:///[...snip...]/test.html :: <TOP_LEVEL> :: line 7" data: no] 
```

Chrome（为了清楚起见插入了>>>）：

```
>>> window.myAlias = document.getElementById
function getElementById() { [native code] }
>>> window.myAlias('item1')
TypeError: Illegal invocation
>>> document.getElementById('item1')
<div id=?"item1">? 
```

在测试页面中，我得到相同的“非法调用”。

难道我做错了什么？其他人可以重现这个吗？

另外，奇怪的是，我刚刚尝试过，它在 IE8 中工作。

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2009-07-21T23:00:27.317

我深入研究以了解这种特殊行为，并且我认为我找到了一个很好的解释。

在我解释为什么你不能使用 alias 之前`document.getElementById`，我将尝试解释 JavaScript 函数/对象是如何工作的。

每当您调用 JavaScript 函数时，JavaScript 解释器都会确定一个范围并将其传递给该函数。

考虑以下功能：

```
function sum(a, b)
{
    return a + b;
}

sum(10, 20); // returns 30; 
```

此函数在 Window 范围内声明，当您调用它时，`this`sum 函数内部的值将是全局`Window`对象。

对于 'sum' 函数，'this' 的值是什么并不重要，因为它没有使用它。

* * *

考虑以下功能：

```
function Person(birthDate)
{
    this.birthDate = birthDate;    
    this.getAge = function() { return new Date().getFullYear() - this.birthDate.getFullYear(); };
}

var dave = new Person(new Date(1909, 1, 1)); 
dave.getAge(); //returns 100. 
```

当您调用 dave.getAge 函数时，JavaScript 解释器会看到您正在对`dave`对象调用 getAge 函数，因此它会设置`this`并`dave`调用该`getAge`函数。`getAge()`将正确返回`100`。

* * *

您可能知道在 JavaScript 中您可以使用`apply`方法指定范围。让我们试试看。

```
var dave = new Person(new Date(1909, 1, 1)); //Age 100 in 2009
var bob = new Person(new Date(1809, 1, 1)); //Age 200 in 2009

dave.getAge.apply(bob); //returns 200. 
```

在上面的行中，不是让 JavaScript 决定范围，而是手动将范围作为`bob`对象传递。即使您“认为”您调用了该对象，`getAge`现在也会返回。`200``getAge``dave`

* * *

以上所有内容有什么意义？函数“松散地”附加到您的 JavaScript 对象上。例如你可以做

```
var dave = new Person(new Date(1909, 1, 1));
var bob = new Person(new Date(1809, 1, 1));

bob.getAge = function() { return -1; };

bob.getAge(); //returns -1
dave.getAge(); //returns 100 
```

* * *

让我们进行下一步。

```
var dave = new Person(new Date(1909, 1, 1));
var ageMethod = dave.getAge;

dave.getAge(); //returns 100;
ageMethod(); //returns ????? 
```

`ageMethod`执行抛出错误！发生了什么？

如果您仔细阅读我的上述观点，您会注意到该`dave.getAge`方法是`dave`作为`this`对象调用的，而 JavaScript 无法确定`ageMethod`执行的“范围”。所以它通过全局'Window'作为'this'。现在由于`window`没有`birthDate`属性，`ageMethod`执行将失败。

如何解决这个问题？简单的，

```
ageMethod.apply(dave); //returns 100. 
```

* * *

以上所有内容都有意义吗？如果是这样，那么您将能够解释为什么您无法使用别名`document.getElementById`：

```
var $ = document.getElementById;

$('someElement'); 
```

`$`用`window`as调用，`this`如果`getElementById`实现是`this`，`document`它将失败。

再次解决这个问题，你可以做

```
$.apply(document, ['someElement']); 
```

那么为什么它可以在 Internet Explorer 中运行呢？

我不知道`getElementById`IE 中的内部实现，但是 jQuery 源代码（`inArray`方法实现）中的注释说在 IE 中，`window == document`. 如果是这种情况，那么别名`document.getElementById`应该在 IE 中工作。

为了进一步说明这一点，我创建了一个详细的示例。看看`Person`下面的函数。

```
function Person(birthDate)
{
    var self = this;

    this.birthDate = birthDate;

    this.getAge = function()
    {
        //Let's make sure that getAge method was invoked 
        //with an object which was constructed from our Person function.
        if(this.constructor == Person)
            return new Date().getFullYear() - this.birthDate.getFullYear();
        else
            return -1;
    };

    //Smarter version of getAge function, it will always refer to the object
    //it was created with.
    this.getAgeSmarter = function()
    {
        return self.getAge();
    };

    //Smartest version of getAge function.
    //It will try to use the most appropriate scope.
    this.getAgeSmartest = function()
    {
        var scope = this.constructor == Person ? this : self;
        return scope.getAge();
    };

} 
```

对于上述`Person`函数，以下是各种`getAge`方法的行为方式。

`Person`让我们使用函数创建两个对象。

```
var yogi = new Person(new Date(1909, 1,1)); //Age is 100
var anotherYogi = new Person(new Date(1809, 1, 1)); //Age is 200 
```

* * *

```
console.log(yogi.getAge()); //Output: 100. 
```

直截了当，getAge 方法获取`yogi`对象作为`this`并输出`100`。

* * *

```
var ageAlias = yogi.getAge;
console.log(ageAlias()); //Output: -1 
```

JavaScript解释器将`window`对象设置为`this`，我们的`getAge`方法将返回`-1`。

* * *

```
console.log(ageAlias.apply(yogi)); //Output: 100 
```

如果我们设置正确的范围，你可以使用`ageAlias`方法。

* * *

```
console.log(ageAlias.apply(anotherYogi)); //Output: 200 
```

如果我们传入一些其他人对象，它仍然会正确计算年龄。

```
var ageSmarterAlias = yogi.getAgeSmarter;    
console.log(ageSmarterAlias()); //Output: 100 
```

该`ageSmarter`函数捕获了原始`this`对象，因此现在您不必担心提供正确的范围。

* * *

```
console.log(ageSmarterAlias.apply(anotherYogi)); //Output: 100 !!! 
```

问题`ageSmarter`是您永远无法将范围设置为其他对象。

* * *

```
var ageSmartestAlias = yogi.getAgeSmartest;
console.log(ageSmartestAlias()); //Output: 100
console.log(ageSmartestAlias.apply(document)); //Output: 100 
```

`ageSmartest`如果提供了无效范围，该函数将使用原始范围。

* * *

```
console.log(ageSmartestAlias.apply(anotherYogi)); //Output: 200 
```

您仍然可以将另一个`Person`对象传递给`getAgeSmartest`. :)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-06-17T14:35:29.387

您必须将该方法绑定到文档对象。看：

```
>>> $ = document.getElementById
getElementById()
>>> $('bn_home')
[Exception... "Cannot modify properties of a WrappedNative" ... anonymous :: line 72 data: no]
>>> $.call(document, 'bn_home')
<body id="bn_home" onload="init();"> 
```

当你做一个简单的别名时，这个函数是在全局对象上调用的，而不是在文档对象上。使用一种称为闭包的技术来解决这个问题：

```
function makeAlias(object, name) {
    var fn = object ? object[name] : null;
    if (typeof fn == 'undefined') return function () {}
    return function () {
        return fn.apply(object, arguments)
    }
}
$ = makeAlias(document, 'getElementById');

>>> $('bn_home')
<body id="bn_home" onload="init();"> 
```

这样您就不会失去对原始对象的引用。

2012 年，`bind`来自 ES5 的新方法允许我们以更奇特的方式做到这一点：

```
>>> $ = document.getElementById.bind(document)
>>> $('bn_home')
<body id="bn_home" onload="init();"> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-02-03T17:55:28.180

这是一个简短的答案。

以下是该函数的副本（引用）。问题是，当函数`window`被设计为存在于对象上时，它现在位于对象上`document`。

```
window.myAlias = document.getElementById 
```

替代方案是

*   使用包装器（Fabien Ménager 已经提到过）
*   或者您可以使用两个别名。

    ```
    window.d = document // A renamed reference to the object
    window.d.myAlias = window.d.getElementById 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-03T10:06:34.433

另一个简短的答案，仅用于包装/别名`console.log`和类似的日志记录方法。他们都希望在`console`上下文中。

这在使用一些后备包装时很有用，以防您或您的用户在[使用不（总是）支持它的浏览器](https://stackoverflow.com/questions/8095348/website-with-js-doesnt-work-in-ie9-until-the-developer-tools-is-activated)`console.log`时遇到麻烦。但是，这并不是该问题的完整解决方案，因为它需要扩展检查和后备 - 您的里程可能会有所不同。

使用警告的示例

```
var warn = function(){ console.warn.apply(console, arguments); } 
```

然后照常使用

```
warn("I need to debug a number and an object", 9999, { "user" : "Joel" }); 
```

如果您希望看到包含在数组中的日志记录参数（我经常这样做），请替换[`.apply(...)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)为[`.call(...)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call).

应该与`console.log()`, `console.debug()`, `console.info()`, `console.warn()`,一起使用`console.error()`。另请参阅[`console`MDN](https://developer.mozilla.org/en/Error_Console)。

[控制台](/questions/tagged/console "显示标记为“控制台”的问题") [萤火虫](/questions/tagged/firebug "显示标记为“萤火虫”的问题")

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T04:23:40.403

除了其他很好的答案之外，还有简单的 jQuery 方法[$.proxy](http://api.jquery.com/jQuery.proxy/)。

你可以这样别名：

```
myAlias = $.proxy(document, 'getElementById'); 
```

或者

```
myAlias = $.proxy(document.getElementById, document); 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-06-29T17:44:28.290

您实际上*不能*在预定义对象上“纯别名”函数。因此，在不进行包装的情况下，最接近别名的方法是保持在同一个对象内：

```
>>> document.s = document.getElementById;
>>> document.s('myid');
<div id="myid"> 
```

# iphone - 从 Settings.bundle plists 中提取本地化字符串

> ID：1007342
> 
> 赞同：3
> 
> 时间：2009-06-17T14:20:58.013
> 
> 标签：iphone, cocoa-touch, localization, internationalization, settings.bundle

如果您在 Settings.bundle 中构建子窗格，您最终会得到几个 .plist 文件。当需要本地化您的项目时，您会发现创建相应的 .strings 文件有点乏味（我知道我会这样做）。

这是一个方便的列表 bash 脚本，它将 (i) 查找标签，(ii) 提取以下标签的内容，然后 (iii) 将该值输出到 ibtool 所需的 "string" = "string" 格式的文本文件.

您将输入和输出文件名作为参数传递。

```
#!/bin/sh
echo "// Generated by plist2strings. Manual edits will be overwritten the next time this script runs.\n/* A single strings file, whose title is specified in your preferences schema. The strings files provide the localized content to display to the user for each of your preferences. */\n" > plist2stringstmp
sed -n '
# look for a "#" at the end of the line
/<key>Title<\/key>$/ {
# Found one - now read in the next line
 N
# delete the "#" and the new line character, 
 s/.*<\(string\)>\(.*\)<\/\1>/"\2" = "\2"/gp
}' $1 > plist2stringstmp2
cat plist2stringstmp plist2stringstmp2 > $2
rm plist2stringstmp plist2stringstmp2 
```

复制-N-粘贴到文本文件中。我将我的保存为 plist2strings。一定要给它执行权限。例如，在终端执行：

```
macbook:~ foo$ chmod 755 plist2strings 
```

要从 Settings.bundle 目录的根目录执行脚本（如果保存到您的用户文件夹），只需使用以下语法：

```
macbook:~ foo$ ~/plist2strings mysettings.plist en.lprog/mysettings.strings 
```

如果该文件夹中尚不存在 mysettings.strings，它将创建它。如果它*已经*存在，它将自动覆盖它而不会发出警告。

希望有人觉得这很有用。并且随意使用（和滥用）你认为合适的（警告购买者;-）。如果您做出任何有用的更改，请考虑将它们发回此处以供其他人欣赏。

快乐本地化！

~ 扎克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-06-07T15:32:46.043

我使用这个更好的快速修复版本（它只是删除重复项）。

```
#!/bin/sh
echo "// Generated by plist2strings. Manual edits will be overwritten the next time this script runs.\n/* A single strings file, whose title is specified in your preferences schema. The strings files provide the localized content to display to the user for each of your preferences. */\n" > plist2stringstmp
sed -n '
# look for a "#" at the end of the line
/<key>Title<\/key>$/ {
# Found one - now read in the next line
 N
# delete the "#" and the new line character, 
 s/.*<\(string\)>\(.*\)<\/\1>/"\2" = "\2"/gp
}' $1 > plist2stringstmp2
cat plist2stringstmp2 | sort | uniq > tmp
cat plist2stringstmp2 >> plist2stringstmp 
mv plist2stringstmp $2
rm plist2stringstmp2 
```

TODO：从标题数组中提取字符串，如下所示：

```
<key>Titles</key>
            <array>
                <string>STH</string>
                <string>STH2</string>
                <string>STH3</string>
            </array> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-23T21:11:25.137

这是一种旧思路。不过，感谢 OP Zack，我使用原始脚本已经有一段时间了。

我决定编辑脚本以从标题数组中提取字符串，如 Descent89 所建议的那样。

此外，通过使用 2addr sed 语法，它现在更具可读性。我的版本不排序也不删除重复项，因为使用 Titles Arrays，保持字符串顺序很有用。

这里是 ：

```
#!/bin/sh
echo "// Generated by plist2strings. Manual edits will be overwritten the next time this script runs.\n/* A single strings file, whose title is specified in your preferences schema. The strings files provide the localized content to display to the user for each of your preferences. */\n\n/* String for Title elements */" > $2

sed -n '/<key>Title<\/key>$/,/<\/string>$/ s/.*<\(string\)>\(.*\)<\/\1>/"\2" = "\2";/gp' $1 >> $2

echo "\n/* String for Titles arrays elements */" >> $2

sed -n '/<key>Titles<\/key>$/,/<\/array>$/ s/.*<\(string\)>\(.*\)<\/\1>/"\2" = "\2";/gp' $1 >> $2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:27:01.010

仅供参考，您最终可能会在这里或那里得到一些重复的字符串。如果有人感到有动力，很高兴看到 (a) 重复检查，和/或 (b) 合并现有文件的结果。

# sql-server - 学习 SSIS 的最佳起点

> ID：1007345
> 
> 赞同：8
> 
> 时间：2009-06-17T14:22:13.860
> 
> 标签：sql-server, ssis

开始学习 SQL Server 2005 集成服务的最佳地点是什么？

我正在寻找有关如何开始的设置和教程的链接。我读过我需要一个名为 SSIS 设计器的工具包，但是我无法在 SQL Server Enterprise ed dvd 上找到它，也无法在任何地方在线找到它。我确实在各种论坛中遇到了一些链接，但它们现在已损坏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T14:28:15.953

您使用的是什么版本的 SQL Server？如果您使用的是 SQL Server 2000，那么您就不走运了：那时 SSIS 还不存在，您不想*知道*.

SSIS 足够丰富和复杂，我不推荐“教程”。恐怕我不得不推荐你读一本书（并遵循练习！）。教会我的是[Microsoft® SQL Server(TM) 2005 Integration Services Step by Step](https://rads.stackoverflow.com/amzn/click/com/0735624054)。

您想从 SQL Server DVD 安装 Business Intelligence Studio。如果您还没有 Visual Studio，它会安装它，并且还会安装在 SSIS 中开发所需的模板和工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T19:37:01.693

我在[SSIS Junkie](http://blogs.conchango.com/jamiethomson/ "SSIS 瘾君子") ( [http://blogs.conchango.com/jamiethomson/](http://blogs.conchango.com/jamiethomson/) ) 找到了很多很好的信息。

MS 有一些有趣[的网络广播](http://www.microsoft.com/events/series/bi.aspx?tab=webcasts&id=42664 "微软网络广播")。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:24:16.587

[我喜欢http://www.accelebrate.com/sql_training/ssis_tutorial.htm](http://www.accelebrate.com/sql_training/ssis_tutorial.htm)上写得很好的教程， 试试看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T16:20:46.867

我建议你看看 SQLIS.com，它是由一些 SSIS 专家编写的一个很棒的网站。有许多博客，我们在 SQLServerCentral.com 上有一些文章，但不确定我们是否有一个好的“入门”系列。

PragmaticWorks 做了很多 SSIS，我已经开始在他们的博客上看到一些关于各种任务的细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:10:09.893

一旦你掌握了基础知识，本教程/示例将展示如何使用循环、变量和表达式来做一些很酷的事情： [http ://www.sqlmag.com/Articles/ArticleID/95385/pg/3/3.html](http://www.sqlmag.com/Articles/ArticleID/95385/pg/3/3.html)

该示例旨在管理和监视，但可以应用于许多事情。

看起来它现在只是订阅者，但你可以获得源。

简而言之，您将服务器名称存储为一个表，将它们放在一个“对象”变量中，然后循环遍历它们执行您想要的任何操作。

您与“源服务器”的连接会根据您在属性窗口中定义的表达式而改变。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T16:32:17.407

如果您正在从事商业智能项目，我建议您参考[www.SQLBI.com](http://www.SQLBI.com)的白皮书。如果您了解标准 BI 实践的基本术语，这将提供一组很好的最佳实践。如果您刚刚开始，它可能会有点复杂。

我还发现 vconferenceonline/SSWUG ( [http://www.vconferenceonline.com/shows/summer09/uvc/sessions.asp?id=2](http://www.vconferenceonline.com/shows/summer09/uvc/sessions.asp?id=2) ) 提供的视频培训非常有用。不是免费的 - 但相对便宜。

# java - 如何在 NetBeans 中创建我的项目的 war 文件？

> ID：1007346
> 
> 赞同：45
> 
> 时间：2009-06-17T14:22:15.437
> 
> 标签：java, jsp, netbeans

如何在 NetBeans 中创建我的项目的 war 文件？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-18T15:04:30.857

您可能已经有一个war 文件并且不知道它——netbeans 为您完成了大部分工作，我相信它会默认创建一个可分发的war 文件。如果您创建了一个 Web 项目并成功构建它，它将位于项目根目录下的“dist”目录中。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-09-16T18:33:53.910

正如 DPA 所说，生成项目的 war 文件的最简单方法是通过 IDE。从左侧面板中打开 Files 选项卡，右键单击 build.xml 文件并告诉它您要运行哪种类型的 ant 目标。

![NetBeans - 创建 WAR 文件](../Images/9a620f8f5430372d38ec1291faabe2e7.png)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-11-27T21:13:56.343

右键单击您的项目，点击“清理并构建”。Netbeans 完成其余的工作。

在您的应用程序的**dist**目录下，您应该会找到一个漂亮的 .war 文件，一切都已准备好部署。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-17T15:17:44.527

Netbeans 将为您创建 Ant 脚本，无论如何它都使用 Ant 来构建。但是，如果您想获取战争文件，只需构建您的项目。.war 文件将位于 /yournetbeanshomedirectory/yourproject/dist/yourwar.war

您可以通过查看项目目录中的 build.xml 文件来检查它使用的 ant 构建脚本。可能会帮助您感觉更舒适地使用 ant 进行构建。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-09-05T12:49:56.443

**这对我有用：**

1.右键 pom.xml
2.运行 Maven > 目标 3.
编辑 maven 目标

[![在此处输入图像描述](../Images/15f0d13333dc16cbdc7c3ba498aff8cc.png)](https://i.stack.imgur.com/2vnyJ.jpg)

[![编辑 Maven 目标](../Images/6dee54ac882aaf479366a196eef2cce1.png)](https://i.stack.imgur.com/fBNPC.jpg)

结果：在 /target 文件夹中构建战争

```
 Packaging webapp
    Assembling webapp [WeatherDashboard] in [C:\Users\julian.mojico\Documents\NetBeansProjects\WeatherDashboard\target\WeatherDashboard-1.0-SNAPSHOT]
    Processing war project
    Webapp assembled in [672 msecs]
    Building war: C:\Users\julian.mojico\Documents\NetBeansProjects\WeatherDashboard\target\WeatherDashboard-1.0-SNAPSHOT.war
    ------------------------------------------------------------------------
    BUILD SUCCESS
    ------------------------------------------------------------------------
    Total time: 1:41.633s
    Finished at: Tue Sep 05 09:41:27 ART 2017
    Final Memory: 18M/97M
    ------------------------------------------------------------------------ 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-03-29T13:11:01.407

我必须右键单击 build.xml 文件并选择“运行”。只有这样才会创建 .war 文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-27T01:04:21.390

如果 NetBeans 尚未创建您的`dist`文件夹，请执行`do-dist`ant 目标：

```
In commandline navigate to the directory of your project, the one containing a build.xml file
> ant do-dist 
```

如果 ant 运行良好（很可能），您的`dist`文件夹将被创建，其中包含该`.war`文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-15T20:36:38.560

只需检查您的项目属性>构建->打包 WAR 文件压缩。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-07T11:35:46.043

最简单的方法是检查输出 - 构建选项卡：它将显示战争文件的位置。
它会有类似的东西：

将 D:\Project\target\Tool.war 安装到 C:\Users\myname.m2\repository\com\tool\1.0\Tool-1.0.war

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-09T13:25:46.930

它位于项目内部的 dist 文件夹中，但前提是选中项目设置对话框（构建/打包）中的“压缩 WAR 文件”。在我选中此复选框之前，没有 dist 文件夹。

# websphere - WebSphere app server 7.0 GUI 管理控制台和 MBean

> ID：1007347
> 
> 赞同：0
> 
> 时间：2009-06-17T14:22:16.590
> 
> 标签：websphere, mbeans

我是 WAS 新手，目前正在使用 WAS 7.0 我在 WAS 中部署的应用程序在启动时会注册一些 MBean，我想知道如何从管理控制台（GUI）监视/获取与这些注册的 MBean 相关的信息曾是。我在管理控制台中看到了许多选项，但是很困惑在哪里可以找到与应用程序启动时在 WAS JMX 基础结构中注册的 MBean 相关的信息？还是只能以编程方式获得它？如果你能推荐一些资源，会有所帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-07T14:58:59.637

您可以通过以下任一方式访问您已注册的这些 mbean：

1.  JConsole - 连接到 WAS 有点棘手，这是我运行它的批处理：
    echo URL 连接字符串是：service:jmx:iiop://you-hostname-here:2809/jndi/JMXConnector

    设置 JAVA_HOME=C:\Progra~1\IBM\SDP\jdk
    设置 CLASSPATH=%CLASSPATH%;%JAVA_HOME%\lib\jconsole.jar
    设置 CLASSPATH=%CLASSPATH%;tools.jar;com.ibm.ws.admin。 client_7.0.0.jar
    "C:\Program Files\IBM\SDP\jdk\bin\jconsole.exe" -J-Djava.class.path=%CLASSPATH%

2.  WSAdmin 脚本 - 示例：
    beanNameString = AdminControl.queryNames('type=youMbeanName,*')
    print AdminControl.getAttribute(beanNameString, 'someAttribute')
    AdminControl.invoke(beanNameString, 'someMethod', 'parameter1')

3.  以编程方式。
    我会把这个留给你:)

# c++ - Sitelock 女士 1.15 和 VS 2005

> ID：1007348
> 
> 赞同：0
> 
> 时间：2009-06-17T14:22:17.870
> 
> 标签：c++, security, visual-studio-2005, activex

我正在尝试将 MS Sitelock 模板实现到我的一个 Active-X 控件中。我已经下载了 sitelock 1.15 sdk，但我一直坚持第一步。

包含 sitelock.h 头文件会导致一堆与 sal.h 头文件有关的编译错误。在我看来，sitelock.h 想要使用属性 sal，但 sal.h 只是定义 declspec sal。我使用的是 VS 2005，但 sitelock 1.5 文档说支持 VS 2005。我需要做些什么来引用属性 sal 吗？我确实安装了 Vista 平台 sdk。我将 sitelock.h 包含在我的 active-x 对象的头文件中。也许那不是这样做的地方？

请参阅下面的编译错误：

....\public\sitelock.h(308)：错误 C2061：语法错误：标识符“_In_opt_count_”

```
 ..\..\public\sitelock.h(605) : see reference to class template instantiation 'CSiteLock<T>' being compiled 
```

\public\sitelock.h(308)：错误 C2059：语法错误：')'

...\public\sitelock.h(310)：错误 C2143：语法错误：在 '{' 之前缺少 ')'

...\public\sitelock.h(401)：错误 C2061：语法错误：标识符“_In_z_”

..\public\sitelock.h(401)：错误 C2059：语法错误：')'

..\public\sitelock.h(402)：错误 C2143：语法错误：在 '{' 之前缺少 ')'

C2061：语法错误：标识符 '_Inout_z_count_' ....\public\sitelock.h(451)：错误 C2059：语法错误：')'

...\public\sitelock.h(452)：错误 C2143：语法错误：在 '{' 之前缺少 ')'

..\public\sitelock.h(520)：错误 C2061：语法错误：标识符“_In_z_”

..\public\sitelock.h(520)：错误 C2059：语法错误：')'

...\public\sitelock.h(521)：错误 C2143：语法错误：在 '{' 之前缺少 ')'

...\public\sitelock.h(555)：错误 C2061：语法错误：标识符 '_In_z_'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T17:45:02.010

新的 SAL.H 包含在 Windows server 2008 SDK 中，而不是 Vista 中。

我仍在使用 Vista SDK，并且通过将属性 sal 宏转换为 sitelock.h 中的 declspec sal 宏，我的编译器错误得到了解决。

使用以下网址中的注释进行翻译：http: [//blogs.msdn.com/sdl/archive/2009/06/11/a-declspec-sal-to-attribute-sal-rosetta-stone.aspx](http://blogs.msdn.com/sdl/archive/2009/06/11/a-declspec-sal-to-attribute-sal-rosetta-stone.aspx)

# wpf - 组合框打开时从 ObjectDataProvider 获取数据

> ID：1007357
> 
> 赞同：0
> 
> 时间：2009-06-17T14:23:30.160
> 
> 标签：wpf, data-binding, combobox, objectdataprovider

每次扩展组合框而不是仅一次时，如何让 ObjectDataProvider 被触发？

```
<UserControl.Resources>
    <ObjectDataProvider x:Key="possibleExpressionValues"
                MethodName="GetWatchVariableNames" 
                ObjectType="{x:Type mu:UserInterfaceHelper}" IsInitialLoadEnabled="False">
    </ObjectDataProvider>
</UserControl.Resources>

<Grid>
    <ComboBox IsEditable="True" Text="{Binding ID}" ItemsSource="{Binding Source={StaticResource possibleExpressionValues}}" VerticalAlignment="Top" />
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:12:24.227

随着 ObjectDataProvider 被触发，你的意思是你想创建一个新的 UserInterfaceHelper 对象吗？

在这种情况下，将组合框的 DropDownOpened 事件连接到以下方法。

```
private void ComboBox_DropDownOpened(object sender, EventArgs e)
{
  ObjectDataProvider odp = Resources["possibleExpressionValues"] as ObjectDataProvider;
  odp.ObjectType = null;
  odp.ObjectInstance = new UserInterfaceHelper();
} 
```

# c# - 带有 caml 和 xslt 的 sharepoint webpart

> ID：1007363
> 
> 赞同：1
> 
> 时间：2009-06-17T14:24:18.410
> 
> 标签：c#, sharepoint, xslt, web-parts, caml

我如何创建一个访问列表的共享点 webpart，并且可以应用 CAML。

需要 CAML 来显示仅返回具有“位置”> 0 字段的列表项

我还需要 webpart 来应用 xslt。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:36:29.387

您需要将内容查询 Web 部件添加到您的页面（注意：需要 MOSS 而不是免费的 WSS）。这允许您查询数据并对其应用 XSL 转换。

Web 部件允许您查询特定的网站集、网站或列表。然后，您可以设置参数以返回特定类型的数据并应用过滤器、排序和分组。您还可以选择您希望数据以何种方式显示给最终用户，作为选项的下拉列表显示。这些选项中的每一个都由 XSL 转换提供支持。

[Heather Solomon 的这篇博客文章](http://www.heathersolomon.com/blog/articles/customitemstyle.aspx)是帮助您开始如何创建自己的转换和配置 CQWP 的最佳资源之一。它还解释了如何确保您需要的所有字段都传递到 XSLT（默认情况下，这只发生在一小部分子集中）。

**更新：**

要仅返回字段“Position”> 0 的列表项，在 XSLT 中也是最简单的方法。您必须已将 Position 字段添加到 CommonViewFields，以便将其传递到 XSLT。然后在您的自定义项目样式中（如果您关注 Heather 的帖子，则在 ItemStyle.xsl 中），添加以下内容：

```
<xsl:if test="@Position &gt; 0">
  <!-- Display desired row output -->
</xsl:if> 
```

当“位置”<= 0 时，这会隐式忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:24:42.197

我同意 Alex 的观点，即内容查询 Web 部件 (CQWP) 是可行的方法。

但是，如果您想进入代码，您可以执行以下操作。粗略的部分是将其转换为 XML，尽管可能有一种简单的方法可以将其转换为一些非自定义（尽管丑陋）的 XML 形式。

```
SPList list = web.Lists["My List Name"];
SPView view = list.Views["My View Name"];  // This view would define Postion > 0
SPQuery query = new SPQuery(view);
SPListItemCollection items = list.GetItems(query);

// Iterate through results and generate XML 
```

如果您不想使用现有视图，则需要手动设置 SPQuery 对象；将其 ViewFields、Query 和 RowLimit 设置为最小值。您可以使用[CAML 查询工具](http://msdn.microsoft.com/en-us/library/dd239302.aspx)来帮助您解决此问题。

# linux - 在 linux 中：写入 FIFO

> ID：1007367
> 
> 赞同：1
> 
> 时间：2009-06-17T14:25:17.300
> 
> 标签：linux, unix, shell, fifo

`mkfifo`我使用该命令创建了一个新的 FIFO 。我有一个文本文件`f.txt`。我想将文本文件写入我的 FIFO。如何？有没有一个unix命令呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T14:33:23.323

您可以使用`cat`：

```
mkfifo /tmp/foo
cat f.txt > /tmp/foo 
```

您会看到它挂起，因为您还需要一个阅读器进程，如`cat`.

```
cat /tmp/foo 
```

您也可以先启动读取器进程，然后启动写入器进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T14:28:47.357

只需重定向到管道：

```
mkfifo /tmp/pipe
cat f.txt > /tmp/pipe &
cat /tmp/pipe 
```

请注意，这大致是做什么`cat f.txt | cat`的，但这是一个命名管道而不是匿名管道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T14:30:00.177

与我认为的任何文件相同：

```
cat f.txt > myfifo 
```

大多数东西都可以像 Linux/Unix 中的文件一样对待

# scala - 在 Scala 中同时处理

> ID：1007371
> 
> 赞同：8
> 
> 时间：2009-06-17T14:26:00.717
> 
> 标签：scala, concurrency, actor

正如[我自己对自己问题的回答](https://stackoverflow.com/questions/1007010/can-scala-actors-process-multiple-messages-simultaneously/1007310#1007310)一样，我遇到了一种情况，即我正在处理大量到达队列的事件。每个事件都以完全相同的方式处理，甚至可以独立于所有其他事件进行处理。

我的程序利用了 Scala 并发框架，其中涉及的许多进程都被建模为`Actor`s。由于`Actor`s 顺序处理他们的消息，因此它们不太适合这个特定问题（即使我的*其他参与者**正在*执行顺序操作）。由于我希望 Scala 能够“控制”所有线程创建（我认为这是它首先具有并发系统的关键），因此我似乎有两个选择：

1.  将事件发送到我控制的事件处理器池
2.  让我`Actor`通过其他机制同时处理它们

我会认为#1 否定了使用演员子系统的意义：*我应该创建多少个处理器演员？*是一个明显的问题。据说这些事情对我来说是隐藏的，并由子系统解决。

我的回答是执行以下操作：

```
val eventProcessor = actor {
  loop {
    react {
      case MyEvent(x) =>
        //I want to be able to handle multiple events at the same time
        //create a new actor to handle it
        actor {
          //processing code here
          process(x)
        }
    }
  }
} 
```

有更好的方法吗？这是不正确的吗？

*编辑：一个可能更好的方法是：*

```
val eventProcessor = actor {
  loop {
    react {
      case MyEvent(x) =>
        //Pass processing to the underlying ForkJoin framework
        Scheduler.execute(process(e))
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T00:56:23.467

这似乎是另一个问题的重复。所以我会重复我的答案

Actor 一次处理一条消息。处理多条消息的经典模式是在一组消费者参与者的前面设置一个协调参与者。如果你使用 react，那么消费者池可能会很大，但仍然只会使用少量的 JVM 线程。这是一个示例，我创建了一个由 10 个消费者组成的池，并为他们创建了一个协调员。

```
import scala.actors.Actor
import scala.actors.Actor._

case class Request(sender : Actor, payload : String)
case class Ready(sender : Actor)
case class Result(result : String)
case object Stop

def consumer(n : Int) = actor {
  loop {
    react {
      case Ready(sender) => 
        sender ! Ready(self)
      case Request(sender, payload) =>
        println("request to consumer " + n + " with " + payload)
        // some silly computation so the process takes awhile
        val result = ((payload + payload + payload) map {case '0' => 'X'; case '1' => "-"; case c => c}).mkString
        sender ! Result(result)
        println("consumer " + n + " is done processing " + result )
      case Stop => exit
    }
  }
}

// a pool of 10 consumers
val consumers = for (n <- 0 to 10) yield consumer(n)

val coordinator = actor {
  loop {
     react {
        case msg @ Request(sender, payload) =>
           consumers foreach {_ ! Ready(self)}
           react {
              // send the request to the first available consumer
              case Ready(consumer) => consumer ! msg
           }
         case Stop => 
           consumers foreach {_ ! Stop} 
           exit
     }
  }
}

// a little test loop - note that it's not doing anything with the results or telling the coordinator to stop
for (i <- 0 to 1000) coordinator ! Request(self, i.toString) 
```

此代码测试以查看哪个消费者可用并向该消费者发送请求。替代方案是随机分配给消费者或使用循环调度程序。

根据您所做的事情，Scala 的 Futures 可能会为您提供更好的服务。例如，如果你真的不需要演员，那么上述所有机器都可以写成

```
import scala.actors.Futures._

def transform(payload : String) = {      
  val result = ((payload + payload + payload) map {case '0' => 'X'; case '1' => "-"; case c => c}).mkString
  println("transformed " + payload + " to " + result )
  result
}

val results = for (i <- 0 to 1000) yield future(transform(i.toString)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T14:56:37.240

如果事件都可以独立处理，为什么要排队？对您的设计一无所知，这似乎是一个不必要的步骤。如果您可以`process`使用触发这些事件的任何内容来组合该函数，则您可能会消除队列。

演员本质上是配备队列的并发效果。如果你想同时处理多条消息，你真的不需要演员。您只希望在某个方便的时间安排一个函数 (Any => ()) 执行。

话虽如此，如果您想留在演员库中并且事件队列不在您的控制范围内，那么**您的方法是合理的。**

[Scalaz](http://code.google.com/p/scalaz)对 Actor 和并发效果进行了区分。虽然它`Actor`的重量很轻，`scalaz.concurrent.Effect`但仍然更轻。这是您的代码大致翻译到 Scalaz 库：

```
val eventProcessor = effect (x => process x) 
```

这是最新的行李箱头，尚未发布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:21:28.577

这听起来像是一个简单的消费者/生产者问题。我会使用一个带有消费者池的队列。您可能可以使用 java.util.concurrent 用几行代码来编写它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T17:22:53.430

演员（好吧，其中之一）的目的是确保演员内的状态一次只能由单个线程访问。如果消息的处理不依赖于actor中的任何可变状态，那么将任务提交给调度程序或线程池进行处理可能更合适。演员提供的额外抽象实际上妨碍了你。

scala.actors.Scheduler 中有一些方便的方法，或者您可以使用 java.util.concurrent 中的 Executor。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-20T14:56:47.703

Actor 比线程轻得多，因此另一种选择是使用 Actor 对象，例如您习惯于提交到线程池的 Runnable 对象。主要区别在于您无需担心 ThreadPool - 线程池由 Actor 框架为您管理，并且主要是配置问题。

```
def submit(e: MyEvent) = actor {
  // no loop - the actor exits immediately after processing the first message
  react {
    case MyEvent(x) =>
      process(x)
  }
} ! e // immediately send the new actor a message 
```

然后提交消息，这样说：

```
submit(new MyEvent(x)) 
```

，对应于

```
eventProcessor ! new MyEvent(x) 
```

从你的问题。

在四核 i7 笔记本电脑上大约 10 秒内发送和接收了 100 万条消息，成功测试了这种模式。

希望这可以帮助。

# visual-studio - Windows 服务的安装项目不会在 Server 2008 (Visual Studio 2008) 下构建

> ID：1007380
> 
> 赞同：0
> 
> 时间：2009-06-17T14:27:01.197
> 
> 标签：visual-studio, windows-services, build, windows-server-2008

我们这里有新机器用于在运行 Server 2008 上进行开发。

使用 Visual Studio 2008，我们在构建安装 Windows 服务的安装项目时遇到问题 - 在自定义操作下，然后卸载，“InstallerClass 属性仅对程序集有效”。

这可以在 XP SP3 上构建和安装。

有没有其他人遇到过类似的问题？

**工作站操作系统**：Server 2008

**软件**：Visual Studio 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:29:15.420

确保在自定义操作中添加服务，否则服务将不会被注册。除此之外，您是否有任何编译错误？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:55:02.763

我建议不要使用 VS 安装项目。改用 Wix，它比您想象的要容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:29:18.280

我确实找到了这个 - [http://msdn.microsoft.com/en-us/library/447a3y7x(VS.71).aspx](http://msdn.microsoft.com/en-us/library/447a3y7x(VS.71).aspx)

我已经对解决方案进行了更改，现在正在等待在 Server 2008 机器上对其进行测试——我仍在 XP SP3 上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-22T06:52:05.273

运行命令行 devenv.exe 以构建 .vdproj 文件（在 Nant 脚本中）时出现此错误。问题是我没有先构建依赖项目，所以一旦完成它就可以正常工作。

毕竟它与 InstallerClass 属性的配置无关。

# user-interface - 让matlab计时器更新matlab GUIDE gui？

> ID：1007385
> 
> 赞同：1
> 
> 时间：2009-06-17T14:28:30.290
> 
> 标签：user-interface, matlab, callback, timer

我有一个 matlab 计时器对象。它每秒更新一次全局变量 FOO。

我有一个 matlab GUIDE GUI，带有几个控件和一个图框。图框由某些 GUI 控件更新，并由计时器对象更新。

基本上，有两个全局变量 FOO 和 BAR。计时器更新 FOO，GUI 控件更新 BAR。对 FOO 或 BAR 的更新需要更新 GUI。

这该怎么做？

谢谢约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:38:55.027

你不能把手表放在变量上。没有回调。但是，FOO 和 BAR 都由以下任一者更新：

* * *

FOO by timerFcn

小部件回调的 BAR

* * *

你需要做一个功能：

updatePlot %更新绘图以反映 FOO 或 BAR 的新值

并且将更新 FOO 或 BAR 的两个函数都调用 updatePlot 作为他们最后的职责之一。

我也建议不要使用全局变量。有更好的方法来做到这一点。我是 GETAPPDATA 和 SETAPPDATA 的粉丝。看看我制作的这个视频。

[http://blogs.mathworks.com/videos/2005/10/03/guide-video-part-two/](http://blogs.mathworks.com/videos/2005/10/03/guide-video-part-two/)

您也可以尝试嵌套函数。

# perforce - 如何将 p4sql 查询添加为 Perforce 自定义工具参数？

> ID：1007387
> 
> 赞同：2
> 
> 时间：2009-06-17T14:28:48.027
> 
> 标签：perforce

我正在尝试通过将[p4sql.exe](https://stackoverflow.com/questions/134103/how-do-you-search-the-text-of-changelist-descriptions-in-perforce)添加为应用程序和

```
-s "select * from changes where lcase(description) like '$%$D$%' and p4options='longdesc';" 
```

作为论据。

当我执行命令并输入“123”作为输入时，返回以下错误：

```
p4sql error:
    Usage: p4sql -h for usage.
    Option: 12 is undefined. 
```

我错过了什么逃生机制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T16:09:16.723

我最近更新了您引用的[问题](https://stackoverflow.com/questions/134103/how-do-you-search-the-text-of-changelist-descriptions-in-perforce)，正如我所说，P4V 中有一个错误，P4SQL 似乎也很不稳定。如果您在“$%”和“$D”之间放置空格，您可以让它在某些时候工作。改变这个：

```
...like '$%$D$%' and... 
```

对此：

```
...like '$% $D $%' and... 
```

进行此更改后，它会在某些时候起作用，但某些搜索仍然会失败，因为这些空格成为搜索字符串的一部分。我还注意到一些搜索失败的原因我无法解释。我去年 10 月向 Perforce 报告了这个问题，他们确认这是一个错误，但尚未修复。

您最好使用另一个问题中提到的解决方案之一。使用 P4Win 或将更改列表转储到文件中，然后搜索该文件。

# log4net - machineName 是否有 log4net 模式

> ID：1007389
> 
> 赞同：10
> 
> 时间：2009-06-17T14:28:49.540
> 
> 标签：log4net, pattern-layout

我很难找到关于各种“盒子里”模式的文档，比如

```
%logger  
%level  
%timestamp 
```

当然[有示例页面](http://logging.apache.org/log4net/release/config-examples.html)，但我不确定这是选项的完整列表。

我也知道可以将应用程序中的 MDC 参数传递给记录器，但这涉及代码更改，这与配置更改不同。

有没有`%machineName`选择，或者`machineIP`选择？问题是我们将网络场中的所有服务器都记录到同一个数据库日志中，我们现在认为来自一台机器的消息数量不成比例。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T14:41:40.343

```
%property{log4net:HostName} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-17T14:56:35.100

我刚刚偶然发现的是

```
<layout type="log4net.Layout.PatternLayout" value="${COMPUTERNAME}"/> 
```

这似乎奏效了——想知道这与建议的其他选项之间有什么区别。喜欢`%property{log4net:HostName}`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-08T16:14:38.730

创建一个获取机器名称的类：

```
using System;
using System.IO;
using log4net.Layout.Pattern;

namespace YourNameSpace.Converters
{
    public class MachinePatternConverter : PatternLayoutConverter
    {
        protected override void Convert(TextWriter writer, log4net.Core.LoggingEvent loggingEvent)
        {
            writer.Write(Environment.MachineName);            
        }
    }
} 
```

然后像这样设置你的 log4net 配置：

```
<layout type="log4net.Layout.PatternLayout">
    <converter>
      <name value="machine" />
      <type value="YourNameSpace.MachinePatternConverter" />
    </converter>
    <conversionPattern value="%date [%thread] %level %logger %machine" />
</layout> 
```

我喜欢这种方法，因为它可以重复使用，并且我可以按照自己的意愿管理信息。例如，如果您想记录 IP 地址，只需执行相同操作并创建转换器，如下所示：

```
public class IPPatternConverter : PatternLayoutConverter
{
    protected override void Convert(TextWriter writer, log4net.Core.LoggingEvent loggingEvent)
    {
        if (HttpContext.Current == null)
            return;

        writer.Write(HttpContext.Current.Request.UserHostAddress);
    }
} 
```

有关链接的更多信息：http: [//devstuffs.wordpress.com/2012/01/12/creating-your-own-pattern-layout-converter-for-log4net/](http://devstuffs.wordpress.com/2012/01/12/creating-your-own-pattern-layout-converter-for-log4net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-24T00:36:51.133

使用这个关于添加 GlobalContext 属性的答案[https://stackoverflow.com/a/2096452/1224858](https://stackoverflow.com/a/2096452/1224858)，我能够让它工作。

我在我的类文件中添加了以下代码：

```
log4net.GlobalContext.Properties["hostname"] = Environment.MachineName; 
```

然后在配置文件中我可以引用主机名，它会出现

```
<layout type="log4net.Layout.PatternLayout">
     <conversionPattern value="%date [%thread] %-5level %logger [%property{hostname}] - %message%newline" />
</layout> 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T14:31:38.350

查看[PatternString API](http://logging.apache.org/log4net/release/sdk/log4net.Util.PatternString.html)，看起来你需要在你的模式中使用 %property 。也看看[这篇文章](http://geekswithblogs.net/rgupta/archive/2009/03/03/dynamic-log-filenames-with-log4net.aspx)，你可能需要在应用程序启动时将机器名注入到全局上下文中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-10T04:45:13.680

有趣的是，我认为这是“紧凑参数语法”在这里查看最后一节[http://logging.apache.org/log4net/release/manual/configuration.html](http://logging.apache.org/log4net/release/manual/configuration.html)

# c++ - 是否可以使指向不同模板类型的指针可转换？

> ID：1007390
> 
> 赞同：4
> 
> 时间：2009-06-17T14:29:01.037
> 
> 标签：c++

我有一个模板类，它将一些信息与一个类型捆绑在一起：

```
template <typename T>
class X
{
  int data[10]; // doesn't matter what's here really
  T t;
public:
  // also not terribly relevant
}; 
```

然后假设我们有一个基类和派生类：

```
class Base {};

class Derived : public Base {}; 
```

我希望能够做这样的事情（但不认为我可以）：

```
void f(shared_ptr<X<Base> > b);

shared_ptr<X<Derived> > d(new X<Derived>);

f(d); 
```

有没有一种方法可以使指向可`X<T>`转换为`X<Y>`T* 是否可转换为 Y* 的指针的指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T16:29:14.070

将问题重新表述为更笼统：*如果不相关类型本身是可转换的，是否可以从不相关类型转换指针？*，答案是否定的。并且不同的模板实例定义了不同的不相关类型。

您可以将指向派生对象的指针隐式转换（参见下面的注释）到基对象的指针（由于访问或歧义，一些限制适用），或者您可以从基指针显式转换为派生指针（再次使用一些限制）。您也可以来回转换为 void*，但转换为不相关的类型最终会导致未定义的行为。

指针不能从不相关的类型转换有明显的原因。第一个是将一个指针类型转换为另一种指针类型不会转换指向的内存。也就是说，您可以将 int 转换为 double，但是将指向 int 的指针转换为指向 double 的指针会使编译器认为指向的地址有 8 个字节的内存，而实际上只有 4 个字节存在（假设具有 32 位整数和 64 位双精度的 32 位或 64 位架构）。取消引用指针肯定会以错误的方式结束。

*标准注释：*

标准的第 4.10 节处理指针转换，第一段处理*空指针*转换，第二段处理*void*指针转换。第三段指出，只要 B 是 D 的基类，就可以将指向 D 类型的指针转​​换为 B 类型的指针。那里没有定义其他指针转换。在指定显式转换的第 5.4 节中，第 7 段处理指针转换，并且只在几种情况下添加从 B* 到 D* 的可能显式转换，只要 B 是 B 的基数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:32:48.427

**编辑**：您尝试做的事情是可能的；您可以使用[boost](http://www.boost.org/)库提供的可转换性测试和静态断言来在类型不兼容的情况下生成编译时错误。
这是一个例子：

```
#include <string>   
#include <iostream> 
#include <boost/type_traits/is_convertible.hpp>
#include <boost/static_assert.hpp>

template<typename MyType>
class MyTypeInfo{
public:
    MyType* myType;

    MyTypeInfo(MyType* _myType){
        myType = _myType;
    }

    template <typename DestinationType>
    operator MyTypeInfo<DestinationType>() {
        BOOST_STATIC_ASSERT((boost::is_convertible<MyType,DestinationType>::value));
        MyTypeInfo<DestinationType> ret((DestinationType*)myType);
        return ret;
    }

};

class Base{
public:
    virtual void do_something(){
        std::cout << "Base" << std::endl;
    }
};
class Derived : public Base{
public:
    virtual void do_something(){
        std::cout << "Derived" << std::endl;
    }
};

class NonDerived{
};

int _tmain(int argc, _TCHAR* argv[])
{
    // this one is ok
    MyTypeInfo<Derived> d(new Derived());
    MyTypeInfo<Base> b = (MyTypeInfo<Base>)d;
    b.myType->do_something();

    // this one fails to compile
    //MyTypeInfo<NonDerived> nd(new NonDerived());
    //MyTypeInfo<Base> b2 = (MyTypeInfo<Base>)nd;
    //b2.myType->do_something();

    return 0;
} 
```

如果您不想或不能使用 boost 库，可以参考[Andrei Alexandrescu 的精彩著作《现代 C++ 设计》](http://erdani.org/)，了解可转换性测试和静态断言宏的可能实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:20:56.270

天，

你有没有想过你为什么要这样做？

回到基础知识，继承是为不同类型的派生对象专门化行为，例如，在名为 Shape 的基类中声明的 draw() 函数将为派生类 Square 产生与派生类 Circle 不同的输出。

无论类型如何，当您想要相同类型的行为时都应该使用模板，例如，整数堆栈中的 pop 函数的行为方式与浮点堆栈中的 pop 函数的行为方式与堆栈中的 pop 函数的行为方式相同Foo 类型的对象。

高温高压

干杯，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:13:20.447

在重新思考这个问题时，我刚刚意识到您遇到的另一个问题。多态行为只能通过指针和/或引用来实现。尝试对值执行此操作会产生所谓的*slicing*，其中原始派生对象被转换（复制）为基础对象，从而丢失所有额外信息。

切片的常见示例如下：

```
class Base 
{
public:
   virtual void polymorphic() { 
      std::cout << "Base" << std::endl;
   }
};
class Derived : public Base
{
public:
   virtual void polymorphic() {
      std::cout << "Derived" << std::endl;
   }
};
void f( Base b ) {
   b.polymorphic();
}
int main() {
   Derived d;
   f( d ); // prints Base
} 
```

现在，最初的问题涉及指针类型的转换，我之前回答[过](https://stackoverflow.com/questions/1007390/is-it-possible-to-make-pointers-to-distinct-template-types-convertible/1008183#1008183)。我相信您的代码提出了*切片*问题的变体。我们可以对强制从不相关类型进行指针转换的*未定义行为进行一些尝试：*

```
// same Base and Derived definitions as above
template <typename T>
struct Holder
{
   T data;
};
int main() {
   Holder<Derived> derived;
   Holder<Derived>* derived_ptr = &derived;
   Holder<Base>* base_ptr = reinterpret_cast<Holder<Base>* >( derived_ptr ); // undefined!!!
   std::cout << "derived_ptr=" << derived_ptr << ", base_ptr=" << base_ptr << std::endl;
   base_ptr->data.polymorphic(); // prints Base
} 
```

首先，根据标准，这是未定义的行为......但请耐心等待。我们可以尝试使用通用编译器可以实现的功能。我们有一个*Holder*类型的对象和一个指向它的指针（*derived_ptr*），现在我们将指针重新解释为指向*Holder*的指针。此时*base_ptr*和*derived_ptr*具有相同的值，它们指向相同的地址（检查输出）。

在最后一步中，我们访问了存储在*&derived的**Holder*的数据字段，并在其上调用了虚函数 * polymorphic()* ......但是在*Holder*中，*数据*字段不是引用或指针，它是一个元素类型为*Base*，因此编译器可以决定它将调用它的*Base*版本，在 g++ 4.0 中也是如此。

 ***这都是*未定义的行为*，因此请使用您选择的编译器进行尝试，它最终可能会得到相同或不同的结果。

如果您更改模板定义以存储指针，那么您将获得*预期*的多态行为。也就是说，在这种情况下，期望知道手头对象的内存占用。并不是说您可以从意外的*未定义行为中得到任何**期望*。

 ** * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T15:04:03.683

我不想指出显而易见的问题，但有什么理由不能将函数设为模板吗？IE

```
template <typename T>
void f(shared_ptr<T> b);

shared_ptr<X<Derived> > d(new X<Derived>);

f(d); 
```****

# python - 使用 Perl、Python 或 Ruby，如何编写程序以在预定时间“点击”屏幕？

> ID：1007391
> 
> 赞同：1
> 
> 时间：2009-06-17T14:29:06.000
> 
> 标签：python, ruby, perl, winapi

使用 Perl、Python 或 Ruby，我可以编写一个程序，可能调用 Win32 API，在预定时间“点击”屏幕，比如每 1 小时？

**细节：**

这是为了实验——点击是否对 Flash 内容以及屏幕上的任何元素都有效？如果程序可以记录点击需要在屏幕上发生的位置，或者至少在屏幕上绘制一个红点以显示它正在点击的位置，那就太好了。

点击可以针对窗口还是只是屏幕上的一般像素？如果某些病毒扫描程序弹出来掩盖应该点击的地方怎么办？（尽管如果程序首先单击窗口的空白区域，那么它可以首先将该窗口带到前台）。

顺便说一句，Grease Monkey 或任何 Firefox 插件也可以用来执行此操作吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T14:35:58.917

如果您正在尝试自动执行网站中的某些任务，您可能需要查看[`WWW::Selenium`](http://search.cpan.org/dist/Test-WWW-Selenium/lib/WWW/Selenium.pm). 它与[Selenium Remote Control](http://seleniumhq.org/projects/remote-control/)一起，允许您远程控制 Web 浏览器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T14:34:34.333

在 Python 中有[ctypes](http://www.python.org/doc/2.5.2/lib/module-ctypes.html)，在 Perl 中有[Win32::API](http://search.cpan.org/~cosimo/Win32-API-0.58/API.pm)

**ctypes 示例**

```
from ctypes import *
windll.user32.MessageBoxA(None, "Hey MessageBox", "ctypes", 0); 
```

**Win32::Api 示例**

```
use Win32::GUI qw( WM_CLOSE );
my $tray = Win32::GUI::FindWindow("WindowISearchFor","WindowISearchFor");
Win32::GUI::SendMessage($tray,WM_CLOSE,0,0); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T21:01:00.243

要回答实际问题，在 Perl 中，您将使用[Win32::GuiTest](http://search.cpan.org/~karasik/Win32-GuiTest-1.56/)模块提供的 SendMouse（和相关函数）。

```
#!/usr/bin/perl

use strict;
use warnings;

use Win32::GuiTest qw( MouseMoveAbsPix SendMouse );

MouseMoveAbsPix(640,400);
SendMouse "{LEFTCLICK}";

__END__ 
```

**更新：**

> 如果某些病毒扫描程序弹出来掩盖应该点击的地方怎么办？

在这种情况下，您将使用`FindWindowLike`来查找窗口并将`MouseClick`点击发送到该特定窗口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T21:09:40.540

如果允许使用不同的工具，你应该看看[AutoHotkey](http://www.autohotkey.com/)或[AutoIt](http://www.autoitscript.com/autoit3/)。这些工具是为这类事情而设计的，我一直热衷于使用正确的工具来完成正确的工作。

我相信 AutoHotkey 基于 AutoIt，这是我个人的偏好。您只需要 2 个功能来实现您想要实现的功能，即[MouseMove](http://www.autohotkey.com/docs/commands/MouseMove.htm)和[MouseClick](http://www.autohotkey.com/docs/commands/MouseClick.htm)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T14:37:34.483

我发现这在 Java 或 C++ 中更容易实现。Java 有一个[Robot 类](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Robot.html)，它允许您传递 x、y 坐标并单击某处。`mouse_event()`使用 C++，您可以使用或`SendMessage()`使用`WM_MOUSE_DOWN`标志来实现相同的功能。SendMessage 更具技术性，但它允许您使用`FindWindow()`鼠标点击并将其发送到特定窗口，即使它已最小化。

使用像 Python 或 Ruby 这样的脚本语言，我猜你最终还是会挂接到这些 Windows API 函数中的一个。

# sql - SQL差的存储过程执行计划性能——参数嗅探

> ID：1007397
> 
> 赞同：11
> 
> 时间：2009-06-17T14:29:33.020
> 
> 标签：sql, sql-server, tsql, sql-execution-plan, parameter-sniffing

我有一个存储过程，它接受一个日期输入，如果没有传入任何值，则稍后将其设置为当前日期：

```
CREATE PROCEDURE MyProc
    @MyDate DATETIME = NULL
AS
    IF @MyDate IS NULL SET @MyDate = CURRENT_TIMESTAMP
    -- Do Something using @MyDate 
```

我遇到了问题，如果在首次编译存储过程时`@MyDate`传入，`NULL`则所有输入值（或其他）的性能总是很糟糕`NULL`，如果在编译存储过程时传入日期/当前日期所有输入值（`NULL`或其他）的性能都很好。

**同样令人困惑的是，即使 @MyDate 使用的值实际上是** `NULL`（而不是`CURRENT_TIMESTAMP`由 IF 语句设置），生成的糟糕的执行计划也很糟糕

我发现禁用参数嗅探（通过欺骗参数）可以解决我的问题：

```
CREATE PROCEDURE MyProc
    @MyDate DATETIME = NULL
AS
    DECLARE @MyDate_Copy DATETIME
    SET @MyDate_Copy = @MyDate
    IF @MyDate_Copy IS NULL SET @MyDate_Copy = CURRENT_TIMESTAMP
    -- Do Something using @MyDate_Copy 
```

我知道这与参数嗅探有关，但是我看到的所有“参数嗅探变坏”的示例都涉及使用传入的非代表性参数编译存储过程，但是在这里我看到了执行计划对于 SQL 服务器可能认为参数可能在执行语句的点可能采用的所有可能的值是可怕的 -`NULL`或`CURRENT_TIMESTAMP`其他。

有没有人知道为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T14:40:33.557

基本上是的 - SQL Server 2005 的参数嗅探（在某些补丁级别）被严重破坏。我见过的计划实际上永远不会完成（在一个小数据集上的几个小时内），即使对于小（几千行）数据集，一旦参数被屏蔽，这些数据集在几秒钟内完成。这是在参数始终为相同数字的情况下。我要补充一点，在我处理这个问题的同时，我发现了很多关于 LEFT JOIN/NULLs 没有完成的问题，我用 NOT IN 或 NOT EXISTS 替换了它们，这解决了计划到一些可以完成的事情。同样，一个（非常糟糕的）执行计划问题。在我处理这个问题的时候，DBA 不会给我 SHOWPLAN 访问权限，因为我开始屏蔽每个 SP 参数，所以我'

在 SQL Server 2008 中，您可以使用`OPTIMIZE FOR UNKNOWN`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-25T23:09:08.973

我能够在（SQL Server 2005）中解决这个问题的一种方法是添加查询优化器提示，而不是仅仅通过重新声明本地参数来屏蔽参数。

这是一篇很好的博客文章，详细讨论了它： [SqlServer 2005 中的参数嗅探](http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx)

我用过： OPTION (优化 (@p = '-1'))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-16T13:04:26.253

在过程内部声明过程参数，并将外部参数传递给内部..编译..

# hashmap - 快速、可扩展的哈希查找数据库？（伯克利语）

> ID：1007401
> 
> 赞同：1
> 
> 时间：2009-06-17T14:30:09.693
> 
> 标签：hashmap, berkeley-db, memcachedb

我使用并喜欢伯克利，但一旦你接近一百万左右的条目，它似乎就会陷入困境，尤其是在插入时。我已经尝试过 memcachedb ，但它没有得到维护，所以我担心在生产中使用它。有没有人有任何其他类似的解决方案，基本上我希望能够在一个大型（可能是分布式的）数据集（40+ 百万）上进行关键查找。

注意：任何不是 Java 的东西都是奖励。:-) 今天似乎大多数事情都在走 Java 路线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-13T21:30:09.267

[Redis](http://code.google.com/p/redis/) is insanely fast and actively developed. It is written in C(no java). Compiles out of the box on POSIX OS(no dependencies).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-29T16:46:10.910

我建议你看看：

[Metabrew 键值存储博客文章](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/)

有一个很大的键值存储列表，每个都有一些讨论。如果您仍然有疑问，可以加入所谓的[Nosql](http://groups.google.com/group/nosql-discussion) google 组并在那里寻求帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:33:41.310

你试过[伏地魔计划](http://project-voldemort.com/)吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-29T16:36:11.807

您是否尝试过哈希后端？插入和键搜索应该更快。

# reporting-services - 如何在 SSRS 中将数字格式化为 1 个小数点？

> ID：1007404
> 
> 赞同：9
> 
> 时间：2009-06-17T14:30:26.573
> 
> 标签：reporting-services, reportingservices-2005

我有一个充满数字字段的 SSRS 报告。我希望将其显示为小数点后一位。我尝试使用 F1。它在 html 渲染中只给了我一个小数点，但在 excel 导出版本中它显示了 2 个小数点。我如何才能在 ecxel 和 html 渲染中都只有一位小数。

请评论。提前谢谢桑

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-07-17T09:58:11.690

使用**N1**作为您的格式属性设置。**N**表示数字格式，**1**表示小数位数，因此**N2**会给你 102.02，例如。这应该携带到 excel，因为它以 html 呈现。

或者，您可以使用格式代码#,##0.00，它将为您提供千位分隔符和两位小数。'#' 表示可选字符，而 '0' 表示强制字符（空值将被 '0.00' 替换）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-27T19:35:40.947

在 2012 版本中：FormatNumber(Fields!col.Value,2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-12T20:31:15.740

右键单击包含您要操作的值的文本框，选择 TEXT BOX PROPERTIES。导航到数字选项卡，选择数字和您希望该框允许的小数位数。

# c# - 以简单的方式继承 Web 服务器控件？

> ID：1007405
> 
> 赞同：0
> 
> 时间：2009-06-17T14:30:30.067
> 
> 标签：c#, asp.net, custom-server-controls

我有一个中继器用作一种 Paging TagCloud。为此，我向 Page 的 ViewState 添加了简单的属性，例如 Page、RowCount 等……

我觉得它不属于那里，但我在服务器控制、调试、dll 和部署方面的经历很糟糕。

我可以只继承Repeater 类，添加一些ControlState/ViewState 属性，并能够完全像直接从工具箱中拖动的Repeater 一样使用它吗？

在这里，有以下简单的类：

```
 public class TagCloud : Repeater
{
    public int selectedIndex;

    public TagCloud()
    {
        selectedIndex = -1;
        //
        // TODO: Add constructor logic here
        //
    }

    public int SelectedIndex
    {
        get { return selectedIndex; }
        set { selectedIndex = value; }
    }
} 
```

如果不创建新的 WebControlLibrary 项目，此 cs 文件是否可以位于 App_Code 文件夹中并按预期工作？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T14:36:14.020

这是可行的，并且是构建服务器控件的一种建议方法。试试看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:38:06.557

是的，这样做没有问题。只要你使用控件的属性语法：

公共 int 行数
{

```
 get { return (int) (ViewState["RowCount"] ?? 0); }
  set { ViewState["RowCount"] = value; } 
```

}

此外，为了使您的属性看起来与默认属性相同，您可以添加 Description 或 DefaultValue 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:44:52.877

从 ASP 中继器继承是一种完全有效的方法，只要您正在构建的控件是具有附加属性的中继器。

如果您觉得您需要的控件实际上是“其他东西”，恰好有一个转发器作为其控件集的一部分，那么您可能需要制作一个复合控件，将转发器添加到其控件集合中，以及任何其他控件需要。

例如，您可能希望拥有一个包含转发器、搜索结果标签、指向转发器内容顶部和底部的链接等的控件。此复合控件不是转发器，但确实使用了转发器.

# javascript - 使用 javascript DOM 遍历表

> ID：1007410
> 
> 赞同：0
> 
> 时间：2009-06-17T14:31:31.127
> 
> 标签：javascript, dom

我知道这是有史以来最简单的问题，但我似乎找不到答案，而且我在黑暗中寻找，因此感谢您的帮助。我试图在 class='song_artist' 的节点中获取文本。我有对父节点的引用，但无法找到我正在寻找的文本。我的 html 看起来像这样：

```
<tr id='0000moe2008-05-23d01t01_vbr' class='row-even'><td class='song_name'>Captain America<h3> (00:00)</h3></td><td class='song_artist'>moe.</td><td class='song_date'>2008-05-23</td><td class='song_location'>Jones Beach, VA</td></td><td class='song_extras'></td></tr>  
<tr id='00011-01_Rock_And_Roll_Part_2' class='row-odd'><td class='song_name'>Rock and Roll part 2<h3> (00:00)</h3></td><td class='song_artist'>Phish</td><td class='song_date'>1998-11-20</td><td class='song_location'>Jones Beach, VA</td></td><td class='song_extras'></td></tr>  
<tr id='00021-03_Quinn_The_Eskimo' class='row-even'><td class='song_name'>Quinn the Eskimo<h3> (00:00)</h3></td><td class='song_artist'>Phish</td><td class='song_date'>1998-11-20</td><td class='song_location'>Jones Beach, VA</td></td><td class='song_extras'></td></tr> 
```

就像我说的那样，我有一个参考，`<tr>`但无法找到`<td>`我正在寻找的。我假设完整的参考资料看起来像：`parent.firstChild.nextSibling.data`但我不断地遇到各种死胡同。这里有任何 javascript 大师吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T14:39:40.143

You can do:

```
var collection = document.getElementsByTagName( "td");
for( var i = 0; i < collection.length; ++i)
{
      if ( collection[i].getAttribute("class") === "whateveryouwant")
       {
       }
} 
```

But my advise to switch using javascript framework like jquery, since then only thing you will need to to do is:

```
var element = $( "td.song_artist") //here you get all element you are looking for 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:44:58.307

在纯 Javascript 中：

```
var elements = document.getElementsByClassName('song_artist')
for (var i=0; i<elements.length; i++){
    text = elements[i].innerHTML;
} 
```

**标准警告**：改用 javascript 框架。

# sql-server - 使用子查询进行分组时出现 SQL Server 2005 错误

> ID：1007418
> 
> 赞同：0
> 
> 时间：2009-06-17T14:33:04.010
> 
> 标签：sql-server, sql-server-2005, subquery, group-by

使用 SQL Server 2005，我尝试基于带有子查询的 case 语句进行分组，但出现错误（“每个 GROUP BY 表达式必须包含至少一个列引用。”）。我可以很容易地解决它，但是任何人都可以解释这个错误吗？我有一个对#header.header 的列引用。

```
create table #header (header int)
create table #detail (header int, detail int)

insert into #header values (1)
insert into #header values (2)
insert into #header values (3)

insert into #detail values (1, 1)
insert into #detail values (2, 1)

--error: Each GROUP BY expression must contain at least one column reference.
select case when exists (select 1 from #detail where #detail.header = #header.header) then 1 else 0 end hasrecords from #header
group by case when exists (select 1 from #detail where #detail.header = #header.header) then 1 else 0 end

--results I want
select hasrecords, count(*) from
(
    select case when exists (select 1 from #detail where #detail.header = #header.header) then 1 else 0 end hasrecords from #header
) hasrecords
group by hasrecords

drop table #header
drop table #detail 
```

[编辑] 注意（响应评论）相关和非相关子查询：

```
--correlated
select header, case when exists (select 1 from #detail where #detail.header = #header.header) then 1 else 0 end hasrecords from #header

--non-correlated
select #header.header, case when count(#detail.header) > 0 then 1 else 0 end hasrecords from #header left join #detail on #header.header = #detail.header group by #header.header 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T18:47:22.813

首先，如果我们给出完整的错误，它应该是“**每个 GROUP BY 表达式必须包含至少一个不是外部引用的列。** ”

**要理解错误，我们需要澄清“外部参考”的**含义

 **（注意：在这种情况下，它与内部或外部连接无关）

内部和*外部**参考*主查询及其子查询。在这种情况下，`EXISTS`是子查询，它是一个***相关***子查询，因为它有一个外部引用`#header.header`，它引用外部表`#header`，而对 的任何引用都`#detail`将被视为内部引用。

所以本质上，因为`CASE`使用了引用外部查询的相关子查询，所以这会触发错误状态，因为当您尝试仅在 GROUP BY 子句中使用被解释为外部引用的表达式时会出现此错误消息。

子查询**可以**在 GROUP BY 中使用，但不能在相关子查询中使用。

令人困惑的是，同样的错误可能由非子查询、更简单的查询产生，例如

```
select 
 case when header=1 then 1 
      else 0 
 end headeris1, 
 'constant' 
from #header 
group by case when header=1 then 1 else 0 end , 'constant' 
```

甚至用一个替换常数`@variable`

清如泥？

凯夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T14:35:40.963

当您需要为其分组（标题）而不是值时，您告诉它按 1 或 0 分组。

因此，如果我理解正确，您想要一个标题列表和他们的详细记录计数？

这可能对你有用吗？

```
SELECT DISTINCT h.header, COUNT(d.detail) AS detail_count
FROM #header AS h
LEFT JOIN #detail AS d ON d.header = h.header
GROUP BY h.header, d.detail 
```

结果像...

```
header   detail_count
1       1
2       1
3       0 
```**

# java - 在java中从网络中检索图像

> ID：1007424
> 
> 赞同：0
> 
> 时间：2009-06-17T14:33:45.443
> 
> 标签：java, javax.imageio

我正在尝试从我的 Java 程序中读取驻留在网络上某处的图像。到目前为止，我已经使用以下代码成功加载了图像。

```
URL url = new URL("http://www.google.com/images/nav_logo4.png");
Image img = Toolkit.getDefaultToolkit().getImage(url); 
```

我想知道的是为什么这段代码（这是我第一次尝试）不起作用：

```
BufferedImage img = ImageIO.read(new File("http://www.google.com/images/nav_logo4.png")); 
```

这将有利于给我一个`BufferedImage`. 另外，在加载图像之前，如何使上述代码块？我知道我可以使用`ImageObserver`，但是有更简单的方法吗？

当我尝试第二个选项时，我得到了这个异常：

```
javax.imageio.IIOException: Can't read input file! 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:35:41.307

A[`File`](http://java.sun.com/javase/6/docs/api/java/io/File.html)不能引用 URL。

虽然没试过，但是好像有一个[`ImageIO.read(URL)`](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html#read(java.net.URL))方法，可以把一个URL作为输入作为一个[`URL`](http://java.sun.com/javase/6/docs/api/java/net/URL.html)对象。

我想它会被称为如下：

```
ImageIO.read(new URL("http://url/to/my/image.png")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:35:58.217

文件对象无法从 URL 中读取

# php - 在文件中缓存 PHP 对象的性能差异

> ID：1007425
> 
> 赞同：2
> 
> 时间：2009-06-17T14:33:47.737
> 
> 标签：php, oop, caching, object

在磁盘上缓存 PHP 对象有区别吗？如果缓存，对象只会为所有站点访问者创建一次，如果没有，它们将为每个访问者创建一次。这有性能差异还是我会浪费时间这样做？谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T14:35:25.300

性能归结为**后续使用**，因此即使您的对象被缓存一次并被所有人使用......或每个访问者缓存一次......它是后续使用。如果您的缓存对象每天使用 10,000,000 次，那么您将节省。

如果缓存对象被使用一次或根本不使用，增益可以忽略不计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:40:02.670

It's like this: File is way faster then Database. Memory is way faster then files (when not swapping disk space).

So cache to memory what you need the most, and try and think when you need to make the effort to cache to file.

Remember: premature optimisation usually isn't the best thing to do.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:53:17.367

@艾登贝尔

嗯。取决于对象。如果可以共享一个实例，则可以节省存储空间……但这取决于用户是否更改了对象。您将读取/写入创建瓶颈的对象。如果没有更多信息，您将不得不在此处查找理论。– Aiden Bell 11 分钟前

-- 这些实例没有用户可以更改的数据，但是，它们将包含用户在整个站点中使用的数据。

基本上，归根结底，主要问题是：

内存中的多个对象，每个用户（每个用户都有自己的一组实例化对象）

VS

为所有用户缓存在文件中的单个对象（所有用户使用相同的对象，例如，相同的错误处理程序类、相同的模板处理程序类和相同的数据库句柄类）

--

嗨，其他人有什么想法吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:37:53.767

You'll have to take in account that dynamic content must be cached whenever it changes. But, to static content, it's much more faster to use cached content, especially in database schemas, configurations, and that kind of thing.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T14:38:49.380

Assuming that they are large objects, and especially if they are being built based on data pulled from a database, caching is a good idea. For some testing I did with a particular instance, it was quicker to build an object, write it to a file, and load from the file, than to go to the DB every time.

However: there are better ways than writing to a file. You would probably be better off storing the object in memory with memcached or APC, and don't forget that you may have issues with locks on the file is several people are hitting the site at once.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T14:40:16.570

Caching objects on disk will give you the additional overhead of a disk write whenever there is a cache miss, whereas on a cache hit you will be able to save the step of instantiating the object.

If construction of the object is enough of a burden that saving it sometimes will more than outweighs the additional burden of a disk write, then go ahead and cache on disk.

I'd be curious, however, to know more about why instantiating your objects is so costly that you would want to do this.

# visual-sourcesafe - 与 Visual Source Safe 一起使用的免费问题跟踪/项目管理

> ID：1007427
> 
> 赞同：3
> 
> 时间：2009-06-17T14:34:50.200
> 
> 标签：visual-sourcesafe, issue-tracking

我知道[VSS 很糟糕](http://www.codinghorror.com/blog/archives/000660.html)，我只是生命伟大机器中的一个齿轮，并且在治疗师的帮助下学会了忍受无力感。但是，我想给这里的混乱带来一些秩序，像[FogBugz](http://www.fogcreek.com/FogBUGZ/)这样与 VSS 集成的真正的问题跟踪/项目管理系统将是一个巨大的改进。Fogbugz 的问题在于成本：我永远不会说服我的部门为此花一分钱，而且我必须支持我选择的任何免费解决方案，直到我泪流满面。

那么，[有什么是](http://en.wikipedia.org/wiki/Comparison_of_issue_tracking_systems)免费的（如啤酒）、与 VSS 集成的、您使用过的、您喜欢的（或至少只是不喜欢的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:13:11.323

[Gemini](http://www.countersoft.com/products/gemini.aspx)与 VSS 一起工作，非常适合错误/问题跟踪。它对最多 5 个用户免费。

# java - 标准输入上 Java 和 C++ 应用程序之间的通信问题

> ID：1007436
> 
> 赞同：1
> 
> 时间：2009-06-17T14:35:41.197
> 
> 标签：java, c++, select, stdin, fgets

我在这里有一个 java 应用程序，它通过 java.lang.Process API 启动一个 C++ 应用程序，然后尝试通过标准输入管道向它发送命令：

```
process.getOutputStream().write("foo\n");
process.getOutputStream().flush();

```

在 C++ 端，有一个循环正在运行，它检查标准输入中的输入，如果有的话，它会读取它。不幸的是，检查总是返回 0，因此它从不尝试读取。如果我删除检查，那么它会突然开始查看命令并处理它们。这是在linux上。

从标准输入检查和读取的 C++ 应用程序代码是这样的：

```
fd_set fds;
FD_ZERO ( &fds );
FD_SET (0, &fds);

结构时间值电视；
tv.tv_sec = 0;
tv.tv_usec = 0;

if( 选择 ( 1, &fds, 0, 0, &tv ) > 0 ) {
    字符缓冲区[16384]；
    buf[16383] = '\0';
    if ( fgets ( buf, sizeof ( buf ) - 1, stdin ) == 0 )
        返回;
}

```

正如我所说，删除 if 子句使其工作，但当然这不是很好，因为它周围的循环还做了一些其他事情。有人知道我在这里做错了什么吗？

更新：同时，我能够用两个非常小的示例应用程序重现该问题。问题似乎与这里的 Qt 框架有关，只要我创建了框架所需的 QCoreApplication 实例，stdin 的 select() 似乎就不再起作用了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:49:32.870

你有两个如果；删除哪一个使它起作用？

[fgets()](http://en.wikipedia.org/wiki/Fgets)不会在返回之前等待换行符、缓冲区满或 EOF 吗？我没有看到您写换行符，“foo”没有填充缓冲区，并且由于流没有关闭，它是否看到 EOF？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:39:55.030

原来它不是 QCoreApplication，因为我现在可以在没有问题的情况下重现该问题两次。似乎问题是我正在使用的 fgets() ，用 read() 替换它可以修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:23:58.027

我记得有很多关于 select() 的语义和操作以及它的一些替代品的争论。你可能会看那些。

您正在阅读的流是如何创建/打开的？它是缓冲流吗？也许你什么也得不到，因为在写入过程刷新它之前它没有被写入流？

您可能会尝试的另一件事是将其放在具有阻塞 I/O 而不是轮询的线程上。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:38:43.127

下面是在while循环内吗？如果没有，它应该是。

```
FD_ZERO ( &fds );
FD_SET ( 0, &fds );

struct timeval tv;
tv.tv_sec = 0;
tv.tv_usec = 0; 
```

如果我的第一个问题的答案是肯定的，那么请尝试这个超时：

```
tv.tv_sec = 0;
tv.tv_usec = 1; 
```

如果上述方法不起作用，请尝试以下操作：

```
while(fgets(buf, sizeof ( buf ) - 1, stdin) !=NULL) 
{ 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T14:40:34.010

I may be wrong, but does having a timeout of 0 for the `select` call makes sense? I would try to increase the timeout value.

# c# - 匿名方法作为 BeginInvoke 的参数？

> ID：1007438
> 
> 赞同：19
> 
> 时间：2009-06-17T14:35:53.130
> 
> 标签：c#, delegates, anonymous-methods, begininvoke

为什么不能将匿名方法作为参数传递给`BeginInvoke`方法？我有以下代码：

```
private delegate void CfgMnMnuDlg(DIServer svr);
private void ConfigureMainMenu(DIServer server,)
{
    MenuStrip mnMnu = PresenterView.MainMenu;
    if (mnMnu.InvokeRequired)
    {
        mnMnu.BeginInvoke((CfgMnMnuDlg)ConfigureMainMenu, 
                            new object[] { server});
    }
    else
    {
        // Do actual work here
    }
} 
```

我试图避免声明代表。为什么我不能写类似下面的东西呢？或者我可以，我只是想不出正确的语法？以下当前生成：

> 参数类型“匿名方法”不可分配给参数类型“System.Delegate”

好的，这当然是对的，但是我可以使用其他一些语法来执行此操作（避免必须声明单独的委托才能使用`BeginInvoke()`?

（能够做到这一点将完全符合使用匿名方法/lamdas 代替显式委托的概念，这在其他任何地方都非常干净。）

```
private void ConfigureMainMenu(DIServer server,)
{
    MenuStrip mnMnu = PresenterView.MainMenu;
    if (mnMnu.InvokeRequired)
    {
        mnMnu.BeginInvoke(  //  pass anonymous method instead ?
             delegate(DIServer svr) { ConfigureMainMenu(server);},     
             new object[] { server});
    }
    else
    {
        // Do actual work here
    }
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-17T15:02:05.573

试试这个：

```
control.BeginInvoke((MethodInvoker) delegate { /* method details */ }); 
```

或者：

```
private void ConfigureMainMenu(DIServer server)
{
    if (control.InvokeRequired)
    {
        control.BeginInvoke(new Action<DIServer >(ConfigureMainMenu), server);
    }
    else
    {
        /* do work */
    }
} 
```

或者：

```
private void ConfigureMainMenu(DIServer server)
{
    MenuStrip mnMnu = PresenterView.MainMenu;
    if (mnMnu.InvokeRequired)
    {
        // Private variable
        _methodInvoker = new MethodInvoker((Action)(() => ConfigureMainMenu(server)));
        _methodInvoker.BeginInvoke(new AsyncCallback(ProcessEnded), null); // Call _methodInvoker.EndInvoke in ProcessEnded
    }
    else
    {
        /* do work */
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:09:50.520

您应该能够编写如下内容：

```
private void ConfigureMainMenu(DIServer server,)
{
    MenuStrip mnMnu = PresenterView.MainMenu;
    if (mnMnu.InvokeRequired)
    {
        mnMnu.BeginInvoke(new Action<DIServer>(ConfigureMainMenu), 
                            new object[] { server});
    }
    else
    {
        // Do actual work here
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:14:27.827

您可以编写一个包装匿名方法的扩展方法，甚至处理`InvokeRequired`语义：

```
public static void InvokeAction(this Control ctl, Action a)
{
    if (!ctl.InvokeRequired)
    {
        a();
    }
    else
    {
        ctl.BeginInvoke(new MethodInvoker(a));
    }
} 
```

这将允许您执行以下操作：

```
control.InvokeAction(delegate() { ConfigureMainMenu(server); }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-24T18:05:25.277

您可以通过调用自己的方法在单个方法中执行此操作：

```
 ClassData updData =  new ClassData();

  this.BeginInvoke(new Action<ClassData>(FillCurve),
                           new object[] { updData }); 
```

...

```
public void FillCurve(ClassData updData)
{
 ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T14:45:39.147

我尝试了很多不同的方法，但都没有奏效。IE...

```
 // Fails -- cannot convert lamda to System.Delegate
mnMnu.BeginInvoke( (DIServer svr)=> {ConfigureMainMenu(server);}, new object[] server);
// Fails -- cannot convert anonymous method to System.Delegate
mnMnu.BeginInvoke( new delegate(DIServer svr){ConfigureMainMenu(server);}, new object[] server); 

```

所以，简短的回答是否定的。您可以在给定的上下文中创建简短的助手委托，并使用 lambda 使其更整洁，但仅此而已。

编辑：原来我错了。下面的方法调用者答案有效。看到这个[页面](http://www.csharper.net/blog/methodinvoker___anonymous_methods___teh_r0x0r.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-25T03:36:31.600

对于参数数量有限的完全匿名方法：

```
Func<int, int?> caller = new Func<int, int?>((int param1) =>
   {
      return null;
   });

caller.BeginInvoke(7, new AsyncCallback((IAsyncResult ar) =>
{
   AsyncResult result = (AsyncResult)ar;
   Func<int, int?> action = (Func<int, int?>)result.AsyncDelegate;
   action.EndInvoke(ar);
}), null); 
```

您可以根据需要使用其他 Func 委托类型之一。

# python - MATLAB 中的 mrdivide 函数：它在做什么，我如何在 Python 中做到这一点？

> ID：1007442
> 
> 赞同：12
> 
> 时间：2009-06-17T14:36:13.020
> 
> 标签：python, matlab, numpy, linear-algebra

我有这行 MATLAB 代码：

```
a/b 
```

我正在使用这些输入：

```
a = [1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9]   
b = ones(25, 18) 
```

这是结果（一个 1x25 矩阵）：

```
[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] 
```

MATLAB 在做什么？我试图在 Python 中复制这种行为，而`mrdivide`MATLAB 中的文档没有帮助。5 来自哪里，为什么其余的值都是 0？

我已经尝试使用其他输入并收到类似的结果，通常只是一个不同的第一个元素和零填充矩阵的其余部分。在 Python 中，当我使用 时`linalg.lstsq(b.T,a.T)`，返回的第一个矩阵中的所有值（即不是单数）都是 0.2。我已经在 Python 中尝试过正确的除法，它完全给出了错误尺寸的东西。

我了解最小二乘近似是什么，我只需要知道`mrdivide`在做什么。

### 有关的：

*   [数组除法 - 从 MATLAB 转换为 Python](https://stackoverflow.com/questions/1001634/array-division-translating-from-matlab-to-python)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-01T07:14:36.950

[MRDIVIDE](http://www.mathworks.com/help/matlab/ref/mrdivide.html)或`/`算子实际上解决了`xb = a`线性系统，而不是[MLDIVIDE](http://www.mathworks.com/help/matlab/ref/mldivide.html)或`\`将解决系统的算子`bx = a`。

要求解`xb = a`具有非对称、不可逆矩阵的系统`b`，您可以依赖`mridivide()`，这是通过`b`使用高斯消元的因式分解来完成的，或者`pinv()`是通过奇异值分解和以下奇异值的归零来完成的（默认）容差水平。

以下是区别（对于 的情况`mldivide`）：[当我求解 A*x=b 时，PINV 和 MLDIVIDE 有什么区别？](https://www.mathworks.com/support/solutions/en/data/1-3TPS3Y/index.html?product=ML&solution=1-3TPS3Y)

> 当系统超定时，两种算法都提供相同的答案。当系统欠定时，PINV 将返回解 x，它具有最小范数 (min NORM(x))。MLDIVIDE 将选择非零元素数量最少的解决方案。

在您的示例中：

```
% solve xb = a
a = [1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9];
b = ones(25, 18); 
```

系统未确定，两种不同的解决方案将是：

```
x1 = a/b; % MRDIVIDE: sparsest solution (min L0 norm) 
x2 = a*pinv(b); % PINV: minimum norm solution (min L2)

>> x1 = a/b
Warning: Rank deficient, rank = 1,  tol = 2.3551e-014.
ans =

    5.0000 0 0 ... 0 

>> x2 = a*pinv(b)
ans =

    0.2 0.2 0.2 ... 0.2 
```

在这两种情况下， 的近似误差`xb-a`都是不可忽略的（非精确解）并且相同，即`norm(x1*b-a)`并且`norm(x2*b-a)`将返回相同的结果。

**MATLAB 在做什么？**

[在scicomp.stackexchange.com](https://scicomp.stackexchange.com/a/1004/4014)`b`的这篇文章中给出了 由 '\' 运算符调用的算法（和属性检查）的一个很好的分解，具体取决于矩阵的结构。我假设类似的选项适用于运营商。`/`

对于您的示例，MATLAB 很可能正在执行高斯消除，在无穷大中给出最稀疏的解决方案（这就是 5 的来源）。

**Python 在做什么？**

Python，`linalg.lstsq`使用伪逆/SVD，如上所示（这就是为什么你得到一个 0.2 的向量）。实际上，以下都将给您与 MATLAB 相同的结果`pinv()`：

```
from numpy import *

a = array([1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9])
b = ones((25, 18))

# xb = a: solve b.T x.T = a.T instead 
x2 = linalg.lstsq(b.T, a.T)[0]
x2 = dot(a, linalg.pinv(b)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-12-17T19:22:25.627

TL;博士：`A/B = np.linalg.solve(B.conj().T, A.conj().T).conj().T`

我没有找到较早的答案来创建令人满意的替代品，因此我进一步研究了 Matlab 的 mrdivide 参考文档并找到了解决方案。我不能在这里解释实际的数学，也不能因为想出答案而受到赞扬。我只是按照Matlab的解释。此外，我想发布来自 Matlab 的实际细节以表扬。如果是版权问题，有人告诉我，我会删除实际文本。

```
%/   Slash or right matrix divide.
%   A/B is the matrix division of B into A, which is roughly the
%   same as A*INV(B) , except it is computed in a different way.
%   More precisely, A/B = (B'\A')'. See MLDIVIDE for details.
%
%   C = MRDIVIDE(A,B) is called for the syntax 'A / B' when A or B is an
%   object.
%
%   See also MLDIVIDE, RDIVIDE, LDIVIDE.

%   Copyright 1984-2005 The MathWorks, Inc. 
```

请注意，`'`符号表示复共轭转置。在使用 numpy 的 python 中，这需要 .conj().T 链接在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:40:02.733

a/b finds the least square solution to the system of linear equations bx = a

if b is invertible, this is a*inv(b), but if it isn't, the it is the x which minimises norm(bx-a)

You can read more about least squares on [wikipedia](http://en.wikipedia.org/wiki/Least_squares).

according to [matlab documentation](http://www.mathworks.co.uk/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/mldivide.html), mrdivide will return at most k non-zero values, where k is the computed rank of b. my guess is that matlab in your case solves the least squares problem given by replacing b by b(:1) (which has the same rank). In this case the moore-penrose inverse `b2 = b(1,:); inv(b2*b2')*b2*a'` is defined and gives the same answer

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T14:49:28.703

根据matlab 用户的 numpy[这个方便的“备忘单”](http://mathesaurus.sourceforge.net/matlab-numpy.html)`linalg.lstsq(b,a)` ， --`linalg`是[numpy.linalg.linalg](http://www.scipy.org/doc/numpy_api_docs/numpy.linalg.linalg.html)，一个完整的轻量级版本`scipy.linalg`。

# c# - (C#) 为什么 Visual Studio 说它是一个对象，而 GetType 说它是一个 Func? C# newbie question here. The following code (taken from the book "C# From Novice to Professional" by Christian Gross, Apress) gives an error: worksheet.Add("C3 问问题 问问题 2009-06-17T14:36:19.043 483 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. C# newbie question here. The following code (taken from the book "C# From Novice to Professional" by Christian Gross, Apress) gives an error: worksheet.Add("C3", CellFactories.DoAdd(worksheet["A2"], worksheet["B1"])); The reason is that the method DoAdd() does not accept the given arguments. public static Func DoAdd(Func cell1, Func cell2) {...} VS claims that both args in the method call above are of type object whereas the method accepts only Func. But the value of both worksheet elements is of type Func: worksheet.Add("A2", CellFactories.Static(10.0)); where this Static method just returns the given value: public static Func Static(object value) { return () => value; } // return type= Func When I cast worksheet["A2"] as Func, the code does work. But there is something I don't understand. The type of the object instance is Func. I have used the GetType() method to see proof of this, and compare the object types of the original elements to that of the cast object (which IS accepted): Console.Writeline(worksheet["A2"].GetType()); // now cast to the correct type (why can't it do that implicitly, btw?) Funk1 = worksheet["A2"] as Func; Console.Writeline(Funk1.GetType()); .. and they are ALL identical! (Type = System.Func'1[System.Object]) And even when I use the .Equals() method to compare both types, it returns true. Yet, VS sees the first object instance as type object in the method call. Why? Why does the called method 'see' the argument as a different type than the GetType() returns? (and if so, what good is the GetType() method?) Thanks a lot for your advice/comments! (It's kinda hard to learn the language if the book examples give an error and you don't see the reason - hence, got the vague impression that something is wrong either with GetType() or VS.) You need to add the Content Query Web Part to your page (note: requires MOSS not free WSS). This allows you to query your data and apply an XSL transform to it. The web part allows you to query a particular site collection, web or list. You can then set parameters to return data of a certain type and apply filters, sorting and grouping. You can also choose how you wish the data to be displayed which appears to the end user as a dropdown list of options. Each of these options is powered by an XSL transform. This blog post by Heather Solomon is one of the best resources to help you get started with how to create your own transform and configure the CQWP. It also explains how to ensure all the fields you need are passed through to the XSLT (by default this only happens for a small subset). Update: To only return list items where the field "Position" > 0, it is simplest to do this within XSLT as well. You must have added the Position field to CommonViewFields so that it gets passed through to the XSLT. Then in your custom item style (in ItemStyle.xsl if you follow Heather's post), add the following: This implicitly ignores when "Position" <= 0. c#functiongettype 4 3 回答 3 This answer is useful 3 您需要了解动态类型和静态类型之间的区别。您的对象的索引器worksheet很可能具有静态类型object. public object this[string cell]{get{...}set{...}} 因为 C# 中的所有对象都继承自 type object，所以存储在单元格中的对象引用可以是对任何对象的引用。 也就是说，因为委托（例如Func<t>）是，object所以可以将其存储在object引用中： Func func = ()=>return "foo"; object o = func; // this compiles fine 编译器可以弄清楚这一切，因为它隐含地理解派生类可以存储在对基类的引用中。 编译器不能自动做的是确定对象的动态类型或运行时类型是什么。 Func func = ()=>return "foo"; object o = func; // this compiles fine func = o; // <-- ERROR 编译器不知道object存储的o实际上是 type Func。它不应该跟踪这一点。这是必须在运行时检查的信息。 func = (Func)o; // ok! 上面的代码行编译成与此类似的东西： if(o == null) func = null; else if(typeof(Func).IsAssignableFrom(func.GetType())) __copy_reference_address__(func, o); // made up function! demonstration only else throw new InvalidCastException(); 通过这种方式，可以在运行时检查任何强制转换（从一种类型转换为另一种类型）以确保其有效且安全。 于 2009-06-17T15:16:27.293 回答 This answer is useful 2 其他人已经给出了准确而详细的答案，但这里我将尝试用简单的语言进行解释。 当你写worksheet["A2"]你真的是在调用一个成员函数worksheet worksheet有一个名为的成员函数[]，它接受 astring并返回一个object 成员函数的签名[]看起来像object this[string id] 所以该函数worksheet["A2"]返回一个object. 它可能是一个int或一个string或许多其他的东西。编译器只知道它将是一个object. 在示例中，您让它返回一个Func. 这很好，因为Func 是一个object. 但是，您随后将该函数的结果作为参数传递给另一个函数。 这里的问题是编译器只知道worksheet["A2"]返回一个object. 这与编译器一样具体。所以编译器认为这worksheet["A2"]是一个对象，并且您试图将对象传递给一个不接受object作为参数的函数。 所以在这里你必须通过将返回的对象转换为正确的类型来告诉编译器“嘿，笨蛋，这是一个Func”。 worksheet.Add("C3", CellFactories.DoAdd(worksheet["A2"], worksheet["B1"])); 可以重写为 worksheet.Add("C3", CellFactories.DoAdd((Func)worksheet["A2"], (Func)worksheet["B1"])); 现在编译器知道，即使[]函数返回一个object，它也可以把它当作一个Func。 旁注：你可能在一条线上做的太多了。将来人们可能很难阅读。 为什么被调用的方法“看到”参数与 GetType() 返回的类型不同？ 编译器只知道worksheet[]返回一个对象。编译器不能GetType()在编译时调用它。 GetType() 方法有什么好处？ 该方法有很多用途和滥用GetType()，但这是一个完全不同的讨论。;) 总之，编译器不对类型做任何假设。这是一件好事，因为当您尝试将此方形钉装入圆孔时会出现编译时错误。如果编译器没有抱怨，这个错误会在运行时出现，这意味着您可能需要一个单元测试来检测问题。 你可以通过告诉编译器“我知道这个东西是一个圆钉，相信我”来解决这个问题。然后它会编译。如果您对编译器撒谎，则在执行该代码时会出现运行时错误。 这称为“静态类型”。相反的哲学称为“动态类型”，其中类型检查在运行时完成。静态与动态是一场漫长的辩论，如果您有兴趣，您可能应该自己研究一下。 于 2009-06-17T16:48:10.783 回答 This answer is useful 1 VS 声称上述方法调用中的两个参数都是对象类型，而该方法只接受 Func。但是两个工作表元素的值都是 Func 类型 是的，但声明的类型是object. 编译器无法知道实际的运行时类型将是Func，因此需要显式转换。 于 2009-06-17T15:03:49.300 回答 Related 1 html - BBCode to HTML database converter 2 c - 使用 "$**" 在 Makefile 中引导文件输入 2 excel - Excel/数据透视表：当我过滤信息时，有什么方法可以防止单元格移动？ 1 vagrant - Vagrant 添加额外的参数/选项 1 jakarta-ee - 无法在 weblogic 服务器上部署 EJB 2 java - 了解 Java 和 Objective-c 同步指令之间的区别 5 java - 创建数组的arraylist 1 php - 我的 login.php 说我的密码不正确，但它是正确的。 2 spring - DispatcherServlet 签署传出响应 2 php - 使用 Hamcrest 的 hasKeyValuePair 和 laravel 的单元测试 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：1007444
> 
> 赞同：2
> 
> 时间：
> 
> 标签：c#, function, gettype

C# newbie question here. The following code (taken from the book "C# From Novice to Professional" by Christian Gross, Apress) gives an error:

```
worksheet.Add("C3", CellFactories.DoAdd(worksheet["A2"], worksheet["B1"])); 
```

The reason is that the method `DoAdd()` does not accept the given arguments.

```
public static Func<object> DoAdd(Func<object> cell1, Func<object> cell2) {...} 
```

VS claims that both args in the method call above are of type `object` whereas the method accepts only `Func<object>`. But the *value* of both worksheet elements is of type `Func<object>`:

```
worksheet.Add("A2", CellFactories.Static(10.0)); 
```

where this `Static` method just returns the given value:

```
public static Func<object> Static(object value) { return () => value; }
// return type= Func<object> 
```

When I cast `worksheet["A2"]` as `Func<object>`, the code does work.

But there is something I don't understand. The type of the object instance is `Func<object>`. I have used the `GetType()` method to see proof of this, and compare the object types of the original elements to that of the cast object (which IS accepted):

```
Console.Writeline(worksheet["A2"].GetType());

// now cast to the correct type (why can't it do that implicitly, btw?)
Funk1 = worksheet["A2"] as Func<object>;

Console.Writeline(Funk1.GetType()); 
```

.. and they are ALL identical! (Type = `System.Func'1[System.Object]`)

And even when I use the `.Equals()` method to compare both types, it returns `true`.

Yet, VS sees the first object instance as type `object` in the method call. Why? Why does the called method 'see' the argument as a different type than the GetType() returns? (and if so, what good is the `GetType()` method?)

Thanks a lot for your advice/comments! (It's kinda hard to learn the language if the book examples give an error and you don't see the reason - hence, got the vague impression that something is wrong either with `GetType()` or VS.)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:16:27.293

您需要了解*动态类型*和*静态类型*之间的区别。您的对象的索引器`worksheet`很可能具有静态类型`object`.

```
public object this[string cell]{get{...}set{...}} 
```

因为 C# 中的所有对象都[继承](http://en.wikipedia.org/wiki/Inheritance_(computer_science))自 type `object`，所以存储在单元格中的对象引用可以是对*任何*对象的引用。

也就是说，因为委托（例如`Func<T>`）**是**，`object`所以可以将其存储在`object`引用中：

```
Func<object> func = ()=>return "foo";
object o = func; // this compiles fine 
```

编译器可以弄清楚这一切，因为它隐含地理解派生类可以存储在对基类的引用中。

编译器不能自动做的是确定对象的动态类型或*运行时类型*是什么。

```
Func<object> func = ()=>return "foo";
object o = func; // this compiles fine
func = o; // <-- ERROR 
```

编译器不知道`object`存储的`o`实际上是 type `Func<object>`。它不应该跟踪这一点。这是必须在运行时检查的信息。

```
func = (Func<object>)o; // ok! 
```

上面的代码行编译成与此类似的东西：

```
if(o == null)
    func = null;
else if(typeof(Func<object>).IsAssignableFrom(func.GetType()))
    __copy_reference_address__(func, o); // made up function!  demonstration only
else throw new InvalidCastException(); 
```

通过这种方式，可以在运行时检查任何强制转换（从一种类型转换为另一种类型）以确保其有效且安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T16:48:10.783

其他人已经给出了准确而详细的答案，但这里我将尝试用简单的语言进行解释。

当你写`worksheet["A2"]`你真的是在调用一个成员函数`worksheet`

`worksheet`有一个名为的成员函数`[]`，它接受 a`string`并返回一个`object`

成员函数的签名`[]`看起来像`object this[string id]`

所以该函数`worksheet["A2"]`返回一个`object`. 它可能是一个`int`或一个`string`或许多其他的东西。编译器只知道它将是一个`object`.

在示例中，您让它返回一个`Func<object>`. 这很好，因为`Func<object>` *是*一个`object`. 但是，您随后将该函数的结果作为参数传递给另一个函数。

这里的问题是编译器只知道`worksheet["A2"]`返回一个`object`. 这与编译器一样具体。所以编译器认为这`worksheet["A2"]`是一个对象，并且您试图将对象传递给一个不接受`object`作为参数的函数。

所以在这里你必须通过将返回的对象转换为正确的类型来告诉编译器“嘿，笨蛋，这是一个`Func<object>`”。

```
worksheet.Add("C3", CellFactories.DoAdd(worksheet["A2"], worksheet["B1"])); 
```

可以重写为

```
worksheet.Add("C3", CellFactories.DoAdd((Func<object>)worksheet["A2"], (Func<object>)worksheet["B1"])); 
```

现在编译器知道，即使`[]`函数返回一个`object`，它也可以把它当作一个`Func<object>`。

旁注：你可能在一条线上做的太多了。将来人们可能很难阅读。

> 为什么被调用的方法“看到”参数与 GetType() 返回的类型不同？

编译器只知道`worksheet[]`返回一个对象。编译器不能`GetType()`在编译时调用它。

> GetType() 方法有什么好处？

该方法有很多用途和滥用`GetType()`，但这是一个完全不同的讨论。;)

总之，编译器不对类型做任何假设。这是*一件好事*，因为当您尝试将此方形钉装入圆孔时会出现编译时错误。如果编译器没有抱怨，这个错误会在运行时出现，这意味着您可能需要一个单元测试来检测问题。

你可以通过告诉编译器“我知道这个东西**是**一个圆钉，相信我”来解决这个问题。然后它会编译。如果您对编译器撒谎，则在执行该代码时会出现运行时错误。

这称为“静态类型”。相反的哲学称为“动态类型”，其中类型检查在运行时完成。静态与动态是一场漫长的辩论，如果您有兴趣，您可能应该自己研究一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:03:49.300

> VS 声称上述方法调用中的两个参数都是对象类型，而该方法只接受 Func。但是两个工作表元素的值都是 Func 类型

是的，但声明的类型是`object`. 编译器无法知道实际的运行时类型将是`Func<object>`，因此需要显式转换。</t>

# c# - ToolStripSplitButton Customization

> ID：1007447
> 
> 赞同：0
> 
> 时间：2009-06-17T14:36:31.257
> 
> 标签：c#, winforms, toolstrip

Does anyone know how I can move the 'Split' portion of a ToolStripSplitButton to the bottom of the button instead of the side?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T14:53:44.700

我认为这在默认情况下不起作用。我想您必须创建自己的 ToolStripItem 类。

# php - 如果我在调用 href 链接的同时调用 flash 函数，会始终执行 flash 函数吗？

> ID：1007451
> 
> 赞同：0
> 
> 时间：2009-06-17T14:37:01.990
> 
> 标签：php, javascript, flash, actionscript-2, callback

我在 page1.php 中有以下代码：

```
<a href="page2.php" onClick="javascript:callFlash();">Go to page</a> 
```

这会在 page1.php 上调用 Flash 电影中的函数**并**打开 page2.php。

我的问题是这样的：

我可以确定在调用 page2.php 之前始终会调用 flash 函数并完成执行吗？（flash 函数实际上将一些数据保存到本地共享对象中）。

或者我应该在完成时向 flash 函数添加一些代码`getURL("page2.php");`。

任何想法都欢呼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:39:48.613

如果您确实需要在 flash 功能完成后打开页面，那么保证这一点的唯一方法是按照您的想法从 flash 功能重定向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:47:24.450

首先不要在`onclick`属性中包含“javascript:”伪协议。

尝试使用`onclick="return callFlash()"`- 这样，浏览器必须等待 JS 函数完成才能访问链接。我不知道您用于调用 AS 函数的方法，但如果它是同步的（即可以在不使用回调或其他方式的情况下将数据返回给 JS），那么 AS 函数*将*在 JS 函数之前完成，并且在页面重新加载之前完成。所以这应该是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:55:35.617

这个问题的答案是否定的。

有一个简单的解决方法。只需停止点击事件的传播，让 flash 进行重定向：

```
<a href="page2.php" onClick="stop_and_call(event);"/> 
```

的JavaScript：

```
function stop_and_call(e)
{
    if (!!(window.attachEvent && !window.opera)){
        // this is IE
        e.returnValue = false;
        e.cancelBubble = true;
    } else {
        e.preventDefault();
        e.stopPropagation();
    }
    e.stopped = true;
    callFlash();
} 
```

# ruby - 验证 XML：没有可用于验证根的匹配全局声明

> ID：1007454
> 
> 赞同：9
> 
> 时间：2009-06-17T14:37:52.253
> 
> 标签：ruby, xml, xsd, libxml2

我正在尝试使用 Ruby 针对 XSD 模式验证以下 XML。它根本行不通，停止并显示一条错误消息告诉我

> 错误：元素“请求”：没有可用于验证根的匹配全局声明。

也许是命名空间？有任何想法吗？

## XML

```
<?xml version="1.0" encoding="UTF-8"?>
<request type="test" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <channel name="channel">
    <username>user</username>
    <password>pass</password>
  </channel>

  <hotel id="1">
    <date from="2009-07-07" to="2009-07-17"/>
    <room id="1">
      <allocation>10</allocation>
    </room>
  </hotel>
</request> 
```

## XSD

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <!-- channel -->
  <xsd:element name="channel">
    <xsd:attribute name="name" use="required" type="xsd:string" />
    <xsd:sequence>
      <xsd:element username="name" use="required" type="xsd:string"/>
      <xsd:element password="country" use="required" type="xsd:string"/>
    </xsd:sequence>
  </xsd:element>

  <!-- hotel -->
  <xsd:element name="hotel">
    <xsd:attribute name="id" use="required" type="xsd:string" />
    <xsd:sequence>
      <xsd:element name="hotel">
        <xsd:attribute name="from" use="required" type="xsd:string" />
        <xsd:attribute name="to" use="required" type="xsd:string" />
      </xsd:element>
      <xsd:element ref="room" minOccurs="1"/>
    </xsd:sequence>
  </xsd:element>

  <!-- room -->
  <xsd:element name="room">
    <xsd:sequence>
      <xsd:element name="allocation" type="xsd:string"></xsd:element>
      <xsd:element ref="hotel" minOccurs="1"/>
    </xsd:sequence>
    <xsd:attribute name="id" use="required" type="xsd:string" />
  </xsd:element>

  <!-- building all together -->
  <xsd:element name="request">
    <xsd:attribute name="type" use="required" type="xsd:string" />
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element ref="channel" maxOccurs="1"/>
        <xsd:element ref="hotel" maxOccurs="1"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema> 
```

## 红宝石代码

```
require "xml"

document = LibXML::XML::Document.file("/tmp/test.xml")
schema = LibXML::XML::Document.file("/tmp/request.xsd")

result = document.validate_schema(schema) do |message,flag|
  log.debug(message)
  puts message
end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T15:20:30.700

这是一个神秘的错误，但可能是因为您的 XSD 格式错误。例如，频道、酒店（内部和外部元素）、房间和请求`xsd:element`标签的内容都应该包含在`xsd:complexType`标签中。此外，`use`仅在 上有效，在 上`xsd:attribute`无效`xsd:element`。对于元素，使用 minOccurs 和 maxOccurs （尽管两者都默认为 1，因此在这种情况下它们实际上不是必需的）。此外，您的外部酒店元素包含一个房间元素，它必须包含一个酒店元素，从而创建一个无限循环。此外，您没有正确命名您的用户名和密码元素。最后，酒店内部元素可能应该是日期。这就是我认为您正在寻找的内容：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <!-- channel -->
  <xsd:element name="channel">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="username" type="xsd:string"/>
        <xsd:element name="password" type="xsd:string"/>
      </xsd:sequence>
      <xsd:attribute name="name" use="required" type="xsd:string" />
    </xsd:complexType>
  </xsd:element>

  <!-- hotel -->
  <xsd:element name="hotel">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="date">
          <xsd:complexType>
            <xsd:attribute name="from" use="required" type="xsd:string" />
            <xsd:attribute name="to" use="required" type="xsd:string" />
          </xsd:complexType>
        </xsd:element>
        <xsd:element ref="room" minOccurs="1"/>
      </xsd:sequence>
      <xsd:attribute name="id" use="required" type="xsd:string" />
    </xsd:complexType>
  </xsd:element>

  <!-- room -->
  <xsd:element name="room">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="allocation" type="xsd:string"></xsd:element>
      </xsd:sequence>
      <xsd:attribute name="id" use="required" type="xsd:string" />
    </xsd:complexType>
  </xsd:element>

  <!-- building all together -->
  <xsd:element name="request">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element ref="channel" maxOccurs="1"/>
        <xsd:element ref="hotel" maxOccurs="1"/>
      </xsd:sequence>
    <xsd:attribute name="type" use="required" type="xsd:string" />
    </xsd:complexType>
  </xsd:element>
</xsd:schema> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:15:53.550

在这里只是从臀部拍摄，但是您是否尝试过将保存模式的 XML::Document 转换为 XML::Schema？

[http://libxml.rubyforge.org/rdoc/classes/LibXML/XML/Schema.html](http://libxml.rubyforge.org/rdoc/classes/LibXML/XML/Schema.html)

我不知道这会有所作为，但值得一试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-12T17:08:13.203

由于不同的原因，我收到了相同的神秘错误消息。

我的架构文件的第一行有一个无前缀的命名空间：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.sec.gov/edgar/document/thirteenf/informationtable" xmlns:ns1="http://www.sec.gov/edgar/common" targetNamespace="http://www.sec.gov/edgar/document/thirteenf/informationtable" elementFormDefault="qualified" attributeFormDefault="unqualified"> 
```

请注意“xmlns=”属性。这会将架构中声明的所有元素放入命名空间`http://www.sec.gov/edgar/document/thirteenf/informationtable`（除非另外指定命名空间前缀）。但我试图验证的 XML 文件没有匹配的无前缀/默认命名空间：

```
<informationTable xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
```

因此它的元素与架构不匹配，因为它们位于“不同”的命名空间中。我希望这对其他人有用。

# unit-testing - 编写“单元测试”代码？

> ID：1007458
> 
> 赞同：37
> 
> 时间：2009-06-17T14:38:44.403
> 
> 标签：unit-testing, language-agnostic, automated-tests

您使用什么样的实践来使您的代码对单元测试更加友好？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-06-17T14:47:54.137

*   TDD——首先编写测试，迫使您考虑可测试性并帮助编写实际需要的代码，而不是您认为可能需要的代码

*   重构接口——使模拟更容易

*   如果不使用接口，公共方法是虚拟的——使模拟更容易

*   依赖注入——使模拟更容易

*   更小，更有针对性的方法——测试更专注，更容易编写

*   避免静态类

*   避免单例，除非有必要

*   避免密封类

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-17T14:40:47.660

依赖注入似乎有帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-17T14:40:02.793

首先编写测试——这样，测试驱动你的设计。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-17T14:44:00.353

1.  使用 TDD
2.  编写代码时，尽可能使用依赖注入
3.  编程到接口，而不是具体的类，因此您可以替换模拟实现。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-17T14:45:22.597

确保您的所有课程都遵循[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。单一职责意味着每个类应该有一个且只有一个职责。这使得单元测试更容易。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-17T16:04:28.177

我敢肯定我会对此投反对票，但无论如何我都会发表意见:)

虽然这里的许多建议都很好，但我认为需要稍微调整一下。目标是编写更强大的可更改和可维护的软件。

目标不是拥有可单元测试的代码。尽管可测试的代码不是目标，但还是付出了很多努力来使代码更“可测试”。这听起来很不错，我相信它会给人们带来温暖的感觉，但事实是所有这些技术、框架、测试等都是有代价的。

它们在培训、维护、生产力开销等方面花费时间。有时它是值得的，有时则不是，但你永远不应该戴上眼罩，并提前让你的代码更“可测试”。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-17T16:02:59.973

编写测试时（与任何其他软件任务一样）不要重复自己（DRY 原则）。如果您有对不止一项测试有用的测试数据，请将其放在两个测试都可以使用的地方。不要将代码复制到两个测试中。我知道这似乎很明显，但我看到它一直在发生。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-17T14:40:20.657

我尽可能使用测试驱动开发，所以我没有*任何*无法进行单元测试的代码。除非单元测试首先存在，否则它不会存在。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-17T14:43:08.250

最简单的方法是不要签入您的代码，除非您使用它签入测试。

我不喜欢先写测试。但我非常坚信的一件事是代码必须通过测试签**入**。甚至不到一个小时左右，**在一起**。我认为只要它们放在一起，它们的编写顺序就不那么重要了。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-06-17T14:47:39.533

小而高凝聚力的方法。我很难学。想象一下，您有一个处理身份验证的公共方法。也许你做过TDD，但是如果方法很大，调试起来会很困难。相反，如果该#authenticate 方法以更伪代码的方式执行操作，调用其他小方法（可能是受保护的），那么当出现错误时，很容易为这些小方法编写新的测试并找到错误的方法。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-06-17T14:50:25.533

还有一些你在 OOP 中学习的第一件事，但很多人似乎忘记了：*针对接口而不是实现的代码*。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-06-17T14:53:39.303

花一些时间重构不可测试的代码以使其可测试。编写测试并获得 95% 的覆盖率。这样做教会了我所有关于编写可测试代码的知识。我并不反对 TDD，但了解使代码可测试或不可测试的细节有助于您在设计时考虑可测试性。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-06-17T15:55:05.777

[不要编写无法测试的代码](http://www.youtube.com/watch?v=wEhu57pih5w&eurl=http%3A%2F%2Fgoogletesting%2Eblogspot%2Ecom%2F2008%2F11%2Fclean%2Dcode%2Dtalks%2Dunit%2Dtesting%2Ehtml&feature=player_embedded)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-06-17T14:52:09.807

```
1.Using a framework/pattern like MVC to separate your UI from you
business logic will help a lot. 
2\. Use dependency injection so you can create mock test objects.
3\. Use interfaces. 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-06-17T20:06:26.937

检查这个谈话[自动化测试模式和气味](http://www.youtube.com/watch?v=Pq6LHFM4JvE)。对我来说，主要收获之一是确保 UnitTest 代码具有高质量。如果代码有良好的文档记录和良好的编写，每个人都会有动力保持下去。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-17T15:25:36.353

**准备您的代码以进行测试：**

*   记录你的假设和排除。
*   避免做不止一件事的大型复杂类——牢记[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。
*   如果可能，使用接口来解耦交互并允许注入模拟对象。
*   如果可能，将公共方法设为虚拟以允许模拟对象模拟它们。
*   如果可能，在您的设计中使用组合而不是继承——这也鼓励（并支持）将行为封装到接口中。
*   如果可能，使用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)库（或 DI 实践）为实例提供外部依赖项。

**要充分利用单元测试，请考虑以下事项：**

*   让您自己和您的开发团队了解您打算使用的单元测试框架、模拟库和测试工具的功能。当您真正开始编写测试时，了解他们能做什么和不能做什么至关重要。
*   在开始编写测试之前计划好测试。确定要包含在测试中的边缘情况、约束、前置条件、后置条件和排除项。
*   尽可能在您发现损坏的测试时修复它们。测试可帮助您发现代码中的缺陷和潜在问题。如果你的测试被破坏了，你就打开了以后不得不修复更多事情的大门。
*   如果您在团队中遵循代码审查流程，那么也要对您的单元测试进行代码审查。单元测试与任何其他代码一样是您系统的一部分 - 审查有助于识别测试中的弱点，就像它们对系统代码一样。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-06-17T16:49:56.040

没有静态 - 你不能模拟静态。

谷歌也有一个工具可以测量你的代码的可测试性......

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-06-17T17:12:54.503

我一直在尝试找到一个过程，其中单元测试不是一件苦差事，而是我真正想做的事情。根据我的经验，一个很大的因素是你的工具。我做了很多 ActionScript 工作，遗憾的是，这些工具有些有限，例如没有 IDE 集成和缺乏更高级的模拟框架（但好事即将到来，所以这里没有抱怨！）。我之前使用更成熟的测试框架进行过测试驱动开发，这无疑是一种更愉快的体验，但仍然觉得有点苦差事。

然而，最近我开始以不同的方式编写代码。我曾经从编写测试开始，看着它们失败，编写代码以使测试成功，冲洗并重复等等。

然而，现在我从编写接口开始，几乎不管我要做什么。起初，我当然会尝试找出问题并想出解决方案。然后我开始编写接口以获得对代码和通信的抽象感觉。那时，我通常会意识到，由于我没有完全理解问题，我根本没有真正找到解决问题的正确方法。所以我回去，修改解决方案并修改我的界面。当我觉得接口反映了我的解决方案时，我实际上是从编写实现开始，而不是测试。当我实现了某些东西（草稿实现，通常是小步骤）时，我开始测试它。我一直在测试和实施之间返回，一次向前走几步。因为我有所有东西的接口，所以它'

我发现像这样工作，类对其他实现知之甚少，只与接口对话，这是非常解放的。它使我从思考另一个类的实现中解放出来，我可以专注于当前单元。我只需要知道接口提供的合同。

但是，是的，我仍然在尝试制定一个每次都非常有效的流程。

哦，我还想补充一点，我不会为所有内容编写测试。没有做太多但获取/设置变量的普通属性对测试毫无用处。他们得到语言合同的保证才能工作。如果他们不这样做，我会遇到比我的单元不可测试更糟糕的问题。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-21T03:12:18.137

您不一定需要“使您的代码对单元测试更加友好”。

相反，可以使用模拟工具包来消除可测试性问题。[JMockit](https://jmockit.dev.java.net)就是一个这样的工具包。

# python - 如何用下划线替换空格？

> ID：1007481
> 
> 赞同：268
> 
> 时间：2009-06-17T14:41:36.940
> 
> 标签：python, string

我想在字符串中用下划线替换空格以创建漂亮的 URL。例如：

```
"This should be connected" 
```

应该成为

```
"This_should_be_connected" 
```

我正在将 Python 与 Django 一起使用。这可以使用正则表达式解决吗？

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2009-06-17T14:44:23.737

你不需要正则表达式。Python 有一个内置的字符串方法，可以满足您的需要：

```
mystring.replace(" ", "_") 
```

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2009-06-17T15:03:21.360

替换空格很好，但我可能建议进一步处理其他 URL 敌对字符，如问号、撇号、感叹号等。

另请注意，SEO 专家的普遍共识是，[在 URL 中，破折号优于下划线。](http://www.google.com/search?q=dashes+underscores+seo)

```
import re

def urlify(s):

    # Remove all non-word characters (everything except numbers and letters)
    s = re.sub(r"[^\w\s]", '', s)

    # Replace all runs of whitespace with a single dash
    s = re.sub(r"\s+", '-', s)

    return s

# Prints: I-cant-get-no-satisfaction"
print(urlify("I can't get no satisfaction!")) 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2012-04-29T23:18:36.790

This takes into account blank characters other than space and I think it's faster than using `re` module:

```
url = "_".join( title.split() ) 
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2009-06-17T15:15:21.990

Django has a 'slugify' function which does this, as well as other URL-friendly optimisations. It's hidden away in the defaultfilters module.

```
>>> from django.template.defaultfilters import slugify
>>> slugify("This should be connected")

this-should-be-connected 
```

This isn't exactly the output you asked for, but IMO it's better for use in URLs.

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-06-17T14:45:07.200

使用`re`模块：

```
import re
re.sub('\s+', '_', "This should be connected") # This_should_be_connected
re.sub('\s+', '_', 'And     so\tshould this')  # And_so_should_this 
```

除非您有多个空格或上述其他空白可能性，否则您可能只想`string.replace`按照其他人的建议使用。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-06-17T14:45:30.037

使用字符串的替换方法：

`"this should be connected".replace(" ", "_")`

`"this_should_be_disconnected".replace("_", " ")`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-18T12:34:42.673

Python has a built in method on strings called replace which is used as so:

```
string.replace(old, new) 
```

So you would use:

```
string.replace(" ", "_") 
```

I had this problem a while ago and I wrote code to replace characters in a string. I have to start remembering to check the python documentation because they've got built in functions for everything.

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-09-28T16:01:41.523

Surprisingly this library not mentioned yet

python package named python-slugify, which does a pretty good job of slugifying:

```
pip install python-slugify 
```

Works like this:

```
from slugify import slugify

txt = "This is a test ---"
r = slugify(txt)
self.assertEquals(r, "this-is-a-test")

txt = "This -- is a ## test ---"
r = slugify(txt)
self.assertEquals(r, "this-is-a-test")

txt = 'C\'est déjà l\'été.'
r = slugify(txt)
self.assertEquals(r, "cest-deja-lete")

txt = 'Nín hǎo. Wǒ shì zhōng guó rén'
r = slugify(txt)
self.assertEquals(r, "nin-hao-wo-shi-zhong-guo-ren")

txt = 'Компьютер'
r = slugify(txt)
self.assertEquals(r, "kompiuter")

txt = 'jaja---lol-méméméoo--a'
r = slugify(txt)
self.assertEquals(r, "jaja-lol-mememeoo-a") 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-06-17T15:36:32.133

I'm using the following piece of code for my friendly urls:

```
from unicodedata import normalize
from re import sub

def slugify(title):
    name = normalize('NFKD', title).encode('ascii', 'ignore').replace(' ', '-').lower()
    #remove `other` characters
    name = sub('[^a-zA-Z0-9_-]', '', name)
    #nomalize dashes
    name = sub('-+', '-', name)

    return name 
```

It works fine with unicode characters as well.

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-05-06T15:28:28.123

You can try this instead:

```
mystring.replace(r' ','-') 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-07-31T16:51:23.353

```
mystring.replace (" ", "_") 
```

if you assign this value to any variable, it will work

```
s = mystring.replace (" ", "_") 
```

by default mystring wont have this

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-07-04T23:34:14.963

OP is using python, but in javascript (something to be careful of since the syntaxes are similar.

```
// only replaces the first instance of ' ' with '_'
"one two three".replace(' ', '_'); 
=> "one_two three"

// replaces all instances of ' ' with '_'
"one two three".replace(/\s/g, '_');
=> "one_two_three" 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-28T06:25:18.743

```
x = re.sub("\s", "_", txt) 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2009-06-19T07:30:53.917

```
perl -e 'map { $on=$_; s/ /_/; rename($on, $_) or warn $!; } <*>;' 
```

Match et replace space > underscore of all files in current directory

# asp.net - 从 MaskedEditValidator 中删除电话字段的下划线？

> ID：1007485
> 
> 赞同：0
> 
> 时间：2009-06-17T14:42:20.777
> 
> 标签：asp.net, ajaxcontroltoolkit

是否可以在 TextBox 中将 MaskedEditExtender 的掩码显示为（不带下划线）

```
(   )   - 
```

代替

```
(   )___-____ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:49:54.553

我认为 PromptCharacter 属性是您正在寻找的。示例取自 Ajax Control Toolkit 主页，添加了属性。

```
<ajaxToolkit:MaskedEditExtender
TargetControlID="TextBox2" 
Mask="9,999,999.99"
MessageValidatorTip="true" 
OnFocusCssClass="MaskedEditFocus" 
OnInvalidCssClass="MaskedEditError"
MaskType="Number" 
InputDirection="RightToLeft" 
AcceptNegative="Left" 
DisplayMoney="Left"
ErrorTooltipEnabled="True"
PromptCharacter=" "/> 
```

[在这里](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/maskededit/maskededit.aspx)检查，展开 MaskedEditExtender 属性。

# sql-server - VSTS Database Edition Schema Comparison

> ID：1007486
> 
> 赞同：2
> 
> 时间：2009-06-17T14:42:37.983
> 
> 标签：sql-server, database-tools

We use VSTS Database Edition to version control our database schemas. I like the idea of how it is supposed to work but have a big issue with the Schema Comparison feature. I like to use it for my deployments to see what has changed in the project vs a target database. Unfortunately, it shows many changes for objects that have not been changed. That happens even if I do it immidiately after re-creating a db project from the database.

The differences it finds are mostly white space. Some are caused by a different representation of the same thing, for example default constraints, "DEFAULT ((0))" vs "DEFAULT (0)". While I can go ahead and deploy the changes anyway and it does not cause any problems, it is definitely not ideal because it is hard to find actual changes when at least 50% of all objects are shown as modified. Is there any way to make this work better?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:54:21.813

我一直希望 VSTS 数据库版会变得更加可靠。同时，我仍然信任并使用[redgate 的 SQL 比较](http://www.red-gate.com/products/SQL_Compare/index.htm)来区分数据库。你可以告诉它你希望它如何处理空白、评论等。

我使用 SQL Compare 大约 5 年了，它一直非常可靠。我有自动构建脚本，使用 SQL 比较引擎 API 来区分我们的生产和开发数据库并自动生成更改脚本。

PS。我不隶属于redgate。我只是根据我的经验陈述我的看法。此外，为小家伙生根也没有错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T16:04:43.950

对此的解决方案是升级到 Database Edition GDR R2 版本，这是 Mitch Wheat 在他的评论中提出的建议。我之前用的是VS2008自带的标准版。GDR 版本似乎有一些很好的可用性特性，它解决了我在模式比较方面的所有问题。

有关 VSTS 数据库版 GDR 的一般信息：http: [//msdn.microsoft.com/en-us/magazine/dd483214.aspx](http://msdn.microsoft.com/en-us/magazine/dd483214.aspx)。

最新版本下载在[这里](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en)。

# wpf - WPF 转换器如何在 MVVM 模式中使用？

> ID：1007487
> 
> 赞同：19
> 
> 时间：2009-06-17T14:42:54.363
> 
> 标签：wpf, mvvm

假设我有一个绑定到**ViewModel A**的 View ，它有一个可观察的集合**Customers**。

这种 MVVM 模式的一个优点是我还可以将 View 绑定到**ViewModel B**，它用不同的数据填充它。

但是，如果在我的**视图转换器转换器**中显示我的客户，例如我有一个“ContractToCustomerConverter”，它接受合同并返回要显示的适当客户。

问题在于转换器**存在于 MVVM 模式之外**，因此不知道我的 ViewModel 有另一个客户来源。

*   View有没有办法**将 ViewModel 传递给 Converter**以便它参与 MVVM 模式提供的解耦？
*   有没有办法让我以某种方式**将转换器包含在我的 ViewModel**中，以便转换器使用 ViewModel 可用的当前依赖项？
*   或者转换器只是**美化了代码隐藏**，因此没有在 MVVM 模式中使用，所以如果您使用 MVVM，那么您只需创建自己的“转换器”（ViewModel 类上的方法），它会返回图像对象、可见性对象、FlowDocuments 等内容等要在视图上使用，而不是使用转换器？

*[（在看到MVVM Template Toolkit 下载](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=14962)附带的 WPF 演示应用程序中使用 Converters 后，我就想到了这些问题，解压后请参阅“Messenger Sample”。）*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T14:57:05.303

我通常在 MVVM 中根本不使用转换器，除了纯 UI 任务（例如 BooleanToVisibilityConverter）。恕我直言，您应该在 ContractViewModel 中声明 CustomerViewModel 类型的 Customer 属性，而不是使用 ContractToCustomerConverter

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T14:57:13.820

在[这次对话](http://groups.google.com/group/wpf-disciples/msg/86bce64b4546cf4d)中，有一条评论同意 Kent 的立场，根本不使用 Converters，很有趣：

> *ViewModel 基本上是类固醇上的值转换器。它采用“原始”数据并将其转换为易于演示的数据，反之亦然。如果您发现自己将元素的属性绑定到 ViewModel 的属性，并且您正在使用值转换器，请停止！为什么不在 ViewModel 上创建一个公开“格式化”数据的属性，然后完全放弃值转换器呢？*

在[这次谈话](http://conceptdev.blogspot.com/2009/02/silverlight-model-view-viewmodel-mvvm.html)中：

> *我能看到在 MVVM 架构中使用值转换器的唯一地方是跨元素绑定。如果我将面板的 Visibility 绑定到 CheckBox 的 IsChecked，那么我将需要使用 BooleanToVisibilityConverter。*

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-17T14:51:11.400

转换器应该很少与 MVVM 一起使用。事实上，我努力完全不使用它们。VM 应该完成视图完成工作所需的一切。如果视图需要`Customer`基于 a `Contract`，则 VM 上应该有一个`Customer`属性，只要发生更改，VM 逻辑就会更新该属性`Contract`。

> 这种 MVVM 模式的一个优点是我还可以将 View 绑定到 ViewModel B，它用不同的数据填充它。

我对这种说法提出异议。根据我的经验，视图不会在不同的 VM 类型之间共享，这也不是 MVVM 的目标。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-18T00:55:05.873

对于那些在视图中有效地说没有“非平凡转换器”的人，您如何处理以下问题？

假设我有一个气候传感器模型，它代表给定位置的各种仪器（气压计、湿度计、温度计等）读数的时间序列。

假设我的视图模型从我的模型中公开了一个可观察的传感器集合。

我有一个包含 WPF 工具包的视图，该工具包`DataGrid`绑定到视图模型，其`ItemsSource`属性设置为可观察的传感器集合。对于给定的传感器，我如何表示每个仪器的视图？通过显示一个小图（想想 Edward Tufte 迷你图[）](http://en.wikipedia.org/wiki/Sparkline)，该图是通过使用转换器 ( `TimeSeriesToSparklineConverter`)将时间序列转换为图像源而生成的

以下是我对 MVVM 的看法：模型向视图模型公开数据。View Model 向 View 公开行为、模型数据和状态。视图的工作是直观地表示模型数据，并为与视图模型状态一致的行为提供接口。

因此，我不相信迷你图图像会出现在模型中（模型是数据，而不是它的特定视觉表示）。我也不相信迷你图图像会出现在视图模型中（如果我的视图想要以不同的方式表示数据，比如一个网格行，只显示系列的最小值、最大值、平均值、标准偏差等？）。因此，在我看来，视图应该处理将数据转换为所需表示的工作。

因此，如果我想在命令行界面而不是 WPF GUI 中公开某个视图模型的行为、模型数据和给定状态，我不希望我的模型和视图模型包含图像。这是错的吗？我们有 a`SensorCollectionGUIViewModel`和 a`SensorCollectionCommandLineViewModel`吗？这对我来说似乎是错误的：我认为视图模型是视图的抽象表示，而不是具体的并且与这些名称所暗示的特定技术相关联。

这就是我对 MVVM 不断发展的理解。所以对于那些说不要使用转换器的人，你在这里做什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-09T06:38:53.507

我多年来一直在使用 Stackoverflow，这是我发布的第一个答案。

我认为converters属于MVVM中的View，考虑以下情况：

应用由 3 个团队开发，webapi 团队、webclient 团队和 UI 团队。UI 经常更改，因此 webclient 团队（从 webapi 接收数据并将它们放入 viewmodel）不能总是修改 viewmodel 以满足 UI 需求。当 UI 团队有不同版本的设计时，这将变得不可能。所以 UI 团队必须有自己的方式来呈现数据，而解决方案就是 Converters。

希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-06T16:08:32.080

我会在这个讨论中添加我的 2 美分。

我确实使用转换器，这是有意义的。

说明：在某些情况下，您需要在 UI 中以更多方式表示 Model 中的 1 个值。我通过 1 类型公开这个值。另一种是类型通过转换器处理。如果要通过 VM 中的 2 个属性公开 1 个值，则需要手动处理更新通知。

例如，我有一个具有 2 个整数的模型：`TotalCount`, `DoneCount`. 现在我希望这两个值都显示在 TextBlocks 中，另外我想显示完成百分比。

我使用`DivisionConverter`multi 转换器解决了这个问题，它需要 2 个前面提到的整数。

如果我在 VM 中有特别之处`PercentDone`，我需要在更新时更新此属性`DoneCount`。

# python - How to tell Buildout to install a egg from a URL (w/o pypi)

> ID：1007488
> 
> 赞同：5
> 
> 时间：2009-06-17T14:43:00.340
> 
> 标签：python, buildout, egg

I have some egg accessible as a URL, say [http://myhosting.com/somepkg.egg](http://myhosting.com/somepkg.egg) . Now I don't have this somepkg listed on pypi. How do I tell buildout to fetch and install it for me. I have tried a few recipes but no luck so far.

TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T15:27:51.513

You should just be able to add a 'find-links' option to your [buildout] section within the buildout.cfg file. I just tested this internally with the following buildout.cfg.

```
[buildout]
find-links  = http://buildslave01/eggs/hostapi.core-1.0_r102-py2.4.egg
parts = mypython

[mypython]
recipe = zc.recipe.egg
interpreter = mypython
eggs = hostapi.core 
```

You can just specify the full path to the egg as the value to 'find-links.' Make sure the egg's 'pyx.y' version matches your local Python version. If they don't match, you'll get a not found error which is slightly misleading.

# asp.net - 在 ASP.NET 中部署 Web 应用程序

> ID：1007493
> 
> 赞同：1
> 
> 时间：2009-06-17T14:43:58.700
> 
> 标签：asp.net, deployment

我想部署我的 ASP.NET 应用程序。它不是一个“网站”，它是一个网络应用程序。

我正在寻找 1) 最快的方法，以便我可以开始测试 2) 一种更自动化的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:48:39.970

准备测试的最快方法是从“构建”菜单中选择“发布”。

这将预编译所有内容，您可以将其部署到一个文件夹，然后在 IIS 中进行设置，更改连接字符串，然后您就可以开始使用了。

要“自动化”该过程，您很可能希望查看创建安装包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:52:21.583

如果您使用 MSBuild，请获取 MSBuild 社区任务 @ [http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)

并查看 WebDirectoryCreate 任务。还有很多其他任务库，但这是我个人使用的。

如果您正在考虑更改配置设置，那么简单的 xcopy 和文件夹命名结构对我来说是最简单的解决方案。

最快的方法是发布命令并在 IIS 中手动设置虚拟目录。我个人对此感到厌烦，所以我去研究了 NANT 和 MSBuild。

# r - 确定分布，以便生成测试数据

> ID：1007495
> 
> 赞同：3
> 
> 时间：2009-06-17T14:44:04.580
> 
> 标签：r

我的 Linux 机器上的文本文件中有大约 1 亿个值/计数对。我想弄清楚我将使用哪种公式来生成更多遵循相同分布的对。

从偶然的角度来看，它看起来像幂律，但我需要比这更严格一些。R可以轻松做到这一点吗？如果是这样，怎么做？还有其他更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T16:26:29.580

要查看您是否具有真正的幂律分布，请绘制频率的对数图，并查看它们是否大致排列在一条直线上。如果你确实有一条直线，你可能想阅读这篇关于[帕累托分布](http://en.wikipedia.org/wiki/Pareto_distribution)的文章，了解更多关于如何描述你的数据的信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T15:04:11.373

虽然成本有点高，但您可以准确地模拟样本的分布（无需对潜在人口分布进行任何假设），如下所示。

您需要一个可以快速搜索“key <= X 的最高条目”的文件结构——例如，Sleepycat 的伯克利数据库有一个 btree 结构；SQLite 甚至更容易，虽然可能没有那么快（但在键上有一个索引应该没问题）。

将数据以对的形式放置，其中键是到该点的累积计数（按递增值排序）。称 K 为最高键。

要生成一个与样本完全遵循相同分布的随机对，请生成一个介于 0 和 K 之间的随机整数 X，并在该文件结构中使用提到的“最高为 <=”查找它并使用相应的值。

不知道如何在 R 中完成所有这些工作——在你的鞋子里，我会尝试一个 Python/R 桥，在 Python 中进行逻辑和控制，只在 R 本身中进行统计，但是，这是个人选择！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-27T08:54:55.430

I'm assuming that you're interested in understanding the distribution over your categorical values.

The best way to generate "new" data is to sample from your existing data using R's sample() function. This will give you values which follow the probability distribution indicated by your existing counts.

To give a trivial example, let's assume you had a file of voter data for a small town, where the values are voters' political affiliations, and counts are number of voters:

```
affils <- as.factor(c('democrat','republican','independent'))
counts <- c(552,431,27)
## Simulate 20 new voters, sampling from affiliation distribution
new.voters <- sample(affils,20, replace=TRUE,prob=counts)
new.counts <- table(new.voters) 
```

In practice, you will probably bring in your 100m rows of values and counts using R's read.csv() function. Assuming you've got a header line labeled "values\t counts", that code might look something like this:

```
dat <- read.csv('values-counts.txt',sep="\t",colClasses=c('factor','numeric'))
new.dat <- sample(dat$values,100,replace=TRUE,prob=dat$counts) 
```

One caveat: as you may know, R keeps all of its objects in memory, so be sure you've got enough freed up for 100m rows of data (storing character strings as factors will help reduce the footprint).

# android - Android：如何创建自定义按钮小部件

> ID：1007507
> 
> 赞同：3
> 
> 时间：2009-06-17T14:45:22.767
> 
> 标签：android, widget

我想创建一个具有圆形或矩形背景、文本和文本下方或上方的图像的按钮。

这是我添加对象的 CustomButton 布局（背景和文本 - ImageView 缺失）：

```
<FrameLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_height="wrap_content"
 android:orientation="horizontal" android:layout_width="wrap_content" android:layout_gravity="center_vertical|center_horizontal"> 
```

我想使用 setText() 和 setImage() 方法创建一个 CustomButton 对象，这将更改按钮文本和图像并将多个 CustomButtons 放置到主布局中。

有谁知道如何创建自定义布局，将其放入另一个布局（主）并从绑定到主布局的活动中修改其元素？

我将衷心感谢您的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-11-09T09:43:03.597

嘿，要创建圆形按钮或矩形按钮，您可以使用 shape。它可以在 .xml 文件中完成。

看到这个[点击这里](http://nishantvnair.wordpress.com/2010/11/09/customize-button-in-android/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T15:39:41.177

如果你想要编程访问，你应该继承 View 并在 java 中完成你的工作。您仍然可以在 xml 中进行布局，但具有您想要的图像和文本方法。然后，您将能够在另一个布局中使用它来放置您的自定义按钮。

# reporting-services - 是否可以在 SQL Reporting Services (2008) 中使用开放式字体 (.otf)

> ID：1007509
> 
> 赞同：3
> 
> 时间：2009-06-17T14:45:32.503
> 
> 标签：reporting-services, fonts

当您尝试选择已安装在客户端和服务器上的 .otf 类型的字体时，该字体不会出现在可用字体的下拉列表中。

该字体可以在word中很好地使用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-28T09:36:25.177

得到了MS的回复。显然 .net 不支持 otf 字体，因此不支持 SSRS。所以基本没有！

# sql-server - 如何在 SQL Server 中查看存储过程和触发器的执行计划？

> ID：1007514
> 
> 赞同：1
> 
> 时间：2009-06-17T14:46:47.553
> 
> 标签：sql-server

如何在 SQL Server 中查看存储过程和触发器的执行计划？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:31:14.627

你可以做

```
set showplan_text on 
```

或按 CTRL + K ，它将作为单独的选项卡包含在查询结果旁边

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:47:58.707

是的，您可以使用 SQL Profiler。请参阅[使用 SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms187929.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:48:50.560

假设您使用的是 MSSQL，是的，[请参见此处](http://msdn.microsoft.com/en-us/library/ms190233.aspx)

# c# - 断开连接时如何重新连接到 SQLServer？

> ID：1007516
> 
> 赞同：1
> 
> 时间：2009-06-17T14:47:20.813
> 
> 标签：c#, sql-server, compact-framework

我已经为 .NET Compact Framework 和本地 SQL Server 编写了自己的小型静态 DAL 类，这正是我所需要的；GetTable(SQL,params), Exec(SQL,params), ExecScalar(SQL,Params) 等。我想用 SQL 做所有事情，所以如果有更好的方法在 C# 中处理 SQL 连接 - 除了 ORM-请告诉我。以下是我在 DAL 类下授予对 SQLConnection 对象的公共访问权限的方法：

```
 public static SqlConnection Conn()
    {
        if (ConnStr == "")
            Defaults();
        try
        {

            if (conn == null)
                conn = new SqlConnection(ConnStr);
            if (conn.State != ConnectionState.Open)
            {
                conn.Open();
                Execute("SET DATEFORMAT DMY",null);
            }
            return conn;
        }
        catch
        {
            System.Windows.Forms.MessageBox.Show("Unable to connect to DB");
        }
        return null;
    } 
```

我正在编写的应用程序正在移动 Windows CE 5.0 上使用。问题是，当用户从无线网络断开然后重新连接时，`if (conn.State != ConnectionState.Open)`线路没有得到执行，并且应用程序给出了一般数据库异常，仅此而已。我该如何解决？

编辑：原来异常是由 GetTable() 等函数引发的。我可以在每个函数中使用 try-catch 来处理它，但不幸的是，在 Compact Framework 中，每个 sql 错误都被命名为“SqlException”。如何区分连接问题和查询问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:55:30.050

你可以使用`System.Net.NetworkInformation.NetworkInterface`类来检查网络是否可用？

您可以使用 GetIsNetworkAvailable() 检查 .NET 2.0 中的网络连接：

```
System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable() 
```

要监视 IP 地址的变化或网络可用性的变化，请使用 NetworkChange 类中的事件：

```
System.Net.NetworkInformation.NetworkChange.NetworkAvailabilityChanged
System.Net.NetworkInformation.NetworkChange.NetworkAddressChanged 
```

根据之前的 SO 答案：[C# - How do I check for a network connection](https://stackoverflow.com/questions/520347/c-how-do-i-check-for-a-network-connection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:51:17.490

您可以捕获 SqlException 并检查[ErrorCode](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.externalexception.errorcode.aspx)属性以查看它是否是与连接丢失相关的错误（即错误消息类似于“无法连接到服务器”并且具有特定的错误代码）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T01:23:31.010

如果您正在处理移动应用程序，您将永远无法依赖网络访问。

更好的方法是让所有人访问本地数据库（SQL CE、Sqlite），然后将更改与主数据库同步（.Net 同步服务将对此有所帮助）。

这是否适用于您的应用程序的数据量是另一回事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-26T10:20:18.243

我已经通过为每个查询使用新的 SqlConnection 而不是为所有内容共享一个静态 SqlConnection 来修复它。

# wpf - 如何从 WPF 中的私有内部类声明资源？

> ID：1007520
> 
> 赞同：4
> 
> 时间：2009-06-17T14:47:47.663
> 
> 标签：wpf, private, converter, inner-classes

我正在尝试在 WPF UserControl 中声明一个资源，并且我希望该资源成为私有内部类的实例。我该怎么做呢？

XAML：

```
<UserControl ...>
    <UserControl.Resources>
        <local:MyConverter x:Key="MyConverter" />
    </UserControl.Resources>
</UserControl> 
```

代码背后：

```
public partial class MyUserControl : UserControl 
{
    private class MyConverter : IValueConverter 
    {
        // convertion code...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:53:35.247

如果课程是私人的，你不能这样做，你可以把它改成内部的

关于 XAML 中内部类的声明，你应该看看[这个讨论](https://stackoverflow.com/questions/863180/binding-converter-as-inner-class/)

# postgresql - 如何在 postgresql 8.3.7 中的分区表上使用索引

> ID：1007523
> 
> 赞同：5
> 
> 时间：2009-06-17T14:48:25.977
> 
> 标签：postgresql, indexing, partitioning

我的情况是，运行一个按分区表中的索引列过滤的查询，执行全表扫描。

显然，这是 postgresql 中的一个已知问题，[这里](http://benjamin.smedbergs.us/blog/tag/postgresql/)有详细解释。

除了在每个分区上执行查询，然后对所有结果执行 UNION 之外，还有更优雅的方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-21T16:28:27.607

索引可以很好地只扫描 PostgreSQL 中的相关分区。但是，您必须正确设置所有内容才能使其正常工作，并且很容易错过[http://www.postgresql.org/docs/current/static/ddl-partitioning.html中记录的长长列表中的一个步骤](http://www.postgresql.org/docs/current/static/ddl-partitioning.html)

要意识到的主要事情是，为了避免顺序扫描，您必须向 PostgreSQL 提供足够的信息，以便它可以证明某些分区不能拥有您要查找的数据；然后将它们作为查询结果的潜在来源跳过。您链接到的文章指出了这一点作为 seq 扫描问题的解决方案：“如果您向每个分区的日期字段添加范围约束，则可以将此查询优化为一个循环，您首先查询“最新”分区并工作倒退，直到您找到一个高于所有剩余分区范围的单个值。”-但没有显示您在更改后看到的改进计划。

您可能犯的一些常见错误：

- postgresql.conf 文件中的 constraint_exclusion 参数默认是关闭的。使用该默认值，您将无法获得预期的结果。

- 没有使用 CHECK 创建不重叠的分区，这使规划者无法知道每个分区内的内容。可能会错过这一步，但仍然可以将您的数据正确地放入正确的分区中，规划者不会知道这一点。

-没有在每个分区上放索引，只在主表上创建了一个。这将使您仅在相关分区上进行顺序扫描，因此没有上述那么糟糕，但也不是很好。

在即将发布的 PostgreSQL 版本中，有一些工作可以让这一切变得更容易（在 8.4 中设置 constraint_partition 是相当自动的，并且正在使用某种分区设置自动化）。现在，如果您仔细按照说明操作并避免所有这些问题，它应该可以工作。

# asp.net - 如何在不修改生产代码的情况下打破依赖关系？

> ID：1007530
> 
> 赞同：1
> 
> 时间：2009-06-17T14:49:04.367
> 
> 标签：asp.net, sql, vb.net, unit-testing

根据我对单元测试的初步阅读（我是初学者），将所有设置和测试与正在测试的代码放在一个单独的项目中是明智的。这对我来说似乎也很理想。然而，我最近开始阅读单元测试的艺术，试图发现如何打破对数据库调用等事物的依赖。提供的方法涉及更改测试代码的区域，例如向生产代码添加特定接口和“存根”方法。这似乎破坏了将测试和生产代码分开的一些好处。

是否有任何推荐的不涉及更改生产代码的依赖关系破坏技术？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T14:54:17.213

如果不进行某种更改，就无法打破依赖关系。重要的是您所做的更改不会改变生产中生产代码的行为，并且您不会引入更糟糕的依赖关系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T15:00:44.920

根据定义，需要在生产代码中打破依赖关系以使其更具可测试性，即，要使生产代码更具可测试性，您需要更改代码以使其与实际实现的耦合度降低。这将允许您在测试中用模拟对象替换被测类中的真实对象。这消除了对被测类所依赖的其他生产类的依赖。

如果您编写了松散耦合的生产代码——依赖于接口而不是实现的代码，使用工厂和依赖注入来创建对象而不是直接实例化的代码——那么你可能只需要进行一些小的更改或根本不需要你的生产代码。如果没有，那么您将需要进行这些类型的更改。然而，这并不是一件坏事，因为它将通过减少类之间的耦合来改进您的设计。这样做的代价是一些额外的（小）类和/或使隔离成为可能的接口。

如果您使用 TDD（测试驱动开发/设计），您在生产代码中使用的构造类型将发生变化，以使其更自然地可测试。这是 TDD 用于改进设计以及将测试合并到代码中的方法之一。

请注意，您不需要将生产代码中的耦合或依赖项引入测试代码。您的测试代码显然将依赖于生产，您可能需要重构生产中的依赖关系以使其更具可测试性，但如果您的生产代码“知道”任何关于它是如何被测试的，那么您可能做错了什么。当您应该使用依赖注入时，您可能已经引入了人工接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T18:51:45.007

我们使用 Spring 和工厂来打破依赖关系。使用 Spring 的依赖注入，从开发和测试到生产只是一个不同的 XML 文件。

# asp.net - 'System.Web.Security.SqlMembershipProvider'

> ID：1007535
> 
> 赞同：0
> 
> 时间：2009-06-17T14:49:39.233
> 
> 标签：asp.net, sqlmembershipprovider

我在 IIS 上运行我的网站。默认页面显示此消息：

> “/Enterprise/EnterpriseASP”应用程序中的服务器错误。无法将“System.Web.Security.SqlMembershipProvider”类型的对象转换为“EnterpriseASPClient.Core.EnterpriseMembershipProvider”。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.InvalidCastException：无法将“System.Web.Security.SqlMembershipProvider”类型的对象转换为“EnterpriseASPClient.Core.EnterpriseMembershipProvider”类型。
> 
> 源错误：
> 
> 第 78 行：第 79 行：受保护的覆盖 Sub OnLoad(ByVal e As System.EventArgs) 第 80 行：
> MyBase.OnLoad(e) 第 81 行：
> Helper.WireViews(Me) 第 82 行：
> 结束 Sub
> 
> 源文件：C:\Enterprise\EnterpriseASPClient\Core\PageBase.vb 行：80
> 
> 堆栈跟踪：
> 
> [InvalidCastException：无法将“System.Web.Security.SqlMembershipProvider”类型的对象转换为“EnterpriseASPClient.Core.EnterpriseMembershipProvider”类型。] Login.Page_Load(Object sender, EventArgs e) +607
> System.Web.UI.Control.OnLoad (EventArgs e) +99
> EnterpriseASPClient.Core.PageBase.OnLoad(EventArgs e) 在 C:\Enterprise\EnterpriseASPClient\Core\PageBase.vb:80 System.Web.UI.Control.LoadRecursive() +47 System.Web.UI .Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）+1436

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-12T23:33:32.897

看起来您错误地尝试（显式或隐式）将 type 对象强制`System.Web.Security.SqlMembershipProvider`转换为 type `EnterpriseASPClient.Core.EnterpriseMembershipProvider`。

请提供有关您的程序中实际发生的事情的更多详细信息。

我猜你被覆盖的`OnLoad()`函数——或者实际上是`Helper.WireViews()`它调用的方法——正在做一些不建议使用强制转换的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-20T03:21:43.647

如果您使用的是自定义 AccountMembershipProvider，请记住您需要在 Web 配置中进行设置：

```
<membership defaultProvider="AccountMembershipProvider">
    <providers>
        <clear/>
        <add name="AccountMembershipProvider" type="Foo.Bar.AccountMembershipProvider"/>
    </providers>
</membership> 
```

# bash - 检查 bash 脚本中是否存在函数

> ID：1007538
> 
> 赞同：21
> 
> 时间：2009-06-17T14:50:16.067
> 
> 标签：bash, function

如何确定某个函数是否已在 bash 脚本中定义？

我正在尝试使我的 .bash_login 脚本在系统之间可移植，因此我想添加逻辑以仅在函数存在时才调用它。

仅当该系统上存在该功能时，我`__git_ps1()`才想添加。`PS1`这个函数通常在`git-completion.bash`git 源中定义，或者由 ports/apt 安装的 bash 完成脚本之一定义。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-09-13T22:07:48.167

我意识到这是一个老问题，但没有其他答案能像我想要的那样简单。这使用`type -t`（如 Chen Levy 的评论中所建议的）作为一种有效的测试类型，但随后使用 shell 字符串比较而不是调用 grep。

```
if [ "$(type -t somefunc)" = 'function' ]; then
    somefunc arg1 arg2
fi 
```

更进一步，它也间接地起作用：

```
funcname=do_it_special_$somehow
if [ "$(type -t $funcname)" != 'function' ]; then
    funcname=do_it_normal
fi
$funcname arg1 arg2 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T15:00:56.153

```
if type __git_ps1 | grep -q '^function$' 2>/dev/null; then
    PS1=whatever
fi 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-17T15:00:16.793

您可以使用：

```
type function_name 
```

in 将返回您的函数定义，以防它存在。因此，您可以检查输出是否为空。

PS。更好的是，我刚刚检查过它将输出该函数不存在，否则输出函数体。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-11-08T11:55:35.813

如果您需要`/bin/sh`兼容的版本，则不能使用`typeset`或`declare`测试函数定义，因为它不是内置的 shell。此外，在某些系统上可能不提供该`-f`选项。`type`

我提出的解决方案已经部分包含在其他答案中：

```
isFunction() {
  type $1 | head -1 | egrep "^$1.*function\$" >/dev/null 2>&1;
  return;
}

isFunction __git_ps1 && PS1=__git_ps1 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-17T15:02:12.530

声明 -F 'function_name' > /dev/null

回声$？

美元？如果函数存在，则结果值为 0，否则为 1

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-28T20:52:12.363

我认为最好使用声明，即使它比类型稍慢。还为 PATH 中的别名或脚本键入 suceeds。

我正在使用这个：

```
function function_exists
{
    FUNCTION_NAME=$1

    [ -z "$FUNCTION_NAME" ] && return 1

    declare -F "$FUNCTION_NAME" > /dev/null 2>&1

    return $?
} 
```

所以稍后在我的脚本中，我可以很容易地看到发生了什么：

```
if function_exists __git_ps1
then
    PS1=__git_ps1
fi 
```

甚至是仍然可读的单行：

```
function_exists __git_ps1 && PS1=__git_ps1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-05T13:25:34.613

您可以列出所有可用的函数或使用 compgen 检查单个函数：

```
help compgen

compgen -A function

compgen -A function myfunc 1>/dev/null && echo 'myfunc already exists' || exit 1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T15:11:41.123

```
if declare -F | grep __git_ps1$
then
    PS1=whatever
fi 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-31T16:30:04.087

请注意，busybox（极简的多合一 shell 实现，例如在 Windows 上很有用）具有“type”但“type -t”打印错误的内容，所以我只检查 type 的返回值以查看是否有可调用的内容。busybox 也没有声明。

# javascript - 解析 XML 并在 MySQL 表中插入数据

> ID：1007539
> 
> 赞同：1
> 
> 时间：2009-06-17T14:50:22.010
> 
> 标签：javascript, mysql, xml

我正在尝试解析我拥有的 xml 文件（使用 javascript DOM）。然后我想将此数据插入到 mysql 表中（使用 php）。

我知道如何解析 xml 数据。但我无法弄清楚如何一起使用 php 和 javascript 并在 mysql 表中插入数据。

请帮助我。

最好的泽山

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T14:57:45.723

JavaScript 需要将数据发送到服务器。有几种方法可以实现这一点。

1.  生成表单并提交
2.  直接使用[XMLHttpRequest](http://www.jibbering.com/2002/4/httprequest.html)
3.  使用像[YUI](http://developer.yahoo.com/yui.)或[jQuery这样的库](http://jquery.com/)

在那里，您获取数据（例如来自 $_POST）并[像往常一样将其插入 MySQL](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:59:35.640

为什么不直接使用[PHP DOM](http://au.php.net/book.dom)来解析 XML？

例如：

```
$doc = new DOMDocument();
$doc->load('book.xml');
echo $doc->saveXML(); 
```

加载文档后`$doc`，您可以使用 PHP DOM 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:59:16.080

您可以使用 jQuery 来执行此操作，例如：

```
<house>
 <roof>as</roof>

<door>asd</door><window number="12">iles</window></house> 
```

$('path_to_xml',xml).each(function(){ 屋顶 = $('屋顶',this).text(); door = $('door',this).text(); num_wind = $(' window',this).attr('number'); });

# c# - 在 C# 中查找 MP3 长度

> ID：1007547
> 
> 赞同：8
> 
> 时间：2009-06-17T14:51:29.230
> 
> 标签：c#, mp3

我正在使用[TagLib#](http://developer.novell.com/wiki/index.php/TagLib_Sharp)从一些 MP3 中获取 ID3 标签数据，但我似乎无法找到 MP3 的长度。如何在 C# 中找到 MP3 的长度？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-12-12T22:43:48.233

[TagLib#](https://github.com/mono/taglib-sharp)公开此信息 TagLib.File.Properties.Duration

# c# - 正确分配命名空间（使用 ReSharper 的建议）

> ID：1007550
> 
> 赞同：2
> 
> 时间：2009-06-17T14:52:09.883
> 
> 标签：c#, visual-studio, namespaces, resharper

假设我们在一个主命名空间为 的项目中有以下*文件*`MyNamespace`和 [文件夹] 结构：

*   [实体]
    *   *文章.cs*
    *   *类别.cs*
*   [接口]
    *   *IReviewable.cs*
    *   *ISearchable.cs*
*   *枚举.cs*

根据 ReSharper 的建议，类的命名空间`Article`应该`Category`是**MyNamespace.Entities**，命名空间应该是**MyNamespace.Interfaces**`IReviewable`，类的命名空间应该是简单的**MyNamespace**。`ISearchable`**`Enumerations`**

 ****这是因为 ReSharper 的建议基于文件夹结构，并且其建议基于文件在结构中的位置。

* * *

您如何看待上述命名空间？您认为仅在其文件夹位置为类（接口等）实现名称空间是否正确？

还是您认为命名空间声明不应仅取决于文件夹结构？

就个人而言，我会将上述所有文件放在单个**MyNamespace**下，因为它们都彼此相关。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T14:55:42.357

我认为 ReSharper 的建议很好。我认为将课程等分组，而不是他们所做的事情是错误的。

一个类比是将文档分组到 Word、Excel 等子文件夹中，而不是按项目或其他一些功能分组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T14:58:35.767

请注意，ReSharper 将“命名空间提供程序”属性添加到项目中的每个文件夹。对于要用于组织但不参与命名空间的文件夹，您可以将该属性设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T06:53:45.227

将文件组织在有意义的文件夹中并从该结构构建命名空间是一种很好的做法。Java 多年来一直遵循该规则，并且效果很好。

另请注意，当您有很多如上所述的子命名空间时，是时候考虑按照 Patrick 的建议进行分级了（嗯，你认识他吗？）

[http://codebetter.com/blogs/patricksmacchia/archive/2009/02/15/re-factoring-re-structuring-and-the-cost-of-levelizing.aspx](http://codebetter.com/blogs/patricksmacchia/archive/2009/02/15/re-factoring-re-structuring-and-the-cost-of-levelizing.aspx)****

# documentation - 如何在 Sandcastle 文档网站中创建类似 MSDN 的链接？

> ID：1007555
> 
> 赞同：5
> 
> 时间：2009-06-17T14:53:11.457
> 
> 标签：documentation, web, hyperlink, sandcastle, permalinks

我已经用 Sandcastle 生成了我的项目的网站文档。这个网站使用框架，所以当我点击网站时，我在浏览器中的 URL 不会改变。

当我浏览使用 Sandcastle 生成的网站文档时，我希望在浏览器中更改 URL。为什么？因为我想从我的开发人员环境的其他部分链接到文档的具体子页面。

此外，我希望此链接永久有效。因此，当我从项目的新版本再次生成文档时，链接不会改变，因此我不需要将所有链接都更改为新的。

这可能吗？如何实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-08-08T16:03:32.497

为了创建指向文档特定子页面的正确链接，您可以使用类似的请求：$DOCUMENTATION_ROOT$/Index.aspx?topic=html/$TOPIC_ID$.htm

例如[http://www.ewoodruff.us/shfbdocs/Index.aspx?topic=html/8dcbb69b-7a1a-4049-8e6b-2bf344efbbc9.htm](http://www.ewoodruff.us/shfbdocs/Index.aspx?topic=html/8dcbb69b-7a1a-4049-8e6b-2bf344efbbc9.htm) 而不是[http://www.ewoodruff.us/shfbdocs/html/8dcbb69b- 7a1a-4049-8e6b-2bf344efbbc9.htm](http://www.ewoodruff.us/shfbdocs/html/8dcbb69b-7a1a-4049-8e6b-2bf344efbbc9.htm)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-08T13:06:35.100

如果您将以下代码添加到浏览器顶部，`SplitScreen.js`则会“注入” TOC 框架并专注于您直接链接到的内容（使用 Vitaly Shibaev 展示的技巧）。

```
if (window==top) {
    window.location = "/?topic=" + (window.location.pathname.substring(1));
} 
```

此代码适用于文档放置在您网站的根目录中 - 如果您将其放在子文件夹中，则需要扩展“/？topic”并从路径名部分中删除子文件夹部分。

通过此更改，您可以使用“直接链接”。我还希望通过 Google 找到您的人获得更好的体验（获得他们搜索的内容和 TOC 栏）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-13T05:37:54.233

[Vitaliy](https://stackoverflow.com/questions/1007555/how-to-create-msdn-like-links-in-sandcastle-documentation-website/3434997#3434997)和[mawtex](https://stackoverflow.com/questions/1007555/how-to-create-msdn-like-links-in-sandcastle-documentation-website/3668023#3668023)解决了您问题的“如何链接到文档子页面”部分。

“使链接永久化，因此在重新生成文档时它们不会改变”部分问题会自动解决，因为默认情况下创建的 html 文件名基于主题名称的哈希值。即，如果您不更改正在记录的代码部分，那么它将使用相同的文件名。

您可以更改生成 html 文件名的方式，但所有给定的方法都基于成员名称或主题 ID 的哈希，因此如果代码没有更改，链接不应中断。

有关详细信息，请参阅 Sandcastle 帮助文件生成器的[NamingMethod](http://www.ewoodruff.us/shfbdocs/Index.aspx?topic=html/c18d6cb6-e4e4-4944-84ee-f867aa6cfb0d.htm)文档。

# c# - 使用 SMO 查找数据文件路径，包括数据文件名

> ID：1007561
> 
> 赞同：0
> 
> 时间：2009-06-17T14:54:17.570
> 
> 标签：c#, sql-server-2008, smo

我确实喜欢

```
 foreach(LogFile lf in db.Databases)
      Console.WriteLine(lf.FileName) 
```

显示包含扩展名的日志文件路径.....我的问题是如何找到

数据文件的确切路径，包括扩展名..给我指导

任何帮助是极大的赞赏...

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:05:16.863

```
 foreach (FileGroup fg in database.FileGroups)
    {
        foreach (DataFile df in fg.Files)
        {
            Console.WriteLine(Path.Combine(database.PrimaryFilePath, df.Name);
        }
    } 
```

# nhibernate - 回滚后的 Session.Transaction 更改（NHibernate）

> ID：1007563
> 
> 赞同：6
> 
> 时间：2009-06-17T14:54:28.490
> 
> 标签：nhibernate, transactions

我有以下代码（为了讨论而简化）。我不明白为什么该`session.Transaction`属性在回滚后返回不同的事务。

例如，这意味着`Session.Transaction.WasRolledBack`除非我存储对第一个事务的引用并检查该事务的属性，否则该属性几乎没有帮助。

有人可以在这里提供一些见解吗？

```
int transId = session.Transaction.GetHashCode();

using (var tx = session.BeginTransaction())
{
   Assert.AreEqual(transId, tx.GetHashCode());

   tx.Rollback();

   Assert.AreEqual(transId, tx.GetHashCode());
   Assert.AreEqual(transId, session.Transaction.GetHashCode()); // Fails
} 
```

**更新：**

David Walschot 的回答非常有帮助且准确。另外，我在[Nhibernate 文档](http://nhibernate.info/doc/nhibernate-reference/manipulatingdata.html#manipulatingdata-endingsession-commit)中发现了以下内容：

> 如果您回滚事务，您应该立即关闭并丢弃当前会话，以确保 NHibernate 的内部状态是一致的。”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T15:05:54.427

来自 NHibernate in Action（Kuaté、Harris、Bauer、King）：

> 提交事务后，NHibernate 会话将其替换为新事务。这意味着如果您认为以后需要它，您应该保留对您正在提交的事务的引用。如果您需要调用 transaction.WasCommited，这是必要的。session.Transaction.WasCommitted 总是返回 false。

很可能这同样适用于`Transaction.WasRolledBack`财产。

# elisp - 在 emacs-lisp 中包装带引号的函数

> ID：1007568
> 
> 赞同：1
> 
> 时间：2009-06-17T14:55:25.853
> 
> 标签：elisp, cscope

我使用 cscope emacs 扩展（并发现它非常有用）。不幸的是，仅搜索当前目录及以下目录的默认行为对我来说是不够的，因此我将 cscope-set-initial-directory 用于我选择的目录。不幸的是，这对我来说也不够用，因为我有多个不同的项目，每个项目都有自己的“初始”目录。

我已经为我在 emacs 中使用最多的三个 cscope 方法设置了热键

```
(global-set-key [f9] 'cscope-find-this-text-string)
(global-set-key [f8] 'cscope-find-global-definition)
(global-set-key [f7] 'cscope-find-this-symbol) 
```

我认为以某种方式用函数包装这些调用以在给定路径上运行 cscope-set-initial-directory （通过查看缓冲区文件名是什么而生成）会很容易。但我一直没有成功！

```
(global-set-key [f9] (lambda () (interactive) (cscope-set-initial-directory "blah") 'cscope-find-this-text-string)) 
```

不起作用。我也尝试向两个 cscope-hooks 添加钩子，但在我的正常使用模式中，它们似乎都没有被调用。我什至不介意每次切换缓冲区时运行一次它，但我也没有在任何地方看到一个钩子：/。

有人可以帮忙吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:30:42.100

免责声明：我尚未安装 cscope，因此无法对此进行测试。

```
(global-set-key (kbd "<f9>") 'my-cscope-find-this-text-string)
(defun my-cscope-find-this-text-string (dir)
  (interactive "DRoot area to start search:")
  (let ((default-directory dir))
    (call-interactively 'cscope-find-this-text-string))) 
```

基本思想是您要提示从目录开始：这就是对交互式的调用。然后你设置目录： let 语句为你做这件事。然后你调用你想要的原始例程，并通过调用它`'call-interactively`得到提示。

您将类似地包装其他两个例程。

一旦这对您有用，您可以通过自定义根区域的提示来获得更好的体验，以使其拥有自己的历史变量，该变量在三个例程中共享。

关于您最初的解决方案，这是一个很好的尝试。大多数人没有意识到将`'interactive`函数转换为命令的必要性。引用名称对您不起作用的原因是引用只是告诉解释器将符号视为符号，而不是对它做任何事情。要调用例程，您通常会这样做：

```
(lambda ()
    (c-scope-find-this-text-string "some-string")) 
```

Unfortunately, with a direct call like the one just above, you have to provide an argument (the string to search for). So, you can either add some code to prompt for the string, or use the command's built-in code to do the prompting. That's what the '`call-interactively` is used for, it calls the command and invokes its `'interactive` form which does the prompting.

Also, it's generally a good idea to bind keystrokes to names of commands, as opposed to bare lambdas, for two reasons: first, if you ever do `C-h k` (`M-x describe-key`), you get a meaningful command name, and second, if/when you modify the function, you can do so without having to muck with the binding as well.

# c++ - 在提交期间获取 svn diff 以显示 C++ 函数

> ID：1007571
> 
> 赞同：6
> 
> 时间：2009-06-17T14:55:41.750
> 
> 标签：c++, regex, linux, svn, diff

每当我在 svn 中执行提交周期时，我都会在编写评论时检查差异。我认为在显示差异时显示我进行修改的实际功能会非常好。

我查看了[这个页面](http://www.xenomai.org/index.php/Teaching_-p_to_svn_diff)，其中提到 -p 选项将显示更改所在的 C 函数。但是，当我尝试将 -p 选项与一些 C++ 代码一起使用时，它通常会返回访问说明符（私有、公共、保护等），这不是很方便。

我确实注意到 diff 有一个 -F 选项，其作用与 -p 相同，但采用用户指定的正则表达式。 **我想知道：是否有一个简单的正则表达式来匹配 C++ 函数？**似乎这就是让它发挥作用所必需的一切。

我自己会花一些时间看这个，但是工作处于紧缩模式，这似乎是很多人会觉得有用的东西，所以我想我会把它贴在这里。

编辑：我不是在寻找一个灌篮高手包罗万象的正则表达式，而是在区域差异上方找到最近的函数定义的东西会显示。事实上，它远非完美，而且有些错误对我来说是可以接受的。只要它工作正常，恕我直言，可能有 60% 的时间会显着提高生产力。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T16:06:36.900

是否有一个简单的正则表达式来匹配 C++ 函数？不。

是否有（复杂的）正则表达式来匹配 C++。也许或可能写一个。

但我想说正则表达式既不容易完成这样的任务（假设你想要某种 excat 匹配），它们也不是完成这样任务的正确工具。

想想像这样的[案例](https://stackoverflow.com/questions/476173/regex-to-pull-out-c-function-prototype-declarations/476350#476350)。你会怎么处理这些东西。

```
void (*function(int, void (*)(int)))(int);

func1(int), func2(double); double func3(int); 
```

唯一真正的解决方案是使用使用 yacc/lex 的解析器。对于您的用例，这当然什么也没做。

所以要么拼凑一些不完整的正则表达式，它适合你代码中的大多数函数签名

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T16:21:03.560

如果您打算仅将其应用于**您的**提交，我建议您养成向函数添加提交注释的习惯，例如：

```
void something () 
{
    ...
    some thing = 1;
    ...
} 
```

到

```
void something () 
// last change by me: a better value for thing
{
    ...
    some thing = 2;
    ...
} 
```

将为您显示功能*和*您对编辑的评论。作为奖励，其他人将能够理解您在做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:03:36.990

TortoiseSVN 在其 C++ 文件的提交对话框中使用以下正则表达式来支持自动完成：

```
.h, .hpp, .hxx = ^\s*(?:class|struct)\s+([\w_]+)|\W([\w_]+)\(
.cpp, .c, .cxx = \W(([\w_]+)::([\w_]+))|\W([\w_]+)\( 
```

不过，我不知道它们有多准确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T15:58:55.713

我不知道 SVN 中有一个选项可以做到这一点，基于正则表达式的解决方案可能是以下一项或多项：

*   编码和维护的噩梦，有很多特殊情况
*   不正确，并且缺少几个有效的 C++ 函数

为此，您需要某种解析器。枚举所有可能的正则表达式在技术上是可行的，但是编写解析器是解决这个问题的正确方法。如果您有时间推出自己的解决方案，我会查看 ANTLR，他们在此页面上提供了几种 C/C++ 语法：

[ANTLR 语法列表](http://www.antlr.org/grammar/list)

# visual-studio - 在哪里可以访问 Visual Studio 2008 Professional 中的网站管理工具？

> ID：1007582
> 
> 赞同：2
> 
> 时间：2009-06-17T14:57:23.227
> 
> 标签：visual-studio

有谁知道在哪里可以访问 Visual Studio 2008 Professional 中的网站管理工具？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T15:06:15.830

这取决于您使用的是 Web 站点还是 Web 应用程序项目。

对于网站，它是*网站 --> ASP.NET 配置*。

对于 Web 应用程序，它是*Project --> ASP.NET 配置*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:01:27.353

打开一个 Web 项目并使用项目菜单 ASP.NET 配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:58:51.960

网站 -> ASP.NET 配置

# c++ - 让 Loki Singleton 在 VS 2008 C++ 的 DLL 中工作

> ID：1007585
> 
> 赞同：1
> 
> 时间：2009-06-17T14:57:51.510
> 
> 标签：c++, visual-studio-2008, loki

我很确定这个问题不是新问题，而且很确定它很难解决。希望我对后者的看法是错误的。

我正在尝试在我的程序中使用 Modern C++ Design 中的 Loki::Singleton。

但是，我似乎无法让它跨 DLL 工作。我想我知道为什么会发生这种情况：模板化代码在每个源模块中都被实例化，因此每个模块都有自己的全局变量，而不是一个全局变量。

显然，这使得 Singleton 非常不单一。

有没有办法解决这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:43:31.933

我在 Loki 源目录中看到他们有一个正在测试的特定[SingletonDLL 目录](http://loki-lib.svn.sourceforge.net/viewvc/loki-lib/trunk/test/SingletonDll/)，看起来他们使用了一个导出的、显式实例化的模板（这会起作用）。希望其中包含您想要的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:31:15.953

请注意，这不会解决这个问题。显式实例化和导出的单例应该可以解决问题......

-瑞克

[基本上在这里](http://msdn.microsoft.com/en-us/library/h90dkhs0(VS.80).aspx)查看#pragma data_seg ，您需要在代码的共享部分中声明单例的实例。默认情况下，静态变量的范围是 dll。

使用模板可能会变得棘手，但这是成功的途径，不涉及传递/复制静态数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:16:17.200

您可能是正确的，每个 DLL 都有自己的单例实例。我对 Loki 的实现不是很熟悉，而且[源代码](http://loki-lib.cvs.sourceforge.net/loki-lib/loki/include/loki/Singleton.h?view=markup)也不是很有趣。

可能的解决方案是：

*   不使用单例。这实际上是我通常的偏好，因为您可以通过将设计更改为不需要它们来避免整类问题。关于单身人士为何有害的长篇大论，请参阅[这篇](http://steve.yegge.googlepages.com/singleton-considered-stupid)Yegge 帖子。我并没有那么强烈地反对他们，但 95% 的情况下，单身人士造成的问题比他们解决的问题多得多（如果他们真的解决了任何问题）
*   跨 DLL 边界复制静态成员。我也将其作为 hack 来完成，其中 DLL 从应用程序或另一个 DLL 获取指针，并将其自己的静态类成员副本重置为从外部传递的指针。它很邪恶，很脏，你无法清理它，但它确实有效。

# java - 这三个特殊的浮点值是什么意思：正无穷大、负无穷大、NaN？

> ID：1007586
> 
> 赞同：12
> 
> 时间：2009-06-17T14:58:12.930
> 
> 标签：java, floating-point, nan, infinity

我们如何在代码中使用它们，什么会导致 NaN（不是数字）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T15:01:30.303

*   正无穷意味着在​​正方向上趋于无穷——在正方向上进入越来越大的值。
*   负无穷意味着在​​负方向上趋于无穷——在负方向上进入越来越大的值。
*   [非数字](http://en.wikipedia.org/wiki/Not_a_number)(NaN) 是未定义的东西，例如`0/0`.

以及来自类规范的常量[`Float`](http://java.sun.com/javase/6/docs/api/java/lang/Float.html)：

*   [`Float.NEGATIVE_INFINITY`](http://java.sun.com/javase/6/docs/api/java/lang/Float.html#NEGATIVE_INFINITY)
*   [`Float.POSITIVE_INFINITY`](http://java.sun.com/javase/6/docs/api/java/lang/Float.html#POSITIVE_INFINITY)
*   [`Float.NaN`](http://java.sun.com/javase/6/docs/api/java/lang/Float.html#NaN)

更多信息可以[在 Wikipedia 的 IEEE-754 页面中](http://en.wikipedia.org/wiki/IEEE_754-1985)找到。

下面是一个小程序来说明这三个常量：

```
System.out.println(0f / 0f);
System.out.println(1f / 0f);
System.out.println(-1f / 0f); 
```

输出：

```
NaN
Infinity
-Infinity 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-17T15:08:19.587

如果您想了解有关 Java 中浮点数的更多信息，[这可能是一个很好的参考。](http://introcs.cs.princeton.edu/java/91float/)

正无穷大是一个大到无法正常表示的正数。负无穷大是一个大到无法正常表示的负数。NaN 的意思是“不是数字”，它是由不会产生数字的数学运算产生的——比如将 0 除以 0。

在 Java 中，Double 和 Float 类都有代表所有三种情况的常量。它们是 POSITIVE_INFINITY、NEGATIVE_INFINITY 和 NaN。

另外考虑一下：

```
double a = Math.pow(10, 600) - Math.pow(10, 600); //==NaN 
```

在数学上，大家可以看到它是0。但是对于机器来说，它是一个“Infinity” - “Infinity”（同秩），它确实是NaN。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:06:13.833

*   1/0 将导致正无穷大。
*   0/0 将导致 Nan。您可以将 NaN 用作任何其他数字，例如：NaN+NaN=NaN, NaN+2.0=NaN
*   -1/0 将导致负无穷大。

无穷大（在java中）意味着一个操作的结果将是一个非常大的正数或负数，以至于无法正常表示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T15:10:17.430

这个想法是表示可以从对“正常”数字的操作中自然产生的特殊数字。您可以将无穷大（正数和负数）视为浮点表示的“溢出”，其想法是至少在某些情况下，函数返回这样的值仍然会产生有意义的结果。例如，它们仍然具有一些排序属性（例如，它们不会进行排序操作）。

Nan 非常特别：如果 x 是 Nan，则 x == x 为假（这实际上是测试 nan 的一种方法，至少在 C 中是这样）。如果您不习惯浮点特性，这可能会非常令人困惑。除非您进行科学计算，否则我会说通过操作返回 Nan 是一个错误，至少在大多数情况下是这样。Nan可以进行各种操作：0/0、inf - inf、inf/inf、0*inf。Nan 也没有任何有序属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:11:29.610

您可以将它们用作任何其他数字：

例如：

```
float min = Float.NEGATIVE_INFINITY;
float max = Float.POSITIVE_INFINITY;
float nan = Float.NaN; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-30T00:11:17.347

> 正无穷大是一个大到无法正常表示的正数。负无穷大是一个大到无法正常表示的负数。NaN 的意思是“不是数字”，它是由**不产生数字的数学运算产生的**——比如将 0 除以 0。

这不是一个完整的答案（或不够清楚） - 考虑一下：

```
double a = Math.pow(10,600) - Math.pow(10,600); //==NaN 
```

从数学上讲，每个人都可以看到它是 0。但对于机器来说，它是一个“无穷大”——“无穷大”（同阶）女巫确实是 NaN ......

# ruby-on-rails - 如何在 Windows 控制台中设置 RAILS_ENV？

> ID：1007589
> 
> 赞同：13
> 
> 时间：2009-06-17T14:58:41.900
> 
> 标签：ruby-on-rails, windows, ruby, windows-xp

在 Linux 和 OS X 上，我习惯于通过执行以下操作在指定的 Rails“环境”中运行 Rake 任务：

```
$ export RAILS_ENV=monster_island ; rake monsters:destroy_all 
```

如果我在 Windows 控制台中的 Windows XP 上运行任务，我该如何做？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-17T15:00:10.663

c:>set RAILS_ENV=monster_island

如果您在没有任何其他参数的情况下运行 set，您将看到已设置的环境变量。在控制台中运行 set 将为该控制台设置该变量，并且不会跨会话或其他控制台持续存在。

您也可以在控制面板中永久设置它 - 打开系统，选择高级，然后选择环境变量（这可能会根据您的 Windows 版本略有不同）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-23T19:41:20.873

当然，您可以使用“setX”（如果您希望变量在控制台会话之间持续存在（并且您不想浏览控制面板中的各种屏幕/选项卡），则可以使用“setX”而不是简单的“set”

# c# - 如何在c#的方法中将引用作为参数传递

> ID：1007596
> 
> 赞同：1
> 
> 时间：2009-06-17T14:59:37.997
> 
> 标签：c#, console

如何在 C# 中传递引用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T15:00:32.223

```
private void functionName (ref Type variableName)
{

} 
```

调用它

```
functionName(ref variable); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T15:04:31.233

您的问题非常不清楚，但是我[关于 C# 中的参数传递的文章](http://pobox.com/~skeet/csharp/parameters.html)很可能会回答您真正想问的任何问题。

特别是，您需要区分*按值传递引用和**按引用*传递参数。如果您对值类型和引用类型不太了解，您可能还想查看[我关于该主题的文章](http://pobox.com/~skeet/csharp/references.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:01:27.197

您可以使用此语法在 C# 中通过引用传递参数。

```
public void MyMethod(ref string myString)
{

} 
```

然后，您需要在传递时将 ref 放在值之前。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T15:16:42.737

[Jon Skeet 在这里](http://www.yoda.arachsys.com/csharp/parameters.html)有一篇很好的文章。

在 C# 中，默认情况下，值类型（如 int、double、byte 和 structs）按值传递。这意味着接收方法具有该类型的 NEW 实例。如果将值为 1 的 int 传递给方法，并且方法将其更改为 2，则此更改仅反映在方法内，调用位置的 int 仍为 1。如果添加了 ref 关键字，则更改对该整数进行的处理将反射回调用位置。

C# 中的所有类都是引用类型。这意味着，默认情况下，引用是按值传递的。这是重要的部分。这意味着，对该对象的该实例所做的更改将反映回调用位置，因为它是同一个对象。但是，如果方法更改它对不同对象的引用，则不会反映此更改。如果您希望这些更改反映回来，则需要在参数上使用 ref 关键字。

```
 public static void Main()
    {
        int i = 1;
        Method1(i); //i here is still 1
        Method2(ref i); //i is now 2

        SimpleObj obj = new SimpleObj();
        obj.Value = 1;

        Method3(obj); //obj.Value now 2
        Method4(obj); // obj.Value still 2
        Method5(ref obj); //obj.Value now 5
    }

    private static void Method5(ref SimpleObj obj)
    {
        obj = new SimpleObj();
        obj.Value = 5;
    }

    private static void Method4(SimpleObj obj)
    {
        obj = new SimpleObj();
        obj.Value = 5;
    }

    private static void Method3(SimpleObj obj)
    {
        obj.Value++;
    }

    private static void Method2(ref int i)
    {
        i++;
    }

    private static void Method1(int i)
    {
        i++;
    }

    public class SimpleObj
    {
        public int Value { get; set; }
    } 
```

`ref`C# 3.0 规范的第 10.6.1.2 节介绍了该关键字。[这](http://msdn.microsoft.com/en-us/library/14akc2c7.aspx)是 msdn 文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:03:59.937

下面是 C# 中参数传递的一个很好的概述：

[http://www.yoda.arachsys.com/csharp/parameters.html](http://www.yoda.arachsys.com/csharp/parameters.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T15:04:50.903

调用代码：

```
string companyName = "New Company";
GetEmail(ref companyName); 
```

方法代码：

```
private void GetEmail(ref string companyName)
{

} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-17T15:05:17.253

您的问题不清楚，但我想指出，在 C# 中，对象默认通过引用传递。这意味着，如果您有一个对象，然后将该对象传递给对该对象进行更改的方法，那么这些更改也会影响您调用代码中的对象，因为它们都引用同一个对象。

# c++ - STL 向量分配

> ID：1007597
> 
> 赞同：3
> 
> 时间：2009-06-17T15:00:04.237
> 
> 标签：c++, stl

我想知道为什么向量模板执行两次分配，而似乎只有一个是必要的。

例如这个：

```
#include <vector>
#include <iostream>

class A {
    public:
         A(const A &a) {
            std::cout << "Calling copy constructor " << this << " " << &a << "\n";
        }
         A() {
            std::cout << "Calling default constructor " << this << "\n";
        }
        ~A() {
            std::cout << "Calling destructor " << this << "\n"; 
        }
};

int main(int argc, char **argv)
{
    std::vector <A> Avec;

    std::cout << "resize start\n";
    Avec.resize(1);
    std::cout << "resize end\n";

    return 0;
} 
```

输出：

```
调整大小开始
调用默认构造函数 0x7fff9a34191f
调用复制构造函数 0x1569010 0x7fff9a34191f
调用析构函数 0x7fff9a34191f
调整大小结束

```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T15:12:48.610

它不执行两次分配，而是通过默认构造函数创建一个对象以传递给调整大小，然后将该对象复制到新位置，然后销毁参数。

如果您查看要调整大小的参数：

```
void resize(n, t = T()) 
```

它有一个默认构造的 T 类型对象作为默认参数（这是在输出中调用的默认构造函数）。然后，在函数中，它将 this 复制到正确的位置（这是复制构造函数）。在 resize 函数结束后，销毁参数（输出中的析构函数调用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:11:53.743

如果您以这种方式初始化对象，矢量模板会通过复制来创建对象。如果您不想调用复制构造函数，您应该：

```
vector<A*> Avec;
avec.push_back(new A()); 
```

[http://www.cplusplus.com/reference/stl/vector/vector/](http://www.cplusplus.com/reference/stl/vector/vector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:13:26.207

这是一个猜测：

1.  编译器重新排序了初始分配，`Avec`直到“resize start”之后
2.  向量最初分配有 0 个元素
3.  调整大小使新元素填充了默认值`A`（这是通过创建默认值`A`，将其复制到向量中并删除临时值来实现的。

# java - 在 Android 中使用“UNINSTALL_SHORTCUT”意图

> ID：1007598
> 
> 赞同：2
> 
> 时间：2009-06-17T15:00:05.220
> 
> 标签：java, android

我正在尝试使用以下意图操作，但 `ActivityNotFoundException`在第一种情况下（`startActivity`）我得到一个，而在第二种情况下（`sendBroadcast`）没有。

```
"com.android.launcher.action.UNINSTALL_SHORTCUT" 
```

我尝试将它与以下代码一起使用：

```
Intent i = new Intent("com.android.launcher.action.UNINSTALL_SHORTCUT");
startActivity(i); 
```

还有以下内容：

```
Intent i = new Intent("com.android.launcher.action.UNINSTALL_SHORTCUT");
sendBroadcast(i); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-03T13:15:45.313

首先，您需要拥有适当的权限：

```
<uses-permission android:name="com.android.launcher.permission.UNINSTALL_SHORTCUT" /> 
```

然后你需要做这样的事情：

```
Intent intent = new Intent(this, your main activitiy);
intent.setAction(Intent.ACTION_MAIN);
Intent removeIntent = new Intent();
removeIntent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, intent);
removeIntent.putExtra(Intent.EXTRA_SHORTCUT_NAME, "HelloWorldShortcut");
removeIntent.setAction("com.android.launcher.action.UNINSTALL_SHORTCUT");
sendBroadcast(removeIntent); 
```

# entity-framework - 您会使用 ADO.NET Entity Framework v3.5，还是等待 v4.0？

> ID：1007606
> 
> 赞同：2
> 
> 时间：2009-06-17T15:01:09.600
> 
> 标签：entity-framework, ado.net

我惊讶地发现一封公开信提议对实体框架进行不信任投票（请参阅[http://efvote.wufoo.com/forms/ado-net-entity-framework-vote-of-no-confidence/](http://efvote.wufoo.com/forms/ado-net-entity-framework-vote-of-no-confidence/)）

信中所述的原因是否会阻止您使用当前版本的实体框架？你宁愿等待 v4.0 吗？或者更确切地说使用另一个ORM？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T16:44:26.077

当前版本的 EF 绝对不是完美的，并且有很多陷阱和缺点。我现在可能不会使用它 - 但是升级到 EF v2（或者是 EF4？）的路径看起来很美好！

*   完全不了解持久性 - 您可以直接使用 POCO 类
*   延迟加载可配置为选项
*   大大改进了设计器，支持复数/单数化（即使是多种语言！）
*   能够进行“领域优先”设计并从您的模型创建数据库
*   具有跨多个层的自我跟踪实体的能力，允许您将数据发送到客户端并取回更改并将它们应用于您的实体上下文

总而言之，EF v2 看起来很有前途，我非常渴望给它一个认真的版本。如果它现在真的兑现了所有的承诺，那它绝对是赢家！

查看[ADO.NET 团队博客](http://blogs.msdn.com/adonet/)，了解有关 EF v2 的最新博客文章。

马克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T15:05:56.767

另一个ORM。

不要误会我的意思，您应该对响应感到愤怒，但目前只有 nHibernate 在功能上是完整的。

我是 TDD 粉丝，所以想要一个易于测试的 POCO ORM 解决方案。如果那是你的包，那么 EF3.5 就出来了。EF4.0 正在引入它（[http://blogs.msdn.com/adonet/archive/2009/05/21/poco-in-the-entity-framework-part-1-the-experience.aspx](http://blogs.msdn.com/adonet/archive/2009/05/21/poco-in-the-entity-framework-part-1-the-experience.aspx)），但它仍然有至少 1 个大缺点 -> 不支持继承。

NHibernate 更完整，但 EF 可能更易于使用。一如既往，最好的工作工具......但如果它是企业级 TDD 开发的应用程序，请使用 nHibernate。

另外 -> 有一个分析器可以让 nHibernate 开发更容易 -> [http://www.nhprof.com/](http://www.nhprof.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:17:07.087

我尝试将它用于我当前的项目，这基本上涉及重写我们当前混乱的数据层。

它只是行不通。

首先，如果您尝试将实体基于视图，设计者会尝试强制每个 NOT NULL 属性成为实体键......这几乎不是我想要的。要解决这个问题，您必须在至少两个位置编辑 xml，并且每次添加对象时都要这样做，因为它会刷新并重新添加 EntityKey 属性。 [必须为实体框架中的所有关键属性指定映射？](https://stackoverflow.com/questions/941826/must-specify-mapping-for-all-key-properties-in-entity-framework)

其次，当您创建关联时，您必须使用每个实体键 -[如何在不使用实体框架中的所有实体键的情况下进行关联？](https://stackoverflow.com/questions/946578/how-can-you-make-an-association-without-using-all-entity-keys-in-entity-framework)

这两件事让我坚持了 3 天，然后我回到 Linq to SQL 并在几个小时内完成了它。（嗯，至少我正在努力解决的系统部分......）我不知道这些是否在不信任投票中，但在我看来它还没有准备好。

此外，由于我在我提出的每个 EF 问题上都没有得到答案，我不得不假设当前的使用率很低，以至于很难获得帮助和支持……这可能是不使用某些东西的最大理由.

希望下个版本能更好...

编辑：我们目前的计划是坚持使用 Linq 2 SQL（我必须在星期五之前完成一个项目），然后评估所有其他 ORM 以查看是否有更好的方法。另一个开发人员讨厌 L2S，但我在使用它时从来没有遇到过任何重大问题......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T16:48:42.097

EF 有一些丰富的设计时支持，但我必须同意 nHibernate 是要走的路，尽管有学习曲线。如果您需要快速做某事并且不关心 TDD 或序列化（这是 MS 的所有 ORM 产品的一大弱点），请选择 EF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-17T10:12:49.220

好吧，我对第 1 版的体验很有趣。我想使用 POCO，但它不支持它。在阅读之后，我发现了一些来自 microsoft 的 bod 的代码。

生成代码有点混乱，但总的来说这部分过程还不错。

我遇到的一个真正令人讨厌的部分是缺乏内置的并发检查，用于 N 层开发。您必须自己进行管理，这在查看问题后并没有那么糟糕，特别是如果您想将版本控制交还给客户端以供用户干预。

缺少的第二个讨厌且绝对愚蠢的事情是 LINQ 查询的 IN 关键字。不支持，因此需要解决。我找到了一个解决方案，但是引入了一些其他代码来迅速修补遗漏，真是一团糟。

我会使用 EF 4.0 (2.0)。是的，当然，为什么不呢？事实上，在第 2 阶段，我将使用它。看起来它支持 POCO，看起来我的并发模型将毫无问题地直接移动（基本上是增量复制的东西）。到目前为止一切都很好，我希望这一次微软的大佬们已经看到了他们方法的错误并提供了一个有效的解决方案。

如果您首先购买实体开发和整个概念模型，那么这是获得完整 Microsoft 解决方案的唯一途径。尽管在 M 语言上完成的工作可能会使这个想法黯然失色，并将整个建模工作移回数据库。

如果您不购买 Entity 的东西，那么我会强烈推荐 Enterprise Library。它是一种经过验证的技术，每次都建立在坚实的代码基础和以数据库为中心的范例之上。如果您认为存储过程是蜜蜂的膝盖并且喜欢它们带来的东西，我也会走这条路。

如果您感觉真的很异国情调并且感觉有点活泼，我会使用诸如 CouchDB 之类的 NO-SQL 方法。然而，这确实需要一些时间来适应。这该死的奇怪，感觉真的很不对。但是事情的发展速度非常快，而且解决方案似乎比预期的更强大和更快。我不会得到这种类型的解决方案，但如果你很喜欢规范化并认为它可以应用于 NO-SQL 方法。整个模型需要彻底改变，应用程序需要以一种由所应用技术驱动的方式进行建模。

我发现 CouchDB 的方式有点脏而且非常非常错误。但它有很多令人信服的理由来使用它，我认为它会渗入每个程序员的心灵，并且在未来几年内肯定会成为主流。

尽管在新版本 4 中，我对整个 Entity 的最大抱怨仍然是，对于 N 层环境确实没有太多考虑。它仍然感觉它是一个 2 层解决方案，最终用户（开发人员）仍需要完成大量样板代码，以使其以强大且可靠的 N 层方式工作。

# objective-c - 在 Modern Runtime 中使用实例变量

> ID：1007607
> 
> 赞同：9
> 
> 时间：2009-06-17T15:01:25.527
> 
> 标签：objective-c, macos, objective-c-runtime

我在 Obj-c 和 Cocoa 方面有几年的经验，但我现在才刚刚回到它以及 Obj-C 2.0 等的进步。

我试图了解现代运行时和声明属性等。让我有点困惑的一件事是现代运行时中隐式创建 iVar 的能力。当然，这意味着在您的代码中，您应该始终使用 self.property 来访问该值。

但是，在 init* 和 dealloc（假设您没有使用 GC）方法中，我们应该直接使用 iVar（在当前运行时）。

所以问题是：

1.  我们应该在 init* 中使用属性访问器并在 Modern Runtime 中使用 dealloc 吗？

2.  ***如果是这样***，为什么会有所不同？仅仅是因为编译器看不到 iVar 吗？

3.  如果我需要覆盖访问器，我是否仍然可以访问将在运行时定义的 iVar，还是必须定义运行时将使用的实际 iVar？

4.  同样，***如果我可以访问合成的 iVar***，为什么我不能继续为 init* 和 dealloc 方法执行此操作？

我多次阅读文档，但它们似乎对所有这些都有些模糊，我想确保我理解它，以便决定如何继续编码。

希望我的问题很清楚。

* * *

*测试快速总结*：

1.  如果您不在 legacy 中声明 ivar，编译器将完全不高兴

2.  如果您`#ifndef __OBJC2__`在遗留编译器中使用 around ivar 很高兴，您可以直接使用 ivar 和作为属性

3.  在现代运行时，您可以保留 ivar 未定义并作为属性访问

4.  在现代运行时，尝试直接访问 ivar 而不声明会在编译期间出错

5.  `@private`当然，ivar 的声明允许直接访问 ivar，无论是传统的还是现代的

现在真的没有给出一个干净的前进方式吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T16:59:42.727

在当前 (OS X 10.5/GCC 4.0.1) 编译器中，您无法直接访问运行时合成的 ivars。一位 OS X 运行时工程师 Greg Parker 将它[放在](http://www.mail-archive.com/cocoa-dev@lists.apple.com/msg31266.html)cocoa-dev 列表中（2009 年 3 月 12 日）：

> 你不能在当前的编译器中。未来的编译器应该解决这个问题。同时使用明确的@private ivars。@private ivar 不应被视为合同的一部分 - 这就是 @private 的含义，由编译器警告和链接器错误强制执行。
> 
> 为什么没有办法在 .m 文件中为新运行时显式声明实例变量？
> 
> 三个原因：（1）有一些重要的设计细节需要解决，（2）编译器工程师的时间有限，（3）@private ivars 通常足够好。

因此，现在您必须使用点符号来访问属性，即使在`init`和中也是如此`dealloc`。这违背了在这些情况下直接使用 ivars 的最佳实践，但没有办法绕过它。我发现在大多数情况下，使用运行时合成的 ivars 的易用性（以及性能优势）超过了这一点。如果确实需要直接访问 ivar，则可以按照 Greg Parker 的建议使用 @private ivar（没有什么可以阻止您混合显式声明的 ivar 和运行时合成的 ivar）。

**使用 OS X 10.6更新**，64 位运行时确实允许通过`self->ivar`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:55:00.690

由于实例变量本身只能在现代运行时中合成（并且必须在 32 位或前 Leopard 下的 @interface 中声明），因此同时声明 ivar 是最安全/最可移植的

> *   我们应该在 init* 中使用属性访问器并在 Modern Runtime 中使用 dealloc 吗？

我的经验法则是“可能” `-init*`，而“通常不会” `-dealloc`。

初始化对象时，您要确保正确复制/保留 ivars 的值。除非属性的设置器有一些副作用，使其不适合初始化，否则绝对要重用属性提供的抽象。

释放对象时，您希望释放任何 ivar 对象，但不存储新对象。一个简单的方法是将属性设置为 nil( `myObject.myIvar = nil`)，它基本上调用`[myObject setMyIvar:nil]`. 由于 nil 的消息被忽略，因此没有危险。但是，当 [myIvar release]; 通常是您所需要的。通常，在解除分配的行为与设置变量不同的情况下，不要使用属性（或直接使用 setter）。

我完全可以理解 eJames 反对在 init/dealloc 中使用属性访问器的论点，但另一方面是，如果您更改属性行为（例如，从保留更改为复制，或者只是分配而不保留）并且不使用它在 init 中，反之亦然，行为也可能不同步。如果初始化和修改 ivar 的行为应该相同，请对两者使用属性访问器。

> *   如果是这样，为什么会有所不同？仅仅是因为编译器看不到 ivar 吗？

现代运行时更智能地处理类大小和布局，这就是为什么您可以更改 ivars 的布局而无需重新编译子类的原因。它还能够从相应属性的名称和类型中推断出您想要的 ivar 的名称和类型。[Objective-C 2.0 运行时编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/)有更多信息，但我不知道那里解释的细节有多深。

> *   如果我需要覆盖访问器，我是否仍然可以访问将在运行时定义的 iVar，还是必须定义运行时将使用的实际 iVar？

我没有对此进行测试，但我相信您可以在代码中访问命名的 ivar，因为它实际上必须被创建。我不确定编译器是否会抱怨，但我想既然它会让你合成 ivar 而不会抱怨，它也很聪明，可以知道合成的 ivar 并让你按名称引用它。

> *   同样，如果我可以访问合成的 iVar，为什么我不能继续为 init* 和 dealloc 方法执行此操作？

分配实例后，您应该能够随时访问属性和/或 ivar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:33:21.517

还有[另一个具有类似信息的 SO question](https://stackoverflow.com/questions/275034/what-is-the-underlying-mechanism-for-ivar-synthesis-in-the-modern-objective-c-run)，但它并不完全重复。

底线来自[Objective-C 2.0 文档](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_5_section_3.html)，并引自[Mark Bessey 的回答](https://stackoverflow.com/questions/275034/what-is-the-underlying-mechanism-for-ivar-synthesis-in-the-modern-objective-c-run/275134#275134)如下：

> 取决于运行时的行为存在差异（另请参阅“运行时差异”）：
> 
> 对于旧版运行时，实例变量必须已经在 @interface 块中声明。如果存在与属性具有相同名称和兼容类型的实例变量，则使用它，否则会出现编译器错误。
> 
> 对于现代运行时，实例变量是根据需要合成的。如果同名的实例变量已经存在，则使用它。

我的理解如下：

您不应该在`init*`和`dealloc`方法中使用属性访问器，原因与您不应该在遗留运行时中使用它们的原因相同：如果您稍后覆盖属性方法并最终执行不应该做的事情，它会让您面临潜在的错误在`init*`or中完成`dealloc`。

您应该能够同时合成 ivar*并*覆盖属性方法，如下所示：

```
@interface SomeClass
{
}
@property (assign) int someProperty;
@end

@implementation SomeClass
@synthesize someProperty; // this will synthesize the ivar
- (int)someProperty { NSLog(@"getter"); return someProperty; }
- (void)setSomeProperty:(int)newValue
{
    NSLog(@"setter");
    someProperty = newValue;
}
@end 
```

这使我认为您也可以在您的`init*`and`dealloc`方法中访问合成的 ivar。我能想到的唯一问题是该`@synthesize`行可能必须位于源文件中您的和方法的定义*之前。*`init*``dealloc`

最后，由于在接口中声明的 ivars 仍然有效，这仍然是您最安全的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-26T15:26:41.350

我遇到了同样的问题。我解决无法访问合成实例变量的方法如下：

公共标头

```
@interface MyObject:NSObject {
}
@property (retain) id instanceVar;
@property (retain) id customizedVar;
@end 
```

私有标头/实现

```
@interface MyObject()
@property (retain) id storedCustomizedVar;
@end

@implementation MyObject
@synthesize instanceVar, storedCustomizedVar;
@dynamic customizedVar;

- customizedVar {
  if(!self.storedCustomizedVar) {
    id newCustomizedVar;
    //... do something
    self.storedCustomizedVar= newCustomizedVar;
  }
  return self.storedCustomizedVar;
}

- (void) setCustomizedVar:aVar {
  self.storedCustomizedVar=aVar;
}

@end 
```

它不是那么优雅，但至少它使我的公共头文件保持干净。

如果你使用 KVO，你需要定义customizedVar 作为storedCustomizedVar 的依赖键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-04T00:51:49.060

我对 Obj-C 比较陌生（但对编程不熟悉），也对这个话题感到困惑。

让我担心的方面是，无意中使用 iVar 而不是属性似乎相对容易。例如写作：

myProp = someObject;

代替

self.myProp = someObject;

诚然，这是“用户”错误，但在某些代码中意外发生似乎仍然很容易，并且对于保留或原子属性，它可能会导致问题。

理想情况下，我希望能够让运行时在生成*任何*iVar 时将某些模式应用于属性名称。例如，总是在它们前面加上“_”。

在实践中，目前我正在手动执行此操作 - 明确声明我的 ivars，并故意为它们赋予与属性不同的名称。我使用老式的“m”前缀，所以如果我的属性是“myProp”，我的 iVar 将是“mMyProp”。然后我使用@synthesize myProp = mMyProp 将两者关联起来。

我承认这有点笨拙，而且有点额外的打字，但对我来说，能够在代码中更清楚地消除歧义似乎是值得的。当然，我仍然会弄错并键入 mMyProp = someObject，但我希望“m”前缀会提醒我我的错误。

如果我可以只声明属性并让编译器/运行时完成其余的工作会感觉更好，但是当我有很多代码时，我的直觉告诉我，如果我仍然必须遵循手动规则，我会这样犯错误用于初始化/释放。

当然还有很多其他的事情我也可以做错......

# .net - 接收重复报告的客户端应用程序

> ID：1007624
> 
> 赞同：0
> 
> 时间：2009-06-17T15:04:29.283
> 
> 标签：.net, http, reporting-services, reporting, reportingservices-2005

我有一个将报表路径和参数集合发送到 Microsoft Reporting Services 服务器的应用程序。其中一份报告运行时间很长，当用户尝试在几秒钟内生成报告时，将收到第二个用户请求的报告的副本。

这不会发生故障，这是我可以复制的一致行为。我什至可以并排运行应用程序的两个副本并在跟踪语句中输出它们的参数，每次发送的参数都是不同的，但相同的报告会返回给两个客户端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T14:49:06.153

正如我对 mozy 的评论所述，自定义代码中的共享变量是罪魁祸首。

# c# - 在 .NET XML 反序列化中，如何允许多态使用 Array 类型？

> ID：1007626
> 
> 赞同：3
> 
> 时间：2009-06-17T15:04:42.137
> 
> 标签：c#, .net, xml, xml-serialization, xsd

示例架构：

```
<complexType name="Dog">...</complexType>
<complexType name="Cat">...</complexType>

<complexType name="ArrayOfDog">
    <sequence>
        <element name="Dog" type="tns:Dog minOccurs="0" maxOccurs="unbounded" />
    </sequence>
</complexType>

<complexType name="Foo">
    <sequence>
        <element name="Bar" type="string"/>          
        <element name="Baz" type="anyType"/>
    </sequence>
</complexType> 
```

通过 .NET 的 wsdl.exe 运行它会生成类似于以下的代码：

```
[System.Xml.Serialization.XmlIncludeAttribute(typeof(Dog[]))]

public partial class Dog { ... }

public partial class Cat { ... }

public partial class Foo {
    private string barField;
    private object bazField;
} 
```

似乎 wsdl.exe 试图变得“聪明”，并意识到我的 ArrayOfDog 实际上只是一个可以编码为 C# 数组的包装器类型。当在另一种数据类型中显式引用 ArrayOfDog 时，这可以正常工作。但是，当多态使用 ArrayOfDog（例如，作为 xsd:anyType 的替代）时，这会中断。它似乎中断了，因为 .NET 运行时对名为“ArrayOfDog”的 complexType 一无所知——它基本上已经抛弃了这些信息，而只支持使用本机 C# 数组。

示例 XML 文档 1：

```
<Foo>
    <Bar>Hello</Bar>
    <Baz xsi:type="Cat">
        ...
    </Baz>
</Foo> 
```

示例 XML 文档 2：

```
<Foo>
    <Bar>Hello</Bar>
    <Baz xsi:type="ArrayOfDog">
        <Dog>...</Dog>
        <Dog>...</Dog>
    </Baz>
</Foo> 
```

文档#1 被运行时正确反序列化。我得到了一个 Foo 类型的对象，其中包含 Bar 和 Baz 的正确反序列化字段。

文档 #2 被运行时**错误地反序列化。**我得到了一个 Foo 类型的对象，它具有正确反序列化的 Bar 字段，但对于 Baz 字段，我得到 System.XML.XMLNode[]。我的猜测是因为运行时对名为“ArrayOfDog”的实体的任何类型绑定一无所知。您可能认为 XmlInclude 指令“XmlIncludeAttribute(typeof(Dog[]))”会处理这个问题，但它似乎不起作用。

有没有人遇到过这个？

这里有优雅的解决方案吗？我正在考虑使用的解决方法是将我的“ArrayOf”类型包装在另一种类型中，并将其包含在 xsd:anyType 的替换中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:15:31.457

你想从什么开始？如果您从这样定义的类型开始：

```
public partial class Foo
{
    private string _bar;

    private object[] _baz;

    public string Bar
    {
        get { return _bar; }
        set { _bar= value; }
    }

    [XmlArray("Baz")]
    [XmlArrayItem("Type1", typeof(Type1))]
    public object[] Baz
    {
        get { return _baz; }
        set { _baz= value; }
    }
} 
```

然后，您可以对文档进行序列化和反序列化，例如文档 #2。

似乎您想从 WSDL 和 XSD 开始。在这种情况下，您能否将架构概括为如下所示：

```
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Foo" nillable="true" type="Foo" />
  <xs:complexType name="Foo">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="1" name="Bar" type="xs:string" />
      <xs:element minOccurs="0" maxOccurs="1" name="Baz" type="UntypedArray" />
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="UntypedArray">
    <xs:choice minOccurs="1" maxOccurs="unbounded">
      <xs:element name="Type1" type="Type1" minOccurs="1" maxOccurs="1"/>
      <xs:any namespace="##other" processContents="lax" minOccurs="1" maxOccurs="1"/>
    </xs:choice>
  </xs:complexType>

  <xs:complexType name="Type1" mixed="true">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="1" name="Child" type="xs:string" />
    </xs:sequence>
  </xs:complexType>
</xs:schema> 
```

上述架构生成以下代码：

```
public partial class Foo {

    private string barField;

    private object[] bazField;

    /// <remarks/>
    public string Bar {
        get {
            return this.barField;
        }
        set {
            this.barField = value;
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlArrayItemAttribute("", typeof(System.Xml.XmlElement), IsNullable=false)]
    [System.Xml.Serialization.XmlArrayItemAttribute(typeof(Type1), IsNullable=false)]
    public object[] Baz {
        get {
            return this.bazField;
        }
        set {
            this.bazField = value;
        }
    }
} 
```

如果您想包含其他类型，则在 xsd:choice 中酌情添加元素。

由于您想在其中允许 xsd:any，因此 Foo.Baz 是一个对象数组。它上面的编程模型要求您使用 (foo.Baz[i] as Type1) 之类的东西来测试或强制转换每个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T19:26:21.683

我认为这与多态性无关。我认为这是 XML 序列化程序中的一个错误，假设任何名为“ArrayOfDog”的类型，包含“Dog”序列意味着代表一个 Dog[]。作为对这一理论的测试，尝试将 WSDL 更改为使用名称“BunchOfDogs”，并查看这是否会更改客户端中的代理代码。

如果您想要 XML 中的多态性，那么 ArrayOfDog 和 Cat 都需要是相同基本类型（xsd:any 除外）的扩展。如果是这种情况，那么我希望 .NET 将 Baz 生成为基本类型。

带有 xsd:any 的模式通常会导致问题。那里几乎可以有任何东西，有些组合根本没有意义。

您还没有说这个 Java 服务是否来自 Axis，或者它是什么版本。我已经看到 Axis 表现得好像 xsi:type 是有效模式的替代品。小心需要“正确”使用 xsi:type 的模式。

# php - 适用于企业的 PHP MVC 框架；CakePHP 还是 Symfony？

> ID：1007629
> 
> 赞同：7
> 
> 时间：2009-06-17T15:05:13.977
> 
> 标签：php, cakephp, symfony1

我即将开始使用 PHP 构建一个巨大的临床医疗保健应用程序，并且我正在寻找有关框架的一些建议。我需要能够想出一个快速的原型，所以框架能够处理许多平凡的任务很重要；因此，我将其范围缩小到 CakePHP 或 Symfony。

我希望得到一些对这两个框架都有效的开发人员意见。

谢谢，皮特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T15:13:24.367

IBM 在这里发表了一篇关于这两个框架的文章以及 Zend 进行比较，请参阅：

[http://www.ibm.com/developerworks/opensource/library/os-php-fwk1/?S_TACT=105AGX44&S_CMP=ART](http://www.ibm.com/developerworks/opensource/library/os-php-fwk1/?S_TACT=105AGX44&S_CMP=ART)

我个人使用 CakePHP，与直接使用 PHP 相比，它非常棒。易于构建，非常专注于 MVC，与第三方组件的合理集成。不过，我确实遇到了一些问题，因为版本之间缺乏任何可辨别的升级路径。我不能代表 Symfony，但我相信它比 CakePHP 更重量级。

还可以查看 CakePHP 的截屏视频，它们提供了很好的概述：

[http://cakephp.org/screencasts](http://cakephp.org/screencasts)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T16:40:24.923

我想反驳上面提出的一些论点。我已经广泛使用 Zend Framework 和 symfony，并且简要了解了 CakePHP。

首先，与 symfony 相比，ZF 的文档并不“广泛”——另一方面，它相当肤浅。其次，我认为 symfony 社区比一般的 ZF 框架更容易获得和帮助，并且开发过程更加透明。

但是，我同意 Zend Framework 享有得到 Zend 支持的优势，这可能是企业项目的有力论据。

以我的经验，symfony 比 ZF 更像是一个框架。在 symfony 中，您使用整个包 - 或整个框架，而在 ZF 中，您可以根据自己的喜好使用工具，使其更像是“工具箱”而不是框架。

还要记住，如果您喜欢 ZF 中的一些工具，您将能够在 symfony（可能还有 CakePHP）项目中使用这些工具，以及 symfony/CakePHP。

这不是一个真正的答案，而更像是对上面给出的答案的一般评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:12:29.670

我建议阅读[这个问题](https://stackoverflow.com/questions/827541/can-anybody-suggest-a-true-mvc-framework-for-building-a-php-application-from-scra)的正确答案。它提到 Zend Framework 是最佳选择，并提出了一些正确的观点来证明它的合理性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T21:56:11.040

首先让我说我之前没有使用 CakePHP 或 Zend 的经验，除了浏览过框架代码和它们的文档。大约 15 个月前，我开始使用 Symfony，并在研究使用什么框架之前进行了研究。我决定选择 Symfony，因为我发现 Symfony 核心的编写方式很好且有条理。感觉就像我可以通过阅读代码本身来轻松理解框架。除此之外，我发现了大量的文档，这些文档真正专注于使用框架来产生某些功能。可以说非常务实。CakePHP 似乎不符合我的个人风格，而且我认为其核心非常hacky。再说一次，我可能错了，但这就是我对它的感觉。经过 15 个月的 Symfony 编码后，我仍然非常满意。您经常阅读评论或博客说它太复杂了。我认为这些人侮辱了他们自己的智商。在您牢牢掌握框架内部结构和解决问题的方法之前确实需要一段时间，但是一旦您超越了这一点，它确实是一个很棒的工具。社区非常有帮助，未来看起来很光明。总而言之，当您查看框架采用的方法及其代码和编码风格时，我只能建议您凭直觉行事。您将在这些框架中花费大量时间，因此当您查看它们的代码和针对常见问题的解决方案时，您一定会感到轻松自在。如果你开始与它作斗争，那么每一个框架都是可怕的，与它一起前进将使它们中的每一个都成为一个伟大的工具。有些人最终可能会比其他人更好。我猜你'

祝你好运：-）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:13:53.460

我对这两个框架的经验都很少，但我听说过的关于 symfony 的只是抱怨（尽管它似乎被大量使用了！）。可能只是人们没有花时间完全学习框架。

根据我的经验，两者似乎都是不错的框架，但就像任何优秀的开发人员一样，您必须至少了解低于您所使用的抽象级别才能有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T15:15:18.933

可能是 Zend 框架。如果您想要不同的东西，请尝试[codeigniter.com](http://codeigniter.com)

或者是 php5 [www.kohanaphp.com中的 oo 版本](http://www.kohanaphp.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T15:26:47.800

我没有使用其他框架，但我使用[Zend Framework](http://framework.zend.com/)，它很棒。好处是：

1.  干净和标准的库、编码风格、约定等。
2.  企业支持：由每个 PHP 程序员都知道的公司 Zend 提供支持
3.  全面的手册，许多博客文章和教程，至少 2 本书写得很好
4.  在大多数开源操作系统上都有软件包，因此易于安装和维护
5.  一个非常活跃的开源项目，更新来得太快，你跟不上。
6.  开放许可：ZF 使用类似 BSD 的许可，因此您不会遇到很多许可问题

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T17:04:41.830

我的框架决定归结为这一点（请注意，我主要使用 Cake、Little Zend，并且使用过 CodeIgniter 和 symfony）。

Zend 是最有进取心的。你得到了@Zend 的支持——我认为它的开发时间表是最坚实的前进方向。它还有一些很棒的模块，如 PDF 阅读器等。

CakePHP 的重点 (IMO) 是快速开发。但它一直是性能最差的应用程序之一——如果你要拥有一个重度使用的应用程序，我认为 Paul M Jones 有一些关于基准的帖子。Zend 比 Cake, IIRC 快 2-2.5 倍。如果您没有 MVC 经验，Cake 可能是一个不错的选择 b/c it def。将您锁定在 MVC 中。不过，我发现自己经常需要跳出他们的模式去思考——这就是我慢慢转向 Zend 的原因。

其他框架也有不同的优势。在芝加哥的 PHP|Tek，CodeIgniter 是会议的话题，因此它在未来一两年内可能会有很大的发展势头。

Cake 和 Zend 还与其他一些企业级的东西（如单元测试等）进行了超级紧密的集成。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-08T16:28:36.650

肯定是 Yii，我们为企业使用了好几次，对结果非常满意。我特别喜欢它的扩展，比如 backvendor、coco、bootstrap。对我来说，Yii 很容易学习和实施。尝试过 cake php，但 yii 似乎更清晰。无论如何，无论您使用什么框架，您都必须同时不断提高您的核心语言技能。这有助于最大限度地利用您正在使用的框架。

# java - 屏幕上的浮动矩形

> ID：1007645
> 
> 赞同：1
> 
> 时间：2009-06-17T15:07:45.890
> 
> 标签：java, screen, jframe

我知道如何在 JPanel 上绘制一个矩形，但是如何在屏幕上绘制一个矩形以使矩形看起来是浮动的？更具体地说，一个未填充的矩形。我的想法是使用一个透明的 JFrame，上面画了一个矩形；然而，这使得 JFrame 中的所有内容都是透明的。

**我的解决方案** 所以我认为有很多方法可以解决这个问题，有些比其他的更复杂，有些比其他的更实用。

我尝试了启动画面。问题是您需要在运行时传递 VM 参数“-splash”。我创建了一个清单文件来自动执行此操作/将参数放入 Eclipse；但随后代码依赖于 .gif 文件，我无法轻松更改矩形的大小/位置。通过屏幕截图伪造它时会出现类似的问题。不过建议很好，我学到了一些很酷的东西。

所以，回到我所做的。我使用了 JFrame，获取了内容窗格并将背景设置为红色（您想要的任何颜色），然后将框架设置为未装饰，这会删除窗口的标题栏和边框。这创建了一个浮动矩形，我可以轻松更改 (frame.setSize, .setLocation) 的大小和位置。我还没有把它变成一个非填充的矩形，我尝试了内部框架和分层窗格，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:24:17.260

JFrame 是一个重量级的组件，而且这些组件在很长一段时间内都是不透明的。但是，从 Java 6u10 开始，该类中有一个用于透明窗口的非官方[API](http://www.pushing-pixels.org/?p=260)`com.sun.awt.AWTUtilities`，这很可能在 Java 7 中成为官方 API。在早期版本中，模拟这种事情的唯一方法是[通过截图来伪造](http://www.onjava.com/pub/a/onjava/excerpt/swinghks_hack41/index.html)它`java.awt.Robot`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:21:16.080

您可能必须让窗口的某些部分透明，而实际绘制的矩形不是。我怀疑是否存在与平台无关的解决方案，因此您需要为此求助于 JNI。根据您需要做的事情，使窗口对点击不可见也可能很好，这也需要其他技巧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:21:54.707

[https://github.com/twall/jna/](https://github.com/twall/jna/)

该项目提供了一个库，并提供了半透明的时钟和信息气球示例，甚至超越了您正在尝试做的事情。演示在 Windows 上运行良好，但我无法说出它们的跨平台程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T15:32:35.763

您可能想查看[JLayeredPane](http://java.sun.com/docs/books/tutorial/uiswing/components/layeredpane.html)。此页面上的演示部分显示了您想要的内容，但是在绘制矩形时，您需要将绘制设置为透明：

```
AlphaComposite ac = AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.5f);
g2d.setComposite(ac);
g2d.drawImage(image, x, y, this); 
```

# visual-studio-2008 - 删除 Visual Studio 2008 中的 Backup Files 文件夹

> ID：1007649
> 
> 赞同：4
> 
> 时间：2009-06-17T15:08:48.837
> 
> 标签：visual-studio-2008, backup

Visual Studio 2008 自动创建一个文件夹（在 Vista 中）：

```
C:\Users\%username%\Documents\Visual Studio 2008 
```

我对那个位置很好。我不喜欢的是不断出现在“Visual Studio 2008”中的“备份文件”文件夹。

我不知道这个文件夹是什么时候创建的，也不知道为什么，因为它总是空的。好吧，文件夹本身有更多文件夹用于我的一些项目，但这些文件夹总是空的，它们似乎从来没有备份任何东西。我也不在乎，我可能已经禁用了备份功能，或者如果我没有，那么这将无法正常工作。无论哪种方式，我都不在乎 VS 会自动处理我的备份。

我只想永远删除“备份文件”文件夹，但每次我这样做时，它都会出现......我也试图隐藏它，但它不起作用，文件夹突然变得不隐藏。

我怎样才能一劳永逸地摆脱这个文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:26:30.203

我也从未听说过“备份文件”文件夹——直到刚才我去查看时。就在那里！

关闭自动恢复设置以防止创建 if：工具 | 选项 | 环境 | 自动恢复

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:28:15.427

当我将一些项目从 2005 年升级到 2008 年时，我得到了一个备份文件夹，其中包含项目的完整副本，就像我升级时一样。

据我所知，它没有更新文件。

至于为什么如果你不升级VS2008会创建一个空文件夹我不知道 - 对不起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T16:37:35.517

> ChrisF：您可以使用标记为“创建备份副本”之类的复选框（在询问转换时）禁用此功能
> 
> Chris Lively：这是 Sean 描述的 VS2008 的一个特性——不是自定义的东西。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-17T15:23:52.597

我从未听说过“备份文件”文件夹。这是加载项或自定义构建脚本。

# flash - 将透明 png 从 Actionscript 导出到 .NET

> ID：1007651
> 
> 赞同：1
> 
> 时间：2009-06-17T15:09:27.057
> 
> 标签：flash, actionscript

您可以将在 Flash 中制作的绘图导出为 actionscript 中的透明 png 我知道您可以将其导出为具有白色背景的 jpg，但您可以导出透明度吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:19:15.320

是的。查看 as3corelib ( [http://code.google.com/p/as3corelib/](http://code.google.com/p/as3corelib/) ) 中的 PNGEncoder。只需拍摄包含绘图的 MovieClip / Sprite 的快照（确保将 BitmapData 创建为透明的）并将其传递给编码器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:50:40.037

如果您刚刚在 Flash 中绘制了图像并希望它为 png，那么您不需要使用 ActionScript 导出，只需执行以下操作：

文件 > 导出 > 导出图像 > 另存为类型 > .png

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T20:46:21.310

我曾经自己建立了一种方法来做到这一点。首先，我使用 bitmapdata.draw 将其转换为位图，然后循环遍历每个像素并通过 getPixel32() 获取其值（getPixel32 包含透明度 getPixel() 不包含）并将其存储到数组中。然后我将非常长的数组发送到 PHP 并使用循环遍历数组并重建图像。它效率不高，但当时没有人能告诉我任何其他方法，我很自豪我自己找到了一种方法。

# php - 许多托管服务提供商中的 Pear DB 问题

> ID：1007652
> 
> 赞同：1
> 
> 时间：2009-06-17T15:09:44.530
> 
> 标签：php, hosting, pear

我使用 PEAR DB 连接和查询我的数据库，如下所示：

```
if(stristr($_SERVER['HTTP_HOST']  , 'localhost')){
    $dsn = 'mysql://root:@localhost/xxx' ;
}else{
    $dsn = 'mysql://xxx:xxx@localhost/xxx' ;
}
$dbc =& DB::connect($dsn);
$dbc->query("set names utf8" );
if (PEAR::isError($dbc , array('debug'=>3))) {
    die($dbc->getMessage());
} 
```

在某些托管服务提供商中，它运行良好，例如，如果数据库用户没有足够的权限，它会显示：**Insufficient Permission**和其他一些错误。此外，当我解决问题时，该站点将启动并运行良好。

但是，在许多托管服务提供商中，它并没有显示很多错误！页面上也没有任何内容！页面完全空白，没有错误，没有通知，什么都没有！我也设置`error_reporting(E_ALL)`了我的脚本，但我仍然找不到错误。有没有办法解决这样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T15:11:50.857

确保 display_errors 已打开（或检查日志）：

```
ini_set('display_errors', true); 
```

# python - 如何从此表中构建所有可能元组的列表？

> ID：1007666
> 
> 赞同：4
> 
> 时间：2009-06-17T15:12:01.263
> 
> 标签：python, algorithm

假设我有一组列定义：

```
Col1: value11 value12 value13
Col2: value21 value22 
Col3: value31 value32 value33
... 
```

给定一些列的子集——2 个或更多——我想找到这些列的所有可能值。假设我选择上面的第 1 列和第 2 列：

```
(value11 value21)
(value11 value22)
(value12 value21)
(value12 value22)
(value13 value21)
(value13 value22) 
```

如果我选择 2:3：

```
(value21 value31)
(value21 value32)
(value21 value33)
(value22 value31)
(value22 value32)
(value22 value33) 
```

如果我选择了所有三个：

```
(value11 value21 value31)
(value11 value21 value32)
... 
```

我在 python 中实现了这个，我想要一个*快速*的算法来做到这一点。我的输入是一个元组列表： (columnName, columnValueList)

有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T15:22:28.607

最好的方法是使用 itertools.product()。例如：

```
import itertools

group1 = ['a', 'b']
group2 = ['c', 'd']

print list(itertools.product(group1, group2))

#==> [('a', 'c'), ('a', 'd'), ('b', 'c'), ('b', 'd')] 
```

该函数接受多个参数（即多列）。

有关 iterools.product() 的更多帮助，请参阅[此](http://docs.python.org/library/itertools.html#itertools.product)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:38:55.750

杰里米的更一般的解决方案是：

```
import itertools
full = [[value11, value12, value13],
        [value21, value22],
        [value31, value32, value33]]
ids = 0, 2 
```

或者如果它是一个字典（应该是）：

```
full = {'col1': [value11, value12, value13],
        'col2': [value21, value22],
        'col3': [value31, value32, value33]}
ids = 'col1', 'col3'
selected = (full[i] for i in ids)
list(itertools.product(*selected)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:38:13.067

除了按照 jeremy 的建议使用 itertools.product() 之外，您可能还需要考虑将元组列表转换为 dict 以快速查找 columnName：

`dict(tupleList)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T15:41:24.853

我敢打赌`itertools`，基于解决方案的解决方案会更快，但如果需要避免它们（例如，在没有 itertools.product 的情况下停留在 Python 2.5 等），当然可以在必须时完全用“基础 Python”编码。

试图“全力以赴”以提高速度，可能是这样的：

```
def odo(*names_and_valuelists):
    aux = [[vl, 0] for n, vl in names_and_valuelists]
    if any(len(vl)==0 for vl, _ in aux):
        return
    while True:
        yield tuple(vl[i] for vl, i in aux)
        for vlandi in reversed(aux):
          if vlandi[1] == len(vlandi[0])-1:
            vlandi[1] = 0
          else:
            vlandi[1] += 1
            break
        else:
          return 
```

尽管微小的调整可能仍会加速它（需要使用真实的样本数据进行彻底的分析！）。

这是您的使用示例：

```
def main():
    data = [
        ('Col1', 'value11 value12 value13'.split()),
        ('Col2', 'value21 value22'.split()),
        ('Col3', 'value31 value32 value33'.split()),
    ]
    for tup in odo(data[0], data[1]): print tup
    print
    for tup in odo(data[1], data[2]): print tup
    print
    for i, tup in enumerate(odo(*data)):
        print tup
        if i>5: break

if __name__ == '__main__':
    main() 
```

发出结果：

```
('value11', 'value21')
('value11', 'value22')
('value12', 'value21')
('value12', 'value22')
('value13', 'value21')
('value13', 'value22')

('value21', 'value31')
('value21', 'value32')
('value21', 'value33')
('value22', 'value31')
('value22', 'value32')
('value22', 'value33')

('value11', 'value21', 'value31')
('value11', 'value21', 'value32')
('value11', 'value21', 'value33')
('value11', 'value22', 'value31')
('value11', 'value22', 'value32')
('value11', 'value22', 'value33')
('value12', 'value21', 'value31') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:21:58.170

看起来 itertools.combination 可以帮助你。

```
>>> from itertools import combinations
>>> list(combinations(xrange(5), 2))
[(0, 1), (0, 2), (0, 3), (0, 4), (1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)]
>>> list(combinations(xrange(5), 3))
[(0, 1, 2), (0, 1, 3), (0, 1, 4), (0, 2, 3), (0, 2, 4), (0, 3, 4), (1, 2, 3), (1, 2, 4),   (1, 3, 4), (2, 3, 4)] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-14T16:27:45.083

使用合并创建交叉联接。见（[https://www.geeksforgeeks.org/python-program-to-perform-cross-join-in-pandas/](https://www.geeksforgeeks.org/python-program-to-perform-cross-join-in-pandas/)）

```
data={'Col1': ['value11', 'value12', 'value13'],
'Col2': ['value21', 'value22','value23'] ,
'Col3': ['value31', 'value32', 'value33']
}
df=pd.DataFrame(data)
df.reset_index(inplace=True)
print(df)

col1=pd.DataFrame(df['Col1'])
col2=pd.DataFrame(df['Col2'])
col3=pd.DataFrame(df['Col3'])

col1['key'] = 1
col2['key'] = 1
col3['key'] = 1

col1=pd.merge(col1, col2, on ='key')
col1=pd.merge(col1, col3, on ='key').drop("key", 1) 
```

# spell-checking - 为 IE 实现拼写检查的最简单方法

> ID：1007673
> 
> 赞同：1
> 
> 时间：2009-06-17T15:13:24.957
> 
> 标签：spell-checking

我正在使用 ASP.NET 网络表单和大量的 javascript/jQuery。我正在寻找一种非常简单易用的方法来实现 IE 中单个文本区域的拼写检查（因为所有其他浏览器都实现了自己的拼写检查）。我通常远离 IE 特定技术，但我愿意破例，因为我只需要 IE 中的功能（6、7、8）。

Gmail 的拼写检查器很不错。Hotmail 的拼写检查器非常棒（仅适用于 IE），尽管它似乎不是多语言的。我很想找到一个简单的具有相同功能的。

告诉我的客户为他们的浏览器下载插件不是一种选择。

我正在寻找一个非常快速的实现。我真正想要的唯一功能是多语言。

建议？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:17:32.437

[http://spellerpages.sourceforge.net/](http://spellerpages.sourceforge.net/)

```
<!-- Source the JavaScript spellChecker object -->
<script language="javascript" type="text/javascript" src="spellChecker.js">
</script>

<!-- Call a function like this to handle the spell check command -->
<script language="javascript" type="text/javascript">
function openSpellChecker() {
    // get the textarea we're going to check
    var txt = document.myform.mytextarea;
    // give the spellChecker object a reference to our textarea
    // pass any number of text objects as arguments to the constructor:
    var speller = new spellChecker( txt );
    // kick it off
    speller.openChecker();
}
</script> 
```

不再提供此演示。

# javascript - Javascript 的复杂货币正则表达式的提示？

> ID：1007677
> 
> 赞同：1
> 
> 时间：2009-06-17T15:13:52.960
> 
> 标签：javascript, regex, currency

我需要在网页中匹配无限数量的数字。

我需要能够匹配以下所有格式：

```
100 $
99$
$99
$ 8
$.99
$ .8
$ 99.8
.99$
.99 $
9.2 $
1.2$ 
```

以及使用逗号的等价物：

```
444,333
22,333
1,222
11,111,111
333,333,333,333.01132 
```

或空格：

```
444 333
22 333
1 222
11 111 111
333 333 333 333.01132 
```

这对我来说真的很难。我习惯使用正则表达式，但我完全没能写出一些防弹的东西。通常[http://www.regexlib.com](http://www.regexlib.com)有解决方案，但不是这个。

除了使用正则表达式之外，我想不出其他方法，因为它是纯文本搜索/替换。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T15:31:17.123

这是一个正则表达式，它将匹配您提供的所有数字格式：

```
^(?:\$\s*)?(?:(?:\d{0,3}(?:[, ]\d{0,3})*[, ])+\d{3}|\d+)(?:\.\d*)?(?:\s*\$)?$ 
```

分解它：

*   `^(?:\$\s*)?`将在字符串的开头查找可选的 $，后跟任意数量的空格
*   `(?:(?:\d{0,3}(?:[, ]\d{0,3])*[, ])+\d{3}|\d*)`将匹配由逗号或空格 ( `\d{0,3}(?:[, ]\d{0,3})*[, ])+\d{3}`) 分隔的数字组或一串数字 ( `\d+`) - 因此 123,456,789、123 456 789 和 123456789 将全部匹配。正则表达式不会接受分组不当的数字（所以 123,45,6789 不会匹配）
*   `(?:\.\d*)?`将匹配一个带有可选小数的数字和后面的任意数量的数字
*   `(?:\s*\$)?$`将匹配字符串末尾的可选 $，前面有任意数量的空格。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T15:16:15.840

为什么要写 1 个正则表达式，你可以写几个，然后依次应用它们？

我假设（？）你可以逐行迭代。为什么不试试你的逗号正则表达式，然后是你的空格正则表达式等？如果一个匹配，则不要费心尝试其余的，并存储您的结果并继续下一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:17:05.293

如何分两步执行此操作：

首先用''替换所有空格

然后，如果数字格式始终相同，则可以用 '' 替换逗号

在那之后，它很容易，不是吗？

# asp.net-mvc - ASP.NET MVC 的所有可用 ActionResults 是什么？

> ID：1007680
> 
> 赞同：20
> 
> 时间：2009-06-17T15:14:09.433
> 
> 标签：asp.net-mvc, actionresult

到目前为止，在 ASP.NET MVC 中返回 ActionResult 的所有方法是什么（即 RedirectToAction 等）

我还没有找到列出此类内容的良好文档资源。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-17T15:15:49.807

从[这里找到](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionresult.aspx)

```
System.Web.Mvc.ActionResult
    System.Web.Mvc.ContentResult
    System.Web.Mvc.EmptyResult
    System.Web.Mvc.FileResult
    System.Web.Mvc.HttpUnauthorizedResult
    System.Web.Mvc.JavaScriptResult
    System.Web.Mvc.JsonResult
    System.Web.Mvc.RedirectResult
    System.Web.Mvc.RedirectToRouteResult
    System.Web.Mvc.ViewResultBase

```

控制器对象上的方法在[这里](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller_methods.aspx)

有：

```
内容
文件
Javascript
json
部分视图
重定向
重定向到动作
重定向到路由
看法

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-08T02:37:30.233

从[MVC2 中的 ActionResult 类型](http://weblogs.asp.net/rajbk/Contents/Item/Display/199)：

*   ContentResult – 表示文本结果。

*   EmptyResult – 表示没有结果。

*   FileContentResult – 表示可下载文件（带有二进制内容）。

*   FilePathResult – 表示可下载文件（带有路径）。

*   FileStreamResult – 表示可下载文件（带有文件流）。

*   JavaScriptResult – 表示 JavaScript 脚本。

*   JsonResult – 表示可以在 AJAX 应用程序中使用的 JavaScript 对象表示法结果。

*   PartialViewResult – 表示部分视图呈现的 HTML 和标记。

*   RedirectResult – 表示重定向到新 URL。

*   RedirectToRouteResult – 表示使用指定的路由值字典执行重定向的结果。

*   ViewResult – 表示由视图呈现的 HTML 和标记。

# string - 在 VB 6.0 中用 '' 替换时的堆栈溢出

> ID：1007687
> 
> 赞同：2
> 
> 时间：2009-06-17T15:15:34.033
> 
> 标签：string, ms-access, vb6, replace, stack-overflow

我正在研究一些遗留的 VB 6.0 代码（Access XP 应用程序）来解决 Access 应用程序的 SQL 语句问题。对于客户名称中包含撇号的情况（例如“医生手术”），我需要使用 2 个单引号替换单引号：

```
Replace(customerName, "'", "''") 
```

这将转义单引号，所以我得到了有效的 SQL：

```
SELECT blah FROM blah WHERE customer = 'Doctor''s Surgery' 
```

不幸的是，替换函数会导致无限循环和堆栈溢出，大概是因为它替换函数递归地将每个添加的引号转换为另外 2 个引号。例如，一个引号被替换为两个，然后第二个引号也被替换为两个，依此类推......

- - - - - - - - 编辑 - - - - - - - -

我注意到（感谢海报）这个项目中使用的替换功能是自定义编写的：

```
Public Function replace(ByVal StringToSearch As String, ByVal ToLookFor As String,
ByVal ToReplaceWith As String) As String
Dim found As Boolean
Dim position As Integer
Dim result As String

position = 0
position = InStr(StringToSearch, ToLookFor)
If position = 0 Then
    found = False
    replace = StringToSearch
    Exit Function
Else
    result = Left(StringToSearch, position - 1)
    result = result & ToReplaceWith
    result = result & Right(StringToSearch, Len(StringToSearch) - position - Len(ToLookFor) + 1)
    result = replace(result, ToLookFor, ToReplaceWith)
End If
replace = result

End Function 
```

显然，VB 并不总是有它自己的替换功能。这个实现一定是有缺陷的。将遵循人们的建议并将其删除以支持 VB 6 的实现 - 如果这不起作用，我将编写我自己的方法。谢谢各位的意见！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T15:36:09.560

您确定它不是 Replace 函数的专有实现吗？

如果是这样，它可以被 VB6 的 Replace 替换。

我不记得它出现在哪个版本中（不是在 Vb3 中，而是在 VB6 中），所以如果原始代码库是 vb3/4，它可能是手动编码的版本。

**编辑**

我刚刚看到你的编辑，我是对的！

是的，您应该能够只删除该功能，然后它将使用内置 VB6 替换功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:17:38.460

我们使用一个 VB6 应用程序，它可以选择将 ' 替换为 ` 或完全删除它们。

您还可以遍历这些字母，构建第二个字符串并将每个 ' 作为 '' 插入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T15:29:46.780

我刚刚在 Access 中尝试过，它工作正常（没有 stackoverflow）：

```
 Public Function ReplaceSingleQuote(tst As String) As String
        ReplaceSingleQuote = Replace(tst, "'", "''")
 End Function

 Public Sub TestReplaceSingleQuote()
        Debug.Print ReplaceSingleQuote("Doctor's Surgery")
 End Sub 
```

# c# - ObservableCollection 数据绑定性能

> ID：1007691
> 
> 赞同：5
> 
> 时间：2009-06-17T15:16:09.117
> 
> 标签：c#, wpf, data-binding, collections, observablecollection

我想知道为什么根据这篇[文章](http://msdn.microsoft.com/en-us/library/bb613546.aspx)和可观察集合的绑定速度明显快于 WPF 中的 List<> 集合（20 毫秒对 1685 毫秒，快 800 倍）。我查看了 ObservableCollection 的内部结构，它使用一个 List 作为它的存储集合对象（我使用了反射器并在构造函数中看到了这个）

```
public Collection()
{
    this.items = new List<T>();
} 
```

那么这里发生了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T15:37:21.167

那篇文章中的比较不是在两个简单的绑定操作之间进行的，这些测量是指您将单个项目添加到`ListBox`已经绑定到 a`List<T>`或a 的 WPF 的场景`ObservableCollection<T>`。

正如作者所说：

> ... CLR`List<T>`对象不会自动引发集合更改事件。为了让 获取`ListBox`更改，您必须重新创建员工列表并将其重新附加`ItemsSource`到 `ListBox`. 虽然此解决方案有效，但它会带来巨大的性能影响。每次将`ItemsSource` of重新分配`ListBox`给一个新对象时， `ListBox`第一个对象会丢弃其先前的项目并重新生成其整个列表。

这解释了性能差异。即使`ObservableCollection<T>`由 a 支持`List<T>`，它也实现了`INotifyCollectionChanged`接口，这使得所有额外的处理都是不必要的。

# android - 流式传输 Youtube 视频

> ID：1007695
> 
> 赞同：28
> 
> 时间：2009-06-17T15:16:23.720
> 
> 标签：android, youtube, streaming, android-mediaplayer, android-videoview

我正在编写一个应用程序来使用流媒体播放 youtube 视频。

第一种方法：

我正在使用 GData API 获取视频的 RTSP URL。这是播放 RTSP url 的代码。

```
 VideoView mVideoView = new VideoView(this);
   setContentView(mVideoView);
   mVideoView.setVideoURI(Uri.parse("rtsp://rtsp2.youtube.com/CiILENy73wIaGQkDwpjrUxOWQBMYESARFEgGUgZ2aWRlb3MM/0/0/0/video.3gp"));
   mVideoView.start(); 
```

但它在 G1 设备和模拟器上都抛出错误（根据邮件列表，模拟器有一些防火墙问题）这是错误消息

错误/PlayerDriver(35)：命令 PLAYER_INIT 完成，但出现错误或信息 PVMFFailure

第二种方法：

[一种从http://www.youtube.com/get_video?v=](http://www.youtube.com/get_video?v=) &t=<>&<> 获取3gp 文件路径的 hack 方法 。获取文件路径后，我可以调用 setVideoURI 并且播放正常。但这是实现要求的一种黑客方式。我也检查了 Youtube 应用程序，它也用 hack 方式播放 youtube url。（用 logcat 检查）

我尝试从 VideoView 更改为 MediaPlayer，但错误没有变化。

有没有“干净”的方式来做到这一点？

请让我知道你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-28T10:45:42.393

有时 Uri.parse 返回“null”，因为无法解析 rtsp 协议而不是 http 协议。

使用 Log in logcat 查看它，`Uri.parse(rtspURL).toString()`您将看不到任何内容。或者只做`Log.d("tag", Uri.parse);`，同样会返回。

尝试寻找另一种方法来解析（创建）一个 Uri。

我会尝试并运行：

```
String urlVideo = <your rtspURL>
VideoView video = (VideoView)findViewById(R.id.VideoView01);
Log.d(tag , urlVideo);
video.setVideoURI(Uri.parse(urlVideo));
MediaController mc = new MediaController(this);
video.setMediaController(mc);
video.requestFocus();
video.start();
mc.show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-21T02:29:56.520

如果您愿意在新活动中完成这项工作，以下内容将在设备上工作，但在模拟器上无效：

`startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.youtube.com/watch?v=cxLG2wtE7TM")));`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T19:45:54.110

肮脏的方式完全有效，我印象深刻！如果你有一个可行的解决方案，那就去吧。我认为目前还没有一种干净的方法可以让 RTSP 流在 SDK 中工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T09:12:13.440

关注[Youtube API](https://developers.google.com/youtube/android/player/downloads/)

我认为这也使用 youtube 应用程序（你不想要的）

但只是参考可能是你会找到一些解决它的关键

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-28T10:25:37.520

我们面临一个非常相似的问题。

目前，我正处于项目的第一步，我正试图让视频视图简单地工作。我从这里获取数据：http: [//gdata.youtube.com/demo/](http://gdata.youtube.com/demo/)我正在测试所有视频链接。

RTSP 3GP 视频真的是非常低质量的视频......而且没有办法访问 mp4（高质量）视频。我真的不知道如何使它工作，因为我认为 MP4 流仅适用于高级开发人员......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-02T20:53:18.990

视频上的标题表明它确实适用于 Android。所以，尝试一个好的视频链接来进行试验。这是我使用的一个：

rtsp://184.72.239.149/vod/mp4:BigBuckBunny_115k.mov

我在 Nexus 和三星平板电脑上工作得很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-18T06:35:31.957

我使用以下代码显示了 YouTube 视频。我希望它有用，但请告诉我如何改进它。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    startActivity(new Intent(Intent.ACTION_VIEW, 
                  Uri.parse("http://www.youtube.com/watch?v=...")));
}

public void onPrepared(MediaPlayer mp) {
     // TODO Auto-generated method stub
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-31T18:49:45.903

你可以上网吗？如果没有，请在清单文件中添加 Internet 权限

```
 <uses-permission android:name="android.permission.INTERNET" /> 
```

也请尝试这些 URI：

```
rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov

http://www.wowza.com/_h264/BigBuckBunny_175k.mov 
```

# sql-server - 如何从 SQL Server 中的字符串中去除所有非字母字符？

> ID：1007697
> 
> 赞同：197
> 
> 时间：2009-06-17T15:16:30.850
> 
> 标签：sql-server, parsing, user-defined-functions, alphanumeric, alphabetic

如何从字符串中删除所有非字母字符？

非字母数字怎么办？

这必须是自定义功能还是还有更通用的解决方案？

* * *

## 回答 #1

> 赞同：401
> 
> 时间：2009-06-17T17:46:39.713

试试这个功能：

```
Create Function [dbo].[RemoveNonAlphaCharacters](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    Declare @KeepValues as varchar(50)
    Set @KeepValues = '%[^a-z]%'
    While PatIndex(@KeepValues, @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex(@KeepValues, @Temp), 1, '')

    Return @Temp
End 
```

像这样称呼它：

```
Select dbo.RemoveNonAlphaCharacters('abc1234def5678ghi90jkl') 
```

一旦您理解了代码，您应该会看到更改它以删除其他字符也相对简单。您甚至可以使这个动态足以传递您的搜索模式。

* * *

## 回答 #2

> 赞同：197
> 
> 时间：2009-06-18T14:04:14.413

参数化版本的[乔治马斯特罗斯](https://stackoverflow.com/users/1408129/george-mastros)的[真棒答案](https://stackoverflow.com/questions/1007697/1008566#1008566)：

```
CREATE FUNCTION [dbo].[fn_StripCharacters]
(
    @String NVARCHAR(MAX), 
    @MatchExpression VARCHAR(255)
)
RETURNS NVARCHAR(MAX)
AS
BEGIN
    SET @MatchExpression =  '%['+@MatchExpression+']%'

    WHILE PatIndex(@MatchExpression, @String) > 0
        SET @String = Stuff(@String, PatIndex(@MatchExpression, @String), 1, '')

    RETURN @String

END 
```

仅按字母顺序：

```
SELECT dbo.fn_StripCharacters('a1!s2@d3#f4$', '^a-z') 
```

仅限数字：

```
SELECT dbo.fn_StripCharacters('a1!s2@d3#f4$', '^0-9') 
```

仅限字母数字：

```
SELECT dbo.fn_StripCharacters('a1!s2@d3#f4$', '^a-z0-9') 
```

非字母数字：

```
SELECT dbo.fn_StripCharacters('a1!s2@d3#f4$', 'a-z0-9') 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-20T16:04:53.123

信不信由你，在我的系统中，这个丑陋的功能比 G Mastros 优雅的功能表现得更好。

```
CREATE FUNCTION dbo.RemoveSpecialChar (@s VARCHAR(256)) 
RETURNS VARCHAR(256) 
WITH SCHEMABINDING
    BEGIN
        IF @s IS NULL
            RETURN NULL
        DECLARE @s2 VARCHAR(256) = '',
                @l INT = LEN(@s),
                @p INT = 1

        WHILE @p <= @l
            BEGIN
                DECLARE @c INT
                SET @c = ASCII(SUBSTRING(@s, @p, 1))
                IF @c BETWEEN 48 AND 57
                   OR  @c BETWEEN 65 AND 90
                   OR  @c BETWEEN 97 AND 122
                    SET @s2 = @s2 + CHAR(@c)
                SET @p = @p + 1
            END

        IF LEN(@s2) = 0
            RETURN NULL

        RETURN @s2 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-17T16:40:09.430

我知道 SQL 不擅长字符串操作，但没想到会这么难。这是一个从字符串中删除所有数字的简单函数。会有更好的方法来做到这一点，但这是一个开始。

```
CREATE FUNCTION dbo.AlphaOnly (
    @String varchar(100)
)
RETURNS varchar(100)
AS BEGIN
  RETURN (
    REPLACE(
      REPLACE(
        REPLACE(
          REPLACE(
            REPLACE(
              REPLACE(
                REPLACE(
                  REPLACE(
                    REPLACE(
                      REPLACE(
                        @String,
                      '9', ''),
                    '8', ''),
                  '7', ''),
                '6', ''),
              '5', ''),
            '4', ''),
          '3', ''),
        '2', ''),
      '1', ''),
    '0', '')
  )
END
GO

-- ==================
DECLARE @t TABLE (
    ColID       int,
    ColString   varchar(50)
)

INSERT INTO @t VALUES (1, 'abc1234567890')

SELECT ColID, ColString, dbo.AlphaOnly(ColString)
FROM @t 
```

**输出**

```
ColID ColString
----- ------------- ---
    1 abc1234567890 abc 
```

**第 2 轮 - 数据驱动的黑名单**

```
-- ============================================
-- Create a table of blacklist characters
-- ============================================
IF EXISTS (SELECT * FROM sys.tables WHERE [object_id] = OBJECT_ID('dbo.CharacterBlacklist'))
  DROP TABLE dbo.CharacterBlacklist
GO
CREATE TABLE dbo.CharacterBlacklist (
    CharID              int         IDENTITY,
    DisallowedCharacter nchar(1)    NOT NULL
)
GO
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'0')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'1')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'2')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'3')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'4')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'5')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'6')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'7')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'8')
INSERT INTO dbo.CharacterBlacklist (DisallowedCharacter) VALUES (N'9')
GO

-- ====================================
IF EXISTS (SELECT * FROM sys.objects WHERE [object_id] = OBJECT_ID('dbo.StripBlacklistCharacters'))
  DROP FUNCTION dbo.StripBlacklistCharacters
GO
CREATE FUNCTION dbo.StripBlacklistCharacters (
    @String nvarchar(100)
)
RETURNS varchar(100)
AS BEGIN
  DECLARE @blacklistCt  int
  DECLARE @ct           int
  DECLARE @c            nchar(1)

  SELECT @blacklistCt = COUNT(*) FROM dbo.CharacterBlacklist

  SET @ct = 0
  WHILE @ct < @blacklistCt BEGIN
    SET @ct = @ct + 1

    SELECT @String = REPLACE(@String, DisallowedCharacter, N'')
    FROM dbo.CharacterBlacklist
    WHERE CharID = @ct
  END

  RETURN (@String)
END
GO

-- ====================================
DECLARE @s  nvarchar(24)
SET @s = N'abc1234def5678ghi90jkl'

SELECT
    @s                  AS OriginalString,
    dbo.StripBlacklistCharacters(@s)   AS ResultString 
```

**输出**

```
OriginalString           ResultString
------------------------ ------------
abc1234def5678ghi90jkl   abcdefghijkl 
```

**我对读者的挑战：你能提高效率吗？使用递归怎么样？**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-08-18T10:47:45.883

这是一个不需要创建函数或列出要替换的所有字符实例的解决方案。它结合使用递归 WITH 语句和 PATINDEX 来查找不需要的字符。它将替换列中所有不需要的字符 - 任何给定字符串中最多包含 100 个唯一的坏字符。（例如“ABC123DEF234”将包含 4 个坏字符 1、2、3 和 4）100 个限制是 WITH 语句中允许的最大递归数，但这不会对要处理的行数施加限制，这仅受可用内存的限制。
如果您不想要 DISTINCT 结果，可以从代码中删除这两个选项。

```
-- Create some test data:
SELECT * INTO #testData 
FROM (VALUES ('ABC DEF,K.l(p)'),('123H,J,234'),('ABCD EFG')) as t(TXT)

-- Actual query:
-- Remove non-alpha chars: '%[^A-Z]%'
-- Remove non-alphanumeric chars: '%[^A-Z0-9]%'
DECLARE @BadCharacterPattern VARCHAR(250) = '%[^A-Z]%';

WITH recurMain as (
    SELECT DISTINCT CAST(TXT AS VARCHAR(250)) AS TXT, PATINDEX(@BadCharacterPattern, TXT) AS BadCharIndex
    FROM #testData
    UNION ALL
    SELECT CAST(TXT AS VARCHAR(250)) AS TXT, PATINDEX(@BadCharacterPattern, TXT) AS BadCharIndex
    FROM (
        SELECT 
            CASE WHEN BadCharIndex > 0 
                THEN REPLACE(TXT, SUBSTRING(TXT, BadCharIndex, 1), '')
                ELSE TXT 
            END AS TXT
        FROM recurMain
        WHERE BadCharIndex > 0
    ) badCharFinder
)
SELECT DISTINCT TXT
FROM recurMain
WHERE BadCharIndex = 0; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-03-13T16:44:37.430

如果您像我一样无法访问仅向生产数据添加功能但仍想执行这种过滤，这里有一个纯 SQL 解决方案，使用 PIVOT 表将过滤后的部分重新组合在一起。

**注意**我将表格硬编码为最多 40 个字符，如果您有更长的字符串要过滤，则必须添加更多字符。

```
SET CONCAT_NULL_YIELDS_NULL OFF;

with 
    ToBeScrubbed
as (
    select 1 as id, '*SOME 222@ !@* #* BOGUS !@*&! DATA' as ColumnToScrub
),

Scrubbed as (
    select 
        P.Number as ValueOrder,
        isnull ( substring ( t.ColumnToScrub , number , 1 ) , '' ) as ScrubbedValue,
        t.id
    from
        ToBeScrubbed t
        left join master..spt_values P
            on P.number between 1 and len(t.ColumnToScrub)
            and type ='P'
    where
        PatIndex('%[^a-z]%', substring(t.ColumnToScrub,P.number,1) ) = 0
)

SELECT
    id, 
    [1]+ [2]+ [3]+ [4]+ [5]+ [6]+ [7]+ [8] +[9] +[10]
    +  [11]+ [12]+ [13]+ [14]+ [15]+ [16]+ [17]+ [18] +[19] +[20]
    +  [21]+ [22]+ [23]+ [24]+ [25]+ [26]+ [27]+ [28] +[29] +[30]
    +  [31]+ [32]+ [33]+ [34]+ [35]+ [36]+ [37]+ [38] +[39] +[40] as ScrubbedData
FROM (
    select 
        *
    from 
        Scrubbed
    ) 
    src
    PIVOT (
        MAX(ScrubbedValue) FOR ValueOrder IN (
        [1], [2], [3], [4], [5], [6], [7], [8], [9], [10],
        [11], [12], [13], [14], [15], [16], [17], [18], [19], [20],
        [21], [22], [23], [24], [25], [26], [27], [28], [29], [30],
        [31], [32], [33], [34], [35], [36], [37], [38], [39], [40]
        )
    ) pvt 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-07-22T13:51:47.960

在查看了所有给定的解决方案后，我认为必须有一个纯 SQL 方法，它不需要函数或 CTE / XML 查询，并且不涉及难以维护嵌套的 REPLACE 语句。这是我的解决方案：

```
SELECT 
  x
  ,CASE WHEN a NOT LIKE '%' + SUBSTRING(x, 1, 1) + '%' THEN '' ELSE SUBSTRING(x, 1, 1) END
    + CASE WHEN a NOT LIKE '%' + SUBSTRING(x, 2, 1) + '%' THEN '' ELSE SUBSTRING(x, 2, 1) END
    + CASE WHEN a NOT LIKE '%' + SUBSTRING(x, 3, 1) + '%' THEN '' ELSE SUBSTRING(x, 3, 1) END
    + CASE WHEN a NOT LIKE '%' + SUBSTRING(x, 4, 1) + '%' THEN '' ELSE SUBSTRING(x, 4, 1) END
    + CASE WHEN a NOT LIKE '%' + SUBSTRING(x, 5, 1) + '%' THEN '' ELSE SUBSTRING(x, 5, 1) END
    + CASE WHEN a NOT LIKE '%' + SUBSTRING(x, 6, 1) + '%' THEN '' ELSE SUBSTRING(x, 6, 1) END
-- Keep adding rows until you reach the column size 
    AS stripped_column
FROM (SELECT 
        column_to_strip AS x
        ,'ABCDEFGHIJKLMNOPQRSTUVWXYZ' AS a 
      FROM my_table) a 
```

这样做的好处是有效字符包含在子查询中的一个字符串中，从而可以轻松地为不同的字符集重新配置。

缺点是您必须为每个字符添加一行 SQL，直到您的列大小。为了使这项任务更容易，我只使用了下面的 Powershell 脚本，这个例子是 VARCHAR(64)：

```
1..64 | % {
  "    + CASE WHEN a NOT LIKE '%' + SUBSTRING(x, {0}, 1) + '%' THEN '' ELSE SUBSTRING(x, {0}, 1) END" -f $_
} | clip.exe 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-03-18T06:41:00.903

这是另一种使用`iTVF`. 首先，您需要一个基于模式的字符串拆分器。这是从 Dwain Camp 的[**文章**](http://www.sqlservercentral.com/articles/String+Manipulation/94365/)中摘录的：

```
-- PatternSplitCM will split a string based on a pattern of the form 
-- supported by LIKE and PATINDEX 
-- 
-- Created by: Chris Morris 12-Oct-2012 
CREATE FUNCTION [dbo].[PatternSplitCM]
(
       @List                VARCHAR(8000) = NULL
       ,@Pattern            VARCHAR(50)
) RETURNS TABLE WITH SCHEMABINDING 
AS 

RETURN
    WITH numbers AS (
        SELECT TOP(ISNULL(DATALENGTH(@List), 0))
            n = ROW_NUMBER() OVER(ORDER BY (SELECT NULL))
        FROM
        (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) d (n),
        (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) e (n),
        (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) f (n),
        (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) g (n)
    )

    SELECT
        ItemNumber = ROW_NUMBER() OVER(ORDER BY MIN(n)),
        Item = SUBSTRING(@List,MIN(n),1+MAX(n)-MIN(n)),
        [Matched]
    FROM (
        SELECT n, y.[Matched], Grouper = n - ROW_NUMBER() OVER(ORDER BY y.[Matched],n)
        FROM numbers
        CROSS APPLY (
            SELECT [Matched] = CASE WHEN SUBSTRING(@List,n,1) LIKE @Pattern THEN 1 ELSE 0 END
        ) y
    ) d
    GROUP BY [Matched], Grouper 
```

现在您有了一个基于模式的拆分器，您需要拆分与该模式匹配的字符串：

```
[a-z] 
```

然后将它们连接回来以获得所需的结果：

```
SELECT *
FROM tbl t
CROSS APPLY(
    SELECT Item + ''
    FROM dbo.PatternSplitCM(t.str, '[a-z]')
    WHERE Matched = 1
    ORDER BY ItemNumber
    FOR XML PATH('')
) x (a) 
```

* * *

[**样本**](http://sqlfiddle.com/#!6/10c31/1/0)

结果：

```
| Id |              str |              a |
|----|------------------|----------------|
|  1 |    test“te d'abc |     testtedabc |
|  2 |            anr¤a |           anra |
|  3 |  gs-re-C“te d'ab |     gsreCtedab |
|  4 |         M‚fe, DF |          MfeDF |
|  5 |           R™temd |          Rtemd |
|  6 |          ™jad”ji |          jadji |
|  7 |      Cje y ret¢n |       Cjeyretn |
|  8 |        J™kl™balu |        Jklbalu |
|  9 |       le“ne-iokd |       leneiokd |
| 10 |   liode-Pyr‚n‚ie |    liodePyrnie |
| 11 |         V„s G”ta |          VsGta |
| 12 |        Sƒo Paulo |        SoPaulo |
| 13 |  vAstra gAtaland | vAstragAtaland |
| 14 |  ¥uble / Bio-Bio |     ubleBioBio |
| 15 | U“pl™n/ds VAsb-y |    UplndsVAsby | 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-01-19T03:12:50.943

此解决方案受 Allen 先生的解决方案启发，需要一个`Numbers`整数表（如果您想以良好的性能进行严肃的查询操作，您应该手头有它）。它不需要 CTE。您可以更改`NOT IN (...)`表达式以排除特定字符，或将其更改为`IN (...)`OR`LIKE`表达式以仅保留某些字符。

```
SELECT (
    SELECT  SUBSTRING([YourString], N, 1)
    FROM    dbo.Numbers
    WHERE   N > 0 AND N <= CONVERT(INT, LEN([YourString]))
        AND SUBSTRING([YourString], N, 1) NOT IN ('(',')',',','.')
    FOR XML PATH('')
) AS [YourStringTransformed]
FROM ... 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-06-01T21:48:49.913

这是另一个递归 CTE 解决方案，基于@Gerhard Weiss 在[此处](https://stackoverflow.com/a/3917698/450750)的回答。您应该能够将整个代码块复制并粘贴到 SSMS 中并在那里使用它。结果包括一些额外的列，以帮助我们了解正在发生的事情。我花了一段时间才理解 PATINDEX (RegEx) 和递归 CTE 的所有内容。

```
DECLARE @DefineBadCharPattern varchar(30)
SET @DefineBadCharPattern = '%[^A-z]%'  --Means anything NOT between A and z characters (according to ascii char value) is "bad"
SET @DefineBadCharPattern = '%[^a-z0-9]%'  --Means anything NOT between a and z characters or numbers 0 through 9 (according to ascii char value) are "bad"
SET @DefineBadCharPattern = '%[^ -~]%'  --Means anything NOT between space and ~ characters (all non-printable characters) is "bad"
--Change @ReplaceBadCharWith to '' to strip "bad" characters from string
--Change to some character if you want to 'see' what's being replaced. NOTE: It must be allowed accoring to @DefineBadCharPattern above
DECLARE @ReplaceBadCharWith varchar(1) = '#'  --Change this to whatever you want to replace non-printable chars with 
IF patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN, @ReplaceBadCharWith) > 0
    BEGIN
        RAISERROR('@ReplaceBadCharWith value (%s) must be a character allowed by PATINDEX pattern of %s',16,1,@ReplaceBadCharWith, @DefineBadCharPattern)
        RETURN
    END
--A table of values to play with:
DECLARE @temp TABLE (OriginalString varchar(100))
INSERT @temp SELECT ' 1hello' + char(13) + char(10) + 'there' + char(30) + char(9) + char(13) + char(10)
INSERT @temp SELECT '2hello' + char(30) + 'there' + char(30)
INSERT @temp SELECT ' 3hello there'
INSERT @temp SELECT ' tab' + char(9) + ' character'
INSERT @temp SELECT 'good bye'

--Let the magic begin:
;WITH recurse AS (
    select
    OriginalString,
    OriginalString as CleanString,
    patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN, OriginalString) as [Position],
    substring(OriginalString,patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN, OriginalString),1) as [InvalidCharacter],
    ascii(substring(OriginalString,patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN, OriginalString),1)) as [ASCIICode]
    from @temp
   UNION ALL
    select
    OriginalString,
    CONVERT(varchar(100),REPLACE(CleanString,InvalidCharacter,@ReplaceBadCharWith)),
    patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN,CleanString) as [Position],
    substring(CleanString,patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN,CleanString),1),
    ascii(substring(CleanString,patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN,CleanString),1))
    from recurse
    where patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN,CleanString) > 0
)
SELECT * FROM recurse
--optionally comment out this last WHERE clause to see more of what the recursion is doing:
WHERE patindex(@DefineBadCharPattern COLLATE Latin1_General_BIN,CleanString) = 0 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-07-15T14:58:51.470

我把它放在调用 PatIndex 的两个地方。

```
PatIndex('%[^A-Za-z0-9]%', @Temp) 
```

对于上面的自定义函数 RemoveNonAlphaCharacters 并将其重命名为 RemoveNonAlphaNumericCharacters

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-07-19T08:15:51.837

--首先创建一个函数

```
CREATE FUNCTION [dbo].[GetNumericonly]
(@strAlphaNumeric VARCHAR(256))
RETURNS VARCHAR(256)
AS
BEGIN
     DECLARE @intAlpha INT
     SET @intAlpha = PATINDEX('%[^0-9]%', @strAlphaNumeric)
BEGIN
     WHILE @intAlpha > 0
   BEGIN
          SET @strAlphaNumeric = STUFF(@strAlphaNumeric, @intAlpha, 1, '' )
          SET @intAlpha = PATINDEX('%[^0-9]%', @strAlphaNumeric )
   END
END
RETURN ISNULL(@strAlphaNumeric,0)
END 
```

现在调用这个函数

```
select [dbo].[GetNumericonly]('Abhi12shek23jaiswal') 
```

它的结果像

```
1223 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-12-27T15:38:56.787

从性能的角度来看，我会使用内联函数：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[udf_RemoveNumericCharsFromString]
(
@List NVARCHAR(4000)
)
RETURNS TABLE 
AS RETURN

    WITH GetNums AS (
       SELECT TOP(ISNULL(DATALENGTH(@List), 0))
        n = ROW_NUMBER() OVER(ORDER BY (SELECT NULL))
        FROM
          (VALUES (0),(0),(0),(0)) d (n),
          (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) e (n),
          (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) f (n),
          (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) g (n)
            )

    SELECT StrOut = ''+
        (SELECT Chr
         FROM GetNums
            CROSS APPLY (SELECT SUBSTRING(@List , n,1)) X(Chr)
         WHERE Chr LIKE '%[^0-9]%' 
         ORDER BY N
         FOR XML PATH (''),TYPE).value('.','NVARCHAR(MAX)')

   /*How to Use
   SELECT StrOut FROM dbo.udf_RemoveNumericCharsFromString ('vv45--9gut')
   Result: vv--gut
   */ 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-01-21T10:48:49.893

SQL Server 2017+ 的另一个可能选项，没有循环和/或递归，是使用`TRANSLATE()`and的基于字符串的方法`REPLACE()`。

T-SQL 语句：

```
DECLARE @pattern varchar(52) = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'

SELECT 
   v.[Text], 
   REPLACE(
      TRANSLATE(
         v.[Text],
         REPLACE(TRANSLATE(v.[Text], @pattern, REPLICATE('a', LEN(@pattern))), 'a', ''),
         REPLICATE('0', LEN(REPLACE(TRANSLATE(v.[Text], @pattern, REPLICATE('a', LEN(@pattern))), 'a', '')))
      ),
      '0',
      ''
   ) AS AlphabeticCharacters
FROM (VALUES
   ('abc1234def5678ghi90jkl#@$&'),
   ('1234567890'),
   ('JAHDBESBN%*#*@*($E*sd55bn')
) v ([Text]) 
```

或作为一个函数：

```
CREATE FUNCTION dbo.RemoveNonAlphabeticCharacters (@Text varchar(1000)) 
RETURNS varchar(1000)
AS BEGIN

   DECLARE @pattern varchar(52) = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'
   SET @text = REPLACE(
      TRANSLATE(
         @Text,
         REPLACE(TRANSLATE(@Text, @pattern, REPLICATE('a', LEN(@pattern))), 'a', ''),
         REPLICATE('0', LEN(REPLACE(TRANSLATE(@Text, @pattern, REPLICATE('a', LEN(@pattern))), 'a', '')))
      ),
      '0',
      ''
   )

   RETURN @Text
END 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-07-28T16:29:56.580

对于 SQL Server >= 2017...

```
declare @text varchar(max)

-- create some sample text
select
@text=
'
Lorem @ipsum  *&dolor-= sit?! amet, {consectetur } adipiscing\ elit. Vivamus commodo justo metus, sed facilisis ante 
congue eget. Proin ac bibendum sem/.
'

-- the characters to be removed
declare @unwanted varchar(max)='''.,!?/<>"[]{}|`~@#$%^&*()-+=/\:;'+char(13)+char(10)

-- interim replaced with
declare @replace_with char(1)=' '

-- call the translate function that will change unwanted characters to spaces
-- in this sample
declare @translated varchar(max)
select @translated=TRANSLATE(@text,@unwanted,REPLICATE(@replace_with,len(@unwanted)))

-- In this case, I want to preserve one space
select  string_agg(trim(value),' ')
from    STRING_SPLIT(@translated,' ')
where   trim(value)<>''

-- Result
'Lorem ipsum dolor sit amet consectetur adipiscing elit Vivamus commodo justo metus sed facilisis ante congue eget Proin ac bibendum sem' 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-08-06T16:27:51.833

使用 CTE 生成的数字表检查每个字符，然后使用 FOR XML 连接到保留值的字符串，您可以...

```
CREATE FUNCTION [dbo].[PatRemove](
    @pattern varchar(50),
    @expression varchar(8000) 
    )
RETURNS varchar(8000)
AS
BEGIN
    WITH 
        d(d) AS (SELECT d FROM (VALUES (0),(1),(2),(3),(4),(5),(6),(7),(8),(9)) digits(d)),
        nums(n) AS (SELECT ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) FROM d d1, d d2, d d3, d d4),
        chars(c) AS (SELECT SUBSTRING(@expression, n, 1) FROM nums WHERE n <= LEN(@expression))
    SELECT 
        @expression = (SELECT c AS [text()] FROM chars WHERE c NOT LIKE @pattern FOR XML PATH(''));

    RETURN @expression;
END 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-09-27T08:34:06.117

```
DECLARE @vchVAlue NVARCHAR(255) = 'SWP, Lettering Position 1: 4 Ω, 2: 8 Ω, 3: 16 Ω, 4:  , 5:  , 6:  , Voltage Selector, Solder, 6, Step switch, : w/o fuseholder '

WHILE PATINDEX('%?%' , CAST(@vchVAlue AS VARCHAR(255))) > 0
  BEGIN
    SELECT @vchVAlue = STUFF(@vchVAlue,PATINDEX('%?%' , CAST(@vchVAlue AS VARCHAR(255))),1,' ')
  END 

SELECT @vchVAlue 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-10-26T11:32:18.913

这种方式对我不起作用，因为我试图保留阿拉伯字母，我试图替换正则表达式，但它也不起作用。我编写了另一种在 ASCII 级别上工作的方法，因为它是我唯一的选择并且它有效。

```
 Create function [dbo].[RemoveNonAlphaCharacters] (@s varchar(4000)) returns varchar(4000)
   with schemabinding
begin
   if @s is null
      return null
   declare @s2 varchar(4000)
   set @s2 = ''
   declare @l int
   set @l = len(@s)
   declare @p int
   set @p = 1
   while @p <= @l begin
      declare @c int
      set @c = ascii(substring(@s, @p, 1))
      if @c between 48 and 57 or @c between 65 and 90 or @c between 97 and 122 or @c between 165 and 253 or @c between 32 and 33
         set @s2 = @s2 + char(@c)
      set @p = @p + 1
      end
   if len(@s2) = 0
      return null
   return @s2
   end 
```

去

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-09-24T14:31:25.693

虽然帖子有点老了，但我想说以下几点。我对上述解决方案的问题是它没有过滤掉ç、ë、ï等字符。我调整了一个函数如下（我只使用了一个 80 varchar 字符串来节省内存）：

```
create FUNCTION dbo.udf_Cleanchars (@InputString varchar(80)) 
RETURNS varchar(80) 
AS 

BEGIN 
declare @return varchar(80) , @length int , @counter int , @cur_char char(1) 
SET @return = '' 
SET @length = 0 
SET @counter = 1 
SET @length = LEN(@InputString) 
IF @length > 0 
BEGIN WHILE @counter <= @length 

BEGIN SET @cur_char = SUBSTRING(@InputString, @counter, 1) IF ((ascii(@cur_char) in (32,44,46)) or (ascii(@cur_char) between 48 and 57) or (ascii(@cur_char) between 65 and 90) or (ascii(@cur_char) between 97 and 122))
BEGIN SET @return = @return + @cur_char END 
SET @counter = @counter + 1 
END END 

RETURN @return END 
```

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2014-08-01T15:54:40.827

如果您正在使用它，我刚刚发现它内置在 Oracle 10g 中。为了比较电话号码，我不得不去掉所有特殊字符。

```
regexp_replace(c.phone, '[^0-9]', '') 
```

# sql - 定义弱定义的参考游标的麻烦

> ID：1007699
> 
> 赞同：2
> 
> 时间：2009-06-17T15:16:43.203
> 
> 标签：sql, oracle

我正在尝试编写一个存储过程，它接收一个数字 n，并返回给定查询的前 n 个结果，专门锁定那些 n 行。我对 SQL 有点陌生，并且在正确匹配数据类型时遇到了一些困难。

我的包装规格如下所示：

```
PACKAGE package IS
   Type out_result_type is REF CURSOR;
   PROCEDURE stored_proc
     (in_n IN NUMBER DEFAULT 10, 
        out_list IN OUT out_result_type); 
```

然后我在过程主体中定义光标，如下所示：

```
CURSOR OUT_RESULT_TYPE IS
        SELECT a.id
            FROM schema.table a
            WHERE (some conditions) AND rownum <= in_n; 
```

稍后我尝试将游标的结果提取到输出变量中：

```
OPEN OUT_RESULT_TYPE;
FETCH OUT_RESULT_TYPE INTO out_list; -- error on this line
CLOSE OUT_RESULT_TYPE; 
```

但是很遗憾，这段代码无法编译；oracle 抱怨 out_list 已使用冲突的数据类型定义。知道如何解决这个问题吗？这让我疯狂！

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:33:48.317

```
CREATE OR REPLACE PACKAGE pkg_test
AS
        TYPE    tt_cur IS REF CURSOR;
        PROCEDURE prc_cur (retval OUT tt_cur);
END;

CREATE OR REPLACE PACKAGE BODY pkg_test
AS
        PROCEDURE prc_cur (retval OUT tt_cur)
        AS
        BEGIN
                OPEN    retval
                FOR
                SELECT  *
                FROM    dual;
        END;
END; 
```

如果要锁定，请使用：

```
CREATE OR REPLACE PACKAGE BODY pkg_test
AS
        PROCEDURE prc_cur (retval OUT tt_cur)
        AS
        BEGIN
                OPEN    retval
                FOR
                SELECT  a.id
                FROM    schema.table a
                WHERE   (some conditions)
                        AND rownum <= in_n
                ORDER BY
                        column
                -- Never forget ORDER BY!
                FOR UPDATE;
        END;
END; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:53:11.627

这不会像它写的那样工作，因为

1.  `out_list`需要一个游标，而不是游标结果。
2.  该名称`out_result_type`已用于**type**，因此您不能将其重新定义为同一范围内的**游标**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T16:37:59.667

Oracle 提供了一个预定义的弱引用游标：sys_refcursor。在使用中，它看起来像：

```
CREATE OR REPLACE PACKAGE pkg_test
AS
    PROCEDURE prc_cur (p_retval OUT sys_refcursor,
                       p_lookup IN  VARCHAR2);
END pkg_test;

CREATE OR REPLACE PACKAGE BODY pkg_test 
AS
    PROCEDURE prc_cur(p_retval OUT sys_refcursor
                      p_lookup IN  VARCHAR2) 
    IS
    BEGIN
        OPEN retval FOR SELECT a.value 
                          FROM tblname a 
                         WHERE a.id <= p_lookup;
    END prc_cur;
END pkg_test; 
```

这省去了需要声明类型的麻烦。sys_refcursor 是指向打开游标的结果集的指针。如果您熟悉 Java，它与 java.sql.ResultSet 对象的概念相同，后者提供了一种获取查询结果的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T15:33:48.990

你`out_list`的类型一定是错误的。考虑（脚本在 10.2.0.3 上运行）：

```
CREATE TABLE t AS SELECT ROWNUM ID FROM all_objects WHERE ROWNUM <= 100;

CREATE OR REPLACE PACKAGE cursor_pck AS
   TYPE out_result_type is REF CURSOR;
   PROCEDURE stored_proc (p_in IN NUMBER DEFAULT 10, 
                          p_out_list IN OUT out_result_type);
END cursor_pck;
/ 
```

如果要同时选择并锁定行，则可以使用该`FOR UPDATE`子句：

```
CREATE OR REPLACE PACKAGE BODY cursor_pck AS
   PROCEDURE stored_proc (p_in IN NUMBER DEFAULT 10,  
                          p_out_list IN OUT out_result_type) IS
   BEGIN
      OPEN p_out_list FOR SELECT a.id FROM t a WHERE ROWNUM <= p_in FOR UPDATE;
   END stored_proc;
END cursor_pck;
/ 
```

通过以下设置，您将调用如下过程：

```
SQL> SET SERVEROUTPUT ON;
SQL> DECLARE
  2     l_cursor cursor_pck.out_result_type;
  3     l_id t.id%TYPE;
  4  BEGIN
  5     cursor_pck.stored_proc(3, l_cursor);
  6     LOOP
  7        FETCH l_cursor INTO l_id;
  8        EXIT WHEN l_cursor%NOTFOUND;
  9        dbms_output.put_line(l_id);
 10     END LOOP;
 11  END;
 12  /

1
2
3

PL/SQL procedure successfully completed 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:34:10.050

两个备注：

1.  游标未锁定。
2.  您不必这样做`Type out_result_type is REF CURSOR;`，使用默认类型 sys_refcursor。请参阅此处：[Oracle - 如何在存储过程中有一个 out ref 游标参数？](https://stackoverflow.com/questions/869055/oracle-how-to-have-an-out-ref-cursor-parameter-in-a-stored-procedure/869730#869730)

# html - XSLT 插入 html 内容

> ID：1007700
> 
> 赞同：2
> 
> 时间：2009-06-17T15:16:56.947
> 
> 标签：html, xml, xslt

我正在尝试在给定点插入一些 HTML。XML 文件有一个内容节点，其中包含实际的 HTML。例如，这里是 XML 的内容部分：

```
-----------------
<content>
    <h2>Header</h2>
    <p><a href="...">some link</a></p>
    <p><a href="...">some link1</a></p>
    <p><a href="...">some link2</a></p>
</content>
----------------- 
```

我需要在标题之后但在第一个链接之前插入一个链接，在它自己的 p 标签内。XSLT 有点生疏，感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:23:17.090

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/content">
        <xsl:copy-of select="h2"/>
        <a href="">foo</a>
        <xsl:copy-of select="p"/>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T15:24:15.200

鉴于此来源：

```
<html>
    <head/>
    <body>
        <content>
            <h2>Header</h2>
            <p><a href="...">some link</a></p>
            <p><a href="...">some link1</a></p>
            <p><a href="...">some link2</a></p>
        </content>
    </body>
</html> 
```

这个样式表会做你想做的事：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="/html/body/content/h2">
        <xsl:copy>
            <xsl:apply-templates/>
        </xsl:copy>
        <p><a href="...">your new link</a></p>
    </xsl:template>
</xsl:stylesheet> 
```

# sql-server-2005 - 我可以在 Visual Studio 之外运行/测试/创建 dtsx 包吗？

> ID：1007701
> 
> 赞同：0
> 
> 时间：2009-06-17T15:16:59.570
> 
> 标签：sql-server-2005, visual-studio-2005, bids, ssis

对 dtsx 包不太熟悉 - 可以创建/运行 outisde Visual Studio 吗？

BIDS（商业智能开发工作室）是否只需要执行上述所有操作（在 Visual Studio 中）还是 dtsx 包的独立开发环境？

如果可以的话，请提供一些信息（并获得一些简单的代表）！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:17:49.007

绝对地！只需双击它（启动`dtexecui.exe`）或使用[`dtexec`](http://msdn.microsoft.com/en-us/library/ms162810.aspx)命令。看看这里的所有方式是如何叠加[的](http://msdn.microsoft.com/en-us/library/ms138023.aspx)。

回答其他一些问题：

BIDS 是构建 SSIS 包的唯一环境。您可以手写 XML，但祝您好运。BIDS 是一个独立的产品，也是一个集成的产品，因此只需从 SQL Server DVD 安装它。您**无需**购买 Visual Studio 即可使用 BIDS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:21:37.080

Visual Studio 基于 Visual Studio“包”(vspackages) 中的功能集。BIDS 只是带有用于 SSIS、SSRS 和 SSAS 开发的 vspackages 的 Visual Studio。如果您已经安装了这些相同的 vspackages，则可以通过“普通”Visual Studio 使用。

如果您没有安装 Visual Studio，则安装 BIDS 会安装它。

尽管您可以在 VS 之外运行 SSIS 包，但您几乎无法以这种方式调试它们。在 VS 之外创建它们是不切实际的。

你有理由这样做吗？

* * *

是的，就 BIDS 而言，您可以摆脱 VS2005。安装 Visual Studio 2008 SP1，然后安装您需要的 SQL Server 2008 位，包括 BIDS 2008。

如果您仍然需要使用 SQL Server 2005 SSIS 包，那么您仍然需要 VS2005 才能使用它们。

# c# - SQL Server 2005 程序集强制转换无效

> ID：1007702
> 
> 赞同：0
> 
> 时间：2009-06-17T15:17:03.717
> 
> 标签：c#, sql-server, sql-server-2005, assemblies, types

我正在尝试调用我的程序集 SP 并收到以下错误：

```
A .NET Framework error occurred during execution of user-defined routine or aggregate "Pmt_ImportJournal": 
System.InvalidCastException: Specified cast is not valid.
System.InvalidCastException: 
   at JournalImport.Pmt_ImportJournal(Int32 orderno) 
```

我在程序集中的 SP 定义如下：

```
[SqlProcedure(Name = "Pmt_ImportJournal")]
public static void Pmt_ImportJournal(int orderno) 
```

我应该在签名中使用 SQL* 数据类型而不是简单的 int 吗？例如 SqlInt32？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T15:40:26.853

您是否尝试过查看创建的存储过程的签名？另外，您的方法中是否有可能存在转换错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:14:28.950

检查 Pmt_ImportJournal 方法内部。里面的某些代码行可能会引发异常。

# visual-studio-2008 - 如何阻止 Visual Studio 将 Crystal Reports 添加到工具箱？

> ID：1007713
> 
> 赞同：1
> 
> 时间：2009-06-17T15:18:05.637
> 
> 标签：visual-studio-2008, crystal-reports

我的项目中有大约 30 到 40 个报告，每次我启动 Visual Studio 并转到设计器时，Visual Studio 2008 都会坚持将它们添加到工具箱中。正如您可以想象的那样，这需要一段时间并且消耗我本来可以编程的时间。我还有其他不想离开的自定义控件，但我根本不需要那里显示的报告。有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:31:26.640

您需要进入工具 --> 选项然后找到 Windows 窗体设计器的常规属性。然后将最后一个条目 AutoToolboxPopulate 设置为 False。

这将阻止 Visual Studio 将您的报告加载到工具箱中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:04:42.353

不确定这是否适用于您的项目，但不要使用强类型报告。我从来没有用过它们。为什么需要 30 个？我一直将报告路径存储在数据库中，并将所有 .rpt 文件保存在程序集中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:30:27.347

有趣的。我以前从未见过这种情况。您可以右键单击工具箱并单击“选择项目”以打开工具箱项目窗口。在那里，您可以确保未在 .NET Framework 组件选项卡中选择它们。

如果它们与您的用户控件混为一谈，那么我认为您可以更改报告或用户控件的名称空间以将它们分开，但我不能 100% 确定这一点。希望这只是一点点帮助。:)

# wpf - 您的 ViewModel 是否应该将 XAML 元素公开为属性？

> ID：1007715
> 
> 赞同：2
> 
> 时间：2009-06-17T15:18:28.067
> 
> 标签：wpf, silverlight, xaml, mvvm, valueconverter

在 StackOverflow 问题上，**[如何在 MVVM 模式中使用 WPF 转换器？](https://stackoverflow.com/questions/1007487/how-can-wpf-converters-be-used-in-an-mvvm-pattern/1007581)**我了解到，值转换器不应该在 MVVM 模式中使用，因为**值转换器的功能应该由 ViewModel 本身处理**。

这是有道理的。

但我记得读过你不应该**向 View 公开 XAML 元素**，而是只公开 View 然后使用 DataTemplates 绑定和显示的数据集合。

但是，转换器似乎非常强大（例如，它们在[MVVM 模板演示](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=14962)中使用，解压后请参阅“Messenger 示例”），因为**它们可以将对象转换为对象**，例如将消息对象转换为 FlowDocument 对象，或将客户对象转换为 Visibility 对象，或自定义状态对象到图像等。

因此，如果 ViewModel 要**承担 Value Converter 的功能**，就必须公开 XAML 元素和属性，例如 StackPanel、Visibility、Color、FlowDocument 等，对吗？

**有谁知道为什么 ViewModel 不应该像值转换器那样公开这些丰富的 XAML 对象？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T15:27:38.503

因为那样会限制 ViewModel 只能用于特定的视觉表示。一旦您让 ViewModel 发出 XAML，它就会将设计内容放入开发人员的域中。这意味着使用 Expression Blend 的设计人员无法编辑设计资产 - 并且设计人员/开发人员工作流程被破坏。将 XAML 保留在页面上并使用带有数据模板的值转换器使设计与代码分离。

当您的 ViewModel 公开特定的 XAML 时，它还会将该 ViewModel 限制为仅在该特定实例中使用，并使其可重用性降低。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T15:33:38.833

不要忘记您也可以使用 DataTemplates。我可以看到将 ValueConverters 排除在 MVVM 之外的一些意义，但 DataTemplates 都是关于将对象转换为 GUI 的。

您的 ViewModel 可以向 GUI 公开其他对象（例如嵌套的 ViewModel），GUI 可以使用`<DataTemplate DataType="{x:Type SubViewModel}">...`这些对象将这些对象映射到 GUI。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T19:37:23.987

> 有谁知道为什么 ViewModel 不应该像值转换器那样公开这些丰富的 XAML 对象？

绝对可以，因为它破坏了 MVVM 的所有目标：

1.  你不再是可单元测试的，至少不容易。
2.  您不再有逻辑（视图模型）和表示（视图）之间的分离。因此，设计人员和开发人员无法轻松协作。
3.  代码维护更加困难，因为您将关注点混合在一起。

如果我看到一个视图模型返回一个视图，我什至不会将其归类为 MVVM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T15:30:02.443

我认为 mvvm/mvc/mvp 等的一个想法是将 GUI 代码隔离到一个文件/类。如果你这样做，你可以在不重写其他对象的情况下更改为其他 UI 吗？我认为如果您传递 WPF 特定对象，答案是否定的。这是您必须为自己做出的价值判断。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-10-11T19:44:43.470

当您讨论这些概念时，没有绝对 100% 的规则适用于这个或许多其他概念，而没有了解为什么社区的思想已经朝着这个方向转变。“传统智慧”中没有“假定的”真理或科学，无论它在当时多么新颖或令人信服。

换句话说——只要和你的团队一起做最好的事情，就好像你是个好人一样，你已经在人类问题上被拖垮了，而不是像这样真实的事情。

# database - PostgreSQL -> Oracle 复制

> ID：1007724
> 
> 赞同：3
> 
> 时间：2009-06-17T15:19:37.973
> 
> 标签：database, oracle, postgresql, replication

我正在寻找一种将数据从 PostgreSQL 数据库导出到 Oracle 数据仓库的工具。我真的在寻找异构数据库复制工具，而不是导出->转换-​​>导入解决方案。

[Continuent Tungsten Replicator](http://www.continuent.com/community/tungsten-replicator)看起来可以完成这项工作，但 PostgreSQL 支持还要几个月才能准备好。

是否有任何开源工具可以做到这一点？还是我坚持使用某种预定的 pg_dump/SQL*Loader 解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:28:30.340

您可以创建从 Oracle 到 Postgres 的数据库链接（这称为异构连接）。这使得在 Oracle 中使用 select 语句从 Postgres 中选择数据成为可能。您可以使用物化视图来安排和存储这些选择的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-27T01:51:30.213

听起来[SymmetricDS](http://symmetricds.org)适合您的场景。SymmetricDS 是支持网络的、独立于数据库的数据同步/复制软件。它使用 Web 和数据库技术在关系数据库之间近乎实时地复制表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T02:30:58.783

听起来您想要一个 ETL（提取转换负载）工具。有很多开源选项 Enhydra Octopus 和 Talend Open Studio 是我遇到的几个。一般来说，ETL 工具为您提供比直接跨复制选项更好的灵活性。有些提供调度、数据质量和数据沿袭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-30T23:00:18.423

如果您想跨异构数据库实时复制数据更改，请考虑使用 Confluent Kafka Connect JDBC 接收器和源连接器。源连接器可以选择整个数据库、特定表或由提供的查询返回的行，并将数据作为 Kafka 消息发送到您的 Kafka 代理。源连接器可以根据递增的 id 列、时间戳列计算差异，或者以批量模式运行，其中定期重新复制整个内容。接收器可以读取这些消息，可选择根据 avro 或 json 模式检查它们，并使用结果填充源数据库。它都是免费的，许多关系和非关系数据库都存在多个接收器和源连接器。

*一个主要警告 - 一些 JDBC Kafka 连接器无法捕获硬删除

为了解决这个限制，您可以使用专有连接器，例如 Debezium ( [http://www.debezium.io](http://www.debezium.io) )，另请参阅 [从 JDBC Kafka Connect Source 中删除事件](https://stackoverflow.com/questions/45044641/delete-events-from-jdbc-kafka-connect-source)。

# regex - 查找最后一个下划线之前的字符

> ID：1007725
> 
> 赞同：2
> 
> 时间：2009-06-17T15:20:16.147
> 
> 标签：regex

有谁知道如何查找文件名中最后一个下划线之前的所有字符。

IABU_Real_Egypt_AUS09_012.indd

我需要的结果是 IABU_Real_Egypt_AUS09

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T15:26:45.460

`/(.*)_/`并获取捕获的价值。正则表达式通常是贪婪的，所以它是自动的（你不需要否定字符类）。

`irb(main):007:0> "IABU_Real_Egypt_AUS09_012.indd".match(/(.*)_/)[1]`

`=> "IABU_Real_Egypt_AUS09"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:23:16.653

怎么样：

```
(.*?)_[^_]* 
```

然后你想要的结果在第 1 组中。（你没有指定语言，所以这是我能做到的。）

有不止一种方法可以做到这一点。我相信您可以使用前瞻或后视。我所做的是：

1.  匹配尽可能多的字符（但非贪婪）。将它们保存在一个组中。
2.  匹配下划线。
3.  匹配任意数量的字符，只要它们不是下划线。

这将涉及一些回溯，因此如果这是对性能至关重要的一段代码，您可能需要比我做的更多优化它。

更好的解决方案是从字符串的末尾开始并向后计数，直到到达下划线，然后将子字符串从 0 带到该索引。这可能比使用正则表达式更快、更清晰。例如，在 Java 中：

```
public static String getUpToUnderscore(String str) {
    return str.substring(0, str.lastIndexOf('_'));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:31:30.647

C# 中的非正则表达式示例：

```
s.Substring(0, s.LastIndexOf('_')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T15:25:34.340

假设您至少有 1 个下划线，您可以执行以下操作：

```
/(.*_[^_]+)/ 
```

# java - Java 日期格式转 JavaScript 日期格式

> ID：1007732
> 
> 赞同：43
> 
> 时间：2009-06-17T15:21:21.493
> 
> 标签：java, javascript, date-format

我希望能够将 Java 日期格式字符串，例如*dd/MM/yyyy* (07/06/2009) 转换为 JavaScript 日期格式字符串，例如*dd/mm/yy* (07/06/2009)。

以前有没有人这样做过，或者知道我在哪里可以找到一些已经这样做的代码？

提前致谢。

**编辑：**

感谢所有回复，但现在我意识到我的错误，可能是为什么你们这么多人都在努力理解这个问题；JavaScript 没有内置的日期格式化功能。我正在使用 jQuery UI 日期选择器，并且我一直在设置它的日期格式，假设它会在某个时候调用标准的 JS 函数，而不是使用它自己的库！当我搜索格式化字符串时，我直接跳到了可以使用哪些字母的表格，跳过了开头解释如何使用脚本的部分。

无论如何，我将不得不继续并可能编写自己的我猜，将 Java 日期格式字符串转换为 jQuery 日期格式字符串（或尽可能接近） - 我正在研究我们产品的 i18n 并创建了一个 java存储整个应用程序中使用的首选日期格式字符串的类，我的意图是还能够为任何 jsps 提供与 JS 中等效的格式字符串。

不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-06-17T15:38:20.057

如果您只需要将日期从 Java 传递到 JavaScript，我认为最好的方法是使用 将 Java 日期转换为毫秒`date.getTime()`，创建一个使用此毫秒值初始化的 JavaScript 日期`new Date(milliseconds)`，然后使用格式化日期JavaScript Date 对象的方式，例如：`date.toLocaleString()`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-10-02T16:00:54.173

你可以使用我的插件[jquery-dateFormat](http://github.com/phstc/jquery-dateFormat)。

```
// Text
$.format.date("2009-12-18 10:54:50.546", "dd/MM/yyyy");
// HTML Object
$.format.date($("#spanDate").text(), "dd/MM/yyyy");
// Scriptlet
$.format.date("<%=java.util.Date().toString()%>", "dd/MM/yyyy");
// JSON
var obj = ajaxRequest();
$.format.date(obj.date, "dd/MM/yyyy"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:33:39.877

此处已回答了类似的主题： [Converting dates in JavaScript](https://stackoverflow.com/questions/758999/converting-dates-in-javascript)

我个人发现这是一个相当大的痛苦，并接受了作者的建议并使用了一个库。如前所述，如果您可以负担应用程序的下载开销或已经在使用它，那么 jQuery datepicker 有一个可行的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-11T19:28:04.383

查看[moment.js](http://momentjs.com/)！它是“用于解析、操作和格式化日期的轻量级 JavaScript 日期库”。这是一个非常强大的小图书馆。

这是一个例子......

```
var today = moment(new Date());
today.format("MMMM D, YYYY h:m A");        // outputs "April 11, 2012 2:32 PM"

// in one line...
moment().format("MMMM D, YYYY h:m A");     // outputs "April 11, 2012 2:32 PM" 
```

这是另一个例子......

```
var a = moment([2012, 2, 12, 15, 25, 50, 125]);
a.format("dddd, MMMM Do YYYY, h:mm:ss a"); // "Monday, March 12th 2012, 3:25:50 pm"
a.format("ddd, hA");                       // "Mon, 3PM"
a.format("D/M/YYYY");                      // "12/3/2012" 
```

* * *

此外，值得一提的是 checkout [date.js](http://www.datejs.com/)。我认为这两个库是相辅相成的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-07T12:55:30.080

这对我来说很好：

```
<%
Date date = Calendar.getInstance().getTime();
%>

<script>
var d = new Date(<%=date.getTime()%>);
alert(d);
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-28T06:19:35.600

这个 JavaScript 库应该能够帮助你。

[http://plugins.jquery.com/project/fIsForFormat](http://plugins.jquery.com/project/fIsForFormat)

（我不知道他们为什么将它作为一个 jQuery 插件，因为它可以独立工作。）

您只需将原始格式化日期拆分为其各个元素，然后使用这些元素创建一个新的日期对象。然后，使用此库的“Date.f()”方法将其输出为您想要的任何格式。

例如：

```
var dateOld = "11/27/2010",
    dateArr = date1.split("/"),
    dateObj = new Date(dateArr[2], dateArr[0], dateArr[1]),
    dateNew = dateObj.f("MMM d, yyyy");

document.write("Old Format: " + dateOld + "<br/>New Format: " + dateNew); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-20T10:13:42.773

我建议您使用带有此[插件的](https://github.com/MadMG/moment-jdateformatparser)[MomentJS](https://momentjs.com/) ，它允许您将 Java 模式转换为 JS 模式（MomentJS）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-14T14:49:32.280

如果您只想格式化日期，我的日期扩展会做得很好 - 它还解析数据格式并进行大量日期数学/比较：

[DP_DateExtensions 库](http://www.depressedpress.com/Content/Development/JavaScript/Extensions/DP_DateExtensions/Index.cfm)

不确定它是否有帮助，但我发现它在几个项目中非常宝贵。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-17T15:26:09.503

如果您使用的是 java，请查看[Simple Date Format](https://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html)类。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T15:33:39.690

[此页面](http://www.mattkruse.com/javascript/date/index.html)中的 javascript 代码实现了一些日期函数，它们“使用与 java.text.SimpleDateFormat 类相同的格式字符串，但有一些小例外”。它与您想要的不太一样，但它可能是一个很好的起点。

# .net - 有没有办法在不加载实体的情况下通过 EntityKey 删除实体？

> ID：1007737
> 
> 赞同：4
> 
> 时间：2009-06-17T15:21:47.343
> 
> 标签：.net, entity-framework

有没有办法在不加载实体的情况下通过 EntityKey 删除实体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:27:44.413

这将对您有所帮助： [http ://sqlskills.com/BLOGS/BOBB/post/Entity-Framework-Beta3-Deleting-without-fetching.aspx](http://sqlskills.com/BLOGS/BOBB/post/Entity-Framework-Beta3-Deleting-without-fetching.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:54:11.560

Tamir 的链接有效，但它使用了实体框架团队不再推荐的方法。

查看[这个](http://blogs.msdn.com/alexj/archive/2009/03/27/tip-9-deleting-an-object-without-retrieving-it.aspx)更接近正确方法的提示。并且还更深入地介绍了这些问题。（免责声明：我会说我写了提示！）

希望这可以帮助

亚历克斯

项目经理实体框架团队。

# winforms - 奇怪的两个控件/相同的数据源问题

> ID：1007742
> 
> 赞同：2
> 
> 时间：2009-06-17T15:22:42.397
> 
> 标签：winforms, datasource

这是使用winforms。

我有一个列表框和一个组合框，它们都绑定到相同的数据源、相同的显示成员、相同的值成员。一切都很好，项目显示在两个控件中。

问题是当我在一个控件中更改选择时，它会移动到另一个控件中的相同索引。我没有与任何一个控件相关的任何事件。它只是在自己发生。有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-06-17T10:32:28.647

这是因为两个控件共享相同的`BindingContext/CurrencyManager`. 控件从其容器控件继承 BindingContext。一个 BindingContext 只为每个 DataSource 维护一个 CurrencyManager。如果您想拥有两个不同的 CurrencyManager，则需要拥有两个 BindingContext。

因此，一旦更改了控件选择，`currencyManagaer.Current`就会更新。这会影响共享相同数据源的所有控件。

实例化一个新的 BindingContext 并将其分配给 ComboBox 之一的 BindingContext 属性：

comboBox2.BindingContext = new BindingContext();

这应该可以解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:38:48.993

数据源是一个单独的对象。当其中一个控件更改数据源活动行时，它会向其他控件发送更新通知以进行相应移动。这是正常和预期的行为。

它背后的想法是简化导航记录集，同时保持所有绑定控件同步。

如果您不希望这样，请使用绑定到相同基础数据的两个数据源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:26:05.853

我认为这可能是一个功能。对于主/明细类型的表格。

# c# - 在 WPF 中，如何在 WindowsFormsHost 上画一条线？

> ID：1007743
> 
> 赞同：1
> 
> 时间：2009-06-17T15:22:44.113
> 
> 标签：c#, .net, wpf, drawing, windowsformshost

这是我的 XAML

```
<Grid
    Name="grid">
    <TextBlock
        Text="Some Label" />
    <WindowsFormsHost
        Name="winFormsHost">

    </WindowsFormsHost>
</Grid> 
```

在加载表单时，我执行以下方法

```
protected void OnLoad(object sender, RoutedEventArgs e)
{
    // Create a line on the fly
    Line line = new Line();

    line.Stroke = Brushes.Red;
    line.StrokeThickness = 17;

    line.X1 = 50;
    line.Y1 = 50;

    line.X2 = 250;
    line.Y2 = 50;

    this.grid.Children.Add(line);

    System.Windows.Forms.TextBox oldSchoolTextbox = new System.Windows.Forms.TextBox();
    oldSchoolTextbox.Text = "A bunch of Random Text will follow.  ";
    oldSchoolTextbox.WordWrap = true;
    oldSchoolTextbox.Width = 300;

    for (int i = 0; i < 250; i++)
    {
        oldSchoolTextbox.Text += "abc ";

        if (i % 10 == 0)
        {
            oldSchoolTextbox.Text += Environment.NewLine;
        }
    }

    this.winFormsHost.Child = oldSchoolTextbox;
} 
```

仅当我注释掉以下行时，该行才会绘制。

```
this.winFormsHost.Child = oldSchoolTextbox; 
```

如何在 WindowsFormsHost 控件上画一条线？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T15:38:03.927

微软称之为“空域”的东西可以防止这种情况发生，至少很容易。这是[描述 airspace 的 WPF 互操作页面](http://msdn.microsoft.com/en-us/library/aa970688.aspx)。[它有一个 DX 焦点，但同样的事情也适用于 WindowsFormsHost。]

WindowsFormsHost（当它有一个孩子时）创建一个单独的 HWND，它会阻止 WPF 呈现上下文显示在该矩形中。

解决此问题的最佳选择需要 .NET 3.5sp1（至少要可靠地工作）。您可以通过创建一个完全独立的、100% 透明的背景窗口并将其放置在您的 windows 窗体主机控件上来解决此问题。然后你画进去，它会正确显示。

这有点骇人听闻的感觉，但它确实有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T21:21:11.627

我遇到了同样的问题，在搜索完之后也最终使用了 WindowsFormsHost 顶部的透明“覆盖”窗口。为了使您的主窗口与覆盖窗口保持同步，您需要处理以下事件：

您的 MainWindow 的 LocationChanged 事件和您的 WindowsFormsHost 元素的 LayoutUpdated 事件。这两个事件处理程序都应调用将透明覆盖窗口移动到 WindowsFormsHost 窗口顶部的函数（下例中的 SyncOverlayPosition()）。

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
   this.LocationChanged += new EventHandler(MainWindow_LocationChanged);
   _windowsFormsHost.LayoutUpdated += new EventHandler(_windowsFormsHost_LayoutUpdated);
}

void MainWindow_LocationChanged(object sender, EventArgs e)
{
   SyncOverlayPosition();
}

void _windowsFormsHost_LayoutUpdated(object sender, EventArgs e)
{
   SyncOverlayPosition();
}

void SyncOverlayPosition()
{
   Point hostTopLeft = _windowsFormsHost.PointToScreen(new Point(0, 0));    

   _overlayWindow.Left = hostTopLeft.X;
   _overlayWindow.Top = hostTopLeft.Y;
   _overlayWindow.Width = _windowsFormsHost.ActualWidth;
   _overlayWindow.Height = _windowsFormsHost.ActualHeight;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T14:08:50.597

接受的答案确实有效。然而，唯一的问题是透明窗口将显示在我的主窗口上。我还必须进行运动以确保一切保持同步。

我做了一些与透明窗口略有不同的事情。这在我的情况下有效，但可能并不总是有效。

我创建了一个 Windows 窗体用户控件。我将文本框和线条图放在 Windows 窗体用户控件上。然后，这使我能够使用 WindowsFormsHost 绘制并显示在 WPF 应用程序中。

# c# - 在 c# .Net 2.0 中调用 Web 服务时发生超时错误

> ID：1007750
> 
> 赞同：0
> 
> 时间：2009-06-17T15:23:55.983
> 
> 标签：c#, web-services, .net-2.0, timeout

我继承了一些代码，但我对处理 Web 服务不是很熟悉。以下是项目的设置方式：

在“Web References”下有对我们正在使用的 Web 服务的引用。在该服务的 Reference.cs 文件中，有一个从 SoapHttpClientProtocol 继承的类，这个类有一个名为 CandidateAdd() 的函数，它调用 this.Invoke（我认为这会调用实际的 Web 方法）

然后两个类派生自 Reference.cs 文件中的一个（一个用于生产环境，一个用于开发），它们仅包含 GetWebRequest(Uri) 的覆盖，此处设置

```
webRequest.KeepAlive = false;
webRequest.MaximumAutomaticRedirections = 30;
System.Net.ServicePointManager.MaxServicePointIdleTime = 18000;
webRequest.AllowAutoRedirect = true;
//webRequest.Timeout = 18000; 
```

并返回 Web 请求对象。

应用程序的性质是这样的，这个 Web 方法每天可能只会被调用 50 次左右，所以它不像服务器变得非常陷入困境或任何事情，它似乎更像是某些设置不正确。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T01:22:41.980

请发布您看到的完整异常，包括所有 InnerException。例如：

```
try {
    using (CandidateService svc = new CandidateService()) {
        svc.CandidateAdd();
    }
}
catch (Exception ex) {
    string what_I_should_post = ex.ToString();
} 
```

您可能认为这很明显，但堆栈跟踪可能是一个很大的线索。

然后，您将想弄清楚在发生此超时时服务在做什么。它可能正在执行数据库操作以“添加”“候选人” - 该操作在服务器端是否成功？然后，您可能想尝试找出需要这么长时间的原因。

派生类的结构是我以前从未见过的，但这是一个合理的想法。这可能不是问题。我不会在调试期间弄乱该代码，但如果您对此有疑虑，请暂时将代码从一个类复制到另一个类。这样，它们都将具有相同的 WebRequest 参数。

# asp.net-mvc - LINQ to SQL 如何通过字段名获取值

> ID：1007755
> 
> 赞同：0
> 
> 时间：2009-06-17T15:24:31.847
> 
> 标签：asp.net-mvc, linq-to-sql

我在 ASP.NET MVC 应用程序中使用 Linq to SQL 作为数据访问层。所以查询结果是一个强类型对象。如何动态指定要在页面中显示的字段。

例如，查询结果有以下字段： FirstName LastName Address Tel

我的问题是如果一个用户想要显示姓氏和名字。第二个用户想显示地址和名字，第三个等......不同的用户有不同的要求。那么如何根据用户的特定要求（按需）查询数据库/过滤结果？

* * *

更具体地说，查询结果是一组人员信息。

```
public class Person
{
  public string FirstName {get;set;}
  public string LastName {get;set;}
  public string Tel {get;set;}
  public string Tel {get;set;}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:46:11.677

1) 用户在 UI 中指示用户希望看到的结果
2) 控制器解释并存储它以供以后使用
3) 控制器转到 DAL 并从 DAL 获取数据
4) 控制器然后以某种方式修改返回结果根据#2
5) 控制器然后将修改后的数据传递给 UI
6) UI 渲染数据

我认为您的断开连接从 4 开始，可能会扩展到 6。

事实是，实际上有成千上万种方法可以做到这一点。这是使用类似 C# 的伪代码的一种方法。

首先，我将创建一个视图模型，其中包含有关我想向用户显示的信息的信息。

原始 Linq to Sql（缩写）：

```
public class Person
{
  public string FirstName {get;set;}
  public string LastName {get;set;}
  public string Tel {get;set;}
} 
```

我的视图模型：

```
public partial class PeopleView
{
  public bool ShowFirstName {get;set;}
  public bool ShowLastName {get;set;}
  public bool ShowTel {get;set;}
  public IEnumerable<Person> People {get;set;}
} 
```

准备模型的控制器方法：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult PersonDetails(bool showFirstName, 
    bool showLastName, bool showTel)
{
  var viewData = new PeopleView()
    { 
      ShowFirstName = showFirstname, 
      ShowLastName = showLastName, 
      ShowTel = showTel, 
      People = Dal.GetPeople()
    };

  return View(viewData);
} 
```

这是视图：

```
<% foreach(var item in ViewData.Model.People){ %>
  <% if(ViewData.Model.ShowFirstName) {%>
    <%= item.FirstName %><br/>
  <% } %>
  <% if(ViewData.Model.ShowLastName) {%>
    <%= item.LasttName %><br/>
  <% } %>
  <% if(ViewData.Model.ShowTel) {%>
    <%= item.Tel %><br/>
  <% } %>
<% } %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T08:39:13.980

看看 System.Linq.Dynamic：

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:41:03.717

根据用户输入使用 if 语句。我假设您将用户的偏好存储在某处，在这种情况下，以下代码可以解决问题：

```
if (showAddress)
{
    var results = from u in Users
                  select new
                  {
                      FirstName = u.FirstName;
                      LastName = u.LastName;
                      Address= u.Address;
                  }
    // Code to display results goes here
}
else
{
    var results = from u in Users
                  select new
                  {
                      FirstName = u.FirstName;
                      LastName = u.LastName;
                  }
    // Code to display results goes here
} 
```

# user-interface - UI 设计 - 是否包含取消按钮？

> ID：1007765
> 
> 赞同：2
> 
> 时间：2009-06-17T15:26:47.100
> 
> 标签：user-interface

我们正在为新的业务线应用程序设计 UI。我们没有真正的限制，可以自由设计我们认为合适的 UI。UI 将在 WPF 中完成，面向 Windows 7、Vista 和 XP Pro 用户。

许多对话框的右下角包含确定和取消按钮。你觉得有这个取消按钮是必要的还是右上角的红色X就够了？我们正在讨论这个问题，因为我们注意到更多的 UI 没有取消按钮，只有红色的 X。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-17T15:30:29.713

您不仅应该添加它，而且还要确保 ESC 映射到它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T15:30:12.973

向客户展示两种设计 - 一种带有“取消”按钮，另一种没有。看看他们的想法是什么。

最好还是将它们呈现为部分工作的原型，并在他们使用对话框时观察它们。如果您要求他们执行一组任务，并查看他们在被要求取消操作时是否遇到问题。

话虽如此，由于其他人提到的原因，我更喜欢包含“取消”按钮：

*   可访问性（特别是 Esc 应该映射到它）。
*   约定（用户会期待它）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T15:29:09.123

包括取消按钮。红色的 X 很难标记。;)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T15:28:31.713

包括它。这在其他用户界面中很常见。让用户选择使用哪个；为他们制作可能会让他们对您的界面感到恼火。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T15:46:10.977

从用户界面的角度来看，不包括取消按钮可能会让一些用户觉得他们别无选择，当然不是这样。想象一下以下简单的决策场景：

> 警告：所选文件夹中的所有文件都将被删除。此操作无法撤消。你确定你想继续？

如果唯一的选择是 Ok，界面会有多愚蠢？此外，如上所述，在许多平台上，Escape 键映射到 Cancel。也可能值得设置一个默认按钮，以便按下 Enter/Space 键不会无意中执行无法撤消的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T15:36:39.263

包括它！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T15:28:48.717

用户习惯于使用标准的 GUI 布局——否则他们会感到困惑。他们也有不同的方式使用标准接口。有些人只使用*X*，有些人只使用*Cancel*。人们通常会忽略他们不使用的那个，但如果他们的那个不存在，就会感到困惑。所以要安全并把它们都放在里面——无论如何，它应该只是 Cancek 的单线功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T15:40:36.977

如果您有这种自由，请考虑从您的应用程序中完全消除对话框，尤其是那些具有典型“OK | CANCEL”范例的对话框。对话框会扰乱动作流程，通常只应用于绝对需要程序打断用户的事情。

您会注意到它们在 Web 环境中的破坏性有多大——例如，Stack Overflow 仅在需要能够覆盖您的操作时才使用它们，例如，当您离开未提交的答案时。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-17T15:30:07.513

+1 包括它。如果您现在不包含它，然后需要一些不同的功能来取消稍后关闭，您的用户将已经习惯于自动关闭。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T15:30:17.467

就像我们在键盘上有“ESC”按钮一样，我们需要在对话框中使用“取消”。

可用性问题:-)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-17T15:33:58.317

包括它。并且还**请**确保您确保按下 Escape 键与 Cancel 按钮执行相同的操作。

另外，请不要仅仅因为您是从头开始设计，就抛弃所有约定。查看 MSFT 的对话框用户[体验指南。](http://msdn.microsoft.com/en-us/library/aa511268.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-17T15:34:21.920

红色按钮实际上是“关闭”而不是“取消”。'Cancel' 取消正在运行的任务。请改用“关闭”按钮。是的，如果人们有理由点击它，请包括“关闭”。当您真的想快速关闭某些东西时，红色按钮很难点击。

# c# - 如何修复“ConnectionString 属性尚未初始化”

> ID：1007786
> 
> 赞同：48
> 
> 时间：2009-06-17T15:30:34.020
> 
> 标签：c#, asp.net, connection-string, database-connection

当我启动我的应用程序时，我得到： ***ConnectionString 属性尚未初始化。***

网络配置：

```
<connectionStrings>
    <add name="MyDB"
         connectionString="Data Source=localhost\sqlexpress;Initial Catalog=mydatabase;User Id=myuser;Password=mypassword;" />
</connectionStrings> 
```

堆栈是：

```
System.Data.SqlClient.SqlConnection.PermissionDemand() +4876643
System.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection) +20
System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +117
System.Data.SqlClient.SqlConnection.Open() +122 
```

我对.NET 还很陌生，但我没有得到这个。我在谷歌上找到了很多答案，但没有一个能真正解决我的问题。

这意味着什么？我的 web.config 不好吗？我的功能不好吗？我的 SQL 配置是否无法正常工作（我正在使用 sqlexpress）？

我的主要问题是我不确定从哪里开始调试这个......任何事情都会有所帮助。

编辑：

失败代码：

```
MySQLHelper.ExecuteNonQuery(
ConfigurationManager.AppSettings["ConnectionString"],
CommandType.Text,
sqlQuery,
sqlParams); 
```

sqlQuery 是一个类似于“从表中选择 *”的查询。sqlParams 在这里不相关。

这里的另一个问题是我的公司使用 MySQLHelper，我对它没有可见性（只有一个用于帮助程序库的 dll）。它在其他项目中一直运行良好，所以我 99% 的错误不是来自这里。

我想如果没有看到代码就无法调试它，我将不得不等待与创建此帮助程序的人取得联系以获取代码。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-17T15:48:43.687

应该这样引用连接字符串：

```
MySQLHelper.ExecuteNonQuery(
ConfigurationManager.ConnectionStrings["MyDB"].ConnectionString,
CommandType.Text,
sqlQuery,
sqlParams); 
```

`ConfigurationManager.AppSettings["ConnectionString"]`将在 中寻找`AppSettings`名为 的东西`ConnectionString`，但它不会找到。这就是您的错误消息指示 的`"ConnectionString" property has not been initialized`原因，因为它正在寻找`AppSettings`named的初始化属性`ConnectionString`。

`ConfigurationManager.ConnectionStrings["MyDB"].ConnectionString`指示查找名为“MyDB”的连接字符串。

[这是有人在谈论使用 web.config 连接字符串](http://weblogs.asp.net/owscott/archive/2005/08/26/Using-connection-strings-from-web.config-in-ASP.NET-v2.0.aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-17T15:36:22.040

当数据源尝试绑定数据但由于找不到连接字符串而无法绑定时，您会收到此错误。根据我的经验，这通常不是由于 web.config 中的错误（尽管我不是 100% 确定这一点）。

如果您正在以编程方式分配数据源（例如 SqlDataSource）或创建查询（即使用 SqlConnection/SqlCommand 组合），请确保为它分配了 ConnectionString。

```
var connection = new SqlConnection(ConfigurationManager.ConnectionStrings[nameOfString].ConnectionString); 
```

如果要将数据绑定元素连接到数据源（即 GridView 或 ComboBox 到 SqlDataSource），请确保将数据源分配给您的连接字符串之一。

发布您的代码（为了数据绑定元素和 web.config 是安全的），我们可以看看它。

**编辑：** 我认为问题在于您试图从 AppSettings 区域获取连接字符串，并且以编程方式不存在它。尝试将其替换为`ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString`（如果 ConnectionString 是您的连接字符串的名称。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:50:58.710

连接字符串**不在*****AppSettings***中。

您正在寻找的是：

```
System.Configuration.ConfigurationManager.ConnectionStrings["MyDB"]... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-12T00:05:18.570

在处理 web api Asp Net Core 项目时，我偶然发现了同样的问题。我按照建议将代码中的引用更改为：

```
ConfigurationManager.ConnectionStrings["NameOfTheConnectionString"].ConnectionString 
```

但添加对 System.Configuration.dll 的引用会导致错误“引用无效或不受支持”。

[![配置管理器错误](../Images/1f18d6da1a69e8e96fc58f6638f19be4.png)](https://i.stack.imgur.com/aUyFE.png)

要解决这个问题，我必须使用 NuGet 下载包 System.Configuration.ConfigurationManager（工具 -> Nuget 包 -> 管理 Nuget 包以获取解决方案）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-21T05:04:45.310

我发现当我创建时`Sqlconnection = new SqlConnection()`，我忘了传递我的`connectionString`变量。所以这就是为什么我改变了初始化我的方式`connectionString`（没有任何改变）。

如果你喜欢我，别忘了将你的字符串连接传递给`SqlConnection`参数。

`Sqlconnection = new SqlConnection("ConnString")`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-30T20:30:06.730

这对我有用：

```
var oSQLConn = new 
SqlConnection(
System.Configuration.ConfigurationManager.ConnectionStrings["Conn1"].ToString()
); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2011-02-24T07:05:01.413

使用 [] 代替 () 如下例所示。

```
SqlDataAdapter adapter = new SqlDataAdapter(sql, ConfigurationManager.ConnectionStrings["FADB_ConnectionString"].ConnectionString);
            DataTable data = new DataTable();
            DataSet ds = new DataSet(); 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2019-04-30T08:03:46.603

只需在页面后面的代码中使用：-

```
SqlConnection con = new SqlConnection("Data Source = DellPC; Initial Catalog = Account; user = sa; password = admin"); 
```

它应该工作得很好

# actionscript-3 - 将 SWF 加载到 ActionScript 3 项目中 (Flex Builder)

> ID：1007803
> 
> 赞同：0
> 
> 时间：2009-06-17T15:32:39.163
> 
> 标签：actionscript-3, flash

我们正在为我们的欧洲客户开发一个小型 Flash 游戏，他们要求我们以这样一种方式开发我们的 Flash 游戏，以便他们可以将我们的 SWF 游戏动态加载到他们的 ActionScript 3 项目中。

基本上，他们有一个控制台，可以加载我们自己的许多其他 Flash 游戏，具体取决于玩家在“选择您的游戏”屏幕上按下的按钮。

基本上，我们有一个在 Flash Professional CS4 中创作的 FLA 项目，一切基本上都是一个简单的 Flash 游戏。当我们通过 Ctrl+Enter 测试游戏或双击运行编译好的 SWF 文件时，一切正常，游戏运行完美，每个人都是快乐的兔子。

我们需要掌握的是将我们的 SWF 加载到我们的客户端 AS3 项目中，这基本上是在 Flex Builder 3 中创建的外部 ActionScript 3 项目。客户端向我们发布了以下代码来加载 SWF：

```
var myGame:FunkyChickenGame = new FunkyChickenGame();
addChild(myGame); 
```

...在客户端应用程序的 ActionScript 3 应用程序构造函数中执行，或者可能是“选择您的游戏”屏幕上按下的按钮的事件处理程序。

我们尝试在 Flex Builder 中创建一个空白的 AS3 项目，并尝试按照我上面的代码片段加载 SWF。我们在外部 SWF 文档类中的所有跟踪都按预期显示在 Flex Builder 控制台视图中，因此代码运行良好。

我们遇到的问题是，尽管调用了 addChild(myGame)...我们没有看到任何图形，只是封装 AS3 项目的默认背景颜色。

但是请注意，当我们在 Windows 中通过双击 Game.swf 文件来运行 SWF 时，一切都可以完美执行，游戏运行时没有任何缺陷和故障。

对此主题的任何帮助将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T03:46:14.077

您需要使用的是 Loader 类的实例，如下所示：

```
var loader:Loader = new Loader();

// you'll need to write a method named onLoaded to capture the COMPLETE event
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaded);

loader.load(new URLRequest("game.swf"));
addChild(loader); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-12T14:11:20.947

创建一个类的实例是尽可能多的工资。您的客户有一种有趣的方式来发布参考资料。

但是`FunkyChickenGame`，可能是由客户端创建的可以启动您的游戏的类。也许游戏嵌入在他们的 Flash 应用程序中，但这意味着加载时间很长。如果确实有很多游戏是以这种方式“加载”的。

我的建议是你不要使用 stage、root 或任何可以链接到主应用程序而不是你的游戏的属性，并让客户决定他想如何加载它。

# asp.net-mvc - System.Web.MVC 的位置，所以我可以用反射器反射它

> ID：1007807
> 
> 赞同：8
> 
> 时间：2009-06-17T15:33:29.193
> 
> 标签：asp.net-mvc

我安装了 MVC 1.0。System.Web.MVC dll 在哪里，以便我可以使用反射器查看辅助方法是如何编码的？我查看了我的 ASP.NET MVC Web 应用程序的 bin 文件夹，但它不存在。我不太确定 MVC 1.0 安装程序在哪里安装 dll，以及它如何连接到 MVC 应用程序的 web.config。是否在 GAC 中安装了 System.Web.MVC 或其他什么？如果是这样，我怎么能对大会进行反思？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T15:36:36.317

我的在 C:\Program Files\Microsoft ASP.NET\ASP.NET MVC 1.0\Assemblies\System.Web.Mvc.dll 中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T15:37:45.813

我的位于：C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET MVC 1.0\Assemblies

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:36:50.807

您可以在[http://aspnetwebstack.codeplex.com/](http://aspnetwebstack.codeplex.com/)在线查看实际的源代码。有时那里的版本滞后于发布，但它通常是最新的。当我使用 Reflector 时，我只是从`C:\Program Files\Microsoft ASP.NET\ASP.NET MVC 1.0\Assemblies`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T15:56:23.983

如果您希望反映项目引用的任何 DLL，只需右键单击项目资源管理器中引用下的 DLL，单击属性，它会告诉您确切的路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-05T13:44:44.730

看起来这对于 VS2015/Windows10 已经改变了。我的在：

```
C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\CommonExtensions\Microsoft\Web\Razor\v3.0\MVC5.1 
```

**或者**

```
C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Stack 5\Packages\Microsoft.AspNet.Mvc.5.2.3\lib\net45 
```

# c# - 如何在 LinqToSQL 查询中使用我的枚举？

> ID：1007811
> 
> 赞同：2
> 
> 时间：2009-06-17T15:33:47.490
> 
> 标签：c#, linq, linq-to-sql, enums

我的数据库表中有一个字段用于存储枚举值，例如：

```
create table MyTable (
  ...
  Status tinyint not null,
  ...
) 
```

在我的 C# 课程中，我有

```
public enum TStatus : byte {
  Pending = 1      
  Active = 2,
  Inactive = 3,
}

public TStatus MyStatus {
  get { return (TStatus)Status; }
  set { Status = (byte)value; }
} 
```

现在我想编写一个使用例如`MyStatus`属性的Linq 查询`MyTable`

```
var q = MyDataContext.GetTable<MyTable>().Where(t => t.MyStatus == TStatus.Active); 
```

但当然，Linq 不知道如何解释`MyStatus`为 SQL。我需要做什么`MyStatus`才能让它在 LinqToSQL 中工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T15:40:24.543

看看这个链接：

[http://dotnet.org.za/hiltong/archive/2008/08/06/using-enums-with-linq-to-sql.aspx](http://dotnet.org.za/hiltong/archive/2008/08/06/using-enums-with-linq-to-sql.aspx)

随着链接的消亡——至少对我而言，这个链接确实消亡了——这是重要的部分：

> [When adding the column to the entity] by default, the Type will come up as an "int (System.Int32)", but you can change it to the fully-qualified type of the enum (in my case, ConsoleApplication1.CustomerType). BUT, in order to locate it fully, you have to add the global identifier, as follows: global::ConsoleApplication1.CustomerType , so type that as is (but the equivalent for your namespace) into the textbox

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:46:06.513

Don't have a compiler handy, but I think if you cast your enum to an int, it will work. So try:

var q = MyDataContext.GetTable().Where(t => t.MyStatus == (int)TStatus.Active);

# c# - 一段时间后执行应用程序

> ID：1007814
> 
> 赞同：1
> 
> 时间：2009-06-17T15:33:49.190
> 
> 标签：c#, .net, batch-file

我正在编写一个需要每周执行一次的小应用程序。我可以把它写成一个持续运行的服务，但每周只执行一次我需要它的任务，但这似乎有点矫枉过正。

是否有另一种方法可以每 x 时间段执行一次应用程序？我正在寻找不涉及用户交互的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T15:35:52.090

您始终可以使用[Windows 计划任务](http://support.microsoft.com/kb/308569)。它们可能很丑陋，但很有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:35:32.730

您可以使用[Windows 任务计划程序](http://support.microsoft.com/kb/308569)。它的设计考虑了这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T15:35:33.947

您可以使用 Windows Scheduler 来计划每周执行一次应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T15:35:55.803

在 windows 下，您可以使用[at 实用程序](http://en.wikipedia.org/wiki/At_(Windows))。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T15:35:51.467

您可以使用控制面板中的 Windows 任务计划程序。只需设置一个任务以在指定日期运行您的应用程序。如果需要，您甚至可以告诉它以特定用户身份运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-20T18:05:12.043

如果您需要完全控制流程（结果值、要提供的参数等），我建议您创建自己的任务调度程序，您可以在其中使用 cron 算法来安排您想要执行任务的时间。我知道创建一个每周运行一次的服务可能听起来有点矫枉过正，但是如果您制作一个通用调度程序，您将能够将您的调度重用于其他目的。

我在过去创建了这个调度器，它已经在生产中使用了多年。我在 .Net 中实现了 cron 算法，基于一位开发人员 (Artif Aziz) 编写的开源算法。查看我的博客了解更多信息：

[CronTab 调度解析器算法](http://blog.robertolopes.com/2010/11/17/crontab-schedule-parser-algorithm/)

如果您考虑更高级别（企业级别），您可以考虑购买 Control-M，这是我用过的最强大的调度程序工具之一，但是它非常昂贵。

干杯!

罗伯托。

# java - 如何在行中设置 SWT 列表的高度？

> ID：1007819
> 
> 赞同：4
> 
> 时间：2009-06-17T15:34:25.057
> 
> 标签：java, swt

我有一个基于`Composite`嵌入 SWT`List`实例的类。使用默认设置，列表在我的 WinXP 系统上高五行。在不依赖硬编码像素值或 DPI 设置等的情况下，如何将列表（和周围的合成）的高度设置为固定的行数，比如 3，而不添加任何内边距？

```
public FileSetBox(Composite parent, int style)
{
    super(parent, style);

    setLayout(new FillLayout());

    this.list = new List(this, SWT.V_SCROLL);

    ...
} 
```

**更新：**

以下工作，但它没有考虑边框添加的高度，这导致最后一行的部分被覆盖。任何想法如何计算这个，太？

```
public FileSetBox(Composite parent, int style)
{
    ...
    GC gc = new GC(this);
    gc.setFont(this.list.getFont());
    this.preferredHeight = gc.getFontMetrics().getHeight() * 3;
    gc.dispose();
    ...
}

@Override
public Point computeSize(int arg0, int arg1)
{
    Point size = super.computeSize(arg0, arg1);
    return new Point(size.x, this.preferredHeight);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T19:57:14.693

你不能使用 list.getBorderWidth() 和 list.getItemHeight() 来获取高度吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-16T22:13:41.983

```
public FileSetBox（复合父，int 样式）
{
    超级（父母，风格）；

    setLayout(new GridLayout(1, false));

    this.list = new List(this, SWT.V_SCROLL);

    GridData 数据 = 新 GridData(GridData.FILL_BOTH);
    data.heightHint = 10 * ((列表)控件).getItemHeight(); // 10行的高度
    data.widthHint = getStringWidth(25, 列表); // 宽度足以显示 25 个字符
    list.setLayoutData(数据);

    ...
}

    public static int getStringWidth(int nChars, Control control){
        GC gc = 新的 GC（控制）；
        gc.setFont(control.getFont());
        FontMetrics fontMetrics = gc.getFontMetrics();
        gc.dispose();
        返回 nChars * fontMetrics.getAverageCharWidth();
    }

```

# web-services - 代理 IIS

> ID：1007820
> 
> 赞同：1
> 
> 时间：2009-06-17T15:34:25.400
> 
> 标签：web-services, iis, proxy

我在尝试使用 .NET Web 服务时遇到 XSS 错误，我确信我可以通过一些代理来修复它。但是，我以前从未代理过 IIS。谁能指出我正确的方向以获得好的指南/教程？

## 更新

首先我很抱歉这么含糊！

我有一个网站正在调用 Web 服务以填充 AJAX 下拉列表。当我调用下面的代码时，我没有收到这样的异常，我收到一个弹出窗口，显示消息“此页面正在访问不受其控制的信息。这会带来安全风险......”。

**在 .apsx 文件中**

```
<asp:DropDownList ID="DocCategoryDropDown" 
                  runat="server" 
                  OnSelectedIndexChanged="DocCategoryDropDown_SelectedIndexChanged"
                  AutoPostBack="true">
</asp:DropDownList>
<ajaxToolkit:CascadingDropDown ID="DocCategoryCascadingDropDown" 
                               runat="server" 
                               TargetControlID="DocCategoryDropDown"
                               LoadingText="[Loading...]" 
                               Category="CategoryId" 
                               UseContextKey="True" 
                               ContextKey="NY"
                               PromptText="Select a Category" 
                               ServiceMethod="GetDocCategory" 
                               ServicePath="tba">
</ajaxToolkit:CascadingDropDown> 
```

**在 C# 文件中**

```
DocCategoryCascadingDropDown.ServicePath = path; 
```

如果**路径**与网站在同一台服务器上，它可以正常工作，但如果路径不是，我们会收到警告。如何阻止此消息弹出？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T09:31:02.363

在引起了很多混乱并且这篇文章一无所获之后，我决定犯下重新发布的主要罪行......我很抱歉，但据我所知，这是蚀刻这个主题的唯一方法。

无论如何，这似乎也没有得到任何回应，但经过漫长而艰辛的道路，我最终设法提出了正确的问题并认为我有一个解决方案。

请参阅[此处](https://stackoverflow.com/questions/1031414/how-to-prevent-cross-domain-issues-by-proxying-in-iis/1037313#1037313)了解我到目前为止的答案。

# mysql - Delphi - 将 DateTime Null 保存到 DB (ADO / MySQL)

> ID：1007824
> 
> 赞同：2
> 
> 时间：2009-06-17T15:35:29.220
> 
> 标签：mysql, delphi, date, odbc, ado

我有一个 Delphi 表单，上面有一些数据库控件。

为了表示日期，我使用`TJvDBDatePickerEdit`（来自 JCL），它有一个不错的属性

```
ShowCheckBox := True; 
```

允许用户输入未知日期（DBNull）。

我验证，将 DatePicker 归零按预期工作：

```
procedure Tframe.adoQueryBeforePost(DataSet: TDataSet);
begin
  if (qryAuftraege.FieldByName('MyDateField').IsNull) then
  begin
    ShowMessage('IsNull!');
  end;
end; 
```

消息框显示。所以 ADO 组件应该写入的字段是 varNull 类型的。

现在有这个管道：

```
TADOQuery -> TADOConnection -> MS OLE DB Provider for ODBC Drivers -> MySQL ODBC 5.1 Driver 
```

MySQL ODBC 驱动程序现在显示在它的日志中：

```
UPDATE `db`.`table` SET `MyDateField`=_latin1'0004-00-00' WHERE `ID`=5 AND `MyDateField`=_latin1'2009-06-17'; 
```

好吧，日期存储为`'0004-00-00'`（MySQL 似乎是这样保存的）。现在查询条目时，Delphi 将其识别为 Null，但下次更新时，调用：

```
UPDATE `bvl`.`auftraege` SET `MyDateField`=_latin1'2009-06-17' WHERE `ID`=5 AND `MyDateField` IS NULL; 
```

当然失败了，因为 MyDateField 不是 NULL（至少在 MySQL 数据库中）。

这个字符串`'0004-00-00'`是从哪里来的？如果它是某个地方的错误，我可以在哪里拦截它？

我已经知道有一些组件可以提供直接的 MySQL 连接，（我假设）不会显示这种行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T16:46:36.370

要将空日期/时间保存到数据库记录，只需调用

```
qryAuftraege.FieldByName('MyDateField').clear; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T21:06:22.777

请务必检查[此处](http://dev.mysql.com/doc/refman/5.0/en/using-date.html)讨论的 MySQL 选项...

然后，我会尝试使用一组不同的连接组件，因为堆栈（ADO + ODBC 5.1 驱动程序）可能是这里的问题。
您是否尝试过使用其他 ODBC 驱动程序？或者使用 DBX...

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-17T17:51:30.703

我不知道这样做的含义，但我一直使用

```
qryAuftraege.FieldByName('MyDateField').AsString:=''; 
```

# ruby-on-rails - 使用带有 Rails 的 IDE 会妨碍我吗？

> ID：1007825
> 
> 赞同：5
> 
> 时间：2009-06-17T15:35:31.403
> 
> 标签：ruby-on-rails, ide

我是 Ruby on Rails 的新手，到目前为止，我在学习它时玩得很开心。来自 .NET 世界，这是一个相当大的转变，因为我的 IDE (Visual Studio 2008) 可以为我处理一切，而在 Rails 中，一切都是通过多个应用程序（终端、TextMate 等）完成的。

我已经开始仔细研究[RubyMine](http://www.jetbrains.com/ruby/)作为 Rails 开发的 IDE，作为 IDEA 和 ReSharper 的忠实粉丝，我自然喜欢 RubyMine。它具有代码完成功能、对 RSpec 的内置支持、SVN 集成等。但是，由于 IDE 处理了如此多的“Rails 体验”，我想知道是否应该坚持使用 TextMate+Terminal 方法。

像 RubyMine 这样的 Ruby/Rails IDE 会阻碍我吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T16:34:57.187

免责声明：我只在很短的时间内使用了 ruby​​。但我确实相信我作为 .NET 开发人员学习其他语言的经验对您很有价值。

我将不同意这里的大多数人，并说使用 IDE。IDE 可以让您的生活更轻松，而不是更难。我知道来自 .NET 背景的自动补全是我学习语言的方式。我不阅读文档。我看到了我的 IDE 的建议，也看到了它的作用。

我真的不会太担心不知道后台发生的事情的全部细节，你会在需要的时候弄清楚。与此同时，你将有足够的能力继续学习这门语言的来龙去脉。你需要你能得到的所有帮助，如果你以前写过 .NET，那么 IDE 将是一个巨大的帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:52:18.617

我会从基础开始（终端和一个简单的文本编辑器），直到您真正了解 Ruby on Rails。然后，一旦您掌握了框架的基本基础知识，就转移到 IDE。

在我看来，如果您想学习使用终端和编辑器，但如果您想提高工作效率，请使用 IDE。

在家里，我使用基本设置，因为我正在学习 Ruby on Rails。然而，在工作中，我是一名 Java 开发人员，我使用 IDE。使用 IDE 让我不必担心繁琐的小任务，而只需担心编程。拥有自动完成、集​​成 svn 和集成调试工具等工具可以提高我的工作效率。

**[编辑]**另外，我认为特定的 IDE 并不重要。它们都具有相似的功能。你最舒服的就是最好的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:39:49.757

试试[Netbeans Ruby 版](http://www.netbeans.org/downloads/index.html)。它不如 RubyMine 好，但它具有内置的 svn 支持和与 TextMate 类似的模板。我喜欢它，但话又说回来，我还没有发布我正在开发的项目，所以我不能多谈生产力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T15:40:01.160

请记住，开源世界是关于**选择**的，所以有大量的 IDE。一个流行的是**Eclipse**，它*应该*将 Rails 开发作为一个插件包含在内（并且它们非常易于安装）。**Netbeans**还支持 Rails IIRC。

也许是时候开始使用基本的组件工具，然后找到一个 IDE。当我开始学习一门新语言时，我总是发现它有助于理解原始工具链以及在自动化之前事情是如何工作的。

就个人而言，除非是 Java 开发（本身很复杂），否则我会远离传统的 IDES，并使用 Vim/Gedit/Makefiles 和其他自动化的模块化解决方案。

**Linux/Gnome 上的GEdit**是一个很好的折衷方案。你有一个基本的文本编辑器，带有语法突出显示和一个嵌入的终端。然后，如果需要，您可以添加用于自动完成和类浏览的插件。

**祝你好运**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T16:03:39.753

我将采取与这里的其他人不同的立场。我认为对于大多数问题，您将花费大量时间在不使用 IDE 的情况下试图学习基础知识。它们使您的生活更轻松，并且在大多数情况下实际上会*教*您有关您正在使用的软件平台的信息。代码建议、自动格式化、集成帮助等可帮助您比记事本更快地发现语言的功能。

了解工具链绝对很重要，但我更喜欢在从 IDE 中学习时检查它。了解 IDE 如何以及为何选择以它的方式做某事。在许多情况下，IDE 将使用您可以从中学到很多的最佳实践和/或最流行的实践。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T16:07:13.623

当我在 Ubuntu 上学习时，我使用了 gedit。我尝试使用不同的附加组件使其像 TextMate 一样。

我喜欢在学习时使用终端，因为它可以帮助您了解构建过程的所有方面。使用像 RubyMine 或 Eclipse 这样的重型 IDE 可能会隐藏所有这些，因此会限制您对“幕后”发生的事情的理解。通常，当您开始开发更复杂的应用程序时，这种知识的缺乏会带来问题。

在我看来，SVN 支持在 IDE 中是不必要的。只需打开终端来管理您的存储库，或者使用一些 GUI 工具（如[Tortoise](http://tortoisesvn.net/) ）就很容易了。

我认为使用像 RubyMine 这样的 IDE 的唯一真正好处是自动/代码完成功能。我也是 ReSharper 的忠实粉丝（将它用于 C# 开发），我很想在学习 Rails 时拥有一些类似的工具——但 TextMate 不支持自动/代码完成吗？

我会说至少几个月，甚至一年，如果有的话，不要跳入使用 RubyMine。从长远来看，您必须做的额外工作将得到回报。坚持使用 TextMate。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T16:09:42.017

我也在使用 RubyMine；它是一个出色的 IDE（当然，它是一个 JetBrains 工具），但作为一个相当新的 Rails 人，我发现它对我来说有点太多了。它往往掩盖幕后真正发生的事情。然而，对于已经习惯于能够在调试器中单步执行代码并检查变量的人来说，RubyMine 非常有帮助，并且实际上增加了我对代码的理解（当然 Netbeans 和其他人也可以这样做；我真的就像 RubyMine 如何“处理”一样）。

所以总的来说，我说的是大多数人所说的：IDE 使用的某些方面使事情变得更加清晰；只需确保 IDE 不会成为拐杖。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T16:26:22.340

每当我尝试学习/采用一种语言/框架时，我都会尝试使用准系统编辑器来做事......语法突出显示......然后当我学习时，我喜欢添加诸如动态语法检查器之类的东西（netbeans 在那）。然后随着我的进步和学习语言/框架的魔力，我开始添加片段/代码完成之类的东西。在某些时候，您可能会看到一个更适合您的工具，但没有动态语法检查之类的功能……但在那个阶段，由于您的进步，它不再重要。

就我个人而言，我将 netbeans 与 jVi 插件一起使用……语法高亮、语法检查、调试和一切都是开箱即用的……（尽管 jVi 插件需要一些定制）。

但是，我偶尔会在 rails.vim 中使用 textmate 或 vim

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-08T08:03:18.990

如果您来自 .net/VS 背景，我建议您使用 IDE。我是 ac# 开发人员，在空闲时间使用 ruby​​ 和 rails（所以我不是“专业的 ruby​​ 人），正如上面的 Jack Ryan 所说，我们.net 开发人员习惯于某种学习方式。当您有一个 IDE 并排显示自动完成选项和相关文档时，学习内容会更容易。这样你会学得很快。

但是对于运行生成器、rake 任务、测试......等，您可以在开始时使用控制台（嘿，您可以同时使用控制台和 IDE 对吗？:)）。这将使您了解“幕后”发生的事情。稍后您可以使用 IDE 的“运行器”或其他任何东西通过 GUI 运行相同的东西。

# java - AspectJ - 使用预编译的方面编译 Java 源代码

> ID：1007841
> 
> 赞同：1
> 
> 时间：2009-06-17T15:37:18.233
> 
> 标签：java, aspectj

假设我有几个方面，我已经编译了，现在我只想编译单个源文件，但不重新编译方面，因为这需要很多时间。有什么办法吗？

例如，我有以下内容：

*   跟踪.aj
*   日志.aj
*   测试.java

所有这些都是在我的“全部构建”期间编译的，现在我已经更改`Test.java`并希望使用（已经编译的）方面重新编译它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T22:31:25.443

使用加载时编织。

[http://www.aspectprogrammer.org/blogs/adrian/2004/05/loadtime_weavin.html](http://www.aspectprogrammer.org/blogs/adrian/2004/05/loadtime_weavin.html)

以下是在 Eclipse 中的操作方法：http: [//www.eclipse.org/aspectj/doc/released/devguide/ltw-configuration.html#enabling-load-time-weaving](http://www.eclipse.org/aspectj/doc/released/devguide/ltw-configuration.html#enabling-load-time-weaving)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-27T16:10:14.960

在这种情况下，我不确定加载时间编织是正确的方法。当您想要修改已编译的类的行为时，通常会使用加载时编织。在这种情况下，您正在编译测试类型。如果方面相对稳定，您可以将它们分离到另一个项目中并将其构建到一个 jar 中（例如 trace.jar），然后您可以修改 AJDT 配置以将 jar 添加到方面库（从内存中，如果是，请道歉不准确，转到项目属性，选择aspectj编译器选项，选择aspect library/path选项卡并添加你的aspect jar）。这样做意味着 jar 中的方面将在每次构建时应用于 Test.java。

# regex - 不区分大小写的正则表达式

> ID：1007846
> 
> 赞同：8
> 
> 时间：2009-06-17T15:37:32.023
> 
> 标签：regex, haskell, case-insensitive

在 Haskell 中使用带有选项（标志）的正则表达式的最佳方法是什么

我用

```
Text.Regex.PCRE 
```

文档列出了一些有趣的选项，例如 compCaseless、compUTF8、... 但我不知道如何将它们与 (=~) 一起使用

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-17T16:59:01.793

所有`Text.Regex.*`模块都大量使用类型类，这些类型类用于可扩展性和类似“重载”的行为，但仅从类型来看，使用就不那么明显了。

现在，您可能已经从基本`=~`匹配器开始了。

```
(=~) ::
  ( RegexMaker Regex CompOption ExecOption source
  , RegexContext Regex source1 target )
  => source1 -> source -> target
(=~~) ::
  ( RegexMaker Regex CompOption ExecOption source
  , RegexContext Regex source1 target, Monad m )
  => source1 -> source -> m target 
```

要使用`=~`，必须存在`RegexMaker ...`LHS 的实例，以及`RegexContext ...`RHS 和结果的实例。

```
class RegexOptions regex compOpt execOpt | ...
      | regex -> compOpt execOpt
      , compOpt -> regex execOpt
      , execOpt -> regex compOpt
class RegexOptions regex compOpt execOpt
      => RegexMaker regex compOpt execOpt source
         | regex -> compOpt execOpt
         , compOpt -> regex execOpt
         , execOpt -> regex compOpt
  where
    makeRegex :: source -> regex
    makeRegexOpts :: compOpt -> execOpt -> source -> regex 
```

所有这些类的有效实例（例如 、`regex=Regex`、`compOpt=CompOption`和`execOpt=ExecOption`）`source=String`意味着可以使用某种形式的选项`regex`来编译 a 。（另外，给定某种类型，只有一组与之配套。不过，很多不同的类型都可以。）`compOpt,execOpt``source``regex``compOpt,execOpt``source`

```
class Extract source
class Extract source
      => RegexLike regex source
class RegexLike regex source
      => RegexContext regex source target
  where
    match :: regex -> source -> target
    matchM :: Monad m => regex -> source -> m target 
```

所有这些类的有效实例（例如 , , `regex=Regex`）意味着可以匹配 a和 a以产生 a 。（给定这些特定的其他有效 s是, , ,等）`source=String``target=Bool``source``regex``target``target``regex``source``Int``MatchResult String``MatchArray`

把这些放在一起，很明显`=~`and`=~~`只是方便的功能

```
source1 =~ source
  = match (makeRegex source) source1
source1 =~~ source
  = matchM (makeRegex source) source1 
```

还有那个`=~`并且`=~~`没有空间将各种选项传递给`makeRegexOpts`.

你可以自己做

```
(=~+) ::
   ( RegexMaker regex compOpt execOpt source
   , RegexContext regex source1 target )
   => source1 -> (source, compOpt, execOpt) -> target
source1 =~+ (source, compOpt, execOpt)
  = match (makeRegexOpts compOpt execOpt source) source1
(=~~+) ::
   ( RegexMaker regex compOpt execOpt source
   , RegexContext regex source1 target, Monad m )
   => source1 -> (source, compOpt, execOpt) -> m target
source1 =~~+ (source, compOpt, execOpt)
  = matchM (makeRegexOpts compOpt execOpt source) source1 
```

可以像这样使用

```
"string" =~+ ("regex", CompCaseless + compUTF8, execBlank) :: Bool 
```

或用可以接受选项的方法覆盖`=~`和`=~~`

```
import Text.Regex.PCRE hiding ((=~), (=~~))

class RegexSourceLike regex source
  where
    makeRegexWith source :: source -> regex
instance RegexMaker regex compOpt execOpt source
         => RegexSourceLike regex source
  where
    makeRegexWith = makeRegex
instance RegexMaker regex compOpt execOpt source
         => RegexSourceLike regex (source, compOpt, execOpt)
  where
    makeRegexWith (source, compOpt, execOpt)
      = makeRegexOpts compOpt execOpt source

source1 =~ source
  = match (makeRegexWith source) source1
source1 =~~ source
  = matchM (makeRegexWith source) source1 
```

或者您可以在需要的地方直接使用`match`,`makeRegexOpts`等。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-18T13:59:01.567

我对 Haskell 一无所知，但如果您使用的是基于 PCRE 的正则表达式库，那么您可以在正则表达式中使用模式修饰符。要以不区分大小写的方式匹配“无大小写”，您可以在 PCRE 中使用此正则表达式：

```
(?i)caseless 
```

模式修饰符 (?i) 覆盖在正则表达式之外设置的任何区分大小写或不区分大小写选项。它也适用于不允许您设置任何选项的运算符。

类似地，(?s) 打开“单行模式”，使点匹配换行符，(?m) 打开“多行模式”，使 ^ 和 $ 在换行符处匹配，并且 (?x) 打开自由-spacing 模式（字符类之外的未转义空格和换行符无关紧要）。你可以组合字母。(?ismx) 打开一切。连字符关闭选项。(?-i) 使正则表达式区分大小写。(?xi) 开始一个自由间距区分大小写的正则表达式。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-17T16:14:15.837

如果您希望`compOpt`使用`defaultCompOpt`.

像这样的工作：

```
match (makeRegexOpts compCaseless defaultExecOpt  "(Foo)" :: Regex) "foo" :: Bool 
```

以下两篇文章应该对您有所帮助：

[Real World Haskell，第 8 章。高效的文件处理、正则表达式和文件名匹配](http://book.realworldhaskell.org/read/efficient-file-processing-regular-expressions-and-file-name-matching.html)

[Haskell 正则表达式教程](http://www.serpentine.com/blog/2007/02/27/a-haskell-regular-expression-tutorial/)

# iphone - xcode 找不到标准的 C++ 包含文件

> ID：1007850
> 
> 赞同：5
> 
> 时间：2009-06-17T15:38:03.350
> 
> 标签：iphone, xcode, project

当我混合 .m 和 .cpp 时，我遇到了 xcode 找不到默认 cpp 包含的问题（例如`<map>`）

更新：我在我的 iphone 项目中添加一个静态库（它确实编译没有任何问题），然后在 .m 中使用包含，然后来自 c++ 的依赖项 .h 变得疯狂..找不到或不能编译，我尝试了.mm，但它不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T15:51:26.260

如果您使用的是Objective-C++（即在一个源文件中混合Objective-C 和C++，或者将C++ 头文件导入Objective-C 文件），那么您应该`.mm`在源代码文件中使用扩展名。默认情况下，Xcode 将`.mm`使用 Objective-C++ 编译器编译文件。`.m`文件是使用标准 C 编译器编译的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:19:55.760

诊断此问题的最佳方法是将“编译 foo.mm”行从“构建结果”窗口拖到对此消息的回复中。这向我们展示了你的项目告诉编译器的内容，非常详细，并且会准确地显示出什么是错误的。

# python - 弹出和蟒蛇

> ID：1007855
> 
> 赞同：9
> 
> 时间：2009-06-17T15:38:25.750
> 
> 标签：python, popen

处理一些代码，从命令提示符运行它时出现错误...

```
NameError: name 'Popen' is not defined 
```

但我已经导入了`import os`和`import sys`。

这是代码的一部分

```
exepath = os.path.join(EXE File location is here)
exepath = '"' + os.path.normpath(exepath) + '"'
cmd = [exepath, '-el', str(el), '-n', str(z)]

print 'The python program is running this command:'
print cmd

process = Popen(cmd, stderr=STDOUT, stdout=PIPE)
outputstring = process.communicate()[0] 
```

我错过了一些基本的东西吗？我不会怀疑的。谢谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-17T15:43:15.927

你应该做：

```
import subprocess
subprocess.Popen(cmd, stderr=subprocess.STDOUT, stdout=subprocess.PIPE)
# etc. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T15:41:15.387

Popen 在 subprocess 模块中定义

```
import subprocess
...
subprocess.Popen(...) 
```

或者：

```
from subprocess import Popen
Popen(...) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T15:43:08.970

当你导入一个模块时，模块的成员不会成为全局命名空间的一部分：你仍然需要在它们前面加上`modulename.`. 所以，你不得不说

```
import os
process = os.popen(command, mode, bufsize) 
```

或者，您可以使用`from module import names`语法将内容导入全局命名空间：

```
from os import popen    # Or, from os import * to import everything
process = popen(command, mode, bufsize) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T15:42:13.637

如果您的导入如下所示：

```
import os 
```

然后你需要像这样引用 os 中包含的东西：

```
os.popen() 
```

如果您不想这样做，可以将导入更改为如下所示：

```
from os import * 
```

不建议这样做，因为它可能导致命名空间模糊（代码中的内容与其他地方导入的内容冲突。）您也可以这样做：

```
from os import popen 
```

哪个比 from os import * 更明确、更容易阅读

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T15:43:12.993

这看起来像来自子进程模块的 Popen (python >= 2.4)

```
from subprocess import Popen 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-06-17T15:40:26.073

如果您只是导入 os.popen()，则应该使用 os.popen()。

# jquery - jQuery 选择器

> ID：1007860
> 
> 赞同：5
> 
> 时间：2009-06-17T15:38:57.217
> 
> 标签：jquery, css-selectors

我试图从视图源中获取这个，即：

```
<a  href="javascript:validateCB();"><img src="wwv_flow_file_mgr.get_file?p_security_group_id=1343380920146312332&p_flow_id=222&p_fname=submit_btn.gif" alt="Submit Details" border="0"  /> 
```

成 jQuery 选择器格式

```
var $templateButtons = $('img[src^="wwv_flow_file_mgr"]').parent('a'); 
```

但这似乎并不正确。

如何将上述视图源代码翻译成 jQuery？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T16:04:13.327

问题在于属性选择器：`$('img[src^="wwv_flow_file_mgr"]')`

您在 jQuery v1.3.2 中遇到了一个[已知错误](http://dev.jquery.com/ticket/4244)- jQuery 正在尝试使用其绝对 URL 解释图像路径，这意味着它所比较的​​ URL 实际上以“ `http://...`”开头

您可以暂时解决这个问题`*=`（它会查找包含文本“wwv_flow_file_mgr”的属性值，而不是从它开始）：

```
var $templateButtons = $('img[src*="wwv_flow_file_mgr"]').parent('a'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:42:41.670

这很奇怪，它不适用于您拥有的选择器，尽管我认为它应该。

然而，虽然不是很干净，但它确实可以使用如下所示的过滤器。

```
var $templateButtons = $("img")
                       .filter(function(){
                             return $(this).attr('src')
                                    .indexOf('wwv_flow_file_mgr')==0;
                       }).parent('a'); 
```

# java - 如何获取已加载的 JNI 库列表？

> ID：1007861
> 
> 赞同：23
> 
> 时间：2009-06-17T15:39:06.700
> 
> 标签：java, java-native-interface

正如主题所说，Java中有没有办法获取在任何给定时间加载的所有JNI本机库的列表？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-17T17:58:24.203

There is a way to determine all currently loaded native libraries if you meant that. Already unloaded libraries can't be determined.

Based on the work of Svetlin Nakov ([Extract classes loaded in JVM to single JAR](http://www.nakov.com/blog/2008/08/27/extract-all-classes-loaded-in-the-jvm-into-a-single-jar/)) I did a POC which gives you the names of the loaded native libraries from the application classloader and the classloader of the current class.

First the simplified version with no bu....it exception handling, nice error messages, javadoc, ....

Get the private field in which the class loader stores the already loaded libraries via reflection

```
public class ClassScope {
    private static final java.lang.reflect.Field LIBRARIES;
    static {
        LIBRARIES = ClassLoader.class.getDeclaredField("loadedLibraryNames");
        LIBRARIES.setAccessible(true);
    }
    public static String[] getLoadedLibraries(final ClassLoader loader) {
        final Vector<String> libraries = (Vector<String>) LIBRARIES.get(loader);
        return libraries.toArray(new String[] {});
    }
} 
```

Call the above like this

```
final String[] libraries = ClassScope.getLoadedClasses(ClassLoader.getSystemClassLoader()); //MyClassName.class.getClassLoader() 
```

And voilá *`libraries`* holds the names of the loaded native libraries.

Get the full source code from [here](http://www.file-upload.net/download-1709456/ListLoadedNativeLibraries.zip.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-11-03T16:25:28.400

我建立在[jitter 的解决方案](https://stackoverflow.com/questions/1007861/how-do-i-get-a-list-of-jni-libraries-which-are-loaded/1008631#1008631)之上。这使您可以找出谁（ClassLoader，Class）加载了每个本机库。

```
import java.lang.reflect.Field;
import java.util.*;
import java.util.Map.Entry;

/**
 * Helper functions for native libraries.
 * <p/>
 * @author Gili Tzabari
 */
public class NativeLibraries
{
    private final Field loadedLibraryNames;
    private final Field systemNativeLibraries;
    private final Field nativeLibraries;
    private final Field nativeLibraryFromClass;
    private final Field nativeLibraryName;

    /**
     * Creates a new NativeLibraries.
     * <p/>
     * @throws NoSuchFieldException if one of ClassLoader's fields cannot be found
     */
    public NativeLibraries() throws NoSuchFieldException
    {
        this.loadedLibraryNames = ClassLoader.class.getDeclaredField("loadedLibraryNames");
        loadedLibraryNames.setAccessible(true);

        this.systemNativeLibraries = ClassLoader.class.getDeclaredField("systemNativeLibraries");
        systemNativeLibraries.setAccessible(true);

        this.nativeLibraries = ClassLoader.class.getDeclaredField("nativeLibraries");
        nativeLibraries.setAccessible(true);

        Class<?> nativeLibrary = null;
        for (Class<?> nested : ClassLoader.class.getDeclaredClasses())
        {
            if (nested.getSimpleName().equals("NativeLibrary"))
            {
                nativeLibrary = nested;
                break;
            }
        }
        this.nativeLibraryFromClass = nativeLibrary.getDeclaredField("fromClass");
        nativeLibraryFromClass.setAccessible(true);

        this.nativeLibraryName = nativeLibrary.getDeclaredField("name");
        nativeLibraryName.setAccessible(true);
    }

    /**
     * Returns the names of native libraries loaded across all class loaders.
     * <p/>
     * @return a list of native libraries loaded
     */
    public List<String> getLoadedLibraries()
    {
        try
        {
            @SuppressWarnings("UseOfObsoleteCollectionType")
            final Vector<String> result = (Vector<String>) loadedLibraryNames.get(null);
            return result;
        }
        catch (IllegalArgumentException | IllegalAccessException e)
        {
            throw new AssertionError(e);
        }
    }

    /**
     * Returns the native libraries loaded by the system class loader.
     * <p/>
     * @return a Map from the names of native libraries to the classes that loaded them
     */
    public Map<String, Class<?>> getSystemNativeLibraries()
    {
        try
        {
            Map<String, Class<?>> result = new HashMap<>();
            @SuppressWarnings("UseOfObsoleteCollectionType")
            final Vector<Object> libraries = (Vector<Object>) systemNativeLibraries.get(null);
            for (Object nativeLibrary : libraries)
            {
                String libraryName = (String) nativeLibraryName.get(nativeLibrary);
                Class<?> fromClass = (Class<?>) nativeLibraryFromClass.get(nativeLibrary);
                result.put(libraryName, fromClass);
            }
            return result;
        }
        catch (IllegalArgumentException | IllegalAccessException e)
        {
            throw new AssertionError(e);
        }
    }

    /**
     * Returns a Map from the names of native libraries to the classes that loaded them.
     * <p/>
     * @param loader the ClassLoader that loaded the libraries
     * @return an empty Map if no native libraries were loaded
     */
    public Map<String, Class<?>> getNativeLibraries(final ClassLoader loader)
    {
        try
        {
            Map<String, Class<?>> result = new HashMap<>();
            @SuppressWarnings("UseOfObsoleteCollectionType")
            final Vector<Object> libraries = (Vector<Object>) nativeLibraries.get(loader);
            for (Object nativeLibrary : libraries)
            {
                String libraryName = (String) nativeLibraryName.get(nativeLibrary);
                Class<?> fromClass = (Class<?>) nativeLibraryFromClass.get(nativeLibrary);
                result.put(libraryName, fromClass);
            }
            return result;
        }
        catch (IllegalArgumentException | IllegalAccessException e)
        {
            throw new AssertionError(e);
        }
    }

    /**
     * The same as {@link #getNativeLibraries()} except that all ancestor classloaders are processed
     * as well.
     * <p/>
     * @param loader the ClassLoader that loaded (or whose ancestors loaded) the libraries
     * @return an empty Map if no native libraries were loaded
     */
    public Map<String, Class<?>> getTransitiveNativeLibraries(final ClassLoader loader)
    {
        Map<String, Class<?>> result = new HashMap<>();
        ClassLoader parent = loader.getParent();
        while (parent != null)
        {
            result.putAll(getTransitiveNativeLibraries(parent));
            parent = parent.getParent();
        }
        result.putAll(getNativeLibraries(loader));
        return result;
    }

    /**
     * Converts a map of library names to the classes that loaded them to a map of library names to
     * the classloaders that loaded them.
     * <p/>
     * @param libraryToClass a map of library names to the classes that loaded them
     * @return a map of library names to the classloaders that loaded them
     */
    public Map<String, ClassLoader> getLibraryClassLoaders(Map<String, Class<?>> libraryToClass)
    {
        Map<String, ClassLoader> result = new HashMap<>();
        for (Entry<String, Class<?>> entry : libraryToClass.entrySet())
            result.put(entry.getKey(), entry.getValue().getClassLoader());
        return result;
    }

    /**
     * Returns a list containing the classloader and its ancestors.
     * <p/>
     * @param loader the classloader
     * @return a list containing the classloader, its parent, and so on
     */
    public static List<ClassLoader> getTransitiveClassLoaders(ClassLoader loader)
    {
        List<ClassLoader> result = new ArrayList<>();
        ClassLoader parent = loader.getParent();
        result.add(loader);
        while (parent != null)
        {
            result.add(parent);
            parent = parent.getParent();
        }
        return result;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T23:34:04.790

FWIW，这里又是[jitter 的解决方案](https://stackoverflow.com/questions/1007861/how-do-i-get-a-list-of-jni-libraries-which-are-loaded/1008631#1008631)，这次是一个小的 Scala 方法：

```
def loadedLibs: Seq[String] = {
  val libs = classOf[ClassLoader].getDeclaredField("loadedLibraryNames")
  libs.setAccessible(true)
  import scala.collection.JavaConverters._
  libs.get(ClassLoader.getSystemClassLoader())
    .asInstanceOf[java.util.Vector[String]]
    .asScala
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-30T16:08:53.250

由于 Nicolas 提到了 Scala，这里有一种通过 JRuby 来解决抖动的方法（在 1.6 和 1.7 中测试）：

```
require 'java'
import 'java.lang.ClassLoader'
f = ClassLoader.java_class.declared_field('loadedLibraryNames')
f.accessible = true
f.value(ClassLoader.system_class_loader).to_array.to_a 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-11T12:01:44.250

在 Clojure 中，复制/粘贴到 REPL：

```
(-> (doto (.getDeclaredField ClassLoader "loadedLibraryNames")
      (.setAccessible true))
    (.get (ClassLoader/getSystemClassLoader))) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-15T19:59:04.153

在 Groovy 中（在 2.3.3 中测试）：

```
libs = ClassLoader.class.getDeclaredField("loadedLibraryNames")
libs.setAccessible(true)
libraries = libs.get(ClassLoader.getSystemClassLoader()) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-28T07:57:59.603

截至 2019 年 1 月，正确答案（从 jdk9+ 开始）是：无法再获取已加载库的列表。

尽管提到的字段 ( `loadedLibraryNames`) 仍然存在于`hotspot`-type VM 中，但它不存在于其他 (如`openj9`) 中。此外，如果您在 jdk9 及更高版本上尝试此操作，您将在终端上收到警告，该访问权限将在 Java 12 及更高版本中被撤销：

```
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by <class> (file:<file>) to method|constructor
WARNING: Please consider reporting this to the maintainers of <file>
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release 
```

也就是说，* 此方法仅适用于非常特定的 JVM。不要依赖这一点，因为有人可能会使用另一个成熟的 VM，如`openj9`, `azul`,`corretto`等。 * 从 Java 9 正式开始它就无法工作，但会从 Java 12 开始使你的 JVM 崩溃（或产生意外的输出）。

# html - html 表单和负顶部 css 值

> ID：1007865
> 
> 赞同：0
> 
> 时间：2009-06-17T15:39:45.873
> 
> 标签：html, css

我正在尝试使用带有负值的 CSS 定位一个小的搜索框表单，但是当我这样做时，您无法再单击文本输入框或单击按钮。您仍然可以选择表单，并且功能仍然有效。我尝试过定位表单本身，将表单放入 div 并定位它，将 div 定位在表单内，但似乎没有任何效果。

有什么办法可以在不破坏它的情况下将这段 HTML 向上移动大约 50px 吗？

```
<form action="search.html" method="post">
<div class="searchBox" id="generalSearch">
<input type="submit" class="fbutton" style="font-size:12px;" value="" />
<input type="text" style="tsearch" name="searchString" maxlength="200" size="24" value="" />
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:51:56.073

将 CSS z-index 设置得高一点（如 form#myForm {z-index:10;}）。它在上面的元素*之下。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:48:16.697

页面上的其他一些元素由于其位置而干扰了您的搜索框；不仅仅是因为您在 CSS 中有一个负的最高值。

您可以通过将顶部值再减少 50 像素，将搜索框向上移动 50 像素。

要消除干扰，请尝试通过将 50px 添加到其顶部值来降低页面上的其他元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:55:13.013

你的问题是在 IE 还是所有浏览器？如果它仅在 IE 中，请尝试在表单（或其他 hasLayout 触发器）上设置 position:relative。

正如 SpliFF 所说，还要注意 z-index 问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-19T17:04:37.270

啊，z-index。确实很强大，但被误解了。看看关于 z-index 的 W3 教程，它应该可以帮助您解决这个问题。

# asp.net-mvc - 您将如何使用 nHibernate 处理这种情况

> ID：1007869
> 
> 赞同：0
> 
> 时间：2009-06-17T15:39:59.397
> 
> 标签：asp.net-mvc, nhibernate, oop

我的数据库中有 2 个表：

*   类别
*   博客条目

每个`BlogEntry`都有 1 个或多个`Category`与之关联的 s。

如果我想`BlogEntry`通过它的 ID 得到一个，我也想得到它的`Category`信息。

也许这个例子并没有准确地说明一个有意义的场景，但是说我只想加载`Category`ID 和 Name，而不是类别数据库中的所有其他列。

nHibernate 会加载每个实体的所有列/属性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:14:14.533

我将通过将其映射为 BlogEntry 和 Category 之间的一对多关联来处理此问题，以便 BlogEntry 具有 Category 的集合。我会设置它，以便类别集合是延迟加载的。我不在乎我加载的列多于我将显示的列，因为我正在处理业务对象并通过主键或外键进行选择。担心这一点是 NHibernate 的工作，尽管我会在开发过程中使用 SQL Profiler 或 NHProf 进行检查。

NHibernate 将通过使用 BlogEntry 的外键选择类别记录来加载集合。在几乎所有情况下，仅返回您将要显示的字段并不会提高性能。检索仅根据显示需求填充所需属性的业务对象不是一个好的面向对象实践。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:55:12.610

这取决于你如何映射它。显然位代码检测只能允许检索部分表，但很少需要。

也许解释为什么你只想要类别的 id ......

如果您定义休眠映射，而不是让类别映射到类别对象的实体，只需将其作为整数。当我不关心能否使用原始查询获取附件时，这就是我处理映射的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:00:58.173

你会想研究投影。我们实际上是使用 AliasToBean 转换器来让 NHibernate 将我们的投影直接转换为特定于屏幕的 DTO。

# sharepoint - 如何对匿名用户插入的项目运行工作流

> ID：1007871
> 
> 赞同：1
> 
> 时间：2009-06-17T15:40:02.970
> 
> 标签：sharepoint, sharepoint-designer

有没有办法对匿名用户在面向 Internet 的 Sharepoint 发布站点上插入的项目启动 sharepoint 设计器工作流。据我了解，在基础架构更新时，无法在匿名用户或系统管理员插入的新项目上启动工作流。我们正在使用带有 SP2 的 Moss 2007。

我们需要做的是一个反馈列表，它会在匿名用户向列表中插入新项目时发送一封电子邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T23:09:16.227

我知道如果您坚持使用设计器，这将无济于事，但您可以拥有一个 ItemAdded 事件，其中包含一些启动工作流程本身的代码。或者可能更适用，直接从 ItemAdded 事件发送电子邮件。工作流最适合用于涉及用户交互的长流程。

# jquery - 带有 jquery 的 iframe

> ID：1007879
> 
> 赞同：0
> 
> 时间：2009-06-17T15:41:21.687
> 
> 标签：jquery, html, jquery-ui, iframe

是否可以使用 jquery 更改 iframe 滚动属性？我还需要更改 iframe css。

当根文档加载完成时，我正在更改 iframe 的 src 属性，然后我将使用 jquery 附加到 iframe 加载事件，这部分工作成功。

之后，我尝试使用 jquery 更改相同 iframe 的某些属性，但这不起作用。iframes 属性不能改变，Jquery 没有给出任何错误。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:35:01.007

您可以将溢出设置为隐藏：

```
$('iframe').css('overflow','hidden'); 
```

# c# - 为什么我的 XML 验证对其架构失败？

> ID：1007881
> 
> 赞同：5
> 
> 时间：2009-06-17T15:41:27.460
> 
> 标签：c#, xml, validation, xsd

我需要根据模式验证 XML 文件。XML 文件是在代码中生成的，在我保存它之前，我需要验证它是否正确。

我已将问题简化为最简单的元素，但遇到了问题。

XML:

```
<?xml version="1.0" encoding="utf-16"?>
<MRIDSupportingData xmlns="urn:GenericLabData">
  <MRIDNumber>MRIDDemo</MRIDNumber>
  <CrewMemberIdentifier>1234</CrewMemberIdentifier>
  <PrescribedTestDate>1/1/2005</PrescribedTestDate>
</MRIDSupportingData> 
```

架构：

```
<?xml version="1.0" encoding="utf-16"?>
<xs:schema xmlns="urn:GenericLabData" targetNamespace="urn:GenericLabData" 
   xmlns:xs="http://www.w3.org/2001/XMLSchema">

   <xs:element name="MRIDSupportingData">
   <xs:complexType> 
      <xs:sequence>
        <xs:element name="MRIDNumber" type="xs:string" /> 
        <xs:element minOccurs="1" name="CrewMemberIdentifier" type="xs:string" />
      </xs:sequence>
   </xs:complexType>
  </xs:element>
</xs:schema> 
```

ValidationCode：（此代码来自我为测试验证逻辑而编写的一个简单应用程序。XML 和 XSD 文件存储在磁盘上并正在从那里读取。在实际应用程序中，XML 文件已经作为 XmlDocument 在内存中对象和 XSD 将从内部网络服务器读取。）

```
private void Validate()
{
  XmlReaderSettings settings = new XmlReaderSettings();
  settings.ValidationType = ValidationType.Schema;
  //settings.ValidationFlags |= XmlSchemaValidationFlags.ProcessInlineSchema;
  //settings.ValidationFlags |= XmlSchemaValidationFlags.ProcessSchemaLocation;
  //settings.ValidationFlags |= XmlSchemaValidationFlags.ReportValidationWarnings;
  settings.ValidationEventHandler += new ValidationEventHandler(OnValidate);

  XmlSchemaSet schemas = new XmlSchemaSet();
  settings.Schemas = schemas;
  try
  {
    schemas.Add(null, schemaPathTextBox.Text);
    using (XmlReader reader = XmlReader.Create(xmlDocumentPathTextBox.Text, settings))
    {
      validateText.AppendLine("Validating...");
      while (reader.Read()) ;
      validateText.AppendLine("Finished Validating");
      textBox1.Text = validateText.ToString();
    }
  }
  catch (Exception ex)
  {
    textBox1.Text = ex.ToString();
  }

}

StringBuilder validateText = new StringBuilder();
private void OnValidate(object sender, ValidationEventArgs e)
{
  switch (e.Severity)
  {
    case XmlSeverityType.Error:
      validateText.AppendLine(string.Format("Error: {0}", e.Message));
      break;
    case XmlSeverityType.Warning:
      validateText.AppendLine(string.Format("Warning {0}", e.Message));
      break;
  }
} 
```

使用上面定义的 XML 和 XSD 文件运行上述代码时，我得到以下输出：

> 正在验证... 错误：命名空间“urn:GenericLabData”中的元素“MRIDSupportingData”在命名空间“urn:GenericLabData”中具有无效的子元素“MRIDNumber”。预期的可能元素列表：“MRIDNumber”。完成验证

我错过了什么？据我所知，MRIDNumber 是 MRIDNumber 那么为什么会出错？

实际的 XML 文件和 XSD 一样大得多，但一开始就失败了，所以我将问题减少到几乎没有。

对此的任何帮助都会很棒。

谢谢你，
基思

* * *

顺便说一句，这些文件确实有效：

XML:

```
<?xml version='1.0'?>
<bookstore xmlns="urn:bookstore-schema">
  <book genre="novel">
    <title>The Confidence Man</title>
    <author>
      <first-name>Herman</first-name>
      <last-name>Melville</last-name>
    </author>
    <price>11.99</price>
  </book>
</bookstore> 
```

架构：

```
 <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns="urn:bookstore-schema"
    elementFormDefault="qualified"
    targetNamespace="urn:bookstore-schema">
  <xsd:element name="bookstore">
    <xsd:complexType>
      <xsd:sequence >
        <xsd:element name="book"  maxOccurs="unbounded">
          <xsd:complexType>
            <xsd:sequence >
              <xsd:element name="title" type="xsd:string"/>
              <xsd:element name="author">
                <xsd:complexType>
                  <xsd:sequence >
                    <xsd:element name="first-name"  type="xsd:string"/>
                    <xsd:element name="last-name" type="xsd:string"/>
                  </xsd:sequence> 
                </xsd:complexType>
              </xsd:element>
              <xsd:element name="price"  type="xsd:decimal"/>
            </xsd:sequence> 
            <xsd:attribute name="genre" type="xsd:string"/>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>    
    </xsd:complexType>   
  </xsd:element>
</xsd:schema> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T15:49:59.443

尝试在XSD 文件的元素中添加`elementFormDefault="qualified"`属性。`xs:schema`

我认为验证器是说它想要一个`MRIDNumber`没有命名空间的元素，而不是你的`MRIDNumber`带有命名空间的元素`urn:GenericLabData`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:47:08.633

在您当前正在测试的 XML/XSD 的一小段摘录中，您是否也在 XSD 中包含了 PrescribedTestDate？

# linq - Linq .Contains with large set 导致 TDS 错误

> ID：1007893
> 
> 赞同：3
> 
> 时间：2009-06-17T15:42:38.003
> 
> 标签：linq, tsql

我有点过于简化了，因为我正在寻找一个通用的答案。假设我有一个这样的表设置：

```
Parent
recno    int (unique, pk)
date     datetime
stuff    varchar(50)

Child
parentrecno (int, fk)   --- PK
sequence    (int)       --- PK
data     varchar(50) 
```

在我的 C# 程序中，我经历了很多麻烦来找到我感兴趣的父记录并将它们塞进一个列表中。Parent 是一个非常大的表，我宁愿不要对它进行不必要的查询。所以我把钥匙藏起来：

```
List<int> recs = (from d in Parent where [.....] select d.recno).ToList(); 
```

稍后在 Linq 中，我可以说，找到关联父母的所有子记录：

```
var kids = from k in database.Childs
      where recs.Contains(k.parentrecno)
      select new { k }; 
```

这一切都很好，直到 recs 包含超过 2100 个条目。然后我得到一个 TDS RPC 错误（参数太多）。

在我看来，我可以：

*   用直接的 SQL 做所有的事情（真的不想用 DataReader 来解决麻烦，等等......）。有一个外部系统参与了对记录的限定，所以我也不知道这是否完全有可能。另外，我会生成该列表两次——一次是当我需要在 .Contains() 中使用它时，另一次用于其他目的。

*   分解列表（recs），然后分块阅读 Child。

如果我把它分成几块，那么我漂亮的 Linq 再往下一点就根本不起作用：

```
var kids2 = (from kid in paydb.Childs
         where
             recs.Contains(kid.parentrecno)
         group pay by kid.parentrecno into kgroup
         select new { ParentRecNo = kgroup.Key, KidRecords = kgroup })
              .ToDictionary(kx => kx.ParentRecNo); 
```

因为 List recs 将包含需要组合在一起的东西，但必须为 Linq 查询分开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-25T16:09:43.757

我们使用一个 SQL 函数，将 varchar(max) 分隔的值列表作为参数并返回一个表变量。linq 看起来像这样：

```
from a in Context.SomeTable    
join nl in Context.ParseDelimited(nodeIdList) on a.NodeId.ToString() equals nl.FieldValue 
```

其中 nodeIdList 是一个字符串变量，其中包含来自先前查询的 id 列表。丑陋，但它确实绕过了 2100 参数限制。

```
create function dbo.ParseDelimited(@delimitedList NVARCHAR(MAX)) returns @tblSample table(counter int, fieldValue NVARCHAR(100)) 
WITH SCHEMABINDING
as
begin
  declare @counter    NVARCHAR(  4)
  declare @fieldValue NVARCHAR(100)

  declare @tmpTable table(counter int primary key, fieldValue NVARCHAR(100))

  set @counter = 1

  while charindex(',', @delimitedList) > 0
  begin
    set @fieldValue = ltrim(rtrim(substring(@delimitedList, 1, charIndex(',', @delimitedList)-1)))

    insert into @tmpTable select @counter, @fieldValue

    set @delimitedList = ltrim(rtrim(substring(@delimitedList, (charindex(',', @delimitedList) + 1), len(@delimitedList))))

    set @counter = @counter + 1
  end

  if ltrim(rtrim(@delimitedList)) != ''
  begin
    insert into @tmpTable select @counter, @delimitedList
  end

  insert into @tblSample select counter, fieldValue from @tmpTable

  return
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:45:58.680

除了使用 SQL 和 DataReader，您还可以编写两个存储过程并通过 LINQ 使用它们。甚至可以通过 LINQ 读取 id 列表并将其作为输入提供给您的存储过程。

您可能无法解决参数过多的问题（您是否可以访问数据库）并且块解决方案不是很好，并且由于第二个查询而不能解决整个问题。

编辑：由于该`recs`集合并非完全由数据库生成，因此您需要某种方式告诉您的数据库该集合的内容。我认为您最好的选择是使用一个（或两个）存储过程，将集合作为一个大的逗号分隔字符串接受。在存储过程中，您再次将字符串拆分为 id。

[一些](http://www.sqlservercentral.com/scripts/Miscellaneous/31913/) 解释如何编写和使用拆分字符串函数的[链接。](https://stackoverflow.com/questions/519769/sql-server-2008-pass-arraylist-or-string-to-sp-for-in/519791)

顺便说一句，如果您使用的是 SQL Server 2008，则有一种比字符串解析更好的方法：[表值参数](http://msdn.microsoft.com/en-us/library/bb675163.aspx)。您可以将表作为参数传递给存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T16:41:51.913

这看起来像是 Linq .Join() 的工作。我使用下面的对象而不是数据库作为数据源，但如果您的 LinqToSql 提供程序支持，概念是相同的。

```
List<int> recs = new List<int>(Enumerable.Range(1, 2500));
List<Child> children = new List<Child>(Enumerable.Range(2000, 1000)
    .Select(x => new Child
    {
        ParentRecNo = x
    }));

var kids = children.Join(recs, x => x.ParentRecNo, y => y, (x, y) => x);

Console.WriteLine(kids.First().ParentRecNo);
Console.WriteLine(kids.Last().ParentRecNo); 
```

输出：

```
2000
2500 
```

您可以在 Dictionary 创建代码中使用相同的 Join，如下所示：

```
var kids2 = children
    .Join(recs, x => x.ParentRecNo, y => y, (x, y) => x)
    .GroupBy(x => x.ParentRecNo)
    .Select(kgroup => new
        {
            ParentRecNo = kgroup.Key,
            KidRecords = kgroup
        })
    .ToDictionary(kx => kx.ParentRecNo); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-21T05:06:23.500

我想这就是你要找的：

```
List<Child> children = 
database.Parents.Where( 'your favourite lambda expression').Select(x=>x.Childs).ToList(); 
```

所以...我不知道您使用什么条件来获取父母，但希望可以使用 lambda 表达式来完成，例如：

```
List<Child> children = database.Parents
     .Where(p=>p.recno > 10 && p.recno < 40)
     .Select(x=>x.Childs).ToList(); 
```

# c# - 正则表达式无法区分 float 和 int 类型

> ID：1007902
> 
> 赞同：2
> 
> 时间：2009-06-17T15:43:24.553
> 
> 标签：c#, .net, regex

我已经编写了用于识别 float 和 int 的正则表达式，但它们似乎不起作用（下面的代码）。

```
{
    string sumstring = "12.098";

    Regex flt = new Regex(@" ^[0-9]*(\.[0-9]*)");
    Regex ent = new Regex("^[0-9]+");

    if (d_type.IsMatch(sumstring))
    {
        Console.WriteLine(sumstring + " " + "dtype");
    }

    Match m = ent.Match(sumstring);

    if (m.Success)
    {
        Console.WriteLine("int");
    }
    else if (flt.IsMatch(sumstring))
    {
        Console.WriteLine("float");
    }
} 
```

错误在哪里？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T15:55:58.163

首先，我不认为正则表达式真的是这项工作的最佳工具。我会简单地使用`Double.TryParse()`and`Int32.TryParse()`函数。

其次，您的正则表达式缺少**大量**测试用例：

*   整数
    *   5（有盖）
    *   +5（未涵盖）
    *   -5（未涵盖）
*   双倍的
    *   5.0（覆盖）
    *   +5.0（未涵盖）
    *   -5.0（未涵盖）
    *   5.0E5（未涵盖）
    *   5.0E+5（未涵盖）
    *   5.0E-5（未涵盖）
    *   +5.0E5（未涵盖）
    *   +5.0E+5（未涵盖）
    *   +5.0E-5（未涵盖）
    *   -5.0E5（未涵盖）
    *   -5.0E+5（未涵盖）
    *   -5.0E-5（未涵盖）
*   边缘案例
    *   2^32 + 1（应该被识别为 Double，即使它看起来像 Integer）

所有这些（可能除了边缘情况）都将通过使用库而不是手动滚动正则表达式来立即覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T15:46:32.177

您正在以错误的顺序尝试测试 - 切换它们，或者 (*) 在 RE 模式的末尾放置一个 $，以确保它们一直匹配到最后。

(*) 完全取决于您要执行的操作：匹配以整数或浮点数表示*开头*的字符串，或者仅匹配*完全*由这种表示形式组成的字符串？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:47:38.727

“ent”正则表达式应该锚定：`Regex ent = new Regex("^[0-9]+$");`

你匹配的只是第一个数字......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T16:26:21.123

我不知道 C# 的正则表达式与 Perl 的兼容性如何，但我尽量不要重新发明轮子，除非它需要重新发明：

```
% perl -e 'use Regexp::Common; print $RE{num}{real}, "\n"'
(?:(?i)(?:[+-]?)(?:(?=[0123456789]|[.])(?:[0123456789]*)(?:(?:[.])(?:[0123456789]{0,}))?)(?:(?:[E])(?:(?:[+-]?)(?:[0123456789]+))|)) 
```

现在，我不明白他们为什么不使用 [0-9]，但这很好用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T15:47:52.970

正则表达式必须匹配整个字符串。 `"^\d*\.\d*$"`会匹配。或者，您可以只在字符串中搜索句点。

# windows - Django App CSS 在 Safari 3 中工作，而不是在 Firefox 3 中

> ID：1007908
> 
> 赞同：1
> 
> 时间：2009-06-17T15:44:33.273
> 
> 标签：windows, django, firefox, safari

我正在阅读一本 Django 书，前几天我发现了一些奇怪的东西。CSS 代码在 Safari 3（Mac 和 Windows）中运行良好，但在 Firefox 3 (Windows) 中却不行。我正在运行 django dev web 服务器，我可以看到在 Safari 中时控制台中调用了 css 文件，但在使用 Firefox 时却没有。对可能发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T01:49:51.237

您是否丢失或在您的任何路径中有额外的斜线？

例如

```
admin.site.root_path = 'admin' 
```

代替

```
admin.site.root_path = '/admin/' 
```

..在你的 urls.py

或者你的settings.py中有类似的东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T02:36:59.270

我是一个白痴....

这是我脑海中的css文件的链接：

`<link rel="sytlesheet" href="/site_media/style.css" type="text/css" />`

嗯......这不是你拼写“样式表”的方式！有趣的是，即使拼写错误，Webkit（Chrome 和 Safari）也能显示 css。当我进入本书的下一章并且 jquery 示例正在运行并且 jquery.js 文件位于同一目录中时，我发现了这一点。只是没有加起来。

对不起这个可怕的问题！

# oracle - Oracle EXECUTE IMMEDIATE 可以绑定可变数量吗？

> ID：1007912
> 
> 赞同：11
> 
> 时间：2009-06-17T15:45:04.147
> 
> 标签：oracle, plsql, dynamic-sql

我需要在 Oracle 上使用动态 SQL 执行，我不知道运行前 SQL 中使用的绑定变量的确切数量。

有没有办法在调用中以某种方式使用可变数量的绑定变量`EXECUTE IMMEDIATE`？

更具体地说，我需要将**一个**参数传递给未知的 SQL，但我不知道它在那里使用的频率。

我尝试了类似的东西

```
EXECUTE IMMEDIATE 'SELECT SYSDATE FROM DUAL WHERE :var = :var' USING 1; 
```

但它与`ORA-01008: not all variables bound.`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T19:52:31.833

你不能用`EXECUTE IMMEDIATE`. 但是，您可以使用 Oracle 的`DBMS_SQL`包来执行此操作。[Database Application Developer's Guide](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_dynamic_sql.htm#g1013258)对`EXECUTE IMMEDIATE`您熟悉的方法和方法进行了比较`dbms_sql`。 [此页面](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_sql.htm#i996963)文档`DBMS_SQL`，但有一些示例（上面链接）可以帮助您入门（示例 1 是运行可能具有任意数量绑定变量的语句的简单案例）。 `DBMS_SQL`从编码的角度来看，这要麻烦得多，但它可以让你做任何你能想到的事情。

Multiple instances of the bind variable occurring in the SQL are allowed. However, you will have to know the name being used as the bind variable (e.g. :var in your case) in order to pass it into `DBMS_SQL.BIND_VARIABLE`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-07T14:36:23.337

`WITH`您也可以通过使用语句来解决此问题。通常使用`DBMS_SQL`更好，但有时这是一种更简单的方法：

```
BEGIN
    EXECUTE IMMEDIATE 'WITH var AS (SELECT :var FROM dual) SELECT SYSDATE FROM DUAL WHERE (SELECT * FROM var) = (SELECT * FROM var)' USING 1;
END; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T16:03:50.877

[AskTom 上](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:6711305251199 "立即执行 - 不知道有多少输入变量")的此主题详细介绍了该主题。

在您的情况下，如果您想传递一个参数或不传递一个参数，您可以构建两个具有单个参数的查询，并且在其中一个查询中不使用它（即谓词始终为真），如下所示：

```
-- query1
SELECT * FROM DUAL WHERE dummy = :x;

-- query2
SELECT * FROM DUAL WHERE nvl(:x, 1) IS NOT NULL; 
```

您可能可以改进谓词，以便优化器了解它始终为真。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T06:52:05.447

One can use `dbms_sql` like Steve Broberg explained but the resulting cursor can't be consumed (read) in a lot of clients. Oracle 11 has added a conversion function ([`dbms_sql.to_refcursor`](http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_sql.htm#CHDFDCDE)) that makes it possible to convert a `dbms_sql` cursor to a ref cursor but for some reason one can't consume this converted ref cursor in a .Net application. One can consume a normal ref cursor in .net but not a ref cursor that used to be `dbms_sql` cursor.

So what kind of client will be consuming this cursor?

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-18T20:58:37.670

> 更具体地说，我需要将一个参数传递给未知的 SQL，但我不知道它在那里使用的频率。

几天前我实际上遇到了同样的问题，一位朋友与我分享了一种使用`EXECUTE IMMEDIATE`.

它涉及生成 PLSQL 块而不是 SQL 块本身。当`EXECUTE IMMEDIATE`与 PLSQL 代码块一起使用时，您可以按名称绑定变量，而不仅仅是按位置。

查看我的示例/代码和我自己的类似问题/答案线程：

*   [将一个绑定变量多次分配给动态生成的 SQL](https://stackoverflow.com/questions/6023298/more-efficient-way-to-merge-unique-values-from-dynamically-selected-tables-using/6050794#6050794)

# video - 为什么 FFMPEG 报告错误的持续时间？

> ID：1007915
> 
> 赞同：7
> 
> 时间：2009-06-17T15:45:55.267
> 
> 标签：video, ffmpeg

我有一个旧版本的 FFmpeg，我无法轻易更改。

我们使用 FFmpeg 来查找视频和声音文件的持续时间。到目前为止，它一直运行良好。

最近在一个上传的文件上，FFmpeg 报告了一个 30 秒的文件长度为 5 分 30 秒。

文件而不是FFmpeg可能有问题吗？

如果我使用 FFmpeg 转换为另一个文件，则会恢复持续时间。

万一这很重要， ffmpeg -i 'path to the file' 会产生：

```
FFmpeg 版本 Sherpya-r15618，版权所有 (c) 2000-2008 Fabrice Bellard 等人。
  libavutil 49.11。0 / 49.11。0
  libavcodec 52.0.0 / 52.0.0
  libav 格式 52.22。1 / 52.22。1
  libavdevice 52\. 1\. 0 / 52\. 1\. 0
  libswscale 0\. 6\. 1 / 0\. 6\. 1
  libpostproc 51\. 2\. 0 / 51\. 2\. 0
  建于 2008 年 10 月 14 日 23:43:47，gcc：4.2.5 20080919（预发布）[Sherpya]
输入 #0, mov,mp4,m4a,3gp,3g2,mj2，来自 'H:\path\to\file.mov'：
  持续时间：00:05:35.00，开始：0.000000，比特率：1223 kb/s
    流 #0.0（eng）：音频：aac，44100 Hz，立体声，s16
    流 #0.1(eng)：视频：h264、yuv420p、720x576、25.00 tb(r)
必须提供至少一个输出文件

```

这就是我用来然后用 RegEx 提取持续时间的命令。

有没有人有一个很好的应用程序可以做我上面尝试的事情，但 100% 的时间都正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T16:01:00.533

使用较新版本的 ffmpeg 进行检查（您不必替换您的构建），如果它提供相同的持续时间，您可能*会*责怪该文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-08-06T08:17:53.440

你不应该依赖标准错误。

stderr 输出不打算进行机器解析：它仅供参考，容易损坏。

解析它

```
ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 input.mp4
30.024000 
```

您还可以使用 ffmpeg 通过完全解码文件来获取持续时间。

```
ffmpeg -i input.webm -f null -
...
frame=206723 fps=1390 q=-0.0 Lsize=N/A time=00:57:28.87 bitrate=N/A speed=23.2x 
```

有关详细信息，请参阅[格式（容器）持续时间](https://trac.ffmpeg.org/wiki/FFprobeTips#Formatcontainerduration)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T16:14:29.097

估计是文件有问题。长度可能错误地写在标题中。不幸的是，没有验证器之类的东西（如网络标准），因此您无法确定文件是否正确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T15:53:10.020

你可以试试 tcprobe，它是[转码](http://www.transcoding.org/cgi-bin/transcode)包的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-07T18:00:56.477

确保您正在定义该文件已知的频道和频率。还要确保使用 -f 定义格式。检查`ffmpeg -formats`以查看所有可用的。

用于`-ac`定义通道。用于`-ar`定义音频的速率。如果它默认比特率或频率，则持续时间将与实际不同。

# django - Django 注释反向关系

> ID：1007925
> 
> 赞同：3
> 
> 时间：2009-06-17T15:47:11.427
> 
> 标签：django, django-comments

当使用 django.contrib.comments 时，是否可以将反向关系添加到具有注释的模型中？

例如：

```
post = Post.objects.all()[0]
comments = post.comments.all() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T17:29:29.493

是的，您应该能够：

```
from django.contrib.contenttypes import generic
class Post(models.Model):
    ...
    comments = generic.GenericRelation(Comments) 
```

根据关于[反向通用关系的 Django 文档](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#reverse-generic-relations)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:42:55.523

我想出了另一种方法来做到这一点（为什么？因为当时我不知道有任何其他方法）。它依赖于一个抽象模型类，系统中的所有模型都从该类派生。抽象模型本身有一个`comments`定义的方法，当被调用时，它会返回`QuerySet`与相应具体对象关联的所有注释对象中的一个。我是这样实现的：

```
from django.db import models
from django.contrib.contenttypes.models import ContentType
from django.contrib.comments.models import Comment

class AbstractModel(models.Model):

    def comments(self):
        """Return all comment objects for the instance."""
        ct = ContentType.objects.get(model=self.__class__.__name__)
        return Comment.objects.filter(content_type=ct,
                                    object_pk=self.id)

    class Meta:
        abstract = True 
```

# java - 图像未显示在 JTable (Java Swing) 中

> ID：1007933
> 
> 赞同：0
> 
> 时间：2009-06-17T15:48:27.697
> 
> 标签：java, user-interface, swing, jtable, gui-designer

嗨，我创建了以下代码。问题是图像未显示在 JTable 列中。

我扩展了 DefaultTableModel 并覆盖了 getColumnClass 方法。有人建议这是一种方法。有什么线索吗？代码如下。

```
//package javaapplication12;

import javax.swing.*;

public class NewJFrame2 extends javax.swing.JFrame {

    /** Creates new form NewJFrame */
    public NewJFrame2() {
        initComponents();
    }

    public class imageTableModel extends javax.swing.table.DefaultTableModel

   {
       imageTableModel(Object[][] data, Object[] columnNames)
       {
           super(data,columnNames);
       }

@Override
        public Class getColumnClass(int column)
         {

            if (column == 0)
         {

                return ImageIcon.class;
        }
            return Object.class;
    // other code; default to Object.class
       }
    }

    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jTable1.setModel(new imageTableModel(
            new Object [][] {
                {new ImageIcon("simply.jpg"), "pp"},

            },
            new String [] {
                "image", "name"
            }
        ));
        jScrollPane1.setViewportView(jTable1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 375, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(19, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(19, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new NewJFrame2().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    // End of variables declaration

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T16:02:31.110

这是正确的方法，但没有正确找到您的 jpg。更改您的代码以将其作为资源 URL 进行查找，它应该可以正确找到它。以下更改在我的机器上完美运行：

```
 jTable1.setModel(new imageTableModel(
        new Object [][] {
            {new ImageIcon(getClass().getClassLoader().getResource("simply.jpg")), "pp"},

        },
        new String [] {
            "image", "name"
        }
    )); 
```

# c++ - Qt - 创建 QPainter

> ID：1007938
> 
> 赞同：0
> 
> 时间：2009-06-17T15:50:03.997
> 
> 标签：c++, qt, qpainter, paintevent

我正在尝试`paintEvent`在我的程序中重写方法并进行更改。

```
void MainWindow::paintEvent(QPaintEvent *event)
{
    QRegion reg = this->bgPixmapHandle->rect();
    QPainter painter(this);

    painter.setClipRegion(reg);
    painter.drawImage(bgPixmapHandle->rect(), bgPixmapHandle);
    painter.end();
} 
```

在这里，我尝试改变我的`bg`形象。但是我在网上遇到了一个错误：`QPainter painter(this);`

> 错误：变量“QPainter Painter”已初始化，但类型不完整

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T15:58:32.063

包括 QPainter 头文件。QPainter 类仅在您包含在该翻译单元中的 Qt 标头之一中前向声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T15:58:54.373

```
#include <QPainter> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:56:56.493

你包括吗？Qt 是类前向声明​​的忠实拥护者，这会导致此类神秘错误。

# lucene - 从 lucene 索引访问关键字列表

> ID：1007942
> 
> 赞同：2
> 
> 时间：2009-06-17T15:51:11.720
> 
> 标签：lucene

我们计划使用 lucene 作为 FTI 服务。除其他外，我们希望建立一个标签索引，基于我们的文档的标签属性，它只包含空格分隔的标签。

现在建议标签完成，如果有一种方法可以访问给定索引的所有唯一关键字，那就太好了。Lucene 必须能够在内部执行此操作，因为它使用它来完成类似查询以使用 OR 重写它们。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T18:15:29.667

使用[IndexReader.terms](http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/index/IndexReader.html#terms(org.apache.lucene.index.Term))获取标签字段的所有术语值（和文档计数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:20:21.063

标记完成需要来自 (a) 标记列表上的前缀查询（如 pytho*），或 (b) 通过对 ngram 标记字段的查询（例如，Lucene 会将 python 索引为 p、py、 pyt、pytho、python 在单独的字段中。）这两种解决方案都允许您即时执行标记完成查询。

您所建议的（以及 Coady 的回应将带给您的）是一种更离线的方法，或者您真的不想在查询时运行的东西。这也很好——标签字典不应该是实时的——但请注意，遍历 IndexReader 的术语并不意味着是“查询时”操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T05:56:28.890

请注意直接使用索引中的术语。如果您在索引时启用了词干提取，所有有趣的字符串都将开始出现在术语列表中。“Beauty”被词根为“beauti”，“create”被转换为“creat”等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-27T00:49:50.833

你需要做两件事：

1）当您创建要索引的文档时，请确保使用“ `ANALYZED`”

```
doc.add(new Field("tags", tags, Field.Store.NO, Field.Index.ANALYZED)); 
```

2) 使用布尔查询和 OR 所有术语：

```
BooleanQuery query = new BooleanQuery();

for( String tag : tags){
    query.add(new TermQuery("tags", tag), BooleanClause.Occur.SHOULD); 
}
TopDocs docs = searcher.search(query, null, searchLimit); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T16:22:49.533

如果您尝试完成标签，则不需要所有唯一标签，您需要与用户已经输入的标签相匹配的标签。这可以根据需要使用通配符、模糊、跨度或 proefix 查询来完成。

# wpf - 访问现有的 WPF 应用程序实例？

> ID：1007948
> 
> 赞同：3
> 
> 时间：2009-06-17T15:52:19.163
> 
> 标签：wpf

好的，这是我的情况。我有一个我创建的 WPF 应用程序，它还包括一个应用程序协议处理程序，以便可以从 Web 上的链接打开该应用程序，该链接使用命令行参数打开应用程序以预填充一些信息。这一切都在起作用。

我想要完成的是这个。如果用户已经打开了应用程序，并且他们单击了这些链接中的另一个，它将当前打开应用程序的一个新实例。我希望能够检测应用程序的现有实例是否正在运行，如果是，则将适当的值发送到该应用程序，而不是打开一个新实例。

我知道如何检查实例是否存在（我正在另一个应用程序中执行此操作），但我不知道如何将值发送到该应用程序。谷歌并没有太多帮助，你们一直都很棒。谢谢！

詹姆士

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T10:30:07.433

.NET/WPF 中有不同的进程间通信解决方案。看看另一个帖子： [C#/WPF 应用程序实现应用程序 CLI 的简单 IPC 机制](https://stackoverflow.com/questions/953853/simple-ipc-mechanism-for-c-wpf-application-to-implement-app-cli)

# objective-c - 如何在单元格中只选择按钮？

> ID：1007952
> 
> 赞同：0
> 
> 时间：2009-06-17T15:52:54.450
> 
> 标签：objective-c, iphone, xcode

我有一个带有很多标签和一个按钮的单元格。

我想让单元格的颜色变为蓝色，并且*只*选择按钮，而不是单元格。

按钮应该有自己的颜色。

如何使用 xCode 和 iPhone SDK 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T18:08:37.463

在你的 UITableViewController 中实现以下方法：

```
- (NSIndexPath *)tableView:(UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

然后为您不想选择的任何单元格返回 nil（您的单元格带有按钮）。您可以从 UITableViewDelegate 协议参考中获得额外的解释。

从 UItableViewDelegate 协议参考：

> -(NSIndexPath *)tableView:(UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath *)indexPath
> 
> **参数**tableView 一个表视图对象，通知代理即将进行的选择。
> 
> **indexPath**在 tableView 中定位行的索引路径。
> 
> **返回值**确认或更改选定行的索引路径对象。如果要选择另一个单元格，则返回 indexPath 以外的 NSIndexPath 对象。**如果您不想选择该行，则返回 nil。**
> 
> **讨论**在用户触摸一行然后抬起手指之前，不会调用此方法；直到那时该行才被选中，尽管它在触地时突出显示。您可以使用 UITableViewCellSelectionStyleNone 来禁用触摸时单元格突出显示的外观。

# javascript - （Ruby，Rails）多个同时拖放项目......？

> ID：1007955
> 
> 赞同：0
> 
> 时间：2009-06-17T15:53:16.090
> 
> 标签：javascript, ruby-on-rails, ruby, drag-and-drop

我在 Rails 中寻找一种机制，通过它可以同时促进多个拖放项目。基本上我想选择多个并拖动。显然我更喜欢使用标准的 HTML 项目和 javascript，但如果这不可能，我会考虑一个简单的 Flash 实现。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T16:10:27.430

这不会是 Rails，而是 Javascript（jquery、mootools 等）或 Flash。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:31:15.677

默认情况下 Scriptaculous 不支持此功能，但有一些扩展可能会满足您的需要。试试[这个](http://simplificator.com/scriptaculous-multidrag/)，例如。

# c# - 创建一个自定义控件，它是一个也有 Items 和 ItemsSource 的 Button？

> ID：1007958
> 
> 赞同：1
> 
> 时间：2009-06-17T15:53:27.993
> 
> 标签：c#, wpf, button, itemssource

我正在尝试创建一个`SplitButton`使用 a`ContextMenu`来显示其项目的控件。目前`SplitButton`来自`Button`. 我有一个`PART_DropDownInitiator`小图标，用户单击它会调`ContextMenu`出`SplitButton`以显示其项目。

问题是我试图在's或样式`ContextMenu`内设置默认值，这样控件的用户就不必自己做。起初我想我只是让用户在 xaml 中设置属性，但这似乎是不可能的。现在我想在's 的模板中添加一个和属性可以绑定到它。并且用户不应该只需要在 xaml 或代码隐藏中设置or属性...`SplitButton``Template``SplitButton.ContextMenu.Items``Items``ItemsSource``SplitButton``ContextMenu``SplitButton``Items``ItemsSource``SplitButton`

但是，`Items`和`ItemsSource`属性似乎都源自`ItemsControl`，这是一个问题，因为`SplitButton`已经源自`Button`。所以我不确定该怎么做......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:26:35.647

如果您要使用继承路线，则应改为从 HeaderedItemsControl 派生，您的默认 ControlTemplate 将 Header 内容作为 Button 的内容。

结果，您还获得了 Items/ItemsSource——您唯一需要开发的就是您的 ControlTemplate。

最后，考虑将菜单部分实现为 Popup 而不是 ContextMenu。ContextMenu 是一个特定用途的 UI 元素（通常通过右键单击来显示）。有关详细信息，请参阅 aero.normalcolor.xaml 中 ComboBox 的默认 ControlTemplate。

# javascript - 基于百分比的 Javascript 内容轮换

> ID：1007961
> 
> 赞同：2
> 
> 时间：2009-06-17T15:53:51.987
> 
> 标签：javascript, rotation, frontend

我需要能够根据这样的百分比旋转占位符 div 内的内容。旋转将在页面加载时发生。因此，每次用户重新加载页面时，他都有机会在内容占位符中看到内容 1、2 或 3：

内容 1 = 显示 50% 的时间
内容 2 = 显示 25% 的时间
内容 3 = 显示 25% 的时间

我更喜欢 Javascript，但如果在前端模板而不是代码隐藏的 ASP.NET 中有更简单的方法，那也是可以接受的。如果您有解决方案或可以将我指向现有脚本，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T16:21:57.397

真的不需要乘/地板/天花板任何东西：该`Math.random()`函数给出大于或等于0且小于1的值。

如果您更改选项的数量或机会百分比，以下代码会更容易维护。

```
var contentId, random = Math.random();

if (random < 0.5) {
  // option 1: chance 0.0–0.499...
  contentId = 0;
} else (random < 0.75) {
  // option 2: chance 0.50—0.7499...
  contentId = 1;
} else {
  // option 3: chance 0.75–0.99...
  contentId = 2;
}

loadContent(contentId); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:07:29.083

这是一个快速破解，可能有更好的方法。

```
var randomnumber=Math.floor(Math.random()*4)
if((num==0) || (num==1)) {
//show hidden div or document.write (50% probability)
} else if (num==2) {
//show hidden div or document.write (25% probability)
} else {
//show hidden div or document.write (25% probability)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:08:37.820

对于脚本的随机部分，你只需要使用 Math.random 一些丑陋和硬编码的东西看起来像这样：

```
var contentToShow = -1;
var NB_MAX = 4;
var myRand = Math.floor(Math.random()*NB_MAX);
if(myRand<1) contentToShow = 1;
else if (myRand<2) contentToShow = 2;
else contentToShow = 3; 
```

然后你只需要用ajax加载内容。

jQuery 中的一个示例可能如下所示：

```
var myPlaceHolder = $("#myPlaceHolder")
$.myPlaceHolder.load("/mycontents/mycontent_" + contentToShow + ".asp"); 
```

但是在页面加载时使用 ajax 请求并不是 imo 的方法。（如果随机内容由服务器处理，则为 2 个服务器请求而不是 1 个）

# css - 如何使用 div 组织页面布局

> ID：1007965
> 
> 赞同：11
> 
> 时间：2009-06-17T15:54:25.043
> 
> 标签：css, html

我有一个问题要问这里更有经验的程序员。

我怎样才能最好地组织 div，使其具有左侧、中间和右侧？

我现在正在做我的网站一段时间，我花了半天时间来移动 div，因为在我放入另一个 div 之后它们不会留在原位，我想使用相对选项。

此外，我所做的就是让它们在大负数的位置上。这似乎不是做事的正确方法。当一切都适合屏幕时，我也会得到滚动条。在dreamweaver cs3 中的设计模式下工作是不可能的，因为一切都在相互翻滚。

我希望就如何更好地做到这一点提供一些意见。

谢谢，理查德

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-17T18:09:44.997

在我看来，以下是使用 CSS 构建网站时要牢记的一些基本原则：

*   **定位**：视觉开发人员在构建他们的第一个纯 CSS 站点布局时常犯的错误是使用绝对/相对定位属性。将元素放置在页面上时，一切都与[盒子模型](http://www.w3.org/TR/CSS2/box.html)以及边距、填充和宽度如何相互作用。在您进一步了解之前，根本不需要使用 position 属性。这条规则有一些例外，但我们暂时保持简单。

*   **包装纸和容器**: 上面提到了盒子模型，让我进入下一个观点。您应该能够正确使用边距属性定位所有结构元素。有时开发人员会混淆填充/边距，从而导致“意外”行为。假设您要创建标题、内容和侧边栏元素。最重要的是，您希望在这些元素中添加内容而不会弄乱父元素。您需要为标题设置特定高度（px、% 等），还需要为内容和侧边栏元素设置宽度。在处理这些元素中的内容时，我通常使用另一个元素作为内容的“容器”。避免重新定义“容器”元素的大小，因为您已经在父元素中定义了它。

*   **清除浮动**：要定位内容和侧边栏或其他列类型元素，您将不得不在一个或多个元素上使用 float 属性。使用浮动时要记住的重要一点是，您应该在完成“浮动集”后清除它们。意思是，如果你有 3 列，全部设置了 float:left 属性，你应该在设置之后清除它们，而不是在每列之后。这取决于布局，但通常这种方式可以控制浮动，并且不会冒意外浮动其他不需要它的元素的风险。

*   **如有疑问，请重置您的边距/填充**：浏览器的差异至少可以说是令人沮丧的。如果未定义浏览器默认属性，您可以通过销毁它们来帮助解决此问题。我总是发现，如果将有问题的元素的边距/填充重置为 0，我可以轻松纠正间距问题。

*   **使用级联，不要重新定义**：请记住，如果您已经定义了一堆 css 属性，并且您在子元素中工作，则不需要重新定义属性。孩子继承父母的属性，所以只定义差异。

随着您使用它的次数越多，这将继续有意义，但我希望这将为您提供一些在构建 CSS 布局时要牢记的要点。上面的一些链接也是很好的资源，但我认为我应该分享一些我个人在使用 CSS 时的想法。

橡子

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T16:01:05.683

使用 CSS 网格布局

蓝图是我目前最喜欢的：http: [//www.blueprintcss.org/](http://www.blueprintcss.org/)

我通过 Compass/Sass 使用它：[http ://wiki.github.com/chriseppstein/compass](http://wiki.github.com/chriseppstein/compass)

除非您真的喜欢通过浮动进行思考，否则手动定位是灾难的根源。网格系统允许您以更简单的方式指定事物。Compass 允许您在保持语义标记的同时执行此操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T16:06:52.170

无需学习 blueprintcss 即可创建简单的 div 布局。

要开始使用 div 布局：

1.  在 div 上设置**宽度**
2.  给他们一个**浮动**风格。

三列布局的示例：

```
<div id="left_panel"  style="float:left; width:100px;">Left pane (100px)</div>
<div id="contents"    style="float:left; width:400px;">Contents (400px)</div>
<div id="right_panel" style="float:left; width:100px;">Right pane (100px)</div> 
```

div 布局的附加效果：

1.  如果您调整窗口大小并缩小它，div 可以换行到下一行。
2.  如果 div 内的内容可能比 div 的高度/宽度大，请使用“溢出”样式来决定要做什么。您可以将其设置为隐藏溢出的内容，或自动将滚动条添加到您的 div。

我希望这能告诉你 div 布局是多么的简单。您可以使用 div 而不是表格来进行布局，但这并不意味着每个表格都应该转换为 div，例如实际的表格数据应该在表格中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T16:06:03.233

如果您想要在某物的左侧、中间和右侧放置 div，则您正在寻找 float 属性。例如，在您的左侧 div 上执行此操作：

```
float: left;
position: relative; 
```

它会将 div 移动到页面的左侧，并将*其他内容强制到它的右侧*。例如，这是一种为页面区域创建侧边栏的简单方法。您仍然可以在以这种方式浮动的元素上设置高度和宽度，因为它仍然可以接受 position: relative; 属性，很容易在其中放置其他东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T16:01:42.517

从一个经过验证的布局开始，就像[位置就是一切](http://www.positioniseverything.net/)。为您节省一些重新发明轮子的时间。CSS 是一种需要时间来学习的东西。

想要“使用相对选项”并不总是一种选择或最佳方式。这取决于您在每种特定情况下尝试做什么。

无论如何，事物移动的通常原因是因为您错误地计算了事物的大小。如果您的布局很紧凑，只需 1px 的错误即可将一列向下推到所有内容下方。尝试暂时为事物设置边界，以便更好地可视化正在发生的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T16:02:51.190

使用 div 创建表通常不是一个好主意。虽然肯定有可能，但最好的解决方案几乎总是创建一个表。在现代浏览器上，经过深思熟虑的表格使用不是速度问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T16:23:59.207

希望这不被认为是逐个论证:)

大约 5 年前，我第一次学习基于 div 的多列布局，帮助我点击的教程位于[Maxdesign.com](http://css.maxdesign.com.au/floatutorial/)。该链接指向一个教程，指导您逐步构建基本的 3 列布局。

我不认为这些天我会完全遵循这种方法（例如，自从编写该教程以来，就出现了像[仿列](http://www.alistapart.com/articles/fauxcolumns/)这样的技术），但它是对基于 CSS 的布局所需的思维模式的一个很好的破冰器.

# c - 关于 C 结构的问题

> ID：1007966
> 
> 赞同：4
> 
> 时间：2009-06-17T15:54:37.697
> 
> 标签：c

我一直以为我对 C 非常了解，直到我在另一篇文章中看到这样的内容：

```
struct foo {
    int x:1;
}; 
```

我真的很想知道 :1 的目的。任何人都可以提示我吗？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T15:57:21.610

位域。x 是 1 位长。

> 每个字段都像结构的普通成员一样被访问和操作。关键字有符号和无符号表示您所期望的，但有趣的是，二进制补码机器上的 1 位有符号字段只能取值 0 或 -1。允许声明包含 const 和 volatile 限定符。
> 
> 位域的主要用途是允许紧密打包数据或能够在某些外部生成的数据文件中指定字段。C 不保证机器字中字段的顺序，所以如果你出于后一个原因使用它们，你的程序不仅是不可移植的，它也会依赖于编译器。该标准说，字段被打包到“存储单元”中，这些单元通常是机器字。打包顺序，以及位域是否可以跨越存储单元边界，由实现定义。要强制对齐到存储单元边界，在要对齐的字段之前使用零宽度字段。
> 
> 小心使用它们。操作这些东西可能需要大量的运行时代码，最终您可能会使用比它们节省的空间更多的空间。
> 
> 位域没有地址——你不能有指向它们的指针或它们的数组。

[http://publications.gbdirect.co.uk/c_book/chapter6/bitfields.html](http://publications.gbdirect.co.uk/c_book/chapter6/bitfields.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T16:00:33.000

这些是位字段。在结构中，您可以定义分配给变量的位数（覆盖变量类型的标准）

在上面的示例中，x 仅使用 1 个字节，因此只能取值 0 或 1。

[请参阅C 书中](http://publications.gbdirect.co.uk/c_book/chapter6/bitfields.html)的以下示例。点击链接了解更多信息。

```
struct {
      /* field 4 bits wide */
      unsigned field1 :4;
      /*
       * unnamed 3 bit field
       * unnamed fields allow for padding
       */
      unsigned        :3;
      /*
       * one-bit field
       * can only be 0 or -1 in two's complement!
       */
      signed field2   :1;
      /* align next field on a storage unit */
      unsigned        :0;
      unsigned field3 :6;
}full_of_fields; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:59:02.967

这是一个 1 位长的位字段。[维基百科](http://en.wikipedia.org/wiki/Bit_field)上有很好的讨论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T15:58:28.927

该语法用于表示位字段（即比数据类型本身更窄的位字段），因此您示例中的“x”实际上是使用 1 位 int。

一个更有用的例子可能是

```
char x:4;
char y:4; 
```

这会将两个 4 位字段打包到一个字节中。当然，优点是在每个字节都很关键的架构中节省空间。

# c# - 经纬度变化？

> ID：1007971
> 
> 赞同：1
> 
> 时间：2009-06-17T15:55:30.410
> 
> 标签：c#, geocoding

我正在为我正在构建的应用程序编写地理编码组件，我决定使用 Yahoo Maps。我编写了地理编码 API 包装器和一些单元测试，并称之为一天。第二天回来，跑了测试，发现经纬度变了。请注意，这个变化对我来说足够小，但它足以影响我在单元测试中用于比较结果的四舍五入到小数点后四位。

我以前从未听说过改变纬度和经度。这是我应该期待/解释的事情吗？谁能解释为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T15:58:05.277

大陆漂移？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T15:58:42.937

地理编码，尤其是从地址完成时，很少是 100% 准确的。有许多公司除了编译用于地理编码目的的街道数据之外什么都不做。

数据不准确，但经常更新以改进地址匹配。当这种情况发生时，你会得到不同的结果。我的猜测是发生了两件事之一：

1) 雅虎更新了他们的源数据。

2）您从具有不同源数据集的不同服务器获得结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:59:37.757

地理编码使用的算法必然是不精确的。他们做出某些猜测。除了上面给出的信息，请查看此白皮书：

[http://www.urisa.org/files/goldberg.pdf](http://www.urisa.org/files/goldberg.pdf)

其中谈到了这些算法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T16:00:53.623

听起来这可能是正在执行的计算的舍入误差。

现在的结果是一致的还是你仍然得到稍微不同的结果？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T16:06:57.600

有趣的。

在我看来，当一个人比较“真实”数字是否相等时发生的事情非常相似。此“问题”的通常解决方案是计算 Abs[xy] < tol 其中 x, y 是您的实数（或浮点数或双精度数），而 tol 是一些小数字，代表您确定数字足够接近的标准为您的目的被视为平等。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-17T16:02:52.220

**地图不是领土**

作为程序员，我们很容易忘记数据*代表*世界，它们不是世界的实际*方面*。

您还有其他答案更详细地说明了同样的事情，特别是关于地理编码，但总的来说也值得记住......

# snmp - SNMP v1 - 代理 IP

> ID：1007978
> 
> 赞同：0
> 
> 时间：2009-06-17T15:56:49.147
> 
> 标签：snmp

我正在使用 Net-SNMP utils (5.3) 发送 SNMP 陷阱。我将代理设置为有效的服务器 IP，但 NMS 正在接收陷阱，就好像它是生成它的服务器的陷阱，而不是我在代理字段中使用的其他服务器的陷阱。我对为什么会发生这种情况感到完全困惑，其他服务器正在使用相同的包并且它工作正常！

谢谢， PJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T01:38:35.940

您可以捕获wireshark日志以查看SNMP级别TRAP消息中的IP地址是否与IP级别中的发送者IP地址相同？

# javascript - 如何动态获取函数参数名称/值？

> ID：1007981
> 
> 赞同：331
> 
> 时间：2009-06-17T15:57:13.593
> 
> 标签：javascript, reflection, function-parameter

有没有办法动态获取函数的函数参数名称？

假设我的函数如下所示：

```
function doSomething(param1, param2, .... paramN){
   // fill an array with the parameter name and value
   // some other code 
} 
```

现在，我如何将参数名称及其值的列表从函数内部获取到数组中？

* * *

## 回答 #1

> 赞同：348
> 
> 时间：2012-03-29T11:30:54.527

以下函数将返回传入的任何函数的参数名称数组。

```
var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;
var ARGUMENT_NAMES = /([^\s,]+)/g;
function getParamNames(func) {
  var fnStr = func.toString().replace(STRIP_COMMENTS, '');
  var result = fnStr.slice(fnStr.indexOf('(')+1, fnStr.indexOf(')')).match(ARGUMENT_NAMES);
  if(result === null)
     result = [];
  return result;
} 
```

示例用法：

```
getParamNames(getParamNames) // returns ['func']
getParamNames(function (a,b,c,d){}) // returns ['a','b','c','d']
getParamNames(function (a,/*b,c,*/d){}) // returns ['a','d']
getParamNames(function (){}) // returns [] 
```

**编辑**：

随着 ES6 的发明，这个函数可以被默认参数触发。这是一个在大多数情况下应该可以工作的快速技巧：

```
var STRIP_COMMENTS = /(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,\)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,\)]*))/mg; 
```

我说大多数情况是因为有些事情会绊倒它

```
function (a=4*(5/3), b) {} // returns ['a'] 
```

**编辑**：我还注意到 vikasde 还想要数组中的参数值。这已经在名为 arguments 的局部变量中提供。

摘自[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments)：

参数对象不是数组。它类似于 Array，但除了长度之外没有任何 Array 属性。例如，它没有 pop 方法。但是它可以转换为真正的数组：

```
var args = Array.prototype.slice.call(arguments); 
```

如果 Array 泛型可用，则可以使用以下方法：

```
var args = Array.slice(arguments); 
```

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2012-08-24T11:39:55.967

下面是取自 AngularJS 的代码，它使用该技术作为其依赖注入机制。

这是从[http://docs.angularjs.org/tutorial/step_05 获取的解释](http://docs.angularjs.org/tutorial/step_05)

> Angular 的依赖注入器在构建控制器时为您的控制器提供服务。依赖注入器还负责创建服务可能具有的任何传递依赖（服务通常依赖于其他服务）。
> 
> 请注意，参数的名称很重要，因为注入器使用它们来查找依赖项。

```
/**
 * @ngdoc overview
 * @name AUTO
 * @description
 *
 * Implicit module which gets automatically added to each {@link AUTO.$injector $injector}.
 */

var FN_ARGS = /^function\s*[^\(]*\(\s*([^\)]*)\)/m;
var FN_ARG_SPLIT = /,/;
var FN_ARG = /^\s*(_?)(.+?)\1\s*$/;
var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;
function annotate(fn) {
  var $inject,
      fnText,
      argDecl,
      last;

  if (typeof fn == 'function') {
    if (!($inject = fn.$inject)) {
      $inject = [];
      fnText = fn.toString().replace(STRIP_COMMENTS, '');
      argDecl = fnText.match(FN_ARGS);
      forEach(argDecl[1].split(FN_ARG_SPLIT), function(arg){
        arg.replace(FN_ARG, function(all, underscore, name){
          $inject.push(name);
        });
      });
      fn.$inject = $inject;
    }
  } else if (isArray(fn)) {
    last = fn.length - 1;
    assertArgFn(fn[last], 'fn')
    $inject = fn.slice(0, last);
  } else {
    assertArgFn(fn, 'fn', true);
  }
  return $inject;
} 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2015-07-02T21:28:58.607

这是一个更新的解决方案，它试图以紧凑的方式解决上述所有边缘情况：

```
function $args(func) {  
    return (func + '')
      .replace(/[/][/].*$/mg,'') // strip single-line comments
      .replace(/\s+/g, '') // strip white space
      .replace(/[/][*][^/*]*[*][/]/g, '') // strip multi-line comments  
      .split('){', 1)[0].replace(/^[^(]*[(]/, '') // extract the parameters  
      .replace(/=[^,]+/g, '') // strip any ES6 defaults  
      .split(',').filter(Boolean); // split & filter [""]
} 
```

简短的测试输出（完整的测试用例附在下面）：

```
'function (a,b,c)...' // returns ["a","b","c"]
'function ()...' // returns []
'function named(a, b, c) ...' // returns ["a","b","c"]
'function (a /* = 1 */, b /* = true */) ...' // returns ["a","b"]
'function fprintf(handle, fmt /*, ...*/) ...' // returns ["handle","fmt"]
'function( a, b = 1, c )...' // returns ["a","b","c"]
'function (a=4*(5/3), b) ...' // returns ["a","b"]
'function (a, // single-line comment xjunk) ...' // returns ["a","b"]
'function (a /* fooled you...' // returns ["a","b"]
'function (a /* function() yes */, \n /* no, */b)/* omg! */...' // returns ["a","b"]
'function ( A, b \n,c ,d \n ) \n ...' // returns ["A","b","c","d"]
'function (a,b)...' // returns ["a","b"]
'function $args(func) ...' // returns ["func"]
'null...' // returns ["null"]
'function Object() ...' // returns [] 
```

```
function $args(func) {  
    return (func + '')
      .replace(/[/][/].*$/mg,'') // strip single-line comments
      .replace(/\s+/g, '') // strip white space
      .replace(/[/][*][^/*]*[*][/]/g, '') // strip multi-line comments  
      .split('){', 1)[0].replace(/^[^(]*[(]/, '') // extract the parameters  
      .replace(/=[^,]+/g, '') // strip any ES6 defaults  
      .split(',').filter(Boolean); // split & filter [""]
}  

// test cases  
document.getElementById('console_info').innerHTML = (
[  
  // formatting -- typical  
  function(a,b,c){},  
  function(){},  
  function named(a, b,  c) {  
/* multiline body */  
  },  

  // default values -- conventional  
  function(a /* = 1 */, b /* = true */) { a = a||1; b=b||true; },  
  function fprintf(handle, fmt /*, ...*/) { },  

  // default values -- ES6  
  "function( a, b = 1, c ){}",  
  "function (a=4*(5/3), b) {}",  

  // embedded comments -- sardonic  
  function(a, // single-line comment xjunk) {}
    b //,c,d
  ) // single-line comment
  {},  
  function(a /* fooled you{*/,b){},  
  function /* are you kidding me? (){} */(a /* function() yes */,  
   /* no, */b)/* omg! */{/*}}*/},  

  // formatting -- sardonic  
  function  (  A,  b  
,c  ,d  
  )  
  {  
  },  

  // by reference  
  this.jQuery || function (a,b){return new e.fn.init(a,b,h)},
  $args,  

  // inadvertent non-function values  
  null,  
  Object  
].map(function(f) {
    var abbr = (f + '').replace(/\n/g, '\\n').replace(/\s+|[{]+$/g, ' ').split("{", 1)[0] + "...";
    return "    '" + abbr + "' // returns " + JSON.stringify($args(f));
  }).join("\n") + "\n"); // output for copy and paste as a markdown snippet
```

```
<pre id='console_info'></pre>
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-02-02T08:26:00.117

不太容易出现空格和注释的解决方案是：

```
var fn = function(/* whoa) */ hi, you){};

fn.toString()
  .replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s))/mg,'')
  .match(/^function\s*[^\(]*\(\s*([^\)]*)\)/m)[1]
  .split(/,/)

["hi", "you"] 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2017-01-07T18:57:28.710

这里的很多答案都使用正则表达式，这很好，但它不能很好地处理语言的新添加（如箭头函数和类）。另外值得注意的是，如果你在缩小代码上使用这些函数中的任何一个，它就会去 . 它将使用任何缩小的名称。Angular 通过允许您在将参数注册到 DI 容器时传入与参数顺序匹配的有序字符串数组来解决此问题。依此类推解决方案：

```
var esprima = require('esprima');
var _ = require('lodash');

const parseFunctionArguments = (func) => {
    // allows us to access properties that may or may not exist without throwing 
    // TypeError: Cannot set property 'x' of undefined
    const maybe = (x) => (x || {});

    // handle conversion to string and then to JSON AST
    const functionAsString = func.toString();
    const tree = esprima.parse(functionAsString);
    console.log(JSON.stringify(tree, null, 4))
    // We need to figure out where the main params are. Stupid arrow functions 
    const isArrowExpression = (maybe(_.first(tree.body)).type == 'ExpressionStatement');
    const params = isArrowExpression ? maybe(maybe(_.first(tree.body)).expression).params 
                                     : maybe(_.first(tree.body)).params;

    // extract out the param names from the JSON AST
    return _.map(params, 'name');
}; 
```

这处理了原始的解析问题和更多的函数类型（例如箭头函数）。这是它可以和不能按原样处理的想法：

```
// I usually use mocha as the test runner and chai as the assertion library
describe('Extracts argument names from function signature. ', () => {
    const test = (func) => {
        const expectation = ['it', 'parses', 'me'];
        const result = parseFunctionArguments(toBeParsed);
        result.should.equal(expectation);
    } 

    it('Parses a function declaration.', () => {
        function toBeParsed(it, parses, me){};
        test(toBeParsed);
    });

    it('Parses a functional expression.', () => {
        const toBeParsed = function(it, parses, me){};
        test(toBeParsed);
    });

    it('Parses an arrow function', () => {
        const toBeParsed = (it, parses, me) => {};
        test(toBeParsed);
    });

    // ================= cases not currently handled ========================

    // It blows up on this type of messing. TBH if you do this it deserves to 
    // fail  On a tech note the params are pulled down in the function similar 
    // to how destructuring is handled by the ast.
    it('Parses complex default params', () => {
        function toBeParsed(it=4*(5/3), parses, me) {}
        test(toBeParsed);
    });

    // This passes back ['_ref'] as the params of the function. The _ref is a 
    // pointer to an VariableDeclarator where the ✨ happens.
    it('Parses object destructuring param definitions.' () => {
        function toBeParsed ({it, parses, me}){}
        test(toBeParsed);
    });

    it('Parses object destructuring param definitions.' () => {
        function toBeParsed ([it, parses, me]){}
        test(toBeParsed);
    });

    // Classes while similar from an end result point of view to function
    // declarations are handled completely differently in the JS AST. 
    it('Parses a class constructor when passed through', () => {
        class ToBeParsed {
            constructor(it, parses, me) {}
        }
        test(ToBeParsed);
    });
}); 
```

取决于你想将它用于 ES6 代理和解构可能是你最好的选择。例如，如果您想将它用于依赖注入（使用参数的名称），那么您可以按如下方式进行：

```
class GuiceJs {
    constructor() {
        this.modules = {}
    }
    resolve(name) {
        return this.getInjector()(this.modules[name]);
    }
    addModule(name, module) {
        this.modules[name] = module;
    }
    getInjector() {
        var container = this;

        return (klass) => {
            console.log(klass);
            var paramParser = new Proxy({}, {
                // The `get` handler is invoked whenever a get-call for
                // `injector.*` is made. We make a call to an external service
                // to actually hand back in the configured service. The proxy
                // allows us to bypass parsing the function params using
                // taditional regex or even the newer parser.
                get: (target, name) => container.resolve(name),

                // You shouldn't be able to set values on the injector.
                set: (target, name, value) => {
                    throw new Error(`Don't try to set ${name}! `);
                }
            })
            return new klass(paramParser);
        }
    }
} 
```

它不是目前最先进的解析器，但如果您想使用 args 解析器进行简单的 DI，它可以让您了解如何使用代理来处理它。然而，这种方法有一个轻微的警告。我们需要使用解构赋值而不是普通参数。当我们传入注入器代理时，解构与在对象上调用 getter 相同。

```
class App {
   constructor({tweeter, timeline}) {
        this.tweeter = tweeter;
        this.timeline = timeline;
    }
}

class HttpClient {}

class TwitterApi {
    constructor({client}) {
        this.client = client;
    }
}

class Timeline {
    constructor({api}) {
        this.api = api;
    }
}

class Tweeter {
    constructor({api}) {
        this.api = api;
    }
}

// Ok so now for the business end of the injector!
const di = new GuiceJs();

di.addModule('client', HttpClient);
di.addModule('api', TwitterApi);
di.addModule('tweeter', Tweeter);
di.addModule('timeline', Timeline);
di.addModule('app', App);

var app = di.resolve('app');
console.log(JSON.stringify(app, null, 4)); 
```

这将输出以下内容：

```
{
    "tweeter": {
        "api": {
            "client": {}
        }
    },
    "timeline": {
        "api": {
            "client": {}
        }
    }
} 
```

它连接了整个应用程序。最好的一点是该应用程序易于测试（您只需实例化每个类并传入模拟/存根/等）。此外，如果您需要更换实现，您可以从一个地方进行。由于 JS 代理对象，这一切都是可能的。

**注意：在它准备好用于生产之前需要做很多工作，但它确实给出了它的外观。**

答案有点晚了，但它可能会帮助其他正在考虑同样事情的人。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-08-20T02:19:35.717

**我知道这是一个老问题，但初学者一直在复制粘贴，好像这是任何代码中的好习惯。大多数时候，必须解析函数的字符串表示以使用其参数名称只是隐藏了代码逻辑中的缺陷。**

函数的参数实际上存储在一个名为 的类数组对象`arguments`中，其中第一个参数是`arguments[0]`，第二个参数是 ，`arguments[1]`依此类推。在括号中写入参数名称可以看作是一种简写语法。这个：

```
function doSomething(foo, bar) {
    console.log("does something");
} 
```

...是相同的：

```
function doSomething() {
    var foo = arguments[0];
    var bar = arguments[1];

    console.log("does something");
} 
```

变量本身存储在函数的作用域中，而不是作为对象中的属性。无法通过代码检索参数名称，因为它只是人类语言中表示变量的符号。

我一直认为函数的字符串表示是用于调试目的的工具，尤其是因为这个`arguments`类数组对象。首先，您不需要为参数命名。如果您尝试解析字符串化函数，它实际上并没有告诉您它可能需要的额外未命名参数。

这是一个更糟糕、更常见的情况。如果一个函数有超过 3 或 4 个参数，则将其传递给一个对象可能是合乎逻辑的，这样更容易使用。

```
function saySomething(obj) {
  if(obj.message) console.log((obj.sender || "Anon") + ": " + obj.message);
}

saySomething({sender: "user123", message: "Hello world"}); 
```

在这种情况下，函数本身将能够读取它接收的对象并查找其属性并获取它们的名称和值，但是尝试解析函数的字符串表示只会给你“obj”作为参数，这根本没用。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2016-08-31T15:42:39.853

我已经阅读了这里的大部分答案，我想添加我的单行。

```
new RegExp('(?:'+Function.name+'\\s*|^)\\((.*?)\\)').exec(Function.toString().replace(/\n/g, ''))[1].replace(/\/\*.*?\*\//g, '').replace(/ /g, '') 
```

或者

```
function getParameters(func) {
  return new RegExp('(?:'+func.name+'\\s*|^)\\s*\\((.*?)\\)').exec(func.toString().replace(/\n/g, ''))[1].replace(/\/\*.*?\*\//g, '').replace(/ /g, '');
} 
```

或 ECMA6 中的单线函数

```
var getParameters = func => new RegExp('(?:'+func.name+'\\s*|^)\\s*\\((.*?)\\)').exec(func.toString().replace(/\n/g, ''))[1].replace(/\/\*.*?\*\//g, '').replace(/ /g, ''); 
```

__

假设你有一个函数

```
function foo(abc, def, ghi, jkl) {
  //code
} 
```

下面的代码将返回`"abc,def,ghi,jkl"`

该代码还将与[Camilo Martin](https://stackoverflow.com/a/30322501/2856416)提供的函数设置一起使用：

```
function  (  A,  b
,c      ,d
){} 
```

还有布伯森对杰克艾伦[回答](https://stackoverflow.com/a/9924463/2856416)的评论：

```
function(a /* fooled you)*/,b){} 
```

__

# 解释

### `new RegExp('(?:'+Function.name+'\\s*|^)\\s*\\((.*?)\\)')`

这将创建一个[带有](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp)`new RegExp('(?:'+Function.name+'\\s*|^)\\s*\\((.*?)\\)')`. 我必须使用`new RegExp`，因为我将一个变量（`Function.name`，目标函数的名称）注入到 RegExp 中。

**示例**如果函数名称是“foo”( `function foo()`)，则 RegExp 将为`/foo\s*\((.*?)\)/`.

### `Function.toString().replace(/\n/g, '')`

然后它将整个函数转换为字符串，并删除所有换行符。删除换行有助于[Camilo Martin](https://stackoverflow.com/a/30322501/2856416)提供的功能设置。

### `.exec(...)[1]`

这就是[`RegExp.prototype.exec`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec)功能。它基本上将正则指数 ( `new RegExp()`) 匹配到字符串 ( `Function.toString()`) 中。然后`[1]`将返回在正则指数 ( )中找到的第一个[捕获组。](http://www.regular-expressions.info/brackets.html)`(.*?)`

### `.replace(/\/\*.*?\*\//g, '').replace(/ /g, '')`

这将删除 and 中的所有评论`/*`，`*/`并删除所有空格。

* * *

这现在也支持阅读和理解箭头 ( `=>`) 函数，例如`f = (a, b) => void 0;`，其中`Function.toString()`将返回`(a, b) => void 0`而不是正常函数的`function f(a, b) { return void 0; }`。原来的正则表达式会在混乱中引发错误，但现在已经解决了。

变化是从`new RegExp(Function.name+'\\s*\\((.*?)\\)')`( `/Function\s*\((.*?)\)/`) 到`new RegExp('(?:'+Function.name+'\\s*|^)\\((.*?)\\)')`( `/(?:Function\s*|^)\((.*?)\)/`)

* * *

如果你想把所有参数变成一个数组而不是一个用逗号分隔的字符串，最后只需添加`.split(',')`.

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2018-03-28T21:18:06.387

由于 JavaScript 是一种脚本语言，我觉得它的自省应该支持获取函数参数名称。使用该功能违反了第一原则，因此我决定进一步探讨这个问题。

这让我想到了[这个问题](https://stackoverflow.com/questions/6921588/is-it-possible-to-reflect-the-arguments-of-a-javascript-function)，但没有内置的解决方案。这让我得到了[这个答案](https://stackoverflow.com/a/8121309/539149)，它解释了`arguments`它只在函数**之外**被弃用，所以我们不能再使用`myFunction.arguments`或者我们得到：

```
TypeError: 'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them 
```

是时候卷起袖子开始工作了：

⭐ 检索函数参数需要解析器，因为像这样的复杂表达式`4*(5/3)`可以用作默认值。所以[Gaafar 的回答](https://stackoverflow.com/a/37881874/539149)或[James Drew 的回答](https://stackoverflow.com/a/41525264/539149)是迄今为止最好的方法。

我尝试了[babylon](https://github.com/babel/babel/tree/master/packages/babylon)和[esprima](https://github.com/jquery/esprima)解析器，但不幸的是它们无法解析独立的匿名函数，正如[Mateusz Charytoniuk 的回答](https://stackoverflow.com/a/22043134/539149)中所指出的那样。我通过将代码括在括号中找到了另一种解决方法，以免更改逻辑：

```
const ast = parser.parse("(\n" + func.toString() + "\n)") 
```

换行符可防止`//`（单行注释）出现问题。

⭐ 如果解析器不可用，下一个最佳选择是使用久经考验的技术，如 Angular.js 的依赖注入器正则表达式。我将 Lambder 的答案的功能版本与[Humbletim 的答案](https://stackoverflow.com/a/12108723/539149)结合[起来](https://stackoverflow.com/a/31194949/539149)，并添加了一个可选的`ARROW`布尔值来控制正则表达式是否允许 ES6 粗箭头函数。

* * *

这是我放在一起的两个解决方案。请注意，这些没有检测函数是否具有有效语法的逻辑，它们仅提取参数。这通常没问题，因为我们通常将解析后的函数传递给它们，`getArguments()`因此它们的语法已经有效。

我会尽力整理这些解决方案，但如果没有 JavaScript 维护者的努力，这仍然是一个悬而未决的问题。

**Node.js 版本（在 StackOverflow 支持 Node.js 之前无法运行）：**

```
const parserName = 'babylon';
// const parserName = 'esprima';
const parser = require(parserName);

function getArguments(func) {
    const maybe = function (x) {
        return x || {}; // optionals support
    }

    try {
        const ast = parser.parse("(\n" + func.toString() + "\n)");
        const program = parserName == 'babylon' ? ast.program : ast;

        return program
            .body[0]
            .expression
            .params
            .map(function(node) {
                return node.name || maybe(node.left).name || '...' + maybe(node.argument).name;
            });
    } catch (e) {
        return []; // could also return null
    }
};

////////// TESTS //////////

function logArgs(func) {
	let object = {};

	object[func] = getArguments(func);

	console.log(object);
// 	console.log(/*JSON.stringify(*/getArguments(func)/*)*/);
}

console.log('');
console.log('////////// MISC //////////');

logArgs((a, b) => {});
logArgs((a, b = 1) => {});
logArgs((a, b, ...args) => {});
logArgs(function(a, b, ...args) {});
logArgs(function(a, b = 1, c = 4 * (5 / 3), d = 2) {});
logArgs(async function(a, b, ...args) {});
logArgs(function async(a, b, ...args) {});

console.log('');
console.log('////////// FUNCTIONS //////////');

logArgs(function(a, b, c) {});
logArgs(function() {});
logArgs(function named(a, b, c) {});
logArgs(function(a /* = 1 */, b /* = true */) {});
logArgs(function fprintf(handle, fmt /*, ...*/) {});
logArgs(function(a, b = 1, c) {});
logArgs(function(a = 4 * (5 / 3), b) {});
// logArgs(function (a, // single-line comment xjunk) {});
// logArgs(function (a /* fooled you {});
// logArgs(function (a /* function() yes */, \n /* no, */b)/* omg! */ {});
// logArgs(function ( A, b \n,c ,d \n ) \n {});
logArgs(function(a, b) {});
logArgs(function $args(func) {});
logArgs(null);
logArgs(function Object() {});

console.log('');
console.log('////////// STRINGS //////////');

logArgs('function (a,b,c) {}');
logArgs('function () {}');
logArgs('function named(a, b, c) {}');
logArgs('function (a /* = 1 */, b /* = true */) {}');
logArgs('function fprintf(handle, fmt /*, ...*/) {}');
logArgs('function( a, b = 1, c ) {}');
logArgs('function (a=4*(5/3), b) {}');
logArgs('function (a, // single-line comment xjunk) {}');
logArgs('function (a /* fooled you {}');
logArgs('function (a /* function() yes */, \n /* no, */b)/* omg! */ {}');
logArgs('function ( A, b \n,c ,d \n ) \n {}');
logArgs('function (a,b) {}');
logArgs('function $args(func) {}');
logArgs('null');
logArgs('function Object() {}');
```

完整的工作示例：

[https://repl.it/repls/SandybrownPhonyAngles](https://repl.it/repls/SandybrownPhonyAngles)

**浏览器版本（注意它停在第一个复杂的默认值）：**

```
function getArguments(func) {
    const ARROW = true;
    const FUNC_ARGS = ARROW ? /^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m : /^(function)\s*[^\(]*\(\s*([^\)]*)\)/m;
    const FUNC_ARG_SPLIT = /,/;
    const FUNC_ARG = /^\s*(_?)(.+?)\1\s*$/;
    const STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;

    return ((func || '').toString().replace(STRIP_COMMENTS, '').match(FUNC_ARGS) || ['', '', ''])[2]
        .split(FUNC_ARG_SPLIT)
        .map(function(arg) {
            return arg.replace(FUNC_ARG, function(all, underscore, name) {
                return name.split('=')[0].trim();
            });
        })
        .filter(String);
}

////////// TESTS //////////

function logArgs(func) {
	let object = {};

	object[func] = getArguments(func);

	console.log(object);
// 	console.log(/*JSON.stringify(*/getArguments(func)/*)*/);
}

console.log('');
console.log('////////// MISC //////////');

logArgs((a, b) => {});
logArgs((a, b = 1) => {});
logArgs((a, b, ...args) => {});
logArgs(function(a, b, ...args) {});
logArgs(function(a, b = 1, c = 4 * (5 / 3), d = 2) {});
logArgs(async function(a, b, ...args) {});
logArgs(function async(a, b, ...args) {});

console.log('');
console.log('////////// FUNCTIONS //////////');

logArgs(function(a, b, c) {});
logArgs(function() {});
logArgs(function named(a, b, c) {});
logArgs(function(a /* = 1 */, b /* = true */) {});
logArgs(function fprintf(handle, fmt /*, ...*/) {});
logArgs(function(a, b = 1, c) {});
logArgs(function(a = 4 * (5 / 3), b) {});
// logArgs(function (a, // single-line comment xjunk) {});
// logArgs(function (a /* fooled you {});
// logArgs(function (a /* function() yes */, \n /* no, */b)/* omg! */ {});
// logArgs(function ( A, b \n,c ,d \n ) \n {});
logArgs(function(a, b) {});
logArgs(function $args(func) {});
logArgs(null);
logArgs(function Object() {});

console.log('');
console.log('////////// STRINGS //////////');

logArgs('function (a,b,c) {}');
logArgs('function () {}');
logArgs('function named(a, b, c) {}');
logArgs('function (a /* = 1 */, b /* = true */) {}');
logArgs('function fprintf(handle, fmt /*, ...*/) {}');
logArgs('function( a, b = 1, c ) {}');
logArgs('function (a=4*(5/3), b) {}');
logArgs('function (a, // single-line comment xjunk) {}');
logArgs('function (a /* fooled you {}');
logArgs('function (a /* function() yes */, \n /* no, */b)/* omg! */ {}');
logArgs('function ( A, b \n,c ,d \n ) \n {}');
logArgs('function (a,b) {}');
logArgs('function $args(func) {}');
logArgs('null');
logArgs('function Object() {}');
```

完整的工作示例：

[https://repl.it/repls/StupendousShowyOffices](https://repl.it/repls/StupendousShowyOffices)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-02-26T13:39:14.127

您还可以使用“esprima”解析器来避免参数列表中的注释、空格和其他内容的许多问题。

```
function getParameters(yourFunction) {
    var i,
        // safetyValve is necessary, because sole "function () {...}"
        // is not a valid syntax
        parsed = esprima.parse("safetyValve = " + yourFunction.toString()),
        params = parsed.body[0].expression.right.params,
        ret = [];

    for (i = 0; i < params.length; i += 1) {
        // Handle default params. Exe: function defaults(a = 0,b = 2,c = 3){}
        if (params[i].type == 'AssignmentPattern') {
            ret.push(params[i].left.name)
        } else {
            ret.push(params[i].name);
        }
    }

    return ret;
} 
```

它甚至可以使用这样的代码：

```
getParameters(function (hello /*, foo ),* /bar* { */,world) {}); // ["hello", "world"] 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2013-08-02T07:19:06.773

```
(function(a,b,c){}).toString().replace(/.*\(|\).*/ig,"").split(',') 
```

=> [“a”，“b”，“c”]

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2009-06-17T16:00:28.677

我以前尝试过这样做，但从未找到一种实用的方法来完成它。我最终传入了一个对象，然后循环遍历它。

```
//define like
function test(args) {
    for(var item in args) {
        alert(item);
        alert(args[item]);
    }
}

//then used like
test({
    name:"Joe",
    age:40,
    admin:bool
}); 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2018-07-01T22:33:55.527

正确的方法是使用 JS 解析器。这是一个使用[acorn](https://www.npmjs.com/package/acorn)的示例。

```
const acorn = require('acorn');    

function f(a, b, c) {
   // ...
}

const argNames = acorn.parse(f).body[0].params.map(x => x.name);
console.log(argNames);  // Output: [ 'a', 'b', 'c' ] 
```

此处的代码查找函数的三个（正式）参数的名称`f`。它通过`f`输入`acorn.parse()`.

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-06-17T16:50:12.797

我不知道这个解决方案是否适合您的问题，但它可以让您重新定义您想要的任何功能，而无需更改使用它的代码。现有调用将使用定位参数，而函数实现可能使用“命名参数”（单个哈希参数）。

我认为无论如何你都会修改现有的函数定义，为什么不拥有一个工厂函数来满足你的需求：

```
<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<title></title>
<script type="text/javascript">
var withNamedParams = function(params, lambda) {
    return function() {
        var named = {};
        var max   = arguments.length;

        for (var i=0; i<max; i++) {
            named[params[i]] = arguments[i];
        }

        return lambda(named);
    };
};

var foo = withNamedParams(["a", "b", "c"], function(params) {
    for (var param in params) {
        alert(param + ": " + params[param]);
    }
});

foo(1, 2, 3);
</script>
</head>
<body>

</body>
</html> 
```

希望能帮助到你。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-03-18T13:46:18.867

从@jack-allan 那里得到[答案](https://stackoverflow.com/a/9924463/745190)，我稍微修改了函数以允许 ES6 默认属性，例如：

```
function( a, b = 1, c ){}; 
```

仍然返回`[ 'a', 'b' ]`

```
/**
 * Get the keys of the paramaters of a function.
 *
 * @param {function} method  Function to get parameter keys for
 * @return {array}
 */
var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;
var ARGUMENT_NAMES = /(?:^|,)\s*([^\s,=]+)/g;
function getFunctionParameters ( func ) {
    var fnStr = func.toString().replace(STRIP_COMMENTS, '');
    var argsList = fnStr.slice(fnStr.indexOf('(')+1, fnStr.indexOf(')'));
    var result = argsList.match( ARGUMENT_NAMES );

    if(result === null) {
        return [];
    }
    else {
        var stripped = [];
        for ( var i = 0; i < result.length; i++  ) {
            stripped.push( result[i].replace(/[\s,]/g, '') );
        }
        return stripped;
    }
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-06-17T16:00:09.817

我不知道如何获取参数列表，但您可以这样做以获得它期望的数量。

```
alert(doSomething.length); 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2020-10-02T09:41:51.367

由于尚未提及，如果您使用 Typescript，则可以在使用装饰器时发出元数据，这将允许您获取参数类型。

仅当类/函数/道具上有装饰器时才会发出元数据。
哪个装饰器无关紧要。

[可以通过在 tsconfig.json 中将emitDecoratorMetadata](https://www.typescriptlang.org/tsconfig#emitDecoratorMetadata)设置为 true来启用此功能

```
{
  "compilerOptions": {
    "emitDecoratorMetadata": true
  }
} 
```

由于元数据仍然是一个早期[提议](https://rbuckton.github.io/reflect-metadata/)，因此必须安装[反射元数据包，否则将不会定义 Reflect.getMetadata。](https://www.npmjs.com/package/reflect-metadata)

```
npm install reflect-metadata 
```

您可以按如下方式使用它：

```
const AnyDecorator = () : MethodDecorator => {
    return target => { }
}

class Person{
    @AnyDecorator()
    sayHello(other: Person){}
}
const instance = new Person();
// This returns: Function
const funcType = Reflect.getMetadata('design:type', instance.sayHello);
// Returns an array of types, here it would be: [Person]
const funcParams = Reflect.getMetadata('design:paramtypes', instance.sayHello); 
```

例如，在较新版本的 Angular 中，这用于确定要注入的内容 -> [https://stackoverflow.com/a/53041387/1087372](https://stackoverflow.com/a/53041387/1087372)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2012-08-20T01:17:35.927

我通常是怎么做的：

```
function name(arg1, arg2){
    var args = arguments; // array: [arg1, arg2]
    var objecArgOne = args[0].one;
}
name({one: "1", two: "2"}, "string"); 
```

您甚至可以通过函数名称来引用 args，例如：

```
name.arguments; 
```

希望这可以帮助！

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-11-21T18:32:39.523

```
function getArgs(args) {
    var argsObj = {};

    var argList = /\(([^)]*)/.exec(args.callee)[1];
    var argCnt = 0;
    var tokens;

    while (tokens = /\s*([^,]+)/g.exec(argList)) {
        argsObj[tokens[1]] = args[argCnt++];
    }

    return argsObj;
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-01-28T03:18:40.990

```
//See this:

// global var, naming bB
var bB = 5;

//  Dependency Injection cokntroller
var a = function(str, fn) {
  //stringify function body
  var fnStr = fn.toString();

  // Key: get form args to string
  var args = fnStr.match(/function\s*\((.*?)\)/);
  // 
  console.log(args);
  // if the form arg is 'bB', then exec it, otherwise, do nothing
  for (var i = 0; i < args.length; i++) {
    if(args[i] == 'bB') {
      fn(bB);
    }
  }
}
// will do nothing
a('sdfdfdfs,', function(some){
alert(some)
});
// will alert 5

a('sdfdsdsfdfsdfdsf,', function(bB){
alert(bB)
});

// see, this shows you how to get function args in string 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2016-06-17T12:42:57.473

答案需要 3 个步骤：

1.  获取传递给函数的实际参数的值（我们称之为`argValues`）。这是直截了当的，因为它将`arguments`在函数内部可用。
2.  从函数签名中获取参数名称（我们称之为`argNames`）。这并不容易，需要解析函数。无需自己执行复杂的正则表达式并担心边缘情况（默认参数、注释等），您可以使用像 babylon 这样的库，它将函数解析为抽象语法树，您可以从中获取参数的名称。
3.  最后一步是将 2 个数组连接成 1 个数组，其中包含所有参数的名称和值。

代码将是这样的

```
const babylon = require("babylon")
function doSomething(a, b, c) {
    // get the values of passed argumenst
    const argValues = arguments

    // get the names of the arguments by parsing the function
    const ast = babylon.parse(doSomething.toString())
    const argNames =  ast.program.body[0].params.map(node => node.name)

    // join the 2 arrays, by looping over the longest of 2 arrays
    const maxLen = Math.max(argNames.length, argValues.length)
    const args = []
    for (i = 0; i < maxLen; i++) { 
       args.push({name: argNames[i], value: argValues[i]})
    }
    console.log(args)

    // implement the actual function here
}

doSomething(1, 2, 3, 4) 
```

并且记录的对象将是

```
[
  {
    "name": "a",
    "value": 1
  },
  {
    "name": "c",
    "value": 3
  },
  {
    "value": 4
  }
] 
```

这是一个工作示例[https://tonicdev.com/5763eb77a945f41300f62a79/5763eb77a945f41300f62a7a](https://tonicdev.com/5763eb77a945f41300f62a79/5763eb77a945f41300f62a7a)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-12-25T16:16:01.823

哇已经有这么多答案了。我很确定这会被埋没。即便如此，我认为这可能对某些人有用。

我对选择的答案并不完全满意，因为在 ES6 中它不适用于默认值。而且它也不提供默认值信息。我还想要一个不依赖于外部库的轻量级函数。

此函数对于调试目的非常有用，例如：记录调用函数及其参数、默认参数值和参数。

我昨天花了一些时间，破解了正确的正则表达式来解决这个问题，这就是我想出的。它运作良好，我对结果非常满意：

```
const REGEX_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;
const REGEX_FUNCTION_PARAMS = /(?:\s*(?:function\s*[^(]*)?\s*)((?:[^'"]|(?:(?:(['"])(?:(?:.*?[^\\]\2)|\2))))*?)\s*(?=(?:=>)|{)/m
const REGEX_PARAMETERS_VALUES = /\s*(\w+)\s*(?:=\s*((?:(?:(['"])(?:\3|(?:.*?[^\\]\3)))((\s*\+\s*)(?:(?:(['"])(?:\6|(?:.*?[^\\]\6)))|(?:[\w$]*)))*)|.*?))?\s*(?:,|$)/gm

/**
 * Retrieve a function's parameter names and default values
 * Notes:
 *  - parameters with default values will not show up in transpiler code (Babel) because the parameter is removed from the function.
 *  - does NOT support inline arrow functions as default values
 *      to clarify: ( name = "string", add = defaultAddFunction )   - is ok
 *                  ( name = "string", add = ( a )=> a + 1 )        - is NOT ok
 *  - does NOT support default string value that are appended with a non-standard ( word characters or $ ) variable name
 *      to clarify: ( name = "string" + b )         - is ok
 *                  ( name = "string" + $b )        - is ok
 *                  ( name = "string" + b + "!" )   - is ok
 *                  ( name = "string" + λ )         - is NOT ok
 * @param {function} func
 * @returns {Array} - An array of the given function's parameter [key, default value] pairs.
 */
function getParams(func) {

  let functionAsString = func.toString()
  let params = []
  let match
  functionAsString = functionAsString.replace(REGEX_COMMENTS, '')
  functionAsString = functionAsString.match(REGEX_FUNCTION_PARAMS)[1]
  if (functionAsString.charAt(0) === '(') functionAsString = functionAsString.slice(1, -1)
  while (match = REGEX_PARAMETERS_VALUES.exec(functionAsString)) params.push([match[1], match[2]])
  return params

}

// Lets run some tests!

var defaultName = 'some name'

function test1(param1, param2, param3) { return (param1) => param1 + param2 + param3 }
function test2(param1, param2 = 4 * (5 / 3), param3) {}
function test3(param1, param2 = "/root/" + defaultName + ".jpeg", param3) {}
function test4(param1, param2 = (a) => a + 1) {}

console.log(getParams(test1)) 
console.log(getParams(test2))
console.log(getParams(test3))
console.log(getParams(test4))

// [ [ 'param1', undefined ], [ 'param2', undefined ], [ 'param3', undefined ] ]
// [ [ 'param1', undefined ], [ 'param2', '4 * (5 / 3)' ], [ 'param3', undefined ] ]
// [ [ 'param1', undefined ], [ 'param2', '"/root/" + defaultName + ".jpeg"' ], [ 'param3', undefined ] ]
// [ [ 'param1', undefined ], [ 'param2', '( a' ] ]
// --> This last one fails because of the inlined arrow function!

var arrowTest1 = (a = 1) => a + 4
var arrowTest2 = a => b => a + b
var arrowTest3 = (param1 = "/" + defaultName) => { return param1 + '...' }
var arrowTest4 = (param1 = "/" + defaultName, param2 = 4, param3 = null) => { () => param3 ? param3 : param2 }

console.log(getParams(arrowTest1))
console.log(getParams(arrowTest2))
console.log(getParams(arrowTest3))
console.log(getParams(arrowTest4))

// [ [ 'a', '1' ] ]
// [ [ 'a', undefined ] ]
// [ [ 'param1', '"/" + defaultName' ] ]
// [ [ 'param1', '"/" + defaultName' ], [ 'param2', '4' ], [ 'param3', 'null' ] ]

console.log(getParams((param1) => param1 + 1))
console.log(getParams((param1 = 'default') => { return param1 + '.jpeg' }))

// [ [ 'param1', undefined ] ]
// [ [ 'param1', '\'default\'' ] ]
```

正如你所看到的，一些参数名称消失了，因为 Babel 转译器将它们从函数中删除。如果您要在最新的 NodeJS 中运行它，它会按预期工作（注释结果来自 NodeJS）。

如评论中所述，另一个注意事项是它不适用于内联箭头函数作为默认值。这使得使用 RegExp 提取值变得非常复杂。

请让我知道这是否对您有用！很想听听一些反馈！

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-11-29T23:28:06.723

我已经修改了从*AngularJS*获取的版本，它实现了依赖注入机制以在没有 Angular 的情况下工作。我还更新了`STRIP_COMMENTS`正则表达式以使用`ECMA6`，因此它支持签名中的默认值等内容。

```
var FN_ARGS = /^function\s*[^\(]*\(\s*([^\)]*)\)/m;
var FN_ARG_SPLIT = /,/;
var FN_ARG = /^\s*(_?)(.+?)\1\s*$/;
var STRIP_COMMENTS = /(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,\)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,\)]*))/mg;

function annotate(fn) {
  var $inject,
    fnText,
    argDecl,
    last;

  if (typeof fn == 'function') {
    if (!($inject = fn.$inject)) {
      $inject = [];
      fnText = fn.toString().replace(STRIP_COMMENTS, '');
      argDecl = fnText.match(FN_ARGS);
      argDecl[1].split(FN_ARG_SPLIT).forEach(function(arg) {
        arg.replace(FN_ARG, function(all, underscore, name) {
          $inject.push(name);
        });
      });
      fn.$inject = $inject;
    }
  } else {
    throw Error("not a function")
  }
  return $inject;
}

console.log("function(a, b)",annotate(function(a, b) {
  console.log(a, b, c, d)
}))
console.log("function(a, b = 0, /*c,*/ d)",annotate(function(a, b = 0, /*c,*/ d) {
  console.log(a, b, c, d)
}))
annotate({})
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2017-10-14T17:31:19.400

这个包使用 recast 来创建一个 AST，然后从中收集参数名称，这允许它支持模式匹配、默认参数、箭头函数和其他 ES6 特性。

[https://www.npmjs.com/package/es-arguments](https://www.npmjs.com/package/es-arguments)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-05-19T07:29:59.227

我将在下面给你一个简短的例子：

```
function test(arg1,arg2){
    var funcStr = test.toString()
    var leftIndex = funcStr.indexOf('(');
    var rightIndex = funcStr.indexOf(')');
    var paramStr = funcStr.substr(leftIndex+1,rightIndex-leftIndex-1);
    var params = paramStr.split(',');
    for(param of params){
        console.log(param);   // arg1,arg2
    }
}

test(); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-06-17T18:11:15.023

您可以使用“arguments”属性访问传递给函数的参数值。

```
 function doSomething()
    {
        var args = doSomething.arguments;
        var numArgs = args.length;
        for(var i = 0 ; i < numArgs ; i++)
        {
            console.log("arg " + (i+1) + " = " + args[i]);  
                    //console.log works with firefox + firebug
                    // you can use an alert to check in other browsers
        }
    }

    doSomething(1, '2', {A:2}, [1,2,3]); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-02-01T23:30:51.920

这很容易。

首先有一个不推荐使用`arguments.callee`的——对被调用函数的引用。其次，如果您有对函数的引用，则可以轻松获得它们的文本表示。第三，如果你调用你的函数作为构造函数，你也可以通过 yourObject.constructor 获得一个链接。注意：第一个解决方案已弃用，因此如果您不能不使用它，您还必须考虑您的应用架构。如果您不需要确切的变量名称，只需在函数内部变量中使用，`arguments`无需任何魔法。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/callee](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/callee)

他们都将调用 toString 并用 re 替换，这样我们就可以创建一个助手：

```
// getting names of declared parameters
var getFunctionParams = function (func) {
    return String(func).replace(/[^\(]+\(([^\)]*)\).*/m, '$1');
} 
```

一些例子：

```
// Solution 1\. deprecated! don't use it!
var myPrivateFunction = function SomeFuncName (foo, bar, buz) {
    console.log(getFunctionParams(arguments.callee));
};
myPrivateFunction (1, 2);

// Solution 2.
var myFunction = function someFunc (foo, bar, buz) {
    // some code
};
var params = getFunctionParams(myFunction);
console.log(params);

// Solution 3.
var cls = function SuperKewlClass (foo, bar, buz) {
    // some code
};
var inst = new cls();
var params = getFunctionParams(inst.constructor);
console.log(params); 
```

与 JS 一起享受吧！

UPD：实际上，Jack Allan 得到了更好的解决方案。GJ杰克！

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-06-17T19:14:14.953

这是一种方法：

```
// Utility function to extract arg name-value pairs
function getArgs(args) {
    var argsObj = {};

    var argList = /\(([^)]*)/.exec(args.callee)[1];
    var argCnt = 0;
    var tokens;
    var argRe = /\s*([^,]+)/g;

    while (tokens = argRe.exec(argList)) {
        argsObj[tokens[1]] = args[argCnt++];
    }

    return argsObj;
}

// Test subject
function add(number1, number2) {
    var args = getArgs(arguments);
    console.log(args); // ({ number1: 3, number2: 4 })
}

// Invoke test subject
add(3, 4); 
```

注意：这仅适用于支持`arguments.callee`.

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-05-19T10:02:35.380

无论解决方案如何，它都不能破坏`toString()`看起来很奇怪的奇怪函数：

```
function  (  A,  b
,c      ,d
){} 
```

![控制台截图](../Images/0655b7bbb7154eecc058d74f6842349b.png)

另外，为什么要使用复杂的正则表达式？这可以像这样完成：

```
function getArguments(f) {
    return f.toString().split(')',1)[0].replace(/\s/g,'').substr(9).split(',');
} 
```

这适用于每个函数，唯一的正则表达式是空格删除，由于这个`.split`技巧，它甚至不处理整个字符串。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-01-05T22:47:47.747

注意：如果您想在顶级解决方案中使用 ES6 参数解构，请添加以下行。

```
if (result[0] === '{' && result[result.length - 1 === '}']) result = result.slice(1, -1) 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-08-03T10:35:55.800

好的，这是一个老问题，有很多足够的答案。这是我不使用正则表达式的产品，除了剥离空白的琐碎任务。（我应该注意到“strips_comments”函数实际上将它们隔开，而不是物理删除它们。那是因为我在其他地方使用它并且由于各种原因需要原始非注释标记的位置保持不变）

这是一个相当长的代码块，因为此粘贴包含一个迷你测试框架。

```
 function do_tests(func) {

    if (typeof func !== 'function') return true;
    switch (typeof func.tests) {
        case 'undefined' : return true;
        case 'object'    : 
            for (var k in func.tests) {

                var test = func.tests[k];
                if (typeof test==='function') {
                    var result = test(func);
                    if (result===false) {
                        console.log(test.name,'for',func.name,'failed');
                        return false;
                    }
                }

            }
            return true;
        case 'function'  : 
            return func.tests(func);
    }
    return true;
} 
function strip_comments(src) {

    var spaces=(s)=>{
        switch (s) {
            case 0 : return '';
            case 1 : return ' ';
            case 2 : return '  ';
        default : 
            return Array(s+1).join(' ');
        }
    };

    var c1 = src.indexOf ('/*'),
        c2 = src.indexOf ('//'),
        eol;

    var out = "";

    var killc2 = () => {
                out += src.substr(0,c2);
                eol =  src.indexOf('\n',c2);
                if (eol>=0) {
                    src = spaces(eol-c2)+'\n'+src.substr(eol+1);
                } else {
                    src = spaces(src.length-c2);
                    return true;
                }

             return false;
         };

    while ((c1>=0) || (c2>=0)) {
         if (c1>=0) {
             // c1 is a hit
             if ( (c1<c2) || (c2<0) )  {
                 // and it beats c2
                 out += src.substr(0,c1);
                 eol = src.indexOf('*/',c1+2);
                 if (eol>=0) {
                      src = spaces((eol-c1)+2)+src.substr(eol+2);
                 } else {
                      src = spaces(src.length-c1);
                      break;
                 }
             } else {

                 if (c2 >=0) {
                     // c2 is a hit and it beats c1
                     if (killc2()) break;
                 }
             }
         } else {
             if (c2>=0) {
                // c2 is a hit, c1 is a miss.
                if (killc2()) break;  
             } else {
                 // both c1 & c2 are a miss
                 break;
             }
         }

         c1 = src.indexOf ('/*');
         c2 = src.indexOf ('//');   
        }

    return out + src;
}

function function_args(fn) {
    var src = strip_comments(fn.toString());
    var names=src.split(')')[0].replace(/\s/g,'').split('(')[1].split(',');
    return names;
}

function_args.tests = [

     function test1 () {

            function/*al programmers will sometimes*/strip_comments_tester/* because some comments are annoying*/(
            /*see this---(((*/ src//)) it's an annoying comment does not help anyone understand if the 
            ,code,//really does
            /**/sucks ,much /*?*/)/*who would put "comment\" about a function like (this) { comment } here?*/{

            }

        var data = function_args(strip_comments_tester);

        return ( (data.length==4) &&
                 (data[0]=='src') &&
                 (data[1]=='code') &&
                 (data[2]=='sucks') &&
                 (data[3]=='much')  );

    }

];
do_tests(function_args); 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-10-23T18:37:58.980

我想建议支持箭头函数的解决方案，例如我将本文用于基本正则表达式和[https://davidwalsh.name/javascript-arguments](https://davidwalsh.name/javascript-arguments)并添加了箭头函数支持

```
(arg1,arg2) => {} 
```

或者

```
arg => {}

function getArgs(func) {
  if(func.length === 0){
      return []
  }

  let string = func.toString();

  let args;
  // First match everything inside the function argument parens. like `function (arg1,arg2) {}` or `async function(arg1,arg2) {}

  args = string.match(/(?:async|function)\s*.*?\(([^)]*)\)/)?.[1] ||
      // arrow functions with multiple arguments  like `(arg1,arg2) => {}`
         string.match(/^\s*\(([^)]*)\)\s*=>/)?.[1] ||
      // arrow functions with single argument without parens like `arg => {}`
         string.match(/^\s*([^=]*)=>/)?.[1]

  // Split the arguments string into an array comma delimited.
  return args.split(',').map(function(arg) {
    // Ensure no inline comments are parsed and trim the whitespace.
    return arg.replace(/\/\*.*\*\//, '').trim();
  }).filter(function(arg) {
    // Ensure no undefined values are added.
    return arg;
  });
} 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2015-07-29T06:25:54.390

**函数参数字符串值图像动态来自 JSON**。由于 item.product_image2 是一个 URL 字符串，因此在参数内部调用 changeImage 时需要将其放在引号中。

我的功能 Onclick

```
items+='<img src='+item.product_image1+' id="saleDetailDivGetImg">';
items+="<img src="+item.product_image2+"  onclick='changeImage(\""+item.product_image2+"\");'>"; 
```

我的功能

```
<script type="text/javascript">
function changeImage(img)
 {
    document.getElementById("saleDetailDivGetImg").src=img;
    alert(img);
}
</script> 
```

* * *

## 回答 #33

> 赞同：-18
> 
> 时间：2019-01-15T16:44:09.283

手动尝试：

```
function something(arg1, arg2) {
  console.log ( arg1 + arg2 );
} 
```

# asp.net - ASP.NET ReportViewer 本地模式性能（expression_host 重新生成）

> ID：1007986
> 
> 赞同：0
> 
> 时间：2009-06-17T15:57:43.747
> 
> 标签：asp.net, reportviewer

我有一个简单的 ASP.NET Web 表单，其中有几个在本地模式下运行的 ReportViewer 控件。每次页面加载时，每个 ReportViewer 都会加载报表定义并重新生成动态 expression_host 程序集。这显然很耗时，并且不会很好地扩展。有没有办法让 ReportViewer 缓存报表定义和动态 expression_host 程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T13:58:59.367

问题是在报表查看器对象上调用重置。您将需要缓存报表查看器。

如果您使用对象作为数据源，还请在 report.localreport.dataset 上调用 Clear。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T11:06:22.780

在尝试了各种方法之后，到目前为止，该问题的最佳解决方法是从报告本身中删除所有代码。这样做之后，请求时间大大减少了。

# asp.net - 无法使 Click 事件在 modalPopupExtender 内正常工作

> ID：1007987
> 
> 赞同：0
> 
> 时间：2009-06-17T15:57:49.707
> 
> 标签：asp.net, visual-studio-2008, ajaxcontroltoolkit, modalpopupextender

我有一个使用 jQuery 的 .load 函数加载子页面的页面......

我的子页面有一些按钮可以与数据库服务器进行一些数据交换，并且它们中的大多数都运行良好。

问题是某些按钮位于 ModalPopupExtenders (ajaxtoolkit) 中。当我单独运行子页面（在父页面之外）时，modalpopup 和它的按钮工作得很好。但是当页面在父页面中“加载”时不是这样。

问题和我尝试过的：

*   如果我将 modalPopupExtender 设置为没有 OkControlID 并将 div 内的 Ok 按钮设置为运行它自己的事件，它通常会触发 click 函数，但之后 modalpopup div 将永远在页面中保持可见（不是以弹出方式，只是可见的）。

*   如果我将 modalPopupExtender 设置为具有 OkControlID 和 OnOkScript，我就无法使按钮触发 OkScript ...

要显示的整个 DIV 在更新面板中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T21:32:10.120

如果在 ModalPopupExtenders 控件中设置 BehaviorID，则可以使用 JQuery 显示/隐藏模式弹出窗口。

例如

```
$find("behaviorid").show()
$find("behaviorid").hide() 
```

在这种情况下，您不需要设置 OkControlID。按钮单击事件完成后，只需调用 $find("behaviorid").hide()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T17:20:36.487

就我而言，我在用户控件中有 modalpopupextender。我加载了用户控件动态和该用户控件的多个实例，这意味着我有多个动态加载的modalpopupextender实例。如何设置 behaviorid 以便我可以调用 .add_shown 方法在模态弹出加载时调用一些 javascript？