# StackOverflow 问答 1017000-1017999

# jsf - 使用 JSF 框架验证多个字段的最佳方法是什么？

> ID：1017003
> 
> 赞同：0
> 
> 时间：2009-06-19T09:03:43.607
> 
> 标签：jsf

我需要验证 JavaScript 框架中的多个字段，但不知道如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T09:33:07.557

您需要什么样的验证？

*   **客户端**：您必须使用 Javascript 验证框架。例如，这[是](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)一个很好的使用 jQuery 的验证框架。
*   **服务器端**：您只需要使用`<f:validateXXX/>`组件。例如，`<f:validateLength minimum="2" maximum="8"/>`将检查该字段是否包含大小在 2 到 8 个字符之间的值。否则会抛出异常。请注意，默认情况下有一些验证器，您将无法验证电子邮件地址或类似的东西。但是，开发自己的验证器真的很容易......
*   **服务器端，使用 Ajax**。这和前一种验证几乎是一样的，只不过验证是*ajaxified*，这意味着一旦用户填写了一个字段，就会向服务器发送一个请求，然后对该字段进行验证。这对于动态检查值很有*用*。组件库**Richfaces**提供了这样[的功能](http://livedemo.exadel.com/richfaces-demo/richfaces/ajaxValidator.jsf)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T13:56:01.550

JSF 具有可用于简单验证的验证框架。像强制、长度、格式等。此外，它允许您编写自定义验证器，一旦在 myfaces 文件中配置，就会调用这些验证器进行字段验证。

还可以将一堆字段分组到“子表单”中，这样​​您就可以一次验证多个字段。无需提交页面的无缝验证将需要 Ajax 集成。（Richfaces 是一个不错的选择）

# arduino - 创建网络适配器 - 有多难？

> ID：1017005
> 
> 赞同：3
> 
> 时间：2009-06-19T09:05:11.280
> 
> 标签：arduino, ethernet

我有兴趣在[Arduino](http://www.arduino.cc/)之上构建一个小型（商业）设备。我希望它能够与网络连接。网络如标准以太网、Cat5、RJ-45 等。

我知道有一个[Ethernet Shield](http://arduino.cc/en/Main/ArduinoEthernetShield)，但它的成本甚至比 Arduino 本身还要高，而且相当大。自然，我希望我的设备尽可能小且尽可能便宜。

所以我正在考虑自己重新创建一个以太网模块。问题是——我对以太网没有任何经验，也不知道从哪里开始寻找。因此，我什至不能说我的想法是否可行。

最终，我希望该设备具有三个端口 - 一个用于输入信号，两个用于输出，因此该设备本质上是一个小开关，它也可以插入其中。切换能力不需要非常快——数据量会很低。10Mbit绰绰有余，甚至可以更慢。

如果这是不可能的，用于控制设备本身的单个端口也可以。

我正在考虑的另一种可能性是电力线通信——通过电力线发送信息。这是我没有经验的另一个领域。我应该查看哪些硬件，在哪里可以找到有关必要软件的信息？

那么 - 谁能告诉我这些想法是否可行，如果是的话 - 我应该从哪里开始寻找？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T09:12:37.487

这是可行的，但您需要深入研究网络堆栈的第 2 层，特别是如果您想构建一个微型交换机。如果您避开第 3 层，您可以避免实现自己的 IP 堆栈，这将是一个主要的痛苦。

我建议从完全了解第 2 层的工作原理开始，从上到下。一旦你对正在发生的事情有了充分的了解，尤其是关于以太网规范，那么你就可以担心如何在 Arduino 上做这件事了。我对 Arduino 没有太多经验，但我的一个朋友几周前在 FPGA 上实现了第 2 层硬件停止和等待协议，所以你至少应该能够得到一些滚动。不过，除非你有一个相当快的时钟，否则你可能无法超过 10 Mbit。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-30T11:13:37.100

First of all I wouldn't think about the powserline technology is too complex, may be wi-fi can be possible, even though you have to deal with microwave frequency.

The best solution is as you said to find an Ethernet Shield, try to find an open hardware solution (drawing of the circuit). If you want to deal your own, you have to fnid a chip and threre are available, have a look on RS components. Probably most of the chips available are SMD, which means that is a pain to solder them, unless you are pretty clever and you have a microscope.

You can find a chip or a ready made solution here; [http://www.beyondlogic.org/etherip/ip.htm](http://www.beyondlogic.org/etherip/ip.htm)

You could switch to Rabbit semiconductors, they have microcontroller ready with ethernet, but the dev kit is more expensive and the programming too.

This is a chip that you can use; [http://www.wiznet.co.kr/en/pro02.php?&ss[2]=1&page=1&num=102](http://www.wiznet.co.kr/en/pro02.php?&ss[2]=1&page=1&num=102)

# sql - SQL 错误处理

> ID：1017006
> 
> 赞同：2
> 
> 时间：2009-06-19T09:05:18.783
> 
> 标签：sql, sql-server

你能告诉我错误处理是否值得放入这个存储过程中？

```
-- **********************************************
-- Delete and create a new 'Truncate' function...
-- **********************************************

IF EXISTS(SELECT name 
          FROM   sysobjects 
          WHERE  name = 'truncate_description' AND 
                 type = 'FN')
  DROP FUNCTION truncate_description
GO

CREATE FUNCTION truncate_description(@description varchar(1000), @numchars int=500) RETURNS varchar(500)
BEGIN
  DECLARE @newDescription varchar(500);
  DECLARE @truncMessage varchar(33);
  SET @truncMessage = '..Click on title to read article.';

  IF (len(@description) >= @numchars)
    IF (substring(@description, @numchars, 1) = '.')
      SET @newDescription = @description;
    ELSE
    BEGIN
      SET @newDescription = substring(@description, 1, @numchars - len(@truncMessage));
      IF (charindex('.', @newDescription) > 0)
      BEGIN
        WHILE (substring(@newDescription, len(@newDescription), 1) <> '.')
        BEGIN
          SET @newDescription = substring(@newDescription, 1, len(@newDescription) - 1);
        END
      END
      SET @newDescription = @newDescription + @truncMessage;
    END
  ELSE
    SET @newDescription = @description;

  RETURN @newDescription;
END
GO

-- *********************************************
-- Delete and create a new 'Truncate' trigger...
-- *********************************************

IF EXISTS(SELECT name 
          FROM   sysobjects 
          WHERE  name = 'tr_tblProfile_truncateDescription' AND 
                 type = 'TR') 
  DROP TRIGGER tr_tblProfile_truncateDescription;
GO

CREATE TRIGGER tr_tblProfile_truncateDescription ON tbl_profile
AFTER INSERT, UPDATE AS
BEGIN
  UPDATE tbl_profile 
  SET description = dbo.truncate_description(i.description, 500)
  FROM tbl_profile p INNER JOIN inserted i on p.id=i.id
END
GO

-- ******************************************
-- Run the trigger on all existing records...
-- ******************************************

UPDATE tbl_Profile
SET description = description
GO 
```

非常感谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:22:44.300

首先 - 它是一个函数，而不是一个存储过程。

但是错误处理总是好的——但是 SQL 函数可能不是放置它的最佳位置。

考虑到这个函数适用于已知的模式和已知的数据格式（varchar）以及已知的 SQL 函数（len、substring）......您应该能够对此进行单元测试并考虑它可能抛出的任何错误作为函数本身的外在。

这让我倾向于否定的答案，不要在这里处理错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T15:34:06.703

在我看来，在你的 T-SQL 编码中实现自定义错误处理是一个很好的实践，如果不是必要的实践的话。

如果您要开发的存储过程/函数是应用程序中间层的一部分，那么我建议您实现自己的自定义错误处理。

我的意思是，您应该提出特定于应用程序进程生成的环境的错误，并将这些错误记录在适当数据库中的通用错误日志表中。

可以在 SQL Server 联机丛书中找到如何执行此操作并将其合并到典型 try catch 块中的示例。

特别是标题为：Adventure Works 数据库中的错误处理解决方案的部分

[http://msdn.microsoft.com/en-us/library/ms179296(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms179296(SQL.90).aspx)

# java - 在插入时混合参数化查询和子查询

> ID：1017008
> 
> 赞同：0
> 
> 时间：2009-06-19T09:06:06.410
> 
> 标签：java, sql, sybase

我有一位同事想尝试以下查询：

```
INSERT INTO table (ColumnA, ColumnB, ColumnC)
VALUES (?, (SELECT Id FROM ColumnD WHERE x=y), ?) 
```

Sybase 对此抱怨，因为它似乎不允许在查询的 VALUES 部分中使用子查询。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T09:14:44.987

怎么样：

```
INSERT INTO table (ColumnA, ColumnB, ColumnC)
SELECT
  ?,
  Id,
  ?
FROM
  TableD
WHERE
  x = y 
```

（或类似）

# sharepoint - 如何在 WSS 2.0 中管理列表版本历史

> ID：1017009
> 
> 赞同：0
> 
> 时间：2009-06-19T09:06:07.097
> 
> 标签：sharepoint

我知道 WSS 2.0 已经过时，但它仍在使用中，就我而言，我仍然需要继续努力。有没有办法为 WSS 2.0 中的自定义列表启用版本历史记录？我找不到任何关于此的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T10:18:58.603

在 WSS 2.0 中，唯一适用于文档的版本历史功能。在 WSS 3.0 中，MS 对此进行了扩展以涵盖其他类型的列表（包括自定义列表）。

我不知道这个版本可以做什么，但是您可以使用 WSS 2.0 中的事件处理程序开发自己的解决方案。然而，这个功能在那个版本中也非常有限。

由于 WSS 是免费的，您为什么不研究并考虑升级到 WSS 3.0？这将解决这些问题并为您提供更多功能。

# nhibernate - NHibernate、ActiveRecord、事务数据库锁以及何时刷新提交

> ID：1017012
> 
> 赞同：2
> 
> 时间：2009-06-19T09:06:39.543
> 
> 标签：nhibernate, activerecord, nhprof

这是一个常见的问题，但到目前为止发现的解释和观察到的行为有一定的差距。

我们希望在我们的 MVC 网站中使用以下 nHibernate 策略：

*   A`SessionScope`用于请求（跟踪更改）
*   仅包装我们的`ActiveRecord.TransactonScope`插入（以启用批处理的回滚/提交）
*   选择在事务之外（以减少锁定范围）
*   插入的延迟刷新（以便我们的插入/更新在会话结束时作为 UoW 发生）

现在我们：

*   不要从`SessionScope`（使用 FlushAction Auto 或 Never）获取隐含事务
*   如果我们使用`ActiveRecord.TransactionScope`，则不会延迟刷新，并且任何包含的选择也会陷入长时间运行的事务中。

我想知道是不是因为我们有一个旧版本的 nHibernate（它来自非常接近 2.0 的主干）。

我们只是无法获得预期的 nHibernate 行为，而且性能很差（使用 NHProf 和 SqlProfiler 来监控数据库锁）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-27T11:51:07.290

这是我们从那以后尝试过的：

*   编写我们自己的 TransactionScope（继承自 ITransactionScope）：
    *   `ActiveRecord.TransactionScope`在**Commit**上打开一个，而不是在`ctor`（延迟事务直到需要）
    *   在没有可用的情况下打开“SessionScope” `ctor`（作为警卫）
*   将我们的 id 从身份转换为 Guid
    *   这停止了​​事务的`insert`/外部的自动刷新（！）`update`

现在我们有以下应用程序行为：

*   来自 MVC 的请求
    *   `SELECT`服务所需的 s 被触发，全部在事务之外
    *   `Repository.Add``scope.Commit`在我们的控制器中调用之前，调用不会命中数据库
    *   所有`INSERT`s / `UPDATE`s 都作为原子单元包装在事务中，不`SELECT`包含任何 s。

...但是由于某种原因，现在 nHProf ！= sqlProfiler （`select`s 似乎在 nHProf 报告它之前发生在数据库中）。

**注意** 在我被激怒之前，我意识到这里的问题，并且知道 SELECT 不在事务中。这就是设计。`TransactionScope`我们的一些操作将在序列化事务中包含 SELECT（我们现在有几个自己的实现）。我们的绝大多数代码都不需要最新的实时数据，并且我们已经对各个操作员进行了序列化工作负载。

**另外，如果有人知道如何在`insert`无需手动刷新实体的情况下刷新身份列（非 PK），尤其是通过使用 ActiveRecord 标记（我认为在 nHibernate 映射文件中使用“生成”属性是可能的**）****请**告诉我！！**

# c# - Winforms RichTextBox 页面大小？

> ID：1017016
> 
> 赞同：1
> 
> 时间：2009-06-19T09:07:15.050
> 
> 标签：c#, winforms, richtextbox

当我在写字板（或 Word）中查看文档时，文本是环绕文档边界的单词。当我在 RichTextBox 中使用 RTF 字符串时，文本会环绕在控件边框周围。这意味着当我更改窗口大小时，自动换行会发生变化。

我能做些什么吗？（我必须将 RichTextBox 设置为某种模式）

或者是否有免费/商业的 RichTextBox 可以做到这一点？

（以前你可以下载我所做的写字板源代码 - 但我无法让它运行 - 这是正确的版本 - 或者这对我有帮助吗？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T09:47:21.880

您可以使用 RightMargin 属性来控制它。你必须弄清楚你想要的宽度是多少，以像素为单位。默认为 0，表示跟随控件。

附加：如果您只需要 ReadOnly 视图，您可以使用 PrintPreview 控件。请参阅[这篇文章](http://support.microsoft.com/kb/812425)，了解如何使页面过渡正常工作。

# erlang - 学习 Erlang 的最佳方法是什么？

> ID：1017017
> 
> 赞同：74
> 
> 时间：2009-06-19T09:07:52.333
> 
> 标签：erlang

除了特定项目（尽管也欢迎这些项目）......

我的办公桌上应该有哪些**工具、书籍、文章和其他资源来帮助我学习 Erlang？**

另外，是否有适用于 Erlang 的移动运行时？

请指出我正确的方向。

注意：是的，我访问过 Erlang 和 Wikipedia，但我想听听一些可靠的、有经验的意见。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-06-19T10:18:38.137

我已经学习了一个月左右，我最喜欢的指南是：

*   Erlang 网站的 Erlang[入门](http://www.erlang.org/doc/getting_started/users_guide.html)指南
*   乔·阿姆斯特朗 (Joe Armstrong) 的并发世界图书[软件](http://www.pragprog.com/titles/jaerlang/programming-erlang)（强烈推荐）
*   我已经订购了：O'Reilly 的[Erlang Programming](http://oreilly.com/catalog/9780596518189/)，它得到了一些非常积极的评价，听起来像是 Joe Armstrong 的书的好伴侣（更深入地涵盖了许多相同的主题，可能还有更多“真实世界”的例子）

我认为您可以立即深入了解入门指南，它肯定会让您对函数式编程和并发有所了解。

如果你今年 6 月在伦敦，那么[Erlang Factory](http://www.erlang-factory.com)会议看起来真的很棒。

虽然我记得，这是两个很好的演示文稿，带您了解 Erlang 及其用途：

*   [用 Erlang 思考](http://www.scribd.com/doc/44221/Thinking-in-Erlang)
*   [函数 + 消息 + 并发 = Erlang](http://www.infoq.com/presentations/joe-armstrong-erlang-qcon08)

[最后，你可以在我的博客（ joelhughes.co.uk/blog](http://www.joelhughes.co.uk/blog) ）上关注我的学习心得，我[从python/ruby/php到Erlang](http://www.joelhughes.co.uk/blog/2009/05/erlang-fizzbuzz-showdown-pt-1/)的FizzBu​​zz一步步调整，可能会给你一个好味道（对不起无耻的自我推销）。

不得不说，学习 Erlang 是我目前最大的乐趣之一，其中有一些非常令人满意的东西！

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-09-15T02:55:24.710

对于初学者来说，“ [Learn you some Erlang](http://learnyousomeerlang.com/) ”指南非常棒。它目前还不完整，但提供了很多，即使那里很少。

它还具有 RSS，因此您可以在（如果？）更新时收到通知。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T14:59:32.170

我发现学习 erlang 最好的方法是阅读 joe 的论文 [http://www.sics.se/~joe/thesis/armstrong_thesis_2003.pdf](http://www.sics.se/~joe/thesis/armstrong_thesis_2003.pdf) ，然后写一些我喜欢的东西，对我来说它是一个 iax2 服务器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-19T09:09:33.797

我可以建议您**不要**浏览[*Wings3d*源代码](https://github.com/dgud/wings)。

（我做到了，这与我尝试阅读[Quake2 源](ftp://ftp.idsoftware.com/idstuff/source/quake2.zip)代码时类似：-p）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-07-12T20:22:06.127

我有 Erlang Progamming 和 Software for a Concurrent World，两者都很棒。我几乎可以说 Erlang Programming 更好，它展示了更多关于使用 OTP（Erlang 库）的内容，但是当我阅读它时，我对这门语言也更加熟悉了，所以这就是我所寻找的。

Erlang 入门指南也很不错。

当然，您应该尝试编写一个简单的服务器。这是 Erlang 真正闪耀的领域之一，有大量关于消息传递和 gen_server 模块的文档和教程。

- 编辑

此外，您当然可以在基于 ARM 的移动设备（ARMv5+）上运行 Erlang，您可以询问其他架构的 erlang-questions。查看[http://wiki.trapexit.org/index.php/Cross_compiling](http://wiki.trapexit.org/index.php/Cross_compiling)了解开始使用交叉编译的基础知识。

# sql-server - 在不指定事务的情况下执行 SQLCommand

> ID：1017018
> 
> 赞同：5
> 
> 时间：2009-06-19T09:07:58.590
> 
> 标签：sql-server, transactions, sqlcommand

我们有一些数据列表通过 SqlCommand`SELECT`在 SQL Server 数据库上执行查询在我们的应用程序中获取。我们没有在 SqlCommand 上显式设置事务，而只是将 SqlConnection 传递给它并运行它。是否在没有指定事务时 SQL Server 将启动并使用默认 IsolationLevel 的默认事务`ReadCommitted`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T09:52:13.633

SQL 为您的语句隐式创建一个事务，并在语句完成时提交该事务。此事务的隔离级别将是当前的隔离级别，默认为 READ COMMITTED。某些语句会覆盖当前的隔离级别并强制执行 READ COMMITTED（例如 RECEIVE）。

如果您的 SqlCommand 执行批处理（更多语句），则访问表的每个语句都将创建自己的事务。

[事务](http://msdn.microsoft.com/en-us/library/ms187878.aspx)的默认自动提交是通过更改 SET IMPLICIT_TRANSACTION ON 来控制的。

有关更多详细信息，请参阅[控制事务](http://msdn.microsoft.com/en-us/library/ms175523.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T09:25:22.300

SQL Server 可以在没有显式事务的情况下愉快地工作。但是，是的，我相信它本质上是读提交的（当然，除非您向查询对象添加额外的提示，例如`UPDLOCK`/ `NOLOCK`）。您可以通过以下方式对此进行调查：

```
DBCC USEROPTIONS 
```

其中显示（除其他外）：

```
isolation level read committed 
```

# java - Maven 程序集插件因 NullPointerException 而失败？

> ID：1017019
> 
> 赞同：2
> 
> 时间：2009-06-19T09:08:51.270
> 
> 标签：java, maven-2, build, nullpointerexception

我得到一个 NullPointerException 并且我不喜欢它。它是一个较大的构建，包含几个子模块（它们的 Maven 配置仅略有不同），对于大多数模块它确实有效，但对于某些模块无效。任何想法可能是什么问题？

```
[INFO] [assembly:assembly]
[INFO] Reading assembly descriptor: src/assemble/all.xml
[INFO] ------------------------------------------------------------------------
[ERROR] FATAL ERROR
[INFO] ------------------------------------------------------------------------
[INFO] null
[INFO] ------------------------------------------------------------------------
[INFO] Trace
java.lang.NullPointerException
at org.apache.maven.artifact.DefaultArtifact.equals(DefaultArtifact.java:358)
at java.util.HashMap.put(HashMap.java:376)
at java.util.HashSet.add(HashSet.java:200)
at java.util.AbstractCollection.addAll(AbstractCollection.java:305)
at org.apache.maven.plugin.assembly.artifact.DefaultDependencyResolver.buildManagedVersionMap(DefaultDependencyResolver.java:160)
at org.apache.maven.plugin.assembly.archive.DefaultAssemblyArchiver.createArchive(DefaultAssemblyArchiver.java:179)
at org.apache.maven.plugin.assembly.mojos.AbstractAssemblyMojo.execute(AbstractAssemblyMojo.java:370)
at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:483)
at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:678)
at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeStandaloneGoal(DefaultLifecycleExecutor.java:553)
at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:523)
at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:371)
at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:268)
at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:181)
at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:356)
at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:137)
at org.apache.maven.cli.MavenCli.main(MavenCli.java:356)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
at org.codehaus.classworlds.Launcher.main(Launcher.java:375)
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 41 seconds
[INFO] Finished at: Fri Jun 19 10:44:03 CEST 2009
[INFO] Final Memory: 32M/99M
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T09:14:14.333

查看头部修订的第 358 行，我的猜测是，某处没有定义版本。

我并不真正“了解” Maven，但我建议仔细检查您的版本。当然，我可能没有查看与您使用的源代码相同的源代码 - 查看您的实际版本的源代码，以了解 DefaultArtifact.java 第 358 行的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-29T14:02:01.233

如果版本不像 Jon-skeet 建议的那样为空，则可能是 maven-enforcer-plugin 错误： [https ://issues.apache.org/jira/browse/MENFORCER-156](https://issues.apache.org/jira/browse/MENFORCER-156)

本质上，maven-enforcer-plugin（至少在 1.3 版中）“将其`MavenProject`置于声称已解决所有依赖项但工件文件未绑定的状态。”

对我来说，这在 1.4.1 版中再次出现。

# delphi - 构建服务器：管理第三方组件的最佳实践？

> ID：1017023
> 
> 赞同：10
> 
> 时间：2009-06-19T09:10:24.310
> 
> 标签：delphi, build-automation, project-organization

我正在维护一个相当大的遗留应用程序。源代码树真是一团糟。我正在尝试设置构建服务器。

在源代码树上，我有带有源代码的第三方组件（也在项目的包含路径中）。这些组件也安装在 IDE 中。

我的问题是：如何管理这些组件？

我想以这种方式管理：

*   在构建服务器上安装 IDE
*   安装所有第三方组件
*   从项目源树中删除组件源（并将它们保存在项目根目录中的每个压缩的专用文件夹中）
*   每次我们需要自定义（或调试）第三方组件时，我们都会重新构建包并将其重新安装在构建服务器的 IDE 中（以及每个开发人员工作站上）

在 IDE 中安装组件和在包含路径中安装源代码有什么区别？链接器如何处理这种情况？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-19T09:58:54.103

### 我们已经使用简单的命令文件设置了我们的日常构建。

1.  每个项目 (.dpr) 都有一个关联的 Build.cmd 文件。
2.  所有 Build.cmd 文件都是从我们的主 BuildServerRun.cmd 文件中调用的。

### BuildServerRun.cmd 文件负责

1.  删除构建服务器上的整个源代码树。
2.  从我们的源代码控制存储库获取最新版本。
3.  调用每个 Build.cmd 并将输出通过管道传输到文件。
4.  将结果邮寄给所有开发人员。

### 外部组件的所有路径都在 dcc32.cfg 文件中配置

```
..    
-u"c:\Program files\Developer Express Inc\ExpressInplaceEditors\Delphi 5\Lib"
-u"c:\Program files\Developer Express Inc\ExpressQuantumGrid\Delphi 5\Lib"
..
-r"c:\Program Files\Borland\Delphi5\Lib"
-r"C:\Program Files\jvcl\jvcl\resources"
..
-i"C:\Program Files\jvcl\jvcl\run"
-i"C:\Program Files\jvcl\jcl\source" 
```

* * *

### Build.cmd 示例。

注意：我们有一个策略来编译到 bin\dcu，exe 到 bin，因此是 -N，-E 指令。

```
@echo on
dcc32speed -B -Q -W -H -Nbin\dcu -Ebin BpABA.dpr
@echo off 
```

### 截断的 BuildServerRun.cmd 示例

```
SET %Drive%=E:

:BuildServer
REM *************************************************
REM     Clear files
REM *************************************************
ECHO. > "%Temp%\BuildLieven.txt"
ECHO. > "%Temp%\TestRunLieven.txt"

REM *************************************************
REM     Set start time
REM *************************************************
echo | TIME | FIND "Huidige tijd" > "%Temp%\ResultLieven.txt"

REM *************************************************
REM     Get latest versions
REM *************************************************
IF %LatestVersion%==1 CALL %Drive%\buildserver\latestversion.cmd
ECHO "Latest versions opgehaald" >> "%Temp%\ResultLieven.txt"

REM *************************************************
REM     Build projects
REM *************************************************
CD %Drive%\Projects\

ECHO ***************************************************************** >> "%Temp%\BuildLieven.txt"
ECHO BpABA >> "%Temp%\BuildLieven.txt"
ECHO ***************************************************************** >> "%Temp%\BuildLieven.txt"
CD %Drive%\Projects\BPABA\production
ECHO Building BPABA\production
CALL Build.cmd >> "%Temp%\BuildLieven.txt"
CD %Drive%\Projects\BPABA\test
ECHO Building BPABA\test
CALL Build.cmd >> "%Temp%\BuildLieven.txt"
CD %Drive%\Projects\BPABA\test\dunit
ECHO Building BPABA\test\dunit
CALL Build.cmd >> "%Temp%\BuildLieven.txt"
ECHO BPABATests >> "%Temp%\TestRunLieven.txt"
ECHO Running BPABATests
CALL bin\BPABATests >> "%Temp%\TestRunLieven.txt"
CD %Drive%\Projects
ECHO. >> "%Temp%\BuildLieven.txt"
ECHO. >> "%Temp%\BuildLieven.txt"
ECHO. >> "%Temp%\BuildLieven.txt"

REM *****************************************************************
REM     Gather (Fatal)Errors/Hints/Warnings & Failures
REM *****************************************************************
ECHO ***************************************************************** >> "%Temp%\ResultLieven.txt"
ECHO (Fatal)Errors/Hints/Warnings en Failures >> "%Temp%\ResultLieven.txt"
ECHO ***************************************************************** >> "%Temp%\ResultLieven.txt"
ECHO Fatal errors during build >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND /c "Fatal:" >> "%Temp%\ResultLieven.txt"

ECHO Errors during build >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND /c "Error:" >> "%Temp%\ResultLieven.txt"

ECHO Warnings during build >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND /c "Warning:" >> "%Temp%\ResultLieven.txt"

ECHO Hints during build >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND /c "Hint:" >> "%Temp%\ResultLieven.txt"

ECHO Failures during test >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\TestRunLieven.txt" | FIND /c "Failures:" >> "%Temp%\ResultLieven.txt"
ECHO. >> "%Temp%\ResultLieven.txt"

ECHO ***************************************************************** >> "%Temp%\ResultLieven.txt"
ECHO Controle #Projecten = #Compiles >> "%Temp%\ResultLieven.txt"
ECHO ***************************************************************** >> "%Temp%\ResultLieven.txt"
ECHO #Projecten >> "%Temp%\ResultLieven.txt"
TYPE "%Drive%\buildserver\buildserverrun.cmd" | FIND /i "cmd >> " | FIND /i "Lieven" | FIND /i /v /c "FIND /i /v /c" >> "%Temp%\ResultLieven.txt"
ECHO #Compiles >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\buildLieven.txt" | FIND /i /c "dcc32" >> "%Temp%\ResultLieven.txt"
ECHO #Tests expected to run >> "%Temp%\ResultLieven.txt"
TYPE "%Drive%\buildserver\buildserverrun.cmd" | FIND /i "TestRunLieven" | FIND /i "CALL" | FIND /i /v /c "FIND /i /v /c" >> "%Temp%\ResultLieven.txt"
ECHO #Tests actually run >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\TestRunLieven.txt" | FIND /i /c "DUnit / Testing" >> "%Temp%\ResultLieven.txt"
ECHO. >> "%Temp%\ResultLieven.txt"
ECHO. >> "%Temp%\ResultLieven.txt"

ECHO ***************************************************************** >> "%Temp%\ResultLieven.txt"
ECHO Detail (Fatal)Errors/Hints/Warnings en Failures >> "%Temp%\ResultLieven.txt"
ECHO ***************************************************************** >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND "Fatal:" >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND "Error:" >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND "Warning:" >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\BuildLieven.txt" | FIND "Hint:" >> "%Temp%\ResultLieven.txt"
TYPE "%Temp%\TestRunLieven.txt" | FIND "Failures:" >> "%Temp%\ResultLieven.txt"

REM *************************************************
REM     Set stop time
REM *************************************************
ECHO | TIME | FIND "Huidige tijd" >> "%Temp%\ResultLieven.txt"

REM *************************************************
REM     Send results
REM *************************************************
CALL %drive%\buildserver\Blat.cmd 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T10:25:45.220

我的回答比 Lieven 的回答更笼统，后者是 Delphi 特有的。我在问题后不久写了这个，但在提交之前去了一位同事；）

我拒绝在我们的主要 Windows 构建代理上安装任何 IDE。对我来说听起来像是一场噩梦。MSBuild 引擎可以很好地处理所有构建方案，除了 .NET，您只需要安装 Windows SDK。或者你可以使用 NAnt 甚至 CMake，无论如何。只是不要安装 IDE。构建服务器并不好玩。

现在您已将其标记为 Delphi。我不知道它在那里工作得有多好，但正如 Lieven 所写，Delphi 带有一个命令行编译器。我只是没有任何使用第三方组件的经验，但我认为 Delphi 在最新版本中支持 MSBuild。

我也不确定将第三方组件包含到版本控制中是否是一件好事，因为它占用的空间 - 尽管您也可以将它们放在其他地方并将它们作为外部包含，这使得它更小，但也强加了升级一个应用程序的组件将升级所有应用程序的问题 - 所以你最好有良好的集成测试。但这无论如何都是构建服务器的重点。

除此之外，签出并拥有构建应用程序所需的所有组件总是一件好事。如果组件做得好，您不需要将组件安装到 IDE 中。根据它们是什么组件，在许多情况下，您甚至不需要在开发人员机器上安装它们。例如，当您添加对它们的引用时，许多 .NET 组件在设计器中可用。许可通常只是“将许可文件放入同一目录”。嗯，至少应该是这样。如果这不是它在今天的 Delphi 中的工作方式，那可能是 Delphi 即将退出的原因之一。除了 Borland/Inprise/DevCo/Codegear/Embarcadero 的麻烦之外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:48:13.750

这里也有类似的情况，幸好一开始并没有一团糟。确实，真正的问题在于 IDE 配置，如果您检查旧版本，则需要指向第三方组件的正确版本。我听说的唯一解决方案是针对不同的产品发布配置使用不同的注册表分支。

组件保存在单独的目录结构中，并尽可能在目录名称中使用版本号。这样可以更轻松地检查旧版本并使构建脚本指向正确的版本。

多年来，我们一直使用 Apache Ant 作为主要构建工具，它确实可以满足我们的一切需求，包括单元测试调用和 Innosetup 脚本生成。

仅当您使用 BPL 发布可执行文件时才需要编译包，否则在构建服务器上不需要编译。

在构建服务器上也不需要在 IDE 中安装组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-17T11:04:26.957

您可以使用[Owly CI](http://owlyci.com)工具。

它允许通过定义清单文件以简单的方式构建项目。它还允许处理依赖项——您可以将 3rd 方组件包装在 owlyci 包中，并将它们标记为对主项目的依赖项。

有一个[例子](http://owlyci.com/docs/tutorial/jenkins)，如何将它与 Jenkins CI 系统一起使用。

# mysql - MySQL查询：显示按当月平均评分排序的用户排名表

> ID：1017029
> 
> 赞同：0
> 
> 时间：2009-06-19T09:12:07.020
> 
> 标签：mysql

我有一个名为 RATING 的 mysql 表，其结构如下：

ID、用户名、评分、评分者、月份

我希望能够显示按当月平均评分排序的用户排名表。

例如：

1，鲍勃，10，丽塔，七月

2，鲍勃，8 岁，苏，7 月

3，丽塔，9，鲍勃，七月

4，苏，4，丽塔，七月

5，丽塔，10，苏，七月

我想要一个会产生这些结果的 SQL 查询：

丽塔：9.5

鲍勃：9

苏：4

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T09:15:22.193

假设月份列是日期时间：

```
select username, avg(rating)
from rating
where YEAR(curdate()) = YEAR(rating.month)
and MONTH(curdate()) = MONTH(rating.month)
group by username 
```

如果是该月的前 3 个字符，请将 WHERE 语句替换为：

```
where LEFT(MONTHNAME(curdate()),3) = rating.month 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:16:03.847

```
select username, avg(rating), month from RATING group by username,month 
```

看到你的月份有“JUL”，我假设它是一个 varchar。如果您只想要 JUL 的结果：

```
select username, avg(rating) from RATING where month = 'JUL' group by username 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:16:48.087

```
SELECT `username`, AVG(`rating`) AS average FROM RATING GROUP BY `username` 
```

# c# - 验证完整性 Ceritifcate { RSACryptoServiceProvider - SHA1 - thumbprint }

> ID：1017030
> 
> 赞同：0
> 
> 时间：2009-06-19T09:12:35.180
> 
> 标签：c#, certificate, sha1, verify, rsacryptoserviceprovider

我有一个小问题。我想验证证书的完整性。

所以我做了这个代码：

```
using System.Security.Cryptography;
using System.Runtime.InteropServices;
using System.Security.Cryptography.X509Certificates; 

SHA1Managed sha1 = new SHA1Managed();
RSACryptoServiceProvider csp = null;
AsymmetricAlgorithm rsaAlgo = certificatEnCours.PublicKey.Key;
byte[] data = null;
byte[] hash = null;

string keyPublic = "";
string signatureLikeInteger = "";

bool verif = false;

// ------------- PART 1 -------------

signatureLikeInteger = certificatEnCours.Thumbprint;

data = Convert.FromBase64String(signatureLikeInteger);

// ------------- PART 2 -------------

hash = sha1.ComputeHash(certificatEnCours.RawData);

keyPublic = rsaAlgo.ToXmlString(false);

csp = new RSACryptoServiceProvider();

csp.FromXmlString(keyPublic);

// ------------------------------

verif = csp.VerifyData(hash, CryptoConfig.MapNameToOID("SHA1"), data); 
```

`false`我的问题是我的变量“”上已经有了值“ `verif`”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T09:25:23.187

这里没有实际的问题。你是对的，你无条件地忽略了验证的初始值。更重要的是，您是否考虑过使用 X509Certificate2 进行验证？：

```
X509Certificate2 x2 = new X509Certificate2(certificatEnCours);
bool verif = x2.Verify(); 
```

我认为这比重新发明轮子更明智。

编辑：如果您正在验证证书链，我相信您想使用[X509Chain](http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509chain.aspx) ，尤其是[ChainStatus](http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509chain.chainstatus(VS.100).aspx)属性。

# web-services - BizTalk Web 服务调用：无法连接到远程服务器

> ID：1017036
> 
> 赞同：1
> 
> 时间：2009-06-19T09:13:54.130
> 
> 标签：web-services, exception, proxy, biztalk, firewall

我正在尝试从 BizTalk (2006) 编排中调用 Web 服务。

掌握了基础知识后，我一直在关注[本教程](http://books.google.co.uk/books?id=iKklnd5bq_kC&pg=PA76&lpg=PA76&dq=biztalk+webservice+request+response+transform&source=bl&ots=fgV7Aem6fL&sig=Ob283CLFihw1vxpBwvPPjTNVXII&hl=en&ei=VyU6So_yG9XRjAfa24meDQ&sa=X&oi=book_result&ct=result&resnum=3)（从第 74 页开始），其中我有一个对外部 Web 服务的 Web 引用（我使用的是[这个 Web 服务](http://www.webservicex.net/CurrencyConvertor.asmx)而不是本教程中的那个），我有我的发送组件中的 web 消息，并为 web 服务调用设置了请求/响应端口。

我相当确定一切都已正确设置，但我的编排无法调用 Web 服务并出现以下错误：

> 适配器无法传输要发送端口“My_Order_Processor.Orchestration-CurrencyConvertPort-36c122f41c5596ae”且 URL 为“ [http://www.webservicex/net/CurrencyConvertor.asmx](http://www.webservicex/net/CurrencyConvertor.asmx) ”的消息。
> 
> WebException：无法连接到远程服务器。
> 
> SocketException：一个现有的连接被远程主机209.162.186.60:80强行关闭

IP 209.162.186.60 是我尝试连接的 Web 服务的地址。我正在尝试缩小错误的原因，例如：

*   防火墙问题
*   代理服务器问题（我不知道如何配置 BizTalk 以使用代理服务器）
*   别的东西

BizTalk服务器可以ping web服务，我可以访问互联网（通过IE），我可以成功地将WebReference添加到项目中（这意味着至少编排设计者可以访问web服务好了）。我还尝试了不同的 Web 服务，结果相同。

关于找出为什么会发生这种情况或如何找到更多信息的任何想法？（我是 BizTalk 的新手）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T13:15:30.773

由于许多不同的原因，我之前已经看到过这个非常模糊的错误。两个建议。

1.  下载诸如 NetMon 之类的东西，然后观察网络上发生的事情。
2.  关闭分块编码。出于某种原因，许多 Web 服务不能很好地处理这个问题。

让我们知道你发现什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T20:18:02.210

这可能不是身份验证问题吗？检查您是否可以使用 Bts 凭据连接到 Web 服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T13:28:23.710

原来这是一个代理问题。

By navigating to Biz Talk Group -> Platform Settings -> Adapters -> SOAP, I was able to configure the BizTalk server host's SOAP adapter (which is what the web service call uses to make the call) to use our company proxy server correctly. Double click the 'send' SOAP adapter, go to Properties under adapter name.

# .net - 将图像添加到 ListView 控件中的子项

> ID：1017039
> 
> 赞同：0
> 
> 时间：2009-06-19T09:14:31.947
> 
> 标签：.net, windows

我需要将多个图像添加到列表视图每一行中的列表视图项，并且每列都有不同的图像？

问候， 弗兰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:13:38.790

我不确定这是否解决了实际问题，但如果您需要两个图标并且可以将它们放在同一列中，则可以同时使用 StateImageList 和 Large 或 SmallImageLists 在列中显示两个图像。只需在 ListViewItem 中设置 ImageIndex 和 StateImageIndex，您将获得两个图像，其中 State 图像首先出现。集合中的第 0 列将获取图像，但您可以通过 DisplayIndex 更改它们的显示顺序（因此，column[0] 将具有图像，但您可以通过设置使其显示为第 5 列DisplayIndex 为 4 并在必要时重新排序其他）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T16:06:10.387

我不确定我是否完全按照这个问题。

如果您询问如何将两个图像关联到 ListView 控件的一行中的单个 ListViewItem，我认为这是不可能的。我相信每个项目的图像都是该条目的唯一键。

如果您询问如何在 ListView 控件中创建两个具有不同图像的条目，否则这些图像具有相同的值，您可以使用如下内容：

```
ImageList imgList = new ImageList();
listViewControl.SmallImageList = imgList;
imgList.Images.Add("image_one_key", new Icon("filenameOfImageOne"));
imgList.Images.Add("image_two_key", new Icon("filenameOfImageTwo"));
ListViewItem itemOne = new ListViewItem(("Test Object",imgList.Images.IndexOfKey("image_one_key"));
ListViewItem itemTwo = new ListViewItem(("Test Object", imgList.Images.IndexOfKey("image_two_key"));
listViewControl.Items.Add(itemOne);
listViewControl.Items.Add(itemTwo); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T09:18:11.300

首先要问您使用的是哪个版本的控件？最近的一个允许这样的事情。您需要做的就是将图像添加到其关联的 ImageList 并设置适当的属性。

# php - 将引号添加到以逗号分隔的字符串中的值 php

> ID：1017046
> 
> 赞同：4
> 
> 时间：2009-06-19T09:15:55.187
> 
> 标签：php, mysql, full-text-search, replace

我有一个可以使用逗号包含多个值的搜索框，例如意大利面、金枪鱼、鸡蛋

我正在使用 FULLTEXT mysql 搜索，但我需要使用某种 preg_replace 将面食、金枪鱼、鸡蛋变成“面食”、“金枪鱼”、“鸡蛋”

如果我在搜索框中输入这个“意大利面”、“金枪鱼”、“鸡蛋”，结果是正确的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T09:46:45.017

不要将正则表达式用于可以通过其他方式解决的问题。你想要的是一个简单的字符串替换：

```
$string = "'" . str_replace(",", "','", $string) . "'"; 
```

不过，您应该首先在字符串中转义引号（不知道您的转义字符是什么，假设它是反斜杠）：

```
$string = "'" . str_replace(array("'", ","), array("\\'", "','"), $string) . "'"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:28:06.863

您是否正在使用列表构建 SQL 查询？如果是这样，您应该花一些时间来确保生成的 SQL 也被正确转义。

```
$myList = "pasta, tuna, eggs";

$items = preg_split("/[,\\s]+/", $myList);
$sqlItems = array();
foreach ($items as $item) {
    $sqlItems[] = "'" . mysql_real_escape_string($item) . "'";
}

// Add new list to SQL
$sql .= implode(",", $sqlItems); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T09:24:49.867

值中有逗号吗？

如果没有，你可以使用类似的东西：

```
preg_replace('/[^,]+/g', '\'\1\'', preg_replace('/\'/g', '\\\'', $text)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T09:26:54.510

内爆你的字符串，然后 foreach 结果数组并添加所需的符号

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T10:15:29.157

伙计们为麻烦感到抱歉，但我已经解决了我自己的问题！我看过这个，一开始就错了。

我不得不用空格和加号替换每个，所以 ", tuna" = " +tuna"

不管怎么说，还是要谢谢你

# php - 如何从双引号中提取字符串？

> ID：1017051
> 
> 赞同：30
> 
> 时间：2009-06-19T09:17:06.387
> 
> 标签：php, string, preg-match, preg-match-all, double-quotes

我有一个字符串：

> 这是一条文本，“您的余额还剩 0.10 美元”，结束 0

如何提取双引号之间的字符串并且只有文本（没有双引号）：

> 您的余额还剩 0.10 美元

我试过`preg_match_all()`但没有运气。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-06-19T09:28:09.033

只要格式保持不变，您就可以使用正则表达式执行此操作。`"([^"]+)"`将匹配模式

*   双引号
*   至少一个非双引号
*   双引号

括号周围的`[^"]+` 意思是该部分将作为一个单独的组返回。

```
<?php

$str  = 'This is a text, "Your Balance left $0.10", End 0';

//forward slashes are the start and end delimeters
//third parameter is the array we want to fill with matches
if (preg_match('/"([^"]+)"/', $str, $m)) {
    print $m[1];   
} else {
   //preg_match returns the number of matches found, 
   //so if here didn't match pattern
}

//output: Your Balance left $0.10 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-08-19T14:50:04.720

对于每个寻找功能齐全的字符串解析器的人，试试这个：

```
(?:(?:"(?:\\"|[^"])+")|(?:'(?:\\'|[^'])+')); 
```

在 preg_match 中使用：

```
$haystack = "something else before 'Lars\' Teststring in quotes' something else after";
preg_match("/(?:(?:\"(?:\\\\\"|[^\"])+\")|(?:'(?:\\\'|[^'])+'))/is",$haystack,$match); 
```

回报：

```
Array
(
    [0] => 'Lars\' Teststring in quotes'
) 
```

这适用于单引号和双引号字符串片段。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-19T09:28:26.520

试试这个 ：

```
preg_match_all('`"([^"]*)"`', $string, $results); 
```

您应该在 $results[1] 中获取所有提取的字符串。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-19T10:52:48.190

与其他答案不同，这支持转义，例如`"string with \" quote in it"`.

```
$content = stripslashes(preg_match('/"((?:[^"]|\\\\.)*)"/')); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-19T09:26:18.833

正则表达式`'"([^\\"]+)"'`将匹配两个双引号之间的任何内容。

```
$string = '"Your Balance left $0.10", End 0';
preg_match('"([^\\"]+)"', $string, $result);
echo $result[0]; 
```

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2009-06-19T09:19:00.207

只需使用 str_replace 并转义引号：

```
str_replace("\"","",$yourString); 
```

编辑：

抱歉，没有看到第二个引用之后有文字。在这种情况下，我只需进行 2 次搜索，一个用于第一个报价，一个用于第二个报价，然后执行 substr 以在两者之间添加所有内容。

# .net - 通过 Web 服务查找客户的时区和文化

> ID：1017053
> 
> 赞同：2
> 
> 时间：2009-06-19T09:18:11.767
> 
> 标签：.net, ajax, internationalization, cross-browser

我有一个 .NET 网络服务。

它为来自网络用户的 AJAX 请求提供服务。

我只是想知道如何自动获取用户的时区......不是当前的时间偏移，而是实际的时区 - 例如，中央标准时间现在是 -5:00，但东部标准时间将是 -5:00 一次夏令时结束了。我想区分这些用户。

我还想知道如何获取他们的文化设置（“en-US”等），以便我可以将我的 Web 服务中的 DateTimes 和数字呈现到他们的特定偏好中。

任何 Javascript 或 .NET 解决方案都可以使用。谢谢。

注意：询问用户将是最后的手段，因为它是一项网络服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T09:21:49.340

[在请求中包含时区是此处](https://datatracker.ietf.org/doc/html/draft-sharhalakis-httptz-04)的 RFC 草案的主题

因为这没有实现，唯一的解决方案是在 JavaScript 中获取 UTC 偏移量：

```
// create Date object for current location
d = new Date();
// convert to msec since Jan 1 1970
localTime = d.getTime();
// obtain local UTC offset and convert to msec
localOffset = d.getTimezoneOffset() * 60000; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T09:24:57.073

假设您的客户端从浏览器连接到网络服务，您可以使用 Request.Headers["Accept-Language"] 来检测浏览器的文化设置。无法直接从服务器获取时区，您需要在客户端计算其本地时钟和 GMT 之间的时差。

如果您的 Web 服务以不同方式使用（即不是来自浏览器），您需要将这两条信息作为参数添加到您的 Web 服务方法中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T10:22:51.560

您最好通过服务参数“询问用户”。例如，用户的位置不会告诉您他们只是在访问该位置并且仍在他们的家乡时间进行操作；或者他们在一个多元文化的地区（例如瑞士）并且选择了您没想到的文化（法语，当您期待德语时）。

# xslt - 如何在 XSLT 中实现回车

> ID：1017054
> 
> 赞同：23
> 
> 时间：2009-06-19T09:18:39.503
> 
> 标签：xslt

我想在 xslt 中实现回车。问题是我有一个变量： Step 1 = Value 1 breaktag Step 2 = Value 2 作为字符串并且希望显示为

步骤 1 = 值 1

步骤 2 = 价值 2

在 HTML 表单中，但我在页面上获得了 br 标记。任何在 xsl 中实现换行/回车的好方法将不胜感激

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-19T09:28:00.250

作为替代

```
<xsl:text>
</xsl:text> 
```

你可以使用

```
<xsl:text>&#10;</xsl:text> <!-- newline character --> 
```

或者

```
<xsl:text>&#13;</xsl:text> <!-- carriage return character --> 
```

如果你不想弄乱你的缩进

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-13T13:37:17.843

这对我有用，作为回车+生命馈送。

```
<xsl:text>&#xD;&#xA;</xsl:text> 
```

“ ” 字符串不起作用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-26T15:20:10.693

我发现的最简洁的方法是`!ENTITY`在样式表的顶部插入换行符、制表符和其他常见文本结构的声明。当必须在输出中插入大量格式元素时，这会使转换表看起来更干净。

例如：

```
<?xml version="1.0"?>
<!DOCTYPE xsl:stylesheet [
    <!ENTITY nl "<xsl:text>
</xsl:text>">
]>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="step">
    &nl;&nl;
    <xsl:apply-templates  />
  </xsl:template>
  ...
</xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T09:21:58.763

在 xsl:text 元素中使用简单的回车

```
<xsl:text>
</xsl:text> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-24T13:51:43.910

在要回车的行的末尾尝试此操作。它对我有用。

```
<xsl:text><![CDATA[<br />]]></xsl:text> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-27T17:39:48.813

我一直在寻找一个很好的解决方案，正如许多人所希望的那样，不直接在表达式中嵌入转义序列，或者在变量内部有奇怪的换行符。我发现这两种方法的混合实际上是有效的，通过在这样的变量中嵌入一个文本节点：

```
<xsl:variable name="newline"><xsl:text>&#10;</xsl:text></xsl:variable>
<xsl:value select="concat(some_element, $newline)" /> 
```

另一个很好的副作用是你可以传入任何你想要的换行符，无论是 LF、CR 还是两者都 CRLF。

——丹尼尔

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-26T16:38:18.663

这是一种使用递归模板的方法，它`&#10;`从数据库中查找字符串，然后输出之前的子字符串。如果剩余后有子串`&#10;`，则模板调用自身，直到没有剩余。如果`&#10;`不存在，则仅输出文本。

这是模板调用（只需将 @ActivityExtDescription 替换为您的数据库字段）：

```
<xsl:call-template name="MultilineTextOutput">
    <xsl:with-param name="text" select="@ActivityExtDescription" />
</xsl:call-template> 
```

这是模板本身的代码：

```
<xsl:template name="MultilineTextOutput">
<xsl:param name="text"/>
<xsl:choose>
    <xsl:when test="contains($text, '&#10;')">
        <xsl:variable name="text-before-first-break">
            <xsl:value-of select="substring-before($text, '&#10;')" />
        </xsl:variable>
        <xsl:variable name="text-after-first-break">
            <xsl:value-of select="substring-after($text, '&#10;')" />
        </xsl:variable>

        <xsl:if test="not($text-before-first-break = '')">
            <xsl:value-of select="$text-before-first-break" /><br />
        </xsl:if>

        <xsl:if test="not($text-after-first-break = '')">
            <xsl:call-template name="MultilineTextOutput">
                <xsl:with-param name="text" select="$text-after-first-break" />
            </xsl:call-template>
        </xsl:if>
    </xsl:when>
    <xsl:otherwise>
        <xsl:value-of select="$text" /><br />
    </xsl:otherwise>
</xsl:choose> 
```

奇迹般有效！！！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-19T09:23:19.247

我相信您可以为此使用 xsl:text 标签，如

```
<xsl:text>
</xsl:text> 
```

很有可能，通过将结束标记放在自己的一行上，换行符是文字文本的一部分并按原样输出。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-19T13:05:05.583

我通过 Environment.NewLine 分隔值，然后在 html 中使用 pre 标记来模拟我正在寻找的效果

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-01-07T16:24:14.913

这是唯一对我有用的解决方案。除了我要替换; 与*\r\n*

# linux - 在 Linux 上开始使用 Latex

> ID：1017055
> 
> 赞同：190
> 
> 时间：2009-06-19T09:18:41.533
> 
> 标签：linux, latex, tex, typesetting

[对is-latex-worth-learning-today](https://web.archive.org/web/20130816143747/https://stackoverflow.com/questions/874576/is-latex-worth-learning-today#)以及 Windows 上的许多操作方法印象深刻，

你是如何在 Linux 上开始使用 LaTeX 的？

您如何从中生成 pdf 并放弃 OOO 字处理程序？

更新：

感谢这里给出的所有建议。我能够使用 Beamer 类创建一个很棒的 ppt：http: [//github.com/becomingGuru/gids-django-ppt](http://github.com/becomingGuru/gids-django-ppt)。我发现这种方法比使用 powerpoint 之类的方法要好得多。

感兴趣的人可以[查看 TEX 文件](http://github.com/becomingGuru/gids-django-ppt/blob/master/contents.tex)，其中包含许多自定义命令和[相应的演示文稿](http://www.slideshare.net/scorpion032/building-pluggable-web-applications-using-django)。

* * *

## 回答 #1

> 赞同：294
> 
> 时间：2009-06-19T09:48:18.820

首先，您需要**安装**它：

*   如果您使用的是包含 LaTeX 的发行版（几乎所有都可以），请查找**texlive**或**tetex**。TeX Live 是两者中较新的一个，现在正在大多数发行版上取代 tetex。

如果您使用的是 Debian 或 Ubuntu，则类似于：

```
<code>apt-get install texlive</code> 
```

..将安装它。

RedHat 或 CentOS 需要：

```
<code>yum install tetex</code> 
```

*注意：这需要 root 权限，因此如果您尚未以 root 用户身份登录，请使用`su`将用户切换为 root，或在命令前加上。`sudo`*

接下来，您需要获得一个**文本编辑器**。任何编辑器都会做，所以无论你喜欢什么。您会发现像 Emacs（和 vim）这样的高级编辑器添加了很多功能，因此有助于在您尝试构建文档输出之前确保您的语法正确。

创建一个名为 test.tex 的文件并在其中放入一些内容，例如[LaTeX Primer](http://www.maths.tcd.ie/~dwilkins/LaTeXPrimer/TypicalInput.html)中的示例：

```
\documentclass[a4paper,12pt]{article}
\begin{document}

The foundations of the rigorous study of \emph{analysis}
were laid in the nineteenth century, notably by the
mathematicians Cauchy and Weierstrass. Central to the
study of this subject are the formal definitions of
\emph{limits} and \emph{continuity}.

Let $D$ be a subset of $\bf R$ and let
$f \colon D \to \mathbf{R}$ be a real-valued function on
$D$. The function $f$ is said to be \emph{continuous} on
$D$ if, for all $\epsilon > 0$ and for all $x \in D$,
there exists some $\delta > 0$ (which may depend on $x$)
such that if $y \in D$ satisfies
\[ |y - x| < \delta \]
then
\[ |f(y) - f(x)| < \epsilon. \]

One may readily verify that if $f$ and $g$ are continuous
functions on $D$ then the functions $f+g$, $f-g$ and
$f.g$ are continuous. If in addition $g$ is everywhere
non-zero then $f/g$ is continuous.

\end{document} 
```

获得此文件后，您需要在其上**运行 latex**以产生一些输出（作为 .dvi 文件开始，可以转换为许多其他格式）：

```
latex test.tex 
```

这将打印一堆输出，如下所示：

```
=> latex test.tex

This is pdfeTeX, Version 3.141592-1.21a-2.2 (Web2C 7.5.4)
entering extended mode
(./test.tex
LaTeX2e &lt;2003/12/01&gt;
Babel &lt;v3.8d&gt; and hyphenation patterns for american, french, german, ngerman, b
ahasa, basque, bulgarian, catalan, croatian, czech, danish, dutch, esperanto, e
stonian, finnish, greek, icelandic, irish, italian, latin, magyar, norsk, polis
h, portuges, romanian, russian, serbian, slovak, slovene, spanish, swedish, tur
kish, ukrainian, nohyphenation, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX document class
(/usr/share/texmf/tex/latex/base/size12.clo))
No file test.aux.
[1] (./test.aux) )
Output written on test.dvi (1 page, 1508 bytes).
Transcript written on test.log. 
```

..不要担心这个输出的大部分——重要的部分是**写在 test.dvi**行上的输出，它表示它是成功的。

现在你需要用 xdvi**查看输出文件：**

```
xdvi test.dvi & 
```

这将弹出一个窗口，其中包含格式精美的输出。点击 `q' 退出这个，或者你可以让它保持打开状态，当 test.dvi 文件被修改时它会自动更新（所以每当你运行 latex 来更新输出时）。

**要生成这样的 PDF，**您只需运行*pdflatex*而不是 latex：

```
pdflatex test.tex 
```

..您将创建一个 test.pdf 文件而不是 test.dvi 文件。

在这一切正常之后，我建议您转到[LaTeX 入门](http://www.maths.tcd.ie/~dwilkins/LaTeXPrimer)页面并浏览那里的项目，因为您需要您想要编写的文档的功能。

未来要考虑的事情包括：

*   *使用**xfig**或**dia**等工具创建图表*。这些可以很容易地以各种格式插入到您的文档中。请注意，**如果您正在创建 PDF，则不应将 EPS（封装后记）用于图像**- 如果可能，请使用从图表编辑器导出的 pdf，或者您可以使用该`epstopdf`包自动从 (e)ps 转换为 pdf 以获取图形包含在`\includegraphics`.

*   *开始对您的文档使用版本控制*。起初这似乎有些过分，但是当您编写大型内容时能够返回并查看早期版本可能非常有用。

*   *使用**make**为您运行乳胶*。当您开始使用乳胶的参考书目、图像和其他更复杂的用途时，您会发现您需要在多个文件或多次运行它（第一次更新引用，第二次将引用放入文档中，所以他们除非您运行乳胶两次，否则可能会过时...）。将其抽象为一个 makefile 可以节省大量时间和精力。

*   *使用更好的编辑器*。像 Emacs + AUCTeX 这样的东西非常称职。这当然是一个高度主观的主题，所以我将把它留在那里（那个 Emacs 显然是最好的选择 :)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-06-19T09:50:51.000

要开始在 Linux 上使用 LaTeX，您需要安装几个软件包：

1.  您将需要一个**LaTeX 发行版**。这是组成 (La)TeX 计算机排版系统的程序集合。Unix 系统上的标准 LaTeX 发行版曾经是[teTeX](http://en.wikipedia.org/wiki/TeTeX)，但它已被[TeX Live](http://en.wikipedia.org/wiki/TeX_Live)取代。大多数 Linux 发行版都有 TeX Live 的安装包——例如，参见[Ubuntu](http://packages.ubuntu.com/karmic/texlive)和[Fedora](https://admin.fedoraproject.org/pkgdb/packages/name/texlive)的包数据库条目。

2.  您可能想要安装一个**LaTeX 编辑器**。标准的 Linux 文本编辑器可以正常工作；特别是，Emacs 有一个很好的 (La)TeX 编辑宏包，称为[AUCTeX](http://en.wikipedia.org/wiki/AUCTEX)。还存在专门的 LaTeX 编辑器；其中，[Kile](http://kile.sourceforge.net/)（KDE Integrated LaTeX Environment）特别好。

3.  您可能需要**LaTeX 教程**。经典教程是“ [A (Not So) Short Introduction to LaTeX2e](http://www.ctan.org/pkg/lshort) ”，但现在[LaTeX wikibook](http://en.wikibooks.org/wiki/LaTeX)可能是更好的选择。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T09:52:08.203

我建议您开始使用 Lyx，这样您就可以像使用 OOO-Writer 一样简单地使用 Latex。它使您可以通过手动将 Latex-Code 添加到文档中来更深入地使用 Latex。PDF 在安装后只需单击一下即可。[Lyx 是跨平台的。](http://www.lyx.org/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-19T09:21:56.940

这取决于您的 Linux 发行版和您对编辑器等的偏好，但我建议从[Kile](http://kile.sourceforge.net/)（一个 KDE 应用程序）开始，因为它很容易学习和安装它应该安装大多数 LaTex 和 PDF 生成所需的包。看看截图吧。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-02-07T15:25:33.857

如果您使用 Ubuntu 或 Debian，我制作了一个易于理解的教程：[在 Ubuntu 或 Debian 上安装 LaTeX](http://milq.github.io/install-latex-ubuntu-debian)。本教程解释了如何安装 LaTeX 以及如何创建您的第一个 PDF。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T09:56:30.957

[LaTeX 以teTeX](http://www.tug.org/tetex/)发行版的形式随大多数 Linux 发行版一起提供。找到名称中带有“teTeX”的所有软件包并安装它们。

*   大多数编辑器，如[vim](http://www.vim.org)或[emacs](http://www.gnu.org/software/emacs/)都带有 TeX[编辑模式](http://www.delorie.com/gnu/docs/emacs/emacs_252.html)。您还可以获得所见即所得的前端（技术上[是 WYSIWYM](http://en.wikipedia.org/wiki/WYSIWYM)），其中最著名的可能是[LyX。](http://www.lyx.org/)

*   对 LaTeX 最好的快速介绍是 Oetiker 的['The not so short intro to LaTeX'](http://tobi.oetiker.ch/lshort/)

*   LaTeX 像编译器一样工作。您编译 LaTeX 文档（可以包含其他文件），生成一个名为 a [`.dvi`](http://en.wikipedia.org/wiki/Device_independent_file_format)（与设备无关）的文件。可以使用各种后处理器将其后处理为各种格式（包括 PDF）。

*   要制作 PDF，请使用[`dvips`](http://linux.die.net/man/1/dvips)并使用标志 -PPDF（IIRC - 我手头没有生成文件）来生成带有字体渲染设置的 PS 以转换为 pdf。然后可以使用[`ps2pdf`](http://pages.cs.wisc.edu/~ghost/doc/AFPL/6.50/Ps2pdf.htm)或蒸馏器（如果有的话）完成 PDF 转换。

*   在此环境中[包含图形](http://amath.colorado.edu/documentation/LaTeX/reference/figures.html)的最佳格式是[`eps`](http://en.wikipedia.org/wiki/Encapsulated_PostScript)（Encapsulated Postscript），尽管并非所有软件都能生成表现良好的 postscript。可以使用[各种机制包含 jpeg 或其他格式的照片。](http://mintaka.sdsu.edu/GF/bibliog/latex/figures.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-07-09T11:11:21.627

我个人会使用完整的编辑包，例如：

*   纺织厂
*   纺织工作室

`pdfLaTeX`然后我将安装“MikTeX”作为编译包，它允许您使用编译器从文档中生成 PDF 。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-07-20T18:35:25.837

```
yum -y install texlive 
```

我的 centos 发行版无法获得 latex 命令。

该站点[https://gist.github.com/melvincabatuan/350f86611bc012a5c1c6](https://gist.github.com/melvincabatuan/350f86611bc012a5c1c6) 包含其他软件包。尤其：

```
yum -y install texlive texlive-latex texlive-xetex 
```

已经足够了，但作者也指出了这些：

```
yum -y install texlive-collection-latex
yum -y install texlive-collection-latexrecommended
yum -y install texlive-xetex-def
yum -y install texlive-collection-xetex 
```

仅在需要时：

```
yum -y install texlive-collection-latexextra 
```

# c# - 使用 C# 解析和执行公式

> ID：1017056
> 
> 赞同：12
> 
> 时间：2009-06-19T09:18:49.550
> 
> 标签：c#, parsing

我正在寻找一个开源库来解析和执行 C# 中的公式/函数。

我想创建一堆从具有属性/方法/值的接口（即 IFormulaEntity）派生的对象，并允许用户为这些对象指定公式。

例如，我可能有

```
public class Employee : IForumulaEntity
{ 
      public double Salary { get; set; }
      public void SendMessage(string message)
} 
```

然后允许应用程序用户编写类似的东西；

```
Employee person = <get from datasource>
if (person.Salary > 1000)
    person.Salary += 1000;

person.SendMessage("Hello"); 
```

这“看起来像 C#”，但它将是一种简化的编程语言。我知道要问的很多。我希望我的用户具有相当的能力（即可以编写自己的 Excel 公式）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T09:26:01.953

我使用过 ANTLR、FSLEX/FSYACC 和 Managed Babel。所有人都按您的要求做，虽然都是免费的，但只有第一个是开源的。

蚂蚁：http : [//antlr.org/](http://antlr.org/)

FSLEX： http: [//www.strangelights.com/fsharp/wiki/default.aspx/FSharpWiki/fslex.html](http://www.strangelights.com/fsharp/wiki/default.aspx/FSharpWiki/fslex.html)

托管通天塔：http: [//msdn.microsoft.com/en-us/library/bb165963.aspx](http://msdn.microsoft.com/en-us/library/bb165963.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T10:20:37.477

查看属于 Windows Workflow Foundation 的规则引擎功能。

这不是一个人会想看的地方。但是，作为他们为生成允许 Workflow 开发人员使用可配置规则和表达式的 UI 所做的工作的一部分，他们提出了一种在您自己的应用程序中执行相同操作的方法，即使您不使用 Workflow一点也不。他们的文档包括在 Windows 窗体应用程序中托管此功能的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T10:10:39.257

您可以使用[cs-script](http://www.csscript.net/)。这允许您执行 c# 代码，这可能比您想要的更多，但为什么不坚持使用 c# 而不是创建自己的 c# 类语法。可以将 cs-script 作为 DLL 集成到您的应用程序中，您可以允许它执行不属于类的 c# 代码，以便用户只需编写他们需要的少数语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-24T09:51:55.253

[Spring 表达式](http://www.springframework.net/doc-latest/reference/html/expressions.html)非常强大，与 WF 相比，它不是全有或全无

（引擎是基于 ANTLR 的，并且表达式有点，虽然它拉入了一个体面大小的库，但并没有在所有 Spring.NET 中猛拉）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-24T09:57:59.873

当我把它打死时，[Dynamic LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)在这个空间中发挥作用（特别是类似 C# 的语法）。显然要小心它的要求（代码的发布/编译）在您的上下文中得到支持。

# c++ - 用 Visual Studio 构建 GMP 库？

> ID：1017058
> 
> 赞同：9
> 
> 时间：2009-06-19T09:20:30.750
> 
> 标签：c++, visual-studio-2005, build, gmp, mpfr

有没有一种简单的方法可以在 Windows 下使用 Visual Studio 2005构建 GMP（GNU 多精度算术库， [http ://gmplib.org）？](http://gmplib.org)我试图找到有关自己建立图书馆的信息，但找不到任何真正帮助我的东西。我自己对构建库不是很有经验（我已经设法构建了 boost，但仅此而已）。

或者是否有我不知道的稳定（预建）GMP 发行版？

MPIR 是一个有效的替代方案（[http://www.mpir.org](http://www.mpir.org)）吗？GMP 站点上关于 MPIR 的评论：对于某些 Windows 用户来说，这种“愤怒的 GMP 分支”可能是真正 GMP 的替代品，但他们必须处理大量反 GMP 情绪。

**编辑：** MPFR C++ 包装页面包含 Visual Studio 的 GMP/MPFR 解决方案的信息/链接以及编译的 gmp/mpfr 库：http: [//www.holoborodko.com/pavel/mpfr/](http://www.holoborodko.com/pavel/mpfr/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-24T01:28:03.303

MPIR 是一个有效的替代方案。基本上，GMP 人员根本不想支持在 Windows 上构建。正如您所见，Brian Gladman 曾一度支持在 Windows 上构建 GMP。然而，最终他和其他人分叉了 GMP 并创建了 MPIR。这不是唯一的原因，但它是一个很大的驱动因素，MPIR 的关键开发原则之一是它必须构建在 Windows（以及 Linux 和 Mac）上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-04T02:43:05.903

如果您想在 Windows 上快速开始使用 GMP，我分享了一个使用预构建 GMP 的 Visual Studio 项目：[https](https://stackoverflow.com/a/38176221/1327178) ://stackoverflow.com/a/38176221/1327178 。

# powerbuilder - 自动加载 PowerBuilder 扩展

> ID：1017059
> 
> 赞同：1
> 
> 时间：2009-06-19T09:20:36.940
> 
> 标签：powerbuilder

有谁知道是否可以让给定的 PowerBuilder 应用程序（我通常没有源代码）加载我提供的自定义扩展（非可视化扩展）？

我知道我可以将我的 .pbd 添加到 PowerBuilder 中 PowerScript 目标的库列表中，但是当给定一个完整的基于 PowerBuilder 的 GUI 时，也许有一些配置文件我可以手动编辑，指定我的额外 .pbd 的路径，以便在应用程序启动时加载它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T11:02:39.400

我不相信有一种简单的方法可以在运行时修补 pb .exe - .pbds 列表是在编译之前定义的，我不知道有任何方法可以在运行时更改它。您可以研究反​​编译和/或编辑 .exe ，但这可能很重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T23:09:45.373

*如果*您有源代码，但您表示没有，您可以使用 SetLibraryList 更改运行时库列表（出于某种原因，不建议使用 iirc AddToLibraryList）。通过阅读启动命令行，您可以在运行时换出库以包含特定版本。

我不知道有什么方法可以修补现有的 PB .exe 来做这样的事情。

即使你是一个非凡的黑客，PB 生成的 .exes 确实是 PB VM 的引导加载程序，所以你需要了解“exe”的结构，以通过修补来影响加载时库列表。如果您只是将一个对象/函数的一个实现换成另一个，那么您可能已经完成了，否则您将需要知道如何修补特定的 PBD/DLL 以调用添加的库中的函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-29T14:26:58.907

最简洁的答案是不。如果没有源，您将无法添加扩展，或者就此而言，调用此类扩展中的任何内容。

# javascript - 如何使用 MM_openBrWindow() 显示 safari 的 url 地址栏？

> ID：1017060
> 
> 赞同：1
> 
> 时间：2009-06-19T09:21:05.943
> 
> 标签：javascript

我正在使用函数 MM_openBrWindow() 打开新窗口。这是javascript。

```
function MM_openBrWindow(theURL,winName,features) { //v2.0
     window.open(theURL,winName,features);
     return false;
} 
```

这就是函数的调用方式。

```
<a href="index.php" onclick="MM_openBrWindow('index.php','','scrollbars=yes,menubar=0,width='+screen.availWidth+',height='+screen.availHeight);return false"><img src="images/logo.jpg" alt="Logo" /></a> 
```

这里弹出窗口被打开。对于 Firefox 和 IE，它会显示网址栏。这里的问题是野生动物园。它不显示地址栏。谁能建议我可能有什么问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T10:00:10.310

您可以尝试添加`locationbar`属性。

```
<a href="index.php" onclick="MM_openBrWindow('index.php','','scrollbars=yes,location=yes,locationbar=yes,menubar=no,width='+screen.availWidth+',height='+screen.availHeight);return false"><img src="images/logo.jpg" alt="Logo" /></a> 
```

我不确定这是否可行，但您始终可以[检查所有可用属性](http://www.aspnetcenter.com/cliktoprogram/javascript/window.asp)并尝试其他一些组合。

编辑：我已经在 Safari 3.1.1 上对此进行了测试，并且可以正常工作。您需要 the`location`和`locationbar`属性。如果您想确保您的脚本在所有浏览器上运行，您需要确保为所有属性提供一个值，而不是假设所有浏览器都默认使用相同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T09:58:16.960

尝试添加`,location=yes`到您的弹出选项

# rdbms - 数据库中的空值

> ID：1017064
> 
> 赞同：3
> 
> 时间：2009-06-19T09:22:04.740
> 
> 标签：rdbms

空值意味着

1.  没有价值
2.  不适用、未分配、未知或不可用

哪个是真的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:29:46.767

这完全取决于使用它的上下文。null 表示没有值，但其原因取决于使用它的域。在许多情况下，您列出的项目都是 null 的有效用法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:32:50.427

它可以表示任何这些事情（并不总是很明显），这是反对使用空值的一个论点。

请参阅：[http ://en.wikipedia.org/wiki/Null_(SQL)#Controversy](http://en.wikipedia.org/wiki/Null_(SQL)#Controversy)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:24:50.303

[来自维基百科](http://en.wikipedia.org/wiki/Null_(SQL))

> Null 是结构化查询语言 (SQL) 中使用的特殊标记，用于指示数据库中不存在数据值。SQL Null 由关系数据库模型的创建者 EF Codd 引入，用于满足所有真正的关系数据库管理系统 (RDBMS) 支持“缺失信息和不适用信息”表示的要求。Codd 还介绍了在数据库理论中使用小写希腊语 omega (ω) 符号来表示 Null。NULL 也是用于标识 Null 特殊标记的 SQL 保留关键字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T11:27:19.883

null 表示数据库中不存在数据值，因此表示缺少信息。

还允许三向真值；真实、虚假和未知。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T11:45:10.893

SQL 语义支持的唯一答案是“未知”。如果它意味着“没有价值”，那么

```
'Hi there' = NULL 
```

将返回 FALSE，但它返回 NULL。这是因为表达式中的 NULL 值表示未知值，并且就系统所知，未知值很可能是“Hi there”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T09:30:44.113

显然，您对 null 的含义有 DB 定义，但是对于应用程序而言，它可能意味着任何东西。我曾经开发过一个奇怪的应用程序（免责声明 - 我没有设计它），它在连接表中使用 null 来表示所有选项（据称它是为了“节省空间”而设计的）。这是用于用户和角色管理的数据库设计。

因此，在这种情况下为 null 意味着用户具有所有角色。这是每日WTF的一个。:-)

像许多人一样，我倾向于在可能的情况下避免使用空值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T09:24:43.737

NULL 表示字段未设置值或已重新设置为 NULL。它*不是*未知的或不可用的。

请注意，在查找 NULL 值时，不要在 where 子句中使用 '='，使用 'is'，例如：

```
select * from User where username is NULL; 
```

不是：

```
select * from User where username = NULL; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T09:25:58.960

在关系模型中，NULL 表示**Unknown**。它是在 SQL 中可以出现值的任何地方出现的标记，而不是值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T09:26:29.300

Null 表示什么都没有，未知且没有价值。

这并不意味着不可用或不适用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-19T09:26:46.197

Null 是行中列的可测试状态，但它本身没有值。

举例：

一个 int 只能是 ...,0,1,2,3,... 也可以是 NULL。

一个日期时间只能是一个有效的日期......也可以是 NULL。

一个位只能是 0 或 1……也可以是 NULL。

varchar 可以是字符串……也可以是 NULL。

看到图案了吗？

您可以使列 NOT NULL-able，以便您可以强制列取值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-19T09:27:03.077

NULL SQL 关键字用于表示缺失值或不适用于关系表的值

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-19T09:27:43.510

全部 :-) 如果您想为您的字段添加语义含义，请添加一个 ENUM

```
create TABLE myTable
  (
  myfield varchar(50)
  myfieldType enum ('OK','NoValue','InApplicable','Unassigned','Unknown','Unavailable') NOT NULL
  ) 
```

# java - Java 创建浮雕（红/蓝图像）

> ID：1017067
> 
> 赞同：6
> 
> 时间：2009-06-19T09:22:18.390
> 
> 标签：java, graphics, java-2d

我正在编写一个 Java 游戏引擎 ( [http://victoryengine.org](http://victoryengine.org) )，并且我一直在尝试生成具有深度的“3d”图像，您可以使用那些红/蓝眼镜看到这些图像。我正在使用 Java2D 进行图形处理。

我创建了一些可行的东西，但速度很慢（通过手动复制像素值和类似的东西）。

我需要的是取两个 BufferedImages（一个用于左眼，一个用于右眼）并将它们组合成一个（另一个缓冲区或直接到屏幕）。一个我只想要红色通道，另一个我想要绿色和蓝色通道。最快的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T14:44:07.757

看看 JAI BandMerge 操作：

[http://download.java.net/media/jai/javadoc/1.1.3/jai-apidocs/javax/media/jai/operator/BandMergeDescriptor.html](http://download.java.net/media/jai/javadoc/1.1.3/jai-apidocs/javax/media/jai/operator/BandMergeDescriptor.html)

将您的立体对创建为灰度图像，并使用波段合并将它们组合为最终图像中的红色和绿色通道。

# javascript - 如果元素在javascript中的页面折叠下方，如何实现自动滚动页面的功能？

> ID：1017069
> 
> 赞同：0
> 
> 时间：2009-06-19T09:22:53.753
> 
> 标签：javascript

我想实现类似[模板怪物](http://www.templatemonster.com)菜单的功能。我正在尝试创建一个功能列表，当用户单击该功能时它会向下滑动。但是，如果链接位于页面底部并且用户单击该链接，则功能列表将显示在视图区域下方，并且用户在手动向下滚动浏览器窗口之前不知道它已打开。

我想加入一个功能，如果功能列表不在可视区域中，浏览器窗口会自动向下滚动以显示完整列表（templatemonster.com 已经通过他们的下拉菜单做到了这一点）。

有谁能够帮我？

谢谢，

高拉夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T10:31:43.537

您引用的网站使用带有[Scriptaculous的](http://wiki.github.com/madrobby/scriptaculous/)[Prototype JavaScript 框架](http://www.prototypejs.org/)来获得视觉效果。这些库使此类任务变得更加容易，因为内置控件可以或多或少地实现您想要的。

如果您希望在用户单击某物时向下滑动；您应该考虑**事件** *单击*和**效果** *向下滑动* 查看[手册中的演示](http://wiki.github.com/madrobby/scriptaculous/effect-slidedown)。

滚动的第二个方面也可以使用这些库来实现。同样，也请查看[手册中的演示](http://wiki.github.com/madrobby/scriptaculous/effectscrollto)。本质上，您需要使用锚标记来标记页面上存在该功能的点，然后使用*滚动* **效果**将您带到页面上的那个位置。

希望这能让你走上正确的道路。

# xml - 是否有任何原生支持 xml 的编程语言？

> ID：1017072
> 
> 赞同：5
> 
> 时间：2009-06-19T09:23:52.333
> 
> 标签：xml, programming-languages, native

如果有，那么 xml 与语言的集成程度如何？哪些原语用于操作 xml 文档？

PS。我对 SQL、XPath、XSLT 等声明性语言不感兴趣 :)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T09:30:12.243

VB.NET 9.0 具有[XML 文字](http://msdn.microsoft.com/en-us/library/bb384563.aspx)，看起来就像您正在寻找的一样。这个例子取自[Imran Shaik 博客](http://geekswithblogs.net/Silverlight2/archive/2008/03/30/xml-literals-and-embedded-expressions.aspx)

```
 <WebMethod()> _
Public Function AllCountriesUsingXMLLiterals() As String

    Dim sud As New CountryDataSetTableAdapters.CountryTableTableAdapter

    Dim XDataSet As New CountryDataSet.CountryTableDataTable

    sud.Fill(XDataSet)

    Dim XDoc = _
        <Countries xmlns="http://tempuri.org/Schema/Countries">
            <%= From country In XDataSet Select <Country Code=<%= country.CountryISO %> Name=<%= country.CountryName %>/> %>
        </Countries>

    Return XDoc.ToString
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T09:26:40.160

Powershell 在处理 XML 方面有一些优点，主要是节点获取表示其子节点的动态属性。所以给定 XML

```
<foo>
  <bar/>
  <bar/>
</foo> 
```

从此创建的 XML 对象具有“foo”属性，而由其返回的对象具有“bar”属性。

```
> $x=[xml]"<foo><bar moo='meh'/><bar meow='bleh'/></foo>"
> $x.foo

酒吧
---
{酒吧，酒吧}

> $x.foo.bar[0]

哞
---
嗯

> $x.foo.bar[1]

喵
----
呜呜

```

有时非常方便。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T10:01:17.077

Flash 的 ActionScript 3.0 和 JavaScript（ECMAScript 语言）也通过[E4X](http://en.wikipedia.org/wiki/ECMAScript_for_XML)与 XML 集成。
所以代码看起来像这样（虽然这是一个简单的例子，更酷的东西是可能的）：

```
var sales = <sales vendor="John">
    <item type="peas" price="4" quantity="6"/>
    <item type="carrot" price="3" quantity="10"/>
    <item type="chips" price="5" quantity="3"/>
  </sales>;

alert( sales.item.(@type == "carrot").@quantity );
alert( sales.@vendor );
for each( var price in sales..@price ) {
  alert( price );
} 
```

这是[Adob](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7ff5.html) ​​e 在 AS3.0 中使用 XML 的文档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T09:30:54.237

Groovy 和 Scala 支持 XML 文字，尽管我认为这通常是一个非常愚蠢的想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T09:31:35.483

javascript，看[这里](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Processing_XML_with_E4X#Creating_an_XML_object)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T09:47:08.480

Flex 和动作脚本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-09-09T10:12:52.533

[Ballerina](https://ballerina.io/)编程语言具有对 XML（创建、解析和操作 XML）的内置语言支持。请参阅[xml 的文档](https://ballerina.io/learn/by-example/xml-data-model)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T09:29:57.920

取决于您所说的深度集成是什么意思？.net 带有一个 XML 命名空间和各种用于处理 XML 文档的类......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T09:37:04.910

[查询](http://en.wikipedia.org/wiki/XQuery)？从链接的文章：

> XQuery 提供了从 XML 文档或任何可以被视为 XML 的数据源（例如关系数据库或办公文档）中提取和操作数据的方法。

它支持 for-loops、whiles、let、ordering 等。

# apache-flex - 在flex的文本区域中移动图像

> ID：1017080
> 
> 赞同：0
> 
> 时间：2009-06-19T09:25:11.223
> 
> 标签：apache-flex, image, flex3, textarea

[替代文字 http://img31.imageshack.us/img31/1183/tedit.jpg](http://img31.imageshack.us/img31/1183/tedit.jpg)

嗨，大家好，

我正在尝试在 Flex 中制作文本编辑器。我可以通过鼠标点击移动图像。问题是它随着键向上或向下处理程序移动。但它在文本区域的最后一行之后移出文本区域。而且它也不会随着滚动而移动。

请对这些问题提出建议。

谢谢。

问候， 希旺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T02:45:12.050

您可能想要增加“文本编辑器”的空白。直到人输入文本为止。这样，当您移动到底部时，您不会移动到 textArea 之外。

需要更多示例来说明按键向上或向下处理程序出了什么问题。你想捕捉什么事件？你是如何拖动图像的？

祝你好运。

# python - Python cgi 性能

> ID：1017087
> 
> 赞同：2
> 
> 时间：2009-06-19T09:26:02.033
> 
> 标签：python, performance, cgi

我拥有一个以 CGI 编写的遗留 python 应用程序。到目前为止，这还不错，但是在不久的将来并发用户的数量将大幅增加。我在这里读到：“CGI 非常适合低流量网站，但它对其他任何网站都有一些性能问题”。我知道以另一种方式开始会更好，但 CGI 就是现在的样子。

有人可以为我指出如何保持 CGI 的性能，而不必重写所有代码吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T10:46:31.403

CGI 无法扩展，因为每个请求都会派生一个全新的服务器进程。这是很多开销。mod_wsgi 通过分叉一个进程并将请求交给那个正在运行的进程来避免开销。

让我们假设应用程序是最糟糕的 cgi 类型。

最坏的情况是它有这样的文件。

`my_cgi.py`

```
import cgi
print "status: 200 OK"
print "content-type: text/html"
print
print "<!doctype...>"
print "<html>"
etc. 
```

您可以尝试“包装”原始 CGI 文件以使其成为 wsgi。

`wsgi.py`

```
import cStringIO
def my_cgi( environ, start_response ):
    page = cStringIO.StringIO()
    sys.stdout= page
    os.environ.update( environ ) 
    # you may have to do something like execfile( "my_cgi.py", globals=environ ) 
    execfile( "my_cgi.py" )
    status = '200 OK' # HTTP Status
    headers = [('Content-type', 'text/html')] # HTTP Headers
    start_response(status, headers)
    return page.getvalue() 
```

这是将 CGI 应用程序重写为适当框架的第一步。这需要很少的工作，并且将使您的 CGI 更具可扩展性，因为您不会为每个请求启动一个新的 CGI 进程。

第二步是创建一个`mod_wsgi`Apache 使用的服务器，而不是所有的 CGI 脚本。该服务器必须 (1) 解析 URL，(2) 调用各种函数，如`my_cgi`示例函数。每个函数都将`execfile`使用旧的 CGI 脚本，而不会派生新的进程。

查看[werkzeug](http://werkzeug.pocoo.org/)以获取有用的库。

如果您的应用程序 CGI 脚本具有某些结构（函数、类等），您可能可以导入这些结构并做一些比上面更智能的事情。更好的方法是这个。

`wsgi.py`

```
from my_cgi import this_func, that_func
def my_cgi( environ, start_response ):

    result= this_func( some_args )
    page_text= that_func( result, some_other_args )

    status = '200 OK' # HTTP Status
    headers = [('Content-type', 'text/html')] # HTTP Headers
    start_response(status, headers)
    return page_text 
```

这需要更多的工作，因为您必须了解遗留应用程序。但是，这有两个优点。

1.  它使您的 CGI 更具可扩展性，因为您没有为每个请求启动一个新的过程。

2.  It allows you to rethink your application, possibly changing it to a proper framework. Once you've done this, it's not very hard to take the next step and move to [TurboGears](http://turbogears.org/) or [Pylons](http://pylonshq.com/) or [web.py](http://webpy.org/) for a very simple framework.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T09:29:14.413

使用[FastCGI](http://www.fastcgi.com/drupal/)。如果我正确理解 FastCGI，您可以通过编写一个非常简单的 Python 程序来做您想做的事情，该程序位于 Web 服务器和您的遗留代码之间。

# visual-studio - 重命名 SVN 和 VS.Net 中的文件夹

> ID：1017096
> 
> 赞同：14
> 
> 时间：2009-06-19T09:27:25.167
> 
> 标签：visual-studio, svn, tortoisesvn

我正在使用颠覆和 Visual Studio 2008（和 Tortoise）

我在 Visual Studio 项目中有许多要重命名的文件夹。

每当我过去尝试过这个时，我都会遇到冲突，不得不创建我的新文件夹，将所有现有内容复制到其中，签入并删除旧文件夹。

有没有人遇到过更直接的方法来做到这一点，或者有一套可靠的过程来重命名 Visual Studio 和 Subversion 中的文件夹？

提前致谢，

克里斯。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-19T09:35:41.390

TortoiseSVN 有一个功能可以帮助在 SVN 之外执行移动和重命名，事后。

像往常一样重命名文件夹。然后右键单击根文件夹并选择 TortoiseSVN -> 检查修改。在该列表中，您将看到“oldfoldername missing”和“newfoldername unversioned”。Ctrl-单击它们，然后右键单击并选择“修复移动”。

这样，您可以利用 VS 的重构工具重命名文件夹和文件，但不会弄乱 SVN。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T09:31:45.967

有两种解决方案。第一个：

1.  在 Visual Studio 中右键单击该文件夹，然后选择“从项目中排除”
2.  你用 Subversion/TortoiseSVN/whatever 重命名目录（当然，你必须用 subversion 客户端的 rename 命令重命名文件夹，否则你会遇到麻烦）
3.  您再次将该文件夹添加到 Visual Studio 项目中

第二种方法：您为 Visual Studio 下载一些 SVN 插件，例如[VisualSVN](http://www.visualsvn.com/)或[AnkhSVN](http://ankhsvn.open.collab.net/)，并使用它们在 Visual Studio 中安全地重命名文件夹。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T09:30:39.900

Tortoise SVN 具有内置的重命名功能。右键单击文件夹，单击 Tortoise SVN，单击重命名。当然，您必须检查您的更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T09:31:42.550

使用 VisualSVN，我可以在 Visual Studio 中更改文件夹名称。

没有它，我必须从VS中的项目中删除文件夹，SVN通过Tortoise重命名文件夹，然后将新重命名的文件夹读入VS项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T09:33:02.207

使用 TortoiseSVN 右键单击​​要移动的文件夹并按住按钮拖动到新位置。然后 TortoiseSVN 将向您显示一个带有选项的菜单....应该这样做:-)

干杯

麦克风

# ibm-midrange - 我在 RPGLE 中整数类型的标准选择应该是什么？

> ID：1017130
> 
> 赞同：4
> 
> 时间：2009-06-19T09:37:01.057
> 
> 标签：ibm-midrange, rpgle

当我想要一个 RPGLE 程序中的整数时，我应该选择什么数据类型？我说的是一个不对应于数据库中任何字段的整数，只是一个普通的通用整数——相当于`int`Java 中的 an。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-23T13:52:39.643

以下是 ILE RPG 程序员参考指南中的图表：

```
byte -  3I 0  (1-byte integer)
short-  5I 0  (2-byte integer)
int  - 10I 0  (4-byte integer)
long - 20I 0  (8-byte integer) 
```

我最常使用整数的 10I 0 形式。您会发现它也用于您的大多数 API 调用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-06-19T16:57:31.557

您可以使用二进制（有符号整数）（B）或整数（无符号整数）（I）类型。您可以使用数字值 3（1 字节）、5（2 字节）、10（4 字节）或 20（8 字节）来指定大小。Java int 的等价物是 10B。

# vb.net - 迭代 .NET 中给定类型的所有属性

> ID：1017133
> 
> 赞同：1
> 
> 时间：2009-06-19T09:37:23.290
> 
> 标签：vb.net, reflection

如果我有一个复杂的结构，其中包含简单类型和复杂类型的属性，我如何迭代该结构的所有属性以及任何非简单类型的子属性？

我有一个名为 file 的复杂类型，其中包含许多字符串属性和一些包含类似结构的其他复杂类型，最终整个结构分解为字符串。

目前我的代码如下所示：

```
Dim file As New File
Dim props() As PropertyInfo = file.GetType.GetProperties()
_propList = New CheckBoxList

For Each prop As PropertyInfo In props

    _propList.Items.Add(prop.Name)

Next 
```

此代码使用我的文件类型的子属性的所有名称加载我的复选框列表。我真正想要的是一个列表，其中包含构成文件的所有复杂类型的字符串类型的所有属性名称。

我对反思很陌生，所以我不知道如何处理这个问题。

### 更新

谢谢你到目前为止的建议。我使用类似于提供的 C# 代码的 Visual Basic 代码创建了一个递归函数。代码现在如下所示：

```
Private Function GetStringPropertyNames(ByVal Type As System.Type) As List(Of String)

    Dim props() As PropertyInfo = Type.GetProperties
    Dim propList As New List(Of String)

    For Each prop As PropertyInfo In props

        If prop.Name <> "Chronology" And _
                prop.Name <> "Documents" And _
                prop.Name <> "Milestones" And _
                prop.Name <> "DiaryEntries" And _
                prop.Name <> "FileLoadSuccesful" And _
                prop.Name <> "FileLoadError" Then

            Dim boo As Boolean = False
            Dim bootype As Type = boo.GetType
            Dim dec As Decimal
            Dim decType As Type = dec.GetType

            If prop.PropertyType Is "".GetType Or _
                prop.PropertyType Is Now.GetType Or _
                prop.PropertyType Is bootype Or _
                prop.PropertyType Is decType Then

                propList.Add(prop.Name)

            Else

                Dim listChildPropertyStrings As List(Of String) = GetStringPropertyNames(prop.PropertyType)

                For Each strProp As String In listChildPropertyStrings

                    propList.Add(prop.Name & ": " & strProp)
                Next
            End If
        End If
    Next
    Return propList
End Function 
```

这可行，但很难看，而且我对某些块一点也不满意，特别是类型比较以确定这是日期、字符串、十进制还是布尔值，这些是我想要退出的潜在低级类型.

在 C# 中，这些类型比较似乎更容易，但我似乎必须创建给定类型的实例才能使用 GetType 来返回其类型。

还有其他方法可以清理此代码吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T09:41:16.447

查尔斯，您走在正确的轨道上，请记住：“递归”。

正如您抱怨 VB.NET 中类型比较的“丑陋”一样，请记住，您也可以将类型比较为：

```
If TypeOf obj Is GetType(DataType) Then 
```

就像你在 C# 中所做的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T10:15:50.107

尝试这样的事情：

```
public static void GetProperties(Type t)
{
    foreach (PropertyInfo prop in t.GetProperties())
    {
        Console.WriteLine(prop.Name);

        if (prop.PropertyType.IsClass && prop.PropertyType != typeof(String))
        {
            GetProperties(prop.PropertyType);
        }
    }
} 
```

# command-line - SourceSafe 备份脚本 - 最好的方法？

> ID：1017134
> 
> 赞同：0
> 
> 时间：2009-06-19T09:37:34.457
> 
> 标签：command-line, powershell, backup, batch-file, visual-sourcesafe

我想知道创建组织的 SourceSafe 数据库备份并将其移动到另一台服务器上的共享的最佳方法是什么？目前我们有一个运行批处理文件的计划作业，该批处理文件又执行 PowerShell 脚本。

此 Powershell 脚本创建一个备份文件（使用 SourceSafe 命令行参数），将其移动到新服务器（通过在 SourceSafe 服务器上映射的驱动器），并通过 e- 将 SourceSafe 备份的输出发送给我们的管理员邮件。

这个过程*在*很大程度上是有效的，但我不禁觉得我们应该使用更简化的方法或工具。欢迎任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T14:53:30.340

SSARC 并不是真正的备份工具。我不会推荐它。它更像是一种在不同数据库之间剪切粘贴 VSS 存储库段的方法。它也不是没有副作用。至少，源数据库中的项目被标记为已归档。在最坏的情况下，它们会被删除。

最好的方法是让您的数据库脱机，将其压缩（或 RAR，等等），然后将 *.zip 文件复制到安全的地方。VSS 是在文件共享是 PC LAN 上唯一可靠可用的跨平台协议的时代设计的，因此文件系统*就是*数据库。与现代客户端-服务器系统相比，VSS 架构有许多缺陷，我相信您已经意识到了——但您不妨利用它的便利性来发挥自己的优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T09:45:31.773

查看[SSARC](http://jeays.net/files/vss-ssarc-ssrestor.htm) - [http://msdn.microsoft.com/en-us/library/t9d14fh1(VS.80).aspx](http://msdn.microsoft.com/en-us/library/t9d14fh1(VS.80).aspx)，但请考虑远离 SourceSafe！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-01T19:48:48.247

我们正在按照您所说的那样做，但也每晚都将其离线并检查完整性。它对我们来说已经工作了好几年。

# c# - 通过 C# 中的代码更改货币

> ID：1017139
> 
> 赞同：5
> 
> 时间：2009-06-19T09:39:54.187
> 
> 标签：c#

我正在使用以下内容来显示金额：

String.Format("{0:C}", item.Amount)

这个显示器 £9.99

没关系，但是如果我希望应用程序能够控制货币并能够将货币更改为当天

9.99 美元

如何通过代码更改货币格式

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-19T09:48:14.843

货币符号由 CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol 定义。该属性是读/写的，但如果您尝试更改它，您可能会遇到异常，因为 NumberFormatInfo.IsReadOnly 将是真的......

或者，您可以通过显式使用特定的 NumberFormatInfo 来格式化数字：

```
NumberFormatInfo nfi = (NumberFormatInfo)CultureInfo.CurrentCulture.NumberFormat.Clone();
nfi.CurrencySymbol = "$";
String.Format(nfi, "{0:C}", item.Amount); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T09:44:41.760

在对 的调用中指定文化`Format`：

```
 decimal value = 123.45M;
    CultureInfo us = CultureInfo.GetCultureInfo("en-US");
    string s = string.Format(us, "{0:C}", value); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:42:24.697

```
CultureInfo info = new CultureInfo (System.Threading.Thread.CurrentThread.CurrentCulture.LCID);
info.NumberFormat.CurrencySymbol = "EUR";

System.Threading.Thread.CurrentThread.CurrentCulture = info;

Console.WriteLine (String.Format ("{0:C}", 45M)); 
```

或者

```
NumberFormatInfo info = new NumberFormatInfo ();
info.CurrencySymbol = "EUR";

Console.WriteLine (String.Format (info, "{0:C}", 45M)); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-19T09:48:24.873

如果您更改金额的显示货币，那么您也在更改其计量单位。1 英镑 <> 1 欧元 <> 1 美元。您完全*确定*这里的业务需求吗？

# java - 使对象不可变的可能方法

> ID：1017140
> 
> 赞同：1
> 
> 时间：2009-06-19T09:40:34.560
> 
> 标签：java, immutability

我正在寻找一些有效的方法来构建一个不可变的类，就像 Java 的 String 类一样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T09:52:46.410

1.  所有字段必须是 `private`并且最好是`final`
2.  确保类不能被覆盖 - 使类最终，或使用静态工厂并保持构造函数私有
3.  必须从构造函数/工厂填充字段
4.  不要为字段提供任何设置器
5.  注意收藏。使用 `Collections.unmodifiable*`. 此外，集合应该只包含不可变对象
6.  所有 getter 必须提供不可变对象或使用[防御性复制](http://www.javapractices.com/topic/TopicAction.do?Id=15)
7.  不要提供任何改变对象内部状态的方法。

[Tom Hawtin](https://stackoverflow.com/users/4725/tom-hawtin-tackline)指出，这`final`可以是可选的。`String` `class`有一个`hash`仅在调用哈希函数时分配的缓存变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T09:43:07.753

如果一个对象的任何字段都不能修改，则该对象是不可变的，因此这些字段必须是`final`. 如果您不希望您的对象被子类化，您也可以创建类本身`final`，就像 String 一样。要轻松构造具有大量信息的不可变对象，您应该查看[工厂模式](http://en.wikipedia.org/wiki/Factory_pattern)

有关更多信息，请参阅[维基百科](http://en.wikipedia.org/wiki/Immutable_object)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:48:02.907

如果您使用构造函数填充所有字段并使这些字段成为最终字段 - 您已经完成了一半。

如果字段使用自定义类型 - 您可能还需要使它们不可变。

任何作为集合的字段都应该使用不可修改的集合——为了安全起见。

您需要担心对象图！

对象上的任何方法都需要注意非最终字段。例如，String.add 创建一个**新**字符串。如果您需要改变一个字段 - 通过复制构造函数进行。

最后使对象最终。

# asp.net-mvc - 是否有 web.config 设置指南？

> ID：1017143
> 
> 赞同：4
> 
> 时间：2009-06-19T09:41:35.400
> 
> 标签：asp.net-mvc, configuration

嗨，是否有指南或教程或某种参考来学习如何使用 asp/net mvc web.config 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:52:52.913

*   [MSDN - ASP.NET 配置概述](http://msdn.microsoft.com/en-us/library/ms178683.aspx)
*   [MSDN - ASP.NET 配置文件层次结构和继承](http://msdn.microsoft.com/en-us/library/ms178685.aspx)
*   [MSDN - ASP.NET 配置设置](http://msdn.microsoft.com/en-us/library/b5ysx397.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T09:54:24.703

如果您指的是“系统设置”的引用，请从 MSDN 中的此页面开始：[ASP.NET 配置文件语法](http://msdn.microsoft.com/en-us/library/zeshe0eb.aspx)

如果您正在寻找有关如何将自己的设置添加到 web.config 文件并从应用程序中读取它们的信息，请查看[ConfigurationManager 类](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings.aspx)

# asp.net - 重命名 ASP.NET_SessionId

> ID：1017144
> 
> 赞同：58
> 
> 时间：2009-06-19T09:41:47.960
> 
> 标签：asp.net

我需要重命名 ASP.NET 默认创建的 ASP.NET_SessionId cookie。假设我希望它被命名为“foo”。是否可以？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-06-19T09:50:54.430

添加到您的 web.config:-

```
<system.web>
    <sessionState cookieName="foo" />
</system.web> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-19T09:51:31.980

您可以`<sessionState>`在 web.config 文件的配置设置中进行设置：

```
<system.web>
    <sessionState cookieName="myCookieName" />
</system.web> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T09:50:36.040

请参阅[sessionState 元素](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)。查看 cookieName 属性，它将更改它的默认值“ASP.NET_SessionId”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T09:52:28.920

是的。您可以在 web.config 文件中执行此操作：

```
<sessionState cookieName="foo" /> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T09:50:33.793

我不记得正确，但我认为您可以通过更改`web.config`文件来重命名它。

搜索 的[`sessionState`](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)元素`web.config`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-06T14:33:53.797

如果有人来这里寻找与 ASP.NET Core 兼容的解决方案，通常可以在 Startup 中指定，作为 CookieBuilder 的参数，例如：

```
 .AddCookie(options =>
            {
                options.LoginPath = new PathString("/Login");
                options.Cookie = new CookieBuilder()
                {
                    IsEssential = true,
                    SameSite = SameSiteMode.Lax,
                    SecurePolicy = CookieSecurePolicy.SameAsRequest,
                    Name = "MyOwnCookieName"
                };
            }) 
```

# c# - 从 C#.net 2.0 迁移到 php 所以密码的哈希值 - 如何解决？

> ID：1017150
> 
> 赞同：2
> 
> 时间：2009-06-19T09:43:45.867
> 
> 标签：c#, php, hash, migrate, hmac

我们之前使用 C#.net 2.0 创建 Web 应用程序。

使用以下代码对用户密码进行哈希处理并存储在数据库中。

```
private const string encryptionKey = "AE09F72B007CAAB5";

HMACSHA1 hash = new HMACSHA1();
hash.Key = HexToByte(encryptionKey);
encodedPassword = Convert.ToBase64String(
    hash.ComputeHash(Encoding.Unicode.GetBytes(password))); 
```

现在我们打算迁移到 php。

因此，当用户想要重新加入时，我们会遇到问题。

应该使用该方法的什么 php 等效项，以便数据库中的哈希值起作用？

例如，编码密码是 pa55w0rd 得到的哈希值是 oK9NOVhpTkxLoLfvh1430SFb5gw=

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:12:53.963

在您的 C# 应用程序中，您以两种不同的方式生成 byte[] 数组，结果略有不同。您的 PHP 脚本需要准确地模拟它们。

> hash.Key = HexToByte(encryptionKey)

你传入一个 16 个字符长的字符串并得到一个 8 个字节的数组，就像`hash.Key = new byte[]{0xAE, 0x09, 0xF7, 0x2B, 0x00, 0x7C, 0xAA, 0xB5 };`但是

```
string password = "pa55w0rd";
byte[] b = Encoding.Unicode.GetBytes(password)
```

由于 Encoding.Unicode，返回一个包含 16 个元素的数组，例如在您的 php 脚本中，您可以使用[$data = mb_convert_encoding($password, 'UTF16-LE')](http://php.net/mb_convert_encoding)`byte[] b = { 0x112, 0x0, 0x97, 0x0, 0x53, 0x0, 0x53, 0x0, 0x119, 0x0, 0x48, 0x0, 0x114, 0x0,0x100, 0x0 }`
将 $password 的编码更改为 utf-16le以实现类似的结果. hash_hmac() 不知道任何编码会将字符串视为 16 字节单字节编码字符串，就像 .net 中的 hash.ComputeHash(byte[]) 一样。

```
<?php
$password = "pa55w0rd";
$key = HexToBytes("AE09F72B007CAAB5"); // 8 bytes, hex

// $to must be 'UTF-16LE'
// $from depends on the "source" of $password
$data = mb_convert_encoding($password, 'UTF-16LE', 'ASCII');

// I've saved this script as an ascii file -> the string literal is ASCII encoded
// therefore php's strlen() returns 8 for $password and 16 for $data
// this may differ in your case, e.g. if the contents of $password comes from a
// http-request where the data is utf-8 encoded. Adjust the $from parameter for
// mb_convert_encoding() accordingly
echo 'Debug: |data|=', strlen($data), ' |password|=', strlen($password), "\n";  

$h = HexToBytes(hash_hmac('sha1', $data, $key));
echo 'hmac-sha1: ', base64_encode($h);

function HexToBytes($s) {
  // there has to be a more elegant way...
  return join('', array_map('chr', array_map('hexdec', str_split($s, 2))));
} 
```

印刷

```
调试：|数据|=16 |密码|=8
hmac-sha1: ok9NOVhpTkxLoLfvh1430SFb5gw=
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:00:48.373

使用 .Net 版本的 PHP ( [Phalanger](http://www.php-compiler.net/doku.php) ) 或使用 .Net 网络服务进行编码/解码不是一种选择？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T10:20:03.967

尝试类似：

```
<?php
 $key = "AE09F72B007CAAB5";
 echo base64_encode(hash_hmac("sha1", "test", $key, true));
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T10:20:55.090

在 C# 中，哈希的默认格式是 HEX（AE09F72B007CAAB5 是一个十六进制数字）。PHP 默认为 Base64 格式。解决您的问题是将base64字符串转换为php中的十六进制的问题

# sql - 子查询相关

> ID：1017151
> 
> 赞同：0
> 
> 时间：2009-06-19T09:43:46.100
> 
> 标签：sql, rdbms

如果内部子查询返回零行，那么答案是什么？没有行返回，会显示外部查询结果，错误...</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T09:48:58.727

在标量上下文中，子查询将返回：

*   `NULL`如果`0`行返回
*   返回`1`行时返回的值
*   如果`2`返回或更多行返回错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T09:47:08.167

这取决于您使用子查询的目的。如果是显示数据，子查询的结果是`null`. 如果您将其用于内部联接，则联接操作将不返回任何行。

# svn - 颠覆和 Windows Server 2008

> ID：1017165
> 
> 赞同：0
> 
> 时间：2009-06-19T09:47:37.277
> 
> 标签：svn, windows-server-2008

我在我的 windows server 2008 上安装了[subversion 。但它只能在 localhost 上工作。](http://subversion.tigris.org/)当我从另一台计算机尝试时它不起作用。我无法找出问题所在。我需要配置任何端口或类似的东西吗？

[这是我遵循的指南](http://blogs.vertigosoftware.com/teamsystem/archive/2006/01/16/Setting_up_a_Subversion_Server_under_Windows.aspx)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T10:11:15.840

让我们也添加解决方案作为答案。当您运行独立的 svnserve 服务器时，您需要设置防火墙以允许流量到主机上的端口 3690。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:58:56.787

您是否尝试过使用它 - 我们正在使用它 - 免费且易于设置。

[http://www.visualsvn.com/server/](http://www.visualsvn.com/server/)

乔什

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-13T14:18:10.213

我遇到了同样的问题。确保 svnserve 使用 IP V4 而不是 IP V6。您可以通过将参数 **--listen-host 0.0.0.0**添加 到 svnserve 的命令行来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-15T12:25:21.343

转到免费的 DNS 服务，例如 DynDNS 或 no-ip.com，并注册一个免费的域，例如 fluffybunnytail.dyndns.org。然后您必须下载 IP 更新客户端（DynDNS 和 No-IP 都有自己的客户端）。然后，客户端将在 DNS 服务器上随时更新您的 IP。这样您就可以随时通过您注册的域名访问SVN 服务器（例如fluffybunnytail.dyndnds.org）。

# django - 来自 Django/Python 的 HTML 渲染结果中的空字符串

> ID：1017172
> 
> 赞同：8
> 
> 时间：2009-06-19T09:48:34.140
> 
> 标签：django

给定

```
siteInfo = \
{
    'appname3': 'MSQuantDynamics11',
    'siteBase': 'http://www.pil.sdu.dk/1',
} 
```

在“urls.py”文件中。

这按预期工作：

```
urlpatterns = patterns('',
    (r'^$',  direct_to_template,                         \
      {                                                  \
        'template'     : "homepage.html",                \
        'extra_context': { 'siteInfo': siteInfo },       \
      }
    ),
) 
```

为什么它不适用于以下内容？（homepage.html中“{{ siteInfo.appname3 }}”的结果变成了emtpy）：

```
urlpatterns = patterns('',
    (r'^$',  direct_to_template,                         \
      {                                                  \
        'template'     : "homepage.html",                \
        'extra_context': siteInfo,                       \
      }
    ),
) 
```

如果将“siteInfo.appname3”更改为其他内容，它会起作用吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T09:53:34.287

使用`{{ appname3 }}`而不是`{{siteInfo.appname3}}` .

因为键值对`{{appname3}}`可以在模板中直接访问，而不是通过`{{ siteInfo.key }}`.

在第一个示例中，您正在创建一个要传递给 的 dict `extra_context`，其键为`siteInfo`，值为`dict` `siteInfo`。在第二个中，您将`dict` `siteInfo`直接通过。

# sql-server - SQL Server SELECT 语句导致阻塞

> ID：1017177
> 
> 赞同：18
> 
> 时间：2009-06-19T09:50:09.177
> 
> 标签：sql-server, performance, blocking

我们正在使用带有大型 select 语句的 SQL Server 2005 数据库（无行版本控制），并且我们看到它阻止其他语句运行（使用 看到`sp_who2`）。我没有意识到 SELECT 语句可能会导致阻塞 - 我能做些什么来缓解这种情况吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-19T09:58:14.603

SELECT 可以阻止更新。正确设计的数据模型和查询只会导致最小的阻塞并且不会成为问题。'通常' WITH NOLOCK 提示几乎总是错误的答案。正确的答案是调整您的查询，使其不会扫描巨大的表。

如果查询不可调，那么您应该首先考虑[SNAPSHOT ISOLATION level](http://msdn.microsoft.com/en-us/library/ms179599.aspx)，其次您应该考虑使用[DATABASE SNAPSHOTS](http://msdn.microsoft.com/en-us/library/ms179599.aspx)并且最后一个选项应该是 DIRTY READS （并且最好更改[隔离级别](http://msdn.microsoft.com/en-us/library/ms189122(SQL.90).aspx)而不是使用 NOLOCK HINT）。请注意，脏读，顾名思义，将返回不一致的数据（例如，您的总工作表可能不平衡）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-19T09:55:17.230

从[**文档**](http://msdn.microsoft.com/en-us/library/ms175519.aspx)：

> `Shared (S)`锁允许并发事务`(SELECT)`在悲观并发控制下读取资源。有关详细信息，请参阅`Types of Concurrency Control`。`shared (S)`当资源上存在锁时，没有其他事务可以修改数据。`Shared (S)`读取操作完成后立即释放资源上的锁，除非事务隔离级别设置为可重复读取或更高，或者使用锁定提示`shared (S)`在事务期间保留锁。

A`shared lock`与另一个共享锁或更新锁兼容，但与排他锁不兼容。

这意味着您的`SELECT`查询将阻塞`UPDATE`和`INSERT`查询，反之亦然。

查询从`SELECT`表中读取数据块时会放置一个临时共享锁，并在完成读取时将其移除。

在锁定存在期间，您将无法对锁定区域中的数据进行任何操作。

两个`SELECT`查询永远不会互相阻塞（除非它们是`SELECT FOR UPDATE`）

您可以在数据库上启用`SNAPSHOT`隔离级别并使用它，但请注意，它不会阻止`UPDATE`查询被`SELECT`查询锁定（这似乎是您的情况）。

但是，它将防止`SELECT`查询被`UPDATE`.

另请注意`SQL Server`，与 不同的是`Oracle`，它使用锁管理器并将其锁定在内存链表中。

这意味着在重负载下，仅仅放置和删除锁可能会很慢，因为链表本身应该被事务线程锁定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T11:53:12.767

要执行脏读，您可以：

```
 using (new TransactionScope(TransactionScopeOption.Required, 
 new TransactionOptions { 
 IsolationLevel = System.Transactions.IsolationLevel.ReadUncommitted }))
 {
 //Your code here
 } 
```

或者

```
SelectCommand = "SELECT * FROM Table1 WITH (NOLOCK) INNER JOIN Table2 WITH (NOLOCK) ..." 
```

请记住，您必须在要脏读的每个表之后写入 WITH (NOLOCK)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T09:58:10.843

您可以将[事务级别](http://msdn.microsoft.com/en-us/library/aa259216(SQL.80).aspx)设置为读取未提交

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T13:32:14.377

您可能还会遇到死锁：

“只涉及一张表的死锁” [http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/01/reproduce-deadlocks-involving-only-one-table.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/01/reproducing-deadlocks-involving-only-one-table.aspx)

和/或不正确的结果：

“在 READ COMMITTED 和 REPEATABLE READ 下选择可能会返回不正确的结果。”

[http://www2.sqlblog.com/blogs/alexander_kuznetsov/archive/2009/04/10/selects-under-read-committed-and-repeatable-read-may-return-incorrect-results.aspx](http://www2.sqlblog.com/blogs/alexander_kuznetsov/archive/2009/04/10/selects-under-read-committed-and-repeatable-read-may-return-incorrect-results.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-06T06:31:08.940

您可以使用`WITH(READPAST)`表格提示。它不同于`WITH(NOLOCK)`. 它将在事务开始之前获取数据，并且不会阻止任何人。想象一下，您在事务开始之前运行了语句。

```
SELECT * FROM table1  WITH (READPAST) 
```

# c++ - 从函数返回结构，如何检查它是否已初始化？

> ID：1017185
> 
> 赞同：5
> 
> 时间：2009-06-19T09:52:09.843
> 
> 标签：c++, null

我在 C++ 中有以下结构：

```
struct routing_entry {
        unsigned long destSeq;  // 32 bits
        unsigned long nextHop   // 32 bits
        unsigned char hopCount; // 8 bits
}; 
```

我有以下功能：

```
routing_entry Cnode_router_aodv::consultTable(unsigned int destinationID ) {    
    routing_entry route;

    if ( routing_table.find(destinationID) != routing_table.end() )
        route = routing_table[destinationID];

    return route; // will be "empty" if not found
} 
```

"routing_table" 是一个 stl::map 定义如下：

```
map< unsigned long int, routing_entry > routing_table; 
```

我现在的问题是，当使用consultTable函数时，我想检查返回值是否真的被初始化了，有些像Java伪代码（因为我来自Java阵营）：

```
Route consultTable(int id) {
    Route r = table.find(id);
    return r;
} 
```

然后检查 r == null

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-19T10:10:04.813

这里有几个问题。最紧急的可能是找不到目标 ID 时会发生什么。由于您没有构造函数`routing_entry`并且您没有默认初始化，因此它将具有未定义的值。

```
// the data inside route is undefined at this point
routing_entry route; 
```

处理此问题的一种方法是默认初始化。这通过指示编译器用零填充结构来工作。这是从 C 中借来的一种技巧，但在这里效果很好。

```
routing_entry route={0}; 
```

您提到您来自 Java，与 Java 不同，结构和类成员未初始化为 0，因此您应该以某种方式真正处理它。另一种方法是定义构造函数：

```
struct routing_entry
{
  routing_entry()
  : destSeq(0)
  , nextHop(0)
  , hopCount(0)
  { }

            unsigned long destSeq;  // 32 bits
            unsigned long nextHop;   // 32 bits
            unsigned char hopCount; // 8 bits
}; 
```

另请注意，在 C++ 中，integer 和 char 成员的大小不是以位为单位定义的。char 类型是 1 个字节（但一个字节是一个未定义的，但通常是 8 位）。如今，long 通常是 4 个字节，但也可以是其他值。

继续你的`consultTable`，初始化固定：

```
routing_entry Cnode_router_aodv::consultTable(unsigned int destinationID )
{    
  routing_entry route={0};

  if ( routing_table.find(destinationID) != routing_table.end() )
        route = routing_table[destinationID];

  return route; // will be "empty" if not found
} 
```

一种判断方法可能是检查结构是否仍然归零。我更喜欢重构让函数返回`bool`以指示成功。此外，为了简单起见，我总是 typedef STL 结构，所以我会在这里这样做：

```
typedef map< unsigned long int, routing_entry > RoutingTable;
RoutingTable routing_table; 
```

然后我们传入对要填充的路由条目的引用。这对编译器来说可能更有效，但在这里可能无关紧要 - 无论如何这只是一种方法。

```
bool Cnode_router_aodv::consultTable(unsigned int destinationID, routing_entry &entry)
{
  RoutingTable::const_iterator iter=routing_table.find(destinationID);
  if (iter==routing_table.end())
    return false;
  entry=iter->second;
  return true;
} 
```

你可以这样称呼它：

```
routing_entry entry={0};
if (consultTable(id, entry))
{
  // do something with entry
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T11:16:39.780

我为此找到的最好方法是使用[boost::optional](http://www.boost.org/doc/libs/1_39_0/libs/optional/doc/html/index.html)，它旨在完全解决这个问题。

你的函数看起来像这样：-

```
boost::optional<routing_entry> consultTable(unsigned int destinationID )
{    
  if ( routing_table.find(destinationID) != routing_table.end() )
    return routing_table[destinationID];
  else
    return boost::optional<routing_entry>()
} 
```

你的调用代码看起来像

```
boost::optional<routing_entry> route = consultTable(42);
if (route)
  doSomethingWith(route.get())   
else
  report("consultTable failed to locate 42"); 
```

通常，在 C++ 中，不赞成使用“out”参数（将指针或引用传递给对象，然后由被调用函数“填充”）。函数“返回”的所有内容都包含在返回值，并且没有修改函数参数可以使代码在长期内更具可读性和可维护性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T10:14:29.157

这是您问题的典型解决方案：

```
bool Cnode_router_aodv::consultTable(unsigned int destinationID, 
                                     routing_entry* route ) {    
  if ( routing_table.find(destinationID) != routing_table.end() ) {
    *route = routing_table[destinationID];
    return true;
  }
  return false;
} 
```

您可以使用引用代替指针；这是风格问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T11:20:50.117

首先请注意，在 C++ 中，与 Java 不同，用户可以定义值类型。这意味着一个 routing_entry 有 2^32 * 2^32 * 2^8 个可能的值。如果您愿意，您可以将 routing_entry 视为 72 位原始类型，尽管您必须小心类比。

因此，在 Java`route`中可以为 null，并且变量有 2^32 * 2^32 * 2^8 + 1 个有用的不同值`routing_entry`。在 C++ 中，它不能为空。在 Java 中，“空”可能意味着返回一个空引用。在 C++ 中，只有指针可以为空，并且`routing_entry`不是指针类型。所以在你的代码中，在这种情况下，“空”意味着“我不知道这个东西有什么价值，因为我从来没有初始化它或分配给它”。

在 Java 中，`routing_entry`将在堆上分配一个对象。在 C++ 中你不想这样做，除非你必须这样做，因为 C++ 中的内存管理需要付出努力。

你有几个（好的）选择：

1) 向路由条目添加一个字段，以表明它已被初始化。由于实现的填充和对齐要求，这可能不会使结构变得更大：

```
struct routing_entry {
    unsigned long destSeq;  // 32 bits on Win32\. Could be different.
    unsigned long nextHop   // 32 bits on Win32\. Could be different.
    unsigned char hopCount; // 8 bits on all modern CPUs. Could be different.
    unsigned char initialized; // ditto
}; 
```

为什么不使用布尔值？因为标准有助于允许`sizeof(bool) != 1`. 完全有可能将 bool 实现为 int，特别是如果您有一个旧的 C++ 编译器。这会使你的结构更大。

然后确保在你的函数中使用 0 值初始化结构，而不是堆栈上的任何垃圾：

```
routing_entry Cnode_router_aodv::consultTable(unsigned int destinationID ) {    
    routing_entry route = {};

    if ( routing_table.find(destinationID) != routing_table.end() )
        route = routing_table[destinationID];

    return route; // will be "empty" if not found
} 
```

并确保地图中的所有条目都将初始化字段设置为非零。调用者然后检查初始化。

2）使用现有字段的“魔术”值作为标记。

假设您从不处理 hopCount 为 0 的路由。然后，只要您如上所述进行 0 初始化，调用者就可以检查 hopCount ！= 0。类型的最大值也是很好的标志值 - 因为您重新将您的路线限制为 256 跳，您可能不会通过将它们限制为 255 跳来造成任何伤害。调用者不必记住这一点，而是向结构添加一个方法：

```
struct routing_entry {
    unsigned long destSeq;  // 32 bits
    unsigned long nextHop   // 32 bits
    unsigned char hopCount; // 8 bits
    bool routeFound() { return hopCount != (unsigned char)-1; }
}; 
```

然后你会像这样初始化：

```
routing_entry route = {0, 0, -1}; 
```

或者如果您担心将来更改字段的顺序或数量时会发生什么：

```
routing_entry route = {0};
route.hopCount = -1; 
```

调用者会：

```
routing_entry myroute = consultTable(destID);
if (myroute.routeFound()) {
    // get on with it
} else {
    // destination unreachable. Look somewhere else.
} 
```

3) 调用者传入一个`routing_entry`按指针或非常量引用。被调用者将答案填入其中，并返回一个值，指示它是否成功。这通常称为“输出参数”，因为它有点模拟返回 a`routing_entry` *和*bool 的函数。

```
bool consultTable(unsigned int destinationID, routing_entry &route) {    
    if ( routing_table.find(destinationID) != routing_table.end() ) {
        route = routing_table[destinationID];
        return true;
    }
    return false;
} 
```

来电者这样做：

```
routing_entry route;
if (consultTable(destID, route)) {
    // route found
} else {
    // destination unreachable
} 
```

顺便说一句，当使用地图时，您的代码会查找 ID 两次。您可以通过以下方式避免这种情况，尽管它不太可能对您的应用程序的性能产生明显影响：

```
map< unsigned long int, routing_entry >::iterator it =
    routing_table.find(destinationID);
if (it != routing_table.end()) route = *it; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T10:01:58.137

另一种方法是让你的函数返回一个状态值（HRESULT 或类似的），指示它是否已初始化，并将指向结构的指针作为参数之一传递。

在 C++ 中，通常会返回指示错误代码的状态（如果成功则返回 0），但这当然取决于您的编程习惯。

无论如何，只需传递一个指针并检查 null 就可以了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T10:56:45.920

作为输入 - 输出参数解决方案的替代方案，您可以按照 Uncle Bobs 的建议创建一个入口阅读器类。

```
typedef map< unsigned long int, routing_entry > routing_table_type;
routing_table_type routing_table;

//Is valid as long as the entry is not removed from the map
class routing_entry_reader 
{
    const routing_table_type::const_iterator routing_table_entry;  
    const routing_table_type& routing_table;

public: 
    routing_entry_reader( const routing_table_type& routing_table, int destination_id ) 
    : routing_table(routing_table),
      routing_table_entry( routing_table.find(destination_id) ) { 
    }

    bool contains_entry() const { 
        return  routing_table_entry!=routing_table.end(); 
    }

    const routing_entry& entryByRef() const {
        assert(contains_entry());
        return routing_table_entry->second;
    }
};

routing_entry_reader entry_reader(routing_table, destination_id);
if( entry_reader.contains_entry() )
{
    // read the values from the entry
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T11:01:54.570

```
 shared_ptr<routing_entry> Cnode_router_aodv::consultTable(unsigned int destinationID ) {    
  shared_ptr<routing_entry> route;

  if ( routing_table.find(destinationID) != routing_table.end() )
    route.reset( new routing_entry( routing_table[destinationID] ) );

  return route; // will be "empty" if not found
}

// using
void Cnode_router_aodv::test() 
{
  shared_ptr<routing_entry> r = consultTable( some_value );
  if ( r != 0 ) {
    // do something with r
  }
  // r will be freed automatically when leaving the scope.
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T11:19:55.047

天，

同意 1800 的大部分内容，我更倾向于让你的函数 ConsultTable 返回一个指向 routing_entry 结构的指针，而不是一个布尔值。

如果在表中找到该条目，则该函数返回一个指向新的 routing_entry 的指针。如果未找到，则返回 NULL。

顺便说一句，好答案，1800。

高温高压

干杯，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T20:43:55.993

在你的方法中

```
routing_entry Cnode_router_aodv::consultTable(unsigned int destinationID ) {

    routing_entry route;
    ...
    return route;
} 
```

您正在尝试返回一个自动的，即对象在本地堆栈框架上，对象。这永远不会做你想让它做的事情，因为当函数超出范围时，这个内存不可用。

您将需要创建对象，然后返回新创建的对象。我建议你参考 Scott Meyers Effective C++ 第三版，第 21 条。

# ruby-on-rails - Rails flash 消息保留两个页面加载

> ID：1017210
> 
> 赞同：71
> 
> 时间：2009-06-19T09:56:34.000
> 
> 标签：ruby-on-rails, ruby

我在 Rails 应用程序中使用 Flash 通知，代码如下：

```
flash[:notice] = "Sorry, we weren't able to log you in with those details."
render :action => :new 
```

Flash 消息在“新”操作上按预期呈现，但随后它也会显示在用户访问的下一页上（无论可能是什么）。它应该只显示一次，但有些东西让它一直存在。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-06-19T10:29:05.587

有两种方法可以解决这个问题：

*   [flash.now](https://api.rubyonrails.org/classes/ActionDispatch/Flash/FlashHash.html#method-i-now)
*   [flash.discard](https://api.rubyonrails.org/classes/ActionDispatch/Flash/FlashHash.html#method-i-discard)

一是使用

```
flash.now[:notice] 
```

当您的闪存必须在当前请求结束时被丢弃并且不打算在重定向后使用时。

第二个是打电话

```
flash.discard(:notice) 
```

在请求结束时。

标准闪存消息旨在为“下一个”请求保留。例如，您在处理创建或编辑请求时生成一个 Flash，然后将用户重定向到显示屏幕。当浏览器向显示屏幕发出下一个请求时，将显示 Flash。

如果您实际上在显示屏幕本身上生成了一个闪光灯，请使用`flash.now`.

[查看 Ruby on Rails API 文档以了解 Flash 哈希是如何工作的](http://api.rubyonrails.org/classes/ActionDispatch/Flash/FlashHash.html)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-19T10:07:54.397

好的，我解决了这个问题。绕过它的方法是使用：

```
flash.now[:notice] = "Sorry, we weren't able to log you in with those details."
render :action => :new 
```

关键部分是 flash.now[:notice] 而不是 flash[:notice]。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-07T07:07:23.017

或者你可以像这样调用动作

```
flash.now[:notice] = "Sorry, we weren't able to log you in with those details."
render 'new' #or render :new 
```

# sql - XML 嵌套文件夹内容

> ID：1017219
> 
> 赞同：0
> 
> 时间：2009-06-19T09:58:26.210
> 
> 标签：sql, xml, hierarchy

我有一个项目来更新 SSRS 实例上的所有报告，并认为我会在 Excel 中获取所有报告的列表，这样我就可以在更新每个报告时勾选它们。容易，我想。我不经常（根本）不使用它，但 XML 似乎很适合这个。我会有类似的东西：

```
<Server>
  <ReportFolder>
    <ReportFolder>
      <Report>
      </Report>
      <Report>
      </Report>
    </ReportFolder>
    <Report>
    </Report>
    <Report>
    </Report>
    <Report>
    </Report>
  </ReportFolder>
  <ReportFolder>
  </ReportFolder>
</Server> 
```

Catalog 表是我的数据源，它具有 ItemID 和 ParentID，因此我可以识别对象及其层次结构，但我无法以 XML 形式获取完整的服务器，如果我指定文件夹（名称或ItemID) 但不是整个服务器。一旦我取出 WHERE ItemID = 1234 行，我会得到如下信息：

```
<Server>
  <ReportFolder>
  </ReportFolder>
  <ReportFolder>
  </ReportFolder>
  <ReportFolder>
  </ReportFolder>
    <Report>
    </Report>
    <Report>
    </Report>
    <Report>
    </Report>
    <Report>
    </Report>
    <Report>
    </Report>  
</Server> 
```

我已经尝试过 CTE 的 XML AUTO、XML EXPLICIT，现在我觉得我与 XML 的分离是有道理的！

有没有办法以 XML 形式获得完整的（最多 4 级）层次结构？

这是否与 XML 无关，而我走错了路，陷入了死胡同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T13:49:45.197

所以，好消息和坏消息。这是好消息。

```
CREATE FUNCTION [dbo].[GetReportTree](@ItemId uniqueidentifier)
RETURNS XML
BEGIN RETURN 
  (SELECT   ca.ItemId AS '@ItemId',
            ca.Name AS '@Name',
            ca.Type AS '@Type',
            dbo.GetReportTree(ca.ItemId)
   FROM dbo.Catalog ca
   WHERE (@ItemId IS NULL AND ParentId IS NULL) OR ParentID=@ItemId
   FOR XML PATH('CatalogItem'), TYPE)
END

SELECT dbo.[GetReportTree](NULL) 
```

产生这样的层次结构：

```
<CatalogItem Name="" Type="1">
  <CatalogItem Name="ScrumTest" Type="1">
    <CatalogItem Name="(Hidden) Delta Report Small" Type="2" />
    <CatalogItem Name="(Hidden) Product Burndown Chart Small" Type="2" />
    <CatalogItem Name="(Hidden) Product Cumulative Flow Small" Type="2" />
    <CatalogItem Name="(Hidden) Sprint Burndown Chart Small" Type="2" />
    <CatalogItem Name="All Product Backlog Items" Type="2" />
    <CatalogItem Name="All Sprint Backlog Items" Type="2" />
    <CatalogItem Name="All Sprints" Type="2" />
    <CatalogItem Name="Current Sprint Status" Type="2" />
    <CatalogItem Name="Delta Report" Type="2" />
    <CatalogItem Name="Engineering Reports" Type="1">
      <CatalogItem Name="(Hidden) Bug History Chart Small" Type="2" />
      <CatalogItem Name="Bug Count" Type="2" />
      <CatalogItem Name="Bug History Chart" Type="2" />
      <CatalogItem Name="Bug Priority Chart" Type="2" />
    </CatalogItem>
    <CatalogItem Name="Impediment Report" Type="2" />
    <CatalogItem Name="Product Backlog Composition" Type="2" />
    <CatalogItem Name="Product Burndown Chart" Type="2" />
    <CatalogItem Name="Product Cumulative Flow" Type="2" />
    <CatalogItem Name="Retrospective Report" Type="2" /> 
```

坏消息是，如果不将“ReportTree”功能添加到您的 ReportServer 中，我不确定您是否可以做到这一点。因此，这取决于您对该服务器的访问权限。您也许可以让该功能跨数据库工作，我没有尝试过。

# javascript - 动态设置文件输入的值

> ID：1017224
> 
> 赞同：67
> 
> 时间：2009-06-19T10:00:08.843
> 
> 标签：javascript, html, dom, google-gears

有没有办法设置文件输入（`<input type="file" />`）的值，还是为了安全而被阻止？我正在尝试使用 google gears 的 openFiles 来制作一个简单的多上传器。

> **笔记：**
> 
> 下面的答案反映了 2009 年旧版浏览器的状态。现在，您实际上可以在 2017 年使用 JavaScript 动态/编程地设置文件输入元素的值。
> 
> 有关详细信息以及演示，请参阅此问题中的答案：
> [如何以编程方式设置文件输入值（即：拖放文件时）？](https://stackoverflow.com/q/47515232/584192)

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-06-19T10:04:48.663

无法动态更改文件字段的值，否则您可以将其设置为“c:\yourfile”并很容易窃取文件。

然而，多上传系统有很多解决方案。我猜你想要一个多选打开对话框。

也许看看[http://www.plupload.com/](http://www.plupload.com/) - 这是一个非常灵活的多文件上传解决方案，并且支持拖放区等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-19T08:01:55.433

我正在开发一个有角度的 js 应用程序，并且遇到了类似的问题。我所做的是显示数据库中的图像，然后创建一个按钮来删除或保留当前图像。如果用户决定保留当前图像，我将 ng-submit 属性更改为另一个不需要图像验证的函数，并在不触及原始图像路径名称的情况下更新数据库中的记录。删除图像功能还将 ng-submit 属性值更改回提交表单并包括图像验证和上传的功能。还有一些 javascript 可以滑动到视图中以上传新图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-06T16:10:25.133

我最终为 AngularJS 做了这样的事情，以防有人偶然发现这个问题：

```
const imageElem = angular.element('#awardImg');

if (imageElem[0].files[0])
    vm.award.imageElem = imageElem;
    vm.award.image = imageElem[0].files[0]; 
```

进而：

```
if (vm.award.imageElem)
    $('#awardImg').replaceWith(vm.award.imageElem);
    delete vm.award.imageElem; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-03-18T05:14:10.290

我有类似的问题，然后我尝试用 JavaScript 编写它并且它有效！：`referenceToYourInputFile.value = "" ;`

# sql - NULL 值如何影响数据库搜索的性能？

> ID：1017239
> 
> 赞同：48
> 
> 时间：2009-06-19T10:05:15.230
> 
> 标签：sql, database, oracle, database-performance, query-performance

在我们的产品中，我们有一个通用的搜索引擎，并试图优化搜索性能。查询中使用的许多表都允许空值。我们是否应该重新设计我们的表以禁止空值进行优化？

我们的产品同时在`Oracle`和上运行`MS SQL Server`。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-19T10:24:45.550

在`Oracle`,`NULL`值没有被索引，即这个查询：

```
SELECT  *
FROM    table
WHERE   column IS NULL 
```

将始终使用全表扫描，因为索引不涵盖您需要的值。

不仅如此，这个查询：

```
SELECT  column
FROM    table
ORDER BY
        column 
```

出于同样的原因，还将使用全表扫描和排序。

如果您的值本质上不允许`NULL`'，则将该列标记为`NOT NULL`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-19T10:15:54.117

简短的回答：是的，有条件的！

空值和性能的主要问题与前向查找有关。

如果您将一行插入到表中，并且具有空值，它将被放置在它所属的自然页面中。任何查找该记录的查询都会在适当的位置找到它。到目前为止很容易......

...但是假设页面已填满，现在该行被拥抱在其他行之间。还是顺利...

...直到行被更新，并且空值现在包含一些东西。该行的大小已超出其可用空间，因此数据库引擎必须对其进行处理。

服务器做的最快的事情是将该行*从*该页面移到另一个，并用前向指针替换该行的条目。不幸的是，这需要在执行查询时进行额外的查找：查找行的自然位置，查找行的当前位置。

因此，您的问题的简短回答是肯定的，使这些字段不可为空将有助于搜索性能。如果您搜索的记录中的空字段经常更新为非空字段，则尤其如此。

当然，还有其他与较大数据集相关的惩罚（特别是 I/O，尽管索引深度很小），然后您会遇到应用程序问题，即在概念上需要它们的字段中不允许空值，但是，这是另一个问题 :)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-20T09:07:38.510

一个额外的答案，以引起对 David Aldridge 对 Quassnoi 接受的答案的评论的额外关注。

该声明：

> 这个查询：
> 
> SELECT * FROM table WHERE column IS NULL
> 
> 将始终使用全表扫描

不是真的。下面是使用带有文字值的索引的反例：

```
SQL> create table mytable (mycolumn)
  2  as
  3   select nullif(level,10000)
  4     from dual
  5  connect by level <= 10000
  6  /

Table created.

SQL> create index i1 on mytable(mycolumn,1)
  2  /

Index created.

SQL> exec dbms_stats.gather_table_stats(user,'mytable',cascade=>true)

PL/SQL procedure successfully completed.

SQL> set serveroutput off
SQL> select /*+ gather_plan_statistics */ *
  2    from mytable
  3   where mycolumn is null
  4  /

  MYCOLUMN
----------

1 row selected.

SQL> select * from table(dbms_xplan.display_cursor(null,null,'allstats last'))
  2  /

PLAN_TABLE_OUTPUT
-----------------------------------------------------------------------------------------
SQL_ID  daxdqjwaww1gr, child number 0
-------------------------------------
select /*+ gather_plan_statistics */ *   from mytable  where mycolumn
is null

Plan hash value: 1816312439

-----------------------------------------------------------------------------------
| Id  | Operation        | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers |
-----------------------------------------------------------------------------------
|   0 | SELECT STATEMENT |      |      1 |        |      1 |00:00:00.01 |       2 |
|*  1 |  INDEX RANGE SCAN| I1   |      1 |      1 |      1 |00:00:00.01 |       2 |
-----------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - access("MYCOLUMN" IS NULL)

19 rows selected. 
```

如您所见，该索引正在被使用。

问候，罗布。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-10-19T00:47:00.837

我会说测试是必需的，但很高兴了解其他人的经验。根据我在 ms sql server 上的经验，空值可以而且确实会导致大量性能问题（差异）。现在在一个非常简单的测试中，我看到查询在 45 秒内返回，当在 table create 语句中的相关字段上设置了 not null 并且超过 25 分钟没有设置时（我放弃了等待，只是在估计的查询计划）。

测试数据为 100 万行 x 20 列，由 i5-3320 普通 HD 和 8GB RAM（SQL Server 使用 2GB）/Windows 8.1 上的 SQL Server 2012 Enterprise Edition 上的 62 个随机小写字母组成。使用随机数据/不规则数据使测试成为现实的“更糟糕”的情况非常重要。在这两种情况下，表都被重新创建并重新加载了随机数据，这些数据在已经有适当可用空间的数据库文件上花费了大约 30 秒。

```
select count(field0) from myTable where field0 
                     not in (select field1 from myTable) 1000000

CREATE TABLE [dbo].[myTable]([Field0] [nvarchar](64) , ...

 vs

CREATE TABLE [dbo].[myTable]([Field0] [nvarchar](64) not null, 
```

出于性能原因，两者都有表选项 data_compression = page set，其他一切都是默认的。没有索引。

```
alter table myTable rebuild partition = all with (data_compression = page); 
```

没有空值是我没有专门使用的内存优化表的要求，但是 sql server 显然会做最快的事情，在这种特定情况下，这似乎很大程度上支持在数据中没有空值并在表创建。

此表上相同形式的任何后续查询将在两秒内返回，因此我假设标准默认统计信息并且可能使 (1.3GB) 表适合内存运行良好。IE

```
select count(field19) from myTable where field19 
                       not in (select field18 from myTable) 1000000 
```

另一方面，没有 null 并且不必处理 null 情况也使查询更简单、更短、更不容易出错并且通常更快。如果可能的话，最好至少在 ms sql server 上避免空值，除非它们是明确要求的并且不能合理地从解决方案中解决。

从一个新表开始，并将其大小调整为 10m 行/13GB，相同的查询需要 12 分钟，考虑到硬件和没有使用的索引，这是非常可观的。对于信息查询完全是 IO 绑定的，IO 徘徊在 20MB/s 到 60MB/s 之间。重复相同的查询需要 9 分钟。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-19T11:00:04.307

如果您的列不包含 NULL，最好声明此列`NOT NULL`，优化器可能会采用更有效的路径。

但是，如果您的列中有 NULL，则您没有太多选择（非空默认值可能会产生比它解决的问题更多的问题）。

正如 Quassnoi 提到的，NULL 在 Oracle 中没有索引，或者更准确地说，如果所有索引列都是 NULL，则不会对行进行索引，这意味着：

*   NULL 可能会加速您的研究，因为索引的行数会更少
*   如果将另一个 NOT NULL 列添加到索引甚至是常量，您仍然可以索引 NULL 行。

以下脚本演示了一种索引 NULL 值的方法：

```
CREATE TABLE TEST AS 
SELECT CASE
          WHEN MOD(ROWNUM, 100) != 0 THEN
           object_id
          ELSE
           NULL
       END object_id
  FROM all_objects;

CREATE INDEX idx_null ON test(object_id, 1);

SET AUTOTRACE ON EXPLAIN

SELECT COUNT(*) FROM TEST WHERE object_id IS NULL; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-19T21:40:11.013

在执行“NOT IN”查询时，可为空的字段会对性能产生很大影响。因为所有索引字段都设置为 null 的行没有在 B-Tree 索引中编制索引，所以 Oracle 必须执行全表扫描以检查 null 整体，即使存在索引也是如此。

例如：

```
create table t1 as select rownum rn from all_objects;

create table t2 as select rownum rn from all_objects;

create unique index t1_idx on t1(rn);

create unique index t2_idx on t2(rn);

delete from t2 where rn = 3;

explain plan for
select *
  from t1
 where rn not in ( select rn
                     from t2 );

---------------------------------------------------------------------------
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |      | 50173 |   636K|  3162   (1)| 00:00:38 |
|*  1 |  FILTER            |      |       |       |            |          |
|   2 |   TABLE ACCESS FULL| T1   | 50205 |   637K|    24   (5)| 00:00:01 |
|*  3 |   TABLE ACCESS FULL| T2   | 45404 |   576K|     2   (0)| 00:00:01 |
--------------------------------------------------------------------------- 
```

查询必须检查空值，因此它必须对 t1 中的每一行进行 t2 的全表扫描。

现在，如果我们使字段不可为空，它可以使用索引。

```
alter table t1 modify rn not null;

alter table t2 modify rn not null;

explain plan for
select *
  from t1
 where rn not in ( select rn
                     from t2 );

-----------------------------------------------------------------------------
| Id  | Operation          | Name   | Rows  | Bytes | Cost (%CPU)| Time     |
-----------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |        |  2412 | 62712 |    24   (9)| 00:00:01 |
|   1 |  NESTED LOOPS ANTI |        |  2412 | 62712 |    24   (9)| 00:00:01 |
|   2 |   INDEX FULL SCAN  | T1_IDX | 50205 |   637K|    21   (0)| 00:00:01 |
|*  3 |   INDEX UNIQUE SCAN| T2_IDX | 45498 |   577K|     1   (0)| 00:00:01 |
----------------------------------------------------------------------------- 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-19T17:15:55.853

是否因为 Null 影响性能而使用它们的问题是数据库设计的平衡行为之一。您必须平衡业务需求与性能。

如果需要，应使用空值。例如，您可能在表格中有开始日期和结束日期。您通常不会知道创建记录时的结束日期。因此，无论是否影响性能，您都必须允许空值，因为数据根本不存在。但是，如果根据业务规则，数据必须在创建记录时存在，那么您不应该允许空值。这将提高性能，使编码更简单，并确保保持数据完整性。

如果您想要更改现有数据以不再允许空值，那么您必须考虑该更改的影响。首先，您知道需要将什么值放入当前为空的记录中？其次，您是否有很多代码正在使用`isnull`或`coalesce`你需要更新哪些（这些东西会降低性能，所以如果你不再需要检查它们，你应该更改代码）？你需要一个默认值吗？你真的可以分配一个吗？如果不考虑该字段不能再为空，则某些插入或更新代码会中断。有时人们会输入不良信息以使他们摆脱空值。所以现在价格字段需要包含十进制值和“未知”之类的东西，因此不能正确地成为十进制数据类型，然后你必须去各种长度才能进行计算。这通常会产生与创建的 null 一样糟糕或更糟的性能问题。另外，您需要检查所有代码，以及您在哪里使用过引用该文件为 null 或不为 null 的文件，

我从客户端数据进行了大量数据导入，每次我们得到一个文件，其中一些应该允许空值的字段不允许，我们得到需要在导入系统之前清理的垃圾数据。电子邮件就是其中之一。通常在不知道该值的情况下输入数据，并且通常是某种类型的字符串数据，因此用户可以在此处键入任何内容。我们去导入电子邮件并找到“我不知道”的东西。很难尝试实际向“我不知道”发送电子邮件。如果系统需要一个有效的电子邮件地址并检查是否存在 @ 符号之类的东西，我们会得到“I@dont.know”这样的垃圾数据对数据的用户有什么用处？

一些与 null 相关的性能问题是由编写 nonsargable 查询造成的。有时只是重新排列 where 子句而不是消除必要的 null 可以提高性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T11:21:46.463

根据我的经验，NULL 是一个有效值，通常意味着“不知道”。如果您不知道，那么为该列添加一些默认值或尝试强制执行一些 NOT NULL 约束确实是没有意义的。NULL 恰好是一种特殊情况。

NULL 的真正挑战是它使检索变得有点复杂。例如，您不能说 WHERE column_name IN (NULL,'value1','value2')。

就个人而言，如果您发现很多列，或者某些列包含很多 NULL，我认为您可能需要重新访问您的数据模型。也许那些空列可以放入子表中？例如：一个带有电话号码的表格，其中包括姓名、家庭电话、手机、传真号码、工作号码、紧急号码等……您可能只填充其中的一两个，这样会更好地对其进行规范化。

您需要做的是退后一步，看看如何访问数据。这是一个应该有值的列吗？这是仅在某些情况下具有值的列吗？这是一个会被大量查询的列吗？

# version-control - 使用版本控制时处理跨多台机器的 web.config 差异

> ID：1017240
> 
> 赞同：7
> 
> 时间：2009-06-19T10:05:16.400
> 
> 标签：version-control, xslt, msbuild, web-config

我相信每个人都必须处理这些情况，我们检查我们的源代码控制解决方案，每台开发机器都有自己的资源用于调试、构建和测试。

最常见的是：

*   网络服务器 (IIS)
*   数据库 (SQL)

Web 服务器很容易处理，每台开发机器都会有自己的 proj.user 文件来指定不同的调试信息。

但是应用程序的连接字符串存储在 web.config 中（受源代码控制），理想情况下，我们不希望 web.config 被“感知”，因此必须执行配置部分，将它们委托给其他配置文件（不在 sc 下）不会是最好的解决方案..

asp.net (.net?) 已经支持具有 web.config 继承的模型，这将是一个理想的场景。但是这只适用于目录。

如果我们能有那就太好了

*   web.config <-- 在版本控制下
*   web.machine.config <-- 不受版本控制

当然，我愿意就人们如何解决这个问题提出更好的建议。

就像..也许有：

*   web.base.config <-- 在版本控制下
*   web.machine.config <-- 不受版本控制

并拥有一个通过合并它们来创建 web.config 的构建脚本？

在此先感谢斯蒂芬。

* * *

**编辑**

看起来下一个 vs 可能有办法处理这个问题：

[http://blogs.msdn.com/webdevtools/archive/2009/05/04/web-deployment-web-config-transformation.aspx](http://blogs.msdn.com/webdevtools/archive/2009/05/04/web-deployment-web-config-transformation.aspx)

* * *

**编辑**

今天可能可以使用 xml 大规模更新：

[http://blogs.microsoft.co.il/blogs/dorony/archive/2008/01/18/easy-configuration-deployment-with-msbuild-and-the-xmlmassupdate-task.aspx](http://blogs.microsoft.co.il/blogs/dorony/archive/2008/01/18/easy-configuration-deployment-with-msbuild-and-the-xmlmassupdate-task.aspx)

* * *

**编辑编辑编辑**

好吧，它当然可以通过一个简单的 xslt 构建任务和一个复制所有内容并拦截某些属性的小转换来完成。只是尝试了一个概念证明，这将为我们节省很多挫折，但转换文件可能比人们更多愿意接受。

基本上，我们将 Web.base.config 存储在版本控制中，并通过转换运行它以在构建事件上生成 Web.config。

似乎 vs2010 在拥有一个更友好的版本方面确实会有所帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T10:44:22.420

我有时使用的一种方法是将特定于环境的部分分解为单独的配置文件，这些文件通常被排除在部署之外（第一次或结构发生变化时除外）：

连接字符串示例： 在 web.config 中：

```
<connectionStrings configSource="connections.config"></connectionStrings> 
```

connections.config 文件（通常不包含在部署中；所以它没有改变）：

```
<?xml version="1.0"?>
<connectionStrings>
    <add name="connectionName" connectionString="[connection string goes here]"/>
</connectionStrings> 
```

像这样，我们创建了信息的“封装”，并且可以轻松地处理诸如源控制、部署等信息的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-23T12:17:05.467

虽然肯定有很多解决方案，但它们都没有真正让您对生成的配置进行大量控制，这是我在编辑中提到的一种解决方案，您可以获得大量控制但必须编写 xslt 开销文件，正在使用 xslt 构建任务来使用来自源代码控制的模板 web.config/app.config（我个人命名为 web.base.config/app.base.config），并使用 xslt 文件来转换版本控制在构建时配置文件，并生成 web.config/app.config。

这是一个[xslt 构建任务](http://www.arlt.eu/blog/2007/10/01/msbuild-xslt-task/)的示例（尽管您可能希望将其写入您自己的编码标准），以及一个普通的 xslt 转换示例，它将更改连接字符串的值并复制配置中的所有其他内容：

```
<?xml version="1.0" encoding="utf-8"?>  
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">  
  <xsl:output method="xml" indent="yes"/>  

  <!-- Copy all. -->  
  <xsl:template match="@* | node()">  
      <xsl:copy>  
          <xsl:apply-templates select="@* | node()"/>  
      </xsl:copy>  
  </xsl:template>  

  <!-- Swap connection string. -->
  <xsl:template match="/configuration/connectionStrings/add[@name='my_connection_string_name']">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
      <xsl:attribute name="connectionString">my replacement connection string value</xsl:attribute>
    </xsl:copy>  
  </xsl:template>

</xsl:stylesheet> 
```

这是一个平庸的例子，但您可以想象您可以完全转换以前在基于继承的场景中遇到困难的整个部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T10:58:11.177

应用程序的配置可以分为两类。

1.  特定应用
2.  特定于部署

特定于应用程序的配置包括缓存实现、业务规则实现等内容，并将应用于应用程序的每个部署。这应该进入 web.config 文件，该文件是应用程序目录结构的一部分，并已检查到源代码管理中。

特定于部署的配置包括连接字符串、超时时间等，并且可能因部署而异。这应该作为部署中涉及的 IIS 实例配置的一部分输入，并由相关机器的任何备份策略保留。

据我所知，这正是 web.config 文件的分层特性旨在处理的内容。

这种安排的优点是......

1.  无需担心哪个开发人员的设置版本最终会进入源代码控制，因为它们都不会。
2.  每个部署都使用相同的二进制文件，因此部署问题更可能涉及部署配置。
3.  后续部署应该不需要特定于部署的配置更改，因为它们已经到位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-30T08:26:59.950

VS 2010 将为您提供大量控制来管理各种配置的 web.config 文件...[请查看](http://vishaljoshi.blogspot.com/2009/03/web-deployment-webconfig-transformation_23.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T10:15:43.790

我们不在 web.config 中存储环境设置。它们存储在数据库中。

这使我们能够进行 xcopy 部署，并将 web.config 文件存储在我们的版本控制系统中。

通过一个注册表项访问数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T14:09:10.540

您所描述的内容听起来很像使用 Machine.config 文件来存储连接字符串。我还没有看到提到过，所以你试过吗？看起来您也可以使用位于 Machine.config 旁边的全局 Web.config。

几个链接：

[ASP.NET 配置文件层次结构和继承](http://msdn.microsoft.com/en-us/library/ms178685.aspx)

[Web.config 和 Machine.config 之间的区别](http://24x7aspnet.blogspot.com/2009/06/difference-between-webconfig-and.html)

# symbian - symbian中的HashMap

> ID：1017242
> 
> 赞同：1
> 
> 时间：2009-06-19T10:05:20.690
> 
> 标签：symbian

我想在 symbian 中实现 Hashmap

这需要两个值

有没有实施它的机构

有类 RHashMap,RHashTable 但我想传递描述符和值

或者

否则还有其他解决方案吗

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T11:40:00.280

我认为文档没有明确说明您可能应该拥有一个包含整数和描述符的类。

您需要实现的 THashFunction32 采用您的类的一个实例并返回它的整数成员。

您需要实现的 TIdentityRelation 采用您的类的两个实例并比较整数成员。

当您将类的实例插入 RHashMap 时，整数和描述符成员都需要具有有意义的值。

当您想从 RHashMap 中检索描述符时，您可以创建类的实例，但只设置整数成员值。将该对象用作 RHashMap::Find() 的参数，它将返回包含您要查找的描述符的类的实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-20T14:07:42.423

RHashMap 是一个模板类型。您可以使用您需要的任何类，如下所示：

```
RhashMap<TInt,TPtr> map;
map.Insert(myInt,myDes);

...

myDes = map.FindL(myInt);
TInt error = map.Remove(myInt);
User::LeaveIfError(error);
map.Close(); 
```

编辑：如果您想要一个键指向两件事，那么只需将这两件事封装在一个对象中。

# nhibernate - NHibernate - 如何强制执行唯一性？

> ID：1017245
> 
> 赞同：1
> 
> 时间：2009-06-19T10:06:40.763
> 
> 标签：nhibernate, unique

我的情况如下：

*   我有一些可以标记的对象（消息）
*   所以我有一个标签实体和多对多关系
*   以上已完成并且正在工作
*   现在，在标记时，我只想在新标签不存在时保存新标签（标签标题检查存在）
*   如果标签已经存在，我希望它被识别并附加到我的对象而不是新对象

最简单/最干净的方法是什么？

顺便说一句，出于某些原因，我想为我的标签实体使用人工主键（数字 ID）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:02:48.610

你有一个多对多的关系，你可以在你的业务类中表达它并用 NHibernate 映射。解决多对多关系的链接表结构将防止一个对象多次链接到同一个标签。

在您的问题中强制执行规则的唯一方法是通过代码。任务顺序类似于：

1.  将用户输入的标签列表解析为单个标签
2.  循环遍历标签...

    一种。如果标签存在，则将其添加到对象的标签集合中

    湾。否则创建一个新标签并将其添加到对象的标签集合中

3.  持久化对象

您需要添加逻辑来查找现有标签，同时考虑拼写错误、大写和替代用法。例如，您不希望使用表示它们相同但不等于字符串的标记，例如“ASPNET”或“ASP.NET”或“asp.net”。标签列表的质量将取决于检查现有标签的代码的健壮程度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:19:11.583

只是为了澄清 - 一个标签可以固定在许多对象上，一个对象可以有许多标签。这就是多对多关系对我的意义。你是这个意思吗？

当您在 SQL 中执行此操作时，您将拥有名为 TAG 和 OBJECT 的表以及名为 TAG_OBJECT 的连接表，该表包含两列，一列用于其他表中的每个主键。TAG_OBJECT 连接表中的主键是对 (TAG_ID, OBJECT_ID)。这保证了每一行的唯一配对。

如果您使用 Hibernate，您只需将对象列表或集合作为私有数据成员添加到您的 Tag 类，并将标签列表或集合作为私有数据成员添加到您的 Object 类。

我认为 Hibernate 将处理您的“仅当它不存在时”，只要您编写一个好的方法来确定两个 Tag 实例之间的“深度相等”。

您还应该为标签标题属性添加一个唯一约束。这是一个不太适合您需求的示例，因为它是 Java 和 XML，但也许该提示足以告诉您在哪里寻找 NHibernate：

```
<element column="serialNumber" type="long" not-null="true" unique="true"/> 
```

对于您的情况，列将是标签标题，类型是字符串，其他标志保持与示例中的一样。

# api - 如何测试 Berkley 套接字 (BSD) API？

> ID：1017248
> 
> 赞同：1
> 
> 时间：2009-06-19T10:08:00.667
> 
> 标签：api, sockets, embedded, berkeley-sockets

我想测试 BSP API 实现的正确性和完整性。测试集必须针对 ARM sam7x 进行交叉编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:44:49.187

我不知道您是否对此感兴趣，但这里有两个指向 NYC BSD Conference 2008 演示文稿的链接：[Detecting TCP regressions with tcpdiff](http://www.silby.com/nycbsdcon08/NYCBSDCon-tcpdiff.pdf) (FreeBSD) 和[An Introduction to the Automated Testing Framework (ATF) for NetBSD](http://www.nycbsdcon.org/2008/files/vidal_atf.pdf)。两者都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T19:01:28.687

有一个[用于 TCP 和 UDP 性能测量的公共领域基准测试工具](http://www.pcausa.com/Utilities/pcattcp.htm)。

它有一些可用的控制。您也许可以将其用于测试。
请记住，这不是测试 API，而是执行性能，您需要的还不止这些。

> PCATTCP 工具包括几个选项，这些选项由程序启动时在命令行上传递的参数控制。要查看可用选项，请使用“-h”选项运行 PCATTCP 应用程序。这是你会看到的：

```
pcattcp -h
PCAUSA Test TCP Utility V2.01.01.08

Usage: pcattcp -t [-options] host [ < in ]
   pcattcp -r [-options > out]

Common options:
-l ##  length of bufs read from or written to network (default 8192)
-u     use UDP instead of TCP
-p ##  port number to send to or listen at (default 5001)
-s     toggle sinkmode (enabled by default)

        sinkmode enabled:
           -t: source (transmit) fabricated pattern
           -r: sink (discard) all received data
        sinkmode disabled:
           -t: reads data to be transmitted from stdin
           -r: writes received data to stdout

-A     align the start of buffers to this modulus (default 16384)
-O     start buffers at this offset from the modulus (default 0)
-v     verbose: print more statistics
-d     set SO_DEBUG socket option
-b ##  set socket buffer size (if supported)
-f X   format for rate: k,K = kilo{bit,byte}; m,M = mega; g,G = giga
-c       -t: send continuously
         -r: accept multiple connections sequentially
-R     concurrent TCP/UDP multithreaded receiver 
```

.

```
Options specific to -t:
-n ##  number of source bufs written to network (default 2048)
-D     don't buffer TCP writes (sets TCP_NODELAY socket option)
-w ##  milliseconds of delay before each write (default 0)
-L ##  desired transmit data rate in bytes/second

Options specific to -r:
-B     for -s, only output full blocks as specified by -l (for TAR)
-T     "touch": access each byte as it's read 
```

# caching - 如果 FindNextUrlCacheEntry() 失败，如何再次检索失败条目的信息？

> ID：1017251
> 
> 赞同：3
> 
> 时间：2009-06-19T10:08:57.750
> 
> 标签：caching, wininet

`ERROR_INSUFFICIENT_BUFFER`调用时出现错误`FindNextUrlCacheEntry()`。然后我想使用扩大的缓冲区再次检索失败的条目。但是我发现当我调用 时`FindNextUrlCacheEntry()`，似乎我正在检索失败条目旁边的那个。有什么方法我可以回去检索刚刚失败的条目的信息吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-07T19:26:44.250

我还在 XP 上观察到了同样的行为。我正在尝试使用 WinInet API 以编程方式清除 IE 缓存。以下 MSDN 链接中的代码在 Win7/Vista 上运行良好，但在 XP 上批量（多次运行）删除缓存文件。在调试时，我发现 API FindNextUrlCacheEntry 在多次执行时会为同一个条目提供不同的大小。

MSDN 链接： http: [//support.microsoft.com/kb/815718](http://support.microsoft.com/kb/815718)

这是我正在做的事情：

首先，我调用以确定下一个 URL 条目的大小

fSuccess = FindNextUrlCacheEntry(hCacheHandle, 0, &cacheEntryInfoBufferSizeInitial) // 此时cacheEntryInfoBufferSizeInitial = 0

上述调用返回 false，错误号为 INSUFFICIENT_BUFFER，并且 cacheEntryInfoBufferSizeInitial 参数设置为检索缓存条目所需的缓冲区大小，以字节为单位。在分配所需的大小 (cacheEntryInfoBufferSizeInitial) 后，我再次调用相同的 WinInet API，期望它这次成功检索条目。但有时它会失败。我看到即使使用所需的缓冲大小（仅由它确定）API 再次失败的情况，因为它期望的字节数多于它之前检索的字节数。大多数时候差异只有几个字节，但我也看到差异几乎是 4 到 5 倍的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-18T15:20:51.167

对于它的价值，这似乎在 Vista 中得到了解决。

# wcf - 我理解 MsmqPoisonMessageException 错误吗？

> ID：1017253
> 
> 赞同：1
> 
> 时间：2009-06-19T10:10:03.660
> 
> 标签：wcf, exception, msmq

如果我有这样的服务定义：

```
[PoisonErrorBehavior]
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall, ConcurrencyMode = ConcurrencyMode.Multiple)]
public class MsgQueue: IMsgQueue
{
    public void ProcessMsg(CustomMsg msg)
    {
       throw new Exception("Test");
    }
} 
```

（其中 ProcessMsg 是传入 msmq-messages 的注册方法）

我想用我的错误处理程序处理异常（我从 msdn 获取代码作为我的模板）：

```
public sealed class PoisonErrorBehaviorAttribute : Attribute, IServiceBehavior
    {
        MsmqPoisonMessageHandler poisonErrorHandler;

        public PoisonErrorBehaviorAttribute()
        {
            this.poisonErrorHandler = new MsmqPoisonMessageHandler();
        }

        void IServiceBehavior.Validate(ServiceDescription description, ServiceHostBase serviceHostBase)
        {
        }

        void IServiceBehavior.AddBindingParameters(ServiceDescription description, ServiceHostBase serviceHostBase, System.Collections.ObjectModel.Collection<ServiceEndpoint> endpoints, BindingParameterCollection parameters)
        {
        }

        void IServiceBehavior.ApplyDispatchBehavior(ServiceDescription description, ServiceHostBase serviceHostBase)
        {
            foreach (ChannelDispatcherBase channelDispatcherBase in serviceHostBase.ChannelDispatchers)
            {
                ChannelDispatcher channelDispatcher = channelDispatcherBase as ChannelDispatcher;
                channelDispatcher.ErrorHandlers.Add(poisonErrorHandler);
            }
        }
    }

    class MsmqPoisonMessageHandler : IErrorHandler
    {
        public void ProvideFault(Exception error, MessageVersion version, ref System.ServiceModel.Channels.Message fault)
        {
        }

        public bool HandleError(Exception error)
        {
            string test = error.GetType().ToString();
            //
            // The type of the exception is never MsmqPoisonMessageException !!!
            //
            MsmqPoisonMessageException poisonException = error as MsmqPoisonMessageException;
            if (null != poisonException)
            {
                long lookupId = poisonException.MessageLookupId;
                Console.WriteLine(" Poisoned message -message look up id = {0}", lookupId);
            }
       } 
```

然后我得到的问题是异常永远不是 MsmqPoisonMessageException 类型。我本来希望 .NET 能神奇地将我的“new Exception("Test")”封装在 MsmqPoisonMessageException 中，但是在我的错误处理程序中捕获的异常始终与我抛出的异常类型相同。

我是否误解了整个有毒信息行为？我认为如果我的消息处理代码引发了未处理的异常，那么异常将变成 MsmqPoisonMessageException，因为否则我将没有机会在队列中获取 msg 的查找 ID。

谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-28T12:59:11.547

WCF 将异常封装在错误异常中。

[http://msdn.microsoft.com/en-us/library/system.servicemodel.faultexception.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.faultexception.aspx)

您还必须指定要在接口/合同中引发哪些异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-28T19:20:28.930

首先，您需要在事务中检索消息，否则当您的代码抛出异常时，它们不会被放回队列中。将此添加到 ProcessMessage 函数：

```
[OperationBehavior(TransactionScopeRequired = true, TransactionAutoComplete = true)] 
```

此外，您需要确保在检测到有害消息时将绑定设置为错误，并且重试次数和时间足够小，以便您可以在测试中看到它。

尝试以下步骤（使用 VS 2008）：

1.  打开 app.config 文件的 WCF 配置工具
2.  在树中选择 Bindings，然后在任务区域中单击“New Binding Configuration”
3.  选择端点的绑定类型（可能是 netMsmqBinding 或 msmqIntegrationBinding）
4.  设置新绑定配置的名称
5.  将 ReceiveErrorHandling 属性设置为“故障”
6.  将 ReceiveRetryCount 属性设置为 2
7.  将 RetryCycleDelay 设置为“00:00:10”
8.  选择服务的端点并将绑定配置设置为您在步骤 4 中指定的名称。

（对于生产配置，您可能需要不同的 ReceiveRetryCount 和 RetryCycleDelay 值。）

# java - 停止线程

> ID：1017259
> 
> 赞同：5
> 
> 时间：2009-06-19T10:11:00.537
> 
> 标签：java, multithreading, io

在Java应用程序中，当用户点击下载时，建立远程连接并从远程下载内容是在一个单独的线程中完成的，并且屏幕中会弹出一个对话框以显示下载进度。现在，取消命令已添加到对话框中，以便为用户提供取消下载的选项。当用户点击取消按钮时，可以使用程序中的 dispose() 方法处理对话框，但是如何停止/杀死已经启动的线程？线程执行以下任务： 1.建立与远程的连接 2.从远程下载内容 3.将内容存储在本地（内容通过流传输）请帮我解决这个问题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T10:27:07.540

停止线程可能是错误的看待方式。桌面机器上单个线程消耗的实际资源是无关紧要的。将其视为中止下载。

如果读取被阻塞，那么这并不是什么大问题。您可以等到有一些数据后再不再读取。一种更突然的方法是调用`close`流（从另一个线程）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T10:16:30.260

您需要在下载例程中的某处检查停止标志。

```
public DownloadThread implements Runnable {
    private boolean stop;
    public void stop() { stop = true; }
    public void run() {
        while (!stop) {
            // download a block, save it somewhere
        }
    }
} 
```

当然，这缺少必要的同步，但这是关于如何在不使用已弃用的[Thread.stop()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#stop())的情况下停止线程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T10:17:00.883

首先，不推荐使用 java.util.Thread 上的 stop() 操作，强烈建议不要使用它，因为它会使事情处于不稳定状态。最好向 Thread 的 Runnable 发送一条消息，要求它安全地停止自己。

您遇到的问题是您的线程正在执行阻塞 I/O 操作，因此在 I/O 完成之前它不会收到您的消息。

除非其他人提出更好的选择，否则您所能期望的最好的方法是中断（）线程，并希望 I/O 类注意到并停止下载。

编辑： Thread.interrupt() 的 javadoc 确实说如果您使用 java.nio 可以中断 I/IO，但您不太可能这样做。“正常” java.io 流量被阻塞，无法中断。

[为什么不推荐使用 Thread.stop、Thread.suspend 和 Thread.resume？](http://java.sun.com/j2se/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T10:27:42.733

我建议您执行 Bombe 建议的操作（使用 volatile 变量），然后让线程在后台停止运行，将控制权返回给用户。它可能会花费一些时间来获取最后一个块，但如果用户可以继续做其他事情，这并不重要。如果您的块大小相对较小，则浪费的带宽不会太多，并且 IO 内容最终会超时并在连接变坏时返回。

```
 public class Downloader {
    protected final AtomicBoolean run = new AtomicBoolean(false);
    protected final byte[] file;
    protected volatile double progress = 0.0;    

    public download(URL url) {
        run.set(true);
        new Thread() {
            @Override
            public run() {
                final ByteBuffer buffer = new ByteBuffer();
                while(run) {
                    /* download chunk, e.g add to buffer, or whatever */
                    buffer.put(chunk);
                    progress = buffer.size().size() / fileTotalSize; //e.g
                }
                syncrhonized(Downloader.this) {
                    file = buffer.array();
                }
            }
        }.start();
    }

    public void abort() {
        run.set(false);
    }

    public double getProgress() {
        return progress;
    }

    public synchronized byte[] getFile() {
        return file;
    }
} 
```

# mvvm - 如何在 MVVM 应用程序中进行 View/ViewModel 绑定，以便可以使用 Expression Blend？

> ID：1017276
> 
> 赞同：2
> 
> 时间：2009-06-19T10:17:04.473
> 
> 标签：mvvm, binding, expression-blend

当您使用**[MVVM Visual Studio Template](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=14962)**时，您的 ViewModel 将绑定到 App.xaml.cs 中的 View 的 DataContexts，如下所示：

```
MainView mainView = new MainView();
mainView.DataContext = new MainViewModel();
mainView.Show(); 
```

如果您使用**Composite Application Library**，那么您的 Views 和 ViewModels 在您的 Bootstrapper/Container/ServerLocator 等中绑定在一起。

在任何情况下，当您在 Expression Blend 中打开这些项目并打开一个 View XAML 文件时，**Expression blend 不知道哪个 ViewModel 属于哪个 View，**因为此绑定是在上述实例中的代码中完成的。

您当然可以在 XAML 中设置**DataObjectProvider**，以便 Expression Blend 知道从哪里获取该 View 的数据，但这会破坏 MVVM 和解耦模式，因为您的 View 现在已硬连接到特定的 ViewModel。**这就是设计师通常在不仅仅是一个小演示的项目上使用 Expression Blend 的方式吗？**

因此，对于那些使用 MVVM 模式并且拥有使用 Expression Blend 的设计师的人，您如何保持 View/ViewModel 绑定的结构化，以便 Expression Blend 可以知道哪个 ViewModel 属于哪个 View？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T10:42:00.817

Blend 确实加载并执行代码，即使它不运行应用程序。如果 DesignerProperties.GetIsInDesignMode(...) 在视图构造函数或其他更合适的方法中加载一些示例 DataContext。

# flash - Flash上 传文件后抓取服务器返回值

> ID：1017278
> 
> 赞同：0
> 
> 时间：2009-06-19T10:17:18.997
> 
> 标签：flash, upload, response, filereference

使用 ActionScript 2.0 的类将文件上传到 Web 服务器后`FileReference`，如何检索服务器的响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T16:41:07.950

我过去曾这样做过，但我不记得我是如何做到的，而且我无法访问我的旧源代码。

这是我找到的链接，希望对您有所帮助。同时，让我看看我是否可以得到我的旧代码的副本。

[http://www.actionscripts.org/forums/showthread.php3?t=157390](http://www.actionscripts.org/forums/showthread.php3?t=157390)

# actionscript-3 - Flex 缩放和滚动问题

> ID：1017279
> 
> 赞同：1
> 
> 时间：2009-06-19T10:17:32.193
> 
> 标签：actionscript-3, apache-flex, air, scrollbar, flex3

我需要通过 Hslider 缩放画布。问题是缩放画布后，我无法滚动到画布的最左侧和顶部，即左侧和顶部画布的某些部分不可见。我找不到原因。该示例的源代码如下所示。"

```
import mx.events.SliderEvent;

private function changeZoom(event:SliderEvent) : void
{
layout_cnv.scaleY = event.target.values[0]*2/100;
layout_cnv.scaleX = event.target.values[0]*2/100;
}

private function adjustDefaultZoom() : void
{
layout_cnv.scaleX = slider.values[0]/100*2;
layout_cnv.scaleY = slider.values[0]/100*2;
}

private function myDataTipFunc(val:String):String {
            return  String(val)+ "%";
        }

]]>
</mx:Script>

<mx:Panel title="Zoom Demo" width="100%" height="100%">

<mx:Canvas id="canvas" width="100%" height="100%"  horizontalScrollPosition="500">

<!--<mx:Image id="img" x="{canvas.width/2 - img.width/2}"
y="{canvas.height/2 - img.height/2}"
source="@Embed('../assets/products/Nokia_6630.png')"
creationComplete="adjustDefaultZoom()"
/>-->

<mx:Canvas visible="true" id="layout_cnv" creationComplete="adjustDefaultZoom()"  borderStyle="solid" height="300"

             width="500" verticalCenter="0" horizontalCenter="0"
              verticalScrollPolicy="off" horizontalScrollPolicy="off" backgroundColor="#FFFFFF">

        <mx:TextArea id="company_name_ta" visible="true"   selectable="true"  editable="true" height="20" backgroundAlpha="0.0" borderColor="#000000"  width="200" fontSize="14" 
            borderStyle="solid"  x="10" y="10" />
        <mx:TextArea id="job_ta" height="20"  selectable="true" borderColor="#000000" width="200"  x="289" y="10"  backgroundAlpha="0.0" textAlign="right"/>
        <mx:TextArea id="fullname_ta" height="20"    selectable="true" backgroundAlpha="0.0" borderColor="#000000" width="200"  x="10" y="38" editable="true" enabled="true"/>
        <mx:TextArea id="adress_line3_ta"  height="20" selectable="true" backgroundAlpha="0.0" borderColor="#000000"  width="200" x="10" y="268"/>
        <mx:TextArea id="adress_line2_ta"  height="20" selectable="true" backgroundAlpha="0.0" borderColor="#000000"  width="200"  x="10" y="240"/>
        <mx:TextArea id="adress_line1_ta" height="20"   selectable="true" backgroundAlpha="0.0" borderColor="#000000"  width="200" y="212" x="10"/>
        <mx:TextArea id="mobile_ta" height="20" selectable="true" backgroundAlpha="0.0" borderColor="#000000" width="200"  x="289" y="40"  textAlign="right"/>
        <mx:TextArea id="fax_ta"  height="20"  selectable="true" backgroundAlpha="0.0" borderColor="#000000" width="200" y="68" x="289"  textAlign="right"/>
        <mx:TextArea id="email_ta" height="20"  selectable="true" backgroundAlpha="0.0" borderColor="#000000" width="200" x="289" y="268" textAlign="right"/>
        </mx:Canvas>
</mx:Canvas>

<mx:ControlBar horizontalAlign="center">
<mx:HSlider id="slider"
width="400"
minimum="1"
maximum="100"
labels="['0%','100%']"
values="[50]" 
tickInterval="10"
snapInterval="1" 
liveDragging="true" 
change="changeZoom(event)"
 dataTipFormatFunction="myDataTipFunc" />

</mx:ControlBar>

</mx:Panel> 
```

"

请帮忙 。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T18:23:45.480

如果不是将可缩放画布居中，而是将其显示在其父级左上角的坐标处，则不会出现此问题。

或者，您可以根据其父级的大小计算所需的坐标，而不是让它们低于 0。

这里的代码会有所帮助：

```
private function calculateCoordinates() : void
{
    var x : Number = (canvas.width - layout_cnv.width) / 2;
    x = x < 0 ? 0 : x;
    var y : Number = (canvas.height - layout_cnv.height) / 2;
    y = y < 0 ? 0 : y;
    layout_cnv.move(x, y);
} 
```

您所要做的就是将此方法添加到您的应用程序中，然后

```
this.callLater(calculateCoordinates); 
```

在您的 changeZoom 和 adjustDefaultZoom 方法结束时。还要从 layout_cnv 中删除对齐属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T02:36:14.067

花了一段时间才弄清楚这一点。似乎由于您使用的是垂直中心和水平中心，因此画布被绘制在可视区域之外。当运行右键单击并选择“显示重绘区域”时，您可以清楚地看到画布在该区域之外。

一旦你删除了垂直中心和水平中心，它似乎正在工作（在滚动时看到所有的画布。）

另一方面，我不明白为什么要在同一个面板中放置两个画布，它们之间没有任何内容。也许这只是为了你的例子。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-09T16:40:53.057

//声明一个变量

```
[Bindable]
public var myborderColor: ColorPicker = new ColorPicker();

private function init():void
{
myborderColor:.selectedColor = Color.WHITE ; 
```

………… 在其他功能改变颜色

```
myborderColor:.selectedColor = Color.RED ;

mx:TextInput id=”myText” backgroundColor=”{numcasoborderColor.selectedColor}” 
```

# asp.net-mvc - 将 PDF 文件作为字节存储在 DB 中

> ID：1017280
> 
> 赞同：0
> 
> 时间：2009-06-19T10:17:44.220
> 
> 标签：asp.net-mvc, linq-to-sql

我正在使用 Asp.Net MVC。在我的项目中，在上传 PDF 文件时，我们将 PDF 文件转换为字节，然后将其存储在 DB 中。但我得到了以下例外。

" 字符串或二进制数据将被截断。语句已终止。"

任何人都可以解决这个问题。我在这里遇到了异常

context.SubmitChanges();

谢谢：苏雷什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:18:51.750

只需更改字段的大小，尝试 varbinary(MAX)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:28:31.937

这很可能是因为代码试图在数据库列中插入比其定义大小更多的数据/字节。

# c# - c#：“System.Object”和“object”之间的区别

> ID：1017282
> 
> 赞同：74
> 
> 时间：2009-06-19T10:18:49.930
> 
> 标签：c#, coding-style

`System.Object`在 C# 中，在代码中使用而不是仅仅`object`，或者`System.String`而不是`string`等等有什么区别？还是只是风格问题？

为什么一种形式比另一种形式更可取？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-06-19T10:27:30.520

`string`是 的别名`global::System.String`。它只是语法糖。两者*几乎*在所有情况下都是可以互换的，编译后的代码不会有任何区别。

我个人将别名用于变量名称等，但我将 CLR 类型名称用于 API 中的名称，例如：

```
public int ReadInt32() // Good, language-neutral

public int ReadInt() // Bad, assumes C# meaning of "int" 
```

（请注意，返回类型并不是真正的名称——它被编码为元数据中的一种类型，所以那里没有混淆。）

我知道一个可以使用而另一个不能（我知道）的唯一地方是：

*   `nameof` prohibits the use of aliases
*   When specifying an enum base underlying type, *only* the aliases can be used

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T10:34:28.760

The *object* type is an alias for *System.Object*. The *object* type is used and shown as a keyword. I think it has something to do with legacy, but that's just a wild guess.

Have a look at this [MSDN](http://msdn.microsoft.com/en-us/library/9kkx3h3c.aspx) page for all details.

I prefer the use of the lowercased versions, but for no special reasons. Just because the syntax highlighting is different on these "basic" types and I don't have to use the shift key when typing...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-19T10:20:15.697

一个是另一个的别名。它归结为风格。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T10:21:33.217

`string`是 和`global::System.String`的`object`别名`global::System.Object`

假设您`using System;`在课堂上拥有`String`/`string`和`Object`/`object`在功能上相同，并且用法是风格问题。

（编辑：根据 Jon Skeet 的评论，删除了[一些误导性的引用）](http://www.eggheadcafe.com/community/aspnet/2/76037/string-versus-string.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T10:25:05.300

`string`（带小写“s”）是C#语言的字符串类型，类型`System.String`是`string`.NET框架中的实现。

在实践中，除了风格上的差异之外没有任何区别。

**编辑：**由于上述显然不够清楚，它们之间没有区别，它们一旦编译就属于同一类型。我在解释编译器看到的语义差异（这只是语法糖，很像 while 和 for 循环之间的差异）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T10:21:37.613

没有区别。有许多类型，称为[原始数据类型](http://msdn.microsoft.com/en-us/library/ms228360(VS.80).aspx)，它们在您提到的样式中受到编译器的威胁。

大写的命名风格是 ISO 命名规则。它更普遍，更常见；对源中的所有对象强制使用相同的命名规则，C# 编译器的例外情况除外。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T10:22:55.600

据我所知，我知道这是一种快捷方式，使用字符串比使用 System.string 更容易。

但要小心 String 和 string 之间有区别（c# 区分大小写）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-11T13:28:52.520

*object*，*int*，*long*和*bool*被提供为工程师的**培训轮**，他们难以适应数据类型不是语言的固定部分的想法。与之前的语言不同，C# 对可以添加的数据类型的数量没有限制。'System' 库提供了一个入门工具包，其中包含诸如*System.Int32*、*System.Boolean*、*System.Double*、*System.DateTime等有用类型* and so on, but engineers are encouraged to add their own. Because Microsoft was interested in quick adoption of their new language, they provided aliases that made it appear as if the language was more 'C'-like, but these aliases are a completely disposable feature (C# would be just as good a language if you removed all the build-in aliases, probably better).

While StyleCop does enforce the use of the legacy C-style aliases, it is a blemish on an otherwise logical set of rules. As of yet, I've not heard a single justification for this rule (SA1121) that wasn't based on dogma. If you think SA1121 is logical, then why is there no buildin type for *datetime*?

# wix - Wix - 根据权限更改安装文件夹

> ID：1017294
> 
> 赞同：7
> 
> 时间：2009-06-19T10:21:51.920
> 
> 标签：wix, wix3

我必须使用 Wix 创建一个安装包。如果管理员用户正在安装软件包，它应该安装到 %programfiles%/[applicationName]，如果用户是非管理员用户，那么它应该安装到其本地配置文件文件夹（LocalAppDataFolder）中。

怎么可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T19:11:27.240

我很久以前为[ClickThrough写了这个。](http://wix.sourceforge.net/ctvision.html)解决方案看起来很像这样（您提供一个名为“ApplicationFolderName”的属性）：

```
 <Property Id="A" Secure="yes" />

    <DirectoryRef Id="TARGETDIR">
        <Directory Id="ApplicationFolder" Name="App" />
    </DirectoryRef>

    <Condition Message="Must specify TARGETDIR property when doing an administrative install.">Installed OR (ACTION="ADMIN" AND TARGETDIR&lt;&gt;"")</Condition>

    <CustomAction Id="TARGETDIRtoA" Property="A" Value="[TARGETDIR]" Execute="firstSequence" />

    <CustomAction Id="SpecifiedA" Property="ApplicationFolder" Value="[A]" Execute="immediate" />
    <CustomAction Id="PerMachineInstall" Property="ApplicationFolder" Value="[ProgramFilesFolder]\[ApplicationFolderName]" Execute="immediate" />
    <CustomAction Id="PerUserInstall" Property="ApplicationFolder" Value="[LocalAppDataFolder]\Apps\[ApplicationFolderName]" Execute="immediate" />

    <InstallUISequence>
        <Custom Action="SpecifiedA" Before="LaunchConditions">NOT Installed</Custom>
    </InstallUISequence>

    <InstallExecuteSequence>
        <Custom Action="PerMachineInstall" Before="CostFinalize">NOT Installed AND ACTION="INSTALL" AND A="" AND (ALLUSERS=1 OR (ALLUSERS=2 AND Privileged))</Custom>
        <Custom Action="PerUserInstall" Before="CostFinalize">NOT Installed AND ACTION="INSTALL" AND A="" AND (ALLUSERS="" OR (ALLUSERS=2 AND (NOT Privileged))</Custom>
    </InstallExecuteSequence> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-30T09:33:50.277

如下覆盖 ProgramFilesFolder 属性应该有效：

```
<SetProperty Id="ProgramFilesFolder" Value="[AppDataFolder]" Before="CostFinalize"><![CDATA[ NOT Privileged]]></SetProperty>

<Directory Id="ProgramFilesFolder" Name="PFiles">
    <Directory Id="INSTALLDIR" Name="My Folder">
        ...
    </Directory>
</Directory> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-20T13:23:02.337

将属性[ALLUSERS](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367559%28v=vs.85%29.aspx)设置为 2。另请参见[Single Package Authoring](http://msdn.microsoft.com/en-us/library/windows/desktop/dd408068%28v=vs.85%29.aspx)。

# sharepoint - 按 sharepoint 内容查询 webpart 中最流行的排序文档

> ID：1017302
> 
> 赞同：1
> 
> 时间：2009-06-19T10:24:02.290
> 
> 标签：sharepoint, sharepoint-2007, reporting

我想通过“查看次数最多”订购一组在内容查询 Web 部件中显示的网页 我知道 sharepoint 会跟踪此类事情，但我不知道如何将此列表公开给内容查询 Web 部件 - 任何人都可以我在正确的方向？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T11:39:59.470

确实，SharePoint 可以记录用户对磁盘上的使用情况日志和内容数据库中的审核日志的访问。但是没有 API 可以针对数据发出报告构建查询，例如针对大多数浏览页面的查询。您将需要开发或购买：

1.  开发：您可以为您的网站集打开审核日志并开发一个批处理作业，该作业会按计划对其进行扫描以查找新条目并更新包含查看次数最多的页面的自定义列表。有关使用审核日志的详细信息，请参阅[在 Windows SharePoint Services 3.0 中从审核日志中读取条目。](http://msdn.microsoft.com/en-us/library/bb466223.aspx)

2.  购买：要获得更灵活的报告解决方案并避免开发，您可以查看一些适用于 SharePoint 的第三方报告解决方案，例如[Nintex](http://www.nintex.com/en-US/Products/Pages/NintexReporting2008.aspx)、[Cardiolog](http://www.intlock.com/)或[MAPIlab](http://www.mapilab.com/sharepoint/statistics/)。

# java - java中的关键事件

> ID：1017310
> 
> 赞同：-1
> 
> 时间：2009-06-19T10:26:17.683
> 
> 标签：java

我已经尝试了很多......因为你们都给了我代码段作为解决方案......但仍然发生同样的错误......所以任何人都可以给我解决方案......机器人似乎是一个很大的疏忽不能用于输入基本的非字母数字字符。

是否有将字符转换为按键的跨平台 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T10:30:06.350

`KeyStroke.getKeyStroke()`

# actionscript-3 - 我应该使用哪些 Windows“性能监视器”设置来调试引发 InvalidBitmap 错误的 Flash 影片？

> ID：1017314
> 
> 赞同：0
> 
> 时间：2009-06-19T10:27:45.760
> 
> 标签：actionscript-3, memory, flash-cs4, bitmapdata

这是我的问题：

我有一个从本地机器上传文件的 Flash swf，如果它们是图像，它会根据需要调整它们的大小。这涉及从 bitmapData 对象创建一个 JPGEncoded bytearray。在我完成了 bitmapData 之后，我 dispose() 了它。

我注意到有时在调整图像大小时闪存会卡住，并且已将其追踪到“无效的 bitmapData”错误消息。我昨晚下班前试过了，它在两张图片后抛出了这条消息！！今天早上一切似乎都很好，所以我决定推送它并尝试上传 20 张 5616x3744 像素和 5.32MB 的图像（我之前尝试过的相同图像）。

我在 Windows 中打开了性能监视器，并开始在 mozilla + firebug 中运行的 SWF 中上传，以取得良好的效果。大约 12 张图像效果很好，然后在 13 日（！！）它再次冻结。我附上了性能图的截图。

[![替代文字](../Images/38d583386f15a984be32a3d4ce0ae514.png)](https://i.stack.imgur.com/msafM.jpg)

我猜我需要做更多这样的测试，看看哪里有问题。谁能解释一下我在这里看到的可能会导致问题的东西 - 黄线看起来很可疑！（？）

我认为大的绿色尖峰对应于重绘 bitmapData，较小的绿色尖峰是在大版本成功加载后从同一个 Bitmap 对象绘制缩略图版本。我应该使用哪些其他计数器来监视内存使用情况等。

任何建议表示赞赏。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-17T10:52:14.957

你的像素太多了，仅此而已。在 Flash Player 10 中，位图的最大像素数为 16,777,215（或 0xFFFFFF）。此外，最大宽度或高度为 8,191，只要总像素数低于最大值即可。您的测试位图有 21,026,304，远远超过顶部。

# sql-server - 在 LINQ 中自动连接外键的最有效方法

> ID：1017315
> 
> 赞同：0
> 
> 时间：2009-06-19T10:27:50.253
> 
> 标签：sql-server, linq, linq-to-sql

我有两个表用于跟踪我网站上的用户会话。顺便说一句，这是一个严重的过度简化：

```
 Campaign:
     campaignId    [int]
     campaignKey   [varchar(20)]
     description   [varchar(50)]

 Session:
     sessionDate   [datetime]
     sessionGUID   [uniqueidentifier]
     campaignId    [int]
     campaignKey   [varchar(20)] 
```

我想使用 LINQ 在 Session 中插入一条新记录：

```
 var s = new Session();
     dbContext.Session.InsertOnSubmit(s);

     s.sessionDate = DateTime.Now;
     s.sessionGUID = Guid.NewGuid();
     s.campaignKey = Request.Params["c"];
     // dont set s.campaignId here...

     dbContext.SubmitChanges(); 
```

请注意，我目前没有`campaignId`在此代码中进行设置。

我想要的是将外键自动连接到“活动”表的*东西*，如果传入的活动以前从未使用过，那么无论做什么，它都必须首先在“活动”表中添加一个新行。

我有一些决定要做，并且非常感谢对其中任何一个的洞察：

*   我不知道我应该使用触发器、存储过程还是在 LINQ 中手动执行：

    *   **触发器**：有点恶心，从来没有真正喜欢使用它们，但会保证“campaignId”在我需要的时候更新

    *   **存储**过程：再次有点恶心，我的 SQL 不是很好，我看重能够在 LINQ 中尽可能多地完成所有事情的一致性。

    *   **手动 Linq**：我必须在内存中保留一份“活动”表，并使用 C# 哈希表进行查找。如果另一个客户添加了新的广告系列，我将不得不担心保持该表是最新的。

*   我想要这个外键表的主要两个原因是为了在 'Session' 上为 'campaignId' 建立更有效的索引，以便我可以更快地进行分组。如果它只是一个整数列被分组，它似乎应该快得多。第二个原因是允许合作伙伴通过与其他表的连接仅查看他们的活动。

在有人问之前，我事先并不知道这些活动，因为有些活动将由合作伙伴创建。

**最重要的是：**我主要是在寻找最“LINQ 友好”的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T02:14:48.537

我肯定会建议在 Session 表上添加一个可为空的外键约束。一旦你有了这个设置，它应该就像在 Session 类中添加一个方法一样简单：

```
public partial class Session
{
    public void SetCampaignKey(string key)
    {
        // Use an existing campaign if one exists
            Campaign campaign =
            from c in dbContext.Campaigns
            where c.campaignKey == key
            select c;

        // Create a new campaign if necessary
        if (campaign == null)
        {
            campaign = new Campaign();
            campaign.campaignKey = key;
            campaign.description = string.Empty; // Not sure where this comes in
            dbContext.Campaign.InsertOnSubmit(campaign);
        }

        // We can now set the reference directly
        this.Campaign = campaign;
    }
} 
```

我的 LINQ 可能有点偏离，但这样的东西应该可以工作。

您可以调用 SetCampaignKey() 而不是手动设置campaignKey 属性。当您调用 dbContext.SubmitChanges 时，将根据需要添加活动，并相应地更新会话条目。

在这种情况下，只会自动设置campaignId 属性。您可以依靠一个简单的触发器来设置campaignKey 或取消它。您始终可以通过加入 Campaign 表来检索该值。

我是否过度简化了问题？

# rdbms - 回滚语句究竟做了什么？

> ID：1017317
> 
> 赞同：1
> 
> 时间：2009-06-19T10:28:38.067
> 
> 标签：rdbms

回滚用于到达上一个提交，但它到底会做什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T10:31:37.873

不，它回滚到上一个/指定的事务开始（或保存点）。顺便说一句，它可以对应于最后一次提交。

请注意，这些术语可能会因 RDBMS/语言而略有不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:32:31.383

好吧，细节显然在某种程度上取决于您使用的 DBMS。

但原则上，是的，回滚会将您返回到您开始当前所在的事务之前的状态。

细节是诸如如何处理数据字典更改之类的事情。此外，一些系统允许嵌套或分布式事务，然后事情变得更加棘手。

[像往常一样，维基百科](http://en.wikipedia.org/wiki/Rollback_(data_management))上的详细信息:-)。

# vba - 在 Excel 中隐藏分页符

> ID：1017319
> 
> 赞同：1
> 
> 时间：2009-06-19T10:29:14.167
> 
> 标签：vba, excel, printing, page-break

继我[之前的](https://stackoverflow.com/questions/986497/excel-page-breaks-via-vba) [问题](https://stackoverflow.com/questions/1007164/detecting-changes-to-checkboxes-via-vba)之后：

我已经实现了一系列复选框，用户可以使用这些复选框隐藏/取消隐藏数据范围。这很棒 - 它有效。问题是当用户去打印时 - 隐藏的数据被隐藏但页面仍然存在但空白。

如果分页符留给他们自己的设备，那么一切都很好 - 没有空白部分。当使用手动分页符时，您可以看到数据的位置。

我已经尽一切努力摆脱空白区域。

复制范围并重新计算分页符是不行的，因为对于一个相当小的报告，分页符需要 2 分钟以上。

那么，**如何仅打印未隐藏的范围？**

谢谢，G。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:39:49.243

尚未对其进行测试，但您可以将打印范围更改为仅可见单元格：

```
Public Sub SetPrintRangeToVisible(ByRef ws As Excel.Worksheet)
    ws.PageSetup.PrintArea = ws.UsedRange.SpecialCells(xlCellTypeVisible).Address
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-06T15:10:16.903

Excel，默认情况下只打印可见单元格。您不必像之前建议的那样将打印区域设置为可见单元格。

我想您已取消选中所有复选框中的打印对象选项。当您打印工作表时，该区域显示为空白。如果是这种情况，请继续阅读：

我建议编写一个简单的宏来隐藏包含复选框的行。将复选框的可见属性设置为 false。打印工作表，然后将所有内容恢复到原始状态。

或者，您可以只选择复选框上方的行，然后选择复选框下方的整个区域，然后将其设置为 PrintArea。那应该可以解决您遇到的问题。

另外，我可能对情况有极大的误解，在这种情况下，我很抱歉浪费了您的时间。

# c# - 我可以对 Oracle Instant Client 和 ODP.NET 使用加密连接吗？

> ID：1017321
> 
> 赞同：1
> 
> 时间：2009-06-19T10:30:07.503
> 
> 标签：c#, oracle, encryption, odp.net

我们目前通过 odbc 使用完全安装的 oracle 客户端和 ado.net 来建立到 oracle 数据库的 sql*net 加密连接。

我的问题是我们是否也可以使用即时客户端和 odp.net 而不是完整客户端和 odbc 实现加密连接？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:04:22.243

[这个链接](https://kb.berkeley.edu/jivekb/entry.jspa?externalID=1005)似乎表明你可以，虽然我没有尝试过。

我认为这仅适用于本机加密，不适用于高级安全选项，我认为这需要客户端安装。

# actionscript-3 - 获取 flex 中 TabNavigator 中打开的 Tabs 的信息

> ID：1017323
> 
> 赞同：1
> 
> 时间：2009-06-19T10:30:36.550
> 
> 标签：actionscript-3, apache-flex, flex3

[替代文字 http://img195.imageshack.us/img195/7845/tabx.jpg](http://img195.imageshack.us/img195/7845/tabx.jpg)

我在树列表视图上打开带有单击事件的选项卡。

问题是我不想像您在图像中看到的那样打开标签 Pista。

我想关注打开的 Pista 选项卡。

请给你的建议。

谢谢。

问候，

石旺

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-04T22:28:59.493

你可以有一个函数循环遍历选项卡以查看选项卡是否已经存在以及它是否设置了 tabNavigators selectedIndex，如果它没有添加新选项卡

```
var tabFound:Boolean = false;
for(var i:int = 0; i < myTabNavigator.numChildren; i++)
{
    if(myTabNavigator.getChildAt(i) is myNewObj)
    {
       myTabNavigator.selectedIndex = i;
       tabFound = true;
       break;
    }
}
if(!tabFound)
{
    myTabNavigator.addChild(myNewObj);
} 
```

我很快就编写了该代码并没有对其进行测试，但逻辑将是相似的。

# javascript - 根据另一个的选定值禁用下拉列表

> ID：1017325
> 
> 赞同：2
> 
> 时间：2009-06-19T10:31:33.193
> 
> 标签：javascript

这可能是一个愚蠢的问题，但我仍在学习，如果答案很明显，请原谅我:)

我有一个测试页面，上面有以下内容：

```
<select name="ddlRoles" ID="ddlRoles" OnChange="DisEnableDDL();">
<option value="-1">Fresh Milk</option>
<option value="2">Old Cheese</option>
<option value="3">Hot Bread</option>
</select>
<select name="ddlCust" ID="ddlCust">
<option value="-1">rawr</option>
<option value="2">root</option>
<option value="3">honk</option>
</select> 
```

如果用户从 ddl Roles 中选择的值不是 3，则应禁用 ddlCust。这是我的 JS 函数：

```
function DisEnableDDL()
{
var ddlR = document.getElementById("ddlRoles")
var ddlC = document.getElementById("ddlCust")
if(ddlR.options[ddlR.selectedIndex].value = "3")
 {
    ddlC.disabled = false;
 }
else
 {
    ddlC.selectedIndex = 0;
    ddlC.disabled = true;    
 }
} 
```

不工作。我错过了什么？我是否未能正确设置变量？这是否只是更改变量 ddlR 和 ddlC 而不更改页面本身的元素或其他内容？在 Firebug 中跟踪它，它似乎属于正确的语句，但 ddlCust 永远不会被禁用。

非常感激任何的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T10:35:15.403

`==`而不是`=`在你的 if：

```
if(ddlR.options[ddlR.selectedIndex].value == "3") 
```

`=`用于赋值，而`==`用于比较，在大多数类 C 语法中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T10:35:23.313

你没有正确比较，你需要使用'=='：

```
if(ddlR.options[ddlR.selectedIndex].value == "3") 
```

# jquery - 使用 JQuery 提取元素中的文本

> ID：1017330
> 
> 赞同：10
> 
> 时间：2009-06-19T10:33:19.493
> 
> 标签：jquery, select, text, extraction

我想用 JQuery 提取元素内的文本

```
<div id="bla">
    <span><strong>bla bla bla</strong>I want this text</span>
</div> 
```

我只想要没有强标签的文本“我想要这个文本”。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T11:24:32.043

试试这个...

```
<script type="text/javascript">
//<![CDATA[
$(document).ready(function(){
    $("#bla span").contents().each(function(i) {
        if(this.nodeName == "#text") alert(this.textContent);
    });
});

//]]>
</script> 
```

这不需要从上下文中删除任何其他节点，只会在每次迭代时为您提供文本节点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T11:32:23.853

karim79 方法的变化：

```
$("span").clone().find("strong").remove().end().text(); 
```

或者如果您只想要根文本而不知道其中包含哪些其他标签：

```
$("span").clone().children().remove().end().text(); 
```

仍然有点长，但我认为这与您希望的一样短。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T10:36:55.540

这样做（经过测试）：

```
 var clone = $("#bla > span").clone();
    clone.find('strong').remove();
    alert(clone.text()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T10:49:16.403

```
var textFromSpanWithoutStrongTag = $('div#bla > span').text(); 
```

**更新：**

```
var textFromSpanWithoutTextFromStrongTag =
    $('div#bla > span').text().replace($('div#bla > span > strong').text(), ''); 
```

**更新：**

```
var text = '';
$("div#bla > span").contents().each(function () {
    if(this.nodeType == 3) text = text + this.nodeValue; }); 
```

在 FF3、IE8、O10b 上测试：

```
<div id="bla">
    <span>
        <strong>bla bla bla</strong>
        I want this
        <strong>bla bla</strong>
        text
        <span>bla bla bla</span>
    </span>
</div> 
```

# qt - QHash中的分段错误

> ID：1017332
> 
> 赞同：0
> 
> 时间：2009-06-19T10:35:04.390
> 
> 标签：qt, qhash

我在`QHash`. 我找不到任何东西。我在 Linux 机器上使用 Qtopia-Core-4.3.3。

日志如下：

> 断言：文件/usr/local/Trolltech/QtopiaCore-4.3.3-400wrl/include/QtCore/qhash.h中的“*node == e || (*node)->next” ，第 824 行
> 分段错误

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T14:58:14.157

只是一个疯狂的猜测，但基于它`QHash`是一个容器的事实，它指的是“节点”，我认为给定的断言是由程序期望节点是结束节点（`e`），或者有一个下一个节点。所以看起来你正在做的事情是搞乱哈希中的条目。

继续疯狂推测，当有人迭代容器时，我经常看到一些难以诊断的错误，有时在迭代时从容器中删除东西。不知道`QHash`这个处理好不好。

# python - 使用简单的 Python 脚本读取字典单词文件时出现 UnicodeDecodeError

> ID：1017334
> 
> 赞同：0
> 
> 时间：2009-06-19T10:35:22.360
> 
> 标签：python

一段时间以来第一次使用 Python，当我使用 Python 3.0.1 运行以下脚本时，我无法对文件进行简单扫描，

```
with open("/usr/share/dict/words", 'r') as f:
   for line in f:
       pass 
```

我得到这个例外：

```
Traceback (most recent call last):
  File "/home/matt/install/test.py", line 2, in <module>
    for line in f:
  File "/home/matt/install/root/lib/python3.0/io.py", line 1744, in __next__
    line = self.readline()
  File "/home/matt/install/root/lib/python3.0/io.py", line 1817, in readline
    while self._read_chunk():
  File "/home/matt/install/root/lib/python3.0/io.py", line 1565, in _read_chunk
    self._set_decoded_chars(self._decoder.decode(input_chunk, eof))
  File "/home/matt/install/root/lib/python3.0/io.py", line 1299, in decode
    output = self.decoder.decode(input, final=final)
  File "/home/matt/install/root/lib/python3.0/codecs.py", line 300, in decode
   (result, consumed) = self._buffer_decode(data, self.errors, final)
 UnicodeDecodeError: 'utf8' codec can't decode bytes in position 1689-1692: invalid data 
```

它爆炸的文件中的行是“Argentinian”，这似乎并不罕见。

**更新**：我补充说，

```
encoding="iso-8559-1" 
```

到 open() 调用，它解决了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T10:42:29.600

你能检查以确保它是有效的 UTF-8 吗？[在这个 SO question](https://stackoverflow.com/questions/115210/utf-8-validation)中给出了一种方法：

```
iconv -f UTF-8 /usr/share/dict/words -o /dev/null 
```

还有其他方法可以做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T10:55:12.430

您如何从“位置 1689-1692”确定文件中的哪一行被炸毁了？这些数字将是它试图解码的块中的偏移量。您必须确定它是什么块——如何确定？

在交互式提示下试试这个：

```
buf = open('the_file', 'rb').read()
len(buf)
ubuf = buf.decode('utf8')
# splat ... but it will give you the byte offset into the file
buf[offset-50:60] # should show you where/what the problem is
# By the way, from the error message, looks like a bad
# FOUR-byte UTF-8 character ... interesting 
```

# php - 填满一张桌子的最快方法

> ID：1017336
> 
> 赞同：1
> 
> 时间：2009-06-19T10:36:28.223
> 
> 标签：php, mysql, performance

我试图找到将数据插入表（来自选择的数据）的最快方法我总是清除表：

```
TRUNCATE TABLE table; 
```

然后我这样做是为了插入数据：

```
INSERT INTO table(id,total) (SELECT id, COUNT(id) AS Total FROM table2 GROUP BY id); 
```

有人告诉我，我不应该这样做。他说这会快得多：

```
CREATE TABLE IF NOT EXISTS table (PRIMARY KEY (inskey)) SELECT id, count(id) AS total FROM table2 GROUP BY id 
```

关于这个有什么想法吗？我认为我的解决方案更干净，因为我不必检查表格。这将在 cron 作业中每天运行几次

编辑：我不清楚。截断总是运行。只是为什么要插入所有数据最快的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T10:41:24.500

我也认为你的解决方案更干净，加上“某人”的解决方案在我看来有一些问题：

*   它实际上并没有删除表中可能存在的旧数据
*   create table...select 将根据 select 返回的内容创建具有类型的表列。这意味着 table2 的表结构的更改将传播到 table。这可能是也可能不是你想要的。它至少引入了隐式耦合，我认为这是一个坏主意。

至于性能，我认为没有理由应该比另一个更快。所以通常的建议适用：选择最干净、最可维护的解决方案，对其进行测试，只有在性能有问题时才进行优化:-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T10:42:48.977

您的解决方案将是我的选择，性能差异损失（如果有的话，我不确定，因为您不删除/创建表并重新计算列类型）可以忽略不计，恕我直言，清洁度过重。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T10:42:44.500

```
CREATE TABLE IF NOT EXISTS table (PRIMARY KEY (inskey))
SELECT  id, count(id) AS total
FROM    table2
GROUP BY
        id 
```

这不会从表中删除旧值。

如果这就是你想要的，它确实会更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T20:17:44.097

我敢肯定，任何时差都是无法区分的，但是恕我直言，您的时差更可取，因为它是一个 SQL 语句而不是两个；INSERT 语句中的任何更改都不需要对其他语句进行更多工作；而您的不需要主机验证您的 INSERT 是否与表中的字段匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T20:08:14.037

我同意“sleske”的建议，即要求您对其进行测试并自己优化解决方案。DIY！

每一个自尊的数据库都会给你机会回滚你的交易。1\. 回滚您的 INSERT INTO... 将要求数据库跟踪插入到表中的每一行 2\. 回滚 CREATE TABLE... 对于数据库来说非常容易 - 只需摆脱表。

现在，如果您正在设计和编码数据库，哪个会更快？1 还是 2？

“某人”的建议确实有价值，尤其是在您使用 Oracle 时。

问候，
湿婆

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T12:11:41.697

也许在你的某人和你自己之间的翻译中丢失了一些东西。她/他可能提到的一种可能性是 DROP/SELECT INTO 与 TRUNCATE/INSERT。

我听说后者速度更快，因为它的日志记录最少（但话说回来，这里 DROP 的最终成本是多少？）。我没有确切的统计数据来支持这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T21:07:00.797

从手册：从 MySQL 5.1.32 开始，为了二进制日志记录和复制，TRUNCATE 被视为 DROP TABLE，然后是 CREATE TABLE——也就是说，作为 DDL 而不是 DML。这是因为，当使用 InnoDB 和其他事务隔离级别不允许基于语句的日志记录（READ COMMITTED 或 READ UNCOMMITTED）的事务存储引擎时，使用 STATEMENT 或 MIXED 日志记录时不会记录和复制该语句模式。

您可以将插入简化为：

```
INSERT INTO table
( SELECT id, COUNT(id) FROM table2 GROUP BY id ); 
```

# c# - 寻找一些 UI 线程和工作线程教程

> ID：1017338
> 
> 赞同：0
> 
> 时间：2009-06-19T10:39:23.367
> 
> 标签：c#, .net, multithreading, user-interface

我的工作环境是 VSTS 2008 + C# + .Net 3.5。我想了解UI线程和工作线程之间的区别，以及任何其他类型的线程（即非UI线程与工作线程相同）？我还想了解我们可以对每种类型的线程做什么的限制以及避免任何问题的最佳实践。

感谢任何好的教程！:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:59:29.063

这个[站点](http://www.albahari.com/threading/)有很好的线程细节，包括：入门、基本同步、使用线程和高级主题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T10:53:01.187

这里有一个关于线程的长而详细的[教程](http://www.yoda.arachsys.com/csharp/threads/)。

具体来说，我会推荐[这部分关于工作线程和 UI 线程](http://www.yoda.arachsys.com/csharp/threads/winforms.shtml)以及它们如何交互的部分（虽然它假设你已经阅读了前面的章节）。

# eclipse - 为什么无法在 eclipse、weblogic、JBossTools 上获得 JSF jsp 页面的“在服务器上运行”选项？

> ID：1017339
> 
> 赞同：1
> 
> 时间：2009-06-19T10:39:55.330
> 
> 标签：eclipse, jsf, weblogic, jboss-tools

我正在尝试在 WebLogic 10.0 MP1 上运行使用 Eclipse Ganemede 和 JBoss 工具创建的 JSF 1.2 应用程序

我创建了一个简单的 JSF helloworld 应用程序并添加了一个简单的 JSP。我已经通过 eclipse 使用 JBoss Tools 插件配置了一个 weblogic 域和一个服务器。当我右键单击 JSP 文件时，我只能看到“运行配置...”选项，而不是“在服务器上运行...”。当我在 Eclipse 中右键单击应用程序时，我确实得到了这个（'在服务器上运行'）选项，但它没有运行

这很奇怪，因为在同一个 Eclipse 工作区上的另一个 JSF 应用程序中，我可以通过右键单击 JSP 页面来“在服务器上运行”它们。

任何人都可以为此提出解决方案吗？

谢谢。Ankit

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-02-10T21:33:37.490

您可以通过将项目拖到服务器来添加项目吗？

如果不是，那么它不是出于某种原因的 WTP 项目，那么将没有可用的运行方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T16:33:10.570

当您启动与 JSF 应用程序关联的服务器时（在 eclipse 错误日志视图或服务器日志中），您是否看到任何错误日志？

如[this thread](http://dev.eclipse.org/newslists/news.eclipse.webtools/msg12521.html)所示：

> 有某些类，由它们的包标识，服务器提供不允许覆盖的 web 应用程序。
> 如果在 WEB-INF/lib 的 jar 中找到此类类，Tomcat 会通过忽略有问题的 jar 来处理此问题。
> 显然，`javax.servlet`是那些包之一。假设`javax.servlet.jar`只包含`javax.servlet`类，这本身不应该导致您的 web 应用程序失败。
> 
> 我会首先从 webapp 中删除这个 jar，因为在`WEB-INF/lib`.

解决方案不多，但至少您可以提供更多详细信息/日志，这可能足以让您更好地掌握这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-27T04:29:22.427

web.xml 中可能有一些错误。即使我在清除 web.xml 中的错误后遇到了同样的问题，我也可以看到 run-as 选项

# sql-server - 分布式事务被 MSDTC 中止

> ID：1017341
> 
> 赞同：0
> 
> 时间：2009-06-19T10:40:21.430
> 
> 标签：sql-server

如何解决 sql server 2005 中的错误 8522。

我正在使用两台服务器。每次我必须工作时，我都必须从位于远程位置的服务器获取实时数据。我在本地服务器上获取实时数据并开始工作。

上三个月形成它工作正常，但现在它给出以下错误。

分布式事务被 MSDTC 中止。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T11:39:38.393

您的问题中没有足够的信息来提供帮助。该过程的一些代码/描述将产生更好的答案。

这里有一个来自谷歌的链接可能有用：

[http://blogs.conchango.com/paulmcmillan/archive/2005/10/17/2277.aspx](http://blogs.conchango.com/paulmcmillan/archive/2005/10/17/2277.aspx)

# vba - 如何通过 VBA 获取/设置 Excel 中单元格的唯一 ID

> ID：1017342
> 
> 赞同：5
> 
> 时间：2009-06-19T10:40:31.197
> 
> 标签：vba, excel

我想为我的 Excel 数据表中的每个数据行拥有/定义一个唯一的 id - 这样我可以在向前传递数据时使用它，并且在其上方添加/删除行时它保持不变。

我的想法是使用 Range 的 ID 属性（[msdn 链接](http://msdn.microsoft.com/en-us/library/bb213537.aspx)）

因此，我有一个用户定义函数 (UDF)，我将其放置在获取/设置 ID 的每一行中，如下所示：

```
Dim gNextUniqueId As Integer

Public Function rbGetId(ticker As String)
    On Error GoTo rbGetId_Error
    Dim currCell As Range
    'tried using Application.Caller direct, but gives same error
    Set currCell = Range(Application.Caller.Address)
    If currCell.id = "" Then
        gNextUniqueId = gNextUniqueId + 1
        'this line fails no matter what value I set it to.
        currCell.id = Str(gNextUniqueId)
    End If
    rbGetId = ticker & currCell.id
    Exit Function

    rbGetId_Error:
    rbGetId = "!ERROR:" & Err.Description
End Function 
```

但这在提到的那一行失败了

> “应用程序定义或对象定义的错误”

我认为这可能是 UDF 的这些限制之一，但如果我从功能区按钮触发的代码中尝试它，我也会得到同样的错误......

关于如何保持一致的 ID 的任何其他建议 - 也许我应该通过我的功能区按钮填充单元格，查找没有 ID 的单元格并生成/设置这些单元格的值......

编辑：正如 Ant 所想，我保护了工作表，但即使在未锁定的单元格中，它仍然失败。取消保护工作表可以解决问题....但是我使用了“Protect UserInterFaceOnly:=True”，这应该允许我这样做。如果我在保护工作表时手动允许“编辑对象”，它也可以工作，但我没有看到一个编程选项 - 我需要在 AutoOpen 中调用 Protect 函数以启用 UserInterfaceOnly 功能......

我想我需要围绕我的 ID 设置关闭/打开保护 - 假设可以在 UDF 中完成......它似乎不能，因为这不起作用 - ActiveSheet.unprotect 和 ActiveWorkbook.unprotect 都不是 :(

提前致谢。克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-24T08:57:56.177

好的...

确实，如果工作表被锁定，宏就没有对 ID 等低级信息的写访问权。

但是，我认为不可能取消保护 UDF 中的工作表。根据设计，UDF 受到严格限制；我认为让单元格公式控制工作表保护将打破单元格公式仅影响单元格的公式范式。有关详细信息，请参阅Microsoft 网站上的[此页面。](http://support.microsoft.com/kb/170787)

我认为这限制了你的选择。您必须：

*   放弃工作表保护
*   放弃 UDF，使用 Worksheet_Change 事件来捕获单元格更改并在那里写入 ID
*   使用将 ID 写入单元格值的 UDF，而不是保存到 ID

UDF 方法充满了问题，因为您试图使用为计算单元格而设计的东西在工作表上制作永久标记。

尽管如此，这里有一个 UDF 示例，您可以使用它来将“永久”值标记到单元格上，该值适用于受保护工作表的未锁定单元格。这仅适用于单个单元格（尽管它可以适用于数组公式）。

```
Public Function CellMark()

    Dim currCell As Range
    Set currCell = Range(Application.Caller.Address)

    Dim myId As String
    ' must be text; using .value will cause the formula to be called again
    ' and create a circular reference
    myId = currCell.Text

    If (Trim(myId) = "" Or Trim(myId) = "0") Then
       myId = "ID-" & Format(CStr(gNextUniqueId), "00000")
       gNextUniqueId = gNextUniqueId + 1
    End If

    CellMark = myId

End Function 
```

不过，这是相当有缺陷的。但是，使用复制或填充框将保留先前复制的值。只有明确地将单元格设置为新公式，它才会起作用。但是，如果您再次将公式输入到单元格中（只需单击它，然后按 ENTER），就会计算一个新值 - 这是标准单元格行为。

我认为 Worksheet_Change 事件是要走的路，它有更多的自由度。这是一个简单的示例，它更新任何单元格更改的 ID。它可以根据您的特定场景进行定制。需要将此功能添加到需要 ID 设置行为的每个工作表中。

```
Private Sub Worksheet_Change(ByVal Target As Range)

    Dim currCell As Range
    Set currCell = Target.Cells(1, 1)

    Dim currId As String
    currId = currCell.ID

    If Trim(currCell.ID) = "" Then
        Target.Parent.Unprotect
        currCell.ID = CStr(gNextUniqueId)
        Target.Parent.Protect
        gNextUniqueId = gNextUniqueId + 1
    End If

End Sub 
```

最后一点；在所有情况下，如果您重新打开工作表（至少在您的示例中提供的有限细节下），您的 ID 计数器将被重置。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:04:38.660

同意 Ant - 您的代码在 Excel 2003 SP3 上运行良好。

我也可以使用：

```
Set currCell = Application.Caller
If Application.Caller.ID = "" Then
    gNextUniqueId = gNextUniqueId + 1
    'this line fails no matter what value I set it to.
    currCell.ID = Str(gNextUniqueId)
End If 
```

啊哈！我想我有。

我认为您是从数组公式中调用它的，并且它只会在整个范围内被调用一次。您无法获取范围的 ID - 只有单个单元格。这解释了为什么 Application.Caller.ID 会为您失败，因为 Range("A1:B9").ID 会生成一个`Application-defined or object-defined error`.

当您使用`Range(Application.Caller.Address)`获取“单元格”时，您只需将此错误推迟到该`currCell.ID`行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T19:08:54.250

我认为我们可能会遇到一些问题，但我认为它们是测试问题，而不是代码本身的问题。首先，如果您从 Cell 以外的任何地方调用该函数，例如即时窗口、其他代码等，则不会设置 Application.Caller。这就是生成对象未找到错误的原因。其次，如果您复制/粘贴具有该功能的单元格，您也将通过复制/粘贴 ID。因此，无论您将其粘贴到何处，输出都将保持不变。但是，如果您只是复制文本（而不是单元格），然后粘贴，那么这将正常工作。（包括您对 Application.Caller 的原始使用。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-25T00:54:30.813

问题出在 Application.Caller 上。

由于您是从用户定义的函数中调用它，因此它将向您传递错误描述。这是帮助文件中的注释。

评论

此属性返回有关如何调用 Visual Basic 的信息，如下表所示。

调用者 - 返回值

*   在单个单元格中输入的自定义函数 - 指定该单元格的 Range 对象
*   作为单元格区域中数组公式一部分的自定义函数 - 指定该单元格区域的 Range 对象
*   Auto_Open、Auto_Close、Auto_Activate 或 Auto_Deactivate 宏 - 文档名称为文本
*   由 OnDoubleClick 或 OnEntry 属性设置的宏 - 宏应用的图表对象标识符或单元格引用（如果适用）的名称
*   **宏对话框（工具菜单），或上面未描述**的任何调用者 - #REF！错误值

由于您是从用户定义的函数调用它，因此发生的是 Application.Caller 正在将错误代码字符串返回到您的范围变量 curCell。它不会导致您的错误处理程序会拾取的错误。之后发生的事情是您引用 curCell，它实际上不再是一个范围。在我的机器上，它尝试设置 curCell = Range("Error 2023")。无论该对象是什么，它都可能不再具有 ID 属性，当您尝试设置它时，它会向您抛出该对象错误。

这就是我要尝试的...

1.  尝试删除您的错误处理程序并查看 VBA 是否在 Range(Application.Caller.Address) 上引发任何异常。这不会解决它，但它可以为您指明正确的方向。

2.  无论是通过逻辑或 Application.ActiveCell 还是您想要这样做，直接引用单元格。例如 Range("A1") 或 Cells(1,1)。Application.Caller.Address 似乎不是一个好的选择。

3.  尝试使用选项显式。这可能会使您设置 curCell 的行引发错误，因为 Range(Application.Caller.Address) 看起来不像是在传递范围，这是 curCell 的数据类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-26T07:20:59.963

我发现如果我用“Protect DrawingObjects:=False”保护工作表，UDF 可以设置 ID。奇怪的。

感谢您提供的所有帮助。

# sharepoint - 部署依赖于数据库存储的 Web 部件

> ID：1017349
> 
> 赞同：3
> 
> 时间：2009-06-19T10:43:07.040
> 
> 标签：sharepoint, moss, sharepoint-2007, wss-3.0

在具有数据库依赖性的 WSS3 或 MOSS2007 中部署 Web 部件的最佳方法是什么？.wsp 是否应该包含创建数据库的代码，我应该将 .wsp 封装在另一个处理数据库创建的安装程序中，还是应该提供两个不同的包以允许管理员处理后端创建？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T12:01:29.817

好吧，我更喜欢 SharePoint 方式，您可以从管理中心的 SharePoint 管理页面创建数据库。只需看看 SharePoint 如何处理新 Web 应用程序的创建，其中要求您命名数据库服务器和 SharePoint 内容数据库的名称。

换句话说，我会选择仅 WSP 部署。WSP 应该包括一个数据库配置页面（一个 ASPX 页面）以及一个场级功能，用于安装一个[自定义操作](http://msdn.microsoft.com/en-us/library/ms460194.aspx)链接到管理中心内的页面。从 Central Admin 执行此操作的好处在于，它在具有在 SQL 服务器上创建新数据库的权限的上下文中运行。因此，您无需向用户询问数据库服务器的登录名和密码。成功创建数据库后，配置页面应使用[SPPersistedObject](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.sppersistedobject.aspx)类的自定义派生类将连接信息保留在 SharePoint 配置页面中。Web 部件可以依次读取这些设置以连接到数据库。

我认为在设计 SharePoint 应用程序时应避免使用 MSI 安装程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:55:07.860

您的 Webpart 针对的是哪种客户端？

我想在您的方法中稍微灵活一点并考虑安装 Webpart 的多种方法可能是值得的。

因此，对于没有专门 DBA 的人来说，最好拥有一个 .wsp。（尽管这应该足够强大以处理超级用户的安装。）

或者选择一个 .wsp 和一个 msi（甚至是脚本），这将使安装程序能够更好地控制它的安装方式。（我更喜欢这种方法，而不是 .wsp 唯一的方法。）

# sql-server - SQL Server 2008 保留最后打开的数据库

> ID：1017350
> 
> 赞同：1
> 
> 时间：2009-06-19T10:43:50.423
> 
> 标签：sql-server

我使用了大约 3 个 SQL Server 2008 数据库。每次我需要查询数据库时，我都需要登录到该数据库然后查询。有没有办法在 SQL Server 2008 中保留上次打开的数据库？

打个比方，认为这就像 Firefox 允许显示最后打开的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T10:58:53.390

SQL Server 保留上次打开的数据库。它实际上从不关闭它们（auto_close 和用户实例无法承受）。您是指 Management Studio 吗？您可以将 USE 语句添加到已保存的查询中。您可以在查询中使用 sqlcmd 扩展，以便在所有服务器/数据库上一次性运行查询。或者您可以使用[SSMS Tools Pack](http://www.ssmstoolspack.com)之类的东西，这是一个免费的附加组件，可以通过查询历史记录等功能增强 SSMS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:53:28.813

您需要对所有 3 个数据库使用相同的登录名并将 auto_close 设置为 off

# excel - '有太多记录无法完成此操作' Excel 数据透视表刷新

> ID：1017361
> 
> 赞同：4
> 
> 时间：2009-06-19T10:49:43.877
> 
> 标签：excel, pivot

是否有人有资源可以在 Excel 中给出此错误消息的可能原因。我用谷歌搜索了一下，看起来很多人都遇到了这条消息，但没有人回复具体的解决建议。

实际数据源是 Excel 列表，只有 1000 行长，少数用户使用此数据透视表并成功刷新，只有少数用户在刷新完全相同的电子表格时遇到此错误消息。它们不会同时刷新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-22T11:13:52.570

对我来说，解决方案是摆脱计算项目。我认为它们使枢轴复杂化，即使记录的数量看起来不多，它也不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-01T15:04:54.963

我希望这能解决您的问题，因为我刚刚遇到了同样的问题并正在寻找解决方案。我发现这个问题的原因是我在一些我做了数据透视的 excel 单元格中编码了公式。我只是通过粘贴带有“值”的所有数据将所有数据（大约 58,000 行记录，> 100 列数据，这是相当可观的）复制到另一个工作表中。在这个新的工作表上做一个新的支点，太棒了！我不再有我之前遇到的错误。我的你，我在这个数据透视表中有很多字段，我不再收到错误。在进行数据透视之前，请仔细检查您的 Excel 工作表中是否内置了任何公式。希望以上有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-12T07:22:52.750

我有这个类似的问题，但是在我将一个新的“非公式”列插入基础数据后出现了这个问题。除了这个新列之外，所有其他列都被插入到数据透视表中。此外，我的基础数据有许多公式驱动的列和“#N/A”值：-) 经过大量谷歌搜索并尝试将任何其他列中的公式转换为值，这个问题没有得到解决 - 但是，因为有其他列被数据透视表接受没有问题，我终于发现新列在“列标题”中有一个“撇号” - 我从那个新列中删除了那个“撇号”（并且旧列没有那个撇号”，“有太多记录无法完成此操作”的错误得到解决:-)

# sql-server - 我应该使用 SQL Server 关键字作为列名吗？

> ID：1017362
> 
> 赞同：8
> 
> 时间：2009-06-19T10:50:02.673
> 
> 标签：sql-server, naming-conventions, naming

我正在设计一个数据库，最近在表 DayOfWeek 中命名了一个列，完全忘记了 DayOfWeek 是 SQL Server 中的内置函数。现在我决定是否应该保持原样并使用方括号 [DayOfWeek] 引用列，或者更改列名以避免将来发生任何冲突。我对这个项目并不太了解，所以改变它并不难。我脑海中的争论是 DayOfWeek 的列名对其目的非常有意义，所以我真的很想使用它......但它是一个保留字......并且可能会在未来引起痛苦（特别是如果引用该列时，我总是必须在其周围加上方括号）。

大家怎么看？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-19T10:52:53.353

我会改变它 - 我有一个名为 user 的旧表 - 方括号一直都很痛苦。也许称它为 DayOfWeekName 或 DayOFWeekId

乔什

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T10:59:38.193

杰夫，

If you're not too far down the track to rename the column (relatively) painlessly then I'd recommend you change it. You've identified one probable-future-headache for the maintentance crew, and I guess it would be actually less costly (over time) to clean it up now, especially considering that renaming something isn't the hell-on-wheels since the advent of truly effective search and replace functionality in text-editors and IDE's.

The truly hard part of renaming it is gaining the understanding required to do the job safely. You are unique (being the author) in having that understanding. If you asked me (just for instance) to do the job, then it probably wouldn't be a cost effective business proposition.

So... +1 for fixing the sucker yourself... and +2 for not doing it again ;-)

Cheers. Keith.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T12:38:06.107

I always make sure I never use a keyword as the start of any variable/object/function simply because you're never sure if your target language will like it. It can often generate wacky errors that take a while to track down. Even if syntax checking does pick it up, it means you've wasted more time than if it had been a different name like `FurryKitten`.

I would avoid `DayOfWeek` and opt for something which is a completely different, maybe `Weekday` or `DayName`. It just saves hassle.

Plus - square brackets just create headaches, and there are a lot of SQL developers out there who don't use the brackets - new developers will end up creating "non-bracketed" code out of habit for some time after they join the team. Uncommon conventions should be avoided if possible.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T10:54:37.733

如果很容易改变它。但作为一种好的做法，我会在任何地方使用方括号。一旦你习惯了，就不会比在单词之间加空格更痛苦了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T10:54:40.170

我们这里有一个名为 User 的表。如果可能的话，我会改变它。尽管 Josh 是正确的，但您可以放置​​方括号来表示它是一个表格，该任务很快就会变老。使用保留字作为表格也使其他开发人员变得困难。如果有人不知道这是保留字，则可能很难确定查询为什么不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T10:55:24.783

如果您使用任何数据库适配器/抽象库从数据库中获取数据，请不要担心。类将为您转义列名。如果您自己编写 SQL 查询，则可能会造成一些麻烦。您需要在查询中转义列名。

PS我记得，我有几次像你这样的情况。但我被命名为“订单”列:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T10:55:49.807

我也会避免使用保留字，如果你不注意的话，你很容易陷入困境。

# c# - 如何从线程数组中杀死特定线程

> ID：1017363
> 
> 赞同：2
> 
> 时间：2009-06-19T10:50:30.083
> 
> 标签：c#, .net, multithreading

我正在根据数据库中的记录数创建一个线程数组。然后每个线程轮询一个 ipaddress，然后休眠一段时间，然后再次重新轮询。我会定期检查数据库中主机数量的任何变化。如果有更多主机，我会启动另一个线程。如果主机较少，我需要终止监视该主机的特定线程。我如何杀死特定的线程。

```
enter code here protected static void GetThreads()
    {
        Thread[] threads;
        do
        {
            dt = getIP_Poll_status();
            threads = new Thread[dt.Rows.Count];
            Console.WriteLine(dt.Rows.Count + " Threads");
            for (int i = 0; i < threads.Length; ++i)
            {
                string ip = dt.Rows[i][0].ToString();
                int sleep = Convert.ToInt32(dt.Rows[i][1].ToString());
                string status = dt.Rows[i][2].ToString();
                string host = dt.Rows[i][3].ToString();
                Hosts.Add(host);
                string port = dt.Rows[i][4].ToString();
                //Console.WriteLine("starting on " + ip + " delay  " + sleep+".current status "+status);
                threads[i] = new Thread(PollingThreadStart);
                threads[i].Start(new MyThreadParameters(ip, sleep, status, host, port));
                threads[i].Name = host;

            }
            Thread.Sleep(50000);
        }

        while (true);
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T10:54:56.923

强行杀死线程是一个坏主意。它可以使系统处于不确定状态。

您应该设置一个标志（以线程安全的方式），以便线程在下次检查时适当地终止自己。有关更多详细信息和示例代码，请参阅[我的线程文章](http://pobox.com/~skeet/csharp/threads/shutdown.shtml)。

顺便说一句，我要补充一点，使用`Sleep`几乎总是错误的做法。您应该使用允许优雅唤醒的东西，例如`Monitor.Wait`. 这样，当有变化时（例如轮询线程应该死），如果线程正在等待，它可以唤醒线程，并且它可以立即注意到变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T10:54:40.027

鉴于您的大多数线程将花费大部分时间什么都不做，您的设计可能会更好地实现为单个线程，该线程保留一个 IP 地址列表以及它们接下来将被轮询的时间。保持它按下次轮询时间的顺序排序。

伪代码：

```
What time does the next ip address need to be polled?
Sleep till then
Poll the address.
Update the poll time for that address to now + interval.
Resort the list
Repeat. 
```

每当您有数据库更新时，更新列表，然后命令线程在需要停止时重新评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:55:10.207

由于上述原因，您尝试做的是一个坏主意。但是，您仍然可以为线程命名，该名称可以是主机名。您可以通过检查名称找出线程并将其杀死。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T11:40:54.083

您可以向要结束的广告发送[中断信号。](http://msdn.microsoft.com/en-us/library/system.threading.thread.interrupt.aspx)已发出信号的线程需要捕获将引发的[ThreadInterruptedException](http://msdn.microsoft.com/en-us/library/system.threading.threadinterruptedexception.aspx)，并优雅地退出。

还有其他可能更好的方法来实现你想要的，但它们更复杂......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T10:55:17.780

您没有指定要定位的语言，但通常无论语言如何，您都使用相同的方法。简单地使用一个共享变量，该变量用于在该线程停止运行时发出信号。线程应定期检查该值，如果已设置，它将以优雅的方式停止。通常，这是停止线程的唯一安全方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T11:01:58.127

我会说：

1.  不要杀死线程。要求他们死，很好（查看事件或一些共享标志）。
2.  在为每个 DB 条目创建一个线程时要小心。这可能意味着一些意外的数据库活动，突然你有很多行转化为用太多线程杀死操作系统。绝对有线程数的限制。

# syntax-highlighting - 我可以合并语法着色和折叠吗？或从主文档信息着色的投影

> ID：1017375
> 
> 赞同：0
> 
> 时间：2009-06-19T10:55:08.967
> 
> 标签：syntax-highlighting, eclipse-rcp, projection, text-coloring

例子。我有一个 XML 文档：

```
<document>
<region type="type1">text of region1
</region>
some simple text
<region type="type2">text of region2
</region> 
```

我希望它呈现为

**region1***的文本 region2*
的 一些简单文本

 *据我所知，基本的 Eclipse 着色工作独立于折叠。但我需要根据 xml 信息对文本进行着色。或者也许我需要其他东西，而不是折叠？只操作 StyledText 可能更容易，但我需要其他 Eclipse 编辑器功能才能继续工作。

=========
**更新：**还是没有建议？至少有可能吗？
我看过投影，但是......是否可以从编辑器的这个分支直接访问文本属性？
**upd**：也许至少有一些关于自定义投影的想法/文章？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-29T09:23:29.967

我已经通过文档侦听器服务 ProjectionDocument.removeMasterDocumentRange 和 ProjectionDocument.getDocumentInformationMapping() 实现了它。通过 SourceViewer.getTextWidget().setStyleRange() 着色。如果添加 PresentationReconciler 会有一点问题，但我知道，它是安全的。*

# sql-server - 我想在同一台机器上安装 SQL Server 2008 Enterprise 和 SQL Server 2008 Express，我应该先安装哪个？

> ID：1017381
> 
> 赞同：0
> 
> 时间：2009-06-19T10:55:58.823
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-express

我想在同一台机器上并排安装 SQL Server 2008 Enterprise 和 SQL Server 2008 Express，我应该先安装哪个以便更简单的安装过程和以后更容易维护？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T11:01:43.523

对于 SQL Server 2005，我总是必须先安装完整的产品，然后再安装 Express。如果我反过来做，完整的 SQL 安装会看到 Express 已经安装，并且不会继续安装。这非常烦人。不确定他们是否在 2008 年解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T11:04:08.527

我会先安装企业版，包括所有工具（Management Studio），然后是 Express 的小版本（不是高级服务），所以它不会尝试任何有趣的事情。

# python - sqlalchemy 中的简单更新

> ID：1017388
> 
> 赞同：8
> 
> 时间：2009-06-19T10:58:46.383
> 
> 标签：python, sqlalchemy

用户表是：

*   身份证 (INT)

*   名称 (STR)

*   上次登录（日期时间）

为网页请求提供服务，我手头有一个**用户 ID**，我只想将**last_login**字段更新为“现在”。

在我看来，有两种方法：

1.  使用 db_engine 发出直接 SQL（丢失映射器）

2.  或先查询用户，然后更新对象

两者都可以正常工作，但在代码中看起来很恶心。

**有谁知道使用 sqlalchemy 进行无查询更新的更优雅方式？是否有另一个 ORM 做对了？**

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-19T11:10:50.247

假设您有一个映射器 UserTable：

```
DBSession.query(UserTable).filter_by(id = user_id).\
    update({"last_login":datetime.datetime.now()}, synchronize_session=False) 
```

[文档](http://www.sqlalchemy.org/docs/05/reference/orm/query.html#sqlalchemy.orm.query.Query.update)中的附加参数。

# visual-c++ - MailMerge：没有固定宽度的字体？

> ID：1017389
> 
> 赞同：0
> 
> 时间：2009-06-19T10:58:47.447
> 
> 标签：visual-c++, word, mailmerge

我正在尝试将数据发送到特定的 MergeField。数据已正确发送。数据的每一行都有特定的字符。例如，该字段的数据可能是：

12345 第一\nABCDE.F 第二

（它无法获得换行符，所以我只是通过字符\n）

现在在打印的文档中，每个字符都有一个宽度，例如“1”小于“E”。因此，数据未在字段内对齐。我尝试了以下字体：Arial、Tahoma、Courier New。没有任何帮助。

有任何想法吗？提前致谢。

Ps 数据是通过 Visual C++ 5.0 构建的可执行文件发送的！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T11:03:50.273

您可能应该使用基于制表位的布局。设置你的制表位，比如说，厘米左右（即比字体中最宽的字符大），并在每个需要对齐的元素之前添加一个制表符。

有了这个，你不应该需要找到一个固定宽度的字体，并且可以使用更有吸引力的东西。

编辑：出于兴趣，我想知道为什么您对固定宽度的 Courier New 没有运气。

也许您可以在某处发布屏幕截图，以便我们更详细地查看您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-14T20:19:53.200

试试 Courier - 它没有字距调整（字距调整 = 可变字符宽度）

此外，在“字体”窗口中有一个复选框，允许您将字距调整应用于特定大小或以上的字体 - 将此值设置为较大的字体大小*可能会*删除字距调整。

# python - python的后端

> ID：1017399
> 
> 赞同：0
> 
> 时间：2009-06-19T11:01:48.937
> 
> 标签：python

哪个是 python 应用程序的最佳后端，使用 sqlite 有什么优势，它如何连接到 python 应用程序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T11:07:53.387

后端是什么意思？Python 应用程序连接到 SQLite 就像任何其他数据库一样，您只需导入正确的模块并检查如何使用它。

使用 SQLite 的优点是：

*   您不需要设置数据库服务器，它只是一个文件
*   无需配置
*   跨平台

主要是，桌面应用程序是真正利用这一点的应用程序。对于 Web 应用程序，不推荐使用 SQLite，因为包含数据的文件易于读​​取（缺少任何类型的加密），并且当 Web 服务器缺少特殊配置时，任何人都可以下载该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T12:22:19.960

就 Web 应用程序而言，Django、Twisted 和 CherryPy 是流行的 Python“后端”，就网络而言，Twisted 可能是最灵活的。

如前所述，SQLite 可以直接与使用 SQL 命令进行交互，因为它具有 Python 的本机绑定，或者可以使用 SQLObject（另一个 Python 库）等对象关系管理器进行访问。

就性能而言，SQLite 具有相当的可扩展性，应该能够处理大多数不需要单独的数据库服务器（没有企业级）的用例。SQLite 的另一个好处是，数据库在单个文件中是自包含的，允许轻松备份，同时仍然是多个应用程序可以访问数据的足够通用的格式。然而，关于在 Python 中使用 SQLite 的一个建议是，您可能会遇到线程问题（过去大多数 SQLite 绑定*都不*是线程安全的，尽管这可能会随着时间的推移而改变）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T11:45:43.293

您在应用程序层使用的语言与您在下面选择的数据库几乎没有关系。您需要检查其他数据库包的优势，以了解您想要什么。

以下是一些便宜或免费的流行数据库包：

ms sql server express, pg/sql, mysql

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T12:07:48.697

如果您的意思是“什么是最好的数据库？” 那么根本没有办法回答这个问题。如果您只想要一个不会被多个人同时使用的小型数据库，那么 SQLite 就是您要找的。如果您正在为一家服务于数千人的大公司运行数据库，那么您可能正在寻找 Oracle。在这两者之间，您有 MySQL、PostgreSQL、SQL Server、db2，可能还有更多。

如果您熟悉其中之一，那么从实际的角度来看，这可能是最好的选择。如果你正在做一个典型的 web 应用程序，我的建议是使用 MySQL 或 PostgreSQL，因为它们是免费的，并且几乎得到你能想到的任何 ORM 的良好支持（我个人偏好 PostgreSQL，但我没有经验足以用其中任何一种方式提出一个很好的论点）。如果你*确实*选择了这两个中的一个，我的建议是使用[storm](https://storm.canonical.com/)作为ORM。

（是的，有 SQL Server 和 Oracle 的免费版本。但就 ORM 而言，你不会有那么多选择）

# ruby-on-rails - 到 JSON 的 ActiveRecords 数组

> ID：1017416
> 
> 赞同：2
> 
> 时间：2009-06-19T11:09:20.000
> 
> 标签：ruby-on-rails, json

我知道 ActiveRecord 提供了一个 to_json 方法，该方法允许使用 :only 和 :except 将字段从 JSON 输出中过滤掉。

目前，我正在使用以下内容将 find 中的数组格式化为 JSON：

```
@customers = Customer.find(:all)
...
format.js { render :json => @customers} 
```

我如何能够选择要在数组中的对象中输出的字段？是否有捷径或我需要手动执行此操作？

干杯，亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-25T01:53:30.163

我想你回答了你自己的问题。使用 Rails 2.3.x，您可以使用以下内容：

```
@customers = Customer.all #Shortcut for to Customer.find(:all)
respond_to do |format|
  format.js { render :json => @customers.to_json(:only=>[:column_one, :column_two]}
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-24T19:50:57.913

如果要全局应用模型的更改，可以覆盖模型类的 to_json 方法。

例如，要从呈现的 JSON 中排除空值，您可以覆盖原始 ActiveRecord 方法 to_json

```
 def to_json(options)
    hash = Serializer.new(self, options).serializable_record
    hash = { self.class.model_name => hash } if include_root_in_json
    ActiveSupport::JSON.encode(hash)
  end 
```

在你的模型类中使用这个：

```
 def to_json(options)
    hash = Serializer.new(self, options).serializable_record.reject {|key, value| value.nil? }
    hash = { self.class.model_name => hash } if include_root_in_json
    ActiveSupport::JSON.encode(hash)
  end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T17:17:14.700

如果您查看 ActionController::Base 类，您会看到它立即在您的集合上调用 to_json（没有使用额外的选项），因此您必须已经准备好它。因此，如果在您的操作中您不使用未呈现为 json 的属性，则可以将您的 find 替换为

```
@customers = Customer.find(:all, :select => ["id", ...]) 
```

只选择您需要的那些。

# c# - WPF中类似访问的数据导航？

> ID：1017421
> 
> 赞同：1
> 
> 时间：2009-06-19T11:11:20.087
> 
> 标签：c#, wpf, data-binding, navigation, itemscontrol

在 XAML/C# 中的访问表单中构建数据导航的最佳方法是什么？

我是否应该构建一个用户控件（甚至自定义控件），然后将其绑定到我的集合中，以便在其中放置其他控件？（因此这个问题：[C# User Control that can contain other Controls (when using it)](https://stackoverflow.com/questions/969835/c-user-control-that-can-contain-other-controls-when-using-it)）

或者我可以通过某种方式从 ItemsControl 派生来构建一些东西吗？如何？

或者今天会完全不同（比如“这种导航风格是去年的！”）？

我对 C# 和所有人都比较陌生（不是这样编程，而是更像“家庭主妇语言”Access-VBA），我也不是以英语为母语的人。所以请温柔=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T11:34:51.197

您可以创建用户控件并在其中放置一堆按钮（First、Prev、Next、Last 等）并将其放置在主窗口中。其次，您可以将数据导航用户控件绑定到`CollectionViewSource`将帮助您在数据之间导航的控件。

您的主窗口：

```
<Window.Resources>
    <CollectionViewSource x:Key="items" Source="{Binding}" />
</Window.Resources>
<Grid>
    <WpfApplication1:DataNavigation DataContext="{Binding Source={StaticResource items}}" />
    <StackPanel>
        <TextBox Text="{Binding Source={StaticResource items},Path=Name}" />
    </StackPanel>
</Grid> 
```

您的数据导航用户控制：

```
<StackPanel>
    <Button x:Name="Prev" Click="Prev_Click">&lt;</Button>
    <Button x:Name="Next" Click="Next_Click">&gt;</Button>
    <!-- and so on -->
</StackPanel> 
```

您的点击处理程序如下所示：

```
private void Prev_Click(object sender, RoutedEventArgs e)
{
    ICollectionView view = CollectionViewSource.GetDefaultView(DataContext);
    if (view != null)
    {
        view.MoveCurrentToPrevious();
    }
} 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T11:21:42.297

听起来您在使用 DataGrid 控件。Microsoft 正在发布 WPF DataGrid 作为 WPF 工具包的一部分，您可以在此处下载：[http](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047) ://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047 。

# iphone - 全屏图像预览

> ID：1017422
> 
> 赞同：0
> 
> 时间：2009-06-19T11:11:57.870
> 
> 标签：iphone, image, preview

有人可以告诉我如何在有人点击笔尖的图像视图时获得全屏图像预览视图...就像应用商店应用程序屏幕截图中的那个...这将是一个真正的帮助...提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T12:25:17.270

您需要做的第一件事是继承 UIImageView。

然后在您的子类中确保启用了用户交互（通过在代码中设置它，或者通过选中 IB 中的框）。

然后，您需要覆盖 touches:DidBeginWithEvent: (et al) 方法（它们位于 UIResponder 中），并将您想要发生的事情的代码放入其中。例如，您可以创建一个更大的图像视图，然后将其附加到视图层次结构中。

至于让它完全全屏，您需要将图像视图的框架设置为窗口的框架，并隐藏任何标签栏、导航栏、状态栏等。

您可以使用隐藏状态栏

```
[[UIApplication sharedApplication] setStatusBarHidde:YES]; 
```

隐藏导航栏：

```
[navigationController setNavigationBarHidden:YES]; 
```

等等等等。您应该能够通过查看他们的文档找到隐藏大多数内容的方法。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T04:02:29.360

我实际上想要一个控件，比如照片中的图像预览，也许是 facebook 上的控件……我在开源three20 存储库中找到了它……谷歌它找出……

# xslt - XSLT 1.0：在多个文档之间排序

> ID：1017423
> 
> 赞同：0
> 
> 时间：2009-06-19T11:12:07.793
> 
> 标签：xslt, sorting

```
<xsl:for-each select="//filenames">
   <xsl:variable name="current_filename" select="."/>
   <xsl:for-each select="
     document(.)//someNode[not(
       . = document($current_filename/preceding-sibling::node())//someNode
     )]
   ">
      <xsl:value-of select="."/>
   </xsl:for-each>
</xsl:for-each> 
```

`//filenames`在上面的代码（ XSLT 1.0）中，我有一系列文档（

为了让它工作，我必须嵌套两个 for-each 循环，因为我必须将当前文档名称保存在一个变量中，以便选择其前面的兄弟 ( `$current_filename/preceding-sibling`)。

这一切都有效，但由于我有两个嵌套循环，我无法对所有文档中的结果节点进行排序，就好像它是一个大序列一样。如果我在第一个 for-each 中插入排序规则，它现在对每个文档的节点进行排序。

有谁知道实现这种排序的方法吗？也许是一种避免使用变量并因此嵌套 for-each 循环的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T11:54:58.907

在一个步骤中做到这一点的唯一方法是将所有节点存储在一个变量中，并将其转换为具有`node-set()`扩展功能的节点集。然后可以对组合的节点集进行正常排序。

如果`node-set()`由于某种原因不能使用该功能，则只能将操作分解为两个单独的转换步骤：1）在临时文档中未排序的输出节点，2）将临时文档转换为所需的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T11:17:25.553

您可以将整个结果放在一个变量中 - 然后使用节点集您可以使用结果。有关使用节点集的示例，请参见此处[http://www.exslt.org/exsl/functions/node-set/index.html](http://www.exslt.org/exsl/functions/node-set/index.html)

乔什

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T14:19:49.193

我已经找到了如何做到这一点！

通过首先选择所有节点并对其进行排序，我就能够过滤掉我不想要的节点！所以我改变了选择/排序的顺序。首先选择然后排序是不可能的，但是反过来也可以！不过感谢您的输入:)。

# javascript - 通过 SRC 属性将 vars 传递给 JavaScript

> ID：1017424
> 
> 赞同：17
> 
> 时间：2009-06-19T11:12:10.243
> 
> 标签：javascript, html, url, variables, src

在我的 HTML 文件中，我已链接到 JS：

```
src="myscript.js?config=true" 
```

我的 JS 可以像这样直接读取这个 var 的值吗？

```
alert (config); 
```

这不起作用，FireFox 错误控制台显示“未定义配置”。如何读取通过 JS 文件中的 src 属性传递的变量？就这么简单吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-19T11:16:44.040

```
<script>
var config=true;
</script>
<script src="myscript.js"></script> 
```

您不能按照您尝试的方式将变量传递给 JS。SCRIPT 标记不会创建 Window 对象（具有查询字符串），它不是服务器端代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T11:26:00.247

是的，您可以，但您需要知道脚本中的确切脚本文件名：

```
var libFileName = 'myscript.js',
    scripts = document.head.getElementsByTagName("script"), 
    i, j, src, parts, basePath, options = {};

for (i = 0; i < scripts.length; i++) {
  src = scripts[i].src;
  if (src.indexOf(libFileName) != -1) {
    parts = src.split('?');
    basePath = parts[0].replace(libFileName, '');
    if (parts[1]) {
      var opt = parts[1].split('&');
      for (j = opt.length-1; j >= 0; --j) {
        var pair = opt[j].split('=');
        options[pair[0]] = pair[1];
      }
    }
    break;
  }
} 
```

您现在有一个传递参数的“选项”变量。我没有测试它，我从[http://code.google.com/p/canvas-text/source/browse/trunk/canvas.text.js](http://code.google.com/p/canvas-text/source/browse/trunk/canvas.text.js)对其进行了一些更改。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T11:25:51.837

您可能已经看到这样做了，但实际上 JS 文件是首先使用 PHP 或其他语言在服务器端进行预处理的。服务器端代码将打印/回显带有变量集的 javascript。我以前见过一个脚本广告服务这样做，它让我想看看它是否可以用普通的 ol'js 来完成，但它不能。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T11:26:14.723

您需要使用 Javascript 查找脚本的 src 属性并解析“？”之后的变量。使用 Prototype.js 框架，它看起来*像*这样：

```
var js = /myscript\.js(\?.*)?$/; // regex to match .js

var jsfile = $$('head script[src]').findAll(function(s) {
    return s.src.match(js);
}).each(function(s) {
    var path = s.src.replace(js, ''),
    includes = s.src.match(/\?.*([a-z,]*)/);
    config = (includes ? includes[1].split('=');
    alert(config[1]); // should alert "true" ??
}); 
```

我的 Javascript/RegEx 技能生疏了，但这是一般的想法。直接从 scriptaculous.js 文件中提取！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T11:28:07.917

但是，您的脚本可以找到自己的脚本节点并检查 src 属性并提取您喜欢的任何信息。

```
 var scripts = document.getElementsByTagName ('script');
  for (var s, i = scripts.length; i && (s = scripts[--i]);) {
    if ((s = s.getAttribute ('src')) && (s = s.match (/^(.*)myscript.js(\?\s*(.+))?\s*/))) {
      alert ("Parameter string : '" + s[3] + "'");    
      break;
    } 
  } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-11T23:23:29.227

是否应该这样做，这是一个公平的问题，但如果你想这样做， http: [//feather.elektrum.org/book/src.html](http://feather.elektrum.org/book/src.html)确实显示了如何。假设您的浏览器在渲染脚本标签时阻塞（目前是正确的，但可能不是未来的证明），有问题的脚本始终是页面上的最后一个脚本。

然后使用一些框架和插件，如 jQuery 和[http://plugins.jquery.com/project/parseQuery](http://plugins.jquery.com/project/parseQuery) ，这变得非常简单。很惊讶还没有插件。

有点相关的是 John Resig 的降级脚本标签，但它在外部脚本之后运行代码，而不是作为初始化的一部分： http: [//ejohn.org/blog/degrading-script-tags/](http://ejohn.org/blog/degrading-script-tags/)

致谢：[向 JavaScript 文件传递​​参数，向 JavaScript 文件](https://stackoverflow.com/questions/2190801/passing-parameters-to-javascript-files/2190835#2190835)传递[​​参数](https://stackoverflow.com/questions/2190801/passing-parameters-to-javascript-files/3134232#3134232)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-23T08:17:04.130

使用全局变量不是一个干净或安全的解决方案，相反，您可以使用 data-X 属性，它更干净、更安全：

```
<script type="text/javascript" data-parameter_1="value_1" ... src="/js/myfile.js"></script> 
```

您可以从 myfile.js 访问数据参数，例如使用 jQuery：

```
var parameter1 = $('script[src*="myfile.js"]').data('parameter_1'); 
```

显然“myfile.is”和“parameter_1”必须在 2 个源中匹配；）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-27T13:25:24.703

你可以用一行代码做到这一点：

```
new URL($('script').filter((a, b, c) => b.src.includes('myScript.js'))[0].src).searchParams.get("config") 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-26T15:07:49.633

如果传递不带名称的参数会更简单，就像函数调用一样。

在 HTML 中：

```
<script src="abc.js" data-args="a,b"></script> 
```

然后，在 JavaScript 中：

```
const args=document.currentScript.dataset.args.split(','); 
```

现在 args 包含数组 ['a','b']。

# java - 是否有可能知道进程是否在 Linux 上的 Receive() 调用中处于阻塞状态等待？

> ID：1017427
> 
> 赞同：0
> 
> 时间：2009-06-19T11:15:01.873
> 
> 标签：java, linux-kernel, jvm, blocking

我的主要目的是以循环方式一个接一个地执行进程，直到一个调用 receive() 并被阻塞，以便执行切换到队列中的下一个进程。有一个用 Java 编码的控制器应用程序，它使用 Runtime.getRuntime().exec() 执行这些进程（也是 Java 应用程序）并保留作为 Process 对象的返回值。

为了达到这个目的，我需要捕获接收（）调用（或它们的状态，被阻塞）并将它们告诉控制器（主）应用程序。

如果可能的话，我可以尽可能地低级。我的第一个想法是从驱动程序获取此信息，然后将其告诉我的控制器 Java 应用程序。我编写了一个 linux 内核网络模块来捕获发送和接收操作，但是 AFAIK 的 socket.receive() 函数并没有告诉网络驱动程序任何东西。

所以，我认为选项是从 JVM 获取这些信息，以某种方式从 linux 命令或其他获取它，或者可能通过 linux 内核模块？

你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T11:44:34.233

你看过[systemtap](http://sourceware.org/systemtap/wiki/HomePage)吗？应该可以在最近的 Fedora 系统上使用。

最佳安德斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:24:06.683

如果您想知道您的线程是否被阻塞，或者它们被阻塞的确切原因，您可以进行线程转储或使用[jvisualvm](http://java.sun.com/javase/6/docs/technotes/tools/share/jvisualvm.html)之类的工具附加到进程并查看（在 jvisualvm 中，您将附加到进程，进行线程转储，然后查看每个线程的活动）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T11:31:47.767

我不知道这是否会对您有所帮助，但您可以使用本地附加获取有关您机器上 Java 线程状态的信息。

1) 将 tools.jar 添加到您的类路径并使用 VirtualMachine.list() 获取您机器上正在运行的 JVM 的列表。

2) 附加到使用 VirtualMachine.attach(virtualMachineDescriptor) 处理的 JVM

3) 获取本地连接器地址，vm.getAgentProperties().get("com.sun.management.jmxremote.localConnectorAddress")；

4) 使用 JMXConnectorFactory.newJMXConnector(...) 连接到 JVM

5) 从 JMX 连接查找 ThreadMXBean

6) 从 ThreadMXBean 你得到一个 ThreadInfos 数组，它描述了 JVM 中的所有线程。

7) 从 TheadInfo#getThreadState() 您可以检查状态是否为 ThreadState.BLOCKED

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T11:41:09.920

您应该在工作进程中使用进程间通信原语来通知控制器应用程序它们已准备好接收数据。

您不能对子进程如何实现其套接字读取做出假设。他们可能正在使用recv、select、poll等来等待网络数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T13:33:59.223

这里其实有几点。Linux 调度程序足够聪明，可以抢占一个被阻塞的任务。这意味着，如果您调用 receive() 并且没有等待接收的内容，您的任务可能会进入休眠状态，直到调用返回。您不需要处理调度；Linux 内核会为你做这件事。

也就是说，如果您需要知道您的任务是否被某个守护程序应用程序阻止，如果您愿意编写 LKM，为什么不直接在您感兴趣的任务列表中获取任务并检查其状态？

当然，简单地检查任务的状态可能无法准确地告诉您您想要什么。如果您的任务状态是`TASK_INTERRUPTIBLE`，它只会告诉您您的任务正在等待**某事**，但弄清楚那是什么可能并非易事。类似地，您的任务可能处于一种`TASK_RUNNING`状态，并且当前实际上并未在 CPU 上运行（但至少`TASK_RUNNING`处于您知道您的任务未被阻塞的状态）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-09T18:26:43.983

您可以发送一个 QUIT 信号（控制台上的 Ctrl-\）来获取线程转储。

# python - Lego Mindstorm 是否有任何 Ruby 或 Python 解释器？

> ID：1017429
> 
> 赞同：22
> 
> 时间：2009-06-19T11:15:31.140
> 
> 标签：python, ruby, interpreter, robotics, lego

我想开始用 Python 或 Ruby 编码。因为我拥有[乐高 Midstorms](http://en.wikipedia.org/wiki/Lego_Robotics)套件，所以我认为对它进行编程会很好。Mindstorms 砖有什么好的翻译/解释者吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T23:43:24.243

nxt-python 和 ruby​​-nxt 项目是 NXT 的远程控制接口。它们都在 PC 上运行并通过蓝牙或 USB 远程控制 NXT。如果您正在寻找在 NXT 上运行的替代固件，有几种不同的替代方案。

Steve Hassenplug 有一个网页，其中包含所有已知的替代固件和远程控制选项的完整列表。
[NXT 软件](http://www.teamhassenplug.org/NXT/NXTSoftware.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T11:48:10.793

使用 python，您可以使用[jaraco.nxt](http://pypi.python.org/pypi/jaraco.nxt)或[nxt-python](http://code.google.com/p/nxt-python/)来控制 NXT 机器人。我没有自己的，所以我从来没有使用过任何一个。

使用 nxt-python 找到了这个例子：

```
#!/usr/bin/env python

import nxt.locator
from nxt.motor import Motor, PORT_B, PORT_C

def spin_around(b):
        m_left = Motor(b, PORT_B)
        m_left.update(100, 360)
        m_right = Motor(b, PORT_C)
        m_right.update(-100, 360)

sock = nxt.locator.find_one_brick()
if sock:
        spin_around(sock.connect())
        sock.close()
else:
        print 'No NXT bricks found' 
```

看起来很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T11:19:48.777

这是一个[Ruby 的开源项目](http://rubyforge.org/projects/lego-mindstorms/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-11T20:18:54.287

试试pynxc [http://code.google.com/p/pynxc/](http://code.google.com/p/pynxc/)

# maven-2 - 如何在 Maven 程序集中包含单元测试？

> ID：1017430
> 
> 赞同：10
> 
> 时间：2009-06-19T11:15:33.950
> 
> 标签：maven-2, assemblies, junit, include

原因：我们的项目使用 Ant 作为命令行界面。使用 maven 的程序集插件制作新程序集后，我想进行初始测试以查看是否所有组件都已正确组装。因此，我需要在最终程序集中包含单元测试。组装后，初始测试将被称为

```
> ant initTest 
```

构建.xml：

```
<target="initTest">
  <junit>
   <test class="MyTest" />
  </junit>
</target> 
```

问题是：我想将单元测试保存在 src/test/java 中，而*不是*将它们移动到 src/main/java。有没有办法告诉程序集插件包含我的单元测试？程序集描述符中的简单*包含*不会这样做...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T13:13:49.093

有两个步骤：

1.  将测试打包到 jar 以及主代码中。
2.  依赖于制作程序集的模块中的“-tests”jar。

要打包测试，您需要 bin [jar:test-jar](http://maven.apache.org/plugins/maven-jar-plugin/test-jar-mojo.html)目标。例如

```
<build>
  <plugins>
    <plugin>
      <artifactId>maven-jar-plugin</artifactId>
      <executions>
        <execution>
          <id>test-jar</id>
          <phase>package</phase>
          <goals>
            <goal>test-jar</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build> 
```

然后在组装模块中，您可以依赖生成的工件。

```
<dependencies>
  <dependency>
    <groupid>${project.groupId}</groupId>
    <artifactId>some-artifact</artifactId>
    <version>${project.version}</version>
    <classifier>tests</classifier>
  </dependency>
</dependencies> 
```

关键位是“分类器”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-12T16:32:41.423

@Dominic-Mitchell 的回答对我根本不起作用。最终起作用的是将`fileSet`测试类添加到我的程序集 xml 中。**请注意，fileSet 目录是不同的！**这让我困扰了最长时间。

用于`${project.build.directory}`测试类和`${project.build.outputDirectory}`主要：

```
<?xml version='1.0' encoding='UTF-8'?>
<assembly>
    <id>toolbar-test</id>
    <formats>
        <format>jar</format>
    </formats>

    <includeBaseDirectory>false</includeBaseDirectory>

    <fileSets>
        <fileSet>
            <directory>${project.build.directory}/test-classes</directory>
            <outputDirectory>/</outputDirectory>
        </fileSet>
        <fileSet>
            <directory>${project.build.outputDirectory}</directory>
            <outputDirectory>/</outputDirectory>
        </fileSet>
    </fileSets>

    <dependencySets>
        <dependencySet>
            <scope>runtime</scope>
            <unpack>true</unpack>
            <unpackOptions>
                <excludes>
                    <exclude>**/LICENSE*</exclude>
                    <exclude>**/README*</exclude>
                </excludes>
            </unpackOptions>
        </dependencySet>
        <dependencySet>
            <scope>test</scope>
            <unpack>true</unpack>
        </dependencySet>
    </dependencySets>
</assembly> 
```

信用到期 - 我在这篇博客文章中找到了这个解决方案：http: [//alexgaddie.blogspot.com/2010/02/creating-uber-jar-with-maven.html](http://alexgaddie.blogspot.com/2010/02/creating-uber-jar-with-maven.html)
我不需要`profile`博客的一部分邮政。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-25T11:27:26.417

以下对我们有用。

`pom.xml`片段：

```
<build>
    <plugins>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.6</version>
            <executions>
                <execution>
                    <goals>
                        <goal>test-jar</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>           
    </plugins>
</build> 
```

`assembly.xml`片段：

```
<dependencySets>
    <dependencySet>
        <outputDirectory>/lib</outputDirectory>
        <useProjectArtifact>true</useProjectArtifact>
        <useProjectAttachments>true</useProjectAttachments>
        <scope>runtime</scope>
    </dependencySet>
</dependencySets> 
```

关键是`useProjectAttachments`标签。

# excel - 更改数据透视图单位

> ID：1017432
> 
> 赞同：1
> 
> 时间：2009-06-19T11:15:53.260
> 
> 标签：excel, pivot-table, excel-2000

我有一个在 X 轴上跨越数年的数据透视图，其中包含每天的数据。问题是 X 轴上每天都有一个标签，所以它们太杂乱而无法阅读。我只想将月份显示为标签而不是日期，并且仍然每天看到数据点，但这是我到目前为止发现的内容：

*   在普通图表中这样做是微不足道的，只需转到“比例”选项卡上的轴格式设置，并将主要单位设置为“月”。此字段不存在于数据透视图的同一选项卡中。
*   我可以在数据透视图上设置“刻度标记标签之间的类别数”，但当然它们与月份不一致。
*   我可以将数据透视表设置为使用月份而不是日期，但是会丢失很多分辨率。
*   设置`Charts(1).Axes(xlCategory).MajorUnitScale = xlMonths`似乎没有做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:20:26.943

您可以按多个值对 X 轴进行分组，例如按天和月。不幸的是，它并没有消除每天标签的混乱，但它确实在轴上叠加了月份。

# iphone - iPhone Xcode 项目组织问题

> ID：1017433
> 
> 赞同：0
> 
> 时间：2009-06-19T11:16:21.310
> 
> 标签：iphone, xcode, project

*   我为客户构建了一个简单的 iPhone 应用程序
*   这将使用 Ad Hoc Provisioning 配置文件通过 iTunes 分发
*   我需要构建两个不同的可执行文件
*   1) 测试申请和 2) 正式申请
*   两个应用程序之间的唯一区别是： . Default.png 启动屏幕。应用程序中的一些图像图标。应用程序图标

如何组织我的 xcode 项目，以便我可以将单个项目用于两个应用程序？- 我需要创建多个目标吗？- 我可以为两个应用程序使用相同的应用程序名称和供应配置文件，还是我需要不同的？- 在构建开始时添加 shell 脚本并根据项目中定义的 SWITCH VARIABLE 个性化应用程序图形是否更简单？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:15:24.233

如果您将其设置为“通配符”配置文件，则可以使用相同的配置文件。通过将应用程序标识符设置为类似于“com.companyname.*”的内容（* 是重要部分）来做到这一点。

至于图像切换，您可以使用两个目标来执行此操作，并且每个目标在构建过程开始时都有一个特定的 shell 脚本，用于选择要使用的图像。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T14:36:49.410

是的，你应该创建多个 tatgets。这是包含不同 Default.png 文件的最简单方法。

您使用通配符配置文件签署这两个版本。查看 Apple 配置文档。

# c# - 实施 OpenID：识别用户

> ID：1017435
> 
> 赞同：7
> 
> 时间：2009-06-19T11:16:42.090
> 
> 标签：c#, .net, authentication, openid, dotnetopenauth

我工作的公司想向外界发布一个内部网站，但也想以某种简单的方式识别访问者。某些功能将对所有访问者可见，但大多数功能必须对经过身份验证的访问者可见。（并且某些功能仅限于管理员访问者。）虽然管理层正在考虑实施我们自己的身份验证系统，但我建议只使用已经可用的现有技术，并使用户名/密码的管理远离我们。（因为当我们谈论安全性时，我们只是业余爱好者。身份验证需要非常好。）

所以我从 Google 的[OpenID](http://code.google.com/p/dotnetopenid/)开始，检查了他们提供的库。看起来很容易使用，我可以获得告诉我用户已通过身份验证的令牌。但是我如何识别这个用户，以便我可以将我们的个人资料信息链接到他的 ID/Token/Whatever？

我知道我遗漏了一些东西，所以为了简单起见：我只需要一些示例来说明如何使用 Google 对访问者进行身份验证，然后获取一些我可以用来永久链接到该用户的令牌。（因此，没有会话令牌。）然后此令牌可用于用户填写他/她的个人资料。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T13:46:10.773

由于您的标签表明您的语言是 C#，因此我推荐[DotNetOpenAuth](http://dotnetopenauth.net/)。它是免费的，并包含将向您展示如何获取令牌（在 OpenID 术语中称为声明标识符）的示例，您可以使用它来区分用户。

要获取 Claimed Identifier（您要查找的永久标识符），如果您使用`OpenIdTextBox`or`OpenIdLogin`控件，只需处理其 LoggedIn 事件并获取 e.ClaimedIdentifier 属性。如果您以编程方式执行此操作（无控件），则该`OpenIdRelyingParty.GetResponse()`方法返回一个`IAuthenticationResponse`接口，该接口具有`ClaimedIdentifier`您可以获得的属性。

然后，您可以实现一个 ASP.NET RoleProvider（真的很简单），它允许一些 OpenID 声明的标识符属于管理员角色，从而允许您的标准 ASP.NET 授权技术根据个人的身份验证方式逐步锁定他们。

# iphone - 刷新 UITableView

> ID：1017439
> 
> 赞同：3
> 
> 时间：2009-06-19T11:17:56.690
> 
> 标签：iphone, objective-c, cocoa-touch, uitableview

我有一个 UITableView 子类和一个用于单元格的 UITableViewCell 子类。我提前构建了所有单元格并将它们存储在一个数组中，我在 cellForRowAtIndexPath 中使用它们。除此之外，我还有一个线程在后台加载每个单元格中的一些图像。问题是单元格的刷新速度不如加载图像的速度快。例如，如果我不滚动表格视图，则只有在所有单元格都被修改并且线程退出时才会刷新第一个单元格。

关于如何有效刷新表格视图/单元格的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-15T02:42:31.723

您是否尝试过`[cell setNeedsDisplay]`在主线程上调用？

在后台线程上调用 setNeedsDisplay 几乎什么都不做，

试试这个：

```
[cell performSelectorOnMainThread:@selector(setNeedsDisplay) withObject:nil waitUntilDone:NO]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:09:57.740

您是否使用回调通知您的表格视图的控制器图像已加载？如果没有，那将是一个理想的方法。

当图像加载时，触发对表格视图控制器的回调，将图像设置在单元格上，然后在表格视图上调用 reloadData。这样，每当加载新图像时，表格都会更新以显示它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:20:09.763

不确定你想用这些图像实现什么——但我能猜到它们来自服务器，这就是你想在另一个线程中下载它们的原因吗？

在显示表格之前，我不会尝试加载单元格 - 您应该尽可能使用延迟加载，以确保充分利用设备上的内存。

我的建议是考虑使用 NSOperation 的子类来管理图像的加载。首先 NSOperation 将为您处理线程的所有复杂性，并允许您将操作排队。然后，您将能够为顶部的单元格确定要完成的操作的优先级。

随着每个操作的完成，您可以回调单元格或 tableViewController（也许创建一个委托协议以使这非常容易）。

如果您对每个图像/单元格组合都有一个操作，那么您应该能够在操作完成时刷新每个单元格。这样做并确定操作的优先级将为您提供最佳解决方案。

如果 NSOperations 听起来很复杂，或者你对此感到厌烦——请尝试一下——它比我说的听起来要简单得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T12:45:21.833

你试过打电话`[cell setNeedsDisplay]`吗？

# bash - OSX 恶意终端命令（冒号、方括号、大括号、符号等）

> ID：1017440
> 
> 赞同：9
> 
> 时间：2009-06-19T11:18:16.797
> 
> 标签：bash, macos

好的，所以有人“挑战”我将其输入我的 OSX 终端，但我不知道它会做什么：

**警告**读者：以下行可能是有害的；除非您知道自己在做什么，否则请勿**输入：**

```
:(){ :|:& };: 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-19T11:20:42.550

这是一个[叉子炸弹](http://en.wikipedia.org/wiki/Fork_bomb)。不要这样做。（实际上，正如 GB 很快指出的那样，这里的副本一开始是一个破碎的叉形炸弹。它缺少最后一个冒号。）不过，如果有人在窃笑时说“试试这个命令”，你不知道它是什么是的，常识说...

编辑：[您在这里拥有](http://www.digitalcraft.org/?artikel_id=292)的那件作品作为数字艺术家 Jaromil[的艺术品](http://www.p0es1s.net/en/projects/jaromil.html)而非常有名。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-01T06:27:49.727

分解命令，使其实际上可以理解：

```
:() #Define new function
    #named ':'
{ #Begin function definition
  #block
  :|:& #Pipe the very ':' function through itself,
        #creating two processes, and make the
        #resulting copy run in the background
        #(the & part)
} #End function definition block
;: #Call ':' for the first time, initiating a chain
   #reaction: each instance of ':' will create two
   #more instances, ad infinitum 
```

再说一次，根据我的经验，Mac OS X 恰好对每个用户可以执行的进程数有限制，所以除非你真的有胆量在 a`sudo -s`或`sudo -i`shell 下运行 fork 炸弹，否则应该没问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-20T00:58:36.570

它没有任何害处，因为 Mac OS X 有一个（每用户）进程数上限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T11:28:07.433

绝对没有。这是“叉子炸弹”的不完整版本，末尾缺少一个冒号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T11:25:49.433

叉子炸弹！

我的意思是……有趣的炸弹！在虚拟机中试一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T17:35:06.113

在正确配置的系统上，它不会造成太大的伤害，您应该可以尝试一下。

# asp.net - 迭代Repeater中的控件

> ID：1017442
> 
> 赞同：4
> 
> 时间：2009-06-19T11:18:56.640
> 
> 标签：asp.net

我有一些代码可以确定控件（在转发器中）是否应该可见，我想在 Page_Load 上调用它，但我似乎无法在转发器中获取控件。

```
<asp:Repeater ID="repreat" runat="server" >
        <HeaderTemplate>
            <asp:PlaceHolder runat="server" ID="thActivePrimary">Blah</asp:PlaceHolder>
            <asp:PlaceHolder runat="server" ID="PlaceHolder1">Blah</asp:PlaceHolder>
        </HeaderTemplate>
        <ItemTemplate>
            <asp:PlaceHolder runat="server" ID="trActivePrimary">Blah</asp:PlaceHolder>
            <asp:PlaceHolder runat="server" ID="thActivePrimary2">Blah</asp:PlaceHolder>
        </ItemTemplate>              
</asp:Repeater> 
```

repeat.Controls 始终为空。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T11:25:42.790

```
 foreach (RepeaterItem ri in repeat.Items)
         ri.FindControl("thActivePrimary").Visible = false; 
```

这应该工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T11:23:59.953

控件不是在页面加载时创建的，它们是在调用 databind 时创建的。如果您想在创建每个项目时访问它们，请查看转发器的 DataBound 事件。

或者将可见属性绑定到您的数据源

# xampp - 带有 PHP5 的 XAMPP 上的 NuSOAP：无法打开流

> ID：1017450
> 
> 赞同：0
> 
> 时间：2009-06-19T11:22:18.710
> 
> 标签：xampp, nusoap, php4, php

嘿伙计们，我有一个问题（再次）。这次我尝试使用带有 XAMPP 1.7.1 的 NuSoap，其中包括 PHP5 和 MySQL……我写了一个肥皂客户端：

```
<?php
// Pull in the NuSOAP code
require_once('nusoap.php');
// Create the client instance
$client = new soapclient('http://localhost/mysql/helloworld2.php');
// Check for an error
$err = $client->getError();
if ($err) {
    // Display the error
    echo '<p><b>Constructor error: ' . $err . '</b></p>';
    // At this point, you know the call that follows will fail
}
// Call the SOAP method
$result = $client->call('hello', array('name' => 'Doro'));
// Check for a fault
if ($client->fault) {
    echo '<p><b>Fault: ';
    print_r($result);
    echo '</b></p>';
} else {
    // Check for errors
    $err = $client->getError();
    if ($err) {
        // Display the error
        echo '<p><b>Error: ' . $err . '</b></p>';
    } else {
        // Display the result
        print_r($result);
    }
}

?> 
```

和我的肥皂服务器：

```
 // Enable debugging *before* creating server instance
   $debug = 1;
   // Create the server instance
   $server = new soap_server;
   // Register the method to expose
   $server->register('hello');

   // Define the method as a PHP function
   function hello($name) {

$dbhost = 'blah';
$dbuser = 'blub';
$dbpass = 'booboo';
try{
       $conn = MYSQL_CONNECT($dbhost, $dbuser, $dbpass) 
           or die ('Error connecting to mysql');

    if( !$conn ){
        return 'Hello, '.$name.' ...  too bad, I cannot connect to the db!';
    }
    else{
        $dbname = 'soaperina';
        MYSQL_SELECT_DB($dbname) or die('Error connecting to '.dbname);

        $queryres = @mysql_db_query(
                          'response',
                          'SELECT * FROM farben');

                    return 'RESPONSE: <br>';

                   while( $arr = mysql_fetch_array( $queryres ) ){
                         return $arr["ID"]." - ".$arr["Farben"]." - ".$arr["Rating"]."<br>";
                   }
            }
    }
    catch(Exception $e){
                 return 'Sorry, '.$name.', but that did not work at all!';
        }

   }
   // Use the request to (try to) invoke the service
   $HTTP_RAW_POST_DATA = isset($HTTP_RAW_POST_DATA) ? $HTTP_RAW_POST_DATA : '';
   $server->service($HTTP_RAW_POST_DATA);
?> 
```

我知道 PHP 可以工作，Apache 可以工作，MySQL 可以工作……它也可以一起工作，但是当我尝试使它与 NuSOAP 一起工作时，它就不起作用了。我得到以下信息：

> 警告：SoapClient::SoapClient( [http://localhost/mysql/helloworld2.php](http://localhost/mysql/helloworld2.php) ) [soapclient.soapclient]: 无法打开流：Ein Verbindungsversuch ist fehlgeschlagen, da die Gegenstelle nach einer bestimmten Zeitspanne nicht Richtig reagiert hat, oder die hergestellte Verbindung war fehlerhaft, da der verbundene Host nicht reagiert hat。在第 6 行的 C:\xampp\htdocs\mysql\helloworld2client.php
> 
> 警告：SoapClient::SoapClient() [soapclient.soapclient]: I/O 警告：无法在 C:\xampp\htdocs\mysql\helloworld2client.php中加载外部实体“ [http://localhost/mysql/helloworld2.php](http://localhost/mysql/helloworld2.php) ”在第 6 行
> 
> 致命错误：第 41 行的 C:\xampp\htdocs\mysql\helloworld2client.php 中的最大执行时间超过了 60 秒

我不知道那应该是什么意思。我希望你们能帮忙！！！提前谢谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-10T13:26:00.507

我将 NuSOAP 版本 1.7.3 与 PHP5 一起使用。在这个 NuSOAP 1.7.3 中，soapclient 类由 nu_soapclient 重命名。

你可以试试这个：

```
$client = new nusoap_client('http://localhost/mysql/helloworld2.php'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T06:02:54.093

回答我自己的问题：nusoap has a problem with php5 ...网上有一些答案和一些解决方案（不是很多），但他们没有与我合作。我降级到php4，它工作正常......

# java - 如果任务失败，如何执行 Ant 命令？

> ID：1017456
> 
> 赞同：13
> 
> 时间：2009-06-19T11:25:28.250
> 
> 标签：java, ant

假设我有一些 Ant 任务——比如 javac 或 junit——如果任一个任务失败，我想执行一个任务，但如果他们成功了，我就不会。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-19T12:38:41.270

例如，在您的[junit](http://ant.apache.org/manual/Tasks/junit.html)目标中，您可以设置`failureProperty`：

```
<target name="junit" depends="compile-tests" description="Runs JUnit tests">
    <mkdir dir="${junit.report}"/>
    <junit printsummary="true" failureProperty="test.failed">
        <classpath refid="test.classpath"/>
        <formatter type="xml"/>
        <test name="${test.class}" todir="${junit.report}" if="test.class"/>
        <batchtest fork="true" todir="${junit.report}" unless="test.class">
            <fileset dir="${test.src.dir}">
                <include name="**/*Test.java"/>
                <exclude name="**/AllTests.java"/>
            </fileset>
        </batchtest>
    </junit>
</target> 
```

然后，创建一个仅在`test.failed`设置属性时运行但最终失败的目标：

```
<target name="otherStuff" if="test.failed">
    <echo message="I'm here. Now what?"/>
    <fail message="JUnit test or tests failed."/>
</target> 
```

最后，将它们捆绑在一起：

```
<target name="test" depends="junit,otherStuff"/> 
```

然后只需调用`test`目标来运行您的 JUnit 测试。目标将`junit`运行。如果失败（失败或错误），`test.failed`将设置属性，并`otherStuff`执行目标主体。

[javac](http://ant.apache.org/manual/Tasks/javac.html)任务支持`failonerror`和属性，`errorProperty`可用于获取类似行为。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-02T18:13:21.120

正如凯所说：

> [ant-contrib](http://ant-contrib.sourceforge.net/tasks/tasks/index.html)有一个 trycatch 任务。

但您需要最新版本 1.0b3。然后使用

```
<trycatch>
    <try>
        ... <!-- your executions which may fail -->
    </try>
    <catch>
        ... <!-- execute on failure -->
        <throw message="xy failed" />
    </catch>
</trycatch> 
```

诀窍是再次抛出错误以指示构建损坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T11:33:21.400

[ant-contrib](http://ant-contrib.sourceforge.net/tasks/tasks/index.html)有一个 trycatch 任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T12:01:59.877

在要检查失败的任务中设置一个属性，然后编写第二个任务，以便在未设置该属性的情况下执行它。我不记得 build.xml 的确切语法，或者我会给出示例。

# python - PostgreSQL - 如何从事务块外的代码运行 VACUUM？

> ID：1017463
> 
> 赞同：41
> 
> 时间：2009-06-19T11:26:33.397
> 
> 标签：python, sql, postgresql, psycopg2, vacuum

我正在将 Python 与 psycopg2 一起使用，并且我试图在`VACUUM`插入数千行的日常操作之后运行完整。问题是当我尝试`VACUUM`在我的代码中运行命令时，我收到以下错误：

```
psycopg2.InternalError: VACUUM cannot run inside a transaction block 
```

如何从事务块外部的代码运行它？

如果它有所作为，我有一个简单的 DB 抽象类，它的一个子集显示在下面的上下文中（不可运行，异常处理和文档字符串被省略，并且行跨越调整）：

```
class db(object):
    def __init__(dbname, host, port, user, password):
        self.conn = psycopg2.connect("dbname=%s host=%s port=%s \
                                      user=%s password=%s" \
                                      % (dbname, host, port, user, password))

        self.cursor = self.conn.cursor()

    def _doQuery(self, query):
        self.cursor.execute(query)
        self.conn.commit()

    def vacuum(self):
        query = "VACUUM FULL"
        self._doQuery(query) 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-06-19T12:18:49.390

经过更多搜索，我发现了 psycopg2 连接对象的isolation_level 属性。事实证明，将其更改为`0`将使您脱离事务块。将上述类的vacuum方法改成如下即可解决。请注意，我还将隔离级别设置回以前的状态以防万一（似乎是`1`默认设置）。

```
def vacuum(self):
    old_isolation_level = self.conn.isolation_level
    self.conn.set_isolation_level(0)
    query = "VACUUM FULL"
    self._doQuery(query)
    self.conn.set_isolation_level(old_isolation_level) 
```

[本文](http://www.devx.com/opensource/Article/29071)（接近该页的末尾）提供了在此上下文中的隔离级别的简要说明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-08T21:15:48.727

此外，您还可以使用以下方法获取 Vacuum 或 Analyze 给出的消息：

```
>> print conn.notices #conn is the connection object 
```

此命令打印一个列表，其中包含诸如 Vacuum 和 Analyse 之类的查询的日志消息：

```
INFO:  "usuario": processados 1 de 1 páginas, contendo 7 registros vigentes e 0 registros não vigentes; 7 registros amostrados, 7 registros totais estimados   
INFO:  analisando "public.usuario" 
```

这对 DBA 很有用^^

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-19T15:09:25.160

虽然在当前版本的 postgresql 中，vacuum full 是有问题的，但在某些大规模操作之后强制执行“vacuum analyze”或“reindex”可以提高性能或清理磁盘使用情况。这是 postgresql 特有的，需要清理才能为其他数据库做正确的事情。

```
from django.db import connection
# Much of the proxy is not defined until this is done
force_proxy = connection.cursor()
realconn=connection.connection
old_isolation_level = realconn.isolation_level
realconn.set_isolation_level(0)
cursor = realconn.cursor()
cursor.execute('VACUUM ANALYZE')
realconn.set_isolation_level(old_isolation_level) 
```

不幸的是，django 提供的连接代理不提供对 set_isolation_level 的访问。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-03-17T04:45:41.593

对于其他尝试了有关此问题的所有建议但均未成功的其他人，您可能会遭受与我相同的命运：我在一次`execute()`调用中有 2 个（或更多）SQL 语句。事实证明，Postgres 本身会在第一条语句（由 a 分隔`;`）之后重置任何自动提交/隔离。我终于在这里遇到了解决方案：[https ://github.com/psycopg/psycopg2/issues/1201](https://github.com/psycopg/psycopg2/issues/1201)

所以不要做这样的事情：

```
cursor.execute("SELECT 1; VACUUM FULL") 
```

而是这样做：

```
cursor.execute("SELECT 1")
cursor.execute("VACUUM FULL") 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-15T17:18:53.957

请注意，如果您使用带有 South 的 Django 执行迁移，您可以使用以下代码执行`VACUUM ANALYZE`.

```
def forwards(self, orm):

    db.commit_transaction()
    db.execute("VACUUM ANALYZE <table>")

    #Optionally start another transaction to do some more work...
    db.start_transaction() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T11:59:33.097

我不知道 psycopg2 和 PostgreSQL，但只知道 apsw 和 SQLite，所以我想我不能给出“psycopg2”的帮助。

但在我看来，PostgreSQL 可能像 SQLite 一样工作，它有两种操作模式：

*   在事务块之外：这在语义上等同于在每个 SQL 操作周围都有一个事务块
*   在事务块内，由“BEGIN TRANSACTION”标记并以“END TRANSACTION”结束

在这种情况下，问题可能出在访问层 psycopg2 内部。当它通常以隐式插入事务直到提交之前的方式运行时，可能没有“标准方式”来制造真空。

当然，“psycopg2”可能有其特殊的“真空”方法，或特殊的操作模式，其中不启动隐式事务。

当不存在这种可能性时，只有一个选项（不更改访问层;-)）：

大多数数据库都有一个外壳程序来访问数据库。该程序可以使用管道运行这个shell程序（将vacuum命令输入到shell中），从而使用shell程序来制作真空。由于真空本身是一个缓慢的操作，外部程序的启动将是可以忽略的。当然，实际的程序应该先提交所有未提交的工作，否则可能会出现死锁情况——真空必须等到最后一个事务结束。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-06-19T12:22:50.100

不要这样做 - 你不需要 VACUUM FULL。实际上，如果您运行最新版本的 Postgres（比如说 > 8.1），您甚至不需要手动运行普通的 VACUUM。

# python - NameError：未定义全局名称“has_no_changeset”

> ID：1017467
> 
> 赞同：1
> 
> 时间：2009-06-19T11:28:17.807
> 
> 标签：python, syntax

好的 - 这里是 Python 新手 - 我想我正在做一些非常愚蠢的事情，你能告诉我它是什么，这样我们就可以继续我们的生活了吗？

我`NameError: global name 'has_no_changeset' is not defined`在第 55 行（我尝试调用函数`has_no_changeset`）中得到错误。

```
from genshi.builder import tag

from trac.core import implements,Component
from trac.ticket.api import ITicketManipulator
from trac.ticket.default_workflow import ConfigurableTicketWorkflow
from trac.perm import IPermissionRequestor
from trac.config import Option, ListOption
import re

revision = "$Rev$"
url = "$URL$"

class CloseActionController(Component):
    """Support for close checking.

    If a ticket is closed, it is NOT allowed if ALL the following conditions apply: 
     a) ticket is 'bug' ticket
     b) resolution status is 'fixed'
     c) none of the ticket's changes include a comment containing a changeset, i.e. regex "\[\d+\]"
     d) the ticket does not have the keyword 'web'
    """

    implements(ITicketManipulator)

    # ITicketManipulator methods

    def prepare_ticket(req, ticket, fields, actions):
        """Not currently called, but should be provided for future
        compatibility."""
        return

    def has_no_changeset(ticket):
        db = self.env.get_db_cnx()
        cursor = db.cursor()

        cursor.execute("SELECT newvalue FROM ticket_change WHERE ticket=%s AND field='comment'", (str(ticket.id).encode('ascii','replace'),))

        for newvalue, in cursor:
            if re.search("\[\d{5,}\]", newvalue):
                return False

        return True

    def validate_ticket(me, req, ticket):
        """Validate a ticket after it's been populated from user input.

        Must return a list of `(field, message)` tuples, one for each problem
        detected. `field` can be `None` to indicate an overall problem with the

        ticket. Therefore, a return value of `[]` means everything is OK."""

        if ticket['type'] == 'bug' and ticket['resolution'] == 'fixed':
          if ticket['keywords'] == None or ticket['keywords'].find('web') == -1:
            if has_no_changeset(ticket):
              return [(None, 'You can only close a bug ticket as "fixed" if you refer to a changeset somewhere within the ticket, e.g. with [12345]!')]

        return[] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T11:31:00.360

在引用当前类的方法时，您需要显式指定`self`（或在您的情况下为）：`me`

```
if me.has_no_changeset(ticket): 
```

您正在使用`me`而不是`self`- 这是合法的，但强烈建议不要这样做。成员函数的第一个参数应该被调用`self`：

```
def validate_ticket(self, req, ticket):
    # [...]
    if self.has_no_changeset(ticket): 
```

# objective-c - 更改 NSButton 的背景颜色

> ID：1017468
> 
> 赞同：33
> 
> 时间：2009-06-19T11:28:38.197
> 
> 标签：objective-c, cocoa, macos, user-interface

我在 mac 应用程序中有一个 NSButton，我想以编程方式更改其颜色，但我尝试的任何方法似乎都不起作用。我试图在 NSButtonCell 上创建一个输出并在那里设置背景颜色，但这也不起作用。任何代码片段都会有所帮助。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-19T13:01:32.020

假设您的无边框按钮的所有内容都连接在 IB 中。

```
// *.h file
IBOutlet NSButton* myButton;

// *.m file
[[myButton cell] setBackgroundColor:[NSColor redColor]]; 
```

[setBackgroundColor](https://developer.apple.com/documentation/appkit/nsbuttoncell)文档中的注释：

> “仅在绘制无边框按钮时使用背景颜色。”

如果这对您不起作用，那么您需要覆盖 NSButton 并自己实现绘图。

祝你好运。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-03-13T10:46:04.117

这是另一种可能的方法：

```
 let button = NSButton()
    button.title = ""
    button.bezelStyle = .texturedSquare
    button.isBordered = false //Important
    button.wantsLayer = true
    button.layer?.backgroundColor = NSColor.red.cgColor 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2019-09-26T07:15:32.110

如果有人遇到故事板设置问题，请参考检查：您可以将属性直接设置为 NSButton，如下所示

： [![在此处输入图像描述](../Images/c5eadccd95f57ca7a76c43f270951434.png)](https://i.stack.imgur.com/bkUeZ.png)

结果 ：
[![在此处输入图像描述](../Images/e8d12bc64f7a937980075cd575b66421.png)](https://i.stack.imgur.com/TKieL.png)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-06-19T14:11:00.117

标准 Aqua（药丸形）按钮由系统绘制。他们没有这样的背景颜色。事实上，它们是由 Cocoa 拼接在一起形成连贯按钮图像的图像组成的。因此 Cocoa 无法根据您的喜好重新着色图像。只有默认按钮（将 Return 设置为其等效键的按钮）将具有蓝色脉动背景。

听起来你想做的将涉及子类化`NSButtonCell`和做你自己的绘图。如果您想重新着色按钮图像以获得您想要的效果，您可以使用出色的[主题公园](https://www.geekspiff.com/software/themepark.1.html)实用程序来提取 Apple 按钮图像的副本并使用它们。我承认自己这样做是为了“窃取”某些其他方式无法访问的界面元素，例如 iTunes 中的滚动条。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-04-22T10:24:27.280

我创建了一个`NSButton`名为的子类`FlatButton`，它可以非常轻松地从 Interface Builder 更改按钮背景颜色、文本颜色、图标颜色、边框和其他类型的样式：

[https://github.com/OskarGroth/FlatButton](https://github.com/OskarGroth/FlatButton)

[![适用于 macOS 的平面按钮](../Images/3186ab5a4acf09e8bb93296046555b3b.png)](https://i.stack.imgur.com/hHLRP.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-10-26T18:27:46.933

马克的回答是正确的。但是如果通过代码来做会很麻烦，那么另一种方法是直接在界面生成器中进行设置。

1.  在 interfaceBuilder 中找到该按钮并单击它。
2.  在界面构建器的对象浏览器部分，您将看到您单击的按钮有一个下拉显示图标。点击它。然后它将显示 NSButton 的 NSButtonCell。点击它。
3.  选中 NSButtonCell 后，单击 Identity-Inspector。
4.  在 Identity-inspector 中查找名为`User Defined Runtime Attributes`
5.  单击小加号 (+) 以添加值。该值将显示为具有 3 个属性。**(A)** keyPath **(B)**类型**(C)**值
6.  将 keyPath 更改为：`backgroundColor`。将类型更改为：`Color`。将值更改为：您想要的任何颜色（将显示颜色选择器）

完毕。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-04-30T03:44:47.453

在 Swift 中，你可以这样做：

```
(button.cell as! NSButtonCell).isBordered = false
(button.cell as! NSButtonCell).backgroundColor = .white 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-04-13T09:12:53.697

一种方法是在按钮后面创建一个视图并设置它的颜色。这将创建具有相同框架的视图，并将按钮放在视图顶部。我在按钮上使用了一个标签来确保我们只添加一次视图，因此在绘制 UI 时可以重复调用该方法。

我已经包含了用于设置文本颜色的代码。

根据需要更改颜色和 alpha：

```
NSColor *colour = [NSColor colorWithRed:0.0 green:0.0 blue:1.0 alpha:0.5] ;
[self styleButton:button colour:colour] ;

-(void) styleButton:(NSButton *)button colour:(NSColor *)colour {

    [self setButton:button fontColor:[NSColor whiteColor]];

    if(button.tag == 9901) return ;

    button.bezelStyle = NSBezelStyleTexturedSquare ;
    [button setBordered:NO];

    NSView *b2 = [[NSView alloc] initWithFrame:button.frame] ;
    [button.superview addSubview:b2] ;

    b2.layer.backgroundColor = colour.CGColor;

    [button removeFromSuperview];
    [b2.superview addSubview:button];

    button.tag = 9901 ;
}

-(void) setButton:(NSButton *)button fontColor:(NSColor *)color {
    NSMutableAttributedString *colorTitle = [[NSMutableAttributedString alloc] initWithAttributedString:[button attributedTitle]];
    [colorTitle addAttribute:NSForegroundColorAttributeName value:color range:NSMakeRange(0, button.attributedTitle.length)];
    [button setAttributedTitle:colorTitle];
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-11T19:21:39.823

感谢您提供这些出色的答案。我编译了一个 NSButton 子类，它可以轻松设置背景颜色、边框属性（颜色、宽度、角）和标题属性（颜色、字体）。

随意使用： [https ://github.com/philfung/osx-dudley/blob/master/DudNSButton.swift](https://github.com/philfung/osx-dudley/blob/master/DudNSButton.swift)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-29T16:10:31.073

如果有人还在看这个。此代码适用于 Swift 5...

```
button.layer?.backgroundColor = NSColor.green.cgColor 
```

...您必须先设置需求层或在笔尖中添加一个层。它也适用于边框。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-12-13T09:05:37.423

您可以通过单击调色板中的“其他...”选项来选择自己的颜色使用“#colorLiteral”从 GUI 调色板中选择颜色。

Button.layer?.backgroundColor = #colorLiteral(red: 0, green: 0.4797514677, blue: 0.9984372258, alpha: 1)

![看图片](../Images/a93c9ca364a6009d7d953ff9235479ee.png)

* * *

## 回答 #12

> 赞同：-11
> 
> 时间：2010-07-27T10:33:30.200

UIElement（元素类似于按钮，视图......）

UIElement *varname;

```
[varname setBackgroundColor:[UIColor colorWithRed:0.8 green:0.8 blue:0.6 alpha:1.0]]; 
```

例如：UIButton *pButton；

```
[pButton setBackgroundColor:[UIColor colorWithRed:0.8 green:0.8 blue:0.6 alpha:1.0]]; 
```

# delphi - Delphi中的空字符串

> ID：1017469
> 
> 赞同：0
> 
> 时间：2009-06-19T11:29:05.513
> 
> 标签：delphi

我的问题如下：

```
WideCompareStr(FName,'')<>0 
```

即使 FName 设置为 '' 也返回 false。

```
WideCompareStr(trim(FName),'')<>0 
```

返回想要的结果。为什么我必须修剪一个空字符串 ('') 才能与另一个空字符串进行比较以获得正确的结果？

* * *

编辑：

澄清一下：我有以下代码来测试宽字符串变量是否为空字符串。

```
function TSybVerwandlung.isEmpty: Boolean;
var
  I : Integer;
begin
  Result:=true;
  if WideCompareStr(FName,'')<>0 then Result:=false
  else if WideCompareStr(FInfo,'')<>0 then Result:=false
  else
  begin
    //additional tests
  end;
end; 
```

即使 FName 设置为 ''，此函数也返回 true（我在调试器中检查了它）。在插入 trim(FName) 和 trim(FInfo) 而不是变量后，它返回了所需的结果。

我错过了什么重要的东西吗？我使用的编译器是 Borland Delphi 2006

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T11:34:02.680

如果两个字符串相等，WideCompareStr 返回 0。所以代码：

```
WideCompareStr(FName,'')<>0 
```

返回 false 因为两个字符串都相等，这是您所期望的（我猜！）。

编辑：

我现在很困惑。我刚刚检查并在以下代码中：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  s1: WideString;
  r1, r2: Integer;
begin
  s1 := '';

  r1 := WideCompareStr (s1, '');
  MessageDlg (IntToStr (r1), mtWarning, [mbOK], 0);

  r2 := WideCompareStr (Trim (s1), '');
  MessageDlg (IntToStr (r2), mtWarning, [mbOK], 0);
end; 
```

正如预期的那样，r1 和 r2 都为零。而你的第二行实际上是一个语法错误（Trim 只能接收一个参数）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-09T18:46:35.737

WideCompareStr 永远不会返回 FALSE！（它不返回布尔值）

相反，如果 S1=S2，则返回 0。

如果 S1 <> S2，则：

如果 S1 < S2，它要么返回负值

或者

如果 S1 > S2，则为正值。

另外：在 Delphi 中，Length(S) 从不调用 strlen()。所有字符串类型（Shortstring、AnsiString、WideString 和 UnicodeString *）都包含一个长度字段，它是一个 32 位整数（除了 Shortstring 类型，它只有 8 位）。

因此，在除 Shortstring 之外的所有字符串中，length() 调用将首先检查字符串变量是否为 NIL，如果是，则立即返回零，否则返回长度字段的内容。绝对不会对终止 NULL 字符进行内存扫描。

*   = UnicodeString 类型在 Delphi 2009 或更新版本中可用。Delphi 2009 及更新版本还重新定义：

类型

```
String = UnicodeString;  // in older Delphis: String = AnsiString;

Char   = Widechar;       // in older Delphis: Char = AnsiChar; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T11:33:13.257

你为什么不简单地使用[Length](http://delphi.about.com/library/rtl/blrtlLength.htm)？每当您有一个空字符串时，它都会返回零。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T12:42:27.783

我对宽字符串并没有那么深入，如果您纯粹在宽字符串级别进行比较（不使用 pwidechar 类型转换），那*应该不是*问题，但是

我知道使用 ansistrings 有两种空状态。一种是字符串的指针值为NIL，另一种是分配给某个“XXXX_EMPTYCHAR”#0#0常量。（符号的确切名称可能在 Delphi 和 FPC 之间有所不同）。如果某些例程使用指针进行比较，可能会出现奇怪的结果。奇怪的是，上面似乎都是 RTL，通常会仔细检查这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T11:31:44.430

我不想说显而易见的，但这一定是因为你的字符串中有空格，也许你可以构建一个函数来为你做这件事，你可以在你的应用程序中使用它来进行比较。

我的两分钱

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T11:40:06.817

也许这个测试会对这个问题有所了解：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  s1: string;
  s2: string;
begin
  s1 := ' ';
  s2 := '';
  if WideCompareStr(s1, '') <> 0 then showmessage('s1 test');
  if WideCompareStr(s2, '') <> 0 then showmessage('s2 test');
end; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T12:39:01.020

在 C++ Builder 中，有一个 IsEmpty() 函数。但是，我看不到如何从 Delphi 获得它。我刚刚就这个话题[提出了一个问题](https://stackoverflow.com/questions/1017729/how-to-use-string-isempty-method-in-delphi)。

# versioning - 文章版本/历史

> ID：1017472
> 
> 赞同：1
> 
> 时间：2009-06-19T11:30:58.567
> 
> 标签：versioning, history, article

我时不时地发现具有某种文章历史记录/版本控制的**Web应用程序，您可以在其中选择文章/内容的先前版本并基本上执行“恢复”过程。**我打算有一个这样的，但我有一些事情在我的脑海里，我想听听你的意见。

1）自动保存是否应该在历史列表中添加一个新条目？我想实现一个自动保存功能，所以，我想知道每个自动保存是否应该在版本历史列表中添加一个新条目？或者我应该为自动保存的文章有一个单独的“列表”（=仅最新的自动保存）？我认为梯子更有意义。如果浏览器崩溃（或 wtvr），那么用户可以恢复自动保存。历史列表是他通过按提交按钮保存的那些文章。同意？

2) 有多少个版本？如果用户不断修改文章（假设他不断添加新段落）然后保存文章，那么最多应该有多少个不同版本的文章？我应该让用户决定（这是我最初的想法）吗？通常合理的值是多少？10？在磁盘存储方面，版本控制是件坏事吗？如果每篇文章有 10 个版本，那么整个文章内容的空间基本上是 10 倍……现在想象一下，有 1 MB 的文章内容，整个 DB 将是 10 MB，并且一些主机有 DB 大小的限制。这就引出了问题3：

3）你曾经删除过版本吗？如果文章版本保持完整的时间足够长，您会删除它们吗？如果是这样，您设置的持续时间是多少？用户定义？一周是足够的默认值吗？如果时间不是指标，那是什么？如果时间是指标，那么您是运行 Cron 来进行清洁还是什么？

4）如何确定“变化”？如果用户在文章末尾添加一个点并按下保存按钮，我还会创建一个新的历史条目吗？你怎么处理这个？您是否仅比较文章是否已更改，如果更改则创建新条目？

我知道有很多问题，但是如果您有一些意见或想法，我很高兴听到它们。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T11:47:55.240

> 如果每篇文章有 10 个版本，那么整个文章内容的空间基本上是 10 倍……现在想象一下，如果有 1 MB 的文章内容，整个 DB 将是 10 MB，并且一些主机有 DB 大小的限制。

如果您在网络服务器上使用版本控制系统来管理实际条目（例如 rcs、subversion），您将不必担心更改是否重大，或者要保留多少，并且还应该节省磁盘空间. 这些系统已经设计为仅保存版本之间的更改。因此，对于两个版本，一个字符更改为 10M 文件仍应约为 10M。

# javascript - 使用 AJAX 检索的 UTF 字符未在 Safari 中显示

> ID：1017477
> 
> 赞同：3
> 
> 时间：2009-06-19T11:31:59.500
> 
> 标签：javascript, html, encoding, escaping

我在 Safari (v.4) 下将通过 Ajax 检索到的内容渲染到我的 HTML 页面时遇到问题。页面以 UTF-8 存储，Ajax 响应也是 UTF-8 编码的。

解析加载的内容，然后用解析的数据填充不同类型的列表。其中之一是简单的 <select> 元素，其中选项的文本是使用简单的代码设置的：

```
option.innerHTML = "";
option.appendChild(document.createTextNode(text)); 
```

我的文字包含法语字符。由于 < select > 元素上面的代码显示了这个法语文本分成两部分的选项，其中分隔符（一些很酷的法语字母）根本没有显示...... :(

使用

```
option.innerHTML = escapeGtLtAmp(text); 
```

有相同的结果。

如果法语内容设置为某些 < div > 的 innerHTML，则显示的文本不会拆分，而只是省略了非英文字母。

在 Firefox 2 下，一切似乎都很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T11:54:46.723

> 页面以 UTF-8 存储，Ajax 响应也是 UTF-8 编码的。

AJAX 响应是否也将 Content-Type-HTTP-header 设置为 UTF-8？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T10:15:00.403

我在 Firefox 3 上遇到了类似的问题，似乎问题出在 ajax 调用上。我也尝试更改请求标头，但问题仍然存在。所以我尝试从 iframe 加载数据，从而完全避免 ajax，然后获取 iframe 的 innerHTML。

如果您使用的是 jquery，也许[这个小插件](http://www.nicolas.rudas.info/jQuery/xajaSubmit.js)可以帮助您或只是给您一个想法

# c# - 在 CAL 中，如何获取对模块实例的引用？

> ID：1017479
> 
> 赞同：0
> 
> 时间：2009-06-19T11:32:39.500
> 
> 标签：c#, unity-container, cal

我有这个使用 CAL 的应用程序。所有的模块都派生自一个特殊的类，`ModuleBase`它有一个抽象方法，比如说`ApplySecurity`在每个模块中实现。

好的，我在引导程序中加载模块，在我调用之后`bootstrapper.Run()`，我想访问所有加载的模块并调用这个`ApplySecurity`方法。

我试过这个：

```
IModuleCatalog moduleCatalog = this.Container.Resolve<IModuleCatalog>();

moduleCatalog.Modules.ToList().ForEach(m => 
{
    (this.Container.Resolve(Type.GetType(m.ModuleType, false, false)) 
         as ModuleBase).ApplySecurity(); //^^^ this is making new instances!!
}); 
```

但这正在制作模块的新实例，我想引用已经初始化的那些。

我希望我已经足够清楚了，

特奥多尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T12:45:24.593

看起来问题在于，当模块注册到容器时，它没有注册为特定实例，因此当您请求解析时，会创建一个新实例。我查看了 CAL 源代码，注册发生在一组复杂的方法调用的中间，所以我怀疑你是否能够明智地提供自己的实现。

这意味着您需要在其他地方注册模块的实例。我想到的方法是创建某种模块实例目录并添加对每个模块的 initilize 方法的调用以向它注册。

```
public class ModuleInstanceCatalog : IModuleInstanceCatalog
{
     private Dictionary<Type, ModuleBase> _modules = new Dictionary<Type, ModuleBase>();

     public void RegisterModuleInstance(ModuleBase module)
     {
         _modules.Add(module.GetType(), module);
     }

     public ModuleBase GetModuleInstanceByType(Type type)
     {
         return _modules[type];
     }
} 
```

在您的引导程序 CreateShell() 中：

```
this.Container.RegisterInstance<IModuleInstanceCatalog>(new ModuleInstanceCatalog()); 
```

在每个模块的 Initilize() 中：

```
IModuleInstanceCatalog catalog = this.Container.Resolve<IModuleInstanceCatalog>();
catalog.RegisterModuleInstance(this); 
```

然后将问题中的代码替换为：

```
IModuleCatalog moduleCatalog = this.Container.Resolve<IModuleCatalog>();
IModuleInstanceCatalog instanceCatalog = this.Container.Resolve<IModuleInstanceCatalog>();

moduleCatalog.Modules.ToList().ForEach(m => 
{
    instanceCatalog.GetModuleInstanceByType(m.ModuleType).ApplySecurity();
}); 
```

我对此并不太满意，因为它感觉有点像软糖，但它应该可以满足您的需求。

# java - 检查条件 l+1 的最快方法 检查条件的最快方法是什么 l + 1 < r 在int l,rJava中？ l并且r不是恒定的，我知道l <= r。while比 问问题 问问题 2009-06-19T11:33:09.107 354 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 检查条件的最快方法是什么 l + 1 < r 在int l,rJava中？ l并且r不是恒定的，我知道l <= r。while比较是二分查找实现中循环的停止条件。我当然会在单独的测试（搜索大型数组）和使用它的代码中对我的代码进行基准测试。 我想，我正在寻找的是某种比目前情况更快的位操作。但我不知道。 我认为这可能和它会得到的一样快。这将简化为非常简单的字节码，而 JIT（即时编译器）可能会将其简化为非常简单的本机实现。 （不相关：有趣的是看到“量化开发人员”使用 Java 顺便说一句。不经常发生） javaperformanceinteger 4 7 回答 7 This answer is useful 10 这种微优化几乎总是一个坏主意；您的性能将完全取决于热点编译器如何优化您的代码，以及与周围代码有关的微妙缓存效果。 于 2009-06-19T11:45:03.327 回答 This answer is useful 4 我认为这可能和它会得到的一样快。这将简化为非常简单的字节码，而 JIT（即时编译器）可能会将其简化为非常简单的本机实现。 （不相关：有趣的是看到“量化开发人员”使用 Java 顺便说一句。不经常发生） 于 2009-06-19T11:44:52.797 回答 This answer is useful 2 那么基础比较必须： l 加 1，将结果与 r 进行比较 或者 从 r 中减去 1 并将结果与 l 进行比较 所有现代硬件对于任一操作都将具有相同的原始性能（其中任何本机数据类型的加法和减法在完成周期和流水线副作用方面具有相同的性能）。 这将产生任何影响的唯一方法是： l 或 r 之一是编译时已知的常量。例如。 l + 1 < 5 5 + 1 < r 在这种情况下，一个糟糕的优化编译器可能没有意识到它可以将第一个转换为l < 4 但是所有java编译器都需要发现第二种情况是6 < r 另一种是如果 l 和 r 的数据类型不同。 的操作： 浮点加法/减法然后与整数 比较 积分加法/减法然后与双精度比较可能会有所不同。 可以公平地说，这在您的应用程序中成为严重问题的可能性可以忽略不计，因为与与决策相关的任何分支错误预测的管道命中相比，任何这些的周期成本都很小。 此外，一个体面的 JIT 可能会针对周围的代码进行各种优化，这些优化超过了所执行的微优化。 于 2009-06-19T12:08:54.170 回答 This answer is useful 2 有一个lr1始终等于的变量(l - r + 1)。每当您增加或减少l时，对 . 执行相同的操作lr1。同样对于r。 然后您的测试变为(lr1 < 0)，并且修改指令lr1的执行频率不会超过必要。 我觉得给你一个微优化有点傻，在大多数情况下，这是一分钱一分货，一分钱一分货。就像你在比较字符串一样，它会完全淹没那个测试。 补充：既然你在做二进制搜索，我会提到 Jon Bentley 对二进制搜索的酷展开。首先，将表格填充A到 2 的幂，例如 1024。然后编写如下内容： i = 0; if (X >= A[i+512]) i += 512; if (X >= A[i+256]) i += 256; . . . if (X >= A[i+ 1]) i += 1; 最后测试是否(X == A[i])。或者，如果您不想填充它，让if语句类似于 if (i+512 < N && X >= A[i+512]) i += 512; 于 2009-06-19T13:37:09.217 回答 This answer is useful 0 这些人都说了什么。编译器将为您优化它。编写它，使其看起来和阅读正确，然后继续前进。 于 2009-06-19T12:00:57.740 回答 This answer is useful 0 最好的办法是调整 JVM 而不是代码——因为这是你的瓶颈。 尝试使用参数启动 jvm -server -XX:+AggressiveOpts。 于 2009-06-19T12:26:29.377 回答 This answer is useful 0 将你的相等测试移到while循环之外怎么样，所以你只在终止后检查.equals( )。顺便说一句，我找不到任何可以测试 l+1 <r 1="" 2="" 3="" 4="" 5="" 的方法。如果已知您的数组长度小于某些大小，那么如果您使用不同的数据类型作为索引呢？字符="" 短="" 字节？="" 于="" 2009-06-19t13:58:52.323="" 回答="" related="" c++="" -="" 我可以使用基于范围的="" for="" 循环轻松迭代地图的值吗？="" java="" hbackgroundimage="" 重绘="" objective-c="" 警告“使用="" gnu="" 语句表达式扩展”="" 我可以以编程方式从字节数组安装="" android="" 应用程序吗？="" php="" 拥有隐藏界面的更好方法="" javascript="" 使用="" ajax="" 请求下载文件数据="" ruby="" on="" rails="" logging="" 嵌入式模式下的="" neo4j="" 日志级别="" ruby-on-rails="" 创建或更新用户="" magento="" 如何在="" admin="" 的选项卡下添加第二个网格？="" ios="" 仅通过="" wifi="" 测试连接="" reference="" php × 1429865="" c="" c++ × 756500="" nginx × 49975="" mongodb × 159057="" mybatis × 3233="" anaconda × 13410="" pycharm × 14671="" python × 1902243="" vscode × 56040="" docker × 110988="" github × 49000="" flask × 49129="" ffmpeg × 24037="" jmeter × 16910="" matplotlib × 63493="" bootstrap × 54641<="" h1="">> ID：1017480
> 
> 赞同：1
> 
> 时间：
> 
> 标签：java, performance, integer

检查条件的最快方法是什么

```
l + 1 < r 
```

在`int l,r`Java中？

`l`并且`r`不是恒定的，我知道`l <= r`。`while`比较是二分查找实现中循环的停止条件。我当然会在单独的测试（搜索大型数组）和使用它的代码中对我的代码进行基准测试。

我想，我正在寻找的是某种比目前情况更快的位操作。但我不知道。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T11:45:03.327

这种微优化几乎总是一个坏主意；您的性能将完全取决于热点编译器如何优化您的代码，以及与周围代码有关的微妙缓存效果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T11:44:52.797

我认为这可能和它会得到的一样快。这将简化为非常简单的字节码，而 JIT（即时编译器）可能会将其简化为非常简单的本机实现。

（不相关：有趣的是看到“量化开发人员”使用 Java 顺便说一句。不经常发生）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T12:08:54.170

那么基础比较必须：

l 加 1，将结果与 r 进行比较

或者

从 r 中减去 1 并将结果与​​ l 进行比较

所有现代硬件对于任一操作都将具有相同的原始性能（其中任何本机数据类型的加法和减法在完成周期和流水线副作用方面具有相同的性能）。

这将产生任何影响的唯一方法是：

l 或 r 之一是编译时已知的常量。例如。

```
l + 1 < 5
5 + 1 < r 
```

在这种情况下，一个糟糕的优化编译器可能没有意识到它可以将第一个转换为`l < 4`

但是*所有*java编译器都需要发现第二种情况是`6 < r`

另一种是如果 l 和 r 的数据类型不同。

的操作：

1.  浮点加法/减法然后与整数
    比较
2.  积分加法/减法然后与双精度比较可能会有所不同。

可以公平地说，这在您的应用程序中成为严重问题的可能性可以忽略不计，因为与与决策相关的任何分支错误预测的管道命中相比，任何这些的周期成本都很小。

此外，一个体面的 JIT 可能会针对周围的代码进行各种优化，这些优化超过了所执行的微优化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T13:37:09.217

有一个`lr1`始终等于的变量`(l - r + 1)`。每当您增加或减少`l`时，对 . 执行相同的操作`lr1`。同样对于`r`。

然后您的测试变为`(lr1 < 0)`，并且修改指令`lr1`的执行频率不会超过必要。

我觉得给你一个微优化有点傻，在大多数情况下，这是一分钱一分货，一分钱一分货。就像你在比较字符串一样，它会完全淹没那个测试。

补充：既然你在做二进制搜索，我会提到 Jon Bentley 对二进制搜索的酷展开。首先，将表格填充`A`到 2 的幂，例如 1024。然后编写如下内容：

```
i = 0;
if (X >= A[i+512]) i += 512;
if (X >= A[i+256]) i += 256;
   . . .
if (X >= A[i+  1]) i +=   1; 
```

最后测试是否`(X == A[i])`。或者，如果您不想填充它，让`if`语句类似于
`if (i+512 < N && X >= A[i+512]) i += 512;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T12:00:57.740

这些人都说了什么。编译器将为您优化它。编写它，使其看起来和阅读正确，然后继续前进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T12:26:29.377

最好的办法是调整 JVM 而不是代码——因为这是你的瓶颈。

尝试使用参数启动 jvm `-server -XX:+AggressiveOpts`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T13:58:52.323

将你的相等测试移到while循环之外怎么样，所以你只在终止后检查*.equals( )。*顺便说一句，我找不到任何可以测试 l+1<r 的方法。如果已知您的数组长度小于某些大小，那么如果您使用不同的数据类型作为索引呢？字符/短/字节？</r>

# eclipse - Eclipse 集成中的 Qt 设计器插件（自定义小部件）

> ID：1017484
> 
> 赞同：3
> 
> 时间：2009-06-19T11:33:53.910
> 
> 标签：eclipse, plugins, qt4, designer

我制作了自定义小部件插件，它在 Qt 设计器中被识别和可见，但 Qt 创建者和 Qt eclipse 集成没有显示它。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-11T00:56:31.883

我要感谢提问者和两位响应者帮助我解决了这个问题（并且还诅咒诺基亚没有使这项工作开箱即用 - 我的 Qt 开发人员体验的前两天是谷歌搜索的答案）。

首先，创作者[确实在别处寻找](http://lists.trolltech.com/pipermail/qt-creator/2009-February/002020.html)- 在 Windows 中的 C:\Qt\bin\designer （在 Linux 中应该是 .../bin/designer - 执行 'find . -name libqwebview.so'）。

其次，在 Windows 上可能存在不兼容问题，因为[QtCreator 使用 mingw 编译插件，而 QtCreator 很可能使用 Visual Studio 编译](http://www.gnome-look.org/knowledgebase/?id=160&PHPSESSID=6)。修复方法是使用 mingw 编译 QtCreator。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T14:52:12.717

我的猜测是 Qt Creator 和 Qt Eclipse 集成使用不同版本的设计器。（我知道 Creator 就是这种情况。）由于他们使用不同的设计器应用程序，他们可能也在寻找与标准设计器程序不同的插件位置。我的第一个建议是尝试找到该位置的位置，然后将您的插件复制到那里。

如果复制的插件不起作用，则可能是其中一个或另一个的设计器版本有些不兼容。这将需要更多的研究，但可能会通过更多的研究来克服。

# java - 为什么将 {a, b, c} 传递给方法不起作用？

> ID：1017486
> 
> 赞同：9
> 
> 时间：2009-06-19T11:34:12.617
> 
> 标签：java, arrays, syntax, array-initialization

我试图将初始化列表 {...} 传递给构造函数，但它不起作用。当我改为在方法局部变量（int []）中声明它时，它完美地工作。

这是为什么？

```
public class QuickSort {
    int[] a;

    public QuickSort(int[] a) {
        this.a = a;
    }

    public static void main(String[] args) {
        // ###################
        // ###    WORKS     ##
        // ###################
        int[] a = {8,12,79,12,50,44,8,0,7,289,1};
        QuickSort sort = new QuickSort(a);

        // ###################
        // ### DOESN'T WORK ##
        // ###################
        //QuickSort sort = new QuickSort({8,12,79,12,50,44,8,0,7,289,1});
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-19T11:38:41.267

当声明`int[]`并分配`{1, 2, 3}`编译器时，编译器知道您想要创建一个`int[]`，因为它在那里被拼写出来。

在后一种情况下，您将数组直接粘贴到方法调用中，您必须使用

```
QuickSort sort = new QuickSort(new int[] {8,12,79,12,50,44,8,0,7,289,1}); 
```

告诉编译器你的数组是什么。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-19T11:51:20.210

该`{}`构造称为数组初始化器，它用于在 Java 中初始化数组。（参考：[Section 10.6: Array Initializers](http://java.sun.com/docs/books/jls/third_edition/html/arrays.html#10.6) from [The Java Language Specification, Third Edition](http://java.sun.com/docs/books/jls/third_edition/html/j3TOC.html)。）

传递`{1, 2, 3}`本身无效的原因是没有与初始化程序关联的类型信息。

因此，必须通过编写 让编译器知道数组的类型，`new Type[]`其中`Type`是数组所针对的类型。

以下是数组初始值设定项的所有有效用法：

*   `new String[] {"Hello, "World"}`
*   `new Character[] {'A', 'B'}`
*   `new Runnable[] {new Runnable() {public void run() {}}, new Runnable() {public void run() {}}`

可以看出，这种表示法可用于许多数据类型，因此它不是特定于整数的东西。

至于：

```
int[] a = {1, 2, 3}; 
```

以上之所以有效，是因为类型信息是在变量类型声明中提供给编译器的，在本例中为`int[]`. 上面的意思是：

```
int[] a = new int[] {1, 2, 3}; 
```

现在，如果我们有`new int[] {1, 2, 3}`，我们可以`int[]`就地创建一个新数组，这样就可以像处理任何其他`int[]`数组一样处理它——只是它没有与之关联的变量名。

因此，由 by 创建的数组`new int[] {1, 2, 3}`可以发送到以 a`int[]`作为参数的方法或构造函数中：

```
new Quicksort(new int[] {1, 2, 3});  // This will work. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T11:38:49.457

这可能是因为您的初始化列表没有输入信息。试试这个：

```
QuickSort sort = new QuickSort(new int[] {8,12,79,12,50,44,8,0,7,289,1}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T11:50:12.630

你也可以这样做：

```
public class QuickSort {
    int[] a;

    public QuickSort(int ... a) {
        this.a = a;
    }

    public static void main(String[] args) {

        QuickSort sort = new QuickSort(8,12,79,12,50,44,8,0,7,289,1);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T11:46:18.910

Java 并没有真正的类型推断。数组变量声明是 Java 语言规范中的一种[特殊情况](http://java.sun.com/docs/books/jls/third_edition/html/arrays.html#10.6)，不适用于方法参数。这样做是可能的，但会给规范增加很多复杂性，因为它必须处理诸如 {"a", "b"} 是否创建 String[] 或 Object[] 之类的问题 - 在这里看起来很明显，但是如果它是复杂类型层次结构中的对象呢？如果方法被重载并且两个版本都存在怎么办？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T11:56:54.880

花括号（在数组文字中使用时）只能在声明数组时使用:)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-19T11:37:49.940

在将列表传递给构造函数之前，您是否尝试过将列表转换为 int[] ？

# qt - Windows Mobile 上损坏的 Qt 小部件

> ID：1017488
> 
> 赞同：0
> 
> 时间：2009-06-19T11:34:42.740
> 
> 标签：qt, windows-mobile

我即将向 我正在工作的移动公司推荐[Qt 。](http://qt.nokia.com/)然而，事实证明，为桌面应用程序构建的 Qt 小部件不能在 Windows Mobile 6.0 上运行得那么好。它们要么不成比例地挤在屏幕上，要么将其扩展为看不到一半的应用程序。以下是一些屏幕截图：

应用程序窗口扩展屏幕：

[替代文字 http://img193.imageshack.us/img193/171/boxesp.jpg](http://img193.imageshack.us/img193/171/boxesp.jpg) [替代文字 http://img193.imageshack.us/img193/9187/wiggly.jpg](http://img193.imageshack.us/img193/9187/wiggly.jpg)

[并且它们被挤压，与预期](http://www.qtsoftware.com/developer/embedded-widget-demos)相反：

[替代文字 http://img221.imageshack.us/img221/4084/patient.jpg](http://img221.imageshack.us/img221/4084/patient.jpg)

所以，虽然我已经[完成了安装程序的每一步](http://doc.qt.nokia.com/4.5/install-wince.html)，但很明显，出了点问题。这种腐败的原因可能是什么？我不能只[编译一次并到处部署](http://doc.qt.nokia.com/4.5/developing-on-mac.html#deployment-compile-once-deploy-everywhere)吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T22:03:34.537

您的所有示例看起来都没有设置为全屏。这就解释了为什么它们不“适合屏幕”，因为窗口比显示器大。几乎所有窗口都在 windows mobile 上使用全屏模式，因为没有足够的空间容纳大量窗口。

最后一个示例看起来设置为全屏，但文本信息和图形元素对于屏幕尺寸来说太大了。

因此，总体而言，Qt 在桌面布局方面表现得最好。鉴于桌面分辨率和设备分辨率之间的大小差异，桌面顶部窗口布局几乎永远不会在小型设备屏幕上工作。因此，为桌面大小分辨率编写的 Qt 应用程序的任何移植都需要中继 GUI 并重做输入法，因为两者在桌面和移动设备之间存在很大差异。

您的“一次编译并随处部署”的想法没有意义。您提供的链接是处理 MAC OS 和 MAC OS 的版本。

我认为像 Qt 这样的跨平台 GUI 库的主要好处之一是可以在许多不同平台之间进行编译而无需更改的一组源代码。跨桌面平台是有意义的。在“种类”有意义的不同设备平台上，输入法在设备之间可能有很大不同，主要的 GUI 概念也可能有很大不同（例如，将 WM 设备与 iPhone 设备进行比较）。

所以认为 Qt 可以为你工作，但你必须：

1.  离开使用全屏模式。
2.  提供适合屏幕尺寸的布局和图形元素。

One problem you may have if you wish to support multiple devices, is supporting multiple screen sizes. Also supporting dynamically change screen sizes between protrait and landscape. These sorts of requirements are part of Mobile2Market [Certificate requirements](http://msdn.microsoft.com/en-us/windowsmobile/dd569132.aspx) and part of the new upcomming [Microsoft Mobile Marketplace](http://developer.windowsmobile.com/) (altho I can't find the like to the requirements).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T15:08:32.933

在做嵌入式 UI 时，有很多事情不能像桌面应用程序那样做。所以实际上，大部分 UI 不会一次编写，而是在任何地方运行。也就是说，您通常可以编写相同的代码，而只需使用适应嵌入式系统约束的不同 UI 文件。

另一方面，如果您在触摸屏上使用大量复选框，请准备好让人们抱怨它们难以切换。

# asp.net - 如何在 ASP.Net 中处理页面关闭？

> ID：1017492
> 
> 赞同：1
> 
> 时间：2009-06-19T11:36:24.750
> 
> 标签：asp.net

当用户从“浏览器关闭”关闭页面时，我想做一些事情。有没有办法在服务器端处理该事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T11:41:55.563

您可以添加一个窗口卸载处理程序，该处理程序对服务器执行一些 AJAX。不过，我不知道它在实践中有多可靠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T11:45:09.460

您可以尝试处理 javascript [OnUnload 事件](http://www.w3schools.com/jsref/jsref_onunload.asp)并调用[__dopostback() 函数](http://msdn.microsoft.com/en-us/library/aa720099(vs.71).aspx)进行客户端脚本回发。

为了澄清评论，它无论如何都不是一个万无一失的模式，但可能会有所帮助，具体取决于程序员正在尝试做什么。即使在服务器端检查和过滤回发，它也需要是一个不必*只运行一次*且*总是*运行的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T11:54:52.870

您还必须小心使用此事件的目的。如果用户通过任务管理器杀死浏览器，您是否需要触发它？当他注销时你需要它开火吗？

我认为，在大多数浏览器中，这两种情况都不会触发。

# session - 经典 ASP 会话 ID Cookie 生命周期

> ID：1017493
> 
> 赞同：4
> 
> 时间：2009-06-19T11:37:35.013
> 
> 标签：session, asp-classic

在我的经典 ASP 应用程序中，当客户端关闭浏览器时，与 ASP 会话 ID 相关的 cookie 会丢失，即使会话没有超时。所以...

**即使客户端关闭浏览器，如何使 ASP 会话 ID cookie 保持不变？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T11:53:25.947

当您启动一个新的浏览器会话并浏览到您的站点时，经典 ASP 会检测到没有 ASP 会话 cookie 并会为您创建一个新会话（正如您已经体验过的那样）。

会话 cookie 就是这样，它们在会话的整个生命周期内都存在。当您关闭浏览器时，会话 cookie 将被删除（即使您在服务器上的会话状态将作为孤立会话继续存在，直到 Session.Timeout 到期 - 除非您在 Session.Timeout 期间再次提供相同的会话 cookie）。

在新的浏览器会话/实例中延长 ASP 会话 cookie 的生命周期的唯一方法是使用浏览器/客户端上的脚本更改 cookie 的生命周期。

如果您希望跨浏览器关闭等事件管理状态，则需要实现自己的状态管理机制（例如将状态持久化到数据库）并使用具有较长生命周期（或具有滑动过期时间）的常规 cookie您在服务器端脚本中的每个请求上将生命周期延长一小段时间）以将状态与用户匹配。

**编辑：**

以下文章有一个修改会话 cookie 的脚本（向下滚动到 Cookie Expiration）：

*   [ASP Session Cookies (Plynt)](https://web.archive.org/web/20070504042700/http://palisade.plynt.com/issues/2007Feb/asp-session-cookies/)，来自archive.org

但正如 Shoban 正确指出的那样，存在[会话固定 (OWASP)](http://www.owasp.org/index.php/Session_Fixation)的风险。但是，您可以采取一些方法来保护自己免受这种情况的影响：

*   [会话固定保护 (OWASP)](http://www.owasp.org/index.php/Session_Fixation_Protection)

我还要添加一些警告，如果您的应用程序正在存储敏感数据（信用卡、财务、医疗等），那么我建议您不要这样做，并接受您的用户必须再次登录并开始新会话的事实. 安全总比后悔好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T11:52:41.707

您可以增加会话超时。

```
Session.Timeout[=nMinutes] 
```

[http://www.asp101.com/articles/john/sessionsend/default.asp](http://www.asp101.com/articles/john/sessionsend/default.asp)

```
 <%
    Response.Cookies("firstname")="Alex"
    Response.Cookies("firstname").Expires=#May 10,2012#
    %> 
```

这行不行？？

[http://www.w3schools.com/ASP/asp_cookies.asp](http://www.w3schools.com/ASP/asp_cookies.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T11:57:01.417

“会话 cookie”是线索：当用户关闭浏览器时，他们正在结束会话。

服务器超时的存在是因为服务器无法知道用户结束了会话，所以它的工作原理是如果他们一段时间不回来，会话必须结束。

如果你想要一个持久的cookie，你必须自己设置它；但是没有办法阻止用户结束他们的会话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T11:46:38.473

这不是设计的吗？

也许您想改用普通的cookie？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T11:53:27.820

您需要保留会话 cookie，因为出于安全原因，您无法访问浏览器之间的会话（无论是两个不同的浏览器，还是同一个关闭并重新打开的浏览器）。

通常，您将存储详细信息服务器端并使用包含简单 id 的客户端 cookie 来检索信息。

# asp.net - Independentsoft 生成 .msg 邮件在转发时丢失附件

> ID：1017494
> 
> 赞同：0
> 
> 时间：2009-06-19T11:37:49.007
> 
> 标签：asp.net, outlook, smtpclient, forwarding, independentsoft

老实说，我遇到了一个问题，我最初认为这不是编程问题，但在检查了所有其他领域后，如果这可能是一个问题，我将不胜感激。

我们有一个 ASP.NET Web 应用程序，可以向用户发送带有附件的电子邮件。发送后，消息将在 SharePoint 中保存为 .msg 文件。所有这些都正确且可靠地工作。

我们发现的问题是，当用户打开 .msg 文件（即从 SharePoint 下载）然后转发它时，附件会从电子邮件中脱落。附件在 .msg 文件中，可以打开和查看 - 问题仅在他们转发时出现（文档在他们按下时消失）。

用户正在使用 Outlook（各种版本）和 Internet Explorer。

我尝试了以下方法来消除非编程解释：

1.  转发实际发送的电子邮件 - 这有效（即保留附件）
2.  从 msg 文件中获取内容和附件，发送然后转发 - 这有效
3.  收下这封电子邮件，上传到 SharePoint，下载并转发 - 这行得通
4.  获取生成的 .msg 文件并保存在本地。打开并转发 - 这不起作用
5.  从 SharePoint 打开生成的 .msg 文件 - 这不起作用
6.  更改所有适当的信任/内联网设置 - 没有区别
7.  转发生成的 .msg - 收到文件时仍然丢失

使用标准 SmtpClient 功能发送电子邮件，我不认为*这应该是我需要解决的区域。我们正在使用名为 Independentsoft 的第三方组件来生成我们的 .msg 文件，我认为这很可能是我们需要帮助的领域。

摘录相当简单：

```
消息 mailMsg = new Message();
// 配置，设置电子邮件地址等...

foreach（msg.Documents 中的文档文档）
{
    附件附件 = new Attachment(doc.Path);
    mailMsg.Attachments.Add(附件);
}

```

任何可能导致这种情况的想法将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T14:44:55.210

这最终成为一个相当简单的解决方案。

在 Message 类上存在一个名为 MessageFlags 的集合。只需在需要时添加 MessageFlag.HasAttachment

# windows - 关于 Winsock Kernel Buffer 和 Nagle 算法的疑问

> ID：1017507
> 
> 赞同：3
> 
> 时间：2009-06-19T11:41:28.500
> 
> 标签：windows, winapi, winsock

读[这篇](http://support.microsoft.com/kb/214397)文章的时候，我有一个疑问。

我知道在传输小数据时，默认情况下会启用 Nagle 算法来合并小数据包。这导致在传输之前缓存一些数据。我相信 Winsock Kernel Buffer 是缓存发生的地方。如果我错了，请纠正我。

这是否意味着如果使用 SO_SNDBUF 选项将 Winsock 内核缓冲区设置为零，是否会禁用 Nagle 算法？

如果没有，那么 WINSOCK 将小数据缓存在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T11:58:52.083

您参考的知识库文章以这种方式给出了您的答案...

> 为了优化应用层的性能，**Winsock 将数据缓冲区从应用程序发送调用复制到 Winsock 内核缓冲区**。然后，堆栈使用它自己的启发式算法（例如 Nagle 算法）来确定何时将数据包实际放在线路上。

并且，设置 TCP_NODELAY 或 SO_SNDBUF=0 将禁用 Nagle 算法，如下所示，

> **TCP_NODELAY 套接字选项用于禁用 Nagle 算法**，以便将小数据包无延迟地传递到远程主机。
> 
> 您可以使用 SO_SNDBUF 选项更改分配给套接字的 Winsock 内核缓冲区的数量（默认为 8K）。如有必要，Winsock 可以缓冲远远超过 SO_SNDBUF 缓冲区大小。在大多数情况下，应用程序中的发送完成仅表示应用程序发送调用中的数据缓冲区被复制到 Winsock 内核缓冲区，并不表示数据已到达网络介质。唯一的例外是当**您通过将 SO_SNDBUF 设置为 0 来禁用 Winsock 缓冲**时。

* * *

阅读您在下面的评论，我意识到您可能会感到困惑，因为设置 TCP_NODELAY 或设置 SO_SNDBUF=0 似乎都在做同样的事情。如果是这种情况，请注意**Nagle 仅适用于 TCP 流**（将数据分段为数据包），而 SO_SNDBUF 也适用于 UDP 套接字。

将 SO_SNDBUF 设置为零显式地停止所有输出缓冲，并为套接字上的每个“写入”尝试立即分派（至少在正常套接字实现中）。

设置 TCP_NODELAY 将显式停止 TCP 套接字上的 Nagle 算法，尽管发送缓冲区可能可用并用于延迟调度（在向应用程序确认发送成功后）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-08T23:27:09.167

SO_SNDBUF 设置为 0 不会强制在线上立即发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-04T04:49:19.287

Setting SO_SNDBUF to zero will *not* implicitly disable nagle; the nagle state maintained by the WSK is independent of where the buffer is located. It's *your* responsibility to keep the buffers you post valid till the transport consumes it.

# ruby-on-rails - 使用回形针进行简单裁剪

> ID：1017509
> 
> 赞同：38
> 
> 时间：2009-06-19T11:42:23.490
> 
> 标签：ruby-on-rails, ruby, paperclip, crop

我想在上传时使用回形针裁剪图像，以便从原始图片的中心获得方形拇指。我在文档中找到了一种似乎完全符合我要求的方法：

[transformation_to(dst,crop = false)](http://dev.thoughtbot.com/paperclip/classes/Paperclip/Geometry.html)

问题是我不知道在哪里使用这种方法。在这里简单地传递一些东西作为参数会很棒：

```
  has_attached_file ：图片，
                    :styles => { :medium => "600x600>", :thumb => "这里有东西" }
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-06-19T11:57:05.550

您只需要使用 # 而不是 > 作为参数：

```
has_attached_file :picture, :styles => { :thumb => "200x200#" }
```

# c++ - 找不到 MSVCP80.dll（并排问题？）

> ID：1017510
> 
> 赞同：2
> 
> 时间：2009-06-19T11:42:31.633
> 
> 标签：c++, visual-studio-2005, msvcrt

当我尝试从 Visual Studio 2005 (SP1) 启动我的项目的发布版本时，我收到以下错误消息：

“此应用程序无法启动，因为未找到 MSVCP80.dll。重新安装应用程序可能会解决此问题”

当我查看发布版本的清单时，它指定了以下内容：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <dependency>
    <dependentAssembly>
      <assemblyIdentity type="win32" name="Microsoft.VC80.CRT" version="8.0.50727.762" processorArchitecture="x86" publicKeyToken="1fc8b3b9a1e18e3b"></assemblyIdentity>
    </dependentAssembly>
  </dependency>
</assembly> 
```

当我查看 Windows/WinSxS 文件夹时，我有以下版本的 CRT：

```
x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.1433_x-ww_5cf844d2
x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.163_x-ww_681e29fb
x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.3053_x-ww_b80fa8ca
x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.42_x-ww_0de06acd
x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.762_x-ww_6b128700 
```

所有这些文件夹都包含所需的 dll。在我的固定电脑上，使用完全相同版本的 Visual Studio，一切正常。

这是踢球者，在问题浮出水面之前，我设法在发布和调试中只启动了一次程序。debug-build 的输出显示 WinSxS 中的*DebugCRT* .762*-dll 是第一次加载的，但现在当我尝试启动程序时，它找不到这些 dll。

唯一的外部依赖是 ws2_32.lib。

我刚刚重新安装了笔记本电脑上的所有内容（Windows XP、Visual Studio、Service Pack 等），但无济于事。

如果我删除对 ws2_32.lib 的引用，程序就会启动。

请帮帮我，我要把我全新的笔记本电脑扔出窗外:(

亲切的问候

安德烈亚斯·布林克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T11:58:57.543

可能是注册表问题。执行建议并重新安装 MS CRT

[http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=200b2fd9-ae1a-4a14-984d-389c36f85647](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=200b2fd9-ae1a-4a14-984d-389c36f85647)

这是 VS 2005 SP1 中使用的版本。

还要检查你的VS安装，你应该也有这些dll

%程序文件%\Microsoft Visual Studio 8\VC\redist\x86\Microsoft.VC80.CRT

如果没有，您可以对 VS 2005 安装进行修复。

希望这可以帮助。

干杯，

佩里卡

# recommendation-engine - 为什么 Netflix Prize 如此具有挑战性？

> ID：1017512
> 
> 赞同：17
> 
> 时间：2009-06-19T11:43:59.633
> 
> 标签：recommendation-engine, netflix

刚刚阅读了[《连线》杂志上的最新文章](http://www.wired.com/epicenter/2009/06/1-million-netflix-prize-so-close-they-can-taste-it/)，我很好奇：Netflix 奖有什么挑战性？我的意思是最真诚的，我只是对比赛带来的困难感到好奇。大多数推荐引擎一般都很难改进吗？如果是这样，那是为什么？或者，Netflix 是否异常难以改进？如果是这种情况，Netflix 有什么特别之处，使它比亚马逊更具挑战性？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-07-30T18:52:37.807

推荐系统存在难以解决的问题：

*   [冷启动](http://en.wikipedia.org/wiki/Cold_start)- 在新系统或新用户中，没有足够的数据来为推荐创建准确的统计模型。
*   [评分偏差](http://en.wikipedia.org/wiki/Collaborative_filtering#Disadvantages)- 如果您根据用户评分进行推荐，那么评分的用户通常会根据他们的喜好调整结果。如果您是那种不喜欢额外评分步骤的人，那么具有相似品味的人可能也不喜欢评分，因此他们的意见会被排除在推荐之外。
*   未评级的项目不太可能被评级 - 如果您根据评级选择项目并因此对其进行评级，未评级的项目不太明显，并且很难获得影响推荐所需的评级。在另一个方向上，受欢迎的商品具有更高的知名度，被更频繁地评分，因此在推荐中发挥了更大的作用。
*   [时间偏差](http://research.yahoo.com/files/kdd-fp074-koren.pdf)- 用户的评分随时间变化。对于长期变化，您可以通过在建议中添加时间元素来进行补偿。短期变化更难修复。在[查克诺里斯](http://www.chucknorrisfacts.com/)马拉松之后，你可能更有可能给动作片打高分。第二天，在对《[钢木兰](http://www.imdb.com/title/tt0098384/)》大哭之后，你可能会暂时对动作片产生偏见。
*   不同的动机 - 在[基于项目的推荐系统中](http://www.grouplens.org/papers/pdf/www10_sarwar.pdf)，您为姨妈生日购买的针织书会歪曲您的推荐（如果您不花时间告诉系统不要使用它）。你可能会给一部糟糕的儿童电影打高分，因为你的孩子喜欢它。

总之，这使得推荐系统很难改进过去就好了。一个准确率达到 80% 的系统看起来不错，但 5 次中有 1 次是错误的。对于某些用户而言，这使他们遇到的麻烦超过了他们的价值。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T11:49:28.840

因为 NetFlix 已经有一个非常好的推荐引擎。如果他们知道如何轻松改进它，他们现在就会这样做。他们的整个商业模式是围绕向消费者交叉销售产品（电影）。推荐算法确实是他们业务的核心。效果越好，他们赚的钱就越多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T11:53:02.093

我想已经有一些关于这方面的文章，但我现在不知道它们在哪里，所以我将在这里解释一下。

当人们在亚马逊上购买书籍（例如）时，他们倾向于购买特定类型的书籍，因此很容易推荐其他相同类型的书籍。

对于电影，人们可能会做同样的事情，但是人们通常不会将自己局限于一种类型。人们可能会观看更多种类的电影：恐怖片、喜剧片、动作片、爱情片等。

如果您到目前为止只租过一部电影，并且那部电影是一部戏剧，那么从这些类型中预测您喜欢什么可能很难预测。

如果有人想出一个非常聪明的推荐引擎，Netflix 可以从中受益匪浅。我认为他们主要是在寻找一种可以仅根据一两部电影推荐内容的引擎。对 Netflix 知之甚少的新客户如果能尽早找到自己喜欢的电影而无需搜索，他们就有更好的机会留下来。

在我看来，他们已经拥有与亚马逊相当的推荐引擎。我认为他们正在寻求进一步增强它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T11:55:58.640

我和我的同事参加了它。我没有很强的人工智能背景，但是推荐引擎需要对现有的文献算法有一些深入的了解，比如 Gibbs 采样、K 方法、最近邻等。我们使用 Gibbs 采样，我可以说我们很烂:) 与 Netflix 已有的相比。

# mysql - 将2个mysql查询优化为1个

> ID：1017516
> 
> 赞同：0
> 
> 时间：2009-06-19T11:44:52.297
> 
> 标签：mysql

用户有**宠物**，宠物可能有**图片**一张图片可以设置为主图（mainpic=0 or mainpic=1）

我需要从 pets 表中获取所有宠物数据，并且我还需要 mainpic=1 或第一张图片的图片 id，如果图片表中没有图片，则为 null。即使它根本没有图片，我也需要获取宠物数据。

目前我使用 2 个查询来完成此操作：SELECT * FROM pets WHERE pets.userId='$userId' ORDER BY pets.created ASC LIMIT 5 ... 对于每个结果：SELECT id FROM pictures WHERE petId = '$petId' ORDER由 mainpic DESC 限制 1

我需要在一个查询中进行优化。

谢谢，哈姆雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T11:51:46.573

使用内连接省略不匹配的记录

```
select * 
from pets inner join pictures 
on pets.id = petId and mainpic=1
where userId=? 
order by pets.created ASC limit 5 
```

如果您只想在图片相关字段中为 null 但想要宠物信息（您的 Q 有点不清楚），则使用左连接

```
select * 
from pets left join pictures 
on pets.id = petId and mainpic=1
where userId=? 
order by pets.created ASC limit 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T11:51:16.730

试试这个：

```
SELECT * FROM pets
INNER JOIN pictures ON pictures.petid = pets.id AND pictures.mainpic = 1
WHERE pets.userid='$userid' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T11:51:53.343

```
SELECT *
FROM pets p
     LEFT OUTER JOIN (
        SELECT *
        FROM pictures pict
        WHERE pict.mainpic = 1
     ) pict ON pict.petid = p.petid
WHERE p.userid = '$userid' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T11:53:19.490

```
SELECT  (
        SELECT  id
        FROM    pictures pi
        WHERE   pi.petid = pe.petid
        ORDER BY
                mainpic DESC
        LIMIT 1
        )
FROM    pets pe 
```

# windows - 在 Windows 上重命名 DLL

> ID：1017536
> 
> 赞同：1
> 
> 时间：2009-06-19T11:50:28.607
> 
> 标签：windows, qt, dll, qt4

我正在使用 Visual Studio 2003 在 Windows 上构建应用程序。

我的应用程序链接到第 3 方库（Qt）。调用 lib`qtcore4.lib`和 dll `qtcore4.dll`。

我的应用程序是另一个基于 Qt 的应用程序的插件，它使用相同 qtcore4.dll 的不同版本。

不幸的是，我不能使用与主机应用程序相同版本的 Qt，所以我想如果我重命名我的 Qt 版本的 lib 和 DLL 是否可以工作，例如：

```
qtcore4_my.lib
qtcore4_my.dll 
```

我猜qtcore4.lib是指里面的qtcore4.dll。所以我不确定这是否会起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T12:08:14.780

您应该注意在同一应用程序中使用同一库的两个不同版本。

如果插件接口使用来自 QT 的类，那么您应该预料到潜在的令人讨厌的问题（如崩溃）。

最简单的方法是重新编译 qt 并配置构建过程以生成具有其他名称的 dll 和 lib 文件。

# asp.net-mvc - Web 部署项目输出中缺少母版页

> ID：1017537
> 
> 赞同：3
> 
> 时间：2009-06-19T11:50:35.470
> 
> 标签：asp.net-mvc, msbuild, web-deployment-project, msbuildcommunitytasks

在运行我们的部署项目时，我们似乎遇到了一个问题，当它编译时，它似乎错过了输出中的母版页。

有没有办法通过编辑 .wdproj 文件或通过其他方法“强制”项目包含 .master 文件？

此外，我一直在阅读[MSBuildTasks 社区](http://msbuildtasks.tigris.org/)项目，并遵循了一些[示例文档](http://weblogs.asp.net/pwelter34/archive/2005/12/05/432384.aspx)，但这似乎不起作用。该项目不会排除我选择的文件，并且似乎也不会进行压缩。有没有其他人尝试过这个可以提供反馈/指导的扩展？

提前谢谢了

**更新：**

我已经通过创建一个 Itemgroup 并做一个副本来解决这个问题。

```
<ItemGroup>
  <MasterFiles Include="$(SolutionDir)\MVC\Views\Shared\Templates\**\*.master" />
</ItemGroup>

<Target Name="AfterBuild">
  <Copy SourceFiles="@(MasterFiles)" DestinationFiles="$(OutputPath)\Views\Shared\Templates\%(RecursiveDir)%(Filename)%(Extension)" />
</Target> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T15:18:56.920

我注意到 Web 部署项目的一个问题是它假定您的 Web 应用程序已经构建。因此，您必须在调用 .wdproj 本身之前构建它。我不确定这是否是你的问题。

关于排除文件，您必须打开 .wdproj 文件，它只是一个[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)文件。要排除文件，请将它们添加到**ExcludeFromBuild**项。例如，要确保您的项目文件不包含在部署中，您可以添加如下语句：

```
<ItemGroup>
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)*.csproj"/>
    <!-- Below excludes svn folders -->
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)**\.svn\**\*"/>
</ItemGroup> 
```

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T10:55:01.367

我已经通过创建一个 Itemgroup 并做一个副本来解决这个问题。

```
<ItemGroup>
  <MasterFiles Include="$(SolutionDir)\MVC\Views\Shared\Templates\**\*.master" />
</ItemGroup>

<Target Name="AfterBuild">
  <Copy SourceFiles="@(MasterFiles)" DestinationFiles="$(OutputPath)\Views\Shared\Templates\%(RecursiveDir)%(Filename)%(Extension)" />
</Target> 
```

非常感谢

# c# - 关于如何将无模式消息框显示为工具提示的想法

> ID：1017550
> 
> 赞同：4
> 
> 时间：2009-06-19T11:54:39.987
> 
> 标签：c#, winforms, tooltip

每当用户将鼠标悬停在菜单项上时，我都需要显示一个无模式的消息框。我不能使用 messagebox.show(...) 因为它是一种模式。所以我所做的是创建一个单独的窗口表单并使用菜单项上的悬停事件显示表单。我有两个问题：

1）当窗口窗体显示菜单失去其可见性。
2) windows 窗体不会像工具提示那样出现在菜单项旁边。

关于如何自定义组件的工具提示以使其看起来和行为像 Windows 窗体的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T12:03:15.070

要回答您的第二个问题：

如果将`form.StartPosition`属性设置为，`FormStartPosition.Manual`则可以将表单定位在光标处（例如）：

```
form.StartPosition = FormStartPosition.Manual;
form.Location = new Point(Cursor.Position.X - 1, Cursor.Position.Y - 1); 
```

这也可能有助于解决您的第一个问题。

如果您希望表单的行为类似于工具提示，那么如果您添加以下事件处理程序代码，它可能会满足您的需求：

```
 private void Form_MouseLeave(object sender, EventArgs e)
    {
        // Only close if cursor actually outside the popup and not over a label
        if (Cursor.Position.X < Location.X || Cursor.Position.Y < Location.Y ||
            Cursor.Position.X > Location.X + Width - 1 || Cursor.Position.Y > Location.Y + Height - 1)
        {
            Close();
        }
    } 
```

这解释了`-1`设置表单位置。它确保光标在第一次显示时实际上位于表单上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T09:59:39.247

由于 Form 类只是原生窗口的包装，您可以使用以下代码段创建自己的弹出表单，它看起来几乎就像工具提示窗口：

```
public class PopupForm : Form
{
    private const int SWP_NOSIZE = 0x0001;
    private const int SWP_NOMOVE = 0x0002;
    private const int SWP_NOACTIVATE = 0x0010;

    private const int WS_POPUP = unchecked((int)0x80000000);
    private const int WS_BORDER = 0x00800000;

    private const int WS_EX_TOPMOST = 0x00000008;
    private const int WS_EX_NOACTIVATE = 0x08000000;

    private const int CS_DROPSHADOW = 0x00020000;

    private static readonly IntPtr HWND_TOPMOST = (IntPtr)(-1);

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags);

    public PopupForm()
    {
        InitializeComponent();
        SetStyle(ControlStyles.Selectable, false);
        Visible = false;
    }

    protected virtual void InitializeComponent()
    {
        FormBorderStyle = FormBorderStyle.None;
        StartPosition = FormStartPosition.Manual;
        ShowInTaskbar = false;
        BackColor = SystemColors.Info;

        // ...
    }

    protected override CreateParams CreateParams
    {
        get
        {
            CreateParams cp = base.CreateParams;
            cp.Style |= WS_POPUP;
            cp.Style |= WS_BORDER;
            cp.ExStyle |= WS_EX_TOPMOST | WS_EX_NOACTIVATE;
            //if (Microsoft.OS.IsWinXP && SystemInformation.IsDropShadowEnabled)
            //    cp.ClassStyle |= CS_DROPSHADOW;
            return cp;
        }
    }

    protected override bool ShowWithoutActivation
    {
        get { return true; }
    }

    public new void Show()
    {
        SetWindowPos(Handle, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOACTIVATE | SWP_NOSIZE | SWP_NOMOVE);    
        base.Show();
    }

    public void Show(Point p)
    {
        Location = p;
        Show();
    }
} 
```

使用外部代码中的 Show() 和 Hide() 方法控制此表单。

# .net - 处理 XMLHttpRequest .NET

> ID：1017552
> 
> 赞同：0
> 
> 时间：2009-06-19T11:54:48.207
> 
> 标签：.net, xmlhttprequest, handle

谁能告诉我如何检索我用 .NET 编写的 Web 服务上的数据。我已经通过 XML HTTP 请求发布了我的数据。数据已成功发布，因为它返回 readyState 为 4。但我不知道如何访问服务上的数据，以便我可以对这些数据进行操作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T11:58:24.953

您可能必须通过 ASHX 文件或 Web 服务以外的其他东西来处理它。.net 中的 Web 服务代码正在寻找特定的 SOAP 请求，除非找到，否则服务不会响应。

在 ASHX（或 aspx 等）中。您可以使用 Request.Form 来获取您需要的发布值。

如果您已经编写了服务，您可以以 ASHX 的形式为它制作一个“代理”。让 ASHX 文件从 XmlHTTPPost 中取出值，打开 Web 服务连接并将信息提交给 Web 服务，就像在正常的 Web 服务通信中一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:04:39.730

如果您通过 HTTP 发送 POX，那么您可能需要一种“处理程序”方法，它从 读取`context.Request.InputStream`并写入- 只需使用/之类的`context.Response.OutputStream`任何东西。`XDocument.Load``XmlDocument.Load`

# iphone - 如果 NSDictionary 对成对值有好处，那么对三元值有什么好处呢？

> ID：1017564
> 
> 赞同：6
> 
> 时间：2009-06-19T11:58:51.507
> 
> 标签：iphone, objective-c, nsarray, nsdictionary

NSDictionary 适用于键值对，当您拥有三个值时，哪种数据结构最适合？最好为这 3 个值创建一个类，然后让数组中的每个对象都包含该类的实例？

具体来说：数据结构，姑且称之为Person，我设想有3个值：(NSString)name, (int)age, (BOOL)isAlive

这些将保存在数组（？）中。重要的是既可以使用名称作为键，也可以使用从零开始的数字来引用整个块。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T12:07:32.690

如果您有一个键和两个值，您可能会为这两个值创建一个类并仍然使用字典。

如果您有两个键和一个值，您可能会使用嵌套字典 - 即键是第一个键而值是另一个字典的字典。嵌套字典的键将是第二个键，值将是您的实际值。

预计到达时间：

现在您已经澄清了您的问题 - 如果您需要通过键或整数索引访问您的集合，您仍然可以使用字典。

要按键获取项目，您可以执行以下操作：

```
[myDict objectForKey:@"joe"]; 
```

要按索引获取项目，您可以使用 allKeys 数组：

```
[myDict objectForKey:[[myDict allKeys] objectAtIndex:1]]; 
```

如果按索引获取人员的唯一目的是遍历整个集合，那么您最好考虑使用 keyEnumerator 方法来枚举循环中的键并使用这些键来查找值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T12:21:15.050

您可以使用关系数据库模型使用核心数据来表示更复杂的数据关系。

查看苹果的开发者网站以获取示例和文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T23:09:27.010

乍一看，这似乎无关紧要，但请查看这篇[Cocoa 绑定简介中](http://www.cocoadevcentral.com/articles/000080.php)的面向字典的结构。（CocoaDevCentral 和 Scott Stevenson 是 Cocoa 新开发人员的重要资源。）他使用的方法非常灵活，并且在以后易于更改。使用字典而不是 ivars 并不总是最好的解决方案，但它可能非常适合您的需求。

**注意：**和 Core Data 一样，Cocoa Bindings 也是一个非常复杂的话题。我建议只使用本教程的组织方面，而不是全力以赴地使用绑定。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T12:08:37.353

这取决于您是否尝试制作某种通用数据结构。如果“三个”事物是您的应用程序中的特定概念，那么您可能正在走向[域模型](http://en.wikipedia.org/wiki/Domain_model)- 在这种情况下，您可能明智地将这些值封装在一个类中。

如果您需要类似字典的功能 - [NSDictionary objectForKey:] 等 - 那么您仍然可以使用一个或多个字典作为将键值映射到类实例的索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T13:23:27.077

您需要查看 CoreData（如果您正在存储它）并为您的对象定义一个类。像 NSDictionary 这样的原生通用对象并不意味着存储构成像 Person 这样的复杂对象的复杂值。

```
Person *person = [[Person alloc] init];
person.firstName = @"blah";
person.age = 24;
person.isAlive = YES; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-19T12:03:05.897

这不是[二维](http://www.macdonald.egate.net/CompSci/harray2.html)数组的描述吗？

# visual-studio-2005 - 'align' : 无法识别的扩展属性

> ID：1017568
> 
> 赞同：0
> 
> 时间：2009-06-19T11:59:13.953
> 
> 标签：visual-studio-2005, wdk

我正在使用 vc 6 并赢得 ddk 3790.1830。

现在我已经安装了 Visual Studio 2005 并赢得了 ddk 6001.18002。

现在当我编译我的代码时，我得到“'align'：无法识别的扩展属性”

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T12:06:06.903

确保您没有使用 Visual Studio 编译器编译 DDK。您必须使用 DDK 的编译器。

# sharepoint - 在 SharePoint 中创建自定义 EditorPart

> ID：1017582
> 
> 赞同：0
> 
> 时间：2009-06-19T12:02:53.260
> 
> 标签：sharepoint, moss, web-parts

我使用以下文章作为在 SharePoint 中创建自定义 EditorPart 的指南

[http://blah.winsmarts.com/2006/05/19/writing-custom-editors-for-sharepoint-2007-and-aspnet-20-webparts.aspx](http://blah.winsmarts.com/2006/05/19/writing-custom-editors-for-sharepoint-2007-and-aspnet-20-webparts.aspx)

但是，当我实施此技术时，我无法将更改保存到我的自定义属性中。基本上，当使用“应用”或“保存”按钮时会调用 CreateChildControls 函数，这会创建我的内部控制变量的新实例，从而擦除用户所做的任何更改。

因此，当调用 ApplyChanges 函数时，所有控件都恢复为默认设置。

有人对此有什么建议吗？

谢谢

## 更新

我根本无法解决这个问题。但是我看这个我卡在同一点上，当 CreateChildCONtrols() 总是首先运行时，如何将任何内容保存回 ApplyChanges() 中的 Web 部件，从而用新实例替换我的 CheckBoxList，因此没有选定的项目。我在下面包含了完整的代码，希望我是一个彻头彻尾的傻瓜，并且解决方案是显而易见的。

```
Private Class CaseMatterInfoEditorPart
    Inherits EditorPart

    Protected WithEvents _propList As CheckBoxList

    Protected Overrides Sub CreateChildControls()

        _propList = New CheckBoxList
        _propList.EnableViewState = True
        _propList.AutoPostBack = True
        _propList.Width = New Unit("100%")

        LoadProperties()

        Me.Controls.Add(New LiteralControl("Please select the data items you wish to include:<br />"))
        Me.Controls.Add(_propList)

    End Sub

    Public Overrides Function ApplyChanges() As Boolean

        Dim part As CaseMatterInfoPart = CType(WebPartToEdit,  _
                                               CaseMatterInfoPart)

        If part IsNot Nothing Then
            GetSelectedDataValues()
        Else
            Return False
        End If

        Return True

    End Function

    Public Overrides Sub SyncChanges()

        EnsureChildControls()

        Dim part As CaseMatterInfoPart = CType(WebPartToEdit,  _
                                               CaseMatterInfoPart)

        If part IsNot Nothing Then

            If Not String.IsNullOrEmpty(part.DataValues) Then
                SetSelectedValues(part.DataValues)
            End If

        End If

    End Sub

    Private Function GetSelectedDataValues() As String

        Dim strReturn As String = ""

        For Each item As ListItem In _propList.Items

            If item.Selected Then
                strReturn &= item.Text & "|"
            End If

        Next

        If Not String.IsNullOrEmpty(strReturn) Then
            strReturn = strReturn.Remove(strReturn.Length - 1, 1)
        End If

        Return strReturn

    End Function

    Private Sub SetSelectedValues(ByVal Values As String)

        If Not String.IsNullOrEmpty(Values) And _
            _propList IsNot Nothing Then

            _propList.ClearSelection()

            Dim split() As String = Values.Split("|")

            For Each strValue As String In split

                For Each item As ListItem In _propList.Items

                    If item.Text = strValue Then
                        item.Selected = True
                    End If

                Next

            Next

        End If

    End Sub

    Private Sub LoadProperties()

        Dim file As New File
        Dim lstProperties As List(Of String) = GetStringPropertyNames(file.GetType)

        For Each strProperty As String In lstProperties

            _propList.Items.Add(strProperty)

        Next

    End Sub

    Private Function GetStringPropertyNames(ByVal Type As System.Type) As List(Of String)

        Dim props() As PropertyInfo = Type.GetProperties
        Dim propList As New List(Of String)

        For Each prop As PropertyInfo In props

            If prop.Name <> "Chronology" And _
                    prop.Name <> "Documents" And _
                    prop.Name <> "Milestones" And _
                    prop.Name <> "DiaryEntries" And _
                    prop.Name <> "FileLoadSuccesful" And _
                    prop.Name <> "FileLoadError" Then

                Dim boo As Boolean = False
                Dim bootype As Type = boo.GetType
                Dim dec As Decimal
                Dim decType As Type = dec.GetType

                If prop.PropertyType Is "".GetType Or _
                    prop.PropertyType Is Now.GetType Or _
                    prop.PropertyType Is bootype Or _
                    prop.PropertyType Is decType Then

                    propList.Add(prop.Name)

                Else

                    Dim listChildPropertyStrings As List(Of String) = GetStringPropertyNames(prop.PropertyType)

                    For Each strProp As String In listChildPropertyStrings

                        propList.Add(prop.Name & ": " & strProp)

                    Next

                End If

            End If

        Next

        Return propList

    End Function

End Class 
```

希望外面的人能看到我看不到的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T12:46:23.530

我通常以本文中的代码开始我的 EditorPart：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webparts.editorpart.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webparts.editorpart.aspx) 从来没有任何此类问题。

听起来您在 ASP.NET 中的控制流有问题，但如果没有代码，很难看出它是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:20:03.667

**ApplyChanges** () 方法用于获取自定义编辑器的内容并将它们应用到 webpart，而**SyncChanges** () 方法则相反，它获取之前存储在 webpart 中的属性并相应地更新编辑器。创建自定义编辑器时，您有责任为它们编写逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T12:58:03.317

如果我实际上已将从 GetSelectedDataValues() 返回的字符串保存到 Web 部件上的属性中，这将有所帮助...

实际代码应如下所示：

```
Public Overrides Function ApplyChanges() As Boolean        
    Dim part As CaseMatterInfoPart = CType(WebPartToEdit, CaseMatterInfoPart)        
    If part IsNot Nothing Then            
        part.DataValues = GetSelectedDataValues()        
    Else            
        Return False        
    End If        
    Return True    
End Function 
```

经常检查、仔细检查和三次检查你在做什么是值得的。我对这个问题的复杂性感到很认真，正在寻找一个让我眼前一亮的答案。

# web-applications - Servlet 或 POJO 使 Web 应用程序宕机

> ID：1017591
> 
> 赞同：0
> 
> 时间：2009-06-19T12:04:24.177
> 
> 标签：web-applications, tomcat, servlets, jboss

有人可以告诉如何在初始化时遇到严重错误时停止 Web 应用程序，例如缺少会影响整个应用程序的重要属性，我想停止 Web 应用程序，如果 system.exit 不是一个好的选择，任何人都可以点如何关闭应用程序。

请不要告诉我记录错误、发送电子邮件、在欢迎中显示错误消息等。我想知道在 servlet 中是否有一种方法可以阻止 Web 应用程序加载和关闭应用程序。

谢谢。桑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T12:09:13.700

您的 servlet`init()`方法应该抛出一个`ServletException`. 这将向 servlet 容器指示 servlet 未能正确初始化，不应使用。

因此，您的应用程序将不可用。但是，这意味着托管在您的容器中的其他应用程序仍然可用。

请注意[这个问题](https://stackoverflow.com/questions/546097/calling-system-exit-in-servlets-destroy-method)。`System.exit()`从Tomcat内部调用。它可能会提供一些额外的信息。

# javascript - Google Maps GDirections - 在 IE7 中不居中/缩放

> ID：1017592
> 
> 赞同：2
> 
> 时间：2009-06-19T12:04:39.030
> 
> 标签：javascript, api, google-maps

描述此问题的最佳方法是使用链接。请访问此页面：[Ruby International | APOAds.com](http://www.apoads.com/Yokota/Biz/Show/Ruby%20International)

在 Firefox 中，一切正常。在 IE 中，它会加载方向，但不会以它们为中心。也许它只是我的电脑，它在 IE 下可以在你的电脑上工作吗？

**这是 javascript 首当其冲的工作：**

```
$(function() {
    // panorama of business
    var biz = new GLatLng(35.796532,139.406645);
    panoramaOptions = { latlng:biz };
    myPano = new GStreetviewPanorama($("div#geoMap").get(0), panoramaOptions);

    // get map for directions
    var dirMap = new GMap2($("div#dirMap").get(0));
    dirMap.setCenter(new GLatLng(35.740066,139.347582), 12);
    dirMap.setUIToDefault();

    // load directions
    directions = new GDirections(dirMap, $("div#dirMapText").get(0));
    directions.load("from: Yokota@35.740066,139.347582 to: Ruby International@35.796532,139.406645");

    $("#tabs").tabs({ cookie: { expires: 30 } });
}); 
```

非常感谢任何帮助。(人)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T14:38:07.767

**更新：**您在初始化选项卡之前调用了您的路线功能 - 但是当路线请求返回浏览器时，选项卡已经初始化并且请求在 IE 中被弄乱了。您可以使用[此处的第二个建议](http://jqueryui.com/demos/tabs/#...my_slider.2C_Google_Map.2C_sIFR_etc._not_work_when_placed_in_a_hidden_.28inactive.29_tab.3F)来修复它- 设置一个侦听器以在单击选项卡时调用您的方向功能。

```
$('#tabs').bind('tabsshow', function(event, ui) {
    if (ui.panel.id == "tabs-5") {
        directions = new GDirections(dirMap, $("div#dirMapText").get(0));
        directions.load("from: Yokota@35.740066,139.347582 to: Ruby International@35.796532,139.406645");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:25:13.450

奇怪的问题，但你试过`setCenter`最后打电话吗？

# java - 从 java 提交 HTML 表单需要 cookie 和弹出窗口阻止程序

> ID：1017595
> 
> 赞同：1
> 
> 时间：2009-06-19T12:05:07.063
> 
> 标签：java, html

我正在使用 POST 从 Java 应用程序向基于 Web 的登录服务器提交表单。

但是，该网页需要 cookie 和弹出窗口阻止程序，它们在 init() javascript 函数中被检测和处理：

```
if (document.cookie == "") {
        alert("Cookies are disabled. Cannot access server with this setting.\nPlease configure your browser to accept cookies.");
        return;
    }

detectPopupBlockers(); 
```

cookie 似乎只在 detectPopupBlockers() 函数中使用过（如果用户没有启用弹出窗口阻止程序，则表明一条消息已经显示）。

有没有办法可以完全避免 onload 参数调用的 init() 函数？或者以某种方式模拟实际上启用了 cookie 和弹出窗口阻止程序？我对第三种选择的唯一猜测是以某种方式关闭弹出消息，告诉我我没有 cookie 并提交表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T12:11:23.073

我假设您正在使用 WebClient 之类的东西进行发布 - 您不能禁用 Javascript 并完全绕过检查吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T12:08:15.917

如果它像这样绑定：

```
<body onload="init();"> 
```

或者像这样：

```
document.body.onload = init; 
```

你可以这样做：

```
document.body.onload = null; 
```

直接在body标签下。

# sql-server - SQL Server“分组依据”连接查询

> ID：1017598
> 
> 赞同：1
> 
> 时间：2009-06-19T12:06:13.847
> 
> 标签：sql-server, sql-server-2005, tsql

我需要使用与这些类似的表（实际的简化版本）进行“运行一次”查询（因此性能不是那么关键）：

```
CREATE TABLE #Items
(    ItemPK               int            not null  primary key
    ,ItemDescription      varchar(25)    not null
)

INSERT INTO #Items VALUES (1,'rock')
INSERT INTO #Items VALUES (2,'wood')
INSERT INTO #Items VALUES (3,'plastic')

CREATE TABLE #ItemTypes
(    ItemType             char(1)        not null   primary key
    ,ItemTypeDescription  varchar(25)    not null
)

INSERT INTO #ItemTypes VALUES ('A','Type A')
INSERT INTO #ItemTypes VALUES ('B','BBBBB')
INSERT INTO #ItemTypes VALUES ('C','Color')

CREATE TABLE #ItemInfo
(    InfoPK               int            not null   primary key   identity(1,1)
    ,ItemPK               int            not null   foreign key references #ListOfItems.ItemPK
    ,ItemType             char(1)        not null   foreign key references #ItemTypes.ItemType
    ,ItemValue            varchar(10)    not null
)

INSERT INTO #ItemInfo VALUES (1,'A','hard')
INSERT INTO #ItemInfo VALUES (1,'A','natural')
INSERT INTO #ItemInfo VALUES (1,'B','cold')
INSERT INTO #ItemInfo VALUES (1,'C','gray')
INSERT INTO #ItemInfo VALUES (2,'B','grain')
INSERT INTO #ItemInfo VALUES (2,'B','brown')
INSERT INTO #ItemInfo VALUES (3,'A','flexible')
INSERT INTO #ItemInfo VALUES (3,'A','colorful')
INSERT INTO #ItemInfo VALUES (3,'A','unnatural')
INSERT INTO #ItemInfo VALUES (3,'C','waterproof') 
```

您将收到有关 FK 和临时表的警告；我只是为了清楚起见。您可以删除“#”来制作永久表格...

当我运行此查询时：

```
SELECT
    i.ItemDescription
        ,t.ItemTypeDescription
        ,o.ItemValue
    FROM #Items                    i
        LEFT OUTER JOIN #ItemInfo  o ON i.ItemPK=o.ItemPk
        LEFT OUTER JOIN #ItemTypes t ON o.ItemType=t.ItemType 
```

我得到这个输出：

```
ItemDescription           ItemTypeDescription       ItemValue
------------------------- ------------------------- ----------
rock                      Type A                    hard
rock                      Type A                    natural
rock                      BBBBB                     cold
rock                      Color                     gray
wood                      BBBBB                     grain
wood                      BBBBB                     brown
plastic                   Type A                    flexible
plastic                   Type A                    colorful
plastic                   Type A                    unnatural
plastic                   Color                     waterproof 
```

但是，我需要如下输出：

```
ItemDescription           CombinedDescription
------------------------- -----------------------------------------------
rock                      Type A: hard, natural; BBBBB: cold; Color: gray
wood                      BBBBB: grain, brown
plastic                   Type A: flexible, colorful, unnatural; Color: waterproof

(3 row(s) affected) 
```

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:12:08.000

Anith Sen 在这篇文章中总结了 SQL Server 中聚合字符串连接的各种选项：[http ://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact- sql/](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

通常最好的选择是 XML PATH 技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:39:54.673

使用 XML 技巧，应该这样做：

```
SELECT      i.ItemDescription,
            (SELECT x.ItemTypeDescription + ': ' + x.vals + 
                CASE WHEN (ROW_NUMBER() OVER (ORDER BY x.ItemType DESC) = 1) THEN '' ELSE '; ' END
                FROM  ( SELECT  DISTINCT
                                ii.ItemPK,
                                t.ItemTypeDescription,
                                ii.ItemType,
                        (SELECT         x.ItemValue + 
                                        CASE WHEN (ROW_NUMBER() OVER (ORDER BY x.ItemValue DESC) = 1) THEN '' ELSE ', ' END
                            FROM        #ItemInfo x
                            WHERE       x.ItemPK = ii.ItemPK
                                    AND x.ItemType = ii.ItemType
                            ORDER BY    x.ItemValue
                            FOR XML PATH('')
                        ) AS VALS
                FROM    #ItemInfo ii
                JOIN    #ItemTypes t
                    ON  ii.ItemType = t.ItemType
                ) x
                WHERE       x.ItemPK = i.ItemPK
                ORDER BY    x.ItemType
                FOR XML PATH('')
            ) AS CombinedDescription

FROM        #Items i 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:45:04.487

您可以编写一个标量值函数，其中包含一个执行连接的子查询，或者您可以尝试合并，[例如这里](http://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string)

# php - 如何从 PHP 字符串中的字符中删除重音符号？

> ID：1017599
> 
> 赞同：104
> 
> 时间：2009-06-19T12:06:48.853
> 
> 标签：php, iconv

作为使字符串在 URL 中可用的第一步，我试图从 PHP 字符串中的字符中删除重音符号。

我正在使用以下代码：

```
$input = "Fóø Bår";

setlocale(LC_ALL, "en_US.utf8");
$output = iconv("utf-8", "ascii//TRANSLIT", $input);

print($output); 
```

我期望的输出是这样的：

```
F'oo Bar 
```

但是，重音字符不会被音译，而是用问号代替：

```
F?? B?r 
```

我可以在网上找到的所有内容都表明设置区域设置将解决此问题，但是我已经在这样做了。我已经检查了以下详细信息：

1.  服务器支持我设置的语言环境（包含在由 生成的列表中`locale -a`）
2.  服务器的 iconv 版本支持源和目标编码（UTF-8 和 ASCII）（包含在由 生成的列表中`iconv -l`）
3.  输入字符串是 UTF-8 编码的（使用 PHP 的`mb_check_encoding`函数验证，如[mercator 的回答](https://stackoverflow.com/questions/1017599/how-do-i-remove-accents-from-characters-in-a-php-string/1018160#1018160)中所建议的）
4.  调用`setlocale`成功（它返回`'en_US.utf8'`而不是`FALSE`）

* * *

## 问题的原因：

服务器使用了错误的 iconv 实现。它具有**glibc**版本而不是所需的**libiconv**版本。

> 请注意，某些系统上的 iconv 功能可能无法按预期工作。在这种情况下，最好安装 GNU libiconv 库。它很可能最终会得到更一致的结果。
> *– [PHP手册对iconv的介绍](http://www.php.net/manual/en/intro.iconv.php)*

PHP 使用的 iconv 实现的详细信息包含在`phpinfo`函数的输出中。

（我无法在我正在为此项目使用的服务器上使用正确的 iconv 库重新编译 PHP，所以我在下面接受的答案是在没有 iconv 支持的情况下删除重音最有用的答案。）

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-05-28T21:46:20.623

[WordPress](https://github.com/WordPress/WordPress/blob/a2693fd8602e3263b5925b9d799ddd577202167d/wp-includes/formatting.php#L1528)的实现呢？

```
function remove_accents($string) {
    if ( !preg_match('/[\x80-\xff]/', $string) )
        return $string;

    $chars = array(
    // Decompositions for Latin-1 Supplement
    chr(195).chr(128) => 'A', chr(195).chr(129) => 'A',
    chr(195).chr(130) => 'A', chr(195).chr(131) => 'A',
    chr(195).chr(132) => 'A', chr(195).chr(133) => 'A',
    chr(195).chr(135) => 'C', chr(195).chr(136) => 'E',
    chr(195).chr(137) => 'E', chr(195).chr(138) => 'E',
    chr(195).chr(139) => 'E', chr(195).chr(140) => 'I',
    chr(195).chr(141) => 'I', chr(195).chr(142) => 'I',
    chr(195).chr(143) => 'I', chr(195).chr(145) => 'N',
    chr(195).chr(146) => 'O', chr(195).chr(147) => 'O',
    chr(195).chr(148) => 'O', chr(195).chr(149) => 'O',
    chr(195).chr(150) => 'O', chr(195).chr(153) => 'U',
    chr(195).chr(154) => 'U', chr(195).chr(155) => 'U',
    chr(195).chr(156) => 'U', chr(195).chr(157) => 'Y',
    chr(195).chr(159) => 's', chr(195).chr(160) => 'a',
    chr(195).chr(161) => 'a', chr(195).chr(162) => 'a',
    chr(195).chr(163) => 'a', chr(195).chr(164) => 'a',
    chr(195).chr(165) => 'a', chr(195).chr(167) => 'c',
    chr(195).chr(168) => 'e', chr(195).chr(169) => 'e',
    chr(195).chr(170) => 'e', chr(195).chr(171) => 'e',
    chr(195).chr(172) => 'i', chr(195).chr(173) => 'i',
    chr(195).chr(174) => 'i', chr(195).chr(175) => 'i',
    chr(195).chr(177) => 'n', chr(195).chr(178) => 'o',
    chr(195).chr(179) => 'o', chr(195).chr(180) => 'o',
    chr(195).chr(181) => 'o', chr(195).chr(182) => 'o',
    chr(195).chr(182) => 'o', chr(195).chr(185) => 'u',
    chr(195).chr(186) => 'u', chr(195).chr(187) => 'u',
    chr(195).chr(188) => 'u', chr(195).chr(189) => 'y',
    chr(195).chr(191) => 'y',
    // Decompositions for Latin Extended-A
    chr(196).chr(128) => 'A', chr(196).chr(129) => 'a',
    chr(196).chr(130) => 'A', chr(196).chr(131) => 'a',
    chr(196).chr(132) => 'A', chr(196).chr(133) => 'a',
    chr(196).chr(134) => 'C', chr(196).chr(135) => 'c',
    chr(196).chr(136) => 'C', chr(196).chr(137) => 'c',
    chr(196).chr(138) => 'C', chr(196).chr(139) => 'c',
    chr(196).chr(140) => 'C', chr(196).chr(141) => 'c',
    chr(196).chr(142) => 'D', chr(196).chr(143) => 'd',
    chr(196).chr(144) => 'D', chr(196).chr(145) => 'd',
    chr(196).chr(146) => 'E', chr(196).chr(147) => 'e',
    chr(196).chr(148) => 'E', chr(196).chr(149) => 'e',
    chr(196).chr(150) => 'E', chr(196).chr(151) => 'e',
    chr(196).chr(152) => 'E', chr(196).chr(153) => 'e',
    chr(196).chr(154) => 'E', chr(196).chr(155) => 'e',
    chr(196).chr(156) => 'G', chr(196).chr(157) => 'g',
    chr(196).chr(158) => 'G', chr(196).chr(159) => 'g',
    chr(196).chr(160) => 'G', chr(196).chr(161) => 'g',
    chr(196).chr(162) => 'G', chr(196).chr(163) => 'g',
    chr(196).chr(164) => 'H', chr(196).chr(165) => 'h',
    chr(196).chr(166) => 'H', chr(196).chr(167) => 'h',
    chr(196).chr(168) => 'I', chr(196).chr(169) => 'i',
    chr(196).chr(170) => 'I', chr(196).chr(171) => 'i',
    chr(196).chr(172) => 'I', chr(196).chr(173) => 'i',
    chr(196).chr(174) => 'I', chr(196).chr(175) => 'i',
    chr(196).chr(176) => 'I', chr(196).chr(177) => 'i',
    chr(196).chr(178) => 'IJ',chr(196).chr(179) => 'ij',
    chr(196).chr(180) => 'J', chr(196).chr(181) => 'j',
    chr(196).chr(182) => 'K', chr(196).chr(183) => 'k',
    chr(196).chr(184) => 'k', chr(196).chr(185) => 'L',
    chr(196).chr(186) => 'l', chr(196).chr(187) => 'L',
    chr(196).chr(188) => 'l', chr(196).chr(189) => 'L',
    chr(196).chr(190) => 'l', chr(196).chr(191) => 'L',
    chr(197).chr(128) => 'l', chr(197).chr(129) => 'L',
    chr(197).chr(130) => 'l', chr(197).chr(131) => 'N',
    chr(197).chr(132) => 'n', chr(197).chr(133) => 'N',
    chr(197).chr(134) => 'n', chr(197).chr(135) => 'N',
    chr(197).chr(136) => 'n', chr(197).chr(137) => 'N',
    chr(197).chr(138) => 'n', chr(197).chr(139) => 'N',
    chr(197).chr(140) => 'O', chr(197).chr(141) => 'o',
    chr(197).chr(142) => 'O', chr(197).chr(143) => 'o',
    chr(197).chr(144) => 'O', chr(197).chr(145) => 'o',
    chr(197).chr(146) => 'OE',chr(197).chr(147) => 'oe',
    chr(197).chr(148) => 'R',chr(197).chr(149) => 'r',
    chr(197).chr(150) => 'R',chr(197).chr(151) => 'r',
    chr(197).chr(152) => 'R',chr(197).chr(153) => 'r',
    chr(197).chr(154) => 'S',chr(197).chr(155) => 's',
    chr(197).chr(156) => 'S',chr(197).chr(157) => 's',
    chr(197).chr(158) => 'S',chr(197).chr(159) => 's',
    chr(197).chr(160) => 'S', chr(197).chr(161) => 's',
    chr(197).chr(162) => 'T', chr(197).chr(163) => 't',
    chr(197).chr(164) => 'T', chr(197).chr(165) => 't',
    chr(197).chr(166) => 'T', chr(197).chr(167) => 't',
    chr(197).chr(168) => 'U', chr(197).chr(169) => 'u',
    chr(197).chr(170) => 'U', chr(197).chr(171) => 'u',
    chr(197).chr(172) => 'U', chr(197).chr(173) => 'u',
    chr(197).chr(174) => 'U', chr(197).chr(175) => 'u',
    chr(197).chr(176) => 'U', chr(197).chr(177) => 'u',
    chr(197).chr(178) => 'U', chr(197).chr(179) => 'u',
    chr(197).chr(180) => 'W', chr(197).chr(181) => 'w',
    chr(197).chr(182) => 'Y', chr(197).chr(183) => 'y',
    chr(197).chr(184) => 'Y', chr(197).chr(185) => 'Z',
    chr(197).chr(186) => 'z', chr(197).chr(187) => 'Z',
    chr(197).chr(188) => 'z', chr(197).chr(189) => 'Z',
    chr(197).chr(190) => 'z', chr(197).chr(191) => 's'
    );

    $string = strtr($string, $chars);

    return $string;
} 
```

要了解此函数的作用，请查看转换表：

```
À => A
Á => A
Â => A
Ã => A
Ä => A
Å => A
Ç => C
È => E
É => E
Ê => E
Ë => E
Ì => I
Í => I
Î => I
Ï => I
Ñ => N
Ò => O
Ó => O
Ô => O
Õ => O
Ö => O
Ù => U
Ú => U
Û => U
Ü => U
Ý => Y
ß => s
à => a
á => a
â => a
ã => a
ä => a
å => a
ç => c
è => e
é => e
ê => e
ë => e
ì => i
í => i
î => i
ï => i
ñ => n
ò => o
ó => o
ô => o
õ => o
ö => o
ù => u
ú => u
û => u
ü => u
ý => y
ÿ => y
Ā => A
ā => a
Ă => A
ă => a
Ą => A
ą => a
Ć => C
ć => c
Ĉ => C
ĉ => c
Ċ => C
ċ => c
Č => C
č => c
Ď => D
ď => d
Đ => D
đ => d
Ē => E
ē => e
Ĕ => E
ĕ => e
Ė => E
ė => e
Ę => E
ę => e
Ě => E
ě => e
Ĝ => G
ĝ => g
Ğ => G
ğ => g
Ġ => G
ġ => g
Ģ => G
ģ => g
Ĥ => H
ĥ => h
Ħ => H
ħ => h
Ĩ => I
ĩ => i
Ī => I
ī => i
Ĭ => I
ĭ => i
Į => I
į => i
İ => I
ı => i
Ĳ => IJ
ĳ => ij
Ĵ => J
ĵ => j
Ķ => K
ķ => k
ĸ => k
Ĺ => L
ĺ => l
Ļ => L
ļ => l
Ľ => L
ľ => l
Ŀ => L
ŀ => l
Ł => L
ł => l
Ń => N
ń => n
Ņ => N
ņ => n
Ň => N
ň => n
ŉ => N
Ŋ => n
ŋ => N
Ō => O
ō => o
Ŏ => O
ŏ => o
Ő => O
ő => o
Œ => OE
œ => oe
Ŕ => R
ŕ => r
Ŗ => R
ŗ => r
Ř => R
ř => r
Ś => S
ś => s
Ŝ => S
ŝ => s
Ş => S
ş => s
Š => S
š => s
Ţ => T
ţ => t
Ť => T
ť => t
Ŧ => T
ŧ => t
Ũ => U
ũ => u
Ū => U
ū => u
Ŭ => U
ŭ => u
Ů => U
ů => u
Ű => U
ű => u
Ų => U
ų => u
Ŵ => W
ŵ => w
Ŷ => Y
ŷ => y
Ÿ => Y
Ź => Z
ź => z
Ż => Z
ż => z
Ž => Z
ž => z
ſ => s 
```

您可以通过简单地遍历`$chars`函数数组来自己生成转换表：

```
foreach($chars as $k=>$v) {
   printf("%s -> %s", $k, $v);
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2011-06-22T17:16:25.213

这是我发现并经常使用的一段代码：

```
function stripAccents($stripAccents){
  return strtr($stripAccents,'àáâãäçèéêëìíîïñòóôõöùúûüýÿÀÁÂÃÄÇÈÉÊËÌÍÎÏÑÒÓÔÕÖÙÚÛÜÝ','aaaaaceeeeiiiinooooouuuuyyAAAAACEEEEIIIINOOOOOUUUUY');
} 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2012-07-31T15:45:24.483

Gino 上面发布的简单函数的 UTF-8 友好版本：

```
function stripAccents($str) {
    return strtr(utf8_decode($str), utf8_decode('àáâãäçèéêëìíîïñòóôõöùúûüýÿÀÁÂÃÄÇÈÉÊËÌÍÎÏÑÒÓÔÕÖÙÚÛÜÝ'), 'aaaaaceeeeiiiinooooouuuuyyAAAAACEEEEIIIINOOOOOUUUUY');
} 
```

不得不这样做，因为我的 php 文档是 UTF-8 编码的。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2016-02-03T13:04:20.903

如果您有[http://php.net/manual/en/book.intl.php](http://php.net/manual/en/book.intl.php)可用，这解决了您的问题

```
$string = "Fóø Bår";
$transliterator = Transliterator::createFromRules(':: Any-Latin; :: Latin-ASCII; :: NFD; :: [:Nonspacing Mark:] Remove; :: Lower(); :: NFC;', Transliterator::FORWARD);
echo $normalized = $transliterator->transliterate($string); 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2014-08-20T21:05:01.613

最简单的方法是使用`iconv()`PHP 原生函数。

```
 echo iconv('UTF-8', 'ASCII//TRANSLIT//IGNORE', "Thîs îs à vêry wrong séntènce!");

 // output: This is a very wrong sentence! 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2011-04-30T05:58:50.583

使用时`iconv`，必须设置参数 locale：

```
function test_enc($text = 'ěščřžýáíé ĚŠČŘŽÝÁÍÉ fóø bår FÓØ BÅR æ')
{
    echo '<tt>';
    echo iconv('utf8', 'ascii//TRANSLIT', $text);
    echo '</tt><br/>';
} 

test_enc();
setlocale(LC_ALL, 'cs_CZ.utf8');
test_enc();
setlocale(LC_ALL, 'en_US.utf8');
test_enc(); 
```

产生：

```
????????? ????????? f?? b?r F?? B?R ae
escrzyaie ESCRZYAIE fo? bar FO? BAR ae
escrzyaie ESCRZYAIE fo? bar FO? BAR ae 
```

另一个语言环境，然后是 cs_CZ 和 en_US 我还没有安装，我无法测试它。

在 C# 中，我看到了使用转换为 unicode 规范化形式的解决方案 - 重音被拆分出来，然后通过非间距 unicode 类别进行过滤。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2012-10-09T20:01:39.930

确实是口味问题。转换此类字母的方式有很多种。

```
function replaceAccents($str)
{
  $a = array('À', 'Á', 'Â', 'Ã', 'Ä', 'Å', 'Æ', 'Ç', 'È', 'É', 'Ê', 'Ë', 'Ì', 'Í', 'Î', 'Ï', 'Ð', 'Ñ', 'Ò', 'Ó', 'Ô', 'Õ', 'Ö', 'Ø', 'Ù', 'Ú', 'Û', 'Ü', 'Ý', 'ß', 'à', 'á', 'â', 'ã', 'ä', 'å', 'æ', 'ç', 'è', 'é', 'ê', 'ë', 'ì', 'í', 'î', 'ï', 'ñ', 'ò', 'ó', 'ô', 'õ', 'ö', 'ø', 'ù', 'ú', 'û', 'ü', 'ý', 'ÿ', 'Ā', 'ā', 'Ă', 'ă', 'Ą', 'ą', 'Ć', 'ć', 'Ĉ', 'ĉ', 'Ċ', 'ċ', 'Č', 'č', 'Ď', 'ď', 'Đ', 'đ', 'Ē', 'ē', 'Ĕ', 'ĕ', 'Ė', 'ė', 'Ę', 'ę', 'Ě', 'ě', 'Ĝ', 'ĝ', 'Ğ', 'ğ', 'Ġ', 'ġ', 'Ģ', 'ģ', 'Ĥ', 'ĥ', 'Ħ', 'ħ', 'Ĩ', 'ĩ', 'Ī', 'ī', 'Ĭ', 'ĭ', 'Į', 'į', 'İ', 'ı', 'Ĳ', 'ĳ', 'Ĵ', 'ĵ', 'Ķ', 'ķ', 'Ĺ', 'ĺ', 'Ļ', 'ļ', 'Ľ', 'ľ', 'Ŀ', 'ŀ', 'Ł', 'ł', 'Ń', 'ń', 'Ņ', 'ņ', 'Ň', 'ň', 'ŉ', 'Ō', 'ō', 'Ŏ', 'ŏ', 'Ő', 'ő', 'Œ', 'œ', 'Ŕ', 'ŕ', 'Ŗ', 'ŗ', 'Ř', 'ř', 'Ś', 'ś', 'Ŝ', 'ŝ', 'Ş', 'ş', 'Š', 'š', 'Ţ', 'ţ', 'Ť', 'ť', 'Ŧ', 'ŧ', 'Ũ', 'ũ', 'Ū', 'ū', 'Ŭ', 'ŭ', 'Ů', 'ů', 'Ű', 'ű', 'Ų', 'ų', 'Ŵ', 'ŵ', 'Ŷ', 'ŷ', 'Ÿ', 'Ź', 'ź', 'Ż', 'ż', 'Ž', 'ž', 'ſ', 'ƒ', 'Ơ', 'ơ', 'Ư', 'ư', 'Ǎ', 'ǎ', 'Ǐ', 'ǐ', 'Ǒ', 'ǒ', 'Ǔ', 'ǔ', 'Ǖ', 'ǖ', 'Ǘ', 'ǘ', 'Ǚ', 'ǚ', 'Ǜ', 'ǜ', 'Ǻ', 'ǻ', 'Ǽ', 'ǽ', 'Ǿ', 'ǿ');
  $b = array('A', 'A', 'A', 'A', 'A', 'A', 'AE', 'C', 'E', 'E', 'E', 'E', 'I', 'I', 'I', 'I', 'D', 'N', 'O', 'O', 'O', 'O', 'O', 'O', 'U', 'U', 'U', 'U', 'Y', 's', 'a', 'a', 'a', 'a', 'a', 'a', 'ae', 'c', 'e', 'e', 'e', 'e', 'i', 'i', 'i', 'i', 'n', 'o', 'o', 'o', 'o', 'o', 'o', 'u', 'u', 'u', 'u', 'y', 'y', 'A', 'a', 'A', 'a', 'A', 'a', 'C', 'c', 'C', 'c', 'C', 'c', 'C', 'c', 'D', 'd', 'D', 'd', 'E', 'e', 'E', 'e', 'E', 'e', 'E', 'e', 'E', 'e', 'G', 'g', 'G', 'g', 'G', 'g', 'G', 'g', 'H', 'h', 'H', 'h', 'I', 'i', 'I', 'i', 'I', 'i', 'I', 'i', 'I', 'i', 'IJ', 'ij', 'J', 'j', 'K', 'k', 'L', 'l', 'L', 'l', 'L', 'l', 'L', 'l', 'l', 'l', 'N', 'n', 'N', 'n', 'N', 'n', 'n', 'O', 'o', 'O', 'o', 'O', 'o', 'OE', 'oe', 'R', 'r', 'R', 'r', 'R', 'r', 'S', 's', 'S', 's', 'S', 's', 'S', 's', 'T', 't', 'T', 't', 'T', 't', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'W', 'w', 'Y', 'y', 'Y', 'Z', 'z', 'Z', 'z', 'Z', 'z', 's', 'f', 'O', 'o', 'U', 'u', 'A', 'a', 'I', 'i', 'O', 'o', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'A', 'a', 'AE', 'ae', 'O', 'o');
  return str_replace($a, $b, $str);
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-06-19T12:21:09.667

我认为这里的问题是您的编码将 ä 和 å 考虑为与“a”不同的符号。事实上，strtr 的 PHP 文档提供了一个以丑陋的方式去除重音的示例：(

[http://ie2.php.net/strtr](http://ie2.php.net/strtr)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2015-09-14T10:36:26.177

这是我通常用来删除重音的一个简单功能：

```
function str_without_accents($str, $charset='utf-8')
{
    $str = htmlentities($str, ENT_NOQUOTES, $charset);

    $str = preg_replace('#&([A-za-z])(?:acute|cedil|caron|circ|grave|orn|ring|slash|th|tilde|uml);#', '\1', $str);
    $str = preg_replace('#&([A-za-z]{2})(?:lig);#', '\1', $str); // pour les ligatures e.g. '&oelig;'
    $str = preg_replace('#&[^;]+;#', '', $str); // supprime les autres caractères

    return $str;   // or add this : mb_strtoupper($str); for uppercase :)
} 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-06-19T13:05:56.613

您可以使用 urlencode。不完全符合您的要求（删除重音符号），但会给您一个 url 可用字符串

```
$output = urlencode ($input); 
```

在 Perl 中，我可以使用翻译正则表达式，但我想不出 PHP 等价物

```
$input =~ tr/áâàå/aaaa/; 
```

ETC...

你可以使用 preg_replace 来做到这一点

```
$patterns[0] = '/[á|â|à|å|ä]/';
$patterns[1] = '/[ð|é|ê|è|ë]/';
$patterns[2] = '/[í|î|ì|ï]/';
$patterns[3] = '/[ó|ô|ò|ø|õ|ö]/';
$patterns[4] = '/[ú|û|ù|ü]/';
$patterns[5] = '/æ/';
$patterns[6] = '/ç/';
$patterns[7] = '/ß/';
$replacements[0] = 'a';
$replacements[1] = 'e';
$replacements[2] = 'i';
$replacements[3] = 'o';
$replacements[4] = 'u';
$replacements[5] = 'ae';
$replacements[6] = 'c';
$replacements[7] = 'ss';

$output = preg_replace($patterns, $replacements, $input); 
```

（请注意，这是在星期五中午记忆之后从迷雾中的啤酒中输入的，因此可能不是 100% 正确）

或者您可以制作一个哈希表并以此为基础进行替换。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-01-07T07:36:23.937

我刚刚创建了一个基于阅读该线程和另一个线程的 removeAccents 方法（[如何删除重音符号并将字母转换为“普通”ASCII 字符？](https://stackoverflow.com/questions/3542717/how-to-remove-accents-and-turn-letters-into-plain-ascii-characters)）。

方法在这里：[https ://github.com/lingtalfi/Bat/blob/master/StringTool.md#removeaccents](https://github.com/lingtalfi/Bat/blob/master/StringTool.md#removeaccents)

测试在这里：[https](https://github.com/lingtalfi/Bat/blob/master/btests/StringTool/removeAccents/stringTool.removeAccents.test.php) ://github.com/lingtalfi/Bat/blob/master/btests/StringTool/removeAccents/stringTool.removeAccents.test.php ，

这是迄今为止测试的内容：

```
$a = [
    // easy
    '',
    'a',
    'après',
    'dédé fait la fête ?',
    // hard
    'àáâãäçèéêëìíîïñòóôõöùúûüýÿÀÁÂÃÄÇÈÉÊËÌÍÎÏÑÒÓÔÕÖÙÚÛÜÝ',
    'ŻŹĆŃĄŚŁĘÓżźćńąśłęó',
    'qqqqŻŹĆŃĄŚŁĘÓżźćńąśłęóqqq',
    'ŠŽšžŸÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝàáâãäåçèéêëìíîïðñòóôõöøùúûüýÿ',       
    'ÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝàáâãäåçèéêëìíîïñòóôõöøùúûüýÿ',
    'ĀāĂăĄąĆćĈĉĊċČčĎďĐđĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħĨĩĪīĬĭĮįİĴĵĶķ',
    'ĹĺĻļĽľĿŀŁłŃńŅņŇňŉŌōŎŏŐőŔŕŖŗŘřŚśŜŝŞşŠšŢţŤťŦŧŨũŪūŬŭŮůŰűŲųŴŵŶŷŸŹźŻżŽž',
    'ſƒƠơƯưǍǎǏǐǑǒǓǔǕǖǗǘǙǚǛǜǺǻǾǿ',
    'Ǽǽ',
]; 
```

它只转换强调的东西（字母/连字/cédilles/一些字母通过/...？）。

下面是方法的内容：（[https://github.com/lingtalfi/Bat/blob/master/StringTool.php#L83](https://github.com/lingtalfi/Bat/blob/master/StringTool.php#L83)）

```
public static function removeAccents($str)
{
    static $map = [
        // single letters
        'à' => 'a',
        'á' => 'a',
        'â' => 'a',
        'ã' => 'a',
        'ä' => 'a',
        'ą' => 'a',
        'å' => 'a',
        'ā' => 'a',
        'ă' => 'a',
        'ǎ' => 'a',
        'ǻ' => 'a',
        'À' => 'A',
        'Á' => 'A',
        'Â' => 'A',
        'Ã' => 'A',
        'Ä' => 'A',
        'Ą' => 'A',
        'Å' => 'A',
        'Ā' => 'A',
        'Ă' => 'A',
        'Ǎ' => 'A',
        'Ǻ' => 'A',

        'ç' => 'c',
        'ć' => 'c',
        'ĉ' => 'c',
        'ċ' => 'c',
        'č' => 'c',
        'Ç' => 'C',
        'Ć' => 'C',
        'Ĉ' => 'C',
        'Ċ' => 'C',
        'Č' => 'C',

        'ď' => 'd',
        'đ' => 'd',
        'Ð' => 'D',
        'Ď' => 'D',
        'Đ' => 'D',

        'è' => 'e',
        'é' => 'e',
        'ê' => 'e',
        'ë' => 'e',
        'ę' => 'e',
        'ē' => 'e',
        'ĕ' => 'e',
        'ė' => 'e',
        'ě' => 'e',
        'È' => 'E',
        'É' => 'E',
        'Ê' => 'E',
        'Ë' => 'E',
        'Ę' => 'E',
        'Ē' => 'E',
        'Ĕ' => 'E',
        'Ė' => 'E',
        'Ě' => 'E',

        'ƒ' => 'f',

        'ĝ' => 'g',
        'ğ' => 'g',
        'ġ' => 'g',
        'ģ' => 'g',
        'Ĝ' => 'G',
        'Ğ' => 'G',
        'Ġ' => 'G',
        'Ģ' => 'G',

        'ĥ' => 'h',
        'ħ' => 'h',
        'Ĥ' => 'H',
        'Ħ' => 'H',

        'ì' => 'i',
        'í' => 'i',
        'î' => 'i',
        'ï' => 'i',
        'ĩ' => 'i',
        'ī' => 'i',
        'ĭ' => 'i',
        'į' => 'i',
        'ſ' => 'i',
        'ǐ' => 'i',
        'Ì' => 'I',
        'Í' => 'I',
        'Î' => 'I',
        'Ï' => 'I',
        'Ĩ' => 'I',
        'Ī' => 'I',
        'Ĭ' => 'I',
        'Į' => 'I',
        'İ' => 'I',
        'Ǐ' => 'I',

        'ĵ' => 'j',
        'Ĵ' => 'J',

        'ķ' => 'k',
        'Ķ' => 'K',

        'ł' => 'l',
        'ĺ' => 'l',
        'ļ' => 'l',
        'ľ' => 'l',
        'ŀ' => 'l',
        'Ł' => 'L',
        'Ĺ' => 'L',
        'Ļ' => 'L',
        'Ľ' => 'L',
        'Ŀ' => 'L',

        'ñ' => 'n',
        'ń' => 'n',
        'ņ' => 'n',
        'ň' => 'n',
        'ŉ' => 'n',
        'Ñ' => 'N',
        'Ń' => 'N',
        'Ņ' => 'N',
        'Ň' => 'N',

        'ò' => 'o',
        'ó' => 'o',
        'ô' => 'o',
        'õ' => 'o',
        'ö' => 'o',
        'ð' => 'o',
        'ø' => 'o',
        'ō' => 'o',
        'ŏ' => 'o',
        'ő' => 'o',
        'ơ' => 'o',
        'ǒ' => 'o',
        'ǿ' => 'o',
        'Ò' => 'O',
        'Ó' => 'O',
        'Ô' => 'O',
        'Õ' => 'O',
        'Ö' => 'O',
        'Ø' => 'O',
        'Ō' => 'O',
        'Ŏ' => 'O',
        'Ő' => 'O',
        'Ơ' => 'O',
        'Ǒ' => 'O',
        'Ǿ' => 'O',

        'ŕ' => 'r',
        'ŗ' => 'r',
        'ř' => 'r',
        'Ŕ' => 'R',
        'Ŗ' => 'R',
        'Ř' => 'R',

        'ś' => 's',
        'š' => 's',
        'ŝ' => 's',
        'ş' => 's',
        'Ś' => 'S',
        'Š' => 'S',
        'Ŝ' => 'S',
        'Ş' => 'S',

        'ţ' => 't',
        'ť' => 't',
        'ŧ' => 't',
        'Ţ' => 'T',
        'Ť' => 'T',
        'Ŧ' => 'T',

        'ù' => 'u',
        'ú' => 'u',
        'û' => 'u',
        'ü' => 'u',
        'ũ' => 'u',
        'ū' => 'u',
        'ŭ' => 'u',
        'ů' => 'u',
        'ű' => 'u',
        'ų' => 'u',
        'ư' => 'u',
        'ǔ' => 'u',
        'ǖ' => 'u',
        'ǘ' => 'u',
        'ǚ' => 'u',
        'ǜ' => 'u',
        'Ù' => 'U',
        'Ú' => 'U',
        'Û' => 'U',
        'Ü' => 'U',
        'Ũ' => 'U',
        'Ū' => 'U',
        'Ŭ' => 'U',
        'Ů' => 'U',
        'Ű' => 'U',
        'Ų' => 'U',
        'Ư' => 'U',
        'Ǔ' => 'U',
        'Ǖ' => 'U',
        'Ǘ' => 'U',
        'Ǚ' => 'U',
        'Ǜ' => 'U',

        'ŵ' => 'w',
        'Ŵ' => 'W',

        'ý' => 'y',
        'ÿ' => 'y',
        'ŷ' => 'y',
        'Ý' => 'Y',
        'Ÿ' => 'Y',
        'Ŷ' => 'Y',

        'ż' => 'z',
        'ź' => 'z',
        'ž' => 'z',
        'Ż' => 'Z',
        'Ź' => 'Z',
        'Ž' => 'Z',

        // accentuated ligatures
        'Ǽ' => 'A',
        'ǽ' => 'a',
    ];
    return strtr($str, $map);
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-05-29T14:31:10.693

这个有什么问题？适用于 UTF8

```
function strip_accents($s){
  return str_replace(
    explode(' ', preg_replace('/ +/', ' ', 'č ć ž š đ  Č Ć Ž Š Đ  à á â ã ä ç è é ê ë ì í î ï ñ ò ó ô õ ö ù ú û ü ý ÿ À Á Â Ã Ä Ç È É Ê Ë Ì Í Î Ï Ñ Ò Ó Ô Õ Ö Ù Ú Û Ü Ý')),
    explode(' ', preg_replace('/ +/', ' ', 'c c z s dj C C Z S DJ a a a a a c e e e e i i i i n o o o o o u u u u y y A A A A A C E E E E I I I I N O O O O O U U U U Y')),
    $s);
} 
```

不使用它可以更快`preg_replace`，但速度不是我的目标。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-06-19T13:47:54.173

我同意乔治布洛克的评论。

如果你找到一种方法让 //TRANSLIT 工作，你可以建立友好的 URL：

1.  使用 iconv 和 //TRANSLIT ñ => n~
    *   删除单词中的非字母数字非空白字符：`$url = preg_replace( '/(\w)[^\w\s](\w)/', '$1$2', $url );`
    *   替换剩余的分离：`$url = preg_replace( '/[^a-z0-9]+/', '-', $url );`
    *   删除双/领先/跟踪：`$url = preg_replace( '-'`，例如`'/(?:(^|\-)\-+|\-$)/', '', $url );`

如果您无法使其工作，请将 setp 1 替换为基于 strtr/字符的替换，例如 Xetius 的解决方案。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-06-19T14:10:49.743

我无法重现您的问题。我得到了预期的结果。

您究竟是如何使用[`mb_detect_encoding()`](http://www.php.net/manual/en/function.mb-detect-encoding.php)来验证您的字符串实际上是 UTF-8 的？

如果我只是调用`mb_detect_encoding($input)`字符串的 UTF-8 和 ISO-8859-1 编码版本，它们都返回“UTF-8”，因此该函数不是特别可靠。

`iconv()`当它得到错误编码的字符串并且只回显“F”时给我一个 PHP“通知”，但这可能只是因为不同的 PHP/iconv 设置/版本（？）。

我建议您[`mb_check_encoding($input, "utf-8")`](http://www.php.net/manual/en/function.mb-check-encoding.php)先尝试调用以验证您的字符串*确实*是 UTF-8。~~我想可能不是。~~

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-11-08T10:59:55.037

将 Cazuma Nii Cavalcanti 的实现与 Junior Mayhé 的字符列表合并，希望能为你们中的一些人节省一些时间。

```
function stripAccents($str) {
    return strtr(utf8_decode($str), utf8_decode('ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝßàáâãäåæçèéêëìíîïñòóôõöøùúûüýÿĀāĂăĄąĆćĈĉĊċČčĎďĐđĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħĨĩĪīĬĭĮįİıĲĳĴĵĶķĹĺĻļĽľĿŀŁłŃńŅņŇňŉŌōŎŏŐőŒœŔŕŖŗŘřŚśŜŝŞşŠšŢţŤťŦŧŨũŪūŬŭŮůŰűŲųŴŵŶŷŸŹźŻżŽžſƒƠơƯưǍǎǏǐǑǒǓǔǕǖǗǘǙǚǛǜǺǻǼǽǾǿ'), 'AAAAAAAECEEEEIIIIDNOOOOOOUUUUYsaaaaaaaeceeeeiiiinoooooouuuuyyAaAaAaCcCcCcCcDdDdEeEeEeEeEeGgGgGgGgHhHhIiIiIiIiIiIJijJjKkLlLlLlLlllNnNnNnnOoOoOoOEoeRrRrRrSsSsSsSsTtTtTtUuUuUuUuUuUuWwYyYZzZzZzsfOoUuAaIiOoUuUuUuUuUuAaAEaeOo');
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-09-30T14:24:51.893

在 laravel 中，您可以简单地使用`str_slug($accentedPhrase)` ，如果您关心破折号 (-)，这种方法可以用空格代替`str_replace('-', ' ', str_slug($accentedPhrase))`

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-03-06T09:12:17.433

如果主要任务只是在 URL 中使用字符串，为什么不使用[slugyfier](https://github.com/cocur/slugify)呢？

```
composer require cocur/slugify 
```

然后

```
use Cocur\Slugify\Slugify;

$slugify = new Slugify();
echo $slugify->slugify('Fóø Bår'); 
```

它还为流行的框架提供了许多桥梁。例如，您可以使用[Doctrine Extensions](https://github.com/Atlantic18/DoctrineExtensions) [Sluggable](https://github.com/Atlantic18/DoctrineExtensions/blob/v2.4.x/doc/sluggable.md)行为为 DB 中的每个实体自动生成唯一的 slug 并在 URL 中使用它。

如果您只想消除所有口音，则可以使用[规则集](https://github.com/cocur/slugify/tree/master/Resources/rules)来满足要求。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-08-27T08:31:47.103

像这样的东西？

```
$arrSearch  = explode(","," ,ç,æ, œ, á,é,í,ó,ú,à,è,ì,ò,ù,ä,ë,ï,ö,ü,ÿ,â,ê,î,ô,û,å,e,i,ø,u");

$arrReplace = explode(",","_,c,ae,oe,a,e,i,o,u,a,e,i,o,u,a,e,i,o,u,y,a,e,i,o,u,a,e,i,o,u");

$output = str_replace($arrSearch, $arrReplace, $input); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-08-08T00:07:48.200

这个答案我在这里有以下提示，所以它不是我的。它适用于我使用 LATIN1 或 UTF-8。如果您使用其他字符集，您可能应该将它们添加到`mb_detect_encoding`函数中。可能还需要正确的环境设置。

```
function NoAccents($s){
        return iconv(mb_detect_encoding($s,'UTF-8, ASCII, ISO-8859-1'),'ASCII//TRANSLIT//INGORE',$s);
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-01-25T22:09:19.753

您可以使用数组 key => value 样式与 strtr() 一起安全地用于 UTF-8 字符，即使它们是多字节的。

```
function no_accent($str){
    $accents = array('À' => 'A', 'Á' => 'A', 'Â' => 'A', 'Ã' => 'A', 'Ä' => 'A', 'Å' => 'A', 'à' => 'a', 'á' => 'a', 'â' => 'a', 'ã' => 'a', 'ä' => 'a', 'å' => 'a', 'Ā' => 'A', 'ā' => 'a', 'Ă' => 'A', 'ă' => 'a', 'Ą' => 'A', 'ą' => 'a', 'Ç' => 'C', 'ç' => 'c', 'Ć' => 'C', 'ć' => 'c', 'Ĉ' => 'C', 'ĉ' => 'c', 'Ċ' => 'C', 'ċ' => 'c', 'Č' => 'C', 'č' => 'c', 'Ð' => 'D', 'ð' => 'd', 'Ď' => 'D', 'ď' => 'd', 'Đ' => 'D', 'đ' => 'd', 'È' => 'E', 'É' => 'E', 'Ê' => 'E', 'Ë' => 'E', 'è' => 'e', 'é' => 'e', 'ê' => 'e', 'ë' => 'e', 'Ē' => 'E', 'ē' => 'e', 'Ĕ' => 'E', 'ĕ' => 'e', 'Ė' => 'E', 'ė' => 'e', 'Ę' => 'E', 'ę' => 'e', 'Ě' => 'E', 'ě' => 'e', 'Ĝ' => 'G', 'ĝ' => 'g', 'Ğ' => 'G', 'ğ' => 'g', 'Ġ' => 'G', 'ġ' => 'g', 'Ģ' => 'G', 'ģ' => 'g', 'Ĥ' => 'H', 'ĥ' => 'h', 'Ħ' => 'H', 'ħ' => 'h', 'Ì' => 'I', 'Í' => 'I', 'Î' => 'I', 'Ï' => 'I', 'ì' => 'i', 'í' => 'i', 'î' => 'i', 'ï' => 'i', 'Ĩ' => 'I', 'ĩ' => 'i', 'Ī' => 'I', 'ī' => 'i', 'Ĭ' => 'I', 'ĭ' => 'i', 'Į' => 'I', 'į' => 'i', 'İ' => 'I', 'ı' => 'i', 'Ĵ' => 'J', 'ĵ' => 'j', 'Ķ' => 'K', 'ķ' => 'k', 'ĸ' => 'k', 'Ĺ' => 'L', 'ĺ' => 'l', 'Ļ' => 'L', 'ļ' => 'l', 'Ľ' => 'L', 'ľ' => 'l', 'Ŀ' => 'L', 'ŀ' => 'l', 'Ł' => 'L', 'ł' => 'l', 'Ñ' => 'N', 'ñ' => 'n', 'Ń' => 'N', 'ń' => 'n', 'Ņ' => 'N', 'ņ' => 'n', 'Ň' => 'N', 'ň' => 'n', 'ŉ' => 'n', 'Ŋ' => 'N', 'ŋ' => 'n', 'Ò' => 'O', 'Ó' => 'O', 'Ô' => 'O', 'Õ' => 'O', 'Ö' => 'O', 'Ø' => 'O', 'ò' => 'o', 'ó' => 'o', 'ô' => 'o', 'õ' => 'o', 'ö' => 'o', 'ø' => 'o', 'Ō' => 'O', 'ō' => 'o', 'Ŏ' => 'O', 'ŏ' => 'o', 'Ő' => 'O', 'ő' => 'o', 'Ŕ' => 'R', 'ŕ' => 'r', 'Ŗ' => 'R', 'ŗ' => 'r', 'Ř' => 'R', 'ř' => 'r', 'Ś' => 'S', 'ś' => 's', 'Ŝ' => 'S', 'ŝ' => 's', 'Ş' => 'S', 'ş' => 's', 'Š' => 'S', 'š' => 's', 'ſ' => 's', 'Ţ' => 'T', 'ţ' => 't', 'Ť' => 'T', 'ť' => 't', 'Ŧ' => 'T', 'ŧ' => 't', 'Ù' => 'U', 'Ú' => 'U', 'Û' => 'U', 'Ü' => 'U', 'ù' => 'u', 'ú' => 'u', 'û' => 'u', 'ü' => 'u', 'Ũ' => 'U', 'ũ' => 'u', 'Ū' => 'U', 'ū' => 'u', 'Ŭ' => 'U', 'ŭ' => 'u', 'Ů' => 'U', 'ů' => 'u', 'Ű' => 'U', 'ű' => 'u', 'Ų' => 'U', 'ų' => 'u', 'Ŵ' => 'W', 'ŵ' => 'w', 'Ý' => 'Y', 'ý' => 'y', 'ÿ' => 'y', 'Ŷ' => 'Y', 'ŷ' => 'y', 'Ÿ' => 'Y', 'Ź' => 'Z', 'ź' => 'z', 'Ż' => 'Z', 'ż' => 'z', 'Ž' => 'Z', 'ž' => 'z');
    return strtr($str, $accents);
} 
```

另外，您将解码/编码保存在 UTF-8 部分。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-09-05T09:55:48.547

`remove_accents()`根据最新版本[Wordpress 4.3 格式](https://core.trac.wordpress.org/browser/tags/4.3/src/wp-includes/formatting.php)的改进版功能是：

```
function mbstring_binary_safe_encoding( $reset = false ) {
    static $encodings = array();
    static $overloaded = null;

    if ( is_null( $overloaded ) )
        $overloaded = function_exists( 'mb_internal_encoding' ) && ( ini_get( 'mbstring.func_overload' ) & 2 );

    if ( false === $overloaded )
        return;

    if ( ! $reset ) {
        $encoding = mb_internal_encoding();
        array_push( $encodings, $encoding );
        mb_internal_encoding( 'ISO-8859-1' );
    }

    if ( $reset && $encodings ) {
        $encoding = array_pop( $encodings );
        mb_internal_encoding( $encoding );
    }
}

function reset_mbstring_encoding() {
    mbstring_binary_safe_encoding( true );
}

function seems_utf8( $str ) {
    mbstring_binary_safe_encoding();
    $length = strlen($str);
    reset_mbstring_encoding();
    for ($i=0; $i < $length; $i++) {
        $c = ord($str[$i]);
        if ($c < 0x80) $n = 0; // 0bbbbbbb
        elseif (($c & 0xE0) == 0xC0) $n=1; // 110bbbbb
        elseif (($c & 0xF0) == 0xE0) $n=2; // 1110bbbb
        elseif (($c & 0xF8) == 0xF0) $n=3; // 11110bbb
        elseif (($c & 0xFC) == 0xF8) $n=4; // 111110bb
        elseif (($c & 0xFE) == 0xFC) $n=5; // 1111110b
        else return false; // Does not match any model
        for ($j=0; $j<$n; $j++) { // n bytes matching 10bbbbbb follow ?
            if ((++$i == $length) || ((ord($str[$i]) & 0xC0) != 0x80))
                return false;
        }
    }
    return true;
}

function remove_accents( $string ) {
    if ( !preg_match('/[\x80-\xff]/', $string) )
        return $string;

    if (seems_utf8($string)) {
        $chars = array(
            // Decompositions for Latin-1 Supplement
            chr(194).chr(170) => 'a', chr(194).chr(186) => 'o',
            chr(195).chr(128) => 'A', chr(195).chr(129) => 'A',
            chr(195).chr(130) => 'A', chr(195).chr(131) => 'A',
            chr(195).chr(132) => 'A', chr(195).chr(133) => 'A',
            chr(195).chr(134) => 'AE',chr(195).chr(135) => 'C',
            chr(195).chr(136) => 'E', chr(195).chr(137) => 'E',
            chr(195).chr(138) => 'E', chr(195).chr(139) => 'E',
            chr(195).chr(140) => 'I', chr(195).chr(141) => 'I',
            chr(195).chr(142) => 'I', chr(195).chr(143) => 'I',
            chr(195).chr(144) => 'D', chr(195).chr(145) => 'N',
            chr(195).chr(146) => 'O', chr(195).chr(147) => 'O',
            chr(195).chr(148) => 'O', chr(195).chr(149) => 'O',
            chr(195).chr(150) => 'O', chr(195).chr(153) => 'U',
            chr(195).chr(154) => 'U', chr(195).chr(155) => 'U',
            chr(195).chr(156) => 'U', chr(195).chr(157) => 'Y',
            chr(195).chr(158) => 'TH',chr(195).chr(159) => 's',
            chr(195).chr(160) => 'a', chr(195).chr(161) => 'a',
            chr(195).chr(162) => 'a', chr(195).chr(163) => 'a',
            chr(195).chr(164) => 'a', chr(195).chr(165) => 'a',
            chr(195).chr(166) => 'ae',chr(195).chr(167) => 'c',
            chr(195).chr(168) => 'e', chr(195).chr(169) => 'e',
            chr(195).chr(170) => 'e', chr(195).chr(171) => 'e',
            chr(195).chr(172) => 'i', chr(195).chr(173) => 'i',
            chr(195).chr(174) => 'i', chr(195).chr(175) => 'i',
            chr(195).chr(176) => 'd', chr(195).chr(177) => 'n',
            chr(195).chr(178) => 'o', chr(195).chr(179) => 'o',
            chr(195).chr(180) => 'o', chr(195).chr(181) => 'o',
            chr(195).chr(182) => 'o', chr(195).chr(184) => 'o',
            chr(195).chr(185) => 'u', chr(195).chr(186) => 'u',
            chr(195).chr(187) => 'u', chr(195).chr(188) => 'u',
            chr(195).chr(189) => 'y', chr(195).chr(190) => 'th',
            chr(195).chr(191) => 'y', chr(195).chr(152) => 'O',
            // Decompositions for Latin Extended-A
            chr(196).chr(128) => 'A', chr(196).chr(129) => 'a',
            chr(196).chr(130) => 'A', chr(196).chr(131) => 'a',
            chr(196).chr(132) => 'A', chr(196).chr(133) => 'a',
            chr(196).chr(134) => 'C', chr(196).chr(135) => 'c',
            chr(196).chr(136) => 'C', chr(196).chr(137) => 'c',
            chr(196).chr(138) => 'C', chr(196).chr(139) => 'c',
            chr(196).chr(140) => 'C', chr(196).chr(141) => 'c',
            chr(196).chr(142) => 'D', chr(196).chr(143) => 'd',
            chr(196).chr(144) => 'D', chr(196).chr(145) => 'd',
            chr(196).chr(146) => 'E', chr(196).chr(147) => 'e',
            chr(196).chr(148) => 'E', chr(196).chr(149) => 'e',
            chr(196).chr(150) => 'E', chr(196).chr(151) => 'e',
            chr(196).chr(152) => 'E', chr(196).chr(153) => 'e',
            chr(196).chr(154) => 'E', chr(196).chr(155) => 'e',
            chr(196).chr(156) => 'G', chr(196).chr(157) => 'g',
            chr(196).chr(158) => 'G', chr(196).chr(159) => 'g',
            chr(196).chr(160) => 'G', chr(196).chr(161) => 'g',
            chr(196).chr(162) => 'G', chr(196).chr(163) => 'g',
            chr(196).chr(164) => 'H', chr(196).chr(165) => 'h',
            chr(196).chr(166) => 'H', chr(196).chr(167) => 'h',
            chr(196).chr(168) => 'I', chr(196).chr(169) => 'i',
            chr(196).chr(170) => 'I', chr(196).chr(171) => 'i',
            chr(196).chr(172) => 'I', chr(196).chr(173) => 'i',
            chr(196).chr(174) => 'I', chr(196).chr(175) => 'i',
            chr(196).chr(176) => 'I', chr(196).chr(177) => 'i',
            chr(196).chr(178) => 'IJ',chr(196).chr(179) => 'ij',
            chr(196).chr(180) => 'J', chr(196).chr(181) => 'j',
            chr(196).chr(182) => 'K', chr(196).chr(183) => 'k',
            chr(196).chr(184) => 'k', chr(196).chr(185) => 'L',
            chr(196).chr(186) => 'l', chr(196).chr(187) => 'L',
            chr(196).chr(188) => 'l', chr(196).chr(189) => 'L',
            chr(196).chr(190) => 'l', chr(196).chr(191) => 'L',
            chr(197).chr(128) => 'l', chr(197).chr(129) => 'L',
            chr(197).chr(130) => 'l', chr(197).chr(131) => 'N',
            chr(197).chr(132) => 'n', chr(197).chr(133) => 'N',
            chr(197).chr(134) => 'n', chr(197).chr(135) => 'N',
            chr(197).chr(136) => 'n', chr(197).chr(137) => 'N',
            chr(197).chr(138) => 'n', chr(197).chr(139) => 'N',
            chr(197).chr(140) => 'O', chr(197).chr(141) => 'o',
            chr(197).chr(142) => 'O', chr(197).chr(143) => 'o',
            chr(197).chr(144) => 'O', chr(197).chr(145) => 'o',
            chr(197).chr(146) => 'OE',chr(197).chr(147) => 'oe',
            chr(197).chr(148) => 'R',chr(197).chr(149) => 'r',
            chr(197).chr(150) => 'R',chr(197).chr(151) => 'r',
            chr(197).chr(152) => 'R',chr(197).chr(153) => 'r',
            chr(197).chr(154) => 'S',chr(197).chr(155) => 's',
            chr(197).chr(156) => 'S',chr(197).chr(157) => 's',
            chr(197).chr(158) => 'S',chr(197).chr(159) => 's',
            chr(197).chr(160) => 'S', chr(197).chr(161) => 's',
            chr(197).chr(162) => 'T', chr(197).chr(163) => 't',
            chr(197).chr(164) => 'T', chr(197).chr(165) => 't',
            chr(197).chr(166) => 'T', chr(197).chr(167) => 't',
            chr(197).chr(168) => 'U', chr(197).chr(169) => 'u',
            chr(197).chr(170) => 'U', chr(197).chr(171) => 'u',
            chr(197).chr(172) => 'U', chr(197).chr(173) => 'u',
            chr(197).chr(174) => 'U', chr(197).chr(175) => 'u',
            chr(197).chr(176) => 'U', chr(197).chr(177) => 'u',
            chr(197).chr(178) => 'U', chr(197).chr(179) => 'u',
            chr(197).chr(180) => 'W', chr(197).chr(181) => 'w',
            chr(197).chr(182) => 'Y', chr(197).chr(183) => 'y',
            chr(197).chr(184) => 'Y', chr(197).chr(185) => 'Z',
            chr(197).chr(186) => 'z', chr(197).chr(187) => 'Z',
            chr(197).chr(188) => 'z', chr(197).chr(189) => 'Z',
            chr(197).chr(190) => 'z', chr(197).chr(191) => 's',
            // Decompositions for Latin Extended-B
            chr(200).chr(152) => 'S', chr(200).chr(153) => 's',
            chr(200).chr(154) => 'T', chr(200).chr(155) => 't',
            // Euro Sign
            chr(226).chr(130).chr(172) => 'E',
            // GBP (Pound) Sign
            chr(194).chr(163) => '',
            // Vowels with diacritic (Vietnamese)
            // unmarked
            chr(198).chr(160) => 'O', chr(198).chr(161) => 'o',
            chr(198).chr(175) => 'U', chr(198).chr(176) => 'u',
            // grave accent
            chr(225).chr(186).chr(166) => 'A', chr(225).chr(186).chr(167) => 'a',
            chr(225).chr(186).chr(176) => 'A', chr(225).chr(186).chr(177) => 'a',
            chr(225).chr(187).chr(128) => 'E', chr(225).chr(187).chr(129) => 'e',
            chr(225).chr(187).chr(146) => 'O', chr(225).chr(187).chr(147) => 'o',
            chr(225).chr(187).chr(156) => 'O', chr(225).chr(187).chr(157) => 'o',
            chr(225).chr(187).chr(170) => 'U', chr(225).chr(187).chr(171) => 'u',
            chr(225).chr(187).chr(178) => 'Y', chr(225).chr(187).chr(179) => 'y',
            // hook
            chr(225).chr(186).chr(162) => 'A', chr(225).chr(186).chr(163) => 'a',
            chr(225).chr(186).chr(168) => 'A', chr(225).chr(186).chr(169) => 'a',
            chr(225).chr(186).chr(178) => 'A', chr(225).chr(186).chr(179) => 'a',
            chr(225).chr(186).chr(186) => 'E', chr(225).chr(186).chr(187) => 'e',
            chr(225).chr(187).chr(130) => 'E', chr(225).chr(187).chr(131) => 'e',
            chr(225).chr(187).chr(136) => 'I', chr(225).chr(187).chr(137) => 'i',
            chr(225).chr(187).chr(142) => 'O', chr(225).chr(187).chr(143) => 'o',
            chr(225).chr(187).chr(148) => 'O', chr(225).chr(187).chr(149) => 'o',
            chr(225).chr(187).chr(158) => 'O', chr(225).chr(187).chr(159) => 'o',
            chr(225).chr(187).chr(166) => 'U', chr(225).chr(187).chr(167) => 'u',
            chr(225).chr(187).chr(172) => 'U', chr(225).chr(187).chr(173) => 'u',
            chr(225).chr(187).chr(182) => 'Y', chr(225).chr(187).chr(183) => 'y',
            // tilde
            chr(225).chr(186).chr(170) => 'A', chr(225).chr(186).chr(171) => 'a',
            chr(225).chr(186).chr(180) => 'A', chr(225).chr(186).chr(181) => 'a',
            chr(225).chr(186).chr(188) => 'E', chr(225).chr(186).chr(189) => 'e',
            chr(225).chr(187).chr(132) => 'E', chr(225).chr(187).chr(133) => 'e',
            chr(225).chr(187).chr(150) => 'O', chr(225).chr(187).chr(151) => 'o',
            chr(225).chr(187).chr(160) => 'O', chr(225).chr(187).chr(161) => 'o',
            chr(225).chr(187).chr(174) => 'U', chr(225).chr(187).chr(175) => 'u',
            chr(225).chr(187).chr(184) => 'Y', chr(225).chr(187).chr(185) => 'y',
            // acute accent
            chr(225).chr(186).chr(164) => 'A', chr(225).chr(186).chr(165) => 'a',
            chr(225).chr(186).chr(174) => 'A', chr(225).chr(186).chr(175) => 'a',
            chr(225).chr(186).chr(190) => 'E', chr(225).chr(186).chr(191) => 'e',
            chr(225).chr(187).chr(144) => 'O', chr(225).chr(187).chr(145) => 'o',
            chr(225).chr(187).chr(154) => 'O', chr(225).chr(187).chr(155) => 'o',
            chr(225).chr(187).chr(168) => 'U', chr(225).chr(187).chr(169) => 'u',
            // dot below
            chr(225).chr(186).chr(160) => 'A', chr(225).chr(186).chr(161) => 'a',
            chr(225).chr(186).chr(172) => 'A', chr(225).chr(186).chr(173) => 'a',
            chr(225).chr(186).chr(182) => 'A', chr(225).chr(186).chr(183) => 'a',
            chr(225).chr(186).chr(184) => 'E', chr(225).chr(186).chr(185) => 'e',
            chr(225).chr(187).chr(134) => 'E', chr(225).chr(187).chr(135) => 'e',
            chr(225).chr(187).chr(138) => 'I', chr(225).chr(187).chr(139) => 'i',
            chr(225).chr(187).chr(140) => 'O', chr(225).chr(187).chr(141) => 'o',
            chr(225).chr(187).chr(152) => 'O', chr(225).chr(187).chr(153) => 'o',
            chr(225).chr(187).chr(162) => 'O', chr(225).chr(187).chr(163) => 'o',
            chr(225).chr(187).chr(164) => 'U', chr(225).chr(187).chr(165) => 'u',
            chr(225).chr(187).chr(176) => 'U', chr(225).chr(187).chr(177) => 'u',
            chr(225).chr(187).chr(180) => 'Y', chr(225).chr(187).chr(181) => 'y',
            // Vowels with diacritic (Chinese, Hanyu Pinyin)
            chr(201).chr(145) => 'a',
            // macron
            chr(199).chr(149) => 'U', chr(199).chr(150) => 'u',
            // acute accent
            chr(199).chr(151) => 'U', chr(199).chr(152) => 'u',
            // caron
            chr(199).chr(141) => 'A', chr(199).chr(142) => 'a',
            chr(199).chr(143) => 'I', chr(199).chr(144) => 'i',
            chr(199).chr(145) => 'O', chr(199).chr(146) => 'o',
            chr(199).chr(147) => 'U', chr(199).chr(148) => 'u',
            chr(199).chr(153) => 'U', chr(199).chr(154) => 'u',
            // grave accent
            chr(199).chr(155) => 'U', chr(199).chr(156) => 'u',
        );

        $string = strtr($string, $chars);
    } else {
        $chars = array();
        // Assume ISO-8859-1 if not UTF-8
        $chars['in'] = chr(128).chr(131).chr(138).chr(142).chr(154).chr(158)
            .chr(159).chr(162).chr(165).chr(181).chr(192).chr(193).chr(194)
            .chr(195).chr(196).chr(197).chr(199).chr(200).chr(201).chr(202)
            .chr(203).chr(204).chr(205).chr(206).chr(207).chr(209).chr(210)
            .chr(211).chr(212).chr(213).chr(214).chr(216).chr(217).chr(218)
            .chr(219).chr(220).chr(221).chr(224).chr(225).chr(226).chr(227)
            .chr(228).chr(229).chr(231).chr(232).chr(233).chr(234).chr(235)
            .chr(236).chr(237).chr(238).chr(239).chr(241).chr(242).chr(243)
            .chr(244).chr(245).chr(246).chr(248).chr(249).chr(250).chr(251)
            .chr(252).chr(253).chr(255);

        $chars['out'] = "EfSZszYcYuAAAAAACEEEEIIIINOOOOOOUUUUYaaaaaaceeeeiiiinoooooouuuuyy";

        $string = strtr($string, $chars['in'], $chars['out']);
        $double_chars = array();
        $double_chars['in'] = array(chr(140), chr(156), chr(198), chr(208), chr(222), chr(223), chr(230), chr(240), chr(254));
        $double_chars['out'] = array('OE', 'oe', 'AE', 'DH', 'TH', 'ss', 'ae', 'dh', 'th');
        $string = str_replace($double_chars['in'], $double_chars['out'], $string);
    }

    return $string;
} 
```

我的回答是更新@dynamic[解决方案](https://stackoverflow.com/questions/1017599/how-do-i-remove-accents-from-characters-in-a-php-string/10790734#10790734)，因为罗马尼亚语或其他语言的变音符号没有被转换。我写了最小的函数并且像一个魅力一样工作。

```
print_r(remove_accents('Iași, Iași County, Romania')); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-11-22T00:42:00.943

```
<?php
/* 
 * Thanks:
 *   - The idea of extracting accents equiv chars with the help of the HTMLSpecialChars convertion was taking from ICanBoogie Package of 'Olivier Laviale' {@link http://www.weirdog.com/blog/php/supprimer-les-accents-des-caracteres-accentues.html}
*/
function accentCharsModifier($str){
    if(($length=mb_strlen($str,"UTF-8"))<strlen($str)){
        $i=$count=0;
        while($i<$length){
            if(strlen($c=mb_substr($str,$i,1,"UTF-8"))>1){
                $he=htmlentities($c); 
                if(($nC=preg_replace("#&([A-Za-z])(?:acute|cedil|caron|circ|grave|orn|ring|slash|th|tilde|uml);#", "\\1", $he))!=$he ||
                    ($nC=preg_replace("#&([A-Za-z]{2})(?:lig);#", "\\1", $he))!=$he ||
                    ($nC=preg_replace("#&[^;]+;#", "", $he))!=$he){
                    $str=str_replace($c,$nC,$str,$count);if($nC==""){$length=$length-$count;$i--;}
                }
            }
            $i++;
        }
    }
    return $str;
}
echo accentCharsModifier("&éôpkAÈû");
?> 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-08-23T17:49:43.850

基于@Mimouni 的回答，我制作了这个函数来将重音字符串音译为非重音字符串。

```
/**
 * @param $str Convert string to lowercase and replace special chars to equivalents ou remove its
 * @return string
 */
function _slugify(string $string): string
{
    $str = $string; // for comparisons
    $str = _toUtf8($str); // Force to work with string in UTF-8
    $str = iconv('UTF-8', 'ASCII//TRANSLIT', $str);

    if ($str != htmlentities($string, ENT_QUOTES, 'UTF-8')) { // iconv fails
        $str = _toUtf8($string);
        $str = htmlentities($str, ENT_QUOTES, 'UTF-8');
        $str = preg_replace('#&([a-z]{1,2})(acute|cedil|circ|grave|lig|orn|ring|slash|th|tilde|uml);#i', '$1', $str);
        // Need to strip non ASCII chars or any other than a-z, A-Z, 0-9...
        $str = html_entity_decode($str, ENT_QUOTES, 'UTF-8');
        $str = preg_replace(array('#[^0-9a-z]#i', '#[ -]+#'), ' ', $str);
        $str = trim($str, ' -');
    }

    // lowercase
    $string = strtolower($str);

    return $string;
} 
```

> 要将字符串转换为 UTF-8，这里我使用多字节字符串扩展。请注意，我将字符串分成几部分以避免混合内容的麻烦（我有这种情况）并逐字转换。

```
/**
 * @param $str string String in any encoding
 * @return string
 */
function _toUtf8(string $str_in): ?string
{
    if (!function_exists('mb_detect_encoding')) {
        throw new \Exception('The Multi Byte String extension is absent!');
    }
    $str_out = [];
    $words = explode(" ", $str_in);
    foreach ($words as $word) {
        $current_encoding = mb_detect_encoding($word, 'UTF-8, ASCII, ISO-8859-1');
        $str_out[] = mb_convert_encoding($word, 'UTF-8', $current_encoding);
    }
    return implode(" ", $str_out);
} 
```

> 页脚注释：是在 Windows 命令行中传递 PHPUnit UnitTests 的唯一解决方案（语言环境问题）@gabo 解决方案应该可以工作，但不幸的是不适合我

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-01-18T19:10:29.730

结合一些答案：

```
/**
 * Given an utf8 string, returns an ascii string.
 * Only supports ISO-8859-1 chars, not chars like č, œ, Œ, ř, Š, š, ů, Ÿ or ž
 * @param string $utf8
 * @return string ascii
 */
function stripAccents(string $utf8): string
{
    $src = 'àáâãäåçèéêëìíîïñòóôõöùúûüýÿÀÁÂÃÄÇÈÉÊËÌÍÎÏÑÒÓÔÕÖÙÚÛÜÝ';
    $dst = 'aaaaaaceeeeiiiinooooouuuuyyAAAAACEEEEIIIINOOOOOUUUUY';
    $iso8859_1 = strtr(
        utf8_decode($utf8),
        utf8_decode($src),
        $dst
    );
    // iconv below not used for UTF-8 directly because it adds chars like ^'"`
    // which are nice to not lose info, but not very readable and not compatible with filenames
    // iconv() additionally converts chars like
    // ¡ ¢ £  ¥   ¦ §  ¨  ©  ª «  ¬   SHY ®    °  ±   ²  ³  ´ µ ¶ · ¸ ¹  º »  ¼   ½   ¾   ¿ Å Æ  Ð Ø Þ  ß  æ  ÷   ø þ
    // ! c lb yen | SS " (c) a << not SHY (R)  ^0 +/- ^2 ^3 ' u P . , ^1 o >> 1/4 1/2 3/4 ? A AE D O Th ss ae d : o th
    return iconv('ISO-8859-1', 'ASCII//TRANSLIT//IGNORE', $iso8859_1);
} 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2009-06-19T14:19:20.787

我在网上偶然发现的技巧之一是使用[htmlentities](http://us.php.net/manual/en/function.htmlentities.php)然后剥离编码字符：

```
$stripped = preg_replace('`&[^;]+;`','',htmlentities($string)); 
```

不完美，但在某些情况下它确实运作良好。

但是，您正在撰写有关创建 URL 字符串的文章，因此[urlencode](http://us.php.net/manual/en/function.urlencode.php)及其对应的[urldecode](http://us.php.net/manual/en/function.urldecode.php)可能会更好。或者，如果您正在创建查询字符串，请使用最后一个函数：[http_build_query](http://us.php.net/manual/en/function.http-build-query.php)。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2012-11-04T16:43:59.023

WordPress 的实现对于 UTF8 字符串来说绝对是最安全的。对于 Latin1 字符串，一个简单的 strtr 就可以完成这项工作，但请确保您将脚本保存为 LATIN1 格式，而不是 UTF-8。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2015-03-26T13:50:18.413

```
$unwanted_array = array(    '&amp;' => 'and', '&' => 'and', '@' => 'at', '©' => 'c', '®' => 'r', 
'̊'=>'','̧'=>'','̨'=>'','̄'=>'','̱'=>'',
'Á'=>'a','á'=>'a','À'=>'a','à'=>'a','Ă'=>'a','ă'=>'a','ắ'=>'a','Ắ'=>'A','Ằ'=>'A',
'ằ'=>'a','ẵ'=>'a','Ẵ'=>'A','ẳ'=>'a','Ẳ'=>'A','Â'=>'a','â'=>'a','ấ'=>'a','Ấ'=>'A',
'ầ'=>'a','Ầ'=>'a','ẩ'=>'a','Ẩ'=>'A','Ǎ'=>'a','ǎ'=>'a','Å'=>'a','å'=>'a','Ǻ'=>'a',
'ǻ'=>'a','Ä'=>'a','ä'=>'a','ã'=>'a','Ã'=>'A','Ą'=>'a','ą'=>'a','Ā'=>'a','ā'=>'a',
'ả'=>'a','Ả'=>'a','Ạ'=>'A','ạ'=>'a','ặ'=>'a','Ặ'=>'A','ậ'=>'a','Ậ'=>'A','Æ'=>'ae',
'æ'=>'ae','Ǽ'=>'ae','ǽ'=>'ae','ẫ'=>'a','Ẫ'=>'A',
'Ć'=>'c','ć'=>'c','Ĉ'=>'c','ĉ'=>'c','Č'=>'c','č'=>'c','Ċ'=>'c','ċ'=>'c','Ç'=>'c','ç'=>'c',
'Ď'=>'d','ď'=>'d','Ḑ'=>'D','ḑ'=>'d','Đ'=>'d','đ'=>'d','Ḍ'=>'D','ḍ'=>'d','Ḏ'=>'D','ḏ'=>'d','ð'=>'d','Ð'=>'D',
'É'=>'e','é'=>'e','È'=>'e','è'=>'e','Ĕ'=>'e','ĕ'=>'e','ê'=>'e','ế'=>'e','Ế'=>'E','ề'=>'e',
'Ề'=>'E','Ě'=>'e','ě'=>'e','Ë'=>'e','ë'=>'e','Ė'=>'e','ė'=>'e','Ę'=>'e','ę'=>'e','Ē'=>'e',
'ē'=>'e','ệ'=>'e','Ệ'=>'E','Ə'=>'e','ə'=>'e','ẽ'=>'e','Ẽ'=>'E','ễ'=>'e',
'Ễ'=>'E','ể'=>'e','Ể'=>'E','ẻ'=>'e','Ẻ'=>'E','ẹ'=>'e','Ẹ'=>'E',
'ƒ'=>'f',
'Ğ'=>'g','ğ'=>'g','Ĝ'=>'g','ĝ'=>'g','Ǧ'=>'G','ǧ'=>'g','Ġ'=>'g','ġ'=>'g','Ģ'=>'g','ģ'=>'g',
'H̲'=>'H','h̲'=>'h','Ĥ'=>'h','ĥ'=>'h','Ȟ'=>'H','ȟ'=>'h','Ḩ'=>'H','ḩ'=>'h','Ħ'=>'h','ħ'=>'h','Ḥ'=>'H','ḥ'=>'h',
'Ỉ'=>'I','Í'=>'i','í'=>'i','Ì'=>'i','ì'=>'i','Ĭ'=>'i','ĭ'=>'i','Î'=>'i','î'=>'i','Ǐ'=>'i','ǐ'=>'i',
'Ï'=>'i','ï'=>'i','Ḯ'=>'I','ḯ'=>'i','Ĩ'=>'i','ĩ'=>'i','İ'=>'i','Į'=>'i','į'=>'i','Ī'=>'i','ī'=>'i',
'ỉ'=>'I','Ị'=>'I','ị'=>'i','Ĳ'=>'ij','ĳ'=>'ij','ı'=>'i',
'Ĵ'=>'j','ĵ'=>'j',
'Ķ'=>'k','ķ'=>'k','Ḵ'=>'K','ḵ'=>'k',
'Ĺ'=>'l','ĺ'=>'l','Ľ'=>'l','ľ'=>'l','Ļ'=>'l','ļ'=>'l','Ł'=>'l','ł'=>'l','Ŀ'=>'l','ŀ'=>'l',
'Ń'=>'n','ń'=>'n','Ň'=>'n','ň'=>'n','Ñ'=>'N','ñ'=>'n','Ņ'=>'n','ņ'=>'n','Ṇ'=>'N','ṇ'=>'n','Ŋ'=>'n','ŋ'=>'n',
'Ó'=>'o','ó'=>'o','Ò'=>'o','ò'=>'o','Ŏ'=>'o','ŏ'=>'o','Ô'=>'o','ô'=>'o','ố'=>'o','Ố'=>'O','ồ'=>'o',
'Ồ'=>'O','ổ'=>'o','Ổ'=>'O','Ǒ'=>'o','ǒ'=>'o','Ö'=>'o','ö'=>'o','Ő'=>'o','ő'=>'o','Õ'=>'o','õ'=>'o',
'Ø'=>'o','ø'=>'o','Ǿ'=>'o','ǿ'=>'o','Ǫ'=>'O','ǫ'=>'o','Ǭ'=>'O','ǭ'=>'o','Ō'=>'o','ō'=>'o','ỏ'=>'o',
'Ỏ'=>'O','Ơ'=>'o','ơ'=>'o','ớ'=>'o','Ớ'=>'O','ờ'=>'o','Ờ'=>'O','ở'=>'o','Ở'=>'O','ợ'=>'o','Ợ'=>'O',
'ọ'=>'o','Ọ'=>'O','ọ'=>'o','Ọ'=>'O','ộ'=>'o','Ộ'=>'O','ỗ'=>'o','Ỗ'=>'O','ỡ'=>'o','Ỡ'=>'O',
'Œ'=>'oe','œ'=>'oe',
'ĸ'=>'k',
'Ŕ'=>'r','ŕ'=>'r','Ř'=>'r','ř'=>'r','ṙ'=>'r','Ŗ'=>'r','ŗ'=>'r','Ṛ'=>'R','ṛ'=>'r','Ṟ'=>'R','ṟ'=>'r',
'S̲'=>'S','s̲'=>'s','Ś'=>'s','ś'=>'s','Ŝ'=>'s','ŝ'=>'s','Š'=>'s','š'=>'s','Ş'=>'s','ş'=>'s',
'Ṣ'=>'S','ṣ'=>'s','Ș'=>'S','ș'=>'s',
'ſ'=>'z','ß'=>'ss','Ť'=>'t','ť'=>'t','Ţ'=>'t','ţ'=>'t','Ṭ'=>'T','ṭ'=>'t','Ț'=>'T',
'ț'=>'t','Ṯ'=>'T','ṯ'=>'t','™'=>'tm','Ŧ'=>'t','ŧ'=>'t',
'Ú'=>'u','ú'=>'u','Ù'=>'u','ù'=>'u','Ŭ'=>'u','ŭ'=>'u','Û'=>'u','û'=>'u','Ǔ'=>'u','ǔ'=>'u','Ů'=>'u','ů'=>'u',
'Ü'=>'u','ü'=>'u','Ǘ'=>'u','ǘ'=>'u','Ǜ'=>'u','ǜ'=>'u','Ǚ'=>'u','ǚ'=>'u','Ǖ'=>'u','ǖ'=>'u','Ű'=>'u','ű'=>'u',
'Ũ'=>'u','ũ'=>'u','Ų'=>'u','ų'=>'u','Ū'=>'u','ū'=>'u','Ư'=>'u','ư'=>'u','ứ'=>'u','Ứ'=>'U','ừ'=>'u','Ừ'=>'U',
'ử'=>'u','Ử'=>'U','ự'=>'u','Ự'=>'U','ụ'=>'u','Ụ'=>'U','ủ'=>'u','Ủ'=>'U','ữ'=>'u','Ữ'=>'U',
'Ŵ'=>'w','ŵ'=>'w',
'Ý'=>'y','ý'=>'y','ỳ'=>'y','Ỳ'=>'Y','Ŷ'=>'y','ŷ'=>'y','ÿ'=>'y','Ÿ'=>'y','ỹ'=>'y','Ỹ'=>'Y','ỷ'=>'y','Ỷ'=>'Y',
'Z̲'=>'Z','z̲'=>'z','Ź'=>'z','ź'=>'z','Ž'=>'z','ž'=>'z','Ż'=>'z','ż'=>'z','Ẕ'=>'Z','ẕ'=>'z',
'þ'=>'p','ŉ'=>'n','А'=>'a','а'=>'a','Б'=>'b','б'=>'b','В'=>'v','в'=>'v','Г'=>'g','г'=>'g','Ґ'=>'g','ґ'=>'g',
'Д'=>'d','д'=>'d','Е'=>'e','е'=>'e','Ё'=>'jo','ё'=>'jo','Є'=>'e','є'=>'e','Ж'=>'zh','ж'=>'zh','З'=>'z','з'=>'z',
'И'=>'i','и'=>'i','І'=>'i','і'=>'i','Ї'=>'i','ї'=>'i','Й'=>'j','й'=>'j','К'=>'k','к'=>'k','Л'=>'l','л'=>'l',
'М'=>'m','м'=>'m','Н'=>'n','н'=>'n','О'=>'o','о'=>'o','П'=>'p','п'=>'p','Р'=>'r','р'=>'r','С'=>'s','с'=>'s',
'Т'=>'t','т'=>'t','У'=>'u','у'=>'u','Ф'=>'f','ф'=>'f','Х'=>'h','х'=>'h','Ц'=>'c','ц'=>'c','Ч'=>'ch','ч'=>'ch',
'Ш'=>'sh','ш'=>'sh','Щ'=>'sch','щ'=>'sch','Ъ'=>'-',
'ъ'=>'-','Ы'=>'y','ы'=>'y','Ь'=>'-','ь'=>'-',
'Э'=>'je','э'=>'je','Ю'=>'ju','ю'=>'ju','Я'=>'ja','я'=>'ja','א'=>'a','ב'=>'b','ג'=>'g','ד'=>'d','ה'=>'h','ו'=>'v',
'ז'=>'z','ח'=>'h','ט'=>'t','י'=>'i','ך'=>'k','כ'=>'k','ל'=>'l','ם'=>'m','מ'=>'m','ן'=>'n','נ'=>'n','ס'=>'s','ע'=>'e',
'ף'=>'p','פ'=>'p','ץ'=>'C','צ'=>'c','ק'=>'q','ר'=>'r','ש'=>'w','ת'=>'t'
);

$accentsRemoved = strtr( $stringToRemoveAccents , $unwanted_array ); 
```

# java - 删除 JGroups 启动消息：GMS

> ID：1017604
> 
> 赞同：4
> 
> 时间：2009-06-19T12:07:49.023
> 
> 标签：java, jgroups

在启动 JGroups 2.7.0\. *GA 向System.out*写入一条消息，内容如下：

```
---------------------------------------------------------
GMS: address is 10.0.3.35:48641 (cluster=blabla)
--------------------------------------------------------- 
```

我想抑制它或使用 Log4j（框架的其余部分使用）重定向它。

想法？

* * *

我不想自己重定向 System.out ，因为这通常会导致比其价值更多的麻烦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-10T18:36:40.713

您可以通过在 XML 中设置来禁止打印 GMS 地址

> <pbcast.GMS print_local_addr="false" ...>

也适用于 JGroups 2.5.1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-08T01:30:35.577

这就是我设法将 GMS 字符串打印到日志的方式。

首先禁用

```
<pbcast.GMS print_local_addr="false"> 
```

然后，

```
String clusterName = channel.getClusterName();
String clusterAddress = channel.getAddressAsString();
String localAddress = channel.getProtocolStack()
        .dumpStats()
        .get("UDP")
        .get("local_physical_address")
        .toString();

StringBuilder border = new StringBuilder();
String GMS = String.format("GMS: address=%s, cluster=%s, physical address=%s", 
        clusterAddress, 
        clusterName, 
        localAddress
);
logger.info("{}", GMS); 
```

适用于**4.2.3.Final**版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:14:34.470

您不能将 System.out 重定向到没有意义的 log4j。毕竟 log4j 将如何打印任何东西？它会陷入一个循环。

# .net - Stopwatch.ElapsedTicks 和 Stopwatch.Elapsed.Ticks 是否始终相同？

> ID：1017608
> 
> 赞同：30
> 
> 时间：2009-06-19T12:08:21.503
> 
> 标签：.net, stopwatch

秒表类中的`ElapsedTicks`和是什么意思？`Elapsed.Ticks`什么时候意义可能与预期不同？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-09-17T13:45:25.593

我刚刚发现`ElapsedTicks`在`Stopwatch`课堂上并不意味着真正的“滴答声” if [`StopWatch.IsHighResolution`](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.stopwatch.ishighresolution)is `true`。

注意（如果`IsHighResolution`为真 - 来自[Microsoft Connect 链接（现已失效）](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=357164)）：

> 秒表刻度不同于 DateTime.Ticks。DateTime.Ticks 值中的每个刻度代表一个 100 纳秒的间隔。ElapsedTicks 值中的每个刻度表示等于 1 秒除以频率的时间间隔。

你可以做上面的数学，或者看起来你可以使用`StopWatch.Elapsed.Ticks`而不是`StopWatch.ElapsedTicks`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-22T07:35:05.307

```
Elapsed.Ticks / TimeSpan.TicksPerSecond == ElapsedTicks / Stopwatch.Frequency 
```

当然，由于四舍五入，这可能不完全相等，因为秒表刻度和 TimeSpan 刻度以不同的单位测量。此外，如果您按字面意思执行上述代码，显然在取 和 的值之间会经过一些滴答`Elapsed.Ticks`声`ElapsedTicks`。

# c# - 序列化问题

> ID：1017610
> 
> 赞同：2
> 
> 时间：2009-06-19T12:08:44.810
> 
> 标签：c#, .net, serialization

我有序列化问题。我想将对象转换为字符串，反之亦然。我有两种实用方法：

```
public
static byte[] Serialize(Object o)
{
   MemoryStream ms = new MemoryStream();
   BinaryFormatter bf1 = new BinaryFormatter();
   bf1.Serialize(ms, o);
   byte[] buffer = ms.ToArray();
   //string retStr = Convert.ToBase64String(buffer);
   return buffer;
}

public static object Deserialize(byte[] TheByteArray)
{
   //byte[] TheByteArray = Convert.FromBase64String(ParamStr);
   MemoryStream ms = new MemoryStream(TheByteArray);
   BinaryFormatter bf1 = new BinaryFormatter();
   ms.Position = 0;
   return bf1.Deserialize(ms);
} 
```

我的测试代码是：

```
Student obj = new Student ();
obj.UserName = "Admin";
obj.Password = "Password";
obj.lessonIds = new int[] { 1, 2, 3, 4, 5 };
obj.lessonNames= new string[] { "Spanish", "Maths" };
obj.Id= 43;
byte[] retByteArray = Crypto.Serialize(obj);

Student objNew = new Student ();
objNew = (Student )Crypto.Deserialize(retByteArray); 
```

此代码不起作用。错误消息是：调用的目标已引发异常。在解析完成之前遇到流结束。

结束我的主要目标是将对象转换为字符串，但我什至无法将其转换为字节数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:31:01.283

我刚刚尝试了原始代码，它工作正常，但是您需要确保学生类定义被标记为 [Serializable]

```
[Serializable]
public class Student
{
    public string UserName;
    public string Password;
    public int[] lessonIds;
    public string[] lessonNames;
    public int Id;
    public Student() { }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:28:10.370

您可能会遇到竞争状况，因为在完成序列化后您没有关闭内存流或格式化程序。

尝试这个：

```
public
static byte[] Serialize(Object o)
{
   using (MemoryStream ms = new MemoryStream())
   {
       BinaryFormatter bf1 = new BinaryFormatter();
       bf1.Serialize(ms, o);
       byte[] buffer = ms.ToArray();
       //string retStr = Convert.ToBase64String(buffer);
   }
   return buffer;
}

public static object Deserialize(byte[] TheByteArray)
{
   //byte[] TheByteArray = Convert.FromBase64String(ParamStr);
   using (MemoryStream ms = new MemoryStream(TheByteArray))
   {
       BinaryFormatter bf1 = new BinaryFormatter();
       ms.Position = 0;
       var result = bf1.Deserialize(ms);
   }
   return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:35:28.687

该代码对我来说非常有效（我只是添加了缺少的`Student`类。该代码实际上是否代表您的*真实*代码。特别是，缓冲区处理（可能是文件 IO）将是我的第一个怀疑。但错误不在您的代码中发布...它工作正常。

顺便说一句......`BinaryFormatter`可能很脆弱，尤其是在不同的版本中 - 您可能需要考虑替代序列化程序。如果您有兴趣，请询问更多信息。

在这里它是可运行的：

```
using System.IO;
using System.Runtime.Serialization.Formatters.Binary;
using System;
static class Crypto
{
    static byte[] Serialize(object o)
    {
        MemoryStream ms = new MemoryStream();
        BinaryFormatter bf1 = new BinaryFormatter();
        bf1.Serialize(ms, o);
        byte[] buffer = ms.ToArray();
        //string retStr = Convert.ToBase64String(buffer);
        return buffer;
    }

    public static object Deserialize(byte[] TheByteArray)
    {
        //byte[] TheByteArray = Convert.FromBase64String(ParamStr);
        MemoryStream ms = new MemoryStream(TheByteArray);
        BinaryFormatter bf1 = new BinaryFormatter();
        ms.Position = 0;
        return bf1.Deserialize(ms);
    }
    [Serializable]
    class Student
    {
        public string UserName { get; set; }
        public string Password { get; set; }
        public int[] LessonIds { get; set; }
        public string[] LessonNames { get; set; }
        public int Id { get; set; }
    }
    static void Main()
    {
        Student obj = new Student();
        obj.UserName = "Admin";
        obj.Password = "Password";
        obj.LessonIds = new int[] { 1, 2, 3, 4, 5 };
        obj.LessonNames = new string[] { "Spanish", "Maths" };
        obj.Id = 43;
        byte[] retByteArray = Crypto.Serialize(obj);

        Student objNew = (Student)Crypto.Deserialize(retByteArray);
    }
} 
```

# html - HTML 选择选项宽度在 IE 中被裁剪。有什么解决办法吗？

> ID：1017617
> 
> 赞同：7
> 
> 时间：2009-06-19T12:10:51.340
> 
> 标签：html, internet-explorer, html-select

在 Mozilla 和非 IE 浏览器中，如果选择列表选项的长度大于选择的宽度，它将显示出来。但在 IE 中，它会将选项裁剪为选择的宽度。

有什么办法可以让 IE 的选择行为像非 IE 浏览器那样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-22T18:20:56.117

这似乎在强制 IE 重新评估选择宽度方面效果很好。适用于 IE7 和 IE8。

```
if (jQuery.browser.msie) {
    jQuery("#" + selectID).css("width", "100%").css('width', 'auto');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-18T16:25:38.443

我喜欢 26design 的解决方案，但它有两个缺陷：

1.  在某些情况下，可能会触发鼠标悬停事件两次，从而导致 origWidth 变量设置为“自动”，从而防止选择恢复为原始大小。

2.  如果下拉列表中的文本值不需要额外的空间，则选择实际上会缩小，这看起来很奇怪。

此版本修复了这两个问题：

```
if($.browser.msie) {
    /* IE obscures the option text for fixed-width selects if the text 
     * is longer than the select. To work around this we make the width 
     * auto whenever the drop down is visible.
     */
    $("select.fixed-width").livequery(function(){
        /* Use mousedown rather than focus because the focus event gets 
         * interrupted and the dropdown does not appear 
         */
        $(this)
        .mousedown(function(){
            if($(this).css("width") != "auto") {
                var width = $(this).width();
                $(this).data("origWidth", $(this).css("width"))
                       .css("width", "auto");
                /* if the width is now less than before then undo */
                if($(this).width() < width) {
                    $(this).css("width", $(this).data("origWidth"));
                }
            }
        })
        /* Handle blur if the user does not change the value */
        .blur(function(){
            $(this).css("width", $(this).data("origWidth"));

        })
        /* Handle change of the user does change the value */
        .change(function(){
            $(this).css("width", $(this).data("origWidth"));

        });
    });
} 
```

在 IE6-8 中测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T12:16:36.900

CSS：

```
.set_width { width:120px; } 
```

html:

```
<select class="set_width"><option>one</option><option>two</option></select> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-05T10:56:04.473

I placed in a table cell, just trying to keep the same width with the cell.

```
$("#id" ).width($("#id" ).parent().width()); 
```

btw, thanks for all the posts, it helps me a lot.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-07T14:46:17.900

确保选择列表的宽度总是与它们需要的一样宽，最简单的方法是允许浏览器设置它们的宽度，即不要自己设置宽度。这种“方法”（实际上是一种非方法，因为它涉及*不*做某事）将适用于曾经制作的所有浏览器，甚至是 IE6。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-17T00:27:20.677

这是另一种对我有用的方法：

```
<style>
select.limited-width {
    width: 200px;
    position: static;
}

select.expanded-width {
    width: auto;
    position: absolute;
}
</style>

<select class="limited-width" 
        onMouseDown="if(document.all) this.className='expanded-width';"
        onBlur="if(document.all) this.className='limited-width';"
        onChange="if(document.all) this.className='limited-width';">

    <option>A normal option</option>
    <option>A really long option which messes everything up</option>
</select> 
```

通过切换到 position:absolute，您可以从页面流中删除元素，如果您发现选择框在展开时移动，这会有所帮助。

我选择依赖嗅探 document.all 作为对 IE 的检查，因为它保持紧凑并避免需要单独的函数。如果这对您不起作用，请在 IE 条件注释中定义一个函数并调用它。

一个小错误，如果您选择相同的元素，它不会再次缩小，直到您将焦点移动到另一个元素，我称之为功能;-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-31T07:48:43.693

我在表格单元格中有选择，下面的代码对我有用：

```
.myClass{
   width: 100%;//most of browsers
   _width: auto;//ie6 hack
} 
```

干杯

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-21T18:31:00.657

我有一个适合我的解决方案，所以我想我会继续发布它（底部有一些警告）。我敢肯定，这不是 jQuery 最有效的使用方式，但它正在按照我希望的方式工作。基本上，我有一个（显然）相当长的文本字符串的时区列表。

```
<!--[if IE]>
<script type="text/javascript">
    $(document).ready(function() {
        $("select.timeZone")
        .mouseover(function() {
            $(this)
                .data("origWidth", $(this).css("width"))
                .css("width", "auto")
                .focus();
        })
        .mouseout(function() {
            $(this)
                .blur(function() {
                    $(this).css("width", $(this).data("origWidth"));
                })
                .change(function() {
                    $(this).css("width", $(this).data("origWidth"));
                })
        });
    });
</script>
<![endif]--> 
```

**描述：**

*   仅针对 IE 浏览器有条件地设置。
*   此解决方案是 Chris Coyier ( [http://css-tricks.com/select-cuts-off-options-in-ie-fix/](http://css-tricks.com/select-cuts-off-options-in-ie-fix/) ) 提供的脚本的修改版本。
*   此外，此解决方案假定您和我一样，并不太关心 IE6。基本功能已经有了，所以 IE6 浏览器仍然可以看到大部分的选择选项、提交表单等，但我不能再浪费时间来安抚这个小小组了。

**注意事项：**

*   选择列表在获得焦点之前具有固定宽度。
*   Onmouseout，列表必须在大小设置回原始固定宽度之前进行模糊或更改。我确保选择列表首先模糊或更改的原因是因为以前，一旦您的鼠标离开选择框，onmouseout 就会触发（这意味着您可以尝试选择一个选项，但它们会在您单击之前消失）。
*   相反，在鼠标悬停时，焦点设置为确保正确触发模糊事件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-23T15:19:08.717

此处描述的最佳解决方案：http: [//www.dougboude.com/blog/1/2008/05/Viewing-Option-Text-in-IE7-thats-Wider-than-the-Select-List.cfm](http://www.dougboude.com/blog/1/2008/05/Viewing-Option-Text-in-IE7-thats-Wider-than-the-Select-List.cfm)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-18T05:36:43.793

好的，这是我经过一段时间后想出的解决方案。它将根据子选项的最大宽度自动增加选择框的大小。

```
<script type="text/javascript">
  window.onload = function()
  {
    var elem = document.getElementById('test');
    var values = elem.length;
    var biggest_value = 0;
    var biggest_option = '';

    for(var i = 0; i <= values; i++)
    {
      if (elem.options[i])
      {
        var len = elem.options[i].value.length;
      }

      if (biggest_value < len)
      {
        biggest_value = len;
        biggest_option = elem.options[i];
      }
    }

    document.getElementById('test').style.width = biggest_option.offsetWidth + 'px';

};
</script> 
```

选择框：

```
<select id="test">
 <option value="Hello">Hello</option>
 <option value="Hello Again">Hello Again</option>
 <option value="Hello Yet Again">Hello Yet Again</option>
</select> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-05-04T01:41:23.950

```
for (i=1;i<=5;i++){
       idname = "Usert" + i;
       document.getElementById(idname).style.width = "100%";

} 
```

当宽度显示不正确时，我使用这种方式显示下拉列表。

它适用于 IE6、Firefox 和 Chrome。

# python - 为什么 Python 不适合函数式编程？

> ID：1017621
> 
> 赞同：328
> 
> 时间：2009-06-19T12:12:06.597
> 
> 标签：python, functional-programming

我一直认为函数式编程可以用 Python 完成。[因此，我很惊讶 Python 在这个](https://stackoverflow.com/questions/1015606/mixing-object-oriented-and-functional-programming)问题中没有得到太多提及，而且当它被提及时，它通常不是很积极。然而，对此并没有给出太多的理由（没有提到模式匹配和代数数据类型）。所以我的问题是：为什么 Python 不适合函数式编程？除了缺乏模式匹配和代数数据类型之外，还有更多的原因吗？还是这些概念对函数式编程如此重要以至于不支持它们的语言只能归类为二流函数式编程语言？（请记住，我在函数式编程方面的经验非常有限。）

* * *

## 回答 #1

> 赞同：400
> 
> 时间：2009-06-19T13:22:56.423

您引用的问题询问哪些语言促进了面向对象和函数式编程。Python 并不*提倡*函数式编程，尽管它*工作*得相当好。

*在 Python 中反对*函数式编程的最佳论据是 Guido 仔细考虑了命令式/OO 用例，而函数式编程用例则没有。当我编写命令式 Python 时，它是我所知道的最漂亮的语言之一。当我编写函数式 Python 时，它变得像没有[BDFL](http://en.wikipedia.org/wiki/Benevolent_Dictator_for_Life)的普通语言一样丑陋和令人不快。

这并不是说它不好，只是如果你切换到一种促进函数式编程的语言或切换到编写 OO Python 时，你必须比你更努力地工作。

以下是我在 Python 中错过的功能性东西：

*   [模式匹配](http://learnyouahaskell.com/syntax-in-functions#pattern-matching)
*   [尾递归](http://book.realworldhaskell.org/read/functional-programming.html#fp.loop)
*   [大型列表函数库](https://hackage.haskell.org/package/base/docs/Data-List.html)
*   [功能字典类](https://hackage.haskell.org/package/containers/docs/Data-Map.html)
*   [自动咖喱](http://learnyouahaskell.com/higher-order-functions#curried-functions)
*   [编写函数的简洁方法](http://learnyouahaskell.com/higher-order-functions#composition)
*   惰性列表
*   简单、强大的表达式语法（Python 的简单块语法阻止 Guido 添加它）

* * *

*   没有模式匹配和尾递归意味着您的基本算法必须以命令方式编写。递归在 Python 中既丑陋又慢。
*   一个小的列表库和没有功能字典意味着你必须自己写很多东西。
*   没有用于柯里化或组合的语法意味着无点样式与显式传递参数一样充满标点符号。
*   迭代器而不是惰性列表意味着你必须知道你想要效率还是持久性，`list`如果你想要持久性，就分散调用。（迭代器是一次性的）
*   Python 简单的命令式语法，连同其简单的 LL1 解析器，意味着对于 if 表达式和 lambda 表达式来说更好的语法基本上是不可能的。Guido 喜欢这样，我认为他是对的。

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2009-06-19T12:20:18.700

[Guido 对此有很好的](http://python-history.blogspot.com/2009/04/origins-of-pythons-functional-features.html)解释。这是最相关的部分：

> 无论人们怎么说或怎么想，我从来没有认为 Python 会受到函数式语言的严重影响。我对 C 和 Algol 68 等命令式语言更加熟悉，虽然我将函数作为一等对象，但我并不认为 Python 是一种函数式编程语言。然而，在早些时候，很明显用户希望对列表和函数做更多的事情。
> 
> ...
> 
> 还值得注意的是，尽管我没有将 Python 设想为一种函数式语言，但闭包的引入对许多其他高级编程特性的开发很有用。例如，新型类、装饰器和其他现代特性的某些方面依赖于这种能力。
> 
> 最后，尽管多年来已经引入了许多函数式编程特性，但 Python 仍然缺乏“真正的”函数式编程语言中的某些特性。例如，Python 不执行某些类型的优化（例如，尾递归）。一般来说，由于 Python 的动态特性，不可能进行 Haskell 或 ML 等函数式语言中已知的那种编译时优化。这很好。

我从中提取了两件事：

1.  该语言的创建者并不真正认为 Python 是一种函数式语言。因此，可能会看到“功能性”功能，但您不太可能看到任何明确功能的东西。
2.  Python 的动态特性抑制了您在其他函数式语言中看到的一些优化。当然，Lisp 和 Python 一样动态（如果不是更动态的话），所以这只是部分解释。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2009-06-19T12:24:44.200

Scheme 没有代数数据类型或模式匹配，但它肯定是一种函数式语言。从函数式编程的角度来看，关于 Python 的恼人之处：

1.  残废的拉姆达斯。由于 Lambda 只能包含一个表达式，并且您不能在表达式上下文中轻松完成所有操作，这意味着您可以“动态”定义的函数是有限的。

2.  if 是语句，而不是表达式。这意味着，除其他外，您不能有一个带有 If 的 lambda。（这在 Python 2.5 中由三元组修复，但看起来很难看。）

3.  Guido每隔一段时间就威胁要[删除 map、filter 和 reduce](https://www.artima.com/weblogs/viewpost.jsp?thread=98196)

另一方面，python 具有词法闭包、Lambda 和列表推导（无论 Guido 是否承认，它们实际上都是一个“函数式”概念）。我在 Python 中做了很多“函数式”编程，但我很难说它是理想的。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-06-19T13:35:43.510

我永远不会称 Python 为“函数式”，但每当我用 Python 编程时，代码总是以几乎纯粹的函数式结束。

不可否认，这主要是由于非常好的列表理解。因此，我不一定会建议将 Python 作为一种函数式编程语言，但我会建议任何使用 Python 的人进行函数式编程。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-06-19T14:50:09.383

让我用一段代码进行演示，该代码取自对 SO 上的“功能性” [Python 问题的回答](https://stackoverflow.com/questions/1016997/generate-from-generators/1017105#1017105)

Python：

```
def grandKids(generation, kidsFunc, val):
  layer = [val]
  for i in xrange(generation):
    layer = itertools.chain.from_iterable(itertools.imap(kidsFunc, layer))
  return layer 
```

哈斯克尔：

```
grandKids generation kidsFunc val =
  iterate (concatMap kidsFunc) [val] !! generation 
```

这里的主要区别在于 Haskell 的标准库具有对函数式编程有用的函数：在这种情况下`iterate`, `concat`, 和`(!!)`

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-07-09T18:48:46.360

对于这个问题（以及答案）来说，真正重要的一件事是：函数式编程到底是什么，它最重要的属性是什么。我将尝试给出我的看法：

函数式编程很像在白板上写数学。当你在白板上写方程时，你不会考虑执行顺序。（通常）没有突变。你不会在第二天回来查看它，当你再次进行计算时，你会得到不同的结果（或者你可能会，如果你喝了一些新鲜的咖啡:)）。基本上，黑板上的内容就在那里，当你开始写东西时，答案已经在那里，只是你还没有意识到它是什么。

函数式编程很像。您无需更改任何内容，只需评估方程式（或在本例中为“程序”）并找出答案。该程序仍然存在，未修改。数据也是一样。

我将以下列为函数式编程最重要的特征： a) 引用透明性——如果您在其他时间和地点评估相同的语句，但使用相同的变量值，它的含义仍然相同。b) 没有副作用——无论你盯着白板多久，另一个人正在看另一个白板的等式不会意外改变。c) 函数也是值。它可以传递并与其他变量一起应用或应用于其他变量。d) 函数组合，你可以做 h=g·f 从而定义一个新的函数 h(..) 相当于调用 g(f(..))。

这个列表是按照我的优先顺序排列的，所以引用透明度是最重要的，其次是没有副作用。

现在，如果您通过 python 并检查语言和库对这些方面的支持和保证程度 - 那么您就可以回答自己的问题了。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-19T12:22:40.973

Python 几乎是一种函数式语言。它是“功能精简版”。

它具有额外的功能，因此对某些人来说不够纯净。

它还缺少一些功能，因此对于某些人来说还不够完整。

缺少的功能相对容易编写。在 Python 中的 FP 上查看类似的帖子[。](http://blog.sigfpe.com/2008/02/purely-functional-recursive-types-in.html)

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2016-06-10T19:56:05.797

上面没有提到的另一个原因是许多内置函数和内置类型的方法修改了一个对象，但不返回修改后的对象。如果返回那些修改过的对象，那将使功能代码更简洁。例如，如果 some_list.append(some_object) 返回 some_list 并附加了 some_object。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-02-06T01:16:27.527

除了其他答案之外，Python 和大多数其他多范式语言不太适合真正的函数式编程的一个原因是因为它们的编译器/虚拟机/运行时不支持函数优化。这种优化是通过编译器理解数学规则来实现的。例如，许多编程语言都支持`map`函数或方法。这是一个相当标准的函数，它将一个函数作为一个参数，将一个可迭代对象作为第二个参数，然后将该函数应用于可迭代对象中的每个元素。

无论如何，事实证明这`map( foo() , x ) * map( foo(), y )`与`map( foo(), x * y )`. 后一种情况实际上比前者更快，因为前者执行两个副本，而后者执行一个。

更好的函数式语言可以识别这些基于数学的关系并自动执行优化。不专用于函数范式的语言可能不会优化。

# language-agnostic - 什么时候函数名太长？

> ID：1017624
> 
> 赞同：48
> 
> 时间：2009-06-19T12:12:22.040
> 
> 标签：language-agnostic, naming-conventions

在可能的情况下，我尽量用我的函数名称来描述。这有时会导致函数名称在 20 到 30 个字符范围内，例如`GetActionFromTypeName`或`GetSelectedActionType`。什么时候函数变得太长而无法管理（对于编译器来说不是太长）？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-06-19T12:16:21.330

如果有一个更短但描述性的方法来命名函数，那么函数名就太长了。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-19T12:16:02.250

当你不能再大声朗读它们而不在中间呼吸时=D

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-06-19T12:17:14.073

当函数名开始过度描述其功能或妨碍代码的可读性时，函数名就会太长。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-06-19T12:28:55.937

1.  如果您必须向右滚动才能阅读它。
2.  描述了 3 件或更多的事情——它不应该做那么多事情。
3.  你的老板认为它太长了。
4.  它比代码本身更长。
5.  它以 Get 开头，就像其他 500 个函数一样。
6.  没有人愿意使用它。
7.  还有另一个功能可以使用用户理解的较短名称来执行相同的操作。
8.  它可以做得更短。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-06-19T12:14:38.870

当它没有做它所说的*一切时。*;)

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-06-19T12:16:46.947

The FunctionNameBecomesTooLongWhenItBecomesTooHardToReadItAndUnderstandIt，另一方面它_dependends_on_nameing_convention_how_hard_function_reading_is_sometimes_long_names_are_readable。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-06-19T12:15:57.010

当你开始思考时:)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-06-19T12:19:29.653

如果函数名“太长”，那么很可能是函数本身也太长，责任太大。许多聪明的程序员说一个函数应该做一件事而且只做一件事。一个函数的名称必须很长才能准确地描述它的作用，这很可能是重构为[多个更小更简单的私有函数](http://c2.com/cgi/wiki?ShortMethods)的良好候选者，这些私有函数因此具有更短的名称。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-06-19T12:38:05.030

来自[Code Complete](http://en.wikipedia.org/wiki/Code_Complete)（第 1 版，第 188 页）

“Gorla、Benander 和 Benander 发现，当变量的名称平均为 10 到 16 个字符时（1990 年），调试 COBOL 程序所需的工作量最小化。名称平均为 8 到 20 个字符的程序几乎同样容易调试。”

这是我见过的关于变量名称长度合理指南的唯一实证讨论。其他一切都取决于意见和舒适度。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-06-19T12:16:12.390

我不认为方法名称可以太长，只要它是描述性的。如果方法名称超过 40 个字符，我会看看是否可以用更少的词表达相同的含义。如果不是，为了清楚起见，我将使用长名称。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-06-19T12:36:20.353

这可能有点离题，但是当您专门询问*函数*名称指南（而不是说方法）时，我想我会引用 Linus Torvalds 的命名（虽然它更多地指的是变量，但仍然 - 原则成立）。

> 第 3 章：命名
> 
> C 是一种斯巴达语言，您的命名也应该如此。与 Modula-2 和 Pascal 程序员不同，C 程序员不使用像 ThisVariableIsATemporaryCounter 这样可爱的名字。AC 程序员会称这个变量为“tmp”，它更容易编写，而且更难理解。

简短的描述性名称与简短的特定功能相得益彰……这与代码重用相得益彰。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-06-19T12:16:19.693

我想说的是，当您发现自己在提及他们时会发现他们名字的缩写时。当人们开始在名称中描述前置/后置/参数条件或提供有关实现的提示时，我也发现它太多了。（喜欢`getVersionInformationFormTheDatabase()`或`doSomethingWithoutCheckingFooFirst()`）

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-06-19T12:16:11.127

在我看来，函数名称应该与描述其用途所需的长度一样长。如果你认为函数的名字太长，那么这可能表明它试图做太多的事情，应该重构。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-06-19T12:17:00.267

恕我直言，功能的描述性更为重要。IDE 有助于避免拼写错误或类似的麻烦。我认为有时使用缩写是可以的，只要它们在代码中是一致的（同一事物没有不同的缩写，两个不同事物也没有相同的缩写。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-06-19T12:14:35.640

只要这些功能确实按照他们的名字所暗示的那样做，而且你不会去打高尔夫球的代码，我认为这是一件好事。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-06-19T12:23:25.637

我认为您应该更多地担心函数名称何时太短或描述性不够。只要您的函数执行其名称所描述的（以及其名称所描述的*所有内容*），它就是名副其实的。我经常编写具有长名称的函数，例如 getPropertyNameArrayFromObject（尽管我倾向于下划线而不是驼峰式），它可以称为 getObjPropArr 或其他名称，但不会像描述性那样具有描述性。我倾向于远离缩写，因为当你去做其他事情并回到代码时，它们会变得模棱两可。

另一方面，考虑许多内置的 PHP 函数，例如 stricmp，它们实际上应该按照 caseInsensitiveStringComparison 的方式命名。

在某些情况下，我故意编写了非常短的函数名，根本没有描述性。有时我只想要一个简短的 JavaScript 函数作为快捷方式。例如，我通常将 $(id) 别名为 document.getElementById(id)，因为我厌倦了输入它。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-06-19T12:30:06.153

啊，一个没有答案的问题！

我倾向于发现如果我不能用几句话来概括它，那么设计就有问题（来自 Code Complete 的旁白）。

所以虽然我很高兴，但`FindArticlesWithoutTitles`我可能会厌恶`FindArticlesWithoutTitlesThenApplyDefaultStyles`。这是错误的；要么名称太专业，没有描述它的实际功能（没有文章的标题通常需要固定样式，所以这将是`FixArticleStyles`）或者它应该是两个功能：`FindArticlesWithoutTitles/ApplyDefaultStyles`.

另外：频率与它有很大关系。如果经常使用，我希望它简短，以减少代码的眩光；冗长的重复名称使代码难看，打字也很痛苦。如果我总是发现`FindArticlesWithoutTitles`我可能只是根据适当的上下文缩短到`FindNoTitles`，或者即使`FindArticles`我没有其他文章查找功能。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-06-19T12:36:22.803

当它包含从上下文中显而易见的信息（例如，incrementInteger(int x)、long longID）、无用的（例如，ObsoleteIncrementer、RobertsCarFactory）、难以理解的（例如，TheFunctionThatRobertWorkedOnLastWeekButDidntFinish）、数字（例如，id1、id2、id3）或其他信息时无助于理解或包含代码异味。请注意，即使上述名称的某些部分应该被删减，您可能需要用有用的信息填充它们以保持它们的唯一性并使其易于理解，例如 id1 的 person_id、id2 的雇主 ID 等。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-06-19T12:37:47.370

函数名称太长，如果使用较短的名称可以节省您的工作量。

我们通常使用描述性函数名称的原因是因为它可以节省我们的工作量。（通过使代码更容易理解和维护）。所以从逻辑上讲，你不应该给你的函数命名太长以至于花费你额外的时间（例如，使代码更难阅读）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-06-19T12:18:03.307

我认为这对于公共名称尤其重要——它们不应该太长，但是太长有多长是非常主观的。总是有一个更长的描述性的名字比一个太短的名字更好。
对于私有方法，我认为即使很长的名称也没有问题。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-06-19T13:13:57.313

问自己一个更有趣的问题：为什么我们要让函数名变长？这是为了描述函数的作用。好吧，我提出这个假设：

> 函数名中所需的描述量与可用的类型信息量成反比。

为了说明这一点，如果你看到这样的函数......

```
public <A> A id(A a); 
```

……你认为它有什么作用？类型信息告诉你你需要知道的一切。除非有副作用和异常，*这个函数只能做一件事。*

当然，您可能正在使用一种允许不受限制的副作用的语言，因此该函数可以写入文件。但如果是这样，*那么它的类型就是谎言*。使用在类型中声明效果的语言允许您使用非常简洁的名称，而不会失去任何描述性。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-06-19T13:23:11.553

有时，在 Oracle SQL 和 PL/SQL 的许多上下文中，30 个字符的限制感觉像是一个可怕的限制，但回想起来，它让我们多次努力思考如何命名事物，以便阅读代码的人快速理解它们之后。

如果我们不能在不使用过多缩写的情况下使用 30 个字符来充分描述表、视图、函数、过程、包等的用途，那么它只需要更多的思考，也许还需要一个额外的抽象层来对相关的事物进行分组一起。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-06-19T13:37:39.090

当开发人员忘记参数的描述性（假设有意义的参数和变量名称）时，函数和方法名称开始变得太长。例如：

```
 my $template = HTML::Template->new( filename => 'home.html'); 
 $template->param( title => 'Home Page' );
 $html = $template->output; 
```

即使您不了解 Perl 并且从未听说过[HTML::Template](http://search.cpan.org/perldoc?HTML::Template) ，它的作用也是透明的。

我经常看到将这种`output`方法命名为`RenderHTMLViewFromTemplateObject`. 如果使用的所有库都具有这样的命名约定，那么我根本无法理解正在发生的事情。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-06-19T12:20:01.230

尽量避免主观性：

当名称大约是您的典型行长的 1/3 时，您就在拉伸它。在 1/2 的行长处，你已经走得太远了。当名称占据整行时，每行一个语句会变得非常困难。

除此之外，大多数 IDE 都支持完成（从而使程序员不必完全输入大多数名称），所以在我看来，更重要的是确保名称尽可能唯一。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-06-19T12:24:20.347

方法名称可能非常长，具体取决于语言（[最大方法名称长度](https://stackoverflow.com/questions/425988/maximum-method-name-length)）。在某些时候，您将使用该函数或方法并为函数名称输入一个句子似乎是不必要的。

保持代码可维护，改用注释。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-06-19T12:27:39.217

如果编译器对变量名有一些限制，它通常是 64 或 128 个字符或介于两者之间。过去，32个角色也很受欢迎。如果他们确实有限制，他们通常只取前 n 个字符而忽略其余字符。

一般规则是函数名称提供了它正在做什么的非常简短的描述。大多数这样的描述应该很容易适应 32 个字符。（使用 CamelCase 分隔单词。）由于大多数 IDE 现在都提供代码完成功能，因此函数名称出错的情况很少见。但是，通过确保大多数函数的前 8 个字符彼此不同，让自己更容易。应避免使用 DateCalculationAddMonth、DateCalculationAddWeek、DateCalculationAddYear 和 DateCalculationAddDay 之类的东西。使用 AddMonthDateCalculation、AddWeekDateCalculation、AddYearDateCalculation 和 AddDayDateCalculation。（顺便说一句，这些都是愚蠢的例子，但我希望你能理解我的想法。）

实际上，将函数添加（分组）到单独的类中可能会更好。对于上面的愚蠢示例，您可以只创建一个 DateCalculation 类并向该类添加四个（静态/类）函数（AddMonth、AddWeek、AddYear 和 AddDay）。基本上，当您有许多相似的函数时，如果您不将它们组合在单独的类中，这些函数的名称都会很长，这会更有用。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-06-19T12:50:18.673

IMO，当它有一个连词时，它太长了。“When”、“And”、“Then”……诸如此类。遵循“单一职责规则”应该允许函数名称足够长以具有描述性，并且足够短而不会令人讨厌。

# objective-c - 为什么不用“with”来启动便利构造函数呢？

> ID：1017652
> 
> 赞同：8
> 
> 时间：2009-06-19T12:18:29.720
> 
> 标签：objective-c, cocoa

我最喜欢 Cocoa 的一件事是可读性因素。

最让我烦恼的一件事是便利构造函数强制重复的约定。

这是一个例子：

```
[NSString stringWithString:s]

[NSNumber numberWithDouble:d]

[NSValue valueWithInt:i]

[NSDictionary dictionaryWithObjectsAndKeys:<blah>] 
```

等等

为什么约定不简单地用“with”这个词来启动便利构造函数？所以我们会有：

```
[NSString withString:s]

[NSNumber withDouble:d]

[NSValue withInt:i]

[NSDictionary withObjectsAndKeys:<blah>] 
```

等等

这是一个小讨论点，但我想我会扔在那里，看看是否有比我更有影响力的人可以解释我脑海中的所有回声。

显然，我不会请求 AAPL 重写 appKit 以支持我的建议，但是有没有反对将我自己的便利构造函数命名为这样的论点？

当然，我可以在自己的代码中使用我想要的任何约定，但我讨厌盲目地逆流而上。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-20T07:19:46.543

There is actually a technical reason for it to be that way. If every `shoelaceWithString:`-type method were changed to just `withString:`, we would end up with a fearsomely huge number of classes with identically named methods and different signatures. This plays mean tricks on the compiler's static type checking and can cause it to throw up all sorts of annoying and unnecessary warnings.

There's also an aspect of Cocoa culture where developers like their code to be self-documenting. This means that method names indicate both what their arguments are and what they return. Apple's coding guidelines actually warn about methods with vague names, suggesting that adding words to the name to make it clear what a method does is preferable.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-19T13:11:15.883

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T12:27:27.657

我认为这只是 Cocoa 框架的一般“说出你的意思”的冗长哲学的一部分。几个选择：

```
[UIView setAnimationBeginsFromCurrentState]
[UITableView scrollToNearestSelectedRowAtScrollPosition]
[UIApplication didRegisterForRemoteNotificationsWithDeviceToken] 
```

等等

预计到达时间：

要专门回答有关构造函数的问题，我喜欢它们完成方式的一件事是，在 x 代码中很容易识别哪些方法是构造函数类型方法。例如，您开始输入：

```
[NSString string 
```

并且“智能感知”将方法列表缩减为以“字符串”开头的方法列表，这些方法当然是所有构造函数方法（并且所有这些方法都方便地组合在一起）。同样的事情也适用于“init”约定。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T21:21:03.843

Ultimately, I believe the Objective-C philosophy, as embodied by the Cocoa frameworks (and the NextStep frameworks before it) is that being explicit, and easy to maintain takes precedence over terseness of code. The main evidence for this philosophy is that Objective-C selectors have named arguments (e.g. `-[NSObject performSelector:withObject:]`).

In the case of factory methods such as `+[NSString stringWithString:]`, you must remember that subclasses may override these class methods to return subclasses (for example class clusters such as `NSNumber`).

So, you may end up with a call like `[MyPoorlyNamedSubclass stringWithString:]` in which case `-[MyPoorlyNamedSubclass withString:]` would not be obviously informative as to the type of object returned (recall that many factory methods return type `id`). `stringWithString:`, on the other hand makes it clear that the method will return a string (or subclass thereof).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-22T03:31:59.667

They also use that one extra word to tell if the object is autoreleased or not. initWithFormat is for non-autoreleased, and when its stringWithFormat it is autoreleased... I guess they just went with that way of telling the reader what kind of memory management the object uses...

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-06-19T12:24:31.250

如果你不喜欢它，为什么不写一堆你在所有项目中包含的#define 语句呢？

# nhibernate - ProxyFactoryFactoryNotConfiguredException，而lazy为假

> ID：1017656
> 
> 赞同：3
> 
> 时间：2009-06-19T12:19:00.013
> 
> 标签：nhibernate

我正在使用 NHibernate 并获得一段`ProxyFactoryFactoryNotConfiguredException`时间的通话`_factory.BuildSessionFactory();`。我默认禁用了惰性，并且没有映射为惰性的属性。无论如何都需要代理工厂吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-10T15:56:27.703

这个配置设置现在是强制性的，下面的链接讨论了如何设置这个位。

[http://nhibernate.info/blog/2008/11/09/nh2-1-0-bytecode-providers.html](http://nhibernate.info/blog/2008/11/09/nh2-1-0-bytecode-providers.html)

# security - Feedly 如何确定 Twitter 名称？

> ID：1017659
> 
> 赞同：1
> 
> 时间：2009-06-19T12:19:45.737
> 
> 标签：security, twitter, feedly

在试用[http://www.feedly.com/](http://www.feedly.com/)时，我注意到它会自动识别出我的 Twitter 名称。如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T12:26:10.110

作为 Firefox 插件，它可以访问您的 cookie，因此，当您登录 twitter 时，它可以访问您的 twitter 帐户名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T12:26:15.333

由于它作为浏览器插件运行，我假设它使用您现有的登录 cookie 向 twitter 发出网络请求（由于安全限制，网站不允许使用该 cookie）并获取您的 twitter 用户名作为响应的一部分.

# php - php变量问题

> ID：1017672
> 
> 赞同：0
> 
> 时间：2009-06-19T12:22:34.687
> 
> 标签：php

是否可以使用某种 reg 表达式或某种其他类型的代码创建一个变量来完成以下任务？

例如，var test = parta 中的数据也可以等于 partm。注意我不想要一个数组...

我在 sql 搜索中使用它，但我有 1000 种不同的模型和系列，只想返回某些系列的模型而不返回类似于输入的系列......

有没有什么东西可以让第五个字符成为所需字符的列表......？

另一个例子我有模型

同系列的两个型号

515-n

515m

不同系列的型号 1515

如果我搜索 515 系列，我不想返回 1515...

请注意，这不是唯一的组合...因此不能将搜索指定为仅此组合...需要是通用结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:32:42.217

通常您会使用 SQL LIKE 语法在数据库中查找信息。我不确定你会使用 PHP。如果您要搜索以 515 开头的所有型号，您将使用以下内容：

```
SELECT * FROM `models` WHERE model_name LIKE '515%'; 
```

请注意，百分比仅在右侧，因此找不到 1515。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:49:29.577

我认为这足以（几乎）成为现实世界的解决方案：

```
function isModel($prefix,$input)
{
    return preg_match("/^" . $prefix . "\s*-?\s*?[nm]/", $input);
} 
```

一些测试用例：

```
isModel('5155', '5155n'); // "1"
isModel('515','515-n'); // "1"
isModel('789','789 - m'); // "1"
isModel('111','111    -n'); // "1" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:30:01.037

```
preg_match('/\b515\b-?(?:n|m)/', $model) 
```

一般：

```
preg_match('/\b' . $model_number . '\b-?(?:' . join('|', $array_of_series_letters) . ')/', $model) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T12:33:14.917

您可以使用 SQL 通配符来匹配某些模式，但它远不如正则表达式灵活。以下是可用的通配符规则：

```
%    A substitute for zero or more characters

_    A substitute for exactly one character

[charlist]   Any single character in charlist

[^charlist]
or
[!charlist]  Any single character not in charlist 
```

在您的示例中，您可以在 SQL WHERE 子句中使用以下任何内容：

```
WHERE model LIKE '515%' <--matches 515 followed by zero or more characters

WHERE model LIKE '515-[nm]' <--matches 515-n and 515-m only

WHERE model LIKE '515%[nm]' <--matches 515n and 515-m, also would match 515Qm 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T12:37:52.987

如果可以的话，我总是建议避免使用正则表达式。在这种情况下，您很容易拥有一个模型和对该模型的有效扩展。Sou 您只需要检查字符串是否以所需的模型字符串开头并以任一有效扩展名结尾：

```
$string = '515-n';
$possibleExtensions = array('-n', 'm');
$model = '515';
$isDesiredModel = strpos($string, $model) === 0 &&
    in_array(substr($string, strlen($model)), $possibleExtensions); 
```

# linq-to-sql - 如何用 LinQ to SQL 编写？

> ID：1017687
> 
> 赞同：1
> 
> 时间：2009-06-19T12:25:49.517
> 
> 标签：linq-to-sql

```
SELECT P.ProductId, P.ProductCategoryId, P.ParentProductCategoryId, 
       P.ProductName, PC.Name AS Category, P.Price, P.ProductYear
FROM   dbo.ProductCategory AS PC 
INNER JOIN
  (SELECT dbo.ProductCategory.ParentProductCategoryId, 
          dbo.ProductCategory.ProductCategoryId, 
          dbo.ProductCategory.Name AS CategoryName, 
          dbo.Product.ProductId, 
          dbo.Product.Price, 
          dbo.Product.Name AS ProductName, 
          dbo.Product.ProductYear
   FROM dbo.Product 
   INNER JOIN dbo.ProductCategory 
   ON dbo.ProductCategory.ProductCategoryId = dbo.Product.ProductCategoryId
  ) AS P 
ON PC.ProductCategoryId = P.ParentProductCategoryId 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:36:29.887

我不太确定您的数据库布局，但 LINQ 语句看起来像这样......

```
YourDataContext db = new YourDataContext();

var query =
    from p in db.Products
    join pc in db.ProductCategories on p.ProductCategoryId equals pc.ProductCategoryId 
    select new 
    {
        p.ProductId,
        p.ProductCategoryId,
        p.ParentProductCategoryId,
        p.ProductName,
        Category = pc.Name,
        p.Price,
        p.ProductYear 
    } 
```

# iphone - iPhone 蓝牙功能是否在 OS 3.0 中受限？

> ID：1017688
> 
> 赞同：2
> 
> 时间：2009-06-19T12:26:01.140
> 
> 标签：iphone, bluetooth

一个简单的问题。是否可以在 iPhone 中使用蓝牙将文件传输到诺基亚或黑莓等其他手机。我今天测试了 iPhone 的蓝牙功能。我发现可以在发现模式下检测到其他手机。但在其他设备中未检测到 iPhone。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T08:13:48.090

iPhone 不支持在不同制造商制造的设备之间发送/接收文件所需的 GOEP/FTP 蓝牙配置文件。如果您只需要在 iPhone 之间共享文件，您可以使用 iPhone SDK 中的 GameKit 框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:38:56.447

从 WWDC 上显示的内容来看，文件传输可能仅限于 iPhone 间传输。即使这样，我相信您可以发送的文件类型也是有限的。例如，您可能只能发送文档文件（word、excel）、联系人、图片和非 DRM 媒体文件。

但是，我在 3.0 SDK 中找不到任何关于蓝牙文件传输的文档，所以请稍加注意。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:48:59.890

我也会对您所针对的特定版本的 iPhone 保持警惕。

我昨天在升级时发现原来的 iPhone 2G 不支持 A2DP 立体声蓝牙音频，所以我敢打赌，除了基本的单声道耳机之外，您可能会遇到任何蓝牙操作的其他问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T15:21:44.577

iPhone SDK 的 GameKit 框架提供了一种仅与其他 iPhone 检测和交换数据的方法。所以你无法与诺基亚和黑莓进行交流。

现在，如果您想向其他 iPhone 发送数据，我认为您可以发送的数据类型没有限制。因为要发送数据，您可以使用：

```
NSData* myData = [[NSData alloc] initWithBytes:&<yourData> length:sizeof(<yourData>)];
[session sendDataToAllPeers:myData withDataMode:GKSendDataReliable error:nil]; 
```

NSData 对象显然可以是您想要的任何东西，因为它只是字节。唯一的问题可能是 GameKit 对对象长度的限制，但您可能会通过将数据拆分成块来绕过它。

# delphi - 使用 dll 中的函数

> ID：1017692
> 
> 赞同：1
> 
> 时间：2009-06-19T12:26:38.797
> 
> 标签：delphi, dll

我有一个 dll 和一个库文件来使用 Dll。在一个文件中

```
 TOnPortStatusChanged = procedure (cardNo:integer; portNo:integer; newPortStatus:byte); stdcall;
  TOnPortDataReady =  procedure (cardNo:integer; portNo:integer; dataBuff:PByteArray; buffLen:integer); stdcall;

  T_API_INIT_PARAMS = record
       OnPortStatusChanged :TOnPortStatusChanged;
       OnPortDataReady :TOnPortDataReady ;
  end;
  P_API_INIT_PARAMS = ^T_API_INIT_PARAMS ;
//....
//...
var
  PR_Init: function (initParams: P_API_INIT_PARAMS):integer; stdcall; 
```

当我想在我的程序中使用这个函数时，我的代码：

```
procedure PortStatusChanged(cardNo: integer; portNo: integer; newPortStatus: byte); stdcall;
begin
  //...
end;

procedure TMainThread.CheckDevices;
var
  vCount: integer;
  initParams: T_API_INIT_PARAMS;
begin
  initParams.OnPortStatusChanged := PortStatusChanged;
  initParams.OnPortDataReady := nil;
  vCount := PR_Init(@initParams); 
```

这很好用。但我想在 TMainThread 类中使用 PortStatusChanged 过程。所以我在 TMainThread 类中编写程序并像这样更改 TOnPortStatusChanged 类型：

```
TOnPortStatusChanged = procedure (cardNo:integer; portNo:integer; newPortStatus:byte) of object; stdcall; 
```

当我以这种方式运行我的程序时；PortStatusChanged 第一次工作正常，但第二次它给出了访问冲突错误。

我在哪里犯错？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T15:29:23.157

更改应用程序中回调函数的类型不会神奇地更改 DLL 期望接收的类型。DLL 期望接收一个普通的函数指针，所以这就是您需要提供的。您自己代码中的声明需要与 DLL 代码在编译时出现的声明相匹配，但没有什么可以强制执行的。当您的 Delphi 代码不匹配时，编译器无法推断 DLL 的声明并打印错误。

方法指针（这是您添加`of object`到声明时得到的）与普通函数指针不同。它实际上是一个*闭包*，由指向方法的指针和对其方法所在对象的引用组成。Delphi 知道如何通过获取引用的对象并调用该对象上指向的方法来调用方法指针。

您的 DLL 不知道如何调用方法指针，除非它是用 Delphi 或 C++ Builder 编写的。但即使它知道如何，你也会被卡住，因为 DLL*不知道*你给它一个方法指针。它假定您给它一个普通的函数指针，因为这就是 DLL 代码的编写方式。

您不能为 DLL 提供您的类的方法。不过，有一些技术可以让您间接解决问题：

*   如果 DLL 的回调定义允许，您可以向 DLL 传递一个额外的参数，然后 DLL 将传回该参数。您可以使用它来保存对您的对象的引用，然后在您的回调函数中您可以使用该对象。不过，看起来这个特定的 DLL 并不支持它。
*   您可以将对对象的引用放在全局变量中，然后您可以在独立的回调函数中引用该变量。这不是很优雅，如果您可以同时对 DLL 进行多次调用（通过多个线程或通过递归），该技术就会崩溃。
*   您可以为函数分配自己的内存，然后将对象引用放入为该方法动态生成的代码中。实际上，可以调用 DLL 的类的每个实例都有自己的私有回调函数。该技术比我准备在这里解释的要复杂一些。有些人担心您的程序在病毒扫描程序或在某些内存上设置了禁止执行标志的计算机看起来可疑，但每个 VCL 程序实际上已经使用该技术将表单和控件与其底层 Win32 窗口相关联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T13:03:25.930

“对象”指令实际上指示计算机将指向对象实例的指针添加到过程调用的参数列表的前面。这修改了调用过程的方式，并且 DLL 实际上获得了一个参数列表，这些参数通过在前面添加一个对象 pionter 进行了移动，并且不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T18:58:28.900

Rob Kennedy 已经为您提供了有关您遇到[问题](https://stackoverflow.com/questions/1017692/use-a-function-from-dll/1018594#1018594)的可能原因的信息以及一些不同编码方式的信息。

然而，还有另一种方法可以做到这一点，它既简单又与其他开发环境兼容：接口。考虑以下代码：

```
type
  IPortNotification = interface
    ['{7BECA1D9-A6E8-4406-9910-5B36A6B0D564}']
    procedure StatusChanged(ACardNo, APortNo: integer; ANewPortStatus: byte);
    procedure DataReceived(ACardNo, APortNo: integer; ADataPtr: PByte;
      ADataLength: integer);
  end;

function RegisterPortNotification(ANotification: IPortNotification): BOOL;
  stdcall; external PortDLL;
function UnregisterPortNotification(ANotification: IPortNotification): BOOL;
  stdcall; external PortDLL; 
```

DLL 仅导出两个函数来注册和注销接口指针，并且该接口直接在您的代码中实现事件处理程序。这使得 DLL 相当通用，您可以随时用另一种语言重写它，并且您也可以在其他开发环境中使用它 - 没有什么特定于 Delphi 的，例如`T_API_INIT_PARAMS`.

请注意，现在您可以通过注册多个接口指针来实现几乎免费的多播事件。

像这样扩展 API 也容易得多。使用原始代码中的记录，您无法在不破坏二进制兼容性的情况下添加回调。您可以随时查询传递的接口以`RegisterPortNotification()`获取新的扩展接口，并注册它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T12:43:48.577

如果您遇到访问冲突，则很可能未设置函数指针（或不再设置）。

在调用函数指针之前检查 Assigned 通常是明智的，除非你 100% 确定它是有效的。

例如使用断言：

```
Assert(Assigned(MyPtr)); 
```

不幸的是，它不检查悬空指针。

函数指针和方法指针（带有对象扩展）之间有很大的区别。方法指针有一个隐藏的额外参数（指向对象的指针）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T15:15:45.273

请原谅这个明显的问题，但是您是否在两个地方都更新了函数指针的定义？

此外，根据您对对象所做的操作，跨 DLL 边界传递它可能会给您带来问题，除非同一个内存管理器同时拥有应用程序和 DLL 的内存。确保您正在共享它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T12:37:27.730

如果您正在创建多线程应用程序，那么您的代码可能不是线程安全的。此外，您调用的 DLL 可能不是线程安全的......

# c# - 指纹SDK

> ID：1017699
> 
> 赞同：1
> 
> 时间：2009-06-19T12:28:56.000
> 
> 标签：c#, .net, fingerprint

我正在使用指纹读取器 UFP20。SDK 提供 2 个 DLL 文件（WIS_API.dll、WisCmos2.dll）。不幸的是，他们不提供 c# 演示代码。我可以连接设备并测试设备。它工作完美。

问题：我无法捕获指纹，即使捕获初始化功能工作正常。调用 WIS_Capture() 函数时出错。错误 - “此函数试图访问受保护的内存区域，这可能会损坏系统”

有关该功能的更多详细信息：-

**WIS_捕获**

```
Synopsis
         int WINAPI WIS_Capture( HANDLE hInit, int *rCount )
Parameter
        hInit        The handle returned by WIS_InitDriver()
        rCount       A value used internally by the function. The developer MUST 
                     initial this value to 0 before use.

Description :
     To snap a fingerprint from the fingerprint device to the main memory by a
     fingerprint image quality control process. The fingerprint quality control 
     cycle needs several frames of images and will continuously return the 
     status of the fingerprint after each frame of image captured. 
```

请帮助我避免此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-09-12T23:20:28.880

我的朋友 Avatar 是对的，您必须使用如下代码调用非托管 dll 函数：

```
namespace SDK_DLL_NS
   {
      internal class SDK_DLL
         {
            [DllImport("../../../SDK/SDK.dll")]
            public static extern unsafe int SDK_AMethod(int devHandle, IntPtr buf, int length);
            public const int MAX_LEN = 12345;  
.....
    }
} 
```

现在，这只是工作的接口部分，根据定义，.NET 虚拟机内存不是固定的，这是 dll 所期望的，幸运的是，我们有 System.Runtime.InteropServices 命名空间来帮助它的 GCHandle 结构，它提供了一个从非托管代码访问托管对象的方法。所以我认为代码可能是这样的，我们需要分配一些内存“本地代码”：

```
SDKdllBuffer = new byte[SDK_DLL.MAX_LEN];
pinnedBuffer = GCHandle.Alloc(SDKdllBuffer, GCHandleType.Pinned);

unsafe
     {
        SDK_DLL.SDK_AMethod(handle, pinnedBuffer.AddrOfPinnedObject(),MAX_LEN);
} 
```

希望这能给你一个想法。祝你好运。胡安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:09:47.913

“此功能试图访问受保护的内存区域，可能会损坏系统”

这听起来类似于从托管代码调用非托管代码时遇到的错误。

根据[THIS](http://74.125.93.132/search?q=cache%3Ahttp%3A%2F%2Fwww.experts-exchange.com%2FProgramming%2FEditors_IDEs%2FC_CPP_CS%2FQ_23968549.html&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)（您需要一直向下滚动才能看到答案），您可能需要使用 References -> Com 将这些 dll 添加到您的项目解决方案中。这将创建一个托管代码包装器，以便您可以在代码中使用它们。

# c# - Actionscripts 的 C# 或 Java 的 LocalConnection 是否有包装器？

> ID：1017700
> 
> 赞同：0
> 
> 时间：2009-06-19T12:29:12.490
> 
> 标签：c#, java, flash, actionscript, localconnection

我想通过 C#/Java/C++ 与 Flash 的 LocalConnection 框架进行通信。我对已经实现的包装器的搜索并不像我希望的那样成功；）。存在多个支持将 C# 对象绑定到 LocalConnection 的服务器（如 FluorineFx）。问题是我不是在寻找服务器，而只是在寻找一个简单的（字符串编组就足够了）包装器。在阅读了 AMF 规范之后，实现我自己的包装器可能需要一些时间；）这导致了我的问题：

有人知道 LocalConnection 框架的简单包装器（C#/Java/C++）吗？

编辑：我正在寻找 AMF3 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T07:52:30.413

经过一番思考，我发现了另一种方法：我在 ActionScript 中构建“客户端”，并在 C# 表单上使用已编译的 SWF 文件（通过 ActiveX Showckwave 播放器）。客户端现在通过 ExternalInterface 与 LocalConnection 和主机 (C#) 应用程序进行通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:03:10.427

如果不需要服务器，是否可以使用 ExternalInterface 来方便 Flash/C# 之间的通信？我不完全确定您的要求，但 EI 在 C# 和 Flash 之间运行良好。这是一个相当简单的过程，并且不仅可以传输字符串（如果您最终需要它）。

# java - 如何通过 SOAP 暴露 Red5 的 SharedObjects

> ID：1017706
> 
> 赞同：0
> 
> 时间：2009-06-19T12:31:03.907
> 
> 标签：java, web-services, soap, axis2, red5

编辑：显然我的第一个问题不是很容易理解，我希望答案是有用的:)

我尝试在 Red5 服务器上安装 Axis2，一切正常，我使用 Red5 的 RTMPClient 从自定义 Web 服务访问 Red5 应用程序属性，并通过 Axis2 公开它们。

问题是这样做我有一个 2 级服务器，我并没有真正从 web 服务直接访问共享对象等......我想做的是能够访问一些 Red5 应用程序功能直接通过 SOAP 服务类。

我想我必须自己创建 SOAP 服务器（可能使用 Axis 的 SimpleHTTPServer 或 SimpleAxis2Server？？）

有任何想法吗？？

我希望我解释了自己......并提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T11:13:40.440

解决！！！我没有使用 Axis2，而是使用了我真正需要的 JAX-WS。

我创建了一个用作 WebService 的类并公开了我的 SharedObjects

```
package my.package;
import javax.jws.WebService;
@WebService
public class Red5WS{
    MyApplication app = null;
    public Game(){
        /* Needed but it can be empty */
    }
    public Game(MyApplication app){
        this.app = app;
    }
    public String getAttribute(String SOname, String attrName){
        ISharedObject so = app.getSharedObject(this.app.getScope(), SOname,true);
        return so.getAttribute(attrName);
    }
} 
```

然后，我在 MyApplications appStart 函数上添加了对 Endpoint.publish() 的调用，以便在应用程序运行后立即运行 WebService。我将此作为参数传递给 Red5WS 构造函数，以便能够从 Web 服务访问应用程序范围：

```
package my.package;
import javax.xml.ws.Endpoint;
import org.red5.server.adapter.ApplicationAdapter;
public class MyApplication extends ApplicationAdapter{
    @Override
    public boolean appStart (IScope app){
        Endpoint.publish(
            "http://localhost:8080/WebService/red5ws",
            new Red5WS(this));
        }
        return super.appStart();
    }
} 
```

编译 Red5 应用程序后，必须使用 wsgen 创建所需的 WS 类。

```
wsgen –cp . my.package.Red5WS 
```

重新启动 Red5 应用程序后，您应该能够通过以下方式访问 Web 服务的 WSDL 文件：

```
http://localhost:8080/WebService/red5ws?WSDL 
```

# wcf - 事务超时后如何在 WCF 中停止执行方法调用

> ID：1017723
> 
> 赞同：1
> 
> 时间：2009-06-19T12:34:50.327
> 
> 标签：wcf, multithreading, message-queue

我使用包含很长循环的方法创建了一个测试服务。我希望当发生超时事务时，方法执行会刷新，但事实并非如此。客户端获得超时，但处理在服务器上继续。

有没有办法阻止它？不改变方法代码？

这是示例：在示例中，我使用队列绑定调用方法 QueueRequest，10 秒后事务中止。此时会发生重试，导致同样的问题。几次重试后，服务器正在执行 100% 的 cpu 工作，试图在多个线程/实例上运行循环，即使消息已中毒并被丢弃。

* * *

```
 // NOTE: If you change the class name "Service1" here, you must also update the reference to "Service1" in App.config.
   [ServiceBehavior(InstanceContextMode=InstanceContextMode.PerCall, 
      TransactionTimeout="00:00:10",
      ReleaseServiceInstanceOnTransactionComplete=true)]
   [ErrorHandlingBehaviorAttribute]
   public class Service1 : IQueueService
   {
      public Service1()
      {
         Trace.WriteLine("Creating an instance on thread " + Thread.CurrentThread.ManagedThreadId.ToString());
      }

      ~Service1()
      {
         Trace.WriteLine("Destroying an instance on thread " + Thread.CurrentThread.ManagedThreadId.ToString());
      }

      [OperationBehavior(TransactionScopeRequired = true, TransactionAutoComplete = true)]
      public void QueueRequest(string message)
      {
         int id = Thread.CurrentThread.ManagedThreadId;
         Trace.WriteLine("Got Message on thread " + id.ToString());
         for (int i = 0; i < 1000000; i++)
         {
            Trace.WriteLine("Processing " + i.ToString() + " Thread ID " + id.ToString());
            Thread.Sleep(1000);        
         }
      }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:59:08.623

如果不修改现有代码，我认为这是不可能的。

看看[这里](http://silverlight.net/forums/t/77782.aspx)和[这里](http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.windows.developer.winfx.indigo&tid=7d543d0b-118f-4859-925d-bb61c3a80b64&cat=en_US_98f706ac-059e-447c-bb21-392ab9efa6ae&lang=en&cr=US&sloc=&p=1)。为请求提供服务的线程与将结果传递给客户端的 WCF 部分完全分离。

# excel - 复制 Team System 的“在 Microsoft Excel 中打开选择”功能

> ID：1017728
> 
> 赞同：1
> 
> 时间：2009-06-19T12:36:18.887
> 
> 标签：excel, visual-studio, tfs, vsto

在 Visual Studio 中，VSTS 具有选择一组工作项并单击按钮以在 Excel 中打开它们的功能，您可以在其中修改它们。然后，使用“团队”功能区，您可以将更改发布回 TFS。

我们希望在完全不同的业务环境中复制此功能。有谁知道任何示例代码或 OSS 项目可以做这种我们可以利用的事情？

我对如何创建模板和填充数据特别感兴趣......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-12T15:43:06.293

我们最终自己滚动它。最初我们使用 VSTO，但这很痛苦。非常。当他们添加功能区支持时，我们切换到[ExcelDna ，这很棒。](http://exceldna.typepad.com/)

# delphi - 我可以在 Delphi 中使用字符串“IsEmpty”方法吗

> ID：1017729
> 
> 赞同：6
> 
> 时间：2009-06-19T12:36:20.290
> 
> 标签：delphi, string

Embaracdero 记录了字符串类型的[“IsEmpty”方法](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/System__WideString__IsEmpty.html)，我已经成功地将其与 C++ Builder 代码一起使用。

```
WideString s;

if (s.IsEmpty())
   .... 
```

我从 Delphi 尝试了同样的方法，但无法编译：

```
var s: WideString;
begin
  if s.IsEmpty then
  .... 
```

我知道您可以与空字符串进行比较，或者调用 Length 函数，但是是否可以从 Delphi 调用这个 IsEmpty 方法？

编辑：澄清一下，这并不是字符串与宽字符串的问题。

基本上，我上面链接到的文档描述了 Pascal 语法以及 C++ 语法，但这似乎不起作用。我认为这只是文档中的一个缺陷。

*如果 System::WideString::WideString 为空，则返回 true。*

**帕斯卡：**函数 IsEmpty：布尔；

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-19T12:45:46.810

String 不是 Delphi 中的类，因此它没有方法，您必须使用函数进行字符串操作，如 Length、Copy 等…… String 是 C++ 中的一个类，所以您可能对此感到困惑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T12:46:26.700

不，字符串不是 WideString，即使在 D2009 中也是如此。你也不想这样做；与 nil/空字符串比较比方法调用快得多。

在德尔福：

```
var 
  s: string;
begin
  if s = '' then begin
    ShowMessage('It is empty or nil.'); 
```

...for string 检测 nil 和空字符串（即 = nil）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T12:58:10.823

Delphi 是一种混合语言。它包含基本类型和类。只有类（以及记录和对象）可以包含方法。

字符串是一种基本类型，虽然是一种特殊类型。它是唯一具有保留字的类型。这就是为什么它通常用小写字母（字符串）来写，这与其他类型的首字母大写（整数）不同。

如果你喜欢，你可以：

```
type
  TString = class
  private
    FString: string;
  public
    constructor Create(const AValue: string);

    property &String: string read FString write FString;
    property IsEmpty: Boolean read GetIsEmpty;
    // ...
  end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T12:39:15.870

```
if Trim(s)='' then 
```

？？？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-03T16:47:14.797

在新版本中，您也可以使用许多字符串辅助函数和 s.IsEmpty。

# .net - .net：DataSet 和 TableAdapters 是否与数据库和供应商无关？

> ID：1017735
> 
> 赞同：2
> 
> 时间：2009-06-19T12:36:57.950
> 
> 标签：.net, ado.net, vendor-neutrality, provider-independent

我们需要我们正在构建的应用程序与数据库无关。特别是，我需要它能够与 SQL Server、Oracle 和 MySQL 一起工作。将来，可能还会将其他数据库供应商添加到列表中。当然，要使用的任何数据库都将具有相同的模式。

为了构建一个原型来演示接口，我们将模式加载到 SQL Server DB 中，然后为该数据库生成 DataSet 和 TableAdapter。由于数据集是由数据库的特定实例生成的，我怀疑生成的 DataSet 和 TableAdapter 不是独立于供应商的。此外，我什至不确定它们是否可以用于另一个 SQL Server 数据库实例。

我的问题是：有没有办法将相同的自动生成的 DataSet 和 TableAdapter 与不同的数据库（可能还有供应商）一起使用？

干杯，

马科斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:00:51.163

一般来说，如果您针对[System.Data.Common](http://msdn.microsoft.com/en-us/library/system.data.common.aspx)命名空间开发数据库代码，它将尽可能地不可知。然而，有很多注意事项，因为每个数据库提供者都有自己特定的实现级别细节，这些细节与其他的不同。

使用 System.Data.Common 的与数据库无关的方法的示例如下所示：

```
var factory = DbProviderFactories.GetFactory("My Provider Name");
using (var connection = factory.CreateConnection())
{
    connection.ConnectionString = "My Connection String";
    connection.Open();

    var cmd = factory.CreateCommand();
    cmd.CommandText = "My Command Text";
    cmd.Connection = connection;

    var adapter = factory.CreateDataAdapter();
    adapter.SelectCommand = cmd;

    var dataset = new DataSet();
    adapter.Fill(dataset);

    // ...
} 
```

只需更改第一行以切换数据库提供程序，其余代码几乎可以保持不变。

这种方法使用了大量的手工编码。您可能会考虑使用[NHibernate](https://www.hibernate.org/)（如 David Basarab 提到的）、[Subsonic](http://subsonicproject.com/)或[Microsoft Enterprise Library Data Access Application Block](http://msdn.microsoft.com/en-us/library/cc309504.aspx)等数据库框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:40:41.453

我认为你走错了路。我会选择[NHibernate](http://nhforge.org/Default.aspx)

我每天都使用它，它与数据库无关。

# java - 提供 zip 的 JSP 损坏了文件

> ID：1017736
> 
> 赞同：0
> 
> 时间：2009-06-19T12:37:15.437
> 
> 标签：java, jsp, servlets, zip

我在尝试在 JSP 中提供 zip 文件时遇到问题。

zip 文件在完成下载后总是损坏。我尝试了几种不同的阅读和写作方法，但似乎都没有奏效。

我认为它可能在某处添加了 ascii 字符，因为文件将打开并显示所有文件名，但我无法提取任何文件。

这是我的最新代码：

```
<%@ page import= "java.io.*" %>

<% 
    BufferedReader bufferedReader = null;

    String zipLocation = "C:\\zipfile.zip"; 

    try
    {
        bufferedReader = new BufferedReader(new FileReader(zipLocation));
        response.setContentType("application/zip");
        response.setHeader( "Content-Disposition", "attachment; filename=zipfile.zip" );

        int anInt = 0;
        while((anInt = bufferedReader.read()) != -1)
        {
            out.write(anInt);
        }
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
%> 
```

编辑：我将代码移到了一个 servlet，但它仍然无法正常工作。我改变了很多东西，所以这是最新的非工作代码：

```
public void doGet(HttpServletRequest req, HttpServletResponse response) throws ServletException, IOException
{
    try
    {
        String templateLocation = Config.getInstance().getString("Site.templateDirectory");

        response.setContentType("application/zip");
        response.setHeader("Content-Disposition", "attachment; filename=output.zip;");

        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        BufferedOutputStream bos = new BufferedOutputStream(baos);
        FileInputStream fis = new FileInputStream(templateLocation);

        int len;
        byte[] buf = new byte[1024];

        while ((len = fis.read(buf)) > 0)
        {
            bos.write(buf, 0, len);
        }

        bos.close();
        PrintWriter pr = response.getWriter();
        pr.write(baos.toString());
        pr.close();
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
} 
```

编辑2：

这是我实际工作的 servlet 代码。谢谢大家！

```
public void doGet(HttpServletRequest req, HttpServletResponse response) throws ServletException, IOException
{
    try
    {
        String templateLocation = Config.getInstance().getString("Site.templateDirectory");

        response.setContentType("application/zip");
        response.setHeader("Content-Disposition", "attachment; filename=output.zip;");

        BufferedOutputStream bos = new BufferedOutputStream(response.getOutputStream());
        FileInputStream fis = new FileInputStream(templateLocation);

        int len;
        byte[] buf = new byte[1024];

        while ((len = fis.read(buf)) > 0)
        {
            bos.write(buf, 0, len);
        }

        bos.close();
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T12:42:10.467

Zip 是二进制文件，因此不适合作为字符数据传输。代码外的文本也可能损坏文件。

使用普通的普通 servlet 而不是 JSP。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T12:42:08.190

JSP 将空格添加到输出。我建议您将其移至 servlet。

或者，您可以查看[Strip whitespace from jsp output](https://stackoverflow.com/questions/208736/strip-whitespace-from-jsp-output)，但我不确定它不会影响 ZIP 输出本身。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T12:46:08.790

这个确切的片段中的问题在第二行 - 您在 JSP 标记之外有一个空行，它作为 HTML 发送到浏览器（即 HTML 源代码中的一个空行）。

要非常小心地删除任何不在 <% %> 中的内容，尤其是空格（甚至是终端换行符！），或者遵循其他地方的建议并使用 servlet :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T14:38:19.670

您的 servlet 代码不起作用，因为您将流输出到`response.getWriter()`，正如其他人指出的那样，它是用于**字符数据**的。我引用 Javadoc：

> `PrintWriter getWriter() throws IOException`
> 返回一个可以向客户端发送字符文本的 PrintWriter 对象。PrintWriter 使用 getCharacterEncoding() 返回的字符编码

不仅如此，你甚至没有将字节数组写入`Writer`，你正在写入 的结果`ByteArrayOutputStream.toString()`，这也进行了字符转换~

您想使用 response.getOutputStream()，例如：

```
BufferedOutputStream bos = new BufferedOutputStream(response.getOutputStream()); 
```

然后将文件的字节内容写入其中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T12:44:03.363

如果我没记错的话，读者通常是针对字符流的——你可能会尝试更多类似 ByteArrayOutputStream 的东西？此外，正如其他人所评论的那样，JSP 确实可能会破坏输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T13:13:21.433

```
bufferedReader = new BufferedReader(new FileReader(zipLocation)); 
```

除了 Servlet/JSP 问题之外，这条线路 100% 肯定会破坏您的数据。它将尝试使用默认平台编码将二进制数据解释为文本，这意味着文件中大约一半的字节被替换为“未知字符”。

**字节和字符串不是一回事！**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T13:26:54.277

我还建议使用普通的 servlet，并认为[Robert Munteanu 的回答](https://stackoverflow.com/questions/1017736/jsp-to-serve-a-zip-corrupts-the-file/1017757#1017757)是正确的，但您也可以在您的 JSP 中执行此操作。问题不在于添加的空格，而是隐式变量“out”是 JSPWriter 的一个实例，而 Writer 用于字符，而不是字节。尝试使用**response.getOutputStream()**并就可以了，这应该可以。您将收到一个异常，说明其他人已经获得了 OutputStream，但您可以忽略它。

但正如我所说，使用 Servlet 会更干净。

# javascript - 使用javascript插入Caret

> ID：1017742
> 
> 赞同：1
> 
> 时间：2009-06-19T12:37:54.093
> 
> 标签：javascript

我使用谷歌搜索找到了一些代码：

```
function insertAtCaret (textarea, icon) { 
    if (document.getElementById(textarea).createTextRange && document.getElementById(textarea).caretPos) { 
        var caretPos = document.getElementById(textarea).caretPos; 
        selectedtext = caretPos.text; 
        caretPos.text = caretPos.text.charAt(caretPos.text.length - 1) == '' ? icon + '' : icon;//this line I am not understand
    }
}

function storeCaret (textarea) { 
    if (document.getElementById(textarea).createTextRange) document.getElementById(textarea).caretPos = document.selection.createRange().duplicate(); 
} 
```

这里为什么需要判断

```
caretPos.text.charAt(caretPos.text.length - 1) == '' 
```

我认为 icon+'' 和 icon 是相等的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T13:17:28.883

'' 不是空字符串，而是单个空格字符。在 IE 中，如果您双击该单词，则该单词被选中，并且该单词后面的空格字符也被选中。因此，现在如果您粘贴一些文本（图标）来代替您的选择，那么选定的文本以及空格将被替换 - 因此您在粘贴后会丢失空格。

这就是为什么要在粘贴的文本中添加一个空格的原因 - 为了不丢失空格，如果它与某个单词一起选择。但是如果没有选择空格，那么我们不会在插入的单词中添加空格。

该脚本在不同类型的文本格式论坛上非常流行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:43:15.677

`icon + ''`保证是 type `string`。`icon`可能不是字符串。

编辑：我不知道为什么它会检查是否`charAt`是一个空字符串，并根据它决定转换`icon`为 a `string`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T10:59:38.673

如果 '' 实际上是一个空格（由于格式而在此处误传），那么我认为您的解释是正确的：

> Google 正在解决 IE 在选择整个单词时包含尾随空格的行为。由于粘贴的图标将替换所选内容，因此 Google 希望恢复该尾随空格。

但后来我不确定原来的问题是关于什么的。显然icon+''和icon不相等；一个有一个额外的空间。正确的？

# sql - 带有 SQL 代码格式的分隔符优先格式 (SFF) 是否更易于阅读/维护？

> ID：1017750
> 
> 赞同：1
> 
> 时间：2009-06-19T12:39:08.257
> 
> 标签：sql, formatting

您是否在行首放置分隔符（逗号、and 或运算符）？

```
Select Field1
    , Field2
  --, Field3
From [some_table] as ST
Inner Join [other_table] as OT
   ON ST.PKID = OT.FKID
Where [this] = [that]
   and [one_other] > 53; 
```

我认为最好的功能是帮助暴露重要的运算符（AND/OR）。作为次要优势，它似乎更容易注释掉。

不知道我最初在哪里找到它，但 Andrew Novick 在“Transact-SQL 用户定义函数”中提到了它（听他说话；免费获得这本书并强烈推荐。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T12:46:43.420

注释掉更容易，但我宁愿追求可读性 - 当代码发生很大变化时，使用如下所示的列布局有点尴尬，但获得概述非常舒服：

```
select foo.bar,
       baz.ban,
       foobar.bazban
  from foomatic  foo
  join bartastic bar  on bar.id  = foo.id
  join anemone   anem on anem.id = bar.id
 where foo.bar <> 1 and
       baz.ban =  'foo' and
       (
         anem.bear in ('a', 'b') or
         anem.zoo  is null
       )
; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T12:45:51.847

我个人不觉得这更容易阅读，但这只是因为我不习惯它。要记住的重要一点是，*一致性是*这些问题的关键。确保您选择的任何样式都是用于整个项目的唯一样式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T12:46:38.210

在我的工作场所（约有 10 名开发人员的小型咨询公司，专门研究 Oracle），这就是我们的惯例，如下所示：

```
SELECT
  p.id pd_id
, p.var_no
, p.status
, o.name operator
, o.r_id
, o.r_type
, o.start_datetime
, o.end_datetime
--, p.id rd_id
--, p.s_control
, p.xml_data last_d_res_xml
FROM schema_a.table_x p
JOIN schema_b.table_y o ON p.id = o.pd_id
WHERE p.some_id = 11
ORDER BY pd_id DESC, end_datetime DESC NULLS FIRST 
```

我们发现它非常清晰，并且可以在调试时轻松注释列。花了一段时间才习惯，但我现在更喜欢这种风格——我们整个团队一直在使用这种风格。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T12:55:16.307

“更容易注释掉” - 除非您想注释掉第一项。

不管你的分隔符是在行首还是行尾——总会有一个边缘情况，你不能应用“容易注释掉”的标准。

如果您正在查看运算符级别（AND/OR），那么一个容易注释掉的行可能：

*   更改查询的含义
*   导致语法错误

一般来说，对于 where 子句，如果不是所有的 AND，那么我倾向于嵌套：

```
WHERE
    ColumnA = 1 AND
    ColumnB = 2 AND
    (
        ColumnC = 3 OR
        ColumnD = 4
    ) 
```

这可以帮助您发现需要注释运算符或在注释块前面添加“1=1”条件的边缘情况（如上所述）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T12:45:33.283

我对此很草率，但这是我最喜欢的写东西的方法——尤其是在我调试新脚本时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T13:16:36.777

这是我最近一次参与的标准。花了一点时间来适应，现在其他任何东西对我来说都很奇怪:)

```
SELECT e.emp_id
      ,e.emp_name
      ,d.dept_name
FROM   emp   e
      ,dept  d
WHERE  e.dept_id        = d.dept_id
AND    d.is_active      = 'Y'
AND    e.current_status = 'ACTIVE'
AND    (e.class IN ('x','y','z')
        OR e.class_na = 'Y')
ORDER BY e.emp_name
        ,d.dept_name; 
```

我们发现将所有内容排列在列中使查询更易于阅读，尤其是当您在 PL/SQL 中有许多 SQL 语句时。SQL 从周围的程序代码中脱颖而出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T19:20:23.960

我更喜欢 SELECT 子句分离。

这突出了查询的重要部分。分隔符前端或末端现在仅在 SELECT 列表中重要

我发现上述所有示例都难以阅读。

```
Select
    Field1
    , Field2
    --, Field3
From
    [some_table] as ST
    Inner Join
    [other_table] as OT ON ST.PKID = OT.FKID
Where
    [this] = [that]
    and
    [one_other] > 53;

Select
    Field1,
    Field2 --,
    --Field3
From
    [some_table] as ST
    Inner Join
    [other_table] as OT ON ST.PKID = OT.FKID
Where
    [this] = [that]
    AND
    [one_other] > 53; 
```

# c++ - C ++静态常量变量和破坏

> ID：1017755
> 
> 赞同：1
> 
> 时间：2009-06-19T12:41:33.993
> 
> 标签：c++, constants, static-members

我在一个简单的 C++ 类中遇到了一个奇怪的行为。

类A.h

```
class A
{
public:
  A();
  ~A();
  static const std::string CONST_STR;
}; 
```

类A.cpp

```
#include "classA.h"
#include <cassert>

const std::string A::CONST_STR("some text");

A::A()
{
  assert(!CONST_STR.empty()); //OK
}

A::~A()
{
  assert(!CONST_STR.empty()); //fails
} 
```

主文件

```
#include <memory>  
#include <classA.h>  

std::auto_ptr<A> g_aStuff; 

int main() 
{ 
  //do something ... 
  g_aStuff = std::auto_ptr<A>(new A()); 
  //do something ... 
  return 0; 
} 
```

我预计访问冲突或类似的事情，但我从没想过静态 const 字符串的内容会改变。这里有没有人能很好地解释该代码中发生了什么？

谢谢，诺伯特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T12:50:30.527

**编辑：**显然缺少`A::`的是代码原始帖子中的错字。

**原答案：**

你的意思是有

```
 const std::string **A::**CONST_STR("some text"); 
```

所以 CONST_STR 是类的一部分`A`？

否则，您将单独声明它，而*不是*初始化`A`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T12:53:50.287

您正在两个不同的编译单元中创建 2 个静态变量。无法判断它们的初始化顺序。但是它们的析构函数总是以相反的顺序调用。

在您的情况下，似乎发生了下一个场景：

```
g_aStuff constructor 
CONST_STR constructor

main funciton initializes g_aStuff

CONST_str destructor 
g_aStuff descrutor 
```

此时 CONST_STR.empty() 的结果未定义。这可能会触发断言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T13:00:20.570

> 我预计访问冲突或类似的事情，但我从没想过静态 const 字符串的内容会改变。

未定义的行为：它是未定义的。如果 CONST_STR 已被销毁，那么如果您访问它，则不能保证出现硬件异常。它可能会崩溃，但它的地址可能最终会包含看起来像一个空字符串的数据：它的析构函数可能会清除指针或其他任何东西。

在这种情况下，您说 A 实例也存储在全局智能指针中，该指针在 main() 中分配。所以 CONST_STR 在 A 构造函数中被访问时已经被构造，但很可能在智能指针被销毁之前被销毁。我们需要整个程序来肯定地说。

[编辑：你已经做到了。由于 CONST_STR 和 g_aStuff 定义在不同的编译单元中，因此标准没有定义它们的相对构造顺序。我猜是 CONST_STR 首先被销毁。]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T12:51:40.777

这

```
const std::string CONST_STR("some text");
```

classA.cpp 中定义的不是 A 的成员。该定义如下所示：

```
const std::string A::CONST_STR("some text");
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T13:04:38.830

该标准没有指定不同翻译单元中全局/静态对象的初始化顺序。但是，它确实保证每个这样的对象都将在执行该翻译单元的任何函数之前被初始化。

在您的情况下，它发生在`CONST_STR`初始化之后`g_aStuff`，并且由于破坏顺序与构造顺序相反，因此它在它之前被破坏。因此，`CONST_STR`从`A`的析构函数访问会调用未定义的行为——您可能会遇到访问冲突，也可能不会。

`CONST_STR` is, however, initialized before `A`'s constructor is executed because they are in the same translation unit.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T12:47:45.073

如果存在 A 的全局实例（或类型 A 的静态类成员），则可能会发生这种情况。由于未定义全局变量和静态变量的初始化顺序（跨翻译单元），因此可以。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T13:03:19.287

查看完整代码，您依赖于跨编译单元（classA.cpp 和 main.cpp）的破坏顺序。如果您将 g_aStuff 创建为 main 中的本地，则您的断言应该通过。

# c# - .NET 中的受保护类

> ID：1017778
> 
> 赞同：37
> 
> 时间：2009-06-19T12:45:50.663
> 
> 标签：c#, .net, access-modifiers

可以在.NET 中保护类吗？
为什么/这不可能？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-19T12:53:02.910

是的，你不能让它们成为顶级类，它们必须是内部类

```
public class Outer
{
    protected class Foo
    {
    }
} 
```

这很好，这意味着唯一允许看到 Foo 的类是 Outer 的子类

```
class X 
{
    // 'Outer.Foo' is inaccessible due to its protection level
    private void Flibble(Outer.Foo foo)
    {
    }
}

class X : Outer
{
    // fine
    private void Flibble(Outer.Foo foo)
    {
    }
} 
```

请注意，您不能在 c# 中将任何外部类声明为私有、受保护（或受保护的内部），因为外部级别类的访问修饰符定义了它们相对于其他程序集的可见性。仅在程序集中（或通过 InternalsVisibleTo 对朋友可见）或在程序集外部特别可见。

因此，虽然此处使用公共/内部标识符以保持一致性，但 IL 中的状态实际上只是“公共”或“非公共”（如[Reflection.Emit 标志所示](http://msdn.microsoft.com/en-us/library/5kyyyeh2.aspx)）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-19T12:53:14.173

`protected`可见性用于指示“对派生类可见”。这对类内部的东西是有意义的，但通常在类级别没有意义。

唯一的例外是内部类，其中受保护的可见性意味着派生类可以访问内部类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T15:09:42.820

是的，我们只是不能让它们成为顶级类，它们必须是内部类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-06T11:43:50.897

不能在命名空间内定义受保护的类。它只能声明为嵌套类。它可以在其他嵌套类中实例化，可以被其他嵌套类继承，也可以从其他嵌套类继承。

嵌套类以及从父类（派生类或子类）继承的类可以访问父类的受保护成员。

# database - Delphi中的OOP从哪里开始，主要侧重于数据库开发？

> ID：1017791
> 
> 赞同：7
> 
> 时间：2009-06-19T12:47:44.073
> 
> 标签：database, delphi, oop, frameworks

我想将数据库代码与 GUI 设计隔离开来。在一段合理的时间里，我一直在阅读/搜索/浏览诸如 mgm/mvp/mvc/persistence/objects 等主题。我真的很难设计可重用的对象层次结构/框架。Delphi 是 RAD 的一个很好的工具，但是当您想以不同的方式解决问题时，文档似乎无效。我想开发一些持久性之王，用于数据访问和轻松地将数据连接到对象/对象列表中。并以多种方式集成数据显示（使用或不使用现有组件 dbaware，为多种格式创建导出/导入例程）。我应该从哪里开始？你知道任何有代码的教程吗？例如，Delphi 安装中包含的 mastapp 演示是 RAD-way 作为启动的一个很好的来源。我需要 OOP 中的等价物 :) 带有评论和教程

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-19T16:28:20.883

嗯。大问题，这些东西不在手册中：（真的需要一本书来回答它。但是，如果您要开始一个新的大型项目？项目那么我的建议列表，在使用 Delphi 做了 10 年后，将按如下开始：

一般来说

在开始第 1 版所需的功能之前，请认真思考。但不要忽视第 2 版和第 3 版的花里胡哨的可能性。

不要使用数据感知控件，除非在简单的单独实用程序或基本数据输入屏幕中。

推理：

*   它们会立即破坏您的 GUI <-> 数据库分离。
*   在用户友好性测试中，它们让您有些失望。
*   他们鼓励意大利面条代码

不要直接使用任何标准或第 3 方控件，包括表单、框架或数据模块。首先构建您自己的派生类库 - 即使您一开始没有添加任何功能，并且始终使用这些类。

推理：

*   完全控制您的应用程序的行为。
*   简化前向兼容性。
*   让您完全自由地在新组件树中的任何位置引入新属性/功能，而无需编辑所有对话和表单或对象。

尽可能将所有内容创建为具有属性的对象，这些属性具有在其中隐藏复杂性和设置器的属性，只有当它们**不能**只读时。约束自己始终使用自己的属性 - 使用快速公共变量作弊通常会导致您稍后将其重新创建为属性。

数据库设计 - 读一本书 :)

GUI <-> 数据库分离。

由于应用程序将不得不与数据交互，因此我认为不可能 100% 分离。相反，您的基线对象可能至少会定义：

*   检索或加载数据的机制
*   编辑该数据的机制
*   保存数据的机制
*   一种显示数据的机制。

我称之为松耦合。

为每个数据表或密切相关的表组创建一个单独的数据模块，其中包含只读查询、可写查询等。保持 SQL 尽可能简单 - 我在 2 天内将我的最后一个应用程序从 Oracle 移动到 MYSQL - 150 个包含相关对象的表和编辑帧:)。最初也在它自己的数据模块中将它们全部链接到一个池连接。

听起来您已经意识到列表，尤其是 TObjectLists，是您的朋友。再次 - 为您需要的每种类型的对象派生自己的。我实际上将真正的列表隐藏在更简单的对象中。公开 Items 和 Count 属性是微不足道的。然后根据需要使用内部列表向基础项目添加更多功能。从那里列表列表是一个简单的步骤，几乎自然地遵循它们所代表的数据库数据的结构。

通过将应用程序的不同部分使用/需要的列表类型实际存储在数据库中，您可以使用这种方法变得更加复杂。然后，您可以即时创建正确的列表，而应用程序实际上并不知道其中的内容 - 列表和对象本身应该在您的开发阶段包含他们需要操作/加载/保存和显示自己的数据的所有功能:)。这也可以扩展到列表执行的功能。我使用了几个基本列表类型，它们公开了简单的计数和项目——在我的例子中，它们有大约 50 个后代。

以这种方式工作您的项目可能会积累大量文件，但您可以依赖并信任 Delphi - OO 模型非常强大，很少被抓住。

如果您遵循其中的大部分内容，那么您的主应用程序最终会成为一个列表加载器，仅此而已:) 在我的最新版本中，主要功能仅占用大约 100 行代码，但它启动的内容非常复杂。

最后 - 所有这一切都需要大量工作 :( 说实话，第一次就做好是不会发生的，所以要准备好妥协你漂亮的对象模型来让应用程序走出门外，但要在哪里以及为什么要发表重要评论做了它以及如何稍后再纠正它。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T13:09:56.073

如果您真的想编写自己的对象持久化框架，我强烈建议您阅读[tiOPF](http://tiopf.sourceforge.net/)网站上的文档。尤其是[概念手册](http://tiopf.sourceforge.net/Doc/Concepts/index.shtml)。

在阅读本文档时，您可能还对实际使用 tiOPF 感兴趣。它是一个稳定而健壮的持久性框架，可以与所有主要数据库一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T14:36:52.280

我从来没有这样做过，但是......

看看即时对象。

对于在 Delphi 中可视化构建类/对象的方法，请尝试 ModelMaker（一种商业解决方案）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T17:10:02.460

[Jazz SDK](http://jazz-sdk.googlecode.com) 值类型、OPF 和 MVP 框架

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T12:59:32.663

Delphi 有相当多的数据库控件，这对 RAD 来说非常有用，但更难将数据库与 Gui 解耦。

您可以使用客户端数据集 (midas) 进行内部通信。它们可以与数据感知控件一起使用，并具有许多其他有趣的属性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T18:56:10.870

正如 Dispatcher 所说，这是一项繁重的工作，但最终还是有回报的。我强烈建议查看不止一个现有系统。不要只解决你找到的第一个。尝试了解它们是如何工作的，以及您对程序的愿景与框架概念的匹配程度。

找几本关于模式的好书。当您继续沿着这条道路前进时，您会发现它们非常宝贵，并且会经常被引用。我建议[GOF](https://rads.stackoverflow.com/amzn/click/com/0201633612)用于基础知识，而[企业应用程序架构模式则](https://rads.stackoverflow.com/amzn/click/com/0321127420)用于数据库对象模型方面。这些库中的大多数概念都是基于这些书中讨论的模式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-04T20:33:24.303

您可能还想考虑[hcOPF](http://sourceforge.net/projects/larryhengensopf/?source=directory)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-20T00:59:38.737

如果您正在寻找一个框架，[Data Abstract](http://www.dataabstract.com/)是我所知道的最好的工具。

# python - 是否有用于访问 Google Group 数据的 API？

> ID：1017794
> 
> 赞同：6
> 
> 时间：2009-06-19T12:48:08.443
> 
> 标签：python, google-groups

我正在尝试为我参与的电子邮件组建立一些统计数据。是否有任何 Python API 可以访问 GoogleGroup 上的电子邮件数据？

另外，我知道小组主页上有一些统计数据。我正在寻找比那里显示的更复杂的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T12:50:43.617

没有我知道的 API，但是您可以访问 XML 提要并根据需要对其进行操作。

# cocoa - 我必须在 NSManagedObject didTurnIntoFault 中调用 super 吗？

> ID：1017804
> 
> 赞同：0
> 
> 时间：2009-06-19T12:50:17.393
> 
> 标签：cocoa, core-data

我必须打电话给超级`didTurnIntoFault`吗？我在文档中找不到任何指示。

```
- (void)didTurnIntoFault {
  [super didTurnIntoFault]; // Do I have to call super?
  // ...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T13:59:29.750

不，我不相信。的目的`didTurnIntoFault`是让您有机会释放您可能持有的任何实例变量（尤其是瞬态值）。虽然它旨在用作子类的替代品`dealloc`，`NSManagedObject`但这是因为 an 的生命周期与`NSManagedObject`普通的`NSObject`. 因此，尽管它的用途与 几乎相同，但它的`dealloc`工作方式却不尽相同。

当然，如果您将自己的子类子类化`NSManagedObject`，则需要在`[super didTurnIntoFault]`那里调用。

也就是说，我认为`NSManagedObject`' 的实现可能是无操作的，所以我真诚地怀疑无论如何调用它有什么害处。此外，因为它没有害处，它可能会帮助您记住在真正重要时调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T21:27:35.427

如果您继承 NSManagedObject 并覆盖 -didTurnIntoFault，则**必须**将消息发送给 super。

请参阅 NSManagedObject 类参考的[子类化注释](http://developer.apple.com/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObject_Class/Reference/NSManagedObject.html#//apple_ref/doc/uid/TP30001171-235678)。

# .htaccess - Mod ReWrite Catch-All 子域

> ID：1017812
> 
> 赞同：3
> 
> 时间：2009-06-19T12:51:09.933
> 
> 标签：.htaccess, mod-rewrite

基本上我希望 *.domain.com 拉起 domain.com/*/ （不是重定向）。

我进入 cPanel 的子域部分并为该域设置了一个通配符。它似乎可以正确解析，即 *.domain.com 正在启动 domain.com。

我现在在 public_html 目录中创建了一个 htaccess 文件，其中包含：

```
Options +FollowSymLinks
Options +Indexes
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !www.domain.com$ [NC]
RewriteCond %{HTTP_HOST} ^(www.)?([a-z0-9-]+).domain.com [NC]
RewriteRule (.*) %2/$1 [L] 
```

我得到的错误是“500 Internal Server Error”，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T14:31:59.077

试试这个规则：

```
RewriteCond %{HTTP_HOST} !^www\.example\.com$ [NC]
RewriteCond %{HTTP_HOST} ^(www\.)?([a-z0-9-]+)\.example\.com$ [NC]
RewriteCond %2%{REQUEST_URI} !^([^/]+)/\2
RewriteRule (.*) %2/$1 [L] 
```

附加应避免由标志`RewriteCond %2%{REQUEST_URI} !^([^/]+)/\2`引起的无限循环。`L`

# database - 主键和约束

> ID：1017813
> 
> 赞同：0
> 
> 时间：2009-06-19T12:51:12.243
> 
> 标签：database, database-design, data-warehouse

在我（当然）从 OLTP 数据库构建的全新数据仓库中，我删除了所有 IDENTITY 列并将它们更改为 INT 列。

关于以下方面的最佳实践是什么，特别是因为仓库是非规范化的：

1.  主键
    -> 这现在可能是一个复合键，因为几个表已经放在一起
    -> 我需要遵循 OLTP 的键结构吗？

2.  约束
    -> 有一些约束（非空），位列的默认值（0）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:56:54.663

对于您的主键，请考虑使用代理键或备用键；您需要适应缓慢变化的维度，例如，如果您要报告过去 5 年中每个已婚/未婚销售人员的平均销售额，您需要记录某人未婚 2 年的事实，然后最后 3 个结婚。这意味着您的数据仓库将有两个维度表行用于同一个人。遵循 OLTP 结构将很难:)

约束不是问题。DW 已针对读取进行了大规模优化（假设您作为批处理填充），并且约束并没有真正考虑到读取操作。您通常可以绕过 DW 填充作业的任何约束问题，并在必要时在报告工具中处理空值等。更重要的是确保默认值适合您的概念数据模型，并且不要在 DW 客户端工具中引入问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-26T22:57:36.623

对于**维度**表：

*   保留代理自动增量（身份）PK，日期维度除外（见下文）。
*   确保您有一个备用“自然键”以允许缓慢变化的尺寸（类型 2）。
*   维度表中不允许有空值，用详细的“n/a，未输入，未知..”替换它们
*   如果可能，将布尔标志 (1/0) 更改为详细的“是，否”，以使其对报告/业务用户友好。
*   摆脱计算字段并用值替换它们，或者至少保留计算字段 - 取决于 db.
*   如果可以，请实施星型模式，以空间换取速度。雪花只在你必须的时候。
*   检查您的查询，如果`WHERE`子句中有函数，请在维度表中添加一列并预先计算值。
*   如果 PK 看起来像 20090619，则很容易对日期维度进行分区。
*   摆脱检查约束和默认值，将其移至ETL 过程的*一致性*阶段。检查和默认设置会减慢加载速度，一旦完成加载，它们就不起作用了。

对于**事实**表：

*   考虑使用代理自动增量（身份）PK 以允许轻松分区，如果使用复合 PK，您可以改为使用复合唯一非集群。

*   将外键脚本放在安全的地方，在加载事实表之前删除键是一种常见的做法，以加快加载速度。有些人使用“仅逻辑”的外键运行 DW，他们在加载后使用“查找孤儿”查询。

**ETL**

*   通过所有阶段设计您的 ECCD (ETL) 流程：提取、清洁、符合、交付。
*   如果可能，在每个阶段之后保留中间结果（文件）以用于审计和调试目的。
*   记录 ETL，如果使用脚本，请使用版本控制，以便您可以将脚本版本与存档（中间）文件匹配。
*   有数据谱系图，Excel聊胜于无。也保留版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:57:35.973

我会说 2.: 位列 -> 作为 bool cols 工作 -> 只允许 1/0 (true/false) -> 约束 ok

# c++ - #error WINDOWS.H 已包含在内。MFC 应用程序不得#include

> ID：1017814
> 
> 赞同：23
> 
> 时间：2009-06-19T12:51:12.320
> 
> 标签：c++, windows, mfc

我收到#error WINDOWS.H 已经包含在内。MFC 应用程序不能#include windows.h 但我不知道如何找出这是由于哪个文件发生的

谢谢

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-19T12:54:24.593

尝试在项目设置（C/C++ -> 高级）中打开“显示包含”。这个节目给你一个指示，包括哪些头文件以及以什么顺序 - 你应该能够从那里追溯

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-05-31T12:30:33.997

更改包含顺序，并在其他之前包含 afx < headers >

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T12:54:12.283

首先，查看错误发生时编译的翻译单元（cpp 文件）（参见构建日志）。

然后...您可以检查该 cpp 文件包含的头文件，查找`<windows.h>`.

您还可以在所有项目文件中搜索以检查它是否包含在您的代码中。

如果您正在使用包含 windows.h 头文件的其他 3rd 方库，那么您可能会被迫更改这些头文件和 MFC 头文件的包含顺序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-29T11:05:48.397

检查可能`Windows.h`包含在您的`stdafx.h`文件中。如果是这样，请评论`Windows.h`然后检查，错误可能会消失。因为我有同样的问题，我以同样的方式解决。

# ruby-on-rails - 液体插件

> ID：1017816
> 
> 赞同：3
> 
> 时间：2009-06-19T12:51:24.100
> 
> 标签：ruby-on-rails, liquid

我在我的应用程序中使用液体插件。在使用 form_for、check_box_tag 等 Rails 辅助方法时，我收到一个错误 form_for not defined..

有人知道如何通过液体插件使用rails helper 方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T13:46:40.493

不久前我刚刚处理过这个问题——如果你想更好地理解扩展普通过滤器需要什么（包括你可能想要的辅助方法），我发现这个 Railscast 非常有用： [http ://railscasts.com/episodes /118-液体](http://railscasts.com/episodes/118-liquid)

基本上，您需要设置自己的过滤器文件并包含您要使用的帮助器模块，然后添加一个使用该帮助器的方法（过滤器）。这并不难，只需一秒钟即可设置。在 Ryan 的示例中，他在 lib 中设置了一个名为 LiquidFilters 的模块，包括他想要的数字助手并将其设置为使用货币过滤器，如下所示：

```
# lib/liquid_filters.rb
module LiquidFilters
  include ActionView::Helpers::NumberHelper

  def currency(price)
    number_to_currency(price)
  end
end 
```

然后你所要做的就是记住当你解析要添加的液体内容时 :filters => [LiquidFilters] （获取你想要使用的过滤器模块数组）并且它应该自动拾取它。此方法还确保如果您想设置更多自定义过滤器或修改辅助过滤器，您可以轻松直观地执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-03T22:26:27.153

您可以直接使用 html 代码作为实例，而不是使用**link_to**（不起作用！），在液体模板中，您可以编写带有液体标签的 html 代码：

```
<a href="{link}">{{link_name}}</a>" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T13:04:22.810

> 有人知道如何通过液体插件使用rails helper 方法吗？

Liquid 有自己的助手，称为过滤器。请参阅[https://github.com/Shopify/liquid/wiki/Liquid-for-Designers](https://github.com/Shopify/liquid/wiki/Liquid-for-Designers)。

您可以决定在将值传递给液体之前应用帮助程序，或者扩展液体注册您自己的过滤器（请参阅[https://github.com/Shopify/liquid/wiki/Liquid-for-Programmers](https://github.com/Shopify/liquid/wiki/Liquid-for-Programmers)）。

如果您将 Liquid 注册为 Rails 模板处理程序，Liquid 会尝试使用您的帮助程序作为过滤器。

但是，您需要使用 Liquid 语法。

```
{{ 'This is a long section of text' | truncate: 3 }} 
```

不是

```
{{ truncate('This is a long section of text', 3) }} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T13:01:05.467

看看这个名为“Clots”的 Liquid 项目。据说它解决了这个问题（我没有亲自使用它）。

[http://github.com/ludicast/clots/tree/master](http://github.com/ludicast/clots/tree/master)

# algorithm - 判断一棵树是否是其他树的子树

> ID：1017821
> 
> 赞同：7
> 
> 时间：2009-06-19T12:52:02.897
> 
> 标签：algorithm, binary-tree

有两个二叉树 T1 和 T2 存储字符数据，允许重复。
如何确定 T2 是否是 T1 的子树？.
T1 有数百万个节点，T2 有数百个节点。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-19T12:59:59.650

穿越T1。如果当前节点等于 T2 的根节点，则同时遍历两棵树（T2 和 T1 的当前子树）。比较当前节点。如果它们总是相等，则 T2 是 T1 的子树。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T13:06:45.550

我建议使用预处理的算法：

1）预处理T1树，保留所有可能的子树根的列表（缓存列表将有数百万个条目）；

2) 将缓存的根列表按数据的降序排序，保存在根中。您可以选择更优雅的排序功能，例如将字符树解析为字符串。

3) 使用二分查找来定位必要的子树。您可以快速拒绝节点数不等于 T2 节点数（或具有不同深度）的子树。

请注意，步骤 1) 和 2) 必须只执行一次，然后您可以使用相同的预处理结果测试许多子树候选者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T13:04:05.510

*如果您的树没有以任何方式排序，除了进行蛮力*搜索之外，我看不到任何其他方法：遍历树`T1`并检查您是否到达与树的第一个节点匹配的节点`T2`。如果没有，继续遍历`T1`。如果是这样，检查下一个节点是否匹配，直到找到 的结尾`T2`，在这种情况下，你有一个命中：你的树`T2`确实是 的子树`T1`。

如果您知道`T1`（从叶到节点）的每个单个节点的深度，则可以跳过任何不如您要查找的子树那么深的节点。这可以帮助您消除很多不必要的比较。这么说`T1`并且`T2`平衡良好，则树`T1`的总深度为 20 ( `2**20`> `1,000,000`)，树`T2`的深度为 7 ( `2**7`> `100`)。您只需要走 13 个第一*层*（`T1`8192 个节点 - 还是 14 层和 16384 个节点？），并且能够跳过大约 90% 的`T1`...

但是，如果通过*子树*表示 的叶节点`T2`也是 的叶节点`T1`，那么您可以进行第一次遍历`T1`并计算每个节点的深度（从叶到节点的距离），然后只检查具有相同深度的子树作为`T2`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T14:22:00.500

如果您受内存/存储限制（即无法预先操作并以替代形式存储树），那么您可能无法比其他一些答案建议的蛮力搜索做得更好（遍历 P1 寻找匹配 P2 的根，遍历两者以确定该节点是否实际上是匹配子树的根，如果不匹配则继续原始遍历）。此搜索在 O(n * m) 中进行，其中 n 是 P1 的大小，m 是 P2 的大小。根据您可用的树数据，通过深度检查和其他潜在的优化，这个人被优化了一点，但它通常仍然是 O(n * m)。根据您的具体情况，这可能是唯一合理的方法。

如果您不受内存/存储限制并且不介意一点复杂性，我相信这可以通过在[广义后缀树](http://en.wikipedia.org/wiki/Generalised_suffix_tree)的帮助下减少到[最长的公共子字符串](http://en.wikipedia.org/wiki/Longest_common_substring_problem)问题来改进到 O(n + m) 。可以在[此处](http://www.ocf.berkeley.edu/~wwu/cgi-bin/yabb/YaBB.cgi?board=riddles_cs&action=display&num=1183111029)找到针对类似问题的一些讨论。也许当我有更多时间时，我会回来编辑更多关于实现的细节。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-08T10:22:17.450

如果给定两棵树的根，并且给定节点属于同一类型，那么为什么仅仅确定 T2 的根在 T1 中是不够的？

我假设“给定一棵树 T”意味着给定一个指向 T 根的指针和节点的数据类型。

问候。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T13:26:00.567

我不确定，我的想法是否正确。尽管如此，对于您的个人而言。

1.  在树 1 和树 2 中进行 postorder walk，称为 P1 和 P2。
2.  比较 P1 和 P2。如果他们不同。树不是子树。出口。
3.  如果它们相同，或者 P1 包含在 P2 中。您可以决定哪一个是子树。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-25T15:37:30.883

我认为我们需要通过蛮力进行，但是为什么在 T1 中找到 T2 的根之后还需要匹配树。它与我们不应该查找树是否相同时不同。（那么我们只需要比较整棵树）

你得到的是树 T1 和 T2，指针，而不是值。

如果节点 T2（它是一个指针）存在于 T1 树中。

那么树 T2 是 T1 的子树。

* * *

编辑：

只有当它说T2实际上是一个不同的Tree by object wise时，我们需要找出T1中是否存在与T2相同的子树。

那么这将不起作用。

我们别无选择，只能选择这里已经讨论过的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-19T09:25:48.100

假设我们有 T1 作为父树，T2 作为可能是 T1 的子树的树。请执行下列操作。假设 T1 和 T2 是没有任何平衡因素的二叉树。

1) 在 T1 中搜索 T2 的根。如果没有找到 T2 不是子树。在 BT 中搜索元素将花费 O(n) 时间。

2）如果找到元素，则从找到T2的节点根元素对T1进行前序遍历。这将花费 o(n) 时间。也做 T2 的前序遍历。将花费 O(n) 时间。前序遍历的结果可以存储到堆栈中。在堆栈中插入只需要 O(1)。

3) 如果两个栈的大小不相等，则 T2 不是子树。

4) 从每个堆栈中弹出一个元素并检查是否相等。如果发生不匹配，则 T2 不是子树。

5）如果所有匹配的元素T2是一个子树。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-19T09:31:44.327

我假设您的树是**不可变的树**，因此您永远不会更改任何子树（在 Scheme 用语中您不会这样做`set-car!`），而只是您正在从叶子或现有树构建新树。

然后我建议在每个节点（或子树）中**保留该节点****的哈希码**。在 C 语言中，将树声明为

```
 struct tree_st {
   const unsigned hash;
   const bool isleaf;
   union {
     const char*leafstring; // when isleaf is true
     struct { // when isleaf is false
        const struct tree_st* left;
        const struct tree_st* right;
     };
   };
 }; 
```

然后在构建时计算哈希，在比较节点是否相等时，首先比较它们的哈希是否相等；大多数时候哈希码会有所不同（您不会费心比较内容）。

这是一个可能的叶子构造函数：

```
struct tree_st* make_leaf (const char*string) {
   assert (string != NULL);
   struct tree_st* t = malloc(sizeof(struct tree_st));
   if (!t) { perror("malloc"); exit(EXIT_FAILURE); };
   t->hash = hash_of_string(string);
   t->isleaf = true;
   t->leafstring = string;
   return t;
} 
```

计算哈希码的函数是

```
unsigned tree_hash(const struct tree_st *t) {
  return (t==NULL)?0:t->hash;
} 
```

`sleft`从两个子树&构造一个节点的函数`sright`是

```
struct tree_st*make_node (const struct tree_st* sleft,
                          const struct tree_st* sright) {
   struct tree_st* t = malloc(sizeof(struct tree_st));
   if (!t) { perror("malloc"); exit(EXIT_FAILURE); };
   /// some hashing composition, e.g.
   unsigned h = (tree_hash(sleft)*313) ^ (tree_hash(sright)*617);
   t->hash = h;
   t->left = sleft;
   t->right = sright;
   return t;
 } 
```

比较函数（两棵树`tx`& `ty`）利用如果哈希码不同，则比较数不同

```
bool equal_tree (const struct tree_st* tx, const struct tree_st* ty) {
  if (tx==ty) return true;
  if (tree_hash(tx) != tree_hash(ty)) return false;
  if (!tx || !ty) return false;
  if (tx->isleaf != ty->isleaf) return false;
  if (tx->isleaf) return !strcmp(tx->leafstring, ty->leafstring);
  else return equal_tree(tx->left, ty->left) 
              && equal_tree(tx->right, ty->right); 
```

}

大多数情况下，`tree_hash(tx) != tree_hash(ty)`测试会成功，您不必递归。

阅读[散列consing](https://en.wikipedia.org/wiki/Hash_consing)。

一旦您拥有如此高效的基于哈希的`equal_tree`函数，您就可以使用其他答案（或手册）中提到的技术。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-01T18:11:42.153

一种简单的方法是为树编写 is_equal() 方法并执行以下操作，

```
bool contains_subtree(TNode*other) {
    // optimization
    if(nchildren < other->nchildren) return false;
    if(height < other->height) return false;

    // go for real check
    return is_equal(other) || (left != NULL && left->contains_subtree(other)) || (right != NULL && right->contains_subtree(other));
} 
```

请注意， is_equal() 可以通过对树使用哈希码进行优化。它可以通过将树的高度或子节点的数量或值的范围作为哈希码以简单的方式完成。

```
bool is_equal(TNode*other) {
    if(x != other->x) return false;
    if(height != other->height) return false;
    if(nchildren != other->nchildren) return false;
    if(hashcode() != other->hashcode()) return false;
    // do other checking for example check if the children are equal ..
} 
```

当树类似于链表时，将花费 O(n) 时间。在选择孩子进行比较时，我们也可以使用一些启发式方法。

```
bool contains_subtree(TNode*other) {
    // optimization
    if(nchildren < other->nchildren) return false;
    if(height < other->height) return false;

    // go for real check
    if(is_equal(other)) return true;
    if(left == NULL || right == NULL) {
          return (left != NULL && left->contains_subtree(other)) || (right != NULL && right->contains_subtree(other));
    }
    if(left->nchildren < right->nchildren) { // find in smaller child tree first
          return (left->contains_subtree(other)) || right->contains_subtree(other);
    } else {
          return (right->contains_subtree(other)) || left->contains_subtree(other);
    }
} 
```

另一种方法是将两个树序列化为字符串并查找第二个字符串（从 T2 序列化）是否是第一个字符串的子字符串（从 T1 序列化）。

以下代码预先序列化。

```
 void serialize(ostream&strm) {
            strm << x << '(';
            if(left)
                    left->serialize(strm);
            strm << ',';
            if(right)
                    right->serialize(strm);
            strm << ')';
    } 
```

我们可以使用一些优化的算法，例如[Knuth-Morris-Pratt 算法](https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)来查找（可能在 O(n) 时间内）子字符串的存在，并最终确定一棵树是否是 other 的子树。

再次使用 Burrows–Wheeler_transform 可以有效地压缩字符串。并且可以使用[bzgrep](http://linux.die.net/man/1/bzgrep)在压缩数据中搜索子字符串。

另一种方法是按高度和子节点数对树中的子树进行排序。

```
bool compare(TNode*other) {
    if(height != other->height)
        return height < other->height;

    return nchildren < other->nchildren;
} 
```

请注意，将有 O(n^2) 个子树。为了减少数量，我们可以使用基于高度的一些范围。例如，我们只能对高度为 1000 到 1500 的子树感兴趣。

生成排序后的数据时，可以在其中进行二进制搜索，并在 O(lg n) 时间内查找它是否是子集（考虑到排序后的数据中没有重复）。

# c++ - C++ CGI和MySQL问题（mysql++）

> ID：1017824
> 
> 赞同：0
> 
> 时间：2009-06-19T12:52:56.577
> 
> 标签：c++, mysql, cgi, mysql++

我正在尝试在 cgi 程序中使用 c++，如果我不使用 mysql，一切都很好。如果没有 mysql，我的站点会在大约 1-2 毫秒内生成，但如果我只从 mysql++ 库中添加一个变量或函数，则站点会在大约 35 毫秒内生成！（使用 php 大约需要 15 - 25 毫秒）我想这是 dll 加载的问题（有两个，mysql dll 大约是 2 MB！）。那么，如何在不降低性能的情况下使用 mysql 呢？

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T14:56:30.057

也许您可以看一下[fastcgi](http://www.fastcgi.com/drupal/)，fastcgi 的目的是防止必须为每个请求启动可执行文件，可执行文件始终在运行，并且每个请求都通过套接字传输到您的 cgi。fastcgi 提供了一个库，可以轻松地以多种语言执行此操作。然后您必须配置您的 Web 服务器，例如 Apache 的 mod_fastcgi。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-11T15:16:40.253

**小心**

> 由于许可证 (LGPL) - 如果我不想共享我的代码，我必须动态链接 – chris Jun 19 at 14:05

请看一下这个讨论：
[关于 MySQL++、GPL 和 LGPL](https://stackoverflow.com/questions/1260591/about-mysql-gpl-and-lgpl)
如果你不发布编译的二进制文件，没关系，但是如果你想发布你的二进制文件，你也必须发布源代码，因为 MySQL++基于 GPL 库（mysql C 连接器）。
或者购买商业许可证。

干杯，

# javascript - Firefox上的ThickBox问题（溢出：隐藏无效）

> ID：1017830
> 
> 赞同：0
> 
> 时间：2009-06-19T12:53:57.213
> 
> 标签：javascript, firefox, overflow, thickbox

我需要有关厚盒的帮助。我在我的网站中使用它，但是一个溢出功能：隐藏，不在Firefox中工作，只在IE中工作。有人可以帮我吗？谢谢...

html和css没问题，我的问题是thickbox，因为它在IE 6或7中工作，但在mozilla（所有版本）中没有。看代码；

```
function tb_show(caption, url, imageGroup, leg, ttlTb) {//function called when the user clicks on a thickbox link
    try {
        if (typeof document.body.style.maxHeight === "undefined") {//if IE 6
            $("body","html").css({height: "100%", width: "100%"});
            $("html").css("overflow","hidden");     <!-- JUST IN IE6 -->
            if (document.getElementById("TB_HideSelect") === null) {//iframe to hide select elements in ie6
                $("body").append("<iframe id='TB_HideSelect'></iframe><div id='TB_overlay'></div><div id='TB_window'></div>");
                $("#TB_overlay").click(tb_remove);
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:00:34.033

首先，如果我们能看到导致问题的 html/css 以及它*如何*不工作的解释，这真的很有帮助。

其次，安装[firebug](http://getfirebug.com)扩展。打开 firebug (F12) 并检查您关注的元素。查看右侧的样式部分，了解实际应用了哪些样式。

**编辑**：

而不是设置溢出：隐藏在html上，尝试在body上设置......或者更好的是，在包含所有其他元素的div上

# c# - 如何将 XmlDataProvider 类属性绑定到 XAML TreeView

> ID：1017843
> 
> 赞同：0
> 
> 时间：2009-06-19T12:57:41.200
> 
> 标签：c#, data-binding, xaml, xmldataprovider

我想将我在 XAML 中定义的 TreeView 控件绑定到其代码隐藏类中的属性。我已经阅读了[WPF Basic Data Binding FAQ](http://blogs.msdn.com/wpfsdk/archive/2006/10/19/wpf-basic-data-binding-faq.aspx)，但是当我尝试使用 XmlDataProvider 作为绑定源时，页面底部注释中的示例不起作用。

如何修改以下代码，以便在 XAML 中而不是在类的构造函数中定义绑定？换句话说，如何修改 TreeView 的`ItemsSource`属性以引用其代码隐藏类中的属性？

### SomeClass.xaml - 作品

```
<UserControl x:Class="SomeNamespace.SomeClass"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <XmlDataProvider x:Key="SomeTreeData" />
    </UserControl.Resources>
    <TreeView Name="SomeTree" ItemsSource="{Binding Source={StaticResource SomeTreeData}, XPath=*}">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="items" ItemsSource="{Binding XPath=*}">
                <TextBlock Text="{Binding XPath=@Header}" />
            </HierarchicalDataTemplate>
            <HierarchicalDataTemplate DataType="item" ItemsSource="{Binding XPath=*}">
                <TextBlock Text="{Binding XPath=@Header}" />
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</UserControl> 
```

### SomeClass.xaml.cs - 作品

```
public partial class SomeClass : UserControl
{
    public SomeClass()
    {
        InitializeComponent();

        XmlDataProvider lSomeTreeData
            = this.FindResource("SomeTreeData") as XmlDataProvider;
        lSomeTreeData.Document = new XmlDocument();
        lSomeTreeData.Document.LoadXml("<items xmlns=\"\" Header=\"Some items\"><item Header=\"Some item\" /></items>");
    }
} 
```

### SomeClass.xaml - 所需

注意`{SOME MAGIC}`TreeView 的`ItemsSource`属性。

```
<UserControl x:Class="SomeNamespace.SomeClass"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <TreeView Name="SomeTree" ItemsSource="{Binding Source={SOME MAGIC}, XPath=*}">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="items" ItemsSource="{Binding XPath=*}">
                <TextBlock Text="{Binding XPath=@Header}" />
            </HierarchicalDataTemplate>
            <HierarchicalDataTemplate DataType="item" ItemsSource="{Binding XPath=*}">
                <TextBlock Text="{Binding XPath=@Header}" />
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</UserControl> 
```

### SomeClass.xaml.cs - 所需

```
public partial class SomeClass : UserControl
{
    public XmlDataProvider SomeXmlDataProvider { get; set; }

    public SomeClass()
    {
        InitializeComponent();

        this.SomeXmlDataProvider = new XmlDataProvider();
        this.SomeXmlDataProvider.Document = new XmlDocument();
        this.SomeXmlDataProvider.Document.LoadXml("<items xmlns=\"\" Header=\"Some items\"><item Header=\"Some item\" /></items>");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T03:53:21.017

我发现一种选择是设置控件的`DataContext`：

```
<UserControl x:Class="SomeNamespace.SomeClass"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <TreeView ItemsSource="{Binding XPath=/items}">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="items" ItemsSource="{Binding XPath=*}">
                <TextBlock Text="{Binding XPath=@Header}" />
            </HierarchicalDataTemplate>
            <HierarchicalDataTemplate DataType="item" ItemsSource="{Binding XPath=*}">
                <TextBlock Text="{Binding XPath=@Header}" />
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</UserControl> 
```

* * *

```
public partial class SomeClass : UserControl
{
    public XmlDataProvider SomeXmlDataProvider { get; set; }

    public SomeClass()
    {
        InitializeComponent();

        this.SomeXmlDataProvider = new XmlDataProvider();
        this.SomeXmlDataProvider.Document = new XmlDocument();
        this.SomeXmlDataProvider.Document.LoadXml("<items Header=\"Some items\"><item Header=\"Some item\" /></items>");

        this.DataContext = this.SomeXmlDataProvider.Document;
    }
} 
```

# android - Android：如何重绘图形元素？

> ID：1017853
> 
> 赞同：17
> 
> 时间：2009-06-19T13:00:38.730
> 
> 标签：android, user-interface, refresh

我创建了一个类 RoundIcon 扩展 View 并且该类包含 setIconImage() 方法：

```
public void setIconImage(int imageFromResources) {
    iconImage = BitmapFactory.decodeResource(getResources(), imageFromResources);
    iconWidth = iconImage.getWidth();
    iconHeight = iconImage.getHeight();
    refreshDrawableState();
} 
```

并且有一个方法 onDraw()：

```
@Override
protected void onDraw(Canvas canvas) {

    if(px == 0 || py == 0)
    {
        px = 50;
        py = 50;
    }

    canvas.drawCircle(px, py, circleRadius, circlePaint);
    canvas.save();

    if(iconImage != null)
    {
        int cardinalX = px - iconWidth/2;
        int cardinalY = py - iconHeight/2;
        canvas.drawBitmap(iconImage, cardinalX, cardinalY, iconPaint);
    }

    canvas.restore();
} 
```

问题是每次从主活动调用方法 setIconImage() 时，函数 onDraw() 都不会执行，因此用户界面中的图标不会改变。

有谁知道如何修改代码以便在每次调用 setIconImage 方法时重绘图像？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-19T13:58:51.123

尝试调用[View.invalidate()](http://developer.android.com/reference/android/view/View.html#invalidate())而不是[View.refreshDrawableState()](http://developer.android.com/reference/android/view/View.html#refreshDrawableState())

Invalidate 将告诉视图需要重绘视图中的所有像素，如果您只更新视图的较小区域，请查看 invalidate(Rect) 重载以提高性能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T18:39:38.853

绝对调用 invalidate 而不是 refreshDrawableState()。您可能想检查您使用的线程以及是否在后台调用 postInvalidate()。

# asp.net - 关于如何在浏览器（javascript）和服务器（asp.net web 服务/数据库）之间保持对象映射同步的输入？

> ID：1017860
> 
> 赞同：0
> 
> 时间：2009-06-19T13:02:50.067
> 
> 标签：asp.net, concurrency, synchronization, optimistic-locking

我的服务器上有一个对象映射（代表客户、订单、项目的对象，彼此相关，基于数据库中的内容）并且希望在用户正在操作的浏览器中保持该对象映射的最新版本并查看数据。

由于更多的用户可以同时访问和修改同一个对象映射，我需要一种方法来使客户端与服务器保持同步。

我的服务器环境基于.net/asp.net 3.5 sp1，客户端需要在浏览器（html/javascript）中运行。我正在考虑使用 asp.net ajax 4.0，因为它在客户端具有数据绑定功能和可观察的集合，并在服务器上使用诸如 .net ria 服务或 ado.net 数据服务之类的东西。

如果有人有任何经验或知道博客文章/教程/研究论文/文章/你的名字，关于这个话题，我真的很感激一个链接或评论。

最好的问候，埃吉尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:11:50.617

[并发控制](http://en.wikipedia.org/wiki/Concurrency_control)是一个复杂的领域，更多的是设计问题，而不是使用什么客户端/AJAX 工具。

例如：

1.  用户 A 打开对象 X（修改 if）
2.  用户 B 打开对象 X，对其进行修改并保存

此时，用户 A 将在保存时破坏用户 B 的更改（也称为最后胜出）。这个问题没有单一的最佳实践解决方案。尽管为工作选择正确的工具/库很重要，但您使用的 ASP.NET AJAX 版本是您最不必担心的。

这是一篇关于客户端/服务器架构的[简短文章。](http://jim-mcbeath.blogspot.com/2009/02/concurrent-editing-without-locking.html)它是用通俗易懂的术语写成的，是对您正在考虑的问题的一个非常好的介绍。

# visual-studio-2008 - 当我单击“不调试启动”(Ctrl-F5) 时，如何阻止我的 Visual Studio 启动 IE8 TWICE？

> ID：1017861
> 
> 赞同：6
> 
> 时间：2009-06-19T13:03:06.510
> 
> 标签：visual-studio-2008, internet-explorer-8

我主要将 Visual Studio 2008 用于 Web 开发，自从我在工作 PC 上升级到 IE8 后，似乎发生了一种令人讨厌的行为：

当我为网站或 Web 应用程序项目设置起始页，然后单击工具栏中的“不调试启动”图标或使用键盘快捷键 CTRL-F5 时，Visual Studio 继续启动 IE8（我的默认 Web 浏览器） ，但这样做**两次**：

IE8 打开的第一个新窗口有一个标签，上面写着“正在连接...”，它会加载 about:blank 页面。然后，另一个新的 IE8 窗口也打开，其中显示“正在连接...”的选项卡，并加载我在项目中设置的起始页。

这**很**烦人。有没有人有任何想法可能导致这种情况以及如何解决它？

在有人提出建议之前，我*已经*通过将 Firefox 作为我的默认浏览器来解决这个问题了一段时间；-) 但是，我想在 IE8 中使用 Visual Studio 的 javascript 调试功能，因此希望 IE8 再次成为我的默认浏览器，因为现在。

* * *

**附加信息：**

使用 Process Explorer，我可以看到两个**iexplore.exe**进程都是由同一个父进程启动的，即 Visual Studio 2008 的**devenv.exe**。

第一个 iexplore.exe 进程具有以下命令行：

```
"C:\Program Files\Internet Explorer\IEXPLORE.EXE" -noframemerging -debug about:blank
```

几秒钟后启动的第二个 iexplore.exe 进程具有以下命令行：

```
"C:\Program Files\Internet Explorer\IEXPLORE.EXE" -noframemerging -suspended -debug http://localhost/test/index.html
```

然后，我也尝试了进程监视器。在日志中，我可以在“C:\Program Files\Internet Explorer\IEXPLORE.EXE”上看到来自 devenv.exe 的**两个**不同的“Process Create”事件……相隔几秒钟。

有趣的是，如果我使用 Visual Studio 2005（而不是 2008）尝试完全相同的操作（无需调试即可启动），我只会看到使用以下命令行创建的单个进程：

```
"C:\Program Files\Internet Explorer\IEXPLORE.EXE" 关于：空白
```

对于 2005，视觉上看起来好像 about:blank 首先被加载，然后 URL 被相同的浏览器进程加载到与 about:blank 相同的选项卡中，并覆盖它。

我注意到另一件不同的事情：在 VS2005 Process Monitor 日志中，它显示了对文件“C:\WINDOWS\system32\ieframe.dll”的大量读取，但在 VS2008 Process Monitor 日志中没有显示相同的内容。（ieframe.dll 包含一些与 Internet Explorer 相关的 COM 对象的类型库。）因此，VS2005 启动和控制 IE 的方式可能与 VS2008 不同。

**最后**，这很奇怪：在 VS2008 中，如果我单击“不调试就开始”，我会得到两个窗口。但是，如果在解决方案资源管理器中，我改为*右键单击*我的网站项目或其中的任何 HTML 文件并选择“在浏览器中查看”，我只会得到一个窗口。为什么“在不调试的情况下启动”和“在浏览器中查看”之间的区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-26T15:57:57.307

嗯……很奇怪。如果您使用 SysInternal 的进程监视器，您能否查看第二个 IE 窗口是否由第一个启动，或者 Visual Studio 是否同时拥有它们？这可能有助于查明问题所在。

除此之外，接下来要尝试的是禁用大多数浏览器插件，看看这是否会有所作为。最后，尝试使用工具/Internet 选项/安全为 Intranet 和受信任的站点区域启用保护模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-04T12:09:16.447

感谢您将我指向附加组件。这种行为确实很烦人。在我的计算机上，它仅在禁用 Windows Live 工具栏附加组件时才会消失 - 并且只有在那时才会消失。启用相同的附加组件，问题将再次出现！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-08T05:23:29.423

[http://dpotter.net/Technical/2009/05/upgrading-to-ie8-breaks-debugging-with-visual-studio-2005/](http://dpotter.net/Technical/2009/05/upgrading-to-ie8-breaks-debugging-with-visual-studio-2005/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-16T12:31:50.330

很抱歉重复的答案，但禁用 Live 工具栏对我来说真的很棒，我想从 sjerp 那里得到答案，但由于我缺乏声誉，我认为值得重复它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-16T18:44:39.177

如果您获得两个浏览器实例，则在使用 IE8 和 Microsoft Visual Web Developer 2008 Express Edition 时禁用实时工具栏确实是正确的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T17:37:19.420

这可能与 IE 的“保护模式”有关。尝试将其关闭。您可以双击状态栏中的“保护模式”文本来执行此操作。

我也遇到了同样的问题，太烦人了！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-29T17:13:33.900

听起来好像 Visual Studio 正在利用旧行为。

具体来说，似乎 Visual Studio 正在加载 about:blank 以打开浏览器，然后通过对可执行文件的另一个调用加载页面。

尝试以下更改： 打开 Internet 属性 单击选项卡设置 在底部附近应该有一个部分显示“打开来自其他程序的链接：” 在该部分中选择当前选项卡或窗口

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-26T11:19:24.287

我们通过在 Windows XP 兼容模式（快捷方式设置）下启动 VS 2005 设法解决了这个问题。

# testing - 在进行 TDD 时发现其他对象

> ID：1017864
> 
> 赞同：11
> 
> 时间：2009-06-19T13:03:33.560
> 
> 标签：testing, tdd

我正在尝试练习 TDD。

**我的理解**是TDD应该是这样的

1.  为我要开发的接口/类写一个测试列表。
2.  从我的测试列表中最简单的未实现的测试开始。
3.  写测试，还没有实现代码。
4.  编写类的接口，使代码编译通过。
5.  运行测试导致一项测试失败。
6.  编写使测试通过的实现。
7.  重构我造成的混乱。
8.  转到 2。

**我遇到的问题**是在编写实现或进行重构时。我经常得出的结论是，我刚刚编写的实现应该委托给另一个类。

此时真正的 TDD 应该做什么？

1.  暂时搁置现有的测试列表，然后为新发现的课程创建一个新的列表*（在实施新课程时，同样的问题会表现出来）*
2.  采用基于交互的测试方式并模拟新类，继续使用您正在处理的类的测试用例，稍后再返回以创建模拟类的正确实现。
3.  这种情况不应该出现。我可能还没有很好地考虑我的初始设计。*（但这不会破坏 TDD 的目的之一吗？！）*。

我很想知道其他人如何处理这些情况。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T13:07:04.910

不要在你的测试和你的类之间寻找一对一的关系。如果您决定引入一个新类，则让它成为原始测试支持的重构，并在您想要添加功能（或测试您需要的可能性）时在适当的位置（取决于具体情况）添加测试以涵盖您尚未测试的内容）。

我要补充一点，TDD 的主要成功在于进入了红绿重构的节奏。当你感受到那种节奏的好处时，你就已经开始“得到”它了。这并不是说你会发现它在所有情况下都是值得的，但是在你感受到那种节奏之前，你还没有达到它的倡导者喜欢它的程度。

并且通常（尤其是在架构复杂的应用程序中，如 n 层应用程序）有一些预先设计。没有什么是一成不变的，但足以让这些单位有一个去处。当然，架构可能会以敏捷方法发展，但如果架构有多个层次，则需要有一个总体概念。

编辑：（回应评论）。新课程是否应该单独进行测试？不必要。这取决于班级是否发展了自己的重要性。当您进行单元测试时，您正在测试一个功能。它不是一个集成测试，因为它涉及到两个类。当两个单元开始交互时，它就变成了一个集成测试。我通常想到的边界是如果我必须在类组 A 中设置重要状态以与类组 B 交互，特别是如果类组 A 调用类组 B 以及什么我感兴趣的测试是 B 如何对 A 做出反应，然后我正在研究集成测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T14:51:32.873

> 我遇到的问题是，当我到达第 6 点和第 7 点时，在某个时间点，我总是得出结论，我刚刚编写的实现应该委托给另一个类。

使用不同的类来实现您的设计会更好——这就是设计，这就是 TDD 的重点。所以这是一件好事，它不应该打扰你。

但它困扰着你。那么该怎么办？认识到委派给另一个类是一种重构；*这是在第 6 步之后*，在第 7 步期间要做的事情。一旦你是绿色的，重构一个更好的设计。您已经完成了新课程的测试；他们只是有线呼叫原始课程。这完全没问题。在提取类和委派之后，如果您更愿意让测试直接调用提取的类：去吧。无害。如果提取的类开始被其他调用者使用，我会推荐它，也许当你开始从其他类调用它时是这样做的好时机（但如果它现在困扰你，现在就做）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T13:09:11.973

当我遇到这种情况时，我会遵循您的解决方案＃1。继续递归，尽可能多地创建你认为合适的类，直到你拥有一组你满意的实现。有了经验，你会发现你的设计反映了你的经验，这种事情不会发生太多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T13:08:07.997

您应该创建一个模拟类。具有可预测结果的单一界面。这样你就可以测试原版了。

稍后，您可以对新类重复该过程。

# c# - 如何在不复制粘贴的情况下以相同的方式扩展两个类？

> ID：1017870
> 
> 赞同：2
> 
> 时间：2009-06-19T13:04:50.513
> 
> 标签：c#, .net

我写了一个 owner-drawn `TabControl`，但我们的项目也使用`TabWorkspace`了从`TabControl`. 目前，我有

```
public class OurTabControl : TabControl
{
     // some code that overrides protected methods
}

public class OurTabWorkspace : TabWorkspace
{
    // the same code
} 
```

我只想让共享代码出现在一个地方，这样我们就不必维护两个副本。这在 C# 中是否可行，如果可以，如何实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T13:11:00.987

您可以使用接口并编写扩展方法来做到这一点。

```
class OurTabControl: IBehavior
class OurTabWorkspace: IBehavior

interface IBehavior
{    
}

static class BehaviorExtensions
{
   static [returntype] RepeatedBehavior(this IBehavior behavior)
   {
       //repeated code here
   } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:12:14.667

也许将共享代码重构为一组静态方法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T14:10:59.163

您可以创建一个包含公共代码的内部帮助程序类，并将其作为 OurTabControl 和 OurTabWorkspace 中的私有成员引用。由于 TabWorkspace 扩展了 TabControl，您应该能够利用多态性并将 TabControl 参数传递给辅助类中的方法。您仍然需要覆盖两个扩展类中的任何常用方法，并从那里调用辅助类方法和/或基方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T13:57:06.370

使用部分类怎么样？或者，如何在一个类中定义所有共享方法并让两个继承的类实例化它。

# wcf - 如何在控制台应用程序中调用 Windows 服务？

> ID：1017875
> 
> 赞同：0
> 
> 时间：2009-06-19T13:05:17.003
> 
> 标签：wcf, windows-services, console-application

我写了一个 WCF 服务，我想称之为网络管道绑定方式。我已将其部署在 Windows 服务中。

我在我的 wcf 服务中编写了这个方法：

```
Add(2,1) 
```

它应该返回 3

我不知道如何在我的客户端控制台应用程序中调用 Windows 中托管的服务。我已经开始我的服务了。

* * *

### 笔记：

我想从 Windows 服务调用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T15:51:14.240

需要使用 ChannelFactory 创建代理，然后才能使用代理执行 wcf 任务。

[http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication](http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:10:51.033

你想要这样的东西：

```
NetNamedPipeBinding binding = new NetNamedPipeBinding();
EndpointAddress address = new EndpointAddress("net.pipe://localhost/Foo");
ChannelFactory<IFoo> factory = 
    new ChannelFactory<IFoo>(binding, address);

IFoo foo = factory.CreateChannel();
int result = foo.Add(2, 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T13:12:57.520

如果`IMyContract`是您的服务合同，您可以创建一个代理来使用 ChannelFactory 类调用您的服务：

```
var proxy = ChannelFactory<IMyContract>.CreateChannel(new NetMsMqBinding(), new EndpointAddress("net.msmq://..."))
proxy.Add(1, 2); 
```

# html - 设置 float:left 时将 div 扩展到最大宽度

> ID：1017880
> 
> 赞同：116
> 
> 时间：2009-06-19T13:07:56.640
> 
> 标签：html, width

我有类似的东西：

```
<div style="width:100px;float:left">menu</div>
<div style="float:left">content</div> 
```

两个花车都是必需的。我希望内容 div 填满整个屏幕，减去菜单的 100 像素。如果我不使用浮动，则 div 会完全按照应有的方式扩展。但是当设置浮动时我该如何设置呢？如果我使用 sth like

```
style=width:100% 
```

然后内容 div 获取父级的大小，这是我也尝试过的主体或另一个 div，所以它当然不适合菜单的右侧，然后显示在下面。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-06-19T13:27:39.360

希望我对你的理解正确，看看这个：http: [//jsfiddle.net/EAEKc/](http://jsfiddle.net/EAEKc/)

```
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Content with Menu</title>
  <style>
    .content .left {
      float: left;
      width: 100px;
      background-color: green;
    }

    .content .right {
      margin-left: 100px;
      background-color: red;
    }
  </style>
</head>

<body>
  <div class="content">
    <div class="left">
      <p>Hi, Flo!</p>
    </div>
    <div class="right">
      <p>is</p>
      <p>this</p>
      <p>what</p>
      <p>you are looking for?</p>
    </div>
  </div>
</body>

</html>
```

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2012-04-10T22:07:34.457

我发现这样做的最交叉兼容的方式不是很明显。您需要从第二列中删除浮动，并将其应用于`overflow:hidden`它。尽管这似乎隐藏了 div 之外的任何内容，但它实际上强制 div 留在其父级中。

使用您的代码，这是一个如何完成的示例：

```
<div style="width: 100px; float: left;">menu</div>
<div style="overflow: hidden;">content</div> 
```

希望这对遇到此问题的任何人都有用，在尝试使其适应其他分辨率之后，我发现它最适合我正在构建的站点。不幸的是，如果您在内容之后也包含一个右浮动，这将不起作用`div`，如果有人知道一种让它工作的好方法，并且具有良好的 IE 兼容性，我会很高兴听到它。

## 使用新的、更好的选择`display: flex;`

既然 Flexbox 模型已经得到了相当广泛的实施，我实际上建议使用它，因为它允许更多`flex`的布局能力。这是一个简单的两列，就像原来的一样：

```
<div style="display: flex;">
    <div style="width: 100px;">menu</div>
    <div style="flex: 1;">content</div>
</div> 
```

这是一个具有灵活宽度中心列的三列！

```
<div style="display: flex;">
    <div style="width: 100px;">menu</div>
    <div style="flex:1;">content</div>
    <div style="width: 100px;">sidebar</div>
</div> 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-02-28T07:57:01.780

## 不固定边距大小的解决方案

```
.content .right{
    overflow: auto; 
    background-color: red;
} 
```

Merkuro +1，但如果浮动的大小发生变化，您的固定边距将失败。如果你在右边使用上面的 CSS，`div`它会很好地改变大小，改变左边浮动的大小。它有点像那样灵活。在这里检查小提琴：http: [//jsfiddle.net/9ZHBK/144/](http://jsfiddle.net/9ZHBK/144/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-19T13:26:33.280

浮动的元素会脱离正常的流布局，并且块元素（例如 DIV）不再跨越其父元素的宽度。在这种情况下规则会发生变化。与其重新发明轮子，不如查看此站点以获取一些可能的解决方案来创建您所追求的两列布局：http: [//www.maxdesign.com.au/presentation/page_layouts/](http://www.maxdesign.com.au/presentation/page_layouts/)

具体来说，“液体两列布局”。

干杯!

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-11-19T01:42:31.543

这种用法可能会解决您的问题。

```
width: calc(100% - 100px); 
```

```
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Content with Menu</title>
  <style>
    .content .left {
      float: left;
      width: 100px;
      background-color: green;
    }

    .content .right {
      float: left;
      width: calc(100% - 100px);
      background-color: red;
    }
  </style>
</head>

<body>
  <div class="content">
    <div class="left">
      <p>Hi, Flo!</p>
    </div>
    <div class="right">
      <p>is</p>
      <p>this</p>
      <p>what</p>
      <p>you are looking for?</p>
    </div>
  </div>
</body>

</html>
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-03-04T10:14:39.057

*如果有人感兴趣且不喜欢“浮动”，这是 HTML 5 的更新解决方案。*

在这种情况下，表格效果很好，因为您可以将固定宽度设置为表格和表格单元格。

```
.content-container{
    display: table;
    width: 300px;
}

.content .right{
    display: table-cell;   
    background-color:green;
    width: 100px;
} 
```

[http://jsfiddle.net/EAEKc/596/](http://jsfiddle.net/EAEKc/596/) 来自@merkuro 的原始源代码

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-12-12T15:04:28.673

并且基于`merkuro`的解决方案，如果您想最大化左边的那个，您应该使用：

```
<!DOCTYPE html>   
<html lang="en">     
    <head>              
        <meta "charset="UTF-8" />   
        <title>Content with Menu</title>                 
        <style>
            .content .left {
                margin-right: 100px;
                background-color: green;
            }
            .content .right {
                float: right;
                width: 100px;
                background-color: red;
            }
        </style>              
    </head>
    <body>        
        <div class="content">
            <div class="right">  
                <p>is</p>
                <p>this</p>
                <p>what</p>
                <p>you are looking for?</p>
            </div>
            <div class="left">
                <p>Hi, Flo!</p>
            </div>
        </div>
    </body>
</html> 
```

没有在 IE 上测试过，所以它在 IE 上可能看起来坏了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-19T13:33:05.230

接受的答案可能有效，但我不喜欢重叠边距的想法。在 HTML5 中，您可以使用`display: flex;`. 这是一个干净的解决方案。只需为一个元素和`flex-grow: 1;`动态元素设置宽度。merkuros fiddle 的编辑版本：[https ://jsfiddle.net/EAEKc/1499/](https://jsfiddle.net/EAEKc/1499/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-21T10:55:14.273

嗨，有一种简单的方法可以在右侧元素上使用溢出隐藏方法。

```
 .content .left {
        float:left;
        width:100px;
        background-color:green;
      }
      .content .right {
        overflow: hidden;
        background-color:red;
      }
```

```
<!DOCTYPE html>   
<html lang="en">     
    <head>      

        <title>Content Menu</title>         

    </head>
    <body>    
    <div class="content">
      <div class="left">
        <p>Hi, Flo! I am Left</p>
      </div>
      <div class="right">  
        <p>is</p>
        <p>this</p>
        <p>what</p>
        <p>you are looking for?</p>
        <p> It done with overflow hidden and result is same.</p>
      </div>
    </div>
    </body>
</html> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-09-25T01:06:27.323

这可能有效：

```
 div{
    display:inline-block;
    width:100%;
    float:left;
    } 
```

# .net - .NET CF 自动滚动

> ID：1017887
> 
> 赞同：0
> 
> 时间：2009-06-19T13:10:42.920
> 
> 标签：.net, compact-framework

我有一个包含多个页面的 TabControl。在一页上，我只有一个标签，我希望它填满页面并在必要时滚动。尽管尝试了看起来像锚和停靠的每种组合，但标签不会滚动。我已将页面的 AutoScroll 属性设置为 true，但没有运气。我看过关于使用 ScrollBar 和手动处理滚动的文章，但看起来有点粗糙。这是真的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-28T21:00:50.343

只有当子控件跨越的区域大于 TabControl 提供的空间时，AutoScroll 才会有所帮助。因此，当使用停靠（标签的大小受可用空间限制）时，它永远不会变得足够大以迫使滚动条出现。

您是否考虑过使用只读文本框控件？将此设置为 DockStyle.Fill 应该会获得您正在寻找的效果，如果文本溢出可用空间，则会出现滚动条。

如果您想使用标签控件，您很可能需要手动调整其大小。José Gallardo Salazar的[以下博客文章](http://www.mobilepractices.com/2007/12/multi-line-graphicsmeasurestring.html)概述了一种方法来确定显示给定文本字符串（包括任何所需的自动换行等）需要多少空间。如果标签控件变得比 TabControl 大，则 AutoScroll 功能应该开始自动工作。

# python - 使用 html 模板格式化 csv 文件数据

> ID：1017898
> 
> 赞同：5
> 
> 时间：2009-06-19T13:12:25.383
> 
> 标签：python, html, ruby, formatting, csv

我有一个 csv 文件**data**和一个 HTML 文件**template**。

我想要一个脚本，它将使用 html 文件作为模板，从 csv 文件中为每条记录创建一个单独的 html 文件。

在 Ruby 中执行此操作的最佳方法是什么？Python？有没有我可以用这两种语言使用的工具/库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T14:54:49.840

[带有Jinja2](http://jinja.pocoo.org/2/)的Python 。

```
import jinja
import csv

env= jinja.Environment()
env.loader= jinja.FileSystemLoader("some/directory")
template= env.get_template( "name" )

rdr= csv.reader( open("some.csv", "r" ) )
csv_data = [ row for row in rdr ]

print template.render( data=csv_data ) 
```

事实证明，您可能只需将其`rdr`直接传递给 Jinja 进行撕裂即可逃脱。

如果模板看起来像这样，它将适用于各种 Python 结构，包括迭代器。

```
<table>
{% for row in data %}
<tr>
    <td>{{ row.0 }}</td><td>{{ row.1 }}</td>
</tr>
{% endfor %}
</table> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T13:14:40.027

Ruby 内置了 CSV 处理，这使得输出静态 HTML 文件变得相当简单。
看：

*   [http://www.rubytips.org/2008/01/06/csv-processing-in-ruby/](http://www.rubytips.org/2008/01/06/csv-processing-in-ruby/)
*   [http://www.ruby-doc.org/stdlib/libdoc/csv/rdoc/index.html](http://www.ruby-doc.org/stdlib/libdoc/csv/rdoc/index.html)

实际上，Python 也是如此，所以这实际上是个人喜好问题（或者您已经配置的任何一个）。

# ruby - 红宝石林间空地/gtkbuilder 的例子？

> ID：1017908
> 
> 赞同：3
> 
> 时间：2009-06-19T13:14:50.713
> 
> 标签：ruby, gtk, glade, gtkbuilder

我在新版本的 glade3 中使用 ruby​​ 和 glade2 来设计用户界面一段时间，我可以使用 gtkbuilder 格式生成 xml 文件而不是 libglade。

有什么例子吗？我搜索了谷歌，但我没有运气！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-24T07:00:33.737

这真的很简单：只需使用 Glade 创建您的 GUI（并将其保存为 GtkBuilder），然后在 ruby​​ 中使用它：

```
require 'rubygems'
require 'gtk2'
# require 'libglade2' #you don't need this anymore

builder = Gtk::Builder.new
builder.add_from_file(file)
builder.connect_signals {|handler| method(handler) } 
```

第一行创建 Builder 对象，该对象负责`Glib::Objects`从您的 xml 定义中创建并存储它们以供以后使用（您可以调用`get_object(objname)`builder，它将返回用 定义的小部件`objname`）。

第二行实际上加载了您的接口定义，其中`file`是您的 gtkbuilder 文件的路径。

第三行有点模糊。`connect_signals`为您在接口中定义的每个信号调用一次提供的块。`handler`只是一个字符串（信号的名称）。您应该从块中返回一个过程（或任何可调用的）：每次触发`call`定义的信号时都会调用该块。`handler`在此示例中，该块仅返回一个与信号同名的方法（并且，为简单起见，假设接口中定义的每个信号都有一个方法）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T13:42:15.667

You're right on the lack of pre-written tutorials, but the usage of gtkbuilder in Ruby is almost identical to Python (same function names, call orders) so these might be of interest -

GTK::Builder module: [http://ruby-gnome2.sourceforge.jp/hiki.cgi?Gtk%3A%3ABuilder](http://ruby-gnome2.sourceforge.jp/hiki.cgi?Gtk%3A%3ABuilder)

Python code:

```
import sys
import gtk

class TutorialTextEditor:

    def on_window_destroy(self, widget, data=None):
        gtk.main_quit()

    def __init__(self):

        builder = gtk.Builder()
        builder.add_from_file("tutorial.xml") 

        self.window = builder.get_object("window")
        builder.connect_signals(self)       

if __name__ == "__main__":
    editor = TutorialTextEditor()
    editor.window.show()
    gtk.main() 
```

Source: [http://www.micahcarrick.com/01-01-2008/gtk-glade-tutorial-part-3.html](http://www.micahcarrick.com/01-01-2008/gtk-glade-tutorial-part-3.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T15:08:20.627

另一个工作版本，面向对象的形式：

```
require 'gtk2'

class Builder < Gtk::Builder

def initialize xml
        super()

        self.add_from_string(xml)

    self['main'].set_window_position Gtk::Window::POS_CENTER
        self['main'].signal_connect('destroy') { Gtk.main_quit }
        self['main'].show_all

    self.connect_signals{ |handler| method(handler) }

end

def on_button_clicked w

    case w.label
            when 'quit'
                Gtk::main_quit
            else
                puts "# on_button_clicked : " + w.label

    end
    end

def on_main_destroy
        puts "# on_main_destroy"
        Gtk::main_quit
    end
end

if __FILE__ == $0

xml = <<EOI
<?xml version="1.0" encoding="UTF-8"?>
<interface>
  <object class="GtkWindow" id="main">
    <property name="can_focus">False</property>
    <child>
       <object class="GtkButton" id="quit">
        <property name="label">quit</property>
        <signal name="clicked" handler="on_button_clicked" swapped="no"/>
      </object>
    </child>
  </object>
</interface>
EOI

    Gtk.init
        builder = Builder.new(xml)
    Gtk.main

end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-26T22:04:05.847

真的是一样的。这是一个林间空地的例子：[http](http://snippets.dzone.com/posts/show/5251) ://snippets.dzone.com/posts/show/5251用正确的方法替换，你就设置好了。

有一个用 Ruby 编写的 IDE：http: [//github.com/danlucraft/redcar/tree/master](http://github.com/danlucraft/redcar/tree/master)但我无法找到它的主文件以查看它是否使用构建器。

# python - Python sys.path 修改不起作用

> ID：1017909
> 
> 赞同：10
> 
> 时间：2009-06-19T13:14:52.460
> 
> 标签：python, path

我正在尝试修改我的一个 Python 文件中的 sys.path，以便在模块搜索路径中包含一些特定的库目录（这可能不是最好的方法，但是......）。如果我在 sys.path 前面插入多个路径，我的脚本不会考虑这些路径以供将来导入。如果我制作了一个包含我需要的那些库目录的全新列表并将该列表分配给 sys.path ，那么这些导入将被考虑在内。这是正确的行为吗？我正在使用 python 2.5.4。我的环境中可能会导致这种行为吗？

一些代码片段：如果我这样做

 `````
pathtoInsert1 = " .... "
pathtoInsert2 = " .... "
sys.path.insert(0, pathToInsert1)
sys.path.insert(0, pathToInsert2)

```` 

`这没用。它不考虑路径。`

 `如果我做

 `````
pathList = [pathToInsert1, pathToInsert2] 
sys.path = pathList

```` 

`有用。`

 `谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-19T13:26:14.573

You really need to post some code for us to be able to help you. However, I can make an educated guess. You say that if you make a whole new list and assign it to sys.path then it works. I assume you mean that you're doing something like this

```
sys.path = ["dir1", "dir2", ...] 
```

But that if you insert the paths at the beginning then it doesn't work. My guess is that you're using the insert method, like so

```
sys.path.insert(0, ["dir1", "dir2"]) 
```

If so then this is incorrect. This would create a list that looks like

```
[["dir1", "dir2"], "dir3", ...] 
```

You should instead say

```
sys.path[:0] = ["dir1", "dir2"] 
```

which will give you

```
["dir1", "dir2", "dir3", ...] 
```

But this is all guesswork until you post your code.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T17:46:02.240

我在 iPython 中使用分布在多个目录中的模块时遇到了类似的问题。在这种情况下，要使导入工作，必须确保`module.__path__`分布式模块`__init__.py`包括模块之一所在的所有目录，`__init__.py`并确保正确的目录在 sys.path 列表中。

例如，我有一个名为 foo 的模块，其中包含一个名为 bar 的模块，该模块分布在多个目录中：

```
aerith/foo/bar/__init__.py
aerith/foo/bar/baz/__init__.py
bob/foo/bar/__init__.py
bob/foo/bar/baf/__init__.py
carol/foo/bar/__init__.py
carol/foo/bar/quux/__init__.py 
```

在 iPython 中，我已经导入了 baz 和 baf，并且想导入 quux。

`from foo.bar import quux`

这给出了 ImportError，因为`carol`不在`sys.path`，但`sys.path.append('carol')`没有修复 ImportError。

所需要的是通知`bar`模块其中一个`__init__.py`可以在“carol/foo/bar”中找到。

```
foo.bar.__path__.append('carol/foo/bar')
from foo.bar import quux 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-26T09:15:12.170

从[此处获取的更新 sys.path 的示例](http://www.johnny-lin.com/cdat_tips/tips_pylang/path.html)

```
import sys
sys.path.append("/home/me/mypy") 
```

这对我有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T13:23:05.347

How are you "inserting" the additional paths?

Modifying the path is done the same way any other list in Python is modified - although it sounds like you're simply clobbering it by re-assigning it.

Example of updating sys.path: [http://www.johnny-lin.com/cdat_tips/tips_pylang/path.html](http://www.johnny-lin.com/cdat_tips/tips_pylang/path.html)````

# asp.net - 将单元测试缓慢集成到项目中的步骤

> ID：1017917
> 
> 赞同：6
> 
> 时间：2009-06-19T13:17:32.533
> 
> 标签：asp.net, vb.net, unit-testing, stored-procedures, n-tier-architecture

我目前正在与另一名合作学生一起完成一个即将完成的项目的合作项目。由于该项目已从合作社传递到合作社，因此沿途采取了不良做法，并将测试留到最后。我决定写单元测试来在测试时学习新东西。

但是，我正在开发一个 3 层、紧密耦合的应用程序，它似乎无法以当前形式进行单元测试。我不想通过一夜之间重构无法识别的代码来甩掉其他对这些概念一无所知的合作学生。那么我应该采取哪些步骤来慢慢地将代码拉向单元可测试性呢？我应该先实现一个工厂模式，然后让其他学生熟悉它，然后再继续前进吗？

如果我的知识有缺陷并且不应该有任何问题，我深表歉意。我是新手:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T13:26:53.263

Michael Feathers[有效地使用遗留代码](http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052/ref=sr_1_1?ie=UTF8&s=books&qid=1221917700&sr=8-1)

很难知道实现工厂模式是否有任何好处，这取决于代码在做什么:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T13:44:06.300

[Michael Feathers 的《有效使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)（如果您订阅了 Safari，也可以使用）是完成任务的绝佳资源。作者将遗留代码定义为没有单元测试的代码，并且他给出了*许多*保守技术的实际演练——这是必要的，因为你在没有安全网的情况下工作——以便对代码进行测试。目录：

*   第一部分：I 变化的机制
    *   第 1 章更改软件
        *   改变软件的四个理由
        *   风险变化
    *   第 2 章处理反馈
        *   什么是单元测试？
        *   更高级别的测试
        *   测试覆盖物
        *   遗留代码更改算法
    *   第 3 章传感与分离
        *   伪造合作者
    *   第 4 章接缝模型
        *   一大段文字
        *   接缝
        *   接缝类型
    *   第 5 章工具
        *   自动重构工具
        *   模拟对象
        *   单元测试工具
        *   通用测试工具
*   Part: II 更改软件
    *   第 6 章 我没有多少时间，我必须改变它
        *   发芽法
        *   新芽类
        *   包裹方法
        *   包装类
        *   概括
    *   第 7 章 做出改变需要永远
        *   理解
        *   时差
        *   打破依赖关系
        *   概括
    *   第 8 章如何添加功能？
        *   测试驱动开发 (TDD)
        *   差异编程
        *   概括
    *   第 9 章我不能把这个类放到测试工具中
        *   刺激性参数案例
        *   隐藏依赖的案例
        *   构建 Blob 的案例
        *   恼人的全球依赖案例
        *   可怕的包含依赖关系的案例
        *   洋葱参数的案例
        *   别名参数的情况
    *   第 10 章我无法在测试工具中运行此方法
        *   隐藏方法的案例
        *   “有用”语言特征的案例
        *   无法检测到的副作用案例
    *   第 11 章。我需要做出改变。我应该测试什么方法？
        *   关于效果的推理
        *   向前推理
        *   效果传播
        *   效果推理工具
        *   从效果分析中学习
        *   简化效果草图
    *   第 12 章我需要在一个领域进行许多更改。我必须打破所有涉及的类的依赖关系吗？
        *   拦截点
        *   用夹点判断设计
        *   夹点陷阱
    *   第 13 章 我需要做出改变，但我不知道要编写什么测试来编写表征测试
        *   表征类
        *   有针对性的测试
        *   编写表征测试的启发式
    *   第 14 章对库的依赖正在扼杀我
    *   第 15 章 我的应用程序都是 API 调用
    *   第 16 章 我对代码的理解还不够好，无法更改它
        *   笔记/素描
        *   列表标记
        *   从头重构
        *   删除未使用的代码
    *   第 17 章 我的应用程序没有结构
        *   讲述系统的故事
        *   裸CRC
        *   对话审查
    *   第 18 章 我的测试代码有问题
        *   类命名约定
        *   测试地点
    *   第 19 章我的项目不是面向对象的。如何进行安全更改？
        *   一个简单的案例
        *   硬壳
        *   添加新行为
        *   利用面向对象
        *   都是面向对象的
    *   第 20 章 这堂课太大了，我不想让它变得更大
        *   看到责任
        *   其他技术
        *   向前进
        *   提取类后
    *   第 21 章我在各处更改相同的代码
        *   第一步
    *   第 22 章 我需要更改一个怪物方法，但我不能为它编写测试
        *   各种怪物
        *   使用自动重构支持来对付怪物
        *   手动重构挑战
        *   战略
    *   第 23 章 我怎么知道我没有破坏任何东西？
        *   超感知编辑
        *   单目标编辑
        *   保留签名
        *   依赖编译器
    *   第 24 章我们感到不知所措。它不会变得更好
*   Part: III 依赖打破技术
    *   第 25 章 依赖破坏技术
        *   适应参数
        *   突破方法对象
        *   定义完成
        *   封装全局引用
        *   暴露静态方法
        *   提取和覆盖调用
        *   提取和覆盖工厂方法
        *   提取和覆盖 Getter
        *   提取实施者
        *   提取接口
        *   引入实例委托者
        *   介绍静态二传手
        *   链接替换
        *   参数化构造函数
        *   参数化方法
        *   原始化参数
        *   上拉功能
        *   下推依赖
        *   用函数指针替换函数
        *   用 Getter 替换全局引用
        *   子类和覆盖方法
        *   取代实例变量
        *   模板重定义
        *   文本重新定义
*   附录：重构
    *   提取方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T13:23:42.880

在项目的中途开始新的开发实践是非常困难的。过去，当我从事从一开始就没有进行单元测试的项目时，一个好的方法是制定“新代码必须有单元测试”的规则，但不要对单元测试施加压力为旧代码编写。

当然，当项目的结构不适合可测试性时，即使这样也很困难。

我最好的建议是采取小步骤。

首先创建没有测试的单元测试程序集（或项目或其他）。然后找到一个定义和分离得相当好的代码的小区域，并为该区域编写一些单元测试。让你的 co-coder 也来看看，并开始获得一些“最佳实践”，比如每次签入任何代码时运行单元测试（如果可能，自动运行）。

一旦你有这个工作，你可以慢慢开始添加更多。

关键是慢慢来。就像我说的，从一开始就让旧代码免于测试更容易。一旦您的团队掌握了单元测试的想法并且在编写它们方面变得更好，您总是可以稍后再返回它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T13:39:01.257

围绕代码中的主要功能编写一系列黑盒测试怎么样？由于您提到它是一个 ASP.NET 项目，因此您可以使用[WaitN](http://watin.sourceforge.net/)或[Selenium](http://seleniumhq.org/)等框架来自动化 Web 浏览器。这为您提供了一组基线功能，无论代码更改多少，该功能都应保持不变。

一旦你有足够数量的测试来测试你项目的高级功能，我就会开始深入研究代码，正如 Simon P. Stevens 提到的，*慢慢地*工作。[获取Refactor](http://www.devexpress.com/Products/Visual_Studio_Add-in/VBRefactor/)的（免费！）副本！[对于 Visual Basic](http://www.devexpress.com/Products/Visual_Studio_Add-in/VBRefactor/)，因此您将能够自动执行一些基本的重构，例如提取方法。只需将较大的代码块拆分为更小、更可测试的块，您就可以在不更改任何功能的情况下大幅提高可测试性。

# jquery - 防止在 jquery 中多次单击单个操作！

> ID：1017918
> 
> 赞同：0
> 
> 时间：2009-06-19T13:17:33.017
> 
> 标签：jquery

我有这个 javascript 代码：

```
var next = jQuery('#next') ;
        var prev = jQuery('#prev') ;
        var Scroller = jQuery('#Scroller') ;
        var ScrollerTable = Scroller.children('table').width() ; 
        next.click(function(){
        console.log('width of scroller table ' + ScrollerTable) ;
                var offsetLeft = parseInt(Scroller.css("left")) ;
                console.warn(offsetLeft) ;
                if(offsetLeft == 0)
                {
                    Scroller.animate({left : -140 } , 1000 ) ;
                }else{
                    console.warn(offsetLeft) ;
                    if(ScrollerTable <= offsetLeft  )
                    {
                        console.warn(offsetLeft) ;
                        alert('you are reached the end of scroller use the other btn') ;
                        return false ;
                    }else{
                        Scroller.animate({left : offsetLeft-140 } , 1000) ;
                    }
                }

        });
        prev.click(function(){

                var offsetLeft = parseInt(Scroller.css("left")) ;
                console.warn('offsetLeft in backward ' + offsetLeft) ;
                if(offsetLeft != 0 || offsetLeft > 0 )
                {
                    Scroller.animate({left : offsetLeft +140 } , 1000 ) ;
                }else{
                    jQuery(this).css('cursor' , 'none') ;
                    return false ;
                }
        }); 
```

当用户单击 next 或 perv 时，多个动画不会完全完成并且 offsetLeft 值不正确！我能做些什么来防止这种情况发生

我的第二个问题是当用户点击下一个 btn 时，滚动 div 滚动到左侧 -140px 这个动作必须迭代直到到达幻灯片的末尾，然后我必须禁用下一个 btn。所以我在一个变量中获得了 scrollerTable 宽度并用 offsetLeft 值检查它，但它不起作用！

这是html

```
<table width="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>
        <div style="border:#ccc 1px solid ; padding:1px" class="scroll">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="2%"><img src="../images/dum/scroll_left.gif" width="20" height="165" id="prev" style="cursor:pointer" /></td>
                <td width="96%" valign="top">
                    <div style="width:720px; height:165px ;  position:relative ; overflow:hidden " id="Container">
                        <div style="position:absolute ; left:0" id="Scroller">
                            <table cellpadding="0" cellspacing="0" border="0">
                                <tr>
                                    {foreach from=$products item=p}
                                        <td>
                                            <div style="border:#ccc 2px solid ; padding:0px;margin:20px;">
                                                <img src="imgsize.php?w=100&h=100&img=../uploads/product/{$p.xproductid}.jpg" />
                                                <div style="background-color:#ccc ;text-align:center ; padding:5px; ">{$p.xproductname}</div>
                                            </div>
                                        </td>    
                                    {/foreach}
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
                <td width="2%"><img src="../images/dum/scroll_right.gif" width="20" height="165" id="next"/></td>
              </tr>
            </table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:44:02.933

If I understand you right, you could introduce a couple of variables that could help you out.

```
var nextInProgress=false;
var prevInProgress=false; 
```

Then, you could do something like this:

```
next.click(function(){
    if(!nextInProgress){
        nextInProgress=true;
        ...
        nextInProgress=false;
    }
});
prev.click(function(){
    if(!prevInProgress){
        prevInProgress=true;
        ...
        prevInProgress=false;
    }
}); 
```

Then, while your next.click() or prev.click() functions are in progress, a user clicking that button again will yield nothing unless the action has completed.

As for your second question: are you using the jQuery element.width() function? If that's not giving you an expected value, you may have to do some other width calculations, such as determining the tables CSS left and CSS right attribute values, and subtracting, right-left to get the width. That may work, but maybe I misunderstood your question.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:56:51.127

如果您想使用自己的代码，请考虑在动画调用中使用回调参数。

在按钮的单击事件上：

*   禁用左按钮（使用 .attr("disabled","disabled") 或其他方法）
*   触发你的动画
*   在 .animate() 的回调参数中重新启用按钮。回调函数在动画结束之前不会执行。（如果您有更复杂的动画，您可能需要使用动画队列。）

或者，您可以只使用 Ariel Flesler 的[serialScroll 插件](http://flesler.blogspot.com/2008/02/jqueryserialscroll.html)，因为他已经完成了艰苦的工作。

# jquery - jQuery 切换下两个元素

> ID：1017921
> 
> 赞同：2
> 
> 时间：2009-06-19T13:19:40.907
> 
> 标签：jquery, toggle, elements, next

I have a form select element that, when a certain value is selected, will toggle two other elements on the page (a dt / dd pair).

该事件被正确触发，但我无法切换元素 - 请注意我正在使用类选择器，因为页面上这些元素“集”的数量是可变的。这是我的代码：

```
$(".lender_id").change(function () {
if($(this).val()=='45')
   {
   $(this).next(".lender_other1").toggle();
   $(this).next(".lender_other2").toggle();
   }
}); 
```

lender_id 是我的select元素类，html代码如下（说明这个元素集可以在页面上出现多次）：

```
<dt>Lender</dt>
<dd><select name="lender_id[1]" class="lender_id">
<option value="1">Value</option>
<option value="45">Special Value</option>
</select></dd>

<dt class="lender_other1" style="display:none;">Lender Name</dt>
<dd class="lender_other2" style="display:none;">
<input type="text" name="lender_other[1]" value="" /></dd>

<dt>Lender</dt>
<dd><select name="lender_id[2]" class="lender_id">
<option value="1">Value</option>
<option value="45">Special Value</option>
</select></dd>

<dt class="lender_other1" style="display:none;">Lender Name</dt>
<dd class="lender_other2" style="display:none;">
<input type="text" name="lender_other[2]" value="" /></dd>

etc... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:29:33.960

[`next()`](http://docs.jquery.com/Traversing/next)不做你认为它做的事。试试`$(this).parent('dl').find('.lender_other1')`。或者，你知道，也许只是`$('.lender_other1')`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T14:53:01.093

这是你想要的：

```
$(".lender_id").change(function() {
    if ($(this).val() == '45') {
        $(this).parent().nextAll(".lender_other1:first, .lender_other2:first").toggle();
    };
}); 
```

编辑

我将类选择器组合在一起以提高效率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T13:56:06.573

.next() 只返回下一场比赛，所以我认为你应该使用 .nextAll()

[http://docs.jquery.com/Traversing/nextAll#expr](http://docs.jquery.com/Traversing/nextAll#expr)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T14:50:13.190

使用[slice(start, end)](http://docs.jquery.com/Traversing/slice)方法。根据 john resig 的视频，这是正确的方法。

# serial-port - 用于 Windows Embedded CE 的串行端口间谍

> ID：1017922
> 
> 赞同：0
> 
> 时间：2009-06-19T13:19:56.910
> 
> 标签：serial-port, windows-ce

是否有适用于 Windows CE 的串行端口“间谍”应用程序？间谍是指在 Windows CE 上运行的应用程序，可以监视进出串行设备的流量，而无需对其进行修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:44:25.927

[This](http://www.virtualserialport.com/products/vspdce/) is a product that will do your job, but you need to pay for it. It basically works by creating virtual ports. You can do that yourself if you want to. Start from this [article](http://www.codeproject.com/KB/mobile/DemoDriver.aspx) at Code Project. This will show you how you can create a serial port driver. You need to add code that will log ingoing/outcoming traffic while at the same time transferring data to/from a real port.

# seo - sitemap.axd 是否被所有搜索引擎接受？

> ID：1017925
> 
> 赞同：4
> 
> 时间：2009-06-19T13:20:29.967
> 
> 标签：seo, httphandler, sitemap, robots.txt

我目前正在使用 HttpHandler 动态生成站点地图文件，路径设置为 sitemap.axd。然后返回 xml 内容。我办公室里没有人确定是否所有搜索引擎都接受这个扩展名，或者他们是否需要 .xml 来解析。我知道我可以通过站长工具提交给谷歌，并使用robots.txt来表明sitemap是sitemap.axd。

sitemap.axd 是否被所有人接受？如果没有，有人知道哪些会或不会吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T18:05:40.283

主要搜索引擎同意的协议允许您在 robots.txt 文件中指定 XML 站点地图的位置。示例中倾向于将此命名为“sitemap.xml”，但只要该位置的内容是 XML，任何带或不带扩展名的名称都应该有效。

*某些搜索引擎可能*要求HTTP 响应中指定的 MIME 类型是 text 或 xml-ish 类型列表之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T22:57:41.803

使用 BlogEngine.net sitemap.axd 创建 url 重写对我有用。因此，当其他机器人访问 sitemap.xml 时，它会使用 sitemap.axd 呈现

```
 <rewrite>
                <rules>
                    <rule name="SiteMap" patternSyntax="Wildcard" stopProcessing="true">
                        <match url="sitemap.xml" />
                        <action type="Rewrite" url="sitemap.axd" appendQueryString="false" />
                    </rule>
</rules>
</rewrite> 
```

# sql - MYSql JOIN 线辅助

> ID：1017928
> 
> 赞同：0
> 
> 时间：2009-06-19T13:21:40.027
> 
> 标签：sql

你好，我正在经营一家企业，我有一个无法运行的 mysql 线路问题，我有一个单行 sql 条目，我试图加入来自“tblCustomerCreditCards”的条目，并使它们出现在我试图从“tblCustomerAddresses”中提取的一行上"

我的 tblCustomerAddresses 行是

```
select CustomerID,
       FullName,
       AddressLine1,
       City,
       ZipCode,
       PhoneNumber 
from tblCustomerAddresses 
```

我的 tblCustomerCreditCards 是

```
select CustomerID,
       CardholderName,
       CardNumber,
       ExpirationMonth,
       ExpirationYear 
from tblCustomerCreditCards 
```

我的问题是我将如何获得它，以便我的信用卡行位于地址的末尾，我可以将所有这些都放在一条线上...

如果可能的话，它可以用我拥有的格式而不是通过分解它来编写，非常感谢您的帮助......非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:27:26.710

Sounds like what you need is a simple join:

```
SELECT ca.CustomerID,FullName,AddressLine1,City,ZipCode,PhoneNumber,
       CardholderName,CardNumber,ExpirationMonth,ExpirationYear
FROM tblCustomerAddresses ca 
INNER JOIN tblCustomerCreditCards cc ON cc.CustomerID = ca.CustomerID 
```

As a side note, I hope those credit card numbers are encrypted. Storing unencrypted credit card numbers is a really really big no-no.

# javascript - xslt 中的 javascript 参考

> ID：1017929
> 
> 赞同：-1
> 
> 时间：2009-06-19T13:21:51.230
> 
> 标签：javascript, xslt

我有一个 javascript 文件。

我如何从 XSLT 中引用该文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T13:36:23.057

```
<script type="text/javascript" src="yourfile.js"></script> 
```

但是，如果您发现它是自动关闭的，则需要像这样添加一个空格

```
<script type="text/javascript" src="yourfile.js">&#160;</script> 
```

# mysql - MySQL 和国际日期

> ID：1017933
> 
> 赞同：0
> 
> 时间：2009-06-19T13:22:13.473
> 
> 标签：mysql, utc, unix-timestamp

假设我在多个位置有多个服务器，并且我想将 MySQL 的 datetime 类型用于字段日期，并且我总是希望字段日期具有 UTC 时间戳，因此`UTC_TIMESTAMP()`当我将其添加到数据库时我会执行 a 。现在说我想让 MySQL 为它输出 UNIX TIMESTAMP。

当我在服务器 AI 上执行此操作时，得到字符串“2009-06-17 12:00:00”，在它上面执行 UNIX_TIMESTAMP(STRING) 会给我返回数字 1245240000。UTC 时间为 2009-06-17 12:00:00。现在我在服务器 B 上做同样的事情。我得到了相同的字符串，因为它是 UTC 字符串，但是当再次执行 UNIX_TIMESTAMP(STRING) 时，我得到了错误的数字 1245232800，这是 UTC +2 时间。我该如何解决这个问题？我应该在 PHP 端进行从字符串到时间戳的转换吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:31:27.700

G'day,

I'll ask the obvious here, did you check the date and time on both machines?

**Edit:** ... and the MySQL timezone was the same on both machines?

**Update:** Ok. The problem is in the fact that the timestamp string being passed into UNIX_TIMESTAMP is interpreted to be a value in the current timezone which is then converted back to UTC so, because you're in MEZ, two hours is subtracted to return it back to UTC so 7200 is subtracted from your timestamp when it is converted back to a Unix timestring.

Hence, the variation you see when using UNIX_TIMESTAMP() to convert is back to a Unix Epoch timestring.

BTW Shouldn't you be using a TIMESTAMP type for storing off your UTC_TIMESTAMPs instead of DATETIME type?

**Update:** Decoupling presentation time from stored time is definitely the way to go. You can then reuse the same data all around the world and only have to convert to and from local time when you are presenting the data to a user.

If you don't do this then you are going to have to store off the timezone when the timestamp was made and then go into all sorts of complicated permutations of having to work out if

*   the local timezone was in daylight saving time when it was stored,
*   what the difference is between the timezone at the time that the data was stored and the timezone where the data is to be presented.

Leaving it all storeed as UTC gets rid of that.

Most users won't be that happy if they have to work out the local time themselves based on the UTC time returned so systems usually convert to current local time for the user.

This is of course if the user wants the data expressed in local time which is usually the case. The only widely used system I can think of, off the top of my head, that stores and presents its data in UTC is system for air traffic control and flight plan management which are always kept in UTC (or ZULU time to be more precise).

HTH

cheers,

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T14:29:34.447

你试过这样做吗？

一起执行此指令。

```
SET time_zone = 'UTC';
SELECT FROM_UNIXTIME(0), UNIX_TIMESTAMP('2009-06-17 12:00:00'); 
// 1970-01-01 00:00:00        1245240000 
```

它们只影响客户端会话，而不影响服务器配置。

# ruby-on-rails - 如何使用 Ruby ActiveRecord 建模这种多继承关系？

> ID：1017934
> 
> 赞同：2
> 
> 时间：2009-06-19T13:22:49.107
> 
> 标签：ruby-on-rails, ruby, inheritance, activerecord, multiple-inheritance

假设我有 5 张桌子。ActiveRecord 可以处理这个吗？你会如何设置它？

层次结构：

```
Account (Abstract)
  CorporateCustomer (Abstract)
    PrivateCustomer
    PublicCustomer
  GovernmentCustomer 
```

**编辑：**在休眠和城堡活动记录中，启用此场景所需的方法称为“加入子类”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T12:25:34.290

您可以尝试以下方式。

```
class Account < ActiveRecord::Base
  belongs_to :corp_or_gov_customer, :polymorphic => true

  def account_id
    self.id
  end
end

class GovernmentCustomer < ActiveRecord::Base
  has_one :account, :as => :corp_or_gov_customer, :dependent => :destroy

  def method_missing( symbol, *args )
    self.account.send( symbol, *args )
  end
end

class CorporateCustomer < ActiveRecord::Base
  has_one :account, :as => :corp_or_gov_customer, :dependent => :destroy
  belongs_to :priv_or_pub_customer, :polymorphic => true

  def method_missing( symbol, *args )
    self.account.send( symbol, *args )
  end
end

class PrivateCustomer < ActiveRecord::Base
  has_one :corporate_customer, :as => :priv_or_pub_customer, :dependent => :destroy

  def method_missing( symbol, *args )
    self.corporate_customer.send( symbol, *args )
  end
end

class PublicCustomer < ActiveRecord::Base
  has_one :corporate_customer, :as => :priv_or_pub_customer, :dependent => :destroy

  def method_missing( symbol, *args )
    self.corporate_customer.send( symbol, *args )
  end
end 
```

我没有测试过这段代码（甚至没有检查过它的语法）。相反，它旨在为您指明多态关系的方向。

覆盖 method_missing 以调用嵌套对象可以节省编写代码，例如

```
my_public_customer.corporate_customer.account.some_attribute 
```

相反，你可以写

```
my_public_customer.some_attribute 
```

* * *

回应评论：

问题是“是一个”、“有很多”和“属于”等概念都是由关系模型中的外键关系实现的。继承的概念与 RDB 系统完全不同。这些关系的语义必须通过您选择的 ORM 技术映射到关系模型上。

但是 Rails 的 ActiveRecord 库没有实现“is_a”作为模型之间的关系。

有几种方法可以在 RDB 中对类层次结构建模。

**所有帐户的单个表，但具有冗余属性**- ActiveRecord 只需在表中添加“类型”列即可支持这一点。然后像这样创建你的类层次结构：

```
class Account < ActiveRecord::Base
class GovernmentCustomer < Account
class CorporateCustomer < Account
class PublicCustomer < CorporateCustomer
class PrivateCustomer < CorporateCustomer 
```

然后，如果您调用 PrivateCustomer.new，类型字段将自动设置为“PrivateCustomer”，并且当您调用 Account.find 时，返回的对象将属于正确的类。

这是我推荐的方法，因为它是迄今为止做你想做的最简单的方法。

**每个具体类一个表**- 据我所知，ActiveRecord 中没有为此提供映射。这种方法的主要问题是，要获得所有帐户的列表，您必须连接三个表。需要的是某种主索引，它会导致下一个模型。

**每个类一个表**- 您可以将表示抽象类的表视为一种统一索引，或存储在具体类表中的对象目录。通过以这种方式考虑它，您正在将 is_a 关系更改为 has_a 关系，例如对象 has_a index_entry 和 index_entry belongs_to 对象。这可以由 ActiveRecord 使用多态关系映射。

[在《Agile Web Development with Rails》](http://www.pragprog.com/titles/rails3/agile-web-development-with-rails-third-edition)一书中对这个问题有很好的讨论 （从第 2 版的第 341 页开始）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T16:04:04.503

这是一种方法（最简单的）：

```
class Account < ActiveRecord::Base
   self.abstract_class = true
   has_many :corporate_customers
   has_many :government_customers
end

class CorporateCustomer < ActiveRecord::Base
   self.abstract_class = true
   belongs_to :account
   has_many :private_customers
   has_many :public_customers
end

class PrivateCustomer < ActiveRecord::Base
   belongs_to :corporate_customer
end

class PublicCustomer < ActiveRecord::Base
   belongs_to :corporate_customer
end

class GovernmentCustomer < ActiveRecord::Base
   belongs_to :account
end 
```

注意：抽象模型是不能有对象（不能被实例化）的模型，因此它们也没有关联的表。如果你想有表，那么我不明白为什么它需要一个抽象类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T14:00:00.293

搜索 ActiveRecord[单表继承](http://whynotwiki.com/ActiveRecord_/_Single_table_inheritance)功能。不幸的是，我无法在网上找到更详细的参考链接。我读到的最详细的解释来自“The Rails Way”一书。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T17:26:05.750

假设大部分数据是共享的，您只需要一张表：accounts。假设帐户具有字符串类型列，这将起作用。

```
class Account < ActiveRecord::Base
  self.abstract_class = true
end

class CorporateCustomer < Account
  self.abstract_class = true
  has_many financial_statements
end

class PrivateCustomer < CorporateCustomer
end

class PublicCustomer < CorporateCustomer
end

class GovernmentCustomer < Account
end 
```

Google for Rails STI，尤其是 Rails STI 摘要，以获得更多有用的信息。

# oracle - 如何从 PL/SQL 中确定 ORACLE_HOME？

> ID：1017936
> 
> 赞同：2
> 
> 时间：2009-06-19T13:22:54.440
> 
> 标签：oracle, plsql, path, oracle-home

是否可以使用纯 PL/SQL 确定 Oracle 的安装位置？

用例：为了调用外部 C 库，我需要知道它的确切路径（用于`create library`调用）。我的 DLL 将驻留在 Oracle 的 BIN 目录中，但我无法在我的脚本中硬编码 DB 安装的路径...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:48:24.157

```
DECLARE
 RetVal VARCHAR2(100);
BEGIN
  dbms_system.get_env('ORACLE_HOME', RetVal);
  dbms_output.put_line(RetVal);
END; 
```

注意：默认情况下，您可能无权访问此软件包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T13:45:39.293

在 Windows 和 Oracle 10g 上，这有效：

```
SELECT  
substr(file_spec,1,instr(file_spec,'\',1,3)) 
FROM dba_libraries 
WHERE library_name='DBMS_SUMADV_LIB' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-13T04:29:02.043

从 Oracle 12c 开始，您可以使用该`SYS_CONTEXT`功能：[*Oracle docs*](https://docs.oracle.com/database/121/SQLRF/functions199.htm#SQLRF06117)

```
SET SERVEROUTPUT ON
BEGIN
   DBMS_OUTPUT.PUT_LINE(SYS_CONTEXT('USERENV','ORACLE_HOME'));
END;
/

/u01/app/oracle/product/12.1.0.2/dbhome_1 
```

# ruby-on-rails - Aptana Studio 和 XULRunner 8.1 的问题

> ID：1017945
> 
> 赞同：0
> 
> 时间：2009-06-19T13:25:47.993
> 
> 标签：ruby-on-rails, ide, ubuntu, aptana, xulrunner

我最近安装了 Ubuntu Jaunty，当我尝试在它下运行 Aptana Studio 时遇到了问题。与内部浏览器的任何交互都会使系统崩溃。我检查了日志，经过一番谷歌搜索后得出的结论是，由于与安装在我的系统上的 XULRunner 9.0 不兼容，它正在崩溃。我按照我遇到的几个解决方案安装了 XULRunner 8.1（到不同的目录），并按照建议将 MOZILLA_FIVE_HOME 环境变量指向该特定版本。

```
export MOZILLA_FIVE_HOME=/usr/lib/xulrunner-8.1 
```

然而，问题依然存在！当我`cd`进入 xulrunner-8.1 目录并执行 a`./xulrunner -v`时，它仍然将其列为版本 9！我无法卸载 9.x，因为其他几个主要软件包都依赖它，其中之一是我安装的 Gnome 版本。

这是我自玩 RedHat 7.2 waybackwhen 以来第一次使用 Linux，所以我可能忘记做一些明显的事情。谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-04T11:03:20.417

我也在 Ubuntu Jaunty 上运行 Aptana，遇到了和你类似的问题。这个[线程](http://forums.aptana.com/viewtopic.php?f=37&t=8008)解决了我的问题，我总是从启动脚本启动我的 Aptana。特别是“stevewalker”的帖子。只是在这里发布他的启动脚本：-

```
#!/bin/sh
MOZILLA_FIVE_HOME=/usr/lib/xulrunner
if [ $LD_LIBRARY_PATH ]; then
   LD_LIBRARY_PATH=$MOZILLA_FIVE_HOME:$LD_LIBRARY_PATH
else
   LD_LIBRARY_PATH=$MOZILLA_FIVE_HOME
fi
export MOZILLA_FIVE_HOME LD_LIBRARY_PATH
/usr/local/aptana/AptanaStudio $@ 
```

希望这可以帮助！=)

# svn - 签入时SVN自动代码格式化？

> ID：1017953
> 
> 赞同：11
> 
> 时间：2009-06-19T13:26:58.240
> 
> 标签：svn

这可能吗？如果是这样，我该怎么做？

代码在 C# 中，我们使用的是 TortoiseSVN。

我只是想在每次检查时自动格式化代码。

非常感谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-19T13:44:20.730

使用预提交挂钩脚本，您可以做到这一点，是的。但我确信您会在第一次提交后删除该脚本，因为您会遇到大问题。

如果您修改提交的数据，客户端不知道这一点。因此，在您的脚本“修复”文件格式的此类提交之后，存储库中的文件内容与工作副本中的文件不同。但是您的工作副本仍然认为它与存储库是最新的（毕竟，它的修改刚刚提交）。

所以在下一次更新中，你会陷入地狱——损坏的工作副本，愤怒的用户，......

当然，您可能会破坏构建 - 自动格式化有时会产生这种效果。

您当然可以实现一个钩子脚本来**检查**格式是否正确，如果不正确则返回错误，这很好。

由于您使用的是 TortoiseSVN，您可以尝试在[客户端 pre-commit hook](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html#tsvn-dug-settings-hooks)中进行格式化。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-19T13:34:47.677

你正在接触圣战之地。与人们的格式混淆是要求干草叉和火炬。

我的建议：**不要**。

更不用说，如果您在谈论 C#，并且您的开发人员正在使用 Visual Studio，那么 VS 有很多自动格式化工具。只需输入右花括号，VS 就可以/将自动格式化您的代码。

更好的解决方案可能是让所有开发人员使用相同的自动格式化设置。

> 工具 -> 选项，文本编辑器 -> C# -> 格式化

这些设置是可导出的，所以如果你能让团队同意在 VS 中使用相同的代码格式化设置，你就可以避免在源代码控制系统中执行它的麻烦，最好留给它做最好的事情。

如果您下定决心要这样做，那么就像其他人所说的那样，预提交钩子是要走的路。如果你的 SVN 服务器在 Windows 上运行，我可以推荐[CaptainHook](http://sourceforge.net/projects/captainhook/)来编写你的钩子脚本吗？您可以使用任何 .NET 语言编写的可插入钩子脚本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-19T14:46:40.700

像这里的大多数人一样，我同意添加一个重写他们的代码的 pre-commit-hook 是不好的，但是你可以有一个 pre-commit 钩子来拒绝未格式化为你的编码实践的代码并通知用户此类错误。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-19T13:32:38.493

我认为您可以使用存储库中[的预提交挂钩](http://wordaligned.org/articles/a-subversion-pre-commit-hook)来执行此操作。

**编辑**对于那些认为这是一个坏主意的人（我并不是说它不是）：组织强制执行特定的代码样式或代码格式并不罕见。有时这些规则可能非常迂腐和严格执行，尽管它们通常是涉及到其中的人为操作（即在您将任何内容提交到存储库之前格式化为正确的样式），但自动化过程有时会很有用。

另一种方法可能是在提交之前自动进行验证，但即使检查失败仍允许提交，但随后仅发送电子邮件或其他通知以表明有人没有遵循该样式。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-19T14:55:45.220

我强烈推荐它。

使用预提交脚本或更好的是，找到一种在您的 IDE 中自动执行此操作的方法（预提交会将更改的文件推送到客户端）。Eclipse 可以在保存时自动格式化。

这样做的理由是，如果开发人员的格式不同，您会发现文件上有提交，而提交只是格式更改，这将导致无穷无尽的混乱。

一个通用的格式化模式是一个非常好的主意。很难介绍，但值得。所有更改都将是真正的更改，而不仅仅是格式更改。根据我的经验，开发人员会看到好处并接受它。

我使用过 cvs 和 java 并使用 jalopy 来自动格式化。我们使用的是分支系统，所以它是强制性的，而且效果很好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-19T13:32:50.880

这是可能的，但也是一个非常非常糟糕的主意。

没有自动代码格式化程序是完美的，我几乎可以保证它会让人失望。

也就是说，如果您想这样做，请考虑使用预提交挂钩。

SVN 服务器是运行在 Windows 还是 Linux 系统上？你想使用什么代码格式化程序？

# sql-server - 如何用顺序的 GUID 替换所有非顺序的 GUID？

> ID：1017957
> 
> 赞同：1
> 
> 时间：2009-06-19T13:27:57.817
> 
> 标签：sql-server, sql-server-2005, guid, data-conversion

我有一个棕色字段 SQL Server 2005 数据库，它使用标准的、未排序的 GUID 作为主键值的大部分，并且也在聚集索引中（这对性能不利）。

我应该如何将这些更改为顺序 GUID？挑战之一是在我更改每个主键时替换所有外键值。

您知道执行此类转换的任何工具或脚本吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T13:31:32.567

请记住，您只能使用 newsequentialid() 函数作为默认值

所以创建一个有 2 列的新表。将原始表中的密钥插入此表中（将另一列留出它会自行填充）

加入原始表并使用 newssequantialid 更新 PK，如果您有级联更新，则 FK 应自行更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:32:51.923

你怎么知道它对性能不好？

GUID 的优点是您不必担心多个进程同时创建记录。它可以大大简化您的代码，具体取决于程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T16:32:45.600

当 Guid 是 PK 时，SequentialGuids 最适合性能。这就是它们存在的原因。

# c# - 限制 ASP.NET ListView 上的结果数

> ID：1017959
> 
> 赞同：0
> 
> 时间：2009-06-19T13:28:42.463
> 
> 标签：c#, asp.net, data-binding, listview, collections

我有一个绑定到通用列表集合的 ListView。

我需要能够限制绑定到 5 之类的项目的数量，并在模板中显示更多按钮。

我可以处理 DataBinding 事件，并删除 List<> 中的最后几项，但感觉有些不对劲。我也不能事先将列表限制为 5 个，因为我需要知道超过 5 个，才能显示“更多”按钮。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:34:35.337

将列表数据绑定到

```
yourlist.Take(5); 
```

（即 LINQ 运算符），但根据原始列表执行更多按钮的检查。

# c++ - 是否有任何工具可以改善 vc++（vs2008）中的智能感知？

> ID：1017965
> 
> 赞同：0
> 
> 时间：2009-06-19T13:29:54.940
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++, intellisense

是否有任何免费工具可以改进 Intellisense 并在 vc++ 2008 中提供代码片段？请不要发布商业工具

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T16:11:50.900

[视觉辅助](http://www.wholetomato.com/)

以我的经验，VS 中的智能感知非常好，当它工作时。无论是通过项目设置方式的一些怪癖，还是 VS 中的错误，我都不知道。但通常在较大的项目中，它会停止正常工作。我还没有在 Visual Assist 中遇到过这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:35:57.987

不，我不知道。

您能解释一下您希望在智能感知引擎中看到哪些改进吗？您看到的某些行为可能是一个错误，如果您能详细说明发生了什么，我们或许可以帮助您解决这个问题。

# multithreading - 为什么在 STA 线程下运行时未引发此 COM 互操作事件？

> ID：1017968
> 
> 赞同：1
> 
> 时间：2009-06-19T13:30:40.417
> 
> 标签：multithreading, events, sta

有人可以解释为什么在下面的代码中使用 STA 线程时没有引发事件“OnNewMail”吗？该程序尝试使用 Redemption 库来拦截传入的 Outlook 邮件。

```
class Program
{        
    [STAThread()] // When this line is deleted the application works
    static void Main(string[] args)
    {
        RDOSession session = GetSession();
        session.OnNewMail += Session_OnNewMail;
        Console.ReadLine();
    }

    static void Session_OnNewMail(string EntryID)
    {
         Console.WriteLine("New mail received");
    }

    private static RDOSession GetSession()
    {
        var session = new RDOSession();
        var application = new ApplicationClass();

        session.MAPIOBJECT = application.Session.MAPIOBJECT;
        return session;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:55:28.523

在 STAThread 上运行的 COM 使用消息泵来引发事件和调用方法。当在控制台应用程序中没有为您泵送消息的窗口时，您需要自己运行泵送。（有几种 .NET 同步方法会为您执行此操作 - 看看 WaitOne 等...）

如果对象在默认 MTA 线程中是满意的 - 如果您需要从控制台应用程序执行此操作，则最好使用它。

而不是 ReadLine - 您可以使用以下方法轮询密钥并抽取消息：

```
while (Console.Read() == 0)
{
    Thread.CurrentThread.Join(100);
} 
```

...但这是一个黑客。

混合 COM、控制台应用程序和 [STAThread] 有点可疑，可能会导致其他问题：http: [//support.microsoft.com/default.aspx/kb/828988](http://support.microsoft.com/default.aspx/kb/828988)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:37:38.623

当线程是 STA 线程并且您等待输入时，库不能同时执行任何操作，并且在电子邮件到达时没有机会触发事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T13:40:46.853

这个问题几乎肯定与消息泵送有关。

除非我们知道 RDOSession 是什么类型的 COM 对象（STA、MTA 等），否则我们只能推测实际发生的情况。

我的猜测是 RDOSession 是一个 MTA COM 对象，并且事件代码以某种方式将事件绑定到 STA 代理或对象。这意味着 OnNewMail 事件引发的一部分必须将引发编组到 STA 线程上。这涉及窗口消息传递。您正在执行一个简单的 ReadLine 调用，这是一个阻塞调用，不会处理消息。因此，您将永远无法获得该事件。

# linq - 为什么人们使用 linq to sql？

> ID：1017970
> 
> 赞同：21
> 
> 时间：2009-06-19T13:30:52.473
> 
> 标签：linq, linq-to-sql

给定前提：

*   有称职的 sql 程序员（相关 - 编写 sql 查询不是问题）
*   有称职的应用程序开发人员（相关 - 有简单/强大/灵活的架构来处理连接和来自代码的简单查询）

为什么人们使用 linq to sql？

*   每个事务都会增加开销
*   中等复杂的计算很可能会造成性能损失（数据库是为处理集和计算而设计的，并且有工程师团队进行优化 - 为什么要搞砸这个？）
*   失去了灵活性（如果要添加另一个 ui（非 .NET 应用程序）或访问方法，则必须将查询放回 db 或创建单独的数据访问层）
*   由于没有集中控制数据库上的写入/更新/读取（例如，记录已更改 - 如果您允许应用程序使用 linq to sql 更新，那么您无法证明哪个应用程序更改了它或什么应用程序的实例改变了它）

我不断看到有关 linq to sql 的问题，并且想知道我是否遗漏了什么。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-19T13:40:12.627

> 我不断看到有关 linq to sql 的问题，并且想知道我是否遗漏了什么。

这并不是说你错过了什么。这是您拥有大多数商店所没有的东西：

> 有称职的sql程序员

此外，在您的商店中，那些称职的 sql 程序员更喜欢编写 sql。

* * *

以下是逐点回复：

> 每个事务都会增加开销

一般是真的。这可以通过在需要运行`CompiledQuery`许多（但不是全部！）场景之前翻译查询来避免。

> 中等复杂的计算很可能会造成性能损失（数据库是为处理集和计算而设计的，并且有工程师团队进行优化 - 为什么要搞砸这个？）

您正在编写 linq，它被转换为 sql，然后从优化器生成计划 - 或者您正在编写 sql，优化器从中生成计划。在这两种情况下，您都在告诉机器您想要什么，并且它应该弄清楚如何去做。您是否建议通过使用查询提示来颠覆优化器是一种好习惯？许多称职的 sql 程序员会不同意这个建议。

> 失去了灵活性（如果要添加另一个 ui（非 .NET 应用程序）或访问方法，则必须将查询放回 db 或创建单独的数据访问层）

很多使用 linq 的人已经是 SOA 了。linq 存在于服务中。非 .NET 应用程序调用该服务。Bada-bing bada-boom。

> 由于没有集中控制数据库上的写入/更新/读取（例如，记录已更改 - 如果您允许应用程序使用 linq to sql 更新，那么您无法证明哪个应用程序更改了它或什么应用程序的实例改变了它）

这是不正确的。您证明哪个应用程序已连接并发出 sql 命令，就像您证明哪个应用程序已连接并调用 sproc 一样。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-06-19T13:46:32.130

让我为您列出几点：

1.  有一些小型软件公司或中型公司在内部开发他们的软件，他们可能更愿意专注于吸引许多应用程序开发人员，而不是聘请一名自由职业数据库开发人员，甚至永久雇用一名。
2.  在大多数情况下，由于要处理的数据量或流量较低，开销不是问题。此外，如果使用得当，LINQ to SQL 的执行速度可以与大多数 SQL 查询 + 相关的 .net 代码一样快。
3.  许多公司只是坚持使用 Microsoft 堆栈，他们只能享受集成。其他一些公司使用 SOA 开发没有问题。其他人不会被迫选择 LINQ-to-SQL，如果他们做出选择，那么他们的问题就是如何集成它。没有人说过 LINQ-to-SQL 是灵丹妙药 :)
4.  我相信使用 LINQ-to-SQL**可以获得**安全性，因为我遇到了许多 SQL 查询，它们通过字符串连接等接收未转义的数据，并解释整个参数化查询的想法从来都不是一件容易的事。此外，由于所有查询最终都会转换为 SQL，除非您描述的跟踪问题会通过存储过程发生，否则完全没有问题。

我也相信您的问题可以更广泛地提出来解决所有 ORM 而不仅仅是 LINQ-to-SQL，而且我所说的大部分内容仍然适用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-19T13:51:34.540

问题是在某个地方很少有一个称职的 SQL 开发人员喜欢编写 SQL 并且不愿意做其他事情。我认为自己擅长 SQL，我曾经使用存储过程或参数化查询来完成所有数据访问层。问题是它需要很长时间并且很乏味。我宁愿编写出色的应用程序，也不愿搞乱数据访问层，这些数据访问层本质上对每个数据对象都重复了几十次选择、插入、更新和删除 SQL 语句（或 proc）。

Linq-to-SQL 消除了一些重复性。它有一个工具可以从你的数据库模式中自动生成你的业务对象，它为你提供了一个很好的集成查询语言，它经过编译时类型验证并且在你的代码中（存储过程对于源代码控制来说是一种痛苦）

我在 Linq-to-sql 中编写 DAL 的速度比使用普通 SQL、存储过程或参数化查询快几倍。

如果您想保持使用存储过程，linq-to-sql 和 EF 都支持使用存储过程进行所有数据访问，您只需设置适当的映射。因此，如果需要，您仍然可以使用存储的过程来记录详细信息并实施安全性。我们倾向于选择使用 windows auth，并使用它来限制各种用户对每个表的访问，然后我们在表上有一堆触发器来跟踪详细信息以进行审计。

我将很快注意到两件事，首先，实体框架目前似乎得到了 MS 的更多支持，我怀疑这将被视为未来的默认标准，而不是 linq-to-sql。其次，在 .Net 3.5 中，EF 和 linq-to-sql 对 n 层断开连接的应用程序没有很好的支持。在这两种情况下，您都必须在断开连接的层上序列化数据上下文，或者手动分离和重新附加数据对象。不过，这在 .net 4.0 中得到了很大改进。只是需要考虑的事情取决于您可以使用的版本。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-19T14:20:42.530

现有的问题/答案相同/精神：

*   [Linq to SQL 没有错过重点吗？ORM-mappers（SubSonic 等）不是次优解决方案吗？](https://stackoverflow.com/questions/458802/doesnt-linq-to-sql-miss-the-point-arent-orm-mappers-subsonic-etc-sub-opti)
*   [LINQ-to-SQL 与存储过程？](https://stackoverflow.com/questions/14530/linq-to-sql-vs-stored-procedures)
*   [Linq to SQL 有什么问题？](https://stackoverflow.com/questions/165102/whats-wrong-with-linq-to-sql)
*   [为什么我有 LINQ to SQL 时需要存储过程](https://stackoverflow.com/questions/417898/why-do-i-need-stored-procedures-when-i-have-linq-to-sql)
*   [如果使用 LINQ to SQL 是否有充分的理由再学习 SQL 查询/语法？](https://stackoverflow.com/questions/806763/if-using-linq-to-sql-is-there-any-good-reason-to-learn-sql-queries-syntax-anymore)
*   [https://stackoverflow.com/questions/216569/are-the-days-of-the-stored-procedure-numbered](https://stackoverflow.com/questions/216569/are-the-days-of-the-stored-procedure-numbered)

我个人认为没有正确或错误的答案。这取决于您正在开发什么以及如何开发它。如果您需要出色的性能，拥有过于复杂的数据模型等...跳过抽象。如果您觉得抽象加快了您的开发时间，例如在单个代码库中捕获所有应用程序逻辑的想法等......使用它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-19T13:48:37.227

对我来说，编写 linq to sql 代码比编​​写一堆存储过程花费的时间要少得多。当设计尚未完成时尤其如此，在这种情况下，我还不知道我想在 C# 对象上做多少工作，以及我想在 SQL 中做多少工作。

所以，我可以跳过构建数据集，我不必单击单击单击添加查询，基本上，linq to sql 意味着我可以在更短的时间内更改我的代码。

此外，作为 Haskell 的忠实粉丝，我可以使用 linq to sql 编写大量函数式代码，并且它可以正常工作。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-19T14:19:25.653

我并不是说这是一个理想的解决方案，甚至是一个很好的例子（这是对架构的高级约束的结果，而不是我们必须从头开始选择的东西），但是......

我在一个应用程序上工作，其中代码与数据库完全隔离，除了通过一组暴露的存储过程。除了从存储过程中返回的代码外，代码无法“知道”任何关于数据库模式的信息。

虽然这并没有那么不寻常，而且使用 ADO 或其他任何东西编写 DAL 也不是太难，但我决定尝试 Linq to Sql，即使它不会将它用于其真正的预期目的，也不会使用大部分功能。事实证明这是一个伟大的决定。

我创建了 Linq to Sql 类，将存储的过程从服务器资源管理器拖到设计器的右侧，然后......等等，没有了。我差不多完成了。

Linq 为每个存储过程创建了强类型方法。对于返回数据行的过程，Linq 自动为每行中的项目创建一个类并`List<generatedClass>`为它们返回一个类。我将调用本身封装在一个轻量级的公共 DAL 类中，该类进行了一些验证和一些自动参数设置，然后我就完成了。我编写了一个业务对象类并将动态生成的 Linq 类对象映射到业务对象（这是手工完成的，但并不难做或维护）。

该程序现在不受任何不影响存储过程签名的架构更改的影响。如果签名确实发生了变化，我们只需从设计中拖出旧的 proc 并将其拖回以重新生成代码。一些通过单元测试以进行更改（通常不会高于公共 DAL 接口）并且完成了。DAL 上游的事物使用 Linq to Objects 技术直接从存储的 proc 调用中选择、过滤和排序格式不正确的数据。

我们有一些优秀的 DBA 编写存储过程，还有一个完全不同的团队编写其他代码，所以这可能是一个很好的例子，说明为什么（以及如何）在您描述的场景中使用 LINQ。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-19T13:50:57.490

与将 SQL 语句编写为字符串相比，一些方便的功能是调试器在查询中拾取语法错误。直到运行时才会发现的错误。

另外，我发现 LINQ 语句比 SQL 更容易阅读。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T14:00:58.623

这可能是一个方便战胜性能的例子。如果您在 Facebook 的超级性能级别进行编程，那么您可能会考虑每个时钟周期，但简单的事实是，大多数应用程序不需要这种关注并受益于代码维护和开发时间的效率（10 万承包商与. 另一个 $erver)。

也就是说，在非常大规模的系统中，有必要从 DB 盒中外包尽可能多的查询处理，否则 DB 是瓶颈，您需要分片或重新架构。昂贵。

我认为可以公平地说，LINQ 在服务器和许多核心方面都可以更好/更容易地扩展，因为一旦 MS 发布 C# 4.0，您的 LINQ 代码库将获得“免费”的 m-core。

我确实看到了您提出的问题，并且作为第一次开始一个 www 项目的非 ASP.NET 开发人员，我看不到 80% 的 ASP.NET（主题、控件等）的意义 - 似乎除了 HTML 本身，我还需要学习更多和编写代码！——再一次，我确信这一切都是有充分理由的。

--- 我没有 50 分来评论我想要的帖子，所以我在这里做 ---

David B 建议编写一些 SQL 是为了充分利用 SQL Server，而使用查询提示是指导机制。同样的任务可以在 SQL 中以多种不同的方式实现，并且性能提升了 1000 倍。我建议阅读 Inside T-SQL Querying (Itzik Ben Gan)。Itzik 一遍又一遍地展示了如何重新考虑查询并使用新命令将逻辑读取有时从数千缩小到不到十。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T17:36:36.890

对于非常简单的查询，额外层的开销会增加往返成本。对于普通“业务应用”场景中稍微复杂一些的查询，Linq-to-SQL 表达式->sql 转换魔法所做的优化通常可以节省很多。

例如，我最近将客户提供的 1400+ (!) 行存储过程 1:1 转换为 L2S。它不仅从 1400 行 SQL 变为 500 行更具可读性、强类型和注释的代码。它还开始以平均约 1500 次读取而不是约 3 万次读取来访问数据库。这是在我开始研究数据库端优化之前——我可以 100% 地归因于 L2S 消除可以在客户端评估的谓词的能力。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-07-02T19:43:32.607

简单的答案，有两种方法：创建精美的[Rube Goldberg 装置](http://dashboards.tv/images/rube-goldberg.jpg)，或者以简单的方式完成工作。许多开发者倾向于前者。

开发人员很容易感到无聊，并且通常个人喜欢以一种似乎提供某种智力美感的更难的方式做事。你是在开发应用程序还是在写博士学位？正如我的 msft 主管曾经在走廊里大喊大叫的那样，“我不想要另一个研究项目！”

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-07-02T19:27:21.797

请在我之后重复（最少 3 次）

*   没有银弹

*   我不会仅仅因为它是 msft 的最新技术而使用它

*   我不会为了在我的简历上使用一些东西

不仅他们称职的 SQL 编码员，任何体面的应用程序程序员，尤其是 LOB 应用程序，都应该编写中级 SQL。如果您不了解任何 SQL 并且正在编写 LINQ to SQL，您将如何调试数据调用？您将如何分析它们以解决瓶颈问题？

我们正在尝试 LINQ to SQL，我认为它存在重大问题，例如：

*   没有简单的方法可以将查询结果返回给另一个对象。这本身似乎很疯狂。Microsoft 创建了 var 匿名数据类型，并建议使用它，但无法将此数据移出本地方法，因此如果您必须在检索数据的同一函数中使用数据，则 oo 范例会中断。

*   表不是对象。研究第三范式等。关系数据库用于存储数据，而不是使用它。我不想被限制或鼓励将我的表格用作对象。我从数据库中检索的数据通常是多个表的连接，可能包括 SQL 强制转换、函数、运算符等。

*   没有性能提升，略有损失

*   现在我有更多的代码需要担心。有 dbml 文件，还有一个 DAL 来实际编写 LINQ。是的，很多是机器生成的，这并不意味着它不存在，它可能会出错（即您的 dbml 文件等）。

现在我已经给出了背景，我将尝试回答你实际的问题，为什么人们使用 LINQ To SQL：

*   它是 Microsoft 的最新产品，我希望它出现在我的简历中。
*   Msft 已经说服经理/高管相信它将减少编码时间
*   开发人员讨厌 SQL。（除了手动之外，没有好的开发环境或调试——如果对 sql 工具有更好的智能感知就好了。）

我鼓励人们不要仅仅因为其他人都跟风，学得足够多，可以把它放在你的简历上，如果被迫也愿意使用它，但首先要尝试真正了解利弊。

# asp.net - 在 IIS 日志中记录 ASP.Net 用户

> ID：1017979
> 
> 赞同：3
> 
> 时间：2009-06-19T13:33:15.810
> 
> 标签：asp.net, iis, authentication, logging

我有一个使用 ASP.NET 表单身份验证的 ASP.NET 3.5 应用程序（在 IIS 6.0 上）。在我的 IIS 日志中，我打开了扩展日志记录，包括 cs-username 字段。即使在用户登录到我的站点后，cs-username 仍然显示“-”。

有没有办法让经过身份验证的 ASP.NET 用户名出现在日志的用户名字段中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:42:08.350

不容易。

cs-username 默认是 HTTP 认证用户名，不是表单认证。您也许可以编写一个 ISAPI DLL 来拦截调用，解析 ASP.NET 身份验证令牌 cookie，如果必须解密它并从成员资格提供程序检索用户名，然后拦截 SF_NOTIFY_LOG 并响应 ON_LOG 事件以设置正确的名称，但它并非微不足道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-08T15:24:18.910

或者，使用 ASP.NET 成员资格提供程序编写一些自定义代码以将它们记录在数据库中！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-11T18:28:06.713

是的，asp.net 相当蹩脚......你会认为他们会更好地集成它与 IIS 日志:-P

您可以使用这个 isapi 过滤器，但我不确定它是否适用于 IIS7（Windows 2008）。在 Win2003 中应该可以正常工作：http: [//www.codeproject.com/KB/trace/isapilogger.aspx](http://www.codeproject.com/KB/trace/isapilogger.aspx)

# python - 我如何知道 Python 的 contract.py 合约失败了？

> ID：1017985
> 
> 赞同：1
> 
> 时间：2009-06-19T13:35:32.527
> 
> 标签：python, design-by-contract

我正在玩[contract.py](http://www.wayforward.net/pycontract/)，Terrence Way 的 Python 合同设计参考实现。当违反合同（前置条件/​​后置条件/不变量）时，实现会引发异常，但如果有多个与方法关联的合同，它不会为您提供快速识别哪个特定合同失败的方法。

例如，如果我以[circbuf.py](http://www.wayforward.net/pycontract/examples/circbuf.py)为例，并通过传入否定参数来违反前提条件，如下所示：

```
circbuf(-5) 
```

然后我得到一个看起来像这样的回溯：

```
Traceback (most recent call last):
  File "circbuf.py", line 115, in <module>
    circbuf(-5)
  File "<string>", line 3, in __assert_circbuf___init___chk
  File "build/bdist.macosx-10.5-i386/egg/contract.py", line 1204, in call_constructor_all
  File "build/bdist.macosx-10.5-i386/egg/contract.py", line 1293, in _method_call_all
  File "build/bdist.macosx-10.5-i386/egg/contract.py", line 1332, in _call_all
  File "build/bdist.macosx-10.5-i386/egg/contract.py", line 1371, in _check_preconditions
contract.PreconditionViolationError: ('__main__.circbuf.__init__', 4) 
```

我的预感是 PreconditionViolationError (4) 中的第二个参数是指 circbuf 中的行号。包含断言的**初始化文档字符串：**

```
def __init__(self, leng):
    """Construct an empty circular buffer.

    pre::
        leng > 0
    post[self]::
        self.is_empty() and len(self.buf) == leng
    """ 
```

但是，必须打开文件并计算文档字符串的行号是一件很痛苦的事情。有没有人有更快的解决方案来确定哪个合同失败了？

（请注意，在这个例子中，有一个前提条件，所以很明显，但多个前提条件是可能的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T05:01:22.487

在不修改他的代码的情况下，我认为您不能，但是由于这是python...

如果您寻找他向用户提出异常的位置，我认为可以将您正在寻找的信息推送到其中......我不希望您能够获得任何追溯不过更好，因为代码实际上包含在注释块中，然后进行处理。

代码非常复杂，但这可能是一个需要查看的块 - 也许如果你转储一些参数，你可以弄清楚发生了什么......

```
def _check_preconditions(a, func, va, ka):
    # ttw006: correctly weaken pre-conditions...
    # ab002: Avoid generating AttributeError exceptions...
    if hasattr(func, '__assert_pre'):
        try:
            func.__assert_pre(*va, **ka)
        except PreconditionViolationError, args:
            # if the pre-conditions fail, *all* super-preconditions
            # must fail too, otherwise
            for f in a:
                if f is not func and hasattr(f, '__assert_pre'):
                    f.__assert_pre(*va, **ka)
                    raise InvalidPreconditionError(args)
            # rr001: raise original PreconditionViolationError, not
            # inner AttributeError...
            # raise
            raise args
            # ...rr001
    # ...ab002
    # ...ttw006 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:39:08.837

这是一个老问题，但我不妨回答一下。我添加了一些输出，您将在评论 #jlr001 中看到它。将下面的行添加到您的 contract.py 中，当它引发异常时，它将显示文档行号和触发它的语句。仅此而已，但它至少会阻止您猜测是哪个条件触发了它。

```
def _define_checker(name, args, contract, path):
    """Define a function that does contract assertion checking.

    args is a string argument declaration (ex: 'a, b, c = 1, *va, **ka')
    contract is an element of the contracts list returned by parse_docstring
    module is the containing module (not parent class)

    Returns the newly-defined function.

    pre::
        isstring(name)
        isstring(args)
        contract[0] in _CONTRACTS
        len(contract[2]) > 0
    post::
        isinstance(__return__, FunctionType)
        __return__.__name__ == name
    """
    output = StringIO()
    output.write('def %s(%s):\n' % (name, args))
    # ttw001... raise new exception classes
    ex = _EXCEPTIONS.get(contract[0], 'ContractViolationError')
    output.write('\tfrom %s import forall, exists, implies, %s\n' % \
                (MODULE, ex))
    loc = '.'.join([x.__name__ for x in path])
    for c in contract[2]:
        output.write('\tif not (')
        output.write(c[0])
        # jlr001: adding conidition statement to output message, easier debugging
        output.write('): raise %s("%s", %u, "%s")\n' % (ex, loc, c[1], c[0]))
    # ...ttw001

    # ttw016: return True for superclasses to use in preconditions
    output.write('\treturn True')
    # ...ttw016

    return _define(name, output.getvalue(), path[0]) 
```

# django - PayPal Django

> ID：1017989
> 
> 赞同：5
> 
> 时间：2009-06-19T13:36:10.060
> 
> 标签：django, paypal, paypal-ipn

I am using Django-PayPal plugin ([http://github.com/johnboxall/django-paypal/tree/master](http://github.com/johnboxall/django-paypal/tree/master)), which works almost fine with one problem.

I followed integration process and think that everything is the same as in the guide. But there is the problem, that I always get the INVALID response flag. I will not be able to determine the sucessfull IPN.

Do you know, how to not get the INVALID response in the IPN?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-10T11:27:20.687

我知道这是一个老问题，但有些人可能仍会从中受益。

您必须为用于付款的 PayPal 测试帐户禁用“付款审核”。然后它应该按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-24T22:30:38.137

我目前正在使用它开发一个网站，当使用沙箱时，我得到了正确的付款状态响应，但是买家的电子邮件总是被标记为无效。

我相信这是由于沙盒环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-09T12:23:31.737

很长一段时间以来，我一直收到来自 IPN 的无效响应……只是发现我使用的是实时服务器 (www.paypal.com) 而不是沙箱 (sandbox.paypal.com)。

# sql - Sql Server 2005 在远程机器上执行 exe 或连接到服务器应用程序

> ID：1017992
> 
> 赞同：1
> 
> 时间：2009-06-19T13:36:59.060
> 
> 标签：sql, sql-server-2005, stored-procedures, sockets

我试图弄清楚如何创建 sql server 存储过程，当满足条件时，在网络中的远程计算机上执行带有命令行参数的可执行文件。我可以编写自己的小型服务器应用程序来处理从存储过程为可执行文件发送的通信，但我不确定套接字编程是否是 sql server 的合理选择。任何方向都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:48:38.163

无论如何，您都需要一些服务器端应用程序，即使该应用程序是 SQL Server :)

rsh 之类的东西可能会做 - 让您的本地 SQL 实例使用 rsh 命令（或批处理文件）调用 xp_cmdshell，连接到远程服务器并执行命令。

如果你在远程机器上有 SQL，那就容易多了；从本地机器调用该机器上的存储过程，并让该存储过程完成工作（可能需要摆弄代理并“执行为”）。

第三种选择是创建一个 .NET 存储过程，然后从那里进行套接字编程或远程调用 - 它在进程内运行，因此您可以获得与用 T-SQL 编写它时相似的性能和安全优势而不是跳到一个 cmdshell 与所有需要的混乱。

# sifr - sIFR will not display

> ID：1017993
> 
> 赞同：0
> 
> 时间：2009-06-19T13:37:01.247
> 
> 标签：sifr

My test page: [http://nyttravelshow.o3worlddev.com/trunk/](http://nyttravelshow.o3worlddev.com/trunk/)

My Js trunk/js/sifr_config.js

My CSS trunk/css/sifr.css

any and all help would be greatly appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:40:10.973

You are getting 404's on the SWF files needed for the sIFR, so that would be the first thing to look into.

# c# - 如何对 Asp.net 成员资格进行单元测试？

> ID：1017996
> 
> 赞同：15
> 
> 时间：2009-06-19T13:37:14.583
> 
> 标签：c#, .net, asp.net-mvc, unit-testing, nunit

我是单元测试的新手，我正在尝试测试我正在编写的一些 .NET 成员资格的东西。

所以我试图检查我的`VerifyUser`方法来检查用户凭据是否有效。

所以这就是它的样子：

```
public bool VerifyUser(string userName, string password)
    {
        bool valid = Membership.ValidateUser(userName, password);
        return valid;
    } 
```

现在每次我运行我的单元测试它都会失败。我知道我正在传递正确的凭据和东西。然后我突然意识到，也许我的测试项目（与我的真实项目在同一个解决方案下）可能需要它自己的`web.config`包含连接字符串和东西的文件。或者一个应用程序配置文件，因为它是一个应用程序库项目。

那么我是否只是`web.config`从我的真实项目中复制文件并收工？还是我应该只参与其中的一部分？或者我只是路途遥远。

我的数据库正在使用与我的数据库合并的 .net 成员资格的自定义数据库。所以在我的配置文件中，我必须指定一个 ManagerProvider 和一个 roleProvider。

这就是我的单元测试的样子

```
 [Test]
   public void TestVerifyUser()
   {
      AuthenticateUser authenitcate = new AuthenticateUser();
      bool vaild = authenitcate.VerifyUser("chobo3", "1234567");

      Assert.That(vaild, Is.True);
   } 
```

稍后我在我的一个 asp.net mvc ActionResult 方法中（确切地说是登录视图）我有这个：

FormsAuthentication.RedirectFromLoginPage(loginValidation.UserName, rememberMe);

那么现在我如何编写一个单元测试来做用户会做的事情。假设他们从主页开始，然后单击登录页面并成功登录。我希望他们被重定向到主页。

我不确定如何在代码中表示它。我很确定这些`RedirectFromLoginPage`作品，这就是我现在真正测试的东西。我正在测试登录`ActionResult`方法中可能发生的三件事。

1.  用户登录并被送回他们来自的地方。
2.  用户无法登录并被发送回`LoginView`并看到错误消息。
3.  用户试图进入安全并被重定向到登录页面。如果登录成功，将通过 ReturnUrl 重定向回安全页面。

所以我想做一个测试，看看这些是否能正常工作。所以这就是为什么我需要让用户像主页一样来查看他们是否稍后被重定向回它，如果他们来自安全页面，他们稍后会被重定向回该页面。

顺便说一句，我也在使用 NUnit 2.5 和 VS2008 Pro。

* * *

这就是我要测试的。我正试图查看用户是否有效（if 语句）。我不知道如何测试它。

```
public ActionResult Login(string returnUrl, FormCollection form, bool rememberMe)
       {
            LoginValidation loginValidation = new LoginValidation();
            try
            {
                UpdateModel(loginValidation, form.ToValueProvider());

            }
            catch
            {

                return View("Login");
            }

            if (ModelState.IsValid == true)
            {

                bool valid = authenticate.VerifyUser(loginValidation.UserName, loginValidation.Password);

                if (valid == false)
                {
                    ModelState.AddModelError("frm_Login", "Either the Password or UserName is invalid");

                }
                else if (string.IsNullOrEmpty(returnUrl) == false)
                {
                    /* if the user has been sent away from a page that requires them to login and they do 
                     * login then redirect them back to this area*/
                    return Redirect(returnUrl);
                }
                else
                {

                    FormsAuthentication.RedirectFromLoginPage(loginValidation.UserName, rememberMe);
                }

            }

            return View("Login");
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-22T16:54:39.927

您可以通过将自定义成员代码重构为两层来测试控制器和大部分自定义提供程序：仅与数据库交互的数据访问存储库，以及使用存储库组件提供成员资格 API 的服务层。服务层是您验证参数、保存和强制执行参数（如 EnablePasswordReset）并将任何数据库异常或状态代码转换为适合控制器使用的形式的地方。

当您为每个层指定其自己的接口时，消费者可以写入该接口，而不管其实现方式如何。当您的应用程序运行时，您的提供者当然会通过这些接口与数据库通信，但为​​了进行测试，您可以模拟存储库或服务接口。您可以通过模拟存储库级别来测试您的服务层，而不必弄乱数据库或 web.config 文件，并且您可以通过模拟服务层来测试您的控制器。如果您不想重构整个提供程序，如果您只创建服务接口并让您的控制器使用它，您仍然可以测试您的控制器。

具体来说，如果有点冗长，您的存储库和服务接口可能类似于：

```
namespace Domain.Abstract {
    public interface IRepository {
        string ConnectionString { get; }
    }
}

namespace Domain.Abstract {
    public interface IUserRepository : IRepository {
        MembershipUser CreateUser(Guid userId, string userName, string password, PasswordFormat passwordFormat, string passwordSalt,
                string email, string passwordQuestion, string passwordAnswer, bool isApproved,
                DateTime currentTimeUtc, bool uniqueEmail);
        MembershipUser GetUser(Guid userId, bool updateLastActivity, DateTime currentTimeUtc);
        PasswordData GetPasswordData(Guid userId, bool updateLastLoginActivity, DateTime currentTimeUtc);
        void UpdatePasswordStatus(Guid userId, bool isAuthenticated, int maxInvalidPasswordAttempts, int passwordAttemptWindow, 
                      DateTime currentTimeUtc, bool updateLastLoginActivity, DateTime lastLoginDate, DateTime lastActivityDate);
        //....
    }
}

namespace Domain.Abstract {
  public interface IUserService {
    bool EnablePasswordRetrieval { get; }
    bool EnablePasswordReset { get; }
    bool RequiresQuestionAndAnswer { get; }
    bool RequiresUniqueEmail { get; }
    //....

    MembershipUser CreateUser(string applicationName, string userName, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved);
    MembershipUser GetUser(Guid userId, bool userIsOnline);
    bool ValidateUser(Guid userId, string password);
    //...
    }
}

namespace Domain.Concrete {
  public class UserService : IUserService {
    private IUserRepository _userRepository;

    public UserService(IUserRepository userRepository) {
        _userRepository = userRepository;
    }
    //...
    public bool ValidateUser(Guid userId, string password) {
        // validate applicationName and password here
        bool ret = false;
        try {
            PasswordData passwordData;
            ret = CheckPassword(userId, true, true, DateTime.UtcNow, out passwordData);
        }
        catch (ObjectLockedException e) {
            throw new RulesException("userName", Resource.User_AccountLockOut);
        }
        return ret;
    }

    private bool CheckPassword(Guid userId, string password, bool updateLastLoginActivityDate, bool failIfNotApproved,
                                DateTime currentTimeUtc, out PasswordData passwordData) {
        passwordData = _userRepository.GetPasswordData(userId, updateLastLoginActivityDate, currentTimeUtc);

        if (!passwordData.IsApproved && failIfNotApproved)
            return false;

        string encodedPassword = EncodePassword(password, passwordData.PasswordFormat, passwordData.PasswordSalt);
        bool isAuthenticated = passwordData.Password.Equals(encodedPassword);

        if (isAuthenticated && passwordData.FailedPasswordAttemptCount == 0 && passwordData.FailedPasswordAnswerAttemptCount == 0)
            return true;
        _userRepository.UpdatePasswordStatus(userId, isAuthenticated, _maxInvalidPasswordAttempts, _passwordAttemptWindow,
                                            currentTimeUtc, updateLastLoginActivityDate,
                                            isAuthenticated ? currentTimeUtc : passwordData.LastLoginDate,
                                            isAuthenticated ? currentTimeUtc : passwordData.LastActivityDate);

        return isAuthenticated;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T07:45:24.353

Asp.Net Membership 系统旨在在 Asp.Net 请求的上下文中工作。所以，你在这里有三个选择。

1.  大多数人在面对这种依赖时会围绕它编写一个薄包装器。包装器不做任何事情，只是将所有调用重定向到底层依赖项。所以，他们只是不测试它。您的 AuthenticateUser 就是这样一个包装器。您可能应该将所有方法设为虚拟或提取接口以使其可模拟，但这是另一回事。
2.  使用 TypeMock Isolator 和 mock Membership。
3.  使用[Ivonna 框架](http://sm-art.biz/Ivonna.aspx)并在 Asp.Net 上下文中运行您的测试（这将是一个集成测试）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T14:04:38.570

不幸的是，您不能只复制您的 web.config 或 app.config 并让它以这种方式工作。原因是您的程序集在 NUnit 进程内部运行，而不是在您的应用程序下。

为了纠正您的情况，您可能必须模拟或存根您正在调用的成员资格成员，或者按照约定优于配置的方法来处理您存储在 web.config 中的设置。

那里有许多模拟框架，但这里有几个：[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)，[Moq](http://code.google.com/p/moq/)

此外，要遵循约定优于配置的方法，您可以执行以下操作：

```
static ConfigurationSettings
{
     static String SomeSetting
     {
        get
        {
           var result = "HARDCODEDVALUE";
           if (ConfigurationManager.AppSettings["SOMEKEY"] != null)
               result = ConfigurationManager.AppSettings["SOMEKEY"];
           return result;
     }
} 
```

然后，您可以像这样使用此代码：

```
//this is how the old code might look
var mySetting = ConfigurationManager.AppSettings["SOMEKEY"];
//use the setting

//this is how the new code would look
var mySetting = ConfigurationSettings.SomeSetting;
//use the setting 
```

这样您的测试就可以工作，当您在应用程序下运行它时，它将使用您存储的任何配置设置。

# java - 用于从 JPA/Hibernate 注释类生成 ER 图的 Ant 任务

> ID：1017997
> 
> 赞同：8
> 
> 时间：2009-06-19T13:37:38.157
> 
> 标签：java, sql, hibernate, jpa, ant

有谁知道可以做到这一点的工具？

[Linguine maps](http://www.softwaresecretweapons.com/jspwiki/linguinemapsforhibernate)似乎只适用于旧的休眠 xml 文件。而且hibernate工具任务hbm2hbmxml似乎有[一个bug](https://forum.hibernate.org/viewtopic.php?f=6&t=992077&view=previous)，所以我不能做两步过程“annotations->hbmxml->diagram”

最好的，安德斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T11:49:19.627

嗯，我[在 developerworks 上找到了这篇很棒的帖子](http://www.ibm.com/developerworks/library/j-ap06108/index.html)。在那里，作者似乎从实时数据库生成实体图。我想知道我是否可以去“带注释的类 -> 实时数据库（例如 H2） -> SchemasSpy 生成的图表？

是的，API Viz 看起来很棒。

我[用 SchemaSpy 写了我的 hacky 解决方案](http://www.code3.dk/automated-documentation-and-odfdom/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T15:38:52.060

不完全是您要查找的内容，但您可以使用[API Viz](http://code.google.com/p/apiviz/)，它会自动从类层次结构中生成类似 UML 的图表，并且可以使用 doclet 标记进行扩充。

你必须对你的类做一些标记，但它是一个很棒的工具，无论你想在哪里可视化大型或复杂的项目，都值得使用。