# StackOverflow 问答 000621000-000621999

# javascript - 如何调试用于 IE 代理设置的 Javascript proxy.pac 文件？

> ID：621004
> 
> 赞同：15
> 
> 时间：2009-03-07T00:35:37.850
> 
> 标签：javascript, debugging, internet-explorer, proxy.pac

有人知道它是否可以调试proxy.pac，这个文件是用Javascript编写的。如何将它附加到一些调试引擎，如 Visual Studio 或任何其他 IDE

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-05-21T15:52:34.610

Google Code 上有“pactester”。工作精美。

*   [http://code.google.com/p/pactester/](http://code.google.com/p/pactester/)

**编辑：**

测试仪现在已移至解析器项目中：

*   [https://github.com/pacparser/pacparser](https://github.com/pacparser/pacparser)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-08T03:53:14.887

[PRB：无法从 Visual InterDev 调试 .pac 文件](http://support.microsoft.com/kb/274356)（或“如何调试 .pac 文件”）可能会有所帮助。在此处使用 IE 8 和 Visual Studio 2008。

# c++ - 关于可以链接到 c++ 的语言

> ID：621007
> 
> 赞同：3
> 
> 时间：2009-03-07T00:36:30.327
> 
> 标签：c++, linker

当我在思考这个主题时，在我看来，如果一种语言是用 C++ 实现的，那么它很可能有一个链接到 C++ 的机制。我记得，Java 是通过 JNI 实现的，虽然我不记得它是通过 C++ 还是纯 C。

但是，似乎一般语言不链接到 C++，并且由于各种原因只能通过 C 访问 C++。

于是，出于好奇，

有哪些语言可以链接到 C++ 以及如何以及在多大程度上？

（除非以优雅或有趣的方式完成，如 Boost.Python，否则前面提到的 C 桥不能归功于它）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-07T00:40:19.133

*注意：ABI 包括名称修改以及调用约定、环境要求等。EABI（此处未涉及）是特定于平台的，但通常针对每个平台进行标准化（尽管不能保证），并且不受可变参数 EABI 的问题（因为它变化不大）。有关该主题的更多信息，请参阅[Wikipedia 上的 ABI 。](http://en.wikipedia.org/wiki/Application_binary_interface)*

**由于 ABI 未定义，**因此不太可能链接到 C++ 。**因此，符号的名称可以根据编译器供应商的意愿进行更改。例如，GCC 的做法与 MS 的编译器不同。即使使用相同的编译器，版本之间的 ABI 也可能不同（就像某些 GCC 版本一样）。**

 **但是，**链接到 C++ 并非不可能**。C++ 程序链接到其他 C++ 程序是很常见的，因为它们都是由相同的编译器编译的（或者至少是使用相同 ABI 的编译器）。如果 ABI 已知，非 C++ 应用程序可以链接到 C++ 应用程序。

**链接到 C 很容易**。这是因为对于大多数平台，**C 的 ABI 比 C++ 的 ABI 更稳定。**这是由于与 C++ 相比 C 的简单性。因为 C++ 可以导出 C 符号，绕过了 C++ 的 ABI 的问题，所以有时您会看到 C++ 库导出 C 符号，它允许与底层 C++ 对象进行交互，而不会出现名称修改、链接兼容性和面向未来的问题。但是，这样做会阻止您通过 C 接口和 C++ 接口轻松使用 C++ 库。

但是**您可以通过使用 C 导出来使用 C++ 接口**。该库可以在头文件中提供一些类，为您包装 C 导出。这是对库编写者的更多工作（并且可能会导致一些问题，因为 DRY 通常不使用这种技术进行实践）但为库用户提供了很多好处（他们可以在两个接口之间进行选择而不必担心链接问题！）。对于其他语言，库编写者可以提供接口，如 C++ 头文件，它们自己处理 C 导出。（然后您就可以使用本机类等。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-07T00:40:22.987

没有一种语言可以很好地做到这一点，因为**[C++ 标准没有指定名称修饰方案](http://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B)**。因此，不同的编译器可以自由地以不同的方式修改名称，并且没有一致的方式链接到 C++ 二进制文件。

这么多东西可以链接到 C 的原因是因为 C 具有简单且一致的链接。在目标文件`foo`中调用一个函数。`foo`同样，事物可以很好地链接到 Fortran，因为`foo`它是`foo`、`FOO`、`foo_`或`foo__`.

这就是为什么有这么多 C++ 对象（[SWIG](http://www.swig.org/)、[Boost.Python](http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html)、[SIP](http://www.riverbankcomputing.co.uk/software/sip/intro)等）的包装器生成器的原因。他们将接口定义为一组**C**调用正是因为这使得事情很容易链接。

要记住的另一件事是您是否**真的**想直接链接到 C++ 库。当您生成包装器时，许多包装器生成器提供了很多策略选项。请记住，C 调用归结为函数，但 C++ 调用通常有很多 OO 语义，您需要在其中导航。您需要指定在宿主语言中应该如何对 C++ 对象进行垃圾收集、如何复制内容、vptr 在哪里、如何布局对象、在哪里分配对象，以及宿主语言的对象模型与该对象模型之间的所有细微差别。 C++ 的。

我知道只链接到 C++ 库并完成它听起来很理想，但这**并不是那么简单**，而且你最终会想要的不仅仅是直接链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T00:40:33.127

最近在[看 SWIG](http://www.swig.org/)？

# caching - 实现缓存

> ID：621028
> 
> 赞同：4
> 
> 时间：2009-03-07T00:45:06.500
> 
> 标签：caching, haskell

我正在尝试实现一个透明缓存，它可以在特定对象不可用时加载它，或者返回一个由 ( ) 索引的现有对象`name`。

我试过运行这个：

```
loader' objs name = case findObj objs name of
  Nothing →  (new_obj, loader' new_objs)
  Just obj →  (obj, loader' objs)
  where
    new_objs = [(name, new_obj)] ++ objs
    new_obj = readObj name
loader = loader' [] 
```

但我得到了一个

```
发生检查：无法构造无限类型：
  t = (ObjType, 字符串 -> t)

```

这看起来完全像我想要的东西:)

如何修复该函数以使其编译？

说明：

根据要求，签名（findObj 要么返回通过密钥找到的已知值，要么返回 Nothing，readObj 为密钥创建一个新 obj）：

```
findObj :: [(String, ObjType)] -> String -> Maybe ObjType
readObj :: String -> ObjType 
```

是的 - 我需要一个缓存，因为键是文件名，我不想在每次需要某个对象时读取+解析文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T02:59:52.463

为什么不直接记忆[findObj](http://www.haskell.org/haskellwiki/Memoization)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T05:19:53.017

两个想法（疯狂的猜测？）看起来好像它没有在`Just obj`子句和/或 from中产生正确的类型签名`readObj name`，尝试这样的事情可能会很有趣：

```
loader' :: [(String, ObjType)] -> String -> (ObjType, String -> ObjType)
loader' objs name = case findObj objs name of
  Nothing →  (new_obj, loader' new_objs) where
    new_objs = [(name, new_obj)] ++ objs
    new_obj = readObj name
  Just obj →  (obj, loader' objs)
loader = loader' [] 
```

我并不是说那会解决它（但我想它可能会）；相反，我是说它可能会将问题转化为更有意义的问题，或者以其他方式阐明情况。

编辑：

应用 Tom Lokhorst 命名缓存类型的建议将我们引向这一点：

```
type Cache = [(String, ObjType)]
loader' :: Cache -> String -> (ObjType, ????)
loader' objs name = case findObj objs name of
  Nothing →  (new_obj, loader' new_objs) where
    new_objs = [(name, new_obj)] ++ objs
    new_obj = readObj name
  Just obj →  (obj, loader' objs)
loader = loader' [] 
```

这很明显问题是什么。loader' 的第二个结果的类型是一个接受字符串并产生由 ObjType 组成的对的函数和接受字符串并产生由 ObjType 组成的对的函数和接受字符串并产生对的函数由一个 ObjType 和一个接受字符串的函数组成，并产生一对由 ObjType 和......你得到的图片。

如果你像这样重写它：

```
type Cache = [(String, ObjType)]
loader' :: Cache -> String -> (ObjType, Cache)
loader' objs name = case findObj objs name of
  Nothing →  (new_obj, new_objs) where
    new_objs = [(name, new_obj)] ++ objs
    new_obj = readObj name
  Just obj →  (obj, objs) 
```

它应该可以编译，但您必须更改使用它的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T09:50:51.853

Haskell 不支持这样的类型：

```
type t = Int -> t 
```

这是因为编译器试图展开这种类型，对它进行类型检查。由于类型系统是严格退出的，这将导致在类型检查期间出现无限循环。现在拥有一个更惰性的类型系统会很好，而不是你能做到这一点，但是，目前还没有 Haskell。

然而，正如 MarkusQ 所说，改变`loader'`函数的作用更容易。我想我会这样写：

```
type Cache = [(String, ObjType)]

loader' :: Cache -> String -> (ObjType, Cache) 
```

这是一个获取缓存和搜索字符串的函数，返回答案和（可能更新的）缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T01:32:22.050

你可能想看看[这个](http://haskell-web.blogspot.com/2006/11/transactional-cache-for-haskell.html)在 haskell 中的缓存实现。

# database - 内存数据库

> ID：621047
> 
> 赞同：2
> 
> 时间：2009-03-07T00:52:27.140
> 
> 标签：database, nhibernate, in-memory, in-memory-database

我正在使用 SqlServer 来驱动 WPF 应用程序，我目前正在使用 NHibernate 并预读取所有数据，因此出于性能原因将其缓存。这适用于单个客户端应用程序，但我想知道是否有一个内存数据库可供我使用，以便我可以在同一台机器上的多个应用程序之间共享信息。理想情况下，这将位于我的 NHibernate 堆栈之下，因此我的代码不必更改。实际上，我希望将我的数据库从服务器上的传统格式移动到客户端上的内存数据库。

注意我只需要选择功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T01:22:07.363

如果您甚至需要将所有信息加载到内存中，我会感到非常惊讶。我这样说是因为，作为一个例子，我目前正在开发一个 Web 应用程序（由于各种原因）在许多页面上加载数千条记录。这是 PHP + MySQL。即便如此，它也可以在 100 毫秒内完成并渲染页面。

在您沿着这条路线走之前，请确保您必须这样做。首先使您的数据库尽可能高性能。现在显然这包括诸如拥有适当的索引和调整数据库之类的事情，但即使是本末倒置。

首先，您需要确保您拥有一个良好的关系数据模型：一个适合高性能查询的模型。这既是艺术，也是科学。

此外，您可能喜欢 NHibernate，但[ORM 并不总是最佳选择](https://stackoverflow.com/questions/494816/using-an-orm-or-plain-sql/494853#494853)。例如，在某些极端情况下，手工编码的 SQL 将非常出色。

现在假设您有一个良好的数据模型，并假设您已经优化了索引和数据库参数，然后您已经正确配置了 NHibernate，那么**当且仅当性能仍然是一个问题时，**您才应该考虑将数据存储在内存中。

从这个角度来看，我需要这样做的唯一时间是在需要每天执行数百万笔交易的系统上。

避免内存缓存的一个原因是它增加了很多复杂性。您必须处理缓存到期、对底层数据存储的独立更新、使用同步还是异步更新、如何为客户端提供一致的（如果不是最新的）数据视图、如何处理等问题具有故障转移和复制等功能。需要付出巨大的复杂性成本。

假设您已完成上述所有操作并且仍然需要它，那么在我看来，您需要的是缓存或网格解决方案。以下是[Java 网格/集群解决方案的概述，](https://stackoverflow.com/questions/383920/what-is-the-best-library-for-java-to-grid-cluster-enable-your-application/383929#383929)但其中许多（例如 Coherence、memcached）也适用于 .Net。.Net 的另一个选择是[Velocity](http://code.msdn.microsoft.com/velocity)。

需要指出并强调的是，像 NHibernate 这样的东西只有在没有任何外部更新数据库的情况下是一致的，并且只有一个启用 NHibernate 的进程（除非是集群解决方案）。如果两台不同 PC 上的两个桌面应用程序都使用 NHibernate 更新同一个数据库，那么缓存将无法正常工作，因为持久性单元根本不会知道另一个正在进行的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T00:56:04.260

[http://www.db4o.com/](http://www.db4o.com/)可以成为你的朋友！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T01:20:33.297

[Velocity](http://blogs.msdn.com/velocity)是由 Microsoft 设计的进程外对象缓存服务器，尽管目前它只是 CTP 形式，但它几乎可以满足您的需求。

我相信memcached也有包装器，也可以用来缓存对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-10T16:35:24.510

您可以使用HANA，快递版。您可以[免费下载它](https://www.sap.com/developer/topics/sap-hana-express.html)，它是内存中的、柱状的，并允许进一步的分析功能，例如文本分析、地理空间或预测。您还可以使用 ODBC、JDBC、node.js hdb 库、REST API 等进行访问。

# .net-3.5 - 升级VS2005到VS2008

> ID：621054
> 
> 赞同：0
> 
> 时间：2009-03-07T00:56:03.760
> 
> 标签：.net-3.5, windows-vista

我有一个小程序<350 行代码在 5 个表单上>。它可以在 VS2005 上正常编译，但在 Vista 上无法正常运行。通过VS2008导入后，初步运行正常。但是，有一个主窗体和四个从属窗体来设置初始窗体的设置和属性。它们正常工作，直到它们被第二次实例化，然后它们被显示，但它们的行为就像它们完全是模态的。删除表单的唯一方法是关闭启动表单。有没有人对此有任何解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T02:52:24.400

你确定你在关闭表格后清理，而不是打开一个，但不可见。我不确定这在 VS2005 中是否有任何不同，但我见过一些应用程序并没有完全处理表单上的项目，而是在内存中留下了一些位。虽然它们本身并没有创建模态表单，但这是打开表单时的感觉。没有看到你的代码，我只能猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T21:13:39.857

我的问题的答案不是这个问题的答案。它与透明度键的处理方式有关。

# c# - System.Xml.XmlReader (C# & .Net) 中的当前行号

> ID：621059
> 
> 赞同：25
> 
> 时间：2009-03-07T00:58:40.337
> 
> 标签：c#, .net, xml, xmlreader, line-numbers

有谁知道如何获取 System.Xml.XmlReader 的当前行号？我正在尝试记录在文件中找到 Xml 元素的位置。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-07T01:02:18.067

利用[`IXmlLineInfo`](http://msdn.microsoft.com/en-us/library/system.xml.ixmllineinfo.aspx)由 an 支持的接口`XmlReader`：

```
IXmlLineInfo xmlInfo = (IXmlLineInfo)reader;
int lineNumber = xmlInfo.LineNumber; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-19T06:06:46.547

扩展`IXmlLineInfo`界面，这方​​面的文档非常糟糕；通过一些挖掘，我可以告诉你以下内容：

1)`System.Xml.XmlReader`是抽象的，所以你永远不会处理这个的实例，因此，它没有实现的事实并没有引起很大`IXmlLineInfo`的关注（尽管，如果它实现了，它会让一切变得那么小容易一点:)）

2）`System.Xml.IXmlLineInfo`接口提供了两个属性：`LineNumber`和`LinePosition`（这是我们关心的东西），加上一个方法：`HasLineInfo()`根据文档，它将让您知道实现者是否可以返回 lineinfo。

3) 在记录的 的继承者中`System.Xml.XmlReader`，我们有：

```
System.Xml.XmlDictionaryReader - abstract, used by WCF for serialization, no IXmlLineInfo
System.Xml.XmlNodeReader - used when reading a node, no IXmlLineInfo
System.Xml.XmlTextReader - used when reading a stream of data, has IXmlLineInfo
System.Xml.XmlValidatingReader - used when reading a stream of data and validating, has IXmlLineInfo. 
```

查看上面的列表，`XmlDictionaryReader`将在内部使用，`XmlNodeReader`将在您传入要读取的节点时使用（已被解析，已与源文档无关），`XmlTextReader`and `XmlValidtingReader`(`IXmlLineInfo`当您从文档中读取时，将使用这两个工具）。因此，总而言之，如果向您提供位置信息是可能或有用的，框架就会这样做。

话虽如此，文档似乎很轻。刚刚完成了这个，我最终做了（ _xr 是一个未知的具体实现`System.Xml.XmlReader`）：

```
string position = "(unknown)";
    if (_xr != null && typeof(System.Xml.IXmlLineInfo).IsInstanceOfType(_xr) &&
((System.Xml.IXmlLineInfo)_xr).HasLineInfo())
    {
        System.Xml.IXmlLineInfo li = (System.Xml.IXmlLineInfo)_xr;
        position = "(" + li.LineNumber.ToString() + "," + li.LinePosition.ToString() + ")";
    } 
```

综上所述，当我实际运行上面的代码时，_xr 的类型最终是`System.Xml.XsdValidatingReader`（祝你好运找到关于它的文档！），它继承自`System.Xml.XmlReader`，但不继承自`System.Xml.XmlValidatingReader`or `System.Xml.XmlTextReader`。因此，使用上述方法可能是明智的。

# python - Python函数：从购买金额中查找找零

> ID：621062
> 
> 赞同：-4
> 
> 时间：2009-03-07T00:58:59.493
> 
> 标签：python, dictionary, coin-change

我正在寻找最有效的方法来从购买金额中计算出零钱金额（夸脱、角钱、镍币和便士）。购买金额必须小于 1 美元，零钱从 1 美元起。我需要知道有人能拿回多少 25 美分硬币、5 美分硬币和多少便士。

最好是建立一本字典吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T01:36:04.257

哎呀，你的意思是这不再是每门编程课程中的问题 2b 了吗？呃，可能不是，他们似乎也不再教人们如何做出改变了。（或者他们可能会这样做：这是家庭作业吗？）

如果你找到一个 50 岁以上的人并让他们为你做出改变，它的工作原理是这样的。假设你有一张 3.52 美元的支票，你递给收银员一张 20 美元。然后他们会说“三点五十二”来改变

*   倒数三便士，说“三，四，五”（3.55）
*   倒数 2 镍币，(3.60, 3.65)
*   倒数一角钱 (3.75)
*   四分之一（4美元）
*   一美元钞票（五美元）
*   一张 5 美元的钞票（十美元）
*   一张 10 美元的钞票（二十。）

这本质上是一个递归过程：您将当前面额倒数，直到当前金额加上下一个面额出现偶数。然后向上移动到下一个面额。

当然，您可以像上面那样迭代地执行此操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T01:49:36.487

这可能非常快 - 每个面额只需几个操作：

```
def change(amount):
    money = ()
    for coin in [25,10,5,1]
        num = amount/coin
        money += (coin,) * num
        amount -= coin * num

    return money 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T01:11:34.143

你最好的选择是可能有一个排序的硬币大小字典，然后循环检查你的变化是否大于值，添加硬币并减去值，否则移动到字典中的下一行。

例如

```
Coins = [50, 25, 10, 5, 2, 1]
ChangeDue = 87
CoinsReturned = []
For I in coins:
   While I >= ChangeDue:
        CoinsReturned.add(I)
        ChangeDue = ChangeDue - I 
```

原谅我糟糕的python语法。希望这足以继续。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-31T18:47:45.437

上述解决方案工作。

```
amount=int(input("Please enter amount in pence"))
coins = [50, 25, 10, 5, 2, 1]
coinsReturned = []
for i in coins:
  while amount >=i:
        coinsReturned.append(i)
        amount = amount - i
print(coinsReturned) 
```

或者，可以通过使用 floor 和 mod 功能获得解决方案。

```
amount = int(input( "Please enter amount in pence" ))
# math floor of 50
fifty = amount // 50
# mod of 50 and floor of 20
twenty = amount % 50 // 20
# mod of 50 and 20 and floor of 10
ten = amount % 50 % 20 // 10
# mod of 50 , 20 and 10 and floor of 5
five = amount % 50 % 20 % 10 // 5
# mod of 50 , 20 , 10 and 5 and floor of 2
two = amount % 50 % 20 % 10 % 5 // 2
# mod of 50 , 20 , 10 , 5 and 2 and floor of 1
one = amount % 50 % 20 % 10 % 5 % 2 //1

print("50p>>> " , fifty , " 20p>>> " , twenty , " 10p>>> " , ten , " 5p>>> " , five , " 2p>>> " , two , " 1p>>> " , one ) 
```

或其他解决方案

```
amount=int(input("Please enter the change to be given"))
endAmount=amount

coins=[50,25,10,5,2,1]
listOfCoins=["fifty" ,"twenty five", "ten", "five", "two" , "one"]
change = []

for coin in coins:
    holdingAmount=amount
    amount=amount//coin
    change.append(amount)
    amount=holdingAmount%coin

print("The minimum coinage to return from " ,endAmount, "p is as follows")
for i in range(len(coins)):
  print("There's " , change[i] ,"....",  listOfCoins[i] , "pence pieces in your change" ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T17:46:29.530

使用数论中的整数分区可以很容易地解决这个问题。我写了一个递归函数，它接受一个数字和一个分区列表，并返回构成给定数字的可能组合的数量。

[http://sandboxrichard.blogspot.com/2009/03/integer-partitions-and-wiki-smarts.html](http://sandboxrichard.blogspot.com/2009/03/integer-partitions-and-wiki-smarts.html)

这不完全是您想要的，但可以轻松修改它以获得您的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-25T19:59:01.993

我有上述解决方案的改进解决方案

```
coins=[]
cost = float(input('Input the cost: '))
give = float(input('Tipe Amount given: '))

change = (give - cost)
change2 = change-int(change)
change2 = round(change2,2)*100
coin = [50,25,10,5,1]
for c in coin:
    while change2>=c:
        coins.append(c)
        change2 = change2-c

half=coins.count(50)
qua = coins.count(25)
dime=coins.count(10)
ni=coins.count(5)
pen=coins.count(1)
dolars = int(change)
if half !=0 or qua != 0 or dime!=0 or ni!=0 or pen!=0:
    print ('The change of', round(give,2), 'is:',change, 'like \n-dolas:',dolars,'\n-halfs:',half,'\n-quarters:',qua,'\n-dime:',dime,'\n-nickels:',ni,'\n-pennies:',pen)
else:
     print ('The change from', round(give,2), 'is:',change,'and no coins') 
```

# php - 用于评级系统的高效 MySQL 表结构

> ID：621065
> 
> 赞同：3
> 
> 时间：2009-03-07T01:00:07.073
> 
> 标签：php, mysql, optimization, performance, project-planning

这篇文章是这个已回答问题的后续：[Best method for storage a list of user IDs](https://stackoverflow.com/questions/620645/best-method-for-storing-a-list-of-user-ids)。

我接受了 cletus 和 Mehrdad Afshari 关于使用标准化数据库方法的史诗建议。下表是否正确设置以进行适当优化？我对 MySQL 效率有点陌生，所以我想确保这是有效的。

另外，在查找游戏的平均评分和总票数时，我应该分别使用以下两个查询吗？

```
SELECT avg(vote) FROM votes WHERE uid = $uid AND gid = $gid;    
SELECT count(uid) FROM votes WHERE uid = $uid AND gid = $gid;

CREATE TABLE IF NOT EXISTS `games` (
  `id` int(8) NOT NULL auto_increment,
  `title` varchar(50) NOT NULL,
  PRIMARY KEY  (`id`)
) AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `users` (
  `id` int(8) NOT NULL auto_increment,
  `username` varchar(20) NOT NULL,
  PRIMARY KEY  (`id`)
) AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `votes` (
  `uid` int(8) NOT NULL,
  `gid` int(8) NOT NULL,
  `vote` int(1) NOT NULL,
  KEY `uid` (`uid`,`gid`)
) ; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T00:20:08.820

一场比赛的平均票数：`SELECT avg(vote) FROM votes WHERE gid = $gid;`

一场比赛的票数：`SELECT count(uid) FROM votes WHERE gid = $gid;`

由于您不会有任何用户或游戏 ID 更小，因此`0`您可以将它们设为无符号整数 ( `int(8) unsigned NOT NULL`)。

如果您想强制用户只能对游戏进行一次投票，请在表中创建主键`uid`，而不仅仅是普通索引。`gid``votes`

```
CREATE TABLE IF NOT EXISTS `votes` (
  `uid` int(8) unsigned NOT NULL,
  `gid` int(8) unsigned NOT NULL,
  `vote` int(1) NOT NULL,
  PRIMARY KEY (`gid`, `uid`)
) ; 
```

主键字段的顺序（ first `gid`， then `uid`）很重要，因此索引按`gid`first 排序。这使得索引对于具有给定 的选择特别有用`gid`。如果您想选择给定用户所做的所有投票，则只需添加另一个索引`uid`。

我建议将 InnoDB 用于存储引擎，因为特别是在高负载设置中，表锁会影响您的性能。对于读取性能，您可以使用 APC、Memcached 或其他方式实现缓存系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T01:31:12.257

看起来挺好的。

我会使用 users_id 和 games_id 而不是 gid 和 uid 听起来像全局 id 和唯一 id

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T01:32:27.743

无论您最终做什么，请确保使用大型数据集对其进行测试（即使您不打算拥有大量用户）

编写一个脚本，生成 100,000 个游戏、50,000 个用户和一百万张选票。可能有点过分，但如果您的查询不需要花费数小时来处理这么多的项目，那永远不会成为问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T01:29:32.680

到目前为止看起来不错。不要忘记索引和外键。以我的经验，大多数问题都不是由于没有经过深思熟虑的设计，而是由于缺乏索引和外键。

此外，关于存储引擎的选择，我还没有看到不使用 innodb 的原因（在相当复杂/大小的应用程序中），而不仅仅是因为事务语义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-03T04:25:47.430

您可能还想添加一个`voted_on`(DATETIME) 列。这样一来，您就可以看到某个游戏在某个时间跨度内的趋势，或者万一某天发生了垃圾投票，您可以准确地删除不需要的投票。

# apache - mod_rewrite 依赖于哪些模块？

> ID：621067
> 
> 赞同：1
> 
> 时间：2009-03-07T01:00:13.267
> 
> 标签：apache, apache2

代理人？代理_http？还有什么？

当我包含所有可用的模块时，重写工作，但我很难弄清楚哪些模块实际上有所作为。

答案：`vhost_alias`是一个。似乎现在可以工作了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T01:09:19.687

mod_rewrite 本身没有任何直接依赖关系。有一些指令可以将工作委托给其他模块（例如 RewriteRule .... [P]，它使用 mod_proxy 来执行请求），因此需要额外的模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T01:24:29.510

要让 mod_rewrite 工作，首先，你必须打开它。在 httpd.conf 中取消注释：LoadModule rewrite_module libexec/mod_rewrite.so 并重新启动 Apache。

如果您使用 .htaccess 来管理 mod_rewrite，那么您也需要激活它。并设置 AllowOverride。

参考：[http ://www.usenet-forums.com/apache-web-server/10742-activate-mod_rewrite.html](http://www.usenet-forums.com/apache-web-server/10742-activate-mod_rewrite.html)

和[http://www.apachefriends.org/f/viewtopic.php?f=16&t=33314](http://www.apachefriends.org/f/viewtopic.php?f=16&t=33314) 和[http://httpd.apache.org/docs/2.0/en/mod/core.html#allowoverride](http://httpd.apache.org/docs/2.0/en/mod/core.html#allowoverride)

# c# - 实现空迭代器

> ID：621078
> 
> 赞同：0
> 
> 时间：2009-03-07T01:11:31.663
> 
> 标签：c#, refactoring, iterator

我有这个代码：

```
 public IEnumerable<int> Iterator {
        get { if (false) yield return -1; }
    } 
```

它相当难看，但是当您尝试将其重构为：

```
 public IEnumerable<int> Iterator {
        get { return null; }
    } 
```

以下代码中断：

```
foreach (var item in obj.Iterator) {
} 
```

你会怎么清理这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-07T01:13:40.753

```
public IEnumerable<int> Iterator {
    get { yield break; }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-07T13:37:23.960

顺便说一下，.NET 框架已经有一种方法可以做到这一点（使 Jared 的代码变得多余）[`System.Enumerable.Empty<T>`](http://msdn.microsoft.com/en-us/library/bb341042.aspx)：.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T13:28:11.207

更好的解决方案是为这个问题定义一个可重用的方法。我在我的共享库中保留了一个方法来处理这种情况。

```
public static class CollectionUtility { 
  public static IEnumerable<T> CreateEmptyEnumerable<T>() {
    yield break;
  }
} 
```

现在在你的方法中你可以打电话

```
public static IEnumerable<int> Iterator { 
  get { return CollectionUtility.CreateEmptyEnumerable<int>(); }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-20T16:10:48.013

```
 public IEnumerable<int> Iterator {
        get { yield break; }
    } 
```

# c++ - 比较从 C 中的套接字接收的字符串数据

> ID：621084
> 
> 赞同：2
> 
> 时间：2009-03-07T01:13:45.310
> 
> 标签：c++, c, sockets

我有一个关于插座的问题。我有这个代码：

```
while(bytes = recv(sClient, cClientMessage, 599, 0)){ 
```

这会将它接收到的消息放入 cClientMessage 中，并且消息始终是“消息”。我是如何做出一个 if 语句的`if(cClientMessage == "Message"){//do func}`。现在这段代码不会做我想要的功能。我认为这是因为它没有正确接收消息。有人能帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T01:16:42.167

尝试：

```
if( strcmp( cClientMessage, "Message")) == 0 ) {
   // do something
} 
```

**编辑，遵循strager的建议：**

一个更好的解决方案是使用 memcmp，它不依赖于接收到的数据被空终止：

```
if( memcmp( cClientMessage, "Message", strlen( "Message") )) == 0 ) {
   // do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T01:16:23.023

首先，您编写的代码中有一个错误：

```
while(bytes = recv(sClient, cClientMessage, 599, 0)){ 
```

这是错误的，因为如果存在套接字错误，recv 将返回非零，并且您的代码将导致无限循环。特别是您要检查 > 0

```
char cClientMessage[599];
while((bytes = recv(sClient, cClientMessage, sizeof(cClientMessage), 0)) > 0)
{
  if(strlen("Message") == bytes && !strncmp("Message", cClientMessage, bytes))
  {
    //cClientMesssage contains "Message"
  }
} 

if(bytes == 0)
{
  //socket was gracefully closed
}
else if(bytes < 0)
{
  //socket error occurred
} 
```

您所做的问题： cClientMessage == "Message" 是，如果您将 char* 与字符串文字进行比较，或者将 char[] 与字符串文字进行比较，那么您将比较指针地址而不是实际内容。

# actionscript-3 - 避免全局状态

> ID：621085
> 
> 赞同：2
> 
> 时间：2009-03-07T01:14:30.673
> 
> 标签：actionscript-3, singleton, global-variables

目前我正在编写一个应用程序。如果我想避免单例，我是否必须简单地传递周围所有内容的引用？

例如，

我有一个“主要”课程。
**类：主**
+----屏幕
+----相机
+----地形
+----车辆
+----物理世界

它包含我的相机、地形和车辆等类。现在，我在创建 Terrain 对象时遇到了问题。Terrain 想要访问 Main 类 Screen 对象，以便将其 Terrain Graphics 添加到屏幕上。它还想知道 Camera 对象何时绘制，以便知道绘制它的比例。它还想了解我的 PhysicsWorld 对象，以便将自己添加到物理引擎中。

我是否必须总是在构造函数之间来回拉动这些对象？我的意思是，当我创建一个地形对象时，我是否只需要传递我的屏幕对象、我的物理世界、相机等？

我有另一个随机场景，现在.. 在我的 Vehicle 类中，我需要在 Main 类上调用 Restart() 方法。这是否意味着我必须将 main 实例传递给 Vehicle？真的？？

不断地向我的课程传递 4-5 件东西感觉很麻烦，尤其是在我现在的场景中，我拥有的几乎每个游戏内对象都需要屏幕、物理、相机信息等。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T02:21:59.293

> 不断地向我的课程传递 4-5 件东西感觉很麻烦，尤其是在我现在的场景中，我拥有的几乎每个游戏内对象都需要屏幕、物理、相机信息等。那么要问的正确问题是“为什么我的所有班级都需要全部 5 个对象吗？” 为什么地球上的每个内部物体都需要上述任何东西？游戏中的对象需要一个位置以及处理其行为所需的任何东西。然后一个单独的渲染器可以，你知道，渲染，对象。这意味着只有渲染器需要相机信息和屏幕。

物理学可以走任何一条路。您可以有一个单独的物理实体来更新游戏对象，或者您可以将该物理对象传递给每个游戏对象。但是，即使您确实传递了它，我们也只剩下列出的三个对象之一。:)

这就是为什么最好避免使用全局变量和单例。它们掩盖了您的依赖关系，因此您的对象之间的依赖关系最终比您实际需要的要多得多。然后几乎不可能*删除*全局变量。

但是，如果您坚持使用全局变量，请帮自己一个忙，至少避免使用单例。您不需要单例强制执行的附加约束。

> Terrain 想要访问 Main 类 Screen 对象，以便将其 Terrain Graphics 添加到屏幕上。它还想知道 Camera 对象何时绘制，以便知道绘制它的比例。它还想了解我的 PhysicsWorld 对象，以便将自己添加到物理引擎中。

地形对象需要知道一件事：地形是什么样的。其他人可以负责渲染它。当然，有人需要了解相机、屏幕和地形图形，这表明同一个对象可能能够执行涉及这些对象的其他任务（例如其他渲染任务）。为什么地形要关心它的绘制比例？它需要知道游戏中的比例，而不是相机空间中的比例。为什么其他人不能将地形添加到物理引擎中？主要功能甚至可以做到这一点。创建地形，创建物理引擎，使用物理引擎注册地形，开始游戏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T01:24:22.897

我不知道 ActionScript，但假设变量是通过引用传递的，那么您至少可以构建一个包含 Camera、Screen、Terrain、PhysicsWorld 的“Environment”类，并将其传递给实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T03:55:19.117

我有完全相同的问题（巧合的是，在 actionscript 3 中）。

我一直在为 Flash 开发 RTS，并且发现自己需要传递对每个新类的大量引用（例如，gameGrid、currentSelection、visibleUnits 等）。

我最终意识到我真正应该做的是让每个类都维护它自己的属性，而不是传递对这些类的引用（以及对象）。

但无论如何，现在我正在做的是在一个名为 RTSGlobals 的类中包含对常用对象（如主舞台、界面、引擎和显示区域）的引用的静态变量。我还在其中放置了诸如屏幕尺寸之类的常量。

我知道这并不能真正回答您的问题，但我认为有时值得忽略一些 OOP 良好实践以支持有效的解决方案。

如果有人有一个很好的实践解决方案，请告诉:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T01:20:38.690

我建议你看看 XNA 的示例项目（google it）。它们设计精良，可能会给您一些提示。

此外，由于您使用的是 AS3，因此您可以使用事件系统向其他实体发送消息。例如，不要将 Main 传递给 Vehicle 类，而是让 Main（或其他任何感兴趣的东西）成为 Vehicle 类的侦听器。然后，假设发生车祸，您想重新开始游戏，调度一个事件，例如 CAR_CRASHED。你的汽车的听众应该根据这个消息做一些事情。如果您想了解事件系统，请键入 EventDispatcher，突出显示它并在 Flash IDE 中按 F1。

# c# - 多页打印文档中的不同方向（如何）

> ID：621095
> 
> 赞同：5
> 
> 时间：2009-03-07T01:21:01.237
> 
> 标签：c#, .net, printing

我有一个`PrintDocument`有几页的。该文档中的一页必须是**横向**而不是纵向。

由于为文档上的每个页面触发了 PrintPage 事件......在该事件处理程序的一开始我将其设置`PrintPageEventArgs.PageSettings.Landscape`为 true。

这在那个页面上不起作用......但我可以看到 Landscape 设置为 true 并在 NEXT 页面中考虑在内。

我假设以某种方式......在某个页面触发事件后，您将无法更改页面方向。如果您认为它的逻辑更少……但是**在多页 PrintDocument 中触发 EVENT 之前，我如何设置该标志？**

注意：我事先不知道“下一页”是否真的需要横向。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T02:01:43.133

我不是 .NET 打印专家。但是使用反射器；看起来您可能想要处理 PrintDocument 上的[QueryPageSettings](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.querypagesettings.aspx)事件。它看起来像 PrintController 的私有 PrintLoop() 方法，将按此顺序为每个页面调用事件：

1.  查询页面设置
2.  首页
3.  打印页面
4.  结束页

希望这可以帮助。

# asp.net - ASP.NET - 重定向 301

> ID：621107
> 
> 赞同：16
> 
> 时间：2009-03-07T01:29:00.140
> 
> 标签：asp.net, iis, redirect

如何在 ASP DOT NET 中永久重定向？我想做一个从我网站上的一个页面到另一个页面的 301 重定向。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-07T01:46:30.503

```
protected void Page_PreInit(object sender, EventArgs e)
{
    Response.StatusCode = 301;
    Response.StatusDescription = "Moved Permanently";
    Response.RedirectLocation = "AnotherPage.aspx";
    HttpContext.Current.ApplicationInstance.CompleteRequest();
} 
```

在 4.0 中，有一个简单的[`HttpResponse.RedirectPermanent()`](http://msdn.microsoft.com/en-us/library/dd384856.aspx)方法可以为您完成上述所有操作：

```
Response.RedirectPermanent("AnotherPage.aspx"); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-20T08:26:31.040

ASP.NET 4.0 Beta 1 有一个用于进行 301 重定向的**Response.RedirectPermanent()**方法，例如

```
Response.RedirectPermanent("AnotherPage.aspx"); 
```

来自[ASP.NET 4.0 和 Visual Studio 2010 Web Development Beta 1 Overview](http://www.asp.net/learn/whitepapers/aspnet40/#_Toc223325465)白皮书：

> Web 应用程序中的常见做法是随时间移动页面和其他内容，这可能导致搜索引擎中的陈旧链接积累。在 ASP.NET 中，开发人员传统上通过使用 Response.Redirect 方法将请求转发到新 URL 来处理对旧 URL 的请求。但是，Redirect 方法会发出一个 HTTP 302 Found（临时重定向）响应，这会在用户尝试访问旧 URL 时导致额外的 HTTP 往返。
> 
> ASP.NET 4.0 添加了一个新的 RedirectPermanent 帮助器方法，可以轻松发出 HTTP 301 Moved Permanently 响应。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T01:33:44.700

如果您想*始终*从一个 URL 重定向到另一个 URL，您可以使用[IIS 重写模块](https://docs.microsoft.com/en-us/iis/extensions/url-rewrite-module/url-rewrite-module-configuration-reference)。

在您的 web.config 文件中，添加以下内容：

```
<system.webServer>
  <rule name="Redirect Source to Destination" stopProcessing="true">
    <match url="/source.aspx" />
    <action type="Redirect" url="/destination.aspx" redirectType="Permanent" />
  </rule>
</system.webServer> 
```

# javascript - 是否可以检测到您的 javascript 代码由于事件而正在执行？

> ID：621115
> 
> 赞同：2
> 
> 时间：2009-03-07T01:34:45.930
> 
> 标签：javascript, events

如果您不控制代码的调用，但想知道它是否由事件处理程序执行，这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T01:42:01.183

Javascript 具有[事件](http://www.w3schools.com/htmldom/dom_obj_event.asp)对象，可以帮助您识别事件的来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T01:40:18.223

您可以通过修改全局变量来发出信号。出于调试目的，有一个警报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T01:42:06.490

嗯...

实际上只有 3 个地方可以放置 javascript（据我所知）：1）直接在脚本标签内，2）在脚本标签内的函数内，以及 3）直接在链接或事件中（比如... onClick ="" 等）。

在 (1) 的情况下，它会在浏览器加载后立即执行，在这种情况下，它不会真正被事件调用。但是，在所有其他情况下，让代码执行的唯一方法是因为一个事件。

所以，在我看来，很容易知道你的代码是否因为某个事件而被执行......

现在，如果您想知道正在执行您的代码的特定事件处理程序，那就是另一回事了。:D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T01:48:22.993

如果您有办法查找堆栈，您也许可以这样做，但这不是一个很好的方法。本文展示了如何访问堆栈。

[任何浏览器中的 Javascript 堆栈跟踪](http://eriwen.com/javascript/js-stack-trace/)

# java - 如何修复此 Java 泛型通配符错误？

> ID：621117
> 
> 赞同：3
> 
> 时间：2009-03-07T01:35:15.040
> 
> 标签：java, generics, foreach, bounded-wildcard

在这个[问题](https://stackoverflow.com/questions/620934/wildcards-and-generics-error)中，TofuBeer 在创建泛型时遇到了问题`IterableEnumeration`。

答案来自 jcrossley3 指向这个链接[http://www.javaspecialists.eu/archive/Issue107.html](http://www.javaspecialists.eu/archive/Issue107.html)这几乎解决了这个问题。

还有一件事我不明白。正如埃里克森有效指出的那样，真正的问题是：

> *构造参数化类型时不能指定通配符*

但是删除声明中的通配符也不起作用：

```
final IterableEnumeration<ZipEntry> iteratable 
                  = new IterableEnumeration<ZipEntry>(zipFile.entries()); 
```

导致以下错误：

```
Main.java:19: cannot find symbol
symbol  : constructor IterableEnumeration(java.util.Enumeration<capture#469 of ? extends java.util.zip.ZipEntry>)
location: class IterableEnumeration<java.util.zip.ZipEntry>
        final IterableEnumeration<ZipEntry> iteratable = new IterableEnumeration<ZipEntry>(  zipFile.entries());
                                                         ^
1 error 
```

但是 JavaSpecialist 中的示例确实有效：

```
 IterableEnumeration<String> ie =
              new IterableEnumeration<String>(sv.elements()); 
```

我能发现的唯一区别是，在 JavaSpecialists 博客中，`Enumeration`来自 a`Vector`的签名是：

```
public Enumeration<E> elements() 
```

而失败的来自`ZipFile`其签名：

```
public Enumeration<? extends ZipEntry> entries() 
```

最后，所有这些都被 for-each 构造和链接中建议的静态 make 方法吸收

```
for(final ZipEntry entry : IterableEnumeration.make( zipFile.entries() ))  {
    if(!(entry.isDirectory())) {
        names.add(entry.getName());
    }
} 
```

但！！那个时事通讯的重点不是解决这个问题，而是避免需要指定一个泛型类型，只是因为语法看起来很丑！！

所以..我的问题是：

# 怎么了？

`IterableEnumeration`当参数是`Enumeration`其类型时，为什么不创建工作实例`<? extends SomeClass>`？为什么 make for-each 结构会吞下问题？！！！

为什么会这样：

```
for(final ZipEntry entry : IterableEnumeration.make( zipFile.entries() ))  { 
```

但这不起作用？

```
final IterableEnumeration<ZipEntry> iteratable
                     = IterableEnumeration.make( zipFile.entries() ); 
```

下面是 TofuBeer 原始代码的（略微）修改版本：

```
import java.util.Enumeration;
import java.util.HashSet;
import java.util.Iterator;
import java.util.Set;
import java.util.zip.ZipEntry;
import java.util.zip.ZipFile;
import java.util.Vector;

public class Main {
    private ZipFile zipFile;

    public Set<String> entries() {

        final Vector<ZipEntry>    vector = new Vector<ZipEntry>();
        // why this works.
        //final IterableEnumeration<ZipEntry> iteratable = new IterableEnumeration<ZipEntry>( vector.elements() );

        // but this do not.
        //final IterableEnumeration<ZipEntry> iteratable = new IterableEnumeration<ZipEntry>( zipFile.entries() );

        // nor this 
        final IterableEnumeration<ZipEntry> iteratable = IterableEnumeration.make( zipFile.entries() );

        // And what's with the for-each that doesn't care about the type?    
        final Set<String>   names = new HashSet<String>();

        for(final ZipEntry entry : IterableEnumeration.make( zipFile.entries() ))  {
            if(!(entry.isDirectory())) {
                names.add(entry.getName());
            }
        }

        return (names);
    }
}

class IterableEnumeration<T> implements Iterable<T> {
    private final Enumeration<T> enumeration;

    public IterableEnumeration(final Enumeration<T> e) {
        enumeration = e;
    }

    public Iterator<T> iterator() {
        return new Iterator<T>() { 
             public boolean hasNext() {
                return (enumeration.hasMoreElements());
            }

            public T next() {
                return (enumeration.nextElement());
            }

            public void remove() {
                throw new UnsupportedOperationException("Cannot remove via an Enumeration");
            }
        };
    }
    // As suggested by http://www.javaspecialists.eu/archive/Issue107.html
    // but doesn't help with: final IterableEnumeration<ZipEntry> iteratable = IterableEnumeration.make( zipFile.entries() );
    public static <T> Iterable<T> make(Enumeration<T> en) {
        return new IterableEnumeration<T>(en);
    }
} 
```

我想明白！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T02:47:14.163

我不确定 foreach 循环发生了什么，但您需要将通配符添加到您的 IterableEnumeration 声明中以接受从 ZipFile.entries() 返回的未指定类型。

代替

```
 private final Enumeration<T> enumeration;

    public IterableEnumeration(final Enumeration<T> e) {
        enumeration = e;
    }

    public static <T> Iterable<T> make(Enumeration<T> en) {
        return new IterableEnumeration<T>(en);
    } 
```

和

```
 private final Enumeration<? extends T> enumeration;

    public IterableEnumeration(final Enumeration<? extends T> e) {
        enumeration = e;
    }

    public static <T> Iterable<T> make(Enumeration<? extends T> en) {
        return new IterableEnumeration<T>(en);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-04T18:50:12.080

这里的根本问题是，当[ZipFile](http://java.sun.com/javase/6/docs/api/java/util/zip/ZipFile.html)更改为支持泛型时，维护者选择了`entries()`方法的返回类型`Enumeration<? extends ZipEntry>`（大概是为了让子类中的方法 `JarFile`可以返回`Enumeration<JarEntry>`）。这会导致您看到的问题。

因为`Enumeration<T>`是协变使用的（因为它总是 - 它只返回值），你应该总是让方法参数取`Enumeration<? extends T>`.

# python - Django 表单新手问题

> ID：621121
> 
> 赞同：4
> 
> 时间：2009-03-07T01:40:11.500
> 
> 标签：python, django, forms

好吧，我对 Django 表单一无所知，因为文档似乎并没有完全涵盖我正在寻找的内容。至少，一旦你通过了最基本的形式，它似乎会戛然而止。作为答案，我非常愿意提供指向*好的*文档的链接，或者指向涵盖该主题的好书的链接。基本上，这就是它的分解方式，我有 3 个模型（测验、问题、答案）。每个测验我有 20 个问题，有 4 个可能的答案（多选）。数字可能会有所不同，但你明白了。

我需要为这些项目创建一个表单，就像您在多项选择测验中所期望的那样。但是，当我在模板中手动创建表单时，而不是使用 django.forms，我得到以下信息：

基数为 10 的 int() 的无效文字：'test'

所以我试图弄乱 django.forms，但我想我只是没有掌握如何从中构建适当表单的想法。任何帮助将不胜感激，谢谢。

对于这里的价值是模型：

```
class Quiz(models.Model):
    label = models.CharField(blank=True, max_length=400)
    slug = models.SlugField()

    def __unicode__(self):
        return self.label

class Question(models.Model):
    label = models.CharField(blank=True, max_length=400)
    quiz = models.ForeignKey(Quiz)

    def __unicode__(self):
        return self.label

class Answer(models.Model):
    label = models.CharField(blank=True, max_length=400)
    question = models.ForeignKey(Question)
    correct = models.BooleanField()

    def __unicode__(self):
        return self.label 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T19:13:19.537

是的，我必须同意这里确实缺少文档和示例。对于您所描述的案例，没有开箱即用的解决方案，因为它深入三层：测验->问题->答案。

Django 有[模型内联表单集](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#inline-formsets)，可以解决两层深度的问题。要生成所需的表单，您需要做的是：

1.  加载一个测验表格（只是模型中的一个标签文本框）
2.  加载一个问题表单集： QuestionFormSet(queryset=Question.objects.filter(quiz=quiz))
3.  对于每个问题，加载一个答案表单集的方式与加载问题表单集的方式大致相同
4.  确保以正确的顺序保存所有内容：测验->问题->答案，因为每个较低级别都需要其上方项目的外键

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T03:33:42.117

首先，为给定的模型创建一个 ModelForm。在此示例中，我正在为 Quiz 执行此操作，但您可以为其他模型冲洗并重复此操作。对于傻笑，我将“标签”设置为带有预设选项的选择框：

```
from django.models import BaseModel
from django import forms
from django.forms import ModelForm

CHOICES_LABEL = (
    ('label1', 'Label One'),
    ('label2', 'Label Two')

)

class Quiz(models.Model):
    label = models.CharField(blank=True, max_length=400)
    slug = models.SlugField()

    def __unicode__(self):
        return self.label

class QuizForm(ModelForm):
    # Change the 'label' widget to a select box.
    label = forms.CharField(widget=forms.Select(choices=CHOICES_LABEL))

    class Meta:
       # This tells django to get attributes from the Quiz model
       model=Quiz 
```

接下来，在您的 views.py 中，您可能会有这样的内容：

```
from django.shortcuts import render_to_response
from forms import *
import my_quiz_model

def displayQuizForm(request, *args, **kwargs):
   if request.method == 'GET':
       # Create an empty Quiz object. 
       # Alternately you can run a query to edit an existing object.

       quiz = Quiz()
       form = QuizForm(instance=Quiz)
       # Render the template and pass the form object along to it.
       return render_to_response('form_template.html',{'form': form})

   elif request.method == 'POST' and request.POST.get('action') == 'Save':
       form = Quiz(request.POST, instance=account)
       form.save()
       return HttpResponseRedirect("http://example.com/myapp/confirmsave") 
```

最后，您的模板将如下所示：

```
<html>
  <title>My Quiz Form</title>
  <body>

  <form id="form" method="post" action=".">

   <ul>
    {{ form.as_ul }}
   </ul>

   <input type="submit" name="action" value="Save">
   <input type="submit" name="action" value="Cancel">
  </form>

  </body>
</html> 
```

# java - Java中的换行符插入

> ID：621132
> 
> 赞同：1
> 
> 时间：2009-03-07T01:48:40.140
> 
> 标签：java, newline, chars

如果我使用“标签”而不是 ，如何在 Java 小程序程序中插入换行符`System.out.println()`？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T01:51:21.803

J标签？

如果您使用的是 JLabel，则可以在其中使用基本 HTML

尝试以下操作：

```
<html>Text<br>more text</html> 
```

看到这个[其他答案](https://stackoverflow.com/questions/461112/panel-with-line-wrapping-and-line-breaking-in-java-swing/462836#462836)

并赞成它;）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T12:00:36.040

我不确定您要的是什么，但您可以使用它`System.getProperty("line.separator");`来获取操作系统的行分隔符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T01:49:43.333

将 a`\n`放入字符串中。

像这样：

```
String twoLineString = "first line\nsecond line"; 
```

# c# - WCF 中的通用集合支持

> ID：621139
> 
> 赞同：5
> 
> 时间：2009-03-07T01:56:07.843
> 
> 标签：c#, wcf, web-services

WCF 是否支持泛型集合？我查看了代理对象，它似乎从通用列表集合生成对象数组。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T01:59:05.683

WCF 确实支持泛型集合。通过网络它作为对象数组传输（这是发送列表/数组/等的标准方式），但是 WCF 为您执行序列化/反序列化，因此就您的客户端/服务器而言，集合是通用的。

编辑：当然，需要注意的是集合必须是可序列化的。另外，如果您提出问题，请查看[此](http://just2thepoint.blogspot.com/2008/05/wcf-collectiondatacontract-and.html)内容，因为您的自定义集合在客户端被视为 T[] 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T03:31:19.860

添加/编辑服务客户端时，如果单击“高级...”按钮，您将看到一个选项，允许您选择服务客户端将创建的集合类型。默认值为 System.Array，但您可以将其更改为 System.Collections.Generic.List（以及许多其他选择）。

[http://msdn.microsoft.com/en-us/library/bb514724.aspx](http://msdn.microsoft.com/en-us/library/bb514724.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T02:39:16.350

只要您在两端都使用 WCF，就可以使用泛型。如果你还没有；您必须仔细考虑非 wcf 客户端可能需要使用您的服务的场景。

# workflow - 对于一个大型项目，在编码之前应该做哪些规划，应该如何进行？

> ID：621140
> 
> 赞同：6
> 
> 时间：2009-03-07T01:57:14.423
> 
> 标签：workflow, bduf

在创建一个想法之前，你的“规划”方法是什么？

假设我想承担一个大项目，例如像 Facebook 或 MySpace 这样的网站规模。在开始实际工作之前，我应该采取哪些规划/设计步骤？

例如，我应该逐页映射所有内容（它们的功能、数据等）吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T03:05:45.040

对于一个大型项目，首先考虑对您的网站进行单行描述（尽量不要在此处使用任何流行语）。接下来想想三个设计准则（你的设计永远不应该与之冲突的规则）。然后绘制一些视图并考虑一些用户案例（1 天），然后在代码中工作 2 周（这将是一个一次性原型，所以只要你尽快忘记错误和细节，不要担心代码味道或设计模式，尽可能多地制作），然后重新评估上述所有步骤并扔掉你两周的原型，并以认真的方式开始你的项目，应用扎实的工程和设计。一个月后，评估您的（团队）道德并获得反馈。如果一切似乎都顺利，继续，你还有很长的路要走，否则就放弃，做事后分析，重新开始新的目标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T03:08:15.283

我总是从用户界面设计开始。我弄清楚用户应该能够做什么以及我会给他们什么控制来做到这一点。一旦我以我喜欢的方式进行布局，然后我就从代码“接线”开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T02:17:50.943

*   列出该站点具有的所有功能。

*   列出一个不错的功能列表。

*   列出网站的弱点。

*   对该列表进行排序并优先考虑将首先构建的项目。

*   确定什么可以做，什么不能做。

*   与您的客户会面并展示这些结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T03:34:26.577

通常我会做一个[**思维导**](http://www.buzanworld.com/Mind_Maps.htm)图

1.  我试图解决的问题，
2.  转化为确切的要求，
3.  然后将其映射到用户工作流程。

思维导图软件的交叉链接功能使其变得非常容易。由于思维导图是“一种自由形式”，我最终会专注于“任务”而不是“表示”（例如，我应该使用哪种类型的 UML 图来表示）？

一旦初步想法清晰，我就可以使用 UML 处理项目计划、规范/设计文档以获取更多低级细节。这种方法通常对我很有效。

要查看它是否适合您，您可以使用[FreeMind](http://freemind.sourceforge.net/)（开源思维导图软件，很好但目前功能有限）。然后您可以尝试[Mindmanager](http://en.wikipedia.org/wiki/MindManager)或[iMindmap](http://www.imindmap.com/)进行思维导图。两者都与其他 Office 产品很好地集成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-08T07:51:44.983

您可以从一些非常简单的东西开始，然后一次添加一点功能。您可能会达到想要重新开始的地步，但您所做的基础工作将是有益的。或者您可以尝试一次完成整个事情，在这种情况下，您将需要其他回复中已经给出的建议。

另一个想法：指定您*不*打算包含的那些功能，以及其他限制。这些被称为**约束**，与计划的其余部分一样重要，因为它为您提供了界限，因此您知道何时完成计划！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-07T14:26:51.330

通常我从抓起我的草稿开始，然后开始写下我想要的功能，这应该非常详细。并且每件事情都拼凑在一起可能会很混乱，如果是这样，当你完成时，在纸上制作你的想法的“官方版本”（在我看来，真正的笔和纸最适合这个）。

然后我开始制作一些页面的外观，它必须包含哪些信息并将其转换为全局数据库设计。然后将全局设计工作到更高级的水平，所有页面都聚集在一起，表格和东西之间的关系。

之后，我在代码框架上构建最重要的页面（我总是使用框架，如果你不忘记框架部分），并且“最重要的页面”是指例如一个博客成为帖子。之后构建不那么重要的页面，以防博客可能是帖子的存档。

如果你已经完成了，请将代码与设计放在一起，或者如果你没有将代码与 HTML/CSS/JS 分开，则在编码时这样做。

哦，是的，不要一路扩展你的第一个想法。只需将其写下来，然后再实施。因此，如果再次使用博客，您认为您希望将 Youtube 标签包含在您的 BB 代码中，请将其写下来。稍后添加，在您发布初始站点之前。

这就是我的工作流程，至少是一个基本的基本描述。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-07T17:19:14.940

从“纸质原型”开始，即用铅笔非常粗略地画出每一页。这可以让您从用户的角度开始，我认为这是一个好主意。

然后，您可以将草图用于第一次走廊可用性测试，然后作为“线框”的基础，您可以让网页设计师从中工作。

如果您曾经浏览过整个站点，您可能对后端应该能够做什么有一个很好的了解。您现在可以使用您的页面草图并编译用户可以通过单击事物触发的操作列表。这是设计前端可以调用的服务端API的原材料。

使用需要服务的调用，您可以设计后端：哪些功能组很好，需要获取哪些数据，页面调用之间需要存储什么（== 会话变量）等。

在这个过程中，我通过推迟技术决策（框架、协议等）甚至类结构等方面做得很好，直到我把整个事情都经历过一遍，“什么事情应该做什么，其他事情做什么” "（我想有一个更好的术语）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-07T17:28:32.143

我想我会从一个接近您需要的开源 SNS 解决方案开始，然后弄清楚如何添加特定用途的插件、模块和主题来实现您的目的。那里有很多他们。从头开始构建将需要更多的努力和计划。大多数 SNS 功能不值得重新发明。专注于使您的网站与众不同并朝此方向发展的因素。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-07T17:36:19.020

在设计软件方面，我是一个相当直观的人，所以我首先在白板和纸上勾勒出数据流、类层次结构、UI 和流程图。

屠夫纸和彩色笔使用起来特别有趣，因为它有 3 英尺宽，卷有 100 英尺。当您的设计令人满意或足够完整时，请将其从卷筒上撕下来并钉在墙上。根据需要更新。

该技术适用于一些大型重构以及新项目。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-07T02:11:51.597

如果你和这个人在同一家公司工作，首先要把所有的事情都写下来，这样当不可避免的事情发生时，你就不会成为失败的人……

# javascript - jQuery UI 滑块 - 不能滑动到 0

> ID：621147
> 
> 赞同：14
> 
> 时间：2009-03-07T02:01:06.927
> 
> 标签：javascript, jquery, jquery-ui, slider

jQuery 1.3.2 / jQueryUI 1.7 /[滑块](http://jqueryui.com/demos/slider/)

```
$("#slider").slider({
    range: "min",
    min: 0,
    max: 40,
    value: 0,
    slide: function(event, ui) {
        CalculateOrder(event, ui);
    }
}); 
```

它开始时很好，但是在我移动滑块后，我无法将它恢复到 0，当我将它一直向左滑动时，ui.Value 为 1。

我试过设置

```
min:-1 
```

当我将 ui.Value 滑动到 -1 时，这会将 ui.Value 设置为 -1，但是当我处于 0 时，ui.Value 仍然是 1。

有任何想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-07T02:44:32.690

您想要的是在滑块停止时而不是在滑动期间获取值。根据我的经验，幻灯片事件将为您提供滑块的先前位置。Stop 将为您提供用户将其移动到的滑块的值。

```
$("#slider").slider({
    range: 'min',
    min: 0,
    max: 40,
    value: 1,
    step: 10,
    slide : function(event, ui){
        console.log("previous value:"+ $(this).slider('option', 'value'));
    },
    stop: function(event, ui){
        console.log("Current value:"+ $(this).slider('option', 'value'));
    }
}); 
```

# c# - 应该在没有终结器的对象上调用 GC.SuppressFinalize 吗？

> ID：621152
> 
> 赞同：13
> 
> 时间：2009-03-07T02:03:00.980
> 
> 标签：c#, fxcop, finalizer

出于某种原因[，FXCop 似乎认为](http://msdn.microsoft.com/en-au/library/ms182269.aspx#)我应该在 Dispose 中调用 GC.SuppressFinalize，无论我是否有终结器。

我错过了什么吗？是否有理由对未定义终结器的对象调用 GC.SuppressFinalize？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-07T11:04:51.707

无需调用`GC.SuppressFinalize(this)`Dispose，除非：

*   您是实现用于覆盖的虚拟 Dispose 方法的基类（同样，即使在这里也可能不是您的责任，但在这种情况下您可能希望这样做）
*   你自己有一个终结器。从技术上讲，.NET 中的每个类都有一个终结器，但如果唯一存在的终结器是`Object`.

我想说，假设您没有上述任何情况，您可以放心地忽略该消息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-07T02:15:21.573

IL 中总是有一个终结器 - System.Object.Finalize() 存在于每个类中，所以如果你创建一个自定义类，它有一个你想要抑制的终结器。话虽如此，并非所有对象都放在终结队列中，因此如果您实现自己的终结器，您只需要在技术上抑制终结。

如果您正在实现包装非托管资源，您应该包含一个终结器，并且您应该阻止它运行，因为理论上您在调用`IDisposable`时已经在进行清理。`Dispose`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-07T10:57:56.403

看起来 FxCop 只是检查 Dispose() 并且不检查析构函数的存在。

忽略它应该是安全的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T02:13:56.443

所有对象都有一个终结器方法，即使您没有使用 ac# 析构函数实现一个（实际上并不能保证被 GC 调用）。如果您已经实现了 IDisposable，那么抑制调用只是一个好习惯，因为这意味着您已经决定显式地执行终结。

[devx 文章](http://www.devx.com/dotnet/Article/33167/0/page/2)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-07T02:16:40.370

如果没有定义终结器，我认为没有必要调用 SuppressFinalize() 。如果你想防御，那么最好有一个终结器和 Dispose()，这样你就不需要依赖客户端总是调用 Dispose()。然后，当他们忘记时，您就不会泄漏资源。

# c# - System.Data.DbType 与 System.Data.SqlType

> ID：621155
> 
> 赞同：0
> 
> 时间：2009-03-07T02:06:33.933
> 
> 标签：c#, data-access-layer

正在使用企业图书馆数据访问应用程序块...使用`System.Data.DbType`Vs 对性能有影响`System.Data.SqlType`吗？

而且，想知道语句对性能的影响：

```
DatabaseFactory.CreateDatabase("MyDB") 
```

VS

```
new SqlDatabase(myConnectionString); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T02:39:17.630

这里的影响不是性能之一，而是更明确而不是灵活性。DBType 和 DatabaseFactory 方法更灵活，允许您翻转正在使用的数据库类型。您可能会在另一个方向看到一点性能，但不足以根据性能做出决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T02:30:46.433

任何性能差异都可以忽略不计（尤其是与数据库访问相比）。

# python - 从 python 访问 MySQL 数据库

> ID：621156
> 
> 赞同：0
> 
> 时间：2009-03-07T02:06:35.807
> 
> 标签：python, mysql, database

在过去的几个小时里，我一直在尝试找到一种在 python 中访问 mysql 数据库的工作方法。我唯一设法编译和安装的是`pyodbc`ppc leopard 没有必要的驱动程序。

我已经知道[了](https://stackoverflow.com/questions/372885/how-to-connect-to-a-mysql-database-from-python)。

更新：
我已经`setuptools`安装了，但现在 MySQL-python 无法构建。

更新：现在我已经`sqlalchemy`开始安装了，但是当它被命令行调用时它会显示出来，但在我的 cgi 脚本中使用它时它不会导入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T04:06:18.560

试试 SQL 炼金术。

太棒了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T02:33:31.013

安装芬克。它包括 MySQLdb 包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T14:30:53.633

> 更新：现在我已经安装了 sqlalchemy，但是当它被命令行调用时它会显示出来，但在我的 cgi 脚本中使用时它不会导入。

您能否验证从您的 CGI 脚本调用的 Python 是否与您以交互方式运行 Python 时获得的相同？检查`which python`并将其与您的网络服务器 CGI 设置进行比较。这是我能想到的唯一会导致这种情况的事情 - 将它安装在一个 Python 中，而不是另一个。

你在什么操作系统上？如果您使用的是 Ubuntu 之类的东西，`sudo apt-get install python-mysqldb`那么这比尝试自己构建要可靠得多。

此外，除非我弄错了，否则如果您没有安装 DB-API2 模块（如 python-mysqldb），SQLAlchemy 实际上不会帮助您建立连接 - SQLAlchemy 位于更高级别，使用 DB- API2 连接并使对它的访问更加 Pythonic。

# c++ - 如何重新启动套接字程序？

> ID：621157
> 
> 赞同：1
> 
> 时间：2009-03-07T02:07:24.540
> 
> 标签：c++, sockets

我需要我的服务器与服务器保持连接。有谁知道如何做到这一点？或者发布链接教程什么的？

它还说当它重新启动时“无法接受客户端”，那么我将如何清除所有内容并让它接受它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T02:11:22.923

**服务器代码：**

对于您的服务器端代码，请执行一个循环来包装接受调用。为创建的接受的套接字创建一个新线程，以便立即调用下一个接受。

在服务器启动时，您可能还想使用 SO_REUSEADDR 标志。这样，如果您发生崩溃，甚至程序快速重启，那么您的服务器将能够再次使用相同的端口而不会出现问题。

**客户端代码：**

对于您的客户端代码，您只需检查套接字错误，如果发生这种情况，只需建立一个新连接。

**其他资源：**

*   [Beej 的网络编程指南](http://beej.us/guide/bgnet/)是学习套接字编程的重要资源。
*   Frostbytes.com 也有一个[很棒的套接字编程教程](http://www.frostbytes.com/~jimf/papers/sockets/sockets.html)。
*   如果您想要更深入的内容，请查看W. Richard Stevens 的[Unix Network Programming](http://www.kohala.com/start/unpv12e.html) [3rd Edition](http://www.unpbook.com/)。

**其他选项：**

除了普通的 bsd 样式套接字，您还可以尝试使用[boost asio](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)来简化套接字编程。您可以查看他们的[示例页面](http://www.boost.org/doc/libs/1%5F37%5F0/doc/html/boost_asio/examples.html)。

# vector - 如何访问向量中的变量 *对象？

> ID：621159
> 
> 赞同：2
> 
> 时间：2009-03-07T02:09:26.080
> 
> 标签：vector

如何从向量中获取变量？

我不能使用二进制插入运算符或等号运算符。

早些时候，我声明了 a`vector<someStruct> *vObj`并分配了它，然后返回了`vObj` 并在这个函数中调用了它：

```
vector<sameStruct> firstFunc();

for (unsigned int x = 0; x < v->size(); x++)
{
   v[x];
} 
```

当我调试它时，`v[x]`现在有了原始向量的全部内容，就像以前没有下标/索引一样。

但我认为我没有做任何事情来取得进展。

我的向量中只有大约 4 个变量；当我调试它时，它有我需要的信息，但我无法得到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T02:30:13.270

正如它所写的那样，v 是一个指向结构向量的指针。

当您直接索引到 v 时，您所做的只是指针算术。v[x] 是位置 x 的结构向量（假设 v 是一个数组，如果它只是指针末尾的单个对象，那么 v[x] for x>0 就是垃圾）。这是因为它不是将 [x] 应用于 v 指向的向量，而是应用于指针 v 本身。

您需要取消引用指针，然后使用以下方法索引到向量中：

```
(*v)[x]; 
```

此时，您在向量的第 x 个位置引用了对象，以获取其成员函数/变量使用：

```
(*v)[x].variable; 
```

或者

```
(*v)[x].memberfunction(parameters); 
```

如果您不想取消引用向量然后访问其中的元素，您可以尝试以下操作：

```
v->at(x);
v->at(x).variable;
v->at(x).memberfunction; 
```

这样，您访问对象的成员函数的方式与调用时完全相同：

```
v->size(); 
```

我希望这个对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T02:24:26.433

要使用 [] 运算符访问元素，您必须在对象上执行此操作，而不是指向对象的指针。

尝试;

```
(*vec)[x]; 
```

例如

```
for (int i = 0; i < vec->size(); i++)
{
  printf("Value at %d is %d\n", i, (*vec)[i]);
} 
```

请注意，在指针上调用函数时，您通常使用**->**运算符而不是**.** 运算符，但你可以很容易地做到 (*vec).some_func(); 反而。

[]、--、++ 等运算符既可以作用于对象，也可以作用于指针。对于对象，它们充当函数调用，但在指针上，它们充当对地址的数学运算。

例如;

```
pointer[nth];
*(pointer + nth); 
```

具有完全相同的效果 - 它们从指针的开头返回第 n 个对象。（注意第二个例子中 * 的位置，它是在应用偏移**后调用的。**

另外两个提示；

您还可以通过将向量作为引用而不是指针传递来避免像这样取消引用。它并不总是一个合适的选择，但它确实会带来更简洁的代码。

```
void my_func(std::vector<int>& vector)
{
  // vector can then be used as a regular variable
} 
```

如果您要经常将特定类型的向量传递给函数，那么您可以使用 typedef 来提高清晰度和节省打字时间。

```
typedef std::vector<int> IntVector;

void my_func(IntVector& vector)
{
} 
```

# ruby - 如何在 Ruby 中动态调用访问器方法

> ID：621176
> 
> 赞同：26
> 
> 时间：2009-03-07T02:24:56.417
> 
> 标签：ruby

不管它是否是好的做法，我如何在 Ruby 中动态调用访问器方法？

这是一个示例类：

```
class Test_Class
  attr_accessor :a, :b
end 
```

我可以使用 Object.send 方法来读取变量...

```
instance.a = "value"
puts( instance.send( "a" ) )
# => value 
```

但我很难写信给它。这些抛出“错误数量的参数（1 代表 0）（ArgumentError）”

```
instance.send("a", "value") 
```

和

```
instance.method("a").call("value") 
```

请帮助我 StackOverflow！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-07T02:34:06.177

我不是红宝石专家，但我认为你可以这样做：

```
instance.send("a=", "value") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-07T07:21:18.513

您还可以使用`instance_variable_*`函数直接访问对象的实例变量：

```
instance = Test_Class.new                 # => #<Test_Class:0x12b3b84>

# instance variables are lazily created after first use of setter,
# so for now instance variables list is empty:
instance.instance_variables                # => []

instance.instance_variable_set(:@a, 123)   # => 123
instance.a                                 # => 123
instance.instance_variables                # => ["@a"]
instance.instance_variable_get("@a")       # => 123 
```

# iphone - AVAudioPlayer - 按顺序播放多个音频文件

> ID：621182
> 
> 赞同：6
> 
> 时间：2009-03-07T02:29:56.733
> 
> 标签：iphone, ios, audio, avaudioplayer

我想使用 AVAudioPlayer 按顺序（一个接一个）播放多个 MP3 文件。我试了一下，播放第一首MP3后就停止了。但是，如果我进入调试器，它工作正常.. 有什么想法吗？我在某处读到 AVAudioPlayer 在后台播放音频..如何防止它这样做？瓦斯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T11:39:52.037

我认为`AVQueuePlayer`（的子类`AVPlayer`）自 iOS 4.1 起就完成了这项工作（播放一系列项目）：http: [//developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVQueuePlayer_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVQueuePlayer_Class/Reference/Reference.html)

但是我自己没有尝试过，但肯定会尝试一下。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-02T15:51:14.517

每个声音使用一个 AVAudioPlayer。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T20:21:05.950

Well, your code example didn't work out of the box for me. Soooo, I figured I'd respond with a fixed version:

Looper.h:

```
#import <Foundation/Foundation.h>
#import <AVFoundation/AVFoundation.h>

@interface Looper : NSObject <AVAudioPlayerDelegate> {
    AVAudioPlayer* player;
    NSArray* fileNameQueue;
    int index;
}

@property (nonatomic, retain) AVAudioPlayer* player;
@property (nonatomic, retain) NSArray* fileNameQueue;

- (id)initWithFileNameQueue:(NSArray*)queue;
- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag;
- (void)play:(int)i;
- (void)stop;

@end 
```

Looper.m:

```
#import "Looper.h"
@implementation Looper
@synthesize player, fileNameQueue;

- (id)initWithFileNameQueue:(NSArray*)queue {
    if ((self = [super init])) {
        self.fileNameQueue = queue;
        index = 0;
        [self play:index];
    }
    return self;
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag {
    if (index < fileNameQueue.count) {
        [self play:index];
    } else {
        //reached end of queue
    }
}

- (void)play:(int)i {
    self.player = [[AVAudioPlayer alloc] initWithContentsOfURL:[[NSURL alloc] initFileURLWithPath:[[NSBundle mainBundle] pathForResource:[fileNameQueue objectAtIndex:i] ofType:nil]] error:nil];
    [player release];
    player.delegate = self;
    [player prepareToPlay];
    [player play];    
    index++;
}

- (void)stop {
    if (self.player.playing) [player stop];
}

- (void)dealloc {
    self.fileNameQueue = nil;
    self.player = nil;        
    [super dealloc];
}

@end 
```

And here's how I would call it:

```
 Looper * looper = [[Looper alloc] initWithFileNameQueue:[NSArray arrayWithObjects: audioFile, audioFile2, nil ]]; 
```

I only have slightly over a year of experience with iPhone/iPad development using Objective-C so feel free to respond with additional criticism.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-20T05:58:22.710

我已经实现了一个类来处理这个问题。

要使用，只需执行以下操作：

```
[looper playAudioFiles:[NSArray arrayWithObjects:
    @"add.mp3",
    [NSString stringWithFormat:@"%d.mp3", numeral1.tag],
    @"and.mp3",
    [NSString stringWithFormat:@"%d.mp3", numeral2.tag],
    nil
]]; 
```

Looper.m

```
#import "Looper.h"
@implementation Looper
@synthesize player, fileNameQueue;

- (id)initWithFileNameQueue:(NSArray*)queue {
    if ((self = [super init])) {
        self.fileNameQueue = queue;
        index = 0;
        [self play:index];
    }
    return self;
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag {
    if (index < fileNameQueue.count) {
        [self play:index];
    } else {
        //reached end of queue
    }
}

- (void)play:(int)i {
    self.player = [[AVAudioPlayer alloc] initWithContentsOfURL:[[NSURL alloc] initFileURLWithPath:[[NSBundle mainBundle] pathForResource:[fileNameQueue objectAtIndex:i] ofType:nil]] error:nil];
    [player release];
    player.delegate = self;
    [player prepareToPlay];
    [player play];    
    index++;
}

- (void)stop {
    if (self.player.playing) [player stop];
}

- (void)dealloc {
    self.fileNameQueue = nil;
    self.player = nil;        
    [super dealloc];
}

@end 
```

Looper.h

```
#import <Foundation/Foundation.h>

@interface Looper : NSObject <AVAudioPlayerDelegate> {
    AVAudioPlayer* player;
    NSArray* fileNameQueue;
    int index;
}

@property (nonatomic, retain) AVAudioPlayer* player;
@property (nonatomic, retain) NSArray* fileNameQueue;

- (id)initWithFileNameQueue:(NSArray*)queue;
- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag;
- (void)play:(int)i;
- (void)stop;

@end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-29T09:35:36.690

提前初始化、准备项目和排队是个好主意，例如在 viewDidLoad 方法上。

如果你正在使用 Swift，

```
 override func viewDidLoad() {
        super.viewDidLoad()
        let item0 = AVPlayerItem.init(URL: NSBundle.mainBundle().URLForResource("url", withExtension: "wav")!)

        let item1 = AVPlayerItem.init(URL: NSBundle.mainBundle().URLForResource("dog", withExtension: "aifc")!)
        let item2 = AVPlayerItem.init(URL: NSBundle.mainBundle().URLForResource("GreatJob", withExtension: "wav")!)

        let itemsToPlay:[AVPlayerItem] = [item0, item1, item2] 
        queuePlayer = AVQueuePlayer.init(items: itemsToPlay)
    } 
```

然后当事件发生时，

```
 queuePlayer.play() 
```

请注意，如果您使用队列，则声音之间可能仍然存在一些间隙。

[您可以在 AVQueuePlayer 完成最后一个播放项时如何做某事](https://stackoverflow.com/questions/12187686/how-to-do-something-when-avqueueplayer-finishes-the-last-playeritem)的问题中找到 Objective-C 版本

希望能帮助到你。

# javascript - 寻找有关 JavaScript 库流行度的统计数据

> ID：621187
> 
> 赞同：4
> 
> 时间：2009-03-07T02:32:19.253
> 
> 标签：javascript

有谁知道是否有一个网站可以跟踪大型/各种 JavaScript 库的流行程度？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-07T03:58:25.380

点击页面顶部的“标签”链接。

*   jQuery：1970
*   原型：135
*   道场：71
*   Mootools: 39

这些数字符合我对这个主题的直觉。JQuery 占主导地位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T02:39:19.457

这是一个[不科学但仍然很有趣的比较](http://www.google.com.au/trends?q=jquery%2C+dojo%2C+mootools%2C+yui)。这很有趣，因为它显示了 Dojo 的顶峰和 jQuery 的真正崛起，这表明 jQuery 已经吃掉了 Dojo 的市场份额。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T02:49:33.783

我认为现在 jQuery 与 Visual Studio 一起发布，你会看到它的受欢迎程度大幅提升。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-30T00:49:00.803

使用 Google Trends 的想法来自于 John Resig 于2007 年在[Simon Willinson 的关于该主题的博客文章](http://simonwillison.net/2007/May/16/libraries/)中发表的评论。我倾向于同意他的观点：[领先图书馆的 Google Trends](http://www.google.com/trends?q=jquery%2C+%28ext-js%7Cext+js%29%2C+%28yahoo+ui%7Cyui%29%2C+dojo+%28toolkit%7Cjavascript%7Clibrary%7Cframework%29%2C+prototype+%28toolkit%7Cjavascript%7Clibrary%7Cframework%29&ctab=0&geo=all&date=all&sort=0)是一个很好的启发式方法。John 的原始搜索省略了 Ext（以及 Yahoo UI 的首字母缩略词“yui”）；我的版本只是一个更新。

# c# - 连接到服务器上的 WCF 服务时出现问题

> ID：621189
> 
> 赞同：1
> 
> 时间：2009-03-07T02:32:52.233
> 
> 标签：c#, .net, wcf, security, impersonation

我已经在自己的工作组中的服务器上设置了 WCF 服务。我试图从位于公司域的客户端建立一个 TCP/IP 连接。当我尝试打开连接时，我收到一条 SecurityNegotiationException 消息：

> “身份验证期间未满足远程端安全要求。请尝试提高 ProtectionLevel 和/或 ImpersonationLevel。” 内部异常显示：“网络登录失败”

在与一些同事讨论了这些问题并进行了一些谷歌研究后，我得出的结论是，问题在于客户端试图使用我的公司网络登录名和密码登录到服务器。由于服务器不是公司网络的一部分，它不知道我的公司身份，然后拒绝登录/连接尝试。这种分析是否正确，我不知道。

谷歌结果似乎表明，也许解决方案是我需要模拟服务器计算机上存在的用户帐户。--我还偶然发现了这篇演示用户模拟的代码项目文章。由于服务器上唯一的帐户是没有密码的管理员，我尝试将域作为计算机的 IP 地址为“10.0.0.11”，用户名为“管理员”，密码为“”。 [http://www.codeproject.com/KB/dotnet/UserImpersonationInNET.aspx?display=Print](http://www.codeproject.com/KB/dotnet/UserImpersonationInNET.aspx?display=Print) 不幸的是，它失败并显示以下消息：

> “登录失败：未知用户名或密码错误”

问题的另一个提示：当客户端和服务器都是公司网络上的机器时，根本不存在连接问题。

如何解决错误并完成与服务器的连接？尽管这不是最佳实践，但我完全可以移除任何安全措施，这样我就可以继续推进这个项目

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-08T10:54:44.670

在您掌握细节之前，最好的学习方法是禁用安全性。您必须在服务器端创建一个新的绑定配置，并将安全模式设置为“无”。为方便起见，将其命名为“NoSecurity”。此配置必须具有您在端点使用的相同类型（wsHttpBinding 等）。然后将端点的 bindingConfiguration 属性设置为“NoSecurity”。

更新您的客户端配置，您就可以开始了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T03:57:08.363

我知道没有办法让工作组信任一个域，这意味着你有几个选择，正如我所看到的

1.  在使用 HTTP（Web 服务端点）的 WCF 服务中添加另一个端点，并从域中使用它。这解决了安全问题，因为您可以在此处模拟，甚至设置可以访问工作组服务器中的好东西的特定用户。

2.  破坏 WCF 服务中的安全性。我将不得不考虑如何做到这一点，但无论如何这不是一个好主意。

3.  创建域并获得信任关系。

您提到的代码项目并没有以对 WCF 直接有用的方式处理模拟，因为身份验证发生在您甚至可以点击此代码之前。我想你可以敲击框架位来做到这一点，但这会很讨厌。可能有一种方法可以在 HTTP 端点中使用代码，但这已经可以完成，而不会产生添加绕过 Windows 安全性的代码的开销。

# filter - 如何使用动态 IP 地址将自己从 Google Analytics 中过滤出来？

> ID：621200
> 
> 赞同：16
> 
> 时间：2009-03-07T02:43:16.327
> 
> 标签：filter, google-analytics

如果您从动态 IP 地址访问该站点，有谁知道如何设置 Google Analytics 以过滤掉您自己？我不想将自己包含在我通过 Verizon FiOS 拥有动态 IP 地址的家庭使用统计数据中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-05-17T08:55:08.040

谷歌目前有一个浏览器插件，可以阻止您的任何访问出现在任何分析中。[http://tools.google.com/dlpage/gaoptout](http://tools.google.com/dlpage/gaoptout)

[此博客文章](http://www.debi-z.com/2011/05/17/how-do-you-exclude-yourself-in-google-analytics/)中讨论了此选择退出与过滤器的优缺点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-07T03:00:52.057

有几种方法可以做到这一点。如果您知道您访问站点的 IP 地址范围（并且不介意将它们*全部*过滤掉），您可以为该 IP 地址范围设置“排除”过滤器。如果这限制性太强，您可以使用 Google Analytics 代码设置 cookie 并对其进行过滤。这两种技术都记录在[Google 的帮助系统中](http://www.google.com/support/googleanalytics/bin/answer.py?answer=55481&cbid=-bki5yr08j02a&src=cb&lev=answer)。

或者，如果您在服务器上动态生成页面，您可能根本不首先根据当前登录的用户将 Google Analytics 代码写入页面。在我的网站上，我会根据一些事情来选择是否编写代码，例如网站是否在调试模式下运行或管理员是否登录。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-07T03:02:47.887

您可以通过在您的网站上创建一个设置 Google Analytics 分段 cookie 的特殊页面来做到这一点，使用如下代码：

```
<body onLoad="javascript:__utmSetVar('exclude_from_report')"> 
```

然后在 Analytics 中创建自定义过滤器以排除与“exclude_from_report”细分模式匹配的访问者。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-07T03:59:07.970

考虑使用 Firefox 的[NoScript 插件](http://noscript.net/)。只需将 google-analytics.com 标记为不受信任的站点，您就应该一切就绪。一个不错的附带好处：浏览器的安全性更高。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-07T16:47:35.547

设置 cookie 以防止将分析代码发送到浏览器是迄今为止最好的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T17:02:34.007

只需通过系统的主机文件阻止谷歌分析所在的域：

127.0.0.1 www.google-analytics.com

这比 jdigital 提到的 NoScript 插件的破坏性要小，但仍然让你在谷歌分析中有效地看不见。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T11:17:11.690

如果您是开发人员，并且担心在开发网站时会获得大量点击，您可以在分析跟踪代码中添加以下行：

```
 pageTracker._setDomainName(".yourwebsitename.com"); 
```

假设您在测试期间访问的 URL 不以 .yourwebsitename.com 结尾，那么跟踪代码将看到您的 URL 是“localhost”而不是“yourwebsitename.com”，并且不会发送任何跟踪。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-11T10:18:44.967

找不到回复答案的方法，我第二次使用主机文件技巧：127.0.0.1 www.google-analytics.com

因为它可以同时在所有浏览器中工作，因为设计师经常在所有浏览器中尝试站点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T16:48:43.823

您始终可以设置代理以通过隧道传输所有流量。然后简单地从结果中排除代理的 IP。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-29T08:54:02.013

我建议在 HOST 文件中使用 127.0.0.1 (localhost) 重定向来阻止所有/任何类型的滥用站点或域/跟踪器/分析等。要查看大型列表，请查看[WinHelp 网站](http://winhelp2002.mvps.org/hosts.htm)。我已经并将它用于我所有的 PC。您还需要查看列表中您确实想要哪些域，并在列表中用# 标记标记行。

所有说明都在网站上，适用于不同的操作系统。

# python - Django 表单：隐藏字段中的外键

> ID：621212
> 
> 赞同：15
> 
> 时间：2009-03-07T02:59:08.597
> 
> 标签：python, django, forms

我的表格：

```
class PlanForm(forms.ModelForm):    
    owner = forms.ModelChoiceField(label="",
                                  queryset=Profile.objects.all(),
                                  widget=forms.HiddenInput())
    etc...

    class Meta:
        model = Plan 
```

在模型中，所有者是 Profile 的 ForeignKey。

当我设置此表单时，我将“所有者”的值设置为 Profile 对象。

但是当它出现在表单上时，它似乎包含了 Profile的*名称，如下所示：*

```
<input type="hidden" name="owner" value="phil" id="id_owner" /> 
```

当表单提交并返回到我的views.py时，我尝试像这样处理它：

```
 form = PlanForm(request.POST)
    ...
    if form.is_valid():                
        plan = form.save()
        return HttpResponseRedirect('/plans/%s'%plan.id) # Redirect after POST 
```

但是，我得到的是类型转换错误，因为它无法将字符串“phil”（保存到“所有者”字段中的用户名）转换为 Int 以将其转换为 ForeignKey。

那么这里发生了什么。ModelForm 是否应该将外键表示为数字并透明地处理它？还是我需要自己将 id 提取到表单的所有者字段中？如果是这样，在我尝试验证表单之前，我如何以及何时将其映射回来？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-07T14:40:39.207

我怀疑`__unicode__`Profile 模型实例的`repr`方法或其设置返回的值不是`self.id`. 例如，我刚刚设置了这个：

```
# models.py
class Profile(models.Model):
    name = models.CharField('profile name', max_length=10)

    def __unicode__(self):
        return u'%d' % self.id

class Plan(models.Model):
    name = models.CharField('plan name', max_length=10)
    profile = models.ForeignKey(Profile, related_name='profiles')

    def __unicode__(self):
        return self.name

# forms.py
class PlanForm(forms.ModelForm):
    profile = forms.ModelChoiceField(queryset=Profile.objects.all(),
            widget=forms.HiddenInput())

    class Meta:
        model = Plan

# views.py
def add_plan(request):

    if request.method == 'POST':
        return HttpResponse(request.POST['profile'])

    profile = Profile.objects.all()[0]
    form = PlanForm(initial={'profile':profile})
    return render_to_response('add_plan.html',
            {
                'form':form,
            },
            context_instance=RequestContext(request)) 
```

有了这个，我看到 PlanForm.profile 在模板中呈现：

```
<input type="hidden" name="profile" value="1" id="id_profile" /> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-07T15:14:33.167

唔...

这实际上可能是一个安全漏洞。

假设恶意攻击者制作了一个 POST（例如，通过使用 FireBug 的 XmlHttpRequest）并将配置文件术语设置为一些古怪的值，例如您的配置文件 ID。可能不是你想要的？

如果可能，您可能希望从请求对象本身获取配置文件，而不是从 POST 值提交的内容。

```
form = PlanForm(request.POST)
if form.is_valid():
    plan = form.save(commit=False)
    plan.owner = request.user.get_profile()
    plan.save()
    form.save_m2m() # if neccesary 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-07T12:57:27.787

当您将 Profile 对象分配给表单时，Django 会将其字符串化并将输出用作表单中的值。不过，您会期望 Django 使用对象的 ID。

幸运的是，解决方法很简单：只需提供 Profile 对象的表单主键值即可：

```
form = PlanForm(initial={'profile': profile.pk}) 
```

另一方面，当您使用绑定表单时，它们的工作更加明智：

```
form = PlanForm(request.POST)
if form.is_valid():
    print form.cleaned_data['profile']  # the appropriate Profile object 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T17:54:01.553

由于 ModelChoiceField 继承自 ChoiceFIeld，因此您应该为此使用[MultipleHiddenInput](https://docs.djangoproject.com/en/1.4/ref/forms/widgets/#multiplehiddeninput)小部件：

```
class PlanForm(forms.ModelForm):    
  owner = forms.ModelChoiceField(
            queryset=Profile.objects.all(),
            widget=forms.MultipleHiddenInput())

  class Meta:
    model = Plan 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-07T10:37:24.097

通常不需要将相关对象放入表单字段中。有一种更好的方法，即在表单 URL 中指定父 ID。

假设您需要为新的 Plan 对象呈现一个表单，然后在提交表单时创建一个。这是您的 urlconf 的样子：

```
(r"/profile/(?P<profile_id>\d+)/plan/new", view.new_plan), # uses profile_id to define proper form action
(r"/profile/(?P<profile_id>\d+)/plan/create", view.create_plan) # uses profile_id as a Plan field 
```

如果您要更改现有对象，您所需要的只是plan_id，您可以从中推断出任何相关记录。

# android - Android 覆盖显式意图

> ID：621216
> 
> 赞同：4
> 
> 时间：2009-03-07T03:01:59.760
> 
> 标签：android, overriding, android-activity, android-intent, explicit

我的应用程序需要一个`intent-filter`响应`Intent`具有它的组件集（一个明确的意图）的一个。这是一个例子。

```
Intent i = new Intent();
i.setClassName("com.compareeverywhere","com.compareeverywhere.ScanActivity");
startActivity(i); 
```

只是一个简单的`intent-filter`不会做 - 因为它`Intent`是为一个特定的组件（`Activity`，）制作的，它只是启动它而不寻找意图。有没有办法做到这一点？
谢谢，Isaac Waller
PS：请不要回答“不”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-21T23:32:48.030

不。

:) 话虽如此，想象一下如果 Android 允许人们劫持特定组件的 Intent 会发生什么。不喜欢竞争对手的应用？只需让您自己的活动劫持他的主要活动来显示色情内容。Intents 可以专门指定特定的组件，因为作者不希望其他人能够替换它们。

你有两个选择。如果这是您自己的代码，请将其替换为通用意图，或者如果它属于其他人，请联系他们，并很好地要求他们将其更改为通用意图以及一些必要的充分理由。

# sql-server - 无法将服务器添加到 Visual Studio 服务器资源管理器

> ID：621217
> 
> 赞同：1
> 
> 时间：2009-03-07T03:02:12.303
> 
> 标签：sql-server, visual-studio

我无法将远程服务器添加到我的 ASP.Net 网站的 Visual Studio 服务器资源管理器，该网站已经运行了大约 9 个月。

我添加了一个运行良好的数据库连接。

该错误消息使我认为我可能没有正确输入路径。我尝试了多种组合，包括使用 IP 地址。

错误消息：无法重新连接到“servername”。确保机器名称和路径有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T04:39:00.137

如果服务器是远程服务器，则可能是防火墙正在阻止。检查运行 SQL Server 的计算机中的防火墙。

# c++ - 带有 boost::shared_ptr 的空指针？

> ID：621220
> 
> 赞同：57
> 
> 时间：2009-03-07T03:03:26.543
> 
> 标签：c++, boost, null, pointers, shared-ptr

什么等价于以下内容：

```
std::vector<Foo*> vec;
vec.push_back(NULL); 
```

处理的时候`boost::shared_ptr`？是下面的代码吗？

```
std::vector< boost::shared_ptr<Foo> > vec;
vec.push_back(boost::shared_ptr<Foo>()); 
```

注意：我可能会推回很多这样的对象。`nullPtr`我应该在某处声明一个全局静态对象吗？这样，只需构建其中一个：

```
boost::shared_ptr<Foo> nullPtr; 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-07T04:31:33.820

您的建议（`shared_ptr<T>`不带参数调用构造函数）是正确的。（使用值 0 调用构造函数是等效的。）我认为这不会比`vec.push_back()`使用预先存在的调用慢`shared_ptr<T>`，因为在两种情况下都需要构造（直接构造或复制构造）。

但是如果你想要“更好”的语法，你可以试试下面的代码：

```
class {
public:
    template<typename T>
    operator shared_ptr<T>() { return shared_ptr<T>(); }
} nullPtr; 
```

这声明了一个全局对象`nullPtr`，它支持以下自然语法：

```
shared_ptr<int> pi(new int(42));
shared_ptr<SomeArbitraryType> psat(new SomeArbitraryType("foonly"));

...

pi = nullPtr;
psat = nullPtr; 
```

请注意，如果您在多个翻译单元（源文件）中使用它，则需要为类命名（例如`_shared_null_ptr_type`），将`nullPtr`对象的定义移动到单独的 .cpp 文件中，并`extern`在头文件中添加声明类已定义。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-07T06:33:54.383

好吧，这是合法的：

```
shared_ptr<Foo> foo;  /* don't assign */ 
```

在这种状态下，它不指向任何东西。你甚至可以测试这个属性：

```
if (foo) {
    // it points to something
} else {
    // no it doesn't
} 
```

那么为什么不这样做：

```
std::vector < shared_ptr<Foo> > vec;
vec.push_back (shared_ptr<Foo>);   // push an unassigned one 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-09-25T08:01:34.730

在 C++0x 中，您可以简单地将 from 转换`nullptr`为`std::shared_ptr`：

```
std::vector< boost::shared_ptr<Foo> > vec;
vec.push_back(nullptr); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-07T03:27:16.673

您可以声明一个全局`nullPtr`的`shared_ptr<Foo>`. `nullPtr`但是如果你污染了全局命名空间，你会称全局`shared_ptr<Bar>`为什么呢？

通常我将空 ptr 声明为指针类中的静态。

```
#include <boost\shared_ptr.hpp>

class Foo; // forward decl
typedef boost::shared_ptr<Foo> FooPtr;
class Foo
{
public:
    static FooPtr Null;
}
...
// define static in cpp file
FooPtr Foo::Null;
...
// use Foo Null
vec.push_back(Foo::Null); 
```

这样每个类都有一个静态 Null。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-30T10:23:24.267

这是我认为更简单并且效果很好的东西

（记住那`typedef`是你的朋友）：

```
#include    <cstdlib>
#include    <vector>
#include    <iostream>
#include    <boost/shared_ptr.hpp>

typedef boost::shared_ptr< std::vector<char> > CharVecHandle;

inline CharVecHandle newCharVec(std::vector<char>::size_type size) {
    return CharVecHandle(new std::vector<char>(size));
}

inline CharVecHandle newCharVec(void) {
    return CharVecHandle();
}

int main ( void )
{
    CharVecHandle cvh = newCharVec();

    if (cvh == NULL) 
        std::cout << "It's NULL" << std::endl;
    else 
        std::cout << "It's not NULL" << std::endl;

    std::vector< CharVecHandle > cvh_vec;

    cvh_vec.push_back(newCharVec(64));
    cvh_vec.push_back(newCharVec());

    // or call the NULL constructor directly
    cvh_vec.push_back(CharVecHandle());

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-07T03:12:28.940

是的，声明一个全局静态空指针。

# c# - 在 .NET 应用程序中部署经过身份验证的自动更新的最佳方式是什么？

> ID：621221
> 
> 赞同：0
> 
> 时间：2009-03-07T03:03:59.520
> 
> 标签：c#, .net, authentication, deployment

目前，应用程序仅部署到我的 40 名员工左右的办公室。ClickOnce 非常适合这一点，因为每个人都有网络访问或 VPN 访问，这使得更新非常简单。现在，我的任务是找出将这些应用程序部署到公司资源的最佳方式。ClickOnce 可以工作，但文件将公开提供给任何人。

通过某种形式的身份验证来实现此功能的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T03:46:31.307

可以在需要 Windows 身份验证的站点上设置实际的部署页面。只要您使用的域控制器信任其他域控制器，您就是黄金。您也可以在文件夹级别执行此操作。如果你走这条路，你仍然可以使用点击一次模型。

这里还有一些想法：http: [//tinyurl.com/bn5e76](http://tinyurl.com/bn5e76)

# java - 您如何使用 Java 制作网站？

> ID：621228
> 
> 赞同：73
> 
> 时间：2009-03-07T03:10:24.700
> 
> 标签：java, php, mysql

这可能是一个非常微不足道的问题，但我一直在我的学校编写 Java 程序，我刚刚发现我也可以使用 Java 创建网站。

*   我怎样才能做到这一点？有什么好书/教程吗？
*   哪个更适合 Web 开发，Java 还是 PHP？
*   另外，当使用 PHP 时，MySQL 就出现了，而在为桌面编写 Java 程序时，我们只使用 File I/O，那么对于 web dev、File I/O 或 MySQL 哪个更好呢？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-03-07T07:30:44.310

你问了几个不同的问题......

*   如何使用 Java 创建网站？

开始使用 Java 制作网站的最简单方法是使用 JSP。JSP 代表 Java Server Pages，它允许您在 Java 代码文件中嵌入 HTML 以创建动态页面。为了编译和提供 JSP，您需要一个 Servlet 容器，它基本上是一个运行 Java 类的 Web 服务器。最流行的基本 Servlet 容器称为 Tomcat，它由 Apache 软件基金会免费提供。按照 cletus[在此处](http://www.coreservlets.com/Apache-Tomcat-Tutorial/)提供的教程进行操作。

一旦您启动并运行了 Tomcat，并且对如何部署 JSP 有了基本的了解，您可能想要开始创建自己的 JSP。我一直喜欢 IBM developerWorks 教程。他们在[这里](https://www6.software.ibm.com/developerworks/education/j-introjsp/index.html)有一个看起来不错的 JSP 教程（虽然有点过时）。

您会发现 Java Web 开发比 JSP 更多，但这些教程将让您朝着正确的方向前进。

*   PHP 与 Java

这是一个相当主观的问题。PHP 和 Java 只是工具，在一个糟糕的程序员手中，任何工具都是无用的。PHP 和 Java 各有优缺点，对它们的讨论可能超出了本文的范围。我想说，如果您已经了解 Java，请坚持使用 Java。

*   文件 I/O 与 MySQL

MySQL 更适合 Web 应用程序，因为它旨在处理许多并发用户。您应该知道，通过 Java 的数据库连接框架 JDBC，Java 可以像 PHP 一样轻松地使用 MySQL。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-03-07T03:11:39.863

阅读[有关 Java Web 应用程序的教程](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/WebApp.html)。

基本上，Web 应用程序是 Java EE 标准的一部分。很多人只使用 Web（servlet）部分和其他框架，最著名的是 Spring，还有 Struts、Seam 等。

您只需要一个像 IntelliJ、Eclipse 或 Netbeans 这样的 IDE、JDK、Java EE 下载和像 Tomcat 这样的 servlet 容器（或像 Glassfish 或 JBoss 这样的成熟应用服务器）。

这是一个[Tomcat 教程](http://www.coreservlets.com/Apache-Tomcat-Tutorial/)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-07T12:06:58.547

我会回答臭名昭著的“你真的想这样做吗”的答案。

看来您的重点是使用 Java 并了解它可以做什么。但是，如果您想实际开发一个 Web 应用程序，您应该意识到，尽管 Java 用于 Web 应用程序（以及一些严肃的应用程序），但还有其他技术选项可能更合适。

就个人而言，我喜欢（并使用）Java 在服务器上提供强大、可移植的后端服务。我从来没有尝试过用它来构建网站，因为它似乎从来都不是最明显的事情。在厌倦了 PHP（我已经使用了多年）之后，我最近爱上了[Django](http://www.djangoproject.com/)，一个基于 Python 的 Web 框架。

[Ruby on Rails 的人在 youtube 上](http://www.youtube.com/profile?user=envyads&view=videos)有许多非常有趣的视频，将不同的 Web 技术与 RoR 进行比较。当然，这些显然被夸大了，而且可能有点偏颇，但我想说它们中的每一个都不止一个道理。关于 Java 的文章[在这里](http://www.youtube.com/watch?v=PQbuyKUaKFo)。;-)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-07T09:31:00.560

虽然应该提到很多其他的，但应该首选[Apache Wicket 。](http://wicket.apache.org/)

Wicket 不仅减少了大量样板代码，它实际上完全删除了它，您可以很好地分离业务代码和标记，而无需混合两者以及您可以从网站上阅读的各种其他内容。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-07T08:21:57.980

另请注意，虽然 Java 通常对初学者非常友好，但进入 JavaEE、Servlet、Facelets、Eclipse 集成、JSP 并在 Tomcat 中启动并运行所有内容却不是。当然，这不是建立网站的最简单方法，而且对于大多数事情来说可能有点矫枉过正。

除此之外，您可能需要自己托管您的网站，因为大多数网络空间提供商不提供 Servlet 容器。如果您只是想看看它的乐趣，我会尝试 Ruby 或 Python，它们是更酷的东西，可以摆弄。但无论如何，为了至少提供与问题相关的内容，这里有一个不错的 Servlet 教程：[link](http://courses.coreservlets.com/Course-Materials/csajsp2.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-08T19:22:12.963

如果您想使用 Java 制作网站，请考虑创建 Applet。除非您想要更专业的东西，否则您很可能不需要使用常规 Java 之外的任何东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-07T18:00:47.197

我建议[将 OOWeb](http://ooweb.sourceforge.net/tutorial.html)作为 HTTP 服务器和像[Velocity](http://velocity.apache.org/engine/releases/velocity-1.6.1/user-guide.html)这样的模板引擎来生成 HTML。我也支持 Esko 对[Wicket](http://wicket.apache.org/examplehelloworld.html)的建议。两种解决方案都比平均设置简单得多。

# .net - 在深度优先搜索期间检测家谱图中的循环

> ID：621229
> 
> 赞同：6
> 
> 时间：2009-03-07T03:10:26.620
> 
> 标签：.net, algorithm, binary-tree, genealogy

我正在递归加载马家谱数据。对于一些错误的数据集，我的递归永远不会停止......那是因为数据中有循环。

**如何检测这些周期以停止重复？**

我想到在重复维护一个包含所有“访问”马的哈希表时。但这会发现一些误报，因为一匹马可以在一棵树上出现两次。

不可能发生的是，一匹马以自己的父亲或祖父或曾祖父的身份出现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T03:23:10.053

伪代码：

```
void ProcessTree(GenTreeNode currentNode, Stack<GenTreeNode> seen)
{
   if(seen.Contains(currentNode)) return;
   // Or, do whatever needs to be done when a cycle is detected

   ProcessHorse(currentNode.Horse); // Or whatever processing you need

   seen.Push(currentNode);

   foreach(GenTreeNode childNode in currentNode.Nodes)
   {
      ProcessTree(childNode, seen);
   }

   seen.Pop();
} 
```

基本思想是保留一个列表，列出我们在到达当前节点的途中已经看到的所有节点；如果回到我们已经经历过的节点，那么你知道我们已经形成了一个循环（我们应该跳过这个值，或者做任何需要做的事情）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T03:21:32.787

维护一个由所有元素组成的堆栈，直到树的根。

每次沿着树前进时，扫描堆栈中的子元素。如果您找到匹配项，那么您已经发现了一个循环并且应该跳过那个孩子。否则，将孩子推入堆栈并继续。每当您回溯树时，将一个元素从堆栈中弹出并丢弃。

（在家谱数据的情况下，树中的“子”节点可能是“父”节点的生物学父节点。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T04:00:05.370

这听起来像是您最终可以应用面试琐事问题的情况：仅使用 O(1) 内存在链表中找到一个循环。

在这种情况下，您的“链表”是您枚举的元素序列。使用两个枚举器，以一半的速度运行一个，如果快的一个遇到慢的，那么你有一个循环。这也将是 O(n) 时间，而不是检查“已看到”列表所需的 O(n^2) 时间。缺点是您只有在某些节点被多次处理后才能发现循环。

在示例中，我将“半速”方法替换为更易于编写的“放置标记”方法。

```
class GenTreeNode {
    ...

    ///<summary>Wraps an the enumeration of linked data structures such as trees and linked lists with a check for cycles.</summary>
    private static IEnumerable<T> CheckedEnumerable<T>(IEnumerable<T> sub_enumerable) {
        long cur_track_count = 0;
        long high_track_count = 1;
        T post = default(T);
        foreach (var e in sub_enumerable) {
            yield return e;
            if (++cur_track_count >= high_track_count) {
                post = e;
                high_track_count *= 2;
                cur_track_count = 0;
            } else if (object.ReferenceEquals(e, post)) {
                throw new Exception("Infinite Loop");
            }
        }
    }

    ...

    ///<summary>Enumerates the tree's nodes, assuming no cycles</summary>
    private IEnumerable<GenTreeNode> tree_nodes_unchecked() {
        yield return this;
        foreach (var child in this.nodes)
            foreach (var e in child.tree_nodes_unchecked())
                yield return e;
    }
    ///<summary>Enumerates the tree's nodes, checking for cycles</summary>
    public IEnumerable<GenTreeNode> tree_nodes()
    {
        return CheckedEnumerable(tree_nodes_unchecked());
    }

    ...

    void ProcessTree() {
        foreach (var node in tree_nodes())
            proceess(node);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T03:22:58.197

检测这一点的一个非常简单的方法是检查该约束本身：

> 不可能发生的是，一匹马以自己的父亲或祖父或曾祖父的身份出现。

每当您在树中插入一个节点时，将树遍历到根以确保马不作为任何类型的父存在。

为了加快速度，您可以将哈希表关联到每个节点，在其中缓存此类查找的答案。那么下次在该节点下插入一匹马时，您不必搜索整个路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T03:23:59.490

如果您跟踪节点而不是马，您的哈希表解决方案应该可以工作。只要确保每次读取新马时都会创建一个新节点，即使值/马与前一个节点的值/马相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-07T03:26:03.697

您正在处理有[向无环图](http://en.wikipedia.org/wiki/Directed_acyclic_graph)，而不是树。不应该有任何循环，因为马的后代也不能是它的祖先。

知道了这一点，您应该应用特定于有向无环图的代码技术。

# c++ - 如何故意删除 boost::shared_ptr？

> ID：621233
> 
> 赞同：45
> 
> 时间：2009-03-07T03:15:00.103
> 
> 标签：c++, memory-management, boost, shared-ptr

我有很多`boost::shared_ptr<MyClass>`对象，在某些时候我故意想让其中一些对象`delete`释放一些内存。（我知道那时我再也不需要指向的`MyClass`对象了。）我该怎么做？

我猜你不能只`delete()`用我得到的原始指针调用`get()`.

我在 中看到了一个函数`get_deleter(shared_ptr<T> const & p)`，`boost::shared_ptr`但我不知道如何使用它，而且它旁边还写着*实验性的。*（我想我有 Boost 1.38。）

也许只是`boost::shared_ptr`为变量分配一个新的空？那应该丢弃旧值并将其删除。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-03-07T03:51:29.003

你只是做

```
ptr.reset(); 
```

请参阅[shared_ptr 手册](http://www.boost.org/doc/libs/release/libs/smart_ptr/shared_ptr.htm)。它相当于

```
shared_ptr<T>().swap(ptr) 
```

您调用`reset`不应再引用该对象的每个智能指针。最后一个这样的`reset`（或任何其他导致引用计数下降到零的操作，实际上）将导致使用删除器自动释放对象。

也许您对[智能指针编程技术](http://www.boost.org/doc/libs/release/libs/smart_ptr/sp_techniques.html)感兴趣。它有一个关于[延迟释放](http://www.boost.org/doc/libs/release/libs/smart_ptr/sp_techniques.html#delayed)的条目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-08-07T08:49:09.953

如果您希望能够有意删除对象（我一直这样做），那么您必须使用单一所有权。当 shared_ptr 不适合您的设计时，您会被引诱使用它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-07T03:55:20.693

的全部意义*在于*`boost::shared_ptr<T>`，指针对象将在没有 s 指向它的那一刻被删除——也就是说，当最后一个指向该对象超出范围或被重新分配以指向另一个对象时。因此，删除对象所需要做的就是确保没有s 指向它。例如，如果你只有一个指向一个对象的被调用，要么让它超出范围，要么调用（相当于一个普通指针），或者将它分配给指向别的东西。*`shared_ptr<T>``shared_ptr<T>``shared_ptr<T>``shared_ptr<T>``p``p.reset()``p = NULL`*

 *如果您有两个`shared_ptr<T>`s 指向该对象，则需要重新分配它们。

**编辑：**感谢 dehmann 指出这`p = NULL;`实际上不是有效的代码`shared_ptr<T>`... :)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-18T03:48:56.283

您想要做的是使用[boost::weak_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/weak_ptr.htm)返回弱引用，可以在需要时将其转换为 shared_ptr。这可以让您控制 shared_ptr 中对象的生命周期，并且那些想要访问它的人可以保留 weak_ptr 并尝试转换为 shared_ptr。如果转换失败，那么他们可以重新查询并将对象带回内存。

# sql - 只知道父表id时如何查询具体表

> ID：621234
> 
> 赞同：0
> 
> 时间：2009-03-07T03:18:06.337
> 
> 标签：sql, sql-server-2005

我的数据库中有一个继承关系，其中有一个父表（表 A），它基本上是一系列自增整数（Id 列）。从这里，我有几个表（表 B、C 和 D）也有一个 Id 列，它是表 A 中 Id 列的外键。

现在我的问题是，如果我有 ID，从表 B、C 或 D 中获取正确行的最有效方法是什么？

编辑：在表 B、C 或 D 中只有一行具有 Id （在其他 2 中不会有匹配的行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T03:25:23.060

您可以使用联合查询...即：

```
select 'TABLE B', a_id from b where a_id = 1
UNION
select 'TABLE C', a_id from c where a_id = 1
UNION
select 'TABLE D', a_id from d where a_id = 1; 
```

这将为您提供 a_id 为 1 的表的列表，同时还显示它所在的表。

如果所有 3 个表具有相同的结构，您可以执行类似的操作：

```
select b.* from b where a_id = 1
UNION
select c.* from c where a_id = 1
UNION
select d.* from d where a_id = 1; 
```

# asp.net-mvc - 在控制器中使用 HtmlHelper

> ID：621235
> 
> 赞同：69
> 
> 时间：2009-03-07T03:19:45.677
> 
> 标签：asp.net-mvc

是否可以在控制器中使用 HtmlHelper，例如获取 TextBox(...) 方法？并不是说我不能编写它自己生成的 html，而是我只想了解它是如何工作的，以便我可以创建最佳解决方案。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-07T03:43:43.093

[这是一个改编自此](http://www.brightmix.com/blog/how-to-renderpartial-to-string-in-asp-net-mvc/)的示例：

```
var h = new HtmlHelper(new ViewContext(ControllerContext, new WebFormView("omg"), new ViewDataDictionary(), new TempDataDictionary()), new ViewPage());
h.TextBox("myname"); 
```

请注意，这是一个 hack，可以做到，但我认为没有任何充分的理由这样做......

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-01-09T18:10:19.853

你可以使用这样的方法：

```
public static HtmlHelper GetHtmlHelper(this Controller controller)
{
    var viewContext = new ViewContext(controller.ControllerContext, new FakeView(), controller.ViewData, controller.TempData, TextWriter.Null);
    return new HtmlHelper(viewContext, new ViewPage());
}

public class FakeView : IView
{
    public void Render(ViewContext viewContext, TextWriter writer)
    {
        throw new InvalidOperationException();
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-07T23:44:22.410

HtmlHelper 在设计上是 View 机制的一部分，应该被视为独立于 MVC 的 Controller 和 Model 部分。我不确定您为什么要在控制器内生成控件，因为它的作用是将数据传递到视图以进行渲染。

我并不是说你不能实现它，但对于好的设计来说它会更好。

您能解释一下您要实现的目标，然后我们可以考虑以“MVC 方式”来实现吗？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-26T11:32:42.190

```
using System.Web.Mvc;
using System.Web.Mvc.Html;

var h = new HtmlHelper<Effort>(new ViewContext(ControllerContext, new WebFormView(ControllerContext, "omg"), new ViewDataDictionary(), new TempDataDictionary(), new StringWriter()), new ViewPage());

h.DisplayFor(e => Model.Efforts[i].Content.Offer.Price1.Value) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-02-01T15:32:47.677

对于 .NET Core 2 MVC：[https ://github.com/aspnet/Mvc/issues/7321](https://github.com/aspnet/Mvc/issues/7321)

```
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.Infrastructure;
using Microsoft.AspNetCore.Mvc.ModelBinding;
using Microsoft.AspNetCore.Mvc.Rendering;
using Microsoft.AspNetCore.Mvc.Routing;
using Microsoft.AspNetCore.Mvc.ViewEngines;
using Microsoft.AspNetCore.Mvc.ViewFeatures;
using Microsoft.AspNetCore.Mvc.ViewFeatures.Internal;
using Microsoft.Extensions.Options;
using System.IO;
using System.Text.Encodings.Web;
using System.Threading.Tasks;

    public class HelperGenerator
    {
        private readonly IHtmlGenerator _htmlGenerator;
        private readonly ICompositeViewEngine _compositeViewEngine;
        private readonly IModelMetadataProvider _modelMetadataProvider;
        private readonly IViewBufferScope _viewBufferScope;
        private readonly IActionContextAccessor _actionContextAccessor;
        private readonly HtmlHelperOptions _htmlHelperOptions;

        public HelperGenerator(IHtmlGenerator htmlGenerator, ICompositeViewEngine compositeViewEngine, IModelMetadataProvider modelMetadataProvider, IViewBufferScope viewBufferScope, IActionContextAccessor actionContextAccessor, IOptions<MvcViewOptions> options)
        {
            _htmlGenerator = htmlGenerator;
            _compositeViewEngine = compositeViewEngine;
            _modelMetadataProvider = modelMetadataProvider;
            _viewBufferScope = viewBufferScope;
            _actionContextAccessor = actionContextAccessor;
            _htmlHelperOptions = options.Value.HtmlHelperOptions;
        }
        public IHtmlHelper HtmlHelper(ViewDataDictionary ViewData, ITempDataDictionary TempData)
        {
            var helper = new HtmlHelper(_htmlGenerator, _compositeViewEngine, _modelMetadataProvider, _viewBufferScope, HtmlEncoder.Default, UrlEncoder.Default);
            var viewContext = new ViewContext(_actionContextAccessor.ActionContext,
               new FakeView(),
               ViewData,
               TempData,
               TextWriter.Null,
               _htmlHelperOptions);
            helper.Contextualize(viewContext);
            return helper;
        }
        private class FakeView : IView
        {
            public string Path => "View";

            public Task RenderAsync(ViewContext context)
            {
                return Task.FromResult(0);
            }
        }
    } 
```

确保在服务中注册：

```
services.AddSingleton<IActionContextAccessor, ActionContextAccessor>(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-05T18:02:30.077

如果有人试图在没有控制器的情况下执行此操作（例如在单元测试时），则还有更多问题需要处理，因为其中许多方法（我知道，不是测试场景，而是针对该场景）抛出 Null例外 ( `ViewContext.ScopeCache`)。您可以通过以下方式看到这一点（注意所有这些方式都需要`ViewContext`形成一个实例，这是您插入到 HtmlHelper 实例的构造函数中的参数之一，依此类推该对象）：

```
viewContext.UnobtrusiveJavaScriptEnabled = false; 
```

简单地设置该值会引发许多这些方法的异常，但是这个答案为我解决[了这个问题](https://stackoverflow.com/a/25216750/264031)，看看他如何得到一个`HtmlHelper`（另见[这里](https://gist.github.com/ErikSchierboom/6da474dcd5751fbbc94c)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-05T17:52:49.223

*   使用 System.Web.Mvc；
*   使用 System.Web.Mvc.Html；

    ```
     HtmlHelper helper = new HtmlHelper(new ViewContext(ControllerContext, new            WebFormView(ControllerContext, "Index"), new ViewDataDictionary(), new TempDataDictionary(), new System.IO.StringWriter()), new ViewPage()); 
    ```

# c++ - 绘制到屏幕的 DC C++ 后强制屏幕重绘

> ID：621255
> 
> 赞同：0
> 
> 时间：2009-03-07T03:34:06.440
> 
> 标签：c++, screen, gdi, draw, repaint

我正在创建一个 Windows Mobile 自定义 SIP，当用户按下或“悬停”在键盘上的一个按钮上时，我使用 ::GetDC(NULL) 将其对应的选定图像（iPhone 式）绘制到屏幕的 DC。它是用 Win32 C++ 开发的。

我的问题是我永远无法让屏幕重新绘制自己，擦除先前绘制的键。我已经尝试了所有我能想到的强制它，::RedrawWindow() 使用 NULL 或任何 Get..Window 函数作为 HWND 的所有不同参数组合，以及所有标志组合 (INVALIDATE | UPDATENOW | ERASENOW | 所有儿童等）。我还尝试过使用 ::GetActiveWindow 和 ::GetForegroundWindow 使 rect 无效并强制重新绘制底层应用程序，使用 ::GetDesktopWindow 的变体等。我基本上已经没有想法了，这是阻止我的最后一件事在我的 Windows Mobile 设备上使用它。有没有人有任何想法？任何帮助将不胜感激。

我已经包含了一些截图来说明我的困境。

[截图前 截图](http://img13.imageshack.us/img13/9861/cezoom1.png)
[后](http://img9.imageshack.us/img9/7481/cezoom2.png)

[在 http://img13.imageshack.us/img13/9861/cezoom1.png 之前 http://img3.imageshack.us/img3/7481/cezoom2.png](http://img13.imageshack.us/img13/9861/cezoom1.png) [在](http://img3.imageshack.us/img3/7481/cezoom2.png)

此 先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T04:26:17.233

与其绘制到背景 DC，不如创建一个临时窗口并在其中绘制？当您销毁窗口时，背景应该会自动重新绘制。

我只是在猜测，因为我不了解 Windows Mobile，但可能是 Windows 正在缓存最后一个被绘制到 DC 中的东西，并在每次使窗口无效时重新绘制它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T04:29:14.963

您是否在屏幕 hWnd 上尝试过 InvalidateRect？

# ruby-on-rails - Rails：进行不可逆转的迁移是不是很糟糕？

> ID：621257
> 
> 赞同：43
> 
> 时间：2009-03-07T03:34:27.373
> 
> 标签：ruby-on-rails, activerecord, reverse, rollback, rails-migrations

何时可以在迁移的 self.down 方法中引发 ActiveRecord::IrreversibleMigration 异常？您应该在什么时候努力实际实施迁移的逆向？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-07T05:23:16.223

**如果您正在处理生产级系统**，那么是的，这非常糟糕。如果这是您自己的宠物项目，那么任何事情都是允许的（如果没有别的，这将是一种学习体验 :) 尽管迟早，即使在宠物项目中，您也会发现自己已经跨越了反向迁移只是必须在几天后撤消该迁移，无论是通过`rake`还是手动。）

在生产场景中，您应该**始终努力编写*和测试*可逆迁移**，以防万一您在生产中经历它，然后发现一个迫使您回滚（代码*和*架构）到某个先前版本（待定）的错误一些重要的修复——以及其他无法使用的生产系统。）

反向迁移的范围从大多数微不足道的（删除迁移期间添加的列或表，和/或更改列类型等）到涉及更多的（`execute`ed`JOIN`或`INSERT`s `UPDATE`），但没有什么比证明“清扫它”更复杂在地毯下”。如果不出意外，强迫自己思考实现反向迁移的方法可以让您对正向迁移正在解决的问题有新的认识。

您可能偶尔会遇到向前迁移删除功能的情况，从而导致数据从数据库中丢弃。 **由于显而易见的原因，反向迁移无法恢复丢弃的数据。** 尽管在这种情况下，可以建议让前向迁移自动保存数据或在可能发生回滚时将其保留，作为彻底失败的替代方案（保存到`yml`、复制/移动到特殊表等），但您不要不必这样做，因为测试这种自动化过程所需的时间可能会超过手动恢复数据所需的时间（如果需要的话。） 但即使在这种情况下，您也可以随时进行反向迁移**，而不是失败***有条件地和暂时地*等待某些用户操作失败（即测试是否存在必须手动恢复的某些必需表；如果丢失，则输出“我失败了，因为我无法`XYZ`从虚无中重新创建表；`XYZ`从备份手动恢复表然后再次运行我，我不会让你失望的！”）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-09-30T18:35:09.407

如果要破坏数据，可以先对其进行备份。例如

```
def self.up
  # create a backup table before destroying data 
  execute %Q[create table backup_users select * from users]  
  remove_column :users, :timezone
end  

def self.down
  add_column :users, :timezone, :string  
  execute %Q[update users U left join backup_users B on (B.id=U.id) set U.timezone = B.timezone]
  execute %Q[drop table backup_users]  
end 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-07T20:31:08.973

> 在生产场景中，您应该始终努力编写和测试可逆迁移，以防万一您在生产中经历它，然后发现一个迫使您回滚（代码和架构）到某个先前版本（待定）的错误一些重要的修复——以及其他无法使用的生产系统。）

进行可逆迁移对于开发和暂存来说是很好的，但假设代码经过良好测试，那么您想要在生产中向下迁移应该是非常罕见的。我在我的迁移中构建了生产模式下的自动 IrreversibleMigration。如果我真的需要撤消更改，我可以使用另一个“向上”迁移或删除异常。不过，这似乎很粗略。任何会导致这种可怕情况的错误都表明 QA 流程被严重搞砸了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-07T04:22:07.557

感觉你需要一个不可逆转的迁移可能表明你有更大的问题迫在眉睫。也许一些细节会有所帮助？

至于你的第二个问题：我总是“努力”写迁移的逆向。当然，*我*不是真的写的`.down`，TextMate在创建的时候会自动插入`.up`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-12T16:09:44.603

[可逆数据迁移](https://github.com/tomkurt/reversible_data_migration)使使用 yaml 文件创建可逆数据迁移变得容易。

```
class RemoveStateFromProduct < ActiveRecord::Migration
  def self.up
    backup_data = []
    Product.all.each do |product|
      backup_data << {:id => product.id, :state => product.state}
    end
    backup backup_data
    remove_column :products, :state
  end
  def self.down
    add_column :products, :state, :string
    restore Product
  end
end 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-07T04:07:56.467

IIRC，在迁移中更改数据类型时，您将拥有 IrreversibleMigration。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-18T20:39:11.217

我认为可以的另一种情况是当您进行合并迁移时。在这种情况下，“向下”实际上没有意义，因为它会删除所有表（合并后添加的表除外）。这可能不是你想要的。

# c++ - 如何运行 Qt 应用程序？

> ID：621262
> 
> 赞同：4
> 
> 时间：2009-03-07T03:45:00.063
> 
> 标签：c++, windows, qt

我一直在使用 Qt creator 来制作使用 Qt 库的应用程序。我可以通过单击播放按钮来运行这些应用程序，但我想学习如何通过双击 .exe 来运行应用程序。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-07T04:59:49.540

如果您已经构建了程序的“发布”版本，请将其和以下 DLL 从 qt\bin 复制到一个目录：

QtCore4.dll、QtGui4.dll 和 mingwm10.dll（如果您使用 gcc 和 minGW 编译）。

如果您正在运行“调试”版本，则需要 Qt DLL 的调试版本。它们具有相同的名称，但名称末尾带有“d”。

根据您在程序中使用的 Qt 模块，您可能需要复制其他 Qt DLL。

您可以从此页面（Qt 文档网站）了解更多信息[部署 Qt 应用程序](https://doc.qt.io/qt-5/deployment.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-07T04:18:58.203

我假设您正在运行 Windows，因为您提到了 .exe 文件扩展名。查看项目的调试和/或发布子目录以找到生成的二进制文件。您可以双击它来运行应用程序。但是，需要几个 DLL。因此，请确保它们在您的[PATH](http://en.wikipedia.org/wiki/Environment_variable#System_path_variables)中或将它们复制到同一目录中。[Dependency Walker](http://www.dependencywalker.com/)对于找出你需要什么很有用。

# .net-2.0 - 我可以控制 .NET 用户设置的位置以避免在应用程序升级时丢失设置吗？

> ID：621265
> 
> 赞同：105
> 
> 时间：2009-03-07T03:50:32.997
> 
> 标签：.net-2.0, settings

我正在尝试自定义`user.config`文件的位置。目前它与哈希和版本号一起存储

```
%AppData%\[CompanyName]\[ExeName]_Url_[some_hash]\[Version]\ 
```

我希望它与应用程序的版本无关

```
%AppData%\[CompanyName]\[ProductName]\ 
```

**这可以做到吗？怎么做？有什么影响？**升级后用户会丢失以前版本的设置吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-12-18T12:50:51.077

我想添加此引用的文本作为将来遇到此问题时的参考。[假设您可以通过调用Upgrade](https://docs.microsoft.com/en-us/dotnet/api/system.configuration.applicationsettingsbase.upgrade)指示 ApplicationSettings 基础结构从以前的版本复制设置：

```
Properties.Settings.Value.Upgrade(); 
```

来自[客户端设置常见问题解答](http://blogs.msdn.com/rprabhu/articles/433979.aspx)博客文章*：（[存档](https://web.archive.org/web/20181109011314/https://blogs.msdn.microsoft.com/rprabhu/2005/06/29/client-settings-faq/)）*

> **Q：为什么user.config路径中有版本号？如果我部署新版本的应用程序，用户不会丢失之前版本保存的所有设置吗？**
> 
> 答：user.config 路径对版本敏感的原因有两个。
> 
> (1) 支持应用程序不同版本的并行部署（例如，您可以使用 Clickonce 来做到这一点）。不同版本的应用程序可以保存不同的设置。
> 
> (2) 升级应用程序时，设置类可能已更改，可能与保存的内容不兼容，这可能会导致问题。
> 
> 但是，我们可以轻松地将设置从应用程序的早期版本升级到最新版本。只需调用 **ApplicationSettingsBase.Upgrade()**，它就会从先前版本中检索与当前版本的类匹配的设置，并将它们存储在当前版本的 user.config 文件中。您还可以选择在设置类或提供程序实现中覆盖此行为。
> 
> **问：好的，但我怎么知道何时调用升级？**
> 
> 答：好问题。在 Clickonce 中，当您安装应用程序的新版本时，ApplicationSettingsBase 会检测到它并在加载设置时自动为您升级设置。在非 Clickonce 的情况下，没有自动升级 - 您必须自己调用升级。这是确定何时调用升级的一种方法：
> 
> 有一个名为 CallUpgrade 的布尔设置，并给它一个默认值 true。当您的应用启动时，您可以执行以下操作：

```
if (Properties.Settings.Value.CallUpgrade)
{
   Properties.Settings.Value.Upgrade();
   Properties.Settings.Value.CallUpgrade = false;    
} 
```

> 这将确保仅在部署新版本后应用程序第一次运行时调用 Upgrade()。

我根本不相信它真的可以工作——微软不可能提供这种能力，但方法是一样的。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-03-07T04:40:00.663

要回答第一个问题，从技术上讲，您可以将文件放在您想要的任何位置，但是您必须自己编写代码，因为文件的默认位置是您的两个示例中的第一个。（[链接到如何自己做](https://msdn.microsoft.com/en-us/library/8eyb2ct1(v=vs.110).aspx)）

至于第二个问题，这取决于你如何部署应用程序。如果您通过 .msi 进行部署，则安装项目（构建 msi）的属性中有两个哈希值，即“升级代码”和“产品代码”。这些决定了如何安装 msi，以及它是否升级、覆盖或安装在同一应用程序的任何其他版本旁边。

例如，如果您有两个版本的软件并且它们具有不同的“升级”代码，那么对于 Windows，无论名称是什么，它们都是完全不同的软件。但是，如果“升级”代码相同，但“产品”代码不同，那么当您尝试安装第二个 msi 时，它会询问您是否要升级，此时它应该从旧配置到新配置。如果两个值相同，并且版本号没有更改，那么新配置将与旧配置位于同一位置，并且不需要执行任何操作。 [MSDN 文档](http://blogs.msdn.com/b/pusu/archive/2009/06/10/understanding-msi.aspx)

ClickOnce 有点不同，因为它更多地基于 ClickOnce 版本号和 URL 路径，但是我发现只要您继续“发布”到同一位置，新版本的应用程序将继续使用现有配置。（[链接到 ClickOnce 如何处理更新](https://msdn.microsoft.com/en-us/library/ms228995(v=vs.140).aspx)）

我也知道有一种方法可以在安装 msi 期间使用自定义安装脚本手动合并配置，但我不记得执行此操作的确切步骤...（有关如何使用 web.xml 执行此操作的链接，请参阅[此](http://aspalliance.com/826)链接。配置）

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-03-07T04:18:31.403

user.config 文件存储在

`c:\Documents and Settings>\<username>\[Local Settings\]Application Data\<companyname>\<appdomainname>_<eid>_<hash>\<verison>`

`<c:\Documents and Settings>`是用户数据目录，非漫游（上面的本地设置）或漫游。
`<username>`是用户名。
`<companyname>`是 CompanyNameAttribute 值（如果可用）。否则，忽略此元素。
`<appdomainname>`是 AppDomain.CurrentDomain.FriendlyName。这通常默认为 .exe 名称。
`<eid>`是基于可用于散列的证据的 URL、StrongName 或路径。
`<hash>`是从 CurrentDomain 收集的证据的 SHA1 哈希，按以下优先顺序排列：
1\. StrongName
2\. URL：
如果这些都不可用，请使用 .exe 路径。
`<version>`是 AssemblyInfo 的 AssemblyVersionAttribute 设置。

完整的描述在这里[http://msdn.microsoft.com/en-us/library/ms379611.aspx](http://msdn.microsoft.com/en-us/library/ms379611.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-10-21T18:46:45.823

（我会将此作为评论添加到@Amr 的答案中，但我还没有足够的代表来做到这一点。）

[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms379611.aspx)中的信息非常清楚，似乎仍然适用。然而，它没有提到 SHA1 散列是用 base 32 编码的，而不是更典型的 base 16。

我相信正在使用的算法是在 中实现的`ToBase32StringSuitableForDirName`，[可以在 Microsoft 参考源中找到](http://referencesource.microsoft.com/#System.Configuration/System/Configuration/ClientConfigPaths.cs)。

# c# - 在 foreach 中继续

> ID：621266
> 
> 赞同：3
> 
> 时间：2009-03-07T03:50:46.757
> 
> 标签：c#, foreach, keyword, while-loop, continue

在下面的 C# 代码片段
中，我在“ `while`”循环中有一个“ ”循环，我希望在发生特定条件时`foreach`跳转到“”中的下一项。`foreach`

```
foreach (string objectName in this.ObjectNames)
{
    // Line to jump to when this.MoveToNextObject is true.
    this.ExecuteSomeCode();
    while (this.boolValue)
    {
        // 'continue' would jump to here.
        this.ExecuteSomeMoreCode();
        if (this.MoveToNextObject())
        {
            // What should go here to jump to next object.
        }
        this.ExecuteEvenMoreCode();
        this.boolValue = this.ResumeWhileLoop();
    }
    this.ExecuteSomeOtherCode();
} 
```

' `continue`' 会跳转到 ' `while`' 循环而不是 ' `foreach`' 循环的开头。这里是否有要使用的关键字，或者我应该只使用我不太喜欢的 goto。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-07T03:55:40.460

使用 break 关键字。这将退出 while 循环并在其外部继续执行。由于您在 while 之后没有任何内容，因此它将循环到 foreach 循环中的下一项。

实际上，更仔细地查看您的示例，您实际上希望能够在不退出 while 的情况下推进 for 循环。您不能使用 foreach 循环执行此操作，但您可以将 foreach 循环分解为它实际自动化的内容。在 .NET 中，foreach 循环实际上呈现为对 IEnumerable 对象（您的 this.ObjectNames 对象是）的 .GetEnumerator() 调用。

foreach 循环基本上是这样的：

```
IEnumerator enumerator = this.ObjectNames.GetEnumerator();

while (enumerator.MoveNext())
{
    string objectName = (string)enumerator.Value;

    // your code inside the foreach loop would be here
} 
```

一旦你有了这个结构，你就可以在你的 while 循环中调用 enumerator.MoveNext() 来前进到下一个元素。所以你的代码会变成：

```
IEnumerator enumerator = this.ObjectNames.GetEnumerator();

while (enumerator.MoveNext())
{
    while (this.ResumeWhileLoop())
    {
        if (this.MoveToNextObject())
        {
            // advance the loop
            if (!enumerator.MoveNext())
                // if false, there are no more items, so exit
                return;
        }

        // do your stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T10:35:44.083

以下应该可以解决问题

```
foreach (string objectName in this.ObjectNames)
{
    // Line to jump to when this.MoveToNextObject is true.
    this.ExecuteSomeCode();
    while (this.boolValue)
    {
        if (this.MoveToNextObject())
        {
            // What should go here to jump to next object.
            break;
        }
    }
    if (! this.boolValue) continue; // continue foreach

    this.ExecuteSomeOtherCode();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T03:55:59.287

关键字将`break;`退出循环：

```
foreach (string objectName in this.ObjectNames)
{
    // Line to jump to when this.MoveToNextObject is true.
    while (this.boolValue)
    {
        // 'continue' would jump to here.
        if (this.MoveToNextObject())
        {
            break;
        }
        this.boolValue = this.ResumeWhileLoop();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T11:12:04.433

使用`goto`.

（我想人们会对这个回复感到生气，但我绝对认为它比所有其他选项更具可读性。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T03:56:16.760

你可以使用“break;” 退出最里面的while或foreach。

# widget - OS X 仪表板中的“CFBundleVersion 必须是字符串”

> ID：621289
> 
> 赞同：0
> 
> 时间：2009-03-07T04:11:11.060
> 
> 标签：widget, dashboard

在开发仪表板小部件时，我查看了控制台（系统日志）并发现一条错误消息：

```
2009-03-06 22:08:35.244 Widget Installer[3874] CFBundleVersion must be a string 
```

该属性在 Info.plist 中被标记为类型字符串。我尝试将其从 1.2 数字更改为一系列字母（不能误认为数字），并遵循苹果的版本控制指南。无论如何，我每次都会收到此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T04:12:56.080

小部件安装程序解析所有现有小部件以检查旧版本。此消息可能来自**您系统上的任何小部件**，如果您检查过自己的小部件，它可能是其他小部件之一。

# language-agnostic - 有符号变量和无符号变量有什么区别？

> ID：621290
> 
> 赞同：75
> 
> 时间：2009-03-07T04:11:29.890
> 
> 标签：language-agnostic, variables, unsigned

我在 C 和 C++ 的上下文中看到了这些，但是有符号变量和无符号变量有什么区别？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-03-07T04:14:41.957

**有符号变量**，例如有符号整数，将*允许您表示正数和负数范围内的数字*。

**无符号变量**，例如无符号整数，*仅允许您以正数和零表示数字*。

相同类型的无符号和有符号变量（例如`int`和`byte`）都具有相同的范围（范围分别为 65,536 和 256 个数字），但**无符号可以表示比相应的有符号变量更大的幅度数**。

例如， an`unsigned byte`可以表示从`0`to的值`255`，而`signed byte`可以表示`-128`to `127`。

[有符号数表示](http://en.wikipedia.org/wiki/Signed_number_representations)的维基百科页面解释了位级别表示的差异，[整数（计算机科学）](http://en.wikipedia.org/wiki/Integer_(computer_science))页面提供了每个有符号/无符号整数类型的范围表。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-10-11T02:37:37.920

虽然通常称为“符号位”，但我们通常使用的二进制值没有真正的符号位。

大多数计算机使用二进制补码算法。通过取一个补码（翻转所有位）并加一来创建负数：

      `5 (decimal) -> 00000101 (binary)`
      `1's complement: 11111010`
      `add 1: 11111011 which is 'FB' in hex`

这就是为什么有符号字节的值从 -128 到 +127 而不是 -127 到 +127：

      `1 0 0 0 0 0 0 0 = -128`
      `1 0 0 0 0 0 0 1 = -127`
          - - -
      `1 1 1 1 1 1 1 0 = -2`
      `1 1 1 1 1 1 1 1 = -1`
      `0 0 0 0 0 0 0 0 = 0`
      `0 0 0 0 0 0 0 1 = 1`
      `0 0 0 0 0 0 1 0 = 2`
          - - -
      `0 1 1 1 1 1 1 0 = 126`
      `0 1 1 1 1 1 1 1 = 127`
      （将 1 加到 127 给出：）
      `1 0 0 0 0 0 0 0`   我们在此图表顶部看到的是 -128。

如果我们有一个正确的符号位，则值范围将是相同的（例如，-127 到 +127），因为为符号保留了一位。如果最高有效位是符号位，我们将有：

      `5 (decimal) -> 00000101 (binary)`
      `-5 (decimal) -> 10000101 (binary)`

在这种情况下，有趣的是我们同时有一个零和一个负零：
      `0 (decimal) -> 00000000 (binary)`
      `-0 (decimal) -> 10000000 (binary)`

我们没有带二进制补码的 -0；-0 是 -128 （或者更一般地说，比最大的正值多一）。我们用一个补码来做；所有 1 位都是负 0。

在数学上，-0 等于 0。我依稀记得有一台计算机 -0 < 0，但我现在找不到任何对它的引用。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-07T04:12:29.233

有符号变量使用一位来标记它们是正数还是负数。无符号变量没有这个位，因此它们可以在同一空间中存储更大的数字，但只能存储非负数，例如 0 和更高。

更多信息：[无符号和有符号整数](http://www.rwc.uc.edu/koehler/comath/13.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-07T04:15:55.933

无符号变量只能是正数，因为它们缺乏表明它们是负数的能力。

这种能力称为“符号”或“签名位”。

一个副作用是，如果没有签名位，它们就多了一个位可以用来表示数字，它可以表示的最大数字加倍。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-07T04:54:13.593

**有符号变量**可以是 0、正数或负数。

**无符号变量**可以为 0 或正数。

有时会使用无符号变量，因为可以使用更多位来表示实际值。给你更大的范围。例如，您还可以确保不会将负值传递给您的函数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-15T17:52:58.930

unsigned 用于当你的值必须为正时，这里没有负值，如果有符号为 int 范围 -32768 到 +32767 如果无符号为 int 范围 0 到 65535

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-07T04:58:13.240

**无符号变量**是在内部没有数学符号（加号或减号）表示的变量，**只能存储“零”或正值**。假设无符号变量的大小为**n 位**，那么它可以表示 2^n (2 power n) 个值 - 0 到 (2^n -1)。另一方面，有符号变量会“丢失”一个用于表示符号的位，因此它可以存储从 -(2^(n-1) -1) 到 (2^(n-1)) 的值，包括零。因此，有**符号变量**可以存储**正值、负值和零**。

**PS：**
在内部，数学符号可以用一个补码形式，二进制补码形式或用符号位表示（例如：0 -> +，1-> -）
所有这些方法都有效地将可表示值的范围划分为n位（ 2^n) 分为正、负和零三部分。

这只是我的两分钱。

我希望这有帮助。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-06-22T11:12:10.170

这可能不是确切的定义，但我会给你一个例子：如果你要创建一个从系统时间获取的随机数，这里使用无符号变量是有益的，因为随机数的范围很大，因为有符号数给出正数和负数。由于系统时间不能为负，我们使用无符号变量（仅正数）并且我们有更广泛的随机数。

# ruby - 从 Ruby 程序中创建“哔”声的最简单方法是什么？

> ID：621299
> 
> 赞同：45
> 
> 时间：2009-03-07T04:21:58.413
> 
> 标签：ruby, beep

我正在制作一个小的 ruby​​ 命令行脚本，我想知道让程序发出哔声的最简单方法是什么。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-03-07T04:27:46.107

尝试打印响铃字符：

```
print "\a" 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-07-06T12:54:09.693

对于 Mac OS X：

```
system('say "beep"') 
```

出于某种原因，常规`print "\a"`对我来说并不总是有效（MBA，10.7.4）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-07T04:23:57.643

对于 Windows，请使用 win32-sound gem -[将声音添加到您的 Ruby 应用程序](http://rubyonwindows.blogspot.com/2007/05/adding-sound-to-your-ruby-apps.html)。

安装：

```
gem install win32-sound 
```

然后在红宝石中：

```
require 'win32/sound'
include Win32
...
Sound.beep(100, 500) 
```

对于非 Windows，看起来像这样可以工作：[如何发出哔声？](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/178032)

```
puts 7.chr 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-06T02:03:22.760

最简单的方法是`puts 7.chr`

这是一种自定义方式

```
require "Win32API"
Beep = Win32API.new("kernel32", "Beep", ["I", "I"], 'V')
def beep freq, duration
  Beep.call(freq, duration)
end 

beep 600, 400 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-02-04T19:25:24.483

尝试以下操作：

```
$stdout.beep 
```

# objective-c - 寻找更简单的 Objective-C 解决方案

> ID：621312
> 
> 赞同：2
> 
> 时间：2009-03-07T04:30:05.320
> 
> 标签：objective-c

也许更简单不是合适的词。简洁也可以。我很清楚 Objective-C 是一种冗长的语言。我只是想知道它是否必须像我在下面显示的解决方案中那样冗长。我对这门语言比较陌生。

这段代码根据每个字段生成一个高度可变的 UITableViewCell 来计算记录中每种类型字段的数量。我的问题不在于如何做到这一点——我已经弄清楚了——我只是想知道：在 Objective-C 中使用 NSDictionary 对象是否有一种更简单或更简洁的方法来做到这一点？这和使用 NSDictionary 一样简洁吗？也欢迎使用其他集合类型对象的解决方案。

这是我的 -PartsRecord.countFields 方法。我稍微简化了代码。

```
-(NSDictionary*) countFields {  
NSDictionary* dict = [[NSDictionary alloc] initWithObjectAndKeys:  
     @"s", [NSNumber numberWithUnsignedInt: [self.struts count]],  
     @"h", [NSNumber numberWithUnsignedInt: [self.headAssemblies count]],  
     @"l", (self.leftVent == nil) ?   [NSNumber numberWithUnsignedInt: 0] :  
                                      [NSNumber numberWithUnsignedInt: 1],  
     @"r", (self.rightVent == nil) ?  [NSNumber numberWithUnsignedInt: 0] :  
                                      [NSNumber numberWithUnsignedInt: 1],  
     nil ];  
return dict; 
```

}

上述代码中的任何错误都是转录错误，而不是代码中的实际错误。
TIA，
霍华德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T04:36:34.837

```
@"l", [NSNumber numberWithUnsignedInt: self.leftVent  ? 1 : 0],
@"r", [NSNumber numberWithUnsignedInt: self.rightVent ? 1 : 0], 
```

将其缩短 2 行

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T08:13:28.170

除非您打算键入数字，否则您的对象排序是错误的。它应该是对象然后是关键。

```
dict = [NSDictionary dictionaryWithObjectsAndKeys:
   [NSNumber numberWithUnsignedInt: [self.struts count]], @"s",
   [NSNumber numberWithUnsignedInt: [self.headAssemblies count]], @"h",
   [NSNumber numberWithUnsignedInt: self.leftVent  ? 1 : 0], @"l", 
   [NSNumber numberWithUnsignedInt: self.rightVent ? 1 : 0], @"r",
   nil ]; 
```

这样，调用`[dict objectForKey:@"s"]`将返回`[self.struts count]`数字对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T07:01:33.693

您也可以更改`[[NSDictionary alloc] initWithObjectsAndKeys:]`为`[NSDictionary dictionaryWithObjectsAndKeys:]`.

无论如何，这将是一个好主意，因为您的代码正在分配一个`NSDictionary`而不释放它。`-dictionaryWithObjectsAndKeys:`返回一个自动发布的字典。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T10:34:09.690

必须是字典吗？如果没有，也许诉诸一些简单的 C 可能更容易理解。

```
typedef struct {
    unsigned strutCount;
    unsigned headAssembliesCount;
    BOOL leftVent;
    BOOL rightVent;
} Fields;

- (void) countFields:(Fields *) fields
{
    fields->strutCount = [self.struts count];
    fields->headAssembliesCount = [self.headAssemblies count];
    fields->leftVent = (self.leftVent != nil);
    fields->rightVent = (self.rightVent != nil);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T07:02:02.587

`-[NSNumber numberWithInt: 0]`并且`-[NSNumber numberWithUnsignedInt: 0]`是相同的数字（事实上，在 Cocoa 的某些实现中，它们甚至可能是同一个对象）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-07T10:45:47.307

我认为使用宏可以简化打字并增加*可读性*

```
#define SET_KEY_NUMBER( _key, _value ) \
  [NSNumber numberWithUnsignedInt:_value], _key
#define SET_KEY_BOOL( _key, _bool ) \
  [NSNumber numberWithUnsignedInt: (_bool) ? 1 : 0], _key

-(NSDictionary*) countFields {  
    NSDictionary* dict = [NSDictionary dictionaryWithObjectsAndKeys: 
      SET_KEY_NUMBER( @"s", [self.struts count] ),
      SET_KEY_NUMBER( @"h", [self.headAssemblies count] ),
      SET_KEY_BOOL(   @"l", self.leftVent == nil ),
      SET_KEY_BOOL(   @"r", self. rightVent == nil ),
      nil ];  
    return dict;
} 
```

...并且@Matt Ball 是正确的，当返回一个对象时，它应该被*自动释放*

# python - 如何以原始语言打印 unicode 字符串的元组（不是 u'foo' 形式）

> ID：621321
> 
> 赞同：12
> 
> 时间：2009-03-07T04:44:52.820
> 
> 标签：python, unicode

我有一个 unicode 对象的元组列表：

```
>>> t = [('亀',), ('犬',)] 
```

打印出来，我得到：

```
>>> print t
[('\xe4\xba\x80',), ('\xe7\x8a\xac',)] 
```

我猜这是这些字符串的 utf-8 字节码表示的列表？

但我想看到打印出来的是，惊喜：

```
[('亀',), ('犬',)] 
```

但是我在将字节码恢复为人类可读的形式时遇到了很多麻烦。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T12:49:29.677

> 但我想看到打印出来的是，惊喜：
> 
> [('亀',), ('犬',)]

你想看到它打印在什么上面？因为如果是控制台，则根本不能保证您的控制台可以显示这些字符。这就是为什么 Python 的对象的 'repr()' 表示选择了 \-escapes 的安全选项，您将始终能够在屏幕上看到并轻松输入。

作为先决条件，您应该使用 Unicode 字符串 (u'')。而且，正如 Matthew 所提到的，如果您希望能够直接在源代码中编写 u'亀'，您需要确保 Python 可以读取文件的编码。对于偶尔使用非 ASCII 字符的情况，最好坚持使用转义版本 u'\u4e80'，但是当你有很多东亚文字你想能够阅读时，“#coding=utf-8”是绝对是要走的路。

> print '[%s]' % ', '.join([', '.join('(%s,)' % ', '.join(ti) for ti in t)])

这将打印用引号展开的字符。你真的想要：

```
def reprunicode(u):
    return repr(u).decode('raw_unicode_escape')

print u'[%s]' % u', '.join([u'(%s,)' % reprunicode(ti[0]) for ti in t]) 
```

这会起作用，但如果控制台不支持 Unicode（这在 Windows 上尤其麻烦），你会得到一个很大的旧 UnicodeError。

在任何情况下，这都不重要，因为对象的 repr()，也就是您在此处看到的，通常不会出现在应用程序的公共用户界面中。它真的只适用于编码器。

但是，您会很高兴知道 Python 3.0 的行为完全符合您的要求：

*   没有 'u' 前缀的普通 '' 字符串现在是 Unicode 字符串
*   repr() 逐字显示大多数 Unicode 字符
*   更好地支持 Windows 控制台中的 Unicode（如果您的环境不是 UTF-8，您仍然可以在 Unix 上获得 UnicodeError）

Python 3.0 有点新，并没有得到库的很好支持，但它可能更适合您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T12:45:51.510

首先，你的帖子有一点误解。如果您定义这样的列表：

```
>>> t = [('亀',), ('犬',)] 
```

...那些不是`unicode`你定义的，而是`str`s。如果你想有`unicode`类型，你必须`u`在字符前添加一个：

```
>>> t = [(u'亀',), (u'犬',)] 
```

但是让我们假设您实际上想要`str`s，而不是`unicode`s。主要问题是，`__str__`列表（或元组）的方法实际上等于它的`__repr__`方法（它返回一个字符串，在评估时将创建完全相同的对象）。因为`__repr__`方法应该与编码无关，所以字符串以尽可能安全的模式表示，即 ASCII 范围之外的每个字符都表示为十六进制字符（`\xe4`例如）。

不幸的是，据我所知，没有用于打印区域感知列表的库方法。您可以像这样使用几乎通用的函数：

```
def collection_str(collection):
    if isinstance(collection, list):
        brackets = '[%s]'
        single_add = ''
    elif isinstance(collection, tuple):
        brackets = '(%s)'
        single_add =','
    else:
        return str(collection)
    items = ', '.join([collection_str(x) for x in collection])
    if len(collection) == 1:
        items += single_add
    return brackets % items

>>> print collection_str(t)
[('亀',), ('犬',)] 
```

请注意，这不适用于所有可能的集合（例如集合和字典），但很容易扩展它来处理这些集合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T04:55:28.240

`\u`Python 源代码文件是严格的 ASCII 格式，因此除非指定编码，否则必须使用转义序列。参见[PEP 0263](http://www.python.org/dev/peps/pep-0263/)。

```
#!/usr/bin/python
# coding=utf-8
t = [u'亀', u'犬']
print t 
```

当您将数组传递给 时[`print`](http://docs.python.org/reference/simple_stmts.html#the-print-statement)，Python 使用 Python 的[字符串转换规则将对象转换为字符串](http://docs.python.org/reference/expressions.html#id4)。此类转换的输出是为 设计的`eval()`，这就是您看到这些`\u`序列的原因。这是一个基于 bobince 解决方案的解决方法。控制台必须接受 Unicode，否则将引发异常。

```
t = [(u'亀',), (u'犬',)]
print repr(t).decode('raw_unicode_escape') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T05:12:18.370

所以这似乎做我想要的：

```
print '[%s]' % ', '.join([', '.join('(%s,)' % ', '.join(ti) for ti in t)])

>>> t = [('亀',), ('犬',)]
>>> print t
[('\xe4\xba\x80',), ('\xe7\x8a\xac',)]
>>> print '[%s]' % ', '.join([', '.join('(%s,)' % ', '.join(ti) for ti in t)])
[(亀,), (犬,)] 
```

*当然*有更好的方法来做到这一点。

（但到目前为止，其他两个答案并没有导致原始字符串按需要打印出来）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T04:53:25.233

尝试：

```
import codecs, sys
sys.stdout = codecs.getwriter('utf8')(sys.stdout) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-11T21:23:08.953

似乎人们在这里缺少人们想要的东西。当我从元组打印 unicode 时，我只想摆脱 'u' '[' '(' 和引号。我们想要的是如下所示的函数。在搜索网络之后，这似乎是最干净的获取方式atomic displayable data. 如果数据不在元组或列表中，我认为不存在这个问题。

```
def Plain(self, U_String) :
          P_String = str(U_String)
          m=re.search("^\(\u?\'(.*)\'\,\)$", P_String)
          if (m) :  #Typical unicode
             P_String = m.group(1).decode("utf8")
          return P_String 
```

# java - 我已经下载了 Apache POI，但是当我尝试使用它时，我的代码无法编译

> ID：621323
> 
> 赞同：0
> 
> 时间：2009-03-07T04:46:09.137
> 
> 标签：java, apache-poi

我最近`poi-src-3.2-FINAL`从[poi.apache.org](http://poi.apache.org/download.html)下载。现在我不能写这些：

```
import org.apache.poi.poifs.filesystem.*;
import org.apache.poi.hwpf.*;
import org.apache.poi.hwpf.extractor.*; 
```

现在我不能使用 and 的`HWPFDocument`类`WordExtractor`。我只能

```
import org.apache.*; 
```

我忘记下载其他东西了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T04:53:45.733

“src”通常表示一个包*只*包含源代码，而不是编译的类。检查是否有可用的“bin”下载。

更新：二进制版本确实被命名为 poi - **bin** -3.2-FINAL，[这里有一个下载链接](http://www.signal42.com/mirrors/apache/poi/release/bin/poi-bin-3.2-FINAL-20081019.zip)。

# c# - 在列表视图中选择项目

> ID：621327
> 
> 赞同：0
> 
> 时间：2009-03-07T04:51:56.360
> 
> 标签：c#

我想在列表视图的一行中选择一个特定的子项。例如，如果该行包含 5 个子项，如果我单击第 3 个子项，它只会被选中。

我成功解决了这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T04:58:19.810

```
ListViewItem list;

for(int a=0;a<37;a++)
{
    list=new ListViewItem();
    list.UseItemStyleForSubItems=false;
    list.Text="vinoth";
    list.SubItems.Add("afdsdf");
    list.SubItems.Add("afddfdfdfdsdf");
    list.SubItems.Add("afdsdddsdf");
    listView1.Items.Add(list);
}

private void listView1_Click(object sender, System.EventArgs e)
{
    listView1.SelectedItems[0].SubItems[1].BackColor=Color.Red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T05:08:53.230

首先，您必须检测用户单击了哪个子项。

要实现这一点，请查看[此示例](http://www.syncfusion.com/faq/winforms/files/WForum_ListViewSubItem.zip)。基本上，它将遍历 ListViewItem 的子项集合，并查看鼠标指针是否在其中之一上。

稍后...检测到单击的子项...您可以将其更改为 ForeColor 和 Background 以将其显示为“已选择”。

为此，您必须将 ListViewItem 的`UseItemStyleForSubItems`属性设置为`false`。这将允许您将背景和其他属性设置为单个子项。

# vb.net - vb.net 中的 Unicode

> ID：621333
> 
> 赞同：-7
> 
> 时间：2009-03-07T04:55:47.240
> 
> 标签：vb.net, unicode, vb6

如何在 vb.net 中使用 vb6 中可用的 Unicode？
在 vb.net 中有任何等效的 vb6 Unicode 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T13:21:19.273

您是否使用 vbUnicode 将字节数组转换为字符串？像下面这样？

```
StrConv(ByteArray, vbUnicode) 
```

如果是这样，这是该功能的 .Net 等价物

```
Dim theString as String = System.Text.Encoding.Unicode.GetString(ByteArray) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T05:05:59.197

.NET（以及因此在 VB.NET 中）中的所有字符串都是 unicode。.NET 还具有以不同格式输出字符串的库（请参阅 System.Text.Encoding 类和相关类）。你到底想用 unicode 做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T05:05:19.370

VB 6 不支持 Unicode，至少不直接支持。有很多方法可以绕过它，但这是后方的皇家痛苦。如果你问 VB 6 是否支持像 VB.NET 这样的 unicode，答案是否定的。

相反，如果您问是否可以在 VB.NET 中使用代码页之类的东西，答案是间接肯定的，尽管我认为没有理由跳过这个圈子来支持全球化/本地化，因为范式已经发生了变化.

# ruby-on-rails - Rails 上的复选框

> ID：621340
> 
> 赞同：9
> 
> 时间：2009-03-07T05:04:32.557
> 
> 标签：ruby-on-rails, checkbox, webforms

在 Ruby on Rails 中制作与某个问题相关的复选框的正确方法是什么？目前我有：

```
<div class="form_row">
    <label for="features[]">Features:</label>
    <br><%= check_box_tag 'features[]', 'scenarios' %> Scenarios
    <br><%= check_box_tag 'features[]', 'role_profiles' %> Role profiles
    <br><%= check_box_tag 'features[]', 'private_messages' %> Private messages
    <br><%= check_box_tag 'features[]', 'chatrooms' %> Chatrooms
    <br><%= check_box_tag 'features[]', 'forums' %> Forums
    <br><%= check_box_tag 'features[]', 'news' %> News
    <br><%= check_box_tag 'features[]', 'polls' %> Polls
</div> 
```

我还希望能够自动检查以前选择的项目（如果重新加载了此表单）。我如何将参数加载到这些的默认值中？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-07T06:29:53.770

您正在查看以下内容：

```
<div class="form_row">
    <label for="features[]">Features:</label>
    <% [ 'scenarios', 'role_profiles', ... , 'polls' ].each do |feature| %>
      <br><%= check_box_tag 'features[]', feature,
              (params[:features] || {}).include?(feature) %>
      <%= feature.humanize %>
    <% end %>
</div> 
```

虽然如果你已经有一个`Feature`模型，一个`features`表和一个`has_many :features`关系，你可能想要这个：

```
<div class="form_row">
    <label for="feature_ids[]">Features:</label>
    <% for feature in Feature.find(:all) do %>
      <br><%= check_box_tag 'feature_ids[]', feature.id,
              @model.feature_ids.include?(feature.id) %>
      <%= feature.name.humanize %>
    <% end %>
</div> 
```

# symfony1 - Symfony 在哪里以及如何定义常量？

> ID：621341
> 
> 赞同：4
> 
> 时间：2009-03-07T05:04:49.030
> 
> 标签：symfony1

我在 symfony 中有一些我自己的常量，我需要让它们在整个应用程序中可用，在哪里最好地定义它们？

我尝试在目录`myapps\config\config.php`中以这种方式定义我的常量：

```
sfConfig::set('aaa', 'mya'); 
```

但是当我尝试访问常量时`myapps\apps\frontend\modules\login\actions\actions.class.php`，使用这个命令

```
sfConfig::get('aaa') 
```

我只是得到一个空值，表明它还没有被定义。

如何以及在哪里定义 symfony 常量，以便在整个项目中都可以访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T08:07:09.027

这就是我解决问题的方法：

将以下内容放入我的`myapp/apps/frontend/config/app.yml`：

```
all:
  .app_set:
    bpobackend:       me
    bpoRedirectScreen:    allow 
```

然后在 action 模块中，调用 var_dump 来检查值

```
var_dump(sfConfig::get('app_bpobackend')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T15:51:14.950

看起来您正在尝试将 symfony 1.0 样式配置与 symfony 1.1 或 1.2 一起使用。[所有 config.php 文件已在 1.1 中删除](http://www.symfony-project.org/installation/1_1/upgrade#config.php)。请参阅[配置文件概述](http://www.symfony-project.org/book/1_2/05-Configuring-Symfony#chapter_05_overview_of_the_configuration_files)以了解要使用的内容。并始终确保查看正确版本的文档（网址中的*1_2*（或您使用的任何版本））。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-21T06:09:10.627

我试图在 Symfony 1.0 的 config.php 中添加常量。

所以如果你想在 config.php 中添加常量变量，那么

```
sfConfig::add(array('SF_DEFAULT_DATEFORMAT' => 'dd-MM-yyyy')); 
```

这是我定义名称为“SF_DEFAULT_DATEFORMAT”的日期格式的代码...

所以你可以试试这个......

# language-agnostic - 我的信誉系统安全吗？

> ID：621344
> 
> 赞同：17
> 
> 时间：2009-03-07T05:05:56.093
> 
> 标签：language-agnostic, architecture

赏金：要获得赏金，要么告诉我如何玩这个系统，要么解释为什么你认为它不可能玩。

我正在为一个网站开发一个信誉系统，该系统允许您创建自己的各种博客、评论和收藏等。

我的目标是一个非常短的规则集，用户易于理解并且不能被“玩”。注意：当我写“答案”时，我指的是*对评论的答案*，相当于 Stack Overflow*对答案的评论*。

1.  要创建一个帐户，您需要一个 Mojo。没有它，您只能回答其他人的评论。
2.  拥有帐户后，您每天可以获得一个 Mojo。
3.  每天您只能发布与 Mojo 一样多的帖子和评论。您可以根据需要回答任意数量的评论。发帖时不会丢失 Mojo。
4.  您可以将一份 Mojo 给拥有较少的人，但每个人只能给予一次。
5.  或者，您可以燃烧一个 Mojo，以从拥有较少但仅一次的人那里拿走一个 Mojo。
6.  你不能让你的 Mojo 回来。

该网站应该是仅限邀请的，但非会员可以回答会员的评论，也许他们也可以开始自己的博客，我还不确定。这个想法是针对一个主要基于资历的系统，其中权力只能以非常有限的方式在用户之间转移，所以基本上没有办法夸大你的声誉（Mojo只会向下流动。）

给予和接受 Mojo 应该是一种将某人标记为朋友或敌人的行为。

我不希望 Mojo 本身成为人们成为社区一部分的动力。我希望他们用它来影响其他人在现场的行为方式。通过用你的 Mojo 烧掉某人，你可以有效地限制他们在网站上发布的内容。通过给某人 Mojo，您可以让他们表达更多。

我还计划增加获得额外 Mojo 的方法，例如“每日帖子”或“本周最喜欢的博客”竞赛，奖品约为 3-10 个 Mojo。但我的主要目标之一是避免通货膨胀。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-12T13:37:31.000

以下是您的设计的一些后果。这些可能是也可能不是您想要的，但我指出它们以便您了解它们。

*   一个非常安静的 Mojo 用户根本不会关心踩到一些脚趾，因为他们有大量的 Mojo 可以从中提取。这似乎与您限制负面行为的目标背道而驰。

*   同样，对您的网站完全没有贡献的用户仍然可以通过拥有一个帐户来获得 Mojo。但是，如果一个有价值的贡献者发布了一个社区不喜欢的非彩色帖子，那么他将被保持沉默，直到他有足够的 Mojo 再次发布。

*   如果有人有非常有价值的东西要贡献，他必须确保始终有“储备 Mojo”——也就是说，他必须确保他没有达到他的发布限制。如果他不这样做，他可能会失去说一些有用的话来为他赢得更多 Mojo 的机会。

*   人们积累 Mojo 的速度受到社区规模的限制。如果分发 Mojo 的人很少，很快他们就不能再分发 Mojo，因为没有人还没有从他们那里收到 Mojo。

*   最年长的用户将有效地成为一个不可战胜的阴谋集团，其想法可能会定义和塑造您的网站。由于您只能在其他人的 Mojo 比您少的情况下减少其他人的 Mojo，因此这些用户可以发表您的社区强烈反对的声明，并保持他们的 Mojo 评级不变。

*   一般来说，通过限制 Mojo 的供应，你创造了一个经济体系，在这个体系中，人们可能会更加犹豫是否参与讨论。他们将需要更仔细地权衡他们所说的话，因为如果他们得到太多负面的 Mojo，社区不喜欢的帖子可能会阻止他们进一步发言。

* * *

### 播放系统

> 要么告诉我如何玩这个系统，要么解释为什么你认为它不可能玩。

假设我们将“玩系统”定义为“以你不希望的方式人为地改变一个人 Mojo 的价值或数量”。我会说你的系统可以避免 Mojo 的人为*膨胀*，但代价是扼杀本来会发生的讨论。您必须能够做出以下保证：

*   *流动条件。*Mojo 只会“流下来”；排名较低的用户无法将 Mojo 转让给排名较高的用户。
*   *创作条件。*用户很难采取可以生成自己的 Mojo 的操作。此外，要么不可能创建新帐户，要么它们会受到如此沉重的惩罚，以至于没有人愿意这样做。

例如，如果你不能满足创建条件，那么恶意的早期用户就会简单地创建一个新账户大军。他们保留了一些这样的新账户，悄悄地积累 Mojo。然后，他们将它们用作“掩埋旅”，以吸干他们不同意的派系或想法的 Mojo。虽然他们这样做时会失去 Mojo，但只要他们每天不超过一个可恨的敌人成为杀手，埋葬旅的集体 Mojo 将保持不变。

这显然不是你想要的。

### 人为通货紧缩

但是，您的系统无法避免 Mojo 的人为*通货紧缩*。要了解原因，请假设用户流入您的网站以接受他们的邀请。想象一个拥有*k* Mojo 点数的用户 Mallory。因为 Mojo 只能向下流动，所以 Mojo 点数为*k*或更少的用户无法表达对 Mallory 的不同意见。只有拥有*k+1*或更多 Mojo 的用户才能这样做。

除非有足够多的用户使用*k+1*或更高的 Mojo，否则 Mallory 的恐怖统治将继续不受限制。事实上，如果马洛里是一个足够早的用户，可能没有任何用户有能力降低她的魔力。事实上，因为你人为地让 Mojo 变得稀缺，他们可能*不想*烧掉一个 Mojo 来表达他们的意见，因为每个 Mojo 点是多么宝贵——因为这也会削弱他们并使*他们的*意见更容易受到攻击。

简而言之，如果有足够多（甚至可能只有几个）Mallorys，您将沦为扮演交通警察并在 Mallorys 之后进行清理，而不是改善您的网站。该系统不能再进行自我监管。现在每一个魔精点都变得比以前更有价值了，因为人们会从马洛里之流的例子中看到，最好不要燃烧一个魔精来打开自己的攻击。因此，Mojo 通货紧缩。

这显然也不是你想要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T00:34:49.723

你的系统的缺陷在于它关注会员的时间长度，而不是贡献的质量。一个不做任何贡献的不活跃用户仅仅因为很久以前就加入了。

为什么要限制用户可以发布的内容数量？我建议一个简单的系统，让其他成员将帖子标记为“坏”（就像 SO）。一旦一定数量的成员（比如 5 个）都将帖子标记为“坏”，它就会被自动删除。有太多“坏”帖子的成员会被开除。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T15:03:48.390

我有一个很长的答案，但总结是：您的系统并没有摆脱不良用户，而只是延迟了他们造成伤害。

* * *

> ...不能被“玩”
> 
> 给予和接受 Mojo 应该是一种将某人标记为朋友或敌人的行为。
> 
> 我希望他们用它来影响其他人在现场的行为方式。

查看您的系统是否安全的唯一方法是*作恶*并玩弄它。Stackoverflow 上到处都是好人，但要回答这个问题，最好想想邪恶的想法。

/我穿着山羊胡

> 要创建一个帐户，您需要一个 Mojo。没有它，您只能回答其他人的评论。

嗨，我是瓦尔迪兹先生。我是个好人。以下是对您的评论的一些友好回答。

> 拥有帐户后，您每天可以获得一个 Mojo。
> 
> 您可以将一份 Mojo 给拥有较少的人，但每个人只能给予一次。

嘿，这是一个很酷的网站。我会邀请我的朋友过来的。

/me 创建虚拟帐户并给他们 Mojo。

嘿，这是一篇博文。你们有什么感想？

/me 登录虚拟帐户并疯狂发帖。

> 您只能发布与 Mojo 一样多的帖子和评论。
> 
> 您可以根据需要回答任意数量的评论。
> 
> 你不能让你的 Mojo 回来。

通过帖子或私人消息：哇，伙计，我离开了 Mojo。你能给我一些，这样我就可以回答[虚拟帐户#1]的帖子吗？他的帖子很棒，我得到了很好的回应，我认为他会喜欢的。

> “每日帖子”或“本周最喜欢的博客”竞赛，奖品约为 3-10 Mojo。

我会发一个帖子，让我的傻瓜给我投票。

10 天后，我会得到 mojo =（虚拟账户数量）* 10 +（被骗给我 Mojo 的用户数量）。

/me 将 Mojo 提供给进入燃烧狂欢的虚拟帐户。/me 洗手。

接下来会发生什么取决于您当前的社区。他们可能会开始反弹，或者他们可能会忽略我和我的假人，直到我们离开。

最坏的情况是他们会反击，你所有的计划和系统都会浪费掉。

最好的情况是他们足够成熟，不会招待坏人。**但是**，如果您当前的社区已经足够成熟，为什么还需要如此复杂的系统来鼓励人们变得友善？

* * *

我建议你应该花时间建立社区。在我看来，如果你想要一个好的社区，你应该花更多的时间在社区上，并帮助为其他人定下基调。

典型案例：StackOverflow 始于一个真正有兴趣帮助他人的程序员社区。我们有很强的社区意识，因为我们都有相同的兴趣。我们知道顶级用户不会滥用其版主的权力，因为我们在很长一段时间内明确地给予了他们我们的信任（与您使用时间和诡计对一个人的状态进行排名的系统形成对比）。最后，该网站的开发人员实际上通过每周播客发布问题和答案以及与我们“交谈”。

作为一个（假装）坏人，我没有勇气或资源来摧毁如此紧密的社区。

* * *

更新：

> 为了避免让人们创建多个帐户来提升他们的主帐户，您只能将 Mojo 提供给 Mojo*较少的人*（并且每个用户只能给另一个用户 Mojo 一次）。

同样的问题。我只会让主帐户将 Mojo 提供给虚拟帐户，直到我在不同帐户中获得几乎均匀的 Mojo。此外，通过创建更多的虚拟帐户可以轻松规避该规则。

> “每日邮报”之类的事情的评分是我还没有做的事情。

如果您希望我们对评分发表评论，请更新您的帖子，我们将更新我们的答案。但我的观点仍然没有改变，你只是在用创可贴解决错误的问题。

其他发帖人提到您的系统鼓励闲置帐户。从坏人的角度来看，我不想有一个闲置的帐户。我希望获得与社区认可的合法帐户一样多的帐户。当我最终决定攻击时，这将造成更大的伤害。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T19:24:28.167

这里有很多很好的答案，但我认为您正在寻找一种“游戏”系统的方式，这样无论用户多么强大，都无法限制您的行为方式。因此，这是我尝试以这种方式游戏系统。

必要的先决条件：有人邀请您访问该站点/给您一个 mojo，因为创建一个帐户需要一个 mojo。

然后，
我有我的一个 mojo 帐户。
每天，我都使用我的一个 mojo 创建一个新帐户（我“邀请”他们并给他们一个 mojo）。
然后每天，我使用我创建的帐户的 mojo 为我已经拥有的每个帐户创建另一个帐户（显然每天将每个帐户 Mojo 烧到零）。
IE 第 1 天 1
个帐户创建另一个帐户 - 所以我有 2 个
第 2 天 - 每个帐户创建另一个帐户 - 所以我有 4
第 3 天 - 8
第 4 天 - 16 个帐户
第 5 天 - 32 个帐户
第 6 天 - 64 个帐户
第 7 天 - 128 个帐户
第 8 天 - 256 个帐户
第 9 天 - 512 个帐户
第 10 天 - 1024 个帐户
第 11 天 - 2048 个帐户

我重复这些帐户，直到我有足够的帐户，即使是排名最高的用户也没有足够的魔力让我保持沉默 - 而不是通过增加我的个人魔力来竞争，我通过增加我的“团体”魔力来竞争 - 如果我发布了一些东西，你不喜欢我只是在我的数千个帐户中的另一个帐户下重新发布。我不会成为一只更大的恐龙，而是一群蚊子。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-07T05:20:40.003

它看起来不错，但请记住，一些用户最终会找到玩任何系统的方法。

希望您可以在公测后对您的信誉系统的有效性有一个模糊的概念。

所以这是关于安全的。

我在系统中看到的一个问题（可能是您设计它的方式）是，与 SO 或任何其他类似的社区站点不同，您需要消耗您的积分来为系统做出贡献，而不是为这些操作获得积分。

这一决定可能会损害网站内容的增长。用户会认为“我的积分很少，所以我会保留它，让我的声誉增长”。这意味着您当前的系统不会促进系统中内容的增长。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T14:42:17.787

> 拥有帐户后，您每天可以获得一个 Mojo。

我不知道，但无所事事获得报酬没有多大意义

总体而言，我会说您的系统将无法正常工作。声誉系统应该主要基于人们所做的（好或坏）事情，而不是人们拥有帐户的天数。

> Mojo 不是一种货币，它决定了您在其他用户中的地位。

这正是金钱的作用；）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-13T05:05:36.420

我可以看到你从哪里来，但只要你分发免费的 Mojo(s)，就可以玩弄系统。

但除此之外，您的系统还有一个您可能没有想到的副作用：

1.  您在 12 月 31 日启动该服务。
2.  `MrFirstUser`注册为您的第一个用户，然后是`MrSecondPlace`其他一些用户
3.  在接下来的几天里，还有一群人注册了用户
4.  1 月 3 日，从第一天开始，每个人都有 3 个 Mojo，其他人则更少。`MrFirstUser`写了一条评论，并`MrSecondPlace`给了他一个 Mojo（他们有相同数量的 Mojo，所以我认为他被允许这样做）。
5.  现在，`MrFirstUser`有 4 个 Mojo，其他人只有 3 个或更少。

现在，`MrFirstUser`正好有 ( `numberOfDaysRunning`+1) 个 Mojo，而且他再也无法得到，因为所有其他用户的 Mojo 太少，无法给他更多。他获得另一个 Mojo 的唯一方法*是*，如果用户 3 给了用户 4 1 个 Mojo，然后用户 4 给了 MrFirstUser 一个 Mojo。除此之外，它变得更加复杂：必须参与这个 Mojo 贡献的人类金字塔的其他用户数量呈指数级增长。

换句话说，我肯定会对系统做的第一件事就是尽可能多地以人工方式（机器人）创建第一天用户，或者至少确保在第一天创建我自己的帐户，因为那会让我成为一个自动的 Jon Skeet——因为没有人会比我高出 1 或 2 （只有奖品可以帮助他们）。

为了修复你的系统，我会做三件事：

*   不再有自动 Mojo；Mojo 仅通过点赞、礼物和特别奖品获得
*   允许将 Mojo 赠送给所有其他用户（如果必须有限制，请限制赠送金额，以便将不超过 Mojo 总数的 10% 赠送给一位用户）
*   保持系统仅邀请，并惩罚受邀者行为不端或获得太多反对票/'举报用户'的用户

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-12T22:58:12.577

据我了解，没有人能像第一天加入并且从未“燃烧”过任何东西的人那样拥有如此多的魔力。他甚至可以*什么都不*做，仍然在魔力榜上名列前茅。我不会把这个叫做声望，就像资历一样，和成就没有太大的关系。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-12T15:36:05.510

太复杂了。吻

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-15T02:28:08.523

你的信誉系统存在有什么好的理由吗？Joel Spolsky 的《[使用软件构建社区》](http://www.joelonsoftware.com/articles/BuildingCommunitieswithSo.html)提到，如果您希望您的用户参与进来，您不应该让事情变得困难。通过建立一个复杂的声誉系统，你是不是限制了你的社区太多？

> 在软件中，就像在架构中一样，设计决策对于开发或未能开发的社区类型同样重要。当你让事情变得简单时，人们会更频繁地这样做。当你把某件事变得困难时，人们就会不那么频繁地这样做。通过这种方式，您可以温和地鼓励人们以某些决定社区特征和质量的方式行事。会不会觉得亲切？有没有厚厚的谈话，一个充满有趣想法的知识分子的欧洲沙龙？还是这个地方空无一人，地上散落着几张脏兮兮的广告传单，没人愿​​意去捡？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-17T14:35:24.657

你的系统基本上是一个有反馈的人气竞赛，所以表达受欢迎的情绪会得到奖励，表达不受欢迎的情绪会受到惩罚。这将阻碍智能对话，并鼓励 Reddit 上围绕 Ron Paul 等问题出现的回音室效应。

此外，正如 Paul Graham 在最近的[一篇文章](http://www.paulgraham.com/hackernews.html#f2n)中指出的那样，笑话或口号比研究论文更容易理解和支持，因此您的系统鼓励简单的帖子。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-12T23:59:16.610

假设任何人一天最多可以发 15 个帖子——这已经很多了，但你只需要成为 2 周的会员，然后积累更多的魔力就没有意义了，因为你已经用尽了你可以做的事情它。

所以在这一点上，如果你得到更多，你不会太在意，你需要相当多的协调才能击倒某人。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-06-30T20:55:34.793

馅饼，我一直在考虑声誉算法（这就是我找到这个线程的方式）。

您必须在**现实世界**之后为您的声誉算法建模：

1）年长的人不一定更好或更有趣，或者应该有更多的声望点

2）非常年轻的人没有太多的名声，因为他们是新人，没有为社区做出任何贡献，他​​们可以获得声誉积分

3) 一个真正受人尊敬/有声望的人的意见/投票比某些乔·施莫的意见/投票更重要。

4）如果一群 Joe Schmos 帮派反对一个真正有声望的人，他们的联合暴民意见仍然不应该胜过这个人的意见

5）拥有很多钱（或魔力）并不意味着拥有更好的声誉得分（否则富人最终总是会战胜聪明人）。

6）与社区中更有信誉的成员交往会将他们的一些声誉果汁传递给他们的朋友和家人（这些朋友和家人贡献多少并不重要——他们很酷，只是因为他们认识或与某个很酷的人有关） .

**因此，我的结论是：**

1) 你不能根据年龄来增加声望分数

2）您可以“惩罚”非常年轻的帐户（与 Google Sandbox 相同），这至少可以解决创建多个帐户并立即投票赞成或反对的问题。在用户帐户“成熟”之前应该经过一段时间。甚至可能只有 24 小时。

3) 相同的操作（可能导致您或其他成员的声誉得分增加或减少）不能对所有成员都相同。声誉较高的会员的赞成票或反对票的价值应大于声誉低的会员，而声誉低的会员则相反。

4) 即使是一群平均声望分数远低于目标成员声望分数的成员，他们也不应该降低该成员的分数。尽管如果他们的平均声誉得分更接近，那将是有道理的，但在这种情况下，大众效应应该会引发我们可以称之为革命的东西。（尽管在历史上，革命并不总是对它们发生的社区带来好事）。

5) 声誉不能成为您网站的“货币”。其他东西可以，但不是声誉。

6）如果你有一个友谊的概念，那么与声誉更高的人成为朋友应该会自动将一些声誉传递给你。如果您与认识的人（至少在您的网站上）成为朋友，而不是与任何人和每个人成为朋友，这应该会发生。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-19T12:02:44.093

没有现实生活中的验证，没有任何信誉系统是安全的。如果可以邀请匿名的人，那么总是可以通过足够的努力和虚假的身份进行游戏。

您的目标应该是将此类游戏的成本提高到潜在收益之上，这取决于您的系统的用途。

你可以用来抑制权力增益的主要成本是迫使用户在你提高他们的地位之前做出积极评价的贡献。

你如何做到这一点，以及如何让他们难以利用现有身份将他们试图赋予权力的新身份的贡献错误地评为积极，这是系统的基本要素；并且应该利用现有的用户群来发现和惩罚虚假的误报。

您可以通过奖励占多数的人来利用博弈论。因此，如果 A 指责 B 评级错误，它会被突出显示，并且很多人可以对其进行投票。那些在最终获胜的选票上投下魔力的人，将其取回并提高可靠性的声誉（值得拥有一种以上的声誉），而少数人则失去三角形数量的魔力（第一次一个，第二个，下一个 3，下一个 6，下一个 10，依此类推）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-01T15:03:46.467

你的系统是不可能游戏的，因为一开始就不可能加入它。

您说用户需要一种魔力才能加入。如果他们还不是会员，他们如何获得这种魔力？

# jquery - Jquery：仅使用特定类更新下一个 div

> ID：621346
> 
> 赞同：1
> 
> 时间：2009-03-07T05:06:28.993
> 
> 标签：jquery

我有一个表单，每次更改菜单的值时都会提交一个 jQuery .ajax 事件。jQuery 函数在数据库中查询产品的价格，然后用结果更新一个带有“.price”类的 div。页面上有五个这样的表单，每个表单都有一个带有“.price”类的div

```
/* Variation Price Query */
$(".varSel").live("change", function(){
    var formdata = $(this).parents('form').serialize();
    $.ajax({
        type: "POST",
        url: "library/varPrice.php",
        data: formdata,
        success: function(html){
    $('.price').html(html);

      }
    });
}); 
```

我遇到的问题是该函数使用“.price”类更新所有div，而不仅仅是下一个div。我试过类似的东西：

```
$(this).next('div.price').html(html); 
```

但它没有返回任何东西。

以下是 html 表单的示例：

```
<form name='addToCart' id='addToCart7' action='cart.php?action=add' method='post'>
<ul class='vars' id='varlist_p7'>
    <li><label for="Size">Size</label> 
    <select id="Size" name="Size" class='varSel'>
        <option>
            1oz
        </option>

        <option>
            4oz
        </option>

        <option>
            8oz
        </option>
    </select>
    </li>

    <li>
        <div class='price'>
            $ 3.00
        </div>
    </li>

    <li><input type='submit' class='buynow' value=''></li>
</ul>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T05:17:00.480

由于 div.varSel 和 div.price 不是兄弟姐妹，因此您必须比 next() 更深入

```
$(this).parent().next("li:has(.price)").children(".price").html(html) 
```

应该管用

# database - 用于 sql server 的免费国家、城市数据库

> ID：621350
> 
> 赞同：23
> 
> 时间：2009-03-07T05:09:04.883
> 
> 标签：database, ip-geolocation, country, city

有没有人用过这个，我需要免费的国家，城市，sqlserver的IP数据库

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-07T06:29:10.700

我用过[http://www.maxmind.com/app/geolitecity](http://www.maxmind.com/app/geolitecity)。这是他们付费数据库的不太精确的版本。免费数据库声称“在 25 英里半径范围内，美国在国家层面上超过 99.5%，在城市层面上超过 79%”。[您可以在http://www.maxmind.com/app/geolite_city_accuracy](http://www.maxmind.com/app/geolite_city_accuracy)查看详细信息。

数据显示为包含起始 IP 块、结束 IP 块和位置的 CSV 文件。加载到 sqlserver 很容易。

除了可下载的 CSV 格式之外，C、C#、PHP、Java、Perl 和免费版本 GeoLite 中的 API 还具有 IPv6 版本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-01-13T13:18:09.183

[ipinfodb](http://ipinfodb.com/)为 MySQL 提供免费的地理位置数据。使用简单的数据库转换器，您可以将其放入不同的数据库中，因为表结构很简单。它们还提供 CSV 格式的数据，这将更容易导入到不同的数据库引擎。

数据基于 MaxMind 免费版，每月更新。如果您不想将数据存储在服务器中，它们还提供免费的 API。准确性不错，足以满足正常的网站使用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-07T05:21:01.487

如果您需要根据他们的 IP 地址找到当前用户的位置，那么您可以尝试使用 Google Geolocation API，特别是`google.loader.ClientLocation`.

查看 Google API 文档了解更多信息： [http ://code.google.com/apis/ajax/documentation/#ClientLocation](http://code.google.com/apis/ajax/documentation/#ClientLocation)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-26T06:43:35.073

您也可以从这里找到 Mysql 数据库...

[https://github.com/baraskar/Worlds-Country-State-and-City-Mysql-Database](https://github.com/baraskar/Worlds-Country-State-and-City-Mysql-Database)

建议随时欢迎...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-08T10:02:09.170

检查这个免费的世界城市数据库[http://www.sudostuff.com/world-cities-database-8.html](http://www.sudostuff.com/world-cities-database-8.html)

包括城市、地区和国家。

要下载的 MySQL 格式文件，包含三个表，国家、地区和城市。 **国家模式**

```
CREATE TABLE IF NOT EXISTS `country` (
`countryId` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
`code` VARCHAR(5) DEFAULT NULL,
`name` VARCHAR(150) DEFAULT NULL,
PRIMARY KEY (`countryId`)
) ENGINE=InnoDB;

INSERT INTO `country` (`countryId`, `code`, `name`) VALUES(1, 'ad', 'andorra');
INSERT INTO `country` (`countryId`, `code`, `name`) VALUES(2, 'ae', 'united arab emirates');
INSERT INTO `country` (`countryId`, `code`, `name`) VALUES(3, 'af', 'afghanistan');
INSERT INTO `country` (`countryId`, `code`, `name`) VALUES(4, 'ag', 'antigua and barbuda');
INSERT INTO `country` (`countryId`, `code`, `name`) VALUES(5, 'ai', 'anguilla'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-01T09:26:31.093

不完全适用于 SQL Server，而是适用于 MySQL，我建议您查看这个 GitHub 存储库：

[https://github.com/turalus/openDB](https://github.com/turalus/openDB)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-07-12T12:41:47.677

Geonames 是免费数据，但数据很多。您需要 DBA 来清理数据。但根据您的要求清理负载数据是一次性的工作。在 zip 解压后，我最终得到了 1.3 GB 的文件大小，并将这些数据加载到 DB 还需要一个功能强大的硬件。

maxmind 数据非常旧，他们已停止更新提供的免费数据

然后有许多付费数据源，但列出了我曾经使用过的来自[http://www.worldcitiesdatabase.com](http://www.worldcitiesdatabase.com)的世界城市数据库中成本最低且价格合理的数据源。

然后您也可以查看 maxmind 付费数据服务，但它们非常昂贵，除非您的预算非常好。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-07T14:10:35.143

看到这个

[http://www.flagip.com](http://www.flagip.com)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-07T00:16:23.027

在此处查看数据库 -

[http://myip.ms/info/cities_sql_database/World_Cities_SQL_Mysql_Database.html](http://myip.ms/info/cities_sql_database/World_Cities_SQL_Mysql_Database.html)

他们有 Microsoft Sql Server 的国家/城市数据库。这里代码 -

```
CREATE TABLE countries (
  countryID varchar(3) NOT NULL,
  countryName varchar(52) NOT NULL,
  localName varchar(45) NOT NULL,
  webCode varchar(2) NOT NULL,
  region varchar(26) NOT NULL,
  continent varchar(15) NOT NULL,
  latitude float NOT NULL,
  longitude float NOT NULL,
  surfaceArea float NOT NULL,
  population int NOT NULL,
  PRIMARY KEY (countryID),
  UNIQUE (webCode),
  UNIQUE (countryName)
);

CREATE TABLE cities (
  cityID int NOT NULL,
  cityName varchar(50) NOT NULL,
  stateID int NOT NULL,
  countryID varchar(3) NOT NULL,
  latitude float NOT NULL,
  longitude float NOT NULL,
  PRIMARY KEY (cityID),
  UNIQUE (countryID,stateID,cityID)
); 
```

# python - 如何在python中将列表从元素n切片到末尾？

> ID：621354
> 
> 赞同：66
> 
> 时间：2009-03-07T05:17:34.240
> 
> 标签：python, list, sequence, slice

我在弄清楚如何对 python 列表进行切片时遇到了一些麻烦，如下所示：

```
>>> test = range(10)
>>> test
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> test[3:-1]
[3, 4, 5, 6, 7, 8]
>>> test[3:0]
[]
>>> test[3:1]
[]
>>> test
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

据我了解，python slice 的意思是 lst[start:end]，包括 start，不包括 end。那么我将如何从元素 n 开始查找列表的“其余部分”？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-03-07T05:19:31.193

您可以通过不指定值使切片的一端保持打开状态。

```
test[3:] = [3, 4, 5, 6, 7, 8, 9]
test[:3] = [0, 1, 2] 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2009-03-07T08:15:31.380

如果您使用变量作为范围端点，则可以使用`None`.

```
 start = 4
 end = None
 test[start:end] 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-07T05:19:40.943

简单地省略结尾。

```
test[n:] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-01-28T16:14:17.953

当您想跳过某些内容时，省略结尾仍然有效：

```
range(10)[3::2] => [3, 5, 7, 9] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-07-17T03:52:18.007

切片时也可以使用*end*[**`None`**](https://docs.python.org/2/library/types.html#types.NoneType)参数的关键字。这也将返回直到列表末尾的元素（或任何*序列*，如元组、字符串等）

 **```
# for list
In [20]: list_ = list(range(10))    
In [21]: list_[3:None]
Out[21]: [3, 4, 5, 6, 7, 8, 9]

# for string
In [22]: string = 'mario'
In [23]: string[2:None]
Out[23]: 'rio'

# for tuple
In [24]: tuple_ = ('Rose', 'red', 'orange', 'pink', 23, [23, 'number'], 12.0)
In [25]: tuple_[3:None]
Out[25]: ('pink', 23, [23, 'number'], 12.0) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-29T13:22:34.510

在起始值之后返回列表的一部分：

```
list = ['a','b','c','d']
start_from = 'b' # value you want to start with
slice = list[list.index(start_from):] # returns slice from starting value to end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-30T22:35:47.497

您正在寻找的是使用类似的东西：

```
inputs = "ababbbaAab"
for i in range(n):
    print(i, inputs[:i] + inputs[i:i+1]) 
```

输出：

```
0 a
1 ab
2 aba
3 abab
4 ababb
5 ababbb
6 ababbba
7 ababbbaA
8 ababbbaAa
9 ababbbaAab 
```

看看如果`i == 0`

然后`inputs[:i] == []`和`inputs[i:i+1] == a`

而如果`i == len(inputs) - 1`

然后`inputs[:i] == [ababbbaAa]`和`inputs[i:i+1] == b`

# c - 未定义的 C 结构前向声明

> ID：621356
> 
> 赞同：20
> 
> 时间：2009-03-07T05:19:12.910
> 
> 标签：c, struct, declaration, forward

我有一个头文件 port.h、port.c 和我的 main.c

我收到以下错误：“ports”使用未定义的结构“port_t”

我想我已经在我的 .h 文件中声明了结构并且在 .c 文件中具有实际结构是可以的。

我需要前向声明，因为我想在我的 port.c 文件中隐藏一些数据。

在我的 port.h 中，我有以下内容：

```
/* port.h */
struct port_t; 
```

端口.c：

```
/* port.c */
#include "port.h"
struct port_t
{
    unsigned int port_id;
    char name;
}; 
```

主.c：

```
/* main.c */
#include <stdio.h>
#include "port.h"

int main(void)
{
struct port_t ports;

return 0;
} 
```

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-07T05:22:32.607

不幸的是，编译器在编译 main.c 时需要知道`port_t`（以字节为单位）的大小，因此您需要头文件中的完整类型定义。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-07T06:54:12.637

如果要隐藏`port_t`结构的内部数据，可以使用标准库如何处理`FILE`对象的技术。客户端代码只处理`FILE*`项目，所以他们不需要（实际上，然后通常不能）对`FILE`结构中的实际内容有任何了解。这种方法的缺点是客户端代码不能简单地将变量声明为该类型 - 它们只能具有指​​向它的指针，因此需要使用某些 API 来创建和销毁对象，以及对象的*所有*使用必须通过一些API。

这样做的好处是你有一个很好的干净的接口来说明如何`port_t`使用对象，并让你保持私有的东西私有（非私有的东西需要 getter/setter 函数让客户端访问它们）。

就像在 C 库中处理 FILE I/O 一样。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-07T14:25:00.710

我使用的一个常见解决方案：

```
/* port.h */
typedef struct port_t *port_p;

/* port.c */
#include "port.h"
struct port_t
{
    unsigned int port_id;
    char name;
}; 
```

您在函数接口中使用 port_p。您还需要在 port.h 中创建特殊的 malloc（和免费）包装器：

```
port_p portAlloc(/*perhaps some initialisation args */);
portFree(port_p); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T13:25:48.730

我会推荐一种不同的方式：

```
/* port.h */
#ifndef _PORT_H
#define _PORT_H
typedef struct /* Define the struct in the header */
{
    unsigned int port_id;
    char name;
}port_t;
void store_port_t(port_t);/*Prototype*/
#endif

/* port.c */
#include "port.h"
static port_t my_hidden_port; /* Here you can hide whatever you want */
void store_port_t(port_t hide_this)
{
    my_hidden_port = hide_this;
}

/* main.c */
#include <stdio.h>
#include "port.h"
int main(void)
{
    struct port_t ports;
    /* Hide the data with next function*/
    store_port_t(ports);
    return 0;
} 
```

在头文件中定义变量通常不好。

# flash - 你能推荐几个非常好的 Mac 版 AS3 和 MXML 编辑器吗？

> ID：621368
> 
> 赞同：1
> 
> 时间：2009-03-07T05:28:37.240
> 
> 标签：flash, actionscript-3, macos, editor, mxml

我刚刚从 Windows 切换到 Mac，需要找到一些工具来替换那些仅限 Windows 的工具。我对 FlashDevelop 最为熟悉，我已经使用了多年，但它仅适用于 Windows。SEPY 好像被抛弃了，FlashIDE 的编辑器好像很弱，我现在不想购买 FDT 或 FlexBuilder。

我想要一个在 AS3 和 MXML 的自动完成和语法高亮方面与 FlashDevelop 一样好的编辑器，是高度可定制的，因此可以配置为调用外部脚本和应用程序，例如 ant、javac、mxmlc 和 python自定义按钮或热键。此外，如果它是轻量级的，并且不太急于使用它自己的项目文件夹/管理（如 Eclipse/FlexBuilder/FDT），那就太好了。我通常只需要构建一个 AS3 文件或 MXML 文件，并且不喜欢项目设置时间或我自己的文件夹中堆满了项目元数据文件。

你能推荐几个非常好的 Mac 版 AS3 和 MXML 编辑器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T05:43:32.150

Textmate是你的人。超轻量级，通过大量可爱的插件和“捆绑包”（语法、自动完成、片段、宏、命令）无限定制。还有一个 AS3 捆绑包，它添加了 ant、mxmlc 等。为其制作自定义颜色突出显示也很有趣。它并不适合所有人——它绝对*是非常*轻量级的（不要指望 IDE），但如果你使用它一段时间，你就会明白为什么它是 mac 用户的最爱之一。

[http://macromates.com/](http://macromates.com/)

编辑：

Coda 是 Panic（Transmit FTP 的制造商，Mac 的事实上的 ftp 程序的制造商）的一款性感小应用程序，它将 css 编辑器、文本编辑器、终端窗口、FTP 等包装到一个选项卡面板应用程序中。我个人发现它在每个部门都过于精简，但如果它适合您的需求，它确实是一个很好的应用程序。我认识一些使用它并喜欢它的程序员和项目经理。

[http://www.panic.com/coda/](http://www.panic.com/coda/)

此外，Xcode（免费的 Mac 开发 IDE）可以很好地配置为与 AS3 一起使用。我最近一直在 Objective-C 中使用它进行开发，代码完成和提示非常出色。如果您可以通过 AS3 获得类似以下内容的效果，那可能会非常糟糕。

[http://blog.joshbuhler.com/xcodeflex/](http://blog.joshbuhler.com/xcodeflex/)

和

[http://opencode.forabettertoday.org/?p=3](http://opencode.forabettertoday.org/?p=3)

除此之外，在 FlashDevelop 出现在 Mac 之前，您的选择非常有限。我知道绝对不能使用 Flash 的编辑器！他们还不如将它包含在下一个 Flash 中！;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T22:00:01.807

FDT 毫无疑问。它是任何平台上最好的 AS 编辑器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T09:29:04.350

我推荐TextMate 2。以前的版本是付费应用，但这次它变成了**免费**的。您可以从 Bundles 设置中添加 AS3 功能。

# php - SQL - 插入并捕获 id 自动增量值

> ID：621369
> 
> 赞同：16
> 
> 时间：2009-03-07T05:29:07.583
> 
> 标签：php, sql, auto-increment

使用 SELECT 在同一 SQL 中获取 auto-id 值的最佳方法是什么？

一个论坛说 在 ASP 中的 SQL 代码末尾添加这个“ `; has Return Scope_Identity()`” 。

PHP中有对应的方法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-07T05:38:58.230

这取决于您的数据库服务器。使用 MySQL，[`mysql_insert_id()`](http://us2.php.net/mysql_insert_id)在插入查询后立即调用。使用 PostgreSQL，首先[`select nextval(seq)`](http://www.postgresql.org/docs/8.3/static/functions-sequence.html)在序列上查询 " " 并在插入查询中包含键。

`select max(id) + 1 from tbl`如果另一个请求同时插入一条记录，则查询“ ”可能会失败。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-20T22:04:50.527

在 postgres 中，最好的方法是执行以下操作：

```
insert into foos(name) values ('my_foo') returning id; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T17:03:13.873

这取决于您使用的数据库引擎。某些 DBMS，例如[Firebird](http://www.firebirdsql.org)，具有 RETURNING 子句，您可以将其添加到查询中。例如，如果您有一个名为 TABLE1 的表，其自动增量列名为 ID，则可以使用以下命令：

```
insert into TABLE1(columns...) values (values...) returning ID; 
```

它会像常规的选择语句一样返回插入的 ID。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-10T13:47:46.113

在 Microsoft Transact SQL 中，您可以使用 @@IDENTITY。

例如

```
DECLARE @Table TABLE ( col0 INT IDENTITY, col1 VARCHAR(255), col2 VARCHAR(255))

INSERT INTO @Table (col1, col2) VALUES ('Hello','World!')

SELECT @@Identity

SELECT * FROM @Table 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T05:32:52.597

在 php 中：mysql_insert_id() [http://us3.php.net/mysql_insert_id](http://us3.php.net/mysql_insert_id)

或者

如果你想从你的 mySql 选择查询中生成数字，你可以使用这个 **编辑：**

```
SELECT LAST_INSERT_ID(`1`) + 1 FROM table 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-10T13:44:55.353

要非常小心：显然 select nextval(seq) 在高并发下不起作用 - 在您插入的时间和调用 select nextval(seq) 的时间之间可以插入一些其他连接。始终在高并发测试工具中测试此类代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-10T13:51:44.517

在 SQL Server 中，使用 select 语句的插入可以有一个输出子句，该子句将返回标识值以及您可能需要识别哪个标识进入哪个记录的任何其他列。如果您正在使用 values 子句，则在插入后立即使用 select scope_identity()。

# ajax - 服务器和webbowser之间的异步通信

> ID：621384
> 
> 赞同：0
> 
> 时间：2009-03-07T05:43:54.643
> 
> 标签：ajax

服务器正在监视客户端 Web 浏览器中的事件...如果客户端 Web 浏览器中发生任何事件，则应通知服务器有关该事件并且服务器应响应该事件（例如在服务器本身中调用另一个 java 类）.. .请帮我写代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T05:49:15.910

`XMLHttpRequest`为调用适当 Java 类的相应方法的 URL构造一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T05:54:42.467

请参阅[jQuery](http://docs.jquery.com/Main_Page)作为入门。

# c# - 使用 findcontrol 从动态文字控件中查找值时遇到问题

> ID：621386
> 
> 赞同：0
> 
> 时间：2009-03-07T05:44:43.817
> 
> 标签：c#, asp.net

我在动态创建的文字控件中查找控件时遇到问题。我希望能够使用`fnameID(x)`id 获取标签中的值。

ASPX：

```
<div>
  <asp:Panel ID="Panel1" runat="server">
  </asp:Panel>
</div>
<asp:Button ID="Button1" runat="server" Text="Button" 
    onclick="Button1_Click" /> 
```

代码背后：

```
protected void Page_Load(object sender, EventArgs e)
{
    for (int i = 0; i < 50; i++)
    {
        CheckBox _checkbox = new CheckBox();
        _checkbox.ID = "dynamicCheckListBox" + Convert.ToString(i);
        Panel1.Controls.Add(_checkbox);
        Panel1.Controls.Add(new LiteralControl("<Label id='fnameID" 
            + i + "' >test" + i + "</Label><br/>"));
    }

}

protected void Button1_Click(object sender, EventArgs e)
{
    Label lbl = (Label)Panel1.FindControl("fnameID0");
    Response.Write(lbl.Text);
} 
```

目前，当我单击按钮时出现以下错误：

```
Object reference not set to an instance of an object.

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object. 
```

源错误：

```
{
Label lbl = (Label)Page.FindControl("fnameID0");
**Response.Write(lbl.Text);**
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T05:59:11.877

尝试显式设置您生成的控件的 ID：

```
protected void Page_Load(object sender, EventArgs e)
{
    for (int i = 0; i < 50; i++)
    {
        CheckBox _checkbox = new CheckBox();
        _checkbox.ID = "dynamicCheckListBox" + Convert.ToString(i);
        Panel1.Controls.Add(_checkbox);

        LiteralControl dynLabel = new LiteralControl("<Label id='fnameID" 
            + i + "' >test" + i + "</Label><br/>");
        dynLabel.ID = "fnameID" + i.ToString();

        Panel1.Controls.Add(dynLabel);
    }

} 
```

您收到 null 引用异常，因为没有找到具有指定 ID 的控件，因此`FindControl`正在返回`null`，并且您无法获取`Text`a 的属性`null`。

# iphone - 如何将触摸事件捕获到 UITableView 部分标题？

> ID：621389
> 
> 赞同：6
> 
> 时间：2009-03-07T05:47:43.637
> 
> 标签：iphone, cocoa-touch, uitableview

我已经为我的 UITableView 部分标题实现了一个自定义视图（通过 viewForHeaderInSection）。在普通视图模式下，默认行为似乎是单元格漂浮在节标题下方，而触摸事件则落入下方的单元格。

如何让自定义部分标题视图首先响应其边界内的任何触摸事件并采取一些措施，而不是将事件传递给部分标题视图下方的单元格？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-07T13:45:50.883

使用 UIControl 而不是 UIView

```
[aControl addTarget:<target> action: @selector(<desiredSelector:>) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-03T06:01:01.893

请参阅[http://developer.apple.com/library/ios/#samplecode/TableViewUpdates/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/TableViewUpdates/Introduction/Intro.html)它捕获点击事件并执行操作方法。它可能会帮助你。

# .net - 如何修复这个不支持转换为 sql 的 linq to sql 查询？

> ID：621394
> 
> 赞同：1
> 
> 时间：2009-03-07T05:49:55.583
> 
> 标签：.net, linq-to-sql

我最后有一个带有自定义扩展方法的 LinqToSql 查询。当我尝试 linq2sql 尝试生成 sql 语句时，此扩展方法出错。

### 错误：

> 方法 'System.Collections.Generic.IList `1[System.String] ToListIfNotNullOrEmpty[String](System.Collections.Generic.IEnumerable`1[System.String])' 不支持对 SQL 的转换。

### 扩展方法：

```
public static IList<T> ToListIfNotNullOrEmpty<T>(this IEnumerable<T> value)
{
    return value.IsNullOrEmpty()
               ? null
               : (value is IList<T> ? value as IList<T> : new List<T>(value));
} 
```

### 示例 Linq 到 sql 代码：

```
public IQueryable<Models.Post> GetPosts()
{
    var dataLoadOptions = new DataLoadOptions();
    dataLoadOptions.LoadWith<Post>(x => x.PostTags);
    dataLoadOptions.LoadWith<PostTag>(x => x.Tag);
    _sqlDatabase.LoadOptions = dataLoadOptions;

    return from p in _sqlDatabase.Posts
        select new Models.Post
        {
            PostId = p.PostId,

            CommentList = (from c in p.Comments
                select new Models.Comment
                {
                    PostId = c.PostId,
                    < ... stuff snipped ... >
                }).ToListIfNotNullOrEmpty(),

            < ... more stuff snipped ... >

            TagList = (from t in p.PostTags
                select t.Tag.Description).ToListIfNotNullOrEmpty(),
        };
} 
```

通常，我最后只有一个 ToList() 方法，但如果列表为空，我想返回一个空对象..因此我的扩展方法。

谁能建议我应该如何解决这个问题以使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T06:50:31.333

如果您使用扩展方法`IQueriable<T>`代替`IEnumerable<T>`您可以控制何时执行查询：

```
 public static IList<T> ToListIfNotNullOrEmpty<T>(this IQueryable<T> value)
    {
        var results = value.Provider.Execute<IEnumerable<T>>(value.Expression);
        return results == null || results .Count() == 0 
                   ? null
                   : results.ToList();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T09:29:44.377

你有没有试过这个：

```
return _postRepository.Comments.ToList().ToNullIfEmpty(); 
```

使用扩展方法：

```
public static IList<T> ToNullIfEmpty<T>(this List<T> value)
{
    return value.IsNullOrEmpty() ? null: value;
} 
```

问题是这一点：

```
TagList = (from t in p.PostTags
            select t.Tag.Description).ToListIfNotNullOrEmpty() 
```

如果你有这个，那么它会起作用：

```
select new Models.Post
    {
        ....
    }.ToList().ToNullIfEmpty(); 
```

或者您可以尝试更改扩展方法以扩展 IQueryable 作为其他评论者的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:17:52.597

我有同样的问题。问题是您不能在延迟的 linq2sql 表达式中使用扩展方法。这是因为`IQueryable`提供者在执行查询时试图将表达式树中的所有方法转换为 SQL。它无法区分您的方法和 linq2sql 原生的方法。因此问题。

解决方案是将方法添加到将扩展本机 linq2sql 类的部分类，而不是作为扩展方法。

**编辑：**我正在将建议的更改添加到代码中

```
public IQueryable<Models.Post> GetPosts()
{    
    var dataLoadOptions = new DataLoadOptions();
    dataLoadOptions.LoadWith<Post>(x => x.PostTags);
    dataLoadOptions.LoadWith<PostTag>(x => x.Tag);
    _sqlDatabase.LoadOptions = dataLoadOptions;

    return from p in _sqlDatabase.Posts
        select new Models.Post
        {
            PostId = p.PostId,
            CommentList = p.GetCommentList(),
            < ... more stuff snipped ... >
            TagList = (from t in p.PostTags
                select t.Tag.Description).ToListIfNotNullOrEmpty()
        };
} 
```

然后我会`GetCommentList()`在部分类中使用该方法

```
public partial class Post
{
     public List<Comment> GetCommentList()
     {
           List<Commment> resultList = from this.Comments etc...
           < ... put the select code here ... >
           if(resultList.Count > 0)
                return resultList;

           return null;
     }
} 
```

# air - Adobe Air 文件避免打开

> ID：621395
> 
> 赞同：3
> 
> 时间：2009-03-07T05:49:58.420
> 
> 标签：air, adobe

创建 adobe air 文件后，我可以使用 winrar 或任何其他存档程序打开它，并查看所有内容，包括我的程序代码。

有没有办法避免这种情况？某种加密还是什么？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T09:41:58.927

不，“.air”文件就像一个档案一样。XPS 文件。

问题是你为什么想要这样的东西？避免源共享？

如果您在共享源代码时遇到问题，为什么不使用将 javascript 代码放在服务器上并从客户端拉取它们。当然，这意味着当他们的网络或您的服务器出现故障时，它们将无法工作。

# javascript - IE.x 中的 Javascript“权限被拒绝”错误

> ID：621396
> 
> 赞同：0
> 
> 时间：2009-03-07T05:50:36.377
> 
> 标签：javascript, internet-explorer, https

我犯了一个错误，即创建了整个 Web 应用程序，而没有在 IE 上进行测试。我只在 Firefox 和 Safari 上测试过。该网络应用程序在 Safari 和 Firefox 上运行良好，但在 IE 上出现 Permission Denied 错误。

我正在使用 Google AuthSub 身份验证，因此对于使用 Google 帐户进行身份验证，它首先重定向以允许应用访问 Google 帐户。身份验证后，IE 将“http”更改为“https”。Firefox 或 Safari 都不会发生这种情况。他们仍然使用“http”协议。

IE 然后给出一个 Permission Denied 错误。JavaScript 是否以任何方式与“https”冲突？

该应用程序在这里-> [http://ankitahuja.com/apps/proxycal](http://ankitahuja.com/apps/proxycal)

并且导致错误的页面是-> [http://ankitahuja.com/apps/proxycal/proxycal.php](http://ankitahuja.com/apps/proxycal/proxycal.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T06:50:39.010

当我在 IE 和 FF 中打开 proxycal.php 页面时，在 Javascript（in 中`function _run`）的这一行上出现错误：

```
calendarService = new google.gdata.calendar.CalendarService('proxycal'); 
```

在这里，`calendar`不是 的成员`google.gdata`。

我建议您通过调用堆栈进行调试以找出未初始化的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-26T14:07:44.320

我之前在 IE 中遇到过这个错误。大多数情况下，这是因为我使用`XmlHttpRequest`. 检查 IE 的 Internet 选项中的“允许来自其他域的数据”设置，确保它被允许，然后查看是否出现相同的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-23T17:35:01.237

在 IE 中，您可以使用`XDomainRequest`，但不能用于来自 http 的 https，它被阻止，[这是预期的设计行为](https://connect.microsoft.com/IE/feedback/ViewFeedback.aspx?FeedbackID=333380)（尽管在 FF/Chrome 中不是预期的）

# css - 标签的CSS宽度

> ID：621401
> 
> 赞同：86
> 
> 时间：2009-03-07T05:55:59.343
> 
> 标签：css

我在模块标题中使用`<span>`标签，例如

`<span>Categories</span>.`

我在 css 中指定 span 的背景颜色/图像、宽度和高度。

但是跨度的宽度取决于它的内容/文本。

所以，如果我这样做`<span></span>`了，在 css 中只有一个背景图像/颜色，什么都不会出现。

当然，我想要一些东西出现。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-03-07T06:05:01.303

spans 默认为内联样式，您无法指定其宽度。

```
display: inline-block; 
```

会是个好方法，除了 IE 不支持

但是，您可以[破解多浏览器解决方案](http://homepage.ntlworld.com/spartanicus/ie_block_level_element_inline-block_hack.htm)

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2009-03-07T06:07:49.003

您可以将 display 属性显式设置为“block”，使其表现得像块级元素，但在这种情况下，您可能应该只使用 div 代替。

```
<span style="display:block; background-color:red; width:100px;"></span> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-07T06:02:41.323

您不能使用内联显示指定元素的宽度。您可以在其中放置一些东西，例如不间断空格 ( )，然后设置填充以使其具有更大的宽度，但您无法直接控制它。

您可以使用 display inline-block 但这并未得到广泛支持。

真正的技巧是将图像放入其中，然后设置其宽度。类似于透明的 1 像素 GIF。然而，这不是推荐的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-28T16:51:11.493

我会使用该`padding`属性。这将允许您在元素的任一侧添加一定数量的像素，而元素不会失去其跨度质量：

*   不会变成块
*   它会像你期望的那样浮动

但是，此方法只会添加到填充中，因此如果您更改内容的长度（例如，从类别更改为标签），内容的大小将发生变化，元素的整体大小也会发生变化。但是如果你真的想设置一个严格的尺寸，你应该按照上面提到的那样做，并使用一个div。

有关盒子模型、内容、填充、边距等的更多详细信息，请参见[盒子模型。](http://www.w3.org/TR/CSS2/box.html#box-dimensions)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-02-18T16:26:07.860

与其他答案一样，使用以下内容开始您的跨度属性：

```
display:inline-block; 
```

现在您可以使用比宽度更多的**填充：**

```
padding-left:6%;
padding-right:6%; 
```

当您使用填充时，您的颜色会扩展到**两侧**（右侧和左侧），而不仅仅是右侧（如宽度）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-07T06:07:34.323

使用属性“显示”，如示例中所示：

```
<span style="background: gray; width: 100px; display:block;">hello</span>
<span style="background: gray; width: 200px; display:block;">world</span> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-04T08:03:14.740

固定高度和宽度后，如果其中的文本溢出其区域，您应该告诉如何处理。所以在css中添加

溢出：自动；

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-07T13:41:41.627

你可以试试`width: fit-content`

来源：[https ://developer.mozilla.org/en-US/docs/Web/CSS/fit-content](https://developer.mozilla.org/en-US/docs/Web/CSS/fit-content)

# asp.net-mvc - ASP.Net MVC 的计划控制

> ID：621410
> 
> 赞同：9
> 
> 时间：2009-03-07T06:08:21.280
> 
> 标签：asp.net-mvc, components

是否有任何用于 ASP.Net MVC 的调度组件，无论是商业的还是其他的？我们公司目前使用 Infragistics WebSchedule 控件，但它们似乎不支持 MVC。

**编辑：** 我想我可能有点不清楚，我不是在寻找任务计划程序，而是在寻找网络日历/约会/计划管理框架或组件集。包含日历的月/周/日视图并允许我创建和显示约会项目的东西。

一个框架可以让我构建类似谷歌日历的东西，除了约会将存储在我的数据库中，而不是谷歌。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-31T03:27:45.443

我只是想用我们最终选择的调度工具进行更新。 [dhtmlxScheduler](http://www.dhtmlx.com/docs/products/dhtmlxScheduler/index.shtml) - 我们对工具和支持都非常满意。

另外 - 由于上面的任何答案中都没有提到它，Telerik 有一个与 ASP.Net MVC 兼容的调度工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T02:16:05.767

您可以尝试类似： [http ://www.daypilot.org/demo/Calendar/ResourcesView.aspx](http://www.daypilot.org/demo/Calendar/ResourcesView.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T22:01:00.680

我注意到 Web 表单可以在 MVC 应用程序中使用。

这使我能够将 Infagistics 计划组件用于 MVC 应用程序内部日历的周/月/日视图，即使 infragistics 组件与 MVC 不兼容。

在 MVC 解决方案中混合 Web 表单是一个丑陋的解决方案，但在这一点上看起来比尝试编写我自己的月/周/日视图约会日历 UI 更好。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-07T07:58:35.693

看看 Keyvan Nayyeri 的 Abidar 1.0：[http ://nayyeri.net/blog/abidar-1.0-beta-1/](http://nayyeri.net/blog/abidar-1.0-beta-1/)

# listview - 设置 ListView 的最大列数

> ID：621411
> 
> 赞同：0
> 
> 时间：2009-03-07T06:09:19.607
> 
> 标签：listview

我们如何修复特定 ListView 控件的最大列数？有没有这样的事情：

```
listViewControl.MaximumColumns = 3; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-06T19:32:18.697

我可以建议，从 ListView 类继承，然后在其中创建一个方法说

```
 public ListView.ColumnHeaderCollection Columns
    {
        get
        {
            throw new System.NotSupportedException();
        }
    }

    public void AddColumns(string _columnName1, string _columnName2)
    {
        base.Columns.Add(_columnName);
    } 
```

“隐藏” Columns 属性以及将添加限制为仅 2 列 - 不少于，不少于。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T06:13:38.490

如果您在谈论[Windows ListView 控件](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview(VS.80).aspx)，则最大值是您[添加](http://msdn.microsoft.com/en-us/library/s3dfa3sx(VS.80).aspx)到其中的列数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-27T22:30:43.200

您应该只将具有三个条目的信息传递到 ListView 的适配器中。例如，长度为 3 的数组。

```
Object[] sArray = {"", "", ""};
ArrayAdapter adp = new ArrayAdapter(this, android.R.layout.simple_list_item_1, sArray);
setListAdapter(adp); 
```

# c# - 修改引用类型参数的方法是否不好？

> ID：621414
> 
> 赞同：1
> 
> 时间：2009-03-07T06:15:58.267
> 
> 标签：c#, side-effects

我见过这样的方法：

```
public void Foo(List<string> list)
{
    list.Add("Bar");
} 
```

这是修改方法中的参数的好习惯吗？

这不是更好吗？

```
public List<string> Foo(List<string> list)
{
    // Edit
    List<string> newlist = new List<string>(list);
    newlist.Add("Bar");
    return newlist;
} 
```

感觉第一个例子有意想不到的副作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T06:20:23.403

在您给出的示例中，第一个对我来说似乎比第二个好得多。如果我看到一个接受列表并返回列表的方法，我的第一个假设是它正在返回一个新列表并且没有触及给定的列表。因此，第二种方法具有意想不到的副作用。

只要您的方法命名得当，修改参数就没有什么危险。考虑一下：

```
public void Fill<T>(IList<T> list)
{
    // add a bunch of items to list
} 
```

使用像“Fill”这样的名称，您可以非常确定该方法将修改列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T06:25:17.183

坦率地说，在这种情况下，两种方法或多或少都做同样的事情。两者都将修改`List`传入的内容。

如果目标是通过这种方法使列表不可变，则第二个示例应该复制`List`发送的列表，然后`Add`对新的列表执行操作`List`，然后返回。

我对 C# 和 .NET 都不熟悉，所以我的猜测是：

```
public List<string> Foo(List<string> list)
{
    List<string> newList = (List<string>)list.Clone();
    newList.Add("Bar");
    return newList;
} 
```

这样，调用该方法的`Foo`方法将得到新创建的`List`返回，而传入的原始`List`方法不会被触及。

这实际上取决于您的规范或 API 的“合同”，因此在`List`可以修改 s 的情况下，我认为使用第一种方法没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T06:20:51.780

您在这两种方法中都在做完全相同的事情，只是其中一种方法返回了相同的列表。

在我看来，这真的取决于你在做什么。只需确保您的文档清楚地说明正在发生的事情。如果您喜欢这种事情，请编写前置条件和后置条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T07:16:27.060

扩展方法的出现使得处理引入副作用的方法变得更加容易。例如，在您的示例中，说起来变得更加直观

```
public static class Extensions
{
  public static void AddBar(this List<string> list)
  {
     list.Add("Bar");
  }
} 
```

并调用它

```
mylist.AddBar(); 
```

这更清楚地表明列表正在发生某些事情。

正如评论中提到的，这对列表最有用，因为对列表的修改往往会更加混乱。在一个简单的对象上，我倾向于只修改对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T08:57:02.357

将列表作为参数的方法修改列表实际上并不意外。如果你想要一个只从列表中读取的方法，你会使用一个只允许读取的接口：

```
public int GetLongest(IEnumerable<string> list) {
    int len = 0;
    foreach (string s in list) {
        len = Math.Max(len, s.Length);
    }
    return len;
} 
```

通过使用这样的接口，您不仅可以禁止该方法更改列表，而且它还变得更加灵活，因为它可以使用任何实现该接口的集合，例如字符串数组。

其他一些语言有一个`const`关键字可以应用于参数以禁止方法更改它们。由于 .NET 具有可用于此目的的接口和不可变的字符串，因此实际上不需要`const`参数。

# c++ - 如何在 C++ 中获取文件？

> ID：621425
> 
> 赞同：2
> 
> 时间：2009-03-07T06:28:37.143
> 
> 标签：c++, file, io

所以老师布置了这个作业：

您已被联合网络执法司令部雇用，并且您已获得包含必须解密的空密码的文件。

因此，对于给出的第一个文件（例如），其他每个字母都是正确的（即：'hielqlpo' 是 hello（假设您从第一个字母开始）。我的第一个问题是，我如何读取文件？文档在我桌面上的一个文件夹中，文件名为 document01.cry。我不确定将文件放入程序所需的命令。

我也不太确定如何抓住一封信和跳过一封信，但老实说，我想在发布那个问题之前先修改一下！所以现在......我的问题如标题中所述：如何获取文件以在 C++ 中读取？

如果它有所作为（我确信它确实如此），我正在使用 Visual C++ 2008 Express Edition（因为它是免费的而且我喜欢它！我还附上了我目前拥有的东西，请记住它是 -非常基本......我`getchar();`在最后添加了，所以当它正常运行时，窗口保持打开状态，所以我可以看到它（因为 Visual Express 倾向于在运行完成后立即关闭窗口。）

到目前为止的代码：

```
#include<iostream>

using namespace std;

int main()
{
    while (! cin.eof())
    {
        int c = cin.get() ;
        cout.put(c) ;
    }
    getchar();
} 
```

PS：我意识到这段代码抓取并输出了每个字符。现在这很好，一旦我可以读取文件，我想我可以从那里修改它。我还在戳一两本关于 C++ 的书，看到它弹出并尖叫“选我！” 再次感谢！

编辑:: 也很好奇，有没有办法输入你想要的文件？（IE：

```
char filename;
cout << "Please make sure the document is in the same file as the program, thank you!" << endl << "Please input document name: " ;
cin >> filename;
cout << endl;
ifstream infile(filename, ios::in); 
```

此代码不起作用。它返回一个错误，说 char 不能转换为 const char *。如何解决这个问题？

编辑 2：不要介意所说的第 2 部分，我发现了！再次感谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-07T06:39:22.560

要进行文件操作，您需要正确的包括：

```
#include <fstream> 
```

然后，在您的 main 函数中，您可以打开一个文件流：

```
ifstream inFile( "filename.txt", ios::in ); 
```

或者，对于输出：

```
ofstream outFile( "filename.txt", ios::out ); 
```

然后，您可以像使用 cin 一样使用 inFile，也可以像使用 cout 一样使用 outFile。完成后关闭文件：

```
inFile.close();
outFile.close(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T06:51:53.047

[编辑] 包括对命令行参数的支持 [编辑] 修复了可能的内存泄漏 [编辑] 修复了缺少的引用

```
#include <fstream>
#include <iostream>

using namespace std;

int main(int argc, char *argv){
    ifstream infh;  // our file stream
    char *buffer;

    for(int c = 1; c < argc; c++){
        infh.open(argv[c]);

        //Error out if the file is not open
        if(!infh){
            cerr << "Could not open file: "<< argv[c] << endl;
            continue;
        }

        //Get the length of the file 
        infh.seekg(0, ios::end);
        int length = infh.tellg();

        //reset the file pointer to the beginning
        is.seekg(0, ios::beg);

        //Create our buffer
        buffer = new char[length];

        // Read the entire file into the buffer
        infd.read(buffer, length);

        //Cycle through the buffer, outputting every other char
        for(int i=0; i < length; i+= 2){
            cout << buffer[i]; 
        }
        infh.close();
    }
    //Clean up
    delete[] buffer;
    return 0;
} 
```

应该做的伎俩。如果文件非常大，您可能不应该将整个文件加载到缓冲区中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T07:50:08.693

我想到了！老实说，没有一个答案有帮助，这是三者的结合，加上他们的评论。非常感谢大家！我附上了我使用的代码以及文档的副本。程序读入每个字符，然后吐出解密的文本。（IE：1h.e0l/lqo 是你好）下一步（额外的功劳）是设置它，以便用户在读取下一个要输入的字符之前输入要跳过的字符数。

这一步我打算自己做，但再次感谢大家的帮助！再次证明这个网站有多棒，一次一行代码！

编辑:: 代码调整为接受用户输入，并允许在不重新编译的情况下多次使用（我意识到它看起来像一个大杂烩，但这就是为什么它被极度评论......因为在我看来它看起来很漂亮和整洁）

```
#include<iostream>
#include<fstream>   //used for reading/writing to files, ifstream could have been used, but used fstream for that 'just in case' feeling.
#include<string>    //needed for the filename.
#include<stdio.h>   //for goto statement

using namespace std;

int main()
{
    program:
    char choice;  //lets user choose whether to do another document or not.
    char letter;  //used to track each character in the document.
    int x = 1;    //first counter for tracking correct letter.
    int y = 1;    //second counter (1 is used instead of 0 for ease of reading, 1 being the "first character").
    int z;        //third counter (used as a check to see if the first two counters are equal).
    string filename;    //allows for user to input the filename they wish to use.
    cout << "Please make sure the document is in the same file as the program, thank you!" << endl << "Please input document name: " ;
    cin >> filename; //getline(cin, filename);
    cout << endl;
    cout << "'Every nth character is good', what number is n?: ";
    cin >> z;   //user inputs the number at which the character is good. IE: every 5th character is good, they would input 5.
    cout << endl;
    z = z - 1;  //by subtracting 1, you now have the number of characters you will be skipping, the one after those is the letter you want.
    ifstream infile(filename.c_str()); //gets the filename provided, see below for incorrect input.
    if(infile.is_open()) //checks to see if the file is opened.
    {
        while(!infile.eof())    //continues looping until the end of the file.
        {   
                infile.get(letter);  //gets the letters in the order that that they are in the file.
                if (x == y)          //checks to see if the counters match...
                {
                    x++;             //...if they do, adds 1 to the x counter.
                }
                else
                {
                    if((x - y) == z)            //for every nth character that is good, x - y = nth - 1.
                    {
                        cout << letter;         //...if they don't, that means that character is one you want, so it prints that character.
                        y = x;                  //sets both counters equal to restart the process of counting.
                    }
                    else                        //only used when more than every other letter is garbage, continues adding 1 to the first
                    {                           //counter until the first and second counters are equal.
                        x++;
                    }
                }
        }
        cout << endl << "Decryption complete...if unreadable, please check to see if your input key was correct then try again." << endl;
        infile.close();
        cout << "Do you wish to try again? Please press y then enter if yes (case senstive).";
        cin >> choice;
        if(choice == 'y')
        {
            goto program;
        }
    }
    else  //this prints out and program is skipped in case an incorrect file name is used.
    {
        cout << "Unable to open file, please make sure the filename is correct and that you typed in the extension" << endl;
        cout << "IE:" << "     filename.txt" << endl;
        cout << "You input: " << filename << endl;
        cout << "Do you wish to try again? Please press y then enter if yes (case senstive)." ;
        cin >> choice;
        if(choice == 'y')
        {
            goto program;
        }
    }
    getchar();  //because I use visual C++ express.
} 
```

编辑：：：

我尝试插入文本，但无法正确显示，它一直处理一些字符，如编码（即撇号显然相当于粗体命令），但你可以尝试输入“0h1e .l9lao" 不带括号到 .txt 中，它应该给出相同的结果。

再次感谢大家的帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T08:50:11.170

尽管您的问题已得到解答，但有两个小提示：1）您可以执行以下操作，而不是计算 x 和 y 来查看您是在奇数还是偶数字符上：

```
int count=0;
while(!infile.eof())
{       
    infile.get(letter);
    count++;
    if(count%2==0)
    {
        cout<<letter;
    }
} 
```

% 基本上意味着“除以时的余数”，所以 11%3 是二。在上面它给出了奇数或偶数。

2）假设您只需要在Windows上运行它：

```
system("pause"); 
```

将使窗口在完成运行后保持打开状态，因此您不需要最后一次 getchar() 调用（您可能必须这样`#include<Windows.h>`做才能工作）。

# c# - 从 C++ 到 C#

> ID：621432
> 
> 赞同：3
> 
> 时间：2009-03-07T06:38:25.060
> 
> 标签：c#, c++

什么是好的 C++ 到 C# 文章/教程或书籍？我正在阅读[http://msdn.microsoft.com/en-us/magazine/cc301520.aspx](http://msdn.microsoft.com/en-us/magazine/cc301520.aspx)并将阅读[http://andymcm.com/csharpfaq.htm](http://andymcm.com/csharpfaq.htm)和[http://www.ondotnet.com/pub/a /dotnet/2002/02/11/csharp_traps.html](http://www.ondotnet.com/pub/a/dotnet/2002/02/11/csharp_traps.html)之后。有没有人读过任何对编程有深刻理解的人的好书&& || C# 语言（和库）上的 C++？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T06:41:08.360

MSDN 绝对是查找有关 C# 信息的最佳位置。

我建议您遵循此处列出的 C# 教程：[MSDN 上的 C# 教程](http://msdn.microsoft.com/en-us/library/aa288436(VS.71).aspx)

在开始做 C# 之前，我也是一名 C++ 开发人员。这些教程将使您快速上手。

阅读有关 .NET 的信息。

另外，我忘了提到规范：

[MSDN 上的 C# 语言规范](http://msdn.microsoft.com/en-us/library/aa288436(VS.71).aspx)

值得一读，以便您了解 C# 和 C++ 之间一些不那么明显的区别（例如，结构是按值传递，而类是按引用传递），以及“out”、“ref”和其他的用法关键词。只是一个例子:)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T07:23:06.200

拥有来自 Microsoft（不是 ECMA）规范的 C# 语言来指导您进行 C++ 和 C# 之间的语法更改会很有帮助。

[在此处](http://download.microsoft.com/download/9/5/0/9503e33e-fde6-4aed-b5d0-ffe749822f1b/csharp%203.0%20specification.doc)下载 C# 3.0 版规范 (.doc)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T07:42:43.220

我目前正在阅读 Jon Skeet 的[C# in Depth](https://rads.stackoverflow.com/amzn/click/com/1933988363)。这是我见过的对 C# 2 和 3 的最佳处理。如果您是高级 C++ 程序员并且您对 C# 有一定的了解，那么这本书可以帮助您掌握 C# 能力。

Jon 提供了对 C# 演变的见解以及对各种新语言功能的见解。不仅是“如何”，还有“为什么”。同样，在阅读 C# 入门书籍后接近它。它没有涵盖许多其他 C# 书籍多次涵盖的基本内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T15:18:32.843

我将通过 C# 支持 CLR 的建议，毫无疑问，它是任何有能力的 C# 程序员都应该阅读的事实上的书籍之一。此外，它来自 C++ 背景，将回答您有关在托管环境中如何工作的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-07T08:23:18.163

我经常发现个人经验最能洞察语言差异。人们可以阅读所有关于一种新编程语言的理论，但如果没有经验，这并没有多大帮助。

我建议下载 Microsoft Visual C# Express Edition ( [http://www.microsoft.com/express/vcsharp/](http://www.microsoft.com/express/vcsharp/) ) 并使用一些简单的程序进行尝试。从“Hello World！”开始。并从那里开始工作。（我知道这可能很乏味，但它有助于用你不熟悉的语言打下坚实的基础）。一旦您对语言有了扎实的感觉，您应该能够将精力（和问题）集中在更具体的语言差异上。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-07T10:54:09.517

我向来自 C++ 和 Java 语言的程序员推荐[**Accelerated C# 书。**](https://rads.stackoverflow.com/amzn/click/com/1590598733)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-07T10:57:24.970

就我个人而言，当我必须学习 C# 时，我会在 C++ 术语中输入我要查找的内容的名称，然后添加 C#。例如：

标准::向量 C#

这给了我几页专门用于解释 C# 中的列表和其他类型的内容，它们与 C++ 中的确切代码一样。工作得相当好，即使对于 STL/模板库的一些较少使用的部分也是如此。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-07T13:13:56.950

如果您来自 C++，我认为最好的入门书籍是[CLR via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)。它将为您提供对 C# 的扎实介绍，同时让您适应 CLR 中的生活。对于具有扎实 C++ 背景的人来说，后者可能更像是一个绊脚石。

# sql - MS T-SQL 是否包含名为 varchar2 的数据类型？如果是这样，它和varchar之间有什么区别？

> ID：621439
> 
> 赞同：1
> 
> 时间：2009-03-07T06:46:33.043
> 
> 标签：sql, oracle

面试的时候问过这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-07T06:52:06.727

No. `varchar2`是 Oracle 数据类型，相当于它（以及 TSQL 的）自己的`varchar`.

*澄清*

`varchar`Oracle和Oracle 之间的区别`varchar2`似乎起源[于 ANSI SQL 标准仍在制定](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1395814400346605577)时。我无法找到任何明确的参考资料，说明最初的实现差异（如果有的话）是什么（Oracle 7 之前），因为这仍然[是混乱的根源](http://www.orafaq.com/faq/what_is_the_difference_between_varchar_varchar2_and_char_data_types)。[可以说，自Oracle 7](http://download.oracle.com/docs/cd/A57673_01/DOC/dcommon/oin/index.htm)以来，这两者实际上被视为同义词。两者都在版本 8 中进行了改进（最大大小从 2k 变为 4k）。请注意，TSQL`varchar`可以存储 8k。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T04:16:38.030

我从未听过 Vlad 的建议，即 VARCHAR 数据类型过去只支持 2k 的数据。鉴于它们在自 8.1.7 以来的每个版本中都是同义词（我没有检查早期版本的文档），这对我来说似乎很奇怪。弗拉德，你有这方面的参考吗？

来自[VARCHAR 数据类型的 SQL 参考部分](http://download-west.oracle.com/docs/cd/A87860_01/doc/server.817/a85397/sql_elem.htm#45719)

> VARCHAR 数据类型目前与 VARCHAR2 数据类型同义。Oracle 建议您使用 VARCHAR2 而不是 VARCHAR。将来，与不同的比较语义相比，VARCHAR 可能被定义为用于可变长度字符串的单独数据类型。

由于 Oracle 早于 SQL 标准，Oracle 中的某些比较语义与标准不匹配（例如比较 NULL 和空字符串）。理论上，Oracle 拥有 VARCHAR 数据类型，以便将来他们可以更改 VARCHAR 数据类型的比较语义以匹配 SQL 标准，而不会影响使用 VARCHAR2 数据类型的应用程序的向后兼容性。

# c# - 从 C# 应用程序调用 ASP.net Web 服务

> ID：621440
> 
> 赞同：9
> 
> 时间：2009-03-07T06:48:45.580
> 
> 标签：c#, asp.net, web-services, desktop, invoke

我有个问题。如何调用 Web 服务并从 C# 桌面应用程序获取结果。我正在制作一个桌面应用程序，我希望它能够连接到我的在线 ASP.net Web 服务。这怎么可能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-07T07:13:56.143

1.  在解决方案资源管理器中，右键单击您的项目节点并选择添加**服务**引用。
2.  输入您的服务 WSDL 所在的 URL。这通常是服务本身的 URL。
3.  这会在项目的新服务引用文件夹中生成一个强类型代理类。
4.  在您的桌面应用程序中编写代码以实例化代理类并在其上调用方法。其余的就像魔术​​一样工作。:)

AB Kolan 也是正确的，但 Add **Web** Reference 使用旧式 Web 服务框架，而 Add **Service** References 使用新的 WCF 堆栈。重要说明：服务本身**不需要**使用 WCF，您就可以在客户端使用 WCF。客户端上的 WCF 通常是任何服务的最佳选择，前提是您可以依赖 .NET 3.0 及更高版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-07T06:59:43.900

在您的桌面应用项目引用中添加对 Web 服务的 Web 引用。这样做会为 Web 服务生成一个名为 Reference.cs 的代理。您可以使用代理访问您的 Web 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T06:58:23.593

这可能与您从任何其他类型的应用程序访问 Web 服务的方式相同，无论是 ASP.NET 页面、类库还是 Windows 服务。

有关该主题的说明性教程，请参阅[从桌面应用程序访问 Web 服务](http://www.vbdotnetheaven.com/UploadFile/munnamax/dbService04162006080340AM/dbService.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-03T06:18:50.700

将获得有关如何创建 Web 服务和使用该服务的帮助：

[http://www.c-sharpcorner.com/UploadFile/0c1bb2/sumption-web-service-in-Asp-Net-web-application/](http://www.c-sharpcorner.com/UploadFile/0c1bb2/consuming-web-service-in-Asp-Net-web-application/)

谢谢

# sql - 汇总子树中数据的查询？

> ID：621441
> 
> 赞同：2
> 
> 时间：2009-03-07T06:49:47.153
> 
> 标签：sql, sqlite

我的数据自然适合树形。因此，我有一个简单的 SQL 表来存储数据：{id, parentid, data1, ..., dataN}

我希望能够“放大”数据并生成一份报告，总结当前分支下方的数据。也就是说，当站在根目录时，我想要所有数据的总和。当我沿着树的某个分支向下移动时，我只想获得仅为该节点及其子节点找到的数据的总和。

如何在 SQL 中编写这样的查询？

提前致谢！

/约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T07:00:55.193

由于`sqlite`不支持，除非您对数据使用[嵌套集或物化路径](http://www.rampant-books.com/art_vadim_nested_sets_sql_trees.htm)`CONNECT BY`，否则您将无法在单个查询中执行此计算。

或者，以“艰难的方式”执行并递归遍历您的树，从感兴趣的父节点开始对每个子节点进行一次查询。

另见：

*   [在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)
*   [递归层次结构：关系禁忌！](http://www.kamfonas.com/id3.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T16:41:09.230

Vlad 关于嵌套集的参考看起来不错。如果您想要更详细地涵盖树和层次结构的内容，那么您还可以查看[Joe Celko 的书](https://rads.stackoverflow.com/amzn/click/com/1558609202)。

“ID，ParentID”邻接列表模型实际上是查看关系数据库模型中的层次结构的“旧时代”方式。

# asp.net-mvc - 如何在实体框架中获取外键？

> ID：621455
> 
> 赞同：1
> 
> 时间：2009-03-07T06:58:40.860
> 
> 标签：asp.net-mvc, entity-framework

我正在.NET 3.5 SP1 MVC 应用程序中开发 StudentApp。

我有两张桌子

1.  课程
    CourseID, course_Name
2.  学生
    studentID, student_Name, courseID(fk)

现在我制作了StudentApp.dbml，它将两个表都作为实体。

由于外键不会出现在学生实体中，我无法在学生模型中显示 courseID，而且我无法生成添加、编辑、列表视图。

所以告诉我如何在学生中显示 courseID(fk)，我也想要课程名称。

还有下拉框显示课程名称和在编辑视图中存储课程 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:39:46.983

我很确定您必须为每个实体加载外部参考。因为我不知道你是如何构建你的 API 的，所以我将不得不给你一个伪代码的例子，但我认为这是你需要做的。

```
List<Students> studList = [your_db_facade].SelectStudents() // Or however you retrieve your students

foreach (Students singleStudent in studList)
    singleStudent.Context.CourseReference.Load() //CourseReference.Load() should be in the framework 
```

然后您从单个学生实体中获取 CourseID 和名称，例如

```
singleStudent.Course.CourseID
singleStudent.Course.course_Name 
```

它对您来说可能看起来略有不同，但我认为解决您的问题的关键是 CourseReference.Load()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T08:15:46.370

如果您使用 LINQ-to-SQL 并在 Visual Studio 中创建了一个 DBML 文件，则可以通过对象中的`Course`属性列出外键`Student`（自动生成，因为它是来自 的一对多关系`Student`）。有点像这样：

```
var studentCourseIds =
    from s in context.Students
    select s.Course.CourseID; 
```

由于您的目标是找到课程名称，因此它已经可以使用`Student.Course.course_Name`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T08:00:44.690

你能发布你的 DBML 吗？此外，DBML 用于 LINQ to SQL (L2S) - EDMX 是 ADO 实体框架中使用的映射。您使用的是 LINQ to SQL 还是实体框架 (EF)？

无论您使用哪一个 - 它们都支持外键，并且您将获得代表关系任一方的属性 - 您不需要做任何特殊的事情（当然，外键必须存在于数据库中）。

在 EF 中，外键称为“导航属性”，它们的工作方式与 L2S 中的外键略有不同。没什么大不了的，但是更新它们和“急切加载”有些不同。

只需将表格拖放到 Visual Studio 设计器中的地图上（如果您愿意，也可以使用命令行等效项生成）。

关于外键和下拉列表（以及其他 UI 优点）——我写了几篇关于一些可能适合您的方法的博客文章。一部分位于[此处](http://internationalized.spaces.live.com/blog/cns!43F3A7682D1564E4!1192.entry)，而第二部分位于[此处](http://internationalized.spaces.live.com/blog/cns!43F3A7682D1564E4!1216.entry)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T09:18:33.320

如果您在 SQL Server 数据库中创建正确的关系，那么当您将表添加到 DBML 设计器时，这些关系也将被复制，并且您的代码将自动链接。

# c# - 如何设置几个可视化C#项目的输出路径

> ID：621461
> 
> 赞同：33
> 
> 时间：2009-03-07T07:02:07.063
> 
> 标签：c#, visual-studio

我有一个包含多个 c# 项目的解决方案，我希望能够在一个地方一起设置所有项目的输出路径和其他属性。属性表 (vsprops) 似乎无法用于 C# 项目，并且 $(SolutionDir) 变量被忽略。是否有任何其他方法可以跨多个 C# 项目设置属性？

**更新** 按照 Bas Bossink 的答案中的信息，我能够通过创建一个通用 csproj 并将其导入到单个项目中来设置多个项目的输出路径。其他几点：

*   在 Visual Studio 中构建时，如果对公共项目进行了更改，则有必要触摸/重新加载任何引用它的项目以获取更改。
*   在单个项目中也设置的任何属性都将覆盖公共属性。
*   通过 Visual Studio UI 将 $(SolutionDir) 设置为输出路径无法按预期工作，因为该值被视为字符串文字，而不是被扩展。但是，使用文本编辑器将 $(SolutionDir) 直接设置到 csproj 文件中可以按预期工作。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-07T20:58:31.763

csproj 文件已经是一个 msbuild 文件，这意味着 csproj 文件也可以使用[此处](http://msdn.microsoft.com/en-us/library/92x05xfs.aspx)所述的导入元素。import 元素正是您所需要的。您可以创建一个包含以下内容的 Common.proj：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="3.5"xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
<PropertyGroup>
    <OutputPath>$(SolutionDir)output</OutputPath>
    <WarningLevel>4</WarningLevel>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
</PropertyGroup>
</Project> 
```

您可以在每个 csprojs 中导入这个 Common.proj，例如：

```
<Import Project="..\Common.proj" /> 
```

import 语句应该在任何依赖于 Common.proj 中定义的属性的任务之前

我希望这有帮助。我无法确认您使用过多次的 $(SolutionDir) 变量的问题。但是，我确实知道，当您通过命令行在解决方案中包含的特定项目上运行 msbuild 命令时，不会设置此变量。它将在您在 Visual Studio 中构建解决方案时设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T08:42:51.687

不幸的是，这些信息（例如输出路径）都存储在单独的 *.csproj 文件中。如果你想批量更新一大堆这些，你必须恢复到某种文本更新工具或创建一个脚本来触摸每个文件。

对于这样的事情（一次将更改应用到一堆文本文件），我个人使用Helios Software 的[WildEdit](http://www.textpad.com/products/wildedit/index.html) - 就像一个魅力，它的价格合理。

但我确信那里也有大量免费的替代品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T07:10:26.293

我建议您使用[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)或[NAnt](http://nant.sourceforge.net/)等构建工具，这将为您的构建提供更大的灵活性。基本上，这个想法是使用（在大多数情况下）单个可配置的构建文件来启动构建。

我个人会推荐 NAnt。

你可以在 JP Boodhoo 的博客上找到关于 NAnt 的精彩[教程](http://blog.jpboodhoo.com/NAntStarterSeries.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-19T17:29:27.863

`$(OutputPath)`在通用属性表中设置属性。然后在您希望它影响的所有项目文件中删除该条目。然后将该属性表导入您的所有项目。

对于数百个可能非常乏味的项目。这就是为什么我写了一个工具来帮助解决这个问题：

[https://github.com/chris1248/MsbuildRefactor](https://github.com/chris1248/MsbuildRefactor)

# virtual-machine - Hypervisor VM 有什么好处？

> ID：621463
> 
> 赞同：2
> 
> 时间：2009-03-07T07:05:29.457
> 
> 标签：virtual-machine, hypervisor

我正在研究使用虚拟机来托管多个操作系统，并且正在研究有很多免费解决方案。我对管理程序是什么以及为什么它们与“标准”虚拟机不同或更好感到困惑。当我的意思是标准时，我将使用基准虚拟机 VMWare Server 2.0。

对于具有 4 GB 内存的双核系统，最多可以运行 3 个虚拟机。哪个是最好的选择？管理程序或非管理程序，为什么？我已经阅读了 Wikipedia 文章，但技术细节超出了我的想象。我需要一个关于这些不同 VM 风格能为我做什么的基本答案。

**我的主要问题与我将如何在多个环境中进行测试有关。我担心操作系统的隔离，因此我可以同时在多个操作系统上测试应用程序。此外，哪种风味可以更近距离地体验真实机器的运行方式？**

我正在考虑以下几点：

（管理程序）

*   辛
*   超V

（非管理程序）

*   虚拟盒子
*   VMWare 服务器 2.0
*   虚拟电脑 2007

*我列出的虚拟机分类可能不正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T08:13:49.323

主要区别在于 Hyper-V 不运行在操作系统之上，而是与系统一起运行在称为管理程序的薄层之上。Hypervisor 是一种计算机硬件平台虚拟化软件，它允许多个操作系统同时在主机上运行。

许多其他虚拟化解决方案使用其他技术，如仿真。有关更多详细信息，请参阅[维基百科](http://en.wikipedia.org/wiki/Comparison_of_platform_virtual_machines#More_details)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-07T08:43:06.680

免责声明，以下所有内容（广泛）都是我的意见。

将虚拟机监视器（管理程序）视为一个非常小的微内核很有帮助。除了访问底层硬件之外，它几乎没有什么工作，例如监控事件通道和授予来宾域访问特定资源..同时执行某种调度程序。

所有来宾机器都完全不理会其他机器，隔离是真的。客人不与特权客人（或彼此）共享记忆。因此，在这种情况下，就 VMM 而言，您可以（大致）将每个客人（甚至是特权客人）视为一个进程。通常，第一个客人获得额外的特权，以便它可以管理其余的。这是虚拟机投入生产并向世界公开时使用的理想技术。

此外，可以对一些客户机进行修补以了解虚拟机管理程序，从而显着提高其性能。

另一方面，我们有诸如 VMWare 和 QEMU 之类的东西，它们依赖于主机内核来使其能够访问裸机和足够的内存来存在。他们假设所有客人都需要提供一台完整的机器，对呈现这些（或多或少）过程的限制成为虚拟机的限制。我说或多或少是因为设备映射器 QoS 并不常见。这是在其他操作系统或其他架构中尝试代码的理想解决方案。很多人将 QEMU、Simics 甚至有时 VMWare（取决于产品）称为“模拟器”。

对于生产推出，我使用 Xen，对于测试我刚刚交叉编译的东西，我使用 QEMU、Simics 或 VirtualBox。

如果您只是在各种操作系统和架构上测试/滚动新代码，我强烈推荐#2。如果您的需要是自省（即，当坏程序在客户机中运行时观察客户机内存变化）......在回答之前我需要更多解释。

# c# - LINQ 中的动态查询

> ID：621466
> 
> 赞同：2
> 
> 时间：2009-03-07T07:12:40.330
> 
> 标签：c#, linq

如果我说包含字段的 Customer 类，我该如何为 Linq 编写动态查询：

```
string name
string address
int phoneno 
```

我必须根据给出的类似信息进行查询

```
query = string.Empty;

if(!string.IsNullorEmpty(name))
{
   query += "@name = name";
}

if(!string.IsNullorEmpty(address))
{
   query += "@address = address";
}

if(!string.IsNullorEmpty(phoneno))
{
   query += "@phoneno = phoneno";
}

var result = from condition in customer
    where(query)
    select condition; 
```

**编辑＃1：**

这些项目在运行时是可变的，比如

```
private Customer[] GetCustomers(Dictionary<string,string> attributes)
{
   here the attribute may be, name alone, or name and address, or name address and phoneno

      foreach(string field in attributes.key)
      {
           query += field == attributes[key];

      }

         Customers[] =ExecuteQuery(query);

} 
```

LINQ 是否支持这种查询？

**编辑#2：**

嗨 Mouk，
由于我是 C# 新手，我仍在苦苦挣扎，这对我不起作用。

```
var query = _ConfigFile.ConnectionMasterSection;

for(int i = 0; i < filter.count; i++)
{
    query = result.Where(p => typeof(ConnectionMaster).GetProperty(filter[i].Attribute).Name == filter[i].Value);
} 
```

这会产生空，当我使用它时

```
var query = _ConfigFile.ConnectionMasterSection;

//Hard coded
res.Where(q => q.category == filter[0].Value); 
```

它按我的预期工作。

嗨 Bryan Watts，
我也尝试了您的代码，但收到此错误：“Lambda 参数不在范围内”。

```
for(int i = 0; i < filter.count; i++)
{
    Field item = filter[i];

    MemberExpression param = Expression.MakeMemberAccess(Expression.Parameter(typeof(Connection), "p"), typeof(Connection).GetProperty(item.Attribute));

    MemberExpression constant = Expression.MakeMemberAccess(Expression.Constant(item), typeof(Field).GetProperty("Value"));
}

try
{
    var myquery = Queryable.Where(coll, Expression.Lambda<Func<Connection, bool>>(
    Expression.Equal(param, constant), Expression.Parameter(typeof(Connection),"p")));
} 
```

这里有什么错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T07:17:26.433

看看这个[http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)，它允许强类型的谓词构建，它真的很好。如果您想要实际动态字符串构建的谓词，则可以使用 ScottGu 提供的[LINQ 动态查询库](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。

两者都将完成您想要的，尽管我会在第二个之前推荐第一个选项。

允许您执行以下操作：

```
var predicate = PredicateBuilder.True<MyLinqType>();

if(!string.IsNullOrEmpty(name))
    predicate = predicate.And(p => p.name == name);

...

var myResults = Context.MyLinTypeQueryTable.Where(predicate); 
```

和更多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T07:18:04.327

干得好：

```
var result = from customer in Customers
             where string.IsNullOrEmpty(phoneNo) || customer.PhoneNo == phoneNo
             where string.IsNullOrEmpty(address) || customer.Address == address
             select customer; 
```

如果您担心这会在下面生成最佳 SQL 查询，那么您应该像往常一样附加一个 SQL 查询分析器并进行检查。但我相信 Linq To Sql 中的表达式解析器会根据参数的值适当地折叠 where 子句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T14:57:01.757

我对[Dynamic LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)有很好的经验。

我将它用于可以在服务器端进行过滤和排序的丰富 HTML 表格。服务器接收包含请求参数的请求，其中键是属性的名称（例如“姓氏”），值是需要对属性进行排序的值（例如“史密斯”）。使用该信息，我构建了一个查询字符串，并将其传递给 Dynamic LINQ 的`Where`方法。

粗略地说，您可以想到以下内容：

```
public static IQueryable<T> Filter<T>(this IQueryable<T> query, Dictionary<string, string> dictionary)
{
    Type t = typeof(T);
    StringBuilder sb = new StringBuilder();
        PropertyInfo[] properties = t.GetProperties();
        foreach(string key in dictionary.Keys)
        {
            PropertyInfo property = properties.Where(p => p.Name == key).SingleOrDefault();
            if(property != null)
            {
                if (sb.Length > 0) sb.Append(" && ");

                string value = dictionary[key];

                sb.Append(string.Format(@"{0}.ToString().Contains(""{1}"")", key, value));
            }
        }

        if (sb.Length > 0)
        return query.Where(sb.ToString());
    else
            return query;
} 
```

该代码不在我的脑海中，因此未经测试。

当然，这是最基本的版本：它做一个简单的字符串比较。如果您想要进行数值比较（例如，您想要 UserID 正好是 100，而不是`UserID.ToString().Contains("100")`），或者查询嵌套属性（`Customer.Company.CompanyAddress`例如），或者查询集合，这会变得更加复杂。您还应该考虑安全性：虽然动态 LINQ 不易受到 SQL 注入的攻击，但您不应该让它盲目地解析所有用户输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T08:16:40.923

您可以使用流利的界面并为每个条件添加一个新的 Where 子句。就像是：

```
 var result = from cus in customers select cus;
 if(!string.IsNullOrEmpty(name))
         result= result.Where(p => p.Name == name); 
```

根据hte评论编辑：

如果您正在查询内存中的集合，则可以使用反射检索属性。

```
private Customer[] GetCustomers(Dictionary<string,string> attributes)
{
      var result = from cus in customers select cus;    

      foreach(string key in attributes.Keys)
             result= result.Where(p => GetProperty(p, key )== attributes[key]);

         return result.ToList();    
} 
```

假设 GetProperty 通过反射检索属性。

使用 Linq2Sql，此方法将导致检索所有记录，然后使用反射对其进行迭代。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T09:37:28.657

听起来您需要动态组合查询。

请参阅[我](https://stackoverflow.com/questions/497121/building-dynamic-linq-queries-based-on-combobox-value/497718#497718)对[这个问题](https://stackoverflow.com/questions/497121/building-dynamic-linq-queries-based-on-combobox-value/)的回答。

它解释了`IQueryable<T>`编译器如何组成对 an 的查询，以及如何添加动态元素。

**编辑**

下面是一个示例，说明如何`Where`在 之上动态构建一组条件`IQueryable<Customer>`：

```
// This method ANDs equality expressions for each property, like so:
//
// customers.Where(c => c.Property1 == value1 && c.Property2 == value2 && ...);

private IQueryable<Customer> FilterQuery(IQueryable<Customer> customers, IDictionary<string, string> filter)
{
    var parameter = Expression.Parameter(typeof(Customer), "c");
    Expression filterExpression = null;

    foreach(var filterItem in filter)
    {
        var property = typeof(Customer).GetProperty(filterItem.Key);
        var propertyAccess = Expression.MakeMemberAccess(parameter, property);
        var equality = Expression.Equal(propertyAccess, Expression.Constant(filterItem.Value));

        if(filterExpression == null)
        {
            filterExpression = equality;
        }
        else
        {
            filterExpression = Expression.And(filterExpression, equality);
        }
    }

    if(filterExpression != null)
    {
        var whereBody = Expression.Lambda<Func<Customer, bool>>(filterExpression, parameter);

        customers = customers.Where(whereBody);
    }

    return customers;
} 
```

# installation - 向 WiX 生成的 MSI 添加摘要信息

> ID：621470
> 
> 赞同：6
> 
> 时间：2009-03-07T07:17:30.723
> 
> 标签：installation, wix, windows-installer, wix3

如何向 WiX 生成的 MSI 文件添加（或更改默认值）摘要页面信息？

摘要页是在 Windows 资源管理器中右键单击 MSI 文件可见的选项卡页，包括以下文本字段：

标题、主题、作者、类别、关键字、评论

[替代文字 http://img151.imagevenue.com/img.php?image=13824_msi_summary_122_495lo.jpg](http://img151.imagevenue.com/img.php?image=13824_msi_summary_122_495lo.jpg)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-12-08T21:39:57.587

除了@Stefan 的回答，这里是 Wix 项目到 msi 详细信息属性的映射。根本没有找到设置“类别”属性的方法。 ![在此处输入图像描述](https://i.stack.imgur.com/R4L6X.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-07T08:33:33.300

该信息在`<Package>`元素中设置，例如：

```
<Wix xmlns='http://schemas.microsoft.com/wix/2003/01/wi'>
  <Product
  UpgradeCode="SOMEGUID-XXXX-XXXX-XXXX-XXXXXXXXXXXX"  
  Name='MyApp' 
  Id='????????-????-????-????-????????????'
  Language='1033' 
  Codepage='1252' 
  Version='1.0.0' 
  Manufacturer='MyCompany'>
    <Package
    Id="*"
    Keywords="keyword1, keyword2, keyword3"
    Description="summary of application"
    Comments="some comments"
    Manufacturer="mycompany"
    InstallerVersion="300"
    Languages="1033"
    Compressed="yes"
    SummaryCodepage="1252"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T23:44:34.530

设置 MSI 的摘要信息的另一种方法是使用[Msiinfo.exe](http://msdn.microsoft.com/en-us/library/aa370310.aspx)实用程序。我们在构建系统中使用它来设置一些在生成 MSI 文件时无法设置的值（在构建后步骤中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-13T16:27:39.110

如果您需要在创建 MSI*后*设置信息，您还可以使用Windows SDK 中的[Orca](http://msdn.microsoft.com/en-us/library/aa370557%28VS.85%29.aspx)编辑摘要信息。要安装它，首先安装 Windows SDK，然后从 C:\Program Files\Microsoft SDKs\Windows\v7.0\Bin\orca.msi 的 MSI 文件安装 Orca。通过*View -> Summary Information...*设置信息。

# iphone - 在按钮操作中冻结应用程序

> ID：621472
> 
> 赞同：0
> 
> 时间：2009-03-07T07:18:42.967
> 
> 标签：iphone, cocos2d-iphone

我使用 cocos2d 做一个游戏应用程序。在这个应用程序中，两个游戏被包含在一起。玩游戏时，我包含一个用于切换游戏的动作。当我使用此按钮两到三次更改游戏但之后游戏冻结并且在游戏关闭游戏之前不再工作。如果有人有解决方案，请给我一些信息，告诉我如何克服这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T08:13:19.840

你确定你在切换游戏时没有内存泄漏问题吗？

用这么少的信息很难正确诊断，但我的猜测是切换过程没有正确完成，几次后一些内存/变量被破坏

# domain-driven-design - 关于领域建模的建议

> ID：621473
> 
> 赞同：1
> 
> 时间：2009-03-07T07:19:48.283
> 
> 标签：domain-driven-design

这里是 DDD 的新手，并且有一个架构问题，这应该是一个典型的问题。

我有一个 StockItem 实体和一个 Store 实体。我将一个 StockItem 分配给多个商店，并为每个商店设置不同的 ParLevel。然后我需要进行交易（销售、购买、转入等）来调整各个商店的手头数量。

对此解决方案建模的首选方法是什么？在我的数据库中，我将有以下简化的表结构： **[StockItem]** StockItemID pk, Name

**[商店]** StoreID pk，名称

**[Store_StockItem]** StoreStockItemID pk、StoreID fk、StockItemID fk、ParlLevel、QuantityOnHand

**[StockItemTransaction]** StockItemTransactionID pk，StockItemStoreID fk，StockItemTransactionTypeID fk，数量

非常感谢任何建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T07:25:19.923

我不认为这里的任何人都可以真正给你想要的答案，因为领域驱动设计的重点是你自己的特定业务领域应该指导对象模型。

我要提供的唯一一条建议是，当您在域上工作时，您不应该担心数据库如何模拟这些关系。您应该根据规范化规则对您的数据库进行规范化，并根据实际业务领域创建您的领域模型。

请记住，数据模型和域模型不会以 1:1 的方式相互映射。

# checkbox - 拖动复选框列表有用吗？

> ID：621476
> 
> 赞同：1
> 
> 时间：2009-03-07T07:21:41.913
> 
> 标签：checkbox, usability, multi-select

不久前，我创建了一个拖放复选框列表，它允许您以一个手势检查多个复选框。你认为它在人们可能不知道如何使用它的网络上是可行和可用的。默认行为仍然适用于各个复选框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T07:39:04.510

该演示肯定需要一些增强功能以​​使其更加有用（尽管我不确定它是否足够）：

1.  允许拖动从不是复选框的地方开始。
2.  也允许通过拖动标签进行选择。

此问题似乎类似于在 Windows 资源管理器等文件资源管理器中选择多个文件的操作。也许它可以像通过在要选择的项目周围拖动一个矩形形状来选择多个文件的动作一样工作（选择一个角，拖动到另一个角）？这具有类似于人们可能已经熟悉的界面元素的优点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T08:04:13.717

**1 - 想法**

这个想法很好，可能可以用于您与用户直接接触并可以向他们解释事情如何工作的专业应用程序，但不一定在用户不想 RTFM 并且只是在寻找熟悉的行为的公共网站上使用。除非它只是一个示例练习或旨在将其包含在控制包中的控件，否则它违反了[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)原则；）

**2 - 实施**

您当然注意到实现是错误的（至少在 IE7 和 FF3.1B2 上）。有时，所有复选框上方的手势将选择所有复选框，但只有一个或两个。将鼠标移到列表上方或下方的 div 上将停止拖动（我知道这是一个“功能”，但它对用户不是很友好）。我检查了源代码，老实说，虽然它看起来很整洁，但我只是不想处理它，因为它是纯 javascript。难道你不知道...

**3 - 可能的改进**

[...您可以使用 javascript 库（通常是jQuery](http://jquery.com/)）少写多做。我会将这个控件完全重写为一个 jQuery 插件。它将为您提供许多工具，使您的代码更易于编写、维护和扩展。试试吧，你会喜欢的。这是从技术角度来看的。从用户的角度来看，尽量让您的控制尽可能熟悉，就像 Angela 建议的那样，windows explorer ：一个不错的选择矩形，使用shit + click 的能力，或类似的东西。最后，请记住，对于许多 Windows 复选框用户来说，“选中”和“选中”是两个不同的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-22T15:25:02.157

由于某种原因，我无法打开您的链接（它说我的 IP 地址被阻止）。但我认为你正在寻找的是我已经在 jquery 中所做的，我上传了一个插件，我基本上是从 crossbrowser.com 的 dragcheck 功能移植的，它可以在[http://plugins.jquery.com/project/找到dragCheck](http://plugins.jquery.com/project/dragCheck)但目前 jquery 插件站点正在修改，我的插件已经消失。我正在尝试看看他们是否会将其恢复，或者我是否必须再次创建一个新项目......无论如何，在我们解决之前你可以在这里看到一个演示：http: [//jsbin.com /比比](http://jsbin.com/ibihi)

# curl - cURL-如何通过命令行获得响应？

> ID：621482
> 
> 赞同：1
> 
> 时间：2009-03-07T07:29:23.330
> 
> 标签：curl

我有一个客户要求，我应该提交一个包含数据的 xml 文件并通过轮询响应接收处理过的数据。我使用 curl 将文件从命令行传输到 http 站点。

```
curl -v -d @request1l.xml -H "Content-Type: text/xml; charset=utf8" 
     http://**/ws -o request2.xml . 
```

现在要将投票响应转换为 xml 我该怎么办？用于此的命令是什么？

另外，我如何在发布或投票请求期间跟踪错误？

我对网络技术非常陌生，只是了解这些东西。

brgds arun

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T10:11:25.087

您可能希望使用 -Ss 来使统计信息静音并显示错误。如果发生错误，调用的返回码会给你错误。除非您要上传到的站点返回 XML 响应，否则您可能必须根据需要从响应代码创建一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-09T16:33:44.820

尝试这样的事情：

`eval $(curl -s -X "PUT" -D - | gawk '$1=="GREP_VAR_HERE:"{sub(/\r/,"",$2); printf("VARIABLE_NAME=\"%s\"\n",$2); }')`

# c - 我可以在与反控制重复和争论有关的家庭作业中获得一些帮助吗？

> ID：621483
> 
> 赞同：1
> 
> 时间：2009-03-07T07:30:43.077
> 
> 标签：c, arguments

好的，所以我需要让输出看起来像星号菱形，每行增加 2 个星号，直到中间有 9 个星号……然后行减少。功能 main 必须是：

```
int main (void){  
   int i;    
   i = 0;  
   while (i < 5){  
      printline (4-i, i*2+1);  
      i = i + 1;  
   }  
   i = 3;  
   while (i >= 0) {  
      printline (4-i, i*2+1);  
      i = i - 1;  
   }  
   return 0;  
} 
```

现在我应该定义函数 printline 以在每次调用时打印单行图形。它需要 2 个参数，空格数和应在行上打印的星号数。使用计数器控制重复打印适当数量的空格，然后再次打印适当数量的星号。

```
char print_line (int spaces, int stars){  
   for (int i = 4; i>=spaces; i--){  
      printf(" ");  
   }  
   for (int i = 1; i<=stars; i+=2){  
      printf("*");  
   }  
   printf("\n");  
} 
```

呜呼！我就快完成了！输出有点正确，除了不是一行有 4 个空格和一个星，一行有 3 个空格和 3 个星，依此类推，直到没有空格和 9 个星，（然后反转）......我得到一条线有一个星，有一个空格和 2 个星的行，一个有两个空格的行，三个星，等等，最多 4 个空格，五个星（然后反转）......
printline 不同的原因是因为我写这个有问题有时，每当我尝试写它时，我都会不断地使用斜体......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T07:39:06.210

一些提示：

*   你的函数只需要打印字符，它不返回任何东西（有一个特定的返回类型）
*   空格数和要打印的星数可能是整数
*   您可以使用打印单个空格`printf(" ");`
*   您可以使用打印单个星`printf("*");`
*   您可以使用打印“换行符”（转到下一行）`printf("\n");`
*   如果您说您将总共`int i=0; for(i=0; i<n; i++) { printf("X"); }`打印该字母（此时您可能还没有学习 for 循环；如果没有，请使用下一个提示）`X``n`
*   如果你说`int i=0; while(i<n) { printf("X"); i++; }`你也会打印这封信`X`的总`n`次数
*   `a`如果您使用和以外的参数名称，您会更开心`b`。试着想出一个与参数所*代表*的内容相对应的名称。

回复您的编辑：

*   您将需要使用两个*单独*的循环；一个打印空格，然后一个打印星星
*   `for`循环总是由一个初始化器、一个检查条件和一个步长/增量构成
*   您不需要为`stars`or赋值`spaces`；它们是调用你的函数的人给你的数字`printline`（即它们已经有一个值）

回复您的第二次编辑：

*   在你的`for`循环中，你可能想要使用一个索引变量*而*不是传入的参数（例如`for(i=0; i<spaces; i++)`， where`i`只是你在函数顶部声明的一个计数器，就像在赋值的代码中一样）在你当前的构造中，它无论调用者在调用您的函数时指定了什么，都会尝试打印 4 个空格。
*   *在完成所有空格和星号后*，您只需要输出一次换行符（即输出换行符不属于`for`循环内）
*   您可能只需要在`1`每次输出星号时增加计数器。
*   如果分配说要调用一个函数`printline`，你不能调用它`print_line`；那不是一回事（也不是`PrintLine`）

回复您的第三次编辑：

*   不要忘记“您可能只需要在`1`每次输出星号时增加计数器。”
*   不要忘记“你的函数只需要打印字符，它不返回任何东西（有一个特定的返回类型）”（即它不应该返回 a `char`）
*   我认为您希望打印空格的代码看起来更像打印星星的代码

# linux - alertlofile 的一周信息

> ID：621486
> 
> 赞同：2
> 
> 时间：2009-03-07T07:37:07.570
> 
> 标签：linux, shell, scripting

我想通过编写 shell 脚本来查看过去 7 天（周一至周日）的 alertlogfile 中的 ORA 错误。有谁能够帮我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T07:50:26.010

就像是：

```
sed -n -e '/start_time/,/end_time/ {/ORA/ p}' logfile 
```

或[使用 awk](http://forums11.itrc.hp.com/service/forums/questionanswer.do?admit=109447626+1236411861955+28353475&threadId=1270397)

```
$ start="Fri Feb 27 08:00:00 2009"
$ end="Fri Mar 6 08:00:00 2009"

$ awk -v prev="$start" -v last="$end" '$0 ~ prev,$0 ~ last' logfile 
```

在 ORA 文件中查找最后日期条目的更复杂的脚本[可在此处获得](http://objectmix.com/awk/26974-awk-between-two-dates.html)，也可在[dba-oracle.com 获得](http://www.dba-oracle.com/t_shell_script_check_alert_log.htm)

这并不能*完全*满足您的要求，但可能会为您提供一些线索来启动您自己的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T07:12:59.803

我想要给出如下输出的脚本（一周错误），它应该邮寄到我的身份证。

2009 年 3 月 14 日星期六 10:30:51 IST

ORA-01157: 无法识别/锁定数据文件 2 - 请参阅 DBWR 跟踪文件

2009 年 3 月 12 日星期六 12:35:06 IST

ORA-01110: 数据文件 2: '/u02/oradata/Globe/undotbs01.dbf'

Sat Mar 10 09:54:05 IST 2009 ORA-27037: 无法获取文件状态

2009 年 3 月 8 日星期六：15:02 IST

ORA-1157 期间发出信号：ALTER DATABASE OPEN...

2009 年 3 月 7 日星期六 12:35:51 IST

ORA-01157: 无法识别/锁定数据文件 2 - 请参阅 DBWR 跟踪文件

# c# - C# 不安全值类型数组到字节数组的转换

> ID：621493
> 
> 赞同：10
> 
> 时间：2009-03-07T07:47:41.290
> 
> 标签：c#, arrays, pointers, type-conversion, unsafe

我使用扩展方法将浮点数组转换为字节数组：

```
public static unsafe byte[] ToByteArray(this float[] floatArray, int count)
{
    int arrayLength = floatArray.Length > count ? count : floatArray.Length;
    byte[] byteArray = new byte[4 * arrayLength];
    fixed (float* floatPointer = floatArray)
    {
        fixed (byte* bytePointer = byteArray)
        {
            float* read = floatPointer;
            float* write = (float*)bytePointer;
            for (int i = 0; i < arrayLength; i++)
            {
                *write++ = *read++;
            }
        }
    }
    return byteArray;
} 
```

我知道数组是指向与元素类型和数量信息相关联的内存的指针。此外，在我看来，如果不复制上述数据，就无法在字节数组之间进行转换。

我明白了吗？甚至不可能编写 IL 来根据指针、类型和长度创建数组而不复制数据吗？

**编辑：**感谢您的回答，我学习了一些基础知识并尝试了新技巧！

在最初接受 Davy Landman 的回答后，我发现虽然他出色的 StructLayout hack 确实将字节数组转换为浮点数组，但反过来却行不通。展示：

```
[StructLayout(LayoutKind.Explicit)]
struct UnionArray
{
    [FieldOffset(0)]
    public Byte[] Bytes;

    [FieldOffset(0)]
    public float[] Floats;
}

static void Main(string[] args)
{
    // From bytes to floats - works
    byte[] bytes = { 0, 1, 2, 4, 8, 16, 32, 64 };
    UnionArray arry = new UnionArray { Bytes = bytes };
    for (int i = 0; i < arry.Bytes.Length / 4; i++)
        Console.WriteLine(arry.Floats[i]);

    // From floats to bytes - index out of range
    float[] floats = { 0.1f, 0.2f, 0.3f };
    arry = new UnionArray { Floats = floats };
    for (int i = 0; i < arry.Floats.Length * 4; i++)
        Console.WriteLine(arry.Bytes[i]);
} 
```

似乎 CLR 认为这两个数组具有相同的长度。如果结构是从浮点数据创建的，则字节数组的长度太短了。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-08-26T16:27:43.083

您可以使用非常丑陋的 hack 使用内存操作将数组临时更改为 byte[]。

这是非常快速和高效的，因为它不需要克隆数据并对其进行迭代。

我在 32 位和 64 位操作系统中测试了这个 hack，所以它应该是可移植的。

源代码 + 示例用法在[https://gist.github.com/1050703](https://gist.github.com/1050703)维护，但为了您的方便，我也将其粘贴在这里：

```
public static unsafe class FastArraySerializer
{
    [StructLayout(LayoutKind.Explicit)]
    private struct Union
    {
        [FieldOffset(0)] public byte[] bytes;
        [FieldOffset(0)] public float[] floats;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    private struct ArrayHeader
    {
        public UIntPtr type;
        public UIntPtr length;
    }

    private static readonly UIntPtr BYTE_ARRAY_TYPE;
    private static readonly UIntPtr FLOAT_ARRAY_TYPE;

    static FastArraySerializer()
    {
        fixed (void* pBytes = new byte[1])
        fixed (void* pFloats = new float[1])
        {
            BYTE_ARRAY_TYPE = getHeader(pBytes)->type;
            FLOAT_ARRAY_TYPE = getHeader(pFloats)->type;
        }
    }

    public static void AsByteArray(this float[] floats, Action<byte[]> action)
    {
        if (floats.handleNullOrEmptyArray(action)) 
            return;

        var union = new Union {floats = floats};
        union.floats.toByteArray();
        try
        {
            action(union.bytes);
        }
        finally
        {
            union.bytes.toFloatArray();
        }
    }

    public static void AsFloatArray(this byte[] bytes, Action<float[]> action)
    {
        if (bytes.handleNullOrEmptyArray(action)) 
            return;

        var union = new Union {bytes = bytes};
        union.bytes.toFloatArray();
        try
        {
            action(union.floats);
        }
        finally
        {
            union.floats.toByteArray();
        }
    }

    public static bool handleNullOrEmptyArray<TSrc,TDst>(this TSrc[] array, Action<TDst[]> action)
    {
        if (array == null)
        {
            action(null);
            return true;
        }

        if (array.Length == 0)
        {
            action(new TDst[0]);
            return true;
        }

        return false;
    }

    private static ArrayHeader* getHeader(void* pBytes)
    {
        return (ArrayHeader*)pBytes - 1;
    }

    private static void toFloatArray(this byte[] bytes)
    {
        fixed (void* pArray = bytes)
        {
            var pHeader = getHeader(pArray);

            pHeader->type = FLOAT_ARRAY_TYPE;
            pHeader->length = (UIntPtr)(bytes.Length / sizeof(float));
        }
    }

    private static void toByteArray(this float[] floats)
    {
        fixed(void* pArray = floats)
        {
            var pHeader = getHeader(pArray);

            pHeader->type = BYTE_ARRAY_TYPE;
            pHeader->length = (UIntPtr)(floats.Length * sizeof(float));
        }
    }
} 
```

用法是：

```
var floats = new float[] {0, 1, 0, 1};
floats.AsByteArray(bytes =>
{
    foreach (var b in bytes)
    {
        Console.WriteLine(b);
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T08:04:11.483

是的，类型信息和数据在同一个内存块中，所以这是不可能的，除非你覆盖浮点数组中的类型信息来欺骗系统它是字节数组。那将是一个非常丑陋的黑客攻击，并且很容易炸毁……

如果您愿意，可以在没有不安全代码的情况下转换浮点数：

```
public static byte[] ToByteArray(this float[] floatArray) {
    int len = floatArray.Length * 4;
    byte[] byteArray = new byte[len];
    int pos = 0;
    foreach (float f in floatArray) {
        byte[] data = BitConverter.GetBytes(f);
        Array.Copy(data, 0, byteArray, pos, 4);
        pos += 4;
    }
    return byteArray;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T09:08:26.713

这个问题与[什么是将 float[] 转换为 byte[] 的最快方法相反？](https://stackoverflow.com/questions/619041/what-is-the-fastest-way-to-convert-a-float-to-a-byte/619307).

我已经回答了一个[联合类型的黑客](https://stackoverflow.com/questions/619041/what-is-the-fastest-way-to-convert-a-float-to-a-byte/619307#619307)来跳过数据的整个复制。你可以很容易地扭转这个 (length = length *sizeof(Double).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T09:15:06.993

我为数组之间的快速转换编写了类似的东西。它基本上是一个丑陋的概念验证，而不是一个漂亮的解决方案。;)

```
public static TDest[] ConvertArray<TSource, TDest>(TSource[] source)
    where TSource : struct
    where TDest : struct {

    if (source == null)
        throw new ArgumentNullException("source");

        var sourceType = typeof(TSource);
        var destType = typeof(TDest);

        if (sourceType == typeof(char) || destType == typeof(char))
            throw new NotSupportedException(
                "Can not convert from/to a char array. Char is special " +
                "in a somewhat unknown way (like enums can't be based on " +
                "char either), and Marshal.SizeOf returns 1 even when the " +
                "values held by a char can be above 255."
            );

        var sourceByteSize = Buffer.ByteLength(source);
        var destTypeSize = Marshal.SizeOf(destType);
        if (sourceByteSize % destTypeSize != 0)
            throw new Exception(
                "The source array is " + sourceByteSize + " bytes, which can " +
                "not be transfered to chunks of " + destTypeSize + ", the size " +
                "of type " + typeof(TDest).Name + ". Change destination type or " +
                "pad the source array with additional values."
            );

        var destCount = sourceByteSize / destTypeSize;
        var destArray = new TDest[destCount];

        Buffer.BlockCopy(source, 0, destArray, 0, sourceByteSize);

        return destArray;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-31T07:41:00.770

```
 public byte[] ToByteArray(object o)
    {
        int size = Marshal.SizeOf(o);
        byte[] buffer = new byte[size];
        IntPtr p = Marshal.AllocHGlobal(size);
        try
        {
            Marshal.StructureToPtr(o, p, false);
            Marshal.Copy(p, buffer, 0, size);
        }
        finally
        {
            Marshal.FreeHGlobal(p);
        }
        return buffer;
    } 
```

这可以帮助您将对象转换为字节数组。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-28T13:27:35.323

您应该查看我对类似问题的回答：[将 float[] 转换为 byte[] 的最快方法是什么？](https://stackoverflow.com/questions/619041/what-is-the-fastest-way-to-convert-a-float-to-a-byte/3577253#3577253).

在其中，您会找到可移植代码（32/64 位兼容），让您可以将浮点数组视为字节数组，反之亦然，而无需复制数据。这是我所知道的做这种事情的最快方法。

如果您只是对代码感兴趣，可以在[https://gist.github.com/1050703](https://gist.github.com/1050703)维护它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T09:32:49.980

好吧 - 如果你仍然对那个 hack 感兴趣 - 看看这个修改过的代码 - 它就像一个魅力并且花费大约 0 时间，但它可能在未来无法工作，因为它是一个允许完全访问整个进程地址空间的 hack，而无需信任要求和不安全标记。

```
 [StructLayout(LayoutKind.Explicit)]
    struct ArrayConvert
    {
        public static byte[] GetBytes(float[] floats)
        {
            ArrayConvert ar = new ArrayConvert();
            ar.floats = floats;
            ar.length.val = floats.Length * 4;
            return ar.bytes;
        }
        public static float[] GetFloats(byte[] bytes)
        {
            ArrayConvert ar = new ArrayConvert();
            ar.bytes = bytes;
            ar.length.val = bytes.Length / 4;
            return ar.floats;
        }

        public static byte[] GetTop4BytesFrom(object obj)
        {
            ArrayConvert ar = new ArrayConvert();
            ar.obj = obj;
            return new byte[]
            {
                ar.top4bytes.b0,
                ar.top4bytes.b1,
                ar.top4bytes.b2,
                ar.top4bytes.b3
            };
        }
        public static byte[] GetBytesFrom(object obj, int size)
        {
            ArrayConvert ar = new ArrayConvert();
            ar.obj = obj;
            ar.length.val = size;
            return ar.bytes;
        }

        class ArrayLength
        {
            public int val;
        }
        class Top4Bytes
        {
            public byte b0;
            public byte b1;
            public byte b2;
            public byte b3;
        }

        [FieldOffset(0)]
        private Byte[] bytes;
        [FieldOffset(0)]
        private object obj;
        [FieldOffset(0)]
        private float[] floats;

        [FieldOffset(0)]
        private ArrayLength length;

        [FieldOffset(0)]
        private Top4Bytes top4bytes;
    } 
```

# oracle - 合理的 SELECT ... INTO Oracle 解决方案，适用于多行或无行的情况

> ID：621511
> 
> 赞同：1
> 
> 时间：2009-03-07T08:07:59.883
> 
> 标签：oracle

我只想从过程内部将值选择到变量中。

选择 blah1,blah2 到 var1_,var2_ FROM ...

有时，一个大型复杂查询将没有行，有时它会有多个行——这两种情况都会导致异常。我很想用类似于以下的隐式行为替换异常行为：

无行 = 无值更改，多行 = 最后使用

对于“多行”情况，我可以很容易地约束结果集，但对于不能在 SELECT 中使用聚合函数的情况，“无行”要困难得多。

有什么特别的解决方法或建议吗？希望避免在执行 SELECT INTO 之前显着重写查询或执行两次以获得行数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T11:08:19.793

使用异常块有什么问题？

```
 create or replace
procedure p(v_job VARCHAR2) IS
 v_ename VARCHAR2(255);
begin

 select ename into v_ename 
 from (
  select ename
  from scott.emp 
  where job = v_job
  order by v_ename desc )
 where rownum = 1;

 DBMS_OUTPUT.PUT_LINE('Found Rows Logic Here -> Found ' || v_ename);
 EXCEPTION WHEN NO_DATA_FOUND THEN
  DBMS_OUTPUT.PUT_LINE('No Rows found logic here');

end;

SQL>  begin
   p('FOO');
   p('CLERK');
  end;  2    3    4  
  5  /
No Rows found logic here
Found Rows Logic Here -> Found SMITH

PL/SQL procedure successfully completed.

SQL> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:28:35.360

您可以使用 for 循环。对于没有返回的行，for 循环不会执行任何操作，并且将应用于返回的每一行，如果那里有多个。您可以调整您的选择，使其仅返回最后一行。

```
begin   
    for ARow in (select *
                  from tableA ta
                  Where ta.value = ???) loop                           
        -- do something to ARow
    end loop;   
end; 
```

# c++ - 在winsock中重用向量作为数组的更有效方法？

> ID：621512
> 
> 赞同：2
> 
> 时间：2009-03-07T08:09:24.983
> 
> 标签：c++, stl, vector, winsock

我目前正在使用向量作为 c 样式的数组来通过 Winsock 发送和接收数据。

我有一个 std::vector ，我将它用作我的“字节数组”。

问题是，我使用了两个向量，一个用于每个发送，一个用于每个接收，但我正在做的似乎相当低效。

例子：

```
std::string EndBody("\r\n.\r\n");
std::fill(m_SendBuffer.begin(),m_SendBuffer.end(),0);
std::copy(EndBody.begin(),EndBody.end(),m_SendBuffer.begin());
SendData(); 
```

SendData 只是调用 send 适当的次数，并确保一切正常。

反正。除非我在每次使用之前将向量归零，否则我会收到内容重叠的错误。有没有更有效的方法让我做我正在做的事情？因为似乎在每次调用时将整个缓冲区归零是非常低效的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T08:20:33.287

你可以使用 m_SendBuffer.clear()

否则 end() 方法将不知道缓冲区的实际大小。

clear() 不是一个非常昂贵的调用方法。除非你正在处理一些 486 或其他东西，否则它不应该影响你的表现

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:06:23.087

Seems like the other posters are focusing on the cost of clearing the buffer, or the size of the buffer. Yet you don't really need to clear or zero out the whole buffer, or know its size, for what you're doing. The 'errors with stuff overlapping' is a problem with SendData, that you've not posted the code for. Presumably SendData doesn't know how much of the buffer it needs to send unless the data within it is zero-terminated. if that assumption is correct, all you have to do is zero-terminate the data correctly.

```
std::copy(EndBody.begin(),EndBody.end(),m_SendBuffer.begin());
m_SendBuffer[EndBody.size()] = 0;
SendData(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:42:45.927

据我了解[STL 文档](http://www.sgi.com/tech/stl/Vector.html "向量的 SGi STL 文档")，调用 clear 只是将 .end() 值设置为与 .begin() 相同并将大小设置为零，这是即时的。

它不会改变分配的内存量或内存的位置（任何迭代器显然都是无效的，但数据往往会徘徊！）。正如您已经发现的那样， .capacity() 不会改变，存储在那里的数据也不会改变。如果您总是使用 .begin() .end() 和 STL 迭代器来访问该区域，这无关紧要。

不要忘记，除非您将它们包含在初始化列表中，否则不会初始化类的方法变量。在那里添加`m_SendBuffer(BUFSIZE,0)`可能会奏效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T08:24:55.320

调用 clear 是否意味着向量的新大小为 0？如果 OP 将向量用作一大块内存，那么他们必须在 clear 后调用 resize 以确保有适当的空间可用于调用 send 和 recv。

在向量上调用 clear then resize 将与仅用零填充它大致相同，不是吗？

[矢量::清除](http://www.cplusplus.com/reference/stl/vector/clear.html)

[矢量::调整大小](http://www.cplusplus.com/reference/stl/vector/resize.html)

[充满](http://www.cplusplus.com/reference/algorithm/fill.html)

# sql - 即席数据和存储库模式

> ID：621514
> 
> 赞同：5
> 
> 时间：2009-03-07T08:11:35.303
> 
> 标签：sql, database, model, repository-pattern

从不适合任何模型实体或扩展某些模型实体的存储库返回临时（逐案自定义）数据的推荐方法是什么？

101 的例子是无处不在的 hello word 应用程序：一个博客系统。假设您要加载一个帖子列表，其中帖子条目包含一些 Post 实体中不存在的附加信息。假设它是评论的数量以及最后评论的日期和时间。如果使用普通的旧 SQL 并直接从数据库中读取数据，这将是非常微不足道的。如果我负担不起为每个帖子加载整个评论集合，并且我想在一次数据库命中中完成，我应该如何使用存储库模式以最佳方式完成它？这种情况有没有常用的模式？现在假设您有一个中等复杂的 Web 应用程序，其中每个页面需要稍微不同的自定义数据，并且无法加载完整的层次结构（性能、内存要求等）。

一些随机的想法：

1.  向可以由自定义数据填充的每个模型添加一个属性列表。

2.  逐个子类模型实体，并为每个子类创建自定义阅读器。

3.  使用 LINQ、编写即席查询和读取匿名类。

注：我最近也问过一个[类似的问题](https://stackoverflow.com/questions/619698/marrying-up-consumer-defined-aggregates-e-g-sql-counts-with-pure-model-objec)，不过好像太笼统了，没有引起太多关注。

**例子：**

根据以下答案中的建议，我添加了一个更具体的示例。这是我试图描述的情况：

```
IEnumarable<Post> posts = repository.GetPostsByPage(1);
foreach (Post post in posts)
{

    // snip: push post title, content, etc. to view

    // determine the post count and latest comment date
    int commentCount = post.Comments.Count();
    DateTime newestCommentDate = post.Comments.Max(c => c.Date);

    // snip: push the count and date to view

} 
```

如果我不做任何额外的事情并使用现成的 ORM，这将导致 n+1 个查询或可能一个查询加载所有帖子和评论。但最佳情况下，我希望能够只执行一个 SQL，该 SQL 将为每个帖子返回一行，包括帖子标题、正文等以及评论计数和最近的评论日期。这在 SQL 中是微不足道的。问题是我的存储库将无法读取此类数据并将其放入模型中。最大日期和计数在哪里？

我不是在问如何做到这一点。您总是可以*以某种方式*做到这一点：向存储库添加额外的方法，添加新类，特殊实体，使用 LINQ 等，但我想我的问题如下。为什么存储库模式和正确的模型驱动开发如此广泛接受，但它们似乎并没有解决这种看似非常普遍和基本的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T21:13:18.197

由于我们需要紧急解决我在原始问题中概述的问题，因此我们采用了以下解决方案。我们为每个模型实体添加了一个属性集合（一个字典），如果 DAL 需要，它会将自定义数据粘贴到其中。为了建立某种控制，属性集合由指定类的实例作为键，它只支持简单的数据类型（整数、日期等），这是我们在移动时所需要的，而且很可能永远需要. 这解决的一个典型情况是：加载一个实体，其中包含其子集合的计数，而不是完全填充的集合。我怀疑这可能不会因为软件设计而获得任何奖励，但它是我们案例中最简单和最实用的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T16:34:52.037

这个问题有很多。您是否需要这些特定数据来进行报告程序？如果是这样，那么正确的解决方案是为报告目的单独访问数据。扁平化的数据库、视图等。

或者它是一个临时查询需要？如果是这样，Ayende 有一个关于这个问题的帖子。[http://ayende.com/Blog/archive/2006/12/07/ComplexSearchingQueryingWithNHibernate.aspx](http://ayende.com/Blog/archive/2006/12/07/ComplexSearchingQueryingWithNHibernate.aspx)

他使用“Finder”对象。他正在使用 NHibernate，所以基本上他所做的是创建一个分离的查询。

我过去做过类似的事情，通过创建一个 Query 对象，我可以在将它交给存储库之前填充它（一些 DDD 纯粹主义者会反对它，但我发现它优雅且易于使用）。

Query 对象实现了一个流畅的接口，所以我可以这样写并返回结果：

```
IQuery query = new PostQuery()
   .WithPostId(postId)
   .And()
   .WithCommentCount()
   .And()
   .WithCommentsHavingDateLessThan(selectedDate);

Post post = _repository.Find(query); 
```

但是，在您的具体情况下，我不得不怀疑您的设计。您是说您无法在帖子中加载评论。为什么？您是否只是对性能过于担心？这是过早优化的情况吗？（对我来说似乎是这样）

如果我有一个 Post 对象，它将是我的聚合根，它会附带评论。然后你想做的所有事情都会在每种情况下都有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T09:33:31.083

不能说我真的明白问题出在哪里，只是在这里开枪：

*   添加一个特定的实体来封装你想要的信息
*   将属性评论添加到帖子。（我不明白为什么这会要求您获取所有评论 - 您可以只获取您正在加载的特定帖子的评论）
*   使用延迟加载仅在访问属性时获取评论

我认为，如果您将平台、语言和 O/R 映射器具体化（似乎是 .NET C# 或 VB，因为您提到了 LINQ。LINQ 2 SQL？实体框架？其他东西?)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-13T16:57:32.167

为此，我通常有一个 RepositoryStatus 和一个用作我的数据传输对象 (DTO) 的 Status 类。Status 类用于我的应用程序服务层（出于相同的原因），RepositoryStatus 从该层继承。然后使用这个类，我可以从存储库层返回错误消息、响应对象等。这个类是通用的，因为它将接受任何对象并将其投射给接收者。

这是状态类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using RanchBuddy.Core.Domain;
using StructureMap;

namespace RanchBuddy.Core.Services.Impl
{
    [Pluggable("Default")]
    public class Status : IStatus
    {
        public Status()
        {
            _messages = new List<string>();
            _violations = new List<RuleViolation>();
        }

        public enum StatusTypes
        {
            Success,
            Failure
        }

        private object _object;
        public T GetObject<T>()
        {
            return (T)_object;
        }
        public void SetObject<T>(T Object)
        {
            _object = Object;
        }

        private List<string> _messages;
        public void AddMessage(string Message)
        {
            _messages.Add(Message);
        }
        public List<string> GetMessages()
        {
            return _messages;
        }
        public void AddMessages(List<string> Messages)
        {
            _messages.AddRange(Messages);
        }

        private List<RuleViolation> _violations;
        public void AddRuleViolation(RuleViolation violation)
        {
            _violations.Add(violation);
        }
        public void AddRuleViolations(List<RuleViolation> violations)
        {
            _violations.AddRange(violations);
        }
        public List<RuleViolation> GetRuleViolations()
        {
            return _violations;
        }
        public StatusTypes StatusType { get; set; }
    }
} 
```

这是存储库状态：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using RanchBuddy.Core.Services.Impl;
using StructureMap;

namespace RanchBuddy.Core.DataAccess.Impl
{
    [Pluggable("DefaultRepositoryStatus")]
    public class RepositoryStatus : Status, IRepositoryStatus
    {

    }
} 
```

如您所见，RepositoryStatus 还没有做任何特别的事情，只是依赖于 Status 对象实用程序。但我想保留以后延长的权利！

我敢肯定，那里的一些顽固分子会说，如果您要成为一个纯粹主义者，则不应使用它……但是我知道您的痛苦在于，有时您需要传递的不仅仅是退回的物品！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T03:06:10.900

如果您没有被锁定在 RDBM 中，那么像 CouchDB 或 Amazons SimpleDB 这样的数据库可能值得一看。您所描述的在 CouchDB 视图中是微不足道的。这可能并不能真正回答您的具体问题，但有时最好看看完全不同的选项。

# mysql - 如何设置 MySQL 进程或线程的最大数量？

> ID：621516
> 
> 赞同：27
> 
> 时间：2009-03-07T08:13:06.423
> 
> 标签：mysql, multithreading, process

`ps axuw| grep mysql`仅表示 MySQL 进程，但如果我运行 htop，我可以看到 10 行，每行都有一个单独的 PID。所以我想知道它们是否是由于某种原因我无法使用 ps 看到的线程或进程。

尝试在我的开发机器上将它们限制为两个是否有意义，我不需要许多客户端的并发访问。

顺便说一句，在 Ubuntu 8.10 上运行

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-07T08:21:15.437

您可以像这样在 my.ini 中设置最大线程数：

```
max_connections=2 
```

但是，您可能还想设置这个：

```
thread_cache_size=1 
```

即使没有发生任何事情，线程缓存也会控制它保持打开的数量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-07T09:00:06.640

MySQL 确实使用线程，`ps`如果您运行`ps -eLf`.

也就是说，我不会担心——休眠线程几乎不使用任何资源，如果你过多地限制服务器，它一定会在稍后的某个时候回来咬你，当你忘记你做了它时。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-09T21:13:43.853

很少有配置设置`/etc/mysql/my.cnf`会影响内存使用。以下设置： `key_buffer = 8M max_connections = 30 query_cache_size = 8M query_cache_limit = 512K thread_stack = 128K` 应该大大减少mysql的内存使用量。

在这里阅读更多：http: [//opensourcehacker.com/2011/03/31/reducing-mysql-memory-usage-on-ubuntu-debian-linux/](http://opensourcehacker.com/2011/03/31/reducing-mysql-memory-usage-on-ubuntu-debian-linux/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T07:48:01.913

我正在寻找 MySQL 配置的东西，然后我看到了这个问题....与 MySQL 无关，对吗？

如果主要目标是查看自定义命令的结果，您可以使用以下语法的“watch”（在大多数 linux 系统上可用）：

```
watch "ps axuw| grep mysql" 
```

它将每 2 秒运行一次命令并显示输出，这是一个非常有用的命令。

-> 查看文档/手册，了解它的强大之处；）

# c++ - 什么是数据断点？

> ID：621535
> 
> 赞同：28
> 
> 时间：2009-03-07T08:29:20.487
> 
> 标签：c++, visual-studio, debugging, breakpoints, conditional-breakpoint

我才知道有*数据*断点。在过去的 5 年里，我一直使用 Visual Studio 在 C++ 中工作，我从未使用过数据断点。

有人可以阐明什么是数据断点，何时使用它们以及*如何*将它们与 VS 一起使用？

根据我的理解，当我们想要检查变量值的变化时，我们可以设置一个数据断点。在这种情况下，我们可以在变量值上设置一个带有条件的数据断点。

还有其他例子吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-03-07T08:46:35.703

好的 ol' [Daniel LeCheminant](https://stackoverflow.com/questions/621535/what-are-data-breakpoints/621537#621537)对数据断点的作用有一个可靠的答案，所以*我*将介绍一些突出有用用途的轶事：

*任何您知道会发生什么*变化，但很少或根本不知道更改它的代码*在哪里*的场景（否则您可以简单地使用条件断点）。具体来说，

**“不可能”的场景**- 程序崩溃，因为变量`X`是`NULL`，而变量`X`永远不应该是，`NULL`因为任何地方都没有代码将变量设置`X`为`NULL`. 在初始化的代码中放置一个普通断点`X`，当它被命中时，设置一个数据断点来观察对`NULL`. 更常见的是内存释放*过早*的情况，并且仍然有指向它的指针：使用数据断点找出谁在释放内存。

**乏味的场景**- 第三方库正在对您的数据结构做坏、讨厌、可怕的事情。你知道它正在发生，因为*有人*在破坏你的数据，显然你的代码是完美的。但你不知道何时何地。当然，您可以单步执行一兆字节的反汇编 DLL……但是，当您可以在数据上设置数据断点时，请坐等它被破坏！

**Heisenbugs** - 类似于不可能的情况，但是当你观察得太近时它们会消失，这样正常的断点 - 甚至是条件断点 - 都是无用的。时序和用户输入敏感逻辑特别容易受到这类事情的影响。由于数据断点根本不需要调试器实际中断，直到*时间合适*，假设您可以想出一个仅在实际发生难以捉摸的错误时才会更改的内存位置，您可以使用数据断点设置陷阱Heisenbug 并*在当场*抓住它。

**意大利面场景——在旧的、腐烂的代码库中很常见，在这些代码库中，***到处*都可以访问全局数据。是的，你可以使用普通的条件断点......但你需要数百个。数据断点使它变得容易。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-07T08:31:48.517

定义：

> 数据断点允许您在存储在指定内存位置的值更改时中断执行。

来自 MSDN：[如何：设置数据断点](https://msdn.microsoft.com/en-us/library/350dyxd0(v=vs.100).aspx)：

**如何设置内存更改断点**

1.  从 Debug 菜单中，选择 New Breakpoint 并单击 New Data Breakpoint

    ——或者——</p>

    在 Breakpoints 窗口菜单中，单击 New 下拉菜单并选择 New Data Breakpoint。

    出现新建断点对话框。

2.  在地址框中，输入一个内存地址或计算为内存地址的表达式。例如，&foo 在变量 foo 的内容发生变化时中断。

3.  在 Byte Count 框中，输入您希望调试器监视的字节数。例如，如果您输入 4，调试器将监视从 &foo 开始的四个字节，并在其中任何一个字节更改值时中断。

4.  单击确定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-18T10:59:41.110

到目前为止，我们已经有了一个很好的定义和一堆很好的理论解释。

让我们举一个具体的例子！

我目前正在研究一个相当大且复杂的代码库。我对一段代码做了一个小的安全更改，并开始在一个完全不相关的代码库中崩溃内存分配器。这通常表明您在内存管理方面做得非常错误 - 双重删除或写入越界。

值得庆幸的是，我们可以选择打开一个调试内存管理器来检查这样的事情。我打开它，它立即开始报告内存块保护违规，这意味着某些内容超出了范围。问题是这个报告只有在内存被释放后才会出现——基本上是在说“嘿，有些东西*坏*了。希望你能弄清楚是什么！”

不幸的是，这个特定的内存块，在释放时，与字面上成千上万的其他内存块完全没有区别。幸运的是，我们的调试框架使用连续 ID 标记每个分配，并且损坏的内存具有一致的 ID（如果您好奇的话，#9667。）稍后在内存管理器中的一个快速断点，我能够找到那个位置内存已分配。事实证明，这也不是立即有帮助的。

但那时，我有几个重要的组成部分：

*   我知道一块内存的地址
*   我知道那段记忆的预期长度
*   我知道，*在未来的某个时候，*超过该内存预期长度的特定字节将被覆盖

鉴于此，我可以在该特定字节上设置一个数据断点，然后点击“开始”并找出损坏发生的位置。

我所做的 - 它导致了一个错误的错误，我现在正在修复它。

这是数据断点如何有用的具体示例。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T08:32:40.947

我相信数据断点是当某些内存设置为某个值时会发生的断点。例如，您可以在典型 for 循环中的 i == 10 时设置断点，以在第 10 次迭代后停止。您还可以观察堆上变量的变化，例如等待修改类的成员。

# c# - 在gridview编辑项模板中绑定下拉列表

> ID：621536
> 
> 赞同：1
> 
> 时间：2009-03-07T08:29:32.780
> 
> 标签：c#, .net, asp.net, gridview

我可以在编辑项模板中绑定下拉列表。下拉列表具有空值。

```
protected void grdDevelopment_RowDataBound(object sender, GridViewRowEventArgs e) 
{   
  DropDownList drpBuildServers = new DropDownList();

  if (grdDevelopment.EditIndex == e.Row.RowIndex)    
  {        
      drpBuildServers = (DropDownList)e.Row.Cells[0].FindControl("ddlBuildServers");    
  }
} 
```

也收到错误

无法加载视图状态。正在加载视图状态的控制树必须与在先前请求期间用于保存视图状态的控制树匹配。例如，当动态添加控件时，回发期间添加的控件必须与初始请求期间添加的控件的类型和位置相匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T09:14:43.593

我在查找控件时遇到了问题，最后我使用了一点递归来查找控件：

```
private Control FindControlRecursive(Control root, string id) 
{ 
     if (root.ID == id)
    { 
         return root; 
    } 

    foreach (Control c in root.Controls) 
    { 
         Control t = FindControlRecursive(c, id); 
        if (t != null) 
        { 
            return t; 
        } 
    } 

     return null; 
} 
```

然后找到您的控件进行此调用：

```
drpBuildServers = (DropDownList) FindControlRecursive(e.Row.Cells[0], "ddlBuildServers"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T09:26:09.260

```
protected void grdDevelopment_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        DropDownList drpBuildServers;

        drpBuildServers = e.Row.FindControl("ddlBuildServers") as DropDownList;

        if (drpBuildServers != null)
            // Write your code here            
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-04T12:22:54.987

尝试[http://www.codeproject.com/KB/webforms/editable_gridview_control.aspx](http://www.codeproject.com/KB/webforms/editable_gridview_control.aspx)，它可能会有所帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-19T13:24:05.823

它对我来说是一个解决方案：

```
protected void grdDevelopment_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        DropDownList drpBuildServers;

        drpBuildServers = e.Row.FindControl("ddlBuildServers") as DropDownList;

        if (drpBuildServers != null)
            // Write your code here            
    }
} 
```

# c++ - C++ 中的编译器和参数求值顺序

> ID：621542
> 
> 赞同：60
> 
> 时间：2009-03-07T08:41:19.540
> 
> 标签：c++, operator-precedence

好的，我知道标准规定 C++ 实现可以选择评估函数的参数的顺序，但是在实际影响程序的情况下，是否有任何实现实际上“利用”这一点？

经典示例：

```
int i = 0;
foo(i++, i++); 
```

注意：我不是在找人告诉我不能依赖评估顺序，我很清楚这一点。我只对是否有任何编译器真的按照从左到右的顺序进行评估感兴趣，因为我的猜测是，如果他们做了很多写得不好的代码会中断（这是正确的，但他们仍然可能会抱怨）。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-07T08:48:37.947

它取决于参数类型、被调用函数的调用约定、架构和编译器。在 x86 上，[Pascal](http://en.wikipedia.org/wiki/X86_calling_conventions#pascal)调用约定从左到右评估参数，而在 C 调用约定 ( [__cdecl](http://msdn.microsoft.com/en-us/library/zkwh89ks(VS.80).aspx) ) 中，它是从右到左。大多数在多个平台上运行的程序都会考虑调用约定以跳过意外。

如果您有兴趣，Raymond Chen 的博客上有一篇不错的[文章。](http://blogs.msdn.com/oldnewthing/archive/2004/01/08/48616.aspx)您可能还想查看 GCC 手册的[堆栈和调用](http://gcc.gnu.org/onlinedocs/gccint/Stack-and-Calling.html)部分。

**编辑：**只要我们分心：我的回答不是将其视为语言问题，而是将其视为平台问题。语言标准不保证或偏爱一个而不是另一个，并将其保留为**未指定**。注意措辞。它并没有说这是未定义的。从这个意义上说，未指定意味着你不能指望的东西，不可移植的行为。我手边没有 C 规范/草案，但它应该类似于我的 n2798 草案（C++）

> 抽象机的某些其他方面和操作在本国际标准中描述为未指定（例如，函数参数的评估顺序）。在可能的情况下，本国际标准定义了一组允许的行为。这些定义了抽象机器的不确定性方面。因此，对于给定程序和给定输入，抽象机的一个实例可以具有多个可能的执行顺序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-01-09T08:15:44.420

[我在c++ 标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf)中找到了答案。

第 5.2.2.8 段：

> 参数的评估顺序未指定。参数表达式评估的所有副作用在输入函数之前生效。后缀表达式和参数表达式列表的求值顺序未指定。

换句话说，它仅取决于编译器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-07T10:57:03.550

[读这个](https://stackoverflow.com/questions/598148/is-it-legal-to-use-the-increment-operator-in-a-c-function-call)

这不是您问题的精确副本，但我的回答（和其他一些人）也涵盖了您的问题。

编译器可能不仅选择从右到左而且还交错它们有很好的优化原因。

该标准甚至不保证顺序排序。它只保证当函数被调用时，所有参数都已被完全评估*。*

是的，我已经看到几个版本的 GCC 正是这样做的。对于您的示例，将调用 foo(0,0) ，之后 i 将是 2。（我不能给你编译器的确切版本号。那是不久前的事了——但看到这种行为再次出现我不会感到惊讶。这是安排指令的一种有效方式）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-03-22T12:10:50.000

所有参数都被评估。订单未定义（根据标准）。但是 C/C++ 的所有实现（我知道）**从右到左**评估函数参数。 *编辑：CLang 是一个例外（见下面的评论）。*

我相信从右到左的评估顺序非常古老（从第一个 C 编译器开始）。当然在 C++ 发明之前，C++ 的大多数实现都会保持相同的评估顺序，因为早期的 C++ 实现只是简单地翻译成 C。

从右到左评估函数参数有一些技术原因。在堆栈架构中，参数通常被压入堆栈。在 C/C++ 中，您可以调用具有比实际指定更多参数的函数——额外的参数被简单地忽略。如果参数从左到右计算，并从左到右推送，则堆栈指针正下方的堆栈槽将保存最后一个参数，并且函数无法获取任何特定参数的偏移量（因为实际推送的参数数量取决于调用者）。

在从右到左的推送顺序中，堆栈指针正下方的堆栈槽将始终保存第一个参数，下一个槽保存第二个参数，依此类推。参数偏移量对于函数始终是确定性的（可以写成在别处编译成一个库，与调用它的地方分开）。

现在，从右到左的推送顺序并不强制要求从右到左的评估顺序，但在早期的编译器中，内存是稀缺的。在从右到左的评估顺序中，可以就地使用相同的堆栈（本质上，在评估参数之后——可能是表达式或函数调用！——返回值已经在堆）。在从左到右的评估中，参数值必须单独存储，并以相反的顺序推回堆栈。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-07T08:52:07.470

上次我在 2007 年看到 VS2005 和 GCC 3.x 在 x86 硬件上的差异。所以这是（是？）很可能的情况。所以我不再依赖评估顺序了。也许现在好多了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-07T08:54:27.713

我希望大多数现代编译器会尝试交错计算参数的指令，因为 C++ 标准要求它们是独立的，因此没有任何相互依赖关系。这样做应该有助于保持深度流水线 CPU 的执行单元满载，从而提高吞吐量。（至少我希望一个声称是优化编译器的编译器在给出优化标志时会这样做。）

# c# - 如何从 ASP.NET 中的任何类访问会话变量？

> ID：621549
> 
> 赞同：165
> 
> 时间：2009-03-07T08:48:42.517
> 
> 标签：c#, asp.net, session-variables

我在我的应用程序的 App_Code 文件夹中创建了一个类文件。我有一个会话变量

```
Session["loginId"] 
```

我想在我的类中访问这个会话变量，但是当我写下面一行时，它给出了错误

```
Session["loginId"] 
```

谁能告诉我如何访问在 ASP.NET 2.0 (C#) 的 app_code 文件夹中创建的类中的会话变量

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2009-03-07T10:10:22.647

（为完整性而更新）您可以从任何页面或控件使用和从任何类（例如，从类库内部）
访问会话变量，使用`Session["loginId"]``System.Web.HttpContext.Current.Session["loginId"].`

但请继续阅读我的原始答案......

* * *

我总是在 ASP.NET 会话周围使用包装类来简化对会话变量的访问：

```
public class MySession
{
    // private constructor
    private MySession()
    {
      Property1 = "default value";
    }

    // Gets the current session.
    public static MySession Current
    {
      get
      {
        MySession session =
          (MySession)HttpContext.Current.Session["__MySession__"];
        if (session == null)
        {
          session = new MySession();
          HttpContext.Current.Session["__MySession__"] = session;
        }
        return session;
      }
    }

    // **** add your session properties here, e.g like this:
    public string Property1 { get; set; }
    public DateTime MyDate { get; set; }
    public int LoginId { get; set; }
} 
```

此类将自身的一个实例存储在 ASP.NET 会话中，并允许您以类型安全的方式从任何类访问会话属性，例如：

```
int loginId = MySession.Current.LoginId;

string property1 = MySession.Current.Property1;
MySession.Current.Property1 = newValue;

DateTime myDate = MySession.Current.MyDate;
MySession.Current.MyDate = DateTime.Now; 
```

这种方法有几个优点：

*   它使您免于大量类型转换
*   您不必在整个应用程序中使用硬编码的会话密钥（例如 Session["loginId"]
*   您可以通过在 MySession 的属性上添加 XML 文档注释来记录您的会话项目
*   您可以使用默认值初始化会话变量（例如，确保它们不为空）

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2009-03-07T08:50:37.567

通过线程的 HttpContext 访问 Session：-

```
HttpContext.Current.Session["loginId"] 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2010-06-10T17:42:14.830

建议的解决方案的问题是，如果您使用进程外会话存储，它可能会破坏 SessionState 中内置的一些性能特性。（“状态服务器模式”或“SQL Server 模式”）。在 oop 模式下，会话数据需要在页面请求结束时进行序列化，并在页面请求开始时进行反序列化，这可能代价高昂。为了提高性能，SessionState 尝试仅在第一次访问时仅通过反序列化变量来反序列化所需的内容，并且仅重新序列化和替换已更改的变量。如果您有很多会话变量并将它们全部推到一个类中，那么基本上会话中的所有内容都将在每个使用会话的页面请求上反序列化，并且即使由于类更改而仅更改了 1 个属性，所有内容都需要再次序列化。如果您使用大量会话和 oop 模式，则需要考虑一些事情。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-07T11:28:53.503

我之前提供的答案为该问题提供了恰当的解决方案，但是，我认为了解为什么会导致此错误很重要：

的`Session`属性返回与该特定请求相关`Page`的类型实例。实际上相当于调用.`HttpSessionState``Page.Session``Page.Context.Session`

[MSDN](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.session(VS.80).aspx)解释了这是如何实现的：

> 因为 ASP.NET 页面包含对 System.Web 命名空间（包含类）的默认引用，所以您可以在没有完全限定的类引用的情况下引用 .aspx 页面上`HttpContext`的成员。`HttpContext``HttpContext`

但是，当您尝试在 App_Code 中的类中访问此属性时，除非您的类派生自 Page Class，否则您将无法使用该属性。

对于这种经常遇到的情况，我的解决方案是**我从不将页面对象传递给 classes**。我宁愿从页面 Session 中提取所需的对象，并根据情况以名称-值集合/数组/列表的形式将它们传递给 Class。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-30T16:22:47.510

在 asp.net 核心中，它的工作方式不同：

```
public class SomeOtherClass
{
    private readonly IHttpContextAccessor _httpContextAccessor;
    private ISession _session => _httpContextAccessor.HttpContext.Session;

    public SomeOtherClass(IHttpContextAccessor httpContextAccessor)
    {
        _httpContextAccessor = httpContextAccessor;
    }

    public void TestSet()
    {
        _session.SetString("Test", "Ben Rules!");
    }

    public void TestGet()
    {
        var message = _session.GetString("Test");
    }
} 
```

来源：[https ://benjii.me/2016/07/using-sessions-and-httpcontext-in-aspnetcore-and-mvc-core/](https://benjii.me/2016/07/using-sessions-and-httpcontext-in-aspnetcore-and-mvc-core/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-12T22:47:56.690

我遇到了同样的错误，因为我试图在自定义 Session 类中操作会话变量。

我必须将当前上下文（system.web.httpcontext.current）传递给类，然后一切正常。

嘛

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-19T22:46:20.017

这对于应用程序和开发人员都应该更有效。

将以下类添加到您的 Web 项目中：

```
/// <summary>
/// This holds all of the session variables for the site.
/// </summary>
public class SessionCentralized
{
protected internal static void Save<T>(string sessionName, T value)
{
    HttpContext.Current.Session[sessionName] = value;
}

protected internal static T Get<T>(string sessionName)
{
    return (T)HttpContext.Current.Session[sessionName];
}

public static int? WhatEverSessionVariableYouWantToHold
{
    get
    {
        return Get<int?>(nameof(WhatEverSessionVariableYouWantToHold));
    }
    set
    {
        Save(nameof(WhatEverSessionVariableYouWantToHold), value);
    }
}

} 
```

这是实现：

```
SessionCentralized.WhatEverSessionVariableYouWantToHold = id; 
```

# visual-c++ - 如何在 VC++ 中将 byte* 转换为 jpeg 文件

> ID：621550
> 
> 赞同：0
> 
> 时间：2009-03-07T08:49:49.533
> 
> 标签：visual-c++

如何在 VC++ 中将 byte* 转换为 jpeg 文件

我正在捕获视频样本并将其写入 bmp 文件，但我想使用 ATL COM 中的 MFC 支持将该视频样本写入 jpeg 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T09:08:58.660

使用 libjpg。下载地址：[http ://www.ijg.org/](http://www.ijg.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T08:54:21.537

`byte`从它的外观来看，您在对象指向的缓冲区中拥有图像数据。请注意，该类型实际上是`BYTE`（全部大写）。如果数据已经是 JPEG 格式，为什么不将该数据写入文件（使用合适的 '.jpg' 或 '.jpeg' 扩展名）并尝试使用图像编辑器加载它？否则，您需要将其解码为原始格式并以 JPEG 格式进行编码。

或者，您需要更详细地解释您的问题，最好使用一些代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T09:19:45.437

ImageMagick 可以将原始图像数据转换为 JPEG。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-21T11:56:18.227

您也可以尝试使用[CxImage](http://www.codeproject.com/KB/graphics/cximage.aspx) C++ 类将您的静止图像保存为 JPEG 编码文件。

CodeProject 上还有一些面向 Windows API 的替代方案，例如[CMiniJpegEncoder](http://www.codeproject.com/KB/graphics/tonyjpeglib.aspx)

如果使用 libjpeg 支持编译，甚至可以使用[libgd](http://libgd.org)库将 JPEG 渲染到 Windows 位图中的文件。这是我前段时间为此目的开发的小型扩展函数[gdImageTrueColorAttachBuffer的代码：](http://cvs.php.net/viewvc.cgi/gd/libgd/examples/windows.c?diff_format=u&revision=1.1&view=markup)

```
// libgd ext// libgd extension by Mateusz Loskot <mateusz at loskot dot net>
// Originally developed for Windows CE to enable direct drawing
// on Windows API Device Context using libgd API.
// Complete example available in libgd CVS:
// http://cvs.php.net/viewvc.cgi/gd/libgd/examples/windows.c?diff_format=u&revision=1.1&view=markup
//
gdImagePtr gdImageTrueColorAttachBuffer(int* buffer, int sx, int sy, int stride)
{
    int i;
    int height;
    int* rowptr;
    gdImagePtr im;
    im = (gdImage *) malloc (sizeof (gdImage));
    if (!im) {
        return 0;
    }
    memset (im, 0, sizeof (gdImage));
#if 0
    if (overflow2(sizeof (int *), sy)) {
        return 0;
    }
#endif

    im->tpixels = (int **) malloc (sizeof (int *) * sy);
    if (!im->tpixels) {
        free(im);
        return 0;
    }

    im->polyInts = 0;
    im->polyAllocated = 0;
    im->brush = 0;
    im->tile = 0;
    im->style = 0;

    height = sy;
    rowptr = buffer;
    if (stride < 0) {
        int startoff = (height - 1) * stride;
        rowptr = buffer - startoff;
    }

    i = 0;
    while (height--) {
        im->tpixels[i] = rowptr;
        rowptr += stride;
        i++;
    }

    im->sx = sx;
    im->sy = sy;
    im->transparent = (-1);
    im->interlace = 0;
    im->trueColor = 1;
    im->saveAlphaFlag = 0;
    im->alphaBlendingFlag = 1;
    im->thick = 1;
    im->AA = 0;
    im->cx1 = 0;
    im->cy1 = 0;
    im->cx2 = im->sx - 1;
    im->cy2 = im->sy - 1;
    return im;
}

void gdSaveJPEG(void* bits, int width, int height, const char* filename)
{
    bool success = false;
    int stride = ((width * 1 + 3) >> 2) << 2;
    gdImage* im = gdImageTrueColorAttachBuffer((int*)bits, width, height, -stride);
    if (0 != im)
    {
        FILE* jpegout = fopen(filename, "wb");
        gdImageJpeg(im, jpegout, -1);
        fclose(jpegout);
        success = true;
    }
    gdImageDestroy(im);
    return success;
} 
```

我希望它有所帮助。

# python - re.compile(r'[[]]') 匹配什么？

> ID：621560
> 
> 赞同：4
> 
> 时间：2009-03-07T08:59:27.857
> 
> 标签：python, regex

使用 Python 的 re 模块，为什么以下行为会有所不同：

```
>>> r = re.compile(r'[][]')
>>> r.findall(r'[]')
['[', ']']
>>> r = re.compile(r'[[]]')
>>> r.findall(r'[]')
['[]']
>>> r.findall(r'][')
[] 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-07T09:11:20.653

正则表达式“[[]]”匹配子字符串“[]”。表达式中的第一个 [ 开始一个字符类，第一个 ] 结束它。类中只有一个字符 ([)，然后必须跟第二个 ]。所以表达式是““[”中的任何字符，后跟“]”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T09:56:40.527

字符类以 a 开头，以**`[`**first 结尾**`]`**。

所以表达式`[][]`是一个带有字符的字符类`]`，`[`因为字符类不能为空： 表达式是一个字符类，后面只有一个字符：**`[`**`][`**`]`**
`[[]]``[``]`**`[`**`[`**`]`**`]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T09:47:53.293

和 r'[][]' 形成一个字符类 {'[',']'}，并匹配 '[' 或 ']'。

# c# - 如何通过邮件附加程序文件中存在的pdf文件

> ID：621562
> 
> 赞同：1
> 
> 时间：2009-03-07T09:02:43.590
> 
> 标签：c#

正在我的 c# 代码中生成一个 pdf 文件...我想使用附件将该 pdf 文件和我的邮件 ID 相同...任何人都可以帮助我在内部使用 c# 代码通过附件发送 pdf

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T09:24:20.403

您可以将您的 pdf 文件附加为：

```
MailMessage message = new MailMessage();
message.To = "mailgoesto@domain.com";
message.From = "mailcomesfrom@domain.com";
message.Subject = "mail with pdf";
message.Body = "your pdf attached";
message.Attachments.Add(new Attachment(@"c:\pdftoattach.pdf"));

SmtpMail.SmtpServer = "mail.domain.com";
SmtpMail.Send(message); 
```

# vb.net - VB.NET 中的 PDF 文件（从 VB 6 升级问题）

> ID：621565
> 
> 赞同：1
> 
> 时间：2009-03-07T09:06:39.197
> 
> 标签：vb.net, vb6, pdf-generation, upgrade, vb6-migration

我已将我的项目从 vb6 升级到 VB.NET。该项目用于生成pdf文件..升级时我遇到了以下问题。

代码：

> 'UPGRADE_ISSUE：常量 vbUnicode 未升级。点击查看更多：
> 'ms-help://MS.VSCC.2003/commoner/redir/redirect.htm?keyword="vbup2070"' 'taptisColor = IIf(mvarEncodeASCII85, ToASCII85(ImgColor), StrConv(System.Text.UnicodeEncoding) .Unicode.GetString(ImgColor), vbUnicode)) sColor = IIf(mvarEncodeASCII85, ToASCII85(ImgColor),
> DecodeString(System.Text.Encoding.UTF8.GetString(ImgColor))) 'sColor = IIf(mvarEncodeASCII85, ToASCII85(ImgColor),
> StrConv（System.Text.UnicodeEncoding.Unicode.GetString（ImgColor），VbStrConv.None））

问题是它显示一个黑色矩形，它应该将图像显示为徽标。

请帮忙。如何解决 unicode 升级问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T09:48:48.270

此 Microsoft 论坛主题可以帮助解决该问题：

[升级 VBA StrConv 字节数组 vbUnicode ToString](http://social.microsoft.com/Forums/en-US/vblanguage/thread/ee8944c9-2207-4812-b5cb-17515ac82435)

而不是`StrConv`，尝试使用 .NET 命名空间中的类`System.Text.Encoding`。

# asp.net - web.config 中的 debug=true = 坏事？

> ID：621572
> 
> 赞同：59
> 
> 时间：2009-03-07T09:15:24.620
> 
> 标签：asp.net, web-config

我们看到很多虚拟内存碎片和内存不足错误，然后它达到了 3GB 的限制。

编译调试在 web.config 中设置为 true，但我从每个人那里得到不同的答案，调试设置为 true 是否会导致每个 aspx 编译到 ram 的随机区域，从而使该 ram 碎片化并最终导致内存不足问题？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-07T10:25:32.847

Scott Guthrie（ASP.NET 开发团队的经理）有一篇[关于它的有趣帖子](http://weblogs.asp.net/scottgu/archive/2006/04/11/442448.aspx)。

你不应该离开的最重要的几点`debug="true"`是：

> 1.  ASP.NET 页面的编译需要更长的时间（因为禁用了一些批处理优化）
> 2.  代码执行速度可能会变慢（因为启用了一些额外的调试路径）
> 3.  在运行时在应用程序中使用更多的内存
> 4.  从 WebResources.axd 处理程序下载的脚本和图像不会被浏览器缓存，从而导致客户端和服务器之间的请求更多

他还提到了`<deployment retail=”true”/`machine.config 中的标志 >，它允许全局覆盖在机器上（例如在生产服务器上）运行的所有应用程序的 debug="true" 标志。

* * *

**更新**：部署 Web 应用程序`debug="true"`仍然很糟糕，您可以在[Scott Hanselman 最近的博客文章](http://www.hanselman.com/blog/MostCommonASPNETSupportIssuesReportingFromDeepInsideMicrosoftDeveloperSupport.aspx)中看到：

> 这就是为什么 debug="true" 不好的原因。说真的，我们不是在开玩笑。
> 
> *   覆盖请求执行超时，使其有效地无限
> *   禁用页面和 JIT 编译器优化
> *   在 1.1 中，导致 CLR 使用过多的内存来进行调试信息跟踪
> *   在 1.1 中，关闭了动态页面的批量编译，导致每页 1 个程序集。
> *   对于 VB.NET 代码，会导致过度使用 Wea​​kReferences（用于编辑和继续支持）。
> 
> 重要说明：与有时认为的相反，在元素中设置retail="true" 并不是设置debug="true" 的直接解毒剂！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-07T10:09:01.793

除非您确实需要调试应用程序，否则在 web.config 中应将调试标志设置为 false。

在调试模式下运行可能会在一定程度上增加内存使用量，但它可能不像您所说的那样严重。但是，您应该将其设置为 false 以消除它的影响，看看您是否可以注意到任何改进。

在调试模式下运行时，垃圾收集的工作方式不同。变量的生命周期从它的实际使用扩展到变量的范围（以便能够在调试器中显示值）。这使得一些对象在被垃圾回收之前存活的时间更长。

编译器在调试模式下编译时不会对代码进行优化，还增加了一些额外的`nop`指令，使每一行代码至少有一条可以放置断点的指令。

在调试模式下抛出异常需要相当长的时间。（但是，通常代码不应该经常抛出异常。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-18T22:11:26.923

它绝对会影响内存，只需查看一些性能计数器并与两种配置进行比较即可。

如果您的站点有很多文件，我会更关心 asp.net 临时文件夹中的磁盘 io。

几个问题...

1.  您的 App_Code 中有很多文件吗？
2.  您是允许网站更新还是发布它？
3.  如果是这样，该站点是否经常更新或是否有部署过程？
4.  硬件配置是什么？

为什么不使用多种配置？

Web.Debug.Config - 已打开调试 Web.UAT.Config - 无论您的偏好如何 Web.Release.Config - 已关闭调试

通过这种方式，您可以最大限度地减少回归配置错误，例如开发人员使用 debug="true" 检查 web.config

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-07T09:33:29.150

AFAIK“debug = true”不会导致你提到的情况。

我在使用动态创建图像的 ASP.NET 应用程序时遇到了同样的问题。

所以我认为您对未处置的资源有疑问。

如果您将带有代码隐藏文件的 aspx 文件部署到服务器。当请求到达一个aspx时，它将被编译一次。然后它将被存储到缓存中，直到文件更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-18T21:51:18.700

在生产系统上始终设置 Debug=false。正如标志所暗示的，它应该只在调试开发系统时设置为 true。

该标志与您的内存碎片问题无关。

# c# - c#中new关键字的工作原理

> ID：621573
> 
> 赞同：0
> 
> 时间：2009-03-07T09:15:50.690
> 
> 标签：c#, .net, c++

有一个类被编译成一个dll

```
//HeaderFile.h 
//version 1.0
class __declspec(dllexport) A {
    int variable;
//member functions omitted for clarity
};

//implementation file omitted for clarity 
```

您从编译成的 dll 构建一个使用上述类的 exe

```
#include "HeaderFile.h"
int main() {
    A *obj = new A();
    obj->CallSomeFuncOnObj();

    //
    //whatever
    //
} 
```

到目前为止，您的程序运行良好。但是现在你用下面的代码**重新编译你的 dll**

```
//HeaderFile.h
//version 2.0
class __declspec(dllexport) A {
    int variable;
    int anotherVariable;
//member functions omitted for clarity
};

//implementation file omitted for clarity 
```

并且您**不会重新编译您的 exe**，而是开始使用旧 exe 中重新编译的 dll。现在会发生的是，您的 exe 具有将分配内存 = sizeof（A 类 1.0 版）的代码，但您的新 dll 中的构造函数的代码假定它正在传递一个内存块 = sizeof（A 类 2.0 版）。两者之间有一个整数的价值大小差异 - 一个不可预测的秘诀。

一个类似的例子出现在一本好书的第一章——Don Box 的 Essential COM。现在来回答这个问题。在 c#（或任何其他 .Net 语言）中的类似情况下会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T09:22:08.160

在 COM 中，您的 DLL 实现了一个对象工厂：DLL 自己创建对象以避免此类“同步”问题。在 .NET 中，CLR 根据从实现类型的 DLL 中提取的类型知识来实例化对象。在这两种情况下，都避免了您提到的问题。

# jquery - JQuery：为什么不显眼的 JavaScript / Document Ready 函数而不是 OnClick 事件？

> ID：621574
> 
> 赞同：6
> 
> 时间：2009-03-07T09:15:52.810
> 
> 标签：jquery, unobtrusive-javascript, document-ready

我刚刚开始研究 JQuery。目前我的 Web 应用程序中没有任何 AJAX。

我的 HTML 中现有的 JavaScript 如下所示：

```
<form ...>
<p>Find what? <input ...></p>
<div class="ButtonArray">
  <a href="AddRecord.ASP&amp;Action=ADD">ADD</a>
  <a href="#" onClick="return MyFormSubmit();">FIND</a>
</div>
</form> 
```

这会显示 [添加] 和 [查找] 的按钮。对于 Find ，必须提交表单，我使用 MyFormSubmit() 验证数据，为页面添加视觉效果，然后 POST 数据。

我可以为 Find 按钮添加一个 CLASS 或 ID，在 JQuery 中我可以编写如下内容：

```
$(function() {
  $(".MySearchButtonClass").click(function() {
    // validate and process form here
  });
}); 
```

在我对 JQuery 的“新手”理解阶段，我不*明白*为什么我会这样做

我的旧方法识别对象附近的方法。在用户按下按钮之前可能存在 JS 尚未加载的风险（是否存在？JS 的 LOAD 就在页面顶部）。

在加载文档之前，不会激活 JQuery Document Ready 方法（我假设保证 JS 全部存在并准备好运行？），但它将代码移动到我的 HTML 文件的单独部分 - 所以当我在 HTML 源代码中看到了 MyButtonArray DIV，我不清楚哪些对象有方法，哪些没有。

你能帮我理解我的选择是什么以及我应该注意的好处/陷阱吗？

**编辑**：我很满意 DOM 操作 - 例如当单击任何具有“LightBoxThumb”类的缩略图时可以出现的灯箱 - 将使用不显眼的 Javascript。

但是，我正在努力说服自己，具有特定操作的按钮应该以这种方式应用其方法。（除了对“其他地方”的单个函数调用之外，我当然不会在按钮上放置任何代码，但在我看来，这是我关于该按钮功能的最佳线索，并且 Unobtrusive Javascript 层可能会使这更加困难来确定。）

**Edit2 - 接受的答案**

我已经接受了 Russ Cams 的回答。它以一种有助于我了解更多关于如何以及何时使用它的方式来描述 Unobtrusive Javascript。

目前（当我有更多经验时可能会改变！）我会坚持使用 OnClick 事件来对对象进行单个、不变的操作，因为我觉得这对我来说更容易调试 - 并在出现问题时进行诊断. 对于允许单击标题列进行排序的表格上的 ZebraStripes（以及该类型的情况），我可以看到 Unobtrusive Javascript 方法的好处

Russ 的最后评论特别有帮助，在此重复：

> “@Kristen - 你是对的，就像很多编程主题一样，有不止一种方法，人们会强烈地坚持他们的信念！如果我们谈论一个按钮的单一方法，我完全理解你在哪里'来自...
> 
> 如果我们谈论大量的 JavaScript，相同的函数调用多个元素，不同的函数调用不同的方法，等等。我认为自己混合内联和不显眼的方法会更困难，它会是最好采用一种或另一种方法”

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-07T09:32:27.373

[Unobtrusive JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)是将 JS 代码与标记分离的主要驱动力

> *   将功能（“行为层”）与网页的
>     结构/内容和表示分离
> *   避免传统 JavaScript 编程问题的最佳实践（例如浏览器不一致和缺乏可扩展性）
> *   逐步增强以支持可能不支持
>     高级 JavaScript 功能的用户代理

使用 document.ready 中的代码，在加载 DOM 和加载页面内容之前，它不会执行

从[学习 jQuery](http://www.learningjquery.com/2006/09/introducing-document-ready)

> 使用 $(document).ready()，您可以让事件加载或触发，或者在窗口加载之前让它们执行任何操作。

您可能想看看[jQuery in Action](https://rads.stackoverflow.com/amzn/click/com/1933988355)，我强烈推荐它。您可以在[本书的主页上对](http://www.manning.com/bibeault/)[第 1](http://www.manning-source.com/books/bibeault/ch01_JQIA_sample.pdf)章和[第 5](http://www.manning-source.com/books/bibeault/ch05_JQIA_sample.pdf)章进行示例。我认为这样做可以进一步了解为什么分离可以很好地工作。

最后，看看[这个问题](https://stackoverflow.com/questions/446892/how-to-find-event-listeners-on-a-dom-node/447106#447106)，它的答案详细说明了如何在 DOM 节点上找到事件侦听器。

**编辑：**

一些想法可能会说服你为什么不显眼的 JavaScript 可能是一个好主意。

想象一下，你有一个函数绑定为事件处理程序，用于在每个元素上引发的相同事件 -

*   当声明在每个元素中内联时，或者声明在标记之外的一个地方时，找出哪些元素调用该函数来处理事件会更容易吗？

*   如果您想在每个元素上引发事件时添加调用该函数的元素怎么办？将事件处理程序内联添加到每个元素或在一个地方更改代码会更容易/更好吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T09:44:27.280

文档就绪事件早于文档加载事件。一旦加载了 DOM，就会发生文档就绪，这样所有元素在您开始处理它们之前就已经存在。

所以是的，JS 将在文档呈现时准备就绪。关于绑定的另一点是，当发生某些动作时，它对于更改元素的绑定很有用。

如果您愿意，您仍然可以在元素上声明操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T15:18:47.460

随着时间的推移，我认为你会习惯 jQuery 语法和阅读：

class="MyFormSubmit" 变得像阅读 onClick="return MyFormSubmit();

真正开始发挥作用的地方（除了其他海报提到的所有好处）是您可以轻松地通过选择器更改 onClick 绑定，这些选择器与网页上的其他操作相关联，而这些选择器最初似乎从未出现过。

我问自己的一个问题是我计划使用任何新工具的深度，如果我计划广泛使用框架或库，那么以“更原生”的编码风格编写我的代码将变得更加自然和其他了解该工具的开发人员会发现代码更清晰、更易于理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T09:28:34.510

您这样做是为了将 UI 逻辑与实际的 HTML 设计分开。

# architecture - 安装和升级应用的高级设计

> ID：621575
> 
> 赞同：0
> 
> 时间：2009-03-07T09:16:02.980
> 
> 标签：architecture, workflow

我需要编写一个非常简单的 WinForms 应用程序，但我经常陷入过度分析模式。我被困在是，否，重试循环上，几乎没有考虑过应用程序的操作，我开始考虑应用程序的“工作流程”。在检查前一个任务没有引发“中止”标志之后，我是否应该为每个任务设置一个方法，并按顺序调用每个任务？

我是否应该实现一个简单的 ITask 接口和每个任务的类，然后遍历有序的任务集合？我应该将其用作对 Windows 工作流的简单介绍吗？这个应用程序的范围和它的任务集保证会增长，所以我的第一个硬编码任务的选择是最讨厌的，但是考虑到应用程序的大小，只需更改代码就可以很容易地完成维护；可执行文件始终与升级材料一起部署，而不是永久部署。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T03:49:23.787

在工作流基础上，我会将其保留在高级场景/项目中，您将在其中大量使用它，例如您希望根据用户/公司改变的高度可定制的工作流、复杂的工作流需求、暂停/继续。

我会选择 ITask 路线，因为它的灵活性（相对于简单的方法），同时仍然很简单。我觉得它也会帮助你进行单元/集成测试。也就是说，我建议密切关注任务的重用，比如文件移动任务，因为您不想以大量相同的任务结束。只需在重构步骤中执行此操作，这样您就可以让实际需求/使用决定您需要什么（在测试中 - TDD :)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T10:03:11.840

做最简单的事。您可以随时重构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T16:21:50.213

我要补充彼得的建议，“做最简单的事情可能会奏效*，这也是好的设计*”。

有时候，从设计的角度来看，“最简单”的事情也是最愚蠢的事情，它会在未来引起悲伤，这与 Extremem Programming 的口头禅所追求的相反。

你的第二个选项对我来说听起来不错。它实施简单，设计良好，便于后期维护。

# c# - 如何在 C# 中监视剪贴板更改？

> ID：621577
> 
> 赞同：94
> 
> 时间：2009-03-07T09:18:04.397
> 
> 标签：c#, events, clipboard

是否有我可以通过 C# 访问的剪贴板更改或更新事件？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-09-08T14:05:02.727

为了完整起见，这是我在生产代码中使用的控件。只需从设计器中拖动并双击即可创建事件处理程序。

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using System.Drawing;

namespace ClipboardAssist {

// Must inherit Control, not Component, in order to have Handle
[DefaultEvent("ClipboardChanged")]
public partial class ClipboardMonitor : Control 
{
    IntPtr nextClipboardViewer;

    public ClipboardMonitor()
    {
        this.BackColor = Color.Red;
        this.Visible = false;

        nextClipboardViewer = (IntPtr)SetClipboardViewer((int)this.Handle);
    }

    /// <summary>
    /// Clipboard contents changed.
    /// </summary>
    public event EventHandler<ClipboardChangedEventArgs> ClipboardChanged;

    protected override void Dispose(bool disposing)
    {
        ChangeClipboardChain(this.Handle, nextClipboardViewer);
    }

    [DllImport("User32.dll")]
    protected static extern int SetClipboardViewer(int hWndNewViewer);

    [DllImport("User32.dll", CharSet = CharSet.Auto)]
    public static extern bool ChangeClipboardChain(IntPtr hWndRemove, IntPtr hWndNewNext);

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern int SendMessage(IntPtr hwnd, int wMsg, IntPtr wParam, IntPtr lParam);

    protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        // defined in winuser.h
        const int WM_DRAWCLIPBOARD = 0x308;
        const int WM_CHANGECBCHAIN = 0x030D;

        switch (m.Msg)
        {
            case WM_DRAWCLIPBOARD:
                OnClipboardChanged();
                SendMessage(nextClipboardViewer, m.Msg, m.WParam, m.LParam);
                break;

            case WM_CHANGECBCHAIN:
                if (m.WParam == nextClipboardViewer)
                    nextClipboardViewer = m.LParam;
                else
                    SendMessage(nextClipboardViewer, m.Msg, m.WParam, m.LParam);
                break;

            default:
                base.WndProc(ref m);
                break;
        }
    }

    void OnClipboardChanged()
    {
        try
        {
            IDataObject iData = Clipboard.GetDataObject();
            if (ClipboardChanged != null)
            {
                ClipboardChanged(this, new ClipboardChangedEventArgs(iData));
            }

        }
        catch (Exception e)
        {
            // Swallow or pop-up, not sure
            // Trace.Write(e.ToString());
            MessageBox.Show(e.ToString());
        }
    }
}

public class ClipboardChangedEventArgs : EventArgs
{
    public readonly IDataObject DataObject;

    public ClipboardChangedEventArgs(IDataObject dataObject)
    {
        DataObject = dataObject;
    }
}
} 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-03-07T09:24:08.330

我认为你必须使用一些 p/invoke：

```
[DllImport("User32.dll", CharSet=CharSet.Auto)]
public static extern IntPtr SetClipboardViewer(IntPtr hWndNewViewer); 
```

请参阅[这篇文章，了解如何在 C# 中设置剪贴板监视器](https://web.archive.org/web/20131104125500/http://www.radsoftware.com.au/articles/clipboardmonitor.aspx)

基本上，您将您的应用程序注册为剪贴板查看器，使用

```
_ClipboardViewerNext = SetClipboardViewer(this.Handle); 
```

然后您将收到`WM_DRAWCLIPBOARD`消息，您可以通过覆盖来处理`WndProc`：

```
protected override void WndProc(ref Message m)
{
    switch ((Win32.Msgs)m.Msg)
    {
        case Win32.Msgs.WM_DRAWCLIPBOARD:
        // Handle clipboard changed
        break;
        // ... 
   }
} 
```

（还有更多工作要做；沿剪贴板链传递内容并取消注册您的视图，但您可以从[文章](https://web.archive.org/web/20131104125500/http://www.radsoftware.com.au/articles/clipboardmonitor.aspx)中获得）

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-10-08T14:19:27.753

我在 WPF 中遇到了这个挑战，最终使用了下面描述的方法。对于 windows 窗体，此答案的其他地方有很好的示例，例如 ClipboardHelper 控件。

对于 WPF，我们无法覆盖 WndProc，因此我们必须使用窗口中的 Source 将其与 HwndSource AddHook 调用显式挂钩。剪贴板侦听器仍使用 AddClipboardFormatListener 本机互操作调用。

本机方法：

```
internal static class NativeMethods
{
    // See http://msdn.microsoft.com/en-us/library/ms649021%28v=vs.85%29.aspx
    public const int WM_CLIPBOARDUPDATE = 0x031D;
    public static IntPtr HWND_MESSAGE = new IntPtr(-3);

    // See http://msdn.microsoft.com/en-us/library/ms632599%28VS.85%29.aspx#message_only
    [DllImport("user32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool AddClipboardFormatListener(IntPtr hwnd);
} 
```

剪贴板管理器类：

```
using System.Windows;
using System.Windows.Interop;

public class ClipboardManager
{
    public event EventHandler ClipboardChanged;

    public ClipboardManager(Window windowSource)
    {
        HwndSource source = PresentationSource.FromVisual(windowSource) as HwndSource;
        if(source == null)
        {
            throw new ArgumentException(
                "Window source MUST be initialized first, such as in the Window's OnSourceInitialized handler."
                , nameof(windowSource));
        }

        source.AddHook(WndProc);

        // get window handle for interop
        IntPtr windowHandle = new WindowInteropHelper(windowSource).Handle;

        // register for clipboard events
        NativeMethods.AddClipboardFormatListener(windowHandle);
    }

    private void OnClipboardChanged()
    {
        ClipboardChanged?.Invoke(this, EventArgs.Empty);
    }

    private static readonly IntPtr WndProcSuccess = IntPtr.Zero;

    private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
    {
        if (msg == NativeMethods.WM_CLIPBOARDUPDATE)
        {
            OnClipboardChanged();
            handled = true;
        }

        return WndProcSuccess;
    }
} 
```

这通过在 OnSourceInitialized 或更高版本中添加事件（例如 Window.Loaded 事件或在操作期间）在 WPF 窗口中使用。（当我们有足够的信息来使用原生钩子时）：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    protected override void OnSourceInitialized(EventArgs e)
    {
        base.OnSourceInitialized(e);

        // Initialize the clipboard now that we have a window soruce to use
        var windowClipboardManager = new ClipboardManager(this);
        windowClipboardManager.ClipboardChanged += ClipboardChanged;
    }

    private void ClipboardChanged(object sender, EventArgs e)
    {
        // Handle your clipboard update here, debug logging example:
        if (Clipboard.ContainsText())
        {
            Debug.WriteLine(Clipboard.GetText());
        }
    }
} 
```

我在流放之路项目分析器项目中使用了这种方法，因为当您按下 Ctrl-C 时，游戏会通过剪贴板公开项目信息。

[https://github.com/ColinDabritz/PoeItemAnalyzer](https://github.com/ColinDabritz/PoeItemAnalyzer)

我希望这对 WPF 剪贴板更改处理的人有所帮助！

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-01-15T19:17:17.077

好的，这是一篇旧文章，但与当前的一组答案相比，我们找到了一个看起来非常简单的解决方案。我们正在使用 WPF，并且我们希望在剪贴板包含文本时启用和禁用我们自己的自定义命令（在 ContextMenu 中）。已经有一个 ApplicationCommands.Cut、Copy 和 Paste 并且这些命令正确响应剪贴板的变化。所以我们只是添加了以下EventHandler。

```
ApplicationCommands.Paste.CanExecuteChanged += new EventHandler(Paste_CanExecuteChanged);

private void Paste_CanExecuteChanged(object sender, EventArgs e) {
  ourVariable= Clipboard.ContainsText();
} 
```

我们实际上是通过这种方式在我们自己的 Command 上控制 CanExecute。适用于我们需要的东西，也许它会帮助其他人。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-04-28T12:18:08.517

有多种方法可以做到这一点，但这是我最喜欢的并且对我有用。我创建了一个类库，以便其他人可以添加项目并包含 DLL，然后只需调用它并在应用程序中的任何位置使用它。

[这个答案是在这个](https://stackoverflow.com/questions/6458030/clipboard-change-notification)的帮助下做出的。

1.  创建类库项目并将其命名为 ClipboardHelper。
2.  将 Class1 名称替换为 ClipboardMonitor。
3.  将以下代码添加到其中。
4.  添加 System.Windows.Forms 引用。

代码下的更多步骤。

```
using System;
using System.Windows.Forms;
using System.Threading;
using System.Runtime.InteropServices;

namespace ClipboardHelper
{
    public static class ClipboardMonitor
    {
        public delegate void OnClipboardChangeEventHandler(ClipboardFormat format, object data);
        public static event OnClipboardChangeEventHandler OnClipboardChange;

        public static void Start()
        {
            ClipboardWatcher.Start();
            ClipboardWatcher.OnClipboardChange += (ClipboardFormat format, object data) =>
            {
                if (OnClipboardChange != null)
                    OnClipboardChange(format, data);
            };
        }

        public static void Stop()
        {
            OnClipboardChange = null;
            ClipboardWatcher.Stop();
        }

        class ClipboardWatcher : Form
        {
            // static instance of this form
            private static ClipboardWatcher mInstance;

            // needed to dispose this form
            static IntPtr nextClipboardViewer;

            public delegate void OnClipboardChangeEventHandler(ClipboardFormat format, object data);
            public static event OnClipboardChangeEventHandler OnClipboardChange;

            // start listening
            public static void Start()
            {
                // we can only have one instance if this class
                if (mInstance != null)
                    return;

                var t = new Thread(new ParameterizedThreadStart(x => Application.Run(new ClipboardWatcher())));
                t.SetApartmentState(ApartmentState.STA); // give the [STAThread] attribute
                t.Start();
            }

            // stop listening (dispose form)
            public static void Stop()
            {
                mInstance.Invoke(new MethodInvoker(() =>
                {
                    ChangeClipboardChain(mInstance.Handle, nextClipboardViewer);
                }));
                mInstance.Invoke(new MethodInvoker(mInstance.Close));

                mInstance.Dispose();

                mInstance = null;
            }

            // on load: (hide this window)
            protected override void SetVisibleCore(bool value)
            {
                CreateHandle();

                mInstance = this;

                nextClipboardViewer = SetClipboardViewer(mInstance.Handle);

                base.SetVisibleCore(false);
            }

            [DllImport("User32.dll", CharSet = CharSet.Auto)]
            private static extern IntPtr SetClipboardViewer(IntPtr hWndNewViewer);

            [DllImport("User32.dll", CharSet = CharSet.Auto)]
            private static extern bool ChangeClipboardChain(IntPtr hWndRemove, IntPtr hWndNewNext);

            [DllImport("user32.dll", CharSet = CharSet.Auto)]
            private static extern int SendMessage(IntPtr hwnd, int wMsg, IntPtr wParam, IntPtr lParam);

            // defined in winuser.h
            const int WM_DRAWCLIPBOARD = 0x308;
            const int WM_CHANGECBCHAIN = 0x030D;

            protected override void WndProc(ref Message m)
            {
                switch (m.Msg)
                {
                    case WM_DRAWCLIPBOARD:
                        ClipChanged();
                        SendMessage(nextClipboardViewer, m.Msg, m.WParam, m.LParam);
                        break;

                    case WM_CHANGECBCHAIN:
                        if (m.WParam == nextClipboardViewer)
                            nextClipboardViewer = m.LParam;
                        else
                            SendMessage(nextClipboardViewer, m.Msg, m.WParam, m.LParam);
                        break;

                    default:
                        base.WndProc(ref m);
                        break;
                }
            }

            static readonly string[] formats = Enum.GetNames(typeof(ClipboardFormat));

            private void ClipChanged()
            {
                IDataObject iData = Clipboard.GetDataObject();

                ClipboardFormat? format = null;

                foreach (var f in formats)
                {
                    if (iData.GetDataPresent(f))
                    {
                        format = (ClipboardFormat)Enum.Parse(typeof(ClipboardFormat), f);
                        break;
                    }
                }

                object data = iData.GetData(format.ToString());

                if (data == null || format == null)
                    return;

                if (OnClipboardChange != null)
                    OnClipboardChange((ClipboardFormat)format, data);
            }
        }
    }

    public enum ClipboardFormat : byte
    {
        /// <summary>Specifies the standard ANSI text format. This static field is read-only.
        /// </summary>
        /// <filterpriority>1</filterpriority>
        Text,
        /// <summary>Specifies the standard Windows Unicode text format. This static field
        /// is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        UnicodeText,
        /// <summary>Specifies the Windows device-independent bitmap (DIB) format. This static
        /// field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Dib,
        /// <summary>Specifies a Windows bitmap format. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Bitmap,
        /// <summary>Specifies the Windows enhanced metafile format. This static field is
        /// read-only.</summary>
        /// <filterpriority>1</filterpriority>
        EnhancedMetafile,
        /// <summary>Specifies the Windows metafile format, which Windows Forms does not
        /// directly use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        MetafilePict,
        /// <summary>Specifies the Windows symbolic link format, which Windows Forms does
        /// not directly use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        SymbolicLink,
        /// <summary>Specifies the Windows Data Interchange Format (DIF), which Windows Forms
        /// does not directly use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Dif,
        /// <summary>Specifies the Tagged Image File Format (TIFF), which Windows Forms does
        /// not directly use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Tiff,
        /// <summary>Specifies the standard Windows original equipment manufacturer (OEM)
        /// text format. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        OemText,
        /// <summary>Specifies the Windows palette format. This static field is read-only.
        /// </summary>
        /// <filterpriority>1</filterpriority>
        Palette,
        /// <summary>Specifies the Windows pen data format, which consists of pen strokes
        /// for handwriting software, Windows Forms does not use this format. This static
        /// field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        PenData,
        /// <summary>Specifies the Resource Interchange File Format (RIFF) audio format,
        /// which Windows Forms does not directly use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Riff,
        /// <summary>Specifies the wave audio format, which Windows Forms does not directly
        /// use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        WaveAudio,
        /// <summary>Specifies the Windows file drop format, which Windows Forms does not
        /// directly use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        FileDrop,
        /// <summary>Specifies the Windows culture format, which Windows Forms does not directly
        /// use. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Locale,
        /// <summary>Specifies text consisting of HTML data. This static field is read-only.
        /// </summary>
        /// <filterpriority>1</filterpriority>
        Html,
        /// <summary>Specifies text consisting of Rich Text Format (RTF) data. This static
        /// field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Rtf,
        /// <summary>Specifies a comma-separated value (CSV) format, which is a common interchange
        /// format used by spreadsheets. This format is not used directly by Windows Forms.
        /// This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        CommaSeparatedValue,
        /// <summary>Specifies the Windows Forms string class format, which Windows Forms
        /// uses to store string objects. This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        StringFormat,
        /// <summary>Specifies a format that encapsulates any type of Windows Forms object.
        /// This static field is read-only.</summary>
        /// <filterpriority>1</filterpriority>
        Serializable,
    }
} 
```

5.  在您的其他项目中，右键单击解决方案并添加 -> 退出项目 -> ClipboardHelper.csproj
6.  在您的项目中，转到并右键单击参考 -> 添加参考 -> 解决方案 -> 选择 ClipboardHelper。
7.  在项目类型的类文件中使用 ClipboardHelper。
8.  您现在可以键入 ClipboardMonitor.Start 或 .Stop 或 .OnClipboardChanged

    ```
    using ClipboardHelper;

    namespace Something.Something.DarkSide
    {
        public class MainWindow
        {

            public MainWindow()
            {
                InitializeComponent();

                Loaded += MainWindow_Loaded;
            }

            void MainWindow_Loaded(object sender, RoutedEventArgs e)
            {
                ClipboardMonitor.OnClipboardChange += ClipboardMonitor_OnClipboardChange;
                ClipboardMonitor.Start();
            }               

            private void ClipboardMonitor_OnClipboardChange(ClipboardFormat format, object data)
            {
                // Do Something...
            }
    } 
    ```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-02-07T10:15:04.217

[SharpClipboard](https://github.com/Willy-Kimura/SharpClipboard)作为一个库可能会带来更多好处，因为它将相同的功能封装到一个精细的组件库中。然后，您可以访问其`ClipboardChanged`事件并在剪切/复制时检测各种数据格式。

您可以选择要监控的各种数据格式：

```
var clipboard = new SharpClipboard();

clipboard.ObservableFormats.Texts = true;
clipboard.ObservableFormats.Files = true;
clipboard.ObservableFormats.Images = true;
clipboard.ObservableFormats.Others = true; 
```

这是一个使用其`ClipboardChanged`事件的示例：

```
private void ClipboardChanged(Object sender, ClipboardChangedEventArgs e)
{
    // Is the content copied of text type?
    if (e.ContentType == SharpClipboard.ContentTypes.Text)
    {
        // Get the cut/copied text.
        Debug.WriteLine(clipboard.ClipboardText);
    }

    // Is the content copied of image type?
    else if (e.ContentType == SharpClipboard.ContentTypes.Image)
    {
        // Get the cut/copied image.
        Image img = clipboard.ClipboardImage;
    }

    // Is the content copied of file type?
    else if (e.ContentType == SharpClipboard.ContentTypes.Files)
    {
        // Get the cut/copied file/files.
        Debug.WriteLine(clipboard.ClipboardFiles.ToArray());

        // ...or use 'ClipboardFile' to get a single copied file.
        Debug.WriteLine(clipboard.ClipboardFile);
    }

    // If the cut/copied content is complex, use 'Other'.
    else if (e.ContentType == SharpClipboard.ContentTypes.Other)
    {
        // Do something with 'e.Content' here...
    }
} 
```

您还可以找出发生剪切/复制事件的应用程序及其详细信息：

```
private void ClipboardChanged(Object sender, SharpClipboard.ClipboardChangedEventArgs e)
{
    // Gets the application's executable name.
    Debug.WriteLine(e.SourceApplication.Name);
    // Gets the application's window title.
    Debug.WriteLine(e.SourceApplication.Title);
    // Gets the application's process ID.
    Debug.WriteLine(e.SourceApplication.ID.ToString());
    // Gets the application's executable path.
    Debug.WriteLine(e.SourceApplication.Path);
} 
```

还有其他事件，例如在`MonitorChanged`禁用剪贴板监视时侦听的事件，这意味着您可以在运行时启用或禁用监视剪贴板。

除此之外，由于它是一个组件，因此您可以通过将其拖放到 Windows 窗体中来在**设计器视图中使用它，这样任何人都可以非常轻松地自定义其选项并使用其内置事件。**

[SharpClipboard](https://github.com/Willy-Kimura/SharpClipboard)似乎是 .NET 中剪贴板监控方案的最佳选择。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-09-06T21:09:36.290

我相信早期的解决方案之一不会在 dispose 方法上检查 null：

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using System.Drawing;

namespace ClipboardAssist {

// Must inherit Control, not Component, in order to have Handle
[DefaultEvent("ClipboardChanged")]
public partial class ClipboardMonitor : Control 
{
    IntPtr nextClipboardViewer;

    public ClipboardMonitor()
    {
        this.BackColor = Color.Red;
        this.Visible = false;

        nextClipboardViewer = (IntPtr)SetClipboardViewer((int)this.Handle);
    }

    /// <summary>
    /// Clipboard contents changed.
    /// </summary>
    public event EventHandler<ClipboardChangedEventArgs> ClipboardChanged;

    protected override void Dispose(bool disposing)
    {
        if(nextClipboardViewer != null)
            ChangeClipboardChain(this.Handle, nextClipboardViewer);
    }

    [DllImport("User32.dll")]
    protected static extern int SetClipboardViewer(int hWndNewViewer);

    [DllImport("User32.dll", CharSet = CharSet.Auto)]
    public static extern bool ChangeClipboardChain(IntPtr hWndRemove, IntPtr hWndNewNext);

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern int SendMessage(IntPtr hwnd, int wMsg, IntPtr wParam, IntPtr lParam);

    protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        // defined in winuser.h
        const int WM_DRAWCLIPBOARD = 0x308;
        const int WM_CHANGECBCHAIN = 0x030D;

        switch (m.Msg)
        {
            case WM_DRAWCLIPBOARD:
                OnClipboardChanged();
                SendMessage(nextClipboardViewer, m.Msg, m.WParam, m.LParam);
                break;

            case WM_CHANGECBCHAIN:
                if (m.WParam == nextClipboardViewer)
                    nextClipboardViewer = m.LParam;
                else
                    SendMessage(nextClipboardViewer, m.Msg, m.WParam, m.LParam);
                break;

            default:
                base.WndProc(ref m);
                break;
        }
    }

    void OnClipboardChanged()
    {
        try
        {
            IDataObject iData = Clipboard.GetDataObject();
            if (ClipboardChanged != null)
            {
                ClipboardChanged(this, new ClipboardChangedEventArgs(iData));
            }

        }
        catch (Exception e)
        {
            // Swallow or pop-up, not sure
            // Trace.Write(e.ToString());
            MessageBox.Show(e.ToString());
        }
    }
}

    public class ClipboardChangedEventArgs : EventArgs
    {
        public readonly IDataObject DataObject;

        public ClipboardChangedEventArgs(IDataObject dataObject)
        {
            DataObject = dataObject;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-13T14:44:12.380

```
 [DllImport("User32.dll", CharSet = CharSet.Auto)]
        public static extern IntPtr SetClipboardViewer(IntPtr hWndNewViewer);
        private IntPtr _ClipboardViewerNext;

        private void Form1_Load(object sender, EventArgs e)
        {
            _ClipboardViewerNext = SetClipboardViewer(this.Handle);
        }

        protected override void WndProc(ref System.Windows.Forms.Message m)
        {
            const int WM_DRAWCLIPBOARD = 0x308;

            switch (m.Msg)
            {
                case WM_DRAWCLIPBOARD:
                    //Clipboard is Change 
                    //your code..............
                    break; 
                default:
                    base.WndProc(ref m);
                    break;
            }
        } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-06T17:07:51.610

剪贴板查看器可能面临的另一个问题：它在一段时间后停止接收 WM_DRAWCLIPBOARD 消息（似乎剪贴板链以某种方式中断）。我发现的唯一解决方案是在发现断链时重新注册剪贴板查看器。

为了我的需要，我创建了 nuget 包[https://github.com/magicmanam/windows-clipboard-viewer](https://github.com/magicmanam/windows-clipboard-viewer) ，它包装了所有需要的 Windows 消息的处理，并提供了刷新剪贴板查看器的方法。包的描述包含使用示例

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-14T15:36:41.037

还有一个答案（我知道在 2022 年！）：

如果您在**控制台**应用程序中，则需要使用**[STAThread]**能够监视剪贴板（并为剪贴板类导入**System.Windows.Forms**）。

**SharpClipboard**特别不起作用***，***即使在**[STAThread]**环境中也是如此。

```
using System;
using System.Windows.Forms; 
class Main {
    [STAThread]
    static void Main() {
        if (Clipboard.ContainsText()) {
            string text = Clipboard.GetText();
            Console.Writeline(text);
        }
    }
} 
```

编辑：

也可以在不导入 System.Windows.Forms 的情况下挂钩 DLL 函数以在此模式下访问剪贴板。

# java - 您将如何从 Image Magick In Java 之类的程序中读取图像数据？

> ID：621596
> 
> 赞同：0
> 
> 时间：2009-03-07T09:40:54.623
> 
> 标签：java, image-processing

我正在使用 ImageMagick，想知道从 ImageMagick 进程的 StdOut 读取图像数据的最佳方法是什么。

我像这样调用进程的命令：/opt/local/bin/convert -resize 8000@ - -

然后将字节数组传递给进程进行处理。

从这样的进程中读取数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T09:52:21.117

您可能想查看[Apache Commons Exec](http://commons.apache.org/exec/index.html)，它为您提供了一种运行可执行文件并将结果传递给 Java 的好方法。

它类似于使用迈克尔提到的方法，除了应该允许你更多的控制。

[教程](http://commons.apache.org/exec/tutorial.html)页面上有一些很好的使用示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T06:06:03.420

只想通过 Apache commons exec 使用 ImageMagick 发布代码示例以确保完整性

```
 try {

        StringBuffer sb = new StringBuffer();
        sb.append(this.validPathToImageMagickCommand);
        sb.append('\u0020');
        for (int i = 0; i < args.size(); i++) {
            String s = args.get(i);
            sb.append(s);
        }

        CommandLine cl = CommandLine.parse(sb.toString());

        PumpStreamHandler pumpStreamHandler = new PumpStreamHandler(output, System.err, new ByteArrayInputStream(inputBytes));
        byAs = new ByteArrayInputStream(inputBytes);
        pumpStreamHandler.setProcessOutputStream(byAs);

        DefaultExecutor executor = new DefaultExecutor();
        executor.setStreamHandler(pumpStreamHandler);
        int exitValue = executor.execute(cl);

        outputBytes = output.toByteArray();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            if (byAs != null)
                byAs.close();

            if (output != null)
                output.close();

        } catch (IOException e) {
            System.out.println(e);
        }

    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T09:45:16.233

该`Runtime.exec()`方法返回一个`Process`具有获取被调用进程的输入、输出和错误流的方法。

我确实想知道您如何以任何其他方式设法“将字节数组传递给进程”。

请注意，您必须使用多个线程来处理衍生进程的输入和输出，因为如果您尝试“管道输入”大量输入而不读取任何输出，它将阻塞。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T15:44:30.490

如果您确实想使用 Runtime.exec()，请查看[此问题](https://stackoverflow.com/questions/609762/need-sample-java-code-to-run-a-shellscript)，因为 runtime.exec() 可能有点棘手。

您将希望将 StreamGobbler for OUTPUT 更改为将 stdout 存储在数组或类似内容中的东西。正如迈克尔所说，在执行 waitFor() 之前启动线程以防止阻塞。

# localization - 在资源文件中命名键的最佳实践

> ID：621600
> 
> 赞同：19
> 
> 时间：2009-03-07T09:45:37.717
> 
> 标签：localization, internationalization

有没有人对资源文件中的命名键有任何建议？例如，您的键名是基于需要本地化的文本还是基于使用该文本的控件？

假设您在多个屏幕中有一个编辑按钮（一个用于编辑用户，一个用于编辑组）。您可以使用以下键：

*   editUserButton.label=编辑用户...
*   editGroupButton.label=编辑组...

或者

*   editUser=编辑用户...
*   editGroup=编辑组...

或者

*   user.edit=编辑用户...
*   group.edit=编辑组...

你更喜欢什么方案，为什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-07T10:04:35.813

我在我的文字前加上用例或动作类名。例如：

```
PlaceOrder.invalidId=订单 {0} 的 ID 无效
PlaceOrder.success=您的订单 {0} 成功
PlaceOrder.fail.visa=您的签证是...
PlaceOrder.fail.communications=我们不能...
PlaceOrder.submit=立即购买

登录=登录
Login.fail=您的凭据没有...
Login.alread=您已经登录
```

这样可以避免碰撞：

```
EditStudent=编辑
EditClass=编辑
EditCourse=编辑课程
```

...并且还可以更轻松地找到您需要的东西。

我分组的另一种方式是按实体：

```
人.id=#
Person.name=名字
Person.surname=姓
```

这些可以显示为带有实体的表上的标题。它可以在以下情况下为您节省：

```
人.id=#
类.id=#
Course.id=课程编号
```

最后，通过在属性键中提供上下文，您可以避免错误翻译。例如我曾经有：

```
否=否
```

它被用作左上角单元格的 id (#) 表头，但我们的法语翻译为法语做了这个：

```
否=非
```

......他认为这是“不”这个词（是的否定）。:)

当您想要重构/重命名类并快速更新这些属性键而无需查看模板时，最后（但并非最不重要）前缀将有助于您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T10:34:06.630

我们以该术语的英文版本为基础。例如：EditUser 那是我们的开发人员很容易阅读，并且可以在整个应用程序中需要该术语的多个位置重复使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T11:03:29.307

它以英文文本为基础，但以窗口/对话/你有什么作为前缀，其中出现了单词或短语。至少当布局空间有限时，您可能希望避免陷入到处都有完全相同的字符串的陷阱：这会阻止您使用缩写来获得体面的布局，尤其是在芬兰语等多音节语言中。

当然，您仍然应该努力在命名方面保持一致。如果您在商业上这样做，增加字符串的数量也会增加翻译成本。

不要忽视同音异义词的危险。提供上下文有助于防止这种情况。不要害怕使资源名称比实际的英文术语长，这可以大大帮助翻译人员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T18:22:21.060

为@cherouvim 的答案+1，但它总是归结为文档。

记录每个值（使用资源源文件格式支持的任何注释机制），包括每个参数的数据类型（如果字符串是可格式化的）。例如，.resx 格式的 VS 编辑器公开了一个注释字段，这使得它非常容易。

所以像这样的消息：

> 无法在 {1} 之前安排 {0} 作业。

将被记录为：

> Logged error message, {0}: job name, {1} date/time in ISO 8601 format.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-07T10:15:32.027

我认为首先应该使用某种 XML 文件来存储这种数据。

就像是 ：

**<?xml version="1.0" encoding="utf-8" Standalone="yes" ?>
<xml>
    <button>
        <edit>
            <user>***Edit User*** </user>
            <group> ***Edit group*** < /group>
        </edit>
    </button>
</xml>**

然后使用“翻译”类来获取（并设置/保存）文本。

就像是 ：

**myTranslateClass.load('translate.xml');
myTranslateClass.get('button', 'edit', 'user');**

这是一个简单的例子。

# email - 设置反向 DNS 记录

> ID：621601
> 
> 赞同：3
> 
> 时间：2009-03-07T09:45:54.110
> 
> 标签：email, dns, email-spam

这个问题与编程没有直接关系，但我需要我的服务器通过垃圾邮件过滤器才能让我的应用程序正常工作。我与我的 ISP 讨论了 rDNS，技术支持人员告诉我，如果我写一封电子邮件，说明他们应该在我的 DNS 记录中添加什么，他们就会这样做。我的问题：

如果我的主机名是“ [http://niklasfi.de](http://niklasfi.de) ”并且我的主机名是 78.31.67.216，我应该告诉他添加什么？

谢谢你的答案。我尝试在网上搜索，但我只针对单个 ISP 做出了非常具体的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T09:51:44.067

反向 DNS 只是一个记录，查找是从您的 IP 地址中找到您的主机名。所以你应该让他用你的主机名为 78.31.67.216 添加一个反向 IN-ADDR 条目。

这将是：216.67.31.78.in-addr.arpa niklasfi.de

这些也称为 PTR 记录。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T09:54:48.520

只是为了澄清。[http://niklasfi.de](http://niklasfi.de)不是主机名。它是一个 URI 或 URL。例如，主机名是 mail.niklausfi.de。

我使用网络上的众多服务之一进行了查找（搜索“反向 DNS 查找”）。提到的 IP 地址已经有一个 IN-ADDR 记录。它是 216-67-31-78-rb1.sit.dsl.dynamic.acsalaska.net。

# c++ - C++：空类的对象的大小是多少？

> ID：621616
> 
> 赞同：115
> 
> 时间：2009-03-07T10:06:50.380
> 
> 标签：c++, class, object

**我想知道空类的对象的大小**可能是多少。它肯定*不能*是 0 字节，因为它应该可以像任何其他对象一样引用和指向它。但是，这样的物体有多大？

我用了这个小程序：

```
#include <iostream>
using namespace std;

class Empty {};

int main()
{
    Empty e;
    cerr << sizeof(e) << endl;
    return 0;
} 
```

我在 Visual C++ 和 Cygwin-g++ 编译器上得到的输出都是**1 字节**！这让我有点惊讶，因为我期望它是机器字的大小（32 位或 4 字节）。

谁能解释**为什么**1 字节的大小？**为什么不是**4 个字节？这是否也取决于编译器或机器？另外，有人可以给出一个更令人信服的理由来解释为什么空类对象的大小**不是**0 字节吗？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-03-07T10:36:31.073

引用[Bjarne Stroustrup 的 C++ Style and Technique FAQ](http://www.stroustrup.com/bs_faq2.html#sizeof-empty)，大小不为零的原因是“确保两个不同对象的地址不同”。并且大小可以是 1，因为在这里对齐并不重要，因为实际上没有什么可看的。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-03-07T10:27:56.850

标准规定所有大多数派生对象的 sizeof() >= 1：

> 除非它是位字段（class.bit），否则最派生对象应具有非零大小并应占用一个或多个字节的存储空间。基类子对象的大小可能为零。 [ISO/IEC FDIS 14882:1998(E) 介绍对象](http://www.kuzbass.ru:8086/docs/isocpp/intro.html#intro.object)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-07T10:09:00.000

这确实是一个实现细节。很久以前，我认为它可能是零字节或一千字节，它与语言规范无关。但是，在查看 C++17 标准 ( `expr.sizeof`) 之后，`sizeof`它被定义为总是返回一个或更大，无论如何。

> 最派生类的大小应大于零。

除其他外，这对于允许您处理对象数组和指向它们的指针是必需的。如果您的元素被允许为零大小，那么`&(array[0])`将与 相同`&(array[42])`，这将对您的处理循环造成各种破坏。

它可能不是机器字的原因是其中没有元素实际上要求它在字边界上对齐（例如整数）。例如，如果您放在`char x; int y;`类中，我的 GCC 将其计时为 8 个字节（因为第二个`int`必须在该实现中对齐）。

* * *

话虽如此，该特定措辞似乎已从 C++20 中删除，至少允许*对象*不占用空间。但是，以下文本已添加到同一部分：

> 当应用于一个类时，结果是该类的对象中的字节数，*包括将该类型的对象放入数组中所需的任何填充。*

由于数组需要能够区分元素，这意味着`sizeof`必须返回至少一个，即使对象本身在技术上不占用空间。

因此，措辞不同，但整体效果相同。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-06T08:11:09.750

尽管它不需要为空类分配任何内存，但是为了制作空类的对象，编译器分配了可以分配的最小内存，即 1 字节。这样编译器就可以唯一区分同一个空类的两个对象，并将对象的地址分配给空类类型的指针。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-08T05:44:40.080

我认为链接到解释这一点的答案可能会有所帮助。[它是](https://stackoverflow.com/questions/97948/what-is-stdpair/573457#573457)[`boost::compressed_pair`](http://www.boost.org/doc/libs/1_38_0/libs/utility/compressed_pair.htm)关于洛根[卡帕尔](https://stackoverflow.com/users/61289/logan-capaldo)多的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-12-27T11:28:50.050

有一个例外：0-length 数组

```
#include <iostream>

class CompletlyEmpty {
  char NO_DATA[0];
};

int main(int argc, const char** argv) {
  std::cout << sizeof(CompletlyEmpty) << '\n';
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-12-04T19:52:24.417

这可能对你有帮助:-) [http://bytes.com/topic/c/insights/660463-sizeof-empty-class-structure-1-a](http://bytes.com/topic/c/insights/660463-sizeof-empty-class-structure-1-a)

> **空类或结构的大小为 1**
> 
> 发生这种情况的原因归结为正确实施标准，C++ 标准所说的其中一件事是“任何对象在内存中的地址都不应与任何其他变量相同”......确保这一点的最简单方法是什么？确保所有类型都具有非零大小。为了实现这一点，编译器向没有数据成员和虚函数的结构和类添加了一个虚拟字节，以便它们的大小为 1 而不是 0，然后保证它们具有唯一的内存地址。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-04T20:02:26.067

为空类分配 1 个字节取决于编译器。编译器需要确保对象驻留在不同的内存位置，并且需要为对象分配非零内存大小。在此处收听有关此主题的注释：[http ://listenvoice.com/listenVoiceNote.aspx?id=27](http://listenvoice.com/listenVoiceNote.aspx?id=27)

即使编译器为空类分配非零大小，当新类派生自空类时，它们也会进行优化。听听关于 ListenVoice 的 c++ 编程面试问题的空基优化。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-11-04T09:46:10.750

没有数据成员但大小为 1 字节的类的原因是 this* *strong text* * 必须存储在内存中，以便引用或指针可以指向该类的对象

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-06T12:13:11.463

空类 - 该类不包含任何内容。

任何非空的类都将由其在内存中的内容表示。

现在如何在内存中表示空类？因为它没有内容，无法显示它在内存中的存在，但是类是存在的，所以必须在内存中显示它的存在。要在内存中显示空类的存在，需要 1 个字节。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-07T15:28:56.480

我认为是这样，因为 1 字节是可以用作占位符的最小内存单元，并且它不能给出零大小，因为它不可能创建对象数组..

以及您所说的“这对我来说有点令人惊讶，因为我希望它具有机器字的大小（32 位或 4 字节）。” 对于空（）类型的引用变量（macine 单词）将是正确的，而不是类本身的大小（这是抽象数据类型），

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-19T01:04:32.430

我认为这个问题仅具有理论意义，但在实践中并不重要。

正如其他人已经指出的那样，从空类派生不会造成任何伤害，因为这不会为基类部分消耗任何额外的内存。

此外，如果一个类是空的（这意味着它 - 理论上 - 不需要任何实例内存，即它没有任何非静态数据成员或虚拟成员函数），那么它的所有成员函数也可以（并且应该）被定义为静态的。所以没有必要创建这个类的实例。

底线：如果您发现自己编写了一个空类 X，那么只需将所有成员函数设为静态即可。这样您就不需要创建 X 对象，派生类也不会受到任何影响。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-05-24T07:10:25.240

```
#include<iostream>
using namespace std;

    class Empty { };
    int main()
    {
        Empty* e1 = new Empty;
        Empty* e2 = new Empty;

        if (e1 == e2)
            cout << "Alas same address of two objects" << endl;
        else
            cout << "Okay it's Fine to have different addresses" << endl;

        return 0;
    } 
```

输出：好的，可以有不同的地址

返回大小 1 可确保两个对象不会具有相同的地址。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-07-21T19:21:11.563

确保两个不同的对象具有不同的地址是非零的。不同的对象应该有不同的地址，所以空类的大小总是1字节。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-14T10:07:30.293

对于空类的对象，编译器分配 1 个字节用于唯一地址标识。因此，如果一个类有多个对象，它们可以有不同的唯一内存位置。假设，如果一个类没有任何大小，那么内存位置会存储什么？这就是为什么当我们在 C++ 程序中创建一个空类的对象时，它需要一些内存来存储，并且可以保留的最小内存量是 1 字节。所以，如果我们创建一个空类的多个对象，每个对象都会有一个唯一的地址。

在 C++ 代码示例下方，将始终为两个对象提供唯一地址，为空类 EmptyClass 创建。

```
int main()
{
    EmptyClass obj1;
    EmptyClass obj2;

    if (&obj1 == &obj2){
         cout << "Both objects have same address" << endl;
    }else{
        cout << "Both objects have unique address" << endl;
    }       
    return 0;
} 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2014-11-02T14:31:45.353

我认为如果一个空类的大小为零，则意味着它不存在。它（类）要存在，它至少需要 1 个字节，因为这个字节是内存/引用地址。

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2010-06-15T09:00:03.983

正是因为**这个**指针，虽然指针是 4 字节的（整数），但它指的是一个内存位置（一个 Unit），它是 1 字节。

# visual-c++ - Gdiplus 64 位颜色

> ID：621624
> 
> 赞同：3
> 
> 时间：2009-03-07T10:13:08.273
> 
> 标签：visual-c++, graphics, image-processing, 64-bit, gdi+

我正在创建一个 64 位位图并使用 Graphics 对象将其包装以在其上绘制。问题是 Gdiplus 颜色类只有 32 位（每个组件只有字节，即最大 255）所以我如何使用 gdiplus 绘制 64 位图像？例如

```
Bitmap bmp(100, 100, PixelFormat64bppARGB);

Graphics g(&bmp);
//how do I draw a red line now, if i use Color(255,0,0) it comes as almost dark black red 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T10:24:22.927

Gdiplus 似乎不支持任何 64 位操作。一种仍然能够使用 Gdiplus 方法的简单方法是将图像拆分为两个 32 位图像并分别对它们进行操作。

您可以将 ARGB 通道拆分为 AARR 和 GGBB，或者使用具有较低和较高 ARGB 位的两个 32 位图像。

这两种变体都需要您编写包装函数或将每个调用分成两部分，如下所示：

```
// This is what you want to do (ARGB, 16 bit per channel)
// g.DrawLine(new Pen(Color(0, 65535, 1024, 31), 1, 0, 0, 100, 100);

// AARR GGBB variant
gAARR.DrawLine(new Pen(Color(0,0,255,255), 1, 0, 0, 100, 100);
gGGBB.DrawLine(new Pen(Color(4,0,0,31), 1, 0, 0, 100, 100);

// ARGBhigh ARGBlow variant
gHigh.DrawLine(new Pen(Color(0,255,4,0), 1, 0, 0, 100, 100);
gLow.DrawLine(new Pen(Color(0,255,0,31), 1, 0, 0, 100, 100); 
```

请注意，我在这里使用了 Color(A,R,G,B) 顺序，但我不确定。根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms968443(VS.80).aspx)，这必须改为 Color(R,G,B,A) 。如果您不需要 alpha 通道，您应该更喜欢 highlow 变体，因为您仍然可以使用 Color(R,G,B) 。

要显示或保存结果，您需要合并 2 个缓冲区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-30T11:00:14.013

您不能根据[MSDN - Image Pixel Format Constants](http://msdn.microsoft.com/en-us/library/ms534412%28VS.85%29.aspx)：

> **评论**
> 
> `PixelFormat48bppRGB`, `PixelFormat64bppARGB`, 并且 `PixelFormat64bppPARGB`每个颜色分量（通道）使用 16 位。Microsoft Windows GDI+ 1.0 版可以读取每通道 16 位的图像，但此类图像会转换为每通道 8 位的格式以进行处理、显示和保存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T10:16:42.977

您可以使用此 Bitmap 构造函数来设置像素格式：

```
public:
Bitmap(
    int width, 
    int height, 
    PixelFormat format
) 
```

编辑：您将无法使用 Color 类（我认为），因为它只支持 32 位颜色。但是，您可以在 Bitmap 上调用 LockBits 并手动循环遍历它。

# jakarta-ee - OC4J - toplink 10/11 同时？

> ID：621626
> 
> 赞同：0
> 
> 时间：2009-03-07T10:14:57.457
> 
> 标签：jakarta-ee, oc4j, toplink

您能否在 OC4J 应用程序服务器中同时使用 toplink v. 10（toplink essentials）和 toplink v.11（eclipselink）？

两者都是 JPA 的不同实现。我想知道是否可以将这两种实现都添加到 OC4J 应用程序服务器中，以便 bean jar 可以自己选择要使用的实现。

请仅提供真实的经验和知识，而不是“我认为……”或“它应该有效”或“阅读手册”或“根据规范……”之类的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T20:20:56.293

是的你可以 ：-）

# c# - 我得到这个 JavaScriptSerializer.Deserialize 异常，我该如何解决？

> ID：621632
> 
> 赞同：0
> 
> 时间：2009-03-07T10:21:02.060
> 
> 标签：c#, .net, json, serialization

System.Exception：读取 CANANDA 的城市列表时出错 ---> System.ArgumentException：无法识别的转义序列。(1056):

```
{code: "CA",cities: [{name: "Abbotsford",lat: 49029998,lon: -122370002},{name: "Calgary",lat: 51119998,lon: -114019996},{name: "Edmonton",lat: 53299999,lon: -113580001},{name: "Halifax",lat: 44880001,lon: -63500000},{name: "Hamilton",lat: 43279998,lon: -79900001},{name: "Kanata",lat: 45319999,lon: -75669998},{name: "Kelowna",lat: 49970001,lon: -119379997},{name: "Kingston",lat: 44220001,lon: -76599998},{name: "London",lat: 43029998,lon: -81150001},{name: "Mississauga",lat: 43630001,lon: -79400001},{name: "Moncton",lat: 46119998,lon: -64680000},{name: "Montreal",lat: 45470001,lon: -73750000},{name: "Oshawa",lat: 43630001,lon: -79400001},{name: "Ottawa",lat:45319999,lon: -75669998},{name: "Peterborough",lat: 44229999,lon: -78370002},{name: "Prince George",lat: 53880001,lon: -122680000},{name: "Quebec",lat: 46799999,lon: -71379997},{name: "Regina",lat: 50430000,lon: -104669998},{name: "Saint John",lat: 45319999,lon: -65879997},{name: "Saskatoon",lat: 52169998,lon: -106680000},{name: "Sherbrooke",lat: 45430000,lon: -71680000},{name: "St John\x27s",lat: 47619998,lon: -52729999},{name: "Sydney",lat: 46169998,lon: -60049999},{name: "Thunder Bay",lat: 48369998,lon: -89319999},{name: "Toronto",lat: 43630001,lon: -79400001, selected: true},{name: "Trois-Rivieres",lat: 46349998,lon: -72519996},{name: "Vancouver",lat: 49180000,lon: -123169998},{name: "Victoria",lat: 48650001,lon: -123430000},{name: "Windsor",lat: 42270000,lon: -82970001},{name: "Winnipeg",lat: 49900001,lon: -97230003}]} 
```

我认为这是导致异常的名称“St John\x27s”。这是否意味着 System.Web.Extensions JavaScriptSerializer 不支持 Unicode？

或者这实际上是无效的 JSON？

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T10:32:16.277

\x27 是无效的 JSON。将其替换为 \u0027。

# java - 在java中重复登录log 4j

> ID：621633
> 
> 赞同：0
> 
> 时间：2009-03-07T10:22:10.640
> 
> 标签：java, log4j

我在一个java程序中使用了log4j。我初始化它：

```
BasicConfigurator.configure(); // logger configuration
try {
     logger.setLevel(Level.DEBUG);
} catch (Exception e) {
     System.out.println("Logfile not found");
} 
```

但是，在程序执行期间，我得到 3 个日志语句而不是 1 个。例如，

```
3 lines 
1047 [main] INFO ibis.Preproc.Ratings  - Added AS TIMEZONE to tZones[0] = GMT-12:00
1047 [main] INFO ibis.Preproc.Ratings  - Added AS TIMEZONE to tZones[0] = GMT-12:00
1047 [main] INFO ibis.Preproc.Ratings  - Added AS TIMEZONE to tZones[0] = GMT-12:00 
```

而不是一行

```
1047 [main] INFO ibis.Preproc.Ratings  - Added AS TIMEZONE to tZones[0] = GMT-12:00 
```

是否需要对 log4j 进行任何额外的配置来避免这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T10:37:32.863

我经历过类似的行为，结果证明 Log4J 配置了不止一次；使用 BasicConfigurator，还使用我忘记的 log4j.xml 文件。是不是在类路径的某个地方有一个额外的 Log4J 配置？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T10:58:59.567

很可能您有多个 Appender。请参阅 log4j[手册](http://logging.apache.org/log4j/1.2/manual.html)（部分：Appenders 和 Layouts）：

> 给定记录器的每个启用的记录请求都将转发到该记录器中的所有附加程序以及层次结构中更高的附加程序。

您可以尝试将可加性标志设置为 false。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T10:28:46.333

好吧，你还没有展示你的程序是如何执行的。这是一个仅显示一行的完整程序：

```
import org.apache.log4j.*;

public class Test
{
    public static void main(String[] args)
    {
        BasicConfigurator.configure(); // logger configuration
        Logger logger = Logger.getLogger(Test.class);
        logger.setLevel(Level.DEBUG);
        logger.info("Hello");
    }
} 
```

你的代码真的有可能运行了三遍吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T16:17:25.583

就我而言，每次调用 BasicConfigurator.configure() 时，我都会添加一个新的附加程序。

我解决了它重置配置：

```
BasicConfigurator.resetConfiguration() //reset first
BasicConfigurator.configure() // then configure 
```

我必须承认我不清楚发生了什么，但它确实解决了我的问题。

# c++ - C++0x 是否支持 std::wstring 与 UTF-8 字节序列的转换？

> ID：621635
> 
> 赞同：8
> 
> 时间：2009-03-07T10:25:03.067
> 
> 标签：c++, c++11, unicode, utf-8, wstring

我看到 C++0x 将添加对 UTF-8、UTF-16 和 UTF-32 文字的支持。但是这三种表示之间的转换呢？

我计划在我的代码中到处使用 std::wstring 。但在处理文件和网络时，我还需要处理 UTF-8 编码的数据。C++0x 是否也支持这些操作？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-07T10:40:16.693

在 C++0x 中，`char16_t`将`char32_t`用于存储 UTF-16 和 UTF-32 而不是`wchar_t`.

从草案 n2798：

> **22.2.1.4 类模板codecvt**
> 
> 2 类 codecvt 用于从一个代码集转换到另一个代码集，例如从宽字符到多字节字符或在 Unicode 和 EUC 等宽字符编码之间。
> 
> 3 表 76 (22.1.1.1.1) 中要求的特殊化转换实现定义的本机字符集。codecvt 实现了退化转换；它根本不转换。专业化`codecvt<char16_t, char, mbstate_t>`在 UTF-16 和 UTF-8 编码方案`codecvt <char32_t, char, mbstate_t>`之间转换，专业化在 UTF-32 和 UTF-8 编码方案之间转换。`codecvt<wchar_t,char,mbstate_t>`在窄字符和宽字符的本机字符集之间进行转换。`mbstate_t`在库实现者已知的编码之间执行转换的专业化。
> 
> 可以通过专门处理用户定义的 stateT 类型来转换其他编码。stateT 对象可以包含对与专门的 do_in 或 do_out 成员进行通信或从其进行通信有用的任何状态。

*问题*是`wchar_t`它没有为您提供有关所使用编码的任何保证。它是一种可以容纳多字节字符的类型。时期。*如果你现在*要编写软件，你必须忍受这种妥协。与 C++0x 兼容的编译器仍然相去甚远。你总是可以尝试一下 VC2010 CTP 和 g++ 编译器的价值。此外，`wchar_t`在不同平台上具有不同的大小，这是另一件需要注意的事情（VS/Windows 上 2 个字节，GCC/Mac 上 4 个字节等等）。然后有诸如 GCC 之类的选项`-fshort-wchar`使问题进一步复杂化。

因此，最好的解决方案是使用现有的库。追逐 UNICODE 错误并不是对精力/时间的最佳利用。我建议你看看：

*   GNU [libiconv](http://www.gnu.org/software/libiconv/)
*   IBM的[libicu](http://www-01.ibm.com/software/globalization/icu/)

更多关于 C++0x Unicode 字符串文字[的信息在这里](http://en.wikipedia.org/wiki/C%2B%2B0x#New_string_literals)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T08:00:08.327

非常感谢你。我还没有注册，所以我不能直接投票或回复评论。

我从 codecvt 学到了一些东西。我知道您建议的库，以下资源也可能有用[http://www.unicode.org/Public/PROGRAMS/CVTUTF/](http://www.unicode.org/Public/PROGRAMS/CVTUTF/)。

该项目用于一个应该是开源的库。我宁愿尽量减少与外部库的依赖关系。我已经对 libgc 和 boost 产生了依赖，但对于后者，我只使用线程。我真的更愿意坚持 C++ 标准，但我有点失望的是，支持的 GC 已经以某种方式被放弃了。

显然，据说 VC++ express 2008 支持大部分 C++0x 标准以及 icc。由于我目前使用 VC++ 进行开发，而且库发布还需要一些时间，所以我想尝试使用 codecvt 和 char32_t 字符串。

有谁知道如何做到这一点 ？我应该发布另一个问题吗？

# performance - DLL 数量和加载性能

> ID：621637
> 
> 赞同：2
> 
> 时间：2009-03-07T10:27:29.283
> 
> 标签：performance, dll, load, size

假设整体 dll 大小为 100M，这里有 2 种情况：

1.  100M * 1
2.  10M * 10

当使用许多小型 DLL 时，它们会对性能产生很大影响吗？为什么？

我们最近进行了测试，但没有发现这两种情况之间的性能差异很大，我不确定我的测试是否有一些错误的步骤，或者这是事实。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T10:37:13.893

使用多个 DLL 可能会遇到的唯一问题是轻微的启动问题，因为操作系统加载程序必须找到 DLL 并解析和引用这些 DLL，并在加载它们时重新定位它们。但是，性能影响不值得担心，特别是如果您有 10M*10 DLL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T10:33:41.780

我想如果你没有足够的可用内存，你只会看到不同。在这两种情况下，操作系统都应该处理 DLL，它们也应该被缓存，所以如果有差异，它只对第一次加载很重要。

# python - Python和最大21个字符的随机键

> ID：621649
> 
> 赞同：7
> 
> 时间：2009-03-07T10:36:54.037
> 
> 标签：python, encryption, key

我正在使用一个名称为 21 char max 的 api 来表示一个内部会话，该会话的生命周期约为“两天”。我希望使用某种 hasing 的名称没有意义？md5 生成 40 个字符，还有什么我可以使用的吗？

现在我使用 'userid[:10]' + 创建时间：ddhhmmss + 随机 3 个字符。

谢谢，

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-07T12:26:47.063

如果我正确阅读了您的问题，您希望生成一些最多 21 个字符的任意标识符令牌。它是否需要高度抗猜测？您给出的示例不是“密码学强”，因为它可以通过搜索不到整个可能键空间的 1/2 来猜测。

您没有说字符是否可以全部是 256 个 ASCII 字符，或者是否需要限制为可打印的 ASCII（包括 33-127）或更小的范围。

有一个为[UUID](http://docs.python.org/library/uuid.html)（通用唯一标识符）设计的 Python 模块。您可能需要 uuid4 来生成随机 UUID，并在可用时使用操作系统支持（在 Linux、Mac、FreeBSD 和可能的其他系统上）。

```
>>> import uuid
>>> u = uuid.uuid4()
>>> u
UUID('d94303e7-1be4-49ef-92f2-472bc4b4286d')
>>> u.bytes
'\xd9C\x03\xe7\x1b\xe4I\xef\x92\xf2G+\xc4\xb4(m'
>>> len(u.bytes)
16
>>> 
```

16 个随机字节是非常不可猜测的，如果您只想拥有一个不可猜测的不透明标识符，则无需使用您的 API 允许的全部 21 个字节。

如果你不能使用这样的原始字节，这可能是一个坏主意，因为它更难在日志和其他调试消息中使用，也更难用肉眼比较，然后将字节转换成更易读的东西，比如使用 base- 64 编码，结果减少到 21（或其他）字节：

```
>>> u.bytes.encode("base64")
'2UMD5xvkSe+S8kcrxLQobQ==\n'
>>> len(u.bytes.encode("base64")) 
25
>>> u.bytes.encode("base64")[:21]
'2UMD5xvkSe+S8kcrxLQob'
>>> 
```

这为您提供了一个长度为 21 的非常高质量的随机字符串。

您可能不喜欢可以在 base-64 字符串中的“+”或“/”，因为没有适当的转义可能会干扰 URL。由于您已经考虑使用“随机 3 个字符”，我认为这不是您的担心。如果是，您可以用其他字符替换这些字符（'-' 和 '.' 可能有效），或者如果存在则删除它们。

正如其他人指出的那样，您可以使用 .encode("hex") 并获得等效的十六进制，但这只有 4 位随机性/字符 * 21 个字符最大为您提供 84 位随机性，而不是两倍。每一位都会使您的键空间翻倍，从而使理论搜索空间变得非常小。缩小了 2E24 倍。

即使使用十六进制编码，您的密钥空间仍然是 2E24 大小，所以我认为这更多是理论上的问题。我不会担心人们对您的系统进行暴力攻击。

**编辑**：

PS：uuid.uuid4 函数使用 libuuid（如果可用）。它的熵来自 os.urandom（如果可用），否则来自当前时间和本地以太网 MAC 地址。如果 libuuid 不可用，则 uuid.uuid4 函数直接从 os.urandom （如果可用）获取字节，否则它使用 random 模块。random 模块使用基于 os.urandom （如果可用）的默认种子，否则使用基于当前时间的值。每次函数调用都会进行探测，因此如果您没有 os.urandom，那么开销会比您预期的要大一些。

带回家留言？如果你知道你有 os.urandom 那么你可以做

```
os.urandom(16).encode("base64")[:21] 
```

但如果您不想担心它的可用性，请使用 uuid 模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T10:45:36.433

MD5 的十六进制表示具有非常差的随机性：每个字符只能获得 4 位熵。

使用随机字符，例如：

```
import random
import string
"".join([random.choice(string.ascii_letters + string.digits + ".-")
        for i in xrange(21)]) 
```

在选择中放入所有可接受的字符。

*如果使用正确*，使用真正的哈希函数（如 SHA1）也会得到很好的结果，但增加的复杂性和 CPU 消耗似乎不符合您的需求。你只想要一个随机字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T10:38:26.450

为什么不从 md5 或 SHA1 哈希中获取前 21 个字符？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-14T17:03:44.447

base64 模块可以进行 URL 安全编码。所以，如果需要，而不是

```
u.bytes.encode("base64") 
```

你可以做

```
import base64

token = base64.urlsafe_b64encode(u.bytes) 
```

并且，方便地转换回来

```
u = uuid.UUID(bytes=base64.urlsafe_b64decode(token)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T10:54:19.237

字符还是字节？如果它需要任意字符串，您可以只使用字节而不用担心扩展为可读字符（无论如何，base64 比十六进制更好）。

如果不使用它的十六进制扩展，MD5 会生成 16 个字符。SHA1 在相同条件下生成 20。

```
>>> import hashlib
>>> len(hashlib.md5('foobar').digest())
16
>>> len(hashlib.sha1('foobar').digest())
20 
```

之后需要很少的额外字节。

# data-structures - 一个字有多少位，并且在不同的体系结构中是恒定的吗？

> ID：621657
> 
> 赞同：18
> 
> 时间：2009-03-07T10:44:01.663
> 
> 标签：data-structures, assembly, naming, cpu-architecture

机器*WORD*总是相同还是取决于机器架构？*单词WORD*的含义是上下文敏感的还是普遍适用的？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-07T10:53:24.963

机器字长取决于架构，还取决于操作系统运行应用程序的方式。

例如，在 Windows x64 中，应用程序可以作为 64 位应用程序（具有 64 位机器字）或 32 位应用程序（具有 32 位机器字）运行。因此，即使在同一台机器上，机器字的大小也可能不同。

该术语`WORD`具有不同的含义，具体取决于它的使用方式。它可以表示机器字，也可以表示具有特定大小的类型。在 x86 汇编语言中`WORD`，`DOUBLEWORD`( `DWORD`) 和`QUADWORD`( `QWORD`) 用于 2、4 和 8 字节大小，而与机器字长无关。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-07T10:50:17.670

一个字通常是 CPU 的“本机”数据大小。也就是说，在 16 位 CPU 上，一个字是 16 位，在 32 位 CPU 上，它是 32 位，依此类推。

当然，x86 是个例外，其中一个字是 16 位宽（因为 x86 最初是一个 16 位 CPU），一个 DWORD 是 32 位（因为它变成了一个 32 位 CPU），而一个 QWORD 是64 位（因为它现在有 64 位扩展）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T10:50:23.333

这取决于机器架构。[本](http://tldp.org/HOWTO/Unix-and-Internet-Fundamentals-HOWTO/core-formats.html)文档解释了有关此的一些基础知识。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T10:54:19.313

是的。

好的，让我更清楚一点。假设我们谈论的是记忆词，有两个广义的定义。

首先，一个词通常是可以在硬件中原子访问的单个项目的自然大小。这很大程度上取决于平台的大小，但通常是 16、32 或 64 位，但在野外也发现了其他大小。

其次，它通常用于专门表示 16 位值。在这种情况下，您将看到 DWORD 用于表示 32 位值。这种用法在 x86 平台上很常见，尤其是 Windows，但也用于 DEC PDP-11 和 VAX，以及摩托罗拉 68000 的后代。

判断哪个是预期用途取决于上下文......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-07T10:57:20.633

`WORD`是[Windows 特定的 16 位整数类型](http://msdn.microsoft.com/en-us/library/aa383751(VS.85).aspx)，并且与硬件无关。

如果您的意思是机器词，则无需大喊大叫。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-07T10:50:56.187

一个字的 16 位（2 个字节）对于 x86 来说是通用的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-07T10:51:34.640

我的理解是，一个 WORD 是可以通过一个动作（在特定机器上）推入 CPU 的位数，因此在 8 位架构中它是 8 位，而在现代 64 位架构中它是 64 位.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-07T10:56:41.647

你们这些年轻人都在谈论 32 位 this 和 64 bit that：你知道，除了 x86 系列之外，还有其他机器架构。例如，PDP-11 有 40 位字。

但最简单的答案就是搜索[Wikipedia](http://en.wikipedia.org/wiki/Word_(computing))。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-07T10:58:53.983

小写字母的“单词”取决于架构。

Windows SDK 中定义的大写字母“WORD”为 16 位。

类似地：“DWORD”-（双字）32 位。"QWORD" ... 64 位。

# c++ - 流错误

> ID：621670
> 
> 赞同：0
> 
> 时间：2009-03-07T10:55:17.157
> 
> 标签：c++, ofstream

这是参考我问的另一个问题，尽管这完全是它自己的问题。

编译时出现两个错误：

1>.\asst4.cpp(73)：错误 C2065：'outfile'：未声明的标识符

1>.\asst4.cpp(73) : 错误 C2228: '.close' 左侧必须有类/结构/联合

我对我在这里做错了什么感到有些困惑？有什么建议或想法吗？（实际的输出文件靠近代码的顶部。

这是完整的代码：

```
#include<iostream>
#include<fstream>  //used for reading/writing to files.
#include<string>    //needed for the filename.
#include<stdio.h>   //for goto statement

using namespace std;

int main()
{
    string start;
    char choice;
    char letter;
    int x;
    int y;
    int z;
    string filename;
    int garbage = rand()%('!' - '~' + 1 );
    cout << "Would you like to encrypt or decrypt a file? Please type enc, dec, or stop (case sensitive): " ;
    cin >> start;
    while(start == "enc")
    {
        x = 1;
        y = 1;
        cout << "How many garbage characters would you like between each correct character?: " ;
        cin >> z;
        cout << endl << "Please insert the name of the document you wish to encrypt, make sure you enter the name, and the file type (ie: filename.txt): " ;
        cin >> filename;
        ifstream infile(filename.c_str());
        while(!infile.eof())
        {
            ofstream outfile("encrypted.txt", ios::out);
            infile.get(letter); 
            if (x == y)         
                {
                outfile << garbage;
                x++;             
            }
            else
            {
                if((x - y) == z)            
                {
                    outfile << letter;          
                    y = x;                  
                }
                else                        
                {                           
                    outfile << garbage;
                    x++;
                }
            }
        }
        cout << endl << "Encryption complete...please return to directory of program, a new file named encrypted.txt will be there." << endl;
        infile.close();
        outfile.close();
        cout << "Do you wish to try again? Please press y then enter if yes (case sensitive).";
        cin >> choice;
        if(choice == 'y')
        {
            start = "enc";
        }
        else
        {
            cout << endl << "Do you wish to decrypt a file? Please press y then enter if yes (case sensitive).";
            if(choice = 'y')
            {
                start == "dec";
            }
            else
            {
                start == "no";
            }
        }
    }
    while(start == "dec")
    {

      //lets user choose whether to do another document or not.
      //used to track each character in the document.
        x = 1;    //first counter for tracking correct letter.
        y = 1;    //second counter (1 is used instead of 0 for ease of reading, 1 being the "first character").
              //third counter (used as a check to see if the first two counters are equal).
        //allows for user to input the filename they wish to use.
        cout << "Please make sure the document is in the same file as the program, thank you!" << endl << "Please input document name: " ;
        cin >> filename; //getline(cin, filename);  
        cout << endl;
        cout << "'Every nth character is good', what number is n?: ";
        cin >> z;   //user inputs the number at which the character is good. IE: every 5th character is good, they would input 5.
        cout << endl;
        z = z - 1;  //by subtracting 1, you now have the number of characters you will be skipping, the one after those is the letter you want.
        ifstream infile(filename.c_str()); //gets the filename provided, see below for incorrect input.
        if(infile.is_open()) //checks to see if the file is opened.
        {
            while(!infile.eof())    //continues looping until the end of the file.
            {   
                    infile.get(letter);  //gets the letters in the order that that they are in the file.
                    if (x == y)          //checks to see if the counters match...
                    {
                        x++;             //...if they do, adds 1 to the x counter.
                    }
                    else
                    {
                        if((x - y) == z)            //for every nth character that is good, x - y = nth - 1.
                        {
                            cout << letter;         //...if they don't, that means that character is one you want, so it prints that character.
                            y = x;                  //sets both counters equal to restart the process of counting.
                        }
                        else                        //only used when more than every other letter is garbage, continues adding 1 to the first
                        {                           //counter until the first and second counters are equal.
                            x++;
                        }
                    }
            }
            cout << endl << "Decryption complete...please return to directory of program, a new file named encrypted.txt will be there." << endl;
            infile.close();
            cout << "Do you wish to try again? Please press y then enter if yes (case sensitive).";
            cin >> choice;
            if(choice == 'y')
            {
                start == "dec";
            }
            else
                {
                cout << endl << "Do you wish to encrypt a file? Please press y then enter if yes (case sensitive).";
                if(choice == 'y')
                {
                    start == "enc";
                }
                else
                {
                    start == "no";
                }
            }
        }
        else  //this prints out and program is skipped in case an incorrect file name is used.
        {
            cout << "Unable to open file, please make sure the filename is correct and that you typed in the extension" << endl;
            cout << "IE:" << "     filename.txt" << endl;
            cout << "You input: " << filename << endl;
            cout << "Do you wish to try again? Please press y then enter if yes (case senstive)." ;
            cin >> choice;
            if(choice == 'y')
            {
                start == "dec";
            }
            else
            {
                start == "no";
            }
        }
        getchar();  //because I use visual C++ express.
    }
} 
```

提前谢谢！杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T10:58:42.157

范围问题。您在 while 循环中声明 outfile ，但试图在所述 while 循环之外访问它。

移动`ofstream outfile("encrypted.txt", ios::out);`到你之后的那一行`ifstream infile(filename.c_str());`是你之前的`while(!infile.eof())`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T11:13:05.057

You've got two choices - as X-istence mentions, the reason your call to outfile.close() is not compiled is because the object 'outfile' does not exist in the same scope as the declaration of outfile.

You could either move the line

```
 ofstream outfile("encrypted.txt", ios::out); 
```

outside the while loop so it obeys the same scoping rules as infile, or you can move your call to outfile.close(); inside the while loop, which would move it into the current scope in which outfile exists.

My preference would be to move the declaration of outfile outside the while loop as opening a file is quite an expensive operation and you really don't want to do this for every letter you read from infile. Open it once, close it once is the way to go in this case.

# .net - “删除未使用的引用”的目的是什么

> ID：621680
> 
> 赞同：12
> 
> 时间：2009-03-07T10:59:00.223
> 
> 标签：.net, visual-studio, compiler-construction, reference

我已经读过删除未使用的引用对编译器[没有任何](http://blogs.msdn.com/csharpfaq/archive/2004/10/20/245411.aspx)影响，因为它忽略了代码本身没有引用的程序集。

但我很难相信，因为那样的话，[删除未使用的引用](http://msdn.microsoft.com/en-us/library/7sfxafba.aspx)的真正目的是什么？它对生成的程序集的大小或其他方面没有任何明显的影响。或者这种*智能*行为是否仅限于 C# 编译器 (csc.exe) 而不是 vbc.exe 所固有的？

如果此功能如此无用，为什么[ReSharper](http://www.jetbrains.com/resharper/)将其作为一项功能提供？为什么在 Visual Studio 项目配置对话框中提供它？

我能想到的唯一有用的活动是在部署期间。安装程序仍会复制参考（使用过的或未使用过的）。但是对于驻留在 GAC 中的程序集（例如，BCL 程序集），这也不是问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-08T04:46:16.740

它防止 CLR 在运行时加载引用的模块。这将减少启动时间（因为加载每个模块需要时间）。根据模块的大小，它可能会显着减少启动时间。

对此进行测试的一种方法是创建一个测试 WinForms 项目，添加对未使用的程序集（例如 System.Web）的引用，然后运行并附加到可执行文件（例如 F5）。查看加载的模块（调试 -> Windows -> 模块），您将看到引用的程序集已加载。

如果您考虑一下，CLR 将很难确定是否真的使用了依赖项（一旦添加了对它的引用，它就在清单中作为依赖项）......尤其是因为执行了一些代码路径无法提前知道...

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-07T11:03:22.317

除了源文件更小之外，我认为最好有一个没有未使用代码或引用的干净源文件。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-07T12:26:02.773

Visual Studio 2008 还具有删除未使用的 using 指令的功能。

删除未使用的代码使代码更整洁，但您也可以降低冲突的风险。有时在不同的程序集中有同名的类。例如，在和中都有一个`Image`类。如果您对两个命名空间都有 using 指令并开始使用 Image 类，则编译器无法判断要使用哪一个。`System.Drawing``System.Web.UI.WebControls`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-07T15:47:16.847

这是使您的项目编译速度更快的优化。它避免了编译器加载永远不会使用的元数据。虽然这是一个小问题，但我猜大约是 50 毫秒，具体取决于硬盘驱动器的速度和文件系统缓存状态。

C# 编译器足够智能，仅在已编译程序集的元数据中为实际使用的程序集发出 .assembly 引用。因此，您不会为运行 Ngen.exe 时不使用的程序集生成本机映像。JIT 编译器不会受到任何影响，它只会根据需要加载程序集以翻译 IL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-04T10:50:19.483

Visual Studio 2010 的参考助手是删除应用程序中未使用的参考的最佳工具。

[http://visualstudiogallery.msdn.microsoft.com/fc504cc6-5808-4da8-ae86-8d3f9ed81606](http://visualstudiogallery.msdn.microsoft.com/fc504cc6-5808-4da8-ae86-8d3f9ed81606)

# code-organization - 在单个文件中包含多少代码？

> ID：621682
> 
> 赞同：2
> 
> 时间：2009-03-07T11:00:45.537
> 
> 标签：code-organization

我今天想知道人们在决定将其拆分为多个较小的文件之前，通常在单个源文件中有多少代码。

就我个人而言，我倾向于保持我的文件相当小（特别是使用 C/C++ 时的头文件）。也就是说，我通常在给定文件中只有一个类或一堆函数，因此文件通常 <500 行。然而，所有相关的东西通常共享相同的命名空间。

另一方面，我使用的一些东西似乎很乐意尝试尽可能多地粘贴到单个文件中，该文件有 1000 行长。

我更喜欢小文件，因为任何更改只需要重新编译那一段代码，而且我发现将源代码分解为每个具有特定目的的较小文件时更容易导航源代码，而不是一个关于整个事物的大文件。几个大文件有什么真正的优势吗？

例如，我的粒子系统被分解为 system.h、emitter.h、load.h、particle.h 等，并且每个都有对应的 .cpp 文件。然而，我查看的一些粒子系统似乎已将整个源放入单个 .h 和 .cpp 1000 行长的行中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T11:08:01.510

毫无疑问，较小的文件更容易阅读和理解。但是，我认为您不能根据类或源文件中的行数做出此决定。如果您认为应该将通用功能放在不同的文件中，请考虑拆分您的代码。它还将允许更好地重用代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T11:12:19.817

您应该从逻辑上而非物理上识别软件模块。因此，您应该根据职责设计类/功能。

您可以使用 CRC 方法来识别每个类的责任。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T11:24:54.433

这当然取决于，你不能把自己限制在一个标准上。但我在一篇文章中读到

你的方法应该是一个屏幕宽的，所以你可以在不滚动的情况下看到它发生了什么，

您的方法参数应该小于或等于 7，并且您的继承深度应该小于或等于 3，这对于人类来说很容易理解。

在我看来，文件的限制应该是它的责任。每个文件都应该需要它自己的类，并且每个类都应该有一个责任。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-15T16:32:37.453

每个源文件中的太少与拥有太多一样糟糕 - 混乱只会从单个源文件中转移到项目本身。

当我注意到一个源文件开始处理两个（或更多）明显独立的方面时，我倾向于将其拆分。

如果我感觉它包含将来可能会进行大量修改的功能，同时也具有可能稳定的功能，我也会将其拆分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T11:17:11.613

如果您不希望代码更改，那么巨大的单个文件对用户来说可能更方便。例如，SQLite 将他们的代码作为一个单一的源文件分发，用户可以轻松地将其合并到他们自己的构建中。

然而，在开发过程中，这是一个糟糕的想法，因为你提到的原因，也因为它几乎可以保证当多个程序员在项目上工作时会出现 RCS 合并问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-07T11:23:18.980

我将项目的所有不同部分拆分为不同的文件，主要是为了与它相关的编译时间。当我需要链接的 CC 文件的对象已经存在时，我不必从头开始重新编译这些对象。

在整体文件和或更小的文件之间做出决定应该是团队的决定，并且应该在团队中每个程序员都遵循的编码规则中加以规定，就像有关于使用的制表符/空格的指南一样，应该有关于如何添加新代码的指南到项目。

对于某些项目，将尽可能多的代码放在一起更有意义，特别是如果只使用项目的一个部分而没有其余部分会使整个事情实际上毫无用处。这是一个权衡，你必须权衡利弊，最终你必须决定哪一个更适合你。

话虽如此，许多较小的文件允许多个开发人员使用类似于 Perforce 的版本控制系统进行更轻松的开发，因为它使一个开发人员所做的更改不太可能导致另一个开发人员处理另一段代码时需要解决的提交问题。

# c# - C#中的任意精度小数？

> ID：621684
> 
> 赞同：7
> 
> 时间：2009-03-07T11:00:57.317
> 
> 标签：c#, math

是否有可用于 C#的任意精度*十进制类？*我见过几个任意精度整数类，但这并不完全相同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T11:04:12.503

`java.math.BigDecimal`如果您安装了J# 库的类，则可以使用它。只需添加对`vjslib`.

```
/me remembers one of the betas in which we had System.Numeric.BigDecimal, sigh 
```

# java - Java Swing 打包窗口错误

> ID：621685
> 
> 赞同：3
> 
> 时间：2009-03-07T11:02:20.370
> 
> 标签：java, swing

我正在用 Java 制作类似 Scorched Earth 的游戏（用于我的考试项目：D），但我遇到了这个问题。我正在绘制一个窗口（JFrame），将布局设置为 BorderLayout，应用扩展的 JPanel，并打包窗口，但是在打包后，它在左侧和底部边框处显示了一些扩展的空白区域。

这是我的主要课程：

```
public class Main {
    public static void main(String[] args) {
        javax.swing.JFrame frame = new javax.swing.JFrame("game title");
        panel p = new panel(new java.awt.Dimension(512, 512));
        frame.setDefaultCloseOperation(javax.swing.JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(new java.awt.BorderLayout());
        frame.getContentPane().add(p, java.awt.BorderLayout.CENTER);
        frame.pack();
        frame.setResizable(false);
        frame.setVisible(true);
    }
} 
```

panel 是我的 JPanel 类，它在构造函数中将它的首选大小设置为参数 (512x512)。我已经在 Windows 和 Linux 上对此进行了测试，并且在这两个地方都出现了错误，并且白色间隙的大小因操作系统而异。

这是我的面板类：

```
class panel extends javax.swing.JPanel{
    panel(java.awt.Dimension size){
        setPreferredSize(size);
    }
    public void paint(java.awt.Graphics g){
        g.setColor(java.awt.Color.BLUE);
        g.fillRect(0, 0, 512, 512);
    }
} 
```

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T11:14:07.800

我试图在没有你的`panel`类的情况下重现它（它需要一个更好的名称，至少应该使用 CamelCase 命名）：

```
import javax.swing.*;

public class Main {
    public static void main(String[] args) {
        JFrame frame = new JFrame("game title");
        JPanel p = new JPanel();
        p.setPreferredSize(new java.awt.Dimension(512, 512));
        p.setBackground(java.awt.Color.BLUE);
        frame.setDefaultCloseOperation(javax.swing.JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(new java.awt.BorderLayout());
        frame.getContentPane().add(p, java.awt.BorderLayout.CENTER);
        frame.pack();
        frame.setResizable(false);
        frame.setVisible(true);
    }
} 
```

这会产生一个窗口，其中有一个蓝色的 512x512 面板，并且没有不同颜色的边框。所以问题一定出在你的`panel`班级上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T12:37:05.400

骚，

这不是你问的，但它的重要性永远不会降低......你不会在挥杆中覆盖*油漆；*相反，您覆盖了*paintComponent*。

参见 Sun 的“自定义绘画”教程：http: [//java.sun.com/docs/books/tutorial/uiswing/painting/](http://java.sun.com/docs/books/tutorial/uiswing/painting/)

事实上，我强烈建议（考虑到您选择的项目）阅读整个 Swing 教程。这需要“一段时间”，但值得花时间。

干杯。基思。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T11:42:36.857

我通过删除解决了这个问题：

```
setResizable(false); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-23T12:37:19.943

我查看了代码`setResizable()`并发现一切都是正确的。只是放在`this.setResizable(false)` *前面* `this.pack()`。

# c# - Microsoft Access 中的布尔列和使用 linq 过滤数据

> ID：621690
> 
> 赞同：2
> 
> 时间：2009-03-07T11:07:48.813
> 
> 标签：c#, linq, ms-access, filter, ms-access-2007

[很抱歉问题很长，但我认为其他人回答会更清楚]

我有一个 Microsoft Access 数据库，它包含一个包含以下列的“客户”表：

*   ID（自动编号）
*   名称（文字）
*   活跃（是/否）

我在 C# 中创建了数据库表类，如下所示：

```
[Table (Name = "Products")]
public class Product
{
    [Column (IsPrimaryKey = true, Name = "ProductID")]
    public int ID;

    [Column (Name = "ProductName")]
    public string Name;

    [Column (Name = "Active")]
    public bool Active;
} 
```

我正在使用以下代码片段来获取处于活动状态的产品：

```
using (var con = new OleDbConnection 
      (@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=D:\LearnLinq.accdb")) {
    var db = new DataContext (con);
    var productTable = db.GetTable<Product> ();
    var allProducts = from p in productTable
                      where p.Active
                      select p;

    foreach (var p in allProducts) {
        AddLine ("ID: " + p.ID.ToString () +
            ", Name: " + p.Name +
            ", Active: " + p.Active.ToString ());
    }
} 
```

问题是上述查询导致“无记录”。我试图分析生成的 SQL，它说如下：

```
SELECT [t0].[ProductID] AS [ID], [t0].[ProductName] AS [Name], [t0].[Active]
FROM [Products] AS [t0]
WHERE [t0].[Active] = 1 
```

任何线索为什么它应该发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T11:36:52.753

尝试仅将 OleDbCommand 对象与生成的 SQL 一起使用，并遍历使用 OleDbDataReader 返回的内容。

然后尝试使用这个 SQL 字符串

```
SELECT [t0].[ProductID] AS [ID], [t0].[ProductName] AS [Name], [t0].[Active] 
FROM 
[Products] AS [t0] 
WHERE [t0].[Active] = YES 
```

我相信这可能与 Jet 数据库中用于 Yes/No 数据类型的基础值有关。

> **是/否**
> 
> 逻辑字段可以显示为是/否、真/假或开/关。在代码中，使用常量 True 和 False，分别相当于 -1 和 0。

看看开发者社区下的[BLS 站点](http://www.blsys.net/)- 有 Linq to Access 解决方案的源代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T11:50:32.830

正如 Russ 所指出的，这看起来像是布尔值不同表示的问题。

尝试将“Where p.active”更改为“Where p.active <> 0”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T15:49:38.283

看看 productTable.active 字段包含 Access 数据库的内容，我敢打赌它可能不是 0 或 1。它可能是 -1。

你可能想要的是这样的：

```
var allProducts = from p in productTable
                  where p.Active = -1
                  select p; 
```

更新：（
OP
告诉我这在 linq/C# 中不起作用；但必须有一种方法可以在 linq 中执行与以下 SQL 等效的操作

```
Select * 
from Customers
where active = -1 
```

)

如果失败（例如，它显示为 yes/no | true/false），请尝试读取 Active in 的值并通过 msgbox 输出它，以查看它真正包含的内容。

# c++ - 单个 SetEvent() 能否触发多个 WaitForSingleObject()

> ID：621707
> 
> 赞同：8
> 
> 时间：2009-03-07T11:18:21.847
> 
> 标签：c++, winapi, events

这个：

[http://msdn.microsoft.com/en-us/library/ms686915(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms686915(VS.85).aspx)

似乎不建议。

我有三个通过管道进行通信的进程。进程 A 创建一个事件，进程 B 和 C 各自使用 WaitForSingleObject（在第二个线程中）。

所以现在我们有 -TWO- 进程，每个进程都在等待 -SINGLE- 事件。

进程 A 使用 SetEvent() 触发事件，进程 B 响应，进程 C 不响应。

结论：

每个 WaitForSingleObject() 都需要一个唯一的事件……对吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T11:27:22.900

使用手动重置事件来触发单个事件的多个线程。

[这](http://msdn.microsoft.com/en-us/library/ms686915(VS.85).aspx)是一个使用“手动重置事件”标志的示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-24T14:17:36.530

我希望这个例子可以帮助你：

```
handle1A = CreateEvent(LPSECURITY_ATTRIBUTES, ManualReset, InitialState, NAME)

handle1B = CreateEvent(LPSECURITY_ATTRIBUTES, ManualReset, InitialState, NAME)

handle2A = CreateEvent(LPSECURITY_ATTRIBUTES, ManualReset, InitialState, NAME+GetCurrentThreadId())

handle2B = CreateEvent(LPSECURITY_ATTRIBUTES, ManualReset, InitialState, NAME+GetCurrentThreadId()) 
```

A）如果您创建一个具有相同的事件，则`NAME`每个`setEvent`信号都`waitforsingleobjects`

```
SetEvent(handle1A) // Send signaling to handle1A and handle1B 
```

B）如果您创建一个具有唯一性的事件`NAME`，则`setEvent`仅将信号发送到引用的句柄

```
SetEvent(handle2) // Send signling only to handle2A. The Id Thread is unique 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T12:22:50.973

您可以使用手动重置事件和 PulseEvent 函数来释放当前等待事件的所有线程。

但是请注意，这种方法本质上是活泼的，因为无法分辨哪些是“当前正在等待的线程......”。如果需要精确匹配 wakeup/2 等待事件，您应该使用更可靠的同步机制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-11T00:16:42.390

如果是手动重置事件，一个事件可以通知多个线程。自动重置事件无法做到这一点。如果多个线程同时等待自动重置事件，并且您将其设置为信号状态，则只有一个线程存在并重置它，其他线程的行为将是未定义的。虽然，从 Microsoft 文档中，我们可以假设只有一个线程会退出，而其他线程肯定不会退出。无论如何，我们必须考虑以下引用：“不要假设先进先出 (FIFO) 顺序。内核模式 APC 等外部事件可以更改等待顺序”来源 - [https://msdn.microsoft.com/en-us/library/windows/desktop/ms682655(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682655(v=vs.85).aspx)

CreateEvent 函数具有 bManualReset 参数。如果为 TRUE，则该函数创建一个手动重置事件对象，该对象需要使用 ResetEvent 函数将事件状态设置为无信号。如果此参数为 FALSE，则该函数创建一个自动重置事件对象，并且系统会在单个等待线程被释放后自动将事件状态重置为非信号状态，即从 WaitForMultipleObjects 或 WaitForSigleObject 之类的函数退出 - 但是，如我之前写过，只有一个线程会被通知而不是全部。

至于 PulseEvent – 它不可靠且永远不应使用 – 请参阅[https://msdn.microsoft.com/en-us/library/windows/desktop/ms684914(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684914(v=vs.85).aspx)

只有在调用 PulseEvent 时处于“等待”状态的 PulseEvent 才会通知那些线程。如果它们处于任何其他状态，它们将不会收到通知，并且您可能永远无法确定线程状态是什么。等待同步对象的线程可以通过内核模式异步过程调用暂时从等待状态中移除，然后在 APC 完成后返回等待状态。如果对 PulseEvent 的调用发生在线程已从等待状态中移除的时间内，则不会释放线程，因为 PulseEvent 仅释放在调用它时正在等待的那些线程。您可以在以下链接中找到有关内核模式异步过程调用 (APC) 的更多信息：

*   [https://msdn.microsoft.com/en-us/library/windows/desktop/ms681951(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms681951(v=vs.85).aspx)
*   [http://www.drdobbs.com/inside-nts-asynchronous-procedure-call/184416590](http://www.drdobbs.com/inside-nts-asynchronous-procedure-call/184416590)
*   [http://www.osronline.com/article.cfm?id=75](http://www.osronline.com/article.cfm?id=75)

您可以从以下文章中获得有关自动重置事件和手动重置事件的更多想法：

*   [https://www.codeproject.com/Articles/39040/Auto-and-Manual-Reset-Events-Revisited](https://www.codeproject.com/Articles/39040/Auto-and-Manual-Reset-Events-Revisited)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-08-18T03:29:01.967

“不幸的是，我无法控制流程 A，所以我无法实现它。”

如果进程 A 创建一个自动重置事件。也许您可以在进程 b 中使用 SetEvent 再次触发它以使进程 c 执行。

# scripting - 检查终端中的重复项？

> ID：621708
> 
> 赞同：3
> 
> 时间：2009-03-07T11:18:41.127
> 
> 标签：scripting, shell

以下代码打印出一长串带有哈希和文件名的文件

```
md5sum *.java 
```

我曾尝试列出出现相同哈希的行，但未成功，以便我可以删除相同的文件。

如何过滤和删除具有相同内容的相同文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T11:56:13.440

这应该有效：

```
md5sum *.java | sort | uniq -d -w32 
```

这告诉 uniq 只比较前 32 个字符，这只是 md5 和，而不是文件名。

编辑：如果 -w 不可用，请尝试：

```
md5sum *.java | awk '{print $1}' | sort | uniq -d 
```

缺点是你不知道哪些文件有这些重复的校验和......无论如何，如果没有太多校验和，你可以使用

```
md5sum *.java | grep 0bee89b07a248e27c83fc3d5951213c1 
```

之后获取文件名（上面的校验和只是一个例子）。我确信也有办法在 shell 脚本中完成所有这些操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-25T19:59:19.477

## `fdupes`对重复项的看法较少

使用`fdupes`which 是命令行程序，例如

```
fdupes -r /home/masi/Documents/ > /tmp/1 
less -M +Gg /tmp/1 
```

它找到所有重复项并将它们存储在 temp 中的文件中。less 命令以百分比显示所有行的行位置和进程。我`fdupes`从这个[答案](https://askubuntu.com/a/3866/25388)及其明确的维基百科文章中[找到了](https://en.wikipedia.org/wiki/Fdupes)。`apt-get`您可以在 OSX 和Linux中通过 homebrew 安装它。

## `fdupes`与可能的删除交互使用

跑

```
fdupes -rd /home/masi/Documents 
```

让您选择删除或不删除哪个副本，交互作品的示例视图：

```
Set 4 of 2664, preserve files [1 - 2, all]: all

   [+] /home/masi/Documents/Exercise 10 - 1.4.2015/task.bib
   [+] /home/masi/Documents/Exercise 9 - 16.3.2015/task.bib

[1] /home/masi/Documents/Celiac_disease/jcom_jun02_celiac.pdf
[2] /home/masi/Documents/turnerWhite/jcom_jun02_celiac.pdf

Set 5 of 2664, preserve files [1 - 2, all]: 2

   [-] /home/masi/Documents/Celiac_disease/jcom_jun02_celiac.pdf
   [+] /home/masi/Documents/turnerWhite/jcom_jun02_celiac.pdf 
```

你在哪里看到我有 2664 个重复项。最好有一些静态文件来保存我想要的副本的设置；我[在这里](https://stackoverflow.com/q/31630714/54964)开了一个关于这个的话题。例如，我在一些练习和家庭作业中有相同的 bib 文件，所以当用户想要副本时不要第二次询问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T11:27:31.993

甚至更好：

```
md5sum *.java | sort | uniq -d 
```

那只会打印重复的行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T13:04:26.397

这列出了所有文件，在重复文件之间放置一个空行：

```
$ md5sum *.txt \ 
  | sort       \
  | perl -pe '($y)=split; print "\n" unless $y eq $x; $x=$y'

05aa3dad11b2d97568bc506a7080d4a3  b.txt
2a517c8a78f1e1582b4ce25e6a8e4953  n.txt
e1254aebddc54f1cbc9ed2eacce91f28  a.txt
e1254aebddc54f1cbc9ed2eacce91f28  k.txt
e1254aebddc54f1cbc9ed2eacce91f28  p.txt
$ 
```

只打印每组的第一个：

```
$ md5sum *.txt | sort | perl -ne '($y,$f)=split; print "$f\n" unless $y eq $x; $x=$y'
b.txt
n.txt
a.txt
$ 
```

如果你很勇敢，把“除非”改成“如果”，然后

```
$ rm `md5sum ...` 
```

删除除第一个组之外的所有组

# keyboard - 操作系统和实现独立访问键盘？

> ID：621716
> 
> 赞同：3
> 
> 时间：2009-03-07T11:24:54.233
> 
> 标签：keyboard, cross-platform, scancodes

我用 MSVC++ 制作了一个 FPS 游戏，它在 Windows 上运行得很好。但是现在我正在尝试使它可移植（至少我想创建一个 linux 和一个 Windows 版本），所以我决定将 IDE 更改为 Code::Blocks 并将框架更改为 wxWidgets。但似乎不同系统上的虚拟键码和扫描码是不同的。

早些时候我经历过，即使在相同的操作系统但不同的计算机上，虚拟键码也可能不同（我收到关于他们无法控制角色的错误报告（取决于 numlock 状态，哈哈，不是开玩笑），这在更改时已修复使用扫描码而不是 virtkey 码的代码）（编辑：使用 wxWidgets，小键盘上的 virtkey 和扫描码都有不同的值，具体取决于 numlock 状态，砰！）

现在使用 wxWidgets 似乎 wxKeyEvent::GetRawKeyCode 和之前从 WM_KEYDOWN 的 lParam 获得的代码是不同的。而且我还从 GetRawKeyCode 在 linux (ubuntu) 上获得了完全不同的扫描代码。

好吧，我可以通过按所有键并查看它给出的代码来制作自己的扫描码表，但是ubuntu在我的笔记本电脑上运行的唯一问题，并且笔记本电脑没有完整的键盘......但我需要所有这些使控制设置工作。

那么问题来了：是否有一种标准的跨平台方式来为同一个键（更准确地说是同一个位置的键）获取相同的代码？（至少在 Windows 和 linux 上）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T13:43:13.433

如果您还没有考虑过，您也许可以使用[SDL](http://www.libsdl.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T19:45:01.463

这是一个 FPS，您使用的较低级别的图形工具包有很大的不同（我假设您不是在 wxWidgets 中编写 3d 图形）。如果您使用的是 OpenGL，您是否看过[GLUT](http://www.opengl.org/resources/libraries/glut/spec3/spec3.html)可以做什么？

glutKeyboardFunc和[glutSpecialFunc与](http://www.opengl.org/resources/libraries/glut/spec3/node49.html#SECTION00084000000000000000 "glutKeyboardFunc")[glutGetModifiers](http://www.opengl.org/resources/libraries/glut/spec3/node54.html#SECTION00089000000000000000)相结合对于跨平台键盘代码[来说](http://www.opengl.org/resources/libraries/glut/spec3/node73.html#SECTION000104000000000000000)已经足够了，GLUT 甚至可以用于其他输入设备。

不过老实说，我仍然不明白这可能与 wxWidgets 有什么关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T10:35:07.760

我的看法是，使用 wxWidgets 编写快节奏的 3D 游戏是完全错误的。在“硬核”游戏开发中，你应该使用它来开发支持工具，例如编辑器和转换器。

[SDL](http://www.libsdl.org/)是要走的路。它可能看起来很基本，但是一旦您开始将小孩牺牲给 SDL 的邪恶之神，诸如[SDL_image](http://www.libsdl.org/projects/SDL_image/)（非常适合读取多种图像文件格式 - 在某种程度上我有时仅使用 SDL 来读取例如 JPEG）或[SDL_mixer](http://www.libsdl.org/projects/SDL_mixer/)（唯一的解决方案）您需要阅读和播放基本音频 - OGG、WAV、...）。

因此，SDL 就是您的最佳选择。一旦开始使用 SDL_gfx，即使是 2D 图形支持也很好。SDL 起初可能看起来很基础，但是一旦你计算了围绕它构建的所有额外库，并且一旦你编写了一些围绕它的包装器，你就会发现 SDL 是基本必需品和易于高级使用之间的完美平衡。

我很乐意在 SDL 方面以任何方式为您提供帮助，因为我觉得它非常棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T09:08:03.087

我可能误解了您在这里看到的内容，但是查看[返回的原始键码](http://docs.wxwidgets.org/stable/wx_wxkeyevent.html#wxkeyeventgetrawkeycode)会导致硬件、操作系统、配置和平台差异，因此您应该查看[键事件](http://docs.wxwidgets.org/stable/wx_wxkeyevent.html#wxkeyevent)返回的[虚拟键码](http://docs.wxwidgets.org/stable/wx_wxkeyevent.html#wxkeyeventgetkeycode)。

编辑：也许[wxWidgets](http://docs.wxwidgets.org/stable/wx_miscellany.html#wxgetkeystate)只是没有正确处理它~~（可疑）~~。numlock 键的问题是“迫使”您通过使用原始扫描代码来解决这个问题（很差）。

如果是这种情况，您不需要丢弃您所做的事情，但是如果您仅为输入内容添加[SDL ，您会发现返回](http://libsdl.org)[SDL_keysym](http://www.libsdl.org/cgi/docwiki.cgi/SDL_keysym)的调用不只是返回硬件扫描码（您可以什么都不做“修复”），但也将它映射到一个 unicode 字符和一个虚拟符号，我认为这是你正在寻找的。希望他们的电话没有这个数字锁定修饰符问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T18:33:23.390

如果你不想使用 SDL，我推荐[SFML - Simple and Fast Multimedia Library](http://www.sfml-dev.org/)。它是多平台的，使用起来非常简单。例如，从[教程部分](http://www.sfml-dev.org/tutorials/1.4/window-events.php)：

```
bool         LeftKeyDown     = Input.IsKeyDown(sf::Key::Left);
bool         RightButtonDown = Input.IsMouseButtonDown(sf::Mouse::Right);
bool         Joy0Button1Down = Input.IsJoystickButtonDown(0, 1);
unsigned int MouseX          = Input.GetMouseX();
unsigned int MouseY          = Input.GetMouseY();
float        Joystick1X      = Input.GetJoystickAxis(1, sf::Joy::AxisX);
float        Joystick1Y      = Input.GetJoystickAxis(1, sf::Joy::AxisY);
float        Joystick1POV    = Input.GetJoystickAxis(1, sf::Joy::AxisPOV); 
```

其中输入是

```
const sf::Input& Input = App.GetInput(); 
```

有[一些迹象](http://www.sfml-dev.org/forum/viewtopic.php?t=43)表明 SFML 比 SDL 快，但是我倾向于使用它来快速生成可移植的代码，因为我更喜欢它的用法而不是 SDL。

# iis - 无法在本地计算机上浏览在家中托管的网站

> ID：621728
> 
> 赞同：3
> 
> 时间：2009-03-07T11:37:23.953
> 
> 标签：iis, hosting, dns

我有一个托管在 IIS 上的 ASP.NET 网站。在我的家庭网络之外，我可以看到该网站，但在网络内部，它给了我一个 404 错误。我可以以本地主机的身份浏览该站点。这似乎是一个 DNS 问题，只是不知道如何解决它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T12:01:21.710

这几乎可以肯定是 NAT 问题。我假设您的 Web 服务器位于 NAT 路由器后面，并且您已将某些端口（可能是 80）从路由器的外部接口转发到服务器机器上的端口 80。我还假设您尝试使用解析为您的外部 IP 的名称（可能是动态 DNS 名称）访问您的网站，或者您尝试使用该外部 IP 直接访问它。这可能不会开箱即用，因为大多数 NAT 路由器只会使端口映射可用于进入路由器外部接口的数据包。

如果上述情况成立，则有四种可能的解决方案：

1.  查看路由器的配置并尝试找到类似于“NAT 环回”、“Ext-int 环回”等的内容。这将指示路由器处理来自内部接口并以外部 IP 为目的地的数据包，就像它处理来自外部接口的数据包一样，有效地循环回流量。这将触发端口转发，您的站点将正常工作。并非所有路由器都有此选项，但如果您有此选项，它将是最强大的解决方案。如果您没有，您也可以尝试将其固件更改为支持您的路由器（Tomato、OpenWRT、DD-WRT 等）的免费固件之一。我已经成功地将[Tomato](http://polarcloud.com/tomato)用于此类场景。

2.  当您在路由器后面时使用内部 IP，而在外面时使用外部 IP。

3.  将您使用的 DNS 名称添加到您自己的主机文件中，使其与内部 IP 相对应。当从您自己的主机访问名称时，这将自动实现 (3)。您必须对路由器后面的每个主机重复此操作。

4.  在路由器后面运行您自己的 DNS 服务器，使其声明对您的 DNS 记录的权限并将其解析为内部 IP，同时将其他 DNS 查询转发到您的实际名称服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T11:54:06.893

您可能将域指向的外部可见 IP 地址实际上是您的路由器或电缆调制解调器的 IP 地址。外部连接将被路由到打开 IIS 的机器，但是当您从网络内部连接时，您将获得路由器自己的 Web 服务器及其管理界面。这不太可能有与您请求的 URL 匹配的页面，因此您将得到 404。

您应该能够通过在您的家庭计算机的主机文件中添加一个条目来修复它，以将您的域映射到打开 IIS 的计算机的内部 IP，覆盖 DNS 条目中的外部 IP。

# wpf - 重用内置 WPF 样式

> ID：621729
> 
> 赞同：2
> 
> 时间：2009-03-07T11:38:23.903
> 
> 标签：wpf, templates, styles, built-in

如何访问 WPF 的内置样式/模板？

例如，我试图将 NavigationWindow 的镶边移动到窗口底部。我看过微软的 NavigationWindow[模板示例](http://msdn.microsoft.com/en-us/library/aa970054.aspx)，但它非常冗长，并且没有重用默认的导航镶边。

我也试过看 Snoop 里面的树。所有的铬都包含在一个名为“NavChrome”的网格元素中，但我可以找到任何对它的引用。似乎也没有任何与之匹配的“PART_xyz”。

对于 CTP，有些人提到使用“PFThemeNavigationWindowNavigationButtonForwardButtonStyle”等按钮样式，但这似乎不再起作用。

那么，是否可以访问这些内置样式？在其他地方也可以重复使用它们会很好！

谢谢！

* * *

编辑：[saldoukhov](https://stackoverflow.com/users/58463/saldoukhov)的回答非常有帮助，但是有没有办法做到这一点而无需复制所有 XAML？对我来说，这似乎不是一个非常[干燥](http://en.wikipedia.org/wiki/Don't_repeat_yourself)的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T22:39:51.567

我通常在 Expression Blend 中执行此操作。选择控件->右键单击->编辑控件部件（模板）->编辑副本...

那么这取决于你想做什么。如果您很幸运，并且您正在编辑的模板包含对键控资源更改的引用，您可以获得所需的效果，那么您可以使用此键创建自己的资源，它们将“覆盖”模板中的资源，在这种情况下，您不需要携带完整的模板。但更多时候，你需要围绕模板更改一些东西，所以你只需将其提取到自己的资源中并开始随身携带。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T13:36:04.453

不是对您的问题的回答，而是一点提示：除了 saldoukhov 的回答之外，您还可以使用 XamlPadX ( [http://blogs.msdn.com/llobo](http://blogs.msdn.com/llobo) ) 来访问内置样式，如果您不这样做' t 有 Expression Blend。

# asp.net - 如何在使用 Unity 的 Web 应用程序中保持跨回发的依赖关系？

> ID：621730
> 
> 赞同：0
> 
> 时间：2009-03-07T11:39:21.717
> 
> 标签：asp.net, unity-container

msdn 上统一框架的此链接指出 *“**您希望能够在 Web 应用程序中跨回发缓存或持久化依赖项**”*

[http://msdn.microsoft.com/en-us/library/dd203319.aspx#](http://msdn.microsoft.com/en-us/library/dd203319.aspx#)

我不确定上述*所有陈述的含义。*我正在寻找一个示例，我们如何使用 Unity 来做到这一点 - 不确定 Unity 将如何解决回发问题。它会在会话中保持依赖关系并将其取回吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T09:10:04.343

我写了一个使用 Session 和 Cache 的简短示例。我创建了一个名为 incrementer 的测试类，这与我将类设为静态或至少是变量非常相似。RegisterInstance 用于单例解析

```
 public class Incrementer
{
    private int count;

    private object synclock = new object();

    public int GetCount()
    {
        return count;
    }

    public void Increment()
    {
        System.Threading.Monitor.Enter(synclock);
        count++;
        System.Threading.Monitor.Exit(synclock);
    }
}

public IUnityContainer SessionUnityContainer
{
    get
    {
        if (Session["SharedIncrementer"] == null)
        {
            IUnityContainer container = new UnityContainer();
            container.RegisterInstance<Incrementer>(new Incrementer());
            Session["SharedIncrementer"] = container;
        }
        return Session["SharedIncrementer"] as IUnityContainer;
    }
}

public IUnityContainer CacheUnityContainer
{
    get
    {
        if (Cache["SharedIncrementer"] == null)
        {
            IUnityContainer container = new UnityContainer();
            container.RegisterInstance<Incrementer>(new Incrementer());
            Cache["SharedIncrementer"] = container;
        }
        return Cache["SharedIncrementer"] as IUnityContainer;
    }
}

protected void Page_Load(object sender, EventArgs e)
{
    Incrementer i1 = SessionUnityContainer.Resolve<Incrementer>();
    Incrementer i2 = CacheUnityContainer.Resolve<Incrementer>();

    for (int i = 0; i < 10; i++)
        i1.Increment();

    for (int i = 0; i < 5; i++)
        i2.Increment();

    Response.Write(i1.GetCount().ToString());
    Response.Write(i2.GetCount().ToString());
} 
```

希望对您有所帮助：

安德鲁

**编辑：以下示例 cimply 使用 UnityContainer 的单例实例，如果您继续刷新页面，将看到它保留以前的值。**

```
public class Incrementer
{
    private int count;

    private object synclock = new object();

    public int GetCount()
    {
        return count;
    }

    public void Increment()
    {
        System.Threading.Monitor.Enter(synclock);
        count++;
        System.Threading.Monitor.Exit(synclock);
    }
}

public static class ExampleSettings
{
    private static IUnityContainer container = null;

    public static IUnityContainer Container
    {
        get
        {
            if (container == null)
            {
                container = new UnityContainer();
                container.RegisterInstance<Incrementer>(new Incrementer());
            }
            return container;
        }
    }
}

protected void Page_Load(object sender, EventArgs e)
{
    Incrementer i1 = ExampleSettings.Container.Resolve<Incrementer>();

    for (int i = 0; i < 10; i++)
        i1.Increment();

    Response.Write(i1.GetCount().ToString());
} 
```

# html - Rails 中的复选框

> ID：621735
> 
> 赞同：0
> 
> 时间：2009-03-07T11:46:53.150
> 
> 标签：html, ruby-on-rails, checkbox

我的 html 中有复选框，并且分页也已实现。当我在第一页中选择几个复选框并通过分页转到下一页时，它会取消选择上一页的复选框。当我点击提交时，它只给我当前页面选中复选框的值。如何一次性检索所有选定的复选框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T11:50:19.600

您必须记住 HTTP 是无状态的。除非您明确记住并复制它，否则不会记住用户在一个页面上所做的任何事情。将 Next 按钮设为提交按钮，进入下一页，从 post 数据中读取复选框值，然后在下一页手动设置它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T13:48:31.047

当有人在审核主题时，我会为某人在[rboard](http://github.com/radar/rboard)中所做的每一次点击做一个 ajax 请求。这是你可以走的路。

# iphone - 翻译小型应用程序：谁和多少？

> ID：621737
> 
> 赞同：3
> 
> 时间：2009-03-07T11:48:33.020
> 
> 标签：iphone, localization, translation

我希望将我的几个 iPhone 应用程序翻译成其他（人类）语言。我已经在我的代码中做了所有正确的事情，并且到处都插入了翻译表查找，所以我在技术上已经做好了准备。

当然，问题是我连*一*门外语都不会翻译我的应用程序，更不用说我想提供的七八门外语了。我也没有翻译经验。这给我留下了很多问题，比如：

1.  我在哪里可以找到翻译人员？

2.  他们通常要花多少钱？（我首先要做的应用程序很小——不到 700 字，不包括营销材料。）

3.  我如何确保他们交出正确且高质量的工作？（如果我能读懂他们给我的东西，我就不需要翻译了。）

4.  当我更改和扩展应用程序时，如何处理这些翻译的持续维护？如何翻译发行说明？为小型、快速的翻译持续聘请翻译人员是否普遍？

5.  我没有问什么重要的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T13:51:01.103

我不知道您的应用程序的性质，但我看到广泛用于共享软件（和免费软件）的模型是为您的一些来自国外的（测试版）用户提供免费许可证（也许终身免费）升级等）以换取帮助翻译。通常在应用程序的网站上会宣布需要翻译人员。

至于翻译的质量，你只能说“这个字符串太长，它会破坏 UI”——但你应该寻找这些语言的 beta 用户来试用翻译后的应用程序并报告任何错误。理想情况下，随着您的用户群的增长，（免费）不正确措辞的报告也会...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T16:28:24.143

试试[Rent A Coder](http://www.rentacoder.com/RentACoder/DotNet/default.aspx)之类的服务——那里有很多人在做翻译，而且价格很有竞争力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T11:27:57.233

我听说过有关[Tethras](http://www.tethras.com/help)的好消息，并且喜欢这样一个事实，即您可以让他们进行部分翻译，并且您可以自己或使用朋友/家人对其中一些人进行翻译，但仍与他们的系统集成。

我肯定会将它用于我的下一个商业 Mac 应用程序。

# c# - 如何处理 global.asax 中的会话结束？

> ID：621744
> 
> 赞同：12
> 
> 时间：2009-03-07T11:59:28.500
> 
> 标签：c#, asp.net, global-asax

我在聊天应用程序中工作，我使用 HashTable 来包含用户和操作员作为 ChatRoom 类的键和对象作为 HashTable 的值。主要问题是当用户或操作员关闭浏览器或在未注销的情况下断开连接时，它会在会话结束时自动注销。

请帮助我解决这个问题以及如何在这件事上使用 Global.asax。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-07T12:20:15.910

您可以使用 global.asax 的会话结束事件来删除意外断开的用户：

```
void Session_End(Object sender, EventArgs E) {
    // Clean up session resources
} 
```

但请注意，当用户关闭浏览器或连接丢失时，会话不会结束。当会话超时时结束。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-07T12:14:31.740

将 Global.asax 文件添加到您的网站，然后在 Session_End 事件中，将用户从 HashTable 中删除。

```
protected void Session_End(Object sender, EventArgs e)
{
    // Remove user from HashTable
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-07T12:44:18.660

Session_End 事件在浏览器关闭时不会触发，它会在服务器在特定时间段（默认为 20 分钟）内没有收到用户的请求时触发。这意味着如果您使用 Session_End 删除用户，他们将在关闭浏览器后继续聊天 20 分钟。

我建议您将最后一次请求的时间保留在用户对象中。通过这种方式，您可以确定用户的活跃程度，以及用户离开聊天的可能性有多大。例如，您可以将任何两分钟内没有做任何事情的用户显示为非活动用户。

您还可以让聊天应用程序定期轮询服务器（如果您还没有这样做的话）。这将更新对象中的最后一次请求时间，并在聊天窗口打开时让用户保持活动状态。

当用户离开页面时，您可以使用浏览器中的 onunload 事件向服务器发送注销请求。这当然只有在用户仍然有网络连接的情况下才有效。当您重新加载页面时也会触发 onunload 事件，因此您必须跟踪触发事件的原因才能使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-01T16:16:41.197

您可以使用始终在客户端上运行的 JavaScript 向服务器发送信号 - 例如“我在这里”。如果下一个信号没有出现，您可以调用`Leave();`。我使用 AJAX 来做到这一点。

# c++ - 在 C++ 中的文件流中发出错误信号

> ID：621745
> 
> 赞同：2
> 
> 时间：2009-03-07T12:00:14.863
> 
> 标签：c++

我有以下示例：

```
#include <iostream>
#include <fstream>
using namespace std;
int main()
{
    ifstream file;
    cout << file << endl;           // 0xbffff3e4
    file.open("no such file");
    cout << file << endl;           // 0
    cout << (file == NULL) << endl; // 1
    cout << file.fail() << endl;    // 1
} 
```

如果文件是`NULL`，怎么可能调用`fail`成员函数？我对 C++ 不是很熟悉，这是正常行为吗？我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T12:06:09.610

文件是一个对象 - 它不能为空。但是，ifstream 有一个运算符 void*() 重载，当文件处于错误状态时返回 0。当你说（例如）：

```
cout << file << endl; 
```

编译器将其转换为：

```
cout << file.operator void*() << endl; 
```

这种转换将用于各种地方 - 基本上可以使用指针或整数类型的任何地方。当你说：

```
(file == NULL) 
```

您将 operator void*() zero 返回的零与 NULL 进行比较并得到 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T12:05:12.263

尝试 file.good() 或将文件转换为 bool：

```
file.open("no such file");
if (file)
  cout << "Open OK" << endl;
else
  cout << "Open FAILED" << endl; 
```

# delphi - 如何在 DDE 事件后将窗口置于最前面？

> ID：621751
> 
> 赞同：2
> 
> 时间：2009-03-07T12:08:25.080
> 
> 标签：delphi, focus, show, dde

在 DDE 事件中，我的程序会加载一个文件并应该弹出到前台。我正在使用

```
show; 
```

当我隐藏窗口时，它似乎只像那时那样工作。

所以我加了

```
bringtofront; 
```

如果它被隐藏、关闭、最小化或在图标托盘中，这同样有效，但如果它在另一个窗口下打开则无效。

我什至尝试了一些 hacky 的东西，比如

```
windowstate:=wsminimized;
windowstate:=wsnormal; 
```

试图强迫它显示，但无济于事。我知道代码正在运行，因为我在此块的任一侧都有打印输出，并且没有可能卡住的条件语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T12:15:19.227

您是否尝试过[SetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633539(VS.85).aspx)和/或 SetActiveWindow？另请参阅有关此主题的[MSDN 信息。](http://support.microsoft.com/kb/97925)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T16:14:57.263

SetForegroundWindow 并不总是有效。事实上，现在它不太可能起作用，因为应用程序不应该抓住焦点，它们只能放弃它。MS 多年来一直在努力*防止*应用程序窃取输入焦点。阅读Raymond Chen对此[博客条目](http://blogs.msdn.com/oldnewthing/archive/2009/02/20/9435239.aspx)的评论，了解一些历史。

所以，如果你自己是前台应用程序，你可以 SetForegroundWindow 到另一个应用程序，一切都会很好。如果您不是前台应用程序，那么唯一可能发生的事情是任务栏按钮将开始闪烁。

只是为了增加一些混乱，确切的行为取决于 Windows 版本，所以会发生什么取决于您正在运行的 Windows 类型 - 他们已经搞砸了很长时间:-)。

# jquery - 如何改进使用 jquery 将 div 尺寸保存到 css 的系统

> ID：621753
> 
> 赞同：1
> 
> 时间：2009-03-07T12:08:33.190
> 
> 标签：jquery, ajax, html, save

警告：我不是一个解释事情的好人，我的英语不是很完美，而且我对 php、javascript 和 jquery 有点菜鸟。如果您认为自己可以处理，请继续阅读。

所以，我有一个小系统，你可以在其中向网站添加 div，拖动它们并缩放它们。使用 jquery 很容易。但是，我正在尝试将更改保存到 css 和 html 文件，因此下次打开页面时，它就像您编辑它一样。

它还没有准备好，但我知道有可能做到这一点。但是，在完成它之前，我想知道是否有人建议如何以任何方式使其更简单或更好。

我将解释它现在是如何工作的：

用户添加了几个 div，缩放并拖动它们。（jQuery 用户界面）。当用户单击保存更改的按钮时，系统会检查主容器有多少子元素（所有用户创建的 div 都是主容器的子元素）。现在系统循环所有子元素并将它们的维度 ( `width`, `height`, `left`, `right`) 放入这样的数组`[0]="200,300,500,500"`中。循环完成后，系统将数组连接成一个字符串，其中不同的元素用分号分隔。

系统发布字符串`$.ajax()`并使用 php 文件读取它，这就是 php 文件中发生的情况：

1.  php 将通过 post 得到的字符串解析成这样的数组

    ```
    [0]="200,300,500,500" 
    ```

2.  现在它遍历数组的内容，将每个字符串解析为 4 个变量

    ```
    $width = 200;
    $height = 300;
    $left = 500;
    $top = 500; 
    ```

3.  现在系统将这些值作为字符串放入另一个数组中，并将 css 代码添加到字符串中。所以这个新数组看起来像这样

    ```
    [0] = "#div0{width:200px;height:300px;left:500px;top:500px;}." 
    ```

4.  数组完成后，系统将其内爆成字符串，删除旧`customstyle.css`文件并将字符串写入新`customstyle.css`文件。

此处不包括自定义 html 文件的创建，但只需检查由发布数据组成的数组有多少个值，然后在 html 文件中创建等量的 div，其中每个 div 的 id 为“div(number) ”。

当页面加载时，php 包含自定义 css 和 html 文件。目标是拥有不需要 javascript 且 xhtml 有效且样式简单的索引页面，以及用于编辑且需要 javascript 的其他页面。

我认为这个系统太复杂了，有太多的数组等等。但我不知道如何让它更简单:)

我正在考虑在开始时使用 javascript 创建整个样式字符串并将其作为一个整体发布到 php 中，然后将它原样写入样式表。但它比现在大得多，发布它不会那么有效。（这并不重要，因为我是唯一一个尝试该系统的人，但感觉不对：P）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T15:29:34.487

保存按钮可以组装一个包含所有 div 集合的 json 对象。它比使用字符串提供了许多优点，并且可以很容易地被 php 读取。

在 php 方面，为自定义元素编写一个类。它将有助于提高可读性，并允许您以更合乎逻辑的方式组合数据。类可以像这样简单

```
class CustomElement{
    public $height;
    public $width;
    public $leftPos;
    public $rightPos;
    private $elmentName;

    public function __construct($name){
       $this->elementName = $name
    }
} 
```

现在，每当您想处理新的自定义元素时，您都可以

```
$curElement = new CustomElement("div2");
$curElement->height = 600;
$curElement->width = 800;
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T12:20:02.180

这听起来像是 cookie 的工作。基本上，您将维度状态保存到 cookie（[这里是 Quirksmode 的链接，描述了在 Javascript 中使用 cookie](http://www.quirksmode.org/js/cookies.html)）。在页面加载时，您尝试使用 javascript 从 cookie 中检索维度状态并将其应用于您的元素。您可以通过 html (css) 类使用 jQuery 过滤它们，因此这是一项简单的任务。

如果你做得对，用户不会注意到任何事情。

# entity-framework - 数据传输对象和实体框架

> ID：621759
> 
> 赞同：1
> 
> 时间：2009-03-07T12:17:07.400
> 
> 标签：entity-framework, entity

我正在开发一个使用 microsoft Entity Framework 的 3 层 Web 应用程序。为了在不同层之间建立松散耦合，我使用数据传输对象在实体框架对象和我的自定义对象之间进行传输，但是我在实体框架和我的自定义 DTO 之间的转换速度存在问题。我使用这种方法从 EF 转移到 DTO：

`public List Transform(List carModelDefinition) {`

 ````
 List<CarDefinitionDTO> cdDTOList = new List<CarDefinitionDTO>();
        foreach (DataLayer.CarModelDefinition cmd in carModelDefinition)
        {
            CarDefinitionDTO cdDTO = new CarDefinitionDTO();
            cdDTO.CarDefinitionId = cmd.CarModelDefinitionId;
            cdDTO.Compagny = cmd.Company;
            cdDTO.Model = cmd.Model;
            cdDTOList.Add(cdDTO);
        }
        return cdDTOList;

} 
````  `但是当我尝试传输一个包含 600 个元素的列表时，我需要大约 10 秒以上的时间。我做错了什么，还是速度这么慢？注意。我正在使用一台速度非常快的 PC，所以不是我的 PC 的速度减慢了它的速度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-08T08:55:47.233

我发现了错误。在构造函数中我创建了实体管理器的实例，当我创建一个新对象时，它会一直创建一个新实例，这非常耗时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T12:28:10.430

您发布的代码不仅仅是在 EF 类型和 DTO 类型之间进行转换 - 您还从数据库中获取数据。尝试将两者分开以进行测量。很有可能是数据检索需要 10 秒，而不是在内存中移动数据所花费的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T20:27:23.617

我说：

```
 public List<CarDefinitionDTO> LoadAll()
    {
        List<DataLayer.CarModelDefinition> carList = (from cd in mee.CarModelDefinition select cd).ToList();
        CarDefinitionDTO cdDTO = new CarDefinitionDTO();
        List<CarDefinitionDTO> carDefList = cdDTO.Transform(carList);
        return carDefList;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T12:54:37.650

干燥！尝试使用像[EntitiesToDTOs](http://entitiestodtos.codeplex.com)这样的 DTO/Assembler 生成器。它从您的实体框架 EDMX 文件生成 DTO 和汇编程序。这样您就不必编写每个实体/DTO 映射，汇编程序将为您的实体和生成的 DTO 添加扩展方法，因此您最终可以像这样进行编码：

```
var myCar = new Car();
CarDTO dto = myCar.ToDTO();
myCar = dto.ToEntity(); 
```

或者：

```
ICollection<Car> carCol = new List<Car>();
ICollection<CarDTO> carDTOs = carCol.ToDTOs();
carCol = carDTOs.ToEntities(); 
```

非常简单，该工具非常易于使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-23T03:02:06.467

您可以尝试将数据以二进制形式（压缩`zip`和解`unzip`压缩）。

*   [MSDN 压缩](http://msdn.microsoft.com/es-es/library/system.io.compression.gzipstream(v=vs.110).aspx)
*   [XML 序列化示例](http://msdn.microsoft.com/en-us/library/58a18dwa(v=vs.80).aspx)

# php - SWF 对象不播放我的 XML 播放列表

> ID：621760
> 
> 赞同：0
> 
> 时间：2009-03-07T12:19:03.993
> 
> 标签：php, xml, web, flash, swfobject

我试图将[youtubetune](http://www.youtubetune.com/)播放器包含到社交网络中，但由于某种原因，它不会播放它应该播放的 xml 文件。通过将必要的 swf 文件和 swfobject.js 文件上传到我的服务器，我解决了跟踪甚至出现的问题。现在曲目出现在播放器面前，但播放器不会播放它们。

[你可以在这里](http://www.munsivu.net/index.php?sivu=profiili&id=1)看到我的播放器。向下滚动到播放器，其中有一首曲目“Drowning - Rufio”，swf 文件位于 /embed 文件夹中，而 playlist.xml 文件位于 /Tiedostot/Noctis-/ 文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T16:42:28.510

好的，解决了。好像我忘记了 yt.swf 文件。（我看到媒体播放器用的是JW Player）

# c# - 为 IIS7 创建等效于 ISAPI 扩展的内容

> ID：621765
> 
> 赞同：5
> 
> 时间：2009-03-07T12:22:51.223
> 
> 标签：c#, .net, asp.net, iis, iis-7

我搜索了 IIS7 MSDN 数据库，但找不到任何关于如何为 IIS7 创建自定义 C#.NET 扩展的*具体*材料，我知道以前在 IIS6 中，如果你想说插入，你必须用 C++ 编写 ISAPI 扩展您自己的网站脚本语言（这是我想要做的），但在 IIS7 中，您应该能够使用 C#.NET 并利用 IIS7 的新可插入架构来编写它......但我不能找到任何关于如何做到这一点的文档。

有人愿意指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T12:29:00.990

[这篇文章](http://mvolo.com/blogs/serverside/archive/2007/08/15/Developing-IIS7-web-server-features-with-the-.NET-framework.aspx)是一个很好的起点。它在开头有示例模块的链接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T12:29:17.620

在 IIS7 集成模式下，HTTP 模块相当于 ISAPI 过滤器，HTTP 处理程序相当于 ISAPI 扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T12:26:25.473

查看[HTTP 处理程序](http://www.15seconds.com/Issue/020417.htm)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T20:34:25.830

当然，您仍然可以使用 ISAPI C++ 接口。可能有现有的代码可以用来启用新的脚本语言，因为 C++ 的东西已经存在很久了。

# .net - 奇怪的行为 XmlDocument.LoadXML 和 GetElementByID，如何用引号删除字符串

> ID：621772
> 
> 赞同：2
> 
> 时间：2009-03-07T12:28:06.357
> 
> 标签：.net, xml, quotations

这是一些c#代码

```
string webPageStr =  @"<html><body><div id=""content"">good content</div><div id=""badcontent"">bad content</div></body></html>";
XmlDocument webPage = new XmlDocument();
webPage.LoadXml(webPageStr);

 XmlElement divElement = webPage.GetElementById("content"); 
```

并且 divElement 等于 null 我不知道为什么

我也试过这样声明 webPageStr

```
string webPage =  @"<html><body><div id=&quot;content&quot;>good content</div><div id=&quot;badcontent&quot;>bad content</div></body></html>"; 
```

但 XmlDocument 抛出异常 System.Xml.XmlException: "&" bad token

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T12:36:38.553

如果要使用[GetElementById](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.getelementbyid.aspx)方法，则需要包含 DOCTYPE 声明。这是因为该函数不知道给定 XML 的 ID 意味着什么。在您的情况下，您使用的是 XHTML，因此您需要指定当您想通过 id 查找元素时，这意味着找到一个具有名为“id”的属性的节点：

```
string webPageStr = @"<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""><html><body><div id=""content"">good content</div><div id=""badcontent"">bad content</div></body></html>";
XmlDocument webPage = new XmlDocument();
webPage.LoadXml(webPageStr);
XmlElement divElement = webPage.GetElementById("content"); 
```

第一种方法意味着您在运行代码时需要对 DOCTYPE 声明进行 Web 访问（[http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd](http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd)）

另一种方法是使用 XPATH 表达式：

```
string webPageStr = @"<html><body><div id=""content"">good content</div><div id=""badcontent"">bad content</div></body></html>";
XmlDocument webPage = new XmlDocument();
webPage.LoadXml(webPageStr);
XmlNode divElement = webPage.SelectSingleNode("//div[@id=\"content\"]"); 
```

# c++ - 如何减少程序的CPU使用率？

> ID：621776
> 
> 赞同：6
> 
> 时间：2009-03-07T12:33:25.283
> 
> 标签：c++, performance, parallel-processing, qtconcurrent

我编写了一个多线程程序，它通过大量浮点运算进行一些 CPU 繁重的计算。更具体地说，它是一个逐帧比较动画序列的程序。即，它将动画 A 中的帧数据与动画 B 中的所有帧进行比较，针对动画 A 中的所有帧。我对不同的动画并行执行这种密集操作，因此程序可以处理 AB 对、BC 对和 CA 对在平行下。该程序正在使用 QtConcurrent 和一个“映射”函数，该函数将一个带有运动的容器映射到一个函数上。QtConcurrent 为我管理线程池，我正在使用英特尔四核处理器，因此它产生 4 个线程。

现在，问题是我的进程破坏了我的 CPU。使用是 100% 不变的，如果我在足够大的动作集上运行我的程序（非分页区域中的页面错误），我实际上会出现蓝屏死机。我怀疑这是因为我的电脑超频了。但是，这可能是因为我编写程序的方式吗？我用来测试机器稳定性的一些非常密集的基准测试工具从未让我的电脑崩溃。有什么方法可以控制我的程序如何使用我的 CPU 来减少负载？还是我误解了我的问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-07T12:38:08.033

超频 PC 会导致各种奇怪的问题。如果您怀疑这是问题的根本原因，请尝试将其计时在合理的范围内并重试您的测试。

它也可能是某种非常奇怪的内存错误，您以某种方式破坏了 RAM，Windows（我猜是因为 BSOD 而导致的操作系统）无法再恢复（不太可能，但谁知道）。

我能想到的另一种可能性是，您的线程实现中有一些错误会杀死窗口。

但首先，我会看看超频问题......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-07T13:01:16.230

> 我怀疑这是因为我的电脑超频了。

这绝对是可能的。尝试将其设置为正常速度一段时间。

> 这可能是因为我编写程序的方式吗？

在用户模式下运行的程序不太可能导致 BSOD。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-07T13:02:15.590

您描述的那种操作已经是高度可并行化的。运行多个工作实际上可能会*损害*性能。这样做的原因是因为任何处理器的缓存大小都是有限的，您尝试并发执行的次数越多，每个线程的缓存份额就越小。

您还可以查看使用 GPU 来吸收一些处理负载的选项。对于大多数类型的视频转换，现代 GPU 比同类 CPU 的效率要高得多。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T13:06:12.240

这里有一些很好的答案。

我只想补充一点，从已经进行了大量性能调整的角度来看，除非每个线程都经过积极优化，否则它有很大的减少周期的空间。

用长距离赛车来类比，有两种方法可以尝试获胜：

1.  让车开得更快
2.  减少中途停留和绕行

以我的经验，大多数最初编写的软件都远没有走最直接的路线，*尤其是*当软件变得越来越大时。

正如 Kenneth Cochran 所说，要在你的程序中找到浪费的循环，永远不要猜测。如果你在没有证明它是一个问题的情况下修复了某些东西，那么你就是在猜测。

查找性能问题的流行方法是使用分析器。

但是，我经常这样做，我的方法是这样的：http: [//www.wikihow.com/Optimize-Your-Program%27s-Performance](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-07T23:03:40.527

猜测一下，我会说您没有运行 3 核机器（或 4，考虑到 100% 的使用率），如果您使用的线程多于核心，并行化会严重损害您的性能。每个 CPU 内核只创建一个线程，无论您做什么，都**不会同时让不同线程访问数据**。大多数多核 CPU 中的缓存锁定算法绝对会扼杀你的性能。在这种情况下，在处理 L 帧动画的 N 核 CPU 上，我将在帧 0-(L/N) 上使用线程 1，在帧 (L/N)-(2*L/N) 上使用线程 2，. .. 框架上的螺纹 N ((N-1)*L/N)-L。依次执行不同的组合（AB、BC、CA），这样您就不会破坏您的缓存，而且它应该更易于编码。

作为旁注？像这样的真实*计算**应该*使用 100% 的 CPU，这意味着它会尽可能快地运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-07T13:01:41.380

超频是不稳定的最可能原因。对于任何 CPU 密集型算法，都会有一些 CPU 抖动。超频无法承受，我会找到一个好的性能分析器来找到性能瓶颈。永远不要猜测问题出在哪里。您可能会花费几个月的时间来优化对性能没有实际影响的东西，或者更糟糕的性能甚至会下降。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-07T12:48:47.183

归咎于硬件太容易了。我建议您尝试在不同的系统上运行您的程序，看看使用相同的数据结果如何。

可能你有一个错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-07T23:11:38.433

研究使用 SIMD 操作。我认为在这种情况下你会想要 SSE。它们通常是比并行化更好的第一步，因为它们更容易正确并且为大多数线性代数类型的运算提供了相当大的推动力。

一旦你使用 SIMD 得到它，然后考虑并行化。听起来你也在猛烈撞击 CPU，所以你也许可以做一些睡眠而不是忙等待，并确保你正在清理或正确重用线程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-07T17:14:13.160

由于没有 BSOD 错误代码（用于查找），因此很难帮助您解决这个问题。

您可以尝试重新安装内存（（取出并放入）。我和我认识的其他一些人已经在一些需要它的机器上工作过。例如，我曾经尝试在机器上升级 OS X 并且它一直在崩溃...最后我弹出内存并将其放回原处，一切都很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-07T22:43:22.883

睡眠（1）；将 CPU 使用率减半。我在使用 CPU 密集型算法时遇到了同样的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-16T19:19:19.160

如果您的处理器有两个或更多内核，您可以转到任务管理器并转到进程并右键单击程序名称，然后单击`Set affinity`并将程序设置为使用更少的内核。

然后，执行您要求的操作将花费更长的时间，但会导致 CPU 使用率显着下降。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-07T12:44:07.817

我认为当内核内存区域损坏时会导致蓝屏死机。所以使用多线程来执行并行操作不可能是这个原因。

好吧，如果您要创建多个线程，每个线程都进行繁重的浮点运算，那么您的 CPU 利用率肯定会达到 100%。

如果您可以在每个线程中给予一些睡眠，以便其他进程获得一些机会，那就更好了。您也可以尝试降低线程的优先级。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-03-07T17:09:28.163

如果在 Windows 平台上，在一些工作之后调用一个函数来通知 CPU 你想让 cpu 给其他进程。像这样调用 sleep 函数：

[睡眠（0）；](http://msdn.microsoft.com/en-us/library/ms686298(VS.85).aspx)

# c# - 选择 IEnumerable 的下 N 个元素

> ID：621777
> 
> 赞同：4
> 
> 时间：2009-03-07T12:33:33.723
> 
> 标签：c#, extension-methods

假设您有一些称为 S 的长度为 N 的 IEnumerable。我想从 S 中选择所有长度为 n <= N 的连续子序列。

如果 S 是，比如说，一个字符串，这会很容易。有 (S.Length - n + 1) 个长度为 n 的子序列。例如，“abcdefg”的长度为 (7)，这意味着它有 (5) 个长度为 (3) 的子字符串：“abc”、“bcd”、“cde”、“def”、“efg”。

但是 S 可以是任何 IEnumerable，所以这条路线是不开放的。如何使用扩展方法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T12:47:14.317

F# 为此提供了一个名为 Seq.windowed 的库函数。

[http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/FSharp.Core/Microsoft.FSharp.Collections.Seq.html](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/FSharp.Core/Microsoft.FSharp.Collections.Seq.html)

```
// windowed : int -> seq<'a> -> seq<array<'a>>
let windowed n (s: seq<_>) =    
    if n <= 0 then Helpers.invalid_arg2 "n" "the window size must be positive"
    { let arr = Array.zero_create n 
      let r = ref (n-1)
      let i = ref 0 
      use e = s.GetEnumerator() 
      while e.MoveNext() do 
          do arr.[!i] <- e.Current
          do i := (!i + 1) % n 
          if !r = 0 then 
              yield Array.init n (fun j -> arr.[(!i+j) % n])
          else 
              do r := (!r - 1) } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T12:44:19.673

实际上，您可以使用 LINQ 来解决这个问题，例如

```
var subList = list.Skip(x).Take(y); 
```

其中列表是`IEnumerable`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T12:57:03.263

您可以使用提供索引的 Select 扩展来创建包含索引和值的对象，然后将索引与长度分开以将它们分组：

```
var x = values.Select((n, i) => new { Index = i, Value = n }).GroupBy(a => a.Index / 3); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-18T18:07:38.717

```
IEnumerable<IEnumerable<T>> ContiguousSubseqences<T>(this IEnumerable<T> seq, Func<T,bool> constraint)
{
    int i = 0;
    foreach (T t in seq)
    {
        if (constraint(t))
            yield return seq.Skip(i).TakeWhile(constraint);
        i++;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T18:30:51.283

这是一个新的扩展方法，可以在 C# 中做你想做的事

```
static IEnumerable<IEnumerable<T>> Subseqs<T>(this IEnumerable<T> xs, int n) 
{
  var cnt = xs.Count() - n;  
  Enumerable.Range(0, cnt < 0 ? 0 : cnt).Select(i => xs.Skip(i).Take(n));
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-05T19:14:11.227

对于未来的读者。

这是一个小例子。

```
 private static void RunTakeSkipExample()
    {
        int takeSize = 10; /* set takeSize to 10 */

        /* create 25 exceptions, so 25 / 10 .. means 3 "takes" with sizes of 10, 10 and 5 */
        ICollection<ArithmeticException> allArithExceptions = new List<ArithmeticException>();
        for (int i = 1; i <= 25; i++)
        {
            allArithExceptions.Add(new ArithmeticException(Convert.ToString(i)));
        }

        int counter = 0;
        IEnumerable<ArithmeticException> currentTakeArithExceptions = allArithExceptions.Skip(0).Take(takeSize);
        while (currentTakeArithExceptions.Any())
        {
            Console.WriteLine("Taking!  TakeSize={0}. Counter={1}. Count={2}.", takeSize, (counter + 1), currentTakeArithExceptions.Count());

            foreach (ArithmeticException ae in currentTakeArithExceptions)
            {
                Console.WriteLine(ae.Message);
            }

            currentTakeArithExceptions = allArithExceptions.Skip(++counter * takeSize).Take(takeSize);
        }

    } 
```

输出：

```
Taking!  TakeSize=10\. Counter=1\. Count=10.
1
2
3
4
5
6
7
8
9
10
Taking!  TakeSize=10\. Counter=2\. Count=10.
11
12
13
14
15
16
17
18
19
20
Taking!  TakeSize=10\. Counter=3\. Count=5.
21
22
23
24
25 
```

您可以通过 .Message 看到每个异常，以验证每个不同的异常是否被“采取”。

现在，电影报价！

> 但我确实拥有一套非常特殊的技能；我在很长的职业生涯中获得的技能。让我成为像你这样的人的噩梦的技能。

# c# - 在公共程序集中使用 DTO 而不是对实体的共享引用是否有好处？

> ID：621788
> 
> 赞同：11
> 
> 时间：2009-03-07T12:44:10.390
> 
> 标签：c#, architecture

我正在努力为一个让我发疯了很长时间的问题找到一个明确的最终答案。

通常表示 BLL 应包含业务逻辑和业务对象 (BO)，并具有对 DAL 的引用。另一方面，DAL 不能引用 BLL，因此它不能接受 BO 作为参数，或者将 BO 作为返回值返回。

这个问题最传统的答案是：

a) 接受简单参数，并返回（最好是 Typed）DataSets 和 DataTables 以返回数据： namespace DAL { public class Contacts public DataTable GetContacts(){...} public UpdateContacts (DataTable contacts) {...}

b) 第二个最推荐的解决方案是定义临时的、可序列化的数据传输对象 (DTO)（有时称为值对象 (VO)），它只有字段和属性，没有方法，仅用于短暂传输数据备份到 BLL 层，在那里用于填充新的 BO，然后将它们丢弃。

c) 使用一个通用的第三个程序集（例如，称为 Entities.dll），它定义了 BO，并被所有 3 层引用：UI、BLL 和 DAL。

选项 a) 需要最少的工作来实现（无需构建另一个程序集），因此为什么经常提出，但 DataTables 有额外的布线，不需要仅用于简单的操作。

然而，目前还不清楚 b) 或 c) 中的哪一个更好......

我看到 b) 有时提供，但几乎从不提供 c)，尽管 c) 似乎是两者中最简单的。

我错过了什么？为什么 c) 很少提供，即使它在逻辑上看起来是最简单的，为什么 a) 在它显然不适合所有场景（例如返回单个对象）时提供？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T13:23:13.230

好吧，我几乎看不到（b）在实践中被使用。我大部分时间都使用 (c) 中描述的方法（其他时候是我什至没有在 BLL/DAL 之间分离或根本没有域模型）。毕竟，业务和数据组件通常在物理上位于同一位置，因此两者共享 BO 很简单。事实上，像 Hibernate、Entity Framework、Linq2Sql 等框架实际上鼓励 (c) 通过允许对复杂的域模型执行 ORM。

DTO 更通常用于将数据从 BLL 传递到 UI，尤其是。当 UI 和 BLL 部署在不同的服务器中时。在这种情况下，UI 可能需要域模型的简化视图，以减少跨进程往返并最大限度地减少更改的影响（当域模型更改时）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T08:19:16.947

原始问题的附录：

我认为（在 Buu Nguyen 的第一次响应之后，以下参考模式是完全可以接受的，甚至可能建议使用 LINQ 等：

```
BLL > 

 v    Business Entities Layer (BEL)

DAL > 
```

除非 BLL 和 DAL 位于不同的层，并且 BLL 通过 WCF 与 DAL 通信......？在这种情况下它将不起作用（DAL 通过 WCF 返回的业务实体将被序列化，并且在 BLL 端将被反序列化为原始 BE 的*代理*......而不是映射回 BE 本身。或者是显然是错误的，当 BLL 和 DAL 处于同一层以及不同层时，上述参考模式是否有效？

附录#2：找到了一个有趣的链接，说明为什么为 BO 使用外部程序集实际上很好。[他说](http://vaultofthoughts.net/CommentView,guid,8415c0e1-c4d1-4536-a987-d98f9916b17f.aspx#commentstart)：“这违反了层应该只知道紧接在下面的层的规则，但是指示列名的数据库不是直接在 BLL 之下，而是在 DAL 之下。因此，未键入的 DataSet 不会保护您免受数据库，这就是为什么我认为他们错了。更好的解决方案是使用在单独的项目中定义的强类型对象。例如，DTO 中将有一个 Teacher 类，具有 Name 属性但没有 Grade 方法。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-08T08:42:42.180

如果（c）很常见，我不会感到惊讶。如果你的 BLL 和 UI 在不同的服务器上，如果你使用 WCF，你也可以通过网络传递实体。看看这个示例，了解如何在[此处](http://jonathanparker.com.au/files/folders/samples/entry1698.aspx)[zip] 进行实体序列化，这里是[下载页面](http://jonathanparker.com.au/files/default.aspx)的链接。这篇文章也可能有助于[使用 WCF 进行序列化](https://stackoverflow.com/questions/604974/is-it-possible-to-serialize-objects-without-a-parameterless-constructor-in-wcf)

# macos - 比较 Mac 和 Unix 手册？

> ID：621789
> 
> 赞同：1
> 
> 时间：2009-03-07T12:44:10.657
> 
> 标签：macos, unix, diff, manpage

如何列出 Mac 和 Unix 手册之间的差异？

例如，在以下命令之间

```
uniq
guniq 
```

我尝试了以下失败

```
diff (man uniq) (man guniq) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-07T12:47:58.277

那应该是

```
diff <(man uniq) <(man guniq) 
```

从评论中回答 saua 的问题：

Bash 变成`<(...)`了一个命名管道，diff 程序将其视为一个文件。据 diff 所知，它是在比较两个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T12:46:13.787

试试这个：

```
man uniq > uniq.man
man guniq > guniq.man
diff uniq.man guniq.man 
```

# .net - Stackoverflow 如何在 url 中转义标签名称

> ID：621794
> 
> 赞同：2
> 
> 时间：2009-03-07T12:47:01.587
> 
> 标签：.net, url

我想从标签名称生成一个 url。

在我看来（asp.net mvc）我有以下内容：

```
<%= Html.ActionLink(Html.Encode(tagName), 
"tagged" //action, 
"posts" //controller, 
new {tagName=Html.UrlEncode(tagName)} //querystring argument, 
new {@class="tag"} //html attributes) 
%> 
```

但是，如果 tagName 是“c#”（不带引号），则会生成以下 URL：

```
http://localhost/posts/tagged/c%2523 
```

这导致 Http 400 错误 - 错误请求

在 Stackoverflow 上，相同“c#”标签的 url 生成“c%23”而不是“c%2523”

我尝试了 Html.UrlEncode、Uri.EscapeDataString、Uri.EscapeUrlString，但这些都没有产生理想的“c%23”格式。

那么我应该如何编码锚的 tagName 呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T12:50:56.037

似乎您正在对 URL 进行两次编码，因为 c%2523 是 c%23 的编码值。（0x23 = ASCII 35 = #，0x25 = ASCII 37 = %）。由于您有两个编码调用（Html.Encode 和 Html.UrlEncode），因此删除其中一个可能会解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T12:51:47.893

# 对应于十六进制的 ascii 值 23。所以我猜他们使用十六进制值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T13:09:29.177

如果我正确调用，那么 actionlink 会自动对 url 上的值进行编码，所以只需删除 Html.Encode(tagName)，它应该看起来不错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T13:12:35.987

```
<%= Html.ActionLink(Html.Encode(tagName), 
"tagged" //action,  
"posts" //controller, 
new {tagName=Html.UrlEncode(tagName)} //querystring argument, 
new {@class="tag"} //html attributes) 
%> 
```

Html.ActionLink 创建 HTML 并为您处理转义问题。您不应显式 Html.Encode 链接文本或 Html.UrlEncode 参数。

如果参数值中的“#”没有被转义，这听起来像是 ActionLink() 中的错误，您可能必须自己生成链接。

# oop - 构造函数中的业务逻辑是个好主意吗？

> ID：621800
> 
> 赞同：24
> 
> 时间：2009-03-07T12:51:44.880
> 
> 标签：oop

我目前正在重建一个专门的工单系统（主要用于支持有遥感硬件故障的人......）。无论如何，我想知道在对象的构造函数中执行大量工作流类型活动是否是个好主意。

例如，目前有这样的：

```
$ticket = new SupportTicket(
    $customer,
    $title,
    $start_ticket_now,
    $mail_customer
); 
```

一旦对象被创建，它就会在数据库中放入一行，去给客户发一封确认电子邮件，可能会向最近的技术人员发送一条短信，等等。

构造函数应该启动所有这些工作，还是更像下面的东西？

```
$ticket = new SupportTicket($customer, $title);
$customer->confirmTicketMailed($ticket);
$helpdesk->alertNewTicket($ticket); 
```

如果有帮助，这些对象都基于 ActiveRecord 样式。

我想这可能是一个意见问题，但你认为最好的做法是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-07T16:51:43.433

如果构造函数完成了所有这些工作，那么构造函数就知道许多其他域对象。这会产生依赖性问题。真的应该`ticket`知道`Customer`和`HelpDesk`吗？当添加新功能时，是否有可能将新的领域对象添加到工作流中，这是否意味着我们的穷人`ticket`将不得不了解不断增加的领域对象数量？

像这样的依赖蜘蛛网的问题在于，对任何一个域对象的源代码更改都会对我们可怜的`ticket`. `ticket`遗嘱对系统有如此*多的*了解，无论发生什么，`ticket`遗嘱都会参与其中。您会发现在构造函数中聚集了令人讨厌的`if`语句，检查配置数据库、会话状态以及许多其他事情。`ticket`意志成长为神级。

我不喜欢构造函数的另一个原因是它使它们周围的对象很难测试。我喜欢写很多模拟对象。当我针对 编写一个测试时，`customer`我想通过一个 mocked out `ticket`。如果构造函数`ticket`控制工作流，以及与其他域对象之间的舞蹈`customer`，那么我不太可能模拟它来测试`customer`.

我建议你阅读[SOLID 原则](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)，这是我几年前写的一篇关于管理面向对象设计中的依赖关系的论文。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-07T13:07:00.820

把事情分开。真的，您不希望票证知道它应该如何发送电子邮件等。这是类服务的工作。

[更新] 我不认为建议的工厂模式对此有好处。如果您想创建票证的不同实现而不将此逻辑放入票证本身（例如通过重载的构造函数），则工厂很有用。

看看领域驱动设计中提出的服务概念。

> **服务**：当操作在概念上不属于任何对象时。遵循问题的自然轮廓，您可以在服务中实现这些操作。服务概念在 GRASP 中称为“Pure Fabrication”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-07T13:45:12.583

从 OO 设计的角度来看，问题不在于该功能是否应该在构造函数中实现（而不是在该类的其他方法中实现），而是 SupportTicket 类是否应该知道如何做所有这些事情。

简而言之，SupportTicket 类应该建模一个支持票，并且只是一个支持票。创建电子邮件、知道如何将该电子邮件发送给客户、排队处理工单等都是您应该从 SupportTicket 类移出并封装到其他地方的功能块。这样做的好处包括更低的耦合性、更高的内聚性和更高的可测试性。

看看[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle "单一职责原则")，它解释了这样做的好处。特别是，[这个](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)博客是阅读 SRP 和其他良好 OO 设计的关键原则的好地方。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-08T19:56:59.080

最简洁的答案是不。

在硬件设计中，我们曾经有过这样的说法，“不要在时钟或复位线上设置门——它会混淆逻辑。” 出于同样的原因，这同样适用于此。

更长的答案将不得不等待，但请参阅“ [Screetchingly](http://alistair.cockburn.us/Screechingly+obvious+code) [Obvious Code](http://wiki.c2.com/?ScreechinglyObviousCode) ”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T01:29:31.527

实际上，我从未对任何可用的答案感到满意，但让我们看看它们。选择围绕两个评估问题建立：

**E1。**业务逻辑的知识属于哪里？

**E2。**代码的下一个读者会在哪里看？（[非常明显的代码](http://wiki.c2.com/?ScreechinglyObviousCode)）

一些选择：

*   在**客户端代码**中（执行“新 SupportTicket”的对象）。显然，它可能不/不应该知道业务逻辑，否则您不会想要创建那个花哨的构造函数。如果它是业务逻辑的正确位置，那么它应该说：

    ```
    $ticket = new SupportTicket($customer, $title);

    handleNewSupportTicket($ticket, ...other parameters...) 
    ```

    其中，为了保护 E2，“handlenewSupportTicket”是定义业务逻辑的地方（下一个程序员可以很容易地找到它）。

*   在**支持工单**对象中，作为单独的业务调用。就我个人而言，我对此并不满意，因为这是来自客户端代码的两次调用，其中思想是一回事。

    ```
    $ticket = new SupportTicket($customer, $title);

    $ticket -> handleNewSupportTicket(...other parameters...) 
    ```

*   在**类支持票**。这里预计业务逻辑位于 Support Ticket 区域，但由于新的 Support Ticket 绝对需要立即处理而不是稍后处理，所以这个重要的任务不能留给任何人的想象或错误输入，即具体不要交给客户端代码。我只知道如何在[Smalltalk](http://en.wikipedia.org/wiki/Smalltalk)中编写类方法，但我将尝试使用伪代码：

    ```
    $ticket = SupportTicket.createAndHandleNewSupportTicket(...other parameters...) 
    ```

    假设客户端代码需要新票的句柄用于其他目的（否则“$ticket =”将消失）。

    我不太喜欢这个，因为其他程序员并不觉得在类或静态方法中寻找业务逻辑很自然。但这是第三种选择。

*   唯一的第四个选择是如果业务逻辑愉快地驻留在另一个地方并且其他程序员自然会寻找它，在这种情况下它会进入那里的类/静态函数。

    ```
    $ticket = SupportTicketBusinessLogic.createAndHandleNewSupportTicket(...other params...) 
    ```

    该类/静态函数执行所需的多个调用。（但现在我们再次有可能构造票证但不能正确处理:(。

# python - 选择和部署彗星服务器

> ID：621802
> 
> 赞同：13
> 
> 时间：2009-03-07T12:51:53.837
> 
> 标签：python, django, comet, daemon

我想通过 HTTP 将数据推送到浏览器而不杀死我的 django/python 应用程序。

我决定使用彗星服务器来代理我的应用程序和客户端之间的请求（尽管我还没有真正弄清楚）。

我研究了以下引擎：轨道彗星 ejabberd 码头

有没有人有使用这些服务器和部署它们的经验？关于这些主题的任何见解和链接都会很棒。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-07T21:06:49.513

我建议研究一下 Twisted，他们的 twisted.web 服务器，以及在 Divmod 上完成的彗星工作。与传统的基于线程或进程的服务器相比，它们可以处理更多的并发连接，这正是您对此类事物所需要的。而且，是的，我已经使用 Twisted 构建了用于 COMET 的系统，同时将其他东西用于更前端的 Web 应用程序。每个部分都做它最擅长的事情，效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T15:44:34.840

我需要做一些非常相似的事情。我找到了这个，但还没有时间正确查看它：

> django_evserver 是 Django 应用程序的简单 http 服务器。它基于 libevent 库。django_evserver 的主要优点是它提供了抢占 django 视图的方法。您可以在几个块中渲染一个站点，每个块都可以由不同的 django 视图处理。
> 
> 使用这个想法，可以使用 django_evserver 作为 django 应用程序的彗星服务器。

[http://code.google.com/p/django-evserver/](http://code.google.com/p/django-evserver/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-21T15:09:20.480

如果您可以运行 Java，我会推荐[StreamHub Comet Server](http://www.stream-hub.com/)。

首先，考虑到您不需要“杀死”现有应用程序，JavaScript 包含的占用空间非常低，不到 10K。我用它来推送用户更新和在我正在构建的社交网站上聊天。我每天进行 1000 次以上的测试，对 CPU 没有明显影响。

其次，在部署时，我遵循了一些示例，并且与使用 CometD 将我的头撞到墙上相比，我的启动和运行速度非常快。如果您遇到任何问题，这里有一个很好的[Comet Hello World](http://streamhub.blogspot.com/2009/07/getting-started-with-streamhub-and.html)入门指南和一个[Google 群组。](http://groups.google.co.uk/group/streamhub-comet-server-community)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-22T19:14:58.893

一种选择是 Netty，它是基于 JBoss 的 Java NIO 的客户端-服务器套接字框架。有关比较和讨论，[请参见此处](http://amix.dk/blog/viewEntry/19456)。据报道，它在四核服务器上同时处理 100000 个打开的连接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-06T17:59:01.240

如果您正在运行 IIS，您可以查看 WebSync ( [http://www.frozenmountain.com/websync](http://www.frozenmountain.com/websync) )，这是一个符合标准的 (bayeux) comet 服务器和 .NET/IIS 客户端。如果您不想要额外的负载，按需版本是一个 SaaS 选项，可以减轻繁重的工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-30T07:45:54.340

如果您希望将 Django 与 Comet 服务器（Orbited）结合起来，请查看这个项目，我将在此处尽可能地将 Django 和 Orbited 集成为“干净”和“真实世界”：http: [//github.com/克莱梅沙/热点](http://github.com/clemesha/hotdot)

该项目解决了“现实世界”问题，例如安全性和记录/过滤/修改在途 Comet 消息等 - 但仍在进行中。

# encoding - Vimdiff 中的编码问题？

> ID：621805
> 
> 赞同：0
> 
> 时间：2009-03-07T12:58:42.570
> 
> 标签：encoding, vimdiff

如何解决以下编码问题？ [http://dl.getdropbox.com/u/175564/encoding.png](http://dl.getdropbox.com/u/175564/encoding.png)

比较手册是相当困难的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T13:12:42.350

尝试

```
vim -d <(man uniq |col -b) <(man guniq |col -b) 
```

# sharepoint - SharePoint：看不到任何筛选器 Web 部件

> ID：621809
> 
> 赞同：2
> 
> 时间：2009-03-07T13:03:14.260
> 
> 标签：sharepoint, sharepoint-2007, web-parts

在 Office 2007 官方站点中，有很多关于筛选 Web 部件的参考。当我尝试添加其中之一时，Sharepoint 中的 Web 部件列表不显示任何筛选器 Web 部件。

如果有人遇到相同的问题和任何解决方案，请发布。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-29T23:28:04.547

在 MOSS 中激活 Office SharePoint Server Enterprise 网站集功能功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T09:01:55.043

因此，如果您现在使用的是 WSS 3.0 而不是 MOSS 2007，那么您现在知道为什么没有任何过滤器 webpart；要解决此问题，您可以安装一些免费提供的过滤器 Web 部件：尝试[SharePoint 的下拉过滤器 Web 部件](http://dropdownsharepoint.codeplex.com/)或[e-office 的列表项过滤器 Web 部件](http://eoffice.codeplex.com/Wiki/View.aspx?title=List%20Item%20Filter%20webpart&referringTitle=Home)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T23:35:47.003

正如 Nico 所说，他们属于 MOSS Enterprise。它们可以通过单击 Web 部件库中的新按钮并选择正确的类来添加，或者通过从 %CommonProgramFiles%\Microsoft Shared\web server extensions\12\TEMPLATE\FEATURES\BizAppsSiteTemplates\dwp 上传 WebPart 定义文件来添加.

我不知道这是否违反许可协议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T15:08:53.257

也许您使用的是 wss 3.0（Windows SharePoint 服务）而不是 MOSS 2007？wss 没有过滤器 Web 部件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T16:41:55.327

预配置过滤器 webpart 仅在 MOSS Enterprise 中可用。
但是，您可以创建自己的框架，框架就在那里（实际上您可以将它们导入 MOSS Std 并且它会工作）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T13:47:42.250

我们使用的是 MOSS 2007，但必须按照 JMDs 指令手动加载它们。

感谢大家。

这是非常有价值的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-16T00:38:00.413

您可以在站点设置中看到所有可用的 webparts --> webparts --> 如果您在那里没有看到它们，请单击 NEW

# c# - 删除列表中的备用元素

> ID：621813
> 
> 赞同：18
> 
> 时间：2009-03-07T13:05:27.500
> 
> 标签：c#, generics, collections

`List<T>`在不使用占位符列表变量的情况下删除备用（奇数索引甚至索引）元素的最有效方法是什么？

如果您能在每个答案中提及成本，我们将不胜感激。

我正在寻找一种**有效**的方法来做到这一点

提前致谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-07T13:22:26.400

如果您为删除的每个项目调用 RemoveAt，您将移动大量数据。最有效的方法是将要保留的项目一起移动，然后在最后删除未使用的项目：

```
int pos = 0;
for (int i = 0; i < values.Count; i += 2, pos++) {
    values[pos] = values[i];
}
values.RemoveRange(pos, values.Count - pos); 
```

编辑：
此方法将在 15 毫秒内处理一百万个整数的列表。使用 RemoveAt 将需要三分钟以上...

Edit2：
您实际上可以从 pos=1 和 i=2（或 3）开始，因为不必将第一项复制到自身。不过，这使得代码不太明显。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-07T13:22:41.623

只是为了考虑创建新列表的解决方案，使用*旧*列表，您可以这样做：

```
var newList = old.Where((_, i) => i%2 != 0).ToList(); 
```

或者，显然

```
var newList = l.Where((_, i) => i%2 == 0).ToList(); 
```

取决于您选择的替代方案。

**编辑**

答案要快一些。如果你在这里读到别的东西，那是因为我是在周末测量的，而周末的大脑很有趣。:( 关闭解决方案大约快 40%，而答案是应用程序。快 2 个数量级。我想这真的取决于你的列表有多大！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-07T15:34:15.210

还有另一种选择，类似于 Frank 的选择，但使用了闭包。它比弗兰克的版本更快。

```
bool isEven = true;            
var newList = list.Where(x => isEven = !isEven).ToList(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T13:16:09.817

我不确定您所说的备用是什么意思，但如果您的意思是“所有其他项目”，则以下代码将起作用。它将首先删除第二个元素，然后是第四个，依此类推

```
List<T> list = GetTheList();
int i = 1;
while ( i < list.Count ) {
  list.RemoveAt(i);
  i++;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-07T16:47:51.773

通往涅槃的道路是由延迟执行铺就的。或者其他的东西。

```
 public static IEnumerable<T> AlternateItems<T>(this IEnumerable<T> source)
    {
        while (source.Any())
        {
            yield return source.First();

            source = source.Skip(1);

            if (source.Any()) source = source.Skip(1);                
        }
    } 
```

这适用于所有序列，而不仅仅是`IList<>`. 迭代的成本被推迟到迭代，如果最终您不需要触及列表中的所有元素，这可能是一个巨大的胜利。

在我的简单测试中，迭代整个列表时的性能不是很好，所以一定要分析你的真实情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-07T15:41:08.093

```
for (int i=myList.length-1; i >= 0; i--)
  if (i % 2 == 0)
    myList.Remove(myList[i]); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-07T16:29:27.650

显然取决于使用情况，但您可以有一个包装器 IList 将您给它的索引乘以 2，并报告列表的长度为 1/2（省略了详细信息）。这是 O(1)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-07T16:07:22.057

我会使用通常用于 STL 容器的标准模式。执行删除然后擦除。

这样你就不会混淆习惯于看到这种模式的人。

```
template<typename T>
struct RemoveEven
{
    RemoveEven():count(0)   {}
    bool operator()(T const&)
    {
        bool    result  =  count%2 == 0;
        count++;
        return result;
    }
    private:
        std::size_t count;
};
int main()
{
    std::list<int>  a;
    a.erase(std::remove_if(a.begin(),a.end(),RemoveEven<int>()),a.end());

} 
```

# apache - 多个域到一个虚拟主机 | 通配符主机（共享主机）？

> ID：621819
> 
> 赞同：4
> 
> 时间：2009-03-07T13:08:51.847
> 
> 标签：apache, web, hosting, dns

我有以下任务：创建一个可以使用 20 个不同域名访问的网站。

相同的文件，相同的文件夹，相同的IP。

**问题（共享主机）：** 这可以通过指向同一个公共子域的裸 cname 来完成，还是我们需要一个静态 IP？

问题肯定是共享主机，我试图避免一一手动创建“cpanel插件域”。共享主机不允许修改 httpd conf，它允许我为 IP 创建通配符虚拟主机。

我想我的问题是自动回答的；我需要一个静态的，除非我只使用子域的 w 通配符，它​​适用于共享主机。"*.domain.com", "two.domain.com", "three.domain.com" => 目录/

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-07T13:14:00.833

我认为您已经回答了自己的问题，您可以选择的选项是

*   通过任何可用的方式将 ServerAlias 条目添加到 vhost 配置中
*   确保目标 IP 上的默认虚拟主机是处理您的站点的主机

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T19:55:16.890

1.  如果您使用 CNAME（或者实际上是指向同一 IP 地址的 A 记录），那么正如 Paul 所说，您必须在 中具有`ServerAlias`条目`httpd.conf`，或者将它们指向`default`虚拟主机

2.  如果您不能这样做，请在其他 Web 主机上托管 19 个域名，然后使用 HTTP 重定向让用户访问“首选”域名。但是，如果您这样做，那么用户地址栏中的域名将发生变化。

# macos - Bash 的 command_not_found_handle() 问题

> ID：621821
> 
> 赞同：2
> 
> 时间：2009-03-07T13:10:08.520
> 
> 标签：macos, bash

我通过以下命令在 Mac 中收到“找不到命令”错误

```
md5sum *.java | uniq -d -w32 
```

原因是 Mac 默认没有 -w 选项。

当错误发生时，我想让 Bash 执行以下操作

1.  将 g 放在第一个命令的开头
2.  将 g 放在 | 之后的命令的开头

如何使错误更有用？

**[编辑]**

问题：如果 Mac 没有该功能，我想使用 coreutils 中的功能。因此，Mac 的命令前面的 g。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T16:47:54.237

**您不能使用`command_not_found_handle()`**，因为命令*确实*存在；`$? != 0`由于无法识别的参数，它们只是返回一个错误（ ）。

在这些情况下，您应该在脚本的最开始明确控制使用**特定于平台的序言**发出的命令，对参数做出最少数量的假设，例如：

```
# defaults - satisfies most platforms
MD5SUM=md5sum
UNIQ=uniq
# per-platform exceptions
if [ "$OS" == "MacOS" ] ; then
  # use GNU variants by prefixing with g
  MD5SUM="g $MD5SUM"  # or use the native program, MD5SUM=md5
  UNIQ="g $UNIQ"      # or use the native program, UNIQ=uniq
elif [ "$OS" == "SomeOtherOS" ] ; then
  MD5SUM=md5hash # e.g. this platform computes MD5 sums with md5hash
fi
...
# optionally cross-check for GNU variants on all platforms
#  does uniq support -w32? (no error on dry run?) if so, use it!
$UNIQ -w32 /dev/null 2>/dev/null && UNIQ="$UNIQ -w32"
# optionally perform one last validation before proceeding
die() { echo "FATAL: $*" >&2 ; exit $1 ; }
$UNIQ /dev/null >/dev/null   || die $? "uniq is missing or failing: $UNIQ"
$MD5SUM /dev/null >/dev/null || die $? "md5sum is missing or failing: $MD5SUM"
...
$MD5SUM *.java | $UNIQ -d 
```

* * *

**更新**

请注意，这也是一种很好的做法，特别是如果您的脚本将作为 运行`root`，*而不*依赖于`$PATH`- 您可能希望为诸如或以上的程序指定完全限定的位置`uniq`，`md5`例如`md5sum`，`UNIQ=/bin/uniq`等`MD5SUM=/sbin/md5sum`）

* * *

**更新2**

自动在一堆命令前加上“g”：

```
eval `for command in uniq md5sum grep sed ; do
  echo \`echo \$command | tr '[a-z]' '[A-Z]'\`=\"g \$command\"
done` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T16:47:41.600

在 Mac OS X 上工作：

/sbin/md5 *.java | 唯一的-d

对于 gnu uniq，请参见：

[http://rudix.org/#coreutils](http://rudix.org/#coreutils)

# ruby - 识别运行缓慢的测试

> ID：621822
> 
> 赞同：1
> 
> 时间：2009-03-07T13:10:32.217
> 
> 标签：ruby, unit-testing, testunit

在 ruby​​ 的测试/单元中，软件指示测试运行需要多长时间，以及一系列通过、错误和失败的行为就像一个伪进度条。

除了使用代码分析工具或单独运行测试之外，是否有一种简单的方法可以判断哪些测试方法快哪些慢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T16:58:40.810

当我需要在大型测试套件中执行此操作时，我会覆盖 Test::Unit::TestCase 设置和拆卸。它没有给出精确的测量值，但它可以帮助评估相对速度。

```
module Test
  module Unit
    def setup
      @start_time = Time.now
    end

    def teardown
      puts "#{@method_name}: #{Time.now - @start_time}s"
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:48:32.953

根据莎拉的回答，我更喜欢另一种解决方案：

像 Sarah 写的那样设置，但是 Teardown 应该在列表中添加测试名称和执行时间。
所以你可以评估这个列表，进行排序或其他什么。我不了解Ruby，所以我不知道它是否会起作用。

这是JUnit的一些Java代码来解释我的想法......

```
public class ExecutionTimeTest {

  public static ArrayList<Double> executionTimes;

  public double start;

  @BeforeClass
  public static void initializeList() {
    executionTimes = new ArrayList<Double>();
  }

  @AfterClass
  public static void printExecutionTimes() {
    int i = 1;
    for (Double time : executionTimes) {
      System.out.println("Test " + (i++) + ": " + time);
    }
  }

  @Before
  public void startExecutionTime() {
    start = System.currentTimeMillis();
  }

  @After
  public void calculateExecutionTime() {
    executionTimes.add(System.currentTimeMillis() - start);
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-16T21:29:02.763

如果您使用的是 test-unit gem，以详细模式运行测试将为您提供有关每个测试花费多长时间的信息：

```
ruby test/test_unit.rb --verbose
Loaded suite test/test_unit
Started
ChaserTestCase: 
  test_handle_funny_characters_in_class_method_names:   .: (0.000645)
  test_handle_funny_characters_in_instance_method_names:.: (0.000523)
  test_modify_and_unmodify_class_method:                .: (0.000534)
...
Finished in 0.019894 seconds. 
```

MiniTest[也](http://lists.zenspider.com/pipermail/ruby/2010-October/005343.html)将进行基准测试。

# java - 如何在 Java 中提取此图像的一部分？

> ID：621835
> 
> 赞同：37
> 
> 时间：2009-03-07T13:22:03.047
> 
> 标签：java, 2d, sprite, 2d-games

我有这个精灵表：

[![吃豆子精灵](https://i.stack.imgur.com/cRVCj.png)](https://i.stack.imgur.com/cRVCj.png)

如何读取此图像文件以提取其中的一部分用作[精灵](http://en.wikipedia.org/wiki/Sprite_%28computer_graphics%29)？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-07T13:38:31.040

如果 sprite 区域读入 a [`BufferedImage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html)，则该[`getSubimage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html#getSubimage(int,%20int,%20int,%20int))方法可用于获取 sprite sheet 的子图像。

该`getSubimage`方法将获取所需子图像的`x`、`y`和`width`和`height`，因此可以获得所需的精灵。由于大多数精灵似乎大小相同，我认为它们中的大多数可以通过嵌套`for`循环检索以遍历大图像。

例如，如果使用[`ImageIO`](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)类（例如[`read`](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html#read(java.io.File))方法）加载精灵图像，并且每个精灵的大小为10像素×10像素，其中是5行5列的精灵，则可以通过以下方式获得精灵：

```
BufferedImage bigImg = ImageIO.read(new File("sheet.png"));
// The above line throws an checked IOException which must be caught.

final int width = 10;
final int height = 10;
final int rows = 5;
final int cols = 5;
BufferedImage[] sprites = new BufferedImage[rows * cols];

for (int i = 0; i < rows; i++)
{
    for (int j = 0; j < cols; j++)
    {
        sprites[(i * cols) + j] = bigImg.getSubimage(
            j * width,
            i * height,
            width,
            height
        );
    }
} 
```

当然，要注意的是，上述代码仅在所有精灵大小相同的情况下才有效，因此需要进行一些调整才能适用于给定的精灵表。（因为右上角的大小似乎与其他角落不同。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-07T13:56:46.613

如果您只想绘制精灵，Java 的 Graphics 类有一个[drawImage](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Graphics.html#drawImage(java.awt.Image,%20int,%20int,%20int,%20int,%20int,%20int,%20int,%20int,%20java.awt.image.ImageObserver))方法，该方法将为您拉出图像的特定区域。您只需要指定源图像，要在 Graphics 对象上绘制精灵的位置（x，y，宽度，高度），以及精灵位于图像的哪个帧（x，y，宽度，高度） .

假设精灵的宽度和高度与您要在绘图区域上绘制的宽度和高度相同，您可以定义自己的方法来绘制精灵帧，如下所示

```
void drawSpriteFrame(Image source, Graphics2D g2d, int x, int y,
                     int columns, int frame, int width, int height)
{
    int frameX = (frame % columns) * width;
    int frameY = (frame / columns) * height;
    g2d.drawImage(source, x, y, x+width, y+height,
                  frameX, frameY, frameX+width, frameY+height, this);
} 
```

`columns`是您的精灵表中有多少列。该方法的前两行计算工作表中精灵帧的 x any y 位置。

工作表中的那些大精灵需要特殊处理。您可以用瓷砖绘制它们（因此在这种情况下，您将为每个大图像绘制四个精灵），或者您可以手动确定用于这些精灵的 x、y、宽度和高度。

如果您的 sprite 表是常规表（所有 sprite 大小相同）并且按照 5 x 15 的模式排列，您将使用以下方法调用绘制第 20 帧

```
Toolkit tk = Toolkit.getDefaultToolkit();    
Image pacman = tk.getImage(getURL("pacman.png"));
...
drawFrame(pacman, g2d, x, y, 15, 19, 25, 25); 
```

这里，x 和 y 是要在 Graphics 对象上绘制精灵的位置，15 是精灵表中的列数，19 是框架（编号从 0 开始），25 是每个的宽度和高度精灵（我近似）。

# c# - 简单的数据绑定问题

> ID：621840
> 
> 赞同：1
> 
> 时间：2009-03-07T13:25:52.850
> 
> 标签：c#, wpf, data-binding

我不知道这个简单的绑定有什么问题。单击第一个或第二个单选按钮时，不显示名字或姓氏。

1）Xaml

```
<Window x:Class="WpfApplication2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication2"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <local:Person x:Key="personInfo"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal">
        <RadioButton Name="r1" Click="onClick1">1st person</RadioButton>
        <RadioButton Name="r2" Click="onClick2">2nd person</RadioButton>   
        </StackPanel>
        <StackPanel Grid.Row="1" Orientation="Horizontal">
            <TextBlock Name="t1">First Name</TextBlock>                
            <TextBox Name="fn" Text="{Binding Path=FirstName}"/>

            <TextBlock Name="t2">Last Name</TextBlock>
            <TextBox Name="ln" Text="{Binding Path=LastName}"/>
        </StackPanel>
    </Grid>
</Window> 
```

2) 代码隐藏

```
public partial class Window1 : Window
    {
        Person p = new Person();
        Person[] list ;
        public Window1()
        {
            InitializeComponent();

            list = new Person[2] { new Person { FirstName = "John", LastName = "Smith"},
                                   new Person { FirstName = "Steve", LastName = "King"} };
        }

        public void onClick1(Object h , RoutedEventArgs arg)
        {
            p.FirstName = list[0].FirstName;
            p.LastName = list[0].LastName;
        }

        public void onClick2(Object h, RoutedEventArgs arg)
        {
            p = list[1];

        }
    } 
```

3) 个人.cs

```
class Person : INotifyPropertyChanged
    {
        string firstName;
        string lastName;

        public string FirstName
        {
            get { return firstName; }
            set { firstName = value;
                  OnPropertyChanged("FirstName");
                } 
        }

        public string LastName
        {
            get { return lastName; }
            set { lastName = value;
                   OnPropertyChanged("LastName");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T13:34:14.077

您需要在代码中实际设置绑定源，为此您需要 StackPanel 的名称。您必须将名称添加到最后一个堆栈面板。第 1 行中的那个

```
<StackPanel 
  ...
  Name="m_panel" /> 
```

在事件代码中更新 DataContext

```
public void onClick1(Object h , RoutedEventArgs arg)
{
    p.FirstName = list[0].FirstName;
    p.LastName = list[0].LastName;
    m_panel.DataContext = p;
} 
```

**编辑**澄清要命名的 StackPanel

# asp.net - 多列组合框

> ID：621841
> 
> 赞同：1
> 
> 时间：2009-03-07T13:27:47.027
> 
> 标签：asp.net

有人可以推荐一个好的多列组合框控件以在 Web 窗体中使用吗？我很失望没有在 DevExpress ASPxComboBox 控件上找到任何多列支持，除非我遗漏了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T17:36:21.797

我发现探索 javascript 控件比 asp.net 控件更幸运；特别是如果“免费”是一项要求。我还没有评估这个控件，但它是用 jQuery 构建的：[http ://code.google.com/p/jquerymulticolumnselectbox/](http://code.google.com/p/jquerymulticolumnselectbox/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T13:30:43.400

我正在使用[Telerik RadComboBox 控件](http://www.telerik.com/products/aspnet-ajax/combobox.aspx)。[您可以在此处查看](http://demos.telerik.com/aspnet-ajax/combobox/examples/functionality/multicolumncombo/defaultcs.aspx)多列功能的在线演示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-08T19:25:41.243

我们使用了[本文](http://aspalliance.com/541_Multiple_Column_DropDown_Box_for_ASPNET)中的控件。不再使用它，但它是 aspalliance 文章的一部分，并附带源代码 (VB.NET)。

# asp.net-mvc - 如何显示控制器返回查看的列表？

> ID：621852
> 
> 赞同：0
> 
> 时间：2009-03-07T13:40:50.160
> 
> 标签：asp.net-mvc

我正在使用 VS 2008 MVC。

我开发了一个控制器。

表单控制器我使用 LinqToSql 获取数据。& 我正在重新调整该数据的**列表**。

例如 return View(Students.Tolist());

现在我想`foreach`在视图中使用“”循环显示列表。

那么我该如何实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T14:16:33.273

您在控制器操作中返回您的学生列表作为视图的模型，因此请确保您的视图是强类型的。你的视图应该在顶部有这个：

```
Inherits="System.Web.Mvc.ViewPage<List<Your.Namespace.Student>>" 
```

然后您可以像这样在视图中迭代该列表：

```
 <% foreach(var student in Model)
    { %>
        <div class="student">
            <%= student.Name %>
            <%= student.Age %>
        </div>

 <% } %> 
```

这是如果您使用 MVC RC 或更新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T13:46:22.193

您应该有一个`Student`类来保存 LINQ to SQL 输出的记录。在这种情况下，匿名类型不能很好地工作。

```
<% foreach (var item in (IEnumerable<Student>)ViewData.Model) { %>
      <div class="student">
          Name: <%= item.Name %>  <br />
          GPA:  <%= item.GPA %> 
      </div>
<% } %> 
```

# vba - 在 Excel 中使用 VBA 将 2 个单元格的内容合并到另一个 3rd 单元格中

> ID：621862
> 
> 赞同：4
> 
> 时间：2009-03-07T13:46:16.107
> 
> 标签：vba, excel

我有两个单元格可以说：A1 和 A2

每一个的内容都是一个字符串：

A1：你好

A2：世界

我的目标是将 A1 和 A2 的内容合并到另一个单元格中，例如 A3，即 A3 的内容应该是：

你好世界

我想使用 VBA 宏来执行此操作，而不仅仅是将字符串作为内容..

谢谢你们俩的回答！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T18:21:33.293

虽然，正如 MasterMix 所说，这很容易通过公式来实现，但如果您有理由必须使用 VBA，那么这取决于您希望如何指定单元格。

您可以将其作为函数执行：

```
私有函数 addTwoCells(rngA As Range, rngB As Range) As String
    addTwoCells = rngA & rngB
结束功能
```

所有这一切都是复制（更快）内置的 Excel 连接函数。

您也可以在一个过程中以大约一百种方式中的一种来执行此操作，这是提示用户输入范围的一种方式：

```
私有子 addTwoCellsProc()
    将 rngA 调暗为字符串
    将 rngB 调暗为字符串
    将 rngOutput 调暗为字符串
    调暗测试为范围

    做
        rngA = InputBox("请输入第一个单元格地址", "单元格A")
        rngA = Range(rngA).Cells(1, 1).Address
        设置 rngTest = Intersect(Range(rngA).Cells(1, 1), ActiveSheet.Cells)
    循环直到不是 rngTest 什么都不是

    做
        rngB = InputBox("请输入第二个单元格地址", "单元格B")
        rngB = Range(rngB).Cells(1, 1).Address
        设置 rngTest = Intersect(Range(rngB), ActiveSheet.Cells)
    循环直到不是 rngTest 什么都不是

    做
        rngOutput = InputBox("请输入目标单元格地址", "输出单元格")
        设置 rngTest = Intersect(Range(rngOutput), ActiveSheet.Cells)
    循环直到不是 rngTest 什么都不是

    范围(rngOutput) = 范围(rngA) & 范围(rngB)
结束子
```

如果您有多个要组合的范围，您还可以使用预定义的范围并循环它们。如果您对场景进行更多解释，那么有人可能会提供更具体的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T14:24:37.373

我建议使用 Excel 公式

```
=A1&A2 
```

或 VBA 宏

```
Range("A3").Cell.Value = Range("A1").Cell.Value & Range("A2").Cell.Value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-06T17:27:21.470

这个更快，只需选择单元格并将它们合并到第一个单元格中。

```
'------------------------------------------------------------------------
' Procedure : Concatenate Text
' Author    : Tim Bennett
' Date      : 11/6/2015
' Purpose   : Concatenate selected text into first column
'------------------------------------------------------------------------
'
'Sub Concatenate_Formula(bConcat As Boolean, bOptions As Boolean)
Sub Concatenate()

Dim rSelected As Range
Dim c As Range
Dim sArgs As String
Dim bCol As Boolean
Dim bRow As Boolean

    'Set variables
    Set rOutput = ActiveCell
    bCol = False
    bRow = False

    On Error Resume Next

    'Use current selection
    Set rSelected = Selection

    On Error GoTo 0

    'Only run if cells were selected and cancel button was not pressed
    If Not rSelected Is Nothing Then
        sArgs = "" 'Create string of cell values
        firstcell = ""

        For Each c In rSelected.Cells
            If firstcell = "" Then firstcell = c.Address(bRow, bCol)
            sArgs = sArgs + c.Text + " " 'build string from cell text values

            c.Value = "" ' Clear out the cells taken from
        Next

        'Put the result in the first cell
        Range(firstcell).Value = sArgs

   End If
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-06T13:09:52.293

在更一般的情况下，这是一个连接任意数量的单元格（甚至是不相邻的单元格块）的宏 注意：我没有包含检查用户取消的代码。

```
Sub G()

    Dim strFinal$
    Dim cell As Range
    Dim rngSource As Range
    Dim rngArea As Range
    Dim rngTarget As Range

    Set rngSource = Application.InputBox("Select cells to merge", Type:=8)
    Set rngTarget = Application.InputBox("Select destination cell", Type:=8)
    For Each rngArea In rngSource
        For Each cell In rngArea
            strFinal = strFinal & cell.Value & " "
        Next
    Next
    strFinal = Left$(strFinal, Len(strFinal) - 1)
    rngTarget.Value = strFinal

End Sub 
```

# visual-studio - 为什么 Visual Studio 对 C# 和 C++ 使用不同的缩进设置？

> ID：621865
> 
> 赞同：14
> 
> 时间：2009-03-07T13:49:47.240
> 
> 标签：visual-studio, indentation

对于 C#，Visual Studio 默认使用 4 个空格，而对于 C++，它是硬制表符。为什么会这样？为什么不一样？

我的项目由 C# 和 C++ 代码组成，差异真的让我很恼火。我想为所有来源设定一个通用标准，但我想知道这是否会有任何缺点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-07T14:02:00.330

如果您正在为这种差异寻找一个完全合乎逻辑、有充分理由的理由，我认为您找不到。尽管围绕制表符与空格发生了许多激烈的战争，但实际上并没有真正的赢家（否则战争就会结束）。

解决这个问题的方法是通过 .vssettings 文件。当我第一次开始使用 VS 2005 时，我将每种语言的制表符/空格设置为默认值。您可以通过工具 -> 选项 -> 文本编辑器 -> (C#/C++) 执行此操作。然后我将选项卡设置导出到 .vsssettings 文件中。每当我在新机器上安装 VS 时，我只需导入该文件，然后我就有了快乐的空间/选项卡设置。

PS：空格规则:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-06-08T11:14:15.620

当然，标签是唯一正确的方法。Tab 可以做所有空格可以做的事情。空格不能做很多选项卡可以做的事情。

选项卡允许轻松更改缩进和轻松导航，而无需按箭头键太多次，也不必保持控制。

真正的解决方案是让编辑器能够导航和制表缩进的文件，就像它是空格缩进一样，如果用户愿意的话。该文件将与选项卡一起保存。非常简单和包容每个人。

c# 2010 中的问题是我找不到将其更改为选项卡的任何选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T14:02:35.023

我怀疑是否存在任何缺点，因为 C++ 语法不区分制表符和空格。顺便说一句，我认为设置代码样式标准的最佳方法是导出 VS 设置并与团队共享。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T14:58:49.867

C#默认4个空格的原因是无论谁打开文件，缩进都是一样的。

您可以根据喜好随意更改它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-07T15:10:02.973

随心所欲，我通常在 C++ 中使用制表符。那些查看我的代码的人无论如何都使用默认的 VS 设置 RE 选项卡，因此没有真正的拉动来用空格替换它。我不确定它现在是什么样子，但是当 F# 处于起步阶段（即，MSR 的早期版本）时，您需要在#light 代码中使用空格，否则编译器会抱怨空格很重要。

不同的人有不同的偏好，我知道有些人虔诚地使用空格，另一方面我知道更多使用制表符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-07T15:04:05.233

> > 对于 C#，Visual Studio 默认使用 4 个空格，而对于 C++，它是硬制表符。为什么会这样？

为什么不？

不开心就换吧。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-03-19T15:40:38.007

空格使使用键盘浏览代码变得更加困难。

对于空格，大多数人会使用四个空格，但有些人会使用两个或三个。使用制表符，希望代码带有两个空格的人可以简单地将制表符设置为显示两个空格，并且编码风格保持一致。

如果您在任何 HTML、CSS 或 JavaScript 中为制表符使用空格，那么您做错了。html/css/js 没有制表符与空格的争论——要么是制表符，要么是无知。客户端代码未编译，并且 IIS 默认未打开压缩 - 多余的空白 = 多余的脂肪。

回到过去，VB6 没有让我们选择使用制表符，但现在我们可以而且应该 - 如果您不这样做，您的代码会让您看起来仍然在坚持老式的方式。

所以停止像 1999 年那样编码。使用标签。为孩子做。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2011-09-12T14:52:40.943

制表符与空格的争论有一个简单的答案：制表符。制表符允许您指定缩进，而不是强迫其他人接受它。鉴于标签大小只是个人喜好，一个用户不应该强迫其他人遵循他/她的显示选项。

为什么 C++ 和 C# 之间的区别：不知道。但是，知道选项卡在逻辑上是一个更好的选择，只需将 C#（实际上是所有语言）更改为选项卡，瞧。

# opengl - Ubuntu 中的 OpenGL/SDL 问题

> ID：621866
> 
> 赞同：0
> 
> 时间：2009-03-07T13:50:18.937
> 
> 标签：opengl, ubuntu, sdl

我有一个我没有设法运行的 C 代码 [http://dl.getdropbox.com/u/175564/problem-sdl.png](http://dl.getdropbox.com/u/175564/problem-sdl.png)

问题出在 OpenGL 或 SDL 中。我在 /usr/local/SDL/SDL.h 中没有 SDL.h，所以 gcc 找不到它。

我在 /opt/local/include/SDL/SDL.h 上安装了 MacPorts 的 SDL.h。

我试图将其复制到文件夹中的 /Masi/local/SDL/SDL.h 失败

```
cp /opt/local/include/SDL/SDL.h / 
```

并通过

```
cp /opt/local/include/SDL/SDL.h /Masi/local/SDL/ 
```

我试图通过创建符号链接来解决问题

```
$ln -s /opt/local/include/SDL/SDL.h /Masi/local/SDL/SDL.h 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T14:29:17.317

获取 SDL 的所有编译器标志的最简单方法是使用`sdl-config`：

```
gcc sdl_gl_1.c $(sdl-config --cflags --libs) -lGL -lGLU 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T14:01:16.710

不，Ubuntu 默认没有它们（至少是开发版本）。对于我自己的小程序，我刚刚安装了*libsdl1.2-dev*和*mesa-common-dev* (OpenGL)。

对于构建过程，我使用 scons 生成以下命令：

```
gcc -o src/geom.o -c -Wall -ansi src/geom.c
gcc -o src/main.o -c -Wall -ansi src/main.c
gcc -o test src/main.o src/geom.o -lSDL -lGL 
```

如果将库安装在某个非标准位置，则可能必须指定自己的包含 (-I) 和库 (-L) 路径。

# python - Web服务器的.cgi问题

> ID：621874
> 
> 赞同：1
> 
> 时间：2009-03-07T14:01:33.123
> 
> 标签：python, cgi

[编码](http://www.djangobook.com/en/2.0/chapter01/)

```
#!/usr/bin/env python

import MySQLdb

print "Content-Type: text/html"
print 
print "<html><head><title>Books</title></head>"
print "<body>" print "<h1>Books</h1>" 
print "<ul>"

connection = MySQLdb.connect(user='me', passwd='letmein', db='my_db') cursor = connection.cursor() cursor.execute(“SELECT name FROM books ORDER BY pub_date DESC LIMIT 10”)

for row in cursor.fetchall():
    print "<li>%s</li>" % row[0]

print "</ul>" 
print "</body></html>"

connection.close() 
```

我将它作为 test.cgi 保存到我的网络服务器。我通过 www.mysite.com/test.cgi 运行它没有成功

```
Internal Server Error

The server encountered an internal error or misconfiguration and was unable to complete your request. 
```

你怎么能解决这个问题？

**[编辑]**在第一个答案之后

1.  test.cgi 是可执行的（我运行 $ chmod +x test.cgi）
2.  我使用阿帕奇。
3.  我在 .bashrc 中有这个 export PATH=${PATH}:~/bin
4.  Python 模块 MySQLdb 已安装。
5.  该代码没有智能引号。

**[编辑]**在第二个答案之后

> 您收到该错误是因为您尚未安装 Python 需要与 MySQL 数据库通信的 MySQLdb 模块

我将 MySQLdb 安装到我的系统中。该模块有效，因为我可以导入它们。但是，当我访问 www.[mysite].com/test.cgi 时，我仍然遇到同样的错误。

**[编辑]**

我不确定这些问题

> connect() 参数是否正确？MySQL 是否在默认端口的 localhost 上运行？

我在我的服务器上运行 MySQL。关于 connect() 参数的问题在这里是否相关？

> SELECT 语句是否正确？

你的意思是我的 SELECT 语句等 SQL 语句是否正确？我还没有使用任何 SQL 查询。我在这里需要它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T14:12:58.353

我通过在必要时插入换行符并用 and 替换智能引号来稍微整理了`"`代码`'`。你还有以下运气吗？您可以通过键入从终端运行它`python test.cgi`吗？

```
#!/usr/bin/env python

import MySQLdb

print "Content-Type: text/html"
print
print "<html><head><title>Books</title></head>"
print "<body>"
print "<h1>Books</h1>"
print "<ul>"

connection = MySQLdb.connect(user='me', passwd='letmein', db='my_db')
cursor = connection.cursor()
cursor.execute("SELECT name FROM books ORDER BY pub_date DESC LIMIT 10")

for row in cursor.fetchall():
    print "<li>%s</li>" % row[0]

print "</ul>"
print "</body></html>"

connection.close() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T14:49:48.793

任何数量的问题都可能导致您看到的错误：

1.  服务器上是否`test.cgi`可执行（chmod 755）？
2.  您放置的目录是否被`test.cgi`指定为[ScriptAlias](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#scriptalias)位置或启用了[ExecCGI](http://httpd.apache.org/docs/2.2/howto/cgi.html)选项（如果您不使用 Apache，则为等效）？
3.  是`python`在系统`PATH`中还是在`PATH`Web服务器的启动环境中？
4.  是否安装了[MySQLdb](http://mysql-python.sourceforge.net/) Python 库？
5.  参数是否`connect()`正确？MySQL 是否在默认端口的 localhost 上运行？
6.  `SELECT`陈述是否正确？

如果您确定`python`找到了（使用最简单的脚本进行测试，或者如果可以的话，通过登录到 Web 服务器并键入`which python`），那么您可以通过将以下内容添加到脚本顶部的 shebang 下方来获得更好的调试输出：

```
import cgitb
cgitb.enable() 
```

更多细节：[http ://docs.python.org/library/cgitb.html](http://docs.python.org/library/cgitb.html)

此外，如果您对 Web 服务器具有 shell 访问权限，请尝试运行 python 并输入：

```
>>> import MySQLdb 
```

如果命令返回没有错误，那么您就有了上面 #4 的答案。如果打印错误，则需要将 MySQLdb 安装到 Web 服务器的 Python 安装中。

**编辑：**更仔细地查看您问题的顶部，我发现代码是从 Django Book 开头的说明性示例中抓取的。因此，我可能会扩展上面的#5 以包含警告，当然，需要在 Web 服务器可用的 MySQL 安装上设置必要的数据库、表、用户和权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T16:30:45.993

[发生http://dpaste.com/8866/](http://dpaste.com/8866/)中的错误是因为您使用的是“弯引号”而不是标准的 ASCII 引号。

您需要将“和”替换为“。只需在文本编辑器中使用查找和替换即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T18:50:47.560

确保以正确的行结尾保存文件。即 LF 仅适用于 unix，或 CR/LF 适用于 Windows。我最近遇到了完全相同的问题...

# perl - 为什么 MooseX::Storage 似乎不遵循某些对象的属性特征？

> ID：621876
> 
> 赞同：6
> 
> 时间：2009-03-07T14:02:13.823
> 
> 标签：perl, serialization, moose

我整理了一个小测试用例来证明我的问题：

```
package P1;
use Moose;
use MooseX::Storage;
with Storage;

has 'blah' => (
    is => 'rw',
);

package P2;
use Moose;
use MooseX::Storage;
with Storage;

has 'lol' => (
    is => 'rw',
    traits => ['DoNotSerialize']
);

package P3;
use Moose;
extends 'P2';

has 'magic' => (
    is => 'rw',
);

package Test;
my $obj = P3->new(
    magic => 'This ok!',
    lol   => sub { 'weee' }
);

my $stored = P1->new(blah => $obj);

use Data::Dumper; print Dumper ($stored->pack); 
```

我希望这会打印对象，而不是 P2 包中的“lol”属性 - 但是，我仍然可以在结果中看到这一点`$stored->pack`

```
$VAR1 = {
          '__CLASS__' => 'P1',
          'blah' => bless( {
                             'magic' => 'This ok!',
                             'lol' => sub { "DUMMY" }
                           }, 'P3' )
        }; 
```

我是否使用了 MooseX::Storage 错误，或者这看起来像错误的行为？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-07T20:50:43.687

是的，这看起来像一个错误。你能把它变成一个使用 Test::More 的测试并将它提交到 RT 队列，然后有人（可能是我）会解决这个问题。

请注意，如果您 Dump $obj->store 您会看到该特征已正确应用于直接属性，但它似乎在继承过程中丢失了。

[您可以在RT](http://rt.cpan.org/Public/Dist/Display.html?Name=MooseX-Storage)中报告针对 MooseX::Storage 的错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T21:41:17.497

你可以让'blah'成为P3的一个ISA......

```
has 'blah' => (
    is  => 'rw',
    isa => 'P3',
); 
```

现在 Dumper( $stored->pack ) 显示了这个....

```
$VAR1 = {
      '__CLASS__' => 'P1',
      'blah' => {
                  '__CLASS__' => 'P3',
                  'magic' => 'This ok!'
                }
}; 
```

这看起来像这个 Moose 对象的正确序列化？

# design-patterns - 用于分析、设计或架构的模式

> ID：621878
> 
> 赞同：2
> 
> 时间：2009-03-07T14:06:36.777
> 
> 标签：design-patterns, analysis-patterns

在不同领域和架构中花费多年的分析、设计和编程之后
，您可能会遇到
尚未作为模式（分析、设计或架构）发布的“模式”或良好实践。
虽然你以前做过很多次，但它没有名字。

对来自 SO 社区的模式感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T14:20:12.657

我曾经认为是我自己的那些，即“我发明了它们”，结果证明是 20 年前“发明的”。我数不清有多少次我意识到我正在使用一种已经众所周知的设计模式，而我并不知道它。

这些是多年来试图解决相同问题的结果。我想除非有人“发现”一个新的问题域，否则你不太可能看到新的模式。

也许在未来，新的编程范式或技术将有助于发现解决相同老问题的新方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T21:24:18.253

我自己没有想出任何新模式，但发现新模式的最佳方法是了解所有现有模式。这是我最喜欢的设计模式网站之一。[101 种设计模式](http://sourcemaking.com/design-patterns-and-tips)。特别要注意反模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T14:15:12.717

不是真正的新模式，但我经常使用工厂模式和策略模式的组合。这可以防止工厂有 switch 语句，并且您可以使用新的“工厂策略”配置您的工厂。我不确定这个模式是否有名字。如果有人能告诉我，我将不胜感激。

不久前我在博客上写过这个：[http ://www.herrodius.com/blog/136](http://www.herrodius.com/blog/136)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T14:42:30.043

我认为几乎所有东西都被发明了不止一次，但是我一直使用的两种模式，但没有看到其他人使用我认为他们应该做的那么多：

*   **不可复制的对象**- 问题域中的大多数对象（例如：BankAccount、Person、Transaction）不应是可复制的，这与实现域中的对象（例如：字符串、数组、整数）不同。因此，我使用语言特性使此类业务领域对象不可复制。

*   **拥有对象**- 诸如 BankAccount 之类的对象拥有其事务。当拥有对象被销毁时，它管理这些拥有对象的销毁。这种模式几乎不需要使用智能指针。

# apache-flex - 在 flex TileList 控件中缓存图像缩略图

> ID：621879
> 
> 赞同：3
> 
> 时间：2009-03-07T14:06:43.627
> 
> 标签：apache-flex, actionscript-3

我有一个 flex TileList，我向其中加载了一堆图像。

当磁贴列表上下滚动时，它会对所有图像进行新的请求，即使它们之前已加载。

有没有办法阻止这种行为并让 TileList 控件保留其先前加载的图像？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T14:42:04.930

Flex 不为您提供图像的本机缓存。它重新加载它们。您将不得不编写自己的缓存（图像链接列表）。您应该使用图像缓存的示例实现来查看两个参考：

*   [SuperImage——](http://www.quietlyscheming.com/blog/2007/01/23/some-thoughts-on-doubt-on-flex-as-the-best-option-orhow-i-made-my-flex-images-stop-dancing/)我用过这个，效果很好
*   [图像缓存](http://thanksmister.com/?tag=titlelist)

# java - 自然语言解析，实例

> ID：621880
> 
> 赞同：4
> 
> 时间：2009-03-07T14:06:59.443
> 
> 标签：java, nlp

我希望将自然语言解析库用于简单的聊天机器人。我可以得到词性标签，但我总是想知道。你用 POS 做什么。如果我知道演讲的部分，那又如何？

我想这将有助于回应。但是我可以使用什么数据结构和架构。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-07T16:48:05.563

词性标注器为输入文本中的单词分配标签。例如，流行的 Penn Treebank 标记集有大约 40 个标签，例如“复数名词”、“比较形容词”、“过去时动词”等。标记器还解决了一些歧义。例如，许多英语单词形式既可以是名词也可以是动词，但在其他词的上下文中，它们的词性是明确的。因此，使用 POS 标签注释文本后，您可以回答以下问题：我有多少名词？有多少句子不包含动词？等。

对于聊天机器人，您显然需要的远不止这些。您需要弄清楚文本中的主语和宾语，以及它们所附加的动词（谓词）；您需要解决照应（*他*或*她*指向哪个人），否定和量词的范围是什么（例如*every*，*more than 3*）等。

理想情况下，您需要将输入文本映射为某种逻辑表示（例如一阶逻辑），这将使您能够引入推理来确定两个句子的含义是否相同，或者是否存在蕴涵关系等。

虽然 POS 标记器会映射句子

```
Mary likes no man who owns a cat. 
```

对这样的结构

```
Mary/NNP likes/VBZ no/DT man/NN who/WP owns/VBZ a/DT cat/NN ./. 
```

你宁愿需要这样的东西：

```
SubClassOf(
   ObjectIntersectionOf(
      Class(:man)
      ObjectSomeValuesFrom(
         ObjectProperty(:own)
         Class(:cat)
      )
   )
   ObjectComplementOf(
      ObjectSomeValuesFrom(
         ObjectInverseOf(ObjectProperty(:like))
         ObjectOneOf(
            NamedIndividual(:Mary)
         )
      )
   )
) 
```

当然，虽然 POS 标记器的准确率和召回率接近 100%，但更复杂的自动处理性能会差很多。

一个很好的 NLP Java 库是[LingPipe](http://alias-i.com/lingpipe/)。然而，它并没有超越 POS 标记、分块和命名实体识别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-07T14:31:48.340

自然语言处理广泛而深入，其根源至少可以追溯到 60 年代。您可以开始阅读一般的[计算语言学](http://en.wikipedia.org/wiki/Computational_linguistics)、[自然语言生成](http://en.wikipedia.org/wiki/Natural_language_generation)、[生成语法](http://en.wikipedia.org/wiki/Generative_grammar)、[马尔可夫链](http://en.wikipedia.org/wiki/Markov_chains)、[聊天机器人](http://en.wikipedia.org/wiki/Chatterbot)等。

维基百科有一个[简短的库列表](http://en.wikipedia.org/wiki/Natural_language_processing_toolkits)，我想你可能已经看过了。Java 在 NLP 方面没有悠久的传统，尽管我没有看过斯坦福图书馆。

如果不深入研究语言学和语法，我怀疑你会得到非常令人印象深刻的结果。不是每个人都最喜欢的学校科目（或者我听说过——我自己也爱他们！）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T15:03:24.520

我将跳过很多细节并保持简单。词性标注可帮助您从句子中创建[解析树。](http://en.wikipedia.org/wiki/Parse_tree)一旦你有了这个，你就会尝试尽可能明确地理解一个含义。此解析步骤的结果将极大地帮助您为您的聊天机器人构建合适的响应。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-08T17:25:49.300

一旦有了词性标签，您就可以提取所有名词，例如，您可以大致了解某人正在谈论的事物或对象。

给你举个例子：

有人说“*你可以打开一个新窗口。* ”当你有 POS 标签时，你知道它们不是在谈论*罐头*（如*容器*、*罐子等，这在**open*的上下文中甚至是有意义的），而是一个*窗口*. 你也会知道*open*是一个动词。

*有了这些信息，您的聊天机器人可以生成更好的回复，与开罐器*等无关。

注意：您不需要解析器来获取 POS 标签。一个简单的词性标注器就足够了。解析器会为您提供更多信息（例如，主语是什么，句子的宾语是什么？）

# c# - 非通用 IQueryable 枚举问题

> ID：621881
> 
> 赞同：0
> 
> 时间：2009-03-07T14:09:13.340
> 
> 标签：c#, linq, dynamic, iqueryable

使用动态 linq ( [http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx) ) 我运行查询下面返回一个 IQueryable。在这个也是 IEnumerable 的结果上，我可以运行 Count() 但是没有 ToList() 来获取值。我可以使用 foreach 枚举它们，但无法在没有反射的情况下访问生成的匿名类型中的各个字段。这是唯一的方法吗？谢谢

```
var query =
                db.Customers.Where("City == @0 and Orders.Count >= @1", "London", 10).
                OrderBy("CompanyName").
                Select("New(CompanyName as Name, Phone)");

            foreach (var item in query)
            {
                foreach (var prop in item.GetType().GetProperties())
                {
                    Console.WriteLine(prop);
                }
            } 
```

尝试强制转换但出现错误无法将“DynamicClass1”类型的对象强制转换为“Test”类型。

```
 foreach (var item in query)
            {
                Console.WriteLine("{0}: {1}", ((Test)item).CompanyName, ((Test)item).Phone);
            }

public class Test {
            public string CompanyName { get; set; }
            public string Phone { get; set; } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T18:03:40.530

当您的查询在运行时被解析时，您不能期望动态对象的类型在编译时被解析。这就是动态 linq 的全部意义：它允许您以编译时检查为代价执行动态查询。

您必须使用反射来访问动态类型的属性，至少在 C# 4 之前是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T14:11:02.053

如果 IEnumerable 不是通用的，那么您应该强制转换而不是使用反射。

# database - 应用程序开发人员犯的数据库开发错误

> ID：621884
> 
> 赞同：566
> 
> 时间：2009-03-07T14:12:06.140
> 
> 标签：database, database-design

应用程序开发人员常犯的数据库开发错误有哪些？

* * *

## 回答 #1

> 赞同：1002
> 
> 时间：2009-03-07T14:18:36.857

**1\. 没有使用适当的索引**

这是一个相对容易的事情，但它仍然一直在发生。外键应该有索引。如果你在 a 中使用一个字段，`WHERE`你应该（可能）在它上面有一个索引。根据您需要执行的查询，此类索引通常应涵盖多个列。

**2\. 不强制参照完整性**

您的数据库在这里可能会有所不同，但如果您的数据库支持引用完整性——这意味着所有外键都保证指向一个存在的实体——你应该使用它。

在 MySQL 数据库上看到这种故障是很常见的。我不相信 MyISAM 支持它。InnoDB 可以。您会发现使用 MyISAM 的人或使用 InnoDB 但无论如何都没有使用它的人。

更多在这里：

*   [如果我总是用 php 控制我的数据库输入，那么像 NOT NULL 和 FOREIGN KEY 这样的约束有多重要？](https://stackoverflow.com/questions/382309/how-important-are-constraints-like-not-null-and-foreign-key-if-ill-always-contr)
*   [数据库设计中真的需要外键吗？](https://stackoverflow.com/questions/18717/are-foreign-keys-really-necessary-in-a-database-design)
*   [数据库设计中真的需要外键吗？](http://www.diovo.com/2008/08/are-foreign-keys-really-necessary-in-a-database-design/)

**3\. 使用自然而不是代理（技术）主键**

自然键是基于（表面上）唯一的外部有意义数据的键。常见的例子是产品代码、两个字母的州代码（美国）、社会安全号码等。代理或技术主键是那些在系统之外绝对没有意义的主键。它们纯粹是为了识别实体而发明的，通常是自动递增的字段（SQL Server、MySQL 等）或序列（最著名的是 Oracle）。

在我看来，您应该**始终**使用代理键。这个问题出现在这些问题中：

*   [你喜欢你的主键吗？](https://stackoverflow.com/questions/404040/how-do-you-like-your-primary-keys)
*   [表中主键的最佳做法是什么？](https://stackoverflow.com/questions/337503/whats-the-best-practice-for-primary-keys-in-tables)
*   [在这种情况下，您将使用哪种格式的主键。](https://stackoverflow.com/questions/506164/which-format-of-primary-key-would-you-use-in-this-situation)
*   [代理与自然/业务键](https://stackoverflow.com/questions/63090/surrogate-vs-natural-business-keys)
*   [我应该有一个专用的主键字段吗？](https://stackoverflow.com/questions/166750/should-i-have-a-dedicated-primary-key-field)

这是一个有点争议的话题，你不会得到普遍认同。虽然您可能会发现有些人认为自然键在某些情况下是可以的，但除了可以说是不必要的之外，您不会发现任何对代理键的批评。如果你问我，这是一个很小的缺点。

请记住，即使是[国家也可能不复存在](http://en.wikipedia.org/wiki/ISO_3166-1)（例如，南斯拉夫）。

**4.编写需要`DISTINCT`工作的查询**

您经常在 ORM 生成的查询中看到这一点。查看 Hibernate 的日志输出，您会看到所有查询都以：

```
SELECT DISTINCT ... 
```

这是确保您不会返回重复行并因此获得重复对象的捷径。你有时也会看到人们这样做。如果你看到它太多，这是一个真正的危险信号。这不是`DISTINCT`坏事或没有有效的应用程序。它确实（在这两个方面），但它不是编写正确查询的替代品或权宜之计。

从[我为什么讨厌 DISTINCT](http://weblogs.sqlteam.com/markc/archive/2008/11/11/60752.aspx)：

> 在我看来，事情开始变得糟糕的地方是当开发人员正在构建大量查询，将表连接在一起时，突然间他意识到他**似乎**正在获得重复（甚至更多）行并且他的即时响应......他对这个“问题”的“解决方案”是使用 DISTINCT 关键字，然后**POOF** 他所有的麻烦都消失了。

**5\. 聚合优于连接**

数据库应用程序开发人员的另一个常见错误是没有意识到`GROUP BY`可以将聚合（即子句）与连接相比要昂贵得多。

为了让您了解它的广泛性，我在这里写了几次关于这个主题的文章，并因此而被否决了很多。例如：

来自[SQL 语句 - “join” vs “group by and having”</a>：](https://stackoverflow.com/questions/477006/sql-statement-join-vs-group-by-and-having/477013#477013)

 [> 第一个查询：
> 
> ```
> SELECT userid
> FROM userrole
> WHERE roleid IN (1, 2, 3)
> GROUP by userid
> HAVING COUNT(1) = 3 
> ```
> 
> 查询时间：0.312 s
> 
> 第二个查询：
> 
> ```
> SELECT t1.userid
> FROM userrole t1
> JOIN userrole t2 ON t1.userid = t2.userid AND t2.roleid = 2
> JOIN userrole t3 ON t2.userid = t3.userid AND t3.roleid = 3
> AND t1.roleid = 1 
> ```
> 
> 查询时间：0.016 s
> 
> 这是正确的。我提出的加入版本**比聚合版本快二十倍。**

**6.不通过视图简化复杂查询**](https://stackoverflow.com/questions/477006/sql-statement-join-vs-group-by-and-having/477013#477013) 

[并非所有数据库供应商都支持视图，但对于那些支持视图的供应商，如果使用得当，它们可以大大简化查询。例如，在一个项目中，我为 CRM 使用了](https://stackoverflow.com/questions/477006/sql-statement-join-vs-group-by-and-having/477013#477013)[通用的 Party 模型](http://www.tdan.com/view-articles/5014/)。这是一种非常强大和灵活的建模技术，但会导致许多连接。在这个模型中有：

*   **党**：个人和组织；
*   **当事人角色**：当事人所做的事情，例如雇员和雇主；
*   **当事人角色关系**：这些角色如何相互关联。

例子：

*   Ted 是 Person，是 Party 的子类型；
*   Ted 有很多角色，其中之一是 Employee；
*   英特尔是一个组织，是一方的子类型；
*   英特尔有很多角色，其中之一是雇主；
*   英特尔聘用了 Ted，这意味着他们各自的角色之间存在关系。

因此，连接了五张表以将 Ted 与他的雇主联系起来。您假设所有员工都是人员（而不是组织）并提供此帮助视图：

```
CREATE VIEW vw_employee AS
SELECT p.title, p.given_names, p.surname, p.date_of_birth, p2.party_name employer_name
FROM person p
JOIN party py ON py.id = p.id
JOIN party_role child ON p.id = child.party_id
JOIN party_role_relationship prr ON child.id = prr.child_id AND prr.type = 'EMPLOYMENT'
JOIN party_role parent ON parent.id = prr.parent_id = parent.id
JOIN party p2 ON parent.party_id = p2.id 
```

突然之间，您对想要的数据有了一个非常简单的视图，但在一个高度灵活的数据模型上。

**7\. 不清理输入**

这是一个巨大的。现在我喜欢 PHP，但是如果您不知道自己在做什么，那么创建容易受到攻击的站点真的很容易。[没有什么比小鲍比桌的故事](http://xkcd.com/327/)更能概括它了。

用户通过 URL、表单数据**和 cookie**提供的数据应始终被视为敌对和经过消毒的。确保你得到你所期望的。

**8\. 不使用准备好的语句**

准备好的语句是当您编译查询减去插入、更新和`WHERE`子句中使用的数据，然后再提供这些数据时。例如：

```
SELECT * FROM users WHERE username = 'bob' 
```

对比

```
SELECT * FROM users WHERE username = ? 
```

或者

```
SELECT * FROM users WHERE username = :username 
```

取决于你的平台。

我已经看到数据库因为这样做而崩溃。基本上，任何现代数据库每次遇到新查询时都必须对其进行编译。如果它遇到以前见过的查询，您就让数据库有机会缓存​​已编译的查询和执行计划。通过进行大量查询，您可以让数据库有机会找出并相应地进行优化（例如，通过将已编译的查询固定在内存中）。

使用准备好的语句还将为您提供有关某些查询的使用频率的有意义的统计信息。

准备好的语句还将更好地保护您免受 SQL 注入攻击。

**9\. 标准化不够**

[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)基本上是优化数据库设计或如何将数据组织到表中的过程。

就在本周，我遇到了一些代码，其中有人将数组内爆并将其插入到数据库中的单个字段中。规范化就是将该数组的元素视为子表中的单独行（即一对多关系）。

这也出现在[存储用户 ID 列表的最佳方法中](https://stackoverflow.com/questions/620645/best-method-for-storing-a-list-of-user-ids)：

> 我在其他系统中看到该列表存储在序列化的 PHP 数组中。

但缺乏标准化有多种形式。

更多的：

*   [归一化：有多远才够远？](http://www.techrepublic.com/article/normalization-how-far-is-far-enough/)
*   [SQL by Design：为什么需要数据库规范化](http://www.sqlmag.com/Article/ArticleID/4887/sql_server_4887.html)

**10\. 过度规范化**

这似乎与前一点相矛盾，但规范化，就像许多事情一样，是一种工具。它是达到目的的手段，而不是目的本身。我认为许多开发人员忘记了这一点，并开始将“手段”视为“目的”。单元测试就是一个很好的例子。

我曾经开发过一个系统，它为客户提供了一个巨大的层次结构，类似于：

```
Licensee ->  Dealer Group -> Company -> Practice -> ... 
```

这样您就必须将大约 11 个表连接在一起才能获得任何有意义的数据。这是规范化走得太远的一个很好的例子。

更重要的是，仔细和深思熟虑的非规范化可以带来巨大的性能优势，但在执行此操作时必须非常小心。

更多的：

*   [为什么过多的数据库规范化可能是一件坏事](http://www.selikoff.net/blog/2008/11/19/why-too-much-database-normalization-can-be-a-bad-thing/)
*   [在数据库设计中规范化有多远？](https://stackoverflow.com/questions/496508/how-far-to-take-normalization-in-database-design)
*   [何时不规范化 SQL 数据库](http://www.25hoursaday.com/weblog/CommentView.aspx?guid=cc0e740c-a828-4b9d-b244-4ee96e2fad4b)
*   [也许规范化不正常](https://blog.codinghorror.com/maybe-normalizing-isnt-normal/)
*   [关于编码恐怖的所有数据库规范化辩论之母](http://highscalability.com/mother-all-database-normalization-debates-coding-horror)

**11\. 使用专属弧线**

排他弧是一个常见的错误，其中使用两个或多个外键创建表，其中一个且只有一个可以是非空的。 **大错。** 一方面，维护数据完整性变得更加困难。毕竟，即使具有参照完整性，也没有什么可以阻止设置两个或多个这些外键（尽管有复杂的检查约束）。

从[关系数据库设计实用指南](http://books.google.com.au/books?id=7ZAk0YiKQV0C&pg=PA110&lpg=PA110&dq=%22exclusive+arc%22+database&source=bl&ots=AyNPWsac__&sig=gBFIerXckQlVpRdd6ycI5JEgq3U&hl=en&ei=PzGzSZfrFcPVkAWWyZDZBA&sa=X&oi=book_result&resnum=1&ct=result)：

> 我们强烈建议尽可能不要使用独占的弧形构造，因为它们编写代码会很尴尬并且会带来更多的维护困难。

**12\. 根本不对查询做性能分析**

实用主义至高无上，尤其是在数据库领域。如果你坚持原则以至于它们已经成为教条，那么你很可能犯了错误。以上面的聚合查询为例。聚合版本可能看起来“不错”，但它的性能很糟糕。性能比较应该已经结束了辩论（但它没有），但更重要的是：首先发表这种不明智的观点是无知的，甚至是危险的。

**13\. 过度依赖 UNION ALL 尤其是 UNION 结构**

SQL 术语中的 UNION 仅连接全等数据集，这意味着它们具有相同的类型和列数。它们之间的区别在于 UNION ALL 是一个简单的连接，应尽可能首选，而 UNION 将隐式执行 DISTINCT 以删除重复的元组。

UNION 和 DISTINCT 一样，都有自己的位置。有有效的申请。但是如果你发现自己做了很多，特别是在子查询中，那么你可能做错了什么。这可能是查询构造不佳或数据模型设计不佳迫使您执行此类操作的情况。

UNION，尤其是在连接或依赖子查询中使用时，可能会削弱数据库。尽量避免它们。

**14\. 在查询中使用 OR 条件**

这似乎无害。毕竟，AND 是可以的。或者也应该没问题吧？错误的。基本上，AND 条件**限制**了数据集，而 OR 条件**增加**了数据集，但不是以适合优化的方式。特别是当不同的 OR 条件可能相交从而迫使优化器有效地对结果进行 DISTINCT 操作时。

坏的：

```
... WHERE a = 2 OR a = 5 OR a = 11 
```

更好的：

```
... WHERE a IN (2, 5, 11) 
```

现在，您的 SQL 优化器可以有效地将第一个查询转换为第二个查询。但它可能不会。只是不要这样做。

**15\. 没有设计他们的数据模型来适应高性能的解决方案**

这是一个难以量化的点。它通常通过其效果来观察。如果您发现自己为相对简单的任务编写了粗糙的查询，或者发现相对简单的信息的查询效率不高，那么您的数据模型可能很差。

在某些方面，这一点总结了所有较早的内容，但它更像是一个警示故事，即执行查询优化之类的事情通常应该先完成，而应该第二次完成。首先，在尝试优化性能之前，您应该确保拥有良好的数据模型。正如高德纳所说：

> 过早的优化是万恶之源

**16\. 数据库事务的错误使用**

特定进程的所有数据更改都应该是原子的。即如果操作成功，它会完全这样做。如果失败，则数据保持不变。- 不应该有“半途而废”的变化。

理想情况下，实现这一点的最简单方法是整个系统设计应努力通过单个 INSERT/UPDATE/DELETE 语句支持所有数据更改。在这种情况下，不需要特殊的事务处理，因为您的数据库引擎应该自动执行此操作。

但是，如果任何流程确实需要将多个语句作为一个单元执行以使数据保持一致状态，则需要适当的事务控制。

*   在第一个语句之前开始一个事务。
*   在最后一条语句之后提交事务。
*   出现任何错误时，回滚事务。而且很NB！不要忘记跳过/中止错误之后的所有语句。

还建议仔细注意您的数据库连接层和数据库引擎在这方面如何交互的细节。

**17\. 不理解“基于集合”的范式**

SQL 语言遵循适用于特定类型问题的特定范式。尽管有各种特定于供应商的扩展，但该语言仍难以处理在 Java、C#、Delphi 等语言中微不足道的问题。

这种缺乏理解表现在几个方面。

*   对数据库不恰当地施加过多的程序或命令逻辑。
*   不恰当或过度使用游标。特别是当一个查询就足够了。
*   错误地假设触发器在多行更新中受影响的每行触发一次。

明确责任分工，力求用合适的工具解决每一个问题。

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-03-07T17:14:26.200

**开发人员犯的关键数据库设计和编程错误**

*   **自私的数据库设计和使用。** 开发人员经常将数据库视为他们个人的持久对象存储，而不考虑数据中其他利益相关者的需求。这也适用于应用程序架构师。糟糕的数据库设计和数据完整性使第三方难以处理数据，并且会大大增加系统的生命周期成本。报告和 MIS 在应用程序设计中往往是一个糟糕的表亲，只是事后才做的。

*   **滥用非规范化数据。**过度使用非规范化数据并试图在应用程序中维护它是数据完整性问题的根源。谨慎使用非规范化。不想在查询中添加连接并不是非规范化的借口。

*   **害怕写SQL。** SQL 不是火箭科学，实际上很擅长做它的工作。O/R 映射层非常擅长处理 95% 的简单查询，并且非常适合该模型。有时 SQL 是完成这项工作的最佳方式。

*   **教条式的“无存储过程”政策。** 不管你是否认为存储过程是邪恶的，这种教条主义的态度在软件项目中是没有立足之地的。

*   **不懂数据库设计。** 标准化是你的朋友，它[不是火箭科学。](https://stackoverflow.com/questions/246701/what-is-normalisation-or-normalization-why-is-it-important/246775#246775) 连接和基数是相当简单的概念——如果您参与数据库应用程序开发，真的没有理由不理解它们。

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2009-03-07T15:33:11.560

1.  不在数据库模式上使用版本控制
2.  直接针对实时数据库工作
3.  没有阅读和理解更高级的数据库概念（索引、聚集索引、约束、物化视图等）
4.  未能测试可扩展性...只有 3 或 4 行的测试数据永远无法为您提供真实现场性能的真实画面

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2009-03-07T15:52:48.143

过度使用和/或依赖存储过程。

一些应用程序开发人员将存储过程视为中间层/前端代码的直接扩展。这似乎是 Microsoft 堆栈开发人员的一个共同特征，（我是其中之一，但我已经从中成长）并生成许多执行复杂业务逻辑和工作流处理的存储过程。这在其他地方做得更好。

存储过程在实际证明某些真正的技术因素需要使用它们的情况下很有用（例如，性能和安全性），例如，保持大型数据集的聚合/过滤“接近数据”。

我最近不得不帮助维护和增强一个大型 Delphi 桌面应用程序，其中 70% 的业务逻辑和规则在 1400 个 SQL Server 存储过程中实现（其余在 UI 事件处理程序中）。这是一场噩梦，主要是由于难以向 TSQL 引入有效的单元测试、缺乏封装和糟糕的工具（调试器、编辑器）。

过去与 Java 团队一起工作时，我很快发现在那个环境中通常完全相反。一位 Java 架构师曾经告诉我：“数据库是用于数据的，而不是用于代码的。”。

这些天来，我认为根本不考虑存储过程是错误的，但是在它们提供有用好处的情况下应该谨慎使用（不是默认情况下）（参见其他答案）。

* * *

## 回答 #5

> 赞同：41
> 
> 时间：2009-03-07T15:37:54.093

第一个问题？他们只在玩具数据库上进行测试。所以他们不知道当数据库变大时他们的 SQL 会爬行，并且稍后必须有人来修复它（你能听到的声音是我的牙齿磨牙）。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2009-03-07T14:19:42.550

不使用索引。

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2010-12-13T13:42:56.833

**相关子查询导致性能不佳**

大多数时候，您希望避免相关子查询。如果在子查询中存在对来自外部查询的列的引用，则子查询是相关的。发生这种情况时，对于返回的每一行，子查询至少执行一次，如果在应用包含相关子查询的条件后应用其他条件，则可以执行更多次。

请原谅人为的示例和 Oracle 语法，但假设您想查找自上次一天销售额低于 10,000 美元以来，您的任何一家商店雇用的所有员工。

```
select e.first_name, e.last_name
from employee e
where e.start_date > 
        (select max(ds.transaction_date)
         from daily_sales ds
         where ds.store_id = e.store_id and
               ds.total < 10000) 
```

此示例中的子查询通过 store_id 与外部查询相关联，并且将为系统中的每个员工执行。可以优化此查询的一种方法是将子查询移动到内联视图。

```
select e.first_name, e.last_name
from employee e,
     (select ds.store_id,
             max(s.transaction_date) transaction_date
      from daily_sales ds
      where ds.total < 10000
      group by s.store_id) dsx
where e.store_id = dsx.store_id and
      e.start_date > dsx.transaction_date 
```

在这个例子中，from 子句中的查询现在是一个内联视图（同样是一些 Oracle 特定的语法）并且只执行一次。根据您的数据模型，此查询可能会执行得更快。随着员工人数的增加，它的性能将比第一个查询更好。如果员工少而商店多（也许许多商店没有员工），并且daily_sales 表在store_id 上建立索引，那么第一个查询实际上可以执行得更好。这不是一种可能的情况，但显示了相关查询如何可能比替代查询执行得更好。

我已经看到初级开发人员多次关联子查询，这通常会对性能产生严重影响。但是，在删除相关子查询时，请务必查看前后的[解释计划](http://en.wikipedia.org/wiki/Query_plan)，以确保不会使性能变差。

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2009-03-07T14:42:55.347

以我的经验：
不与有经验的 DBA 交流。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2009-03-07T14:41:25.883

使用 Access 而不是“真实”数据库。有很多很棒的小型甚至免费的数据库，例如[SQL Express](http://www.microsoft.com/express/sql/)、[MySQL](http://www.mysql.org)和[SQLite](http://www.sqlite.org/)，它们可以更好地工作和扩展。应用程序通常需要以意想不到的方式扩展。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2009-03-07T14:16:30.560

忘记设置表之间的关系。我记得当我第一次开始在我现在的雇主工作时不得不清理这个。

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2009-06-08T15:31:02.910

我想补充一点：与高性能代码相比，更喜欢“优雅”的代码。在应用程序开发人员看来，最适合数据库的代码通常很难看。

相信关于过早优化的废话。数据库必须考虑原始设计和任何后续开发中的性能。在我看来，性能是数据库设计的 50%（40% 是数据完整性，最后 10% 是安全性）。一旦真实用户和真实流量被放置在数据库上，不是自下而上构建的数据库将表现不佳。过早的优化并不意味着没有优化！这并不意味着您应该编写几乎总是表现不佳的代码，因为您发现它更容易（例如，除非所有其他方法都失败了，否则在生产数据库中绝不应该允许使用游标）。这意味着您无需考虑挤出最后一点性能，直到您需要为止。很多人都知道什么会在数据库上表现得更好，

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2010-08-02T17:18:26.253

使用 Excel 存储（大量）数据。

我见过拥有数千行并使用多个工作表的公司（由于以前版本的 Excel 的行数限制为 65535）。

* * *

Excel 非常适合报告、数据展示和其他任务，但不应被视为数据库。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2009-03-07T16:52:46.113

不使用参数化查询。它们在停止[SQL Injection](http://en.wikipedia.org/wiki/SQL_injection)方面非常方便。

这是另一个答案中提到的不清理输入数据的具体示例。

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2010-11-11T05:53:05.613

对于基于 SQL 的数据库：

1.  未利用 CLUSTERED INDEXES 或为 CLUSTER 选择错误的列。
2.  不使用 SERIAL（自动编号）数据类型作为 PRIMARY KEY 来加入父/子表关系中的 FOREIGN KEY (INT)。
3.  当许多记录已被插入或删除时，不更新表上的统计信息。
4.  当插入或删除许多行时，不重新组织（即卸载、删除、重新创建、加载和重新索引）表（某些引擎在物理上使用删除标志将删除的行保留在表中。）
5.  在具有高事务率的大型表上不利用 FRAGMENT ON EXPRESSION（如果支持）。
6.  为列选择了错误的数据类型！
7.  没有选择正确的列名。
8.  不在表格末尾添加新列。
9.  没有创建适当的索引来支持经常使用的查询。
10.  在可能值很少的列上创建索引并创建不必要的索引。
    ...更多待补充。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2011-02-23T16:25:31.650

当开发人员使用嵌套的选择语句甚至函数返回查询的“SELECT”部分内的选择语句的结果时，我讨厌它。

我真的很惊讶我在这里其他任何地方都没有看到这一点，也许我忽略了它，尽管@adam 指出了类似的问题。

例子：

```
SELECT
    (SELECT TOP 1 SomeValue FROM SomeTable WHERE SomeDate = c.Date ORDER BY SomeValue desc) As FirstVal
    ,(SELECT OtherValue FROM SomeOtherTable WHERE SomeOtherCriteria = c.Criteria) As SecondVal
FROM
    MyTable c 
```

在这种情况下，如果 MyTable 返回 10000 行，结果就好像查询只运行了 20001 次查询，因为它必须运行初始查询，并为每一行结果查询每个其他表一次。

开发人员可以在只返回几行数据且子表通常只有少量数据的开发环境中摆脱这种工作，但在生产环境中，这种查询的成本可能会成倍增加数据被添加到表中。

更好的（不一定是完美的）示例如下：

```
SELECT
     s.SomeValue As FirstVal
    ,o.OtherValue As SecondVal
FROM
    MyTable c
    LEFT JOIN (
        SELECT SomeDate, MAX(SomeValue) as SomeValue
        FROM SomeTable 
        GROUP BY SomeDate
     ) s ON c.Date = s.SomeDate
    LEFT JOIN SomeOtherTable o ON c.Criteria = o.SomeOtherCriteria 
```

这允许数据库优化器将数据混在一起，而不是重新查询主表中的每条记录，我通常会发现，当我必须修复创建此问题的代码时，我通常最终会将查询速度提高 100% 或更多，同时减少 CPU 和内存使用。

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2011-01-19T20:25:58.813

*   在修复生产数据库中的某些问题之前不进行备份。

*   在存储过程中对存储对象（如表、视图）使用 DDL 命令。

*   害怕使用存储过程或害怕使用 ORM 查询，无论哪个更有效/更适合使用。

*   忽略数据库分析器的使用，它可以准确地告诉您最终将您的 ORM 查询转换为什么，从而验证逻辑，甚至在不使用 ORM 时进行调试。

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2009-03-07T14:22:35.583

没有做正确的[标准化](http://en.wikipedia.org/wiki/Database_normalization)水平。您要确保数据不重复，并且根据需要将数据拆分为不同的数据。您还需要确保您没有遵循规范化*太远*，因为这会损害性能。

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2009-03-07T16:02:56.047

将数据库视为一种存储机制（即美化的集合库），因此从属于它们的应用程序（忽略共享数据的其他应用程序）

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2009-03-10T21:28:05.007

**1 -**不必要地对 where 子句中的值使用函数，结果未使用该索引。

例子：

```
where to_char(someDate,'YYYYMMDD') between :fromDate and :toDate 
```

代替

```
where someDate >= to_date(:fromDate,'YYYYMMDD') and someDate < to_date(:toDate,'YYYYMMDD')+1 
```

在较小程度上：不向那些需要它们的值添加功能索引......

**2 -**不添加检查约束以确保数据的有效性。查询优化器可以使用约束，它们确实有助于确保您可以信任您的不变量。没有理由不使用它们。

**3 -**出于纯粹的懒惰或时间压力，将非规范化列添加到表中。事物通常不是这样设计的，而是演变成这样的。最终的结果是，当您在未来的演变中被丢失的数据完整性所困扰时，需要做大量的工作来清理混乱。

想一想，没有数据的表重新设计非常便宜。一张有几百万条记录但没有完整性的表……重新设计并不便宜。因此，在创建列或表时进行正确的设计是分期摊销的。

**4 -**与数据库本身无关，但确实很烦人。不关心 SQL 的代码质量。您的 SQL 以文本形式表达这一事实并不能将逻辑隐藏在大量字符串操作算法中。完全有可能以您的程序员同事实际可读的方式以文本形式编写 SQL。

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2009-04-02T18:33:48.893

*   出于“它太神奇”或“不在**我的**数据库中”之类的原因，放弃像 Hibernate 这样的 ORM。
*   过于依赖像 Hibernate 这样的 ORM 并试图将它硬塞到不合适的地方。

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2009-07-28T20:23:27.460

这之前已经说过了，但是： **索引，索引，索引**。我见过很多性能不佳的企业 Web 应用程序的案例，这些案例通过简单地进行一些分析（查看哪些表受到很多打击）然后在这些表上添加索引来解决。这甚至不需要太多的SQL编写知识，而且回报是巨大的。

避免像瘟疫一样的数据重复。有些人主张一点点重复不会有坏处，而且会提高性能。嘿，我并不是说你必须将你的模式折磨成第三范式，直到它如此抽象以至于连 DBA 都不知道发生了什么。请理解，每当您复制一组名称、邮政编码或运输代码时，这些副本最终将彼此不同步。它会发生。然后你会在运行每周维护脚本时自责。

最后：使用清晰、一致、直观的命名约定。就像一段写得好的代码应该是可读的一样，一个好的 SQL 模式或查询应该是可读的，并且实际上*告诉*你它在做什么，即使没有注释。六个月后你会感谢你自己，那时你必须在桌子上进行维护。 `"SELECT account_number, billing_date FROM national_accounts"`比“SELECT ACCNTNBR, BILLDAT FROM NTNLACCTS”更容易使用。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2010-01-06T12:11:37.490

在运行 DELETE 查询之前不执行相应的 SELECT 查询（特别是在生产数据库上）！

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2011-01-29T03:56:14.710

二十年来我见过的最常见的错误：没有提前计划。许多开发人员会创建数据库和表，然后在构建应用程序时不断修改和扩展表。最终结果通常是一团糟、效率低下，并且以后难以清理或简化。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2009-03-07T14:17:34.380

a) 在字符串中硬编码查询值
b) 将数据库查询代码放在 Windows 窗体应用程序的“OnButtonPress”操作中

我都见过。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2009-03-29T13:38:45.163

对管理应用程序中的数据库连接没有给予足够的关注。然后你会发现应用程序、计算机、服务器和网络都被阻塞了。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2011-01-05T13:55:11.420

1.  当他们在这些领域没有任何形式的正式灌输时，认为他们是 DBA 和数据建模师/设计师。

2.  认为他们的项目不需要 DBA，因为这些东西都很容易/微不足道。

3.  未能正确区分应该在数据库中完成的工作和应该在应用程序中完成的工作。

4.  不验证备份，或不备份。

5.  在他们的代码中嵌入原始 SQL。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2009-03-07T17:07:29.103

这是一个名为“<a href="http://www.slideshare.net/findling67/database-development-mistakes" rel="nofollow noreferrer">经典数据库开发错误和克服它们的五种方法'的视频链接斯科特·沃尔兹

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2010-05-22T15:09:05.613

不了解数据库并发模型及其对开发的影响。事后添加索引和调整查询很容易。然而，在没有适当考虑热点、资源争用和正确操作（假设您刚刚阅读的内容仍然有效！）的情况下设计的应用程序可能需要在数据库和应用程序层内进行重大更改，以便以后更正。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2010-12-13T15:42:34.570

**不了解 DBMS 如何在后台工作。**

如果不了解离合器的工作原理，您将无法正确驾驶操纵杆。如果不了解您实际上只是在写入硬盘上的文件，您将无法理解如何使用数据库。

具体来说：

1.  你知道聚集索引是什么吗？您在设计架构时是否考虑过这一点？

2.  你知道如何正确使用索引吗？如何重用索引？你知道什么是覆盖指数吗？

3.  太好了，你有索引。您的索引中的 1 行有多大？当您有大量数据时，索引会有多大？这会很容易融入记忆吗？如果它不会，它作为索引是无用的。

4.  你曾经在 MySQL 中使用过 EXPLAIN 吗？伟大的。现在对自己诚实：你是否理解了你所看到的一半？不，你可能没有。修复它。

5.  你了解查询缓存吗？你知道是什么让查询不可缓存吗？

6.  你在使用 MyISAM 吗？如果您需要全文搜索，MyISAM 无论如何都是废话。使用狮身人面像。然后切换到Inno。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2010-12-13T17:36:29.173

1.  使用 ORM 进行批量更新
2.  选择比需要更多的数据。同样，通常在使用 ORM 时完成
3.  在循环中触发 sql。
4.  没有良好的测试数据并且仅在实时数据上注意到性能下降。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2011-01-04T21:42:58.243

好吧，我不得不说，应用程序开发人员犯的最大错误是**没有正确规范数据库。**

作为一名应用程序开发人员，我意识到正确的数据库结构、规范化和维护的重要性；我花了无数时间自学数据库结构和管理。根据我的经验，每当我开始与不同的开发人员合作时，我通常都必须**重组整个数据库**并更新应用程序以适应它，因为它通常是格式错误和有缺陷的。

例如，我开始处理一个新项目，开发人员要求我在网站上实现 Facebook Connect。我打开数据库查看我必须处理的内容，发现关于任何给定用户的每一点信息都被塞进**一张表中。**我花了六个小时编写一个脚本，将表格组织成四个或五个单独的表格，另外两个让应用程序使用这些表格。请**标准化您的数据库！它会让其他一切都不那么令人头疼。**

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2009-03-07T14:21:21.577

*   非常大的事务，插入/更新大量数据，然后重新加载。基本上，这归结为不考虑数据库工作的多用户环境。

*   过度使用函数，特别是导致选择和 where 子句导致函数被一遍又一遍地调用以获得结果。我认为，这符合他们试图以他们更习惯的程序方式工作而不是充分利用 SQL 的一般情况。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2009-03-07T14:54:18.270

当您在开发机器上运行得如此之快的查询爆炸并在您向应用程序抛出一些流量时阻塞时，责怪数据库引擎。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2010-12-13T13:02:31.623

15 - 使用一些疯狂的构造和应用程序逻辑而不是简单的 COALESCE。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2011-01-05T16:12:11.137

我认为所有开发人员和 DBA 所犯的最大错误是过于相信约定。我的意思是，约定只是在大多数情况下可行但不一定总是有效的指导方针。我很好的例子是规范化和外键，我知道大多数人不会喜欢这样，但是规范化会导致复杂性并导致性能损失，所以如果没有理由将电话号码移动到电话表中，请不要这样做它。在外键上，它们在大多数情况下都很棒，但是如果您尝试创建可以在需要时自行工作的东西，那么外键将来会成为问题，并且您也会失去性能。无论如何，由于我很难过有规则和惯例可以指导，它们应该始终被考虑但不一定要实施，对每个案例的分析是应该始终做的。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2011-03-11T17:39:54.097

许多开发人员倾向于对数据库执行多个查询（通常查询一个或两个表）提取结果并在 java/c/c++ 中执行简单的操作——所有这些都可以使用单个 SQL 语句完成。

许多开发人员通常没有意识到，在开发环境中，数据库和应用服务器位于他们的笔记本电脑上——但在生产环境中，数据库和应用服务器将位于不同的机器上。因此，对于每个查询，在应用服务器和数据库服务器之间传递的数据都会产生额外的 n/w 开销。我惊讶地发现从应用服务器到数据库服务器的数据库调用数量以向用户呈现一页！

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2011-03-12T14:42:59.430

最大的错误是在代码更新或插入数据时出现循环，而简单的基于集合的解决方案可以更快、更简单地完成任务。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2010-05-22T14:32:15.310

我可能会添加一件事，学习使用 PARTITION BY、RANK、DENSE_RANK（对于 Oracle）等分析函数。它们对于复杂的查询是绝对必要的。

其他建议是，如果可能的话，在您的开发团队中有一个专门的数据库开发人员，他是 SQL、数据库建模、调整等方面的专家（虽然不是 DBA）。这种技能是一笔巨大的财富。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2010-12-13T13:51:12.307

如果您使用复制 (MySQL)，除非您使用基于行的复制，否则以下函数是不安全的。

```
USER(), CURRENT_USER() (or CURRENT_USER), UUID(), VERSION(), LOAD_FILE(), and RAND() 
```

请参阅：[http ://dev.mysql.com/doc/refman/5.1/en/replication-features-functions.html](http://dev.mysql.com/doc/refman/5.1/en/replication-features-functions.html)

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2010-12-13T16:09:51.763

1) 对如何正确地在 Java 和数据库之间进行交互的理解不足。

2) 过度解析、不当或没有重用SQL

3) 未能使用 BIND 变量

4）当数据库中的 SQL 集合逻辑可以工作（更好）时，在 Java 中实现过程逻辑。

5) 在投入生产之前未能进行任何合理的性能或可扩展性测试

6）使用Crystal Reports并未能在报表中正确设置架构名称

7）由于不了解执行计划而使用笛卡尔积实现SQL（您甚至看过EXPLAIN PLAN吗？）

# wpf - 有条件地将 Foreground 绑定到布尔值

> ID：621886
> 
> 赞同：0
> 
> 时间：2009-03-07T14:13:09.147
> 
> 标签：wpf, data-binding

我有一个 Treeview 显示 Xml 数据，其中每个元素都包装在一个公开 IsExpanded 的类中，包装的 XElement 的名称和值以及一个布尔 MatchesFilter，如果元素匹配特定的过滤器则设置它；如果 MatchesFilter 为真，我想更改前景色。

我目前拥有的是：

```
<TreeView.ItemTemplate>
    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Width="110" Foreground="Blue" Text="{Binding Name}" />
            <TextBlock Foreground="{Binding Foreground}" Text="{Binding Value}" />
        </StackPanel>
    </HierarchicalDataTemplate>
</TreeView.ItemTemplate> 
```

在代码隐藏中设置前景色的位置，效果很好，但几乎不符合 WPF 的精神！我该如何正确地做到这一点？

编辑：谢谢，就像那样，现在我知道该读哪一章了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T22:34:51.343

像这样的东西？

```
<TextBlock Name="tbkValue" Text="{Binding Value}"/> 
```

...

```
<HierarchialDataTemplate.Triggers>
  <DataTrigger Binding="{Binding Path=MatchesFilter}" Value="True">
      <Setter TargetName="tbkValue" Property="Foreground" Value="Red"/>
  </DataTrigger>
</HierarchialDataTemplate.Triggers> 
```

您还可以将触发器创建为资源并在不同模板之间共享。

# php - 使用 PHP 和 MySQLi 在不同的数据库表中插入变量和数组

> ID：621893
> 
> 赞同：1
> 
> 时间：2009-03-07T14:19:28.320
> 
> 标签：php, mysql, database, database-design, mysqli

我正在学习 PHP 和 MySQL，并且正在创建一个用于学习目的的电影网站。

我想将包含电影信息的变量和数组插入数据库但在不同的表中。

这就是我现在所拥有的：

```
include('inc/connection.php');
$conn = dbConnect();

// create SQL
$sql = 'INSERT INTO movies (movieid, title, year, runtime, plot)
    VALUES(?, ?, ?, ?, ?)';

// initialize prepared statement
$stmt = $conn->stmt_init();
if ($stmt->prepare($sql)) {
    // bind parameters and execute statment
    $stmt->bind_param('isiis', $movieid, $title, $year, $runtime, $plot);
    $stmt->execute();
} 
```

这会将变量插入到电影表中。

但我还需要（同时）插入电影的类型、演员、语言等......它们在数组中并进入不同的表（也可能在不同的行中）。例如在流派表中包含流派（动作、犯罪、戏剧）流派的数组，以及在演员表中的演员等等......然后我将使用多对多和一对多表来显示信息。

有人可以向我解释如何做到这一点吗？我需要多次连接数据库？？我需要循环吗？我对 PHP 和 MySQLi 真的很陌生，所以请尽可能多地解释。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T15:31:04.017

1.  您只需要一个数据库连接
2.  是的，您确实需要循环
3.  在每张表中使用一个`auto_increment`主键字段，然后在每张表之后使用`$stmt->insert_id()`提取值`insert`
4.  如果可以，请`InnoDB`在 MySQL 服务器上使用以获取事务支持，然后`commit`一起进行相关更新，以确保如果您的脚本在更新中途退出，您的数据库是一致的。更常见的`MyISAM`数据库表格式不支持事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T01:45:00.217

`INSERT`一次只支持一个表，因此`INSERT`如果您有复杂的数据进入多个表，您肯定必须执行多个语句。

如果您已插入特定`$movieid`值，`movies`那么您知道需要向其他表的行插入什么值，以满足引用完整性（伪代码如下，不是完整功能示例）：

```
$movies_sql = 'INSERT INTO movies (movieid, title, year, runtime, plot)
        VALUES(?, ?, ?, ?, ?)';

// execute ($movieid, ...)

$actors_sql = 'INSERT INTO movie_actors (movieid, actorid) 
    VALUES (?, ?)';

foreach ($actorlist as $actorid) {
    // execute ($movieid, $actorid)
}

$lang_sql = 'INSERT INTO movie_languages (movieid, language) 
    VALUES (?, ?)';

foreach ($languagelist as $language) {
    // execute ($movieid, $language)
} 
```

如果您的`movies`表使用`AUTO_INCREMENT`主键，那么您可以`INSERT`通过调用[$mysqli->insert_id()](http://php.net/mysqli_insert_id)或使用内置函数来获取第一次生成的值[`LAST_INSERT_ID()`](http://dev.mysql.com/doc/refman/5.1/en/information-functions.html#function_last-insert-id)。

```
$actors_sql = 'INSERT INTO movie_actors (movieid, actorid) 
    VALUES (LAST_INSERT_ID(), ?)';
foreach ($actorlist as $actorid) {
    // execute ($actorid) -- only one param in this INSERT
} 
```

请注意，它会`LAST_INSERT_ID()`报告当前会话期间最近自动生成的值，因此如果您插入到另一个使用自动主键的表中，则该值会发生变化。但是报告的值在您的会话期间是稳定的；如果另一个客户端会话同时进行插入，它*不会改变。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T15:02:37.873

您不需要使用多个数据库连接——事实上，您根本不应该这样做，因为您无法将插入分组到一个原子事务中。

你应该做的（摘要）是：

```
BEGIN;
INSERT INTO Genres...;
INSERT INTO Actors...;
INSERT INTO othertable....;
and so on, for referenced columns/tables.
INSERT INTO Movies....;
COMMIT; 
```

这样，您应该始终拥有一致的数据集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T15:44:39.367

您可能正在寻找外键 - 使用基表中的一个 ID 来识别其他表中的其他关系（使用其他表中的 movieid 来识别其他值属于什么电影等）

# algorithm - 在排序列表中搜索饱和值的最佳方法

> ID：621900
> 
> 赞同：7
> 
> 时间：2009-03-07T14:24:09.823
> 
> 标签：algorithm, math, search

[数学之战](http://www.math.toronto.edu/oz/turgor/mathbattle/problems/mathbattleE1.pdf)的一个问题。在我的一次工作面试中，我也问了这个特别的问题。

" 一只猴子有两个椰子。它从 M 层楼的阳台上扔椰子在胡闹。当椰子被打破时，猴子想知道最低楼层。确定这个事实所需的最少尝试次数是多少？ "

条件：如果椰子坏了，你不能重复使用它。你只剩下另一个椰子了

我能想到的可能的方法/策略是

*   二进制分手 & 一旦你找到椰子打破的地板，使用从最后找到的二进制分手较低指数的向上计数。
*   较小的地板集的窗口/切片并在窗口/切片内使用二进制分解（但不利的一面是，这需要它自己的切片算法。）

想知道是否还有其他方法可以做到这一点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-07T15:10:47.793

像这样的面试问题旨在了解您的想法。所以我可能会提到上面的 O(N^0.5) 解决方案，但我也会给出以下讨论......

由于椰子随着时间的推移可能会出现内部开裂，因此结果可能与 O(N^0.5) 解决方案不太一致。尽管 O(N^0.5) 解决方案是有效的，但它并不完全可靠。

我会推荐第一个椰子的线性 O(N) 解决方案，然后用第二个椰子验证结果。其中 N 是建筑物的楼层数。所以对于第一个椰子，你尝试一楼，然后是二楼，然后是三楼，......

假设两个椰子在结构上完全相同并且以完全相同的角度掉落，那么您可以将第二个椰子直接扔到第一个破碎的地板上。将此称为椰子破地板 B。

对于 2 号椰子，您不需要在 1..B-1 上进行测试，因为您已经知道第一个椰子在 B-1、B-2、... 1 层没有破裂。所以您只需要在 B 上试一试。

如果第二个椰子在 B 上断裂，那么你知道 B 是有问题的地板。如果它没有破裂，您可以推断随着时间的推移椰子内部出现了开裂和降解，并且测试一开始就有缺陷。你需要更多的椰子。

鉴于建筑规模非常有限，对您的解决方案的额外信心值得 O(N) 解决方案。

正如@Rafał Dowgird 提到的，解决方案还取决于所讨论的猴子是非洲猴子还是欧洲猴子。众所周知，非洲猴子的投掷力要大得多。因此，只有在 +/- 2 层的变化范围内才能使破坏层 B 准确。

为了保证猴子不会从所有这些楼梯上感到疲倦，建议在第一个椰子上系一根绳子。这样你就不需要为第一个椰子做 1+2+..+B = B*(B+1)/2 楼梯。你只需要做 B 段楼梯。

似乎楼梯的数量与这个问题无关，但如果猴子一开始就累了，我们可能永远无法解决。这为[停机问题](http://en.wikipedia.org/wiki/Halting_problem)提供了新的考虑。

我们还假设建筑物位于地球上，并且重力设置为 9.8m/s^2。我们还将假设不存在引力波。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-07T14:43:29.933

二进制搜索不是答案，因为你只有一次机会高估。二分搜索需要`log m`最大的高估。

这是一个两阶段的方法。第一个是用相对大的步骤迭代楼层。在第一个椰子休息之后，第二阶段是从最后一个安全楼层开始尝试每个楼层。

大的步骤大致是`sqrt(m)`，但它们在早期较大，而在后期较小，因为如果第一个椰子提前破裂，您可以在第二阶段承受更多的迭代。

```
StepSize = (minimum s such that s * (s + 1) / 2 >= m)
CurrentFloor = 0

While no coconuts broken {
    CurrentFloor += StepSize
    StepSize -= 1

    Drop coconut from CurrentFloor
}

CurrentFloor -= StepSize + 1

While one remains coconut unbroken {
    CurrentFloor += 1
    Drop remaining coconut from CurrentFloor
}

// CurrentFloor is now set to the lowest floor that will break the coconut, 
// using no more total drops than the original value of StepSize 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T14:35:20.890

我知道的最好的解决方案是 2*sqrt(n)。将第一个椰子从 sqrt(n), 2*sqrt(n),... 放到 n （或直到它破裂）。然后从最后一个已知的“安全”点放下第二个，以一层为增量，直到它破裂。两个阶段最多进行 sqrt(n) 次投掷。

编辑：您可以改进 O(sqrt(n)) 内的常数，请参阅递归注释。我认为第一步应该在 sqrt(2*n) 左右，每次投掷减 1，这样最后一步（如果断裂高度实际上是 n）正好是 1。细节有待读者了解 :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T16:01:05.487

既然是面试题，考虑一下

1.  昂贵的操作是猴子上下楼梯，而不是折腾椰子。以这种方式考虑，“线性”方法实际上是 N ²。

2.  落下时传递给椰子的能量大致与落下的高度成正比。如果外壳在所有掉落中吸收了一定量的能量后破裂...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-19T18:26:51.287

艰难的面试题。我花了几天时间。

我相信尝试次数是楼层数 SQRT 的 1.5 倍。（对于 100 层和 2 个可可是 15）

我们希望最小化每次尝试的大小和尝试次数，同时使用两者来覆盖所有可能的楼层。在这种情况下，sqroot 被证明是一个很好的起点，但我们会改变每次尝试的大小和围绕 sqroot 的平均值。这样我们就可以两全其美了：每次尝试的大小均匀分布在 sqroot 周围会给我们最好的结果。对于 100 和 2，这是 15、14、13、12、11、10、9、8、7、6 这相当于 10 的 1.5 倍。

# java - Java：对图像使用 Castor XML

> ID：621903
> 
> 赞同：1
> 
> 时间：2009-03-07T14:26:19.227
> 
> 标签：java, xml, image, castor

如何使用 Castor XML 将 java.awt.Image 对象编组为 XML，或使 XML 以某种方式引用图像。

干杯，
皮特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T14:57:55.360

我想您可以编写自己的[字段处理程序](http://www.castor.org/xml-fieldhandlers.html)。我，我会将图像本身写入一个位置并从 xml 中引用图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T14:43:04.740

我不知道你是否可以直接存储图像。您可以尝试获取栅格并存储每个像素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T16:56:39.583

这完全取决于将使用 XML 的内容。正如 jjungnickel 所说，最简单的方法是将图像写入文件，然后在 XML 中引用该文件。您可以通过以下方式做到这一点：

*   将文件名（相对或绝对）放入 XML
*   在 XML 中放置一个 XML 实体引用，这取决于图像的编码方式，它可能有效，也可能无效

图像——二进制内容——可以进入 XML，但它需要更多的特殊处理。将文件名放入 XML 然后单独打开该文件要容易得多，但这取决于XML**使用者的需要。**

现在，如果您想使用 Castor 来执行此操作，序列化文件名比序列化图像本身要容易得多。如果要将图像本身放入 XML 中，则需要编写自定义字段处理程序。当我将 Castor 用于涉及图像的 XML 时，我总是将文件名放在 XML 中，而不是图像本身，然后 XML 使用者读取文件名并使用它来序列化图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T03:37:18.810

您当然可以对 gif/jpg/whatever 进行 base64 编码，并将其包装在一个或任何类型的标签中。正如 Jan 建议的那样，您可以使用自定义 FieldHandler 来执行此操作（我在 Castor 中至少五年没有这样做了）。

真正的问题是：你的目标是什么？您是否正在尝试设计一种可以将图像数据与“正常”信息一起传递的互操作方案？您是否尝试将数据作为 XML 保存在您自己的系统中？如果您尝试进行互操作，为了简单起见，我会选择 Base64 路线。几乎任何具有 XML 解析器的语言也将具有 Base64 包，因此不会给对方带来过度的负担。

如果您在您控制的系统中保留 XML 文档，我会考虑其他发帖人的建议，即在 XML 中为存储在某处的图像文件提供密钥，尤其是在图像很大或很多的情况下。

# .net - .NET Compact Framework 中缺少 DataContractSerializer

> ID：621913
> 
> 赞同：3
> 
> 时间：2009-03-07T14:33:27.150
> 
> 标签：.net, windows-mobile, compact-framework, datacontractserializer

似乎 DataContractSerializer 在 .NET Compact Framework 中不可用。我发现这非常令人惊讶，因为我认为 DataContractSerializer 是序列化的圣杯，并且是 .NET 3 中引入的最广泛使用的类之一。

有没有办法在 Compact Framework 下获得相同的功能，即使用文本格式轻松保存和恢复真实世界对象图的能力？

我宁愿远离旧的、有限的 .NET 序列化程序，例如 XmlSerializer 和 BinarySerializer。

我在想也许有 DataContractSerializer 的自定义实现可用，或者可以使用 Mono 中的代码？有没有人尝试过这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T16:47:35.110

~~它在 CF 3.5 中不可用吗？~~（编辑：不，我检查过 - 确实不是）。我知道 XmlSerialzier 在那里，但是是的，它确实有一些限制。

它需要基于文本吗？选项是[protobuf-net](http://code.google.com/p/protobuf-net/)，它适用于 CF2.0、CF3.5、Silverlight、Mono、.NET 2.0 等；并包括您通常需要的所有东西（包括回调等）。

顺便说一句，我上次看的 Mono 代码（来自“Olive”）不是很完整......

（编辑）另一种选择可能是[Json.NET](http://json.codeplex.com/)；从[这里开始](http://json.codeplex.com/Thread/View.aspx?ThreadId=35323)，这现在适用于 CF；因为这是 JSON，所以它是基于文本的，并且应该可以满足您的大部分需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T03:16:06.917

我不知道将 XmlSerializer 称为“有限”是否公平。你是什​​么意思？你用过它并发现它想要吗？对你来说失败的具体事情是什么？

根据我的经验，XmlSerializer 实际上比 DCS 具有更丰富的功能。DCS 做的更少，这可能是件好事。另一方面，DCS 至少做了 XmlSerializer 没有做的一件事——那就是它可以直接序列化到私有成员变量和从私有成员变量中序列化。

XmlSerializer 速度快且功能强大，您可以从中获得良好的实用性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T20:49:29.023

Found a solution :-)

There's a great XML serializer at [http://www.codeproject.com/KB/XML/GR_CustomXmlSerializer.aspx](http://www.codeproject.com/KB/XML/GR_CustomXmlSerializer.aspx).

As is, the code doesn't work on the Compact Framework, but I've made several trivial adjustments to get it to work, with only a minor loss of functionality. I've also used OpenNetCF to fill in a few missing CF pieces.

# bash - Shell 脚本中的 For 循环 - 在 csv 文件中添加断线

> ID：621915
> 
> 赞同：0
> 
> 时间：2009-03-07T14:39:17.820
> 
> 标签：bash, shell, command-line, sh

我正在尝试`for`在 shell 脚本中使用循环。

我正在从文本文件执行命令。我希望执行每个命令 10 次并将一些统计信息插入到 csv 文件中。完成该命令后，我想开始下一个，但在执行 10 次的第一个命令之后在 CSV 文件中放置一个换行符。

以下是否正确：

```
#Function processLine
processLine(){
line="$@"
for i in 1 2 3 4 5 6 7 8 9 10
do
START=$(date +%s.%N)
echo "$line"
eval $line > /dev/null 2>&1

END=$(date +%s.%N)
DIFF=$(echo "$END - $START" | bc)

echo "$line, $START, $END, $DIFF" >> file.csv 2>&1
echo "It took $DIFF seconds"
echo $line
done
} 
```

谢谢大家的帮助

## 更新

它正在正确执行循环，但我无法在每个命令执行 10 次后添加换行符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T15:10:04.830

```
processLine()
{
    line="$@"

    echo $line >> test_file
    for ((i = 1; i <= 10 ; i++))
    do
        # do not move to the next line
        echo -n "$i," >> test_file
    done

    # move to the next line: add the break
    echo >> test_file
}

echo -n > test_file

processLine 'ls'
processLine 'find . -name "*"' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T15:04:39.010

看起来很合理。它做你想做的事吗？

你可以简化一些事情，例如

```
DIFF=$(echo "$END - $START" | bc) 
```

可能只是

```
DIFF=$((END - START)) 
```

如果 END 和 START 是整数，并且如果您只打算使用它们一次，则无需将内容放入变量中。

如果它*没有按照*您的意愿执行，请编辑问题以描述问题（您看到它在做什么以及您希望它做什么）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T18:05:54.313

在后面加一行“ `echo >> file.csv`”`done`怎么样？还是您只想在每个 10 块之间有一个空行？然后您可以执行以下操作：

```
FIRST=1
processline()
{
  if (( FIRST )) then
    FIRST = 0
  else
    echo >> file.csv
  fi
  ...rest of code...
} 
```

否则，您可能想给出所需输出的示例以及您现在获得的输出。

# php - 为什么我在 Apache 上的文件权限被重置？

> ID：621925
> 
> 赞同：1
> 
> 时间：2009-03-07T14:47:06.337
> 
> 标签：php, apache, macos, permissions, chmod

我们最近从在工作中使用 PC 切换到 Mac，所以我对 *nix 做事方式很陌生。我运行的是 10.5 附带的默认 Apache，但我注意到当我将文件从 Windows 服务器拖到我的机器上时，权限发生了变化。具体来说，我正在将数据写入 XML 文件，偶尔在来回交换一些文件后，它会停止工作。

有人可以帮助我理解为什么会发生这种情况，以及如何强制 Windows 尊重原始文件权限（它们是在我创建文件时在我的机器上设置的），或者在文件被移动时应用一组不太安全的默认权限从 Windows 到 Mac？

需要注意的几个事实：

*   我正在使用[Cornerstone](http://www.zennaware.com/cornerstone/) Subversion 客户端。
*   如果您为我拼写出来，我可以使用终端。
*   最终，我通过[Transmit](http://www.panic.com/transmit/)将这些文件上传到另一个位置的 Linux 服务器。
*   我已经熟悉使用 Get Info 来更改文件权限，但也许我做错了什么。
*   我以 root 身份登录。（我知道，坏坏坏。）

我还应该提一下，我知道这是一个简单的问题，应该有一个简单的答案，但我在谷歌上上下搜索却没有找到。我需要你的帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T16:20:05.567

如果您可以拖放到终端，使用 cd 导航到包含因权限而无法工作的文件的文件夹，然后键入：ls -l（它们都是小写的 Ls），那将非常有帮助。

如果你从你的主文件夹开始，它看起来像这样：

```
macbookpro:~ artlogic$ cd Sites
macbookpro:Sites artlogic$ ls -l
total 8
drwxr-xr-x  6 artlogic  staff   204 Mar 11  2008 images
-rw-r--r--  1 artlogic  staff  2628 Mar 11  2008 index.html
macbookpro:Sites artlogic$ 
```

请将输出粘贴到此线程中。了解 Apache 将权限更改为什么会有所帮助。

附带说明一下，Apache 通常在与登录用户不同的用户和权限级别下运行，因此如果它以某种方式创建或覆盖文件，它可能会以这种方式更改权限。

# php - 使用 Pear 安装程序时 -a 和 -o 选项有什么区别？

> ID：621932
> 
> 赞同：0
> 
> 时间：2009-03-07T14:54:31.903
> 
> 标签：php, pear

当您使用 Pear 安装程序时，例如

```
pear install DB 
```

您可以使用 ' `-a`' 选项或 ' `-o`' 选项。

它们之间有什么区别？

* * *

@Ólafur Waage

我想问一下 all 和 only 之间的区别。

我无法理解它们是什么。

* * *

什么是“所有”依赖项和“唯一”依赖项？

它们之间有什么区别吗？

我的大脑无法区分它们。

* * *

好的，那么，我应该使用 ' `-a`' 选项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T15:02:30.120

我相信它们是和的简写`--alldeps`形式`--onlyreqdeps`

> PEAR 安装程序完全支持依赖项；如果您愿意，它可以自动安装必需的和/或可选的依赖项。

这是[PEAR 安装命令手册](http://pear.php.net/manual/en/guide.users.commandline.installing.php)

编辑：

每个人的作用都在手册中，但这是简介。

> 你有几个选择：
> 
> *   手动安装依赖包
>     
>     
> *   让 PEAR 只自动安装必要的依赖项
>     
>     
> *   让 PEAR 自动安装必要和可选的依赖项
>     
>     
> 
> **第一种方法可能是一个痛苦而令人生畏的过程，因为依赖包本身可能具有依赖关系。**
> 
> 其他两种方法都只需要切换到安装命令， --onlyreqdeps （仅安装所需的依赖项）或 --alldeps （安装所有依赖项）。

# c# - C#中的分号

> ID：621933
> 
> 赞同：42
> 
> 时间：2009-03-07T14:55:25.473
> 
> 标签：c#

为什么在 C# 中每一行的末尾都需要分号？为什么编译器不能只知道每行的结束位置？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-07T14:56:24.630

行终止符将使您能够跨多行中断语句。

另一方面，像 VB 这样的语言有一个*续行符*。我个人认为用分号终止语句比继续使用下划线要干净得多。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-07T14:57:54.797

不，编译器不知道换行符用于语句终止，也不应该知道。如果您愿意，它允许您将语句带到多行。

看：

```
string sql = @"SELECT foo
               FROM bar
               WHERE baz=42"; 
```

或者大型方法重载如何：

```
CallMyMethod(thisIsSomethingForArgument1,
             thisIsSomethingForArgument2,
             thisIsSomethingForArgument2,
             thisIsSomethingForArgument3,
             thisIsSomethingForArgument4,
             thisIsSomethingForArgument5,
             thisIsSomethingForArgument6); 
```

反之亦然，分号也允许多语句行：

```
string s = ""; int i = 0; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-07T14:57:29.243

这是几句话？

```
for (int i = 0; i < 100; i++) // <--- should there be a semi-colon here?
Console.WriteLine("foo") 
```

需要使用分号来消除歧义。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-07T14:57:01.303

因此，除了内部标识符和关键字等之外，空格并不重要。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-07T15:01:21.403

严格来说，这是真的：如果一个人可以弄清楚语句在哪里结束，那么编译器也可以。这还没有真正流行起来，很少有语言实现这种东西。VB 的下一个版本可能是第一种实现正确处理既不需要显式终止也不需要行继续的语句的语言 [ [source](http://www.panopticoncentral.net/archive/2008/02/27/22910.aspx) ]。这将允许这样的代码：

```
Dim a = OneVeryLongExpression +
        AnotherLongExpression
Dim b = 2 * a 
```

让我们保持手指交叉。

另一方面，这*确实*使解析变得更加困难，并可能导致错误的错误消息（参见 Haskell）。

也就是说，C# 使用类 C 语法的原因可能更多是出于市场原因：人们已经熟悉 C、C++ 和 Java 等语言。无需介绍另一种语法。出于各种原因，这是有道理的，但它显然继承了这些语言的许多弱点。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-07T15:09:48.280

我个人同意有一个独特的字符作为行终止符。它使编译器更容易弄清楚您要做什么。

与普遍的看法相反，编译器不可能 100% 的时间在没有帮助的情况下找出一个语句结束和另一个语句开始的位置！在某些极端情况下，无论是单个语句还是跨多行的多个语句都不清楚。

阅读Visual Basic 技术负责人 Paul Vick 的[这篇文章](http://www.panopticoncentral.net/archive/2008/02/27/22910.aspx)，了解为什么它不像听起来那么简单。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-07T15:45:02.890

可以办到。您所指的称为“分号插入”。JavaScript 在这方面取得了很大的成功，它没有在 C# 中应用的原因取决于它的设计者。也许他们不知道这件事，或者担心它会引起程序员的困惑。

有关 JavaScript 中分号插入的更多详细信息，请参阅指定 JavaScript 的[ECMA 脚本标准 262](http://www.ecma-international.org/publications/standards/Ecma-262.htm)。

我引用了第 22 页（在 PDF 中，第 34 页）：

> *   当程序从左到右解析时，遇到输入令牌流的末尾，解析器无法将输入令牌流解析为单个完整的 ECMA 脚本程序，则在末尾自动插入分号的输入流。
>     
>     
> *   当程序从左到右解析时，遇到语法的某些产生式允许的令牌，但产生式是受限产生式，并且该令牌将是紧接在注释之后的终端或非终端的第一个令牌"[no LineTerminator here]" with 在受限产生式中（因此这样的记号被称为受限记号），并且受限记号与前一个记号相隔至少一个 LineTerminator，然后在前面自动插入分号受限令牌。
>     
>     
> 
> 但是，前面的规则还有一个额外的覆盖条件：如果分号随后将被解析为空语句，或者如果该分号将成为 for 语句标题中的两个分号之一（部分12.6.3)。
> 
> [...]

规范文档甚至包含示例！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-08T15:07:03.550

使用分号的另一个很好的理由是隔离语法错误。当发生语法错误时，分号允许编译器回到正轨，这样就可以了

```
a = b + c = d 
```

可以消除歧义

```
a = b + c; = d 
```

第二个语句中的错误或

```
a = b + ; c = d 
```

第一个语句中的错误。如果没有分号，就不可能在出现语法错误的情况下说出语句的结束位置。缺少括号可能意味着程序的整个后半部分可能被视为一个巨大的语法错误，而不是逐行检查语法。

它也有助于另一种方式 - 如果你打算写

```
a = b; c = d; 
```

但是打错字并省略了“c”然后没有半成品它看起来像

```
a = b = d 
```

这是有效的，并且您运行的程序会出现错误且难以定位的错误，因此分号通常可以帮助捕获看起来像有效语法的错误。另外，我同意每个人的可读性。出于这个原因，我不喜欢使用没有某种语句终止符的语言工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-07T15:26:18.660

我一直在考虑这个问题，如果我可以猜测语言设计者的动机：

C# 显然有分号，因为它继承了 C。我最近一直在重读 K&R 的书，很明显 Dennis Ritchie 真的不想强迫程序员按照他认为最好的方式编码。这本书充斥着这样的评论，“尽管我们对此事并不教条，但似乎确实应该很少使用 goto 语句，如果有的话”，并且在关于函数的部分中，他们提到他们选择了许多格式样式中的一种，选择哪一个并不重要，只要保持一致即可。

因此，使用显式语句终止符允许程序员按照他们喜欢的方式格式化他们的代码。无论好坏，它似乎与 C 最初的设计方式一致：按照你的方式去做。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-07T19:53:00.110

我想说，在每条语句之后需要分号的最大原因是对于已经熟悉 C、C++ 和/或 Java 的程序员来说很熟悉。C# 继承了这些语言的许多语法选择，而不是简单地命名为与它们相似。以分号结尾的语句只是从这些语言中借用的众多语法选择之一。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-04-18T21:43:16.897

分号是 C 语言的遗留物，当时程序员经常希望通过在一行上组合语句来节省空间。IE

```
int i; for( i = 0; i < 10; i++ ) printf("hello world.\n"); printf("%d instance.\n", i); 
```

它还帮助了编译器，它不够聪明，无法简单地推断语句的结尾。在几乎所有情况下，出于可读性原因，大多数 c# 开发人员都不赞成将语句组合在一行中。上面的内容通常是这样写的：

```
int i;
for( i = 0; i < 10; i++ )
{
    printf("hello world.\n);
    printf("%d instance.\n", i);
} 
```

很啰嗦！对于现代语言，可以很容易地开发编译器来推断语句的结尾。C# 可以更改为另一种语言，该语言不使用除空格和缩进制表符以外的任何不必要的分隔符，即

```
int i
for i=0 i<10 i++
   printf "hello world.\n"
   printf "%d instance.\n" i 
```

这肯定会节省一些打字，而且看起来更整洁。如果使用缩进而不是空格，则代码变得更具可读性。如果我们允许类型被推断并做一个特殊的情况，我们可以做得更好，以读取，(for [value]=[initial value] to [final value:

```
for i=1 to 10  // i is inferred to be an integer
    printf "hello world.\n"
    printf "%d instance.\n" i 
```

现在，它开始看起来像 f# 和 f#，在某些方面，几乎像 c# 没有不必要的标点符号。但是 f# 缺少很多额外功能（例如特殊的 .NET 语言结构、代码完成和良好的智能感知）。因此，遗憾的是，最终 f# 可以比 c# 或 VB.NET 实现更多的工作。

就个人而言，我的工作需要 VB.NET，而且我更高兴不必处理分号。C# 是一种过时的语言。Linq 让我减少了必须编写的代码行数。不过，如果我有时间，我会编写一个具有 f# 的许多功能的 c# 版本。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-07T15:27:49.640

您可以准确地争辩说，要求使用分号来终止语句是多余的。从技术上讲，可以从 C# 语言中删除分号并使其仍然有效。问题是它为人类的误解留下了空间。我认为分号的必要性是为了人类而不是编译器的消歧。如果没有某种形式的语句定界，人类就很难解释这样的简洁语句：

```
int i = someFlag ? 12 : 5 int j = i + 3 
```

编译器应该能够很好地处理这个问题，但是对于人类来说，下面看起来要好得多

```
int i = someFlag ? 12 : 5; int j = i + 3; 
```

# css - 这是做绝对/相对/静态 CSS DIV 的方法吗？

> ID：621945
> 
> 赞同：0
> 
> 时间：2009-03-07T14:59:51.750
> 
> 标签：css

我想要一个居中的标题 DIV，并在其中包含以下绝对定位的 DIV：

*   标识
*   菜单
*   线
*   标题

但我的 HTML/CSS 有两个问题：

*   由于某种原因，页面现在更宽了（见底部滚动条）
*   如果我的标题更长，我当然希望它是右对齐的

我真正想要的是一个居中的 DIV，并且在其中我想将 DIV*绝对定位在其居中的父*级内（但不是绝对的，因为它们不会居中）。这可能吗？

你将如何完成这个布局？

[替代文字 http://tanguay.info/web/external/centeredLayoutProblem.png](http://tanguay.info/web/external/centeredLayoutProblem.png)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>

<style type="text/css">
    #headerArea {
        background-color: yellow;
        margin: 0px auto;
        width: 760px;
        height: 150px;
    }

    #logo {
        position: relative;
        top: 20px;
        left: 20px;
        background-color: orange;
        text-align: center;
        font-size: 32pt;
        width: 150px;
        padding: 10px;
        z-index: 10;
    }

    #menu {
        position: relative;
        top: -52px;
        right: -480px;
        background-color: tomato;
        text-align: center;
        font-size: 14pt;
        width: 240px;
        padding: 10px;
    }

    #title {
        position: relative;
        top: -35px;
        right: -620px;
        font-style: italic;
        font-size: 14pt;
    }

    #line {
        position: relative;
        top: -60px;
        border-bottom: 1px solid blue;
        margin: 0 20px;
    }
</style>

</head>

<body>
    <div id="headerArea">
        <div id="logo">LOGO</div>
        <div id="menu">One&nbsp;&nbsp;Two&nbsp;&nbsp;Three&nbsp;&nbsp;Four&nbsp;&nbsp;Five</div>
        <div id="title">This is the Title a Bit Longer</div>
        <div id="line"></div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T15:10:22.177

使您的#headerArea div 位置：相对。然后，对于所有内部 div，您可以定位：相对于#headerArea 的绝对值。

像这样：

```
<style type="text/css">
    #headerArea {
        position:relative;
        background-color: yellow;
        margin: 0px auto;
        width: 760px;
        height: 150px;
    }

    #logo {
        position: absolute;
        top: 20px;
        left: 20px;
        background-color: orange;
        text-align: center;
        font-size: 32pt;
        width: 150px;
        padding: 10px;
        z-index: 10;
    }

    #menu {
        position: absolute;
        top: 20px;
        left: 480px;
        background-color: tomato;
        text-align: center;
        font-size: 14pt;
        width: 240px;
        padding: 10px;
    }

    #title {
        position: absolute;
        top: 80px;
        left: 20px;
    width: 720px;
    text-align: right;
        font-style: italic;
        font-size: 14pt;
    }

    #line {
        position: absolute;
width: 720px; 
height: 1px;
        top: 70px;
        border-bottom: 1px solid blue;
        margin: 0 20px;
    } 
</style> 
```

您应该使用 'left' 属性而不是 'right' 因为 'right' 在 ie6 中不起作用。

我输入的 'left' 和 'top' 值可能有点偏，但你可以调整以获得你想要的。

**编辑：**

我已经更正了像素值，并为您的行 div 添加了宽度和高度，因为 IE 默认所有 div 都为一个文本行高。

此外，您的标题 div 应该是全宽的，并且 text-align right 以便标题将向左扩展而不是向右扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T15:11:57.180

是的。如果你这样做`#headerArea{position:relative;}`，你可以在孩子上拥有 position:absolute ，他们的位置将相对于父母。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T15:36:00.620

在标题上使用 position:relative （正如已经建议的那样），使其成为一个层，然后其中的绝对定位元素将使用该元素作为原点。

您可以在标记中将线放在徽标之前，然后无需使用 z-index 将徽标放在线的顶部。所有浏览器对 z-index 的处理方式不尽相同......

通过将标题放在右侧，它将根据需要向左扩展。

在行上使用上边框而不是下边框，这消除了 IE 想要使元素至少高一个字符的问题。

我删除了一些不必要的样式，并为页面添加了一个标题（因为这是正确的 html 文档中所要求的）。

这将在 Firefox 3、IE 7、IE 8、Opera 9 和 Chrome 1 中一致显示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://data.w3.org/1999/xhtml">
<head>
    <title>Title</title>

<style type="text/css">

body {
    margin: 0;
    padding: 10px;
}

#headerArea {
    position: relative;
    background: yellow;
    margin: 0 auto;
    width: 760px;
    height: 150px;
}

#headerArea div {
    position: absolute;
}

#logo {
    top: 20px;
    left: 20px;
    background: orange;
    text-align: center;
    font-size: 32pt;
    width: 150px;
    padding: 10px;
}

#menu {
    top: 20px;
    right: 20px;
    background: tomato;
    text-align: center;
    font-size: 14pt;
    width: 240px;
    padding: 10px;
}

#line {
    top: 80px;
    left: 20px;
    width: 720px;
    border-top: 1px solid blue;
}

#title {
    top: 90px;
    right: 20px;
    font-style: italic;
    font-size: 14pt;
}

</style>

</head>

<body>
    <div id="headerArea">
        <div id="line"></div>
        <div id="logo">LOGO</div>
        <div id="menu">One Two Three Four Five</div>
        <div id="title">This is the Title a Bit Longer</div>
    </div>
</body>
</html> 
```

（您可能需要调整位置以完全按照您的意愿进行定位，但这应该很容易。）

# actionscript-3 - Actionscript 类扩展并实现同名但类型不同的 getter/setter 属性

> ID：621947
> 
> 赞同：1
> 
> 时间：2009-03-07T15:02:23.680
> 
> 标签：actionscript-3

在 ActionScript 3.0 中，我想扩展 ClassA 并实现 InterfaceB。当 ClassA 和 Interface B 中都有“数据”属性但类型不同时，就会出现问题。我写，

```
public class MyClass extends ClassA implements InterfaceB {
    private var _data:Object;

    public function get data():Object {
        return _data;
    }

    public function set data(value:Object):void {
        _data = data;
    }
} 
```

Flex Builder 不会编译它并要求我重写在 ClassA 中定义的 getter/setter 方法，但重写 ClassA 中的数据属性不是我想要的。即使我为这两种方法都添加了覆盖，编译器也会抱怨覆盖不兼容，因为 ClassA 中的数据属性是字符串类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T15:09:26.267

这在 ActionScript 3.0 中是不可能的。您可以做的最好的事情是键入 Object 或不同数据类型共享的接口，并在派生类的 setter 中添加断言。

# charts - 将更新频率表示为图表的方法？

> ID：621954
> 
> 赞同：2
> 
> 时间：2009-03-07T15:04:41.990
> 
> 标签：charts, graph

我想创建一个表示网站更新频率的图表（例如，过去 5 年我在博客上发帖的频率）。一种明显的方法是绘制过去 60 个月的“每月发布的条目数”，但这并不令人满意。我应该考虑使用滚动平均值之类的东西吗？显示此类数据的良好可视化技术是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T15:13:33.900

一些想法：

*   滚动平均
*   而不是绘制帖子数量绘制帖子之间的时间（或滚动平均时间）
*   如果它可能具有年度/季节性成分，请尝试将其绘制在圆形/螺旋图上，其中 r 是基准，theta 是月、月中的日、年中的日或任何适当缩放的值。为 r 绘制的一些有趣的事情可能是
    *   间隔内的帖子数
    *   累积帖子（给你一个螺旋）
    *   帖子的长度，（给每个 theta 它自己的确切值，而不是汇总）
*   您可能还想查看散点图，其中包含 x 上的帖子长度、自上一个帖子以来的时间 + y 上的下一个帖子的时间，以及作为点的大小、灰度级或颜色的基准年龄 (淡出最旧的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T15:56:03.910

我认为[雷达图](http://en.wikipedia.org/wiki/Radar_chart)（或圆形区域图）将是一个不错的选择。[在Extreme Presentation(tm) Method](http://extremepresentation.typepad.com/blog/)网站上查看出色的[选择一个好的图表](http://extremepresentation.typepad.com/blog/2006/09/choosing_a_good.html)帖子和 PDF 图表选择指南。

# architecture - 在桌面应用程序中查看管理和选择

> ID：621956
> 
> 赞同：1
> 
> 时间：2009-03-07T15:06:25.493
> 
> 标签：architecture, desktop, front-controller

视图管理和选择通常如何在桌面应用程序中完成？我知道 FrontController 是 Web 应用程序中的一种流行模式，但我觉得它不太适合桌面应用程序，因为选择页面比选择嵌套子视图更容易。

我的主应用程序视图是否需要了解所有子视图并根据应用程序事件决定要显示哪些视图？我会为子组件实现子 MVC/MVP 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T16:11:43.717

在我一直在开发的 WinForm 应用程序中，我们将 MVP 用于单个视图（通常是 UserControls）。主窗体（通常是一些子窗体）利用可以显示用户控件的*表面*（在 CAB 中，这些被称为工作区，在我自己的应用程序中，我刚刚推出了自己的版本）。

工作区在运行时被添加到集合中。意见也是如此。因此，在您需要执行“显示”逻辑的任何地方，您都可以使用一行代码轻松完成，如下所示：

```
Workspaces[WorkspaceNames.MainWorkspace].Show(Views[ViewNames.EditEmployeeView]); 
```

# mysql - Count 树表中子节点的数量

> ID：621957
> 
> 赞同：2
> 
> 时间：2009-03-07T15:06:52.733
> 
> 标签：mysql, sql

我有一张倾斜的桌子，因为`tbltre` 表格结构就像：

```
`id` int(10) unsigned NOT NULL auto_increment,
`title` longtext NOT NULL, 
`parent` int(10) unsigned default '0' 
```

表格内容是这样的：

```
 id  Title  parent
.....................
    1   abc    0
    2   xyz    1
    3   pqr    1
    4   uuu    2 
```

要求的结果是 -

```
 id  title  no of childs
...........................
    1   abc     3
    2   xyz     1
    3   pqr     0
    4   uuu     0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T15:27:26.223

~~这应该给你你想要的~~ **编辑**它没有....请参阅下面的最后一个编辑：

```
select 
  parent.id, parent.title, count(child.id) 'number of children' 
from
  ttt parent left join ttt child
    on child.parent = parent.id
group by parent.id
order by parent.id; 
```

mysql的输出：

```
+----+-------+--------------------+
| id | title | number of children |
+----+-------+--------------------+
|  1 | abc   |                  2 |
|  2 | xyz   |                  1 |
|  3 | pqr   |                  0 |
|  4 | uuu   |                  0 |
+----+-------+--------------------+ 
```

**编辑：**至少在 MySQL 中，`ORDER BY`是[多余](http://dev.mysql.com/doc/refman/5.1/en/select.html)的：

> 如果您使用 GROUP BY，则输出行将根据 GROUP BY 列进行排序，就好像您对相同的列有一个 ORDER BY。为了避免 GROUP BY 产生的排序开销，添加 ORDER BY NULL

感谢您的提示，托马斯鲁特！

**编辑：**嗯，thaggie 指出，我遇到了一个没有仔细阅读这里的问题的情况。上面的答案只得到父母的孩子，而不是所有的后代。正如其他人所指出的，如果您使用的是 Oracle，您可以使用他们的[STARTS WTIH/CONNECT BY](http://www.oracle.com/technology/products/oracle9i/daily/oct04.html)语法。否则[这篇文章](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)可能会很有趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T15:19:13.920

这样的事情怎么样？

```
SELECT
  a.id,
  a.title,
  COUNT(*) AS children
FROM
  tbltree AS a
  INNER JOIN tbltree AS b ON
    b.parentid=a.id
GROUP BY
  a.id 
```

这只需要一个自连接，您可能希望在 tbltree.id 上为 GROUP BY 语句创建一个索引（假设您将它作为您的 PRIMARY），并在 tbltree.parentid 上创建一个索引以使此连接有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-07T08:46:26.557

希望这可以解决您的问题...为我工作

```
select F.id as Parent, F.Title ,Count(S.ID) as ChildCount 
from tbltree F 
left outer join tbltree S on F.id = S.Parent 
Group BY F.id ,F.Title 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T15:17:21.660

如果您使用的是 Oracle，我建议您使用 CONNECT BY，这会使查询变得简单。

您可能可以通过/拥有作为子选择来进行分组。

```
SELECT ID parent_id, TITLE, (
SELECT COUNT(ID) from tbltree group by ID having parent = parent_id) child_count
FROM tbltree; 
```

这是未经测试的，仅适用于树上的一层。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T15:17:38.400

我还没有喝咖啡，但你可能想尝试一些类似的东西

```
select 
    p.id, p.title, count(c.*) 
  from tbltree as c 
  left join tbltree as p 
  where p.id = c.parent 
  group by p.id
  order by p.id 
```

# amazon-web-services - 亚马逊高级 FPS 编程教程

> ID：621958
> 
> 赞同：1
> 
> 时间：2009-03-07T15:07:50.577
> 
> 标签：amazon-web-services

我正在努力为 Ruby 语言的 Amazon FPS 找到任何好的库，因此我正在寻找关于一个好的解释（亚马逊文档除外）的建议，或者可能是一个让我快速熟悉 Amazon FPS 的教程。

我正在寻找的是有关如何设置用户注册表单并进行定期付款的信息，这些付款向用户收取的金额各不相同。

我已经浪费了 4 个小时来浏览亚马逊文档，并且在坚持他们的信息时收到了很多错误，我得到的唯一结果就是饿了。

附带说明一下，我已经设置了沙盒企业账户，亚马逊不断通知我我没有设置沙盒企业账户。

有人可以将我重定向到一些有关使用 Amazon FPS 但与*蹩脚*的示例 FPS 应用程序和扭曲的亚马逊文档不同的有见地的资源吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T20:33:12.387

有一个名为 Remit 的 Ruby 库用于使用 Amazon Flexible Payment Service (FPS)，还有一篇博客文章介绍了某人使用它的经验和一些示例。我是 Stack Overflow 的新手，还不允许使用超链接 :) 但是如果您在 RubyForge 中搜索“remit”，并在 Google 中搜索字符串“Software as a Service with Amazon FPS using Remit for Ruby”，您应该能够找到它们. [在这里](http://edgenic.wordpress.com/2009/01/24/software-as-a-service-with-amazon-fps-using-remit-for-ruby/)找到它。

# python - 无法导入 python-mysqldb

> ID：621968
> 
> 赞同：2
> 
> 时间：2009-03-07T15:12:02.347
> 
> 标签：python, import, mysql

我使用安装了 python-mysqldb

```
sudo apt-get install python-mysqldb 
```

我尝试使用它没有成功。以下命令在 Python 提示符下不起作用：

```
import python-mysqldb 
```

或者

```
import mysqldb 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-07T15:13:48.083

包名称是“MySQLdb”。病例数。

# java - 如何绑定到这个 JList 以便我可以更改向用户显示的内容？

> ID：621974
> 
> 赞同：0
> 
> 时间：2009-03-07T15:14:39.390
> 
> 标签：java, swing, jlist

我有一个 JList，我想用它来显示一个从另一个表单添加的缓存列表，我已经完成了这个工作，我希望能够将缓存直接添加到列表中......有没有办法更改向用户显示的内容？还是只是将我的对象的 toString 方法制作成我想要显示的内容？

```
public void update(Observable o, Object arg)
{
    GeoGolfHole hole = (GeoGolfHole)arg;
    model.add(0, hole);
    jlHolesInGame.setText(Integer.toString(model.getSize()));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T15:18:28.540

你可以创建一个新的 ListCellRenderer 来呈现你想要的类。

# php - 在 PHP 中使用哪种压缩方法？

> ID：621976
> 
> 赞同：76
> 
> 时间：2009-03-07T15:17:21.910
> 
> 标签：php, compression, gzip

我有大量数据要使用两个 PHP 脚本移动：一个在客户端使用命令行 PHP 脚本，另一个在 Apache 后面。我将数据发布到服务器端并使用 php://input 流将其保存在网络服务器端。为了防止达到任何内存限制，每个 POST 请求的数据被分成 500kB 的块。这一切都很好。

现在，为了节省带宽并加快速度，我想在发送前压缩数据并在另一端接收时解压缩。我找到了 3 对可以完成这项工作的函数，但我无法决定使用哪一个：

*   [`gzencode`](http://php.net/manual/en/function.gzencode.php)/[`gzdecode`](http://php.net/manual/en/function.gzdecode.php)
*   [`gzdeflate`](http://php.net/manual/en/function.gzdeflate.php)/[`gzinflate`](http://php.net/manual/en/function.gzinflate.php)
*   [`gzcompress`](http://php.net/manual/en/function.gzcompress.php)/[`gzuncompress`](http://php.net/manual/en/function.gzuncompress.php)

您会推荐哪对功能，为什么？

**更新：**我刚刚阅读了 zlib 常见问题解答：

*gzip 格式 ( `gzencode`) 旨在保留有关单个文件的目录信息，例如名称和最后修改日期。`gzcompress`另一方面，zlib 格式（*

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-03-07T15:24:43.330

所有这些都可以使用。三者之间存在细微差别：

*   [**gzencode()**](http://php.net/manual/en/function.gzencode.php)使用 GZIP 文件格式，与`gzip`命令行工具相同。此文件格式有一个包含可选元数据、DEFLATE 压缩数据的标题和包含 CRC32 校验和和长度检查的页脚。
*   [**gzcompress()**](http://php.net/manual/en/function.gzcompress.php)使用 ZLIB 格式。它有一个较短的标头，仅用于识别压缩格式、DEFLATE 压缩数据和一个包含 ADLER32 校验和的页脚。
*   [**gzdeflate()**](http://php.net/manual/en/function.gzdeflate.php)自己使用原始的 DEFLATE 算法，这是其他两种格式的基础。

这三者都在底层使用相同的算法，因此它们在速度或效率上不会有差异。 `gzencode()`添加了包含原始文件名和其他环境数据的功能（仅在压缩字符串时未使用）。 `gzencode()`并且`gzcompress()`两者都添加了校验和，因此可以验证存档的完整性，这对于不可靠的传输和存储方法很有用。如果所有内容都存储在本地并且您不需要任何其他元数据，那么`gzdeflate()`就足够了。对于可移植性，我推荐`gzencode()`（GZIP 格式），它可能比`gzcompress()`（ZLIB 格式）在其他工具中得到更好的支持。

当压缩非常短的字符串时，每种方法的开销变得相关，因为对于非常短的输入，开销可能包括输出的重要部分。每种方法的开销，通过压缩一个空字符串来衡量，是：

*   `gzencode('')`= 20 字节
*   `gzcompress('')`= 8 个字节
*   `gzdeflate('')`= 2 个字节

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-07T16:13:42.103

我不是 PHP 专家，无法回答提出的问题，但这里似乎有很多猜测，并且提供了模糊的信息。

DEFLATE 是 ZLIB、GZIP 等使用的压缩算法的名称。理论上，GZIP 支持替代压缩算法，但实际上，没有。

没有“GZIP 算法”之类的东西。GZIP 使用 DEFLATE 算法，并在压缩数据周围放置成帧数据。使用 GZIP，您可以添加文件名、文件时间、CRC 甚至注释等内容。不过，此元数据是可选的，许多 gzippers 只是省略了它。

ZLIB 与此类似，只是具有不同的、更有限的元数据集和特定的 2 字节标头。

这一切都在 IETF [RFC](http://www.ietf.org/rfc/rfc1952.txt) [1950、1951](http://www.ietf.org/rfc/rfc1950.txt)和[1952](http://www.ietf.org/rfc/rfc1951.txt)中。

说“gzip 算法比 DEFLATE 压缩得更好”纯属无稽之谈。没有gzip算法。GZIP 格式中使用的算法**是 DEFLATE**。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-07T15:27:19.080

所有方法本质上都是相同的，它们之间的区别主要在于标题。我个人会使用 gzencode，这将产生等于对 gzip 实用程序的命令行调用的输出。

# vb.net - 在 VB.NET 中需要一个类似 Excel 的网格

> ID：621984
> 
> 赞同：3
> 
> 时间：2009-03-07T15:19:58.147
> 
> 标签：vb.net, excel, gridview

我正在 VB.NET 中设计一个可以使用类似 Excel 的网格的程序。我希望网格能够处理单元格的合并和取消合并。建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T15:23:02.287

这个 Stack Overflow 问题包含一些可能有用的答案：

[.NET 的最佳第三方 WinForms 网格是什么？](https://stackoverflow.com/questions/144338/what-is-the-best-third-party-winforms-grid-for-net)

您可以尝试[Syncfusion 的 grid](http://www.syncfusion.com/products/grid/windows/default.aspx)，它允许单元格合并。

> 合并单元格允许用户将具有相似值的相邻单元格显示为单个单元格。合并是动态的。如果单元格的值发生变化，网格将自动调整合并的单元格。

[替代文字 http://www.syncfusion.com/products/Grid/Windows/features/General_Features/images/gridmergedcells.png](http://www.syncfusion.com/products/Grid/Windows/features/General_Features/images/gridmergedcells.png)

或[XtraGrid (DevExpress)](http://www.devexpress.com/Products/NET/Controls/WinForms/Grid/)：

> 您可以使用 XtraGrid 的自动单元格合并功能来增强数据的可读性。启用后，具有相同值的相邻列单元格将合并到一个单元格中。如果对列进行了排序，则单元格合并具有分组数据的效果 - 列中的单元格数量将匹配其包含的唯一值的数量。

[![替代文字](https://i.stack.imgur.com/azkw8.png)](https://i.stack.imgur.com/azkw8.png)
[（来源：[devexpress.com](https://www.devexpress.com/Products/NET/Controls/WinForms/Grid/i/features/gridview_cellmerging.png)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T17:58:44.340

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)是一个与 Excel 兼容的电子表格组件，其中包括一个支持许多[Excel 兼容功能](http://www.spreadsheetgear.com/products/spreadsheetgear.net.aspx)（包括合并单元格）的[Windows 窗体电子表格控件。](http://www.spreadsheetgear.com/support/samples/windowsforms.aspx)

[您可以在此处](https://www.spreadsheetgear.com/downloads/register.aspx)下载免费评估。

免责声明：我拥有 SpreadsheetGear LLC

# .net - 将窗口焦点恢复到以前的所有者

> ID：621998
> 
> 赞同：4
> 
> 时间：2009-03-07T15:31:04.717
> 
> 标签：.net, windows, winapi

我有一个位于系统托盘中的应用程序，双击它会打开一个窗口，相当标准；但是，当您关闭窗口时，我希望在打开我的窗口*之前*聚焦的窗口重新获得焦点。

如果我通过键盘快捷键弹出我的窗口，我可以通过`GetForegroundWindow`在我的窗口显示之前使用 API 调用来恢复之前对关闭的关注，然后`SetForegroundWindow`在我的窗口关闭后的方法（使用第一次调用的值）来恢复重点。当您通过系统托盘打开窗口时，这不起作用，因为用户基本上已经使系统托盘成为焦点。

我尝试使用 、 和 的组合`GetForegroundWindow`来`GetWindow`尝试`GetTopMostWindow`导航 z 顺序以找到系统托盘之后的第二个窗口（假设系统托盘将跳到顶部，所以逻辑上是下一个将是原来的前面）。虽然我没有取得任何成功，但这些函数的结果毫无用处，因为它们似乎没有给我任何逻辑结构。

有人对我如何实现这一目标有任何想法吗？

我曾考虑过某种后台观察器，它只是坐下来监视前窗并存储指向它的指针，但这充其量只是不稳定的。

这是在 Windows 上（我个人在 x64 Server 2008 上）和 .Net 3.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T21:06:45.877

尽管这可能是一个很好的可用性功能，但您可能知道在 Windows 7 中，托盘将在桌面上获得（非常）不那么显眼的位置。

实际执行此操作的唯一方法是监视 Windows 消息并跟踪在您的应用程序获得焦点之前哪个窗口具有焦点。除了 AFAIK，您无能为力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-03T19:04:55.733

我这样做是为了返回上一个窗口

```
SendKeys.Send("%{TAB}"); 
```

我知道这不是“解决方案”，而是在某种程度上达到目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T17:41:26.650

我查看了所有系统托盘图标，它们的行为与您的程序相同。搞乱 Windows 焦点管理很麻烦，在尝试更改标准行为之前，您可能需要三思（或更多）。`*****