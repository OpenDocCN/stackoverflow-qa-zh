# StackOverflow 问答 11434000-11434999

# php - 未定义索引

> ID：11434000
> 
> 赞同：-2
> 
> 时间：2012-07-11T13:42:45.060
> 
> 标签：php

我将一个在 Internet 上运行良好的服务器上的文件传输到我的本地计算机。

它为我的变量抛出了很多未定义的索引，

请告诉我可能是什么问题，因为它在互联网上运行良好而在本地无法运行

以下是错误和相关代码

> 未定义索引：/Users/mgltd/Sites/reacheasy/youraccount.php 第 38 行的注释 警告：date()：依赖系统的时区设置是不安全的。你是*需要*使用 date.timezone 设置或 date_default_timezone_set() 函数。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。我们在第 39 行的 /Users/mgltd/Sites/reacheasy/youraccount.php 中为 'BST/1.0/DST' 选择了 'Europe/London'

编码

```
<?php
    $submit = $_POST['Add'];
    //form data
    $Sname = mysql_real_escape_string(htmlentities(strip_tags($_POST['Sname'])));
    $Pname = mysql_real_escape_string(htmlentities(strip_tags($_POST['Pname'])));
    $Pidno = mysql_real_escape_string(htmlentities(strip_tags($_POST['Pidno'])));
    $Psize = mysql_real_escape_string(htmlentities(strip_tags($_POST['Psize'])));
    $Pcolour = mysql_real_escape_string(htmlentities(strip_tags($_POST['Pcolour'])));
    $Pquantity = $_POST['Pquantity'];
    $Weblink = mysql_real_escape_string(htmlentities(strip_tags($_POST['Weblink'])));
    $Price = mysql_real_escape_string(htmlentities(strip_tags($_POST['Price'])));
    $comment = mysql_real_escape_string(htmlentities(strip_tags($_POST['comment'])));
    $date = date("Y-m-d");
    //echo " ('','$Sname','$Pname','$Pidno','$Psize','$Pcolour','$Pquantity','$Weblink','$Price','$Uname')";
    if('POST' === $_SERVER['REQUEST_METHOD'])
    {
    if ($Sname&&$Pname&&$Pidno&&$Weblink&&$Price)
    {
    if (is_numeric($Price))
    {
        $repeatheck = mysql_query("SELECT * FROM repplac WHERE Uname = '{$_SESSION['username']}' AND Pidno ='$Pidno' AND Sname='$Sname' AND Pname='$Pname'");
        $count = mysql_num_rows($repeatheck);
    if($count!=0)
    {
        die ('PRODUCT ALREADY IN BASKET YOU CAN INCREASE OR DECREASE QUANTITY, <a href="youraccount.php">CLICK TO GO BACK TO YOUR LIST</a>');
    }
    else
    //echo'$Price';
    $tprice = $Price * $Pquantity;
    //echo"$tprice";
    $queryreg = mysql_query("
    INSERT INTO repplac VALUES ('','$Sname','$Pname','$Pidno','$Psize','$Pcolour','$Pquantity','$Weblink','$Price','$comment','$tprice','$date','{$_SESSION['username']}','')
    ")or die(mysql_error());
    }
    else
    echo 'price field requires numbers';
    }
    else
    echo 'please fill in all required * fields ';
    }
    ?>
    <form action='youraccount.php' method='Post' class='ilistbar'>
        <!--<div>
        <label for='shoppinglist' class='fixedwidth'></label>
        <textarea type='text' name='shoppinglist' id='username' cols='100' rows='15'></textarea>
        </div> -->
        <div>
        <label for='Sname' class='fixedwidth'> * Shop name</label>
        <input type='text' name='Sname' id='Sname'/>
        </div>
        <div>
        <label for='Pname' class='fixedwidth'> * Product name</label>
        <input type='text' name='Pname' id='Pname'/>
        </div>
        <div>
        <label for='Pidno' class='fixedwidth'> * Product id no /ad reference</label>
        <input type='text' name='Pidno' id='Pidno'/>
        (This should be unique for each product)
        </div>
        <div>
        <label for='Psize' class='fixedwidth'>Product size</label>
        <input type='text' name='Psize' id='Psize'/>
        </div>
        <div>
        <label for='Pcolour' class='fixedwidth'>Product colour</label>
        <input type='text' name='Pcolour' id='Pcolour'/>
        </div>
        <div>
        <label for='Pquantity' class='fixedwidth'>Product quantity</label>
        <select name="Pquantity" id="Pquantity">
         <option value="1">1</option>
         <option value="2">2</option>
         <option value="3">3</option>
         <option value="4">4</option>
         <option value="5">5</option>
         <option value="6">6</option>
         <option value="7">7</option>
         <option value="8">8</option>
         <option value="9">9</option>
         <option value="10">10</option>
    </select>
    (You can update quantity in excess of 10 on the shopping list below)
        </div>
        <div>
        <label for='Weblink' class='fixedwidth'> * Web link</label>
        <input type='text' name='Weblink' id='Weblink'/>
        </div>
        <div>
        <label for='Price' class='fixedwidth'> * Price GBP</label>
        <input type='text' name='Price' id='Price'/>
        Please valid format is (.) for decimal
        </div>
        <div>
        <label for='comment' class='fixedwidth'> Extra info</label>
        <input type='text' name='comment' id='comment'/>
        Please give different colours , sizes of the same products,discount codes, and other information that you would like us to use
        </div>
        <div>

        <div class='buttonarea'>
                <p>
                <input type='submit' name='submit' value='Add'>
                </p>
                </div>
                </p>
        </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T13:45:48.343

我会将 php-block 包装在 if 的顶部：

```
if( isset($_POST['submit']) ){ 

    // Rest of the code that populates the variables and so on

} 
```

这将确保您不会尝试对甚至不存在的值进行操作。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T13:45:18.610

好吧，看起来`$_POST`超全球没有填充（你检查过这个吗？）或者，至少，它不包含你认为它所做的。

您的代码似乎在没有检查的情况下假设 POST 值。

运行`print_r($_POST)`- 它是否包含正确的数据？

# javascript - javascript中2列复选框的2个按钮

> ID：11434004
> 
> 赞同：0
> 
> 时间：2012-07-11T13:43:08.953
> 
> 标签：javascript, asp-classic, checkbox

我正在使用 ASP 经典，并且我的页面上已经有一个按钮可以选择所有复选框，但是当我尝试制作另一个按钮时，这个新的“Button2”选择所有复选框，我需要该按钮 1 勾选第一列和button2 检查第二个。柱子。提前致谢。 ![在此处输入图像描述](../Images/8c623b8bf4e1e0cebd611a7cf70e457d.png)

这是 button2 "Todos sin sup" 的 HTML：

```
<td>
<td align="right" colspan="10"><input type="button"
    name="btn_seleccionar_todo_sin_sup"  value="Todos sin sup" onclick="javascript:marcar
    (this.form);">
</td>   
</td> 
```

Javascript函数：

```
function marcar()
{
    var aa= document.getElementById('entregas');
    if (checked == false)
    {
        checked = true
    }
    else
    {
        checked = false
    }
    for (var i =0; i < aa.elements.length; i++) 
    {
        aa.elements[i].checked = checked;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:43:15.803

问题是*所有*的复选框都在一个名为“entregas”的容器内。

当您的`for`循环遍历元素并`id="entregas"`停止时`aa.elements.length`，您将仅将要检查按钮 1 的`id="entregas"`复选框包装在一个元素中，然后仅将要检查按钮 2 的复选框包装在另一个元素中，例如`id="entregas2"`。然后创建一个名为的新函数，例如`marcar2()`.

更改此行`marcar2()`：

```
var aa = document.getElementById('entregas2'); 
```

然后将此 HTML 用于按钮 2：

```
<input type="button" id="entregas2" value="Button 2" onclick="javascript:marcar2()" /> 
```

# iphone - 在项目中处理 JSON 响应

> ID：11434007
> 
> 赞同：0
> 
> 时间：2012-07-11T13:43:16.853
> 
> 标签：iphone, ios, json

我是一个新程序员。我从服务器收到以下响应。我如何从以下获得 0 索引“比尤特的一英里高电机”和“迪利恩的英里高电机”的值

谢谢

```
{
dealer =     (
            {
        0 = "Mile High Motors of Butte";
        1 = "3883 Harrison";
        2 = Butte;
        3 = 59701;
        4 = MT;
        5 = "http://www.buttesmilehighchryslerjeepdodge.com";
        6 = 2;
        7 = 0;
        address = "3883 Harrison";
        city = Butte;
        distance = 0;
        id = 2;
        name = "Mile High Motors of Butte";
        state = MT;
        url = "http://www.buttesmilehighchryslerjeepdodge.com";
        zip = 59701;
    },

           {
        0 = "Mile High Motors of Dillon";
        1 = "790 N Montana St";
        2 = Dillon;
        3 = 59725;
        4 = Montana;
        5 = "http://www.MileHighDillon.com";
        6 = 13;
        7 = "60.1235269593172";
        address = "790 N Montana St";
        city = Dillon;
        distance = "60.1235269593172";
        id = 13;
        name = "Mile High Motors of Dillon";
        state = Montana;
        url = "http://www.MileHighDillon.com";
        zip = 59725;
    }
);
success = 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:52:23.570

好的，让我们看看你的结构（假设你已经反序列化了你的 JSON 字符串）。你有一个`NSDictionary`带有两个键（`dealer`& `success`）的。现在`dealer`key 是 a `NSArray`with two `NSDictionaries`。因此，基于此我们可以这样做：

```
NSDictionary *myJson; // Assuming that this is what you have posted

NSArray *dealers = [myJson valueForKey:@"dealer"];

// Now just grab whatever you need

NSString *dealerOne = [[dealers objectAtIndex:0] valueForKey:@"0"]; //Mile High Motors of Butte
NSString *dealerTwo = [[dealers objectAtIndex:1] valueForKey:@"0"]; //Mile High Motors of Dillon 
```

或者你可以像这样迭代你的`dealers`数组：

```
for (NSDictionary *dealer in dealers)
{
  NSString *dealerName = [dealer valueForKey:@"0"];
  // Do something useful
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:09:32.090

```
 NSMutableArray yourStringArray= [[NSMutableArray alloc] init]; //for getting texts what you want.  
    NSArray * array1 = [yourDictionary valueForKey:@"dealer"];// You will get array which has dictionary elements.
    for (NSDictionary *dealer in array1)// Write loop for getting your string.
    {
      NSString *dealerName = [dealer valueForKey:@"0"];
     [yourStringArray addObject:dealerName];
    } 
```

I think it will be helpful to you.

# hibernate - 使用具有相同属性但具有多个值的 findBy

> ID：11434008
> 
> 赞同：0
> 
> 时间：2012-07-11T13:43:24.343
> 
> 标签：hibernate, grails-orm, grails-domain-class

我有一个产品域：

```
Product {
   String name 
} 
```

现在我需要`issuedProductInstance`和`requestedProductInstance`。为此我`findBy`用作

```
def find(String issuedProduct,String requestedProduct){
    Product issuedProductInstance=Product.findByName(issuedProduct)
    Product requestedProductInstance=Product.findByName(requestedProduct)
} 
```

通过这种方式，该方法两次命中 DB。有什么方法可以通过只执行一个查询来找到这两种产品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:47:58.143

不了解 grails，但您只需要以下查询：

```
select p from Product p where p.name in (:names) 
```

当然，此查询可能返回 0、1 或 2 个产品，您必须遍历列表才能知道哪个是名称为“issuedProduct”的产品，哪个是另一个。

# java - Spring JDBC 和 Oracle Db 驱动程序连接

> ID：11434010
> 
> 赞同：0
> 
> 时间：2012-07-11T13:43:31.503
> 
> 标签：java, sql, oracle, spring

我是 Spring 框架的新手，并尽力理解。我正在为我的操作使用 Spring NamedParameterJDBC 模板

我在 DAO 中有这段代码

```
SqlParameterSource paramSource = new BeanPropertySqlParameterSource(
            positionDO);
KeyHolder keyHolder = new GeneratedKeyHolder();
return this.jdbcTemplate.update(sql, paramSource, keyHolder); 
```

问题是当我执行时，我收到了这个错误

```
 org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL 
[INSERT INTO POSITION_TABLE VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?)]; SQL state [null]; 
error code [0]; 
java.lang.AbstractMethodError: oracle.jdbc.driver.OracleConnection.prepareStatement(Ljava/lang/String;I)
Ljava/sql/PreparedStatement; 
```

我用谷歌搜索，发现这是像 ojdbc14 这样的旧 Ojdbc 驱动程序的问题，它不发送自动生成的密钥。现在我无法找到如何通过 Spring 或任何其他方式加载最新的 ojdbc 驱动程序来执行相同的操作。

我假设 spring-jdbc 将具有默认的 ojdbc 驱动程序。我对么？因为我没有在我的项目中添加任何其他驱动程序。

--> 没有自动生成密钥，整个过程工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T16:19:13.037

您的 Java 和 ojdbc 版本可能不匹配。由于 JDBC 是 JavaSE 的一部分，因此您的 JavaSE 版本和 ojdbc 版本必须匹配。

ojdbc14 → Java 1.4

ojdbc5 → Java 1.5

ojdbc6 → Java 1.6

如果您的 ojdbc 驱动程序比您的 JavaSE 版本更新，那么一切应该仍然有效。您可以从 [Oracle 下载页面](http://www.oracle.com/technetwork/database/features/jdbc/index-091264.html)获取 Oracle JDBC 驱动程序。不幸的是，您不会在 Maven 中心找到它们，因此您需要手动将它们部署到您的 Maven 存储库。

如果您想搜索您的 ojdbc 驱动程序依赖项，请使用

```
mvn dependency:tree 
```

如果它不存在并且没有与您的工件（WAR 或 EAR）打包，那么它可能来自您的应用程序服务器或类似服务器。

# django - Django：使用小部件来限制 ModelForm 中的选择

> ID：11434011
> 
> 赞同：4
> 
> 时间：2012-07-11T13:43:33.263
> 
> 标签：django, forms, widget

我的模型形式继承自子系统形式。我想限制表单中用户的选择。（特别是名字）我知道我必须使用小部件。但它不起作用。

我必须使用 SubsytemForm。

```
SUBSYSTEM_CHOICES = (a1,a2,a3)

class Subsystem(models.Model):
    name = models.CharField("Name", max_length=20)

class SubsytemForm(forms.ModelForm):   
    class Meta:
        model = Subsystem
        widgets = {
            'name': ChoiceField(widget=RadioSelect, choices=SUBSYSTEM_CHOICES)
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T13:53:17.330

来自[django 模型表单文档](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/)：

> 如果你像这样显式地实例化一个表单域，Django 假设你想要完全定义它的行为；因此，默认属性（例如 max_length 或 required）不是从相应的模型中提取的。如果要保持模型中指定的行为，则必须在声明表单字段时显式设置相关参数。

您可以尝试：

```
class SubsytemForm(forms.ModelForm):  
    name =  forms.ChoiceField(widget=RadioSelect, choices= choices )
    class Meta:
        model = Subsystem 
```

你也可以

```
class SubsytemForm(forms.ModelForm):  
    class Meta:
        model = Subsystem
    def __init__(self, *args, **kwargs):
        self.name_choices = kwargs.pop('name_choices', None)
        super(SubsytemForm,self).__init__(*args,**kwargs)
        self.fields['name'].queryset= self.name_choices 
```

并在创建`name_choices`时作为参数发送。`SubsytemForm`请记住，选择应该是一个查询集。

另外，您应该阅读[如何在 Django ModelForm 中过滤 ForeignKey 选择？](https://stackoverflow.com/questions/291945/how-do-i-filter-foreignkey-choices-in-a-django-modelform)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T14:56:08.930

`SUBSYSTEM_CHOICES`不是属性的有效值，`choices`因为它没有键/值对。你需要类似的东西：

```
SUBSYSTEM_CHOICES = (
    (a1, 'a1 Display'),
    (a2, 'a2 Display'),
    (a3, 'a3 Display'),
) 
```

# css - IE的奇怪浮动问题

> ID：11434020
> 
> 赞同：0
> 
> 时间：2012-07-11T13:44:11.253
> 
> 标签：css, html

我正在为我的 php 类做一个站点，并且刚刚完成我的项目，除了 IE 中的一个奇怪的浮动问题。我只是左右浮动，但该网站似乎正在向左清除，不确定为什么 IE 会导致此问题。有什么建议么？[http://ectweb.cs.depaul.edu/AHARDEN2/project/index.php](http://ectweb.cs.depaul.edu/AHARDEN2/project/index.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:48:21.220

这可能是因为 IE8 及更低版本无法识别`<nav>`,等标签`<section>`。因此，它们与您的 CSS 选择器不匹配，例如`nav ul li a {...}`

尝试重写您的 CSS 以不在其选择器中使用这些标签。

旁注：IE9 工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:00:43.030

您可以尝试像这样添加一个 CSS 重置：http: [//meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

还有一个像这样的 html5 shiv： [http ://code.google.com/p/html5shiv/](http://code.google.com/p/html5shiv/)

# .net - 右对齐文本框内的文本

> ID：11434024
> 
> 赞同：5
> 
> 时间：2012-07-11T13:44:22.620
> 
> 标签：.net, winforms, textbox

我希望我需要设置一个属性来对齐 TextBox 内的文本，但我找不到它。我记得在 ASP.net 中使用过 [style="text-align:right"]，但我在 WinForms 中使用了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T13:46:25.707

[您可以使用Horizo](http://msdn.microsoft.com/en-us/library/system.windows.forms.horizontalalignment.aspx) ​​ntalAlignment枚举器更改[TextAlign属性。](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.textalign.aspx)尝试类似：

```
textBox1.TextAlign = HorizontalAlignment.Right; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T13:46:35.650

使用[Textalign](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.textalign.aspx)属性。它使用[水平对齐枚举](http://msdn.microsoft.com/en-us/library/system.windows.forms.horizontalalignment.aspx)，它将为您提供左对齐、右对齐或居中对齐。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T13:48:10.580

可能是 TextAlign 属性：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.textalign](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.textalign)

# android - Activity 实例的生命周期

> ID：11434025
> 
> 赞同：2
> 
> 时间：2012-07-11T13:44:22.873
> 
> 标签：android, android-activity, android-lifecycle

我有以下活动：

```
public class StartActivity extends Activity
{
    String str = "somestring";
    int number = "1";

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Code here
    }
} 
```

[我在 Android 文档（ http://developer.android.com/reference/android/app/Activity.htm](http://developer.android.com/reference/android/app/Activity.htm) l）上阅读了以下内容

*如果一个活动被另一个活动完全遮挡，它就会停止。它仍然保留所有状态和成员信息，但是，它不再对用户可见，因此它的窗口是隐藏的，并且当其他地方需要内存时，它通常会被系统杀死。*

这是否意味着我的类实例（**str**和**number**）是“活动的”并且可用，除非调用**onDestroy或调用****onPause**或**onStop**后需要内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:56:55.937

如果在您的调用者活动中，您已经调用`finish()`了方法，那么由于您完成了调用者活动，因此之前的活动实例将不会处于活动状态。所有实例都将被垃圾收集。

但是，如果您的调用者活动没有调用`finish()`，那么该活动将不再可见，但它将出现在操作系统维护的活动堆栈上。调用者活动（即前一个活动）可能会在设备内存不足的情况下完成，例如：如果活动调用相机（需要丰富的资源），在这种情况下，前一个活动可能会被破坏。

因此，在您的情况下，即使`StartActivity`不是当前可见的活动，变量也将是活动的。

# python - 如何将由 namedtuple 创建的元组子类转换为元组本身？

> ID：11434026
> 
> 赞同：2
> 
> 时间：2012-07-11T13:44:26.503
> 
> 标签：python, tuples, namedtuple

我正在使用 python，而某些方法需要元组作为其参数。虽然namedtuple创建的instance是tuple的子类，但是看来还是需要把它转成tuple。
有什么办法可以快速将namedtuple制作的tuple子类转换为tuple？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T13:50:10.563

可以使用将`namedtuple`实例`x`转换为元组`tuple(x)`，但您不需要这样做。如果某些代码只接受元组，但不接受`namedtuple`s，我认为该代码已损坏。（*可能*有特殊情况需要这种行为，但我现在想不出。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T13:51:58.477

好吧，如果我理解正确的问题，您可以使用您的 namedtuple 作为参数来实例化元组：

```
>>> T = namedtuple('T', 'x y')
>>> isinstance(tuple(T(1, 2)), tuple)
True
>>> 
>>> tuple(T(1,2))
(1, 2) 
```

# java - 为此用例选择最高效的 JSON 库

> ID：11434028
> 
> 赞同：1
> 
> 时间：2012-07-11T13:44:42.167
> 
> 标签：java, json, jsf, gson

我有一个 JSF 网格类型组件，其中每个单元格都是可单独编辑的，每个单元格的数据都包含在一个名为 DataObject(DO) 的 POJO 中。DO的结构是这样的：

```
public class DO {

 //Id should be the coordinate. eg x@y . x is the row position and y is the column  position
 private String id;
 //This is value that goes to the client after applying formatter
 private Object value;
 //flag to indicate whether the cell will be disabled
 private boolean disabled;
 //flag to indicate whether the cell will be rendered
 private boolean rendered=true;
//Editor type for the cell
private String editorType;

} 
```

所以基本上`id`字段标识网格中的单元格位置（行和列）。

现在在我们的例子中，我们可以有一个 1000 行 X 100 列的网格，其中网格本身最初是稀疏填充的，这意味着大多数单元格最初不包含任何 DO。因此，大约 30% 的单元格将包含数据，其余的将不包含任何数据。我需要通过 ajax 将 JSON 格式的数据从服务器传递到客户端 javascript。这个想法是遍历 DO 的集合并构造 JSON String 。

因此，包含两个单元格数据的网格的 JSON 看起来像这样：

```
{
  id1 : {
  editorType:'InputEditor',
  value:'1234123',
  disabled:'false',
  rendered:'true'
  },

 id2 : {
 editorType:'SomeCustomEditor',
 value:'23456',
 disabled:'true',
 rendered:'true'
  }
 } 
```

我可以在这里使用哪些现有的 JSON Java 库以最有效的方式生成此输出 JSON？任何示例代码都会在这里有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:33:11.963

我已经为非常高速的消息传递过程测试了许多（到/从）JSON 解析器，应用程序必须每秒发送 200*100 条消息。由于 UI 是 JavaScript（和 websocket）——我们决定使用 JSON。我们从 JSONObject 开始——它失败了。

我脑子里没有数字，但这里是这些 API 的相对速度：（
最快）**`Jackson > Gson >>> JSONObject`**（最慢）

1.  [杰克逊](http://jackson.codehaus.org/)
2.  [格森](http://code.google.com/p/google-gson/)
3.  [JSON对象](http://www.json.org/javadoc/org/json/JSONObject.html)

我们计划评估[json-smart](http://code.google.com/p/json-smart/wiki/Benchmark)，但在 Jackson 上得到了不错的表现——所以停止了。如果您正在使用它并计划运行基准测试。包括这个。我们观察到的唯一问题是这似乎不太受欢迎，因此我们犹豫使用它来避免没有人听的角落案例故障。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:05:35.743

对于这么多数据，您应该考虑使用 JSON 以外的其他内容。

*   您可以推出自己的二进制格式；例如，4 个字节用于数字，1 个字节用于 2 个标志和一个代码编号用于编辑器类型，每个 1 个字节用于 id 的每个字符。

*   您可以使用 Google protobufs。这将为您提供紧凑的二进制格式，并以多种语言生成消息解析器和反解析器。

您对数据的 JSON 编码大约是每个非空单元格 90 个字节，而二进制格式的每个非空单元格可能需要 15 个字节。解析和反解析的开销会少得多。

# php - PHP：我应该如何将这个不一致的字符串转换为数组？

> ID：11434029
> 
> 赞同：0
> 
> 时间：2012-07-11T13:44:46.853
> 
> 标签：php, arrays, string, delimiter

我有这个字符串：（`$delims = ',^.;:\t'`在`preg_replace()`调用中使用）。
我需要两个数组.. 一个以这些分隔符作为索引 ( `$delimCount`)，另一个以这些分隔符作为值 ( `$delimiters`)。

前者将从后者的循环中获取分配的值.. 如下所示：

```
foreach ($delimiters as $delim) { 
    if( strpos($char, $delim) !== false) { // if the char is the delim ...
        $delimCount[$delim]++; // ... increment
    }
} 
```

我现在拥有它的方式很混乱，我想简单地将那个字符串分成两个数组......但我被`\t`分隔符绊倒了（因为它是唯一一个有两个字符的）。
我该如何/应该如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:01:10.600

我将如何处理你的`\t`分隔符

```
$delims = ',^.;:\t';

$i = 0;

while($i < strlen($delims)) {
    if($delims[$i] == chr(92)) {
        $delimiters[] = $delims[$i] . $delims[$i+1];
        $i = $i + 2;
    }
    else {
        $delimiters[] = $delims[$i];
        $i++;
    }
} 
```

$delimiters 的输出

```
Array
(
    [0] => ,
    [1] => ^
    [2] => .
    [3] => ;
    [4] => :
    [5] => \t
) 
```

至于以分隔符为索引的数组

```
foreach($delimiters as $key=>$val) {
    $delimCount[$val] = $val;
} 
```

$delimCount 的输出

```
Array
(
    [,] => ,
    [^] => ^
    [.] => .
    [;] => ;
    [:] => :
    [\t] => \t
) 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T13:56:06.757

> 我需要两个数组.. 一个以这些分隔符作为索引 ($delimCount)，另一个以这些分隔符作为值 ($delimiters)。

那么，$delimiters 是从哪里来的呢？你自己写的吗？如果是这样，我认为您最好在任何情况下将 $delimiters 设为一个数组，并在 preg_replace 中使用它时使用 implode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:17:16.817

如果您对制表器有疑问，那么您可以使用字符的序数作为字符本身的键：`$delim = "\t"; $delimCount[ ord($delim) ]++;`

方便的补充功能：[ord()](http://sk.php.net/manual/en/function.ord.php)和[chr()](http://sk.php.net/manual/en/function.chr.php)。

# php - 从 Android 应用程序访问 Wordpress 数据？

> ID：11434046
> 
> 赞同：1
> 
> 时间：2012-07-11T13:45:40.613
> 
> 标签：php, android, wordpress, xml-rpc

场景：使用来自使用 Wordpress 构建的网站的数据制作 Android 应用程序。它的使用方式将与网站本身有很大不同，但使用的数据大部分相同，因此我需要的不仅仅是一个简单的 WebView。该网站使用 Wordpress 来充分发挥其 CMS 功能，它不仅仅是一个传统的 Wordpress 博客。

我知道 WordPress 一直在构建一个相当强大的 XML-RPC API 来获取帖子、页面、自定义帖子类型、类别、标签、自定义分类法、媒体、评论、选项等（wordpress xmlrpc api codex 这里：[http://codex. wordpress.org/XML-RPC_WordPress_API](http://codex.wordpress.org/XML-RPC_WordPress_API)）。

我是一名 Web 开发人员，但我了解 Java。不幸的是，除了学习一些教程和玩一些东西之外，我还没有在 Android 上开发太多东西。

我查看了适用于 Android 的官方 Wordpress 应用程序（此处的存储库：[https](https://android.trac.wordpress.org/browser#trunk/src/org/xmlrpc/android) ://android.trac.wordpress.org/browser#trunk/src/org/xmlrpc/android ）以了解它们如何收集所有适当的数据，但客户端他们开发的远远超出了我的需要，我不能像 .jar 一样将它完全弹出并使用它。

所以我想我的问题是：以前有人做过吗？您使用的是哪种客户端，预打包的还是自定义的？我知道以前有人问过类似的问题，但我也知道最新版本的 Wordpress (3.4) 中添加了很多对 WP XML-RPC API 的改进，所以那里没有很多信息，但是任何方向将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:36:46.597

在尝试为基于 PHP/mySQL 的网站制作应用程序时，我也遇到了同样的问题。我认为您可以检查 XML Parser

[如何使用 SAX 解析器解析 XML](https://stackoverflow.com/questions/4827344/how-to-parse-xml-using-the-sax-parser/4828765#4828765)

[http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/](http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/)

但是对于我的网站，我正在尝试使用 Jsoup 直接解析 html 并填充列表视图。

[使用标准java从HTML段中提取文本](https://stackoverflow.com/questions/11447082/extract-text-from-html-segment-using-standard-java)

# iphone - 如何从字符串指向对象

> ID：11434048
> 
> 赞同：0
> 
> 时间：2012-07-11T13:45:41.307
> 
> 标签：iphone, objective-c

我的问题有点笼统；在我的项目中，我有 10 个`UIButton`对象，分别命名为 Button1、Button2、Button3、Button4、Button5、Button6、Button7、Button8、Button9 和 Button10

我也有`UIImageview`它的名称与从 1 到 10 的按钮完全一样。

我想编写一个代码，通过按钮的最后一个字符（总是从 1 到 10 的数字）来操作图像，并且会`UIImageview`以同样的方式产生影响

像这样的东西

```
buttonlastcharacter = i;
    if(sender.lastcharacternumber is:i){
    Button%,i.frame = //Some manipulation 
```

但基本上我想要的只是通过字符串访问某个对象

我怎样才能实现这样的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:56:11.097

有几种更好的方法可以做到这一点。如果这些按钮都是静态的，并且在 IB 中，您可以将 IBCollection 数组用于图像视图和按钮，以通过匹配索引简单地调用它们。

更好的是，只需将标签值用于按钮或图像视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T13:55:20.160

您可以这样做，在您的 IBAction 方法中：

```
- (IBAction)click:(id)sender
{
 UIButton *but = (UIButton *)sender;
 but.frame = your manipulation code;
} 
```

或者您可以检查标题，例如：

```
if([but.currentTitle isEqualToString:@"Button1])
{
 //Manipulate button 1
} 
```

如果您为 1-10 的按钮添加了标签，您可以使用，

```
if(but.tag == 2)
{
   //Manipulate button 2
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T13:58:02.800

嗯，你可以为你的按钮使用一个数组，为你的 UIImageView 对象使用一个标签。它们都继承自 UIView，它为您提供了一个 .tag 属性。它是 NSInteger* 类型。

为方便起见，我建议将按钮命名为 0 到 9。这并不重要，但数组中的第一个索引是 0，因此相应地命名它们只会让事情变得更容易。

定义

```
NSArray *buttonArray; 
```

您可以选择 NSMutableArray，具体取决于您还想用它做什么。

在 viewDidLoad 代码中：

```
buttonArray = [NSArray arrayWithCapacity:10];
buttonArray[0] = button0;
..
buttonArray[9] = button9; 
```

在 Interface Builder 中的 XIB 文件中，或者您可以通过编程方式创建 UIImage 的任何地方，相应地添加标签。

```
image0.tag = 0; 
...
image0.tag = 9; 
```

假设您将它们命名为 image0 到 image9。

在您适当的操作方法代码中：

```
buttonArray[sender.tag] = someManipulation; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T14:03:13.897

在您的情况下，这可能不是理想的解决方案，但您可以采用不同的方式：

使用 kvo

```
UIButton* myButton = [self valueForKey:[NSString stringWithFormat:@"button%i",i]]; 
```

或使用选择器和属性

```
UIButton* myButton = [self performSelector:NSSelectorFromString([NSString stringWithFormat:@"button%i",i])]; 
```

# android - AndroidRuntime：java.lang.NoClassDefFoundError：本地项目

> ID：11434051
> 
> 赞同：1
> 
> 时间：2012-07-11T13:45:47.300
> 
> 标签：android, eclipse, noclassdeffounderror

我在本地项目中实际存在的类上收到“AndroidRuntime：java.lang.NoClassDefFoundError：”异常。

**P/S：**这个类在本地 Java 项目中，而不是引用的“jar”文件

```
07-11 13:42:16.103: E/AndroidRuntime(647): java.lang.NoClassDefFoundError: com.cityjams.ui.Eula 
```

**笔记：**

*   当我尝试运行项目时发生此异常
*   Eula 类在另一个被许多项目引用的 Java 项目中
*   直到最近，这一直工作得很好

![在此处输入图像描述](../Images/12a5ccaa6eb77e72951afb53e9971807.png)

# crystal-reports - Crystal Reports 部分未显示（VS2008 的 CR）

> ID：11434052
> 
> 赞同：0
> 
> 时间：2012-07-11T13:45:47.970
> 
> 标签：crystal-reports

所以我有一个包含 2 个详细信息部分的报告 - 一个主要详细信息部分（**详细信息 a**）和一个次要详细信息部分（**详细信息 b**）。**细节 a**应始终显示并且工作正常。

但是，**详细信息 b**包含一些静态文本对象、一些行对象和一个公式字段，可以是“”（空字符串）或其中包含文本。

如果公式字段中有文本（即！=“”），那么我希望显示**详细信息 b**部分，如果它是 ==“”，那么我希望抑制整个**详细信息 b部分。**

我已将以下公式添加到**详细信息 b** *部分专家*-`{@CageCardNumbersConditional} = ""`因此，如果公式字段是空字符串，它应该禁止该部分，但该部分显示公式字段中是否包含文本。此外，我尝试检查“禁止空白部分”复选框并尝试不检查复选框......该部分仍然显示的两种方式。

因此，我在公式字段中使用文本和公式字段中没有文本的情况下测试了报告，选中和未选中“抑制空白部分”复选框，使用`{@CageCardNumbersConditional} = ""`公式和

```
 `If {@CageCardNumbersConditional} = ""Then 
      true 
  Else 
      false;` 
```

公式，我什至从该部分中删除了所有文本对象和线条对象，以确保不是它们阻止该部分被抑制......但在每次测试中，该部分都没有被抑制。

对我所缺少的有什么建议吗？

谢谢，乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:21:12.233

这取决于 {@CageCardNumbersConditional} 正在做什么，但请尝试`isnull({@CageCardNumbersConditional})`而不是`{@CageCardNumbersConditional}=""`. {@CageCardNumbersConditional} 可能没有按照您的想法做，而是返回 null 而不是空字符串，这在 CR 中都是不同的。

# jasper-reports - 我的美元符号现在是小盒子

> ID：11434055
> 
> 赞同：3
> 
> 时间：2012-07-11T13:45:48.337
> 
> 标签：jasper-reports, ireport, jasperserver

本周我们升级到 JasperReports Server 4.7 (Professional) 和 iReport 4.7。我有几个在 iReport 4.5.1 中创建并在 JasperReports Server 4.5.1 中成功使用的报告。

升级后，我所有的美元符号现在都是小盒子。我的货币字段的模式是 ¤ #,##0.00。生成报告时，JasperReports Server 不会用美元符号替换框。模式示例中的一切看起来都不错。我的百分比符号都还在工作。我尝试再次删除货币模式并将其应用于字段，但这并没有解决问题。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T21:08:21.887

这是 Java 按预期运行......但不是您*希望*它运行的那样。您的语言环境没有指定货币，因此您会得到那个“¤”符号。

您可以通过将语言环境从“en”更改为“en_US”来解决此问题。我上周刚做了这个。作为旁注，我发现了一个我需要做的调整。将语言环境更改为 en_US 后，我需要复制一个文件，如下所示：

```
cp .../jasperserver-pro/scripts/jquery/js/jquery.ui.datepicker-en.js .../jasperserver-pro/scripts/jquery/js/jquery.ui.datepicker-en-US.js 
```

或者，我通常发现最好通过将格式掩码设置为使用硬编码的美元符号来解决它。如果您向美国用户显示“$50.00”，那么向欧洲用户显示“€50,00”或向日本用户显示相同值的“¥50.00”将是荒谬的。很多时候硬编码货币符号更合适。

# android - 如何每 X 秒运行一次方法

> ID：11434056
> 
> 赞同：143
> 
> 时间：2012-07-11T13:45:52.280
> 
> 标签：android, timer, nstimer

我正在开发一个 Android 2.3.3 应用程序，我需要每**X seconds**运行一个方法。

在 iOS 中，我有[NSTimer](https://developer.apple.com/documentation/foundation/nstimer)，但在 Android 中我不知道该使用什么。

有人推荐我[Handler](https://developer.android.com/reference/android/os/Handler.html)；另一个推荐我[AlarmManager](https://developer.android.com/reference/android/app/AlarmManager.html)但我不知道哪种方法更适合[NSTimer](https://developer.apple.com/documentation/foundation/nstimer)。

这是我想在 Android 中实现的代码：

```
timer2 = [
    NSTimer scheduledTimerWithTimeInterval:(1.0f/20.0f)
    target:self
    selector:@selector(loopTask)
    userInfo:nil
    repeats:YES
];

timer1 = [
    NSTimer scheduledTimerWithTimeInterval:(1.0f/4.0f)
    target:self
    selector:@selector(isFree)
    userInfo:nil
    repeats:YES
]; 
```

我需要类似[NSTimer](https://developer.apple.com/documentation/foundation/nstimer)的东西。

你给我推荐什么？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2012-07-11T13:49:43.543

您将使用的解决方案实际上取决于您在每次执行函数之间需要等待多长时间。

如果您等待超过 10 分钟，我建议您使用`AlarmManager`.

```
// Some time when you want to run
Date when = new Date(System.currentTimeMillis());

try {
    Intent someIntent = new Intent(someContext, MyReceiver.class); // intent to be launched

    // Note: this could be getActivity if you want to launch an activity
    PendingIntent pendingIntent = PendingIntent.getBroadcast(
        context,
        0, // id (optional)
        someIntent, // intent to launch
        PendingIntent.FLAG_CANCEL_CURRENT // PendingIntent flag
    );

    AlarmManager alarms = (AlarmManager) context.getSystemService(
        Context.ALARM_SERVICE
    );

    alarms.setRepeating(
        AlarmManager.RTC_WAKEUP,
        when.getTime(),
        AlarmManager.INTERVAL_FIFTEEN_MINUTES,
        pendingIntent
    );
} catch(Exception e) {
    e.printStackTrace();
} 
```

广播上述`Intent`内容后，您可以`Intent`通过实施`BroadcastReceiver`. 请注意，这需要在您的应用程序清单中或通过该`context.registerReceiver(receiver, intentFilter);`方法进行注册。[有关`BroadcastReceiver`'s 的更多信息，请参阅官方文档。](http://developer.android.com/reference/android/content/BroadcastReceiver.html).

```
public class MyReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent)
    {
        System.out.println("MyReceiver: here!") // Do your work here
    }
} 
```

如果您等待的时间少于 10 分钟，那么我建议您使用`Handler`.

```
final Handler handler = new Handler();
final int delay = 1000; // 1000 milliseconds == 1 second

handler.postDelayed(new Runnable() {
    public void run() {
        System.out.println("myHandler: here!"); // Do your work here
        handler.postDelayed(this, delay);
    }
}, delay); 
```

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2012-07-11T13:48:44.237

每秒使用计时器...

```
new Timer().scheduleAtFixedRate(new TimerTask() {
    @Override
    public void run() {
        //your method
    }
}, 0, 1000);//put here time 1000 milliseconds=1 second 
```

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2016-10-15T10:40:39.853

您可以尝试此代码通过 o​​nResume() 每 15 秒调用一次处理程序，并在活动不可见时通过 onPause() 停止它。

```
Handler handler = new Handler();
Runnable runnable;
int delay = 15*1000; //Delay for 15 seconds.  One second = 1000 milliseconds.

@Override
protected void onResume() {
   //start handler as activity become visible

    handler.postDelayed( runnable = new Runnable() {
        public void run() {
            //do something

            handler.postDelayed(runnable, delay);
        }
    }, delay);

    super.onResume();
}

// If onPause() is not included the threads will double up when you 
// reload the activity 

@Override
protected void onPause() {
    handler.removeCallbacks(runnable); //stop handler when activity not visible
    super.onPause();
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-07-13T06:46:35.153

如果你熟悉 RxJava，你可以使用 Observable.interval()，它非常简洁。

```
Observable.interval(60, TimeUnits.SECONDS)
          .flatMap(new Function<Long, ObservableSource<String>>() {
                @Override
                public ObservableSource<String> apply(@NonNull Long aLong) throws Exception {
                    return getDataObservable(); //Where you pull your data
                }
            }); 
```

这样做的缺点是您必须以不同的方式构建轮询数据的架构。但是，响应式编程方式有很多好处：

1.  您可以创建订阅的数据流，而不是通过回调控制数据。这将“轮询数据”逻辑和“用您的数据填充 UI”逻辑的关注点分开，这样您就不会混淆您的“数据源”代码和您的 UI 代码。
2.  使用 RxAndroid，您只需 2 行代码即可处理线程。

    ```
    Observable.interval(60, TimeUnits.SECONDS)
          .flatMap(...) // polling data code
          .subscribeOn(Schedulers.newThread()) // poll data on a background thread
          .observeOn(AndroidSchedulers.mainThread()) // populate UI on main thread
          .subscribe(...); // your UI code 
    ```

请查看 RxJava。它有很高的学习曲线，但它会让在 Android 中处理异步调用变得更加容易和清洁。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-06-26T16:38:03.433

使用 Kotlin，我们现在可以为此创建一个通用函数！

```
object RepeatHelper {
    fun repeatDelayed(delay: Long, todo: () -> Unit) {
        val handler = Handler()
        handler.postDelayed(object : Runnable {
            override fun run() {
                todo()
                handler.postDelayed(this, delay)
            }
        }, delay)
    }
} 
```

要使用，只需执行以下操作：

```
val delay = 1000L
RepeatHelper.repeatDelayed(delay) {
    myRepeatedFunction()
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-08-20T10:00:52.213

```
 new CountDownTimer(120000, 1000) {

        public void onTick(long millisUntilFinished) {
            txtcounter.setText(" " + millisUntilFinished / 1000);

        }

        public void onFinish() {

            txtcounter.setText(" TimeOut  ");
            Main2Activity.ShowPayment = false;
            EventBus.getDefault().post("go-main");

        }

    }.start(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-16T17:25:27.847

这里我在 onCreate() 一个Activity中重复使用了一个线程，定时器在某些情况下不允许一切线程是解决方案

```
 Thread t = new Thread() {
        @Override
        public void run() {
            while (!isInterrupted()) {
                try {
                    Thread.sleep(10000);  //1000ms = 1 sec
                    runOnUiThread(new Runnable() {
                        @Override
                        public void run() {

                            SharedPreferences mPrefs = getSharedPreferences("sam", MODE_PRIVATE);
                            Gson gson = new Gson();
                            String json = mPrefs.getString("chat_list", "");
                            GelenMesajlar model = gson.fromJson(json, GelenMesajlar.class);
                            String sam = "";

                            ChatAdapter adapter = new ChatAdapter(Chat.this, model.getData());
                            listview.setAdapter(adapter);
                           // listview.setStackFromBottom(true);
                          //  Util.showMessage(Chat.this,"Merhabalar");
                        }
                    });

                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    };

    t.start(); 
```

如果需要，可以通过以下方式停止

```
@Override
protected void onDestroy() {
    super.onDestroy();
    Thread.interrupted();
    //t.interrupted();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-04T19:16:53.077

我这样做并且效果很好（代码是用**Kotlin**编写的）：

```
private lateinit var runnable: Runnable

private var handler = Handler(Looper.getMainLooper())

private val repeatPeriod: Long = 10000 
```

然后从你的函数内部重新初始化可运行文件

```
runnable = Runnable {

        // Your code goes here

        handler.postDelayed(runnable, repeatPeriod)

    }

    handler.postDelayed(runnable, repeatPeriod)

} 
```

请注意，如果您不两次**postDelay****处理程序**，则循环不会是无限的！

# html - CSS 绝对位置，div 的左上角在父元素的右上角

> ID：11434061
> 
> 赞同：7
> 
> 时间：2012-07-11T13:45:58.490
> 
> 标签：html, css

我想绝对定位一个 div，使 div 的左上角连接到父 div 的右上角（相对定位）。

你有什么解决办法吗？

这是一个开始的[小提琴](http://jsfiddle.net/ashwyn/ZeSF8/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-11T13:52:47.993

我想你想要这样的东西

[http://jsfiddle.net/kdcmq/](http://jsfiddle.net/kdcmq/)

```
<div id = "parent">
     <div id = "child"></div>
</div>

#parent {
    position: relative;
    width: 500px;
    height: 500px;
    background: red;
    display: block; /* fix for opera and ff */
}

#child {
    position: absolute;
    width: 100px;
    height: 100px;
    background: blue;
    top: 0;
    left: 100%; /* this line of code will sort things out for you :) */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T14:03:40.543

就这么简单？

[http://jsfiddle.net/ZeSF8/2/](http://jsfiddle.net/ZeSF8/2/)

CSS：

```
div {border:1px solid #000}
.p {
    position:relative;
    width:100px; /*width will be unknown*/
    height:80px;
    background:#999;
}

.c {
    position:absolute;
    width:40px;
    height:30px;
    background:red;
    top:0;
    left:100%;
} 
```

​ HTML：

```
<div class="p">
    <div class="c"></div>
</div>​ 
```

# android - 为什么这个 TextView 的文本没有改变？

> ID：11434063
> 
> 赞同：1
> 
> 时间：2012-07-11T13:46:03.967
> 
> 标签：android, onkeydown

首先，我不得不说我已经研究了 2 周，但没有找到答案......

我有一个TextView，所以我想做的是用任何硬件按键的键码更改它的文本（是的，我知道有些按键不能使用）......问题是文本不想改变...... .任何人请帮我解决这个问题。

非常感谢！！！

代码：

```
import android.app.Activity;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnKeyListener;
import android.widget.TextView;

public class keycodelistener extends Activity {

    private TextView txtcode;

    public void onCreate(Bundle savedInstanceState) {   
        super.onCreate(savedInstanceState);     
        setContentView(R.layout.keycodedialog);

        txtcode = (TextView)findViewById(R.id.keypresstext);

    }

    public boolean onKeyDown(View v, int keyCode, KeyEvent event) {
        txtcode.setText(String.valueOf(keyCode));
        return super.onKeyDown(keyCode, event);
    }
} 
```

最后，感谢@CFlex ！最后三行必须是：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
     //Log.e("","yeeeahhhh");
     txtcode.setText(String.valueOf(keyCode));
     return true;

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T13:52:46.803

您需要覆盖`onKeyDown(keyCode, event)`，因为`onKeyDown(View v, int keyCode, KeyEvent event)`不存在。文档[在这里](http://developer.android.com/reference/android/app/Activity.html#onKeyDown%28int,%20android.view.KeyEvent%29)

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    /* do what you want */
} 
```

希望这会有所帮助。

# user-interface - 是否可以在 GTK 和 Haskell 的 State monad 中为数据创建 TreeModel？

> ID：11434068
> 
> 赞同：4
> 
> 时间：2012-07-11T13:46:09.740
> 
> 标签：user-interface, haskell, monads

我想这个问题的总体答案会将我推向函数响应式编程，但是……请耐心等待。

我也没有这个问题的示例代码。我用我的一些代码在这个主题附近徘徊，但我一直牢牢地呆在 IO monad 中。

想象一下，我有一个应用程序，我在其中建模了一些复杂的状态并将其放入一个整体的应用程序状态单子中。我这样做是因为我希望我的核心应用程序和特定用户界面之间有一定程度的分离。

```
data S = S DataStore EventStream Sockets
type AppState m = StateT S m 
```

（假设 DataStore、EventStream 和 Sockets 都是基本上按照它们听起来的样子的数据类型 :)）

现在，假设我想在 GTK（TreeView，但没有子节点）中创建一个只查看 EventStream 的表。我已经学会了这样做`listStoreNew event_stream >>= treeViewNewWithModel`（参见[http://markus.alyra.org/?p=1023](http://markus.alyra.org/?p=1023)，我在其中广泛讨论了设置的机制）。

但是，现在我的 AppState monad 中有一个*可变*的数据副本。当应用程序关闭并执行将新数据附加到 EventStream 的操作时，这些数据不会显示在视图中。我能想到让它显示在视图中的唯一方法是发送一条消息`listStoreInsert my_new_event`，除了对 monad 所做的更改之外。这是可行的，但开始感到笨拙。

更糟糕的是，这个神秘的树视图是一个管理视图！它是*可编辑*的！管理员说“哦，该事件有一些无效数据，我想更改它！”。现在，我可以毫无问题地更改上面创建的 ListStore 中的数据。我可以创建使更新毫无问题的回调。但我根本想不出如何将更新放入 Global AppState Monad。

最后几句话显示了问题的核心。如果我有一个全局 AppState Monad，那么更新该 monad 的任何内容都必须与想要查看该 monad 的所有内容一起执行。TreeView 打破了这一点。当在 TreeView monad 中编辑单元格时，编辑处理程序完全在 IO monad 中运行，并且预计不会返回任何内容。结束数据类型是`IO ()`. 即使我有一些巧妙的方法从我的 AppState 中解包数据，然后执行编辑处理程序，然后在我的 AppState 中重新包装数据，应用程序的其他分支也看不到它。

即使我可以弄清楚如何创建自己的完全自定义的 ModelView 实例，该实例为我的 AppState 提供只读视图，我也无法想到如何使状态更新对应用程序的其余部分可用。

所以...

甚至可以以这种方式对 GTK/Haskell 应用程序进行建模吗？或者，我是否走上了疯狂的道路？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:57:19.033

您无法使用正常的状态单子可靠地共享状态。如果（人为的示例）您的用户通过 GUI 编辑模型并且您同时从其他地方获得了新条目怎么办？在那种情况下，您不可能使用一些纯 monad 堆栈来序列化对 state monad 的更改。

您可以做的是使用某种使用可变引用的同步系统（`MVar`例如，使用 s ）；您将实际的应用程序状态存储`MVar`在`MVar`. 这是一些伪代码，说明了我的意思：

```
-- This is the MVar that stores your application state
appStateMVar :: MVar S
appStateMVar = unsafePerformIO $ newMVar initialAppState
{-# NOINLINE appStateMVar #-}
-- It could also be passed as a parameter to the functions below, so that when
-- you define the callbacks, you create a closure over the MVar that you use.
-- (i.e.:
-- > appStateMVar <- newMVar initialAppState
-- > createListViewWithCallback $ whenUserAddedSomethingViaTheGUI appStateMVar
-- )
-- That way, you don't have to have the MVar in global scope and can avoid the
-- use of `unsafePerformIO` to initialize it, etc.

main :: IO ()
main = do
  createListViewWithCallback whenUserAddedSomethingViaTheGUI
  createSocketsAndListenUsingCallback whenChangesArriveOverTheNetwork
  runSomeKindOfMainLoop

-- This would be called on any thread by the GUI when the user added something in
-- the view (For example)
whenUserAddedSomethingViaTheGUI :: AddedThing -> IO ()
whenUserAddedSomethingViaTheGUI theThingThatWasAdded =
  takeMVar appStateMVar >>=
  execStateT (addToTheState theThingThatWasAdded) >>=
  putMVar appStateMVar

-- This would be called by the network when something changed there
whenChangesArriveOverTheNetwork :: ArrivedChanges -> IO ()
whenChangesArriveOverTheNetwork theChangesThatArrived =
  takeMVar appStateMVar >>=
  execStateT (handleChanges theChangesThatArrived) >>=
  putMVar appStateMVar 
```

然后，您可以像以前一样编写`addToTheState`和`handleChanges`使用纯monad。`AppState`

当然，如果您决定使用 FRP，您可以通过让您的应用程序状态成为随时间变化的纯信号来避免这种非常命令式的状态连接。我知道`reactive-banana`已经完成了一些工作，可以将双向 GUI 编辑器/视图与 FRP 事件网络集成。

# c# - c#中的UTF8字符串变量

> ID：11434073
> 
> 赞同：0
> 
> 时间：2012-07-11T13:46:23.857
> 
> 标签：c#, postgresql, utf-8

我正在使用 PostgreSQL 来驱动 C# 桌面应用程序。当我使用*PgAdmin*查询分析器更新具有特殊字符（如版权商标）的文本列时，它可以正常工作：

```
update table1 set column1='value with special character ©' where column2=1 
```

当我在 C# 应用程序中使用相同的查询时，它会引发错误：

> 用于编码的无效字节序列

在研究了这个问题后，我了解到 .NET 字符串使用 UTF-16 Unicode 编码。

考虑：

```
string sourcetext = "value with special character ©";
// Convert a string to utf-8 bytes.
byte[] utf8Bytes = System.Text.Encoding.UTF8.GetBytes(sourcetext);

// Convert utf-8 bytes to a string. 
string desttext = System.Text.Encoding.UTF8.GetString(utf8Bytes); 
```

这里的问题是`sourcetext`和`desttext`都被编码为 UTF-16 字符串。当我通过`desttext`时，我仍然得到异常。

我也尝试了以下但没有成功：

```
Encoder.GetString, BitConverter.GetString 
```

**编辑**：我什至试过这个并没有帮助：

```
unsafe
{
  String utfeightstring = null;
  string sourcetext = "value with special character ©";
  Console.WriteLine(sourcetext);
  // Convert a string to utf-8 bytes. 
  sbyte[] utf8Chars = (sbyte[]) (Array) System.Text.Encoding.UTF8.GetBytes(sourcetext); 
  UTF8Encoding encoding = new UTF8Encoding(true, true);

  // Instruct the Garbage Collector not to move the memory
  fixed (sbyte* pUtf8Chars = utf8Chars)
  {
    utfeightstring = new String(pUtf8Chars, 0, utf8Chars.Length, encoding);
  }
  Console.WriteLine("The UTF8 String is " + utfeightstring); 
} 
```

.NET 中是否有支持存储 UTF-8 编码字符串的数据类型？是否有其他方法来处理这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T14:14:56.447

根据来自 mono 项目[PostgreSQL](http://www.mono-project.com/PostgreSQL)的这个页面，他们建议如果您在使用 UTF8 字符串时遇到错误，您可以在连接字符串中将编码设置为 unicode（如果您使用的是 Npgsql 驱动程序）：

> 编码：要使用的编码。可能的值：ASCII（默认）和 UNICODE。如果遇到 UTF-8 值问题，请使用 UNICODE：Encoding=UNICODE

而且我一直在查看官方 Npgsql 文档，但没有提及。 [NpgsqlConnection.ConnectionString](http://npgsql.projects.postgresql.org/docs/api/Npgsql.NpgsqlConnection.ConnectionString.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-11T14:08:00.193

我认为它可能不是由 utf-8 或 16 引起的，它可能是由 de 特殊字符引起的，您可以将 char 替换为实体 char，例如 '&';

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-01-21T22:16:51.143

只需在您的 ConnectionString 末尾添加一个“...... ;Unicode=true”

# android - ViewPager 中的 MapView 导致黑色覆盖

> ID：11434085
> 
> 赞同：1
> 
> 时间：2012-07-11T13:46:49.927
> 
> 标签：android, android-mapview, android-viewpager, arcgis

> **可能重复：**
> [带有 Google Maps API v2 的 ViewPager：神秘的黑色视图](https://stackoverflow.com/questions/13837697/viewpager-with-google-maps-api-v2-mysterious-black-view)

因此，在我的 Android 项目中，我有一个 ViewPager，其中包含一个带有 MapView 的片段和一个 ListFragment。（这个想法是显示当前地图上的内容列表。）

但是，当我从 map-fragment 切换到 ListFragment 时，我会在 ListFragment 上看到一个黑色的覆盖框。每当我重新填充列表（例如通过单击菜单项）或进入另一个活动并返回时，此框就会消失。此框也不会出现在屏幕截图中。

从 map-fragment 转换到 ListFragment 后，我​​尝试重新填充列表，但这没有帮助。

我可能应该提一下，我还可以滚动该框。

**这是我的应用程序上方的黑色叠加框：**

![截屏](../Images/13d32c88ba4f2902156b4b3dc5bde7db.png)

**这是我截屏时得到的（正确的方法）：**

![问题照片](../Images/9592a3ba443b495e175f4ea934082965.png)

# javascript - 是否可以操纵 Google Analytics 以显示更多访问者（发现可能的骗局）

> ID：11434086
> 
> 赞同：2
> 
> 时间：2012-07-11T13:46:51.273
> 
> 标签：javascript, google-analytics

最近我在 Flippa 上发现了一个网站，其中 googleanalytics 统计数据与其他数据不完全匹配（它们很高但经过验证）

出于个人利益，我尝试修改 G. Analytics 代码以查看是否可以伪造 Analytics 报告：

这就是我得到的：

```
<script type="text/javascript">

var i=0;
for (i=0;i<=10;i++) {

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-19629541-9']);
 _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async =   true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +     '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

}

</script> 
```

请注意脚本的这一部分“for (i=0;i<=10;i++)”i<=10 意味着对于访问您网站的每个访问者，它计为 10 次页面浏览量，实际上应该将您的跳出率低于1%，所以看起来人们会留在您的网站上。我试过了，它奏效了。

问题是我无法操纵 G. Analytics 报告中显示的访问者数量和独立访问者数量。

出于教育目的，这些统计数据是否可以被操纵

PS 实际上，flippa 通过让您通过 G. Analytics 仪表板通过电子邮件向他们发送报告来验证 G. Analytics 报告

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T05:15:04.270

GA是一个神奇的工具，可以根据网站活动进行修改，代码的灵活性是根据用户的选择来捕获数据，代码实际上是用来控制网站的跳出率，默认值有时计算错误的数据。所以 Chriswede，这不是 GA 的骗局或操纵，而是谷歌根据用户准确生成数据的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:30:44.040

如果您在循环中（之前）使用`_gaq.push([_setDomainName, '.domain.com']);`and或者随机地使用，您还可以夸大访问者/唯一访问者的实际数量。`_gaq.push([_setDomainName, 'domain.com']);``_trackPageview`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T13:50:22.013

您操纵自己的访问者数据。您可以直接在仪表板上操作它们。这不像您将您的登录名/密码提供给其他人来证明您的网站有多酷，对吧？

# c# - 在没有上下文的情况下将一个对象附加到另一个对象

> ID：11434088
> 
> 赞同：0
> 
> 时间：2012-07-11T13:46:55.630
> 
> 标签：c#, .net, entity-framework, entity-framework-4, objectcontext

我有两种使用 EF4 的方法 - 一种在 using 块中返回对象列表（页面），另一种方法创建不同类型的对象（书）。Book 上的一个属性是 FirstPage，它是第一个项目列表中的一个项目。当我尝试在此实例化对象上设置 FirstPage 属性时，出现异常：

> 无法定义这两个对象之间的关系，因为它们附加到不同的 ObjectContext 对象。

我想这一定是因为 using 块在对象被分离之前已经被释放。有什么方法可以 1）在处理完上下文后将其分离，或者 2）将其附加到幽灵上下文，直到我将其传递回数据层？

这是我的代码：

```
IEnumerable<Page> allPages = null;

using (var db = new DataContainer())
{
    var items = db.Pages;
    var filteredCode = items.Where(i => i.Code == PageCode);
    allPages = filteredCode.ToList();
}

Page page = allPages.FirstOrDefault(p => ...); // query omitted

var book = new Book()
{
    Title = @"asdas",
    FirstPage = page, // 'page' is never null
    // rest omitted
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:53:46.757

你的两个问题的答案都是：不。要么对两个操作使用相同的上下文，要么在离开 using 块的范围之前分离实体。

如果您使用 POCO，您还可以关闭代理创建（=无延迟加载和动态更改跟踪）并且您的代码无需任何更改即可工作，因为代理保持对上下文的引用 - POCO 本身对上下文一无所知。

顺便提一句。`EntityObject`在超出其上下文的生命周期范围之前不分离实体（代理 POCO 和可能还有）还有另一个副作用- 它会导致内存泄漏，因为实体持有对上下文的引用，而上下文持有对许多其他对象的引用，包括其他附加对象实体。在您的实体被释放（没有对您的实体的引用）之前，垃圾收集器无法释放上下文和所有相关对象。

# php - 添加 ... 如果字符串太长 PHP

> ID：11434091
> 
> 赞同：154
> 
> 时间：2012-07-11T13:47:26.627
> 
> 标签：php, string, strlen

我的 MySQL 数据库中有一个描述字段，我在两个不同的页面上访问数据库，一个页面显示整个字段，但另一方面，我只想显示前 50 个字符。如果描述字段中的字符串少于 50 个字符，则不会显示 ... ，但如果不是，我会在前 50 个字符后显示 ... 。

示例（完整字符串）：

```
Hello, this is the first example, where I am going to have a string that is over 50 characters and is super long, I don't know how long maybe around 1000 characters. Anyway this should be over 50 characters now ... 
```

示例 2（前 50 个字符）：

```
Hello, this is the first example, where I am going ... 
```

* * *

## 回答 #1

> 赞同：382
> 
> 时间：2012-07-11T13:50:04.527

这样做的 PHP 方法很简单：

```
$out = strlen($in) > 50 ? substr($in,0,50)."..." : $in; 
```

但是你可以使用这个 CSS 实现更好的效果：

```
.ellipsis {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
} 
```

现在，假设元素具有固定宽度，浏览器将自动中断并`...`为您添加。

* * *

## 回答 #2

> 赞同：220
> 
> 时间：2013-04-26T15:08:34.517

您也可以通过这种方式实现所需的修剪：

```
mb_strimwidth("Hello World", 0, 10, "..."); 
```

在哪里：

*   `Hello World`: 要修剪的字符串。
*   `0`: 字符串开头的字符数。
*   `10`：修剪后的字符串的长度。
*   `...`：在修剪后的字符串末尾添加的字符串。

这将返回`Hello W...`。

请注意，10 是截断字符串的长度 + 添加的字符串！

文档： http: [//php.net/manual/en/function.mb-strimwidth.php](http://php.net/manual/en/function.mb-strimwidth.php)

**为避免截断单词：**

在呈现文本摘录的情况下，可能应该避免截断一个单词。如果对截断文本的长度没有硬性要求，除了`wordwrap()`这里提到的之外，还可以使用以下方法来截断和防止截断最后一个单词。

```
$text = "Knowledge is a natural right of every human being of which no one
has the right to deprive him or her under any pretext, except in a case where a
person does something which deprives him or her of that right. It is mere
stupidity to leave its benefits to certain individuals and teams who monopolize
these while the masses provide the facilities and pay the expenses for the
establishment of public sports.";

// we don't want new lines in our preview
$text_only_spaces = preg_replace('/\s+/', ' ', $text);

// truncates the text
$text_truncated = mb_substr($text_only_spaces, 0, mb_strpos($text_only_spaces, " ", 50));

// prevents last word truncation
$preview = trim(mb_substr($text_truncated, 0, mb_strrpos($text_truncated, " "))); 
```

在这种情况下，`$preview`将`"Knowledge is a natural right of every human being"`.

实时代码示例： [http ://sandbox.onlinephpfunctions.com/code/25484a8b687d1f5ad93f62082b6379662a6b4713](http://sandbox.onlinephpfunctions.com/code/25484a8b687d1f5ad93f62082b6379662a6b4713)

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-07-11T13:50:56.803

如果字符串长度超过 50 个字符，则用于截断字符串而不破坏单词，并在`wordwrap()`末尾**添加**`...`：

```
$str = $input;
if( strlen( $input) > 50) {
    $str = explode( "\n", wordwrap( $input, 50));
    $str = $str[0] . '...';
}

echo $str; 
```

否则，使用确实的解决方案`substr( $input, 0, 50);`会破坏语言。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-07-11T13:50:05.637

```
if (strlen($string) <=50) {
  echo $string;
} else {
  echo substr($string, 0, 50) . '...';
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-07-11T13:50:26.170

```
<?php
function truncate($string, $length, $stopanywhere=false) {
    //truncates a string to a certain char length, stopping on a word if not specified otherwise.
    if (strlen($string) > $length) {
        //limit hit!
        $string = substr($string,0,($length -3));
        if ($stopanywhere) {
            //stop anywhere
            $string .= '...';
        } else{
            //stop on a word.
            $string = substr($string,0,strrpos($string,' ')).'...';
        }
    }
    return $string;
}
?> 
```

我多次使用上面的代码片段..

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-01-25T11:53:59.983

我在我的网站上使用此解决方案。如果 $str 比 $max 短，它将保持不变。如果 $str 在第一个 $max 字符之间没有空格，它将在 $max 位置被粗暴地切割。否则将在最后一个完整单词后添加 3 个点。

```
function short_str($str, $max = 50) {
    $str = trim($str);
    if (strlen($str) > $max) {
        $s_pos = strpos($str, ' ');
        $cut = $s_pos === false || $s_pos > $max;
        $str = wordwrap($str, $max, ';;', $cut);
        $str = explode(';;', $str);
        $str = $str[0] . '...';
    }
    return $str;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-09-25T18:49:00.767

这将根据字数而不是字符返回带有省略号的给定字符串：

```
<?php
/**
*    Return an elipsis given a string and a number of words
*/
function elipsis ($text, $words = 30) {
    // Check if string has more than X words
    if (str_word_count($text) > $words) {

        // Extract first X words from string
        preg_match("/(?:[^\s,\.;\?\!]+(?:[\s,\.;\?\!]+|$)){0,$words}/", $text, $matches);
        $text = trim($matches[0]);

        // Let's check if it ends in a comma or a dot.
        if (substr($text, -1) == ',') {
            // If it's a comma, let's remove it and add a ellipsis
            $text = rtrim($text, ',');
            $text .= '...';
        } else if (substr($text, -1) == '.') {
            // If it's a dot, let's remove it and add a ellipsis (optional)
            $text = rtrim($text, '.');
            $text .= '...';
        } else {
            // Doesn't end in dot or comma, just adding ellipsis here
            $text .= '...';
        }
    }
    // Returns "ellipsed" text, or just the string, if it's less than X words wide.
    return $text;
}

$description = 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quibusdam ut placeat consequuntur pariatur iure eum ducimus quasi perferendis, laborum obcaecati iusto ullam expedita excepturi debitis nisi deserunt fugiat velit assumenda. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Incidunt, blanditiis nostrum. Nostrum cumque non rerum ducimus voluptas officia tempore modi, nulla nisi illum, voluptates dolor sapiente ut iusto earum. Esse? Lorem ipsum dolor sit amet, consectetur adipisicing elit. A eligendi perspiciatis natus autem. Necessitatibus eligendi doloribus corporis quia, quas laboriosam. Beatae repellat dolor alias. Perferendis, distinctio, laudantium? Dolorum, veniam, amet!';

echo elipsis($description, 30);
?> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-07-11T13:50:41.577

```
<?php
$string = 'This is your string';

if( strlen( $string ) > 50 ) {
   $string = substr( $string, 0, 50 ) . '...';
} 
```

就是这样。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-07-11T13:51:35.483

```
$string = "Hello, this is the first example, where I am going to have a string that is over 50 characters and is super long, I don't know how long maybe around 1000 characters. Anyway this should be over 50 characters know...";

if(strlen($string) >= 50)
{
    echo substr($string, 50); //prints everything after 50th character
    echo substr($string, 0, 50); //prints everything before 50th character
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-09-13T07:01:20.400

```
// this method will return the break string without breaking word
$string = "A brown fox jump over the lazy dog";
$len_required= 10;
// user strip_tags($string) if string contain html character
if(strlen($string) > 10)
{
 $break_str = explode( "\n", wordwrap( $string , $len_required));
 $new_str =$break_str[0] . '...';
}
// other method is use substr 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-11T13:53:16.757

你可以用[**`str_split()`**](http://php.net/manual/en/function.str-split.php)这个

```
$str = "Hello, this is the first example, where I am going to have a string that is over 50 characters and is super long, I don't know how long maybe around 1000 characters. Anyway this should be over 50 characters know...";
$split = str_split($str, 50);
$final = $split[0] . "...";
echo $final; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-02-20T12:26:08.173

对于一些使用 Yii2 的人来说，有一种方法`yii\helpers\StringHelper::truncate()`。

使用示例：

```
$sting = "stringToTruncate";
$truncatedString = \yii\helpers\StringHelper::truncate($string, 6, '...');
echo $truncatedString; // result: "string..." 
```

这是文档：[https ://www.yiiframework.com/doc/api/2.0/yii-helpers-basestringhelper#truncate()-detail](https://www.yiiframework.com/doc/api/2.0/yii-helpers-basestringhelper#truncate()-detail)

# php - 如何在 MySQL 中构造动态数据？

> ID：11434092
> 
> 赞同：0
> 
> 时间：2012-07-11T13:47:28.580
> 
> 标签：php, mysql, database, schema

请帮助构建以下类型的数据（示例）->

我有 1 个包含餐厅所有地址列表的表。（每个城市 1 个数据库表）

在查询每家餐厅时，它会以 {name ,timeduration,bill} 格式返回餐厅中的人员列表。 List 中返回的行数是动态的。

现在我如何将这些数据存储在 mysql 中。

我想按名称等搜索，所以我不能将全文放在一栏中！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:17:12.240

这是一个帮助您入门的结构：

```
CITY
----------
id
name

RESTAURANT
-----------
id
name
phone
address
city_id

PEOPLE
----------
id
name

ORDER
----------
id
restaurant_id
people_id
total (bill)
duration
date

RESTAURANT_ORDER
-----------------
id
restaurant_id
order_id 
```

restaurant_order 表将餐厅与在那里用餐的人联系起来。查看这里[http://www.tizag.com/mysqlTutorial/mysqljoins.php](http://www.tizag.com/mysqlTutorial/mysqljoins.php)了解如何从中检索内容。

# symfony - 升级我的 Symfony2 应用以使用 composer

> ID：11434093
> 
> 赞同：2
> 
> 时间：2012-07-11T13:47:29.047
> 
> 标签：symfony, symfony-2.1, composer-php

我想升级我用 Symfony2 开发的应用程序，供想要使用它的用户使用 composer。

我不知道如何基于 deps 文件创建 composer.json 文件。

这是我的 deps 文件：[https ://github.com/biruwon/Vecinos2.0/blob/master/deps](https://github.com/biruwon/Vecinos2.0/blob/master/deps)

例如，没有 composer.json 的包怎么办？或者库如何在 sourceforge 上上传 TCPDF？

如果您在这里帮助我或提出拉取请求，我将非常感谢您。

PD：我先这样做，然后将 Symfony2 更新到 Symfony2.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:58:37.570

对于 TCPDF，它已经[在 packagist](http://packagist.org/packages/tcpdf/tcpdf)上很容易。

对于不在 packagist 上的包或库，最好的方法是首先使用composer.json 中的[自定义包存储库](http://getcomposer.org/doc/05-repositories.md#package-2)使其在您的项目中工作，并在完成后使用作曲家向原作者发送拉取请求。 json 并要求他们将其提交给 Packagist 是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T18:14:53.463

在 symfony2 根文件夹中下载作曲家：

```
curl -s https://getcomposer.org/installer | php 
```

并执行

```
php composer.phar self-update
php composer.phar update 
```

如果您可以更新到最新版本，请使用此选项。

# java - 电子邮件 Java 的附件

> ID：11434094
> 
> 赞同：1
> 
> 时间：2012-07-11T13:47:36.673
> 
> 标签：java, email

我编写了一个代码，以便能够启动默认的电子邮件服务提供商，这对我来说是 Outlook。这是我的代码：

```
if(role.getValue().equals("1")) {

 Desktop desktop = Desktop.getDesktop();
    String message = "mailto:username@domain.com?subject=New_Profile&body=NewProfile";

    try {
            desktop.mail(uri);
    } catch (IOException e) {
    // TODO Auto-generated catch block
        e.printStackTrace();
    }   
} 
```

我正在尝试自动将某些内容附加到电子邮件中，但它不起作用。相反，是否有可能从我的程序中的输入字段中检索一些数据并自动将该数据作为正文添加到电子邮件中？

我尝试以某种方式嵌入语句，但它不起作用。有人可以建议吗？

```
Desktop desktop = Desktop.getDesktop();
String message = "mailto:username@domain.com?subject=New_Profile&body=person.getPdfName()"; 
```

为什么上面的代码什么都不做？person.getPdfName() 放错地方了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:55:40.820

看看这些答案，不确定它们是否能解决您的问题，但它们确实很好地描述了为什么它不那么简单。并非所有电子邮件客户端都以这种方式支持附件。

[启动带有附件的邮件客户端？](https://stackoverflow.com/questions/6029579/java-start-mail-client-with-attachment/6093765#6093765)

[如何在java中打开电子邮件客户端并自动附加文件](https://stackoverflow.com/questions/1564147/how-to-open-an-email-client-and-automatically-attach-file-in-java)

[http://forums.devshed.com/windows-help-34/defaut-mail-client-with-attachment-on-xp-71305.html](http://forums.devshed.com/windows-help-34/defaut-mail-client-with-attachment-on-xp-71305.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:02:47.603

Java 有一个 API，它能够发送消息并执行所有必要的功能，例如附加文件。检查类[MimeMessage](http://docs.oracle.com/javaee/6/api/javax/mail/internet/MimeMessage.html)来帮助你。

在您的情况下，我相信您的邮件正文将成为包含 PDF 名称的简单文本，不是吗？

# facebook - Facebook 页面选项卡不显示我的内容

> ID：11434095
> 
> 赞同：0
> 
> 时间：2012-07-11T13:47:36.620
> 
> 标签：facebook, heroku, sinatra, facebook-page, facebook-iframe

我试图在 facebook 标签页中显示一些 html，但没有成功……我是 facebook 应用程序的新手，我不明白发生了什么。
我创建了一个 heroku 应用程序，以使用您的 SSL，名为[https://sinatra-dev-test.herokuapp.com](https://sinatra-dev-test.herokuapp.com)，此 URL 仅显示带有“Teste”字符串的 H1。
在我的 Sinatra 应用程序中，我有一个 get 路由和一个重定向到 get 的 post 路由。
heroku 日志没有特别显示任何内容，没有任何错误或警告。

这是我的 Facebook 应用程序配置的屏幕截图： ![在此处输入图像描述](../Images/4e2d7e14f342207e6a1bb5e2fdefb8f7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:03:23.507

默认情况下，Sinatra 具有对帧的保护。

你需要使用这个：

```
set :protection, except: [:frame_options] 
```

在你的 app.rb

这将允许您将您的网站用作 iframe。[在http://www.sinatrarb.com/intro.html#Configuring%20attack%20protection](http://www.sinatrarb.com/intro.html#Configuring%20attack%20protection)阅读更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:43:52.950

当您尝试在选项卡中查看应用程序时，您是否看到任何错误消息？您的应用程序是否处于沙盒模式？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:30:26.960

您的“安全页面标签 URL”和“页面标签 URL”都设置为 HTTPS URL - 您需要将“页面标签 URL”设为 HTTP URL。

此外，您的服务器没有正确处理 POST 请求（或者至少，当我尝试时返回一个空白页面） - 来自 Facebook 的页面加载将是一个 HTTP POST 请求，其`signed_request`参数为您的应用程序提供有关页面的详细信息和当前加载应用的用户

```
curl -i -F 'test=test' http://sinatra-dev-test.herokuapp.com
HTTP/1.1 100 Continue

HTTP/1.1 303 See Other 
Content-Type: text/html;charset=utf-8
Date: Wed, 11 Jul 2012 20:29:58 GMT
Location: http://sinatra-dev-test.herokuapp.com/
Server: WEBrick/1.3.1 (Ruby/1.9.2/2011-07-09)
X-Frame-Options: sameorigin
X-Xss-Protection: 1; mode=block
Content-Length: 0
Connection: keep-alive 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T10:48:10.113

“您的‘安全页面标签 URL’和‘页面标签 URL’都设置为 HTTPS URL - 您需要将‘页面标签 URL’设为 HTTP URL。”

igy，没有必要在“页面标签 URL”中使用 HTTP URL

# javascript - 如何停止 JavaScript 区间函数的执行？

> ID：11434097
> 
> 赞同：1
> 
> 时间：2012-07-11T13:47:39.840
> 
> 标签：javascript, jquery, setinterval

我在 setIntervel() 中有一个函数，我想明确地停止执行这个函数。我该怎么做？这个函数是..

```
function autoLoad(chatboxtitle, msgId) {
    setInterval(function() {
        if (msgId != '') {
            $.ajax({
                type: "POST",
                url: "../WebService1.asmx/GetMessagesDetail",
                data: '{ "messageID": "' + msgId + '" }',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: true,
                cache: false,
                success: function(msg) {
                    $("#chatbox_" + chatboxtitle + ".chatboxcontent").empty();
                    $("#chatbox_" + chatboxtitle + ".chatboxcontent").append(msg.d);
                    $contentLoadTriggered = false;
                },
                error: function(x, e) {
                    alert("error");
                }
            });
        }
    }, 8000);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T13:49:32.543

如果您的意思是退出函数但不停止间隔（因此函数将再次触发），您需要简单地`return`从函数中。

如果您的意思是停止间隔，即停止函数再次触发，您需要在变量中分配对间隔的引用，然后在需要时/根据需要清除它。

```
var intie = setInterval(function() { alert('hello'); }, 5000);
clearInterval(intie); 
```

# xml - 如何将 XSD 属性名称定义为正则表达式？

> ID：11434098
> 
> 赞同：1
> 
> 时间：2012-07-11T13:47:40.580
> 
> 标签：xml, regex, xsd

XML 允许 Q 的可变数量的属性后跟一个数字，像这样

```
<recognitionPattern Q0="12.5" Q1="12.5" Q2="12.5" Q3="12.5" Q4="12.5" Q5="12.5" Q6="12.5" Q7="12.5"/> 
```

我当前的解决方案如下所示：

```
<xs:complexType name="PerQuarterDoubleHack"> <!-- YUCK! /> -->
<xs:attribute name="Q0"                 type="xs:double"       />
<xs:attribute name="Q1"                 type="xs:double"       />
<xs:attribute name="Q2"                 type="xs:double"       />
<xs:attribute name="Q3"                 type="xs:double"       />
<xs:attribute name="Q4"                 type="xs:double"       />
<xs:attribute name="Q5"                 type="xs:double"       />
<xs:attribute name="Q6"                 type="xs:double"       />
<xs:attribute name="Q7"                 type="xs:double"       />
</xs:complexType> 
```

我已经看到很多正则表达式应用于该值，但从来没有一个属性名称。除了更改 XML，我还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T13:54:36.750

XML Schema 不允许您对属性**名称**应用任何验证，只对它的**值**应用验证。如果可能的话，最好的办法是将 XML 更改为以下内容：

```
<recognitionPattern>
    <quarter id="0">12.55</quarter> <!-- equivalent to Q0 -->
    <quarter id="1">12.55</quarter> <!-- equivalent to Q1 -->
    <quarter id="2">12.55</quarter> <!-- equivalent to Q2 -->
    <quarter id="3">12.55</quarter> <!-- equivalent to Q3 -->
</recognitionPattern> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T16:33:41.383

这是一个非常糟糕的 XML 设计。通常，XML 处理工具假定应用程序静态地知道所有元素和属性名称，如果不是这样，编写应用程序将很困难。如果有机会，请更改设计。

# c# - 无法将哈希和盐密码与数据库值匹配

> ID：11434100
> 
> 赞同：0
> 
> 时间：2012-07-11T13:47:44.800
> 
> 标签：c#, asp.net, hash, salt

我正在开发一个应用程序，员工将首先通过输入登录 ID 和密码注册到系统。密码经过散列和加盐处理并存储在登录表中（这两个值都与 loginID 值一起存储）。但是，当我通过代码并登录到应用程序（在注册过程之后）时，哈希值和盐值永远不会匹配。

当他们登录系统时，我将如何验证用户的密码？

**加密功能：**

```
protected static void EncryptPassword(eWebEmployee oEmp)
{
    // Create Hash & Salt
    sysSecurity oSecurity = new sysSecurity();
    oEmp.EmpPasswordSalt = oSecurity.CreateSalt(5);
    oEmp.EmpPasswordHash = oSecurity.CreatePasswordHash(oEmp.EmpPasswordSalt, oEmp.EmpPassword);        
} 
```

**数据库调用：**

```
oDbConn.Open();
DbDataReader oDbDataReader = oDbCommand.ExecuteReader();
while (oDbDataReader.Read())
{
    if (!oDbDataReader.IsDBNull(0) && !oDbDataReader.IsDBNull(1))
    {
        if (oEmp.EmpPasswordSalt == oDbDataReader.GetString(1)
            && oEmp.EmpPasswordHash == oDbDataReader.GetString(0))
        {
            return true;
        }
        else
        {
            return false;
        }
    }
    else
    {
        return false;
    }
}
oDbConnection.Close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:58:05.780

我阅读您的代码的方式每次都会创建一个新的盐。您应该从数据库中获取盐，使用用户提供的密码计算哈希，然后将哈希与存储在数据库中的哈希进行比较。如果它们相等，则用户输入了正确的密码。仅在注册时创建新盐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T13:59:50.347

理解代码的目的有点困难，但通常您使用盐值和密码字符串创建散列。当您再次登录时，您使用相同的盐值执行完全相同的操作。然后将密码哈希与您的数据库中的密码进行比较。

# java - 使用 OpenJPA 1.0 的 Websphere 7 EAR

> ID：11434101
> 
> 赞同：0
> 
> 时间：2012-07-11T13:47:46.390
> 
> 标签：java, xml, jpa, openjpa, websphere-7

我们有一个 EAR 应用程序，其中包含一个 WAR、实用程序项目和一个 JPA 项目。JPA 项目包含我们所有的实体类，在 META-INF 目录中是我们的 persistence.xml，其定义如下：

```
 <?xml version="1.0" encoding="UTF-8"?>
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
    <persistence-unit name="TestJPA">
        <description>openjpa</description>
        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
        <jta-data-source>jdbc/TestSource</jta-data-source>
        <class>model.TestTable1</class>
        <class>model.TestTable2</class>
    </persistence-unit>
</persistence> 
```

我们的 web.xml 包含持久性单元的以下内容。

```
 <persistence-unit-ref>
    <persistence-unit-ref-name>peristence/TestJPA</persistence-unit-ref-name>
    <persistence-unit-name>TestJPA</persistence-unit-name>
  </persistence-unit-ref> 
```

在我们的网络服务中，我们有以下内容：

```
@PersistenceContext(name="peristence/TestJPA", unitName="TestJPA")
private EntityManagerFactory emf; 
```

部署应用程序时，emf 永远不会被实例化。它始终为空。我们也尝试过@PersistenceUnit，有无参数。

我们还尝试了一种不同的方法，即使用 InitialContext 查找来获取 EntityManager。使用这种方法会引发异常，即找不到资源名称。

我们尝试的最后一种方法如下：

```
em = (EntityManager) Persistence.createEntityManagerFactory("TestJPA"); 
```

这会产生以下异常

```
java.lang.ClassCastException: com.ibm.ws.persistence.EntityManagerFactoryImpl incompatible with javax.persistence.EntityManager 
```

我已经查找了有关使用 EAR 部署 OpenJPA 的各种教程，但所有这些教程要么适用于 JPA 2，要么适用于带有 Spring 的 OpenJPA 1。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:54:25.417

//尝试这个

@PersistenceContext(name="TestJPA") 私有 EntityManager em;

我建议深入研究您的 WAS 7 并使用这些库。如果您使用非 ibm 库，甚至 JDK，WAS 就是一场噩梦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T21:15:23.130

在 Web 模块中，您应该使用 PersistenceUnit 而不是 PersistneceContext。尝试以下注入：

```
@PersistenceUnit(unitName="TestJPA")
EntityManagerFactory emf;

...
EntityManager em = emf.createEntityManager();
...
em.close(); 
```

另外，您使用的是哪种网络服务？如果您使用的是第三方 WS 引擎，注释集成可能不起作用。

# jasper-reports - iReport 在有波斯语文本时停止响应

> ID：11434114
> 
> 赞同：0
> 
> 时间：2012-07-11T13:48:20.700
> 
> 标签：jasper-reports, ireport

我有一个奇怪的问题，我们使用 iReport 和 JasperReports 1.2.8 已经很长时间了，我们团队中的每个人都很高兴。

在我们的新项目中，我们计划升级 iReport 和 JasperReports，因此我们从最新版本 4.6 开始。

作为测试，我创建了一个空白报告，在其中放入了一个静态文本，一切都很好，但是当我编辑静态文本并在其中放入一些波斯语文本时，我无法再编辑内容了。

每次我尝试编辑静态文本的内容时，iReport 停止响应，当我在 Windows 任务管理器中对其进行监控时，我看到 iReport 的 CPU 使用率为 25%（我有一个 4 核 CPU）并且 iReport 的内存使用率开始增长，除了杀死它的进程，我什么也做不了。

我已经将 iReports 降级到 4.5.1、4.1.3、4.0.1、3.7.6，我也遇到了同样的问题。

我该如何解决这个问题？有没有人遇到过这个问题？

# c++ - 存储指向类实例的指针（这不起作用）

> ID：11434117
> 
> 赞同：-3
> 
> 时间：2012-07-11T13:48:30.173
> 
> 标签：c++, class, pointers

我正在创建一个非常简单的基于组件的游戏引擎。我有一个实体类，它存储要迭代的组件列表。

实体类还存储名称、位置、缩放等信息。我需要每个组件存储对拥有它的实体实例的引用。我最初尝试使用“this”关键字，但它不起作用，因为您不能在作业中使用它。

```
void Entity::addComponent(Component *theComponent){
    components.push_back(theComponent);
    theComponent->ownerEntity = this;
} 
```

组件如何存储指向其所有者的指针？

谢谢你的帮助！

编辑：组件类几乎没有任何内容，因为它打算被继承，但这是它的声明：

```
class Entity;

class Component
{
    public:
        Component();
        virtual void Update();
        Entity *ownerEntity;
    protected:
    private:

}; 
```

如果我尝试像这样访问所有者实体，则在制作组件时：

```
rotation = ownerEntity->GetRotation; 
```

我收到此错误：

```
error: argument of type 'float (Entity::)()' does not match 'float' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T13:55:55.563

```
rotation = ownerEntity->GetRotation; 
```

应该：

```
rotation = ownerEntity->GetRotation(); 
```

调用函数。

# mysql - MySQL按最大值选择DISTINCT

> ID：11434124
> 
> 赞同：7
> 
> 时间：2012-07-11T13:48:44.343
> 
> 标签：mysql

我有一张满是杂志的桌子，需要提取每本杂志的最新一期。

我试过了

```
 SELECT DISTINCT
    magazine
        FROM
    product p
        INNER JOIN
    (SELECT 
        title, MAX(onSale) AS Latest
    FROM
        product
    GROUP BY magazine) groupedp 
```

它返回不同的杂志，但不返回我需要的其余数据。

更新：

图式

```
-id----onsale----magazine
  1    1/12/12   Fishing Mag
  2    1/11/12   Fishing Mag
  3    12/03/11  Pencil Sharpening Monthly
  4    1/02/10   Pencil Sharpening Monthly
  5    16/04/09  Homes in the Sky 
```

所以我想要返回的结果是：

```
 -id----onsale----magazine
   1    1/12/12   Fishing Mag         
   3    12/03/11  Pencil Sharpening Monthly         
   5    16/04/09  Homes in the Sky 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-11T14:17:37.030

```
SELECT 
    p.*
FROM
        product p
    INNER JOIN
        ( SELECT 
              magazine, MAX(onSale) AS latest
          FROM
              product
          GROUP BY 
              magazine
        ) AS groupedp
      ON  groupedp.magazine = p.magazine
      AND groupedp.latest = p.onSale ; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-11T14:49:30.607

```
SELECT id, MAX(onSale) as latest, magazine
FROM product
GROUP BY magazine
ORDER BY latest DESC 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-08-02T03:55:52.573

给出的答案都不是正确的，因为它们返回一组不相关的数据，这些数据不代表一个确切的行。`id`可能与值不在同一`id`行`onsale`。

以下将起作用：

```
SELECT
    id, onsale, magazine
FROM (
    SELECT
       id, onsale, magazine
    FROM
        product
    ORDER BY
        onsale DESC) AS a
GROUP BY
    magazine 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-11T14:38:01.753

这看起来像你需要的：

```
SELECT id, MAX(onsale) AS onsale, magazine FROM magazines GROUP BY magazine ORDER BY onsale DESC; 
```

在以下位置查看：

[http://sqlfiddle.com/#!2/38e78/3](http://sqlfiddle.com/#!2/38e78/3)

**更新：** 我稍微改变了查询，返回 MAX(onsale)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-11T13:52:37.960

您需要将“其余数据”放在第一个选择中：

```
SELECT DISTINCT magazine, "rest of data"
FROM product p 
INNER JOIN 
( SELECT title, MAX(onSale) AS Latest 
FROM product 
GROUP BY magazine ) groupedp 
```

# linux - 为了安全起见，安装 Magento 后哪些文件应该是可写的？

> ID：11434126
> 
> 赞同：0
> 
> 时间：2012-07-11T13:48:51.290
> 
> 标签：linux, apache, security, magento

在 LAMP 服务器上安装/设置 Magento 后，哪些文件应保持可写、可读和/或可执行（由所有者、组、公共）？

什么是安全的 magento 服务器的最佳选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:25:52.123

所有文件夹应为 775 所有文件应为 664。

现在例外：/var 应该对每个人都是可写的 (777) /media 文件夹应该允许网络在其中写入。

如果您有 SSH 访问权限，则可以运行它们：

```
find . -type d -exec chmod 775 {} \;
find . -type f -exec chmod 664 {} \; 
```

至少这是[Magento Wiki](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/magento_filesystem_permissions)所建议的。

# c# - 使用 jQuery 添加标题属性，其中值来自 .NET 字典 (ASP.NET MVC 3)

> ID：11434128
> 
> 赞同：0
> 
> 时间：2012-07-11T13:49:00.927
> 
> 标签：c#, jquery, .net, asp.net-mvc-3

我有一个由 HTML.ListBoxFor 生成的多选列表。选择元素的 id 为“#listBox”

我想为每个选项标签添加一个标题属性。title 属性的值来自一个`Dictionary<string,string>`.

我想做以下

遍历选择列表的选项元素并获取选项元素的文本

遍历 Dictionary 的每个元素

在哪里`dictionary.key == text` 添加一个值为 Dictionary.Value 的标题属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T05:42:40.840

查看这篇文章[添加属性以选择列表选项](https://stackoverflow.com/questions/11285303/store-extra-value-per-item-in-drop-down-list/11285916#11285916)。它允许您将所需的任何属性放入下拉列表的选项中。

# c# - OrderBy 嵌入文档

> ID：11434131
> 
> 赞同：2
> 
> 时间：2012-07-11T13:49:01.760
> 
> 标签：c#, mongodb, mongodb-.net-driver

我正在尝试按嵌入文档中的值对结果进行排序。

考虑一个模型，例如：

```
public class Car
{
    public Guid ID { get; set; }
    public string Name { get; set; }

    public IEnumerable<Passenger> Passengers { get; set; }
}

public class Passenger
{
    public Guid ID { get; set; }
    public virtual string Name { get; set; }
    public virtual int Age { get; set; }
} 
```

我正在尝试查询我的`Car`收藏，并按Passenger.Age 订购

我的查询类似于：

```
var results = (from car in _db.GetCollection<Car>("car").AsEnumerable()
              from passenger in car.Passengers
              where car.Name == "Ford"
              orderby passenger.Age).ToList(); 
```

有了这个，我得到以下异常：

> 不支持 SelectMany 查询运算符。

这是可以理解的 C# mongo 驱动程序的限制。
有解决方法吗？

如果做不到这一点，我怎么能在我的 .ToList() 之后订购它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:26:14.987

您可能可以重新编写它以从后面`AsQueryable()`获取一个`IEnumerable`集合`ToList()`，然后您可以从中进一步查询您想要使用的任何 LINQ，而不仅仅是直接支持的操作`MongoCollection`：

```
var passengers = _db.GetCollection<Car>("car").AsQueryable().ToList()
    .Where(car => car.Name == "Ford")
    .SelectMany(ford => ford.Passengers)
    .OrderBy(p => p.Age); 
```

您可以在此处找到[MongoDb C# 驱动程序直接支持的 LINQ 操作](http://www.mongodb.org/display/DOCS/CSharp+Driver+LINQ+Tutorial#CSharpDriverLINQTutorial-SupportedLINQqueryoperators)。

# java - 接口和抽象类广告方法覆盖

> ID：11434137
> 
> 赞同：4
> 
> 时间：2012-07-11T13:49:29.877
> 
> 标签：java, class, interface, abstract-class, overriding

这是代码：

```
interface hi
{
    public void meth1();
}
abstract class Hullo
{
    public abstract void meth1();
}
public class Hello extends Hullo implements hi
{
    public void meth1(){}
} 
```

问题：代码编译和一切。我想知道 Hello 类中的 meth1() 覆盖了哪个 meth1()？接口中的ont或抽象类中的ont，为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T13:50:31.140

答案很简短：两者都......

事实上，正确地说：你没有*覆盖*它们，你正在用一种方法*实现它们。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T10:33:00.877

通常我们覆盖一个已经有一些定义的现有方法。我的意思是，与超类相比，我们在子类中添加了一些额外的功能。由于这两种方法都是抽象的，所以我们可以说我们实现了未实现的方法。

**您可以参考在 Java 中创建线程，与扩展 Thread 类相比，我们更喜欢实现 Runnable 接口。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-11T10:58:41.957

绝对正确的问题。

这里接口和抽象类都有相同的方法。

您有一个类名为 hello 并扩展了抽象类并实现了接口，它是 true 并且您在 hello 类上覆盖了 meth1 方法，它很好，并且可以正确编译并且没有给出任何错误，但是您无法确定哪个类方法像抽象类一样被覆盖或界面。

这是运行时多态性，您不能创建抽象类和接口的对象，但可以创建其引用变量。这里的解决方案是您无法在编译时识别它在运行时的实际覆盖。

```
 interface hi
{
    public void meth1();
}
abstract class Hullo
{
    public abstract void meth1();
}
public class Hello extends Hullo implements hi
{
    public void meth1(){
        System.out.println("hello");
    }
        hi h= new Hello();
        h.meth1();//its means interface method is override. and its decide when we call method.
        hullo hu= new Hello();
        hu.meth1();//its means abstract class method is override.
} 
```

# xcode - facebook集成代码设计错误

> ID：11434142
> 
> 赞同：0
> 
> 时间：2012-07-11T13:49:41.517
> 
> 标签：xcode, facebook

我正在尝试将 facebook 集成到我的应用程序中

1 / 我尝试了静态库（用于 arc 项目）并有一条消息说“该库不是为您当前的目标（armv7）构建的”。我阅读了数百篇文章并且无法解决 pb。

2/现在我只是拖放 src 并将标志 -fno-objc-arc 放到所有添加的标志上。

还是不行！！！

这是我的错误信息：

```
CodeSign /Users/sylvainguilbert/Library/Developer/Xcode/DerivedData/Aviso_0.1-fhjiibqwcoohxmcueawtpqtjuknh/Build/Products/Debug-iphoneos/Aviso_0.1.app
cd /Users/sylvainguilbert/Documents/dev/Aviso_0.1
setenv CODESIGN_ALLOCATE /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/codesign_allocate
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/usr/bin/codesign --force --sign 752c4685452b4d64922b21157564304b5db0e616 --resource-rules=/Users/sylvainguilbert/Library/Developer/Xcode/DerivedData/Aviso_0.1-fhjiibqwcoohxmcueawtpqtjuknh/Build/Products/Debug-iphoneos/Aviso_0.1.app/ResourceRules.plist armv7 armv6 --entitlements /Users/sylvainguilbert/Library/Developer/Xcode/DerivedData/Aviso_0.1-fhjiibqwcoohxmcueawtpqtjuknh/Build/Intermediates/Aviso_0.1.build/Debug-iphoneos/Aviso_0.1.build/Aviso_0.1.xcent /Users/sylvainguilbert/Library/Developer/Xcode/DerivedData/Aviso_0.1-fhjiibqwcoohxmcueawtpqtjuknh/Build/Products/Debug-iphoneos/Aviso_0.1.app 
```

armv7：没有这样的文件或目录命令 /usr/bin/codesign 失败，退出代码为 1

这让我发疯，我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T01:11:28.447

我在这里找到了答案：[Command /usr/bin/codesign failed with exit code 1: i386: No such file or directory](https://stackoverflow.com/questions/8869607/command-usr-bin-codesign-failed-with-exit-code-1-i386-no-such-file-or-directo)

当我删除它们（从我的项目和目标中）时，我的构建设置中有 armv6 armv7 一切都很好。

# ruby-on-rails-3 - Rails 3 密码保护单视图

> ID：11434144
> 
> 赞同：0
> 
> 时间：2012-07-11T13:49:45.977
> 
> 标签：ruby-on-rails-3, password-protection

我浏览并查看了一堆屏幕截图（http://railscasts.com/episodes/270-authentication-in-rails-3-1）和教程（http://ruby.railstutorial.org/chapters/ model-and-viewing-users-two?version=2.3#sec:secure_passwords) 但我似乎无法找到或应用我正在学习的内容来创建受保护的单视图密码。

截至目前，我正在生成一个随机密码并将其显示给用户以返回并查看他们上传的文件（使用 SecureRandom.hex 生成）。但是，我知道当我将 http_basic 仅限制为控制器中的显示视图和方法时，使用它似乎不起作用：`http_basic_authenticate_with :password => :passcode, :only => :show`

我知道那行代码不起作用，因为 :passcode 没有引用创建的单个文件密码。

另外，我知道 http_basic_authenticate_with 不是安全密码应该采用的方式，那么你将如何使用 has_secure_password 等来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:56:41.487

您可以尝试将 封装`http_basic_authenticate_with :password => :passcode`在控制器中的方法中，然后调用`before_filter`来调用该方法。
像这样的东西：

```
before_filter :restrict, :only => :show

def show
end

def restrict
  http_basic_authenticate_with :password => :passcode
end 
```

# sql - 从 sql 中选择最佳 100 名玩家

> ID：11434147
> 
> 赞同：1
> 
> 时间：2012-07-11T13:49:59.737
> 
> 标签：sql, sql-server-2008

我有列的表：

```
PlayerId
Points 
```

我想获得 100 名最佳球员（球员得分越多，他就越好）。对此有何疑问？

我正在使用 sql server 2008

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T13:51:15.720

```
SELECT TOP 100 PlayerId
FROM TableName
ORDER BY Points DESC 
```

分解它：

*   `TOP 100`- 选择前 100 条记录返回。
*   `ORDER BY Points DESC`- 按`Points`字段对结果进行排序，并将`DESC`它们设置为反向数字（假设`Points`是整数数据类型）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T13:51:17.780

您需要从查询中选择前 X，然后按降序排列。

```
select top 100 * from players order by Points DESC 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T13:57:24.590

当两个或更多玩家得分相同时会发生什么？或者更糟糕的是，如果你有 120 个玩家得分最高会发生什么。您应该使用一个返回每个玩家的查询。`RANK`如果是这种情况，我建议您使用。

```
;WITH CTE AS
(
    SELECT *, RANK() OVER(ORDER BY Points DESC) RN
    FROM Players
)
SELECT *
FROM CTE
WHERE RN <= 100 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T13:51:28.393

```
SELECT TOP 100 PlayerID 
FROM <<Table>> 
ORDER BY Points DESC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T13:51:57.123

假设您的表名是`Players`：

```
SELECT TOP 100 PlayerId, Points
FROM Players
ORDER BY Points DESC 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-11T13:51:59.853

```
SELECT TOP 100 PlayerId FROM name_of_your_table ORDER BY Points DESC 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-11T13:52:13.573

```
SELECT TOP 100 *
FROM tblName ORDER BY Points DESC 
```

# iphone - UITextView ：更改文本颜色会修改文本位置

> ID：11434154
> 
> 赞同：0
> 
> 时间：2012-07-11T13:50:13.980
> 
> 标签：iphone, objective-c, ios, uitextview, uicolor

我有一个 UITextView，里面有一个小文本。它以白色背景上的黑色文本正确显示。但是，当我想将文本颜色更改为黑色以外的颜色时，文本位置会发生变化（好像在文本开头添加了一个空行）。

没有颜色变化或有`textView.textColor = [UIColor blackColor];`：

![正确显示黑色](../Images/bbc0a2d4ad1c830690e8f037138e02de.png)

当我换成另一种颜色时，这里`textView.textColor = [UIColor blueColor];`：

![使用任何其他颜色显示不正确](../Images/7fdc398ed6299e14e27ae527476837de.png)

**我给出的代码行确实是唯一改变的代码元素，**即使背景和文本中的颜色不同，这是因为它们是随机生成的，在我的代码的完整其他部分中。文本的内容以前**从未**对显示产生任何影响，当我更改文本颜色时，它**总是**看起来像第二张图片。

我对这种行为感到震惊，因为`textColor`不应该修改字体颜色以外的任何东西，不是吗？再加上当我更改为 时`blackColor`，没有奇怪的行为。

谢谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:10:59.263

`"the different colours in the background are generated somewhere else"` means Where do you exactly change the colors?

You are changing some thing like

a)`autoresizing` the views (or)

b)`Aligning` text in that view (or)

c)`Frame` size of your textView can be smaller than the `font size` of your textview (or)

d)your text would be `longer than actual size of the frame`.

I would like to ask you one question. Why do you use `UITextView` instead of `UILabel`?? I'm asking because textview will bring the `scrollview`, when the text is longer than your frame size.Probably that would be your problem I hope..

# visual-studio - SSRS - 参数 - SELECT ALL vs ALL - 如何删除 ALL 选项

> ID：11434162
> 
> 赞同：3
> 
> 时间：2012-07-11T13:50:38.940
> 
> 标签：visual-studio, tsql, reporting-services, report, ssas

请看这个ss![截屏](../Images/c677a100eba0a177223080de473c45f4.png)

我正在使用 SSRS 2008 + 从多维数据集中提取数据并将 Country 作为我的参数。

我想保留“全选”选项，但删除“全选”选项。

我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:54:40.523

您需要将 ALLMEMBERS 函数替换为 CHILDREN 函数。

[http://www.bidn.com/blogs/ChrisAlbrektson/bidn-blog/1452/mdx-ssrs-how-to-remove-the-all-member-from-your-parameter](http://www.bidn.com/blogs/ChrisAlbrektson/bidn-blog/1452/mdx-ssrs-how-to-remove-the-all-member-from-your-parameter) <--会告诉你我的意思

# c# - 通过 ASP.Net 网站下载文件

> ID：11434164
> 
> 赞同：1
> 
> 时间：2012-07-11T13:50:53.950
> 
> 标签：c#, asp.net, download

我正在向我的网站用户推送 PEM 文件以供下载。这是代码：

```
try
{
    FileStream sourceFile = null;

    Response.ContentType = "application/text";
    Response.AddHeader("content-disposition", "attachment; filename=" + Path.GetFileName(RequestFilePath));
    sourceFile = new FileStream(RequestFilePath, FileMode.Open);
    long FileSize = sourceFile.Length;
    byte[] getContent = new byte[(int)FileSize];
    sourceFile.Read(getContent, 0, (int)sourceFile.Length);
    sourceFile.Close();
    Response.BinaryWrite(getContent);
}
catch (Exception exp)
{
    throw new Exception("File save error! Message:<br />" + exp.Message, exp);
} 
```

问题是下载的文件也包含应该存在的内容 + 整个网页 HTML 的副本。

这里发生了什么事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T13:53:44.070

放置以下...

```
Response.Clear(); 
```

前...

```
Response.ContentType = "application/text"; 
```

**更新**

正如@Amiram 在他的评论中所说的那样（无论如何我正要添加自己）......

后...

```
Response.BinaryWrite(getContent); 
```

添加...

```
Response.End(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T13:54:41.080

添加这一行：

```
Response.ClearContent();
Response.ContentType = "application/text";
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T06:17:01.137

我同意[@Amiram Korach 的解决方案](https://stackoverflow.com/a/11434245/1369235)。
也就是`Response.ClearContent();`之前添加`Response.ContentType...`

但根据[你的评论](https://stackoverflow.com/questions/11434164/download-a-file-through-asp-net-website#comment15085065_11434245)

> 仍然写了整个页面

[@Amiram Korach 在最后回复](https://stackoverflow.com/questions/11434164/download-a-file-through-asp-net-website#comment15085087_11434245)添加`Response.End()`。
但它抛出`System.Threading.ThreadAbortException`。

所以我建议你添加额外`catch`的 catch`System.Threading.ThreadAbortException`并且不要把错误信息放进去，`Response.Write`否则它也会被添加到你的文本文件中：

```
try
{
    FileStream sourceFile = null;
    Response.ClearContent(); // <<<---- Add this before `ContentType`.
    Response.ContentType = "application/text";
    .
    .
    Response.BinaryWrite(getContent);
    Response.End(); // <<<---- Add this at the end.
}
catch (System.Threading.ThreadAbortException) //<<-- Add this catch.
{
    //Don't add anything here.
    //because if you write here in Response.Write,
    //that text also will be added to your text file.
}
catch (Exception exp)
{
    throw new Exception("File save error! Message:<br />" + exp.Message, exp);
} 
```

这将解决您的问题。

# php - 创建文件夹和分类sql数据

> ID：11434165
> 
> 赞同：0
> 
> 时间：2012-07-11T13:50:55.603
> 
> 标签：php, sql

我创建了一个站点，您可以在其中上传和下载文件，所有文件都保存在文件夹中，文件名保存在数据库中。

上传的文件显示在表格中，效果几乎完美:)

现在我想添加一个功能，允许用户创建自己的文件夹并将文件移动到其中。如果您有图像，为什么不创建一个名为 i images 的文件夹并将所有图像文件移动到其中。

我的问题是，由于我还是个新手，我不知道该怎么做？，文件应该移动到 ftp 内的新文件夹吗？或者我可以创建以便文件名移动到新数据库吗？

还是有其他方法？

网络空间有教程吗？

所有的帮助都是很好的帮助:)

谢谢

# android - 在 Android 应用内计费中在哪里更新数据库？

> ID：11434167
> 
> 赞同：0
> 
> 时间：2012-07-11T13:51:01.127
> 
> 标签：android, in-app-billing

我下载了 android 应用内计费示例“Dungeons”应用程序并对其进行了测试。但我不想使用它的数据库。我想更新我自己的数据库，但我找不到在哪里可以更新我购买的数据库回复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:00:00.583

```
 private class DungeonsPurchaseObserver extends PurchaseObserver {
    public DungeonsPurchaseObserver(Handler handler) {
        super(BusinessPunkBase.this, handler);
    }

    @Override
    public void onBillingSupported(boolean supported) {
            //Here you can update your DB

    }

    @Override
    public void onPurchaseStateChange(PurchaseState purchaseState,
            String itemId, int quantity, long purchaseTime,
            String developerPayload) {
        //Here you can update your DB

    }

    @Override
    public void onRequestPurchaseResponse(RequestPurchase request,
            ResponseCode responseCode) {

    }

    @Override
    public void onRestoreTransactionsResponse(RestoreTransactions request,
            ResponseCode responseCode) {
        //Here you can update
    }
} 
```

# c# - 为使用 IoC.Resolve() 的服务创建单元测试的最佳方法是什么

> ID：11434171
> 
> 赞同：2
> 
> 时间：2012-07-11T13:51:11.297
> 
> 标签：c#, .net, unit-testing, ioc-container

我通过构造函数注入使用 IoC 容器而不是 DI。有些人可能会问为什么我使用 IoC 容器而不是构造函数注入。出于此处所述的原因：[为什么我需要一个 IoC 容器而不是简单的 DI 代码？](https://stackoverflow.com/questions/871405/why-do-i-need-an-ioc-container-as-opposed-to-straightforward-di-code). 但是，我发现为我的服务创建单元测试很困难。我不确定如何在运行时模拟我的服务使用的存储库，因为我没有使用构造函数注入（一个难题）。任何人有任何解决方案？

例如：

```
public class SomeService
{
    private ISomeServiceRepository someServiceRepository;

    public GetSomeThing()
    {
        //how do I mock this repository in my unit test
        someServiceRepository = IoC.Resolve<ISomeServiceRepository>();

        someData = someServiceRepository.getData();

        someOtherService = new SomeOtherService();
        someThing = someOtherService.GetSomeThing();

        return FigureOutSomeThingElse(someData, someThing);
    }

    public FigureOutSomeThingElse(someData, someThing)
    {
        //do some figuring
        return somethingElse;
    }
} 

public class SomeOtherService
{
    private ISomeServiceRepository someOtherServiceRepository;

    public GetSomeThing()
    {
        //how do I mock this repository in my unit test
        someOtherServiceRepository = IoC.Resolve<ISomeOtherServiceRepository>();

        var someData = someOtherServiceRepository.getData();
        return someData;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:54:43.307

[人们可以根据需要轻松地发起关于“你做错了”的批评，但我经历过旧代码库无法无私地理解 register-resolve-release 模式的痛苦。但是，我建议不要使用静态容器引用（如 中`IoC.`）并尝试使容器*本身*至少注入。]

在这种情况下，您只需提供 IoC 注册容器的测试版本，但您可以编写测试配置而不是正常的应用程序配置。

这不会是任何真正意义上的嘲弄或存根，事实上这些术语可能会使解决方案相当混乱。

本质上，在单元测试中它只是一个不同的活动配置。您仍然必须手动注册类型，如果当前配置代码位于单元测试的执行路径中，您可能难以禁用当前配置代码。

我们有一个容器，可以根据需要在 IoC 模式中解析（用于少数类型），并且为了测试，我们只需创建一个新容器（基本上，一个用于代码配置，另一个用于单元测试）。我们的用例略有不同，因为我们将容器注入到类中，而不是像您的情况那样具有静态可访问类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T13:58:22.010

你真的不应该在你的类方法中使用 IOC.Resolve 。无论如何，它非常接近于`new`编写您的代码，这是您试图避免使用 DI 的一部分。一种更好、更可测试的编写方式是这样的。

```
Public Class SomeService
{

  ISomeServiceRepository someServiceRepository;

  public SomeService(ISomeServiceRepository someServiceRepository)
  {
    this.someServiceRepository = someServiceRepository
  }

  Public GetSomeThing()
  {

    someData = someServiceRepository.getData();
    ...
  }
} 
```

通过这样做，您可以模拟您的界面并直接注入它。

如果你必须使用`.Resolve`，那么亚当的方法是你能做的最好的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T14:39:58.637

我明白了，这就是我所做的......

（我正在使用 Unity.Net 和 RhinoMock）

*   创建了一个实现 IContainerAccessor 的 baseUnitTest 类

*   在构造函数中创建并初始化 UnityContainer 的新实例

*   创建了实现 IContainerAccessor.Container 的“UnityContainer”只读公共属性

*   创建了一个继承 baseUnitTest 的单元测试类

*   在测试方法中添加了以下代码...

    Mocker = 新 Rhino.Mocks.MockRepository()

    SomeRepository = Mocker.DynamicMock(Of ISomeRepository)()

    MyBase.UnityContainer.RegisterInstance(Of ISomeRepository)(SomeRepository)

    Rhino.Mocks.Expect.Call(Of SomeResult)(SomeRepository.SomeMethod("someArg")).Return(New SomeResult())

    Mocker.ReplayAll()

    someService = 新的 SomeService()

    '此方法使用 IOC.Resolve(ISomeRepository) 并调用 SomeRepository.SomeMethod someResult = someService.someMethod()

    Assert.IsNotNull(someResult)

*   完毕

# hadoop - Hadoop map.input.start 不是线边界？

> ID：11434173
> 
> 赞同：1
> 
> 时间：2012-07-11T13:51:17.557
> 
> 标签：hadoop, streaming, input-split

似乎 map.input.start 属性没有给我一行开始的位置（当然，第一个 map.input.start 是 0 除外）。有时，map.input.start 位于映射器输入的第一行中间的某个位置，有时它位于前一个映射器输入的最后一行中间的某个位置。这是可以预料的吗？如果是这样，我怎样才能获得行的字节偏移量？using`TextInputFormat`不起作用，因为我使用的是 Hadoop 流，它丢弃了映射器的密钥

# c++ - 如何获取给定 PIDL 的 IPortableDeviceContent 接口

> ID：11434180
> 
> 赞同：1
> 
> 时间：2012-07-11T13:51:32.720
> 
> 标签：c++, windows, interface, wpd, mtp

我使用 SHBrowseForFolder() 在 MTP 设备上选择一个文件夹。然后我想从那里复制文件。IPortableDeviceContent 接口（来自 Windows Portable Devices SDK）似乎很合适，但是如何从 SHBrowseForFolder() 返回的带有 PIDL 的对象获取它？

（我问过关于获取 IWMDMStorageControl 接口的类似问题： [How to get IWMDMStorageControl interface for given PIDL](https://stackoverflow.com/questions/11433978/how-to-get-iwmdmstoragecontrol-interface-for-given-pidl)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T19:55:16.577

我们可以通过这种方式从 SHBrowseForFolder() 中获取与 PILD 关联的显示名称：

```
TCHAR DisplayName[MAX_PATH]; // we will get it here
LPITEMIDLIST pidlSelected = SHBrowseForFolder( &bi );
if ( pidlSelected && ! SHGetPathFromIDList(pidlSelected, DisplayName) )
{ // it is media device
    IShellFolder *psfParent;
    LPCITEMIDLIST pidlRelative;
    STRRET str;
    HRESULT hres = SHBindToParent(pidlSelected, IID_IShellFolder, (void**)&psfParent, &pidlRelative);
    if (SUCCEEDED(hres))
    {
        psfParent->GetDisplayNameOf( pidlRelative, SHGDN_FORADDRESSBAR, &str );
        psfParent->Release();
        StrRetToBuf( &str, pidlSelected, DisplayName, sizeof(DisplayName)/sizeof(DisplayName[0]) );
    }
} 
```

然后我们可以解析路径，并通过相同的路径遍历MTP文件结构。这不是优雅的解决方案，但它是我发现的唯一一个。

# eclipse - visibleWhen 与 Eclipse 菜单中的 if else 条件

> ID：11434185
> 
> 赞同：0
> 
> 时间：2012-07-11T13:51:53.170
> 
> 标签：eclipse, eclipse-plugin

我正在尝试根据选择的资源和选择资源的视图来配置弹出菜单的可见性。要匹配的条件是资源所属的项目必须是 java 项目

我需要的是：

1）如果我从编辑器中选择资源，则必须测试条件（例如资源所属的项目是否为java项目）
2）否则如果我从导航视图中选择任何资源，则必须测试相同的条件
3）否则，如果我从 Package-Explorer 视图中选择任何包片段，则必须测试条件。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:13:58.147

您可以使用**test**元素和 org.eclipse.core.resources.projectNature 属性测试器来测试给定的 IResource 是否属于 java 项目。查看其他一些平台提供的[PropertyTesters](http://wiki.eclipse.org/Command_Core_Expressions)以获得更多选项。

# visual-studio-2010 - 是否可以在 Visual Studio 中创建自定义热键绑定命令？

> ID：11434195
> 
> 赞同：1
> 
> 时间：2012-07-11T13:52:13.980
> 
> 标签：visual-studio-2010

例如，我想将 Ctr+H 绑定到键盘 Home 键或 Ctr+l Ctr+b 绑定到键盘 [ 键。我找到了工具 -> 选项 -> 环境 -> 键盘选项，但命令虽然非常广泛，但仍然有限。我希望这是可扩展的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:34:33.493

没有开箱即用的方式来处理自定义键绑定。您需要编写自己的 VS Extension。但是，有一些关于如何执行此操作的非常棒的文档。

[http://msdn.microsoft.com/en-US/library/dd885474.aspx](http://msdn.microsoft.com/en-US/library/dd885474.aspx) - 特定于键绑定的 MSDN 演练。

[http://blogs.msdn.com/b/jasonz/archive/2009/06/01/visual-studio-2010-sdk-beta-1-is-now-live.aspx](http://blogs.msdn.com/b/jasonz/archive/2009/06/01/visual-studio-2010-sdk-beta-1-is-now-live.aspx) - VS 扩展的通用教程

[http://www.microsoft.com/en-us/download/details.aspx?id=2680](http://www.microsoft.com/en-us/download/details.aspx?id=2680) - VS2010 sdk。

# css - 在 HTML 中，块级元素是否应该总是包裹标签？

> ID：11434196
> 
> 赞同：8
> 
> 时间：2012-07-11T13:52:21.777
> 
> 标签：css, html, xhtml

 在 HTML 中，块级元素是否应该总是包裹`<a>`标签？如果标签需要包装块级元素以确保应用正确的样式怎么办？例如这可以

```
<h3><a href="/">Your Header</a></h3> 
```

成为这个

```
<a href="/"><h3>Your Header</h3></a> 
```

注意：我将采用后一种方法来确保应用正确的样式（我正在使用不值得为这个元素重新工作的遗留代码），但是在这样做时我很想知道社区的意见是。 

是的，我已经在 HTML 中读过这个问题[a 和 h1 应该以哪种方式嵌套？](https://stackoverflow.com/questions/5080261/in-html-which-way-round-should-a-and-h1-be-nested)但我不确定`<h3>`标签是否适用不同或更灵活的规则。

参考下面的评论并再次查看代码，我有两种可能的解决方案：

1.  `<h3>`用元素包裹`<a>`元素（在 HTML5 中可以）
2.  添加`.class a`到 CSS 中，使其继承父`div`样式，如下所示：

HTML

```
<div class="class">
    <h3><a href="/">Your Header</a></h3>
</div> 
```

CSS

```
.class, .class a {
    width:296px;
    height:46px;
    overflow:hidden;
    color:#FE5815;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T13:58:26.437

在这种情况下，绝对允许`a`元素包含该`h3`元素，至少根据 HTML5。

`a`元素被称为“透明”元素：它可能包含其父元素可能包含的任何内容。唯一的标准是它可能不包含任何其他“交互式”内容，例如其他`a`元素、`button`元素、`iframe`元素。在这种情况下，假设第一个版本是允许的，那么在 HTML5 下也允许第二个版本。

[这是 HTML5 规范](http://www.w3.org/TR/2011/WD-html5-20110525/text-level-semantics.html#the-a-element)中指定这一点的页面。不幸的是，需要一点解释才能理解...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T23:32:32.837

请注意，在 HTML5 中有一种情况

```
<h3><a href="/">Your Header</a></h3> 
```

将是有效的，但是

```
<a href="/"><h3>Your Header</h3></a> 
```

不会，那是元素的父`<h3>`元素是`<hgroup>`元素的时候。

该`<hgroup>`元素只能有`<h?>`子元素，因此，虽然元素的透明内容模型`<a>`允许`<h3>`成为其子元素，但该`<a>`元素作为 的子元素仍然无效`<hgroup>`。

在这种情况下

```
<hgroup>
  <h3>
    <a href="/">Your Header</a>
  </h3>
</hgroup> 
```

和

```
<a href="/">
  <hgroup>
    <h3>Your Header</h3>
  </hgroup>
</a> 
```

是唯一有效的安排。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:05:49.847

两个都可以

```
<h3><a href="/">Your Header</a></h3>

<a href="/"><h3>Your Header</h3></a> 
```

但是，如果我不在乎锚中的任何内容，我会使用第一个，我只是希望它看起来像`<h3>`

如果我担心锚需求的特定部分，我将使用第二个`<h3>`。为了

下面的例子我需要第二个。

```
<a href="/"> check normal text <h3>check large text</h3></a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T14:10:50.220

在 HTML 4.01 和 XHTML 中，`h3`标签可能包含`a`标签，但反之则不然。

在 HTML5 中，这两种方式都有效。如果`a`标签包含`h3`标签，则`a`标签不得嵌套在不能包含元素的`h3`元素中。

# java - 电子邮件发送问题

> ID：11434205
> 
> 赞同：0
> 
> 时间：2012-07-11T13:52:52.697
> 
> 标签：java, spring

发送带有附件的电子邮件时出现错误。如果我提供静态路径，那么电子邮件发送工作完美文件。但是当我用下面的代码发送文件时不起作用。

```
MultipartHttpServletRequest multipartRequest = (DefaultMultipartHttpServletRequest) request;
    Map<String,MultipartFile> filess = multipartRequest.getFileMap();
    if(filess.size()>0){
        for(MultipartFile ff : filess.values()){
            System.out.println(ff.getOriginalFilename());
            file = new File(ff.getOriginalFilename()); 

        } 
```

电子邮件发送类在传递文件对象时抛出 FileNotFoundException。请帮助我提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:35:57.157

ff.getOriginalFilename() 仅返回客户端在请求中指定的文件的名称，它不会为您提供已上传到服务器的文件的完整路径。您需要使用 ff.getInputStream() 或 ff.getBytes()。

# visual-studio-2010 - Visual Studio 未知生成错误。完全限定名称必须少于 260 个字符

> ID：11434206
> 
> 赞同：35
> 
> 时间：2012-07-11T13:52:56.790
> 
> 标签：visual-studio-2010, build

我在构建 WPF 解决方案时遇到了麻烦。每次我尝试构建它时，都会收到以下错误消息：

> 未知的构建错误，'指定的路径、文件名或两者都太长。完全限定的文件名必须少于 260 个字符，目录名必须少于 248 个字符。

有人可以帮助我吗？我已经验证了所有字段及其扩展路径都可以。这可能是 TortoiseSVN 或类似的问题吗？我最近在我的解决方案中添加了一个文件夹，可以用这个吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-11T14:05:13.717

这是 Windows win32 api 中众所周知的限制。您存储项目的目录嵌套太深。文件的完整路径名不能超过 259 个字符。除此之外，由于缓冲区溢出，许多使用 MAX_PATH 的 C 代码开始失败。

将您的解决方案移至另一个目录，即更接近根目录的目录。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2017-03-30T00:00:25.270

我有一个类似的问题，编译器报告说文件 ASPNETCOMPILER 有问题。实际问题是该解决方案包含一个 node_modules 文件夹，而该文件夹可能包含非常长的路径，并且看起来编译器无法处理这个问题。

Windows 8.1 和 10 可以选择增加 Win32 路径限制：

*   打开组策略编辑器（按 Windows+R 并键入 gpedit.msc 并按 Enter）
*   从组策略编辑器窗口，导航到以下节点：本地计算机策略\计算机配置\管理模板\系统\文件系统
*   双击启用 Win32 长路径选项并启用它。

这可能允许您暂时将问题文件夹移出构建，这可能允许您成功构建，然后您可以将文件夹重新添加到解决方案中而不会影响任何内容。

有关其他参考，请参见此处 - [https://www.microfocus.com/documentation/filr/filr-4/filr-desktop/t47bx2ogpfz7.html](https://www.microfocus.com/documentation/filr/filr-4/filr-desktop/t47bx2ogpfz7.html)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2020-08-25T18:25:15.927

There is registry approach which can be used at least for Windows 10:
Value of the parameter `HKLM\SYSTEM\CurrentControlSet\Control\FileSystem LongPathsEnabled (Type: REG_DWORD)` should be set to 1. [![enter image description here](../Images/1ce553ead711ea26b4cd2eaabcf7ce32.png)](https://i.stack.imgur.com/MwEfU.png) You don't even need top restart anything (IDE or PC).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-23T12:10:44.743

不用担心......这个错误是因为路径名太长，假设您的项目文件夹名称是“myproject”。

您只需更改项目文件夹的位置...将您的项目“myproject”放入 D:\myproject 或 F:\myproject 驱动器。然后您再次发布..它的工作...

快乐的编码...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-08-05T07:32:58.217

这个问题是由于 Windows 操作系统对处理长度大于 260 的长路径的限制造成的。VS2019 的这个问题的解决方案非常简单。但是，对于 VS2017 用户，我们可以使用变通方法来解决问题。

**VS 2019**

*   打开`run`窗口（windows-key + r），然后输入`regedit`并回车。
*   在注册表编辑器的地址栏上，输入：`HKLM\SYSTEM\CurrentControlSet\Control\FileSystem`
*   在右侧，找到 key `LongPathsEnabled`，双击它，然后将值从 更改`0`为`1`
*   重新启动 VS2019，清理（如果需要）并再次构建您的项目。错误应该被修复。

**一般解决方法（VS2017/VS2019）**

我们可以创建一个原始较长路径到较短路径的链接。然后，VS会将较短的路径视为项目根，问题将得到解决。

*   为项目创建一个较短的根路径，例如我们创建了`"D:\project"`目录
*   现在打开 cmd（命令提示符）并使用以下命令创建符号链接：`mklink /D "D:\project\myProject" "YOUR_ACTUAL_LONG_PATH_PROJECT_ROOT_DIRECTORY"` *[如果上述命令执行失败，您可能需要以管理员身份打开 cmd]*
*   现在，从`"D:\project\myProject"`目录中打开 VS 项目，它应该可以工作了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-10T12:38:11.770

这是构建定义工作区“构建代理文件夹位置”VS添加路径示例的问题：$(SourceDir)E:\Somedirectory\ProjectName\ 只需将 $(SourceDir) 保留在字段中

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-01T12:13:27.697

我有同样的问题。我的结帐路径比我的 CI 服务器上使用的路径短。它在 CI 服务器和我所有同事的机器上都可以构建。我们的路径长度相同，因为我们公司有固定长度的用户名。由于路径长，我是唯一无法构建解决方案的机器。

如果您转到这些文件夹：

**C:\Windows\Microsoft.NET\Framework**

**C:\Windows\Microsoft.NET\Framework64**

**C:\Users\[用户名]\AppData\Local\Temp**

找到您在解决方案中使用的 .NET 版本，然后从您认为影响构建的版本中删除“临时 ASP.NET 文件”文件夹。

您可以将它们全部删除，您的下一个 Web 项目构建可能需要更长的时间，因为不会有预编译的程序集...

该解决方案在包含 ASP.NET 项目的解决方案上为我工作 - 它不适用于其他人在他们的答案中提到的 WPF 项目，除非他们的解决方案还包含 ASP.NET 项目。

搜索错误字符串 VS 将您带到这里，所以我认为它可能会帮助其他人，如果不是带有 WPF 构建问题的 Op。

如果这些失败 - 您可以尝试通过执行以下操作递归地搜索解决方案根目录以查找路径大于 260 的文件/文件夹：

*   打开 Powershell

*   光盘`<path to solution root>`

*   `cmd /c dir /s /b |? {$_.length -gt 260} > output.txt`

这会将路径 > 260 的文件列表通过管道传输到 output.txt 文件，该文件将在您的解决方案的根目录中新创建。

这将帮助您在解决方案中找到过长的文件。

# c# - （无法）开始使用 Facebook C# SDK

> ID：11434208
> 
> 赞同：2
> 
> 时间：2012-07-11T13:53:00.520
> 
> 标签：c#, asp.net-mvc, facebook-c#-sdk

我的目标是使用 FB 登录按钮，以便 FB 用户可以登录到我的 ASP.NET MVC 3 网站。Facebook C# SDK 最近似乎发生了一些变化，所有[旧示例](http://facebooksdk.codeplex.com/documentation)都不适用于新版本。我已经尝试了一天让它们工作......我正在完成教程[开始使用 Facebook C# SDK for ASP.NET](http://csharpsdk.org/docs/web/getting-started)

目前，当我浏览它时，`http://localhost:8033/`它似乎会自动让我登录（即使在重新启动 Chrome 之后），因为它显示“ *my-name* uses *my-app-name* ”并显示我的图片。我希望它改为显示一个 FB 登录按钮。当我去时，`http://localhost:8033/Home/About`我得到一个`Session["AccessToken"]`空错误（这是有道理的，因为它显然没有被设置）。

这是我所拥有的：

**家庭控制器.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Facebook;

namespace FacebookTest.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewBag.Message = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            var accessToken = Session["AccessToken"].ToString();
            var client = new FacebookClient(accessToken);
            dynamic result = client.Get("me", new { fields = "name,id" });
            string name = result.name;
            string id = result.id;

            ViewBag.Message = "Hello id: " + id;

            return View();
        }

        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult FacebookLogin(HttpContext context)
        {
            var accessToken = context.Request["accessToken"];
            context.Session["AccessToken"] = accessToken;

            return RedirectToAction("About");
        }
    }
} 
```

**索引.cshtml**

```
@{
    ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>
<p>
    To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
</p>

<div id="fb-root"></div>
<script>
    window.fbAsyncInit = function () {
        FB.init({
            //appId: 'YOUR_APP_ID', // App ID
            appId: '<MY-NUMBER-REMOVED>', // App ID
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true  // parse XFBML
        });

        // Additional initialization code here
        FB.Event.subscribe('auth.authResponseChange', function (response) {
            if (response.status === 'connected') {
                // the user is logged in and has authenticated your
                // app, and response.authResponse supplies
                // the user's ID, a valid access token, a signed
                // request, and the time the access token 
                // and signed request each expire
                var uid = response.authResponse.userID;
                var accessToken = response.authResponse.accessToken;

                // TODO: Handle the access token
                // Do a post to the server to finish the logon
                // This is a form post since we don't want to use AJAX
                var form = document.createElement("form");
                form.setAttribute("method", 'post');
                //form.setAttribute("action", '/FacebookLogin.ashx');
                form.setAttribute("action", '/Home/FacebookLogin');

                var field = document.createElement("input");
                field.setAttribute("type", "hidden");
                field.setAttribute("name", 'accessToken');
                field.setAttribute("value", accessToken);
                form.appendChild(field);

                document.body.appendChild(form);
                form.submit();

            } else if (response.status === 'not_authorized') {
                // the user is logged in to Facebook, 
                // but has not authenticated your app
            } else {
                // the user isn't logged in to Facebook.
            }
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    } (document));
</script>

<div class="fb-login-button" data-show-faces="true" data-width="400" data-max-rows="1"></div> 
```

**关于.cshtml**

```
@{
    ViewBag.Title = "About Us";
}

<h2>About</h2>
<p>
     @ViewBag.Message
</p> 
```

你能告诉我如何解决这个问题，以便显示一个 FB 登录按钮，当点击它时，它会要求用户进行 FB 身份验证，将它们发回，然后我的应用程序将它们识别为登录用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-15T21:58:05.203

**至于登录按钮**，如果您在访问您的应用程序之前登录到 Facebook，您将看到面孔而不是登录按钮，恢复登录按钮的唯一方法是访问 facebook.com 并注销或可能使用 C# SDK 进行 facebook 注销。根据您的要求，这可能是也可能不是您想要的。如果这是您真正想要的，SDK 文档中有一些关于[重新身份验证的内容。](http://developers.facebook.com/docs/authentication/reauthentication/)

我已通过删除 submit() 并用 ajax 帖子替换它来调整您的应用程序，FacebookLogin 操作已更改，并且我在 About 操作上添加了一些错误处理。您的原始应用程序可以运行，但如果您登录 Facebook，它将自动重定向到 About。

**更新**添加了一个不使用 Javascript 的登录链接，插入 appid 和 appsecret 并相应地调整端口号。[这是从这里](https://github.com/facebook-csharp-sdk/facebook-aspnet-sample)找到的服务器端登录示例改编而来的，它比这段代码漂亮得多:)

**注意**在服务器端流中传递的状态值应该是你应该在 ConnectResponse() 方法中验证的唯一值，即在 FacebookLoginNoJs 中生成一个值并确保它在 ConnectResponse 中相同以防止跨站点请求[伪造](http://developers.facebook.com/docs/reference/dialogs/oauth/)

**家庭控制器.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Facebook;

namespace FacebookTest.Controllers
{
    public class HomeController : Controller
    {

        public ActionResult Index()
        {
            ViewBag.Message = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            ViewBag.Message = "Please log in first";

            if (Session["AccessToken"] != null)
            {
                var accessToken = Session["AccessToken"].ToString();
                var client = new FacebookClient(accessToken);

                try
                {
                    dynamic result = client.Get("me", new { fields = "name,id" });
                    string name = result.name;
                    string id = result.id;

                    ViewBag.Message = "Hello id: " + id + " aka " + name;
                }
                catch (FacebookOAuthException x)
                {

                }
            }

            return View();
        }

        public void FacebookLogin(string uid, string accessToken)
        {
            var context = this.HttpContext;
            context.Session["AccessToken"] = accessToken;
        }

        public ActionResult FacebookLoginNoJs()
        {
            return Redirect("https://www.facebook.com/dialog/oauth?client_id=MY-APPID-REMOVED&redirect_uri=http://localhost:45400/Home/ConnectResponse&state=secret");
        }

        public ActionResult ConnectResponse(string state, string code, string error, string error_reason, string error_description, string access_token, string expires)
        {
            if (string.IsNullOrEmpty(error))
            {
                try
                {
                    var client = new FacebookClient();
                    dynamic result = client.Post("oauth/access_token",
                                              new
                                              {
                                                  client_id = "MY-APPID-REMOVED",
                                                  client_secret = "MY-APP-SECRET-REMOVED",
                                                  redirect_uri = "http://localhost:45400/Home/ConnectResponse",
                                                  code = code
                                              });

                    Session["AccessToken"] = result.access_token;

                    if (result.ContainsKey("expires"))
                        Session["ExpiresIn"] = DateTime.Now.AddSeconds(result.expires);

                }
                catch
                {
                    // handle errors
                }
            }
            else
            {
               // Declined, check error
            }

            return RedirectToAction("Index");
        }

    }
} 
```

**索引.cshtml**

```
@{
    ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>
<p>
    To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
</p>

<div id="fb-root"></div>
<script>
    window.fbAsyncInit = function () {
        FB.init({
            //appId: 'YOUR_APP_ID', // App ID
            appId: 'MY-APPID-REMOVED', // App ID
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true  // parse XFBML
        });

        // Additional initialization code here
        FB.Event.subscribe('auth.authResponseChange', function (response) {
            if (response.status === 'connected') {

                var uid = response.authResponse.userID;
                var accessToken = response.authResponse.accessToken;

                var url = '/Home/FacebookLogin';
                $.post(url, { uid: uid, accessToken: accessToken }, function (data) {
                });

            } else if (response.status === 'not_authorized') {
                // the user is logged in to Facebook, 
                // but has not authenticated your app
            } else {
                // the user isn't logged in to Facebook.
            }
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    } (document));
</script>

<div class="fb-login-button" data-show-faces="true" data-width="400" data-max-rows="1"></div>

@Html.ActionLink("The NoJs Login", "FacebookLoginNoJs", "Home") 
```

**关于.cshtml**

```
@{
    ViewBag.Title = "About Us";
}

<h2>About</h2>
<p>
        @ViewBag.Message
</p> 
```

# php - 错误的搜索结果 [MongoDB, Yii]

> ID：11434209
> 
> 赞同：-1
> 
> 时间：2012-07-11T13:53:00.940
> 
> 标签：php, mongodb, yii

我正在使用 Yii 和 yii mongoDb 扩展（YMDS）。

我有一个`->count()`返回正确数量的结果但`->findAll()`没有的情况。

```
 // calculate total numbers of document
        Document::model()->setUseCursor(true);
        $total = Document::model()->count($criteria);
        Document::model()->setUseCursor(false);

        $criteria->sort($sort_by, $direction);
        $criteria->limit($limit);
        $criteria->offset($page);

        if (!($docs = Document::model()->findAll($criteria))) {
            throw new CHttpException(404, 'can not find docs');
        } 
```

所以在`$total`我看到数字 2，但`$docs`只有 1，可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:43:24.730

问题是您误解了`offset()`参数：

```
$criteria->offset($page); 
```

偏移量会跳过给定数量的结果，因此如果 $page 为 1（根据 OP 的评论），则将跳过第一个结果。

在实际用于分页时，您希望偏移量类似于：

```
$criteria->offset($entries_per_page * $current_page_number) 
```

$current_page_number 应该是 0-indexed 所以如果你的 $entries_per_page 是 20 显示页面的偏移量将是：

*   第一页：0
*   第二页：20
*   第三页：40

If you're using Zii widgets like [CListView](http://www.yiiframework.com/doc/api/1.1/CListView) or [CGridView](http://www.yiiframework.com/doc/api/1.1/CGridView) they inherit from Yii's [CPagination](http://www.yiiframework.com/doc/api/1.1/CPagination) pager class which takes care of offset calculations and more.

# html - HTML5 视频 - 是否需要插件？

> ID：11434216
> 
> 赞同：1
> 
> 时间：2012-07-11T13:53:10.907
> 
> 标签：html, video, plugins

我真的对此进行了研究，但我仍然感到困惑。在所有与 HTML5 兼容的浏览器中（尽管在这种情况下，我说的是 Chrome 20 和 Windows 5.1.7 的 Safari），如果我使用标签指定一些视频，那么这个想法应该在用户无需安装插件的情况下播放-ins？还是用户必须安装 WMP / Quicktime 等插件？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:54:43.237

他们将在没有插件的情况下播放。HTML5 的主要用途之一是您不需要任何东西，只需要浏览器即可显示内容……它适用于各种设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T13:56:11.203

不，不需要插件。播放视频所需的代码是浏览器的一部分。

但是，将其委托给浏览器的问题在于，当前每个浏览器支持的视频/音频格式存在不一致。

例如，Chrome 和 IE9 将播放 MP3 音频，但 Firefox 和 Opera 播放不同的格式。

# opengl - 聚光灯的着色器

> ID：11434233
> 
> 赞同：0
> 
> 时间：2012-07-11T13:53:58.877
> 
> 标签：opengl, glsl

我怎样才能让这个着色器在聚光灯上有一个平滑的边缘而不是一个坚硬的边缘？此外，着色器必须处理 GL_SPOT_CUTOFF 的变量值。请注意，并非所有灯光都是聚光灯——GL_LIGHT0 是点光源。

```
varying vec3 N;
varying vec3 v;
#define MAX_LIGHTS 2 
void main (void)  
{  
    vec4 finalColour;
    float spotEffect;

    for (int i=0; i<MAX_LIGHTS; i++)
    {
        vec3 L = normalize(gl_LightSource[i].position.xyz - v);   
        vec3 E = normalize(-v);
        vec3 R = normalize(-reflect(L,N));

        spotEffect = dot(normalize(gl_LightSource[i].spotDirection), 
                         normalize(-L));
        if (spotEffect > gl_LightSource[i].spotCosCutoff) {
            vec4 Iamb = gl_FrontLightProduct[i].ambient;    
            vec4 Idiff = gl_FrontLightProduct[i].diffuse * max(dot(N,L), 0.0);
            Idiff = clamp(Idiff, 0.0, 1.0);     
            vec4 Ispec = gl_FrontLightProduct[i].specular 
                         * pow(max(dot(R,E),0.0),0.3*gl_FrontMaterial.shininess);
            Ispec = clamp(Ispec, 0.0, 1.0);
            finalColour += Iamb + Idiff + Ispec;
        }
    }
    gl_FragColor = gl_FrontLightModelProduct.sceneColor + finalColour; 
```

}

场景是这样的：

![在此处输入图像描述](../Images/b29298039626ccc1875a0b8b56322573.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T18:36:39.807

[这个来自http://www.ozone3d.net/tutorials/glsl_lighting_phong_p3.php](http://www.ozone3d.net/tutorials/glsl_lighting_phong_p3.php)的着色器会为您所追求的聚光灯产生柔和的边缘。

```
[Pixel_Shader]

varying vec3 normal, lightDir, eyeVec;

const float cos_outer_cone_angle = 0.8; // 36 degrees

void main (void)
{
    vec4 final_color =
    (gl_FrontLightModelProduct.sceneColor * gl_FrontMaterial.ambient) +
    (gl_LightSource[0].ambient * gl_FrontMaterial.ambient);

    vec3 L = normalize(lightDir);
    vec3 D = normalize(gl_LightSource[0].spotDirection);

    float cos_cur_angle = dot(-L, D);

    float cos_inner_cone_angle = gl_LightSource[0].spotCosCutoff;

    float cos_inner_minus_outer_angle = 
          cos_inner_cone_angle - cos_outer_cone_angle;

    //****************************************************
    // Don't need dynamic branching at all, precompute 
    // falloff(i will call it spot)
    float spot = 0.0;
    spot = clamp((cos_cur_angle - cos_outer_cone_angle) / 
           cos_inner_minus_outer_angle, 0.0, 1.0);
    //****************************************************

    vec3 N = normalize(normal);

    float lambertTerm = max( dot(N,L), 0.0);
    if(lambertTerm > 0.0)
    {
        final_color += gl_LightSource[0].diffuse *
            gl_FrontMaterial.diffuse *
            lambertTerm * spot;

        vec3 E = normalize(eyeVec);
        vec3 R = reflect(-L, N);

        float specular = pow( max(dot(R, E), 0.0),
            gl_FrontMaterial.shininess );

        final_color += gl_LightSource[0].specular *
            gl_FrontMaterial.specular *
            specular * spot;
    }
    gl_FragColor = final_color; 
```

# c# - WPF DataTrigger 和 EventTrigger 的组合不起作用

> ID：11434234
> 
> 赞同：0
> 
> 时间：2012-07-11T13:54:04.427
> 
> 标签：c#, wpf, xaml, datatrigger, eventtrigger

我对我的代码有一个小问题：

```
<Style TargetType="{x:Type Grid}">
    <Setter Property="Visibility" Value="Collapsed"/>
    <Style.Triggers>
        <DataTrigger Binding="{Binding Status.IsObjectSaving}" Value="True">
            <Setter Property="Visibility" Value="Visible"/>
        </DataTrigger>
        <Trigger Property="Visibility" Value="Visible">
            <Trigger.EnterActions>
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation
                            Storyboard.TargetProperty   = "Opacity"
                            From                        ="1"
                            To                          = "0"
                            BeginTime                   = "0:0:0"
                            Duration                    = "0:0:2" />
                        <ObjectAnimationUsingKeyFrames
                            Storyboard.TargetProperty   = "Visibility">
                        <DiscreteObjectKeyFrame KeyTime="0:0:2"
                            Value="{x:Static Visibility.Collapsed}" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </Trigger.EnterActions>
        </Trigger>
    </Style.Triggers>
</Style> 
```

当我的对象将被保存时，应该打开网格并显示一些信息。当我第一次启动程序时它可以工作，但第二次它不起作用。所以我希望你能帮助我。

谢谢丹尼尔

ps 对不起我糟糕的英语！

* * *

谢谢回答！我尝试使用以下代码设置值：

```
<DataTrigger Binding="{Binding Status.IsObjectSaving}" Value="True">
    <DataTrigger.EnterActions>
        <BeginStoryboard>
            <Storyboard>
                <DoubleAnimation
                    Storyboard.TargetProperty   = "Opacity"
                    From                        = "0"
                    To                          = "1"
                    BeginTime                   = "0:0:0"
                    Duration                    = "0:0:2" />
                <ObjectAnimationUsingKeyFrames
                    Storyboard.TargetProperty   = "Visibility">
                    <DiscreteObjectKeyFrame KeyTime="0:0:2"
                        Value="{x:Static Visibility.Visible}" />
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </BeginStoryboard>
    </DataTrigger.EnterActions>
    <DataTrigger.ExitActions>
        <BeginStoryboard>
            <Storyboard>
                <DoubleAnimation
                    Storyboard.TargetProperty   = "Opacity"
                    From                        = "1"
                    To                          = "0"
                    BeginTime                   = "0:0:2"
                    Duration                    = "0:0:2" />
                <ObjectAnimationUsingKeyFrames
                    Storyboard.TargetProperty   = "Visibility">
                    <DiscreteObjectKeyFrame KeyTime="0:0:2"
                        Value="{x:Static Visibility.Collapsed}" />
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </BeginStoryboard>
    </DataTrigger.ExitActions>
</DataTrigger> 
```

但它不起作用。那么你能帮我以正确的方式修改代码吗？

谢谢

丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:58:28.527

动画以更高的[优先级](https://msdn.microsoft.com/en-us/library/ms743230%28v=vs.100%29.aspx)更改值，一旦更改可见性，触发器将无法修改它。您可以将 setter 替换为动画（进入和退出动作），这样它们具有相同的优先级。

# c# - 使用包修改 Word 文档 XML

> ID：11434236
> 
> 赞同：1
> 
> 时间：2012-07-11T13:54:15.463
> 
> 标签：c#, xml, ms-word

我正在尝试修改一个简单的 MS Word 模板 XML。我意识到有可用的 SDK 可以使这个过程更容易，但我的任务是维护使用包，我被告知要这样做。

我有一个基本的测试文档，其中有两个占位符映射到以下 XML：

```
<root>
  <element>
     Fubar
  </element>
  <second>
     This is the second placeholder
  </second>
</root> 
```

我正在做的是使用单词 doc 创建一个流，删除现有的 XML，获取一些硬编码的测试 XML 并尝试将其写入流。

这是我正在使用的代码：

```
string strRelRoot = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument";
byte[] buffer = File.ReadAllBytes("dev.docx");
//stream with the template
MemoryStream stream = new MemoryStream(buffer, true);
//create a package using the stream
Package package = Package.Open(stream, FileMode.Open, FileAccess.ReadWrite);
PackageRelationshipCollection pkgrcOfficeDocument = package.GetRelationshipsByType(strRelRoot);
foreach (PackageRelationship pkgr in pkgrcOfficeDocument)
{
    if (pkgr.SourceUri.OriginalString == "/")
    {
        Uri uriData = new Uri("/customXML/item1.xml", UriKind.Relative);
        //remove the existing part
        if (package.PartExists(uriData))
        { 
            // Delete template "/customXML/item1.xml" part
            package.DeletePart(uriData);
        }
        //create a new part
        PackagePart pkgprtData = package.CreatePart(uriData, "application/xml");
        //test data
        string xml = @"<root>
                        <element>
                            Changed
                        </element>
                        <second>
                                The second placeholder changed
                        </second>
                    </root>";
        //stream created from the xml string
        MemoryStream fromStream = new MemoryStream();
        UnicodeEncoding uniEncoding = new UnicodeEncoding();
        byte[] fromBuffer = uniEncoding.GetBytes(xml);
        fromStream.Write(fromBuffer, 0, fromBuffer.Length);
        fromStream.Seek(0L, SeekOrigin.Begin);
        Stream toStream = pkgprtData.GetStream();
        //copy the xml to the part stream
        fromStream.CopyTo(toStream);
        //copy part stream to the byte stream
        toStream.CopyTo(stream);

    }
} 
```

尽管我觉得我已经接近解决方案，但目前并未修改文档。任何建议将不胜感激。谢谢！

编辑：澄清一下，我得到的结果是文档没有改变。我没有任何异常或类似情况，但文档 XML 没有被修改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:29:26.570

好的，所以不是我承诺的及时响应，但是就这样吧！

这个问题有几个方面。示例代码来自内存和文档，不一定经过编译和测试。

* * *

## 阅读模板 XML

在删除包含模板 XML 的包部分之前，您需要打开其流并读取 XML。如果该部分一开始不存在，您如何获取 XML 取决于您。

我的示例代码使用来自[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387098.aspx "MSDN 上的 LINQ to XML") API 的类，尽管您可以使用您喜欢的任何一组 XML API。

```
XElement templateXml = null;
using (Stream stream = package.GetPart(uriData))
    templateXml = XElement.Load(stream);
// Now you can delete the part. 
```

此时，您在`templateXml`.

* * *

## 将值替换为占位符

```
templateXml.SetElementValue("element", "Replacement value of first placeholder");
templateXml.SetElementValue("second", "Replacement value of second placeholder"); 
```

如果您需要做比这更高级的事情，请查看[XElement](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.aspx "MSDN 上的 XElement")上的方法，例如阅读原始内容以确定替换值。

* * *

## 保存文档

这是您的原始代码，经过修改和注释。

```
// The very first thing to do is create the Package in a using statement.
// This makes sure it's saved and closed when you're done.
using (Package package = Package.Open(...))
{
    // XML reading, substituting etc. goes here.

    // Eventually...
    //create a new part
    PackagePart pkgprtData = package.CreatePart(uriData, "application/xml");
    // Don't need the test data anymore.
    // Assuming you need UnicodeEncoding, set it up like this.
    var writerSettings = new XmlWriterSettings
    {
        Encoding = Encoding.Unicode,
    };
    // Shouldn't need a MemoryStream at all; write straight to the part stream.
    // Note using statements to ensure streams are flushed and closed.
    using (Stream toStream = pkgprtData.GetStream())
    using (XmlWriter writer = XmlWriter.Create(toStream, writerSettings))
        templateXml.Save(writer);
    // No other copying should be necessary.
    // In particular, your toStream.CopyTo(stream) appeared
    // to be appending the part's data to the package's stream
    // (the physical file), which is a bug.
} // This closes the using statement for the package, which saves the file. 
```

# python - Django 管理页面不显示数据库表（djangobook 第 06 章）

> ID：11434239
> 
> 赞同：11
> 
> 时间：2012-07-11T13:54:24.367
> 
> 标签：python, mysql, database, django, django-admin

我正在做[`Activating the Admin Interface`](http://django-book.readthedocs.org/en/latest/chapter06.html#activating-the-admin-interface)djangobook 第 06 章中的部分。在该部分结束时，必须运行开发服务器并转到`http://127.0.0.1:8000/admin/`.

但是我看到了这个： ![我的 Django 管理页面](../Images/b45ef414bcf934dce5311bcca00de76a.png)

而不是这样的（来自djangobook）： ![它应该是什么样子](../Images/2d0ea9405855072f0024d3b92e1592ef.png)

这很奇怪，因为我的 mysql 数据库表中存储了数据，该表链接到`settings.py`文件中的 django 项目。

这是我的 django 项目文件中的`DATABASES`字典：`settings.py`

```
DATABASES = {
    'default': {
        'ENGINE': 'mysql',
        'NAME': 'mydb',                   
        'USER': 'root',                      
        'PASSWORD': 'mypass',                 
        'HOST': 'localhost',                    
        'PORT': '',                      
    }
} 
```

mysql 提示符显示如下：

```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| mydb               |
+--------------------+
3 rows in set (0.00 sec)

mysql> use mydb;
mysql> show tables;
+----------------------------+
| Tables_in_mydb             |
+----------------------------+
| auth_group                 |
| auth_group_permissions     |
| auth_message               |
| auth_permission            |
| auth_user                  |
| auth_user_groups           |
| auth_user_user_permissions |
| books_author               |
| books_book                 |
| books_book_authors         |
| books_publisher            |
| django_admin_log           |
| django_content_type        |
| django_session             |
+----------------------------+
14 rows in set (0.00 sec) 
```

为什么我`mydb`在管理页面中看不到 的内容？

可能相关：

```
mysql> select User from mysql.user;
+------------------+
| User             |
+------------------+
| root             |
| debian-sys-maint |
| root             |
| root             |
+------------------+
4 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-11T13:59:15.343

您需要继续阅读[http://django-book.readthedocs.org/en/latest/chapter06.html#adding-your-models-to-the-admin-site](http://django-book.readthedocs.org/en/latest/chapter06.html#adding-your-models-to-the-admin-site)

> 还有一个关键部分我们还没有完成……
> 在书籍目录 (mysite/books) 中，创建一个名为 admin.py 的文件，然后输入以下代码行：

```
from django.contrib import admin
from mysite.books.models import Publisher, Author, Book

admin.site.register(Publisher)
admin.site.register(Author)
admin.site.register(Book) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-27T16:20:20.750

您必须在 app 目录中的 admin.py 文件中注册您的模型。

如果没有 admin.py 你必须创建一个然后注册它。

就我而言，我有一个注册模型，我在 app 目录中创建了 admin.py 文件，并添加了以下代码。

```
from django.contrib import admin

from .models import Registeration

admin.site.register(Registeration) 
```

# c++ - Access Mat binary images elements in OpenCV

> ID：11434241
> 
> 赞同：1
> 
> 时间：2012-07-11T13:54:29.957
> 
> 标签：c++, image-processing, opencv, computer-vision

I tried the following code to print all the white pixels of this binary image without success:

```
Mat grayImage;
Mat rgb_Image;
int Max_value = 255;
int Global_Threshold = 155;

rgb_Image = imread( "../Tests/Object/Object.jpg", CV_LOAD_IMAGE_COLOR);   // Read the file

if(! rgb_Image.data )  // Check for invalid input
{
        cout <<  "Could not open or find the image" << endl ;
        return -1;
}

//Convert to Grayscale.
cvtColor(rgb_Image, grayImage, CV_BGR2GRAY);

//Binarize the image with a fixed threshold.
threshold( grayImage, binImage, Global_Threshold, Max_Value, 0);

//Printing white pixels
for(int i = 0; i < 640; i++)
{
    for(int j = 0; j < 480; j++)
    {
        if(255 == binImage.at<float>(i,j))
        {
            cout << binImage.at<float>(i,j) << endl;
        }
    }
} 
```

If I print the values that are not zeroes I get strange values but not 255.

Thanks,

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:24:38.223

cvtColor will create a uchar image, and threshold will keep the data format, so your binImage is made up of uchars, and not float's.

Change

```
binImage.at<float>(i,j) 
```

to

```
binImage.at<uchar>(i,j) 
```

and keep in mind that comparing floats with `==` is usually a bad idea (even when you work with floats), because of floating-point representation errors. You may end up having a matrix full of `254.9999999999`, and never meet the `image(i,j)==255` condition

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:01:15.567

You need to cast it to float.

Although the image is an openCV float it's still stored in a unsigned char* block of data (so it can be easily converted) so "<<" thinks it's receiving a C string and prints the binary data until it sees a '0'

# sql - 如何从 SSIS 2005 中的查找转换中获取“不匹配输出”？

> ID：11434242
> 
> 赞同：3
> 
> 时间：2012-07-11T13:54:32.167
> 
> 标签：sql, sql-server-2005, ssis, lookup

如何从 SSIS 2005 中的查找转换中获取“不匹配输出”？

我过去的经验是在 SSIS 2008 中，我知道在 2008 年这是每个查找转换的选项，但我发现在 SSIS 2005 中这不是一个选项。是否有合理的解决方法，而不必在错误处理中使用“忽略失败”。

我正在使用的包需要增量更新表中的数据。目前，它会清除表并在每次运行时重新填充数据。这在硬币的应用程序方面效果不佳，并且需要更改包以仅更新已更改的记录或将新记录添加到表中。我的计划是使用查找操作将 ODS 表与 DM 表进行比较，并且我需要查找的不匹配输出来确定更改。

谢谢

凯杰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:36:43.213

适当的解决方法是对 SSIS 2005 使用忽略失败选项。该选项在 2008 年进行了更新，以添加无匹配输出选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T05:31:27.047

SSIS 2005 中没有匹配项您需要使用忽略失败选项。查找转换在 2008 和 2008R2 中发生了巨大变化。

# c# - 确保代码安全执行的组件是什么

> ID：11434244
> 
> 赞同：1
> 
> 时间：2012-07-11T13:54:40.360
> 
> 标签：c#, .net

在面试中，面试官问了我一个问题，即确保在 .net 中安全执行代码的组件是什么。我在谷歌尝试但失败了。谁能给我答案或链接？

我找到了一个word文档。我发现安全代码执行的组件是程序集加载器、代码验证器、JIT。它是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:02:21.673

看看 CLR 安全模型。微软有一篇关于它的好文章。

概括：

> .NET Framework 的公共语言运行时具有自己的安全执行模型，不受其运行所在操作系统的限制。此外，与旧的基于主体的安全性不同，CLR 根据代码的来源而不是用户身份来实施安全策略。这种称为代码访问安全性的模型在当今的环境中是有意义的，因为在 Internet 上安装了如此多的代码，即使是受信任的用户也不知道该代码何时是安全的。

[CLR 的安全基础架构](http://msdn.microsoft.com/en-us/magazine/cc188939.aspx#S1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:04:52.063

我脑海中的答案是[Try-Catch](http://msdn.microsoft.com/en-us/library/0yd65esw%28v=vs.100%29.aspx)块。您将希望按类型捕获异常以向用户提供有意义的输出（如果需要），但一般异常对于内部测试非常有用。

```
try
{
    /*Some code which could throw exceptions.*/
}
catch (Exception e)
{
    Console.WriteLine("Error: {0}\nStack Trace: {1}", e.Message, e.StackTrace);
} 
```

但是，我只是不同意“安全执行”意味着不会崩溃的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:17:29.483

“安全执行代码”可能意味着很多事情。但我认为面试官要求的是**Code Access Security**，这是 .net 环境的安全模型。

CAS 对于所有框架版本都不相同，是一个复杂的主题，需要在这里解释。基本上，它根据程序集和代码表示法、程序集来源、信任级别等允许或禁止代码执行。

你可以在这里得到一些介绍：

2.0 或 3.5 => [http://msdn.microsoft.com/en-us/library/c5tk9z76(v=vs.90](http://msdn.microsoft.com/en-us/library/c5tk9z76(v=vs.90) )

4.0 或 4.5 => [http://msdn.microsoft.com/en-us/library/c5tk9z76(v=vs.100](http://msdn.microsoft.com/en-us/library/c5tk9z76(v=vs.100) )

# java - div 动态更新图像..... JSF

> ID：11434246
> 
> 赞同：2
> 
> 时间：2012-07-11T13:54:41.730
> 
> 标签：java, jsf, jstl

如何在单击其他 div 图像时动态替换 DIV 中的图像，如图所示。要求是这样的：单击“DIV1”根应更新为1 ..单击“Div2”根应更新为2。所有从某个 URL 和 Root 加载图像的 div 都是一个更大的 div。 ![在此处输入图像描述](../Images/7a5b62636edf316efe082257bdb56218.png)

请回复 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T16:47:16.270

你可以这样做：

```
<div>
   <h:graphicImage id="root" value="#{managedBean.rootImage}" alt="image"/>
</div>

<div>
   <h:commandLink>
     <h:graphicImage value="images/image1.png" alt="image1"/>
     <f:setPropertyActionListener target="#{managedBean.rootImage}" value="images/image1.png" />
     <f:ajax event="action" render="root"/>  
   </h:commandLink>
</div> 
```

并在您的 ManagedBean 中创建像这样的 setter/getter：

```
public class ManagedBean{
    public String rootImage;
    public void setRootImage(String image) {
      this.rootImage= image;
    }
    public String getRootImage() {
      return rootImage;
    }
} 
```

参考：[JSF - 关于 UIComponent 操作的两个问题](https://stackoverflow.com/questions/4326705/jsf-two-questions-about-actions-on-uicomponent)

# autocomplete - Salesforce：查找字段的自动完成

> ID：11434247
> 
> 赞同：0
> 
> 时间：2012-07-11T13:54:42.683
> 
> 标签：autocomplete, salesforce, apex-code, lookup, autofill

我有一个名为“Companies”的自定义对象。我在 Visual Force 页面中创建了一个查找字段，它为我提供了来自自定义对象“Companies”的公司名称列表。我编写了一个代码，使这个查找字段自动-就像您在所附图片中看到的那样完整。（第一张图片）

问题：我不知道如何使查找字段（从“机会”标准对象中的自定义对象“公司”中获取公司名称列表）自动完成，就像在视觉力量页面中所做的那样。基本上希望第二张图片中以黄色突出显示的字段在我输入前几个字符时自动完成或给出相关建议。

对此问题的任何帮助将不胜感激。谢谢

![这是一个 Visual Force 页面，我在其中完成了查找字段的自动完成](../Images/a2a85b18c742c16f681049c2f9cc2d93.png)![这是标准的机会对象，我想让黄色突出显示的查找字段自动完成，但我不知道如何在标准页面中执行](../Images/149e20a041e4dde8795fd64ef51826ef.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T10:34:59.150

您是否将自定义对象的“自动完成”绑定到搜索页面？

点击您的姓名 | 设置 | 定制 | 搜索 | 搜索设置。选中对象的查找自动完成复选框。

这将为您提供最近使用的项目的自动完成选项。 [http://help.salesforce.com/help/doc/en/search_lookupdialog.htm#auto_complete](http://help.salesforce.com/help/doc/en/search_lookupdialog.htm#auto_complete)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-03T16:23:10.560

这就是你想要的 - [http://tapp.ly/autocomplete/](http://tapp.ly/autocomplete/)

Salesforce 的自动完成查找使任何 Salesforce 查找字段支持自动完成建议。自动完成查找可帮助您的用户输入查找字段，从而减少数据输入任务和错误率。

在您开始输入时建议的 Salesforce 记录搜索所有字段（标准 Salesforce 查找仅允许您按名称字段搜索）结果可以显示任何字段（例如案例主题而不是案例编号）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:13:36.677

您将无法将此自定义嵌入到标准页面布局中，就像您在第二个屏幕截图中用于 Opportunity 对象一样。如果自动完成功能是必须具备的，那么您实际上只有两个选择：

*   将整个商机页面布局替换为自定义 VF 页面
*   编写一个仅包含 Company 查找字段的 VF 组件，并将其嵌入到您的 Opportunity 页面布局中（这必须在其自己的部分中，这可能看起来不太好）

# asp.net-mvc - JQuery Mobile 与 CustomMobileViewEngine

> ID：11434254
> 
> 赞同：0
> 
> 时间：2012-07-11T13:55:07.730
> 
> 标签：asp.net-mvc, jquery-mobile

我正在查看 Scott Hanselman 的 CustomMobileViewEngine 模式，在这里可以找到： [http ://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx)

这让 mvc 知道您使用的是什么设备，因此您可以为每个设备创建布局，以便每个设备在给定设备中正确缩放。

JQuery Mobile 似乎可以自动扩展到任何开箱即用的设备。

我的困惑是为什么人们一起使用两者不是他们实现相同的目标？

我正在寻找一个简单的移动网站，它有 2 个页面（一个静态页面和一个包含 gridview 的页面）和一个母版页。

我的另一个困惑是，如果我使用 jquery mobile，我可以使用 html 表创建网格视图，还是必须使用 jquery mobile 控件创建它？

我正在查看我的 MVC 项目，我在视图下有一个文件夹，用于 3 个索引页面（1 个用于 iphone、ipad、android），但所有页面都是相同的 html，唯一的区别是页面在不同设备中的呈现。我想有3个相同的页面吗？我认为我的设计有问题。

![在此处输入图像描述](../Images/c30df0d66d5c2224882f93f73197ec9d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T16:50:53.590

我认为有些人使用它来根据设备显示更多内容。例如，如果是 iphone，他们可能会将内容限制为最重要的内容。如果是ipad，他们可以注入更多的内容。

只要它具有正确的“数据-”属性，您就可以只使用 html 创建网格视图。

# php - 类似推特的关注系统

> ID：11434255
> 
> 赞同：0
> 
> 时间：2012-07-11T13:55:08.747
> 
> 标签：php, mysql, twitter

我正在为学校使用 PHP 开发 Twitter 克隆，但我遇到了一个主要问题。我找不到实现追随者系统的方法。有一个用户表，我想添加一个字段来保存每个用户关注的所有用户的 id。

我应该用逗号分隔 id，然后在 PHP 中将它们分开吗？然后我需要从推文表中选择所有用户关注者发布的推文。有我可以使用的 SQL 命令吗？类似的东西

```
SELECT *
FROM tweets 
WHERE author='$followeduser'" 
```

但是`$followeduser`多个ID在哪里。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T13:59:03.680

有一张`USER_MASTER`这样的桌子

```
USER_ID (int)
USER_NAME(varchar(50)) 
```

创建一个`USER_FOLLOWERS`这样的表

```
USER_FOLLOWER_ID // Auto increment-Primary Key for this record
USER_ID (int)  // foriegn key to UserId column in USER_MASTER table
FOLLOWER_ID (int)  // foriegn key to UserId column in USER_MASTER table 
```

将 UserId 存储在第一列，并将关注该用户的 User 的 UserId 存储在该`Follower_ID`列中。

所以你的数据看起来像这样

```
USER_ID    USER_NAME
--------------------------------------
1           SCOTT
2           JARED
3           MARC
4           ERIC

USER_FOLLOWER_ID    USER_ID   FOLLOWER_ID
--------------------------------------
1                    1          2
2                    1          3
3                    1          4
4                    2          1 
```

所以这意味着，用户 Scott 有 3 个关注者，Jared、Marc 和 Eric。用户 JARED 有一个追随者，即 SCOTT

要获取用户的关注者列表（例如：Scott (ID=1)），您可以在这两个表之间进行连接

```
 SELECT U. USER_ID, U.USER_NAME From USER_MASTER U
  INNER JOIN USER_FOLLOWERS UF ON U.USER_ID=UF.FOLLOWER_ID
  WHERE UF.USER_ID=1  // 1 is the ID of SCott 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T13:58:41.370

制作一个连接表。

将所有 ID 放在一个列表中**并不是规范化的方式**，并且会导致许多问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:07:02.247

有一个关系表，其中有一列称为用户，第二列在后面。因此，如果用户 1 关注用户 3 和 5，那么您将拥有一个主目录，其中用户 = 1 关注 = 3，用户 = 1 关注 = 5（使用您想要的任何 ID）。你也有你的推文表，你可以在其中存储所有推文。您将要进行一个连接两个表的查询

# javascript - JQuery事件每次加倍

> ID：11434256
> 
> 赞同：0
> 
> 时间：2012-07-11T13:55:10.643
> 
> 标签：javascript, jquery, event-bubbling

```
$('.add_instruction_btn').click(function(e){
                    e.preventDefault();
                    var ins_content=$('#add_instructions').val();
                    var id=$('.useri').val();
                    if(ins_content!="")
                    {
                        //write new instructions to database
                        var id=$('.useri').val();
                        var data="job_id="+job_idx+"&ins="+ins_content+"&client_id="+id+"&key=2";
                        $.ajax({
                            type:"POST",
                            url:"admin_includes/get_instructions.php",
                            data:data,
                            success:function(html2){
                                alert(html2);
                            }
                        });//end ajax

                    }
                    return false;
                }); 
```

每次单击按钮时，我似乎都尝试过阻止事件翻倍。该代码最初位于另一个打开“弹出式”样式框的函数内，但即使我将其移到函数外，它似乎仍然冒泡。

按照要求：-

```
$(document).on('click', '.bottom_links .lister a', function(e){
        //e.preventDefault();
        //e.stopPropagation();
        $('.ind_ins').text("");
        var ident=$(this).data('ref1');
        if(ident==1){
            var job_idx=$(this).data('job_id');
            var cl_name=$(this).data('cl_name');
            var icon_stat=$(this).data('img_id');
            var id=$('.useri').val();
            if(icon_stat=="1")
            {
                $('.opaque_scr,.instruction_popup').css('visibility', 'visible');
                $('.instruction_popup h2').html("Add Instructions for Appointment ID: "+job_idx);
                $('.client_name').html("<strong>Client Name: </strong>"+cl_name);
                //get original instructions
                var get_job="job_id="+job_idx+"&key=1";
                $.ajax({
                    type:"POST",
                    url:"admin_includes/get_instructions.php",
                    data:get_job,
                    success:function(html){
                        var split_data=html.split("^");
                        var split_data_count=split_data.length-1;
                        var ins_tb="<table width='100%'>"
                        for(var xs=0;xs<split_data_count;xs++)
                        {

                            var ind=split_data[xs].split("|");
                            var ind_count=ind.length-1;
                            for(var xx=0;xx<ind_count;xx++)
                            {
                                ins_tb+="<tr><td width='75%'>"+ind[0]+"</td><td>"+ind[1]+"</td></tr>";
                            }

                        }
                        ins_tb+="</table>";

                        $(ins_tb).appendTo('.ind_ins');
                    }

                })//end ajax

                $('.add_instruction_btn').click(function(e){
                    e.preventDefault();
                    e.stopPropagation();
                    var ins_content=$('#add_instructions').val();
                    var id=$('.useri').val();
                    if(ins_content!="")
                    {
                        //write new instructions to database
                        var id=$('.useri').val();
                        var data="job_id="+job_idx+"&ins="+ins_content+"&client_id="+id+"&key=2";
                        $.ajax({
                            type:"POST",
                            url:"admin_includes/get_instructions.php",
                            data:data,
                            success:function(html2){
                                alert(html2);
                            }
                        });//end ajax

                    }
                    return false;
                });

            }

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:15:09.130

问题是您不止一次连接事件处理程序。每次单击元素匹配时`'.bottom_links .lister a'`，只要各种条件都正确，您就重新运行此代码：

```
$('.add_instruction_btn').click(function(e){
    // ....
}); 
```

每次运行该代码时，都会连接处理程序的一个新副本。

如果匹配的元素集`'.add_instruction_btn'`是固定的，只需将该代码移出元素的`click`处理程序即可`'.bottom_links .lister a'`。

如果匹配的元素集发生`'.add_instruction_btn'`变化，您仍然希望将代码移到元素`click`处理程序之外`'.bottom_links .lister a'`，但您可能希望它也使用事件委托，就像使用事件委托一样`'.bottom_links .lister a'`。

关于事件委托的说明：您正在“扎根”您的事件委托`document`，这真的非常非常高。最好将委托放在最近的容器中，以便您正在监视的元素。显然，如果`document` **是**最近的容器，那么你就在那里，但通常你可以使用更远一些的东西来代替，同时仍然可以获得委托的好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T13:56:11.730

尝试[`e.stopPropagation`](http://api.jquery.com/event.stopPropagation/)：

```
 $('.add_instruction_btn').click(function(e){
                e.preventDefault();
                e.stopPropagation(); 
                .... 
```

# java - 在 c:forEach 标签中添加循环索引

> ID：11434257
> 
> 赞同：1
> 
> 时间：2012-07-11T13:55:16.930
> 
> 标签：java, jsf-2, primefaces, richfaces, jstl

在我一直使用渲染时间标签（如 a4j:repeat、ui:repeat）之前，基于项目集合创建面板。所有这些都改变了，现在我必须使用 c:forEach 来代替。在每个面板上，我都会进行大量 AJAX 调用和页面的部分更新。这就是为什么我使用自定义 ID 来识别我想要更新的组件。所以我的渲染属性是这样的：

```
#{cc.clientId}:pnlRepeat:#{row}:radioAplicar 
```

其中 pnlRepeat 是 id 属性，{#row} 是同一标签中的 rowKeyVar 属性。现在......当使用 c:forEach 时它们都不存在，因此，我得到了重复的 id 异常。我知道我可以使用 varStatus，并使用 #{row} Id 创建一个面板，但另一方面。JSF 不允许 id 属性评估 EL 表达式。什么是解决方法？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T11:54:25.087

您不应尝试将任何 ManagedBean 逻辑或 EL 表达式基于生成的重复组件的 ID，如`<ui:repeat>`or `<c:forEach>`。就像您已经提到的那样，EL 表达式不会让您动态评估 Id 表达式，因此处理重复组件中的单个项目触发事件的这些情况的适当方法是以以下形式传递唯一标识值`<f:attribute>`标签。

使用`<f:attribute>`标签会将指定的值放入请求属性中，以便可以在您的操作侦听器中检索它。

```
<ui:repeat value="..." var="repeatedVar">
  <h:inputText id="newTxt" value="#{repeatedVar}" >
     <f:attribute name="unique_id" value="#{repeatedVar.uniqueId}" />
  </h:inputText>
</ui:repeat>
<h:commandButton actionListener="#{managedBean.someMethod}" ... 
```

在 action 方法中，我们可以通过检索动态组件属性来确定要执行的操作或业务逻辑。

```
public void someMethod() {
    String uniqueId = (String) UIComponent.getCurrentComponent(FacesContext.getCurrentInstance()).getAttributes().get("unique_id");
    //Get the unique data object
    //Do some business logic and other stuff...
} 
```

# excel - 如何将 Tridion 中的关键字提取为 Excel 格式？

> ID：11434258
> 
> 赞同：3
> 
> 时间：2012-07-11T13:55:18.773
> 
> 标签：excel, content-management-system, tridion, extraction

如何将 Tridion 中的关键字提取为 Excel 格式？这是为了翻译网站。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T13:56:55.043

如果您使用 Tridion 2009：[http ://sdltridionworld.com/community/extension_overview/exporttoexcel.aspx](http://sdltridionworld.com/community/extension_overview/exporttoexcel.aspx)

如果不是，则必须编写某种脚本（非常简单）才能将其导出为 CSV 或类似文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T14:08:30.767

如果您使用的是受众管理器，那么您可以使用为地址簿导出和导入关键字的解决方法。这将导出为 CSV，您可以使用相同的格式导入它。

但是出于翻译目的（本地化关键字等），这可能很麻烦，在这种情况下，我会使用 Nuno 的建议来编写某种脚本。

# php - 两个查询的并集

> ID：11434260
> 
> 赞同：-4
> 
> 时间：2012-07-11T13:55:29.793
> 
> 标签：php, sql

帮助合并两个sql查询（TECDOC）。

1.  显示名称和零件编号；
2.  显示技术参数的详细信息。

如何结合这两个查询？

```
SELECT
    ART_ARTICLE_NR,
    SUP_BRAND,
    DES_TEXTS.TEX_TEXT AS ART_COMPLETE_DES_TEXT,
    DES_TEXTS2.TEX_TEXT AS ART_STATUS_TEXT
FROM ARTICLES
    INNER JOIN DESIGNATIONS ON DESIGNATIONS.DES_ID = ART_COMPLETE_DES_ID
    INNER JOIN DES_TEXTS ON DES_TEXTS.TEX_ID = DESIGNATIONS.DES_TEX_ID
    INNER JOIN SUPPLIERS ON SUP_ID = ART_SUP_ID
    INNER JOIN ART_COUNTRY_SPECIFICS ON ACS_ART_ID = ART_ID
    INNER JOIN DESIGNATIONS 
        AS DESIGNATIONS2 ON DESIGNATIONS2.DES_ID = ACS_KV_STATUS_DES_ID
    INNER JOIN DES_TEXTS
        AS DES_TEXTS2 ON DES_TEXTS2.TEX_ID = DESIGNATIONS2.DES_TEX_ID
WHERE
    ART_ID IN ( 
                52277
        ) AND
    DESIGNATIONS.DES_LNG_ID = 19 AND
    DESIGNATIONS2.DES_LNG_ID = 19; 
```

* * *

```
SELECT
    DES_TEXTS.TEX_TEXT AS CRITERIA_DES_TEXT,
    IFNULL(DES_TEXTS2.TEX_TEXT, ACR_VALUE) AS CRITERIA_VALUE_TEXT
FROM
    ARTICLE_CRITERIA
    LEFT JOIN DESIGNATIONS
        AS DESIGNATIONS2 ON DESIGNATIONS2.DES_ID = ACR_KV_DES_ID
    LEFT JOIN DES_TEXTS
        AS DES_TEXTS2 ON DES_TEXTS2.TEX_ID = DESIGNATIONS2.DES_TEX_ID
    LEFT JOIN CRITERIA ON CRI_ID = ACR_CRI_ID
    LEFT JOIN DESIGNATIONS ON DESIGNATIONS.DES_ID = CRI_DES_ID
    LEFT JOIN DES_TEXTS ON DES_TEXTS.TEX_ID = DESIGNATIONS.DES_TEX_ID
WHERE
    ACR_ART_ID IN (
            52277
        ) AND
    (DESIGNATIONS.DES_LNG_ID IS NULL OR DESIGNATIONS.DES_LNG_ID = 19) AND
        (DESIGNATIONS2.DES_LNG_ID IS NULL OR DESIGNATIONS2.DES_LNG_ID = 19); 
```

* * *

```
CREATE TABLE IF NOT EXISTS articles ( ART_ID int(11) NOT NULL, ART_ARTICLE_NR varchar(66) NOT NULL, ART_SUP_ID smallint(6) DEFAULT NULL, ART_DES_ID int(11) DEFAULT NULL, ART_COMPLETE_DES_ID int(11) DEFAULT NULL, ART_PACK_SELFSERVICE smallint(6) DEFAULT NULL, ART_MATERIAL_MARK smallint(6) DEFAULT NULL, ART_REPLACEMENT smallint(6) DEFAULT NULL, ART_ACCESSORY smallint(6) DEFAULT NULL, ART_BATCH_SIZE1 int(11) DEFAULT NULL, ART_BATCH_SIZE2 int(11) DEFAULT NULL, PRIMARY KEY (ART_ID), KEY ART_ARTICLE_NR (ART_ARTICLE_NR(10)) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS article_criteria ( ACR_ART_ID int(11) NOT NULL, ACR_GA_ID int(11) NOT NULL, ACR_SORT smallint(6) NOT NULL, ACR_CRI_ID smallint(6) NOT NULL, ACR_VALUE varchar(60) DEFAULT NULL, ACR_KV_DES_ID int(11) DEFAULT NULL, ACR_DISPLAY smallint(6) DEFAULT NULL, PRIMARY KEY (ACR_ART_ID,ACR_GA_ID,ACR_SORT) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS art_country_specifics ( ACS_ART_ID int(11) NOT NULL, ACS_PACK_UNIT int(11) DEFAULT NULL, ACS_QUANTITY_PER_UNIT int(11) DEFAULT NULL, ACS_KV_STATUS_DES_ID int(11) DEFAULT NULL, ACS_KV_STATUS varchar(9) DEFAULT NULL, ACS_STATUS_DATE datetime DEFAULT NULL, KEY ACS_ART_ID (ACS_ART_ID) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS criteria ( CRI_ID smallint(6) NOT NULL, CRI_DES_ID int(11) NOT NULL, CRI_SHORT_DES_ID int(11) DEFAULT NULL, CRI_UNIT_DES_ID int(11) DEFAULT NULL, CRI_TYPE binary(1) NOT NULL, CRI_KT_ID smallint(6) DEFAULT NULL, CRI_IS_INTERVAL smallint(6) DEFAULT NULL, CRI_SUCCESSOR smallint(6) DEFAULT NULL, PRIMARY KEY (CRI_ID) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS designations ( DES_ID int(11) NOT NULL, DES_LNG_ID smallint(6) NOT NULL, DES_TEX_ID int(11) NOT NULL, PRIMARY KEY (DES_ID,DES_LNG_ID) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS des_texts ( TEX_ID int(11) NOT NULL, TEX_TEXT text, PRIMARY KEY (TEX_ID) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS suppliers ( SUP_ID smallint(6) NOT NULL, SUP_BRAND varchar(60) DEFAULT NULL, SUP_SUPPLIER_NR smallint(6) DEFAULT NULL, SUP_COU_ID smallint(6) DEFAULT NULL, SUP_IS_HESS smallint(6) DEFAULT NULL, PRIMARY KEY (SUP_ID) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:02:24.420

我*认为*这可能有效。请注意，这**未经**测试（尤其是当您忽略向我们提供表格布局时），我不得不猜测`articles`应该如何与`article_criteria`.

```
SELECT Articles.art_article_nr, Suppliers.sup_brand
       Article_Designations.text, Country_Specific_Designations.text,
       Article_Criteria_Designations.value,
       Article_Criteria_Designations.text
FROM Articles
JOIN (SELECT Designations.des_id, Des_Texts.tex_text as text
      FROM Designations
      JOIN Des_Texts
      ON Des_Texts.tex_id = Designations.des_tex_id
      AND Designations.des_lng_id = 19) as Article_Designations
ON Article_Designations.des_id = Articles.art_complete_des_id

JOIN Suppliers
ON Suppliers.sup_id = Articles.art_sup_id

JOIN Art_Country_Specific
ON Art_Country_Specific.acs_art_id = Articles.art_id
JOIN (SELECT Designations.des_id, Des_Texts.tex_text as text
      FROM Designations
      JOIN Des_Texts
      ON Des_Texts.tex_id = Designations.des_tex_id
      AND Designations.des_lng_id = 19) as Country_Specific_Designations
ON Country_Specific_Designations.des_id = Art_Country_Specific.acs_kv_status_des_id

LEFT JOIN (SELECT Article_Criteria.acr_art_id,
           COALESCE(Art_Cri_Designations.text, Article_Criteria.acr_value) as value,
           Criteria_Designations.text
           FROM Article_Criteria
           LEFT JOIN (SELECT Designations.des_id, Des_Texts.tex_text as text
                      FROM Designations
                      JOIN Des_Texts
                      ON Des_Texts.tex_id = Designations.des_tex_id
                      AND Designations.des_lng_id = 19) as Art_Cri_Designations
           ON Art_Cri_Designations.des_id = Article_Criteria.acr_kv_des_id
           LEFT JOIN (SELECT Criteria.cri_id, Des_Texts.tex_text as text
                      FROM Criteria
                      JOIN Designations
                      ON Designations.des_id = Criteria.cri_des_id
                      JOIN Des_Texts
                      ON Des_Texts.tex_id = Designations.des_tex_id
                      AND Designations.des_lng_id = 19) as Criteria_Designations
           ON Criteria_Designations.cri_id = Article_Criteria.acr_cri_id
           ) as Article_Criteria_Designations
ON Article_Criteria_Designations.acr_art_id = Articles.art_id

WHERE Articles.art_id IN (52277) 
```

# ios - 应用程序接收信号 SIGSEGV (IOS5)

> ID：11434263
> 
> 赞同：0
> 
> 时间：2012-07-11T13:55:35.877
> 
> 标签：ios, crash

它显示如下错误日志，谁能告诉我如何找到导致此崩溃的代码？谢谢。

我的设备是iphone IOS 5.0，非常感谢。

```
(null)
(
    0   CoreFoundation                      0x353aa8a7 __exceptionPreprocess + 186

    1   libobjc.A.dylib                     0x37751259 objc_exception_throw + 32

    2   CoreFoundation                      0x353aa789 +[NSException raise:format:] + 0

    3   CoreFoundation                      0x353aa7ab +[NSException raise:format:] + 34

    4   MMBang                              0x0018ccd9 MMBang + 1621209

    5   libsystem_c.dylib                   0x327b67e3 _sigtramp + 38

    6   MMBang                              0x000e9bc1 MMBang + 953281

    7   CoreFoundation                      0x353043fd -[NSObject performSelector:withObject:withObject:] + 52

    8   MMBang                              0x00094ed5 MMBang + 605909

    9   CoreFoundation                      0x353043fd -[NSObject performSelector:withObject:withObject:] + 52
    10  MMBang                              0x00093e6d MMBang + 601709
    11  MMBang                              0x00122ed3 MMBang + 1187539
    12  CoreFoundation                      0x353091fb -[NSObject performSelector:withObject:] + 42
    13  Foundation                          0x34ecd747 __NSThreadPerformPerform + 350
    14  CoreFoundation                      0x3537ead3 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 14
    15  CoreFoundation                      0x3537e29f __CFRunLoopDoSources0 + 214
    16  CoreFoundation                      0x3537d045 __CFRunLoopRun + 652
    17  CoreFoundation                      0x353004a5 CFRunLoopRunSpecific + 300
    18  CoreFoundation                      0x3530036d CFRunLoopRunInMode + 104
    19  GraphicsServices                    0x36f9c439 GSEventRunModal + 136
    20  UIKit                               0x32e0ccd5 UIApplicationMain + 1080

    21  MMBang                              0x0002a583 MMBang + 169347

    22  MMBang                              0x00003810 MMBang + 10256
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T13:58:31.117

转到 xcode 上的断点选项卡，在左下角有一个小加号按钮。按下它，点击添加异常断点。不要更改任何断点设置并单击完成。

如果你再次运行你的程序，它应该会在崩溃的代码行上中断。只要是您的代码执行此操作，而不是 IB 中的错误出口。

希望这可以帮助

山姆

# jquery - KnockoutJS：在淡出其他内容后淡入

> ID：11434265
> 
> 赞同：5
> 
> 时间：2012-07-11T13:55:42.110
> 
> 标签：jquery, asp.net-mvc, animation, knockout.js, knockout-2.0

假设我有一组 3 个单选按钮：

```
<div>
    <label>
        <input type="radio" name="Who" value="Myself" 
            checked="@isMyselfChecked" data-bind="checked: who" />
        Mine
    </label>
    <label>
        <input type="radio" name="Who" value="MemberId" 
            checked="@isMemberIdChecked" data-bind="checked: who" />
        I know the member's ID
    </label>
    <label>
        <input type="radio" name="Who" value="MemberUrl" 
            checked="@isMemberUrlChecked" data-bind="checked: who" />
        I know the member's URL
    </label>
</div> 
```

当用户选择第一个单选按钮（Mine/Myself）时，不需要额外的输入。但是，选择第二或第三，需要附加*输入*：

```
<div>
    <input type="text" name="MemberId" placeholder="Enter Member ID" 
        data-bind="toggleWho: who()" style="display: none" />
    <input type="text" name="MemberUrl" placeholder="Enter Member URL" 
        data-bind="toggleWho: who()" style="display: none; width: 450px;" />
</div> 
```

只需要`data-bind="visible: who() === '[MemberId|MemberUrl]'"`依赖文本框就很容易了。但是，如果我想添加淡入/淡出过渡怎么办？

我从淘汰网站上试用了示例自定义`fadeVisible` `bindingHandler`，并且我了解它是如何工作的。但是，这将同时淡出并淡入文本框中。如果选择了收音机`'MemberId'`，并且用户选择`'MemberUrl'`了收音机，我希望`MemberId`文本框在文本框淡入*之前*`MemberUrl`淡出。

下面是我现在所拥有的，它可以工作，但我认为它不是最佳的。在前一个元素淡出之前，如何告诉淘汰赛不执行淡入？我需要另一个`ko.observale`，或者可能是一个`ko.computed`？

```
var viewModel = {
    fadeSpeed: 150,
    who: ko.observable($('input[type=radio][name=Who]:checked').val())
};

ko.bindingHandlers.toggleWho = {
    init: function (element, valueAccessor) {
        var value = valueAccessor();
        var unwrapped = ko.utils.unwrapObservable(value);
        if (unwrapped === element.name)
            $(element).show();
    },
    update: function (element, valueAccessor) {
        var value = valueAccessor();
        var unwrapped = ko.utils.unwrapObservable(value);

        // when selected value is myself, fade out the visible one, if any
        if (unwrapped === 'Myself') {
            $('input[type=text][name=MemberId]:visible')
                .fadeOut(viewModel.fadeSpeed);
            $('input[type=text][name=MemberUrl]:visible')
                .fadeOut(viewModel.fadeSpeed);
        }

            // when selected value is memberid, may need to fade out url first
        else if (unwrapped === 'MemberId') {
            if ($('input[type=text][name=MemberUrl]:visible').length > 0) {
                $('input[type=text][name=MemberUrl]:visible')
                    .fadeOut(viewModel.fadeSpeed, function () {
                        $('input[type=text][name=MemberId]')
                            .fadeIn(viewModel.fadeSpeed);
                    });
            } else {
                $('input[type=text][name=MemberId]')
                    .fadeIn(viewModel.fadeSpeed);
            }
        }

            // when selected value is memberurl, may need to fade out id first
        else if (unwrapped === 'MemberUrl') {
            if ($('input[type=text][name=MemberId]:visible').length > 0) {
                $('input[type=text][name=MemberId]:visible')
                    .fadeOut(viewModel.fadeSpeed, function () {
                        $('input[type=text][name=MemberUrl]')
                            .fadeIn(viewModel.fadeSpeed);
                });
            } else {
                $('input[type=text][name=MemberUrl]')
                    .fadeIn(viewModel.fadeSpeed);
            }
        }
    }
};

ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T16:53:11.493

您将不得不对其进行一些调整以适合您的示例，但我需要对其进行简化以在[此 fiddle](http://jsfiddle.net/jXg9Z/5/)中进行测试。

这是绑定：

```
var previousElement = null;
ko.bindingHandlers.fadeSwitcher = {
    init: function(element, valueAccessor) {
        var value = valueAccessor();
        $(element).toggle(ko.utils.unwrapObservable(value));
    },
    update: function(element, valueAccessor) {

        var value = ko.utils.unwrapObservable(valueAccessor());
        if (value) {
            if (previousElement == null) { // initial fade
                $(element).fadeIn();
            } else {
                $(previousElement).fadeOut('fast', function() {
                    $(element).fadeIn();
                });
            }
            previousElement = element;
        }        
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-25T08:21:30.350

聚会有点晚了，但也许对其他人有用。

我接受了 Tyrsius 的回答并对其进行了更改以解决我自己的需求；这个版本处理一个可观察的属性，并且每当它改变时都会淡出/淡入旧/新值。

```
Usage example: <span data-bind="fadeSwitcher: myObservable"></span>

ko.bindingHandlers.fadeSwitcher = {
    init: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        element.setAttribute('previousValue', value);
        ko.bindingHandlers.text.update(element, ko.observable(value));
    },
    update: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        var previousValue = element.getAttribute('previousValue');
        if (value !== previousValue) {
            $(element).fadeOut('fast', function () {
                ko.bindingHandlers.text.update(element, ko.observable(value));
                $(element).fadeIn();
            });
            element.setAttribute('previousValue', value);
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T18:28:11.250

谢谢 Tyrsius 的回答。我确实不得不从小提琴中改编它。我能够使用稍微修改的绑定来使其与问题中的相同无线电一起使用（没有 foreach）：

```
@* radios same as in question *@
<div>
    <input type="text" name="MemberId" placeholder="Enter Member ID" 
        data-bind="whoFader: who() === 'MemberId'" style="display: none" />
    <input type="text" name="MemberUrl" placeholder="Enter Member URL" 
        data-bind="whoFader: who() === 'MemberUrl'" 
        style="display: none; width: 450px;" />
</div>

ko.bindingHandlers.whoFader = {
    previousElement: null,
    init: function (element, valueAccessor) {
        var value = valueAccessor();
        $(element).toggle(ko.utils.unwrapObservable(value));
    },
    update: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (value) {
            if (this.previousElement == null) {
                $(element).fadeIn('fast');
            } else {
                $(this.previousElement).hide();
                $(element).fadeIn('fast');
            }
            this.previousElement = element;
        }
        else {
            $(element).fadeOut('fast');
        }
    }
}; 
```

# c# - BitmapImage.DecodePixelWidth 属性消失

> ID：11434269
> 
> 赞同：0
> 
> 时间：2012-07-11T13:56:03.247
> 
> 标签：c#, xaml, silverlight-4.0, bitmapimage

我完全糊涂了。我尝试使用[DecodePixelWidth](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.decodepixelwidth.aspx)属性，但出现错误：“在类型 'BitmapImage' 中找不到属性 'DecodePixelWidth'” 然后我尝试使用[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.image.aspx)页面中的代码编译简单程序：

```
<Grid x:Name="LayoutRoot">
    <Image Width="200">
        <Image.Source>
            <BitmapImage DecodePixelWidth="200"  UriSource="C:\Documents and Settings\All Users\Documents\My Pictures\Sample Pictures\Water Lilies.jpg" />
        </Image.Source>
    </Image>
</Grid> 
```

但这也不起作用。谷歌搜索什么也没给我。在 C# 中，我遇到了同样的错误。

更新。使用银光 4.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:22:46.110

和属性不适用于 Silverlight，您可以在 MSDN Silverlight 文档中`DecodePixelWidth`看到[BitmapImage](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage%28v=vs.95%29.aspx)。并且可用，但仅作为 getter 属性。`DecodePixelHeight``PixelWidth``PixelHeight`

# html - 巨大的 HTML5 应用程序..仅在一个文件中包含所有内容（CSS、图像、JS 库）。可能的？

> ID：11434274
> 
> 赞同：1
> 
> 时间：2012-07-11T13:56:11.580
> 
> 标签：html, css

有没有办法将 HTML5 应用程序打包到一个文件中，浏览器可以打开该文件，并且所有需要的东西都在那里。我想这有点像 webapp 的反论点，你可以随时更新。但这可能很有用。您可以将其视为一个 exe 或 jar 文件，但所有这些都在一个大型 HTML5 应用程序中完成。

为简单起见，我可以使用仅在一个浏览器上运行的应用程序（它可以是每晚构建的版本）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:03:26.073

对的，这是可能的。只需交付一个 HTML 文件

```
<STYLE type="text/css">
   H1 {border-width: 1; border: solid; text-align: center}
</STYLE> 
```

头部内。对 JS 做同样的事情：

```
<SCRIPT type="text/javascript">
   //...some JavaScript...
</SCRIPT> 
```

你完成了。可以使用[data uris](http://en.wikipedia.org/wiki/Data_URI_scheme)将图像包含在 JS、HTML 或 CSS 中：

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot"> 
```

请注意，它们有些受限 - 例如，IE8 似乎不喜欢单个数据中超过 32Kb 的数据。

# java - 用 Java 生成 XSD 文件

> ID：11434284
> 
> 赞同：5
> 
> 时间：2012-07-11T13:56:57.577
> 
> 标签：java, xml, xsd

有没有办法（不是来自类/JAXB）在 Java 中创建 XSD 模式？我可以借助一些库（即 XSOM、Jdom 等）对其进行解析。但找不到任何要创建的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:15:24.037

看看 apache xerces [http://xerces.apache.org/xerces2-j/xml-schema.html](http://xerces.apache.org/xerces2-j/xml-schema.html)

仍然没有现成的解决方案来处理 xsd 文件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:16:37.617

我不知道任何易于使用的方法。我考虑使用 dom4j（因为我将它用于其他目的，但任何其他通用 xml 操作库都是等效的）并手动创建它 (1)。

但后来我意识到我可以使用 JAXB 生成 xml 模式的对象模型，用我想要的填充它（结果比我希望的要舒服得多）并编组它（2）。它通过 JAXB，但没有为您的模式创建类，所以它可能对您有用。

via 2 很难（但并非不可能）创建无效架构，但有时很难找出如何创建我想要的架构。所以我结束了在编辑器中创建它，然后解组它并探索它的对象表示。最后，通过 1) 创建它然后验证它（无论如何我都必须这样做）会少些苦差事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T15:49:10.740

您可以使用 Eclipse [XSD 项目](http://www.eclipse.org/modeling/mdt/?project=xsd#xsd)，它是 Eclipse 模型开发工具的一部分。它提供了用于以编程方式创建模式的数据模型和 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T15:04:46.723

创建`XSD`是使用`java`类/编码（是不可避免的）：

只需使用`Java` `DOM`并创建一个`document`然后主`node`并创建其他`nodes`附加到它，瞧！

# facebook - 按照 Heroku 教程，Foreman 在 Windows 上启动失败

> ID：11434287
> 
> 赞同：18
> 
> 时间：2012-07-11T13:57:00.243
> 
> 标签：facebook, heroku, foreman

我正在关注 Heroku/Facebook 集成的 heroku 教程（但我怀疑这个问题与 facebook 集成无关），我被困在我应该开始工头的阶段（我已经为 windows 安装了 Heroku installbelt ，其中包括工头）：

```
> foreman start 
```

给出：

```
C:/RailsInstaller/Ruby1.8.7/lib/ruby/site_ruby/1.8/rubygems/dependency.rb:247:in `to_specs': Could not find foreman (>= 0) amongst [POpen4-0.1.4, Platform-0.4.0, ZenTest-4.6.2, abstract-1.0.0, actionm
ailer-3.0.11, actionmailer-3.0.9, actionpack-3.0.11, actionpack-3.0.9, activemodel-3.0.11, activemodel-3.0.9, activerecord-3.0.11, activerecord-3.0.9, activerecord-sqlserver-adapter-3.0.15, activereso
urce-3.0.11, activeresource-3.0.9, activesupport-3.0.11, activesupport-3.0.9, addressable-2.2.6, annotate-2.4.0, arel-2.0.10, autotest-4.4.6, autotest-growl-0.2.16, autotest-rails-pure-4.1.2, autotest
-standalone-4.5.8, builder-2.1.2, bundler-1.0.15, diff-lcs-1.1.3, erubis-2.6.6, factory_girl-1.3.3, factory_girl_rails-1.0, faker-0.3.1, gravatar_image_tag-1.0.0.pre2, heroku-2.14.0, i18n-0.5.0, json-
1.6.1, launchy-2.0.5, mail-2.2.19, mime-types-1.17.2, mime-types-1.16, nokogiri-1.5.0-x86-mingw32, open4-1.1.0, pg-0.11.0-x86-mingw32, polyglot-0.3.3, polyglot-0.3.1, rack-1.2.4, rack-1.2.3, rack-moun
t-0.6.14, rack-test-0.5.7, rails-3.0.11, rails-3.0.9, railties-3.0.11, railties-3.0.9, rake-0.9.2.2, rake-0.8.7, rb-readline-0.4.0, rdoc-3.11, rdoc-3.8, rest-client-1.6.7, rspec-2.6.0, rspec-core-2.6.
4, rspec-expectations-2.6.0, rspec-mocks-2.6.0, rspec-rails-2.6.1, rubygems-update-1.8.11, rubyzip-0.9.4, rubyzip2-2.0.1, spork-0.9.0.rc8-x86-mingw32, sqlite3-1.3.3-x86-mingw32, sqlite3-ruby-1.3.3, te
rm-ansicolor-1.0.7, thor-0.14.6, tiny_tds-0.4.5-x86-mingw32, treetop-1.4.10, treetop-1.4.9, tzinfo-0.3.31, tzinfo-0.3.29, webrat-0.7.1, will_paginate-3.0.pre2, win32-api-1.4.8-x86-mingw32, win32-open3
-0.3.2-x86-mingw32, win32-process-0.6.5, windows-api-0.4.0, windows-pr-1.2.1, zip-2.0.2] (Gem::LoadError)
        from C:/RailsInstaller/Ruby1.8.7/lib/ruby/site_ruby/1.8/rubygems/dependency.rb:256:in `to_spec'
        from C:/RailsInstaller/Ruby1.8.7/lib/ruby/site_ruby/1.8/rubygems.rb:1210:in `gem'
        from C:/Program Files (x86)/ruby-1.9.3/bin/foreman:18 
```

由于我在这方面完全是菜鸟，因此我不确定我的问题是否与[遵循 Python/Flask Heroku 教程时的“工头启动”错误](https://stackoverflow.com/questions/11087100/error-on-foreman-start-while-following-the-python-flask-heroku-tutorial)重复（因为它不是完全相同的错误）。如果是这样，是否有人有在 Windows 上部署开发环境的方法（对于 Heruko、Python、Facebook 应用程序）？或者我应该为此使用 Ubuntu 吗？

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-11T15:40:35.443

尽管这里的任何人似乎都不会对这个问题感兴趣（大约 2 小时内有 5 个视图，0 个答案，0 个评论......），但我已经找到了解决方案并准备与遇到它的任何人分享：

1.  [从 ruby ​​installer.org](http://rubyinstaller.org/downloads/) (1.9.3-p194)安装最新的 ruby​​ - 有时会发生相同版本的冲突安装，在我的情况下，我刚刚卸载了所有版本的 ruby​​，但如果您已经有其他需要更旧的应用程序版本那么你必须更加小心

2.  `ruby -v`通过在命令行提示符中调用来检查您的系统是否默认使用此版本：并获取`ruby 1.9.3p194 (2012-04-20) [i386-mingw32]`（您可能必须关闭并重新打开`cmd`，以包含新的环境变量）

3.  仍然在 cmd 中，调用：

    ```
    gem install foreman
    gem install taps 
    ```

4.  现在转到您的`Procfile`应用程序（例如教程中的 heroku 示例应用程序）并执行`foreman start`，您应该会看到如下内容：

    ```
    18:23:52 web.1  | started with pid 7212
    18:23:54 web.1  |  * Running on http://0.0.0.0:5000/
    18:23:54 web.1  |  * Restarting with reloader 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-28T22:05:05.257

手动将 ruby​​ 路径添加到我的系统 PATH 环境变量（Win 7）后，它仍然无法正常工作。

我不得不更改 Heroku 的默认安装路径

`C:\Program Files(x86)\Heroku` 到 `C:\Heroku`

因为它没有正确处理路径中的空间。我也试`C:\PROGRA~2\Heroku\ruby-1.9.2\bin`了也没用。我想任何没有空间的路径都可以。

hth

# php - 来自知识树的 PHP 流 pdf 具有安全性

> ID：11434296
> 
> 赞同：1
> 
> 时间：2012-07-11T13:57:33.123
> 
> 标签：php, html, pdf

任何人都体验过知识树安全的 php 蒸汽 pdf 输出。

我正在尝试编写一个 PHP 脚本，但知识树服务出现问题。我对知识树进行了测试，没有安全性，但它正在工作。正如我们不想公开看到的那样。是给员工的。

**PHP代码： -**

```
Security :-

<form class="login-form" action="https://<kt server name>.knowledgetree.com/plugins/passwordResetPlugin/loginResetEmailDispatcher.php" method="POST" name="login">
<input type="hidden" name="action" value="login" />
<input type="hidden" name="cookieverify" value="" />
<input type="hidden" name="redirect" value="https://<kt server name>.knowledgetree.com/action.php?kt_path_info=ktcore.actions.document.view&fDocumentId=<doc ID>" />
<input name="username" type="hidden" value="example@mail.co.uk" />
<input name="password" type="hidden" value="password"  />
<input id="downloadButton" type="submit" value="Login" style="display:none" />
</form>

No security:-

<form method="post" action="test.php">
<input type="hidden" name="url" value="https://<kt server name>.knowledgetree.com/action.php?kt_path_info=ktcore.actions.document.view&fDocumentId=<doc ID>" /> 
<input id="downloadButton" name="submit"  type="submit" style='display:none' />
</form>

<script language="javascript"> 
document.getElementById("downloadButton").click();
</script>

<?php $destination_folder = 'downloads/';

$url = $_POST['url']; (no security)

$url = $_POST['redirect']; (security)

$newfname = $destination_folder . basename($url);

$newname = $destination_folder . basename($url, "").".pdf";

$file = fopen ($url, "rb");

if ($file) {
  $newf = fopen ($newname, "wb");

  if ($newf)
  while(!feof($file)) {
    fwrite($newf, fread($file, 1024 * 8 ), 1024 * 8 );
  }
}

if ($file) {
  fclose($file);
}

if ($newf) {
  fclose($newf);
  sleep(1);    
rename ($newname, "downloads/example.pdf"); 
} ?>

<iframe src="/downloads/example.pdf" style="border: 0; position:absolute; top:0; left:0; right:0; bottom:0; width:100%; height:100%"></iframe> 
```

请告诉我我该怎么做？

我认为需要使用 php curl。

# objective-c - 适用于 iPad 的 UITabBar 箭头指示器

> ID：11434303
> 
> 赞同：-1
> 
> 时间：2012-07-11T13:57:58.050
> 
> 标签：objective-c, uitabbar

按照[本](http://idevrecipes.com/2010/12/17/twitter-app-tab-bar-animation/)教程，我最终在 iPhone 中为我的 UITabBar 设计了一个漂亮的箭头。

现在我想为 iPad 做同样的事情，但它似乎不起作用。

我试过

```
- (CGFloat) horizontalLocationFor:(NSUInteger)tabIndex
{   
    CGFloat tabItemWidth;
    CGFloat halfTabItemWidth;
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone){
        tabItemWidth = 320 / tabBarController.tabBar.items.count;
        halfTabItemWidth = (tabItemWidth / 2.0) - (tabBarArrow.frame.size.width / 2.0);
    }
    else 
    {
        tabItemWidth = 768 / tabBarController.tabBar.items.count;
        halfTabItemWidth = (tabItemWidth / 2) - (tabBarArrow.frame.size.width / 2);
    }

    return (tabIndex * tabItemWidth) + halfTabItemWidth;
} 
```

按照示例，采用 iPad 的 tabBar 尺寸，但箭头仍然远离每个选项卡的中间。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:45:44.777

试试这个代替你当前的“horizo​​ntalLocationFor”方法：

```
- (CGFloat) horizontalLocationFor:(NSUInteger)tabIndex
{
    // Get the frame of the selected tab item's view.
    // Add one becuase the first subview is the not a button.
    CGRect tabFrame = [[[[[self tabBarController] tabBar] subviews] objectAtIndex:tabIndex+1] frame];

    // Add tab x to half tab width and substract hald arrow image width to center it.
    return tabFrame.origin.x + (tabFrame.size.width * .5) - (tabBarArrow.frame.size.width * .5);
} 
```

最初的解决方案假设标签栏宽度是整个屏幕，但在 ipad 4 上，项目仅填充标签栏宽度的一部分，因此将宽度除以项目数不会让您获得正确的位置。

# sharepoint - 如何在不安装 sharepoint 的情况下使用 Sharepoint cmdlet？

> ID：11434304
> 
> 赞同：4
> 
> 时间：2012-07-11T13:57:59.617
> 
> 标签：sharepoint, powershell, sharepoint-2010, powershell-2.0, sharepointadmin

我必须使用 powershell 将 csv 文件字段上传到 Sharepoint 2010 列表中。我在 Windows XP 机器上工作。

当我尝试添加-pssnapin

```
Add-PSSnapin Microsoft.SharePoint.Powershell 
```

它抛出异常

> “此计算机上未安装 Windows PowerShell 管理单元‘Microsoft.SharePoint.Powershell’。”

是否可以通过安装 Pssnapin 或将必要的 dll 放在某个位置并加载它来使用 Sharepoint Powershell cmdlet？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T14:09:47.397

I think the only way is to `Enable-PSRemoting` on Sharepoint server, then from XP computer:

```
Enter-PSSession -ComputerName sharepointservername
Add-PSSnapin Microsoft.SharePoint.PowerShell 
```

In this way you can manage remotely your sharepoint server

Edit:

[Sharepoint Remoting step by step](http://blogs.msdn.com/b/opal/archive/2010/03/07/sharepoint-2010-with-windows-powershell-remoting-step-by-step.aspx)

# php - 在 PHP 中模拟 LIKE

> ID：11434305
> 
> 赞同：8
> 
> 时间：2012-07-11T13:58:00.570
> 
> 标签：php, sql, string, pcre, sql-like

有没有办法用相同的语法在 PHP 中模拟 SQL 的 LIKE 运算符？（`%`以及`_`通配符和通用`$escape`转义字符）？所以具有：

```
$value LIKE $string ESCAPE $escape 
```

你可以有一个函数来返回 PHP 评估而不使用数据库？（考虑`$value`,`$string`和`$escape`值已经设置）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:06:27.700

这基本上就是你将如何实现这样的事情：

```
$input = '%ST!_ING_!%';
$value = 'ANYCHARS HERE TEST_INGS%';

// Mapping of wildcards to their PCRE equivalents
$wildcards = array( '%' => '.*?', '_' => '.');

// Escape character for preventing wildcard functionality on a wildcard
$escape = '!';

// Shouldn't have to modify much below this

$delimiter = '/'; // regex delimiter

// Quote the escape characters and the wildcard characters
$quoted_escape = preg_quote( $escape);
$quoted_wildcards = array_map( function( $el) { return preg_quote( $el); }, array_keys( $wildcards));

// Form the dynamic regex for the wildcards by replacing the "fake" wildcards with PRCE ones
$temp_regex = '((?:' . $quoted_escape . ')?)(' . implode( '|', $quoted_wildcards) . ')';

// Escape the regex delimiter if it's present within the regex
$wildcard_replacement_regex = $delimiter . str_replace( $delimiter, '\\' . $delimiter, $temp_regex) . $delimiter;

// Do the actual replacement
$regex = preg_replace_callback( $wildcard_replacement_regex, function( $matches) use( $wildcards) { return !empty( $matches[1]) ? preg_quote( $matches[2]) : $wildcards[$matches[2]]; }, preg_quote( $input)); 

// Finally, test the regex against the input $value, escaping the delimiter if it's present
preg_match( $delimiter . str_replace( $delimiter, '\\' . $delimiter, $regex) . $delimiter .'i', $value, $matches);

// Output is in $matches[0] if there was a match
var_dump( $matches[0]); 
```

这形成了一个动态的正则表达式，基于`$wildcards`并且`$escape`为了用它们的 PCRE 等价物替换所有“假”通配符，除非“假”通配符以转义字符为前缀，在这种情况下，不进行替换。为了进行这种替换，`$wildcard_replacement_regex`创建了 。

`$wildcard_replacement_regex`一旦一切都说完了，看起来像这样：

```
/((?:\!)?)(%|_)/ 
```

因此它使用两个捕获组来（可选地）抓取转义字符和通配符之一。这使我们能够测试它是否在回调中抓取了转义字符。如果能够在通配符之前获得转义字符，`$matches[1]`则将包含转义字符。如果没有，`$matches[1]`将是空的。这就是我如何确定是否将通配符替换为其 PCRE 等效项，或者仅通过`preg_quote()`-ing 将其保留。

[你可以在 codepad](http://viper-7.com/tvJRvB)上玩它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T15:56:59.437

好的，经过很多乐趣和游戏，这就是我想出的：

```
function preg_sql_like ($input, $pattern, $escape = '\\') {

    // Split the pattern into special sequences and the rest
    $expr = '/((?:'.preg_quote($escape, '/').')?(?:'.preg_quote($escape, '/').'|%|_))/';
    $parts = preg_split($expr, $pattern, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);

    // Loop the split parts and convert/escape as necessary to build regex
    $expr = '/^';
    $lastWasPercent = FALSE;
    foreach ($parts as $part) {
        switch ($part) {
            case $escape.$escape:
                $expr .= preg_quote($escape, '/');
                break;
            case $escape.'%':
                $expr .= '%';
                break;
            case $escape.'_':
                $expr .= '_';
                break;
            case '%':
                if (!$lastWasPercent) {
                    $expr .= '.*?';
                }
                break;
            case '_':
                $expr .= '.';
                break;
            default:
                $expr .= preg_quote($part, '/');
                break;
        }
        $lastWasPercent = $part == '%';
    }
    $expr .= '$/i';

    // Look for a match and return bool
    return (bool) preg_match($expr, $input);

} 
```

我不能打破它，也许你可以找到一些东西。我的与@nickb 不同的主要方式是我将输入表达式“解析”（ish）为标记以生成正则表达式，而不是将其原位转换为正则表达式。

函数的前 3 个参数应该是不言自明的。~~第四个允许您通过[PCRE 修饰符](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)来影响用于匹配的最终正则表达式。我把它放进去的主要原因是允许你通过`i`，所以它不区分大小写——我想不出任何其他可以安全使用的修饰符，但情况可能并非如此。~~ ^(根据下面的评论删除)

函数只返回一个布尔值，指示`$input`文本是否匹配`$pattern`。

[这是它的键盘](http://codepad.viper-7.com/Wz1ubf)

**编辑**哎呀，坏了，现在修好了。[新的键盘](http://codepad.viper-7.com/FJfQkZ)

**编辑**删除了第四个参数，并根据下面的评论使所有匹配不区分大小写

**编辑**几个小的修复/改进：

*   向生成的正则表达式添加了字符串断言的开始/结束
*   添加了对最后一个令牌的跟踪以避免`.*?`生成的正则表达式中的多个序列

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T13:59:39.473

您可以使用正则表达式，例如：`preg_match`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-18T20:49:39.020

其他的例子对我来说有点太复杂了（而且对我干净的代码眼睛来说很痛苦），所以我用这个简单的方法重新实现了这个功能：

```
public function like($needle, $haystack, $delimiter = '~')
{
    // Escape meta-characters from the string so that they don't gain special significance in the regex
    $needle = preg_quote($needle, $delimiter);

    // Replace SQL wildcards with regex wildcards
    $needle = str_replace('%', '.*?', $needle);
    $needle = str_replace('_', '.', $needle);

    // Add delimiters, beginning + end of line and modifiers
    $needle = $delimiter . '^' . $needle . '$' . $delimiter . 'isu';

    // Matches are not useful in this case; we just need to know whether or not the needle was found.
    return (bool) preg_match($needle, $haystack);
} 
```

[修饰符](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)：

*   `i`: 忽略大小写。
*   `s`：使点元字符匹配任何内容，包括换行符。
*   `u`: UTF-8 兼容性。

# sql-server - 如何管理开发和生产之间的 SQL 权限？

> ID：11434312
> 
> 赞同：3
> 
> 时间：2012-07-11T13:58:21.593
> 
> 标签：sql-server, visual-studio-2010, tfs, vsdbcmd

我正在尝试建立一个平滑的部署过程，我们可以使用单个部署脚本部署到生产或开发 SQL 服务器。

但我不知道如何最好地管理两个环境之间的用户和权限。例如，在开发中，我们希望开发人员组具有`db_owner`数据库角色。在生产中，我们要么不想要访问权限，要么只想要`datareader`角色。

我认为最简单的方法是在每台服务器上设置一次用户，然后不将它们保留在数据库项目中。但随后它们在部署过程中被丢弃。

有什么方法可以使用 Visual Studio 中的项目配置来做到这一点？

我们正在使用完整的 Microsoft 堆栈

*   Visual Studio 2010 数据库项目
*   SQL Server 2008
*   TFS 版本控制和构建服务器
*   `vsdbcmd`用于部署

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T19:06:36.430

有几件事使这更容易：

1.  在包含角色应具有的权限的数据库中创建有意义的角色名称。例如“开发”或“生产支持”。仅将权限分配给这些角色并将用户分配给角色
2.  在您的项目中，您可能对不同的环境有不同的部署配置。由于每个配置都可以使用不同的 sqlcmdvars 文件，因此为您的环境创建一个 SQLCMD 变量并为其输入适当的值（例如，“DEV”用于开发，“PROD”用于生产）
3.  根据 SQLCMD 变量的值，创建一个为正确的环境执行正确操作的部署后脚本。就像是：

--

```
if ('$(Environment)' = 'DEV')
begin
   create user [domain\developers]
   exec sp_addrolemember @rolename='db_owner', @membername='domain\developers'
end 
```

# mongodb - mongoDB group by/distinct 查询

> ID：11434319
> 
> 赞同：0
> 
> 时间：2012-07-11T13:58:33.157
> 
> 标签：mongodb, mapreduce, mongoid

模型检查：

```
checkin
  _id
  interest_id
  author_id 
```

我有一组**签到**（通过简单的“查找”查询解决）我想计算每个兴趣的签到次数。是什么让这项任务变得更加困难 - 我们应该将一个人的两次签到和一个兴趣算作一次签到。

AFAIK，mongo 中的组操作由 m​​ap/reduce 查询执行。我们应该在这里使用它吗？我对这种方法的唯一想法是聚合每个兴趣的用户数组，然后返回这个数组的长度。

**编辑**我最终没有使用 map/reduce，尽管 Emily 的回答工作得很好而且很快。我必须只选择最近 60 分钟的签到，结果不应该太多。所以我只是把它们都交给 Ruby 驱动程序，然后在 ruby​​ 端进行所有计算。它有点慢，但更具可扩展性和易于理解。

最好的，罗马的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T15:42:48.477

Map reduce 可能是解决此问题的方法，您可以通过两个 map reduce 获得所需的结果。

首先，您可以删除重复的 author_id 和 interest_id 对。

*   关键是 author_id 和 interest_id
*   值将是 checkin_id

第二个 map reduce 只是对给定 author_id 的签入次数的计数。

*   关键是 author_id
*   值将是 checkin_id 计数

# javascript - 循环调用异步函数

> ID：11434320
> 
> 赞同：1
> 
> 时间：2012-07-11T13:58:36.643
> 
> 标签：javascript, firefox-addon, firefox-addon-sdk

**问题简介**

我需要在循环中调用异步函数，直到满足条件。*这个特定的函数向网站form.php*发送一个 POST 请求，并对响应执行一些操作，响应是一个 JSON 字符串，表示具有*id*字段的对象。因此，当该 id 为空时，外部循环必须结束。该函数执行以下操作：

```
function asyncFunction(session) {
    (new Request({
        url: form.php,
        content: "sess=" + session,
        onComplete: function (response) {
            var response = response.json;
            if (response.id) {
                doStaff(response.msg);
            } else {
                // Break loop
            }
        }
    })).get();
} 
```

**注意**：虽然我发现了为 Firefox 实现附加组件的问题，但我认为这是一个一般的 javascript 问题。

* * *

**递归实现循环**

我已经尝试通过递归来实现循环，但它不起作用，我不确定这是正确的方法。

```
...
    if (response.id) {
        doStaff(response.msg);
        asyncFunction(session);
    } else {
        // Break loop
    }
... 
```

**使用 jsdeferred**

我也尝试过使用 jsdeferred 库：

```
 Deferred.define(this);
 //Instantiate a new deferred object
 var deferred = new Deferred(); 

 // Main loop: stops when we receive the exception
 Deferred.loop(1000, function() {
      asyncFunction(session, deferred);
      return deferred;
 }).
 error(function() {
     console.log("Loop finished!");
 }); 
```

然后调用：

```
...
    if (response.id) {
        doStaff(response.msg);
        d.call();
    } else {
        d.fail();
    }
... 
```

我实现了序列化，但它开始为每次迭代重复以前的调用。例如，如果它是第三次调用 asyncFunction，它将在迭代 1 和 2 中调用具有相应参数的相同函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:03:32.383

您的问题并不完全清楚，但基本架构必须是异步操作的完成事件处理程序必须决定是重试还是简单地返回。如果操作的结果需要再次尝试，则处理程序应调用父函数。如果没有，那么只需退出循环即可结束。

你不能在 JavaScript 中用任何看起来像简单的“循环”结构的东西编写这样的代码，因为操作是**异步**的。操作的结果不会以允许循环机制对结果执行测试的方式发生；在结果可用之前，循环可能会运行数千次迭代。换句话说，您不会“等待”带有代码的异步操作。您什么都不做等待，并允许注册的事件处理程序在结果准备好时接管。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T15:38:54.740

谢谢你们的帮助。这就是我结束做的事情：

```
var sess = ...;
Deferred.define(this);      
function asyncFunction (session) {
    Deferred.next(function() {
        var d = new Deferred();
        (new Request({
              url: form.php,
              content: "sess=" + session,
              onComplete: function (response) {
                  d.call(response.json);
              }
        })).get();
        return d;
    }).next(function(resp) {
        if (resp.id) {
            asyncFunction(session);
            console.log(resp.msg);              
        }           
    });
}

asyncFunction(sess); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T21:31:59.630

为什么不直接使用 setInterval 循环？在基于 SDK 的扩展的情况下，这看起来像：

[https://builder.addons.mozilla.org/addon/1065247/latest/](https://builder.addons.mozilla.org/addon/1065247/latest/)

与使用计时器相比，类 Promise 模式的最大好处是您可以并行执行操作，并为各种任务使用更复杂的依赖关系。像这样的简单循环可以使用 setInterval 轻松/巧妙地完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T14:40:56.650

如果我正确理解您想要做什么，那么**Deferred**是一个好方法。这是一个使用**jQuery**的示例，它内置了 Deferred 功能 ( `jQuery.Deferred`)

超时用于模拟 http 请求。当每次超时完成（或 http 请求完成）时，会返回一个随机数，该随机数与您的 http 请求的结果等价。

根据请求的结果，您可以决定是需要另一个 http 请求还是要停止。

试试下面的代码片段。包括 jQuery 文件，然后是代码段。它在控制台中保持打印值，并在达到零后停止。

这可能需要一段时间才能理解但很有用。

```
$(function() {

    var MAXNUM = 9;

    function newAsyncRequest() {
        var def = $.Deferred(function(defObject) {
            setTimeout(function() {
                defObject.resolve(Math.floor(Math.random() * (MAXNUM+1)));
            }, 1000);
        });

        def.done(function(val) {
            if (val !== 0)
                newAsyncRequest();
            console.log(val);
        });

    };

    newAsyncRequest();
}); 
```

根据@canuckistani 的建议进行更新

@canuckistani[的回答是正确的](https://stackoverflow.com/a/11441818/1208799)。对于这个问题，解决方案更简单。在不使用 Deferred 的情况下，上面的代码片段变为以下。对不起，我让你找到了一个更艰难的解决方案。

```
$(function() {

    var MAXNUM = 9;

    function newAsyncRequest() {
        setTimeout(function() {
            var val = Math.floor(Math.random() * (MAXNUM+1));
            if (val !== 0)
                newAsyncRequest();
            console.log(val);
        }, 1000);
    }

    newAsyncRequest();

}); 
```

# c# - 尝试使用 jQuery ajax 和 MVC 显示 JSONResult 时出现内部服务器错误 #500

> ID：11434326
> 
> 赞同：0
> 
> 时间：2012-07-11T13:58:45.250
> 
> 标签：c#, asp.net-mvc, json, jquery, asp.net-ajax

**控制器**

```
public JsonResult TeamInfo(string teamName)
            {
                teamDA = new TeamDataAccess();
                var teamInfo = teamDA.TeamInfo(teamName);
               System.Web.Script.Serialization.JavaScriptSerializer oSerializer =
             new System.Web.Script.Serialization.JavaScriptSerializer();
                string sJSON = oSerializer.Serialize(teamInfo);
                JsonResult jsonResult 
=new JsonResult(){ JsonRequestBehavior = JsonRequestBehavior.AllowGet }; 
                    jsonResult.Data = sJSON; // first i give this.
         jsonResult.JsonRequestBehavior = JsonRequestBehavior.AllowGet;
                    return jsonResult;
                } 
```

从 jQuery 调用控制器

```
$.ajax({
                url: 'Team/TeamInfo/' + teamName,
                success: function (data) {
                    $('#teamDetails').html(data);
                    alert('Load was performed.');
                    $("#dialog-modal").dialog("open");
                }
            }); 
```

在调试时，我可以看到它一直执行到控制器的最后一行`return jsonResult;`但`alert('Load was performed.');`不可见。你知道它没有进入成功部分的原因是什么吗？服务器端没有错误。非常感谢任何帮助。

**编辑** 当我添加`error`in ajax 调用时。它显示错误 500（内部服务器错误）。我如何找到这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:27:41.303

您不需要使用 JavaScriptSerializer 制作所有的序列化内容。

您的操作方法可能如下所示：

```
 public JsonResult TeamInfo(string teamName)
 {
      return Json(new TeamDataAccess()TeamInfo(teamName), JsonRequestBehavior.AllowGet); 
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:27:20.327

[$.ajax](http://api.jquery.com/jQuery.ajax/)的默认请求类型是`GET`，但默认情况下不允许 GET 请求，`JsonResult`因此您需要使用[JsonRequestBehavior](http://msdn.microsoft.com/en-us/library/system.web.mvc.jsonresult.jsonrequestbehavior.aspx) 属性明确允许它们：

```
JsonResult jsonResult = 
    new JsonResult { JsonRequestBehavior = JsonRequestBehavior.AllowGet };
jsonResult.Data = sJSON;

return jsonResult; 
```

或者您可以使用 ajax 调用发布`type: 'POST'`

注意：仍然不清楚将返回的 JSON 直接放入 DOM 的目标是什么`$('#teamDetails').html(data);`

# c# - 如何使用 c# 断开浏览器与 Active Directory Server 创建的会话？

> ID：11434327
> 
> 赞同：3
> 
> 时间：2012-07-11T13:58:48.677
> 
> 标签：c#, asp.net, active-directory

我有一个 Intranet 网站，当我没有从我的域 ID 登录时，浏览器会自动生成域 ID 用户名和密码的弹出窗口。

现在的问题是当我关闭我的浏览器并且其他用户使用我的计算机并打开相同的浏览器时，浏览器将不会再次为域 ID 用户名和密码生成弹出窗口并直接使用我的域 ID 打开 Intranet 网站。

当我注销或关闭浏览器时，有什么方法可以终止与 AD 服务器的会话。？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:51:19.017

Active Directory 服务器无法管理客户端与服务器的连接。它所做的只是管理用户凭据和可访问性。要在活动目录中切换角色或用户，您实际上必须注销 Windows 并重新打开。

这是一篇完美的文章，解释了如何捕获登录到您网站的活动目录用户：

[http://msdn.microsoft.com/en-us/library/ff647076.aspx](http://msdn.microsoft.com/en-us/library/ff647076.aspx)

要复制您希望用户登录您的站点的方式，最好的办法是使用表单身份验证，而不是使用您的 Active Directory 凭据。表单身份验证的心态是，您可能有多个用户使用同一台计算机登录您的网站。Windows 身份验证的心态是只有一个用户可以登录计算机，因此默认情况下使用该人的凭据登录 Intranet 网站。

您可以让客户端发送请求以断开与服务器的连接。

[http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.signout.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.signout.aspx)

您还可以尝试在登录期间管理用户的会话：

[http://msdn.microsoft.com/en-us/library/ah635ck5](http://msdn.microsoft.com/en-us/library/ah635ck5)

Abandon 方法似乎可以完成您希望它完成的工作。

旁注：作为使用 Windows 身份验证的程序员，您不必担心额外的安全层，但使用表单身份验证时，您必须牢记安全措施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:20:18.500

我不确定这是否适用于 AD 服务器，但您可以在浏览器关闭时删除会话 cookie。

```
window.onunload=function()
{
   setCookie("YourCookieId","",-1);
} 
```

同样，在注销时，您可以将到期时间设置为 -1 年。

```
HttpCookie cookie2 = new HttpCookie("YourCookieId", "");
cookie2.Expires = DateTime.Now.AddYears(-1);
Response.Cookies.Add(cookie2); 
```

# git - Git 推送和拉取如何与远程仓库/本地仓库一起工作？

> ID：11434328
> 
> 赞同：3
> 
> 时间：2012-07-11T13:58:49.227
> 
> 标签：git

我来自 SVN，我不明白整个 Git 是如何工作的。我已经创建了一个远程仓库，在我的本地机器上克隆了这个仓库——如果我对本地机器上的文件进行更改并尝试将这些文件推送到我克隆的确切远程仓库，我会收到这样的错误。

远程：错误：拒绝更新签出分支：refs/heads/master

我浏览了一些关于同一问题的 SO 问题，最流行的解决方案是创建一个裸存储库，然后提交给它。那么当我从那个新的 repo 克隆时会发生什么——这会再次发生吗？我应该继续为本地的每次提交创建新的裸仓库吗？我很困惑，如果有人能指出我正确的方向，那就太好了。我认为我这样做是完全错误的。

我正在遵循的确切步骤：1）在远程服务器中创建一个目录-init as git repo 2）将我需要的所有内容复制到服务器中 3）将内容添加到 git 并在那里提交 4）将 git repo 从远程克隆到我的本地机器 5) 对我本地的文件进行了更改，将更改添加到我的本地并提交。6）当我尝试将本地所做的更改推送到远程使用时： git push origin 我收到错误消息。我在下面提供了整个错误消息。

```
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require 'git reset --hard' to match
remote: error: the work tree to HEAD.
remote: error: Auto packing the repository for optimum performance.

remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error:
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.
 ! [remote rejected] master -> master (branch is currently checked out) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:06:45.587

裸存储库是您通常应该推送的唯一存储库，因为非裸存储库意味着有需要更新的签出文件的副本。如果您有两个您控制的存储库，并且您希望它们都具有数据的签出副本，`git pull`则从两个位置使用从对面的位置提取。一方面，您可以进行克隆，但另一方面，您必须使用`git remote add`才能创建要从中提取的遥控器。

一个简单的 repo 可以让你进入它，因为你知道你并没有搞乱签出副本的 in-the-middle-of-doing-something 概念。

如果您还没有阅读“gittutorial”的手册页，我会从那里开始，因为它们是开始学习的好地方。

至于一个好的工作模型，我经常有一台（服务器）机器，里面有一个裸仓库，并且经常在*包括*服务器本身在内的多台其他机器上克隆该仓库。因此，如果我在服务器上的 repo 上工作，我不会从裸 repo 工作（显然），我克隆它并在其他地方工作并推入它。这让每个克隆都可以推入“主”裸仓库并从中提取。它使同步更容易一些，尤其是当某些副本并不总是在线时。

注意：没有“错误的方式”或“最好的方式”。每个人都有自己喜欢的存储库处理方式。这是分布式存储库系统（git 或其他）的更好的部分之一：它让每个用户做最适合自己的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:08:42.723

共享/远程存储库使用裸格式，这意味着它们没有工作副本。Subversion 是一样的——中央存储库没有工作副本。工作副本是通过 subversion 中的签出和 git 中的克隆创建的。

如果您将远程存储库更改为裸格式，该问题将不会继续发生。

工作流程与颠覆没有显着不同，只是一个额外的步骤（或两个，取决于您使用的命令）

```
Make changes
git add (to add the changes to the staging area)
git commit (to save the changes to the local repo)
git push (to push the changes to the remote repo) 
```

当您想从远程仓库中拉取其他人的更改时，您可以执行“git pull”，其功能类似于“svn update”。

# css - IE8显示文字不正确，其他浏览器正常

> ID：11434334
> 
> 赞同：0
> 
> 时间：2012-07-11T13:59:06.787
> 
> 标签：css, internet-explorer

我的页面有问题。

文本有点太高，在 Internet Explorer 上有点偏左。

如何纠正这个？

```
.tagibg {
    font-size:11px;
    text-transform:uppercase;
} 
```

在 IE7.css 中（适用于所有 IE 版本）：

```
.tagibg {
    font-variant:small-caps;
} 
```

我的部分php代码：

```
$czytnik->czytaj_szablon('<table>','<tr><td><a href="#link" target="_self"><font class="tytul4">#tytul</font></a><br />
<p /><font class="tytulmalykom">Dodano: #data | #ilosc_wyswietlen odsłon | #ilosc_komentarzy komentarzy</font><br />
<br />#obrazek_l0<br />#tresc<br />
<font class="tagibg">#tagi #zrodlo</font><div style="clear: both;"></div><p />
</td></tr>','</table><div class="old">#strony_2</div>');
echo $czytnik->wypisz();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:21:59.403

我已经改变了一点：

```
<div class="tagibg">#tagi #zrodlo</div><div style="clear: both;"></div><p /> 
```

然后添加：

```
.tagibg {
font-variant:small-caps;
padding-top:10px; 
```

}

# c# - 在中继器中获取控制 ID

> ID：11434338
> 
> 赞同：0
> 
> 时间：2012-07-11T13:59:17.087
> 
> 标签：c#, asp.net, .net, repeater, uniqueidentifier

我有以下片段在运行时在列表视图中获取控件 ID。然而，尽管提供了正确的 id，但在调试时 ctrl 为空。

```
 foreach (ListViewItem item in lvData.Items)
 {
    string uid = item.ClientID;
    Control ctrl = lvData.FindControl(uid+"_lbUnattend");
    ctrl.Visible = false;
 } 
```

我的模板：

```
 <asp:ListView runat="server" ID="lvData" DataSourceID="odsEvents" 
        OnDataBound="lvData_DataBound" 
        onselectedindexchanged="lvData_SelectedIndexChanged">
        <LayoutTemplate>
            <table class="diary" cellspacing="0" width="600px">
                <tr>

                    <th align="center">
                        Date:
                    </th>
                    <th align="center">
                        Time:
                    </th>
                    <th align="center">
                        Event:
                    </th>
                    <th align="center">
                        Location:
                    </th>
                    <th align="center">
                    </th>
                </tr>
                <tr runat="server" id="itemPlaceHolder">
                </tr>
            </table>
        </LayoutTemplate>
        <ItemTemplate>
            <tr>
                <td width="100px" align="center">
                    <%#FRT.Utils.DateTimeHelper.FormatToShortDate(Eval("StartDate"))%>
                    <%#FRT.Utils.DateTimeHelper.FormatToShortDate(Eval("VisitDateStart"))%>
                </td>
                <td width="100px" align="center">
                    <%#FRT.Utils.DateTimeHelper.FormatToShortTime(Eval("StartDate"))%>
                    <%#FRT.Utils.DateTimeHelper.FormatToShortTime(Eval("VisitDateStart"))%>
                </td>
                <td width="100px" align="center">
                    <%#Eval("Title")%>
                </td>
                <td width="200px" align="center">
                    <%# Eval("Address") %>
                </td>
                <td width="100px" align="center">
                 <asp:LinkButton ID="lbLogin" runat="server" Text="I want to attend this event" CssClass="button" />
                 <asp:LinkButton ID="lbAttend" runat="server" Text="I want to attend this event" CssClass="button" />
                 <asp:LinkButton ID="lbUnattend" runat="server" CommandName="unattend" Text="I want to unregister from this event" CssClass="button" />
                 <a href='<%# GetItemUrl(Eval("ActivityID"), Eval("SubEventID")) %>' class="button">See details</a>&nbsp
                </td>
            </tr>
        </ItemTemplate>
 </asp:ListView> 
```

从 lbUnattend 生成的带有 id 的链接按钮是我想要的。

有人指出问题出在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:01:24.910

我想你要找的是

```
foreach (ListViewItem item in lvData.Items)
{
    Control ctrl = item.FindControl("lbUnattend");
    ctrl.Visible = false;
} 
```

# c# - 带数据绑定的 TreeView

> ID：11434341
> 
> 赞同：0
> 
> 时间：2012-07-11T13:59:31.380
> 
> 标签：c#, wpf, data-binding, mvvm

我想使用以下模型在 TreeView 上创建数据绑定：

```
public partial class MainWindow : Window
{
    private ViewModel model = new ViewModel();

    public MainWindow()
    {
        InitializeComponent();
        DataContext = model;
    }
    ...
}

public class ViewModel : ObservableObject
{
    private IList<Document> sourceDocuments;

    public IList<Document> SourceDocuments
    {
        get { return sourceDocuments; }
        set
        {
            sourceDocuments = value;
            OnPropertyChanged("SourceDocuments");
        }
    }

    public ViewModel()
    {
        SourceDocuments = new ObservableCollection<Document>();
    }
}

public class Document
{
    public String Filename;
    public IList<DocumentBlock> Blocks { get; set; }

    public Document(String filename)
    {
        this.Filename = filename;
        Blocks = new List<DocumentBlock>();
    }
}

public class DocumentBlock
{
    public String Name { get; private set; }

    public DocumentBlock(String name)
    {
        this.Name = name;
    }

    public override string ToString()
    {
        return Name;
    }
} 
```

而这个 XAML

```
 <TreeView HorizontalAlignment="Left" Margin="6,6,0,6" Name="SourceDocumentsList" Width="202" 
     ItemsSource="{Binding SourceDocuments}">
     <TreeView.ItemTemplate>
         <HierarchicalDataTemplate ItemsSource="{Binding /Blocks}">
             <TextBlock Text="{Binding /Name}" />
         </HierarchicalDataTemplate>
     </TreeView.ItemTemplate>
 </TreeView> 
```

我收到错误消息`'Blocks' property not found on 'current item of collection' ''Document'`。为什么是这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:03:44.530

您应该删除`/`,`DataContext`中的`ItemTemplate`是一个项目，它本身没有当前项目。绑定也`Name`不起作用，因为`DataContext`仍然是 a ，`Document`您可以指定`HierarchicalDataTemplate.ItemTemplate`，从.`DataContext``DocumentBlock``Blocks`

您通常用于*TreeView 之外的*`/`详细信息视图，例如*`<TextBlock Text="{Binding SourceDocuments/Blocks[0].Name}"/>`*

# android - ListView 只显示 n 行

> ID：11434342
> 
> 赞同：0
> 
> 时间：2012-07-11T13:59:38.187
> 
> 标签：android

有没有办法显示一定数量的行<总金额。我通过简单地将适当的高度 dp 值添加到我的列表视图元素来实现它，但我想知道是否有本机/更智能的方式。

# delphi - 为什么编译器给我这个错误：'GetItem' 的声明与之前的声明不同？

> ID：11434344
> 
> 赞同：2
> 
> 时间：2012-07-11T13:59:43.080
> 
> 标签：delphi, overriding

这是给我错误的代码：

```
TAdvSmoothDockItems = class(TCollection)
private
  FOwner: TAdvSmoothDock;
  FOnChange: TNotifyEvent;
protected
  function GetItem(Index: Integer): TAdvSmoothDockItem; virtual; //YLM_TMS_01
  procedure SetItem(Index: Integer; const Value: TAdvSmoothDockItem); virtual; //YLM_TMS_01
  function GetOwner: TPersistent; override;
public
  constructor Create(AOwner: TAdvSmoothDock); overload; virtual;    //YLM_TMS_01
  function Add: TAdvSmoothDockItem; virtual;    //YLM_TMS_01
  function Insert(Index: Integer): TAdvSmoothDockItem; virtual;    //YLM_TMS_01
  property Items[Index: Integer]: TAdvSmoothDockItem read GetItem write SetItem; default;
  procedure Delete(Index: Integer); virtual;    //YLM_TMS_01
published
  property OnChange: TNotifyEvent read FOnChange write FOnChange;
end;

TKHAdvSmoothDockItems = class(TAdvSmoothDockItems)
  private
    FOwner: TKHAdvSmoothDock;
    FOnChange: TNotifyEvent;
  protected
    function GetItem(Index: Integer): TKHAdvSmoothDockItem; override;
    procedure SetItem(Index: Integer; const Value: TKHAdvSmoothDockItem); override;
    function GetOwner: TPersistent; override;
  public
    constructor Create(AOwner: TKHAdvSmoothDock);
    function Add: TKHAdvSmoothDockItem;
    function Insert(Index: Integer): TKHAdvSmoothDockItem;
    property Items[Index: Integer]: TKHAdvSmoothDockItem read GetItem write SetItem; default;
    procedure Delete(Index: Integer); override;
  published
    property OnChange: TNotifyEvent read FOnChange write FOnChange;
  end; 
```

这段代码给了我以下错误：

E2037 'GetItem' 的声明与之前的声明不同

为什么 ？我已将基类中的 GetItem 声明为“虚拟”，然后我尝试在下一个类（TKHAdvSmoothDockItems）中覆盖它......？如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:02:34.003

因为

```
function GetItem(Index: Integer): TAdvSmoothDockItem; virtual; 
```

不同于

```
function GetItem(Index: Integer): TKHAdvSmoothDockItem; override; 
```

结果类型必须相同。

# c# - 从 FileResult 重定向到 MVC ActionResult

> ID：11434345
> 
> 赞同：20
> 
> 时间：2012-07-11T13:59:45.327
> 
> 标签：c#, asp.net-mvc, fileresult

这可能是一个简单的，但这里有：

我正在我的 MVC3 应用程序中实现一个 excel 可下载报告。我过去使用过这种方法并且效果很好，但是在这种情况下，报告可能不存在销售数据。这是我的代码：

我在 Reports 控制器中有一个 FileResult 操作：

```
 [HttpPost]
    public FileResult ExcelReportDownload(ReportExcelDownloadRequest reportRequest)
    {
        ReportEngine re = new ReportEngine();

        Stream report = re.GetReport(reportRequest);

        return new FileStreamResult(report, "application/ms-excel")
        {
            FileDownloadName = "SalesReport.xls"
        };
    } 
```

我的问题是，有时报告流可能为空，这意味着没有可用的销售信息，在这种情况下，我宁愿重定向到显示消息的视图，说明没有可用的销售信息，但是我不知道如何实现这。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-11T14:04:51.727

好吧，`FileResult`继承自`ActionResult`：

如果您的结果可以是 a `RedirectToRouteResult`（继承自`ActionResult`）或 a `FileResult`，那么...您的操作必须是 type `ActionResult`，它可以管理两者。

类似的东西：

```
 [HttpPost]
    public ActionResult ExcelReportDownload(ReportExcelDownloadRequest reportRequest)
    {
        ReportEngine re = new ReportEngine();

        Stream report = re.GetReport(reportRequest);
        if (report == null)
           return RedirectToAction(<action Name>);
        else
           return new FileStreamResult(report, "application/ms-excel")
           {
               FileDownloadName = "SalesReport.xls"
           };
    } 
```

# gwt - 如何通过 GIN 与 UiBinder 和小部件一起使用注入？

> ID：11434346
> 
> 赞同：8
> 
> 时间：2012-07-11T13:59:45.933
> 
> 标签：gwt, dependency-injection, uibinder, gwt-gin

我将 GWT 2.4 与 gwt-platform 0.7 和 gin 1.5.0 一起使用。

我已经为我的 GWT 应用程序的动态（实时）翻译构建了一个库。因此，每个小部件都会在`LocaleChangeEvent`触发时收到通知，然后要求我`TranslationDictionary`显示新的字符串。

小部件实际上如下所示：

```
public class LocaleAwareLabel extends Label implements LocaleChangeEventHandler {
    TranslationDictionary dictionary;
    String translationToken;

    public LocaleAwareLabel(TranslationDictionary dictionary, EventBus eventBus, String translationToken) {
        this.dictionary = dictionary;
        this.translationToken = translationToken;
        eventBus.addHandler(LocaleChangeEvent.TYPE, this);
        getCurrentTranslationFromDictionary();
    }

    public void getCurrentTranslationFromDictionary() {
        this.setText(dictionary.getTranslation(translationToken));
    }

    @Override
    public void onLocaleChange(LocaleChangeEvent event) {
        getCurrentTranslationFromDictionary();
    }
} 
```

正如你所看到的：我不能轻易地将这个小部件与 UiBinder 一起使用，目前我注入`EventBus`并 `TranslationDictionary`在我的`View`和使用中`@UiField(provided=true)`是这样的：

```
@UiField(provided=true)
LocaleAwareLabel myLabel;

@Inject
public MyView(TranslationDictionary dictionary, EventBus eventBus) {
    widget = uiBinder.createAndBindUi(this);

    myLabel = new LocaleAwareLabel(dictionary, eventBus, "someTranslationToken");
} 
```

**我想要的：**使用没有 的小部件`@UiField(provided=true)`，所以我可以简单地将它们放在这样的内部`ui.xml`：

```
<custom:LocaleAwareLabel ui:field="myLabel" translationToken="someTranslationToken" /> 
```

我知道我可以`translationToken`使用以下方法设置 via UiBinder：

```
public void setTranslationToken(String translationToken) {
    this.translationToken = translationToken;
} 
```

`EventBus`但是我仍然有一个问题，因为and ，我不能使用零参数构造函数`TranslationDictionary`。另外我不能`getCurrentTranslationFromDictionary()`在构造函数内部调用，因为值`translationToken`当然是在构造函数之后设置的。

如果有人可以提供解决方案会很好，也许有代码示例。

PS我是一个完全的注射菜鸟，但据我了解，杜松子酒可能会以某种方式解决我的问题。但我不知道怎么做。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T15:38:28.903

目前依赖注入和 UiBinder 之间存在一些概念上的不匹配，但我目前使用它的方式是：

```
private final Provider<LocaleAwareLabel> labelProvider;

@Inject
public MyView(TranslationDictionary dictionary, 
              EventBus eventBus, 
              Provider<LocaleAwareLabel> labelProvider) {

  this.dictionary = dictionary;
  this.labelProvider = labelProvider;
  initWidget(uiBinder.createAndBindUi(this));
}

@UiFactory
public LocaleAwareLabel buildLocaleAwareLabel() {
  return labelProvider.get();
} 
```

然后我可以在 ui.xml 中创建任意数量的标签：

```
<g:HTMLPanel>
  <custom:LocaleAwareLabel translationToken="abc"/>
  <custom:LocaleAwareLabel translationToken="xyz"/>
</g:HTMLPanel> 
```

在 LocaleAwareLabel 中，我对翻译标记使用 setter 方法，并覆盖`onLoad()`：

```
private String translationToken;

@Inject
public LocaleAwareLabel(TranslationDictionary dictionary, EventBus eventBus) {
  this.dictionary = dictionary;
  initWidget(uiBinder.createAndBindUi(this));
}

@Override
protected void onLoad() {
  super.onLoad();
  doSomethingWithTheTranslationToken(); // do this here, not in the constructor!
}

public void setTranslationToken(final String translationToken) {
  this.translationToken = translationToken;
} 
```

### AssistedInject 示例

MyView 更改为：

```
private final LocaleAwareLabelFactory labelFactory;

@Inject
public MyView(TranslationDictionary dictionary, 
              EventBus eventBus, 
              LocaleAwareLabelFactory labelFactory) {

  this.dictionary = dictionary;
  this.labelFactory = labelFactory;

  initWidget(uiBinder.createAndBindUi(this));
}

@UiFactory
public LocaleAwareLabel buildLocaleAwareLabel(final String translationToken) {
  return labelFactory.create(translationToken);
} 
```

区域感知标签：

```
public interface LocaleAwareLabelFactory {
  LocaleAwareLabel create(final String translationToken);
}

@Inject
public LocaleAwareLabel(TranslationDictionary dictionary, 
                        EventBus eventBus, 
                        @Assisted String translationToken) {

  this.dictionary = dictionary;
  initWidget(uiBinder.createAndBindUi(this));
  doSomethingWithTheTranslationToken(); // now you can do it in the constructor!
} 
```

在您的 Gin 模块中，添加：

```
install(new GinFactoryModuleBuilder().build(LocaleAwareLabelFactory.class)); 
```

确保将 guice 的辅助注入 jar（例如 guice-assistedinject-snapshot.jar）添加到您的类路径中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T15:01:23.377

目前这是不可能的，因为 UiBinder 永远不会调用 GIN 来实例化小部件。为此，您必须使用`@UiFactory`方法，或提供已构建的实例`@Uifield(provided=true)`。

已经有人要求增强以更好地整合两者。你可以在这里跟踪它：[http ://code.google.com/p/google-web-toolkit/issues/detail?id=6151](http://code.google.com/p/google-web-toolkit/issues/detail?id=6151)

作为替代方案，您可以`requestStaticInjection`将 a`Provider`注入一个`static`字段，并`get()`从您的构造函数中调用提供者：

```
public class LocaleAwareLabel extends Label {
   @Inject Provider<EventBus> eventBusProvider;
   @Inject Provider<TranslationDictionary> dictionaryProvider;

   private final TranslationDictionary dictionary;
   private final EventBus eventBus;
   private final string translationToken;

   @UiConstructor
   public LocaleAwareLabel(String translationToken) {
       this(dictionaryProvider.get(), eventBusProvider.get(), translationToken);
   }

   // For cases where you can use injection, or inject params yourself
   @Inject
   public LocaleAwarelabel(TranslationDictionary dictionary, EventBus eventBus,
           String translationToken) {
       this.dictionary = dictionary;
       this.eventBus = eventBus;
       this.translationToken = translationToken;
   } 
```

您可能还对 GIN 对 Assisted-Inject 的支持感兴趣，以便更轻松地编写`@UiFactory`方法或初始化`@UiField(provided=true)`字段。

# java - 如何使用 GroupLayout 构建表单？

> ID：11434347
> 
> 赞同：4
> 
> 时间：2012-07-11T13:59:49.893
> 
> 标签：java, swing, grouplayout

使用 GroupLayout 在 Java 中构建表单的最简单方法是什么？对于表单，我的意思是前面带有标签的文本字段。像这样的东西：

![表格截图](../Images/f35bf898d35934676aa675e505d6f7fc.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T13:59:51.953

使用[Group Layout](http://docs.oracle.com/javase/tutorial/uiswing/layout/group.html)，您可以执行以下操作：

```
package foo;

import javax.swing.*;
import java.awt.*;

public class ChangeIpSettingsDialog extends JDialog
{
public ChangeIpSettingsDialog( Frame owner )
{
    super( owner, true );
    setContentPane( createContent() );
}

private Container createContent()
{
    JPanel result = new JPanel();
    result.setBorder( BorderFactory.createEmptyBorder( 10, 10, 10, 10 ) );

    // Create the layout
    GroupLayout layout = new GroupLayout( result );
    result.setLayout( layout );
    layout.setAutoCreateGaps( true );

    // Create the components we will put in the form
    JLabel ipAddressLabel = new JLabel( "IP Address:" );
    JTextField ipAddressTextField = new JTextField( 20 );
    JLabel subnetLabel = new JLabel( "Subnet:" );
    JTextField subnetTextField = new JTextField( 20 );
    JLabel gatewayLabel = new JLabel( "Gateway:" );
    JTextField gatewayTextField = new JTextField( 20 );

    // Horizontally, we want to align the labels and the text fields
    // along the left (LEADING) edge
    layout.setHorizontalGroup( layout.createSequentialGroup()
                                       .addGroup( layout.createParallelGroup( GroupLayout.Alignment.LEADING )
                                                          .addComponent( ipAddressLabel )
                                                          .addComponent( subnetLabel )
                                                          .addComponent( gatewayLabel ) )
                                       .addGroup( layout.createParallelGroup( GroupLayout.Alignment.LEADING )
                                                          .addComponent( ipAddressTextField )
                                                          .addComponent( subnetTextField )
                                                          .addComponent( gatewayTextField ) )
    );

    // Vertically, we want to align each label with his textfield
    // on the baseline of the components
    layout.setVerticalGroup( layout.createSequentialGroup()
                                     .addGroup( layout.createParallelGroup( GroupLayout.Alignment.BASELINE )
                                                        .addComponent( ipAddressLabel )
                                                        .addComponent( ipAddressTextField ) )
                                     .addGroup( layout.createParallelGroup( GroupLayout.Alignment.BASELINE )
                                                        .addComponent( subnetLabel )
                                                        .addComponent( subnetTextField ) )
                                     .addGroup( layout.createParallelGroup( GroupLayout.Alignment.BASELINE )
                                                        .addComponent( gatewayLabel )
                                                        .addComponent( gatewayTextField ) )
    );

    return result;
}

public static void main( String[] args )
{
    ChangeIpSettingsDialog dialog = new ChangeIpSettingsDialog( null );
    dialog.pack();
    dialog.setVisible( true );
}
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T14:02:48.577

或者您放弃`GroupLayout`并使用[`FormLayout`](http://www.jgoodies.com/freeware/libraries/forms/)，它主要设计为...表单的布局:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T14:06:23.097

只需使用 NetBeans 附带的 GUI 编辑器，称为 Matisse。这是我见过的最神奇的 GUI 编辑器。它工作得非常好，你设计的所有窗口都可以调整大小。

此编辑器使用 GroupLayout 生成代码。

Matisse 的克隆也可用作 Eclipse 插件，但我认为它不是免费的。看看这里（免责声明：我以前从未使用过这个插件，所以我无法判断它是否与原始 Matisse 质量相同）
[http://marketplace.eclipse.org/content/swing-gui-designer](http://marketplace.eclipse.org/content/swing-gui-designer)

这是一个不错的屏幕截图：

![在此处输入图像描述](../Images/2da6ee3b0b7ac6a37a7eae4e22da24cb.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-11T15:41:17.313

一个如何实现演示布局的示例`GridBagLayout`：

```
class Main extends JFrame implements Runnable {

    JLabel lblIpAddress = new JLabel();
    JLabel lblSubnet = new JLabel();
    JLabel lblGateway = new JLabel();

    JTextField txtIpAddress = new JTextField();
    JTextField txtSubnet = new JTextField();
    JTextField txtGateway = new JTextField();

    public void run() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Container content = this.getContentPane();

        lblIpAddress.setText("IP Address");
        lblIpAddress.setLabelFor(txtIpAddress);
        lblSubnet.setText("Subnet");
        lblSubnet.setLabelFor(txtSubnet);
        lblGateway.setText("Gateway");
        lblGateway.setLabelFor(txtGateway);

        GridBagLayout layout = new GridBagLayout();
        content.setLayout(layout);

        content.add(lblIpAddress, newLabelConstraints());
        content.add(txtIpAddress, newTextFieldConstraints());
        content.add(lblSubnet, newLabelConstraints());
        content.add(txtSubnet, newTextFieldConstraints());
        content.add(lblGateway, newLabelConstraints());
        content.add(txtGateway, newTextFieldConstraints());

        // Add a spacer to push all the form rows to the top of the window.
        GridBagConstraints spacer = new GridBagConstraints();
        spacer.fill=BOTH;
        spacer.gridwidth=REMAINDER;
        content.add(new JPanel(), spacer);

        // make sure you can't "cut off" the controls when making the window smaller
        this.pack();
        this.setMinimumSize(this.getSize());

        this.setVisible(true);
    }

    private GridBagConstraints newConstraints() {
        GridBagConstraints c = new GridBagConstraints();
        // a little breathing room
        c.insets = new Insets(2, 2, 2, 2);
        return c;
    }

    private GridBagConstraints newLabelConstraints() {
        GridBagConstraints c = newConstraints();
        // right-align labels
        c.anchor = BASELINE_TRAILING;
        // do not grow labels
        c.weightx=0.0;
        return c;
    }

    private GridBagConstraints newTextFieldConstraints() {
        GridBagConstraints c = newConstraints();
        c.anchor = BASELINE;
        // grow text fields horizontally
        c.weightx=1.0;
        c.fill=HORIZONTAL;
        // text fields end a row
        c.gridwidth=REMAINDER;
        return c;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Main());
    }
} 
```

主要的缺点是，如果你想说，在底部添加一排右对齐的按钮（例如：“确定”和“取消”），这些按钮与其他任何东西都不对齐，你会有使用嵌套的 JPanel。（或者做一些事情，比如让表单为每个按钮都有一个单独的列；然后让文本字段跨越所有这些列和一个额外的间隔列。这是相当违反直觉的，并且会否定可读性优势。我相信 MiGLayout，这是第三个-party 基于网格的布局管理器可以巧妙地处理这种情况，因为它允许合并/跨越网格单元格，*并*拆分合并的单元格。）

# nhibernate - NHibernate 数据库版本控制：对象级模式和数据升级

> ID：11434351
> 
> 赞同：2
> 
> 时间：2012-07-11T13:59:57.203
> 
> 标签：nhibernate, version-control

我想从与大多数提出的策略不同的方向来处理 NHibernate 中的数据库版本控制和自动升级。

由于每个对象都由 XML 映射定义，我想为每个映射文件/配置获取大小和校验和，并将其与潜在的自定义更新脚本一起存储在文档数据库（raven 或其他东西）中。如果没有找到脚本，使用 NHibernate DDL 生成器更新对象模式。通过这种方式我可以检测到更改，如果我需要在 DDL 之外进行 DML 更改，或者执行仔细排序的转换，理论上我可以以受控、可测试的方式进行。这也应该保持一定程度的持久层不可知论，尽管我认为脚本仍然必须是特定于数据库系统的。

诀窍是，从数据库中生成“旧”映射文件并将它们与当前映射文件进行比较。我不知道这是否可能。我也不知道我是否遗漏了其他任何东西，这会使这个策略变得非常不切实际。

那么我的问题是：这个策略有多实用，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T09:21:36.187

我做了什么来解决这个问题

1.  在名为 SchemaVersion 的表中对数据库进行版本控制
2.  查询表以查看架构是否是最新的（存储在 DAL 中的所需版本），如果是则转到 6。
3.  从 resources/webservices/... 获取带有 version == versionFromBb 的 updatescript
4.  运行脚本，该脚本还将架构版本更改为新版本
5.  转到 2。
6.  运行应用

生成脚本我使用了 2 个选项

1.  支持一个 rdbms：运行 SchemaUpdate 导出到文件并手动添加 DML 语句
2.  支持多个 rdbms：使用 Nhibernate 类表在运行时生成 ddl 以添加/更改/删除表和使用会话 DML 的代码

更新：

> “你用什么方法存储当前版本”
> 
> 小例子

像这样的东西

```
public static class Constants
{
    public static readonly Version DatabaseSchemaVersion = new Version(1, 2, 3, 4);
}

public class DBMigration
{
    private IDictionary<Version, Action> _updates = new Dictionary<Version, Action>();
    private Configuration _config;
    private Dialect _dialect;
    private IList<Action<ISession>> _actions = new List<Action<ISession>>(16);
    private string _defaultCatalog;
    private string _defaultSchema;

    private void CreateTable(string name, Action<Table> configuretable)
    {
        var table = new Table(name);
        configuretable(table);

        string createTable = table.SqlCreateString(_dialect, _config.BuildMapping(), _defaultCatalog, _defaultSchema);
        _actions.Add(session => session.CreateSQLQuery(createTable).ExecuteUpdate());
    }

    private void UpdateVersionTo(Version version)
    {
        _actions.Add(session => { session.Get<SchemaVersion>(1).Value = version; session.Flush(); });
    }

    private void WithSession(Action<session> action)
    {
        _actions.Add(action);
    }

    public void Execute(Configuration config)
    {
        _actions.Clear();
        _defaultCatalog = config.Properties[NH.Environment.DefaultCatalog];
        _defaultSchema = config.Properties[NH.Environment.DefaultSchema];
        _config = config;
        _dialect = Dialect.GetDialect(config.Properties);

        using (var sf = _config.BuildSessionFactory())
        using (var session = sf.OpenSession())
        using (var tx = session.BeginTransaction())
        {
            Version dbVersion = session.Get<SchemaVersion>(1).Value;
            while (dbVersion < Constants.DatabaseSchemaVersion)
            {
                _actions.Clear();
                _updates[dbVersion].Invoke(); // init migration, TODO: error handling
                foreach (var action in _actions)
                {
                    action.Invoke(session);
                }
                tx.Commit();
                session.Clear();
                dbVersion = session.Get<SchemaVersion>(1).Value;
            }
        }
    }

    public DBMigration()
    {
        _updates.Add(new Version(1, 0, 0, 0), UpdateFromVersion1);
        _updates.Add(new Version(1, 0, 1, 0), UpdateFromVersion1);
        ...
    }

    private void UpdateFromVersion1()
    {
        AddTable("Users", table => table.AddColumn(...));
        WithSession(session => session.CreateSqlQuery("INSERT INTO ..."));
        UpdateVersionTo(new Version(1,0,1,0));
    }

    ...
} 
```

# asp.net-mvc-3 - 选定项目列表和其他对象

> ID：11434353
> 
> 赞同：1
> 
> 时间：2012-07-11T14:00:00.573
> 
> 标签：asp.net-mvc-3

我是 asp.net mvc3 编程的新手，我正在尝试构建一个特定的表单。我需要一个带有用户字段（我有）的表单，还需要一个对象列表（在这种情况下是 SStatus）。

* * *

**我的表格：**

```
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Création d'utilisateur</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Lastname)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Lastname)
            @Html.ValidationMessageFor(model => model.Lastname)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Firstname)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Firstname)
            @Html.ValidationMessageFor(model => model.Firstname)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Email)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Email)
            @Html.ValidationMessageFor(model => model.Email)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Login)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Login)
            @Html.ValidationMessageFor(model => model.Login)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Description)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Description)
            @Html.ValidationMessageFor(model => model.Description)
        </div>

        <p>Status</p>
        @{ 
```

//错误在这里形成

```
 @{
                    var list = ViewBag.listStatus as List<SStatus>;
                }
                @if (list != null)
                {
                    foreach(var status in list)
                    {
                        <option value=@status.ID>@status.Name</option> 
                    }
                }
            </select>
        }

        <p>
            <input type="submit" value="Création" />
        </p>
    </fieldset>
} 
```

**列表调用：**

* * *

```
public ActionResult CreateUserView()
        {
            RestClient client = new RestClient(Resource.Resource.LocalUrlService);
            RestRequest request = new RestRequest("/status/all", Method.GET);
            var response = client.Execute(request);
            if(response.StatusCode == HttpStatusCode.OK)
            {
                List<SStatus> listSatus = JsonHelper.FromJson<List<SStatus>>(response.Content);
                ViewBag.listStatus = listSatus;
            }
            return View();
        } 
```

**和表格帖子：**

* * *

```
 [HttpPost]
            public ActionResult CreateUserView(Uuser userToCreate, string list)
            {
//list got the ID of SStatus. 
                if (ModelState.IsValid)
                {//Stuff}
    } 
```

所以问题是：如何获得选中的列表项？

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:42:53.283

使用视图模型模式。我仍然看不到您的`Uuser`对象是如何发送*到视图的*（通过默认`[HttpGet]`操作，但我想我看到了您要完成的工作。）如果您以这种方式重构，您仍然可以使用内置的-在验证、自动模型绑定等方面。

```
public class CreateUserViewModel
{
    public Uuser User { get; set; }
    public string Status { get; set; }
} 
```

那么你的动作参数应该是类型，`CreateUserViewModel`例如

```
[HttpPost] 
public ActionResult CreateUserView(CreateUserViewModel vm)
{
    if(ModelState.IsValid)
    {
        {//Stuff}
} 
```

我相信您需要元素`name`上的属性`<select>`才能发布它。

```
<p>Status</p>
    @{
        <select name="Status"> 
```

但是，如果模型无效，您将遇到麻烦。你的观点应该是强类型的，`CreateUserViewModel`例如

```
@model YourModelNamespace.CreateUserViewModel 
```

所以，你的`Lastname`财产可能看起来像这样（注意`.User`）

```
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Création d'utilisateur</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.User.Lastname)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.User.Lastname)
            @Html.ValidationMessageFor(model => model.User.Lastname)
        </div> 
```

最后，我想您可以在 ViewBag 中保留可能的状态列表，但您需要将所选值设置为`@Model.Status`. 您可能需要考虑更改`CreateUserViewModel.Status`为`List<SelectListItem>`可以从控制器填充的，例如您的`GET`操作应该`return View(CreateUserViewModel)`

```
public ActionResult CreateUserViewModel()
{
    CreateUserViewModel vm = new CreateUserViewModel();
    vm.User = // set user
    vm.Status = new List<SelectListItem>()
    {
        new SelectListItem()
        {
            Value = "status1",
            Text = "status 1",
            Selected = false
        },
        new SelectListItem()
        {
            Value = "status2",
            Text = "status 2",
            Selected = true
        },
    };

    return View(vm); // this is the correct way to strongly type your view
} 
```

# javascript - 将表单数组中的表单值与 JS 相乘

> ID：11434357
> 
> 赞同：-1
> 
> 时间：2012-07-11T14:00:07.260
> 
> 标签：javascript, html, arrays

我有带有数组的 html 表单：

```
 <form method="post" id="formaa" name="form">

    <div id="fields">
    <div id="divas1" class="row">
<a href="#" id="did1" onClick="d(this);"><img src="d.jpg" /></a><a href="#" id="uid1" onClick="u(this);">
<img src="u.jpg" /></a><input type="text" name="ite[]" id="item" /><input type="text" name="q[]" id="quantity" class="quant" size="3" />
<input type="text" name="pr[]" id="price" size="10" class="kaina" onkeyup="update();"/><input type="text" name="sum[]" id="suma" size="10" disabled="disabled"/></div>
    </div>
    <br />
    <input type="button" name="nw" id="new" value="ADD" onClick="naujas('laukeliai');" /><br />
    Total: <input type="text" name="sumaa[]" id="suma" size="10" disabled="disabled"/>
    </form> 
```

每次我按下表单添加按钮时，在`<div id="fields">`包含新的 div 块中`<div id=divas(i++)>`，我需要将 qp[] 和 pr[] 值相乘并动态添加到 sum 字段，需要分别将每个产品的价格和数量相乘并得到每个产品的最终价格（并非所有产品总计）。

首先尝试获取所有值并过滤这两个值，但无法弄清楚......

```
var form = document.getElementsByName('form')[0];
var inputs = form.getElementsByTagName('input');
for (var i = 0, j = inputs.length; i < j; i++) {
    var element = inputs[i];
    alert(element.value);
} 
```

如何从这个数组中提取只需要的值并相乘？感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:05:48.023

```
you can read form array in way as below

frmRefer = document.getElementByTagName("form")[0];
for(i= 0 ; i<frmRefer.elements["ite[]"].length;i++){
    alert(frmRefer.elements["ite[]"][i].value );
}
for(i= 0 ; i<frmRefer.elements["quant[]"].length;i++){
    alert(frmRefer.elements["quant[]"][i].value );
}
for(i= 0 ; i<frmRefer.elements["pr[]"].length;i++){
    alert(frmRefer.elements["pr[]"][i].value );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:26:24.003

假设您想要生成您购买的所有产品和数量的价格总和，您首先将 HTML 重写为：

```
<form id="example_form">
<div class="row">
  <input type="text" name="item" class="item"></input>
  <input type="text" name="quant" class="quant"></input>
  <input type="text" name="price" class="price"></input>
</div>
<div class="row">
  <input type="text" name="item" class="item"></input>
  <input type="text" name="quant" class="quant"></input>
  <input type="text" name="price" class="price"></input>
</div>    
<!-- ... many more rows -->
<input type="text" disabled id="sum" name="sum"></input>
</form> 
```

使用 jQuery 使字段访问更容易。使用 JQuery，您将使用以下 JS：

```
function update() {
  var total = 0;
  $("#example_form div.row").each(function(i,o){
    total += $(o).find(".quant").val() *
        $(o).find(".price").val();
  });
  $("#example_form #sum").val(total);
} 
```

这将为您更新总数。要在每次更改任何数字时执行此操作，您需要将其注册到相应的字段，使用类似

```
$("#example_form div.row input").change(update); 
```

我说服你使用 JQuery 了吗？[在http://jsfiddle.net/UnYJ3/2/](http://jsfiddle.net/UnYJ3/1/)看到它的工作

# java - m2eclipse 项目 - 缺少“更新依赖项”

> ID：11434362
> 
> 赞同：1
> 
> 时间：2012-07-11T14:00:31.940
> 
> 标签：java, eclipse, maven

我检查了一个 maven 项目并通过 m2eclipse 插件通过 maven 集成导入到我的 Eclipse (Indigo) 中。我将项目配置为 Maven 项目。当我单击我的项目并单击 Run As... 时，我能够看到所有 maven 配置（maven build、maven clean、maven install 等）。项目图标有一个 m 表示它是一个 maven 项目。当我单击转到 Maven 时，我可以看到

添加依赖 添加插件 新建 Maven 下载 Javadoc 下载源 更新项目 禁用工作区解析 禁用 Maven 自然

- 有人告诉我，我可以在 Maven 菜单下看到“更新依赖项”，但它似乎不见了。考虑到我的 Eclipse 版本或其他内容，这是可以预期的吗？或者我是否必须以某种方式配置项目才能让“更新依赖项”显示在 Maven 菜单下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:43:59.610

这个答案基于 Eclipse Helios 中的 m2e，我还没有在以后的 Eclipse 版本中尝试过。

在我今天安装的最新 m2e 版本上，我发现我需要在上下文菜单中转到 Maven / Update Project...，然后选择所需的选项。（更新依赖项选项似乎固定在我的“打开”位置。）

可能当前版本仍然可以配置为像以前一样显示菜单；我不知道。我这样说是因为我的旧版本比这里的原始帖子晚，但在 Maven 菜单中仍然有 Update Deps 和 Update Project Conf 选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:19:55.537

您是否可以在“配置”菜单下看到“转换为 Maven 项目”选项？

# algorithm - 从给定的单词做回文

> ID：11434375
> 
> 赞同：2
> 
> 时间：2012-07-11T14:01:21.107
> 
> 标签：algorithm

我已经给出了喜欢的词`abca`。我想知道我需要添加多少个字母才能使其成为回文。在这种情况下它是 1，因为如果我添加 b，我得到`abcba`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T14:21:36.070

首先，让我们考虑一个低效的递归解决方案：

假设字符串的形式为`aSb`，其中`a`和`b`是字母，并且`S`是子字符串。

如果`a==b`，那么`f(aSb) = f(S)`。

如果`a!=b`，那么您需要添加一个字母：要么`a`在末尾添加一个，要么`b`在前面添加一个。我们需要尝试两者，看看哪个更好。所以在这种情况下，`f(aSb) = 1 + min(f(aS), f(Sb))`。

这可以使用递归函数来实现，该函数将花费指数时间来运行。

为了提高性能，请注意这个函数只会被原始字符串的子字符串调用。只有 O(n^2) 个这样的子串。因此，通过[记忆](http://en.wikipedia.org/wiki/Memoization)这个函数的结果，我们将花费的时间减少到 O(n^2)，代价是 O(n^2) 空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:05:46.633

基本算法如下所示：

*   遍历字符串的一半并检查字符是否存在于另一端的适当位置（即，如果有，`abca`则第一个字符是 an`a`并且字符串也以 结尾`a`）。
    *   如果它们匹配，则继续下一个字符。
    *   如果它们不匹配，请注意需要添加一个字符。

请注意，您只能在字符匹配时从末尾移动 backwords。例如，如果字符串是，`abcdeffeda`则外部字符匹配。这时我们需要考虑`bcdeffed`。外部字符不匹配，因此`b`需要添加 a。但是我们不想继续`cdeffe`（即删除/忽略两个外部字符），我们只是删除`b`并继续查看`cdeffed`. 与此类似`c`，这意味着我们的算法只返回`2`字符串修改而不是更多。

# grails - 在 grails 服务的 message.properties 文件中设置值

> ID：11434377
> 
> 赞同：0
> 
> 时间：2012-07-11T14:01:23.320
> 
> 标签：grails, grails-plugin, grails-domain-class, grails-controller

我想将值设置为`message.properties`文件。

我已经在java中完成了它，如下所示：

```
 Properties emailErrorMsgProp = new Properties();

    emailErrorMsgProp.load(new FileInputStream("grails-app/i18n/messages.properties"));

    emailErrorMsgProp.setProperty("ma_email_error",result.callStatusMsg.toString());

    emailErrorMsgProp.store(new FileOutputStream("grails-app/i18n/messages.properties"), null); 
```

我也想让它特定于语言。我有特定于语言的属性文件。

我想在 grails 服务中做同样的事情，但我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:57:05.887

尝试这个：

```
def writeToProps(key, value) {
    new File("grails-app/i18n/messages.properties").withWriterAppend { out ->
      out.writeLine "\n${key}=${value}"
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-26T13:37:02.820

你应该看看[ReloadableResourceBundleMessageSource](http://docs.spring.io/spring/docs/2.5.6/api/org/springframework/context/support/ReloadableResourceBundleMessageSource.html)。

# php - 使用 Facebook PHP SDK：未捕获的 CurlException：26：创建 formpost dat 失败

> ID：11434379
> 
> 赞同：0
> 
> 时间：2012-07-11T14:01:25.643
> 
> 标签：php, facebook, api, curl, sdk

我查看了几个关于此错误消息的 stackoverflow 帖子，但没有一个对我有用。

我想上传一张照片到 facebook：

```
public function uploadPhoto($path){
    $photoSettings = array(
        'access_token'=> $this->facebook->getAccessToken(),
        'name' => 'uploaded foto',
        'source' => '@' . realpath($path)
    );

    $photo = $this->facebook->api('me/photos','POST',$photoSettings);
} 
```

当我调用此函数时，我收到以下错误消息：

未捕获的 CurlException：26：创建表单数据失败

我 100% 确定我要上传的图像存在（并且路径正确）。

这是我的 facebook 初始化：（fileUpload 为真）

```
$this->facebook = new Facebook(array(
          'appId'  => $this->config['appId'],
          'secret' => $this->config['appSecret'],
          'fileUpload' => true,
          'cookie' => true
    )); 
```

我真的不明白为什么我会收到这个错误，因为我的代码似乎是正确的。您认为我的服务器/服务器的 cURL 配置可能有问题吗？我不太了解 cURL。

我希望你能帮帮我！我期待着您的回答:-)

问候，安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:54:31.250

您`realpath($path)`没有指向实际的服务器映像位置。如果`$path`是图像的完整路径，则`'source' => '@' . $path`改为使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-05T04:26:09.390

```
I kept getting “CurlException: 26: failed creating formpost data” 

Here is my working code for uploading a photo from the same directory as the PHP page communicating with   Facebook:
$facebook    =  new Facebook(array(
'appId'      =>'*****',
'secret'     =>'*******',
'fileUpload' => true,
'cookie'     => true
));
 $user  =   $facebook ->getUser();
 if($user) 
 {  
$facebook->setFileUploadSupport(true);
$args = array(
    'message' => 'TEst from App.',
    'image' => '@' . realpath('awesome.jpeg')
);
try {
    $data = $facebook->api('/me/photos', 'post', $args);
} catch(FacebookApiException $e) {
    echo "ERROR: " . $e;
}

 } 
```

# c# - 从返回 XML 的 SQL Server 存储过程中获取空结果

> ID：11434382
> 
> 赞同：0
> 
> 时间：2012-07-11T14:01:47.237
> 
> 标签：c#, sql-server, xml

我有一个返回一段 XML 的存储过程。当我从 MS SQL Management Studio 执行它时它工作正常。我需要编写一些 C# 代码来执行 proc 并获取生成的 XML 并将其写入文件。我编写了代码并执行了 proc（我使用分析器进行了检查），没有错误，但 XmlReader 为空。我的代码是这样的：

```
using (SqlConnection c = new SqlConnection(-snip-))
{
c.Open();
SqlCommand myCommand = new SqlCommand("sp_formfill_contract_xml", c);

myCommand.CommandType = CommandType.StoredProcedure;
myCommand.Parameters.AddWithValue("@i_contract_id", frm_contract_id.Text.ToString());                    

System.Xml.XmlReader xmlr = myCommand.ExecuteXmlReader();
xmlr.Read();

while (xmlr.ReadState != System.Xml.ReadState.EndOfFile)
    {
    MessageBox.Show(xmlr.ReadOuterXml());
    // do stuff with the XML snippet here
    }

    c.Close();
    } 
```

作为比较测试，我创建了第二个存储过程，它返回一个包含第一个过程生成的 XML 的纯字符串，只要我不使用 XML 阅读器，C# 代码就可以很好地接收它。所以这与 XML proc 返回的数据类型有关，这使得它看起来是空的。

有任何想法吗？-肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:14:13.767

我看不出它不应该起作用的原因我唯一的猜测是你必须有一行并且你已经去 endofile 调用 xmlr.Read(); 所以请尝试以下方式

```
using(System.Xml.XmlReader xmlr = myCommand.ExecuteXmlReader())
{
 while xmlr.Read())
 {
    MessageBox.Show(xmlr.ReadOuterXml());
 }
} 
```

# ruby-on-rails - has_many 关联提出“未定义的方法”

> ID：11434385
> 
> 赞同：0
> 
> 时间：2012-07-11T14:01:52.937
> 
> 标签：ruby-on-rails, associations, has-many

作为一个真正的新手，我正在使用 RoR 构建一个非常简单的票务系统。

工单可以在我想通过关联连接的状态表中具有状态（例如“已确认”，ID 为“1”）。我想在视图中显示状态。代码如下。但我不断收到未定义的方法错误。也许我以错误的方式建立了关联？

票务.rb:

```
class Ticket < ActiveRecord::Base
belongs_to :user
belongs_to :state 
```

状态.rb：

```
class State < ActiveRecord::Base
has_many :tickets 
```

index.html.erb（基本上是脚手架）：

```
<% @tickets.each do |ticket| %>

<tr>
<td><%= ticket.caller %></td>
<td><%= ticket.supervisor %></td>
<td><%= ticket.subject %></td>
<td><%= ticket.name %></td>
<td><%= ticket.email %></td>
<td><%= ticket.state.status %></td>
<td><%= link_to 'Anzeigen', ticket %></td>
<td><%= link_to 'Bearbeiten', edit_ticket_path(ticket) %></td>
<td><%= link_to 'Löschen', ticket, confirm: 'Sind Sie sicher?', method: :delete %></td> 
```

门票控制器.rb

```
@tickets = Ticket.search(params[:search]).paginate(:page => params[:page], :per_page => 20) 
```

这是它创建的 SQL 查询：

```
State Load (0.5ms)  SELECT "states".* FROM "states" WHERE "states"."id" = 1 LIMIT 1 
```

这会引发以下错误：

```
undefined method `status' for nil:NilClass 
```

有趣的是，它似乎在 rails 控制台中工作： `1.9.3-p194 :016 > @tickets.state State Load (0.5ms) SELECT "states".* FROM "states" WHERE "states"."id" = 2 LIMIT 1 => #<State id: 2, status: "confirmed", created_at: nil, updated_at: nil> 1.9.3-p194 :017 > @tickets.state.status => "confirmed"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:05:08.617

您需要在数据库中添加引用，创建迁移：

```
class AddStateAndUserToTickets < ActiveRecord::Migration
  def up
    change_table :tickets do |t|
      t.references :state
      t.references :user
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T15:24:49.437

尝试使用 Rails 的控制台查看每个票证是否`State`定义了一个对象。它可能正在返回`nil`，使`status`方法未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T15:50:32.547

我想说这是一个简单的数据问题......你的一张票没有状态。对数据库执行查询以确认这一点：

```
 SELECT COUNT(*) FROM tickets t 
 LEFT JOIN states s ON t.state_id = s.id
 WHERE s.id IS NULL 
```

# powershell - 我什么时候需要在 Powershell 中使用引号？

> ID：11434388
> 
> 赞同：2
> 
> 时间：2012-07-11T14:02:14.340
> 
> 标签：powershell

什么时候需要在 Powershell 中用双引号将字符串括起来？我需要以下所有这些吗？

```
& "$sendemail" -f "$sender" -t "$recipient" -u "$subject" -o message-file="$logpath" -s "$emailserver" -o tls=no 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:25:24.520

有[一个解释如何在 PoSH 中使用撇号和引号](http://www.computerperformance.co.uk/powershell/powershell_quotes.htm)。在您的示例中，您不需要它们，因为您不扩展变量或执行连接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T14:34:32.710

在这种情况下，你不需要。

*   `$sendemail`希望已经是一个字符串，因此调用运算符`&`可以处理它（也许其他任何东西都会被强制转换为字符串）。
*   所有其他变量也应正确引用：

    ```
    PS> $subject = 'subject string'
    PS> $recipient = 'recipient string'
    PS> $logpath = 'log path'
    PS> $emailserver = 'email server'
    PS> $recipient = 'recipient''s name'
    PS> $sender = 'sender''s name'
    PS> $sendemail = './echoargs.exe'
    PS> & $sendemail -f $sender -t $recipient -u $subject -o message-file=$logpath -s $emailserver -o tls=no
    arg 1: -f
    arg 2: sender's name
    arg 3: -t
    arg 4: recipient's name
    arg 5: -u
    arg 6: subject string
    arg 7: -o
    arg 8: message-file=log path
    arg 9: -s
    arg 10: email server
    arg 11: -o
    arg 12: tls=no 
    ```

如果要将包含特殊字符（例如 shell 运算符或空格）的文字字符串传递给程序，则需要引号，例如：

```
./echoargs 'some spaces and a | pipe' 
```

如果您的所有参数要么不包含此类内容，要么本身已经包含在字符串变量中，那么没有引号就可以了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-23T21:47:56.697

到目前为止，所有答案都只是完整问题*“您何时需要在 PowerShell 中使用引号（以及何时需要，您使用哪种引号）？”的部分答案。*尽管人们自然会认为 MSDN 页面[about_quoting_rules](http://technet.microsoft.com/en-us/library/dd315325.aspx)会有完整的答案，但事实并非如此。它主要涵盖字符串插值和此处的字符串，但不*涉及*是否或是否真的需要引号。

PowerShell 中的答案可能比其他语言复杂一些，因为 PowerShell 提供了既是脚本语言又是 shell 语言的灵活性。PowerShell 旨在最大限度地减少 shell 的键入工作，正如人们在 shell 语言中所期望的那样，但同时，它可以与 PowerShell 脚本完全互操作。

我实际上开始在这里写一个详细的答案，但它越来越大，直到它变成一篇文章长度的故事加上一个弹出式挂图（如下所示的片段），所有这些都发布在 Simple-Talk.com 上。请参阅[何时在 PowerShell 中引用](https://www.simple-talk.com/sysadmin/powershell/when-to-quote-in-powershell/)。

[![在此处输入图像描述](../Images/3e46e4a67e5b69ca9898fe982f65660a.png)](https://i.stack.imgur.com/1odMU.png)

# python - 跨越多行的刻度标签

> ID：11434389
> 
> 赞同：10
> 
> 时间：2012-07-11T14:02:17.407
> 
> 标签：python, matplotlib

是否可以使 x-tick 标签跨越两行？说，如果我的 x-tick 标签是

```
January 2008, February 2008, March 2008 
```

我希望他们

```
January  February  March
  2008     2008    2008 
```

我不想旋转它们。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-11T14:11:29.207

After a quick test using the code I found [here](http://matplotlib.sourceforge.net/examples/pylab_examples/boxplot_demo2.html), it appears that it does indeed work if you just add a newline in your tick label. e.g.

```
mytics=['January\n2008', 'February\n2008', 'March\n2008'] 
```

# c# - 在 MVC 3 中将分页与 DataTable 对象一起使用

> ID：11434395
> 
> 赞同：1
> 
> 时间：2012-07-11T14:02:30.473
> 
> 标签：c#, database, asp.net-mvc-3, datatable

我从控制器接收一个 DataTable 对象，并使用它在视图中显示一个表，代码如下：

```
@model System.Data.DataTable 

<table width="65%">
<tr>        

    <th>USERNAME</th>
    <th>ROLE</th>
    <th>ACTIVE</th>
    <th></th>
    <th></th>

</tr>

@foreach(DataRow row in Model.Rows)
{
    <tr>           

        @foreach (DataColumn column in Model.Columns)
        {
            <td>@row[column]</td>   
        }

        <td>@Html.ActionLink("Edit", "Edit", new { id = row[0] })</td>
        <td>@Html.ActionLink("Delete", "Delete",new{id=row[0]})</td>              

    </tr>        
}
</table> 
```

我想添加分页，这样当表格中填充了大量数据时，用户不必长时间向下滚动。这是一个基本的学习练习，我在相关控制器操作方法中对所有数据库 SQL 调用进行了硬编码。我没有使用像 NHibernate 这样的 ORM，所以理想情况下我正在寻找一种仅在服务器端使用 DataTable 对象的解决方案。

这是来自控制器的代码（删除了数据库细节）：

```
public ActionResult Index()
    {            
        string oradb = "Data Source = XXXXXXXXXXXXXXXXXXX";

        OracleConnection conn = new OracleConnection(oradb);

        conn.Open();

        string sql = " SELECT USER_ROLE_ID, USERNAME, ROLE, ACTIVE_IND FROM LD_USER_ROLE";

        OracleDataAdapter adapter = new OracleDataAdapter(sql, conn);
        DataTable dt = new DataTable();
        adapter.Fill(dt);

        conn.Close();

        return View(dt);            
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:20:47.833

正如已经指出的，分页通常是在服务器端完成的，这样您就可以获得限制通过网络传输的内容以及限制用户必须接受的内容的好处。但是，如果您只关心用户体验而不是那么关于页面带宽，您可以使用 JavaScript 库（例如[knockout](http://knockoutjs.com/) ）进行客户端分页。查看此[淘汰分页](http://knockoutjs.com/examples/grid.html)链接以获取有关如何完成客户端分页的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T08:56:53.793

为了解决这个问题，我必须重写控制器方法，以便它将 DataTable 转换为用户对象列表，然后我将这个列表传递给视图。通过这样做，我就可以使用 WebGrid 对象，它可以轻松进行分页。控制器代码还使用 dataAccess 对象来封装一些数据库信息和调用。

控制器代码：

```
public ActionResult Index()
    {
        UserRoleDAL udl = new UserRoleDAL();
        DataSet ds = udl.GetData(" SELECT USER_ROLE_ID, USERNAME, ROLE, ACTIVE_IND FROM LD_USER_ROLE");

        var ZUsers = new List<ZUserRoleModel>();

        if (ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
        {
            for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                var dr = ds.Tables[0].Rows[i];

                var ZUser = new ZUserRoleModel()
                {
                    UserRoleId = Convert.ToInt64(dr["USER_ROLE_ID"]),
                    UserName = dr["USERNAME"].ToString(),
                    Role = dr["ROLE"].ToString(),
                    ActiveInd = ActiveBool
                };
                ZUsers.Add(ZUser);
            }
        }

        return View(ZUsers);
    } 
```

查看代码：

```
@model IEnumerable<CIMsWebApp.Models.ZUserRoleModel>

@{  var grid = new WebGrid(Model, canSort: false, canPage: true, rowsPerPage:25); }

@grid.GetHtml(
                tableStyle: "dataGrid", 
                headerStyle: "header",
                alternatingRowStyle: "evenRow", 
                columns: grid.Columns
  (
          grid.Column(header: "UserName", columnName: "UserName"),
          grid.Column(header: "Role ", columnName: "Role"),
          grid.Column(header: "Active", columnName: "ActiveInd"),
          grid.Column(header: "Edit", format: @<text>@Html.ActionLink("Edit", "Edit",  new { id = @item.UserRoleId })</text>),
          grid.Column(header: "Delete", format: @<text>@Html.ActionLink("Delete", "Delete", new { id = @item.UserRoleId })</text>)
  )) 
```

# c++ - mousePressEvent 仅从场景中的某些区域调用

> ID：11434399
> 
> 赞同：1
> 
> 时间：2012-07-11T14:02:45.403
> 
> 标签：c++, qt, user-interface

我有一个应用程序，它根据汽车的不同数据绘制线条。我希望我的应用程序能够选择绘制的线条，然后在左侧的列表中选择相应的项目。问题是 mousePressEvent 仅在我按下场景最左侧四分之一的鼠标按钮时才被调用。当它被调用时，curveSelected() 函数也可以工作，但我不知道为什么我不能从场景的其他区域调用 mousePressEvent。

首先我有一个mousePressEvent。

```
void DrawingScene:::mousePressEvent ( QGraphicsSceneMouseEvent * event ){
    event->ignore();
    bool leftbutton = (event->button() == Qt::LeftButton);
    if(leftbutton)
    {
     qDebug() << "leftbutton";
     emit leftButtonPress(event->scenePos());
    }
    QGraphicsScene::mousePressEvent(event);
} 
```

后来连接：

```
connect(d_scene, SIGNAL(leftButtonPress(QPointF)), this, SLOT(curveSelected(QPointF))); 
```

leftButtonPress 是发出的信号。然后我有选择列表中项目的功能。这种方法似乎工作得很好。没有此功能也存在问题。

```
void CurveDrawer::curveSelected(QPointF pos){
QMapIterator<QPair<unitID, QString>, carData*> it(dataMap);
while(it.hasNext()){
    it.next();
    QPainterPath curPath = it.value()->pathItem->path();
    if(curPath.contains(pos)){
        for (int i = 0; i < list->count(); ++i) {
            QListWidgetItem* curItem = list->item(i);
            if(curItem == it.value()->listItem){
                qDebug() << "curveSelected";
                curItem->setSelected(true);
            }
        }
    }
}
} 
```

任何人都经历过类似的事情，或者可能会在我的代码中看到一些明显的错误？

编辑：

如何实现每次在场景内单击时都会调用 mousePressEvent？这基本上就是我想要它做的。现在只有当我点击某个区域时才会调用它。

我现在尝试用 void DrawGraphicsView;;mousePressEvent(QMouseEvent *event) 来实现它，那里也存在同样的问题。该事件刚刚从场景中的某些区域调用。

对我来说奇怪的是，当场景中的某个位置在视口左侧时，无法调用 mousepressEvent，但是当我在视口中向右滚动同一位置时，突然可以调用 mousepressEvent。这是否使问题更清楚？

# coldfusion - ColdFusion IsImageFile 对 jpg 文件失败

> ID：11434403
> 
> 赞同：5
> 
> 时间：2012-07-11T14:02:51.190
> 
> 标签：coldfusion, coldfusion-9

2张看起来完全一样的jpg图像（上面的失败图像，no.jpg，重新保存为yes.png）但根据IsImageFile函数，一张不是Image。

运行此代码

```
#IsImageFile("http://fdiapp.com/ini/cms/file_uploads/yes.jpg")#
**
#IsImageFile("http://fdiapp.com/ini/cms/file_uploads/no.jpg")# 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:22:31.050

我认为问题在于这是一个`CMYK`jpeg。ColdFusion 9`ImageIO`内部使用，afaik[仅支持 RGB](https://stackoverflow.com/questions/2408613/problem-reading-jpeg-image-using-imageio-readfile-file)。（虽然该线程中的一些 java 建议确实可以从 ColdFusion 工作 - 结果图像中的颜色是倾斜的。）可能发生的情况是`ImageIO`甚至无法加载图像文件，这就是为什么`IsImageFile`返回“否”。

FWIW，`IsImageFile`在 ColdFusion 10 中返回“是”。但是，它仍然存在`CMYK`. 例如，如果您尝试阅读图像，最终的颜色都是错误的......

我认为最好的办法是通过[ImageMagick](http://www.imagemagick.org/script/index.php)之类的工具运行它，并将其转换为 ColdFusion 可以正确处理的格式。

# android - 升级后无法在eclipse中创建新的android应用程序

> ID：11434405
> 
> 赞同：1
> 
> 时间：2012-07-11T14:02:58.727
> 
> 标签：android, eclipse, adt

在 eclipse Helios 中，我已将我的 android 插件和 android sdk 升级到最新版本。升级后我无法创建新的 android 应用程序这是我收到的错误消息的屏幕截图 ![在此处输入图像描述](../Images/55e360082453d80669b1ae3ea48a5401.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T06:49:57.763

不要删除 Support 库，转到 SDK_Folder/extra/android 并将文件夹兼容性重命名为 support。之后，重新启动 Eclipse。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T16:01:48.307

问题列在 code.google.com

这是[链接](http://code.google.com/p/android/issues/detail?id=33859)

jaisonDavis 评论的解决方法对我有用。（*也建议在 code.google.com 中*）

*   打开**sdk manager**并删除*位于 extras 下的* 现有**Android Support Library**

**   创建一个**新项目**并 **通过单击“安装/升级”安装支持库***

# c# - 从 Arraylist 中删除行

> ID：11434407
> 
> 赞同：0
> 
> 时间：2012-07-11T14:03:04.250
> 
> 标签：c#, asp.net

有没有人有任何帮助，我正在使用 Arraylist 在会话中存储详细信息。当将物品添加到购物车时，我希望能够拥有一些功能，我从删除按钮开始（最终我也想要一个编辑按钮）所以我尝试了两种删除按钮的方法，但都不适合我，第一次尝试：

sc.aspx 页面

```
 <asp:TemplateField> 
    <ItemTemplate> 
        <asp:Button ID="btnDelete" runat="server" CommandArgument='<%# ((GridViewRow)Container).RowIndex %>' CommandName="deleterow" Text="Delete" /> 
    </ItemTemplate>
</asp:TemplateField>' 
```

和：

```
'onrowcommand="DeleteRowBtn_Click"' 
```

sc.aspx.cs

```
'protected void DeleteRowBtn_Click(object sender, GridViewCommandEventArgs e)
{
    int rowIndex = Convert.ToInt32(e.CommandArgument); 
}' 
```

第二次尝试：

sc.aspx

```
'OnRowDeleting="GridView1_RowDeleting"'

 '<asp:CommandField ShowDeleteButton="True" />' 
```

sc.aspx.cs

```
'protected void GridView1_RowDeleting(object sender, GridViewDeleteEventArgs e)
{
    ArrayList remove = (ArrayList)Session["aList"];
    DataRow dr = remove.Rows[e.RowIndex];
    remove.Rows.Remove(dr);
    GridView1.EditIndex = -1;
    FillShopCart();
}' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:11:33.143

这不起作用，因为 an`ArrayList`没有`Rows`属性，但有一个像数组这样的[索引器：](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.item)

```
ArrayList remove = (ArrayList)Session["aList"];
DataRow dr = remove.Rows[e.RowIndex]; 
```

所以这可以工作

```
DataRow dr = (DataRow)remove[e.RowIndex]; 
```

**旁注**：如果您至少使用 .NET 2.0 并使用强类型集合（如or ） ，则应避免使用`ArrayList`（或） 。`HashTable``List<T>``Dictionary<TKey, TValue>`

# c# - 在 C# 中发送 http 请求并捕获网络问题

> ID：11434408
> 
> 赞同：3
> 
> 时间：2012-07-11T14:03:06.057
> 
> 标签：c#, http

我以前有一个小型 VBScript，它可以通过发送 GET 请求来测试是否可以访问特定网站。脚本本身非常简单，并且做了我需要的一切：

```
Function GETRequest(URL) 'Sends a GET http request to a specific URL
   Dim objHttpRequest

   Set objHttpRequest = CreateObject("MSXML2.XMLHTTP.3.0")
   objHttpRequest.Open "GET", URL, False

   On Error Resume Next 'Error checking in case access is denied
   objHttpRequest.Send

   GETRequest = objHttpRequest.Status
End Function 
```

我现在想在扩展的 C# 应用程序中包含这种功能。但是，我无法获得与之前脚本提供的相同的结果。

使用类似于我在下面发布的代码可以获得正确的结果，但如果我的网络连接失败，则无法运行。

```
public static void GETRequest()
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://url");
    request.Method = "GET";
    HttpStatusCode status;
    HttpWebResponse response;
    try
    {
       response = (HttpWebResponse)request.GetResponse();
       status = response.StatusCode;
       Console.WriteLine((int)response.StatusCode);
       Console.WriteLine(status);
    }
    catch (WebException e)
    {
       status = ((HttpWebResponse)e.Response).StatusCode;
       Console.WriteLine(status);
    }
} 
```

但正如我所说，我需要知道该站点是否可以访问，无论原因是什么：门户可能已关闭，或者问题可能出在尝试访问它的 PC 端。不管怎样：我不在乎。

当我在脚本中使用时，如果遇到网络问题，`MSXML2.XMLHTTP.3.0`我能够获得从**12000**到**12156的值。**我想在我的 C# 应用程序中拥有相同的功能，这样我至少可以将最少的信息写入日志并让计算机采取相应的行动。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:17:52.363

您的代码的直接翻译将是这样的：

```
static void GetStatusCode(string url)
{
    dynamic httpRequest = Activator.CreateInstance(Type.GetTypeFromProgID("MSXML2.XMLHTTP.3.0"));
    httpRequest.Open("GET", url, false);

    try     { httpRequest.Send(); }
    catch   { }
    finally { Console.WriteLine(httpRequest.Status); }
} 
```

它与您的 VBScript 脚本一样小而简单，并且使用相同的 COM 对象来发送请求。

这段代码很高兴地给了我类似`12029 ERROR_WINHTTP_CANNOT_CONNECT`或之类的错误代码`12007 ERROR_WINHTTP_NAME_NOT_RESOLVED`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:15:38.650

如果代码仅在您没有可用的网络连接时失败，您可以在执行代码之前使用 GetIsNetworkAvailable()。此方法将返回一个布尔值，指示网络连接是否可用。如果返回 false，您可以执行提前返回/通知用户，如果没有，则继续。

```
System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable() 
```

使用您在上面提供的代码：

```
public static void GETRequest()
{
    if (!System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
        return; //or alert the user there is no connection

    HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://url");
    request.Method = "GET";
    HttpStatusCode status;
    HttpWebResponse response;
    try
    {
       response = (HttpWebResponse)request.GetResponse();
       status = response.StatusCode;
       Console.WriteLine((int)response.StatusCode);
       Console.WriteLine(status);
    }
    catch (WebException e)
    {
       status = ((HttpWebResponse)e.Response).StatusCode;
       Console.WriteLine(status);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:16:08.713

这应该对你有用，我以前用过很多次，根据你的需要减少一点：-

```
private static string GetStatusCode(string url)
{
      HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);
      req.Method = WebRequestMethods.Http.Get;
      req.ProtocolVersion = HttpVersion.Version11;
      req.UserAgent = "Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)";

      try
      {
         HttpWebResponse response = (HttpWebResponse)req.GetResponse();
         StringBuilder sb = new StringBuilder();

         foreach (string header in response.Headers)
         {
            sb.AppendLine(string.Format("{0}: {1}", header, response.GetResponseHeader(header)));
         }

         return string.Format("Response Status Code: {0}\nServer:{1}\nProtocol: {2}\nRequest Method: {3}\n\n***Headers***\n\n{4}", response.StatusCode,response.Server, response.ProtocolVersion, response.Method, sb);
       }
       catch (Exception e)
       {
          return string.Format("Error: {0}", e.ToString());
       }
} 
```

随意忽略获取标题的部分

# django - 为什么 uWSGI 不编译我的 django 本地化文件？

> ID：11434411
> 
> 赞同：0
> 
> 时间：2012-07-11T14:03:18.100
> 
> 标签：django, apache, internationalization, uwsgi

当我用我的 django 项目重新启动我的 apache 服务器 (+mod_wsgi) 时，它会将 django.po 文件重新编译为用于国际化的新 django mo 文件。

现在我尝试 uWSGI 服务器，但它不这样做。为什么会发生这种情况？还是uWSGI正常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T03:47:13.633

这不是 django 应该做的事情（独立于应用程序服务器）。也许您有一些 mod_wsgi 配置（或修改后的 .wsgi 文件）用于调用：

django-admin.py 编译消息

或类似的东西。

确保在 uWSGI 中使用相同的 .wsgi 文件（带有 --wsgi-file 选项），或者仔细检查 mod_wsgi 选项。

# java - jplayer 播放列表？

> ID：11434426
> 
> 赞同：0
> 
> 时间：2012-07-11T14:04:08.973
> 
> 标签：java, video, playback, jplayer, playlist

jPlayer.org 上的文档似乎没有包含有关如何创建视频播放列表的任何内容，例如演示中的播放列表。如何使用 jPlayer 创建预定义的播放列表？

如果它有助于了解，我希望在我的网站上播放视频之前自动添加广告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:16:30.933

你可以看看他们[演示页面](http://jplayer.org/latest/demo-02-multi/)的源代码。您将看到他们如何设置两个 jPlayerPlaylist 对象。

```
$(document).ready(function(){

new jPlayerPlaylist({
    jPlayer: "#jquery_jplayer_1",
    cssSelectorAncestor: "#jp_container_1"
}, [
    {
        title:"Big Buck Bunny Trailer",
        artist:"Blender Foundation",
        free:true,
        m4v:"http://www.jplayer.org/video/m4v/Big_Buck_Bunny_Trailer.m4v",
        ogv:"http://www.jplayer.org/video/ogv/Big_Buck_Bunny_Trailer.ogv",
        webmv: "http://www.jplayer.org/video/webm/Big_Buck_Bunny_Trailer.webm",
        poster:"http://www.jplayer.org/video/poster/Big_Buck_Bunny_Trailer_480x270.png"
    },
    {
        title:"Finding Nemo Teaser",
        artist:"Pixar",
        m4v: "http://www.jplayer.org/video/m4v/Finding_Nemo_Teaser.m4v",
        ogv: "http://www.jplayer.org/video/ogv/Finding_Nemo_Teaser.ogv",
        webmv: "http://www.jplayer.org/video/webm/Finding_Nemo_Teaser.webm",
        poster: "http://www.jplayer.org/video/poster/Finding_Nemo_Teaser_640x352.png"
    },
    {
        title:"Incredibles Teaser",
        artist:"Pixar",
        m4v: "http://www.jplayer.org/video/m4v/Incredibles_Teaser.m4v",
        ogv: "http://www.jplayer.org/video/ogv/Incredibles_Teaser.ogv",
        webmv: "http://www.jplayer.org/video/webm/Incredibles_Teaser.webm",
        poster: "http://www.jplayer.org/video/poster/Incredibles_Teaser_640x272.png"
    }
], {
    swfPath: "../js",
    supplied: "webmv, ogv, m4v"
});
......

)}; 
```

# c# - “长度不能小于零。” 数据库操作后

> ID：11434428
> 
> 赞同：-1
> 
> 时间：2012-07-11T14:04:17.467
> 
> 标签：c#, .net, iis

首先，我想提前为我在 C# 领域缺乏熟练程度表示歉意。

尽管我对该主题知之甚少，但我处于需要创建网站的精确副本的情况。该网站使用 .NET 4.0，在带有 MSSQL Server 2008 的 IIS 7 上运行。新网站设置为旧网站的子域。

我对原始数据库进行了完整备份，创建了一个新数据库并使用原始备份“恢复”了它。我唯一改变的是 .mdf 和 .ldf 文件。

然后，我将实际文件复制并粘贴到新文件夹中，并使用新数据库更改了配置文件。

在您向/从数据库中添加/删除新闻之前，一切都运行良好。此时，网站的首页呈现以下消息：

**“/”应用程序中的服务器错误。**

长度不能小于零。

参数名称：长度

堆栈跟踪：

```
[ArgumentOutOfRangeException: Length cannot be less than zero.
 Parameter name: length]
 System.String.InternalSubStringWithChecks(Int32 startIndex, Int32 length, Boolean               fAlwaysCopy) +10082776
 Tang.Core.Utility.HtmlHelper.CutText(String rawText, Int32 length) +242
  Tang.Website.UC.ArticleItems.GetLegacyDataTable(Int32 collectionId, Int32 maxRecord)   +2172
 Tang.Website.UC.ArticleItems.Page_Load(Object sender, EventArgs e) +150
  System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t,   EventArgs e) +25
  System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +42
   System.Web.UI.Control.OnLoad(EventArgs e) +132
   System.Web.UI.Control.LoadRecursive() +66
   System.Web.UI.Control.LoadRecursive() +191
   System.Web.UI.Control.LoadRecursive() +191
   System.Web.UI.Control.LoadRecursive() +191
   System.Web.UI.Control.LoadRecursive() +191
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2428 
```

另一个错误是用户登录时（再次“长度不能为零”）：

```
 <%-- <p class="news_date"><%# Eval("collectionitemdatetime", "{0:d}") %></p>--%>
            <p class="news_cont">
                **<%# Tang.Core.Utility.HtmlHelper.CutText( Eval("collectionitemtext").ToString(), 450) %>** --> THIS IS WHERE THE PROBLEM IS, OBVIOUSLY STRING IS EMPTY?</p>
        </div>
    </ItemTemplate> 
```

我完全迷失了，因为没有从原始版本中编辑任何“主要”内容。我一定是数据库做错了。

编辑：问题是，一旦我将数据库从 webconfig 文件 [更改为原始数据库]，一切正常，我可以添加/删除/编辑项目，它们会显示在主页上。所以它必须是网站和数据库之间的东西，而不是与代码相关的东西

**编辑2，找到解决方案：**我删除了数据库，创建了一个新数据库，而不是“恢复”，而是从原始数据库中“导出”。我必须手动设置主键并将其中一些更改为（是识别） - 是的，因为我遇到了同样的错误。不是最优雅的解决方案，但至少现在一切似乎都在工作。

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:48:24.650

看起来长度参数带有 CutText 函数的 -1 值。有你使用的 ORM 工具吗？如果您使用实体框架，则必须正确设置连接字符串。也许您的 sql 安全属性不允许您添加。添加新闻时，请务必查看您的数据库。

# visual-studio-2010 - 是否可以更改 Visual Studio 架构比较差异工具？

> ID：11434429
> 
> 赞同：2
> 
> 时间：2012-07-11T14:04:22.253
> 
> 标签：visual-studio-2010, diff

[当您单击Visual Studio 架构比较](http://www.codeproject.com/Articles/145979/SQL-Server-Schema-Comparison-Tool-in-Visual-Studio)结果集中的一行时，它会显示比较的源与目标的差异。有没有办法使用不同的差异工具进行比较？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:13:02.160

这在很大程度上取决于您使用的源代码管理类型。但经常有与源代码管理选项相关的选项页面

工具->选项->源代码管理。

例如，Subversion 在此菜单下有一个名为 Subversion User Tools 的设置，允许您指定外部差异工具。

如果是 TFS，则有一个名为 Visual Studio Team Foundation Server 的菜单选项。在此属性页上，有一个名为“配置用户工具”的按钮...

其他源代码控制系统也有类似的机制

# jms - ServiceMix、Apache ActiveMQ、Camel 为消费消息发送“完成”

> ID：11434430
> 
> 赞同：0
> 
> 时间：2012-07-11T14:04:24.640
> 
> 标签：jms, activemq, esb, apache-servicemix

我遇到的问题是：使用服务组合和骆驼路由，我通过 activeMQ 向消费者发送 JSON 消息。问题是该消费者处理此消息所花费的时间是 X，因此消费者在使用消息期间可能会停止或崩溃。在这种情况下，消息将是一半的消费者，并且已经从队列中删除，因为它已经被传递了。

是否可以使队列在消息被消费时不删除消息，而是等待消费者确认该消息的处理已完成，然后再删除它？

在从文件系统导入文件的典型情况下，您将删除文件或将其重命名为仅在文件已完全处理且事务已完全提交的末尾完成。那么在 ESB 世界中，我们可以说保留消息直到我完成，然后我告诉你删除它。

我目前正在使用 spring jms:listener-container 和 jms:listeners 来使用这些消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T21:28:51.767

您的问题是 JMS 事务每天解决的问题。

ActiveMQ 的一些注释在[这里](http://activemq.apache.org/should-i-use-transactions.html)

您可以轻松地在 JMS 中使用本地事务，并像这样设置一个侦听器容器（请注意 sessionTransacted 上的 true）：

```
<bean id="myListenerContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
    <property name="concurrentConsumers" value="1" />
    <property name="connectionFactory" ref="jmsConnectionFactory" />
    <property name="destination" ref="myQueue" />
    <property name="messageListener" ref="myConsumerBean" />
    <property name="sessionTransacted" value="true" />
</bean> 
```

然后你有一个事务处理的会话。如果消息侦听器消费消息失败，消息将回滚到队列中。除非消息侦听器 bean 中的“onMessage”方法成功返回（不抛出异常），否则事务不会提交（=从队列中删除的消息）。我想这就是你想要的

# java - Java中没有堆栈跟踪的异常

> ID：11434431
> 
> 赞同：59
> 
> 时间：2012-07-11T14:04:29.647
> 
> 标签：java, exception, stack-trace

这可能是一个非常幼稚的问题。

我曾经相信`Throwable`Java中的 a*总是*包含堆栈跟踪。这是正确的吗？

现在看起来我在*没有*堆栈跟踪的情况下捕获了异常。是否有意义？是否*可以*在没有堆栈跟踪的情况下捕获异常？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-11T14:07:42.857

可以在没有堆栈跟踪的情况下在 Java 中捕获 Throwable 对象：

```
Throwable(String message, Throwable cause, boolean enableSuppression,boolean writableStackTrace) 
```

> **使用指定的详细消息、原因、启用或禁用抑制以及启用或禁用可写堆栈跟踪**构造一个新的 throwable 。

```
public Throwable fillInStackTrace() 
```

> 填写执行堆栈跟踪。此方法在此 Throwable 对象中记录有关当前线程的堆栈帧的当前状态的信息。
> 
> **如果这个 Throwable 的栈轨迹不可写，调用这个方法是没有效果**的。

[http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-08-15T09:54:40.513

对于 Java 6：

由于 Java 6 没有`Throwable(String message, Throwable cause, boolean enableSuppression,boolean writableStackTrace)`构造函数，我们可以使用以下技术抑制堆栈跟踪填充（借用 Scala，从[Java 异常有多慢？](https://stackoverflow.com/questions/299068/how-slow-are-java-exceptions)）

```
class NoStackTraceRuntimeException extends RuntimeException {
    @Override
    public synchronized Throwable fillInStackTrace() {
        return this;
    }
} 
```

用法相同：`throw new NoStackTraceRuntimeException ()`，或者它的子类型。

我们也可以通过扩展来做同样的事情`Throwable`：

```
class NoStackTraceThrowable extends Throwable {
    @Override
    public synchronized Throwable fillInStackTrace() {
        return this;
    }
} 
```

但是，一个小问题是您不再可以`catch`使用这些异常，`Exception`因为这不是 的子类型`Exception`，而是应该捕获`NoStackTraceThrowable`或它的子类型。

**更新**：有关不同用例中性能的一些有趣统计数据，请查看这个[SO question](https://stackoverflow.com/a/25324557/340290)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-09-22T22:35:20.513

对于 Java 7+，这里是一个异常示例，可以选择抑制堆栈跟踪。

```
public class SuppressableStacktraceException extends Exception {

    private boolean suppressStacktrace = false;

    public SuppressableStacktraceException(String message, boolean suppressStacktrace) {
        super(message, null, suppressStacktrace, !suppressStacktrace);
        this.suppressStacktrace = suppressStacktrace;
    }

    @Override
    public String toString() {
        if (suppressStacktrace) {
            return getLocalizedMessage();
        } else {
            return super.toString();
        }
    }
} 
```

这可以通过以下方式证明：

```
try {
    throw new SuppressableStacktraceException("Not suppressed", false);
} catch (SuppressableStacktraceException e) {
    e.printStackTrace();
}
try {
    throw new SuppressableStacktraceException("Suppressed", true);
} catch (SuppressableStacktraceException e) {
    e.printStackTrace();
} 
```

这是基于[Apache SystemML](http://systemml.apache.org/ "Apache SystemML")的 MLContextException的，其代码可在 GitHub 上的[https://github.com/apache/systemml](https://github.com/apache/systemml)上找到。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-10-14T13:50:46.087

抑制任何异常的堆栈跟踪的最简单方法是

```
throwable.setStackTrace(new StackTraceElement[0]); 
```

如果异常有原因，您可能需要递归地执行相同的操作。

**这也尽可能地减少了创建堆栈跟踪的成本**

throwable 的堆栈跟踪在

```
Throwable#fillInStackTrace() 
```

，由任何构造函数调用，因此无法避免。当实际使用 stacktrace 时，会延迟构造一个 StackTraceElement[]

```
Throwable#getOurStackTrace() 
```

只有在尚未设置字段 Throwable.stackTrace 时才会发生这种情况。

将堆栈跟踪设置为任何非空值，避免在 Throwable#getOurStackTrace() 中构造 StackTraceElement[] 并尽可能减少性能损失。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-06T07:22:36.933

正如 NG. 在回复中所暗示的那样，如果您一开始看到堆栈跟踪但随后由于相同的异常而消失，您很可能看到了 JVM 优化的效果。在这种情况下，以下问题非常相似。

[没有堆栈跟踪的重复异常 - 如何重置？](https://stackoverflow.com/questions/4659151/recurring-exception-without-a-stack-trace-how-to-reset)

[没有 StackTrace 的 Java 中的 NullPointerException](https://stackoverflow.com/questions/2411487/nullpointerexception-in-java-with-no-stacktrace)

您可以关闭此 JVM 功能，但我建议保持启用它并努力从一开始就防止错误，或者捕获它并更优雅地处理它。

# php - CakePHP 将 2 个模型分页为 1 组结果

> ID：11434449
> 
> 赞同：0
> 
> 时间：2012-07-11T14:05:20.990
> 
> 标签：php, mysql, database, cakephp

感觉就像我已经尝试了一切。我正在从 2 个数据表“规范”和“更新”构建各种新闻源。这是 CakePHP 代码。

```
// Setup pagination
$this->paginate = array(
    'Spec' => array(
        'fields' => array(
            'Spec.id',
            'Spec.name'
        ),
        'limit' => 10,
        'conditions' => array(
            'Spec.car_id' => $id
        ),
        'order' => array(
            'Spec.created' => $orderSetting
        )
    ),
    'Update' => array(
        'fields' => array(
            'Update.id',
            'Update.name'
        ),
        'limit' => 10,
        'conditions' => array(
            'Update.car_id' => $id
        ),
        'order' => array(
            'Update.created' => $orderSetting
        )
    )
);
$updates = $this->paginate(array('Spec', 'Update')); 
```

这将返回一个 SQL 错误。

```
SQL Error: 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Update' at line 1 
```

问题是这条线 - 它只允许一个项目？$updates = $this->paginate(array('Spec', 'Update')); 例如。$updates = $this->paginate('Spec');

当然，这不是我想要的。

非常感谢任何帮助或方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T16:25:07.660

该`paginate()`函数不允许多个模型作为参数，因为它实际上只是该`find()`函数的代理（[请参阅文档](http://api20.cakephp.org/class/paginator-component#method-PaginatorComponentpaginate)）。您的第二个参数 ( `'Update'`) 将被视为`find()`调用的条件 - 这会导致 SQL 错误。

您将需要在*一个*`find()`模型上创建一个调用，它会返回您想要的所有数据。您可以使用模型关系和可能的 ContainableBehavior 包含来自其他模型的数据。

 *另一种方法是*两种*不同`find()`的操作并手动组合结果。但是您还必须手动处理分页。*

# c# - 创建 FileInfo - 意外行为

> ID：11434452
> 
> 赞同：0
> 
> 时间：2012-07-11T14:05:32.407
> 
> 标签：c#, io, fileinfo

我正在尝试使用 FileInfo 对象创建一个文件，但我遇到了奇怪的行为。

这是我正在做的事情的要点 -

```
 public void CreateLog()
    {
        FileInfo LogFile = new FileInfo("");

        if (!LogFile.Directory.Exists) { LogFile.Directory.Create(); }
        if (!LogFile.Exists) { LogFile.Create(); }

        if (LogFile.Length == 0)
        {
            using (StreamWriter Writer = LogFile.AppendText())
            {
                Writer.WriteLine("Quotes for " + Instrument.InstrumentID);
                Writer.WriteLine("Time,Bid Size,Bid Price,Ask Price,Ask Size");
            }
        }
    } 
```

但是，当它检查日志文件的长度时，它说该文件不存在（我检查过 - 它确实存在）。

当我用以下内容替换 LogFile.Length 时：

```
 File.ReadAllLines(LogFile.FullName).Length; 
```

然后我得到一个异常，说它无法访问该文件，因为其他东西已经在访问它。

但是，如果我在执行 ReadAllLines 之前执行 Thread.Sleep(500)，那么它似乎工作正常。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:12:29.057

LogFile.Create() 如果你使用这个函数，你可以锁定文件，所以你可以使用 using ，像这样
using(LogFile.Create()){}

之后您可以再次使用该文件

# javascript - 删除两点之间的所有 HTML

> ID：11434456
> 
> 赞同：-1
> 
> 时间：2012-07-11T14:05:39.070
> 
> 标签：javascript, jquery, html, css, web

我想知道如何删除网页中两个字符串之间的所有 HTML。网页并不总是具有相同的内容，因此无论两个字符串是什么以及它们的位置如何，这都必须有效。例如，

```
<div class='foo'>
   <div class='userid'>123</div>
   <div class='content'>
      asdfasdf
   </div>
</div>
<div class=bar>
   <div class='userid'>456</div>
   <div class='content'>
      qwerqwer
   </div>
</div> 
```

如何删除“asdfasdf”和“123”之间的所有 HTML？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-11T14:23:51.587

这很丑陋，但它有效：

```
​var container = $("#cont");
var text = container.html();
var arr = text.split("asdfasdf");
arr[1] = "";
arr = arr.join("");
$("#cont").html(arr); 
```

我添加了一个容器 div。您可以使用 body 标签或其他东西。也可以使用正则表达式。

这是一个工作演示[http://jsfiddle.net/QJSJH/](http://jsfiddle.net/QJSJH/)。

**编辑**

我看到帖子发生了很大变化，但您可以使用与上述相同的概念。

# android - Android 飞入式菜单阴影

> ID：11434457
> 
> 赞同：0
> 
> 时间：2012-07-11T14:05:39.893
> 
> 标签：android, view, android-canvas, shadow

在过去的几天里，我一直在玩弄一些不同的库和代码片段。我正在尝试创建一个类似于在 facebook 应用程序中看到的菜单。现在有很多图书馆和资源可以构建这种东西，但是我在“顶部”和“底部”页面之间绘制阴影以创建“顶部”页面实际上在顶部的错觉时遇到了重大困难. 现在我试图创建的确切效果显示在这篇文章中： [http ://android.cyrilmottier.com/?p=717](http://android.cyrilmottier.com/?p=717)

我从中得到这篇文章的作者的解释不是很透彻。这可能是由于我的编程技能正在开发中，或者我不是唯一一个。我正在使用以下库和示例应用程序进行测试和开发： [https ://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)

如果有人能帮助我让它工作，我会很高兴。

PS：非常抱歉，由于我是新手，所以不能发图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:10:35.390

我所做的是在我的菜单视图（即背后视图）的右侧放置一个阴影，并在您的上方视图右侧放置一个边距：

```
<!-- Show shadow on the right of the menu -->
    <RelativeLayout 
        android:id="@+id/menuShadow"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:focusable="false"
        android:clickable="false"
        android:background="#00000000"
        android:layout_marginRight="40dp">
        <ImageView 
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_alignParentBottom="true"
            android:layout_width="6dp"
            android:layout_height="fill_parent"
            android:background="@layout/border_menu_progressive_shadow"/>
    </RelativeLayout> 
```

使用我的阴影布局：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item>
        <shape>
            <gradient
                android:startColor="#00101010"
                android:endColor="#252525"
                android:angle="0" />
        </shape>
    </item>

</selector> 
```

# ios - 当父视图的 alpha 设置为半透明时，如何强制视图中的元素不透明

> ID：11434458
> 
> 赞同：2
> 
> 时间：2012-07-11T14:05:43.753
> 
> 标签：ios, ios5, interface-builder

我有一个稍微半透明的视图，我将 alpha 设置为大约 0.75，它包含一个按钮作为子元素。我希望按钮完全不透明，我在 IB 中设置了 opaque 属性，但按钮仍然显示为半透明。

任何指针？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:19:59.990

超级视图的子视图总是与其子视图一样透明。

子视图 alpha = 0.5 和父视图 alpha = 0.1 将导致子视图的 alpha 为 0.05。

实现这一点的唯一方法是更改​​视图层次结构。您的子视图不能再是子视图。它可能仍然在同一个位置。（可能需要不同的位置值）。

一个例子。你的背景视图是 backgroundView 你的父视图是 firstView 你的子视图是 overlayView

您当前的层次结构是

```
backgroundView -> firstView -> overlayView 
```

您应该将其更改为：

```
backgroundView -> first View
              \-> overlay View. 
```

如果您的 firstView 的位置是 (10, 10) 并且您的 overlayView 的位置是 (20,20)，那么将您的 overlayView 的位置更改为 (30,30)，因为它现在位于背景视图的坐标系内。

对于您的代码：在某些时候您曾经拥有

```
[backgroundView addSubView:firstView];
[fisrtView addSubView:overlayView]; 
```

将其更改为

```
[backgroundView addSubView:firstView];
[backgroundView addSubView:overlayView]; 
```

如果您没有编写代码而是在 IB 中定义了它，那么只需在视图树中相应地移动 overlayView，使其与 firstView 处于同一级别。

不管你是写代码还是在 IB 中绘制，请确保 firstView 在前，overlayView 在后。否则 firstView 可以在其 alpa 大于 0 时隐藏 overlayView。

# c# - 在 C# 中更新 ListBox 颜色

> ID：11434460
> 
> 赞同：1
> 
> 时间：2012-07-11T14:05:45.470
> 
> 标签：c#, .net, listbox

出于我的目的，我正在 4.0 中编写一个 GUI，它以自定义颜色显示我的自定义`Instance`对象。`ListBox`我已经能够用它们各自的颜色绘制它们，但我想知道是否有办法改变这些颜色。

我已经尝试过每隔几秒钟就清除`ListBox`和读取`Instance`对象的`BackGroundWorker`路线，但是这条路线导致了许多令人头疼的事实，`ListBox.selectedIndex`即将更改并将事件发送给我的`ListBox_SelectedIndexChanged`事件处理程序。因此，如果可能的话，我想避免这种情况，因为尝试使用线程、锁定、竞争条件、打开和关闭事件处理程序、Invalidargumentexceptions 进行编码是一场噩梦。

我想知道，backGroundWorker 有什么方法可以直观地更新我的颜色，`ListBox` **而无需添加和重新添加项目**来触发事件，如此[处](https://stackoverflow.com/questions/9803064/listbox-insert-items-in-color)`DrawItem`所述？

编辑：调用 ListBox.Refresh() 重新绘制列表框中的所有项目，这样做，避免了 selectedIndexChanged 事件处理程序并更新了所有项目的颜色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:11:24.720

如果您有后台工作人员报告进度，那么您可以在进度更改方法中访问列表框中的项目并重新绘制您想要的项目，具体取决于您报告的进度百分比。应该相当简单，除非你有很多物品和很多颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:12:31.857

更改颜色并调用`ListBox.Update()`，或者如果来自不同的线程，`ListBox.Invoke(new MethodInvoker( ()=>ListBox.Update() ))`

# php - 正则表达式将 [ 替换为 -> 取决于条件

> ID：11434465
> 
> 赞同：2
> 
> 时间：2012-07-11T14:05:53.467
> 
> 标签：php, regex

我正在寻找一个可以用“->”替换所有“[”的正则表达式，但前提是它后面没有“]”。

并同时将所有“]”替换为空，但仅当它们不在“[”旁边时

所以换句话说“test[hi][]”将变成“test->hi[]”

谢谢 ;）

我真的不知道该怎么做；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:09:10.097

我已经假设括号之间存在的内容遵循[PHP 变量命名约定](http://php.net/manual/en/language.variables.basics.php)（即字母、数字、下划线）并且您的代码是有效的（例如 no `$test['five]`）。

```
echo preg_replace('/\[[\'"]?(\w+)[\'"]?\]/', '->\1', $input); 
```

这应该处理：

```
test[one]
test['two']
test["three"] 
```

但不是：

```
test[$four] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T14:16:03.067

不需要正则表达式！

```
strtr($str, array('[]'=>'[]','['=>'->',']'=>''))

$ cat 1.php
<?php
echo strtr('[hi][]', array('[]'=>'[]','['=>'->',']'=>''));
$ php 1.php
->hi[] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:09:33.580

这应该做。它用

```
\[     # match a [
(      # match group
[^\]]+ # match everything but a ] one or more times
)      # close match group 
\]     # match ] 
```

匹配括号之间的任何内容

```
$replaced = preg_replace("/\[([^\]]+)\]/", "->$1", $string); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:09:34.743

将此正则表达式替换`\[(\w+)\]`为`->`+ 匹配组 1

# java - Java GUI - 在 JPanel 内部动态更改

> ID：11434466
> 
> 赞同：0
> 
> 时间：2012-07-11T14:05:53.347
> 
> 标签：java, swing, user-interface

试图找出解决以下问题的可能性和困难程度，因为可能会考虑其他替代方案......

如果我有一个整体的 JFrame 框架，我是否可以构造各种不同的 JPanel 及其相关的组件和操作，然后根据用户交互将这些 JPanel 作为 args 传递，以便整个 JFrame/JPanel 的内部发生变化。我假设必须有一些实现可以实现这一点，但是很难找到答案。例如，我构建了一个具有边框布局的 JPanel，并且中心位置会根据用户的操作等改变不同的 JPanel。我认为创建 JPanel 会很简单，然后将其传递给调用整个 Jpanel add(component,borderlayout.center) 方法的方法，该方法会改变显示的内容，但不能像那样工作，并假设必须仅在第一次构建 GUI 时对构造函数起作用..

对不起，长度，但如果有人能指出我正确的方向，我将不胜感激......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:20:42.490

删除和添加组件确实按预期工作。`revalidate()`但是，一旦完成，您需要调用父组件。

如果这不起作用，请发布展示问题的 SSCCE。

# javascript - jQuery 与 Magento 中的原型冲突

> ID：11434468
> 
> 赞同：3
> 
> 时间：2012-07-11T14:05:56.773
> 
> 标签：javascript, jquery, magento, prototypejs

我在 Magento 安装中有这个 jQuery：

```
jQuery(document).ready(function($) {
    "use strict";
    var firstItems = $('.item.first');
    // Find tallest .item per row; match rest of row to it
    firstItems.each(function($) {
        var $first, row, headings, heights, maxHeight;
        $first = $(this);
        row = $first.add($first.nextUntil(firstItems));
        headings = row.find("h2, h5");
        heights = headings.map(function($) {
            return $(this).outerHeight();
        });
        maxHeight = Math.max.apply(null, heights);
        headings.css("height", maxHeight);
    });
}); 
```

可悲的是，它与原型冲突。它抛出错误：

```
[object object] is not a valid argument for 'Function.prototype.apply' 
```

这让我相信冲突来自第 15 行：

```
maxHeight = Math.max.apply(null, heights); 
```

有什么方法可以以不同的方式包装该函数，以便原型忽略它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T14:08:39.050

你是[`.applying`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)一个 jQuery 对象，它应该是一个数组。

```
 heights = headings.map(function($) {
        return $(this).outerHeight();
    }).toArray(); //<-- convert to array 
```

原型库不添加`Function.prototype.apply`，它是本机方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T12:03:57.207

你可以试试 ：

```
 jQuery(function($){
      code_with_$;
 }); 
```

和

```
(function($){
    code_with_$;
})(jQuery); 
```

您还需要在原型之上声明 jQuery。（您可以使用 page.xml 定义 jQuery 在原型上方的位置。）然后使用上述结构使用您的 jQuery 代码，它将解决您的问题。

# asp.net - 如何在 ASP.net 中跟踪调试消息？

> ID：11434473
> 
> 赞同：2
> 
> 时间：2012-07-11T14:06:23.437
> 
> 标签：asp.net, visual-studio-2010

**简短版：**我添加了

```
 <system.web>
   <system.diagnostics>
      <trace>
         <listeners>
            <add name="WebPageTraceListener" type="System.Web.WebPageTraceListener, System.Web, Version=2.0.3600.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
         </listeners>
      </trace>
   </system.diagnostics> 
```

到我网站的**web.config**文件，但 Visual Studio 抱怨：

> 无法识别的配置部分 system.web/system.diagnostics。

我如何让 Visual Studio (2010 (Professional (Windows 7 (64-bit)))) 不抱怨？

* * *

## 背景

Microsoft 解释说，在 ASP.net 中，您使用该`TraceContext.Warn`方法将跟踪信息添加到跟踪输出，例如：

```
Page.Trace.Warn("Starting up - da shield"); 
```

然后[在启用跟踪时启用跟踪](http://msdn.microsoft.com/en-us/library/bb386420.aspx)：

```
<configuration>
  <system.web>
    <trace enabled="true" requestLimit="40" localOnly="false" />
  </system.web>
</configuration> 
```

或者当您启用跟踪时：

```
<%@ Page ... Trace="true" ... %> 
```

然后在页面底部启用跟踪：

![在此处输入图像描述](../Images/257880324b9a6b0f5f2c0e92fe57573d.png)

* * *

## 但是 System.Diagnostics 跟踪呢？

这对 ASP.net 代码很好，但*业务对象*不**`System.Web.UI.TraceContext`**用于跟踪，它们使用`System.Diagnostics.Trace`：

```
System.Diagnostics.Trace.TraceWarning("No giving up General Jar Jar. Yousa tink of someting"); 
```

Microsoft 解释说，您**可以**`Diagnostics`使用以下方式通过跟踪路由跟踪`Web`：

> ## [演练：将 ASP.NET 跟踪与 System.Diagnostics 跟踪集成](http://msdn.microsoft.com/en-us/library/b0ectfxd.aspx)
> 
> **将所有跟踪输出路由到 Web 表单**
> 
> 要将 Trace 消息路由到 ASP.NET 网页，您必须添加一个 WebPageTraceListener 对象。
> 
> 将以下代码放在您的 Web.config 文件中的**<system.web>**部分之后。
> 
> ```
> <system.diagnostics>
>   <trace>
>     <listeners>
>        <add name="WebPageTraceListener" 
>             type="System.Web.WebPageTraceListener, System.Web, Version=2.0.3600.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
>     </listeners>
>   </trace>
> </system.diagnostics> 
> ```

除了 Visual Studio 抱怨：

> 无法识别的配置部分 system.web/system.diagnostics。

比失败更糟糕？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:10:50.513

`<system.diagnostics>`应该是`<configuration>`not的孩子`<system.web>`，所以类似于：

```
<configuration>
...
 <system.diagnostics>
  <trace>
    <listeners>
       <add name="WebPageTraceListener" 
            type="System.Web.WebPageTraceListener, System.Web, Version=2.0.3600.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
    </listeners>
  </trace>
</system.diagnostics>
</configuration> 
```

希望我正确理解了这个问题，这会有所帮助。

# asp.net - SPDispose Ignore 属性未忽略

> ID：11434486
> 
> 赞同：3
> 
> 时间：2012-07-11T14:07:15.187
> 
> 标签：asp.net, sharepoint, sharepoint-2010

在我的 SharePoint 代码中，我有以下行：

`SPWeb web = site.RootWeb; //site is an SPSite object`

当我重建我的项目并在程序集上运行 SPDispose 工具时，我收到以下错误：

* * *

> 模块：Blah.SharePoint.Features.Core.dll 方法：Blah.SharePoint.Features.Core.Helpers.FeatureDeploymentHelper.RemoveWebPartFiles(Microsoft.SharePoint.SPFeatureReceiverProperties,System.String) 声明：web := site.{Microsoft.SharePoint.SPSite }get_RootWeb() 来源：C:\xxx\xxx\Main\Source\SharePoint\Features\Core\Helpers\FeatureDeploymentHelper.cs 行：26
> 
> 注意：未处理的一次性类型：Microsoft.SharePoint.SPWeb
> ***这可能是误报，具体取决于类型的创建方式或是否在当前范围之外处理更多信息：http: [//blogs.msdn.com/ rogerla/archive/2008/02/12/sharepoint-2007-and-wss-3-0-dispose-patterns-by-example.aspx#SPDisposeCheckID_140](http://blogs.msdn.com/rogerla/archive/2008/02/12/sharepoint-2007-and-wss-3-0-dispose-patterns-by-example.aspx#SPDisposeCheckID_140)

* * *

我想要做的是让 SPDispose 工具忽略此错误，因此我已将 SPDisposeCheckIgnore 类和支持枚举提取到我的项目中，并且我已经适当地修饰了我的方法：

```
[SPDisposeCheckIgnore(SPDisposeCheckID.SPDisposeCheckID_140, "RootWeb does not need disposed.")]

public static void RemoveWebPartFiles(SPFeatureReceiverProperties properties, string assemblyName)
{ 
...
} 
```

完成所有这些操作后，我仍然收到错误消息。任何人都知道我可能会如何摆脱这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T03:48:48.110

这里需要做两件事。

1) SPDisposeCheckIgnore 类必须在 SPDisposeCheck 命名空间中定义。您不能拥有自己的命名空间。请参阅此页面上的相关评论：http: [//archive.msdn.microsoft.com/SPDisposeCheck/](http://archive.msdn.microsoft.com/SPDisposeCheck/)

2) 您在 RunWithElevatedPrivileges 中尝试忽略的任何内容都必须拉入外部方法，否则将无法识别。在上面的示例中没有这样做，但在其他地方正在这样做。

必须遵循这两个规则才能忽略工作。希望这可以帮助其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T17:38:21.917

仔细检查您如何检索和分配`RootWeb`对象。如果它是在外部方法中完成的，则`DisposeChecker`可能不会发现它是一个`RootWeb`参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T16:29:46.907

我看不出你写的有什么问题。我将根 web 提取到一个静态方法中，所以我只需要在一个地方忽略这个错误，[它就可以在匿名委托中工作](http://www.novolocus.com/2011/06/01/practical-spdisposecheck-namespaces-delegates-and-rootwebs/)。以下对我有用：

```
public class DisposeUtils
{

    [SPDisposeCheckIgnore(SPDisposeCheckID.SPDisposeCheckID_140, "RootWeb does not need disposed. http://blogs.msdn.com/b/rogerla/archive/2009/11/30/sharepoint-2007-2010-do-not-dispose-guidance-spdisposecheck.aspx")]
    public static SPWeb GetRootWeb(SPSite site)
    {
        return site.RootWeb;
    }
} 
```

抱歉，我不确定这是否真的有帮助 - 我是说你的代码应该可以工作。您是否检查过 SPDisposeCheck 以了解它如何处理“已记录”和“未记录”错误？（我从来没有完全清楚这些设置的作用）

# windows - 从 Windows 7 Resource Kit 中搜索 srvany.exe：这是真正的软件还是只是一本书？

> ID：11434490
> 
> 赞同：10
> 
> 时间：2012-07-11T14:07:32.877
> 
> 标签：windows, service

我正在寻找Windows 7 支持的*Windows Resource Kit*版本。但我很难找到下载位置或有关从何处获取该软件的任何信息（例如操作系统或IDE 的安装CD）。

在 Google 上搜索“windows 7 资源工具包”时，我从 Microsoft Press 获得了很多关于这本书的结果：

[http://www.microsoft.com/learning/en/us/book.aspx?id=13811](http://www.microsoft.com/learning/en/us/book.aspx?id=13811)

我需要购买这本书才能使用该软件还是有其他方法？我只需要资源工具包中的一个可执行文件*srvany.exe*。我想知道，这个软件真的存在吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-06T12:21:14.023

srvany.exe 位于 Windows 2003 资源工具包工具中。这个页面说它可以在 Windows 7 上运行。

[http://www.technlg.net/windows/download-windows-resource-kit-tools/](http://www.technlg.net/windows/download-windows-resource-kit-tools/)

您可能还想在“环境变量”选项中将“;C:\Program Files\Windows Resource Kits\Tools”或“;C:\Program Files\Windows Resource Kits (x84)\Tools”添加到您的路径中以使用它命令提示符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-13T20:57:34.803

只要您假装使用像 Windows 7 这样的旧程序**，**`srvany`您就必须了解它可能存在的缺点：

[现代 Windows 中的 SrvAny 缺点](http://www.coretechnologies.com/products/AlwaysUp/srvany.html)（摘自 AlwaysUp 常见问题解答，因此他们试图向您推销他们的产品 ;-)）。

我认为有更好的选择：

1.-`SC`命令 ( `sc create MyService`)。
2.- （不是免费的，但让事情变得更容易）[AlwaysUp](http://www.coretechnologies.com/products/AlwaysUp/)工具，它添加了多种功能（如日志、统计、检查和重新启动服务、电子邮件警报......等）。只要是有[命令行管理的](http://www.coretechnologies.com/products/AlwaysUp/AlwaysUpCLT/)，我觉得这里引用比较合适。

EDIT-1：AlwaysUp 常见问题解答应该有一些过时，即：它报告 SrvAny 不适用于 Windows7/8（感谢@shelleybutterfly）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T10:08:56.960

[您可以在此处http://www.microsoft.com/en-us/download/details.aspx?id=7887](http://www.microsoft.com/en-us/download/details.aspx?id=7887)找到“带有 Service Pack 1 (SP1) 的 Windows 7 远程服务器管理工​​具”

# objective-c - Mac Kiosk Mode API - 防止用户退出

> ID：11434497
> 
> 赞同：4
> 
> 时间：2012-07-11T14:08:01.227
> 
> 标签：objective-c, macos, keyboard-shortcuts, fullscreen, kiosk-mode

我正在编写一个 Mac (10.6 / 10.7) 应用程序，该应用程序在允许用户访问计算机之前针对 Active Directory 域对用户进行身份验证（我被告知我不能允许用户通过传统登录服务登录）。我有验证码，现在正试图让这个登录窗口全屏并且无法关闭。

Apple 的 Kiosk Mode API（[此处的文档](http://developer.apple.com/library/mac/#technotes/KioskMode/Introduction/Introduction.html)）似乎非常适合此操作，我已经使用它来全屏显示窗口、禁用停靠/菜单栏/强制退出等，所有这些都可以正常工作。我遇到的问题是我似乎无法阻止用户简单地使用 CMD+Q 退出应用程序。

当用户可以退出它时，具有限制的信息亭模式应用程序没有意义，所以我假设我错过了一些东西。下面是我正在做的一个例子：

```
NSApplicationPresentationOptions options = 
NSApplicationPresentationHideMenuBar|NSApplicationPresentationHideDock|
NSApplicationPresentationDisableHideApplication|
NSApplicationPresentationDisableProcessSwitching|
NSApplicationPresentationDisableAppleMenu| NSApplicationPresentationDisableForceQuit;

[NSApp setPresentationOptions:options];
[[_window contentView] enterFullScreenMode:[NSScreen mainScreen] withOptions:nil]; 
```

结果：全屏窗口，没有菜单栏，没有停靠，不能强制退出，也不能 CMD+Tab 离开屏幕。CMD+Q 仍然退出应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-14T20:48:32.057

我猜他找到了与我相同的解决方案，但由于这里实际上没有回答，我想我会详细说明。

您需要做的是实现以下 NSApplicationDelegate 方法：

```
- (NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication *)sender 
```

当您的应用处于 Kiosk 模式时，然后在此处返回 NSTerminateCancel。

# sql - 如何使用另一个表数据 TSQL 更新一个列数据

> ID：11434498
> 
> 赞同：5
> 
> 时间：2012-07-11T14:08:08.113
> 
> 标签：sql, sql-server, database, tsql, sql-update

我刚刚意识到我一直在为表中的一列捕获错误的数据。我已经解决了这个问题，但是，到目前为止我捕获的数据仍然不正确。

让我们命名我的表`TableIWantToCorrect`和`TableWithIDs`

在`TableIWantToCorrect`，我有一个外键`TableWithIDs`。这是不正确的。

我可以通过将 in`TableIWantToCorrect`列的子字符串与`TableWithIDs`.

所以目前，我有

**表IWantToCorrect**

```
Name            ForeignKey
123-abc-123        15
456-def-456        15
789-ghi-789        15 
```

**带 ID 的表**

```
CompareName    id
abc            1
def            2
ghi            3 
```

`TableIWantToCorrect`因此，当名称中的子字符串等于比较名称中的子字符串时，我想更新以具有正确的 ForeignKey 值。子字符串的位置始终相同，因此我可以使用该`Substring`方法。

我的尝试：

```
Update TableIWantToCorrect
SET ForeignKey =
       (SELECT id 
        FROM TableWithIDs 
        WHERE UPPER(CompareName) = UPPER((SUBSTRING(TableIWantToCorrect.Name, 4, 3))) 
```

结果 ：

> 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。该语句已终止。

我知道我做了一些愚蠢的事情。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-11T14:14:31.087

该错误是因为您的子查询为`UPDATE`. 要解决此问题，您可以`JOIN`使用`UPDATE`

```
UPDATE t1
SET ForeignKey = t2.id
FROM TableIWantToCorrect t1
INNER JOIN TableWithIDs t2
    ON UPPER(t2.CompareName) = UPPER(SUBSTRING(t1.Name, 4, 3)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:14:30.510

```
 Update TableIWantToCorrect
 SET ForeignKey =  s.id
 FROM TableIWantToCorrect , TableWithIDs as s
 WHERE UPPER(s.CompareName) = UPPER( (SUBSTRING(TableIWantToCorrect.Name, 4, 3)) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-06-24T05:44:40.860

```
--CREATE FUNCTION dbo.ufn_FindReports 
--(@InEmpID INTEGER)
--RETURNS @retFindReports TABLE 
--(
--    EmployeeID int primary key NOT NULL,
--    FirstName nvarchar(255) NOT NULL,
--    LastName nvarchar(255) NOT NULL,
--    JobTitle nvarchar(50) NOT NULL

--)
----Returns a result set that lists all the employees who report to the 
----specific employee directly or indirectly.*/
--AS
--BEGIN
--WITH EMP_cte(EmployeeID, OrganizationNode, FirstName, LastName, JobTitle, RecursionLevel) -- CTE name and columns
--    AS (
--        SELECT e.EmployeeID, e.ManagerID, p.FirstName, p.LastName, P.JobTitle, 0 -- Get the initial list of Employees for Manager n
--        FROM HumanResources.Employee e 
--INNER JOIN Person.Person p 
--ON p.Employeeid = e.EmployeeID
--        WHERE e.EmployeeID = @InEmpID
--        UNION ALL
--        SELECT e.EmployeeID, e.ManagerID, p.FirstName, p.LastName, P.JobTitle, RecursionLevel + 1 -- Join recursive member to anchor
--        FROM HumanResources.Employee e 
--            INNER JOIN EMP_cte
--            ON e.ORGANIZATIONNODE.GetAncestor(1) = EMP_cte.OrganizationNode
--INNER JOIN Person.Person p 
--ON p.Employeeid= e.EmployeeID
--        )
---- copy the required columns to the result of the function 
--   INSERT @retFindReports
--   SELECT EmployeeID, FirstName, LastName, JobTitle, RecursionLevel
--   FROM EMP_cte 
--   RETURN
--END;
--GO

> 
```

# crystal-reports - 如何在 WiX 中检查 Crystal Reports for .NET Framework 4.0 安装

> ID：11434499
> 
> 赞同：2
> 
> 时间：2012-07-11T14:08:14.033
> 
> 标签：crystal-reports, wix, installation, report

我正在创建一个 WiX 安装程序，需要检查是否安装了特定版本的 Crystal Reports for .NET Framework 4.0 (v. 13.0.3)。

我发现了两种似乎都可以工作的方法（在我的 W7 机器上），但不确定其中一种是否有任何缺点，例如在 XP 上工作等。

选项 1（我对此选项的担忧是，如果安装了具有不同产品代码的更高版本，则此条件不会通过）：

```
<Property Id="CRVSINSTALLED">
  <RegistrySearch Id="CRVSInstalledSearch" Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Uninstall\{AAD476D7-FC64-40BC-85EA-0C1FD98D8375}" Name="InstallDate" Type="raw" />
</Property>
<Condition Message="You don't have Crystal Reports for Visual Studio 2010 (v. 13.0.3)  installed.">
  <![CDATA[CRVSINSTALLED]]>
</Condition> 
```

选项 2：

```
<Property Id="CRVSINSTALLED2">
  <RegistrySearch Id="CRVSInstalledSearch2" Root="HKLM" Key="Software\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports" Name="CRRuntime32Version" Type="raw" />
</Property>
<Condition Message="You don't have Crystal Reports for Visual Studio 2010 (v. 13.0.3)  installed 2.">
  <![CDATA[CRVSINSTALLED2 >= "13.0.3"]]>
</Condition> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T18:23:20.293

我喜欢 option2，因为我个人不喜欢依赖*HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall*中的注册表项。第三种选择是[在安装过程中检查文件的版本号](http://wix.sourceforge.net/manual-wix3/check_the_version_number.htm)。

# asp.net - 是否可以从 WebMethod 返回 html 表？

> ID：11434500
> 
> 赞同：2
> 
> 时间：2012-07-11T14:08:14.453
> 
> 标签：asp.net, html, vb.net

使用 WebMethod，我获得了创建 HTML 表并填充它所需的值。完成后，我需要显示表格。

是否可以 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:25:33.050

Web 服务可以返回 HTML 表格吗？是的。*你应该*那样做吗？可能不是。请考虑“分离关注点”，以便服务仅负责返回数据。然后数据的消费者可以根据需要对其进行格式化。一种可能的实现是让服务返回 XML，并让“演示者”使用 XSLT 将其转换为所需的表。从长远来看，代码会更容易维护和理解。（相信我；我见过一个项目，它有 2,500 多行字符串连接，构建了一个 HTML 字符串。不好玩！）作为额外的奖励，Web 服务的响应会小得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:11:22.567

您可以从 WebMethod 返回一个字符串，这意味着您可以返回一个表示 html 的字符串...然后渲染该字符串（处理所需的编码）我不能再多说什么了...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:12:20.567

在变量中创建标记并执行`Response.Write`.

```
StringBuilder strHtml=new StringBuilder();
strHtml.Append("<table>");
strHtml.Append("<tr><th>Name</th></tr>");
strHtml.Append("<tr><td>Jon</td></tr>");
strHtml.Append("<tr><td>Marc</td></tr>");
strHtml.Append("<tr><td>Jared</td></tr>");
strHtml.Append("</table>");
Response.Write(strHtml.ToString()); 
```

# c++ - Visual C++ 数组大小崩溃

> ID：11434501
> 
> 赞同：1
> 
> 时间：2012-07-11T14:08:28.447
> 
> 标签：c++, arrays, visual-c++, crash, stack

> **可能重复：**
> [堆栈溢出可视 C++，可能是数组大小？](https://stackoverflow.com/questions/10536479/stack-overflow-visual-c-potentially-array-size)

此代码仅用于将二进制文件中的值读取到数组 DataBuffer 中。当 DataBuffer 的大小大于等于 515000 时，它就简单地崩溃了。我正在 Windows 7 上的 Visual C++ 2010 中开发它。函数 cbFileRead() 是我无法访问其源代码的东西。cbFileRead() 期望 DataBuffer 的类型为 USHORT*。

```
#include <stdio.h>  // printf()
#include "cbw.h"    // cbFileRead()

int main(int argc, char* argv[]) {

    // Declarations
    char* FileName = argv[1];
    long FirstPoint = 0;
    long NumPoints;

    // Set data collection sizes
    const long chunkSize = 515000;
    NumPoints = chunkSize; // Number of points to be read into mem
    WORD DataBuffer[chunkSize-1];

    // Get data
    cbFileRead(FileName, FirstPoint, &NumPoints, DataBuffer);

    printf("Completed on data point %d whose value is %d\n", NumPoints, DataBuffer[chunkSize-1]);

    return 0;
} 
```

这次崩溃的原因是什么？我希望数组大小能够更高。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:12:52.147

`printf()`超出了数组的末尾，`DataBuffer`因为它有`chunksize - 1`元素，所以最后一个元素是`chunksize - 1 - 1`。该函数`cbFileRead()`（可能）也被错误地告知了元素的数量`DataBuffer`。

编辑：

**正如其他人已经声明**的那样，默认堆栈大小为 1MB。`DataBuffer`数组的大小`2 * 515000`等于`1030000`，这会在堆栈上留下`18576`空闲字节。`cbFileRead()`可以很容易地在堆栈上声明一个大缓冲区以从文件中读取。正如其他人所建议的那样，`DataBuffer`在堆上分配使用`new[]`（和`delete[]`释放）或使用`vector<WORD>`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:14:02.937

> 链接器使用的默认堆栈保留大小为 1 MB。要为所有线程和纤程指定不同的默认堆栈保留大小，请使用模块定义 (.def) 文件中的 STACKSIZE 语句。

[Microsoft 开发中心 - 线程堆栈大小](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686774%28v=vs.85%29.aspx)

`new`或者您可以使用关键字动态分配内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:13:00.257

您的堆栈大小可能不足以处理该大小的本地数据（假设这就是您所说的“崩溃”）：

```
// use dynamic allocation instead of stack local
WORD *DataBuffer = new WORD[chunkSize];

cbFileRead(FileName, FirstPoint, &NumPoints, DataBuffer);

// ...use DataBuffer...

// deallocate DataBuffer when done
delete[] DataBuffer; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T14:18:41.233

在包括 Windows 在内的大多数平台上，局部变量存储在一个堆栈中，该堆栈的大小有限——在这种情况下，它看起来大约为 1MB。如果您确实需要，可能有一种方法可以增加该大小，但最好动态分配大型数组：

```
#include <vector>

std::vector<WORD> DataBuffer(chunkSize); // guessing that "chunkSize-1" was an error

cbFileRead(FileName, FirstPoint, &NumPoints, &DataBuffer[0]);

printf("Completed on data point %d whose value is %d\n", 
       NumPoints, DataBuffer[chunkSize-1]); 
```

请注意，如果数组大小实际上应该是`chunkSize-1`，那么最后一个元素将是`DataBuffer[chunkSize-2]`，因为数组是从零开始索引的。

# facebook - Facebook 登录按钮消失了

> ID：11434505
> 
> 赞同：3
> 
> 时间：2012-07-11T14:08:32.100
> 
> 标签：facebook, login

我已按照 Facebook 文档在页面上放置了登录按钮。直到最近一切正常。在我没有任何代码更改的情况下，按钮现在表现出一种奇怪的行为：

（**问题 #1**）如果我已经登录 Facebook（有 facebook auth cookie），那么当我访问我的网站时，即使我指定了自定义标签，按钮也只会显示“登录”。它应该显示“使用 Facebook 登录”。

（**问题 #2**）如果我没有登录 Facebook，那么当我访问我的网站时，fb 登录按钮根本不存在。

这是我拥有的代码：

我已将**xmlns:fb="http://ogp.me/ns/fb#"**和**xmlns:og="http://ogp.me/ns#"**作为我的主**html**节点的属性。

然后我有：

```
<div class="fb-login-container">
  <fb:login-button scope="email" size="medium" onlogin="CheckFBAccount();">Login with Facebook</fb:login-button>
</div>
<script type="text/javascript" src="//connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript" language="javascript">
    $(window).load(function ()
    {
        window.FB.init({ appId: XXXXXXXXXXX, status: true, cookie: true, xfbml: true, oauth: true });
    });
</script> 
```

请注意，这里我正在同步加载 FB API。我尝试用这样的异步调用替换上面的脚本代码：

```
window.fbAsyncInit = function ()
{
   FB.init({
      appId: XXXXXXXXXXXX,
      status: true,
      cookie: true,
      xfbml: true
   });
};
(function (d)
{
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) { return; }
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = "//connect.facebook.net/en_US/all.js";
   ref.parentNode.insertBefore(js, ref);
} (document)); 
```

这解决了按钮根本不显示的问题（**问题 #2**已解决），但如果我在系统上已经有 FB auth cookie，那么它仍然会忽略我的自定义标签（**问题 #1**仍然存在）。

我正在浏览论坛和文档，试图找出发生了什么变化，但还没有找到任何东西。显然 FB 再次改变了一些东西（或者可能是他们引入的一个错误）。任何帮助将非常感激。

**注意：只要按钮在页面上可见（带有 of 没有我的自定义标签），单击和身份验证行为就可以了。问题再次是按钮根本没有显示或忽略我的自定义标签。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T16:38:40.950

我认为您需要异步加载 FB 库**并**滚动您自己的自定义 FB 登录按钮。

这是我从德国网站修改的一些代码 - [http://daily.siebler.eu/2011/04/facebook-like-button-asynchronous-loading-with-jquery/](http://daily.siebler.eu/2011/04/facebook-like-button-asynchronous-loading-with-jquery/)

如果您已经在加载 jQuery，这是一个更简洁的解决方案，可让您将初始化代码保存在 $(window).load 中

```
<div id="fb-root"></div>
<script type="text/javascript">
   $(window).load(function ()
   {
      // Save the cache so we can restore it later
      var cache = jQuery.ajaxSettings.cache;
      jQuery.ajaxSettings.cache = true;

      // Load FB library asynchronously
      // 'en_US' is hard coded, but you could render out a variable
      // that contains the correct FB locale code for localized pages
      jQuery.getScript('//connect.facebook.net/en_US/all.js', function ()
      {
         window.FB.init({ appId: XXXXXXXXXXX, status: true, cookie: true, xfbml: true, oauth: true });

         // Wire up any additional FB events; for example, here's how
         // to listen for FB "Like" events
         window.FB.Event.subscribe("edge.create", function (response)
         {
             // Do something interesting
         });

      });

      // Restore the jQuery cache
      jQuery.ajaxSettings.cache = cache;

      // Wire up the click event for your custom FB login button
      $("#idFacebookLoginBtn").on("click", function (e)
      {
         e.preventDefault();
         window.FB.login(function () { CheckFBAccount(); }, { scope: 'email' });
         return false;
      });

   });

</script> 
```

接下来，您需要制作自己的按钮，可能是这样的：

```
<div id="idFacebookLoginBtn" class="facebook-login-btn" >Login with Facebook</div> 
```

# emacs - Can org-mode export all files in a directory?

> ID：11434510
> 
> 赞同：3
> 
> 时间：2012-07-11T14:08:48.247
> 
> 标签：emacs, org-mode

If I tweak the latex/css style file used by org-mode, is there a way to re-export all the org files in a directory?

I have previously manually exported all the files.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T21:36:30.453

可以从这个版本开始。有不便之处：它会污染杀死环并访问所有组织文件。

```
(defun publish-dir-org ()
  "Publish all org files in a directory"
  (interactive)
  (save-excursion
    (mapc
     (lambda (file)
       (with-current-buffer
       (find-file-noselect file)
     (org-export-as-html-batch)))
       (file-expand-wildcards  "*.org")))) 
```

# c - 在 GTK+ 中将标签设为粗体

> ID：11434512
> 
> 赞同：8
> 
> 时间：2012-07-11T14:09:02.287
> 
> 标签：c, gtk

我只是想让文本在`GtkLabel`. 我能找到的只是 Python 和 C# 的示例。这是我目前设置`GtkLabel`s 的方式，但我不知道如何让它们以粗体呈现文本。

```
GtkWidget* label = gtk_label_new("Text I want to be bold"); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-11T14:16:03.780

一个简单的方法是调用[gtk_label_set_markup()](https://developer.gnome.org/gtk3/stable/GtkLabel.html#gtk-label-set-markup)，它接受一个[Pango 标记](https://developer.gnome.org/pango/stable/pango-Markup.html#pango-Markup.description)字符串：

```
GtkWidget *label = gtk_label_new(NULL);
gtk_label_set_markup(GTK_LABEL(label), "<b>Text to be bold</b>"); 
```

# python - Python subprocess with stdout redirect returning an int

> ID：11434515
> 
> 赞同：5
> 
> 时间：2012-07-11T14:09:23.377
> 
> 标签：python, subprocess, stdout, communicate

I am trying to read out data from a set of print statements in a C++ program that is being run using a subprocess.

C++ code:

```
printf "height= %.15f \\ntilt = %.15f \(%.15f\)\\ncen_volume= %.15f\\nr_volume= %.15f\\n", height, abs(sin(tilt*pi/180)*ring_OR), abs(tilt), c_vol, r_vol; e; //e acts like a print 
```

Python code:

```
run = subprocess.call('Name', stdout = subprocess.PIPE, env={'LANG':'C++'})
data, error = run.communicate() 
```

However instead of getting the data, all I am getting is a single int, the exit code, either a 0 or an error code. Of course, python then tells me "AttributeError: 'int' object has no attribute 'communicate'".

How do I actually get the data (the printf)?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:12:58.660

[subprocess.call](http://docs.python.org/library/subprocess.html#subprocess.call)只是运行命令并返回其退出状态（在 python 中，退出状态可以通过`sys.exit(N)`-- 在其他语言中，退出状态由不同的方式确定）。如果你想真正掌握这个过程，你需要使用`subprocess.Popen`. 因此，对于您的示例：

```
run = subprocess.Popen('Name', stdout = subprocess.PIPE, env={'LANG':'C++'})
data, error = run.communicate() 
```

程序退出状态现在可通过该`returncode`属性获得。

另外，作为风格问题，我会这样做：

```
run = subprocess.Popen('Name', stdout = subprocess.PIPE, stderr = subprocess.PIPE, env={'LANG':'C++'})
data, error = run.communicate() 
```

或者：

```
run = subprocess.Popen('Name', stdout = subprocess.PIPE, env={'LANG':'C++'})
data, _ = run.communicate() 
```

既然你没有给自己捕获标准错误的能力，你可能不应该假装你有一些有意义的东西。

# jsf-2 - not rendering image

> ID：11434517
> 
> 赞同：3
> 
> 时间：2012-07-11T14:09:27.917
> 
> 标签：jsf-2, primefaces

I have a JSF page where I want to show a image. The image is stored in the database as a blob. The entity looks like this:

```
@Entity
public class Player
{
    @Id
    @GeneratedValue(strategy = GenerationType.TABLE)
    private Long            id;
    @Lob
    private byte[]          pictureData;
    @Transient
    private StreamedContent streamedPicture;

    public StreamedContent getStreamedPicture()
    {
        if (streamedPicture == null && pictureData != null)
        {
            try
            {
                ByteArrayOutputStream os = new ByteArrayOutputStream();
                os.write(pictureData);
                streamedPicture = new DefaultStreamedContent(
                                                    new ByteArrayInputStream(
                                                                                os.toByteArray()),
                                                    "image/png");
            }
            catch (FileNotFoundException e)
            {}
            catch (IOException e)
            {}
        }
        return streamedPicture;
    }
} 
```

The JSF page is this:

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">

<h:head></h:head>
<body>
    <ui:repeat var="player" value="#{playerbean.cachedPlayers}">
        <h:outputText value="#{player.id}" />
        <p:graphicImage value="#{player.streamedPicture}" rendered="#{player.streamedPicture != null}"/>
    </ui:repeat>
</body>
</html> 
```

And the bean I call looks like this:

```
@ManagedBean(name = "playerbean")
@SessionScoped
public class PlayerBean
        implements Serializable
{
    @EJB
    private PlayerManager   playerManager;
    private List<Player>    cachedPlayers;

    public List<Player> getCachedPlayers()
    {
        if (cachedPlayers == null)
        {
            cachedPlayers = playerManager.getAll();
        }
        return cachedPlayers;
    }
} 
```

While debugging I set a breakpoint in `PrimeResourceHandler` in the method `handleResourceRequest()`. The code of the `PrimeResourceHandler` I'm looking at contains this:

```
try {
    String dynamicContentEL = (String) session.get(dynamicContentId);
    ELContext eLContext = context.getELContext();
    ValueExpression ve = context.getApplication().getExpressionFactory().createValueExpression(context.getELContext(), dynamicContentEL, StreamedContent.class);
    StreamedContent content = (StreamedContent) ve.getValue(eLContext);
    HttpServletResponse response = (HttpServletResponse) context.getExternalContext().getResponse();

    response.setContentType(content.getContentType());

    byte[] buffer = new byte[2048];

    int length;
    InputStream inputStream = content.getStream();
    while ((length = (inputStream.read(buffer))) >= 0) {
        response.getOutputStream().write(buffer, 0, length);
    }

    response.setStatus(200);
    response.getOutputStream().flush();
    context.responseComplete();

} catch(Exception e) {
    logger.log(Level.SEVERE, "Error in streaming dynamic resource.");
} finally {
    session.remove(dynamicContentId);
} 
```

When passing the line `StreamedContent content = (StreamedContent) ve.getValue(eLContext);` `content` appears to be null. This of course causes a NullPointerException. However in the JSF page I told the element not to render if the value is null.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:59:22.090

`<p:graphicImage>`组件不能具有`value`指向 SessionScoped bean 中的托管属性的属性。该值必须设置为 RequestScoped bean。

这是因为`image/jpeg`内容类型 HTTP 响应的 HTTP 请求本质上是无状态的。浏览器将对 JSF 页面内容发出初始请求，然后对于`<img>`呈现的每个 HTML 标记，它将对每个`<img>`标记的动态生成的 url 发出单独的请求以获取这些内容。在有状态的上下文中获取图像并没有真正的意义。

# jsp - struts 2 for 循环

> ID：11434526
> 
> 赞同：0
> 
> 时间：2012-07-11T14:10:04.463
> 
> 标签：jsp, struts2, tags, iterator

我想像这样循环一段代码

```
<s:iterator value="#session.count">
        <TD WIDTH='10%' BGCOLOR='#000080'>&nbsp;</TD>
    </s:iterator> 
```

基于存储在会话中的值“计数”，我需要多次添加标签，但它没有按预期循环。

我想知道的是数组或集合对象。但是如何在 JSP 中使用 Struts 2 标记循环代码 N 时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T20:33:18.777

对于一个简单的 for 循环，使用`begin`and`end`属性：

```
<s:iterator begin="0" end="%{#session.count}">
  <td width='10%' bgcolor='#000080'>&nbsp;</td>
</s:iterator> 
```

[*我也会更好地使用 CSS。*]

请参阅[迭代器标签文档](http://struts.apache.org/2.x/docs/iterator.html)。

* * *

现在您提到您使用的是非常旧的 S2 版本。在这种情况下，使用[JSTL 的`c:forEach`tag](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/forEach.html)，没有理由使用 S2 标记。它具有相同的开始/结束语义，并且仍然比创建一个无用的列表更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:24:38.003

您可以[在此处](http://struts.apache.org/2.x/docs/iterator-tag-examples.html)和[此处](http://struts.apache.org/2.x/docs/iterator.html)`iterator`查看示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T15:47:31.520

似乎很容易。

用这个：

```
<s:subset source="your_source" count="#session.count">
    <s:iterator>
        <td>test</td>
    </s:iterator>
</s:subset> 
```

# php - PHP Optimization / using getters and setters with type safety

> ID：11434527
> 
> 赞同：1
> 
> 时间：2012-07-11T14:10:05.607
> 
> 标签：php

I'm going to be working on a project here shortly that will require fast response times and next to no latency. It will be a SOAP server built in PHP (preferably).

I was doing my research on optimization tips and found that Google said using getters and setters more than doubles execution size. I was floored because I use them all the time to enforce type safety.

My question to you, SO, is:

Should I care about types at all? Should I give up on PHP and go to something like Java (yuck)? I'm looking for guidance on the general rule of thumb when it comes to type safety in PHP while keeping optimization in mind.

I do realize, the actual noticeable time for a normal application (especially a small SOAP server) won't be noticeable at all, and the required calls would have to be massive, greater than that of a normal PHP application. With that being said, I still want clarification on the best practices.

Thanks in advance! Kyle

# php - PHP long integers for thrift

> ID：11434530
> 
> 赞同：9
> 
> 时间：2012-07-11T14:10:15.353
> 
> 标签：php, long-integer, thrift

My Thrift service expects to receive a Long integer representing a timestamp in milliseconds, but coming from PHP, I know PHP thrift is supposed to automagically turn my PHP types into thrift types, but which PHP type does it expect for Long integers? I think my computer is 64-bit, but since I think that PHP integers' length is platform dependent, I don't really want to depend upon a platform-dependent length for my integers.

I am currently grabbing microtime() and multiplying by 1000, then converting to integer. Is this the "correct" way to work with PHP & thrift long ints?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T15:47:51.447

你说的对，

> 整数的大小取决于平台，尽管通常值约为 20 亿的最大值（即 32 位有符号）。64 位平台的最大值通常约为 9E18。PHP 不支持无符号整数。自 PHP 4.4.0 和 PHP 5.0.5 起，可以使用常量 PHP_INT_SIZE 确定整数大小，使用常量 PHP_INT_MAX 确定最大值。

[http://www.php.net/manual/en/language.types.integer.php](http://www.php.net/manual/en/language.types.integer.php)

如果使用`microtime()`，则无需将其除以 1000。它的浮点数，您可能需要将其乘以 1000。

您可以使用[BC Math](http://php.net/manual/en/ref.bc.php)使用字符串类型将其计算为数字。我猜字符串可以与任何其他事物进行通信。

如果乘以 1000，您甚至不需要`BCMath`. `microtime(true)`只需从（或空格`microtime`）的字符串表示中删除逗号

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T14:17:11.207

也许你应该像 twitter 一样使用字符串类型的 id：[https ://dev.twitter.com/docs/twitter-ids-json-and-snowflake](https://dev.twitter.com/docs/twitter-ids-json-and-snowflake)

# struts2 - Struts 2 + Shiro, how to?

> ID：11434531
> 
> 赞同：1
> 
> 时间：2012-07-11T14:10:20.097
> 
> 标签：struts2, shiro

I would like to add security to Struts 2 application. I chose Apache Shiro. Can you give me some useful tips? I've started the integration according to web integration on shiro's site but at the moment it doesn't work.

I added to my web.xml

```
<filter>
    <filter-name>ShiroFilter</filter-name>
    <filter-class>org.apache.shiro.web.servlet.ShiroFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>ShiroFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>INCLUDE</dispatcher>
    <dispatcher>ERROR</dispatcher>
</filter-mapping> 
```

and

```
<listener>
    <listener-class>org.apache.shiro.web.env.EnvironmentLoaderListener</listener-class>
</listener> 
```

I've created shiro interceptor.

```
public class ShiroInterceptor extends AbstractInterceptor {
    public String intercept(ActionInvocation actionInvocation) throws Exception {
        Subject shiroUser = SecurityUtils.getSubject();
        actionInvocation.getStack().setValue("shiroUser", shiroUser);
        return actionInvocation.invoke();
    }
} 
```

I've added shiro.ini

```
[main]

#authc = org.apache.shiro.web.filter.authc.PassThruAuthenticationFilter
authc.loginUrl = /login.jsp
authc.usernameParam = login
authc.passwordParam = password
authc.successUrl  = /some.jsp
roles.unauthorizedUrl = /error.jsp

myRealm = travel_click.logic.manager.security.MyRealm
securityManager.realms = $myRealm

[urls]
/**=authc 
```

I wrote MyRealm class.

What else should i do?

# qt - Commonqt Not Working Using Clozure CL on OS X Lion

> ID：11434533
> 
> 赞同：3
> 
> 时间：2012-07-11T14:10:40.797
> 
> 标签：qt, osx-lion, common-lisp, ccl, quicklisp

I wanted to use Commonqt using Clozure CL on OS X Lion.

But it was not working...

## Commonqt

> Commonqt is a Common Lisp binding to the smoke library for Qt.
> 
> [http://common-lisp.net/project/commonqt/](http://common-lisp.net/project/commonqt/)

## My setting is that

> OS X Lion 10.7.4
> 
> Xcode 4.3.3
> 
> Clozure CL version 1.8
> 
> qt 4.8.2 (git clone git://gitorious.org/qt/qt.git) "./configure && make install && make"
> 
> smoke
> 
> *   somkegen (git clone git://anongit.kde.org/smokegen) "cmake . && make install"
> *   smokeqt (git clone git://anongit.kde.org/smokeqt) "cmake . && make install"
> 
> quicklisp
> 
> *   local-projects commonqt (git clone git://gitorious.org/commonqt/commonqt.git) "qmake && make clean && make"
> 
> cf: [http://kvardek-du.kerno.org/2011/12/setting-up-commonqt-on-osx.html](http://kvardek-du.kerno.org/2011/12/setting-up-commonqt-on-osx.html)

## qt.asd(in Commonqt)

```
(defmethod output-files ((operation compile-op) (c cpp->so))   (values
    (loop for filename in '("libcommonqt.so" "libcommonqt.so.1"
                            "libcommonqt.so.1.0" "libcommonqt.so.1.0.0")
          collect (merge-pathnames filename (component-pathname c)))
    ;; libcommonqt.so* files are never moved to separate FASL directory
    t)) 
```

so I was changed (so -> dylib) that

```
(defmethod output-files ((operation compile-op) (c cpp->so))   (values
    (loop for filename in '("libcommonqt.dylib" "libcommonqt.1.dylib"
                            "libcommonqt.1.0.dylib" "libcommonqt.1.0.0.dylib")
          collect (merge-pathnames filename (component-pathname c)))
    ;; libcommonqt.so* files are never moved to separate FASL directory
    t)) 
```

But Error has Occurred. For example

Source code

[http://pleasegodno.wordpress.com/common-lisp-tutorials/common-lisp-gui-programming-with-commonqt/2-classes-and-methods/](http://pleasegodno.wordpress.com/common-lisp-tutorials/common-lisp-gui-programming-with-commonqt/2-classes-and-methods/)

```
? (main)
MAIN
? > Error: Unable to load foreign library (LIBCOMMONQT.DYLIB-31136).
>          Error opening shared library /Users/jk/.quicklisp/local-projects/commonqt/libcommonqt.dylib : dlopen(/Users/jk/.quicklisp/local-projects/commonqt/libcommonqt.dylib, 10): no suitable image found.  Did find:
>           /Users/jk/.quicklisp/local-projects/commonqt/libcommonqt.dylib: mach-o, but wrong architecture.
> While executing: CFFI::FL-ERROR, in process listener(1).
> Type :POP to abort, :R for a list of available restarts.
> Type :? for other options.
1 > 
```

Is this My wrong Setting? or Is Commonqt's source not working using Clozure Cl on OS X Lion?

Next, what should I do?

## user1234192's advice: ccl -> ccl64

I retry it.

```
> (qt-conv:main)
2012-07-12 21:46:11.630 dx86cl64[93621:c403] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /SourceCache/Foundation/Foundation-833.25/Misc.subproj/NSUndoManager.m:324
2012-07-12 21:46:11.631 dx86cl64[93621:c403] +[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.
2012-07-12 21:46:11.633 dx86cl64[93621:c403] (
    0   CoreFoundation                      0x00007fff8dc49f56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff9600dd5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff8dc49d8a +[NSException raise:format:arguments:] + 106
    3   Foundation                          0x00007fff8de4671f -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 169
    4   Foundation                          0x00007fff8ddb595f +[NSUndoManager(NSPrivate) _endTopLevelGroupings] + 144
    5   AppKit                              0x00007fff8b15a0ef -[NSApplication run] + 596
    6   QtGui                               0x000000000346cc60 _ZN19QEventDispatcherMac13processEventsE6QFlagsIN10QEventLoop17ProcessEventsFlagEE + 840
    7   QtCore                              0x0000000004122838 _ZN10QEventLoop4execE6QFlagsINS_17ProcessEventsFlagEE + 394
    8   QtCore                              0x0000000004125b0b _ZN16QCoreApplication4execEv + 175
    9   libsmokeqtgui.dylib                 0x00000000043718e1 _ZN12__smokeqtgui14x_QApplication4x_84EPN5Smoke9StackItemE + 17
    10  libsmokeqtgui.dylib                 0x00000000043579d8 _ZN12__smokeqtgui18xcall_QApplicationEsPvPN5Smoke9StackItemE + 1304
    11  dx86cl64                            0x000000000001b0db SPffcall + 99
    12  ???                                 0x0000000001219328 0x0 + 18977576
)
2012-07-12 21:46:11.634 dx86cl64[93621:c403] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /SourceCache/Foundation/Foundation-833.25/Misc.subproj/NSUndoManager.m:324
Qt has caught an exception thrown from an event handler. Throwing
exceptions from an event handler is not supported in Qt. You must
reimplement QApplication::notify() and catch all exceptions there.

Unhandled exception 10 at 0x0, context->regs at #xb029af30
Exception occurred while executing foreign code
received signal 10; faulting address: 0x0
? for help
[93621] Clozure CL kernel debugger: help
[93621] Clozure CL kernel debugger: [93621] Clozure CL kernel debugger: [93621] Clozure CL kernel debugger: Segmentation fault: 11 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T17:43:18.117

[http://kvardek-du.kerno.org/2011/12/setting-up-commonqt-on-osx.html](http://kvardek-du.kerno.org/2011/12/setting-up-commonqt-on-osx.html)

我在 clozure cl(Lion) 上取得了成功

并且...您的错误消息..“libcommonqt.dylib: mach-o, but wrong architecture”

也许..你的 ccl 和 libcommonqt.dylib 是不同的架构。

如果您的 ccl 是 x86(32bit) ，则 libcommonqt.dylib 必须 x86。

如果你的 ccl 是 x8664(64bit)，libcommonqt.dylib 必须 x8664...

我推荐64位。

我的英语很丑。对不起.......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-15T10:42:42.393

尝试

(ql:quickload :trivial-main-thread) (trivial-main-thread:call-in-main-thread #'qt-conv:main)

# richfaces - richfaces a4j:support event unexpected calling backend methods

> ID：11434534
> 
> 赞同：0
> 
> 时间：2012-07-11T14:10:47.900
> 
> 标签：richfaces, jsf-1.2, ajax4jsf, richfaces-modal

I work on a JSF 1.2 application with Richfaces 3.3\. I have a popup which contains a `rich:extendedDataTable`. When I click a row in a table I want to enable or disable a button, and I use `a4j:support event="onRowClick"`.

Here is some code:

```
<h:form>
    <rich:panel id="main">
        <a4j:commandButton id="completed" value="Completed" 
        rendered="#{bean.completedCase}" />

        <a4j:commandButton  value="Open"
                oncomplete="#{rich:component('popupId')}.show(...)">
        </a4j:commandButton>

        <rich:modalPanel id="popupId">
            <a4j:region>

                <rich:extendedDataTable id="source" value="#{bean.sourceItems}" 
                    var="sourceItem" selectionMode="single" >
                    <a4j:support event="onRowClick" eventsQueue="pickQueue" reRender="copy" >
                        <f:setPropertyActionListener value="#{sourceItem}"
                            target="#{bean.sourceSelection}" />
                    </a4j:support>
                    ....
                </rich:extendedDataTable>           

                <a4j:commandButton id="copy" value="Copy" />
            </a4j:region>

            <a4j:commandButton value="Ok" reRender="completed"
                    oncomplete="#{rich:component('popupId')}.hide();return false;">
            </a4j:commandButton>

        </rich:modalPanel>
    </rich:panel>
</h:form> 
```

The problem is that when I click a row, then in the backend are called some methods that are use to render a button: `rendered="#{bean.completedCase}"`, but the button is not on the popup, but on the page beyond the popup. Any idea why there are called other methods than the ones used for the table?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T00:18:05.020

尝试`ajaxsingle="true"`在您的`a4j:support`标签上使用。由于您`h:form`在 onrowclick 触发请求时使用，因此 h:form 中的所有组件都将在更新模型阶段在服务器上进行处理。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T09:28:26.753

嵌套 s 是不可取的，`<h:form>`但我们可以有多个`<h:form>`s，尝试修改您的代码，使`<h:commandButton>`are 在一个形式中`h:form`，而`<h:modalPanel>`is 在另一种形式中

希望这可以帮助。你也可以试试`<a4j:form>`for`modalPanel`

# json - 在 Salesforce 中接收 JSON

> ID：11434539
> 
> 赞同：2
> 
> 时间：2012-07-11T14:11:06.420
> 
> 标签：json, salesforce, apex-code

我试图通过转换 Http 请求正文中的 blob 来接收 Salesforce 中的 JSON 字符串。但是，当我将 blob 转换为字符串时，会在请求中插入 \ 字符，这会阻止我进行解析。

然后我尝试获取字符串并删除所有 \ 字符......这也不起作用。

```
RestRequest req = RestContext.request;
    Blob jsonBlob = req.requestBody;
    String jsonString = jsonBlob.toString();
    return jsonString; 
```

原始字符串（作为 blob 接收的字符串）如下所示：

```
{"putTimeCard":{"timecard":{"timeCardID": "","employeeID": ""}} 
```

并在转换为 salesforce 字符串并分配给 jsonString 后更改为：

```
{\"putTimeCard\":{\"timecard\":{\"timeCardID\": \"\",\"employeeID\": \"\"}} 
```

有没有人找到解决方案？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T17:33:51.017

JSON Deserializer 可以解析带有转义字符的字符串。您可以像这样反序列化为对象：

```
String jsonString = '{\"putTimeCard\":{\"timecard\":{\"timeCardID\": \"\",\"employeeID\": \"\"}}}'
Timecard t = (Timecard) JSON.deserialize(jsonString, Type.forName('Timecard')); 
```

或者，如果您只想要对象地图，您可以执行以下操作：

```
String jsonString = '{\"putTimeCard\":{\"timecard\":{\"timeCardID\": \"\",\"employeeID\": \"\"}}}'
Map<String, Object> m = (Map<String, Object>) JSON.deserializeUntyped(jsonString); 
```

# c# - iPhone & Android: how to take a picture and upload it to a website?

> ID：11434546
> 
> 赞同：1
> 
> 时间：2012-07-11T14:11:19.820
> 
> 标签：c#, android, iphone, asp.net

I'm building an asp.net website using c# and .net 2.0\. One of the pages requires to take a picture (or choose from already existing pictures), upload it to the server, add other info and save everything in the database.

I'm using a FileUpload control and everything is working fine on a PC.

Android gives me the options to choose a file from Gallery, File system, Music Track etc. but there is no option to take a picture from the camera. The FileUpload control is disabled in iPhone.

I want to click on a button or use something else and be able to choose to upload an image from the gallery or start the camera and take one. Is there a way to do it?

Thanks!

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-11T14:44:07.083

允许用户从图库中选择图片或拍摄新照片（如果设备支持摄影）都存在于同一类中。该类名为[UIImagePickerController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)并具有名为“sourceType”的属性，可让您指定用户是否将拍照、从图库中进行选择等。

-编辑-

这是适用于 iOS

# objective-c - iOS: Object release in ARC environment

> ID：11434547
> 
> 赞同：1
> 
> 时间：2012-07-11T14:11:20.280
> 
> 标签：objective-c, automatic-ref-counting, ios5.1

Could anyone please tell me am I handling memory correctly in following code in ARC environment? My concern is how would dict object released if I can't use release/autorelease in ARC! I know if it is strong type then it's get released before creating new one but in following look I don't know how would it works.

```
NSMutableArray *questions = [[NSMutableArray alloc] init];

for (NSDictionary *q in [delegate questions]) 
{
    NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
    [dict setValue:[q objectForKey:@"text"] forKey:@"text"];
    [dict setValue:nil forKey:@"value"];
    [dict setValue:[NSString stringWithFormat:@"%d",tag] forKey:@"tag"];
    [questions addObject:dict];
    dict = nil;
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T14:59:52.137

是的，您正在`dict`正确处理您的问题。

如果您有如下代码段：

```
{
    id __strong foo = [[NSObject alloc] init];
} 
```

当您离开变量的范围时`obj`，拥有的引用将被释放。对象自动释放。但这并不涉及魔术。ARC 将（在后台）进行如下调用：

```
{ 
    id __strong foo = [[NSObject alloc] init]; //__strong is the default
    objc_release(foo); 
} 
```

`objc_release(...)`是一种`release`调用，但由于它绕过了 objc 消息传递，因此它的性能非常好。

此外，您不需要将变量设置`dict`为`nil`. ARC 将为您处理此问题。设置对象以`nil`使对对象的引用消失。当一个对象没有对它的强引用时，该对象被释放（不涉及魔法，编译器将发出正确的调用以使其发生）。要理解这个概念，假设你有两个对象：

```
{
    id __strong foo1 = [[NSObject alloc] init];
    id __strong foo2 = nil;

    foo2 = foo1; // foo1 and foo2 have strong reference to that object

    foo1 = nil; // a strong reference to that object disappears

    foo2 = nil; // a strong reference to that object disappears

    // the object is released since no one has a reference to it
} 
```

要了解 ARC 的工作原理，我真的建议阅读[Mike Ash 博客](http://www.mikeash.com/pyblog/friday-qa-2011-09-30-automatic-reference-counting.html)。

希望有帮助。

# iphone - AFNetworking - 构建 NSDictionary 参数

> ID：11434548
> 
> 赞同：0
> 
> 时间：2012-07-11T14:11:22.457
> 
> 标签：iphone, ios, json, parameters, afnetworking

我正在尝试`NSDictionnary`使用 AFNetworking 框架构建我的发送到请求，但似乎我对如何正确执行它感到很困惑。

这是服务器所期望的：

```
{
    "limit":10,
    "filters":
    [
        {"field":"owner","operator":"EQUAL","value":"ownerId","type":"integer"},
        {"field":"date","operator":"GE","value":"30 Jun 2010 00:00:00","type":"date"},
    ],
    "order":[{"field":"date","order":"ASC"}],
    "page":0
} 
```

我正在尝试做的（我真的不知道这是否是正确的方法），是构建一个如下所示的 NSDictionary：

```
NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:
                                @"10", @"chunkSize", 
                                [NSDictionary dictionaryWithObjectsAndKeys:
                                    [NSDictionary dictionaryWithObjectsAndKeys:@"owner", @"field", @"EQUAL", @"operator", @"ownerId", @"value", @"integer", @"type", nil],
                                    [NSDictionary dictionaryWithObjectsAndKeys:@"date", @"field", @"GE", @"operator", @"30 Jun 2010 00:00:00", @"value", @"date", @"type", nil],
                                    nil], @"filters",
                                [NSDictionary dictionaryWithObjectsAndKeys:
                                    [NSDictionary dictionaryWithObjectsAndKeys:@"date", @"field", @"ASC", @"order", nil],
                                    nil], @"order",
                                @"0", @"page",
                                nil]; 
```

但是在加载视图时出现以下错误：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', 
reason: '+[NSDictionary dictionaryWithObjectsAndKeys:]: second object of each pair must be non-nil 
```

我知道我正确地构建了参数，但经过几次尝试后我无法做到。有人可以帮忙吗？此外，我真的不知道我必须在这里与`[]`和实现的区别`{}`。我读到这`{}`是一本字典和`[]`一个数组，但我真的不知道如何翻译它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:20:25.083

括号`[]`表示一个数组，而大括号`{}`表示一个对象（在此上下文中为字典）。要生成您需要的结构：

```
NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:
    @"10", @"chunkSize", 
    [NSArray arrayWithObjects:
         [NSDictionary dictionaryWithObjectsAndKeys:@"owner", @"field", @"EQUAL", @"operator", @"ownerId", @"value", @"integer", @"type", nil],
         [NSDictionary dictionaryWithObjectsAndKeys:@"date", @"field", @"GE", @"operator", @"30 Jun 2010 00:00:00", @"value", @"date", @"type", nil],
         nil], @"filters",
    [NSArray arrayWithObjects:
         [NSDictionary dictionaryWithObjectsAndKeys:@"date", @"field", @"ASC", @"order", nil],
         nil], @"order",
    @"0", @"page",
    nil]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:21:56.430

您的错误是从第 3 行开始的字典的值需要包装在一个数组中。

至少在 Objective-C[数组和哈希字面量](http://cocoaheads.tumblr.com/post/17757846453/objective-c-literals-for-nsdictionary-nsarray-and)成为主流之前，我创建复杂字典的首选方法是从`NSMutableDictionary`. 在你的情况下：

```
NSMutableDictionary *mutableParameters = [NSMutableDictionary dictionary];
[mutableParameters setValue:@"10" forKey:@"limit"];
// ...

NSMutableArray *mutableFilters = [NSMutableArray array];
NSMutableDictionary *mutableOwnerFilterDictionary = [NSMutableDictionary dictionary];
[mutableOwnerFilterDictionary setValue:@"owner" forKey:@"field"];
// ...
[mutableFilters addObject:mutableOwnerFilterDictionary]; 

[mutableParameters setValue:mutableFilters forKey:@"filters"];
// ... 
```

此外，请确保通过设置`AFJSONParameterEncoding`为您的`AFHTTPClient`.

# ruby-on-rails - Strange bug happened with rails/git

> ID：11434554
> 
> 赞同：0
> 
> 时间：2012-07-11T14:11:44.247
> 
> 标签：ruby-on-rails, ruby, git, archlinux, ext4

I've experienced a strange bug with rails 3.2 / git.

In development mode, classes was not reloaded between requests (controllers, models, helpers) but views work.

I've searched a long time in unmodified configuration (application.rb, development.rb...) without success, I have to reload Thin to show changes.

So I've decided to create a new branch and revert commit by commit (I was thinking a bad updated/integration gem) and the code reload properly to the last commit !

Back to the master branch, code is reloaded properly between requests without any code change.

I'm running on Archlinux, ruby 1.9.3p194 (rvm), postgresql 9.1.4, git 1.7.11.1, ext4 FS tuned (UUID=ac74249f-84de-40d0-8b14-eb494983cfda /home ext4 defaults,noatime,data=writeback,barrier=0,nobh,errors=remount-ro 0 1)

What do you think about that ?

* * *

This bug never came back and very difficult to reproduce. I can't accept uncertain answers.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:37:05.113

我认为您的问题与GIT无关，仅与rails有关。

尝试放入您的 config/environments/development.rb：

```
 config.cache_classes = false 
```

这是 rails 配置，它告诉它在请求之间重新加载类（例如模型或控制器）。

可以肯定的是，使用以下命令运行 rails 服务器：`RAILS_ENV=development rails s`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T13:44:08.320

也许问题在于`noatime`fstab 中的选项。如果未触及时间戳，文件已更改，现在应该如何处理。您可以尝试删除该选项。

# database - vb.net - 具有 BindingSource 和不同 DataSource 的组合框

> ID：11434556
> 
> 赞同：2
> 
> 时间：2012-07-11T14:12:15.950
> 
> 标签：database, vb.net, datagridview, combobox, bindingsource

在我的表单中，我有一个`DataGridView`绑定到一个`BindingSource`有`DataSet`as的 a `DataSource`。我在表单上还有一些 TextFields 和 ComboBoxes，它们`DataSet`通过`BindingSource`. 这个想法是，在选定行的列中的值`DataGridView`反映在窗体上的其他控件中。也许我让它听起来有点复杂，但连接 TextField 以及绑定到数据集中表的 ComboBox 相当容易。

我的问题是，这次我想`ComboBox`从数组中设置项目，而不是从`DataSet`. 这是我尝试过的：

```
Me.ComboBox.DataBindings.Add(New System.Windows.Forms.Binding("SelectedValue",       Me.TblBindingSource, "ColumnName", True))

Dim ItemArray(2) As String
ItemArray(0) = ""
ItemArray(1) = "Default"
ItemArray(2) = "User-set"
ComboBox.DataSource = ItemArray 
```

现在，这似乎部分工作，因为`ComboBox`正确填充，我可以选择一个值，它出现在`DataGridView`. 但是当我更改`DataGridView`. 该列`("ColumnName")`是一个`ComboBoxColumn`以上面显示的方式获取其项目列表的列，并且它可以按预期工作。

如果不清楚；我有几个具有类似功能的组合框，但它们绑定到 a 中的列`DataTable`，如下所示：

```
Me.ComboBox1.DataBindings.Add(New System.Windows.Forms.Binding("SelectedValue", Me.Tbl1BindingSource, "WiDMethodX", True))
Me.ComboBox1.DataSource = Me.Tbl2BindingSource
Me.ComboBox1.DisplayMember = "SomeColumn"
Me.ComboBox1.ValueMember = "SomeColumn" 
```

如果重要，则`DataSet`来自`Access Database`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T15:07:55.830

`SelectedValue`与`ValueMember`属性一起使用，但由于您的数组列表没有描述性字段，因此不起作用。

尝试使用`SelectedItem`您的绑定：

```
Me.ComboBox.DataBindings.Add(New Binding("SelectedItem", _
                                      Me.TblBindingSource, "ColumnName", True)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-03T22:26:22.727

我意识到这个问题很老，但我解决了类似的问题。我将组合框的文本属性绑定到与组合框数据源的值成员或显示成员相关的绑定源成员。确保填写数据表（用于绑定源和组合框数据源）并在组合框的数据绑定文本之前将组合框绑定到其数据源。

```
Dim dtForBindingSource as DataTable
Dim bs as BindingSource
Dim dtForComboBox as DataTable

'Code to fill dtForBindingSource would go here

bs.DataSource = dtForBindingSource

'Code to fill dtForComboBox would go here

ComboBox.DataSource = dtForComboBox
ComboBox.DisplayMember = "ColumnToDisplay"
ComboBox.ValueMember = "ColumnXYZ" 
```

'现在数据源存在并且组合框已设置，我进行数据绑定。

```
ComboBox.DataBindings.Add("Text", bs, "ColumnToDisplay") 
```

# android - 如何在加载 Activity 之前隐藏操作栏？

> ID：11434560
> 
> 赞同：17
> 
> 时间：2012-07-11T14:12:28.860
> 
> 标签：android, android-actionbar

我的目标是在我的应用程序启动时显示启动画面。现在它将做的是短暂地显示带有空白页面的操作栏，然后跳转到启动屏幕。我试图弄清楚如何不显示开始屏幕而只从启动屏幕开始。我正在尝试使用这些链接来获取有关如何解决此问题的信息。

[ActionBar Lag in hidden title](https://stackoverflow.com/questions/10525734/actionbar-lag-in-hiding-title) 在这个我假设我可以使用相同类型的方法通过更改主题来隐藏操作栏，但我不知道我会实际使用什么作为我的风格。

[如何在创建活动之前隐藏操作栏，然后再次显示？](https://stackoverflow.com/questions/8500283/how-to-hide-action-bar-before-activity-is-created-and-then-show-it-again) 在这里它谈到了在清单中添加一行来做到这一点。清单在哪里？我把它放在任何地方都没有做任何事情。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-11T14:22:59.323

在清单文件中试试这个

```
<activity
        android:name="yourActivityName"
        android:label="your label"
        android:theme="@android:style/Theme.Holo.Light.NoActionBar.Fullscreen" >

    </activity> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-26T05:27:44.897

检查此链接[Android: hide action bar while view load](https://t.co/AEfC6wsdOY)

链接中的代码片段，以防链接中断，礼貌@kleopatra：

> `windowNoTitle`在您的主题上将属性设置为 true 将隐藏 ActionBar。在使用 getSupportActionBar 时使用两个不同的主题来扩展`parent="Theme.AppCompat.Light"` 以防止 NPE

将样式设置为

> ```
> <style name="AppThemeNoBar" parent="Theme.AppCompat.Light">
>         <item name="android:windowNoTitle">true</item>
> </style>
> <style name="AppThemeBar" parent="Theme.AppCompat.Light">
>         <item name="android:windowNoTitle">false</item>
> </style> 
> ```
> 
> 由于版本 < 11 的一些奇怪行为，您需要添加
> 
> if (Build.VERSION.SDK_INT < 11){ getSupportActionBar().hide(); }
> 
> 不需要操作栏的内部活动

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-03T09:18:06.860

从应用程序和加载的第一个活动中删除清单文件中的“android:label”条目。在您的情况下，Splash 活动。样本...

```
<application
    android:allowBackup="true"
    android:icon="@drawable/starticon"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.Holo">

    <activity
        android:name=".ActivitySplash"
        android:label="@string/app_name"
        >
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>
    </activity> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-23T11:00:49.980

只需在 onCreate 函数的 Activity 中添加此代码即可。

```
val actionBar = supportActionBar?.apply{hide()} 
```

# php - 从 php 中的分叉进程将数据存储在 /tmp 中

> ID：11434562
> 
> 赞同：1
> 
> 时间：2012-07-11T14:12:41.737
> 
> 标签：php, fork, tmp

一段时间以来，我一直在将来自分叉进程的序列化对象存储`/tmp`在`file_put_contents`.

一旦所有子进程结束，我只是使用`file_get_contents`和反序列化数据来重建我的对象进行处理。

所以我的问题是，有没有更好的方法来存储我的数据而不写入/tmp？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:16:37.657

除了将数据存储在文件中之外，唯一想到的其他本机解决方案是 shm [http://www.php.net/manual/en/function.shm-attach.php](http://www.php.net/manual/en/function.shm-attach.php)或套接字流对[http://www .php.net/manual/en/function.stream-socket-pair.php](http://www.php.net/manual/en/function.stream-socket-pair.php)

如果在脚本运行后收集的数据不重要，那么这些中的任何一个都应该是可行的。它们背后的想法是在您的父进程和子进程之间打开一个通信通道。我会说我的个人观点是，除非使用文件系统出现某种问题，否则它是迄今为止最不复杂的解决方案。

## SHM

shm 的想法是，不是将序列化的对象存储在文件中，而是将它们存储在一个 shm 段中，由信号量保护并发。原谅代码，它很粗糙，但应该足以给你大致的想法。

```
/*** Configurations ***/
$blockSize = 1024; // Size of block in bytes
$shmVarKey = 1; //An integer specifying the var key in the shm segment

/*** In the children processes ***/

//First you need to get a semaphore, this is important to help make sure you don't
//have multiple child processes accessing the shm segment at the same time.
$sem = sem_get(ftok(tempnam('/tmp', 'SEM'), 'a'));

//Then you need your shm segment
$shm = shm_attach(ftok(tempnam('/tmp', 'SHM'), 'a'), $blockSize);

if (!$sem || !$shm) {
    //error handling goes here
}

//if multiple forks hit this line at roughly the first time, the first one gets the lock
//everyone else waits until the lock is released before trying again.
sem_acquire($sem);
$data = shm_has_var($shm, $shmVarKey) ? shm_get_var($shm, $shmVarKey) : shm_get_var($shm, $shmVarKey);

//Here you could key the data array by probably whatever you are currently using to determine file names.
$data['child specific id'] = 'my data'; // can be an object, array, anything that is php serializable, though resources are wonky
shm_put_var($shm, $shmVarKey, $data); // important to note that php handles the serialization for you
sem_release($sem);

/*** In the parent process ***/
$shm = shm_attach(ftok(tempnam('/tmp', 'SHM'), 'a'), $blockSize);
$data = shm_get_var($shm, $shmVarKey);

foreach ($data as $key => $value)
{
    //process your data
} 
```

## 流套接字对

我个人喜欢使用这些进行进程间通信。这个想法是在分叉之前，您创建一个流套接字对。这导致创建了两个相互连接的读写套接字。其中一个应该由父母使用，其中一个应该由孩子使用。您必须为每个孩子创建一个单独的配对，它会稍微改变您父母的模型，因为它需要更实时地管理通信。

幸运的是，这个函数的 PHP 文档有一个很好的例子：[http ://us2.php.net/manual/en/function.stream-socket-pair.php](http://us2.php.net/manual/en/function.stream-socket-pair.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:14:05.060

您可以使用更快的共享内存缓存，例如 memcached，但取决于您正在做什么以及数据的敏感度/重要性，基于文件的解决方案可能是您的最佳选择。

# jackrabbit - 监听 sling 的用户和组的变化

> ID：11434566
> 
> 赞同：1
> 
> 时间：2012-07-11T14:12:52.050
> 
> 标签：jackrabbit, sling

我希望在 sling 的 userManager 中的用户或组发生更改时收到通知。比如新建组时，我需要在/content下新建一个同名节点。创建新用户时，我想给他们/content/foo 的写权限。以及删除对象时的类似拆卸步骤。

我尝试注册一个 EventHandler（org.osgi.service.event.EventHandler），将 event.topics 设置为“*”（所有主题），但这仅捕获资源更改而不是 userManager 更改，因为用户和组是合成资源（我思考）

我尝试使用 org.apache.sling.api.request.SlingRequestListener，但 SlingRequestEvent 没有提供任何可以帮助我区分请求的信息（或者我不知道如何区分）。另外，我不确定这是否甚至可以用于处理请求后需要调用的回调。

我已经将[过滤器](http://sling.apache.org/site/filters.html)用于[不同的问题](https://stackoverflow.com/questions/10924035/customizing-json-rendering-for-slings-usermanager)，并且我也尝试将它们应用于此目的。但它们有其局限性——我的过滤器在请求之前被调用，所以在决定采取行动之前不可能知道请求是否会导致成功。

关于如何倾听和响应 sling 的用户和组模型变化的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T12:36:25.067

在[https://issues.apache.org/jira/browse/SLING-977](https://issues.apache.org/jira/browse/SLING-977)中，Ian Boston 建议使用 SlingPostProcessor 服务来获悉对用户管理的 POST servlet 的调用。

我自己没有尝试过，如果你这样做，你可能会错过通过 Sling 的用户管理 API 完成的更改——但这可能已经足够好，具体取决于你的用例。

除此之外，我认为目前没有一种万无一失的方式来通知此类更改。为了在 Sling 中实现这一点，我们需要包装 org.apache.jackrabbit.api.security.user.* 对象（Group、User、UserManager）以在它们发生更改时发送事件。当然可行，但需要更改该 Sling 捆绑包。

# android - android：在相对布局中对齐

> ID：11434577
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:05.100
> 
> 标签：android, alignment, android-relativelayout

我的相对布局有些问题

代码 ：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="50dp"
    android:background="@drawable/round_corners_filter" >

        <TextView
                android:id="@+id/filter_city_name"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:textColor="@color/filter_name"
                android:textSize="17sp"
                android:layout_centerVertical="true"
                android:paddingLeft="13dp"
                android:text="CCCC" /> 

        <ImageView 
                android:id="@+id/filter_city_row"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerVertical="true"
                android:layout_alignParentRight="true"
                android:layout_marginRight="15dp"
                android:layout_marginLeft="15dp"
                android:src="@drawable/app_icon"/>

        <TextView
                android:id="@+id/filter_city_value"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:textColor="@color/filter_value"
                android:textSize="17sp"
                android:layout_centerVertical="true"
                android:layout_alignRight="@id/filter_city_row" 
                android:text="DDDDDDDDDD" /> 

</RelativeLayout> 
```

我有这个 ： ![在此处输入图像描述](../Images/434d6242df28c3c832a3088d3548d334.png)

我需要 filter_city_value 与 filter_city_row 对齐。但它与图像的右侧对齐，但我需要向左对齐，我需要 filter_city_value 位于图像 filter_city_row 之后。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:15:40.747

切换这个：

```
android:layout_alignRight="@id/filter_city_row" 
```

对此：

```
android:layout_toLeftOf="@id/filter_city_row" 
```

这将放置`@id/filter_city_value`在 的左侧`@id/filter_city_row`，这应该是您要查找的内容。

# vbscript - VBscript比较md5“如果那么”

> ID：11434579
> 
> 赞同：2
> 
> 时间：2012-07-11T14:13:06.620
> 
> 标签：vbscript, compare, md5

我正在尝试比较一些文件的一些 Md5，看看它们在我将它们复制到另一个驱动器后是否相同，如果它们相同，则删除原始文件。我迷失在语法上，因为我以前从未做过这样的事情。

我正在使用免费实用程序 vmd5.exe（命令行）来获取 md5。我只是不确定如何告诉 vbscript 如果输出相同，那么继续删除文件。这只是我试图比较两个 md5 的部分的一个片段，但这是我到目前为止所拥有的：

```
Dim md5Command, md5Command2

md5Command = "C:\Program Files\vmd5.exe " vmd5 & " " & C:\Testscripts\ 
md5Command2 = "C:\Program Files\vmd5.exe " vmd5 & " " & E:\CopyTestFolder\

If md5Command = md5Command2 then 

objFSO.DeleteFolder("C:\ScriptOutput") 'Can either delete entire archived folder, or just .zip files in folder

objFSO.DeleteFile("C:\Testscripts\Archive*.evtx") 'This will be path where archived logs are located once finished

Else 

End If 
```

这种语法肯定是错误的。但是根据我对 IF 的了解，我需要它看起来像这样。我只是不确定是否需要告诉脚本运行“设置”部分中的命令，或者我如何告诉脚本从命令行获取 md5 输出并将其与另一个进行比较。

在 Else 语句之后，我希望它要么结束脚本，要么只输出具有不同 md5 的文本文件，但我还没有到那一点，还没有真正决定任何事情。

如果有更好的方法来做这样的事情，我也会这样做，不过这就是我今天早上想出的全部内容。

**编辑：**我想到了一些可能的事情。如果我告诉命令行将输出的内容输出到文本文件，那么我可以比较两个不同的文本文件，如果内容匹配，那么它可以继续执行脚本的其余部分。我不知道如何让它工作，但逻辑似乎是有道理的。

以下是它创建的文本文件的输出：

```
Vallen VMD5 R2009.1215

Filename                               MD5 sum
------------------------------------------------------------
[C:\ScriptOutput\]
Testzip.zip                     d5db2ff8c372a12c145170fb7340e682 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T15:22:58.843

要解决您的任务，您必须解决一些子问题：

1.  VBScript 中的字符串连接：`"... exe " vmd5 & " "`- 要拼接变量 vmd5 的内容，您需要两侧的连接运算符 - 但这是您想要做的吗？`" " & C:\Testscripts\`- 要附加文字'C:\Testscripts\'，您需要（双）引用文字 - 但是您可以将所有组件组合成一个字符串文字。
2.  在 VBScript 中 " 用作字符串文字分隔符；它们不像更强大的脚本语言中的反引号那样工作**。md5Command**必须包含您要执行的命令；要获得该命令的**结果**是另一回事。
3.  要脱壳/执行命令，您必须使用 WScript.Shell 对象的 .Exec 或 .Run 方法并收集输出。
4.  根据您使用的工具（输出），您将无法通过 = 运算符比较结果 - 例如，文件/校验和的路径或顺序可能不同。因此，您需要一种策略来解析捕获的输出。

你想先处理哪个子问题？

正如您的评论所证明的，正确的语法应该是起点。这个：

```
 Dim aDirs : aDirs = Array("..\data\one", "..\data\two")
  ' Join an array of the components (no more problems
  ' with (forgetting (to concat)) separators)
  ' Use qq() function to lessen the noise
  Dim sCmdT : sCmdT = Join(Array( _
        "fciv" _
      , "-add" _
      , qq("§DIR§") _
  ), " ")
  Dim nDir, sDir, sCmd
  For nDir = 0 To UBound(aDirs)
      sDir = aDirs(nDir)
      ' Use replace on a template to avoid repetition
      sCmd = Replace(sCmdT, "§DIR§", sDir)
      WScript.Echo "sCmd: |" & sCmd & "|"
  Next 
```

输出：

```
sCmd: |fciv -add "..\data\one"|
sCmd: |fciv -add "..\data\two"| 
```

说明了 3 种方法，使“构建”（shell）命令或 SQL 语句更容易/更不容易出错。（qq() 函数的实现留作练习）。

由于我没有 vmd5 实用程序，我将在进一步的示例中使用 fciv。

下一个（版本的）脚本：

```
 Dim aDirs : aDirs = Array("..\data\one", "..\data\two")
  Dim sCmdT : sCmdT = Join(Array( _
        "fciv" _
      , "-add" _
      , qq("§DIR§") _
  ), " ")
  Dim oWSH : Set oWSH = CreateObject("WScript.Shell")
  Dim nDir, sDir, sCmd, oExec, sRes
  For nDir = 0 To UBound(aDirs)
      sDir = aDirs(nDir)
      sCmd = Replace(sCmdT, "§DIR§", sDir)
      Set oExec = oWSH.Exec(sCmd)
      sRes = oExec.Stdout.ReadAll()
      WScript.Echo sRes
  Next 
```

输出：

```
CmpMd500 - compare md5 checksums
==============================================================
//
// File Checksum Integrity Verifier version 2.05.
//
09fea378b96141413f5f09444573f0f3 ..\data\one\version.txt
4945c1ffd9ceb14c83e003091c6e8455 ..\data\one\README.md
4c4c34f7b6f0863056615d2cbcdf6912 ..\data\one\History.txt

//
// File Checksum Integrity Verifier version 2.05.
//
09fea378b96141413f5f09444573f0f3 ..\data\two\version.txt
4945c1ffd9ceb14c83e003091c6e8455 ..\data\two\README.md
4c4c34f7b6f0863056615d2cbcdf6912 ..\data\two\History.txt

============================================================== 
```

演示了执行命令和捕获输出的绝对最少代码 - 生产版本必须添加大量代码以进行错误处理。同时，它显示了示例输出以讨论如何解析/比较校验和。您可以发布 vmd5 实用程序的示例输出吗？

无论您是直接获得 md5 实用程序的输出（我上面的示例）还是从文件中获得输出，您都需要一个正则表达式来将字符串解析为可以进一步处理的数据。一个简单的脚本来处理您在问题中发布的文件：

```
 Dim reMd5File : Set reMd5File = New RegExp
  reMd5File.Global    = True
  reMd5File.Multiline = True
  reMd5File.Pattern   = "^(\S+)\s+(\w{32})"
  Dim sDir : sDir = "..\data\three"
  Dim oFile
  For Each oFile In goFS.GetFolder(sDir).Files
      Dim sAll : sAll = oFile.OpenAsTextStream(ForReading).ReadAll()
      WScript.Echo sAll
      Dim oMTS : Set oMTS = reMd5File.Execute(sAll)
      Dim oMT
      For Each oMT In oMTS
          WScript.Echo "** parsed:", qq(oMT.Submatches(1)), qq(oMT.Submatches(0))
      Next
  Next 
```

输出：

```
CmpMd501 - compare md5 checksums
==================================================================
Vallen VMD5 R2009.1215

Filename                               MD5 sum
------------------------------------------------------------
[C:\ScriptOutput\]
Testzip.zip                     d5db2ff8c372a12c145170fb7340e682
version.txt                     09fea378b96141413f5f09444573f0f3
README.md                       4945c1ffd9ceb14c83e003091c6e8455
History.txt                     4c4c34f7b6f0863056615d2cbcdf6912

** parsed: "d5db2ff8c372a12c145170fb7340e682" "Testzip.zip"
** parsed: "09fea378b96141413f5f09444573f0f3" "version.txt"
** parsed: "4945c1ffd9ceb14c83e003091c6e8455" "README.md"
** parsed: "4c4c34f7b6f0863056615d2cbcdf6912" "History.txt"
********************
Vallen VMD5 R2009.1215

Filename                               MD5 sum
------------------------------------------------------------
[C:\ScriptOutput\]
Testzip.zip                     d5db2ff8c372a12c145170fb7340e682

** parsed: "d5db2ff8c372a12c145170fb7340e682" "Testzip.zip"
********************
==================================================================
xpl.vbs: Erfolgreich beendet. (0) [0.14844 secs] 
```

通过该代码工作后，您将对此脚本没有任何问题，它将“将结果存储在字典中”添加到我的“读取 .Exec 输出”版本中：

```
 Dim aDirs : aDirs = Array("..\data\one", "..\data\two")
  Dim sCmdT : sCmdT = Join(Array( _
        "fciv" _
      , "-add" _
      , qq("§DIR§") _
  ), " ")
  Dim oWSH : Set oWSH = CreateObject("WScript.Shell")

  ReDim aRes(UBound(aDirs))
  Dim reMd5File : Set reMd5File = New RegExp
  reMd5File.Global    = True
  reMd5File.Multiline = True
  reMd5File.Pattern   = "^(\w{32})\s(.+?)\s+$"

  Dim nDir, sDir, sCmd, oExec, sRes, oMTS, oMT
  For nDir = 0 To UBound(aDirs)
      sDir = aDirs(nDir)
      sCmd = Replace(sCmdT, "§DIR§", sDir)
      Set oExec = oWSH.Exec(sCmd)
      sRes = oExec.Stdout.ReadAll()
      Set aRes(nDir) = CreateObject("Scripting.Dictionary")
      Set oMTS = reMd5File.Execute(sRes)
      For Each oMT in oMTS
          aRes(nDir)(goFS.GetBaseName(oMT.SubMatches(1))) = oMT.SubMatches(0)
      Next
  Next

  Dim sFile
  For nDir = 0 To UBound(aDirs)
      For Each sFile In aRes(nDir).Keys
          WScript.Echo aRes(nDir)(sFile), sFile
      Next
      WScript.Echo
  Next 
```

输出：

```
===========================================
09fea378b96141413f5f09444573f0f3 version
4945c1ffd9ceb14c83e003091c6e8455 README
0252535193507019a0eb97328d28dd80 robic
4c4c34f7b6f0863056615d2cbcdf6912 History

09fea378b96141413f5f09444573f0f3 version
4945c1ffd9ceb14c83e003091c6e8455 README
4c4c34f7b6f0863056615d2cbcdf6912 History
c46264f8101b6c1609c77b4c674bd327 Rakefile

=========================================== 
```

下一步——也是最后一步，我希望——进行比较（一个文件夹中是否缺少文件？，“相同”文件的校验和是否不同？）。你有什么想法吗？

# svn - Xcode 4.3 如何使用 SVN 合并来自两个开发人员的故事板更改？

> ID：11434581
> 
> 赞同：8
> 
> 时间：2012-07-11T14:13:11.240
> 
> 标签：svn, version-control, xcode4.3, uistoryboard

我遇到了一个项目有多个开发人员在同一个故事板文件上工作的问题。当开发人员将控制器添加到他们自己的故事板版本中时，需要合并文件。当我在合并期间查看纯文本格式的故事板时，我无法理解我应该接受哪些更改以及以何种顺序。

**是否有某种教程或指南关于如何从同一故事板的版本中合并更改？**您如何管理多个开发人员对同一个故事板所做的更改？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T14:47:49.383

我想我的回答对您没有帮助，但是...您似乎无法确定合并是否可行。

**由于情节提要（作为 xib 文件）是 xml，因此很难有一种“确定”的方式来合并更改。**

**似乎谷歌甚至出于同样的原因禁止使用 xib**（[背后敌人线谷歌/](http://www.splinter.com.au/2012/12/26/behind-enemy-lines-google/)看看帖子的结尾）。

我建议你要么尽量不要在情节提要上进行并行工作，或者要求开发人员尽快在情节提要上提交他们的更改，以避免冲突（以及那些仍然会发生冲突的人，恢复并重做他们的行动）但这只有在您的项目分支不多的情况下才有效。

**拥有多个故事板可以帮助您避免冲突**（[故事板和 SVN 冲突](https://stackoverflow.com/questions/11538510/storyboards-and-svn-conflicts)）

你也可以只使用使用 xib 文件，因为你有更多的 xib 文件，你会得到更少的冲突机会（在大多数情况下，合并 xib 也很简单——比如新添加的按钮等等）。

最后，您可以尝试查看故事板 xml 以尝试找到一种方法来合并它（幸运的是，有人已经这样做了并且会找到您的答案），**但请记住，这些类型的文件往往会改变时间（我们有在 XCode 3.xxx**上启动的应用程序，只是在 XCode 4.5.2 上打开 xib 实际上修改了文件，并且一些 xib 是在 XCode 4.1 上创建的，所以它在 XCode 版本之间很常见）

[编辑]

[xcode 故事板合并](https://stackoverflow.com/questions/8393214/xcode-storyboard-merging)

那里的答案提出了一个应用程序，它可能值得一试！

# ms-access - 在访问中将 Excel 表添加到 Sharepoint 站点的末尾

> ID：11434583
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:19.467
> 
> 标签：ms-access, sharepoint-2010

所以我在共享点网站上有一个表格，另一方用新项目更新（电子表格样式）

我也（目前）有一个 Excel 表，其中包含对所述 sharepoint 网站上每个项目的评论。

诀窍是从共享点站点添加和删除内容，我需要能够跟踪添加的内容和删除的内容，以便我知道需要查看的内容。最初我是在 Excel 上执行此操作的，但是当添加或从共享点站点中删除内容时，我不得不重新调整评论（一个漫长的过程），所以有人建议访问，但我在试图找到一个很好的教程来回答我该怎么做时遇到问题这个。

我的想法是创建从共享点站点导入列的访问数据库，并且我可以在它的末尾附加更多列以添加到我的评论评论中。这行得通吗？

最终，我希望将我的评论放在另一个共享点网站上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T09:22:04.127

当事情发生变化时，Sharepoint 可以发送电子邮件。

如果您想知道如何在 MsAccess 中查看共享点数据，可以查看[sharepoint-msaccess-synchronization](https://stackoverflow.com/questions/4096382/sharepoint-msaccess-synchronization)：

# php - 从数组生成间隔日期

> ID：11434584
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:26.087
> 
> 标签：php

我有两个日期（开始和结束），例如：

```
$date['start'] = '2012-07-11';
$date['end'] = '2012-07-13'; 
```

我想为此生成-4 天和+4 天的间隔。所以我想收到例如数组：

```
$date['start'] = '2012-07-07';
$date['end'] = '2012-07-09';

$date['start'] = '2012-07-08';
$date['end'] = '2012-07-10';

$date['start'] = '2012-07-09';
$date['end'] = '2012-07-11';

$date['start'] = '2012-07-10';
$date['end'] = '2012-07-12';

$date['start'] = '2012-07-11';
$date['end'] = '2012-07-13';

$date['start'] = '2012-07-12';
$date['end'] = '2012-07-14';

$date['start'] = '2012-07-13';
$date['end'] = '2012-07-15';

$date['start'] = '2012-07-14';
$date['end'] = '2012-07-16';

$date['start'] = '2012-07-15';
$date['end'] = '2012-07-17'; 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:01:27.097

这段代码可以解决问题：

```
 $date['start'] = '2012-07-11';
 $date['end'] = '2012-07-13';

 $dates=array();
 for ($i=-4; $i<=4; $i++){
   $startDate=strtotime($date['start'] );
   $endDate=strtotime($date['end'] );

   $startDate=$startDate+($i*60*60*24); //60*60*24 equal to one day
   $endDate=$endDate+($i*60*60*24);

   array_push($dates, array('start'=>date('Y-m-d', $startDate), 'end'=> date('Y-m-d',$endDate)));
 }
 print_r($dates); 
```

输出：

```
Array(
    [0] => Array
        (
            [start] => 2012-07-07
            [end] => 2012-07-09
        )

    [1] => Array
        (
            [start] => 2012-07-08
            [end] => 2012-07-10
        )

    [2] => Array
        (
            [start] => 2012-07-09
            [end] => 2012-07-11
        )

    [3] => Array
        (
            [start] => 2012-07-10
            [end] => 2012-07-12
        )

    [4] => Array
        (
            [start] => 2012-07-11
            [end] => 2012-07-13
        )

    [5] => Array
        (
            [start] => 2012-07-12
            [end] => 2012-07-14
        )

    [6] => Array
        (
            [start] => 2012-07-13
            [end] => 2012-07-15
        )

    [7] => Array
        (
            [start] => 2012-07-14
            [end] => 2012-07-16
        )

    [8] => Array
        (
            [start] => 2012-07-15
            [end] => 2012-07-17
        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:39:12.857

您想要从提供范围的 -4 天到 +4 天的 9 对日期？

假设您的日期将在 1970 年之后：

```
<?php
$start=strtotime($date['start']);
$end=strtotime($date['end']);

for($loop=-4;$loop<=4;$loop++)
{
    $loop_str='';
    if($loop>=0) $loop_str.='+';
    $loop_str.=$loop.' days';
    $date['start']=strtotime($loop_str, $start);
    $date['end']=strtotime($loop_str, $end);
    print_r($date);
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:17:18.853

range(date('Ymd', strtotime('-4 days'), date('Ymd', strtotime('+4 days'))),

# c# - 实体框架 - 更新数据上下文不更新 UI？

> ID：11434586
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:39.953
> 
> 标签：c#, wpf, entity-framework, binding

在我的 WPF 应用程序中，我使用实体框架。我将主网格的数据上下文设置为 GroupTxt 的对象。

```
<Grid Name="main">
  <!-- Textboxes with binding -->
</Grid>

  DataEntities dt = new DataEntities();
  GroupTxt objGroupTxt; 

  void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        objGroupTxt= dt.GroupTxts.First();
        main.DataContext = objGroupTxt;
    } 
```

然后我将对象传递给一个外部 dll，在该 dll 中处理它，然后返回该对象。然后我将此对象分配给 objGroupTxt：

```
objGroupTxt= modifiedGroupTxt // object modified by external dll 
```

但更改的值不会在绑定的文本框中更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:30:21.873

看起来您将引用类型分配的行为与绑定的行为混淆了。当您最初为`objGroupTxt`（调用此实例 A）分配值时，`objGroupTxt`现在指向 A。接下来您将`objGroupTxt`(A) 分配给`main.DataContext`，现在也将指向 A。从您发布的内容中不清楚，但看起来像您'从处理中`modifiedGroupTxt`得到一个新实例（B）。然后您重新分配`objGroupTxt`给 B，但`main.DataContext`仍在使用 A。

`DataContext`您可以通过在每次获得新的已处理实例时重新分配或设置`objGroupTxt`为具有更改通知 (`INotifyPropertyChanged`或) 的属性来纠正此问题，`DependencyProperty`然后您可以绑定`DataContext`到该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:19:03.140

如果没有比已经提供的更多信息（您可能需要提供更多代码以获得更完整的答案），我猜您的对象没有实现该`INotifyPropertyChanged`接口。此外，您没有将上下文设置为 dt，而是设置为 dt 内的对象，因此更改 dt 不会做任何事情。

# android - Android 可扩展列表从字符串数组中放置子项

> ID：11434588
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:42.690
> 
> 标签：android, expandablelistview, arrays

我正在尝试在 Android 中制作可扩展列表。但是我有一个问题将值放在子列表中。

我正在手动编写组列表数据，因为它们不会被更改。但是子列表数据将从我的 SQLite 数据库生成（takeItemsFromDatabase() 方法从数据库中获取数据并将其放入“产品”数组字符串）。

所以数组字符串“产品”得到了所有项目。

我的问题从这里开始。当我试图将数组字符串“产品”放入子列表时，以这种方式：

```
static final String hijosGrupos[][] = {
        // Shades of grey
        {product},
        // Shades of blue
        { "example 1", "example 2", "etc" }, {}, {}, {}, {}}; 
```

它给了我这个错误：

```
"Type mismatch: cannot convert from String[] to String" 
```

我知道为什么它向我显示一个错误，但我不知道如何解决它。

所以基本上我想把我数据库中某列的数据放到子列表中。

有人知道吗？

这是我的代码：

```
public class Resumen extends ExpandableListActivity {

String[] preguntasContrato;
String[] especiesDetectadas;
String[] medidasEstructurales;
String[] medidasSobreHabitos;
String[] medidasControlDirecto;
static String[] product;

String Grupos[] = { "Product", "Preguntas contrato", "Others",
        "Medidas 1", "Medidas 2",
        "Medidas 3", "Medidas 4" };

    //Here are values of child lists
static final String hijosGrupos[][] = {
        // Shades of grey
        {},
        // Shades of blue
        { "example 1", "example 2", "etc" }, {}, {}, {}, {}};

@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.resumenlista);
    Log.i("Prueba", "Prrr");
    cogerProductosSeleccionados();

    @SuppressWarnings("unchecked")
    SimpleExpandableListAdapterWithEmptyGroups expListAdapter = new SimpleExpandableListAdapterWithEmptyGroups(
            this, createGroupList(), R.layout.nombrefilaresumen,
            new String[] { "colorName" }, new int[] { R.id.groupname },
            createChildList(), R.layout.filahijoresumen, new String[] {
                    "shadeName", "rgb" }, new int[] { R.id.childname,
                    R.id.rgb });
    setListAdapter(expListAdapter);

}

@SuppressWarnings({ "rawtypes", "unchecked" })
private List createGroupList() {
    ArrayList result = new ArrayList();
    for (int i = 0; i < Grupos.length; ++i) {
        HashMap m = new HashMap();
        m.put("colorName", Grupos[i]);
        result.add(m);
    }
    return (List) result;
}

@SuppressWarnings({ "rawtypes", "unchecked" })
private List createChildList() {
    ArrayList result = new ArrayList();
    for (int i = 0; i < hijosGrupos.length; ++i) {
        ArrayList secList = new ArrayList();
        for (int n = 0; n < hijosGrupos[i].length; n += 2) {
            HashMap child = new HashMap();
            child.put("shadeName", hijosGrupos[i][n]);
            child.put("rgb", hijosGrupos[i][n + 1]);
            secList.add(child);
        }
        result.add(secList);
    }
    return result;
}

public void takeItemsFromDatabase() {
    List<String> uGraduateNamesList = new ArrayList<String>();
    AndroidOpenDbHelper openHelperClass = new AndroidOpenDbHelper(this);

    SQLiteDatabase sqliteDatabase = openHelperClass.getReadableDatabase();

    Cursor cursor = sqliteDatabase.query("ProductosTemporal", null, null,
            null, null, null, null);

    startManagingCursor(cursor);

    while (cursor.moveToNext()) {

        String descripcionproducto = cursor.getString(cursor
                .getColumnIndex(AndroidOpenDbHelper.descripcionproducto));

        uGraduateNamesList.add(descripcionproducto);

        final String[] itemsInArrayString = uGraduateNamesList
                .toArray(new String[uGraduateNamesList.size()]);
        Items(itemsInArrayString);

    }
    cursor.close();
    sqliteDatabase.close();

}

public void Items(String[] itemDesc) {
     product = itemDesc;

}
} 
```

[在这里](http://androgue.blogspot.com.es/2011/08/android-expandablelistview-tutorial.html)我找到了这段代码。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T10:52:45.323

SimpleCursorAdapter 示例：

从我的 dbhelper 调用可扩展列表的光标：

```
public Cursor fetchGroup(String group) {
    String query = "SELECT DISTINCT "
            + group
            + " AS _id FROM "
            + LISTITEM_TABLE;
    return mDb.rawQuery(query, null);
}

public Cursor fetchChildren(String column, String token) {
    String query = "SELECT _id, name, qty, unit FROM items WHERE "
            + column
            + "='"
            + token
            + "';
     return mDb.rawQuery(query, null);
} 
```

调用适配器：

```
ExpandableListView lv;
mGroupsCursor = mDbHelper.fetchGroup(group,
        ListFragment_ShopList.listId);
getActivity().startManagingCursor(mGroupsCursor);
mGroupsCursor.moveToFirst();

lv = (ExpandableListView) getActivity().findViewById(android.R.id.list);
lv.setItemsCanFocus(false);
lv.setChoiceMode(ExpandableListView.CHOICE_MODE_SINGLE);

mAdapter = new MyExpandableListAdapter(mGroupsCursor, getActivity(),
        R.layout.rowlayout_expgroup, R.layout.rowlayout_itemlist_exp,
        new String[] { "_id" }, new int[] { android.R.id.text1 },
        new String[] { GroceryDB.ITEM_NAME, GroceryDB.LISTITEM_QTY,
                GroceryDB.ITEM_UNIT }, new int[] { R.id.ListItem1,
                R.id.ListItem3, R.id.ListItem2 });
lv.setAdapter(mAdapter); 
```

适配器（在与其调用相同的 .java 文件中）：

```
public class MyExpandableListAdapter extends SimpleCursorTreeAdapter {
    public MyExpandableListAdapter(Cursor cursor, Context context,
            int groupLayout, int childLayout, String[] groupFrom,
            int[] groupTo, String[] childrenFrom, int[] childrenTo) {
        super(context, cursor, groupLayout, groupFrom, groupTo,
                childLayout, childrenFrom, childrenTo);
    }
    @Override
    protected Cursor getChildrenCursor(Cursor groupCursor) {
        Cursor childCursor = mDbHelper.fetchChildren(GroceryListMain.group,
                groupCursor.getString(groupCursor.getColumnIndex("_id")),
                ListFragment_ShopList.listId);
        getActivity().startManagingCursor(childCursor);
        childCursor.moveToFirst();
        return childCursor;
    }
    protected void bindChildView(View view, Context context, Cursor cursor,
            boolean isLastChild) {
        TextView name = (TextView) view.findViewById(R.id.ListItem1);
        TextView qty = (TextView) view.findViewById(R.id.ListItem3);
        TextView unit = (TextView) view.findViewById(R.id.ListItem2);
        name.setText(cursor.getString(1));
        qty.setText(cursor.getString(2));
        unit.setText(cursor.getString(3));
    }
} 
```

以上所有内容中最重要的是`SELECT DISTINCT columnn as _id`对组游标的调用......它为每个*不同*的分组提供了一个记录，然后您使用它来获取孩子。

# actionscript-3 - 在 AS3 中模拟 Photoshop 颜色级别

> ID：11434589
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:43.373
> 
> 标签：actionscript-3, flash, image-processing

我正在制作一个应用程序，我需要在其中制作一些类似于 Instagram 效果的照片效果。我想知道是否有可能以某种方式在 AS3 中模拟 Photoshop 的颜色级别的工作。

我尝试过使用`AdjustColor`,`ColorMatrixFilter`和`ColorTransform`类，但使用它们很难实现所需的图像。

那么有人有比这更容易的解决方案吗？或者也许有人知道我在谷歌上找不到的图书馆？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:37:03.197

你应该看看[Joa 的图像处理库](http://blog.joa-ebert.com/imageprocessing-library/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:41:10.097

看看这个库： http: [//peternitsch.net/bitmapdata.js/](http://peternitsch.net/bitmapdata.js/) 这实际上是用 Javascript 实现的，但它是基于 Flash API 的。你需要的一切都在那里。或者我可以推荐 Todd Yard 的 Foundation ActionScript 3.0 Image Effects。

[Flash API 参考](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html)是另一个很好的灵感来源。

这里还有另一个很好的像素操作资源：http: [//evanw.github.com/webgl-filter/](http://evanw.github.com/webgl-filter/)。这是在 WebGL 中完成的，但如果您的目标 API 仍然是 Flash，那么您可以轻松地将 GLSL 语言转换为 Pixelbender，并通过引用 pbj 文件将着色器注入 Flash。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T18:17:03.050

检查 Grant Skinner 的[TweenMax](http://www.greensock.com/tweenmax/)插件，尤其是 ColorMatrixFilter。

# php - 页面加载时未添加类

> ID：11434590
> 
> 赞同：0
> 
> 时间：2012-07-11T14:13:46.437
> 
> 标签：php, jquery, html

嗨，我的网站在菜单上似乎有一些问题。当我第一次加载页面时，菜单的第一个元素应该有一个在 IE9 上处于活动状态的类，该活动类被扩展到菜单上的每个元素，而在其他浏览器上则根本不添加该类。如果我开始点击菜单按钮，一切都会开始正常运行。

奇怪的是，这仅在我尝试加载例如[http://www.foxteam.net/](http://www.foxteam.net/)时才会在服务器上发生，但如果我加载[http://www.foxteam.net/index.php](http://www.foxteam.net/index.php)，则该网站正常工作在所有浏览器上。这让我很困惑，因为据我所知，即使您打开[http://www.foxteam.net/](http://www.foxteam.net/)浏览器也会打开`index.php`文件。

我的情况有什么问题？

该菜单位于一个单独的文件中，该文件`header.php`包含在`index.php`包含函数中。

这是我用来创建此效果的代码，但我怀疑它是否会有所帮助，因为昨天一切正常，而今天我只使用了联系页面：

```
<ul id="main-menu">
         <li><a href="index.php" class="active">home</a></li>
         <li><a href="about.php">about us</a></li>
         <li><a href="portfolio.php">portfolio</a></li>
         <li><a href="contact.php">contact us</a></li>
</ul> 
```

jQuery：

```
$(document).ready(function(){
            var i = document.location.href.lastIndexOf("/");
            var currentPHP = document.location.href.substr(i+1);
            $("ul#main-menu li a").removeClass('active');
            $("ul#main-menu li a[href^='"+currentPHP+"']").addClass('active');
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:19:16.787

查看您的页面，您正在尝试使用 url 的页面段在页面上查找链接。

当您使用[http://www.foxteam.net/index.php](http://www.foxteam.net/index.php)时，您的代码能够获取带有 href 设置为 'index.php' 的 acnhor。但是，当您使用 URL [http://www.foxteam.net/](http://www.foxteam.net/)时，页面段是空白的，因此`$("ul#main-menu li a[href^='"+currentPHP+"']")`不匹配任何链接。

将页面中的当前文档加载脚本替换为以下脚本：

```
$(document).ready(function(){
        var i = document.location.href.lastIndexOf("/");
        var currentPHP = document.location.href.substr(i+1);
        $("ul#main-menu li a").removeClass('active');
        var link = $("ul#main-menu li a[href^='"+currentPHP+"']");
        if(link.length < 1) {
            link = $("ul#main-menu li a:first");
        }
        link.addClass('active');
}); 
```

对于 IE 问题：试试这个（未测试）

```
$(document).ready(function(){
        var i = document.location.href.lastIndexOf("/");
        var currentPHP = document.location.href.substr(i+1);
        $("ul#main-menu li a").removeClass('active');
        var link = $("ul#main-menu li a[href^='"+currentPHP+"']");
        if(currentPHP.length < 2 || link.length < 1) {
            link = $("ul#main-menu li a:first");
        }
        link.addClass('active');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:38:31.013

为什么要使用 JavaScript 添加和删除类，更好的方法是在支持的情况下执行此操作，如果关闭 JavaScript，您的网站更易于访问，这也解决了您当前的链接问题。

查看这篇文章[How add class='active' to html menu with php](https://stackoverflow.com/questions/2913415/how-add-class-active-to-html-menu-with-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:19:22.213

鉴于我在这个问题上得到的答案

[尽管 JS 函数更改了元素属性，IE8 v8 并未更改 DOM 元素的类](https://stackoverflow.com/questions/2527228/ie8-v8-not-changing-class-for-a-dom-element-despite-js-function-changing-the-ele)

我想这都是关于切换而不是添加/删除类

# mfc - 结束正在运行的 lua 脚本

> ID：11434595
> 
> 赞同：1
> 
> 时间：2012-07-11T14:14:01.280
> 
> 标签：mfc, lua

我有一个基于 MFC 对话框的应用程序并集成了 Lua。该对话框具有文本编辑器组件，以便用户可以输入脚本。该对话框还有一个“运行”按钮，当按下它时： luaL_loadstring( luaVM,theScript); lua_pcall(luaVM,0,0,0); 其中 luaVM 是我的主要 lua_State* 。该对话框还有另一个按钮“停止”，我希望在按下时能够停止由“运行”启动的当前正在运行的脚本，但我想不出一种方法。帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T15:50:06.753

Lua 不打算以这种方式使用。Lua 本质上是单线程的（硬件 CPU 线程，而不是 Lua 线程）。一旦脚本启动，就无法简单地终止它，除非您将该脚本*设计*为能够终止。

您要做的就是将用户的脚本作为协程启动。并且该协程必须经常（并且*手动*）产生，以便您可以检查是否应该停止脚本。由于这是一个手动过程，您要么需要用户正确检测他们的代码，要么需要修改他们的脚本并`yield`适当地添加调用。

您也许可以使用一些调试钩子每隔几秒钟检查一次，如果需要停止协程，则生成协程。但是，我不知道这是否真的有效，从调试钩子中产生是否合法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T09:53:47.683

You could set a debug hook that sleeps for a bit.

See [http://www.lua.org/manual/5.1/manual.html#lua_sethook](http://www.lua.org/manual/5.1/manual.html#lua_sethook)

# python - 从 Python 中的列表中删除列表

> ID：11434599
> 
> 赞同：47
> 
> 时间：2012-07-11T14:14:11.313
> 
> 标签：python, list, python-2.7

> **可能重复：**
> [从 Python 中的两个列表中获取差异](https://stackoverflow.com/questions/5305164/get-difference-from-2-lists-python)

这样做的简化方法是什么？我一直在自己尝试，我无法弄清楚。列表 a 和列表 b，新列表应该包含仅在列表 a 中的项目。所以：

```
a = apple, carrot, lemon
b = pineapple, apple, tomato
new_list = carrot, lemon 
```

我尝试编写代码，但每次它总是将整个列表返回给我。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-11T14:18:54.623

您可以使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)来编写此代码，该推导式可以非常准确地告诉我们哪些元素需要结束`new_list`：

```
a = ['apple', 'carrot', 'lemon']
b = ['pineapple', 'apple', 'tomato']

# This gives us: new_list = ['carrot' , 'lemon']
new_list = [fruit for fruit in a if fruit not in b] 
```

或者，使用 for 循环：

```
new_list = []
for fruit in a:
    if fruit not in b:
        new_list.append(fruit) 
```

正如您所看到的，这些方法非常相似，这就是 Python 还具有列表推导以轻松构建列表的原因。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-11T14:22:08.693

您可以使用一[组](http://docs.python.org/library/stdtypes.html#set)：

```
# Assume a, b are Python lists

# Create sets of a,b
setA = set(a)
setB = set(b)

# Get new set with elements that are only in a but not in b
onlyInA = setA.difference(b) 
```

**更新**
正如 iurisilvio 和 mgilson 指出的那样，这种方法仅在不包含重复项并且元素的顺序无关紧要`a`时才有效。`b`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-11T14:21:58.723

你可能想要这个：

```
a = ["apple", "carrot", "lemon"]
b = ["pineapple", "apple", "tomato"]

new_list = [x for x in a if (x not in b)]

print new_list 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-11T14:17:14.387

这对你有用吗？

```
a = ["apple", "carrot", "lemon"]
b = ["pineapple", "apple", "tomato"]

new_list = []
for v in a:
    if v not in b:
        new_list.append(v)

print new_list 
```

或者，更简洁地说：

```
new_list = filter(lambda v: v not in b, a) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-11T14:23:28.000

使用[集合](http://docs.python.org/library/sets.html#module-sets)[`set`](http://docs.python.org/library/stdtypes.html#set)（或自 Sets 在 2.6 中弃用以来的内置）怎么样？

```
from sets import Set
a = Set(['apple', 'carrot', 'lemon'])
b = Set(['pineapple','apple','tomato'])
new_set =  a.difference(b)
print new_set 
```

给出输出

```
Set(['carrot', 'lemon']) 
```

# android - 根据另一个微调器中的选择动态填充微调器

> ID：11434611
> 
> 赞同：0
> 
> 时间：2012-07-11T14:14:46.380
> 
> 标签：android, mono, spinner, fill

我用 xml 资源文件中的文本数组填充两个微调器。根据一个微调器中的选择，我想用 xml 资源文件中的两个不同数组之一填充另一个。我无法在单声道中为 android 执行此操作，并且无法在线找到任何示例。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:23:00.447

尝试这个...

```
public void onItemSelected(AdapterView<?> parent, View view, 
                int pos, long id) {
    if(pos==0){
       Spinner spinner = (Spinner) findViewById(R.id.spinner);
       ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
            R.array.arrayone, android.R.layout.simple_spinner_item);
       adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
       spinner.setAdapter(adapter);
    }
    else{
       Spinner spinner = (Spinner) findViewById(R.id.spinner);
       ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
            R.array.arraytwo, android.R.layout.simple_spinner_item);
       adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
       spinner.setAdapter(adapter);

       }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T23:12:11.820

你的建议很有帮助。经过一些更改，这对我来说在 mono for android 中有用：

我有一个微调器名称 spin3。您可以选择 opt1 或 opt2。在名为 opt1 和另一个名为 opt2 的资源中有一个字符串数组。然后第二个微调器 (spinner4) 根据在 spin3 中选择的内容将其内容更改为 opt1 或 opt2。

```
public void spin3_onItemSelected(object sender, AdapterView.ItemSelectedEventArgs e)
{
Spinner spin = (Spinner)sender;
string pos = spin.SelectedItem.ToString();
if(pos=="opt1")
{
Spinner spinner = (Spinner)FindViewById(Resource.Id.spinner4); 
ArrayAdapter adapter = ArrayAdapter.CreateFromResource this, Resource.Array.opt1, Android.Resource.Layout.SimpleSpinnerItem); 
adapter.SetDropDownViewResource(Android.Resource.Layout.SimpleSpinnerDropDownItem); 
spinner.Adapter = adapter; 
} 
else
{ 
Spinner spinner = (Spinner) FindViewById(Resource.Id.spinner4); 
ArrayAdapter adapter = ArrayAdapter.CreateFromResource(this, Resource.Array.opt2, Android.Resource.Layout.SimpleSpinnerItem); 
adapter.SetDropDownViewResource(Android.Resource.Layout.SimpleSpinnerDropDownItem); 
spinner.Adapter = adapter; 
}
} 
```

然后调用事件使用这个

```
spin3.ItemSelected += new EventHandler<AdapterView.ItemSelectedEventArgs>(spin3_onItemSelected); 
```

# objective-c - realloc() & 弧

> ID：11434618
> 
> 赞同：8
> 
> 时间：2012-07-11T14:15:03.493
> 
> 标签：objective-c, automatic-ref-counting, factory-pattern

我如何能够重写以下实用程序类以获取特定类型的所有类字符串值 - 使用如下所示的 Objective-c 运行时函数？

ARC 文档明确指出应该避免重新分配，并且我在这一行也收到以下编译器错误：

```
classList = realloc(classList, sizeof(Class) * numClasses); 
```

**“ARC不允许将非Objective-C指针类型'void *'隐式转换为'__unsafe_unretained Class *'”**

下面的代码是对原始文章的引用，可以在[此处](http://www.bobmccune.com/2011/04/08/automagic-factories-in-objective-c/)找到。

```
+ (NSArray *)classStringsForClassesOfType:(Class)filterType {

    int numClasses = 0, newNumClasses = objc_getClassList(NULL, 0);
    Class *classList = NULL;

    while (numClasses < newNumClasses) {
        numClasses = newNumClasses;
        classList = realloc(classList, sizeof(Class) * numClasses);
        newNumClasses = objc_getClassList(classList, numClasses);
    }

    NSMutableArray *classesArray = [NSMutableArray array];

    for (int i = 0; i < numClasses; i++) {
        Class superClass = classList[i];
        do {
            superClass = class_getSuperclass(superClass);
            if (superClass == filterType) {
                [classesArray addObject:NSStringFromClass(classList[i])];
                break;
            }           
        } while (superClass);       
    }

    free(classList);

    return classesArray;
} 
```

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-11T15:13:18.213

ARC 迫使您对内存管理更加明确。在这种情况下，您只需要显式地转换 realloc 的输出：

```
classList = (Class *)realloc(classList, sizeof(Class) * numClasses); 
```

# mule - 如何在 Mule 中将逗号分隔字符串传递给 JDBC 查询

> ID：11434619
> 
> 赞同：3
> 
> 时间：2012-07-11T14:15:06.207
> 
> 标签：mule

在这里，我需要将动态的多个客户 ID 传递给 mule 中的选择查询。所以我想出了一个逗号分隔的字符串，其中包含我的客户 ID，例如：**String custid=1001,1002**。我正在使用 groovy evalutor 来获取 JDBC 查询的字符串值。但是我收到一个空的有效载荷之后执行查询。同样对于像**String Custid =1001**这样的单值字符串，我得到了想要的结果。**因此，在 Mule 中，它是否会为'1001,1002'**之类的字符串附加单引号，这会导致此问题吗？

请帮我解决这个问题。另外请让我知道是否有其他方法可以解决这个问题？

这是我的代码片段：

```
<jdbc:query key="getCustID" value="SELECT CUSTID,CUSTTYPE FROM CUSTINFO WHERE CUSTID IN  (#[groovy:payload.custid]) "/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T17:34:59.813

Mule 替换表达式，就像`#[groovy:payload.custid]`绑定参数一样，所以这就是它不起作用的原因：逗号分隔的值被替换为单个参数。

对于您想要做的事情，我没有很好的解决方案。一种方法是使用已在[JDBC 连接器`queries`映射](http://www.mulesoft.org/docs/site/current3/apidocs/index.html?org/mule/transport/jdbc/JdbcConnector.html#getQueries%28%29)上解析的 ID 列表注册查询，然后再使用它。您将生成一个唯一的查询名称（如 UUID）以确保它仅由当前线程使用，并且您还需要`queries`在使用后将其从映射中删除以避免内存泄漏。

虽然这非常hacky，但希望其他人会有更好的答案......

# android - 使用 SyncAdapters 时登录两次

> ID：11434621
> 
> 赞同：17
> 
> 时间：2012-07-11T14:15:09.127
> 
> 标签：android, android-syncadapter

我正在创建一个新的 Android 应用程序`SyncAdapter`来处理数据库同步。我已经准备好一切，应用程序运行良好，但我注意到我登录了两次。

第一次登录发生在`AuthenticatorActivity`类（它扩展`AccountAuthenticatorActivity`）验证用户和密码时。

如果用户名和密码正确，`AuthenticatorActivity`则执行以下操作：

*   如果`account`不存在，它会使用`mAccountManager.addAccountExplicitly()`
*   `authToken`保存使用`intent.putExtra(AccountManager.KEY_AUTHTOKEN, authToken);`

这基本上是从 Android 示例中复制/粘贴的，所以我想没关系。

问题是当`SyncAdapter`启动和使用

```
authtoken = mAccountManager.blockingGetAuthToken(account,
          AuthenticatorActivity.PARAM_AUTHTOKEN_TYPE, true); 
```

调用扩展类`getAuthToken()`内部的方法。在这个方法中，我再次点击登录端点。`Authenticator``AbstractAccountAuthenticator`

从那时起，在`authToken`过期之前不会再次点击登录端点。

这不是让我很困扰的事情，但我想知道是否有办法避免登录两次。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-30T20:24:07.720

如您所见，尽管`Authenticator.java`在 SampleSyncAdapter 中说

> 此类演示的有趣之处在于将 authTokens 用作身份验证过程的一部分。...如果我们已经在帐户中存储了一个 authToken，我们将返回该 authToken。如果我们没有，但我们确实有用户名和密码，那么我们将尝试与示例服务对话以获取 authToken。

这是一个谎言。 `Authenticator.getAuthToken`不进行任何缓存检查，它只是通过网络获取令牌。

解决方案是添加缺少的检查：

```
Authenticator.java:
@Override
public Bundle getAuthToken(AccountAuthenticatorResponse response, Account account,
        String authTokenType, Bundle loginOptions) throws NetworkErrorException {

    // check that authToken type supported
    ...

    // Check if we already have a cached token to return
    final AccountManager am = AccountManager.get(mContext);
    String cachedAuthToken = am.peekAuthToken(account, authTokenType);
    if (cachedAuthToken != null) {
        final Bundle result = new Bundle();
        result.putString(AccountManager.KEY_ACCOUNT_NAME, account.name);
        result.putString(AccountManager.KEY_ACCOUNT_TYPE, Constants.ACCOUNT_TYPE);
        result.putString(AccountManager.KEY_AUTHTOKEN, cachedAuthToken);
        return result;
    }

    // Get new authToken from server
    ...

    // If all else fails, prompt the user for credentials
    ...
} 
```

请注意，当调用失败时，您的项目的其余部分需要认真使用`AccountManager.invalidateAuthToken`，否则您将最终导致调用失败的无限循环，尝试获取新的身份验证令牌，然后在返回相同的缓存身份验证令牌时再次失败。

# java - 如何从一个xml中提取字节数组并将其存储在Java中的另一个中

> ID：11434632
> 
> 赞同：0
> 
> 时间：2012-07-11T14:15:51.703
> 
> 标签：java, xml, image, dom, bytearray

所以我使用 DocumentBuilderFactory 和 DocumentBuilder 来解析 xml。所以它是DOM解析器。

但我想做的是提取字节数组数据（它是用base64编码的图像）

将其存储在一个对象中，然后在代码中将其写入另一个以 base64 编码的 xml。

将其存储在 btw 中的最佳方法是什么。将其存储为字符串？或作为字节数组？

如何以最佳方式提取字节数组数据并将其写出来。

我没有这方面的经验，所以想从小组中获得意见。

更新：我得到了 XML 我无法控制以 binary64 编码的传入 XML

```
< byte-array >
  ... base64 encoded image ...
< /byte-array > 
```

使用解析器我需要存储这个节点，问题是它应该是字节还是字符串，然后将它写到新 xml 中的另一个节点。再次以base64编码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:21:01.773

图像应作为字符串存储在第一个 xml 中。也许是这样的：

```
<img src="data:image/gif;base64,sssssssssssss"/> 
```

如果您需要将相同的数据写入第二个 xml，只需使用已编码的相同字符串即可。如果您需要更改图像。获取属性 ( `element.getAttribute("src")`)，使用众多库之一 ( [apache commons codec](http://commons.apache.org/codec/) ) 对其进行解码，然后将其重新编码为第二个 xml 的字符串。

更新响应：

至于你的更新。在`<byte-array>`元素内部，您应该有纯文本。它可以存储为文本，然后在第二个 xml 中用作文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:26:01.670

当您需要通过基于文本的协议（如 http）传输数据时，通常使用 Base64 编码。Base64 编码的作用是将二进制数据编码为一组字符，这些字符可以通过基于文本的协议发送，而不会出现任何编码/解码问题。

不确定您是否通过网络发送 xml，但您可以使用以下任何方法

1.  将 base64 字符串作为简单字符串发送。但在这种情况下，编码和解码的责任将落在发送和接收应用程序上。

2.  使用标准`base64Binary` [xml 类型](http://www.w3schools.com/schema/schema_dtypes_misc.asp)。在这种情况下，解析器将负责解码字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:27:04.867

Apache Commons 中有一个类可以帮助您确保 Base64 的数据完整性：

```
import org.apache.commons.codec.binary.Base64;

String yourString = "testing";
byte[] encoded = Base64.encodeBase64(yourString.getBytes()); 
```

[http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)

虽然，[Base64 数据](http://en.wikipedia.org/wiki/Base64)除了`+`and之外只是简单的字母字符`/`，因此如果将其存储在 String 中，应该不会有任何数据丢失。

# python - 解析 HTML 源代码以获取没有错误的图像的 url。（首选 Python）

> ID：11434634
> 
> 赞同：-7
> 
> 时间：2012-07-11T14:15:59.797
> 
> 标签：python, html, html-parsing

我制作了一个 wordpress 插件，它将博客帖子作为帖子数据发送，以便我可以保存网页。我使用以下查询从博客中获取数据：

```
select * from $wpdb->posts 
```

上面这行并不重要，只是提到它是为了告诉你我是如何获取博客数据的。

数据包含 HTML 标记。我需要解析 HTML 以获取图像的 URL。获得 URL 后，我就知道如何从 URL 下载图像。我想知道一种解析 HTML 标记以获取图像 URL 且没有任何错误的好方法。

python 是首选语言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:28:37.373

有几个 python 模块可以为您执行此操作：

*   美丽汤
*   lxml.html
*   html5lib

例如，

```
import BeautifulSoup

html = """
  <html><body>
    <h1>My html!</h1>
    <img src="yourimage1.jpg" />
    <img src="yourimage1.jpg" />
  </body></html>
"""

bs = BeautifulSoup.BeautifulSoup(html)
urls = [img["src"] for img in bs.findAll("img")] 
```

结果是`urls == ['yourimage1.jpg', 'yourimage2.jpg']`

# windows - Safari for Windows - 禁用某些插件

> ID：11434641
> 
> 赞同：0
> 
> 时间：2012-07-11T14:16:10.320
> 
> 标签：windows, plugins, safari

我只是找不到这样做的方法 - 在 Safari for Windows (5.1.7) 我想禁用某些插件，但我只能看到如何全部禁用它们（从 Preferences/Security-> Enable Plugins ) - 我不能单独打开和关闭它们吗？我已经阅读了有关从 Windows 资源管理器中的 Safari 文件夹中物理删除文件的信息，但我对此并不相信（并且那里没有与我试图禁用的文件相匹配的文件）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:36:43.307

在 Safari 中删除单个插件的唯一方法是从文件夹中物理删除（或将它们移动到另一个文件夹）`C:\Program Files (x86)\Safari\Plugins`。

如果您说您已经检查过并且您要查找的内容不在该文件夹中，那么您是插件而不是扩展程序吗？您应该能够在 Safari 的首选项选项中单独管理扩展。

如果您的插件没有出现在该文件夹中，则无论如何它都不应该加载。如果您在那里找不到它并且它确实加载了，我认为您最好的选择是卸载并重新安装 Safari。

抱歉，如果这没有帮助。

# apache - mod_jk的动态配置

> ID：11434651
> 
> 赞同：1
> 
> 时间：2012-07-11T14:16:49.657
> 
> 标签：apache, dynamic, mod-jk

我已将 mod_jk 配置为允许负载平衡。我想知道在 apache 运行时是否可以将更多工作人员动态添加到workers.properties？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T09:56:19.707

`workers.properties`部分文件中配置了no.file `.conf`，要使修改的`.conf`文件生效，需要重启Apache。

请参阅有关 mod_jk 配置的线程：http: [//milestonenext.blogspot.de/2012/09/ssl-offloading-with-modjk-part-1.html](http://milestonenext.blogspot.de/2012/09/ssl-offloading-with-modjk-part-1.html)

# javascript - 悬停时的水印图像

> ID：11434652
> 
> 赞同：0
> 
> 时间：2012-07-11T14:16:53.713
> 
> 标签：javascript, jquery, html, css, watermark

我有图像字段，我试图在其上添加水印，同时悬停此图像。我尝试了简单的 img:hover，但悬停图像仍在我的主 img 下。任何想法如何让我的悬停图像高于我的主要图像。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T14:25:10.297

试试这个 - [http://jsfiddle.net/2UQ6N/](http://jsfiddle.net/2UQ6N/)

```
<div>
    <img src="http://lorempixel.com/300/200" />
    <img src="http://cdn-img.easyicon.cn/png/270/27093.png" class="watermark" />
</div>

div {
    position: relative;
    display: inline-block;
}

div:hover img.watermark {
    display: block;
}

img.watermark {
    position: absolute;
    bottom: 0;
    right: 0;
    opacity: .6;
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:24:08.497

您需要将悬停图像稍后放在文档流中，或者将其`z-index`增加到高于它所覆盖的图像。

正如人们无疑会提到的那样，如果他们愿意，这不会阻止人们掌握你的形象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:25:57.140

您必须设置一个位置：相对于将图像放在顶部。

```
<img src="images/image1" width="225" height="219" border="0"> 

<img src="images/image2" width="250" height="372" border="0" style="position: relative;> 
```

因此，在您的 :hover 上添加位置：相对于您的顶部图像。

# java - 标记接口，实现与导入

> ID：11434655
> 
> 赞同：2
> 
> 时间：2012-07-11T14:16:56.350
> 
> 标签：java, oop

如果我有一个简单的标记接口（不包含方法），其中包含在整个应用程序中使用的常量，那么导入接口的类和实际实现接口之间有什么区别吗？

界面：

```
public interface MyConstants {
    String constant1 = "constant1";
    String constant2 = "constant2";
} 
```

实施：

```
public class MyClass implements MyConstants {
    public MyClass(){
        System.out.println(constant1);
    }
} 
```

输入：

```
import common.constants.MyConstants
public class MyClass {
    public MyClass(){
        System.out.println(MyConstants.constant1);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:22:22.060

实现它将是一个反模式：

> 在 Java 编程语言中，常量接口模式描述了仅使用接口来定义常量，并让类实现该接口以实现对这些常量的方便语法访问。但是，由于常量通常只是一个实现细节，而一个类实现的接口是其导出 API 的一部分，这种做法相当于将实现细节放入 API 中，这被认为是不合适的。[1][2] 通常，将系统常量收集到与行为无关的类中，可能会造成糟糕的面向对象设计，因为它通常是低内聚的标志。正是由于这些原因，实现常量接口被认为是一种反模式。

[http://en.wikipedia.org/wiki/Constant_interface](http://en.wikipedia.org/wiki/Constant_interface)

*关于标记界面，您可以[在此处查看](http://en.wikipedia.org/wiki/Marker_interface)。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:21:15.043

如果它实际上打算将类*标记*为具有特定属性，我只会将其称为标记接口，在这种情况下，它们必须实现该接口才能进行`instanceof`检查。如果它只是为了方便放置常量，那么我不会称它为标记接口，也不会有任何类实现它，因为它向实现类的公共面添加了一些东西，这只是一个实现细节。

# c++ - C 中的模板化函子。类模板与函数模板

> ID：11434656
> 
> 赞同：2
> 
> 时间：2012-07-11T14:16:57.003
> 
> 标签：c++, templates, functor

假设我想创建一个作用于某种通用类型的函子。例如

```
template<typename Ape>
class functor1
{
   void operator()(Ape& m)
   {
      // Do something to m
   }
}; 
```

这一直是我做事的标准方式。不过，我还有另一种方法：

```
class functor2
{
   template<typename Ape>
   void operator()(Ape& m)
   {
      // Do something to m
   }
}; 
```

第二种方法的优点是我不必明确说明模板的类型。

```
int main()
{
   std::vector<chimpanzee> chimps(100);
   for_each(chimps.begin(), chimps.end(), functor1<chimpanzee>()); // Explicity state the type
   for_each(chimps.begin(), chimps.end(), functor2()); // Less typing. Will it work?
} 
```

第二个版本能用吗？还是我错过了什么？如果可行，第一种方法有什么好处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:25:17.437

明显的区别是，在第一种情况下，您明确指定类型，而在第二种情况下，编译器将在实际调用的上下文中为您推断类型。但是，在您的具体示例中，它可能根本没有真正的区别。

1.  如果您的类中有多个成员函数，则第一个变体将为所有成员“修复”相同的模板参数，而在第二个变体中，将为每个成员函数独立推导出参数。

    当从多个上下文调用单个成员函数时也是如此：每个上下文将在第二个变体中执行其自己的模板参数推导。

    它可能好也可能不太好，这取决于你的意图。

2.  如果您的函数通过值（或通过`const`引用）接受其参数，则在第一个变体中，您可以为参数指定与存储在容器中的类型不同的类型。例如，您可以为 s 创建一个仿函数`long`并将其应用于`int`s 的容器。这在第二个变体中是不可能的。

    例如，如果您的`chimpanzee`类是多态的，派生自`animal`，您可以使用 a`functor1<animal>`来迭代此类容器。在第二个变体中，模板参数将为您推断为`chimpanzee`，而不是`animal`。

3.  如果你的类有数据成员，第二个变体将确保成员函数的所有特化共享相同的数据，如果使用相同的仿函数对象。在第一个变体中，每个专业化都是一个不同的类，它有自己的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:22:06.927

对于没有状态的函子，这应该是相同的。经常（比较）您需要在仿函数中存储另一个相同类型的对象/引用/指针，而您的第二个选项在这种情况下不起作用。请注意，如果您的仿函数确实需要构造函数参数，您可以创建一个免费函数，`make_<foo>`例如`make_pair`为您推断类型并再次减少输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:34:43.043

就像作用域一样： in `functor1`，类中的任何东西都可以使用类型`Ape`（对于成员声明、参数和返回类型、特征或其他类型），而 in`functor2`仅`Ape`表示`operator()`. 简而言之：

*   定义时间：
    *   `functor1`需要知道`Ape`它是什么时候*创建的。*
    *   `functor2``Ape`在它被*调用*之前不需要知道。

**   类型范围：
    *   里面的一切都`functor1`知道`Ape`。
    *   只有`operator()`在`functor2`知道`Ape`。*   实例的多功能性：
    *   `functor1`实例仅适用于单一类型的`Ape`.
    *   `functor2`实例适用于任何类型的`Ape`.*

# asp.net-mvc - ASP.NET MVC 自定义控制器类

> ID：11434657
> 
> 赞同：1
> 
> 时间：2012-07-11T14:16:58.800
> 
> 标签：asp.net-mvc, asp.net-mvc-3

在 ASP.NET MVC 中，如何在不使用“控制器”后缀的情况下制作控制器类？我在网上找不到解决方案。MSDN 文档说控制器类名必须以“控制器”结尾。

有高手能帮帮我吗？

谢谢你。

杰瑞

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:45:29.697

`DefaultControllerFactory`您必须通过继承并覆盖该`GetControllerType`方法来使用自定义控制器工厂。

```
// instantiate controllers that doesn't have "Controller" suffix.
public class CustomControllerFactory: DefaultControllerFactory
{ 
    protected override Type GetControllerType(System.Web.Routing.RequestContext requestContext, string controllerName)
    {
        var controllersNs = "MvcApp.Controllers";
        return Type.GetType(string.Format("{0}.{1}", controllersNs, controllerName));
    }
} 
```

你必须在 Global.asax.cs 中注册这个控制器工厂。

```
ControllerBuilder.Current.SetControllerFactory(new CustomControllerFactory()); 
```

**重要提示**：`DefaultControllerFactory`通过缓存类型和其他内容来提高性能，您必须查看[源代码](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/944ab06b9c54#src/System.Web.Mvc/DefaultControllerFactory.cs)以获得更好的想法。

# jquery - ajaxForm().submit() 在 IE 中不起作用

> ID：11434659
> 
> 赞同：2
> 
> 时间：2012-07-11T14:17:01.117
> 
> 标签：jquery, ajax, ajaxform

我有以下代码用于在提交时上传图像的表单。在除 IE 之外的所有当前浏览器中都可以正常工作（没有版本工作）：

```
$('#photo-upload').live('change', function()
{
$('#'+currentId+' > img').css('opacity',0);
$('#'+currentId).addClass('hasImg');
index = currentId.replace(/place-/i, "");
$('#photo-index').val( index );
$("#imageform").ajaxForm({ target: '#photo-'+index }).submit();

// initialize photo settings
photo_x_pos = 0;
photo_y_pos = 0;
photo_angle = 0;

}); 
```

和表单 HTML：

```
<form id="imageform" action="/orders/photo_upload" method="post">
    <div id="upload">
        <input type="file" name="data[Photo][image]" id="photo-upload" />
    </div>
    <input type="hidden" name="data[Photo][index]" id="photo-index" />
<input type="hidden" name="data[Photo][width]" id="photo-width" />
<input id="uploadthephoto" type="submit" value="Submit"/>
</form> 
```

似乎 IE 中的问题是表单没有提交。`#photo-upload`是一个`<input type="file"/>`元素。`#imageform`是表单的id。所以理想情况下，当用户选择文件时，表单会提交目标`#photo-0`，并返回上传的图像。

难道我做错了什么？有没有其他方法可以提交不破坏 IE 的 ajaxForm？

# java - 是否可以自动优化 maven 依赖项？

> ID：11434660
> 
> 赞同：16
> 
> 时间：2012-07-11T14:17:07.487
> 
> 标签：java, maven, dependency-management

我正在开发一个由大约 40 个子项目组成的大项目，这些子项目的依赖关系非常不优化。有已声明的未使用的依赖项以及已使用但未声明的依赖项。当通过其他依赖项添加依赖项时，第二种情况是可能的。

我想删除多余的并添加所需的依赖项。我跑了`mvn dependency:analyze`，得到了一长串我现在必须修复的警告。

我想知道是否有 maven 插件或任何其他可以`pom.xml`自动更新我的文件的实用程序。我尝试手动完成，但需要很多时间。似乎需要几天的复制/粘贴才能完成任务。

在更糟糕的情况下，我可以自己编写这样的脚本，但可能存在现成的东西？

以下是`mvn dependency:analyze`报告依赖警告的方式：

```
[WARNING] Used undeclared dependencies found:
[WARNING]    org.apache.httpcomponents:httpcore:jar:4.1:compile
[WARNING] Unused declared dependencies found:
[WARNING]    commons-lang:commons-lang:jar:2.4:compile
[WARNING]    org.json:json:jar:20090211:compile 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T15:14:14.543

我不会说：**具有非常不优化的依赖关系。**只是有人没有做好他的工作，导致定义未使用的依赖项表明有人不了解构建工具是什么以及它是如何工作的。这可以与包含许多未使用导入的 Java 文件进行比较。在 Java 源中未使用的导入的情况下，这可以简单地由 IDE 处理，但对于 Maven 中的依赖项，不存在像已经表达的那样简单的方法，问题是各种 DI 等，这使得这项工作变得困难。您可以尝试将 dependency:analyze 的结果输出到脚本中（该目标存在一个选项），然后在清理依赖项后测试生成的构建。

运行可能是个好主意

```
mvn dependency:analyze -DscriptableOutput=true 
```

它产生的输出可以非常简单地从输出中提取出来，并且可以用于进一步处理，例如用作versions-maven-plugin的输入（带有一些预转换）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T14:57:32.600

我不建议自动清理依赖项。

1.  添加所有 'Used undeclared...' 会导致大多数传递依赖项的重复，从而导致花费更多时间来阅读和管理它们。

2.  删除所有“未使用的声明...”可能会导致运行时错误，因为它们是：由反射调用或特别声明以覆盖已在 3rd 方依赖项中使用的同一工件的版本（将其编译范围更改为运行时是更可取，而测试范围应保持不变以避免将它们泄漏到生产包中）或添加以声明使用某些 3rd 方库等的可选传递依赖项。

# port - 将连接器添加到图像

> ID：11434661
> 
> 赞同：0
> 
> 时间：2012-07-11T14:17:09.493
> 
> 标签：port, vector-graphics, connector

我使用 EXTjs 用 HTML 和 CSS 制作了一个简单的工具包和画布。我想简单地将连接器添加到拼图图像中以制作流程图。有关如何执行此操作的任何建议？我有几个拼图和一个输入框，我想最好用端口和线路连接它们，或者只是线路。

```
<!DOCTYPE HTML>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Drag and Draw Workflow Analysis Diagrams</title>
<script type="text/javascript" src="C:\Users\littleemi\Downloads\ext-4.1.0-commercial\extjs-4.1.0\ext.js"></script>
<script type="text/javascript" src="C:\Users\littleemi\Downloads\ext-4.1.0-commercial\extjs-4.1.0\adapter\ext\ext-base.js"></script>
<script type="text/javascript" src="C:\Users\littleemi\Downloads\ext-4.1.0-commercial\extjs-4.1.0\ext-all-debug.js"></script>  
<link rel="stylesheet" type="text/css" href="C:\Users\littleemi\Downloads\ext-4.1.0-commercial\extjs-4.1.0\resources\css\ext-all.css" />
<style type="text/css">
#headings{
font-family:Arial;
color: black;
font-size: 18px;

}
body  {
padding: 10px;

}

.availableWidgets {
width:                 250px;
border-style:          solid;
border-width:          10px;    
padding:               10px;
height:                800px;
-moz-border-radius:    17px;
-webkit-border-radius: 17px;

}

.canvas{
width:                 1300px;
border-style:          solid;
border-width:          10px;    
padding:                10 px;
height:                 800px;
-moz-border-radius:     17px;
-webkit-border-radius:  17px;
}
.availableWidgets div {
border-style:          none;
padding:               3px;
margin:                20px;
cursor:                move;
text-align:            center;
}

.imgThumb {
border-style: none;
height:  100px;
width:   100px;
display: block;  
cursor: move;
margin-left: auto;   
margin-right: auto; 

}

.dropOK {
background-color: #99ff99 !important;
}

.dropNotOK {
border: 1px solid #FF0000 !important;
}

fieldset {
border: 3px solid #781351;
}

</style>

</head>
<body>
<table class="x-unselectable">
<tr>
<td>
<table>
<tr>
<td align='center'>
<h1 id="headings">Available Widgets</h1>
</td>
</tr>

<tr>
<td>
<div id="widgets" class="availableWidgets">
<div><img src="blue_IP.png" class="imgThumb" title="IP Widget" alt="IP Widget"/></div>
<div><form action="ETservlet2" method="post">
<fieldset>
Enter URL: <input type="text" name="first" value=""/>
<input type="submit" value="Submit"/>
</fieldset>
</form></div>
<div><img src="redPiece.png" class="imgThumb" title="IP Widget" alt="IP Widget"/></div>
<div><img src="orangePiece.png" class="imgThumb" title="IP Widget" alt="IP Widget"/>
</div>
<div><img src="maroonPiece.png" class="imgThumb" title="IP Widget" alt="IP Widget"/></div>
<div><img src="yellowPiece.png" class="imgThumb" title="IP Widget" alt="IP Widget"/></div>

</div>
</td>
</tr>

</table>
</td>
<td align='center' style="width: 200px;">
<table>
<tr>
<td align='center' style="width: 200px;">
<h1 id="headings">Workflow Area</h1>
</td>

</tr>
<tr  style="">
<td style="">
<div id="Canvas" class="availableWidgets canvas">

</div>
</td>

</tr>

</table>
</td>
</tr>
</table>

<script type="text/javascript">

Ext.onReady(function() {
Ext.QuickTips.init();
// A list of method overrides
var overrides = {
//Called when mousedown for a specific amount of time
b4StartDrag : function() {
if (!this.el) {
this.el = Ext.get(this.getEl());
}
//this.el.highlight();
//Cache the original XY Coordinates of the element, we'll use this later.
this.originalXY = this.el.getXY();
},
// Called when element is dropped not anything other than a
// dropzone with the same ddgroup
onInvalidDrop : function() {
this.invalidDrop = true;
},
endDrag : function() {
if (this.invalidDrop === true) {
this.el.removeClass('dropOK');

var animCfgObj = {
easing   : 'elasticOut',
duration : 1,
scope    : this,
callback : function() {
this.el.dom.style.position = '';
}
};
this.el.moveTo(this.originalXY[0], this.originalXY[1], animCfgObj);
delete this.invalidDrop;
}

}
};

// Configure the widgets to be draggable
var widgetElements = Ext.get('widgets').select('div');
Ext.each(widgetElements.elements, function(el) {
var dd = new Ext.dd.DD(el, 'widgetsDDGroup', {
isTarget  : false
});
Ext.apply(dd, overrides);
});

//Instantiate instances of Ext.dd.DDTarget for the widgets container
var widgetsDDTarget    = new Ext.dd.DDTarget('widgets','widgetsDDGroup');

//Instantiate instnaces of DDTarget for the canvas drop target elements
var canvasDDTarget = new Ext.dd.DDTarget('Canvas', 'widgetsDDGroup');

//Ensure that the rented and repair DDTargets will participate in the trucksDDGroup
//canvasDDTarget.addToGroup('widgetsDDGroup');

});

</script>       

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T05:17:22.217

jsPlumb 令人印象深刻，完全符合您的描述：http: [//jsplumb.org/jquery/demo.html](http://jsplumb.org/jquery/demo.html)

# asp.net-mvc - DevExpress MVC GridView - SetDropDownWindowTemplateContent

> ID：11434663
> 
> 赞同：1
> 
> 时间：2012-07-11T14:17:10.757
> 
> 标签：asp.net-mvc, gridview, devexpress

我正在开发 DevExpress gridview，发现函数调用的文档严重缺乏。在我所见的任何地方，SetDropDownWindowTemplateContent(string content) 都没有字符串内容是什么或看起来像什么的例子。我试过简单地做“Option1；Option2（因为 devexpress 声明 ';' 是分隔符）但它不起作用。

请帮忙，把我的头发拉出来。

```
settings.Columns.Add(col =>
{
    col.FieldName = "DefaultValue";
    col.Caption = "Rule Type Value";
    col.Width = 300;
    col.ColumnType = MVCxGridViewColumnType.DropDownEdit;
    col.SetEditItemTemplateContent(column =>
    {
        Html.DevExpress().DropDownEdit(c =>
        {
            c.Name = "ddlName";
            c.SetDropDownWindowTemplateContent("WHAT GOES HERE!?!?!");
        }).Render();
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:11:42.917

查看[此](http://demos.devexpress.com/MVC/Editors/DropDownEdit)演示以了解有关如何使用此方法的更多信息。

```
settings.SetDropDownWindowTemplateContent(c => {
    Html.DevExpress().ListBox(
        listBoxSettings => {
            ...
        }
    ).Render();
}); 
```

# qt - 安装多个版本的 Qt 库

> ID：11434670
> 
> 赞同：2
> 
> 时间：2012-07-11T14:17:21.173
> 
> 标签：qt, qt4, qt-creator

我已经在 windows 中安装了 QtSDK，它的 Qt 库版本是 4.7.0。现在我想为 mingw 和 VS2008 安装 Qt 库版本 4.8.2。我怎样才能做到这一点？QtCreator如何引入多个版本？

注意：我已经从[http://qt.nokia.com/downloads下载了库](http://qt.nokia.com/downloads)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T16:39:47.273

你当然可以。只需将库提取到不同的位置并设置 Qt Creator 以使用它们。您可以在这里找到方法：http: [//doc.qt.io/qtcreator/creator-project-qmake.html](http://doc.qt.io/qtcreator/creator-project-qmake.html)。

然后，您可以选择要在每个项目的属性中编译使用的配置。

# python - 有没有办法腌制 FTP 对象？

> ID：11434671
> 
> 赞同：2
> 
> 时间：2012-07-11T14:17:26.057
> 
> 标签：python, ftp, multiprocessing, pickle, ftplib

我正在使用 Python 的多处理通过 FTP 进行批量下载。但是，当我尝试打开超过 5 个 ftp 会话时，会引发 EOFError，这意味着主机因为打开太多会话而断开了我的连接。

我看到的唯一解决方案是打开一个 FTP 对象并将其传递给必要的方法。问题是因为多处理使用酸洗来移动对象，而 FTP 对象不能酸洗，这是不可能的。因此，我的问题是是否可以通过找到一种腌制 FTP 对象的方法来解决这个问题？

我的代码采用以下形式：

```
def get_file(name):
    #code here    

def worker(name_list, out_q):
    lst = []
    for name in name_list:
        lst.append(get_file(name))
    out_q.put(lst)

if __name__ == '__main__':

    #est ftp cnxn
    ftp = FTP('ftp.blah.blah', 'anonymous', 'meow')

    #multiprocessing code here 
```

get_file def 需要访问 ftp 连接，如果我把它放在`if __name__ == '__main__'`块之外，那么每次进程运行代码时都会创建一个新的 ftp 连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:28:17.597

您可以通过创建一个包装 FTP 对象的 pickleable 类来解决该问题。本质上，您在包装类中绑定 FTP 构造函数参数，然后一旦在远程主机上反序列化，FTP 对象就会在那里实例化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:34:53.443

我真的不明白你为什么要这样做：

*   创建一堆进程来并行下载东西
*   但只使用一个 FTP 对象，实际上是序列化下载

这究竟如何解决您的问题？

但是，不是序列化 FTP 对象，而是为 FTP 请求创建一个进程并设计一种与该进程通信的迷你语言 - 让您的其他进程发送（易于腌制）形式的消息`get src dst`。

**编辑：**刚刚检查了`[ftplib][1]`. 它没有说它可以处理多个呼叫。假设没有！

所以，我会这样做：

*   创建`MAX_CONNECTIONS`（例如 5 个）FTP 工作进程
*   联系具有要检索的文件队列的主进程
*   工作进程从队列中检索任务，下载文件并检查 master 是否有新的事情要做
*   重复直到工作完成

# c# - Bitmap.Save 保存一个图标实际上保存了一个.png

> ID：11434673
> 
> 赞同：3
> 
> 时间：2012-07-11T14:17:28.133
> 
> 标签：c#, bitmap, icons, png, system.drawing

我需要编写一个程序，该程序将基于tileset 图像生成108 个图标组合（标准Windows .ico 文件）。

我使用类 System.Drawing.Bitmap 来构建每个组合，并像这样保存它们：

```
Bitmap IconBitmap = new Bitmap(16, 16);
// Some processing, writing different parts of the source tileset
// ...
IconBitmap.Save(Path.Combine(TargetPath, "Icon" + Counter + ".ico"),
                ImageFormat.Icon); 
```

但是我发现保存的文件实际上是PNG。Windows Explorer 和 Visual Studio 都不能正确显示它，但 GIMP 可以，如果我在 Hex 查看器中打开它，我看到的是：

```
00000000  89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52  ‰PNG........IHDR
00000010  00 00 00 10 00 00 00 10 08 06 00 00 00 1F F3 FF  ..............óÿ
00000020  61 00 00 00 01 73 52 47 42 00 AE CE 1C E9 00 00  a....sRGB.®Î.é..
00000030  00 04 67 41 4D 41 00 00 B1 8F 0B FC 61 05 00 00  ..gAMA..±..üa...
00000040  00 09 70 48 59 73 00 00 0E C3 00 00 0E C3 01 C7  ..pHYs...Ã...Ã.Ç
00000050  6F A8 64 00 00 00 15 49 44 41 54 38 4F 63 60 18  o¨d....IDAT8Oc`.
00000060  05 A3 21 30 1A 02 A3 21 00 09 01 00 04 10 00 01  .£!0..£!........
00000070  72 A5 13 76 00 00 00 00 49 45 4E 44 AE 42 60 82  r¥.v....IEND®B`‚ 
```

此外，如果我将 .ico 重命名为 .png，Windows 资源管理器可以正确显示它。

即使我在位图上什么都不做，我也会得到这个结果（我直接用它构建它`new`，`Save`这给了我一个黑色的 png）。

我究竟做错了什么？

我也试过这个，它给了我可怕的 16 色图标，但我宁愿避免这个解决方案（使用句柄）：

```
Icon NewIcon = Icon.FromHandle(IconBitmap.GetHicon());
FileStream FS = new FileStream(Path.Combine(Target, "Icon" + Counter + ".ico"),
        FileMode.Create);
NewIcon.Save(FS); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T08:44:00.263

我自己做了一个快速而肮脏的解决方法，我把它贴在这里记录下来（它可能会帮助像我这样需要快速解决方案的人）。

我不会接受这是正确的答案，它不是真正的图标作者。它只是将 32 位 ARGB 位图写入 ico 文件，使用 PNG 格式（适用于 Vista 或更高版本）

它基于维基百科的[ICO 文件格式](http://en.wikipedia.org/wiki/ICO_%28file_format%29)文章，有些失败并重试。

```
void SaveAsIcon(Bitmap SourceBitmap, string FilePath)
{
    FileStream FS = new FileStream(FilePath, FileMode.Create);
    // ICO header
    FS.WriteByte(0); FS.WriteByte(0);
    FS.WriteByte(1); FS.WriteByte(0);
    FS.WriteByte(1); FS.WriteByte(0);

    // Image size
    FS.WriteByte((byte)SourceBitmap.Width);
    FS.WriteByte((byte)SourceBitmap.Height);
    // Palette
    FS.WriteByte(0);
    // Reserved
    FS.WriteByte(0);
    // Number of color planes
    FS.WriteByte(0); FS.WriteByte(0);
    // Bits per pixel
    FS.WriteByte(32); FS.WriteByte(0);

    // Data size, will be written after the data
    FS.WriteByte(0);
    FS.WriteByte(0);
    FS.WriteByte(0);
    FS.WriteByte(0);

    // Offset to image data, fixed at 22
    FS.WriteByte(22);
    FS.WriteByte(0);
    FS.WriteByte(0);
    FS.WriteByte(0);

    // Writing actual data
    SourceBitmap.Save(FS, ImageFormat.Png);

    // Getting data length (file length minus header)
    long Len = FS.Length - 22;

    // Write it in the correct place
    FS.Seek(14, SeekOrigin.Begin);
    FS.WriteByte((byte)Len);
    FS.WriteByte((byte)(Len >> 8));

    FS.Close();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-07T22:46:24.043

这是我今天写的一个简单的 ICO 文件编写器，它可以将多个`System.Drawing.Image`图像输出到一个文件中。

```
// https://en.wikipedia.org/wiki/ICO_(file_format)

public static class IconWriter
{
    public static void Write(Stream stream, IReadOnlyList<Image> images)
    {
        if (images.Any(image => image.Width > 256 || image.Height > 256))
            throw new ArgumentException("Image cannot have height or width greater than 256px.", "images");

        //
        // ICONDIR structure
        //

        WriteInt16(stream, 0); // reserved
        WriteInt16(stream, 1); // image type (icon)
        WriteInt16(stream, (short) images.Count); // number of images

        var encodedImages = images.Select(image => new
        {
            image.Width,
            image.Height,
            Bytes = EncodeImagePng(image)
        }).ToList();

        //
        // ICONDIRENTRY structure
        //

        const int iconDirSize = 6;
        const int iconDirEntrySize = 16;

        var offset = iconDirSize + (images.Count*iconDirEntrySize);

        foreach (var image in encodedImages)
        {
            stream.WriteByte((byte) image.Width);
            stream.WriteByte((byte) image.Height);
            stream.WriteByte(0); // no pallete
            stream.WriteByte(0); // reserved
            WriteInt16(stream, 0); // no color planes
            WriteInt16(stream, 32); // 32 bpp

            // image data length
            WriteInt32(stream, image.Bytes.Length);

            // image data offset
            WriteInt32(stream, offset);

            offset += image.Bytes.Length;
        }

        //
        // Image data
        //

        foreach (var image in encodedImages)
            stream.Write(image.Bytes, 0, image.Bytes.Length);
    }

    private static byte[] EncodeImagePng(Image image)
    {
        var stream = new MemoryStream();
        image.Save(stream, ImageFormat.Png);
        return stream.ToArray();
    }

    private static void WriteInt16(Stream stream, short s)
    {
        stream.WriteByte((byte) s);
        stream.WriteByte((byte) (s >> 8));
    }

    private static void WriteInt32(Stream stream, int i)
    {
        stream.WriteByte((byte) i);
        stream.WriteByte((byte) (i >> 8));
        stream.WriteByte((byte) (i >> 16));
        stream.WriteByte((byte) (i >> 24));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:32:28.437

确实，`ImageFormat.Icon`正如您所想的那样，它不能用于编写，.NET 根本不支持编写 .ico 文件，而只是转储 PNG 数据。

[CodeProject](http://www.codeproject.com/Articles/6171/Access-multiple-icons-in-a-single-icon-file)上有几个项目（还有[这个](http://www.codeproject.com/Articles/7122/Dynamically-Generating-Icons-safely)）（还有[另一个](http://www.codeproject.com/Articles/16178/IconLib-Icons-Unfolded-MultiIcon-and-Windows-Vista)），可以让你写一个`.ico`文件，实际上并不难。[文件格式](http://en.wikipedia.org/wiki/ICO_%28file_format%29)非常简单，支持 BMP 和 PNG 数据。

# javascript - jQuery最后一个事件触发两次

> ID：11434675
> 
> 赞同：1
> 
> 时间：2012-07-11T14:17:29.683
> 
> 标签：javascript, jquery, ajax

我正在使用以下代码构建一个 jQuery 树样式列表。每个 API 调用（除了最后一个）都会吐出 N 多个 LI，如下所示。最后吐出一张桌子让我放入另一个div。

```
<li><a data-category="SOMECATEGORY" data-id="SOME ID">SOMETHING</a><ul><!-- AJAX --></ul></li> 
```

导航树时会发生以下情况：

*   单击浏览 - 1 个 HTTP 请求`../api/browse.php?do=getLocations`
*   单击其中一个位置 - 1 个 HTTP 请求`../api/browse.php?do=getFloors&location-id=ID_OF_JUST_CLICKED`
*   单击其中一个楼层 - 1 个 HTTP 请求`../api/browse.php?do=getEquipment&floor-id=ID_OF_JUST_CLICKED`
*   单击其中一台设备 - 2 个 HTTP 请求`../api/browse.php?do=buildTables&location_id=' + browseList['location_id'] + '&floor_id=' + browseList['floor_id'] + '&device_type=' + browseList['device_type']`

奇怪的是最后一次点击事件触发了两次。警告框显示它是被击中两次的同一个对象。这只发生在最后一个元素上。无论有多少设备，它都会发生。

```
 var browseList = [];
$("#Browse").click(buildBrowseMenus);

function buildBrowseMenus() {

    if(!this.isOpen) {
     this.isOpen = true;

     $child = $(this).parent().children("ul");

     $child.html('<div class="ui-widget">Loading...</div>');

     //Determine which category we are on.  If we know what category type is clicked
     // We will know which API call to make as the list goes:
     // Browse -> Locations -> Floors -> Equipment Type -> location number

     var category = $(this).data("category");
     switch (category) {

        //First list level, build out the locations
        case undefined:
            $child.load('../api/browse.php?do=getLocations');
        break;

        //Second list level, build out the floors for a given location
        case 'locations':
            browseList['location_id'] = $(this).data("id");
            $child.load('../api/browse.php?do=getFloors&location-id=' + $(this).data("id"));
        break;

        //Third list level, build out the Equipment for a given floor
        case 'floors':
            browseList['floor_id'] = $(this).data("id");
            $child.load('../api/browse.php?do=getEquipment&floor-id=' + $(this).data("id"));
        break;

        //If one of the pieces of equipment is clicked build the main tables
        case 'equipment':
            alert(JSON.stringify(this));
            browseList['device_type'] = $(this).data("id");
            $child.html('');
            $("#listStuffBody").load('../api/browse.php?do=buildTables&location_id=' + browseList['location_id'] + '&floor_id=' + browseList['floor_id'] + '&device_type=' + browseList['device_type']);
            return;
        break;
     }

     $child.delegate("a","click",buildBrowseMenus);

    }else{
      var $child = $(this).parent().children("ul");
      $child.html('');
      this.isOpen = false;

    }
} 
```

问题是什么？最后一次点击应该只触发一次。

编辑::: 单击 (Browse->Location 1->First Floor->Car) 时的 DOM 如下所示

```
<li>
    <a id="Browse">Browse</a>
    <ul>
        <li>
        <a data-id="2" data-category="locations">LOCATION 1</a>
        <ul>
            <li>
            <a data-id="2" data-category="floors">First Floor</a>
            <ul>
                <li>
                <a data-id="truck" data-category="equipment">truck</a>
                <ul><!-- -- AJAX ----></ul>
                </li>

                <li>
                <a data-id="car" data-category="equipment">car</a>
                <ul><div class="ui-widget">Loading...</div></ul>
                </li>

                <li><a data-id="boat" data-category="equipment">voat</a>
                <ul><!-- -- AJAX ----></ul>
                </li>
            </ul>
            </li>
        </ul>
        </li>

        <li>
        <a data-id="1" data-category="locations">Location 2</a>
        <ul><!-- -- AJAX ----></ul>
        </li>
    </ul>
</li> 
```

编辑:: 不同的路径（位置 2）

```
<li>
<a id="Browse">Browse</a>
<ul>
    <li>
    <a data-id="2" data-category="locations">Location 1</a>
    <ul><!-- -- AJAX ----></ul>
    </li>

    <li>
    <a data-id="1" data-category="locations">Location 2</a>
    <ul>
        <li>
        <a data-id="3" data-category="floors">First Floor</a>
        <ul>
            <li>
            <a data-id="truck" data-category="equipment">truck</a>
            <ul></ul>
            </li>

            <li>
            <a data-id="car" data-category="equipment">car</a>
            <ul></ul>
            </li>

            <li>
            <a data-id="boat" data-category="equipment">boat</a>
            <ul><!-- -- AJAX ----></ul>
            </li>
        </ul>
        </li>

        <li>
        <a data-id="4" data-category="floors">Second Floor</a>
        <ul><!-- -- AJAX ----></ul>
        </li>

        <li>
        <a data-id="5" data-category="floors">Third Floor</a>
        <ul><!-- -- AJAX ----></ul>
        </li>

        <li>
        <a data-id="6" data-category="floors">Fourth Floor</a>
        <ul><!-- -- AJAX ----></ul>
        </li>
    </ul>
    </li>

</ul>
</li> 
```

# ruby-on-rails - 重命名作为基类子类的 ActiveRecord 模型时如何迁移数据库？

> ID：11434678
> 
> 赞同：2
> 
> 时间：2012-07-11T14:17:36.567
> 
> 标签：ruby-on-rails, activerecord

当模型使用单表继承 (STI) 存储在数据库中时，如何编写 Rails 迁移以重命名 ActiveRecord 子类？我唯一能想到的就是使用原始的 sql 更新语句将类型列值的值从旧的子类型名称更改为新的名称。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T14:46:00.393

您可以使用[`execute`](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/DatabaseStatements.html#method-i-execute)在迁移中运行原始查询

```
class YourMigration < ActiveRecord::Migration
  def up
    execute "UPDATE table_name SET type = 'Namespace::NewSubclass' WHERE type = 'Namespace::OldSubclass'"
  end

  def down
    execute "UPDATE table_name SET type = 'Namespace::OldSubclass' WHERE type = 'Namespace::NewSubclass'"
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-01T14:00:09.933

Rails 4 允许您[`reversible`](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html#method-i-reversible)为@deefour 的回答定义迁移：

```
def change
  rename_sti_type :table_name, 'Namespace::OldSubclass', 'Namespace::NewSubclass'
end

def rename_sti_type(table_name, old_type, new_type)
  reversible do |dir|
    dir.up { execute "UPDATE #{table_name} SET type = '#{new_type}' WHERE type = '#{old_type}'" }
    dir.down { execute "UPDATE #{table_name} SET type = '#{old_type}' WHERE type = '#{new_type}'"}
  end
end 
```

您可以将其概括为一种`change_data(table, field, old_value, new_value)`方法；但请注意，如果向上迁移将类型/字段设置`new_value`为已在使用的 a，那么向下迁移也会将已经具有`new_value`值的现有行更改为`old_value`.

# c# - 用户代码未处理 NullRefrenceException

> ID：11434683
> 
> 赞同：2
> 
> 时间：2012-07-11T14:17:49.557
> 
> 标签：c#, asp.net

下面的代码放在 page_Load 中。当您第一次直接进入页面并且没有引荐来源网址时，我应该如何处理以绕过 UrlReferrer？我在这里缺少什么？

```
 if (HttpContext.Current.Request.UrlReferrer.AbsoluteUri != null)
    {
        urlReferer = HttpContext.Current.Request.UrlReferrer.AbsoluteUri.ToString();
    }
    else
    {
        urlReferer = "";
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T14:19:59.187

只需检查`UrlReferrer`空值：

```
if (HttpContext.Current.Request.UrlReferrer != null 
    && HttpContext.Current.Request.UrlReferrer.AbsoluteUri != null)
{
     urlReferer = HttpContext.Current.Request.UrlReferrer.AbsoluteUri.ToString();
}     
else     
{         
    urlReferer = "";     
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T14:19:40.483

谁说客户端在 HTTP 请求中是通过referer 传递的？

检查是否`UrlReferrer`是`null`第一个

```
if (HttpContext.Current.Request.UrlReferrer != null)
    {
        urlReferer = HttpContext.Current.Request.UrlReferrer.AbsoluteUri.ToString();
    }
    else
    {
        urlReferer = "";
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T14:25:39.907

为什么不这样比检查空值更干净

```
private void Page_Load()
{
    if (!IsPostBack)
    {
        if (HttpContext.Current.Request.UrlReferrer != null)
        {
            urlReferer = HttpContext.Current.Request.UrlReferrer.AbsoluteUri.ToString();
        }
        else
        {
            urlReferer = "";
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-11T14:19:48.407

我相信你需要检查是否`HttpContext.Current.Request.UrlReferrer != null`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T14:20:23.960

如果 UrlReferrer 为 null，则对 AbsolutUri 的测试将失败。

尝试最初测试 UrlReferrer 是否为空，这可能会纠正问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-11T14:22:09.910

使用您的调试器。如果您在 Visual Studio 之外运行它，那么当抛出异常时，您可能会被带到调试器窗口。调试器底部有多个选项卡，包括“Locals”和“Watch”，您可以使用它们查看正在存储的变量。

如果上面的代码确实是导致问题的原因

`HttpContext.Current.Request.UrlReferrer.AbsoluteUri`
或
`HttpContext.Current.Request.UrlReferrer`
或
`HttpContext.Current.Request`
或
`HttpContext.Current`
或
`HttpContext`

设置为空

# php - 是否可以在 PHP 中创建和运行线程？

> ID：11434686
> 
> 赞同：-2
> 
> 时间：2012-07-11T14:17:59.900
> 
> 标签：php

当显示一个 PHP 页面时，我想启动一个线程来搜索在 MySQL 表列中输入的最后一个值，以便文本输入字段的值应该是这个最后一个值增加 1（它是一个数字）。我想要一个线程，因为页面可能会显示很长时间，并且在那段时间列可能已经更新了很多次，所以我想获取每个时间间隔的值。单击提交按钮时，该值应该是列中的最后一个。那可能吗 ？

* * *

考虑这种情况：

一位用户显示页面，因此该字段包含递增的值。然后另一个用户显示相同的页面，因此该字段也包含相同的递增值。当他们提交表单时，就会出现并发问题，因为他们提交了相同的增量数据！那么如何解决这种情况呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:32:29.523

> 一位用户显示页面，因此该字段包含递增的值。然后另一个用户显示相同的页面，因此该字段也包含相同的递增值。当他们提交表单时，就会出现并发问题，因为他们提交了相同的增量数据！那么如何解决这种情况呢？

您将无法实时了解最高值的所有可能变化。定期获取值的基于 Ajax 的解决方案将不够快速和可靠。如果最高值恰好在我的请求到达服务器所需的 100 毫秒内发生变化，会发生什么？如果用户的网络连接暂时中断，他点击“保存”，两个值最终相互覆盖怎么办？

*通常*的解决方案是不在用户界面中确定最高值，而是*在将记录存储到数据库中时确定*。自动实现此效果的一种方法是在数据库中使用自动增量字段。

如果您绝对*需要*向用户显示当前值，则需要使用某种锁定机制。IE。确定当前最高值，并为当前用户保留该值，直到他们保存记录或离开页面。但是根本没有办法以 100% 可靠的方式向每个用户显示最高电流值。你*会*以这种方式结束碰撞。就像@NB 在评论中所说的那样，您可能应该重新考虑您的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:30:14.450

您可以通过 AJAX 轻松实现这一点，例如每 1 分钟异步调用一次数据库或控制器 - 或者可能在特定的鼠标事件上 - 并返回 JSON 数据或带有显示数据的视图。许多流行的社交网站这样做是为了在其主页上显示最新的提要/数据。

更多信息：[http ://ajaxpatterns.org/Periodic_Refresh](http://ajaxpatterns.org/Periodic_Refresh)

# git - 显示 git 中每个分支的最新提交

> ID：11434687
> 
> 赞同：3
> 
> 时间：2012-07-11T14:18:00.317
> 
> 标签：git

有没有办法在 git 中显示每个分支的最新提交？

我在 git 中有一个代码库，我已经设置了一段时间。它有几个分支用于不同的功能。我需要进入并更新/排除一些代码故障但是我选择过于笼统地命名它们，现在我无法说出我最后在处理哪个，甚至哪个有我的功能。

理想情况下，我希望查看每个分支中的最后一次提交，以了解我最后一次离开的地方。有没有命令可以做到这一点？我只需要看看我最后在哪里工作。我想避免切换到每个分支并查看其日志。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T14:21:00.473

```
git branch -v 
```

将在其第二列中显示最近提交的 SHA1 的（简短形式）以及之后的描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:52:01.320

`git show <name_of_the_branch>`

将显示分支的最新提交`<name_of_the_branch>`

# c# - Membership.GetUser() // GetUser(userName) 返回一个空用户

> ID：11434689
> 
> 赞同：0
> 
> 时间：2012-07-11T14:18:28.203
> 
> 标签：c#, asp.net, security

我正在尝试获取 System.Web.Security.MembershipUser 用户，以便检查它的 lastPasswordChangedDate 属性，唯一的问题是它返回 null。

我环顾四周，大多数类似的问题似乎是因为用户在尝试创建对象时没有经过身份验证。在我的情况下，用户在调用该方法之前直接进行了身份验证，尽管是在另一个类中。

任何指针？

伪代码如下：

前端----> Login.cs

```
string userName = txtUser.Text; string password = txtPW.Text;
wsAuth = new wsAuth();
wsAuthentication.Authenticate(userName,password); 
```

认证服务---->

```
public bool Authenticate(string userName, string password) 
{
SecurityProviderSettings settings = SecurityProviderSettings.GetFromConfiguration("SecurityProviders");
ProviderSetting providerSetting = settings.Providers[providerName];
object provider = Activator.CreateInstance(providerType);
return ((IAuthenticationProvider)provider).Authenticate(userName, password, providerSetting.CustomInfo, out failReason, out token);
} 
```

特定提供者---->

```
public bool Authenticate(string userName, string password, out string failReason .....)
{
SqlMembershipProvider provider = new SqlMembershipProvider();

#region settings
//blablabla
#endregion 

provider.initialize(/*input vars*/);
bool authenticated = provider.ValidateUser(userName,password);
if(authenticated)
{
 pwValidator val = new pwValidator();
  if(!val.IsInLifetime(userName,password))
   {
     failReason = "password expired";
   }

}
} 
```

密码验证器---->

```
 public bool IsInLifetime(string userName, string password)
 {
MembershipUser user = Membership.GetUser(userName);
MembershipUser user2 = Membership.GetUser();
#bla bla bla
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:24:58.143

尝试这样的事情。创建获取用户的方法

```
 HttpContext httpContext = HttpContext.Current;
        if (httpContext != null && httpContext.User != null && httpContext.User.Identity.IsAuthenticated)
        {
            return Membership.GetUser();
        } 
```

# ios - 重新启动应用程序后 NSURLConnection 总是失败

> ID：11434691
> 
> 赞同：0
> 
> 时间：2012-07-11T14:18:34.980
> 
> 标签：ios, ios5, nsurlconnection, nsurlrequest

我意识到这是一个模糊的问题，但我想知道是否有其他人观察到这一点。这是我调用 NSURLConnection 的代码

```
 // Get data from server
    NSString *host = @"www.hostname.com";            
    NSString *urlString = [NSString stringWithFormat:@"/theRestOfTheURL"];
    NSURL *url = [[NSURL alloc] initWithScheme:@"http" host:host path:urlString];

    DLog(@"URL is %@", url);

    // Create the NSMutableData to hold the received data.
    // receivedData is an instance variable declared elsewhere.
    receivedData_ = [[NSMutableData data] retain];

    NSURLRequest *theRequest=[NSURLRequest requestWithURL:url
                                              cachePolicy:NSURLRequestUseProtocolCachePolicy
                                          timeoutInterval:15.0];

    // create the connection with the request
    // and start loading the data
    self.powerPlantDataConnection = [[[NSURLConnection alloc] initWithRequest:theRequest delegate:self] autorelease];

    [url release]; 
```

当我第一次加载应用程序时，它运行良好，我可以重复调用它而没有任何问题。但如果我关闭应用程序并重新打开它，

```
(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error 
```

每次都会调用委托方法，并显示请求超时错误消息。我有两个不同的视图控制器，我在其中调用两个不同的 URL，并且每次关闭并重新打开应用程序后它们都会失败。

谁能想到为什么会发生这种情况？我不确定从哪里开始寻找。请求超时错误的原因可能是什么？该请求应该没有任何问题，因为它在我第一次运行应用程序时有效。

* * *

编辑补充说，我似乎只在我的设备上遇到这个问题，而不是在模拟器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T15:07:41.257

*希望您共享了一些 chrash 日志（尤其是具有明确定义的 `[error localizedDescription]`类方法..）*

正如您所说，它将超时（您的请求）。而且由于您创建对象的方式太杂乱，因此您的系统工作量更大。我建议在下载数据时使用[GCD](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)，尤其是在像您这样的情况下，具有不同的接口和 url..

**一个建议** *您可以像这样创建您的 url 对象：*

```
 NSURL *url = [NSURL urlWithString:[NSString stringWithFormat:@"http://%@/%@?key1=%@&key2=%@", yourDomain, targetFile, value1, value2]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:19:44.557

I switched over to using ASIHTTPRequest, which improved things but I would still get stuck in situations where I was getting timed out errors every time I tried to refresh. I looked and asked around, and eventually found that disabling calls to TestFlight solved my issue. More information here:

[ASIHTTPRequest request times out](https://stackoverflow.com/q/11604162/472344)

and here:

[github.com/pokeb/asi-http-request/issues/320](http://github.com/pokeb/asi-http-request/issues/320)

# javascript - 查找以给定搜索字符串开头的单词数量 - 正则表达式

> ID：11434692
> 
> 赞同：0
> 
> 时间：2012-07-11T14:18:40.710
> 
> 标签：javascript, jquery

我正在使用正则表达式来搜索酒店列表。有“testing hotel plaza”、“testing2 newhotel plaza”、“plaza hotel”等名称……

基本上我的要求是，如果用户输入 plaza，那么所有酒店都应该填充其中包含“Plaza”......但如果用户输入“aza”，则不应填充任何结果。简而言之，在给定的字符串中，我需要查找是否有任何以用户输入的字符串开头的单词，如果是，则显示结果。

这是我被卡住并且无法正常工作的代码。

```
var regex = new RegExp("/\b"+searchString, "gi");
if (mainString.match(regex))
{
    return true;
} 
```

这是有效的，但即使它是中间字符或在我不想要的任何位置，它也会找到所有出现的位置。

```
var regex = new RegExp(searchString , "gi");
if (mainString.match(regex))
{
    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:30:56.480

像这样调用`RegExp`构造函数时，正则表达式不包含在斜杠 ( `/.../`) 中，但您的字符串中有一个前导正斜杠。此外，转义序列反斜杠需要自己转义，所以你应该使用的是

```
var regex = new RegExp("\\b"+searchString, "gi"); 
```

**编辑：**

是的，因为`\b`是相对于 定义的`[A-Za-z0-9_]`，所以当涉及到非 ASCII 字符时，这确实是有问题的。您可能可以使用或多或少复杂的外观来解决它，但是一个更简单的解决方案很可能在这里解决问题，即`searchString`应该在开头*或空格字符之后*找到它：

```
var regex = new RegExp("(?:^|\\s)"+searchString, "gi"); 
```

# forms - Symfony：实体字段验证器和 ajax 动态内容

> ID：11434694
> 
> 赞同：1
> 
> 时间：2012-07-11T14:18:41.433
> 
> 标签：forms, symfony, entity, validation

我有 2 个实体（A 和 B），它们之间存在多对一关系。

我使用 A 实体创建表单，并使用实体字段（下拉列表）来显示 B 实体中的行。我使用查询生成器来过滤它们。如果不更改列表中的值（即使用 ajax），一切正常。

但是，如果我动态更改下拉列表中的值，当我提交表单时，我会收到此错误“此值无效”

这是因为提交的值不包含在查询生成器返回的“数组”中。

似乎这个验证在 symfony 中对于实体字段是自动的（我没有在这个字段上使用任何断言）。我想摆脱这个。但是如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T14:16:29.370

更明确地回答我的问题：

可以使用函数 BuildForm 中的事件侦听器重新定义 PRE_BIND 表单事件，如下例所示：

```
$factory = $builder->getFormFactory();

$builder->addEventListener(FormEvents::PRE_BIND, function($event) use ($factory) {
        $form = $event->getForm();
        $case = $event->getData();
        $id = $case['id'];

        if ($case) {
            $form->remove('id');
            $form->add($factory->createNamed('hidden', 'id',$id, array()));
        }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T12:16:33.683

对于 Symfony 2.3，您需要添加 auto_initialize = false 并更改参数的顺序：

```
$form->add($factory->createNamed('id', 'hidden', $id, array('auto_initialize' => false))); 
```

# objective-c - 限制 UILabelView 中的文本区域

> ID：11434700
> 
> 赞同：0
> 
> 时间：2012-07-11T14:19:03.137
> 
> 标签：objective-c, text, uilabel

我有一个占用大量空间的 UILabelView（它必须这样做）。但是，我希望其中的文本保持在其中的一个小区域内。我环顾四周，发现有一种方法可以在文本视图中包含文本可以占据的区域 - UILabelView 有类似的东西吗？所以我可以将文本保留在标签视图的 CGRect 中吗？谢谢你的帮助，山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T16:41:30.373

谢谢@Dustin - 基本上看起来唯一的方法是将它放入视图中。

# if-statement - AdMob 不能使用 IF 语句？

> ID：11434705
> 
> 赞同：0
> 
> 时间：2012-07-11T14:19:25.313
> 
> 标签：if-statement, locale, admob, ads

此代码不起作用。我检查了**displayLanguage**值。值是正确的（**displayLanguage="Türkçe"**）。但它不起作用。

```
private void setAdvertisement()
{

Locale _locale = Locale.getDefault();
String displayLanguage = _locale.getDisplayLanguage();
if(displayLanguage == "Türkçe")
{
    // Create the adView
    adView = new AdView(this, AdSize.BANNER, "My Admob ID");

    // Lookup your LinearLayout assuming it’s been given
    // the attribute android:id="@+id/mainLayout"

    // Add the adView to it
    linearLayoutAdvertisement.addView(adView);

    // Initiate a generic request to load it with an ad
    adView.loadAd(new AdRequest());
}
} 
```

但是这段代码工作正常：

```
private void setAdvertisement()
{
        // Create the adView
        adView = new AdView(this, AdSize.BANNER, "My Admob ID");

        // Lookup your LinearLayout assuming it’s been given
        // the attribute android:id="@+id/mainLayout"

        // Add the adView to it
        linearLayoutAdvertisement.addView(adView);

        // Initiate a generic request to load it with an ad
        adView.loadAd(new AdRequest());

} 
```

我不明白问题是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T17:43:29.977

这不是 AdMob 问题。但是试试这个：

```
if ("Türkçe".equals(displayLanguage)) {
  ..
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T15:17:15.570

我解决了问题。这对我有用：

```
if(Locale.getDefault().getLanguage().equals("tr"))
    {
        ...
    } 
```

# android - 以编程方式安装 Android apk

> ID：11434706
> 
> 赞同：2
> 
> 时间：2012-07-11T14:19:25.213
> 
> 标签：android, installation, apk, android-package-managers

我正在尝试从我们的文件服务器安装 APK，它需要静默完成，用户无法选择是否安装或接受权限设置/更改。这是一个合法的业务需求，因为我们正在与设备供应商合作将我们的应用程序预加载到 /system/app 中。这是一款定制的 Android 平板设备，因此，我们的业务部门希望确保我们可以推送应用更新（即强制使用最新版本）。

我了解通常的安全限制，但似乎有一种机制可以为供应商/制造商级别的应用程序静默安装应用程序。然而，关于如何做到这一点的信息似乎充其量只是参差不齐。

似乎软件包安装程序必须在 /system/app 中，并且安装程序必须具有与正在安装的应用程序相同的签名证书密钥。这不是问题，但我还没有找到有关如何使用此流程实现此功能的信息。

以前有人做过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:50:18.397

我相当肯定你需要给他们一个定制的 Android ROM，让你能够做到这一点（我怀疑他们的业务会喜欢）。

普通设备上的 Amazon App Store 无法像 Google Play 那样在后台静默安装。也许 Kindle Fire 可以做到这一点（我没有），但如果可以，那是因为它运行在亚马逊构建的自定义 ROM 上。

您可以做的最好的事情是启动一个意图，告诉用户需要更新应用程序，这会将他们带到安装程序活动，然后需要用户交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T15:01:31.917

不完全是答案。但是，我们最近遇到了对 android 客户端-服务器应用程序的类似要求。

每当应用程序通过请求联系服务器时，它也会发送当前版本代码。

```
PackageInfo pInfo = getPackageManager().getPackageInfo(getPackageName(), 0);
//pInfo.versionCode;
//pInfo.versionName; 
```

在服务器端，我们检查 versionCode，如果我们有新版本，通知客户端，客户端强制用户升级到新版本。客户端应用程序在升级到新版本之前将无法运行。但显然用户可以选择不安装等。

希望能帮助到你。

# objective-c - NSMutableURLRequest setValue: forHTTPHeaderField 是必需的吗？

> ID：11434711
> 
> 赞同：1
> 
> 时间：2012-07-11T14:19:40.727
> 
> 标签：objective-c, ios, cocoa-touch, nsurlrequest, nsmutableurlrequest

我已经看到了很多关于 http 请求的示例，并且大多数使用 setValue: 方法。但在我的代码中似乎没有必要。

我很好奇它是否真的需要，还是取决于对象与之通信的服务器？

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:01:10.747

简短的回答没有。长答案是这取决于您对请求的处理方式。例如，如果我正在与 Github 通信，那么我在“授权”http 标头字段中添加“基本 {BASE64_ENCODED_HASH}”以进行身份​​验证。您使用的服务可能需要您使用它的某些东西，但对于基本请求，这不是必需的。

# iphone - xmppframework iphone群聊得到“错误代码 - 404，收件人不可用”

> ID：11434720
> 
> 赞同：1
> 
> 时间：2012-07-11T14:20:03.113
> 
> 标签：iphone, xmppframework

我使用这个创建了新的群聊房间-

```
XMPPRoomCoreDataStorage *rosterstorage = [[XMPPRoomCoreDataStorage alloc] init];
XMPPRoom *xmppRoom = [[XMPPRoom alloc] initWithRoomStorage:rosterstorage jid:[XMPPJID jidWithString:@"viratsroom@conference.praveens-mac-mini.local"] dispatchQueue:dispatch_get_main_queue()];

[xmppRoom activate:[[self appDelegate] xmppStream]];
if ([xmppRoom preJoinWithNickname:@"viratsRoom"]) {
  NSLog(@"room created");
  [xmppRoom joinRoomUsingNickname:@"viratsroom11" history:nil];
}
[xmppRoom fetchConfigurationForm];
[xmppRoom configureRoomUsingOptions:nil];
[xmppRoom addDelegate:[self appDelegate] delegateQueue:dispatch_get_main_queue()]; 
```

正在创建房间但出现错误

我在服务器端进行了跟踪，发现了这个错误-

```
 "presence xmlns="jabber:client" from="viratsroom@conference.iisd09/arup" to="arup@iisd09/ClientXMPP" type="error" error code="404" type="wait"  recipient-unavailable xmlns="urn:ietf:params:xml:ns:xmpp-stanzas" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T11:25:26.523

房间没有正确配置，因此在创建房间后立即调用它的所有错误都不起作用-

```
[xmppRoom fetchConfigurationForm]; 
[xmppRoom configureRoomUsingOptions:nil]; 
```

创建房间需要一点时间，然后您可以配置房间。

```
[self performSelector:@selector(ConfigureNewRoom:) withObject:nil afterDelay:2]; 
```

谢谢

# html - Html Agility Pack 为 Nodecollection 返回 Null

> ID：11434723
> 
> 赞同：0
> 
> 时间：2012-07-11T14:20:09.497
> 
> 标签：html, parsing, html-agility-pack

我正在尝试解析一个包含许多表的 PHP 页面。现在，当我尝试选择这些表时，集合返回 null？

```
 Dim web As New HtmlAgilityPack.HtmlWeb()
    Dim htmlDoc As HtmlAgilityPack.HtmlDocument = web.Load("URL")
    Dim html As String

    Dim tabletag As HtmlNodeCollection = htmlDoc.DocumentNode.SelectNodes("//table")
    Dim tableNode As HtmlNode = htmlDoc.DocumentNode.SelectSingleNode("//table[@summary='List of services']")

    If Not tabletag Is Nothing Then
    html = tableNode.InnerText

    End If 
```

这个页面肯定有一些表格，只是不明白为什么它返回null？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T18:06:40.257

我在浏览器中加载了您的 URL 并查看了源代码，实际上我找不到任何表格。错误的网址？

# sql - 用于将 SQL 模式转换为 Korma 实体的代码生成工具

> ID：11434730
> 
> 赞同：10
> 
> 时间：2012-07-11T14:20:27.190
> 
> 标签：sql, clojure, korma

是否有将 SQL 模式转换为[Korma](http://sqlkorma.com/)实体的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T09:44:07.183

还没有，但您可以查询 DBMS 的数据字典以帮助您入门。

例如，在 MySQL 上，您可以从以下内容开始：

```
select concat('(defentity ', t.table_name ,')') as defentity
  from information_schema.tables t
  where table_schema = 'mySchema'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-01T20:41:36.953

这对我有用，需要一些想法来实施。我有点震惊，Korma 没有这个功能！（注意：我对 MSSQL 运行了这个）

```
(defentity INFORMATION_SCHEMA.tables)
(def tables (map #(get % :TABLE_NAME) 
              (select 'INFORMATION_SCHEMA.tables (fields :TABLE_NAME) 
                      (where {:TABLE_TYPE "BASE TABLE"})))) ;notice the quote

(prn tables)
;(map #(def %) tables) ;additional concept
(map #(defentity %) tables) ;not sure this is required anymore

(select (first tables)) 
```

# asp.net-mvc - 自定义属性

> ID：11434731
> 
> 赞同：0
> 
> 时间：2012-07-11T14:20:30.550
> 
> 标签：asp.net-mvc, c#-4.0

我有一个客户的要求，让他们可以选择将自定义字段添加到我将为他们编写的程序中。自定义字段将基于 per/poco。处理这样的自定义属性的最佳方法是什么。我将使用 SQL Server 和 ASP.NET MVC4。

只需要一个起点。。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:28:27.433

我们在我工作的地方处理这个问题的方式是将信息存储在数据库表中。我们存储字段名称、值和它所属对象的一些标识符。有时我们有一个额外的表存储可用值的特定列表。

当它从数据库中取出时，我们将它放在一个字典列表中。如果您设置了一些约定，那么为字段构建验证还不错。IE 名称中带有“电话”的任何字段名称都会被验证为电话号码。

# .net - DataGridView 筛选结果

> ID：11434732
> 
> 赞同：1
> 
> 时间：2012-07-11T14:20:30.807
> 
> 标签：.net, visual-studio-2010, datagridview, filter

我有这个代码：

```
Private bs As BindingSource = New BindingSource()
...
bs.Filter = String.Format(Me.DataGridView.SelectedColumns.Item(0).HeaderText.ToString & " LIKE '{0}%'", TextBoxSearchFor.Text) 
```

它可以工作，但是在这行代码完成后，我的列选择会跳转到第 1 列并且不会停留在第 4 列。我正在使用：

```
DataGridView.SelectionMode = DataGridViewSelectionMode.FullColumnSelect 
```

我不确定如何使选择保持不变。也不清楚为什么过滤器会改变我的选择。它应该只是缩小行，但为什么会改变选择。

# javascript - 更改页面滚动上的元素样式

> ID：11434735
> 
> 赞同：17
> 
> 时间：2012-07-11T14:20:40.853
> 
> 标签：javascript, jquery, css

我想在用户向下滚动 100px 后更改元素的可见性。

我已经有一些代码，

```
var fixed = false;
$(document).scroll(function() {
    if( $(this).scrollTop() >= 100 ) {
        if( !fixed ) {
            fixed = true;
            $('#logo-scroll').css({position:'fixed', display:'visible !important'});
        }
    } else {
        if( fixed ) {
            fixed = false;
            $('#logo-scroll').css({display:'none'});
        }
    }
});​ 
```

[JSF](http://jsfiddle.net/psvn9/)中。

代码有两个问题。

1.  它不默认是不可见的，我想要它所以它开始不可见。

2.  它不会重复，当用户向上滚动时，它不会回到不可见状态。

更多细节，

我想制作类似[这个](http://techcrunch.com/)标题的东西，但是，正如你所看到的，在某个特定的点上，你会看到小徽标的*一半，以及大徽标的一部分。*它不会对 techcrunch 产生太大影响，因为标题很小，但在我的网站上，确实如此。我已经做好了一切，我只需要在 中启动它`display:none`，并在 100px 后变得可见。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-11T14:23:27.677

用途：`display:block;`和`display:none;`

## *[jsFiddle 演示](http://jsfiddle.net/psvn9/400/)*

将此添加到您的 CSS 中：

```
#logo-scroll{ display:none; position:fixed; } 
```

问：

```
var $logo = $('#logo-scroll');
$(document).scroll(function() {
    $logo.css({display: $(this).scrollTop()>100 ? "block":"none"});
}); 
```

顺便说一句：在 TC 页面上，它只是`CSS`玩 z-indexes。而已。所有元素在页面加载时都可见，只是滚动使大徽标下方出现 z-index 较低元素。

在**普通的** **Javascript**中会是这样***[的](http://jsfiddle.net/psvn9/649/)***：

```
var win = window,
    docEl = document.documentElement,
    $logo = document.getElementById('logo-scroll');

win.onscroll = function(){
   var sTop = (this.pageYOffset || docEl.scrollTop)  - (docEl.clientTop || 0);
   $logo.style.display =  sTop > 100 ? "block":"none" ;
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-25T18:30:11.747

那么问题已经回答了。只是添加一个可能对其他人有用的更好的例子，这正是 op 想要的。

[代码和演示](https://www.virendrachandak.com/techtalk/make-a-div-stick-to-top-when-scrolled-to)

**已编辑**：从原始来源添加了实际代码。

**jQuery：**

```
// This function will be executed when the user scrolls the page.
$(window).scroll(function(e) {
    // Get the position of the location where the scroller starts.
    var scroller_anchor = $(".scroller_anchor").offset().top;

    // Check if the user has scrolled and the current position is after the scroller start location and if its not already fixed at the top 
    if ($(this).scrollTop() >= scroller_anchor && $('.scroller').css('position') != 'fixed') 
    {    // Change the CSS of the scroller to hilight it and fix it at the top of the screen.
        $('.scroller').css({
            'background': '#CCC',
            'border': '1px solid #000',
            'position': 'fixed',
            'top': '0px'
        });
        // Changing the height of the scroller anchor to that of scroller so that there is no change in the overall height of the page.
        $('.scroller_anchor').css('height', '50px');
    } 
    else if ($(this).scrollTop() < scroller_anchor && $('.scroller').css('position') != 'relative') 
    {    // If the user has scrolled back to the location above the scroller anchor place it back into the content.

        // Change the height of the scroller anchor to 0 and now we will be adding the scroller back to the content.
        $('.scroller_anchor').css('height', '0px');

        // Change the CSS and put it back to its original position.
        $('.scroller').css({
            'background': '#FFF',
            'border': '1px solid #CCC',
            'position': 'relative'
        });
    }
}); 
```

**HTML**

```
<div class="container">
    <div class="test_content">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus interdum metus nec neque convallis id interdum nibh aliquet. Nulla eget varius diam. Ut ut dolor dolor. Mauris vehicula sodales mi quis euismod. In sem metus, volutpat nec fringilla sed, fermentum ac turpis. Cras aliquam venenatis rutrum. Donec pharetra ante sit amet justo pellentesque nec consequat ante elementum. Ut imperdiet iaculis tortor, id pretium urna pharetra sit amet. Aenean pharetra nunc risus, ac scelerisque urna. Morbi dictum egestas augue, in euismod metus commodo ac. Duis nisl ante, consequat et tincidunt id, eleifend eu ante. Integer lectus velit, tempus eu feugiat et, adipiscing ut mauris.
    </div>

    <!-- This div is used to indicate the original position of the scrollable fixed div. -->
    <div class="scroller_anchor"></div>

    <!-- This div will be displayed as fixed bar at the top of the page, when user scrolls -->
    <div class="scroller">This is the scrollable bar</div>

    <div class="test_content">
        Quisque sollicitudin elit vitae diam consequat accumsan. Suspendisse potenti. Donec dapibus tortor at justo eleifend at pellentesque leo lobortis. Etiam ultrices leo et nulla iaculis eu facilisis augue fermentum. Pellentesque eu leo purus. Vestibulum bibendum, metus at bibendum blandit, lacus neque porttitor diam, id facilisis lectus mauris et leo. Donec adipiscing interdum lacus sed condimentum. In auctor sollicitudin orci, ac interdum risus aliquet ullamcorper. Curabitur mollis accumsan vulputate. Etiam adipiscing diam nec dui posuere ut tincidunt felis tristique. Vestibulum neque enim, placerat sed placerat commodo, consectetur ac mauris. Sed ultrices pretium nibh, a blandit libero imperdiet pulvinar. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;
    </div>
    ...
</div> 
```

**CSS：**

```
.container{font-size:14px; margin:0 auto; width:960px}
.test_content{margin:10px 0;}
.scroller_anchor{height:0px; margin:0; padding:0;}
.scroller{background:#FFF; border:1px solid #CCC; margin:0 0 10px; z-index:100; height:50px; font-size:18px; font-weight:bold; text-align:center; width:960px;} 
```

# apex-code - 如何从另一个visualforce页面链接一个visualforce页面？

> ID：11434737
> 
> 赞同：0
> 
> 时间：2012-07-11T14:20:45.533
> 
> 标签：apex-code

我想添加在 vf 页面文本框中给出的两个数字。我想通过单击第一页中的按钮（添加按钮）在另一个 vf 页面中打印结果。

请帮我这样做....

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T23:07:59.923

我认为您可能想尝试在两个页面上使用相同的控制器。这样，您不必传递所有数据，假设您需要维护的不仅仅是几个字段，作为 url 参数，或者如果您不需要，则必须将数据存储在某个地方。

如果两个页面都使用同一个控制器，并且当您使用 PageReference 重定向用户时，请确保将重定向值设置为**false**，否则 Salesforce 会将其视为新请求并使用控制器的新实例启动页面。

下面的示例代码允许用户在字段中键入一些文本，然后当单击打印视图时，它会使用相同的信息呈现 PDF。没有数据保存到数据库。

控制器

```
public with sharing class MyController {

public string MyData {get;set;}

public MyController() {
    MyData = '';    
}

public PageReference printView() {
    PageReference oPageRef = Page.MyPage2;
    oPageRef.setRedirect(false);

    return oPageRef;
}
} 
```

第 1 页：

```
<apex:page controller="MyController">
<apex:sectionheader title="Test" subtitle="My Page"/>

<apex:form id="formData">
    <apex:pageBlock title="My Data">
        <apex:pageBlockButtons >
            <apex:commandButton value="Printable View" action="{!printView}" />
        </apex:pageBlockButtons>

        <apex:pageBlockSection >
            <apex:pageBlockSectionItem >
                <apex:outputLabel value="My Data"/>
                <apex:inputTextArea value="{!MyData}" />
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
    </apex:pageBlock>
</apex:form>
</apex:page> 
```

第2页：

```
<apex:page controller="MyController"
renderAs="pdf">

{!MyData}
</apex:page> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T16:23:50.583

您可以通过路由到 Visualforce 中的下一页并传递要显示为参数的值来执行此操作。Apex中这样的东西应该可以工作：

```
PageReference gotoPage()
{
   PageReference pr = Page.YourSecondVFPage;
   pr.getParameters().put('secondnumber', '' + this.secondNumber);
   pr.setRedirect(true);
   return pr;
} 
```

然后在 Visualforce 中：

```
<apex:commandButton value="Go!" action="{!gotoPage}"/> 
```

# c++ - 我不能从指向派生类的指针和指向基类的指针分配指针？

> ID：11434738
> 
> 赞同：3
> 
> 时间：2012-07-11T14:20:46.080
> 
> 标签：c++, pointers, polymorphism

> **可能重复：**
> [派生**到基础**之间的转换](https://stackoverflow.com/questions/8026040/conversion-between-derived-to-base)

在主要使用 Python 的几年之后，我又回到了 C++，并且遇到了一堵强类型的墙。我认为我对基类和派生类的指针之间的基本多态性和类型转换有很好的处理（例如，派生类[的指针可以类型转换为其基类的指针吗？](https://stackoverflow.com/questions/2156064/can-a-pointer-of-a-derived-class-be-type-cast-to-the-pointer-of-its-base-class)），但这里有一个难点：为什么可以我不是将一个指向派生类的指针分配给一个指向它的基类的 p-to-p 的指针吗？

对于更多的上下文（也许还有关于减少pythonish的提示），这是我正在尝试做的简化版本。我想要一个指向对象的指针列表（从单个类派生）和一个标识它们的字符串（即 a `map<string, obj*>`）。然后，一组组件将传递标识字符串和位置的列表，以存储指向相应对象（即 a `map<string, obj**>`）的指针。然后我应该能够通过其字符串 id 找到适当的对象，并填写适当的指针以供组件后续使用。执行此操作的简化代码是

```
#include <map>
#include <string>
using namespace std;

class base
{
};

class derived: public base
{

};

typedef map<string, base**> BasePtrDict;
typedef map<string, base*> BaseDict;

int main(int argc, char* argv[])
{
    base b1, b2;
    derived d;
    derived* d_ptr;

    BaseDict base_dict;
    base_dict["b1"] = &b1;
    base_dict.insert(make_pair("b2",&b2)); // alternate syntax
    base_dict["d"]= &d;

    BasePtrDict ptr_dict;
    ptr_dict["d"] = &d_ptr;

    for (auto b = ptr_dict.begin(); b != ptr_dict.end(); b++)
        *(b->second) = base_dict[b->first];

    return 0;
} 
```

这会在`ptr_dict["d"] = &d_ptr;`. 为什么？在 C++ 范式中，我应该做什么？我真的需要`reinterpret_cast<base>()`到处做丑陋的（不安全的？）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:28:49.410

您正在丢失能够将 a`base *`转换为 a的必要信息`derived *`。

考虑从多个基类继承的情况`derived`，因此强制转换需要调整指针值。然后`derived *pd = static_cast<derived *>(pb)`对于一个指向基地`pb`的指针将自动应用指针调整。

但是`derived *pd; base **ppb = &pd; *ppb = *pb`将无法应用指针调整，因此这是不合法的。

你应该做的是：

```
base *b_ptr;
... // existing code
derived *d_ptr = static_cast<derived *>(b_ptr); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:57:32.433

考虑如果允许将 a`derived**`视为 a将启用什么`base**`：

```
class base
{
};

class derived: public base
{
public:
    int boom;
}

void light_the_fuse( base** pb)
{
    *pb = new base;
}

int main()
{
    derived* pd = NULL;

    light_the_fuse( &pd);

    pd->boom = 42;  // uh oh, `pd` points to a `class base`...

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:32:30.107

为了进行子到基的转换，类型需要相关。因为`derived**`这`base**`意味着它`derived*`的子`base*`节点显然不正确，因为它们是正交指针类型（恰好指向相关类）。

你应该能够用 a`static_cast`而不是`reinterpret_cast`虽然解决这个问题：

```
ptr_dict["d"] = &static_cast<base*&>(d_ptr); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:25:29.707

直接投射`derived*`到`base*`是可以的，但这不是你想要的。您正在尝试执行`derived**`to `base**`，这不是隐式强制转换。除此之外，我可以问为什么吗？我什至会继续问你是否真的需要指针，但是双指针？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T14:47:15.240

更换会简单很多

```
derived* d_ptr; 
```

和

```
base* d_ptr; 
```

并在您可能需要应用 d_ptr 的确切类型时随时使用强制转换，但当然面向对象的原则表明这种情况应该很少见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-11T15:14:18.317

您不能也不应该将 a 分配给 a `Derived**`，`Base**`因为它不安全。如果允许强制转换，那么它将允许`Derived*`指向非类型的`Dervied`类型。考虑以下：

```
class Base {};
class Derived: public Base {};
class Other: public Base {};

...

Derived derived;
Derived* derived_p   = &derived;   // derived_p points to derived.
Derived** derived_pp = &derived_p; // derived_p points to derived.
                                   // derived_pp points to derived_p.
Base** base_pp = derived_pp;       // derived_p points to derived.
                                   // base_pp points to derived_p.

Other other;
Other* other_p = &other;           // other_p points to other.

*bpp = op;                         // base_pp points to derived_p.
                                   // derived_p points to other. 
```

如果上述代码有效，它将允许`Derived* derived = new Other()`.

不幸的是，我不确定要完成什么，所以我无法提供替代解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-11T15:03:52.713

这几乎类似于[Why do I need a reinterpret_cast to convert Fred ** const to void ** const?](https://stackoverflow.com/questions/11410783/why-do-i-need-a-reinterpret-cast-to-convert-fred-const-to-void-const/11411083#comment15054476_11411083)

指向两种不同对象类型的指针基本上是不兼容的。但是，也有例外

*   `Derived*`to `Base*`... Derived 和 Base 是相关的，因此允许转换（在类型转换为 之后`Base*`，指针实际上将指向`Base`类型 的对象
*   `T*`to `void*`- 允许（见上面的链接）

但没有理由`D**`允许转换为`B**`，因为`B*`和`D*`本质上是不同的类型。

# java - IO：同时从一个 C++ 程序和另一个 Java 程序写入和读取同一个文本文件？

> ID：11434744
> 
> 赞同：0
> 
> 时间：2012-07-11T14:21:01.137
> 
> 标签：java, c++, io

是否可以同时使用 C++ 应用程序和 Java 应用程序读取和写入同一个文本文件，而不会向其中写入冲突的行/字符？我现在已经用两个 java 应用程序进行了测试，似乎可以从一个进程写入文件，即使另一个进程已经打开了流，但没有关闭它。有什么方法可以锁定文件以便其他进程需要等待？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:29:32.120

我认为是的，例如 boost::interprocess [http://www.boost.org/doc/libs/1_50_0/doc/html/interprocess.html](http://www.boost.org/doc/libs/1_50_0/doc/html/interprocess.html)文件锁[http://www.boost.org/doc/libs/1_50_0 /doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.file_lock](http://www.boost.org/doc/libs/1_50_0/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.file_lock)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:31:15.000

对于写入同一文件的两个进程，只要您在行边界上刷新输出缓冲区（即，在写入换行符序列后刷新），写入文件的数据应该很好地交错。

如果一个进程正在写入，而另一个进程正在从同一个文件中读取，您只需要确保读取不会领先于写入。如果读取获得文件结束条件（或更糟的是，部分数据行），那么您知道读取过程必须等到写入过程完成将另一块数据写入文件。

如果你需要更复杂的读/写控制，你应该考虑某种锁定机制。

# java - 在 java 中连接到远程 MS ACCESS 数据库

> ID：11434745
> 
> 赞同：3
> 
> 时间：2012-07-11T14:21:01.197
> 
> 标签：java, ms-access

我正在用 Java 开发应用程序，它在 MS Access 中有后端。它使用以下连接字符串在本地 MS Access 数据库上运行良好：

```
 DriverManager.getConnection(
    "jdbc:odbc:Driver={Microsoft Access Driver  (*.mdb)};Dbq=d:\test.mdb"); 
```

连接到另一台机器上的远程 MS ACCESS 数据库的连接字符串是什么。请回复......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T15:18:27.500

答案取决于您如何连接到另一台机器。`test.mdb`如果可以从同一 LAN 上另一台计算机上的文件共享中获得远程副本，则可以连接。

对于映射到驱动器号 X 的共享：

```
Dbq=X:\test.mdb 
```

或者使用 UNC 路径：

```
Dbq=\\machine_name\share_name\test.mdb 
```

如果您不能使用其中任何一个，则 Access 不适合，您应该为数据存储选择不同的数据库。

注意，我假设本地和远程机器都在运行 MS Windows。如果其中一个或两个都运行不同的操作系统，您应该告诉我们使用的是哪个操作系统。

# javascript - 用于对齐制表符分隔数据的 Javascript 库（如 elastictabstops）

> ID：11434747
> 
> 赞同：0
> 
> 时间：2012-07-11T14:21:09.987
> 
> 标签：javascript, tabs

我有一些制表符分隔的数据，并希望它在具有固定宽度字体的列中很好地排列，所以......

```
Head 1  Head2   Head 3
Item on is quite long   Item 2  Item 3 
```

变成...

```
Head 1                  Head2   Head 3
Item on is quite long   Item 2  Item 3 
```

我不介意是否使用空格而不是制表符，并且最喜欢两者的混合，而不是像弹性制表位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T16:43:04.170

我最终自己制作了一个函数，该函数大致遵循弹性制表位的格式，但没有我不需要的复杂性（我的表都是一个块，每行都有相同的列）

它适用于我的测试用例（和我的实际用例），我在函数中抛出第一个块`align`并返回第二个块。

在 CoffeeScript 中：

```
align = (d)->
    b = []
    l = []
    $.each d.split(/\n/), ->
        a = []
        $.each this.split(/(\t+|\s\s+)/), ->
            if this.match /\w/
                a.push this.toString()
                if l[a.length-1]? < this.length then l[a.length-1] = this.length
        b.push a

    pad = (txt, len)->
        while (txt.length<len)
            txt += " "
        txt

    o = "\n"
    $.each b, ->
        $.each this, (i)->
            o += pad this.toString(), l[i]
            o += "\t"
        o += "\n"
    o 
```

编译为 javascript：

```
var align;
align = function(d) {
  var b, l, o, pad;
  b = [];
  l = [];
  $.each(d.split(/\n/), function() {
    var a;
    a = [];
    $.each(this.split(/(\t+|\s\s+)/), function() {
      if (this.match(/\w/)) {
        a.push(this.toString());
        if ((l[a.length - 1] != null) < this.length) {
          return l[a.length - 1] = this.length;
        }
      }
    });
    return b.push(a);
  });
  pad = function(txt, len) {
    while (txt.length < len) {
      txt += " ";
    }
    return txt;
  };
  o = "\n";
  $.each(b, function() {
    $.each(this, function(i) {
      o += pad(this.toString(), l[i]);
      return o += "\t";
    });
    return o += "\n";
  });
  return o;
}; 
```

# iphone - 如何保存 Core Data 以供以后使用？

> ID：11434750
> 
> 赞同：0
> 
> 时间：2012-07-11T14:21:19.717
> 
> 标签：iphone, objective-c, cocoa-touch, nsdata

现在在我的 iPhone 应用程序上，我正在将**大量数据**从一个`NSData`对象保存到`NSUserDefaults`. 我知道这不是最好的方法，因为`NSUserDefaults`它仅用于存储小块数据。

我正在这样做：

```
NSData *data = [NSData alloc]init]];
[[NSUserDefaults standardUserDefaults] setObject:data forKey:@"MyData"]; 
```

用于延迟检索此数据。

`data`永久保存以供进一步使用的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:29:29.563

使用您想要的属性创建一个自定义类（.h 文件）：

```
#import <Foundation/Foundation.h>

@interface CustomHolder : NSObject {
    NData *data;
}

@property (strong, nonatomic) NSData *data;

@end 
```

然后设置 .m 文件，以便您可以对对象进行编码/解码

```
#import "CustomHolder.h"

@implementation CustomHolder

@synthesize data;

- (void)encodeWithCoder:(NSCoder *)encoder 
{
    [encoder encodeObject:data forKey:@"data"];
}

- (id)initWithCoder:(NSCoder *)decoder 
{
    if (self = [super init]) 
    {
        self.data = [decoder decodeObjectForKey:@"data"]; 
    }
    return self;
}

@end 
```

然后你可以只`[NSKeyedArchiver archiveRootObject:obj toFile:[self saveFilePath]]`保存和`[NSKeyedUnarchiver unarchiveObjectWithFile:[self saveFilePath]]`加载。

这适用于任何类型的数据，并让您可以根据需要向对象添加任意数量的不同数据文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:28:04.397

NSUserDefaults 适用于少量数据，而不是复杂的数据结构 除非您有存储数据的外部服务器，否则没有真正的“永久”数据保存方式，但 Core Data 是一种很好的存储方式，只要在设备上该应用程序不会被删除。

Ray Wenderlich 的本[教程](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)是一个很好的起点。带您了解 NSManagedObject 概念、fetchRequests 等。它包含几个部分，因此您可以逐步构建数据模式

祝你好运

# c++ - 如何限制程序的文件权限

> ID：11434752
> 
> 赞同：3
> 
> 时间：2012-07-11T14:21:31.010
> 
> 标签：c++, windows, file

我是一名学生，想设计一个在线裁判系统。

我有一个问题：为了保证服务器的安全，我必须让程序无权读取或写入任何文件 该程序是其他用户通过在线评判系统提交的。它不是服务器程序本身。

在线裁判系统用户提交源代码，服务器程序编译运行。所以服务器程序必须保证服务器的安全。

我的平台是 Windows，我使用 C++ 进行编程。

谁能给我一些建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T16:30:57.787

您无法轻易阻止程序本身的行为，也无法验证该程序是否无恶意。

您可以做什么：以具有有限（几乎没有）访问权限的用户身份运行程序。您的服务器程序需要成为该用户并执行它已编译的程序。您可能还想使用该用户帐户来实际编译程序（在不太可能的情况下，有人知道如何利用您的编译器）。

以不同用户身份执行程序的 windows 命令是：`runas`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T16:44:44.093

您可以更改文件和目录的权限，然后使用 CreateProcessAsUser 以具有有限（接近无）访问权限的用户身份运行用户提交的程序。

# javascript - css浮动元素在网格中的左上角高度不等

> ID：11434756
> 
> 赞同：27
> 
> 时间：2012-07-11T14:21:51.417
> 
> 标签：javascript, jquery, css, layout

我想知道如何才能实现图 1 中的效果。

![向左浮动](../Images/7814423a0681ae6012598721f994e295.png)

到目前为止我得到的是

`.box { display: inline-block; vertical-align: top; width: 100px;}`

这给了我图 2 所示的结果。（注意：我知道我可以用 float:left 完成相同的操作）

我的 HTML 代码如下所示：

```
<span class="box">A<br><br><br><br></span>
<span class="box">B<br></span>
<span class="box">C<br><br><br></span>
<span class="box">D<br><br><br></span>
<span class="box">E<br><br><br><br><br><br></span>
<span class="box">F</span>
<span class="box">G<br><br><br><br></span>
<span class="box">H<br></span>
<span class="box">I<br><br></span> 
```

我希望每个元素尽可能向左浮动，但同时向上浮动。

是否可以使用纯 css 来做到这一点，或者我需要一些 javascript 吗？

**编辑：**

对我来说，将整个网格定位到页面中心很重要。这就是我使用 display:inline-block 的原因。网格也不应该固定在页面上，因为我希望它在调整窗口大小时重新排列。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-11T14:27:49.733

您可以使用流行的图书馆[Masonry](http://masonry.desandro.com/)。

> jQuery 的动态布局插件 CSS 浮动的另一面

这是一个代码[示例](http://masonry.desandro.com/demos/basic-single-column.html)...

```
$('#container').masonry({
  itemSelector: '.box'
}); 
```

这是[Github上的来源以及在 Shoptalk 播客上对](https://github.com/desandro/masonry)[David](http://shoptalkshow.com/episodes/024-with-david-desandro/) Desandro的采访。

对于不使用 jQuery 的人，请注意还有[Vanilla Masonry](http://vanilla-masonry.desandro.com/)，它是无框架版本。

**提示：**确保父容器具有 position:relative 以便所有内容都绑定到您的容器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T14:29:26.853

由于您已经在使用 jquery，jquery masonry 可能会让您感兴趣：http: [//masonry.desandro.com](http://masonry.desandro.com)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T14:37:08.143

好吧，如果您的目标只是支持最现代的浏览器，那么[CSS3 多列布局](https://developer.mozilla.org/en/CSS3_Columns)可能会有所帮助。这种方法的一个问题是它不会保持相同的顺序，但您可以使用 HTML（或 Javascript）中的顺序。

我在您的 span 周围添加了一个名为`#container`.

```
#container { 
    -webkit-column-width: 100px; 
    -moz-column-width: 100px; 
    column-width: 100px; 
} 
```

[jsFiddle 演示](http://jsfiddle.net/bazmegakapa/Ft9d2/)

# java - 休眠自我加入多对多与额外的列

> ID：11434761
> 
> 赞同：0
> 
> 时间：2012-07-11T14:22:04.137
> 
> 标签：java, hibernate, many-to-many

帮助我了解如何使用休眠实现多对多自连接和额外的列？我也应该映射连接表吗？或者可能以另一种方式存在？我找不到任何对我有用的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:24:52.460

将连接表映射为专用实体，然后通过两个`OneToMany`关系链接它。这通常是正确的方法，因为一旦您添加更多列，它就不仅仅是技术细节。

对于自联接，这应该以相同的方式工作，您在该模型上只有两个与联接实体关联的字段。

请参阅[此答案](https://stackoverflow.com/a/5127262/95033)，其中对此进行了更详细的描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-19T17:58:02.683

这个问题我纠结了很久，也许有人会觉得 Wolfram 的措辞很难，所以我会更详细地解释一下：想象一下，我们需要什么 map 之类的[uml_diagramm](https://i.stack.imgur.com/ZNvv5.png)

我需要在任意两个用户之间建立链接，这些链接用于他们之间的聊天。所以我们的用户类将是：

```
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Data
@Entity
public class User  implements Serializable {
    private String email;
    private String password;
    private Long id;
    private String nickname;
    private String phone;
    private Collection<Chats> chatsById;
    private Collection<Chats> chatsById_0;

@Basic
@Column(name = "email", nullable = false, length = -1)
public String getEmail() {
    return email;
}

public void setEmail(String email) {
    this.email = email;
}

@Basic
@Column(name = "password", nullable = false, length = -1)
public String getPassword() {
    return password;
}

public void setPassword(String password) {
    this.password = password;
}

@Id
@Column(name = "id", nullable = false)
public Long getId() {
    return id;
}

public void setId(Long id) {
    this.id = id;
}

@Basic
@Column(name = "nickname", nullable = true, length = -1)
public String getNickname() {
    return nickname;
}

public void setNickname(String nickname) {
    this.nickname = nickname;
}

@Basic
@Column(name = "phone", nullable = true, length = -1)
public String getPhone() {
    return phone;
}

public void setPhone(String phone) {
    this.phone = phone;
}

@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;
    User user = (User) o;
    return Objects.equals(email, user.email) && Objects.equals(password, user.password) && Objects.equals(id, user.id) && Objects.equals(nickname, user.nickname) && Objects.equals(phone, user.phone);
}

@Override
public int hashCode() {
    return Objects.hash(email, password, id, nickname, phone);
}

@OneToMany(mappedBy = "userByIdFrom")
public Collection<Chats> getChatsById() {
    return chatsById;
}

public void setChatsById(Collection<Chats> chatsById) {
    this.chatsById = chatsById;
}

@OneToMany(mappedBy = "userByIdTo")
public Collection<Chats> getChatsById_0() {
    return chatsById_0;
}

public void setChatsById_0(Collection<Chats> chatsById_0) {
    this.chatsById_0 = chatsById_0;
} 
```

}

请注意两个 @OneToMany 注释 - getChatsById 和 getChatsById_0

现在我们的聊天类：

```
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Data
@Entity
@IdClass(ChatsPK.class)
public class Chats implements Serializable {
    private Long idFrom;
    private Long idTo;
    private Object uuid;
    private User userByIdFrom;
    private User userByIdTo;

@Id
@Column(name = "id_from", nullable = false)
public Long getIdFrom() {
    return idFrom;
}

public void setIdFrom(Long idFrom) {
    this.idFrom = idFrom;
}

@Id
@Column(name = "id_to", nullable = false)
public Long getIdTo() {
    return idTo;
}

public void setIdTo(Long idTo) {
    this.idTo = idTo;
}

@Basic
@Column(name = "uuid", nullable = false)
public Object getUuid() {
    return uuid;
}

public void setUuid(Object uuid) {
    this.uuid = uuid;
}

@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;
    Chats chats = (Chats) o;
    return Objects.equals(idFrom, chats.idFrom) && Objects.equals(idTo, chats.idTo) && Objects.equals(uuid, chats.uuid);
}

@Override
public int hashCode() {
    return Objects.hash(idFrom, idTo, uuid);
}

@ManyToOne
@JoinColumn(name = "id_from", referencedColumnName = "id", nullable = false)
public User getUserByIdFrom() {
    return userByIdFrom;
}

public void setUserByIdFrom(User userByIdFrom) {
    this.userByIdFrom = userByIdFrom;
}

@ManyToOne
@JoinColumn(name = "id_to", referencedColumnName = "id", nullable = false)
public User getUserByIdTo() {
    return userByIdTo;
}

public void setUserByIdTo(User userByIdTo) {
    this.userByIdTo = userByIdTo;
    }
} 
```

老实说，我自己还没有弄清楚为什么它会起作用，但是应该有更多的细节

同时，我知道 intelijIdea 可以从数据库中为您生成模型，这可能有助于您[通过 Database Schema - Entity Class 的详细设置生成持久性映射](https://intellij-support.jetbrains.com/hc/en-us/community/posts/115000751864-Generate-Persistence-Mapping-by-Database-Schema-Detail-settings-for-Entity-Class)。（此代码由它生成）

# url - 使用 TYPO3、RealURL 和 tt_news 创建自定义 URL

> ID：11434765
> 
> 赞同：1
> 
> 时间：2012-07-11T14:22:11.920
> 
> 标签：url, typo3, tt-news, realurl

我仍然不太了解 RealURL 的配置是如何工作的。到目前为止，我以这种格式收到我的消息：

[http://www.mysite.com/games/detail/date/2012/01/01/game-1/](http://www.mysite.com/games/detail/date/2012/01/01/game-1/)

但我希望它能够根据需要自定义 URL，例如：

[http://www.mysite.com/games/WhateverIwanthere/](http://www.mysite.com/games/WhateverIwanthere/)

我有一个带有 LIST 视图 (id=3) 的页面和一个带有 SINGLE 视图 (id=13) 的子页面

这是我的 realurl_autoconf.php：[http ://pastebin.com/31s9uZDb](http://pastebin.com/31s9uZDb)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T18:26:35.877

1.  从您的 tt_news 链接中删除日期参数，请参阅[tt_news 文档](http://typo3.org/extension-manuals/tt_news/3.2.1/view/1/4/)和查找`Settings for Links`部分
2.  将LIST视图和SINGLE视图放在同一个页面，用TypoScript切换视图（网上有片段所以这里就不写了）
3.  使用[fixedPostVars](http://www.dmitry-dulepov.com/2008/05/realurl-made-easy-part-1.html) of`RealURL`避免多余的“细节”字

在这种情况下，您将能够显示：

[http://domain.tld/games/](http://domain.tld/games/) - 列表视图

[http://domain.tld/games/one-two-three/](http://domain.tld/games/one-two-three/) -*一二三*游戏的单一视图

# java - 从字符串中提取标题 - Java

> ID：11434771
> 
> 赞同：0
> 
> 时间：2012-07-11T14:22:38.827
> 
> 标签：java, string, parsing

只是想知道，从字符串中的标题中提取信息的最佳方法是什么。

我有一个用于标题的类和 getter 方法（摘要、标题 1、标题 2）。

例如，

如果我有一个字符串等于，

```
This: is the first line of a String: xx-string: This is a long String

Summary:
This is the summary of the String

Heading 1:
This is the first heading

Heading 2:
This is another heading 
```

设置字符串值的理想方法是什么，

摘要，标题 1，标题 2

至

```
Summary = This is the summary of the String
Heading 1 = This is the first heading
Heading 2 = This is another heading 
```

谢谢 ！！

**编辑**

这就是我想要的，

```
 public void setHeadings(Data fileData) {
        String description = fileData.getDescription();
        //String [] headings = description.split(":");

        int indexOf;
        indexOf = description.indexOf("Summary");
        if(indexOf != -1)
        {
            String subString = description.substring(indexOf);
            int indexOfNextHeading = subString.indexOf(":");
            if(indexOfNextHeading != -1)
            {
                System.out.println(indexOf + ":" + indexOfNextHeading);
                setSummary(description.substring(indexOf,indexOfNextHeading-1));
                System.out.println(description.substring(indexOf,indexOfNextHeading));
            }
        }
    } 
```

然而，这会吐出一个 Array Out of bounds 异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:42:22.513

使用 Scanner 对象。

```
import java.util.Scanner; 
```

然后用它一次一行地读取字符串。

```
Scanner sc = new Scanner(string);
sc.useDelimiter("\n");  // read one line at a time 
```

现在 sc.hasNext() 告诉您是否还有要读取的行，并且 sc.next() 返回下一行。使用它一次遍历字符串一行。您可以测试每一行以查看它是否等于“Summary：”或“Heading 1：”等。然后您可以使用 StringBuffer 从您要创建的每个字符串中添加每一行。

如果你愿意，我可以为你写这个，但它相当简单。

# magento - Magento 顶部菜单下拉菜单在主页中不起作用

> ID：11434778
> 
> 赞同：2
> 
> 时间：2012-07-11T14:23:06.930
> 
> 标签：magento, drop-down-menu, navigation

**顶部菜单下拉菜单仅在主页中起作用**。它在内页中运行良好。我的主页中有一个横幅滑块扩展和自定义 jquery 滑块，我认为问题在于 jquery 冲突。

以前有没有人克服过这类问题？请分享您的意见以解决此问题。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T09:58:47.430

在您的 jQuery 文件中使用`jQuery.noConflict()`，以避免与原型库冲突
参见此[链接](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

# iphone - 应用启动期间 iOS 测试与服务器的连接耗时过长

> ID：11434780
> 
> 赞同：4
> 
> 时间：2012-07-11T14:23:16.603
> 
> 标签：iphone, ios, ipad, networking, reachability

我有一个允许用户自动登录的应用程序。我老板想要的是，当应用程序启动时，应用程序需要测试与我们服务器的连接（不仅仅是测试是否有 WiFi 或 3G 网络）。我借了苹果的[可达性](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)样本，它有效。

一个问题是耗时太长，尤其是在启动时。我在没有互联网连接的本地无线网络上尝试了它，花了我将近半分钟的时间。由于在 -ViewDidLoad() 中调用了自动登录，因此在那半分钟内，ui 没有加载。花那么长时间是不可接受的。更糟糕的是，如果我的应用加载时间过长，iOS 甚至可能会关闭应用。

此外，我的应用程序中有很多 Web 服务调用。我知道每个 Web 服务调用都有可能失败，因为即使用户从一个地方到另一个地方走一小段路，iPhone/iPad 也很容易失去或获得连接。我个人不喜欢它，但这是我老板要我做的，我可能必须经常在应用程序中测试连接。

因此，我在这里寻找的是一种非常快速（在几秒钟内）检测连接的方法，或者是一种在幕后进行而不影响用户体验的方法。

有人有建议吗？

感谢您花时间阅读我的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T17:04:17.977

对于它的价值，这是我使用的方法..

```
- (BOOL)checkServerAvailability {
    bool success = false;
    const char *host_name = [@"host" cStringUsingEncoding:NSASCIIStringEncoding];

    SCNetworkReachabilityRef reachability = 
                  SCNetworkReachabilityCreateWithName(NULL, host_name);
    SCNetworkReachabilityFlags flags;
    success = SCNetworkReachabilityGetFlags(reachability, &flags);
    bool isAvailable = success && (flags & kSCNetworkFlagsReachable) 
                   && !(flags & kSCNetworkFlagsConnectionRequired);

    CFRelease(reachability);
    return isAvailable;
} 
```

这是我的服务器检查方法的记录结果...

```
2012-07-11 11:29:04.892 ASURecycles[1509:f803] starting server check...
2012-07-11 11:29:04.894 ASURecycles[1509:f803] creating reachability...
2012-07-11 11:29:04.894 ASURecycles[1509:f803] creating flags...
2012-07-11 11:29:04.913 ASURecycles[1509:f803] checking for success of reachability, assigning to flags..
2012-07-11 11:29:04.913 ASURecycles[1509:f803] checking our flags to determine network status...
2012-07-11 11:29:04.913 ASURecycles[1509:f803] not available 
```

如您所见，只有几分之一秒。当然我们的服务器目前正在遇到问题，但我认为您的问题可能是服务器问题，而不是框架问题。不过，您总是可以尝试在另一个线程上执行服务器检查。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T14:35:34.143

`presentModalViewController`在测试发生时显示中间加载视图，并使用`performSelectorInBackground`. 然后使用以下信号返回主线程`performSelectorOnMainThread`：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Make this a hidden member
    loadingViewController = [LoadingViewController new];
    [self presentModalViewController:loadingViewController animated:NO];

    [self performSelectorInBackground:@selector(testConnectivity) withObject:nil];
}

- (void)testConnectivity
{
    // Do expensive testing stuff

    [self performSelectorOnMainThread:@selector(testCompleted) withObject:nil waitUntilDone:NO];
}

- (void)testCompleted
{
    [loadingViewController dismissViewControllerAnimated:YES];
    loadingViewController = nil;
} 
```

请注意，等待 30 秒等待应用程序启动的整体用户体验有点糟糕，并且在您使用应用程序时连接经常发生变化，因此即使您每次启动都进行测试，它也不太可能可靠。但如果这是你老板想要的，我会和你一起受苦。;)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-16T14:22:37.037

正如我在评论中所说，无论如何你都应该使用[Hampus Nilsson 的方法](https://stackoverflow.com/a/11435029/207616)在后台执行请求。

关于您的 30 秒问题，我在[另一个博客](http://lukassen.wordpress.com/2010/01/16/avoiding-the-30-second-tcp-timeout-on-iphone-os/)中发现了这一点：

```
- (BOOL)isHostAvailable:(NSString*)hostName
{
    // this should check the host but does not work in the simulator, aka it returns YES when should be no
    SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithName(NULL, [hostName cStringUsingEncoding:NSASCIIStringEncoding]);
    SCNetworkReachabilityFlags flags;
    BOOL success = SCNetworkReachabilityGetFlags(reachability, &flags);
    if (reachability) {
        CFRelease(reachability);
    }

    if ( ( success && (flags & kSCNetworkFlagsReachable) && !(flags & kSCNetworkFlagsConnectionRequired) ) == NO) {
        return NO;
    }

    // we know at least the network is up, second check for a known page
    NSData *dataReply;
    NSURLResponse *response;
    NSError *error;

    // create the request
    NSString *urlString = [NSString stringWithFormat:@"http://%@/index.php", hostName];
    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:urlString]
                                            cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                                        timeoutInterval:8.0];
    // Make the connection
    dataReply = [NSURLConnection sendSynchronousRequest:theRequest returningResponse:&response error:&error];

    if (response != nil) {
        NSLog(@"SNNetworkController.isHostAvailable %@", response);
        return YES;
    } else {
        // inform the user that the download could not be made
        NSLog(@"SNNetworkController.isHostAvailable %@ %@", response, error);
        return NO;
    }
} 
```

这将执行一个超时值为 8 秒的请求。

//编辑：
`ASIHTTPRequest`示例：

```
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
[request setNumberOfTimesToRetryOnTimeout:3];
[request setTimeOutSeconds:20.0];
[request setRequestMethod:@"POST"];
[request startAsynchronous]; 
```

# iphone - 如何将 NS 可变数组插入核心数据

> ID：11434782
> 
> 赞同：1
> 
> 时间：2012-07-11T14:23:20.447
> 
> 标签：iphone, objective-c, xcode4.2

```
-(void)dataManagerDidFinishLoading:(DataManager *)datamgr
{
    NSLog(@"%@.....",datamgr);

    pageArray=[datamgr.resultDataDictionary objectForKey:@"POS_GetPageResult"];
    GetPage *page=(GetPage *)[NSEntityDescription 
                insertNewObjectForEntityForName:@"GetPage" 
                         inManagedObjectContext:managedObjectContext];

   NSError *error;
    if (![managedObjectContext save:&error]) {
        // This is a serious error saying the record could not be saved.
        // Advise the user to restart the application
        NSLog(@"Error........");
    }

    [pageArray insertObject:page atIndex:0];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:29:30.653

您可以使用可转换的核心数据类型。然后你的对象将被解析为一个 id。请记住，可转换属性将传递给 NSData 对象（并反转）以存储（或检索）在核心数据中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T05:52:17.953

使用 NSKeyedArchiver：

```
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:array]; 
```

请注意，数组中的所有对象都必须符合`NSCoding`协议。如果这些是自定义对象，那么这意味着您需要阅读[Encoding and Decoding Objects](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/Archiving/Tasks/codingobjects.html)。您可以将`NSData`as存储`BLOB`在数据库中。希望这对您有所帮助。

# android - 有没有办法在应用程序内的所有正在运行的活动上调用 finish() ？

> ID：11434783
> 
> 赞同：0
> 
> 时间：2012-07-11T14:23:24.573
> 
> 标签：android, android-activity

好吧，我的问题就像标题一样简单：

有没有办法在应用程序内的所有正在运行的活动上调用 finish() ？

所以我需要一种方法来完全关闭我的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:54:16.453

您可以使用 BroadCastReceiver 来实现：

在每项活动中：

```
private BroadcastReceiver mLoggedOutReceiver = new BroadcastReceiver() {
  @Override
  public void onReceive(Context context, Intent intent) {
       finish();
  }
}; 
```

在 onCreate 中注册接收者：

```
registerReceiver(mLoggedOutReceiver, new IntentFilter(Preferences.INTENT_ACTION_LOGGED_OUT)); 
```

在 onDestroy 上：

```
@Override
public void onDestroy() {
    super.onDestroy();
    unregisterReceiver(mLoggedOutReceiver);
} 
```

在每个活动和以下过滤器的清单上：

```
<intent-filter>
    <action android:name="com.example.intent.action.LOGGED_OUT" />
</intent-filter> 
```

我在 Preference 类中声明了意图 Action，如下所示：

```
public static final String INTENT_ACTION_LOGGED_OUT = "com.example.intent.action.LOGGED_OUT";//logout 
```

最后，您所要做的就是从退出按钮或其他东西调用 sendBroadcast ：

```
sendBroadcast(new Intent(Preferences.INTENT_ACTION_LOGGED_OUT));//logout 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:26:08.937

```
android.os.Process.killProcess(android.os.Process.myPid()); 
```

此代码可以关闭您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:27:40.837

`NO`

但是您可以像这样存在漏洞应用程序，`System.exit(0);`但这不是推荐的方式..因为android没有设计退出应用程序。

# javascript - 来自外部站点的 Javascript 放置目标

> ID：11434784
> 
> 赞同：0
> 
> 时间：2012-07-11T14:23:25.737
> 
> 标签：javascript, html, drag-and-drop

我有一个 HTML 列表对象，我想启用它作为从外部站点拖动的链接的放置目标。

更准确地说，我有我的列表，我希望能够从 Youtube 中拖动视频，然后在它提供的链接上运行一个函数。如何检查哪个链接被拖到窗口中？而且我也不希望窗口尝试将整个页面重定向到链接，这可能吗？

编辑：添加我拥有的代码：

我有这个清单：

```
 <ul  id="playlistList">
  </ul> 
```

我用基于视频链接的项目填充它，所以我运行我的函数，它接受一个链接并创建一个 li 对象：

```
//Adds object
AddItem(link) 
```

我需要的是一种拦截窗口上拖动的视频并获取链接，运行该功能，然后停止导航的方法。

# asp.net-mvc-routing - 根据路由参数将请求路由到控制器

> ID：11434785
> 
> 赞同：0
> 
> 时间：2012-07-11T14:23:27.953
> 
> 标签：asp.net-mvc-routing, asp.net-mvc-4, asp.net-web-api

我想根据 URI 中的版本号将请求路由到特定的版本控制器。

例如，

```
routes.MapHttpRoute(
            name: "APIV2",
            routeTemplate: "BlogFeed/{version}/{id}",
            defaults: new { id = RouteParameter.Optional, controller = "BlogFeedV2"}
        ); 
```

我想要的是基于版本路由参数，我想将请求路由到该版本控制器。因此，如果版本路由参数为 v2，则该请求应由 BlogFeedV2 处理。有没有办法处理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:10:48.217

为什么不 ：

```
 routes.MapHttpRoute(
        name: "APIV2",
        routeTemplate: "BlogFeed/v2/{id}",
        defaults: new { id = RouteParameter.Optional, controller = "BlogFeedV2"}
    );       
  routes.MapHttpRoute(
        name: "APIV1",
        routeTemplate: "BlogFeed/v1/{id}",
        defaults: new { id = RouteParameter.Optional, controller = "BlogFeedV1"}
    ); 
```

# java - wkhtmltopdf 进程在 Java 中挂起

> ID：11434788
> 
> 赞同：0
> 
> 时间：2012-07-11T14:23:28.717
> 
> 标签：java, process, pdf-generation, bufferedreader, wkhtmltopdf

我正在从 Java 运行 wkhtmltopdf。我创建了一个进程，但这个进程似乎挂起，因为它在控制台上一次又一次地重复，也在任务管理器中。

这就是我运行 wkhtmltopdf 的方式：

```
String command = applicationLocation + "wkhtmltopdf.exe -O Landscape " + reqURL + "?" + reqQuery + " c:/PDF/" + folderName + "/" + id + "/" + folderName + ".pdf";
Process p = Runtime.getRuntime().exec(command); 
```

工作完成后，我怎样才能“破坏”这个过程？

这对我不起作用，进程从未停止，代码也从未进入 while 循环：

```
ProcessBuilder pb = new ProcessBuilder(application, htmlFilePath, pdfFilePath);
Process process = pb.start();

BufferedReader errStreamReader = new BufferedReader(new InputStreamReader(process.getErrorStream())); 
System.out.println("read errstreamreader");
//not "process.getInputStream()" 

String line = null;

line = errStreamReader.readLine(); 
while(line != null) { 
    System.out.println(line); 
    line = errStreamReader.readLine(); 

    if(line.equals("Done")) {
        process.destroy();
        System.out.println("destroyed process");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T07:02:06.693

那是一个非常丑陋的问题。我的代码导致了循环。我调用了这个类，它使用以下代码从 servlet 生成 PDF：

```
// create pdf
if(action != null && action.equals("pdf")) {
    String reqURL = request.getRequestURL().toString();
    String reqQuery = "id=" + bomModuleId+ "&action=pdf";
    String folderName = "doonot";
    GeneratePDF obj = new GeneratePDF();
    obj.genrateCmd(reqURL, "xxx", "xxx", reqQuery, folderName, "10.07.2012");  
} 
```

事实证明，wkhtmltopdf 使用完全相同的 URL，因此它向该页面发出请求，进入此循环，并再次调用 wkhtmltopdf。所以我最终进入了大约 450 个 wkhtmltopdf 进程，一切都崩溃了。

解决方案：我删除了`"&action=pdf"`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T06:39:47.743

事实证明，我也遇到了同样的问题：循环 wkhtmltopdf 会创建一堆进程，导致我的机器运行 Windows 7 大幅减速。

wkhtmltopdf 的问题并不像 Runtime exec 那样。它会创建更多 wkhtmltopdf 进程，而无需等待之前的任何进程完成，直到系统资源不足导致您的计算机冻结。

我的解决方案：添加`p.waitFor()`. 它将等待 wkhtmltopdf 进程完成，然后继续循环。

这个解决方案可能仍然很慢，因为现在一个大的 html 文件会减慢循环的完成速度。所以，如果你想要一个更快的解决方案，我建议使用`--read-from-stdin`wkhtmltopdf 中的选项。

至于阅读 wkhtmltopdf 的输出，我建议查看[这个问题及其所有答案。](https://stackoverflow.com/questions/5506275/launching-wkhtmltopdf-from-runtime-getruntime-exec-never-terminates)

# c# - Linq 的 FirstOrDefault 充当其他类型？

> ID：11434789
> 
> 赞同：2
> 
> 时间：2012-07-11T14:23:31.197
> 
> 标签：c#, linq, .net-4.0

我有这个代码：

```
var res1 = dtData.AsEnumerable()
            .Where(...)
            .Select(f => new { val = f["PremiumAfterUWDiscount"].ToDecimalOrZero(), 
                   idpolicy = f["IdPolicy"].ToString() })
            .FirstOrDefault(); 
```

然而，由于这返回一个匿名类型，它的默认值是`null`.

我希望它充当类型`FirstOrDefault`。`int`

所以如果没有记录，它将返回 0（默认行为为 int）。

是否可以 ？

*ps（当然我可以在条件下检查它，但我仍然更喜欢 linq 方式）。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:29:00.450

您不能让表达式在两个执行路径上计算为 2 种不同的数据类型。此外，即使有可能， var 也不同于 dynamic，因此编译器不会推断出变量类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:30:46.643

返回一个表示“无”的匿名类型并使用空合并运算符：

```
var res1 = dtData.AsEnumerable()
        .Where(...)
        .Select(f => new { val = f["PremiumAfterUWDiscount"].ToDecimalOrZero(), 
               idpolicy = f["IdPolicy"].ToString() })
        .FirstOrDefault() ?? new { val = 0, idpolicy = "" }; 
```

或者`DefaultIfEmpty`扩展方法：

```
var res1 = dtData.AsEnumerable()
        .Where(...)
        .Select(f => new { val = f["PremiumAfterUWDiscount"].ToDecimalOrZero(), 
               idpolicy = f["IdPolicy"].ToString() })
        .DefaultIfEmpty(new { val = 0, idpolicy = "" })
        .FirstOrDefault(); 
```

如果您实际上返回 an并稍后强制转换（根据@recursive 的回答），则只能返回 an`int`代替匿名类型，但这对我来说似乎适得其反。`object`

`FirstOrDefault`不提供指定“默认”是什么的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:56:38.740

这样做没有任何意义，我鼓励你思考为什么要这样做，并找到一些更清洁、更直接的方法来完成它。

话虽如此，这是对@IronicMuffin 方法的一个小调整，它实际上会起作用。

```
object res1 = dtData.AsEnumerable()
    .Where(...)
    .Select(f => new { 
        val = f["PremiumAfterUWDiscount"].ToDecimalOrZero(), 
        idpolicy = f["IdPolicy"].ToString() 
    })
    .FirstOrDefault() as object ?? 0; 
```

我不认为这很有用。

# ruby-on-rails-3 - 使用 Rails 3 在 ActiveAdmin 中呈现自定义页面

> ID：11434793
> 
> 赞同：3
> 
> 时间：2012-07-11T14:23:41.357
> 
> 标签：ruby-on-rails-3, activeadmin

我看过以下页面： [http ://activeadmin.info/docs/9-custom-pages.html](http://activeadmin.info/docs/9-custom-pages.html)

它没有很多关于如何创建自定义页面的信息。

我需要做的是将自定义操作添加到将我重定向到另一个页面的实体的索引中，即 /admin/mycustompage 。我想从部分呈现我的新页面。它必须看起来类似于视图或编辑页面（带有面包屑和布局）。

文档中的示例太简单了：

```
ActiveAdmin.register_page "My Page" do
    content do
      para "Hello World"
    end
end 
```

如何在内容中呈现部分内容？如何渲染面包屑？这个新页面的 url 是如何指定的？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-12T07:54:46.897

示例页面，呈现 /app/views/admin/password/_index.html.haml 部分：

```
ActiveAdmin.register_page "Password" do

  menu label: I18n.t("menu.change_password")

  content do
    render "index"
  end

end 
```

此页面的默认 url 是 /admin/password （您可以通过调用 'rake routes' 来检查它）。如果您的页面标题包含空格，则必须使用 github 的 aa 版本，因为在此提交之前不可能 - [https://github.com/gregbell/active_admin/commit/30b19c86eef3c504fe71c2e39e072620169b80c2](https://github.com/gregbell/active_admin/commit/30b19c86eef3c504fe71c2e39e072620169b80c2)

# ruby - 如何使用 sinatra 和 rspec 显示页面

> ID：11434794
> 
> 赞同：1
> 
> 时间：2012-07-11T14:23:46.063
> 
> 标签：ruby, sinatra, rspec2

我正在使用 Rspec 来测试 Sinatra 应用程序。有时会出现问题（测试未通过），我希望能够不费吹灰之力地看到页面（相当于黄瓜/webrat 中的“然后显示页面”（我认为）），

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T03:02:23.300

Rack::Test 没有能力做你所要求的，但[Capybara](http://rubydoc.info/gems/capybara/0.3.9/Capybara/SaveAndOpenPage)有。您还需要[Launchy gem](https://rubygems.org/gems/launchy)，以便浏览器在遇到 save_and_open_page 方法时打开。

# c# - 将 Stream.Write 保存到现有的 .CSV 文件不会替换数据，只会添加到现有数据。我如何只替换数据？

> ID：11434797
> 
> 赞同：0
> 
> 时间：2012-07-11T14:23:55.460
> 
> 标签：c#, .net, stream, savefiledialog

以下代码用于保存 CSV 字符串，但是，如果我保存到现有的 .CSV，而不是替换数据，它只会将新字符串添加到已经存在的数据中。我该如何补救？它是 Stream.Write 函数的工作原理所固有的，还是 Excel 和 .CSV 的特性？

```
SaveFileDialog dialog = new SaveFileDialog();

dialog.AddExtension = true;
dialog.Filter = "CSV Files (*.csv)|*.csv|All Files (*.*)|*.*";
dialog.FilterIndex = 1;
dialog.Title = "Save As";
dialog.InitialDirectory = "C:\\";
dialog.CheckPathExists = true;
dialog.DefaultExt = ".csv";
dialog.ValidateNames = true;

if (dialog.ShowDialog() == DialogResult.OK)
{
    StreamWriter myStream = new StreamWriter(dialog.FileName, true);
    myStream.Write(//Function which returns a CSV-formmatted string//);
    myStream.Close();
    OpenFile(dialog.FileName);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:25:44.320

```
StreamWriter myStream = new StreamWriter(dialog.FileName, false); 
```

[http://msdn.microsoft.com/library/36b035cb%28v=vs.100%29](http://msdn.microsoft.com/library/36b035cb%28v=vs.100%29)

第二个参数（bool `append`），描述得很好：

> append 类型：System.Boolean 确定是否将数据附加到文件中。如果文件存在且 append 为 false，则覆盖该文件。如果文件存在且 append 为真，则将数据附加到文件中。否则，将创建一个新文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:26:13.707

设置`append`为 false，这样，`StreamWriter`将覆盖文件，而不是将数据附加到文件中。

```
StreamWriter myStream = new StreamWriter(dialog.FileName, false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:27:15.180

在`new StreamWriter(dialog.FileName, true)` 更改`true`为`false`

Intellisence 会在您键入函数调用时告诉您参数的名称，它可能会为您提供有关它们含义的工具提示。你应该注意这一点

我相信只需键入`new StreaWriter(dialog.FileName)` 默认情况下会将 append 设置为 false 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:27:20.273

将正确的参数传递给[构造函数](http://msdn.microsoft.com/en-us/library/36b035cb.aspx)：

```
new StreamWriter(
    path: path
    append: false); 
```

# java - 如何通过在android的.java文件中提供imgsrc来加载imageview

> ID：11434803
> 
> 赞同：1
> 
> 时间：2012-07-11T14:24:15.270
> 
> 标签：java, android, imageview

我目前参与了一个关于酒店和餐馆的项目。我的数据库包含酒店 ID（1,2,3,...），我需要加载相应酒店/餐厅的图像（image1,image2,...），我必须通过 .java 为其提供图像 src文件。我使用的代码是：

```
 String icon="image" + h_id;
    int resID = getResources().getIdentifier(icon, "drawable","testing.Image_Demo");
    image.setImageResource(resID); 
```

但是，问题是酒店图像没有加载。我在这个网站上经历了不同的问题，但问题仍然存在。有没有人有解决这个问题的想法？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:52:38.097

我创建了以下示例活动，如果我在可绘制文件夹中有一个“image.png”图像文件，它可以正常工作：

```
public class TestActivity extends Activity {

public void onCreate(Bundle savedInstanceState) {   
    super.onCreate(savedInstanceState);    

    String icon = "image";        
    int resId = getResources().getIdentifier(icon, "drawable", getPackageName());

    ImageView imgView = new ImageView(this);
    imgView.setImageResource(resId);

    setContentView(imgView);
} 
```

}

您是否检查过您的包裹名称是否正确？

# php - 尝试使用 INNER JOIN 关联两个表时，我的 php 模板中出现 foreach() 错误

> ID：11434804
> 
> 赞同：0
> 
> 时间：2012-07-11T14:24:30.637
> 
> 标签：php, mysql, foreach, inner-join

我正在阅读 Kevin Yank 的书“ [PHP and MySQL Novice to Ninja 5th edition](http://www.sitepoint.com/books/phpmysql5/) ”，并在代码中发现了一个错误，并希望有人帮助我解决它，也许是一个愚蠢的错字......？

我正在尝试按照作者创建和访问笑话数据库的示例。我正在学习如何加入两个数据库以使用 php 显示所有笑话的列表。我有两个数据库笑话和作者。我有这个：

```
try{ 
    $sql = 'SELECT joke.id, joketext, jokedate, name, email
    FROM joke INNER JOIN author
    ON authorid = author.id';
    $result = $pdo->query($sql);
}
catch (PDOException $e)
{
    $error = 'Error: ' . $e->getMessage();
    include 'error.html.php';
    exit();
}

foreach ($result as $row)
{
    $jokes[] = array(
    'id' => $row['id'], 
    'text' => $row['joketext'], 
    'date' => $row['jokedate'],
    'name' => $row['name'],
    'email' => $row['email']
    );
}
include 'jokes.html.php'; 
```

现在，一切正常，直到我将用于从一个表中选择数据库信息的简单代码替换为 INNER JOIN 代码。这是本书的代码，我一直遵循。

在jokes.html.php 文件中，我得到了这个（我认为这是给我错误的原因）：

```
 foreach($jokes as $joke): 
      <form action="?deletejoke" method="post">
  <?php 
      echo 'id. ';
  echo htmlspecialchars($joke['id'], ENT_QUOTES, 'UTF-8');
  echo htmlspecialchars($joke['date'], ENT_QUOTES, 'UTF-8');
  echo htmlspecialchars($joke['text'], ENT_QUOTES, 'UTF-8'); 
  echo htmlspecialchars($joke['name'], ENT_QUOTES, 'UTF-8');
      echo htmlspecialchars($joke['email'], ENT_QUOTES, 'UTF-8');
  ?>
  <input type="hidden" name="id" value="<?php echo $joke['id'];?>">
  <input type="submit" value="Borrar">
  ?>
  <br></form>
<?php endforeach; ?> 
```

现在，抛出我的错误是：

注意：未定义变量：第 10 行 C:\xampp\htdocs\workspace1\jokes.html.php 中的笑话

警告：第 10 行 C:\xampp\htdocs\workspace1\jokes.html.php 中为 foreach() 提供的参数无效

jokes.html.php 的第 10 行是：

```
foreach($jokes as $joke): 
```

我正在尝试获取有关 foreach() 的更多信息，但我无法发现错误...如果有人可以帮助我一点（或者可能是一个线索！），我将非常感激。谢谢！！！罗莎蒙达

**更新：**

由于查询的结果（直接从 phpmyadmin 尝试）为零，因此该查询没有数据库结果。我决定手动添加一个结果：

```
INSERT INTO joke SET
joketext = 'this is a new joke....',
jokedate = '2012-01-01',
authorid = 1; 
```

现在，错误已经消失，而单一的结果确实显示出来了。

我不明白的是：

***为什么不只是没有结果出现，而不是那些错误？***

***您如何处理这些情况？我的意思是，查询可能根本没有结果，导致这些错误是否常见？***

***您的一个有用的评论说 $result 是空的......那么为什么当查询不为零时，这些错误不会出现？***

再次感谢你的帮助！！！罗莎蒙达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T00:21:37.847

[我在SitePoint 论坛（图书论坛）](http://www.sitepoint.com/forums/showthread.php?866328-Example-in-Kevin-Yank%B4s-book-won%B4t-work-(involves-INNER-JOIN-and-foreach())-page-151&p=5149876#post5149876)中找到了答案，我认为在这里发布问题会很好，以防万一有人想知道，或者万一有人碰巧有同样的问题问题。

> 这是因为您的 php 设置显示通知和警告。通知/警告是有效的，因为您在声明/分配值之前尝试使用 $jokes 变量。`$jokes = array();`您可以通过在 PHP 代码之前添加以下内容来解决此问题：
> 
> ```
> foreach ($result as $row) 
> { 
>     $jokes[] = array( 
>     'id' => $row['id'],  
>     'text' => $row['joketext'],  
>     'date' => $row['jokedate'], 
>     'name' => $row['name'], 
>     'email' => $row['email'] 
>     ); 
> } 
> ```
> 
> 如果结果为零，那至少会声明 $jokes 变量。

所以，我认为结论（如果我在这里错了，请纠正我！）是**你应该总是声明你假装使用的任何变量，以防它碰巧没有结果。因为如果它是空的，它会显示一个令人讨厌的错误消息，这会让你感到害怕。**

并声明一个你使用的变量`$variablename = array()`。

# php - CakePHP 中缺少数据库表，我遵循约定并尝试了一切

> ID：11434810
> 
> 赞同：1
> 
> 时间：2012-07-11T14:25:01.717
> 
> 标签：php, database, cakephp, model

我的应用程序适用于其他模型，但由于某种原因，当我尝试保存到 db 表时，“投票”模型无法连接到它。我已经在这几天了，我觉得我已经尝试了一切！

这是我的控制器 VoteController.php 调用模型（为便于阅读而编辑）：

```
<?php

class VoteController extends AppController {

    var $uses = array('Track', 'Vote');

    function upvote() {
        $this->autoRender = false;
        $User = $this->auth();
        if ($User) {
            $track_id = @$this->params['id'];
            $this->Vote->upvote($track_id, $User['User']['id']);
        }
    }

}

?> 
```

这是模型vote.php：

```
<?php

App::uses('AppModel', 'Model');

class Vote extends AppModel {

    var $name = 'Vote';

    function upvote($id, $user_id) {
        $VoteObject = array('Vote' => array(
                'u_id' => $user_id,
                't_id' => $id,
                'upvote' => 1,
                'downvote' => 0
                ));
        $this->save($VoteObject);
    }

}

?> 
```

当然，在我的数据库中，我有一个“投票”表，其中包含 id、u_id、t_id、upvote 和 downvote 列。一切执行后，我得到这个错误：

缺少数据库表

错误：在数据源默认值中找不到模型投票的表投票。

我试过删除 tmp 中的文件，以及重命名所有内容、打印查询等，但我似乎无处可去。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:43:23.470

尝试删除此行

```
App::uses('AppModel', 'Model'); 
```

并将其添加到课程中

```
var $useTable = 'votes'; 
```

看起来它正在尝试使用正确的名称。所以这可能不是问题。您能否验证您的数据源是否设置正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T10:30:10.663

尝试清除 tmp/cache 目录。为我固定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T18:25:29.717

根据 CakePhp 约定，你的控制器应该是复数形式，最后用 Controller 这个词，还要确保你的控制器命名为 VotesController.php

```
 <?php
   class VotesController extends AppController {

}

?> 
```

在您使用的模型上：

```
 var $name = 'Vote'; 
```

你应该使用： var $name = 'Votes'; （复数）并确保您的模型名称是 Vote.php（单数）。

你也**应该**这样做：

```
function upvote($id, $user_id) {
    $VoteObject = array('Vote' => array(
            'u_id' => $user_id,
            't_id' => $id,
            'upvote' => 1,
            'downvote' => 0
            ));
    $this->save($VoteObject);
} 
```

在控制器内部而不是模型中。

# c# - XAML 中的 Setter 属性

> ID：11434811
> 
> 赞同：0
> 
> 时间：2012-07-11T14:25:03.120
> 
> 标签：c#, wpf, xaml

怎么了？

```
<Style TargetType="ComboBox" x:Key="ComboBoxStyleMex">
    <Setter Property="Name" Value="stcombo" />
</Style> 
```

和

```
<DataGridComboBoxColumn SelectedItemBinding ="{Binding name_ru}" Header="Статус" CellStyle="{StaticResource ComboBoxStyleMex}">
</DataGridComboBoxColumn> 
```

为什么没有设置名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:52:29.300

请尝试为 SelectedValueBinding 而不是 SelectedItemBinding 进行绑定，然后重试

希望这可以帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T15:39:17.280

不能在样式中设置名称。

从样式中设置的名称应用于同一范围内的多个实例，例如窗口，理论上应该由于名称重复而导致编译器错误（请记住名称变成代码隐藏的可访问变量名称），但样式直到运行时才应用所以编译器不会知道样式中的名称，它需要在编译期间使用。为了防止这种悖论，Styles 不能设置 Name。

# c++ - LogonUser 在 Windows 7 上返回错误凭据很慢

> ID：11434813
> 
> 赞同：3
> 
> 时间：2012-07-11T14:25:15.173
> 
> 标签：c++, windows

我使用 LogonUser 来验证凭据。在 Windows 7 PC 上，如果失败，用户可能需要等待 30 秒才能返回函数。这在 XP 上不会发生 - 该函数返回得非常快。这是我的代码：

```
HANDLE hToken;

bool bSuccess = LogonUser(StringUserName, "MyDomain", StringPassword, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, &hToken); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:32:05.683

我不知道 Windows 的特定 API 是如何处理这个问题的，但通常认为在登录凭据错误时不要立即返回是个好主意，以避免暴力攻击。我可以想象 Windows 自 WinXP 以来添加了此功能。

# c++ - VC++ 异常处理 - 应用程序无论如何都会崩溃

> ID：11434817
> 
> 赞同：1
> 
> 时间：2012-07-11T14:25:26.097
> 
> 标签：c++, visual-c++, exception-handling

以下是我在学习C++异常处理过程中写的代码片段（使用Visual Studio 2010编译器）。

```
#include "stdafx.h"
#include <iostream>
using namespace std;
void multi_double() {

double first,second,product;
try{
cout << "Enter the first number\n";
cin >> first;
cout << "Enter the second number\n";
cin >> second;
product = first * second;
cout << product;
}
catch(...){cout << "Got an exceptional behaviour";}

}
void stud_age(){
int age;
try{
cout << "Enter student's age\n";
cin >> age;
if(age < 0)
    throw;
cout << endl <<age;
}
catch(...) {
    cout << "Caught here\n";
}
}
class Model{
public:
Model(){cout << "ctor\n";}
~Model(){cout << "dtor\n";}
};
int _tmain(int argc, _TCHAR* argv[]) {
//multi_double();
//stud_age();
int a;
try{
    Model obj;
    int *p = NULL;
    *p = 0;//expecting access violation exception

}
catch(...){
    cout << "caught an exception\n";
}
return 0;
} 
```

启用 C++ 异常设置为 Yes[/EHsc]。但是当我运行应用程序时，它仍然崩溃！带有以下信息：

问题签名：问题事件名称：APPCRASH 应用程序名称：DataTypeConversions.exe 应用程序版本：0.0.0.0 应用程序时间戳：4ffd8c3d 故障模块名称：DataTypeConversions.exe 故障模块版本：0.0.0.0 故障模块时间戳：4ffd8c3d 异常代码：c0000005 异常偏移量： 00001051

为什么不控制来抓挡？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:39:14.860

访问冲突和所有其他类型的硬件异常在 Windows 中使用称为“C 结构化异常处理 (SEH)”的机制进行处理。这最初旨在为 C 程序提供一种比基于 Posix 的系统中通常的 signal()/sigaction() 机制更“结构化”的方式来处理异常。

SEH 异常*可以*集成到 C++ 异常系统中，方法是设置一个在 SEH 堆栈展开之前调用的转换器函数。新的翻译函数简单地抛出一个 C++ 异常，然后，C++ 可以捕捉到错误！

有关所有详细信息，请参阅 MSDN 中的此文档：

[http://msdn.microsoft.com/de-de/library/5z4bw5h5(v=vs.80).aspx](http://msdn.microsoft.com/de-de/library/5z4bw5h5(v=vs.80).aspx)

这是一个工作示例：

```
#include <windows.h>
#include <iostream>
#include <eh.h>
// You need to enable the /EHa excpetion model to make this work.
// Go to 
// Project|Properties|C/C++|Code Generation|Enable C++ Exceptions
// and select "Yes with SEH Exceptions (/EHa)"

void trans_func( unsigned int u, EXCEPTION_POINTERS* pExp )
{
    // printf( "In trans_func.\n" );
    throw "Hardware exception encountered";
}

int main() 
{
    _set_se_translator(trans_func);
    try
    {
        int *p = NULL;
        *p = 0;//expecting access violation exception
    }
    catch(const char *s)
    {
        std::cout << "caught an exception:" << s << "\n";
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:28:36.597

C++ 异常处理系统不能硬件生成（即访问冲突等）异常，只能通过`throw exception;`.

如果要捕获这些异常，只有在 Windows 中通过使用[结构化异常](http://msdn.microsoft.com/en-us/library/swezty51%28v=vs.80%29.aspx)才有可能。这与其他编译器不兼容，并且使用`__try` `__except`构造而不是普通`try`/ `catch`。

# sql-server - SQL Server While 循环未返回预期值

> ID：11434821
> 
> 赞同：1
> 
> 时间：2012-07-11T14:25:33.487
> 
> 标签：sql-server, function

这是我函数中的代码：

```
-- Get Country Names
DECLARE getCountriesName CURSOR FOR
    SELECT c.Name
    FROM VocabCountry c
        RIGHT OUTER JOIN ProjectCountryRelations cr
            ON cr.CountryId = c.Id
    WHERE 
        c.Id = @project_id;

-- Finally Create list to return 
OPEN getCountriesName;
FETCH NEXT FROM getCountriesName INTO @Name;
WHILE @@FETCH_STATUS = 0
BEGIN  

    SET @listOfItems = @listOfItems + @Name + ', '
    FETCH NEXT FROM getCountriesName INTO @Name;

END;
CLOSE getCountriesName;
DEALLOCATE getCountriesName; 
```

我期待一个逗号分隔值的列表，例如，像这样：

```
Canada, United States of America, 
```

我验证`SELECT`了国家预期的回报。

谢谢你的帮助！

埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:34:58.093

如果您使用的是 SQL Server **2008**或更高版本，您可以使用单个 SELECT 和一些`FOR XML PATH`魔法轻松完成此操作 :-)

```
SELECT 
    STUFF(
       (SELECT ',' + c.Name
        FROM VocabCountry c
        RIGHT OUTER JOIN ProjectCountryRelations cr
        ON cr.CountryId = c.Id
        FOR XML PATH('')
       ), 1, 1, '') 
```

这应该为您返回这些国家名称的逗号分隔列表。不需要丑陋和可怕的光标！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:41:53.597

使用`FOR XML PATH`将用逗号连接值。

使用该`STUFF`函数将删除您不想要的第一个逗号。

所以使用这个：

```
SELECT 
    STUFF(
       (SELECT ',' + c.Name
        FROM VocabCountry c
        RIGHT OUTER JOIN ProjectCountryRelations cr
        ON cr.CountryId = c.Id
        WHERE cr.Id = @project_id
        FOR XML PATH('')
       ), 1, 1, ''); 
```

看到这个小提琴：[http ://sqlfiddle.com/#!3/fd648/21](http://sqlfiddle.com/#!3/fd648/21)

# php - 只有提交页面是ajax成功

> ID：11434824
> 
> 赞同：0
> 
> 时间：2012-07-11T14:25:41.180
> 
> 标签：php, jquery, ajax

我正在用 jQuery 和 PHP 发送电子邮件，如果 ajax 成功，我需要告诉页面提交，否则不要提交。我试图将返回值放在成功和错误属性中，但这不起作用，所以我想看看我是否可以通过返回 false 将表单设置为不发送，但如果它成功让它提交一些页面服务器端工作。

在下面的示例中，我尝试设置一个变量并使用条件来读取它。我收到一条错误消息，因为该值似乎没有全局传递，所以当条件读取 sendMe 时，它​​说它是未定义的。

有没有办法正确地做到这一点？

```
$.ajax({
    type: "POST",
    url: "send.php",
    data: data,
    success: function(){
        var sendMe = 'true';
    },
    error: function(){
        alert('Error: Message could not be sent');
    }
});

if (sendMe == 'true'){
    //Submit the page...                    
}
else {
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:27:30.573

只需创建一个`sendMe()`函数，然后从`success:` That 调用该函数就可以了。

您的代码不起作用的原因是因为 javascript 没有等待 ajax 调用返回，在 ajax 调用之后它立即评估 sendMe ，此时仍然是错误的。

您当然可以考虑同步进行此调用以防止这种情况发生，但我不确定这是正确的方法。（`async : false`自 jQuery 1.8 起已弃用）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:35:37.443

您的条件 if(sendMe == 'true') ... 何时被调用？

做一个这样的小功能：

```
 function sendMe(){
    // whatever your form's id is, put it in place of myForm
    $("#myForm").submit();
    return true;
    } 
```

并在您的 ajax 成功块中调用该函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:38:50.820

尝试使用此设置：

```
var form = this;
$.ajax({
    type: "POST",
    url: "send.php",
    data: data,
    success: function(){
        form.submit(); // submit form, bypassing jQuery events
    },
    error: function(){
        alert('Error: Message could not be sent');
    }
});
return false; // prevent submit 
```

通过在 ajax 请求后返回 false，我们阻止了提交，然后我们直接提交表单绕过所有 jQuery 的提交处理程序使用`form.submit();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:38:55.473

将表单设置为通过提交事件的验证器方法：

`<form onSubmit='return checkForm();'> </form>`

在这种方法中 - `checkForm()`- 正常执行您的 ajax 发布。如果 ajax 帖子返回“成功”，则继续提交，否则使用`return false;`取消提交并相应地通知用户。

# wolfram-mathematica - 我想为我的样本数据的每个 x 值添加高斯噪声，然后绘制

> ID：11434828
> 
> 赞同：0
> 
> 时间：2012-07-11T14:25:56.460
> 
> 标签：wolfram-mathematica, plot, noise

我在绘制这个时遇到了一些问题。一切都很好，直到没有任何情节的情节声明。有人可以帮助我，以便它可以绘制一些东西。以下是我的代码：

```
j = 10; 
s = 0; r = 0;

B[n_] = Integrate[2*Sin[n*Pi*x]*(x), {x, 0, 1}];
u[x_, psi_] = Sum[B[n]*Sin[n*Pi*x]*Exp[-(n*Pi)^2*psi], {n, 1, j}];

K[x_, psi_] = 
  Sum[Sin[n*Pi*x]*
    Sin[n*Pi*
      psi]*(2*Exp[-(n*Pi)^2*
         Abs[s + r]] - (Exp[-(n*Pi)^2*Abs[s - r]] - 
         Exp[-(n*Pi)^2*(s + r)])/(n*Pi)^2 ), {n, 1, j}];

w = RandomReal[NormalDistribution[0, 1], 101];
d = Round[100*x + 1];
S = Total[Total[u[x, psi]/Length[u[x, psi]]] + w[d]]

T[x_, psi_] = Integrate[K[x - y, psi]*(y)*S, {y, -10, 10}]

Plot3D[T[x, psi], {x, 0, 1}, {psi, 0.01, 1}, 
 AxesLabel -> {"x", "t", "Temperature"}, Boxed -> False, 
 Mesh -> False] 
```

基本上，我有一些来自“u”的数据，我想让每个“x”值（来自“w”）变得嘈杂，然后在“T”中执行卷积并绘图。

我将非常感谢任何人的帮助。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:31:41.980

看起来非常像是您`=`在应该使用的地方使用`:=`. 前者进行立即赋值（称为`Set`），而另一个进行延迟赋值（`SetDelayed`）。区别是*Mathematica*的基础，你应该阅读文档，直到你彻底理解这个区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T04:13:32.297

我不确定我是否理解您要解决的问题。但是，如下所示修改您的代码允许它运行 - 我将几个表达式改写为函数（一个好的经验法则是使用 := 如果左侧涉及模式，如 B[n_]）并且我删除了一些显然试图将标量视为向量的代码。

```
j = 10; s = 0; r = 0;

ClearAll[B];
B[n_] := B[n] = Integrate[2*Sin[n*Pi*a]*(a), {a, 0, 1}];

ClearAll[u];
u[x_, psi_] := Sum[B[n]*Sin[n*Pi*x]*Exp[-(n*Pi)^2*psi], {n, 1, j}];

K[x_, psi_] := 
  Sum[Sin[n*Pi*x]*
    Sin[n*Pi*
      psi]*(2*Exp[-(n*Pi)^2*Abs[s + r]] - (Exp[-(n*Pi)^2*Abs[s - r]] -
          Exp[-(n*Pi)^2*(s + r)])/(n*Pi)^2), {n, 1, j}];

S[x_, psi_] := u[x, psi] + RandomReal[NormalDistribution[]]

T[x_, psi_] := Integrate[K[x - y, psi]*(y)*S[x, psi], {y, -10, 10}]

Plot3D[T[x, psi], {x, 0, 1}, {psi, 0.01, 1}, 
 AxesLabel -> {"x", "t", "Temperature"}, Boxed -> False, 
 Mesh -> False] 
```

运行一段时间（〜1小时）后，它会产生下面的情节

![T 的图](../Images/3a55292b8f713618641bfc81cb3dc504.png)

可能有一种更有效的方法来使用更惯用的方法来生成这个情节。如果您可以提供有关您尝试使用发布的代码做什么的更详细信息，那么也许我或其他人可以为您提供更有用的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:14:23.720

这是基于您的问题大纲的模板解决方案：

```
data = RandomInteger[{0, 1}, 100]; (* data creation function *) 
noise = RandomVariate[NormalDistribution[0, 1], Length@data]; (* noise vector *)
noisyData = data + noise; (* sum noise and data *)
ListConvolve[data, noisyData] (* apply convolution *) 
```

> {8.20928}

这个原型如何与您的目标相匹配？

# google-docs-api - 评论者的 AclRole

> ID：11434832
> 
> 赞同：2
> 
> 时间：2012-07-11T14:26:03.557
> 
> 标签：google-docs-api, google-drive-api

我在更新 Google 文档的 Acl 时遇到问题。我想与一些用户共享文档，但只允许 COMMENTER 权限。这是代码：AclEntry newAclEntry = getDservice().insert(new URL(aclFeedUrl), new AclScope(AclScope.Type.USER, "user1@domain.com"), AclRole.COMMENTER);

现在 Eclipse 告诉我 AclRole.COMMENTER 是一个有效类型，但是当我运行代码时，我得到以下异常：服务异常：发布的条目对字段具有无效值：角色

如果我将其更改为 AclRole.READER 它工作正常。

所以我想我会做一些调查。您可以通过“共享”从 Google Doc 设置 COMMENTER 访问权限。所以我这样做了，然后通过以下方式阅读了文档的 ACL：

`AclFeed feed = getDservice().getFeed(new URL(doc.getAclFeedLink().getHref()),AclFeed.class);`

 ````
 if (feed == null) 
            System.out.println("Feed is null");
        else {

            for (AclEntry a: feed.getEntries()) {
                System.out.println("acl role:" + a.getRole().getValue());
                System.out.println("acl scope:" + a.getScope().getValue());
            }
        } 
```` 

`具有 COMMENTER 访问权限的 user1 和具有 READER 访问权限的 user2 的输出是：`

 `acl 角色：读者 acl 范围：user1@domain.com

acl 角色：读者 acl 范围：user2@domain.com

因此，即使 user1 明确是 COMMENTER，它也会被报告为“读者”

如果我访问 AclRole 的在线文档，则没有 COMMENTER 枚举 (https://developers.google.com/gdata/javadoc/com/google/gdata/data/acl/AclRole)。

那么，如何为仅评论权限设置 ACL？显然，Google Docs 支持它，并且 Eclipse 正在从我正在使用的 GData jar 中获取它。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:37:05.083

这里缺少的是检查`additionalRole`ACL 条目的字段。用户是读者*和*评论者。查看来自 Documents List API 的原始 XML 响应：

```
<entry gd:etag='W/&quot;D0UFQH4_eCt7ImAe9WhJREEk.&quot;'>
  <id>https://docs.google.com/feeds/id/user%3Aa%40b.com</id>
  <updated>2012-07-11T22:20:11.040Z</updated>
  <app:edited xmlns:app='http://www.w3.org/2007/app'>2012-07-11T22:20:11.040Z</app:edited>
  <category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/acl/2007#accessRule'/>
  <title>Document Permission - a@b.com</title>
  <link rel='self' type='application/atom+xml' href='https://docs.google.com/feeds/default/private/expandAcl/document%3A1lD_aQPqe33JI4mObm2zc7FADUH-ypXcGekwAovPY2OpMw/acl/user%3Aa%40b.com'/>
  <link rel='edit' type='application/atom+xml' href='https://docs.google.com/feeds/default/private/expandAcl/document%3A1lD_aQPqe33JI4mObm2zc7FADUH-ypXcGekwAovPY2OpMw/acl/user%3Aa%40b.com'/>
  <gAcl:role xmlns:gAcl='http://schemas.google.com/acl/2007' value='reader'/>
  <gAcl:scope xmlns:gAcl='http://schemas.google.com/acl/2007' type='user' value='a@b.com' name='Anderson Jones'/>
  <gAcl:additionalRole xmlns:gAcl='http://schemas.google.com/acl/2007' value='commenter'/>
</entry> 
```

注意 的`gAcl:additionalRole`值为`commenter`。

试试这个代码来创建一个评论者条目：

```
AclEntry aclEntry = new AclEntry();
aclEntry.setScope(new AclScope("user", "user1@domain.com"));
aclEntry.setRole(AclRole.READER);
aclEntry.addAdditionalRole(AdditionalRole.COMMENTER); 
```

要确定一个条目是否有`commenter` `additionalRole`，请执行以下操作：

```
if (aclEntry.getAdditionalRoles().contains(AdditionalRole.COMMENTER)) {
  // Do something knowing this user is a commenter
} 
```

但是，您确实应该升级到[Drive API v2](https://developers.google.com/drive/v2/reference/)，这会更容易。以下代码示例适用于 Drive API：

```
Permission permission = new Permission();
permission.setType("user");
permission.setValue("user1@domain.com");
permission.setRole("reader");
permission.setAdditionalRoles(Arrays.asList("commenter")); 
```

感谢[Alain Vongsouvanh](https://stackoverflow.com/users/1106381/alain)提供了部分答案！`

# java - 在 Java 中将 Big Wav 文件提取为更小的块

> ID：11434833
> 
> 赞同：1
> 
> 时间：2012-07-11T14:26:05.367
> 
> 标签：java, wav

我有一个大的 wav 文件，我想将它分成更小的块。我还有一个 .cue 文件，它具有帧速率长度，较小的块应该是。我想出了如何拆分 wav，但是制作的所有 wav 文件都是相同的声音。似乎每次我创建一个新的 wav 时，大 wav 文件都会从头开始，并使新的波形长度正确但声音相同。

我想我需要一种方法将 wav 读取到特定帧，然后写入文件，然后继续读取和写入另一个文件，等等...

我已经在这几个小时了，似乎无法弄清楚。任何帮助将不胜感激。这是我的代码，所有注释的内容都是我一直在尝试的错误代码。

```
 int count2 = 0;
  int totalFramesRead = 0;
        //cap contains the how many wav's are to be made
        //counter contains the vector position.
        String wavFile1 = "C:\\Users\\DC3\\Desktop\\wav&text\\testwav.wav";
            //String wavFile2 = "C:\\Users\\DC3\\Desktop\\waver\\Battlefield.wav";
            while(count2 != counter){
            try {
                    AudioInputStream clip1 = AudioSystem.getAudioInputStream(new File(wavFile1));
                    int bytesPerFrame = clip1.getFormat().getFrameSize();
                    //System.out.println(bytesPerFrame);
//                     int numBytes = safeLongToInt(clip1.getFrameLength()) * bytesPerFrame; 
//                     byte[] audioBytes = new byte[numBytes];
//                     int numBytesRead = 0;
//                     int numFramesRead = 0;
//                     // Try to read numBytes bytes from the file.
//                     while ((numBytesRead = 
//                       clip1.read(audioBytes)) != -1) {
//                       // Calculate the number of frames actually read.
//                       clip1.read(audioBytes)
//                       numFramesRead = numBytesRead / bytesPerFrame;
//                       totalFramesRead += numFramesRead;
//                       System.out.println(totalFramesRead);
//                     }

                    long lengthofclip = Integer.parseInt(time.get(count2))- silence;

                    globallength = clip1.getFrameLength();
                    AudioInputStream appendedFiles = new AudioInputStream(clip1, clip1.getFormat(), lengthofclip);
                    //long test = (appendedFiles.getFrameLength() *24 *2)/8;
                    //int aaaaa = safeLongToInt(test);
                    //appendedFiles.mark(aaaaa);
                    AudioSystem.write(appendedFiles, 
                            AudioFileFormat.Type.WAVE, 
                            new File("C:\\Users\\DC3\\Desktop\\wav&text\\" + name.get(count2)));
                            count2++;
            } catch (Exception e) {
                    e.printStackTrace();
            }
        }
  }
  public static int safeLongToInt(long l) {
    if (l < Integer.MIN_VALUE || l > Integer.MAX_VALUE) {
        throw new IllegalArgumentException
            (l + " cannot be cast to int without changing its value.");
    }
    return (int) l;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T17:44:40.790

乍一看只是一个想法，但我假设这条线给了麻烦：

```
AudioInputStream clip1 = AudioSystem.getAudioInputStream(new File(wavFile1)); 
```

把它放在你的while循环之外，这样它就不会在每个循环中重新创建。像这样：

```
//...
    String wavFile1 = "C:\\Users\\DC3\\Desktop\\wav&text\\testwav.wav";
    AudioInputStream clip1 = AudioSystem.getAudioInputStream(new File(wavFile1));
    int bytesPerFrame = clip1.getFormat().getFrameSize();

        while(count2 != counter){
        try {
//... 
```

这也假设您的算法是正确的，我不会浪费时间考虑，因为您没有问那个问题:-D

# javascript - 选择单选按钮后如何启用提交按钮？

> ID：11434834
> 
> 赞同：-1
> 
> 时间：2012-07-11T14:26:06.580
> 
> 标签：javascript, perl, cgi, dynamic-html

我正在编写一个 Perl CGI 脚本。

起初提交按钮是禁用的，当任何一个单选按钮被选中时它应该被启用。每个对应的行（同名）都有一个单选按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:20:20.963

这更可能是一个*JavaScript*问题，除非您想在启用提交按钮的情况下重新加载页面。但是您可以在 CGI 中*指定*JavaScript 事件。

对于广播组来说，这只是有点棘手。由于`radio_group`sub 允许每个项目的属性，您只需为每个选择指定相同的事件。

```
my @values = qw<eenie meenie minie>;
my $enableSubmit 
    = { -onClick => q[document.getElementById('mySubmitButton').disabled = false;] }
    ;
print CGI->radio_group(
      -name       => 'group_name'
    , -values     => \@values
    , -default    => 'meenie'
    , -linebreak  => 'true'
    , -labels     => { map { $_ => ucfirst } @values }
    , -attributes => { map { $_ => $enableSubmit } @values } 
    ); 
```

# jquery - jquery slideup和slideup忽略父div

> ID：11434837
> 
> 赞同：1
> 
> 时间：2012-07-11T14:26:09.867
> 
> 标签：jquery, html

我希望用户能够单击 div，以向下滑动另一个子 div。当用户单击该子 div 内的按钮时，子 div 将向上滑动。

使用以下 JQuery，div 可以很好地向下滑动。但是，当我单击按钮时，它会向上滑动，然后又迅速向下滑动。

```
<script type="text/javascript">
    $('.comment').hide() // hides all the divs which have been generated. These are the ones that need to slideUp and slideDown. 

    $(".listview-item-inside-comment").live('click', function () {
        $(this).find(".comment").slideDown();
    });

    $(".form-button").live('click', function (e) {
        if($(e.target).is(":hidden")) return;
        $(this).parents(".comment").slideUp();
    });

</script> 
```

如果有帮助，这里是 HTML：

```
<div class="listview-item-comment">
    <div class="listview-item-inside-comment">
        <a>Here is a comment...</a>
        <div class="listview-item-info">
            username @ timestamp
            <a style="float: right;">click to reply</a>
        </div>

        <div class="comment">
            <form>
                <textarea name="commentField">Write your comment here...</textarea>
                <p align="center">
                    <input type="submit" class="form-button" value="Submit Comment" />
                    <input type="button" class="form-button" value="Cancel" />
                </p>
            </form>
        </div>
    </div>
</div> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:31:07.980

您的子点击正在冒泡 dom 三，导致再次触发父点击。

将您的代码更改为：

```
 $(".form-button").live('click', function (e) {

        e.stopPropagation(); // stop event bubling

        if($(e.target).is(":hidden")) return;
        $(this).parents(".comment").slideUp();
    }); 
```

# .htaccess - .htaccess：使用来自 RewriteCond 的域名

> ID：11434839
> 
> 赞同：1
> 
> 时间：2012-07-11T14:26:11.887
> 
> 标签：.htaccess

我一直在谷歌上搜索我遇到的问题，到目前为止我还没有发现任何有用的东西。

我拥有的是一个 Drupal 多站点安装，我正在尝试为移动设备设置重定向。首先，我有 10 个只有一个公共字符串 www 的域。我想要检查查看站点的设备是否是移动设备（我正在使用 AMF 成功执行此操作）并确保访问者尚未使用 m.domain.tld 的移动版本。如果一切都好，那么我需要将用户重定向到移动子域。

使用以下方法对每个域执行此操作：

```
RewriteCond %{ENV:AMF_DEVICE_IS_MOBILE} ^true$
RewriteCond %{ENV:AMF_DEVICE_IS_TABLET} !^true$
RewriteCond %{HTTP_HOST} !^[m.]+mysite.com$
RewriteRule (.*) http://m.mysite.com/$1 [R=301,L] 
```

但是，我不想拥有 10 个这些块（每个域 1 个），也不想在每次创建新网站时都创建另一个块。

我读过你可以在 RewriteCond 模式中使用 () 来从匹配模式中创建一个 var 。不幸的是，我认为我没有正确地制作我的模式或其他东西，因为当我尝试以下操作时，它会重定向到 m。紧随其后的请求 uri 是什么。

为简洁起见，我省略了 AMF 条件。

```
RewriteCond %{HTTP_HOST} !^[m.]+([^.]\.[com|net|org])$
RewriteRule (.*) http://m.%1/$1 [R=301,L] 
```

根据我阅读的内容， %1 应该与 RewriteCond 中的模式匹配，但它不匹配任何内容。这让我觉得我的模式是错误的。我尝试将 ([^.].[com|net|org]) 更改为 (.*) 但遇到相同的问题，它只是重定向到 m..

我是否正确假设我的模式是错误的，如果是这样，我应该使用什么？我想要做的甚至可能吗？

需要明确的是，我的域采用以下形式：

www.domain.com

www.anotherdomain.net

somedomain.org

www.maybeanotherdomain.com

在我的示例中，我有标志 R=301，但在测试中我将其排除在外，并且每次测试时都必须从浏览器中清除大量数据，以确保我采用了新规则。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:32:45.493

您不能反向引用*不*匹配 (!)，但您可以将条件分成 2 个匹配**%{HTTP_HOST}**变量：

```
RewriteCond %{HTTP_HOST} !^m\.
RewriteCond %{HTTP_HOST} ([^\.]+)\.(com|net|org)$ [NC]
RewriteRule (.*) http://m.%1.%2/$1 [R=301,L] 
```

您可能需要根据您的需要定制`([^\.]+)\.`位，此表达式将仅匹配**"www.domain.com"的****"domain"**部分。

# mysql - MySQL中的逻辑运算符，设置一组规则

> ID：11434844
> 
> 赞同：0
> 
> 时间：2012-07-11T14:26:26.577
> 
> 标签：mysql, ruby-on-rails-3

这可能有一个简单的解决方案，但我现在无法理解它。

我的桌子看起来像这样

`|id|company_id|shift_type_id|user_id|date|create_at|updated_at|`

我正在尝试列出属于特定用户的班次

`SELECT * FROM shifts WHERE user_id = 1`

然后在两个日期之间进行选择

`SELECT * FROM shifts WHERE user_id = 1 and date BETWEEN '2012-07-09' and '2012-07-15'`

排除周六和周日的所有班次

`SELECT * FROM shifts WHERE user_id = 1 and date BETWEEN '2012-07-09' and '2012-07-15' and DAYNAME(date) != "Saturday" and DAYNAME(date) != "Sunday"`

现在棘手的部分（对我来说），除此之外，我想排除周五的班次，在这种情况下为特定的 shift_type_id 6。我尝试这样做

`SELECT * FROM shifts WHERE user_id = 1 and date BETWEEN '2012-07-09' and '2012-07-15' and DAYNAME(date) != "Saturday" and DAYNAME(date) != "Sunday" and (DAYNAME(date) != "Friday" and shift_type_id != 6)`

这不起作用，我不太明白为什么，也不知道如何解决这个问题。我见过一些使用子查询并从主要结果中排除结果的解决方案，但我希望保持这个易于构建，以便我可以根据一组规则创建查询。

我在 rails3 项目中这样做，这就是它的样子

`@user.work_hours.where('shifts.date between ? and ?', params[:start_date], params[:end_date]).where('DAYNAME(shifts.date) != "Sunday" and DAYNAME(shifts.date) != "Saturday" AND (DAYNAME(shifts.date) != "Friday" and shifts.shift_type_id != 6)')`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:31:16.567

从你所说的你需要

```
SELECT * FROM shifts WHERE user_id = 1 and date BETWEEN '2012-07-09' and '2012-07-15' and DAYNAME(date) != "Saturday" and DAYNAME(date) != "Sunday" and (DAYNAME(date) != "Friday" and shift_type_id = 6) 
```

排除班次 id 为 6 的星期五，您的排除 id 不为 6 的星期五。

# android - 使用 Phonegap 暂停 Android 应用

> ID：11434845
> 
> 赞同：11
> 
> 时间：2012-07-11T14:26:27.003
> 
> 标签：android, cordova, sleep

有什么方法可以在 Phonegap 中以编程方式暂停 Android 应用程序？我想模仿点击 HOME 按钮时发生的行为。我已经不得不使用[this](http://docs.phonegap.com/en/1.8.1/cordova_events_events.md.html#backbutton)覆盖后退按钮处理程序，虽然在大多数情况下我希望它执行我的操作，但在特定状态下，用户希望应用程序最小化，并且我想复制此行为。

请记住，在 Android 上，这与关闭应用程序不同。这很容易做到，`device.exitApp();`但我希望它记住它的状态并继续在后台运行。尤其是在后台仍在执行异步作业的情况下。

Phonegap 中是否有实现此目的的功能？

*[Manually pause an application in Android Phonegap 的](https://stackoverflow.com/questions/10549472/manually-pause-an-application-in-android-phonegap)可能副本，但我找不到 OP 提到的一些工具，例如`navigator`，所以我很紧张要完全编辑和重写他们的帖子*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-12T19:35:48.910

简单的答案似乎是：不。

然而，对于走这条路的其他人来说，这并非不可能。只是Phonegap没有一个功能可以为你做这件事。

Android 相当于“让应用程序休眠”实际上只是打开了另一个意图。具体来说，打开“主页”意图将使正在运行的应用程序休眠并带您回到主屏幕。但据我从四处询问和确定文档范围来看，Phonegap 没有直接打开意图的方式。

您（据说）可以做的是以下两件事之一：

*   [这个插件](http://smus.com/android-phonegap-plugins)应该很有前途

*   [使用此处描述的方法](https://stackoverflow.com/questions/2727763/communication-between-android-java-and-phonegap-javascript)调用自己执行的 Java 代码

请注意，到目前为止，我已决定不再继续使用此方法，因此我对这两种方法中的任何一种都没有做出任何承诺，我自己也没有尝试过。

我邀请其他决定进一步追求这一点的人在这里更新他们的经验。

# objective-c - iOS Mail Composer 不会关闭

> ID：11434849
> 
> 赞同：6
> 
> 时间：2012-07-11T14:26:46.187
> 
> 标签：objective-c, ios, xcode, email

我正在尝试截取屏幕截图并使用邮件编辑器通过电子邮件发送。一切都很好，除了邮件作曲家不会解雇。这篇文章似乎有同样的问题，但提供的解决方案对我不起作用。[无法关闭 iPhone 中的电子邮件编辑器视图？](https://stackoverflow.com/questions/2530283/cannot-dismiss-the-email-composer-view-in-iphone)

```
- (IBAction)Email:(id)sender {
UIGraphicsBeginImageContext(self.view.frame.size);
[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage * image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

NSData * imageData = UIImageJPEGRepresentation(image, 1.0);

if ( [MFMailComposeViewController canSendMail] ) {
    MFMailComposeViewController * mailComposer = [[[MFMailComposeViewController alloc] init] autorelease];
    mailComposer.delegate = self;
    [mailComposer setSubject:@"Risk Assessment"];
    [mailComposer addAttachmentData:imageData mimeType:@"image/jpeg" fileName:@"attachment.jpg"];     
    [self presentModalViewController:mailComposer animated:YES];        
}
} 
```

上面的代码效果很好。我如何称呼这个底部。似乎编译器只是跳过它。

```
-(void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error{
if (error){
    NSString *errorTitle = @"Mail Error";
    NSString *errorDescription = [error localizedDescription];
    UIAlertView *errorView = [[UIAlertView alloc]initWithTitle:errorTitle message:errorDescription delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
    [errorView show];                
    [errorView release];
}
[controller dismissModalViewControllerAnimated:YES];

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-11T14:30:37.407

尝试

```
mailComposer.mailComposeDelegate = self; 
```

代替

```
mailComposer.delegate = self; 
```

从[MFMailComposeViewController 文档](http://developer.apple.com/library/ios/#DOCUMENTATION/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html)：

```
@property(nonatomic,assign) id<MFMailComposeViewControllerDelegate> mailComposeDelegate; 
```

> 委托对象负责在适当的时候关闭此视图控制器呈现的视图。因此，您应该始终提供一个委托，并且该对象应该实现 MFMailComposeViewControllerDelegate 协议的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:31:46.627

我很确定最后一行应该是

```
[self dismissModalViewControllerAnimated:YES]; 
```

以模态方式呈现视图的 ViewController 也会将其关闭。

# python - 如何在 MRjob 中获取输入文件的名称

> ID：11434850
> 
> 赞同：7
> 
> 时间：2012-07-11T14:26:48.540
> 
> 标签：python, hadoop, hadoop-streaming, mrjob

我正在使用 mrjob 编写地图功能。我的输入将来自 HDFS 目录中的文件。文件的名称包含文件中不存在的小而重要的信息。有没有办法（在 map 函数中）学习给定键值对的输入文件的名称？

我正在寻找与此 Java 代码等效的代码：

```
FileSplit fileSplit = (FileSplit)reporter.getInputSplit();
String fileName = fileSplit.getPath().getName(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T17:06:13.863

`map.input.file`属性将给出输入文件名。

根据[Hadoop - 权威指南](http://shop.oreilly.com/product/0636920021773.do)

> 可以从作业的配置中访问属性，通过为 Mapper 或 Reducer 提供 configure() 方法的实现，在旧 MapReduce API 中获得，其中配置作为参数传入。在新的 API 中，可以从传递给 Mapper 或 Reducer 的所有方法的上下文对象中访问这些属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-26T14:52:11.197

如果您在Python中使用**HADOOP 2.x ：**

```
file_name = os.environ['mapreduce_map_input_file'] 
```

# ruby - 在 Sinatra 视图中执行路线的正确方法

> ID：11434852
> 
> 赞同：0
> 
> 时间：2012-07-11T14:26:54.150
> 
> 标签：ruby, sinatra

在 Sinatra 视图中进行路由的正确方法是什么。在 Rails 中，我们命名了可在控制器和视图中访问的路由。

在视图中硬编码路线感觉很糟糕。只是编写自定义路由助手的问题，还是有更标准的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T15:41:29.817

最好的方法是设置一个视图辅助函数。由于 Sinatra 默认不提供视图助手，并且 sinatra contrib 中没有可用的助手，因此没有标准库，而且搜索 url 助手也没有太大帮助。

Sinatra 提供的所有东西都是[URL Helper](http://www.sinatrarb.com/2011/03/03/sinatra-1.2.0.html#url_helper)，但这也不是构建 url。

然而，我确实发现了一个[过时的宝石](https://github.com/niko/sinatra-named-routes)，它正在做你想做的事。只是做命名路由的[一种方法，也许这给你一些实现动态路由调用的灵感。](https://github.com/niko/sinatra-named-routes/blob/master/lib/sinatra_named_routes.rb)

# javascript - 在运行其余功能之前等待 window.open 弹出加载

> ID：11434857
> 
> 赞同：0
> 
> 时间：2012-07-11T14:27:04.050
> 
> 标签：javascript, jquery, flot

我已经为此工作了很长时间，尝试使用 win.load()、win.ready() 等，但没有成功，我正在尝试将 flot 函数用于弹出子窗口，但是我还没有找到一种方法来让函数等待dom完全加载。因此，每次我让它自然运行时，它都会抱怨它找不到要写入的 div。使用调试器时，如果我在窗口打开后使用 firebug 暂停并让它再次运行，它工作正常。

```
 if (newwindow) {
        var win = window.open("pop_up.htm", 'window', "height=400,width=900");

        $.plot($("#pie_chart", win.document), data,
        {
            series: {
                pie: {
                    show: true
                },
                legend: {
                    show: false
                }
            }
        });
    }
    else {
        $.plot($(graph_id), data,
        {
            series: {
                pie: {
                    show: true
                },
                legend: {
                    show: false
                }
            }
        });
    } 
```

好吧，我已经走到这一步了，它在 FF 中有效，但在 IE6 中无效....有什么想法吗？

```
function generatePieChart(graph_id, objData, hyperlinks, newwindow) {

    var data = objData;
    for (var i = 0; i < data.length; i++) {
        var num = parseInt(objData[i][1]);
        if (hyperlinks == true) {
            data[i] = { label: "<a class='user_pie_link super_light_box' id='" + objData[i][0] + "'>" + objData[i][0] + " <span style='float: right;'>" + objData[i][1] + "</span></a>", data: num }
        }
        else {
            data[i] = { label: "<p id='" + objData[i][0] + "'>" + objData[i][0] + " <span style='float: right;'>" + objData[i][1] + "</span></p>", data: num }
        }
    }

    if (newwindow) {

        var win = window.open("pop_up.htm", "window", "height=400, width=900");
        win.moveTo(50, 50);

        $(win.document).load(function () {
            generatePopOutPieChart(win, data);
        });

    }
    else {
        $.plot($(graph_id), data,
        {
            series: {
                pie: {
                    show: true
                },
                legend: {
                    show: false
                }
            }
        });
    }

}

function generatePopOutPieChart(win, data) {

    $.plot($("#pie_chart", win.document), data,
        {
            series: {
                pie: {
                    show: true
                },
                legend: {
                    show: false
                }
            }
        });
} 
```

# cookies - 多个域上的自动 cookie 单点登录 - 例如 google

> ID：11434866
> 
> 赞同：33
> 
> 时间：2012-07-11T14:27:25.640
> 
> 标签：cookies, dns, single-sign-on

我不明白google如何实现以下单点登录机制：

1.  例如，我登录 gmail（我想这会在我的授权下创建一个 cookie）
2.  我打开一个新标签并直接输入“youtube”的网址
3.  然后我进入youtube登录。

第二个站点如何检测到我已经登录。它们是不同的域。Youtube 无法读取 Gmail 的 cookie。

我读过的所有关于单点登录的解决方案都不允许这样做。客户端总是请求中央登录应用程序的权限。在我的示例中，YouTube 不知道我是登录 Gmail 的同一用户（实际上它确实知道，但我不明白如何）

请注意，我手动输入了“youtube”的网址。我没有点击 gmail 上方工具栏中的 youtube 图标（例如，在这种情况下，gmail 可能会通过 url 传递一些身份验证参数）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-11-12T12:33:38.127

cookie 设置在特定域上。前任：

```
setcookie(name,value,expire,path,domain) 
```

当您登录 gmail 时，在“mail.google.com”之前，您已被重定向到“accounts.google.com”，然后是“mail.google.com”，因此 cookie 也在“accounts.google.com”上.

在这种情况下，域是“accounts.google.com”，路径是“/”（主路径）。

当您请求“www.youtube.com”然后单击“连接”时，它会快速请求“accounts.google.com”，因此您看不到此重定向并检查您是否在“accounts.google.com”上有 cookie。如果是这样，它会检查 cookie 是否有效且未过期，或者用户是否未被禁止...然后将您重定向到“www.youtube.com/signin?loginthisSession=Sessionid”。此请求包含从“accounts.google.com”的 cookie 中捕获的 sessionid cookie 的值。

在最后一步，“www.youtube.com”会记录您并在“www.youtube.com”域上设置自己的 cookie 并保存它们。

所以诀窍在于 302 HTTP 重定向。

**更新**

我不知道为什么人们一直提到`iframe`看看这个问题在`2016`谷歌上发布的日期没有使用，`iframe`因为我提到了网络流量的捕获，你可以看到`SetSID`这意味着设置 SESSION_ID 的 cookie，`accounts.google.dz(com)`然后重定向到`youtube.com`它可以不使用 trought`iframe` `differant domains` `security measure`您不能从域重定向到域 trought iframe`neither`请在发布前阅读[此内容](https://stackoverflow.com/questions/2117248/setting-cookie-in-iframe-different-domain)

[![在此处输入图像描述](../Images/cd10c3932166c4f60820068814fc8da4.png)](https://i.stack.imgur.com/rZUJe.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-05-24T05:53:33.050

Cookie 和 localStorage 可以使用中间域在域之间共享。在主页上嵌入了一个“iframe”，它访问 cookie 并向主页面发送消息。

`mail.google.com`并且`youtube.com`可以使用 共享 cookie `accounts.google.es`。打开`Chrome->Inspect->Resources->Local storag`e，你会看到`accounts.google.com`JWT格式的认证token。

我在这个答案中详细介绍了技术步骤：[https](https://stackoverflow.com/a/37565692/6371459) ://stackoverflow.com/a/37565692/6371459 。另请查看[https://github.com/Aralink/ssojwt](https://github.com/Aralink/ssojwt)以查看在中央域中使用 JWT 的单点登录实现

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-17T02:51:45.220

看看这个.. [http://www.codeproject.com/Articles/106439/Single-Sign-On-SSO-for-cross-domain-ASP-NET-applic](http://www.codeproject.com/Articles/106439/Single-Sign-On-SSO-for-cross-domain-ASP-NET-applic)。文章由SSO跨域的解释和示例组成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-09T13:44:48.990

据我记得，如果我没记错的话，cookies 包含一个指定的字段，该字段包含可以读取和获取此类 cookie 的域。这样做是为了防止某些网站读取您的所有 cookie 列表并自行开展业务。您应该能够看到哪些网站可以“看到”您的 gmail cookie。

如果我错了，请纠正我，这应该编译有关 SID 和 gmail-YouTube 示例的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-04T08:09:40.607

在评估这个跨域 SSO 主题时，我想出了一个可能的新 SSO 同步流程，它使用**带有时间戳的 cookie**。虽然它不是谷歌使用的流程，但我认为这个流程可以用于域数量有限的系统。

此流程不使用`3rd party cookie`

这将是一个很长的帖子:)

## 域

举个例子，假设我们的示例*宠物论坛*有这些域：

*   [https://account.domain1.com](https://account.domain1.com)（用于 SSO 登录）
*   .domain1.com（例如[https://cat.domain1.com](https://cat.domain1.com)）
*   .domain2.com（例如[https://dog.domain2.com](https://dog.domain2.com)）
*   .domain3.com（例如[https://rabbit.domain3.com](https://rabbit.domain3.com)）

## 更改为[https://account.domain1.com](https://account.domain1.com)：

*   添加[https://account.domain2.com](https://account.domain2.com)和[https://account.domain3.com](https://account.domain3.com)，将主机名流量路由到托管[https://account.domain1.com的服务器](https://account.domain1.com)

## 登录步骤：

1.  用户去`dog.domain2.com`，用户还没有登录。
2.  用户点击登录按钮`dog.domain2.com`
3.  用户被重定向到`account.domain1.com`登录
    *   这一步可以是任何登录协议、OAuth、OIDC、SAML、CAS等
    *   因此，登录后将用户重定向回原始页面很重要
    *   假设这个[https://account.domain1.com?redirect_uri=https://dog.domain2.com](https://account.domain1.com?redirect_uri=https://dog.domain2.com)
    *   `redirect_uri`如登录成功后返回的URL
4.  用户输入用户名和密码，登录成功
5.  **新步骤**，在重定向回 [https://dog.domain2.com](https://dog.domain2.com)之前，在所有域上设置 cookie
    1.  将浏览器重定向到[https://accounts.domain2.com?](https://accounts.domain2.com?..) ...
    2.  在`.domains2.com`域上设置 cookie（稍后将详细介绍 cookie 值）
    3.  将浏览器重定向到[https://accounts.domain2.com?](https://accounts.domain2.com?..) ...
    4.  `.domains3.com`在域上设置 cookie
    5.  将浏览器重定向到[https://accounts.domain1.com?](https://accounts.domain1.com?..) ...
    6.  `.domains1.com`在域上设置 cookie
    7.  重定向回原始流程
6.  将用户重定向回原来的服务，即[https://dog.domain2.com](https://dog.domain2.com)

现在，在登录流程之后，**我们在所有 3 个域上都有 cookie**。我们的任何服务（例如[https://cat.domain1.com](https://cat.domain1.com) / [https://dog.domain2.com](https://dog.domain2.com) / [https://rabbit.domain2.com](https://rabbit.domain2.com)）都可以在自己的域下访问此 cookie。

## 饼干内容

*   cookie 的内容，应该允许任何网页查看它，并确定是否需要 SSO 同步
*   可以存储不同类型的 cookie 内容，包括
    *   布尔值表示用户是否登录
    *   用户身份
    *   过期时间

### 布尔值表示用户是否登录

*   存储`have_user_login`= true / false 有同步问题
*   假设`User A`登录，访问 [https://cat.domain1.com](https://cat.domain1.com)，`User A`注销，`User B`登录
*   现在，从[https://cat.domain1.com](https://cat.domain1.com)的角度来看，不需要同步
*   但是，[https://cat.domain1.com](https://cat.domain1.com)正在存储`User A`而不是`User B`，因此存在同步问题。

### 用户身份

*   虽然很容易将 cookie 存储`user_id`在这些 cookie 上，并让所有域都看到它们并相应地设置用户。
    *   这太危险了，因为 cookie 是在父域中设置的，
    *   如果您域下的任何网站被黑客入侵，则可能会发生**假冒**（复制任何网站`user_id`，将其粘贴到他们自己的浏览器 cookie 中）。

### 时间戳过期

*   我的建议是将 cookie 值设置为**SSO expired time**，并将类型设置为**session** cookie，这有以下好处：
    *   如果泄漏/更改，过期时间对安全影响最小
    *   我们的网站可以查看过期时间以了解用户是否需要重新登录
    *   至于为什么会话cookie，是为了当用户关闭浏览器并尝试再次登录时，cookie将被删除，因此也会注销用户
*   任何使用 SSO 的网页，也应该自己存储一个具有相同过期时间的 cookie
    *   会有这样的情况，`User A`登录，访问[https://cat.domains1.com](https://cat.domains1.com)然后`User B`登录
    *   由于`User A`并且`User B`会有不同的登录过期时间，存储和比较该时间戳将告诉用户再次与 SSO 同步

## 您的服务的示例检查工具

例如，在[https://cat.domains1.com](https://cat.domains1.com)上，您可以将其添加到页面加载的顶部

```
<?php
$sso_expired_time = $_COOKIE["sso_expired_time "] ?? 0;
$website_expired_time = $_COOKIE["website_expired_time "] ?? 0;

if( (int) $sso_expired_time  < time() || $sso_expired_time  !== $website_expired_time ) {
    // User not sync, perform sync
    setcookie("website_expired_time", $website_expired_time,0,"/", $_SERVER['SERVER_NAME'], true, true);
    // Redirect to https://account.domain1.com for Login
    // Or, Initiate the login sequence for your selected login protocol
    header("Location: https://account.domain1.com/.....") 
    exit;
}
// User is sync

// Page load success, continue other operation 
```

## 登出

登录与登录非常相似，基本上：

*   在注销完成之前，重定向到所有 3 个域，就像登录一样
*   删除 SSO cookie
*   继续正常的注销流程

## 方法的优缺点：

*   专业版：所有域同步都是可能的
*   优点：无需依赖 3rd 方 cookie
*   缺点：第一次登录时间更长（大约长 50 毫秒）
*   缺点：需要在每个网站上进行自定义才能使同步生效

# c# - 实体框架 POCO：如何将相关属性映射到扁平表？

> ID：11434867
> 
> 赞同：3
> 
> 时间：2012-07-11T14:27:28.063
> 
> 标签：c#, .net, poco, entity-framework-4.3

我正在针对 SQL Server 2012 数据库使用实体框架（版本 4.3.1）POCO，并且我有这个数据模式......

```
Table2
======    
Table2Id : int : Identity (1,1) Primary Key not null
Name : nvarchar(10) not null

Table1
======    
Table1Id : int : Identity (1,1) Primary Key not null
Name : nvarchar(10) not null
Table2Id : int not null (foreign key to Table2)

Root
====
RootId : int : Identity (1,1) Primary Key not null
Table1Id : int not null (foreign key to Table1)
Table2Id : int not null (foreign key to Table2) 
```

**除了**现在有趣的是，我不想在我的 Root 对象上为 Table2 设置一个属性，而是希望从 Table1 的相关 Table2 中填充该 ID 。

为了解释我的意思，这里是我的对象和上下文：

```
public class Root
{
    public int RootId { get; set; }
    public Table1 Table1 { get; set; }
}

public class Table1
{
    public int Table1Id { get; set; }
    public string Name { get; set; }
    public Table2 Table2 { get; set; }
    public virtual ICollection<Root> Roots { get; set; }
}

public class Table2
{
    public int Table2Id { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Table1> Table1s { get;set; }
}

public class Context : DbContext
{
    public Context(string nameOrConnectionString) 
        : base(nameOrConnectionString)
    {
        Roots = Set<Root>();
        Table1s = Set<Table1>();
        Table2s = Set<Table2>();
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {          
        var table1 = modelBuilder.Entity<Table1>();
        table1.ToTable("Table1");
        table1.HasKey(r => r.Table1Id);
        table1.HasRequired(r => r.Table2)
            .WithMany(t => t.Table1s)
            .Map(m => m.MapKey("Table2Id"));

        var table2 = modelBuilder.Entity<Table2>();
        table2.ToTable("Table2");
        table2.HasKey(r => r.Table2Id);

        var root = modelBuilder.Entity<Root>();
        root.ToTable("Root");
        root.HasKey(r => r.RootId);
        root.HasRequired(r => r.Table1)
            .WithMany(t => t.Roots)
            .Map(m => m.MapKey("Table1Id"));

        // TODO: Some sort of mapping            

        base.OnModelCreating(modelBuilder);
    }

    public DbSet<Root> Roots { get; private set; }
    public DbSet<Table1> Table1s { get; private set; }
    public DbSet<Table2> Table2s{ get; private set; }
} 
```

最终我想运行这段代码（在一个空数据库上）......

```
using(var c = new Context(@"connection string"))
{
    c.Roots.Add(new Root
    {
        Table1 = new Table1
        {
            Name = "Test1",
            Table2 = new Table2 { Name = "Test2" }
        }
    });
    c.SaveChanges();
} 
```

然后数据看起来像这样：

```
Table2
======
Table2Id |  Name
       1 | Test2

Table1
=======
Table1Id |  Name
       1 | Test1

Root
====
RootId | Table1Id | Table2Id
1      |        1 |        1 
```

那么，**我该如何进行这样的映射呢？** 我查看了 Map 函数和 Property 函数，但我无法理解我应该把什么放在哪里，或者即使它们是合适的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:21:26.373

> 我不想在我的 Root 对象上为 Table2 设置一个属性，而是希望从 Table1 的相关 Table2 中填充该 ID。

EF 不支持这个。您不能将关系中的属性值转发到主表。`Table2`您必须在 on或 on 上公开导航属性，`Root`并以与`Table1`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T08:10:40.580

感谢@Ladislav Mrnka 指出它不受支持并且我需要一个导航属性，我决定我可以拥有一个私有导航属性，该属性遵循 Table1.Table2 属性并隐藏 ickyness。所以...

我像这样在我的 Root 类上定义了一个**私有**导航属性（注意它不存储任何东西，只是遵循 Table1.Table2 属性）：

```
public class Root
{
    public int RootId { get; set; }
    public Table1 Table1 { get; set; }
    private Table2 Table2
    {
        get { return Table1.Table2; }
        set { Table1.Table2 = value; }
    }
} 
```

来自问题：[Entity Framework 4 - Mapping non-public properties with CTP5 (code first) in an persistence unware context](https://stackoverflow.com/q/5246466/1039947)我创建了这个小助手（这只是意味着我可以获得私有属性的 lambda 表达式）：

```
public interface IObjectExpressionCreator<T>
{
    Expression<Func<T, TResult>> Property<TResult>(string name);
}

public static class PropertyExpression
{
    private class ObjectExpressionCreator<T> : IObjectExpressionCreator<T>
    {
        public Expression<Func<T, TResult>> Property<TResult>(string name)
        {
            var p = Expression.Parameter(typeof(T),
                                         "propertyOrFieldContainer");

            var body = Expression.PropertyOrField(p, name);

            var lambda = Expression.Lambda(typeof(Func<T, TResult>),
                                           body,
                                           p);

            return (Expression<Func<T, TResult>>)lambda;
        }
    }
    public static IObjectExpressionCreator<T> For<T>()
    {
        return new ObjectExpressionCreator<T>();
    }
} 
```

现在我像这样执行映射：

```
root
    .HasRequired(PropertyExpression.For<Root>().Property<Table2>("Table2"))
    .WithMany()
    .Map(m => m.MapKey("Table2Id")); 
```

当我运行问题中的代码时，我得到了我想要的。

# java - 不应该出现的死代码警告

> ID：11434868
> 
> 赞同：-3
> 
> 时间：2012-07-11T14:27:30.153
> 
> 标签：java, eclipse, dead-code

我有一个非常简单的 Java 代码，就像这样（这只是一个摘录）：

```
for(;;)
{
  AnObject object = null;
  for(AnObject elem : list) // where the list is of the type List<AnObject>
  {
    if(<some dynamic condition goes here>)
    {
      object = elem;
    }
  }

  Log.v(TAG, object.property); // was initially omitted, added for the answer

  // more code skipped for simplicity

  if(object == null)
  {                  //
    break;           //
  }                  // this all is marked as dead code
} 
```

在 Eclipse 中，带有注释的片段被标记为死代码。为什么？条件中没有`final`元素。除了循环的最开始，该`object`变量不会在任何地方分配给常量 null，在此之后它通常应该被覆盖，但它并不总是发生。`object`可以很好地为空和非空。

我错过了什么吗？

**答案**

好吧，我找到了答案，为了展示它，我必须在我的示例中添加一行代码，我在尝试简化代码摘录时无意中省略了这行代码，但这很重要。该行是：

```
Log.v(TAG, object.property); 
```

所以对象必须是非空的，否则代码无法通过异常访问。此行是出于调试目的临时添加的，这就是我不考虑它的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T16:28:38.113

我无法在 Eclipse 中重现该警告。

可能是您不小心忘记了原始问题中的某些代码，这可能会导致没有执行其后面的代码的情况。当您将完整的语句标记`if`为死代码而不仅仅是它的主体时，情况似乎就是这样。缺少的行可能是实际使用的东西`object`（可能就像您尝试访问其中一个`object`属性的日志语句一样简单）。

即使`if`状况没有被标记为死亡，它的尸体也可能仍然存在。要么`object`不是`null`（并且`if`主体不会被执行），要么 - 如果`object`为 null - a`NullPointerException`将被抛出该缺失的行，以便执行在那里停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:35:46.940

无法使用以下程序重现：

```
import java.util.Date;
import java.util.LinkedList;
import java.util.List;

public class Test {

    public static void main(String[] args) {
        for(;;)
        {
            List<Object> list = new LinkedList<Object>();
          Object object = null;
          for(Object elem : list) 
          {
            if(new Date().getSeconds() % 3 == 0)
            {
              object = elem;
            }
          }
          if(object == null) 
          {                  
            break;           
          }                  
        }

    }

} 
```

这是带有 Java SE 1.7 的 Eclipse 3.7.2

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-11T14:36:37.133

~~因为，如果 list 为 null（在您的代码中没有 init for list），您将永远不会初始化 Object。~~ 我的垃圾话，我的错。

如果内部的“如果”总是为假，则可以在其中标记死代码。如果元素为空，则最后的比较仍然适用。如果您在死代码块之前返回，则会引发无法访问的代码错误。

正如其他人所说，无法复制它。

# c - MPI_File_read_at 中的内存泄漏

> ID：11434869
> 
> 赞同：0
> 
> 时间：2012-07-11T14:27:30.110
> 
> 标签：c, memory-management, memory-leaks, io, mpi

我正在编写一个 C/MPI 程序，该程序使许多进程从数据文件中读取。当使用来自 stdio 的标准函数（fopen、fread、fseek）时，一切顺利。我不能超过 4 Go 偏移的问题。所以我使用 MPI-IO 函数来读取一个大文件，此时内存并没有很好地释放。

实际上，我读取了一个缓冲区，然后对其进行处理，然后释放分配的内存。每个进程的内存使用量是完美的，但全局内存使用量并没有停止增加。只需将 mpi_file_read 替换为 fread 就没有这个问题。

有我的代码：

```
double CPUtime(){ return ((double) clock())/CLOCKS_PER_SEC;}int main(int argc, char* argv []){

if(argc != 5) {
    printf("\t[Dictionary file] [Dictionary] [Input file] [Buffer size]\n");
    exit(0);
}

char* sInput    = malloc (sizeof(char)*maxLength);
char* sOutput   = malloc (sizeof(char)*maxLength);
char* compl     = malloc (sizeof(char)*maxLength);

char* sDictionaryFileName   =   argv[1];
char* sDictionaryName       =   argv[2];
char* filename              =   argv[3];
int Mbuffer                 =   atoi(argv[4]);

int maxBuffer = Mbuffer*1024*1024;
int over      = 10000;

int rank,numprocess;
long int offset;

char* buffer;
char* opbuffer;

double tstart=CPUtime();

MPI_Init( &argc, &argv );
MPI_Comm_rank( MPI_COMM_WORLD, &rank );

/* mpi version */
/* open the file*/
MPI_File fh;
int err;
err = MPI_File_open(MPI_COMM_WORLD, filename, MPI_MODE_RDONLY, MPI_INFO_NULL, &fh);
if (err != MPI_SUCCESS) {
    char errstr[MPI_MAX_ERROR_STRING];
    int  errlen;
    MPI_Error_string(err, errstr, &errlen);
    printf("Error at opening file %s (%s)\n",filename,errstr);
    MPI_Finalize();
    exit(1);
}

// get offsets and buffer size
MPI_Offset sfile;
MPI_File_get_size(fh,&sfile);
MPI_Status status;

/* C version */
/*FILE* fh;
long int sfile;
fh =fopen( filename,"rb");
if (fh==NULL) {
    printf("Error at opening file %s\n",filename);
    exit(1);
}
// get offsets and buffer size
fseek(fh, 0L, SEEK_END);
sfile = ftell(fh);
fseek(fh, 0L, SEEK_SET);*/

MPI_Comm_size( MPI_COMM_WORLD, &numprocess );

/* number of iterations */
long int data_size = (long int)(sfile/(numprocess));
int nbIter = data_size/maxBuffer;
if(nbIter<=1){
    nbIter = 1;
    maxBuffer = data_size;
}

/* offsets */
offset = data_size*(rank);
long int cursor = offset;
char* header;
if(rank==0){
    FILE* fh;
    fh =fopen( filename,"rb");
    if (fh==NULL) {
        printf("Error at opening file %s\n",filename);
        exit(1);
    }
    /* read the header and broadcast it */
    header = malloc(sizeof(char)*1000);
    fgets(header,1000,fh);
    fclose(fh);

    //broadcast header
    int sndHeader = strlen(header);
    //cursor+=sndHeader;
    int process_counter;
    for(process_counter=1;process_counter<numprocess;process_counter++){
        int ierr = MPI_Send(&sndHeader, 1, MPI_INT, process_counter, 42,MPI_COMM_WORLD);
        if (ierr != MPI_SUCCESS) {
            int errclass,resultlen;
            char err_buffer[MPI_MAX_ERROR_STRING];
            MPI_Error_class(ierr,&errclass);
            if (errclass== MPI_ERR_RANK) {
                fprintf(stderr,"Invalid rank used in MPI send call\n");
                MPI_Error_string(ierr,err_buffer,&resultlen);
                fprintf(stderr,err_buffer);
                MPI_Finalize();
            }
        }
        MPI_Send(header, sndHeader, MPI_CHAR, process_counter, 43, MPI_COMM_WORLD);
    }
}
else{
    /* receive the header */
    int sizeofHeader;
    MPI_Status s ;
    MPI_Recv(&sizeofHeader,1,MPI_INT,0,42,MPI_COMM_WORLD,&s);
    header = malloc (sizeof(char)*sizeofHeader+1);
    MPI_Recv(header,sizeofHeader,MPI_CHAR,0,43,MPI_COMM_WORLD,&s);
}

/* Synchronization barrier */
MPI_Barrier(MPI_COMM_WORLD);

int count;

opbuffer = malloc(sizeof(char)*maxBuffer);

/* C version */
//fseek(fh,cursor,SEEK_SET);

for(count=0;count<nbIter;count++){

    if(count==0 && rank==numprocess-1){ //init ring
        //send the token to p0
        int token=1;
        MPI_Send(&token,sizeof(int),MPI_INT,0,55,MPI_COMM_WORLD);
    }

    //recv
    int token;
    int sender;
    if(rank==0)
        sender = numprocess-1;
    else
        sender=rank-1;

    MPI_Status s;
    MPI_Recv(&token,sizeof(int),MPI_INT,sender,55,MPI_COMM_WORLD,&s);
    fflush(stdout);printf("P%d got the token at %G\n",rank,CPUtime());
    //read
    double start=CPUtime();
    /*double readtime;
    double sread=CPUtime();//read time*/

    //read
    if(token==1){
        /* MPI version */
        int err=MPI_File_read_at(fh, cursor,opbuffer,  sizeof(char)*maxBuffer, MPI_CHAR, &status);
        if(err!=MPI_SUCCESS){
            /*char errstr[MPI_MAX_ERROR_STRING];
            int  errlen;
            MPI_Error_string(err, errstr, &errlen);
            printf("Error reading file %s (%s)\n",filename,errstr);*/
            MPI_Finalize();
            exit(0);
        }

        /* C version of read */
        /*int k=fread(opbuffer,sizeof(char),maxBuffer,fh);
        if(k==0)
            perror("fread");*/

        cursor+=maxBuffer;
        buffer=opbuffer;

    }
    else{
        printf("Error token!\n");
        token=1;
    }
    //printf("P%d readtime=%G\n",rank,CPUtime()-sread);
    //Isend
    int next = (rank+1)%numprocess;
    MPI_Send(&token,sizeof(int),MPI_INT,next,55,MPI_COMM_WORLD);

    /* start processing*/ 
    /* end processing */

}
free(opbuffer);
int er=MPI_File_close(&fh);
if(er!=MPI_SUCCESS){
    printf("Error closing file\n");
    MPI_Finalize();
    exit(1);
}
MPI_Finalize();

printf("Global time : %G\n",CPUtime()-tstart);
return 0;
} 
```

如果有人知道它是什么，我会很高兴。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T16:52:05.030

这可能是你从来没有打电话`MPI_File_close`。这将导致对文件的中间操作泄漏。请注意，`if(err!=MPI_SUCCESS)`如果您真的想编写干净的代码，也应该在错误情况下关闭它。

# javascript - 在 IE 中隐藏所有系列，除了一个非常慢的系列

> ID：11434871
> 
> 赞同：0
> 
> 时间：2012-07-11T14:27:33.710
> 
> 标签：javascript, internet-explorer, highcharts

我有一个包含 8 个系列的高图，每个系列有 60 个数据点。当用户单击图例中的系列时，我已经捕获了该事件，因此当用户单击系列时，所有其他系列都隐藏在图表中。

这是我的代码：

```
for (i = 0; i < chart.series.length; i ++) {
    if (chart.series[i] == selectedSerie) {
        chart.series[i].show ();
    } else {
        chart.series[i].hide ();
    }
} 
```

这工作得很好，除了在 Internet Explorer 中隐藏所有内容并只显示一个系列需要很长时间。我猜这是由于在显示或隐藏系列时重绘了图表。有谁知道更好的方法来做到这一点？

# java - Smack 3.2.2 SASL 身份验证 DIGEST-MD5 失败：invalid-authzid

> ID：11434877
> 
> 赞同：0
> 
> 时间：2012-07-11T14:27:46.733
> 
> 标签：java, smack, sasl

我有大问题。每次当我尝试连接到任何 jabber 服务器时，我都会收到“SASL 身份验证 DIGEST-MD5 失败”通知。我不使用 JPasswordField 时没有这个错误，但是在 IM 中使用 JTextField 是没有意义的。我已经尝试了我找到的所有方法，但都是一样的。

编码：

```
private void bLoginAction(JTextField login, JPasswordField pass) {
loginText = login.getText();
passText = pass.getPassword().toString();
String[] data = loginText.split("@");
Connection.DEBUG_ENABLED = true;
ConnectionConfiguration config = new ConnectionConfiguration(data[1], 5222);
Connection con = new XMPPConnection(config);
 try {
 con.connect();
 } catch (XMPPException e) {
 e.printStackTrace();
 }
try {
 con.login(loginText, passText);
 } catch (XMPPException e) {
 e.printStackTrace();
 }  
} 
```

从 printStackTrace() 打印：

> SASL 身份验证 DIGEST-MD5 失败：invalid-authzid: at org.jivesoftware.smack.SASLAuthentication.authenticate(SASLAuthentication.java: 337) at org.jivesoftware.smack.XMPPConnection.login(XMPPConnection.java:203) at org.jivesoftware。 smack.Connection.login(Connection.java:348)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:36:38.440

不要使用*toString()*。尝试使用*getPassword()代替，如此*[处](http://docs.oracle.com/javase/tutorial/uiswing/components/passwordfield.html)所示。即使使用 JTextField，您也应该使用*getText()*而不是*toString()*。

这不是一个小问题，而是一个直接的 Java 问题。

# android - 将android R传递给另一个类有意义吗？

> ID：11434885
> 
> 赞同：0
> 
> 时间：2012-07-11T14:28:22.093
> 
> 标签：android, android-layout, android-widget

我正在做这个活动，它接受来自 xml 的表单数据并在屏幕上呈现表单。现在进行实际渲染的代码在一个单独的java文件中（基本上有3种问题，每种都有自己的方法来渲染从xml中提取的数据）它基本上是这样的。

```
public void newQuestion(String question, LinearLayout l, Context c){
        TextView tv = new TextView(c);
        tv.setText(question);
        EditText et = new EditText(c);
        l.addView(tv);
        l.addView(et);

    } 
```

所以这是我的问题 - 要让这个 Java 文件向表单添加小部件，我需要传递活动的上下文。此外，我需要能够访问要添加的布局（简单线性布局）。你可以只传递 R 或将它 (android.R) 导入另一个 java 文件吗？因为然后我可以从 R 中获取上下文和布局以及所有必需的 id。

* * *

我确实尝试过导入它。我的 java 类在项目 A 中，而我的 android 活动是一个单独的项目 B。所以我写了

```
import B.src.com.android.*; 
```

它说“导入 B 无法解决” [我也试过 B.com.android 。同样的错误]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:32:52.593

```
In sense of pass R file ,You don't need to pass  it. 
```

您可以从任何类别的项目访问 R 文件。**你必须导入它。**

```
import com.company.product.R; 
```

# graph - ADF - 数据控制值不存在

> ID：11434891
> 
> 赞同：0
> 
> 时间：2012-07-11T14:28:39.253
> 
> 标签：graph, oracle-adf, jspx

我正在尝试从我创建的数据控件中创建一个图表。当我运行我的网站时，名为 myNewGraph 的图表没有显示，但是当我预览图表本身时，它是完美的。

JDeveloper 会自动生成图表，它会生成此代码，请注意`value`：

```
 <dvt:comboGraph id="comboGraph2" shortDesc="PriceMetrics"
                    value="#{bindings.myNewGraph.graphModel}"
                    subType="COMBINATION_VERT_ABS_2Y" customLayout="CL_NONE> 
```

我创建了另一个具有类似代码构成的图表。这个完美无缺。

```
 <dvt:comboGraph id="comboGraph1" shortDesc="PriceMetrics"
                    value="#{bindings.existingGraph.graphModel}"
                    subType="COMBINATION_VERT_ABS" customLayout="CL_NONE" 
```

我相信这与价值有关，这导致我`myNewGraph`无法工作。因为当我用 的值替换它时`existingGraph`，图表会显示，但它没有显示正确的数据，因为它具有相同的值。

我如何产生价值，`bindings.myNewGraph.graphModel`因为我相信它在技术上不存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T06:55:01.563

您确定编辑器中的预览显示了真实的图形数据吗？从您给出的描述中听起来好像您的数据没有被查询。建议你调试一下你在数据控件中暴露的业务服务，看看有没有执行查询。从您的描述来看，绑定 EL 或图形似乎没有问题

坦率

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:12:31.060

您必须将图形绑定导入到webpagePageDef.xml。

# c# - 从线程更新数据绑定 DataTable 是否安全？

> ID：11434894
> 
> 赞同：2
> 
> 时间：2012-07-11T14:28:45.057
> 
> 标签：c#, multithreading, datatable, backgroundworker, databound

对于我正在处理的项目，我有一个带有一堆 DataGridView 组件的表单，这些组件用于显示一些数据。每个 DataGridView 都有它自己的与之关联的 DataTable。要显示的数据会定期发送。我的应用程序必须读取这些数据，对其进行解析并相应地填充数据网格。因为我想保持表单的响应能力，所以我在无休止的后台工作人员中实现了数据的接收（阻塞）。

在后台工作人员中，我获取数据并将其解析/转换为适合 DataTables 的值。现在这是我的问题：目前我将这些值直接分配给 DataTable 对象。（所以我在后台工作人员的 DoWork 事件中执行此操作）

我想知道这是否有效。我确实有一次索引越界异常，我想知道这是否与此有关。这是一种安全且推荐的方法吗，还是应该在后台工作人员的 DoWork 事件中使用调用来更新 DataTables？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:35:25.060

不，.NET WinForm 控件（这是假设）上影响控件呈现的所有属性（包括绑定到会影响呈现的控件的值）必须在创建控件的线程上进行。

也就是说，有很多时候您可以进行更改而侥幸逃脱，但这种行为是不可预测的，不推荐使用。

在您的特定情况下，我建议拥有[`DataTable`](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)处理线程使用的副本，然后将该副本编组到 UI 线程（通过调用[类实现的](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.aspx)[`ISynchronizeInvoke`接口](http://msdn.microsoft.com/en-us/library/system.componentmodel.isynchronizeinvoke.aspx)实现之一）并更新网格在 UI 线程中。[`Control`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.aspx)

基本上，您将`DataTable`使用从后台线程封送的副本来执行网格绑定的更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:31:19.570

嗯，不。虽然在后台线程中进行计算是一个非常好的主意，但 UI 更新应该始终在 UI 线程中完成。

将 Datatable 绑定到 UI 元素时，您将这些对象的所有权“授予”给 UI 线程，并且不应再在后台线程中更新它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:35:12.273

公平地说，您永远不应该从非 UI 线程更新任何 UI 绑定元素。尽管这样做通常可能看不到任何异常，但这绝不是一种好的做法，并且经常导致异常或更糟糕的是，看不见的错误

# php - 在 php mysql 网站中使用 google map api 标记

> ID：11434895
> 
> 赞同：0
> 
> 时间：2012-07-11T14:28:46.867
> 
> 标签：php, mysql, api, google-maps

我目前正在建立一个网站，其中有一个功能允许用户在谷歌地图中标记他们的家庭地址，并使用 php+mysql 将坐标存储在数据库中，然后在另一个页面上从 db 中获取坐标并用于显示. 我怎么做 ？

我对google map api不是很熟悉，所以如果你们中的任何人都可以提供类似的示例代码，那将是很大的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-21T20:32:35.037

据我了解，您陷入了要从数据库中获取数据并根据纬度和经度显示带有位置的地图的部分。如果这是正确的，您可以试试这个..

基于此链接[https://developers.google.com/maps/articles/phpsqlsearch_v3?hl=es#createtable上的示例](https://developers.google.com/maps/articles/phpsqlsearch_v3?hl=es#createtable)

这是对我有用的代码（我不知道是否有多余的东西）。

```
<?php
    //select statement that grabs latitude and longitude for the current user and stores them to   variables eg $lat and $lng. Then you just echo them below into the javascript.
?>
<html>
<head>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script language="javascript" type="text/javascript">

    var map;
    var geocoder;
    function InitializeMap() {

    var latlng = new google.maps.LatLng(<?php echo $lat; ?>, <?php $lng; ?>);
    var myOptions =
    {
        zoom: 8,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        disableDefaultUI: true
    };
    map = new google.maps.Map(document.getElementById("map"), myOptions);
}

window.onload = InitializeMap;

</script>
</head>
<body>

<table>

<tr>
<td colspan ="2">
<div id ="map" style="height: 253px;width: 447px;" >
</div>
</td>
</tr>
</table>
</body>

</html> 
```

# java - 使用 Liferay Portal 和 Selenium 自动提交多个表单

> ID：11434902
> 
> 赞同：0
> 
> 时间：2012-07-11T14:29:10.883
> 
> 标签：java, selenium, junit, liferay

考虑到我可以在 API 本身之外找到的有限文档，我花了很长时间试图弄清楚这一点。

我有一个liferay portlet，它只需单击一个按钮，弹出一个带有一堆字段的表单，然后提交该表单。

我想使用 Selenium（或者任何可以使用 Liferay 执行此操作的自动化工具）来模拟 100-500 个并发提交。

有没有人以类似的方式将 Selenium 与 LifeRay 一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:37:54.173

Selenium 是一个很好的工具来测试你的网络系统的正确性，而不是测试这个系统的性能。对于压力测试，您应该使用另一个工具，例如 JMeter [http://jmeter.apache.org/](http://jmeter.apache.org/)。[或者您可以使用 HtmlUnit http://htmlunit.sourceforge.net/](http://htmlunit.sourceforge.net/)编写测试脚本

# shell - Bourne shell 脚本检查时间是否从服务器更新

> ID：11434904
> 
> 赞同：0
> 
> 时间：2012-07-11T14:29:27.393
> 
> 标签：shell, time, sh, openwrt

我在运行 OpenWRT 的 TPLink 路由器上。当设备启动时，我希望一个 LED 亮起，直到从 ntp 服务器更新系统时间。

这是我的方法：

```
#!/bin/sh

echo 0 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio0/direction
echo 1 > /sys/class/gpio/gpio0/value

currentDate=$(date +%s)

 while [ $currentDate < 1342016035 ]; do
                echo Time not updated yet
                currentDate=$(date +%s)
done

echo Time updated!

echo 0 > /sys/class/gpio/gpio0/value
echo 0 > /sys/class/gpio/unexport 
```

当我运行它时，我得到“./timescript.sh: line 11: can't open 1342016035: no such file”。你知道为什么会这样吗？另一个问题是，这是否有意义，或者处理器在循环中被占用并且无法更新时间？

提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T14:39:27.803

[测试](http://www.ibm.com/developerworks/library/l-bash-test/index.html)需要 -lt 和 -gt 用于算术

```
#!/bin/sh

echo 0 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio0/direction
echo 1 > /sys/class/gpio/gpio0/value

currentDate=$(date +%s)

while [ $currentDate -lt 1342016035 ]; do
            echo "Time not updated yet"
            currentDate=$(date +%s)
done

echo "Time updated!"

echo 0 > /sys/class/gpio/gpio0/value
echo 0 > /sys/class/gpio/unexport 
```

# mysql - mysql db表中超过200,000条记录的替换插入查询

> ID：11434906
> 
> 赞同：0
> 
> 时间：2012-07-11T14:29:29.640
> 
> 标签：mysql, insert-query

我必须一次将超过 200000 条记录插入到 mysql db 表中，插入查询导致性能问题，有什么可以替代它。

下面是我正在使用的代码

```
$xml = simplexml_load_file("247electrical.xml");

foreach($xml->merchant as $merchant){

define('API', 'PS');
require_once('constants.inc.php');
require_once('classes/class.ClientFactory.php');
$oClient = ClientFactory::getClient(API_USERNAME, API_PASSWORD, API_USER_TYPE); $merchattrs=$merchant->attributes();
$aParams100 = array('iMerchantId' => array($merchattrs->id)); $merchantinfo= $oClient->call('getMerchant', $aParams100);

//Get Products

foreach($xml->merchant->prod as $product){

$attrs=$product->attributes();

//Insert Products into DB
mysql_query('INSERT INTO productstemp (merchant_id, merchant_name, aw_product_id, merchant_product_id, product_name, description, category_id, merchant_category, aw_deep_link, aw_image_url, search_price, delivery_cost, merchant_image_url, aw_thumb_url, brand_name, delivery_time, display_price, in_stock, merchant_thumb_url, model_number, pre_order, stock_quantity, store_price, valid_from, valid_to, web_offer, merchantimage, cleancompany) VALUES("'.$merchattrs->id.'","'.$merchattrs->name.'","'.$attrs->id.'"," ","'.$product->text->name.'","'.$product->text->desc.'","'.$product->cat->awCatId.'","'.$product->cat->mCat.'","'.$product->uri->awTrack.'","'.$product->uri->awImage.'","'.$product->price->buynow.'","'.$product->price->delivery.'","'.$product->uri->mImage.'","'.$product->uri->awThumb.'","'.$product->brand->brandName.'","'.$product->delTime.'","'.$product->price->buynow.'","'.$attrs->in_stock.'","'.$product->uri->mThumb.'","'.$product->modelNumber.'","'.$attrs->pre_order.'","'.$attrs->stock_quantity.'","'.$product->price->store.'","'.$product->valFrom.'","'.$product->valTo.'","'.$attrs->web_offer.'","'.$merchantinfo->oMerchant->sLogoUrl.'","247electrical" ) ')
or die(mysql_error());     

}
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:49:32.907

我认为 INSERT 查询本身不是问题。毕竟 200.000 次插入对于 mysql 来说并不算多。

首先我猜读文件很慢。SimpleXML 很方便，但对于大文件，它会导致巨大的内存开销。想想像 PHP 的[XMLReader](http://www.php.net/manual/en/book.xmlreader.php)这样的流式 XML 阅读器。

您正在向 mysql 服务器发送单个语句，这比发送一个巨大的语句要慢得多。此外，您的单个插入语句应包含在事务中。如果您处理了 10.000 条记录并插入它们，然后您的脚本死机/mysql 服务器死机等会发生什么？如何在没有手动工作的情况下安全地再次启动脚本（清除表格、查找已处理的内容等）。

除此之外，一个包含多个 VALUES 的单个 INSERT 语句应该更快。我会让你的 PHP 脚本输出查询，所以它最终看起来像这样：

```
INSERT INTO table(field_1, field_2, field 3)
VALUES('foo 1', 'bar 1', 'baz 1'),
VALUES('foo 2', 'bar 2', 'baz 2'),
... 
```

然后通过以下方式导入该文件：

```
$ mysql ... credentials options etc ... < output.sql 
```

如果那仍然太慢……购买更多硬件也可能会有所帮助。

# regex - 一个关于查找数字字符串的Java正则表达式

> ID：11434913
> 
> 赞同：2
> 
> 时间：2012-07-11T14:29:51.073
> 
> 标签：regex

我在网上学习Java正则表达式教程，对一个小程序感到困惑。

```
 // String to be scanned to find the pattern.
  String line = "This order was places for QT3000! OK?";
  String pattern = "(.*)(\\d+)(.*)";

  // Create a Pattern object
  Pattern r = Pattern.compile(pattern);

  // Now create matcher object.
  Matcher m = r.matcher(line);
  if (m.find( )) {
     System.out.println("Found value: " + m.group(0) );
     System.out.println("Found value: " + m.group(1) );
     System.out.println("Found value: " + m.group(2) );
  } 
```

打印出来的结果是：

```
Found value: This order was places for QT3000! OK?

Found value: This order was places for QT300

Found value: 0 
```

我不知道为什么 group(1) 获得上述值？为什么它在'QT3000'的最后一个零之前停止？

非常感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:32:35.583

第一组`(.*)`（这是索引 1 - 索引 0 是整体正则表达式）是贪婪匹配。它在让整体表达式仍然匹配的同时尽可能多地捕获。因此，它最多可以占用`0`字符串中的第二个，只剩`0`下 match `(\\d+)`。如果您想要不同的行为，那么您应该阅读贪婪和非贪婪匹配，或者找到更合适的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:38:49.073

实际上你弄错了组号。

组 0 将始终是要匹配的整个字符串

第 1 组将匹配 (.*) ，这被称为“贪婪”，因为它将匹配尽可能多的字符（在您的情况下，“此订单是 QT300 的位置”）

第 2 组是 (\d+) 的匹配项，这是匹配正则表达式的最小值（在您的情况下为“0”）

第 3 组（您没有打印）是最后一个 (.*) 并且应该匹配“！OK”（“？”是一个特殊的正则表达式字符，如果你想匹配它，请在它前面加上 \）

如果要匹配组 2 上的 3000，请使用此正则表达式：

```
String pattern = "(.*?)(\\d+)(.*)"; 
```

# javascript - JavaScript 访问 SVG 的内部 DOM

> ID：11434916
> 
> 赞同：27
> 
> 时间：2012-07-11T14:30:13.340
> 
> 标签：javascript, dom, svg

`test.php`是使用 PHP 生成的 SVG 对象。

```
<object data="test.php" type="image/svg+xml" id="SVG" />
<script>
    var mySVG = document.getElementById("SVG");
    var svgDoc = mySVG.contentDocument; 
```

`svgDoc`一片空白。（所以我无法通过 JS 访问 svg 的元素。）看看[这个问题，它应该可以工作。](https://stackoverflow.com/questions/2753732/how-to-access-svg-elements-with-javascript) 我究竟做错了什么？我怎样才能得到`contentDocument`我的 SVG？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-11T14:37:25.990

您需要等到 SVG 加载完毕，然后才能访问 contentDocument：

```
 var mySVG = document.getElementById("SVG");
 var svgDoc;
 mySVG.addEventListener("load",function() {
      svgDoc = mySVG.contentDocument;
      alert("SVG contentDocument Loaded!");
 }, false); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2018-12-11T00:39:45.110

不确定这是一个答案，但它对我有用。我遇到了同样的问题并且`svgObject`正在返回`null`：

`var svgObject = document.getElementById('svgObject').contentDocument;`

然后我突然想到我在本地运行我的 html 页面：file:///C:/wwwroot/App_dev/OverLay/Overlay03.html

从服务器运行它： [http://localhost:62551/App_dev/OverLay/Overlay03.html](http://localhost:62551/App_dev/OverLay/Overlay03.html)

它完美地工作并`svgObject`返回了它的内容，然后我可以得到`div`它的内部。

# django - 如何使用 Selenium 来验证 href URL 的格式是否正确？

> ID：11434921
> 
> 赞同：0
> 
> 时间：2012-07-11T14:30:29.557
> 
> 标签：django, xpath, selenium

我试图弄清楚如何使用 Django Selenium Webdriver 来测试特定页面上的 href URL 是否正确形成。

例如[http://www.domain.com/post/12/test_post](http://www.domain.com/post/12/test_post)

所以我想测试一个正则表达式，如：

```
'^post/(?P<id>\d+)/test_post)$' 
```

虽然我知道帖子的名称（slug），但我不知道 ID 是什么。如何使用 Selenium 测试 href URL 的格式是否正确？

我试过了：

```
self._driver.find_element_by_xpath("//a[matches(@href='/post/(/?P<id>\d+)/test_post')]") 
```

但我得到这个错误：

```
*** InvalidSelectiorException: Message: u'The given selector //a[matches(@href=\'/post/(/?P<id>\\d+)/test_post\')] is either invalid or does not result in a WebElement. The following error occurred:\n[InvalidSelectorError] Unable to locate an element with the xpath expression //a[matches(@href=\'/post/(/?P<id>\\d+)/test_post\')] because of the following error:\n[Exception... "The expression is not a legal expression."  code: "51" nsresult: "0x805b0033 (NS_ERROR_DOM_INVALID_EXPRESSION_ERR)"  location: "file:///var/folders/m 
```

但我一直在说，““该表达不是合法表达。”

```
self._driver.find_element_by_xpath("//a[starts-with(@href, '/post']")  
self._driver.find_element_by_xpath("//a[starts-with(@href, 'post/']")  
self._driver.find_element_by_xpath("//a[starts-with(@href, '/post/']") 
```

在这里，我还得到了““该表达式不是合法表达式。”

有没有办法可以验证 href 标签的格式是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:46:43.197

嗨，

似乎您没有关闭方法*匹配的括号*

尝试：

```
self._driver.find_element_by_xpath("//a[matches(@href, '/post/(?P<id>\d+)/test_post')]") 
```

# mysql - Mysql左连接计数

> ID：11434922
> 
> 赞同：0
> 
> 时间：2012-07-11T14:30:34.447
> 
> 标签：mysql

我的问题与我在游戏项目中编写的游戏有关图标。重要的是我计算了多少，所以当玩家捡起它们时，如果玩家将它们全部拿走，它将被移除。还有其他方法可以做到这一点，但我使用的方法很适合我的应用程序。

所以我需要在字段 x、y、land 上加入 3 个表并计算每个组合的出现次数，并将硬币存储为它们的值，所以我想计算每枚硬币（换句话说，增加计数值）所以我有所有表 posx,posy,land 中的表如下表名：game_coins 字段：posx,posy,land,value <--计为 #stored in value

```
table name: game_items
fields: posx, posy, land, item_id   <--counts as 1

table name: game_corpses
fields: posx, posy, land, id <-- counts as 1 
```

这是我到目前为止使用的查询，我得到一个模棱两可的错误，我知道这意味着什么，但似乎我应该能够调用具有 1 个列名的所有表，如果它们相同并且我按该列分组

```
SELECT  posx, posy, land, COUNT(*) as 'count' 
FROM game_itemlist  
LEFT JOIN game_corpses ON posx, posy, land  
LEFT JOIN game_coins ON posx,posy,land 
WHERE land = 'test' GROUP BY posx, posy, land 
```

我可以增加值来计算后记，但我不能正确地得到左连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:36:17.120

这真的不是一个`JOIN`. 并不是每个`game_item`都与一组特定的`game_corpses`; 这只是你要计算的两组东西。

A`UNION`可能更合适：

```
SELECT COUNT(1) FROM
(
 SELECT * FROM game_items WHERE ...
 UNION
 SELECT * FROM game_corpses WHERE ...
) 
```

根据您所做的工作量，您可能会受益于将这两个表格合并为一个表格，其中包含一个指示它是物品还是尸体的字段。

# ajax - 嵌套 JSF 复合组件中的 AJAX

> ID：11434929
> 
> 赞同：3
> 
> 时间：2012-07-11T14:30:50.183
> 
> 标签：ajax, jsf-2, primefaces, composite-component

我在使用 Mojarra 2.0.3 和 PrimeFaces 的嵌套复合组件中正确触发 AJAX 调用时遇到了一些麻烦。

子复合组件看起来像这样：

```
<cc:interface componentType="therapy">
    <cc:attribute name="therapyType" type="java.lang.String" required="true"/>
    <cc:attribute name="patientId" type="java.lang.String" required="true"/>
    <cc:attribute name="showHistory" type="java.lang.Boolean" required="false" default="true"/>
    <cc:attribute name="width" type="java.lang.String" required="false" default="350px"/>
    <cc:attribute name="maxHistory" type="java.lang.String" required="false" default="3"/>
    <cc:attribute name="collectDoctor" type="java.lang.Boolean" required="false" default="false"/>
    <cc:attribute name="collectCareDate" type="java.lang.Boolean" required="false" default="false"/>
    <cc:attribute name="important" type="java.lang.Boolean" requred="false" default="false"/>
</cc:interface>

<cc:implementation>

    <script>
        function #{cc.clientId}Toggle(){
            $("##{cc.clientId}_newbutton").toggle();
            $("##{cc.clientId}_savebuttons").toggle();

            if(#{cc.attrs.collectDoctor}){
                $("##{cc.clientId}_doctor").toggle();
            }

            if(#{cc.attrs.collectCareDate}){
                $("##{cc.clientId}_care").toggle();
            }

            $("##{cc.clientId}_newTherapy").toggle(50);
        }

        function #{cc.clientId}rowHighlight(event){
            if(event.status == 'begin'){
                $("##{cc.clientId}_loader").toggle();
            }
            if(event.status == 'success'){
                $("##{cc.clientId}\\:histTable tr:eq(1)").effect("highlight", {color:"#FED17A", easing:"easeInCubic"}, 2000);
            }
        }

        $(function(){
            if(#{cc.attrs.important}){
                $("div[class~='ui-panel-titlebar'][id^='#{cc.clientId}']").css("background", "#FED17A");
            }
        });
    </script>

    <h:form prependId="false">
        <p:panel styleClass="mcoPanel" style="width:#{cc.attrs.width};">
                <f:facet name="header">
                    <h:panelGroup>
                        <span id="#{cc.clientId}_title">#{cc.myType.word}</span>
                        <span id="#{cc.clientId}_newbutton" class="mcoPanel-controls">
                            <span onclick="#{cc.clientId}Toggle();">
                                <h:graphicImage name="page_new.gif" library="images"/>
                            </span>
                        </span>
                        <span id="#{cc.clientId}_savebuttons" class="mcoPanel-controls" style="display:none;">
                            <span id="#{cc.clientId}_loader" style="display:none;">
                                <h:graphicImage name="ajax-loader.gif" library="images" height="16" width="16"/>
                            </span>
                            <h:commandLink action="#{cc.saveNewTherapy}">
                                <f:ajax execute="newOnTherapy newExemption newDoctor newCareDate" render="@form" onevent="#{cc.clientId}rowHighlight"/>
                                <h:graphicImage name="action_save.gif" library="images"/>
                            </h:commandLink>
                            <span onclick="#{cc.clientId}Toggle();">
                                <h:graphicImage name="page_cross.gif" library="images"/>
                            </span>
                        </span>
                    </h:panelGroup>
            </f:facet>
            <div id="#{cc.clientId}_newTherapy" class="mcoPanel-new" style="display:none;">
                <h:outputLabel for="newOnTherapy" value="Satisfied:" style="position:relative; top: -10px;"/>
                <p:selectOneMenu id="newOnTherapy" label="Satisfied" value="#{cc.newOnTherapyValue}" style="width: 60px;">
                    <f:selectItem itemLabel=""/>
                    <f:selectItems value="#{cc.yesNoList}"/>
                </p:selectOneMenu>
                <br/>
                <h:outputLabel for="newExemption" value="Exemption:" style="position:relative; top: -10px;"/>
                <p:selectOneMenu id="newExemption" value="#{cc.newExemption}" style="width: 150px;">
                    <f:selectItems value="#{cc.exemptions}"/>
                </p:selectOneMenu>
                <span id="#{cc.clientId}_doctor" style="display:none">
                    <br/>
                    <h:outputLabel for="newDoctor" value="Doctor:"/>
                    <p:inputText id="newDoctor" value="#{cc.newDoctor}"/>
                </span>
                <span id="#{cc.clientId}_care" style="display:none">
                    <br/>
                    <h:outputLabel for="newCareDate" value="Care Date:"/>
                    <p:calendar id="newCareDate" label="Care Date" value="#{cc.newCareDate}" showButtonPanel="true">
                        <f:converter converterId="dateOfBirthConverter"/>
                    </p:calendar>
                </span>
            </div>
            <h:messages id="#{cc.clientId}_messages" errorClass="errorMessage"/>
            <p:dataTable id="histTable" value="#{cc.history}" var="item" rendered="#{cc.attrs.showHistory}">
                <!-- Table Output -->
            </p:dataTable>
        </p:panel>
    </h:form> 
```

父复合组件看起来像这样：

```
<cc:interface>
    <cc:attribute name="title" type="java.lang.String" required="true"/>
</cc:interface>

<cc:implementation>

    <h:outputScript name="containerpanel.js" library="js/components" target="head"/>

    <p:panel toggleable="true" styleClass="contentPanel" toggleSpeed="500" style="width:1100px;">
        <f:facet name="header">
            #{cc.attrs.title}
            <div class="ui-panel-titlebar-icon ui-corner-all ui-state-default contentSaveAll">
                Save All
            </div>
            <div class="ui-panel-titlebar-icon ui-corner-all ui-state-default contentExpandAll">
                ++
            </div>
            <div class="ui-panel-titlebar-icon ui-corner-all ui-state-default contentCollapseAll">
                - -
            </div>
        </f:facet>

        <cc:insertChildren>
                     <!-- Child components go here -->
        </cc:insertChildren>

    </p:panel>

</cc:implementation> 
```

该实现应该允许容器组件内有任意数量的子组件。

如果子组件放置在 Container 组件之外的页面上，则子组件会发送 ajax 请求并完美地更新其内部组件。此外，如果我使用容器的相同结构，但不是实际的复合组件，则一切正常。

一旦我将子组件放置为 Container 组件的子组件，这就是问题所在。子组件中没有 ajax 调用正确触发（即保存 commandLink） 使用 firebug 帮助调试它，我已经能够确定以下内容：

*   ajax 发布请求似乎正在发送。“开始” onevent 正在触发，并且在 firebug 中查看控制台显示正在向服务器发送一个帖子，并发送回正确的组件 ID 和值。
*   未调用支持 bean 中的操作。我有一个打印语句作为第一行，它没有打印。
*   ajax 请求似乎正在正确完成，“成功”事件正在触发。
*   页面上没有任何更新。表单不会刷新，页面顶部的 p:messages 对象也不会刷新。

显然我可以在没有 Container 组件的情况下做到这一点，但我当然更希望能够利用代码重用。我是否在这里遗漏了一些明显的东西，我需要做些什么才能让 ajax 正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T10:05:53.537

MyFaces 2.1.6 也有同样的问题。我无法使用 CC 界面中的 ClientBehavior 从嵌套的复合组件进行 AJAX 调用。

就像moneyT 写的那样，服务器被通知了ajax 标记中指定的事件，但是当生命周期进入第5 阶段- 调用应用程序时，事件为空并且没有调用任何侦听器。它越来越像 MyFaces 实现中的一个错误。

**编辑：**我找到了另一种解决方案，它比在复合组件中硬编码 ajax 好得多。我已将外部复合组件重构为 facelet。它失去了复合材料的一些怪癖，但它完成了工作。它也是可重复使用的。

~~我发现的唯一解决方案（比解决方案更多的工作）是在复合组件中硬编码 ajax，而不是使用 ClientBehavior，如下所示：~~

```
 <composite:implementation>            
       <h:panelGroup layout="block" id="listBox" class="list-box-scroll-pane" style="height:#{cc.attrs.visibleLines*27 + 5}px; width:#{cc.attrs.width}px">
        <h:inputText id="submit-value" style="visibility: hidden; width:0px; height: 0px;" value="#{cc.attrs.property}">
                 <f:ajax event="change"
                  render="carModel"
                  listener="#{carDetailsMediator.changeCarMake}" 
                  onevent="initComboboxes"/>
        </h:inputText>
        <ui:repeat value="#{cc.attrs.items}" var="element" varStatus="loop">
            <input id="input-#{cc.attrs.customId}-#{loop.index}" type="hidden" 
                            value="#{element.value}" />
            <div id="div-#{cc.attrs.customId}-#{loop.index}" class="list-box-row">#{element.label}</div>
        </ui:repeat>    

        </h:panelGroup>
    </composite:implementation> 
```

~~但是，这种解决方法不是很好，因为复合组件背后的想法是您可以通过许多不同的选项重用它们。硬编码 ajax 有点限制选项~~。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:12:06.710

我相信你的问题是这样的：

```
<f:ajax execute="newOnTherapy newExemption newDoctor newCareDate" ... 
```

该`execute`属性可以引用特殊关键字（例如@this、@form 等）或根据文档：

> 如果指定了文字，则它必须是由空格分隔的组件标识符和/或关键字之一的字符串。

当您将此组件作为子组件插入到父组件时，组件 ID 将由动态确定且不能绝对引用。

# javascript - jQuery Ajax 在 Android 平板电脑浏览器上失败

> ID：11434930
> 
> 赞同：0
> 
> 时间：2012-07-11T14:30:50.643
> 
> 标签：javascript, jquery

我正在使用默认浏览器的[三星平板电脑上进行开发。](http://www.samsung.com/global/microsite/galaxytab/10.1/index.html)

ISS 告诉我这个信息：Mozilla/5.0+(Linux;+U;+Android+3.2;+en-us;+GT-P7500+Build/HTJ85B)

将信息发布到服务器时，ajax 调用不断失败，错误为 0，并且没有任何信息。在所有其他浏览器上，它都可以正常工作。

知道为什么吗？

这是我使用的代码：状态为 0 结束 textStatus 未定义

```
$.ajax({
            url: uri,
            contentType: "application/json;charset=utf-8",
            dataType: "text",
            data: input,
            type: 'POST',
            error: function (jqXHR, textStatus, errorThrown) {
                doShowError("Error:" + jqXHR.status + "--" + textStatus + "--" + errorThrown + "-"+ jqXHR.readyState); 
            }
            } 
```

编辑1：`Mozilla/5.0+(Linux;+U;+Android+3.2;+en-us;+GT-P7500+Build/HTJ85B)+AppleWebKit/534.13+(KHTML,+like+Gecko)+Version/4.0+Safari/534.13`这就是我所得到的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T06:08:31.663

找到了解决方案：

似乎在这个 Webkit 浏览器中异步执行操作时，当从一个大响应中接收到多个数据块时，浏览器响应状态 0 表示错误，而不是 206 表示部分结果。我的建议是我们应该使用同步来解决这个问题，直到这个错误被修复：[http](http://code.google.com/p/android/issues/detail?id=14924) ://code.google.com/p/android/issues/detail?id=14924或者这个[http:/ /bugs.jquery.com/ticket/8343](http://bugs.jquery.com/ticket/8343)

# c - C中struct的双指针是什么意思

> ID：11434933
> 
> 赞同：0
> 
> 时间：2012-07-11T14:31:00.873
> 
> 标签：c, list, pointers, struct

我在理解这种结构时遇到了问题，很想得到一个清晰的解释。

```
typedef struct exp{
   int x;
   struct exp *parent;
   struct exp **children;
} 
```

父母和孩子是什么意思？“父”是这个结构的数组？孩子们的意思是什么？它是一个数组数组？！实在看不懂。。

最后一件事，如果我添加一个元素，它会成为某个父母的特定孩子，我怎样才能接触到父母的所有孩子？它不应该是一个结构“列表”（使用下一个等 .. 吗？）？

谢谢你！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:58:19.843

此图像显示了一种可能的情况：

![一个可能的场景](../Images/ef83f24b59712a7ded3ef9a01aaab1e0.png)

它是使用此代码和[DDD获得的](http://www.gnu.org/software/ddd/)

```
#include <stdio.h>
#include <stdlib.h>

struct exp{
    int x;
    struct exp *parent;
    struct exp **children;
};

int main ()
{
    struct exp *x = calloc(1, sizeof(x[0]));
    x->x = 42;
    x->parent = calloc(1, sizeof(x[0]));
    x->children = calloc(5, sizeof(x->children[0]));
    x->children[0] = calloc(1, sizeof(x[0]));
    x->children[2] = calloc(1, sizeof(x[0]));
    x->children[3] = calloc(1, sizeof(x[0]));
    x->children[4] = calloc(1, sizeof(x[0]));
    return 0;
} 
```

基本上，该`children`字段是指向的指针向量`struct exp`。你决定放多少元素和其他东西。

PS：代码只是一个demo，质量不太好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T14:57:03.823

它是一个指向指针的指针，在这种情况下，它似乎被用作`struct exp`.

每个`struct exp`都有一个对它的“父”的引用，以及一个指向子列表的指针`struct exp`。

```
typedef struct exp{
    int x;
    struct exp *parent;
    struct exp **children;
} element;

// create ROOT elemnt
element * root = (element*) malloc(sizeof(element)); //alocate mem. for 1 element 
```

一旦我们有了“根”，我们就可以添加孩子，以下是伪代码

```
for 1 to 10{
    child = new element;
    child->parent = root;                // tell the child who is his parent
    addToRoot( root , child);            // call a function that inserts elemnts to root

} 
```

所以现在我们应该有`root`一个包含 10 个元素的列表：

```
_______________                                    _______________   
|             | (children)                         |             | - (parent) points to struct exp, root
|     root    | - points to list of struct exp  -> |   child 0   |   
|             |                                    |             | - (children) points to null; // if it's empty  
_______________                                    _______________ 

                                                   _______________  
                                                   |             | - (parent) points to struct exp, root
                                                   |   child 1   |     
                                                   |             | - (children) points to null; // if it's empty 
                                                   _______________ 

                                                   _______________  
                                                   |             | - (parent) points to struct exp, root 
                                                   |   child 2   |      
                                                   |             | - (children) points to null; // if it's empty  
                                                   _______________ 

                                                   _______________  
                                                   |             | - (parent) points to struct exp, root 
                                                   |   child 3   |      
                                                   |             | - (children) points to null; // if it's empty  
                                                   _______________ 

                                                         .
                                                         .
                                                         . 

                                                   _______________  
                                                   |             | - (parent) points to struct exp, root 
                                                   |   child 9   |      
                                                   |             | - (children) points to null; // if it's empty  
                                                   _______________ 
```

类似的东西......它有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T14:39:01.077

它是一个指向子节点的指针数组——这看起来像是某种树结构。

每个节点都有一个父节点，每个节点有一个或多个子节点。您可以从父母前往其中一个孩子

```
expInstance->children[i]; 
```

其中 i 是表示其中一个子节点的数字。从这个定义中并不清楚有多少子节点——它可能是一个、两个或一百万。但是鉴于这些信息，您可以遍历它们。要么与

```
for(i=0; i<NUMBER_OF_CHILDREN_NODES;i++){
    expInstance->children[i];
} 
```

如果您提前知道数组的长度或有些奇怪

```
while(expInstance.children[i++]){
    expInstance->children[i];
} 
```

（有几种不同的巧妙方法可以做到这一点，但必须在结构中建立这样的假设，即在该数组的最后一个槽中将有一个空指针以终止它。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:37:10.510

没有看到更多代码很难说。你想实现一棵树吗？从这个定义来看，这对我来说是显而易见的：

*   parent 指向此结构的父节点。
*   children 指向其所有子节点的指针数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T19:26:02.917

首先，请记住，结构不能包含自身的实例。IOW，你不能做类似的事情

```
struct exp {
  int x;
  struct exp parent;
  ...
}; 
```

主要原因是结构类型在您尝试声明成员时不*完整；*由于您还没有完成对类型的描述，编译器不知道该成员应该有`parent`多大。`parent`更不用说`parent`成员本身会有一个`parent`type 的成员`struct exp`，而后者又会有一个`parent`type 的成员`struct exp`，而后者又会有一个`parent`type 的成员`struct exp`，等等等等等等。你会结束的与需要无限量存储的对象。

所以你不能有 type 的成员`struct exp`。但是，您*可以*有一个**指向**类型对象的指针`struct exp`；您可以创建指向*不完整*类型的指针，并且所有结构指针类型都具有相同的大小和表示形式（IOW，`struct foo *pf`并且`struct bar *pb`将具有相同的大小，即使`struct foo`和`struct bar`不具有相同的大小）。

所以`parent`成员（可能）只意味着指向一个类型的实例`struct exp`（每个实例`struct exp`都有一个父级）。同样，该`children`成员（可能）是一个指向指针的单维数组`struct exp`（每个实例`atruct exp`可以有零个、一个或多个子级）。

# c# - 简单的SQL Server表LINQ学习查询

> ID：11434934
> 
> 赞同：1
> 
> 时间：2012-07-11T14:31:03.407
> 
> 标签：c#, sql-server, linq

前言：

我正在尝试通过从现有程序创建新应用程序来学习 C#/LINQ。本质上，我正在将 SQL 存储过程移植到 C#/LINQ 代码中，其中包含一个新数据库和稍微不同的功能。尽管我在开始时得到了帮助，但我遇到了第一个有些人可能会说的微不足道的问题。

尽管非常感谢任何正确的答案，但方向也是如此。（例如，它只是一个简单的 Group Into 子句的查询吗？我错过了 stackoverflow 中的类似问题吗？由于浏览了几个月的 stackoverflow，我有很多学习工具可供使用，[101 LINQ Samples](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)，C# In Depth， C# 4.0 in a Nutshell and [LINQPad](http://www.linqpad.net/)信息很棒，只是我有点不知所措。

问题：

我有下表：

```
CREATE TABLE [dbo].[User]
([Id] [nvarchar](255) NOT NULL,
 [Name] [nvarchar](max) NOT NULL,
 [LineManagerId] [nvarchar](255) NULL,
 [Email] [nvarchar](max) NOT NULL,
 [IsAdmin] [bit] NULL,
) 
```

主键是`Id`，`LineManagerId`是外键`Id`。

我想编写 LINQ 代码来查询数据库以查找是否`Id`为`LineManagerId`AND，如果是，请选择所有具有的 Id `LineMangerId`？

我进行了如下尝试，但缺少一些我认为在我对 LINQ 的理解中非常基本的技能。

```
var ismanager = from manager in Users
                join man in Users on manager.Id equals man.LineManagerId
                select man.LineManagerId; 
```

谢谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:54:09.030

> 我想编写 LINQ 代码来查询数据库以查找 Id 是否为 LineManagerId，如果是，请选择 LineMangerId 具有的所有 Id？

我不太确定，为什么你需要在这里加入。

```
IQueryable<User> query = Users.Where(x => x.LineManagerId == id);
bool isManager = query.Any(); // first query to check if manager
if(isManager){
   IEnumerable<User> users = query.Select(x => x.Id).ToArray(); // second query to fetch Ids
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:41:21.497

> 我想编写 LINQ 代码来查询数据库以查找 Id 是否为 LineManagerId，如果是，请选择 LineMangerId 具有的所有 Id？

从字面上看，这是两个单独的查询，但这里有一个可以为您提供直线经理下的所有用户：

```
string managerID = "1";  // The manager ID to query
var userList = from manager in Users
   join u in Users on manager.Id equals u.LineManagerId
   where (manager.Id == managerID)
   select u.Id ; 
```

# sql-server-2005 - 使用 WHERE 子句更新多行

> ID：11434935
> 
> 赞同：1
> 
> 时间：2012-07-11T14:31:06.397
> 
> 标签：sql-server-2005

我正在尝试一次更新多行（SQL Server 2005）。以前我用这个查询更新单行：

```
UPDATE dbo.My_Users 
SET MyUserId = @MyUserId
WHERE EmailID = @EmailId 
```

现在`@EmailId`将有逗号分隔`EmailIds`。

如何修改脚本以更新多行？我看过一些使用`UNION ALL`. 但它们大多是插入多条记录而没有 where 子句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:45:30.460

[在Parameterize an SQL IN 子句](https://stackoverflow.com/questions/337704/parameterizing-an-sql-in-clause)中回答了类似的问题

在这里可以应用相同的想法：

```
declare @EmailIds varchar = '|email1@test.com|email2@test.com|';
UPDATE dbo.My_Users SET MyUserId=@MyUserId WHERE @EmailIds LIKE '%|' + EmailID + '|%'; 
```

虽然这不包含逗号分隔的列表，但分隔符可以很容易地更改为竖线字符。这里需要注意的是，表中存在的数据越多，@EmailIds 列表中的电子邮件地址越多，这个查询就会变得越慢（慢得多）。

使用 C#，我实际上会推荐上述问题中的第二个示例，其中扩展列表以创建类似于以下内容的查询：

```
UPDATE dbo.My_Users SET MyUserId=@MyUserId WHERE EmailID IN (@email1, @email2); 
```

C# 实现（上述问题中示例的修改版本）：

```
string[] emails = new string { "email1@test.com", "email2@test.com" };
string sql = "UPDATE dbo.My_Users SET MyUserId=@MyUserId WHERE EmailID IN ({0});"
string[] emailParams = emails.Select((s, i) => "@email" + i.ToString()).ToArray();
string inClause = string.Join(",", emailParams);
using (SqlCommand cmd = new SqlCommand(string.Format(sql, inClause))) {
    for(int i = 0; i < emailParams.Length; i++) {
       cmd.Parameters.AddWithValue(emailParams[i], emails[i]);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:33:56.020

您可以使用动态 SQL

```
exec('UPDATE dbo.My_Users SET MyUserId = ' + cast(@MyUserId as varchar) + ' WHERE EmailID in (' + @EmailIds + ')') 
```

# android - Android - 要测试应用内计费，我是否需要向 android 市场发布测试应用程序？

> ID：11434937
> 
> 赞同：0
> 
> 时间：2012-07-11T14:31:12.310
> 
> 标签：android, android-billing

我正在阅读本教程[http://developer.android.com/guide/google/play/billing/billing_testing.html](http://developer.android.com/guide/google/play/billing/billing_testing.html)真的让我很困惑 :)

在教程的一部分中，它讨论了我应该制作一个测试应用程序并将其发布到 google play 中。在本教程的另一部分，它讨论了设置静态返回值，以便我可以模仿 google play 返回到我的应用程序的内容。

如果我想测试某人购买访问某个页面的流程，这里的正确方法是什么？

我已经有了购买这些东西的代码。我只需要测试交易是否有效并且返回值是否正常。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:37:08.100

如果您想使用真实服务器进行测试，您需要上传您的 apk 文件，因为`draft version`不需要发布它。

正如他们所说

```
 Note: Making in-app billing requests with the reserved product IDs overrides the usual
Google Play production system. When you send an in-app billing request for a reserved product
ID, the quality of service will not be comparable to the production environment. 
```

所以...如果您想使用您的产品 ID 进行测试，您需要在市场上上传您的应用程序的签名版本（作为草稿），并且您还需要付费！:)

# java - 使用java将印度的货币价值显示为Rs.-100

> ID：11434938
> 
> 赞同：1
> 
> 时间：2012-07-11T14:31:13.273
> 
> 标签：java, currency

我正在尝试使用 java 显示印度的货币。

```
Locale locale = new Locale("en","IN");
NumberFormat nf = NumberFormat.getCurrencyInstance(locale);
nf.setCurrency(java.util.Currency.getInstance("INR"));
double val = -500.0;
System.out.println(nf.format(val)); 
```

它打印-Rs.500。但我希望它打印 Rs.-500。

# java - 绕过 if 语句中的类似变量重复

> ID：11434939
> 
> 赞同：4
> 
> 时间：2012-07-11T14:31:14.717
> 
> 标签：java, android, loops, reflection

我相信我对避免代码重复的长期问题提出了稍微不同的看法。设置是相当标准的——一堆 if 语句采取类似的行动。您将在下面找到一个简短的示例。

在代码效率、紧凑性和程序员易用性方面，我试图找出解决此类情况的最佳方法。请注意，解决这些问题的单独解决方案很好，确实更可取，因为我怀疑一个解决方案会同时满足所有三个问题。

例如，想到的一种可能的解决方案似乎笨拙而缓慢，尤其是在像 android 这样的移动设备上，而且它只有在变量是实例变量时才有效，而不仅仅是本地变量（这很可能是案子）。这个想法涉及一个 for 语句，其初始化表达式将使用双括号初始化来用与所涉及的变量相对应的字符串填充哈希映射（例如，“installText”映射到“installPermission”），然后 for 循环将包含一个 if- -else-if--else-if 子句，它将使用反射通过存储在哈希图中的变量名称来访问变量。

我怎样才能做得更好？提前感谢您的时间和建议！

```
if (installText.equals("Default")) {
    installPermission = DEFAULT;
} else if (installText.equals("Allow")) {
    installPermission = ENABLED;
} else if (installText.equals("Disallow")) {
    installPermission = DISABLED;
}
if (uninstallText.equals("Default")) {
    uninstallPermission = DEFAULT;
} else if (uninstallText.equals("Allow")) {
    uninstallPermission = ENABLED;
} else if (uninstallText.equals("Disallow")) {
    uninstallPermission = DISABLED;
}
if (runText.equals("Default")) {
    runPermission = DEFAULT;
} else if (runText.equals("Allow")) {
    runPermission = ENABLED;
} else if (runText.equals("Disallow")) {
    runPermission = DISABLED;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:34:16.203

您使用的是 Java 7 吗？在这种情况下，您可以使用`switch`现在支持`String`值的语句：

```
switch(installText) {
    case "Allow":
        installPermission = ENABLED;
        break;
    case "Disallow":
        installPermission = DISABLED;
        break;
    case "Default":
        installPermission = DEFAULT;
        break;  
    default:
        installPermission = DEFAULT;
        break;  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:42:11.327

将值检查提取到一个单独的方法（我正在重新使用 Simeon Visser 的部分答案并进行改进）：

```
public String getPermission(String permission)
{
    String state = null;

    // If this is Java 7:
    /*
    switch(permission)
    {
        case "Allow":
             state = ENABLED;
             break;
        case "Disallow":
             state = DISABLED;
             break;
        case "Default":
        default:
             state = DEFAULT;
             break;  
    }
    */

    // If this is Java < 7:
    if (permission.equalsIgnoreCase("allow"))
        state = ENABLED;
    else if (permission.equalsIgnoreCase("disallow"))
        state = DISABLED;
    else
        state = DEFAULT;

    return state;
}

public void callingMethod(String permission)
{
     installPermission = getPermissionState(permission);
     uninstallPermission = getPermissionState(permission);
     runPermission = getPermissionState(permission);
} 
```

此外，`ENABLED`和`DISABLED`应该`DEFAULT`简单地定义为您的类中的常量：

```
public static final String ENABLED = "ENABLED";
public static final String DISABLED = "DISABLED";
public static final String DEFAULT = "DEFAULT"; 
```

但是，我仍然无法通过反射来理解您的想法……？我认为这里没有必要，除非您有一个用例，其代码目前没有显示......？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T15:41:19.933

如果您 100% 确定，则字符串值将是这三个值之一。那么你可以这样做：

```
Map<String,String> map;
map.put("Default", "Default");
map.put("Allow", "Allow");
map.put("Disallow", "Disallow");
installPermission = map.get(installText);
uninstallPermission = map.get(uninstallText);
runPermission = map.get(runText); 
```

干杯

# java - Ant 执行任意程序并在 junit 任务结束时终止

> ID：11434944
> 
> 赞同：0
> 
> 时间：2012-07-11T14:31:21.223
> 
> 标签：java, ant, junit, rmi

我正在尝试针对一系列 RMI 接口/实现编写单元测试，并依靠 Ant + Junit 来促进这些测试。主要问题是我需要`rmiregistry`在我的 Junit 任务开始时启动并在执行结束时关闭，无论是失败、错误还是成功。蚂蚁脚本：

```
<project>
    <target name="test">  
      <javac srcdir="Test/src" destdir="Test/bin" />  
      <junit fork="true" printsummary="true">  
          <batchtest>   
             <fileset dir="Test/test">  
                 <include name="**/*Test.*"/>  
             </fileset> 
          </batchtest>  
      </junit>  
    </target>  
</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:47:07.503

基本上，只需为 junit 任务设置`haltonerror="false"`和“。 这种方式不会因测试而失败。启动和停止是通过[exec 任务完成](https://ant.apache.org/manual/Tasks/exec.html)的。我在这里使用 taskkill 来杀死 rmiregistry.exe。`failonerror="false`
`junit`

```
<exec executable="start"> <--your start command here -->
  <arg value="rmiregistry"/>
</exec>
<junit fork="true" printsummary="true" haltonerror="false" failonerror="false" errorproperty="juniterrors" failureproperty="junitfailures"> 
  ...
</junit>
<exec executable="taskkill"> <--your shutdown command here -->
  <arg value="/IM"/>
  <arg value="rmiregistry.exe"/>
</exec>
<fail if="juniterrors"/> <!-- ant can fail now, if desired -->
<fail if="junitfailures"/> 
```

另一种选择是使用[来自 ant-contrib 的 try/catch](http://ant-contrib.sourceforge.net/tasks/tasks/trycatch.html)，但我认为这里不需要。

# ios - 如何加快音频文件的加载速度，以免用户等待。

> ID：11434946
> 
> 赞同：2
> 
> 时间：2012-07-11T14:31:26.607
> 
> 标签：ios, audio, core-audio, mixer

我正在构建一个游戏，让用户重新混合歌曲。我已经构建了一个混音器（基于苹果示例代码 MixerHost（使用混音器 audioUnit 创建一个 audioGraph），但扩展为加载 12 个音轨。一切正常，但是当游戏玩家加载歌曲需要很长时间选择他们想要混音的歌曲。这是因为程序必须先将 12 个单独的 mp4 文件加载到内存中，然后我才能开始播放音乐。

我认为我需要创建一个 AUFilePlayer audioUnit 负责将文件加载到混音器中。如果 AUFilePlayer 可以处理动态加载文件，那么用户将不必等待文件 100% 加载到内存中。我的两个问题是，1\. AUFilePlayer 可以这样使用吗？2\. AUFilePlayer 上的文档非常非常非常薄。我在哪里可以找到一些示例代码演示如何在 IOS（而不是在 MacOS 中）正确实现 AUFilePlayer？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:40:45.150

我认为您是对的-在这种情况下，您可能需要“直接从磁盘”缓冲方法。我相信正确的 AudioUnit 子类型是`AudioFilePlayer`. 从文档中：

> 该单元读取音频文件数据并将其转换为自己的内部缓冲区。它在进程内该单元的所有实例之间共享的高优先级线程上执行磁盘 I/O。完成磁盘读取后，该单元在内部调度缓冲区以进行播放。

[在Chris Adamson 的《*Learning Core Audio*](https://rads.stackoverflow.com/amzn/click/com/0321636848) 》一书中给出了在 Mac OS X 上使用该单元的工作示例。iOS 的代码并没有太大的不同，在 CoreAudio-API 邮件列表上的[这个线程中进行了讨论。](http://lists.apple.com/archives/coreaudio-api/2011/Nov/msg00041.html)可以在[此处](http://pastie.org/2820693)找到 Adamson 的工作代码示例。您应该能够根据您的要求进行调整。

# ruby-on-rails - ruby on rails 我应该从控制器查询到 db

> ID：11434947
> 
> 赞同：1
> 
> 时间：2012-07-11T14:31:39.940
> 
> 标签：ruby-on-rails, database, activerecord

我刚刚开始使用 Ruby on Rails，我不确定我应该如何对数据库进行查询以获取数据、添加数据或编辑数据......

例如从控制器中找到用户更好还是将查询添加到模型中更好？

目前，我的用户主页控制器看起来像这样，具有一些简单的功能

```
class HomeController < ApplicationController

  #get current_user variable
  helper_method :current_user

  def index
    if user_signed_in?
        @user = User.find_by_id(current_user.id)
    else
        render_404
    end
  end
end 
```

它只是检查用户是否登录并找到用户......

我应该将数据库调用移动到模型以获得最佳实践还是使用上述方法也可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:34:59.053

您通常希望使用 rails 默认为我们提供的带有活动记录的存储库模式。我会说这完全没问题。如果您有更复杂的业务逻辑或从多个表中提取，那么我可能会将它移到它自己的类中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T14:35:18.097

在我看来，你这样做的方式很好。控制器的工作是为视图设置数据，设置数据的一部分是从数据库中获取数据。

对于更复杂的数据库查询，您可以使用位于模型中的[范围。](http://apidock.com/rails/ActiveRecord/Scoping/Named/ClassMethods/scope)这样控制器就不会在模型上保存太多的数据库查询逻辑。

# android - 对话框仅显示第二次按下按钮以激活它

> ID：11434958
> 
> 赞同：1
> 
> 时间：2012-07-11T14:32:10.247
> 
> 标签：android, dialog, show-hide, timepicker, android-datepicker

`TimePickerDialog`我对and有一些问题`DatePickerDialog`，代码如下：

```
public void onClick(View v) {
    if (v.equals(checkInTime)) {
        showDialog(1);
    }

@Override
protected Dialog onCreateDialog(int id) {
    if (id == 1) {
        return new TimePickerDialog(this, this, dt.getHourOfDay(), dt.getMinuteOfHour(), true);
    }

    return super.onCreateDialog(id);
} 
```

它就像一个魅力，直到我在对话框中按下“设置”，然后下次我点击按钮什么都没有发生（对话框没有出现），但如果我再点击一次，对话框再次显示。它每次都显示，直到我按下“设置”，然后单击一次将不起作用，但在下次单击时再次开始工作。

DatePickerDialog 也会出现同样的问题。有没有人有任何想法？

听众什么也不做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T11:23:20.967

调用`dismiss()`您的对话框 ( `TimePickerDialog`) 是问题所在。它与调用`cancel()`,相同`onBackPress()`，因为它调用`dismiss()`. 相反，您可以调用`hide()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T13:19:05.673

我遇到了类似的问题。
在模拟器上一切正常，但在三星 Galaxy Note [android 4] 上，每秒钟都显示 DialogDatePicker 失败。我怀疑隐藏/关闭 DialogDatePicker 是错误的。

为“确定”按钮添加侦听器后，一切都开始正常工作。

```
DatePickerDialog dpd = new DatePickerDialog(this, callBack, fakeYear, fakeMonth, fakeDay);
dpd.setButton(DialogInterface.BUTTON_POSITIVE, getString(android.R.string.ok), new DialogInterface.OnClickListener() {
   public void onClick(DialogInterface dialog, int which) {
      if (which == DialogInterface.BUTTON_POSITIVE) {
         System.out.println("here nothing more is needed");
         System.out.println("dialog closed and next time appear again");
      }
   }
}); 
```

# javascript - 如何通过点击更改图像 - javascript

> ID：11434959
> 
> 赞同：-3
> 
> 时间：2012-07-11T14:32:17.437
> 
> 标签：javascript, html, css

我有一个包含 5 个表格单元格的工具栏。第一个单元格看起来很清晰，其他 4 个单元格有阴影。我想这样做，以便单击表格单元格也会更改图像，以便阴影也会相对于当前选定的表格单元格发生变化。

```
<script src="../../jquery-1.7.2.min.js" type="text/javascript"> 

    $('table.stories-preview td').click((function () {
    var last_image = null;

    return function () {
        if (last_image) {
            $('table.stories-preview .selected').attr('src', last_image).removeClass('selected');
        }

        var $clicked_image = $('img', this);
        last_image = $clicked_image.attr('src');
        $clicked_image.attr('src', 'http://i1251.photobucket.com/albums/hh544/kochb/th_checklist_on.png').addClass('selected');
    }
})());

     $(document).ready(function() {
    $(".fade").css("display", "none");

    $(".fade").fadeIn(500);

    function redirectPage() {
        window.location = linkLocation;
    }
}); 

    $(document).ready(function() {

     $('.preview').hide();

  $('#link_1').click(function(){ 
      $('#latest_story_preview1').hide();
       $('#latest_story_preview2').hide();
      $('#latest_story_preview3').hide();
      $('#latest_story_preview4').hide();
      $('#latest_story_main').fadeIn(800);
  });   

  $('#link_2').click(function(){ 
      $('#latest_story_main').hide();
      $('#latest_story_preview2').hide();
      $('#latest_story_preview3').hide();
      $('#latest_story_preview4').hide();
      $('#latest_story_preview1').fadeIn(800);
  });

  $('#link_3').click(function(){ 
      $('#latest_story_main').hide();
      $('#latest_story_preview1').hide();
      $('#latest_story_preview3').hide();
      $('#latest_story_preview4').hide();
      $('#latest_story_preview2').fadeIn(800);
  });

    $('#link_4').click(function(){ 
      $('#latest_story_main').hide();
       $('#latest_story_preview1').hide();
      $('#latest_story_preview2').hide();
      $('#latest_story_preview4').hide();
      $('#latest_story_preview3').fadeIn(800);
  });
    $('#link_5').click(function(){ 
      $('#latest_story_main').hide();
       $('#latest_story_preview1').hide();
      $('#latest_story_preview2').hide();
      $('#latest_story_preview3').hide();
      $('#latest_story_preview4').fadeIn(800);
  });

    });

</script>

    <table class="stories-preview" width="330" height="598" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td>
            <a id="link_1" href="#"> <img src="../../Images/N&EImages/images-con-1/Article-Nav-Bar1_01.gif" width="330" height="114" alt=""></a></td>
    </tr>
    <tr>
        <td>
            <a id="link_2" href="#"> <img src="../../Images/N&EImages/images-con-1/Article-Nav-Bar1_02.gif" width="330" height="109" alt=""> </a></td>
    </tr>
    <tr>
        <td>
        <a id="link_3" href="#"> <img src="../../Images/N&EImages/images-con-1/Article-Nav-Bar1_03.gif" width="330" height="132" alt=""></a></td>
    </tr>
    <tr>
        <td>
            <a id="link_4" href="#"><img src="../../Images/N&EImages/images-con-1/Article-Nav-Bar1_04.gif" width="330" height="124" alt=""></a></td>
    </tr>
    <tr>
        <td>
            <a id="link_5" href="#"><img src="../../Images/N&EImages/images-con-1/Article-Nav-Bar1_05.gif" width="330" height="119" alt=""></a></td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:14:07.827

回答一般问题，您可以使用 javascript 和 CSS 在单击时突出显示单个单元格。我拼凑了一个[JS Fiddle 示例](http://jsfiddle.net/mqaL7/)；您可以根据自己的目的进行调整。

这是[一个可以为您换出图像的版本](http://jsfiddle.net/mqaL7/3/)。

# url-rewriting - 在 nginx 中重写规则挑战

> ID：11434960
> 
> 赞同：1
> 
> 时间：2012-07-11T14:32:18.377
> 
> 标签：url-rewriting, nginx

我有这个旧网址来自我们以前的网站

[http://site.com/fixed-word/changeing-category/12345-title-of-story](http://site.com/fixed-word/changing-category/12345-title-of-story)

“变量”在哪里

不断变化的类别：例如体育、政治等。

和

12345-title-of-story：12345 是旧的 id，其余的是故事 slug/title

新站点仅使用这种格式的故事片段

[http://site.com/another-fixed-word/title-of-story](http://site.com/another-fixed-word/title-of-story)

是否可以在 nginx 中创建 301 重写规则来实现这一点？

我试过这个：

重写 ^/fixed-word/([^\?]+)$/([^\?]+)$ /index.php?tipo=old_article&slug=$1 last;

想法是在 php 中获取 slug 并从 slug (12345-) 中删除数字 id 但不起作用，老化返回 404

有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:30:33.657

这个正则表达式是完全错误的： `^/fixed-word/([^\?]+)$/([^\?]+)$`

如果你只需要创建一个 301 重定向，那么你应该使用这个：

```
location /fixed-word/ {
    rewrite ^/fixed-word/(?:[^/]+)/(?:\d+)-(.+)$ /another-fixed-word/$1 permanent;
} 
```

*   人 pcrepattern
*   man pcresyntax
*   [http://nginx.org/r/rewrite](http://nginx.org/r/rewrite)
*   [http://nginx.org/r/location](http://nginx.org/r/location)

# .net - 使用 Visual Studio 2010 和 Team Foundation Server 2010 设置新项目的步骤

> ID：11434961
> 
> 赞同：0
> 
> 时间：2012-07-11T14:32:20.253
> 
> 标签：.net, visual-studio-2010

我几乎没有搜索过有关使用 VS 和 TFS 的信息，但是在浏览了很多网站并阅读了各种博客之后，我对设置新项目应该遵循的步骤感到有些困惑。我认为下面的这些基本上是需要的，但既不知道是否有东西离开也不知道执行它们的顺序：

*   创建一个新的团队项目集合
*   在上述集合中创建一个新的团队项目
*   设置服务器文件夹结构
*   在 Visual Studio 中创建一个新项目
*   将项目与 TFS 连接

有人能帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:34:31.300

您可能已经有一个名为 DefaultCollection 的团队项目集合 (TPC)。如果没有，那么您只能使用 TFS 管理控制台从 TFS 服务器的桌面创建新的 TPC。

您将需要从 Visual Studio 2010 (VS) 创建一个新的团队项目 (TP)；如果您在 Windows 7 或 Server 2008 R2 上使用它，请确保您运行 VS 'elevated.'。这是通过使用 VS 中的 Team Explorer 工具连接到 TFS 服务器来执行的；然后右键单击团队资源管理器顶部的节点并选择创建新 TP 的选项。给它一个名字（你以后不能改名字，顺便说一句），然后在 TP 创建向导中选择一个模板；敏捷模板似乎是最受欢迎的。对于其余部分，请选择默认值。

现在你有了一个项目，可以开始使用 TFS...

如果您想将其用于源代码管理，那么一种简单的入门方法是在连接到新 TP 时在 VS 中打开您的解决方案，右键单击它并选择将其添加到源代码管理的选项。

希望这足以让您入门！

# java - 为什么我在我的简单 java 程序中得到 ClassCastException？

> ID：11434962
> 
> 赞同：0
> 
> 时间：2012-07-11T14:32:20.553
> 
> 标签：java, exception

在下面的程序中，我希望没有例外。使用`go2`go() 方法中的方法，我收到异常错误“无法将树转换为 Redwood”。

对我来说，这只是沮丧，应该完全没问题。有人可以帮我理解为什么会抛出异常吗？

```
class Tree{ }  
class Redwood extends Tree {
    void go() 
    {
        go2(new Tree(), new Redwood());
        go2( (Redwood)new Tree(), new Redwood());    
    }

    void go2(Tree t1, Redwood r1)
    {
        Redwood r2 = (Redwood) t1;
        Tree t2 = (Tree) r1;
    }

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        new Redwood().go();
    }
}

>> a similar program and this one works fine .

class Animal2 {  
    static void doStuff(){
        System.out.println("a " );
    }

}  

class Dog extends Animal2{

     static void doStuff(){

         System.out.println("b ");
     }  
     void playdead(){ System.out.print(" ccc" + "\n");
}

    public static void main(String[] args)   {
        // TODO Auto-generated method stub

        Animal2[] a= {new Animal2(), new Dog(), new Animal2()};

        for(Animal2 animal : a)  
        {   
                animal.doStuff();  
            if(animal instanceof Dog)  
        {
                ((Dog) animal).playdead();
                }  
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:37:35.950

红木是一种树。一棵树不是一种红木，就像所有动物都是猫一样。所以这不起作用：

```
(Redwood)new Tree() 
```

但这会：

```
(Tree)new Redwood() 
```

也许你打算这样做：

```
void go() {
    go2(new Tree(), new Redwood());
    go2(new Redwood(), new Redwood());

} 
```

Java 将在第二次调用中自动使用第二个红木作为`go2`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:36:13.880

`go2( (Redwood)new Tree(), new Redwood());`我假设您的程序失败了。考虑一下：根据您的继承关系，每个`Redwood`（实例）也是`Tree`. 但并非每棵树都是红杉。

试图将结果`new Tree()`转换为`Redwood`必须失败。对于所有 VM 而言，它可能是一棵桦树。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:36:34.117

您不能将对象类强制转换为被调用`A`的某个子类的实例。`A``B`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:35:36.740

你正在创建一个`Tree`，然后试图说服编译器它是一个`Redwood`. 它不是！

我通常不会期望看到这样的选角。如果您必须这样做，通常表明您的对象建模不正确。

在上面的示例中，我希望`Tree`是抽象的，并且您可以创建`Redwoods`等`Larchs`。您将无法创建 a `Tree`，因为您需要创建特定的物种。`Trees`因为 a `Redwood` **is-a** ，所以方法的接口可能会用`Tree`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T14:36:07.580

Redwood 是 Tree 的子类，您正在尝试从 Tree 转换为 Redwood。这是不可能的，因为树不是红木。您可以将红木投射到树上，因为它也是一棵树。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-11T14:35:02.323

我假设`Redwood`继承自`Tree`. 您已经创建了一个新实例`Tree`- 这不能转换为更具体的类型，因为它根本不是一个。一棵树不一定是红木。继承以另一种方式起作用——`(Tree)new Redwood()`就像红木**是一**棵树一样完全有效——这是继承时要牢记的关键短语。

# mysql - Mysql 查询永远不会停止

> ID：11434964
> 
> 赞同：0
> 
> 时间：2012-07-11T14:32:28.203
> 
> 标签：mysql

我有一个包含 3 列的简单表格

```
PageDescription(varchar(50)) | ParentID (int) | CategoryID (int) 
```

这是表格数据

```
水果||1
苹果|1|2

```

这是我正在运行的查询

```
SELECT PageDescription,(SELECT PageDescription
      FROM tblpages a
     WHERE a.ParentID = tblpages.CategoryID)
      AS 'Page Parent'
 FROM tblpages 
```

这个查询不会停止处理，有没有更好的方法来处理这个查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:40:12.267

您可以使用 a`JOIN`来执行此操作：

```
SELECT t1.PageDescription
  , t2.PageDescription as PageParent
FROM t t1
LEFT JOIN t t2
  on t1.ParentId = t2.CategoryId 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/9c613/10)

使用 a`LEFT JOIN`将允许您包含具有空值的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:35:46.590

你需要的是一个加入。

```
SELECT a.PageDescription, b.PageDescription as Parent
FROM tblpages a
LEFT JOIN tblpages b ON a.CategoryID = b.ParentID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:37:31.780

尝试命名您的两个表：

```
SELECT b.PageDescription,(SELECT PageDescription
      FROM tblpages a
     WHERE a.ParentID = b.CategoryID)
      AS 'Page Parent'
 FROM tblpages b 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:40:32.063

```
SELECT p.PageDescription,p1.PageDescription
      FROM tblpages p1
      LEFT JOIN p2 on p1.parentId=p2.categoryID
     WHERE 1; 
```

# ios5 - Safari（OSX 和 iOS）忽略了 SVG 线性梯度传播方法

> ID：11434971
> 
> 赞同：0
> 
> 时间：2012-07-11T14:32:40.637
> 
> 标签：ios5, safari, svg, mobile-safari

请查看随附的示例。它在任何地方（包括 Android）都可以正常工作，但在 iOS 5.1.1（iPhone / iPad）Safari 中。如果你在那里测试它，你会发现线性渐变根本没有重复，因为它出现在其他任何地方。这是 ios safari 的错误还是我的 svg 有问题？

```
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   version="1.1"
   width="150"
   height="150"
   id="svg5262"
    onload="anim();">
  <defs
     id="defs5264">
    <linearGradient
       x1="0"
       y1="0"
       x2="-8"
       y2="8"
       id="linearGradient5260"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,0)"
       spreadMethod="repeat">
        <stop
             id="stop5216"
             style="stop-color:#ff0000;stop-opacity:1"
             offset="0" />
          <stop
             id="stop5218"
             style="stop-color:#7f0000;stop-opacity:1"
             offset="1" />
    </linearGradient>
  </defs>
    <script language="javascript">
        var x=0;
        function anim(){
            var gr = document.getElementById("linearGradient5260");
            gr.setAttribute("gradientTransform", "translate(" + x + ", 0)");
            x++;
            if (x>15) x=0;
            setTimeout(anim, 50);
        }
    </script>
  <g
     id="layer1">
    <path
       d="M 20,140 L 20,20 140,20"
       style="fill:none;stroke:black;stroke-width:12;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
    <path
       d="M 20,140 L 20,20 140,20"
       id="path2985"
       style="fill:none;stroke:url(#linearGradient5260);stroke-width:10;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
  </g>
</svg> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T09:21:30.540

这是一个错误。Apple 已向我确认（错误 ID #10171198，位于[http://bugreport.apple.com](http://bugreport.apple.com)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T00:36:01.777

@Iviggiani 似乎在 iPad 上忽略了 linearGradient 标签的 spreadMethod 属性（在我的测试中包括 Safari 和 Chrome）。使用 SVG linearGreadient 和 pattern 标签，我能够创建与仅使用 linearGradient 标签相同的效果，其好处是它可以在 Windows 机器和 iPad 上运行。我从这个网站得到了这个想法[https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Patterns](https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Patterns)

这是我所做的一个示例（此处为 jsFiddle：http: [//jsfiddle.net/wahoodoss/eG5Tx/](http://jsfiddle.net/wahoodoss/eG5Tx/)）：

```
<!DOCTYPE html>
 <html>
<body>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <svg id="abc" width="200" height="200" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
            <linearGradient id="Gradient1">
                x1="0%" y1="0%" x2="0%" y2="100%"
                <stop offset="40%" stop-color="white" stop-opacity="1"/>
                <stop offset="100%" stop-color="#00AA00" stop-opacity="1"/>
            </linearGradient>

            <pattern id="Pattern" x="0" y="0" width="5" height="5" 
                patternTransform="rotate(90 0 0)" patternUnits="userSpaceOnUse">
                <rect x="0" y="0" width="5" height="5" fill="url(#Gradient1)"/> 
            </pattern> 

        </defs>
    </svg>

    <script>
        var arc = d3.svg.arc()
            .innerRadius(40).outerRadius(100)
            .startAngle(20 * 3.141 / 180)
            .endAngle(120 * 3.141 / 180);

        var chart = d3.select("#abc")
            .attr("class", "chart")
            .attr("width", 420)
            .attr("height", 420);

        chart.append("svg:rect")
            .style("fill","url(#Pattern)")
            .style("stroke", "black")
            .attr("x", 20).attr("y",20).attr("width",120).attr("height",120);

    </script>
</body>
  </html> 
```

# android - MediaRecorder 启动失败：-16

> ID：11434972
> 
> 赞同：1
> 
> 时间：2012-07-11T14:32:42.900
> 
> 标签：android, mediarecorder, android-mediarecorder

所以我意识到 MediaRecorder 启动错误有很多解决方案，但是其中大多数都围绕“启动失败：-19”，它已链接到“NO_INIT”[请参阅此处选择答案中的评论](https://stackoverflow.com/questions/9098216/error-opening-android-camera-for-streaming-video "在此处查看所选答案中的评论")。我还没有找到任何解决方案，甚至没有找到-16 的解释。

如果有人知道我在哪里可以找到这些错误代码的名称，或者有代码 -16 的解决方案，请把答案放在这里！！这是我正在使用的代码。（HTC迅雷，股票）

```
mr.setVideoSource(MediaRecorder.VideoSource.CAMERA); //mr is my mediaRecorder
mr.setAudioSource(MediaRecorder.AudioSource.MIC);
mr.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
mr.setVideoEncoder(MediaRecorder.VideoEncoder.DEFAULT);
mr.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
mr.setOutputFile(ParcelFileDescriptor.fromSocket(soc).getFileDescriptor());  //soc is a java.net.ServerSocket pointing to a port on the device

mr.setVideoSize(480,800);
mr.setVideoFrameRate(5);
mr.prepare();
mr.start(); //Crashes with "start failed: -16" 
```

LOGCAT

```
07-11 10:14:34.879: V/MediaRecorderJNI(17939): JNIMediaRecorderListener::setCamera
07-11 10:14:34.879: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.549: V/MediaRecorderJNI(17939): setVideoSource(1)
07-11 10:14:47.549: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): setAudioSource(1)
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): setOutputFormat(0)
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): setVideoEncoder(0)
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): setAudioEncoder(0)
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): setVideoFrameRate(5)
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): setOutputFile
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): prepare
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.559: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:47.559: V/MediaRecorderJNI(17939): start
07-11 10:14:47.559: V/MediaRecorderJNI(17939): getMediaRecorder E
07-11 10:14:47.639: E/MediaRecorder(17939): start failed: -16
07-11 10:14:47.639: V/MediaRecorderJNI(17939): process_media_recorder_call
07-11 10:14:59.290: W/dalvikvm(17939): threadid=10: thread exiting with uncaught exception (group=0x4001d5a0) 
```

**更新 07/11/12 下午 2:21**：发现错误代码 -16 实际上是 -EBUSY。在扩展 LogCat 以包含所有内容并彻底梳理 Android 源代码后，我发现它与无法调整（初始化）相机设置有关，我不确定我做错了什么，但它是一个开始。如果您可以访问 AOSP，您可以看到错误来自 /frameworks/av/media/libstagefright/CameraSource.cpp CameraSource::ConfigureCamera

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T03:28:24.163

我遇到了这个错误（启动时为-16），发现它是由使用不受支持的分辨率引起的。

首先，您必须从支持的尺寸中获得最佳尺寸

```
Parameters params = camera.getParameters();
        List<Size> sizes = params.getSupportedPreviewSizes();
        optimalSize = getOptimalPreviewSize(sizes, width, height);
params.setPreviewSize(optimalSize.width, optimalSize.height); 
```

然后确保将预览和视频设置为相同的大小（如果它们在我的体验中不同，则在视频录制开始时预览会冻结）：

```
mediaRecorder.setVideoSize(optimalSize.width, optimalSize.height); 
```

（getOptimalPreviewSize 的示例代码来自 android sdk）

```
private Size getOptimalPreviewSize(List<Size> sizes, int w, int h) {
    final double ASPECT_TOLERANCE = 0.1;
    double targetRatio = (double) w / h;
    if (sizes == null) return null;

    Size optimalSize = null;
    double minDiff = Double.MAX_VALUE;

    int targetHeight = h;

    // Try to find an size match aspect ratio and size
    for (Size size : sizes) {
        double ratio = (double) size.width / size.height;
        if (Math.abs(ratio - targetRatio) > ASPECT_TOLERANCE) continue;
        if (Math.abs(size.height - targetHeight) < minDiff) {
            optimalSize = size;
            minDiff = Math.abs(size.height - targetHeight);
        }
    }

    // Cannot find the one match the aspect ratio, ignore the requirement
    if (optimalSize == null) {
        minDiff = Double.MAX_VALUE;
        for (Size size : sizes) {
            if (Math.abs(size.height - targetHeight) < minDiff) {
                optimalSize = size;
                minDiff = Math.abs(size.height - targetHeight);
            }
        }
    }
    return optimalSize;
} 
```

# json - 如何在 iOS5 中将 JSON 数据对象发布到服务器？

> ID：11434977
> 
> 赞同：7
> 
> 时间：2012-07-11T14:32:53.557
> 
> 标签：json, http, post, ios5, webserver

我想通过使用数据类型的`POST`方法将在 iOS 上创建的新对象发送到接收服务器。`JSON`根据我对**从**iOS 中的服务器接收数据的了解，Apple 在引入 iOS 5 时简化了所有`JSON`处理。但与 GETting JSON 对象不同，在我能找到的任何地方都没有真正描述 POST ......

我尝试解决问题的第一步如下所示：

```
 //build an info object and convert to json
    NSDictionary *newDatasetInfo = [NSDictionary dictionaryWithObjectsAndKeys:name, @"name", language, @"language", nil];

    //convert object to data
    NSData* jsonData = [NSJSONSerialization dataWithJSONObject:newDatasetInfo options:kNilOptions error:&error];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:someURLSetBefore];
    [request setHTTPMethod:@"POST"];
    // any other things to set in request? or working this way?

    [[NSURLConnection alloc] initWithRequest:request delegate:self];
    // What to do with NSURLConnection? Or how to send differently? 
```

但我真的不知道如何**使用 POST 方法将 JSON 对象发送到服务器**。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-11T16:37:56.897

I worked it out by trying a bit around, here's my code:

```
 //build an info object and convert to json
    NSDictionary *newDatasetInfo = [NSDictionary dictionaryWithObjectsAndKeys:name, @"name", language, @"language", nil];

    //convert object to data
    NSData* jsonData = [NSJSONSerialization dataWithJSONObject:newDatasetInfo options:kNilOptions error:&error];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:someURLSetBefore];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
    [request setHTTPBody:jsonData];

    // print json:
    NSLog(@"JSON summary: %@", [[NSString alloc] initWithData:jsonData
                                                     encoding:NSUTF8StringEncoding]);
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    [connection start]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-08T07:47:13.470

```
- (IBAction)txtFetchData2:(id)sender {
NSString *queryString = [NSString stringWithFormat:@"http://example.com/username.php?name=%@", [self.txtName text]];
NSMutableURLRequest *theRequest=[NSMutableURLRequest
                          requestWithURL:[NSURL URLWithString:
                                          queryString]
                          cachePolicy:NSURLRequestUseProtocolCachePolicy
                          timeoutInterval:60.0];
NSDictionary* jsonDictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                                @"Value1", @"Key1",
                                @"Value2", @"Key2",
                                nil];
NSError *error;
NSData* jsonData = [NSJSONSerialization dataWithJSONObject:jsonDictionary
                       options:NSJSONWritingPrettyPrinted error:&error];
[theRequest setHTTPMethod:@"POST"];
[theRequest addValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
// should check for and handle errors here but we aren't
[theRequest setHTTPBody:jsonData];
[NSURLConnection sendAsynchronousRequest:theRequest queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
    if (error) {
        //do something with error
    } else {
        NSString *responseText = [[NSString alloc] initWithData:data encoding: NSASCIIStringEncoding];
        NSLog(@"Response: %@", responseText);

        NSString *newLineStr = @"\n";
        responseText = [responseText stringByReplacingOccurrencesOfString:@"<br />" withString:newLineStr];            
        [self.lblData setText:responseText];
    }
}];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-22T09:19:21.363

NSString *strUrl = @"URL"; NSURL *url = [NSURL URLWithString:strUrl];

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:60.0];

// For set postdata in string
NSString *strPatientID = [NSString stringWithFormat:@"%@%@%@%@",self.txtDegit1.text,self.txtDegit2.text,self.txtDegit3.text,self.txtDegit4.text];
NSString *deviceToken = @"";
postString = [NSString stringWithFormat:@"practiceid=%@&email=%@&password=%@&devicetoken=%@",strPatientID,self.txtUsername.text,self.txtPassword.text,deviceToken];

NSMutableData *httpDataBody = [NSMutableData data];
[httpDataBody appendData:[postString dataUsingEncoding:NSUTF8StringEncoding]];

NSString *strPostLength = [NSString stringWithFormat:@"%lu",[httpDataBody length]];

if ([httpDataBody length ] > 0){

    [request addValue:@"application/x-www-form-urlencoded charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPMethod:@"POST"];
    [request addValue:strPostLength forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:httpDataBody];

}

urlConnection = [[NSURLConnection alloc]initWithRequest:request delegate:self];
[urlConnection start]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-30T14:52:53.160

```
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:[NSString stringWithFormat:@"http://webstar52.com/demo/webcommunity/work.php"]]];
    NSString *post = [NSString stringWithFormat:@"&tag=%@&user_id=%@",@"getcontact",@"10408"]; 
    NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
    NSString *postLength = [NSString stringWithFormat:@"%d",[postData length]];
    [request setHTTPMethod:@"POST"];      
    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Current-Type"];
    [request setHTTPBody:postData];
  conn  = [[NSURLConnection alloc]initWithRequest:request delegate:self]; 
```

# grails - Grails具有belongsTo和默认值的多个域类

> ID：11434979
> 
> 赞同：0
> 
> 时间：2012-07-11T14:32:59.143
> 
> 标签：grails, grails-orm, grails-domain-class, grails-2.0

我有域类结构的特殊情况，其中三个类存在并且它们连接到链：事件 <- 房间 <- 投影仪。（所有关系都是一对一的）

实现看起来像：

```
class Event {
    Room room
    static constraints = {
        room(nullable:false)
    }
}
class Room {
    Projector projector = new Projector()
    static belongsTo = [event: Event]
    static constraints = {
        projector(nullable:false)
    }
}
class Projector {
    String something = "Something"
    static belongsTo = [room: Room]
    static constraints = {
        room(nullable:false)
    }
} 
```

当我想用新房间创建事件时，我希望默认情况下会创建投影仪：

```
class TestController {
    def index() {
        Room room = new Room()
        Event event = new Event(room: room)
        event.save(flush: true, failOnError: true)
        render event
    }
} 
```

我收到以下异常

```
| Error 2012-07-11 16:09:12,541 [http-bio-8080-exec-3] ERROR errors.GrailsExceptionResolver  - TransientObjectException occurred when processing request: [GET] /Test/room/index
object references an unsaved transient instance - save the transient instance before flushing: Projector. Stacktrace follows:
Message: object references an unsaved transient instance - save the transient instance before flushing: Projector
    Line | Method
->>   46 | onApplicationEvent in org.grails.datastore.mapping.engine.event.AbstractPersistenceEventListener
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|     18 | index              in RoomController
|   1110 | runWorker . . . .  in java.util.concurrent.ThreadPoolExecutor
|    603 | run                in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . . . . .  in java.lang.Thread 
```

似乎级联三个类并没有保存默认值。有什么解决办法吗？或者我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:45:59.133

[在http://jira.grails.org/browse/GRAILS-4613?attachmentOrder=desc](http://jira.grails.org/browse/GRAILS-4613?attachmentOrder=desc)有一个针对您的问题的开放 jira

就我个人而言，我会在我的控制器中处理对象的创建，而不是在域中进行。您需要能够调用projector.save(flush:true)。

# objective-c - iOS/Objective-C 的动画/过渡创建器？

> ID：11434983
> 
> 赞同：1
> 
> 时间：2012-07-11T14:33:16.990
> 
> 标签：objective-c, ios, animation, transition

我想与插画家一起创建一些带有大量动画/过渡（移动精灵）的屏幕。我需要插画师来做动画。他知道如何使用 AfterEffects，所以最好使用某种时间线工具来创建过渡/缩放/alpha 等。

我现在的问题是：是否有某种工具可用于创建动画，然后将使用的参数导出到 Objective-c 以将其导入到 xcode？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:58:01.647

据我所知：没有。

几个月前，我们花了一些时间试图找到类似于 Expression blend 的东西，仅适用于 iOS，但没有运气。

但是，如果您打算为 MacOS 而不是 iOS 制作您的应用程序，您可以查看[石英作曲家](http://en.wikipedia.org/wiki/Quartz_Composer)。对于 iOS，你也可以看看 storyboard（[这里](http://www.scott-sherwood.com/?p=219)有一个相当不错的教程的链接），但我担心 storyboard 的功能无法满足你的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:40:48.050

我找到[了 Flash2Cocos2D](https://github.com/TheDamArmada/Flash2Cocos2D)，我认为这是目前最好的解决方案。还有希望：[cocosbuilder](http://cocosbuilder.com/)！

# c# - 在 NUnit 参数化测试中找不到合适的构造函数

> ID：11434984
> 
> 赞同：11
> 
> 时间：2012-07-11T14:33:16.933
> 
> 标签：c#, unit-testing, nunit

请参阅以下测试夹具：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;

/// <summary>
/// Tests relating to Harry Potter
/// </summary>
[TestFixture("Dumbledore")]
public class HarryPotterTests
{
    public string Name;

    public HarryPotterTests(string personName)
    {
        Name = personName;  
    }

    [Test]
    public void Test()
    {
        Console.WriteLine(Name);
    }
} 
```

我想要实现的是看看参数化测试夹具是如何工作的。我以前没有使用过它们，所以这是我第一次尝试它。

我觉得没问题。带有字符串的构造函数，并在实际测试夹具属性中传入字符串。它编译。测试只是将它写到控制台窗口。

但是，测试失败并显示以下消息：

```
No suitable constructor was found 
```

我是否遗漏了一些显而易见的东西？

无论我在哪里放置断点，都没有命中，所以它很早就失败了。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-11-06T11:44:13.323

我有这个问题。它是由构造函数引发错误引起的，而不是构造函数参数的任何问题。在我的情况下，错误消息具有误导性。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-09-14T10:47:32.537

我遇到了这个问题——在 NUnit 下**并**通过 Resharper 8 运行测试类。

*但是，如果我从此*表单更改了 TestFixture 声明

```
[TestFixture("CategoryName")] 
```

*到*这个表格：

```
[TestFixture(Category="CategoryName")] 
```

然后他们工作了......这也通过 NUnit 改进了一些事情 - 但在我的特定测试中，我遇到了 Resharper 帮助解决的 connectionString 和实体框架问题，而 NUnit 没有 - 但基本上我相信 NUnit 对后一种语法更满意。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-12T08:23:14.590

您的测试类完全有效，并在运行 NUnit 2.6 和 .NET 4 时返回*Passed ，两者都使用 NUnit GUI 和 Resharper 7 测试运行器。*

`TestFixture`当构造函数中的参数类型与测试类构造函数的类型不匹配时，就会出现您看到的错误。例如，如果我添加以下行：

```
[TestFixture(10)] 
```

我将在 NUnit GUI 中收到以下错误：

```
ParameterizedNunit.HarryPotterTests(10).Test:
ParameterizedNunit.HarryPotterTests does not have a suitable constructor 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-17T09:08:29.867

这个特殊问题是 JustCode 的 NUnit Test Runner 中的一个错误。使用 Resharper 7 的 NUnit Runner 和 NUnit GUI 重新运行它，都通过了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-30T08:33:31.277

检查您的构造函数是否有任何可能失败的逻辑。事实证明，我在 Constructor 中有一个调用（糟糕！），它应该在`TestFixtureSetUp`. 在 Resharper 中，如果有任何东西在构造函数中引发异常，这是带有参数化测试装置的默认错误消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-01T16:50:20.053

相当明显，但如果测试的构造函数不是公开的，也可能发生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-01T16:57:23.847

以防万一它帮助别人。在我的例子中，我使用了 TestFixtureSource，以及一个为不同的 TestFixture 构建组合的函数。原来数组中的元素数量与构造函数的参数数量不匹配。（我忘了-1）

# multithreading - 多线程应用程序建模

> ID：11434986
> 
> 赞同：1
> 
> 时间：2012-07-11T14:33:19.173
> 
> 标签：multithreading, uml

任何人都可以推荐任何用于建模多线程应用程序的方法/软件吗？

作为任何应用程序设计的一部分，总是需要使用 UML 进行建模。然而，在初始建模中通常假定单线程设计。我不知道如何为多线程应用程序建模。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:51:40.770

多线程应用程序最好使用活动图的状态机在 UML 中建模。

状态机具有具有“正交”区域的复合状态，这些区域具有并行活动、并行执行并且可以并行响应事件的状态。

活动图具有在活动内创建并行执行流的分叉和连接节点。

这些图表中的每一个都有优点和缺点。如果您的系统是反应式的，我肯定会选择状态机。如果您正在开发更多的信息系统，活动图会更好。

# c# - 在 Excel 2007 中，如何使用 C# 访问工作簿连接的命令文本属性？

> ID：11434989
> 
> 赞同：0
> 
> 时间：2012-07-11T14:33:27.193
> 
> 标签：c#, stored-procedures, excel-2007, openxml, excel-interop

该属性位于数据选项卡 > 连接 > 属性 > 定义选项卡上

我正在处理的系统中的电子表格每天使用工作簿连接刷新，这些连接从命令文本执行存储过程。我希望能够从这些现有的电子表格中获取此属性并创建当前正在使用的所有存储过程的列表。

我已经做了很多搜索，但我没有找到任何东西。我研究过的可能 API 是 DocumentFormat.OpenXml.Spreadsheet 和 Microsoft.Office.Interop.Excel。

基本伪代码：-打开电子表格-对于每个工作簿连接-将命令文本属性添加到列表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:43:09.860

我想您可能正在寻找工作簿连接。非常粗略：

```
Workbook workBook = _excelApp.Workbooks.Open(thisFileName);

for (int itm = 1; itm < workBook.Connections.Count + 1; itm++) {

    Console.WriteLine(workBook.Connections[itm].Type + "\n" +
        workBook.Connections[itm].OLEDBConnection.CommandText + "\n" +
        workBook.Connections[itm].OLEDBConnection.CommandType + "\n" +
        workBook.Connections[itm].OLEDBConnection.Connection + "\n" +
        workBook.Connections[itm].OLEDBConnection.SourceDataFile);
    Console.Read();
} 
```

# java - 摆动方法错误

> ID：11434990
> 
> 赞同：2
> 
> 时间：2012-07-11T14:33:32.767
> 
> 标签：java, swing, awt, jpanel, gridbaglayout

我有问题。我正在从套接字读取数据，当我向我的应用程序读取一些有意义的数据时，我会调用一个方法来用我想要的摆动对象重新绘制屏幕。这种方法可以正常工作，只是有时它不会出现。第一次调用该方法时屏幕上没有任何内容（我已经运行了调试并且它通过了该方法）。愚蠢的部分是，如果我最小化和最大化应用程序，它会再次正常工作。此外，如果再次执行该方法，它可以正常工作。我将代码放在这里只是为了文档：

```
public void GraphicONENodeJoined (Nodes NodesList)
 {
     SensorsMapGraf [] sensorsMap;
     boolean FLAG;
     int ymin=0, ymax=30;
     FLAG = TabExistingNode_NEW_nodeRefresh (NodesList);
     if (FLAG)
     {
         ValorTeste++;
         if (ValorTeste > 1)
         {
             String [] s = new String[ValorTeste];
             JButton [] jbb = new JButton[ValorTeste];
             JCheckBox [] ch = new JCheckBox[ValorTeste];
             for (int i=0 ; i < ValorTeste-1 ; i++)
             {
                 s[i] =  nods[i];
                 jbb[i] = jb[i];
                 ch[i] = CheckBoxNodes[i];      
             }
             jb = new JButton[ValorTeste];
             CheckBoxNodes = new JCheckBox[ValorTeste];
             nods =  new String[ValorTeste];

             for (int i=0 ; i < ValorTeste ; i++)
             {
                 nods[i] = s[i];
                 jb[i] = jbb[i];

                 CheckBoxNodes[i] = ch[i];
             }       
         }

            nods[ValorTeste-1]+= NodesList.GETSourceNodeID();
            //PARA FAZER O UPDATE DAS TABS E DOS GRÁFICOS
            JPanel meio = new JPanel();         //JPanel que contem os graficos de cada sensor

            String s = new String();
            s += NodesList.GETSourceNodeID();

            JPanel meio_cima = new JPanel();    //JPanel que contem  o botão view (permitirá escolher quais os sensores a ver)
            meio_cima.setAlignmentX(LEFT_ALIGNMENT);
            meio_cima.setPreferredSize(new Dimension(dim.width, 25));
            meio.setBounds (pan1.getBounds());
            GridBagLayout g = new GridBagLayout();
            GridBagConstraints c = new GridBagConstraints();

            meio.setLayout(g);
            meio.setOpaque(true);
            //botão view (permitirá escolher quais os sensores a ver)
            jb[nods.length-1] = new JButton("View");
            jb[nods.length-1].setPreferredSize(new Dimension(100,20));
            jb[ValorTeste -1].addActionListener(this);
            meio_cima.add(jb[ValorTeste-1]);
            //Panel qu albergará o panel meio e o panel meio_cima
            JPanel principal = new JPanel();
            //inicia o array de sensores que cada Tab tem de mostrar
            sensorsMap = new SensorsMapGraf[NodesList.GETnumSensoresActivos()];

            int indice = 0;
            for (int j=0 ; j < 12 ; j++)
            { 
                //nicely to view in the graphics
                if ((j == 0) || (j == 1) || (j == 2) || (j == 3) || (j == 6) || (j == 7))
                {
                    ymin = 0;
                    ymax = 3;
                }
                if (j == 8)
                {
                    ymin = 0;
                    ymax = 100;
                }
                if (j == 9)
                {
                    ymin = 0;
                    ymax = 100;
                }
                if (j == 10)
                {
                    ymin = 0;
                    ymax = 4;
                }
                if (j == 11)
                {
                    ymin = 0;
                    ymax = 130;
                }
                if (j == 4 )
                {
                    ymin = 0;
                    ymax = 6000;
                }
                if (j == 5)
                {
                    ymin = 0;
                    ymax =700;
                }

                if (NodesList.GETSensores(j).GETligado()) // se estiver ligado
                {
                    //panel que albergará o grafico 
                    JPanel p = new JPanel();
                    p.setBounds(meio.getBounds());

                    if (NodesList.GETnumSensoresActivos() <= 4)
                    {
                        if (NodesList.GETnumSensoresActivos() <= 4  && NodesList.GETnumSensoresActivos() > 1)
                            sensorsMap[indice] = new SensorsMapGraf(true,NodesList.GETSensores(j).GETnome(),NodesList.GETSensores(j).GETunidade(),meio.getBounds(),(int)meio.getWidth()/2-20,(int)meio.getHeight()/2-20,ymin,ymax); // cria o sensor
                        else
                            sensorsMap[indice] = new SensorsMapGraf(true,NodesList.GETSensores(j).GETnome(),NodesList.GETSensores(j).GETunidade(),meio.getBounds(),(int)meio.getWidth()/NodesList.GETnumSensoresActivos(),(int)meio.getHeight()/NodesList.GETnumSensoresActivos()-35,ymin,ymax); // cria o sensor
                    }

                    if (NodesList.GETnumSensoresActivos() > 4 && NodesList.GETnumSensoresActivos() <= 8)
                        sensorsMap[indice] = new SensorsMapGraf(true,NodesList.GETSensores(j).GETnome(),NodesList.GETSensores(j).GETunidade(),p.getBounds(),(int)meio.getWidth()/4-15,(int)meio.getHeight()/2 - 45,ymin,ymax); // cria o sensor

                    if (NodesList.GETnumSensoresActivos() > 8 && NodesList.GETnumSensoresActivos() <= 12)
                        sensorsMap[indice] = new SensorsMapGraf(true,NodesList.GETSensores(j).GETnome(),NodesList.GETSensores(j).GETunidade(),p.getBounds(),(int)meio.getWidth()/4-20,(int)meio.getHeight()/3-35,ymin,ymax); // cria o sensor

                        if (indice == 0)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 0;
                            c.gridy = 0;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 1)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 1;
                            c.gridy = 0;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 2)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            if (NodesList.GETnumSensoresActivos() <= 4)
                            {
                                c.gridx = 0;
                                c.gridy = 1;
                            }
                            else
                            {
                                c.gridx = 2;
                                c.gridy = 0;
                            }
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 3)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            if (NodesList.GETnumSensoresActivos() > 4)
                            {
                                c.gridx = 3;
                                c.gridy = 0;
                            }
                            else
                            {
                                c.gridx = 1;
                                c.gridy = 1;
                            }
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 4)
                        {

                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 0;
                            c.gridy = 1;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 5)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 1;
                            c.gridy = 1;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 6)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 2;
                            c.gridy = 1;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 7)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 3;
                            c.gridy = 1;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 8)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 0;
                            c.gridy = 2;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 9)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 1;
                            c.gridy = 2;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 10)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 2;
                            c.gridy = 2;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                        if (indice == 11)
                        {
                            c.fill = GridBagConstraints.HORIZONTAL;
                            c.gridx = 3;
                            c.gridy = 2;
                            meio.add(sensorsMap[indice].GetGraph().GETDemoPanel(),c);  //adidionar o panel p ao panel meio
                        }
                    indice++;
                }
            }

            //adicionar o meio_cima e o meio panel principal
            principal.add(meio_cima);
            principal.add(meio);

            Tabs.addTab(s, principal); // adicionar tab
            String ss = new String();
            ss += NodesList.GETSourceNodeID();

            GraphicsMap.add(new CentralMap(ValorTeste-1, ValorTeste-1, sensorsMap,ss,NodesList.GETLogicalNodeID()));  // adição de uma Tab
            GraphicsMap.get(ValorTeste-1).SetnumSensorsToShow(NodesList.GETnumSensoresActivos());

            posx = 20;
            posy = 20;

            CheckBoxNodes[ValorTeste-1] = new JCheckBox(s);
            CheckBoxNodes[ValorTeste-1].setBackground(null);
            CheckBoxNodes[ValorTeste-1].setLayout(new GridLayout(ValorTeste, 1, 0, 30));
            CheckBoxNodes[ValorTeste-1].setBounds(posx, posy, aux1-60, 30);
            CheckBoxNodes[ValorTeste-1].setSelected(false);
            CheckBoxNodes[ValorTeste-1].setOpaque(true);
            CheckBoxNodes[ValorTeste-1].setVisible(true);

            //Evento a tratar
            CheckBoxNodes[ValorTeste-1].addItemListener (this);

            pan3.add (CheckBoxNodes[ValorTeste-1]);
            pan1.add (Tabs);
     }
  } 
```

我已经尝试重新绘制 pan2 但它没有做任何事情。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T14:38:42.460

您发布了许多与问题完全无关的代码，并且代码令人困惑，但听起来好像您可能遇到了 Swing 并发问题。确保在后台线程上读取数据并在 Swing 事件线程或 EDT 上写入 Swing 组件。不过，为了获得更好的帮助，请发布与问题相关的代码。sscce[效果](http://sscce.org)最好。

此外，如果在 GUI 中添加或删除组件，请务必先调用`revalidate()`容器，然后再调用`repaint()`.

# rest - 如何在 TomEE 中编写基于 CXF 的 REST 客户端？

> ID：11434991
> 
> 赞同：2
> 
> 时间：2012-07-11T14:33:33.787
> 
> 标签：rest, cxf, jax-rs, apache-tomee

我想使用我的 REST 客户端，使用 CXF 和 TomEE/TomEE+ 1.0 开发，但是 JAXB JSON 编组/解组（使用 Jackson 库）有一点问题。我尝试了 Jersey Client 1.1.13 和 CXF WebClient（Tomee+ 1.0 中包含的版本），但是，我在部署时遇到了同样的错误：

org.apache.openejb.OpenEJBException：没有提供程序可用于“localhost/mywebapp.Comp”类型“javax.ws.rs.ext.Providers”的资源引用“null”

我还尝试将“jackson-jaxrs-json-provieder-2.0.4.jar”jar 复制到 TomEE lib 目录，但错误是一样的。我还尝试将系统属性“openejb.cxf.jax-rs.providers”设置为“com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider,com.fasterxml.jackson.jaxrs.json.JacksonJaxbJsonProvider”，但没有任何改变。

下面是我使用 CXF 进行 REST 调用的代码示例：

```
final List<Object> providers = new ArrayList<Object>();
providers.add(new JacksonJaxbJsonProvider());
WebClient wc = WebClient.create(url, providers); 
```

无论如何，这段代码从未执行过，因为错误发生在部署时。我的 webapp（使用 Jersey 客户端开发的版本）适用于 Glassfish 3.1.2。

问题出在哪里？

谢谢你，再见，黛米斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:56:22.123

发现并修复了这个错误：

*   [https://issues.apache.org/jira/browse/TOMEE-339](https://issues.apache.org/jira/browse/TOMEE-339)

试试最新的 TomEE[快照](http://tomee.apache.org/builds.html)。

我使用jacskon（是的，需要添加罐子并设置提供程序）并且它可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T09:44:11.653

我找到了一个很好的临时解决方案，可以在 TomEE+ 1.0.0 中使用 CXF REST 客户端和 Jackson JSON 编组。我将这些库从 webapp lib 移动到 TomEE lib 目录：

*   杰克逊注释-2.0.4.jar
*   杰克逊-jaxrs-json-provider-2.0.4.jar
*   jackson-module-jaxb-annotations-2.0.4.jar
*   杰克逊核心2.0.4.jar
*   jackson-databind-2.0.4.jar

这是我拨打休息电话的代码：

```
final ObjectMapper objectMapper = new ObjectMapper();
objectMapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false);
objectMapper.configure(SerializationFeature.WRITE_DATE_KEYS_AS_TIMESTAMPS, false);
objectMapper.configure(SerializationFeature.ORDER_MAP_ENTRIES_BY_KEYS, true);
objectMapper.configure(SerializationFeature.WRITE_NULL_MAP_VALUES, false);
objectMapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, true);  
objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);

final JacksonJaxbJsonProvider provider = new JacksonJaxbJsonProvider(objectMapper, JacksonJaxbJsonProvider.DEFAULT_ANNOTATIONS);
provider.setAnnotationsToUse(JacksonJaxbJsonProvider.DEFAULT_ANNOTATIONS);
provider.setMapper(objectMapper);

final List<Object> providers = new ArrayList<Object>();
providers.add(provider);

WebClient wc = WebClient.create(_request.getUrl(), providers);
wc = wc.type(MediaType.APPLICATION_JSON).accept(MediaType.APPLICATION_JSON);

try {
  res = (ElasticResponse) wc.invoke(_request.getHttpVerb(), _request.getMessage(), _request.getElasticResponseClass());
} catch (final ServerWebApplicationException _e) {
  this._log.log(Level.FINE, "http response code > 400", _e);
} 
```

我希望在 TomEE 的下一个版本中，我不需要将 Jackson 的库添加到容器中，而只需要添加到 webapp。

# android - Android Sensor 转换句柄/类型

> ID：11434992
> 
> 赞同：0
> 
> 时间：2012-07-11T14:33:35.580
> 
> 标签：android, sensors, android-sensors, sensormanager

我在我的应用程序中使用接近传感器，当我注册传感器时，我可以在 LogCat 中看到这一行：

**07-11 17:14:26.049: E/SensorManager(26240): registerListener ::句柄= 4名称= CM3663接近传感器延迟= 10000侦听器= com.sampler.ProximitySampler@408093c8**

现在，我知道并且已验证[TYPE_PROXIMITY](http://developer.android.com/reference/android/hardware/Sensor.html#TYPE_PROXIMITY) = 8。为什么在日志中我得到句柄 = 4 ？

假设这是正常现象，如何从该句柄编号中获取实际的传感器类型？我不能只将此数字转换为传感器类型。即我怎么知道handle=4 表示TYPE_PROXIMITY？

谢谢;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T09:46:24.813

啊啊！

有一个私有方法 android.hardware.Sensor.getHandle() 它返回传感器句柄号，所以我可以制作一个地图类型来处理！

# java - XUL 和 Java 之间的通信

> ID：11434993
> 
> 赞同：2
> 
> 时间：2012-07-11T14:33:37.033
> 
> 标签：java, xul

我想在我的下一个项目中混合使用 Java 和 XUL。

我想在 XUL 中构建 GUI，但我需要某些 Java 库用于业务逻辑。

哪些选项可用于 Java 和 XUL 之间的通信？我已经用谷歌搜索了这个主题，似乎没有明确的最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:01:12.430

没有太多的选择：

*   您可以将不可见的 Java 小程序放入 XUL 文档的某个位置，并通过 JavaScript 与该小程序进行通信。
*   [您可以通过nsIProcess](https://developer.mozilla.org/en/nsIProcess)运行 Java 应用程序并通过[TCP 套接字](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIServerSocket)与其通信。

第一个解决方案似乎更简单，但也更容易出错，正如这里的一些问题所示。

# c# - 如何访问datagridrow wpf C#中的特定单元格

> ID：11434994
> 
> 赞同：0
> 
> 时间：2012-07-11T14:33:38.987
> 
> 标签：c#, wpfdatagrid

我有一个数据网格，我在其中使用 foreach(DataGridRow gvr in myDataGrid)，我需要能够从行中的特定单元格中获取信息并将它们放入各自的类属性中，即（a.MessageName = gvr.column [" MessageName"].value.ToString())。但是我还没有弄清楚如何根据该列获取信息。这是我到目前为止所拥有的...

```
 foreach (DataGridRow gvr in dgAnnouncement.Items)
    {
         Announcement a = new Announcement();

         a.MessageName = gvr.Column["MessageName"].Value.ToString();
         a.Message = gvr.Column["Message"].Value.ToString();
     } 
```

这是我的 XAML ......

```
<DataGrid AutoGenerateColumns="False" Height="631" ItemsSource="{Binding}" HorizontalAlignment="Left" SelectionMode="Single" SelectionUnit="FullRow" Margin="12,124,0,0" Name="dgAnnouncement" VerticalAlignment="Top" Width="976" >
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="MessageName"></DataGridTextColumn>
                        <DataGridTextColumn Header="Message"></DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid> 
```

在网上搜索后，我仍然没有找到适合我的解决方案，因此在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:29:52.737

好的，听起来您想要一个绑定的项目列表，用户可以添加这些项目并在其上填写值

如果你想这样做，最好的方法是通过绑定你的列：

```
<DataGrid AutoGenerateColumns="False" Height="631" ItemsSource="{Binding}" HorizontalAlignment="Left" SelectionMode="Single" SelectionUnit="FullRow" Margin="12,124,0,0" Name="dgAnnouncement" VerticalAlignment="Top" Width="976" > 
    <DataGrid.Columns> 
        <DataGridTextColumn Header="MessageName" Binding="{Binding MessageName, Mode=TwoWay}"></DataGridTextColumn> 
        <DataGridTextColumn Header="Message" Binding="{Binding Message, Mode=TwoWay}"></DataGridTextColumn> 
    </DataGrid.Columns> 
</DataGrid> 
```

问题是 - 您目前将 ItemsSource 设置为什么？

理想情况下，这应该是一个强类型的`Appointment`对象集合（`ObservableCollection<Appointment>`也许）。您希望用户能够添加新行吗？如果是这样，您需要提供一个`Add`在源集合上执行的按钮，或者让数据网格执行它（我认为它支持一个“空行”，您可以在其中键入值......虽然我通常使用 Telerik 的 RadGridView）。通常，当您的网格有一个空行供用户添加新值时，网格将查看绑定的基础集合并调用适当的方法来添加项目。如果此集合不支持某个`Add`方法（例如 IBindingList 支持），我认为默认是使用该类型的无参数构造函数创建一个新项目（对此不太确定，可能值得一读）

基本上，通过绑定这些属性`TwoWay`意味着用户可以直接在网格中编辑列表中的每个项目。如果用户更改某个属性，则基础对象上的该属性将受到影响*。这意味着您不需要编写任何代码来连接这一切。绑定也可以从 control->control 完成，例如，您可以将另一个网格绑定`ItemsSource`到第一个网格上的`SelectedItems`属性，它会自动更新您选择的项目。

在此处查看我的答案以获取有关 DataBinding 的更多信息

[数据绑定如何工作？](https://stackoverflow.com/questions/11392971/how-does-data-binding-work/11393609#11393609)

编辑：

*   我可能会补充一点，对底层对象的任何更改而不通过网格仍将显示在网格中，但前提是对象实现了属性更改通知机制，例如`INotifyPropertyChanged`（在 System.ComponentModel 命名空间中）

# c# - 使用 sqltransaction 插入表时选择数据

> ID：11434997
> 
> 赞同：0
> 
> 时间：2012-07-11T14:33:54.707
> 
> 标签：c#, sql-server

我需要从表中选择数据。我的问题是：我使用 sqltransactions 在表中插入一行。一旦执行插入，这将锁定表。然后我需要从此表中选择数据以进行进一步的执行，但我无法做到。我也尝试使用 nolock 但没有帮助。

我的代码是这样的

```
Database.myConnection = new SqlConnection(Database.SQLConnectionString);
Database.myConnection.Open();

Database.myTrans =  Database.myConnection.BeginTransaction(System.Data.IsolationLevel.ReadUncommitted, "SampleTransaction");
// Must assign both transaction object and connection
// to Command object for a pending local transaction
Database.myCommand = Database.myConnection.CreateCommand();
Database.myCommand.Connection = Database.myConnection;
Database.myCommand.Transaction = Database.myTrans;
Database.ExecuteSqlNonQuery("INSERT INTO customer(CustomerNo,CustomerName)VALUES('121','asd')"); 
```

现在我尝试从客户表中选择，但它陷入僵局..我也尝试使用 nolock 进行选择，但没有结果..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T16:10:21.830

为 UPDATE 和 SELECT 重用连接对象。

执行多个更新时，只需传递方法之间的连接。确保使用 USING 语句包装

```
using (SqlConnection Conn = new SqlConnection(...))
{
    Method1(conn);
    Method2(conn);
} 
```