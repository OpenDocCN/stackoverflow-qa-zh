# StackOverflow 问答 000252000-000252999

# unmanaged - 托管/字节代码和非托管/本机代码有什么区别？

> ID：252014
> 
> 赞同：3
> 
> 时间：2008-10-30T22:39:03.933
> 
> 标签：unmanaged, bytecode, managed

有时很难描述一些“我们程序员”可能认为对非程序员和管理类型来说很简单的事情。

所以...

您如何向非程序员描述托管代码（或 Java 字节代码）和非托管/本机代码之间的区别？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-30T22:48:34.990

托管代码 == “拥有全体员工或管家、女佣、厨师和园丁的豪宅，以保持这个地方的美好”

非托管代码 == “我以前住在大学的地方”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T22:44:59.087

想想你的办公桌，如果你定期清理它，你面前就有空间可以放置你实际正在处理的东西。如果你不清理它，你就会用完空间。

该空间相当于 RAM、硬盘等计算机资源。

托管代码允许系统自动选择清理的时间和内容。非托管代码使该过程“手动” - 因为程序员需要告诉系统何时以及清理什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-30T22:47:00.593

我很确定基本解释是：

*   **Managed** = 由运行时管理的资源清理（即垃圾收集）
*   **Unmanaged** = 自己清理（即`malloc`& `free`）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-19T14:23:57.287

我对这次讨论的结果感到惊讶（嗯，不是真的，而是修辞上的）。让我补充一点，即使我迟到了。

虚拟机 (VM) 和垃圾收集 (GC)**已有数十年历史**，是**两个独立的概念**。存在垃圾收集的本机代码编译语言，即使是几十年前的这些（规范示例：[ANSI Common Lisp](http://en.wikipedia.org/wiki/Common_Lisp)；嗯，至少有一种[**编译时**垃圾收集](http://www.cs.mu.oz.au/research/mercury/information/papers.html#mazur-thesis)声明性语言 Mercury - 但显然大众对类似 Prolog 的语言大喊大叫）。

突然之间，基于 GC 的基于字节码的 VM 成为了所有 IT 疾病的灵丹妙药。[现有二进制文件的沙盒](http://www.sandboxie.com/)（其他示例[在这里](http://pdos.csail.mit.edu/papers/vx32:usenix08/)，[这里](http://www.ecsl.cs.sunysb.edu/bird/)和[这里](http://code.google.com/p/nativeclient/)）？[最小权限原则 (POLA)](http://en.wikipedia.org/wiki/Principle_of_least_authority) /[基于能力的安全](http://www.erights.org/)? [苗条的二进制文件](http://docs.google.com/gview?a=v&q=cache:WgXzRpdXtusJ:www.oberon2005.ru/paper/mf1997-01e.pdf)（或其现代变体[SafeTSA](http://en.wikipedia.org/wiki/SafeTSA)）？[区域推断](http://en.wikipedia.org/wiki/Region_inference)? 不，先生：Microsoft 和 Sun 并没有授权我们甚至只考虑这种变态。不，最好为这种美妙的（？？？）新（？？？）语言§/API重写我们的整个软件堆栈。正如我们的一位主持人所说，这又是**[火与动](http://www.joelonsoftware.com/articles/fog0000000339.html)**。

§ 别傻了：我知道 C# 不是唯一针对 .Net/Mono 的语言，它是一种[夸张](http://en.wikipedia.org/wiki/Hyperbole)的语言。

**编辑：**根据我指出的内存管理/安全/代码移动性的替代技术，查看 S.Lott[对这个答案](https://stackoverflow.com/questions/252014/how-would-you-describe-the-difference-between-managed-byte-code-and-unmanaged-nat/252026#252026)的评论特别有启发性。

**我的观点是，非技术人员不需要在这个细节级别上为技术问题而烦恼。**

另一方面，如果他们对 Microsoft/Sun 的营销印象深刻，则有必要向他们解释他们被愚弄了——基于 GC 字节码的 VM 并不像他们声称的那样新颖，它们并不能神奇地解决所有 IT 问题，而且存在这些实现技术的替代品（有些更好）。

**编辑 2：**垃圾收集是一种内存管理技术，作为每一种实现技术，都需要理解才能正确使用。看看在 ITA Software，[他们如何绕过 GC 来获得良好的性能](http://www.paulgraham.com/carl.html)：

> **4 - 因为我们有大约 2 gigs**需要快速访问的静态数据，我们使用 C++ 代码对包含无指针C 结构（航班、票价等）的大文件进行内存映射，然后使用外部数据从 Common Lisp 访问这些文件访问。一个结构域访问编译成两个或三个指令，所以实际上并没有任何性能。访问 C 而不是 Lisp 对象的惩罚。通过这样做，**我们可以防止 Lisp 垃圾收集器看到数据**（对于 Lisp，每个指向 C 对象的指针只是一个固定编号，尽管我们经常将这些指针临时包装在 Lisp 对象中以提高可调试性）。因此，我们的 Lisp 图像只有大约 250 兆的“工作”数据结构和代码。
> 
> ...
> 
> 9 - 我们可以在 800mhz 的机器上进行 10 秒的 Lisp 计算，并且使用少于 5k 的数据。这是因为我们预先分配了我们需要的所有数据结构，并在超过它们的查询上死掉。这可能会让许多 Lisp 程序员感到畏缩，但是由于 250 兆图像和实时限制，**我们不能产生垃圾**。例如，我们不使用 cons，而是使用“cons！”，它从我们预先分配的 10,000,000 个单元格的数组中抓取单元格，并且每次查询都会重置。

**编辑3：（**避免误解）GC比直接摆弄指针更好吗？大多数时候，当然，但**两者**都有替代方案。有必要用这些细节来打扰**用户吗？**除了在必要时消除一些营销炒作之外，我没有看到任何证据表明情况确实如此。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-30T22:50:00.137

也许将其与投资股票市场进行比较。

您可以自己买卖股票，努力成为能够提供最佳风险/回报的专家 - 或者您可以投资由“专家”管理的基金，该“专家”将为您做这件事 - 以您为代价失去一些控制权，可能还有一些佣金。（诚​​然，我更喜欢追踪基金，而股市“专家”最近表现并不出色，但是……）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-30T23:22:40.337

这是我的答案：

托管 (.NET) 或字节码 (Java) 将为您节省时间和金钱。

现在让我们比较一下两者：

**非托管或本机代码**

您需要自己进行资源（RAM / 内存）分配和清理。如果您忘记了某些内容，最终会导致可能导致计算机崩溃的所谓“内存泄漏”。内存泄漏是指应用程序开始用尽（消耗）内存/内存但不放手，以便计算机可以将其用于其他应用程序的术语；最终这会导致计算机崩溃。

为了在不同的操作系统（Mac OSX、Windows 等）上运行您的应用程序，您需要专门为每个操作系统编译代码，并可能更改很多特定于操作系统的代码，以便它可以在每个操作系统上运行。

**.NET 托管代码或 Java 字节码**

所有资源（RAM / 内存）分配和清理都为您完成，并且将创建“内存泄漏”的风险降至最低。这允许有更多的时间来编写功能，而不是花在资源管理上。

为了在不同的操作系统（Mac OSX、Windows 等）上运行您的应用程序，您只需编译一次，只要它们支持您的应用程序在（.NET Framework 之上）运行的给定框架，它就会在每个操作系统上运行/[单声道](http://mono-project.com)或 Java）。

**简而言之**

使用 .NET Framework（托管代码）或 Java（字节码）进行开发，总体上可以更便宜地构建可以轻松针对多个操作系统的应用程序，并允许将更多时间花在构建丰富的功能上，而不是用于内存的平凡任务/资源管理。

另外，在有人指出 .NET Framework 不支持多种操作系统之前，我需要指出技术上的 Windows 98、WinXP 32 位、WinXP 64 位、WinVista 32 位、WinVista 64 位和 Windows服务器都是不同的操作系统，但相同的 .NET 应用程序将在每个操作系统上运行。而且，还有将 .NET 引入 Linux 和 Mac OSX 的[Mono 项目](http://mono-project.com)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T00:00:41.040

非托管代码是计算机要遵循的指令列表。托管代码是计算机的任务列表，计算机可以自行解释如何完成这些任务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T00:02:58.210

最大的区别是内存管理。使用本机代码，您必须自己管理内存。这可能很困难，并且是导致大量错误和花费大量开发时间来追踪这些错误的原因。使用托管代码，您仍然会遇到问题，但问题要少得多，而且更容易追踪。这通常意味着更少的错误软件和更少的开发时间。

还有其他区别，但内存管理可能是最大的。

如果他们仍然感兴趣，我可能会提到有多少漏洞来自缓冲区溢出，而托管代码无法做到这一点，或者代码重用现在很容易，或者我们不再需要处理 COM（如果你'无论如何都很幸运）。我可能会远离 COM，否则我会开始长篇大论说它有多糟糕。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T01:30:29.923

这就像在边缘有和没有保险杠的打台球之间的区别。除非你和所有其他球员总是能投出完美的球，否则你需要一些东西来保持球在桌面上。（忽略故意弹跳...）

或者使用有墙而不是边线和端线的足球，或者没有后援的棒球，或者没有球门后网的曲棍球，或者没有障碍的NASCAR，或者没有头盔的足球......）

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2008-10-30T22:43:14.610

“托管代码这一特定术语在 Microsoft 世界中尤为普遍。”

因为我在 MacOS 和 Linux 世界工作，所以这不是我使用或遇到的术语。

Brad Abrams “[什么是托管代码](http://blogs.msdn.com/brada/archive/2004/01/09/48925.aspx)”博客文章有一个定义，其中包含“.NET Framework 公共语言运行时”之类的内容。

我的观点是：用这些术语来解释它可能根本不合适。如果它是一个错误、hack 或变通方法，它不是很重要。当然不够重要，不足以进行复杂的外行描述。它可能会随着下一批 MS 产品的发布而消失。

# java - javax.jms 不存在 - 编译 activemq 示例

> ID：252016
> 
> 赞同：4
> 
> 时间：2008-10-30T22:40:17.440
> 
> 标签：java, netbeans, jms, activemq

我正在尝试编译 activemq 附带的示例

在 apache-activemq-5.1.0\example\src\

TopicPublisher.java、CommandLineSupport.java

在通过 netbeans 编译时，它有一些引用问题，说 javax.jms 不存在。

我已经尝试过 j2ee.jar、openjms、sun jms，但它们都给出了相同的错误。

它还抱怨 org.apache.activemq.util 不存在，但我引用的是 activemq-all-5.1.0.jar。

注意：对外部 jar 的所有其他引用都可以正常工作

有任何想法吗？

**编辑**：需要引用的罐子是

```
activemq-core-5.1.0.jar
geronimo-jms_1.1_spec-1.1.1.jar
commons-logging-1.1.jar
geronimo-j2ee-management_1.0_spec-1.0.jar 
```

它们在 lib 文件夹中的 activemq 二进制文件中

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T09:06:47.910

在 lib 目录中是编译所需的 jars。JMS API 位于*lib/geronimo-jms-1.1.jar*中。

顺便说一句，您如何尝试构建它们？您使用那里的 Ant 构建？请参阅[有关构建它们的文档](http://activemq.apache.org/examples.html)。

# c++ - 什么可以修改帧指针？

> ID：252028
> 
> 赞同：4
> 
> 时间：2008-10-30T22:44:12.037
> 
> 标签：c++, callstack, corruption

我现在在一个相当庞大的 C++ 应用程序中出现了一个非常奇怪的错误（在 CPU 和 RAM 使用以及代码长度方面非常大 - 超过 100,000 行）。这是在双核 Sun Solaris 10 机器上运行的。该程序订阅股票价格馈送并将它们显示在用户配置的“页面”上（页面是用户自定义的窗口结构 - 该程序允许用户配置此类页面）。在其中一个底层库变为多线程之前，该程序一直可以正常工作。受此影响的程序部分已相应更改。关于我的问题。

大约在每三次执行中，程序将在启动时出现段错误。这不一定是硬性规则——有时它会连续崩溃 3 次，然后连续工作 5 次。有趣的是段错误（阅读：痛苦）。它可能以多种方式表现出来，但最常见的情况是函数 A 调用函数 B，进入函数 B 时，帧指针会突然设置为 0x000002。功能一：

```
 result_type emit(typename type_trait<T_arg1>::take _A_a1) const
     { return emitter_type::emit(impl_, _A_a1); } 
```

这是一个简单的信号实现。impl_ 和 _A_a1 在崩溃时的框架内定义良好。在实际执行该指令时，我们最终到达程序计数器 0x000002。

这并不总是发生在该功能上。事实上，它发生在很多地方，但这是最简单的情况之一，不会留下太大的错误空间。有时会发生的情况是堆栈分配的变量会突然无缘无故地坐在垃圾内存上（总是在 0x000002 上）。其他时候，相同的代码会运行得很好。所以，我的问题是，什么可以如此严重地破坏堆栈？什么实际上可以改变帧指针的值？我当然从来没有听说过这样的事情。我能想到的唯一一件事就是在数组上越界写入，但我已经使用堆栈保护器构建了它，它应该会出现这种情况的任何实例。我在这里的堆栈范围内也很好。我也不 看不到另一个线程如何覆盖第一个线程的堆栈上的变量，因为每个线程都有自己的堆栈（这都是 pthreads）。我已经尝试在 linux 机器上构建它，虽然我没有在那里遇到段错误，但大约有三分之一的时间它会冻结在我身上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-30T23:36:39.730

堆栈损坏，绝对是 99.9%。

您应该仔细寻找的气味是：-

*   使用“C”数组
*   使用“C”strcpy 风格的函数
*   内存
*   malloc 和免费
*   使用指针的任何东西的线程安全
*   未初始化的 POD 变量。
*   指针算术
*   试图通过引用返回局部变量的函数

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-30T23:02:31.250

我今天遇到了这个确切的问题，并且在泥泞中深陷`gdb`泥潭并连续调试了一个小时，然后我才想到我只是在 C 数组的数组边界（我没想到它的地方）上写了。

因此，如果可能，请使用`vector`s 代替，因为如果您在调试模式下尝试，任何 decend STL 实现都会提供良好的编译器消息（而 C 数组会用段错误惩罚您）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T17:16:21.913

***堆栈溢出***和***堆栈损坏***之间存在一些混淆。

 ***堆栈溢出**是一个非常具体的问题，原因是尝试使用比操作系统分配给您的线程更多的堆栈。三个正常的原因是这样的。

```
void foo()
{
  foo();  // endless recursion - whoops!
}

void foo2()
{
  char myBuffer[A_VERY_BIG_NUMBER];  // The stack can't hold that much.
}

class bigObj
{
  char myBuffer[A_VERY_BIG_NUMBER];  
}

void foo2( bigObj big1)  // pass by value of a big object - whoops!
{
} 
```

在嵌入式系统中，线程堆栈的大小可能以字节为单位，即使是简单的调用序列也可能导致问题。默认情况下，在 Windows 上，每个线程获得 1 Meg 的堆栈，因此导致堆栈溢出的常见问题要少得多。除非您有无限递归，否则总是可以通过增加堆栈大小来缓解堆栈溢出，即使这通常不是最佳答案。

**堆栈损坏**只是意味着在当前堆栈帧的边界之外写入，因此可能会损坏其他数据 - 或堆栈上的返回地址。

最简单的：-

```
void foo()
{ 
  char message[10];

  message[10] = '!';  // whoops! beyond end of array
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-30T23:09:10.283

正如您所说，我不确定您所说的“帧指针”是什么：

> 在实际执行该指令时，我们最终到达程序计数器 0x000002

这听起来像是返回地址被破坏了。帧指针是指向当前函数调用上下文的堆栈位置的指针。它很可能指向返回地址（这是一个实现细节），但帧指针本身并不是返回地址。

我认为这里没有足够的信息来真正给你一个好的答案，但一些可能是罪魁祸首的事情是：

*   不正确的调用约定。如果您使用与函数编译方式不同的调用约定来调用函数，则堆栈可能会损坏。

*   内存命中。通过错误指针写入的任何内容都可能导致垃圾最终进入堆栈。我不熟悉 Solaris，但大多数线程实现都将线程放在同一个进程地址空间中，因此任何线程都可以访问任何其他线程的堆栈。一个线程可以获得指向另一个线程堆栈的指针的一种方法是，如果将局部变量的地址传递给最终处理不同线程上的指针的 API。除非您正确同步事物，否则最终会导致指针访问无效数据。鉴于您正在处理“简单的信号实现”，似乎一个线程可能正在向另一个线程发送信号。也许该信号中的一个参数有一个指向本地的指针？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T01:30:50.203

破坏帧指针并不难——如果你查看例程的反汇编，你会发现它在例程开始时被压入并在结束时被拉出——所以如果有任何东西覆盖堆栈，它可能会丢失。堆栈指针是堆栈当前所在的位置 - 帧指针是它开始的位置（对于当前例程）。

首先，我将验证所有库和相关对象都已重建干净并且所有编译器选项都是一致的 - 我之前遇到过类似的问题（Solaris 2.5），这是由尚未重建的目标文件引起的.

这听起来完全像一个覆盖 - 如果它只是一个错误的偏移量，那么在内存周围放置保护块将无济于事。

在每次核心转储后，检查核心文件以尽可能多地了解故障之间的相似之处。然后尝试确定被覆盖的内容。我记得帧指针是最后一个堆栈指针 - 所以在当前堆栈帧中不应修改帧指针之前的任何逻辑内容 - 所以可能会记录它并将其复制到其他地方并在返回时进行比较。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-30T22:58:51.867

这听起来像一个堆栈溢出问题 - 一些东西正在超出数组的范围并践踏堆栈上的堆栈帧（也可能是返回地址）。有大量关于这个主题的文献。“The Shell Programmer's Guide”（第 2 版）包含可以帮助您的 SPARC 示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-30T23:38:31.787

使用 C++ 统一变量和竞争条件可能会导致间歇性崩溃。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T00:03:56.820

是否有可能通过 Valgrind 运行这个东西？也许 Sun 提供了类似的工具。Intel VTune（实际上我在考虑线程检查器）也有一些非常好的线程调试工具等。

如果你的雇主愿意为更昂贵的工具付出代价，他们真的可以让这类问题更容易解决。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-30T23:21:22.990

我支持它可能是堆栈损坏的概念。我要补充一点，切换到多线程库让我怀疑发生的事情是一个潜伏的错误已经暴露。缓冲区溢出的排序可能发生在未使用的内存上。现在它正在访问另一个线程的堆栈。还有许多其他可能的情况。

抱歉，如果这并没有给出如何找到它的提示。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-13T01:17:24.210

不可能知道，但这里有一些我能想到的提示。

*   在 pthreads 中，您必须分配堆栈并将其传递给线程。你分配够了吗？没有像单线程进程那样的自动堆栈增长。
*   如果您确定不会通过写入过去的堆栈分配数据来破坏堆栈，请检查 rouge 指针（主要是未初始化的指针）。
*   其中一个线程可能会覆盖其他人所依赖的一些数据（检查您的数据同步）。
*   在这里调试通常不是很有帮助。我会尝试创建大量日志输出（每个函数/方法调用的进入和退出的跟踪），然后分析日志。
*   错误在 Linux 上以不同方式表现出来的事实可能会有所帮助。您在 Solaris 上使用什么线程映射？确保将每个线程映射到它自己的 LWP 以简化调试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-30T22:59:39.523

将值 2 分配给变量但将其地址分配给 2 是否有意义？

我丢失了其他细节，但“2”是您的问题描述中反复出现的主题。;)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-30T23:06:41.913

我认为这听起来肯定是由于数组或缓冲区写入超出限制而导致的堆栈损坏。只要写入是顺序的，而不是随机的，堆栈保护器就会很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-31T00:49:40.987

我在上面尝试了 Valgrind，但不幸的是它没有检测到堆栈错误：

“除了性能损失之外，Valgrind 的一个重要限制是它无法检测使用静态或堆栈分配数据时的边界错误。”

我倾向于同意这是一个堆栈溢出问题。棘手的事情是追踪它。就像我说的，这个东西有超过 100,000 行代码（包括内部开发的自定义库——其中一些可以追溯到 1992 年）所以如果有人有任何捕捉这类东西的好技巧，我会感激的。到处都在处理数组，该应用程序使用 OI 作为其 GUI（如果您还没有听说过 OI，请不胜感激）所以仅仅寻找逻辑谬误是一项艰巨的任务，我的时间很短。

也同意 0x000002 是可疑的。它是崩溃之间唯一的常数。更奇怪的是，这只出现在多线程开关上。我认为由于多线程而导致的较小堆栈是现在出现这种情况的原因，但这纯粹是我的假设。

没有人问这个，但我用 gcc-4.2 构建。另外，我可以在这里保证 ABI 的安全，所以这也不是问题。至于 RAM 命中的“堆栈末尾的垃圾”，它普遍为 2（尽管在代码中的不同位置）的事实让我怀疑垃圾往往是随机的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-31T20:52:57.653

> 也同意 0x000002 是可疑的。它是崩溃之间唯一的常数。更奇怪的是，这只出现在多线程开关上。我认为由于多线程而导致的较小堆栈是现在出现这种情况的原因，但这纯粹是我的假设。

如果您通过引用或地址传递堆栈上的任何内容，那么如果另一个线程在从函数返回的第一个线程之后尝试使用它，这肯定会发生。

您可以通过将应用程序强制到单个处理器上来重现这一点。我不知道您如何使用 Sparc 做到这一点。

# python - 从 Django 应用程序中提供静态网页的最佳方式是什么？

> ID：252035
> 
> 赞同：4
> 
> 时间：2008-10-30T22:47:20.140
> 
> 标签：python, django, static, templates

我正在构建一个相对简单的[Django](http://en.wikipedia.org/wiki/Django_%28web_framework%29)应用程序，除了应用程序的大部分动态部分所在的主页外，我还需要一些根本不是动态的页面（*关于*、*常见问题解答*等）。将这些集成到 Django 中的最佳方法是什么，仍然使用 Django 模板引擎？我应该只为每个模板创建一个模板，然后有一个简单地呈现该模板的视图吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T22:49:35.830

你看过Django中的[平面页面吗？](http://docs.djangoproject.com/en/dev/ref/contrib/flatpages/#ref-contrib-flatpages)它可能会做你正在寻找的一切。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T22:57:13.210

如果您只想为它们中的每一个创建一个模板，您可以使用[`direct_to_template`](https://docs.djangoproject.com/en/1.4/ref/generic-views/#django-views-generic-simple-direct-to-template)通用视图来提供它。

另一个选项是[`django.contrib.flatpages`](https://docs.djangoproject.com/en/1.4/ref/contrib/flatpages/)应用程序，它可以让您通过数据库配置静态 URL 和内容。

# c# - .NET 中的交叉分辨率应用程序

> ID：252050
> 
> 赞同：0
> 
> 时间：2008-10-30T22:55:13.307
> 
> 标签：c#, .net, user-interface

我们正在开发一个小型内部应用程序，它将在具有多分辨率的显示器上运行。现在我们希望应用程序应该自我调整并在所有监视器上保持一致。

我也来自 Java 背景，我们使用不同的布局来完成任务。我在 .NET 中尝试了不同的布局，如 UniGrid（提供一致性但非常严格）、Grid 等，但未能完成所需的任务。

有哪些可能的布局模型或其他解决方案？

**我认为如果我们可以像在 CSS/HTML 中那样指定百分比宽度或高度，那么我们可以采用这种交叉分辨率策略。我发现 Infergistics 有这样的控件，但这可以通过默认控件来实现吗？**

PS：我实际上正在尝试使用 WPF（最好是 WPF 本机应用程序）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T12:05:18.280

[WPF](http://msdn.microsoft.com/en-us/library/ms754130.aspx)中的布局控件大大优于 Windows 窗体中的布局控件。它还具有使用[固定文档](http://msdn.microsoft.com/en-us/library/ms748388.aspx)的真正分辨率独立显示，因此即使显示器 DPI 发生变化，外观也是一致的。据我所知，这是其他 Windows 绘图 API 无法正确支持的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T23:23:57.820

它完全取决于应用程序的内容/上下文，但 .NET 表单设计器在设计 UI 时为您提供了一些有用的工具。

大多数控件都有一个**`Anchor`**属性，允许您指定控件在调整大小期间应保持与窗体的顶部/左侧/底部/右侧的指定距离。

同样，表单本身会公开**`Resize`**和**`SizeChanged`**事件，您可以在调整表单大小时使用这些事件来自定义 UI。

这里还有一些关于布局的信息， http: [//msdn.microsoft.com/en-us/library/ms951306.aspx](http://msdn.microsoft.com/en-us/library/ms951306.aspx)。

# itsm - 您如何将 ITSM 概念应用到您的开发项目中？

> ID：252051
> 
> 赞同：1
> 
> 时间：2008-10-30T22:55:23.293
> 
> 标签：itsm

我在工作中接手了一个大型项目，需要大量 TLC 才能使其进入可管理状态。在这一点上，这种情况的原因和方式并不重要。

我在想我可以使用 IT 服务管理的一些概念来控制这个项目。它没有编码标准，没有变更管理，没有问题跟踪，也没有构建过程可言。一切都是在资源管理器中手动完成的，当帮助台收到问题时，会将问题添加到 Word 文档中。

你会使用什么样的正式程序来解决这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T22:56:35.350

你考虑过[ITIL](http://en.wikipedia.org/wiki/ITIL)吗？对于您正在处理的某些领域，它具有正式的结构，例如应用程序管理、变更管理和事件管理。这是一个带有支持文档和认证的正式流程。

# java - Java 泛型（通配符）

> ID：252055
> 
> 赞同：118
> 
> 时间：2008-10-30T22:57:03.977
> 
> 标签：java, generics, bounded-wildcard

我对 Java 中的通用通配符有几个问题：

1.  `List<? extends T>`和 和有什么不一样`List<? super T>`？

2.  什么是有界通配符，什么是无界通配符？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2008-10-30T23:10:26.287

在您的第一个问题中，`<? extends T>`并且`<? super T>`是有界通配符的示例。一个无界通配符看起来像`<?>`，基本上意味着`<? extends Object>`。它松散地意味着泛型可以是任何类型。有界通配符（`<? extends T>`或`<? super T>`）通过说它必须*扩展*特定类型（`<? extends T>`称为上限）或必须是特定类型的祖先（`<? super T>`称为下限）来对类型施加限制.

[Java 教程在通配符](http://java.sun.com/docs/books/tutorial/java/generics/wildcards.html)和通配符[更有趣](http://java.sun.com/docs/books/tutorial/extra/generics/morefun.html)的文章中对泛型有一些很好的解释。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-30T23:14:24.423

如果你有一个类层次结构 A，B 是 A 的子类，C 和 D 都是 B 的子类，如下所示

```
class A {}
class B extends A {}
class C extends B {}
class D extends B {} 
```

然后

```
List<? extends A> la;
la = new ArrayList<B>();
la = new ArrayList<C>();
la = new ArrayList<D>();

List<? super B> lb;
lb = new ArrayList<A>(); //fine
lb = new ArrayList<C>(); //will not compile

public void someMethod(List<? extends B> lb) {
    B b = lb.get(0); // is fine
    lb.add(new C()); //will not compile as we do not know the type of the list, only that it is bounded above by B
}

public void otherMethod(List<? super B> lb) {
    B b = lb.get(0); // will not compile as we do not know whether the list is of type B, it may be a List<A> and only contain instances of A
    lb.add(new B()); // is fine, as we know that it will be a super type of A 
} 
```

有界通配符就像`? extends B`B 是某种类型。也就是说，类型未知，但可以在其上放置“绑定”。在这种情况下，它受到某个类的限制，该类是 B 的子类。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-10-31T08:15:17.187

Josh Bloch 也很好地解释了何时使用`super`，并且`extends`在这个[google io 视频谈话](http://sites.google.com/site/io/effective-java-reloaded)中，他提到了**Producer `extends`Consumer`super`**助记符。

从演示幻灯片：

> 假设您要添加批量方法`Stack<E>`
> 
> `void pushAll(Collection<? extends E> src);`
> 
> – src 是 E 生产者
> 
> `void popAll(Collection<? super E> dst);`
> 
> – dst 是 E 消费者

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-08T09:47:05.957

有时您可能想要限制允许传递给类型参数的类型种类。例如，对数字进行操作的方法可能只想接受 Number 或其子类的实例。这就是有界类型参数的用途。

```
Collection<? extends MyObject> 
```

意味着它可以接受所有与 MyObject 有**IS-A**关系的对象（即任何属于 myObject 类型的对象，或者我们可以说是 MyObject 的任何子类的任何对象）或 MyObject 类的对象。

例如：

```
class MyObject {}

class YourObject extends MyObject{}

class OurObject extends MyObject{} 
```

然后，

```
Collection<? extends MyObject> myObject; 
```

将只接受 MyObject 或 MyObject 的子对象（即 OurObject 或 YourObject 或 MyObject 类型的任何对象，但不接受 MyObject 超类的任何对象）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-20T16:34:03.990

一般来说，

> 如果一个结构包含具有 form 类型的`? extends E`元素，我们可以从结构中取出元素，但不能将元素放入结构中

```
List<Integer> ints = new ArrayList<Integer>();
ints.add(1);
ints.add(2);
List<? extends Number> nums = ints;
nums.add(3.14); // compile-time error
assert ints.toString().equals("[1, 2, 3.14]"); 
```

要将元素放入结构中，我们需要另一种通配符`Wildcards with super`，称为

```
 List<Object> objs = Arrays.<Object>asList(2, 3.14, "four");
    List<Integer> ints = Arrays.asList(5, 6);
    Collections.copy(objs, ints);
    assert objs.toString().equals("[5, 6, four]");

    public static <T> void copy(List<? super T> dst, List<? extends T> src) {
          for (int i = 0; i < src.size(); i++) {
                dst.set(i, src.get(i));
         }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-07T09:26:28.037

创建通用通配符是为了使在 Collection 上操作的方法更可重用。

例如，如果一个方法有一个参数`List<A>`，我们只能给`List<A>`这​​个方法。在某些情况下，这个方法的功能是浪费：</p>

1.  如果这个方法只从 中读取对象`List<A>`，那么我们应该被允许给`List<A-sub>`这个方法。（因为 A-sub 是 A）
2.  如果这个方法只插入对象到`List<A>`，那么我们应该被允许给`List<A-super>`这个方法。（因为 A 是 A-super）

# c# - 使用 .Net 如何使用 Sort 方法对数组进行反向排序，即从 Z 到 A？

> ID：252066
> 
> 赞同：5
> 
> 时间：2008-10-30T23:01:06.167
> 
> 标签：c#, .net, arrays, sorting

使用 .Net 如何使用 Sort 方法对数组进行反向排序，即从 Z 到 A？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-30T23:05:14.660

提供适当的元素比较器。您使用什么 C# 版本？3让你这样做：

```
Array.Sort(myarray, (a, b) => b.CompareTo(a)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T23:04:14.710

您需要将[IComparer](http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx)对象或[比较](http://msdn.microsoft.com/en-us/library/tfakywbh.aspx)委托传递给 Sort 函数。

这是来自 C# 2.0 的示例代码

```
 Array.Sort(array,delegate(string a, string b)
    {
        return b.CompareTo(a);
    }); 
```

编辑：错过了数组位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T23:07:56.713

如果您使用与执行此操作的标准相反的不同比较器。

或者正常排序，然后反转它......

# sql-server-2000 - 从触发器执行 MS SQL Server 2000 DTS 包的最佳方法是什么？

> ID：252069
> 
> 赞同：0
> 
> 时间：2008-10-30T23:02:19.440
> 
> 标签：sql-server-2000, triggers, dts

我环顾四周，发现了一些关于如何做到这一点的想法，但没有明确的最佳方法。其中一个想法是使用 sp_start_job 启动运行 DTS 包的 SQL Server 代理作业。如果这是最好的方法，那么下一个问题将是，“如何从作业中安排 DTS 包并使其不再重复？”

谢谢，蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T00:04:42.560

[xp_cmdshell](http://msdn.microsoft.com/en-us/library/ms175046.aspx)将允许您执行 dtsrun。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T18:23:31.820

我不建议将这种功能绑定到触发器。触发器应该很快。我认为没有任何方法可以像*我*想要的触发器那样快速启动 DTS 包。如果这引起了你的共鸣，那么我建议让你的触发器简单地将一行插入一个特殊的表中，然后根据你的目的（每分钟？每 10 秒？）执行一个作业来监视这个表并根据需要启动适当的 DTS 包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T21:51:32.487

我没有使用 xp_cmdshell，而是这样做了：

当表中的某个值发生更改时，触发器使用 msdb.sp_start_job 启动作业。此作业不应按计划运行，仅当由用户启动时。我将作业计划设置为运行一次，现在已成为过去，并且取消选中启用的框。

该作业有一个步骤，即 DTSRun /~Z0xHEXENCRYPTEDVALUE。DTS 包将一些行从该服务器复制到不同平台上的另一台服务器，并在成功时使用触发器重置表中的值以供下次使用。触发器在调用 sp_start_job 之前检查表值，以便作业仅在某些条件下启动，而不是每次启动。

由于 sp_start_job 异步运行，触发器很快完成。唯一的缺点是我需要轮询成功重置的值并让用户知道它有效，或者在一段时间后它不起作用。

如果我需要同步操作，另一种选择是使用 xp_cmdshell，这在触发器内部可能不是一个好主意。

# internet-explorer - Visual Studio 2005 - 在不同的用户帐户下运行网站

> ID：252072
> 
> 赞同：3
> 
> 时间：2008-10-30T23:03:22.853
> 
> 标签：internet-explorer, visual-studio-2005

我正在构建一个 ASP.NET 网站，当我单击 START DEBUGGING 图标时，它会以我运行 Visual Studio 的帐户运行 Internet Explorer。

我想在调试时以不同的用户身份运行 IE。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T23:06:52.677

您可以使用 runas 命令以其他用户身份运行 IE 以运行您的应用程序。稍后当您要调试时附加到 asp.net 工作进程。

如果您只想更改集成身份验证的凭据，请尝试以下更新中的设置。

**更新**：如果您希望 IE 提示输入用户名和密码，请尝试以下设置：

对于 IE 7，为您的区域设置此选项：

工具 > Internet 选项 > 安全 > 自定义级别（针对您的区域）> 用户验证 > 登录 > 提示输入用户名和密码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T23:36:42.490

@Gulzar 正在做一些事情，除了只要您启动调试器（它会启动浏览器，没关系，只是不要关闭它），然后使用 runas 作为另一个用户启动 IE（或 Firefox）并指向它到调试器启动的浏览器中显示的 localhost URL，您应该能够使用其他 ID 与应用程序交互。并且调试器应该按预期工作。

# java - 在 J2EE 服务器中的两个不同应用程序之间匹配两个对象实例的最佳方法是什么？

> ID：252082
> 
> 赞同：0
> 
> 时间：2008-10-30T23:05:25.317
> 
> 标签：java, jakarta-ee, distributed

我有一个 J2ee 应用程序，我基本上想要两个对象，由两个单独的 servlet 创建以直接通信，并且我需要这些实例是稳定的，即在会话期间相互“了解”。

顺序大致是：

1.  客户端向 Servlet #1 发送请求，后者创建对象 A
2.  客户端向创建对象 B 的 servlet #2 发送第二个请求（在第一个返回之后）。
3.  对象 B 使用 JNDI 找到 A，两个对象交互。
4.  客户端现在继续向需要再次查找 B 的对象 A 发送请求。

我如何确保这两个实例在整个会话期间都知道？将它们绑定到 JNDI 并不能完全解决问题，因为对象 B 需要与其原始 servlet（servlet #2）通信，而该 servlet 在请求之间并不能保持稳定。

有任何想法吗？

提前致谢。

* * *

是的，我承认问题描述有点模糊。但这不是一个非常简单的应用程序。不过，我会尝试更好地问它：

我的最终目标是为我的应用程序创建一种“语义调试器”，而不是简单地调试 java 语句的 java 调试器。

被调试的应用程序基本上是一个 servlet。我的工具连接到的。该工具通过另一个控制调试过程的 servlet 维护与应用程序的连接。这两个 servlet 需要不断地直接相互通信。

我目前的想法是设置一个有状态的会话 bean 来促进这种通信（从未做过，仍在努力设置它）。

但我将不胜感激有关如何更好地实现这一目标的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T17:58:47.020

是什么阻止您使用 Session？您不需要 JNDI，只需将您的对象以预定义的名称放入会话中。如果通信对象是应用程序范围的，请使用 Singleton。

PS在我看来，您正在做一些奇怪的事情，而解决方案实际上可能更简单。你能描述一下任务，而不是建议的实现吗？什么是“语义调试器”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T09:52:16.743

老实说：我不完全理解你想要达到的目标。您能否尝试解释您要解决的问题而不是解决方案？

这些对象依赖于什么？它们是特定于用户的吗？然后将它们放入会话中，您可以再次从会话中检索它们（request.getSession().getAttribute("A")）。

它们对所有用户都是全球性的吗？在这种情况下，将它们放入弹簧配置并从那里检索它们。

永远不要在 servlet 中存储任何信息。

编辑：好的，所以据我所知，在会话中存储值是解决这个问题的最佳方法（在“Java-Pseudo-Code”中）：

```
public class BusinessServlet {

protected void doGet(HttpServletRequest req, HttpServletResponse res)  {
  HttpSession session = req.getSession(true);
  BusinessCode business = session.getAttribute("A");
  if (business == null) {       
    business = new BusinessCode();
    session.setAttribute("A", business);
  }

  DebugObject debug = session.getAttribute("B");
  if (debug == null) {       
    debug = new DebugObject();
    session.setAttribute("B", debug);
  }

  business.doSomeWork(debug); 
  }
} 

public class DebugServlet {
  protected void doGet(HttpServletRequest req, HttpServletResponse res)  {
    HttpSession session = req.getSession(true);
    DebugObject debug = session.getAttribute("B");
    if (debug != null) {
      debug.printDebugMessages(res);
    }
  }
} 
```

这有帮助吗？

# makefile - (M|m)akefile 语义是什么？

> ID：252084
> 
> 赞同：3
> 
> 时间：2008-10-30T23:06:28.293
> 
> 标签：makefile, gnu-make

使用 makefile 和 Makefile 有区别吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T23:11:41.183

gmake 使用通过以下顺序找到的第一个“make”文件：

GNUmakefile、makefile、makefile

否则，它们在语义上是等价的。如果您使用 GNU 扩展，GNU 建议仅使用 GNUmakefile。

[来源](http://www.gnu.org/software/make/manual/html_node/Makefile-Names.html#Makefile-Names)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T23:08:34.903

不，没有。即使在具有区分大小写的文件系统的平台上，“make”程序也会查找这两个名称。GNU Make 检查“makefile”，然后检查“Makefile”（从技术上讲，它首先检查 GNUmakefile，但您不需要使用该名称）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T23:08:20.800

哎呀。应该用谷歌搜索它。

如果一个目录有一个 makefile 和一个 Makefile，gmake 将优先使用 makefile。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T23:16:42.110

所以。不知道 GNUmakefile。谢谢特万佛森！(-;

不知道 Gamecat 的建议，因为这与我在测试时发现的相反。

谢谢弗洛林，你的建议也是我现在发现的。

makefile 然后 Makefile （似乎被 GNUmakefile 取代。）

干杯，

抢

# iphone - 定时器和动画事件胜过 TouchesEnded 事件

> ID：252101
> 
> 赞同：1
> 
> 时间：2008-10-30T23:10:54.133
> 
> 标签：iphone, objective-c, cocoa-touch, core-animation, timer

我已经使用我首先在 TouchesBegan 重载中设置的 NSTimer 实现了一个长按处理程序。

但是，我真正想要的是在按住触摸的同时连续快速执行一个动作。因此，在计时器到期时，我调用一个处理程序来完成这项工作，然后它设置另一个计时器并继续循环，直到 TouchesEnded 进入并取消它，或者满足另一个终止条件。

这工作正常，直到我的处理程序代码触发动画同时消失。现在我们有了动画事件和计时器事件，我们还需要处理 TouchesEnded。

我发现，如果触发了动画，并且我将计时器设置为小于 0.025 秒，我的 TouchesEnded 事件直到计时器周期停止（另一个终止条件）才会发生。设置一个较慢的计时器，或者不触发动画，让它工作（TouchedEnded 立即出现），但不是我想要的。

显然，这一切都在设备上（发布版本 - 没有 NSLogs） - 在 sim 中一切正常

有没有办法设置这些事件的相对优先级 - 或者我可能在这里遗漏了其他明显的东西？

```
[更新]

```

在这种情况下，我通过在没有视觉反馈的情况下完成连续部分来解决这个问题（从这个用户的角度来看是即时的）。我认为目前还可以。我仍然希望听到更多关于此的想法（Jeffrey 的想法很好），但我现在不会坐立不安。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T21:32:57.167

尝试通过生成线程来编写您自己的 Timer 类型的类。例子：

```
BOOL continue = YES; //outside of your @implementation

-(void)doLoop
{
   while(continue){
      [NSThread sleepForTimeInterval:.025];
      [self performSelectorOnMainThread:@selector(whateverTheFunctionIs) waitUntilDone:YES];
    }
} 
```

这将由`[NSThread detatchNewThreadSelector:@selector(doLoop) toTarget:self withObject:nil]`. 这并不完全是线程安全的，但是您可以选择将布尔值包装到 NSNumber 中，然后在您选择时对其执行 @synchronize 。或者，在我写完那个小片段后，我意识到最好检查当前的 NSTime 而不是 sleepForTimeInterval: 但你明白了。:)

# architecture - AMQP 是否适合作为机器内和机器间软件总线？

> ID：252115
> 
> 赞同：9
> 
> 时间：2008-10-30T23:16:33.623
> 
> 标签：architecture, message-queue, distributed, amqp

我试图了解[AMQP](https://jira.amqp.org/confluence/display/AMQP/About+AMQP)。它看起来非常适合应用程序之间的机器间（集群、LAN、WAN）通信，但我不确定它是否适合（在架构和当前实现方面）用作一台机器内的软件总线。

是否值得拔出当前的高性能消息传递框架来用 AMQP 替换它，或者这是否会通过模糊本地和非本地通信之间的区别而落入[与 RPC 相同的陷阱？](http://steve.vinoski.net/blog/2008/07/01/convenience-over-correctness/)

我也对使用 WAN 技术进行机器内通信的性能影响持谨慎态度，尽管这可能更多的是实现而不是架构问题。

战争故事将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-15T11:48:48.613

AMQP 不是 RPC 框架。它提供了构建模块来对共享队列、RPC、pubsub 等事物进行建模，但它并没有规定任何特定的使用方式。

如果您想对应用程序进行分区（使其在途中可分发）并将其与 AMQP 连接在一起，我认为这是正确的技术。虽然可能有更快的替代方案，但可能没有像 AMQP 那样通用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T09:55:19.653

AMQP 是一种规范，因此您实际上是在比较苹果和橙子。真的没有那么多生产就绪的 AMQP 提供者。在撰写本文时，主要的消息传递提供程序或供应商都没有支持 AMQP（例如 IBM、Tibco、Sonic、BEA、Oracle、SwiftMQ、MS、Apache ActiveMQ、Sun 的 openmq）——因此所有可用的 AMQP 提供程序都是相当新的。

因此，我建议将您感兴趣的任何 AMQP 提供程序与您的消息传递框架进行比较。仅仅因为它读取和写入字节到套接字的方式，就撕掉一些工作正常的东西是没有意义的:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-12T21:32:12.897

作为可靠、极其灵活（就消息传递模式而言）的基础，它可以用于许多消息传递场景，包括机器内（即进程间）和网络间。它可以从零扩展到庞大的高带宽多网络系统。

我目前正在为一个小型但相对复杂的近实时系统评估它，我们不关心消息传播多远或谁/什么（在合理范围内；）正在消耗它们。如果消费者坐在同一台机器上，那就这样吧。我会试一试，看看你是怎么做的。如果您想拼凑一个原型系统，请使用 python 和[Pika](http://pika.github.com/ "鼠兔")库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-12T07:51:47.700

AMQP 标准正在变得成熟，并解决了一些困扰 JMS 等其他消息传递标准的棘手问题。对于您是否值得更换现有解决方案的问题，我想说这取决于。我会非常怀疑，因为大概系统已经在工作，在生产中并且高性能。

如果您遇到以下问题：

*   互操作性不起作用
*   无法轻松扩展
*   性能不够好
*   当前的消息传递解决方案很昂贵（维护）

您应该调查所需的工作并更准确地分析收益。如果您已经满意，更换消息传递框架不会带来投资回报。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T15:08:00.060

AMQP 看起来更像是为 SOA 提供的可靠传输中间件，而不是内部使用的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-03T11:55:58.943

如果您主要对机器内场景中的性能感兴趣，那么问题不在于 AMQP（它只是一个线路级协议），而在于您应该尝试哪种实现。

通过消除网络引入的延迟，您可能会对各种实现的原始性能更加敏感。因此，我会研究用 C++ 实现的产品，例如 Qpid 或 Zeromq。

在一些不错的硬件（四核）上，Qpid 可以轻松达到每秒 400 000 条消息（消息为 1024 字节）。Zeromq 可能会执行得更好，因为您可以拥有对等通道，而 Qpid 使用代理架构（有一个步骤）。

# email - 从您的程序中向用户提供每周更新的最佳方式是什么？

> ID：252119
> 
> 赞同：2
> 
> 时间：2008-10-30T23:19:20.187
> 
> 标签：email, smtp, status, updates

我有一个程序，在大多数情况下，在后台运行。假设它是DoesWork()。每周一次，我希望它通知用户它在过去几天完成的一些工作。这将是一份基本状态报告，列出了一些已下载的文件。

最初，我想通过电子邮件发送此状态更新，因此我对此进行了调查，但存在很多问题。我需要一个 SMTP 服务器，所以我查看了 GMail。没关系，但每日限制为 500 封电子邮件，因此不适合发布。此外，在程序的每个副本中给出相同的电子邮件帐户密码也会存在问题，据我所知，即使使用加密存储密码也是一种风险。

然后我想也许我可以使用用户自己的电子邮件帐户向他/她自己发送电子邮件。这也有一些复杂性：用户需要为他/她的电子邮件帐户指定所有 smtp 信息，这对于目标用户来说太复杂了。另外，我不想让人们在我的程序中输入他们的电子邮件帐户密码只是为了发送电子邮件。我认为这不是一个值得提倡的好习惯。

有什么办法可以通过电子邮件做到这一点？电子邮件是我的第一选择，因为它是一个用户已经在检查的通知系统。这是相当非侵入性的。

是否有必要设置我自己的 smtp 服务器？如果是这样，我该怎么做？

如果电子邮件不可行，我也在考虑只生成一个包含相关信息的本地 HTML 文件，然后每周从程序弹出一次通知，通知用户新的更新报告已准备好。我认为这是完全可行的，它只是过于打扰而不是我的第一选择。我想搭载用户已经在使用的系统。

谢谢！-格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T23:25:18.130

另一种方法是让程序生成一个 RSS 提要并指导用户如何订阅它。此外，一旦生成了新的更新，显示更新 toast 大约一分钟，然后自动将其隐藏并将系统托盘图标更改为不同的东西。大约一天后将其更改回原始图标。另外，给用户一个设置来永久关闭吐司。

依靠电子邮件不是一个好主意，因为您必须收集用户电子邮件并为此处理隐私问题，您将有效地使用任何第三方 SMTP 服务器，或者必须为自己的基础设施进行投资。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T23:27:07.737

如果我理解正确的话，用户正在他的电脑上运行这个程序，在后台。

通知某事的完美方式是，恕我直言，将程序最小化到托盘栏，点击一个小弹出窗口，将打开一个带有每周报告的窗口。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T00:34:33.623

如果您确实让他们指定了自己的 smtp 服务器，请确保在其中放置“发送测试电子邮件”按钮，以便他们可以对其进行测试。我从经验中知道，用户在指定 smtp 服务器、用户名、密码时总是输入错误的详细信息，因为某些 smtp 服务器需要用户名/密码而其他服务器不需要，因此情况变得更糟。

如果他们确实输入了错误的详细信息（或者他们更改了），那么您可能需要通过某种方式向他们发送较旧的报告，或者通过其他方式通知他们您无法发送电子邮件。

电子邮件很棒，但您可能还需要另一种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T23:23:54.450

Google for simple smtp server windows 给你[这个](http://www.softstack.com/freesmtp.html)

老实说，如果您每周只发送一次邮件，那么电子邮件是您最好的选择，因为它不够频繁，无法保证用户将在他的机器上接受其他类型的请求，这需要您编写专有软件。

您也可以将其发布到 irc 频道，或编写一个 MSN 机器人向用户发送消息，如果用户离线，该消息将作为离线消息发送。

我仍然会使用电子邮件，它已经过尝试和测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T23:34:09.423

对于一个简单的 SMTP 服务器，我使用[hmail](http://www.hmailserver.com/)。我将其配置为接受来自本地计算机的所有 SMTP 请求，无论源和目标如何，并拒绝任何不是来自本地主机的 SMTP 请求。如果您有一个位于中心的应用程序，这将很好。

如果你想分发应用程序，你的情况就完全不同了；由于许多 ISP 对 SMTP 流量进行了限制，您最好的选择是允许用户输入他们的邮件帐户详细信息，然后使用它来发送邮件。这将确保每个人都可以进入工作环境。然后使用为 yoru 语言选择的任何库或预制代码使用这些设置发送电子邮件。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-31T08:01:30.007

是否需要每周摘要？相反，如何使用[Growl](http://growl.info/)（或等效的）在后台实时通知用户正在完成的任务？

# virtual-server - 虚拟服务器迁移概述？

> ID：252141
> 
> 赞同：-1
> 
> 时间：2008-10-30T23:31:14.123
> 
> 标签：virtual-server

我正在寻找关于将 W2003 服务器迁移到虚拟服务器环境所需执行的操作和顺序的广泛概述。具体来说：

它一般是如何工作的？我需要以任何方式准备我的磁盘吗？我先安装什么？工具包？虚拟服务器？以后可以安装linux吗？

等等

欢迎任何指点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T00:06:56.377

根据您要迁移到的虚拟化平台，有一些工具可以执行物理到虚拟的转换：

[http://www.vmware.com/products/converter/](http://www.vmware.com/products/converter/)

PlateSpin 是我们在将托管平台的一部分虚拟化到 Virtual Iron 时推荐的产品。

[http://www.platespin.com/products/powerconvert/](http://www.platespin.com/products/powerconvert/)

它将物理转换为 Microsoft Virtual Server、Virtual Iron、VMware 和 Citrix XenServer 以及其他功能。

实际上，我们只是在原始 VM 上运行了我们的内部服务器构建过程，这使我们有机会从新机器开始，而不会随着时间的推移在特定年份的服务器上发生配置“腐烂”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T17:42:12.993

这就是我所缺少的：

虚拟化软件（VMWare、Virtual PC、Virtual Server 等）不是操作系统，它是在现有操作系统（主机操作系统）上运行的应用程序。一旦它安装在主机操作系统中，您就可以使用虚拟化软件安装其他操作系统（来宾操作系统）。因此，您的主机操作系统不需要“转换”。

每个来宾操作系统在主机操作系统中都有一些与之关联的文件。有一个用于虚拟磁盘驱动器的文件，一个用于虚拟映像的文件。您的磁盘不需要特别分区或以任何方式准备 - 您只需要驱动器上有足够的空间。

有了这个概念性的概述，剩下的就变得容易了。

Kev 假设我比我更了解这些概念，并给了我一些指示，让我在其他一些硬件上进行现有安装，并将其转换为我的虚拟服务器上的客户操作系统。这些天我会为自己尝试一下！

# image - JPEG -> 更压缩的 JPEG——值得吗？

> ID：252144
> 
> 赞同：4
> 
> 时间：2008-10-30T23:33:40.610
> 
> 标签：image, jpeg, photo

我正在一个网站上工作，该网站涉及显示来自各种在线零售商的大量产品图片。由于大部分页面重量都在图像中，因此我认为值得研究进一步缩小文件大小的技术。

图像已经是JPEG。我知道 PNG 有很多多余的东西可以大大增加文件大小，但我对 JPEG 的经验较少。所以，有几个相关的问题：

1.  是否值得进一步压缩 JPEG？似乎进一步压缩已经是有损格式的东西可能会导致更多的伤害（质量差）而不是好的（节省 10+% 的文件大小）。

2.  还有其他减少文件大小的技术吗？我不知道 EXIF 元数据或其他元数据是否是这些图像中的任何一个的一部分，如果削减这些是一个实质性的改进。

3.  使用 GD 或 ImageMagick（或其他东西）的任何经验/建议？还有一家名为 Spinwave 的公司提供的商业图像压缩库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T23:45:49.650

你使用缩略图吗？如果是这样，它们是单独保存还是较大的图像完全加载并在网页上调整大小？在页面上显示单独的缩略图大小将节省大量带宽。

您可以降低 JPEG 的品质因数，直到可以看到为止。每次执行此操作时，您都会看到文件大小有所改善。但是，正如您所怀疑的那样，由于您已经拥有 JPEG，您可能会更快地看到图像中的棋盘伪影，因为您正在压缩已经压缩的图像。

GD 或 IM 都运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T23:48:38.130

*   有像 .ZIP 这样的无损压缩，但它们通常更糟糕，对于已经压缩的格式不是很有用。

*   JPEG 可以有不同的压缩级别。多少质量就足够了，由您决定。数码相机中的照片可以压缩到其大小的十分之一，同时非常适合网站。

*   JPEG 更适合照片。PNG 更适合徽标和纯色。

*   ImageMagick 应该允许您从命令行或程序库更改 jpeg 的大小。见[http://www.imagemagick.org/Usage/formats/#jpg](http://www.imagemagick.org/Usage/formats/#jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T23:50:14.070

1.  对我来说，质量看起来不错，直到你开始低于 75-80% 的质量。
2.  我不认为任何元数据（JPEG 也支持 IPTC）会大大增加文件大小 - 但可能值得做一些你自己的基准测试（关于博客的内容！）
3.  我被带入 PHP 是因为喜欢 GD（我认识其中一位贡献者）。只需记住将图像缓存为文件。例如：

    $im = imagecreatefromjpeg('file.jpg');

    // 输出函数

    // 80 = 质量

    imagejpeg($im, 'savedfile.jpg', 80);

代码格式化似乎不起作用！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-06T11:39:56.280

我的经验表明，一些“产品”图像是使用色彩空间元数据创建的，以便在印刷媒体上进行准确的色彩再现。这会增加 jpeg 文件的大小。在某些情况下，我可以通过删除 EXIF 将 jpeg 文件减少 30%。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-28T07:59:32.720

不要重新编码。如果您有某种无损格式的原始图像，则使用更高的压缩率进行编码。如果您在已经 DCT 量化的图像之上进行 DCT 量化，与以所需的较低比特率直接编码相比，您将引入不必要的图像质量损失。

# c - 尝试初始化内存映射文件时的段冲突

> ID：252149
> 
> 赞同：1
> 
> 时间：2008-10-30T23:35:04.693
> 
> 标签：c

以下是我用来创建的代码`memory mapped file`：

```
fid = open(filename, O_CREAT | O_RDWR, 0660);

if ( 0 > fid )
{
    throw error;
}

/* mapped offset pointer to data file */
offset_table_p = (ubyte_2 *) shmat(fid, 0, SHM_MAP);

/* Initialize table */
memset(offset_table_p, 0x00, (table_size + 1) * 2); 
```

说 table_size 大约是 2XXXXXXXX 字节。

在调试期间，我注意到它在尝试初始化“偏移表指针”时失败，

任何人都可以向我提供一些关于为什么它在 intilalization 期间失败的信息吗？有没有可能我的内存映射文件不是用所需的表大小创建的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T01:11:04.780

据我从阅读文档中可以看出，你做错了。

要么使用 open() 和 mmap()，要么使用 shmget() 和 shmat()。

如果您使用 open()，则需要先使文件足够长。为此使用 ftruncate()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T00:42:00.580

第一件事：

在 open() 调用之前和之后检查文件。如果在 Linux 上，您可以使用以下代码：

```
char paxbuff[1000];                            // at start of function
sprintf (paxbuff,"ls -al %s",filename);
system (paxbuff);
fid = open(filename, O_CREAT | O_RDWR, 0660);  // this line already exists.
system (paxbuff); 
```

然后，在调用 shmat() 之后，检查返回值和大小：

```
offset_table_p = (ubyte_2 *) shmat(fid, 0, SHM_MAP);  // already exists.
printf ("ret = %p, errno = %d\n",offset_table_p,errno);
printf ("sz = %d\n",table_size); 
```

这应该足以解决问题。

# javascript - 在 Javascript contenteditable div 中插入文本

> ID：252151
> 
> 赞同：9
> 
> 时间：2008-10-30T23:36:23.490
> 
> 标签：javascript, contenteditable, text-cursor

有没有办法将文本（字符串，可能有也可能没有 html 标签）插入到`div`?

它必须是 a`div`而不是 a `textarea`。

首先，我需要获取光标位置，然后在该位置插入文本。它类似于 function `insertAdjacentText`，但它只能在标签之前或之后插入，并且只能在 IE 中使用。

请参阅此 URL：http: [//yart.com.au/test/iframe.aspx](http://yart.com.au/test/iframe.aspx)。注意如何将光标定位在 div 中，我们需要在光标位置添加文本。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-31T14:36:57.273

如果您需要做的只是在当前选择/插入点插入 HTML，那是可行的。从我的头顶上（让你开始）：

*   在 IE 中，使用`document.selection.createRange().pasteHTML(theNewHTML)`.
*   在其他浏览器中，您应该可以使用`document.execCommand("InsertHTML", ...)`.

我只在可编辑的 iframe/文档中使用了这些技术，而不是在 div 中，但我相信，如果 div 被聚焦，这些调用应该可以工作。

正如另一个答案所警告的那样，如果您想要更细粒度的控制，例如在其他地方插入文本，它会变得很难看。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T00:10:04.687

**范围和选择对象**

使用[**选择**](https://developer.mozilla.org/en/DOM/Selection)和**[范围对象](https://developer.mozilla.org/En/DOM/Range)**。这些包含有关当前选择的各种信息，以及它在节点树中的位置。

**公平警告：** 按照您的描述进行操作并非完全不可能，但是如果您非常喜欢，您将陷入**浏览器怪癖和不兼容性**的深水之中。你将不得不做大量的**对象检测**，检查以确保你有一致的值和方法。在开发过程中逐步检查所有浏览器。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-01T11:18:29.993

这是一个跨浏览器示例，改编自此[答案](https://stackoverflow.com/a/6691294/96100)以使用 iframe。

```
function pasteHtmlAtCaret(html, selectPastedContent, iframe) {
    var sel, range;
    var win = iframe ? iframe.contentWindow : window;
    var doc = win.document;
    if (win.getSelection) {
        // IE9 and non-IE
        sel = win.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();

            // Range.createContextualFragment() would be useful here but is
            // only relatively recently standardized and is not supported in
            // some browsers (IE9, for one)
            var el = doc.createElement("div");
            el.innerHTML = html;
            var frag = doc.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            var firstNode = frag.firstChild;
            range.insertNode(frag);

            // Preserve the selection
            if (lastNode) {
                range = range.cloneRange();
                range.setStartAfter(lastNode);
                if (selectPastedContent) {
                    range.setStartBefore(firstNode);
                } else {
                    range.collapse(true);
                }
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    } else if ( (sel = doc.selection) && sel.type != "Control") {
        // IE < 9
        var originalRange = sel.createRange();
        originalRange.collapse(true);
        sel.createRange().pasteHTML(html);
        if (selectPastedContent) {
            range = sel.createRange();
            range.setEndPoint("StartToStart", originalRange);
            range.select();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-01T10:02:17.013

您还可以使用 insertImage 的迂回方法。您使用 execCommand "insertImage" 插入假图像（或小图像），然后使用 Javascript 替换 innerHTML 以添加文本。

例如：

```
iFrame.focus()
iFrame.document.execCommand("insertImage", "", "fakeimage.jpg")
iFrame.document.body.innerHTML=iFrame.document.body.innerHTML.replace("<img src=\"fakeimage.jpg\">", "MY CUSTOM <b>HTML</b> HERE!") 
```

而 iFrame 等于预期 iFrame 的 id。或者，您可以通过 document.getElementById("IDofDIVlayer").innerHTML 使用 DIV 层

调用 execCommand 前一定要对焦，否则在 IE 中可能不起作用。

此方法也适用于 IE。经测试。

# sql-server - Sql Server 2005：使用什么数据类型来存储由 SHA-256 算法散列的密码？

> ID：252156
> 
> 赞同：15
> 
> 时间：2008-10-30T23:37:45.000
> 
> 标签：sql-server, encryption, types, passwords

在 Sql Server 2005 中，应该使用哪种数据类型来存储[由 SHA-256 算法散列的](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256managed(VS.71).aspx)密码？

数据[由应用程序散列](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256managed(VS.71).aspx)并传递到数据库

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-30T23:49:35.850

在这种情况下，我更喜欢将哈希码转换为十六进制字符串，如果您喜欢“”-前缀，则使用 varchar(64) 或 varchar(66) `0x`。通过这种方式，手动比较或（重新）设置您必须从其他地方复制/粘贴的值要容易得多。例如，您丢失了管理员密码并想通过 SQL 重置它...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-30T23:41:52.450

varbinary(32) 或二进制 (32)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-30T23:47:10.053

SHA256Managed 类的“Hash”属性是一个字节数组，HashSize 是 256 位，所以我相信二进制（32）是最简单的。

您也可以使用 ToBase64Transform 将其放入 varchar 字段中。我对 Base64 算法并不完全熟悉，但似乎您可能需要至少 43 个字符来表示 base 64 中的 256 位数字。IIRC Base64 使用几个填充字符，所以我可能会把它放在varchar(50) 只是为了安全。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T23:41:13.200

应该产生一个 32 字节的值（256 位），所以 binary(32) 应该可以工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T23:49:04.807

SHA-256 具有 256 位输出

256 位 = 32 字节

所以试试 varbinary(32)

# asp.net - 使用 ASP.NET AJAX 从客户端控件向服务器代码传递数据

> ID：252165
> 
> 赞同：1
> 
> 时间：2008-10-30T23:43:48.263
> 
> 标签：asp.net, asp.net-ajax, modalpopupextender

我在显示小部件列表的页面上有一个 ListView。当用户单击列表中的一个项目时，我想显示一个[ModalPopup](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ModalPopup/ModalPopup.aspx)，其中包含允许用户对他们选择的项目进行操作的控件。

我可以通过在 ListView 的 ItemTemplate 中放置一个 Panel 和一个 ModalPopupExtender 轻松完成此操作，但这意味着每个小部件都有一组隐藏控件，这会大大增加页面大小。（那里会有一些相当重量级的控件。）相反，我想为列表中的每个小部件重用一个 ModalPopup。

我已经进行了一些搜索，但我之前没有找到任何直接适用于我的情况的内容。但是，据我所知，我必须做这样的事情：

1.  在 UpdatePanel 内的页面上放置一个 Panel 和一个 ModalPopupExtender。
2.  构建具有属性的自定义`WidgetManipulator`用户控件。`WidgetID`将其与几个确定/取消按钮一起放入面板中。
3.  在页面上的 Javascript 中，将单击处理程序附加到 ListView 中触发 UpdatePanel 上的回发的每个小部件。
4.  在`UpdatePanel_Load`服务器上的事件上，显示 ModalPopup，然后将属性设置`WidgetID`为`WidgetManipulator`单击的小部件的 ID。
5.  在服务器上的`OKButton_Click`事件或`CancelButton_Click`事件上，隐藏 ModalPopup。如果单击 OKButton，请先调用`WidgetManipulator.SaveChanges()`。

我还没有弄清楚的部分是：我怎么知道点击了哪个小部件，以及当我刷新 UpdatePanel 时如何将它传递回服务器？这甚至是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T17:18:50.017

如果您可以改用 jQuery，则可以按照这两篇文章的内容做一些事情：

*   [模态删除确认版本二使用 jQuery SimpleModal 插件演示](http://beckelman.net/post/2008/10/28/Modal-Delete-Confirmation-Version-Two-Using-jQuery-SimpleModal-Plugin-Demo.aspx)
*   [使用 jQuery SimpleModal 插件演示插入内容](http://beckelman.net/post/2008/10/30/Inserting-Content-Using-jQuery-SimpleModal-Plugin-Demo.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T00:07:38.980

当我需要在 ASP.NET AJAX 中将数据从客户端传递到服务器时，我通常使用带有 runat="server" 的 asp:HiddenField。两者都可以自由地看到它，但要注意潜在的回发异步性。

听起来您需要通知服务器单击了小部件 - 您可以使用 Timer 回发；或者我会选择选项 5。

# php - URL 的等效 is_file() 函数？

> ID：252179
> 
> 赞同：3
> 
> 时间：2008-10-30T23:51:23.973
> 
> 标签：php

检查给定 url 是否指向有效文件（即不返回 404/301/等）的最佳方法是什么？我有一个脚本可以在页面上加载某些 .js 文件，但我需要一种方法来验证它接收到的每个 URL 都指向一个有效文件。

我仍在翻阅 PHP 手册以查看哪些文件函数（如果有）实际上可以与远程 URL 一起使用。当我找到更多详细信息时，我会编辑我的帖子，但如果有人已经走过这条路，请随时加入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T02:01:50.593

file_get_contents 有点过头了，因为它足以让 HTTP 标头做出决定，因此您需要使用 curl 来执行此操作：

```
<?php
// create a new cURL resource
$ch = curl_init();

// set URL and other appropriate options
curl_setopt($ch, CURLOPT_URL, "http://www.example.com/");
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_NOBODY, 1);

// grab URL and pass it to the browser
curl_exec($ch);

// close cURL resource, and free up system resources
curl_close($ch);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T23:54:29.117

一种这样的方法是请求 url 并获得状态码为 200 的响应，除此之外，真的没有什么好的方法，因为服务器可以选择处理它喜欢的请求（包括给你其他状态码对于存在的文件，但由于多种原因您无权访问）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T01:13:54.917

如果您的服务器没有启用 fopen 包装器（任何具有良好安全性的服务器都不会），那么您将不得不使用[CURL 函数](http://us2.php.net/curl)。

# cryptography - 代码签名证书选项

> ID：252180
> 
> 赞同：32
> 
> 时间：2008-10-30T23:52:12.600
> 
> 标签：cryptography, certificate, code-signing

我被分配了为我的公司购买数字证书以签署我们的代码的任务。我们在 Microsoft 领域开发应用程序 - 主要是 WPF 或基于 Web。

我调查了选项，发现 Comodo 价格合理且响应迅速，我们已准备好继续通过它们购买证书。但是在注册表单中有各种我不太确定的私钥选项，即：

1.  CSP

    *   Microsoft 基础加密提供程序
    *   Microsoft Base 智能卡加密提供程序
    *   Microsoft 增强加密提供程序 v1.0
    *   Microsoft 软件加密提供程序
2.  密钥大小

    *   1024
    *   2048
    *   4096
3.  可出口？

    *   是/否
4.  受用户保护？

    *   是/否

只是想知道所有这些意味着什么，以及满足我们要求的最佳选择是什么？任何意见/建议将不胜感激

非常感谢格雷格

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-31T04:41:09.553

对于“大多数目的”，建议使用以下选项：

*   Microsoft 基础加密提供程序
*   钥匙尺寸：2048
*   可导出：是
*   用户保护：是

老实说，我不熟悉不同的 CSP，但 Base 每次都为我完成这项工作。

*   密钥大小使密钥更难破解，但短期到中期密钥（3-5 年）超过 2048 位就足够了（恕我直言）。

*   Exportable 可让您导出私钥/证书对 - 备份它必不可少！

*   受用户保护意味着每次要使用证书时都必须输入密码 - 强烈建议您使用证书防止意外或恶意代码签名。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-31T07:37:58.010

从历史上看，“基本”加密提供者对密钥长度有人为限制，而“增强”提供者则取消了限制。这使 Microsoft 能够遵守美国出口法律，在某些版本中删除了增强的提供程序。

显然，随着出口法的变化，微软已经取消了基础提供商的限制，也允许更长的密钥长度（但为了兼容性而保留了名称）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-30T16:37:38.177

关于“Microsoft Software Cryptographic Provider”——我认为应该是“强大的”（而不是“软件”）。

在我工作的实践中，base 提供了一个 512 位的密钥长度（在最近的补丁之后不再支持或在 MS 服务器上工作 - 在 KB2661254 上阅读）。您至少需要 1024，但 2048 是更好的选择。

注意：可导出的私钥是备份和/或带到另一台服务器所需要的（并且我认为是签署代码/脚本所必需的），但会引入它落入坏人之手的可能性，因此可能会签署和运行不需要的脚本一旦您信任该证书，就在您的服务器上！非常注意存储它的位置/方式并使用强大的密码！

仔细检查：您很可能需要安装受信任的根 CA 证书（颁发代码签名证书的 CA）以及您在“受信任的发布者”中的证书本身才能运行签名的 PowerShell 脚本。

# c# - 如何禁用系统设备？

> ID：252185
> 
> 赞同：15
> 
> 时间：2008-10-30T23:54:52.127
> 
> 标签：c#, .net, operating-system, device

有什么方法可以从 C#.NET 禁用系统设备。

基本上是在您进入设备管理器并以这种方式禁用设备时进行模拟？

我假设有一个可以调用的 WinAPI 函数，但我不知道它是哪一个？

我需要这样做的原因是我需要禁用并在再次启用设备后直接。

我需要在 Windows XP 和 Vista（x86 和 x64）中工作。我查看了一个名为“DevCon”的东西，但它似乎不适用于 Vista x64。

谢谢。

**有关答案，请参见此处：[如何以编程方式禁用系统设备？](https://stackoverflow.com/questions/4097000/how-do-i-disable-a-system-device-programatically)**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T03:13:04.787

为了进一步 Mel Green 的回答，硬件帮助程序库使用互操作调用 Windows API (setupapi)，特别是 SetupDiSetClassInstallParams 方法。当然这里还有其他调用用于查找设备详细信息等。

需要考虑的一件事是，如果您作为标准用户或非特权帐户运行，您将无法使用它来控制（启用/禁用等）硬件设备。

有关更多详细信息，请查看[http://www.pinvoke.net](http://www.pinvoke.net)（以及具体调用： http: [//pinvoke.net/default.aspx/setupapi.SetupDiSetClassInstallParam](http://pinvoke.net/default.aspx/setupapi.SetupDiSetClassInstallParam)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-21T00:21:29.600

我知道这是一个老问题，但我遇到了同样的问题。为了解决这个问题，我不得不使用[TechNet wiki](http://social.technet.microsoft.com/wiki/contents/articles/how-to-obtain-the-current-version-of-device-console-utility-devcon-exe.aspx)上提供的新 DevCon 。CodeProject 文章很有帮助，但最后更容易依赖更新的 DevCon。不幸的是，它似乎只在超过 600mb的[Windows Driver Kit中可用。](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=36a2630f-5d56-43b5-b996-7633f2ec14ff&displaylang=en)

# linux - 您对 TaskJuggler 的体验如何？

> ID：252193
> 
> 赞同：9
> 
> 时间：2008-10-31T00:03:01.673
> 
> 标签：linux, project-management

我们是一家全 Unix 商店（Solaris、Linux）。在最后一个产品周期中，我回到了项目领导能力，需要制定一个时间表。我问我的经理会接受哪些工具，听到“文本文件”感到很惊讶。我和我的队友大胆地尝试了这个，可能更糟的是，HTML 表格，来跟踪我们想要调整大小的任务。这很痛苦。

然后我们尝试了一些工具。MrProject 是错误的、有限的并且过于频繁地崩溃。我的经理发誓 Microsoft Project 不灵活。每当他们需要更改任务、重新分配资源或重新平衡时，通常都会破坏他们的计划。因此，我开始在 Internet 上四处寻找支持 Linux 的项目规划工具。一个听起来很有趣的是[TaskJuggler](http://www.taskjuggler.org/)。输入是声明性文件，这很整洁。我觉得我正在为一个项目构建一个生成文件。

然而。我有有限的时间来评估这个工具，它看起来很复杂。在进入下一个产品周期之前，我想知道 TaskJuggler 是否足够强大、灵活并且能够处理多月、多资源且频繁更改的项目。因此，我呼吁所有使用过该工具的工程师分享他们的见解。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-02-01T02:20:53.550

项目管理没有免费的东西，用软件管理一个复杂的项目不可避免地很复杂。真正的问题是，选择的工具对此有帮助吗？

Task Juggler 有一个学习曲线，最终适合那些不介意阅读手册（此工具绝对必要）并且不依赖于图形输入的人。Task Juggler*要求*您考虑您的项目并以有意义的方式构建它。如果你提前做一个图表会很有帮助（许多 TJ 用户制作思维导图，并且有一个工具可以从 FreeMind 思维导图生成 TJ 输入语句）。如果您以某种有意义的方式组织您的输入文件，这也将非常有帮助，使事情变得容易找到。

也就是说，一旦你开始，使用 TJ 创建一个项目非常快。您无需费心处理一百万个对话框，您只需用 TJ 的文本语言告诉 TJ 您想要什么。

但除此之外，我喜欢 TJ 的地方（起初讨厌，来自其他更传统的工具的遗产）是它确保你的日程安排是有意义的。OpenProj 愉快地将资源安排在 300% 甚至更多。TJ 会给你一个错误并让你修复它。是的，这很烦人。但最终的结果是，您有一个有意义且可以实际执行的项目进度表。想象一下！

正如我开始所说，没有什么是免费的。TJ需要学习和一些努力。回报是丰富而丰富的报告，管理项目成本和进度所需的所有信息，以及执行合理、可靠的调度和资源分配方法。而且它不花费 499 美元或任何 MSP 的价格 --- 它是免费的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-07-16T13:16:24.823

在过去的 4/5 年里，我一直在使用 taskjuggler（4 个项目，平均持续时间为一年或更长时间）。我发现创建我的初始估计非常有用

*   项目需要多长时间
*   何时释放每个资源组。
*   如果我们向项目的不同领域添加更多具有不同经验和效率的资源会怎样。

通常，与使用 MS Project 或其他基于 GUI 的工具执行类似操作相比，高层管理人员会询问您有关您的日程安排的那种东西可以生成得更快且粒度更准确。

直到最近，我还在使用 taskjuggler 来获取我的初始时间表并使用 ms excel 来跟踪项目。

这是我第一次使用任务杂耍者来实际每周跟踪项目。到目前为止，结果看起来不错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-31T21:43:04.540

TaskJuggler 的语法相当简单，但请务必花时间阅读文档。我对 TJ 的体验：

*   非常强大和富有表现力的语法
*   用于大型项目的详细计算

然而，在现实中，手动规划考虑了许多隐含的约束，TJ 需要明确这些约束以获得现实场景。这当然适用于每个规划工具，但我发现在 TJ 的大型项目中添加和编辑手动约束相当麻烦……因此我发现它不太适合项目跟踪和事后重新安排。

我现在使用 OmniPlanner，它是一个比 TJ 和 MSProject 简单得多的工具，但结果证明可以满足我的需求（尤其是在跟踪、分析和报告方面）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-13T16:26:57.100

我正在使用 Taskjuggler 为大型电影制作开发一个非常详细的任务管理器。这是语法和 csv 输出的绝妙原因。 ![内部规划工具的屏幕截图](https://i.stack.imgur.com/A8GPe.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-23T18:32:22.780

我一直在使用它 1w 并且喜欢它。

可以说，验收测试是您是否发现文本/编码比基于 UI 的输入更具表现力。如果你觉得用结构化语言表达你的想法很舒服，但更喜欢/期待 UI，那么不要花时间在 TaskJuggler 上。

有关这些备注，请参阅[http://www.pegasoft.ca/coder/coder_july_2008.html](http://www.pegasoft.ca/coder/coder_july_2008.html)

> “不要指望这里有一个带有“添加任务”按钮的漂亮用户界面。” “即使是报表也必须用笨拙的类 C 语言设计”

如果您是这样想的，那就不要花时间在 TaskJuggler 上。

TaskJuggler（几乎）是一种用于规划的 DSL。如果您不知道 DSL 是什么，请不要花时间在 TaskJuggler 上。或者了解 DSL。:-)

其余的，试试吧，因为它可能只是把计划放在你自己手中，然后从那些要求你只是为了要求地位的人手中夺走它。

# .net - 我应该使用枚举还是查询数据库中的表？

> ID：252202
> 
> 赞同：13
> 
> 时间：2008-10-31T00:05:53.180
> 
> 标签：.net, data-structures

在我的数据库中，我有定义类型的表，例如

表：出版物类型

```
身份证 | 类型
----------
1 | 文章
2 | 抽象的
3 | 书
……

```

它通过 ID 键与具有字段*TypeID*的发布表相关联。

然后，我在我的 .NET 应用程序中创建了一个 PublicationTable 数据表，我想根据发布类型对其进行过滤。例如，以下函数为我提供了特定作者和出版物类型的出版物数量。

```
    公共函数 countPublications(ByVal authorID As Integer, _
                                      ByVal PublicationType As Integer) As Integer

        将 authPubs 调暗为新 PublicationsDataSet.tblPublicationsDataTable
        authPubs = Me.getAuthorsPublications(authorID)

        将 dv 调暗为新数据视图（authPubs）
        dv.RowFilter = "status='已发布' AND type='" + _
                       发布类型.ToString + "'"

        返回 dv.Count

    结束功能

```

要调用此函数以获取特定类型作者的文章计数，我可以

1.  用两个整数调用函数

    countPublications(作者ID, 1)

2.  设置一个枚举，以便我可以编写

    countPublications(authorID, pubType.Article)

    或者

3.  以某种方式使用发布类型表来过滤发布数据集，但我不知道如何做到这一点。

我应该考虑哪些其他方法。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T00:09:54.017

如果发布类型本质上是静态的，那么枚举就可以了

可以说嵌入之间几乎没有区别

```
inner join lookuptable lt on lt.id = (int)myenum.sometype 
```

在查询中并添加

```
inner join lookuptable lt on lt.name = "somehardcodeddescription" 
```

它们都是嵌入式常量，前者只是在它后面有一个定义明确的类型

或者你可以使用

```
inner join lookuptable lt on lt.name = myenum.sometype.ToString 
```

我更喜欢前者

另一方面，如果在部署代码后可能会添加新的查找类型，那么枚举很快就会过时；

但是如果有代码需要的一组核心静态枚举值，其余的都无关紧要，那么前一个解决方案仍然可以

像往常一样，“这取决于”;-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T00:51:17.880

在前世保持这种事情，我同意史蒂文的观点，这`enum`是相当合理的。您的代码很清晰，`enum`如果您添加数据类型，则意味着您只需要更新一个文件。

我还建议对 进行评论`enum`，明确说明这些值需要与`Publication Types`数据库表中的值相匹配。

好问题，顺便说一句！+1 如此清楚地解释了这个问题，并在发布之前花时间集思广益。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T01:36:04.340

我认为这取决于您的出版物类型列表将来更改的频率，以及您推出应用程序更新的难易程度。如果列表不会经常更改，或者如果在现场更新您的应用程序很容易，那么枚举是有意义的。如果列表可能经常更改，或者如果更新您的应用程序特别困难，那么将列表保存在数据库中的表中是明智的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T16:23:24.297

出于各种原因，最好将我的出版物类型列表等列表和其他列表保存在一个地方；数据库。那么只有一个地方可以让他们改变。但是，在我看来，这增加了代码的复杂性，如果我想引用特定的出版物类型（例如期刊文章），我仍然需要在代码中包含一些硬编码元素。因此，具有反映表中数据的枚举类型使我有可能以可读的方式调用我的计数函数

```
countPublications(authorID, publicationType.JournalArticle) 
```

如果表中的数据不太可能发生变化，我可以在数据库中添加注释以提醒维护者（可能是我）更新代码中的枚举类型，反之亦然。

谢谢大家的答案。我现在可以安心地继续我的想法了。

# ruby - 检查变量是否在 ruby 中不为零且不为零

> ID：252203
> 
> 赞同：302
> 
> 时间：2008-10-31T00:05:57.393
> 
> 标签：ruby

我正在使用以下代码来检查变量是否不为零且不为零

```
if(discount != nil && discount != 0) 
  ...
end 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：469
> 
> 时间：2008-10-31T00:36:32.697

```
除非 discount.nil？|| 折扣 == 0
  # ...
结尾

```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-31T01:12:41.627

```
class Object
  def nil_zero?
    self.nil? || self == 0
  end
end

# which lets you do
nil.nil_zero? # returns true
0.nil_zero?   # returns true
1.nil_zero?   # returns false
"a".nil_zero? # returns false

unless discount.nil_zero?
  # do stuff...
end 
```

当心通常的免责声明......巨大的权力/责任，猴子修补导致黑暗面等。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2013-11-15T23:09:37.793

好吧，五年过去了……

```
if discount.try :nonzero?
  ...
end 
```

重要的是要注意`try`ActiveSupport gem 中定义的，因此它在普通 ruby​​ 中不可用。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2016-01-15T21:04:54.640

从 Ruby 2.3.0 开始，您可以将安全导航运算符 ( `&.`) 与[`Numeric#nonzero?`](http://ruby-doc.org/core-2.3.0/Numeric.html#method-i-nonzero-3F). 如果实例是并且- 如果数字是，则`&.`返回：`nil``nil``nonzero?``0`

```
if discount&.nonzero?
  # ...
end 
```

或后缀：

```
do_something if discount&.nonzero? 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2008-10-31T00:47:13.253

```
除非 [nil, 0].include?（折扣）
  # ...
结尾

```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-10-31T00:14:09.450

你可以这样做：

```
if (!discount.nil? && !discount.zero?) 
```

顺序在这里很重要，因为如果`discount`是`nil`，那么它将没有`zero?`方法。Ruby 的短路评估应该阻止它尝试评估`discount.zero?`，但是，如果`discount`是`nil`。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-31T12:46:35.543

```
if (discount||0) != 0
  #...
end 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2012-09-26T09:53:27.597

您可以将空行转换为整数值并检查零？。

```
"".to_i.zero? => true
nil.to_i.zero? => true 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-03-16T05:16:46.417

```
if discount and discount != 0
  ..
end 
```

更新，它将`false`为`discount = false`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-29T06:40:24.707

您可以利用`NilClass`提供的`#to_i`方法，该方法将为`nil`值返回零：

```
unless discount.to_i.zero?
  # Code here
end 
```

如果`discount`可以是小数，则可以`#to_f`改为使用，以防止数字被四舍五入为零。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-04-06T09:42:54.283

```
def is_nil_and_zero(data)
     data.blank? || data == 0 
end 
```

如果我们通过 "" 它将返回 false 而空白？返回真。数据=假空白时也是如此吗？对于 nil、false、空或空白字符串返回 true。所以最好使用空白？避免空字符串的方法。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-09-25T11:09:50.030

是的，我们在 ruby​​ 中确实有一个干净的方法。

```
discount.to_f.zero? 
```

此检查处理大量情况，即折扣可能为零，折扣可能是 int 0，折扣可能是浮动 0.0，折扣可能是字符串“0.0”、“0”。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-09-14T14:04:23.310

在处理**数据库记录**时，我喜欢使用迁移助手将所有空值初始化为 0：

```
add_column :products, :price, :integer, default: 0 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-07-20T19:17:22.750

```
if discount.nil? || discount == 0
  [do something]
end 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-06-01T10:34:26.757

我更喜欢使用更清洁的方法：

```
val.to_i.zero? 
```

`val.to_i``0`如果**val**是 a ，将返回a `nil`，

之后，我们需要做的就是检查最终值是否**为零**。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-31T00:10:38.820

只要保证您的代码在初始化之前不会尝试使用它，您就可以将折扣初始化为 0。我想那会删除一张支票，我想不出其他任何东西。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-09-19T10:18:48.180

替代解决方案是使用 Refinements，如下所示：

```
module Nothingness
  refine Numeric do
    alias_method :nothing?, :zero?
  end

  refine NilClass do
    alias_method :nothing?, :nil?
  end
end

using Nothingness

if discount.nothing?
  # do something
end 
```

* * *

## 回答 #18

> 赞同：-7
> 
> 时间：2008-10-31T23:04:26.437

我相信以下对于 ruby​​ 代码来说已经足够好了。我认为我无法编写一个单元测试来显示这与原始版本之间的任何区别。

```
if discount != 0
end 
```

# python - 可能的谷歌谜语？

> ID：252221
> 
> 赞同：11
> 
> 时间：2008-10-31T00:14:12.570
> 
> 标签：python

我的朋友收到了这件免费的 google 网站优化器 T 恤，并来找我尝试弄清楚前面的徽标是什么意思。

[T恤](http://2.bp.blogspot.com/_iQVgmEEAit4/SPkKHA3e8fI/AAAAAAAAAB8/ugUerJjuBw8/s1600-h/GWO-tshirt.jpg)

所以，我对它的含义有几个猜测，但我只是想知道是否还有更多的东西。

我的第一个猜测是每个块代表一个页面布局，而“你应该测试”的标志只是意味着你应该使用谷歌网站优化器来测试哪个是最好的布局。我希望这不是答案，它只是看起来简单而不令人满意。

好吧，我花了过去一个小时试图弄清楚是否有更深层次的含义，但无济于事。所以，我在这里希望有人可以提供帮助。

我确实编写了一个程序来查看这些块是否代表二进制文件。我将在下面发布代码。我的代码将读取一个块的每个排列测试为 4 位，然后尝试将这些位解释为字母、十六进制和 IP 地址。

我希望有人知道更好。

```
#This code interprets the google t-shirt as a binary code, each box 4 bits.
# I try every permutation of counting the bits and then try to interpret these
# interpretations as letters, or hex numbers, or ip addresses.

# I need more interpretations, maybe one will find a pattern

import string

#these represent the boxes binary codes from left to right top to bottom
boxes = ['1110', '1000', '1111', '0110', '0011', '1011', '0001', '1001']

#changing the ordering
permutations = ["1234", "1243", "1324", "1342", "1423", "1432", 
                "2134", "2143", "2314", "2341", "2413", "2431",
                "3124", "3142", "3214", "3241", "3412", "3421", 
                "4123", "4132", "4213", "4231","4312", "4321"]

#alphabet hashing where 0 = a
alphabet1 = {'0000':'a', '0001':'b', '0010':'c', '0011':'d',
             '0100':'e', '0101':'f', '0110':'g', '0111':'h',
             '1000':'i', '1001':'j', '1010':'k', '1011':'l',
             '1100':'m', '1101':'n', '1110':'o', '1111':'p'}

#alphabet hasing where 1 = a
alphabet2 = {'0000':'?', '0001':'a', '0010':'b', '0011':'c',
             '0100':'d', '0101':'e', '0110':'f', '0111':'g',
             '1000':'h', '1001':'i', '1010':'j', '1011':'k',
             '1100':'l', '1101':'m', '1110':'n', '1111':'o'}

hex       = {'0000':'0', '0001':'1', '0010':'2', '0011':'3',
             '0100':'4', '0101':'5', '0110':'6', '0111':'7',
             '1000':'8', '1001':'9', '1010':'a', '1011':'b',
             '1100':'c', '1101':'d', '1110':'e', '1111':'f'} 

#code to convert from a string of ones and zeros(binary) to decimal number
def bin_to_dec(bin_string):
    l = len(bin_string)
    answer = 0
    for index in range(l):
        answer += int(bin_string[l - index - 1]) * (2**index)
    return answer        

#code to try and ping ip addresses
def ping(ipaddress):
    #ping the network addresses 
    import subprocess

    # execute the code and pipe the result to a string, wait 5 seconds
    test = "ping -t 5 " + ipaddress
    process = subprocess.Popen(test, shell=True, stdout=subprocess.PIPE)

    # give it time to respond
    process.wait()

    # read the result to a string
    result_str = process.stdout.read()

    #For now, need to manually check if the ping worked, fix later
    print result_str   

#now iterate over the permuation and then the boxes to produce the codes
for permute in permutations:
    box_codes = []
    for box in boxes:
        temp_code = ""
        for index in permute:
            temp_code += box[int(index) - 1]
        box_codes.append(temp_code)

    #now manipulate the codes using leter translation, network, whatever

    #binary
    print string.join(box_codes, "")

    #alphabet1
    print string.join( map(lambda x: alphabet1[x], box_codes), "")

    #alphabet2
    print string.join( map(lambda x: alphabet2[x], box_codes), "")

    #hex
    print string.join( map(lambda x: hex[x], box_codes), "")

    #ipaddress, call ping and see who is reachable
    ipcodes = zip(box_codes[0:8:2], box_codes[1:8:2])
    ip = ""
    for code in ipcodes:
        bin = bin_to_dec(code[0] + code[1])
        ip += repr(bin) + "."
    print ip[:-1]
    #ping(ip[:-1])
    print
    print 
```

[t 恤](http://2.bp.blogspot.com/_iQVgmEEAit4/SPkKHA3e8fI/AAAAAAAAAB8/ugUerJjuBw8/s1600-h/GWO-tshirt.jpg)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-04T01:46:39.027

我给网站优化团队发了电子邮件，他们说“没有密码，除非你找到。:)”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T01:11:56.573

我认为谷歌只是想把他们的观点带回家——这里有一堆相同页面的不同表示，测试它们，看看哪个是最好的。

你最喜欢哪个街区？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T01:20:12.190

我认为这*只是*一种设计，没有什么秘密或神秘的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T00:58:21.657

如果它没有任何意义，如果它只是他们想出的一个简洁的设计呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T02:05:50.983

它说：“你越来越近了”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T01:18:59.103

好吧，我看不到直接的模式。但是，如果您正在测试 IP，为什么不将两个 4 块作为单个二进制数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T14:02:38.547

可能它是一个以 4 为基数的符号？

我会尝试这样做，但我对此没有任何办法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-16T00:01:32.467

它让我想起了元胞自动机：

[http://www.wolframalpha.com/input/?i=rule+110](http://www.wolframalpha.com/input/?i=rule+110)

有人朝那个方向走吗？

# asp.net - 在 JavaScript 中访问 asp:hiddenfield 控件

> ID：252222
> 
> 赞同：5
> 
> 时间：2008-10-31T00:14:36.410
> 
> 标签：asp.net, javascript

通过 JavaScript 访问嵌入在 ASP.NET PlaceHolder 控件中的 ASP.NET HiddenField 控件的最佳方法是什么？Visible 属性在初始页面加载时设置为 false，并且可以通过 AJAX 回调进行更改。

这是我当前的源代码：

```
<script language="javascript" type="text/javascript">
    function AccessMyHiddenField()
    {
        var HiddenValue = document.getElementById("<%= MyHiddenField.ClientID %>").value;

        //do my thing thing.....
    }
</script>
<asp:PlaceHolder ID="MyPlaceHolder" runat="server" Visible="false">
    <asp:HiddenField ID="MyHiddenField" runat="server" />
</asp:PlaceHolder> 
```

**编辑：** 如何在 C# 后面的 ascx 代码中设置 div 标签的样式？这是来自后面代码的描述：CssStyleCollection HtmlControl.Style

**更新：**我用 asp:label 替换了 asp:hiddenfield，当我在警报框中显示 HiddenValue 变量时，我得到一个“未定义”。我将如何解决这个问题。

**更新 2：**我继续重构代码，将隐藏字段控件替换为文本框控件，并将样式设置为“显示：无；”。我还删除了 JavaScript 函数（它由 CustomValidator 控件使用）并将其替换为 RequiredFieldValidator 控件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T00:18:55.603

我的理解是，如果您在初始页面加载期间设置 controls.Visible = false，它不会在客户端响应中呈现。我解决您问题的建议是

1.  不要使用占位符，从场景来看，其实不需要占位符，除非需要在服务器端动态添加控件。使用 div，不带 runat=server。您始终可以使用 css 控制该 div 的可见性。
2.  如果以后需要动态添加控件，请使用占位符，但不要设置 visible = false。无论如何，占位符不会有任何显示，使用 css 设置该占位符的可见性。以下是如何以编程方式进行操作：

    placeholderId.Attributes["style"] = "display:none";

无论如何，正如其他人所说，您的问题发生了，因为一旦您设置 control.visible = false，它就不会在客户端响应中呈现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T00:17:33.533

如果 Visibility 设置为 false 服务器端，则不会呈现占位符，并且您将无法从 JavaScript 访问其中的任何内容。当占位符可见 =“true”时，您的代码应该可以工作

摆脱占位符，首先将隐藏字段留空，然后搜索填充它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T05:23:21.390

试试这个：

```
function popup(lid)
{
    var linkid=lid.id.toString();    
    var lengthid=linkid.length-25;    
    var idh=linkid.substring(0,parseInt(lengthid));  
    var hid=idh+"hiddenfield1";

    var gv = document.getElementById("<%=GridViewComplaints.ClientID %>");
    var gvRowCount = gv.rows.length;
    var rwIndex = 1;
    var username=gv.rows[rwIndex].cells[1].childNodes[1].innerHTML;
    var prdid=gv.rows[rwIndex].cells[3].childNodes[1].innerHTML;
    var msg=document.getElementById(hid.toString()).value;
    alert(msg);

    document.getElementById('<%= Labelcmpnme.ClientID %>').innerHTML=username;
    document.getElementById('<%= Labelprdid.ClientID %>').innerHTML=prdid;
    document.getElementById('<%= TextBoxviewmessage.ClientID %>').value=msg;
    return false;
} 
```

```
<ItemTemplate>
    <asp:LinkButton ID="LabelComplaintdisplayitem" runat ="server"   Text='<%#Eval("ComplaintDisp").ToString().Length>5?Eval("ComplaintDisp").ToString().Substring(0,5)+"....":Eval("ComplaintDisp") %>' CommandName ="viewmessage" CommandArgument ='<%#Eval("username")+";"+Eval("productId")+";"+Eval("ComplaintDisp") %>' class='basic' OnClientClick =" return popup(this)"></asp:LinkButton>
    <asp:HiddenField ID="hiddenfield1" runat ="server" Value='<%#Eval("ComplaintDisp")%>'/>
</ItemTemplate> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T00:20:25.913

如果占位符可见性设置为 false，则永远不会被渲染，隐藏字段值只会存储在页面的 ViewState 中。

只是一个问题，如果占位符包含隐藏字段，为什么要将占位符的可见性设置为 false ？

无论如何，解决此问题的一种可能方法是添加一个 TextBox 或 Label 对象，并将其显示 CSS 样式设置为 "none" ，然后在您的代码中复制您在隐藏字段中放入文本框/标签文本的任何内容属性，这样您就可以使用 javascript 轻松读取值，因为文本框/标签将被呈现但对其他人不可见，尽管这可能不是那么安全的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T00:25:04.280

而不是制作“.visible=false”，而是将样式更改为“display: none;”。这将呈现您的控件，但使其不可见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T00:22:29.717

Visible 实际上并不使其可见，您可以将其保留为默认值。只需 runat="server" 并使用它的 .Value。

# windows - 签署 Windows EXE 文件

> ID：252226
> 
> 赞同：244
> 
> 时间：2008-10-31T00:17:14.687
> 
> 标签：windows, certificate, exe, sign

我有一个我想签名的[EXE文件，这样 Windows 就不会警告最终用户有关来自“未知发布者”的应用程序。](http://en.wikipedia.org/wiki/EXE)我不是 Windows 开发人员。有问题的应用程序是从生成屏幕保护程序应用程序的应用程序生成的屏幕保护程序。因此，我对文件的生成方式没有影响。

我已经发现我需要来自像[Verisign](https://en.wikipedia.org/wiki/Verisign)或 instantssl.com这样的[CA的](https://en.wikipedia.org/wiki/Certificate_authority)[代码签名](https://en.wikipedia.org/wiki/Code_signing#Trusted-Library_Attribute)证书。我不明白的是我需要做什么（如果可能的话）来签署我的 EXE 文件。什么是简单的解释？

梅尔格林的回答让我走得更远，但 signtool 希望我指定在任何情况下都使用什么证书。我可以以某种方式获得免费的代码签名证书来测试这是否对我有用吗？

另请指定哪种证书类型是正确的。大多数网站只提到“代码签名”，并谈论对用户实际编译的应用程序进行签名。这不是我的情况。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-10-31T00:32:58.743

您可以尝试使用[微软的签名工具](http://msdn.microsoft.com/en-us/library/aa387764.aspx)

您可以将它作为适用于 Windows Server 2008 和 .NET 3.5 的 Windows SDK 的一部分下载。下载后，您可以从命令行使用它，如下所示：

> signtool sign /a MyFile.exe

这使用可用的“最佳证书”签署单个可执行文件。（如果您没有证书，则会显示 SignTool 错误消息。）

或者您可以尝试：

> 标志工具标志向导

这将启动一个向导，引导您完成对应用程序的签名。（此选项在 Windows SDK 7.0 之后不可用。）

* * *

如果您想获得可用于测试签署可执行文件的过程的证书，您可以使用 .NET 工具*Makecert*。

[证书创建工具 (Makecert.exe)](http://msdn.microsoft.com/en-us/library/bfsktky3(v=vs.80).aspx)

一旦您创建了自己的证书并使用它来签署您的可执行文件，您需要手动将其添加为您机器的受信任的根 CA，以便[UAC](http://en.wikipedia.org/wiki/User_Account_Control)告诉运行它的用户它来自受信任的来源。**重要**。*[将证书安装为 ROOT CA 会危及您的用户隐私。看看戴尔发生了什么。](http://www.computerworld.com/article/3008113/security/dell-installs-self-signed-root-certificate-on-laptops-endangers-users-privacy.html)*您可以在代码中和通过 Windows 中找到更多信息来完成此操作：

*   堆栈溢出问题*[将证书安装到 C# 中的 Windows 本地用户证书存储中](https://stackoverflow.com/questions/308554)*

*   [在 Windows Vista 中将自签名证书安装为受信任的根 CA](http://blogs.technet.com/b/sbs/archive/2007/04/10/installing-a-self-signed-certificate-as-a-trusted-root-ca-in-windows-vista.aspx)

希望这可以为任何尝试这样做的人提供更多信息！

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2018-04-06T15:41:27.227

我在工作中遇到了同样的情况，这是我们的发现

您要做的第一件事是**获取证书**并将其安装在您的计算机上，您可以从**证书颁发机构购买一个或使用****makecert**生成一个。

这是2个选项的优缺点

**购买证书**

*   **优点**
    *   使用由 CA（证书颁发机构）颁发的证书将确保 Windows 不会警告最终用户有关使用 CA 证书的任何计算机上来自“未知发布者”的应用程序（操作系统通常带有来自许多 CA 的根证书)
*   **缺点：**
    *   从 CA 获得证书是有成本的

        有关价格，请参阅[https://cheapsslsecurity.com/sslproducts/codesigningcertificate.html](https://cheapsslsecurity.com/sslproducts/codesigningcertificate.html)和[https://www.digicert.com/code-signing/](https://www.digicert.com/code-signing/)

**使用 Makecert 生成证书**

*   **优点：**
    *   这些步骤很简单，您可以与最终用户共享证书
*   **缺点：**
    *   最终用户将不得不在他们的机器上手动安装证书，这取决于您的客户端，这可能不是一个选项
    *   使用 makecert 生成的证书通常用于开发和测试，而不是生产

**签署可执行文件**

有两种方法可以对您想要的文件进行签名：

*   使用安装在计算机上的证书

    `signtool.exe sign /a /s MY /sha1 sha1_thumbprint_value /t http://timestamp.verisign.com/scripts/timstamp.dll /v "C:\filename.dll"`

    *   在此示例中，我们使用存储在 Personal 文件夹中的证书和 SHA1 指纹（此指纹来自证书）对位于的文件进行签名`C:\filename.dll`
*   使用证书文件

    `signtool sign /tr http://timestamp.digicert.com /td sha256 /fd sha256 /f "c:\path\to\mycert.pfx" /p pfxpassword "c:\path\to\file.exe"`

    *   在此示例中，我们使用`c:\path\to\mycert.pfx`带有密码的证书`pfxpassword`对文件进行签名`c:\path\to\file.exe`

**测试您的签名**

*   方法一：使用signtool

    转到：*开始>运行*
    类型`CMD`>单击*确定*
    在命令提示符下，输入`signtool`存在的目录
    运行以下命令：

    `signtool.exe verify /pa /v "C:\filename.dll"`

*   方法 2：使用 Windows

    右键单击签名文件
    选择*属性*
    选择*数字签名*选项卡。签名将显示在*签名列表*部分。

我希望这可以帮助你

资料来源：

*   [https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537361(v=vs.85)](https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537361(v=vs.85))

*   [https://www.digicert.com/kb/code-signing/signcode-signtool-command-line.htm](https://www.digicert.com/kb/code-signing/signcode-signtool-command-line.htm)

*   [https://docs.microsoft.com/en-us/windows/win32/seccrypto/makecert](https://docs.microsoft.com/en-us/windows/win32/seccrypto/makecert)

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-09-18T21:24:37.300

如果您正在进行开源开发，您可以 [从 Certum](https://www.certum.eu/certum/cert,offer_en_open_source_cs.xml)获得~~免费~~的廉价代码签名证书。

我已经使用他们的证书一年多了，它确实摆脱了来自 Windows 的未知发布者消息。

至于签名代码，我使用如下脚本中的[signtool.exe](http://msdn.microsoft.com/en-us/library/aa387764.aspx)：

```
signtool.exe sign /t http://timestamp.verisign.com/scripts/timstamp.dll /f "MyCert.pfx" /p MyPassword /d SignedFile.exe SignedFile.exe 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-11-27T13:03:40.673

The ASP's magazine ASPects has a detailed description on how to sign code (You have to be a member to read the article). You can download it through [http://www.asp-shareware.org/](http://www.asp-shareware.org/)

Here's link to a description how you can [make your own test certificate](http://www.pantaray.com/signcode.html).

[This](http://www.wintellect.com/blogs/jrobbins/code-signing-it-s-cheaper-and-easier-than-you-thought) might also be interesting.

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-02-21T07:03:49.023

如果您需要在 Linux 机器上签署可执行文件，另一种选择是使用[Mono 项目工具](http://www.mono-project.com/docs/tools+libraries/tools/)中的**signcode**。它[在 Ubuntu 上受支持](http://manpages.ubuntu.com/manpages/trusty/en/man1/signcode.1.html)。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-02-08T10:26:34.503

参考[https://steward-fu.github.io/website/driver/wdm/self_sign.htm](https://steward-fu.github.io/website/driver/wdm/self_sign.htm) 注意：signtool.exe 来自 Microsoft SDK

1.第一次（制作私人证书）

Makecert -r -pe -ss YourName YourName.cer

certmgr.exe -add YourName.cer -s -r localMachine root

2.After（将您的标志添加到您的应用程序）

signtool sign /s YourName YourApp.exe

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2019-10-25T13:29:57.123

这不是对这个问题的直接回答，但它是密切相关的（我希望是有用的），因为迟早任何个人程序员都会把手伸进钱包。

因此，EV（扩展验证）代码签名证书的价格，按价格排序：

[**关于SSL**](https://aboutssl.org/cheap-ev-code-signing-certificate-providers/)
$240/年（点击诱饵价格）
$287/年（实际价格，优惠券后）

[**KSoftware.net**](http://www.ksoftware.net)
1 年 350 美元 +（50 美元隐藏费用！）
2 年 600 美元
3 年 750 美元
（OV：每年 84 美元）
我从他们那里购买的。eToken 是通过 U 盘发送的。无需阅读器。他们只是中介。最后，您实际上是从 Comodo (Sectigo) 购买的。他们非常缓慢（可能是因为中间人）！

[**Sklep.certum.pl**](https://en.sklep.certum.pl/data-safety/code-signing-certificates.html)
1 年 379 欧元
（似乎仅适用于波兰用户）

[**LeaderSsl.de**](https://www.leaderssl.de/en?fltr_check_type=ev#ssl-filter-block)
1 年 364 欧元或 307 欧元 (+19%VAT)
(OV 69+VAT)

[**Sectigo.com**](https://store.sectigo.com)
1 年 499 美元
3 年 897 美元

[**GlobalSign.com**](https://www.globalsign.com/en/code-signing-certificate/ev-code-signing-certificates/)
1 年总计 410 美元
2 年总计 760
美元 3 年总计 950 美元

[**Digicert.com**](https://www.digicert.com/friends/sysdev/)
1 年：600 美元（原为 104 美元）
3 年：？

**symantec.com**
1 年：700 美元
3 年：贵得离谱

更多价格：
[cheapsslsecurity.com CodeSigning EV](https://cheapsslsecurity.com/sslproducts/codesigningcertificate.html)
[Cheapsslsecurity.com 仅限 SSL！](https://cheapsslsecurity.com/sslproducts/organizationvalidatedssl.html)

* * *

**EV 与 OV**

使用 EV，还需要 9 个额外步骤，包括验证企业的公共电话号码、营业时间、注册号和管辖权，以及域名欺诈检查、联系人黑名单检查和电话呼叫以验证企业的就业状态请求者。

[有些人](https://support.ksoftware.net/support/solutions/articles/215894-what-is-this-file-is-not-commonly-downloaded-and-could-harm-your-computer-message-smartscreen-)建议将使用 OV 签名的程序提交给 Microsoft，以使用他们的防病毒软件进行检查。

* * *

如果您发现更便宜的价格，请告诉我，我会更新列表！

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-06-16T11:24:54.590

还有另一种选择，如果你在 Windows 10 上开发但没有安装 Microsoft 的 signtool.exe，你可以在 Windows 上使用 Bash on Ubuntu 来签署你的应用程序。这是一个失败：

[https://blog.synapp.nz/2017/06/16/code-signing-a-windows-application-on-linux-on-windows/](https://blog.synapp.nz/2017/06/16/code-signing-a-windows-application-on-linux-on-windows/)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-03-28T04:43:40.117

使用以下链接对 .exe（安装程序/安装程序）文件进行签名（在不使用 Microsoft 安装程序签名工具的情况下签署 exe/安装程序文件）

[https://ebourg.github.io/jsign/#files](https://ebourg.github.io/jsign/#files)

示例命令 java -jar jsign-2.0.jar --keystore keystore.jks" --alias 别名 --storepass 密码 MyInstaller.exe

为我工作:)

# indexing - 如何将重叠的 id 系统统一为一个系统？

> ID：252229
> 
> 赞同：1
> 
> 时间：2008-10-31T00:17:40.193
> 
> 标签：indexing

在保持旧的 id 系统的同时将几个重叠的 id 系统统一为一个统一的系统的最佳方法是什么。

我的网站上有几个不同的 id...（例如 /publisher/1234 和 /designer/1234） 我想将这些 id 统一到一个新系统中，但想保留旧系统的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T00:25:01.100

桥牌桌

```
column newId
column oldId 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T00:56:13.453

@Steven A. Lowe 的回答肯定是最简单、对现有应用程序影响最小的。

只是为了微笑和咯咯笑，让我们假设您可能还想对模式进行其他更改（新表、新列）。

在组合任何东西之前，我会仔细查看表格 - 确保表格所代表的实体/关系是清晰和规范的。如果`publisher`和`designer`真的是同一个东西，同一个实体，那么可能需要一个将两者结合起来的新表。

因此，使用新的唯一 ID 创建新表。然后有几种方法可以将此 id 关联回原始表。构建“历史”（它的来源和旧 ID）将需要几列，最好是在一个单独的表中（因为它们真的不是“关于”新表，对吧？），但他们可以包含在新表定义中。

就像是

```
new table
   column newId
   .
   .
   .
   column oldTableName
   column oldId 
```

或者

```
new table
   column newId
   .
   .
   .

join table
   column newId
   column oldTableName
   column oldId 
```

然后，您可以创建一个或多个视图，将旧表结构呈现给现有应用程序。

```
create view oldTable id, [...] as
   select oldId, newTable.col1, newTable.col2
    where oldTableName = 'oldTable 
```

还有其他方法可以合并 id，但这里描述的两种可能就足够了。

# sql - 存储过程还是内联查询？

> ID：252230
> 
> 赞同：4
> 
> 时间：2008-10-31T00:17:40.257
> 
> 标签：sql, stored-procedures, subsonic

首先，对此有一个[部分问题](https://stackoverflow.com/questions/59880/are-stored-procedures-more-efficient-in-general-than-inline-statements-on-moder)，但这并不是我要问的，所以，请耐心等待。

我的问题是，在查看了[SubSonic](http://subsonicproject.com/)的功能以及 Rob Connery 的精彩视频之后，我需要问：**我们应该使用这样的工具并进行内联查询，还是**应该**使用对****存储过程**的调用来进行查询？

 **我不想最小化 Rob 的任何工作（我认为这很了不起），但我只是想听听你对此的看法，因为我需要开始一个新项目，而且我处于中间位置；我应该使用 SubSonic（或其他类似的工具，如 NHibernate）还是我只是继续我的方法，它总是调用存储过程，即使它很简单

```
Select this, that from myTable where myStuff = StackOverflow; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T00:19:42.763

它不需要是一个或另一个。如果是简单查询，请使用 SubSonic 查询工具。如果它更复杂，请使用存储过程并加载集合或根据结果创建数据集。

请参阅此处：[将 SQL 保留在存储过程与代码中的优缺点是什么，](https://stackoverflow.com/questions/15142/what-are-the-pros-and-cons-to-keeping-sql-in-stored-procs-versus-code)以及此处的[SubSonic 和存储过程](https://stackoverflow.com/questions/228175/subsonic-and-stored-procedures)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T00:20:08.770

[在此处](https://stackoverflow.com/questions/15142/what-are-the-pros-and-cons-to-keeping-sql-in-stored-procs-versus-code)和[此处](https://stackoverflow.com/questions/59880/are-stored-procedures-more-efficient-in-general-than-inline-statements-on-moder)查看答案。我尽可能使用存储过程，除非繁文缛节意味着需要一周时间才能将其放入数据库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T01:08:51.057

当您有多个依赖于同一个数据库的应用程序时，存储过程是黄金。它让您定义和维护查询逻辑一次，而不是几个地方。

另一方面，存储过程本身很容易在数据库中变得一团糟，因为大多数系统都没有很好的方法来对它们进行逻辑组织。而且它们可能更难以版本化和跟踪更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T00:26:11.207

我个人不会遵循严格的规则。当然，在开发阶段，您希望能够快速更改您的查询，因此我会将它们内联。

稍后，我将转向存储过程，因为它们具有以下两个优点。我敢肯定还有更多，但这两个赢得了我的支持。

1/ 存储过程将数据和用于操作/提取数据的代码组合在一个点上。这使您的 DBA 的生活变得更加轻松（假设您的应用程序足够大以保证 DBA），因为它们可以根据已知因素进行优化。

DBA 的一大难题是即席查询（尤其是那些不知道全表扫描是什么的小丑）。DBA 更喜欢有很好的一致查询，他们可以调整数据库。

2/ 存储过程可以包含最好留在数据库中的逻辑。我在 DB2/z 中看到存储过程有几十行，但所有客户端必须编写的代码只有一行，例如“给我那个列表”。

因为“那个列表”的逻辑存储在数据库中，所以 DBA 可以随意修改它的存储和提取方式，**而不会**影响或更改客户端代码。这类似于使面向对象语言比以前更“干净”的封装。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T01:25:07.170

我已经完成了内联查询和存储过程的混合。我更喜欢存储过程/视图方法，因为它可以让您在需要时进行更改。当您有内联查询时，您总是必须更改代码以更改内联查询，然后重新滚动应用程序。您还可能在多个位置使用内联查询，因此您必须更改比使用一个存储过程更多的代码。

再说一次，如果您必须向存储过程添加参数，那么您仍然会更改很多代码。

另一个注意事项是存储过程背后的数据更改频率，在我工作的地方，我们有可能分解为规范化表的第三方表，或者表变得过时。在这种情况下，存储过程/视图可以最大限度地减少您对该更改的暴露。

我还编写了一个没有存储过程的整个应用程序。它有 3 个类和 10 页，根本不值得。我认为它的过度杀伤力或可以证明是有道理的，但这也归结为您的个人意见和偏好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T02:00:40.267

您是否只打算从那个应用程序访问您的数据库？

如果没有，那么您最好使用存储过程，这样您就可以拥有与数据库一致的接口。

如果您需要进行更改，分发您的应用程序是否有任何重大成本？

如果是这样，那么您最好使用可以在服务器上更改的存储过程，并且这些更改不需要分发。

您是否担心数据库的安全性？

如果是这样，那么您可能希望使用存储过程，这样您就不必向用户授予对表的直接访问权限。

如果您正在为一个不会在您的应用程序之外使用或访问的系统编写一个没有广泛受众的小型应用程序，那么内联 SQL 可能没问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T04:27:08.427

我更喜欢内联 sql，除非存储过程涉及实际逻辑（变量、游标等）。我最近一直在使用 LINQ to SQL，并获取生成的类并添加具有一些预定义的常见 linq 查询的部分类。我觉得这有助于更快的发展。

*编辑：我知道我会为此而降级。如果你曾经谈论过外键或存储过程，你就会被贬低。DBA 需要工作保障，我猜...*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T16:25:09.097

使用 Subsonic，您将使用内联、视图和存储过程。亚音速使数据访问更容易，但您不能在亚音速查询中做任何事情。虽然是最新版本，但 2.1 正在变得更好。

对于基本的 CRUD 操作，内联 SQL 将是直截了当的。对于更复杂的数据需求，需要创建一个视图，然后您将对视图执行 Subsonic 查询。

存储过程适用于更难的数据计算和数据检索。基于集合的检索通常总是比程序处理更快。

当前的 Subsonic 应用程序使用所有三个选项，效果很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-08T05:04:43.640

1.  存储过程将数据和用于操作/提取该数据的代码组合在一个点上。这使您的 DBA 的生活变得更加轻松（假设您的应用程序足够大以保证 DBA），因为它们可以根据已知因素进行优化。

2.  存储过程可以包含最好留在数据库中的逻辑。我在 DB2/z 中看到存储过程有几十行，但所有客户端必须编写的代码只有一行，例如“给我那个列表”。

3.  我发现使用存储过程的最大优势是，当我们想要更改逻辑时，在内联查询的情况下，我们需要去每个地方并更改它并重新滚动每个应用程序，但在存储过程的情况下更改是只需要在一个地方。

所以当你有清晰的逻辑时使用内联查询；否则更喜欢存储过程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-08T21:01:44.427

存储过程的优点（在我看来）

1.  SQL 在一个地方
2.  您可以获得查询计划。
3.  如有必要，您可以修改数据库结构以提高性能
4.  它们是经过编译的，因此这些查询计划不必即时构建
5.  如果您使用权限 - 您可以确定应用程序将进行的查询。

# ruby - Ruby 音频库

> ID：252239
> 
> 赞同：7
> 
> 时间：2008-10-31T00:24:45.140
> 
> 标签：ruby, audio, mp3

有没有我们可以构建的好的 Ruby 音频库？

需要管理/编辑 mp3 文件！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T00:34:54.947

有一个 C++ mp3 编辑器的[接口](http://rubyforge.org/projects/id3lib-ruby/)，以及一个活跃的[纯 ruby](http://rubyforge.org/projects/ruby-mp3info)​​ 项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T19:55:17.140

[ruby-audio](https://github.com/warhammerkid/ruby-audio) 是目前最好的，它是[libsndfile的包装器](http://www.mega-nerd.com/libsndfile/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-16T12:02:08.183

还有[耳虫](http://icanhasaudio.com/)和[icanhasaudio](https://rubygems.org/gems/earworm)可能很有趣......

# sql - 在 django 中，如何对字段上的模型进行排序，然后获取最后一项？

> ID：252242
> 
> 赞同：21
> 
> 时间：2008-10-31T00:26:09.257
> 
> 标签：sql, django, sorting, django-models

具体来说，我有一个模型，它有一个像这样的字段

```
pub_date = models.DateField("date published") 
```

我希望能够轻松抓取最新的对象`pub_date`。最简单/最好的方法是什么？

像下面这样的东西会做我想要的吗？

```
Edition.objects.order_by('pub_date')[:-1] 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-31T00:34:02.047

```
obj = Edition.objects.latest('pub_date') 
```

您还可以通过放入[`get_latest_by`](http://docs.djangoproject.com/en/dev/ref/models/options/#get-latest-by)模型的 Meta 来简化事情，然后您就可以做到

```
obj = Edition.objects.latest() 
```

有关更多信息，请参阅[文档](http://docs.djangoproject.com/en/dev/ref/models/querysets/#latest-field-name-none)。您可能还想设置[`ordering`](http://docs.djangoproject.com/en/dev/ref/models/options/#ordering)Meta 选项。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-31T01:59:17.337

哈雷的回答是根据特定模型的某些订购标准想要最新的情况，但一般的解决方案是颠倒顺序并检索第一项：

```
Edition.objects.order_by('-pub_date')[0] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-31T03:01:01.783

**笔记：**

普通的 python 列表接受负索引，它表示从列表末尾的偏移量，而不是像正数一样的开头。但是，QuerySet 对象会引发

```
AssertionError：不支持负索引。
```

如果您使用负索引，这就是为什么您必须执行 insin 所说的：反转排序并获取`0th`元素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-02T19:26:59.963

小心使用

```
Edition.objects.order_by('-pub_date')[0] 
```

因为您可能正在索引一个空的 QuerySet。我不确定正确的 Pythonic 方法是什么，但最简单的方法是将其包装在 if/else 或 try/catch 中：

```
try:
    last = Edition.objects.order_by('-pub_date')[0]
except IndexError:
    # Didn't find anything... 
```

但是，正如@Harley 所说，当您按日期订购时，这`latest()`是 django 的*方式*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-31T06:53:41.230

这已经得到了回答，但为了获得更多参考，这是[Django Book](http://www.djangobook.com/en/2.0/chapter05.html)关于在 QuerySets 上切片数据的内容：

> 请注意，不支持负切片：
> 
> ```
> >>> Publisher.objects.order_by('name')[-1]
> Traceback (most recent call last):
>   ...
> AssertionError: Negative indexing is not supported. 
> ```
> 
> 不过，这很容易解决。只需更改 order_by() 语句，如下所示：
> 
> ```
> >>> Publisher.objects.order_by('-name')[0] 
> ```

有关更多此类详细信息，请参阅链接。希望有帮助！

# java - 你如何在 .net 上运行 Lucene？

> ID：252249
> 
> 赞同：9
> 
> 时间：2008-10-31T00:34:15.697
> 
> 标签：java, .net, search, indexing, lucene

Lucene 是一个优秀的搜索引擎，但是 .NET 版本落后于官方 Java 版本（.NET 最新的稳定版本是 2.0，但是最新的 Java Lucene 版本是 2.4，它有更多的功能）。

你如何解决这个问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-31T00:37:59.280

我发现的一种令人惊讶的方法可能会奏效：从 Java .jar 文件创建一个 .NET DLL！使用[IKVM](http://www.ikvm.net/)，您可以[下载 Lucene](http://www.apache.org/dyn/closer.cgi/lucene/java/)，获取 .jar 文件，然后运行：

```
ikvmc -target:library <path-to-lucene.jar> 
```

它会生成一个这样的 .NET dll：lucene-core-2.4.0.dll

然后，您可以从项目中引用此 DLL，一切顺利！您将需要一些 java 类型，因此还要参考 IKVM.OpenJDK.ClassLibrary.dll。您的代码可能看起来有点像这样：

```
QueryParser parser = new QueryParser("field1", analyzer);
java.util.Map boosts = new java.util.HashMap();
boosts.put("field1", new java.lang.Float(1.0));
boosts.put("field2", new java.lang.Float(10.0));

MultiFieldQueryParser multiParser = new MultiFieldQueryParser
                      (new string[] { "field1", "field2" }, analyzer, boosts);
multiParser.setDefaultOperator(QueryParser.Operator.OR);

Query query = multiParser.parse("ABC");
Hits hits = isearcher.search(query); 
```

我从来不知道您可以如此轻松地实现 Java 到 .NET 的互操作性。最好的部分是 C# 和 Java“几乎”源代码兼容（涉及 Lucene 示例）。只需替换`System.Out`为`Console.Writeln`:)。

=======

更新：在构建像 Lucene 荧光笔这样的库时，请确保您引用了核心程序集（否则您会收到有关缺少类的警告）。所以荧光笔是这样构建的：

```
ikvmc -target:library lucene-highlighter-2.4.0.jar -r:lucene-core-2.4.0.dll 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T00:45:48.530

下载源代码并构建它。我上周末才这样做，这很容易。完全没有问题。源代码为 2.3.1 版本。

我订阅了邮件列表，从中判断，Lucene.Net 正在积极开发中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T12:04:28.970

Lucene.net 正在开发中，现在有三个提交者

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T07:25:58.957

我通过这种方式将 Lucene 2.4 从 jar 转换为 dll，但现在它给了我一个错误“找不到类型或命名空间 Lucene”。我从项目中删除了旧的 dll，并为新的 dll 添加了参考。我真的很想摆脱旧版本，因为它花了大约 2 天时间，最后在优化过程中出现了一些错误，现在索引不可更新：S。我在某处读到 Lucene 2.4 的索引速度比旧版本快很多倍，如果我使用 SVN 的 2.3.1 会更快吗？

# html - 我怎样才能约束一个 的宽度到最宽项目的宽度？

> ID：252252
> 
> 赞同：16
> 
> 时间：2008-10-31T00:36:16.520
> 
> 标签：html, css

给定以下标记：

```
<ul>
   <li>apple</li>
   <li class="highlight">orange</li>
   <li>pear</li>
</ul> 
```

`ul`s 和`li`s 的宽度似乎都是 100% 。如果我将 a`background-color`应用于列表项，则突出显示会拉伸页面的整个宽度。

我只希望背景突出显示与最宽的项目一样宽（可能有一些填充）。如何将`li`s（或者可能是`ul`s）宽度限制为最宽项的宽度？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-31T00:56:29.117

添加`ul {float: left; }`样式将强制您的列表进入首选宽度，这是您想要的。

问题是，您应该确保下一个元素像以前一样位于列表下方。清算应该照顾到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T00:40:17.167

你能这样吗？

```
<ul>
   <li>apple</li>
   <li><span class="highlight">orange</span></li>
   <li>pear</li>
</ul> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T01:13:44.807

正如 BoltBait 所说，将您的文本包装在一个内联元素中，例如`span`并给出该类。

```
<ul>
    <li>apple</li>
    <li><span class="highlight">orange</span></li>
    <li>pear</li>
</ul> 
```

我额外的 2 美分是，如果您无权更改 HTML，则可以使用 Javascript 进行更改。在 jQuery 中：

```
$('li.highlight').wrapInner("<span></span>"); 
```

并使用 CSS：

```
li.highlight span { background-color: #f0f; } 
```

* * *

编辑：重新阅读您的问题后，您能否澄清一下：您是否希望突出显示仅与突出显示的元素一样宽，还是与列表中最宽的元素一样宽？例如：

```
    - 短的
    - 项目 ********************
    - 这里
    - 然后是一个很长的

```

...星号代表突出显示。如果是这样，那么 buti-oxa 的答案是最简单的方法。只是要小心清除你的花车。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T16:44:02.903

添加`style="float: left;"`到`ul`将导致`ul`仅与最宽的项目一样宽。但是，下一个元素将放置在它的右侧。添加`style="clear: left;"`到下一个元素会将下一个元素放在`ul`.

[试试看](http://jsfiddle.net/w07hn13s/)

请参阅和的[文档](http://www.w3schools.com/css/css_float.asp)。`float``clear`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-08T23:34:54.417

在不破坏现有布局样式的情况下解决此问题的最佳方法是将`ul`and包装`li`在`div`with`display: inline-block`

```
 <div id='dropdown_tab' style='display: inline-block'>dropdown
        <ul id='dropdown_menu' style='display: none'>
            <li>optoin 1</li>
            <li>optoin 2</li>
            <li id='option_3'>optoin 3
                <ul id='dropdown_menu2' style='display: none'>
                    <li>second 1</li>
                    <li>second 2</li>
                    <li>second 3</li>
                </ul>
            </li>
        </ul>
    </div> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-12-10T15:34:24.170

不幸的是，现有的答案都没有提供正确的解决方案。它们的范围从滥用`float`属性到完全重构您的 HTML，这通常是不可行的。

该[`<ul>`](https://www.w3.org/TR/2011/WD-html-markup-20110113/ul.html#ul-display)元素具有`display: block;`其默认[`display`](https://www.w3.org/TR/css-display-3/#valdef-display-block)属性，导致宽度填充其容器的 100%。

要更改此方面并仍保留 a`<ul>`显示方式的所有其他默认属性（例如，避免`float`其他答案出现问题），请应用于`display: inline-block;`列表：

```
ul {
    display: inline-block;
    background-color: green;
}
.highlight {
    background-color: orange; /* for demonstration */
    padding: 15px; /* for demonstration */
}
```

```
<ul>
   <li>apple</li>
   <li class="highlight">orange</li>
   <li>pear</li>
   <li>banana</li>
</ul>
```

# c# - 为什么默认情况下不密封类？

> ID：252257
> 
> 赞同：32
> 
> 时间：2008-10-31T00:38:58.433
> 
> 标签：c#, inheritance, sealed

我只是想知道，既然**密封**关键字的存在表明它是类作者的决定，是否允许其他类从它继承，为什么默认情况下不密封类，用一些关键字将它们显式标记为可扩展？

我知道这有些不同，但访问修饰符以这种方式工作。默认设置是限制性的，只有插入关键字才能授予更全面的访问权限。

不过，我很有可能没有正确考虑到这一点，所以请保持人道！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-31T06:26:29.387

我会说这只是一个错误。我认识很多人（包括我自己）认为课程确实应该默认密封。那个阵营的 C# 设计团队中至少有几个人。自从 C# 最初设计以来，钟摆已经在某种程度上偏离了继承。（当然，它有它的位置，但我发现自己很少使用它。）

对于它的价值，这并不是与 Java 太接近的唯一错误：我个人宁愿 Equals 和 GetHashCode 不在对象中，并且您也需要特定的 Monitor 实例来锁定......

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-31T06:37:07.463

**在我看来**，不应该有默认语法，这样你总是可以明确地写出你想要的东西。这迫使编码人员理解/思考更多。

如果你想让一个类是可继承的，那么你写

```
public extensible class MyClass 
```

除此以外

```
public sealed class MyClass 
```

顺便说一句，我认为访问修饰符也应该如此，不允许默认访问修饰符。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-31T00:44:53.070

继承是 OO 的基本原则，因此可以说，默认情况下不允许它是不直观的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-31T02:35:23.473

您可能会提出尽可能多的论点来支持默认密封，因为您可以反对它。如果反过来，就会有人发布相反的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-31T00:45:52.057

我不记得听说过默认情况下不密封类的决定的理由。但是，肯定有不少人认为 C# 应该被指定为默认密封：

[http://codebetter.com/blogs/patricksmacchia/archive/2008/01/05/rambling-on-the-sealed-keyword.aspx](http://codebetter.com/blogs/patricksmacchia/archive/2008/01/05/rambling-on-the-sealed-keyword.aspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-31T00:52:35.067

密封类*防止继承*，因此是一种面向对象的厌恶。有关详细信息，请参阅[此咆哮](https://stackoverflow.com/questions/2134/do-sealed-classes-really-offer-performance-benefits#202584)；-)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-31T02:56:54.427

仅仅从一个未密封的类派生不会改变类的行为。可能发生的最坏情况是基类的新版本将添加一个与派生类同名的成员（在这种情况下，只会出现一个编译器警告，提示您应该使用*new*或*override*修饰符）或基类类是密封的（如果该类已经被释放到野外，这是一个设计禁忌）。任意子类化仍然符合[Liskov 替换原则](http://www.eventhelix.com/RealtimeMantra/Object_Oriented/liskov_substitution_principle.htm)。

在 C# 中默认情况下成员不可重写的原因是因为重写方法可以以基类作者未预料到的方式更改基类的行为。通过使其明确抽象或虚拟，意味着作者意识到它可以改变或超出他们的控制范围，作者应该考虑到这一点。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-31T07:12:41.823

Word 的 80% 的功能未被使用。80% 的类不会被继承。在这两种情况下，偶尔会有人出现并想要使用或重用某个功能。为什么原设计者要禁止重复使用？让重用者决定他们想要重用什么。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-31T07:53:40.960

出于同样的原因，默认情况下对象不是私有的

或者

与对象类比一致，即对象默认不是私有的

只是猜测，因为归根结底这是一种语言的设计决定，而创作者所说的是佳能材料。

# java - SSH 的 java.sql.Connection 扩展

> ID：252258
> 
> 赞同：10
> 
> 时间：2008-10-31T00:40:11.303
> 
> 标签：java, mysql, jdbc, ssh, firewall

我在防火墙后面有一个 MySQL 数据库，只能通过 SSH 连接访问。有谁知道 java.sql.Connection 的实现，它允许我与这个数据库建立 SSH 连接？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-31T01:37:06.693

您可以使用 SSH 的端口转发来执行此操作。虽然不是纯 java.sql.Connection，但它允许您通过 ssh 建立隧道连接。

```
ssh -L 3306:localhost:3306 remote.mysql.host.com
```

这会将本地计算机上的端口 3306 转发到 remote.mysql.host.com 上的端口 3306。这将允许您连接到本地计算机上的端口 3306，并将通过隧道连接到 remote.mysql.host.com。

如果您希望在 Java 中完成所有操作，请使用[JSch](http://www.jcraft.com/jsch/)创建 ssh 连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-13T23:52:28.670

这是使用库[sshj的](https://github.com/hierynomus/sshj)[示例](https://github.com/newjam/mysql_ssh_tunnel_example/blob/master/src/main/java/com/github/newjam/test/tunnel/Tunnel.java#L54)。

# vb.net - 对带有可选参数的函数使用 Reflector.Invoke 方法

> ID：252260
> 
> 赞同：0
> 
> 时间：2008-10-31T00:40:55.827
> 
> 标签：vb.net, reflector

我正在尝试使用 reflector.InvokeMethod 来调用带有可选参数的函数。该函数如下所示：

```
Private Function DoSomeStuff(ByVal blah1 as string, ByVal blah2 as string, Optional ByVal blah3 as string = "45") as boolean
'stuff
end function 
```

我像这样调用它：

```
Dim result As Boolean = Reflector.InvokeMethod(AccessModifier.private,obj_of_Class, "DoSomeStuff", Param1, Param2, Param3) 
```

这工作正常，除了当我不传递第三个（可选）参数时，它不会命中函数。

```
Dim result As Boolean = Reflector.InvokeMethod(AccessModifier.private,obj_of_Class, "DoSomeStuff", Param1, Param2) 
```

有没有办法可以使用 Reflector.invokeMethod 来调用这个函数而不传递可选参数？或其他方式来实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T23:06:13.373

Visual Basic 编译器实际上将可选参数值替换为调用代码。因此，如果您的实际代码是：

```
DoSomeStuff(blah1, blah2)
```

Visual Basic 会发出相当于以下内容的 IL 代码：

```
DoSomeStuff(blah1, blah2, "45")
```

要知道最后一个参数是什么，您需要获取对参数对象的引用（我不确定 Reflector 中是什么 - 在 .NET 中，您可以访问 MethodInfo，然后访问 ParameterInfo），然后获取它的自定义属性，寻找标有 OptionalAttribute 和 DefaultParameterValueAttribute 的属性。然后，您需要使用第三个参数调用它，提供来自 DefaultParameterValueAttribute 的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T22:57:33.643

我会重载**DoSomeStuff**方法而不是使用可选参数...

```
Private Overloads Function DoSomeStuff(ByVal blah1 As String, ByVal blah2 As String) As Boolean
    Return DoSomeStuff(blah1, blah2, "45")
End Function

Private Overloads Function DoSomeStuff(ByVal blah1 As String, ByVal blah2 As String, ByVal blah3 As String) As Boolean
    'stuff
End Function 
```

# java - 为什么我不能在同名的匿名类之外调用方法

> ID：252267
> 
> 赞同：2
> 
> 时间：2008-10-31T00:45:21.993
> 
> 标签：java, methods, javac, anonymous-class

最后的代码产生编译错误：

```
NotApplicable.java:7: run() in  cannot be applied to (int)
                run(42);
                ^
1 error 
```

问题是为什么？为什么javac认为我在调用run()，却没有找到run(int bar)？它正确地调用了 foo(int bar)。为什么我必须使用 NotApplicable.this.run(42);？它是一个错误吗？

```
public class NotApplicable {

    public NotApplicable() {
        new Runnable() {
            public void run() {
                foo(42);
                run(42);
                // uncomment below to fix
                //NotApplicable.this.run(42);
            }
        };
    }

    private void run(int bar) {
    }

    public void foo(int bar) {
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-31T01:54:31.793

对代码示例行为的解释是，它`this`被定义为您当前“最”在其中的类。在这种情况下，您在子类 runnable 的匿名内部类中“最多”，并且没有匹配的方法`run(int)`。为了扩大您的搜索范围，您可以通过声明来指定`this`要使用的内容`NotApplicable.this.run(42)`。

jvm 将评估如下：

`this`-> 当前正在执行的`Runnable`with 方法实例`run()`

`NotApplicable.this`-> 当前正在执行的`NotApplicable`with 方法实例`run(int)`

编译器将在嵌套树中查找与方法名称匹配的第一个方法。*–感谢 DJClayworth 的澄清*

匿名内部类不是外部类的子类。由于这种关系，内部类和外部类都应该能够拥有具有完全相同签名的方法，并且最内部的代码块应该能够识别它想要运行的方法。

```
public class Outer{

    public Outer() {
        new Runnable() {
            public void printit() {
                System.out.println( "Anonymous Inner" );
            }
            public void run() {
                printit(); // prints "Anonymous Inner"
                this.printit(); //prints "Anonymous Inner"

                // would not be possible to execute next line without this behavior
                Outer.this.printit(); //prints "Outer" 
            }
        };
    }

    public void printit() {
        System.out.println( "Outer" );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:27:22.770

据我回忆，选择在嵌套类之间运行的方法的规则与选择继承树中的方法的规则大致相同。这意味着我们在这里得到的不是超载，而是隐藏。这些之间的区别对于理解继承中的方法至关重要。

如果您的 Runnable 被声明为子类，则 run() 方法会将 run(int) 方法隐藏在父类中。对 run(...) 的任何调用都会尝试在 Runnable 上执行该调用，但如果它无法匹配签名，则会失败。由于 foo 未在子级中声明，因此调用父级中的 foo。

同样的原理也发生在这里。查找对“方法隐藏”的引用，它应该很清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T00:51:04.743

这是因为在您进入范围`run`时正在重新声明。`new Runnable() {}`所有以前运行的绑定都变得不可访问。就好像你正在这样做：

```
import java.util.*;

public class tmp
{
  private int x = 20;
  public static class Inner
  {
      private List x = new ArrayList();
      public void func()
      {
          System.out.println(x + 10);
      }
  }

  public static void main(String[] args)
  {
    (new Inner()).func();
  }
} 
```

编译器不会一直寻找与`x`作用域堆栈的类型匹配的东西，它只会在找到第一个引用并看到类型不兼容时停止。

**注意：**并不是说它*不能*这样做……只是为了保持你自己的理智，决定不应该这样做。

# java - 保护用户输入（尚未提交）免受会话超时的最佳方法是什么？

> ID：252268
> 
> 赞同：4
> 
> 时间：2008-10-31T00:45:24.163
> 
> 标签：java, web-applications

我开发和维护小型 Intranet Web 应用程序（JSP 和 Resin）。

一些用户需要很长时间才能完成表单，以至于当他们提交时，由于会话超时，他们丢失了所有输入数据。

目前我将会话超时延长到 30 分钟，并在页面顶部显示倒计时时钟，直到会话超时，但是，我认为它们必须是保护用户输入的更好方法。

最佳做法是什么？

* * *

**附录** 我们的用户使用 web-app 制作了几种报告，每个报告的全部内容都存储在一个 JavaBean 中，该 JavaBean 存储在 session 中。

正如一些人所建议的，Ajax 或 iframe 应该做快速修复。

我现在知道最好不要滥用重物会话，但我不确定如何最好地重构当前的混乱。有人建议让 web-app*无状态*。欢迎任何关于重构的建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T01:20:25.573

您的框架可能会或可能不会出现这种情况，但我认为如果您的页面仅使用 AJAX 每五分钟（或其他任何时间）调用一次服务器，那么这将使您的用户会话保持活动状态。您甚至不必以这种方式对表单进行部分保存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T01:22:33.977

在服务器端使您的应用程序无状态。您可以在隐藏的输入字段中包含您需要维护的任何状态。如果安全是一个问题，那么您可以在将数据放入现场之前对其进行加密。

一个例子是在你的表单中加入这样的东西：

```
<input type="hidden" name="user" value="bob" />
<input type="hidden" name="currentRecordId" value="2345" />
<input type="hidden" name="otherStuff" value="whocares" /> 
```

这样做的主要优点是您的 Web 应用程序可以仅使用该页面完成所需的一切。它不需要任何会话变量，因为它需要的一切都在它刚刚收到的页面中。现在，他们需要多长时间并不重要，因为没有会话到期。

第二个优点是它减少了服务器上的负载，因为它不会定期轮询您的用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T01:41:07.513

如果您正在为有限数量的用户（例如，公司内部网）创建应用程序，并且您不希望人们必须整天保持登录或让他们在长时间坐着时丢失输入信息，您可以只为浏览器打开到您的网站的人无限期地保持会话打开，而无需将会话超时设置为不过期。一旦他们关闭网站，会话就会正常过期。

您需要做的是在页面某处添加一个隐藏的 iframe。让 iframe 指向由您的应用服务器提供的简单 html 文档，其中包含每 29 分钟刷新一次的元标记（对于在 30 分钟内到期的会话）。这样，只要该人打开您的网页，他们的会话就不会过期。但是，当他们离开您的网站时，它将照常过期。您可以获得无限的会话长度，而不会出现会话失控的不利影响。

我在以前工作的企业环境中成功地部署了这个解决方案。Web 应用程序取代了旧的绿屏应用程序，例如，让他们去吃午饭并让应用程序在他们身上过期是不可接受的。

如果您需要更多示例，请告诉我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T00:55:53.423

我只是最近才需要看看这个问题的解决方案。

看起来最有希望的方向是使用 AJAX 定期检查是否输入了数据，并将其发送到服务器。如果您公司中运行的浏览器支持 AJAX，这是一种可能性。

另一种可能的解决方案是将表单拆分，以便每个部分都足够小，可以在会话超时内填写和提交。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T02:03:52.600

我建议您寻找一种无状态的替代方案（不依赖会话属性的东西）来代替您正在做的事情。

如果我们知道您依赖会话的确切目的，我们可能会提供更多帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T00:57:05.510

您可以每隔一段时间将数据存储在 cookie 中，使用 Gears 作为临时存储（如果数据复杂或需要超过 4K 的存储空间）或使用 AJAX 每隔 n 秒将临时数据发送到服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T08:32:14.407

嗯..

向用户显示有关**会话即将过期的提示怎么样 - 保存数据**（例如 5 分钟前），以便他们可以保存数据。这样他们就知道他们必须保存什么，并且如果会话真的需要过期，如果他们没有响应，它将在之后完成。

如果您想避免使用 AJAX 连续 ping 到服务器，这是一种替代方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T09:05:08.037

不要使用会话对象。正如您所发现的那样，这是导致各种可用性问题的原因。

这是我开发 Web 应用程序的黄金法则：不要使用会话。

话虽如此，请谨慎使用它来完成其他无法完成的事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-09T10:54:08.817

我将触发“在 Ajax 检查会话已过期之后”用户必须再次登录的模式窗口中的弹出表单，此弹出覆盖将位于当前页面/表单之上。所以数据不会丢失。

PN 如果你有一个...在隐藏字段中更新会话令牌。

# html - gmail源如何转换？

> ID：252274
> 
> 赞同：3
> 
> 时间：2008-10-31T00:49:45.027
> 
> 标签：html, gmail

我打开 gmail，单击收件箱项目，然后查看页面来源。看起来没有任何适当的 html 与实际页面上显示的内容相关。

源是如何处理成实际页面的？是否有一些 javascript 处理这些信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T10:20:12.537

正如[Jay](https://stackoverflow.com/users/20840/jay)所提到的，我使用 FireFox 的 Web Developer Plugin 的方法实际上不起作用，它只是显示预览（前几行）。

但是，使用 Firefox 的**FireBug**插件，您可以单击**Inspect**，然后移动鼠标并**突出显示您感兴趣的内容。**当它周围有轮廓时， **单击**。一旦选择显示在 FireBug 的 HTML 中，**右键单击 HTML 元素**（在我的例子中是 div class="YrSjGe"），然后选择**Copy HTML**。然后转到您最喜欢的文本编辑器，然后**粘贴**.

最后，HTML :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T01:01:36.470

GMail 使用大量 java 脚本来使其页面正常工作。这个 javascript 正在操作 HTML DOM。

如果您查看页面源代码，您不会看到 DOM 的当前内容。您需要使用一个工具来显示 HTML DOM。我使用 Opera Dragonfly，但其他浏览器还有很多其他的。Dragonfly 将显示页面的脚本，以及 DOM 的每个元素的事件处理程序。

2008 年 11 月 3 日编辑：

为了响应访问脚本的请求，当我查看页面时，脚本都以内联形式出现。正如其他人所说，它们被混淆了，因此不太容易阅读。这里只是一个示例：

```
try{function aa(a,b){return a.appendChild=b}function ba(a,b){return a.textContent=b}function da(a,b){return a.stop=b}function ea(a,b){return a.toString=b}function fa(a,b){return a.length=b}function ga(a,b){return a.title=b}function ha(a,b){return a.position=b}function ia(a,b){return a.create=b}function ja(a,b){return a.className=b}function ka(a,b){return a.width=b}function la(a,b){return a.expand=b}function ma(a,b){return a.abort=b}function na(a,b){return a.data=b}function oa(a,b){return a.next=b}
function pa(a,b){return a.load=b}function d(a,b){return a.innerHTML=b}function qa(a,b){return a.onerror=b}function sa(a,b){return a.getDate=b}function ta(a,b){return a.value=b}function ua(a,b){return a.disabled=b}function va(a,b){return a.dispatchEvent=b}function wa(a,b){return a.currentTarget=b}function xa(a,b){return a.left=b}function ya(a,b){return a.hideFocus=b}function za(a,b){return a.removeChild=b}function Aa(a,b){return a.target=b}function Ba(a,b){return a.screenX=b}
function Ca(a,b){return a.screenY=b}function Da(a,b){return a.send=b}function Ea(a,b){return a.remove=b}function Fa(a,b){return a.start=b}function Ga(a,b){return a.cssText=b}function Ha(a,b){return a.keyCode=b}function Ia(a,b){return a.enabled=b}function Ja(a,b){return a.href=b}function Ka(a,b){return a.handleEvent=b}function La(a,b){return a.removeNode=b}function Ma(a,b){return a.detach=b}function Na(a,b){return a.type=b}function Oa(a,b){return a.contains=b}function Pa(a,b){return a.tabIndex=b}
function Qa(a,b){return a.cellSpacing=b}function Ra(a,b){return a.clear=b}function Sa(a,b){return a.setPosition=b}function Ta(a,b){return a.cellPadding=b}function Ua(a,b){return a.display=b}function Va(a,b){return a.execute=b}function Wa(a,b){return a.height=b}function Xa(a,b){return a.nodeValue=b}function Ya(a,b){return a.clientX=b}function Za(a,b){return a.clientY=b}function ab(a,b){return a.right=b}function bb(a,b){return a.visibility=b}
function aaa(a){var b=cb[i](db);(new Image).src=baa+eb(b)+"&jsmsg="+eb(a)+caa+fb+daa+(new Date)[gb]()}function _B_record(){cb[k]((new Date)[gb]())}function _B_prog(a){top.pr=a;if(hb===undefined){var b=top[ib][jb](eaa);hb=b?b[m]:null}if(hb){ka(hb,n[kb](a*0.99)+lb);if(a==100)hb=null}}function _B_err(a){aaa(a);throw a;}function mb(a,b){var c=a[nb](ob),e=b||pb;for(var f;f=c[rb]();)if(e[f])e=e[f];else return null;return e}function sb(){}function tb(a){a.lg=function $(){return a.bmc||(a.bmc=new a)}}
function ub(a){var b=typeof a;if(b==vb)if(a){if(typeof a[o]==wb&&typeof a[xb]!="undefined"&&!faa(a,gaa))return yb;if(typeof a[q]!="undefined")return zb}else return Ab;else if(b==zb&&typeof a[q]=="undefined")return vb;return b}function haa(a,b){if(b in a)for(var c in a)if(c==b&&Bb[r][Cb][q](a,b))return true;return false}function Db(a){return typeof a!="undefined"}function Eb(a){return ub(a)==yb}function Fb(a){var b=ub(a);return b==yb||b==vb&&typeof a[o]==wb}function Gb(a){return typeof a==Hb}
function Ib(a){return typeof a==wb}function Jb(a){return ub(a)==zb}function Kb(a){var b=ub(a);return b==vb||b==yb||b==zb}function Lb(a){if(a[Cb]&&a[Cb](iaa)){var b=a.closure_hashCode_;if(b)return b}a.closure_hashCode_||(a.closure_hashCode_=++jaa);return a.closure_hashCode_}
function s(a,b){var c=a.SSb;if(arguments[o]>2){var e=Array[r][Mb][q](arguments,2);c&&e[Nb][Ob](e,c);c=e}b=a.WSb||b;a=a.TSb||a;var f,g=b||pb;f=c?function(){var h=Array[r][Mb][q](arguments);h[Nb][Ob](h,c);return a[Ob](g,h)}:function(){return a[Ob](g,arguments)};f.SSb=c;f.WSb=b;f.TSb=a;return f}function Pb(a){var b=Array[r][Mb][q](arguments,1);b[Nb](a,null);return s[Ob](null,b)}function Qb(a,b){for(var c in b)a[c]=b[c]}
function t(a,b){function c(){}c.prototype=b[r];a.F=b[r];a.prototype=new c;a[r].constructor=a}function Rb(a,b,c){if(a[Sb])return a[Sb](b,c);if(Array[Sb])return Array[Sb](a,b,c);var e=c==null?0:c<0?n.max(0,a[o]+c):c;for(var f=e;f<a[o];f++)if(f in a&&a[f]===b)return f;return-1}function Tb(a,b,c){if(a[Ub])a[Ub](b,c);else if(Array[Ub])Array[Ub](a,b,c);else{var e=a[o],f=Gb(a)?a[nb](v):a;for(var g=0;g<e;g++)g in f&&b[q](c,f[g],g,a)}}
function Vb(a,b,c){if(a.map)return a.map(b,c);if(Array.map)return Array.map(a,b,c);var e=a[o],f=[],g=0,h=Gb(a)?a[nb](v):a;for(var j=0;j<e;j++)if(j in h)f[g++]=b[q](c,h[j],j,a);return f}function Wb(a,b,c){if(a[Xb])return a[Xb](b,c);if(Array[Xb])return Array[Xb](a,b,c);var e=a[o],f=Gb(a)?a[nb](v):a;for(var g=0;g<e;g++)if(g in f&&b[q](c,f[g],g,a))return true;return false} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T10:34:05.487

正如其他人已经提到的，Gmail 使用大部分经过混淆的 Javascript 来操作 DOM。尽管要发现所有这些是如何工作的（因为要经过很多混淆的代码），但了解其工作原理的最佳方法是使用[Firebug](http://getfirebug.com/)查看各种 AJAX 请求，包括脚本和渲染的 DOM。

此外，您还可以阅读[以下文章](http://www.sajithmr.com/gmail-architecture/)，该文章解释了 Gmail 使用的架构的一小部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T02:51:00.477

当您执行简单的“查看源代码”时，您正在查看加载页面的源代码。全部加载后，那里的所有 HTML 都会被 GMail 应用程序动态替换。

编辑：GMail 还广泛使用 iframe 以实现只有上帝知道的内容。如果我没记错的话，GMail 中大约有 5 或 6 个 (i)frame 对象。此外，大部分 Javascript 都是动态加载的，甚至不使用标签。这些脚本的 URL 类似于：

[https://mail.google.com/mail/?ui=2&view=jsm&name=gm&ver=A7pcfYmUnLY&am=X_E5t8T3EkGpRf3deGMWZA](https://mail.google.com/mail/?ui=2&view=jsm&name=gm&ver=A7pcfYmUnLY&am=X_E5t8T3EkGpRf3deGMWZA)

但是，那个确切的 URL 不起作用；最后的两个变量取决于您的个人登录信息/会话/月相。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T04:35:38.177

是的，他们正在使用 javascript 将这些数据转换为您看到的完整页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T04:16:57.370

要查看用于生成电子邮件的 Javascript，请使用**Firebug** for firefox，单击“脚本”，然后在该按钮上方的栏中会出现其中一个脚本的名称，单击它以列出所有脚本，选择其中一个你喜欢。gmail可能会对其进行压缩，使其几乎无法阅读。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-02T21:18:11.630

您还可以在显示“回复”或“全部回复”的下拉菜单中选择“显示原件”，以查看包括标题在内的确切电子邮件文本。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-31T01:01:16.703

在 IE 中，如果您右键单击并“查看源代码”，则会得到一个空白页面。如果您使用页面菜单 > 查看源代码，您会看到实际的页面源代码。正如史蒂夫所提到的，在 Firefox 中，您可以通过右键单击“查看页面源代码”和查看菜单 > 页面源代码来查看实际源代码。

我怀疑他们正在利用一些特定于 IE 的混淆来向 85% 的用户隐藏他们的秘诀。

# excel - 选择更改时如何获取先前的选择？

> ID：252282
> 
> 赞同：1
> 
> 时间：2008-10-31T00:53:59.480
> 
> 标签：excel, vba

我正在处理一个导入（从 Excel）对话框来选择单元格范围。

选择范围后，我使用事件接收器来捕获事件并突出显示第一行和第一列。

我需要取消突出显示先前选择的第一行和第一列。我认为仅在选择更改时获取所选范围并记住它是不安全的，例如（为了简洁和清晰的伪代码）：

```
OnSelectionChange()
 {
 if (m_PrevSelection)
    UnHilite(m_PrevSelection);
 HiliteCurrentSelection();
 GetSelectedRange(m_PrevSelection);
} 
```

我猜只是保持这个范围（从_Application::Selection 获得）而不释放它会导致各种问题。我还没有找到复制范围的方法（IRange Copy 只是将单元格内容从一个范围复制到另一个范围）。

我想我可以获取范围的单元格地址并存储它们，然后在需要取消突出显示时从它们重新创建一个范围。在我看来，这似乎经常出现。有没有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T02:18:52.787

如果你在 Excel VBA 中工作，你可以

```
Set Rng = Application.Selection 
```

其中 Rng 是一个 Excel Range 对象。我想你可以从你所在的地方复制这个对象。

或者您可以按照您的建议将单元格地址存储在字符串变量中，这当然不需要任何对象。

不幸的是，Excel 不保留选择的历史记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T08:07:19.217

如果您不希望范围移动或改变大小，我将存储地址，然后使用 Range(myAddress) 返回范围对象以进行突出显示。

地址引用将始终引用工作表的固定区域，而范围将更新以反映单元格的插入/删除。这些中的任何一个都可能适合您的意图，但请注意，如果删除它包含的单元格，范围引用可能会变得未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T08:37:26.300

每当您检测到一个新范围（您已经在做，以突出显示第一行和第一列）时，将该范围的详细信息保存到某处的变量中（假设它是一个单一的矩形范围，存储第一行和最后一行，以及第一行和最后一行柱子）。

之后每当您检测到新范围时，您现在已经存储了先前范围的详细信息以用于清除先前的亮点（并且此事件将存储下次的详细信息，依此类推）。

# string - 如何在 for 循环中对变量执行字符串操作？

> ID：252286
> 
> 赞同：8
> 
> 时间：2008-10-31T00:54:54.860
> 
> 标签：string, batch-file, command-line

这听起来很愚蠢，但我无法让它工作。我想我只是不明白两者之间的区别`%%v, %v% and %v`

这是我正在尝试做的事情：

```
for %%v in (*.flv) do ffmpeg.exe -i "%%v" -y -f mjpeg -ss 0.001 -vframes 1 -an "%%v.jpg" 
```

这成功地为每部电影生成了一个缩略图，但问题是：

```
movie.flv -> movie.flv.jpg 
```

所以我想做的就是去掉最后 4 个字符`%%v`并将其用于第二个变量。

我一直在尝试这样的事情：

```
%%v:~0,-3% 
```

但它不起作用，我能想到的任何迭代也不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-06-10T18:30:24.207

对于发现此线程以寻找如何对 for 循环变量实际执行字符串操作的人（使用[延迟扩展](http://ss64.com/nt/delayedexpansion.html)）：

```
setlocal enabledelayedexpansion

...

::Replace "12345" with "abcde"
for %%i in (*.txt) do (
    set temp=%%i
    echo !temp:12345=abcde!
) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-31T01:05:40.377

```
for %%v in (*.flv) do ffmpeg.exe -i "%%v" -y -f mjpeg -ss 0.001 -vframes 1 -an "%%~nv.jpg" 
```

来自“帮助”：

```
%~I         - expands %I removing any surrounding quotes (")
%~fI        - expands %I to a fully qualified path name
%~dI        - expands %I to a drive letter only
%~pI        - expands %I to a path only
%~nI        - expands %I to a file name only
%~xI        - expands %I to a file extension only
%~sI        - expanded path contains short names only
%~aI        - expands %I to file attributes of file
%~tI        - expands %I to date/time of file
%~zI        - expands %I to size of file
%~$PATH:I   - searches the directories listed in the PATH
               environment variable and expands %I to the
               fully qualified name of the first one found.
               If the environment variable name is not
               defined or the file is not found by the
               search, then this modifier expands to the
               empty string 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-31T01:01:37.093

使用 %%~nV 仅获取文件名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T07:06:11.257

我不擅长批处理（我使用 WSH 或其他脚本语言代替），但我可以尝试解释 %%v %v 和 %v%。

前两种形式`for`循环使用。`help for`解释了差异，第一种形式用于批处理文件，而第二种形式用于直接在命令提示符下键入（粘贴）命令时使用。

最后一种形式只是将变量名（环境变量）替换为其值：

```
set FOO=C:\bar\foo
cd %FOO%\gah 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-29T19:25:35.650

我更喜欢的另一种方法是创建一个*子例程*(:processMpeg)，我为 For 循环中的每个元素调用它，我将 %%v 变量传递给它。

```
for %%v in (*.flv) do call :processMpeg "%%v"
goto :eof

:processMpeg
  set fileName=%~n1
  echo P1=%1  fileName=%fileName%  fullpath=%~dpnx1
  ffmpeg.exe -i "%~1" -y -f mjpeg -ss 0.001 -vframes 1 -an "%filename%.jpg"
  goto :eof 
```

# python - 奇怪的python ImportError

> ID：252287
> 
> 赞同：3
> 
> 时间：2008-10-31T00:54:55.797
> 
> 标签：python, import, windows-xp

这是我的设置：一台运行 OS X Tiger 的 Mac。在虚拟机 (Parallels) 中运行的 Windows XP。Windows XP 将我的 Mac 主目录映射为网络驱动器。

我的 Mac 主目录的目录中有两个文件：

### foo.py

```
pass 
```

### 测试.py

```
import foo 
```

如果我通过键入“python test.py”从我的虚拟机中运行 test.py，我会得到：

```
Traceback (most recent call last):
  File "test.py", line 1, in <module>
    import foo
ImportError: No module named foo 
```

如果我尝试从控制台导入 foo （在 Windows 下从同一目录运行 python），一切都很好：

```
Python 2.5.1 (r251:54863, Apr 18 2007, 08:51:08) [MSC v.1310 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import foo
>>> 
```

如果我用 Mac python 运行 test.py，一切都很好。

如果我将 test.py 和 foo.py 复制到不同的目录，我可以在 Windows 下运行 test.py 而不会出现问题。

原目录中有一个**init .py，但它是空的。**此外，将其与其他文件一起复制不会破坏上一段中的任何内容。

没有设置与 python 相关的环境变量。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T00:58:31.937

添加导入系统；打印 sys.path 到 test.py 的开头。看看它在失败的情况下打印出什么。如果 ”。” 不在列表中，这可能是您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T17:49:25.060

作为一个随机猜测： foo.py 的权限是否可以从 Windows 客户端访问？（例如尝试从虚拟机用记事本打开）。

如果没问题，请尝试运行：

```
python -v -v test.py 
```

并查看输出（或者，设置 PYTHONVERBOSE=2）。这应该列出它尝试从中导入 foo 的所有位置。将其与工作机器上的类似痕迹进行比较可能会提供一些进一步的线索。

# c++ - 为什么 RegOpenKeyEx() 在 Vista 64 位上返回错误代码 2？

> ID：252297
> 
> 赞同：32
> 
> 时间：2008-10-31T00:58:24.900
> 
> 标签：c++, winapi, windows-vista, registry, wow64

我正在拨打以下电话：

```
result = RegOpenKeyEx(key, s, 0, KEY_READ, &key); 
```

（C++、Visual Studio 5、Vista 64 位）。

即使“ `regedit`”显示密钥存在，它也会失败，错误代码为 2（“找不到文件”）。此代码一直适用于 32 位 XP。为什么它明显存在时“找不到文件”？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-31T00:58:59.987

我发现我可以使用 flag: 来解决我的问题 `KEY_WOW64_64KEY` ，例如：

```
result = RegOpenKeyEx(key, s, 0, KEY_READ|KEY_WOW64_64KEY, &key); 
```

完整说明：[注册表中的 32 位和 64 位应用程序数据](http://msdn.microsoft.com/en-us/library/ms724072(VS.85).aspx)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-14T19:15:08.493

在 Windows 64 位系统上，注册表实际上分为两部分。一部分由 64 位进程使用，一部分由 32 位进程使用。

例如，如果 32 位应用程序以编程方式写入它认为是 HKLM\SOFTWARE\Company\Application，它实际上被 WoW64 层重定向到 HKLM\SOFTWARE\Wow6432Node\Company\Application。

因此，当您运行 32 位应用程序并调用 RegOpenKeyEx 时，它实际上是针对 Wow6432Node\ 文件夹而不是常规的 \SOFTWARE 节点工作的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-04T14:22:53.900

您必须使用“使用多字节字符集”进行编译或将代码中的字符串转换为（LPWSTR）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-23T18:52:11.893

我有一个类似的问题。我正在使用：

```
dwResult = RegOpenKeyEx(HKEY_LOCAL_MACHINE,
                                   (LPWSTR)"SOFTWARE\\0test",
                                   0,
                                   WRITE_DAC ,
                                   &hKey); 
```

那没有用。我像这样尝试过，它奏效了：

```
dwResult = RegOpenKeyEx(HKEY_LOCAL_MACHINE,
                                   _T("SOFTWARE\\0test"),
                                   0,
                                   WRITE_DAC ,
                                   &hKey); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-21T02:29:59.370

是的，win7 64B，再添加标志KEY_WOW64_64KEY，就可以了。如果不起作用，请参阅[http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx)

# c# - 单例数据访问层

> ID：252304
> 
> 赞同：3
> 
> 时间：2008-10-31T00:59:20.343
> 
> 标签：c#, design-patterns, singleton

在我们工作的数据访问层中，我们有这个标准实现，其中类是通过一个看起来像这样的单例公共属性访问的：

```
public static CustomerController Instance
        {
            get 
            {
                lock(singletonLock)
                {
                    if( _instance == null )
                    {
                        _instance = new CustomerController();  
                    }
                    return _instance;
                }
            }
        } 
```

现在，我知道代码在做什么，但我想知道为什么你会在每次使用它时只创建一个类的实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T01:04:40.643

编辑：哦，哎呀，我没有抓住“数据访问层”部分。但我也有一个例子：如果你的多线程应用程序通过一个单例类汇集所有的数据库调用，那么只有一个线程会一次访问数据库，避免竞争条件。

如果您在多线程应用程序中有一个日志机制，用于吐出所有异常并仅写入信息（特别是对于始终运行的服务或应用程序，每当发生事情时打印出状态），您将遇到文件- 锁定问题。我使用单例记录器类，因此只有一个线程可以访问记录器，其余线程将等到记录器有空将它们的行写入文本文件。

使用单例有很多很酷的理由，但我和你一样，不知道它们是什么，直到我在多线程应用程序中遇到文件访问这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T01:32:50.870

您可能也希望这样做，它的双重检查锁定，它将加快访问您的单例

```
 public static CustomerController Instance
        {
                get 
                {
                        if( _instance == null )
                        {
                           lock(singletonLock)
                           {
                                if( _instance == null )
                                {
                                        _instance = new CustomerController();  
                                }

                            }
                        }   
                        return _instance;
                }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T02:26:31.620

答案很简单：您希望每次使用时都获得**相同的对象。**

它为您提供了作为全局变量（即只有一个）的优点和作为类对象的优点（除其他外，它可以在第一次需要时进行不可见的初始化）。

# sharepoint - 用于 Web 测试的 SharePoint 编辑，使用 Visual Studio 测试套件更改页面属性

> ID：252319
> 
> 赞同：6
> 
> 时间：2008-10-31T01:06:56.443
> 
> 标签：sharepoint, automated-tests, webtest, visual-studio-2008-sp1

我正在使用 Visual Studio 2008 (SP1) 创建一个 Web 测试，允许我使用 `EditForm.aspx`.

我正在尝试使用提琴手和录音机。我设法让一些测试运行，但它们不会改变属性。

有没有人有关于如何做到这一点的任何提示？

# c# - 如何向 ac# winforms 程序添加类似控制台的元素

> ID：252323
> 
> 赞同：14
> 
> 时间：2008-10-31T01:07:28.797
> 
> 标签：c#, .net, winforms

我有一个监视调试消息的程序，我尝试使用 TextBox 并将消息附加到它，但它不能很好地扩展并且当消息数量变大时会减慢速度。然后我尝试了一个 ListBox，但在添加新消息时滚动会捕捉到顶部。它也不允许像文本框那样进行剪切和粘贴。

什么是实现嵌入在 Winforms 窗口中的类似控制台的元素的更好方法。

编辑：我仍然希望能够嵌入像 Visual Studio 这样的输出窗口，但由于我无法找到一种简单的方法，因此我使用了两种解决方案。除了使用有效的 RichTextBox 之外，您还必须不时清除它。我使用我 pinvoke 的控制台。这是我为处理此问题而编写的一个小包装类。

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;

namespace Con
{
   class Ext_Console 
   {
      static bool console_on = false;

      public static void Show(bool on,string title)
      {
         console_on = on;
         if (console_on)
         {
            AllocConsole();
            Console.Title = title;
            // use to change color
            Console.BackgroundColor = System.ConsoleColor.White;
            Console.ForegroundColor = System.ConsoleColor.Black;

         }
         else
         {
            FreeConsole();
         }
      }

      public static void Write(string output)
      {
         if (console_on)
         {
            Console.Write(output);
         }
      }

      public static void WriteLine(string output)
      {
         if (console_on)
         {
            Console.WriteLine(output);
         }
      }

      [DllImport("kernel32.dll")]
      public static extern Boolean AllocConsole();
      [DllImport("kernel32.dll")]
      public static extern Boolean FreeConsole();
   }
}

// example calls
Ext_Console.Write("console output  ");
Ext_Console.WriteLine("console output");
Ext_Console.Show(true,"Title of console"); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-31T01:13:03.747

RichTextBox 有一个快速的 AppendText 方法。它可以很好地处理大文本。
我相信它是你需要的最好的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-31T03:11:27.113

您不能只将日志项添加到 WinForms 控件（ListBox 或 RichTextBox）——它最终会被阻塞并开始交换到磁盘。

我曾经有过这个确切的错误。我的解决方案是偶尔剪辑显示的消息列表。在伪代码中，这类似于：

```
void AddLogMessage(String message)
{
    list.Items.Add(message);

    // DO: Append message to file as needed

    // Clip the list
    if (list.count > ListMaxSize)
    {            
        list.Items.RemoveRange(0, list.Count - listMinSize);
    }

    // DO: Focus the last item on the list
} 
```

ListMaxSize 应该比 ListMinSize 大很多，所以剪裁不会经常发生。ListMinSize 是您通常需要在日志列表中查看的最近消息的数量。

这只是伪代码，ListBox 项目集合上实际上没有 RemoveRange（但 List 上有）。您可以找出确切的代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T02:34:08.920

我使用 Win32 控制台窗口在我的 C# 窗口程序（WInforms 或 WPF）中执行此操作。我有一个包含一些基本 Win32 API 的小类，当程序开始时我创建了一个控制台。这只是一个示例：在“现实生活”中，您将使用设置或其他东西来仅在需要时启用控制台。

```
using System;
using System.Windows.Forms;
using Microsoft.Win32.SafeHandles;
using System.Diagnostics;
using MWin32Api;

namespace WFConsole
{
    static class Program
    {
        static private SafeFileHandle ConsoleHandle;

        /// <summary>
        /// Initialize the Win32 console for this process.
        /// </summary>
        static private void InitWin32Console()
        {
            if ( !K32.AllocConsole() ) {
                MessageBox.Show( "Cannot allocate console",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Error );
                return;
            }

            IntPtr handle = K32.CreateFile(
                                 "CONOUT$",                                    // name
                                 K32.GENERIC_WRITE | K32.GENERIC_READ,         // desired access
                                 K32.FILE_SHARE_WRITE | K32.FILE_SHARE_READ,   // share access
                                 null,                                         // no security attributes
                                 K32.OPEN_EXISTING,                            // device already exists
                                 0,                                            // no flags or attributes
                                 IntPtr.Zero );                                // no template file.

            ConsoleHandle = new SafeFileHandle( handle, true );

            if ( ConsoleHandle.IsInvalid ) {
                MessageBox.Show( "Cannot create diagnostic console",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Error );
                return;
            }

            //
            // Set the console screen buffer and window to a reasonable size
            //  1) set the screen buffer sizse
            //  2) Get the maximum window size (in terms of characters) 
            //  3) set the window to be this size
            //
            const UInt16 conWidth     = 256;
            const UInt16 conHeight    = 5000;

            K32.Coord dwSize = new K32.Coord( conWidth, conHeight );
            if ( !K32.SetConsoleScreenBufferSize( ConsoleHandle.DangerousGetHandle(), dwSize ) ) {
                MessageBox.Show( "Can't get console screen buffer information.",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Error );
                return;
            }

            K32.Console_Screen_Buffer_Info SBInfo = new K32.Console_Screen_Buffer_Info();
            if ( !K32.GetConsoleScreenBufferInfo( ConsoleHandle.DangerousGetHandle(), out SBInfo ) ) {
                MessageBox.Show( "Can't get console screen buffer information.",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Exclamation);
                return;
            }

            K32.Small_Rect sr; ;
            sr.Left = 0;
            sr.Top = 0;
            sr.Right = 132 - 1;
            sr.Bottom = 51 - 1;

            if ( !K32.SetConsoleWindowInfo( ConsoleHandle.DangerousGetHandle(), true, ref sr ) ) {
                MessageBox.Show( "Can't set console screen buffer information.",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Error );
                return;
            }

            IntPtr conHWND = K32.GetConsoleWindow();

            if ( conHWND == IntPtr.Zero ) {
                MessageBox.Show( "Can't get console window handle.",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Error );
                return;
            }

            if ( !U32.SetForegroundWindow( conHWND ) ) {
                MessageBox.Show( "Can't set console window as foreground.",
                                 "Error",
                                 MessageBoxButtons.OK,
                                 MessageBoxIcon.Error );
                return;
            }

            K32.SetConsoleTitle( "Test - Console" );

            Trace.Listeners.Add( new ConsoleTraceListener() );
        }

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            InitWin32Console();
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault( false );
            Application.Run( new Main() );
        }
    }
}

using System;
using System.Runtime.InteropServices;

namespace MWin32Api
{
    #region Kernel32 Functions

    //--------------------------------------------------------------------------
    /// <summary>
    /// Functions in Kernel32.dll
    /// </summary>
    public sealed class K32
    {
        #region Data Structures, Types and Constants
        //----------------------------------------------------------------------
        // Data Structures, Types and Constants
        // 

        [StructLayout( LayoutKind.Sequential )]
        public class SecurityAttributes
        {
            public UInt32  nLength;
            public UIntPtr lpSecurityDescriptor;
            public bool    bInheritHandle;
        }

        [StructLayout( LayoutKind.Sequential, Pack = 1, Size = 4 )]
        public struct Coord
        {
            public Coord( UInt16 tx, UInt16 ty )
            {
                x = tx;
                y = ty;
            }
            public UInt16 x;
            public UInt16 y;
        }

        [StructLayout( LayoutKind.Sequential, Pack = 1, Size = 8 )]
        public struct Small_Rect
        {
            public Int16 Left;
            public Int16 Top;
            public Int16 Right;
            public Int16 Bottom;

            public Small_Rect( short tLeft, short tTop, short tRight, short tBottom )
            {
                Left = tLeft;
                Top = tTop;
                Right = tRight;
                Bottom = tBottom;
            }
        }

        [StructLayout( LayoutKind.Sequential, Pack = 1, Size = 24 )]
        public struct Console_Screen_Buffer_Info
        {
            public Coord      dwSize;
            public Coord      dwCursorPosition;
            public UInt32     wAttributes;
            public Small_Rect srWindow;
            public Coord      dwMaximumWindowSize;
        }

        public const int ZERO_HANDLE_VALUE = 0;
        public const int INVALID_HANDLE_VALUE = -1;

        #endregion
        #region Console Functions
        //----------------------------------------------------------------------
        // Console Functions
        // 
        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern bool AllocConsole();

        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern bool SetConsoleScreenBufferSize(
            IntPtr hConsoleOutput,
            Coord dwSize );

        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern bool GetConsoleScreenBufferInfo(
            IntPtr hConsoleOutput,
            out Console_Screen_Buffer_Info lpConsoleScreenBufferInfo );

        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern bool SetConsoleWindowInfo(
            IntPtr hConsoleOutput,
            bool bAbsolute,
            ref Small_Rect lpConsoleWindow );

        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern IntPtr GetConsoleWindow();

        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern bool SetConsoleTitle(
            string Filename );

        #endregion
        #region Create File
        //----------------------------------------------------------------------
        // Create File
        // 
        public const UInt32 CREATE_NEW          = 1;
        public const UInt32 CREATE_ALWAYS       = 2;
        public const UInt32 OPEN_EXISTING       = 3;
        public const UInt32 OPEN_ALWAYS         = 4;
        public const UInt32 TRUNCATE_EXISTING   = 5;
        public const UInt32 FILE_SHARE_READ     = 1;
        public const UInt32 FILE_SHARE_WRITE    = 2;
        public const UInt32 GENERIC_WRITE       = 0x40000000;
        public const UInt32 GENERIC_READ        = 0x80000000;

        [DllImport( "kernel32.dll", SetLastError = true )]
        public static extern IntPtr CreateFile(
            string Filename,
            UInt32 DesiredAccess,
            UInt32 ShareMode,
            SecurityAttributes SecAttr,
            UInt32 CreationDisposition,
            UInt32 FlagsAndAttributes,
            IntPtr TemplateFile );

        #endregion
        #region Win32 Miscelaneous
        //----------------------------------------------------------------------
        // Miscelaneous
        // 
        [DllImport( "kernel32.dll" )]
        public static extern bool CloseHandle( UIntPtr handle );

        #endregion

        //----------------------------------------------------------------------
        private K32()
        {
        }
    }
    #endregion

    //--------------------------------------------------------------------------
    /// <summary>
    /// Functions in User32.dll
    /// </summary>
    #region User32 Functions
    public sealed class U32
    {
        [StructLayout( LayoutKind.Sequential )]
        public struct Rect
        {
            public Int32 Left;
            public Int32 Top;
            public Int32 Right;
            public Int32 Bottom;

            public Rect( short tLeft, short tTop, short tRight, short tBottom )
            {
                Left = tLeft;
                Top = tTop;
                Right = tRight;
                Bottom = tBottom;
            }
        }

        [DllImport( "user32.dll" )]
        public static extern bool GetWindowRect(
            IntPtr hWnd,
            [In][MarshalAs( UnmanagedType.LPStruct )]Rect lpRect );

        [DllImport( "user32.dll", SetLastError = true )]
        public static extern bool SetForegroundWindow(
            IntPtr hWnd );

        //----------------------------------------------------------------------
        private U32()
        {
        }
    } // U32 class
    #endregion
} // MWin32Api namespace 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T01:34:10.040

我遇到了这个确切的挑战。我已经解决了两种不同的方法，工作和执行都将在重负载下进行。一种方法是使用 ListView。添加一行文字是这样的：

```
 ListViewItem itm = new ListViewItem();
        itm.Text = txt;
        this.listView1.Items.Add(itm);
        this.listView1.EnsureVisible(listView1.Items.Count - 1); 
```

另一种方法是在虚拟模式下使用 DataGridView。我没有那个方便的代码。虚拟模式是你的朋友。

编辑：重新阅读，我看到你想要复制/粘贴工作。也许 RichText 控件执行得很好——不知道，但如果你使用 ListView 或 DataGrid，你必须做更多的编码才能让复制/粘贴工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-18T20:43:42.730

```
public class ConsoleTextBox: TextBox
{
    private List<string> contents = new List<string>();
    private const int MAX = 50;

    public void WriteLine(string input)
    {
        if (contents.Count == MAX)
            contents.RemoveAt(MAX-1);
        contents.Insert(0, input);

        Rewrite();
    }

    private void Rewrite()
    {
        var sb = new StringBuilder();
        foreach (var s in contents)
        {
            sb.Append(s);
            sb.Append(Environment.NewLine);
        }
        this.Text = sb.ToString();
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T01:09:34.487

将列表框的 selectedindex 设置为最后一个元素，使其滚动到底部

另外，将列表框中的项目数量限制在合理的范围内（从顶部删除，保留后面的项目），这样你就不会咀嚼所有的记忆

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T01:21:33.747

我以前使用过文本框。将其添加到您的表单中，将 Multipline 属性设置为 true，将滚动条设置为 Vertical。最后添加以下代码：

```
 private void AddConsoleComment(string comment)
    {
        textBoxConsole.Text += comment + System.Environment.NewLine;
        textBoxConsole.Select(textBoxConsole.Text.Length,0);
        textBoxConsole.ScrollToCaret();
    } 
```

本质上是将您的评论添加到现有文本中，还附加了换行符。最后选择长度 = 0 的文本的最后一位。ScrollToCaret 强制文本框向下滚动到光标所在的位置（在最后一行）

希望这可以帮助。

# c# - 使用 LINQ 计算产品

> ID：252333
> 
> 赞同：16
> 
> 时间：2008-10-31T01:13:10.987
> 
> 标签：c#, linq

我正在学习 LINQ，并且有一个非常简单的问题，我认为这将有助于我更好地理解这项技术。如何找到整数数组的乘积？

例如，LINQ 的做法是什么：

```
int[] vals = { 1, 3, 5 };
return vals[0] * vals[1] * vals[2]; 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-31T01:16:40.823

这会起作用：

```
var product = vals.Aggregate(1, (acc, val) => acc * val); 
```

您从种子开始`1`，然后使用两个参数为每个值调用函数，`acc`这是当前累积值，`val`也是数组中的值；该函数将当前累加值乘以数组中的值，并将该表达式的结果传递`acc`给下一个函数。即带有您提供的数组的函数调用链将是：

```
(1, 1) => 1
(1, 3) => 3
(3, 5) => 15 
```

# flash - 加载 XML 文件后如何在 Flash ActionScript 中重新加载 DataGrid？

> ID：252352
> 
> 赞同：1
> 
> 时间：2008-10-31T01:24:50.447
> 
> 标签：flash, actionscript, datagrid, actionscript-2, rowcount

`RowCount`在`DataGrid`舞台上创建后是否可以更改in flash？

我正在外部加载一个 XML 文件，其中包含`DataGrid`应具有的行数，但问题是因为此文件在运行时未加载，它只选择默认的 3 项。也许我必须`DataGrid`在舞台上重新加载，或者循环直到它被定义。

这个事情谁有经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-31T02:02:06.253

我们是在谈论 Flash 还是 Flex？如果我们谈论的是 Flex，您实际上可以只使用 DataBinding。只需将 [Bindable] 属性放在包含 XML 的变量上方，当您使用新数据更新变量时，网格也会更新。

如果您真的是指 Flash，那么我不知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-28T07:54:21.043

**弹性项目：**

当 dataprovider 改变时，使用 bindable 强制更新。

```
<fx:Script>
    <![CDATA[
        [Bindable]
        private var _loadedXMLData : XML; // load xml and store here
    ]]>
</fx:Script>

<mx:DataGrid dataProvider="{_loadedXMLData}" width="100%" height="100%"/> 
```

* * *

**快闪项目：**

请务必在加载 XML 时设置数据提供程序。如果它没有给你正确的行数，试试这个：

```
// set flash datagrid component rows manually
dg.rowCount = 10; 
```

# c# - 如何编写异步 LINQ 查询？

> ID：252355
> 
> 赞同：64
> 
> 时间：2008-10-31T01:26:01.163
> 
> 标签：c#, linq, linq-to-sql, asynchronous

看了一堆 LINQ 相关的东西后，我突然意识到没有文章介绍如何编写异步 LINQ 查询。

假设我们使用 LINQ to SQL，下面的语句很清楚。但是，如果 SQL 数据库响应缓慢，那么使用这块代码的线程就会受到阻碍。

```
var result = from item in Products where item.Price > 3 select item.Name;
foreach (var name in result)
{
    Console.WriteLine(name);
} 
```

似乎当前的 LINQ 查询规范不对此提供支持。

有没有办法做异步编程LINQ？当结果准备好使用时，它的工作方式就像有一个回调通知，而 I/O 没有任何阻塞延迟。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-31T02:05:54.047

虽然 LINQ 本身并没有真正具有此功能，但框架本身确实...您可以轻松地在 30 行左右滚动您自己的异步查询执行器...事实上，我只是为您把它放在一起:)

**编辑：通过写这篇文章，我发现了他们为什么没有实现它。它不能处理匿名类型，因为它们是本地的。因此，您无法定义回调函数。** 这是一件非常重要的事情，因为很多 linq to sql 的东西在 select 子句中创建它们。以下任何建议都遭受同样的命运，所以我仍然认为这个是最容易使用的！

编辑：唯一的解决方案是不使用匿名类型。您可以将回调声明为仅采用 IEnumerable（无类型参数），并使用反射来访问字段（ICK ！！）。另一种方法是将回调声明为“动态”......哦......等等......这还没有。:) 这是另一个很好的例子，说明如何使用动态。有些人可能称之为滥用。

将其放入您的实用程序库中：

```
public static class AsynchronousQueryExecutor
{
    public static void Call<T>(IEnumerable<T> query, Action<IEnumerable<T>> callback, Action<Exception> errorCallback)
    {
        Func<IEnumerable<T>, IEnumerable<T>> func =
            new Func<IEnumerable<T>, IEnumerable<T>>(InnerEnumerate<T>);
        IEnumerable<T> result = null;
        IAsyncResult ar = func.BeginInvoke(
                            query,
                            new AsyncCallback(delegate(IAsyncResult arr)
                            {
                                try
                                {
                                    result = ((Func<IEnumerable<T>, IEnumerable<T>>)((AsyncResult)arr).AsyncDelegate).EndInvoke(arr);
                                }
                                catch (Exception ex)
                                {
                                    if (errorCallback != null)
                                    {
                                        errorCallback(ex);
                                    }
                                    return;
                                }
                                //errors from inside here are the callbacks problem
                                //I think it would be confusing to report them
                                callback(result);
                            }),
                            null);
    }
    private static IEnumerable<T> InnerEnumerate<T>(IEnumerable<T> query)
    {
        foreach (var item in query) //the method hangs here while the query executes
        {
            yield return item;
        }
    }
} 
```

你可以像这样使用它：

```
class Program
{

    public static void Main(string[] args)
    {
        //this could be your linq query
        var qry = TestSlowLoadingEnumerable();

        //We begin the call and give it our callback delegate
        //and a delegate to an error handler
        AsynchronousQueryExecutor.Call(qry, HandleResults, HandleError);

        Console.WriteLine("Call began on seperate thread, execution continued");
        Console.ReadLine();
    }

    public static void HandleResults(IEnumerable<int> results)
    {
        //the results are available in here
        foreach (var item in results)
        {
            Console.WriteLine(item);
        }
    }

    public static void HandleError(Exception ex)
    {
        Console.WriteLine("error");
    }

    //just a sample lazy loading enumerable
    public static IEnumerable<int> TestSlowLoadingEnumerable()
    {
        Thread.Sleep(5000);
        foreach (var i in new int[] { 1, 2, 3, 4, 5, 6 })
        {
            yield return i;
        }
    }

} 
```

现在打算把它放在我的博客上，非常方便。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-07-03T08:21:16.227

TheSoftwareJedi 和[ulrikb](http://ulrikb.wordpress.com/2010/04/14/executing-a-linq-query-asynchronously/)的（又名 user316318）解决方案适用于任何 LINQ 类型，但（正如 [Chris Moschini](https://stackoverflow.com/users/176877/chris-moschini)所指出的）不会委托给利用 Windows I/O 完成端口的底层异步调用。

Wesley Bakker 的[Asynchronous DataContext文章（由](http://weblogs.asp.net/wesleybakker/archive/2010/03/03/asynchronous-datacontext.aspx)[Scott Hanselman 的博客文章](http://www.hanselman.com/blog/TheWeeklySourceCode51AsynchronousDatabaseAccessAndLINQToSQLFun.aspx)触发）描述了使用 sqlCommand.BeginExecuteReader/sqlCommand.EndExecuteReader 的 LINQ to SQL 类，它利用了 Windows I/O 完成端口。

[I/O 完成端口](http://msdn.microsoft.com/en-us/library/aa365198%28v=vs.85%29.aspx)为在多处理器系统上处理多个异步 I/O 请求提供了一个高效的线程模型。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-07-30T21:54:45.467

根据[Michael Freidgeim 的回答](https://stackoverflow.com/a/6561839/186822)和 Scott Hansellman 提到的[博客文章](http://www.hanselman.com/blog/TheWeeklySourceCode51AsynchronousDatabaseAccessAndLINQToSQLFun.aspx)`async`以及您可以使用/的事实，`await`您可以实现可重用的方法，该方法以异步`ExecuteAsync<T>(...)`方式执行底层：`SqlCommand`

```
protected static async Task<IEnumerable<T>> ExecuteAsync<T>(IQueryable<T> query,
    DataContext ctx,
    CancellationToken token = default(CancellationToken))
{
    var cmd = (SqlCommand)ctx.GetCommand(query);

    if (cmd.Connection.State == ConnectionState.Closed)
        await cmd.Connection.OpenAsync(token);
    var reader = await cmd.ExecuteReaderAsync(token);

    return ctx.Translate<T>(reader);
} 
```

然后你可以像这样（重新）使用它：

```
public async Task WriteNamesToConsoleAsync(string connectionString, CancellationToken token = default(CancellationToken))
{
    using (var ctx = new DataContext(connectionString))
    {
        var query = from item in Products where item.Price > 3 select item.Name;
        var result = await ExecuteAsync(query, ctx, token);
        foreach (var name in result)
        {
            Console.WriteLine(name);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-08-16T21:15:07.947

[我启动了一个名为Asynq](https://github.com/JamesDunne/Asynq/)的简单 github 项目来执行异步 LINQ-to-SQL 查询。这个想法很简单，尽管在这个阶段“脆弱”（截至 2011 年 8 月 16 日）：

1.  让 LINQ-to-SQL`IQueryable`完成`DbCommand`通过`DataContext.GetCommand()`.
2.  对于 SQL 200[058]，从`DbCommand`您获得的抽象实例中向上`GetCommand()`转换以获得`SqlCommand`. 如果您使用的是 SQL CE，那么您就不走运了，因为`SqlCeCommand`它没有公开`BeginExecuteReader`and的异步模式`EndExecuteReader`。
3.  使用`BeginExecuteReader`和`EndExecuteReader`关闭`SqlCommand`使用标准 .NET 框架异步 I/O 模式来让自己`DbDataReader`在传递给`BeginExecuteReader`方法的完成回调委托中获得一个。
4.  现在我们有了一个`DbDataReader`，我们不知道它包含哪些列，也不知道如何将这些值映射回`IQueryable`'s `ElementType`（在连接的情况下很可能是匿名类型）。当然，此时您可以手动编写自己的列映射器，将其结果具体化回您的匿名类型或其他类型。您必须为每种查询结果类型编写一个新的，具体取决于 LINQ-to-SQL 如何处理您的 IQueryable 以及它生成的 SQL 代码。这是一个非常讨厌的选项，我不推荐它，因为它不可维护，也不总是正确的。LINQ-to-SQL 可以根据您传入的参数值更改您的查询形式，例如`query.Take(10).Skip(0)`生成不同的 SQL`query.Take(10).Skip(10)`，也许还有不同的结果集架构。最好的办法是以编程方式处理这个物化问题：
5.  “重新实现”一个简单的运行时对象物化器，它`DbDataReader`根据. 正确实现这一点可能是该解决方案中最具挑战性的部分。`ElementType``IQueryable`

正如其他人发现的那样，该`DataContext.Translate()`方法不处理匿名类型，只能将 a`DbDataReader`直接映射到属性正确的 LINQ-to-SQL 代理对象。`DataContext.Translate()`由于大多数值得在 LINQ 中编写的查询都将涉及复杂的连接，最终不可避免地需要匿名类型用于最终的 select 子句，因此无论如何使用这种提供的淡化方法是毫无意义的。

在利用现有成熟的 LINQ-to-SQL IQueryable 提供程序时，此解决方案存在一些小缺点：

1.  您不能将单个对象实例映射到您的最终选择子句中的多个匿名类型属性`IQueryable`，例如`from x in db.Table1 select new { a = x, b = x }`。LINQ-to-SQL 在内部跟踪哪些列序号映射到哪些属性；它不会将此信息公开给最终用户，因此您不知道其中的哪些列`DbDataReader`被重用，哪些是“不同的”。
2.  `DbDataReader`您不能在最终`IQueryable`的select 子句中包含常量值 - 这些不会被翻译成 SQL 并且不会出现`Expression`在麻烦，根本没有道理。

我确信还有其他查询模式可能会中断，但这是我能想到的两个最大的可能会导致现有 LINQ-to-SQL 数据访问层出现问题的模式。

这些问题很容易解决 - 只需不要在查询中执行它们，因为这两种模式都不会对查询的最终结果带来任何好处。希望这个建议适用于所有可能导致对象实现问题的查询模式：-P。无法访问 LINQ-to-SQL 的列映射信息是一个很难解决的问题。

解决问题的更“完整”的方法是有效地重新实现几乎所有的 LINQ-to-SQL，这有点耗时:-P。从高质量的开源 LINQ-to-SQL 提供程序实施开始将是一个很好的方法。您需要重新实现它的原因是，您可以访问所有用于将`DbDataReader`结果具体化到对象实例的列映射信息，而不会丢失任何信息。

# c# - 使用 SSL 创建 TCP 客户端连接

> ID：252365
> 
> 赞同：11
> 
> 时间：2008-10-31T01:33:59.557
> 
> 标签：c#, .net, ssl, tcp

我正在尝试创建一个 TCP 连接并使用 SSL 发送/读取数据，但我无法成功完成此操作。

我想做的是这样的：

```
 TcpClient _tcpClient = new TcpClient("host", 110);

    BinaryReader reader = 
       new BinaryReader(new System.Net.Security.SslStream(_tcpClient.GetStream(), true));

    Console.WriteLine(reader.ReadString()); 
```

我没有任何运气。创建 BinaryReader 时引发异常。

有谁知道这样做的一个简单例子？我对编写服务器端不感兴趣，只是客户端。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T01:47:34.117

BinaryReader 以特定编码将原始数据类型读取为二进制值，这是您的服务器发送的吗？
如果不使用 StreamReader：

```
TcpClient _tcpClient = new TcpClient("host", 110);

StreamReader reader = 
   new StreamReader(new System.Net.Security.SslStream(_tcpClient.GetStream(), true));

Console.WriteLine(reader.ReadToEnd()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T01:38:12.917

我不完全确定这是否适用于您的应用程序，但我建议您查看 stunnel： http:
[//www.stunnel.org](http://www.stunnel.org)

我过去曾使用它来包装现有的 TCP 连接。

# vi - 在 vi 中更改缩进深度

> ID：252371
> 
> 赞同：13
> 
> 时间：2008-10-31T01:37:14.307
> 
> 标签：vi, editing

在 vi 中增加或减少大块代码的缩进最简单的方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-31T01:44:33.560

在 vim 中（不确定这是否也适用于你），你`>>`习惯缩进一行。与 vim 中的几乎所有命令一样，在要执行的命令多次之前输入一个数字。因此，要缩进接下来的 50 行，请键入`50>>`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-31T01:50:16.543

自动识别：

对于 { } 块，我使用命令：**=iB**（将光标置于块内以识别）

为了重新识别一个完整的文件，我使用**gg=G**

现在要增加或减少块上的标识，您必须选择它（我使用**viB**命令），然后执行**>>**或**<<**，如果您想重复标识，只需使用 dot **。**

还记得设置您的身份设置

**:set shiftwidth=NUMOFSPACES**

和

**:set softtabstop=NUMOFSPACES**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T01:39:40.107

标记它，然后使用 > 和 <。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T01:41:18.417

如果您的代码在花括号之间，则将光标放在其中一个花括号上并使用`>%`or `<%`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T02:28:39.337

默认情况下，在插入模式下，您可以使用`Ctrl-T`和`Ctrl-D`取消/意图当前行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-31T04:03:29.537

另一个有用的命令是，一旦你使用 '<' 或 '>' 缩进，使用 '.' 重复该命令，直到它按您想要的方式排列。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-31T04:11:47.960

此外，您可以查看[http://vim.wikia.com/](http://vim.wikia.com/)以获取有关此类事情的提示。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T02:56:26.410

点击 v 进入可视模式并向下箭头，因此选择整个块然后 12>>

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T01:44:11.143

将两个尖括号（“<<”或“>>”）用于向左或向右的一行 shiftwidth 字符。您可以使用常用的行范围指示符 - ":m,n"、大括号/括号/括号匹配等来做到这一点。

或“<”，然后是运动指示器，然后是另一个“<”。

或 "<12<" 将接下来的 12 行左移。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-14T23:09:33.087

:50,100>

将第 50 到 100 行缩进一次

:50,100>>

将第 50 到 100 行缩进两次

也适用于 < 和 << 等。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-11T18:06:52.807

首先使用 Control-g 命令找到开始行和结束行的行号。让这些是*m*和*n*。假设我们希望将行号*m*到*n*缩进5 个空格。然后，以下命令完成这项工作，

```
:m,ns/^/     /g 
```

要减少缩进，首先将所有制表符转换为（例如 4 个）空格。

```
:m,ns/\t/    /g 
```

然后假设我们希望从编号为*m*到*n*的行中删除 3 个空格。

```
:m,ns/^   //g 
```

# c# - 共享主机

> ID：252382
> 
> 赞同：3
> 
> 时间：2008-10-31T01:42:24.297
> 
> 标签：c#, asp.net, web-hosting

我有点惊讶这不是在更多的论坛上，因为它是一个完全的展示终结者。我有一个调用我编写的 Web 服务的 ASP.NET 应用程序。它托管在共享托管站点上。最近，该公司移动了我的服务器以允许 1.1 和 2.0 应用程序。信任级别已从“完全”更改为“中等”，我的代码已停止工作。该公司不会对其 machine.config 文件进行任何更改或将我的 Web 服务添加为端点。我无法覆盖 web.config 文件中的设置，也无法在 web.config 文件中设置 originUrl。

我客户的小型企业网站现在离线，她将停业。

我已将我的代码升级到 2.0，并且在我的 web.config 文件中，我将信任级别设置为“中”（我学到了这一课很难）但即使在我的开发机器上，我也无法通过对我的 Web 服务的调用。我收到 *“System.Security.SecurityException：请求'System.Net.WebPermission，System，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089'类型的权限失败。”*

我已经读过我应该能够“围绕”这些问题进行编码，但我什至不知道从哪里开始。

有没有人知道我需要做什么才能让我的代码在完全锁定的托管服务器上运行，在该服务器上不允许更改我的配置文件......

我可以为帮助我找到解决方案的人买最好的一瓶最好的威士忌。;-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T02:10:25.067

在我看来，您的虚拟主机不是很灵活。我会问他们添加他们允许的所需权限。我在使用 Server Intellect 时遇到了同样的问题，在与他们交谈并告诉他们我需要的许可后，他们提供了帮助并解决了问题。

老实说，有很多托管公司和很多愿意与人们合作以开展业务的人。如果我面临同样困难的托管服务提供商，我会在别处寻找可以帮助您的提供商。他们所做的改变给你带来了痛苦，他们至少应该尝试帮助你，否则就会转向想要支持你的人。只有我 2 美分，可能不是您要找的推荐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T11:05:16.423

嘿... 获得一个 VPS... 这将让您设置自己的权限级别。共享主机是胡扯。

有一段时间，我使用 Godaddy 托管了一个网站，该网站有一个与我的网站一起运行的多线程应用程序。Godaddy 杀了它，然后我不得不移动主机......现在我有自己的服务器，但它每月给我 190 美元。如果你想要一个便宜的 Windows 服务器，你可以得到一个每月 50 美元的策略。我不知道这是否在您的预算之内，但这将使您可以完全访问 PC，包括远程桌面。

我希望这是一些帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-03T09:54:51.810

DiscountASP 有一个共享托管计划，可让您完全信任地运行。在此处查看他们的[功能列表](https://www.discountasp.net/features.aspx)。他们的价格从每月 10 美元起，所以我想这就是你要找的东西。

我已经使用 DiscountASP 的服务大约一年了，我对它们非常满意。当然，您的里程可能会有所不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-22T11:50:34.163

Hostgator 似乎是最好的。我正在使用 hostgator。

# asp.net - 如何在 web.config 的 MailSetting 部分设置友好的电子邮件名称？

> ID：252391
> 
> 赞同：24
> 
> 时间：2008-10-31T01:48:03.850
> 
> 标签：asp.net, web-config, mailsettings

目前我有：

```
<system.net>
    <mailSettings>
    <smtp from="me@mydomain.com">
        <network 
             host="localhost" 
             port="25"
             />
      </smtp>
    </mailSettings>
  </system.net> 
```

如何更改它以便使用名称而不是仅使用电子邮件地址发送电子邮件？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-31T02:00:01.267

好吧，在代码中，您需要将发件人的姓名放在引号中，然后是电子邮件地址。

```
new SmtpClient(...).Send("\"John Smith\" jsmith@somewhere.com", ...); 
```

而且...看起来您也可以将其编码到属性中...

```
<smtp from="&quot;John Smith&quot; &lt;jsmith@somewhere.com&gt;"> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-01-20T13:43:14.673

```
<system.net>
<mailSettings>
<smtp from ="XYZ&lt;xyz@xyz.com&gt;">
<network host="smtp.gmail.com" port="25" userName="xyz@xyz.com"    password="******" enableSsl="true"/>
</smtp>
</mailSettings>
</system.net> 
```

1)请在 app.config 文件中使用这些设置

# java - 重新启动 Java 控制台应用程序

> ID：252411
> 
> 赞同：2
> 
> 时间：2008-10-31T01:59:01.783
> 
> 标签：java, restart

目前我有一个控制台应用程序。我希望能够退出应用程序，通过 svn 更新，重新编译然后重新启动。这是在 Linux 环境下运行的。目前我不确定如何重新启动该应用程序。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T02:02:44.943

您可以创建一个文件，例如`.relaunch`，当您在指定情况下退出应用程序并让编译脚本删除该文件并在完成编译后启动应用程序（如果重新启动文件存在）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T02:04:30.743

有一种低技术的方法可以做到这一点 - 假设你希望这一切都在代码中完成：

1）让您的应用程序启动一个单独的进程（然后退出）：
a）使用 args 调用 svn.exe（或获取 svnkit [...](http://svnkit.com/)）以获取最新源
b）调用您的 ant 或任何脚本来编译
c）执行您新编译的应用程序
d) 退出

# python - 如何使用 Python 中的 DLL 文件？

> ID：252417
> 
> 赞同：209
> 
> 时间：2008-10-31T02:01:48.157
> 
> 标签：python, dll

从内部使用`DLL`文件的最简单方法是什么`Python`？

具体来说，如何在*不*编写任何额外的包装`C++`代码来将功能公开的情况下做到这一点`Python`？

本机`Python`功能比使用第三方库更受青睐。

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2008-10-31T02:43:41.100

为了易于使用，[ctypes](http://docs.python.org/library/ctypes.html)是要走的路。

以下 ctypes 示例来自我编写的实际代码（在 Python 2.5 中）。到目前为止，这是我找到的最简单的方法，可以按照您的要求进行操作。

```
import ctypes

# Load DLL into memory.

hllDll = ctypes.WinDLL ("c:\\PComm\\ehlapi32.dll")

# Set up prototype and parameters for the desired function call.
# HLLAPI

hllApiProto = ctypes.WINFUNCTYPE (
    ctypes.c_int,      # Return type.
    ctypes.c_void_p,   # Parameters 1 ...
    ctypes.c_void_p,
    ctypes.c_void_p,
    ctypes.c_void_p)   # ... thru 4.
hllApiParams = (1, "p1", 0), (1, "p2", 0), (1, "p3",0), (1, "p4",0),

# Actually map the call ("HLLAPI(...)") to a Python name.

hllApi = hllApiProto (("HLLAPI", hllDll), hllApiParams)

# This is how you can actually call the DLL function.
# Set up the variables and call the Python name with them.

p1 = ctypes.c_int (1)
p2 = ctypes.c_char_p (sessionVar)
p3 = ctypes.c_int (1)
p4 = ctypes.c_int (0)
hllApi (ctypes.byref (p1), p2, ctypes.byref (p3), ctypes.byref (p4)) 
```

这些`ctypes`东西具有所有 C 类型的数据类型（`int`、`char`、`short`、`void*`等），并且可以按值或引用传递。它也可以返回特定的数据类型，尽管我的示例没有这样做（HLL API 通过修改通过引用传递的变量来返回值）。

* * *

就上面展示的具体示例而言，IBM 的 EHLLAPI 是一个相当一致的接口。

[根据 IBM在此处](http://publib.boulder.ibm.com/infocenter/pcomhelp/v5r9/index.jsp?topic=/com.ibm.pcomm.doc/books/html/emulator_programming08.htm)的文档，所有调用都传递四个 void 指针（EHLLAPI 通过第四个参数发送返回代码，一个指向`int`so 的指针，而我指定`int`为返回类型，我可以放心地忽略它）。换句话说，该函数的 C 变体将是：

```
int hllApi (void *p1, void *p2, void *p3, void *p4) 
```

这使得单个简单的`ctypes`函数能够执行 EHLLAPI 库提供的任何操作，但其他库可能需要为`ctypes`每个库函数设置单独的函数。

from 的返回值`WINFUNCTYPE`是一个函数原型，但您仍然需要设置更多参数信息（除了类型之外）。每个元组`hllApiParams`都有一个参数“方向”（1 = 输入，2 = 输出等等），一个参数名称和一个默认值 -`ctypes`有关详细信息，请参阅文档

一旦你有了原型和参数信息，你就可以创建一个 Python“可调用”`hllApi`来调用函数。您只需创建所需的变量（在我的例子中是`p1`通过`p4`）并用它们调用函数。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2010-07-04T06:28:31.080

[这个页面](http://web.archive.org/web/20111006042404/http://www.knowledgetantra.com/component/content/article/2-python/1-call-dll-function-in-python.html)有一个从 DLL 文件调用函数的非常简单的例子。

为了完整起见，在此处解释详细信息：

> 在 Python 中调用 DLL 函数非常容易。我有一个自制的 DLL 文件，它有两个函数：`add`它`sub`有两个参数。
> 
> `add(a, b)`返回两个数字的加法
> `sub(a, b)`返回两个数字的减法
> 
> DLL 文件的名称将是“demo.dll”
> 
> **程序：**
> 
> `from ctypes import*`
> `# give location of dll`
> `mydll = cdll.LoadLibrary("C:\\demo.dll")`
> `result1= mydll.add(10,1)`
> `result2= mydll.sub(10,1)`
> `print "Addition value:"+result1`
> `print "Substraction:"+result2`
> 
> **输出：**
> 
> `Addition value:11`
> `Substraction:9`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-04-04T07:04:09.383

# 使用 ctypes 在 Python 下构建 DLL 并链接它

我提供了一个完整的示例，说明如何`shared library`通过`Python`. `ctypes`我考虑`Windows`案件并处理`DLLs`。需要两个步骤：

1.  使用 Visual Studio 的编译器从命令行或 IDE 构建 DLL；
2.  使用 ctypes 在 Python 下链接 DLL。

## 共享库

我认为是以下`shared library`内容并包含在`testDLL.cpp`文件中。唯一的功能`testDLL`只是接收`int`并打印它。

```
#include <stdio.h>
​
extern "C" {
​
__declspec(dllexport)
​
void testDLL(const int i) {
    printf("%d\n", i);
}
​
} // extern "C" 
```

## 从命令行构建 DLL

从命令行运行`DLL`构建一个`Visual Studio`

```
"C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\Tools\vsdevcmd" 
```

设置包含路径，然后运行

```
cl.exe /D_USRDLL /D_WINDLL testDLL.cpp /MT /link /DLL /OUT:testDLL.dll 
```

构建 DLL。

## `DLL`从 IDE构建

或者，`DLL`可以使用`Visual Studio`如下方式构建：

1.  文件->新建->项目；
2.  已安装 -> 模板 -> Visual C++ -> Windows -> Win32 -> Win32Project；
3.  下一个;
4.  应用程序类型 -> DLL；
5.  附加选项 -> 空项目（选择）；
6.  附加选项 -> 预编译头（取消选择）；
7.  项目 -> 属性 -> 配置管理器 -> 活动解决方案平台：x64；
8.  项目 -> 属性 -> 配置管理器 -> 活动解决方案配置：发布。

## Python下链接DLL

在 Python 下，执行以下操作

```
import os
import sys
from ctypes import *

lib = cdll.LoadLibrary('testDLL.dll')

lib.testDLL(3) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-31T02:18:03.087

ctypes 可用于访问 dll，这里有一个教程：

[http://docs.python.org/library/ctypes.html#module-ctypes](http://docs.python.org/library/ctypes.html#module-ctypes)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-06-17T21:38:07.637

也许与`Dispatch`：

```
from win32com.client import Dispatch

zk = Dispatch("zkemkeeper.ZKEM") 
```

其中 zkemkeeper 是系统上注册的 DLL 文件...之后，您可以通过调用它们来访问函数：

```
zk.Connect_Net(IP_address, port) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-31T02:24:51.967

ctypes 将是最容易使用的东西，但是（错误）使用它会使 Python 崩溃。如果你想快速做某事，而且你很小心，那就太好了。

我鼓励您查看[Boost Python](http://www.boost.org/doc/libs/1_36_0/libs/python/doc/index.html)。是的，它要求您编写一些 C++ 代码并拥有 C++ 编译器，但您实际上不需要学习 C++ 即可使用它，并且您可以[从 Microsoft 获得免费的（如啤酒中的）C++ 编译器](http://www.microsoft.com/express/vc/)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-30T15:25:13.760

如果 DLL 是 COM 库类型，那么您可以使用 pythonnet。

```
pip install pythonnet 
```

然后在您的python代码中，尝试以下

```
import clr
clr.AddReference('path_to_your_dll') 
```

然后根据 DLL 中的类实例化一个对象，并访问其中的方法。

# java - JSF 和 Facelets 流

> ID：252451
> 
> 赞同：1
> 
> 时间：2008-10-31T02:29:47.947
> 
> 标签：java, ajax, jsf, jakarta-ee, facelets

我有一个动态 Facelets 页面，需要在页面加载时显示来自数据库的信息。在流程中的这一点上，还没有任何表单提交。我能找到的每个 JSF 示例仅在下一页显示带有动态结果的表单提交。

我对数据库的每次调用当前都是在表单提交触发操作之后进行的。如果没有表单提交，这段代码应该去哪里，如何触发它？一个代码片段真的可以帮助我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T09:49:08.793

您应该能够在托管 bean 的构造函数（或懒惰地在您的访问器之一）中进行初始化工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T09:19:12.113

如果您使用的是[Spring 集成](http://static.springframework.org/spring/docs/2.5.x/reference/web-integration.html#jsf-delegatingvariableresolver)（另请参见[此处](http://sacrephill.wordpress.com/2008/05/02/jsf-backing-beans-and-spring/)），这很容易。

在您的支持 bean 中，只需使用以下内容：

```
public class BackingBean implements InitializingBean
{
    public void afterPropertiesSet()
    {
        loadInitialData();
    }
} 
```

如果您没有与 Spring 集成，则有两种选择：

1.  在类构造函数中加载初始数据；
2.  在您的`faces-config.xml`中，您可以设置要注入的属性。保证按照配置文件中指定的顺序设置属性。因此，只需创建一个虚拟属性，然后在该方法中加载您的默认数据。即创建一个方法`public void setLoaded(boolean loaded) { loadInitialData(); }`，并在您的 faces-config.xml 中将“加载”设置为该支持 bean 的属性。

希望这一切都清楚了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T03:09:22.437

你写（加上我的重点）：

> 我对数据库的每次调用当前都是在表单提交触发操作之后进行的。如果*没有表单提交*，这段代码应该去哪里，如何触发它？一个代码片段真的可以帮助我！

在我看来，您想在提交表单*之前从数据库中检索信息。*

在我看来，您想要进行 Ajax 调用来查询数据库。Ajax 调用可以在与表单提交事件不同的事件上触发。这可能需要使用 Javascript 而不是 Faces 框架。

# svn - 一个 SVN 存储库还是多个？

> ID：252459
> 
> 赞同：106
> 
> 时间：2008-10-31T02:34:03.053
> 
> 标签：svn

如果您有多个不相关的项目，将它们放在同一个存储库中是否是个好主意？

```
myRepo/projectA/trunk
myRepo/projectA/tags
myRepo/projectA/branches
myRepo/projectB/trunk
myRepo/projectB/tags
myRepo/projectB/branches 
```

或者你会为每个创建新的存储库吗？

```
myRepoA/trunk
myRepoA/tags
myRepoA/branches
myRepoB/trunk
myRepoB/tags
myRepoB/branches 
```

各自的优缺点是什么？`svn:externals`我目前能想到的只是你得到了混合的修订号（那又怎样？），除非存储库实际上是外部的，否则你不能使用它。（我想？）

我问的原因是因为我正在考虑将我的多个 repo 合并为一个，因为我的 SVN 主机已经开始对每个 repo 收费。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-10-31T02:57:07.517

单个与多个问题归结为个人或组织偏好。

多个与单个的管理主要归结为访问控制和维护。

单个存储库的访问控制可以包含在单个文件中；多个存储库可能需要多个文件。维护也有类似的问题——一个大备份，或者很多小备份。

我自己管理。有一个存储库，多个项目，每个项目都有自己的标签、主干和分支。如果一个变得太大或者我需要物理隔离客户的代码以使他们感到舒适，我可以快速轻松地创建一个新的存储库。

我最近咨询了一家相对较大的公司，将多个源代码控制系统迁移到 Subversion。他们有大约 50 个项目，从非常小的到企业应用程序和他们的公司网站。他们的计划？从单个存储库开始，必要时迁移到多个。迁移几乎完成，它们仍在单个存储库中，由于它是单个存储库，因此没有报告任何投诉或问题。

这不是一个二元的、黑白的问题。

***做对你有用的事***——如果我处于你的位置，我会尽可能快地将项目组合到一个存储库中，因为我可以键入命令，因为成本将是我（非常非常小的）公司的主要考虑因素。

JFTR：

***Subversion 中的修订号***在存储库之外确实没有任何意义。如果您需要有意义的修订名称，请*创建一个 TAG*

提交消息很容易按存储库中的路径过滤，因此只阅读与特定项目相关的消息是一个简单的练习。

* * *

编辑：有关为 SVN 使用单一授权/身份验证配置的详细信息，请参阅[Blade的响应。](https://stackoverflow.com/users/4064/blade)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-31T03:48:51.687

对于您的特定情况，一（1）个存储库是完美的。你会节省很多钱。我总是鼓励人们使用单个存储库。因为它类似于单个文件系统：**更容易**

*   您将在一个地方查找代码
*   您将获得单一授权
*   您将有一个提交编号（曾经尝试构建一个分布在 3 个存储库中的项目？）
*   您可以更好地重用常用库并跟踪您在这些库中的进度（svn:externals 是 PITA，不会解决所有问题）
*   计划为完全不同的项目的项目可以共同成长并共享功能和界面。这将很难在多个回购中实现。

多个存储库有一个要点：管理庞大的存储库很不舒服。转储/加载巨大的回购需要很多时间。但是由于您不进行任何管理，我认为这不会是您的问题；）

SVN 在更大的存储库中可以很好地扩展，即使在巨大的（>100GB）存储库上也没有减速。

因此，使用单个存储库的麻烦会更少。**但是你真的应该考虑回购布局！**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-31T02:39:21.640

我会使用多个存储库。除了用户访问问题之外，它还使备份和恢复更容易。而且，如果您发现自己处于有人想为您的代码（及其历史记录）付费的位置，那么只给他们一个存储库转储会更容易。

我建议仅仅因为您的托管服务提供商的收费政策而整合存储库并不是一个很好的理由。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-31T03:51:55.003

我们使用单个存储库。我唯一关心的是规模，但在看到[ASF 的存储库](http://svn.apache.org/viewvc/)（700k 修订和计数）之后，我非常确信性能不会成为问题。

我们的项目都是相关的、不同的互锁模块，它们为任何给定的应用程序形成了一组依赖项。出于这个原因，单个存储库是理想的。您可能希望为每个项目使用单独的主干/分支/标签，但您仍然可以在单个修订中自动提交整个代码库的更改。这对于重构来说很棒。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-31T06:05:38.977

请注意，在做出决定时，[许多 SVN 存储库可以共享相同的配置文件。](http://www.gentoo-wiki.info/HOWTO_Trac_with_Apache2_SVN_and_multiple_Repositories)

示例（取自上面的链接）：

在外壳中：

```
$ svn-admin create /var/svn/repos1
$ svn-admin create /var/svn/repos2
$ svn-admin create /var/svn/repos3 
```

文件：/var/svn/repos1/conf/svnserve.conf

```
[general]
anon-access = none # or read or write
auth-access = write
password-db = /var/svn/conf/passwd
authz-db = /var/svn/conf/authz
realm = Repos1 SVN Repository 
```

文件：/var/svn/conf/authz

```
[groups]
group_repos1_read = user1, user2
group_repos1_write = user3, user4
group_repos2_read = user1, user4

### Global Right for all repositories ###
[/]
### Could be a superadmin or something else ###
user5 = rw

### Global Rights for one repository (e.g. repos1) ###
[repos1:/]
@group_repos1_read = r
@group_repos1_write = rw

### Repository folder specific rights (e.g. the trunk folder) ###
[repos1:/trunk]
user1 = rw

### And soon for the other repositories ###
[repos2:/]
@group_repos2_read = r
user3 = rw 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-31T02:44:13.643

我会创建**单独的存储库**...为什么？如果您只有一个存储库中有很多不相关的项目，那么修订号和提交消息将没有任何意义，短期内肯定会一团糟......

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-31T05:15:26.007

我们是一家小型软件公司，我们所有的开发都使用一个 repo。树看起来像这样：

```
/client/<clientname>/<project>/<trunk, branches, tags> 
```

我们的想法是我们将在同一个 repo 中进行客户和内部工作，但最终我们将公司作为自己的“客户”。

这对我们来说非常有效，我们使用 Trac 来连接它。修订号遍布整个回购，而不是特定于一个项目，但这并不影响我们。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-31T02:43:05.703

就个人而言，我会为每个人创建新的存储库。它使结帐过程更加简单，并且使整个管理更容易，至少在用户访问和备份方面是这样。此外，它避免了全局版本号问题，因此版本号对所有项目都有意义。

真的，你应该只使用 git ;)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-12-09T21:58:14.707

要考虑的另一件事是，使用多个存储库会导致您失去拥有统一日志记录（svn log 命令）的能力，这将是选择单个存储库的好理由。

我使用 TortuiseSvn 发现“显示日志”选项是一个强制工具。尽管您的项目不相关，但我相信您会发现拥有一个集中的全局跨项目信息（路径、错误 ID、消息等......）总是有用的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-31T04:20:08.877

如果您计划或使用与 SVN 集成的 trac 之类的工具，则每个项目使用一个 repo 更有意义。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-31T14:45:48.057

与 Blade 关于共享文件的建议类似，这里有一个稍微简单但不太灵活的解决方案。我这样设置我们的：

*   /var/svn/
*   /var/svn/bin
*   /var/svn/repository_files
*   /var/svn/svnroot
*   /var/svn/svnroot/repos1
*   /var/svn/svnroot/repos2
*   ...

在“bin”中，我保留了一个名为 svn-create.sh 的脚本，它将完成创建空存储库的所有设置工作。我还将备份脚本保存在那里。

在“repository_files”中，我保留了所有存储库都有符号链接的通用“conf”和“hooks”目录。然后，只有一组文件。不过，这确实消除了在不中断链接的情况下进行细粒度的、每个项目的访问的能力。这不是我在哪里设置的问题。

最后，我将主目录 /var/svn 置于源代码控制之下，忽略 svnroot 中的所有内容。这样，存储库文件和脚本也处于源代码控制之下。

```
#!/bin/bash

# Usage:
# svn-create.sh repository_name

# This will:
# - create a new repository
# - link the necessary commit scripts
# - setup permissions
# - create and commit the initial directory structure
# - clean up after itself

if [ "empty" = ${1}"empty" ] ; then
  echo "Usage:"
  echo "    ${0} repository_name"
  exit
fi

SVN_HOME=/svn
SVN_ROOT=${SVN_HOME}/svnroot
SVN_COMMON_FILES=${SVN_HOME}/repository_files
NEW_DIR=${SVN_ROOT}/${1}
TMP_DIR=/tmp/${1}_$$

echo "Creating repository: ${1}"

# Create the repository
svnadmin create ${NEW_DIR}

# Copy/Link the hook scripts
cd ${NEW_DIR}
rm -rf hooks
ln -s ${SVN_COMMON_FILES}/hooks hooks

# Setup the user configuration
cd ${NEW_DIR}
rm -rf conf
ln -s ${SVN_COMMON_FILES}/conf conf

# Checkout the newly created project
svn co file://${NEW_DIR} ${TMP_DIR}

# Create the initial directory structure
cd ${TMP_DIR}
mkdir trunk
mkdir tags
mkdir branches

# Schedule the directories addition to the repository
svn add trunk tags branches

# Check in the changes
svn ci -m "Initial Setup"

# Delete the temporary working copy
cd /
rm -rf ${TMP_DIR}

# That's it!
echo "Repository ${1} created. (most likely)" 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-06-01T16:02:12.053

类似于 mlambie 使用单个 repo，但在文件夹结构方面更进一步，可以轻松缩放到特定类型的项目 - 基于 web html 的项目 vs. cs (C#) vs. sql (SQL create/execute scripts) vs. xyz (领域特定语言，如 afl（AmiBroker 公式语言）或 ts（TradeStation））：

```
/<src|lib>/<app-settings|afl|cs|js|iphone|sql|ts|web>/<ClientName>/<ProjectName>/<branches|tags> 
```

请注意，我将主干放在分支中，因为我将其视为默认分支。有时唯一的痛苦是当您想快速创建另一个项目时，您需要构建 ProjectName/branches|tags 结构。我使用 app-settings 只是将特定的应用程序设置文件保存在 repo 中，以便于其他人轻松共享（并在此文件夹结构中将 ClientName 替换为 VendorName 并将 ProjectName 替换为 AppName ；并且分支|标签可用于标记跨不同专业的设置供应商产品的版本）。

欢迎对我的结构发表任何评论 - 我最近将其更改为这个，到目前为止非常高兴，但有时发现维护每个项目的分支|标签结构很麻烦 - 特别是如果项目只是一个项目设置，只是为了对另一个项目进行单元测试。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-31T02:36:36.077

我的建议是一个。除非您有不同的用户访问每个用户，否则我会说使用多个。

但同样，即使这也不是使用多个的好理由。

# asp.net - 如何将 NLog 消息输出到 Visual Studio 的输出窗口？

> ID：252464
> 
> 赞同：67
> 
> 时间：2008-10-31T02:37:17.243
> 
> 标签：asp.net, nlog

我正在尝试将输出发送到控制台（或 colouredconsole）......我希望它（也是？）转到`Output`任何 ASP.NET 网站/应用程序/mvc 应用程序的 Visual Studio 窗口。

默认情况下它不是，但如果我将目标更改为“文件”，那么它肯定可以工作。

NLog 可以输出到`Output`web 应用程序的窗口吗？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-11-04T01:41:54.713

您可以使用此配置文件（应用路径中的 nlog.config）：

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <targets>
        <target name="debugger" xsi:type="Debugger" layout="${logger}::${message}"/>
  </targets>

  <rules>
    <logger name="*" minlevel="Trace" writeTo="debugger" />
  </rules>
</nlog> 
```

-斯科特

# c - 为什么 switch 语句被设计为需要中断？

> ID：252489
> 
> 赞同：148
> 
> 时间：2008-10-31T02:56:42.493
> 
> 标签：c, language-design

给定一个简单的 switch 语句

```
switch (int)
{
    case 1 :
    {
        printf("1\n");
        break;
    }

    case 2 : 
    {
        printf("2\n");
    }

    case 3 : 
    {
        printf("3\n");
    }
} 
```

在 case 2 中没有 break 语句，意味着在 case 3 的代码中继续执行。这不是偶然的；它就是这样设计的。为什么做出这个决定？与块的自动中断语义相比，这有什么好处？理由是什么？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2008-10-31T06:18:53.567

许多答案似乎都集中在失败的能力上作为要求声明的*原因。*`break`

我相信这只是一个错误，主要是因为在设计 C 语言时，并没有太多关于如何使用这些结构的经验。

Peter Van der Linden 在他的《Expert C Programming》一书中提出了这个问题：

> 我们分析了 Sun C 编译器源代码，以了解使用默认失败的频率。Sun ANSI C 编译器前端有 244 个 switch 语句，每个语句平均有 7 个 case。在所有这些案例中，只有 3% 发生了失败。
> 
> 换句话说，正常的开关行为在97% 的情况下都是*错误的。*它不仅在编译器中 - 相反，在此分析中使用失败通常用于在编译器中比在其他软件中更频繁地发生的情况，例如，在编译可以具有一个或两个操作数的运算符时：
> 
> ```
> switch (operator->num_of_operands) {
>     case 2: process_operand( operator->operand_2);
>               /* FALLTHRU */
> 
>     case 1: process_operand( operator->operand_1);
>     break;
> } 
> ```
> 
> 案例失败被广泛认为是一种缺陷，甚至还有一个特殊的注释约定，如上所示，它告诉 lint “这确实是需要失败的 3% 案例之一。”

我认为对于 C# 来说，在每个 case 块的末尾需要一个明确的跳转语句是个好主意（同时仍然允许堆叠多个 case 标签——只要只有一个语句块）。在 C# 中，您仍然可以让一个案例落入另一个案例 - 您只需通过使用`goto`.

太糟糕了Java没有抓住机会打破C语义。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-31T03:06:25.220

在很多方面，c 只是标准汇编习惯用法的干净接口。在编写跳转表驱动流控制时，程序员可以选择是跳出还是跳出“控制结构”，而跳出需要显式指令。

所以，c做同样的事情......

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-31T03:03:07.973

要实现 Duff 的设备，显然：

```
dsend(to, from, count)
char *to, *from;
int count;
{
    int n = (count + 7) / 8;
    switch (count % 8) {
    case 0: do { *to = *from++;
    case 7:      *to = *from++;
    case 6:      *to = *from++;
    case 5:      *to = *from++;
    case 4:      *to = *from++;
    case 3:      *to = *from++;
    case 2:      *to = *from++;
    case 1:      *to = *from++;
               } while (--n > 0);
    }
} 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-10-31T03:01:23.077

如果案例被设计为隐式中断，那么您就不可能失败。

```
case 0:
case 1:
case 2:
    // all do the same thing.
    break;
case 3:
case 4:
    // do something different.
    break;
default:
    // something else entirely. 
```

如果开关设计为在每个案例之后隐式中断，您将别无选择。开关盒结构的设计方式更加灵活。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-10-31T03:02:43.357

switch 语句中的 case 语句只是简单的标签。

当您打开一个值时，switch 语句本质上会*转到*具有匹配值的标签。

这意味着中断是必要的，以避免传递到下一个标签下的代码。

至于以这种方式实现的原因 - switch 语句的贯穿特性在某些情况下可能很有用*。*例如：

```
case optionA:
    // optionA needs to do its own thing, and also B's thing.
    // Fall-through to optionB afterwards.
    // Its behaviour is a superset of B's.
case optionB:
    // optionB needs to do its own thing
    // Its behaviour is a subset of A's.
    break;
case optionC:
    // optionC is quite independent so it does its own thing.
    break; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-11-12T22:42:22.023

允许这样的事情：

```
switch(foo) {
case 1:
    /* stuff for case 1 only */
    if (0) {
case 2:
    /* stuff for case 2 only */
    }
    /* stuff for cases 1 and 2 */
case 3:
    /* stuff for cases 1, 2, and 3 */
} 
```

将`case`关键字视为`goto`标签，它会自然而然地出现。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-31T03:01:30.143

当多个案例需要执行相同的代码（或按顺序执行相同的代码）时，它消除了代码重复。

由于在汇编语言级别上，它并不关心您是否在每一个之间中断，无论如何，失败案例的开销为零，所以为什么不允许它们，因为它们在某些情况下提供了显着的优势。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-08-14T10:14:38.233

我碰巧遇到了将向量中的值分配给结构的情况：必须以这样一种方式完成，即如果数据向量短于结构中数据成员的数量，则其余成员将保留在他们的默认值。在那种情况下，省略`break`是非常有用的。

```
switch (nShorts)
{
case 4: frame.leadV1    = shortArray[3];
case 3: frame.leadIII   = shortArray[2];
case 2: frame.leadII    = shortArray[1];
case 1: frame.leadI     = shortArray[0]; break;
default: TS_ASSERT(false);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T05:29:25.510

正如这里许多人所指定的，它允许单个代码块适用于多种情况。对于您的 switch 语句，这**应该**比您在示例中指定的“每个案例的代码块”更常见。

如果您每个案例都有一个代码块而没有失败，也许您应该考虑使用 if-elseif-else 块，因为这似乎更合适。

# c++ - Boost 最新版本兼容 VC++6 是什么？

> ID：252492
> 
> 赞同：14
> 
> 时间：2008-10-31T02:57:23.770
> 
> 标签：c++, visual-c++, boost, visual-c++-6

与 Microsoft Visual C++ 6 兼容的 Boost 库的最新版本是什么？你能提供一个链接直接下载吗？

[http://www.boost.org](http://www.boost.org)上的下载链接仅提供版本 1.36.0 的下载，该版本的文档将 Visual C++ 7.1 列为测试的 Microsoft 编译器的最低版本。他们会清除旧版本的下载吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-31T03:23:37.807

Boost [1.34.1](http://www.boost.org/users/history/version_1_34_1)已经用 vc6 进行了测试。旧版本仍然可用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-31T03:28:42.117

[您可以从SourceForge 上的 boost 下载页面](http://sourceforge.net/project/showfiles.php?group_id=7586&package_id=8041)获取所有旧版本。

用于回归测试的编译器可能隐藏在 boost.org 网站的某个地方。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T20:31:36.417

值得注意的是，Boost 也不是主动*不*支持 VC6。大多数 boost 库可能仍然可以与 VC6 一起使用（据我所知，它们还没有删除 VC6 兼容性代码）

所以你可以试试 1.36.1 看看你能走多远。

# .net - 如何截断.net中的日期？

> ID：252493
> 
> 赞同：3
> 
> 时间：2008-10-31T02:59:14.203
> 
> 标签：.net

除了 DateTime ctor (new DateTime(year, month, day)) 之外，还有其他方法可以截断日期吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-31T02:59:56.323

[日期时间.日期](http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx)

仅返回日期部分（时间为午夜）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T03:00:17.463

```
DateTime.Now.ToShortDateString(); 
```

此外，ToString() 在 DateTime 中被重载，您可以将几十个格式化选项传递给它。

请参阅： [http ://authors.aspalliance.com/aspxtreme/sys/demos/datetimeformats.aspx](http://authors.aspalliance.com/aspxtreme/sys/demos/datetimeformats.aspx)

# nhibernate - 使用 nHibernate 命名的查询

> ID：252506
> 
> 赞同：4
> 
> 时间：2008-10-31T03:10:28.613
> 
> 标签：nhibernate, named-query

我在让命名查询与 nHibernate 一起工作时遇到了很多麻烦。我最新的问题是收到错误消息“无法执行查询”，但没有其他信息。有没有我可以从某个地方下载的完整示例，因为所有教程和文档示例都提供了代码片段，但只讲述了让它工作的故事的一半。

这是给我带来问题的代码。

**班级**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
namespace Model.Entities
{
    public class TableInfo
    {
        public string TABLENAME { get; set; }
        public string COLUMNNAME { get; set; }
        #region Overrides
        public override int GetHashCode()
        {
            int result = TABLENAME.GetHashCode();
            result += COLUMNNAME.GetHashCode();
            return result;
        }
        public override bool Equals(object obj)
        {
            if (obj == null) return false;
            TableInfo dict = (TableInfo)obj;
            return
                dict.TABLENAME.IsEqual(this.TABLENAME) &&
                dict.COLUMNNAME.IsEqual(this.COLUMNNAME);
        }
        #endregion
    }
} 
```

**映射文件**

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="Model.Entities" assembly="Model" default-lazy="false">

  <class name="Model.Entities.TableInfo, Model" table="UIM_TableColumnInfo">
    <composite-id>
      <key-property name="TABLENAME" column="TABLENAME" type="string"></key-property>
      <key-property name="COLUMNNAME" column="COLUMNNAME" type="string"></key-property>
    </composite-id>
  </class>

  <sql-query name="GetTableInfo">
    <return alias="tableInfo" class="Model.Entities.TableInfo, Model">
      <return-property name="TABLENAME" column="TABLENAME"/>
      <return-property name="COLUMNNAME" column="COLUMNNAME"/>
    </return>
    <![CDATA[
select 
        info.tci_table_name TABLENAME
        , info.tci_column_name COLUMNNAME
        from ALL_TAB_COLS c
        ,( select 'DATE' TYPE_NAME, 'D' data_type_ind from dual
           union select 'NUMBER','N' from dual
           union select 'VARCHAR2','S' from dual
         ) ct
        , UIM_TableColumnInfo info
        where c.DATA_TYPE         = ct.TYPE_NAME (+)
                and   c.column_id is not null
        and UPPER(c.TABLE_NAME)   = :TableName
        and UPPER(c.COLUMN_NAME)  = UPPER(info.tci_column_name (+))
        order by c.column_id
    ]]>
  </sql-query>  

</hibernate-mapping> 
```

**调用代码**

```
public List<TableInfo> GetTableInfo(string tableName)
{
    return m_TableInfoRepository
        .NamedQuery("GetTableInfo")
        .SetString("TableName", tableName)
        .List<TableInfo>() as List<TableInfo>;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T15:01:20.047

我假设你之前已经在你的客户端数据库中测试过 SQL，所以我认为也许我们应该看看里面发生了什么，所以我可以向你推荐这个链接；

1.  [命名查询错误](http://forum.hibernate.org/viewtopic.php?t=938710&sid=f457c1ab5873b97794203503d750567e)
2.  [在 ASP.NET 2.0 应用程序中使用 NHibernate 和 Log4Net](http://www.beansoftware.com/asp.net-tutorials/nhibernate-log4net.aspx)
3.  [如何查看 nHibernate 生成的 SQL？](https://stackoverflow.com/questions/129133/how-do-i-view-the-sql-that-is-generated-by-nhibernate)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T03:40:31.547

也许我错了，但似乎表“TABLENAME”和参数“:TableName”之间可能存在冲突，如果您尝试使用另一个参数名称会发生​​什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-25T13:02:35.777

内部异常应该提供生成并尝试运行的实际 sql。将其粘贴到数据库查询中并直接在数据库中运行。这将有助于指导您。一旦你知道为什么不能执行 SQL 就会容易很多

# c++ - 为什么我们甚至需要“delete[]”操作符？

> ID：252515
> 
> 赞同：38
> 
> 时间：2008-10-31T03:23:10.177
> 
> 标签：c++, arrays, memory-management, heap-memory

这是一个困扰我一段时间的问题。我一直认为 C++ 的设计应该使`delete`运算符（不带括号）即使与`new[]`运算符一起工作。

在我看来，写这个：

```
int* p = new int; 
```

应该等同于分配一个包含 1 个元素的数组：

```
int* p = new int[1]; 
```

如果这是真的，那么`delete`操作符总是可​​以删除数组，我们就不需要`delete[]`操作符了。

`delete[]`在 C++ 中引入运算符有什么原因吗？我能想到的唯一原因是分配数组的内存占用很小（您必须将数组大小存储在某个地方），因此区分`delete`vs`delete[]`是一个小的内存优化。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-31T03:25:46.290

这样就可以调用各个元素的析构函数。是的，对于 POD 数组，没有太大区别，但是在 C++ 中，您可以拥有具有非平凡析构函数的对象数组。

现在，您的问题是，为什么不让`new`和`delete`表现得像`new[]`and`delete[]`并摆脱`new[]`and `delete[]`？我会回到 Stroustrup 的“设计与进化”一书中，他说如果你不使用 C++ 特性，你不应该为它们付费（至少在运行时）。按照现在的方式， a `new`or的行为将与and`delete`一样有效。如果有意义，在运行时会有一些额外的开销（正如 James Curran 指出的那样）。`malloc``free``delete``delete[]`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-31T07:50:08.393

该死的，我错过了整个问题的重点，但我会把我原来的答案作为旁注。为什么我们有`delete[]`是因为很久以前我们有`delete[cnt]`，即使在今天你写`delete[9]`or `delete[cnt]`，编译器只是忽略之间的东西`[]`但编译OK。那时，C++首先由前端处理，然后馈送到普通的C编译器。他们无法将伯爵藏在窗帘下的某个地方，也许他们当时根本想不到。并且为了向后兼容，编译器很可能使用在 之间给出的值`[]`作为数组的计数，如果没有这样的值，那么他们从前缀中获取计数，所以它是双向的。后来，我们之间没有输入任何内容`[]`，一切正常。今天，我不认为`delete[]`是必要的，但实现需要这样。

我的原始答案（没有抓住重点）：

`delete`删除单个对象。`delete[]`删除一个对象数组。为了`delete[]`工作，实现保持数组中元素的数量。我只是通过调试 ASM 代码仔细检查了这一点。在我测试的实现（VS2005）中，计数被存储为对象数组的前缀。

如果`delete[]`在单个对象上使用，则 count 变量是垃圾，因此代码会崩溃。如果使用`delete`对象数组，由于某些不一致，代码会崩溃。我刚刚测试了这些案例！

“`delete`只是删除分配给数组的内存。” 另一个答案中的陈述是不正确的。如果对象是一个类，`delete`就会调用DTOR。只需在 DTOR 代码和`delete`对象中放置一个断点，断点就会命中。

我想到的是，如果编译器和库假设所有分配的对象`new`都是对象数组，那么调用`delete`单个对象或对象数组就可以了。单个对象只是计数为 1 的对象数组的特例。无论如何，也许我缺少一些东西。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-31T04:51:54.163

由于其他人似乎都错过了您的问题的重点，我只想补充一点，几年前我也有同样的想法，但一直无法得到答案。

我唯一能想到的是将单个对象视为数组（不必要的 " `for(int i=0; i<1; ++i)`" ）的额外开销非常小

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-31T20:32:13.327

添加这个，因为目前没有其他答案解决它：

数组`delete[]`永远不能用在指向基类的指针上——当你调用时编译器存储对象的数量`new[]`，它不存储对象的类型或大小（正如大卫指出的那样，在 C++ 中你很少支付对于您未使用的功能）。但是，标量`delete`可以通过基类安全地删除，因此它既可用于普通对象清理，也可用于多态清理：

```
struct Base { virtual ~Base(); };
struct Derived : Base { };
int main(){
    Base* b = new Derived;
    delete b; // this is good

    Base* b = new Derived[2];
    delete[] b; // bad! undefined behavior
} 
```

然而，在相反的情况下——非虚拟析构函数——标量`delete`应该尽可能便宜——它不应该检查对象的数量，也不应该检查被删除对象的类型。这使得对内置类型或普通旧数据类型的删除非常便宜，因为编译器只需要调用而不需要`::operator delete`其他任何东西：

```
int main(){
    int * p = new int;
    delete p; // cheap operation, no dynamic dispatch, no conditional branching
} 
```

虽然不是对内存分配的详尽处理，但我希望这有助于阐明 C++ 中可用的内存管理选项的广度。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-31T03:29:19.620

Marshall Cline 有一些[关于这个主题](http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.13)的信息。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-31T03:27:23.993

`delete []`确保调用每个成员的析构函数（如果适用于类型），同时`delete`删除为数组分配的内存。

这是一个很好的阅读：[http ://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=287](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=287)

~~不，数组大小不存储在 C++ 中的任何位置。~~（感谢大家指出这个说法不准确。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-12-04T14:53:27.877

我对 Aaron 的回答有点困惑，坦率地说我不完全理解为什么需要以及在哪里`delete[]`需要。

我用他的示例代码做了一些实验（在修正了一些错别字之后）。这是我的结果。错别字：`~Base`需要一个函数体 `Base *b`被声明了两次

```
struct Base { virtual ~Base(){ }>; };
struct Derived : Base { };
int main(){
Base* b = new Derived;
delete b; // this is good

<strike>Base</strike> b = new Derived[2];
delete[] b; // bad! undefined behavior
} 
```

编译和执行

```
david@Godel:g++ -o atest atest.cpp 
david@Godel: ./atest 
david@Godel: # No error message 
```

`delete[]`已删除的修改程序

```
struct Base { virtual ~Base(){}; };
struct Derived : Base { };

int main(){
    Base* b = new Derived;
    delete b; // this is good

    b = new Derived[2];
    delete b; // bad! undefined behavior
} 
```

编译和执行

```
david@Godel:g++ -o atest atest.cpp 
david@Godel: ./atest 
atest(30746) malloc: *** error for object 0x1099008c8: pointer being freed was n
ot allocated
*** set a breakpoint in malloc_error_break to debug
Abort trap: 6 
```

当然，我不知道`delete[] b`第一个例子是否真的有效；我只知道它不会给出编译器错误消息。

# c# - 直接流式传输到数据库

> ID：252517
> 
> 赞同：0
> 
> 时间：2008-10-31T03:25:19.223
> 
> 标签：c#, .net, sql-server, .net-2.0

我正在使用 c#，并且有一个打开的 tcpip 连接接收数据。是否可以在我接收流时将流保存到 ms sql server 数据库，而不是接收所有数据然后全部保存？如果可以在接收流时将流发送到数据库，则您不必将整个数据块保存在内存中。这是可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T03:30:26.233

您是作为 BLOB 写入数据库，还是以某种形式翻译数据，然后为每一行执行插入？

你在评论中的回答让我很困惑。将流写入 BLOB 列与获取数据然后将其转换为单独行的插入是完全不同的。

无论如何，通过首先使用需要插入的 blob 列创建行，重复调用更新语句，可以流式传输到 BLOB 列：

```
update myTable set myColumn.Write(@data, @offset, @length) where someid = @someId 
```

用于流中的字节块。

[完美的例子位于此处。](http://weblogs.asp.net/alessandro/archive/2008/09/22/conserving-resources-when-writing-blob-values-to-sql-server-and-streaming-blob-values-back-to-the-client.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T09:10:52.363

SQL Server 2005 支持 HTTP 端点（不需要 IIS），因此一种解决方案是在 SQL Server 上创建一个 Web 服务来直接接收流数据。

这些链接解释了如何设置： [http ://codebetter.com/blogs/raymond.lewallen/archive/2005/06/23/65089.aspx](http://codebetter.com/blogs/raymond.lewallen/archive/2005/06/23/65089.aspx) [http://msdn.microsoft.com/en-us/library/ms345123。 aspx](http://msdn.microsoft.com/en-us/library/ms345123.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T09:44:06.027

有关使用流和数据库的示例，请参见[此处](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/314e7e3782e59a93)和[此处](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/fcd173f1db2951f1)。本质上，您需要传递重复的缓冲区（在 SQL Server 中最好是 8040 字节的倍数）。请注意，这些示例基于 SQL 2000；使用 SQL 2005，varbinary(max) 会更容易。不过非常相似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-02T03:16:52.573

为什么不在接收数据包时将缓冲区写入文件，然后在传输完成时插入数据库？

如果您直接流式传输到数据库，您将长时间保持与数据库的连接打开，尤其是在客户端的网络连接不是最好的情况下。

# sql - 计算两个日期之间的工作日

> ID：252519
> 
> 赞同：183
> 
> 时间：2008-10-31T03:26:07.863
> 
> 标签：sql, tsql, date

如何计算 SQL Server 中两个日期之间的工作日数？

星期一到星期五，它必须是 T-SQL。

* * *

## 回答 #1

> 赞同：330
> 
> 时间：2008-10-31T03:36:10.650

对于周一至周五的工作日，您可以使用单个 SELECT 来完成，如下所示：

```
DECLARE @StartDate DATETIME
DECLARE @EndDate DATETIME
SET @StartDate = '2008/10/01'
SET @EndDate = '2008/10/31'

SELECT
   (DATEDIFF(dd, @StartDate, @EndDate) + 1)
  -(DATEDIFF(wk, @StartDate, @EndDate) * 2)
  -(CASE WHEN DATENAME(dw, @StartDate) = 'Sunday' THEN 1 ELSE 0 END)
  -(CASE WHEN DATENAME(dw, @EndDate) = 'Saturday' THEN 1 ELSE 0 END) 
```

如果要包括假期，则必须稍微考虑一下...

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-31T03:36:08.420

在*[计算工作日](http://www.sqlservercentral.com/articles/Advanced+Querying/calculatingworkdays/1660/)*你可以找到一篇关于这个主题的好文章，但是你可以看到它不是那么先进。

```
--Changing current database to the Master database allows function to be shared by everyone.
USE MASTER
GO
--If the function already exists, drop it.
IF EXISTS
(
    SELECT *
    FROM dbo.SYSOBJECTS
    WHERE ID = OBJECT_ID(N'[dbo].[fn_WorkDays]')
    AND XType IN (N'FN', N'IF', N'TF')
)
DROP FUNCTION [dbo].[fn_WorkDays]
GO
 CREATE FUNCTION dbo.fn_WorkDays
--Presets
--Define the input parameters (OK if reversed by mistake).
(
    @StartDate DATETIME,
    @EndDate   DATETIME = NULL --@EndDate replaced by @StartDate when DEFAULTed
)

--Define the output data type.
RETURNS INT

AS
--Calculate the RETURN of the function.
BEGIN
    --Declare local variables
    --Temporarily holds @EndDate during date reversal.
    DECLARE @Swap DATETIME

    --If the Start Date is null, return a NULL and exit.
    IF @StartDate IS NULL
        RETURN NULL

    --If the End Date is null, populate with Start Date value so will have two dates (required by DATEDIFF below).
     IF @EndDate IS NULL
        SELECT @EndDate = @StartDate

    --Strip the time element from both dates (just to be safe) by converting to whole days and back to a date.
    --Usually faster than CONVERT.
    --0 is a date (01/01/1900 00:00:00.000)
     SELECT @StartDate = DATEADD(dd,DATEDIFF(dd,0,@StartDate), 0),
            @EndDate   = DATEADD(dd,DATEDIFF(dd,0,@EndDate)  , 0)

    --If the inputs are in the wrong order, reverse them.
     IF @StartDate > @EndDate
        SELECT @Swap      = @EndDate,
               @EndDate   = @StartDate,
               @StartDate = @Swap

    --Calculate and return the number of workdays using the input parameters.
    --This is the meat of the function.
    --This is really just one formula with a couple of parts that are listed on separate lines for documentation purposes.
     RETURN (
        SELECT
        --Start with total number of days including weekends
        (DATEDIFF(dd,@StartDate, @EndDate)+1)
        --Subtact 2 days for each full weekend
        -(DATEDIFF(wk,@StartDate, @EndDate)*2)
        --If StartDate is a Sunday, Subtract 1
        -(CASE WHEN DATENAME(dw, @StartDate) = 'Sunday'
            THEN 1
            ELSE 0
        END)
        --If EndDate is a Saturday, Subtract 1
        -(CASE WHEN DATENAME(dw, @EndDate) = 'Saturday'
            THEN 1
            ELSE 0
        END)
        )
    END
GO 
```

如果您需要使用自定义日历，您可能需要添加一些检查和一些参数。希望它将提供一个良好的起点。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-11-22T16:05:40.203

全部归功于 Bogdan Maxim 和 Peter Mortensen。这是他们的帖子，我只是在函数中添加了假期（假设您有一个带有日期时间字段“HolDate”的表“tblHolidays”。

```
--Changing current database to the Master database allows function to be shared by everyone.
USE MASTER
GO
--If the function already exists, drop it.
IF EXISTS
(
    SELECT *
    FROM dbo.SYSOBJECTS
    WHERE ID = OBJECT_ID(N'[dbo].[fn_WorkDays]')
    AND XType IN (N'FN', N'IF', N'TF')
)

DROP FUNCTION [dbo].[fn_WorkDays]
GO
 CREATE FUNCTION dbo.fn_WorkDays
--Presets
--Define the input parameters (OK if reversed by mistake).
(
    @StartDate DATETIME,
    @EndDate   DATETIME = NULL --@EndDate replaced by @StartDate when DEFAULTed
)

--Define the output data type.
RETURNS INT

AS
--Calculate the RETURN of the function.
BEGIN
    --Declare local variables
    --Temporarily holds @EndDate during date reversal.
    DECLARE @Swap DATETIME

    --If the Start Date is null, return a NULL and exit.
    IF @StartDate IS NULL
        RETURN NULL

    --If the End Date is null, populate with Start Date value so will have two dates (required by DATEDIFF below).
    IF @EndDate IS NULL
        SELECT @EndDate = @StartDate

    --Strip the time element from both dates (just to be safe) by converting to whole days and back to a date.
    --Usually faster than CONVERT.
    --0 is a date (01/01/1900 00:00:00.000)
    SELECT @StartDate = DATEADD(dd,DATEDIFF(dd,0,@StartDate), 0),
            @EndDate   = DATEADD(dd,DATEDIFF(dd,0,@EndDate)  , 0)

    --If the inputs are in the wrong order, reverse them.
    IF @StartDate > @EndDate
        SELECT @Swap      = @EndDate,
               @EndDate   = @StartDate,
               @StartDate = @Swap

    --Calculate and return the number of workdays using the input parameters.
    --This is the meat of the function.
    --This is really just one formula with a couple of parts that are listed on separate lines for documentation purposes.
    RETURN (
        SELECT
        --Start with total number of days including weekends
        (DATEDIFF(dd,@StartDate, @EndDate)+1)
        --Subtact 2 days for each full weekend
        -(DATEDIFF(wk,@StartDate, @EndDate)*2)
        --If StartDate is a Sunday, Subtract 1
        -(CASE WHEN DATENAME(dw, @StartDate) = 'Sunday'
            THEN 1
            ELSE 0
        END)
        --If EndDate is a Saturday, Subtract 1
        -(CASE WHEN DATENAME(dw, @EndDate) = 'Saturday'
            THEN 1
            ELSE 0
        END)
        --Subtract all holidays
        -(Select Count(*) from [DB04\DB04].[Gateway].[dbo].[tblHolidays]
          where  [HolDate] between @StartDate and @EndDate )
        )
    END  
GO
-- Test Script
/*
declare @EndDate datetime= dateadd(m,2,getdate())
print @EndDate
select  [Master].[dbo].[fn_WorkDays] (getdate(), @EndDate)
*/ 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-02-24T20:14:44.177

我将接受的答案版本作为函数使用`DATEPART`，因此我不必在行上进行字符串比较

```
DATENAME(dw, @StartDate) = 'Sunday' 
```

无论如何，这是我的业务 datediff 功能

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE FUNCTION BDATEDIFF
(
    @startdate as DATETIME,
    @enddate as DATETIME
)
RETURNS INT
AS
BEGIN
    DECLARE @res int

SET @res = (DATEDIFF(dd, @startdate, @enddate) + 1)
    -(DATEDIFF(wk, @startdate, @enddate) * 2)
    -(CASE WHEN DATEPART(dw, @startdate) = 1 THEN 1 ELSE 0 END)
    -(CASE WHEN DATEPART(dw, @enddate) = 7 THEN 1 ELSE 0 END)

    RETURN @res
END
GO 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-06-29T08:55:35.210

计算工作日的另一种方法是使用 WHILE 循环，该循环基本上迭代一个日期范围，并在发现日期在周一至周五之间时将其增加 1。使用 WHILE 循环计算工作日的完整脚本如下所示：

```
CREATE FUNCTION [dbo].[fn_GetTotalWorkingDaysUsingLoop]
(@DateFrom DATE,
@DateTo   DATE
)
RETURNS INT
AS
     BEGIN
         DECLARE @TotWorkingDays INT= 0;
         WHILE @DateFrom <= @DateTo
             BEGIN
                 IF DATENAME(WEEKDAY, @DateFrom) IN('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday')
                     BEGIN
                         SET @TotWorkingDays = @TotWorkingDays + 1;
                 END;
                 SET @DateFrom = DATEADD(DAY, 1, @DateFrom);
             END;
         RETURN @TotWorkingDays;
     END;
GO 
```

尽管 WHILE 循环选项更简洁并且使用的代码行更少，但它有可能成为您环境中的性能瓶颈，尤其是当您的日期范围跨越数年时。

您可以在本文中看到更多关于如何计算工作日和小时数的方法： [https ://www.sqlshack.com/how-to-calculate-work-days-and-hours-in-sql-server/](https://www.sqlshack.com/how-to-calculate-work-days-and-hours-in-sql-server/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-03-10T11:06:39.017

```
 DECLARE @TotalDays INT,@WorkDays INT
 DECLARE @ReducedDayswithEndDate INT
 DECLARE @WeekPart INT
 DECLARE @DatePart INT

 SET @TotalDays= DATEDIFF(day, @StartDate, @EndDate) +1
 SELECT @ReducedDayswithEndDate = CASE DATENAME(weekday, @EndDate)
  WHEN 'Saturday' THEN 1
  WHEN 'Sunday' THEN 2
  ELSE 0 END 
 SET @TotalDays=@TotalDays-@ReducedDayswithEndDate
 SET @WeekPart=@TotalDays/7;
 SET @DatePart=@TotalDays%7;
 SET @WorkDays=(@WeekPart*5)+@DatePart

 RETURN @WorkDays 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-02-10T14:04:55.073

*（我比评论特权差了几分）*

如果您决定放弃[CMS 优雅解决方案](https://stackoverflow.com/a/252533/373975)中的 +1 天，请注意，如果您的开始日期和结束日期在同一个周末，您会得到否定的答案。即，2008/10/26 到 2008/10/26 返回 -1。

我相当简单的解决方案：

```
select @Result = (..CMS's answer..)
if  (@Result < 0)
        select @Result = 0
    RETURN @Result 
```

.. 它还将所有*开始日期*晚于*结束日期*的错误帖子设置为零。您可能会或可能不会寻找的东西。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-10-15T14:43:48.873

对于包括假期在内的日期之间的差异，我这样做了：

1) 节假日表：

```
 CREATE TABLE [dbo].[Holiday](
[Id] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NULL,
[Date] [datetime] NOT NULL) 
```

2）我有这样的计划表，想填充空的 Work_Days 列：

```
 CREATE TABLE [dbo].[Plan_Phase](
[Id] [int] IDENTITY(1,1) NOT NULL,
[Id_Plan] [int] NOT NULL,
[Id_Phase] [int] NOT NULL,
[Start_Date] [datetime] NULL,
[End_Date] [datetime] NULL,
[Work_Days] [int] NULL) 
```

3）因此，为了让“Work_Days”稍后填写我的专栏，只需：

```
SELECT Start_Date, End_Date,
 (DATEDIFF(dd, Start_Date, End_Date) + 1)
-(DATEDIFF(wk, Start_Date, End_Date) * 2)
-(SELECT COUNT(*) From Holiday Where Date  >= Start_Date AND Date <= End_Date)
-(CASE WHEN DATENAME(dw, Start_Date) = 'Sunday' THEN 1 ELSE 0 END)
-(CASE WHEN DATENAME(dw, End_Date) = 'Saturday' THEN 1 ELSE 0 END)
-(CASE WHEN (SELECT COUNT(*) From Holiday Where Start_Date  = Date) > 0 THEN 1 ELSE 0 END)
-(CASE WHEN (SELECT COUNT(*) From Holiday Where End_Date  = Date) > 0 THEN 1 ELSE 0 END) AS Work_Days
from Plan_Phase 
```

希望我能提供帮助。

干杯

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-30T17:00:51.610

这是一个运行良好的版本（我认为）。Holiday 表包含Holiday_date 列，其中包含贵公司遵守的假期。

```
DECLARE @RAWDAYS INT

   SELECT @RAWDAYS =  DATEDIFF(day, @StartDate, @EndDate )--+1
                    -( 2 * DATEDIFF( week, @StartDate, @EndDate ) )
                    + CASE WHEN DATENAME(dw, @StartDate) = 'Saturday' THEN 1 ELSE 0 END
                    - CASE WHEN DATENAME(dw, @EndDate) = 'Saturday' THEN 1 ELSE 0 END 

   SELECT  @RAWDAYS - COUNT(*) 
     FROM HOLIDAY NumberOfBusinessDays
    WHERE [Holiday_Date] BETWEEN @StartDate+1 AND @EndDate 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-06-28T00:43:16.973

这基本上是 CMS 的答案，不依赖于特定的语言设置。而且由于我们正在拍摄通用，这意味着它也应该适用于所有`@@datefirst`设置。

```
datediff(day, <start>, <end>) + 1 - datediff(week, <start>, <end>) * 2
    /* if start is a Sunday, adjust by -1 */
  + case when datepart(weekday, <start>) = 8 - @@datefirst then -1 else 0 end
    /* if end is a Saturday, adjust by -1 */
  + case when datepart(weekday, <end>) = (13 - @@datefirst) % 7 + 1 then -1 else 0 end 
```

`datediff(week, ...)`几周内总是使用周六到周日的边界，因此该表达式是确定性的，不需要修改（只要我们对工作日的定义始终如一地从周一到周五）。日期编号确实会根据`@@datefirst`设置和修改后的计算通过一些模运算的小复杂性来处理这种校正。

处理周六/周日事情的一种更简洁的方法是在提取一周中的某一天值之前翻译日期。移位后，这些值将与固定的（可能更熟悉的）编号保持一致，该编号在周日以 1 开始，在周六以 7 结束。

```
datediff(day, <start>, <end>) + 1 - datediff(week, <start>, <end>) * 2
  + case when datepart(weekday, dateadd(day, @@datefirst, <start>)) = 1 then -1 else 0 end
  + case when datepart(weekday, dateadd(day, @@datefirst, <end>))   = 7 then -1 else 0 end 
```

至少早在 2002 年和 Itzik Ben-Gan 的一篇文章中，我就已经跟踪过这种形式的解决方案。（[https://technet.microsoft.com/en-us/library/aa175781(v=sql.80).aspx](https://technet.microsoft.com/en-us/library/aa175781(v=sql.80).aspx)）虽然它需要一个小的调整，因为新`date`类型不允许日期算术，但它是相同的。

编辑：我添加了`+1`以某种方式被遗漏的内容。还值得注意的是，此方法始终计算开始天数和结束天数。它还假定结束日期在开始日期之前或之后。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-07-05T13:05:49.130

我知道这是一个老问题，但我需要一个不包括开始日期的工作日公式，因为我有几个项目并且需要正确累积天数。

没有一个非迭代的答案对我有用。

我使用了类似的定义

> 午夜到周一、周二、周三、周四和周五的次数

（其他人可能会计算午夜到星期六而不是星期一）

我最终得到了这个公式

```
SELECT DATEDIFF(day, @StartDate, @EndDate) /* all midnights passed */
     - DATEDIFF(week, @StartDate, @EndDate) /* remove sunday midnights */
     - DATEDIFF(week, DATEADD(day, 1, @StartDate), DATEADD(day, 1, @EndDate)) /* remove saturday midnights */ 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-11-07T07:11:04.687

上述功能均不适用于同一周或处理假期。我写了这个：

```
create FUNCTION [dbo].[ShiftHolidayToWorkday](@date date)
RETURNS date
AS
BEGIN
    IF DATENAME( dw, @Date ) = 'Saturday'
        SET @Date = DATEADD(day, - 1, @Date)

    ELSE IF DATENAME( dw, @Date ) = 'Sunday'
        SET @Date = DATEADD(day, 1, @Date)

    RETURN @date
END
GO

create FUNCTION [dbo].[GetHoliday](@date date)
RETURNS varchar(50)
AS
BEGIN
    declare @s varchar(50)

    SELECT @s = CASE
        WHEN dbo.ShiftHolidayToWorkday(CONVERT(varchar, [Year]  ) + '-01-01') = @date THEN 'New Year'
        WHEN dbo.ShiftHolidayToWorkday(CONVERT(varchar, [Year]+1) + '-01-01') = @date THEN 'New Year'
        WHEN dbo.ShiftHolidayToWorkday(CONVERT(varchar, [Year]  ) + '-07-04') = @date THEN 'Independence Day'
        WHEN dbo.ShiftHolidayToWorkday(CONVERT(varchar, [Year]  ) + '-12-25') = @date THEN 'Christmas Day'
        --WHEN dbo.ShiftHolidayToWorkday(CONVERT(varchar, [Year]) + '-12-31') = @date THEN 'New Years Eve'
        --WHEN dbo.ShiftHolidayToWorkday(CONVERT(varchar, [Year]) + '-11-11') = @date THEN 'Veteran''s Day'

        WHEN [Month] = 1  AND [DayOfMonth] BETWEEN 15 AND 21 AND [DayName] = 'Monday' THEN 'Martin Luther King Day'
        WHEN [Month] = 5  AND [DayOfMonth] >= 25             AND [DayName] = 'Monday' THEN 'Memorial Day'
        WHEN [Month] = 9  AND [DayOfMonth] <= 7              AND [DayName] = 'Monday' THEN 'Labor Day'
        WHEN [Month] = 11 AND [DayOfMonth] BETWEEN 22 AND 28 AND [DayName] = 'Thursday' THEN 'Thanksgiving Day'
        WHEN [Month] = 11 AND [DayOfMonth] BETWEEN 23 AND 29 AND [DayName] = 'Friday' THEN 'Day After Thanksgiving'
        ELSE NULL END
    FROM (
        SELECT
            [Year] = YEAR(@date),
            [Month] = MONTH(@date),
            [DayOfMonth] = DAY(@date),
            [DayName]   = DATENAME(weekday,@date)
    ) c

    RETURN @s
END
GO

create FUNCTION [dbo].GetHolidays(@year int)
RETURNS TABLE 
AS
RETURN (  
    select dt, dbo.GetHoliday(dt) as Holiday
    from (
        select dateadd(day, number, convert(varchar,@year) + '-01-01') dt
        from master..spt_values 
        where type='p' 
        ) d
    where year(dt) = @year and dbo.GetHoliday(dt) is not null
)

create proc UpdateHolidaysTable
as

if not exists(select TABLE_NAME from INFORMATION_SCHEMA.TABLES where TABLE_NAME = 'Holidays')
    create table Holidays(dt date primary key clustered, Holiday varchar(50))

declare @year int
set @year = 1990

while @year < year(GetDate()) + 20
begin
    insert into Holidays(dt, Holiday)
    select a.dt, a.Holiday
    from dbo.GetHolidays(@year) a
        left join Holidays b on b.dt = a.dt
    where b.dt is null

    set @year = @year + 1
end

create FUNCTION [dbo].[GetWorkDays](@StartDate DATE = NULL, @EndDate DATE = NULL)
RETURNS INT 
AS
BEGIN
    IF @StartDate IS NULL OR @EndDate IS NULL
        RETURN  0

    IF @StartDate >= @EndDate 
        RETURN  0

    DECLARE @Days int
    SET @Days = 0

    IF year(@StartDate) * 100 + datepart(week, @StartDate) = year(@EndDate) * 100 + datepart(week, @EndDate) 
        --same week
        select @Days = (DATEDIFF(dd, @StartDate, @EndDate))
      - (CASE WHEN DATENAME(dw, @StartDate) = 'Sunday' THEN 1 ELSE 0 END)
      - (CASE WHEN DATENAME(dw, @EndDate) = 'Saturday' THEN 1 ELSE 0 END)
      - (select count(*) from Holidays where dt between @StartDate and @EndDate)
    ELSE
        --diff weeks
        select @Days = (DATEDIFF(dd, @StartDate, @EndDate) + 1)
      - (DATEDIFF(wk, @StartDate, @EndDate) * 2)
      - (CASE WHEN DATENAME(dw, @StartDate) = 'Sunday' THEN 1 ELSE 0 END)
      - (CASE WHEN DATENAME(dw, @EndDate) = 'Saturday' THEN 1 ELSE 0 END)
      - (select count(*) from Holidays where dt between @StartDate and @EndDate)

    RETURN  @Days
END 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-03-12T16:56:01.427

使用日期表：

```
 DECLARE 
        @StartDate date = '2014-01-01',
        @EndDate date = '2014-01-31'; 
    SELECT 
        COUNT(*) As NumberOfWeekDays
    FROM dbo.Calendar
    WHERE CalendarDate BETWEEN @StartDate AND @EndDate
      AND IsWorkDay = 1; 
```

如果没有，可以使用数字表：

```
 DECLARE 
    @StartDate datetime = '2014-01-01',
    @EndDate datetime = '2014-01-31'; 
    SELECT 
    SUM(CASE WHEN DATEPART(dw, DATEADD(dd, Number-1, @StartDate)) BETWEEN 2 AND 6 THEN 1 ELSE 0 END) As NumberOfWeekDays
    FROM dbo.Numbers
    WHERE Number <= DATEDIFF(dd, @StartDate, @EndDate) + 1 -- Number table starts at 1, we want a 0 base 
```

它们都应该很快，并且消除了歧义/复杂性。第一个选项是最好的，但如果您没有日历表，您总是可以创建一个带有 CTE 的数字表。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-03-10T11:10:57.723

```
DECLARE @StartDate datetime,@EndDate datetime

select @StartDate='3/2/2010', @EndDate='3/7/2010'

DECLARE @TotalDays INT,@WorkDays INT

DECLARE @ReducedDayswithEndDate INT

DECLARE @WeekPart INT

DECLARE @DatePart INT

SET @TotalDays= DATEDIFF(day, @StartDate, @EndDate) +1

SELECT @ReducedDayswithEndDate = CASE DATENAME(weekday, @EndDate)
    WHEN 'Saturday' THEN 1
    WHEN 'Sunday' THEN 2
    ELSE 0 END

SET @TotalDays=@TotalDays-@ReducedDayswithEndDate

SET @WeekPart=@TotalDays/7;

SET @DatePart=@TotalDays%7;

SET @WorkDays=(@WeekPart*5)+@DatePart

SELECT @WorkDays 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-02-03T05:54:15.030

```
CREATE FUNCTION x
(
    @StartDate DATETIME,
    @EndDate DATETIME
)
RETURNS INT
AS
BEGIN
    DECLARE @Teller INT

    SET @StartDate = DATEADD(dd,1,@StartDate)

    SET @Teller = 0
    IF DATEDIFF(dd,@StartDate,@EndDate) <= 0
    BEGIN
        SET @Teller = 0 
    END
    ELSE
    BEGIN
        WHILE
            DATEDIFF(dd,@StartDate,@EndDate) >= 0
        BEGIN
            IF DATEPART(dw,@StartDate) < 6
            BEGIN
                SET @Teller = @Teller + 1
            END
            SET @StartDate = DATEADD(dd,1,@StartDate)
        END
    END
    RETURN @Teller
END 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-02-01T19:23:32.637

我在这里举了各种例子，但在我的特殊情况下，我们有一个用于交付的@PromisedDate 和一个用于实际接收物品的@ReceivedDate。当在“PromisedDate”之前收到一个项目时，除非我按日历顺序订购传递给函数的日期，否则计算的总计不正确。不想每次都检查日期，我更改了函数来为我处理这个问题。

```
Create FUNCTION [dbo].[fnGetBusinessDays]
(
 @PromiseDate date,
 @ReceivedDate date
)
RETURNS integer
AS
BEGIN
 DECLARE @days integer

 SELECT @days = 
    Case when @PromiseDate > @ReceivedDate Then
        DATEDIFF(d,@PromiseDate,@ReceivedDate) + 
        ABS(DATEDIFF(wk,@PromiseDate,@ReceivedDate)) * 2 +
        CASE 
            WHEN DATENAME(dw, @PromiseDate) <> 'Saturday' AND DATENAME(dw, @ReceivedDate) = 'Saturday' THEN 1 
            WHEN DATENAME(dw, @PromiseDate) = 'Saturday' AND DATENAME(dw, @ReceivedDate) <> 'Saturday' THEN -1 
            ELSE 0
        END +
        (Select COUNT(*) FROM CompanyHolidays 
            WHERE HolidayDate BETWEEN @ReceivedDate AND @PromiseDate 
            AND DATENAME(dw, HolidayDate) <> 'Saturday' AND DATENAME(dw, HolidayDate) <> 'Sunday')
    Else
        DATEDIFF(d,@PromiseDate,@ReceivedDate)  -
        ABS(DATEDIFF(wk,@PromiseDate,@ReceivedDate)) * 2  -
            CASE 
                WHEN DATENAME(dw, @PromiseDate) <> 'Saturday' AND DATENAME(dw, @ReceivedDate) = 'Saturday' THEN 1 
                WHEN DATENAME(dw, @PromiseDate) = 'Saturday' AND DATENAME(dw, @ReceivedDate) <> 'Saturday' THEN -1 
                ELSE 0
            END -
        (Select COUNT(*) FROM CompanyHolidays 
            WHERE HolidayDate BETWEEN @PromiseDate and @ReceivedDate 
            AND DATENAME(dw, HolidayDate) <> 'Saturday' AND DATENAME(dw, HolidayDate) <> 'Sunday')
    End

 RETURN (@days)

END 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-01-13T18:24:42.820

如果您需要将工作日添加到给定日期，您可以创建一个依赖于日历表的函数，如下所述：

```
CREATE TABLE Calendar
(
  dt SMALLDATETIME PRIMARY KEY, 
  IsWorkDay BIT
);

--fill the rows with normal days, weekends and holidays.

create function AddWorkingDays (@initialDate smalldatetime, @numberOfDays int)
    returns smalldatetime as 

    begin
        declare @result smalldatetime
        set @result = 
        (
            select t.dt from
            (
                select dt, ROW_NUMBER() over (order by dt) as daysAhead from calendar 
                where dt > @initialDate
                and IsWorkDay = 1
                ) t
            where t.daysAhead = @numberOfDays
        )

        return @result
    end 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-06-29T15:17:49.073

与 DATEDIFF 一样，我不认为结束日期是间隔的一部分。@StartDate 和@EndDate 之间的（例如）星期日数是“初始”星期一和@EndDate 之间的星期日数减去这个“初始”星期一和@StartDate 之间的星期日数。知道了这一点，我们可以计算工作日数如下：

```
DECLARE @StartDate DATETIME
DECLARE @EndDate DATETIME
SET @StartDate = '2018/01/01'
SET @EndDate = '2019/01/01'

SELECT DATEDIFF(Day, @StartDate, @EndDate) -- Total Days
  - (DATEDIFF(Day, 0, @EndDate)/7 - DATEDIFF(Day, 0, @StartDate)/7) -- Sundays
  - (DATEDIFF(Day, -1, @EndDate)/7 - DATEDIFF(Day, -1, @StartDate)/7) -- Saturdays 
```

最好的祝福！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-03-15T19:50:51.363

这对我有用，在我的国家，周六和周日是非工作日。

对我来说@StartDate 和@EndDate 的时间很重要。

```
CREATE FUNCTION [dbo].[fnGetCountWorkingBusinessDays]
(
    @StartDate as DATETIME,
    @EndDate as DATETIME
)
RETURNS INT
AS
BEGIN
    DECLARE @res int

SET @StartDate = CASE 
    WHEN DATENAME(dw, @StartDate) = 'Saturday' THEN DATEADD(dd, 2, DATEDIFF(dd, 0, @StartDate))
    WHEN DATENAME(dw, @StartDate) = 'Sunday' THEN DATEADD(dd, 1, DATEDIFF(dd, 0, @StartDate))
    ELSE @StartDate END

SET @EndDate = CASE 
    WHEN DATENAME(dw, @EndDate) = 'Saturday' THEN DATEADD(dd, 0, DATEDIFF(dd, 0, @EndDate))
    WHEN DATENAME(dw, @EndDate) = 'Sunday' THEN DATEADD(dd, -1, DATEDIFF(dd, 0, @EndDate))
    ELSE @EndDate END

SET @res =
    (DATEDIFF(hour, @StartDate, @EndDate) / 24)
  - (DATEDIFF(wk, @StartDate, @EndDate) * 2)

SET @res = CASE WHEN @res < 0 THEN 0 ELSE @res END

    RETURN @res
END

GO 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-06-21T23:13:32.813

创建函数，如：

```
CREATE FUNCTION dbo.fn_WorkDays(@StartDate DATETIME, @EndDate DATETIME= NULL )
RETURNS INT 
AS
BEGIN
       DECLARE @Days int
       SET @Days = 0

       IF @EndDate = NULL
              SET @EndDate = EOMONTH(@StartDate) --last date of the month

       WHILE DATEDIFF(dd,@StartDate,@EndDate) >= 0
       BEGIN
              IF DATENAME(dw, @StartDate) <> 'Saturday' 
                     and DATENAME(dw, @StartDate) <> 'Sunday' 
                     and Not ((Day(@StartDate) = 1 And Month(@StartDate) = 1)) --New Year's Day.
                     and Not ((Day(@StartDate) = 4 And Month(@StartDate) = 7)) --Independence Day.
              BEGIN
                     SET @Days = @Days + 1
              END

              SET @StartDate = DATEADD(dd,1,@StartDate)
       END

       RETURN  @Days
END 
```

您可以像这样调用函数：

```
select dbo.fn_WorkDays('1/1/2016', '9/25/2016') 
```

或者像：

```
select dbo.fn_WorkDays(StartDate, EndDate) 
from table1 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-11-03T15:36:06.840

```
Create Function dbo.DateDiff_WeekDays 
(
@StartDate  DateTime,
@EndDate    DateTime
)
Returns Int
As

Begin   

Declare @Result Int = 0

While   @StartDate <= @EndDate
Begin 
    If DateName(DW, @StartDate) not in ('Saturday','Sunday')
        Begin
            Set @Result = @Result +1
        End
        Set @StartDate = DateAdd(Day, +1, @StartDate)
End

Return @Result 
```

结尾

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-08-23T13:34:57.597

我发现下面的 TSQL 是一个相当优雅的解决方案（我没有运行函数的权限）。我发现了`DATEDIFF`忽略`DATEFIRST`，我希望我一周的第一天是星期一。我还希望将第一个工作日设置为零，如果星期一是周末，则设置为零。这可能会对要求略有不同的人有所帮助:)

它不处理银行假期

```
SET DATEFIRST 1
SELECT
,(DATEDIFF(DD,  [StartDate], [EndDate]))        
-(DATEDIFF(wk,  [StartDate], [EndDate]))        
-(DATEDIFF(wk, DATEADD(dd,-@@DATEFIRST,[StartDate]), DATEADD(dd,-@@DATEFIRST,[EndDate]))) AS [WorkingDays] 
FROM /*Your Table*/ 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-02-15T07:52:39.843

一种方法是结合 case 表达式从头到尾“遍历日期”，该表达式检查当天是不是星期六或星期日并标记它（1 表示工作日，0 表示周末）。最后，只需对标志求和（它将等于 1 标志的计数，因为另一个标志为 0）为您提供工作日数。

您可以使用 GetNums(startNumber,endNumber) 类型的实用程序函数，它会生成一系列数字，用于从开始日期到结束日期“循环”。有关实现，请参阅[http://tsql.solidq.com/SourceCodes/GetNums.txt](http://tsql.solidq.com/SourceCodes/GetNums.txt)。逻辑也可以扩展以迎合假期（例如，如果您有假期表）

```
declare @date1 as datetime = '19900101'
declare @date2 as datetime = '19900120'

select  sum(case when DATENAME(DW,currentDate) not in ('Saturday', 'Sunday') then 1 else 0 end) as noOfWorkDays
from dbo.GetNums(0,DATEDIFF(day,@date1, @date2)-1) as Num
cross apply (select DATEADD(day,n,@date1)) as Dates(currentDate) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-07-08T20:56:46.730

我从其他人那里借鉴了一些想法来创建我的解决方案。我使用内联代码来忽略周末和美国联邦假期。在我的环境中，EndDate 可能为空，但它永远不会在 StartDate 之前。

```
CREATE FUNCTION dbo.ufn_CalculateBusinessDays(
@StartDate DATE,
@EndDate DATE = NULL)

RETURNS INT
AS

BEGIN
DECLARE @TotalBusinessDays INT = 0;
DECLARE @TestDate DATE = @StartDate;

IF @EndDate IS NULL
    RETURN NULL;

WHILE @TestDate < @EndDate
BEGIN
    DECLARE @Month INT = DATEPART(MM, @TestDate);
    DECLARE @Day INT = DATEPART(DD, @TestDate);
    DECLARE @DayOfWeek INT = DATEPART(WEEKDAY, @TestDate) - 1; --Monday = 1, Tuesday = 2, etc.
    DECLARE @DayOccurrence INT = (@Day - 1) / 7 + 1; --Nth day of month (3rd Monday, for example)

    --Increment business day counter if not a weekend or holiday
    SELECT @TotalBusinessDays += (
        SELECT CASE
            --Saturday OR Sunday
            WHEN @DayOfWeek IN (6,7) THEN 0
            --New Year's Day
            WHEN @Month = 1 AND @Day = 1 THEN 0
            --MLK Jr. Day
            WHEN @Month = 1 AND @DayOfWeek = 1 AND @DayOccurrence = 3 THEN 0
            --G. Washington's Birthday
            WHEN @Month = 2 AND @DayOfWeek = 1 AND @DayOccurrence = 3 THEN 0
            --Memorial Day
            WHEN @Month = 5 AND @DayOfWeek = 1 AND @Day BETWEEN 25 AND 31 THEN 0
            --Independence Day
            WHEN @Month = 7 AND @Day = 4 THEN 0
            --Labor Day
            WHEN @Month = 9 AND @DayOfWeek = 1 AND @DayOccurrence = 1 THEN 0
            --Columbus Day
            WHEN @Month = 10 AND @DayOfWeek = 1 AND @DayOccurrence = 2 THEN 0
            --Veterans Day
            WHEN @Month = 11 AND @Day = 11 THEN 0
            --Thanksgiving
            WHEN @Month = 11 AND @DayOfWeek = 4 AND @DayOccurrence = 4 THEN 0
            --Christmas
            WHEN @Month = 12 AND @Day = 25 THEN 0
            ELSE 1
            END AS Result);

    SET @TestDate = DATEADD(dd, 1, @TestDate);
END

RETURN @TotalBusinessDays;
END 
```

# python - 为什么 Django 1.0 管理应用程序不能工作？

> ID：252531
> 
> 赞同：5
> 
> 时间：2008-10-31T03:35:19.623
> 
> 标签：python, django, admin

我刚刚开始使用 Django，并根据我自己的一组基本要求松散地遵循本教程。到目前为止，我绘制的模型比教程更全面，但它们编译得很好。否则，一切都应该是一样的。

我的问题是管理应用程序。我可以登录并查看可编辑的模型，但是当我单击模型或任何更改/添加按钮时，我会得到 404。

这是我得到的确切错误：

```
Page not found (404)
Request Method:     GET
Request URL:    http://localhost:8000/admin/auth/user/add/

App u'', model u'auth', not found. 
```

这些是相关文件以及其中的内容：

网址.py

```
from django.conf.urls.defaults import *

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
# Example:
# (r'^daso/', include('daso.foo.urls')),

# Uncomment the admin/doc line below and add 'django.contrib.admindocs' 
# to INSTALLED_APPS to enable admin documentation:
#(r'^admin/doc/', include('django.contrib.admindocs.urls')),

# Uncomment the next line to enable the admin:
    (r'^admin(.*)', admin.site.root)
) 
```

管理员.py

```
from daso.clients.models import Person, Client, Contact
from django.contrib import admin

admin.site.register(Person)
admin.site.register(Client)
admin.site.register(Contact) 
```

models.py - 我只展示一个模型

```
class Client(Person):
relationships = models.ManyToManyField("Contact", through="Relationship", null=True)
disabilities = models.ManyToManyField("Disability", related_name="disability", null=True)
medical_issues = models.ManyToManyField("MedicalIssue", related_name="medical_issue", null=True)
medicare_num = models.CharField(max_length=15, blank=True)
insurance = models.OneToOneField("Insurance", null=True, blank=True)
medications = models.ManyToManyField("Medication", through="Medication_Details", null=True)

def __unicode__(self):
    client = u"[Client[id: ", self.id, " name: ", self.first_name, " ", self.last_name, "]"
    return client 
```

设置.py

```
INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.admin',
    'daso.clients',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
) 
```

这些应该是相关的文件/文件部分。如果有人知道为什么我会得到 404，请赐教？

请注意，在此处粘贴时，已安装的应用程序的最后 2 个应用程序带有选项卡，而不是间隔 *4，并且在重新加载管理页面时它工作了半秒，然后再次出现 404。奇怪的。想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T04:50:27.770

这是因为你遗漏了一个`/`in `urls.py`。将管理行更改为以下内容：

```
(r'^admin/(.*)', admin.site.root), 
```

我在我的服务器上检查了这个，你的线路从`urls.py`.

# wcf - WCF REST 入门工具包无法安装

> ID：252535
> 
> 赞同：1
> 
> 时间：2008-10-31T03:36:40.527
> 
> 标签：wcf, rest

我只是非常焦急地下载了 spankin 新的 WCF REST 入门工具包。安装失败。还有其他人有这个问题吗？

[http://msdn.microsoft.com/en-us/netframework/cc950529.aspx](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)

编辑：模板安装期间安装失败。VS JIT 调试器窗口弹出。没有其他东西在运行 PC，我在 XP Pro 上以管理员身份运行，错误来自 EXE 或 MSI。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T04:23:30.493

是的，它对我来说也失败了。在模板安装期间收到有关替换现有文件的警告，然后在我告诉它继续后发生严重崩溃。

编辑：刚刚再试一次 - 它奏效了。做了3件事不同：

*   关闭所有正在运行的 VS2008 SP1 实例
*   仔细阅读安装指南并选择运行 setup.exe 而不是 msi，并执行“以管理员身份运行”
*   在延迟的模板安装程序完成之前没有关闭 MSI 安装程序。

这是安装指南：

* * *

系统要求：

1.  Windows Vista 或 Windows Server 2008 或 Windows Server 2003
2.  视觉工作室 2008 SP1

* * *

安装和使用步骤：

1.  在安装之前，请记住卸载您在机器上安装的任何版本（有关卸载步骤，请参阅下面的卸载部分）。

2.  以管理员模式运行 setup.exe（右键单击 setup.exe 并选择“以管理员身份运行”）

3.  安装过程将启动 Visual Studio 安装程序。请记住单击 Visual Studio 安装程序以安装模板。注意：您可能会错过启动的 vsi，因此请务必完成 vsi 和 setup.exe 安装，以确保整个安装过程完成。
4.  运行 vsi 时，您将收到一个提示，您可以放心地接受该提示以继续。
5.  安装后，构建安装在您机器上的 Microsoft.ServiceModel.web 项目。
6.  您需要从模板生成的项目以及示例中引用 Microsoft.ServiceModel.Web.dll 程序集。请记住在使用您的模板和项目时验证这一点。请注意，您也可以改用项目引用。
7.  有一个解决方案包括“WCF REST Starter Kit\Samples\WCF REST Starter Kit Samples”位置中提供的所有示例。这为您提供了一种从一个地方轻松试用所有样本的方法。

# iphone - 向视图控制器默认视图添加许多子视图是否会使我的应用程序变慢？

> ID：252539
> 
> 赞同：2
> 
> 时间：2008-10-31T03:39:40.533
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个应用程序，我在其中创建了许多 uiviews 并将它们添加到 UIViewController 的 self.view 中。我的应用程序运行非常缓慢。我正在释放我的所有对象并且没有内存泄漏（我运行了性能工具）。谁能告诉我是什么让我的应用程序这么慢？（代码如下）

[编辑] 该数组有大约 30 个项目。[/完编辑]

非常感谢！

这是我的 UIViewController 的 loadView 方法的代码：

```
- (void)loadView {

    UIView *contentView = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]];
    contentView.backgroundColor = [UIColor whiteColor];
    self.view = contentView;
    [contentView release]; 

    int length = 0;
    for(NSString *item in arrayTips)
    {
        length++;
        [item release];
    }
    int index = 0;
    for(NSString *item in arrayTitles)
    {
        SingleFlipView *backView = [[SingleFlipView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]];

        backView.userInteractionEnabled = YES;
        backView.backgroundColor = [UIColor whiteColor];
        [backView setViewIndex:index];
        [backView setLastViewIndex:length];
        CGRect labelFrame = CGRectMake(10.0f, 0.0f, 300.0f, 30.0f);
        UILabel *backLabel = [[UILabel alloc] initWithFrame:labelFrame];
        backLabel.textAlignment = UITextAlignmentCenter;
        backLabel.userInteractionEnabled = YES;
        backLabel.text = item;
        backLabel.font = [UIFont fontWithName:@"Georgia" size:24.0f];
        backLabel.textColor = [UIColor blackColor];
        backLabel.backgroundColor = [UIColor whiteColor];

        CGRect textFrame = CGRectMake(10.0f, 30.0f, 300.0f, 110.0f);
        UITextView *tbxView = [[UITextView alloc] initWithFrame:textFrame];
        tbxView.textAlignment = UITextAlignmentCenter;
        tbxView.userInteractionEnabled = YES;
        tbxView.editable = FALSE;
        tbxView.text = [arrayTips objectAtIndex:index];
        tbxView.font = [UIFont fontWithName:@"Arial" size:14.0f];
        tbxView.textColor = [UIColor blackColor];
        tbxView.backgroundColor = [UIColor whiteColor];

        //CGRect labelFrame = CGRectMake(10.0f, 0.0f, 84.0f, 30.0f);
        UIImage *nextTip = [[UIImage imageNamed:@"NextTip.png"] retain];
        UIImageView *nextTipView = [ [ UIImageView alloc ] initWithImage:nextTip];
        nextTipView.frame = CGRectMake(230.0f, -10.0f, 84.0f, 30.0f);
        nextTipView.userInteractionEnabled = YES;

        UIImageView *view = [[ UIImageView alloc ] init];
        view.userInteractionEnabled = YES;
        if(self.sexString == @"Men")
        {
            UIImage *imgTip = [[UIImage imageNamed:@"feet_small.jpg"] retain];
            view.image = imgTip;
            view.frame = CGRectMake(0.0f, 110.0f, 416.0f, 228.0f); //59*161
            [imgTip release];
        }

        [backView addSubview:view];
        [backView addSubview:tbxView];
        [backView addSubview:backLabel];
        //[backView addSubview:nextTipView];

        [self.view addSubview:backView];
        [backView release];
        [backLabel release];
        [nextTip release];
        [nextTipView release];
        [tbxView release];
        [view release];

        index++;

        [item release];
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T04:01:04.907

这将取决于 arrayTitles 中有多少项目。如果你只是添加其中的一两个，你不应该看到一个巨大的减速；更多，你会的。您可能应该看看 UITableView 处理其单元格的方式；仅在实际需要/使用时创建它们，或者更好的是，仅创建其中一个，并即时设置其内容。

其他一些注意事项：

*   == 在 Objective-C 中不是一个有效的字符串比较运算符；使用 [string1 isEqualTo: string2]
*   看来您正试图同时在屏幕上放置很多这些，这似乎没有多大意义。
*   看起来你`[item release]`最后有一个虚假（你永远不会保留`item`，所以没有必要释放它。
*   整个第一个循环（ `for(NSString *item in arrayTips)...`让我感到害怕和困惑；NSArrays 中的项目已经被数组保留。您不必以这种方式显式保留/释放它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T04:02:13.080

拥有深层视图层次结构可能会导致速度变慢，您通常可以通过使用自定义视图将它们展平来解决这些问题，但如果您使用简单的视图，您可以在屏幕上显示数十个视图，而不会产生明显的性能影响，所以一般来说，我建议忽略多少个您在开发时拥有的视图，然后在证明是性能问题时减少视图计数。

话虽如此，您似乎正在设置具有无限大量视图的东西，这并不好。在不知道数组标题中有多少条目的情况下，我无法告诉您到底发生了什么，但我怀疑虽然您创建的每个 backView 的实际视觉层次都很好，但为数组中的每个项目创建一个 backView 和使用索引让最前面的索引隐藏在它后面的所有其他索引会导致您拥有太多视图。

那么，如何测试它：

在 for 循环的底部添加一个中断。使循环在单次迭代后退出，看看性能是否有所提高。如果是这样，那么巨大的视图层次结构就是你的问题。您可能不得不修改更改索引的例程，以确保它永远不会切换到无效索引进行测试。

如果是这种情况，您有几个选择。您可以实现自定义视图并将每个后视图展平为单个视图，但取决于您有多少垫子是不够的，而且它比简单地以您当前的方式构建后视图更多工作，而是按需而不是在加载时：

1) 将 for 循环中的代码重构为一个单独的方法，该方法为特定标题创建一个 backView 并将其附加到当时的视图。2）您当前在哪里更改索引以使后视图可见，而不是调用新方法来实际构建并附加当时的后视图

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-17T07:10:43.460

不要忘记尽可能多地使您的视图不透明。透明视图是性能问题的主要来源。

# .net - SqlConnection.RetrieveStatistics() 什么时候有用？

> ID：252540
> 
> 赞同：2
> 
> 时间：2008-10-31T03:40:16.273
> 
> 标签：.net, sql, sql-server

调用此方法可以解决哪些问题？
你曾经用它来调试你的数据访问吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-31T05:55:23.677

[这个来自 MSDN 的页面有更多信息](http://msdn.microsoft.com/en-us/library/7h2ahss8(VS.80).aspx)。似乎它包含有用的调试信息，但我必须承认我从未使用过它。

# mysql - 如何升级mysql？

> ID：252548
> 
> 赞同：1
> 
> 时间：2008-10-31T03:47:52.093
> 
> 标签：mysql, upgrade

在升级 MySQL 时，我首先创建了数据库的备份。然后我将卸载当前安装的版本，并删除安装程序留下的所有文件。然后我安装最新的 GA 版本，并使用 MySQL 管理员恢复创建的备份。

有没有更好的方法来升级 MySQL。因为我必须再次创建所有允许连接到数据库的用户。

MySQL的安装是在一个大学招生系统中使用的，一个我用VB.Net和MySQL开发的客户端服务器系统。我只能在晚上进行更新，因为我知道没有人连接到数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T04:20:12.217

您可以转储`mysql.user`和`mysql.db`表，其中包含所有用户信息，并重新导入，以避免重新创建所有这些。我还建议您重新导入后在桌子上进行维修。

或者，您可以创建一个赠款列表：

```
select concat('show grants for ',quote(user),'@',quote(host),';') from mysql.user 
```

这将输出一个 sql 语句列表，然后您可以运行这些语句来获取特定的授权语句。

但最终，您需要查看有关升级的特定版本信息，以确保您考虑了任何特定于版本的兼容性问题。

[例如，这里](http://dev.mysql.com/doc/refman/5.0/en/upgrading-from-4-1.html)是 4.1 - 5.x 升级的一些信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T02:35:34.790

为什么mysql升级这么脑残？您需要备份所有数据、将 MySQL 安装到不同的目录、重新导入数据——只是为了升级，这一事实是荒谬的。必须有一个更简单的方法。

# filesystems - 在操作系统看来，文件和记录有什么区别？

> ID：252550
> 
> 赞同：0
> 
> 时间：2008-10-31T03:50:51.417
> 
> 标签：filesystems, records

就一般操作系统概念而言，文件和记录有什么区别？

操作系统将如何管理它们？我知道什么是文件，什么是记录，但它在操作系统中是如何区分的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T04:04:48.440

是的

我得到了答案

文件是记录的集合或集合。

通常，在数据库意义上，一组记录构成一个文件。

一组属性形成一条记录

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T04:06:16.580

这些天来，至少在 Win32 和 *nix 上没有区别。对于操作系统来说，文件只是一袋字节，它由应用程序来管理和处理这些字节，或者一次全部处理，或者一次处理一条记录。

在 JCL 中定义记录格式和 i/o 源的日子已经一去不复返了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-19T15:16:54.850

许多操作系统将文件视为一系列不可区分的符号。没有记录的概念。其他人，主要是那些拥有大型机遗产的人，认为文件具有固定的记录长度并在记录边界上阻止 I/O。

最初，层次结构源于磁带驱动器，其中物理记录中断放置在磁带上的块和磁盘上的扇区之间，用于对柱面进行分区。

今天的应用程序将记录结构强加在文件上并像有边界一样访问它们，并且不会进行部分访问。这尤其适用于 DBMS（正如[Manoj](https://stackoverflow.com/users/31116/manoj-doubts)指出的那样）。

记录长度不必是一个常数值，但可以在单个文件中改变。它们可以在包含多种记录类型的文件中使用显式或隐式记录长度来实现（[.PNG](https://www.rfc-editor.org/rfc/rfc2083)就是一个很好的例子）。

从某种意义上说，即使是现代操作系统也有以页面形式存在的首选记录大小。这些是低级组件从媒体读取和写入的本机块。可能需要考虑这种结构以提高边际性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T06:59:40.377

好的答案是 1 ""被视为单个单元的相关字段的集合称为记录。被视为单个单元的相关记录的集合称为文件或数据集""

# c - 为什么我们需要 C 联合？

> ID：252552
> 
> 赞同：276
> 
> 时间：2008-10-31T03:51:40.777
> 
> 标签：c, unions

什么时候应该使用工会？为什么我们需要它们？

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2008-10-31T04:02:10.270

联合通常用于在整数和浮点数的二进制表示之间进行转换：

```
union
{
  int i;
  float f;
} u;

// Convert floating-point bits to integer:
u.f = 3.14159f;
printf("As integer: %08x\n", u.i); 
```

尽管根据 C 标准，这在技术上是未定义的行为（您应该只阅读最近编写的字段），但它几乎可以在任何编译器中以明确定义的方式运行。

联合有时也用于在 C 中实现伪多态性，通过给结构一些标签来指示它包含什么类型的对象，然后将可能的类型联合在一起：

```
enum Type { INTS, FLOATS, DOUBLE };
struct S
{
  Type s_type;
  union
  {
    int s_ints[2];
    float s_floats[2];
    double s_double;
  };
};

void do_something(struct S *s)
{
  switch(s->s_type)
  {
    case INTS:  // do something with s->s_ints
      break;

    case FLOATS:  // do something with s->s_floats
      break;

    case DOUBLE:  // do something with s->s_double
      break;
  }
} 
```

这允许大小`struct S`仅为 12 个字节，而不是 28 个字节。

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2008-10-31T07:13:32.803

联合在嵌入式编程或需要直接访问硬件/内存的情况下特别有用。这是一个简单的例子：

```
typedef union
{
    struct {
        unsigned char byte1;
        unsigned char byte2;
        unsigned char byte3;
        unsigned char byte4;
    } bytes;
    unsigned int dword;
} HW_Register;
HW_Register reg; 
```

然后，您可以按如下方式访问 reg：

```
reg.dword = 0x12345678;
reg.bytes.byte3 = 4; 
```

字节序（字节顺序）和处理器架构当然很重要。

另一个有用的特性是位修饰符：

```
typedef union
{
    struct {
        unsigned char b1:1;
        unsigned char b2:1;
        unsigned char b3:1;
        unsigned char b4:1;
        unsigned char reserved:4;
    } bits;
    unsigned char byte;
} HW_RegisterB;
HW_RegisterB reg; 
```

使用此代码，您可以直接访问寄存器/内存地址中的单个位：

```
x = reg.bits.b2; 
```

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2011-08-29T09:29:28.670

低级系统编程就是一个合理的例子。

IIRC，我使用联合将硬件寄存器分解为组件位。因此，您可以访问组件位中的 8 位寄存器（因为它是，在我这样做的那天；-）。

（我忘记了确切的语法，但是......）这种结构将允许控制寄存器作为 control_byte 或通过各个位进行访问。对于给定的字节序，确保位映射到正确的寄存器位非常重要。

```
typedef union {
    unsigned char control_byte;
    struct {
        unsigned int nibble  : 4;
        unsigned int nmi     : 1;
        unsigned int enabled : 1;
        unsigned int fired   : 1;
        unsigned int control : 1;
    };
} ControlRegister; 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2011-08-29T09:24:45.003

我已经在几个库中看到它作为面向对象继承的替代品。

例如

```
 Connection
     /       |       \
  Network   USB     VirtualConnection 
```

如果您希望连接“类”是上述任何一种，您可以编写如下内容：

```
struct Connection
{
    int type;
    union
    {
        struct Network network;
        struct USB usb;
        struct Virtual virtual;
    }
}; 
```

在 libinfinity 中的使用示例：[http ://git.0x539.de/?p=infinote.git;a=blob;f=libinfinity/common/inf-session.c;h=3e887f0d63bd754c6b5ec232948027cbbf4d61fc;hb=HEAD#l74](http://git.0x539.de/?p=infinote.git;a=blob;f=libinfinity/common/inf-session.c;h=3e887f0d63bd754c6b5ec232948027cbbf4d61fc;hb=HEAD#l74)

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2008-10-31T03:59:01.603

联合允许互斥的数据成员共享相同的内存。当内存更加稀缺时，这非常重要，例如在嵌入式系统中。

在以下示例中：

```
union {
   int a;
   int b;
   int c;
} myUnion; 
```

这个联合将占用单个 int 的空间，而不是 3 个单独的 int 值。如果用户设置**a**的值，然后设置**b**的值，它将覆盖 a 的值，**因为**它们都共享相同的内存位置。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2011-08-29T09:21:28.457

很多用法。只需执行`grep union /usr/include/*`或在类似目录中。大多数情况下，它`union`被包裹在 a`struct`中，并且结构的一个成员告诉联合中的哪个元素要访问。例如签`man elf`出现实生活中的实现。

这是基本原则：

```
struct _mydata {
    int which_one;
    union _data {
            int a;
            float b;
            char c;
    } foo;
} bar;

switch (bar.which_one)
{
   case INTEGER  :  /* access bar.foo.a;*/ break;
   case FLOATING :  /* access bar.foo.b;*/ break;
   case CHARACTER:  /* access bar.foo.c;*/ break;
} 
```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2008-10-31T06:09:46.817

这是我自己的代码库中的联合示例（来自记忆和释义，因此可能不准确）。它用于在我构建的解释器中存储语言元素。例如，下面的代码：

```
set a to b times 7. 
```

由以下语言元素组成：

*   符号[集]
*   变量[a]
*   符号[到]
*   变量[b]
*   符号[次]
*   常数[7]
*   象征[。]

语言元素被定义为 ' `#define`' 值，因此：

```
#define ELEM_SYM_SET        0
#define ELEM_SYM_TO         1
#define ELEM_SYM_TIMES      2
#define ELEM_SYM_FULLSTOP   3
#define ELEM_VARIABLE     100
#define ELEM_CONSTANT     101 
```

并且使用以下结构来存储每个元素：

```
typedef struct {
    int typ;
    union {
        char *str;
        int   val;
    }
} tElem; 
```

那么每个元素的大小就是最大联合的大小（典型值为 4 字节，联合为 4 字节，虽然这些是典型值，但*实际*大小取决于实现）。

为了创建一个“set”元素，你可以使用：

```
tElem e;
e.typ = ELEM_SYM_SET; 
```

为了创建一个“variable[b]”元素，你可以使用：

```
tElem e;
e.typ = ELEM_VARIABLE;
e.str = strdup ("b");   // make sure you free this later 
```

为了创建一个“constant[7]”元素，你可以使用：

```
tElem e;
e.typ = ELEM_CONSTANT;
e.val = 7; 
```

您可以轻松地将其扩展为包括浮点数 ( `float flt`) 或有理数 ( `struct ratnl {int num; int denom;}`) 和其他类型。

基本前提是`str`和`val`在内存中不连续，它们实际上是重叠的，因此这是一种在同一块内存上获得不同视图的方法，如图所示，其中结构基于内存位置`0x1010`，整数和指针都是4字节：

```
 +-----------+
0x1010 |           |
0x1011 |    typ    |
0x1012 |           |
0x1013 |           |
       +-----+-----+
0x1014 |     |     |
0x1015 | str | val |
0x1016 |     |     |
0x1017 |     |     |
       +-----+-----+ 
```

如果它只是在一个结构中，它看起来像这样：

```
 +-------+
0x1010 |       |
0x1011 |  typ  |
0x1012 |       |
0x1013 |       |
       +-------+
0x1014 |       |
0x1015 |  str  |
0x1016 |       |
0x1017 |       |
       +-------+
0x1018 |       |
0x1019 |  val  |
0x101A |       |
0x101B |       |
       +-------+ 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-08-29T09:21:07.503

我想说它可以更容易地重用可能以不同方式使用的内存，即节省内存。例如，您想做一些能够保存短字符串和数字的“变体”结构：

```
struct variant {
    int type;
    double number;
    char *string;
}; 
```

在 32 位系统中，这将导致至少 96 位或 12 个字节用于`variant`.

使用联合，您可以将大小减小到 64 位或 8 字节：

```
struct variant {
    int type;
    union {
        double number;
        char *string;
    } value;
}; 
```

如果您想添加更多不同的变量类型等，您可以节省更多。这可能是真的，您可以做类似的事情来转换一个 void 指针 - 但联合使它更容易访问以及类型安全的。这样的节省听起来并不大，但是您节省了用于该结构的所有实例的内存的三分之一。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-31T04:16:36.933

很难想到需要这种灵活结构的特定场合，也许是在一个消息协议中，您将发送不同大小的消息，但即便如此，也可能有更好、对程序员更友好的替代方案。

联合有点像其他语言中的变体类型——它们一次只能容纳一个东西，但那个东西可能是 int、float 等，这取决于你如何声明它。

例如：

```
typedef union MyUnion MYUNION;
union MyUnion
{
   int MyInt;
   float MyFloat;
}; 
```

MyUnion 将仅包含一个 int 或一个 float，*具体取决于您最近设置*的 . 所以这样做：

```
MYUNION u;
u.MyInt = 10; 
```

u 现在拥有一个等于 10 的 int；

```
u.MyFloat = 1.0; 
```

u 现在持有一个等于 1.0 的浮点数。它不再拥有一个 int。显然，现在如果您尝试执行 printf("MyInt=%d", u.MyInt); 那么你可能会得到一个错误，虽然我不确定具体的行为。

联合的大小由其最大字段的大小决定，在本例中为浮点数。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-09-27T16:34:08.490

其中许多答案涉及从一种类型转换为另一种类型。我从具有相同类型的联合中获得最多的使用（即在解析串行数据流时）。它们使*框架*数据包的解析/构造变得微不足道。

```
typedef union
{
    UINT8 buffer[PACKET_SIZE]; // Where the packet size is large enough for
                               // the entire set of fields (including the payload)

    struct
    {
        UINT8 size;
        UINT8 cmd;
        UINT8 payload[PAYLOAD_SIZE];
        UINT8 crc;
    } fields;

}PACKET_T;

// This should be called every time a new byte of data is ready 
// and point to the packet's buffer:
// packet_builder(packet.buffer, new_data);

void packet_builder(UINT8* buffer, UINT8 data)
{
    static UINT8 received_bytes = 0;

    // All range checking etc removed for brevity

    buffer[received_bytes] = data;
    received_bytes++;

    // Using the struc only way adds lots of logic that relates "byte 0" to size
    // "byte 1" to cmd, etc...
}

void packet_handler(PACKET_T* packet)
{
    // Process the fields in a readable manner
    if(packet->fields.size > TOO_BIG)
    {
        // handle error...
    }

    if(packet->fields.cmd == CMD_X)
    {
        // do stuff..
    }
} 
```

***编辑*** 关于字节序和结构填充的评论是有效的，而且非常关注。我几乎完全在嵌入式软件中使用了这段代码，其中大部分我都控制了管道的两端。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-31T03:59:46.000

当您想要对由硬件、设备或网络协议定义的结构进行建模时，或者当您创建大量对象并想要节省空间时，可以使用联合。不过，你真的 95% 的时间都不需要它们，坚持使用易于调试的代码。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-08-29T09:23:08.107

在学校，我使用这样的工会：

```
typedef union
{
  unsigned char color[4];
  int       new_color;
}       u_color; 
```

我用它来更轻松地处理颜色，而不是使用 >> 和 << 运算符，我只需要遍历我的 char 数组的不同索引。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-04-20T18:21:14.300

在 C 的早期版本中，所有结构声明都将共享一组公共字段。鉴于：

```
struct x {int x_mode; int q; float x_f};
struct y {int y_mode; int q; int y_l};
struct z {int z_mode; char name[20];}; 
```

编译器基本上会生成一个结构大小（可能还有对齐）表，以及一个单独的结构成员名称、类型和偏移量表。编译器不跟踪哪些成员属于哪些结构，并且仅当类型和偏移匹配时才允许两个结构具有同名的成员（如and的`q`成员）。如果 p 是指向任何结构类型的指针，则 p->q 会将“q”的偏移量添加到指针 p 并从结果地址中获取“int”。`struct x``struct y`

鉴于上述语义，可以编写一个函数，该函数可以互换地对多种结构执行一些有用的操作，前提是该函数使用的所有字段都与相关结构中的有用字段对齐。这是一个有用的特性，并且更改 C 以验证用于针对所讨论的结构类型访问结构的成员将意味着在没有一种方法可以在同一地址包含多个命名字段的结构的情况下丢失它。向 C 添加“联合”类型有助于在一定程度上填补这一空白（尽管不是，恕我直言，它应该是）。

联合体填补这一空白的一个重要部分是指向联合体成员的指针可以转换为指向包含该成员的任何联合体的指针，并且指向任何联合体的指针可以转换为指向任何成员的指针。虽然 C89 标准没有明确说明将 a`T*`直接转换为 a`U*`等同于将其转换为指向任何同时包含`T`and的联合类型的指针`U`，然后将其转换为`U*`，但后一个转换序列的已定义行为不会受到使用了联合类型，并且标准没有为从`T`to的直接转换指定任何相反的语义`U`。此外，在函数接收到未知来源的指针的情况下，通过 写入对象的行为`T*`，转换`T*`到 a `U*`，然后通过读取对象`U*`相当于通过 type 的成员写入联合`T`并读取为 type `U`，这在少数情况下是标准定义的（例如，当访问公共初始序列成员时）和实现定义的（而不是其余部分比未定义）。虽然很少有程序利用联合类型的实际对象利用 CIS 保证，但利用指向未知来源对象的指针必须表现得像指向联合成员的指针并具有与之相关联的行为保证这一事实要普遍得多。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-31T04:36:44.273

工会很棒。我见过的一种巧妙的联合使用方法是在定义事件时使用它们。例如，您可能决定一个事件是 32 位的。

现在，在这 32 位中，您可能希望将前 8 位指定为事件发送者的标识符……有时您将事件作为一个整体来处理，有时您将其分解并比较它的组成部分。工会让你可以灵活地做这两件事。

```
工会活动
{
  无符号长事件代码；
  无符号字符事件部分[4]；
};

```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-08-29T09:20:39.467

我在为嵌入式设备编码时使用了 union。我有 16 位长的 C int 。当我需要读取/存储到 EEPROM 时，我需要检索高 8 位和低 8 位。所以我用了这种方式：

```
union data {
    int data;
    struct {
        unsigned char higher;
        unsigned char lower;
    } parts;
}; 
```

它不需要移位，因此代码更易于阅读。

另一方面，我看到一些旧的 C++ stl 代码将联合用于 stl 分配器。有兴趣的可以阅读[sgi stl](http://www.sgi.com/tech/stl/stl_alloc.h)源码。这是其中的一部分：

```
union _Obj {
    union _Obj* _M_free_list_link;
    char _M_client_data[1];    /* The client sees this.        */
}; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-08-29T09:20:56.780

*   包含不同记录类型的文件。
*   包含不同请求类型的网络接口。

看看这个：[X.25 缓冲区命令处理](http://download.oracle.com/docs/cd/E19069-01/sol.x25.92/806-1235/6jahlacnk/index.html)

许多可能的 X.25 命令之一被接收到缓冲区并通过使用所有可能结构的 UNION 就地处理。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-08-29T09:16:05.760

[`VARIANT`](http://msdn.microsoft.com/en-us/library/e305240e-9e11-4006-98cc-26f4932d2118%28VS.85%29)那在 COM 接口中使用呢？它有两个字段 - “type”和一个持有实际值的联合，该值根据“type”字段进行处理。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-11-13T15:39:36.320

union 用于节省内存，特别是在内存很重要的内存有限的设备上使用。经验：

```
union _Union{
  int a;
  double b;
  char c;
}; 
```

例如，假设我们在内存有限的系统中需要上述3种数据类型（int，double，char）。如果我们不使用“union”，我们需要定义这3种数据类型。在这种情况下会分配sizeof(a) + sizeof(b) + sizeof(c) 内存空间。但是如果我们使用onion，则只会根据这3种数据类型中最大的数据类型分配一个内存空间。因为联合结构中的所有变量都将使用相同的内存空间。因此，根据最大数据类型分配的内存空间将是所有变量的公共空间。例如：

```
union _Union{
int a;
double b;
char c;
};

int main() {
 union _Union uni;
 uni.a = 44;
 uni.b = 144.5;
 printf("a:%d\n",uni.a);
 printf("b:%lf\n",uni.b);
 return 0;
 } 
```

输出为：a：0 和 b：144.500000

为什么 a 为零？因为联合结构只有一个内存区域，所有数据结构都使用它。所以最后一个赋值会覆盖旧的。再举一个例子：

```
 union _Union{
    char name[15];
    int id;
};

int main(){
   union _Union uni;
   char choice;
   printf("YOu can enter name or id value.");
   printf("Do you want to enter the name(y or n):");
   scanf("%c",&choice);
   if(choice == 'Y' || choice == 'y'){
     printf("Enter name:");
     scanf("%s",uni.name);
     printf("\nName:%s",uni.name);
   }else{
     printf("Enter Id:");
     scanf("%d",&uni.id);
     printf("\nId:%d",uni.id);
   }
return 0;
} 
```

注意：并集的大小是其最大字段的大小，因为必须保留足够数量的字节来存储较大的字段。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-09-18T15:07:56.160

一个简单且非常有用的例子是......

想象：

您有一个`uint32_t array[2]`并且想要访问字节链的第 3 和第 4 个字节。你可以做`*((uint16_t*) &array[1])`。但这可悲地违反了严格的别名规则！

但是已知的编译器允许您执行以下操作：

```
union un
{
    uint16_t array16[4];
    uint32_t array32[2];
} 
```

从技术上讲，这仍然违反了规则。但是所有已知的标准都支持这种用法。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2021-02-07T08:02:13.157

当您有一些函数返回的值可能因函数所做的不同而不同时，请使用联合。

# algorithm - Cauchy Reed-Solomon 算法如何工作？

> ID：252555
> 
> 赞同：4
> 
> 时间：2008-10-31T03:52:53.520
> 
> 标签：algorithm, reference

有人有详细说明 Cauchy-Reed 算法的参考资料吗？谷歌搜索 Cauchy-Reed Solomon 结果[cleversafe.org](http://cleversafe.org)。尽管他们有一个基于 Cauchy Reed-Solomon 代码的开源产品，但他们没有提供任何解释该算法如何工作的材料。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T04:01:44.407

UT（东部）的詹姆斯普朗克教授有一个很好的[解释](http://www.cs.utk.edu/~plank/plank/papers/CS-05-569.pdf)和有效的实施。

# function - 冗余和内联函数

> ID：252559
> 
> 赞同：0
> 
> 时间：2008-10-31T03:55:13.297
> 
> 标签：function

冗余功能是什么意思？冗余函数和内联函数有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T04:38:21.290

**冗余**功能是可能被另一个功能取代的功能，不应再使用。我想它可以被认为与弃用的函数相同。

在 C 和 C++ 中，内**联**函数是在头文件而不是 .c 或 .cpp 文件中实现的函数。编译器会将对该函数的所有调用替换为函数体本身，而不是通过符号表链接到它。这将使编译的二进制文件更大，但它的优点是函数运行得更快一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T06:24:44.913

*冗余函数*的另一个含义是让两个函数做基本相同的事情：

```
function Foo(x) { return x * x / 2; }
function Bar(x) { return Math.sqr(x) * 0.5; } 
```

或不同包中的相同内容等。
如图所示，它们的行为可能略有不同（浮点数与整数等），因此在修剪它们时必须小心......

# asp.net - ASP.NET Formview 项插入事件

> ID：252574
> 
> 赞同：1
> 
> 时间：2008-10-31T04:07:24.160
> 
> 标签：asp.net, sql, formview

我将 ASP.NET 中的 FormView 控件用于插入 MS SQL DB 的简单表单。我有一个 onItemInserting 事件来设置一些值（例如时间戳等），并且很好奇如何检查一些用户在 onItemInserting 事件中输入的值并**取消**插入项目。我想在后面的代码中这样做的原因是查询数据库并使用这些值来验证用户输入的数据。

伪代码如下：

```
protected void Form_addRoom_ItemInserting(object sender, FormViewInsertEventArgs e)
{
  ... Query DB for some values ...
  if(enteredMaxPeople > queryMaxPeople)
  {
    **Cancel** DB Insert
    statusLabel.text = "Value entered not valid";
  }
} 
```

最后问题归结为如何取消 FormView 插入后面的代码？

谢谢！肖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T04:18:44.653

```
e.Cancel = true; 
```

# c - 我们可以在 C 中使用函数指针调用函数吗？

> ID：252575
> 
> 赞同：2
> 
> 时间：2008-10-31T04:11:10.317
> 
> 标签：c, pointers, function-pointers

我们可以使用函数指针调用函数吗？如果是的话怎么办？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-31T04:16:48.620

是的。简单的例子：

```
 // Functions that will be executed via pointer.
int add(int i, int j) { return i+j; }
int subtract(int i, int j) {return i-j; }

// Enum selects one of the functions
typedef enum {
  ADD,
  SUBTRACT
} OP;

// Calculate the sum or difference of two ints.
int math(int i, int j, OP op)
{
   int (*func)(int i, int j);    // Function pointer.

   // Set the function pointer based on the specified operation.
   switch (op)
   {
   case ADD:       func = add;       break;
   case SUBTRACT:  func = subtract;  break;
   default:
        // Handle error
   }

   return (*func)(i, j);  // Call the selected function.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T04:19:30.750

是的。这是一个带有示例的[好教程。](http://www.newty.de/fpt/index.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T04:13:37.067

是的你可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T04:18:52.937

是的。一个例子：

代码前...

```
typedef int ( _stdcall *FilterTypeTranslatorType )
    (
        int TypeOfImportRecord,
        PMA 类型 *PMA
    );

FilterTypeTranslatorType FilterTypeTranslator = {NULL};

```

现在在代码中...

```
PMA类型 *PMA;
处理 hFilterDll;

// 假设 DLL 已加载
// 现在找到地址...
...
        FilterTypeTranslator[TheGroup] =
            ( FilterTypeTranslatorType ) GetProcAddress( hFilterDll,
                                                         "FilterTypeTranslator" );
...
// 现在调用它

FilterTypeTranslator(1,PMA);
...  

```

# c# - .Net：FtpWebRequest“（503）错误的命令序列”错误

> ID：252588
> 
> 赞同：5
> 
> 时间：2008-10-31T04:22:47.500
> 
> 标签：c#, .net, ftp

在大文件（~200+ MB）上，我在读取流时收到 503 错误。

```
ftp = (FtpWebRequest)WebRequest.Create(new Uri(address.AbsoluteUri + @"/" + file.Name));
ftp.Credentials = new NetworkCredential(username, password);
ftp.Method = WebRequestMethods.Ftp.DownloadFile;

response = (FtpWebResponse)ftp.GetResponse(); 
```

关于我做错了什么或更大文件的更好做法的任何线索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T01:27:58.890

您是在每次尝试后收到 503 还是仅在后续尝试后收到？

您是否尝试过设置禁用 KeepAlive？

```
ftp.KeepAlive = false; 
```

我会尝试一个更强大的 ftp 客户端库，一个基本的免费客户端库可以在[sourceforge](http://sourceforge.net/projects/dotnetftpclient/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-05T15:11:46.437

我同意最小化 NetworkCredential 对象的数量可以解决问题。我遇到了这个问题并创建了一个 CredentialCache 并添加了每个凭据一次。没有更多的 ftp 错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-09T15:07:18.760

出于某种原因，一些人似乎注意到只使用一个 NetworkCredential 对象的实例而不是为每个 FtpWebRequest 使用一个新实例取得了一些成功。这至少对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T17:45:25.680

该错误是由于没有时间让服务器注销。使用 try 语句，当发生此错误时，创建一个短时间延迟并让它重新开始。这将允许服务器从最后一个 rrequest 中注销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-07T11:08:48.387

就我而言，服务器（属于客户端）已更改为仅接受 TLS (SSL) 请求。他们当然没有告诉我们这一点，而且 503 错误消息也没有帮助！

所以我们需要这样使用`.EnableSsl`：

```
 var ftp = WebRequest.Create(uri) as FtpWebRequest;
        if (ftp != null) {
            ftp.EnableSsl = true; // <- the new bit
            ftp.Credentials = myCredentials;
            ftp.KeepAlive = false; // <- you may or may not want this
        }
        return ftp; 
```

为了忽略证书错误，我还需要添加：

```
System.Net.ServicePointManager.ServerCertificateValidationCallback +=
                (sender, certificate, chain, sslPolicyErrors) => true; 
```

据我了解，这条线具有全局影响，因此只需要在您的应用程序启动时调用它即可。

:o)

# c# - 如何创建不在 IIS 中托管的 ASP.NET Web 服务？

> ID：252593
> 
> 赞同：4
> 
> 时间：2008-10-31T04:26:17.290
> 
> 标签：c#, .net, web-services

我想在 ASP.NET 中创建一个独立的（即不在 IIS 中托管）Web 服务。这可能吗，如果可以，最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T05:11:45.093

因此，您想使用 ASP.NET 生成 Web 服务，但不想使用 IIS 托管 ASP.NET。（对于那些阅读本文的人，在对心理爵士的回应的评论中，这个问题变得更加清晰）。

那么这篇文章将是一个好的开始：
[http ://aspalliance.com/articleViewer.aspx?aId=220&pId=](http://aspalliance.com/articleViewer.aspx?aId=220&pId=)

它描述了如何使用 System.Web.Hosting 命名空间从命令行处理 asp.net，并输出生成的 HTML（或在您的情况下为 XML）。

假设您希望像普通 Web 请求一样返回数据，您将设置一个套接字来侦听端口 80，解释 HTTP 请求，然后使用与本文中类似的代码将结果输出为对 Web 请求的响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T04:29:26.627

打开 Visual Studio，启动一个新项目并选择“Web 服务应用程序”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T07:03:40.140

我不知道这是否准确地回答了这个问题。如果你想创建一个 web 服务，有没有一种合理的方法不需要 IIS 但不必在套接字级别处理数据。？

# memory - WinXP 任务管理器中的“Mem Usage”高于“VM Size”

> ID：252597
> 
> 赞同：12
> 
> 时间：2008-10-31T04:31:42.350
> 
> 标签：memory, windows-xp, taskmanager

在我的 Windows XP 任务管理器中，某些进程在 Mem Usage 列中显示的值高于 VMSize。例如，我的 Firefox 实例显示内存使用量为 111544 K，VMSize 为 100576 K。

根据任务管理器的帮助文件，Mem Usage 是进程的工作集，VMSize 是虚拟地址空间中的已提交内存。

我的问题是，如果一个进程的已提交页数是 A，而同一进程的物理内存中的页数是 B，那么它不应该总是 B ≤ A 吗？每个进程的物理内存中的页面数不是已提交页面的子集吗？

或者这与进程之间的内存共享有关？请解释。（也许我对“工作集”的定义不合时宜）。

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-31T09:21:53.887

**虚拟内存**

假设您的程序（例如 Oracle）在启动时分配了 100 MB 的内存 - 尽管没有触及额外的物理/磁盘页面，但您的 VM 大小增加了 100 MB。即 VM 只不过是内存簿记。

总可用物理内存+分页文件内存是系统中所有进程可以分配的最大内存。系统这样做是为了确保在任何时候如果进程实际开始消耗它分配的所有内存，操作系统可以提供所需的实际物理页面。

**私人内存**

如果程序将 10 MB 的数据复制到这 100 MB 中，操作系统会感知到没有为与这些地址对应的进程分配任何页面，并将价值 10 MB 的物理页面分配到进程的私有内存中。（这个过程称为缺页）

**工作集**

定义：工作集是程序最近接触过的内存页的集合。

此时这 ​​10 个页面被添加到流程的工作集中。如果该进程接着将该数据复制到先前分配的另一个 10 MB 缓存中，则其他一切都保持不变，但如果那些旧页面不在工作集中，则工作集会再次增加 10 Mb。但是如果那些页面已经在工作集中，那么一切都很好，程序工作集中保持不变。

**工作集行为**

想象一下，您的进程再也不会触及前 10 个页面，在这种情况下，这些页面会从您的进程的工作集中删除，并可能发送到页面文件，以便操作系统可以引入其他更频繁使用的页面。但是，如果没有紧急的低内存需求，则无需执行此分页操作，操作系统可以像其丰富的内存一样行事。在这种情况下，工作集只是让这些页面保留下来。

**什么时候工作集 > 虚拟内存**

现在想象同一个程序取消分配所有 100 Mb 的内存。程序 VM 大小立即减少 100 MB（记住 VM = 所有内存分配请求的簿记）

工作集不必受此影响，因为这不会改变最近触及的那些 10 Mb 页面的事实。因此，尽管操作系统可以在需要时回收它们，但这些页面仍然保留在进程的工作集中。

这将有效地使 VM < 工作集。但是，如果您启动另一个消耗更多内存的进程并且操作系统回收工作集页面，这将纠正。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T07:24:09.910

XP的任务管理器是完全错误的。编辑：如果你不相信我（有人不相信，因为他们投了反对票），请阅读[Firefox 3 Memory Usage](http://blog.pavlov.net/2008/03/11/firefox-3-memory-usage/)。我引用：

> 如果您正在查看 Windows XP 下的内存使用情况，您的数字不会那么好。原因：微软在 XP 和 Vista 之间改变了“私有字节”的含义（为了更好）。

听起来MS很困惑。如果它坏了，你只会改变类似的东西。

请尝试使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。任务管理器标记为“VM 大小”，进程资源管理器（更正确）标记为“私有字节”。如您所料，在 Process Explorer 中，Working Set（和 Private Bytes）总是小于或等于 Virtual Size。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T11:23:42.627

## 文件映射

Mem Usage 高于 VM Size 的非常常见的方法是使用文件映射对象（因此它可以与共享内存相关，因为文件映射用于共享内存）。使用文件映射，您可以拥有一个已提交的内存（在页面文件或物理内存中，您不知道），但没有分配给它的虚拟地址。提交的内存出现在 Mem Usage 中，而使用的虚拟地址使用情况由 VM Size 跟踪。

也可以看看：

[Windows 任务管理器中的“VM 大小”是什么意思？](https://stackoverflow.com/questions/27407/what-does-vm-size-mean-in-the-windows-task-manager#114673)在 Stackoverflow 上

在我的开发者博客中[打破 32 位障碍](http://www.bistudio.com/index.php/english/company/developers-blog/85-breaking-the-32-bit-barrier)

Usenet 讨论[仍然困惑为什么工作集大于虚拟内存](http://groups.google.com/group/microsoft.public.vc.language/browse_frm/thread/35cdf48db03a246d/4d0524ab2b75c5e8?lnk=st&q=george+virtual+memory+committed+memory#4d0524ab2b75c5e8)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T05:32:48.887

**内存使用**量是当前分配给进程的电子内存量。

**VM Size**是当前分配给进程的虚拟内存量。

所以 ...

*   仅以电子方式存在的页面只会增加内存使用量。
*   仅存在于磁盘上的页面只会增加 VM 大小。
*   同时存在于内存和磁盘中的页面将同时增加。

一些例子来说明：

目前在我的机器上，iexplore 有 16,000K 内存使用和 194,916 VM 大小。这意味着 Internet Explorer 使用的大部分内存都处于空闲状态并已换出到磁盘，只有一小部分保留在主内存中。

与 mcshield.exe 相比，它的内存使用量为 98,984K，VM 大小为 98,168K。我的结论是，McAfee AntiVirus 处于活动状态，正在使用大量内存。由于它已经运行了很长一段时间（自启动以来一整天），我预计 98,168K VM 大小中的大部分是电子内存的副本——尽管任务管理器中没有任何内容可以证实这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T05:12:34.450

[您可能会在The Memory Shell Game](http://blogs.msdn.com/ntdebugging/archive/2007/10/10/the-memory-shell-game.aspx)中找到一些解释

**工作集**(A) – 这是一组用于进程的虚拟内存页面（已提交），位于物理 RAM 中。这些页面完全属于进程。工作集就像“当前/最近在这些页面上工作”列表。

**虚拟内存**——这是操作系统可以寻址的内存。无论物理 RAM 或硬盘空间有多少，这个数字都受您的处理器架构的限制。

**已提交内存**– 当应用程序接触到虚拟内存页面（读/写/以编程方式提交）时，该页面成为已提交页面。它现在由物理内存页面支持。这通常是一个物理 RAM 页面，但最终可能是硬盘上页面文件中的一个页面，或者它可能是硬盘上内存映射文件中的一个页面。内存管理器处理从虚拟内存页面到物理页面的转换。虚拟页面可能位于物理 RAM 中，而它旁边的页面可能位于页面文件中的硬盘驱动器上。

但是：PF（页面文件）使用 - 这是系统上已提交页面的总数。它不会告诉您实际写入页面文件的数量。它仅告诉您如果必须同时将所有已提交的页面写出到页面文件中，将使用多少页面文件。

因此 B > A ...

如果我们同意 B 代表“内存使用”或 PF 使用，那么问题就在于它实际上代表了[***潜在***的页面使用](http://www.aumha.org/win5/a/xpvm.htm)：在 Xp 中，这个潜在的文件空间可以用作分配程序拥有的那些虚拟内存页面的地方要求，但从未投入使用...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-06T17:36:19.513

内存碎片可能是原因：如果进程分配 1 个八位位组，它在 VMSize 中计为 1 个八位位组，但是这 1 个八位位组需要一个物理页面（Windows 操作系统上为 4K）。如果在分配/释放内存之后，进程有第二个八位字节与第一个八位字节相隔超过 4K，则第二个八位字节将始终存储在与第一个不同的物理页上。因此 VM 大小计数为 2 个八位字节，但内存使用量为 2 页== 8K

因此，MemUsage 大于 VMSize 的事实表明，进程执行了大量的分配和释放操作，并对内存进行了碎片化。这可能是因为该过程是很久以前开始的。否则有优化的地方;-)

# logging - 在桌面应用程序中登录的实践

> ID：252599
> 
> 赞同：4
> 
> 时间：2008-10-31T04:33:40.863
> 
> 标签：logging

我们正在开发一个桌面应用程序（visual basic 6.0）。我们有自己的日志框架。什么是好的做法？当我们有一个 Web 应用程序时，我们可以控制日志记录的级别。如何在桌面应用程序中进行操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T04:45:14.023

需要根据您的环境考虑任何答案：

*   您的业​​务规则（或法律）是否*要求*记录某些活动？
*   安全是个问题吗？
*   行动是否需要可追溯？
*   日志文件的大小（或磁盘空间量）是否有问题？
*   您的动机是记录活动、调试还是两者兼而有之？

考虑到这些：

*   考虑允许用户选择详细程度或“日志记录级别”。
*   记录所有程序错误和重要的用户错误。
*   记录影响系统配置或操作的任何活动。
*   记录用户会话的开始和结束。
*   记录应用程序的开始和结束。
*   考虑在第一次发生重大活动时记录日志。

其他建议：

*   在每个日志中或在日志“组”的开头包含最适合您的应用程序的时间戳。
*   如果您正在记录到一个文件，请考虑在日志达到特定大小或年龄时轮换日志（*即*关闭一个文件并打开一个新文件）。
*   如果应用程序包含多个模块，请在每个日志中包含模块的名称。
*   如果多人使用该应用程序（共享计算机？），请在每个会话开始时记录用户 ID。
*   根据严重性（错误、警告、信息、调试）分配日志“级别”。该`syslog`规范定义了 7 个“标准”级别，作为一个很好的参考。
*   询问您的客户他们希望在日志中看到什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T04:49:07.290

需要考虑的一个重要特性是允许在运行时动态调整日志级别，而无需停止和重新启动应用程序（我已经在 *nix 上使用自定义信号处理程序实现了这一点）。这在现场调试时有很大帮助。

很多时候，行为不端的应用程序在重新启动时会表现良好。动态可调整的日志级别可让您在将所有资源释放回操作系统之前查看正在发生的事情。

# c# - 锁定文本框中的有效字符

> ID：252611
> 
> 赞同：1
> 
> 时间：2008-10-31T04:40:56.463
> 
> 标签：c#, .net, winforms, validation, textbox

我需要能够锁定文本框中的有效字符，我目前有一个正则表达式，我可以检查每个字符，例如

> [A-Z-Z]

将锁定为仅 Alpha 字符。

```
protected override void OnKeyPress(KeyPressEventArgs e)
{
  if (e.KeyChar == (char)Keys.Back)
  {
    base.OnKeyPress(e);
    return;
  }
  if (String.IsNullOrEmpty(this._ValidCharExpression))
  {
    base.OnKeyPress(e);
  }
  else
  {
    bool isValidChar = Regex.Match(e.KeyChar.ToString(),this._ValidCharExpression).Success;
    if (isValidChar)
    {
      base.OnKeyPress(e);
    }
    else
    {
      e.Handled = true;
    }
  }
} 
```

我已将正则表达式代码放在 OnKeyPress 代码中，但我希望允许所有特殊键，例如 Ctrl-V、Ctrl-C 和 Backspace。

如您所见，我正在处理退格键。但是，例如，Ctrl-V 看不到 V 键，因为它为 ctrl 键运行一次，但看不到任何修饰键。

处理这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T07:32:40.737

[MaskedTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox(VS.80).aspx)可能适合您。

您还可以在 CodeProjct 上查看[FilterTextBox](http://www.codeproject.com/KB/miscctrl/FilterTextBox.aspx)。您可以使用它（或描述的方法）来做您想做的事情。基本思想是在更改变得可见之前取消更改（通过 OnTextChanging 事件）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T06:42:37.170

如果您将验证放在 OnTextChanged 而不是 OnKeyPress 中，但每次通过验证时您将值保存到变量中怎么办？然后，如果用户粘贴或键入了不正确的字符串，您可以恢复，以及提供一些其他 UI 提示某些内容无效（例如，设置标签的文本）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T05:42:28.057

为什么不在 OnTextChanged 事件中检查有效字符

然后在on键下处理Ctrl+C、Ctrl+V

您也可以使用 e.ModifierKeys == Keys.Control 来测试控制键

[http://msdn.microsoft.com/en-us/library/system.windows.forms.keypresseventargs.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.keypresseventargs.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T07:59:16.330

您可以使用 OnKeyPress / OnKeyUp / OkKeyDown 事件之一，然后使用 Char.IsLetter 方法检查输入的键是否为字母。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T00:51:10.903

我想出的解决方案是检查 OnKeyDown 事件中的键，然后设置一个标志是否应该处理按键，然后检查 OnKeyPress 事件。

```
protected override void OnKeyDown(KeyEventArgs e)
 {
    Keys keyCode = (Keys)e.KeyValue;
    base.OnKeyDown(e);
    if ((e.Modifiers == Keys.Control) ||
       (e.Modifiers == Keys.Control) ||
       (keyCode == Keys.Back) ||
       (keyCode == Keys.Delete))
    {
      this._handleKey = true;
    }
    else
    {
      // check if the key is valid and set the flag
      this._handleKey = Regex.Match(key.ToString(), this._ValidCharExpression).Success;
    }
  }

protected override void OnKeyPress(KeyPressEventArgs e)
  {
    if (this._handleKey)
    {
      base.OnKeyPress(e);
      this._handleKey = false;
    }
    else
    {
      e.Handled = true;
    }
  } 
```

# single-sign-on - Sun 访问管理器

> ID：252613
> 
> 赞同：0
> 
> 时间：2008-10-31T04:41:42.750
> 
> 标签：single-sign-on

我希望了解 SSO，并听说过 Sun Access Manager 和 openSSO（？） 我想构建一个执行 SSO 的小型系统，例如将 Apache 作为前端与 SSO 服务器一起使用。我应该调查 Sun AM 并且 openSSO 是一种产品吗？他们是否为开发人员免费提供这些？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T04:03:44.473

OpenSSO 是 Sun Access Manager 的新名称。OpenSSO 是开源的；源代码和二进制文件可从[http://opensso.org/](http://opensso.org/)免费获得。OpenSSO **Express**版本每三个月发布一次；OpenSSO **Enterprise** 8.0 是 Sun Access Manager 7.1 之后的下一个商业产品版本，将于 11 月 14 日发布。

您可以免费使用 OpenSSO，也可以购买许可证/支持并部署 Express 或 Enterprise 版本——您的选择。这是一个不断发展的、充满活力的社区，拥有[许多部署](http://blogs.oracle.com/superpat/tags/adoption)。

# php - 绕过 PHP 安全模式写入服务器。是否可以？

> ID：252615
> 
> 赞同：2
> 
> 时间：2008-10-31T04:46:05.953
> 
> 标签：php, safe-mode

由于服务器打开了安全模式，并且正在不同用户下创建目录，因此我遇到了以下问题：

1.  我将我的脚本上传到服务器，它显示为属于'user1'。它所做的只是在创建新用户时创建一个新目录，以便在其中存储文件。
2.  创建了新目录，但它属于“apache”用户。
3.  'user1' 和 'apache' 是不同的用户；并且安全模式已打开。因此 php 脚本无法写入新创建的目录。
4.  现在我有问题了！

一种解决方案是关闭安全模式。此外，一位同事建议可以更改一些设置以确保目录与脚本在同一用户下。所以我想看看后者是否可以完成。

但我不得不问。我的问题有程序解决方案吗？

我倾向于“不”，因为实施了安全模式以在 php 级别解决它。此外，实际问题可能看起来像是在不同用户下创建的目录，因此程序修复可能只是创可贴修复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T05:07:33.540

我已经使用了这个解决方法：

而不是 php mkdir 您可以通过具有适当权限的 FTP 创建目录。

```
 function FtpMkdir($path, $newDir) {
       $path = 'mainwebsite_html/'.$path;
       $server='ftp.myserver.com'; // ftp server
       $connection = ftp_connect($server); // connection

       // login to ftp server
       $user = "user@myserver.com";
       $pass = "password";
       $result = ftp_login($connection, $user, $pass);

       // check if connection was made
       if ((!$connection) || (!$result)) {
          return false;
          exit();
       } else {
         ftp_chdir($connection, $path); // go to destination dir
         if(ftp_mkdir($connection, $newDir)) { // create directory
             ftp_site($connection, "CHMOD 777 $newDir") or die("FTP SITE CMD failed.");
             return $newDir;
         } else {
           return false;
         }

         ftp_close($connection); // close connection
      }

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T05:07:05.803

您可以通过 .htaccess 文件（如果在 Apache 上）为特定目录关闭安全模式。

```
php_value safe_mode = Off 
```

您可能需要让您的托管服务提供商在 httpd.conf 中为您进行此更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-20T19:11:21.997

我在将上传目录的组位设置为粘性方面取得了一些成功。然后 PHP 可以在其中创建目录并对其进行写入。

[http://en.wikipedia.org/wiki/Setuid#setuid_and_setgid_on_directories](http://en.wikipedia.org/wiki/Setuid#setuid_and_setgid_on_directories)

chmod g+s*目录*

# c# - 通过 Web 服务将数据从 Sql Server 移动到 Excel

> ID：252624
> 
> 赞同：2
> 
> 时间：2008-10-31T04:53:09.560
> 
> 标签：c#, sql-server, web-services, excel

我的用户想要我的 Excel 应用程序中的数据。数据驻留在 SQL Server 数据库中，但我不希望用户直接访问数据库，我宁愿为他们提供 Web 服务来获取数据。通过 Web 服务将数据从 SQL Server 移动到 Excel 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T05:09:39.620

以下代码将从数据表生成一个 excel 文件，您可以将其流式传输给用户

```
 public static void CreateExcelFromDataTable(string filename, DataTable dt) {

        DataGrid grid = new DataGrid();
        grid.HeaderStyle.Font.Bold = true;
        grid.DataSource = dt;
        grid.DataMember = dt.TableName;

        grid.DataBind();

        // render the DataGrid control to a file

        using (StreamWriter sw = new StreamWriter(filename)) {
            using (HtmlTextWriter hw = new HtmlTextWriter(sw)) {
                grid.RenderControl(hw);
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T04:56:55.013

您可以将其作为一个直接的 asp.net 页面并返回一个 .csv 文件。如果将 mimetype 更改为 text/csv，它应该默认在 excel 中打开。这将是最简单的方法，也是我过去成功使用的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T05:09:45.813

让 Web 服务发出一个字符串缓冲区，其中单元格由制表符分隔，行由回车符/换行符分隔。然后使用 Excel Web 查询将结果通过管道传输到 Excel。它便宜，快速，有点脏，但适用于简单的过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T05:05:07.540

您还可以使用 .xls 文件名回退一个带有表格的 html 页面，excel 也知道如何打开它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-26T07:02:41.857

我赞成 Excel Web 查询（数据/外部导入）此外，还有一种方法可以将 Excel 中的数据发布回网站。至少它在 MS Sharepoint 中工作

# regex - 需要一个简单的正则表达式来查找单个单词中的数字

> ID：252626
> 
> 赞同：7
> 
> 时间：2008-10-31T04:55:18.433
> 
> 标签：regex

我有以下 url 路线，我想确保路线的一部分只接受数字。因此，我可以提供一些检查单词的正则表达式。

/page/{当前页面}

所以..有人可以给我一个正则表达式，当单词是大于0的数字（任何int）（即1 <-> int.max）时匹配。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-31T05:38:52.730

```
/^[1-9][0-9]*$/ 
```

其他答案的问题：

```
/([1-9][0-9]*)/ // Will match -1 and foo1bar
#[1-9]+# // Will not match 10, same problems as the first
[1-9] // Will only match one digit, same problems as first 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-31T05:02:00.773

如果您希望它大于 0，请使用此正则表达式：

```
/([1-9][0-9]*)/ 
```

只要数字没有前导零（如“03”），这将起作用。

但是，我建议只使用一个简单的`[0-9]+`正则表达式，并在您的实际站点代码中验证数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T14:04:41.177

这将解决您的具体问题。这个表达

```
/\/page\/(0*[1-9][0-9]*)/ or "Perl-compatible" /\/page\/(0*[1-9]\d*)/ 
```

应该捕获任何非零数字，即使是 0 填充。而且因为它甚至不*寻找*符号，`-`所以斜线之后将不适合模式。

我对没有眼睑的表情的问题是，您可能还没有隔离数字以便可以`^`工作`$`。你将不得不做一些工作*来隔离*它。但是一般的解决方案不是假设数字就是字符串包含的全部内容，如下所示。

```
/(^|[^0-9-])(0*[1-9][0-9]*)([^0-9]|$)/ 
```

如果 RE 语言有这两个尾端组，则可以用*单词边界*标记 ( ) 替换。`\b`如果语言有它们，你会将它们放入非捕获组中，如果有的话，甚至是环视——但它更有可能在环视之前有单词边界。

完全*兼容 Perl 的*版本：

```
/(?<![\d-])(0*[1-9]\d*)\b/ 
```

我选择了否定的lookbehind而不是单词边界，因为'-'不是单词字符，所以-1在'-'和'1'之间会有一个“单词边界”。否定的后视将匹配字符串的开头——前面不能有数字字符或“-”。

您可以说零宽度假设`^`只是满足零宽度假设的情况之一`(?<![\d-])`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T05:05:37.070

```
string testString = @"/page/100";
string pageNumber = Regex.Match(testString, "/page/([1-9][0-9]*)").Groups[1].Value; 
```

如果不匹配 pageNumber 将是“”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T06:17:18.580

虽然 Jeremy 的正则表达式并不完美（应该在上下文中针对主要字符等进行测试），但他的建议是好的：使用通用、简单的正则表达式（例如，如果您必须在 Apache 的 mod_rewrite 中使用它），但无论如何，处理服务器代码中的最终重定向（如果可以的话）并在那里真正检查参数的有效性。

否则，我会改进 Jeremy 的表达式：`/\b([1-9][0-9]*)$/`
当然，正则表达式不能提供对*任何*最大 int 的检查，充其量您可以控制位数：`/\b([1-9][0-9]{0,2})$/`例如。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T14:02:44.987

这将匹配任何字符串，如果它包含`/page/`，则它后面*必须*跟一个数字，而不是*仅*由零组成。

```
^(?!.*?/page/([0-9]*[^0-9/]|0*/)) 
```

`(?! )`是一个负前瞻。它将匹配一个空字符串，只有当它包含的模式与当前位置*不匹配时。*

# c - 为什么这个联合会删除 c 代码中数组中的第一条记录？

> ID：252644
> 
> 赞同：1
> 
> 时间：2008-10-31T05:06:43.807
> 
> 标签：c, arrays, structure, unions

这是我的头文件之一，它由一个具有 4 种不同结构的联合模板组成。

```
#define MAX 3

union family
{
  struct name      /*for taking the name and gender of original member*/
     {
      unsigned char *namess;
      unsigned int gender;
      union family *ptr_ancestor; /*this is a pointer to his ancestors details*/
     }names;

  struct male /*for taking the above person's 3 male ancestors details if he is male*/
     {
       unsigned char husb_names[3][20];
       unsigned char wife_names[3][20];
       unsigned int wife_status[3];
     }male_ancestor;

  struct unmarry /*for taking the above person's 3 female parental ancestors if she is female and unmarried*/
    {
      unsigned int mar;
      unsigned char parental_fem[3][20];
      unsigned int marit_status[3];
    }fem_un;

  struct marry /*for taking 3 parental-in-laws details if she is female and married*/
    {
      unsigned int mar;
      unsigned char in_law_fem[3][20];
      unsigned int in_marit_status[3];
    }fem_marr;

};
extern union family original[MAX]; /*for original person*/
extern union family ancestor_male[MAX]; /*used if he is male for storing his male ancestor details*/
extern union family ancestor_female[MAX]; /*used if she is female*/

extern int x; 
```

我的目标是获取一个人的姓名和性别，并根据该人的性别和婚姻状况存储该人的任何 3 个男性/女性祖先，如下所示..

我的意思是`MAX`将有 3 个成员，每个成员将有 3 个祖先。这些祖先将由相应成员的性别决定，如以下条件：

*   如果是男性，则使用`struct male`
*   如果女性未婚使用`struct unmarry`
*   如果女性已婚使用`struct marry`

`struct name`用于我们必须为其获取祖先的成员名称和性别，并将其指向`*ptr_ancestor`相应的祖先数组（ancestormale 或ancestratefemale）。

内存中的对象是一个联合。行。事实上，我的程序将有一系列联合。数组的每个元素可能在联合中使用不同的结构。在这里我们应该小心分配指针，否则我们可能会在运行时丢失我们的老年人记录。

如果可能，请告诉我如何获取第一个元素的详细信息，即。`original[0]`即使在服用`original[1]`. 在这里，我只是获取数组的最后一个元素，并且所有以前的记录在运行时都消失了。我没有使用任何其他数据结构或文件。

我的环境是 Windows 上的 Turbo C。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T05:23:06.363

您可能误解了工会的目的。

联合通常用于存储可能采用多种形式之一的一项**。**例如：

```
// Define an array of 20 employees, each identified either by name or ID.
union ID {
    char name[10];   // ID may be a name up to 10 chars...
    int  serialNum;  // ... or it may be a serial number.
} employees[20];

// Store some data.
employees[0].serialNum = 123;
strcpy(employees[1].name, "Manoj"); 
```

`struct`a和 a之间的关键区别在于 a`union`是`struct`多条数据的聚合，但 a`union`是*叠加层*：您可以只存储*其中一个*元素，因为它们都共享相同的内存。在上面的示例中，`employees[]`数组中的每个元素由 10 个字节组成，这是可以容纳*10* s`char`或*1*的最小内存量`int`。如果引用该`name`元素，则可以存储 10 `char`s。如果引用该`serialNum`元素，则可以存储 1 `int`（例如 4 个字节）并且无法访问剩余的 6 个字节。

所以我认为你想使用不同的、独立的结构来代表家庭成员。你所做的似乎是将几个方形钉塞进一个圆形的家庭作业中。:-)

*高级读者注意：请不要提及填充和单词对齐。他们可能会在下学期被覆盖。:-)*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T06:07:57.037

你需要阅读这个[关于 unions](https://stackoverflow.com/questions/252552/unions-in-c)的问题。你想要更多类似的东西：

```
struct family {
    struct name { 
        int gender;
        int married;
        blah
    } names;
    union {
        struct male { blah } male_ancestor;
        struct female_unmarried { blah } female_unmarried_ancestor;
        struct female_married { blah } female_married_ancestor;
    };
} 
```

然后您可以测试 family.names.gender 和 family.names.married 以确定使用哪个工会成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T05:13:53.887

你知道C语言中的联合是什么意思吗？您的工会没有 3 个成员。您的工会有 4 名成员。在这 4 个成员中，您要存储多少个值？

你为什么不问你的TA？

# .net - ADO.NET 数据服务可以使用命名管道作为传输吗

> ID：252655
> 
> 赞同：2
> 
> 时间：2008-10-31T05:12:54.793
> 
> 标签：.net, wcf, ado.net, rest

我很清楚基于 Rest 的方法是针对 HTTP 的。我很想在同一台计算机上的进程之间使用 REST API 和其他优点。由于 ADO.NET 数据服务是在 WCF 之上构建的，因此可以合理地假设可配置的传输可与任何 WCF 支持的传输一起使用。任何人都知道是否有办法将其配置为通过命名管道发送流量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-01T02:02:28.293

实际上 REST 架构风格在任何方面都不需要 HTTP。这恰好是最常见的实现协议。但是，ADO.Net 数据服务使用与 http 绑定的 System.ServiceModel.Web。你当然可以在命名管道上做 REST，你只需要找到一个不同的协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T10:31:12.903

在 .NET 3.5 中，WCF 有内置的命名管道绑定。有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.servicemodel.netnamedpipebinding.aspx)。

# c# - 如果方法的最后一个参数被标记为“参数”，反射是否会暴露？

> ID：252656
> 
> 赞同：4
> 
> 时间：2008-10-31T05:13:31.000
> 
> 标签：c#, reflection

在方法定义上使用反射我想知道原始方法是否在最后一个参数上使用“params”定义。所以我能发现原来的定义是不是这样......

```
public void MyMethod(int x, params object[] args); 
```

……不是这个……

```
public void MyMethod(int x, object[] args); 
```

我的代码有一个参数列表，并使用反射来调用任意方法。如果它标有“参数”，那么我想将额外的参数打包到一个对象 [] 中并调用该方法。如果参数没有用“参数”标记，那么我会指出一个错误。所以我想提供与 C# 相同的语义。

但我找不到任何说明如何使用反射来发现这一点的文档。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T05:33:18.123

使用[ParamArrayAttribute](http://msdn.microsoft.com/en-us/library/system.paramarrayattribute.aspx)属性

```
class Program
{
    public void MethodWithParams(object param1, params int[] param2) 
    {            
    }

    static void Main(string[] args)
    {
        var method = typeof(Program).GetMethod("MethodWithParams");
        var @params = method.GetParameters();
        foreach (var param in @params) 
        {
            Console.WriteLine(param.IsDefined(typeof(ParamArrayAttribute), false));
        }
    }
} 
```

# offline - 离线网络应用程序可以替代桌面应用程序吗？

> ID：252658
> 
> 赞同：1
> 
> 时间：2008-10-31T05:14:12.140
> 
> 标签：offline, tablet-pc

我在一个桌面销售应用程序上工作，该应用程序在平板电脑上运行，我想知道这个和其他“传统”桌面平板电脑应用程序是否可以作为离线 Web 应用程序。与平板电脑应用程序的主要区别在于墨迹支持。我认为网络应用程序可以通过浏览器手势接近。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:01:39.753

主要的不同是墨迹（手势）支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T05:18:18.403

我看不出平板电脑和笔记本电脑之间的区别。无论采用何种媒介，构建离线 Web 应用程序的决定都应该没有什么不同。

# javascript - 如何使用 javascript 删除我的浏览器 cookie？

> ID：252660
> 
> 赞同：3
> 
> 时间：2008-10-31T05:17:39.307
> 
> 标签：javascript

如何使用 javascript 从浏览器中删除会话信息？有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T05:30:14.010

会话信息通常存储在服务器上。对破坏会话的页面的 HTTP 请求通常可以解决问题（如果您愿意，可以使用 AJAX）。

对于 cookie，您可以将 cookie 到期日期设置为当前日期，这将使 cookie 到期并将其删除。

```
var d = new Date();
document.cookie = "cookiename=1;expires=" + d.toGMTString() + ";" + ";"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T05:46:23.260

基本上，您只需将 cookie 的到期日期设置为过去的某个日期。

```
var cookie_date = new Date ( );  // now
cookie_date.setTime ( cookie_date.getTime() - 1 ); // one second before now.
// empty cookie's value and set the expiry date to a time in the past.
document.cookie = "logged_in=;
                  expires=" + cookie_date.toGMTString(); 
```

单击[此处](http://techpatterns.com/downloads/javascript_cookies.php)或[此处](http://www.elated.com/articles/javascript-and-cookies/)了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T06:07:41.500

如果您没有为 cookie 设置到期日期，则根据定义，它只是会话存在的。IE。当用户关闭浏览器时，它将被删除。因此，无需清理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T09:00:46.190

除了到期之外，我们一直在写入一个“已删除”或类似于 cookie 的值。在某些情况下，我们发现 cookie 不会立即过期，从 js 访问它们可能会在短时间内给出错误的结果。

# c# - 本地化：如何将文化信息映射到脚本名称或 Unicode 字符范围？

> ID：252662
> 
> 赞同：2
> 
> 时间：2008-10-31T05:18:37.730
> 
> 标签：c#, localization, .net-2.0, globalization, culture

我需要一些关于本地化的信息。我正在使用带有 C# 2.0 的 .net 2.0，它处理了大部分与本地化相关的问题。但是，我需要在一个特定的屏幕上手动绘制与当前文化相对应的字母表。

这类似于 Microsoft Outlook 中的联系人屏幕（联系人下的地址卡视图或详细地址卡视图），因此它需要在右端有一列按钮，每个字母一个。

我试图模仿这一点，但我不想让用户选择脚本。如果说现在的文化是中文，我想画中文字母。当用户将文化信息更改为英语时（以及当他重新启动应用程序时），我想改为绘制英文字母。希望您了解我将使用此查询的去向。

我可以确定当前用户的文化（Application.CurrentCulture 或 System.Globalization.CultureInfo.CurrentCulture 会给出文化相关的信息）。我也有所有的脚本来呈现字母。但是，问题是我不知道如何将文化信息映射到脚本的名称。

换句话说，有没有办法确定与文化对应的脚本名称？或者是否可以确定与文化对应的 Unicode 字符值的范围？它们中的任何一个都可以让我正确呈现按钮上的字母。

对此的任何建议或指导都非常感谢。如果我的方法（或我试图实现的目标）存在根本性错误，请同时指出。谢谢你的时间。

PS：我知道最简单的解决方案是将脚本名称配置为用户首选项的一部分，或者显示语言列表供用户选择（如 Outlook 2007 中的联系人）。但我只是想看看我是否可以在用户不必做任何事情的情况下呈现与文化相对应的字母表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T18:46:03.353

在本机代码中，GetLocaleInfoEx()（Vista 及更高版本）的 LOCALE_SSCRIPTS 向您显示语言环境需要哪些脚本。.Net 目前还没有类似的概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T13:47:14.190

中文有数千个字符，因此显示其字符集中的所有字符可能不可行。中文中没有“字母”的原生概念，我认为中文没有像日语那样的音节。

拼音（用罗马字母书写的中文）可用于表示汉字，这可能有助于您对它们进行索引。我知道这不能回答你的问题，但我希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T20:09:28.613

我完全同意mikiemacman。此外，给定的语言不一定使用脚本的所有字母。

无论如何，我能想到的最接近的是 CultureInfo.TextInfo.ANSICodePage -> There are only a few of [ANSI code pages](http://blogs.msdn.com/shawnste/archive/2006/09/29/list-of-ansi-code-pages-used-by-windows.aspx)。您可以创建一个列出每个 ANSI 代码页的脚本的表（或 switch() 语句，等等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T15:59:11.673

原型，等等！有一个更准确的解决方案。这是您可能不得不 P/Invoke 的非托管。

```
GetLocaleInfoW(MAKELCID(wLangId, SORT_DEFAULT), LOCALE_FONTSIGNATURE, wcBuf, MAXWCBUF); 
```

这为您提供了一个[LOCALESIGNATURE](http://msdn.microsoft.com/en-us/library/ms776437(VS.85).aspx)结构。答案在 lsUsb 字段中：Unicode 子集位字段。老鼠！此结构的 MS 页为空。但是在您的 MSDN 副本中查找它。那里有完整的记录：一整套描述支持哪些脚本的标志。是的，泰米尔语有一面旗帜;-)

HTH。

编辑：哎呀！没有看到肖恩的回答。哇！来自内部专家的回答！;-) 无论如何，您可能仍然对 Pre-Vista 兼容的答案感兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T20:29:55.047

引人入胜的话题。虽然它可能无法回答您的问题，但[Omniglot](http://www.omniglot.com/writing/index.htm)是一个很好的资源。

正确答案可能很复杂，并且取决于您要解决的确切问题。假设您的目标仅显示以特定语言使用的字母来分隔电话簿部分（如在 Outlook 中），则很少有问题是：

*   联系人姓名跨越多种文字/语言的人。
*   2 个字形字母（例如塞尔维亚语中的“Lj”）。它是一个音素，尽管它有 2 个 Unicode 符号，但始终被视为单个字母。'它将在电话簿中有自己的部分（与'L'分开）。
*   字形太多无法列出（例如中文）
*   非正统排序（例如泰语——电话簿将仅由辅音分隔，忽略元音）。
*   大写/小写的区别（大概你只想要一种支持它的语言的大小写——它在土耳其语的“i”中以较小的方式分解）。

# javascript - 我需要从浏览器中获取所有 cookie

> ID：252665
> 
> 赞同：117
> 
> 时间：2008-10-31T05:22:09.813
> 
> 标签：javascript, cookies

我需要使用 JavaScript 获取存储在浏览器中的所有*cookie 。*怎么做到呢？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2008-10-31T09:28:31.487

您只能访问特定站点的 cookie。使用**`document.cookie`**您将获得由分号分隔的转义键=值对列表。

```
secret=do%20not%20tell%you;last_visit=1225445171794 
```

为了简化访问，您必须解析字符串并取消转义所有条目：

```
var getCookies = function(){
  var pairs = document.cookie.split(";");
  var cookies = {};
  for (var i=0; i<pairs.length; i++){
    var pair = pairs[i].split("=");
    cookies[(pair[0]+'').trim()] = unescape(pair.slice(1).join('='));
  }
  return cookies;
} 
```

所以你以后可能会写：

```
var myCookies = getCookies();
alert(myCookies.secret); // "do not tell you" 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-31T06:12:39.120

1.  您看不到其他网站的 cookie。
2.  你看不到[`HttpOnly`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Secure_and_HttpOnly_cookies)cookies。
3.  您可以看到的所有 cookie 都在该[`document.cookie`](http://msdn.microsoft.com/en-us/magazine/ms533693.aspx)属性中，该属性包含一个以*分号*分隔的`name=value`对列表。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-10-31T06:00:28.707

你不能。根据设计，出于安全目的，您只能访问您网站设置的 cookie。StackOverflow 看不到 UserVoice 设置的 cookie，也看不到 Amazon 设置的 cookie。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-31T05:34:49.680

要检索在浏览器中打开的当前文档的所有 cookie，请再次使用该`document.cookie`属性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-05-09T05:01:00.793

现代方法。

```
let c = document.cookie.split(";").reduce( (ac, cv, i) => Object.assign(ac, {[cv.split('=')[0]]: cv.split('=')[1]}), {});

console.log(c); 
```

;)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-28T07:15:26.430

由于标题没有指定它必须是程序化的，我假设这是一个真正的调试/隐私管理问题，并且解决方案取决于浏览器，并且需要具有内置详细 cookie 管理收费和/或调试模块的浏览器或插件/扩展。我将列出一个，并请其他人在他们详细了解的浏览器上写下来，并请提供准确的版本。

**铬，铁构建（SRWare Iron 4.0.280）**

> 扳手（工具）菜单：选项/幕后/[显示 cookie 和网站权限] 对于相关域/站点，在搜索框中键入后缀（如 .foo.tv）。警告：当您有一个节点（站点或 cookie）单击突出显示时，仅使用 [删除] 来杀死特定的子树。使用 [全部删除] 仍会删除搜索选择的所有站点的 cookie，并浪费您的调试会话。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-05-10T06:25:21.037

将 trim() 添加到 object 的 key 中，并将其命名为 str，这样会更清楚我们在这里处理的是 string。

```
export const getAllCookies = () => document.cookie.split(';').reduce((ac, str) => Object.assign(ac, {[str.split('=')[0].trim()]: str.split('=')[1]}), {}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-11-20T14:44:26.363

如果您开发[浏览器扩展](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions)，您可以尝试[browser.cookies.getAll()](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies/getAll)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-29T01:56:51.197

你问的是可能的；但这仅适用于特定浏览器。您必须开发一个浏览器扩展应用程序来实现这一点。您可以阅读有关 chrome api 的更多信息以更好地理解。[https://developer.chrome.com/extensions/cookies](https://developer.chrome.com/extensions/cookies)

# c++ - auto 在 C/C++ 中有用吗？

> ID：252671
> 
> 赞同：6
> 
> 时间：2008-10-31T05:27:22.440
> 
> 标签：c++, c, syntax, keyword

有没有人见过`auto`在 C/C++ 中明确使用的存储类？如果有，在什么情况下？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-31T05:31:47.640

auto 在当前的 C/C++ 中从来没有用过，因为所有变量都是隐式自动的。它在 C++0x 中很有用，它可以完全替换类型声明 - 如果您有一个带有初始赋值的变量，'auto' 只会使其成为该赋值值的类型，如注释中所示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T05:35:34.840

我没有看到`auto`在过去 10 多年编写的代码中使用过。没有理由使用它，`auto`因为您唯一*可以*使用它的地方就是它暗示的地方。它仍然存在的唯一原因是为了向后兼容，但在新代码中应该避免它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T10:27:10.057

在 GCC 中，您可能需要 auto 来声明嵌套函数，以便能够在函数体中的任何位置定义它 - 请参阅[http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Nested-Functions.html](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Nested-Functions.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T05:32:20.870

不，假设您省略了类说明符。我能想到的唯一合理的用途是提醒人们注意一个特定的局部变量，它会覆盖一个同名的全局变量，或者作为一个面试问题。

很有可能，你会让那些坚持维护代码的可怜程序员感到困惑！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T08:30:56.983

正如 Alex 所介绍的，auto 在 C++0x 中用于在初始化声明中声明类型，其中类型是从初始化代码中推断出来的。

有人提议将它也用作返回类型，其中类型是从返回值的代码中推导出来的。然而，这引起了歧义，因此在撰写本文时，正在考虑与 C++0x 的 lambda 语法更一致的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-24T21:51:01.080

这是我的代码中的一个示例，用 C++11 编写：

```
c_srgb find_in_book(const c_HVC &HVC) {
    auto b = munsell.mun_to_rgb_book.find(HVC);
    if( b != munsell.mun_to_rgb_book.end()) {
        c_srgb f = b->second;
        return f;
    } else {
        c_srgb ret;
        ret.r=ret.g=ret.b=0;
        return ret;
    }
} 
```

我更喜欢这个：

```
c_srgb find_in_book(const c_HVC &HVC) {
std::_Tree_iterator<std::_Tree_val<std::_Tmap_traits<dj::color::c_HVC,dj::color::c_srgb,std::less<dj::color::c_HVC>,std::allocator<std::pair<const dj::color::c_HVC,dj::color::c_srgb>>,false>>> b = munsell.mun_to_rgb_book.find(HVC);
    if( b != munsell.mun_to_rgb_book.end()) {
        c_srgb f = b->second;
        return f;
    } else {
        c_srgb ret;
        ret.r=ret.g=ret.b=0;
        return ret;
    }
} 
```

# javascript - 用于检查 JavaScript 语法的 Firefox 附加工具？

> ID：252677
> 
> 赞同：3
> 
> 时间：2008-10-31T05:31:30.637
> 
> 标签：javascript, firefox, toolkit

不确定是否有任何用于检查 JavaScript 语法、var 声明甚至预编译的 Firefox 附加工具可用？

我发现在 web html 页面中调试 JavaScript 非常困难。我必须在那里添加一些脚本。当脚本变得很大或很长时，它就会停止工作。基本上，肯定有一些错误。即使加载事件停止工作也非常令人沮丧。我确实需要一些好的工具来找出错误。

我已经尝试过 FireBug。这很好，但还不够。也许我不知道它的所有功能。无论如何，我需要任何好的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T05:45:33.137

此页面可能会对您有所帮助，因为它还包含截屏视频。

[使用 Firebug 在 Firefox 中调试 Javascript](http://asymptomatic.net/2007/08/22/2643/debugging-javascript-in-firefox-with-firebug-and-breakpoints)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T06:08:37.893

它不是严格意义上的附加组件（尽管您显然可以在 Firefox 网页中运行它），但我发现[JSLint](http://www.jslint.com/)有助于暴露可能或可能不是严格无效语法的表达式异常（尽管它会捕获所有这些， 也。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T07:39:38.663

我的建议是用[JSLint](http://www.jslint.com/)检查你的 javascript 。JSLint 将向您展示 javascript 代码中的常见问题，并帮助您创建严格且兼容的代码。

[YSlow](http://developer.yahoo.com/yslow/)包含 JSLint 作为工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T05:51:29.753

作为[FireBug](http://getfirebug.org)的替代品，请检查这个调试器：[Venkman JavaScript Debugger](http://addons.mozilla.org/en-US/firefox/addon/216)，已经存在了一段时间，而且还不错……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T06:00:05.260

我一直是萤火虫的粉丝，它肯定是最好的调试器之一。任何 JS 问题 按 F12，启用控制台以捕获错误，然后您可以找到导致错误的确切行。添加断点，您也可以看到变量的确切值。非常直观的用户界面..只要习惯使用它，它将为您节省大量时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T07:00:50.207

我强烈推荐[彩虹](http://xrefresh.com/rainbow)。它仍处于测试阶段，仅适用于 FF3，但它提供语法高亮显示。当涉及到语法时，这会让你半途而废。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T08:57:19.410

我经常使用带有 15000 行的 js 文件的 firebug。我对它没有任何问题（有时我必须等待几秒钟才能滚动到断点，但即便如此它也能正常工作）。

不幸的是，JSLint 不适合我们。我们使用一些第三方代码，虽然“有效”有不必要的“;” 根据jsLint。代码在我们的 js 文件的开头，jslint 在 3% 时停止分析，因为它认为错误太多（所有这些都是不必要的“;”。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-11T15:11:07.360

你在两个方面错过了重点：

*   首先，出现大量不必要的错误消息将使得一开始就无法找到问题。
*   其次，错误是不必要的。我曾经虔诚地使用[JSLint](http://www.jslint.com/)，但现在它变得过于纳粹代码了，我无法使用它。

我知道它检查的许多东西都可以被禁用，但我没有足够的时间来研究我必须做的事情。

问题是默认配置的可用性。我和最初的海报一样，只是在寻找一种方法来快速找到真正的 JavaScript 语法错误，包括在 HTML 页面上。我确信 Firebug 可以做到，但与 JSLint 一样，我没有空闲时间去了解如何去做。

但是，我确实使用 Firebug 进行调试，尽管我使用的版本 (1.10.3) 有显示错误的坏习惯，但报告的文件和行号不正确。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-20T23:28:11.943

我使用以下两个代码验证。

*   JSHint@ [http://jshint.com](http://jshint.com)
*   JSLint FF 插件。访问[https://addons.mozilla.org/en-us/firefox/addon/jslinter/](https://addons.mozilla.org/en-us/firefox/addon/jslinter/)

或者，jshint 和 jslint 插件可用于 Notepad ++、sublime 等文本编辑器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-10-26T15:08:12.770

嗨 Gene：您可以将 jslint.js 文件中的一个变量 option.maxerr 更改为*您*想要的数字**。**

 *默认值为 50，您可以将其更改为 500 或 1000 以适应您的口味。

# linq-to-sql - LINQ to SQL 是死的还是活的？

> ID：252683
> 
> 赞同：95
> 
> 时间：2008-10-31T05:33:51.227
> 
> 标签：linq-to-sql

就在我与 LINQ to SQL 交朋友时，似乎 MS 正在从它下面拉出地毯。

[http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)

根据我的一点点研究，EF 对于简单的工作来说太过分了。但是在此公告之后，继续使用 LINQ to SQL 是否有意义？

除了 LINQ to SQL 的未来之外，这通常不是发出一个坏信号吗？考虑到 MS 将钻头扔到墙上的速度，尽早使用任何新钻头是否合理？（这很好，LINQ to SQL 还为时过早！）。

对于我的 LINQ to SQL 工作，我想我要去 SubSonic！

更新：一些新意见：

[http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx](http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx)

[http://codebetter.com/blogs/david.hayden/archive/2008/10/31/linq-to-sql-is-dead-read-between-the-lines.aspx](http://codebetter.com/blogs/david.hayden/archive/2008/10/31/linq-to-sql-is-dead-read-between-the-lines.aspx)

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-10-31T12:07:39.633

1) 他们不能“杀死” Linq-to-SQL，因为它已经是 .net 框架的一部分。他们能做的就是停止为其添加功能。这并不能阻止成千上万已经在使用 L2S 的开发人员对其进行扩展和改进。一些核心区域很难触碰，但它们已经很稳固了，[缺少的设计器功能很容易被用螺栓固定](http://www.huagati.com/dbmltools/)。

2) 一次[PDC EF 会议](http://channel9.msdn.com/pdc2008/TL20/)表明，他们从 EFv1 惨败中吸取了一些教训，现在他们正在将 L2S 中的许多好东西复制并粘贴到 EF 中，并假装它是新的 EF 东西。换句话说，L2S 版本 2 刚刚被“重新标记”为 EF。

3) LINQ 本身（语言集成查询）是自切片冰淇淋以来最好的东西，它可以与 L2S 以外的许多其他东西一起使用（Linq 到对象，Linq 到实体，Linq 到 XML，Linq 到任何东西）。因此，DP 小组试图迫使 [大量] L2S 采用者转向 [不那么流行且目前存在缺陷的] Entity Framework 并不是不学习 Linq 的理由。

另请参阅此线程（我认为这部分触发了 Tim 的博客文章）： [http ://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4061922&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4061922&SiteID=1)

**更新 1：** Roger Jennings 于 2008 年 12 月出版的 Visual Studio 杂志封面故事是该主题的好读物，其中包含一些 L2S 与 EF 比较：http://visualstudiomagazine.com/features/article.aspx?editorialsid= [2583](http://visualstudiomagazine.com/features/article.aspx?editorialsid=2583)

**更新 2：在**[Redmond Developer News](http://reddevnews.com/blogs/weblog.aspx?blog=3016)中引用 Anders Hejlsberg 的话说“ *LINQ to SQL 没有死。我可以向你保证，它没有死。什么都不会消失。我们从来没有这样做过，也永远不会这样做。* ”

[http://reddevnews.com/blogs/weblog.aspx?blog=3016](http://reddevnews.com/blogs/weblog.aspx?blog=3016)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-31T05:41:43.457

您的问题有歧义，需要解决。

LINQ != LINQ 到 SQL

有一大堆 LINQ 技术和提供程序：

*   LINQ转SQL；
*   Linq 到实体；
*   Linq 到对象；
*   LINQ转XML；

......而这些只是来自微软的。也有非 MS 提供者，包括 NHibernate。

您链接的博客文章仅讨论了 Linq to SQL。

LINQ 的主要优势是您可以学习和使用一种查询语法，并在多种技术中重复使用它。

鉴于此，我建议任何感知到的“Linq To SQL”缺乏未来都是无关紧要的，因为您在编写 LINQ 查询中获得的技能将来可以转移到其他工具。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-08-22T23:04:18.857

我们不会杀死 LINQ to SQL。我们正在针对 EF 进行优化，但 LINQ to SQL 绝对不会被淘汰 :)

- 斯科特/微软。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-31T13:50:31.577

您不仅应该学习 Linq（System.Linq.Enumerable 和 System.Linq.Queryable），还需要学习 .net 语言的编程语言增强功能。

在 C# 3.0 中，这些包括：

*   扩展方法（第一个参数带有 this 关键字的静态方法）
*   编译器推断类型 (var)
*   Lambda 语法（根据上下文生成匿名方法或表达式）
*   初始化器
*   属性默认实现（简写）

[在这里](http://msdn.microsoft.com/en-us/library/ms364047(VS.80).aspx)阅读更多。

* * *

在 VB 9.0 中，有一些内联 XML 魔法，还有很多其他的东西（很多类似于上面的 C# 列表）。

[在这里](http://msdn.microsoft.com/en-us/library/ms364068.aspx)阅读更多。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-09T12:21:23.467

老实说，我不明白您在那篇文章中的哪个地方看到 link2sql 已死。

在您链接到它的博客文章中说：

***我们正在听取客户关于 LINQ to SQL 的意见，并将根据我们从社区收到的反馈继续改进产品。***

对我来说，这读起来就像 LINQ to SQL 将在未来得到开发和支持。我想知道你为什么认为它已经死了？

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-31T06:10:13.743

当然，我认为在 LINQ to SQL、LINQ to Entities 和 LINQ to [插入第 3 方 ORM] 之间进行选择提供了一个非常健康的数据访问层方法生态系统，软件开发人员可以从中进行选择。NHibernate、LLBLGen 甚至 Subsonic 等第三方提供商（不确定他们是否会提供 LINQ 提供商）肯定会让竞争变得更好、更有趣。

话虽如此，微软放弃 LINQ to SQL 将是完全可悲的，特别是因为它确实有很好的追随者——甚至 StackOverflow 也是建立在它之上的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-31T13:19:23.700

[关于它的有趣的博客文章。](https://stackoverflow.com/questions/253179/best-primary-key-data-type-for-linq-to-sql)[以及Stackoverflow 帖子](http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx) 上的一些相关信息。

基本要点似乎是在[ado.net 博客](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)上发表的评论，其中指出 Entity Framework 是 Visual Studio 2010 和 Dot Net 4 的唯一主要开发人员时间。

我的回答是——呃。我们都知道这一点。微软在 PDC 2007 上公开表示，LINQ to SQL 是 SQL Server 的短期版本，因为 SQL Server 没有其他 LINQ 故事。它仅适用于 SQL Server。您不能编写 LINQ to SQL 提供程序 - 它没有模型。这是一种一次性技术，不可扩展。

实体框架是 Microsoft 构建 LINQ 提供程序的唯一方法。实体框架被证明是相当有争议的，但我认为这部分是因为 LINQ to SQL 今天有更好的程序员体验。Entity Framework 将赶上并超越 LINQ to SQL，因为它是 Microsoft 未来的 ORM/Mapping 工具。

[编辑 - 我刚刚在我的博客](http://www.vistadb.net/blog/post/2008/10/31/Microsoft-killing-LINQ-to-SQL.aspx)上写了一个稍微详细一点的文章

EDIT2 - IQueryable 提供程序 - 与 LINQ to SQL 提供程序不同。您可以为您喜欢的任何内容编写自己的 IQueryable 提供程序。您不会获得设计师支持或模型生成。据我所知，没有用于绑定 LINQ to SQL 模型生成的 gui 设计器模型。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-04T00:01:54.557

我想我并没有真正看到这里的问题。从您链接的文章中：

> 我们正在听取客户关于 LINQ to SQL 的意见，并将根据我们从社区收到的反馈继续改进产品。

我错过了什么吗？是什么让 LINQ to SQL 在到达时就死机了？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-01T22:33:55.233

Scott Guthrie 告诉我他们不会杀死 LINQ to SQL：

[在 LINQDev.com 上发布](http://www.linqdev.com/PublicPortal/publicportal/blog.aspx?EntryID=36)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-11-14T17:35:09.253

有人记得VB6吗？无论您个人厌恶还是喜欢它，微软都卖出了数百万份，企业花费了数百万美元编写了数百万行 VB6。接下来发生了什么？

*   好吧，微软仍然[支持 VB6](http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx)（有点——不是 IDE）。
*   微软[仍然说](http://channel9.msdn.com/posts/funkyonex/What-is-Microsofts-Visual-Basic-6-Support-Strategy/)他们现在（[9 月 9 日](http://channel9.msdn.com/posts/funkyonex/What-is-Microsofts-Visual-Basic-6-Support-Strategy/)）还在倾听 VB6 客户的意见。
*   但是 VB6 客户满意吗？[不是自 2002](http://classicvb.org/petition/)年以来，即 VB6 推出 4 年后。
*   为什么不？将您的代码投资升级到替代技术 VB.Net 的升级路径非常[昂贵](https://stackoverflow.com/questions/tagged/vb6-migration)。

因此，请考虑这一课。对我来说，LinqToSQL 支持似乎很勉强。他们[有义务](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/f5528b95-7dfa-491f-9139-db84b61795d7/)支持它，因为它在当前的 .NET 框架中。但它会出现在 .NET 5、6、7 中吗？想想这对你有多重要（据我所知，这对你来说根本不重要）。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-15T15:21:48.773

很明显，微软工具箱中的 2 个 ORM 是一对多的，但在我看来，由于所有错误的原因，选择了错误的框架。C# 团队完成了 ADO.NET 团队本应在更短的时间内完成的工作，并且做得更好，这一事实让 ado.net 团队难以接受。并不是说我知道这两个框架的内部工作原理，但我认为将 linq2sql 的缺点升级到实体框架会快得多。

似乎涉及太多政治，我认为这真的会损害 asp.net 的声誉，因为我不相信实体框架会给我们带来与 Linq2sql 一样的用户友好体验。ado.net 团队还可以从 asp.net mvc 团队学习一些沟通技巧，因为对问题的说明充其量是模糊的。

了解 Scott Gu 和他的 MVC 团队的立场会很有趣，因为他们的大多数示例都使用 Linq2Sql。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-31T12:35:36.033

另请参阅[http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx](http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx)和那里的评论

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-31T12:12:21.620

也许您不应该费心学习 Linq to SQL，但仍然有他们将保留的 Entities Linq。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-31T12:08:25.963

Linq 2 Sql 和实体框架总是有大面积的重叠，这总是有点奇怪。我认为 L2S 只进入 .NET 3.5 版本的唯一原因是，人们很怀疑 EF 是否会出现。现在 EF1 出来了，无论是一个非常粗糙的 v1，都不再需要 L2S。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-31T13:53:38.203

（不，StingyJack，LINQ to SQL 不使用实体框架）

反正我不会担心的。Tim 表示他们正在听取客户关于 LINQ to SQL 的意见。从我看到的对 L2S 的热情来看，客户（也就是我们）会说出他们的想法。

而且，正如 KristoferA 指出的那样，他们实际上不能“杀死” L2S，只能冻结它。而 L2S，一旦完善，实际上并不需要太多进一步的开发。有了 L2S 提供程序，LINQ 的任何进步都应该在 L2S 中可用。所以选择仍然是我们的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-05-14T22:46:15.800

Windows Phone 7 的下一个版本，代号 Mango，包括一个 SQL Server Compact Edition，可通过 Linq to SQL [http://jesseliberty.com/2011/05/10/coming-in-mangosql-server-ce/访问](http://jesseliberty.com/2011/05/10/coming-in-mangosql-server-ce/)

# .net - 为什么 DataGridView 上的 DoubleBuffered 属性默认为 false，为什么它受到保护？

> ID：252689
> 
> 赞同：16
> 
> 时间：2008-10-31T05:39:35.067
> 
> 标签：.net, winforms, datagridview, doublebuffered

我们遇到了 DataGridViews 的性能问题，其中重绘速度非常慢，并在[此处](https://stackoverflow.com/questions/118528/horrible-redraw-performance-of-the-datagridview-on-one-of-my-two-screens)找到了解决方案来创建派生类型并在控件上启用双缓冲。（派生类型是必需的，因为 DoubleBuffered 属性受到保护）

将 DoubleBuffered 属性设置为 true 似乎没有任何缺点。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-23T08:30:58.250

我认为它的最佳解决方案：

```
typeof(DataGridView).InvokeMember(
   "DoubleBuffered", 
   BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.SetProperty,
   null, 
   myDataGridViewObject, 
   new object[] { true }); 
```

在[这里找到](https://stackoverflow.com/questions/118528/horrible-redraw-performance-of-the-datagridview-on-one-of-my-two-screens)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-31T20:37:44.300

它受到保护是因为 DGV 继承了 Control 的属性。并且 Control.DoubleBuffered 受到保护。这是有道理的，因为每个派生控件都应该自己决定打开它。而且控制用户随意开启或关闭也没有任何意义。DGV 设计师决定离开。

他们可能决定这样做的一个原因是双缓冲实际上会使绘画变慢。渲染缓冲区位图的额外步骤需要时间。它只是在人眼看来更快，你观察到突然出现的位图。您看不到绘制位图所需的时间。除非需要绘制其他控件并且在 DGV 之后轮到它们，否则它是非常可见的。

您看到的是首先绘制的表单，控件所在的位置有孔。这些孔有白色背景。使用 TransparencyKey 或 Opacity 属性时为黑色。然后，每个控件都会获得 Paint 事件，并一个接一个地填充这些孔。这种效果也被用户感知为闪烁，尽管它与 DoubleBuffered 解决的闪烁不同。当背景为黑色时尤其明显。

解决这个问题需要的是整个表单及其所有控件都是双缓冲的。这在 Windows 窗体中不可用。但是，Windows XP 和更高版本实际上支持这一点。检查[这个线程](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/aaed00ce-4bc9-424e-8c05-c30213171c2c)，看看它是如何完成的。请注意，它可能会产生该线程中记录的副作用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T08:19:15.230

根据定义，双缓冲使用两个缓冲区和两倍的内存来渲染控件的视图。因此，那里有一些缺点，但是，由于您现在在 PC 中获得的内存量，可能没有多少人会注意到这种牺牲。

不知道为什么它受到保护。也许该功能在控件的早期版本中不可用，并且在引入它时设计人员不想更改控件的公共接口。或者他们认为这是一项高级功能，并希望限制新控制控件的方法的数量，以便能够使其做一些有用的事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-03T08:39:07.423

[在 datagridview 上打开双缓冲](http://bitmatic.com/csharp/fixing-a-slow-scrolling-datagridview)不需要继承。您可以通过反射现有的 datagridview 来做到这一点。

# emacs - 在 Emacs Lisp 中包装可变宽度文本

> ID：252691
> 
> 赞同：2
> 
> 时间：2008-10-31T05:41:14.267
> 
> 标签：emacs, elisp

我正在为 emacs 开发一个标记应用程序。我有一个标签云/加权列表成功显示在缓冲区上，但我遇到了障碍。我需要能够正确地对缓冲区进行自动换行，但我不知道从哪里开始。

我使用的字体是可变宽度字体。最重要的是，每个标签的大小都会不同，具体取决于它在缓冲区中出现的次数。最后，显示标签云的窗口可以在 200 像素宽或全屏宽度的窗口中。

我真的不知道从哪里开始。我在 tagcloud 缓冲区上尝试了 longlines 模式，但没有奏效。

源代码位于：[http ://emacswiki.org/cgi-bin/emacs/free-tagging.el](http://emacswiki.org/cgi-bin/emacs/free-tagging.el)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-01T01:15:06.907

您可能希望在将标签放入缓冲区时[`posn-at-point`](http://www.gnu.org/software/emacs/elisp/html_node/Accessing-Events.html#index-posn_002dat_002dpoint-1273)进行跟踪。[`posn-at-x-y`](http://www.gnu.org/software/emacs/elisp/html_node/Accessing-Events.html#index-posn_002dat_002dx_002dy-1274)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-01T19:50:13.910

你可以使用`(fill-paragraph)`或`(fill-region)`类似的吗？它们在一列处换行，因此没有可变宽度的字体智能，但如果填充列较低，它们可能几乎不费吹灰之力。至少在你得到一个像素完美的解决方案之前:-)（也许​​是 YAGNI ......）

# python - Python 的列表方法 append 和 extend 有什么区别？

> ID：252703
> 
> 赞同：3113
> 
> 时间：2008-10-31T05:55:36.407
> 
> 标签：python, list, data-structures, append, extend

`append()`列表方法和列表方法有什么区别`extend()`？

* * *

## 回答 #1

> 赞同：5673
> 
> 时间：2008-10-31T06:02:25.647

[`append`](https://docs.python.org/3/library/stdtypes.html#mutable-sequence-types)在末尾追加对象。

```
>>> x = [1, 2, 3]
>>> x.append([4, 5])
>>> print(x)
[1, 2, 3, [4, 5]] 
```

[`extend`](https://docs.python.org/3/library/stdtypes.html#mutable-sequence-types)通过附加来自可迭代的元素来扩展列表。

```
>>> x = [1, 2, 3]
>>> x.extend([4, 5])
>>> print(x)
[1, 2, 3, 4, 5] 
```

* * *

## 回答 #2

> 赞同：706
> 
> 时间：2008-10-31T05:57:37.260

`append`将一个元素添加到列表中，并将`extend`第一个列表与另一个列表（或另一个可迭代，不一定是列表）连接起来。

```
>>> li = ['a', 'b', 'mpilgrim', 'z', 'example']
>>> li
['a', 'b', 'mpilgrim', 'z', 'example']

>>> li.append("new")
>>> li
['a', 'b', 'mpilgrim', 'z', 'example', 'new']

>>> li.append(["new", 2])
>>> li
['a', 'b', 'mpilgrim', 'z', 'example', 'new', ['new', 2]]

>>> li.insert(2, "new")
>>> li
['a', 'b', 'new', 'mpilgrim', 'z', 'example', 'new', ['new', 2]]

>>> li.extend(["two", "elements"])
>>> li
['a', 'b', 'new', 'mpilgrim', 'z', 'example', 'new', ['new', 2], 'two', 'elements'] 
```

* * *

## 回答 #3

> 赞同：607
> 
> 时间：2015-01-23T22:44:37.993

> ## 列表方法追加和扩展有什么区别？

*   `append`将其参数作为单个元素添加到列表的末尾。列表本身的长度将增加一。
*   `extend`迭代其参数，将每个元素添加到列表中，扩展列表。无论可迭代参数中有多少元素，列表的长度都会增加。

## `append`

该`list.append`方法将一个对象附加到列表的末尾。

```
my_list.append(object) 
```

无论对象是什么，无论是数字、字符串、另一个列表还是其他东西，它都会`my_list`作为列表中的单个条目添加到末尾。

```
>>> my_list
['foo', 'bar']
>>> my_list.append('baz')
>>> my_list
['foo', 'bar', 'baz'] 
```

所以请记住，列表是一个对象。如果您将另一个列表附加到列表中，则第一个列表将是列表末尾的单个对象（这可能不是您想要的）：

```
>>> another_list = [1, 2, 3]
>>> my_list.append(another_list)
>>> my_list
['foo', 'bar', 'baz', [1, 2, 3]]
                     #^^^^^^^^^--- single item at the end of the list. 
```

## `extend`

该`list.extend`方法通过附加来自可迭代的元素来扩展列表：

```
my_list.extend(iterable) 
```

因此，通过扩展，可迭代的每个元素都被附加到列表中。例如：

```
>>> my_list
['foo', 'bar']
>>> another_list = [1, 2, 3]
>>> my_list.extend(another_list)
>>> my_list
['foo', 'bar', 1, 2, 3] 
```

请记住，字符串是可迭代的，因此如果您使用字符串扩展列表，您将在迭代字符串时附加每个字符（这可能不是您想要的）：

```
>>> my_list.extend('baz')
>>> my_list
['foo', 'bar', 1, 2, 3, 'b', 'a', 'z'] 
```

## 运算符重载，`__add__`( `+`) 和`__iadd__`( `+=`)

`+`和运算符都是`+=`为 定义的`list`。它们在语义上类似于扩展。

`my_list + another_list`在内存中创建第三个列表，因此您可以返回它的结果，但它要求第二个可迭代对象是一个列表。

`my_list += another_list`就地修改列表（它*是*就地运算符，列表是可变对象，正如我们所见），因此它不会创建新列表。它也像extend一样工作，因为第二个iterable可以是任何类型的iterable。

不要混淆 -`my_list = my_list + another_list`不等同于`+=`- 它为您提供分配给 my_list 的全新列表。

## 时间复杂度

Append 具有（[摊销](https://stackoverflow.com/a/33045038/541136)的）[恒定时间复杂度](https://wiki.python.org/moin/TimeComplexity)，O(1)。

Extend 具有时间复杂度 O(k)。

迭代多个调用`append`增加了复杂性，使其与extend 等效，并且由于extend 的迭代是在C 中实现的，因此如果您打算将可迭代的连续项附加到列表中，它总是会更快。

关于“摊销” - 来自[列表对象实现源](https://github.com/python/cpython/blob/3.9/Objects/listobject.c#L52)：

```
 /* This over-allocates proportional to the list size, making room
     * for additional growth.  The over-allocation is mild, but is
     * enough to give linear-time amortized behavior over a long
     * sequence of appends() in the presence of a poorly-performing
     * system realloc(). 
```

这意味着我们预先获得了大于需要的内存重新分配的好处，但我们可能会在下一次边际重新分配时付出更大的代价。所有追加的总时间在 O(n) 处是线性的，并且每个追加分配的时间变为 O(1)。

## 表现

您可能想知道什么更高效，因为 append 可用于实现与 extend 相同的结果。以下函数做同样的事情：

```
def append(alist, iterable):
    for item in iterable:
        alist.append(item)

def extend(alist, iterable):
    alist.extend(iterable) 
```

所以让我们给他们计时：

```
import timeit

>>> min(timeit.repeat(lambda: append([], "abcdefghijklmnopqrstuvwxyz")))
2.867846965789795
>>> min(timeit.repeat(lambda: extend([], "abcdefghijklmnopqrstuvwxyz")))
0.8060121536254883 
```

### 解决对时间的评论

一位评论者说：

> 完美的答案，我只是错过了比较只添加一个元素的时间

做语义上正确的事情。如果要将所有元素附加到可迭代对象中，请使用`extend`. 如果您只是添加一个元素，请使用`append`.

好的，让我们创建一个实验，看看它是如何及时完成的​​：

```
def append_one(a_list, element):
    a_list.append(element)

def extend_one(a_list, element):
    """creating a new list is semantically the most direct
    way to create an iterable to give to extend"""
    a_list.extend([element])

import timeit 
```

而且我们看到，为了使用扩展而特意创建一个可迭代的对象是（轻微的）时间浪费：

```
>>> min(timeit.repeat(lambda: append_one([], 0)))
0.2082819009956438
>>> min(timeit.repeat(lambda: extend_one([], 0)))
0.2397019260097295 
```

我们从中了解到，`extend`当我们只有*一个*要附加的元素时，使用没有任何好处。

此外，这些时间并不那么重要。我只是向他们表明，在 Python 中，做语义正确的事情就是用正确的方式做事*™*。

可以想象，您可能会在两个可比较的操作上测试时序并得到模棱两可或相反的结果。只专注于做语义上正确的事情。

## 结论

我们看到它在语义上更清晰，并且*当您打算将迭代中的每个元素附加到列表时*`extend`，它可以运行得更快。`append`

 *如果您只有一个元素（不在迭代中）要添加到列表中，请使用`append`.

* * *

## 回答 #4

> 赞同：132
> 
> 时间：2008-10-31T05:57:32.050

`append`附加一个元素。`extend`附加元素列表。

请注意，如果您传递一个列表来追加，它仍然会添加一个元素：

```
>>> a = [1, 2, 3]
>>> a.append([4, 5, 6])
>>> a
[1, 2, 3, [4, 5, 6]] 
```

* * *

## 回答 #5

> 赞同：85
> 
> 时间：2017-10-18T07:33:13.043

# 追加与扩展

## [![在此处输入图像描述](https://i.stack.imgur.com/KH5jB.png)](https://i.stack.imgur.com/KH5jB.png)

使用 append，您可以附加一个将扩展列表的元素：

```
>>> a = [1,2]
>>> a.append(3)
>>> a
[1,2,3] 
```

如果你想扩展多个元素，你应该使用extend，因为你只能附加一个元素或一个元素列表：

```
>>> a.append([4,5])
>>> a
>>> [1,2,3,[4,5]] 
```

这样你就得到一个嵌套列表

而不是使用extend，您可以像这样扩展单个元素

```
>>> a = [1,2]
>>> a.extend([3])
>>> a
[1,2,3] 
```

或者，与追加不同，一次扩展更多元素而不将列表嵌套到原始列表中（这就是名称扩展的原因）

```
>>> a.extend([4,5,6])
>>> a
[1,2,3,4,5,6] 
```

# 使用两种方法添加一个元素

## [![在此处输入图像描述](https://i.stack.imgur.com/lGF2k.png)](https://i.stack.imgur.com/lGF2k.png)

append 和 extend 都可以将一个元素添加到列表的末尾，尽管 append 更简单。

## 追加 1 个元素

```
>>> x = [1,2]
>>> x.append(3)
>>> x
[1,2,3] 
```

## 扩展一个元素

```
>>> x = [1,2]
>>> x.extend([3])
>>> x
[1,2,3] 
```

# 添加更多元素...具有不同的结果

如果您对多个元素使用 append，则必须将元素列表作为参数传递，您将获得一个 NESTED 列表！

```
>>> x = [1,2]
>>> x.append([3,4])
>>> x
[1,2,[3,4]] 
```

相反，使用extend，您将一个列表作为参数传递，但您将获得一个包含未嵌套在旧元素中的新元素的列表。

```
>>> z = [1,2] 
>>> z.extend([3,4])
>>> z
[1,2,3,4] 
```

因此，对于更多元素，您将使用 extend 来获取包含更多项目的列表。但是，追加列表不会向列表中添加更多元素，而是添加一个嵌套列表的元素，您可以在代码输出中清楚地看到。

[![在此处输入图像描述](https://i.stack.imgur.com/lJK1M.png)](https://i.stack.imgur.com/lJK1M.png)

[![在此处输入图像描述](https://i.stack.imgur.com/KC2Ji.png)](https://i.stack.imgur.com/KC2Ji.png)

* * *

## 回答 #6

> 赞同：66
> 
> 时间：2012-08-20T21:11:00.367

以下两个片段在语义上是等效的：

```
for item in iterator:
    a_list.append(item) 
```

和

```
a_list.extend(iterator) 
```

后者可能会更快，因为循环是用 C 实现的。

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2013-10-31T13:12:10.073

该`append()`方法将单个项目添加到列表的末尾。

```
x = [1, 2, 3]
x.append([4, 5])
x.append('abc')
print(x)
# gives you
[1, 2, 3, [4, 5], 'abc'] 
```

该`extend()`方法采用一个参数，一个列表，并将参数的每个项目附加到原始列表。（列表被实现为类。“创建”列表实际上是实例化一个类。因此，列表具有对其进行操作的方法。）

```
x = [1, 2, 3]
x.extend([4, 5])
x.extend('abc')
print(x)
# gives you
[1, 2, 3, 4, 5, 'a', 'b', 'c'] 
```

从*[潜入 Python](https://rads.stackoverflow.com/amzn/click/com/1430224150)*。

* * *

## 回答 #8

> 赞同：41
> 
> 时间：2013-08-26T11:21:12.290

您可以使用“+”返回扩展，而不是就地扩展。

```
l1=range(10)

l1+[11]

[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11]

l2=range(10,1,-1)

l1+l2

[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 9, 8, 7, 6, 5, 4, 3, 2] 
```

`+=`就地行为类似，但与`append`&略有不同`extend`。`+=`from`append`和from的最大区别之一`extend`是在函数作用域中使用时，请参阅[此博客文章](https://www.toptal.com/python/top-10-mistakes-that-python-programmers-make?utm_medium=referral&utm_source=zeef.com&utm_campaign=ZEEF)。

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2013-05-12T19:51:07.603

`append(object)`- 通过将对象添加到列表来更新列表。

```
x = [20]
# List passed to the append(object) method is treated as a single object.
x.append([21, 22, 23])
# Hence the resultant list length will be 2
print(x)
--> [20, [21, 22, 23]] 
```

`extend(list)`- 本质上连接两个列表。

```
x = [20]
# The parameter passed to extend(list) method is treated as a list.
# Eventually it is two lists being concatenated.
x.extend([21, 22, 23])
# Here the resultant list's length is 4
print(x)
[20, 21, 22, 23] 
```

* * *

## 回答 #10

> 赞同：23
> 
> 时间：2013-05-12T18:21:40.077

`extend()`可以与迭代器参数一起使用。这是一个例子。您希望以这种方式从列表列表中创建一个列表：

从

```
list2d = [[1,2,3],[4,5,6], [7], [8,9]] 
```

你要

```
>>>
[1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

你可以`itertools.chain.from_iterable()`这样做。该方法的输出是一个迭代器。它的实现等价于

```
def from_iterable(iterables):
    # chain.from_iterable(['ABC', 'DEF']) --> A B C D E F
    for it in iterables:
        for element in it:
            yield element 
```

回到我们的例子，我们可以做

```
import itertools
list2d = [[1,2,3],[4,5,6], [7], [8,9]]
merged = list(itertools.chain.from_iterable(list2d)) 
```

并获得通缉名单。

以下是如何等效`extend()`地与迭代器参数一起使用：

```
merged = []
merged.extend(itertools.chain.from_iterable(list2d))
print(merged)
>>>
[1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

* * *

## 回答 #11

> 赞同：22
> 
> 时间：2014-07-08T12:42:52.090

这等效于`append`并`extend`使用`+`运算符：

```
>>> x = [1,2,3]
>>> x
[1, 2, 3]
>>> x = x + [4,5,6] # Extend
>>> x
[1, 2, 3, 4, 5, 6]
>>> x = x + [[7,8]] # Append
>>> x
[1, 2, 3, 4, 5, 6, [7, 8]] 
```

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2016-06-13T10:17:46.413

***append()***：在 Python 中基本用于添加一个元素。

> 示例 1：

```
>> a = [1, 2, 3, 4]
>> a.append(5)
>> print(a)
>> a = [1, 2, 3, 4, 5] 
```

> 示例 2：

```
>> a = [1, 2, 3, 4]
>> a.append([5, 6])
>> print(a)
>> a = [1, 2, 3, 4, [5, 6]] 
```

***extend()***：其中extend()，用于合并两个列表或在一个列表中插入多个元素。

> 示例 1：

```
>> a = [1, 2, 3, 4]
>> b = [5, 6, 7, 8]
>> a.extend(b)
>> print(a)
>> a = [1, 2, 3, 4, 5, 6, 7, 8] 
```

> 示例 2：

```
>> a = [1, 2, 3, 4]
>> a.extend([5, 6])
>> print(a)
>> a = [1, 2, 3, 4, 5, 6] 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2014-08-05T16:58:25.037

已经暗示但未解释的一个有趣的点是extend 比append 快。对于任何内部有 append 的循环，都应该考虑用 list.extend(processed_elements) 替换。

请记住，追加新元素可能会导致整个列表重新分配到内存中更好的位置。如果因为我们一次添加 1 个元素而多次这样做，则整体性能会受到影响。从这个意义上说，list.extend 类似于 "".join(stringlist)。

* * *

## 回答 #14

> 赞同：14
> 
> 时间：2014-10-16T06:49:07.437

追加一次添加整个数据。整个数据将被添加到新创建的索引中。另一方面，`extend`顾名思义，扩展了当前数组。

例如

```
list1 = [123, 456, 678]
list2 = [111, 222] 
```

`append`我们得到：

```
result = [123, 456, 678, [111, 222]] 
```

在`extend`我们得到：

```
result = [123, 456, 678, 111, 222] 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2017-12-30T18:38:32.387

英文词典将单词`append`和定义`extend`为：

**append**：在书面文件的末尾添加（某些东西）。
**扩展**：变大。放大或扩大

* * *

有了这些知识，现在让我们了解

1)**和****之间的区别`append``extend`**

**`append`**：

*   *将任何 Python 对象按原样*附加到列表的末尾（即作为列表中的最后一个元素）。
*   结果列表可能是嵌套的并包含异构元素（即列表、字符串、元组、字典、集合等）

**`extend`**：

*   接受任何*可迭代*作为其参数并使列表*更大*。
*   结果列表始终是一维列表（即没有嵌套），并且它可能包含异构元素（例如字符、整数、浮点数）作为应用的结果`list(iterable)`。

2)**和之间的****相似性`append``extend`**

*   两者都只接受一个论点。
*   *两者都就地*修改列表。
*   结果，两者都返回`None`。

* * *

**例子**

```
lis = [1, 2, 3]

# 'extend' is equivalent to this
lis = lis + list(iterable)

# 'append' simply appends its argument as the last element to the list
# as long as the argument is a valid Python object
list.append(object) 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-02-11T01:59:02.070

我希望我可以对这个问题做一个有用的补充。如果您的列表存储了特定类型的对象，例如`Info`，这是一种`extend`方法不适合的情况：在`for`循环中并且`Info`每次生成一个对象并将`extend`其存储到您的列表中，它将失败。例外情况如下：

> TypeError：“信息”对象不可迭代

但是如果你使用该`append`方法，结果是可以的。因为每次使用该`extend`方法时，总会把它当作一个列表或任何其他集合类型，对其进行迭代，并将其放在上一个列表之后。很明显，一个特定的对象不能被迭代。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2017-12-04T10:17:53.783

直观地区分它们

```
l1 = ['a', 'b', 'c']
l2 = ['d', 'e', 'f']
l1.append(l2)
l1
['a', 'b', 'c', ['d', 'e', 'f']] 
```

这就像`l1`在她的身体内复制一个身体（嵌套）。

```
# Reset l1 = ['a', 'b', 'c']
l1.extend(l2)
l1
['a', 'b', 'c', 'd', 'e', 'f'] 
```

就像两个分开的人结婚并建立一个团结的家庭。

此外，我制作了所有列表方法的详尽备忘单供您参考。

```
list_methods = {'Add': {'extend', 'append', 'insert'},
                'Remove': {'pop', 'remove', 'clear'}
                'Sort': {'reverse', 'sort'},
                'Search': {'count', 'index'},
                'Copy': {'copy'},
                } 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-08-31T18:14:42.290

`extend(L)`通过附加给定列表中的所有项目来扩展列表`L`。

```
>>> a
[1, 2, 3]
a.extend([4])  #is eqivalent of a[len(a):] = [4]
>>> a
[1, 2, 3, 4]
a = [1, 2, 3]
>>> a
[1, 2, 3]
>>> a[len(a):] = [4]
>>> a
[1, 2, 3, 4] 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2018-03-31T18:46:17.600

`append`**仅通过一项**“扩展”列表（就地），即传递的单个对象（作为参数）。

`extend`通过传递的对象（作为参数）包含的**尽可能多的项目**“扩展”列表（就地） 。

`str`这对于对象来说可能会有些混乱。

1.  如果您将字符串作为参数传递： `append`将在末尾添加单个字符串项，但 `extend`将添加与该字符串长度一样多的“单个”“str”项。
2.  如果您将字符串列表作为参数传递： `append`仍然会在末尾添加一个“列表”项， `extend`并将添加与传递列表的长度一样多的“列表”项。

> ```
> def append_o(a_list, element):
>     a_list.append(element)
>     print('append:', end = ' ')
>     for item in a_list:
>         print(item, end = ',')
>     print()
> 
> def extend_o(a_list, element):
>     a_list.extend(element)
>     print('extend:', end = ' ')
>     for item in a_list:
>         print(item, end = ',')
>     print()
> append_o(['ab'],'cd')
> 
> extend_o(['ab'],'cd')
> append_o(['ab'],['cd', 'ef'])
> extend_o(['ab'],['cd', 'ef'])
> append_o(['ab'],['cd'])
> extend_o(['ab'],['cd']) 
> ```

产生：

```
append: ab,cd,
extend: ab,c,d,
append: ab,['cd', 'ef'],
extend: ab,cd,ef,
append: ab,['cd'],
extend: ab,cd, 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2018-07-17T07:19:35.720

追加和扩展是python中的可扩展机制之一。

追加：将一个元素添加到列表的末尾。

```
my_list = [1,2,3,4] 
```

要将新元素添加到列表中，我们可以通过以下方式使用 append 方法。

```
my_list.append(5) 
```

添加新元素的默认位置始终位于 (length+1) 位置。

插入：插入方法用于克服附加的限制。使用插入，我们可以明确定义我们希望插入新元素的确切位置。

insert(index, object) 的方法描述符。它有两个参数，第一个是我们要插入元素的索引，第二个是元素本身。

```
Example: my_list = [1,2,3,4]
my_list[4, 'a']
my_list
[1,2,3,4,'a'] 
```

扩展：当我们想要将两个或多个列表连接成一个列表时，这非常有用。如果没有扩展，如果我们想连接两个列表，结果对象将包含一个列表列表。

```
a = [1,2]
b = [3]
a.append(b)
print (a)
[1,2,[3]] 
```

如果我们尝试访问 pos 2 处的元素，我们会得到一个列表 ([3])，而不是元素。要加入两个列表，我们必须使用 append。

```
a = [1,2]
b = [3]
a.extend(b)
print (a)
[1,2,3] 
```

加入多个列表

```
a = [1]
b = [2]
c = [3]
a.extend(b+c)
print (a)
[1,2,3] 
```

# graphics - 如何制作Photoshop中风效果？

> ID：252709
> 
> 赞同：2
> 
> 时间：2008-10-31T06:00:21.873
> 
> 标签：graphics, 2d, effects

我正在寻找一种以编程方式重新创建以下效果的方法：

给出输入图像：
[输入 http://www.shiny.co.il/shooshx/ConeCarv/q_input.png](http://www.shiny.co.il/shooshx/ConeCarv/q_input.png)

我想迭代地应用“中风”效果。
第一步看起来像这样：
[第 1 步 http://www.shiny.co.il/shooshx/ConeCarv/q_step1.png](http://www.shiny.co.il/shooshx/ConeCarv/q_step1.png)

第二步是这样的：
[alt text http://www.shiny.co.il/shooshx/ConeCarv/q_step2.png](http://www.shiny.co.il/shooshx/ConeCarv/q_step2.png)

等等。

我认为这将涉及某种边缘检测，然后以某种方式跟踪边缘。
是否有一种已知的算法可以有效且稳健地执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T07:01:27.493

基本上，根据[此线程](http://newsgroups.cryer.info/comp/graphics.algorithms/200607/02/0607033847.html)，自定义算法将是：

> 取一个像素周围的 3x3 邻域，对 alpha 通道设置阈值，然后查看像素周围的 8 个像素中是否有任何一个与它有不同的 alpha 值。如果是这样，画一个以像素为中心的给定半径的圆。要在内部/外部进行，请通过阈值 Alpha 通道进行调制（否定以进行另一侧）。如果圆半径大于一个像素（它可能是），则必须对更大的邻域进行阈值处理。

* * *

> 这是使用灰度形态学操作实现的。这也是用于扩展/收缩选择的相同技术。基本上，要描画选区（或 Alpha 通道）的中心，首先要做的就是制作选区的两个单独副本。第一个选择会扩大笔画的半径，而第二个选择会收缩。然后将通过从第一个选择中减去第二个选择来获得笔划的不透明度。
> 
> 为了进行内部和外部笔划，您将收缩/扩展两倍的半径并减去与原始选择相交的部分。
> 
> 需要注意的是，最通用的形态学算法需要 O(m*n) 次操作，其中 m 是图像的像素数，n 是“结构元素”中的元素数。然而，对于某些特殊情况，这可以优化为 O(m) 操作（例如，如果结构元素是矩形或菱形）。

# asp.net-mvc - ASP.NET MVC：不确定如何制作这些路线

> ID：252729
> 
> 赞同：0
> 
> 时间：2008-10-31T06:15:36.400
> 
> 标签：asp.net-mvc, routes

我正在尝试制作以下路线.. 目前我正在以*很*长的方式解决这个问题.. 即。每个路由的一个路由实例。

这就是我所追求的......（假设我正在做一个'stackoverflow网站'）

```
/                        <-- root site
/page/{page}             <-- root site, but to the page of questions.
/tag/{tag}/page/{page}   <-- as above, but the questions are filtered by tag
/question/ask            <-- this page :P
/question/{subject}      <-- reading about a question 
```

（不……我绝对不是在做一个stackoverflow网站:)）

干杯！

（天哪，我有时觉得这一切都很混乱）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T21:58:02.497

对于你的第三个，我会做这样的事情：

```
routes.MapRoute("page-tag", "tag/{tag}/page/{page}", new {controller="question", action="FilterByTag"}); 
```

您的操作方法可能如下所示：

```
public class QuestionController : Controller {
  public ActionResult FilterByTag(string tag, int page) {
    //...
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T08:06:05.567

我会将最后一个 url 更改为 /question/view/{subject}。进一步创建 3 个控制器：

*   页面控制器
*   标签控制器
*   问题控制器

在 Global.asax 创建这些路由，（以默认路由为例）

希望这可以帮助。

# version-control - 如何从 CVS 获取自上次标记版本以来的提交评论列表？

> ID：252735
> 
> 赞同：17
> 
> 时间：2008-10-31T06:21:41.270
> 
> 标签：version-control, cvs

我对项目中的许多文件进行了大量更改。每个提交（通常在文件级别）都附有对更改内容的评论。

有没有办法从 CVS 中获取这些关于自上次标记版本以来更改的评论的列表？

如果我可以通过 eclipse CVS 插件来做到这一点，那就太好了。

**更新**：我很乐意在这里接受答案，但不幸的是，没有一个答案是我想要的。坦率地说，我认为这实际上是可能的，这真的很遗憾，因为这可能是在版本之间创建更改列表的好方法（假设所有提交都以合理的粒度进行并包含有意义的注释）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-02T19:21:03.237

我认为

```
cvs -q log -SN -rtag1:::tag2 
```

或者

```
 cvs -q log -SN -dfromdate<todate 
```

会做你想做的。这列出了在两个标签或日期之间所做的所有更改的所有版本和注释，仅适用于已更改的文件。在标记情况下，三个冒号排除了第一个标记的注释。有关更多信息，请参阅`cvs -H`日志。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T07:31:32.377

cvs log 命令的选项在[此处](http://www.cvsnt.org/manual/html/log.html)可用。具体来说，要获取自特定标签以来的所有提交（我们称之为 VERSION_1_0）

```
cvs log -rVERSION_1_0: 
```

如果您的目标是拥有一个无需知道最后一个标签的名称就可以工作的命令，我相信您将需要编写一个脚本来获取当前分支的日志，解析以找到标签，然后发出日志命令反对那个标签，但我很久以前就从 CVS 迁移了所有东西，所以我的记忆可能有点生疏。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T16:25:21.640

如果您想在单个文件上获得快速结果，该`cvs log`命令很好。如果你想要更全面的东西，我为此找到的最好的工具是一个名为[cvs2cl.pl](http://www.red-bean.com/cvs2cl/)的 perl 脚本。这可以生成几种不同格式的更改列表。它有许多不同的选项，但我使用了这样的标签到标签选项：

```
cvs2cl.pl --delta dev_release_1_2_3:dev_release_1_6_8 
```

或者

```
cvs2cl.pl --delta dev_release_1_2_3:HEAD 
```

我还使用相同的工具使用日期进行了比较。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-01-05T22:44:13.797

我知道你已经“解决”了你的问题，但我也遇到了同样的问题，下面是我如何快速从给定修订版到最新版本的 cvs 中获取所有评论：

```
$ mkdir ~/repo
$ cd ~/回购
$ mkdir 简历
$ cd 简历
$ scp -pr geek@avoid.cvs.org:/cvs/CVSROOT 。
$ mkdir -p 我的/最喜欢的
$ cd 我的/最喜欢的
$ scp -pr geek@avoid.cvs.org:/cvs/my/favorite/project 。
$ cd ~/回购
$ mkdir -p ~/repo/svn/my/favorite/project
$ cvs2svn -s ~/repo/svn/my/favorite/project/src ~/repo/cvs/my/favorite/project/src
$ mkdir ~/工作
$ cd ~/工作
$ svn checkout file:///home/geek/repo/svn/my/favorite/project/src/trunk ./src
$ 光盘源
$ # 获取从第 5 版到今天的评论
$ svn log -r 5:HEAD
$ # 获取从 2010-07-03 到今天的评论
$ svn log -r {2010-07-03}:HEAD
```

基本思想是只使用 svn 或 git 而不是 cvs :-) 这可以通过使用 cvs2svn 或 cvs2git 将 cvs 存储库转换为 svn 或 git 来完成，无论如何我们都应该这样做。它在大约三分钟内得到了我的答案，因为我有一个小存储库。

希望有帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-03-11T09:46:13.650

像这样的东西

```
cvs -q log -NS -rVERSION_3_0::HEAD 
```

您可能希望将输出通过管道传输到 egrep 以过滤掉您不想看到的内容。我用过这个：

```
cvs -q log -NS -rVERSION_3_0::HEAD | egrep -v "RCS file: |revision |date:|Working file:|head:|branch:|locks:|access list:|keyword substitution:|total revisions: |============|-------------" 
```

# c - 如何使用函数指针数组？

> ID：252748
> 
> 赞同：191
> 
> 时间：2008-10-31T06:45:54.527
> 
> 标签：c, initialization, function-pointers

我应该如何在 C 中使用函数指针数组？

我怎样才能初始化它们？

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2008-10-31T06:48:35.020

你在这里有一个很好的例子[（函数指针数组）](http://www.java2s.com/Code/C/Function/Arrayoffunctionpointer.htm)，[语法详细](http://www.newty.de/fpt/fpt.html#chapter2)。

```
int sum(int a, int b);
int subtract(int a, int b);
int mul(int a, int b);
int div(int a, int b);

int (*p[4]) (int x, int y);

int main(void)
{
  int result;
  int i, j, op;

  p[0] = sum; /* address of sum() */
  p[1] = subtract; /* address of subtract() */
  p[2] = mul; /* address of mul() */
  p[3] = div; /* address of div() */
[...] 
```

要调用这些函数指针之一：

```
result = (*p[op]) (i, j); // op being the index of one of the four functions 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-10-31T06:51:21.817

以上答案可能对您有所帮助，但您可能还想知道如何使用函数指针数组。

```
void fun1()
{

}

void fun2()
{

}

void fun3()
{

}

void (*func_ptr[3])() = {fun1, fun2, fun3};

main()
{
    int option;

    printf("\nEnter function number you want");
    printf("\nYou should not enter other than 0 , 1, 2"); /* because we have only 3 functions */
    scanf("%d",&option);

    if((option>=0)&&(option<=2))
    { 
        (*func_ptr[option])();
    }

    return 0;
} 
```

您只能将具有相同返回类型和相同参数类型且没有参数的函数的地址分配给单个函数指针数组。

如果上述所有函数具有相同数量的相同类型的参数，您也可以传递如下参数。

```
 (*func_ptr[option])(argu1); 
```

注意：在数组中，函数指针的编号将从 0 开始，与一般数组相同。所以在上面的例子`fun1`中，如果 option=0`fun2`可以调用，如果 option=1`fun3`可以调用，如果 option=2 可以调用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-22T11:07:27.047

以下是您可以使用它的方法：

### New_Fun.h

```
#ifndef NEW_FUN_H_
#define NEW_FUN_H_

#include <stdio.h>

typedef int speed;
speed fun(int x);

enum fp {
    f1, f2, f3, f4, f5
};

void F1();
void F2();
void F3();
void F4();
void F5();
#endif 
```

### New_Fun.c

```
#include "New_Fun.h"

speed fun(int x)
{
    int Vel;
    Vel = x;
    return Vel;
}

void F1()
{
    printf("From F1\n");
}

void F2()
{
    printf("From F2\n");
}

void F3()
{
    printf("From F3\n");
}

void F4()
{
    printf("From F4\n");
}

void F5()
{
    printf("From F5\n");
} 
```

### 主程序

```
#include <stdio.h>
#include "New_Fun.h"

int main()
{
    int (*F_P)(int y);
    void (*F_A[5])() = { F1, F2, F3, F4, F5 };    // if it is int the pointer incompatible is bound to happen
    int xyz, i;

    printf("Hello Function Pointer!\n");
    F_P = fun;
    xyz = F_P(5);
    printf("The Value is %d\n", xyz);
    //(*F_A[5]) = { F1, F2, F3, F4, F5 };
    for (i = 0; i < 5; i++)
    {
        F_A[i]();
    }
    printf("\n\n");
    F_A[f1]();
    F_A[f2]();
    F_A[f3]();
    F_A[f4]();
    return 0;
} 
```

我希望这有助于理解`Function Pointer.`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-05-28T05:04:33.003

这个“答案”更像是对 VonC 答案的补充；只是注意到可以通过 typedef 简化语法，并且可以使用聚合初始化：

```
typedef int FUNC(int, int);

FUNC sum, subtract, mul, div;
FUNC *p[4] = { sum, subtract, mul, div };

int main(void)
{
    int result;
    int i = 2, j = 3, op = 2;  // 2: mul

    result = p[op](i, j);   // = 6
}

// maybe even in another file
int sum(int a, int b) { return a+b; }
int subtract(int a, int b) { return a-b; }
int mul(int a, int b) { return a*b; }
int div(int a, int b) { return a/b; } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-03-02T22:45:49.870

这是一个更简单的示例：

**jump_table.c**

```
int func1(int arg)  { return arg + 1; }
int func2(int arg)  { return arg + 2; }
int func3(int arg)  { return arg + 3; }
int func4(int arg)  { return arg + 4; }
int func5(int arg)  { return arg + 5; }
int func6(int arg)  { return arg + 6; }
int func7(int arg)  { return arg + 7; }
int func8(int arg)  { return arg + 8; }
int func9(int arg)  { return arg + 9; }
int func10(int arg) { return arg + 10; }

int (*jump_table[10])(int) = { func1, func2, func3, func4, func5, 
                               func6, func7, func8, func9, func10 };

int main(void) {
  int index = 2;
  int argument = 42;
  int result = (*jump_table[index])(argument);
  // result is 45
} 
```

存储在数组中的所有函数必须具有相同的签名。这仅仅意味着它们必须返回相同的类型（例如`int`）并具有相同的参数（在上面的示例中为单个参数`int`）。

* * *

在 C++ 中，您可以对*静态*类方法（但不是实例方法）执行相同操作。例如，您可以`MyClass::myStaticMethod`在上面的数组中使用，但不能使用`MyClass::myInstanceMethod`nor `instance.myInstanceMethod`：

```
class MyClass {
public:
  static int myStaticMethod(int foo)   { return foo + 17; }
  int        myInstanceMethod(int bar) { return bar + 17; }
}

MyClass instance; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-31T06:54:48.753

哦，有很多例子。看看 glib 或 gtk 中的任何内容。您可以一路看到函数指针在工作中的工作。

这里例如初始化 gtk_button 的东西。

```
 static void
gtk_button_class_init (GtkButtonClass *klass)
{
  GObjectClass *gobject_class;
  GtkObjectClass *object_class;
  GtkWidgetClass *widget_class;
  GtkContainerClass *container_class;

  gobject_class = G_OBJECT_CLASS (klass);
  object_class = (GtkObjectClass*) klass;
  widget_class = (GtkWidgetClass*) klass;
  container_class = (GtkContainerClass*) klass;

  gobject_class->constructor = gtk_button_constructor;
  gobject_class->set_property = gtk_button_set_property;
  gobject_class->get_property = gtk_button_get_property; 
```

在 gtkobject.h 中，您可以找到以下声明：

```
 struct _GtkObjectClass
{
  GInitiallyUnownedClass parent_class;

  /* Non overridable class methods to set and get per class arguments */
  void (*set_arg) (GtkObject *object,
           GtkArg    *arg,
           guint      arg_id);
  void (*get_arg) (GtkObject *object,
           GtkArg    *arg,
           guint      arg_id);

  /* Default signal handler for the ::destroy signal, which is
   *  invoked to request that references to the widget be dropped.
   *  If an object class overrides destroy() in order to perform class
   *  specific destruction then it must still invoke its superclass'
   *  implementation of the method after it is finished with its
   *  own cleanup. (See gtk_widget_real_destroy() for an example of
   *  how to do this).
   */
  void (*destroy)  (GtkObject *object);
}; 
```

(*set_arg) 东西是一个指向函数的指针，例如可以在某个派生类中为其分配另一个实现。

经常看到这样的东西

```
struct function_table {
   char *name;
   void (*some_fun)(int arg1, double arg2);
};

void function1(int  arg1, double arg2)....

struct function_table my_table [] = {
    {"function1", function1},
... 
```

因此，您可以按名称访问表并调用“关联”函数。

或者，也许您使用一个哈希表，在其中放置函数并“按名称”调用它。

问候
弗里德里希

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-06-03T08:36:27.373

可以这样使用它：

```
//! Define:
#define F_NUM 3
int (*pFunctions[F_NUM])(void * arg);

//! Initialise:
int someFunction(void * arg) {
    int a= *((int*)arg);
    return a*a;
}

pFunctions[0]= someFunction;

//! Use:
int someMethod(int idx, void * arg, int * result) {
    int done= 0;
    if (idx < F_NUM && pFunctions[idx] != NULL) {
        *result= pFunctions[idx](arg);
        done= 1;
    }
    return done;
}

int x= 2;
int z= 0;
someMethod(0, (void*)&x, &z);
assert(z == 4); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-06T15:00:55.167

最简单的解决方案是给出你想要的最终向量的地址，并在函数内部对其进行修改。

```
void calculation(double result[] ){  //do the calculation on result

   result[0] = 10+5;
   result[1] = 10 +6;
   .....
}

int main(){

    double result[10] = {0}; //this is the vector of the results

    calculation(result);  //this will modify result
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-28T14:43:07.963

这应该是上述响应的简短复制和粘贴代码示例。希望这会有所帮助。

```
#include <iostream>
using namespace std;

#define DBG_PRINT(x) do { std::printf("Line:%-4d" "  %15s = %-10d\n", __LINE__, #x, x); } while(0);

void F0(){ printf("Print F%d\n", 0); }
void F1(){ printf("Print F%d\n", 1); }
void F2(){ printf("Print F%d\n", 2); }
void F3(){ printf("Print F%d\n", 3); }
void F4(){ printf("Print F%d\n", 4); }
void (*fArrVoid[N_FUNC])() = {F0, F1, F2, F3, F4};

int Sum(int a, int b){ return(a+b); }
int Sub(int a, int b){ return(a-b); }
int Mul(int a, int b){ return(a*b); }
int Div(int a, int b){ return(a/b); }
int (*fArrArgs[4])(int a, int b) = {Sum, Sub, Mul, Div};

int main(){
    for(int i = 0; i < 5; i++)  (*fArrVoid[i])();
    printf("\n");

    DBG_PRINT((*fArrArgs[0])(3,2))
    DBG_PRINT((*fArrArgs[1])(3,2))
    DBG_PRINT((*fArrArgs[2])(3,2))
    DBG_PRINT((*fArrArgs[3])(3,2))

    return(0);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-31T18:22:46.187

这个问题已经用很好的例子回答了。唯一可能缺少的示例是函数返回指针的示例。我用这个写了另一个例子，并添加了很多评论，以防有人觉得它有帮助：

```
#include <stdio.h>

char * func1(char *a) {
    *a = 'b';
    return a;
}

char * func2(char *a) {
    *a = 'c';
    return a;
}

int main() {
    char a = 'a';
    /* declare array of function pointers
     * the function pointer types are char * name(char *)
     * A pointer to this type of function would be just
     * put * before name, and parenthesis around *name:
     *   char * (*name)(char *)
     * An array of these pointers is the same with [x]
     */
    char * (*functions[2])(char *) = {func1, func2};
    printf("%c, ", a);
    /* the functions return a pointer, so I need to deference pointer
     * Thats why the * in front of the parenthesis (in case it confused you)
     */
    printf("%c, ", *(*functions[0])(&a)); 
    printf("%c\n", *(*functions[1])(&a));

    a = 'a';
    /* creating 'name' for a function pointer type
     * funcp is equivalent to type char *(*funcname)(char *)
     */
    typedef char *(*funcp)(char *);
    /* Now the declaration of the array of function pointers
     * becomes easier
     */
    funcp functions2[2] = {func1, func2};

    printf("%c, ", a);
    printf("%c, ", *(*functions2[0])(&a));
    printf("%c\n", *(*functions2[1])(&a));

    return 0;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-12-29T07:11:13.990

这个带有函数指针的多维数组的简单示例”：

```
void one( int a, int b){    printf(" \n[ ONE ]  a =  %d   b = %d",a,b);}
void two( int a, int b){    printf(" \n[ TWO ]  a =  %d   b = %d",a,b);}
void three( int a, int b){    printf("\n [ THREE ]  a =  %d   b = %d",a,b);}
void four( int a, int b){    printf(" \n[ FOUR ]  a =  %d   b = %d",a,b);}
void five( int a, int b){    printf(" \n [ FIVE ]  a =  %d   b = %d",a,b);}
void(*p[2][2])(int,int)   ;
int main()
{
    int i,j;
    printf("multidimensional array with function pointers\n");

    p[0][0] = one;    p[0][1] = two;    p[1][0] = three;    p[1][1] = four;
    for (  i  = 1 ; i >=0; i--)
        for (  j  = 0 ; j <2; j++)
            (*p[i][j])( (i, i*j);
    return 0;
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-07-08T10:45:44.893

```
#include <iostream>
using namespace std;

int sum (int , int);
int prod (int , int);

int main()
{
    int (*p[2])(int , int ) = {sum,prod};

    cout << (*p[0])(2,3) << endl;
    cout << (*p[1])(2,3) << endl;
}

int sum (int a , int b)
{
    return a+b;
}

int prod (int a, int b)
{
    return a*b;
} 
```

# vim - 如何将行号添加到 Vim 中的行范围？

> ID：252766
> 
> 赞同：71
> 
> 时间：2008-10-31T07:05:16.767
> 
> 标签：vim, line-numbers

如何将行号添加到在 Vim 中打开的文件中的一系列行中？不像`:set nu`- 这只是*显示*行号 - 但实际上将它们添加到文件中的每一行？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-10-31T10:18:40.870

和

```
:%s/^/\=line('.')/ 
```

编辑：总结评论。

可以根据需要调整此命令。

* * *

假设您想在视觉选择 ( `V`+ move) 的行前添加数字，并且您希望编号从 42 开始。

```
:'<,'>s/^/\=(line('.')-line("'<")+42)/ 
```

* * *

如果你想在数字和行中的旧文本之间添加一个字符串，只需将它连接（`.`在 VimL 中）到数字表达式：

```
:'<,'>s/^/\=(line('.')-line("'<")+42).' --> '/ 
```

* * *

如果您需要将其作为文本排序，您可能希望对结果进行零填充，这可以使用`printf`for `0001, 0002`... 而不是`1, 2`... 例如：

```
:%s/^/\=printf('%04d', line('.'))/ 
```

* * *

无论如何，如果您想了解更多信息，只需打开 vim 帮助：`:h :s`并点击链接 ( `|subreplace-special|`, ..., `|submatch()|`)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-31T07:10:03.340

`cat -n`将行号添加到其输入。您可以将当前文件通过管道传输到`cat -n`并将当前缓冲区替换为打印到标准输出的内容。幸运的是，这个复杂的解决方案在 vim 中少于 10 个字符：

```
 :%!cat -n 
```

或者，如果您只想要一个子选择，直观地选择该区域，然后键入：

```
 :!cat -n 
```

这将自动放入视觉选择标记，并在您输入后看起来像这样：

```
 :'<,'>!cat -n 
```

为了删除行号，我建议使用`control-v`，这将允许您直观地选择一个矩形，然后您可以使用 删除该矩形`x`。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-31T07:12:59.763

在 GNU 系统上：使用外部`nl`二进制文件：

```
:%!nl 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-31T07:12:07.407

在类 Unix 环境下，您可以使用 cat 或 awk 轻松生成行号，因为 vim 与 shell 具有友好的接口，所以一切在 vim 中都可以像在 shell 中一样工作。
来自[Vim Tip28](http://neuron.tuke.sk/~hudecm/VimTips-OFFLINE-nov02.txt)：

```
:%!cat -n 
```

或者

```
:%!awk '{print NR,$0}' 
```

但是，如果你在 MS-DOS、win9x、win2000 中使用 vim，你会丢失这些工具包。这是仅通过 vim 归档的一种非常简单的方法：

```
fu! LineIt()
  exe ":s/^/".line(".")."/"
endf 
```

或者，由字母组成的序列就像上面一样简单：

```
exe "s/^/".nr2char(line("."))."/" 
```

您还可以使用 subst：

```
:g/^/exe ":s/^/".line(".")."^I/" 
```

* * *

您也可以只打印这些行而不将它们添加到文件中：

> “有时它可能很有用，特别是在编辑大型源文件以在纸上打印行号。
> 为此，您可以使用`:set printoptions=number:y`激活和`:set printoptions=number:n`停用此功能的选项。
> 如果应始终打印行号，请将行`set printoptions=number:y`放入的`vimrc`。”

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-01-12T22:10:05.457

首先，如果需要，您可以删除现有的行号：

```
:%s/^[0-9]*// 
```

然后，您可以添加行号。`NR`指从一开始的当前行号，因此您可以对其进行一些数学运算以获得所需的编号。以下命令为您提供四位数的行号：

```
:%!awk '{print 1000+NR*10,$0}' 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-02T00:09:35.027

“ [VisIncr”](http://www.vim.org/scripts/script.php?script_id=670)插件非常适合插入一般递增的数字列（或字母、日期、罗马数字等）。您可以控制数字格式、填充等。因此，在每一行前面插入一个“1”（通过`:s`或`:g`或视觉块插入），在视觉块模式下突出显示该列，然后运行插件中的命令之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-08T10:25:33.170

如果有人想在使用[这个出色的答案](https://stackoverflow.com/a/253041/2956066)插入行号后放置一个制表符（或一些空格） ，这是一种方法。进入逃生模式后，执行：

```
:%s/^/\=line('.').'    '/ 
```

`^`表示行首，`%s`是替换指令。因此，我们说在每行的开头放置一个行号并添加 4 个空格，然后在替换之前放置该行的任何内容，并对文件中的所有行执行此操作。

这将自动替换它。或者，如果您希望命令要求您确认，请执行以下操作：

```
:%s/^/\=line('.').'    '/igc 
```

PS：**vim**的力量 :)

# java - 高级Java泛型问题：为什么我们需要指定冗余信息

> ID：252775
> 
> 赞同：0
> 
> 时间：2008-10-31T07:12:40.387
> 
> 标签：java, generics, dao

我的 JPA 模型 POJO 有一些通用类，如下所示：

```
public interface Identifiable<PK extends Serializable> {
    PK getUniqueId();
}

public interface GenericDao<T extends Identifiable<PK>> {
    public T findById(PK id);
} 
```

此代码不会编译。为此，我需要指定

```
public interface GenericDao<T extends Identifiable<PK>, PK extends Serializable> 
```

但那是多余的信息！T 扩展 Identifiable 的事实意味着将为 Identifiable 实例指定一个 PK 类型，并且这是用于 DAO 的 PK 的类型。

我怎样才能在没有多余信息的情况下完成这项工作？

谢谢，弗雷德

* * *

**编辑：**简化示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T07:20:30.043

你有没有尝试过：

```
public interface WatchableDao<T extends Watchable<?>> 
```

（即它是一个`Watchable<Something>`但我不在乎是什么`Something`）

我没试过，但值得一试。

编辑：发布问题编辑，看来您确实需要 PK 作为接口的类型参数。在这种情况下，我相信你必须像你一样有效地重复约束。是的，它是多余的，但我认为它比语言更简单，因为它必须根据它在其他地方用作类型参数来指定适用于 PK 的*有效约束。*如果有什么安慰的话，在 C# 中也是如此。

它还使 PK 的限制仅从接口本身就清楚了，而不必查看另一个接口来查看可行的方法。

# c - 为什么我们要在 C 中如此频繁地对结构进行 typedef 呢？

> ID：252780
> 
> 赞同：496
> 
> 时间：2008-10-31T07:14:03.240
> 
> 标签：c, struct, typedef

我见过许多由如下结构组成的程序

```
typedef struct 
{
    int i;
    char k;
} elem;

elem user; 
```

为什么经常需要它？有什么具体原因或适用范围吗？

* * *

## 回答 #1

> 赞同：532
> 
> 时间：2008-10-31T07:37:05.737

正如 Greg Hewgill 所说，typedef 意味着您不再需要到处写`struct`。这不仅节省了击键，还可以使代码更清晰，因为它提供了更多的抽象。

像这样的东西

```
typedef struct {
  int x, y;
} Point;

Point point_new(int x, int y)
{
  Point a;
  a.x = x;
  a.y = y;
  return a;
} 
```

当您不需要到处看到“struct”关键字时，它会变得更清晰，它看起来更像是在您的语言中确实存在一种称为“Point”的类型。在 之后`typedef`，我猜就是这种情况。

另请注意，虽然您的示例（和我的示例）省略了命名`struct` 本身，但实际上命名它对于您想要提供不透明类型时也很有用。然后你会在标题中有这样的代码，例如：

```
typedef struct Point Point;

Point * point_new(int x, int y); 
```

然后`struct`在实现文件中提供定义：

```
struct Point
{
  int x, y;
};

Point * point_new(int x, int y)
{
  Point *p;
  if((p = malloc(sizeof *p)) != NULL)
  {
    p->x = x;
    p->y = y;
  }
  return p;
} 
```

在后一种情况下，您不能按值返回 Point，因为它的定义对头文件的用户是隐藏的。[例如，这是一种在GTK+](http://www.gtk.org/)中广泛使用的技术。

**更新**请注意，还有一些备受推崇的 C 项目，其中使用`typedef`隐藏`struct`被认为是一个坏主意，Linux 内核可能是最知名的此类项目。[请参阅Linux Kernel CodingStyle 文档](https://www.kernel.org/doc/html/latest/process/coding-style.html#typedefs)的第 5 章了解 Linus 的愤怒言论。:) 我的观点是，问题中的“应该”毕竟可能不是一成不变的。

* * *

## 回答 #2

> 赞同：232
> 
> 时间：2010-12-30T21:20:44.927

令人惊讶的是有多少人犯了这个错误。请不要在 C 中 typedef 结构，它会不必要地污染全局命名空间，这通常在大型 C 程序中已经被严重污染。

此外，没有标签名称的 typedef 结构是不必要地在头文件之间强加排序关系的主要原因。

考虑：

```
#ifndef FOO_H
#define FOO_H 1

#define FOO_DEF (0xDEADBABE)

struct bar; /* forward declaration, defined in bar.h*/

struct foo {
  struct bar *bar;
};

#endif 
```

有了这样的定义，不使用 typedef，编译单元可以包含 foo.h 来获得`FOO_DEF`定义。如果它不尝试取消引用`foo`结构的“bar”成员，则不需要包含“bar.h”文件。

此外，由于标签名称和成员名称之间的名称空间不同，因此可以编写非常易读的代码，例如：

```
struct foo *foo;

printf("foo->bar = %p", foo->bar); 
```

由于命名空间是独立的，因此在命名变量与其结构标记名称一致时不会发生冲突。

如果我必须维护您的代码，我将删除您的 typedef 结构。

* * *

## 回答 #3

> 赞同：151
> 
> 时间：2008-10-31T17:12:55.430

摘自 Dan Saks 的一篇旧文章 ( [http://www.ddj.com/cpp/184403396?pgno=3](http://www.ddj.com/cpp/184403396?pgno=3) )：

* * *

> 命名结构的 C 语言规则有点古怪，但它们是无害的。然而，当扩展到 C++ 中的类时，这些相同的规则打开了一些小裂缝，让 bug 爬过。
> 
> 在 C 中，名字 s 出现在
> 
> ```
> struct s
>     {
>     ...
>     }; 
> ```
> 
> 是一个标签。标签名称不是类型名称。鉴于上面的定义，声明如
> 
> ```
> s x;    /* error in C */
> s *p;   /* error in C */ 
> ```
> 
> 是 C 中的错误。您必须将它们写为
> 
> ```
> struct s x;     /* OK */
> struct s *p;    /* OK */ 
> ```
> 
> 联合和枚举的名称也是标签而不是类型。
> 
> 在 C 中，标签不同于所有其他名称（对于函数、类型、变量和枚举常量）。C 编译器在符号表中维护标记，该符号表在概念上与包含所有其他名称的表在物理上是分开的。因此，C 程序有可能在同一范围内同时拥有一个标记和另一个拼写相同的名称。例如，
> 
> ```
> struct s s; 
> ```
> 
> 是一个有效的声明，它声明了 struct s 类型的变量 s。这可能不是好的做法，但 C 编译器必须接受它。我从来没有看到为什么 C 是这样设计的理由。我一直认为这是一个错误，但它就在那里。
> 
> 许多程序员（包括你的程序员）更喜欢将结构名称视为类型名称，因此他们使用 typedef 为标签定义别名。例如，定义
> 
> ```
> struct s
>     {
>     ...
>     };
> typedef struct s S; 
> ```
> 
> 允许您使用 S 代替 struct s，如
> 
> ```
> S x;
> S *p; 
> ```
> 
> 程序不能同时使用 S 作为类型和变量（或函数或枚举常量）的名称：
> 
> ```
> S S;    // error 
> ```
> 
> 这很好。
> 
> 结构、联合或枚举定义中的标记名称是可选的。许多程序员将 struct 定义折叠到 typedef 中并完全省去标记，如下所示：
> 
> ```
> typedef struct
>     {
>     ...
>     } S; 
> ```

* * *

链接的文章还讨论了不需要 a 的 C++ 行为如何`typedef`导致微妙的名称隐藏问题。为了防止这些问题，对 C++ 中的类和结构也是一个好主意`typedef`，尽管乍一看它似乎是不必要的。在 C++ 中，`typedef`名称隐藏成为编译器告诉您的错误，而不是潜在问题的隐藏来源。

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2008-10-31T07:16:58.380

使用 a`typedef`可以避免`struct`每次声明该类型的变量时都必须编写：

```
struct elem
{
 int i;
 char k;
};
elem user; // compile error!
struct elem user; // this is correct 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2009-03-31T00:00:32.773

总是 typedef 枚举和结构的另一个很好的理由是由这个问题引起的：

```
enum EnumDef
{
  FIRST_ITEM,
  SECOND_ITEM
};

struct StructDef
{
  enum EnuumDef MyEnum;
  unsigned int MyVar;
} MyStruct; 
```

注意到 struct (Enu **u** mDef) 中 EnumDef 的错字了吗？这编译没有错误（或警告）并且（取决于 C 标准的字面解释）是正确的。问题是我刚刚在我的结构中创建了一个新的（空）枚举定义。我没有（按预期）使用前面的定义 EnumDef。

使用 typdef 类似的拼写错误会导致使用未知类型的编译器错误：

```
typedef 
{
  FIRST_ITEM,
  SECOND_ITEM
} EnumDef;

typedef struct
{
  EnuumDef MyEnum; /* compiler error (unknown type) */
  unsigned int MyVar;
} StructDef;
StrructDef MyStruct; /* compiler error (unknown type) */ 
```

我会提倡 ALWAYS typedef'ing 结构和枚举。

不仅是为了节省一些打字（不是双关语;）），而且因为它更安全。

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2013-08-07T14:19:02.913

[Linux 内核编码风格](https://www.kernel.org/doc/Documentation/process/coding-style.rst)第 5 章给出了使用`typedef`.

> 请不要使用“vps_t”之类的东西。
> 
> 将 typedef 用于结构和指针是*错误的。*当你看到一个
> 
> ```
> vps_t a; 
> ```
> 
> 在源代码中，它是什么意思？
> 
> 相反，如果它说
> 
> ```
> struct virtual_container *a; 
> ```
> 
> 您实际上可以说出“a”是什么。
> 
> 很多人认为 typedef“有助于提高可读性”。不是这样。它们仅用于：
> 
> (a) 完全不透明的对象（其中 typedef 被积极地用来*隐藏*对象是什么）。
> 
> 示例：“pte_t”等不透明对象，您只能使用正确的访问器函数访问。
> 
> 笔记！不透明性和“访问器功能”本身并不好。我们将它们用于 pte_t 等的原因是那里确实有绝对*为零*的可移植访问信息。
> 
> (b) 清晰的整数类型，其中抽象*有助于*避免混淆它是“int”还是“long”。
> 
> u8/u16/u32 是非常好的类型定义，尽管它们比这里更适合 (d) 类。
> 
> 笔记！再次 - 需要有一个*理由*。如果某事是“无符号长”，那么就没有理由这样做
> 
> ```
> typedef unsigned long myflags_t; 
> ```
> 
> 但是，如果有明确的理由说明它在某些情况下可能是“unsigned int”，而在其他配置下可能是“unsigned long”，那么一定要继续使用 typedef。
> 
> (c) 当您使用 sparse 从字面上创建一个*新*类型进行类型检查时。
> 
> (d) 在某些特殊情况下与标准 C99 类型相同的新类型。
> 
> 尽管眼睛和大脑只需要很短的时间就可以习惯像“uint32_t”这样的标准类型，但还是有人反对使用它们。
> 
> 因此，允许使用特定于 Linux 的“u8/u16/u32/u64”类型及其与标准类型相同的签名等价物——尽管它们在您自己的新代码中不是强制性的。
> 
> 在编辑已经使用一个或另一组类型的现有代码时，您应该遵守该代码中的现有选择。
> 
> (e) 在用户空间中安全使用的类型。
> 
> 在某些对用户空间可见的结构中，我们不能要求 C99 类型，也不能使用上面的 'u32' 形式。因此，我们在与用户空间共享的所有结构中使用 __u32 和类似类型。
> 
> 也许还有其他情况，但是规则基本上应该是永远不要使用 typedef，除非您可以清楚地匹配其中一个规则。
> 
> 通常，具有可以合理直接访问的元素的指针或结构*不*应该是 typedef。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-08-11T15:48:27.143

事实证明，有利有弊。一个有用的信息来源是开创性的书“Expert C Programming”（[第 3 章](http://www.e-reading-lib.com/bookreader.php/138815/Expert_C_Programming:_Deep_C_Secrets.pdf)）。简而言之，在 C 中，您有多个名称空间：**标签、类型、成员名称和标识符**。`typedef`为类型引入别名并将其定位在标签命名空间中。即，

```
typedef struct Tag{
...members...
}Type; 
```

定义了两件事。标签命名空间中的一个 Tag 和类型命名空间中的一个 Type。所以你可以同时做`Type myType`和`struct Tag myTagType`。声明喜欢`struct Type myType`or`Tag myTagType`是非法的。此外，在这样的声明中：

```
typedef Type *Type_ptr; 
```

我们定义了一个指向我们的类型的指针。所以如果我们声明：

```
Type_ptr var1, var2;
struct Tag *myTagType1, myTagType2; 
```

then`var1`和是指向 Type 但不是`var2`的指针。`myTagType1``myTagType2`

在上面提到的书中，它提到 typedefing structs 不是很有用，因为它只是使程序员免于编写单词 struct 。但是，我有一个反对意见，就像许多其他 C 程序员一样。尽管当您想在 C 中实现多态性时，它有时会混淆某些名称（这就是为什么不建议在像内核这样的大型代码库中使用它），但在[这里查看详细信息会很有帮助](http://modal-echoes.blogspot.com/2007/03/implementing-polymorphism-in-c.html)。例子：

```
typedef struct MyWriter_t{
    MyPipe super;
    MyQueue relative;
    uint32_t flags;
...
}MyWriter; 
```

你可以做：

```
void my_writer_func(MyPipe *s)
{
    MyWriter *self = (MyWriter *) s;
    uint32_t myFlags = self->flags;
...
} 
```

`flags`因此，您可以通过强制转换通过内部结构 ( )访问外部成员 ( ) `MyPipe`。对我来说，转换整个类型比`(struct MyWriter_ *) s;`每次想要执行此类功能时都更容易混淆。在这些情况下，简短的引用很重要，尤其是当您在代码中大量使用该技术时。

最后，与宏相比，ed 类型的最后一个方面`typedef`是无法扩展它们。例如，如果您有：

```
#define X char[10] or
typedef char Y[10] 
```

然后你可以声明

```
unsigned X x; but not
unsigned Y y; 
```

我们并不真正关心结构体的这一点，因为它不适用于存储说明符（`volatile`和`const`）。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2010-05-29T07:12:11.727

我认为 typedef 甚至不可能进行前向声明。当依赖项（知道）是双向的时，使用 struct、enum 和 union 允许转发声明。

风格：在 C++ 中使用 typedef 很有意义。在处理需要多个和/或可变参数的模板时，它几乎是必要的。typedef 有助于保持命名的正确性。

在 C 编程语言中并非如此。typedef 的使用通常没有任何目的，只是混淆了数据结构的使用。由于只有 { struct (6), enum (4), union (5) } 次击键用于声明数据类型，因此几乎没有使用结构的别名。该数据类型是联合还是结构？使用简单的非类型定义声明可以让您立即知道它是什么类型。

请注意，Linux 是如何在严格避免 typedef 带来的这种别名胡说八道的情况下编写的。结果是简约和干净的风格。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2018-03-09T18:16:39.807

让我们从基础开始，逐步向上。

这是结构定义的示例：

```
struct point
  {
    int x, y;
  }; 
```

这里的名字`point`是可选的。

结构可以在其定义期间或之后声明。

在定义期间声明

```
struct point
  {
    int x, y;
  } first_point, second_point; 
```

定义后声明

```
struct point
  {
    int x, y;
  };
struct point first_point, second_point; 
```

现在，请仔细注意上面的最后一种情况；`struct point`如果您决定稍后在代码中创建该类型，则需要编写来声明该类型的结构。

输入`typedef`。如果您打算稍后在您的程序中使用相同的蓝图创建新的结构（结构是一种自定义数据类型），那么`typedef`在其定义期间使用可能是一个好主意，因为您可以节省一些未来的输入。

```
typedef struct point
  {
    int x, y;
  } Points;

Points first_point, second_point; 
```

# 命名自定义类型时要注意

没有什么可以阻止您在自定义类型名称的末尾使用 _t 后缀，但 POSIX 标准保留使用后缀 _t 来表示标准库类型名称。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-31T08:24:40.007

您（可选地）为结构命名的名称称为*标记名称*，并且如前所述，它本身不是类型。要获取类型需要结构前缀。

除了 GTK+，我不确定标记名是否像结构类型的 typedef 一样普遍使用，因此在 C++ 中可以识别，您可以省略 struct 关键字并将标记名也用作类型名称：

```
 struct MyStruct
    {
      int i;
    };

    // The following is legal in C++:
    MyStruct obj;
    obj.i = 7; 

```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-01-30T15:47:18.497

typedef 不会提供一组相互依赖的数据结构。这是你不能用 typdef 做的：

```
struct bar;
struct foo;

struct foo {
    struct bar *b;
};

struct bar {
    struct foo *f;
}; 
```

当然，您可以随时添加：

```
typedef struct foo foo_t;
typedef struct bar bar_t; 
```

那到底有什么意义呢？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-07-05T00:19:12.497

A> typdef 通过允许**为数据类型创建更有意义的同义词来**帮助解释程序的含义和文档。此外，它们有助于针对可移植性问题（K&R、pg147、C prog lang）对程序进行参数化。

B> **一个结构定义了一个类型**。Structs 允许对一组 var 进行方便的分组，以便于将（K&R、pg127、C prog lang.）作为一个单元进行处理

C> typedef'ing a struct 在上面的 A 中解释。

D> 对我来说，结构是自定义类型或容器或集合或命名空间或复杂类型，而 typdef 只是创建更多昵称的一种手段。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-06-11T00:50:08.283

在“C”编程语言中，关键字“typedef”用于为某些对象（结构、数组、函数..枚举类型）声明一个新名称。例如，我将使用“struct-s”。在“C”中，我们经常在“main”函数之外声明一个“struct”。例如：

```
struct complex{ int real_part, img_part }COMPLEX;

main(){

 struct KOMPLEKS number; // number type is now a struct type
 number.real_part = 3;
 number.img_part = -1;
 printf("Number: %d.%d i \n",number.real_part, number.img_part);

} 
```

每次我决定使用结构类型时，我都需要这个关键字 'struct 'something' 'name'.'typedef' 将简单地重命名该类型，并且我可以在每次需要时在我的程序中使用这个新名称。所以我们的代码将是：

```
typedef struct complex{int real_part, img_part; }COMPLEX;
//now COMPLEX is the new name for this structure and if I want to use it without
// a keyword like in the first example 'struct complex number'.

main(){

COMPLEX number; // number is now the same type as in the first example
number.real_part = 1;
number.img)part = 5;
printf("%d %d \n", number.real_part, number.img_part);

} 
```

如果您有一些将在整个程序中使用的本地对象（结构、数组、有价值的），您可以简单地使用“typedef”给它一个名称。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-11-02T09:34:21.423

结果在 C99 中 typedef 是必需的。它已经过时了，但是很多工具（ala HackRank）使用 c99 作为其纯 C 实现。那里需要 typedef 。

我并不是说如果要求发生变化，他们应该改变（可能有两个 C 选项），我们这些在网站上学习面试的人将是 SOL。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2010-03-06T14:54:22.570

根本上，在C语言中，struct/union/enum都是C语言预处理器处理的宏指令（不要误认为预处理器处理“#include”等）

所以 ：

```
struct a
{
   int i;
};

struct b
{
   struct a;
   int i;
   int j;
}; 
```

struct b 被用作这样的东西：

```
struct b
{
    struct a
    {
        int i;
    };
    int i;
    int j;
} 
```

因此，在编译时它在堆栈上演变为： b: int ai int i int j

这也是为什么很难拥有自引用结构，C 预处理器在无法终止的声明循环中循环。

typedef 是类型说明符，这意味着只有 C 编译器处理它，它可以像他想要的那样优化汇编代码实现。它也不会像预处理器对结构一样愚蠢地消耗 par 类型的成员，而是使用更复杂的引用构造算法，因此构造如下：

```
typedef struct a A; //anticipated declaration for member declaration

typedef struct a //Implemented declaration
{
    A* b; // member declaration
}A; 
```

被允许并且功能齐全。当执行线程离开初始化函数的应用程序字段时，此实现还可以访问编译器类型转换并消除一些错误影响。

这意味着在 C 中 typedef 更接近于 C++ 类而不是单独的结构。

# c - strdup() - 它在 C 中做了什么？

> ID：252782
> 
> 赞同：318
> 
> 时间：2008-10-31T07:15:45.700
> 
> 标签：c, function, strdup

`strdup()`C中函数的目的是什么？

* * *

## 回答 #1

> 赞同：392
> 
> 时间：2008-10-31T07:31:42.283

听起来确实如此，假设您习惯于 C 和 UNIX 分配单词的缩写方式，它会***复制字符串***:-)

请记住，它实际上不是 ISO C 标准本身的一部分^((a))（它是 POSIX 事物），它实际上与以下代码相同：

```
char *strdup(const char *src) {
    char *dst = malloc(strlen (src) + 1);  // Space for length plus nul
    if (dst == NULL) return NULL;          // No memory
    strcpy(dst, src);                      // Copy the characters
    return dst;                            // Return the new string
} 
```

换句话说：

1.  它尝试分配足够的内存来保存旧字符串（加上一个'\0'字符来标记字符串的结尾）。

2.  如果分配失败，则立即设置`errno`并`ENOMEM`返回`NULL`。设置`errno`to`ENOMEM`是`malloc`POSIX 中所做的，所以我们不需要在`strdup`. 如果您*不*符合 POSIX，则 ISO C 实际上并没有强制要求存在，`ENOMEM`所以我没有在^((b))中包含它。

3.  否则分配工作，所以我们将旧字符串复制到新字符串^((c))并返回新地址（调用者负责在某些时候释放）。

请记住，这是概念上的定义。任何值得他们薪水的图书馆作者都可能提供了针对正在使用的特定处理器的高度优化的代码。

* * *

^((a))但是，以`str`和小写字母开头的功能被标准保留用于未来的方向。来自`C11 7.1.3 Reserved identifiers`：

> 每个标头声明或定义其相关子条款中列出的所有标识符，并且*可选地声明或定义其相关未来库方向子条款中列出的标识符。**

未来的方向`string.h`可以在`C11 7.31.13 String handling <string.h>`：

> `str`以、`mem`或和小写字母开头的函数名称`wcs`可以添加到`<string.h>`标头中的声明中。

因此，如果您想安全起见，您可能应该将其称为其他名称。

* * *

^((b))更改基本上将替换`if (d == NULL) return NULL;`为：

```
if (d == NULL) {
    errno = ENOMEM;
    return NULL;
} 
```

* * *

^((c))请注意，我使用`strcpy`它，因为这清楚地表明了意图。在某些实现中，使用 可能更快（因为您已经知道长度）`memcpy`，因为它们可能允许以更大的块或并行传输数据。或者它可能不会:-) 优化口头禅＃1：“衡量，不要猜测”。

无论如何，如果您决定走那条路，您会执行以下操作：

```
char *strdup(const char *src) {
    size_t len = strlen(src) + 1;       // String plus '\0'
    char *dst = malloc(len);            // Allocate space
    if (dst == NULL) return NULL;       // No memory
    memcpy (dst, src, len);             // Copy the block
    return dst;                         // Return the new string
} 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2009-11-27T15:50:57.270

```
char * strdup(const char * s)
{
  size_t len = 1+strlen(s);
  char *p = malloc(len);

  return p ? memcpy(p, s, len) : NULL;
} 
```

也许代码比 with 快一点，`strcpy()`因为`\0`char 不需要再次搜索（它已经是 with `strlen()`）。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2008-10-31T09:46:59.357

没有必要重复其他答案，但请注意，`strdup()`从 C 的角度来看，它可以做任何它想做的事情，因为它不是任何 C 标准的一部分。然而，它是由 POSIX.1-2001 定义的。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-10-31T07:18:43.213

来自[strdup 人](http://www.opengroup.org/onlinepubs/009695399/functions/strdup.html)：

该`strdup()`函数应返回一个指向新字符串的指针，该字符串是 指向的字符串的副本`s1`。返回的指针可以传递给`free()`. 如果无法创建新字符串，则返回空指针。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-27T09:51:02.733

strdup() 为包含结束字符 '\0' 的字符数组进行动态内存分配，并返回堆内存的地址：

```
char *strdup (const char *s)
{
    char *p = malloc (strlen (s) + 1);   // allocate memory
    if (p != NULL)
        strcpy (p,s);                    // copy string
    return p;                            // return the memory
} 
```

所以，它所做的是给我们另一个字符串，它与它的参数给出的字符串相同，而不需要我们分配内存。但是我们仍然需要稍后释放它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-31T07:22:27.637

**它通过运行传入的字符串的malloc**和**strcpy**来复制传入的字符串。malloc 的缓冲区返回给调用者，因此需要在返回值上运行**free 。**

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-17T12:00:42.937

`strdup`并`strndup`在 POSIX 兼容系统中定义为：

```
char *strdup(const char *str);
char *strndup(const char *str, size_t len); 
```

**strdup()**函数为 string 的副本分配足够的内存，进行复制并`str`返回指向它的指针。

该指针随后可用作函数的参数`free`。

如果可用内存不足，`NULL`则返回并`errno`设置为 `ENOMEM`。

**strndup()**函数从字符串中复制最多`len`字符，`str`始终为空，以终止复制的字符串。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T07:27:02.353

它所做的最有价值的事情是为您提供另一个与第一个相同的字符串，而无需您自己分配内存（位置和大小）。但是，如前所述，您仍然需要释放它（但这也不需要数量计算。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-12-03T09:04:04.863

该声明：

```
strcpy(ptr2, ptr1); 
```

相当于（除了这会改变指针的事实）：

```
while(*ptr2++ = *ptr1++); 
```

然而：

```
ptr2 = strdup(ptr1); 
```

相当于：

```
ptr2 = malloc(strlen(ptr1) + 1);
if (ptr2 != NULL) strcpy(ptr2, ptr1); 
```

因此，如果您希望复制的字符串在另一个函数中使用（因为它是在堆部分创建的），您可以使用`strdup`，否则`strcpy`就足够了，

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-13T05:49:36.173

strdup() 函数是字符串复制的简写，它以字符串常量或字符串字面量的形式接收参数，并为字符串分配刚好足够的空间，并在分配的空间中写入相应的字符，最后返回分配的地址调用例程的空间。

# .net - IQueryable 和有什么区别 和 IEnumerable ?

> ID：252785
> 
> 赞同：447
> 
> 时间：2008-10-31T07:18:42.747
> 
> 标签：.net, linq, .net-3.5, ienumerable, iqueryable

`IQueryable<T>`和 和有什么不一样`IEnumerable<T>`？

* * *

另请参阅与此问题重叠的[IQueryable 和 IEnumerable 之间有什么区别。](https://stackoverflow.com/questions/2433306/whats-the-difference-between-iqueryable-and-ienumerable?rq=1)

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2008-10-31T08:11:37.257

首先，扩展*接口*，所以你可以用“普通”做任何事情，你也可以用.[`IQueryable<T>`](http://msdn.microsoft.com/en-us/library/bb351562.aspx "MSDN 参考") *`IEnumerable<T>``IEnumerable<T>``IQueryable<T>`*

 *`IEnumerable<T>`只是有一个`GetEnumerator()`返回 an 的方法，`Enumerator<T>`您可以调用它的`MoveNext()`方法来迭代一系列*T*。

`IQueryable<T>`没有的`IEnumerable<T>` *特别*是两个属性——一个指向**查询提供程序**（例如，LINQ to SQL 提供程序），另一个指向将对象表示为运行时可遍历的抽象语法树的**查询表达式**`IQueryable<T>`。由给定的查询提供程序理解（在大多数情况下，您不能将 LINQ to SQL 表达式提供给 LINQ to Entities 提供程序而不引发异常）。

表达式可以简单地是对象本身的常量表达式，也可以是由一组查询运算符和操作数组成的更复杂的树。*使用传递给它的表达式*调用查询提供程序`IQueryProvider.Execute()`或`IQueryProvider.CreateQuery()`方法，然后分别返回一个查询结果或另一个。*`IQueryable`*

 ** * *

## 回答 #2

> 赞同：218
> 
> 时间：2008-10-31T07:20:29.403

主要区别在于用于`IQueryable<T>`获取`Expression`对象而不是委托的 LINQ 运算符，这意味着它接收的自定义查询逻辑（例如谓词或值选择器）采用表达式树的形式而不是方法的委托。

*   `IEnumerable<T>`非常适合处理在内存中迭代的序列，但是
*   `IQueryable<T>`允许内存不足的东西，例如远程数据源，例如数据库或 Web 服务。

### 查询执行：

*   查询的执行将在**“进程中”**执行，通常只需要代码（作为代码）来执行查询的每个部分。

*   如果执行将在**进程外**执行，则查询的逻辑必须在数据中表示，以便 LINQ 提供程序可以将其转换为内存外执行的适当形式 - 无论是 LDAP 查询， SQL 什么的。

更多内容：

*   [LINQ：`IEnumerable<T>`和`IQueryable<T>`](https://web.archive.org/web/20200720162730/https://social.technet.microsoft.com/wiki/contents/articles/19666.net-framework-ienumerable-t-vs-iqueryable-t.aspx)
*   [C# 3.0 和 LINQ](https://web.archive.org/web/20201127014808/https://odetocode.com/Articles/738.aspx)。
*   “[回归`IEnumerable<T>`vs`IQueryable<T>`](https://stackoverflow.com/questions/2876616/returning-ienumerablet-vs-iqueryablet/2876655#2876655) ”
*   [.NET 和 C# 开发人员的反应式编程-`IEnumerable`介绍`IQueryable``IObservable``IQbservable`](https://www.codeproject.com/Articles/646361/Reactive-Programming-For-NET-And-Csharp-Developers)
*   2008 年：“[年度最有趣的界面……`IQUERYABLE<T>`](https://web.archive.org/web/20170708130544/http://bartdesmet.net/blogs/bart/archive/2008/08/15/the-most-funny-interface-of-the-year-iqueryable-lt-t-gt.aspx) ”来自[Bart De Smet](http://bartdesmet.net)。

![http://www.codeproject.com/KB/cs/646361/WhatHowWhere.jpg](https://i.stack.imgur.com/2DAqv.jpg)

* * *

## 回答 #3

> 赞同：214
> 
> 时间：2014-04-29T08:35:13.397

[这是youtube 上](https://www.youtube.com/watch?v=yfPGFapabAY)的一个很好的视频，展示了这些界面的不同之处，值得一看。

下面是一个很长的描述性答案。

要记住的第一个重点是`IQueryable`interface 继承自`IEnumerable`，所以能做什么`IEnumerable`也`IQueryable`能做什么。

![在此处输入图像描述](https://i.stack.imgur.com/VWRqa.png)

有很多不同之处，但让我们讨论一个最大的不同之处。当您的集合使用实体框架加载并且您想对集合应用过滤器时，**`IEnumerable`**界面很有用。`LINQ`

考虑以下`IEnumerable`与实体框架一起使用的简单代码。它使用`Where`过滤器来获取`EmpId`为`2`.

```
EmpEntities ent = new EmpEntities();
IEnumerable<Employee> emp = ent.Employees; 
IEnumerable<Employee> temp = emp.Where(x => x.Empid == 2).ToList<Employee>(); 
```

这里过滤器在`IEnumerable`代码所在的客户端执行。换句话说，所有数据都是从数据库中获取的，然后在客户端扫描并使用`EmpId`is获取记录`2`。

![在此处输入图像描述](https://i.stack.imgur.com/8mhVf.png)

但是现在看到下面的代码我们已经更改**`IEnumerable`**为**`IQueryable`**. 它在服务器端创建一个 SQL 查询，并且只将必要的数据发送到客户端。

```
EmpEntities ent = new EmpEntities();
IQueryable<Employee> emp = ent.Employees;
IQueryable<Employee> temp =  emp.Where(x => x.Empid == 2).ToList<Employee>(); 
```

![在此处输入图像描述](https://i.stack.imgur.com/dZj3E.png)

`IQueryable`所以和之间的区别在于`IEnumerable`过滤器逻辑的执行位置。一个在客户端执行，另一个在数据库上执行。

因此，如果您只使用内存中的数据收集`IEnumerable`是一个不错的选择，但如果您想查询与数据库连接的数据收集，则 IQueryable 是一个更好的选择，因为它可以减少网络流量并使用 SQL 语言的强大功能。

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2012-05-10T11:31:27.370

**IEnumerable:** IEnumerable is best suitable for working with in-memory collection (or local queries). IEnumerable doesn’t move between items, it is forward only collection.

**IQueryable:** IQueryable best suits for remote data source, like a database or web service (or remote queries). IQueryable is a very powerful feature that enables a variety of interesting deferred execution scenarios (like paging and composition based queries).

So when you have to simply iterate through the in-memory collection, use IEnumerable, if you need to do any manipulation with the collection like Dataset and other data sources, use IQueryable

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2013-05-16T08:59:08.820

简而言之，其他主要区别在于 IEnumerable 在服务器端执行选择查询，在客户端加载内存中的数据，然后过滤数据，而 IQueryable 在服务器端使用所有过滤器执行选择查询。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2014-09-04T12:01:30.943

在现实生活中，如果您使用的是像 LINQ-to-SQL 这样的 ORM

*   如果创建 IQueryable，则查询可能会转换为 sql 并在数据库服务器上运行
*   如果创建 IEnumerable，则在运行查询之前，所有行都将作为对象拉入内存。

在这两种情况下，如果您不调用 a `ToList()`or `ToArray()`then 查询将在每次使用时执行，例如，您有 an`IQueryable<T>`并从中填充 4 个列表框，那么查询将针对数据库运行 4 次。

此外，如果您扩展您的查询：

```
q.Where(x.name = "a").ToList() 
```

然后使用 IQueryable 生成的 SQL 将包含“where name = “a”，但是使用 IEnumerable 将从数据库中拉回更多角色，然后 x.name = “a” 检查将由 .NET 完成。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2017-04-26T02:59:11.030

下面提到的小测试可能会帮助您了解`IQueryable<T>`和之间差异的一个方面`IEnumerable<T>`。我已经从[这篇](https://stackoverflow.com/a/43623973/465053)文章中复制了这个答案，我试图在其他人的帖子中添加更正

我在 DB（DDL 脚本）中创建了以下结构：

```
CREATE TABLE [dbo].[Employee]([PersonId] [int] NOT NULL PRIMARY KEY,[Salary] [int] NOT NULL) 
```

这是记录插入脚本（DML 脚本）：

```
INSERT INTO [EfTest].[dbo].[Employee] ([PersonId],[Salary])VALUES(1, 20)
INSERT INTO [EfTest].[dbo].[Employee] ([PersonId],[Salary])VALUES(2, 30)
INSERT INTO [EfTest].[dbo].[Employee] ([PersonId],[Salary])VALUES(3, 40)
INSERT INTO [EfTest].[dbo].[Employee] ([PersonId],[Salary])VALUES(4, 50)
INSERT INTO [EfTest].[dbo].[Employee] ([PersonId],[Salary])VALUES(5, 60)
GO 
```

`Employee`现在，我的目标是简单地从数据库中的表中获取前 2 条记录。我在控制台应用程序中添加了一个 ADO.NET 实体数据模型项，指向`Employee`我的数据库中的表，并开始编写 LINQ 查询。

**IQueryable 路线的代码**：

```
using (var efContext = new EfTestEntities())
{
    IQueryable<int> employees = from e in efContext.Employees  select e.Salary;
    employees = employees.Take(2);

    foreach (var item in employees)
    {
        Console.WriteLine(item);
    }
} 
```

当我开始运行这个程序时，我还在我的 SQL Server 实例上启动了一个 SQL Query profiler 会话，下面是执行摘要：

1.  触发的查询总数：1
2.  查询文本：`SELECT TOP (2) [c].[Salary] AS [Salary] FROM [dbo].[Employee] AS [c]`

它只是`IQueryable`足够聪明地`Top (2)`在数据库服务器端应用该子句，因此它仅通过网络传输 5 条记录中的 2 条。在客户端计算机端根本不需要任何进一步的内存过滤。

**IEnumerable 路由的代码**：

```
using (var efContext = new EfTestEntities())
{
    IEnumerable<int> employees = from e in efContext.Employees  select e.Salary;
    employees = employees.Take(2);

    foreach (var item in employees)
    {
        Console.WriteLine(item);
    }
} 
```

本案执行总结：

1.  触发的查询总数：1
2.  SQL 探查器中捕获的查询文本：`SELECT [Extent1].[Salary] AS [Salary] FROM [dbo].[Employee] AS [Extent1]`

现在事情是`IEnumerable`把表中存在的所有 5 条记录都带入`Salary`，然后在客户端计算机上执行内存过滤以获得前 2 条记录。所以更多的数据（在这种情况下是 3 个额外的记录）不必要地通过网络传输。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2012-11-14T22:14:59.267

IEnumerable 指的是一个集合，但 IQueryable 只是一个查询，它将在表达式树中生成。我们将运行此查询以从数据库中获取数据。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2019-04-11T11:39:14.127

我们使用`IEnumerable`和`IQueryable`操作从数据库中检索到的数据。`IQueryable`继承自`IEnumerable`，因此`IQueryable`包含所有`IEnumerable`功能。`IQueryable`和之间的主要区别在于`IEnumerable`，`IQueryable`使用过滤器执行查询，而`IEnumerable`先执行查询，然后根据条件过滤数据。

在下面找到更详细的区别：

**IEnumerable**

1.  `IEnumerable`存在于`System.Collections`命名空间中
2.  `IEnumerable`在服务器端执行选择查询，在客户端加载内存中的数据，然后过滤数据
3.  `IEnumerable`适用于从内存集合中查询数据，如 List、Array
4.  `IEnumerable`有利于 LINQ to Object 和 LINQ to XML 查询

**可查询的**

1.  `IQueryable`存在于`System.Linq`命名空间中
2.  `IQueryable`使用所有过滤器在服务器端执行“选择查询”
3.  `IQueryable`适用于从内存外（如远程数据库、服务）集合中查询数据
4.  `IQueryable`有利于 LINQ to SQL 查询

所以`IEnumerable`通常用于处理内存中的集合，而`IQueryable`通常用于操作集合。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-03-14T02:38:14.450

这是我在类似的帖子（关于这个主题）上写的。（不，我通常不引用自己的话，但这些都是非常好的文章。）

编辑：删除了一篇文章的链接，该文章曾经很有帮助，但现在重定向到色情网站。（感谢@Grace 指出这一点！）

引用那篇文章（标题为“LINQ-to-SQL 中的 IQueryable 与 IEnumerable”），“根据 MSDN 文档，对 IQueryable 进行的调用是通过构建内部表达式树来操作的。“这些扩展 IQueryable(Of T) 的方法不直接执行任何查询。相反，它们的功能是构建一个 Expression 对象，这是一个表示累积查询的表达式树。”'

表达式树是 C# 和 .NET 平台上非常重要的构造。[（它们通常很重要，但 C# 使它们非常有用。）为了更好地理解差异，我建议在此处阅读官方 C# 5.0 规范中的](http://www.codeproject.com/Articles/646361/Reactive-Programming-for-NET-and-Csharp-Developers)*表达式*和*语句* 之间的差异。对于分支到 lambda 演算的高级理论概念，表达式支持将方法作为一等对象。IQueryable 和 IEnumerable 之间的区别集中在这一点上。IQueryable 构建表达式树，而 IEnumerable 没有，至少对于我们这些不在微软秘密实验室工作的人来说不是一般意义上的。

这是另一篇非常有用的文章，详细介绍了推与拉的区别。（通过“推”与“拉”，我指的是数据流的方向[。.NET 和 C# 的反应式编程技术](http://www.amazedsaint.com/2010/09/revisiting-few-c-concepts-delegates.html)

这是一篇非常好的文章，详细介绍了语句 lambda 和表达式 lambda 之间的区别，并更深入地讨论了表达式树的概念：[重新审视 C# 委托、表达式树和 lambda 语句与 lambda 表达式。][4]。”

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-02-27T21:58:57.073

如果我们要处理来自数据库的大量数据，IQueryable 比 IEnumerable 更快，因为 IQueryable 只从数据库中获取所需的数据，而 IEnumerable 则从数据库中获取所有数据，而不管是否需要

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-30T04:37:33.117

ienumerable：当我们要处理进程内内存时，即没有数据连接 iqueryable：何时处理sql server，即有数据连接 ilist ：添加对象、删除对象等操作

# c# - 在线程应用程序中准确计时一行代码，C#

> ID：252793
> 
> 赞同：6
> 
> 时间：2008-10-31T07:23:10.910
> 
> 标签：c#, multithreading

假设应用程序是多线程的，那么在 C# 中计时线程或代码行的最准确方法是什么？

亲切的问候，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T07:31:57.850

“定时线程”到底是什么意思？

要计时（在墙上时间）某件事需要多长时间，请使用 System.Diagnostics.Stopwatch。我不相信有任何东西可以测量特定线程所花费的处理器时间。当然，分析器会帮助你很多，但它们也会影响他们正在检查的程序的时间，这使得事情变得更加棘手。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T07:32:58.053

如果您需要在 .NET 中准确计时操作，则需要[Stopwatch](http://msdn2.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)类（它包装了 Windows QueryPerformanceCounter API）。查看此（Internet 存档）[帖子](https://web.archive.org/web/20090409105700/http://lyon-smith.org/blogs/code-o-rama/archive/2007/07/17/timing-code-on-windows-with-the-rdtsc-instruction.aspx)以了解线程计时注意事项。

# ruby-on-rails - 通过部分实现递归是最佳实践吗？

> ID：252800
> 
> 赞同：2
> 
> 时间：2008-10-31T07:31:29.803
> 
> 标签：ruby-on-rails, recursion

我需要在 HTML 中显示嵌套的集合结构。我正在使用以下部分进行操作：

```
<ul<%= ' id="tree"' if depth == 0 %>>
<% items.each do |item| %>
  <li id="node_<%= item.id %>"><a><%= item.name %></a>
  <% if item.has_children? %>
    <%= render :partial => 'tree_level', :locals => {:items => item.children, :depth => depth + 1} %>
  <% end %>
  </li>
<% end %>   
</ul> 
```

这是拥有代码的最佳位置吗？我“觉得”`to_html`对象上应该有一个方法可以为我转储整个树结构，尽管这可行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T07:50:05.180

我不确定这是否是最佳实践，但我使用类似的代码来渲染项目树。

更快的替代方法是创建执行相同工作的辅助方法（递归遍历树并将部分字符串添加到结果字符串中）。它有点 PHP 风格 :( 但是对于这么少量的 HTML 是可以的，我猜 :)

助手看起来像：

```
def render_node(node)
  res = "<ul>"
  ...
  node.items.each {|n| res << render_node(n)}
  ...
  res << "</ul>"
  res
end 
```

然后它是这样使用的：

```
<%=render_node ProjectTree.new%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T08:28:56.690

好吧，您应该意识到使用 partials 有（很小的）开销，所以如果性能是一个问题，您可能不想这么多地使用它们。否则我觉得使用这个没什么问题。

[但是，您可能希望使用局部变量的集合变体（请参阅此 API 页面上](http://api.rubyonrails.org/classes/ActionView/Partials.html)的“呈现局部集合” ，它可以稍微清理您的代码。

# tsql - 在 t-sql 中将时间 + 持续时间拆分为间隔

> ID：252811
> 
> 赞同：1
> 
> 时间：2008-10-31T07:37:15.767
> 
> 标签：tsql, datetime

有谁知道解决这个问题的简单方法？

我有一个表，其中包含事件的开始时间和相关的持续时间。我需要能够将事件持续时间分成 30 分钟的间隔。例如，如果一个事件在 10:45:00 开始并且持续时间是 00:17:00，那么返回的集合应该分配 15 分钟到 10:30:00 间隔和 00:02:00 分钟到 11:00 :00 间隔。

我确信我可以找出一个笨拙的方法，但想要更简单的方法。我想这一定经常出现，但谷歌今天无济于事。

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T08:08:12.100

您可以创建一个仅包含时间（超过 24 小时）的查找表，然后加入该表。您需要将日期重新设置为查找中使用的日期。然后在上下间隔上执行 datediff 以计算出它们的持续时间。每个中间间隔为 30 分钟。

```
create table #interval_lookup (
  from_date datetime,
  to_date datetime
)

declare @time datetime
set @time = '00:00:00'

while @time < '2 Jan 1900'
  begin
    insert into #interval_lookup values (@time, dateadd(minute, 30, @time))
    set @time = dateadd(minute, 30, @time)
  end

declare @search_from datetime
declare @search_to datetime

set @search_from = '10:45:00'
set @search_to = dateadd(minute, 17, @search_from) 

select
  from_date as interval,
  case
    when from_date <= @search_from and 
         @search_from < to_date and 
         from_date <= @search_to and 
         @search_to < to_date 
         then datediff(minute, @search_from, @search_to)
    when from_date <= @search_from and 
         @search_from < to_date 
         then datediff(minute, @search_from, to_date)
    when from_date <= @search_to and 
         @search_to < to_date then 
         datediff(minute, from_date, @search_to)
    else 30
  end as duration
from
  #interval_lookup
where
  to_date > @search_from
  and from_date <= @search_to 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T08:40:16.607

## 创建拆分单个事件的 TVF：

```
ALTER FUNCTION dbo.TVF_TimeRange_Split_To_Grid
(
    @eventStartTime datetime
    , @eventDurationMins float
    , @intervalMins int
)
RETURNS @retTable table
(
    intervalStartTime datetime
    ,intervalEndTime datetime
    ,eventDurationInIntervalMins float
)
AS
BEGIN

    declare @eventMinuteOfDay int
    set @eventMinuteOfDay = datepart(hour,@eventStartTime)*60+datepart(minute,@eventStartTime)

    declare @intervalStartMinute int
    set @intervalStartMinute = @eventMinuteOfDay - @eventMinuteOfDay % @intervalMins

    declare @intervalStartTime datetime
    set @intervalStartTime = dateadd(minute,@intervalStartMinute,cast(floor(cast(@eventStartTime as float)) as datetime))

    declare @intervalEndTime datetime
    set @intervalEndTime = dateadd(minute,@intervalMins,@intervalStartTime)

    declare @eventDurationInIntervalMins float

    while (@eventDurationMins>0)
    begin

        set @eventDurationInIntervalMins = cast(@intervalEndTime-@eventStartTime as float)*24*60
        if @eventDurationMins<@eventDurationInIntervalMins 
            set @eventDurationInIntervalMins = @eventDurationMins

        insert into @retTable
        select @intervalStartTime,@intervalEndTime,@eventDurationInIntervalMins

        set @eventDurationMins = @eventDurationMins - @eventDurationInIntervalMins
        set @eventStartTime = @intervalEndTime

        set @intervalStartTime = @intervalEndTime
        set @intervalEndTime = dateadd(minute,@intervalMins,@intervalEndTime)
    end

    RETURN 
END
GO 
```

## 测试：

```
select getdate()
select * from dbo.TVF_TimeRange_Split_To_Grid(getdate(),23,30) 
```

## 测试结果：

```
2008-10-31 11:28:12.377

intervalStartTime       intervalEndTime         eventDurationInIntervalMins
----------------------- ----------------------- ---------------------------
2008-10-31 11:00:00.000 2008-10-31 11:30:00.000 1,79372222222222
2008-10-31 11:30:00.000 2008-10-31 12:00:00.000 21,2062777777778 
```

## 示例用法：

```
select input.eventName, result.* from
(
    select 
        'first' as eventName
        ,cast('2008-10-03 10:45' as datetime) as startTime
        ,17 as durationMins
    union all
    select 
        'second' as eventName
        ,cast('2008-10-05 11:00' as datetime) as startTime
        ,17 as durationMins
    union all
    select 
        'third' as eventName
        ,cast('2008-10-05 12:00' as datetime) as startTime
        ,100 as durationMins
) input
cross apply dbo.TVF_TimeRange_Split_To_Grid(input.startTime,input.durationMins,30) result 
```

## 样本使用结果：

```
eventName intervalStartTime       intervalEndTime         eventDurationInIntervalMins
--------- ----------------------- ----------------------- ---------------------------
first     2008-10-03 10:30:00.000 2008-10-03 11:00:00.000 15
first     2008-10-03 11:00:00.000 2008-10-03 11:30:00.000 2
second    2008-10-05 11:00:00.000 2008-10-05 11:30:00.000 17
third     2008-10-05 12:00:00.000 2008-10-05 12:30:00.000 30
third     2008-10-05 12:30:00.000 2008-10-05 13:00:00.000 30
third     2008-10-05 13:00:00.000 2008-10-05 13:30:00.000 30
third     2008-10-05 13:30:00.000 2008-10-05 14:00:00.000 10

(7 row(s) affected) 
```

# c# - VB 控件使我的应用程序崩溃

> ID：252815
> 
> 赞同：1
> 
> 时间：2008-10-31T07:38:10.617
> 
> 标签：c#, .net, vb.net

我在我的一个 c# 应用程序中使用[这个](http://www.codeproject.com/KB/vb/TabPages.aspx)- 否则非常好 - vb 选项卡控件。当使用它的应用程序安装在另一台机器上时，Windows 会以通常友好和描述性的方式告诉用户“应用程序遇到问题，需要关闭”。我猜该控件有一些隐藏的与 vb 相关的依赖项，但那会是什么？

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T07:53:17.870

单击“此错误报告包含哪些数据？” 按钮，会有更多的描述性信息。（即抛出异常的类型、模块等）。

有关更多信息，请参阅[Dr. Watson 与 CLR。](http://blogs.msdn.com/vipul/archive/2007/01/22/Dr.-watson-and-the-common-language-runtime.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T08:27:10.533

由于选项卡控件似乎也是托管代码，因此您的“崩溃”很可能是未处理的 .NET 异常。

查看错误详细信息（通过使用为此目的提供的按钮展开错误对话框......）应该会给您异常消息，这应该让您了解正在发生的事情。如果它是缺少的依赖 DLL，则该名称应包含在消息中。

要获得完整的异常，包括堆栈跟踪，以下其中一项应该可以工作：

*   最少的努力：在您自己的托管代码的第一行中，添加[一个未处理的异常处理程序](http://blogs.microsoft.co.il/blogs/sasha/archive/2007/12/30/clr-and-unhandled-exception-filters.aspx)，该处理程序在消息框中显示完整的异常或在重新抛出之前将其记录到文件中

*   中等工作量：将调试器附加到客户端计算机上的进程。如果它在您的本地网络上，[设置远程调试](http://support.microsoft.com/kb/910448)应该是微不足道的，并且还应该允许您调试在执行第一行代码之前发生的异常（如果错误与绑定相关，则很可能是这种情况。. .)

*   [最努力：从客户端机器获取故障转储文件，并使用 Windbg 和SOS 调试扩展](http://msdn.microsoft.com/en-us/library/bb190764.aspx)查看托管异常。使用所涉及的工具提高工作效率需要一些时间，但从好的方面来说，它*会*教你宝贵的调试忍者技能，让你能够解决几乎任何“神秘的崩溃”......

顺便说一句，所有标准的“VB 依赖项”都是默认 .NET Framework 安装的一部分，所以这不是你的问题——只有确切的异常（可能还有堆栈跟踪）会告诉你发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T07:48:32.093

包含控件的 dll 是否与您的应用程序一起分发？也许您在 GAC 中有一个依赖关系，而您却失踪了？

# vb.net - VB.NET 中“字节”数字常量的后缀（类型字符）是什么？

> ID：252817
> 
> 赞同：25
> 
> 时间：2008-10-31T07:39:51.113
> 
> 标签：vb.net, types, constants

只是出于好奇：

我知道我可以告诉编译器我是否希望将一个值解释为某种数字类型，例如整数（32 位有符号），这样可以将“I”（类型字符）附加到常量值：

```
Private Function GetTheAnswerAsInteger() As Integer

   Return 42I

End Function 
```

还有“S”表示短，“D”表示小数等。

但是**Byte 的后缀是**什么？提示：这不是明显的“B”...

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-31T07:50:15.070

没有一个。如果您需要区分常量的整数和字节（例如调用适当的重载），则需要强制转换。

（顺便说一句，在 C# 中也是如此。）

[MSDN 提供确认：](http://msdn.microsoft.com/en-us/library/e2ayt412.aspx)

> 字节没有文字类型字符或标识符类型字符。

还有一个[类型字符和文字后缀的列表](http://msdn.microsoft.com/en-us/library/s9cz43ek.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-01-04T00:11:24.517

> 因此，我们去年秋天在 VB 中添加了二进制文字，并从早期测试人员那里得到了类似的反馈。我们确实决定为 VB 添加一个字节后缀。我们选择了 SB（用于有符号字节）和 UB（用于无符号字节）。不只是 B 和 SB 的原因有两个。
> 
> 第一，如果你用十六进制写，B 后缀是不明确的（0xFFB 是什么意思？），即使我们有解决方案，或者除 'B' 以外的其他字符（考虑了'Y'，F# 使用这个）没有可以记住默认值是有符号还是无符号 - .NET 字节默认是无符号的，因此选择 B 和 SB 是有意义的，但所有其他后缀默认情况下都是有符号的，因此它与选择 B 和的其他类型后缀一致UB。最后，我们选择了明确的 SB 和 UB。——安东尼·D·格林，

[https://roslyn.codeplex.com/discussions/542111](https://roslyn.codeplex.com/discussions/542111)

它已集成到即将发布的 VB.NET 版本中，这就是它的工作方式：

```
Public Const MyByte As Byte = 4UB;
Public Const MyByte2 As SByte = 4SB; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-20T19:08:49.000

这个答案并没有真正提供后缀，但它已经尽可能接近了。

如果您将扩展方法定义为

```
Imports System.Runtime.CompilerServices

Module IntegerExtensions

    <Extension()> _
    Public Function B(ByVal iNumber As Integer) As Byte
        Return Convert.ToByte(iNumber)
    End Function

End Module 
```

你可以像这样使用它：

```
Private Function GetTheAnswerAsByte() As Byte

   Return 42.B

End Function 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T07:47:35.760

.NET 中没有字节文字。

# c++ - C++：如何链接 libA.so 而不是 libA-XYZso

> ID：252819
> 
> 赞同：2
> 
> 时间：2008-10-31T07:42:03.620
> 
> 标签：c++, linker, versions

我有一个我开发的库 A。当我在机器上部署它时，对应的*libA.so*和*libA-XYZso*被放入 /usr/lib （XYZ 是版本号）。

现在我开发了一个库 B，它使用 A。当我链接 B 时，我使用标志 -lA。然后“ *ldd libB.so* ”给了我：

```
(...)
libA-X.Y.Z.so => /usr/lib/libA-X.Y.Z.so
(...) 
```

我的问题是，当我发布新版本的 A (XYZZ) 时，我还必须发布新版本的 B。否则，安装最新 A 的人将无法安装 B，而 B 将寻找 XYZ 版本这不存在。

我该如何解决这个问题？我如何告诉 B 寻找 libA.so 而不是 libA-XYZso ？或者这样做是错误的？甚至不安全？

**更新 1**：库 A（我从别人那里继承的）使用自动工具。

**更新 2**：当我构建库 A 时，我可以看到：*"-Wl,-soname -Wl,libA-0.6.1.so"*。如果我理解正确，这意味着我们将 soname 强制为*libA-0.6.1.so*。是对的吗 ？现在我的问题是我不知道如何在使用自动工具的项目中修改这种行为。我用谷歌搜索了一段时间，但找不到任何有用的信息。我应该修改 configure.in 还是 Makefile.am ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T10:04:36.827

创建 libA.so 时，将 -soname 选项传递给链接器（如果通过 gcc 链接，请使用 -Wl,-soname）。然后，当 B 被链接时，链接器通过它的 soname 引用 A，而不是通过它的文件名。在目标系统上，确保您有从 soname 到真实文件的链接。看

[http://www.linux.org/docs/ldp/howto/Program-Library-HOWTO/shared-libraries.html](http://www.linux.org/docs/ldp/howto/Program-Library-HOWTO/shared-libraries.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T07:59:18.250

这在 Windows 中也可以作为“DLL 地狱”使用 :)。

如果 B 需要 A 的特定版本，并且您将链接到 libA 而不是 libA-XYZ，则仅将 libA 替换为较新版本可能会导致 B 无法加载或崩溃。

但是当然你可以做一个从 libA-XYZ 到 libA-X1.Y1.Z1 的符号链接。如果没有更改 API 并且只有实现，那么您应该是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T14:21:43.950

回答我的第二次更新：在 libA 的 Makefile.am 中，我将 _la_LDFLAGS 从*-release*修改为*-avoid-version*。这创建了一个没有版本号的共享库，然后我重新编译了 libB，它成功地链接到了这个未版本化的共享库。

# java - 使用 Swing 的语法着色

> ID：252820
> 
> 赞同：5
> 
> 时间：2008-10-31T07:43:11.480
> 
> 标签：java, swing

是否有可能有类似 a 的东西，`JTextArea`它会根据我拥有的一些映射为一些关键字着色？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-01T16:29:10.087

以下是您可以尝试的其他一些选择

1.  [http://ostermiller.org/syntax/editor.html](http://ostermiller.org/syntax/editor.html)
2.  [http://java.sun.com/products/jfc/tsc/articles/text/editor_kit/index.html](http://java.sun.com/products/jfc/tsc/articles/text/editor_kit/index.html)
3.  [http://fifesoft.com/rsyntaxtextarea/](http://fifesoft.com/rsyntaxtextarea/)
4.  [http://code.google.com/p/jsyntaxpane/](http://code.google.com/p/jsyntaxpane/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T07:51:21.213

我不确定，因为我相信`JTextArea`只直接支持单一颜色的单一字体。

根据[`SyntaxHighlighter`类](http://www.cs.bris.ac.uk/Teaching/Resources/COMS30122/tools/highlight/design.html)文章，`JTextPane`是要走的路。

# dll - DLL 构建问题

> ID：252827
> 
> 赞同：2
> 
> 时间：2008-10-31T07:48:26.790
> 
> 标签：dll, build

我将我的源代码拆分在几个目录中，因此对于每个目录，我都会返回一个 DLL。是否可以从其他几个 DLL 创建一个 DLL？

**编辑：**我将 C++ 与 Windows CE Platform Builder 6.0 一起使用（它不是托管的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T07:52:53.270

使用[ILMerge](http://www.microsoft.com/downloads/details.aspx?FamilyID=22914587-B4AD-4EAE-87CF-B14AE6A939B0&displaylang=en)

[在这里](http://www.microsoft.com/downloads/details.aspx?FamilyID=22914587-B4AD-4EAE-87CF-B14AE6A939B0&displaylang=en) 你可以下载这个。
[这](http://www.codeproject.com/KB/dotnet/mergingassemblies.aspx)是实施示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T08:05:33.103

对于本机代码 DLL，没有任何工具可以自动执行此操作。您将创建一个新的 DLL 并将现有的源代码添加到该项目。但是，这样做可能需要更改源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T08:12:07.473

您不能从多个 DLL 创建一个 DLL。任何这样的工具都会很尴尬，因为每个 DLL 都可以有自己的 DllMain。

不过，您可以从多个静态库创建一个 DLL。以这种方式重新配置您的设置应该不会太难。

# iphone - 如何从 Xcode 中删除运行脚本阶段

> ID：252848
> 
> 赞同：14
> 
> 时间：2008-10-31T08:05:46.177
> 
> 标签：iphone, ios, xcode

我尝试了这一步：

选择菜单选项“Project > New Build Phase > New Run Script Build Phase”，然后输入以下脚本（不要忘记将 /Users/youruser/bin 替换为 gen_entitlements.py 的正确路径）：

```
export CODESIGN_ALLOCATE=/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/codesign_allocate
if [ "${PLATFORM_NAME}" == "iphoneos" ]; then
    /Users/youruser/bin/gen_entitlements.py "my.company.${PROJECT_NAME}" "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/${PROJECT_NAME}.xcent";
    codesign -f -s "iPhone developer" --resource-rules "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/ResourceRules.plist" \
         --entitlements "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/${PROJECT_NAME}.xcent"  "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/"
fi 
```

（来自[链接](http://www.246tnt.com/iPhone/#xcode)）

现在我想从我的项目中删除这个脚本。如何从 Xcode 中删除“运行脚本构建阶段”构建阶段？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-31T12:08:22.813

选择目标中的 Run Script 阶段并将其删除。

![删除](https://i.stack.imgur.com/pQ9uu.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T16:36:37.800

对于 xcode 4.5.1，外观略有不同，在运行脚本阶段单击一次，同时按功能 + 退格键（在 Mac 上）删除。弹出对话框后，点击删除。![在此处输入图像描述](https://i.stack.imgur.com/SufzM.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-12T01:44:41.183

1.  在项目导航器中，转到左上角并选择蓝色图标

[![在此处输入图像描述](https://i.stack.imgur.com/PGLfm.png)](https://i.stack.imgur.com/PGLfm.png)

2.  在屏幕顶部中央选择`Build Phases`

[![在此处输入图像描述](https://i.stack.imgur.com/BVCzX.png)](https://i.stack.imgur.com/BVCzX.png)

3.  当您看到`Run Script`要删除的内容时，一直查看它的右上角，您会看到一个`X`

[![在此处输入图像描述](https://i.stack.imgur.com/0Wtqi.png)](https://i.stack.imgur.com/0Wtqi.png)

4.  按`X`，您会看到一个菜单，询问您是否要删除它

[![在此处输入图像描述](https://i.stack.imgur.com/IkSX6.png)](https://i.stack.imgur.com/IkSX6.png)

5.  选择`Delete`

# html - 在绝对定位的 Div 上居中对齐

> ID：252856
> 
> 赞同：97
> 
> 时间：2008-10-31T08:10:34.310
> 
> 标签：html, css, xhtml

```
div#thing {
  position: absolute;
  top: 0px;
  z-index: 2;
  margin: 0 auto;
}

<div id="thing">
   <p>text text text with no fixed size, variable font</p>
</div> 
```

div 位于顶部，但我无法使用`<center>`or将其居中`margin: 0 auto`；

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2008-10-31T08:27:05.040

如果你给你`div`一个固定的宽度，你的问题可能会得到解决，如下所示：

```
div#thing {
    position: absolute;
    top: 0px;
    z-index: 2;
    width:400px;
    margin-left:-200px;
    left:50%;
} 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2012-12-10T17:45:43.550

```
div#thing
{
    position: absolute;
    width:400px;
    right: 0;
    left: 0;
    margin: auto;
} 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2016-08-16T10:56:59.273

我知道我迟到了，但我想我会在这里为需要水平放置绝对项目的人提供答案，当你不知道它的确切宽度时。

试试这个：

```
// Horizontal example.
div#thing {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
} 
```

也可以应用相同的技术，因为当您可能需要垂直对齐时，只需像这样调整属性：

```
// Vertical example.
div#thing {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-07-06T15:51:28.173

要使其垂直和水平居中，请执行以下操作：

```
div#thing {
   position: absolute;
   left: 50%;
   top: 50%;
   transform: translate(-50%, -50%);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-21T09:41:47.663

```
.contentBlock {
    width: {define width}
    width: 400px;
    position: absolute;
    left: 0;
    right: 0;
    margin-left: auto;
    margin-right: auto;

}
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-11T19:40:57.307

我遇到了同样的问题，我的限制是我不能有预定义的宽度。如果您的元素没有固定宽度，那么试试这个

```
div#thing 
{ 
  position: absolute; 
  top: 0px; 
  z-index: 2; 
  left:0;
  right:0;
 }

div#thing-body
{
  text-align:center;
} 
```

然后修改你的html看起来像这样

```
<div id="thing">
 <div id="thing-child">
  <p>text text text with no fixed size, variable font</p>
 </div>
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-29T17:20:57.913

或者您可以使用相对单位，例如

```
#thing {
    position: absolute;
    width: 50vw;
    right: 25vw;
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-06-20T12:04:32.523

如果你有必要有一个相对宽度（百分比），你可以将你的 div 包装在一个绝对定位的中：

```
div#wrapper {
    position: absolute;
    width: 100%;
    text-align: center;
} 
```

请记住，为了绝对定位元素，父元素必须相对定位。

* * *

## 回答 #9

> 赞同：-23
> 
> 时间：2009-01-15T15:14:56.213

是的：

```
div#thing { text-align:center; } 
```

# c - 扩展 PythonCE 以从 PythonCE 轻松访问 gsm/camera/gps

> ID：252859
> 
> 赞同：1
> 
> 时间：2008-10-31T08:13:00.170
> 
> 标签：c, windows-mobile, extending, pythonce

似乎没有用于 Windows 移动设备的脚本语言可以访问电话（短信、彩信、打电话、拍照）。我想知道制作一个能够实现这一点的 Python 库会有多复杂（用 C 编写一些东西，在 PythonCE 中编译和导入）。

问题：从哪里开始了解如何编译一个 PythonCE 模块，该模块将为 Windows 移动设备上的 Python 提供附加功能。另外，需要什么工具包。Mac（豹）上是否有可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T10:15:00.783

作为第一步，您应该尝试创建调用所需功能的可执行程序。例如，要发送 SMS，您似乎需要调用 MailSwitchToAccount，传递“SMS”等等 - 熟悉平台上的 C API。

要创建可执行文件，您需要 Visual Studio 和 Windows Mobile SDK。那些在 Windows 上运行。对于交叉编译，有 CeGCC ( [http://cegcc.sourceforge.net/docs/using.html](http://cegcc.sourceforge.net/docs/using.html) )，但使用它可能比使用 Microsoft 工具更复杂。

当您拥有可执行所需功能的可执行文件时，使用它们创建 Python 扩展模块应该很容易。只需遵循扩展和嵌入教程即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T13:56:07.433

MSDN 有大量用于在 Windows Mobile 上进行 C++ 开发的示例，并且 SDK 附带了几个示例应用程序。不幸的是 VS Express 版本（免费版本）没有为智能设备提供编译器。唯一的免费选项是较旧的 eMbedded Visual C++ (eVC)，它现在已经有 8 年的历史并且不受支持（尽管它仍然可以为设备创建应用程序，至少到 CE 5.0）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T12:17:29.817

刚刚尝试建立一个环境来编译 pythonce 模块（[http://pythonce.sourceforge.net/Wikka/SConsBuild](http://pythonce.sourceforge.net/Wikka/SConsBuild)），但似乎我只能使用 2003 PPC SDK 并且它没有最近可用的功能。即使我按照教程中的所有步骤操作，示例 spammodule.c 也无法编译:(

*   有什么好的教程可以用来为 Windows Mobile 启动 C (C++) 编程吗？
*   也可以使用免费版的 VisualStudio（Express 版）吗？

# sql-server - 从 SQL Server 2005 存储过程访问 Web 服务

> ID：252861
> 
> 赞同：1
> 
> 时间：2008-10-31T08:15:22.367
> 
> 标签：sql-server, web-services, tsql

目前我有一个对表进行一些更新的存储过程，在它进行更新之后，我需要调用一个 Web 服务。

该过程使用事务，我需要在事务结束时调用 Web 服务。如果 Web 服务调用失败，事务将回滚。

我需要知道如何将 SOAP Web 服务引用添加到 SQL 以及如何从存储过程中调用该服务。

出于架构原因，分布式事务/企业服务被排除在外。

稍后编辑：此外，CLR 程序集被排除在外。我需要部署该过程的服务器上的 CLR 已停用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T08:21:31.403

这个[Simple-Talk 教程](http://www.simple-talk.com/sql/sql-server-2005/practical-sql-server-2005-clr-assemblies/)向您展示了如何完成此操作。

您也可以[使用 COM](http://blog.davebouwman.net/CommentView,guid,6b2d6ed4-cb5e-40e8-ab88-7477c2ce69d0.aspx)执行此操作，但它需要使用许多 DBA 不允许您运行的 sp_OACreate（它需要打开配置选项）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T03:32:56.473

如果您可以控制此 Web 服务正在使用（绑定到）的数据源，则可以考虑将此数据源作为链接服务器添加到 SQL 2005 服务器的选项。这样，您将能够使用 OPENQUERY 对此数据源执行 SQL，而无需通过 Web 服务访问它。

# sql - DB2 查询输出 - 不同的行为

> ID：252862
> 
> 赞同：0
> 
> 时间：2008-10-31T08:18:57.600
> 
> 标签：sql, db2

我有两个表 TAB_A 和 TAB_B。TAB_A 是主表，TAB_B 是子/事务表。TAB_A 具有 COL_A（主键），TAB_B 具有 COL_B（主键）和 COL_A。

由于某些业务原因，列 COL_A 上的 TAB_A 和 TAB_B 之间未定义外键。

TAB_B 中有 4 条记录，其中一些值在 COL_A 中分别为 1、2、3 和 4，在 TAB_A 的 COL_A 中没有对应的匹配值。（它们是孤儿记录，错误创建）

当我发出以下 SELECT 查询时，我得到四条记录

```
SELECT B.COL_B,
       B.COL_A
  FROM TAB_A A,
       TAB_B B
 WHERE A.COL_A = B.COL_A
   AND B.COL_A IN (1, 2, 3, 4) 
```

但是，如果我开始在查询中引用 A.COL_A，则`SELECT`不会返回任何记录。

```
SELECT B.COL_B,
       B.COL_A,
       A.COL_A
  FROM TAB_A A,
       TAB_B B
 WHERE A.COL_A = B.COL_A
   AND B.COL_A IN (1, 2, 3, 4) 
```

有人可以解释这种奇怪的行为吗？

AIX 中的 DB2 版本 9.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T20:30:58.087

两个查询都应该返回相同的行。如果这确实如您所描述的那样，那么您在 DB2 中发现了一个错误。

你想用这个查询来完成什么？如果 B.COL_A 的值 (1,2,3,4) 是孤立记录，则此查询不应返回任何行。如果您打算搜索孤儿，您可能需要进行某种外连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:21:11.610

我查看了 IBM 站点中的文档。虽然他们谈论使用“JOIN”，但也提到使用“WHERE”条件（我使用过）使用直接连接，并提到它们应该产生相同的结果。

此外，我以前曾在 Oracle 和 SQL Server 工作过。上面的语法工作得很好。仍然不确定为什么输出不同，只是因为在 SELECT 子句中添加了一个额外的列

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T09:27:05.700

您应该在内部联接中使用 ON 子句而不是 WHERE 子句。ON 子句与实际连接相关，而 WHERE 通常用于与连接无关的额外条件。

[IBM 说](http://publib.boulder.ibm.com/iseries/v5r2/ic2924/index.htm?info/sqlp/rbafymstinj.htm)：“连接条件在 ON 关键字之后指定，并确定如何将两个表相互比较以产生连接结果 [...] 与实际连接无关的任何附加条件都在WHERE 子句或作为 ON 子句中实际连接的一部分。"

在您的示例中，您似乎在做相反的事情，将您的连接条件放在 WHERE 子句中。AFAIK，这不是非法的，但是当与仅引用其中一个表中的列的 SELECT 子句一起使用时，它可以解释这种奇怪的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-03T08:57:32.703

您的第二个 SQL 实际上是“INNER JOIN”。

由于表 B 的第 1、2、3、4 行是孤立的，因此条件 A.COL_A = B.COL_A 永远不会为真。

您需要编写一个显式的“LEFT OUTER JOIN”来取回行，但 A.COL_A 将始终返回 NULL。

# sql - 小表上没有索引？

> ID：252865
> 
> 赞同：35
> 
> 时间：2008-10-31T08:21:13.243
> 
> 标签：sql, sql-server, indexing, performance

“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。” （唐纳德·克努斯）。我的 SQL 表不太可能每个包含超过几千行（这些都是大行！）。SQL Server 数据库引擎优化顾问认为数据量无关紧要。所以我什至不应该考虑在这些表上放置显式索引。正确的？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-31T08:51:52.013

索引的价值在于加快读取速度。例如，如果您基于日期列中的日期范围执行大量 SELECT，则在该列上放置索引是有意义的。当然，通常你会在你将要加入的任何列上添加索引，并且频率很高。效率增益还与典型记录集的大小与记录数量的比率有关（即，抓取 20/2000 条记录比抓取 90/100 条记录更受益于索引）。对未索引列的查找本质上是线性搜索。

索引的成本来自写入，因为每个 INSERT 还需要对每个列索引进行内部插入。

因此，答案完全取决于您的应用程序——如果它类似于一个动态网站，其中读取次数可以是写入次数的 100 倍或 1000 倍，并且您正在根据数据列进行频繁、不同的查找，那么索引可能是有益的. 但是，如果写入次数大大超过读取次数，那么您的调整应该集中在加快这些查询的速度上。

在 JOIN/WHERE 列上使用和不使用索引来识别和基准测试少数应用程序最频繁的操作需要很少的时间，我建议你这样做。监视您的生产应用程序并识别最昂贵和最频繁的查询，并将优化工作集中在这两组查询的交集上（这可能意味着索引或完全不同的东西，例如为查询或连接缓存）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-31T13:14:41.010

Knuth 的明智之言不适用于创建（或不创建）索引，因为通过添加索引，您并**没有**直接优化任何内容：您提供的是 DBMS 优化器*可以*用来优化某些查询的索引。事实上，您最好争辩说，决定*不对*小表建立索引是过早的优化，因为这样做会限制 DBMS 优化器的选项！

不同的 DBMS 将根据包括表大小在内的各种因素来选择是否对列进行索引，而这些都是应该考虑的。

什么**是**数据库中过早优化的示例：在任何基准测试表明规范化数据库实际上存在任何性能问题之前“为性能而去规范化”。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-31T08:46:03.257

将为唯一约束索引主键列。我仍然会索引所有外键列。如果不相关，优化器可以选择忽略您的索引。

如果您只有一点点数据，那么插入/更新的额外成本也不应该很大。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-31T09:25:05.580

完全不正确。100% 不正确。不要放置一百万个毫无意义的索引，但您确实需要一个主键（在大多数情况下），并且您确实希望它正确地聚集在一起。

原因如下：

```
SELECT * FROM MySmallTable <-- No worries... Index won't help

SELECT
    *
FROM
    MyBigTable INNER JOIN MySmallTable ON... <-- Ahh, now I'm glad I have my index. 
```

这是一个很好的规则。

“因为我有一个表，我可能会想在某个时候查询它......如果我要查询它，我可能会以一致的方式这样做......” <- - 这就是你应该如何索引表。

编辑：我正在添加这一行：如果你有一个具体的例子，我会告诉你如何索引它，以及这样做你会节省多少。请提供一张表格，并举例说明您计划如何使用该表格。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-31T10:27:55.563

这取决于。该表是参考表吗？

有一千行的表没有索引，并且生成的表扫描可以使相当简单的操作延迟用户 5 分钟而不是 5 秒之间产生差异。我已经看到了这个问题，使用 SQL Server 以外的 DBMS。

通常，如果该表是参考表，则对其进行更新相对较少。这意味着更新索引对性能的影响也相对较少。如果优化器通过索引，优化器的性能影响将可以忽略不计。存储索引所需的空间也可以忽略不计。

如果你声明一个主键，你应该在那个键上获得一个自动索引。该自动索引几乎总是对您有足够的好处来证明其成本是合理的。把它留在那儿。如果您创建一个没有主键的引用表，那么您的设计方法中还有其他问题。

如果您对主键以外的某些列集进行频繁搜索或频繁连接，则额外的索引可能会为自己买单。不要解决这个问题，除非它是一个问题。

这是一般的经验法则：使用 DBMS 的默认行为，除非您找到不这样做的理由。其他任何事情都是您过早地专注于优化。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-31T12:25:33.263

我建议您遵循有关索引的通常规则，这大致意味着“在您在查询中使用的那些列上创建索引”。

对于这么小的数据库，这听起来可能没有必要。正如其他人已经说过的那样：只要您的数据库保持与您描述的一样小，查询无论如何都会足够快，并且实际上并不需要索引。它们甚至可以减慢插入和更新的速度，但除非您有非常具体的要求，否则对于这么小的数据库来说并不重要。

*但是*，如果数据库增长（哪些数据库有时倾向于这样做），您不必记住向那个您可能已经忘记的旧数据库添加索引。也许它甚至已经安装在您的一位客户身上，而您无法修改它！

我想我要说的是：索引应该是数据库设计的自然部分，*缺少*索引才是优化，无论是否为时过早。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-31T08:24:47.463

如果行的宽度很窄，并且几千行适合 10-20 个 8K 页面，那么即使您创建了一个索引，SQL 优化器也不太可能选择使用索引。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T08:26:21.173

仅在必须
时才放置索引:) 有时放置索引实际上会损害性能，具体取决于表的用途...
因此，换句话说，您会考虑在必要时将索引放在表上，因为通过分析应用程序来确定。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-31T08:31:07.593

使用 UNIQUE 约束时，通常会隐式创建索引。在那种情况下，我不会试图避免使用它们！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-04T01:02:09.380

作为一般经验法则，最好避免使用较小的索引，因为它们通常不会被使用。

但有时它们可​​以提供巨大的推动力，正如我[在这里](http://sqladvice.com/blogs/repeatableread/archive/2007/01/25/Micro-Indexing.aspx)概述的那样。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-31T08:24:53.737

我猜想在表的主键上有一个自动索引，在查询数据较少的表时应该足够了。

所以，是的，如果有一个小数据集需要处理，可以避免显式索引。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-31T12:45:41.193

即使您有索引，SQL Server 甚至可能不会使用它，具体取决于该表的统计信息。如果您计划为一年最多运行几次的报告添加索引，请记住，添加索引的 INSERT/UPDATE 惩罚将始终有效。在添加索引之前，问问自己是否值得付出性能代价。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-30T03:27:01.777

您必须了解，基于查询可能会进行两次查找，一次进入索引以获取指向该行的指针，另一次进入该行本身。如果正在查询的数据在索引列中，则可能不需要额外的步骤。

即使优化器在索引之后，数据的双重浸入也完全有可能会变慢。我们是否关心取决于应用程序分析和最终解释计划。

# windows-vista - 在 Vista 上的 Windows Installer 中使 UAC 成为可选

> ID：252871
> 
> 赞同：16
> 
> 时间：2008-10-31T08:26:38.973
> 
> 标签：windows-vista, windows-installer

我已经编写了一个 msi 文件，它在 UI 阶段提供了“per-user”或“for all”安装选项，现在发现安装程序在 Vista 上失败：

*   如果我只是重用适用于 XP 的安装程序，Vista 将触发 UAC 提示，即使是“每用户”安装，也使安装毫无意义
*   如果我在 PID_WORDCOUNT 的第 3 位关闭 UAC，Vista 将不再调用 UAC，所以即使用户有权安装到机器注册表中（比如说），也不会发生权限提升，所以安装失败。

那么：如何防止安装程序在不需要时调用 UAC？或者，即使设置了第 3 位，我如何以编程方式请求 UAC？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-22T02:39:34.693

不幸的是，Windows Installer 没有提供创建单个包的方法，该包可以为每台机器和每用户安装，但只在每台机器的情况下提示输入 UAC。问题是可以抑制 UAC 提示的位存储在 SummaryInformation 流中，并且在包执行时不可修改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-01T04:50:42.213

试试这个参考：[MSI 中的 UAC 注意：如何构建适用于标准用户和每台机器的包？](http://blogs.msdn.com/rflaming/archive/2006/10/01/780096.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-19T09:36:59.933

我通过在我的 MSI 包中设置 PID_WORDCOUNT 的第 3 位来关闭 UAC。我可以为“ALLUSERS”和“PER-USER”安装它，还可以在 VISTA 机器上的两种模式下为 HKLM 写入。您是否必须在安装期间为特权用户获取 UAC 弹出窗口？

# c# - 获取 WinNT 组的成员列表

> ID：252882
> 
> 赞同：21
> 
> 时间：2008-10-31T08:33:04.453
> 
> 标签：c#, .net, active-directory, active-directory-group, windows-security

堆栈溢出有几个与此类似的问题，但并不完全相同。

我想在 win xp 计算机上打开或创建一个本地组并向其添加成员、域、本地和知名帐户。我还想检查用户是否已经是会员，这样我就不会两次添加同一个帐户，并且可能会出现异常。

到目前为止，我开始将 DirectoryEntry 对象与`WinNT://`提供程序一起使用。一切正常，但我不知道如何获取组成员的列表？

有人知道怎么做吗？或者提供比使用 DirectoryEntry 更好的解决方案？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-24T09:59:58.453

好的，花了一段时间，弄乱了不同的解决方案，但下面给出了最适合我最初问题的解决方案。我无法让 DirectoryEntry 对象使用“标准”方法访问本地组的成员，我可以让它枚举成员的唯一方法是使用 Invoke 方法调用本机对象的 Members 方法。

```
using(DirectoryEntry groupEntry = new DirectoryEntry("WinNT://./Administrators,group"))
{
    foreach((IEnumerable) groupEntry.Invoke("Members") 中的对象成员)
    {
        使用（目录条目成员条目 = 新目录条目（成员））
        {
            Console.WriteLine(memberEntry.Path);
        }
    }
}

```

我还使用了类似的技术在本地组中添加和删除成员。

希望这对其他人也有帮助。基思。

**Tim编辑**：添加了 VB.Net 版本

```
Public Function MembersOfGroup(ByVal GroupName As String) As List(Of DirectoryEntry)
    Dim members As New List(Of DirectoryEntry)
    Try
        Using search As New DirectoryEntry("WinNT://./" & GroupName & ",group")
            For Each member As Object In DirectCast(search.Invoke("Members"), IEnumerable)
                Dim memberEntry As New DirectoryEntry(member)
                members.Add(memberEntry)
            Next
        End Using
    Catch ex As Exception
        MessageBox.Show(ex.ToString)
    End Try
    Return members
End Function 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T08:43:06.537

Microsoft .NET Framework 提供了用于使用 Active Directory 的标准库：**[System.DirectoryServices.dll](http://msdn.microsoft.com/en-us/library/ms682458(VS.85).aspx)**中的 System.DirectoryServices 命名空间。

Microsoft 建议使用 System.DirectoryServices 命名空间中的两个主要类：**DirectoryEntry**和**DirectorySearcher**。在大多数情况下，仅使用 DirectorySearcher 类就足够了。

> *更新：我在我的机器上测试了它 - 它有效。但也许我误解了你的问题。*

这是一篇出色的[CodeProject 文章](http://www.codeproject.com/KB/system/QueryADwithDotNet.aspx)中的一个示例：

## 获取属于特定 AD 组的用户列表

```
using System.DirectoryServices;

ArrayList GetADGroupUsers(string groupName)
{    
   SearchResult result;
   DirectorySearcher search = new DirectorySearcher();
   search.Filter = String.Format("(cn={0})", groupName);
   search.PropertiesToLoad.Add("member");
   result = search.FindOne();

   ArrayList userNames = new ArrayList();
   if (result != null)
   {
       for (int counter = 0; counter < 
          result.Properties["member"].Count; counter++)
       {
           string user = (string)result.Properties["member"][counter];
               userNames.Add(user);
       }
   }
   return userNames;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T08:41:29.210

您应该能够在代表组的[`"member"`属性中找到此信息。](http://msdn.microsoft.com/en-us/library/ms677097(VS.85).aspx)`DirectoryEntry`

# c# - 列表中每个用户只允许一个条目 - 列表的 ListReceiver“功能”？

> ID：252886
> 
> 赞同：2
> 
> 时间：2008-10-31T08:38:21.900
> 
> 标签：c#, sharepoint

我想知道是否有办法在 Sharepoint 中创建自定义列表，但指定每个用户只能在列表中创建一个项目。

我正在考虑两种方法：

*   开发一个 ListReceiver 来检查用户是否已经创建了一个项目。问题：我没有看到在特定列表上启用功能的方法（想法是非开发人员可以创建自定义列表并根据需要“打开”功能
*   创建自定义列表类型，因此当人们单击“创建”按钮时，他们会在“自定义列表”下看到“自定义唯一列表”作为附加类型。

在我做第二个选项之前，有谁知道第一个选项是否可行？或者即使它已经可以在没有自定义开发的情况下完成（并且在 SPDesigner 中*没有自定义工作流）*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T13:44:16.113

如果没有自定义代码，您将不走运。您可以使用代码轻松地将接收器添加到单个列表中，只需将接收器添加到 SPListItem.EventReceivers 集合中，如下所示：

list.EventReceivers.Add(SPEventReceiverType.ItemAdded, "你的名字", "你的班级名字");

但是，无法直接通过特征元素文件。

如果您想要启用或禁用特定列表上的功能的选项，您还可以添加自定义操作并将其绑定到该特定列表模板，例如，以便额外的操作菜单项允许启用或禁用唯一帖子。

.b

# html - in

> ID：252891
> 
> 赞同：31
> 
> 时间：2008-10-31T08:42:55.477
> 
> 标签：html, xhtml

Am I allowed to place `<noscript>` in the `<head>`?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-31T08:47:54.157

According to the [XHTML Strict DTD](http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd), no, you're allowed script, style, meta, link, object, title and base only. Transitional allows isindex as well, but still not noscript.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-12-21T20:08:03.413

Using the HTML5 Doctype, I have a declaration in my `<head>` with a `<link>` element that points to a no-js.css stylesheet. It validates and seems to work fine.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-15T23:55:45.533

You are as long as you do it in HTML documents and not XHTML.

> In a head element [...], the noscript element must contain only link, style, and meta elements.

[See specification](https://www.w3.org/TR/html5/scripting-1.html#the-noscript-element).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-16T20:29:50.217

HTML5 adds support to `<noscript>` in the `<head>`: [https://www.w3schools.com/tags/tag_noscript.asp](https://www.w3schools.com/tags/tag_noscript.asp)

# java - 如何在 Java 中更改 CLASSPATH？

> ID：252893
> 
> 赞同：60
> 
> 时间：2008-10-31T08:44:33.523
> 
> 标签：java, clojure, classpath

如何从 Java 进程中更改 Java 进程的 CLASSPATH？

* * *

在你问我“你为什么要这么做？”之前 我会尽快解释。

> 当您运行 Clojure REPL 时，通常需要在 CLASSPATH 中使用更多 jar 来加载[Clojure](http://clojure.org)源文件，我想这样做而不必重新启动 Clojure 本身（在 Slime 上使用它时，这并不是一个真正的选择在 Emacs 上）。

这就是原因，但我不希望这个问题被标记为 some-weird-language some-weird-editor 并且被大多数可能有答案的 Java 开发人员忽视。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-10-31T09:37:34.727

2017 年第四季度更新：正如[vda8888](https://stackoverflow.com/users/1974520/vda8888)在下面[评论](https://stackoverflow.com/questions/252893/how-do-you-change-the-classpath-within-java/252967#comment82290481_252967)的那样，在 Java 9 中，系统不再是.[`java.lang.ClassLoader`](https://docs.oracle.com/javase/9/docs/api/java/lang/ClassLoader.html)[`java.net.URLClassLoader`](https://docs.oracle.com/javase/9/docs/api/java/net/URLClassLoader.html)

请参阅“ [Java 9 迁移指南：七个最常见的挑战](https://blog.codefx.org/java/java-9-migration-guide/)”

> 我刚刚描述的类加载策略是在一种新类型中实现的，而在 Java 9 中，应用程序类加载器就是这种类型。
> 这意味着它`URLClassLoader`不再是 a，因此偶尔`(URLClassLoader) getClass().getClassLoader()`或`(URLClassLoader) ClassLoader.getSystemClassLoader()`序列将不再执行。

[java.lang.ModuleLayer](https://docs.oracle.com/javase/9/docs/api/java/lang/ModuleLayer.html)将是用于影响模块路径（而不是类路径）的替代*方法*。例如，参见“ [Java 9 模块 - JPMS 基础知识](http://blog.joda.org/2017/04/java-9-modules-jpms-basics.html)”。

* * *

对于 Java 8 或更低版本：

一些一般性评论：

您不能（以保证工作的可移植方式，见下文）更改系统类路径。相反，您需要定义一个新的 ClassLoader。

类加载器以分层方式工作......因此，任何对类 X 进行静态引用的类都需要加载到与 X 相同的类加载器中，或者加载到子类加载器中。您不能使用任何自定义 ClassLoader 来使系统 ClassLoader 链接正确加载代码，如果以前没有这样做的话。因此，除了您找到的额外代码之外，您还需要安排在自定义 ClassLoader 中运行您的主要应用程序代码。
（话虽如此，评论中[都](https://stackoverflow.com/users/188524/cracked-all)提到了这个[扩展的 `URLClassLoader`](http://snippets.dzone.com/posts/show/3574)例子）

您可能会考虑不编写自己的 ClassLoader，而只需使用 URLClassLoader。*使用不在*父类加载器 url 中的url 创建一个 URLClassLoader 。

```
URL[] url={new URL("file://foo")};
URLClassLoader loader = new URLClassLoader(url); 
```

更[完整的解决方案](http://robertmaldon.blogspot.com/2007/11/dynamically-add-to-eclipse-junit.html)是：

```
ClassLoader currentThreadClassLoader
 = Thread.currentThread().getContextClassLoader();

// Add the conf dir to the classpath
// Chain the current thread classloader
URLClassLoader urlClassLoader
 = new URLClassLoader(new URL[]{new File("mtFile").toURL()},
                      currentThreadClassLoader);

// Replace the thread classloader - assumes
// you have permissions to do so
Thread.currentThread().setContextClassLoader(urlClassLoader); 
```

如果您假设 JVM 系统类加载器是 URLClassLoader（可能并非所有 JVM 都如此），您也可以使用反射来实际修改系统类路径......（但这是一个 hack；））：

```
public void addURL(URL url) throws Exception {
  URLClassLoader classLoader
         = (URLClassLoader) ClassLoader.getSystemClassLoader();
  Class clazz= URLClassLoader.class;

  // Use reflection
  Method method= clazz.getDeclaredMethod("addURL", new Class[] { URL.class });
  method.setAccessible(true);
  method.invoke(classLoader, new Object[] { url });
}

addURL(new File("conf").toURL());

// This should work now!
Thread.currentThread().getContextClassLoader().getResourceAsStream("context.xml"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T08:49:32.173

我不相信你可以——正确的做法（我相信）是用新的路径创建一个新的类加载器。或者，您可以编写自己的类加载器，它允许您动态更改类路径（对于该加载器）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-20T11:57:47.000

无需编写自己的类加载器！有[clojure.lang.DynamicClassLoader](http://code.google.com/p/clojure/source/browse/trunk/src/jvm/clojure/lang/DynamicClassLoader.java)。

[http://blog.japila.pl/2011/01/dynamically-redefining-classpath-in-clojure-repl/](http://blog.japila.pl/2011/01/dynamically-redefining-classpath-in-clojure-repl/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T09:36:38.537

您可能想研究使用[java.net.URLClassLoader](http://java.sun.com/j2se/1.4.2/docs/api/java/net/URLClassLoader.html)。它允许您以编程方式加载最初不在类路径中的类，但我不确定这是否正是您需要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T10:23:37.287

从下面的两个链接中可以看出，VonC 提供的方法似乎是最好的，但请查看其中一些帖子和谷歌的“Java Dynamic Classpath”或“Java Dynamic Class Loading”，并从那里找到一些信息。

我会更深入地发布，但 VonC 已经完成了这项工作。

来自[类和 Jar 文件的动态加载](http://twit88.com/blog/2007/10/04/java-dynamic-loading-of-class-and-jar-file/)。

另请查看此[sun 论坛帖子](http://forums.sun.com/thread.jspa?threadID=300557)。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2013-10-10T10:17:00.250

```
String s="java  -classpath abcd/ "+pgmname+" "+filename;   
Process pro2 = Runtime.getRuntime().exec(s); 
BufferedReader in = new BufferedReader(new InputStreamReader(pro2.getInputStream())); 
```

is an example of changin the classpath in java program

# c# - 在不打扰用户的情况下使用 ac# 应用程序中的 regini？

> ID：252897
> 
> 赞同：0
> 
> 时间：2008-10-31T08:47:22.427
> 
> 标签：c#, registry

我正在开发一个需要使用 regini（由于遗留原因）将某些内容插入注册表的应用程序。我一直在尝试以这样一种方式做到这一点，即应用程序的用户不知道这一点。我写了以下代码：

```
System.Diagnostics.ProcessStartInfo pi = new ProcessStartInfo();  

pi.FileName = @"c:\windows\system32\regini.exe";
pi.Arguments = name;
pi.WorkingDirectory = Utils.AppSettings.WorkingDirectory.ToString();    
pi.WindowStyle = ProcessWindowStyle.Hidden;
pi.RedirectStandardError = true;
pi.RedirectStandardOutput = true;
pi.UseShellExecute = false;  
Process p = new Process();
p.StartInfo = pi;
p.EnableRaisingEvents = true;
p.Start(); 
```

不幸的是，每次执行此代码时，我仍然看到弹出“命令”窗口。我的印象是

```
pi.WindowStyle = ProcessWindowStyle.Hidden; 
```

会阻止这种情况。如何防止 regini 打开自己的命令窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T10:32:57.220

尝试添加这一行：

```
pi.CreateNoWindow = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T09:01:20.400

我在 Microsoft Connect 反馈站点上发现了这个错误报告：[System.Diagnostics.ProcessWindowStyle.Hidden 在执行时显示窗口](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=95026)

也许有一些你忘记的暗示。

# x11 - 如何从 xserver 获取打开的窗口列表

> ID：252906
> 
> 赞同：49
> 
> 时间：2008-10-31T08:53:18.420
> 
> 标签：x11, xserver

任何人都知道如何从 Xserver 获取所有打开窗口的列表？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-10-31T08:57:52.217

在 CLI 中，您可以使用

```
xwininfo -tree -root 
```

如果您需要在自己的代码中执行此操作，则需要使用库中的`XQueryTree`函数`Xlib`。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-19T13:22:05.520

如果您的窗口管理器实现了 EWMH 规范，您还可以查看`_NET_CLIENT_LIST`根窗口的值。这是由大多数现代窗口管理器设置的：

```
xprop -root|grep ^_NET_CLIENT_LIST 
```

该值可以通过编程轻松获得，请参阅您的 Xlib 文档！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2020-05-13T20:40:35.493

根据[Marten 的回答](https://stackoverflow.com/a/1017932/11411686)，（假设您的窗口管理器支持**扩展**窗口管理器**H** ints ）您可以**将该窗口 ID 列表****反馈**回以获取该属性：******`xprop``_NET_WM_NAME`******

 ******```
$ xprop -root _NET_CLIENT_LIST |
    pcregrep -o1 '# (.*)' |
    sed 's/, /\n/g' |
    xargs -I{} -n1 xprop -id {} _NET_WM_NAME 
```

但是在命令行中，它会更容易使用`wmctrl`：

```
$ wmctrl -l 
```

以编程方式`python-xlib`，您可以通过以下方式执行相同操作：

```
#!/usr/bin/env python
from Xlib.display import Display
from Xlib.X import AnyPropertyType

display = Display()
root = display.screen().root

_NET_CLIENT_LIST = display.get_atom('_NET_CLIENT_LIST')
_NET_WM_NAME = display.get_atom('_NET_WM_NAME')

client_list = root.get_full_property(
    _NET_CLIENT_LIST,
    property_type=AnyPropertyType,
).value

for window_id in client_list:
    window = display.create_resource_object('window', window_id)
    window_name = window.get_full_property(
        _NET_WM_NAME,
        property_type=AnyPropertyType,
    ).value
    print(window_name) 
```

或者，更好的是，使用`EWMH`库：

```
#!/usr/bin/env python
from ewmh import EWMH

window_manager_manager = EWMH()
client_list = window_manager_manager.getClientList()

for window in client_list:
    print(window_manager_manager.getWmName(window)) 
```

# php - 当一个脚本使用 curl 调用另一个脚本时，为什么 session_start 会导致超时

> ID：252907
> 
> 赞同：6
> 
> 时间：2008-10-31T08:55:37.793
> 
> 标签：php, post, curl, timeout

我有两个 PHP 脚本，都通过调用`session_name('MySessID')`.

当第一个脚本使用 curl 调用第二个脚本时，第二个脚本在`session_start()`被调用时挂起。

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-31T10:41:03.320

来自 php 手册

[http://php.net/manual/en/function.session-write-close.php](http://php.net/manual/en/function.session-write-close.php)

会话数据通常在脚本终止后存储，无需调用 session_write_close()，**但由于会话数据被锁定以防止并发写入，任何时候只有一个脚本可以对会话进行操作**。将框架集与会话一起使用时，由于这种锁定，您将体验到一个一个加载的框架。您可以通过在会话变量的所有更改完成后立即结束会话来减少加载所有帧所需的时间。

*所以你不能让 2 个脚本同时使用同一个会话。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T09:28:19.503

我不完全明白为什么会发生这种情况，但我已经解决了。

这个[错误](http://bugs.php.net/bug.php?id=44134)描述了我遇到的同样的问题。我有一个脚本发布到另一个脚本，*两者都使用相同的 session*，这显然会停止 PHP。

因此，在执行整个 curl 发布脚本之前，我调用了该`session_commit`函数，从而结束调用脚本会话，并启用被调用脚本以重新启动会话。

捶...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T18:40:52.460

我也被这个咬了。由于stackoverflow中提供的信息，我修复了它。

我有两页，顶部都有“session_start()”，第一页用 curl 调用第二页，所以我可以在验证后将变量发布到第二个脚本。在我添加“session_write_close()”之前，网络服务器一直处于挂起状态。

代码示例如下：

```
// IMPORTANT (OR ELSE INFINITE LOOP) - close current sessions or the next page will wait FOREVER for a write lock.
session_write_close();

// We can't use GET because we can't display the password in the URL.
$host = $_SERVER['HTTP_HOST'];
$uri  = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
$url  = "http://$host$uri/formPage2.php?";

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url); //append URL
curl_setopt($ch, CURLOPT_POST,TRUE);//We are using method POST
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($_REQUEST, '', "&"));//append parameters    

curl_exec($ch); // results will be outputted to the browser directly
curl_close($ch);
exit(); 
```

# actionscript-3 - 如何在 Adob e Flex 3 中通过 HTTP 服务发送数组

> ID：252915
> 
> 赞同：3
> 
> 时间：2008-10-31T09:02:17.000
> 
> 标签：actionscript-3, http, flex3, service

如何在 Adob​​e Flex3 的 Httpservice 中发送数组

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T14:13:25.573

我不太确定您将数组发送到 httpservice 是什么意思。如果您打算将数组发送到具有相同字段名称的 httpservice，则可以将数组作为字段值传递。

```
var service:HTTPService = new HTTPService();
service.useProxy = true;
service.destination = "myservicet";
service.resultFormat = HTTPService.RESULT_FORMAT_XML;

var fields:Array = ["categories", "organisation"];
var params:Object = new Object();
params.q = "stackoverflow";
params.rows = 0;
params.facet = "true";
params["facet.field"] = fields;
service.send(params); 
```

HTTPService 会将其转换为 url 参数：

```
facet=true&q=stackoverflow&facet%2Efield=categories&facet%2Efield=organisation&rows=0
```

希望这可以帮助！

为更清晰而添加。当数组中只有 1 个参数时，不要将字段作为数组传递。出于某种原因，flex 不会将其发送到 http 服务

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:47:34.560

这实际上取决于您使用的后端技术是什么。如果您将其发送到 PHP，您可以尝试：

```
var fields:Array = ["categories", "organisation"];
var params:Object = {};
params.q = "stackoverflow";
params.rows = 0;
params.facet = "true";
params["facet.field[]"] = fields;
service.send(params); 
```

PHP 将为您生成一个数组。AFAIR 这在 Rails 中也可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:34:51.340

如果它是一个简单的字符串数组，您可以使用众所周知的分隔符将其[连接起来，然后在另一个站点上，将具有相同分隔符的字符串拆分回数组。](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Array.html#join())

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T09:16:20.240

如果它是一个简单的数组，您可以将其作为逗号分隔的字符串发送。

> httpService.request = 新对象；
> httpService.request.csv = array.toString();

# c# - 在 C# 中迭代 堆栈的最快方法

> ID：252917
> 
> 赞同：11
> 
> 时间：2008-10-31T09:02:54.643
> 
> 标签：c#, optimization, stack

我觉得使用 GetEnumerator() 和强制转换 IEnumerator.Current 很昂贵。有更好的建议吗？

如果它提供类似的功能和更好的性能，我愿意使用不同的数据结构。

**经过思考：**
通用堆栈会是一个更好的主意，这样就不需要强制转换了吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-31T09:41:10.167

`Stack<T>`（使用 foreach）确实可以节省演员阵容，但实际上拳击在宏伟的计划中[并不是*那么*糟糕](https://codeblog.jonskeet.uk/2008/10/08/why-boxing-doesn-t-keep-me-awake-at-nights/)。如果您有性能问题，我怀疑这是您可以增加很多价值的领域。使用分析器，并专注于实际问题 - 否则为时过早。

请注意，如果您只想读取一次数据（即您乐于使用堆栈），那么这*可能*会更快（避免枚举器的开销）；YMMV。

```
 Stack<T> stack = null;
    while (stack.Count > 0)
    {
        T value = stack.Pop();
        // process value
    } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T09:20:02.080

如果您需要堆栈的功能（与列表或其他一些集合类型相对），那么可以，使用通用堆栈。这将加快速度，因为编译器将在运行时跳过强制转换（因为它在编译时得到保证）。

```
Stack<MyClass> stacky = new Stack<MyClass>();

foreach (MyClass item in stacky)
{
    // this is as fast as you're going to get.
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-31T09:22:26.070

您是否做过任何基准测试，或者它们只是直觉？

如果您认为大部分处理时间都花在循环堆栈上，您应该对其进行基准测试并确保情况确实如此。如果是，您有几个选择。

1.  重新设计代码，这样就不需要循环了
2.  找到一个更快的循环结构。（我会推荐泛型，即使它无关紧要。再次，做基准测试）。

编辑：

当您尝试在列表中进行查找或匹配两个列表或类似列表时，可能不需要循环的示例。如果循环需要很长时间，请查看将列表放入二叉树或哈希映射是否有意义。创建它们可能会有初始成本，但如果重新设计代码，您可能会通过稍后进行 O(1) 查找来收回成本。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-31T09:09:39.637

是的，使用通用堆栈将节省演员表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T09:21:40.487

如果迭代变量是 T 类型，则枚举泛型`IEnumerable<T>`或`IEnumerator<T>`不创建强制转换，所以是的，在大多数情况下使用泛型会更快，但泛型有一些非常微妙的问题，尤其是与值类型一起使用时。

Rico Mariani（微软性能架构师）有一些帖子详细介绍了差异和基础

*   [关于泛型和性能的六个问题](https://docs.microsoft.com/en-us/archive/blogs/ricom/six-questions-about-generics-and-performance)
*   [性能测验 #7——泛型改进和成本](https://docs.microsoft.com/en-us/archive/blogs/ricom/performance-quiz-7-generics-improvements-and-costs)
*   [性能测验 #7 -- 泛型改进和成本 -- 解决方案](https://docs.microsoft.com/en-us/archive/blogs/ricom/performance-quiz-7-generics-improvements-and-costs-solution)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-28T04:30:44.380

就速度而言，有多个变量，取决于上下文。例如，在像 C# 这样的自动内存管理代码库中，您可能会遇到分配峰值，这可能会影响诸如游戏之类的帧速率。您可以为此而不是 foreach 进行的一个很好的优化是带有 while 循环的枚举器：

```
var enumerator = stack.GetEnumerator();

while(enumerator.MoveNext ()) {
  // do stuff with enumerator value using enumerator.Current
  enumerator.Current = blah
} 
```

就 CPU 基准测试而言，这可能并不比 foreach 快，但 foreach 可能会出现意外的分配峰值，这最终会“减慢”应用程序的性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T09:26:50.897

创建枚举器的另一种方法是使用 ToArray 方法，然后遍历数组。堆栈迭代器在检查堆栈是否已被修改时会产生一些轻微的开销，而对数组的迭代会很快。但是，首先创建数组当然会产生开销。正如垫子所说，您应该对替代品进行基准测试。

# php - Magento 自定义模块。重定向到另一个模块并返回结帐

> ID：252921
> 
> 赞同：0
> 
> 时间：2008-10-31T09:04:26.057
> 
> 标签：php, magento, zend-framework, module, checkout

Magento 购物车是基于 PHP 的 Zend 框架构建的。这是我第一次处理 Zend 框架，我遇到了以下困难......

我正在创建一个自定义模块，允许用户在购买产品时上传图片。

每当用户尝试将产品添加到购物车时，我都可以重载 addAction() 方法。我还可以创建一个自定义模块，将表单呈现给用户并接受文件。但是我不确定如何将代码插入到我的重载方法中运行我的模块：

```
<?php
require_once 'Mage/Checkout/controllers/CartController.php';
class Company_SpecialCheckout_Checkout_CartController extends Mage_Checkout_CartController
{
    # Overloaded addAction
    public function addAction()
    {
        # when user tries to add to cart, request images from them
        # *********
        # *** what do i do in here to display a custom block ???? ###
        # *** and allow addAction to continue only if successfully validated form input ###
        # *********

        parent::addAction();
    }
} 
```

我怀疑我的困难来自于我对 Zend MVC 做事方式缺乏了解。我从上到下研究了所有 Magento 文档/wikis/论坛主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T13:06:09.870

我想我会转向一个新的答案，因为我认为我已经设法让它工作了。

这就是我所做的

创建了以下文件；

应用程序/代码/本地/公司/SpecialCheckout/controllers/Checkout/CartController.php

应用程序/代码/本地/公司/SpecialCheckout/etc/config.xml

应用程序/etc/modules/Company_SpecialCheckout.xml

首先是控制器，与您的完全一样；

```
 <?PHP
require_once 'Mage/Checkout/controllers/CartController.php';
class Company_SpecialCheckout_Checkout_CartController extends Mage_Checkout_CartController {

    public function indexAction()
    {
        die('test');
    }
} 
```

然后是模块配置

```
<?xml version="1.0"?>
<config>
    <modules>
        <Company_SpecialCheckout>
            <version>0.1.0</version>
        </Company_SpecialCheckout>
    </modules>
    <global>
        <rewrite>
            <Company_SpecialCheckout_Checkout_Cart>
                <from><![CDATA[#^/checkout/cart#]]></from>
                <to>/SpecialCheckout/checkout_cart</to>
            </Company_SpecialCheckout_Checkout_Cart>
        </rewrite>
    </global>
    <frontend>
        <routers>
            <Company_SpecialCheckout>
                <use>standard</use>
                <args>
                    <module>Company_SpecialCheckout</module>
                    <frontName>SpecialCheckout</frontName>
                </args>
            </Company_SpecialCheckout>
        </routers>
    </frontend>
</config> 
```

最后是 app/etc/modules 中的配置文件，以确保模块被拾取。

```
<?xml version="1.0"?>
<config>
     <modules>
        <Company_SpecialCheckout>
            <active>true</active>
            <codePool>local</codePool>
        </Company_SpecialCheckout>
     </modules>
</config> 
```

那么当你去 /checkout/cart 时，你应该会看到“测试”。这是基于我在[这里](http://www.magentocommerce.com/wiki/how_to_overload_a_controller)找到的细节。

确保您在 Magento 管理员中禁用了配置文件的缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T06:08:31.097

嘿，此选项在新版本的 magento 1.3.1 中提供，用于从前端享受上传文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T10:05:37.447

我必须事先承认我没有 Magento 的生产经验，但我花了一些时间研究他们的代码。

块结构是在 XML 中定义的，因此您可能不需要实际扩展 Cart Controller。

布局 XML 文件可以在 app/design/frontend/default/default/layout 中找到（默认安装）。在这里，您将找到 checkout.xml，它设置了结帐页面的块结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-27T11:32:00.670

对于那些坚持这一点的人，我写了最简单的方法来解决这个问题，而不会使控制器过载。我基于 onepage checkout[的变体查看 magento wiki](http://www.magentocommerce.com/wiki/5_-_modules_and_development/checkout/customizing_onepage_checkout_-_remove_shipping_method?do=show)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2010-06-23T16:21:52.640

这对我来说简直是一场噩梦，我在博客中创建了一个教程：

控制器 / 覆盖 / 前端 [...] #^/customer/account/# /mycustomer/account/ [...]

看一下这个！[如何 magento 声明和覆盖控制器](http://www.unexpectedit.com/magento/magento-declare-override-controllers)

# unit-testing - 模拟对象、nUnit、调用日志和 log4net

> ID：252923
> 
> 赞同：0
> 
> 时间：2008-10-31T09:05:38.223
> 
> 标签：unit-testing, nunit, log4net, mocking, calllog

一个很常见的单元测试场景如下：

```
public void SetUp()
{
  this.callLog = new StringBuilder();
}

public void TestBuzzBar()
{
  var bar = new Bar(new MockFoo(callLog));
  bar.Buzz(17);
  Assert.AreEqual("MockFoo.Init(17) MockFoo.PrepareStuff MockFoo.DoTheJob ", callLog.ToString());
} 
```

... 使用 MockFoo 通过仅将字符串附加到调用日志来实现 IFoo 接口。它需要在模拟中使用 callLog 进行大量代码处理。

使用 log4net 收集通话记录是个好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T10:48:22.223

回答你的问题：log4net 是一个很棒的日志框架。它易于设置和使用。我已经在单元测试中使用了 MemoryAppender，它基本上使您能够返回并查看测试期间记录的内容。此技术适用于模拟和 SUT。

# javascript - Javascript - 如何替换子字符串？

> ID：252924
> 
> 赞同：13
> 
> 时间：2008-10-31T09:06:24.807
> 
> 标签：javascript, regex

这是一个简单的。我想使用 Javascript 在客户端用另一个子字符串替换一个子字符串。

原始字符串是`'original READ ONLY'`

我想`'READ ONLY'`用`'READ WRITE'`

请问有什么快速回答吗？可能有一个javascript代码片段......

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-31T10:15:07.413

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-31T09:07:42.027

好[总结](http://www.w3schools.com/jsref/jsref_replace.asp)。它是基于正则表达式的，如果您使用正则表达式表示法，则可以指定 i 和 g 修饰符（不区分大小写 (i)，无论大小写如何都将匹配，全局 (g) 将替换所有出现），如果您使用字符串表示法'将被转换为正则表达式，你将'不能指定任何修饰符。

```
<script type="text/javascript">

var str1="Visit Microsoft!";
var str2 = str1.replace(/microsoft/i, "W3Schools"); //Will work, per the i modifier 

var str3 = "original READ ONLY";
var str4 = str3.replace("ONLY", "WRITE"); //Will also work

</script> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T09:08:48.467

```
stringObject.replace(findstring,newstring) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T09:15:58.733

我更喜欢正则表达式的方法，

newstring = oldstring.replace(/regexforstringtoreplace/, '新字符串');

它也值得考虑 g 和 i 正则表达式修饰符，它们会进行全局替换（即替换所有出现）并使其不区分大小写。

例如：

```
<script type="text/javascript">

var str = "this is a String";

document.write(str.replace(/\s/g, "_"));

would print: this_is_a_string

document.write(str.replace(/s/gi, "f"));

would print "thif if a ftring"

</script> 
```

# java - Eclipse 3.4 文本查看器

> ID：252945
> 
> 赞同：1
> 
> 时间：2008-10-31T09:21:40.470
> 
> 标签：java, eclipse-plugin, swt, eclipse-3.4, eclipse-pdt

我正在为 Eclipse 3.4 创建一个插件。我使用带有视图的应用程序创建了一个插件开发项目。现在我正在尝试创建一个`TextViewer`文档说它位于`org.eclipse.jface.text.TextViewer`. 但是，整个包丢失了，eclipse 无法找到`TextViewer`要导入的类。我想知道为什么这个包/类丢失了？此外，如果它真的消失了，那取而代之`TextViewer`的是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T10:46:52.217

```
Require-Bundle: org.eclipse.ui,
 org.eclipse.core.runtime,
 org.eclipse.jface.text 
```

在插件清单中添加*org.eclipse.jface.text*作为依赖项。您可以使用 3rd 方工具（如 IBM 的[JAR Class Finder](https://www.alphaworks.ibm.com/tech/jarclassfinder/requirements)）来定位依赖项，或者，创建一个从目标平台导入所有内容的虚拟插件并使用“打开类型”对话框 (CTRL+SHIFT+T)。

如果您不喜欢手动路由，请查看清单编辑器中的**自动化依赖管理**功能，但应注意这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T09:50:33.517

在 3.4 里面我有它

eclipse-jee-ganymede-win32\plugins\org.eclipse.jface.text_3.4.0.v20080603-2000.jar

# c++ - 使用python在c ++文件中查找某个函数的调用

> ID：252951
> 
> 赞同：1
> 
> 时间：2008-10-31T09:24:45.517
> 
> 标签：c++, python, parsing

我需要使用 python 在 c++ 文件中查找所有出现的函数调用，并为每个调用提取参数。
我正在使用[pygccxml](http://www.language-binding.net/pygccxml/pygccxml.html)包，并且使用函数调用提取给定字符串的参数非常容易：

```
from pygccxml.declarations import call_invocation

def test_is_call_invocation(call):
    if call_invocation.is_call_invocation(call):
        print call_invocation.name(call)
        for arg in call_invocation.args(call):
            print "   ",arg
    else:
        print "not a function invocation" 
```

我找不到的是获取解析文件的调用的方法：

```
from pygccxml import parser
from pygccxml import declarations

decls = parser.parse( ['main.cpp'] )
# ... 
```

有没有办法使用 pygccxml 包找到对某个函数的调用？
或者，也许那个包对于我正在尝试做的事情来说是一种过度杀伤力:) 还有一种更简单的方法？恐怕用正则表达式查找函数调用比乍一看要复杂得多......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T09:56:52.583

XML-GCC 不能这样做，因为它只报告数据类型（和函数签名）。它忽略了函数体。要看到这一点，请创建 a.cc：

```
void foo()
{}

void bar()
{
        foo();
} 
```

然后运行`gccxml a.cc -fxml=a.xml`。查看生成的 a.xml，发现 foo（或其 id）的唯一提及是在 foo 的声明中。

[codeviz ( http://www.csn.ul.ie/~mel/projects/codeviz/](http://www.csn.ul.ie/~mel/projects/codeviz/) )中可能提供了替代方案。它由 gcc 3.4.6 的补丁组成，该补丁生成调用依赖信息 - 以及一些生成 graphviz 输入的 perl 脚本；后者你可以放心地忽略。

作为另一种选择（不需要 gcc 修改），您可以从埃及复制该方法（[http://www.gson.org/egypt/](http://www.gson.org/egypt/)）；这会解析 GCC RTL 转储。它应该适用于任何最近的 GCC，但是，您可能不会调用内联函数。

在任何情况下，使用这些方法，您不会得到对宏的“调用”，但这实际上可能是更好的选择。

# datagridview - 从 BackgroundWorker 将结果“流式传输”到 DataGridView

> ID：252955
> 
> 赞同：2
> 
> 时间：2008-10-31T09:26:52.720
> 
> 标签：datagridview, backgroundworker

有没有办法将一组结果（例如 DataTable）从 BackgroundWorker“流式传输”到 DataGridView。我想要做的是查询数据，并将结果填充到 DataGridView**中**（如 SQL Server Management Studio 中的查询网格结果）。我的第一个想法是使用 BackgroundWorker（以避免 UI 冻结效果），但是当 BackgroundWorker 正在加载结果时，仍然会有一个可感知的“滞后”。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T22:35:44.543

你可以：

将 DataGridView 绑定到最初为空的 DataTable。

然后，在您的工作线程中，使用线程安全集合（例如同步队列）并调用 Control.BeginInvoke 将记录信息传递给 UI 线程。

在 UI 线程中，您将从队列中拉出项目并将相应的行添加到 DataTable。通过数据绑定的魔力，这些将被添加到网格视图中。

但是，通过使用多线程，您会立即使您的程序更容易被破坏！我还没有尝试过这个特定的方案，并且不知道在将项目添加到 GridView 时是否会有效地使其无法使用。我已经使用多线程填充了一个树视图，这确实是一个很酷的效果。但是，我最终禁用了该功能，因为它引入了错误，因为它不是一个完全正确的实现来处理所有可能的用户交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T23:13:39.397

我*已经*尝试过了，并且做到了这一点。应用程序和架构是在我来公司之前完成的，我所做的就是让它“分页”和异步。

他们有一个已经有分页的存储过程......所以我所做的是，在第一次请求时，发回总结果的“大小”（以及 page1 的数据）。

在客户端，我将空白行添加到 DataTable...（空白，“RowNumber”字段除外）*。*

在进一步的数据页面（异步接收）上，我会得到 rows[X]，将它的“ItemArray”设置为新数组，然后更新我的网格。例子：

```
myDataGridView.Rows[rowNumber].SetValues(valuesFromNewPage); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T22:13:27.207

如果您只有一个可以修改底层集合的线程，这会更好。我有一个只读 DGV，因此添加/删除行的唯一方法是操作底层 BindingSource。我有一个同步线程，它定期从 BindingSource 添加/删除项目。

我确实必须做一件“棘手”的事情——如果要更新的项目是选定的项目，你不能只说

```
myBindingSource[n] = newItem; 
```

而是您必须将新项目中的值深度复制到现有项目中。否则，您将触发“已更改”事件，该事件将重绘绑定到您的数据源的任何其他内容。当我做参考副本时，我得到了一个明显的闪烁，切换到深拷贝（仅适用于当前项目）修复了它。

当然，如果您让用户直接从表单中修改数据，而不是将其用作只读视图，那么您将打开一个全新的（丑陋的！）蠕虫罐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T14:59:04.107

如果该过程需要 2 秒或更短的时间，那么我会显示一个“忙碌”光标并进行内联更新。这有两个原因：

*   开始只需几秒钟的操作的人在操作完成时仍将处于“集中”思维模式。潜意识里，他仍在等待行动的结果，还没有将他的有意识的大脑从那个特定的焦点上转移出来（只要应用程序显示“忙碌”信号）。

*   鉴于上述情况，我不认为多线程的认知开销以及随之而来的危险是值得承担的。

如果该过程最多需要 5 秒，那么我会首先集中精力将其减少到 2 秒或更短。同样，专注于提高性能（例如，通过在 SQL 中分页）通常比引入多线程要容易得多。即使使用**BackgroundWorker**类型，多线程中涉及的非顺序交互仍然难以分析和确保安全。

如果您发现无法将延迟减少到 2 秒或更短，那么您可以采用类似 confuzatron 推荐的技术。但即便如此，您可能仍希望向最终用户显示进度对话框，因为他**将**在等待超过 2 秒后进行上下文切换。进度对话框为他提供了易于吸收的信息，说明他何时可以切换回专注于您的上下文。

# ftp - 是否可以使用文件模式进行 mget 仅下载某些文件？

> ID：252957
> 
> 赞同：1
> 
> 时间：2008-10-31T09:27:29.367
> 
> 标签：ftp, shell

我知道我们可以像 mget *.xml 这样下载所有 xml 文件。但是我们怎么可能使用具有某些文件名模式的mget。我们可以做类似 *SS.xml 的事情，这意味着它将下载所有以 SS.xml 结尾的文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T09:32:35.657

你的意思是`mget`FTP中的命令吗？

是的，这应该是可能的，特别是如果远程服务器是 Unix 服务器，其中文件扩展名在服务器上没有特殊含义，它们只是文件名的另一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-22T20:58:11.857

尝试将 ncftp 用于 ftp 客户端。用户界面更友好，可能有更好的通配符支持。如果您正在尝试编写一个程序来自动下载，Expect 是 TCL 的一种编程语言扩展，旨在自动执行交互式任务。

# web-services - 如何使用 Kerberos 身份验证从 ac# 客户端调用 Sharepoint Webservice？

> ID：252961
> 
> 赞同：4
> 
> 时间：2008-10-31T09:32:52.070
> 
> 标签：web-services, sharepoint, kerberos

我们开发了一个 Web 服务，它位于共享点站点的上下文中并在其中运行。使用普通的 Windows 身份验证可以正常工作。

我们现在有一个客户想要在启用 Kerberos 的共享点站点上安装它。我们需要对 webserivce、调用客户端（Windows 服务）或两者都进行哪些更改以启用此功能...？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T12:00:24.967

这是在内网吗？

如果是这样，并且您的客户端已经将 Windows 凭据传递给 Web 服务，那么您不需要做任何额外的工作。

如果您没有传递 Windows 凭据，请按以下步骤操作：

```
WebServiceProxy proxy = new WebServiceProxy(); // Derived from SoapHttpClientProtocol

proxy.Credentials = CredentialCache.DefaultCredentials; 
```

此方法适用于 NTLM 和 Kerberos 身份验证。它将传递运行代码的 Windows 帐户的凭据。

# c++ - 从文件中读取 64 位整数字符串

> ID：252962
> 
> 赞同：3
> 
> 时间：2008-10-31T09:32:59.510
> 
> 标签：c++, parsing, 64-bit, integer

我们有一个文件，其中有一个 64 位整数作为字符串。我们如何 scanf() 或以其他方式将此数字字符串解析为 C++ 中的无符号 64 位整数类型？

我们知道诸如 %lld 之类的东西，但是执行此解析的许多方法似乎会破坏不同编译器和标准库下的编译。代码应该在 gcc 和 Microsoft C++ 编译器下编译（当然完全符合标准将是一个加号）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T10:45:30.550

GCC 很长，C++0x 的编译器也很长。MSVC++（还没有），但确实有它的 __int64 你可以使用。

```
#if (__cplusplus > 199711L) || defined(__GNUG__)
    typedef unsigned long long uint_64_t;
#elif defined(_MSC_VER) || defined(__BORLANDC__) 
    typedef unsigned __int64 uint_64_t;
#else
#error "Please define uint_64_t"
#endif

uint_64_t foo;

std::fstream fstm( "file.txt" );
fstm >> foo; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T09:47:51.057

Alnitak 建议使用`strtoull()`，但似乎[在 Win32](http://social.msdn.microsoft.com/forums/en-US/vclanguage/thread/d69a6afe-6558-4913-afb0-616f00805229/)环境中不可用。链接到的论坛主题推荐`_strtoui64()`,`_wcstoui64()`和`_tcstoui64()`作为替代品。也许这是无法通过单个可移植函数调用真正完成的事情的“边缘”，您可能需要为不同的平台实现不同的代码路径。或者，我猜，编写自己的 ASCII 到 64 位转换器，这不是火箭科学。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T10:22:02.657

或者使用 istream 的类型安全...

```
 using namespace std;

  // construct a number -- generate test data
  long long llOut = 0x1000000000000000;
  stringstream sout;
  // write the number
  sout << llOut;
  string snumber = sout.str();
  // construct an istream containing a number
  stringstream sin( snumber );

  // read the number -- the crucial bit
  long long llIn(0);
  sin >> llIn; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T10:24:22.077

```
std::fstream fstm( "file.txt" );
__int64 foo;
fstm >> foo; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T09:36:40.643

不要使用`scanf()`，单独标记您的输入，然后使用`strtoull()`或类似的。

# gridview - 如何在 gridview 中使用超链接按钮？

> ID：252963
> 
> 赞同：0
> 
> 时间：2008-10-31T09:36:07.227
> 
> 标签：gridview, hyperlink

如何在 gridview 中使用超链接按钮。我的意思是当我运行我的程序时，所有数据都显示在gridview中，但我想要gridview中的超链接，这样当我点击超链接时，它将显示gridview中的选择路径：如果有pdf文件路径，我只是单击此超链接，然后我可以看到 pdf 文件。

你能告诉我我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T09:51:00.270

您需要使用模板字段。例如，假设您的列名为“PdfUrl”

然后将一列添加到您的数据网格。看起来像

```
<asp:TemplateField HeaderText="Link" SortExpression="PdfUrl">
    <itemtemplate>
        <asp:HyperLink runat="server" ID="hlkPDF" NavigateURL='<%# DataBinder.Eval(Container.DataItem, "PdfUrl") %>' />
    </itemtemplate>
</asp:TemplateField> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T17:11:31.440

这是我会做的

" SelectCommand="SELECT * FROM [客户]">

然后对于 test.aspx 页面，我将有一个像这样的数据源

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:BlissConnectionString %>" 
    SelectCommand="SELECT * FROM [Customers] WHERE CustomerID = @ID">
    <SelectParameters>
        <asp:QueryStringParameter Name="ID" QueryStringField="ID" />
    </SelectParameters>
</asp:SqlDataSource>
<br />
<asp:DetailsView ID="DetailsView1" runat="server" AutoGenerateRows="False" 
    DataKeyNames="CustomerID" DataSourceID="SqlDataSource1" Height="50px" 
    Width="125px">
    <Fields>
        <asp:BoundField DataField="CustomerID" HeaderText="CustomerID" 
            InsertVisible="False" ReadOnly="True" SortExpression="CustomerID" />
        <asp:BoundField DataField="CustomerName" HeaderText="CustomerName" 
            SortExpression="CustomerName" />
        <asp:BoundField DataField="CustomerAddress" HeaderText="CustomerAddress" 
            SortExpression="CustomerAddress" />
        <asp:BoundField DataField="CustomerPhone" HeaderText="CustomerPhone" 
            SortExpression="CustomerPhone" />
        <asp:BoundField DataField="CustomerEmail" HeaderText="CustomerEmail" 
            SortExpression="CustomerEmail" />
    </Fields>
</asp:DetailsView> 
```

完全未经测试，但希望这可以帮助你。

问候

利亚姆

# windows - 为什么 Windows 命令提示符与批处理文件的编码之间存在差异？

> ID：252970
> 
> 赞同：9
> 
> 时间：2008-10-31T09:41:47.027
> 
> 标签：windows, encoding, batch-file, command-prompt

例如，假设我有一个名为的批处理文件`'test.cmd'`，它只包含：

```
echo %1 
```

我可以直接从命令提示符调用它，结果是打印`'test.cmd some¬arg'`了字符串。`'some¬arg'`

但是，如果我将相同的调用放在第二个批处理文件中，`'tester.cmd'`为了参数而调用，并且我从命令提示符调用它，结果`'some%arg'`是打印了字符串。

是什么弄乱了编码，我该如何解决？我确定我以前解决过这个问题，但我不记得是如何...

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T10:00:39.970

这是因为您的批处理文件的编码与 cmd.exe 当前所在的代码页不同。

在西方默认配置中， cmd.exe 在[CP850](http://en.wikipedia.org/wiki/Codepage_850)中启动，但文本编辑器通常在[CP1252](http://en.wikipedia.org/wiki/Codepage_1252)中工作（通常被错误地称为 Latin-1 或 ISO-8859-1）。

字符“¬”和“¼”在这两个代码页“BC”中共享相同的字符代码。

解决方案很简单。在代码页 850 中对批处理文件进行编码，或者通过发出`chcp 1252`.

# sql - 数据库的动态修补

> ID：252972
> 
> 赞同：0
> 
> 时间：2008-10-31T09:42:01.037
> 
> 标签：sql, sql-server, database

请原谅我的长问题。我有一个设计想法，我可以使用一些评论。这样做是个好主意吗？我应该注意哪些坑洼？还有其他更好的类似实现吗？

**我的情况如下：**
我正在重写连接到 SQL 2008（以前是 SQL 2005）服务器的 Windows 窗体应用程序。该应用程序是一家工程公司的“专家系统”，我们在其中存储有关建筑的结构化数据。我们可以控制客户端软件的所有安装，我们没有外部客户或用户，他们都是公司内部的，并且他们都被信任不会对软件或数据库做任何恶意的事情。

当前的设计没有太多的表（大约 10 - 20 个），但其中一些有数百万条记录，属于数百个结构。到目前为止，系统性能还可以，但随着我们不断突破设计的极限，它开始下降。

作为重写的一部分，我正在考虑将数据库拆分为一个主数据库和几个“子”数据库，每个数据库都描述一个结构。每个子数据库应该具有相同的设计。这应该消除我们今天看到的性能问题，因为存储在每个数据库中的数据将不到总数据量的百分之一。

我担心的是，我们现在将获得数百个必须保持最新的数据库，而不是维护一个数据库。该系统随着公司需求的变化而不断发展（您知道它是如何变化的），而当我们试图减少变化的数量时，变化将会到来。因此，我们需要一个系统来跟踪对系统所做的所有数据库更改，以便将它们应用于子数据库。更新客户端应用程序不会有问题，我们可以很好地控制这方面。

我正在考虑一个更改跟踪系统，我们将数据库脚本存储在主数据库中的表中的所有更改。然后我们可以给每个更改一个版本号，我们可以在每个子数据库中存储一个当前版本号。当客户端程序连接到子数据库时，我们可以根据主数据库的当前版本号检查数据库的版本号，如果有版本号大于子数据库版本号的补丁，我们运行这些补丁并更新子数据库到最新版本。

在我看来，这应该很好用。对系统的任何更改都将首先经过测试和验证，然后才能作为新版本的数据库提交。然后，更改将在用户第一次打开数据库时应用到数据库。我想我们会在应用更改时以独占模式打开数据库，但只要更改不太频繁，这应该不是问题。

所以你怎么看？这行得通吗？你们中有人做过类似的事情吗？我们是否应该放弃解决方案并转而采用单片系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T12:29:48.963

您是否考虑过通过“构造”对大表进行*分区*？这可以通过跨文件/物理设备拆分表的存储来缓解一些成长的痛苦，而无需更改您的应用程序。

添加主轴（更多驱动器）并执行几个小时的 DBA 工作通常比修改/调整软件更便宜。

否则，我会同意@heikogerlach 和这些类似的帖子：

[如何对我的 ms sql 数据库进行版本控制](https://stackoverflow.com/questions/173/how-do-i-version-my-ms-sql-database-in-svn)

[跟踪数据库架构更改的机制](https://stackoverflow.com/questions/1607/mechanisms-for-tracking-db-schema-changes)

[您如何管理开发、测试和生产中的数据库？](https://stackoverflow.com/questions/6371/how-do-you-manage-databases-in-development-test-and-production)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T10:14:01.130

虽然我使用 MySQL，但我在这里也有类似的情况。每个数据库都有一个版本表，其中包含版本（只是一个整数）和此版本中更改内容的简短注释。我使用脚本来更新数据库。每个数据库更改都可以在一个函数中进行，或者有时一个更改由多个函数进行。函数在函数名称中包含版本号。该脚本在数据库中查找最高版本号，并按顺序仅应用具有更高版本号的函数。

这使得更新数据库变得容易（只需添加新的更改功能）并允许我在必要时快速升级恢复的数据库（只需再次运行脚本）。

即使在此之前测试更改也允许防御性更改。如果您在桌子上进行了一些重大更改并且想要安全地使用它：

```
def change103(...):
    "Create new table."
def change104(...):
    """Transfer data from old table to new table and make
       complicated changes in the process.
    """
def change105(...):
    "Drop old table"
def change106(...):
    "Rename new table to old table" 
```

如果在 change104() 中出现问题（并引发异常），您可以简单地从新表中删除已转换的数据，修复您的更改函数并再次运行脚本。

但我不认为在客户端连接时动态更改数据库是一个好主意。有时更改可能需要一些时间。并且访问数据库的软件应该与数据库的模式相匹配。您必须以某种方式使它们保持同步。也许您可以分发一个新的软件版本，然后您想在客户实际开始使用这个新软件时升级数据库。但我还没有尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T21:25:54.917

最好不要创建额外的数据库。乍一看，您可能认为您会获得一些性能提升，但实际上您会遇到支持噩梦。请记住 - 什么会破裂，迟早会破裂。

在单个数据库中执行和优化查询要简单得多。在单个数据库中管理用户权限要容易得多。为单个数据库进行一致的备份要容易得多。

就像 KenG 说的，如果你需要打破你的大表 - 考虑对它们进行分区。并添加一些驱动器:)

但首先在您的数据库上运行 SQL 分析器并优化索引和查询。处理几百万行通常不是什么大问题（除非您的客户需要*活*的总数超过一半，在这种情况下，没有分区可以提供帮助）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T22:18:12.003

我知道这是一个疯狂的答案，但它就在这里......

我目前有一个类似的场景，我需要为使用 MS SQL Server 的系统控制多个位置的数据库版本。

我现在正在做的是使用 Ruby on Rails ActiveRecord 迁移来控制数据库版本。是的，我知道我们正在谈论 Windows 系统，但这对我来说很好。（顺便说一下，我的系统是用 VB 和 .NET 编写的）

我已经在每台服务器上安装了 Rails，当我需要更新数据库架构时，我将迁移文件复制到服务器并运行 rake db:migrate 将数据库更新到最新版本或将其回滚到所需版本。

作为副作用，您将拥有一组数据库模式的迁移文件，使用数据库独立语言（在本例中为 ruby​​），您可以将其应用于其他数据库引擎，并且您也可以将其置于源代码控制之下。

我知道这是一个奇怪的解决方案，其中使用了完全不同的技术，但学习新方法并没有什么坏处。您可以[在此处](http://guides.rails.info/migrations.html)找到更多信息。

自从我学习了 Ruby on Rails 后，我成为了一名更好的 .Net 程序员。我在这里问过一个关于这种方法的[问题。](https://stackoverflow.com/questions/190160/how-do-i-create-the-migrations-for-a-legacy-database)

# c# - 使用 Silverlight 隔离存储来保存身份验证令牌？

> ID：252974
> 
> 赞同：2
> 
> 时间：2008-10-31T09:45:00.283
> 
> 标签：c#, .net, silverlight, security

我想听听一些关于在 Silverlight 中使用隔离存储来存储敏感数据的意见。例如，是否可以在此存储中存储身份验证令牌（一些标识服务器端会话的 GUID），还是使用 cookie 更好？

与 cookie 相比，隔离存储的优势在于它可以跨浏览器共享，但处理过期可能更困难，并且可能存在一些我不知道的其他问题（安全性？）。

那么……你的意见是什么？或者您知道有关该主题的任何精彩文章吗？

谢谢，雅各布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T10:39:47.910

我刚刚开始了一个 Silverlight 项目，该项目使用独立存储来存储登录令牌，当应用程序是用 ASP.NET 编写时，该登录令牌以前存储在 cookie 中。

我注意到最终结果的唯一一件事是每种类型的浏览器都会记住同一个用户（与 cookie 解决方案相反，每个浏览器都有自己的 cookie 存储并且它自己知道谁登录了）。

安全性不会有太大的不同——如果你愿意的话——加密令牌。虽然真的你为什么要打扰？如果任何进程可以访问一个人的私有 AppData，他们将可以访问各种机密信息。

该应用程序的 url 决定了访问权限，因此除非您的域名过期，否则没有人可以获取数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T14:04:39.380

除了在多个浏览器实例之间共享令牌的优势（我个人从未见过需要）之外，我想我现在会坚持使用 cookie。为什么？因为它们得到了代理服务器和 HTTP 加速器等中介的更好支持。一般来说，我采用“使用标准”而不是“自己动手”的方法——这样可以减少需要维护的代码，并为新开发人员提供更熟悉的代码。

# sql - django中的完全外连接

> ID：252976
> 
> 赞同：12
> 
> 时间：2008-10-31T09:46:55.880
> 
> 标签：sql, django, outer-join

如何使用 django QuerySet API 创建跨 M2M 关系芯片的完全外部联接的查询？

它不受支持，欢迎提出一些关于创建我自己的经理来执行此操作的提示。

**编辑添加：** @S.Lott：感谢您的启发。对 OUTER JOIN 的需求来自应用程序。它必须生成一个显示输入数据的报告，即使它仍然不完整。我不知道结果将是一个新的类/模型。你的提示会对我有很大帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-31T10:23:19.783

Django 不支持通常 SQL 意义上的“连接”——它支持对象导航。

请注意，关系连接（内部或外部）创建了一个新的实体“类”。一个在 Django 中没有定义的。所以没有适当的“结果集”，因为你返回的东西没有类定义。您可以做的最好的事情是定义一个元组，它将与 None 一起用于缺少的组合。

左（或右）外连接看起来像这样。它创建了两个不相交的子集，一个有一组相关实体，另一个没有。

```
for obj in Model1.objects.all():
    if obj.model2_set().count() == 0:
        # process (obj, None) -- no Model2 association
    else:
        for obj2 in obj.model2_set.all():
            # process (obj, obj2) -- the "inner join" result 
```

“完整”外部联接是没有关系的剩余项目的联合。

```
for obj2 in Model2.objects.all():
    if obj2.model1_set().count() == 0:
        # process (None, obj2) -- no Model1 association 
```

问题始终是，你对这个由三个不同对象子集组成的奇怪集合做了什么处理？

对象数据库的重点是将处理集中在对象及其关联对象上。

称为“关系连接”的特殊集合从未出现在原始对象模型中。它是由两个（或更多）原始对象构建的一类新对象。

更糟糕的是，外连接会创建一个包含多个子类（内连接、左外连接和右外连接）的集合。那一堆东西是什么**意思**？

等等，情况可能会变得更糟。如果处理包括对缺失属性的检查（即`if someObj.anObj2attribute is None`：我们本质上是在寻找`Model1`没有`Model2`关联对象的项目。嗯......为什么我们将它们放在外部连接中，只是为了使用`if`语句过滤它们？为什么不直接做单独的查询和正确处理每个子集？

* * *

Edit: When you're showing "incomplete" status, it isn't an outer-join at all. It's much simpler. You need to create one (or two) separate collections in your view function for your template to display.

First, you should use status codes, not the presence or absence of a foreign key. Optional foreign keys don't have "reasons" -- they're either there or not there. A status code can provide useful shades of meaning ("incomplete", "in error", "broken", "not applicable", "to be deleted", etc.)

```
errorList1 = Model1.objects.filter( status="Incomplete" )
errorList2 = Model2.objects.filter( status="Incomplete" ) 
```

These two are the two non-join parts of a full outer join. You can then display these two error lists in your template with appropriate column titles and status codes and everything.

You can even put them into a single table to mimic the old full outer join report people used to see

```
<table>
    <tr><th>Model1</th><th>Model2</th></tr>
    {% for e1 in errorList1 %}
    <tr><td>e1</td><td>NULL</td></tr>
    {% endfor %}
    {% for e2 in errorList2 %}
    <tr><td>NULL</td><td>e2</td></tr>
    {% endfor %}
</table> 
```

Looks like a full outer join report. Without the full outer join.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-12T01:14:01.783

Colin, one of the guys I work with, wrote a post awhile back about doing custom joins in Django:

[http://www.caktusgroup.com/blog/2009/09/28/custom-joins-with-djangos-queryjoin/](http://www.caktusgroup.com/blog/2009/09/28/custom-joins-with-djangos-queryjoin/)

You might be able to find something useful there!

# algorithm - 计算算法时间复杂度的资源

> ID：252985
> 
> 赞同：12
> 
> 时间：2008-10-31T09:51:50.237
> 
> 标签：algorithm

是否有任何好的资源（书籍、参考资料、网站、应用程序......）来解释如何计算算法的时间复杂度？

因为，很难把事情具体化在我的脑海里。有时它是在谈论一个迭代的时间复杂度为 lg n；然后根据另一个循环它变成 n.lg n; 有时他们使用大欧米茄符号来表达它，有时使用大o等......

这些东西对我来说很抽象。所以，我需要一个有很好解释和很多例子的资源，让我明白发生了什么。

希望我清楚地解释了我的问题。我很确定每个刚开始学习算法的人也和我有同样的问题。所以，也许那些有经验的人也可以和我们分享他们的经验。谢谢...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T10:02:35.583

我认为最好的书是Cormen、Leiserson、Rivest 和 Stein[的《算法导论》 。](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=11866)

这是[亚马逊上的](https://rads.stackoverflow.com/amzn/click/com/0262033844)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T22:28:02.250

伙计们，你们都在推荐真正的复杂性理论书籍——Arora 和 Barak 包含各种各样的东西，比如 PCP、交互式证明、量子计算和关于 Expander 图的主题——大多数程序员/软件开发人员从未听说过或永远不会听说过的东西利用。Papdimitriou 属于同一类别。Knuth 简直无法阅读（我是 CS/数学专业的），并且对事物的运作方式给出了零直觉。

如果您想要一种简单的方法来计算运行时间并获得分析的味道，请尝试 Kleinberg 和 Tardos “算法的设计和分析”的第一章左右，它掌握了基础知识，然后您就可以开始工作了在更难的问题上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-01T23:00:46.487

I agree that [Introduction to Algorithms](http://projects.csail.mit.edu/clrs/) is a good book. For more detailed instructions on e.g. how to solve recurrence relations see Knuth's [Concrete Mathematics](http://en.wikipedia.org/wiki/Concrete_Mathematics). A good book on Computational Complexity itself is the one by [Papadimitriou](http://books.google.com/books?id=HuWVGgAACAAJ&dq=Papadimitriou+complexity&ei=cimGSZH1FqTmyASzzLinDQ). But that last book might be a bit too thorough if you only want to calculate the complexity of given algorithms.

A short overview about big-O/-Omega notation:

*   If you can give an algorithm that solves a problem in time *T(c*(n log n))* (*c* being a constant), than the time complexity of that problem is *O(n log n)*. The big-O gets rid of the *c*, that is any constant factors not depending on the input size *n*. Big-O gives an **upper bound** on the running time, because you have shown (by giving an algorithm) that you can solve the problem in that amount of time.
*   If you can give a proof that any algorithm solving the problem takes at least time *T(c*(n log n))* than the problem is in *Omega(n log n)*. Big-Omega gives a **lower bound** on the problem. In most cases lower bounds are much harder to proof than upper bounds, because you have to show that any possible algorithm for the problem takes at least *T(c*(n log n)*. Knowing a lower bound does **not** mean knowing an algorithm that reaches that lower bound.
*   If you have a lower bound, e.g. *Omega(n log n)*, **and** an algorithm that solves the problem in that time (an upper bound), than the problem is in *Theta(n log n)*. This means an "optimal" algorithm for this problem is known. Of course this notation hides the constant factor *c* which can be quite big (that's why I wrote optimal in quotes).

Note that when using these notations you are usually talking about the worst-case running time of an algorithm.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T10:03:35.143

我在大学读了 Christos Papadimitriou 的**Computational Complexity**并非常喜欢它。这不是一件容易的事，这本书很长，但写得很好（即易于理解且适合自学），并且包含许多有用的知识，而不仅仅是“我如何计算算法 x 的时间复杂度” .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T10:14:04.747

[Wikipedia 中的计算复杂性理论](http://en.wikipedia.org/wiki/Computational_complexity_theory)文章有一个参考列表，包括指向书籍草稿[Computational Complexity: A Modern Approach](http://www.cs.princeton.edu/theory/index.php/Compbook/Draft)的链接，该书是 Sanjeev Arora 和 Boaz Barak 的教科书，剑桥大学出版社。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T04:56:02.610

[离散数学](http://www.mhhe.com/math/advmath/rosen/)课程有时会在[算法介绍](http://projects.csail.mit.edu/clrs/)之前提供。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T10:02:25.957

关于该主题的经典书籍是 Knuth 的[计算机编程艺术](https://rads.stackoverflow.com/amzn/click/com/0201896834)系列。他们很注重理论和形式证明，所以在你解决它们之前复习一下你的微积分。

# c++ - 是否有 C++/Win32/MFC（如 Sparkle）的自动更新框架？

> ID：252986
> 
> 赞同：13
> 
> 时间：2008-10-31T09:51:53.733
> 
> 标签：c++, winapi, mfc, auto-update

我决定将自动更新功能添加到我的一个应用程序中，并正在寻找任何现有的解决方案，将当前运行的版本与随后从网上下载的最新版本进行比较。

我知道Mac OSX 上的[Sparkle](http://sparkle.andymatuschak.org/)非常好用且功能强大，但想知道 Win32/MFC 是否有类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-02-25T07:25:55.040

我刚刚偶然发现了[WinSparkle](http://winsparkle.org/)，这是一个早期阶段，但看起来很有希望。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-14T22:46:56.370

我发现了另外两个旨在解决此问题的项目：http: [//sevenupdate.sourceforge.net/](http://sevenupdate.sourceforge.net/)和[Google 的 Omaha](http://code.google.com/p/omaha/)，但尚不清楚它们是否有任何外部用户，所以这个问题显然仍然存在。我也在寻找解决方案......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:27:08.763

我从未使用过它，但 WiX 提供[ClickThrough](http://wix.sourceforge.net/clickthrough.html)。也许值得一瞧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-16T13:14:43.873

有一个受 Debian Linux 的 APT 启发的开源项目[WIPT 。](http://www.acm.uiuc.edu/sigwin/)然而，这个项目似乎被放弃了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T20:12:03.337

我假设您已经了解[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)？我不确定它是否与 MFC 兼容，但后来我找到[了这篇文章](http://www.codeproject.com/KB/install/MfcClickOnce.aspx)，所以如果这是您要问的问题，那么 ClickOnce 可以尝试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-15T22:52:49.223

[AbstractSpoon 从这里](http://www.powerprogrammer.co.uk/)使用“软件更新向导”来开发他们很棒的 ToDoList MFC 应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-05T22:42:57.053

另一个 .NET：[SparkleDotNet](http://bitbucket.org/ikenndac/sparkledotnet/wiki/Home)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-10-31T16:34:21.967

通常不会，Windows 以无法替换正在运行的程序的方式映射 DLL（您自己的或 MFC）之类的东西。msi 安装程序检查 VERSIONINFO 并且不会覆盖具有相同（或更新版本）的已安装文件，但您必须退出 runnign 实例。

# sql-server - 如何获取数据库和表名

> ID：252988
> 
> 赞同：0
> 
> 时间：2008-10-31T09:53:30.670
> 
> 标签：sql-server

如何将所有数据库名称和相应的表名称放在一起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T10:19:30.370

```
CREATE TABLE #dbs ( DatabaseName VARCHAR(256), TableName VARCHAR(256) )

EXEC sp_msforeachdb 'INSERT INTO #dbs
    SELECT ''?'', [name] FROM dbo.SysObjects WHERE XType = ''U'''

SELECT * FROM #dbs
DROP TABLE #dbs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T10:02:15.147

您将不得不编写一个存储过程。

首先获取数据库名称

```
SELECT Name FROM master.sys.databases 
```

对于每个数据库

```
SELECT %DatabaseName%, Name FROM %DatabaseName%.SysObjects WHERE type = 'U' 
```

编辑这里的存储过程

```
CREATE PROCEDURE sp_GetDatabasesTables 
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;
CREATE TABLE #schema ( DatabaseName VarChar(50), TableName VarChar(50) );
DECLARE @DatabaseName varchar(50);
DECLARE cursorDatabase CURSOR FOR
    SELECT Name FROM master.sys.databases WHERE Name NOT IN ('tempdb'); -- add any table you want to filter here

OPEN cursorDatabase;

-- Perform the first fetch.
FETCH NEXT FROM cursorDatabase INTO @DatabaseName;

-- Check @@FETCH_STATUS to see if there are any more rows to fetch.
WHILE @@FETCH_STATUS = 0
BEGIN
    EXEC ('INSERT INTO #schema (DatabaseName, TableName) SELECT ''' + @DatabaseName + ''' AS DatabaseName, Name As TableName FROM ' + @DatabaseName + '.sys.SysObjects WHERE type = ''U'';');
    FETCH NEXT FROM cursorDatabase INTO @DatabaseName;
END

CLOSE cursorDatabase;
DEALLOCATE cursorDatabase;
SELECT * FROM #schema
END 
```

# graphics - 当相机不断移动时在 Direct3D 视图矩阵中定义向上

> ID：252991
> 
> 赞同：1
> 
> 时间：2008-10-31T09:55:00.277
> 
> 标签：graphics, geometry, direct3d

在我的 Direct3D 应用程序中，可以使用鼠标或箭头键移动相机。但是，如果我将 (0,1,0) 硬编码为 中的向上方向向量`LookAtLH`，则该帧在相机的某些方向上会变为空白。

我刚刚了解到，当沿 Y 轴看时，(0,1,0) 不再作为向上方向工作（似乎很明显？）。对于这些特殊情况，我正在考虑将我的向上方向切换到其他方向。有没有更优雅的方法来处理这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T11:06:33.410

假设您可以计算一个指向前方的向量（您正在查看的内容 - 您的位置）和一个指向右侧的向量（除非您可以滚动，否则始终在 XZ 平面上）。对这两个向量进行归一化，然后向上 x 向右（其中 x 是叉积）。

通常，您可以将偏航、俯仰和滚动插入旋转矩阵并旋转轴矢量以向右、向上和向前，但我想这就是您使用 LookAtLH 来避免的。

见[http://en.wikipedia.org/wiki/Rotation_matrix#The_3-dimensional_rotation_matricies](http://en.wikipedia.org/wiki/Rotation_matrix#The_3-dimensional_rotation_matricies)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T00:04:08.340

处理这个问题的优雅方法是使用 Unit Quaternions。四元数是 4 个值的向量，它编码 3D 空间中的方向（不是某些文章声称的旋转），单位四元数是向量长度 sqrt(x^2+y^2+z^2+w^ 2) 为 1.0。有一组用于处理四元数的数学运算，类似于使用矩阵对旋转进行编码，另外还有一个好处是四元数永远不能表示退化的方向。当您需要将结果提供给 GPU 时，您可以自由地将四元数转换为 3x3 或 4x4 矩阵。

你的问题是，当你移动你的相机时，你会在相机的向上方向引入一点扭曲。通过强制相机在每次迭代时将自身重新定位在 (0,1,0) 向量上，实际上是在旋转相机，然后夹紧相机的方向以保持在球体的表面上，但是当您的相机碰到这个球体的极点没有很好的方向来调用“向上”，并且您的矩阵变为奇异并为您提供零大小的多边形（因此是黑屏）。四元数有能力通过这些极点进行插值并很好地从另一边出来，让您始终拥有一个有效的矩阵。你所要做的就是控制“扭曲”。

要测量这种扭曲，您应该阅读《Graphics Gems 4》一书中 Ken Shoemake 的文章“减少光纤束扭曲”。他展示了一种测量这种累积扭曲的好方法，以及如何在它令人反感时将其移除。

# excel - Excel for Office 2007 和 Vista SP1 的可靠实数值生成器

> ID：252999
> 
> 赞同：0
> 
> 时间：2008-10-31T09:58:43.563
> 
> 标签：excel, excel-2007, random

您能告诉我您使用哪个加载项在 Excel 2007（在 Vista SP1 上运行）中生成实数/整数值吗？我已经尝试了其中的几个，尤其是来自 AbleBits.com 的 Random Generator，但是在此处输入最低和最高值时存在一些问题。我猜这是由于 Office 2007 和 Vista 配置造成的。

非常欢迎任何建议！

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T10:55:30.063

是什么让您无法使用内置的随机数生成器功能？

来自 Excel 文档：

> Randomize 语句示例：此示例使用 Randomize 语句来初始化随机数生成器。由于省略了 number 参数，因此 Randomize 使用 Timer 函数的返回值作为新的种子值。

```
Dim MyValue
Randomize    ' Initialize random-number generator. '

MyValue = Int((6 * Rnd) + 1)    ' Generate random value between 1 and 6\. ' 
```

如果您不会/不能使用 VBA，详细*说明*您想使用的内容将是一件好事。

编辑：

还有一个单元函数（“RAND”）可用，做同样的事情。*************