# StackOverflow 问答 10950000-10950999

# android - 如何在android的表格行中放置自定义视图？

> ID：10950009
> 
> 赞同：0
> 
> 时间：2012-06-08T13:41:59.523
> 
> 标签：android

我正在以编程方式创建表行，并且我想将我之前创建的视图放在一行中。有什么办法吗？

```
 for ( current = 0; current < rapor1.length; current++)
    {

        TableRow tr = new TableRow(this);
        tr.setId(100+current);
        tr.setLayoutParams(new LayoutParams(
                LayoutParams.FILL_PARENT,
                LayoutParams.WRAP_CONTENT));   

        TextView f1 = new TextView(this);
        f1.setId(200+current);
        f1.setText(rapor1[current]);
        f1.setTextColor(Color.BLACK);
        f1.setWidth(100);
        tr.addView(f1);

       DrawView dv = new DrawView(this);
        tr.addView(dv); 
```

它应该可以工作，但是出了点问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:52:16.880

我认为这可能会有所帮助。只需更改此字符串：

```
tr.setLayoutParams(new TableRow.LayoutParams(
TableRow.LayoutParams.FILL_PARENT,
TableRow.LayoutParams.WRAP_CONTENT)); 
```

当然，您需要将 LayoutParams 设置为要在屏幕上显示的任何视图

# facebook-graph-api - Facebook graph api post使用“/me/feed”与“/me/links”

> ID：10950012
> 
> 赞同：4
> 
> 时间：2012-06-08T13:42:11.180
> 
> 标签：facebook-graph-api

我最近将我的代码从 https://graph.facebook.com/[profile_id]/feed 切换到 https://graph.facebook.com/[profile_id]/links

现在我遇到了这个问题，有人可以帮忙吗？- 我在帖子中附带的图片没有显示，看起来 facebook 默认使用它在链接页面上找到的第一张图片

[http://developers.facebook.com/docs/reference/api/post/](http://developers.facebook.com/docs/reference/api/post/) http://developers.facebook.com/docs/reference/api/link/

这两个文件都允许我指定图片，但不知何故，“链接”没有显示图像。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:06:07.107

设置正确的 Open Graph 元标记，尤其是 og:image。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T05:51:06.030

关于在我的 Android 应用上分享我正在使用此代码：

```
Bundle postParams = new Bundle();
postParams.putString("message", "User's custom message above share content");
postParams.putString("name", "The name of the link attachment.");
postParams.putString("description", "The description of the link (appears beneath the link caption). If not specified, this field is automatically populated by information scraped from the link, typically the title of the page.");
postParams.putString("caption","The caption of the link (appears beneath the link name). If not specified, this field is automatically populated with the URL of the link.");
postParams.putString("picture","The URL of a picture attached to this post. The picture must be at least 200px by 200px. See our documentation on sharing best practices for more information on sizes.");
postParams.putString("link", "The link attached to this post"); 
```

详细参考文档：[https ://developers.facebook.com/docs/sharing/reference/feed-dialog/v2.3](https://developers.facebook.com/docs/sharing/reference/feed-dialog/v2.3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-14T09:34:43.247

我刚刚解决了类似的问题，在网站上发布了新闻并通过 /links 发布到 fanpage，在帖子中解决了错误的图像内容和“找不到网站”标题。

该问题与错误的代码序列有关。我们在不太好的地方通过 fb api 发布新闻。该帖子应该已经可用，但它不是并且发布到 fb api 会导致 facebookexternalhit 机器人立即请求检查它是否存在。详细的日志分析表明，来自 facebook 的 ping 是在 POST 添加新闻之前完成的，这就是我们在那里弄乱内容的原因。

我们发布的示例内容，如果我上面描述的不是你的情况： content_dict = {

'图片': ' [http://www.czerwonysmok.pl/static/media/uploads/blog/pb_reddragon_all2_poprawiony_czerwony.jpg/](http://www.czerwonysmok.pl/static/media/uploads/blog/pb_reddragon_all2_poprawiony_czerwony.jpg/) ',

'message': '标题\n\n contentcontentcontentcontentcontentcontentcontent',

'链接'：' [http://www.czerwony-smok.pl/klub/aktualnosci/rashguard-ze-strony/](http://www.czerwony-smok.pl/klub/aktualnosci/rashguard-ze-strony/) '}

```
try:
    logger.info("Publishing to facebook: " + str(content_dict))
    graph.post(path="%s/links" % settings.FAN_PAGE_ID, **content_dict) 
```

# asp.net - 自制 SSL 的绿条

> ID：10950014
> 
> 赞同：0
> 
> 时间：2012-06-08T13:42:16.923
> 
> 标签：asp.net, linux, apache, ssl, certificate

因此，考虑到 SSL 的定价，我选择尝试创建自己的 SSL 证书（仍在进行中）。

完成该部分后，如何设置证书的 EV 和绿条方面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:05:27.360

如果您处于用户可以导入您自己的 CA 证书的环境中，那么创建您自己的证书（并使用您自己的 CA）是有意义的，他们可以独立验证它。通常，这在机构的网络上运行良好，在配置集中管理的机器（和类似情况）时，有人安装额外的 CA 证书作为操作系统配置的一部分。在这些条件下，这会给你一个蓝条，没有任何问题。

扩展验证证书（产生绿色条）依赖于两件事：

*   证书中的额外策略属性：从技术上讲，您可以自己定义一些 OID，尽管让其他人识别它显然是个问题。
*   [在浏览器中硬编码的 OID 策略和根证书指纹](https://security.stackexchange.com/a/14064/2435)。

第二点会阻止你自己做。非 EV 证书是您可以通过一些额外的配置步骤在您控制的机器上实现的东西。EV 证书还要求您控制浏览器的编译：这不会发生在专有浏览器（例如 IE）中，而且对于开源浏览器（例如 Firefox/Chromium）来说仍然需要大量工作，因为您将无法依赖预编译的二进制文件（并且您必须为每个新版本自己重新编译它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T13:44:27.167

我认为您可能会发现所有这些好东西（假设您正在谈论浏览器中的挂锁和绿条）取决于认证的另一部分，即证书是由受信任的提供商颁发的事实已验证您的身份 - 您自己可能无法做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T13:47:26.257

SSL 证书的整个想法是，每个人都信任的人（mozilla、microsoft）证明验证者（thawte 等）来证明他们审计的站点（以某种方式）是真实的。这不适用于您的证书，这个想法是信任链。微软信任thawte，他们信任你。在你的情况下没有人信任你，所以你的自签名证书对浏览器没有任何意义。

# wicket - wicket 1.5 中的 IVisitor.CONTINUE TRAVERSAL 的等价物是什么

> ID：10950019
> 
> 赞同：3
> 
> 时间：2012-06-08T13:42:42.613
> 
> 标签：wicket, porting

我正在将我们的 Wicket 1.4 应用程序移植到 Wicket 1.5。现在的游客[很不一样](https://cwiki.apache.org/WICKET/migration-to-wicket-15.html#MigrationtoWicket1.5-Visitors)。我想知道的是如何在 Wicket 1.5 中处理 CONTINUAL_TRAVERSAL？现有的 1.4 代码如下：

```
 public class MyFormVisitor implements IVisitor<Component, Object>, Serializable {

    private static final long serialVersionUID = 7271477325583441433L;
    private Set<Component> visited = new HashSet<Component>();

    @Override
    public Object component(Component c) {
        if (!visited.contains(c)) {
            visited.add(c);

            c.add(new MandatoryBehavior());
            c.add(new ErrorHighlightBehavior());
        }
        return IVisitor.CONTINUE_TRAVERSAL;
   } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T20:13:07.060

只需将您的方法转换为这样的方法，就可以了：

```
@Override
public void component(final Component c, final IVisit<Void> visit) {
    if (!visited.contains(c)) {
        visited.add(c);

        c.add(new MandatoryBehavior());
        c.add(new ErrorHighlightBehavior());
    }
} 
```

正如您在链接的文档中看到的那样，现在通过传递给该方法的[IVisit来控制遍历。](http://wicket.apache.org/apidocs/1.5/org/apache/wicket/util/visit/IVisit.html)如果没有调用停止或不深入的方法，则遍历将继续。

# java - 使用 Java 在控制台中显示印地语

> ID：10950020
> 
> 赞同：5
> 
> 时间：2012-06-08T13:42:43.390
> 
> 标签：java, utf-8

```
StringBuffer contents=new StringBuffer();
BufferedReader input =  new BufferedReader(new FileReader("/home/xyz/abc.txt"));
String line = null; //not declared within while loop
while (( line = input.readLine()) != null){
    contents.append(line);
}
System.out.println(contents.toString()); 
```

文件`abc.txt`包含

```
\u0905\u092d\u0940 \u0938\u092e\u092f \u0939\u0948 \u091c\u0928\u0924\u093e \u091c\u094b \u091a\u093e\u0939\u0924\u0940 \u0939\u0948 \u092 
```

我想使用 Java 在控制台中以印地语显示。

如果我只是这样打印 String str="\u0905\u092d\u0940 \u0938\u092e\u092f \u0939\u0948 \u091c\u0928\u0924\u093e \u091c\u094b \u091a\u093e\u0939\u0929\u0940 \u09 \u0948 \u092";

System.out.println(str);

然后它工作正常，但是当我尝试从文件中读取时它不起作用。

帮帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T14:51:51.397

使用[Apache Commons Lang](http://commons.apache.org/lang/)。

```
import org.apache.commons.lang3.StringEscapeUtils;

// open the file as ASCII, read it into a string, then
String escapedStr; // = "\u0905\u092d\u0940 \u0938\u092e\u092f \u0939\u0948 ..."
// (to include such a string in a Java program you would have to double each \)

String hindiStr = StringEscapeUtils.unescapeJava( escapedStr );

System.out.println(hindiStr); 
```

（确保您的控制台设置为显示印地语（正确的字体等）并且控制台的编码与您的 Java 编码相匹配。上面的 Java 代码只是简单的框架。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T14:02:50.810

您应该将文件中的内容作为`UTF-8`编码的印地语字符存储。例如，在您的情况下，它将是`अभी समय है जनता जो चाहती है`. 也就是说，不是保存 unicode 转义，而是直接保存原始印地语字符。然后，您可以像平常一样简单地阅读。

您只需确保您使用的编辑器使用 UTF-8 编码保存它。看到[西班牙语字符显示不正确？](https://stackoverflow.com/questions/10814692/spanish-language-chars-are-not-displayed-properly/10815108#10815108)

否则，您必须将文件设为`.properties`文件并使用它读取，`java.util.Properties`因为它固有地提供了 unicode 转义支持。

另请[阅读在 java 中读取 unicode 字符](https://stackoverflow.com/questions/3630609/reading-unicode-character-in-java)

# c# - 满足不同网络条件，限制同一用户从不同机器登录

> ID：10950027
> 
> 赞同：1
> 
> 时间：2012-06-08T13:43:04.660
> 
> 标签：c#, asp.net, vb.net

我有一个托管在服务器上的 ASP.Net Web 应用程序。

我想限制同一用户通过网络连接登录不同的机器，但要满足某些条件。

所以我想在 User 表中添加三个新列，这样我们就可以跟踪同一用户是在同一台机器上登录还是在不同机器上登录。

这些列就像：

*   `IsLoggedIn`：检查特定用户是否已经登录。
*   `SessionID`：检查是否打开了相同的用户实例。
*   `IPAddress`：检查同一用户是否在同一台或不同的 PC 上。

这应该满足以下一些条件，但它不能满足其中一些条件。

条件如下：

1.  两台计算机在同一个局域网上。
2.  每台计算机都通过 Internet 从不同位置访问应用程序。
3.  每台计算机都从同一位置通过 Internet 访问应用程序。
4.  托管的某些应用程序意味着仅凭 IP 地址不足以区分不同的计算机。
5.  有些用户只是关闭浏览器而不注销。因此会话可能不会在这种情况下结束。

任何人都可以建议如何完成所有这些条件来满足我的应用程序吗？主要是4号和5号。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:22:03.480

4.  您可以使用 cookie 来识别用户自己登录的机器。据我所知，通过硬件密钥识别计算机是行不通的，因为这将是一个安全问题。更多想法：[如何在 ASP.NET 应用程序中唯一标识客户端计算机？](https://stackoverflow.com/questions/4609316/how-to-uniquely-identify-the-client-machine-in-an-asp-net-application)

5.  例如，您可以让用户在新机器上登录，然后关闭他现有的会话（如果有的话）。甚至会弹出一个问题，例如您要关闭所有其他会话吗？

# c# - BeginInvoke 回调函数

> ID：10950029
> 
> 赞同：2
> 
> 时间：2012-06-08T13:43:11.240
> 
> 标签：c#, .net, winforms, multithreading, .net-4.0

我有 ac# .NET winforms 应用程序进行此异步调用：

```
simpleDelegate.BeginInvoke(null, null); 
```

代表正在调用我的函数，并且一切正常。问题是，在工作线程上的函数完成后，我需要主线程来更新我的 winform 上的一些控件。如果工作线程试图更新这些控件，.NET 就会崩溃。但我需要主线程保持对用户操作的响应，然后仅在工作线程完成调用异步函数后调用我的函数 UpdateFormAfterServerCall()。

如果您能给我一个简洁的代码示例，而不是抽象地解释如何做到这一点，我将不胜感激。我已经阅读了一百个解释，只是无法正确地将它们连接在一起。

注意：在 BeginInvoke 之前我有：

```
simpleDelegate = new MethodInvoker(CallServer); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T13:53:55.197

如果要更新由另一个线程拥有的 GUI，请从不同的线程使用`MethodInvoker`

```
if(control.InvokeRequired)
control.Invoke( (MethodInvoker) ( ()=> updating_function() ) );
else
updating_function(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T13:47:10.850

类`Control`（`Form`也是 a `Control`）有一个[`Invoke`](http://msdn.microsoft.com/en-us/library/zyzhdc6b%28v=vs.90%29.aspx)方法，您可以从任何线程调用它以在 GUI 线程上执行代码。

此外，`Control`它还有一个方便的`InvokeRequired`属性，可以通知您是否已经在 GUI 线程上。例如，您可以在表单中创建以下方法：

```
public class MyForm
{
    // ...
    public void UpdateMe()
    {
        if (InvokeRequired)
        {
            Invoke(new Action(UpdateMe));
            return;
        }

       // Code to update the control, guaranteed to be on the GUI thread
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:54:20.723

您可以使用`BackgroundWorker`：

```
BackgroundWorker bw = new BackgroundWorker();

string result = null;

bw.DoWork += (s, e) =>
{
    // Executes on background thread.
    // UI remains responsive to user activity during this time.
    result = CallServer();
};

bw.RunWorkerCompleted += (s, e) =>
{
    // Executes on UI thread upon completion.
    resultTextBox.Text = result;
};

bw.RunWorkerAsync(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:06:19.870

这是代码示例 [你想要什么] - [http://www.yoda.arachsys.com/csharp/threads/winforms.shtml](http://www.yoda.arachsys.com/csharp/threads/winforms.shtml)

& 你可以在这里阅读所有的异步风格——

[http://msdn.microsoft.com/en-us/library/2e08f6yc(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/2e08f6yc(v=vs.100).aspx)

# asp.net - 使用 IIS 服务器和静态 IP 使网站可在线访问

> ID：10950031
> 
> 赞同：0
> 
> 时间：2012-06-08T13:43:25.250
> 
> 标签：asp.net, iis-7, web-hosting

我有一个带有 IIS 7.0 和静态 IP 的窗口服务器 2008。网站 www.xyz.com（带有端口：http:80 和 https:443）运行良好。现在，我使用相同的 IP 地址但使用端口 http:180 在其上部署了另一个网站。另一个网站在本地运行良好，但无法在网络上访问。

使网站在线的下一步是什么？

问候， 阿曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:50:01.497

应该是这样的。如果您可以使用 本地访问它`http://localhost:180`，则 IIS 正在侦听该端口并且应该为请求提供服务。如果您无法通过 远程访问它`http://the.site.ip.address:180`，我怀疑某处的防火墙正在阻止通过此非标准端口的连接。

# javascript - 如何在 iframe 中使用来自父级的 jquery？

> ID：10950034
> 
> 赞同：14
> 
> 时间：2012-06-08T13:43:34.673
> 
> 标签：javascript, jquery, iframe

我有一个文件，我们称之为 parent-win.html，由域 example.com 提供服务。该文件中包含 jquery。这个页面中嵌入了一个 iframe，我们称之为 iframe-win.html。iframe-win.html 有一个带有 id`form-elem`和 value的表单元素`Hello World!`。现在我在 iframe 中进行跟踪。

```
var jQuery = parent.jQuery;
console.log(jQuery('#form-elem').val()); 
```

根据我对 JS 的有限知识，我应该`Hello World!`在控制台上看到，但我看到的是未定义的。现在，我的问题是我需要在 iframe 中再次加载 jquery 还是可以使用已经加载到父窗口中的 jquery 对象？

请注意，这不是像往常一样从父/iframe 访问 iframe/父内容。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-08T13:51:04.107

在 iframe 中试试这个：

```
if (typeof(jQuery) == "undefined") {
    var iframeBody = document.getElementsByTagName("body")[0];
    var jQuery = function (selector) { return parent.jQuery(selector, iframeBody); };
    var $ = jQuery;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-06-03T03:31:25.810

这是基于 Moin 的回答的更好的解决方案：

```
if (typeof(jQuery) == "undefined") {
    window.jQuery = function (selector) { return parent.jQuery(selector, document); };
    jQuery = parent.$.extend(jQuery, parent.$);
    window.$ = jQuery;
} 
```

所以我们可以使用 $ 的函数，如 $.get、$.extends 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:47:04.777

您需要在`iframe`.

编辑：好的，如果框架不在同一个域上，那么您不必*重新*加载 jQuery。请参阅[从 iframe 访问 jQuery 库](https://stackoverflow.com/questions/5481613/access-jquery-library-from-iframe)

# java - 在 Java 中编码透明动画 gif

> ID：10950041
> 
> 赞同：1
> 
> 时间：2012-06-08T13:44:12.813
> 
> 标签：java, image, transparency, gif, animated-gif

我`GifDecoder`用来读取动画 .gif 文件并`AnimGifEncoder`编写它。（[链接](http://www.fmsware.com/stuff/gif.html)）

如果我显示它们读取的原始帧`GifDecoder`正确显示并且是透明的，但是如果我显示由`AnimatedGifEncoder`透明度创建的帧都是错误的。

```
 GifDecoder gif = new GifDecoder();
   gif.read("image.gif");

   AnimatedGifEncoder e = new AnimatedGifEncoder();
   e.start("newimage.gif");
   e.setTransparent(Color.BLACK);

   for (int i=0;i<gif.getFrameCount();i++) {
        anim.addFrame(gif.getFrame(i));
        anim.setDelay(gif.getDelay(i));
   }

   anim.finish(); 
```

在此示例中，我将透明颜色设置为黑色。但实际上我想从中获取透明颜色信息，`GifDecoder`但我不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T06:42:38.137

我正在使用以下解决方案，尽管缩放后仍有一些 gif 文件一团糟......：

（至少它似乎与大多数不透明的 gif 相处得很好）

```
Color transparentColor = null;
BufferedImage firstFrameImage = ImageIO.read([sourceFileHere]);

if (firstFrameImage.getColorModel() instanceof IndexColorModel) {
   IndexColorModel cm = (IndexColorModel) firstFrameImage.getColorModel();
   int transparentPixel = cm.getTransparentPixel();
   transparentColor = new Color(cm.getRGB(transparentPixel), true);
}

e.setTransparent(transparentColor); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-18T05:05:39.793

这都是很久以前的事了，但当时我确实设法让它工作了。无需再次挖掘代码...我通过以下方式使其工作：

1.  扫描原始图像并将透明区域设置为原始图像中不存在的颜色。

2.  将 AnimGifEncoder 内部的透明颜色设置为之前分配给透明区域的颜色。

# objective-c - 如何创建多维数组？

> ID：10950044
> 
> 赞同：1
> 
> 时间：2012-06-08T13:44:17.197
> 
> 标签：objective-c, arrays

我需要为 iphone 应用程序保留 90x90 数组数据。我怎样才能保留这些数据？做一个多维数组是这个大表的解决方案。还是有其他解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T13:56:36.217

如果矩阵总是 90x90，那么你应该只使用 C 数组。

除非你特别需要传递矩阵，使用谓词搜索，或者需要 NSArray 的其他一些特性，否则保持简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:08:53.093

你可以：

*   使用包含 8100 个元素的单个 Obj-C 数组，并自己将行和列映射到单个索引上：`index = (row * 90) + column;`

*   创建一个 Obj-C 数组，其中包含 90 个 Obj-C 数组，每个数组有 90 个元素。

*   将行和列散列到一个可以与字典一起使用的键中。这可能是一个很好的解决方案，尤其是在数组稀疏的情况下。

*   使用一维或多维 C 数组，特别是如果数组的元素是普通的旧 C 类型，例如`int`. 如果要存储对象，最好使用 Obj-C 容器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T13:54:22.957

Iphone 有一个内置的数据库 SQL-Lite。我会调查一下，看看它是否满足您的需求

# java - 将 udp 数据保存到数组中

> ID：10950049
> 
> 赞同：0
> 
> 时间：2012-06-08T13:44:32.830
> 
> 标签：java, android, arrays, udp

我有一个接收 UDP 数据包的数组字节并将其转换为浮点数组，问题是在每次迭代中它都会清除数组并写入那里接收到的数据包，而我想将新数据包添加到数组中！

我使用这段代码：

```
float[] receive = new float[] {} 
```

我应该如何更改它以将接收数据包添加到我的阵列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T13:51:30.740

我假设每次收到 UDP 数据包时，您都将数据放入该数组中，这解释了为什么它在每次迭代时都会被擦除。使用 a`ByteArrayOutputStream`保存接收到的字节

```
ByteArrayOutputStream out = new ByteArrayOutputStream();
while (receiving) {
    out.write(received_data, 0, received_data_size);
} 
```

完成后，您可以通过执行以下操作获取所有接收到的字节：

```
byte[] bytes = out.toByteArray(); 
```

然后进行`float`转换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:49:58.223

数组是固定大小的数据结构。你应该`java.util.ArrayList`改用。如果装箱开销不可接受，您可以编写自己`ArrayList`的整数专用定制，或使用[类似的可用解决方案](http://trove4j.sourceforge.net)之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T13:52:31.460

我猜你发布的那一行：

浮动 [] 接收 = 新浮动 [] {}

在循环内。所以每个循环`receive`变量都会得到一个新的空`float`数组。

您应该将声明放在`receive`循环之外。而且missingfaktor是对的，你最好使用`ArrayList`

```
ArrayList<Float> receive;
...
receive.add(<your data>);
... 
```

# asp.net-mvc-3 - 在图像 asp.net MVC3 之间切换

> ID：10950051
> 
> 赞同：0
> 
> 时间：2012-06-08T13:44:43.833
> 
> 标签：asp.net-mvc-3, image, razor, src, user-profile

我有一个个人资料照片的占位符。我希望它从数据库中获取个人资料图片（这工作正常）`<img src="@Url.Action("Thumbnail", "Photo", new { id = Model.Mebrief.myGuid, size = "small" })" alt="@Model.UserName" width="150" height="150"/>`。问题：如果没有个人资料图片，它应该获得位于此处的默认占位符图片：

```
<img src="@Url.Content("~/Content/profile-template/img/friend_avatar_default.jpg")" alt="crazy" width="150" height="150"/> 
```

所有这些都应该显示在下面的 div 中：

```
<div id="profile">   </div> 
```

注意：我使用的是**.cshtml razer**页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:03:58.730

> 下面不是一个有效的剃刀语法，而只是一个想法 - 使用三元运算符

```
if true ? new image : default image 
```

型号！= null

**?**
img src="@Url.Action("Thumbnail", "Photo", new { id = Model.Mebrief.myGuid, size = "small" })" alt="@Model.UserName" width="150" height= "150"/>"

**：**

img src="@Url.Content("~/Content/profile-template/img/friend_avatar_default.jpg")" alt="crazy" width="150" height="150"/>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:06:07.640

你可以在你的控制器中尝试这样的事情。

```
 public ActionResult Photo(int photoId)
    {
        MyPhoto photo = null;
        try
        {
            MyPhoto = db.GetMyPhotoById(photoId);
            return new FileStreamResult(new MemoryStream(photo.Image), photo.ImageMimeType);
        }
        catch (Exception ex)
        {
            //use the default image
            return new FilePathResult(Url.Content("~/Content/profile-template/img/friend_avatar_default.jpg"), "image/jpg");
        }
    } 
```

查看您在控制器中所做的事情会很有帮助，但我猜您正在从从数据库返回的字节中返回 FileStreamResult。

希望这可以帮助。

# asp.net - ASP.NET Web 应用程序部署 - 具有域/服务器名称访问权限

> ID：10950054
> 
> 赞同：1
> 
> 时间：2012-06-08T13:45:06.307
> 
> 标签：asp.net, deployment, dns, windows-server-2008

我已经在 IIS（Windows 2008 服务器）上部署了我的 ASP.NET Web 应用程序。我创建了一个虚拟目录（名为**TestApp**），局域网上的所有用户都使用以下 URL 访问它。

http://"SERVERNAME"/TestApp/Default.aspx

我的客户想要它，它应该通过以下 URL 访问

http://"SERVERNAME"/Default.aspx

服务器上部署了单个应用程序。

你能告诉我如何实现这个东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T13:49:58.930

`virtual directory`您需要添加一个**新**站点，而不是在现有站点上添加 **`web site`**

 **[创建网站 (IIS 7)](http://technet.microsoft.com/en-us/library/cc772350%28v=ws.10%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:53:24.420

事实上，它相当简单。

1.  删除您当前的应用程序，包括 IIS 中的所有文件和设置（即：删除所有内容）。
2.  再次运行部署向导，但要小心它为您的应用程序提供的路径：默认情况下，您应该看到“http://SERVERNAME/TestApp/”。删除“TestApp”。向导将向您显示一条警告消息，请继续。
3.  像往常一样完成向导，瞧！

我这样做了 2 或 3 次。**

# perl - 如何从 Perl 模块创建具有 C 或 C++ 链接的静态库？

> ID：10950056
> 
> 赞同：1
> 
> 时间：2012-06-08T13:45:06.590
> 
> 标签：perl, visual-c++, static-libraries

我有一个非常大的 Perl 模块，我希望在我的 Visual C++ 项目中调用它。我知道有像*perl2exe*和*pp*这样的工具可以将 Perl 模块转换为独立的可执行文件（`abc.exe`）。

我不喜欢独立的可执行文件，因为它使界面非常复杂。我必须通过创建一个进程并使用标准输入/输出与它进行通信来调用 Perl 模块。

如果 Perl 模块是 C/C++ 静态库，这将容易得多。只需链接它并调用一个函数！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T13:55:20.123

您不能（还|容易）编译模块。相反，[将 Perl 解释器嵌入为 library](http://perldoc.perl.org/perlembed.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:59:05.090

您确实可以将您的模块静态链接到您的 C 项目中。要意识到的是，您也需要链接`perl`。`perl`是一个被 Perl 代码大量使用的库（即使 Perl 代码可以编译成机器语言也是如此）。

[perlembed](http://perldoc.perl.org/perlembed.html)文档如何做到这一点。

# python - 对列表的一列求和（跟进）

> ID：10950057
> 
> 赞同：2
> 
> 时间：2012-06-08T13:45:13.857
> 
> 标签：python

我有一个看起来像这样的列表：

```
('string ', 'time', 'SPY', 0, 0, 131.63, 100),
('sting ', 'time', 'SPY', 0, 0, 131.63, 700) 
```

我想要做的是添加最后一列数据

我想做的是解压缩列表，然后对最后一列中日期的绝对值求和，但我无法让它正常工作

我一直在尝试的是：

```
testsum = sum(abs(zip(*list[:-1])) 
```

谢谢

编辑：好的，谢谢您的回复

```
sum(l[-1]) for l in list 
```

工作得很好，但我忘了提到我让它在一个 for 循环中运行，我真正想做的是添加所有输出的总和我真的很困惑，我不确定该怎么做我虽然可以做同样事情又来了，但它没有用

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T13:47:25.813

生成器表达式是你的朋友：

```
sum(l[-1] for l in list) 
```

（尽管我确实希望您的列表不是字面上称为“列表”，因为这会影响内置）。

对于后续行动，它确实取决于“添加所有输出的总和”的确切含义。这可能意味着有一些列表，例如您发布的列表，您正在迭代，并且您希望将所有总和加在一起一次。这将是：

```
sum(sum(l[-1] for l in list) for list in lists) 
```

甚至只是

```
sum(l[-1] for l in list for list in lists) 
```

如果你的意思是你想要一个累积总和 - 所以，你想要每个阶段的运行总计，因为另一个内部总和被添加到它 - 看看[这个关于累积总和的上一个问题](https://stackoverflow.com/questions/4844399/whats-wrong-with-this-cumulative-sum)，或者只是写出循环：

```
cumsum = 0
for list in lists:
   cumsum += sum(l[1] for l in list)
   print(cumsum) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T13:48:08.117

给定

```
li = [('string ', 'time', 'SPY', 0, 0, 131.63, 100),
      ('sting ', 'time', 'SPY', 0, 0, 131.63, 700)] 
```

这将起作用：

```
sum(i[-1] for i in li)
800 
```

**更新**：响应更新/编辑的问题：

目前尚不清楚您的列表如何`li`在循环中获取其值，但一般来说，如果您有一些类似的构造

```
some_limit = .. # how often you need to loop
total = 0
for i in range(some_limit):
   # get new/updated values for li
   total += sum(i[-1] for i in li)  

print 'Your total is: ', total 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T13:48:32.130

`sum([item[-1] for item in list])`您可以使用列表推导。

# javascript - 在javascript中的第一个数字之前获取一个子字符串

> ID：10950061
> 
> 赞同：1
> 
> 时间：2012-06-08T13:45:22.113
> 
> 标签：javascript, regex

我正在尝试提取所有文本，直到出现第一个数字。假设我有这种 string `"Paris 01 Louvre"`。我只想拥有`"Paris"`或者如果我`"Neuilly sur Seine 03 bla blab"` 想提取`"Neuilly sur Seine"`.

我在 javascript 中使用正则表达式苦苦挣扎，但找不到正确的公式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T13:49:01.953

```
"Neuilly sur Seine 03 bla blab".match(/^\D+(?=\s)/);
// => Neuilly sur Seine 
```

这个答案还确保不捕获尾随空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T13:48:03.830

基本正则表达式：

```
var re = /^([^\d]+)\s/;    
var str = "Neuilly sur Seine 03 bla blab";
console.log( str.match(re) ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:49:35.983

`^(.+?)\d`

这会抓取第一个数字 ( `\d`) 之前的所有内容。[在这里玩正则表达式](http://regexr.com?3170r)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T13:47:03.123

除了数字之外的任何内容：

```
^[^0-9]* 
```

*   `^`是行首
*   `[]`表示字符类
*   `^`字符类内部的意思是“反转这个类”
*   `0-9`是数字 0 到 9，所以`[^0-9]`表示除 0 到 9 之外的任何字符
*   `*`是它所遵循的字符/类的“零个或多个”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T13:50:02.483

这会从字符串的开头抓取任何不是数字的东西。

```
s.match(/^\D*/) 
```

# css - 为什么使用 p:nth-child(3n+0) css 伪类从第二个元素开始？

> ID：10950065
> 
> 赞同：2
> 
> 时间：2012-06-08T13:45:39.613
> 
> 标签：css

我正在使用新的 CSS3 选择器和伪类，我正在尝试使用 :nth-child 伪类。

如果我在这里查看文档：http: [//www.w3schools.com/cssref/sel_nth-child.asp](http://www.w3schools.com/cssref/sel_nth-child.asp)

我看到并举例：

```
p:nth-child(3n+0)
{
  background:#ff0000;
} 
```

但是，如果我查看结果（[http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_nth-child_formula](http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_nth-child_formula)），我不明白为什么第一个红色元素是第二个而不是第三个或第一的。

这背后的逻辑是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T13:47:26.727

第二段*是*第三个孩子：

```
<h1>This is a heading</h1>
<p>The first paragraph.</p>
<p>The second paragraph.</p> 
```

如果您想从第三段开始，请尝试[`:nth-of-type`](http://msdn.microsoft.com/en-us/library/ie/jj127345%28v=vs.85%29.aspx)：

```
p:nth-of-type(3n){
    background: #F00
} 
```

W3Schools 并不总是最清晰的资源，[有时它是非常错误的](http://w3fools.com)。使用时要小心。

# c# - 使用 Monotouch 进 行跨平台代码重用 - 但是 app.config 呢？

> ID：10950068
> 
> 赞同：0
> 
> 时间：2012-06-08T13:46:03.700
> 
> 标签：c#, xamarin.ios, cross-platform

Monotouch 不支持 System.Configuration；这实际上意味着您不能在项目中使用 app.config 文件类型。但是，如果您的现有应用程序正在大量使用此 .NET 功能，该怎么办？

任何建议如何处理它？理想情况是 app.config 可以保持原样，Monotouch 可以读取定义的设置。最后，这将意味着 System.Configuration 的一种实现。

建议？代码？会更受欢迎！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T02:02:17.327

MonoTouch 与标准 .NET 的主要区别在于放弃对 System.Configuration 的支持，就像 Silverlight 所做的那样。

原因是这是一个相当繁重的框架，它不是一个可选功能。如果我们要支持 app.config，我们将不得不为不关心的应用程序带来 System.Configuration，从而导致结果膨胀。

解决方案是从您的软件中删除对 app.config 的依赖，就像您在 Xbox 或 Silverlight 上使用 WinRT、.NET 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:49:53.597

首先，您应该意识到 MonoTouch 并不是为了让应用程序可移植，只是为了让开发人员能够将 C# 用于 iOS 应用程序。

您可以做的显而易见的事情就是将这部分包装到您自己的配置管理代码中，并在 iOS 端重新实现缺少的部分。

顺便说一句，Xamarin 的人正在努力为 iOS、WP 和 Android 创建跨平台 API，但我怀疑这些是否包括配置。它们旨在支持相机、指南针等设备 API，我不确定它们已经取得了多大的进步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T14:55:07.503

我们[从 SDF 移植了 OpenNETCF.Configuration 代码](http://www.opennetcf.com/Products/SmartDeviceFramework.aspx)（“移植”我的意思是简单地创建了一个 MonoDroid 和 MonoTouch 项目文件并导入了代码文件），它工作正常。当然，它是完整配置命名空间的一个子集，但它提供了我们在 app.config 文件中使用的几乎所有内容。

代码随标准版及更高版本一起提供，但如果你很便宜，我相当确定代码与 1.x 代码库相比变化很小，该代码库是免费的，位于上述链接页面的底部。

# java - Maven“线程中的异常”http-bio-8080-exec-32”java.lang.OutOfMemoryError：PermGen 空间”

> ID：10950076
> 
> 赞同：5
> 
> 时间：2012-06-08T13:46:24.150
> 
> 标签：java, maven, netbeans, permgen

我在 Ubuntu 11.10 下使用 Struts2 + Spring 和 Hibernate 框架在 NetBeans 中创建了一个项目。第一次运行没问题，但是当我第二次或第三次运行它时，我不断收到此异常。没有 Maven 一切顺利。我安装了 maven ，是的，我在 中`apt-get install`添加了这一行，但没有运气。如何从中获得更好的性能？`export MAVEN_OPTS=-Xmx512m``usr/bin/mvn`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T13:59:33.890

你应该添加这一行：

```
export MAVEN_OPTS="-Xmx512M -XX:MaxPermSize=512M" 
```

请注意，一些用户报告双引号会产生问题，因此您可能希望使用：

```
export MAVEN_OPTS=-Xmx512M -XX:MaxPermSize=512M 
```

编辑：

由于您使用的是 Tomcat，因此请使用以下命令：

1.  打开**tomcat/bin/catalina.sh**
2.  将此行添加到**JAVA_OPTS="-Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms512m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX :MaxPermSize=256m -XX:+DisableExplicitGC"**
3.  保存退出，重启Tomcat

[更多信息在这里...](http://forums.eukhost.com/f33/tomcat-java-lang-outofmemoryerror-permgen-space-7675/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T13:55:41.123

当对象没有正确清理它们的内存时，permgen space 通常会抛出这个错误。通常是“孤岛”的原因，即引用仍然指向它们的对象，但是作为程序员的您无权访问这些引用，因为它们位于您的空间之外。您可能正在使用导致此问题的库，并且在您停止使用该库之前它可能不会消失。至于哪个图书馆，我不确定，有很多文章解释如何找到它，但这是一件苦差事，可能需要一段时间，除非你很幸运。内存分析器可以提供一些想法。

[很好的解释文章](http://www.integratingstuff.com/2011/07/24/understanding-and-avoiding-the-java-permgen-space-error/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T13:53:35.037

`-Xmx512m`不会帮助你，因为你正在增加堆空间。您用完了 PermGen 空间，而不是堆空间。

尝试增加 PermGen 空间并放置一些标志以使其成为垃圾。以下是更多信息：[在 Tomcat 6 中重复出现“PermGen”](https://stackoverflow.com/questions/473011/recurring-permgen-in-tomcat-6)

# selenium - 如何在 Selenium Grid2 上运行从 Selenium IDE 记录的测试？

> ID：10950079
> 
> 赞同：1
> 
> 时间：2012-06-08T13:46:47.270
> 
> 标签：selenium, selenium-ide, selenium-grid

不幸的是，稀疏文档中的所有示例都是用 Ruby/Java/等手工编写的测试。没有提到从 IDE 记录的运行测试（保存到 HTML 文件中）。并且没有提及任何用于打开/解析/评估/运行所述文件的 API 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:13:33.817

Grid 不支持使用 IDE 中的 HTML 文件运行测试。您将不得不使用编程语言。您可以在旧的 selenium-grid 页面中找到解释/原因

[http://selenium-grid.seleniumhq.org/faq.html#my_test_cases_are_in_html_selenese_how_can_i_run_those_against_selenium_grid_](http://selenium-grid.seleniumhq.org/faq.html#my_test_cases_are_in_html_selenese_how_can_i_run_those_against_selenium_grid_)

没有人阻止你创造一个虽然:)

# android - 在Android中，当旋转图像时它会慢慢消失。

> ID：10950080
> 
> 赞同：2
> 
> 时间：2012-06-08T13:46:49.447
> 
> 标签：android

我使用下面的代码来旋转图像。图像旋转没有问题，但是当我旋转图像时，图像像素减少了。如果我连续旋转意味着图像将消失。我怎么解决这个问题。

**主要的.xml**

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:src="@drawable/test" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="66dp"
        android:text="Click here to Rotate" />

</RelativeLayout> 
```

**ImageResizeTestActivity.java**

```
public class ImageResizeTestActivity extends Activity {
    /** Called when the activity is first created. */
    Button click;
    ImageView img;
    static File rotated_File;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        click = (Button) findViewById(R.id.button1);
        img = (ImageView) findViewById(R.id.imageView1);
        String fname = "Rotated_Image.jpg";
        rotated_File = new File("/sdcard/" + fname);
        click.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                if (!(rotated_File.exists())) {
                    Log.v("Inside if", "if");
                    rotateImage();
                } else {
                    Log.v("Inside else", "else");
                    rotateImage(rotated_File.getAbsolutePath());
                }

            }
        });
    }

    protected void rotateImage(String absolutePath) {
        // TODO Auto-generated method stub
        Bitmap myImg = BitmapFactory.decodeFile(absolutePath);

        Matrix matrix = new Matrix();
        matrix.postRotate(90);

        Bitmap rotated = Bitmap.createBitmap(myImg, 0, 0, myImg.getWidth(),
                myImg.getHeight(), matrix, true);
        saveImage_Rotate(rotated);
        img.setImageBitmap(rotated);
    }

    protected void rotateImage() {
        // TODO Auto-generated method stub
        Bitmap myImg = BitmapFactory.decodeResource(getResources(),
                R.drawable.test);

        Matrix matrix = new Matrix();
        matrix.postRotate(90);

        Bitmap rotated = Bitmap.createBitmap(myImg, 0, 0, myImg.getWidth(),
                myImg.getHeight(), matrix, true);
        saveImage_Rotate(rotated);
        img.setImageBitmap(rotated);
    }

    static void saveImage_Rotate(Bitmap dest2) {

        if (rotated_File.exists())
            rotated_File.delete();
        try {
            FileOutputStream out = new FileOutputStream(rotated_File);
            dest2.compress(Bitmap.CompressFormat.JPEG, 100, out);
            out.flush();
            out.close();

        } catch (Exception e) {
            e.printStackTrace();
        }

    }
} 
```

![最初我的形象是](../Images/635fae2c6242217fa98148f1f9d5b30f.png) 旋转后![旋转图像](../Images/6e69c31a6655fde631c1452e63071058.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T13:55:39.427

快速查看问题。您保存 jpg 几次，在（有损）压缩过程中，它会越来越退化。

我建议你改用 png

# c++ - 为什么 std::cout 而不是简单的 cout？

> ID：10950083
> 
> 赞同：65
> 
> 时间：2012-06-08T13:47:00.307
> 
> 标签：c++, iostream

我收到所有这些错误消息，`cout`并且`endl`：

```
main.cc:17:5: error: ‘cout’ was not declared in this scope
main.cc:17:5: note: suggested alternative:
/usr/include/c++/4.6/iostream:62:18: note:   ‘std::cout’ 
```

遵循建议后，一切都很好。现在我很好奇，为什么我必须这样做。我们以前在类中使用过 C++，但我从来不需要`std::`在任何这些命令之前编写 a。这个系统可能有什么不同？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2012-06-08T13:49:39.383

您的班级似乎可能一直在使用准标准 C++。一个简单的判断方法是查看您的旧程序并检查您是否看到：

```
#include <iostream.h> 
```

或者

```
#include <iostream> 
```

前者是预标准的，你可以说`cout`而不是`std::cout`没有任何额外的东西。您可以通过添加在标准 C++ 中获得相同的行为

```
using std::cout; 
```

或者

```
using namespace std; 
```

无论如何，只有一个想法。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-06-08T13:49:12.347

在 C++ 标准中，`cout`是在命名空间中定义的`std`，所以你需要说`std::cout`或放

```
using namespace std; 
```

在你的代码中，以便得到它。

然而，情况并非总是如此，过去`cout`只是在全局命名空间中（或者，后来，在全局和 中`std`）。因此，我会得出结论，您的类使用了较旧的 C++ 编译器。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-08T13:48:02.980

标准模板/Iostream 库中的所有内容都位于命名空间 std。你可能用过：

```
using namespace std; 
```

在你的课堂上，这就是它起作用的原因。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-08T13:51:51.873

您可以使用命名空间

[http://www.daniweb.com/software-development/cpp/threads/109029/what-its-the-use-of-using-namespace-std](http://www.daniweb.com/software-development/cpp/threads/109029/what-its-the-use-of-using-namespace-std)

但你可能会冒犯某人

[为什么“使用命名空间标准”被认为是不好的做法？](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-a-bad-practice-in-c)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-08T13:49:48.673

您可能`using namespace std;`以前在课堂上使用过代码。这明确告诉预编译器在 中查找符号`std`，这意味着您不需要`std::`. 尽管每次都显式调用`std::cout`而不是这样是一种很好的做法。这样，如果您使用另一个重新定义的库，您仍然拥有该行为而不是其他一些自定义行为。`cout``std::cout``cout``std::cout`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-08T13:51:43.767

“std”是用于 STL（标准模板库）的命名空间。请参考[https://en.wikipedia.org/wiki/Namespace#Use_in_common_languages](https://en.wikipedia.org/wiki/Namespace#Use_in_common_languages)

您可以`using namespace std;`在使用任何 stl 函数、变量之前编写，也可以`std::`在它们之前插入。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-08-18T06:16:00.290

如果您在 ROOT 中工作，您甚至不必编写`#include<iostream>`，`using namespace std;`只需从`int filename()`.

这将解决问题。

# asp.net-mvc-3 - 如何在我的 MVC3 Razor 代码中连接多个变量？

> ID：10950088
> 
> 赞同：0
> 
> 时间：2012-06-08T13:47:17.637
> 
> 标签：asp.net-mvc-3, razor

我有一些剃须刀代码，但在使语法正常工作时遇到问题。代码如下：

```
else
{
   @(x.RowKey.Substring(0, 2).TrimStart('0') + "." + x.RowKey.Substring(2, 2).TrimStart('0').PadLeft(1, '0')) - @Html.Raw(x.Title)<br>
} 
```

这给了我以下错误：

```
Compiler Error Message: CS1002: ; expected 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:04:15.707

尝试这个：

```
else
{
   var st = x.RowKey.Substring(0, 2).TrimStart('0') + "." + x.RowKey.Substring(2, 2).TrimStart('0').PadLeft(1, '0'));

   @st - @Html.Raw(x.Title)<br/>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:07:46.427

当您启动时`@(x.RowKey....`，Razor 仍然认为它仍处于 C# 模式，而不是 HTML 模式（使用完全非技术术语）。Nick Bork 关于将这些内容包装在`<text>`标签中的建议使页面回到 HTML 模式，这样您就可以返回使用正常的 Razor 语法。

# javascript - 在 ExtJS 4.1 中发送参数

> ID：10950093
> 
> 赞同：2
> 
> 时间：2012-06-08T13:47:32.887
> 
> 标签：javascript, extjs, extjs4

这是我的代码：

```
Ext.define('gridOptionsModel', {
    extend: 'Ext.data.Model'
});

var gridOptionsStore = Ext.create('Ext.data.JsonStore', {
    autoDestroy: true,
    model: 'gridOptionsModel',
    proxy: {
        type: 'ajax',
        actionMethods: 'POST',
        url: '/application.php?way=system&case=updateFields41',
        extraParams: {meta: 'true'},
        reader: {
            type: 'json',
            root: 'gridoptions'
        }
    }
}); 
```

这是它从 url 重新加载数据但不发送所需参数的部分

```
gridOptionsStore.load({proxy: {
   extraParams: {gridData: grid.getState()}}
}); 
```

我已经尝试了所有可能的方法，但无法发布*gridData*参数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:37:58.443

您可以在加载之前添加额外的参数。

```
gridOptionsStore.getProxy().extraParams.gridData = grid.getState();
gridOptionsStore.load(); 
```

这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:23:36.897

不要直接设置属性，而是在可用时使用方法：

```
gridOptionsStore.getProxy().setExtraParam('gridData', grid.getState()); 
```

# user-interface - 如何在 CustomEditField 中间设置光标位置？

> ID：10950098
> 
> 赞同：0
> 
> 时间：2012-06-08T13:47:51.380
> 
> 标签：user-interface, blackberry, blackberry-jde

我创建了一个带有圆形边框的自定义编辑字段。但是光标显示在`CustomEditField`. 如何将光标位置更改为字段中心。在这个问题上需要帮助。以下代码片段是`CustomEditField`.

```
public CustomEditField() {
    this(0);
    setMaxSize(15);
    setCursorPosition(AXIS_VERTICAL);
}

public CustomEditField(long style) {
    this(new XYEdges(20, 10, 20, 10), Field.FIELD_HCENTER
            | Field.USE_ALL_WIDTH | Field.NON_SPELLCHECKABLE
            | TextField.NO_NEWLINE | CONSUME_INPUT | style);
}

public CustomEditField(String label, String initialValue) {
    this(0);
    setLabel(label);
    setText(initialValue);
}

public CustomEditField(XYEdges points, long style) {
    super(style);
    setPadding(points);
}

/**
 * Paints EditField Background with specified Format values
 */
protected void paintBackground(Graphics graphics) {
    graphics.setColor(Color.WHITE);
    graphics.fillRoundRect(10, getPaddingTop(), getWidth() - 10,
            getHeight() - getPaddingBottom(), 20, 20);
    graphics.setColor(0x686868);
    graphics.drawRoundRect(10, getPaddingTop(), getWidth() - 10,
            getHeight() - getPaddingBottom(), 20, 20);
    graphics.setColor(Color.BLACK);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:41:11.177

首先，有一些概念可以确保你清楚。对于 a `Field`，有**边距**、内**边距**和**边框**。 [这是对它们所代表的内容的一个很好的描述](https://stackoverflow.com/a/4619943/119114)……链接的问题是关于 Android 的，但据我所知，Android 和黑莓以相同的方式使用这些概念。

如果您希望圆角矩形成为您的**边框**，那么当您绘制它时，您不会通过**填充**量来开始它。填充是边界*内的内容。*因此，您应该在 (x,y) == (0,0) 处绘制矩形。如果您想在边界之外提供一些空间，作为其他字段之间的缓冲区，请使用**边距**。 `Field`对象的`setMargin()`调用看起来就像`setPadding()`.

其次，该方法`setCursorPosition()`并不是真正用于将光标的布局在空间中居中。 [它用于设置光标应该在 EditField 中的哪个字符旁边](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/ui/component/BasicEditField.html#setCursorPosition(int))。这个问题不是你想要的。

此外，您上面的代码没有对称地绘制矩形。请记住，当您在两侧都有填充时，您必须减去顶部**和**底部填充以获得剩余的高度，或者减去左侧**和**右侧以获得剩余的宽度。

无论如何，根据您实际想要`CustomEditField`填充的方式，您可能需要稍微更改一下。但是，以下内容至少会为您提供一个光标垂直居中的编辑字段。

```
public class CustomEditField extends BasicEditField {
   public CustomEditField () {
      this(0);
      setMaxSize(15);
      //setCursorPosition(AXIS_VERTICAL); 
   }

   public CustomEditField (long style) {
      this(new XYEdges(20, 10, 20, 10), Field.FIELD_HCENTER | Field.USE_ALL_WIDTH | Field.NON_SPELLCHECKABLE
            | TextField.NO_NEWLINE | CONSUME_INPUT | style);
   }

   public CustomEditField (String label, String initialValue) {
      this(0);
      setLabel(label);
      setText(initialValue);
   }

   public CustomEditField (XYEdges points, long style) {
      super(style);
      setPadding(points);
   }

   /**
    * Paints EditField Background with specified Format values
    */
   protected void paintBackground(Graphics graphics) {
      graphics.setColor(Color.WHITE);
      graphics.fillRoundRect(0, 0, getWidth(), getHeight(), 20, 20);
      graphics.setColor(0x686868);
      graphics.drawRoundRect(0, 0, getWidth(), getHeight(), 20, 20);
      graphics.setColor(Color.BLACK);
   }
} 
```

请注意，这将在圆角矩形之前的文本上方留出 20 像素的空间（如果您使用默认构造函数）。这看起来很多。也许那不是你真正想要的。您可能决定将所有 4 个边的填充降低到 10 个像素，然后`setMargin()`在场上使用以在边界之外提供一些空间。你必须玩弄它。

顺便说一句，解决这个问题的另一种方法，我经常使用，是将你的 EditField 包装在 a`Manager`中，比如 a `VerticalFieldManager`。如果您这样做，并将`add()`EditField 与 VerticalFieldManager 一起使用样式标志 = `Field.FIELD_VCENTER`，那也应该实现您的目标。但在这种情况下，我认为没有必要。

# apache2 - 多个主机名，同一个域，不同的虚拟主机

> ID：10950100
> 
> 赞同：0
> 
> 时间：2012-06-08T13:48:00.817
> 
> 标签：apache2

我正在尝试根据主机名称（不是域名）将请求路由到不同的文档根：

```
 <VirtualHost 123.123.12.12:80>
 SuexecUserGroup "#521" "#521"
 ServerName forum.somesite.net
 DocumentRoot /home/somesite/public_html/forums
 </VirtualHost>

 <VirtualHost 123.123.12.12:80>
 SuexecUserGroup "#521" "#521"
 ServerName www.somesite.net
 DocumentRoot /home/somesite/public_html
 </VirtualHost> 
```

但它不起作用。无论主机名中的内容如何，​​Apache 似乎都会进入第一个条目。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:50:27.387

尝试将第二个虚拟主机更改为此

```
 <VirtualHost 123.123.12.12:80>
  SuexecUserGroup "#521" "#521"
  ServerName somesite.net
  ServerAlias www.somesite.net
  DocumentRoot /home/somesite/public_html
 </VirtualHost> 
```

# .net - 在gridview中获取单元格值

> ID：10950103
> 
> 赞同：0
> 
> 时间：2012-06-08T13:48:05.890
> 
> 标签：.net, gridview

我想从gridview内的文字中获取文本，

但是当我运行程序时，异常通过

无法将 System.Web.UI.LiteralControl 类型的对象转换为 System.Web.UI.DataBoundLiteralControl 类型。

**.aspx 代码：**

```
<asp:GridView ID="gridview3" runat="server" OnRowDataBound="RowDataBound" DataKeyNames="qno" AutoGenerateColumns="false"  ShowFooter="true" OnRowCancelingEdit="cancel"   OnRowCommand="create" OnRowDeleting="delete" OnRowEditing="edit" OnRowUpdating="update">

            <Columns>
            <asp:TemplateField HeaderText="Selection">
            <ItemTemplate>
                <asp:CheckBox ID="check1" runat="server"/>
            </ItemTemplate>

            </asp:TemplateField>
             <asp:TemplateField HeaderText="ID" Visible="true">
        <ItemTemplate>
            <asp:Label ID="id7" runat="server" Text='<%#Eval("assessid") %>' ></asp:Label>

        </ItemTemplate>
        </asp:TemplateField>

    <asp:TemplateField HeaderText="Qno" Visible="true">
        <ItemTemplate>
         <asp:DropDownList  AppendDataBoundItems="true"  AutoPostBack="true"     ID="DropDownList1"  runat="server">
         <asp:ListItem ></asp:ListItem>

        </asp:DropDownList>

        </ItemTemplate>

    </asp:TemplateField>

      <asp:TemplateField HeaderText="description" Visible="true">
        <ItemTemplate>

         <asp:Literal ID="id6" runat="server" Text='<%#Eval("description") %>' >
         </asp:Literal>
        </ItemTemplate>
         <EditItemTemplate>
             <asp:TextBox ID="TextBox1" Text='<%#Eval("description") %>' runat="server" ></asp:TextBox>

        </EditItemTemplate>
        <FooterTemplate>

        <asp:TextBox ID="TextBox3"  runat="server" ></asp:TextBox>

        </FooterTemplate>

    </asp:TemplateField>

     <asp:TemplateField HeaderText="strongagree" Visible="true">
        <EditItemTemplate>
        =

      <asp:TemplateField HeaderText="Action" Visible="true">

        <ItemTemplate>
            <asp:LinkButton ID="LinkButton5" Text="Edit" CommandName="edit" runat="server"></asp:LinkButton>
    </ItemTemplate>
    <EditItemTemplate>

       <asp:LinkButton ID="LinkButton1" Text="update" CommandName="update" runat="server"></asp:LinkButton>

       <asp:LinkButton ID="LinkButton3" Text="cancel" CommandName="cancel" runat="server"></asp:LinkButton>
    </EditItemTemplate>
    <FooterTemplate>

    <asp:LinkButton ID="LinkButton7" Text="DeleteAll"  CommandName="delete" runat="server"></asp:LinkButton>

    </FooterTemplate>
</asp:TemplateField>

    <asp:TemplateField HeaderText="" Visible="true">

        <ItemTemplate>

          <asp:LinkButton ID="LinkButton23" Text="delete" CommandName="delete" runat="server"></asp:LinkButton>

    </ItemTemplate>

    <FooterTemplate>
    <asp:Button ID="bdh" Text="insert " CommandName="insert" runat="server" />

    </FooterTemplate>

</asp:TemplateField>

</Columns>

            <FooterStyle BackColor="#990000" Font-Bold="True" ForeColor="White" />
            <HeaderStyle BackColor="#990000" Font-Bold="True" ForeColor="White" />
            <PagerStyle BackColor="#FFCC66" ForeColor="#333333" HorizontalAlign="Center" />
            <RowStyle BackColor="#FFFBD6" ForeColor="#333333" />
            <SelectedRowStyle BackColor="#FFCC66" Font-Bold="True" ForeColor="Navy" />
            <SortedAscendingCellStyle BackColor="#FDF5AC" />
            <SortedAscendingHeaderStyle BackColor="#4D0000" />
            <SortedDescendingCellStyle BackColor="#FCF6C0" />
            <SortedDescendingHeaderStyle BackColor="#820000" />

        </asp:GridView> 
```

**后面的代码**

```
protected void RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
       string percentage = ((LiteralControl)e.Row.Cells[2].Controls[0]).Text;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T13:56:55.623

你得到的文字控制可能不是你想要的（可能有一个与空格匹配的文字）。尝试通过 id 获取：

```
string percentage = ((LiteralControl)e.Row.FindControl("id6").Text; 
```

或者尝试另一个索引：

```
string percentage = ((LiteralControl)e.Row.Cells[2].Controls[1]).Text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:23:17.443

它应该是 Cells[3]，而不是 Cells[2]，因为您的 Literal 控件位于第 4 列。但是不要在那里对索引进行硬编码。当您想稍后添加更多列时，它会很痛苦。相反，尝试这样的事情......

```
protected void RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        Literal id6 = (Literal)e.Row.FindControl("id6");
        string percentage = "";

        if (id6 != null) {
            percentage = id6.Text;
        }
    }
} 
```

# django - Django - 如何设置/更改 Django 用户模型属性的详细名称？

> ID：10950106
> 
> 赞同：3
> 
> 时间：2012-06-08T13:48:14.767
> 
> 标签：django, model, verbose

我正在建立一个包含多种语言的网站。

因此，我需要在我的所有模型类中设置所有属性的详细名称（使用国际化助手）。不幸的是，我找不到更改用户属性的详细名称的方法...

覆盖每一个表单并不是一个很好的方法，对吧？

谢谢你的帮助！

罗恩

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T15:05:45.227

这取决于你需要这个。通常，`verbose_name`仅在管理员的上下文中使用。如果这是您需要担心的，那么您可以创建一个代理模型，然后让您的用户管理员使用它：

```
from django.contrib.auth.models import User
from django.utils.translation import ugettext_lazy as _

class CustomUser(User):
    class Meta:
        proxy = True
        app_label = 'auth'
        verbose_name = _('My Custom User') 
```

然后，在 admin.py 中：

```
 from django.contrib.auth.admin import UserAdmin
 from django.contrib.auth.models import User

 from .models import CustomUser

 admin.site.unregister(User)
 admin.site.register(CustomUser, UserAdmin) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-13T17:49:22.113

由于这是搜索 django 详细名称时在 google 上的第一个答案，我想我会更正 2012 年的 Chris Pratt 的回答，使其适用于 django 2.0

如果您只想在管理面板中更新模型名称，您可以简单地将 Meta 类添加到您的用户模型中。请注意与克里斯的回答略有不同。

```
class Meta:
    verbose_name = 'My Custom User' 
```

# javascript - 链接后控制父窗口（JavaScript）

> ID：10950108
> 
> 赞同：0
> 
> 时间：2012-06-08T13:48:27.473
> 
> 标签：javascript, popup, window, parent

我正在使用表单处理服务，在使用 setTimeout() 链接回我的原始页面之前点击提交链接到中间页面。我想用更好的东西覆盖丑陋的中间页面。到目前为止，我已经尝试让提交按钮在单击时加载一个新窗口，新窗口使用 parent.write 打开一个覆盖整个页面并允许我编写自己的 html 的 div。问题在于它完全阻止了中间页面的加载，从而阻止了我的表单被处理。

我当前的解决方法是在加载中间页面后立即在子窗口中使用 setTimeout() 来加载我自己的页面。它有效，但我仍然首先看到中间页面。

请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T15:37:21.907

切换到 000webhost 并编写了我自己的表单处理程序

# dynamics-ax-2009 - 如何将 XML 文件导入 Dynamics AX 2012？

> ID：10950114
> 
> 赞同：0
> 
> 时间：2012-06-08T13:48:49.253
> 
> 标签：dynamics-ax-2009, axapta, dynamics-ax-2012

我想知道将 XML 文件（如（采购订单））导入 Dynamics AX 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T06:41:02.827

有几个例子可以通过网络搜索...

[Axaptapedia](http://www.axaptapedia.com/index.php?title=XML)建议使用两个库：

*   [XMLDocument 类](http://msdn.microsoft.com/en-us/library/aa611587%28v=ax.50%29.aspx)，[代码示例](http://axzaptech.wordpress.com/2010/12/27/read-xml-file-in-ax/)
*   [SAXReader 类](http://msdn.microsoft.com/en-us/library/aa882719%28v=ax.10%29.aspx)，可能更适合解析大型 XML 文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-28T11:51:21.580

这里有很好的例子来说明如何

*   [读取 XML](http://daxonline.org/1459-read-xml-in-ax.html)
*   [创建 XML](http://daxonline.org/1460-create-xml-in-ax.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T23:29:41.257

它还取决于 XML 的大小，我们已经看到过大的文件大小导致 XMLDocument 类消耗过多的内存，因为它将 XML 加载到内存中。

如果您需要性能并且不需要模式验证，也可以使用 XMLTextReader。如果确实需要模式验证，则必须坚持使用 XMLDocument。（看看这篇文章

查看 codeproject 上的这篇文章，它详细解释了 XMLTextReader。

[http://www.codeproject.com/Articles/15452/The-XmlTextReader-A-Beginner-s-Guide](http://www.codeproject.com/Articles/15452/The-XmlTextReader-A-Beginner-s-Guide)

另外，我想知道，您是否拥有生成 XML 文件的应用程序的所有权？如果它是您自己掌握的，您可以考虑创建一个 AIF 自定义服务并从您的其他应用程序中调用它。（但我猜您不是生成要导入的 XML 文件的应用程序的所有者。）

# c# - MonoTouch NSClassFromString

> ID：10950117
> 
> 赞同：4
> 
> 时间：2012-06-08T13:48:59.190
> 
> 标签：c#, .net, objective-c, ios, xamarin.ios

我正在尝试在 MonoTouch 中使用以下 Objective-C 代码：

`if (NSClassFromString(@"ADBannerView"))`

C# 中的等价物是什么？

基本上我想使用 iAd，但我需要检查 and 的存在`ADBannerView`，`ADInterstitialAd`因为它们并非在所有版本的操作系统上都可用。（而且我宁愿做功能检查而不是 iOS 版本检查）

我认为这在其他情况下也可能会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:52:25.617

最近的 MonoTouch 将始终提供`ADBannerView`，因此您无法使用 C# 等价物`Type.GetType`来查询可用性。

通常，版本检查是检查功能的最佳方式。例如

```
bool available = UIDevice.CurrentDevice.CheckSystemVersion (4, 0); 
```

对于任何 4.0+ 版本的 iOS（4.0是添加到 iOS 时），将返回**true 。**`ADBannerView`

一种可能的替代方法（可能并非在每种情况下都有效）是创建一个实例并检查它的句柄。由于 ObjC 是基于消息的发送`init`，因此将返回 null（这是 .NET 构造函数无法做到的）。例如

```
bool available = (new ADBannerView ().Handle != IntPtr.Zero); 
```

请注意，您可能最好将上述内容与`using`处理视图或将其集成到您的正常创建中`ADBannerView`。

**更新**：当然 ap/invoke to[`NSClassFromString`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/func/NSClassFromString)将与 ObjectiveC 代码*完全相同*:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:53:46.343

这个人问了这个问题并回答了。看起来您需要编译器标志：

看看这个：[带有 iAds 的 MonoTouch 应用程序在模拟器上运行，在设备上崩溃](https://stackoverflow.com/questions/5819952/monotouch-app-with-iads-runs-on-simulator-crashes-on-device)

否则，您可以[检查程序集中的类](https://stackoverflow.com/a/1138426/353147)。

最后，您可以使用与我相同的谷歌搜索：[monotouch ADBannerView 程序集](https://www.google.com/search?rlz=1C1DVCC_enUS346&sugexp=chrome,mod=2&sourceid=chrome&ie=UTF-8&q=c%23+check+for+class+in+assembly#sclient=psy-ab&hl=en&rlz=1C1DVCC_enUS346&q=monotouch+ADBannerView+assembly&oq=monotouch+ADBannerView+assembly&aq=f&aqi=&aql=1&gs_l=serp.3...116227.120875.0.121206.20.20.0.0.0.0.151.2291.7j13.20.0.ekh.1.0.0.syFKB6SgCF8&pbx=1&bav=on.2,or.r_gc.r_pw.,cf.osb&fp=26b20b30f12ed1d6&biw=1285&bih=1082)

如果这没有帮助，MonoTouch 的一个人通常会检查 monotouch 标记的问题，并且真的很有帮助。

# web-config - 具有不同连接字符串的 Web.Debug.Config

> ID：10950122
> 
> 赞同：1
> 
> 时间：2012-06-08T13:49:24.813
> 
> 标签：web-config, web-config-transform

我有一个 Web.config 文件和一个 Web.Debug.Config 文件。我的 Web.Debug.Config 文件实际上是空的，我想在其中添加一个连接字符串部分来覆盖 Web.Config 文件中的那个部分。我尝试只在配置文件中添加连接字符串部分，但它没有选择它。我知道我需要在一个或两个配置文件中使用一些命令，但不确定它们是什么。有人可以帮帮我吗？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:16:40.610

您应该能够执行以下操作（未经测试，但应该可以）来替换 Web.Config 文件的 connectionStrings 部分：

```
<?xml version="1.0"?>
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <connectionStrings xdt:Transform="Replace">
    <add name="AuthenticationDatabase" connectionString="connection-string-here" providerName="System.Data.SqlClient" />
    <add name="OtherDatabase" connectionString="connection-string-here" providerName="System.Data.SqlClient" />
  </connectionStrings>
</configuration> 
```

如果您只是想更新现有的 connectionString：

```
<?xml version="1.0"?>
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <connectionStrings>
    <add xdt:Transform="SetAttributes" xdt:Locator="Match(name)" name="AuthenticationDatabase" connectionString="new-string-here" providerName="System.Data.SqlClient" />
  </connectionStrings>
</configuration> 
```

# desire2learn - 上传到 D2L LOR 失败并出现权限错误

> ID：10950138
> 
> 赞同：0
> 
> 时间：2012-06-08T13:49:58.713
> 
> 标签：desire2learn

在尝试通过 REST API 上传 scorm 包时，上传不起作用。

PUT /d2l/api/lr/(D2LVERSION: 版本)/objects/ [http://docs.valence.desire2learn.com/res/lor.html](http://docs.valence.desire2learn.com/res/lor.html)

基于 403 许可，我们总是被拒绝。

有什么我应该看的设置吗？也在寻找这种工作的痕迹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:54:51.220

只要您通过身份验证的帐户可以在 Web UI 中执行该功能，预计 API 也将起作用。

如果您从登录过程中取回密钥但此调用失败，您可以尝试示例中的基本调用，例如“whoami”。如果可行，您的密钥是正确的。

如果密钥正确并且某些 GET 调用正常工作，您可能需要将不同的方法传递给 sdk 中的签名调用。（该方法是签名的一部分）。

这是工作跟踪的示例。403 错误通常有一个提供额外信息的正文。注意安全参数是：调用时的x_a,x_b,x_c,x_d,x_t 参数。

 `````
PUT http://smihai-7:44459/d2l/api/LR/1.0/objects/?repositoryId=1&x_t=1339183935&x_a=L2Hd9WvDTcyiyu5n2AEgpg&x_c=tfJFhSUaczOeOGqDFPXPq8NSBPj2sOhz4U3RacqWRMY&x_b=TestToken&x_d=BEl7kdCcrjenkpBt9ri5dkt4bdEgCo6xfZDWIpkKctA HTTP/1.1
Accept: application/json, application/xml, text/json, text/x-json, text/javascript, text/xml
User-Agent: RestSharp 101.3.0.0
Host: smihai-7:44459
Content-Type: multipart/form-data; boundary=-----------------------------28947758029299
Content-Length: 1203
Accept-Encoding: gzip, deflate
Connection: Keep-Alive
-------------------------------28947758029299
Content-Disposition: form-data; name="Resource"; filename="Hello World Module.zip"
Content-Type: application/zip
PK???u?h?]G?g???????????Hello World Topic.htmlM??
?@??A??wwo?xH+???h????b
[o+ ????oD??RYW9u??????}J,?q
d2?[!%E|Crj?Wo{34??Xg??s???L?3??+??/?????*??W?W3?Fyb    w?>?cR?Zrf?*???b??PK???u?h?N2?T??n?????imsmanifest.xml?V??0?#?Q??m@TI?.b    ?XF??5?????k,?$~???6I??Vt??s?=g?x???%7)??J?i4   P?f\???????????DR?W`]?(?WL???g??d???s?,.&i?q????r??jT?kI??E?C?fsmd6-?q??G?  .?f?i??4???!??v\???o?7$\jH%
??K??~P??m?`E?¥a)?C????v???6????@???U~?????x???[fe?.?3????~W???;B_?,???V@B?HE???:??q?e???s??_E? 1wK??<R????T??.9YE??SkP`?????*UT??3???j??#'??#2?;?e_c?@g.????}?p?>?c??????\?
????~,u????\s?M*L?U???E??
??????Kzp\E?X@?%\p???\??R
X-????%??C??????7?|??/&?=???h????l?\?\???????P???s??))??Td??K?????{?Y?+????v?gTN??h$?
?E'E?aB?UD????PK-????u?h?]G?g?????????????????????????Hello World Topic.htmlPK-????u?h?N2?T??n???????????????????imsmanifest.xmlPK??????????E????
-------------------------------28947758029299-- 
````  `响应是这样的：

 `````
HTTP/1.1 200 OK
Cache-Control: no-cache, no-store
Pragma: no-cache
Content-Length: 69
Content-Type: application/json; charset=UTF-8
Expires: -1
Server: Microsoft-IIS/7.5
X-Powered-By: ASP.NET
X-XSS-Protection: 0
Date: Fri, 08 Jun 2012 19:32:22 GMT
{"IdentId":4,"Version":1,"ExecutionMessage":null,"ExecutionStatus":0} 
```````

# jquery - 通过禁用事件加速加载页面

> ID：10950150
> 
> 赞同：0
> 
> 时间：2012-06-08T13:50:41.130
> 
> 标签：jquery, jquery-mobile

我的页面太大了~2.5MB 的压缩大小，它的加载时间约为~1 分钟。这太长了，我想办法加快速度。我有以下事件的堆栈跟踪，这些事件在加载的 100Kb 内容中定期发生。我怀疑这是页面加载缓慢的原因。任何想法如何禁用它？

> GC 事件 - 详细持续时间 1.000 毫秒（9.61 秒）收集 643.82KB 已用堆大小 51.28MB 的 64.93MB 调用堆栈 jQuery.ajaxTransport.send
> @ jquery-1.7.1.js:8102 jQuery.extend.ajax @ jquery-1.7。 1.js:7580 evalScript@jquery-1.7.1.js:6427 jQuery.extend.each@jquery-1.7.1.js:658 jQuery.fn.extend.domManip@jquery-1.7.1.js
> :5984 jQuery。 fn.extend.append @ jquery-1.7.1.js:5761 jQuery.fn.extend.wrapAll @ jquery-1.7.1.js:5718 jQuery.fn.extend.wrapInner @ jquery-1.7.1.js:5736 jQuery .extend.each @ jquery-1.7.1.js:658 jQuery.fn.jQuery.each @ jquery-1.7.1.js:271 jQuery.fn.extend.wrapInner @ jquery-1.7.1.js:5731 $。 extend.initializePage@jquery.mobile-1.1.0.js:7503（匿名函数）@jquery.mobile-1.1.0.js:7570 jQuery.Callbacks.fire
> @ jquery-1.7.1.js:1046 jQuery.Callbacks.self.fireWith @ jquery-1.7.1.js:1164 jQuery.extend.ready @ jquery-1.7.1.js:435 DOMContentLoaded @ jquery-1.7.1。 js:923

# skype - Skype API：是否能够添加我自己的微笑或控制消息聊天格式和外观？

> ID：10950153
> 
> 赞同：0
> 
> 时间：2012-06-08T13:50:53.143
> 
> 标签：skype

是否能够添加我自己的微笑或控制消息聊天格式和外观？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T20:12:48.283

不，你不能。Skype 仅支持其自己的[html 代码](http://en.wikipedia.org/wiki/Features_of_Skype#HTML_support_in_Skype)，并且仅通过 SkypeKit 而不是桌面 API。

# javascript - 在文件扩展之前重复添加图像大小

> ID：10950159
> 
> 赞同：1
> 
> 时间：2012-06-08T13:51:04.187
> 
> 标签：javascript, jquery

我遇到了一个问题，我似乎找不到问题的原因我对 JavaScript 和 jQuery 都有点陌生。

但是通过使用下面然后调整页面大小而不是简单地将图像的大小添加到图像 src 被重复添加，例如 responsive_Course_2_2_large_large_large_large_large_large.png 而不是 Responsive_Course_2_2_large.png

```
$(window).resize(function () {

    if ($(window).width() < 600) {

        if (ImageSize != 'stand') {
            $.each(imgIds, function (index, value) {
                Image_src = $('#' + value).attr('src');
                Image = Image_src.replace(/(\.[\w\d_]+)$/i, '$1');
                $('#' + value).attr('src', Image);
                $('#' + value).attr("ImageSize", 'stand');
            });
            $('#PageContentRow').attr('style', 'background-image:Url(../img/' + pageID + '_back.png)');
        }
    }
    else if ($(window).width() > 960 && $(window).width() < 1280) {
        if (ImageSize != 'large') {
            $.each(imgIds, function (index, value) {
                Image_src = $('#' + value).attr('src');
                ImageLarge = Image_src.replace(/(\.[\w\d_]+)$/i, '_large$1');
                $('#' + value).attr('src', ImageLarge);
                $('#' + value).attr("ImageSize", 'large');
            });
            $('#PageContentRow').attr('style', 'background-image:Url(../img/' + pageID + '_back_Large.png)');
        }
    }
   else {
        $.each(imgIds, function (index, value) {
            Image_src = $('#' + value).attr('src');
            Image = Image_src.replace(/(\.[\w\d_]+)$/i, '$1');
            $('#' + value).attr('src', Image);
            $('#' + value).attr("ImageSize", 'stand');
        });
        $('#PageContentRow').attr('style', 'background-image:Url(../img/' + pageID + '_back.png)');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:02:59.127

这是一种稍微替代的方法，但是您是否考虑过`body`在调整窗口大小时设置一个类，然后`CSS`为适当的大小设置多个类？我认为它会稍微整洁一些，并且也意味着`JavaScript`and`CSS`不那么紧密地耦合在一起。这也意味着您可以使用大小来确定页面上元素的其他方面。

1.  页面调整大小
2.  宽度小于 600
    *   将正文类设置为`small`
3.  宽度在 960 到 1280 之间
    *   将正文类设置为`medium`
4.  宽度大于 1280
    *   将正文类设置为`large`

这将意味着在您的内部`CSS`您可以执行以下操作：

```
body.small #PageContentRow
{
    background-image: url('/my-image_small.png');
}
body.medium #PageContentRow
{
    background-image: url('/my-image_medium.png');
}
body.large #PageContentRow
{
    background-image: url('/my-image_large.png');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:57:10.660

因为您不断将其添加到图像中。

在下面，您将删除文件扩展名并将 _large 添加到其中。

```
ImageLarge = Image_src.replace(/(\.[\w\d_]+)$/i, '_large$1'); 
```

您的正则表达式应考虑 _large

```
var str1 = "Responsive_Course_2_2.png";
var str2 = "Responsive_Course_2_2_large.png";

var re = /(_large)?(\.[\w\d_]+)$/i;
console.log( str1.replace(re, '_large$2') );
console.log( str2.replace(re, '_large$2') ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:23:13.433

还有**background-size** css 属性。我不确定您要做什么，但听起来它可能适用。

```
#PageContentRow
{
  background-size: 100%; /* Scales background to #PageContentRow's width */
} 
```

# c++ - 如何写赋值=运算符

> ID：10950164
> 
> 赞同：0
> 
> 时间：2012-06-08T13:51:24.073
> 
> 标签：c++, assignment-operator

在 Abc.hpp 文件中定义了以下信息：

```
class Abc: public A
{
 enum Ac { VAR };

   struct L{
      std::string s1;
      ::Class2::ID type;
      unsigned s;
      bool operator==(const L& l) const { return (type==l.type)&&(s==l.s)&&(s==l.s); }
   };

   class SS
   {
      public:
      virtual ~SS();
   };
   class IS {
      public:
      /// Destructor
      virtual ~IS();

   };

   class HashIndexImplementation;
   class HashIndex;

 void func(){}

  Abc& operator=(Abc&) {
    cout << "A::operator=(A&)" << endl;
    return *this;
  } //It gives me the error that the token '{' is not recognized

 Abc(Class2 & part);
}; 
```

对于上述课程，旨在为我的目的与另一个课程分配以下信息：

```
Abc d;
static Abc f;
f=d; 
```

但是，我上面写的代码不起作用......它抛出的错误是：

```
 no matching function for call to Abc::Abc() 
```

编辑：我正在处理整个类的层次结构，因此如果我添加另一个像 Abc() 这样的构造函数，那么我将被迫在多达 20 个类中进行更改......是否没有其他方法可以用于分配。有什么方法可以让我合并其他构造函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:14:45.827

```
no matching function for call to Abc::Abc() 
```

如果要将类对象实例化为，则需要提供一个不带参数的构造函数：

```
Abc d; 
```

***这是因为如果您提供自己的任何***构造函数，编译器不会生成默认的无参数构造函数。您提供了自己的复制构造函数，因此编译器会强制您提供自己的无参数构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:01:17.697

在 class 的右大括号后没有分号`Abc`。尝试添加分号，它应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:08:21.387

在删除了所有不相关的内容并生成了一个[简短的自包含可编译示例](http://sscce.org/)（请在以后的问题中自己做）之后，我想出了这个：

```
#include <iostream>
#include <iomanip>
#include <map>
#include <string>
using namespace std;
class Abc
{
 enum Ac { VAR };

  Abc& operator=(Abc&) {
    cout << "A::operator=(A&)" << endl;
    return *this;
  } //It gives me the error that the token '{' is not recognized

};

int main()
{
    Abc abc;
} 
```

这可以编译，但并没有真正做太多。您对入站`Abc`引用什么也不做。就语言语法而言，在技术上是正确的，它没有用处。通常，您将按照以下方式进行操作：

```
class Abc
{
  int foo_;
  Abc& operator=(Abc& rhs) {
    cout << "A::operator=(A&)" << endl;

  foo_ = rhs.foo_;

    return *this;
  } //It gives me the error that the token '{' is not recognized
}; 
```

除此之外，您的语法错误现在已经消失了。有很多未定义的东西，例如`Abc`' 基类`B`和`::class2`. 也许你需要`#include`一些东西来引入这些定义。

# python - 两个数字之间的前导数字组

> ID：10950167
> 
> 赞同：-1
> 
> 时间：2012-06-08T13:51:32.230
> 
> 标签：python, prefixes

（Python）给定两个数字 A 和 B。我需要找到所有嵌套的数字“组”：

```
range(2169800, 2171194)

leading numbers: 21698XX, 21699XX, 2170XX, 21710XX, 217110X, 217111X, 
217112X, 217113X, 217114X, 217115X, 217116X, 217117X, 217118X, 2171190X, 
2171191X, 2171192X, 2171193X, 2171194X 
```

或像这样：

```
range(1000, 1452)

leading numbers: 10XX, 11XX, 12XX, 13XX, 140X, 141X, 142X, 143X, 
144X, 1450, 1451, 1452 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:50:22.583

这应该给你一个很好的起点：

```
def leading(start, end):

    leading = []
    hundreds = start // 100

    while (end - hundreds * 100) > 100:
        i = hundreds * 100
        leading.append(range(i,i+100))
        hundreds += 1

    c = hundreds * 100
    tens = 1

    while (end - c - tens * 10) > 10:
        i = c + tens * 10
        leading.append(range(i, i + 10))
        tens += 1

    c += tens * 10
    ones = 1

    while (end - c - ones) > 0:
        i = c + ones
        leading.append(i)
        ones += 1

    leading.append(end)

    return leading 
```

好的，整体可能更深一层循环。但我认为这样可能更清楚。希望，这可以帮助你...

**更新：** 现在我明白你想要什么了。此外，玛丽亚的代码似乎对我不起作用。（对不起...）所以请考虑以下代码：

```
def leading(start, end):

    depth = 2
    while 10 ** depth > end : depth -=1
    leading = []
    const = 0
    coeff = start // 10 ** depth

    while depth >= 0:
        while (end - const - coeff * 10 ** depth) >= 10 ** depth:
            leading.append(str(const / 10 ** depth + coeff) + "X" * depth)
            coeff += 1

        const += coeff * 10 ** depth
        coeff = 0
        depth -= 1

    leading.append(end)

    return leading

print leading(199,411)

print leading(2169800, 2171194)

print leading(1000, 1453)

print leading(1,12) 
```

现在，让我试着解释一下这里的方法。该算法将尝试从值“start”开始查找“end”，并检查“end”是否在下一个 10^2（在本例中为 100）中。如果失败，它将跳跃 10^2 直到成功。当它成功时，它会降低一个深度级别。也就是说，它将使飞跃小一个数量级。并以这种方式循环，直到深度等于零（= 10^0 = 1 的跳跃）。算法在达到“结束”值时停止。

您可能还注意到我已经实现了我提到的包装循环，因此现在可以在变量中定义起始深度（或跳跃大小）。

第一个 while 循环确保第一个跳跃不会超过“结束”值。

如果您有任何问题，请随时提出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:27:36.910

```
def foo(start, end):
    index = 0
    is_lower = False
    while index < len(start):
        if is_lower and start[index] == '0':
            break
        if not is_lower and start[index] < end[index]:
            first_lower = index
            is_lower = True
        index += 1
    return index-1, first_lower

start = '2169800'
end = '2171194'
result = []
while int(start) < int(end):
    index, first_lower = foo(start, end)
    range_end = index > first_lower and 10 or int(end[first_lower])
    for x in range(int(start[index]), range_end):
        result.append(start[:index] + str(x) + 'X'*(len(start)-index-1))
    if range_end == 10:
        start = str(int(start[:index])+1)+'0'+start[index+1:]
    else:
        start = start[:index] + str(range_end) + start[index+1:]

result.append(end)
print "Leading numbers:"
print result 
```

我测试了你给出的例子，它是正确的。希望对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:43:54.180

比最初看起来更难 - 很确定这是可靠的并且可以处理大多数边界条件。：） （很少有！！）

```
def leading(a, b):
    # generate digit pairs a=123, b=456 -> [(1, 4), (2, 5), (3, 6)]
    zip_digits = zip(str(a), str(b))
    zip_digits = map(lambda (x,y):(int(x), int(y)), zip_digits)

    # this ignores problems where the last matching digits are 0 and 9
    # leading (12000, 12999) is same as leading(12, 12)
    while(zip_digits[-1] == (0,9)):         
        zip_digits.pop()            

    # start recursion
    return compute_leading(zip_digits)

def compute_leading(zip_digits):
    if(len(zip_digits) == 1):   # 1 digit case is simple!! :)
        (a,b) = zip_digits.pop()
        return range(a, b+1)

    #now we partition the problem
    # given leading(123,456) we decompose this into 3 problems
    # lows    -> leading(123,129)
    # middle  -> leading(130,449) which we can recurse to leading(13,44)
    # highs   -> leading(450,456)

    last_digits = zip_digits.pop()
    low_prefix  = reduce(lambda x, y : 10 * x + y, [tup[0] for tup in zip_digits]) * 10     # base for lows e.g. 120
    high_prefix = reduce(lambda x, y : 10 * x + y, [tup[1] for tup in zip_digits]) * 10     # base for highs e.g. 450
    lows = range(low_prefix + last_digits[0], low_prefix + 10)
    highs = range(high_prefix + 0, high_prefix + last_digits[1] + 1)

    #check for boundary cases where lows or highs have all ten digits
    (a,b) = zip_digits.pop()    # pop last digits of middle so they can be adjusted
    if len(lows) == 10:
        lows = []
    else:
        a = a + 1

    if len(highs) == 10:
        highs = []
    else:
        b = b - 1

    zip_digits.append((a,b))    # push back last digits of middle after adjustments

    return lows + compute_leading(zip_digits) + highs       # and recurse - woohoo!!

print leading(199,411)

print leading(2169800, 2171194)

print leading(1000, 1452) 
```

# c# - Word Interop Paragraph.Hyphenation 值

> ID：10950171
> 
> 赞同：0
> 
> 时间：2012-06-08T13:51:44.473
> 
> 标签：c#, .net, ms-word, vsto

如何使用 C# 和 Office 互操作在 word 文档中启用段落的断字？

我找到了这篇[文章](http://msdn.microsoft.com/de-de/library/microsoft.office.interop.word.paragraphs.hyphenation%28v=office.11%29.aspx)......但他们正在谈论将属性设置为布尔值，尽管该属性是一个整数。这让我很困惑。

我尝试将paragraph.Hyphenation 设置为1，但这导致异常（值不在范围内）。

我可以设置的可能值是 -1 和 0。它们代表假 (-1) 和真 (0) 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:04:25.877

因为`ParagraphFormat.KeepWithNext`true 是 -1 而 false 是 0。我认为这在所有属性中都是一致的。更好地尝试和错误。

# python - Python语义-for循环声明中的多个参数

> ID：10950176
> 
> 赞同：2
> 
> 时间：2012-06-08T13:52:06.130
> 
> 标签：python

抱歉问了一个愚蠢的问题，但有人可以告诉我以下是什么意思

```
for ctype, (codename, name) in searched_perms: 
```

我不明白括号里发生了什么。`for ctype in serached_perms:`会有意义。

我意识到答案在某个地方的 python 文档中，但由于我不知道我在寻找什么，所以很难找到解释。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T13:53:56.433

这实际上相当于

```
for x in search_perms:
     ctype, y = x
     codename, name = y 
```

或者

```
for x in search_perms:
    ctype = x[0]
    codename = x[1][0]
    name = x[1][1] 
```

即，它将项目`search_perms`成对解包，然后将每对中的第二个项目也作为一对解包。

例子：

```
>>> d = {"ham": "yes", "spam": "no", "eggs": "please"}
>>> for k, v in d.iteritems():
...     print("%s? %s" % (k, v))
...     
eggs? please
ham? yes
spam? no
>>> for i, (k, v) in enumerate(d.iteritems()):
...     print("question %d: %s? %s" % (i, k, v))
...     
question 0: eggs? please
question 1: ham? yes
question 2: spam? no 
```

这是有效的，因为`enumerate(d.iteritems())`生成对，其中每个第二个元素又是一对：

```
>>> list(enumerate(d.iteritems()))
[(0, ('eggs', 'please')), (1, ('ham', 'yes')), (2, ('spam', 'no'))] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T13:54:34.533

`ctype, (codename, name)`和 是一样的`(ctype, (codename, name))`。因此，`searched_perms`需要是 (a,(b,c)) 形式的事物序列，并且在每次循环迭代中，变量`ctype`, `codename`,`name`将被设置为 a,b,c。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:55:37.310

您的列表`searchedparams`应如下所示：

```
In [1]: L = []

In [2]: L.append(('a', ('b', 'c')))

In [3]: L.append(('d', ('e', 'f')))

In [4]: L
Out[4]: [('a', ('b', 'c')), ('d', ('e', 'f'))]

In [6]: for ctype, (codename, name) in L:
    print ctype, codename, name
   ...: 
a b c
d e f 
```

`('a', ('b', 'c'))`是 2 个值的元组，其中右值也是两个值的元组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T13:55:06.647

这意味着`searched_perms`iterable 在迭代期间返回两个元素：第一个是`ctype`，第二个是元组，由另外两个元素组成：`(codename, name)`. 所以`searched_perms`看起来像这样：

```
[[ctype1, (code1, name1)], [ctype2, (code2, name2)], ...] 
```

该语法允许逐个元素`for ctype, (codename, name) in searched_perms`地提取 中的所有内容。`searched_perms`

# msdeploy - 如何在 Visual Studio 生成的 *.deploy.cmd 文件中自动添加 recycleApp 提供程序

> ID：10950177
> 
> 赞同：4
> 
> 时间：2012-06-08T13:52:10.257
> 
> 标签：msdeploy

是否可以将 Visual Studio 2010 配置为在构建 Web 部署包时生成的 deploy.cmd 文件中添加 recycleApp 提供程序及其值？

W3wp 正在锁定 bin 文件夹中的文件，我希望进行应用程序回收将使进程释放它，以便可以安装部署包。

msdeploy.exe -verb:sync -source:recycleApp="Default Web Site/myapp" -dest:auto

关于提供者：[http ://technet.microsoft.com/en-us/library/ee522997%28v=ws.10%29.aspx](http://technet.microsoft.com/en-us/library/ee522997%28v=ws.10%29.aspx)

# json - 通过 RESTful 方法对 Google API 进行身份验证

> ID：10950178
> 
> 赞同：0
> 
> 时间：2012-06-08T13:52:10.247
> 
> 标签：json, authentication, rest, google-calendar-api

我需要将从标准化电子邮件中解析出来的事件自动发布到共享的谷歌日历。解析电子邮件以创建我可以（并且已经完成）的 JSON 对象。但我从未真正*使用过*JSON——我不知道如何将它提交到 Google 日历。我已经阅读并重新阅读了谷歌的文档，但我并没有清楚地理解它。首先，我不明白如何在没有用户实际输入接受的情况下完成身份验证，这会破坏这个应用程序的目的。

基本上，我是一名设计师转为业余开发人员，我最擅长 PHP，而 Javascript 则明显落后。我已经构建了一个 web 应用程序，它将定期调用一个 HTTP 请求到一个 php 文档，该文档应该找到带有要发布的事件的新电子邮件，解析它们并发布它们包含的事件。除了发布部分之外，这一切都已准备就绪并正在等待。如果有人可以帮助我了解在*概念上*需要有一个安静、自动的程序来发布到 Google 日历，我将非常感激。到目前为止 - 只是试图让我的脚在水中 - 这就是我已经到达的地方：

```
<?php 
$url = "https://www.googleapis.com/calendar/v3/calendars/".$calendar."/events?sendNotifications=false&key={".$api_key."}";
?>

<script>
function goGoogle() {
data = "a json object will go here";
xhr = new XMLHttpRequest();
xhr.open("POST", "<?php echo $url?>", true);
xhr.setRequestHeader("Content-type", "application/json");
xhr.send(data); 
xhr.onreadystatechange = function() {
    alert(xhr.responseText);
}
}
</script>
<button onclick="goGoogle()">Sigh</button> 
```

从`alert(xhr.responseText)`电话中，我在第 2 和第 3 阶段得到了这个：

```
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "required",
    "message": "Login Required",
    "locationType": "header",
    "location": "Authorization"
   }
  ],
  "code": 401,
  "message": "Login Required"
 }
} 
```

现在，我*意识到*我实际上并没有提供任何身份验证，所以我并不惊讶它失败了。问题是我不知道*如何*进行身份验证。帮助！？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:39:07.803

首先，请确保我理解 - 您有一个应用程序可以接收来自不同用户的电子邮件，并且您希望将这些电子邮件中的内容发布到需要身份验证的共享 Google 日历（否则您将能够将这些事件发布到我的我根本不喜欢的日历）。此外，您的应用需要在不涉及最终用户的情况下执行此操作。但是，您有一些共享日历的凭据/身份验证，您可以在应用程序中对其进行编码。（否则你可能会再次发布到我的日历）。最后，您在日历中创建的条目将由您的应用“拥有”（也就是说，您不会代表其中一位用户输入它们 - 因为您没有他们的凭据，而且他们是无法授予权限）。

如果这一切都是正确的，我认为您可能开始的地方是使用 ClientLogin 身份验证到 Google Calendar API。相关文档位于： [https](https://developers.google.com/google-apps/calendar/v2/developers_guide_protocol#AuthClientLogin)
://developers.google.com/google-apps/calendar/v2/developers_guide_protocol#AuthClientLogin 您的应用将使用您必须访问共享日历的凭据/身份验证信息。

该页面还可能为您提供其他信息。

如果我误解了您的问题或者我的回答过于含糊，我深表歉意。我没有在代码中访问过 CalendarAPI，但过去几周我一直在研究身份验证和 OAuth2 代码。

# c# - 无法解析属性：PropertyName of：NHibernate 中的类错误

> ID：10950179
> 
> 赞同：3
> 
> 时间：2012-06-08T13:52:11.813
> 
> 标签：c#, asp.net-mvc-3, nhibernate

我第一次使用 NHibernate，在这一行中它为我抛出异常

```
var total = session
                    .QueryOver<Comment>().Where(p => p.Entry.Author == username)
                    .ToRowCountQuery()
                    .FutureValue<int>();

                var results = session
                    .QueryOver<Comment>().Where(p => p.Entry.Author == username)
                    .Fetch(x => x.Entry).Eager()
                    .OrderBy(x => x.Posted).Desc()
                    .Skip(skip)
                    .Take(take)
                    .List(); 
```

例外是

> 无法解析属性：Entry.Author 的：FunnelWeb.Model.Comment

我想，问题是`Entry`对象没有在这里加载。我怎样才能用 Nhibernate 做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:08:39.093

QueryOver 只是 Criteria 的强类型包装器，不允许隐式深度引用。

你必须使用：

```
session.QueryOver<Comment>()
       .JoinQueryOver(x => x.Entry)
       .Where(x => x.Author == username) 
```

或者您可以`Query<>`改用 (LINQ)，它可以使用您尝试过的语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:18:32.110

您需要 JoinAlias 或 JoinQueryOver。我在下面有一个关于如何使用未来查询的示例......

```
Entry entryAlias = null;

var q = session.QueryOver<Comment>()
    .JoinAlias(x => x.Entry, () => entryAlias)
    .Where(() => entryAlias.Author == username);

var totalFuture = q.ToRowCountQuery().FutureValue<int>(); //ToRowcountQuery clones the query, we can reuse it for results

var resultsFuture = q
    //.Fetch(x => x.Entry).Eager() //already joined
    .OrderBy(x => x.Posted).Desc()
    .Skip(skip)
    .Take(take)
    .Future<Comment>();

var results = resultsFuture.ToList(); //both future queries are executed in the same batch 
var total = totalFuture.Value; 
```

# mysql - 如何使用 PDO 准备语句从 MySQL 数据库中获取一条记录？

> ID：10950181
> 
> 赞同：1
> 
> 时间：2012-06-08T13:52:18.447
> 
> 标签：mysql, pdo, prepared-statement

如何使用 PDO 准备语句从 MySQL 数据库中获取**一条记录？**

以“旧”的方式，我可以使用：

```
$MyCaption = mysql_result(mysql_query("SELECT * FROM `photos` WHERE `id` = '56465843362'"),0,"caption"); 
```

PDO 准备好的声明等效于什么？

我试过：

```
$id = '56465843362';
$query = $db->prepare("SELECT `caption` FROM `photos` WHERE `id` = ?");
$query->execute(array($id));
$caption = $query->fetchColumn(); 
```

……但那是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T13:55:46.497

```
SELECT `caption` FROM `photos` WHERE `id` = ? Limit 1 
```

Limit 关键字限制为所需的行数。但是如果没有 order by 子句，您的记录将被随机获取。如果它似乎工作正常，不要假设它总是如此。SQL 标准不保证默认获取的行的顺序。

# wpf - 控件创建为“已折叠”时的 IDataErrorInfo 问题

> ID：10950182
> 
> 赞同：2
> 
> 时间：2012-06-08T13:52:20.920
> 
> 标签：wpf, datatrigger, idataerrorinfo

**编辑**我正在添加额外的代码以进行澄清......

我在让 IDataErrorInfo 错误指示器显示在最初创建为“Collapsed”的控件上时遇到问题，然后使用 DataTrigger 使其可见。

有一个绑定到查找值的 ComboBox 控件，它显示三行...“现金”、“信用卡”和“支票”。我有两个分别绑定到“CreditCardCode”和“CheckNumber”的 TextBox 控件。

TextBox 控件设置了一个 DataTrigger 以使它们仅在选择相关的 ComboBox 值时才可见。如果相关的 TextBox 没有值，数据错误逻辑将显示错误。

这是组合框和文本框的 XAML：

```
<ComboBox IsEditable="False" 
          IsSynchronizedWithCurrentItem="False" 
          SelectedItem="{Binding Path=PaymentType}"
          ItemsSource="{Binding Source={StaticResource paymentTypeLookup}}"
          DisplayMemberPath="{Binding PaymentTypeCode}">
      <ItemsControl.ItemTemplate>
          <DataTemplate>
              <StackPanel Orientation="Horizontal">
                  <TextBlock Text="{Binding Path=PaymentTypeCode,
                                  ValidatesOnDataErrors=True}" />
            </StackPanel>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ComboBox>

<TextBox Name="CCCodeText" 
    Text="{Binding CreditCardCode, ValidatesOnDataErrors=True, 
           ValidatesOnExceptions=True, NotifyOnValidationError=True}" >
    <TextBox.Style>
        <Style TargetType="TextBox">
            <Setter Property="TextBox.Visibility" Value="Collapsed" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=PaymentComboBox, 
                                       Path=SelectedItem.PaymentTypeCode}" 
                             Value="CC_SWIPE">
                    <Setter Property="TextBox.Visibility" 
                                      Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBox.Style>
</TextBox> 
```

这是 PaymentType 对象的代码

```
public virtual PaymentType PaymentType
{
    get { return _paymentType; }
    set
    {
        if (!ReferenceEquals(_paymentType, value))
        {
            var previousValue = _paymentType;
            _paymentType = value;
            FixupPaymentType(previousValue);
            NotifyPropertyChanged("PaymentType");
            OnPaymentTypeChanged(value);
        }
    }
}
private PaymentType _paymentType; 
```

这是 OnPaymentTypeChanged() 函数：

```
void OnPaymentTypeChanged(PaymentType value)
{
    errors.Remove("CheckNumber"); //Avoid Dupes
    errors.Remove("CreditCardCode"); //Avoid Dupes

    if (this.PaymentType != null)
    {
        if (value.PaymentTypeCode == "CHECK" && 
           (this.CheckNumber == String.Empty || this.CheckNumber == null))
           errors.Add("CheckNumber", "Check Number required");

        else if (value.PaymentTypeCode == "CC_SWIPE" 
                 && (this.CreditCardCode == String.Empty || 
                     this.CreditCardCode == null))
            errors.Add("CreditCardCode", "Credit Card Code required");
    }
} 
```

如果 ComboBox 在窗口首次显示时设置为“Credit Card”（并且 CCCodeText 控件可见），则默认红色边框显示正常。但是，如果我将 ComboBox 的值更改为“Check”，并且出现 CheckTextBox 控件，则它缺少红色边框。

当我将 ComboBox 改回“Credit Card”时，红色边框仍然存在。

我在某处缺少刷新属性吗？？？

# ruby - Ruby 范围方法值技术

> ID：10950184
> 
> 赞同：1
> 
> 时间：2012-06-08T13:52:30.670
> 
> 标签：ruby, metaprogramming

```
class Curious
  def calculation
    def calculation
      @retrieved_value
    end
    @retrieved_value = #some kind of intensive process
  end
end 
```

执行上述操作，外部方法将第一次运行，内部方法将在后续时间提供值。与仅执行此操作的单个非嵌套方法相比，这样做的优点或缺点是什么`@retrieved_value ||= #some kind of intensive process`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:19:44.260

您正在重新定义该类的`calculation`方法`Curious`。这将影响其他实例：

```
a = Curious.new
a.calculation # calls "outer" method, this sets @retrieved_value
a.calculation # calls "inner" method

b = Curious.new
b.calculation # calls "inner" method, @retrieved_value not set 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T13:56:26.703

IMO 没有什么优势，缺点是乍一看有点不透明。

根据密集流程的性质，可能会有一些范围界定优势。

# php - PHP / MYSQL 日期不会插入

> ID：10950186
> 
> 赞同：1
> 
> 时间：2012-06-08T13:52:31.983
> 
> 标签：php, mysql, date

我正在尝试将变量中的日期插入 mysql 数据库。列的格式是日期，列中有日期。列中的日期看起来像 yyyy-mm-dd

我的日期变量也看起来像这样，但是它不会将日期插入列中，即使我没有收到错误只是一个白屏。

```
<?php
//here is the code to insert this does not work
mysql_query("INSERT INTO `invoices` (account_id, purchased_date, sales_rep, INV_ID)
VALUES ('".$acctid."', '".$date"','".$row['8']."', '".$invid."' )") or die("load1 -" . mysql_error()); 
```

```
<?php 
//this does work but it does not have the date.
mysql_query("INSERT INTO `invoices` (account_id, sales_rep, INV_ID)
    VALUES ('".$acctid."', '".$row['8']."', '".$invid."')") or die("load1 -" . mysql_error()); 
```

不确定是什么问题。我已经在屏幕上显示了 $date 变量，它看起来很好。2012-06-01

所以我不确定为什么它不能将它插入数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T13:55:34.333

您的错误是您在此行中有一个解析错误：

```
VALUES ('".$acctid."', '".$date"','".$row['8']."', '".$invid."' )") 
```

您的服务器已`display_errors`关闭，因此您看不到致命错误输出。

您可以通过添加连接运算符 ( ) 来修复它，`.`如下所示：

```
VALUES ('".$acctid."', '".$date."','".$row['8']."', '".$invid."' )") 
```

此外，在未来，我发现这样编写查询更具可读性：

```
VALUES ('{$acctid}', '{$date}', '{$row['8']}', '{$invid}') 
```

如果您不想使用插值（即上面使用的字符串“注入”的方法），您仍然可以使用连接（您的原始方法）但使用空格使其更具可读性（并且在尝试执行之前更容易找到语法错​​误它）：

```
"VALUES ('" . $acctid . "', '" . $date . "' , '" . $row['8'] . "', '" . $invid . "')"; 
```

在所有讨厌我的人因为我建议插值而不是串联而回避之前，让我向您[推荐@rasmus的](http://www.twitter.com/rasmus)[这条推文](https://twitter.com/rasmus/status/207856706422706176)，指出插值实际上比串联快，这些天。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T13:58:23.590

```
<?php
//here is the code to insert this does not work
mysql_query("INSERT INTO `invoices` (account_id, purchased_date, sales_rep,   INV_ID) VALUES ('".$acctid."', '".$date"','".$row['8']."', '".$invid."' )") or die("load1 -" .     mysql_error());
?> 
```

错误是：

```
PHP Parse error:  syntax error, unexpected T_CONSTANT_ENCAPSED_STRING on line 1 
```

没有`.`后`$date`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:14:01.880

尝试使用`new \DateTime('yyyy-mm-dd')`

```
<?php
//here is the code to insert this does not work
mysql_query("INSERT INTO `invoices` (account_id, purchased_date, sales_rep, INV_ID)
VALUES ('".$acctid."', '".new \DateTime('yyyy-mm-dd')."','".$row['8']."', '".$invid."' )") or die("load1 -" . mysql_error()); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-08T14:00:00.540

您可以使用

```
mysql_query("INSERT INTO `vipanda2`.`invoices` (account_id, purchased_date, sales_rep, INV_ID)
VALUES ('".$acctid."', '".date('Y-m-d',mktime(0, 0, 0, date("m", $date), date("d", $date), date("Y", $date)))."','".$row['8']."', '".$invid."' )") or die("load1 -" . mysql_error()); 
```

# xml - 从一个xml文件复制到另一个 - powershell

> ID：10950188
> 
> 赞同：7
> 
> 时间：2012-06-08T13:53:01.333
> 
> 标签：xml, powershell

兹德拉沃！现在这个一直困扰着我很多......我正在尝试使用powershell将几个节点从一个XML文件复制到另一个，并环顾整个互联网，但似乎只有在我的电脑上才有通用解决方案问题不工作。所以这是我现在得到的代码：

```
#loading one document
$xml = New-Object XML
$xml.Load("C:\Inetpub\WWWroot\web.config")

#load another
$wconfig = New-Object XML
$wconfig.Load("C:\Users\foo\test.enc")

#now do what everyone on the internet says
$xml.DocumentElement.InsertAfter($wconfig.ImportNode($wconfig.SelectSingleNode($node), $true), $afterNode)) 
```

任何人都知道为什么这个（以及其他几个替代方案，如 .Clone()）总是返回“要插入的节点来自不同的文档上下文”。或者只是给我另一种选择。任何有效的东西：D

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:21:40.627

我认为应该是 `$XML.ImportNode($wconfig.SelectSingleNode`......等等而不是`$wconfig.ImportNode($wconfig.SelectSingleNode`

# asp.net - 为什么这个简单的查询会中断？

> ID：10950191
> 
> 赞同：0
> 
> 时间：2012-06-08T13:53:09.450
> 
> 标签：asp.net, database

我有一个 asp.net 应用程序，它使用 post 表单保存一些用户数据。为此，我在下面列出了一个简单的查询。

```
"UPDATE myTable SET LastUpdatedOn='"
+ DateTime.UtcNow + "', Completed='1' 
WHERE ID='" + requestid + "'" 
```

这有时会失败。但我认为这没有问题。所以请让我知道为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:06:49.460

您应该熟悉参数化查询，并开始使用它们来保护您的系统免受[SQL 注入攻击](http://bobby-tables.com/)。

```
using (var cmd = conn.CreateCommand()) {
    cmd.CommandText =
        "UPDATE myTable SET LastUpdatedOn=@Time, Completed='1' WHERE ID=@Id";
    cmd.Parameters.AddWithValue("@Time", DateTime.UtcNow);
    cmd.Parameters.AddWithValue("@Id", requestid);
    var count = cmd.ExecuteNonQuery();
    if (count != 1) {
        Console.Error.WriteLine(
            "Warning: Cannot update myTable for ID {0}", requestid
        );
    }
} 
```

作为一个额外的好处，这种方法消除了所有可能的数据格式问题，并通过让 SQL Server 缓存查询计划来加快查询速度。但主要的好处是阻止世界上的“Bobby Tables”企图未经授权访问您的系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:00:00.963

`DateTime.UtcNow`考虑`getdate()`在您使用的任何数据库中使用 if Sql Sevrer 或类似函数

```
"UPDATE myTable SET LastUpdatedOn= getdate(), Completed='1' WHERE ID='" + requestid + "'" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T13:57:29.300

`DateTime.UtcNow`不太可能解析为查询的日期时间。尝试：

DateTime.UtcNow.ToString('yyyy-MM-dd hh:mm:ss')

（另外，我可能搞砸了我的“m”，所以仔细检查一下）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:02:33.517

我不完全确定为什么这会中断。我们需要查看表的模式才能更好地了解可能出现的问题。另一方面，我建议您使用参数化查询，而不是简单地连接您的查询。根据输入的来源，您当前的查询可能容易受到 SQL 注入的攻击。尝试将您的代码更改为类似的内容，看看它是否可以缓解错误（这也将缓解 SQL 注入风险）：

```
SqlCommand cmd = new SqlCommand("UPDATE myTable SET LastUpdatedOn = @LastUpdatedOn, Completed = @Completed WHERE ID = @RequestId", sqlConnectionObject);
cmd.Parameters.AddWithValue("@LastUpdatedOn", DateTime.UtcNow);
cmd.Parameters.AddWithValue("@Completed", 1);
cmd.Parameters.AddWithValue("@RequestId", requestid);
cmd.ExecuteNonQuery(); 
```

# android - Android动态onClick

> ID：10950192
> 
> 赞同：1
> 
> 时间：2012-06-08T13:53:12.117
> 
> 标签：android, dynamic, onclick

第一次发帖请轻点...

此代码在 textviews simples 中创建了一个 10 x 10 的充满连字符的表格...

使用 onClickListner 如果单击的文本，我需要它来更改颜色。

它失败了`tv.setTextColor(Color.RED);`

可以排序还是有更好的方法？

谢谢。

_Temp 类：

```
public class _Temp extends Activity implements OnClickListener {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.a_temp);

    TableLayout treeTable = (TableLayout) findViewById(R.id.main_table);

    // Add 10 Rows / 10 Cols ~~~~~~~~~~~~~~~~~~~~~~~~~~
    int idxCount = 0;

    for (int tree = 1; tree <= 10; tree++) {
        idxCount = 0;

        TableRow TableRows = new TableRow(this);
        TableRows.setId(tree * 100 + idxCount);
        TableRows.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
        TableRows.setBackgroundColor(Color.LTGRAY);
        idxCount++;

        for (int bird = 1; bird <= 10; bird++) {
            TextView label_TableCols2 = new TextView(this);
            label_TableCols2.setId(tree * 100 + idxCount);
            label_TableCols2.setBackgroundColor(Color.DKGRAY);
            label_TableCols2.setClickable(true);
            label_TableCols2.setOnClickListener(this);

            label_TableCols2.setText("-");

            TableRows.addView(label_TableCols2); // add the column to the table row
            idxCount++;
        }
        treeTable.addView(TableRows, new TableLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
    }
}

public void onClick(View v) {
    Log.i("scoreTable", "Something Clicked - ID = " + Integer.toString(v.getId()));

    int resId = getResources().getIdentifier(Integer.toString(v.getId()), "id", getPackageName());

    Log.i("scoreTable", "Colour Update 1 - resId = " + Integer.toString(resId));

    TextView tv = (TextView) findViewById(resId);

    Log.i("scoreTable", "Colour Update 2 - Just to see if it gets this far");

    tv.setTextColor(Color.RED);

    Log.i("scoreTable", "Colour Update 3 - Just to see if it gets this far");
}
} 
```

和 a_temp.xml

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <HorizontalScrollView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

                <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:orientation="vertical" >

            <TableLayout
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:id="@+id/main_table"
                android:layout_width="match_parent"
                android:layout_height="fill_parent" >

            </TableLayout>

        </LinearLayout>

    </HorizontalScrollView>

</ScrollView> 
```

**编辑：** 好吧，这太容易了......从充气机怎么样！

因此，单击表格充气器弹出窗口中的一个项目，选择颜色并单击“选择颜色”按钮，更新单击的连字符的颜色。

```
public void onClick(View v) {
    ((TextView) v).setTextColor(Color.RED); // <--- SWEET, WORKING

    AlertDialog.Builder PopUpBuilder = new AlertDialog.Builder(this);

    //...

    PopUpBuilder.setPositiveButton("Choose Colour", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {

            // Do stuff and store global variables

            updateTable();
        }
    });
    AlertDialog PopupDialog = PopUpBuilder.create();
    PopupDialog.show();
} 

public void updateTable() {

    TextView scoreTableTitle = (TextView) findViewById(R.id.textTitle1);
    scoreTableTitle.setText("woo woo"); // <--- WORKING

    ((TextView) v).setTextColor(Color.BLUE); // <--- ????           
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:00:22.477

单击的视图是您的 TextView，因此您只需在侦听器上设置他的颜色：

```
public void onClick(View v) {
    ((TextView) v).setTextColor(Color.RED);
} 
```

# apache - 配置要在本地服务器上测试的 apache

> ID：10950194
> 
> 赞同：0
> 
> 时间：2012-06-08T13:53:29.180
> 
> 标签：apache

如何配置 apache，我可以在没有 DNS 的本地服务器上对其进行测试？我尝试了以下方法，但我不确定它有什么问题。

我正在使用 Centos。

这是我所做的

1.  使用 |ip addr show| 获取 IP 地址

2.  到 etc/hosts 我添加了 |92.168.169.128 tst01|。我从＃1获得了IP

3.  重启 apache |apachectl -k graceful|

在网络浏览器中，如果我去`http://tst01/`我会得到默认的 Apache 页面。

这是我的 httpd.conf

```
ServerRoot "/etc/apache2"
PidFile ${APACHE_PID_FILE}
User ${APACHE_RUN_USER}
Group ${APACHE_RUN_GROUP}
ServerTokens ProductOnly
ServerAdmin asdf@example.com

<VirtualHost *:80>
  ServerName tst01
  DocumentRoot /tmp/public_html

  LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
  ErrorLog /tmp/apache_logs/error.log
  CustomLog /tmp/apache_logs/access.log combined    
</VirtualHost> 
```

我将一个非常简单的索引文件放在：/tmp/public_html/index.html。

/tmp/public_html 的权限是 755

如果我把它放在浏览器中，我可以看到我的索引文件：file:///tmp/public_html/index.html

如果我查看 /tmp/apache_logs 我没有任何日志。我什至尝试打开777的权限

关于让我的 index.html 显示而不是默认的 apache 页面的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T12:24:30.530

问题是我使用了错误的配置文件。Centos 默认安装了 apache（我安装到虚拟机上），我安装在自定义目录中。Centos 正在选择它的版本，从不查看我的配置。我做了一个看看配置的位置。

此外，/etc/hosts 文件应设置为 127.0.0.1。

# sql-server - 我是否需要在 SQL Server 过程中使用 try..catch 块和显式回滚？

> ID：10950197
> 
> 赞同：17
> 
> 时间：2012-06-08T13:53:38.263
> 
> 标签：sql-server, sql-server-2008

如果我正在编写 SQL Server (2008r2) 过程，并将其包装在事务中，是否需要将其显式包含在 try..catch 块中，然后在 catch 块中显式调用回滚，或者它会退出并自己回滚一样吗？

IE：

这是如何做到的：

```
 begin transaction

    begin try
    delete from....

    insert into...
    end try
    begin catch
    rollback transaction
    return
    end catch

    commit transaction 
```

与之比较：

```
 begin transaction
    delete from....

    insert into...
    commit transaction 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-08T14:04:01.693

您的问题的答案取决于[`SET XACT_ABORT`](http://msdn.microsoft.com/en-us/library/ms188792.aspx)设置：

> 指定当 Transact-SQL 语句引发运行时错误时 SQL Server 是否自动回滚当前事务。
> 
> 当 SET XACT_ABORT 为 ON 时，如果 Transact-SQL 语句引发运行时错误，则整个事务将终止并回滚。
> 
> 当 SET XACT_ABORT 为 OFF 时，在某些情况下，只有引发错误的 Transact-SQL 语句被回滚并且事务继续处理。根据错误的严重程度，即使 SET XACT_ABORT 为 OFF，也可能回滚整个事务。 **关闭是默认设置。**
> 
> 编译错误（例如语法错误）不受 SET XACT_ABORT 影响。

例如，试试下面的代码。第一次除以 0 会引发错误，但会*继续执行*。第二次除以零会引发错误并停止执行：

```
begin transaction

set xact_abort off

select 1 / 0 -- causes divide by zero error, but continues
select @@trancount -- returns 1

set xact_abort on

select 1 / 0 -- causes divide by zero error and terminates execution
select @@trancount -- we never get here

rollback 
```

如果 XACT_ABORT 为 ON，则错误将中止事务，您不需要 TRY / CATCH。

如果 XACT_ABORT 为 OFF，您将需要检查每个语句的状态以查看是否发生错误：

```
begin transaction

delete from...
if @@error <> 0
begin
    if @@trancount > 0
        rollback
    return
end

insert into...
if @@error <> 0
begin
    if @@trancount > 0
        rollback
    return
end

commit 
```

但是，如果您发现需要 TRY / CATCH 的情况，您可能需要在错误发生时做一些特殊的事情。如果是这样，不要忘记尝试/捕获异常处理：

```
begin transaction

set xact_abort on

begin try
    select 1 / 0 -- causes divide by zero error and terminates execution
    select @@trancount -- we never get here
    commit
end try
begin catch
    select xact_state() -- this will be -1 indicating you MUST rollback before doing any other operations
    select @@trancount -- this will probably be one, because we haven't ended the transaction yet
    if xact_state() <> 0
    begin try
        select 'rollback'
        rollback

        -- do something to handle or record the error before leaving the current scope
        select 'exception processing here'
        --insert into...
    end try
    begin catch
        -- ignore rollback errors
    end catch

end catch 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T13:59:11.883

如果在大多数情况下出现错误，回滚将自动发生，但不是全部

如果您想保证在开始事务之前使用 SET XACT_ABORT ON 回滚所有错误

最佳实践是使用 try-catch 块明确地捕获错误并在那里采取行动，可能包括回滚和报告/记录错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:00:13.507

这取决于错误的严重程度。足够高——也许是16？-- 该过程可能会在失败的线路处停止，从而使交易保持**打开状态**并锁定到位。如果事务中有任何出错的机会，您肯定希望将其包装在 try-catch 块中，就像您在第一个示例中所做的那样。

# mysql - 如何将uuid存储为数字？

> ID：10950202
> 
> 赞同：79
> 
> 时间：2012-06-08T13:54:06.360
> 
> 标签：mysql, uuid

根据问题的答案，[MySQL](https://stackoverflow.com/questions/2365132/uuid-performance-in-mysql/2365176)中的 UUID 性能，回答者建议将 UUID 存储为数字而不是字符串。我不太确定如何做到这一点。任何人都可以给我一些建议吗？我的红宝石代码如何处理？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-06-08T14:51:59.737

如果我理解正确，您在主列中使用 UUID？人们会说常规（整数）主键会更快，但是还有另一种方法可以使用 MySQL 的阴暗面。事实上，当需要索引时，MySQL 使用二进制比其他任何东西都快。

由于 UUID 是 128 位并且被写为十六进制，因此加速和存储 UUID 非常容易。

首先，在您的编程语言中删除破折号

从`110E8400-E29B-11D4-A716-446655440000`到`110E8400E29B11D4A716446655440000`。

现在它是 32 个字符（如 MD5 哈希，这也适用）。

由于`BINARY`MySQL 中的 single 大小为 8 位，`BINARY(16)`因此是 UUID 的大小（8*16 = 128）。

您可以使用以下方式插入：

`INSERT INTO Table (FieldBin) VALUES (UNHEX("110E8400E29B11D4A716446655440000"))`

并使用以下查询：

`SELECT HEX(FieldBin) AS FieldBin FROM Table`

现在在您的编程语言中，在位置 9、14、19 和 24 处重新插入破折号以匹配您的原始 UUID。如果位置总是不同，您可以将该信息存储在第二个字段中。

完整示例：

```
CREATE TABLE  `test_table` (
    `field_binary` BINARY( 16 ) NULL ,
    PRIMARY KEY (  `field_binary` )
) ENGINE = INNODB ;

INSERT INTO  `test_table` (
    `field_binary`
)
VALUES (
    UNHEX(  '110E8400E29B11D4A716446655440000' )
);

SELECT HEX(field_binary) AS field_binary FROM `test_table` 
```

如果您想将此技术用于任何十六进制字符串，请始终`length / 2`使用字段长度。因此，对于 sha512，该字段将是`BINARY (64)`因为 sha512 编码长度为 128 个字符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-11-02T20:45:09.377

Percona 博客有一篇文章（包括基准测试）回答了您的问题：[以优化的方式存储 UUID](https://www.percona.com/blog/2014/12/19/store-uuid-optimized-way/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-29T12:24:27.817

我认为使用二进制文件不是一个好主意。

假设您要查询某个值：

```
SELECT HEX(field_binary) AS field_binary FROM `test_table` 
```

如果我们返回多个值，那么我们将多次调用 HEX 函数。

但是，主要问题是下一个：

```
SELECT * FROM `test_table`
    where field_binary=UNHEX('110E8400E29B11D4A716446655440000') 
```

并在 where 中使用函数，只需忽略索引。

还

```
SELECT * FROM `test_table`
    where field_binary=x'skdsdfk5rtirfdcv@#*#(&#@$9' 
```

可能会导致很多问题。

# symfony - Symfony 2：添加自定义表单元素，而不是在实体中

> ID：10950203
> 
> 赞同：33
> 
> 时间：2012-06-08T13:54:10.927
> 
> 标签：symfony, symfony-forms

我使用 Symfony2，我想创建一个注册表单。我不想使用 FOSUserBundle。

因此，我创建了一个实体帐户（包含字段：用户名、密码、电子邮件...）并创建了表单：

```
 $account = new Account();

$form = $this->createFormBuilder($account)
  ->add('username',         'text', array('label' => 'Nom de compte :'))
  ->add('password',    'password', array('label' => 'Mot de passe :'))
  ->add('email',            'email', array('label' => 'Adresse email :'))
  ->getForm(); 
```

现在，我想为密码添加一个确认字段。但是，当我尝试使用 add() 方法添加字段时，例如“password_confirmation”，我有这个：

> 类“App\FrontBundle\Entity\Account”中不存在属性“password_confirmation”、方法“getPasswordConfirmation()”和方法“isPasswordConfirmation()”

如何添加自定义字段？之后，如何验证它？

谢谢你。BR。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-01T01:00:16.443

Symfony 2.1 的更新：

`property_path`已被弃用，您应该使用[mapped](http://symfony.com/doc/current/reference/forms/types/form.html#mapped)。语法保持不变：

```
->add('password_confirmation', 'password', array('mapped' => false)) 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-06-08T16:13:05.087

在正常情况下，您需要使用[property_path](http://symfony.com/doc/current/reference/forms/types/field.html#property-path)选项明确指定 *password_confirmation* 不是实体的一部分。

```
->add('password_confirmation', 'password', array('property_path' => false)) 
```

然后使用[CallBackValidator](http://symfony.com/doc/current/reference/constraints/Callback.html)对其进行验证。

**但是**，在这种特定情况下，您想要重复一个字段，[重复](http://symfony.com/doc/current/reference/forms/types/repeated.html)的小部件可以为您做到这一点。

```
->add('password_confirmation', 'repeated', array(
    // See the docs :)
)); 
```

# php - 来自android的数据未在php上发布

> ID：10950208
> 
> 赞同：0
> 
> 时间：2012-06-08T13:54:22.980
> 
> 标签：php, android, json, web-services, latitude-longitude

我正在尝试的是获得我当前的位置（坐标），并且我想在网站上发布这些坐标。我已经使用 WAMP 制作了一个服务器。我已经编写了 php 代码和 java 中的代码。没有错误但没有数据发布在网站上

PHP代码

```
<?php
echo 'Hello, world!';
$json = $_GET['jsonpost'];//get the post you sent...
$data = json_decode($json); //decode the json formatted string...
print_r($data);
$id = $data->id;
$devid = $data->devid;
$latitude = $data->latitude;
$longitude = $data->longitude;
$service = $data->service;
$con = mysql_connect("","","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }
mysql_select_db("a5234826_ul", $con);
$devid = $_POST['devid']; 
$latitude = $_POST['latitude'];
$longitude = $_POST['longitude'];
echo "devid" +$devid;
echo "latitude" + $latitude;
echo "longitude" + $longitude; 
$sql = "INSERT INTO  `a5234826_ul`.`locations` (
`id` ,
`devid` ,
`latitude` ,
`longitude` ,
`service`
)
VALUES (
NULL ,  '$devid',  '$latitude',  '$longitude', '$service'  
)";
if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
mysql_close($con);
echo json_encode($variable);
?> 
```

**编辑** LocationService.java

```
 @Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

public int onStartCommand(Intent intent, int flags, int startId) {
    PowerManager pm = (PowerManager)getSystemService(Context.POWER_SERVICE);
    wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "lock");
    wl.acquire();
    context = this;
    final String who = intent.getStringExtra("who");
    final LocationManager locMan = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    final LocationListener listener = new LocationListener(){

        // start location changed

        public void onLocationChanged(Location loc) {
            double latitude = loc.getLatitude();
            double longitude = loc.getLongitude();

            // Create a new HttpClient and Post Header
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://.../serverFile.php");
            JSONObject json = new JSONObject();

            TelephonyManager telephonyManager = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
            String devid = telephonyManager.getDeviceId();

            String postData = "{\"request\":{\"type\":\"locationinfo\"},\"userinfo\":{\"latitude\":\""+latitude+"\",\"longitude\":\""+longitude+"\",\"devid\":\""+devid+"\"}}";

            try {  

                json.put("longitude", longitude);//place each of the strings as you did in postData method
                json.put("latitude", latitude);

                json.put("devid", devid);

                JSONArray postjson=new JSONArray();
                postjson.put(json);
                httppost.setHeader("json",json.toString());
                httppost.getParams().setParameter("jsonpost",postjson);     
                HttpResponse response = httpclient.execute(httppost);

                // for JSON retrieval:
                if(response != null)
                { 
                InputStream is = response.getEntity().getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(is));
            StringBuilder sb = new StringBuilder();
            String line = null;
            try {
                while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
                }
                } catch (IOException e) {
                e.printStackTrace();
                } finally {
                try {
                is.close();
                } catch (IOException e) {
                e.printStackTrace();
                }
                }
                String jsonStr = sb.toString(); //take the string you built place in a string

                JSONObject rec = new JSONObject(jsonStr);
                String longitudecord = rec.getString("lon");
                    String latitudecord = rec.getString("lat");
                // ...
                }
                }catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            if (who.equals("me")){
                Intent i = new Intent(context.getPackageName()+".LocationReceived");
                i.putExtra("lat", String.valueOf(latitude));
                i.putExtra("longitude", String.valueOf(longitude));
                i.putExtra("accuracy", String.valueOf(loc.getAccuracy()));
                context.sendBroadcast(i);
                Notification notif = new Notification();
                NotificationManager nm = (NotificationManager)context.getSystemService(Context.NOTIFICATION_SERVICE);
                notif.tickerText = "Location Found!";
                notif.icon = R.drawable.ic_launcher;
                notif.flags = Notification.FLAG_AUTO_CANCEL;
                notif.when = System.currentTimeMillis();
                Intent notificationIntent = new Intent(context, TestLocatorActivity.class);
                notificationIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                notificationIntent.putExtra("lat", String.valueOf(latitude));
                notificationIntent.putExtra("longitude", String.valueOf(longitude));
                notificationIntent.putExtra("accuracy", String.valueOf(loc.getAccuracy()));
                PendingIntent contentIntent = PendingIntent.getActivity(context, 0, notificationIntent, 0);
                notif.setLatestEventInfo(context, "Location Found!", "Click to open.", contentIntent);
                nm.notify(0, notif);
            } else {
                SmsManager smsMan = SmsManager.getDefault();
                smsMan.sendTextMessage(who, null, "http://maps.google.com/maps?q=loc:"+latitude+","+longitude, null, null);
                smsMan.sendTextMessage(who, null, "Latitude: "+latitude+"\nLongitude: "+longitude, null, null);
            }
            locMan.removeUpdates(this);
            try {
                wl.release();
            } catch (Exception e){
                e.printStackTrace();
            }
            stopSelf();
        }

        public void onProviderDisabled(String provider){

        }

        public void onProviderEnabled(String provider) {
            //Log.i(tag, "GPS IS ON");
        }

        public void onStatusChanged(String provider, int status, Bundle extras){
            switch(status) {
                case LocationProvider.OUT_OF_SERVICE:
                case LocationProvider.TEMPORARILY_UNAVAILABLE:
                case LocationProvider.AVAILABLE:
                    break;
            }
        } };

    locMan.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, listener);
    locMan.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, listener);

    return 2;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:03:30.387

就像第一个猜测一样，第 3 行不应该是：

```
$json = $_POST['jsonpost'];//get the post you sent... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:15:53.990

如果将第 3 行更改为：

```
$json = $_REQUEST['jsonpost']; 
```

您将通过 HTTP 支持 POST 和 GET 方法。如果您在开发环境中工作以确保请求在没有 HTTP 请求细节的情况下发送到您的服务器，这将很有用。

应谨慎使用 $_REQUEST，因为该变量将包含 $_COOKIES、$_GET 和 $_POST 的内容。

**在脚本中访问数据后，您应该始终对其进行清理**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T23:00:34.790

他们与服务器有任何连接吗？

您是否检查了 /etc/httpd/logs/.. 或您的分发记录 http 流量的任何位置？我会首先这样做以确定流量实际上是从设备发送的。

如果成功，是否会填充数据库？您还可以简单地添加语句以将 php 代码跟踪到文件（例如 /tmp）并跟踪该文件以查看错误是否存在于代码中，或者只是遵循代码执行模式，即使在这种简单的情况下也是如此。

你正在做一个死（'无法连接：'。mysql_error（））; 和 print_r，以及写 hello world，你实际上在哪里查看这个！？正如我提到的，将其写入 /tmp 文件进行分析。

当然，我正在假设您的服务运行正常。日志猫说什么？他们的任何可辨别的输出是否表明存在问题？

php 端的代码本身看起来有些仓促，在这里并不太关键，但这里的一些纪律可能会在将来为您节省很多问题。echo json_encode($variable); 是什么？在代码的末尾做什么？

# algorithm - CBlobresult 类中对 BlobAnalysis 的未定义引用

> ID：10950214
> 
> 赞同：1
> 
> 时间：2012-06-08T13:54:39.330
> 
> 标签：algorithm, visual-c++, opencv, blobs

我正在研究交通监控系统，现在我想检测没有。汽车并根据它们的大小对它们进行分类。我使用平均方法将汽车作为斑点，现在我试图通过获取我在阈值图像中得到的斑点的坐标来在汽车周围绘制矩形。但是我得到一个错误而使用**CblobResult**，说“未定义的引用 `BlobAnalysis(_IplImage*, unsigned char, _IplImage*, bool, bool, std::vector >&)” 我怎样才能消除这个错误？

# python - 卡住的进程需要在 pythonanywhere 上被杀死

> ID：10950216
> 
> 赞同：3
> 
> 时间：2012-06-08T13:54:42.190
> 
> 标签：python, pythonanywhere

计划页面上的终止按钮目前在 pythonanywhere 上不起作用。在我等待 ResolverSys 乐于助人的人的支持时，有什么想法可以解决吗？

我目前无法从控制台打开新进程 我的计划任务没有运行。

但是，我可以通过 SSH 登录，所以如果有使用它的想法，我可以帮助自己。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:04:18.180

我终于想出了解决这个问题的方法。

计划页面上的 kill 链接包括 pid。我能够从 ssh 会话中提取这些 pid 以与 kill 一起使用。

因此，例如，如果您的 pid 为 100，您可以使用 ssh 处理它

```
kill 100 
```

只需将链接中的 100 替换为您的 pid 即可终止计划页面上列出的进程。

我希望我早点想到它，但希望其他任何有问题的人都能从这个解决方案中受益。

# javascript - 如果有特定值，则在表中显示行

> ID：10950218
> 
> 赞同：0
> 
> 时间：2012-06-08T13:54:47.903
> 
> 标签：javascript, sql, database, appcelerator

我是使用 SQL 和数据库的新手；到目前为止，我的应用程序一直很本地化。但是，我有一个在我的应用程序中填充表的数据库，没有什么过于复杂的。

我想加入收藏夹菜单。我解决这个问题的方法是在 SQL 数据库中创建一个标题为 的列`Favorite`，然后检查该值是 0（未收藏）还是 1（收藏）。现在，如何遍历 SQL 数据库中的所有行，检查它们是否被收藏，然后将它们打印到表中？

我将编写一些语音代码来更好地了解我的目标：

```
var rows = db.execute('SELECT DISTINCT entity_name FROM entity_info');
        while (rows.isValidRow()) {
            if (FavoritesValue FROM db == 1) { 
//This line here is what I need ^^^ The syntax is not right, its an example.
                var row = Ti.UI.createTableViewRow({
                    title:rows.fieldByName('entity_name')
                });
            }
            rows.next();
        } 
```

我在代码中标记了需要帮助的行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T13:57:14.740

我不会返回您不需要的数据。只需将您的条件作为 SQL 语句的一部分：

改变

```
SELECT DISTINCT entity_name FROM entity_info 
```

到

```
SELECT DISTINCT entity_name FROM entity_info WHERE favorited = 1 
```

# ios - iOS Facebook SSO 用于 Air 应用和 Web 服务身份验证

> ID：10950219
> 
> 赞同：3
> 
> 时间：2012-06-08T13:54:49.437
> 
> 标签：ios, web-services, authentication, air, single-sign-on

我们正在使用 Adob​​e Flex/Air 开发一个 iOS 应用程序。该应用程序使用需要通过 facebook 登录进行用户身份验证的 Web 服务。目前，我们使用服务器端身份验证：在完成 facebook 登录的 WebView 中显示了一个登录 URL。这样，我们就得到了一个可以在服务器端使用的 access_token。

这非常有效，但如果我们可以将单点登录与 facebook ios 应用程序一起使用会更好。据我所读，这应该在客户端工作，但我还没有找到一种方法来验证服务器端的用户。

facebook 的 access_token 可用于服务器端或客户端，因此来自客户端登录的 access_token 不适用于服务器端。

提前感谢您的想法，

亨克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T05:59:13.023

据我所见，您使这比实际预期的要复杂得多。利用 Facebook iOS SDK，在您的应用程序中验证用户身份所涉及的所有繁重工作都由 Facebook SDK 处理。*如果没有整个*Facebook SDK的便利，则无需单独提供登录表并管理应用本地存储和 Facebook 服务器之间的访问令牌交换。

此链接向您展示如何在您的 iOS 应用程序中本地实现 SSO。这真的很简单。 [http://developers.facebook.com/docs/mobile/ios/build/#implementsso](http://developers.facebook.com/docs/mobile/ios/build/#implementsso)

然后，我了解到您将身份验证信息或中央用户数据库信息保存在外部服务器上。**FB客户端和你自己的服务器之间信息同步**的最好方法是在你收到FB SDK返回的登录信息后简单的和你的服务器核对一下。

这是一个简单的细分：

1.  使用 Facebook 的标准 SDK 登录用户（参见上面的链接）。

2.  在该`-didLogin`方法（或您的 Adob​​e AIR 环境中的任何等效方法）中，检查 FB 与您的服务器返回的访问令牌。不确定您使用的是什么服务器架构，但可以肯定地说这将在 FB SDK 之外进行。此外，将访问令牌保存在应用程序的用户默认值中，以便用户下次不必再次登录。整个过程应该（并且本质上会）感觉比听起来要快得多。

3.  如果与服务器的检查成功返回，则通知用户登录成功。如果不是，则显示一个错误视图，解释用户被拒绝/未登录的原因。

为什么要这样做？原因很简单。可以安全地假设您让用户通过 Facebook 登录您的应用程序的原因是您可以请求用户的 Facebook 信息（即提要、照片、喜欢、评论等）。最简单（也是最好）的方法是通过 FB SDK 本身。SDK 在幕后处理了很多事情，例如随时间推移的访问令牌验证、令牌寿命的延长、令牌的有效性等等。这样，您就不必担心在发生更改时同步服务器信息和实时客户端信息。只需通过 FB iOS SDK 进行身份验证，然后再进行其余的处理。

如果有什么我应该澄清的，或者即使我完全错过了你的问题的重点，请在下面评论——我倾向于继续前进，可能会偏离重点。:)

干杯! 海妖

# django - django-nonrel mongodb中User.username的唯一索引？

> ID：10950220
> 
> 赞同：0
> 
> 时间：2012-06-08T13:54:51.580
> 
> 标签：django, mongodb, django-nonrel

我正在 django-nonrel 中构建一个以 mongoDB 作为后端的应用程序。我一直在尝试使用开箱即用的用户身份验证系统，但我一直遇到奇怪的问题。

最新的问题是创建用户。当我调用 User.objects.create_user 时，似乎没有任何唯一性验证。我可以创建**多个用户名完全相同的用户**。我曾预计用户名会强制执行唯一索引，但似乎并非如此。

如果这是我自己的模型之一，我会尝试在模型中添加“unique=True”，然后同步数据库以实现索引。由于我使用的是内置模型，因此我不确定如何进行。

另一种可能性可能是硬编码 syncdb 以添加索引。不过，这似乎很笨拙。在这里前进的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:33:58.293

`username`已经有了`unique=True`。您需要运行`syncdb`才能安装 MongoDB 索引。

# html - CSS background-image : url("...") 属性也有 ALT？

> ID：10950221
> 
> 赞同：0
> 
> 时间：2012-06-08T13:54:53.520
> 
> 标签：html, css

我在 TD 的表格中插入图像

`style="background-image: url("my_url_goes_here")`

然后我在该 TD 中应用一个透明的 PNG 蒙版，使其圆角图像（与背景角颜色相同，并显示图片的中间）

`style = "background-image: url()`我想知道我是否可以在 CSS 部分（使用图像中的 ALT。

如果不清楚我在问什么，我会进一步解释，只是问。

另外，我的一个朋友几分钟前通过电话告诉我，css3 圆形边框可以应用于各种事物，不仅是边框，还包括图像等。如果是这样的话，那就太好了，我我不确定圆形边框也会使图像变圆，从未尝试过（除了通常的 IE，它们显示为方形）。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T13:59:58.243

1.  不，您不能添加`alt`到背景图像
2.  是的，这是可能的 - [http://jsfiddle.net/TyFM7/](http://jsfiddle.net/TyFM7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T13:58:34.027

没有 css 不支持 alt 标签。

至于用 CSS 圆角图像是可能的。

[http://www.css3.info/preview/rounded-border/](http://www.css3.info/preview/rounded-border/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:00:13.163

该`alt`属性旨在在没有加载资源的情况下提供等效文本。它不会出现在背景图像中，而是出现在图像、区域等中。

来源：[http ://www.w3.org/TR/html4/struct/objects.html#h-13.8](http://www.w3.org/TR/html4/struct/objects.html#h-13.8)

至于圆角，`border-radius`也适用于图像 -*即使在 IE*中也是如此。如果您想查看为该属性提供样式的当前最佳方法，请查看[http://css3please.com](http://css3please.com)。

```
img.rounded {
    -webkit-border-radius: 12px;
    border-radius: 12px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T14:02:54.207

背景图像不需要 alt 标签，因为您不希望这些实际被索引。

CSS 边框半径可以添加到大多数事物中，这是添加了边框半径的图像示例：

[边框半径为 30px 的图像示例](http://jsfiddle.net/ZMrbg/)

# dojo - Dijit：关闭多个选项卡

> ID：10950226
> 
> 赞同：0
> 
> 时间：2012-06-08T13:55:27.327
> 
> 标签：dojo

假设我在选项卡容器中有以下 Dijit 选项卡：

```
tab_1
tab_dave
tab_2
tab_3
...
tab_n 
```

我怎么能关闭除 之外的所有选项卡`tab_dave`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:15:11.863

一种方法是遍历所有子节点，删除没有特定名称或 ID 的子节点。

```
function closeAllBut(containerId, tabId)
{
    var tc = dijit.byId(containerId),
        tabs = tc.getChildren();

    for(var i = 0; i < tabs.length; i++)
    {
        if(tabs[i].id != tabId) tc.removeChild(tabs[i]);
    }
} 
```

不过看起来很慢，如果有更清洁的方法会很好（所以不要接受我的回答！:)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-08T22:33:02.267

使用 dojo 检查*dojo.query* [http://dojotoolkit.org/reference-guide/1.10/dojo/query.html查询](http://dojotoolkit.org/reference-guide/1.10/dojo/query.html)

查询元素类型或类名等，提供第二个参数

```
dojo.forEach(dojo.query(".tabs", "containerId"), 
    function(closeTab) {
        //doStuff
    }
); 
```

但是，如果有很多选项卡，您可以销毁（递归）整个 tabContainer 并构建一个只有 1 个元素的新选项卡。

# nginx - 在优雅的信号上，nginx 在尝试连接到 uWSGI 套接字时抛出连接被拒绝

> ID：10950229
> 
> 赞同：4
> 
> 时间：2012-06-08T13:55:36.347
> 
> 标签：nginx, uwsgi

这个问题让我感到困惑，因为我似乎在关注文档中允许优雅重启的所有内容。

我在皇帝模式下运行 uWSGI，有一堆附庸。当我尝试优雅地重启其中一个 vassal 时，我收到了`502 Bad Gateway`大约半秒的 nginx 响应。这里有一些信息：

我的附庸 .ini 文件之一：

```
[uwsgi]
master = true
processes = 2
home = /var/www/.virtualenvs/www.mysite.com
socket = /tmp/uwsgi.sock.myapp
pidfile = /tmp/uwsgi.pid.myapp
module = myapp
pythonpath = /var/www/www.mysite.com/mysite
logto = /var/log/uwsgi/myapp.log
chmod-socket = 666
vacuum = true
gid = www-data
uid = www-data 
```

然后，我想优雅地重新启动这个过程：

```
kill -HUP `cat /tmp/uwsgi.pid.myapp` 
```

vassal 日志文件的输出看起来不错（我认为？）

```
...gracefully killing workers...
Gracefully killing worker 1 (pid: 29957)...
Gracefully killing worker 2 (pid: 29958)...
binary reloading uWSGI...
chdir() to /var/www/www.mysite.com/vassals
closing all non-uwsgi socket fds > 2 (max_fd = 1024)...
found fd 3 mapped to socket 0 (/tmp/uwsgi.sock.kilroy)
running /var/www/.virtualenvs/www.mysite.com/bin/uwsgi
*** has_emperor mode detected (fd: 15) ***
[uWSGI] getting INI configuration from kilroy.ini
open("/var/log/uwsgi/kilroy.log"): Permission denied [utils.c line 250]
unlink(): Operation not permitted [uwsgi.c line 998]
*** Starting uWSGI 1.2.3 (64bit) on [Fri Jun  8 09:15:10 2012] ***
compiled with version: 4.6.3 on 01 June 2012 09:56:19
detected number of CPU cores: 2
current working directory: /var/www/www.mysite.com/vassals
writing pidfile to /tmp/uwsgi.pid.kilroy
detected binary path: /var/www/.virtualenvs/www.mysite.com/bin/uwsgi
setgid() to 33
setuid() to 33
your memory page size is 4096 bytes
detected max file descriptor number: 1024
lock engine: pthread robust mutexes
uwsgi socket 0 bound to UNIX address /tmp/uwsgi.sock.kilroy fd 3
Python version: 2.7.3 (default, Apr 20 2012, 23:04:22)  [GCC 4.6.3]
Set PythonHome to /var/www/.virtualenvs/www.mysite.com
*** Python threads support is disabled. You can enable it with --enable-threads ***
Python main interpreter initialized at 0x19e3e90
your server socket listen backlog is limited to 100 connections
*** Operational MODE: preforking ***
added /var/www/www.mysite.com/gapadventures/ to pythonpath.
WSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x19e3e90 pid: 30041 (default app)
*** uWSGI is running in multiple interpreter mode ***
spawned uWSGI master process (pid: 30041)
spawned uWSGI worker 1 (pid: 30042, cores: 1)
spawned uWSGI worker 2 (pid: 30043, cores: 1) 
```

但是，当我尝试在此之后快速访问该站点时，我的 nginx 日志会得到以下结果：

```
2012/06/08 09:44:43 [error] 5885#0: *873 connect() to unix:///tmp/uwsgi.sock.kilroy failed (111: Connection refused) while connecting to upstream, client: 10.100.50.137, server: mydomain.com, request: "GET /favicon.ico HTTP/1.1", upstream: "uwsgi://unix:///tmp/uwsgi.sock.kilroy:", host: "mydomain.com" 
```

这在发送信号后大约半秒发生，所以这显然不是很优雅。

有什么建议吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T06:01:04.107

更正 nginx 配置和 uWSGI 中的套接字路径。套接字必须相同

曾是

```
unix:///tmp/uwsgi.sock.kilroy 
```

或者

```
/tmp/uwsgi.sock.myapp 
```

需要：

nginx

```
unix:/tmp/uwsgi.sock.myapp 
```

和

uwsgi

```
socket = /tmp/uwsgi.sock.myapp 
```

# c# - 如何为不同的 Web 应用程序使用相同的 URL

> ID：10950230
> 
> 赞同：0
> 
> 时间：2012-06-08T13:55:36.550
> 
> 标签：c#, asp.net, subdomain, asp.net-routing

我有一个包含 2 个 Web 应用程序的项目，我想使用相同的 URL 来访问这两个应用程序

1）公司使用的管理站点：appcompany.com

*   一个网络表单应用程序

2) 公司客户使用的一般网站：[CUSTOMER_ID].appcompany.com

*   也是一个 Web 表单应用程序，但使用 ROUTING 从子域中确定客户。

目前，在浏览器中键入**appcompany.com 会将**您带到主页，指示未指定客户

键入**123.appcompany.com 会将**您带到为客户 123 定制的页面。

如前所述，通用站点应用程序可以确定何时未指定客户并可以重定向 - 但重定向到管理站点可能需要另一个 URL，因为它们是不同的项目

问题是我不知道如何**让 appcompany.com 在**没有 2 个 URL 的情况下访问管理站点。

**更新**

我正在使用 asp.net ROUTING 来模拟子域路由，以防我没有权限访问多个物理子域

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:22:49.983

您需要在 IIS 管理员中指定它。您需要创建 2 个不同的应用程序：

*   1) 对于管理站点
*   2) 对于客户应用程序

每一个都必须指向您实现应用程序的物理目录。

然后你必须编辑绑定：

*   1）只添加一个主机头“appcompany.com”
*   2）您需要为每个客户添加一个主机头：“cust1.appcompany.com”、“cust2.appcompany.com”等

IIS will redirect each request to the specified app: You should add the binding for each company in the same moment where you add the DNS entry for it.

# ruby-on-rails - Rails 3.2：尝试通过嵌套表单传递用户字段

> ID：10950235
> 
> 赞同：0
> 
> 时间：2012-06-08T13:55:50.100
> 
> 标签：ruby-on-rails, ruby, nested-forms

所以基于 Ryan Bates rails cast (http://railscasts.com/episodes/196-nested-model-form-revised) 我正在创建一个嵌套表单。我试图以理想方式工作的rails应用程序部分执行以下操作：

*   让当前用户提问
*   然后在之后提供该问题的答案

我设法让一切正常工作，除了当我在填写完所有内容后尝试提交表单时，我不断收到以下错误：

```
undefined method `meter_id' for nil:NilClass

app/models/answer.rb:13:in `associate_with_meter_id'
app/controllers/questions_controller.rb:13:in `create' 
```

我相信我知道出了什么问题，但我不知道如何解决它。Meter_id 返回一个未定义的值，因为它没有被传递正确的值。这是将meter_id（答案）与meter_id（用户）相关联的方法：

```
def associate_with_meter_id
    self.meter_id = user.meter_id
end 
```

**这是我的用户模型的一部分**

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me,
                  :home_size_sf, :meter_id, :avg_monthly_kwh, :discovery_score,
                  :questions_attributes, :answers_attributes

  has_many :data_records, :foreign_key => :meter_id, :primary_key => :meter_id, :class_name => "DataRecord"

  has_many :questions
  has_many :answers

  accepts_nested_attributes_for :questions, :answers 
```

**这是问题模型**

```
class Question < ActiveRecord::Base
    attr_accessible :description, :taxonomy, :user_id, :answers_attributes
  belongs_to :user
  has_many :answers
  accepts_nested_attributes_for :answers
  validates :description, presence: { :on => :create }
  validates :taxonomy, presence: { :on => :create }
  def relevance_score
    rand
  end
end 
```

**这是问题控制器**

```
class QuestionsController < ApplicationController
  respond_to :html, :json

  def index
    @question = current_user.questions.new
    @questions = current_user.questions.all
  end

  def create
    @question = current_user.questions.new(params[:question])
    if !params[:update_button]
      if @question.valid?
        if params[:next_button] || !@question.save
          render 'index'
        elsif !params[:next_button] && params[:submit_button] && @question.save
          flash[:success] = "Your question and answer have been saved."
          respond_with @question, :location => questions_path
        end
      else
        render 'index'
      end
    else
      render 'index'
    end
  end

  def next
    @question = current_user.unanswered.first
    @answer = Answer.new(:question => @question, :user => current_user)
    respond_to do |format|
      format.js
    end
  end
end 
```

**答案模型**

```
class Answer < ActiveRecord::Base
  attr_accessible :value, :user_id, :meter_id, :question_id
  belongs_to :user
  belongs_to :question

  validates :value, presence: true, :numericality => true

  before_save :associate_with_meter_id

  def associate_with_meter_id
    self.meter_id = user.meter_id **(<-- line 13 from the error message)**
  end

end 
```

**答案控制器**

```
class AnswersController < ApplicationController
  respond_to :html, :json

  def index
    @answers = current_user.answers
  end

  def create
    @answer = current_user.answers.create(params[:answer])
    if @answer.save
      flash[:notice] = "Thanks for for answer. Please continue with your input...."
      respond_with @answer, :location => root_url
    end
  end

end 
```

**数据库模式**

```
ActiveRecord::Schema.define(:version => 20120210184340) do

  create_table "answers", :force => true do |t|
    t.integer  "meter_id"
    t.integer  "user_id"
    t.integer  "question_id"
    t.float    "value"
    t.float    "what_if_value"
    t.datetime "created_at",    :null => false
    t.datetime "updated_at",    :null => false
  end

  create_table "data_records", :force => true do |t|
    t.datetime "timestamp"
    t.float    "value"
    t.integer  "meter_id"
    t.string   "status_code"
  end

  create_table "questions", :force => true do |t|
    t.string   "description"
    t.string   "taxonomy"
    t.string   "coeff"
    t.float    "rsquare",     :default => 0.0
    t.string   "rank"
    t.string   "responses"
    t.string   "skips"
    t.string   "avganswer"
    t.float    "pval",        :default => 0.0
    t.float    "quality",     :default => 0.0
    t.integer  "user_id"
    t.datetime "created_at",                   :null => false
    t.datetime "updated_at",                   :null => false
  end

  create_table "setup_constants", :force => true do |t|
    t.float "exp_model",      :default => 0.0
    t.float "exp_pval_const", :default => 0.0
  end

  create_table "users", :force => true do |t|
    t.integer  "meter_id"
    t.float    "home_size_sf",           :default => 1000.0
    t.text     "notifications"
    t.float    "avg_monthly_kwh"
    t.float    "ee_score"
    t.string   "email",                  :default => "",     :null => false
    t.string   "encrypted_password",     :default => "",     :null => false
    t.string   "reset_password_token"
    t.datetime "reset_password_sent_at"
    t.datetime "remember_created_at"
    t.integer  "sign_in_count",          :default => 0
    t.datetime "current_sign_in_at"
    t.datetime "last_sign_in_at"
    t.string   "current_sign_in_ip"
    t.string   "last_sign_in_ip"
    t.datetime "created_at",                                 :null => false
    t.datetime "updated_at",                                 :null => false
  end

  add_index "users", ["email"], :name => "index_users_on_email", :unique => true
  add_index "users", ["reset_password_token"], :name => "index_users_on_reset_password_token", :unique => true

end 
```

**笔记：**

在答案模型（上图）中，该行：

```
self.meter_id = user.meter_id 
```

将答案模型的meter_id 与用户模型的meter_id 关联起来。我相信这就是问题所在。我尝试将上面的行更改为：

```
self.meter_id = 2 
```

然后一切正常，所以很明显 user.meter_id 是未定义的，所以我不确定如何通过嵌套表单传递该值？我尝试使用隐藏字段，但没有运气（以下是嵌套的 fields_for :answers，在 form_for @questions 内）：

```
<fieldset>
    <%= f.label "Yes" %>
  <%= f.radio_button :value, 1 %>
  <%= f.label "No" %>
  <%= f.radio_button :value, 0 %>
  <%= f.hidden_field :user_id %>
  <%= f.hidden_field :question_id %>
  <%= f.hidden_field :meter_id %>
</fieldset> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:50:55.610

首先，出于安全原因，您不想在视图中传递当前用户。相反，您想从控制器中执行此操作。

一个起点（假设您有 current_user）：

```
@answer = current_user.answers.create(params[:answer].merge(:user => current_user)) 
```

从那里开始，由您决定如何将用户传递给答案模型。但是，您可以使用这个：

```
self.meter_id = question.user.meter_id 
```

假设这是合适的。

# search - 如何从 Marklogic 中的 cts:search() 中获取所有命中

> ID：10950236
> 
> 赞同：0
> 
> 时间：2012-06-08T13:55:50.253
> 
> 标签：search, marklogic, cts

我有一个包含大量文档的集合。

当我搜索集合时，我需要获取独立于文档的匹配列表。所以如果我搜索“ `pie`”这个词。我会取回一份按相关性正确排序的文档列表。但是，其中一些文件`pie`在不止一处包含“ ”一词。我想取回所有匹配项的列表，与找到匹配项的文档无关。此外，所有命中的列表需要按相关性（权重）排序，再次完全独立于文档（不按文档分组）。

以下代码搜索并返回按文档分组的匹配项...

```
let $searchfor := "pie"

let $query := cts:and-query((
  cts:element-word-query(xs:QName("title"), ($searchfor), (), 16),
  cts:element-word-query(xs:QName("para"), ($searchfor), (), 10)
))

let $resultset := cts:search(fn:collection("docs"), $query)[0 to 100]
for $n in $resultset
  return cts:score($n) 
```

我需要的是`$n`成为“ `match-node`”，而不是“ `document-nod`e”......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T19:03:17.987

文档相关性由 确定`TFIDF`。匹配对文档的分数有所贡献，但彼此之间没有分数。`cts:search`已经返回按文档相关性排序的结果，因此您可以这样做以获取按其祖先文档分数排序的匹配节点：

```
let $searchfor := "pie"
let $query := cts:and-query((
  cts:element-word-query(xs:QName("title"), ($searchfor), (), 16),
  cts:element-word-query(xs:QName("para"), ($searchfor), (), 10)
))
return
cts:search(//(title|para),$query)[0 to 100]/cts:highlight(.,$query,element match {$cts:node})//match/* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:43:43.370

我建议您查看`Search API`（[http://community.marklogic.com/pubs/5.0/books/search-dev-guide.pdf](http://community.marklogic.com/pubs/5.0/books/search-dev-guide.pdf)和[http://community.marklogic.com/pubs/5.0/apidocs/SearchAPI。 html](http://community.marklogic.com/pubs/5.0/apidocs/SearchAPI.html) ). 此 API 将提供您想要的，提供匹配节点以及实际文档的 URI。您还应该发现它更容易用于一般情况，尽管在某些极端情况下您需要恢复到`cts:search`.

`search:search`是您要使用的特定功能。它会给你类似这样的回复：

```
 <search:response total="1" start="1" page-length="10" xmlns=""
    xmlns:search="http://marklogic.com/appservices/search">
  <search:result index="1" uri="/foo.xml" 
        path="fn:doc(&quot;/foo.xml&quot;)" score="328" 
        confidence="0.807121" fitness="0.901397">
    <search:snippet>
        <search:match path="fn:doc(&quot;/foo.xml&quot;)/foo">
            <search:highlight>hello</search:highlight></search:match>
    </search:snippet>
  </search:result>
  <search:qtext>hello sample-property-constraint:boo</search:qtext>
  <search:report id="SEARCH-FLWOR">(cts:search(fn:collection(), 
      cts:and-query((cts:word-query("hello", ("lang=en"), 1), 
      cts:properties-query(cts:word-query("boo", ("lang=en"), 1))), 
      ()), ("score-logtfidf"), 1))[1 to 10]
  </search:report>
  <search:metrics>
    <search:query-resolution-time>PT0.647S</search:query-resolution-time>
    <search:facet-resolution-time>PT0S</search:facet-resolution-time>
    <search:snippet-resolution-time>PT0.002S</search:snippet-resolution-time>
    <search:total-time>PT0.651S</search:total-time>
  </search:metrics>
</search:response> 
```

在这里，您可以看到每个结果都定义了一个或多个匹配元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T09:20:56.757

您需要将文档拆分（将其分段）为较小的文档。每个文本节点都可以是一个文档，并带有存储的原始 xpath，这样上下文就不会丢失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T18:21:58.827

您将如何确定独立于文档的单词的相关性？相关性是文档相关性的度量，而不是单词相关性。我不知道如何衡量单词相关性。

您可能会返回按文档相关性排序的所有单词，然后返回“ `document order`”中每个文档的单词，这意味着它们在文档中出现的顺序。`search:search`在迭代所有结果并提取每个匹配词的地方，这将相对容易。每场比赛你会展示什么？它周围的片段？

请记住，您所要求的可能需要很长时间才能执行。

# c# - 网页确认中的表单提交

> ID：10950242
> 
> 赞同：0
> 
> 时间：2012-06-08T13:56:11.370
> 
> 标签：c#, .net, visual-studio-2010, oracle11g, webpage

下面的代码接受表单中的文本并将其插入表中。我希望它添加到表中并在显示消息“数据已添加”后重定向到同一页面。但问题是它正在获取重定向到目标页面但不显示 message.im 猜测这是因为 cmd.ExecuteQuery(); 正在生成响应并被重定向...

但我希望它显示信息。我应该做些什么改变。提前谢谢

```
protected void Button2_Click(object sender, EventArgs e)
{

    string v = System.Configuration.ConfigurationManager.ConnectionStrings["harish"].ConnectionString;
    con = new OracleConnection(v);
    con.Open(); 
    string query="insert into leave_module1 values(:name,:desig,:srno,:tol,:compdates,:fd,:td,:nod,:remarks)";
    OracleCommand cmd = new OracleCommand(query, con);
    //OracleCommand.BindByName = true;
    try
    {
        cmd.Parameters.Add(":name", OracleType.VarChar, 50).Value = DropDownList2.Text;
        cmd.Parameters.Add(":desig", OracleType.VarChar, 30).Value = TextBox10.Text;
        cmd.Parameters.Add(":srno", OracleType.Number, 8).Value = TextBox8.Text;
        cmd.Parameters.Add(":tol", OracleType.VarChar, 10).Value = DropDownList1.Text;
        cmd.Parameters.Add(":compdates", OracleType.VarChar, 30).Value = TextBox9.Text;
        cmd.Parameters.Add(":fd", OracleType.DateTime).Value = TextBox3.Text;
        cmd.Parameters.Add(":td", OracleType.DateTime).Value = TextBox4.Text;
        cmd.Parameters.Add(":nod", OracleType.Number, 3).Value = TextBox5.Text;
        cmd.Parameters.Add(":remarks", OracleType.VarChar, 50).Value = TextBox7.Text;
        cmd.ExecuteNonQuery();
        ClientScript.RegisterStartupScript(Page.GetType(), "validation",
         "<script language='javascript'>alert('The Data has been added')</script>");
        Response.Redirect("Default2.aspx");

    }
    catch
    {

        Label13.Visible = true;           

    }

    con.Close();    

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T13:59:01.930

发生这种情况是因为您的代码将 JS 脚本添加到您的起始页面（比如说 Default1.aspx），然后您重定向到`Default2.aspx`不包含 JS 代码的页面。

我建议您将参数（可能使用 QueryString）传递到`Default2.aspx`将显示消息的页面。

我不建议您使用 an`Alert`来显示消息。您最好使用页面上的 div 或 JQuery 插件来显示消息

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:01:15.247

尝试将以下内容更改为 javascript。

```
ClientScript.RegisterStartupScript(Page.GetType(), "validation",  
     "<script language='javascript'>alert('The Data has been added')</script>"); 
```

对此

```
ClientScript.RegisterStartupScript(Page.GetType(), "validation",  
     "<script language='javascript'>alert('The Data has been added');window.location="Default2.aspx" </script>"); 
```

并在您的代码中删除以下内容

```
Response.Redirect("Default2.aspx"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:01:55.097

如果您希望用户在该页面上看到消息，则需要在插入数据后允许该页面可见，而不是立即重定向。您需要在几秒钟后使用 Javascript（客户端代码）来重定向，而不是使用服务器端 Response.Redirect。延迟是`setTimeout()`在 Javascript 中使用的。

[此处](http://www.tizag.com/javascriptT/javascriptredirect.php)和[此处](http://www.w3schools.com/js/js_timing.asp)解释了执行此操作所需的 javascript 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:02:15.577

不要使用 Response.Redirect。

只需使用javascript：

```
ClientScript.RegisterStartupScript(Page.GetType(), "validation", 
     "<script language='javascript'>alert('The Data has been added'); window.location='default2.aspx';</script>"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T14:09:57.813

我通过使用 Session 对象而不是 JavaScript 做了类似的事情。也许这个想法会对你有所帮助。

我在母版页中创建了一个消息变量，在像你这样的情况下，我会

*   使用必要的文本设置消息变量
*   重定向到所需的 aspx 页面
*   母版页检查是否有要显示的消息。如果是，它会显示一个面板并重置变量

在您的情况下，面板可能有一个 OK 或 CLOSE 按钮，或者您可以使用 Ajax Control Toolkit 中的其他对象。

# netty - 服务器引导释放外部资源陷入循环

> ID：10950244
> 
> 赞同：2
> 
> 时间：2012-06-08T13:56:19.400
> 
> 标签：netty

我的问题似乎与： [https ://issues.jboss.org/browse/NETTY-433](https://issues.jboss.org/browse/NETTY-433)

我试图停止我的 Netty 服务器，但这个调用永远不会返回：

```
serverBootstrap.releaseExternalResources(); 
```

尝试关闭工作线程 ThreadPoolExecutor 时，它在 ExecutorUtil.terminate 方法中永远循环：

```
org.jboss.netty.util.internal.ExecutorUtil.terminate()
   for (;;) {
       es.shutdownNow(); 
       es.awaitTermination..
   } 
```

问题是我无法控制连接到我的服务器的客户端。服务器有没有办法强制服务器停止并简单地关闭通道并停止工作线程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:10:46.590

在执行 releaseAllResources 之前，您可以做的确保您的子频道已关闭的方法是在 ChannelGroup 中注册所有创建的子[频道](http://netty.io/docs/stable/api/org/jboss/netty/channel/group/ChannelGroup.html)。关闭时，您可以在 ChannelGroup 上调用[close()](http://netty.io/docs/stable/api/org/jboss/netty/channel/group/ChannelGroup.html#close%28%29)，这将关闭其中的所有通道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T01:05:08.333

根据[Netty API](http://docs.jboss.org/netty/3.2/api/index.html?org/jboss/netty/channel/ChannelFactory.html) ，我个人错过的关键部分是：

```
 public class MyHandler extends SimpleChannelUpstreamHandler {
     @Override
     public void channelOpen(ChannelHandlerContext ctx, ChannelStateEvent e) {
         // Add all open channels to the global group so that they are
         // closed on shutdown.
         allChannels.add(e.getChannel());
     }
 } 
```

换句话说，您还必须覆盖处理程序中的方法。

# java - 为什么 JavaFX 2 创建的 TableRows 比需要的多？

> ID：10950249
> 
> 赞同：1
> 
> 时间：2012-06-08T13:56:34.930
> 
> 标签：java, user-interface, javafx-2

在 JavaFX 2 中`TableView`，有一个 API 可以添加`RowFactory`. 该工厂用于创建`TableRow`s; 它用于开发人员希望功能（如工具提示）跨越整行的情况。

现在，使用该功能，我注意到`RowFactory`每个可见行都没有调用一次，而是再调用一次。

如果您执行[这段代码](https://gist.github.com/2895713)，您会注意到 UI 在 UI 中显示 16 行，但控制台上的计数器计数到第 17 行。
奇怪的是，多余的线似乎在开头并充满了数据，而不是在结尾处看不见的多余线。我认为它是标题，但在[JavaFX 代码](http://hg.openjdk.java.net/openjfx/2.1/master/rt)中，情况并非如此。

你能解释一下这个观察吗？

# mercurial - 使用 Mercurial 确定“活动”变更集？

> ID：10950257
> 
> 赞同：6
> 
> 时间：2012-06-08T13:57:12.083
> 
> 标签：mercurial

如果您的仓库中有变更集 A、B、C、D、E 并且您执行`hg update -c D`，您如何确认您的仓库当前在变更集 D 中处于“活动状态”？如果我们运行`hg tip`or `hg head`，HG 列出 E 而不是 D。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:09:30.637

有几种方法可以找出这一点：

*   [`hg summary`](http://www.selenic.com/hg/help/summary)
*   [`hg identify`](http://www.selenic.com/hg/help/identify)
*   [`hg log -r .`](http://www.selenic.com/hg/help/log)

请注意，[`hg update`](http://www.selenic.com/hg/help/update)实际上更改了工作副本的修订版，因此您绝对不应该使用它。

# android - 在屏幕/背光关闭的情况下运行全屏 Android 应用程序

> ID：10950261
> 
> 赞同：1
> 
> 时间：2012-06-08T13:57:21.003
> 
> 标签：android, tablet, backlight

这是我需要做的。我想使用 Android 平板电脑进行科学研究，但我需要以编程方式控制屏幕/背光。具体来说，有一种模式，我的应用程序需要通过 WiFi 与其他系统通信、播放声音并激活触摸屏，但背光必须完全关闭；在这种模式下，设备不能发光，否则会干扰科学。显然，这不可能是睡眠模式！这可行吗？

我环顾四周，[这](https://stackoverflow.com/questions/7646865/changing-screen-brightness-programmatically-as-with-the-power-widget)听起来确实很有希望，但是（对我来说，无论如何！）这是否可行还不是很清楚。任何人都可以保证吗？

最后，我选择哪种平板电脑重要吗？基本上，似乎有三种可能：背光由开关控制（怀疑不再这样做了），CPU只能打开或关闭它，或者CPU可以完全调整它。写这篇文章让我觉得担心很愚蠢，但三星代表昨天告诉我，我不能在 Galaxy 上这样做。有人愿意推荐平板电脑吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:24:24.527

由于它是一项科学研究，我假设您可能不需要透露此应用程序并希望它在受控环境中。如果是这种情况，有点创造性的想法表明，由于触摸屏即使被一层薄薄的塑料覆盖（例如屏幕保护膜）仍然会做出反应，您可以在顶部应用一些不透明的乙烯基用于进行实验的屏幕（易于移除）。

这可能没有用，但因为对我来说这听起来像是我想我会在这个问题上与你分享我的想法。一旦你用乙烯基覆盖了屏幕，其余的就像往常一样，保持屏幕打开，发挥你的魔力。

:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:11:59.327

> 具体来说，有一种模式，我的应用需要通过 WiFi 与其他系统通信、播放声音并激活触摸屏，但背光必须完全关闭

Android 不支持“激活触摸屏，但背光必须完全关闭”。而且，您无法以编程方式“完全关闭”背光。

> 我环顾四周，这听起来很有希望

这会将背光设置为低。当背光设置为低时，某些设备可能会选择关闭背光。这取决于设备制造商。

> 最后，我选择哪种平板电脑重要吗？

看上面。

# mysql - MySQL distinct+sort 查询性能问题

> ID：10950262
> 
> 赞同：1
> 
> 时间：2012-06-08T13:57:22.003
> 
> 标签：mysql, performance

### 问题

以下查询需要超过 30 秒才能运行，除非：

*   我删除排序（查询然后<1秒）
*   我删除了 distinct 关键字：（查询然后 <1 秒）
*   开始删除连接（查询然后 <5 秒）

### 问题

我怎样才能让这个查询在 1 秒内运行。必需：如何获得具有相关数据的唯一会议列表，如下面的连接所述，包括某种类型。

相关数据既用于确定是否存在相关字段，也用于执行 GROUP_CONCAT 操作 - 因此需要对同一个预定项目表进行 3 个不同的连接。

提前感谢您的任何帮助和建议！我已经在这个问题上敲了几个小时！

### 询问

```
SELECT

DISTINCT( `meetings`.`id` ) AS `meeting_id`,
`meetings`.`uid` AS meeting_uid,
`meetings_SERV`.`id` AS meetings_SERV_id, 
`meetings_TRANSP`.`id` AS meetings_TRANSP_id, 
`meetings_ACCO`.`id` AS meetings_ACCO_id, 
`meetings_BOOKEDITEMS`.`id` AS meetings_BOOKEDITEMS_id

FROM `meetings` AS meetings 

LEFT OUTER JOIN `bookeditems` AS `meetings_SERV` 
ON `meetings`.`uid` = `meetings_SERV`.`meeting_uid`
AND 'SER' = `meetings_SERV`.`item_type` 

LEFT OUTER JOIN `bookeditems` AS `meetings_TRANSP` 
ON `meetings`.`uid` = `meetings_TRANSP`.`meeting_uid`
AND 'TRA' = `meetings_TRANSP`.`item_type` 

LEFT OUTER JOIN `bookeditems` AS `meetings_ACCO` 
ON `meetings`.`uid` = `meetings_ACCO`.`meeting_uid`
AND 'ACC' = `meetings_ACCO`.`item_type` 

LEFT OUTER JOIN `bookeditems` AS `meetings_BOOKEDITEMS` 
ON `meetings`.`uid` = `meetings_BOOKEDITEMS`.`meeting_uid` 

ORDER BY `meetings`.`datetime`

LIMIT 0, 50 
```

### 表定义

```
CREATE TABLE IF NOT EXISTS `bookeditems` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `meeting_uid` varchar(256) NOT NULL,
  `item_type` varchar(256) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `meeting_uid` (`meeting_uid`(255)),
  KEY `index1` (`meeting_uid`(255),`item_type`(255))
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=5889 ;

CREATE TABLE IF NOT EXISTS `meetings` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `uid` varchar(256) NOT NULL,
  `datetime` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `uid` (`uid`(255)),
  KEY `datetime` (`datetime`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=7487 ; 
```

### 解释选择的结果

```
id | select_type | table                | type | possible_keys      | key         | key_len | ref                      | rows | Extra
-------------------------------------------------------------------------------------------------------------------------------------
1  | SIMPLE      | meetings             | ALL  | NULL               | NULL        | NULL    | NULL                     | 7483 | Using temporary; Using filesort
1  | SIMPLE      | meetings_SERV        | ref  | meeting_uid,index1 | meeting_uid | 767     | test.meetings.uid        | 1    | 
1  | SIMPLE      | meetings_TRANSP      | ref  | meeting_uid,index1 | meeting_uid | 767     | test.meetings.uid        | 1    | 
1  | SIMPLE      | meetings_ACCO        | ref  | meeting_uid,index1 | meeting_uid | 767     | test.meetings.uid        | 1    | 
1  | SIMPLE      | meetings_BOOKEDITEMS | ref  | meeting_uid,index1 | meeting_uid | 767     | test.meetings.uid        | 1    | 
```

### 分析结果

```
starting                      0.000092
checking permissions          0.000003
checking permissions          0.000002
checking permissions          0.000001
checking permissions          0.000001
checking permissions          0.000003
Opening tables                0.000036
System lock                   0.000008
init                          0.000033
optimizing                    0.000005
statistics                    0.000035
preparing                     0.000019
Creating tmp table            0.000165
executing                     0.000004
Copying to tmp table          1.790968
converting HEAP to MyISAM     1.669041
Copying to tmp table on disk  28.32606
Sorting result                0.141737
Sending data                  0.000099
end                           0.000005
removing tmp table            0.022097
end                           0.000014
query end                     0.000008
closing tables                0.000017
freeing items                 0.000779
logging slow query            0.000004
cleaning up                   0.000005 
```

### 零件解决方案

根据下面 Eric R. Rath 的帮助，我已经分析了查询，并通过将 max_heap_table_size=256M 和 tmp_table_size=256M 添加到 MySQL 配置中，我已经能够消除执行步骤“将 HEAP 转换为 MyISAM”和“复制到磁盘上的 tmp 表” ”。

尽管这将总执行时间降至 2 秒以下，但我仍然不相信这是我能做的一切，如果在查询优化方面有任何其他建议，请告诉我。

### 按照 max_heap_table_size 和 tmp_table_size 配置进行分析

```
...
executing                     0.000004
Copying to tmp table          1.790968
Sorting result                0.141737
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:07:07.933

您可以尝试通过首先`SELECT`-ing 感兴趣的记录（使用`ORDER BY`和`LIMIT`）来帮助优化器，然后使用该结果与其他表连接。使用这种方法，索引 on`datetime`可以完全用于`ORDER BY`and`LIMIT`子句。这是这种方法的样子：

```
SELECT
  `meetings`.`id` AS `meeting_id`,
  `meetings`.`uid` AS meeting_uid,
  GROUP_CONCAT(
   DISTINCT CASE bookeditems.item_type
     WHEN 'SER' THEN bookeditems.id
     ELSE NULL
   END
  ) AS meetings_SERV_ids,
  GROUP_CONCAT(
   DISTINCT CASE bookeditems.item_type
     WHEN 'TRA' THEN bookeditems.id
     ELSE NULL
   END
  ) AS meetings_TRANSP_ids,
  GROUP_CONCAT(
   DISTINCT CASE bookeditems.item_type
     WHEN 'ACC' THEN bookeditems.id
     ELSE NULL
   END
  ) AS meetings_ACCO_ids,
  GROUP_CONCAT(bookeditems.id) AS meetings_BOOKEDITEMS_ids
FROM (
  SELECT id
  FROM meetings
  ORDER BY `datetime`
  LIMIT 0, 50
) filtered_meetings
INNER JOIN meetings
  ON meetings.id = filtered_meetings.id
LEFT OUTER JOIN bookeditems
  ON meeting_uid = bookeditems.meeting_uid
GROUP BY meeting_uid 
```

显着差异：

*   我们只加入一次预订项目表。在 select-statement 中，我们使用`GROUP_CONCAT`together with`CASE`语句来选择会议组中符合特定条件的所有 id。此外，为此，我们需要添加一个`GROUP BY`语句来对代表同一会议的所有行进行分组。

    这意味着我们可能会得到`meetings_SERV_ids`、`meetings_TRANSP_ids`和`meetings_ACCO_ids`的id 字符串`meetings_BOOKEDITEMS_ids`。因此，请记住`explode`在处理结果行的客户端代码中使用 或等效项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T23:39:33.450

我认为 index2 是不必要的，可以删除；它是 index1 的前缀。不过，这不会减少查询时间。

EXPLAIN 输出显示了真正的罪魁祸首：“使用临时，使用文件排序”。有时您可以通过让 MySQL 使用用于连接的相同键执行排序来避免这种情况。如果将 index1 更改为 (meeting_id, datetime)，它也许可以这样做。如果您需要将 item_type 保留在 index1 中，您可以将其添加为索引中的第三列，或者在查询中包含一个包含所有值的 IN() 子句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:07:12.900

让我们检查索引。

您在预定项目中是否有关于 meeting_id 和 item_type 的复合索引？

您是否有关于会议的会议 ID 的索引，如果它在复合键中，它是第一个索引吗？

您是否有关于会议日期时间的聚集索引？

您可以放置​​一个子查询来获取每个会议 ID 的堆栈顶部，而不是做不同的操作吗？

就像是：

```
select * from meetings a
where datetime = (select max(datetime) from meetings 
where meetingid = a.meetingid) 
```

您可以使用 case 语句而不是会议类型来获取相同的数据，而不是左加入吗？

# graph - gnuplot 从文件中绘制多个数据集并将所有这些条分组

> ID：10950263
> 
> 赞同：-1
> 
> 时间：2012-06-08T13:57:23.160
> 
> 标签：graph, plot, gnuplot

我想为文件中的每个数据集绘制第 3 列和第 4 列，数据集由多个换行符标识，并使用索引引用，如下面的脚本所示。我可以用“linespoint”绘制这些数据。我的图表看起来像[我的图表](https://sites.google.com/site/gkumarpatel/_/rsrc/1339163683719/links/sapmple.jpg)。但我想用“盒子”绘制数据，因为[我想要这样的图表](http://i.imgur.com/zAzfv.png)。

x 轴将有第 3 列 (1,2,3)，y 轴将有第 4 列，对于 x (1,2,3) 的每个值应该有 2 个柱，一个来自索引 0，第二个来自索引 1 .

数据文件如下所示：

> 2-100
> 
> 2 100 1 3.10 249
> 
> 2 100 2 3.41 250
> 
> 2 100 4 3.70 249
> 
> 3-100
> 
> 3 100 1 3.10 252
> 
> 3 100 2 3.48 252
> 
> 3 100 4 3.72 254

2-100 和 3-100 将用作标题“块的第一行和第一列”，前 4 行在脚本中读作“索引 o”，后 4 行读作“索引 1”

我使用的脚本：

```
plot \

  "$1" index 0 using 3:4 with boxes fs solid title columnhead(1),\

  "$1" index 1 using 3:4 with boxes fs solid title columnhead(1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:36:51.947

我已经重新格式化了您的数据文件（至少，如果我正确理解了您的原始问题） - 现在看起来像：

```
2-100
2 100 1 3.10 249
2 100 2 3.41 250
2 100 4 3.70 249

3-100
3 100 1 3.10 252
3 100 2 3.48 252
3 100 4 3.72 254 
```

您*应该*能够像这样使用以下格式格式化您的数据文件`sed`：

```
sed -e '/^$/ d'           -e '/[0-9]-100/{x;p;p;x}'               datafile.dat
#     #remove all newlines  #reinsert newlines where appropriate 
```

（这假设列标题总是以数字（0-9）开头，然后是“-100”。如果您的数据文件更复杂一点，您可能需要更有趣一点。

这可以使用以下方法绘制：

```
set yrange [0:*]
set style fill solid
plot for [i=0:1] 'test2.dat' index i u ($3+i*0.25):4:(0.25) w boxes title columnhead(1) 
```

当然，您可以分解 for 循环以将特殊属性分配给每个情节或其他...

如果你想要特殊标签，你可以这样做

```
set xtics scale 0,0 format ""
set xtics ("This is at 1" 1, "this is at 2" 2, "this is at 3" 3) 
```

在你的情节命令之前。

这是我将上述内容与 png (libgd) 终端一起使用的结果：

![在此处输入图像描述](../Images/20b17e7be29254af08296f5e06ebf4dd.png)

# scala - Scala：读取 Enumerator[T] 的一些数据并返回剩余的 Enumerator[T]

> ID：10950267
> 
> 赞同：4
> 
> 时间：2012-06-08T13:57:44.613
> 
> 标签：scala, playframework, playframework-2.0, enumerator, iterate

我正在使用使用 Iteratees 和 Enumerators 的 playframework 的异步 I/O 库。我现在有一个 Iterator[T] 作为数据接收器（为简单起见，它是一个将其内容存储到文件中的 Iterator[Byte]）。这个 Iterator[Byte] 被传递给处理写入的函数。

但是在写之前我想在文件开始处添加一些统计信息（为了简化说它是一个字节），所以在将迭代器传递给写函数之前，我以以下方式传输迭代器：

```
def write(value: Byte, output: Iteratee[Byte]): Iteratee[Byte] =
    Iteratee.flatten(output.feed(Input.El(value))) 
```

当我现在从磁盘读取存储的文件时，我得到了一个 Enumerator[Byte] 。首先，我想读取并删除附加数据，然后我想将 Enumerator[Byte] 的其余部分传递给处理读取的函数。所以我还需要改造枚举器：

```
def read(input: Enumerator[Byte]): (Byte, Enumerator[Byte]) = {
   val firstEnumeratorEntry = ...
   val remainingEnumerator = ...
   (firstEnumeratorEntry, remainingEnumerator)
} 
```

但我不知道如何做到这一点。如何从枚举器中读取一些字节并获取剩余的枚举器？

将 Iteratee[Byte] 替换为 OutputStream 并将 Enumerator[Byte] 替换为 InputStream，这将非常简单：

```
def write(value: Byte, output: OutputStream) = {
    output.write(value)
    output
}
def read(input: InputStream) = (input.read,input) 
```

但是我需要play框架的异步I/O。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T06:07:55.663

我想知道您是否可以从另一个角度解决您的目标。

那个将使用剩余枚举数的函数，我们称之为它`remaining`，大概它适用于一个迭代器来处理余数：`remaining |>> iteratee`产生另一个迭代器。让我们称这个结果为 iteratee `iteratee2`...你能检查一下你是否可以获得对 的引用`iteratee2`吗？如果是这种情况，那么您可以使用第一个 iteratee 获取和处理第一个字节`head`，然后组合`head`并`iteratee2`通过 flatMap：

```
val head = Enumeratee.take[Byte](1) &>> Iteratee.foreach[Byte](println)
val processing = for { h <- head; i <- iteratee2 } yield (h, i)
Iteratee.flatten(processing).run 
```

如果您无法掌握`iteratee2`- 如果您的枚举器与您未实现的枚举器组合时就是这种情况 - 那么这种方法将不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:31:25.830

`Iteratee`这是通过在适当的（某种）状态累加器（此处为元组）内折叠来实现此目的的一种方法

我去读取`routes`文件，第一个字节将作为 a 读取，`Char`另一个将`String`作为 UTF-8 字节串附加到 a。

```
 def index = Action {
    /*let's do everything asyncly*/
    Async {
      /*for comprehension for read-friendly*/
      for (
        i <- read; /*read the file */
        (r:(Option[Char], String)) <- i.run /*"create" the related Promise and run it*/
      ) yield Ok("first : " + r._1.get + "\n" + "rest" + r._2) /* map the Promised result in a correct Request's Result*/
    }
  }

  def read = {
    //get the routes file in an Enumerator
    val file: Enumerator[Array[Byte]] = Enumerator.fromFile(Play.getFile("/conf/routes"))

    //apply the enumerator with an Iteratee that folds the data as wished
    file(Iteratee.fold((None, ""):(Option[Char], String)) { (acc, b) =>
       acc._1 match {
         /*on the first chunk*/ case None => (Some(b(0).toChar), acc._2 + new String(b.tail, Charset.forName("utf-8")))
         /*on other chunks*/ case x => (x, acc._2 + new String(b, Charset.forName("utf-8")))
       }
    })

  } 
```

**编辑**

我找到了另一种使用方式，`Enumeratee`但它需要创建 2`Enumerator`秒（一个短命）。但是，它是否更优雅一些。我们使用一种“类型”的 Enumeratee，但`Traversal`它的工作水平比 Enumeratee（块级）更好。我们使用`take`1 只占用 1 个字节，然后关闭流。另一方面，我们使用`drop`它只是删除第一个字节（因为我们使用的是 Enumerator[Array[Byte]]）

此外，现在`read2`的签名比您希望的要近得多，因为它返回 2 个枚举器（距离 Promise、Enumerator 不远）

```
def index = Action {
  Async {
    val (first, rest) = read2
    val enee = Enumeratee.map[Array[Byte]] {bs => new String(bs, Charset.forName("utf-8"))}

    def useEnee(enumor:Enumerator[Array[Byte]]) = Iteratee.flatten(enumor &> enee |>> Iteratee.consume[String]()).run.asInstanceOf[Promise[String]]

    for {
      f <- useEnee(first);
      r <- useEnee(rest)
    } yield Ok("first : " + f + "\n" + "rest" + r)
  }
}

def read2 = {
  def create = Enumerator.fromFile(Play.getFile("/conf/routes"))

  val file: Enumerator[Array[Byte]] = create
  val file2: Enumerator[Array[Byte]] = create

  (file &> Traversable.take[Array[Byte]](1), file2 &> Traversable.drop[Array[Byte]](1))

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:56:22.313

实际上我们喜欢`Iteratee`s 因为他们作曲。因此，与其从原始的创建多个`Enumerator`s，不如按顺序组合两个 Iteratee（先读和读后），并用您的单个 Enumerator 提供它。

为此，您需要一个顺序组合方法，现在我称之为`andThen`。这是一个粗略的实现。请注意，返回未使用的输入有点苛刻，也许可以使用基于 Input 类型的类型类自定义行为。它也不处理将剩余的东西从第一个迭代器传递到第二个迭代器（练习:)。

```
object Iteratees {
  def andThen[E, A, B](a: Iteratee[E, A], b: Iteratee[E, B]): Iteratee[E, (A,B)] = new Iteratee[E, (A,B)] {
    def fold[C](
        done: ((A, B), Input[E]) => Promise[C],
        cont: ((Input[E]) => Iteratee[E, (A, B)]) => Promise[C],
        error: (String, Input[E]) => Promise[C]): Promise[C] = {

      a.fold(
        (ra, aleft) => b.fold(
          (rb, bleft) => done((ra, rb), aleft /* could be magicop(aleft, bleft)*/),
          (bcont) => cont(e => bcont(e) map (rb => (ra, rb))),
          (s, err) => error(s, err)
        ),
        (acont) => cont(e => andThen[E, A, B](acont(e), b)),
        (s, err) => error(s, err)
      )
    }
  }
} 
```

现在您可以使用以下内容：

```
object Application extends Controller {

  def index = Action { Async {

    val strings: Enumerator[String] = Enumerator("1","2","3","4")
    val takeOne = Cont[String, String](e => e match {
      case Input.El(e) => Done(e, Input.Empty)
      case x => Error("not enough", x)
    })
    val takeRest = Iteratee.consume[String]()
    val firstAndRest = Iteratees.andThen(takeOne, takeRest)

    val futureRes = strings(firstAndRest) flatMap (_.run)

    futureRes.map(x => Ok(x.toString)) // prints (1,234)
  } }

} 
```

# python-imaging-library - JPEG 和 PNG 库在 PIL 中的使用

> ID：10950270
> 
> 赞同：1
> 
> 时间：2012-06-08T13:57:52.487
> 
> 标签：python-imaging-library

我对开发比较陌生，我一直在尝试设置我在 Django 中构建的应用程序（在 Windows 7、64 位上）以接受通过 ImageField 上传的图像。我最初安装了 PIL，但发现我首先需要 JPEG 和 PNG 库。所以我使用“pip uninstall pil”卸载了 PIL，并将库设置在 C:\zlib-1.2.7\zlib.lib 和 C:\jpeg-8d\libjpeg.lib。之后，我进入了 PIL 中的 setup.py 并更改了以下内容：

```
 JPEG_ROOT = "C:/jpeg-8d"
    ZLIB_ROOT = "C:/zlib-1.2.7" 
```

然后我通过以下方式安装：

```
 pip install C:\Imaging-1.1.7\ 
```

我在安装结束时得到以下信息，这表明支持 JPEG 和 PNG：

```
Installing collected packages: PIL
Running setup.py install for PIL
WARNING: '' not a valid package name; please use only.-separated package nam
es in setup.py
--------------------------------------------------------------------
PIL 1.1.7 SETUP SUMMARY
--------------------------------------------------------------------
version       1.1.7
platform      win32 2.6.6 (r266:84297, Aug 24 2010, 18:46:32)
              [MSC v.1500 32 bit (Intel)]
--------------------------------------------------------------------
*** TKINTER support not available (Tcl/Tk 8.5 libraries needed)
--- JPEG support available
--- ZLIB (PNG/ZIP) support available
*** FREETYPE2 support not available
*** LITTLECMS support not available
--------------------------------------------------------------------
To add a missing option, make sure you have the required
library, and set the corresponding ROOT variable in the
setup.py script.

To check the build, run the selftest.py script.
Successfully installed PIL
Cleaning up... 
```

但是，我在使用 selftest.py 进行测试时得到了关注，这表明不支持：

```
C:\Windows\system32>python C:\Imaging-1.1.7\selftest.py
--------------------------------------------------------------------
PIL 1.1.7 TEST SUMMARY
--------------------------------------------------------------------
Python modules loaded from C:\Users\ayan\Desktop\Imaging-1.1.7\PIL
Binary modules loaded from C:\Python26_x86\lib\site-packages\PIL
--------------------------------------------------------------------
*** PIL CORE support not installed
*** TKINTER support not installed
*** JPEG support not installed
*** ZLIB (PNG/ZIP) support not installed
*** FREETYPE2 support not installed
*** LITTLECMS support not installed
-------------------------------------------------------------------- 
```

我还尝试使用 JPEG 并得到以下 IOError：

```
C:\Users\Public\Pictures\Sample Pictures>python
Python 2.6.6 (r266:84297, Aug 24 2010, 18:46:32) [MSC v.1500 32 bit (Intel)] on
win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import PIL
>>> import os, sys
>>> import Image
>>> img = Image.open(Desert.jpg)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'Desert' is not defined
>>> img = Image.open("Desert.jpg")
>>> img.save("Desert_test.jpg")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python26_x86\lib\site-packages\PIL\Image.py", line 1406, in save
    self.load()
  File "C:\Python26_x86\lib\site-packages\PIL\ImageFile.py", line 189, in load
    d = Image._getdecoder(self.mode, d, a, self.decoderconfig)
  File "C:\Python26_x86\lib\site-packages\PIL\Image.py", line 385, in _getdecode
r
    raise IOError("decoder %s not available" % decoder_name)
IOError: decoder jpeg not available 
```

这有点类似于[https://stackoverflow.com/questions/10543581/pil-installation-run-issue](https://stackoverflow.com/questions/10543581/pil-installation-run-issue)报告的内容；但是，在这种情况下，JPEG 似乎实际上不起作用。使用 PNG 观察到类似的问题。

我不清楚在这个过程中我在哪里犯了错误，所以任何评论都将不胜感激。如果需要其他信息，请告诉我，我会尽力提供。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T15:43:10.793

我已经解决了类似的问题，但只是为了支持 png。我相信你也可以为 jpeg 支持做同样的事情。

首先我会推荐使用 Pillow，PIL 的一个分支。我使用的解决方案是在我的机器（win7 64位）上手动编译zlib库。然后手动编译枕头包。我像您一样编辑了 Setup.py 以指向我刚刚编译的 zlib 所在的目录。

我建议您也手动编译 jpeg lib 和 zlib，然后再次编译 Pillow。确保在执行此操作之前卸载以前版本的 PIL/Pillow。

我详细回答如何使用 zlib 的链接是：

[https://stackoverflow.com/a/17190972/2501083](https://stackoverflow.com/a/17190972/2501083)

希望这可以帮助

# android - SQLite：返回列'y'的每个唯一值的最新'n'行

> ID：10950272
> 
> 赞同：0
> 
> 时间：2012-06-08T13:58:19.917
> 
> 标签：android, sql, sqlite

我有一个具有以下架构的表：

```
CREATE TABLE table (
  msg_id TEXT,
  thread_id TEXT,
  .
  .
  .
  date INTEGER 
) 
```

我需要检索最近的*n* `msg_id`每个唯一值`thread_id`。有没有办法使用单个查询来做到这一点，或者我需要查询数据库以获得最新的不同`thread_ids`，然后再次查询数据库 PER 唯一`thread_id`？我记得在某处读过多个数据库查询可能会变得昂贵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:07:05.330

您可以使用相关子查询。例如，对于`N = 5`：

```
select  *
from    YourTable yt1
where   5 <
        (
        select  count(*)
        from    YourTable yt2
        where   yt2.thread_id = yt1.thread_id
                and yt2.msg_id < yt1.thread_id
        ) 
```

这不是太快，因此您可能最好使用多个查询。

# windows-7 - vb6“现在”功能关闭一小时（win7）？

> ID：10950273
> 
> 赞同：3
> 
> 时间：2012-06-08T13:58:20.823
> 
> 标签：windows-7, vb6

我在数千台机器上安装了一个 vb6 程序，一些 XP 和一些 Win7。一位 Win7 用户打来电话说，该程序应用于其事件的时间比笔记本电脑时钟上的时间早一小时，这是正确的。它设置为正确的时区（东部）和夏令时调整，这是我自己的Win7机器设置的方式（我自己的机器没有这个问题）。

这次在VB6中得到的代码行是：

```
.IssueDate = Now 
```

将当前时间和日期放入成员变量中。

鉴于时钟显示正确的时间并且时区和 DST 调整显示正确，有没有人知道为什么特定机器会关闭一小时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T23:07:30.360

我将把这个标记为“已回答”并继续前进。我犹豫地要求我的用户重新启动，并没有真正期望它做任何事情。他做到了，并说他运行的测试用例没有显示错误。我让他下次将系统用于其全面用途时给我打电话，但他没有这样做。我目前的怀疑是今天早上PC时钟关闭了一个小时并且他没有注意到它，他只注意到应用程序正在生成的文件上的时间。

# django - Django中的条件包含标签

> ID：10950275
> 
> 赞同：5
> 
> 时间：2012-06-08T13:58:31.040
> 
> 标签：django, django-templates

我遇到了 Django 模板系统的非常奇怪的行为。我有一个模板文件，即`test.html`，它递归地包含自己：

```
{% include "test.html" %} 
```

当然，这样的模板没有机会被渲染，因为没有完成条件。好的，让我们尝试以下方法：

```
{% if test_false %}{% include "test.html" %}{% endif %}, 
```

其中`test_false`是传递给模板的变量并且等于`False`。

人们期望它不包含任何内容，但它确实：

```
RuntimeError at /test/
maximum recursion depth exceeded while calling a Python object 
```

我不明白。包含标签可以从当前上下文中获取参数，所以我怀疑它是在页面的任何其他部分之前执行的。那它为什么会忽略条件标签呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:19:55.293

Django 进行了优化，包括在编译时由常量给出的模板。

将模板的名称设置为变量并以这种方式包含它：

```
{% include test_template %} 
```

Django 将无法使用它的优化，您的代码应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-31T16:04:59.700

就像 Thomasz 说的，如果路径在包含模板中定义为常量字符串，Django 只能进行这种优化 - 如下所示：

```
{% include "test.html" %} 
```

但我宁愿不必将模板路径放在 Python 代码的上下文中。

因此，这是一种实现相同结果的更独立的方法 - 将 include 包装在 a 中`with`：

```
{% with "test.html" as path %}
    {% include path %}
{% endwith %} 
```

# c# - 未创建实体框架数据库

> ID：10950279
> 
> 赞同：2
> 
> 时间：2012-06-08T13:58:42.010
> 
> 标签：c#, .net, entity-framework, exception-handling

我首先在一个简单的 MVC3 应用程序中使用 EF4 代码。上下文对象正在拾取正确的连接字符串，并调用初始化程序构造函数，就像 OnModelCreating 方法一样，但从未调用种子方法并且未创建数据库。任何想法为什么？

```
protected void Application_Start()
{
    Database.SetInitializer<SchoolContext>(new SchoolInitializer());
    SchoolContext context = new SchoolContext();
    context.Database.CreateIfNotExists();
    ...
}

public class SchoolInitializer : DropCreateDatabaseAlways<SchoolContext>
{
    public SchoolInitializer()
    {
    }
    protected override void Seed(SchoolContext context)
    {
        var students = new List<Student>
        {
            new Student {StudentId = Guid.NewGuid(), Name = "Carson" },
            new Student {StudentId = Guid.NewGuid(), Name = "Meredith" }
        };
        students.ForEach(s => context.Students.Add(s));
        context.SaveChanges();
    }
}

public class Student
{
    [Key]
    public Guid StudentId;
    public string Name;
}

public class SchoolContext : DbContext
{
    public DbSet<Student> Students { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    }
} 
```

配置：

```
<connectionStrings>
    <add name="SchoolContext" connectionString="Data Source=|DataDirectory|School.sdf" providerName="System.Data.SqlServerCe.4.0" />
</connectionStrings> 
```

我认为抛出的异常只是抱怨尚未创建数据库：

> [ModelValidationException：在模型生成过程中检测到一个或多个验证错误：
> 
> .Data.Edm.EdmEntityType: : EntityType 'Student' 没有定义键。定义此 EntityType 的键。System.Data.Edm.EdmEntitySet：EntityType：EntitySet “Students”基于没有定义键的“Student”类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:03:50.523

您的模型无效 -`Student`实体没有定义键，并且在模型有效之前不会触发数据库创建。

您应该将访问器添加到您的`StudentId`. 这将使模型有效并触发数据库创建

```
public Guid StudentId { get; set; } 
```

# .net - 获取套接字的本地端口号

> ID：10950282
> 
> 赞同：0
> 
> 时间：2012-06-08T13:58:51.607
> 
> 标签：.net, silverlight, windows-phone-7, windows-phone-7.1

在 vanilla .net 中，`Socket`该类有一个属性`LocalEndPoint`，它提供了套接字本地端的详细信息，包括端口。在 Windows Phone 7`Socket`中，缺少此属性。

有没有办法获取套接字本地端的端口号？

**更新**

我在 WP7 上实现了一个简单的网络协议。它将使用回调的服务器，并且原始请求查询必须指定要发送回调的端口（服务器 API 不支持访问传入连接的详细信息，并且不支持更改这部分代码此时的一个选项）。电话和服务器都通过本地网络相互连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T10:08:20.673

目前简单的答案似乎是“否”。

如果有人知道为什么微软不想让你知道这一点，请告诉我。

# c++ - 树上的多线程

> ID：10950285
> 
> 赞同：0
> 
> 时间：2012-06-08T13:59:07.703
> 
> 标签：c++, multithreading, boost

使用 boost 我需要去一棵树进行序列比对，从叶子开始，一直到叶子。我必须使它成为多线程的。我怎样才能实现这一点，再次使用提升线程？

我想穿过这棵树，看看它是不是一片叶子。如果是这样，对齐它然后等待其他对齐，然后移动到下一个入口点。像这样的东西：

```
              R
            / \
           / \
          {a} {b}
         / \ / \
       {c} {d} {e} [f]
       //
     [h] [j]

```

`f`一片叶子在哪里？`h`和 也是如此`j`。它需要等到没有叶子了才能进入下一个级别，依此类推。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T07:02:38.360

使用 boost 线程组和一个双端队列，看看

# linux - 是否可以有条件地在 makefile 中定义宏？

> ID：10950292
> 
> 赞同：0
> 
> 时间：2012-06-08T13:59:28.917
> 
> 标签：linux, makefile, gnu-make, hp-ux

我正在编写一个必须与 LINUX 和 HP-UX 操作系统兼容的 makefile。我知道 LINUX 中的某些 shell 命令与 HP-UX 不兼容。因此，我想知道是否可以有条件地声明宏，以便如果确定操作系统是 HP-UX，宏将以某种方式定义，如果操作系统是 LINUX，它会以不同的方式定义？

```
OS       = `uname`
myOS     = Linux

ifeq ($(OS),$(myOS))
    message = "HELLO LINUX"
else
    message = "HELLO FOO" 
endif

all: install

install:
    echo $(message) 
```

我试过使用上面的方法；但是，似乎 ifeq 确定 OS 和 myOS 不一样。它们都应该是“Linux”，但它输出的是 else 块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:01:09.780

[是的，您可以在 makefiles](http://www.apl.jhu.edu/Misc/Unix-info/make/make_7.html)中定义条件。

这个例子取自上面的链接

```
libs_for_gcc = -lgnu
normal_libs =

foo: $(objects)
ifeq ($(CC),gcc)
        $(CC) -o foo $(objects) $(libs_for_gcc)
else
        $(CC) -o foo $(objects) $(normal_libs)
endif 
```

这显示了[条件句的语法](http://www.apl.jhu.edu/Misc/Unix-info/make/make_7.html#SEC69)。

鉴于此定义任何特定的东西都不应该成为问题。`-D`例如，可以通过C 程序的开关定义/传递 marcos 。

**更新**：要解决**OS**变量没有获得 shell 命令输出的问题，`uname`您需要使用[shell 函数](http://sunsite.ualberta.ca/Documentation/Gnu/make-3.79/html_chapter/make_8.html#SEC83)（正如@AraundF 正确指出的那样）：引用我发布的链接：

> “shell 函数执行的功能与反引号 (``) 在大多数 shell 中执行的功能相同......”

所以你在正确的轨道上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:43:22.417

您应该使用 $(shell ...) 来执行 SHELL 命令，这将起作用

```
OS       := $(shell uname)
myOS     := Linux

ifeq ($(OS),$(myOS))
    message := "HELLO LINUX"
else
    message := "HELLO FOO" 
endif

all: install

install:
    echo $(message) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:23:29.847

我们在这里所做的是`ARCH`在我们构建东西的所有系统上定义一个环境变量，在 Linux 系统上它将具有 value `linux`，在 AIX`aix`等上，`Makefile`我们有：

```
include make.$(ARCH) 
```

对于每个平台，我们创建一个名为`make.linux`,`make.aix`等的文件，其中包含特定于该平台的定义，例如`make.linux`包含：

抄送=g++

并`make.aix`包含

CC=xlC_r

这是一个非常好的和干净的方法，但是我们现在正在迁移到 cmake ( [http://www.cmake.org/](http://www.cmake.org/) )。

# sql-server-2008 - 无法终止 SQL 服务器作业，状态保持终止/回滚

> ID：10950296
> 
> 赞同：6
> 
> 时间：2012-06-08T13:59:37.150
> 
> 标签：sql-server-2008, sql-server-agent

我无法终止某些 SQL Server 代理作业。任务状态继续运行，命令停留在 KILLED/ROLLBACK。该作业通过 OLEDB 链接服务器和 Oracle 对 OSI 的 PI 系统执行查询。到目前为止，我发现杀死这些作业的唯一方法是重新启动 SQL 服务器（不是首选方法）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:54:24.097

我发现以下文章 [https://connect.microsoft.com/SQLServer/feedback/details/187192/openquery-to-linked-server-hangs-leaving-spid-with-open-tran-that-c​​annot-be-killed-然后-templog-ldf-grows-without-limit-requires-sql-server-restart-on-production-servers](https://connect.microsoft.com/SQLServer/feedback/details/187192/openquery-to-linked-server-hangs-leaving-spid-with-open-tran-that-cannot-be-killed-then-templog-ldf-grows-without-limit-requires-sql-server-restart-on-production-servers)

显然，有几个人通过不是 SQL Server 的链接服务器使用 openquery 时遇到了这个问题。我正在重新发布 BReuter 在上述文章中发布的解决方法：

**BReuter 于 2007 年 1 月 30 日下午 2:21 发布** *我已经体验了确切的行为，并找到了一个稳定我们环境的软件组合。

我发现了三个关键成分：

1）确保您没有使用 Microsoft OLEDB Provider for Oracle 的任何链接服务器，而是使用 Oracle Provider for Oracle（我在生产中使用的是 9.2.0.4 版）。

2) 不允许链接服务器“进行中”运行。这需要一些研究，但可以按照以下说明在 SQL 内存空间之外运行链接服务器。

3) 我在 W2K3 上运行 SQL 2005 SP1，但我相信 OLEDB 提供程序是关键，而不是操作系统或数据库版本。默认安全设置太严格，无法在进程外运行 Oracle OLEDB 提供程序 (OraOLEDB)。此外，MS DTC 的默认设置不允许网络通信。

1.  控制面板-> 管理工具-> 组件服务
2.  钻取到组件服务-> 计算机

    一个。右键单击我的电脑-> 属性

3.  MSDTC 选项卡 -> 安全配置按钮（下面的屏幕截图）

    一个。网络 DTC 访问 – 选中。

    湾。允许入站/出站 - 选中。

    C。无需身份验证 - 这模拟了 windows 2000 安全设置。

    d。启用 XA 事务——由 OraOLEDB 提供者实现的事务类型。

4.  钻取到组件服务-> 计算机-> 我的电脑-> DCOM 配置

    一个。右键单击 MSDAINITALIZE-> 属性

5.  安全选项卡（下面的屏幕截图）

    一个。访问权限 -> 自定义。

    湾。按“访问权限”编辑按钮。

    C。授予 SQL Server 服务帐户“本地访问”权限。

    d。重复“启动和激活”。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:02:01.400

如果它们是大型事务，则可能是服务器实际上仍在执行回滚，这可能需要一些时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-06T18:08:34.483

此页面 [http://www.jaygeiger.com/index.php/2015/03/03/how-to-kill-a-frozen-linked-sql-server-connection/](http://www.jaygeiger.com/index.php/2015/03/03/how-to-kill-a-frozen-linked-sql-server-connection/) 提供了一种解决方法。它包括手动 TCP 连接终止。这不是一个理想的解决方案，但它是我所知道的最好的解决方案。这比必须重新启动整个 SQL Server 要好。

顺便提一句。[我在https://connect.microsoft.com/SQLServer/feedback/details/187192/openquery-to-linked-server-hangs-leaving-spid-with-open-tran-that-c​​annot-be-killed](https://connect.microsoft.com/SQLServer/feedback/details/187192/openquery-to-linked-server-hangs-leaving-spid-with-open-tran-that-cannot-be-killed-then-templog-ldf-grows-without-limit-requires-sql-server-restart-on-production-servers)找到了该链接[-then-templog-ldf-grows-without-limit-requires-sql-server-restart-on-production-servers](https://connect.microsoft.com/SQLServer/feedback/details/187192/openquery-to-linked-server-hangs-leaving-spid-with-open-tran-that-cannot-be-killed-then-templog-ldf-grows-without-limit-requires-sql-server-restart-on-production-servers)页面在*Ahd*的帖子中提到

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-10T10:28:43.877

对我来说，杀死 OLEDB 外部资源没有用，不幸的是我不得不重新启动 SQL 服务器实例来解决这个问题

在我的情况下，它从 oracle 链接服务器或 SharePoint 列表中选择了 OPENQUERY，这些列表只是有一个简单的错误，例如密码错误，它无法解决错误并且在您重新启动服务之前永远不会回来

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-28T18:29:27.830

卡在 KILLED/ROLLBACK 中的事务可以通过杀死本地服务器上的事务来取消。如果查询是跨服务器的并且您不想等待回滚，则必须转到远程服务器并终止事务以及在本地服务器上终止事务。

这适用于任何数据库系统。

# php - 如何在同一页面中使用 $_GET

> ID：10950297
> 
> 赞同：-7
> 
> 时间：2012-06-08T13:59:37.920
> 
> 标签：php, list, get, action

我的伪代码如下：

```
if($_GET['action'] == 'list'){

do function getFileList($dir)

else

do nothing
 exit;
 }
require_once "./dir.php";
require_once "./echo.php";

function getFileList($dir)
  {
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:02:08.857

您的伪代码几乎就在那里。

```
require_once "./dir.php";
require_once "./echo.php";

function getFileList($dir)
{
   /* ... */   
}

if($_GET['action'] == 'list') {
   getFileList($dir);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:04:39.670

您是否在问如何通过 GET 将变量从同一个 PHP 文件中发送到 PHP 文件？您可以创建一个提交给自身的表单：[http](http://www.tellingmachine.com/post/Simple-self-submitting-PHP-forms.aspx) ://www.tellingmachine.com/post/Simple-self-submitting-PHP-forms.aspx 。

如果您想做其他事情，请提供更多详细信息。

# android - 从 FTP 服务器访问文本文件，Android 开发

> ID：10950300
> 
> 赞同：1
> 
> 时间：2012-06-08T13:59:49.030
> 
> 标签：android, ftp

我正在尝试访问 Android 中 FTP 服务器上的文件。

出于某种原因，每当我导入任何外部 jar（例如 commons-net 或 ftp4j）时，我的应用程序都会在运行时崩溃。我已经通过注释掉所有引用 jar 的行来验证这一点，并且应用程序可以正常运行。

我想访问 FTP 服务器上的文本文件中的数据并将其打印到 TextView。我整天都被困在这上面。我该如何解决？包括在清单中的权限是互联网和外部存储。

```
package com.testing.pack;

import java.io.BufferedInputStream;

import org.apache.commons.net.ftp.FTP;
import org.apache.commons.net.ftp.FTPClient;
import org.apache.http.client.HttpClient;
import android.app.Activity;
import android.graphics.Typeface;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;
import android.widget.TextView;

public class TestingActivity extends Activity implements OnClickListener {
    /** Called when the activity is first created. */

    TextView tv;
    Button go;
    HttpClient client;
    FTPClient ftp;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.main);
        tv = (TextView) findViewById(R.id.tvTry);
        Typeface face = Typeface.createFromAsset(getAssets(),
                "Roboto-LightItalic.ttf");
        tv.setTypeface(face);
        go = (Button) findViewById(R.id.bGO);
        go.setOnClickListener(this);

        try {
                        //Attempt using commons-net

            FTPClient ftpClient = new FTPClient();
            ftpClient.connect("ftp://........./");
            ftpClient.login(".......", ".....");
            ftpClient.changeWorkingDirectory("......");
            ftpClient.setFileType(FTP.BINARY_FILE_TYPE);
            BufferedInputStream buffIn=null;
            buffIn=new BufferedInputStream(new FileInputStream(file));
            ftpClient.enterLocalPassiveMode();
            ftpClient.storeFile("test.txt", buffIn);
            buffIn.close();
            ftpClient.logout();
            ftpClient.disconnect();

                        //Attempt using ftp4j

                        //FTPClient ftp = new FTPClient();
            //ftp.connect("........");
            //ftp.login(".......", ".....");
            //ftp.changeDirectoryUp();
            //ftp.changeDirectory(".....");
            //ftp.changeDirectory("public_ftp");
            //ftp.download("test.txt", new java.io.File("....."));
        } catch (Exception e) {

        }

    }

    @Override
    public void onClick(View arg0) {
        // TODO Auto-generated method stub
        getData ex = new getData();
        try {
            tv.setText(ex.getInternetData());
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:12:23.677

您是否使用 Eclipse 添加罐子？而是创建一个 libs 文件夹并将 jar 复制到其中。

这是一个类似的问题：[如何在 Android 项目中使用外部 JAR？](https://stackoverflow.com/questions/1334802/how-can-i-use-external-jars-in-an-android-project)

# wordpress - 哪个 WP 插件使用户无需注册即可添加帖子？

> ID：10950311
> 
> 赞同：0
> 
> 时间：2012-06-08T14:00:30.483
> 
> 标签：wordpress

我想知道我应该选择哪个 WP 插件来允许每个访问我页面的用户从前端向我的页面添加帖子。

他只需点击一个按钮添加一个新帖子或类似的东西。然后出现一个表格，他插入标题并上传图像。

之后，它作为一个帖子发布。

WP有这样的解决方案吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:35:30.573

据我所知，没有现有的插件可以满足您的需要。即使它存在，出于安全原因，我也不建议使用它；很难跟踪每种用途并确保访问者会按照您想要的方式发布。

你最好自己编写代码，使用[wp_insert_post](http://codex.wordpress.org/Function_Reference/wp_insert_post)函数非常简单。这个函数可以在你把它放在 Wordpress 中的任何地方工作（不需要从头开始构建插件），所以一个简单的带有验证的表单就可以了。

希望它能指导您找到所需的内容。

# wpf - 如何从继承的 DataTemplate 向基本 Grid 添加新元素？

> ID：10950314
> 
> 赞同：1
> 
> 时间：2012-06-08T14:00:47.810
> 
> 标签：wpf, xaml, inheritance, listbox, datatemplate

我有两个对象：`Bicycle`and `BicycleFullSuspension`，它继承 Bicycle 并包含其他属性（字符串和小数）。我设法使一个功能`DataTemplateSelector`可以选择我的`LbxItemTemplateBicycle`DataTemplate 或我的`LbxItemTemplateFullSuspension`DataTemplate，具体取决于对象`ObservableCollection`所属的类。这两个模板都绑定到父模板`ListBoxItemTemplate`。

我正在尝试在 ListBox 中显示有关每个对象的信息，并且每个继承模板都应在父 DataTemplate 中的网格中添加更多字段。我的问题是我无法弄清楚如何从继承的模板之一将 WPF 元素添加到 ListBoxItemTemplate 的网格中。我无法为模板中的网格分配一个键，所以我不确定如何指定额外的 TextBlocks 应该在父模板中的同一个网格中结束。（现在，额外的 TextBlocks 堆叠在父网格的顶部。）

```
<DataTemplate x:Key="ListBoxItemTemplate">
        <Border Name="LbxItemTemplate" BorderBrush="DarkRed" BorderThickness="2" Padding="5" Margin="5">
        <Grid>
            <Grid.RowDefinitions>
                ...
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                ...
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Row="1" Grid.Column="0" Text="Bike Year:" />
            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding BikeYear}" />
            <TextBlock Grid.Row="2" Grid.Column="0" Text="Bike Color: "/>
            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding BikeColor}"/>
            ...
            </Grid>
        </Border>
    </DataTemplate>
   <DataTemplate x:Key="LbxItemTemplateFullSuspension" DataType="{x:Type app:BicycleFullSuspension}">
        <Grid>
        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource ListBoxItemTemplate}" />
            <TextBlock Grid.Row="6" Grid.Column="0" Text="Shock Travel"/>
            <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding ShockTravel}"/>
        </Grid>
    </DataTemplate> 
```

我发现这些链接有助于达到这一点：

[http://dariosantarelli.wordpress.com/2011/07/28/wpf-inheritance-and-datatemplates/](http://dariosantarelli.wordpress.com/2011/07/28/wpf-inheritance-and-datatemplates/) [http://zamjad.wordpress.com/2009/12/31/applying-data-template-conditionally/](http://zamjad.wordpress.com/2009/12/31/applying-data-template-conditionally/)

[有没有办法在 WPF 中使用数据模板继承？](https://stackoverflow.com/questions/4443600/is-there-a-way-to-use-data-template-inheritance-in-wpf)

## 编辑：

我不知道为什么我不认为将边框放在继承基础的模板上，而是通过在继承模板中的边框内嵌套一个 StackPanel（StackPanel 包含带有基本模板内容的 ContentPresenter 以及 Grid有附加信息），一切都很好：

工作解决方案，使用来自**XAMeLi**的输入：

```
<DataTemplate x:Key="ListBoxItemTemplate">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                ...
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150" SharedSizeGroup="LabelColumnGroup" />
                <ColumnDefinition Width="150" SharedSizeGroup="LabelColumnGroup" />
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Row="1" Grid.Column="0" Text="Bike Year:" />
            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding BikeYear}" />
            ...
        </Grid>
   </DataTemplate>
   <DataTemplate x:Key="LbxItemTemplateFullSuspension" DataType="{x:Type app:BicycleFullSuspension}" >
        <Border BorderBrush="DarkRed" BorderThickness="2" Padding="5" Margin="5" Grid.IsSharedSizeScope="True" Width="500">
            <StackPanel>
            <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource ListBoxItemTemplate}" />
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    ...
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" SharedSizeGroup="LabelColumnGroup" />
                    <ColumnDefinition Width="Auto" SharedSizeGroup="LabelColumnGroup" />
                </Grid.ColumnDefinitions>
                ...
                <TextBlock Grid.Row="7" Grid.Column="0" Text="Shock Type: "/>
                <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding ShockType}"/>
                ...
            </Grid>
            </StackPanel>
        </Border>
    </DataTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:20:20.540

您无法将 UIElemets 添加到数据模板，但您可以布局更大的模板，使其看起来像是在基本模板中添加了文本。

基本上，你是在正确的道路上，只有大模板的布局是损坏的。（太糟糕了，你省略了行和列的结构）

试试这个：

```
<DataTemplate x:Key="ListBoxItemTemplate">
    <Border Name="LbxItemTemplate" BorderBrush="DarkRed" BorderThickness="2" Padding="5" Margin="5">
    <Grid>
        <Grid.RowDefinitions>
            ...
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"
                              SharedSizeGroup="LabelGroupColumn"/>
            ...
        </Grid.ColumnDefinitions>
      ....
    </Border>
</DataTemplate>

<DataTemplate x:Key="LbxItemTemplateFullSuspension">
    <Grid Grid.IsSharedSizeScope="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/><!--This will hold the default template-->
            <!--From here define the same structure as in the default template, if you have rows for margins and such-->
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"
                              SharedSizeGroup="LabelGroupColumn"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource ListBoxItemTemplate}" />
        <TextBlock Grid.Row="1" Grid.Column="0" Text="Shock Travel"/>
        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ShockTravel}"/>
    </Grid>
</DataTemplate> 
```

您的网格似乎具有标签值结构，并且您希望所有值都从同一条垂直线开始（从 UX 的角度来看，这非常好）。请注意`SharedSizeGroup`列定义`Grid.IsSharedSizeScope="True"`上的设置器和共同父级上的设置器。这将使标签列的宽度在网格之间保持同步。

# node.js - Node.js、cluster、express、apache ab 和 mongodb

> ID：10950316
> 
> 赞同：2
> 
> 时间：2012-06-08T14:00:59.363
> 
> 标签：node.js, mongodb, express, performance-testing

我是 mongo 的新手，并且使用 Node.js (v0.4.12)、集群 (Learnboost v0.7.7) 和 express (v2.5.9) 设置了一些性能测试。我正在尝试连接到 mongo 并使用 apache ab 进行简单的性能测试。我已经用 MySql 进行了设置，它完美地工作，但是当我尝试用 mongo 进行相同的测试时，我没有得到我期望的结果。

使用 MySql，我向 node.js 集群（8 个核心）发送 10,000 个请求，并将 10,000 行插入到数据库中。没有问题。但是，当我用 mongo 做同样的事情时，我只得到大约 4,500-4,900。我试过 mongoskin、mongo-lite、node-mongodb-native 并且都得到了完全相同的结果。

我想可能是池的大小，所以我增加/减少了它。没有什么。没有错误或异常。我很茫然...

任何帮助，将不胜感激。

谢谢。

测试代码如下；

## 应用程序.js

```
var mongoLite = require('mongo-lite');
var express   = require('express');

var count  = 1;
var config = {
host    : 'localhost', 
user    : USER,
pass    : PASSWORD,
port    : '27017',
db      : 'test',
options : 'poolSize=10'
};

var configUrl = 'mongodb://'    +
              config.user + ':' + 
              config.pass + '@' + 
              config.host + ':' + 
              config.port + '/' +
              config.db;

var mongo   = mongoLite.connect(configUrl);
var server  = express.createServer();

server.get('/test/:id', function (req, res) {               
mongo.collection('test_' + req.params.id).insert({_id: count++}, function(err, doc){
    if (err)
        throw err;
});
res.end('inserted');
});

module.exports = server; 
```

## 服务器.js

```
var cluster = require('cluster');

cluster('./app')
    .use(cluster.reload())
    .use(cluster.logger('logs'))
    .use(cluster.stats())
    .use(cluster.pidfiles('pids'))
    .use(cluster.cli())
    .use(cluster.repl(8888))
    .listen(81); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:47:14.720

我在 apache ab 上遇到过这些问题。我的结论是，它在节点上发出请求的速度比它处理它们的速度要快，因为如果这样的话，某些请求根本就没有得到处理。

我编写了自己的基准测试以在 Java 中进行 http 连接作为一种解决方法

# wordpress - 创建一个展开的小部件

> ID：10950317
> 
> 赞同：0
> 
> 时间：2012-06-08T14:01:06.483
> 
> 标签：wordpress, widget, wordpress-theming

我正在尝试创建一个类似于文本小部件的小部件，但我不希望它被包装，我不希望在它周围添加任何 div 或格式。这将在结束标记之前用于 javascript，所以我只是想将普通/基本信息输入到小部件中。除了下面的东西，我还需要什么？我做对了吗？

```
function 123_widgets_init() {
    register_sidebar( array(
        'name' => __( 'Scripts', '123' ),
        'id' => 'sidebar-1',
        'before_widget' => '',
        'after_widget' => '',
        'before_title' => '',
        'after_title' => '',
    ) );
}
add_action( 'widgets_init', '123_widgets_init' ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T13:45:47.630

是的，你做得对。任何文本小部件都可以使用 javascript - 如果你想摆脱 div 和 p 标签和类 - 你的代码应该足够了。

您还可以使用一些过滤器来清洁其他东西。

实际上，我有这样一个小部件的代码 - 我不记得我是从哪个网站获取的（一些片段存储库），但它基本上是复制了一些小改动的文本小部件。

```
<?php
/*
Plugin Name: Text widget for Javascript
Plugin URI: Unknown 
Description: Adds a Text widget with Javascript support - basically empty all divs classes etc.
Version: 3.1
Author: Unknown (code source unknown. compiled by Obmerk99)
Author URI: Unknown
License: GPL2
Network: true
*/

/**********************************************
 * Text widget class with small twicks for JS *
 **********************************************/

class WP_Widget_Text_For_JS extends WP_Widget {

    function __construct() {
        $widget_ops = array('classname' => 'widget_text', 'description' => __('Javascript Text Widget'));
        $control_ops = array('width' => 400, 'height' => 350);
        parent::__construct('text', __('Text'), $widget_ops, $control_ops);
    }

    function widget( $args, $instance ) {
        extract($args);
        $title = apply_filters( 'widget_title', empty($instance['title']) ? '' : $instance['title'], $instance, $this->id_base);
        $text = apply_filters( 'widget_text', $instance['text'], $instance );
        $before_widget = ''; $after_widget =''; $before_title=''; $after_title='';$after_widget=''; //empty all
        echo $before_widget;
        if ( !empty( $title ) ) { echo $before_title . $title . $after_title; } ?>
            <div class="textwidget"><?php echo $instance['filter'] ? wpautop($text) : $text; ?></div>
        <?php
        echo $after_widget;
    }

    function update( $new_instance, $old_instance ) {
        $instance = $old_instance;
        $instance['title'] = strip_tags($new_instance['title']);
        $instance['text'] =  $new_instance['text'];
        $instance['filter'] = isset($new_instance['filter']);
        return $instance;
    }

    function form( $instance ) {
        $instance = wp_parse_args( (array) $instance, array( 'title' => '', 'text' => '' ) );
        $title = strip_tags($instance['title']);
        $text = esc_textarea($instance['text']);
?>
        <p><label for="<?php echo $this->get_field_id('title'); ?>"><?php _e('Title:'); ?></label>
        <input class="widefat" id="<?php echo $this->get_field_id('title'); ?>" name="<?php echo $this->get_field_name('title'); ?>" type="text" value="<?php echo esc_attr($title); ?>" /></p>

        <textarea class="widefat" rows="16" cols="20" id="<?php echo $this->get_field_id('text'); ?>" name="<?php echo $this->get_field_name('text'); ?>"><?php echo $text; ?></textarea>

        <p><input id="<?php echo $this->get_field_id('filter'); ?>" name="<?php echo $this->get_field_name('filter'); ?>" type="checkbox" <?php checked(isset($instance['filter']) ? $instance['filter'] : 0); ?> />&nbsp;<label for="<?php echo $this->get_field_id('filter'); ?>"><?php _e('Automatically add paragraphs'); ?></label></p>
<?php
    }
}
function wp_o99_javascript_text_widget(){
    // unregister_widget('WP_Widget_Text'); // Only if you really want to .
    register_widget('WP_Widget_Text_For_JS');
}
add_action('widgets_init', 'wp_o99_javascript_text_widget', 1);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T06:24:55.973

使用我的插件[Magic Widgets](http://wordpress.org/extend/plugins/magic-widgets/)。它有一个不使用侧边栏参数的文本小部件，它在前端和后端视图的页眉和页脚中创建特殊的小部件区域。

您可以[从 GitHub 获取普通小部件](https://gist.github.com/1594985)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:06:24.040

还有很多步骤可以到达你想要的地方

1.  创建一个新的 sidebar-xxx.php 文件，该文件调用您创建的侧边栏
2.  创建一个[小部件](http://codex.wordpress.org/Widgets_API)以放入该侧边栏中。
3.  调用`get_sidebar('xxx');`您希望它在侧边栏中显示小部件的位置。

创建侧边栏文件或小部件时，您可以排除添加格式或包装器，而只是回显来自小部件的输入

[http://codex.wordpress.org/Widgets_API](http://codex.wordpress.org/Widgets_API)

# shell - 逐行扫描文本文件并使用 unix shell 脚本读取行

> ID：10950323
> 
> 赞同：3
> 
> 时间：2012-06-08T14:01:18.170
> 
> 标签：shell, unix

我知道已经有很多不同的线程像这样，但我找不到任何东西似乎可以很好地解释我正在尝试做的事情。

基本上我想要一个shell脚本，它只逐行遍历一个文本文件，并搜索单词“Error”或“Exception”。每当遇到这些单词时，它都会记录行号，以便我以后可以在一封包含问题行的电子邮件中删除文本文件。

我看过很多解释如何逐行遍历文本文件的东西，但我不明白如何在该行上运行正则表达式，因为我不确定如何使用正则表达式使用shell脚本以及每行存储的变量...

如果有人能为我澄清这些事情，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:13:08.090

您需要研究使用 grep 命令。有了它，您可以搜索特定的字符串，输出行号和行本身，并做更多的事情。

这是一个站点的链接，其中包含使用该命令的实际示例： [http ://www.thegeekstuff.com/2009/03/15-practical-unix-grep-command-examples/](http://www.thegeekstuff.com/2009/03/15-practical-unix-grep-command-examples/)

您可能对文章中的第 15 点特别感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:18:03.083

有许多工具可以自动循环文件。我会建议一个简单的解决方案，例如：

```
 grep -inE 'error|exception' logfile > /tmp/logSearch.$$ 
 if [[ -s /tmp/logSearch.$$ ]] ;then
   mailx -s "errors in Log" < /tmp/logSearch.$$
 fi
 /bin/rm /tmp/logSearch.$$ 
```

用于`man grep`了解我提供的选项。

来自`man bash

```
 -s file
True if file exists and has a size greater than zero. 
```

我希望这有帮助。

# c# - 多线程/多进程 windows 服务

> ID：10950326
> 
> 赞同：1
> 
> 时间：2012-06-08T14:01:20.417
> 
> 标签：c#, memory, windows-services

我创建了一个多线程服务来执行图像处理。一切正常，直到我们的一位客户将产品安装在具有大量内存的 16 进程服务器中。现在服务抛出了很多内存不足的错误，这是可以理解的，因为无论安装多少进程都只能获得 1.5GB 的内存。

这种情况下可接受的解决方案是什么？该服务是否应该产生一个单独的工作进程？每个 CPU 是否应该有一个工作进程通过命名管道与主服务通信？

编辑我们在 64 位服务器上运行，但由于映像库的限制，无法定位 x64

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:51:35.267

有多种解决方案。这些是一些选项：

1.  将您的 .exe 与[/LARGEADDRESSAWARE 选项](http://msdn.microsoft.com/en-us/library/wz223b1z%28v=vs.80%29.aspx)链接。这将为您的应用程序提供高达 3 Gig 的 RAM，并且无需进行其他更改。
2.  询问为您提供 64 位版本的 32 位二进制文​​件的软件供应商。
3.  将您的 32 位依赖项移出 proc（例如通过 COM 或 WCF 进行通信），并将您的 EXE 架构更改为 64 位。
4.  为每个执行操作生成新进程，而不是线程。
5.  将您的代码转换为使用[Address Windowing Extensions](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366527%28v=vs.85%29.aspx)。

选项#1 和#2 是最容易实现的，#5 是最困难的。

编辑我注意到`C#`你的问题中有标签。对于托管应用程序，您仍然可以使用[EditBin.exe 工具](http://msdn.microsoft.com/en-us/library/d25ddyfc.aspx)使用大型地址感知标志。

# android - Android：在内置图库中显示图像

> ID：10950329
> 
> 赞同：4
> 
> 时间：2012-06-08T14:01:30.103
> 
> 标签：android, image, gallery

我正在尝试在内置图库中打开一张图片，但它没有显示出来。我将 URI 记录为

06-08 15:53:02.232: D/URI(3231): file:///mnt/sdcard/com.jesper.indkoeb/nm-image.jpg

这是正确的地方

```
 @Override
                public void onClick(View v) {
                    Intent intent = new Intent();  
                    intent.setAction(android.content.Intent.ACTION_VIEW);  
                    File file = new File(uri.get(position));
                    Log.d("URI",uri.get(position));
                    intent.setDataAndType(Uri.fromFile(file), "image/*");  
                    context.startActivity(intent);

                }

            }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T14:51:15.547

关注 Snippet 将对您有所帮助。

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.parse("file:///mnt/sdcard/image/Apples.jpg"),"image/*");
startActivity(intent); 
```

# javascript - 当 DIV 从 IE8 中的光标下移动时，悬停样式保持不变

> ID：10950333
> 
> 赞同：2
> 
> 时间：2012-06-08T14:01:43.187
> 
> 标签：javascript, css, internet-explorer-8

我有[现场 jsFiddle 示例](http://jsfiddle.net/ByEzV/1/)

将鼠标移到“堆叠”元素之一上 - 悬停的项目将其颜色更改为深色 单击一个项目 - 它正在移动到堆栈的顶部。

在 IE8 中它仍然“悬停”（深色背景）但它现在不在鼠标光标下！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:34:36.643

尝试克隆元素而不是移动原始元素。使用原始元素，您将元素置于 DOM 中的当前状态并将其放置在新位置，当这种情况发生时，IE 似乎不会重新绘制元素，或者在您再次将鼠标悬停之前重置其状态。

通过克隆它，您将强制 IE 创建一个新元素，并且由于它不在页面上，因此无法对其应用悬停状态。然后只需将其添加到容器中，取出原件，就完成了。

```
$(".elem").on('click', function(){
    $(this).clone(true).prependTo('#container');
    $(this).remove();
});​ 
```

见：http: [//jsfiddle.net/y8PCc/1/](http://jsfiddle.net/y8PCc/1/)

从他的回答中归功于 Dmitry：[Internet Explorer :hover state 当目标 DOM 元素在 DOM 中移动时变得粘滞](https://stackoverflow.com/questions/7891761/internet-explorer-hover-state-becomes-sticky-when-the-target-dom-element-is-mov)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T06:49:43.390

您可以使用类而不是伪类并在移动后将其删除

```
$(".elem")
    .hover(function(e){
        $(this).toggleClass("elem-hover", e.type == "mouseenter");
    })
    .click(function(){
        $(".elem:first").before(this)                    
        $(this).removeClass("elem-hover")
    }) 
```

演示[http://jsfiddle.net/ByEzV/4/](http://jsfiddle.net/ByEzV/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:33:36.773

如果您将 jQuery 更改为此它应该可以在 ie8 中使用。

```
$(".elem").click(function(){
$(".elem:first").before(this);
$(this).css('background', '#fff').css('color', '#000');
})​ 
```

# cassandra - Cassandra CQL v3.0 和复合类型

> ID：10950338
> 
> 赞同：2
> 
> 时间：2012-06-08T14:02:07.967
> 
> 标签：cassandra, cql

我正在浏览[CQLv3.0的文档](http://www.datastax.com/docs/1.1/references/cql/index)

我们是否应该在更新和选择中指定复合键，例如 'a:b:1' 以防 my `comparator`or `key_validation`is `ascii`, `ascii`, `int`？

在选择中也没有提及`<select expression>`在更新中指定复合列和行的方式`<primary/composite key name>`

期待一些帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T15:36:53.220

CQL 3 负责为您管理实际的复合类型和值。CQL 3 行不一定与底层 Cassandra 行（“存储引擎行”）相同。复合值被抽象为单独的列。

[http://www.datastax.com/dev/blog/schema-in-cassandra-1-1](http://www.datastax.com/dev/blog/schema-in-cassandra-1-1)上的示例可能有助于理解转换。

# scripting - 如何在内联脚本中引用 Bamboo 工件？

> ID：10950340
> 
> 赞同：3
> 
> 时间：2012-06-08T14:02:11.157
> 
> 标签：scripting, bamboo

我想在 Bamboo 构建结束时运行内联脚本任务，以将一些工件复制到网络共享。请问如何引用此脚本中的工件输出目录？

Windows 环境，如果这有所作为。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T05:20:17.457

您将需要[配置工件共享](https://confluence.atlassian.com/display/BAMBOO40/Configuring+artifact+sharing+between+jobs)以将工件下载到您的工作区。一旦它在文件系统上，您可以使用脚本任务像对待任何其他文件一样对待它。

# linux - pwd 和 /bin/pwd 的输出差异

> ID：10950345
> 
> 赞同：2
> 
> 时间：2012-06-08T14:02:25.050
> 
> 标签：linux, bash

我通过使用从我的主文件夹创建了一个到 /etc/ 的软链接

```
"ln -s /etc/ foo" 
```

然后我将目录更改为 foo

```
"cd foo" 
```

现在我执行了以下两个命令

`"pwd"`和`"/bin/pwd"`

两者都给了我不同的输出。

“pwd”的输出是/home/myhome/foo，“/bin/pwd”的输出是/etc。尽管两个命令相同，但我无法理解输出的差异。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:10:49.997

可能有点过于简单，但`bash`内置`pwd`跟踪`cd`命令，所以当你`cd`通过符号链接时，它会记住这一点。另一方面，`/bin/pwd`将目录树返回到根目录，因此，不知道您可能通过哪些符号链接才能到达您所在的位置。

# java - 使用泛型的java事件

> ID：10950346
> 
> 赞同：1
> 
> 时间：2012-06-08T14:02:27.117
> 
> 标签：java, events, generics

我正在学习 java 泛型，并试图在有人问之前为事件实现它，我考虑过使用多态性，但是由于我希望每个事件都向处理程序的 start 方法发送不同的值，所以我不能这样做。

这是我的事件处理程序：

```
 public class MyHandler {
      public void startEventAction(int num) {
        //do something with num
      }  
    } 
```

这是我的模板事件：

```
 public abstract class SomeEvent<E> {
       protected List<E> handler_list = new LinkedList<E>();
       public SomeEvent() {
       }
       public Boolean addHandler(E handler) {
          return handler_list.add(handler);
       }
       public Boolean removeHandler(E handler) {
          return handler_list.remove(handler);
       } 
     } 
```

并且事件本身是：（现在我知道像这样扩展 SomeEvent 可能是错误的，但它似乎有效）

```
 public class MyEvent<MyHandler> extends SomeEvent<MyHandler> {
      public void executeHandlers() {   
        for (MyHandler handler : handler_list) {
            //Exception here!!
            handler.startEventAction(num);
        }
      }
    } 
```

我的问题是如何扩展它是正确的，为什么在最后一个代码块（对于 MyEvent）中 MyHandler 不存在函数 startEventAction 将非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:11:04.677

我认为应该是

```
public class MyEvent<T extends MyHandler> extends SomeEvent<T> {
      public void executeHandlers() {   
        for (T handler : handler_list) {
            //Exception here!!
            handler.startEventAction(lvc_count);
        }
    } 
```

如果您使用`MyEvent<MyHandler>`您正在考虑`MyHandler`作为类型参数，而不是作为类型参数。这就是为什么我通常宁愿使用字母作为类型参数而不是整个单词，这样可以避免它们与类和接口名称之间的混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:23:14.510

只需更改`MyEvent`类声明：

```
public static class MyEvent extends SomeEvent<MyHandler> { ... } 
```

应该没问题。

# haskell - 了解一点 Haskell

> ID：10950356
> 
> 赞同：2
> 
> 时间：2012-06-08T14:02:58.613
> 
> 标签：haskell, set, combinatorics, predicate

我有一个关于 Haskell 的快速问题。我一直在关注[Learn You a Haskell](http://learnyouahaskell.com/starting-out#tuples)，并且对以下代码段的执行顺序/逻辑有点困惑，用于计算三角形的边长，当所有边都等于或小于 10 并且三角形的总周长为 24：

`[(a,b,c) | c <- [1..10], b <- [1..c], a <- [1..b], a^2 + b^2 == c^2, a+b+c==24]`

令我困惑的部分是`b`and`a`绑定的上扩展界限。根据我的收集，`..c`and`..b`用于删除同一组三角形边的其他排列（组合？）。

当我用 运行它时`..c/b`，我得到了答案：

`[(6,8,10)]`

当我没有`..c/b`：

`[(a,b,c) | c <- [1..10], b <- [1..10], a <- [1..10], a^2 + b^2 == c^2, a+b+c==24]`

正如我最初输入时没有那样，我得到：

`[(8,6,10),(6,8,10)]`

这显然代表同一个三角形，除了`a`和`b`值已交换。

那么，有人可以带我了解这里发生的事情的逻辑/执行/评估吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:12:45.513

原始版本考虑所有三元组 (a,b,c)，其中 c 是 1 和 10 之间的数字，b 是 1 和 c 之间的数字，a 是 1 和 b 之间的数字。(6,8,10) 符合该标准，(8,6,10) 不符合（因为这里 a 是 8，b 是 6，所以 a 不在 0 和 6 之间）。

在您的版本中，您考虑所有三元组 (a,b,c)，其中 a、b 和 c 介于 1 和 10 之间。您对 a、b 和 c 如何相互关联没有任何限制，因此 (8, 6, 10)不排除，因为其中的所有数字确实在 1 到 10 之间。

如果您从命令式 for 循环的角度来考虑它，您的版本会这样做：

```
for c from 1 to 10:
  for b from 1 to 10:
    for a from 1 to 10:
      if a^2 + b^2 == c^2 and a+b+c==24:
        add (a,b,c) to the result 
```

而原始版本这样做：

```
for c from 1 to 10:
  for b from 1 to c:
    for c from 1 to b:
      if a^2 + b^2 == c^2 and a+b+c==24:
        add (a,b,c) to the result 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:11:18.320

这与执行顺序无关。在第一个示例中，您看不到退化的解决方案

```
[(8,6,10)] 
```

因为`a <= b <= c`. 在第二种情况下`a > b`，包含在列表理解中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T18:00:14.573

列表推导可以用其他函数来编写，例如`concatMap`，它阐明了绑定的范围。作为一个单行，你的例子变成了这样：

```
concatMap (\c -> concatMap (\b -> concatMap (\a -> if a^2 + b^2 == c^2 then (if a+b+c == 24 then [(a,b,c)] else []) else []) (enumFromTo 1 b)) (enumFromTo 1 c)) (enumFromTo 1 10) 
```

是的，这看起来很丑陋，但它类似于 Haskell 将你的理解分解成的内容。每个变量的范围`a`,`b`和`c`, 应该是显而易见的。

或者，这可以用`List`monad 编写：

```
import Control.Monad

example = do c <- [1..10]
             b <- [1..c]
             a <- [1..b]
             guard (a^2 + b^2 == c^2)
             guard (a+b+c == 24)
             return (a,b,c) 
```

This is actually very similar as the one-liner above, given the definition of the `List` Monad and `guard`:

```
instance Monad [] where
    return x = [x]
    xs >>= f = concatMap f xs

instance MonadPlus [] where
    mzero = []
    mconcat = (++)

guard bool = if bool then return () else mzero 
```

# php - php：从数组中删除（不同情况）重复项

> ID：10950359
> 
> 赞同：0
> 
> 时间：2012-06-08T14:03:03.543
> 
> 标签：php, arrays

可能是一个已经讨论过的话题，但在 PHP 中我没有找到答案是否有更简单的方法来实现以下内容：

```
$a = array("hello","hello","Hello","world","worlD");
$p=array();
foreach( $a as $v ){
    $p[strtolower($v)] = "";
}
print_r($p); 
```

在小情况下为数组保留一个元素

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:04:26.587

就像是：

```
$p = array_unique(array_map('strtolower', $a)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:10:08.977

您可以使用`array_flip`交换键和值：

```
$a = array_flip(array_map('strtolower', $a)); 
```

# c# - 两个用户是否都发生了并发异常

> ID：10950360
> 
> 赞同：0
> 
> 时间：2012-06-08T14:03:12.623
> 
> 标签：c#, sql-server, exception-handling, concurrency, data-access-layer

如果一个用户编辑了一条数据记录，同时另一个用户也编辑了同一条记录并且都保存了。

1.) 并发异常是否总是只发生在一个用户身上？

实际上，第一个获胜是合乎逻辑的，但在技术方面谁是第一个......两个用户都有可能得到这种例外吗？

2.）那个太晚了，现在得到并发异常的人我猜他可以访问

来自其他用户的新更新数据记录是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:05:49.023

在`Read committed`sql server 的默认隔离级别中：

如果并发请求访问对象，则 sql server 为它们创建队列并一一处理。第二个用户将等待用户 1 完成任务的预定义时间，如果无法在该时间范围内完成任务，则会抛出错误。此时间范围可在 sql server 和 ADO.net 中配置。

这一切都取决于你是否想要并发访问在 sql server 中定义的隔离级别。

[阅读有关 DB 中隔离级别的更多信息](http://msdn.microsoft.com/en-us/library/ms189122%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:09:26.807

1）我认为是的。一个总是比另一个早；没有其他方法可以解决它。所以一个更新会正常工作，另一个会抛出并发异常。

这可能取决于您使用的数据访问方法，可能有一些系统可以更优雅地处理这种情况。但我怀疑有些系统会给两个用户同样的例外情况，而您却没有故意构建这种行为。

正如 Adam Houldsworth 所说：这也可能取决于您自己编码的方式。您可以检查是否有多个用户开始编辑同一记录，然后向两者都抛出异常。但我不相信这就是你真正要问的。如果是这样的话; 我误解了。

2）当然这是可能的，但这取决于你在你的应用程序中构建。只需捕获并发异常并刷新用户 B 尝试更新的任何编辑表单。然后他/她可以再试一次。一般来说很明显；我不知道你的具体情况。

# jquery - jquery插件 - 调用方法

> ID：10950361
> 
> 赞同：0
> 
> 时间：2012-06-08T14:03:18.627
> 
> 标签：jquery, plugins, this, self

所以我正在为 jquery 构建我的第一个插件我有一个 init 方法

```
init: function(options, elem) {
var self = this; 
```

这调用了几个方法 this.slide(elem); this.lightbox(elem);

但是在灯箱方法中，我尝试使用调用我的自定义方法 setpositon

self.setposition(); //错误对象[对象窗口]没有方法'setposition'

或者

this.setposition() // 对象 # 没有方法 'setposition'

如何引用我创建的对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:10:15.037

> ```
> var myObj = {
>      init: function(){
>          var self = this;
>          this.alert();
>          myObj.alert();
>          self.alert();
>      },
>      alert: function(){
>          alert('Im called!');
>      } 
>  }; 
> ```
> 
> myObj.init();​</p>

在[jsFiddle](http://jsfiddle.net/shehovn/AWfzc/1/)上查看。

# sql - 在 python 中防止 SQL 注入

> ID：10950362
> 
> 赞同：11
> 
> 时间：2012-06-08T14:03:20.753
> 
> 标签：sql, python-2.7, security

我在 Python 中有一些代码在 sqlite DB 中设置一个 char(80) 值。

该字符串是通过文本输入字段直接从用户那里获取的，并使用 JSON 结构中的 POST 方法发送回服务器。

在服务器端，我目前将字符串传递给调用 SQL UPDATE 操作的方法。

它有效，但我知道它根本不安全。

我希望客户端无论如何都是不安全的，所以任何保护都应该放在服务器端。我可以做些什么来保护 UPDATE 操作再次 SQL 注入？

我正在寻找一个可以“引用”文本以使其不会混淆 SQL 解析器的函数。我希望这样的功能存在但找不到。

**编辑：** 这是我当前设置字符字段名称标签的代码：

```
def setLabel( self, userId, refId, label ):
    self._db.cursor().execute( """
        UPDATE items SET label = ? WHERE userId IS ? AND refId IS ?""", ( label, userId, refId) )
    self._db.commit() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T14:10:36.557

从文档中：

```
con.execute("insert into person(firstname) values (?)", ("Joe",)) 
```

这逃脱了`"Joe"`，所以你想要的是

```
con.execute("insert into person(firstname) values (?)", (firstname_from_client,)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T14:10:08.080

DB-API`.execute()`支持参数替换，它将为您处理转义，它在文档顶部附近提到；[http://docs.python.org/library/sqlite3.html](http://docs.python.org/library/sqlite3.html)上面*永远不要这样做——不安全*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:06:20.810

不...使用绑定变量！这就是他们的目的。看到[这个](http://en.wikipedia.org/wiki/SQL_injection)

该技术的另一个名称是[参数化 sql](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html) （我认为“绑定变量”可能是专门用于 Oracle 的名称）。

# iphone - 从存储的首选项设置首选项值

> ID：10950364
> 
> 赞同：0
> 
> 时间：2012-06-08T14:03:34.457
> 
> 标签：iphone, xcode, nsuserdefaults

今天玩我的代码，

我在整个特定类中以微小的变化多次运行这段特定的代码，但我正在尝试简化。效果上的差异很小，但将代码量改变了数百或数千行，因此对我来说将是一个巨大的个人胜利。

本质上，我有一个存储为整数的值，键为“codeKey”，我想将该键的值插入数字 30061 当前所在的位置。我有点不知所措，有人可以帮我解决这个问题吗？

我知道我需要以某种方式回忆价值并将其放入，但我不确定它会是什么样子。

```
 if ([[NSUserDefaults standardUserDefaults] integerForKey:@"buttonID"] == 1) {
        NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
        [userDefaults setInteger:30061   forKey:@"scifi1"];
        [userDefaults synchronize];} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:30:21.107

我认为您的意思是动态保存此信息，而无需一遍又一遍地复制相同的代码。如果这是正确的，您的解决方案将是这样的：

```
-(void)saveCodeKey:(int)key {

     if ([[NSUserDefaults standardUserDefaults] integerForKey:@"buttonID"] == 1) {

        NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
        [userDefaults setInteger:key   forKey:@"scifi1"];
        [userDefaults synchronize];

    }
} 
```

现在您可以简单地调用`[self saveCodeKey:12345];`假设该`-saveCodeKey:`方法驻留在同一个类中。

希望这可以帮助 ！

# python - python Socket.IO 客户端，用于向 TornadIO2 服务器发送广播消息

> ID：10950365
> 
> 赞同：20
> 
> 时间：2012-06-08T14:03:36.047
> 
> 标签：python, django, websocket, socket.io, tornado

我正在构建一个实时 Web 应用程序。**我希望能够从我的 python 应用程序的服务器端实现发送广播消息。**

这是设置：

*   客户端的**[socketio.js](http://socket.io/)**
*   **[TornadIO2](https://github.com/mrjoes/tornadio2)**服务器作为 Socket.IO 服务器
*   **服务器端的**python （** **[Django](https://www.djangoproject.com/)**框架）**

 **我可以成功地将 socket.io 消息从客户端发送到服务器。服务器处理这些并可以发送响应。在下文中，我将描述我是如何做到的。

## 当前设置和代码

首先，我们需要定义一个 Connection 来处理 socket.io 事件：

```
class BaseConnection(tornadio2.SocketConnection):
    def on_message(self, message):
        pass

    # will be run if client uses socket.emit('connect', username)
    @event
    def connect(self, username):
        # send answer to client which will be handled by socket.on('log', function)
        self.emit('log', 'hello ' + username) 
```

启动服务器由 Django 管理自定义方法完成：

```
class Command(BaseCommand):
    args = ''
    help = 'Starts the TornadIO2 server for handling socket.io connections'

    def handle(self, *args, **kwargs):
        autoreload.main(self.run, args, kwargs)

    def run(self, *args, **kwargs):
        port = settings.SOCKETIO_PORT

        router = tornadio2.TornadioRouter(BaseConnection)

        application = tornado.web.Application(
            router.urls,
            socket_io_port = port
        )

        print 'Starting socket.io server on port %s' % port
        server = SocketServer(application) 
```

很好，服务器现在运行。让我们添加客户端代码：

```
<script type="text/javascript">    
    var sio = io.connect('localhost:9000');

    sio.on('connect', function(data) {
        console.log('connected');
        sio.emit('connect', '{{ user.username }}');
    });

    sio.on('log', function(data) {
        console.log("log: " + data);
    });
</script> 
```

显然，`{{ user.username }}`将替换为当前登录用户的用户名，在本例中用户名是“alp”。

现在，每次刷新页面时，控制台输出都是：

```
connected
log: hello alp 
```

因此，调用消息和发送响应是有效的。*但现在是棘手的部分。*

## 问题

响应“hello alp”仅发送给 socket.io 消息的调用者。我想向所有连接的客户端广播一条消息，以便在新用户加入聚会时实时通知他们（例如在聊天应用程序中）。

所以，这是我的问题：

1.  如何向所有连接的客户端发送广播消息？

2.  如何向在特定频道上订阅的多个连接的客户端发送广播消息？

3.  如何在我的 python 代码中的任何地方（`BaseConnection`课堂外）发送广播消息？这是否需要某种用于 python 的 Socket.IO 客户端，或者是 TornadIO2 内置的？

所有这些广播都应该以可靠的方式完成，所以我想 websockets 是最好的选择。但我对所有好的解决方案持开放态度。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-08T14:23:06.337

我最近在类似的设置上编写了一个非常类似的应用程序，所以我确实有一些见解。

做你需要的正确方法是拥有一个 pub-sub 后端。简单的 s 能做的只有这么多`ConnectionHandler`。最终，处理类级别的连接集开始变得丑陋（更不用说有问题了）。

理想情况下，您希望使用 Redis 之类的东西，异步绑定到龙卷风（查看[brukva](https://github.com/evilkost/brukva)）。这样，您就不必为将客户端注册到特定渠道而烦恼——Redis 开箱即用。

本质上，你有这样的东西：

```
class ConnectionHandler(SockJSConnection):
    def __init__(self, *args, **kwargs):
        super(ConnectionHandler, self).__init__(*args, **kwargs)
        self.client = brukva.Client()
        self.client.connect()
        self.client.subscribe('some_channel')

    def on_open(self, info):
        self.client.listen(self.on_chan_message)

    def on_message(self, msg):
        # this is a message broadcast from the client
        # handle it as necessary (this implementation ignores them)
        pass

    def on_chan_message(self, msg):
        # this is a message received from redis
        # send it to the client
        self.send(msg.body)

    def on_close(self):
        self.client.unsubscribe('text_stream')
        self.client.disconnect() 
```

请注意，我使用[了 sockjs-tornado](https://github.com/MrJoes/sockjs-tornado)，我发现它比 socket.io 稳定得多。

无论如何，一旦您进行了这种设置，从任何其他客户端（例如 Django，在您的情况下）发送消息就像打开 Redis 连接（[redis-py](https://github.com/andymccurdy/redis-py)是一个安全的选择）并发布消息一样简单：

```
import redis
r = redis.Redis()
r.publish('text_channel', 'oh hai!') 
```

* * *

这个答案很长，所以我加倍努力并用它写了一篇博文：http: [//blog.y3xz.com/blog/2012/06/08/a-modern-python-stack-for-实时网络应用程序/](http://blog.y3xz.com/blog/2012/06/08/a-modern-python-stack-for-a-real-time-web-application/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T14:22:08.863

我在这里写，因为在评论部分很难写。您可以在示例目录中查看 tornadoio2 的示例，您可以在其中找到聊天的实现，并且：

```
class ChatConnection(tornadio2.conn.SocketConnection):
    # Class level variable
    participants = set()

    def on_open(self, info):
        self.send("Welcome from the server.")
        self.participants.add(self)

    def on_message(self, message):
        # Pong message back
        for p in self.participants:
            p.send(message) 
```

如您所见，他们将参与者设置为集合））

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T16:36:28.107

如果您已经在使用 django，为什么不看看 gevent-socketio。**

# tmux - Tmux 复制模式：如何创建自己的命令？

> ID：10950368
> 
> 赞同：11
> 
> 时间：2012-06-08T14:03:55.280
> 
> 标签：tmux

我喜欢 Tmux 及其带有 Vi 命令的复制模式，但我真的很生气，因为这种模式远不如真正的 Vim 高效。

例如，没有键绑定只复制一个单词（yw），我必须始终“转到单词的开头”“开始选择”，“转到单词的末尾”然后“完成选择”。当我只需要在 vim 中做 yw 时，很多操作。

我搜索了一种在 Tmux 复制模式下创建自己的“yw”命令的方法。链接所需的所有操作是一个好主意，但是用 just 分隔的命令进行简单绑定`;`是行不通的（类似的事情在非复制模式下也有效）。有什么我想念的吗？还是 Tmux 的复制模式受到限制，并且不像我需要的那样可编写脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T18:32:04.753

我的 tmux conf 中有这个：

```
# vi-style controls in copy mode
set-option -g status-keys vi
set-window-option -g mode-keys vi

# v and y like vi in copy-mode
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'y' copy-selection 
```

现在进入复制模式后，我可以通过以下方式轻松选择单词：

`v``w`

并复制

`y`

在 tmux 中，您必须**选择**要复制的内容。正如您从通常的 vi/vim 命令中所知道的那样，没有什么比在正常模式下复制更好的了。不幸的是，每个 tmux 参数只能使用**一个键**（如`v`or `y`）。

您可以在此处找到有关 tmux 的 vi 移动命令的更多信息：[https ://superuser.com/a/197272/57890](https://superuser.com/a/197272/57890)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T18:34:32.120

当使用该选项`bind-key`调用时，这似乎是命令中的错误。`-t`我已在[https://sourceforge.net/tracker/?func=detail&aid=3533562&group_id=200378&atid=973262](https://sourceforge.net/tracker/?func=detail&aid=3533562&group_id=200378&atid=973262)提交了错误报告。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-04-30T13:52:36.287

在上游（2.4+）tmux 版本上，这已更改，为了创建一个绑定开始选择，您需要使用`-T`和发送密钥`-X`。

[tmux 更改日志](https://raw.githubusercontent.com/tmux/tmux/master/CHANGES)中的更多信息。

**这里以我对vi 复制模式**的绑定为例：

```
# Bind `v` to trigger selection    
bind-key -T copy-mode-vi v send-keys -X begin-selection

# Bind `y` to yank current selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Rebind `mouse click + drag button release` to not jump away from context
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-selection 
```

**如果**您使用的是**emacs**复制模式，则替换`copy-mode-vi`为`copy-mode`应该足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-18T15:20:50.207

tmux 有一个补丁，允许创建过程并为“模式”击键绑定任意数量的操作：http: [//ershov.github.io/tmux/](http://ershov.github.io/tmux/)

# ruby-on-rails - Ruby on rails & 乘客 & 回形针 | 图片已上传，但在乘客模块上显示 404

> ID：10950375
> 
> 赞同：0
> 
> 时间：2012-06-08T14:04:12.550
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip, passenger

一切都在 Ror 自己的服务器（Webrick）上运行，但是当我在 Apache（+Passenger mod）上尝试时，我总是得到 404（未找到）错误。

你可以在这里查看：http: [//keidan.hopto.org/rails/phoenix/public/guild](http://keidan.hopto.org/rails/phoenix/public/guild)。

我认为主要问题是我无法访问应用程序的公用文件夹...

我的虚拟主机文件：

```
ServerName keidan.hopto.org
ServerAlias keidan.hopto.org

DocumentRoot /var/www/
RackBaseURI /rails/phoenix/public

<Directory /var/www/rails/phoenix/public >
    AllowOverride all
    Options Indexes FollowSymLinks -MultiViews
    Order allow,deny
    Allow from all
</Directory> 
```

...

# php - 使用用户缓存时 APC 崩溃

> ID：10950378
> 
> 赞同：1
> 
> 时间：2012-06-08T14:04:25.467
> 
> 标签：php, crash, apc

我正在开发一个 PHP 应用程序，并希望在 APC 中缓存一些数据。APC 正在运行并启用，当我打开 apc.php 时可以看到统计信息，这表明操作码缓存工作正常。

但是，每当我尝试使用`apc_store()`或`apc_add()`存储一些数据时，apache 进程就会崩溃。

这是在 Windows 7 Professional 64 位系统上，并且在以下两个版本组合中都会发生：

*   阿帕奇 2.2.21、PHP 5.3.9、APC 3.1.6
*   阿帕奇 2.2.22、PHP 5.3.13、APC 3.1.9

使用第一个配置，崩溃立即发生，这在 apache 错误日志中：

```
[Fri Jun 08 12:51:58 2012] [notice] Parent: child process exited with status 255 -- Restarting. 
```

第二个有一些延迟，我得到了这个：

```
[Fri Jun 08 16:18:48 2012] [notice] Child 5052: Exit event signaled. Child process is ending.
[Fri Jun 08 16:18:48 2012] [warn] (OS 995)Der E/A-Vorgang wurde wegen eines Threadendes oder einer Anwendungsanforderung abgebrochen.  : winnt_accept: Asynchronous AcceptEx failed.
[Fri Jun 08 16:18:48 2012] [warn] (OS 10038)Ein Vorgang bezog sich auf ein Objekt, das kein Socket ist.  : setsockopt(SO_UPDATE_ACCEPT_CONTEXT) failed.
[Fri Jun 08 16:18:52 2012] [warn] pid file C:/wamp/bin/apache/apache2.2.22/logs/httpd.pid overwritten -- Unclean shutdown of previous Apache run?
[Fri Jun 08 16:18:52 2012] [notice] Apache/2.2.22 (Win64) PHP/5.3.13 configured -- resuming normal operations 
```

可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:02:01.293

似乎我要存储的数组包含本机资源，这导致了崩溃。

`serialize()`在存储之前使用，`unserialize()`然后解决问题。

# java - Ajax JQuery 到 Spring @RequestBody？我如何传递数据？

> ID：10950383
> 
> 赞同：0
> 
> 时间：2012-06-08T14:04:39.903
> 
> 标签：java, jquery, ajax, rest, spring-mvc

Ajax JQuery 到 Spring @RequestBody？我如何传递数据？我现在正在通过传递表单字段来做春天，但我正在开发一个新系统，我们想使用 Ajax 和 RESTful 来传递数据。我的控制器看起来像下面的示例，但有人可以通过 ajax 调用来取悦我吗？我如何发布到 Spring 控制器并将数据放在正文中

```
@RequestMapping(method=RequestMethod.PUT, value="/employee/{id}")
public ModelAndView updateEmployee(@RequestBody String body) {
        Source source = new StreamSource(new StringReader(body));
        Employee e = (Employee) jaxb2Mashaller.unmarshal(source);
        employeeDS.update(e);
        return new ModelAndView(XML_VIEW_NAME, "object", e);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:21:09.167

使用 REST 时，了解不同 HTTP 方法之间的区别很重要。PUT 通常意味着您将创建一个新集合或替换现有集合。POST 通常意味着您将记录添加到集合中。两者的主要区别在于 PUT 是幂等的，这意味着重复相同的操作不会改变服务器的状态。

在下面的代码中，您的方法称为“updateEmployee”，这意味着您正在用一个新集合替换一个集合。因此，PUT 是在这种情况下使用的最合适的 HTTP 方法。但是，您的代码中有一个错误。您没有在参数列表中定义“id”：

```
// Added String id as a PathVariable
@RequestMapping(method=RequestMethod.PUT, value="/employee/{id}")
public ModelAndView updateEmployee(@RequestBody String body, @PathVariable String id) {   

        // You really don't need to do this. The Spring Framework can deserialize
          // objects for you. However, one issue at a time ;)
           // also, changed e to "employee" so the variable has a better name.
        Source source = new StreamSource(new StringReader(body));
        Employee employee = (Employee) jaxb2Mashaller.unmarshal(source);

        employeeDS.update(employee);
        return new ModelAndView(XML_VIEW_NAME, "object", employee);
} 
```

要向服务器发出请求，请使用 jQuery AJAX：

```
$.ajax({
  url: "/employee/2?t="+new Date().getTime(),
  contentType: 'application/x-www-form-urlencoded',
  type: "PUT",
  data: dataString,
  context: document.body,
  success: function(e){
          alert(e);                    
  },
      error: function(jqXHR, textStatus, errorThrown) {
          alert(" + textStatus + " : " + errorThrown);
      } 
}); 
```

dataString 是数据的字符串表示形式。您可以序列化表单、使用 JSON 或发送 url 编码的表单。如果在您的问题中没有看到更多代码和更多错误消息，则不清楚您在尝试将数据发送到服务器时如何表示数据。如果您从这里开始并修复 Java 代码中的上述错误，这应该可以帮助您克服这个特定错误。

另一种将数据提交到 REST 方法（仅用于测试）的方法是使用标准表单，但使用 method="PUT"，因为这是您在 Spring 中使用的：

```
<form name="test" action="/employee/2" method="PUT">
    <input type="text" name="firstname" />
    <input type="text" name="lastname" />
    <input type="submit" name="submit" value="submit" />
</form> 
```

这将使用 application/x-www-form-urlencoded。如果您无法反序列化，请尝试改用 JSON。祝你好运！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-08T14:13:12.157

希望能给你一个开始！

```
 $.ajax({
    contentType : "application/json",
    dataType : 'json',
    type : "PUT",
    url : targetUrl,
    data : $(this).serializeObject(), //json serialization (like array.serializeArray() etc)
    async : false,
    success : function(data) {
       // response
    },
    error : function(request, status, error) {
       // any errors
    }
}); 
```

# jquery - jQuery：在提交 ui.dialog 显示时，对话框按钮提交

> ID：10950384
> 
> 赞同：0
> 
> 时间：2012-06-08T14:04:40.107
> 
> 标签：jquery, form-submit

我有以下代码。有一个加载了术语的对话框，它显示在表单提交上。请帮助我通过对话框中的同意按钮提交表单。

```
$(".terms").dialog({
  autoOpen: false,
  modal: true,
  height: 400,
  width: 500,
  buttons: {
    "I agree": function() {
      return $("#new_user").submit();
    },
    "Don`t agree - Exit": function() {
      return $(this).dialog("close");
    }
  }
});

$("#new_user").submit(function(e) {
  e.preventDefault();
  return $(".terms").dialog("open");
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:07:13.790

目前尚不清楚您想要什么，但也许这会有所帮助。为了防止默认操作，您必须在提交函数中

```
$("#new_user").submit(function(e) {
    e.preventDefault();    
    $(".terms").dialog("open");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T07:04:55.117

```
buttons: {
    "I agree": function() {
      return $("#new_user").unbind("submit").submit();
    },
    "Don`t agree - Exit": function() {
      return $(this).dialog("close");
    } 
```

.unbind("提交").submit(); 在这种情况下将有助于提交表格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:09:30.147

```
>$("#new_user").submit(function(e) {
}); 
```

你有一个完全空的功能

```
e.preventDefault(); 
```

然后继续引用超出范围的内容（仅在功能块中的范围内）

```
$(".terms").dialog("open"); 
```

然后随机打开一个对话框。

将这两行放在功能块中并返回 false，您应该更进一步。

下一个问题是，通过在刚刚弹出术语对话框的同一元素上调用 .submit ，您几乎是在循环往复。一切都有些混乱。

您可能需要一个“提交”按钮，它会弹出对话框，然后在我猜的表单上调用提交。

# mysql - 什么是 mysql max_allowed_pa cket？mysql中插入数据的最大行数是多少？

> ID：10950386
> 
> 赞同：3
> 
> 时间：2012-06-08T14:04:58.993
> 
> 标签：mysql

我想找到用户可以使用插入查询进入 mysql 表的最大数据数？

它取决于`max_allowed_packet`？

如果是，我们可以更新它吗？设置它的最大值是多少？

如果不是，它是否取决于mysql的其他一些常量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:09:48.200

是的，确实如此，`INSERT`查询应该适合一个数据包。

从[文档](http://dev.mysql.com/doc/refman//5.5/en/server-system-variables.html#sysvar_max_allowed_packet)：

> 的协议限制`max_allowed_packet`是`1GB`。该值应该是 ; 的倍数`1024`。非倍数向下舍入到最接近的倍数。

要设置它，请使用：

```
SET GLOBAL max_allowed_packet=1073741824; 
```

# c# - Linq 到实体 Skip() 和 Take()

> ID：10950388
> 
> 赞同：9
> 
> 时间：2012-06-08T14:05:17.813
> 
> 标签：c#, asp.net, linq, entity-framework, linq-to-entities

我正在开发一个 ASP.NET 应用程序，我正在创建一个 LINQ 查询，它将从 db 中选择分页记录。在用户界面上，我有一个列表框，用户可以在其中选择多个选项。我想知道：

*   如何增加 Skip()、Take() 参数以查看下一个结果？

*   如何使用“IN”关键字，以便如果用户从列表框中选择多个选项，查询可以检查所有值？

我的查询如下所示：

```
var searchResults = context.data_vault.Where(d => d.STATE == lstStates.SelectedItem.Text).OrderBy(d= > d.dv_id).Take(10).Skip(2);    
GridView1.DataSource = searchResults;
GridView1.DataBind(); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-08T14:13:46.143

我认为您使用 Skip 不正确。它应该在Take之前。

跳过会跳过许多记录，因此对于您的第一页，传入 0，否则传入 (页码 - 1) * 每页记录。

我通常会这样做：

```
int Page = 1;
int RecordsPerPage = 10;
var q = yourQuery.Skip((Page - 1) * RecordsPerPage).Take(RecordsPerPage); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-08T14:09:05.593

您需要先在 GridView 上打开分页。然后在`PageIndexChanging`事件：

```
var result = db.Where(...)
               .Skip(e.NewPageIndex * grid.PageSize)
               .Take(grid.PageSize)
               .ToList(); // this is very important part too 
```

模拟`IN`行为：

```
var selection = list.SelectedItems.Select(i => i.Text).ToArray();
var result = db.Where(x => selection.Contains(x.Prop)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:17:02.620

尝试这个：

```
 int temp = (CurrentPageNumber - 1) * 10;
    var searchResults = context.data_vault.Where(d => d.STATE == lstStates.SelectedItem.Text).OrderBy(d= > d.dv_id).Skip(temp).Take(10); 
```

# php - PHP fsockopen() cookie

> ID：10950389
> 
> 赞同：2
> 
> 时间：2012-06-08T14:05:18.937
> 
> 标签：php, cookies, fsockopen

我正在尝试创建一个“远程登录”站点，但是当我尝试下面的代码时，我得到了关于 cookie 被禁用的错误，我已经用谷歌搜索了一个解决方案，但唯一解决的案例是 cURL 这样做的方式（ cookie jar），我该如何解决 cookie 问题？我怎样才能找到网站需要的 cookie（大约有 10 个）？

```
<?php
$vars = array(
    'email' => "*****",
    'pass'=>"*****"
    );
$content = http_build_query($vars);

$host = 'www.site.com';
$service_uri = '/login.php';
$vars ='login_mode=1';

$header = "Host: $host\r\n";
$header .= "User-Agent: PHP Script\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Referer: http://www.site.com \r\n";
$header .= "Content-Length: ".strlen($content)."\r\n";
$header .= "Connection: close\r\n\r\n";

$fp = fsockopen("".$host,80, $errno, $errstr);

if (!$fp)
{
    echo "$errstr ($errno)<br/>\n";
    echo $fp;
}
else
{
    fputs($fp, "POST $service_uri  HTTP/1.1\r\n");
    fputs($fp, $header.$content);

    while(!feof($fp))
    {
        echo fgets($fp, 128);
    }
    fclose($fp);
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:15:53.270

您首先必须请求主页 URL，它将为您提供 cookie 标头。`$header`通过将它们添加到您的变量来解析它们并将它们发送到服务器。

您不想关心站点需要哪个 cookie - 只需发送所有这些 cookie，这使其面向未来。

如果你不想自己做这一切，看看 PEAR 的[HTTP_Request2](http://pear.php.net/package/HTTP_Request2)包——它内置了 cookie 处理。

# c++ - 将字符打印为整数

> ID：10950390
> 
> 赞同：8
> 
> 时间：2012-06-08T14:05:24.853
> 
> 标签：c++, formatting, ostream, interpretation

我想控制我的s 和's`ostream`输出是否将它们写为*字符*或*整数*。我在标准库中找不到这样的选项。现在我已经恢复到在一组替代打印函数上使用多个重载`char``unsigned char``<<`

 **```
ostream& show(ostream& os, char s) { return os << static_cast<int>(s); }
ostream& show(ostream& os, unsigned char s) { return os << static_cast<int>(s); } 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:42:59.043

不，没有更好的方法。更好的方法是采用自定义流操纵器的形式，例如`std::hex`. 然后，您可以关闭和打开整数打印，而无需为每个数字指定它。但是自定义操纵器对流本身进行操作，并且没有任何[格式标志](http://en.cppreference.com/w/cpp/io/ios_base/fmtflags)可以执行您想要的操作。我想你可以编写自己的流，但这比你现在做的工作要多。

老实说，您最好的选择是查看您的文本编辑器是否具有使`static_cast<int>`键入更容易的功能。我假设你会输入很多，否则你不会问。这样，阅读您的代码的人就可以准确地知道您的意思（即，将 char 打印为整数），而无需查找自定义函数的定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-14T15:26:10.277

只是对旧帖子的更新。实际的技巧是使用“+”。例如：

```
template <typename T>
void my_super_function(T x)
{
  // ...
  std::cout << +x << '\n';  // promotes x to a type printable as a number, regardless of type
  // ...
} 
```

在 C++11 中，你可以这样做：

```
template <typename T>
auto promote_to_printable_integer_type(T i) -> decltype(+i)
{
  return +i;
} 
```

信用：[如何将字符打印为数字？如何打印 char* 以便输出显示指针的数值？](https://isocpp.org/wiki/faq/input-output#print-char-or-ptr-as-number)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:28:42.763

我有一个基于[如何使用 ostream 在 c++ 中将无符号字符打印为十六进制的技术的建议？](https://stackoverflow.com/questions/673240/how-do-i-print-an-unsigned-char-as-hex-in-c-using-ostream?rq=1).

```
template <typename Char>
struct Formatter
  {
  Char c;
  Formatter(Char _c) : c(_c) { }

  bool PrintAsNumber() const
    {
    // implement your condition here
    }
  };

template <typename Char> 
std::ostream& operator<<(std::ostream& o, const Formatter<Char>& _fmt)
  {
  if (_fmt.PrintAsNumber())
    return (o << static_cast<int>(_fmt.c));
  else
    return (o << _fmt.c);
  }

template <typename Char> 
Formatter<Char> fmt(Char _c)
  {
  return Formatter<Char>(_c);
  }

void Test()
  {
  char a = 66;
  std::cout << fmt(a) << std::endl;
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-16T16:24:24.113

在 C++20 中，您将能够使用它[`std::format`](https://en.cppreference.com/w/cpp/utility/format)来执行此操作：

```
unsigned char uc = 42;
std::cout << std::format("{:d}", uc); // format uc as integer 42 (the default)
std::cout << std::format("{:c}", uc); // format uc as char '*' (assuming ASCII) 
```

同时你可以使用[基于的 {fmt}](https://github.com/fmtlib/fmt)库`std::format`。

**免责声明**：我是 {fmt} 和 C++20 的作者`std::format`。**

# asp.net - 从表中删除记录时的前置或后置检查

> ID：10950403
> 
> 赞同：1
> 
> 时间：2012-06-08T14:06:11.733
> 
> 标签：asp.net, sql, sql-server

对于经常删除记录的 Web 应用程序，如果我们考虑性能，什么是最好的？

*   检查记录是否与其他表有任何关系，并防止用户删除。

    例如：查询将是这样的

    ```
     if not exist(select * from table1 where tableX_id = @id) and 
           not exist(select * from table2 where tableX_id = @id)
           ...
        then 
           delete from tableX where id = @id 
    ```

    或者

*   执行`delete`并让 RDBMS 由于`foriegn key`约束引发错误

    ```
     try{
           Service.DeleteRecord(id)
      }catch{
           Handle the error here
      } 
    ```

    在这种情况下，查询将很简单

    ```
     delete from TableX where id = @id 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:11:13.367

我会使用数据库触发器（或 ON CASCADE DELETE）来处理任何关系——可用的工具将取决于您的 RDBMS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T14:20:37.037

如果目标是仅在实际运行删除会产生错误的情况下防止行被删除，因为它被其他表引用，那么我建议您在让 SQL Server 为您检查之前检查违规行为。[我已经对此进行了一些测试](http://www.mssqltips.com/sqlservertip/2632/checking-for-potential-constraint-violations-before-entering-sql-server-try-and-catch-logic/?utm_source=AaronBertrand)，让 SQL 捕获错误或仅使用 TRY/CATCH 可能会更昂贵，如果您预计即使是中等数量的失败也是如此。有了适当的索引，执行检查的额外成本可以忽略不计；但是，不进行检查的成本肯定可以忽略不计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:09:38.713

显然，执行删除并让 RDBMS 处理业务。通过自己实施检查，您将招致 RDBMS 无论如何都会执行的额外操作。

# python - 最快搜索随机嵌套数据

> ID：10950408
> 
> 赞同：1
> 
> 时间：2012-06-08T14:06:28.403
> 
> 标签：python, algorithm

```
[
   [
      [2,33,64,276,1],
      [234,5,234,7,34,36,7,2],
      []
   ]
   [
      [2,4,5]
   ]
   .
   .
   .
   etc
] 
```

我不是在寻找一个确切的解决方案，因为上面的结构只是一个例子。我正在尝试在一组随机排序的 ID 中搜索可以嵌套多个级别的 ID。

目前我只是在做一个线性搜索，当每个最深的级别都有几百个 ID 时，需要几分钟才能得到结果。我想知道是否有人可以建议一种更快的算法来搜索多个级别的随机数据？如果这很重要，我会在 Python 中执行此操作。

注意：ID 始终处于最深级别，并且每个分支向下的级别数是一致的。不确定这是否重要。

还要澄清数据点是唯一的，不能重复。我的例子有一些重复，因为我只是砸键盘。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:19:03.170

对随机数据的最快搜索是线性的。假装您的数据不是嵌套的，它仍然是随机的，因此即使将其展平也无济于事。

为了降低时间复杂度，您可以增加空间复杂度——保留一个包含 ID 作为键的字典以及您想要的任何信息（可能是指向包含每个级别的 ID 的列表的索引列表），并在每次更新时更新它创建/更新/删除一个元素。

# django - 抑制 django 的 login_required 装饰器中的“?next=blah”行为

> ID：10950409
> 
> 赞同：19
> 
> 时间：2012-06-08T14:06:30.920
> 
> 标签：django, django-authentication

我喜欢 django 的 @login_required 装饰器，但有一件事我不知道怎么做。

如果未经身份验证的用户尝试访问@login_required 页面（例如“/private-stuff/”），我想将他们踢回主页（例如“/home/”）。但我不想在 url 上附加一个 "?next=" 参数。换句话说，我只想重定向到“/home/”，而不是“/home/?next=/private-stuff/”。

我怎样才能做到这一点？有没有比编写自己的装饰器更好的方法？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-06T22:35:20.523

不就是这么简单：

```
@decorators.login_required(redirect_field_name=None) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-08T14:50:25.180

嗯，我能想到两种方法。首先，将是“正确”的方式，从某种意义上说，您不会破坏任何功能，只会添加新功能：创建自己的`login_required`装饰器。但问题是 Django*确实*隐藏了登录后重定向功能，并且它需要很多部分。[`login_required`装饰器](https://github.com/django/django/blob/master/django/contrib/auth/decorators.py)实际上只是装饰器的包装器，而[`user_passes_test`装饰器](https://github.com/django/django/blob/master/django/contrib/auth/decorators.py)又调用了[`redirect_to_login`视图](https://github.com/django/django/blob/master/django/contrib/auth/views.py)，正是*该*视图将`next`参数添加到查询字符串中。在您的自定义装饰器中，您可以将所有或部分功能直接滚动到装饰器中，但您需要引用所有三个以获取必要的代码。

另一个更简单的选择是创建一些中间件来删除查询字符串（如果已设置）：

```
from django.conf import settings
from django.http import HttpResponseRedirect

class RemoveNextMiddleware(object):
    def process_request(self, request):
        if request.path == settings.LOGIN_URL and request.GET.has_key('next'):
            return HttpResponseRedirect(settings.LOGIN_URL) 
```

然后，将该中间件的导入路径添加到`MIDDLEWARE_CLASSES`. 请记住，在请求阶段，中间件是先到最后或自上而下处理的，换句话说。这应该在请求阶段相对较早地出现，但您可能需要使用它来看看在它之前什么可以和不可以。

这种方法唯一真正的问题是它“破坏”了下一个重定向功能，而且不是以一种非常直观的方式，如果后来的开发人员继承了您的代码库以及允许重定向的授权，它可能有点令人困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-01T16:29:57.657

```
login(request, user)
if request.POST['next']:
    return redirect(request.POST['next'])
else:
    msg = u"Welcome..."
    return render_to_response('members/welcome.html', {'msg':msg},
                                              context_instance=RequestContext(request)) 
```

# git - Git的差异输出中的“@@ -1 +1 @@”是什么意思？

> ID：10950412
> 
> 赞同：122
> 
> 时间：2012-06-08T14:06:42.833
> 
> 标签：git, diff

我一直在从返回的信息中收集数据

```
git diff <commitId>..<commitId> 
```

我遇到了`@@ -1 +1 @@`

我不知道那在告诉我什么。我在谷歌上搜索了一下，但无济于事。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2015-07-24T16:44:01.443

**简单的例子分析**

格式与`diff -u`统一差异基本相同。

例如：

```
diff -u <(seq -w 16) <(seq -w 16 | grep -Ev '^(02|03|14|15)$') 
```

在这里，我们删除了第 2、3、14 和 15 行。输出：

```
@@ -1,6 +1,4 @@
 01
-02
-03
 04
 05
 06
@@ -11,6 +9,4 @@
 11
 12
 13
-14
-15
 16 
```

`@@ -1,6 +1,4 @@`方法：

*   `-1,6`表示第一个文件的这一段从第 1 行开始，共显示 6 行。因此它显示了第 1 到第 6 行。

    ```
    1
    2
    3
    4
    5
    6 
    ```

    `-`表示“旧”，因为我们通常将其称为`diff -u old new`.

*   `+1,4`表示第二个文件的这一段从第 1 行开始，总共显示 4 行。因此它显示了第 1 到第 4 行。

    `+`意思是“新”。

    我们只有 4 行而不是 6 行，因为删除了 2 行！新帅只是：

    ```
    01
    04
    05
    06 
    ```

`@@ -11,6 +9,4 @@`因为第二个大块是类似的：

*   在旧文件中，我们有 6 行，从旧文件的第 11 行开始：

    ```
    11
    12
    13
    14
    15
    16 
    ```

*   在新文件上，我们有 4 行，从新文件的第 9 行开始：

    ```
    11
    12
    13
    16 
    ```

    请注意，该行`11`是新文件的第 9 行，因为我们已经删除了前一个大块上的 2 行：2 和 3。

**大块头**

根据您的 git 版本和配置，您还可以获得该行旁边的代码行`@@`，例如`func1() {`：

```
@@ -4,7 +4,6 @@ func1() { 
```

这也可以通过`-p`plain 标志获得`diff`。

示例：旧文件：

```
func1() {
    1;
    2;
    3;
    4;
    5;
    6;
    7;
    8;
    9;
} 
```

如果我们删除 line `6`，差异显示：

```
@@ -4,7 +4,6 @@ func1() {
     3;
     4;
     5;
-    6;
     7;
     8;
     9; 
```

请注意，这不是正确的行`func1`：它跳过了行`1`和`2`。

这个很棒的功能通常可以准确地告诉每个块属于哪个函数或类，这对于解释差异非常有用。

选择标头的算法如何准确地在以下位置讨论：[git diff hunk 标头中的摘录来自哪里？](https://stackoverflow.com/questions/28111035/where-does-the-excerpt-in-the-git-diff-hunk-header-come-from)

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-06-08T14:11:04.537

这是一个统一的差异大块标识符。这由 GNU Diffutils[记录。](http://www.gnu.org/software/diffutils/manual/diffutils.html#Detailed-Unified)

> 统一的输出格式以两行标题开头，如下所示：
> 
> ```
> ---*从文件从文件修改时间*
> +++*到文件到文件修改时间*
> 
> ```
> 
> 时间戳看起来像是`2002-02-21 23:30:39.942229878 -0800`用小数秒表示日期、时间和时区。在不支持小数时间戳的主机上省略小数秒。
> 
> 您可以使用选项更改标题的内容`--label=label`；请参阅[替代名称](http://www.gnu.org/software/diffutils/manual/diffutils.html#Alternate-Names)。
> 
> 接下来是一大堆差异；每个大块显示文件不同的一个区域。统一格式大块看起来像这样：
> 
> ```
> @@ *from-file-line-numbers to-file-line-numbers* @@
>   *line-from-either-file* 
>  *line-from-either-file* ...
> 
> ```
> 
> 如果一个大块只包含一行，则只显示其起始行号。否则它的行号看起来像. 一个空的大块被认为是从大块后面的行开始的。`*start*,*count*`
> 
> 如果一个大块及其上下文包含两行或多行，它的行号看起来像. 否则只显示其结束行号。空大块被认为在大块之前的行处结束。`*start*,*count*`
> 
> 两个文件共有的行都以空格字符开头。两个文件之间实际不同的行在左侧打印列中具有以下指示符之一：
> 
> *   **+**
>     在第一个文件中添加了一行。
> *   **-**
>     从第一个文件中删除了一行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-08T14:10:05.893

这是当前大块范围信息，说明此差异大块开始和结束的行号。

阅读[**http://en.wikipedia.org/wiki/Diff#Unified_format**](http://en.wikipedia.org/wiki/Diff#Unified_format)以获得深入的解释。

# jquery-ui - 使用 jQuery ui 对话框显示时，表单值第二次不可见

> ID：10950416
> 
> 赞同：0
> 
> 时间：2012-06-08T14:06:57.750
> 
> 标签：jquery-ui

我在 jquery 对话框中显示一些表单数据。当我第一次这样做时，一切正常。我可以在对话框中看到“我的价值”字符串。如果我第二次再次重新打开对话框，表单值将不再可见。查看这个[jsfiddle](http://jsfiddle.net/jUtVv/1/)自己尝试一下。这是代码：

```
var dialog;

$("#b1").click(function(){
dialog = $("<div></div>").html("<p><input id='input1' type='text'></p>").dialog({
    autoOpen:false,
});
$("#input1").val("my value");
dialog.dialog("open");
}); 
```

此错误仅在我动态添加 html 标记时发生。如果我使用静态 html 块，一切正常。知道这里有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:46:03.547

那是因为你不是在摧毁旧的

```
<input id='input1' type='text'> 
```

所以当你打电话时

```
$("#input1").val("my value"); 
```

它设置了 first 的值

```
<input id='input1' type='text'> 
```

它在 DOM 中找到。

# visual-c++ - 当我从我的 c++ dll 向 c# 获取响应时，char 指针参数值没有得到更新

> ID：10950419
> 
> 赞同：2
> 
> 时间：2012-06-08T14:07:03.743
> 
> 标签：visual-c++, c#-4.0, dllimport

我在 c# 中导入了一个 c++ 本机 dll 方法。下面是 C++ 方法的外观

```
extern "C" declspec(dllexport) int __stdcall temp(char *value)
{
  value="hksdhfs";
  return 1;
} 
```

这就是我在 c# 中导入的方式

```
[DllImport("check.dll", CallingConvention = CallingConvention.StdCall, ExactSpelling = true, EntryPoint = "temp")]
    public static extern int temp(string value); 
```

问题是我能够通过“value”char 指针将数据发送到 c++ dll，但是当我在 c# 中获取“value”char 指针时，该值没有被更改。任何人都可以帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:42:45.653

由于参数在这种情况下不起作用，所以我更改了 c++ dll 方法的返回类型，如下所示，并以书面格式获取字符串

```
extern "C" declspec(dllexport) char* __stdcall temp(char *value)
{
  value="hksdhfs";
  return value;
} 
```

dll导入是这样的

```
[DllImport("check.dll", CallingConvention = CallingConvention.StdCall, ExactSpelling = true, EntryPoint = "temp")]
[return:MarshalAs(UnmanagedType.LPStr)]
public static extern string temp(string value); 
```

做 strcpy() 也可以，但如果我使用类，这个指针字符值将被传递，它不会工作，所以我更喜欢上面的方式，并且有效......谢谢大家。

# c# - WPF bing 地图控制折线/多边形在第一次添加到集合时不绘制

> ID：10950421
> 
> 赞同：14
> 
> 时间：2012-06-08T14:07:06.487
> 
> 标签：c#, wpf, xaml, bing-maps, polyline

我正在处理这个表面项目，我们有一个 bing 地图控件，并且我们希望通过使用数据绑定在地图上绘制折线。

发生的奇怪行为是，当我单击“添加”按钮时，地图上什么也没有发生。如果我稍微移动地图，多段线就会绘制在地图上。另一种可行的方案是单击一次添加按钮，没有任何反应，再次单击它，两条折线都被绘制了。（在我的手动收藏中，我有 4 个 LocationCollections）所以第三次点击和第四次点击再次绘制两条线时也会发生同样的情况。

我完全不知道该去哪里解决这个问题。我已经尝试订阅 Layoutupdated 事件，这两种情况都会发生。还向 observablecollection 添加了一个 collectionchanged 事件，以查看添加是否被触发，是的，它被触发。我尝试的另一件事是将折线更改为图钉，并从 pipelineviewmodel 中的位置集合中获取第一个位置，而不是预期的。

如果你想看看自己发生了什么，我已经上传了一个[示例项目。](http://playingwith.net/beta/SurfaceApplication3.zip)

真的希望有人能指出我正确的方向，因为我不再有任何线索了。

您可以在下面找到我编写的代码：

我有以下视图模型：

**主视图模型**

```
public class MainViewModel
{
    private ObservableCollection<PipelineViewModel> _pipelines;

    public ObservableCollection<PipelineViewModel> Pipes
    {
        get { return _pipelines; }
    }

    public MainViewModel()
    {
        _pipelines = new ObservableCollection<PipelineViewModel>();
    }
} 
```

以及具有实现 INotifyPropertyChanged 的​​位置集合的 PipelineViewModel：

**管道视图模型**

```
public class PipelineViewModel : ViewModelBase
{
    private LocationCollection _locations;

    public string Geometry { get; set; }
    public string Label { get; set; }
    public LocationCollection Locations
    {
        get { return _locations; }
        set
        {
            _locations = value;
            RaisePropertyChanged("Locations");
        }
    }
} 
```

我的 XAML 如下所示：

```
<s:SurfaceWindow x:Class="SurfaceApplication3.SurfaceWindow1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:s="http://schemas.microsoft.com/surface/2008"
    xmlns:m="clr-namespace:Microsoft.Maps.MapControl.WPF;assembly=Microsoft.Maps.MapControl.WPF" 
    Title="SurfaceApplication3">
    <s:SurfaceWindow.Resources>
        <DataTemplate x:Key="Poly">
            <m:MapPolyline Locations="{Binding Locations}" Stroke="Black" StrokeThickness="5" />
        </DataTemplate>
    </s:SurfaceWindow.Resources>
  <Grid>
        <m:Map ZoomLevel="8" Center="52.332074,5.542302" Name="Map">
            <m:MapItemsControl Name="x" ItemsSource="{Binding Pipes}" ItemTemplate="{StaticResource Poly}" />
        </m:Map>
        <Button Name="add" Width="100" Height="50" Content="Add" Click="add_Click"></Button>
    </Grid>
</s:SurfaceWindow> 
```

在我们的代码隐藏中，我们正在设置绑定和点击事件，如下所示：

```
private int _counter = 0;
private string[] geoLines;

private MainViewModel _mainViewModel = new MainViewModel();

/// <summary>
/// Default constructor.
/// </summary>
public SurfaceWindow1()
{
    InitializeComponent();

    // Add handlers for window availability events
    AddWindowAvailabilityHandlers();

    this.DataContext = _mainViewModel;

    geoLines = new string[4]{ "52.588032,5.979309; 52.491143,6.020508; 52.397391,5.929871; 52.269838,5.957336; 52.224435,5.696411; 52.071065,5.740356",
                                "52.539614,4.902649; 52.429222,4.801025; 52.308479,4.86145; 52.246301,4.669189; 52.217704,4.836731; 52.313516,5.048218",
                                "51.840869,4.394531; 51.8731,4.866943; 51.99841,5.122375; 52.178985,5.438232; 51.8731,5.701904; 52.071065,6.421509",
                                "51.633362,4.111633; 51.923943,6.193542; 52.561325,5.28717; 52.561325,6.25946; 51.524125,5.427246; 51.937492,5.28717" };
}

private void add_Click(object sender, RoutedEventArgs e)
{
    PipelineViewModel plv = new PipelineViewModel();
    plv.Locations = AddLinestring(geoLines[_counter]);
    plv.Geometry = geoLines[_counter];

    _mainViewModel.Pipes.Add(plv);

    _counter++;
}

private LocationCollection AddLinestring(string shapegeo)
{
    LocationCollection shapeCollection = new LocationCollection();

    string[] lines = Regex.Split(shapegeo, ";");
    foreach (string line in lines)
    {
        string[] pts = Regex.Split(line, ",");

        double lon = double.Parse(pts[1], new CultureInfo("en-GB"));
        double lat = double.Parse(pts[0], new CultureInfo("en-GB"));
        shapeCollection.Add(new Location(lat, lon));
    }

    return shapeCollection;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-17T10:06:06.680

我对这个问题做了一些挖掘，发现实现中有一个错误`Map`。我还为它做了一个解决方法，可以像这样使用

```
<m:Map ...>
    <m:MapItemsControl Name="x"
                       behaviors:MapFixBehavior.FixUpdate="True"/>
</m:Map> 
```

我将此修复程序包含在您的示例应用程序中并在此处上传：[SurfaceApplication3.zip](https://www.dropbox.com/s/50pbkyo1qsnl8zp/SurfaceApplication3.zip?dl=0)

* * *

每个的视觉树`ContentPresenter`看起来像这样

![在此处输入图像描述](../Images/c3fbab0f5be48aae28a05102b93b7dc4.png)

当您将新项目添加到集合中时，最初`Polygon`会出错。`Points`而不是像它这样的值`59, 29`，而是像`0.0009, 0.00044`.

点在`MeasureOverride`in中计算，进行计算`MapShapeBase`的部分如下所示

```
MapMath.TryLocationToViewportPoint(ref this._NormalizedMercatorToViewport, location, out point2); 
```

最初，`_NormalizedMercatorToViewport`将有其默认值*（一切都设置为 0）*，因此计算完全错误。在从in调用`_NormalizedMercatorToViewport`的方法中设置。`SetView``MeasureOverride``MapLayer`

`MeasureOverride`in`MapLayer`有以下两个 if 语句。

```
if ((element is ContentPresenter) && (VisualTreeHelper.GetChildrenCount(element) > 0))
{
    child.SetView(...)
} 
```

这是`false`因为`ContentPresenter`还没有视觉孩子，它仍在生成中。**这就是问题所在**。

第二个看起来像这样

```
IProjectable projectable2 = element as IProjectable;
if (projectable2 != null)
{
    projectable2.SetView(...);
} 
```

这`false`也是因为元素 a`ContentPresenter`没有实现`IProjectable`. 这是由孩子实现的，`MapShapeBase`而且这个孩子还没有生成。

因此，`SetView`永远不会被调用，并且`_NormalizedMercatorToViewport`in`MapShapeBase`将具有其默认值，并且在您第一次添加新项目时计算会出错。

* * *

**解决方法**

要解决此问题，我们需要强制重新测量`MapLayer`. 这必须在新`ContentPresenter`添加到时`MapItemsControl`但在`ContentPresenter`具有视觉孩子之后完成。

强制更新的一种方法是创建一个具有 metadata-flags 的附加属性`AffectsRender`，`AffectsArrange`并将`AffectsMeasure`其设置为 true。然后，我们只需在每次想要进行更新时更改此属性的值。

这是执行此操作的附加行为。像这样使用它

```
<m:Map ...>
    <m:MapItemsControl Name="x"
                       behaviors:MapFixBehavior.FixUpdate="True"/>
</m:Map> 
```

*MapFixBehavior*

```
public class MapFixBehavior
{
    public static DependencyProperty FixUpdateProperty =
        DependencyProperty.RegisterAttached("FixUpdate",
                                            typeof(bool),
                                            typeof(MapFixBehavior),
                                            new FrameworkPropertyMetadata(false,
                                                                          OnFixUpdateChanged));

    public static bool GetFixUpdate(DependencyObject mapItemsControl)
    {
        return (bool)mapItemsControl.GetValue(FixUpdateProperty);
    }
    public static void SetFixUpdate(DependencyObject mapItemsControl, bool value)
    {
        mapItemsControl.SetValue(FixUpdateProperty, value);
    }

    private static void OnFixUpdateChanged(DependencyObject target, DependencyPropertyChangedEventArgs e)
    {
        MapItemsControl mapItemsControl = target as MapItemsControl;
        ItemsChangedEventHandler itemsChangedEventHandler = null;
        itemsChangedEventHandler = (object sender, ItemsChangedEventArgs ea) =>
        {
            if (ea.Action == NotifyCollectionChangedAction.Add)
            {
                EventHandler statusChanged = null;
                statusChanged = new EventHandler(delegate
                {
                    if (mapItemsControl.ItemContainerGenerator.Status == GeneratorStatus.ContainersGenerated)
                    {
                        mapItemsControl.ItemContainerGenerator.StatusChanged -= statusChanged;
                        int index = ea.Position.Index + ea.Position.Offset;
                        ContentPresenter contentPresenter =
                            mapItemsControl.ItemContainerGenerator.ContainerFromIndex(index) as ContentPresenter;
                        if (VisualTreeHelper.GetChildrenCount(contentPresenter) == 1)
                        {
                            MapLayer mapLayer = GetVisualParent<MapLayer>(mapItemsControl);
                            mapLayer.ForceMeasure();
                        }
                        else
                        {
                            EventHandler layoutUpdated = null;
                            layoutUpdated = new EventHandler(delegate
                            {
                                if (VisualTreeHelper.GetChildrenCount(contentPresenter) == 1)
                                {
                                    contentPresenter.LayoutUpdated -= layoutUpdated;
                                    MapLayer mapLayer = GetVisualParent<MapLayer>(mapItemsControl);
                                    mapLayer.ForceMeasure();
                                }
                            });
                            contentPresenter.LayoutUpdated += layoutUpdated;
                        }
                    }
                });
                mapItemsControl.ItemContainerGenerator.StatusChanged += statusChanged;
            }
        };
        mapItemsControl.ItemContainerGenerator.ItemsChanged += itemsChangedEventHandler;
    }

    private static T GetVisualParent<T>(object childObject) where T : Visual
    {
        DependencyObject child = childObject as DependencyObject;
        while ((child != null) && !(child is T))
        {
            child = VisualTreeHelper.GetParent(child);
        }
        return child as T;
    }
} 
```

*MapLayerExtensions*

```
public static class MapLayerExtensions
{
    private static DependencyProperty ForceMeasureProperty =
        DependencyProperty.RegisterAttached("ForceMeasure",
                                            typeof(int),
                                            typeof(MapLayerExtensions),
                                            new FrameworkPropertyMetadata(0,
                                                FrameworkPropertyMetadataOptions.AffectsRender |
                                                FrameworkPropertyMetadataOptions.AffectsArrange |
                                                FrameworkPropertyMetadataOptions.AffectsMeasure));

    private static int GetForceMeasure(DependencyObject mapLayer)
    {
        return (int)mapLayer.GetValue(ForceMeasureProperty);
    }
    private static void SetForceMeasure(DependencyObject mapLayer, int value)
    {
        mapLayer.SetValue(ForceMeasureProperty, value);
    }

    public static void ForceMeasure(this MapLayer mapLayer)
    {
        SetForceMeasure(mapLayer, GetForceMeasure(mapLayer) + 1);
    }
} 
```

# android - 从清单中注册的广播接收器更新 UI

> ID：10950423
> 
> 赞同：0
> 
> 时间：2012-06-08T14:07:07.173
> 
> 标签：android, broadcastreceiver, alarmmanager

我有这个问题，我正在清单中为 AlarmManager 注册我的广播接收器。我正在通过挂起的 Intent 在我的活动中安排它。

```
 AlarmManager alarmMgr = (AlarmManager) this.getSystemService(Context.ALARM_SERVICE);
    PendingIntent pendingIntent =PendingIntent.getBroadcast(this, 0, new Intent(this, AlarmReciever.class),PendingIntent.FLAG_CANCEL_CURRENT);
    alarmMgr.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, Constants.ALARM_TRIGGER_AT_TIME,Constants.ALARM_INTERVAL, pendingIntent); 
```

但是在我的接收器类中，我正在使用 AlarmManager 进行一些网络更新......我将其保存在数据库中。我在活动中有一个 ListAdapter，需要 notifydatasetChanged...为此我需要一个活动实例。

如何得到它？基本上我想至少在我的应用程序可见时更新我的​​ UI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:54:03.457

在您的活动中创建一个`BroadcastReceiver`，在您的活动中注册并在其中`onResume`取消注册`onPause`。完成网络更新后，创建一个`Intent`，放入您要发送到活动的所有数据并触发它。如果您的活动在前台那么只有它会收到这个意图`onReceive()`。`BroadcaseReceiver`从你的活动中你可以获取所有数据，然后更新 Ui。

在您的活动中创建一个`BroadcastReceiver`::

```
 private class MyReceiver extends BroadcastReceiver
{
        @Override
        public void onReceive(Context context, Intent intent) {

             /////// update your UI from here ////////     
            }

} 
```

在里面`onCreate()`，创建这个接收器的一个实例::

```
myReceiver=new MyReceiver(); 
```

`OnResume()`从:: 注册此接收器

```
 IntentFilter filter=new IntentFilter();
    filter.setPriority(1);
    filter.addAction( "MyPackageName.MyAction" );
    registerReceiver(myReceiver, filter); 
```

在`onPause()`:: 中取消注册

```
unregisterReceiver( myReceiver ); 
```

现在，在完成网络更新后触发一个意图，触发一个启动此接收器的意图::

```
 Intent broadcastIntent=new Intent();
            broadcastIntent.setAction( "MyPackageName.MyAction" );
            broadcastIntent.putExtra();// put data to send to your activity
            sendBroadcast( broadcastIntent ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T12:44:42.390

我得到了答案..为了刷新我可见的活动

```
 Intent i=new Intent(caller,Dot.class);
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
        i.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
        caller.startActivity(i); 
```

如果活动可见，它将在您的代码中调用 OnNewIntent()，从而调用 onResume()，您可以在其中更新您的 UI ..

# c++ - HEAP_NO_SERIALIZE 堆中的多线程访问

> ID：10950424
> 
> 赞同：2
> 
> 时间：2012-06-08T14:07:10.920
> 
> 标签：c++, windbg, pageheap

我们的应用程序因以下错误而崩溃。

```
===========================================================
VERIFIER STOP 00000003: pid 0x2E54: multithreaded access in HEAP_NO_SERIALIZE heap
       00161000 : Heap handle
       00001444 : Thread owning heap lock
       00003188 : Current thread trying to acquire the heap lock
       00000000 :
=========================================================== 
```

我们为应用程序启用了整页堆。应用程序在随机位置崩溃。通常崩溃位置是[STL](http://en.wikipedia.org/wiki/Standard_Template_Library)的内部部分。在所有情况下，调用堆栈似乎都已损坏。

该应用程序使用库和 DLL 文件列表。所有 DLL 文件和库都是使用多线程 DLL 库（命令行选项`/MD`）构建的。

其中一个库使用[HeapAlloc](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366597%28v=vs.85%29.aspx)方法在堆中分配内存。

我应该使用什么技术来识别崩溃？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:11:59.027

通过在 WinDbg 下运行程序，您似乎已经完成了。

对错误消息中有趣的部分进行快速 Google 搜索，发现 MSDN 文章*[Multithreaded Access In A HEAP_NO_SERIALIZE Heap](http://msdn.microsoft.com/en-us/library/ms220925%28v=vs.80%29.aspx)*，这表明您正在加载的某些模块与单线程 CRT 相关联。

我会检查您项目的每个部分，以及所有项目设置，非常仔细地验证所有内容是否**真的**在使用 MD 库。某些东西可能是静态链接的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:13:00.013

[使用WinDbg](http://en.wikipedia.org/wiki/WinDbg)附加，修复您的符号：

```
.symfix;reload; 
```

运行自动崩溃分析：

```
!analyze -v 
```

您可以检查所有线程的调用堆栈：

```
~* kb; 
```

[您可以使用Dependency Walker](http://en.wikipedia.org/wiki/Dependency_Walker)检查您的模块的依赖关系，看看是否有任何使用单线程 CRT，但我也会检查是否有像[John Dibling 建议](https://stackoverflow.com/questions/10950424/multi-threaded-access-in-heap-no-serialize-heap/10950515#10950515)的那样静态链接。

您可以在项目设置下进行检查：*Configuration Properties* -> *C/C++* -> *Code Generation* -> *Check Runtime Library*。它应该说“多线程 DLL (/MD)”。

# java - 使用 Java 对 URL 参数进行编码

> ID：10950425
> 
> 赞同：2
> 
> 时间：2012-06-08T14:07:11.327
> 
> 标签：java

我想在 JAVA 中编码部分 URL 参数

```
http://statebuild-dev.com/iit-title/size.xml?id=(102T OR 140T) 
```

到

```
http://statebuild-dev.com/iit-title/size.xml?id=(102%20OR%20140) 
```

尝试过使用 URI 进行编码，但它也进行了编码？这是我不想要的。在 URL 中，我想对 '=' 之后的部分进行编码

```
URI uri = new URI("http", 
    "statebuild-dev.com/iit-title", "/size.xml?id=(102 OR 140)", null);
//URL url = uri.toURL();
System.out.println(uri.toString());
System.out.println(url1); 
```

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:22:34.883

您想在添加到 url 之前使用 URLEncoder 对每个查询参数进行编码，例如：

```
String encodedValue = URLEncoder.encode("(102 OR 140)", "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:17:09.457

您使用了错误的构造函数。试试这个：

```
URI uri = new URI("http","statebuild-dev.com", "/iit-title/size.xml", "id=(102 OR 140)", null); 
```

也可以看看`java.net.URLEncoder`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:17:39.833

[这个答案](https://stackoverflow.com/questions/4571346/how-to-encode-url-to-avoid-special-characters-in-java?rq=1)很好地讨论了对 URI/URL 的各个部分进行编码。您走在正确的轨道上，但您的具体问题是 URI 的各个部分都错误。您需要使用包含权限、路径、查询和片段的多部分构造函数：

```
URI uri = new URI("http", "statebuild-dev.com", "/iit-title/size.xml", "id=(102 or 104)", null);
System.out.println(uri.toString());
System.out.println(uri.toASCIIString()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:17:14.983

[java.net.URI](http://java.sun.com/javase/6/docs/api/java/net/URI.html)类可以提供帮助；在您找到的 URL 文档中

> 请注意，URI 类在某些情况下会执行其组件字段的转义。管理 URL 编码和解码的推荐方法是使用 URI

检查这个[线程](https://stackoverflow.com/questions/724043/http-url-address-encoding-in-java)。

# postgresql - 在 OpenJPA 中使用 VARCHAR 或 TEXT 作为默认字符串映射

> ID：10950426
> 
> 赞同：7
> 
> 时间：2012-06-08T14:07:11.457
> 
> 标签：postgresql, jpa, openjpa

默认情况下，OpenJPA 的`postgres`字典会`VARCHAR(255)`为`String`没有指定长度的字段生成。是否可以将其设置为生成`VARCHAR`或`TEXT`代替所有此类字段，以便我不需要`@Column(columnDefinition = "TEXT")`到处重复？当然，如果明确给出长度，例如`@Column(length = 128)`，结果应该是`VARCHAR(128)`。就此而言，是否有任何其他 JPA 提供者允许这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T15:30:11.347

似乎 Hibernate 从 3.6: [6.5 开始支持这一点。键入注册表](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/types.html#types-registry)。由这个 JIRA 问题跟踪：[HHH-5138](https://hibernate.onjira.com/browse/HHH-5138)。

# .net - iOS和PC之间的非WiFi无线连接

> ID：10950431
> 
> 赞同：2
> 
> 时间：2012-06-08T14:07:28.260
> 
> 标签：.net, objective-c, ios, xamarin.ios, bluetooth-lowenergy

**设想**

我编写了一个 iPhone 应用程序，它需要与运行在 Windows 7 上的 .NET 应用程序进行通信并将图像传输到该应用程序。在正常情况下，它会使用 WCF 进行通信，但有时 LAN、Internet、TCP/IP 堆栈不可用到 .NET 应用程序。在那种情况下，iOS 应用程序能否与 .NET 应用程序进行无线通信？

**蓝牙**

我一直在研究的一种选择是蓝牙。问题是，除非您通过 MFi 程序，否则 iOS 仅允许蓝牙连接到支持*蓝牙低功耗*(BTLE) 配置文件的设备。作为一个 Bletooth 新手，我不确定 BTLE 在支持的功能方面真正意味着什么。更重要的是，大多数蓝牙笔记本电脑都支持 BTLE 吗？文件可以通过 BTLE 传输吗？

有关替代无线通信或 BTLE 查询的任何指针都将非常有帮助。

TIA

# ssh - 通过 Spring Integration SFTP 适配器发出命令

> ID：10950435
> 
> 赞同：1
> 
> 时间：2012-06-08T14:07:50.450
> 
> 标签：ssh, sftp, spring-integration

是否可以通过发出命令行指令与远程系统交互，例如运行一个脚本，该脚本使用 Spring SFTP 集成通过 SSH 返回一些输出？

或者，是否有用于 SSH 的 Spring Integration 适配器可用或正在进行中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T04:59:18.130

SFTP 出站网关支持有限的命令，如 ls,get,mget,rm 这里是链接：http://static.springsource.org/spring-integration/reference/html/sftp.html

# mysql - 了解此查询（COUNT 和子查询）

> ID：10950436
> 
> 赞同：1
> 
> 时间：2012-06-08T14:08:13.900
> 
> 标签：mysql, sql

我无法理解这个查询：

```
SELECT * 
  FROM `advertise` parent 
 WHERE 3  <= ( SELECT COUNT(username) 
                 FROM `advertise` 
                WHERE keyword = parent.keyword 
                  AND bid > parent.bid) 
   AND username = 'mike' 
```

此查询的作用是显示任何带有 username 的行`'mike'`；如果该行不在关键字的三个最高出价中。

这是有效的[sqlfiddle](http://sqlfiddle.com/#!2/42223/1)，但我不明白它是如何工作的。更具体地说，我不理解`3 <=`这个特定的查询。

如何`3 <=`确定该行不在三个出价最高的关键字中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:21:26.553

此查询的工作方式如下：

子查询

```
SELECT COUNT(username) FROM `advertise` WHERE keyword = parent.keyword AND bid > parent.bid 
```

查找对同一关键字具有更高出价的行数。然后我们指定我们正在寻找的出价不能在前三个出价中，因此我们要求从该查询中返回至少 3 个出价。这是我认为您的最终查询应如下所示：

```
SELECT * FROM `advertise` parent 
WHERE 3  <= ( SELECT COUNT(username) 
    FROM `advertise` 
    WHERE keyword = parent.keyword 
    AND bid > parent.bid) 
AND username = 'mike' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:21:25.640

如果稍微重新格式化它可以使它更易于阅读：

```
SELECT * FROM `advertise` parent 

WHERE (SELECT COUNT(username) 
   FROM `advertise` 
   WHERE keyword=parent.keyword 
   AND bid>parent.bid) >= 3 

AND username='mike' 
```

子查询针对从父查询返回的每一行进行评估，因此它将`X >= 3`为每一行执行。

# resources - Jenkins 中用于测试的资源管理外部节点

> ID：10950439
> 
> 赞同：3
> 
> 时间：2012-06-08T14:08:24.350
> 
> 标签：resources, jenkins, external, nodes, jenkins-plugins

我的问题是我的代码需要重新启动节点。我有许多需要在重新启动的节点上执行的长期运行的 Jenkins 测试作业。

我现有的解决方案是在 Jenkins 中使用相同的标签 (TestLable) 和每台机器 1 个执行程序定义多个“代理”机器。我将所有测试作业绑定到标签 (TestLable)。在测试执行脚本中，我检测到 Jenkins 机器（Jenkins env.NODE_NAME）并使用它来了解测试应该使用什么物理物理机器。

有人知道更好的解决方案吗？

以上方法可行，但我需要定义大量可能不需要的“节点/机器”。我想要的是一个能够将令牌授予 Jenkins 工作的插件。这样，在 Jenkins 执行者之前不会执行作业，并且令牌是免费的。令牌应该是一个字符串，以便我的测试作业可以使用它来了解它可以使用的外部节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-28T10:31:00.980

我们编写了自己的调度程序，在启动 Jenkins 节点之前分配东西。可能有更好的解决方案 - 但这主要适用于我们。我还没有遇到过可以处理不同硬件资源的复杂分配的现成调度程序。我们有 n 个盒子类型，分配给 n 个构建类型。

我们拥有的一些构建类型在不破坏所有持久数据的情况下是不兼容的——这可能是必需的，因为它需要很长时间才能收集。有些工作需要这些硬件类型的组合。我们将详细信息存储在数据库中，然后使用业务逻辑来确定如何分配。我们经常发现特定的工作类型需要额外的业务逻辑或额外的数据字段来满足他们的特定要求。

因此，最好的方法可能是使用您自己选择的语言编写您自己的调度程序，这会考虑到您的特定需求。

# javascript - 当页面保存在 DOM 中时，如何使用 on/off 正确取消绑定 Jquery-Mobile 中的事件？

> ID：10950443
> 
> 赞同：1
> 
> 时间：2012-06-08T14:08:45.770
> 
> 标签：javascript, jquery, events, jquery-mobile, unbind

由于 Jquery Mobile 在导航时会在 DOM 中保留一些页面，因此在来回移动时可能会多次访问一个页面。

如果我要绑定到如下所示的页面并在此绑定内执行我的所有页面逻辑，其中包括“嵌套元素绑定”：

```
// listener for the page to show:
$(document).on('pagebeforeshow.register', '#register', function() {

    // stuff

    // page event bindings:
    $(document).on('click.register', '.registerSubmitter', function(e) {
        // do something
        });
    }); 
```

来回移动会导致我的嵌套绑定被附加多次。

现在尝试像这样解决这个问题（不起作用......）：

```
 $(document).on('click', '.registrySubmitter', function(e) {

         if ( $(this).attr('val') != true ) {
            $(this).attr('val') == true;
            // do something
            }
     }); 
```

所以我只允许第一个绑定通过，然后我阻止所有其他绑定尝试。

虽然这可行，但远非最佳。

**问题**：
应该如何以及何时正确地解除/关闭事件绑定？有没有一般的方法（杀死所有）还是我必须每次绑定都做这个绑定？也许更重要的是：在用户进入/离开页面时进行一次绑定并保留它或绑定/取消绑定在性能方面是否更好？

感谢您的输入！

**编辑**：
所以我正在命名我所有的事件，然后像这样监听 pageHide：

```
$(document).on('pagehide.register', '#register', function(){
   $(document).off('.registryEvents');
   }); 
```

虽然这似乎解除了绑定，但当我关闭页面上的自定义对话框/选择菜单时它也会触发，所以我在离开页面之前失去了绑定。所以部分答案，我应该使用 off()，但是如何绑定到真正离开的页面与打开和关闭选择菜单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:12:45.157

当您`.on()`这样使用时，您将事件处理委托给`document`元素，这意味着您可以随时设置该委托事件绑定，因为该`document`元素始终可用。

我有两个建议：

*   使用`pageinit`or`pagecreate`事件仅在将页面添加到 DOM 并初始化时运行特定于页面的绑定。使用这种方法，我不会在`pageinit`or`pagecreate`事件处理程序中委托事件绑定，因为当它们触发时，伪页面上的所有元素都在 DOM 中：

.

```
$(document).on('pageinit', '#register', function() {
    //note that `this` refers to the `#register` element
    $(this).find('.registerSubmitter').on('click', function(e) {
        // do something
    });
}); 
```

*   绑定一次委托的事件处理程序，不用担心页面何时实际在 DOM 中：

.

```
//this can be run in the global scope
$(document).on('click.register', '.registerSubmitter', function(e) {
    // do something
}); 
```

基本上，当您像您一样使用委托绑定事件时，添加事件处理程序的实际 CPU 命中较少，但每次调度事件（任何类型的冒泡事件）时，都必须检查它是否与委托事件处理程序的选择器匹配.

当您直接绑定到元素时，通常需要更多时间来进行实际绑定，因为每个单独的元素都必须绑定到而不是`document`像事件委托那样绑定到元素一次。然而，这样做的好处是除非特定元素接收到特定事件，否则不会运行任何代码。

**文档中的简短说明：**

> 在初始化发生后，在正在初始化的页面上触发。我们建议绑定到此事件而不是 DOM ready()，因为无论是直接加载页面还是将内容作为 Ajax 导航系统的一部分拉入另一个页面，这都会起作用。

*来源：http: [//jquerymobile.com/demos/1.1.0/docs/api/events.html](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)*

# mongodb - 删除嵌套文档数组中的嵌入文档

> ID：10950451
> 
> 赞同：17
> 
> 时间：2012-06-08T14:09:28.530
> 
> 标签：mongodb

我的架构如下所示：

```
"content" : [
        {
            "_id" : ObjectId("4fc63de85b20fb72290000f8"),
            "assets" : [
                {
                    "path" : "temp/4f840af9565832fa14000002/4f840b1e565832fa14000007/4fc63de85b20fb72290000f7/content/I_Understanding_and_Measuring.pdf",
                    "_id" : ObjectId("4fc63def5b20fb722900010e")
                },
                {
                    "path" : "temp/4f840af9565832fa14000002/4f840b1e565832fa14000007/4fc63de85b20fb72290000f7/content/me.jpg",
                    "_id" : ObjectId("4fc63e4d5b20fb722900015d")
                }
            ],
            "content" : "",
            "name" : "Downloads"
        },
        {
            "_id" : ObjectId("4fc63dfd5b20fb722900012a"),
            "assets" : [
                {
                    "path" : "temp/4f840af9565832fa14000002/4f840b1e565832fa14000007/4fc63de85b20fb72290000f7/content/me.jpg",
                    "_id" : ObjectId("4fc63e055b20fb7229000147")
                },
                {
                    "path" : "temp/4f840af9565832fa14000002/4f840b1e565832fa14000007/4fc63de85b20fb72290000f7/content/thierry-henry-12-31-11-1.jpg",
                    "_id" : ObjectId("4fc63e525b20fb7229000164")
                }
            ],
            "content" : "",
            "name" : "Bio"
        }
    ], 
```

我可以通过以下方式检索此文档：

```
db.presentations.find({'content.assets._id': ObjectId('4fc63def5b20fb722900010e')})` 
```

我已尝试以下方法从资产集合中删除文档，并使用以下行，但无济于事：

```
db.presentations.update(
  {'content.assets._id': ObjectId('4fc63def5b20fb722900010e')}, 
  {$pull: {'content.assets': {'_id': ObjectId('4fc63def5b20fb722900010e')}}}
) 
```

我正在尝试`assets`通过其 ID 从相应的集合中删除一个项目。有任何想法吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-08T14:41:17.480

你是如此接近！请记住，您最外层的“内容”本身就是一个数组。因此，以下 2 个字符更改有效，在 $pull 的值内使用**content.$.assets 。**

```
db.presentations.update(
  {'content.assets._id': ObjectId('4fc63def5b20fb722900010e')}, 
  {$pull: {'content.$.assets': {'_id': ObjectId('4fc63def5b20fb722900010e')}}}
) 
```

放大。

# ajax - JavaScript 函数在 ajax 选项卡中不起作用

> ID：10950453
> 
> 赞同：1
> 
> 时间：2012-06-08T14:09:30.060
> 
> 标签：ajax, prototypejs

在我的页面中，我有 ajax 选项卡，每个选项卡都包含一些 javascript 函数。我只想在单击选项卡时加载每个 javascript 函数。但是这些功能在选项卡中不起作用。我该如何解决这个问题？

我的代码如下：

**PHP：**

```
echo "<script type='text/javascript'>";
echo "function check(){";
echo "alert('hello');";
echo "}";
echo "</script>";

echo "<div><a href='javascript:check();'>Check</a></div>"; 
```

**阿贾克斯：**

```
new Ajax.Request(
       test.php,
    {
       method:'post',               
       onSuccess: function(data){
       var tmp=data.responseText;
       $$('.tolga').invoke('insert',tmp);
    }
}); 
```

**HTML：**

```
 <div class="tolga">
    </div> 
```

# php - 检查多个字符串是否为空

> ID：10950470
> 
> 赞同：2
> 
> 时间：2012-06-08T14:10:09.157
> 
> 标签：php

> **可能重复：**
> [检查数组是否仅包含数字（整数）的更简洁方法](https://stackoverflow.com/questions/3559542/more-concise-way-to-check-to-see-if-an-array-contains-only-numbers-integers)
> [PHP 检查是否为空字段](https://stackoverflow.com/questions/9057477/php-checking-if-empty-fields)

我有提交 10 个字段的表单，其中 7 个应该填写，这是我现在在 PHP 中检查它的方式：

```
if (!$name || !$phone || !$email || !$mobile || !$email || !$state || !$street || !  $city) {
        echo '<div class="empty_p">You have empty fields!!!</div>';}
else{
        //process order or do something
} 
```

我的问题是：有没有更简单的方法来做到这一点？因为有时我有更多的字符串要检查 (12-15)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:20:43.950

另一种可能：

```
$elements = array($name, $email, $mobile);
$valid = true;

foreach ($elements as $element) {
    if (empty($element)) {
        $valid = false;
    }
}

if ($valid) {
    // complete
} else {
    // alert! some element is empty
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T14:16:39.617

像这样的东西？

```
foreach($_POST as $key => $value) 
{
    if (empty($_POST[$key]))
    {
        echo '<div class="empty_p">'.$_POST[$key].' is empty.</div>';
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T16:15:06.627

最好具体说明这些数据的预期位置，例如`$_POST`：

```
if (!isset($_POST['name'], $_POST['phone'], $_POST['email'], $_POST['mobile'], $_POST['state'], $_POST['street'], $_POST['city'])) {
    // something is up
} 
```

您可以通过使用所需的字段名称创建一个数组来稍微缩短此代码：

```
$required_fields = array('name', 'phone', 'email', 'mobile', 'state', 'street', 'city'); 
```

然后可以将“检查存在”代码简化为：

```
foreach ($required_fields as $f) {
    if (!isset($_POST[$f])) {
        // something is up
    }
} 
```

## 更好的方式™

但是，您应该认真考虑将存在检查*和*验证/清理检查结合起来。PHP 提供了一系列[过滤函数](http://us2.php.net/manual/en/intro.filter.php)，您可以使用它们来验证和/或清理输入变量。例如，要获得与上述等效的行为：

```
$required_fields = filter_input_array(INPUT_POST, array(
    'name' => FILTER_UNSAFE_RAW,
    'email' => FILTER_VALIDATE_EMAIL,
));

if (is_null($required_fields) || in_array(null, $required_fields, true)) {
    // some fields are missing
} 
```

存在但未通过验证的字段将设置为`false`，因此这是您检测此类事件的方式：

```
foreach ($required_fields as $name => $value) {
    if (false === $value) {
        // field $name failed validation (e.g. bad email format)
    } elseif (!strlen(trim($value))) {
        // field is empty
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T14:17:43.217

您可以编写 Foreach 循环

```
 foreach($_POST as $key => $value) 
    {
        if (!isset($_POST[$key]) || empty($_POST[$key])
        {
            echo '<div class="something">You have empty fields!!!</div>';
        }
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T14:24:34.497

最好的方法是创建某种形式的验证器。但是，您可以使用此功能：

```
<?php
    function isAnyEmpty() {
        $total = 0;
        $args = func_get_args();
        foreach($args as $arg)
        {
            if(empty($arg)) {
                return true;
            }
        }

        return false;
    }
    $var1 = 1;
    $var2 = 'test';
    $var3 = '';

    if(isAnyEmpty($var1, $var2, $var3)) {
        echo 'empty fields!';
    }
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-08T14:42:35.973

您可以尝试创建一个可以重用且更精确的通用验证类。

一些伪代码：

```
<?

class validateFields {
    $validators = array(
        "name" => array(
            "empty" => array(
                "rule"          => "some regex",
                "errorMessage"  => "name may not be empty"
            ),
            "noNumbers" => array(
                "rule"          => "some regex",
                "errorMessage"  => "No numbers are allowed in the name field"
            )
        ),
        "otherVariable" => array(
            "atLeast50chars" => array(
                "rule"          => "some regex",
                "errorMessage"  => "This field must be at least 50 chars"
            )
        )
    );

    public function Validate($post){
        $errors = array();

        foreach($_POST as $key => $value){
            if(!array_key_exists($key, $validators)) {
                continue;
            }

            foreach($validators[$key] as $validator) {
                if(!preg_match($validator["rule"], $value) {
                    $errors[$key] = $validator["errorMessage"];
                    break;
                }
            }
        }

        return $errors;
    }
}

?> 
```

然后在您的代码中，您可以执行以下操作：

```
$errors = Validate($_POST);
foreach($error as $errorMessage) {
    echo $errorMessage . "</br>";
} 
```

当然你可以想象一下，在相关输入字段的正下方/旁边添加带有类的 div，然后将 $errorMessage 加载到那里。我敢肯定那里有很多例子:)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-06-08T14:15:49.770

```
<input type="text" name="required[first_name]" />
<input type="text" name="required[last_name]" />
...

$required = $_POST['required'];
foreach ($required as $req) {
   $req = trim($req);
   if (empty($req))
      echo 'gotcha!';
} 
```

/* 更新 */

好的！小伙伴们，轻松...

你可以让它更安全，就像我们程序员为即将到来的数据所做的那样，就像我们所做的那样进行类型转换，像`$id = (int) $_GET['id']`，像`$username = (string) addslashes($_POST['username'])`等等……；

`$required = (array) $_POST['required'];`

然后，任何来自 post 字段的东西都让它们来，这段代码只是寻找它需要的东西。这就对了！呃……

# android - VideoView 中的 Youtube 视频

> ID：10950471
> 
> 赞同：0
> 
> 时间：2012-06-08T14:10:13.127
> 
> 标签：android

我想在 Videoview 中播放远程视频。有人知道一个很好的免费服务器可以将我的视频加载到其中以便以后在视频视图中流式传输吗？是否可以在 videoview Youtube 视频中看到？我看到了另一个问题，但我不明白。任何人都可以举一个例子，在视频视图中为另一台服务器播放 Youtube 视频或远程视频？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:54:14.750

您绝对可以毫无问题地将视频直接流式传输到 VideoView 中，并且您也可以正常设置它：

```
Uri pathtoVideo = Uri.parse(path);
videoView.setVideoURI(pathToVideo); 
```

但是，Youtube 上有很多不适合移动设备的视频，最终会抛出“无法播放此视频”错误。

Android 上的 MediaPlayer 只能播放“渐进式流媒体内容”，这基本上意味着： 1\. 电影原子必须在所有媒体数据原子之前。2\. 剪辑必须合理交错。如果没有，你会得到我上面提到的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T09:24:52.977

您是否考虑过适用于 Android 的 YouTube API？[我最近在此处](http://androiddev101.com/episode-12-youtube-it-all-night-long/)发布了有关如何使用 API 中的视频和缩略图视图的教程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:41:44.447

您可以查看[android-youtube-player](http://code.google.com/p/android-youtube-player/)，这是一个让 YouTube 视频在`VideoView`. 使用说明和示例`Activity`代码可用。

# java - ObjectInputStream 的 readObject() 在 Client Socket 连接被终止后冻结

> ID：10950476
> 
> 赞同：1
> 
> 时间：2012-06-08T14:10:26.933
> 
> 标签：java, sockets, freeze

我有以下 Socket 服务器的代码，它从连接的 Socket 读取流。

```
try
{
    ObjectInputStream in = new ObjectInputStream(client.getInputStream());
    int count = 10;
    while(count>0)
    {
        String msg = in.readObject().toString(); //Stucks here if this client is lost.
        System.out.println("Client Says : "+msg);
        count--;
    }
    in.close();
    client.close();
}
catch(Exception ex)
{
    ex.printStackTrace();
} 
```

我有一个客户端程序，它与这个服务器连接，每秒发送一些字符串 10 次，服务器从套接字读取 10 次并打印消息，但是如果在这之间我杀死客户端程序，服务器就会冻结之间而不是抛出任何异常或任何东西。

我怎样才能检测到这种冻结情况？并使此循环无限迭代并打印客户端发送的任何内容，直到连接处于活动状态且稳定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:47:18.687

问题是套接字的服务器端无法知道客户端连接已关闭，因为客户端代码在没有在套接字客户端调用 .close() 的情况下终止，因此从不发送 TCP FIN 信号。

解决此问题的一种可能方法是创建一个新的 Watcher 线程，该线程只是定期检查套接字以查看它是否仍然处于活动状态。这种方法的问题在于 Socket 上的 isConnected() 由于上述相同的原因而无法工作，因此检查连接的唯一真正方法是尝试写入它。但是，这可能会导致随机垃圾被发送到潜在的监听客户端。

其他选择是实现某种类型的客户端应该同意的保持活动协议（即，每隔一段时间发送保持活动位，以便观察者有一些东西要寻找）。您也可以只使用 java.nio 方法，我相信它在处理这些情况方面做得更好。

该线程很旧，但提供了更多详细信息：[http](http://www.velocityreviews.com/forums/t541628-sockets-checking-for-dropped-connections-and-close.html) ://www.velocityreviews.com/forums/t541628-sockets-checking-for-dropped-connections-and-close.html 。

# c# - 如何优化 Shell32 方法调用？

> ID：10950477
> 
> 赞同：3
> 
> 时间：2012-06-08T14:10:27.540
> 
> 标签：c#, optimization, metadata, shell32

我正在设计一个媒体播放器，并且我设计了一个电影类。Movie 类有一个 MovieInfo 成员，它继承自 MediaInfo。MediaInfo 有几个属性表示电影文件的元数据（你叫它吗？），例如文件长度、文件大小、文件路径等。为了提取这些信息，我使用了 Shell32。

问题是 Shell32 中提供的方法非常非常慢。在我的数据库中有 1 部电影，这不是问题，但有 10 部电影，它开始变得明显，并且有 100 部电影，加载程序大约需要 5 分钟，在某些情况下我必须重新初始化运行时的电影，这再次停止了程序的流程。

MediaInfo 构造函数调用 Initialize 方法：

```
 /// <summary>
    /// Initializes all the information variables of the class.
    /// </summary>
    private void Initialize()
    {
        Folder mediaFolder = Shell32Processing.GetShellFolder(this.path);

        FolderItem media = Shell32Processing.GetShellFolderItem(this.path);

        //initialize bit rate value
        this.bitrate = mediaFolder.GetDetailsOf(media, 28);

        //initialize date accessed value
        this.dateAccessed = mediaFolder.GetDetailsOf(media, 5);

        //initialize date created value
        this.dateCreated = mediaFolder.GetDetailsOf(media, 4);

        //initialize date modified value
        this.dateModified = mediaFolder.GetDetailsOf(media, 3);

        //initialize data rate value
        this.dataRate = mediaFolder.GetDetailsOf(media, 279);

        //initialize file name value
        this.fileName = mediaFolder.GetDetailsOf(media, 155);

        //initialize file type value
        this.fileType = mediaFolder.GetDetailsOf(media, 181);

        //initialize folder value
        this.folder = mediaFolder.GetDetailsOf(media, 177);

        //initialize folder name value
        this.folderName = mediaFolder.GetDetailsOf(media, 175);

        //initialize folder path value
        this.folderPath = mediaFolder.GetDetailsOf(media, 176);

        //initialize frame height value
        this.frameHeight = mediaFolder.GetDetailsOf(media, 280);

        //initialize frame rate value
        this.frameRate = mediaFolder.GetDetailsOf(media, 281);

        //initialize frame width value
        this.frameWidth = mediaFolder.GetDetailsOf(media, 282);

        //initialize length value
        this.length = mediaFolder.GetDetailsOf(media, 27);

        //initialize title value
        this.title = FileProcessing.GetFileTitle(this.path);

        //initialize total bitrate value
        this.totalBitrate = mediaFolder.GetDetailsOf(media, 283);

        //initialize size value
        this.size = mediaFolder.GetDetailsOf(media, 1);
    } 
```

这是 Shell32Processing.GetShellFolder 方法：

```
 /// <summary>
    /// Gets a Shell32 Folder, initialized to the directory of the file path.
    /// </summary>
    /// <param name="path">A string representing the file/folder path</param>
    /// <returns>The Shell32 Folder.</returns>
    public static Folder GetShellFolder(string path)
    {
        //extract the folder subpath from the file path
        //i.e extract "C:\Example" from "C:\Example\example.avi"

        string directoryPath = new FileInfo(path).Directory.ToString();

        return new Shell().NameSpace(directoryPath);
    } 
```

和 Shell32Processing.GetShellFolderItem 方法：

```
 /// <summary>
    /// Gets a Shell32 FolderItem, initialized to the item specified in the file path.
    /// </summary>
    /// <param name="path">A string representing the file path.</param>
    /// <returns>The Shell32 FolderItem.</returns>
    /// <exception cref="System.ArgumentException">Thrown when the path parameter does not lead to a file.</exception>
    public static FolderItem GetShellFolderItem(string path)
    {
        if (!FileProcessing.IsFile(path))
        {
            throw new ArgumentException("Path did not lead to a file", path);
        }

        int index = -1; 

        //get the index of the path item
        FileInfo info = new FileInfo(path);
        DirectoryInfo directoryInfo = info.Directory;
        for (int i = 0; i < directoryInfo.GetFileSystemInfos().Count(); i++)
        {
            if (directoryInfo.GetFileSystemInfos().ElementAt(i).Name == info.Name) //we've found the item in the folder
            {
                index = i;
                break;
            }
        }

        return GetShellFolder(path).Items().Item(index);
    } 
```

每次调用 GetDetailsOf（Shell32 中提供的代码）都需要花费大量时间来处理——我使用 ANTS 分析器来找到它，因为起初我无法确定是什么让我的程序如此缓慢。

所以问题是：如何优化 Shell32 方法，如果不能，是否有替代方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T17:19:41.237

您在代码中做错了很多事情。您说问题出在您提供的代码之外，但也许我们可以通过修复损坏的代码来解决问题。

```
public static Folder GetShellFolder(string path)
{
    //extract the folder subpath from the file path
    //i.e extract "C:\Example" from "C:\Example\example.avi"

    string directoryPath = new FileInfo(path).Directory.ToString();

    return new Shell().NameSpace(directoryPath);
} 
```

您外出访问文件系统只是为了获取文件路径的目录部分 ( `new FileInfo(path).Directory`)。您可以做到这一点，而无需使用`System.IO.Path.GetDirectoryName(path)`.

每次开始处理新项目时，您都在创建一个新的外壳对象。我会创建一个，处理所有项目，然后发布它。所以让我们这样改变`GetShellFolder`：

```
public static Folder GetShellFolder(Shell shell, string path)
{
    //extract the folder subpath from the file path
    //i.e extract "C:\Example" from "C:\Example\example.avi"
    string directoryPath = System.IO.Path.GetDirectoryName(path);

    return shell.NameSpace(directoryPath);
} 
```

并将`Shell`对象传递给您的`Initialize`方法。接下来`GetShellFolderItem`。这是您的代码：

```
public static FolderItem GetShellFolderItem(string path)
{
    if (!FileProcessing.IsFile(path))
    {
        throw new ArgumentException("Path did not lead to a file", path);
    }

    int index = -1; 

    //get the index of the path item
    FileInfo info = new FileInfo(path);
    DirectoryInfo directoryInfo = info.Directory;
    for (int i = 0; i < directoryInfo.GetFileSystemInfos().Count(); i++)
    {
        if (directoryInfo.GetFileSystemInfos().ElementAt(i).Name == info.Name) //we've found the item in the folder
        {
            index = i;
            break;
        }
    }

    return GetShellFolder(path).Items().Item(index);
} 
```

第一个错误是在访问该文件之前使用“文件是否存在”。不要这样做。只需访问该文件，如果它不存在，`FileNotFoundException`就会发生。您所做的只是添加已经完成的额外工作。不管你做不做，它仍然有可能通过“文件存在测试”，但访问失败。

接下来，您将解析目录以获取文件夹中文件的索引。这是一个严重的比赛条件。您完全有可能在这里得到错误的索引值。这也不是必需的，因为`Folder`公开了一个方法来获取`FolderItem`按名称：`ParseName`。

最后，您正在创建另一个`Folder`（通过调用 GetShellFolder），它也创建另一个`Shell`项目。你已经有一个`Folder`，使用它。

所以我们可以`GetShellFolderItem`通过完全删除它来改变：

```
FolderItem media = mediaFolder.ParseName(System.IO.Path.GetFileName(path)); 
```

`GetShellFolder`我们可以同样巧妙地摆脱：

```
private void Initialize(Shell shell)
{
    Folder mediaFolder = null;
    FolderItem media = null;
    try
    {
        mediaFolder = shell.NameSpace(Path.GetDirectoryName(path));
        media = mediaFolder.ParseName(Path.GetFileName(path));

        ...
    }
    finally
    {
        if (media != null)
            Marshal.ReleaseComObject(media);
        if (mediaFolder != null)
            Marshal.ReleaseComObject(mediaFolder);
    }
} 
```

让我们看看所有这些有多大的不同。

您还为您已经知道或可以从媒体对象获取的内容调用 GetDetailsOf：

```
 //initialize folder name value
    this.folderName = mediaFolder.GetDetailsOf(media, 175);

    //initialize folder path value
    this.folderPath = mediaFolder.GetDetailsOf(media, 176);

    //initialize size value
    this.size = mediaFolder.GetDetailsOf(media, 1); 
```

将这些更改为：

```
 //initialize folder path value
    this.folderPath = Path.GetDirectoryName(path);

    //initialize folder name value
    this.folderName = Path.GetFileName(folderPath);

    //initialize size value
    this.size = media.Size; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T12:03:40.073

检查此[链接](http://www.kixtart.org/forums/ubbthreads.php?ubb=showflat&Number=160880&page=1)。您将根据 Win-OS 版本获得更多关于 GetDetailsOf() 及其文件属性的许可。

```
List<string> arrHeaders = new List<string>();

 Shell shell = new ShellClass();
 Folder rFolder = shell.NameSpace(_rootPath);
 FolderItem rFiles = rFolder.ParseName(filename);

 for (int i = 0; i < short.MaxValue; i++)
 {
      string value = rFolder.GetDetailsOf(rFiles, i).Trim();
      arrHeaders.Add(value);
 } 
```

希望这可能对某人有所帮助..

# xslt - 与当前日期比较

> ID：10950482
> 
> 赞同：1
> 
> 时间：2012-06-08T14:10:42.197
> 
> 标签：xslt

我有一个带有这样行的 xml 文件：

```
<Data>
    <a>something</a>
    <b>20120601</b>
    <c>something else</c>
</Data> 
```

中的值是格式为 YYYYMMDD 的日期

我有一个处理每一行的小模板，并且工作正常（因为它没有太多作用）

现在我的问题是：仅当 B 中的日期大于（晚于）今天（当前日期）前 60 天时，我如何处理一行？因此，如果日期是最近的-> 处理该行，否则不要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:06:02.923

**这是一个完整、简短且简单的 XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:param name="pPeriod" select="'P60D'"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match=
 "Data
   [current-date()
   -
    xs:date(concat(substring(b,1,4),
                   '-',
                   substring(b,5,2),
                   '-',
                   substring(b,7)
                   )
            )
    gt xs:dayTimeDuration($pPeriod)
   ]"/>
</xsl:stylesheet> 
```

**应用于此 XML 文档时：**

```
<t>
    <Data>
        <a>something</a>
        <b>20120601</b>
        <c>something else</c>
    </Data>
    <Data>
        <a>something</a>
        <b>20120420</b>
        <c>something else</c>
    </Data>
    <Data>
        <a>something</a>
        <b>20120301</b>
        <c>something else</c>
    </Data>
</t> 
```

**产生了想要的正确结果（最后一个`Data`元素“删除”）：**

```
<t>
      <Data>
            <a>something</a>
            <b>20120601</b>
            <c>something else</c>
      </Data>
      <Data>
            <a>something</a>
            <b>20120420</b>
            <c>something else</c>
      </Data>
</t> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:46:45.970

正如 MiMo 已经说过的那样，没有内置函数可以**在 xslt 1.0**中获取当前日期。您可以将参数传递到您的 xslt 样式表中，但这取决于您使用的 xslt 处理器。

如果您将回溯日期（当前日期减去 60 天）作为参数传递，您的测试可以很简单：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:param name="backdate" />

    <xsl:template match="Data">
        <xsl:if test="(./b &gt;= $backdate)">
            <xsl:apply-templates />
        </xsl:if>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

在**xslt 2.0**中，您可以使用内置`current-date()`函数

```
<xsl:variable name="backdate" select="current-date() -60*xs:dayTimeDuration('P1D')" /> 
```

...但您需要`<b>`相应地转换您的日期值 - 或格式化`backdate`变量以适合您的日期值。

*取自 Dimitre 关于[减去 days](https://stackoverflow.com/a/3887418/205233)的回答。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:35:13.807

正如评论者所说，XSL 本身无法做到这一点。您需要首先计算出 60 天前的日期，并将其作为参数传递给您的 XSL。

在 PHP 中，您可以通过以下方式计算一天：

```
$date_60_days_ago = date('Y-m-d H:m:s', strtotime("-60 days")); 
```

至于 XSL，请参阅此 XMLPlayground 会话（出于此演示的目的，我手动传递了日期）

[http://www.xmlplayground.com/sK82Q4](http://www.xmlplayground.com/sK82Q4)

# jquery - jQuery 中的 $(this).trigger('click') 是否复制物理鼠标点击？

> ID：10950488
> 
> 赞同：0
> 
> 时间：2012-06-08T14:10:51.207
> 
> 标签：jquery, onclick, cursor, textarea, mouseover

那里有人可以帮助我解决以下问题：

我认为 $(this).trigger('click') 会复制用户的物理点击？这是我在文本区域上移动时触发点击事件的代码：

```
<!DOCTYPE html>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
$(document).ready(function() {
    var getCursorPos = function(e){
        $(this).trigger('click');
        var $cursor_position = $(this).prop("selectionStart");
        $('#result').html('<p> Cursor position: ' + $cursor_position + '</p>');
        console.log("Auto click at ", $cursor_position, e.pageX, e.pageY);
    };
    $("#text").bind({
        mousemove: getCursorPos,
    });
});
</script>

<html>
    <div id="result"></div>
    <textarea id="text">This is some example text</textarea>
</html> 
```

为什么触发点击事件后没有从textarea返回光标位置。如果我实际按下鼠标按钮，控制台读数会捕获光标位置。我认为 .trigger('click') 也会这样做。

当我将鼠标移到 textarea 上时，如何修复此代码以使其返回 textarea 中的光标位置？

任何帮助是极大的赞赏。

马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T10:47:20.950

> 我认为 $(this).trigger('click') 会复制用户的物理点击？

确实如此，但目前`this`内部`$(this)`似乎并未引用您要单击的元素。

尝试创建一个带有 的按钮`id`，然后试试这个：

```
$('#buttonID').trigger('click'); 
```

或者简单地说：

```
$('#buttonID').click(); 
```

# java - 在 Java 中以编程方式处理 XML 验证输出

> ID：10950492
> 
> 赞同：2
> 
> 时间：2012-06-08T14:10:57.063
> 
> 标签：java, xml, xsd

我必须解决的问题如下：

给定一个使用 XSD（或理想情况下是 NVDL）模式“几乎验证”的 XML 文件，我如何以编程方式“修复”该文件？

（“几乎验证”意味着某些元素将具有他们不允许拥有的属性。保证不会有其他验证错误。“修复”只是意味着删除有问题的属性。）

我尝试使用 Woodstox 的验证编写器，但由于某种原因，它不接受我的 XSD 为有效（当然，多个导入和抽象类型非常复杂，但它是有效的）。

另一种方法是生成一个输出的 XML 验证库，然后我可以解析/处理并使用它来识别需要删除的属性。

也欢迎任何其他产生相同最终产品的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:16:16.967

如果您想“仅强制执行”属性，您可以使用 XSLT 身份转换来过滤不需要的属性或添加缺少的属性。这绝不是对问题的广泛解决方案，而是对属性问题的非常好的解决方案。

但请记住，在 XSLT 转换之后属性的顺序可能会改变，因为属性的顺序不是 XML 的必需属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:34:49.343

使用错误处理程序解析您的 XML，该错误处理程序捕获“删除此属性”类型命令对象中检测到的“额外属性”错误。

然后，如果您将这些对象放在“读取 SAX”解析器和“使用 SAX 写入”接收器之间，或者在将 DOM 树重写为 XML 之前在 DOM 树上运行它们，那么这就是实现的问题。

错误处理程序应该处理错误，如果您不希望它成为错误，则错误处理程序不应终止解析。这将为您提供细粒度控制，但代价是编写代码以捕获文档中属性的位置（并稍后对其进行处理）。

根据[XML 规范](http://www.w3.org/TR/REC-xml/#dt-xml-proc)，有效性约束只是“错误”，它为继续处理打开了大门，前提是您的错误处理程序不会停止游戏。有关表明这不应是不可恢复错误的详细信息，请参阅第 1.2 节，这意味着应该可以使用捕获和修复解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:25:28.237

这是对“其他方法”的回应。我宁愿修改 XSD 以接受任何其他属性：它会减少运行时开销，更不用说使用 XSLT 的所有管道了。

从它的声音来看，你知道并且以某种方式理解/控制 XSD - 你听起来有信心说“保证没有其他验证错误”......因此我的建议。

如果 XSD 是“外部的”，问题可能是如何修改它。如果您可以详细说明如何为您的处理采购 XSD，那么可能会出现更好的建议......

也许您最终还是会使用 XSLT 进行 XSD 到 XSD 的转换；在性能驱动的环境中它仍然会更好，因为您必须为**所有**XML 执行一次，而不是为**每个**XML 执行一次。

# php - Ajax 使用 PHP 发送 JSON 和获取数据

> ID：10950507
> 
> 赞同：1
> 
> 时间：2012-06-08T14:11:27.170
> 
> 标签：php, jquery, ajax

我有 jquery 代码输出 json 数据，我需要将此数据发送到 url 并使用 php 获取

**代码：**

```
JSON.stringify(showtimes) 
```

**输出：**

```
[{"show_id":"1","movie_id":"20","cinema_id":"10","status":"0","times":"00:00"},{"show_id":"2","movie_id":"21","cinema_id":"11","status":"1","times":"01:00"}, ... etc] 
```

我需要`JSON.stringify(showtimes)`通过 ajax 将此 json 数据发送到 url 并使用 php 获取 json。

**我的ajax代码：**

```
$.ajax({
    type: 'POST',
    url: '/admin/save/',
    data: JSON.stringify(showtimes),  
    success: function(data){}
}); 
```

**问题：**

*   检查ajax代码是否正确？
*   如何使用 PHP 获取数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:20:33.830

首先，您应该在 javascript 中为您的 json 对象分配一个数据键：

```
$.ajax({
    type: 'POST',
    url: '/admin/save/',
    data: {json : JSON.stringify(showtimes)},  
    success: function(data){}
}); 
```

在您的 PHP 中，将访问 JSON 字符串：

```
$_POST['json']; 
```

其次，在 PHP 中，您将希望使用以下示例收集数据：

```
$json = json_decode($_POST['json'], true); 
```

然后，您可以将 JSON 数组作为关联数组访问：

```
foreach($json as $show_details){
    $show_id = $show_details['show_id'];
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:18:38.680

您可以使用以下内容检查 ajax 响应是否有效 JSON：

```
function isValidJSON($request_data)
{
  return (json_decode($request_data) != NULL) ? TRUE : FALSE;
} 
```

然后，您可以使用[json_decode()](http://php.net/manual/en/function.json-decode.php "json_decode()")来解码数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:18:14.123

要将 json 解码为 php 数组，请使用[json_decode](http://php.net/manual/en/function.json-decode.php)。

```
if(!empty($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest') {

  //It is ajax

} 
```

# javascript - 样式化浮动表头

> ID：10950508
> 
> 赞同：0
> 
> 时间：2012-06-08T14:11:36.937
> 
> 标签：javascript, jquery, html

我正在使用[此处](http://code.google.com/p/js-floating-table-headers/)提供的 JavaScript/jQuery 脚本来让表格标题在向下/向上滚动时浮动。我的桌子居中对齐。当我向下滚动时，标题浮动但它们左对齐，但表格的其余部分是中心对齐的。这是我现在得到的输出快照：

![这是我现在得到的输出快照：](../Images/4940d48a64ac90808d391e85ad0d7606.png)

我究竟需要在这个 JavaScript/jQuery 代码或我的 PHP/HTML 代码中编辑什么以使它们居中对齐？

### 更新

[问题示例](http://jsfiddle.net/VHaaw/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:11:54.207

这不是您找到的最优雅的脚本，所以我认为 yaponyal 的建议是合理的。

您的 fiddle 不起作用有几个原因： jsfiddle 不喜欢脚本的直接 onload 事件附件，因此您可以将其更改为：

```
window.addEvent("domready", function() {
    this.build_header();
}); 
```

此外，每次滚动时运行的 setheader 函数还必须为标题设置水平位置。

```
this.header.style.left = this.table_obj.offsetLeft + "px"; 
```

不能自动居中的原因见[这里。](https://stackoverflow.com/questions/9998260/css-absolute-position-wont-work-with-margin-leftauto-margin-right-auto)如果您愿意，您可以修改脚本以将克隆的表头放在文本居中对齐的 div 中。

此外，该脚本在不附加“px”的情况下为标题设置了一个最高值。这在我的浏览器中不起作用，我不得不将其更改为：

```
this.header.style.top=Math.round(screenpos) + "px"; 
```

[http://jsfiddle.net/VHaaw/3/](http://jsfiddle.net/VHaaw/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:54:38.447

在页面加载时，标题是否出现在顶部？如果是这样，我建议将标题分离到一个单独的 div 中，根据您的需要对其进行样式设置，然后设置一个固定到 div 的位置。您可以使用 css 属性 margin: 0 auto; 根据页面宽度居中数据。

# sshfs - sshfs 会使用我的 .ssh/config 吗？

> ID：10950509
> 
> 赞同：5
> 
> 时间：2012-06-08T14:11:38.233
> 
> 标签：sshfs

我的 ~/.ssh/config 中有一些选项：

主机 * 密码 arcfour,blowfish-cbc

这些选项旨在加快传输速度。当我进行挂载时 sshfs 会使用这些选项吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-30T03:58:52.443

是的，sshfs 只是调用普通的旧 ssh，这也是您可以使用 .ssh/config 中的每个主机配置的原因。如果需要，可以使用 -F 指定不同的 ssh_config。

# bash - 在参数中传递变量

> ID：10950510
> 
> 赞同：0
> 
> 时间：2012-06-08T14:11:39.437
> 
> 标签：bash, find, filenames, arguments

我正在寻找如何在查找文件函数中传递参数这应该首先为我的计算机中的所有 sh 文件提供基本名称一个选项卡，然后是所有目录例如`myBashfile.sh *sh` 目前我有这个：while getopts b opt do case $opt in b) find / -name $OPTARG -printf "%f\n"-print 2>/dev/null ;; esac done 仅给出 test1.sh test60.sh anothertest.sh 的输出

但我需要作为输出：（带有选项卡）test1.sh /home/directory5/directory6 test60.sh /home/directory50/directory6 anothertest.sh /home/directory5/directory6

谁能帮帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:22:53.173

一个全面的[答案](https://stackoverflow.com/a/256225/1367611)和[手册](http://tldp.org/LDP/abs/html/internalvariables.html#ARGLIST)。简单来说：

```
$1 # means the 1st argument
$2 # means the 2nd argument
$@ # means all arguments 
```

# windows-phone-7 - WP Emulator 中录制的 .mp4 视频文件是否已准备好用于外部存储？

> ID：10950519
> 
> 赞同：0
> 
> 时间：2012-06-08T14:12:25.217
> 
> 标签：windows-phone-7, windows-phone-7.1, mp4, isolatedstorage, windows-phone-7-emulator

**MS 发布了一些代码示例，其中视频被记录在 WP Emulator 中，然后保存在隔离存储中。这个 .mp4 文件是否准备好从 WP Emulator 导出并在其他应用程序中播放？或者是否需要以某种方式对其进行格式化？如果是这样，该怎么做？**

[http://channel9.msdn.com/Shows/Inside+Windows+Phone/Inside-Windows-Phone-16-Mango-Camera-APIs](http://channel9.msdn.com/Shows/Inside+Windows+Phone/Inside-Windows-Phone-16-Mango-Camera-APIs)

视频录制的源代码位于名为 CameraUpload 的 WP 项目中：

[https://skydrive.live.com/?cid=bc58fec5c97e307a&sc=documents&id=BC58FEC5C97E307A%21295](https://skydrive.live.com/?cid=bc58fec5c97e307a&sc=documents&id=BC58FEC5C97E307A%21295)

[http://msdn.microsoft.com/en-us/library/hh394041(v=vs.92).aspx](http://msdn.microsoft.com/en-us/library/hh394041(v=vs.92).aspx)

编辑：

我正在尝试将 WP Emulator 中录制的视频上传到 Azure blob。

确实上传了一个文件，但我无法在 Zune 中播放该文件。

我希望能够在 Zune 上播放 WP Emulator 中录制的视频文件，如何启用此功能？

保存视频的 Azure WCF 服务角色中的方法如下所示：（如果方法参数名称稍有误导和混淆，请见谅。）

```
bool SaveImage(int salesItemId, string contentType, byte[] photo); 
```

视频保存到名为“firstmay”的 blob 容器中。

手机客户端保存视频的代码如下：

```
client.SaveImageAsync(77, "mp4", GetPhotoBytes(m_capturedFileName));

public byte[] GetPhotoBytes(string fileName)
{
    using (var appStorage = IsolatedStorageFile.GetUserStoreForApplication())
    {
         IsolatedStorageFileStream isoStream = appStorage.OpenFile(m_capturedFileName,     FileMode.Open);
         byte[] buffer = new byte[isoStream.Length];
         isoStream.Read(buffer, 0, (int)isoStream.Length); isoStream.Close();
         return buffer;
    }
} 
```

从 WP 客户端应用程序上传视频时，首先录制视频，然后通过单击“保存”将其上传，这一切都在 MainPage 中进行。

客户端和服务器应用程序可以从 skydrive 下载：

[https://skydrive.live.com/redir?resid=159250F5CE7FE134!118](https://skydrive.live.com/redir?resid=159250F5CE7FE134!118)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:00:04.540

这完全取决于您希望能够播放内容的内容。带有 Zune 的 PC 会很好，我希望其他支持视频的手机也可以，但较旧的手机或标准 Vista 安装需要额外的软件或视频转码才能播放。

# ruby - Ruby Regex 替换所有出现的内容，除非是 HTML 属性

> ID：10950525
> 
> 赞同：0
> 
> 时间：2012-06-08T14:12:38.493
> 
> 标签：ruby, regex

除非出现在 HTML 标记中`%{ ... %}`，否则我需要将所有实例包装起来。例如，这个：`<span code='notranslate'>...</span>``%{ ... }`

```
"Or %{register_text} for a new account by <a href='%{path}'>clicking here</a>." 
```

需要变成这个

```
"Or <span code='notranslate'>%{register_text}</span> for a new account by <a href='%{path}'>clicking here</a>." 
```

我当前的正则表达式没有考虑 HTML 标签的情况：

```
x.gsub(/[?<!]%\{([a-zA-Z0-9_\-]*)\}[?>!]/i) {|s| "<span class='notranslate'>#{s}</span>"} 
```

所以我想知道如何使用正则表达式在 Ruby 中执行此操作。

有接盘侠吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:34:21.403

我不确定输入空间，所以这是我能想到的最好的。在此过程中，我还稍微清理了正则表达式。

```
/%\{[\w-]+\}(?![^<>]>)/ 
```

对于格式良好的 HTML，它只会匹配标记外的标记。如果 HTML 格式不正确，我认为我无法胜任编写正则表达式的任务。

我还假设页面中没有嵌入的 Javascript，因为`>`Javascript`<`没有转义。

# android - 如何通过默认的 Android 下载器下载文件？

> ID：10950529
> 
> 赞同：13
> 
> 时间：2012-06-08T14:12:49.380
> 
> 标签：android, file, debugging, download, android-2.2-froyo

如何使用 Android 下载器下载文件？（WebBrowser 也在使用的下载器）。

我试过这样的事情：

```
Intent i = new Intent(Intent.ACTION_VIEW , Uri.parse("MyUrl"));
startActivity(i); 
```

有更好的办法吗？

**编辑**

我使用的是安卓 2.2

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-08T14:39:05.380

干得好。

```
import android.app.Activity;
import android.app.DownloadManager;
import android.app.DownloadManager.Query;
import android.app.DownloadManager.Request;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.widget.ImageView;

public class DownloadManagerActivity extends Activity {
    private long enqueue;
    private DownloadManager dm;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        BroadcastReceiver receiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                String action = intent.getAction();
                if (DownloadManager.ACTION_DOWNLOAD_COMPLETE.equals(action)) {
                    long downloadId = intent.getLongExtra(
                            DownloadManager.EXTRA_DOWNLOAD_ID, 0);
                    Query query = new Query();
                    query.setFilterById(enqueue);
                    Cursor c = dm.query(query);
                    if (c.moveToFirst()) {
                        int columnIndex = c
                                .getColumnIndex(DownloadManager.COLUMN_STATUS);
                        if (DownloadManager.STATUS_SUCCESSFUL == c
                                .getInt(columnIndex)) {

                            ImageView view = (ImageView) findViewById(R.id.imageView1);
                            String uriString = c
                                    .getString(c
                                            .getColumnIndex(DownloadManager.COLUMN_LOCAL_URI));
                            view.setImageURI(Uri.parse(uriString));
                        }
                    }
                }
            }
        };

        registerReceiver(receiver, new IntentFilter(
                DownloadManager.ACTION_DOWNLOAD_COMPLETE));
    }

    public void onClick(View view) {
        dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);
        Request request = new Request(
                Uri.parse("url for file to download"));
        enqueue = dm.enqueue(request);

    }

    public void showDownload(View view) {
        Intent i = new Intent();
        i.setAction(DownloadManager.ACTION_VIEW_DOWNLOADS);
        startActivity(i);
    }
} 
```

不要忘记添加`android.permission.internet`清单。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-16T14:41:14.857

如果您想从 URL 将其下载到用户的 SD 卡上，您只需在手机的默认 Internet 浏览器中打开它即可。

```
String url = "https://appharbor.com/assets/images/stackoverflow-logo.png";
Intent i = new Intent(Intent.ACTION_VIEW);
i.setData(Uri.parse(url));
startActivity(i); 
```

[（来自这个问题的代码）](https://stackoverflow.com/questions/3004515/android-sending-an-intent-to-browser-to-open-specific-url)

The android browser will then start and the file (in this case an image) will be downloaded.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-13T21:43:44.313

您需要`HttpUrlConnection`在 Android 2.2 及更低版本上使用才能执行此操作。互联网上有一个非常详细的[**教程**](http://progrnotes.blogspot.com/2010/09/c-android.html)，向您展示了如何执行此操作（也带有进度对话框）。

请记住，您**必须**使用 an`AsyncTask`或 a`Thread`来确保在实际下载期间不会阻塞 UI 线程！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-09T12:24:05.330

Yes, you cant perform network operation in the main thread. You can look up to [this](https://github.com/amit-appstudioz/AndroidFileDownloaderModule) repository to download file.

# c# - RegisterHotKey 不是在单独的线程中工作吗？

> ID：10950530
> 
> 赞同：0
> 
> 时间：2012-06-08T14:12:50.457
> 
> 标签：c#, multithreading, registerhotkey

我有一个线程执行某些事情，最后它应该将我的 F 键绑定为全局热键，我无法让它工作，任何关于我做错了什么的见解或者如果 RegisterHotKey 不是我的线程的功能原因？

```
[DllImport("user32.dll", SetLastError = true)]
public static extern bool RegisterHotKey(IntPtr hWnd, int id, System.Windows.Input.ModifierKeys fsModifiers, Keys vk);

[DllImport("user32.dll", SetLastError = true)]
public static extern bool UnregisterHotKey(IntPtr hWnd, int id);

private const int WmHotKey = 0x0312;

private void onLoad()
{
   //RegisterHotKey(this.Handle, 0, System.Windows.Input.ModifierKeys.None, Keys.F); // This works
}

private void OnSeparateThread()
{
   // This gets called by a separate thread, in the full version of the code more stuff
   // happen here, which does get executed.
   RegisterHotKey(this.Handle, 0, System.Windows.Input.ModifierKeys.None, Keys.F); // Does not bind
}

protected override void WndProc(ref Message m)
{
   if (m.Msg == WmHotKey)
   {
      MessageBox.Show("Test me!");
   }
   base.WndProc( ref m );
} 
```

编辑：当然我不会同时绑定这两个，一个总是被注释掉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:31:56.850

（最初是评论，但它确实回答了提出的问题）：

来自 MSDN，[RegisterHotKey](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646309%28v=vs.85%29.aspx)：

> 此函数不能将热键与另一个线程创建的窗口相关联。

所以，简单的答案是否定的。

# javascript - 对大值使用 setTimeout()

> ID：10950533
> 
> 赞同：3
> 
> 时间：2012-06-08T14:13:04.563
> 
> 标签：javascript

我试图在五分钟后触发一个事件。我正在使用以下代码：

```
setTimeout(tweet(name, type), 5 * 60 * 1000); 
```

过了一会儿就开始了，但不到五分钟（通常是两分钟左右，但有时是瞬间的。）*。*我究竟做错了什么？（我也尝试将时间设置为`300000`，同样的问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T14:14:23.467

您正在`tweet`立即调用并将其返回值传递给`setTimeout`.

您需要将函数传递给`setTimeout`. 您没有包含 的代码`tweet`，但我假设它不是`return`函数。

```
setTimeout(function () { tweet(name, type); }, 5 * 60 * 1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T07:18:56.713

Quentin 的解决方案有效，但您也可以使用这种形式：

```
setTimeout(tweet(name, type), 5 * 60 * 1000);

function tweet(name, type) {
    return function(name, type) {
    };
} 
```

当您想在闭包中保留一些值时，它有一些用例。

# javascript - 如何检测文本区域输入中的换行符？

> ID：10950538
> 
> 赞同：50
> 
> 时间：2012-06-08T14:13:15.237
> 
> 标签：javascript, jquery, special-characters, line-breaks

**检查文本区域值的换行符然后计算出现次数（如果有）的最佳方法是什么？**

我的网页上的表单上有一个文本区域。我正在使用 JavaScript 来获取文本区域的值，然后检查它的长度。

### 例子

```
enteredText = textareaVariableName.val();
characterCount = enteredText.length; // One line break entered returns 1 
```

如果用户在文本区域输入换行符，我上面的计算将换行符的长度设为 1。但是我需要将换行符的长度设为 2。因此我需要检查换行符和出现次数，然后将此添加到总长度上。

### 我想要实现的示例

```
enteredText = textareaVariableName.val();
characterCount = enteredText.length + numberOfLineBreaks; 
```

* * *

在问这个问题之前，我的解决方案如下：

```
enteredText = textareaVariableName.val();
enteredTextEncoded = escape(enteredText);
linebreaks = enteredTextEncoded.match(/%0A/g);
(linebreaks != null) ? numberOfLineBreaks = linebreaks.length : numberOfLineBreaks = 0; 
```

我可以看到对文本进行编码和检查`%0A`有点冗长，所以我寻求了一些更好的解决方案。感谢您的所有建议。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-06-08T14:22:41.687

您可以`match`在包含换行符的字符串上使用，并且该数组中的元素数量应对应于换行符的数量。

```
enteredText = textareaVariableName.val();
numberOfLineBreaks = (enteredText.match(/\n/g)||[]).length;
characterCount = enteredText.length + numberOfLineBreaks; 
```

`/\n/g`是一个正则表达式，意思是“查找字符`\n`（换行符），并在全局范围内（跨越整个字符串）执行此操作。

该`||[]`部分以防万一没有换行符。Match 将返回`null`，因此我们改为测试空数组的长度以避免错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T14:21:46.310

这是一种方法：

```
var count = text.length + text.replace(/[^\n]/g, '').length; 
```

或者，您可以将所有“裸”`\n`字符替换为`\r\n`然后使用总长度。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-08T14:22:09.270

我会使用正则表达式来做到这一点：

```
var inTxt = document.getElementById('txtAreaId').value;
var charCount = inTxt.length + inTxt.match(/\n/gm).length; 
```

其中`/\n/`匹配换行符（显然）`g`是全局标志。`m`代表多线，在这种情况下你显然需要它......
或者，虽然我记得这有点慢：

```
var charCount = inTxt.length + (inTxt.split("\n").length); 
```

*编辑* 刚刚意识到，如果没有匹配的换行符，这将吐出一个错误，所以最好这样做：

```
charCount = intTxt.length + (inTxt.match(/\n/) !== null ? inTxt.match(/\n/gm).length : 0); 
```

或者类似的东西...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-13T22:12:26.760

对于新的 JS 使用`encodeURI()`，因为`escape()`在 ECMAScript 1.5 中已弃用。

而是使用：
`enteredText = textareaVariableName.val(); enteredTextEncoded = encodeURI(enteredText); linebreaks = enteredTextEncoded.match(/%0A/g); (linebreaks != null) ? numberOfLineBreaks = linebreaks.length : numberOfLineBreaks = 0;`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-04-03T13:15:20.390

您可以根据新行拆分文本：

```
let textArray = text.split(/^/gm)
console.log(textArray.length) 
```

# javascript - 如何添加 Facebook FB.ui 对话框确认消息

> ID：10950539
> 
> 赞同：2
> 
> 时间：2012-06-08T14:13:17.853
> 
> 标签：javascript, facebook

我有一些代码会弹出一个 facebook 对话框，在用户分享后他们被重定向到一个 URL，这会提示窗口关闭。如何传递一些 javascript，以便我可以在当前窗口上显示确认（即我希望通知用户他们已成功发布）

我尝试了一个简单的警报，但仅适用于重定向页面

```
 function postToFeed() {

    // calling the API ...
    var obj = {
      method: 'feed',
      link: 'https://developers.facebook.com/docs/reference/dialogs/',
      picture: 'http://fbrell.com/f8.jpg',
      name: 'test',
      caption: 'Reference Documentation',
      description: 'Using Dialogs to interact with users.',
      redirect_uri: 'http://domain.com/dios/index.php/response/'
    };

    function callback(response) {
      document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];

    }

    FB.ui(obj, callback);
  } 
```

上面的重定向 URL 回显： self.close();

* * *

我试图通过回调中的 ajax 调用来做到这一点.. 不起作用.. 任何其他建议..

这是我在上面的回调函数中改变的

```
 function callback(response) {
      document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];

      $.ajax({

             type: "POST",
             url: 'http://domain.com/dios/index.php/response/',
             success: function(data){

                 alert('yes');

             }

             });

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:20:31.263

简单：*不要*给出redirect_uri！

这将使对话框在完成后自行关闭；然后您只需在回调函数中评估对话框的响应。

# sql - SQL from where like with or 语句

> ID：10950540
> 
> 赞同：1
> 
> 时间：2012-06-08T14:13:22.163
> 
> 标签：sql

我有一条 SQL 语句来按名称搜索应用程序。

```
def apps = Application.findAll("from Application as app where lower(app.name) like '%${params.query.toLowerCase()}%' ") 
```

我不仅希望能够按应用程序名称进行搜索，还希望能够按类型和语言等不同属性进行搜索。我将如何添加或声明以允许我这样做。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:12:48.660

目前尚不清楚（对我而言）您正在使用什么框架，或者您的数据库在什么特定的 RDBMS 上，但 SQL 条件的总体主旨通常非常简单。

几乎与大多数其他计算机语言一样，您使用和/或/非语句。当然，在 SQL 中，您使用单词，而不是（通常是）符号：

*   `AND`代替`&&`
*   `OR`代替`||`
*   `NOT`代替`!`

连同标准比较运算符：

*   `<`, `<=`, `=`, `<>`, `>`,`>=`

请注意，“等于”只是一个`=`符号，“不等于”通常是对立的尖括号`<>`。

因此，鉴于您当前的声明，如果您只想以用户的语言获取这些应用程序，并排除“禁用”的应用程序，您可以执行以下操作：

```
def apps = Application.findAll("from Application as app 
                                where lower(app.name) like '%${params.query.toLowerCase()}%' 
                                and app.language = userLanguageParameter
                                and app.status <> inactiveAppStatus "); 
```

# c# - 在 Metro 应用程序中存储大量数据

> ID：10950544
> 
> 赞同：2
> 
> 时间：2012-06-08T14:13:38.720
> 
> 标签：c#, storage, windows-8, microsoft-metro

我想将世界城市存储在一个列表中，因为 Metro 应用程序没有本地数据库，但我不确定这是否可行（我找到了一个包含超过 300 万个城市的文本文件）。

我想知道他们在天气应用程序中的表现如何。由于建议的结果中没有延迟（在搜索魅力或“最喜欢的地方”屏幕中），我不认为他们使用网络服务，而且我希望我的应用程序能够提出城市列表甚至如果没有可用的连接。

任何的想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:24:31.863

只需将其粘贴在文本文件中，按行分隔即可。这不是大量的数据 - 您可以一次将其全部保存在 RAM 中。

只为这个列表使用数据库似乎有点矫枉过正。

通过一些粗略的计算，假设每个名称大约有 20 个字符，我在大约 100MB 的城市数据区域内。对于内存中的一个列表来说，这并不是微不足道的——当然，但这并不是很多需要应对的。

您甚至可以使用[Linq to Text](http://blogs.msdn.com/b/ericwhite/archive/2006/08/31/734383.aspx)提供程序之类的东西。

* * *

他们在魅力中的做法可能是只担心几个城市 - 最喜欢的城市以及您的位置服务上次报告的任何内容。处理 < 10 比 300 万更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:28:04.990

300 万个城市听起来可能很多。但这对您的 Metro 应用程序来说是不是很多？

**这些是非常粗略的估计**

让我们使用 20 个 Unicode 字符的平均城市名称长度。

20 * 300 万 = 6000 万个 Unicode 字符。

每个 Unicode 字符 6000 万 * 2 个字节 = 1.2 亿字节。

1.2 亿字节 / 1024 = 117,187.5 KB

117,187.5 千字节 / 1024 = 114 兆字节

~115mb 并不完全是“小”，但取决于您的其他要求 - 您可能可以处理将 150mb 加载到内存中。您可以使用您通常使用的任何 .NET 对象，例如 List 并使用 LINQ 来获取匹配的城市或其他任何东西。

这并不是说这是您唯一的选择。它可能只是一个可行的。您可以做很多非常聪明的事情来避免一次将所有内容都拉入内存；但是，如果您想消除/最小化延迟-那将是您最好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T19:19:24.753

如果您需要数据库，我建议您研究 SQLite。Metro 应用程序显然无法访问 SQL Server 和其他基于 Win32 的 DBMS，但您可以尝试使用 SQLite 作为轻量级替代方案。

试试这个：[https ://github.com/doo/SQLite3-WinRT](https://github.com/doo/SQLite3-WinRT)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T13:33:36.567

我们建议使用带有[LinqConnect](http://www.devart.com/linqconnect/)的 SQLite 数据库- Devart 的支持 SQLite 的 LINQ to SQL 兼容解决方案。您可以在我们的产品中使用 LINQ 和 ADO.NET 接口。从 4.0 版本开始，LinqConnect 支持 Windows Metro 应用程序：http: [//blogs.devart.com/dotconnect/linqconnect-for-metro-quick-start-guide.html](http://blogs.devart.com/dotconnect/linqconnect-for-metro-quick-start-guide.html)。

# android - 在图像上绘制动态点

> ID：10950547
> 
> 赞同：0
> 
> 时间：2012-06-08T14:13:47.387
> 
> 标签：android, google-maps

我正在为 android 编写一个室内定位应用程序，我需要在图像（地图）上显示一个点，它在该地图上的位置在程序期间不断更新。为此我应该使用什么方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:22:51.670

创建一个子类，`ImageView`以便您可以将地图设置为`ImageView`内容；然后重写该`onDraw()`方法，这将为您提供一个`Canvas`您可以在其上绘制任何您喜欢的东西的方法。这里有一些伪代码来说明这个想法：

```
public class DotImageView extends ImageView {

    @Override
    public void onDraw(Canvas c) {
        //Call super for default behavior (draw the image first)
        super.onDraw(c);

        //Then draw your dot anywhere you like
        c.drawCircle(...);
    }

} 
```

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:24:19.380

您想在地图上显示 3D 点（来自您的问题）。

因此，我建议您通过扩展叠加类在地图上绘制叠加层，并随着位置更新绘制新的点图像，并在绘图方法中将新叠加层添加到叠加层列表中。write 方法提供更新的位置到 draw 方法，该方法使用 GeoPoint 和 Point 类获取精确点，您可以使用该类从 lat、long 绘制精确位置。[链接到 hlep](http://mobiforge.com/developing/story/using-google-maps-android)。如果有帮助感谢..

# c - 如何将 char* 转换为 UTF-8 编码的 char*？

> ID：10950548
> 
> 赞同：0
> 
> 时间：2012-06-08T14:13:57.540
> 
> 标签：c, linux, macos, unix, utf-8

在 Windows 下，我使用 MultiByteToWideChar(CP_ACP, ...) 和 WideCharToMultiByte(CP_UTF8, ...) 进行转换。

我如何在 OS X 和 Linux 下做同样的事情？我尝试了 mbstowcs/wcstombs，但生成的 char* 不是 UTF-8。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:15:30.993

查看[iconv(3)](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/iconv.3.html)。这就是你想要的api。你需要`-liconv`.

# sql - 将 GeoServer 用户注入 SQL 查询

> ID：10950553
> 
> 赞同：1
> 
> 时间：2012-06-08T14:14:02.883
> 
> 标签：sql, oracle, geoserver

我正在设置 GeoServer 安装以与 Oracle 数据库通信。
我需要一种将 GeoServer 用户名注入 SQL 查询的方法，以便可以执行数据授权。我尝试`${GSUSER,geoserver}`在 SQL 视图中使用该参数，但它被视为文字。

有什么建议么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:05:37.527

开发此新功能是为了解决使用特定用户访问数据的问题： [http ://docs.geoserver.org/stable/en/user/data/sqlsession.html](http://docs.geoserver.org/stable/en/user/data/sqlsession.html)

但是，它使 GeoServer 将在 GeoServer 中经过身份验证的用户发送到 sql 中，并且它不是您可以在 SQL 视图中使用的东西，它仅限于会话脚本。

对于 sql 视图，您必须将用户作为 OGC 请求中的参数传递 &viewparams=myuser:test 然后在 SQL 视图中使用 ${myuser} （默认值在参数表中指定）

# mysql - 尝试将子查询添加到联接查询

> ID：10950555
> 
> 赞同：0
> 
> 时间：2012-06-08T14:14:09.473
> 
> 标签：mysql, subquery

我有这样的查询

```
SELECT
    tbl_products.*,
    GROUP_CONCAT(tags.name)
FROM
    tbl_page_collections_products,
    (SELECT page_collection_name as name 
       FROM tbl_page_collections 
       LEFT JOIN tbl_pages ON tbl_page_collections.page_id = tbl_pages.page_id 
       WHERE tbl_pages.page_name LIKE '%friends%') tags
    LEFT JOIN tbl_page_collections 
      ON tbl_page_collections.page_collection_id = tbl_page_collections_products.colID 
    LEFT JOIN tbl_pages 
      ON tbl_page_collections.page_id = tbl_pages.page_id 
    LEFT JOIN tbl_products 
      ON tbl_products.product_id = tbl_page_collections_products.product
   WHERE
    tbl_pages.page_name LIKE '%friends%' 
```

我得到的错误是`Unknown column 'tbl_page_collections_products.colID in on clause`，但是当子查询不存在并且该列存在于该表中时，我没有得到该错误。

有什么矛盾的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:24:36.647

tbl_page_collections_products 不在您的子查询 from 子句中。也许这就是你想要的：

```
SELECT
tbl_products.*,
GROUP_CONCAT(tags.name)
FROM
tbl_products,
(SELECT page_collection_name as name 
   FROM tbl_page_collections
   ,tbl_page_collections_products
   LEFT JOIN tbl_pages ON tbl_page_collections.page_id = tbl_pages.page_id 
   WHERE tbl_pages.page_name LIKE '%friends%') tags
LEFT JOIN tbl_page_collections 
  ON tbl_page_collections.page_collection_id = tbl_page_collections_products.colID 
LEFT JOIN tbl_pages 
  ON tbl_page_collections.page_id = tbl_pages.page_id 
LEFT JOIN tbl_products 
  ON tbl_products.product_id = tbl_page_collections_products.product
WHERE
 tbl_pages.page_name LIKE '%friends%' 
```

# android - 在 android ndk 中定义 sem_t

> ID：10950557
> 
> 赞同：2
> 
> 时间：2012-06-08T14:14:13.283
> 
> 标签：android, java-native-interface, semaphore, android-ndk

我正在用 C++ 从我的库中移植一些代码。

请注意，android 包含库具有 semaphore.h。

我包含了这些文件，但是在编译时它给了我一个错误：'sem_t' 没有命名一个类型。

例如在 linux 中会定义我的信号量：

```
 sem_t id; 
```

然后会调用：

```
 sem_init(&id, 0, initialCount); 
```

在我的 Application.mk 中，我正在使用：

```
 APP_STL := gnustl_static 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:10:05.230

尝试编译`-lz -lm -llog -lc -L$(call host-path, $(LOCAL_PATH))/$(TARGET_ARCH_ABI)`

或者只需将以下行添加到 Your `android.mk`：

```
LOCAL_LDLIBS += -lz -lm -llog -lc -L$(call host-path, $(LOCAL_PATH))/$(TARGET_ARCH_ABI) 
```

这个对我有用

# jquery - 在 setInterval 期间使用键更改变量

> ID：10950558
> 
> 赞同：0
> 
> 时间：2012-06-08T14:14:13.633
> 
> 标签：jquery, css, jquery-animate, keypress, setinterval

在我的动画中，“下雨”的点是随机颜色的，我希望能够通过按 ENTER 来更改颜色。对于按键我使用以下代码：

```
 $(document).keypress(function(event){
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if(keycode == '13'){
            // change variables for the colors
        }
    }); 
```

正如我所看到的，代码应该没有任何问题，但是按 ENTER 时没有任何反应。如果有人可以在这里帮助我，我会很高兴！

你可以在这里找到代码：http: [//jsfiddle.net/GsBcz/](http://jsfiddle.net/GsBcz/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:37:42.953

为什么要在每个动画调用上绑定一个事件？[event.which] 也是 jQuery 检测鼠标和按键事件的跨浏览器方式。

这应该有帮助，

[小提琴](http://jsfiddle.net/GsBcz/1/)

**HTML：**

```
<html>
<head>
        <title>Raining dots</title> 
        <link href='http://fonts.googleapis.com/css?family=Give+You+Glory' rel='stylesheet' type='text/css'> 
        <link href='http://fonts.googleapis.com/css?family=Gloria+Hallelujah' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" media="screen" href="css/style.css">
           <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script> 
        <script type="text/javascript" src="js/external.js" ></script>
</head>
        <body id="bg">
        </body>
</html>​ 
```

**JAVASCRIPT：**

```
var Capsule = {
    init: function() {

        this.c1 = 256, this.c2 = 220, this.c3 = 225;
        Capsule.callDots();
    },

    callDots: function() {

        window.setInterval(function() {
            Capsule.animateDots(Capsule.c1, Capsule.c2, Capsule.c3);
        }, 10);
    },

    animateDots: function() { 

        var theWidth = $(window).width(),
            theHeight = $(window).height(),
            randomEntry = Math.ceil(Math.random() * theWidth),
            preRandomDotSize = Math.ceil(Math.random() * 40),
            randomDotSize = preRandomDotSize + 50;

        var dotName = 'dot-' + randomEntry,
            color1 = Math.ceil(Math.random() * Capsule.c1),
            color2 = Math.ceil(Math.random() * Capsule.c2),
            color3 = Math.ceil(Math.random() * Capsule.c3),
            colors = 'rgb(' + color1 + ',' + color2 + ',' + color3 + ')';

        $('<div />', {
            text: '.',
            id: dotName,
        }).appendTo('body').addClass('theDots').css('left', randomEntry).css('font-size', randomDotSize).css('color', colors).animate({
            "top": "+=" + theHeight
        }, 5000, function() {});
    }
};
$(document).ready(function() {
    Capsule.init();
}).keypress(function(event) {
    if (event.which == '13') {
        Capsule.c1 += 2, Capsule.c2 += 4, Capsule.c3 += 6;
    }
});​ 
```

**CSS：**

```
body {
    font: 14px / 1.5em 'Gloria Hallelujah', cursive;
}

.theDots{
        position:absolute;
        top:-50px;
        left:0px;
        z-index:10;
        position:block;
}​ 
```

# jquery - 如何使用 jquery 从表单中的数据创建带有 CSS 的 div？

> ID：10950563
> 
> 赞同：0
> 
> 时间：2012-06-08T14:14:40.107
> 
> 标签：jquery, math, appendto

我计算了一些数学，然后在 div 中输出

元素。

我想做的是用 CSS 创建一个 div，它从计算结果中获取它的值......

像这样的东西-

```
$("#code-results").append("<div style=" width: "OriginalResult", margin: "MarginResult" >This is some custom text</div>"); 
```

其中 OriginalResult 和 MarginResult 是我的表单输入数学的计算结果。

但我无法让它工作。我猜这就是我添加CSS的方式。

有任何想法吗？

编辑

为了更清楚一点（这里是 JSFiddle - [http://jsfiddle.net/sturobson/mDfe6/19/](http://jsfiddle.net/sturobson/mDfe6/19/)）

JS获取表单数据并计算它然后正确appendTo的结果是这样的

函数 round(fValue, iDecimals) { var iPow = Math.pow(10, iDecimals); 返回 Math.round(fValue * iPow) / iPow; }

函数 div(fNumerator, fDenominator) { return (fDenominator == 0 ? 0 : fNumerator / fDenominator); }

$(文档).ready(函数() {

$(function(){ $("#result").submit(function(e) { e.preventDefault();

```
var ele = $("#element").val(),
    target = parseInt($("#target").val(), 10) || 0,
    context = parseInt($("#context").val(), 10) || 0,
    border = parseInt($("#border").val(), 10) || 0,
    margin = parseInt($("#margin").val(), 10) || 0,
    padding = parseInt($("#padding").val(), 10) || 0;

console.log(ele, target, context, border, margin, padding);

var DoubleMargin = margin * 2;
var DoublePadding = padding * 2;
var DoubleBorder = border * 2;

var ActualTarget = target - DoubleBorder - DoubleMargin - DoublePadding * 1;
var result3 = target - DoubleMargin * 1;
var MarginResult = round(div(margin, target) * 100, 5);
var PaddingResult = round(div(padding, target) * 100, 5);
var OriginalResult = round(div(ActualTarget, context) * 100, 5);

var BorderResult = target - border * 1;

//$(".result").append(ele + " " + result + "%");
$("<p></p>", {
    html: ele + " {<br><span>width: " + OriginalResult + "%;" + " /* " + ActualTarget + " (originally " + target + ") / " + context + " */ " + "<br>border: " + border + "px; " + "<br>margin: " + MarginResult + "%; " + "<br>padding: " + PaddingResult+ "%;" + "<br> </span>}"
}).hide().appendTo("#code-results").fadeIn();
  });

   }); 

}); 
```

我想要创建的是这种数据在提交时淡入相关数据并添加到#code-results div

```
$("#example").css({"background-color" : "red", "height" : "200px", "width" : "200px", "margin" : " + MarginResult + %", "padding" : " + PaddingResult + %", "border" : "1px solid black", "border-width" : " + border + px" }); 
```

从结果中可以看出，目前这只是创建了一个“哑”的 div。

当提交一组新的表单输入时，我也希望它能够“更新/重置”。

我问的不多我知道...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:22:22.280

```
$(document).ready(function() {
    var originalResult = 100;
    var marginResult = 100;

    $("#code-results").html("<div style='width: " + originalResult + "; margin: " + marginResult + "' >This is some custom text</div>");

}); 
```

问题是你的报价完全不合时宜。请注意，除非您对它们进行转义，否则您不能使用双引号来启动样式元素，我选择了单引号，并且还注意到样式之间的分号而不是逗号。

编辑

为了更清楚一点（这里是 JSFiddle - [http://jsfiddle.net/sturobson/mDfe6/19/](http://jsfiddle.net/sturobson/mDfe6/19/)）

JS获取表单数据并计算它然后正确appendTo的结果是这样的

```
function round(fValue, iDecimals) {
var iPow = Math.pow(10, iDecimals);
return Math.round(fValue * iPow) / iPow;
}

function div(fNumerator, fDenominator) {
    return (fDenominator == 0 ? 0 : fNumerator / fDenominator);
}

$(document).ready(function() {

$(function(){
$("#result").submit(function(e) {
    e.preventDefault();

    var ele = $("#element").val(),
        target = parseInt($("#target").val(), 10) || 0,
        context = parseInt($("#context").val(), 10) || 0,
        border = parseInt($("#border").val(), 10) || 0,
        margin = parseInt($("#margin").val(), 10) || 0,
        padding = parseInt($("#padding").val(), 10) || 0;

    console.log(ele, target, context, border, margin, padding);

    var DoubleMargin = margin * 2;
    var DoublePadding = padding * 2;
    var DoubleBorder = border * 2;

    var ActualTarget = target - DoubleBorder - DoubleMargin - DoublePadding * 1;
    var result3 = target - DoubleMargin * 1;
    var MarginResult = round(div(margin, target) * 100, 5);
    var PaddingResult = round(div(padding, target) * 100, 5);
    var OriginalResult = round(div(ActualTarget, context) * 100, 5);

    var BorderResult = target - border * 1;

    //$(".result").append(ele + " " + result + "%");
    $("<p></p>", {
        html: ele + " {<br><span>width: " + OriginalResult + "%;" + " /* " + ActualTarget + " (originally " + target + ") / " + context + " */ " + "<br>border: " + border + "px; " + "<br>margin: " + MarginResult + "%; " + "<br>padding: " + PaddingResult+ "%;" + "<br> </span>}"
    }).hide().appendTo("#code-results").fadeIn();
  });

}); 

}); 
```

我想要创建的是这种数据在提交时淡入相关数据并添加到#code-results div

```
$("#example").css({"background-color" : "red", "height" : "200px", "width" : "200px", "margin" : " + MarginResult + %", "padding" : " + PaddingResult + %", "border" : "1px solid black", "border-width" : " + border + px" }); 
```

从结果中可以看出，目前这只是创建了一个“哑”的 div。

当提交一组新的表单输入时，我也希望它能够“更新/重置”。

我问的不多我知道...

# c++ - 带有 Visual C++ 11 的 Qt Creator

> ID：10950565
> 
> 赞同：2
> 
> 时间：2012-06-08T14:14:48.070
> 
> 标签：c++, visual-studio, qt, qt-creator

我想将 Qt Creator 与 MS VC++ 11 一起使用，但它说没有构建 Qt 的工具链。我使用完整的 SDK 安装程序安装了 Qt。现在做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T07:15:25.147

MSVC++ 11 不是自带 Visual Studio 11 吗？如果是这样，那么 Qt 不支持`makespec`该版本的文件 AFAIK（如果我错了，请纠正我）。`MSVC 2010 nmake/cl`但以下是使用工具链运行 Qt Creator 的（粗略）步骤。

1.  `msvc-2010`从此[站点](http://qt.nokia.com/downloads)下载使用工具链编译的 Qt SDK 4.8.2 （第二页）。
2.  安装包含`nmake/cl/cdb`可执行文件的 MS VC++ 2010 免费开发工具（或完整的 SDK）。
3.  重启PC，初始化环境变量等。
4.  开始`Qt Creator`，现在您会注意到`msvc-2010`工具链已被 Qt Creator 识别（工具 -> 选项对话框）。如果没有，则手动添加它。
5.  还要确认 Qt 版本 4.8.2`msvc-2010`已在`Qt Versions`选项卡中标识。如果没有，则通过提供 Qt SDK 文件夹的路径手动添加`qmake`它`bin`。它还将`msvc-2010`自动选择工具链。
6.  在这里，现在转到项目并在构建设置中，选择`msvc-2010`工具链并编译。确保`win32-msvc2010`被选为`makespec`文件。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:08:18.410

尝试使用 Visual Studio 2010 的 makespec 构建。

`SET QMAKESPEC=win32-msvc2010`

在运行 configure 和 qmake 之前应该完成这项工作

# ruby - 如何使用 ruby Net::telnet cmd 方法发送“ctrl+z”？

> ID：10950573
> 
> 赞同：1
> 
> 时间：2012-06-08T14:15:24.513
> 
> 标签：ruby, telnet

这是我的secnario，

我正在用 Net::Telnet::new 编写一个 ruby​​ 客户端，另一端服务器是一个 ubuntu。我添加了一个事件机器来监视由 Net::Telnet::new 创建的套接字。

这是我的问题，例如，我使用 cmd 方法发送命令：

client.cmd("ping 127.0.0.1") 然后eventmachine继续输出响应。我想停止 ping 进程并停止 ping 响应，所以我需要向服务器发送命令“Ctrl+z”或其他内容（就像我们使用 telnet 终端时一样）。

那么我怎样才能用红宝石做到这一点？我试过 238.chr、237.chr、236.chr。那些没有用。我也尝试发送 26.chr，这个停止了一些东西。但是我的代码挂在那里，在我发送 26.chr 后，我无法使用 cmd 方法发送另一个命令。

这是一些代码，请忽略ws.onopen，ws.onmessage，这些只是eventmachine中的websocket。

```
 ws.onopen    { 
                puts "Web socket is opened"
                ws.send "terminal to the node"
                          $nodeSocket = Net::Telnet::new("Host" => "10.4.0.50","Timeout" => 10,"Prompt" => /login/ )
                          puts $nodeSocket

                $nodeSocket.cmd("String" =>"user","Match" => /Password/) { |c| ws.send c}
                $nodeSocket.cmd("String" => "password","Match" => /\$/) { |c| ws.send c}

               Thread.new do  
                   EM.run{
                          $conn = EM.watch $nodeSocket.getSocket,Foo,ws
                          $conn.notify_readable = true
                   }
                end

      }

      ws.onmessage { |msg| 
                begin 
                    puts msg

                      if msg =~ /command:(.*)/
                        puts $1
                        if $1 == "stop" 

                              $nodeSocket.cmd(26.chr) 
                              $nodeSocket.cmd("ls -l") 
                              $nodeSocket.cmd("pwd") 

                        else 

                              $nodeSocket.cmd($1) 
                        end
                      end
                      ws.send msg
                rescue
                    puts "there's an error happened"
                end

      } 
```

# c# - 如果进程崩溃/挂起，请避免锁定服务

> ID：10950574
> 
> 赞同：1
> 
> 时间：2012-06-08T14:15:27.767
> 
> 标签：c#, c#-4.0

我目前正在开发一个实现[fileSystemWatcher](http://msdn.microsoft.com/en-us/library/x7t1d0ky)的 Windows 服务。视频被上传到一个文件夹中，此时 filewatcher 触发创建的事件，如下所示以转换视频。

```
private void fileSystemWatcher_Created(object sender, System.IO.FileSystemEventArgs e)
{
  if (ConvertVideo(e.FullPath, e.Name))
  {
    WriteToEventLog(String.Format("Successfully converted video - {0}", e.FullPath), EventLogEntryType.Information);
  }            
} 
```

在`ConvertVideo`创建一个新进程中，但我遇到了进程崩溃/挂起/消失的问题，并且似乎主线程随后被锁定，因为它正在等待`WaitForExit()`有效地使服务崩溃，因为随后无法转换其他视频。如果进程终止，我如何避免锁定整个服务？

```
private bool ConvertVideo(string SourcePath, string Filename)
{   
   try
   {
      // Create new process
      ProcessStartInfo startInfo = new ProcessStartInfo();
      startInfo.CreateNoWindow = false;
      startInfo.UseShellExecute = false;
      startInfo.FileName = "C:\Handbrake\HandBrakeCLI.exe";
      startInfo.WindowStyle = ProcessWindowStyle.Hidden;
      startInfo.Arguments = GetArguments(SourcePath, Filename);
      int? exitCode = null;
      using (Process exeProcess = Process.Start(startInfo))
      {
        exeProcess.WaitForExit();
        exitCode = exeProcess.ExitCode;
      }
   }
   catch(Exception ex)
   {
     return false;
   }
} 
```

*注意：此示例的代码已缩短*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:26:35.853

根据 MSDN，如果您的进程崩溃， [Process.WaitForExit](http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx)应该返回（强调添加）：

> 当关联的进程退出时（即当它被操作系统通过**正常或异常终止而****关闭时**），系统会存储有关该进程的管理信息并返回到调用了 WaitForExit() 的组件。

 **您的 HandBrake 过程似乎只是挂起并保持活力。最好的解决方案是调试该进程并找出它崩溃的位置，但不要关闭。您是否有权访问 HandBrakeCLI.exe 代码？

**如果您无权访问 HandBrake.exe 代码：**您可以使用[Process.WaitForExit(Int32)](http://msdn.microsoft.com/en-us/library/ty0d8k56.aspx)设置超时。如果达到超时，您可能希望通过[Process.Kill函数手动终止您的进程，否则对](http://msdn.microsoft.com/en-us/library/2y3s566a)[Process.Start(ProcessStartInfo)](http://msdn.microsoft.com/en-us/library/0w4h05yb)的所有后续调用都将无法正常工作，因为它们只会在进程不存在的情况下返回一个新进程正在运行：

> 与流程资源关联的新流程组件，**如果没有启动流程资源（例如，如果重用现有流程），则为 null**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:22:58.050

1）您应该生成您的进程并等待它在单独的线程中终止，以避免阻塞您的主线程。

2）您可以使用[`WaitForExit`等待进程的最大时间作为参数的方法](http://msdn.microsoft.com/en-us/library/ty0d8k56.aspx)。然后，您将能够避免程序线程被永远阻塞的情况。**

# php - PHP Array_intersect 在具有未知键数的多维数组上

> ID：10950577
> 
> 赞同：3
> 
> 时间：2012-06-08T14:15:36.120
> 
> 标签：php, arrays, multidimensional-array, array-intersect

我正在尝试在包含资源（人员）的应用程序中制作高级搜索过滤器。我在 1 个多维数组中得到了所有结果。该应用程序的用户可以搜索人的职位、技能、工作领域和国家。

我已经完成了查找符合用户给出标准的人的部分。这些结果存储在一个多维数组中。如果用户正在寻找具有职位和特定技能的特定资源的人，则返回值是这样的：

```
$realfilters = array(2) {
["resourcesWithJobtitle"]=> array(6) {
   [0]=> string(1) "1"
   [1]=> string(2) "48"
   [2]=> string(2) "88"
}
["resourcesWithSkill"]=> array(9) {
   [0]=> string(1) "4"
   [1]=> string(1) "8"
   [2]=> string(1) "48"
   [3]=> string(2) "50"
} 
```

当用户还查找工作字段时，这将添加到结果中：

```
["resourcesWithWorkfield"]=> array(3) {
   [0]=> string(2) "48"
   [1]=> string(2) "96"
   [2]=> string(2) "97"
} 
```

我需要知道哪些资源满足数组的所有维度，以便显示它们。（所以在这个例子中，我需要一个只有 1 个值的数组：48）。我想我需要使用`array_intersect`，但似乎无法正确使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:31:50.300

一种可能的解决方案：您可以首先[`extract()`](http://php.net/manual/en/function.extract.php)将`$realfilters`数组值应用于变量，然后将其`array_intersect()`应用于它们。但是这个解决方案只有在没有很多可能的过滤器时才适用。

另一种可能是最好的解决方案是在一个循环中相交，例如：

```
$res_arr = array_shift($realfilters);
foreach($realfilters as $filter){
     $res_arr = array_intersect($res_arr, $filter);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T15:28:15.413

```
$intersection = call_user_func_array('array_intersect', $array); 
```

这将为您提供$array 的*所有*子数组中存在的元素。

编辑-上面的这就像一个写作的捷径：

```
$intersection = array_intersect($array['a'], $array['b'], ...and so on for all elements...); 
```

也可以使用循环

```
$intersection = reset($array);
foreach ($array as $subarr) {
    $intersection = array_intersect($intersection, $subarr);
}
print_r($intersection); 
```

# jquery - 单击元素时重播 youtube 视频

> ID：10950586
> 
> 赞同：0
> 
> 时间：2012-06-08T14:16:13.800
> 
> 标签：jquery, youtube-javascript-api

我有一个 div 元素，它是一个链接，我希望它能够再次播放视频。我的 jQuery 代码是这样的：

```
$('#film').click(
function() {
    $('#question').hide();
    $('#video').show();
}); 
```

我知道 YouTube javascript API 有一个`player.playVideo()`函数，但我不知道如何在我的 jQuery 函数中实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:55:26.967

我发现在[Hidden youtube player 的帮助下失去了它的方法](https://stackoverflow.com/questions/2197868/hidden-youtube-player-loses-its-methods)，这是因为我隐藏并显示了播放器。我将其更改`$('#video').css('visibility','hidden');`为隐藏和`$('#video').css('visibility','visible');`显示它并且它有效。我的最终代码是：

```
function play() {
  if (ytplayer) {
    ytplayer.playVideo();
  }
}

$('#film').click(
function() {
    $('#question').hide();
    $('#video').css('visibility','visible');
    play();
}); 
```

# filemaker - 如何获取值列表？

> ID：10950591
> 
> 赞同：2
> 
> 时间：2012-06-08T14:16:32.237
> 
> 标签：filemaker

我有一个`Targets`具有唯一 ID`number`和字段的表`data`。我想得到一个包含 in 的所有值的列表`number`，`Targets`所以这个列表（最好用逗号分隔）最终可以作为 Web 视图中的 JS 数组。

在 SQL 中，它会很简单

```
SELECT number FROM Targets 
```

但是我在 FileMaker Pro Advanced 11 中找不到任何合理的方法。我认为该`List`功能可能是它，但由于某种原因，它不会列出我所有的行。

如果你能做相当于

```
SELECT number, data FROM Targets 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:31:41.243

在**Targets**表上，添加一个看起来像 javascript 数组文字的计算字段（例如**ID Data Array ）：**

```
"[" & number & "," & data & "]" 
```

**在与Targets**表出现（例如**Targets All** ）具有跨产品关系的布局上，添加一个 Web 视图组件，其内容类似于以下计算内容：

```
"data:text/html,¶" &
"<!DOCTYPE html PUBLIC " & Quote ( "-//W3C//DTD XHTML 1.0 Strict//EN" ) & "¶" &
Quote ( "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" ) & ">¶" &
"<html xmlns=" & Quote ( "http://www.w3.org/1999/xhtml" ) & ">¶" &
"<head>¶" &
"<meta http-equiv=" & Quote ( "content-type" ) & " content=" & Quote ( "text/html; charset=utf-8" ) & " />¶" &
"<title>Table Data</title>¶" &
"<script type=" & Quote ( "text/javascript" ) & " src=" & Quote ( "script.js" ) & " ) & ">¶" &
"var dataArray = [ " & Substitute ( List ( Targets All::ID Data Array ) ; "¶" ; "," ) & "];¶" &
"</script>¶" &
"</head>¶" &
"<body>¶" &

"</body>¶" &
"</html>" 
```

关键组件是这样的：

```
"var dataArray = [ " & Substitute ( List ( Targets All::ID Data Array ) ; "¶" ; "," ) & "];¶" 
```

这使用**List**函数将所有相关的**ID 数据数组**字段整理到一个 ¶ 分隔的列表中。

然后它使用**Substitute**函数将 ¶ 字符替换为逗号，这样你就得到了一个很好的逗号分隔的数组列表。

最后，它将它包装在一个 javascript 变量声明中，这样您就可以在页面的其余部分中使用变量**dataArray 。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T02:03:35.057

如果您使用的是 FileMaker Pro 11，请使用其中一个 SQL 插件来查询自身。或者，升级到 v12 并使用新的 SQL 命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T15:45:30.590

最简单的方法，可能看起来像一个黑客，但不是，是制作一个价值清单。设置一个值列表以显示“数字”中的所有值。FileMaker 会自动将所有值合并到一个由返回分隔的唯一值列表中。然后你可以通过运行计算得到列表：

```
 ValueListItems( Get(FileName) ; "AND-PUT-YOUR-VALUELIST-NAME-HERE") 
```

# java - 监控机器上的 tcp 缓冲区大小

> ID：10950593
> 
> 赞同：0
> 
> 时间：2012-06-08T14:16:38.473
> 
> 标签：java, profiling, buffer, tcp-ip

我必须分析基于 TCP 的客户端服务器 Java 应用程序，其中一部分是监视 TCP 发送和接收缓冲区大小（实时，当消息流过时，例如使用 VisualVM 监视正在运行的应用程序的内存和线程） . 什么是最好的方法/工具？

# spring-batch - 在循环中执行 Spring Batch ItemReader 并传递 IN 参数

> ID：10950596
> 
> 赞同：1
> 
> 时间：2012-06-08T14:16:45.823
> 
> 标签：spring-batch

我是 Spring Batch 的新手。我有以下问题。

我正在使用 Spring Batch 来开发批处理。我有一个 java 数组，里面有一些 'process_id' 值。我想要做的是我需要使用 ItemReader 调用数据库存储过程的每个“process_id”。谁能帮我写 ItemReader 来实现这一点？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:28:10.527

您应该按照设计考虑您的阅读器：阅读器应该提供 ID 集合。它将每个 ID 传递给将调用您存储过程的编写器。

读者的目标是找到要处理的数据。然后将每个数据发送到写入器（或处理器，取决于您的批处理设计）。

# wordpress - 自定义帖子类型设置了 show_in_menu 时缺少分类菜单

> ID：10950601
> 
> 赞同：3
> 
> 时间：2012-06-08T14:17:07.530
> 
> 标签：wordpress, menu, custom-post-type, custom-taxonomy

我用分类法创建了一个自定义帖子类型，一切正常。WordPress 创建一个主菜单：

```
MyCustomPost
   +----------> MyCustomPost
   +----------> Add New
   +----------> My Taxonomy 
```

但是，我喜欢创建自己的菜单，如下所示：

```
MyTitle
   +----------> MyCustomPost
   +----------> Add New
   +----------> My Taxonomy 
```

所以，我创建了一个自己的菜单：

```
 $menu_main = add_menu_page( 'MyMenu', 'MyMenu', 'edit_posts', 'my_menu_key', array( $this, 'menu_main'), $icon_menu, 100 ); 
```

注册我设置的自定义帖子类型时，我`show_in_menu`使用`my_menu_key`, 及其作品。

```
MyMenu
   +----------> MyCustomPost 
```

问题是：分类学在哪里？和`添加新子菜单？任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-07T17:21:23.470

您可以通过使用内置的 WordPress 函数来实现这一点，而不是操纵 $submenu 全局，以获得更好的未来兼容性。

```
add_action('admin_menu', 'add_tax_menus');
function add_tax_menus() {
    $key = 'edit.php?post_type=CUSTOM_POST_TYPE_SLUG';
    add_submenu_page($key, 'My Page Title', 'My Menu Title', 'manage_categories', 'edit-tags.php?taxonomy=TAXONOMY_SLUG&post_type=CUSTOM_POST_TYPE_SLUG');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T18:01:08.287

很好的把戏`show_in_menu`。但是分类子菜单是以[*硬编码的*](http://core.trac.wordpress.org/browser/tags/3.6/wp-admin/menu.php#L128)[方式](http://core.trac.wordpress.org/browser/tags/3.6/wp-admin/menu.php#L128)[构建的](http://core.trac.wordpress.org/browser/tags/3.6/wp-admin/menu.php#L128)*，`register_taxonomy` [不采用任何](http://core.trac.wordpress.org/browser/tags/3.6/wp-includes/taxonomy.php#L314)类似的参数。可能，*添加新*子菜单的工作方式相同。*

 *一种解决方法是操纵`global $submenu`：

```
// PHP 5.3+ anonymous function
add_action( 'admin_init', function() {
    global $submenu; 
    $submenu['my_menu_key'][10] = $submenu['edit.php?post_type=YOUR-CPT-SLUG'][10];
    $submenu['my_menu_key'][15] = $submenu['edit.php?post_type=YOUR-CPT-SLUG'][15];
}); 
```*

# database - Access 2007 中的更新后事件

> ID：10950605
> 
> 赞同：1
> 
> 时间：2012-06-08T14:17:32.333
> 
> 标签：database, ms-access-2007

我有一个用于网站的 Access 2007 数据库。用户可以在网站上创建事件，一旦创建事件，它可以设置为“活动”或“非活动”。此外，当创建事件时，会在日历表中为该事件创建一个条目。我想要发生的是，当一个事件设置为“非活动”时，我希望从日历表中删除该事件。理想情况下，我想将触发器添加到表中，但 Access 2007 没有这些。有没有其他方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:58:29.940

INNER JOIN 在日历和事件表的公共字段（event_id？）上。然后添加一个 WHERE 子句：

```
WHERE Events.Status = 'Active' 
```

该查询将忽略非活动事件的日历行。

# html - 视口 2/3 为空，缩小 1/3

> ID：10950612
> 
> 赞同：-1
> 
> 时间：2012-06-08T14:18:05.793
> 
> 标签：html, css, windows-mobile, viewport

为什么我的 Windows Phone 上的 URL [http://beta.dealer24x7.com](http://beta.dealer24x7.com)无法填满屏幕？

我缺少什么 CSS 或 META 标签？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:08:19.583

尝试添加此元标记：

```
<meta name="viewport" content="width=device-width; initial-scale=1.0;
maximum-scale=1.0; user-scalable=0;" /> 
```

# facebook - Facebook Pages - 如何获取访问令牌权限 - 图 api 上用户的“权限”？

> ID：10950613
> 
> 赞同：2
> 
> 时间：2012-06-08T14:18:07.710
> 
> 标签：facebook, facebook-graph-api, facebook-access-token

由于 Facebook 在页面 (http://developers.facebook.com/docs/reference/api/page/) 上添加了**页面管理员角色**，因此在通过 graph.facebook.com/me/accounts?access_token=XXXX 获取令牌时，它会列出：

*“烫发”：[

```
 "ADMINISTER",
        "EDIT_PROFILE",
        "CREATE_CONTENT",
        "MODERATE_CONTENT",
        "CREATE_ADS",
        "BASIC_ADMIN"

     ]* 
```

我们如何知道在获得页面访问令牌后这些是否发生了变化 - 例如：如果用户在我获得令牌后失去了管理员角色，我们如何检查？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T14:04:46.533

我相信你最好的选择是投票。如果您处于需要了解权限的位置，请`me/accounts`再次 GET 以查看权限是什么。

这往往是我使用的方法 - 在我的应用程序中，我每天重建一次令牌和帐户之间的关系。

您的另一个选择是捕获错误 - 如果`myusersapp/insights`失败，您假设他们已经失去了权限并更新关系。您将在这里面临的问题是洞察力时不时地下降，您将无法以这种方式检测对新页面的权限。

# eclipse - 是否可以一次向 PyDev 添加多个环境变量？

> ID：10950614
> 
> 赞同：0
> 
> 时间：2012-06-08T14:18:13.307
> 
> 标签：eclipse, pydev

使用 Eclipse 运行 PyDev，我可以在 Run Configurations 窗口中看到如何添加环境变量。您只需单击添加并提供名称和值。

我需要将其中的 20 多个添加到至少两个配置中。一次添加一个是……次优的。似乎没有一次添加多个的功能。

有没有办法一次添加多个环境变量？如果有帮助，我已经将它们列为文件中`=`的 - 分隔对`.txt`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T11:32:36.620

您应该能够将启动配置保存为文件：

运行 > 运行配置 > 选择启动 > 选择常用选项卡 > 另存为 > 共享文件：说出要保存的位置。

然后，您可以添加一个示例变量，只是为了知道如何输入它，打开 .launch 文件并将其编辑为文本以添加您想要的变量。

但是，请注意，这可能不是您所追求的……如果您始终拥有相同的变量，您可以简单地创建一个 .bat 以在 shell 中配置这些变量并从该 shell 启动 eclipse 以继承那些变量。

或者，如果您已经在 shell 中配置了它们，您可以在环境选项卡中选择它们（而不是每次都输入“新”，您可以单击“选择”并使用已经预先配置的值一次添加多个变量） .

或者，如果这些变量依赖于解释器，您可以在解释器配置中配置它们（窗口 > 首选项 > pydev > intererpreter - python > 环境）。

# java - Android 4.0 上的微调器

> ID：10950617
> 
> 赞同：2
> 
> 时间：2012-06-08T14:18:20.843
> 
> 标签：java, android, debugging, android-view, android-spinner

我创建了一个应用程序并一直在针对 targetSdk 14 对其进行测试。微调器几乎不可见。我在朋友的手机上试了一下，还是一样的。这是默认微调器的样子吗？这不好。edittext 也是如此。有什么意见吗？

![在此处输入图像描述](../Images/db6439fb3b73fdb6fe0a590f9d461650.png)

看到右边那个小三角形了吗？这是唯一表明那里有物体的东西。

![在此处输入图像描述](../Images/9a3e28290cb0c04c5485128f2e837360.png)

这是一张关于按钮在 4.0 上的样子的照片。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:31:33.867

是的，这是默认的微调器。Android 设计网站[还有更多内容。](http://developer.android.com/design/building-blocks/spinners.html)

我认为您的问题是您在白色背景上使用了 Holo.Dark 微调器。如果您的应用程序有白色背景，最好使用 Holo.Light，它将使所有控件保持合理的对比度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T14:33:07.313

也许您`Spinner`处于“禁用”状态。disabled 的轮廓`Spinner`比正常的 (enabled) 略轻`Spinner`。这可能是它与明亮的白色背景混合的原因。

请参阅下面的 Holo Dark 和 Holo Light 主题中的几个`Spinner`s，处于各种状态（来源：[Android Design](http://developer.android.com/design/building-blocks/spinners.html)）。

![Holo Dark 和 Holo Light 主题中的微调器，在不同的州。](../Images/29e23b87c3c366d57bd03cb67673c405.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-09T09:39:36.407

是的，这是默认的 4.0 微调器。我正在接受我自己的答案，因为我正在提供解决方案。它没有被禁用，只是看起来不可见。虽然我将它设置为启用它使它变得更好（对于其他人：setEnabled 命令只存在于 java 代码中，在 xml 中它不存在））。然后我调整了一个自定义微调器以使文本可见，因为微调器没有文本颜色。

我将微调器项放在 values 文件夹中的 arrays.xml 中：

```
<resources>
    <string-array name="duration">
        <item>Top 5 duration of outgoing calls</item>
        <item>Top 5 duration of incoming calls</item>
        <item>Top 5 duration of all calls</item>
    </string-array>
</resources> 
```

创建了一个 spinner.xml 作为微调器文本的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView android:id="@+id/spinnerText" 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
    android:layout_centerHorizontal="true"
    android:textColor="#000000" 
    android:textSize="16dp" 
    xmlns:android="http://schemas.android.com/apk/res/android"/> 
```

然后我将这些设置为适配器：

```
ArrayAdapter<CharSequence> adapter_spinner = ArrayAdapter.createFromResource(ChartsDuration.this, R.array.duration, R.layout.spinner);
        adapter_spinner.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item); 
```

正如您在照片上看到的，4.0 上的按钮文本是白色的，这很糟糕。解决方案很容易将文本颜色设置为黑色，即使在 sdk < 11 上它默认为黑色。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T14:32:11.907

这就是默认微调器的样子，一个三角形和下划线......除了你显示的那个看起来被禁用。

[Android 设计](http://developer.android.com/design/building-blocks/spinners.html)页面显示了不同状态的明暗主题。

# sql-server - 用新行修复 CSV 文件

> ID：10950622
> 
> 赞同：0
> 
> 时间：2012-06-08T14:18:36.370
> 
> 标签：sql-server, regex, csv, newline

我使用 SQL Server Management Studio 对 MS SQL 数据库进行了查询，其中一些字段包含新行。我选择将结果保存为 csv，显然 MS SQL 不够聪明，无法为我提供格式正确的 CSV 文件。

其中一些带有新行的字段用引号括起来，但有些不是，我不知道为什么（如果它们包含多个新行，它似乎会引用字段，但如果它们只包含一个新行，则不会，谢谢微软，这很有用）。

当我尝试在 Excel 中打开此 CSV 时，由于新行，某些行是错误的，它认为一行是两行。

我怎样才能解决这个问题？

我在想我可以使用正则表达式。也许是这样的：

```
/,[^,]*\n[^,]*,/ 
```

问题在于它匹配一行的最后一个元素和下一行的第一个元素。

这是一个演示该问题的示例 csv：

```
field a,field b,field c,field d,field e
1,2,3,4,5
test,computer,I like
pie,4,8
123,456,"7

8

9",10,11
a,b,c,d,e 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:39:52.763

一个简单的正则表达式替换不起作用，但这是一个基于以下的解决方案`preg_replace_callback`：

```
function add_quotes($matches) {
    return preg_replace('~(?<=^|,)(?>[^,"\r\n]+\r?\n[^,]*)(?=,|$)~',
                        '"$0"',
                        $matches[0]);
}

$row_regex = '~^(?:(?:(?:"[^"*]")+|[^,]*)(?:,|$)){5}$~m';

$result=preg_replace_callback($row_regex, 'add_quotes', $source); 
```

秘诀`$row_regex`是提前知道有多少列。它从一行的开头开始（`^`在多行模式下）并使用接下来的五个看起来像字段的东西。它没有我想要的那么有效，因为它总是在最后一列上过冲，在回溯到行尾之前消耗“真实”行分隔符和下一行的第一个字段。如果您的文档非常大，那可能是个问题。

如果您事先不知道有多少列，您可以通过仅匹配第一行并计算匹配项来发现这一点。当然，这假设该行不包含任何导致问题的时髦字段。如果第一行包含列标题，您不必担心这一点，也不必担心合法的引用字段。我是这样做的：

```
preg_match_all('~\G,?[^,\r\n]++~', $source, $cols);

$row_regex = '~^(?:(?:(?:"[^"*]")+|[^,]*)(?:,|$)){' . count($cols[0]) . '}$~m'; 
```

您的示例数据仅包含换行符 ( `\n`)，但我也允许使用 DOS 样式`\r\n`。（由于该文件是由 Microsoft 产品生成的，我不会担心旧的 Mac 风格的 CR-only 分隔符。）

**[查看在线演示](http://ideone.com/S8kkx)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:25:10.423

如果您需要 Java 编程解决方案，请使用 OpenCSV 库打开文件。如果是手动操作，则在 Vim 等文本编辑器中打开文件并运行替换命令。如果是批处理操作，可以使用 perl 命令清理 CRLF。

# php - Node.js 与传统 PHP 框架：如何结合？

> ID：10950625
> 
> 赞同：0
> 
> 时间：2012-06-08T14:18:52.860
> 
> 标签：php, javascript, node.js

Node.js 给我留下了深刻的印象，但在想象如何组合两个不同的服务器端应用程序时遇到了一些小问题。

例子：

想象一下，你有一些小的 Facebook 克隆。现在让 node.js（或 express）处理聊天功能是个好主意。

我是否应该知道只使用 node.js 来完成这个单一任务，并且如果我知道想要通过 PHP 访问主应用程序中的一些聊天消息，而不是仅仅使用一些 orm 或 odm 获取聊天消息？那么只有数据库是 JavaScript 和 PHP 服务器端之间的连接器吗？

这两个世界的发展不会让事情变得更难吗？

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:24:34.917

作为第一种方法，您可以执行以下操作（我们已经实现并且工作正常）：

1.  PHP 到 nodejs 通信：在 nodejs 中实现一个“处理程序”来监听从 php 向它发起的 curl 请愿。

2.  nodejs 到 php：在 nodejs 中使用 http.get() 方法在你的 php 应用程序中调用某种 api

简单而强大:)

# javascript - 需要 Google 地图 API 3 帮助

> ID：10950626
> 
> 赞同：0
> 
> 时间：2012-06-08T14:18:53.027
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在为我的应用程序使用谷歌地图 API 3。

所以我想做的是下一步。加载页面时，我将获得以下格式的位置数组：

```
var locations = [
  ['Bondi Beach', -33.890542, 151.274856, 4],
  ['Coogee Beach', -33.923036, 151.259052, 5],
  ['Cronulla Beach', -34.028249, 151.157507, 3],
  ['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
  ['Maroubra Beach', -33.950198, 151.259302, 1]
]; 
```

首先，我想为每个位置添加标记

```
var marker, i;

    for (i = 0; i < locations.length; i++) {  
      marker = new google.maps.Marker({
        position: new google.maps.LatLng(locations[i][1], locations[i][2]),
        map: map
      }); 
```

标记上的图片：

```
var image = new google.maps.MarkerImage("images/truck3.png",
        new google.maps.Size(32.0, 37.0),
        new google.maps.Point(0, 0),
        new google.maps.Point(16.0, 18.0)
    );
  var shadow = new google.maps.MarkerImage("images/shadow-truck3.png",
        new google.maps.Size(51.0, 37.0),
        new google.maps.Point(0, 0),
        new google.maps.Point(16.0, 18.0)
    );

  var marker = new google.maps.Marker({
    position: map.getCenter(),
    map: map,
    icon: image,
    shadow: shadow,
    title: 'Click to zoom'
  }); 
```

这应该缩放在屏幕中心初始化的所有标记，但在开始时只有一次，稍后中心不使用，因为用户可能会钓鱼以查看地图上的其他内容。

我希望标记一直在移动，所以也许我需要添加一些事件处理程序来一直获取新位置？

然后是当您单击标记时的部分，您已缩放并且标记仍在移动（获取新位置）但现在我需要使用我将在 php 数组中发送的那个 ID，以便我可以使用该参数调用一些 php 函数.

之后，当用户单击侧面的按钮时，我希望能够在我的请求开始时出现，这意味着在屏幕中央加载了标记。

点击部分：

```
 google.maps.event.addListener(marker, 'click', function() {
    map.setZoom(13);
    map.setCenter(marker.getPosition());
    google.maps.event.addListener(map, 'center_changed', function() {
    // 1 seconds after the center of the map has changed, pan back to the
    // marker.
    window.setTimeout(function() {
      map.panTo(marker.getPosition());
    }, 1000);
  });
  });
} 
```

所以基本上我告诉了你我想要实现的一切，我相信你们中的很多人都做了同样的事情。这些是来自很多来源的代码的一部分，我需要让它们一起工作并添加一些我上面写的更小的新功能。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T00:04:05.193

因此，听起来您正在`locations`通过每隔几秒重复一次的数据库查询来检索变量。在此演示中，我使用 JSON 来检索数据，并更新位置或创建标记（如果它尚不存在）。

[http://freezoo.alwaysdata.net/truck2.html](http://freezoo.alwaysdata.net/truck2.html)

```
 function updateTrucks() {
      $.ajax({
        url: "gettruck.php",
        cache: false,
        dataType: 'json',
        data: {},
        error: function(jqxhr, textStatus, errorThrown) {
          alert("Error: " + textStatus + " " + errorThrown);
        },
        success: function(data) {
        for(var i = 0; i < data.results.length; i++) {
          if(trucks.hasOwnProperty(data.results[i].id)) {
            // update position
            trucks[data.results[i].id].setPosition(new google.maps.LatLng(
              parseFloat(data.results[i].lat),
              parseFloat(data.results[i].lng)));
            trucks[data.results[i].id].speed = data.results[i].speed;
          }
          else {
            // create new marker
            trucks[data.results[i].id] = new google.maps.Marker({
              map: map,
              position: new google.maps.LatLng(
                parseFloat(data.results[i].lat),
                parseFloat(data.results[i].lng)),
              title: data.results[i].name,
              id: data.results[i].id
            }); 
```

在您的应用程序中，数据库将通过某种方式进行更新，在这里，数据库是静态的，并且移动（用于演示）是使用 PHP 人工创建的`rand`，因此每隔几秒钟，标记就会出现在不同的位置。

```
header("Content-type: application/json");
echo '{ "results" : [ ';

$gettruck_result = $dbh->query("SELECT * FROM `truck`");
$result_array = array();

foreach($gettruck_result as $row) {
  $newlat = $row['lat'] + (0.0025 * rand(-3,3));
  $newlng = $row['lng'] + (0.0025 * rand(-3,3));

  $speed = $row['speed'] + rand(1,8);

  $row_object = '{';
  $row_object .= '"id": "' . $row['id'] . '", ';
  $row_object .= '"speed": "' . $speed . '", ';
  $row_object .= '"name": "' . $row['name'] . '", ';
  $row_object .= '"lat": "' . $newlat . '", ';
  $row_object .= '"lng": "' . $newlng . '"';
  $row_object .= '}';    
  $result_array[] = $row_object;
}

$result_str = implode(", ", $result_array);
echo $result_str;
echo " ] }"; 
```

跟踪标记由两个侦听器完成：

```
 google.maps.event.addListener(trucks[data.results[i].id], 'position_changed', function() {
          if(typeof tracked !== "undefined") {
            if(this.id == tracked.id) {
              map.panTo(this.getPosition());
              $("#speed").val(this.speed);
            } 
          } 
        });         

        google.maps.event.addListener(trucks[data.results[i].id], 'click', function() {
          $("#trackedId").val(this.id);
          map.setZoom(13);
          map.setCenter(this.getPosition());
          tracked = this;
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T14:57:37.607

此文件[Geocoder.htm](http://www.calvert.ch/download/Geocoder.htm)包含实现您尝试执行的操作所需的所有代码（带有 ID 和附加操作的可点击图标列表等）。

只需取消注释第 449-460 行，您就可以看到它是如何工作的。

欢迎您获取源代码并根据需要使用它，它是开源的。

# android - 菜单充气机未在模拟器中显示

> ID：10950627
> 
> 赞同：0
> 
> 时间：2012-06-08T14:18:55.593
> 
> 标签：android

菜单未显示在我的 emulator.menu 代码在 home.java 类中实现，inflator 使用菜单但未在 emulator 上显示。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.home);
}

public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater Inflater = getMenuInflater();
    Inflater.inflate(R.layout.menu, menu);
    return(super.onCreateOptionsMenu(menu));
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if (item.getItemId() == R.id.logout) {
        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
        SharedPreferences.Editor editor = settings.edit();
        editor.remove("logged");
        editor.commit();
        finish();
    }
    return super.onOptionsItemSelected(item);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:36:09.117

正如[Vipul Shah](https://stackoverflow.com/users/758104/vipul-shah)所说，您应该更改此行：

```
Inflater.inflate(R.layout.menu, menu); 
```

到

```
Inflater.inflate(R.menu.menu, menu); 
```

之后 - 替换你的`menu.xml`to`res/menu`而不是`res/layout`.

那么你显然应该返回 true 而不是返回 super 方法的结果。你的代码应该是这样的：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater Inflater = getMenuInflater();
    Inflater.inflate(R.menu.menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch(item.getItemId()) {
    case R.id.logout :
        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
        SharedPreferences.Editor editor = settings.edit();
        editor.remove("logged");
        editor.commit();
        finish();
        return true;
    default: return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:36:25.383

> 改变这个

```
Inflater.inflate(R.layout.menu, menu); 
```

> 至此

```
Inflater.inflate(R.menu.menu, menu); 
```

将 menu.xml 放入**res/menu**文件夹。

# java - 为什么我的 JTextarea 不能正确换行？

> ID：10950631
> 
> 赞同：2
> 
> 时间：2012-06-08T14:19:11.023
> 
> 标签：java, swing, jtextarea, word-wrap

我对我的 JTextArea 感到非常惊讶。在[JTextArea JAVAdoc](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JTextArea.html)之后，我尝试创建一个长字符串的 JTextArea，并希望我的行自动换行。

```
JTextArea text = new JTextArea(myLongString,10,100);
text.setLineWrap(true);
text.setWrapStyleWord(true);
myContainer.add(text); 
```

但实际上我的文本超出了我的框架，并且每行的字符数约为 180。也许我不明白，或者问题出在布局管理中。但是为了避免布局复杂化，我将其简化为基本框架>面板>文本区域。

请注意，英语不是我的母语。

```
public class myTest extends JFrame
{

    public myTest()
    {
        JPanel simplePanel = new JPanel();
        String alongString = "Accusata consulatu vix ad, eruditi albucius liberavisse est no. Platonem reprehendunt qui ea. Dicta recteque referrentur an his, id facete maiorum vulputate vim. At suas oratio mnesarchum quo. Quidam omnium necessitatibus ex sea, vix soleat quaerendum conclusionemque ut, case malorum nam an.No quis suas discere nam, nam ex nostro fastidii vivendum. Sed cu nobis ullamcorper. Has at doctus ponderum honestatis. In facer dicam corpora vis.";
        JTextArea myText = new JTextArea(alongString,10,100 );

        this.setSize(800, 600);

        myText.setLineWrap(true);
        myText.setWrapStyleWord(true);

        simplePanel.add(myText);
        this.add(simplePanel);
        this.validate();
        this.setVisible(true);

    }

    public static void main(String[] args)
    {
        new myTest();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:56:59.580

问题是您的 jtext 区域是带有默认布局管理器的面板。你需要改变它的东西。查看下面修改后的代码，并告诉我它是否适合您。

```
public MyTest()
{

    String alongString = "Accusata consulatu vix ad, eruditi albucius liberavisse est no. Platonem reprehendunt qui ea. Dicta recteque referrentur an his, id facete maiorum vulputate vim. At suas oratio mnesarchum quo. Quidam omnium necessitatibus ex sea, vix soleat quaerendum conclusionemque ut, case malorum nam an.No quis suas discere nam, nam ex nostro fastidii vivendum. Sed cu nobis ullamcorper. Has at doctus ponderum honestatis. In facer dicam corpora vis.";
    JTextArea myText = new JTextArea(alongString,10,100 );

    myText.setLineWrap(true);
    myText.setWrapStyleWord(true);

    JPanel simplePanel = new JPanel(new BorderLayout(5, 5));
    simplePanel.add(myText, BorderLayout.CENTER);

    this.add(simplePanel);
    this.validate();
    this.setSize(800, 600);
    this.setVisible(true);

}

public static final void main(String ... args) {
    new MyTest();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:29:49.660

您可能需要将 JTextArea 放在 JScrollPane 中。如果您的 JTextArea 在父容器中是松散的，则父容器的布局管理器将确定 JTextArea 的大小。

我不确定您正在寻找什么功能，但以下代码用 JTextArea 填充 JFrame。如果框架变得太小，则会出现滚动条，以便所有文本都可见。

我已经删除了行和列的 JTextArea 构造函数参数。注意：“columns”参数并不意味着可以容纳多少个字母。我不确切知道“列”是什么，但它似乎比典型的字母更宽。

我还删除了“myPanel”，并将 JScrollPane 直接添加到 JFrame。

```
 String alongString = "Accusata consulatu vix ad, eruditi albucius liberavisse est no. Platonem reprehendunt qui ea. Dicta recteque referrentur an his, id facete maiorum vulputate vim. At suas oratio mnesarchum quo. Quidam omnium necessitatibus ex sea, vix soleat quaerendum conclusionemque ut, case malorum nam an.No quis suas discere nam, nam ex nostro fastidii vivendum. Sed cu nobis ullamcorper. Has at doctus ponderum honestatis. In facer dicam corpora vis.";
    JTextArea myText = new JTextArea(alongString);
    JScrollPane scrollPane = new JScrollPane(myText);

    this.setSize(800, 600);

    myText.setLineWrap(true);
    myText.setWrapStyleWord(true);

    this.add(scrollPane);
    this.validate();
    this.setVisible(true); 
```

# php - 如何使用 Foreach 调用数组中的 PHP 函数

> ID：10950633
> 
> 赞同：0
> 
> 时间：2012-06-08T14:19:22.550
> 
> 标签：php, arrays, function, foreach

我找不到任何可以回答我的问题的东西，所以这里是：

我需要一个 foreach 循环来获取数组中的每个函数并运行每个函数并检查它是否返回 true，足够简单。像这样：

```
$array_name = array(function1(),function2(),function3());

foreach($array_name as &$value) {
    /* run each function */
    /* checks if it returns true */
} 
```

这可能很简单，我只是看不到它，但我找不到任何关于如何正确实现它的权威文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:24:08.597

试试看：

```
$array_name = array('function1','function2','function3');

foreach($array_name as &$value) {
  if(function_exists($value) && ($value())) {
     //function exists and it returns true
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:21:24.323

```
$array_name = array('function1', 'function2', 'function3');

foreach($array_name as $value) {
    if($value()) {
        // do stuff if the function returned a true-ish value
    }
} 
```

调用该函数的另一个选项是[`call_user_func($value)`](http://php.net/call_user_func).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-01T10:10:51.483

尝试采用以下内容： http: [//php.net/manual/en/functions.variable-functions.php](http://php.net/manual/en/functions.variable-functions.php)

```
foreach($functionName as $arg) {
    $arg();
} 
```

但正如你的问题包含：

> $array_name = 数组(function1(),function2(),function3());

确保在您的数组中使用“function1()”。所以我们可以有：

```
foreach($functionName as $arg) {
   $check = $arg;
   if($check != false){
     //Do stuff here
   }else{
     //Do stuff here
   }
} 
```

# java - 如何使用换行符设置应用程序名称？

> ID：10950634
> 
> 赞同：0
> 
> 时间：2012-06-08T14:19:23.463
> 
> 标签：java, android

如何为应用程序标题换行？我想在手机上已安装程序的图标下的两行中显示名称，例如：Harry's App

在 xml 文件中，设置 app_name 几乎会返回一个单行标题，或者在到达空间末尾时将其剪切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:20:53.093

用于`\n`XML 中的换行符。你也可以使用`<br>`，但是 Eclipse 可能会弹出这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-21T11:47:55.927

`\n``\r\n`对我不起作用

# dependency-injection - 温莎城堡命名组件注册顺序

> ID：10950637
> 
> 赞同：2
> 
> 时间：2012-06-08T14:19:31.113
> 
> 标签：dependency-injection, inversion-of-control, castle-windsor, ioc-container

我在尝试解析命名组件时遇到问题。根据 Castle 文档，它指出当多个组件具有相同的依赖项时，首先选择第一个注册的组件。[为同一服务注册更多组件](http://stw.castleproject.org/Default.aspx?Page=Registering-components-one-by-one&NS=Windsor&AspxAutoDetectCookieSupport=1)

为了避免这种情况，我使用命名组件来解析它们以获得相同的依赖关系。

```
container.Register(Component.For<DataContext>().ImplementedBy<MyContext>()
   .Named("Db1").DependsOn(Property.ForKey<string>()
   .Eq(Configuration.ConnectionStrings["Db1"].ConnectionString)));

container.Register(Component.For<DataContext>().ImplementedBy<MyContext>()
   .Named("Db2").DependsOn(Property.ForKey<string>()
   .Eq(Configuration.ConnectionStrings["Db2"].ConnectionString))); 
```

然后调用`kernel.Resolve<DataContext>(cbo.SelectedItem.ToString());`where `cbo`is a `ComboBox`conrtol，无论选择哪个选项，我总是会注册第一个组件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:41:41.533

这太多了，无法发表评论。Windsor 版本 3 支持您想做的事情。这是我尝试过的，它奏效了：

```
public interface IFoo
{
    string Name { get; }
}

public class Foo : IFoo
{
    private readonly string item;

    public Foo(string item) { this.item = item; }

    public string Name { get { return this.item; } }
}

[TestMethod]
public void TestMethod1()
{
    var container = new WindsorContainer();
    container.Register(Component.For<IFoo>().ImplementedBy<Foo>().Named("F1").DependsOn(Property.ForKey<String>().Eq("one")));
    container.Register(Component.For<IFoo>().ImplementedBy<Foo>().Named("F2").DependsOn(Property.ForKey<String>().Eq("two")));

    var f1 = container.Resolve<IFoo>("F1");
    var f2 = container.Resolve<IFoo>("F2");
} 
```

变量`f1`引用了带有“一”项的`f2`实例，并引用了带有“二”项的实例。你能创建一个失败的测试用例来突出你的问题吗？

# c# - 找不到引用的组件“EntityFramework”。

> ID：10950638
> 
> 赞同：21
> 
> 时间：2012-06-08T14:19:37.823
> 
> 标签：c#, model-view-controller

所以我在家里通过团队基础服务器下载了一个项目。我下载了该项目，但由于错误而无法编译。警告 2 找不到引用的组件“EntityFramework”。任何人都可以就我如何让实体框架工作提供指导。我安装了nuget包。

谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-24T23:55:13.427

我建议你检查：

1)勾选**“允许 NuGet 在构建期间下载丢失的包”**

`Tool --> Options... --> Package Manager --> General` ![在此处输入图像描述](../Images/08808892fc8dfaae931c7c826e22382f.png)

2)勾选**“项目选择”**

`Solution Explorer --> right-click on the solution/project --> Manage NuPackages` ![在此处输入图像描述](../Images/7930407ef1dd22e3c23abb3992e7b27b.png)

3)**重建解决方案**

![在此处输入图像描述](../Images/7c355365bebb87c583b9b691df4e43da.png)

**编辑**

为了完整起见，我想补充一点，如果您使用 CI 系统（例如 Jenkins）或者您在命令行上使用 MSBuild，则需要选择*Enable NuGet Package Restore*以使其工作：

[启用 NuGet 包还原 http://docs.nuget.org/docs/Workflows/images/enable-package-restore.png](http://docs.nuget.org/docs/Workflows/images/enable-package-restore.png)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-19T04:06:41.490

我有同样的问题。我是这样解决的：

1.  选择`References`> 右键单击​​ >`Add Reference ...`
2.  选择`Browse`标签
3.  找到您的*项目文件夹*> `packages`> `EntityFramework.4.1.10331.0`>`lib`
4.  选择`EntityFramework.dll`
5.  点击`OK`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-13T10:14:22.687

**在我将项目移动**到子文件夹后，这发生在我身上。然后，包文件夹的相对路径不再正确。

得到这样的错误：

> 此项目引用此计算机上缺少的 NuGet 包。使用 NuGet 包还原下载它们。有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkID=322105](http://go.microsoft.com/fwlink/?LinkID=322105)。缺少的文件是 ..\packages\NETStandard.Library.2.0.1\build\netstandard2.0\NETStandard.Library.targets。项目名称 D:\VSTS\TEAMPROJECT\src\PROJECTFOLDER\PROJECTNAME.csproj

[![在此处输入图像描述](../Images/33afc272de0e359002c1f9f6db7caddf.png)](https://i.stack.imgur.com/DuvQX.png)

通过编辑 *.csproj 文件来修复它并更正相对路径，在我的例子中是从`..\packages`到`..\..\packages`

还要确保检查下的路径

```
<Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild"> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-19T04:40:11.500

开发人员建议了一些好方法，您也可以尝试此解决方案来解决您的问题。

在您的情况下，您的项目引用了 EntityFramework 库，但它本身的库对您的项目不可用。您可以尝试以下任一方法：

*   如果你有 NuGet 包管理器：

> 单击**项目-> 管理 NuGet 包**。它将打开以下窗口。
> 
> 找到 EntityFramework 并单击安装。

![NuGet 包窗口](../Images/0cd419309207e1c789da53391cd300fa.png)

* * *

- 或者，将 EntityFramework 库下载到您的计算机，然后

> **右键单击项目-> 添加引用...-> 浏览-> 找到您的 EntityFramework 库-> 单击确定**

![喜欢这张图片](../Images/3b1999d940e12452f4ddcd28befb2925.png)

* * *

- 可选地，您可以使用包管理器安装库参考，
检查此链接[package-manager-console](http://docs.nuget.org/docs/start-here/using-the-package-manager-console)（注意：这可能需要 NuGet 包管理器）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-24T09:10:12.727

我通过在我的项目中添加 C:\Prog Files\Entity...\Binaries\Entity Framework.dll 下的实体框架引用（添加引用）解决了这个问题。希望这可以帮助！

# excel - 排列数字组以适合特定尺寸总计

> ID：10950639
> 
> 赞同：0
> 
> 时间：2012-06-08T14:19:39.673
> 
> 标签：excel, matlab, octave, combinatorics, libreoffice

我在一个组中有几个不同的数字，它们的大小不一，我想根据组的最大大小来计算这些数字应该进入哪个组。

数字示例：10,20,30,40,50,60

条件示例：一组数字加起来的最大总数为 60

因此，从上面的示例中，答案将是：

第 1 组将有数字 10,20,30

第 2 组的编号为 40

第 3 组的编号为 50

第 4 组的编号为 60

在 matlab/octave 或 excel/librecalc 中有没有可以计算的方法？

PS：一个组也可以有40号和20号，组总数不能超过60。但每个号码只能使用一次。

有用于此的数学术语吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:55:46.860

### 编辑：

下面的解决方案使用蛮力方法来生成[powersets](http://en.wikipedia.org/wiki/Power_set)的 powersets（尽管经过修剪）。然后检查满足条件集的组（即将所有数字分组，使得没有一个组包含超过 60 的总和）。[我从PMTK3](http://code.google.com/p/pmtk3/source/browse/trunk/matlabTools/util/powerset.m)工具箱中的`powerset.m`函数中借用了一些代码。

对于像这样的小问题，这应该可以正常工作，但我怀疑对于更大的输入，它的大小会呈指数增长。我确信那里有更好的启发式/算法，所以以此为起点......

```
%# set of numbers
S = [10,20,30,40,50,60];

%# powerset of S (exclude empty set)
b = (dec2bin(2^numel(S)-1:-1:1) == '1');
P = cellfun(@(idx)S(idx), num2cell(b,2), 'UniformOutput',false);

%# keep only sets where the sum is at most 60
P = P(cellfun(@sum,P) <= 60);

%# take the powerset of the powerset, although we can
%# reduce it to no more than numel(S) subsets in each.
%# The idea here is: nchoosek(p,1:numel(s))
b = (dec2bin(2^numel(P)-1:-1:1) == '1');
b = b(sum(b,2)<=numel(S),:);
PP = cellfun(@(idx)P(idx), num2cell(b,2), 'UniformOutput',false);

%# condition: every number appears exactly once in groups
ppp = cellfun(@(x) [x{:}], PP, 'UniformOutput',false);
idx = find(cellfun(@numel,ppp) == numel(S));
idx2 = ismember(sort(cell2mat(ppp(idx)),2), S, 'rows');
PP = PP( idx(idx2) );

%# cleanup, and show result
clearvars -except S PP
celldisp(PP) 
```

这给了我 12 个解决方案。例如：

```
>> PP{1}{:}
ans =
    10    20    30
ans =
    40
ans =
    50
ans =
    60

>> PP{6}{:}
ans =
    10    40
ans =
    20
ans =
    30
ans =
    50
ans =
    60

>> PP{12}{:}
ans =
    10
ans =
    20
ans =
    30
ans =
    40
ans =
    50
ans =
    60 
```

# objective-c - 问题理解 Apple 指南中的“引用实例变量”

> ID：10950640
> 
> 赞同：0
> 
> 时间：2012-06-08T14:19:43.793
> 
> 标签：objective-c, ios

Apple Doc 说，我试图从 Apple 指南中了解[引用实例变量，但在研究这一点时遇到问题](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocDefiningClasses.html#//apple_ref/doc/uid/TP30001163-CH12-SW1)

...当实例变量属于不是接收者的对象时，该对象的类型必须通过静态类型对编译器明确。在引用静态类型对象的实例变量时，使用结构指针运算符 (->)。例如，假设 Sibling 类声明一个静态类型对象 twin 作为实例变量：

```
@interface Sibling : NSObject
{
     Sibling *twin;
     int gender;
     struct features *appearance;
} 
```

只要静态类型对象的实例变量在类的范围内（因为它们在这里是因为 twin 类型为同一个类），Sibling 方法就可以直接设置它们：

```
- makeIdenticalTwin 
{
    if ( !twin ) 
    {
        twin = [[Sibling alloc] init];
        twin->gender = gender;
        twin->appearance = appearance;
    }
    return twin; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:47:03.750

引用实例变量的意思是，访问类实例变量

例如：

```
@interface ClassA : NSObject
{
   int value;
}

- (void) setValue:(int) val;

@implementation ClassA
- (void) setValue:(int) val
{
   //here you could access class a value variable like this
   value = val;
} 
```

现在访问其他类变量以此类为例

```
@interface ClassB : ClassA
{
   ClassA aClass;
}

- (void) setValueInAClass:(int) val;

@implementation ClassB
- (void) setValueInAClass:(int) val
{
   //class b could access variables from class a like this
   aClass->value = val;
} 
```

请注意，这是非常不建议这样做的，使用“->”会破坏类 a 的封装，因此在 99% 的情况下使用“->”引用类变量是错误的

# php - 得到所有 来自 using getElementById I need to get all of the <option>data from a <select>in an HTML document using PHP. The code that I have at the moment: $pageData = $this->Http->get($this->config['url']); libxml_use_int ID：10950643 赞同：4 时间：2012-06-08T14:19:48.303 标签：php, html, domdocument 回答 #1 赞同：5 时间：2012-06-08T14:41:25.163 您必须使用 DOM-API 来检索您想要的数据。由于<select>元素并不复杂，您可以使用以下命令获取所有<options>-nodes getElementsByTagName： $select = $this->Dom->getElementById('DDteam'); $options = $select->getElementsByTagName('option'); $optionInfo = array(); foreach($options as $option) { $value = $option->getAttribute('value'); $text = $option->textContent; $optionInfo[] = array( 'value' => $value, 'text' => $text, ); } var_dump($optionInfo);</select></option>

# c# - 从另一个命令 Handle() 方法中调用命令

> ID：10950644
> 
> 赞同：11
> 
> 时间：2012-06-08T14:19:48.600
> 
> 标签：c#, .net, architecture, dependency-injection, unit-of-work

嗨，我正在使用[Simple Injector](https://simpleinjector.org) DI 库，并且一直在关注一些关于围绕命令模式设计的架构模型的非常有趣的材料：

*   [同时......在我的架构的指挥方面](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91 ".NET Junkie - 同时......在我的架构的命令方面")
*   [同时......在我的架构的查询方面](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=92 ".NET Junkie - 同时......在我的架构的查询方面")

容器将管理 . 的生命周期`UnitOfWork`，我正在使用命令对数据库执行特定功能。

我的问题是，如果我有一个命令，例如 an `AddNewCustomerCommand`，它又对另一个服务执行另一个调用（即发送一条短信），从设计的角度来看这是可以接受的还是应该在更高级别完成，如果是这样，如何最好这样做？

示例代码如下：

```
public class AddNewBusinessUnitHandler
    : ICommandHandler<AddBusinessUnitCommand>
{
    private IUnitOfWork uow;
    private ICommandHandler<OtherServiceCommand> otherHandler;

    AddNewBusinessUnitHandler(IUnitOfWork uow, 
        ICommandHandler<OtherServiceCommand> otherHandler)
    {
        this.uow = uow;
        this.otherHandler = otherHandler;
    }

     public void Handle(AddBusinessUnitCommand command)
     {
        var businessUnit = new BusinessUnit()
        {
            Name = command.BusinessUnitName,
            Address = command.BusinessUnitAddress
        };

        var otherCommand = new OtherServiceCommand()
        {
            welcomePostTo = command.BusinessUnitName
        };

        uow.BusinessUnitRepository.Add(businessUnit);

        this.otherHandler.Handle(otherCommand);
     }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-08T14:58:50.623

这取决于您对（业务）命令的架构视图，但是在[用例](https://en.wikipedia.org/wiki/Use_case)和命令之间具有一对一的映射是很自然的。在这种情况下，表示层应该（在单个用户操作期间，例如单击按钮）只创建命令并执行它。此外，它应该只执行*单个*命令，不再执行。执行该用例所需的一切都应由该命令完成。

也就是说，发送文本消息、写入数据库、进行复杂的计算、与 Web 服务通信以及操作业务所需的所有其他操作都应该在该命令的上下文中完成（或者可能排队稍后发生）。不是在此之前，也不是在之后，因为它是以与表示无关的方式表示需求的命令。

这并不意味着命令处理程序本身应该完成所有这些。将很多逻辑转移到处理程序所依赖的其他服务是很自然的。所以我可以想象你的处理程序依赖于一个`ITextMessageSender`接口，例如。

另一个讨论是命令处理程序是否应该依赖于其他依赖命令处理程序。当您查看用例时，大用例由多个较小的子用例组成的可能性不大，因此从这个意义上说，这并不奇怪。同样，命令和用例之间将存在一对一的映射。

但是，请注意，嵌套命令处理程序相互依赖的深度依赖图可能会使代码导航变得复杂，因此请仔细研究一下。`ITextSessageSender`例如，注入一个而不是使用一个可能会更好`ICommandHandler<SendTextMessageCommand>`。

允许处理程序嵌套的另一个缺点是它使基础设施工作变得更加复杂。例如，当使用添加事务行为的装饰器包装命令处理程序时，您需要确保嵌套处理程序与最外层处理程序在同一事务中运行。我今天碰巧帮助了我的一个客户。这并不难，但需要一点时间才能弄清楚。像死锁检测这样的事情也是如此，因为它也在事务的边界上运行。

此外，死锁检测是展示这种命令/处理程序模式强大功能的一个很好的例子，因为几乎所有其他架构风格都无法插入这种行为。看看[这篇文章](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91 ".NET Junkie - 同时......在我的架构的命令方面")`DeadlockRetryCommandHandlerDecorator`中的类）看一个例子。

# java - WAR 不会部署到 Tomcat 7.0.19

> ID：10950649
> 
> 赞同：5
> 
> 时间：2012-06-08T14:19:58.100
> 
> 标签：java, tomcat, web-applications, war, web.xml

我有一个 Tomcat 不会部署的 WAR，虽然它通常会给出它为什么不会部署应用程序的原因或一些指示，但 Tomcat 的 catalina 日志输出只是说明：

> 严重：上下文 [/appmon-qa] 启动因先前的错误而失败

这是`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app
    xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
    version="2.4">

    <!-- The display name of this web application -->
    <display-name>AppMonitor</display-name>

    <listener>
        <listener-class>
            com.me.myorg.appmon.AppMonitor
        </listener-class>
    </listener>
</web-app> 
```

该课程中的重要内容`AppMonitor`：

```
public class AppMonitor implements ServletContextListener {
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        return;
    }

    @Override
    public void contextInitialized(ServletContextEvent event) {
        try {
            // Guts of my monitor app
        } catch(Exception exc) {
            System.out.println("Something bad happened!\n" + exc.getMessage());
        }
    }
} 
```

以及非常模糊/不具描述性的日志输出：

```
INFO: Deploying web application archive appmon-qa.war
Jun 8, 2012 9:45:30 AM org.apache.catalina.core.StandardContext startInternal
SEVERE: Error listenerStart
Jun 8, 2012 9:45:31 AM org.apache.catalina.core.StandardContext startInternal
SEVERE: Context [/appmon-qa] startup failed due to previous errors
Jun 8, 2012 9:45:31 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory docs
Jun 8, 2012 9:45:31 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory examples
Jun 8, 2012 9:45:32 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory host-manager
Jun 8, 2012 9:45:32 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory manager
Jun 8, 2012 9:45:32 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory ROOT
Jun 8, 2012 9:45:32 AM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
Jun 8, 2012 9:45:32 AM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
Jun 8, 2012 9:45:32 AM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-nio-8010"]
Jun 8, 2012 9:45:32 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 2875 ms 
```

我取消了这个 WAR 并部署了另一个我知道工作正常的 Tomcat 7.0.19 启动它没有任何问题，所以我**知道**它不是 Tomcat/配置问题。这显然是我的 WAR 的问题。目录结构如下：

```
appmon-qa.war/
    META-INF/
        MANIFEST.MF
    WEB-INF/
        classes/
            All of my binaries
        lib/
            All JAR dependencies
        web.xml 
```

如果我的 (super-simple) 有问题`web.xml`，Tomcat*应该*在日志输出中抱怨。如果我没问题，但是在我的方法`web.xml/ServletContextListener`中抛出了异常，则该块会将消息打印到控制台-但这没有发生。`contextInitialized``catch`

关于什么可能是潜在问题或我必须开始诊断这个问题的任何想法？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T09:24:01.897

您应该在方法中调用超类。

```
@Override
public void contextInitialized(ServletContextEvent servletContextEvent) {
        super.contextInitialized(servletContextEvent); 
```

....}

和

```
 @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        super.contextDestroyed(servletContextEvent);
    } 
```

作为一个额外的你可以确保增加你的tomcat服务器上的日志级别（也许集成log4j） [http://tomcat.apache.org/tomcat-7.0-doc/logging.html](http://tomcat.apache.org/tomcat-7.0-doc/logging.html)

米海

# javascript - 使用 Jquery 解析多个 xml 文件

> ID：10950650
> 
> 赞同：0
> 
> 时间：2012-06-08T14:19:58.443
> 
> 标签：javascript, jquery, xml, parsing

我有多个要使用 JQuery 解析的 xml 文件。到目前为止，我只是通过单独解析每个文件才获得成功。我是新手，我的代码很长而且重复。我将不胜感激任何缩小它的帮助。这是我的js：

```
$.ajax({
    type: "GET",
    url: "docs/doc1.xml",
    dataType: "xml",
    success: parseXml1
});

$.ajax({
    type: "GET",
    url: "docs/doc2.xml",
    dataType: "xml",
    success: parseXml2
});
$.ajax({
    type: "GET",
    url: "docs/doc3.xml",
    dataType: "xml",
    success: parseXml3
});
function parseXml1(xml){
    var gen = $(xml).find("subsystem").eq(0);
    var title = gen.find("title").text();
    var text = gen.find("text").text();
    $("#Title01").html(title);
    $("#Text01").html(text);
};

function parseXml2(xml){
    var gen = $(xml).find("subsystem").eq(0);
    var title = gen.find("title").text();
    var text = gen.find("text").text();
    $("#Title02").html(title);
    $("#Text02").html(text);

    var sys = $(xml).find("subsystem").eq(1);
    var title = sys.find("title").text();
    var text = sys.find("text").text();
    $("#Title02-1").html(title);
    $("#Text02-1").html(text);
};

function parseXml3(xml){
    var gen = $(xml).find("subsystem").eq(0);
    var title = gen.find("title").text();
    var text = gen.find("text").text();
    $("#Title03").html(title);
    $("#Text03").html(text);

    var sys = $(xml).find("subsystem").eq(1);
    var title = sys.find("title").text();
    var text = sys.find("text").text();
    $("#Title03-1").html(title);
    $("#Text03-1").html(text);
}; 
```

我的xml设置如下：

```
<root>
   <subsystem>This is information 1</subsystem>
   <subsystem>This is information 2</subsystem>
</root> 
```

所以我有多个没有属性的节点，我试图在每个 xml 文件中一个一个地访问它们。然后，我试图将该文本放入我的 HTML 页面上的 div 中。必须有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T15:01:36.243

让它成为一个函数调用

```
function parseFile( path, titleId, textId) {

    function parseXml(xml){
        var subSystems = $(xml).find("subsystem");
        var gen = subSystems.eq(0);
        var title = gen.find("title").text();
        var text = gen.find("text").text();
        $("#" + titleId).html(title);
        $("#" + textId).html(text);
        if ( subSystems.length===2 ) {
            var sys = subSystems.eq(1);
            var title = sys.find("title").text();
            var text = sys.find("text").text();
            $("#" + titleId + "-1").html(title);
            $("#" + textId + "-1").html(text);
        }
    };

    $.ajax({
        type: "GET",
        url: path,
        dataType: "xml",
        success: parseXml
    });
}

parseFile("docs/doc1.xml", "Title01", "Text01");
parseFile("docs/doc2.xml", "Title02", "Text02");
parseFile("docs/doc3.xml", "Title03", "Text03"); 
```

您可以通过摆脱 if 检查并执行循环来使其更小

```
function parseFile( path, titleId, textId) {

    function parseXml(xml){

        $(xml).find("subsystem").each( 
            function(ind) {
                var gen = jQuery(this);
                var title = gen.find("title").text();
                var text = gen.find("text").text();
                var ext = ind===0 ? "" : "-" + ind;
                $("#" + titleId + ext).html(title);
                $("#" + textId + ext).html(text);
            }
        );
    };

    $.ajax({
        type: "GET",
        url: path,
        dataType: "xml",
        success: parseXml
    });
}

parseFile("docs/doc1.xml", "Title01", "Text01");
parseFile("docs/doc2.xml", "Title02", "Text02");
parseFile("docs/doc3.xml", "Title03", "Text03"); 
```

# android - 如何在 Android 4 中隐藏 ActionBar 中的单个选项卡

> ID：10950651
> 
> 赞同：1
> 
> 时间：2012-06-08T14:20:03.513
> 
> 标签：android, tabs, android-fragments, android-4.0-ice-cream-sandwich, android-actionbar

我正在开发一个应用程序`Android 4`。我的应用程序中有三个`tabs`。我的要求是，我只想在开始时显示第一个选项卡，然后单击选项卡 1 中的某个按钮后，我想显示第二个选项卡，单击按钮后，第三个选项卡将可见。

由于标签在`Android 3`on-wards，没有`setVisibility`方法，请告诉我如何`show/hide` `particular tab`在我的情况下。

任何帮助将不胜感激。

谢谢你。

**更新：** onClick 按钮，我添加了以下代码：

```
ActionBar actionbar = getActivity().getActionBar();
                ActionBar.Tab Tab2 = actionbar.newTab().setText("XYZ");
                ActionBar.Tab Tab3 = actionbar.newTab().setText("PQR");

                Fragment Tab2Fragment = new BFragment();
                Fragment Tab3Fragment = new CFragment();

                Tab2.setTabListener(new MyTabsListener(Tab2Fragment));
                Tab3.setTabListener(new MyTabsListener(Tab3Fragment));
                actionbar.addTab(Tab2);
                actionbar.addTab(Tab3); 
```

但它仍然不起作用..

**更新：**现在我可以看到两个标签，但我得到了 NPE：

```
06-08 20:57:58.101: E/AndroidRuntime(17070): java.lang.NullPointerException

06-08 20:57:58.101: E/AndroidRuntime(17070):    at de.arvidg.exampleactionbartabs.AFragment.onActivityCreated(AFragment.java:116)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:847)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:1032)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.app.BackStackRecord.run(BackStackRecord.java:622)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1382)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.app.FragmentManagerImpl$1.run(FragmentManager.java:426)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.os.Handler.handleCallback(Handler.java:605)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.os.Handler.dispatchMessage(Handler.java:92)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.os.Looper.loop(Looper.java:137)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at android.app.ActivityThread.main(ActivityThread.java:4424)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at java.lang.reflect.Method.invokeNative(Native Method)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at java.lang.reflect.Method.invoke(Method.java:511)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-08 20:57:58.101: E/AndroidRuntime(17070):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我在 AFragment 中的 onCreateView 和 onActivityCreated 是：

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.afragment, container, false);
    }

/* (non-Javadoc)
     * @see android.app.Fragment#onActivityCreated(android.os.Bundle)
     */
    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        appContext = AFragment.this;
        mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
        if (mBluetoothAdapter == null) {
            Toast.makeText(getActivity(), "NO Bluetooth Available", Toast.LENGTH_LONG);
            getActivity().finish();
            return;
        }
        final Button connectBtn = (Button) getActivity().findViewById(R.id.connect_btn);
        connectBtn.setClickable(true); // NPE is occurring here...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:35:37.103

使用 ActionBar.addTab() 添加选项卡，使用 ActionBar.removeTabAt() 删除选项卡。此外，ActionBar.getTabCount() 可用于确定当前配置的选项卡数。

```
ActionBar actionBar = this.getActionBar();
if (actionBar.getTabCount() == 1)
{
 // 2nd tab
 MyFragment fragment = new MyFragment();
 ActionBar.Tab tab2nd = actionBar.newTab();
 tab2nd.setTabListener(fragment);
 actionBar.addTab(tab2nd);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:25:40.503

您可以使用 ActionBar 的[`removeTab(ActionBar.Tab tab)`](http://developer.android.com/reference/android/app/ActionBar.html#removeTab%28android.app.ActionBar.Tab%29)方法：

```
bar.removeTab(tab); 
```

要重新添加选项卡，请调用[`addTab(ActionBar.Tab tab, int position)`](http://developer.android.com/reference/android/app/ActionBar.html#addTab%28android.app.ActionBar.Tab,%20int%29)，前提是您已保存`Tab`删除的位置。例如，

```
bar.addTab(tab, savedTabPosition); 
```

# content-management-system - 全新安装后，MODX Manager 屏幕上仅显示菜单

> ID：10950653
> 
> 赞同：1
> 
> 时间：2012-06-08T14:20:09.957
> 
> 标签：content-management-system, modx, modx-revolution

在将 CMF MODX Revo 2.2.2 全新安装到服务器后，我只看到带有菜单的空白屏幕，并且内容为空我将 compress_css 和 copress_js 值更改为 0，但没有任何变化

有什么关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:26:42.650

清除缓存 [删除磁盘上的文件，不要只单击清除缓存菜单项] 如果仍然不行检查您的 modx 错误日志和服务器错误日志，如果仍然没有任何问题，请将您的调试转到 3 或 4 &再检查一遍。

# c# - 无法通过 WCF 访问类

> ID：10950658
> 
> 赞同：1
> 
> 时间：2012-06-08T14:20:31.000
> 
> 标签：c#, wcf

我在同一个解决方案中有两个项目，一个服务和一个消费者应用程序。在服务中，我有许多可以由消费者应用程序实例化的类，但有些类无法访问。除了名字没有区别。所有类都是公共的，所以它们都应该被看到。是否有任何缓冲问题或任何其他可能导致问题表现得像这样的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:40:54.897

当您使用 WCF 或任何其他 Web 服务/删除技术时，消费者无法访问服务器类。而是创建代理类。将它们视为能够在应用程序边界上调用方法的一组接口。您可以实例化代理类，但是当您调用方法时，代理类将转到服务并调用服务托管的类的相应方法。

如果双方都使用它们，您需要使用类库并将共享类移动到那里（并使用服务和消费者部署 dll）。

**更新（感谢 razlebe）：**
不应在 DLL 中共享业务逻辑。它应该由服务器托管。但是共享支持类（例如进行数据格式化的类）以避免代码重复是有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:28:32.233

我的猜测是“不可访问”的类是在上一代代理之后创建的（服务类，客户端）。检查重新生成代理是否有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T14:32:15.427

当您通过以下方式更新服务类和更改接口时：

*   添加方法（您的情况）
*   删除方法
*   更改签名

您的消费者需要了解这种变化。您必须**更新服务参考**( [http://msdn.microsoft.com/en-us/library/bb628652.aspx](http://msdn.microsoft.com/en-us/library/bb628652.aspx) ) 以重建代理。

如何更新它？

在这里查看如何： http: [//msdn.microsoft.com/en-us/library/bb628652.aspx](http://msdn.microsoft.com/en-us/library/bb628652.aspx)）但是一张图片胜过千字：

![更新服务引用的视觉图像](../Images/38ce1a7443b94e8df1d8a1c8d9c9f61c.png)

# ruby-on-rails - 如何检测布局是否在部分之前呈现

> ID：10950666
> 
> 赞同：0
> 
> 时间：2012-06-08T14:20:58.590
> 
> 标签：ruby-on-rails

我有个问题。我有一个 Rails 网页，我正在用 jquery 加载所有页面。

这一切都按预期工作，除非我尝试访问从浏览器呈现的部分 URL - 我在浏览器中键入 www.mywebsite.something/aPageThatIsRenderedPartial。

正如预期的那样，它被呈现为部分并且未加载布局。

所以我的问题是，如果没有加载主布局，我可以做一些 Rails 魔术来渲染所有内容吗？

我会尽量用我有限的英语能力把这一点说清楚:)：

控制器中是否有可能发生这样的事情

如果 mainLayout 未加载
，则渲染 :layout => true
否则渲染 :layout => false

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:30:50.970

只需使用不同的`respond_to`块：

```
respond_to do |format|
  format.html # general HTML request
  format.json { render :layout => false } # AJAX request
end 
```

不要忘记将 AJAX 请求的格式指定为 JSON，或者将 url 更改`www.mywebsite.something/aPageThatIsRenderedPartial.json`为 JQuery Get 请求。

# asp.net - 基于客户端在运行时切换asp.net cookie和cookieless模式

> ID：10950667
> 
> 赞同：0
> 
> 时间：2012-06-08T14:21:08.147
> 
> 标签：asp.net, session-state, session-cookies

我想对 Web 浏览器使用基于 cookie 的会话跟踪，对移动客户端（例如 UIWebView）使用无 cookie 会话跟踪。

注意：由于 SEO 的原因，我不能对 Web 客户端使用无 cookie 模式，由于缺乏对 cookie 的支持，我不能在移动设备上使用 cookie。

想知道有没有可能？

提前致谢..

# c# - 需要一种高效的方式来从列表中返回所有重复项

> ID：10950671
> 
> 赞同：2
> 
> 时间：2012-06-08T14:21:13.300
> 
> 标签：c#, linq, lambda, generic-list

我将使用一个包含大约 500,000 个项目的集合，并且正在寻找一种获得所有重复项的体面方法。看完[这篇文章后](https://stackoverflow.com/questions/493673/c-sharp-3-0-need-to-return-duplicates-from-a-list)，我发现最流行的解决方案是使用散列集。但是，如果我想获得所有具有红色的汽车而不仅仅是 Car4 和 Car5 怎么办？

```
Car1.Color = Red;

Car2.Color = Blue;

Car3.Color = Green;

Car4.Color = Red;

Car5.Color = Red; 
```

鉴于这个问题，什么是一种相当快速的方法来做到这一点？

编辑：我在那篇文章中看到下面的代码可以很容易地更改以满足我的需要。而且我不确定是否真的有更好的方法来解决这个问题，但我会留下帖子只是为了看看。

```
var duplicates = from car in cars
                 group car by car.Color into grouped
                 from car in grouped
                 select car; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T14:25:09.893

您可以使用[Enumerable.ToLookup 扩展方法](http://msdn.microsoft.com/en-us/library/bb549073.aspx)按颜色对汽车进行分组并检索一种颜色的所有汽车：

```
var cars = new List<Car> { car1, car2, car3, car4, car5 };
var lookup = cars.ToLookup(car => car.Color);
var redCars = lookup[Red];
// redCars == { car1, car4, car5 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:27:26.027

您可以按值使用分组

```
class Car {
    public Color { get; set; }
}

void Main()
{
     List<Car> cars = GetList(); // not important
     var grouped = cars.GroupBy(c=>c.Color);
     var duplicates = cars.Where(g=>g.Count()>1);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:28:43.233

您可以研究使用字典创建各种查找表。例如，如果您想在 Car.Color 上进行查找，您将有一个 Dictionary>，因此每当添加一辆新车时，您还需要添加 Color 字典。

这需要权衡额外的内存使用和添加时间，以便从更快的查找中受益，并且只有当您要通过相同的关键字段查找 Cars 集合时才最有意义。

否则，使用 Enumerable.ToLookup() 是要走的路。请参阅此链接以了解 ToLookup() 的工作原理：

[http://msdn.microsoft.com/en-us/library/bb549073.aspx](http://msdn.microsoft.com/en-us/library/bb549073.aspx)

# java - 如何更改 JSpinner 上的默认选择？

> ID：10950682
> 
> 赞同：3
> 
> 时间：2012-06-08T14:21:44.513
> 
> 标签：java, swing, jspinner

我面临一个问题`JSpinner`。我在微调器中使用时间格式，即`"hh:mm:ss,msmsms"`. 当我用鼠标增加时间而不选择微调器格式时意味着我没有选择时间的任何部分，例如小时、分钟、秒或毫秒 - 它总是增加小时作为小时的默认选择。

我想在第二种方法上给出这个默认选择，当我要增加或减少使用鼠标的时间时，它适用于第二部分。

## 例如

```
01:05:08,102 
```

单击微调器向上状态后，下面的时间来了。

```
01:05:09,102 
```

这是代码：

```
Start_time_jSpinner = new javax.swing.JSpinner();
Start_time_jSpinner.setModel(new SpinnerDateModel());
Start_time_jSpinner.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
Start_time_jSpinner.setEditor(new JSpinner.DateEditor(Start_time_jSpinner,   "HH:mm:ss,SSS")); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:42:09.010

即使选择了“小时”字段，该值也会在向上/向下箭头上一次增加/减少一秒。

```
import java.util.Date;
import javax.swing.*;

public class SecondIncrement {

    SecondIncrement() {
        JSpinner spinner = new JSpinner();
        SpinnerDateModel dateModel = new SpinnerDateModel(){
            @Override 
            public Object getNextValue() {
                Date date = this.getDate();
                long millis = date.getTime();
                return new Date(millis+1000);
            }

            @Override 
            public Object getPreviousValue() {
                Date date = this.getDate();
                long millis = date.getTime();
                return new Date(millis-1000);
            }
        };
        spinner.setModel(dateModel);
        spinner.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        spinner.setEditor(new JSpinner.DateEditor(spinner, "HH:mm:ss,SSS"));
        JOptionPane.showMessageDialog(null, spinner);
    }

    public static void main(String[] args) throws Exception {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new SecondIncrement();
            }
        });
    }
} 
```

# mysql - 通过 mysqldump 从完整备份中恢复指定数据库

> ID：10950684
> 
> 赞同：0
> 
> 时间：2012-06-08T14:21:48.787
> 
> 标签：mysql, mysqldump

我有一个完整备份的 MYSQL 数据库。

```
mysqldump -u root --password=SSS -A > D:\bkps\mysql.sql 
```

但是，我需要恢复指定的数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:27:06.393

你试过“mysql dbname < backup.sql”吗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:11:06.410

我找到了一个糟糕的解决方案：

删除文件中的所有其他查询行并执行。

> `mysql dbname < backup.sql`

# c++ - 通过 QGraphicsItem 剪辑 QPainterPath

> ID：10950690
> 
> 赞同：1
> 
> 时间：2012-06-08T14:22:22.780
> 
> 标签：c++, qt, graph, qgraphicsitem

在下面的屏幕截图中，所有节点都是从 QGraphicsItem 派生的，所有边都是由 QPainterPath 的实例绘制的。

（为清楚起见着色） ![](../Images/984f7d0955bf3f69ee1b890221471f64.png)

是否可以让节点夹住/遮挡边缘？理想情况下，我希望边缘在“进入”节点后立即不可见。QPainterPath 可以做到这一点，还是我必须使用另一种方式来绘制路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T21:02:54.977

如果您使用[GraphicsLineItem](http://doc.qt.nokia.com/4.7-snapshot/qgraphicslineitem.html)而不是[QPainterPath](http://doc.qt.nokia.com/4.7-snapshot/qpainterpath.html) ，那么您可以访问[setZValue](http://doc.qt.nokia.com/4.7-snapshot/qgraphicsitem.html#setZValue)来执行此操作。

我没有立即看到使用[QPainterPath](http://doc.qt.nokia.com/4.7-snapshot/qpainterpath.html)执行此操作的方法。

# c# - Web请求超时

> ID：10950691
> 
> 赞同：1
> 
> 时间：2012-06-08T14:22:30.487
> 
> 标签：c#, silverlight, asynchronous, exception-handling, webrequest

我有以下错误：

> ((MS.Internal.InternalWebRequestStream)requestStream).ReadTimeout (and WriteTimeout) 抛出了 System.InvalidOperationException 类型的异常

在[MSDN](http://msdn.microsoft.com/en-us/library/system.io.stream.writetimeout.aspx)上是这样说的：

> 应重写 WriteTimeout 属性以为流提供适当的行为。如果流不支持超时，则此属性应引发 InvalidOperationException。

所以我想确切地了解我应该做什么以避免这种异常

这是我的代码。在点击事件中，我有：

```
DispatcherHelper.CheckBeginInvokeOnUI(() =>
{
    th = new Thread(StartSaveDataSource);
    th.Start();
}); 
```

这是我将 xml 中的数据发送到 php 的函数

```
private void StartSaveDataSource()
{
    Uri uri;
    String str = String.Empty;
    str = @"http://example.com/new/index.php?action=getmongopod";

    DispatcherHelper.CheckBeginInvokeOnUI(() =>
        {
            try
            {
                XmlSerializer serializer = new XmlSerializer(typeof(Model));
                using (StringWriter writer = new StringWriter())
                {
                    serializer.Serialize(writer, dataSource);
                }

                using (StringWriter stringWriter = new StringWriter())
                {
                    serializer.Serialize(stringWriter, dataSource);
                    xmlString = stringWriter.GetStringBuilder().ToString().Replace(@"encoding=""utf-16""", @"encoding=""utf-8""");
                }
                Uri strReq;
                bool isStrReqGained = false;
                if (Application.Current.IsRunningOutOfBrowser)
                {
                    strReq = new Uri(str, UriKind.Absolute);
                    isStrReqGained = true;
                }
                else
                {
                    Uri docUri = HtmlPage.Document.DocumentUri;
                    if (docUri == null || String.IsNullOrWhiteSpace(docUri.AbsolutePath))
                    {
                        strReq = null;
                    }
                    else
                    {
                        strReq = new Uri(docUri, SilverlightApplication2.Resources.Urls.GetMongoPod);
                        isStrReqGained = true;
                    }

                }

                if (isStrReqGained)
                {
                    WebRequest webRequest = WebRequest.Create(strReq);
                    webRequest.Method = "POST";
                    webRequest.ContentType = "application/x-www-form-urlencoded";
                    webRequest.BeginGetRequestStream(CreateCustomRequest, webRequest);
            }catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
            }
        });
} 
```

这是 asyncCallback 操作

```
private void CreateCustomRequest(IAsyncResult asyncResult)
{
    try
    {
        WebRequest request = (WebRequest) asyncResult.AsyncState;
        Stream requesStream = null;
        try
        {
            requesStream = request.EndGetRequestStream(asyncResult);
            using (StreamWriter writer = new StreamWriter(requesStream))
            {
                requesStream = null;
                writer.Write("xmlstring=" + HttpUtility.UrlEncode(xmlString));
            }
        }
        catch(Exception ex)
        {
            DispatcherHelper.CheckBeginInvokeOnUI(() => MessageBox.Show(ex.ToString()));
        }
        finally
        {
            if (requesStream != null)
            {
                requesStream.Close();
            }
        }
        request.BeginGetResponse(ReadResponse, request);
    }
    catch (Exception ex)
    {
        DispatcherHelper.CheckBeginInvokeOnUI(() => MessageBox.Show(ex.Message));
    }
} 
```

# mobile - 如何在 Cordova (PhoneGap) 应用程序中有效存储大量内容？

> ID：10950696
> 
> 赞同：0
> 
> 时间：2012-06-08T14:22:44.417
> 
> 标签：mobile, cordova

我正在开发包含大约数据的 Cordova 应用程序。3000 个对象。一般数据包含标题、对象位置、描述和对象图像。

现在，我使用对象文字表示法将“元数据”（位置、标题和 ID）存储在 javascript 文件中，并在启动时加载它。描述（格式化文本）存储在单独的 html 文件中，这些文件按需加载到 iframe 中。

有一段时间一切都很好，因为我只在项目中添加了大约 10 个对象描述。加载大部分描述后，应用程序启动时间增加到 10 多秒。

似乎问题在于 Cordova 无法处理包含大量文件的项目，因为它们都在启动时得到处理。那么，可以使用哪些技术来最大限度地减少文件数量，而不会大大增加代码复杂性并提高应用程序性能呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:45:39.793

如果您有 3000 个对象，最好将它们存储在数据库中，然后在应用程序启动时进行设置：

[http://simonmacdonald.blogspot.com/2011/12/on-second-day-of-phonegapping-copying.html](http://simonmacdonald.blogspot.com/2011/12/on-second-day-of-phonegapping-copying.html)

# javascript - div在点击时不显示

> ID：10950708
> 
> 赞同：-1
> 
> 时间：2012-06-08T14:23:26.803
> 
> 标签：javascript, jquery

我在使用 JQuery 单击时显示 div 时遇到了一些问题。所有代码对我来说都是正确的。在我的网站上，我有一个搜索栏，我正在尝试向其中添加搜索建议。但默认情况下，我希望它被隐藏。只有当用户选择“显示建议”时，它才会出现。表单操作为空是无关紧要的。即使我将表格全部删除，它也不起作用。我没有收到任何错误。我已经尝试解决这个问题一个多小时了，我感谢任何帮助。

HTML

```
<form action="">
    <input type="text" id="txt1" onkeyup="showHint(this.value)" />
    <input type="submit"  value="Search" /><button id="hint"/>Show Suggestions </button>
</form>

<div id="searchhint" style="display:none; border:1px solid red; width:300px;" > Suggestions:<span id="txtHint"></span></font></div> 
```

jQuery

```
$(document).ready(function(){
  $("#hint").click(function(){
    $("#searchhint").show();
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:26:17.493

您的 HTML 格式不正确，您关闭了一个从未在该#searchhint div 中打开的“字体”标签。无论如何，字体标签都会贬值，所以你应该避免使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:26:23.980

您必须阻止默认行为。使用[`preventDefault`](http://api.jquery.com/event.preventDefault/)功能

```
$(document).ready(function(){
  $("#hint").click(function(e){
    e.preventDefault();  
    $("#searchhint").show();
  });
}); 
```

示例：http: [//jsfiddle.net/Nbq9Y/3/](http://jsfiddle.net/Nbq9Y/3/)

假设您有有效的 HTML 标记并且页面中没有其他脚本错误，这应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:52:38.567

我忘了加载 JQuery。我的页面上运行了 JavaScript，所以我认为 JQuery 应该也可以工作，尽管我知道必须先加载它才能工作。所以对于所有有类似问题的人，首先检查你是否加载了 JQuery。

```
<script src="jquery.js"></script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:26:55.153

查看您的按钮标签...在“显示建议”之前您已将其关闭

# java - Java：通过 TCP 读/写压缩对象

> ID：10950714
> 
> 赞同：1
> 
> 时间：2012-06-08T14:23:49.673
> 
> 标签：java, sockets, tcp, compression, objectinputstream

我必须通过套接字通过 TCP 传输一些记录。我用过`ObjectInputStream`并且`ObjectOutputStream`效果很好。一个批判性的想法是套接字打开一次，并且必须在整个通信过程中保持打开状态，但每一方都多次读取和写入（所以它更像是一个持久连接）。

为了提高整体性能，我尝试在编写对象之前对其进行压缩，结果非常令人鼓舞，但是由于我使用了`GZIPOutputStream`and `ByteArrayOutputStream`，因此内存开销太大，在某些情况下会出现 OutOfMemory 错误。

我试过`DeflaterOutputStream`了，但它似乎不适合写对象。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:29:54.317

Java 序列化很方便，但在大小和 CPU 使用方面都无效。如果您想要高性能，建议您使用完全不同的通信协议，例如基于[协议缓冲区](http://code.google.com/p/protobuf/)或其他轻量级的协议。

# ajax - 为什么 Internet Explorer 缓存 xhr 请求？

> ID：10950717
> 
> 赞同：2
> 
> 时间：2012-06-08T14:24:04.810
> 
> 标签：ajax, internet-explorer, http, xmlhttprequest

我看到很多关于如何使用 IE 和 Ajax 修复过度激进的缓存的问题，但我似乎找不到任何关于他们为什么会这样做的信息。是否有理由缓存 ajax 调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:28:34.570

缓存 ajax 结果是明智的，原因与缓存非 ajax 响应的原因相同。如果您已经在缓存中拥有数据，您不希望往返于服务器。如果您想强制进行行程，您可以指示数据*不要*通过响应标头进行缓存，或者使用各种其他方法进行缓存清除，例如将当前时间戳附加到请求的查询字符串。

# ipad - iPad：如何使用 CGAffineTransformScale 创建动态条形图？

> ID：10950724
> 
> 赞同：0
> 
> 时间：2012-06-08T14:24:31.077
> 
> 标签：ipad, bar-chart, cgaffinetransformscale

我正在尝试通过缩放条形图（滑块）和平移端盖来创建动画条形图。端盖按预期工作，但是，当我尝试水平缩放它时，“滑块”会平移。

```
-(void) animateBarOpen: (NSInteger) rowIndex {
    NSLog(@"%s: row=%d %@", __FUNCTION__, rowIndex, [self.values objectAtIndex:rowIndex]);
    NSMutableDictionary *row = [self.values objectAtIndex:rowIndex];
    UIImageView *slider = [row objectForKey:@"slider"];
    UIImageView *endCap = [row objectForKey:@"image"];
    UILabel *labelInfo = [row objectForKey:@"label"];
    [labelInfo setText: [NSString stringWithFormat: @"%@ %@", [row objectForKey:@"quantity"], [row objectForKey:@"color"]]];
    [labelInfo setTextColor: productColor];

    float quantity = [(NSNumber*) [row objectForKey:@"quantity"] floatValue];
    float tx = 10.0f * quantity;
    float sx = -40.0f * quantity;

    [UIView beginAnimations:@"open" context:nil];
    [UIView setAnimationDuration:0.25];
    [UIView setAnimationDelay:0.0];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];

    slider.transform = CGAffineTransformScale(CGAffineTransformIdentity, sx, 1.0f);

    endCap.transform = CGAffineTransformTranslate(CGAffineTransformIdentity, tx, 0.0f);
    labelInfo.transform = CGAffineTransformTranslate(CGAffineTransformIdentity, tx, 0.0f);

    [UIView commitAnimations];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:38:31.927

好的 - 我找到了一个很好的参考来解释允许我修复代码的问题。基本上，由于缩放是基于视图的中心属性，因此它会平移原点。因此，您必须将视图（重新）平移到您希望平移的位置，作为缩放移动位置的平移距离的比率。

[揭秘 CGAffineTransform](http://iphonedevelopment.blogspot.com/2008/10/demystifying-cgaffinetransform.html "揭秘核心转换")

下面是我的代码（有效），您会注意到前后宽度比的计算，然后按该数量进行转换。查看（动画之后）的计算`sx`和第二次计算。`tx`我认为两者都应该出现在动画中，但是如果第二个翻译在开始/提交中，那将无法正常工作。

*另请注意：我留下了一些装饰代码，用于在栏的顶端显示彩色标题。*

-

```
(void) animateBarOpen: (NSInteger) rowIndex withDuration: (NSTimeInterval) duration {
    if (VERBOSE_LOG) {
        NSLog(@"%s: row=%d %@", __FUNCTION__, rowIndex, [self.values objectAtIndex:rowIndex]);
    }

    NSMutableDictionary *rowValues = [self.values objectAtIndex:rowIndex];
    NSMutableDictionary *rowOutlets = [self.iboutlets objectAtIndex:rowIndex];
    UIColor *productColor = [InfographView colorByName: [rowValues objectForKey: @"color"]];
    UIImageView *slider = [rowOutlets objectForKey:@"slider"];
    UIImageView *endCap = [rowOutlets objectForKey:@"image"];
    UILabel *labelInfo = [rowOutlets objectForKey:@"label"];
    NSAssert1(labelInfo != nil, @"labelInfo is NULL??", nil);
    [labelInfo setBackgroundColor: productColor];
    // (255, 253, 208)
    UIColor *creamColor = [UIColor colorWithRed:255.0/255.0f green:253.0/255.0f blue:208.0/255.0f alpha:0.9];
    [labelInfo setTextColor: creamColor];
    if ([(NSString*)[rowValues objectForKey:@"color"] isEqualToString:@"Black"]) {
        [labelInfo setShadowColor: [UIColor grayColor]];
    } else {
        [labelInfo setShadowColor: [UIColor blackColor]];
    }
    [labelInfo setText: [NSString stringWithFormat: @"%@ %@", [rowValues objectForKey:@"quantity"], [rowValues objectForKey:@"color"]]];

    [slider setHidden:YES];
    [slider setAlpha: 0.7f];

    float rangeScale = [self computeRangeScale: self.values forWidth: CGRectGetWidth(self.frame) - MARGINS];

    slider.transform = CGAffineTransformIdentity;

    float quantity = [(NSNumber*) [rowValues objectForKey:@"quantity"] floatValue];
    float tx = rangeScale * quantity;
    float sx = tx / CGRectGetWidth(slider.frame); // (CGRectGetWidth(endCap.frame) - CGRectGetWidth(slider.frame));

    float sliderWidth = CGRectGetWidth(slider.frame);

    [slider setHidden:(rowIndex == -1)];

    [UIView beginAnimations:@"open" context:nil];
    [UIView setAnimationDuration:duration];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];

    slider.transform = CGAffineTransformScale(CGAffineTransformIdentity, sx, 1.0f);
    endCap.transform = CGAffineTransformTranslate(CGAffineTransformIdentity, tx, 0.0f);
    labelInfo.transform = CGAffineTransformTranslate(CGAffineTransformIdentity, tx, (-rowIndex*1.0f));
    [labelInfo setAlpha:1.0];

    [UIView commitAnimations];

    tx = 1.0f * (CGRectGetWidth(slider.frame) - sliderWidth) / (sx*2.0f);      slider.transform = CGAffineTransformTranslate(slider.transform, tx, 0.0f);
    [slider setHidden:NO];

} 
```

# excel - Excel 宏/模块帮助 - 如何编写代码以自动调整单元格宽度

> ID：10950729
> 
> 赞同：0
> 
> 时间：2012-06-08T14:24:42.357
> 
> 标签：excel, vba, module

我从这个站点获得了 Excel 的模块/宏：[发送 Excel 内容电子邮件的宏][1] 宏有效，除了单元格太小，每个单元格中的数据量都太小，我如何在其中编写脚本使用单元格内的数据相应地调整单元格宽度的代码。单元格的数据量不同。谢谢！

```
Sub Send_Row()
      ' Don't forget to copy the function RangetoHTML in the module.
      ' Working in Office 2000-2010
Dim OutApp As Object
Dim OutMail As Object
Dim cell As Range
Dim rng As Range
Dim Ash As Worksheet

Set Ash = ActiveSheet
On Error GoTo cleanup
Set OutApp = CreateObject("Outlook.Application")

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

For Each cell In Ash.Columns("B").Cells.SpecialCells(xlCellTypeConstants)
    If cell.Value Like "?*@?*.?*" And LCase(cell.Offset(0, 1).Value) = "yes" Then

        Ash.Range("A1:AE100").AutoFilter Field:=2, Criteria1:=cell.Value

        With Ash.AutoFilter.Range
            On Error Resume Next
            Set rng = .SpecialCells(xlCellTypeVisible)
            On Error GoTo 0
        End With

        Set OutMail = OutApp.CreateItem(0)

        On Error Resume Next
        With OutMail
            .To = cell.Value
            .Subject = "CSI"
            .HTMLBody = RangetoHTML(rng)
            .Display  'Or use Send
        End With
        On Error GoTo 0

        Set OutMail = Nothing
        Ash.AutoFilterMode = False
    End If
Next cell

       cleanup:
Set OutApp = Nothing
With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With
      End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:16:54.040

我用

`Excel.Rows.AutoFit`

和

`Excel.Columns.AutoFit`

使工作表单元格自动调整到适合其内容的最佳高度和宽度。

您可以在代码中的任何位置调用这两行代码，但我会在创建电子邮件之前这样做。

作为替代方案，如果您想手动操作，我使用以下快捷键：

`Alt`+ `O`+ `C`+ `A`- 自动调整列
`Alt`+ `O`+ `R`+ `A`- 自动调整行

# javascript - RequireJS：模块函数是在每次导入模块时执行还是第一次执行？

> ID：10950730
> 
> 赞同：2
> 
> 时间：2012-06-08T14:24:46.927
> 
> 标签：javascript, requirejs

我意识到我可以用一个简单的测试项目来回答自己（如果没有人马上插话，我可以），但我在 SO 或谷歌上的任何地方都找不到答案，这似乎很关键：

如果我这样定义一个带有 require.js 的 AMD 模块：

```
//a.js
define( ['stuff'], function (Stuff) {
     return { thing: new Stuff() };
} 
```

然后我在其他两个不同的模块中使用它：

```
// b.js
define( ['a'], function(a) {
    // do something with a's stuff 
});

// c.js
define( ['a'], function(a) {
  //do something else with a's stuff
} 
```

每次我为另一个模块需要它时， 是否`a`会调用 's 定义函数（因此是一个新的实例化），或者它是否只被调用一次，并且它的输出被缓存？`Stuff`

显然，这在某些用例中至关重要，但从 require.js 文档或我见过的其他示例中并不清楚。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:38:14.243

我刚刚自己测试了这个，看起来构造函数只运行了一次。

```
// stuff.js
define(function() {
    return function() {
        console.log('making new!');
    };
});

// a.js
define( ['stuff'], function (Stuff) {
     return { thing: new Stuff };
});

// b.js
define( ['a'], function(a) {
});

// c.js
define( ['a'], function(a) {
});

// app.js
define(['b', 'c'], function() {
    console.log('app');
});

// index.html
<html>
<head>
    <script src='requirejs/require.js' data-main='app.js'></script>
</head>
</html> 
```

当我打开 index.html 时，控制台显示：

```
making new!                             stuff.js:3
app                                       app.js:2 
```

# c# - 将 Debug.WriteLine 流重定向到文本块

> ID：10950732
> 
> 赞同：3
> 
> 时间：2012-06-08T14:24:52.310
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone

我想将调试标准输出流重定向到文本块。有没有简单的方法可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-03T10:12:34.660

将自定义 Tracelistener 添加到您要收听的输出。

这是一个简单的类，它扩展 TraceListener 并获取要在构造函数中更新的 TextBox

```
class TextBoxTraceListener : TraceListener
{
    private TextBox tBox;

    public TextBoxTraceListener(TextBox box)
    {
        this.tBox = box;
    }

    public override void Write(string msg)
    {
        //allows tBox to be updated from different thread
        tBox.Parent.Invoke(new MethodInvoker(delegate()
        {
            tBox.AppendText(msg);
        }));
    }

    public override void WriteLine(string msg)
    {
        Write(msg + "\r\n");
    }
} 
```

在创建表单句柄后，在表单代码中初始化 TextBoxTraceListener：

```
 protected override void OnHandleCreated(EventArgs e)
    {
        TextBoxTraceListener tbtl = new TextBoxTraceListener(TheTextBox);
        Debug.Listeners.Add(tbtl);
        Debug.WriteLine("Testing Testing 123");
    } 
```

完毕。如果你想听 Trace 而不是 Debug 输出：

```
Trace.Listeners.Add(tbtl); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:32:23.123

将 TextWriterListener ( [http://msdn.microsoft.com/en-us/library/system.diagnostics.textwritertracelistener.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.textwritertracelistener.aspx) ) 添加到您的调试中，并让侦听器使用结果流的 ReadToEnd() 调用将其内容刷新到您的文本中。

如果这不可用，您可以为表单实现自己的侦听器并将其输出到您的文本框。像这样的东西应该可以解决保存您的 TextBox 的表单也实现此 TextListener 并且将 textBox 传递给侦听器的技巧。

```
class TextListener : TraceListener
{
    private TextBox tBox;

    TextListener( TextBox box)
    {
      this.tBox = box;
    }

    public override void Write(string msg)
    {
       if(box== null) return;

       box.Text += msg;
    }

    public override void WriteLine(string msg)
   {
      if(HandleText == null) return;
      Write(msg);
      box.Text += "\r\n";
   }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T10:14:53.207

WP7似乎没有解决方案。我想我必须等待下一个版本。

# algorithm - 高斯曲线拟合算法

> ID：10950733
> 
> 赞同：4
> 
> 时间：2012-06-08T14:24:54.360
> 
> 标签：algorithm, statistics, curve-fitting, gaussian

伙计们，我一直在尝试为某些看起来像扭曲的正态分布的数据集获得高斯拟合。我一直在使用软件来做到这一点。我想知道我是否可以应用迭代算法将这些数据集转换为高斯拟合曲线，原始曲线的标准偏差和平均值是输入。？有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:30:28.910

1.  计算数据的平均值：`mu = 1/N Sum(xi)`
2.  计算数据的离散度：`sigma = sqrt(1/(N-1) Sum(xi-mu))`
3.  填写参数：`gauss = 1/(sigma*sqrt(2pi)))*exp(-1/2*((x-mu)/sigma)^2)`

我认为没有必要用简单的数学来拟合野兽。

# php - 用php更改css值

> ID：10950734
> 
> 赞同：6
> 
> 时间：2012-06-08T14:24:55.730
> 
> 标签：php, css

如何从管理员更改在我的主页上显示一些文本的 div 的 css。我希望当我在插件管理页面中输入颜色代码时，代码会在 css 文件中更新。这是一个常见的事情，但无法掌握它。

所以这是我的div的css。

```
#div{

background: #0000;

} 
```

这是我的管理部分的 php 代码。

```
<?php 
 Background Color: <input type="text" size="20" name="background"
 value="<?php get_option('backgroundchanges');?>"/> 
```

所以基本上我希望我在输入中输入的值反映在 css 文件中。

谢谢你的帮助。

问候， ：）

-Ron。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-08T14:28:20.857

您实际上不应该使用 .css 文件，而应使用 .php 文件作为 .css 文件。然后，您可以将新颜色设置为 .php css 文件中的变量。

将您的 style.css 文件重命名为 style.php，然后将以下内容添加到文件顶部：

```
<?php header("Content-type: text/css"); ?> 
```

这一行告诉浏览器该文件是 CSS 而不是 HTML。在您的 HTML 文件中，将样式表引用从 style.css 更改为 style.php。例如：

```
<link rel="stylesheet" type="text/css"
 media="screen" href="style.php"> 
```

引用：[http ://www.barelyfitz.com/projects/csscolor/](http://www.barelyfitz.com/projects/csscolor/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T14:32:01.390

通过 PHP 输出 CSS 文件会增加服务器的开销，因为您需要创建动态 HTML 和 CSS。鉴于 CSS 的“级联”性质，HTML 页面中提供的任何内联样式都将覆盖 CSS，因此您很可能只需将一些内联样式添加到 PHP 已经提供的页面中即可。另一种选择是使用 Javascript 更新 CSS，这是一种方法，但我不相信这适用于所有浏览器（我在 iOS 上的 Webkit 中使用它）：-

```
var cssStyle = getCSSRule('#styleName');
cssStyle.style.background = redfinedColour; 
```

...从这里使用 getCSSRule：-

[http://www.hunlock.com/blogs/Totally_Pwn_CSS_with_Javascript](http://www.hunlock.com/blogs/Totally_Pwn_CSS_with_Javascript)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T14:36:53.950

我的做法是有一个内容加载器控制器或脚本来加载图像/css/js 并将它们传递给浏览器，您还可以控制缓存并动态创建 javascript，例如 tinyMCE 等中的图像列表：

这是一个精简的例子，但你明白了。

```
<?php 
$filename = value passed from url

if(file_exists(SITE_ROOT.'/templates/'.$theme.'/css/'.basename($filename))==true){
    $fullpath=SITE_ROOT.'/templates/'.$theme.'/css/'.basename($filename);
    header("Content-type: text/css");
    $search=array('{SITE_URL}','{BACKGROUND}');
    $replace=array('http://example.com',get_option('backgroundchanges'));
    echo str_replace($search,$replace,file_get_contents($fullpath));
    die;
}else{
    die('CSS file does not exist!');
}

?> 
```

然后让你的 css 文件用你的参数替换占位符：

```
#div{
background: #{BACKGROUND} url('{SITE_URL}/stripe.png') repeat;
} 
```

# java - 在使用 Maven 运行 Selenium 测试期间生成 Jenkins 肯定报告时出现 NumberFormatException

> ID：10950737
> 
> 赞同：1
> 
> 时间：2012-06-08T14:25:06.397
> 
> 标签：java, maven, selenium, jenkins, surefire

我们想将 Selenium 测试用例发布到 Jenkins。我们将surefire报告插件配置为生成HTML如下...

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-report-plugin</artifactId>
    <version>2.12</version>
    <configuration>
        <outputDirectory>${project.build.directory}/htmlreport</outputDirectory>
    </configuration>
</plugin> 
```

但是我们在生成报告时得到了 NumberFormatException。请查看以下日志。

```
Waiting for Jenkins to finish collecting data
channel stopped
Publishing Selenium report...
Copying the reports.
parsing resultFile surefire-report.html
Unable to parse surefire-report.html: java.lang.NumberFormatException: null
Finished: SUCCESS 
```

请提供解决问题的建议。

# php - 在 HTML 中用另一个字符串替换一个字符串，但在 HTML 标记和属性 PHP 中没有

> ID：10950741
> 
> 赞同：0
> 
> 时间：2012-06-08T14:25:21.170
> 
> 标签：php, html, replace, domdocument

我需要加载一个 HTML（可能使用 DOMDocument loadHTML），然后将所有单词 A 替换为单词 B，但在 html 标记内没有任何内容。

这意味着在下面的 html 中，如果我们需要用 'TEST' 替换单词 'test' 它只会将文本 'this is a test' 替换为 'this is a TEST' 并且会保持 id="test"

```
<html>
<head></head>
<body>
  <div id="test"> this is a test </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:35:11.843

无法获得足够的 DOMDocument :)

```
$d = new DOMDocument;
$d->loadHTML($html);

$x = new DOMXPath($d);

foreach ($x->query('//text()') as $node) {
    $node->nodeValue = str_replace('test', 'TEST', $node->nodeValue);
}

echo $d->saveHTML(); 
```

不确定总是在 上进行替换是否有任何性能损失`nodeValue`；否则，将循环内容替换为：

```
$s = str_replace('test', 'TEST', $node->nodeValue, $count);
if ($count) {
    $node->nodeValue = $s;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:38:03.703

您可以使用[简单的 html dom 解析器](http://simplehtmldom.sourceforge.net/)：

```
include("simple_html_dom.php");
...
$html = '
<html>
 <head></head>
 <body>
  <div id="test"> this is a test </div>
 </body>
</html>
';

$data = str_get_html($html);
$find = $data->find("div[id='test']",0);
$find->innertext = str_replace("test","TEST",$find->innertext);
$data = $data->save();

echo $data; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:41:52.290

如果您想尝试正则表达式，请查看此答案[replace all "foo" between two HTML tags using REGEX (PHP code)](https://stackoverflow.com/questions/6000508/replace-all-foo-between-two-html-tags-using-regex-php-code)

# opengl - 写入浮点 FBO 时精度低且钳位

> ID：10950743
> 
> 赞同：4
> 
> 时间：2012-06-08T14:25:24.937
> 
> 标签：opengl

我有一个 FBO，它是通过以下方式创建的：

```
glGenRenderbuffers(1, &m_depthStencilBuffer);
glBindRenderbuffer(GL_RENDERBUFFER, m_depthStencilBuffer);
glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_STENCIL, m_width, m_height);
glBindRenderbuffer(GL_RENDERBUFFER, 0);

glGenTextures(1, &m_texture);
glBindTexture(GL_TEXTURE_RECTANGLE_ARB, m_texture);
glTexParameteri(GL_TEXTURE_RECTANGLE_ARB, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_RECTANGLE_ARB, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_RECTANGLE_ARB, GL_TEXTURE_WRAP_S, GL_CLAMP);
glTexParameteri(GL_TEXTURE_RECTANGLE_ARB, GL_TEXTURE_WRAP_T, GL_CLAMP);
glTexImage2D(GL_TEXTURE_RECTANGLE_ARB, 0, GL_RGBA32F_ARB, m_width, m_height, 0, GL_RGBA, GL_FLOAT, 0);
glBindTexture(GL_TEXTURE_RECTANGLE_ARB, 0);

glGenFramebuffers(1, &m_frameBuffer);
glBindFramebuffer(GL_FRAMEBUFFER, m_frameBuffer);
glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_RECTANGLE_ARB, m_texture, 0);
glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, m_depthStencilBuffer);
glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_STENCIL_ATTACHMENT, GL_RENDERBUFFER, m_depthStencilBuffer);
assert(GL_FRAMEBUFFER_COMPLETE == glCheckFramebufferStatus(GL_FRAMEBUFFER));
glBindFramebuffer(GL_FRAMEBUFFER, 0);
assert(GL_NO_ERROR == glGetError()); 
```

然后我用这个最小的片段程序渲染这个：

```
void main() {
    gl_FragColor = float4(3.001001f, 2.00002f, 7.00003f, 4.00004f);
} 
```

如果我像这样读出像素：

```
glReadPixels(0, 0, width, height, GL_RGBA, GL_FLOAT, &pixels[0]); 
```

并检查上述片段程序写入的像素它们是 (1, 1, 1, 1)。我只是`glReadPixels`为了测试目的而添加的，如果我尝试在另一个片段程序中使用`textureRect`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:35:00.287

是的，它将被限制在 (0, 1) 范围内 - 检查[glClampColor](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glClampColor.xhtml)并禁用颜色限制。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T06:02:19.623

问题是我的一个愚蠢的错误，在我调用的 FBO 调整大小代码中：

```
glTexImage2D(GL_TEXTURE_RECTANGLE_ARB, 0, GL_RGBA, ...); 
```

代替

```
glTexImage2D(GL_TEXTURE_RECTANGLE_ARB, 0, GL_RGBA32F_ARB, ...); 
```

# javascript - 使用 asp.net 和 iis 在 geoserver 中进行身份验证

> ID：10950747
> 
> 赞同：4
> 
> 时间：2012-06-08T14:25:45.817
> 
> 标签：javascript, asp.net, openlayers, geoserver

我不知道这是否是一个愚蠢的问题，但是我怎样才能将 asp.net 身份验证与 openlayers 结合起来呢？

我创建了一个登录页面以在 openlayers 中进行身份验证（在 c# 中，服务器端），这是我的代码

```
Uri uri = new Uri("http://"+username+":"+password+"@localhost:1979/geoserver/wms");
        if (uri.Scheme == Uri.UriSchemeHttp)
        {
            HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(uri);
            request.Method = WebRequestMethods.Http.Post;

            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            StreamReader reader = new StreamReader(response.GetResponseStream()); string tmp = reader.ReadToEnd();
            response.Close();
            Response.Write(tmp);
        } 
```

我不知道这是否是解决我的问题的正确方法，无论如何，如果我达到了我的目标（在geoserver中使用用户名和密码进行身份验证），我如何将此身份验证与用户端的openlayers结合起来（javascript）

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T14:31:52.143

要从 javascript 端使用 geoserver 进行身份验证，您必须向 geoserver autentication servlet(j_spring_security_check) 发布帖子。尝试使用此登录功能：

```
 function login (options) {
    // url del servlet del geoserver
    var url = options.server + "/geoserver/j_spring_security_check";
    // parametros para el login
    params = "username=" + options["user"] + "&password="
                + options["password"];

    var contentType = "application/x-www-form-urlencoded";
    //se inicializa la petición ajax
    var ajax = $.ajax({
        data : params,
        type : "POST",
        contentType : contentType,
        url : url
    });
    // se ejecuta cuando la peticion finaliza
    ajax.done(function() {

        if ($.cookie("JSESSIONID") != null && options && options.success) {
            options.success();
        }
    });
    // si ocurrio un error al realizar la peticion
    ajax.fail(function(data) {
        if (options && options.failure) {
            options.failure(data);
        }
    });
    // se ejecuta siempre al final de la petición, sin importar que esta
    // haya fallado
    ajax.always(function() {
        if (options && options.always) {
            options.always();
        }
    });
}; 
```

并使用这种方式

```
 login({
    user:"admin" //geoserver user
    password: "adminPassword", 
    server : "http://192.168.10.1:8080", //geoserver host
    success : function(){
        alert("Login OK!");
    },
    failure : function(){
        alert("Login fail!");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-17T18:06:48.317

由于某种原因，GeoServer 在 2.7 之后无法正确处理身份验证传递。因此，我添加了一种从服务器上的页面方法登录并将身份验证 cookie 保存在会话变量中的方法。不漂亮，但它有效。

```
 'Post a login request to GS.
        Dim myCookies As String = ""
        Dim Method As String = "POST"

        Dim HttpWRequest As System.Net.HttpWebRequest = CType(WebRequest.Create("https://" & GSServer & "/geoserver/j_spring_security_check"), HttpWebRequest)

        Dim PostData As String = "username=" + UID + "&password=" + PWD
        HttpWRequest.KeepAlive = False
        HttpWRequest.Headers.Set("Pragma", "no-cache")
        'HttpWRequest.Headers.Set("Translate", "f")
        HttpWRequest.ContentType = "text/xml"
        HttpWRequest.ContentLength = PostData.Length

        'This is important, otherwise j_spring security check does an immediate redirect, and the cookie is lost.
        HttpWRequest.AllowAutoRedirect = False

        If String.IsNullOrEmpty(UID) = False Then
            HttpWRequest.Credentials = New NetworkCredential(UID, PWD)
        End If

        If String.IsNullOrEmpty(myCookies) = False Then
            HttpWRequest.Headers("Cookie") = myCookies
        End If

        'Set the request timeout to 5 minutes.
        HttpWRequest.Timeout = 300000
        ' set the request method
        HttpWRequest.Method = Method

        If Method = "POST" Or Method = "PUT" Then
            ' Store the data in a byte array.
            Dim ByteQuery() As Byte = System.Text.Encoding.ASCII.GetBytes(PostData)
            HttpWRequest.ContentLength = ByteQuery.Length
            Dim QueryStream As Stream = Nothing
            Try
                QueryStream = HttpWRequest.GetRequestStream()
            Catch e As Exception
                'WriteToLog(e.Message)
                Throw New ArgumentException("Couldn't log into GeoServer.")
            End Try
            ' Write the data to be posted to the Request stream.
            QueryStream.Write(ByteQuery, 0, ByteQuery.Length)
            QueryStream.Close()
        End If

        ' Send the request and get a response.

        Dim HttpWResponse As HttpWebResponse
        Try
            HttpWResponse = HttpWRequest.GetResponse()
        Catch e As Exception
            'WriteToLog(e.Message)
            Throw New ArgumentException("Couldn't log into GeoServer.")
        End Try

        ' Get the Response stream.
        Dim strm As Stream = HttpWResponse.GetResponseStream()

        ' Read the Response stream.
        Dim sr As StreamReader = New StreamReader(strm)
        Dim sText As String = sr.ReadToEnd()

        ' Close the stream.
        strm.Close()

        myCookies = HttpWResponse.GetResponseHeader("Set-Cookie")
        HttpContext.Current.Session("GeoServerSessionID") = myCookies
        ' Clean up.
        HttpWRequest = Nothing
        HttpWResponse = Nothing

        If sText.Contains("Invalid username/password combination") Or String.IsNullOrEmpty(myCookies) Then
            Throw New ArgumentException("Couldn't log into GeoServer.")
        End If 
```

# sql-server - 如何从 CTE 中获取不同的依赖项列表

> ID：10950750
> 
> 赞同：2
> 
> 时间：2012-06-08T14:26:03.417
> 
> 标签：sql-server, tsql, sql-server-2008-r2

我有一个表 task_dependency 如下所示

```
task_id   depend_task_id
-------------------------
1             NULL
2             NULL
3             1
4             2
4             1
5             4
5             3 
```

我尝试运行查询以获取每个任务的不同任务依赖项列表（包括任务本身）。

预期输出（任务列表顺序无关紧要）：

```
task_id depend_task_list
-----------------------------------------------
1       1;
2       2;
3       1;3
4       1;2;4
5       1;2;3;4;5 
```

到目前为止我所拥有的

```
DECLARE @t TABLE (task_id INT, depend_task_id INT)

INSERT INTO @t VALUES (1, NULL),(2,NULL),(3,1),(4,2),(4,1),(5,4),(5,3)

;WITH AllDependency (task_id,depend_task_list)
AS(  
   SELECT 
     task_id,
     depend_task_list=CAST(task_id AS VARCHAR(4000))
   FROM @t
   WHERE depend_task_id IS NULL
 UNION ALL
   SELECT 
     t.task_id,
     depend_task_list= CAST(CAST(t.task_id AS VARCHAR(10)) + ';' + depend_task_list AS VARCHAR(4000))
   FROM @t t
   INNER JOIN AllDependency  AS d
        ON d.task_id = t.depend_task_id
) 
SELECT 
    task_id,
    (SELECT depend_task_list + ';' FROM AllDependency d2 WHERE d.task_id = d2.task_id FOR XML PATH('')) AS depend_task_list
FROM AllDependency d
GROUP BY task_id
ORDER BY task_id 
```

电流输出：

```
task_id depend_task_list
-----------------------------------------
1           1;
2           2;
3           3;1;
4           4;2;4;1;
5           5;4;2;5;4;1;5;3;1; 
```

问题：如何在不使用光标的情况下获得不同的任务依赖列表？

SQLFiddle 链接[http://sqlfiddle.com/#!3/4c034/2](http://sqlfiddle.com/#!3/4c034/2)

提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:54:12.087

好的，试试这个查询，看看它是否有帮助：

```
DECLARE @t TABLE (task_id INT, depend_task_id INT)

INSERT INTO @t VALUES (1, NULL),(2,NULL),(3,1),(4,2),(4,1),(5,4),(5,3)

;WITH CTE AS
(
    SELECT *
    FROM @t
    UNION ALL
    SELECT A.task_id, B.depend_task_id
    FROM CTE A
    INNER JOIN @t B
    ON A.depend_task_id = B.task_id
    --WHERE B.depend_task_id IS NOT NULL
), CTE2 AS 
(
    SELECT DISTINCT task_id, ISNULL(depend_task_id,task_id) depend_task_id
    FROM CTE
)
SELECT  t1.task_id, 
        STUFF( (SELECT ';' + CAST(t2.depend_task_id AS VARCHAR(5))
                FROM CTE2 t2
                WHERE t2.task_id = t1.task_id
                ORDER BY depend_task_id
                FOR XML PATH('')),1,1,'') AS depend_task_list
FROM CTE2 t1
GROUP BY task_id 
```

[这](http://sqlfiddle.com/#!3/f2186/1)是对 sqlfiddle 的测试。

# wpf - 为什么这个简单的 WPF 绑定不起作用？

> ID：10950753
> 
> 赞同：1
> 
> 时间：2012-06-08T14:26:12.377
> 
> 标签：wpf, binding

我有一个绑定到过滤的 DataView 的按钮（总是 1 条记录）：

```
<Button x:Name="btnValidate" Grid.Row="0" Grid.RowSpan="2" Grid.Column="3" Cursor="Hand" Click="btnValidate_Click">
    <Button.Style>
        <Style TargetType="{x:Type Button}">
            <Setter Property="Background" Value="{StaticResource ValidationNoneBrush}" />
            <Setter Property="Tag" Value="{Binding VALIDATED, Converter={StaticResource DebugConverter}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border x:Name="bdrValidate" Background="{TemplateBinding Background}">
                            <Image Source="../Images/24/LocationSearch.png" Stretch="None" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Tag" Value="1">
                    <Setter Property="Background" Value="Blue"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Button.Style>
</Button> 
```

如您所见，我有一个用于调试的转换器，它工作正常。我看到通过转换器的值是 0 和 1。那么为什么背景没有根据 Style Trigger 而改变呢？我想不通...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:05:22.443

大概您的转换器返回整数 0 或整数 1？该`Tag`属性是 type `Object`，因此 XAML 编译器假定触发器中的“1”值是 a `string`，而不是`int`

将转换器更改为返回 a ，或在触发器中`string`指定一个值：`int`

```
<Trigger xmlns:sys="clr-namespace:System;assembly=mscorlib" Property="Tag">
    <Trigger.Value>
        <sys:Int32>1</sys:Int32>
    </Trigger.Value>
</Trigger> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:04:04.867

我认为您的问题是，由于 Tag 是对象类型，因此 1 值被视为字符串，如果您的属性`VALIDATED`是 int。

正如 msdn 所述，[Trigger.Value](http://msdn.microsoft.com/en-us/library/system.windows.trigger.value.aspx)执行[引用相等性](http://msdn.microsoft.com/en-us/library/dd183759.aspx)检查。而且`Object.ReferenceEquals("1", 1)`是假的。

如果您将`VALIDATED`属性修改为字符串，它应该可以正常工作。

# web-services - 架构：如何将实体框架的 dbContext 存储在 Web 服务中？

> ID：10950755
> 
> 赞同：0
> 
> 时间：2012-06-08T14:26:18.520
> 
> 标签：web-services, entity-framework, architecture, entity-framework-4, n-tier-architecture

通常，使用`dbContext`from Entity Framework 的代码如下所示：

```
using (var context = new SMDbContext())
{
    context.StartTransaction();

    var userCrudLogic = new UserEntityCrudLogic(context);
    userCrudLogic.CreateUser(...);

    context.SaveChanges();
    context.Commit();
} 
```

就我而言，我想在 Web 服务中使用它，而不是调用我的 CRUD 逻辑，我想调用业务逻辑来做一些验证和其他事情。之后的业务逻辑会调用 CRUD 逻辑。

我的问题是我不知道如何将上下文存储或传递给 CRUD 逻辑。最简单的方法是使用参数，但我不想在所有业务逻辑功能中都有不需要的参数。

我认为最好有一个类似“上下文管理器”的东西，它负责存储和提供当前请求的上下文。比我可以使用 IoC 或类似的东西在需要的地方加载上下文。

但是这样的“经理”应该是什么样子以及我必须如何/在哪里存储它？

如果我在 IoC 中将其注册为单例（in `global.asax`），它将在所有请求中共享还是对每个请求都是唯一的？

对不起，如果我的问题看起来很愚蠢或类似的东西，但我以前从未做过这样的事情，现在想学习它们！所以我不想让它工作，我想知道最好的方法是什么。如果有什么不清楚的，请尽管问！

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:57:25.273

您可能必须为您的 Web 应用程序配置每个请求的上下文。[做一个谷歌，你会在 ASP.NET MVC 中](https://stackoverflow.com/questions/6334592/one-dbcontext-per-request-in-asp-net-mvc-without-ioc-container)得到类似这样的[缓存实体框架 DbContexts 每个请求](https://stackoverflow.com/questions/6580757/caching-entity-framework-dbcontexts-per-request)和一个 DbContext（没有 IOC 容器）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:42:13.817

我很确定如果 Web 服务客户端启用了 cookie 并且您正在存储会话数据，那么您应该能够使用 Session 对象来存储它。我不确定这是多么明智或安全。

# c++ - 未初始化的值在 Linux 上的行为符合预期，但在 Windows 上则不然

> ID：10950756
> 
> 赞同：2
> 
> 时间：2012-06-08T14:26:22.093
> 
> 标签：c++, visual-studio-2010, g++

为什么未初始化的“max”和“min”值在 Linux 上有效，而在 Windows 上无效？例如：

```
double max, min, test;
while (1)
{
  std::cin >> test;
  if (test > max)
    max = test;

  if (test < min)
    min = test;
} 
```

这适用于 Linux。我知道一个事实，因为我已经使用它（尽管直到现在我才意识到这是多么可怕）至少 3 个月了。但是，许多同事告诉我，这在他们的机器上被破坏了：他们使用 Visual Studio 编译。他们的陈述是否有道理，为什么？这仅仅是UB的情况吗？如果是这样，在我没有注意到的情况下，过去几个月它是如何工作的？

另请注意：gcc (Ubuntu/Linaro 4.5.2-8ubuntu4) 4.5.2 和 Visual Studio 2010

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T14:28:50.520

这在任何平台上都“有效”。

它所做的只是调用*Undefined Behavior*。*“似乎做到了我的预期”*只是*UB*实现自身的一种方式。然而，这是一个相当不幸的问题，因为它让你相信你的代码是好的，直到有一天它突然出现在你客户的脸上。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T14:27:20.950

因为未定义的行为是未定义的。它可能有效，也可能无效，你只是不知道。显然，在您的 linux 环境中，它可以工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T14:48:45.653

粗略地说，如果未初始化的变量`min`恰好`max`包含在`test`. 未初始化的自动变量的对象表示可能一致，也可能不一致，这取决于编译器、选项和程序其余部分中的代码。读取一个未初始化的值肯定是 UB。UB 可能一致，也可能不一致。

因此，例如，您可以获得观察到的行为的一种简单方法是：

*   您的测试集都包含正值和负值，
*   gcc/linux 始终在未初始化的变量中放置一个全位为零的表示，
*   VS 始终将 NaN 放入未初始化的变量中（因此`test < min`和`test > max`都始终为假）。

根据您的测试数据是什么，以及“在他们的机器上损坏”的含义，细节可能会有所不同。我刚刚描述了 UB 无限范围之外的一种可能性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-08T14:27:34.293

使用未初始化变量的值是未定义的行为，因此任何事情都可能发生。*任何东西*，这意味着代码可能**看起来**可以工作，它可能会崩溃，或者它可能会导致恶魔飞出你的鼻子。

# java - 任何人都知道 jpackage 到底是做什么的？

> ID：10950759
> 
> 赞同：5
> 
> 时间：2012-06-08T14:26:31.310
> 
> 标签：java

在进行一些部署时，我看到 java 有时会附带 jpackage。jpackage到底是做什么的，有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:41:07.967

JPackage 采用了一些常用的 Java 技术，并将它们组织到 RPM 包管理器中。

为此，他们基本上编写了大量 RPM 规范文件，并在各种软件组件（JUnit、javac 等）随时间变化时对其进行维护。它们还改进了 Java 软件堆栈与其他计划（如 Linux 标准库）的一致性。

当事情进展顺利时，最终结果是每个库都在“正确”的位置，并且需要库的软件组件不会附带多个副本（一个 JUnit 用于 Netbeans，一个 JUnit 用于 Eclipse，一个 JUnit 用于stand-单独），而是所有软件包都使用“系统”JUnit 库。这样做可以让包管理器意识到依赖的复杂性，并从整体上减少所有需要的可安装元素的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-04T19:42:59.620

jpackage 是新开发的用于构建模块化 Java 应用程序的应用程序包。

这是一篇文章如何使用 OpenJDK 11 构建应用程序映像并使用带有 jpackage 的 OpenJDK 14 仅用于构建安装程序/包：[https ://walczak.it/blog/distributing-javafx-desktop-applications-without-requiring-jvm-使用-jlink-and-jpackage](https://walczak.it/blog/distributing-javafx-desktop-applications-without-requiring-jvm-using-jlink-and-jpackage)

# sql-server - 子查询返回超过 1 个值。

> ID：10950764
> 
> 赞同：0
> 
> 时间：2012-06-08T14:26:45.490
> 
> 标签：sql-server

我有这个问题的疑问..有人可以帮助我吗？

这是我的查询

```
select t_tarif.lama, 
    t_tarif.id,
    t_tarif.kurir, 
    t_tarif.id_propd, 
    t_lokasi.propinsi as 'propinsi_asal', 
    t_tarif.kota_asal,
    t_tarif.id_propt,
    (select 
        t_lokasi.propinsi 
        from t_lokasi,t_tarif 
        where t_lokasi.id_prop =t_tarif.id_propt)as 'propinsi_tujuan',
    t_tarif.kota_tujuan, 
    t_tarif.tarif 
from t_tarif,t_lokasi 
where t_lokasi.id_prop = t_tarif.id_propd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:31:13.113

问题出在这个选择中：

```
(select t_lokasi.propinsi from t_lokasi,t_tarif where t_lokasi.id_prop =t_tarif.id_propt) 
```

它只能返回 1 个值，并且返回的值更多。

* * *

一个可能的解决方案是使用`JOIN`：

```
select t.lama,
       t.id,
       t.kurir,
       t.id_propd,
       l.propinsi as 'propinsi_asal',
       t.kota_asal,
       t.id_propt,
       l2.propinsi as 'propinsi_tujuan',
       t.kota_tujuan,
       t.tarif
from t_tarif t
inner join t_lokasi on l.id_prop = t.id_propd
left outer join t_lokasi l2 on l2.id_prop = t.id_propt 
```

我使用左连接来获取另一个子句，因为这似乎是您所需要的。

# mstest - Pex 与 MsTest 之间的主要区别是什么？

> ID：10950768
> 
> 赞同：1
> 
> 时间：2012-06-08T14:27:01.920
> 
> 标签：mstest, pex

Pex 与 MsTest 之间的主要区别是什么？什么时候用什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:49:14.503

我的印象是 Pex 是对 MSTest 或 NUnit 等传统测试框架的补充，而不是竞争框架。像这样的主题：[Pex（测试生成）真的有用吗？](https://stackoverflow.com/questions/2704669/is-pex-test-generation-really-usefull-tool) 似乎表明 Pex 有助于创建由数据驱动的参数化单元测试，以及基于测试本身的断言生成测试，但可以与各种框架一起使用。

# jquery - 使用表单 id 但不使用类提交预防工作

> ID：10950770
> 
> 赞同：0
> 
> 时间：2012-06-08T14:27:14.933
> 
> 标签：jquery, form-submit

此函数工作正常（#new_user 是表单的 id）：

```
$("#new_user").submit(function(e) {
  e.preventDefault();
  return $(".terms").dialog("open");
}); 
```

但是当我尝试添加一个类时，例如：

```
$("#new_user.team-registration").submit(function(e) 
```

它没有。

只有当 form#new_user 也有班级团队注册或艺术家注册时，我怎样才能使它工作？只能是其中之一。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:38:44.020

因为在实际处理该行时该类尚未分配给表单元素，所以选择器不返回任何内容......您可以做的是使用该`.delegate()`函数（类似于您之前期望的 .live() 所做的）。这是一个例子：

```
$("body").delegate("#new_user.team-registration, #new_user.artist-registration", "submit", function() {
  return false; // in jQuery this preventsDefault and stops all propagation 
}); 
```

或者，您可以在向其添加类时将表单元素存储在变量中，然后引用它（这样您就不必遍历 DOM 两次）..

可以在 .delegate() 上阅读更多[内容](http://api.jquery.com/delegate/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:28:27.017

```
$("#new_user").submit(function(e) {
    if(!$(this).hasClass('team-registration') && !$(this).hasClass('artist-registration')) {
        return;
    }
    e.preventDefault();
    $('.terms').dialog('open');
}) 
```

# javascript - 即时创建 Asp.Net 元素 Javascript

> ID：10950772
> 
> 赞同：0
> 
> 时间：2012-06-08T14:27:15.787
> 
> 标签：javascript, asp.net

我正在尝试使用 javascript 动态创建 asp.net 元素。我可以像这样成功地动态创建html元素

```
var _upload = document.createElement("input");

_upload.setAttribute("type", "file");

_upload.setAttribute("ID", "upload" + rownum);

_upload.setAttribute("runat", "server");

_upload.setAttribute("name", "uploads" + rownum); 
```

几个问题：

1.  这是否等同于 asp.net FileUpload 控件？

2.  如何在 javascript 中创建准确的 asp.net 控件？

asp.net fileupload 可以做什么，而我在上面创建的控件不能做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:30:30.113

ASP.NET 是一种服务器端语言，而在这种情况下，JavaScript 被用于客户端。以这种方式在客户端创建的元素对服务器端的 ASP.NET 是不可见的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T14:31:22.763

你不能。ASP.NET 控件在服务器端呈现之前进行编译。并且浏览器对 ASP.NET 一无所知。

最好的办法是向服务器发出 ajax 请求，以便获得编译的 ASP.NET 控件——即普通的 HTML。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T15:12:00.927

Florians 的想法很有用，但是（当然取决于您的情况）可能有一个更简单的解决方法：在呈现页面时创建 fileupload 控件，但将其放入隐藏的 div 中。然后你在 JavaScript 中所要做的就是显示 div。

一些示例代码（asp.net 控件可能是错误的，我已经有一段时间没有使用它们了）：

我的页面.aspx：

```
<div id="fileupload-div">
   <FileUpload id="myupload" runat="server" />
</div>
<button id="mybutton">Show upload control</button> 
```

样式.css

```
#fileupload-div { display: none } 
```

我的页面.js

```
$("#mybutton").click(function() {
    $("#fileupload-div").show();
}); 
```

# gwt - GWT 显示天气

> ID：10950773
> 
> 赞同：-4
> 
> 时间：2012-06-08T14:27:18.877
> 
> 标签：gwt, weather

我想在我的 GWT 应用程序中显示天气。我在服务器端看到了几个这样的例子，这对我来说似乎有点奇怪，因为显然将负载转移到客户端是首选。

我现在研究了很长时间，但找不到答案。这可以在客户端完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:47:49.893

人们在服务器端执行此操作的最可能原因是避免跨站点请求。然而，Weather Underground 提供了一个支持 JSONP 的服务 API，所以我将使用它在客户端实现它。

[http://www.wunderground.com/weather/api/d/documentation.html](http://www.wunderground.com/weather/api/d/documentation.html)

[http://eggsylife.co.uk/2010/04/22/gwt-2-jsonp-and-javascript-overlays-with-jsonprequestbuilder/](http://eggsylife.co.uk/2010/04/22/gwt-2-jsonp-and-javascript-overlays-with-jsonprequestbuilder/)

# c# - Log4Net MemoryAppender 似乎错过了高速日志事件

> ID：10950779
> 
> 赞同：1
> 
> 时间：2012-06-08T14:27:39.473
> 
> 标签：c#, winforms, log4net

我正在使用 log4net MemoryAppender 在表单文本框中显示我的 log4net 输出。我的配置文件的相关部分是：

```
<appender name="MemoryAppender" type="log4net.Appender.MemoryAppender" >
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%level %date %message%newline" />
    </layout>
</appender> 
```

更新表单的代码由计时器触发，如下所示：

```
var events = _memoryAppender.GetEvents();

foreach (var loggingEvent in events)
{
    textBoxOutput.Text += loggingEvent.Level + "  " + loggingEvent.MessageObject + Environment.NewLine;
}
_memoryAppender.Clear(); 
```

它正在工作，但是当我的应用程序在短时间内记录大量消息时，我似乎看不到它们。有谁知道发生了什么？

作为一种解决方法，我使用的是[Chainsaw](http://logging.apache.org/log4net/release/howto/chainsaw.html)和 UDP appender：

```
 <appender name="UdpAppender" type="log4net.Appender.UdpAppender">
    <filter type="log4net.Filter.LevelRangeFilter">
        <param name="LevelMin" value="INFO"/>
        <param name="LevelMax" value="ERROR"/>
    </filter>
    <param name="RemoteAddress" value="127.0.0.1" />
    <param name="RemotePort" value="8080" />
    <layout type="log4net.Layout.XmlLayoutSchemaLog4j, log4net" />
</appender> 
```

不过，我更喜欢我自己的 UI，所以我仍在寻找答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T10:30:57.070

我假设会发生以下情况：当您在文本框中编写日志消息时，会记录新消息。当您清除附加程序中的消息时，您还会删除这些新消息，这些消息不会写入文本框。

您可以通过在开始将消息写入文本框之前清除附加程序来改善这种情况，但我认为您应该创建自己的内存附加程序并提供一种返回消息并一步清除数组的方法。像这样的东西：

```
public class MyMemoryAppender : MemoryAppender
{
    public LoggingEvent[] GetAndClearEvents()
    {
        lock (m_eventList.SyncRoot)
        {
            var events = (LoggingEvent[]) m_eventsList.ToArray(typeof(LoggingEvent));
            m_eventsList.Clear();
            return events;
        }
    }
} 
```

# html - 删除 CSS 按钮轮廓

> ID：10950781
> 
> 赞同：0
> 
> 时间：2012-06-08T14:28:04.897
> 
> 标签：html, css

我试过这个例子：[删除css按钮轮廓，即6.0、7.0](https://stackoverflow.com/questions/7701670/removing-css-button-outline-ie-6-0-7-0)

...通过添加`outline:none;`and`border:none;`但这并不能解决问题，如您在此处看到的：

[http://jsfiddle.net/vVNGw/](http://jsfiddle.net/vVNGw/)

我该怎么做才能摆脱那个讨厌的小轮廓？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-05T19:37:27.517

尝试本文中提到的解决方案。[http://www.karlrixon.co.uk/writing/remove-button-focus-outline-using-css/](http://www.karlrixon.co.uk/writing/remove-button-focus-outline-using-css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:33:23.360

当我查看 jsfiddle 示例时，似乎没有边框。如果您在谈论文本周围按钮内的灰色，只需添加“背景：白色；” 到您的代码，它将是一个与背景颜色相同的按钮，因此您只能看到单词

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-08T14:46:34.417

焦点集中时，不应从按钮或链接中删除轮廓。这对于残障用户和许多其他想知道他们的浏览器是否理解并完成了他们的意图的其他人来说是一个重要的指示（是否成功单击了右键；使用选项卡时他们在哪里的视觉指示键，因为他们不能或不使用鼠标）

**[请参阅名为F78 的](http://www.w3.org/TR/WCAG-TECHS/F78.html)**W3C WCAG 2.0 技术

> 由于样式元素轮廓和边框以某种方式删除或呈现不可见视觉焦点指示器而导致失败

# javascript - 如何在 Highcharts 图表上绘制垂直线？

> ID：10950784
> 
> 赞同：10
> 
> 时间：2012-06-08T14:28:09.997
> 
> 标签：javascript, jquery, highcharts

我正在使用 Highcharts，我想在值上绘制垂直线。喜欢;

![在此处输入图像描述](../Images/68a5c5e3ef915bd8199475d393649d3c.png)

我怎样才能做到这一点 ？谢谢。

这是我的代码

```
 <script type="text/javascript">

$(function () {
    var chart;
$(document).ready(function() {

    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'area'
        },
    title: {
        text: '<b> </b>'
    },
        xAxis: {

            labels: {
                formatter: function() {
                    return this.value; // clean, unformatted number for year
                }
            }
        },
        yAxis: {
            labels: {
                formatter: function() {
                    return this.value / 1000 +'k';
                }
            }
        },
        tooltip: {
            formatter: function() {
                return '<b>'+ Highcharts.numberFormat(this.y, 0) +'</b>';
            }
        },
            xAxis: {
        categories: [
            'Mon',
            'Tue',
            'Wed',
            'Thu',
            'Fri',
            'Sat',
            'Sun'
        ],
        plotBands: [{ // visualize the weekend
            from: 5.5,
            to: 6.5,
            color: 'rgba(68, 170, 213, .2)'
        }]
    },

        plotOptions: {

            area: {
                pointStart: 1,
                marker: {
                    enabled: false,
                    symbol: 'circle',
                    radius: 1,
                    states: {
                        hover: {
                            enabled: true
                        }
                    }
                }
            }
        },
        series: [{
            name: 'Visit',
            data: [946, 733, 764, 887, 832,1423]
        }, {
            name: 'Unique',
            data: [746, 633, 664, 687,702,1266]
        }]
    });
});

});
    </script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T15:50:39.053

您很可能必须使用[Highcharts 渲染器](http://www.highcharts.com/ref/#Renderer)来完成此任务，因为您想要做的事情不太适合网格，也不适合情节线。

我根据您的代码制作了一个[非常简单的示例，该代码显示在硬编码位置绘制任意垂直线。](http://jsfiddle.net/zYXar/)为了实现您的目标，您必须计算一些东西，例如每条线的起点的 x/y 位置，以及基于该点值的线的高度。

这是一个[稍微不同的示例](http://jsfiddle.net/gXkhp/)，其中 zIndex 和您实际需要的一条线，使用`V`path 命令绘制一条垂直线。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-09T04:15:54.207

我想你可能正在寻找情节带和/或情节线。

这里有一些更多信息：

[http://www.highcharts.com/docs/chart-concepts/plot-bands-and-plot-lines](http://www.highcharts.com/docs/chart-concepts/plot-bands-and-plot-lines)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T14:59:16.583

试试这个[jsFiddle](http://jsfiddle.net/shehovn/SxjAD/1/)。来自[Highcharts API](http://www.highcharts.com/ref/#xAxis--minorGridLineColor)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-16T14:16:40.760

如果您只想要一条线（以及从该线开始的区域）：

```
xAxis:{     
    plotLines: [{
        color: 'red', // Color value
        //dashStyle: 'solid', // Style of the plot line. Default to solid
        value: + new Date(), // Value of where the line will appear
        width: '2' // Width of the line    
    }],
    plotBands: [{
        color: '#FFFAFA', // Color value
        from:  +new Date(), // Start of the plot band
        to:    +new Date()+1000*24*3600*30, //30 days
    }],
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-23T13:51:14.803

解决方案是在类型中包含一个新系列，`column`并向该系列添加与包含该点的其他系列相同的数据。

```
{
    /* Column type */
    type: 'column',
    name: '',
    data: [],
    color: '#ED1C24',
    pointWidth: 2,
    showInLegend: false,
    states: { hover: { enabled: false } }
} 
```

使用这个 JSFiddle 作为指南：http: [//jsfiddle.net/NDpu6/](http://jsfiddle.net/NDpu6/)

# html - 需要一些帮助来进行 XML / XSLT 转换

> ID：10950789
> 
> 赞同：0
> 
> 时间：2012-06-08T14:28:23.167
> 
> 标签：html, xslt, transformation

我正在使用 XSL-FO 和 FOP 生成 PDF。我正在将复杂的 HTML 页面转换为 PDF。

我遇到了以下错误：

**遇到未知格式对象“{}br”（p 的子级）。（没有可用的上下文）**

FOP 处理器不理解我提供的 XSL-FO 的格式，因为其中仍有一些 HTML 标记。我想在下面链接的 xml 中过滤`<p>`和标记：`<br/>`

[http://www.tekstenuitleg.net/xmlinput.xml](http://www.tekstenuitleg.net/xmlinput.xml)

在最后一位中，在“Tab element 1”和“Tab element 2”下，您可以看到FOP 无法理解的`<p>`和。`<br/>`

你能帮我用 XSLT 过滤掉这些并用 替换它们`<fo:block>some replacement here</fo:block>`吗？我尝试了许多不同的 XSLT 样式表，但它们都不太奏效。我将 XSLT 恢复到一开始的样子。下面的 XSLT 不会失败，但也不会进行任何转换。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" encoding="utf-8" indent="no"/>
    <xsl:template match="/">
        <xsl:copy-of select="*"/>
    </xsl:template>
</xsl:stylesheet> 
```

我应该向这个 XSLT 添加什么来替换源 XML 中的`<p>`and`<br>`标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:47:52.133

我假设您的意思是要删除物理 P/BR 标签但保留其内容。

在这种情况下，请参阅此 XMLPlayground 会话（请参阅输出源中的 XML）

[http://www.xmlplayground.com/9OE0NI](http://www.xmlplayground.com/9OE0NI)

迭代模板执行以下两件事之一：

*   如果当前节点是 P/BR，则只输出其内容，不输出标签
*   否则，输出标签和内容

...然后递归子节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:44:54.900

每个元素都需要一个模板：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" encoding="utf-8" indent="no"/>
    <xsl:template match="p">
        <xsl:copy-of select="*" />
    </xsl:template>
    <xsl:template match="br">
        <!-- -->
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:37:46.253

对于那些感兴趣的人，这是我用来替换`<br>`和`<p>`标记的 XSL。你需要 xmlns:fo="http://www.w3.org/1999/XSL/Format 是你想像输出 XSLFO`<fo:block>`

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format">
<xsl:output omit-xml-declaration="yes" indent="yes" />

<xsl:template match="/">
    <xsl:apply-templates select='*' />
</xsl:template>

<xsl:template match='*'>
    <xsl:choose>
        <xsl:when test='name() = "p"'>
            <fo:block>
              <xsl:value-of select='.' />
            </fo:block>
        </xsl:when>
        <xsl:when test='name() = "br"'>
             <fo:block></fo:block>
        </xsl:when>
        <xsl:otherwise>
            <xsl:copy select='.' />
        </xsl:otherwise>
    </xsl:choose>
    <xsl:apply-templates select='*' />
</xsl:template> 
```

# css - jQuery Mobile 视网膜图标不显示

> ID：10950796
> 
> 赞同：0
> 
> 时间：2012-06-08T14:28:46.227
> 
> 标签：css, jquery-mobile

视网膜图标不显示非视网膜图标太小。我对 *2.png 使用 18x18 和 36x36。知道如何解决这个问题吗？

```
.ui-icon-roto {
    background-image: url("imgs/roto_icon.png");
}
@media only screen and (-webkit-min-device-pixel-ratio: 2) {
    .ui-icon-roto {
        background-image: url("imgs/roto_icon2.png");
        background-size: 36px 36px;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T08:37:50.650

背景尺寸应为 18x18

```
@media only screen and (-webkit-min-device-pixel-ratio: 2) {
    .ui-icon-myapp-settings {
        background: url("settings@2x.png") no-repeat rgba(0, 0, 0, 0.4) !important;
        background-size: 18px 18px;
}
} 
```

# php - PHP缓存或会话问题

> ID：10950797
> 
> 赞同：0
> 
> 时间：2012-06-08T14:28:49.390
> 
> 标签：php

我有一个我创建的 php/mysql 应用程序......这是我遇到的问题的一个场景

*   使用 user1 登录
*   定向到 user1 安全页面
*   使用 user1 注销

*   使用 user2 登录

*   定向到 user2 安全页面
*   单击浏览器后退按钮，我在 user1 安全页面中，用户 2 已登录

我更多地认为这是一个缓存问题或会话问题。谁能帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:32:37.757

听起来您的浏览器只是缓存了该页面。在页面顶部使用它：

```
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); // Date in the past 
```

# javascript - JQuery 查找与其他元素接近的元素

> ID：10950799
> 
> 赞同：0
> 
> 时间：2012-06-08T14:28:56.417
> 
> 标签：javascript, jquery

```
<asp:GridView ID="GridView1">
  <Columns>
     <asp:TemplateField>
       <ItemTemplate>
           <asp:DropDownList></asp:DropDownList> 
           <input type="tel" id="contract">
       </ItemTemplate>
     </asp:TemplateField>
     <asp:TemplateField>
       <ItemTemplate>
           <asp:Label><asp:Label>
           <asp:Label><asp:Label>
       </ItemTemplate>
     </asp:TemplateField>
     <asp:TemplateField>
       <ItemTemplate>
           <input type="tel" id="Hours">
       </ItemTemplate>
     </asp:TemplateField>
  </Columns>
</asp:GridView> 
```

我正在尝试使用 JQuery 作为验证 GridView 中模板字段的快速方法。例如，如果我的 DropDownList 的 SelectedValue = RENT READY，则 Hours 输入不应为空。所以我想使用 JQuery 来计算所有时间，我可以缩小到一个值为 RENT READY 的选择，其对应的 Hours 输入 = 空白。我试过了：

```
$("#GridView1 select[value=RENT READY]").find("input[type=tel]").eq(1) 
```

和

```
$("#GridView1 select[value=RENT READY]").next("input[type=tel]").next("input[type=tel]") 
```

和

```
$("#GridView1 select[value=RENT READY]").next("input[type=tel value='']) 
```

但总是返回未定义。选择片工作得很好。找到值为 RENT READY 的选择没有问题。这是第二部分，我尝试将其进一步缩小到仅输入相对于 2 个门向下且空白值无效的选择。

![在此处输入图像描述](../Images/2356c93b654a612993dc24ec87e5d324.png)

编辑：最终代码

```
$('#GridView1 select').filter(function () {
            return ($(this).val() == 'RENT READY');
        }).closest('tr').find('input[type=tel]').filter(function () {
            return ($(this).val() == "" && $(this).attr("id") == "Hours");
        }).length 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:37:28.480

我认为这不是选择值为“RENT READY”的下拉列表的有效方法。

你应该像下面那样做，

```
$('#GridView1 select').filter(function () {
    return ($(this).val() == 'RENT READY');
}) 
```

要`tel`找到最接近的`tr`并进行查找..或者您可以`.next .next`在选择父项上进行。

```
$('#GridView1 select').filter(function () {
    return ($(this).val() == 'RENT READY');
}).closest('tr').find('input[type=tel]') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:47:02.957

您需要获取在选择中选择的选项。像这样：

`$('#GridView1 select#GridViewStatus option[value="RENT READY"]:selected"').closest('input[type="tel"]')`

如果未找到，最后添加`.size()`将为您提供 0，如果找到则为 >0。

# objective-c - 优雅地获得和退出后台应用程序焦点以进行对话

> ID：10950802
> 
> 赞同：9
> 
> 时间：2012-06-08T14:29:04.560
> 
> 标签：objective-c, cocoa, nswindow

我正在开发一个小型 Mac 应用程序，该应用程序通常会在后台不可见地运行。但是，当用户在桌面或 Finder 中的其他位置重命名文件时，应用程序的主要功能就会发挥作用。发生这种情况时，我想显示一个类似于用户通过 Finder 更改文件扩展名时出现的对话框。因为这需要我的应用程序获得最前面的焦点（而不是 Finder），所以当用户在我的对话框中点击“确定”时，我想将 Finder 作为最前面的应用程序返回。

我目前正在使用 Apple 的[Process Manager](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/Process_Manager/Reference/reference.html)功能`SetFrontProcessWithOptions()`，但在以下情况下遇到了麻烦：

*   用户在其工作区的某处打开一个 Finder 窗口
*   然后用户点击他们的桌面，使窗口失去焦点。
*   用户重命名桌面上的文件
*   我的应用程序使自己专注于使用`SetFrontProcessWithOptions()`
*   用户`OK`在对话框中点击，我的应用程序使用 Finder 聚焦`SetFrontProcessWithOptions()`
*   当 Finder 重新聚焦时，它聚焦用户之前打开的窗口，尽管事实上当 Finder 之前处于最前面时它没有聚焦。

如果在重命名桌面上的文件之前在另一个空间中打开了 Finder 窗口，这会变得非常烦人：在这种情况下，在对话框中点击“确定”会导致 Finder 自动切换空间并返回窗口。

这只是因为`SetFrontProcessWithOptions()`函数的性质，它只能聚焦给定应用程序的*窗口*。由于桌面显然不算作*window*，因此该函数反而会找到另一个要聚焦的窗口，尽管事实上用户之前没有将该窗口聚焦。

如果有人对如何做这样一种基于对话的事情有更好的想法，那就太好了，甚至可能根本不需要聚焦和不聚焦 Finder。

**编辑**：我发现了一种在大多数情况下修复此行为的有点丑陋的方法，但它涉及脚本桥，并且如果其中的项目被重命名，它不会重新聚焦桌面。这是我这样做的代码：

```
FinderApplication * app = [SBApplication applicationWithBundleIdentifier:@"com.apple.finder"];
if (!app || ![app isRunning]) {
    SetFrontProcessWithOptions(&processSerial, kSetFrontProcessFrontWindowOnly);
    return;
}
SBElementArray * selArray = app.selection.get;
if ([selArray count] == 0) {
    SetFrontProcessWithOptions(&processSerial, kSetFrontProcessFrontWindowOnly);
    return;
} else {
    FinderWindow * window = [[[selArray objectAtIndex:0] container].get containerWindow].get;
    if ([window isKindOfClass:NSClassFromString(@"FinderFinderWindow")]) {
        SetFrontProcessWithOptions(&processSerial, kSetFrontProcessFrontWindowOnly);
    } else {
        // TODO: this is where I'd insert code to select the item
        // on the desktop...
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T19:03:54.527

您是否考虑过简单地调用`-[NSApp hide:nil]`？也就是说，让系统担心如何重新激活之前处于活动状态的应用程序，并确保您的应用程序不再处于活动状态。

顺便说一句，您观察到的行为，即 Finder 在接收到活动状态时激活窗口而不是桌面的行为与您在 Command-Tab 离开然后返回时发生的情况相同。或者 Command-Tab 离开，然后隐藏您切换到的应用程序。因此，它可能被认为是正确的行为。另一方面，在我的测试中，当 Finder 专注于桌面但在不同空间有一个窗口时隐藏前台应用程序不会切换到其他空间。它做你想做的事：以桌面为中心激活 Finder。

最后，`-[NSRunningApplication activateWithOptions:]`是`SetFrontProcessWithOptions()`.

* * *

如果您真正想要的只是一种运行相当于

```
tell application "Finder"
    activate
    select the desktop's window
end tell 
```

在 Objective-C 中，我看到了两个选项。首先，使用 Scripting Bridge API：

```
[self.finder activate];
[(FinderWindow*)self.finder.desktop.containerWindow select]; 
```

（我假设您已经掌握了在 Finder 中使用 Scripting Bridge 的基础知识。如果没有，Apple 有一个[ScriptingBridgeFinder 示例](http://developer.apple.com/library/mac/#/legacy/mac/library/samplecode/ScriptingBridgeFinder/)。出于某种原因，它位于遗留文档部分。）

其次，您可以使用`NSAppleScript`：

```
NSAppleScript* s = [[NSAppleScript alloc] initWithSource:@"tell application \"Finder\"\nactivate\nselect the desktop's window\nend tell"];
NSDictionary* err = nil;
if (![s executeAndReturnError:&err])
    /* handle error */; 
```

然而，在我对 Snow Leopard 的测试中，两种方法都无法切换到以桌面为中心的 Finder。但是，您的 AppleScript 代码也没有从 AppleScript 编辑器运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T09:47:58.640

如果桌面上没有选择，恐怕亚历克斯的解决方案不起作用。相反，这个 AppleScript 应该更可靠地判断窗口或桌面是否具有焦点：

```
tell application "Finder"
    get insertion location
end tell 
```

如果它有焦点，它将返回桌面文件夹的路径。

虽然这仍然存在两个问题：

1.  如果用户打开了桌面窗口，则上述脚本返回相同的信息。即无法区分桌面和具有焦点的桌面窗口。如果也有解决方案，那就太好了。
2.  自 10.7 以来 Finder 中存在一个错误（仍然存在于 10.8.2 中，并且为 Apple 所知（请参阅[http://openradar.appspot.com/9406282](http://openradar.appspot.com/9406282)）导致 Finder 报告有关最近打开的窗口的错误信息，甚至上面的脚本不可靠。

但是，要重新选择桌面，我现在自己找到了解决方案：

```
tell application "Finder"
    activate
    select the desktop's window
end tell 
```

MacScripter.net 上还有一个关于此的线程，我在其中更多地解释了这些选项：[http ://macscripter.net/viewtopic.php?pid=160529](http://macscripter.net/viewtopic.php?pid=160529)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T01:11:55.420

为什么不调用实际的 Apple Script：

```
NSDictionary *errorInfoDictionary = nil;
NSAppleScript *script = [[NSAppleScript alloc] initWithContentsOfURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"FocusOnFinder" ofType:@"scpt"]] error:&errorInfoDictionary];

// OR

// NSAppleScript *script = [[NSAppleScript alloc] initWithSource:@"tell application \"Finder\"\n activate\n select the desktop's window\n end tell"];

if (!errorInfoDictionary)
{
    if (![script executeAndReturnError:&errorInfoDictionary])
    {
        NSLog(@"%@", [errorInfoDictionary description]);
    }
}
else
    NSLog(@"%@", [errorInfoDictionary description]); 
```

**FocusOnFinder.scpt 的内容**

```
tell application "Finder"
   activate
   select the desktop's window
end tell 
```

如果 Finder 未运行或已最小化，则没有效果。

# c# - 仅在子节点中的复选框？

> ID：10950803
> 
> 赞同：4
> 
> 时间：2012-06-08T14:29:09.030
> 
> 标签：c#, winforms, .net-3.5, treeview

我有许多按类别分组的项目（节点），我想将它们显示`TreeView`在父级为文本而子级为`CheckBoxes`：

```
+-CategoryA(Text)
---.A1(CheckBox)
---.A2(CheckBox)
+-CategoryB(Text)
---.B1
---.B2
---.B3
+-CategoryC(Text)
---.C1(CheckBox)
---.C2(CheckBox) 
```

这是一个代码示例：

```
TreeNode testNodeA = new TreeNode("A"); 
TreeNode testNodeB = new TreeNode("B");
TreeNode testNodeC = new TreeNode("C");
TreeNode[] array = new TreeNode[] { testNodeA, testNodeB, testNodeC };
TreeNode cat = new TreeNode("Categorie X", array);
myTreeView.Nodes.Add(cat); 
```

[我已经在这里](https://stackoverflow.com/questions/698369/how-to-disable-a-winforms-treeview-node-checkbox)找到了一个类似的问题，但是该解决方案并不优雅，因为它用于`p/invoke`调用 C++ 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:52:21.723

可能有更简单的方法；但是您可以通过将绘制模式设置为`OwnerDrawAll`并决定要渲染的内容来做到这一点。

这里有一个很好的例子，几乎完全符合您的要求：http: [//social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/947aaded-6372-4253-8799-2b595f4a39b9/](http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/947aaded-6372-4253-8799-2b595f4a39b9/)

# xcode - XCode 中的调试器控制台编码已损坏

> ID：10950805
> 
> 赞同：0
> 
> 时间：2012-06-08T14:29:16.253
> 
> 标签：xcode, xcode4, character-encoding, console

非拉丁文本在 XCode 调试控制台中以非常奇怪的方式输出。如何使它正确？

例如：`Проверьте давление экрана.`成为`–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞`

（请帮助我改进我的问题，因为我的英语不好。如果很难理解我在这里写的内容，请告诉我。）

```
- (id) initWithDictionary:(NSDictionary*)dictionary
{
    //...
    self.title = [dictionary objectForKey:@"Заголовок"] ; // dictionary from plist encoded in UTF8
    //...
    return self;
}
- (void) log
{
    NSString *class = NSStringFromClass([self class]);
    NSString *sel   = NSStringFromSelector(_cmd);
    NSLog(@"%@:%@:%@", class, title_, sel);
} 
```

**`title_`**是从 plist 加载的 iVar **NSString 。**它用作 uiviewcontroller 的标题，在 iPhone 和 iPad 上运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T13:01:39.013

由于我将调试器从 lldb 更改为 gdb 输出变得正常。所以，lldb一定有问题。

在 xcode 4 中：菜单 -> 产品 -> 管理方案...然后点击编辑按钮 -> 运行 Your.app（左侧面板）-> 调试器 -> 将其从 LLDB 更改为 GDB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:59:25.693

我认为这不会是 Xcode 3 的问题，但我想我想错了。

记录的丑陋技巧：也许尝试使用不同的记录格式的 NSString 的 -cStringUsingEncoding: 来尝试强制显示正确的编码。我不知道这是否可行：

```
NSLog(@"%S", [title_ cStringUsingEncoding:NSUnicodeStringEncoding]); 
```

# mysql - MYSQL查询选择排除

> ID：10950806
> 
> 赞同：-1
> 
> 时间：2012-06-08T14:29:16.570
> 
> 标签：mysql

我有这个 MySql 表（分数）：

```
id  userId  gameId  score1  score2  idPaisesL   idPaisesV
59  1       11      1       1       229         173
57  1       11      1       0       229         173
58  1       11      2       1       229         173
56  1       11      2       2       229         173
53  1       11      7       7       229         173
52  1       11      3       5       229         173
51  3       11      6       6       229         173
50  3       11      6       6       229         173
49  3       11      5       5       229         173
48  1       11      5       0       229         173
47  1       11      2       3       229         173
46  1       11      1       0       229         173
23  1       1       5       3       173         52
54  1       11      2       0       229         173 
```

我只想选择 gameId = 11 的每个 userId 的最后一个结果，我该怎么做？帮助请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:34:38.477

我在这里假设`id`新条目总是在增加，“最后一个结果”是该`id`用户/游戏组合最高的条目：

```
SELECT *
FROM scores a
WHERE gameId = 11
  AND id = (
    SELECT MAX(id)
    FROM scores b
    WHERE a.userId = b.userId
      AND a.gameId = b.gameId
) 
```

这可能不是性能最高的，因为根据我的经验，MySQL 往往存在子查询问题。

* * *

如果您正在使用另一个具有 OLAP 函数的数据库，您可以这样做（[sqlfiddle 示例](http://sqlfiddle.com/#!3/2b12e/2)）：

```
SELECT *
FROM (SELECT s.*,
             ROW_NUMBER() OVER (PARTITION BY userID, gameID ORDER BY id DESC) AS RN
      FROM scores s)
WHERE RN=1
  AND gameID=11 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:34:54.147

如果按“最后一个”，您打算使用 id 最高的那个：

```
SELECT *
FROM scores s1
LEFT JOIN scores s2 ON s1.userId = s2.userId AND s1.id < s2.id
WHERE s2.id IS NULL
    AND gameId = 11; 
```

没有子查询，性能很好，学习模式很好:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:39:32.547

也许是这样的：

```
SELECT
    *
FROM
    scores AS t
    JOIN 
        (
            SELECT
                MAX(t2.id) AS maxID
            FROM
                scores AS t2
            GROUP BY
                t2.userId
        ) AS Latest
        ON t.id=Latest.maxID
WHERE
    t.gameId=11 
```

# iis - 在 web.config 中设置文件类型内容配置

> ID：10950807
> 
> 赞同：1
> 
> 时间：2012-06-08T14:29:25.260
> 
> 标签：iis, web-config

我有一个 kml 文件，我设置了要使用的 mime 类型

```
<mimeMap fileExtension=".kml" mimeType="application/vnd.google-earth.kml" /> 
```

但是，如果您在 Chrome 中单击指向 kml 文件的链接，它将自动下载，但会重定向到 404 页面。是否有使用 web.config 设置特定文件扩展名的内容处置？

# design-patterns - 包装器、桥接器和调解器之间有什么区别？

> ID：10950809
> 
> 赞同：2
> 
> 时间：2012-06-08T14:29:42.640
> 
> 标签：design-patterns, architecture, wrapper, bridge, mediator

我正在查看我的软件架构课程的幻灯片，据说这三个术语之间存在差异。尽管幻灯片试图解决这些差异，但我并没有完全“理解”它。如果有人能帮助澄清这三者的区别、优势和劣势，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-17T22:42:12.060

**Wrapper 也称为 Adapter**：

允许具有不同接口的类通过创建它们可以通信和交互的公共对象来一起工作。

使用时：

*   要使用的类不满足接口要求。

*   复杂条件将对象行为与其状态联系起来。

*   状态之间的转换需要明确。

* * *

**桥：**

定义一个独立于实现对象结构的抽象对象结构，以限制耦合。

使用时：

*   抽象和实现不应该在编译时绑定。

*   抽象实现的变化不应该对客户端产生影响。

*   实施细节应该对客户隐藏。

* * *

**调解员：**

通过封装不同的对象集相互交互和通信的方式，允许松散耦合。允许每个对象集的动作相互独立地变化。

使用时：

*   对象集之间的通信定义明确且复杂。
*   存在太多关系，需要共同的控制点或沟通。

# nlp - 使用 NLTK 训练词汇化 PCFG

> ID：10950810
> 
> 赞同：3
> 
> 时间：2012-06-08T14:29:48.973
> 
> 标签：nlp, nltk

我想知道是否可以使用 NLTK 工具包训练（在树库上）和使用词汇化 PCFG？它是否支持它，或者有什么方法可以轻松做到这一点？有没有其他工具可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T11:26:17.353

您检查了以下内容吗？

*   [http://nltk.googlecode.com/svn/trunk/doc/api/nltk.grammar-module.html](http://nltk.googlecode.com/svn/trunk/doc/api/nltk.grammar-module.html)
*   [http://nltk.googlecode.com/svn/trunk/doc/book/ch08-extras.html](http://nltk.googlecode.com/svn/trunk/doc/book/ch08-extras.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T14:44:27.910

这看起来像是一个起点......

*   [projective_prob_parse_demo](http://nltk.org/_modules/nltk/parse/projectivedependencyparser.html#projective_prob_parse_demo)

此示例使用[conll_data2](https://github.com/nltk/nltk/blob/master/nltk/parse/dependencygraph.py)中定义的“树库” （向下滚动到第 428 行）。

# python - cursort.execute/cursor.callproc 不返回错误但不执行任何操作

> ID：10950812
> 
> 赞同：5
> 
> 时间：2012-06-08T14:29:53.343
> 
> 标签：python, postgresql, psycopg2, psycopg

当我通过 psql 客户端运行这个 SQL 查询时，它会运行几秒钟（~90 秒，这是正常的，因为它是一个巨大的表）并返回，然后我可以检查我的行是否已成功插入。

```
SELECT merge_data('898989', '111111111', '10000') 
```

它是一个运行 UPDATE 或 INSERT 的存储过程，该过程运行没有错误，我在表中得到了我的条目。

当尝试从 python 程序执行相同操作时，查询需要 2 秒并且没有返回错误，我的表中什么也没有；有关信息，该语句已在 postgresqk 支持上成功执行（我可以在 pgsql 日志中看到它），这是我的代码片段：

```
conn = psycopg2.connect("...")
cursor = conn.cursor()

try:
    cursor.callproc("merge_data", ['898989', '111111111', '10000'])
except:
    print "ERROR !"

cursor.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T21:31:53.620

解决 ！

默认情况下，psycopg2 不会在每个执行的语句上自动提交，因此一旦我关闭连接（最后），所有挂起的事务都将被丢弃，就像执行了 ROLLBACK 一样。

可以在每个 cursor.execute() 或 .callproc 之后调用 conn.commit()，或者只是使用将其设置在全局范围内

```
conn.set_isolation_level(psycopg2.extensions.ISOLATION_LEVEL_AUTOCOMMIT) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-08T22:39:38.543

除非您确实需要自动提交功能，否则应使用 conn.commit() 代替更改隔离级别。

[Python DB2 API](https://www.python.org/dev/peps/pep-0249/#commit)

# c# - 获取具有最低键值的键值对的最便宜方法？

> ID：10950815
> 
> 赞同：1
> 
> 时间：2012-06-08T14:30:03.600
> 
> 标签：c#, collections

我想要一个将浮点数的键值对存储到整数的集合（浮点数是键）。然后我想找到数字最小的键值对。所以，我基本上想用最低关联的浮点键来获取 int 值。

也许一个让它们根据键排序并允许我对其进行索引以便在索引 0 处获取对象的集合是合适的？但是，我不确定从哪里开始寻找这个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T14:32:12.330

你可以试试[SortedDictionary](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)。如果你在上面调用 .Keys，你会得到一个排序好的键集合。然后，您可以使用 LINQ [.First()](http://msdn.microsoft.com/en-us/library/bb291976.aspx)函数获取集合中的第一个键，例如：

```
var mySortedDictionary = new SortedDictionary<float, int>();

// ...
// Add some values to dictionary
// ...

// Note, you will need the System.Linq namespace for First()
float firstKey = mySortedDictionary.Keys.First();
int firstValue = mySortedDictionary[firstKey];
// If you just need the value:
int firstValue2 = mySortedDictionary.Values.First(); 
```

如果您需要获取第一个或最后一个以外的键，则可以使用 LINQ [.ToArray()](http://msdn.microsoft.com/en-us/library/bb298736.aspx)或[.ToList()](http://msdn.microsoft.com/en-us/library/bb342261.aspx)函数返回可索引的数组或列表，如下所示：

```
float[] indexableKeys = mySortedDictionary.Keys.ToArray();
int[] indexableValues = mySortedDictionary.Values.ToArray(); 
```

此外，以下代码将遍历集合并按排序顺序为您提供所有 KeyValuePairs：

```
foreach (var pair in mySortedDictionary)
{
    int key = pair.Key;
    // Do stuff with key...
    object value = pair.Value;
    // Do stuff with value...
} 
```

作为替代方案，您也可以使用*可*索引的[SortedList 。](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)要使用它，您只需要以下代码：

 *```
var mySortedList = new SortedList<float, int>();
// ...
// Add some values to sortedlist
// ...
int firstValue = mySortedList.Values[0]; 
```

**注意：**我没有机会对其中任何一个进行基准测试，所以我不确定哪个会更好。使用排序集合肯定比常规集合具有更多开销。如果您只需要知道哪个键是第一个键，则最好创建一个自定义类，其中包含一个 Dictionary 和一个`private float first;`存储哪个键是第一个键的私有字段。当您添加到该类时，它会将 KeyValuePair 添加到字典并检查键是否小于您的`first`变量（或者字典中是否没有键）。如果是这样，它将设置`first`为新密钥。当您删除一个值时，您会再次将其从字典中删除。如果密钥等于您的`first`值，那么您需要对 Dictionary.Keys 集合进行排序并首先找到新的集合。这可能会表现最好，但您必须自己编写课程。

**注意：** *在做了一些基准测试后，我发现 SortedDictionary 的删除速度更快，但 SortedList 的添加和键索引更快。* 这是通过用 1,000,000 个键值对填充常规字典来完成的（键被打乱，以便以随机顺序输入）。我然后：

*   将这些对中的每一个添加到两个排序的集合中
*   对两个排序集合中的每个键执行查找
*   通过在两个排序集合上调用 Remove(Key) 删除每一对

在添加或索引时，SortedList 的速度大约是原来的两倍，但删除每个元素所需的时间大约是 1000 倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:39:06.077

当然，您可以使用任何完全排序的数据结构。但是“完全排序”的部分当然会涉及一些开销。

如果只检索最低的键，那么“[优先队列](http://en.wikipedia.org/wiki/Priority_queue)”通常是最好的数据结构。[这里](https://stackoverflow.com/q/102398/947357)提出了一个适当的问题。*

# android - Android x86 virtualbox + 摄像头

> ID：10950816
> 
> 赞同：19
> 
> 时间：2012-06-08T14:30:07.897
> 
> 标签：android, android-emulator, webcam, virtualbox, android-x86

我想知道如何在 virtualbox 中使用我的笔记本电脑的内置网络摄像头和 android x86。

我已经尝试启动默认的“相机”应用程序，它告诉我必须配置 SDCard，我在本教程中所做的：[SD 卡虚拟盒](http://groups.google.com/group/android-x86/browse_thread/thread/35ef4f298c9a6fb8)

但现在我想知道如何让虚拟机知道我的网络摄像头并让它被安卓使用。

我下载了 USB2 主机的插件，但网络摄像头没有出现在设备列表中...

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-12-04T17:01:28.907

如果有人看过这个问题，我的解决方案是安装“Oracle VM VirtualBox Extension Pack”。根据您的操作系统，您需要遵循不同的设置过程，但是扩展包本身可从 Oracle Virtualbox 获得：[https](https://www.virtualbox.org/wiki/Downloads) ://www.virtualbox.org/wiki/Downloads 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-15T10:22:00.953

在 Android Emulator 中，您可以选择一个网络摄像头（在 avd-emulator 设置菜单中），首先尝试那个。所以你可以看看它是否真的适用于Android

# ios - 你怎么知道是哪个 FBRequest 发起了请求 didLoad: 方法？

> ID：10950817
> 
> 赞同：1
> 
> 时间：2012-06-08T14:30:19.873
> 
> 标签：ios, facebook, facebook-graph-api, ios5

从 facebook iOS API 文档中，我创建了两种方法来请求图表中的朋友列表或当前登录用户的详细信息。

```
- (IBAction)showMyFriends:(id)sender {
    AppDelegate *delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    [[delegate facebook] requestWithGraphPath:@"me/friends" andDelegate:self];
    NSLog(@"Getting friends list");
}
- (IBAction)showMyDetails:(id)sender {
    AppDelegate *delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    [[delegate facebook] requestWithGraphPath:@"me" andDelegate:self];
    NSLog(@"Getting my info");
} 
```

到目前为止听起来很合理。响应这些调用的委托方法是：

```
- (void)request:(FBRequest *)request didLoad:(id)result
{
    NSLog(@"Got a request");

// Print out friends
//    NSArray * items = [NSArray alloc];
//    items = [(NSDictionary *)result objectForKey:@"data"];
//    for (int i=0; i<[items count]; i++) {
//        NSDictionary *friend = [items objectAtIndex:i];
//        long long fbid = [[friend objectForKey:@"id"]longLongValue];
//        NSString *name = [friend objectForKey:@"name"];
//        NSLog(@"id: %lld - Name: %@", fbid, name);
//    }

// Print out self username
    NSString *username = [result objectForKey:@"name"];
    NSLog(@"Username is %@", username);
    helloGreeting.text = [NSString stringWithFormat:@"Hello %@", username];

} 
```

**问题**：在 中`didLoad`，您如何检查当前调用与哪个图形请求相关？例如，在上面的代码中，我要么想打印出朋友列表，要么打印出用户名，所以我想我需要根据请求类型将代码包装在某些 case/switch 语句中。

我在 API 上找不到任何明显的东西，确保只执行相关响应代码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T18:02:23.587

如上所述，您可以检查请求对象以检查哪个请求生成了响应。您可以使用请求对象的 url 属性更方便地检查使用了哪个请求。

例如获取好友列表的请求

```
[facebook requestWithGraphPath:@"me/friends" andDelegate:self]; 
```

您可以检查请求对象的 url：

```
https://graph.facebook.com/me/friends 
```

以下请求 didLoad 的实现将检测好友列表请求并遍历每个好友。

```
- (void)request:(FBRequest *)request didLoad:(id)result {

    // Friends request
    if([request.url rangeOfString:@"me/friends"].location != NSNotFound) {

        NSArray *friends = [result objectForKey:@"data"];
        for (int i=0;i<friends.count;i++) {

            NSDictionary *friend = [friends objectAtIndex:i];
            //NSLog([friend objectForKey:@"name"]);

        }  
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:33:11.157

这就是您在“didLoad”中获得 FBRequest 变量的原因。您可以使用它来检查原始请求。这是一种废话解决方案，但至少你可以检查它是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T07:04:40.607

实际上看起来 Hackbook 正在基于一个名为“currentAPICall”的 int 进行切换，为每个请求设置一个 int，然后在返回时检查它。所以这一切都在主线程中完成，我猜。

我也有不同类型的不同结果对象。我最终查看了结果并确定它是来自 /me 请求还是来自 /home。我有各种“如果”来查看返回的对象。无论如何都不理想。IE

```
if([result objectForKey:@"first_name"]){
    // back from getMe()
}

if ([result objectForKey:@"data"]) {
    // more checking here- I have two calls that return a data object
} 
```

更新：这不适用于异步请求，其中大多数是，所以我使用上面的方法，检查 request.url，而不是，这就像一个魅力。

# java - 在java中将附件转换为ByteArray

> ID：10950819
> 
> 赞同：0
> 
> 时间：2012-06-08T14:30:22.053
> 
> 标签：java, attachment

如何在java中将附件转换为字节数组？

我在 java 中创建了一个附件对象并附加了一个 PDF。这是代码

```
ByteArrayInputStream pdfStream = null;
pdfStream = new ByteArrayInputStream(bytes);
AttachmentImpl pdfAttachment = new AttachmentImpl("application/pdf",pdfStream); 
```

有人可以告诉我如何从附件中取回字节吗？

# qt - Qt：qgraphicsitem 拖放

> ID：10950820
> 
> 赞同：2
> 
> 时间：2012-06-08T14:30:27.850
> 
> 标签：qt, qgraphicsitem

我对 Qt 有疑问。我想拖动图像并使用`QGraphicsPixmapItem`和 dragenterevent 但它没有出现在控制台中？但是像 hoverEnterEvent 这样的其他功能可以正常工作？？？这是代码：请帮忙？

```
class button : public QGraphicsPixmapItem
{
public:
    button(const QPixmap &);
    button();
    void changepic( QPixmap,int ,int);
    void mousePressEvent(QGraphicsSceneMouseEvent*event);
    void dragenterEvent(QGraphicsSceneDragDropEvent *event){

        event->setAccepted(1);
       qDebug("drag");
    }
    void dropEvent(QGraphicsSceneDragDropEvent *event){
       qDebug("drop");
    }

    void hoverEnterEvent(QGraphicsSceneHoverEvent *event){

           // do something
       // this->setPos(this->x()+10,this->y()+10);

             qDebug("k");

           QGraphicsItem::hoverMoveEvent(event);
       }
    void mouseReleaseEvent(QGraphicsSceneMouseEvent *event);
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T14:51:56.913

您是否只想在场景中移动图形项目？如果是这样，那么您需要做的就是为该项目设置一些标志。例如，

```
setFlag(QGraphicsItem::ItemIsSelectable);
setFlag(QGraphicsItem::ItemIsMovable);
setFlag(QGraphicsItem::ItemSendsGeometryChanges); 
```

如果您实际上是在尝试在图形项目上实现拖放，则必须调用`setAcceptDrops(true)`您的项目。

一些额外工作的原因是 Qt 默认情况下会尝试优化场景的性能。因此，您必须明确选择加入其中一些额外功能。你是说，“我知道这会对性能产生负面影响，但我可以接受；我需要这个功能。”

# c# - Visual Studio 程序集中缺少 Driveraccess.dll

> ID：10950825
> 
> 赞同：2
> 
> 时间：2012-06-08T14:30:39.113
> 
> 标签：c#, ascom

我正在尝试从 Ascom 网站编译 C# 示例项目：http: [//ascom-standards.org/](http://ascom-standards.org/)。

但是，`using DriverAccess;`给我带来了问题，因为编译器无法在安装时指定的路径中找到 dll（全部自动完成）。一致性检查器验证我的 Ascom 平台（最新的 6 sp1）。我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T14:28:48.427

您将需要添加参考。项目 + 添加参考，浏览选项卡，导航到 c:\program files (x86)\common files\ascom.net 并选择 ASCOM.DriverAccess.dll。如果您的开发机器运行 32 位操作系统，请删除路径的 (x86) 部分。命名空间名称是“ASCOM.DriverAccess”，而不是“DriverAccess”，所以这是另一个可能的问题。

我怀疑您需要更多帮助，这不是最友好的包装。一定要在专门的[Yahoo 小组](http://tech.groups.yahoo.com/group/ASCOM-Talk/)中找到其他程序员，与SO 相比，您更有可能得到快速响应。

# c++ - 我在哪里可以为多个操作系统中的应用程序启动 c++？

> ID：10950827
> 
> 赞同：2
> 
> 时间：2012-06-08T14:30:42.437
> 
> 标签：c++, visual-c++

我想制作一个至少可以在 Windows 和 Gnome Linux 上运行的简单 GUI 应用程序。我知道类似 c 的编程。现在我可以为此目的使用什么编译器/应用程序？Microsoft Visual Studio 仅适用于 Windows 应用程序。我在哪里可以了解更多关于这类软件开发的信息？我需要一些高级建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:37:27.777

[wxWidgets](http://www.wxwidgets.org)也适合你。它支持 Windows、OS X、Linux 和 UNIX。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:32:49.530

[诺基亚 Qt 框架](http://qt.nokia.com)是您的最佳选择

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:43:36.370

[Qt 框架](http://qt.nokia.com/)可能是您最好的选择。Qt 具有一次编写，随处编译的方法，因此大多数时候您不必在不同操作系统之间更改代码。他们确实有自己的 IDE，但我相信他们也有一个用于与 Visual Studio 集成的插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T15:21:41.713

其他人已经说过这一点，但诺基亚 QT 框架是一个很好的起点。

[http://en.wikipedia.org/wiki/Qt_%28framework%29#Platforms](http://en.wikipedia.org/wiki/Qt_%28framework%29#Platforms)是您的 GUI 可以使用的所有平台。

# c - C 中的模板模拟（用于队列数据类型）

> ID：10950828
> 
> 赞同：81
> 
> 时间：2012-06-08T14:30:45.543
> 
> 标签：c, templates

我正在尝试`queue`使用 C 实现一个结构。我的实现非常简单；队列只能容纳`int`s 而不能容纳其他任何东西。我想知道我是否可以在（可能通过使用预处理器）中模拟`C++`模板，以便我可以保存任何数据类型。`C``#define``queue`

**注意：**我不想使用`void*`. 我认为这有点冒险，很容易导致奇怪的运行时错误。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-06-14T14:32:22.967

您可以使用微妙而丑陋的技巧来创建这种模板。这是我要做的：

## 创建模板列表

### 定义列表的宏

我将首先创建一个宏——我们称之为它`define_list(type)`——它将为给定类型的列表创建所有函数。然后，我将创建一个包含指向所有列表函数的函数指针的全局结构，然后在列表的每个实例中都有一个指向该全局结构的指针（注意它与[虚拟方法 table](https://en.wikipedia.org/wiki/Virtual_method_table)有多么相似）。这种事情：

```
#define define_list(type) \
\
    struct _list_##type; \
    \
    typedef struct \
    { \
        int (*is_empty)(const struct _list_##type*); \
        size_t (*size)(const struct _list_##type*); \
        const type (*front)(const struct _list_##type*); \
        void (*push_front)(struct _list_##type*, type); \
    } _list_functions_##type; \
    \
    typedef struct _list_elem_##type \
    { \
        type _data; \
        struct _list_elem_##type* _next; \
    } list_elem_##type; \
    \
    typedef struct _list_##type \
    { \
        size_t _size; \
        list_elem_##type* _first; \
        list_elem_##type* _last; \
        _list_functions_##type* _functions; \
    } List_##type; \
    \
    List_##type* new_list_##type(); \
    bool list_is_empty_##type(const List_##type* list); \
    size_t list_size_##type(const List_##type* list); \
    const type list_front_##type(const List_##type* list); \
    void list_push_front_##type(List_##type* list, type elem); \
    \
    bool list_is_empty_##type(const List_##type* list) \
    { \
        return list->_size == 0; \
    } \
    \
    size_t list_size_##type(const List_##type* list) \
    { \
        return list->_size; \
    } \
    \
    const type list_front_##type(const List_##type* list) \
    { \
        return list->_first->_data; \
    } \
    \
    void list_push_front_##type(List_##type* list, type elem) \
    { \
        ... \
    } \
    \
    _list_functions_##type _list_funcs_##type = { \
        &list_is_empty_##type, \
        &list_size_##type, \
        &list_front_##type, \
        &list_push_front_##type, \
    }; \
    \
    List_##type* new_list_##type() \
    { \
        List_##type* res = (List_##type*) malloc(sizeof(List_##type)); \
        res->_size = 0; \
        res->_first = NULL; \
        res->_functions = &_list_funcs_##type; \
        return res; \
    }

#define List(type) \
    List_##type

#define new_list(type) \
    new_list_##type() 
```

### 通用接口

以下是一些通过存储的函数指针简单地调用列表函数的宏：

```
#define is_empty(collection) \
    collection->_functions->is_empty(collection)

#define size(collection) \
    collection->_functions->size(collection)

#define front(collection) \
    collection->_functions->front(collection)

#define push_front(collection, elem) \
    collection->_functions->push_front(collection, elem) 
```

请注意，如果您使用相同的结构来设计除列表之外的其他集合，您将能够将 last 函数用于存储好指针的任何集合。

### 使用示例

最后，用一个小例子来说明如何使用我们的新列表模板：

```
/* Define the data structures you need */
define_list(int)
define_list(float)

int main()
{
    List(int)* a = new_list(int);
    List(float)* b = new_list(float);

    push_front(a, 5);
    push_front(b, 5.2);
} 
```

如果你真的想在 C 中使用某种模板，你可以使用这么多的技巧，但这相当难看（只需使用 C++，它会更简单）。唯一的开销是每个数据结构实例多一个指针，因此每当你调用一个函数时就会多一个间接（不进行强制转换，你不必存储`void*`指针，是的 \o/）。希望你永远不会使用它：p

## 限制

当然有一些限制，因为我们只使用文本替换宏，而不是真正的模板。

### 定义一次

每个编译单元只能定义每种类型一次，否则，您的程序将无法编译。这可能是一个主要缺点，例如，如果您编写一个库并且您的一些标题包含一些`define_`指令。

### 多词类型

如果你想创建一个`List`模板类型由几个单词（`signed char`, `unsigned long`, `const bar`, `struct foo`...）组成的或者模板类型是一个指针（`char*`, `void*`...）的模板类型，你必须首先使用`typedef`那个类型。

```
define_list(int) /* OK */
define_list(char*) /* Error: pointer */
define_list(unsigned long) /* Error: several words */

typedef char* char_ptr;
typedef unsigned long ulong;
define_list(char_ptr) /* OK */
define_list(ulong) /* OK */ 
```

如果要创建嵌套列表，则必须使用相同的技巧。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-08T15:02:22.010

好吧，我想到的唯一可能是宏（`#define`s）。也许是这样的：

队列.h：

```
#define TYPE int
#define TYPED_NAME(x) int_##x
#include "queue_impl.h"
#undef TYPE
#undef TYPED_NAME

#define TYPE float
#define TYPED_NAME(x) float_##x
#include "queue_impl.h"
#undef TYPE
#undef TYPED_NAME
... 
```

queue_impl.h：

```
//no include guard, of course
typedef struct
{
    TYPE *data;
    ...
} TYPED_NAME(queue);

void TYPED_NAME(queue_insert) (TYPED_NAME(queue) *queue, TYPE data)
{
    ...
} 
```

如果它有效（我不是 100% 确定，不是这样的预处理器专家），它应该给你 structs`int_queue`和`float_queue`，以及函数

```
void int_queue_insert(int_queue *queue, int data);
void float_queue_insert(float_queue *queue, float data); 
```

当然，对于所有需要的类型，您必须自己进行“模板”的实例化，但这相当于在`queue.h`. 实际的实现只需要编写一次。当然你可以进一步细化这个，但是基本的想法应该是清楚的。

这至少会为您提供完美的类型安全队列模板，尽管缺少完全匹配接口的便利（函数必须携带类型名称，因为 C 不支持重载函数）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-08T14:38:24.000

实现一个包含 void* 数据的队列，并将这个 void* 解释为指向任何类型的指针，甚至是像 int 这样的原始类型。

使用#define 是可能的，但考虑调试，如果有问题......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-12-05T23:41:08.083

我想了很长时间，但现在我有了一个任何人都可以理解的明确答案；看哪！

当我学习数据结构课程时，我不得不阅读 Standish 关于数据结构、C 算法的书；很痛苦；它没有泛型，充满了糟糕的符号和一大堆全局状态突变，在那里它没有理由存在；我知道采用他的代码风格意味着搞砸我所有未来的项目，但我知道有更好的方法，所以看吧，更好的方法：

这是我触摸它之前的样子（实际上我还是触摸了它以使其格式化为人类可以阅读的方式，不客气）；它在很多层面上都非常丑陋和错误，但我会列出它以供参考：

```
#include <stdio.h>

#define MaxIndex 100

int Find(int A[])
{
    int j;

    for (j = 0; j < MaxIndex; ++j) {
        if (A[j] < 0) {
            return j;
        }
    }

    return -1;
}

int main(void)
{
    // reminder: MaxIndex is 100.
    int A[MaxIndex];

    /**
     * anonymous scope #1
     *     initialize our array to [0..99],
     *     then set 18th element to its negative value(-18)
     *     to make the search more interesting.
     */
    {
        // loop index, nothing interesting here.
        int i;

        // initialize our array to [0..99].
        for (i = 0; i < MaxIndex; ++i) {
            A[i] = i * i;
        }

        A[17]= -A[17];
    }

    /**
     * anonymous scope #2
     *     find the index of the smallest number and print it.
     */
    {
        int result = Find(A);

        printf(
            "First negative integer in A found at index = %d.\n",
            result
        );
    }

    // wait for user input before closing.
    getchar();

    return 0;
} 
```

这个程序以一种非常糟糕的方式做了很多事情；特别是，它设置了一个仅在单个范围内使用的全局宏，但随后会持续污染任何代码；非常糟糕，并导致 Windows API 大规模的全局范围污染。

此外，该程序将参数作为数组传递，而没有包含它的结构；换句话说，一旦到达函数 Find，数组就死了；我们不再知道数组的大小，所以我们现在有 main 和 Find 依赖于一个全局宏，非常糟糕。

有两种蛮力方法可以解决这个问题，但仍然保持代码简单；第一种方法是创建一个全局结构，将数组定义为 100 个整数的数组；通过这种方式传递结构将保留其中数组的长度。第二种方法是将数组的长度作为 find 的参数传递，并且只在创建数组之前使用 #define 行，然后在之后立即使用 #undef ，因为范围仍然会通过 sizeof 知道数组的大小(A)/sizeof(A[0]) 的运行时开销为 0，编译器将推导出 100 并将其粘贴进去。

为了以第三种方式解决这个问题，我制作了一个可以很好地创建通用数组的标题；它是一种抽象数据类型，但我想称它为自动数据结构。

**简单数组.h**

```
/**
 * Make sure that all the options needed are given in order to create our array.
 */
#ifdef OPTION_UNINSTALL
    #undef OPTION_ARRAY_TYPE
    #undef OPTION_ARRAY_LENGTH
    #undef OPTION_ARRAY_NAME    
#else 
    #if (!defined OPTION_ARRAY_TYPE) || !defined OPTION_ARRAY_LENGTH || (!defined OPTION_ARRAY_NAME)
        #error "type, length, and name must be known to create an Array."
    #endif

    /** 
     * Use the options to create a structure preserving structure for our array.
     *    that is, in contrast to pointers, raw arrays.
     */
    struct {
        OPTION_ARRAY_TYPE data[OPTION_ARRAY_LENGTH];
    } OPTION_ARRAY_NAME;

    /**
     * if we are asked to also zero out the memory, we do it.
     * if we are not granted access to string.h, brute force it.
     */
    #ifdef OPTION_ZERO_MEMORY
        #ifdef OPTION_GRANT_STRING
            memset(&OPTION_ARRAY_NAME, 0, OPTION_ARRAY_LENGTH * sizeof(OPTION_ARRAY_TYPE));
        #else
            /* anonymous scope */
            {
                int i;
                for (i = 0; i < OPTION_ARRAY_LENGTH; ++i) {
                    OPTION_ARRAY_NAME.data[i] = 0;
                }
            }
        #endif
        #undef OPTION_ZERO_MEMORY
    #endif
#endif 
```

如果您被迫使用 C 预处理器（与 PHP/模板工具包/ASP/您自己的可嵌入脚本语言，无论是 lisp 相比），此标头本质上就是每个 C 数据结构标头应该看起来的样子。

让我们试一试：

```
#include <stdio.h>

int Find(int A[], int A_length)
{
    int j;

    for (j = 0; j < A_length; ++j) {
        if (A[j] < 0) {
            return j;
        }
    }

    return -1;
}

int main(void)
{
    // std::array<int, 100> A;
    #define OPTION_ARRAY_TYPE int
    #define OPTION_ARRAY_LENGTH 100
    #define OPTION_ARRAY_NAME A
    #include "SimpleArray.h"    

    /**
     * anonymous scope #1
     *     initialize our array to [0..99],
     *     then set 18th element to its negative value(-18)
     *     to make the search more interesting.
     */
    {
        // loop index, nothing interesting here.
        int i;

        // initialize our array to [0..99].
        for (i = 0; i < (sizeof(A.data) / sizeof(A.data[0])); ++i) {
            A.data[i] = i * i;
        }

        A.data[17]= -A.data[17];
    }

    /**
     * anonymous scope #2
     *     find the index of the smallest number and print it.
     */
    {
        int result = Find(A.data, (sizeof(A.data) / sizeof(A.data[0])));

        printf(
            "First negative integer in A found at index = %d.\n",
            result
        );
    }

    // wait for user input before closing.
    getchar();

    // making sure all macros of SimpleArray do not affect any code
    // after this function; macros are file-wide, so we want to be 
    // respectful to our other functions.
    #define OPTION_UNINSTALL
    #include "SimpleArray.h"

    return 0;
} 
```

看哪，我们在纯 C 和 C 预处理器中发明了一个简单的 std::array ！我们使用了宏，但我们并不邪恶，因为我们自己清理！我们所有的宏在我们范围的末尾都是 undefd 的。

这儿存在一个问题; 我们不再知道数组的大小，除非我们知道`(sizeof(A.data) / sizeof(A.data[0]))`。这对编译器没有任何开销，但它对儿童不友好；宏也不是，但我们在这里的框内工作；我们以后可以使用更友好的预处理器，如 PHP，使其对儿童友好。

为了解决这个问题，我们可以创建一个实用程序库，作为我们“免费”数组数据结构的方法。

**SimpleArrayUtils.h**

```
/**
 * this is a smart collection that is created using options and is 
 *      removed from scope when included with uninstall option.
 *
 * there are no guards because this header is meant to be strategically
 *     installed and uninstalled, rather than kept at all times.
 */
#ifdef OPTION_UNINSTALL
    /* clean up */
    #undef ARRAY_FOREACH_BEGIN
    #undef ARRAY_FOREACH_END
    #undef ARRAY_LENGTH
#else
    /** 
     * array elements vary in number of bytes, encapsulate common use case 
     */
    #define ARRAY_LENGTH(A) \
        ((sizeof A.data) / (sizeof A.data[0]))

    /**
     * first half of a foreach loop, create an anonymous scope,
     * declare an iterator, and start accessing the items. 
     */
    #if defined OPTION_ARRAY_TYPE
        #define ARRAY_FOREACH_BEGIN(name, iter, arr)\
            {\
                unsigned int iter;\
                for (iter = 0; iter < ARRAY_LENGTH(arr); ++iter) {\
                    OPTION_ARRAY_TYPE name = arr.data[iter];
    #endif

    /** 
     * second half of a foreach loop, close the loop and the anonymous scope 
     */
    #define ARRAY_FOREACH_END \
            }\
        }
#endif 
```

这是一个功能相当丰富的库，基本上是导出的

ARRAY_LENGTH :: 任何具有数据字段的内容 -> int

如果我们仍然定义了 OPTION_ARRAY_SIZE，或者重新定义了它，那么头部还定义了如何进行 foreach 循环；这很可爱。

现在让我们发疯：

**简单数组.h**

```
/**
 * Make sure that all the options needed are given in order to create our array.
 */
#ifdef OPTION_UNINSTALL
    #ifndef OPTION_ARRAY_TYPE
        #undef OPTION_ARRAY_TYPE
    #endif

    #ifndef OPTION_ARRAY_TYPE    
        #undef OPTION_ARRAY_LENGTH
    #endif

    #ifndef OPTION_ARRAY_NAME    
        #undef OPTION_ARRAY_NAME    
    #endif

    #ifndef OPTION_UNINSTALL
        #undef OPTION_UNINSTALL
    #endif
#else 
    #if (!defined OPTION_ARRAY_TYPE) || !defined OPTION_ARRAY_LENGTH || (!defined OPTION_ARRAY_NAME)
        #error "type, length, and name must be known to create an Array."
    #endif

    /** 
     * Use the options to create a structure preserving structure for our array.
     *    that is, in contrast to pointers, raw arrays.
     */
    struct {
        OPTION_ARRAY_TYPE data[OPTION_ARRAY_LENGTH];
    } OPTION_ARRAY_NAME;

    /**
     * if we are asked to also zero out the memory, we do it.
     * if we are not granted access to string.h, brute force it.
     */
    #ifdef OPTION_ZERO_MEMORY
        #ifdef OPTION_GRANT_STRING
            memset(&OPTION_ARRAY_NAME, 0, OPTION_ARRAY_LENGTH * sizeof(OPTION_ARRAY_TYPE));
        #else
            /* anonymous scope */
            {
                int i;
                for (i = 0; i < OPTION_ARRAY_LENGTH; ++i) {
                    OPTION_ARRAY_NAME.data[i] = 0;
                }
            }
        #endif
        #undef OPTION_ZERO_MEMORY
    #endif
#endif 
```

**SimpleArrayUtils.h**

```
/**
 * this is a smart collection that is created using options and is 
 *      removed from scope when included with uninstall option.
 *
 * there are no guards because this header is meant to be strategically
 *     installed and uninstalled, rather than kept at all times.
 */
#ifdef OPTION_UNINSTALL
    /* clean up, be mindful of undef warnings if the macro is not defined. */
    #ifdef ARRAY_FOREACH_BEGIN
        #undef ARRAY_FOREACH_BEGIN
    #endif

    #ifdef ARRAY_FOREACH_END
        #undef ARRAY_FOREACH_END
    #endif

    #ifdef ARRAY_LENGTH
        #undef ARRAY_LENGTH
    #endif
#else
    /** 
     * array elements vary in number of bytes, encapsulate common use case 
     */
    #define ARRAY_LENGTH(A) \
        ((sizeof A.data) / (sizeof A.data[0]))

    /**
     * first half of a foreach loop, create an anonymous scope,
     * declare an iterator, and start accessing the items. 
     */
    #if defined OPTION_ARRAY_TYPE
        #define ARRAY_FOREACH_BEGIN(name, iter, arr)\
            {\
                unsigned int iter;\
                for (iter = 0; iter < ARRAY_LENGTH(arr); ++iter) {\
                    OPTION_ARRAY_TYPE name = arr.data[iter];
    #endif

    /** 
     * second half of a foreach loop, close the loop and the anonymous scope 
     */
    #define ARRAY_FOREACH_END \
            }\
        }
#endif 
```

**主程序**

```
#include <stdio.h>

// std::array<int, 100> A;
#define OPTION_ARRAY_TYPE int
#define OPTION_ARRAY_LENGTH 100
#define OPTION_ARRAY_NAME A
#include "SimpleArray.h"  
#define OPTION_UNINSTALL
#include "SimpleArray.h"  

int Find(int A[], int A_length)
{
    int j;

    for (j = 0; j < A_length; ++j) {
        if (A[j] < 0) {
            return j;
        }
    }

    return -1;
}

int main(void)
{
    #define OPTION_ARRAY_NAME A
    #define OPTION_ARRAY_LENGTH (sizeof(A.data) / sizeof(A.data[0]))
    #define OPTION_ARRAY_TYPE int

    #include "SimpleArray.h"

    /**
     * anonymous scope #1
     *     initialize our array to [0..99],
     *     then set 18th element to its negative value(-18)
     *     to make the search more interesting.
     */
    {
        #include "SimpleArrayUtils.h"

        printf("size: %d.\n", ARRAY_LENGTH(A));

        ARRAY_FOREACH_BEGIN(item, i, A)
            A.data[i] = i * i;
        ARRAY_FOREACH_END

        A.data[17] = -A.data[17];

        // uninstall all macros.
        #define OPTION_UNINSTALL
        #include "SimpleArrayUtils.h"
    }

    /**
     * anonymous scope #2
     *     find the index of the smallest number and print it.
     */
    {
        #include "SimpleArrayUtils.h"        
        int result = Find(A.data, (sizeof(A.data) / sizeof(A.data[0])));

        printf(
            "First negative integer in A found at index = %d.\n",
            result
        );

        // uninstall all macros.
        #define OPTION_UNINSTALL
        #include "SimpleArrayUtils.h"
    }

    // wait for user input before closing.
    getchar();

    // making sure all macros of SimpleArray do not affect any code
    // after this function; macros are file-wide, so we want to be 
    // respectful to our other functions.
    #define OPTION_UNINSTALL
    #include "SimpleArray.h"

    return 0;
} 
```

如你看到的; 我们现在有能力表达自由抽象（编译器将它们替换为我们），我们只为我们需要的东西（结构）付费，其余的被扔掉，并且不会污染全局范围。

我在这里强调 PHP 的力量是因为很少有人在 HTML 文档的上下文之外看到它。但您可以在 C 文档或任何其他文本文件中使用它。您可以使用模板工具包将您喜欢的任何脚本语言放入宏中；这些语言将比 C 预处理器好得多，因为它们具有命名空间、变量和实际函数；这使它们更易于调试，因为您正在调试生成代码的实际脚本；不是 C 预处理器，调试起来很麻烦，主要是因为熟悉（谁在正确的头脑中花费数小时来玩和熟悉 C 预处理器？很少有人这样做）。

这是使用 PHP 执行此操作的示例：

**简单数组.php**

```
<?php
    class SimpleArray {
        public $length;
        public $name;
        public $type;

        function __construct($options) {
            $this->length = $options['length'];
            $this->name = $options['name'];
            $this->type = $options['type'];
        }

        function getArray() {
            echo ($this->name . '.data');
        }

        function __toString() {            
            return sprintf (
                "struct {\n" .
                "    %s data[%d];\n" .
                "} %s;\n"
                ,
                $this->type,
                $this->length,
                $this->name
            );          
        }
    };
?> 
```

**主文件**

```
#include <stdio.h>
<?php include('SimpleArray.php'); ?>

int Find(int *A, int A_length)
{
    int i;

    for (i = 0; i < A_length; ++i) 
    {
        if (A[i] < 0) {
            return i;
        }
    }

    return -1;
}

int main(int argc, char **argv)
{
    <?php 
        $arr = new SimpleArray(array(
            'name' => 'A',
            'length' => 100,
            'type' => 'int'
        ));
        echo $arr;
    ?>

    printf("size of A: %d.\n", <?php echo($arr->length); ?>);

    /* anonymous scope */
    {
        int i;

        for (i = 0; i < <?php echo($arr->length)?>; ++i) {
            <?php $arr->getArray(); ?>[i] = i * i;
        }   
        <?php $arr->getArray(); ?>[17] = -<?php $arr->getArray()?>[17];
    }

    int result = Find(<?php $arr->getArray();?>, <?php echo $arr->length; ?>);
    printf(
        "First negative integer in A found at index = %d.\n",
        result
    );

    getchar();       

    return 0;
} 
```

跑`php main.php > main.c`

然后

```
gcc main.c -o main
./main 
```

这看起来很像 Objective C，因为这本质上是 Objective C 所做的，除了它倾向于将编译时间的“宏”链接到实际运行时（就好像 php 在 C 运行期间在运行时可用，并且在让你的 C 可以与 php 对话，而 php 可以与 C 对话，除了 php 是一种带有许多方括号的 smalltalkish 语言）。主要区别在于，据我所知，Objective C 没有一种方法来制作“静态”构造，就像我们在这里所做的那样。它的对象实际上是运行时的，因此访问成本要高得多，但更灵活，并且可以保留结构，而 C 结构一旦标头离开范围就会崩溃为字节（而对象可以反映回它们的原始使用内部标记工会的状态）...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-08T15:09:44.727

这是一个版本，可以让您实例化（通过预处理器）并在同一个 C 文件中使用*多种类型*^(（小心，它使用[令牌连接](http://gcc.gnu.org/onlinedocs/cpp/Concatenation.html#Concatenation)）)：

```
#include <stdio.h>

#define DEFINE_LL_NODE(CONCRETE_TYPE) \
  struct node_of_ ## CONCRETE_TYPE \
    { \
      CONCRETE_TYPE data; \
      struct node_of_ ## CONCRETE_TYPE *next; \
    };

#define DECLARE_LL_NODE(CONCRETE_TYPE,VARIABLE_NAME) \
  struct node_of_ ## CONCRETE_TYPE VARIABLE_NAME;

/* Declarations for each type.  */
DEFINE_LL_NODE(int)
DEFINE_LL_NODE(char)

int main (void)
{
  /* Declaration of instances of each type.  */
  DECLARE_LL_NODE (int, foo)
  DECLARE_LL_NODE (char, bar)

  /* And you can then use these instances.  */
  foo.data = 1;
  foo.next = NULL;

  bar.data = 'c';
  bar.next = NULL;
} 
```

如果我用 预处理它`cpp`，我会得到：

```
struct node_of_int { int data; struct node_of_int *next; };

struct node_of_char { char data; struct node_of_char *next; };

int main (void)
{
  struct node_of_int foo;
  struct node_of_char bar;

  foo.data = 1;
  foo.next = ((void *)0);

  bar.data = 'c';
  bar.next = ((void *)0);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-08T14:54:44.527

在 C 中使用预处理器宏无法真正获得高质量的模板工作；因为，这些宏只扩展一次，所以充其量你可以得到一个可以重新输入的数据结构，但一旦处理，整个程序的类型就是这种类型。

这意味着您需要考虑`void *`类型解决方案，这会削弱 C 的类型检查。要尝试修复削弱的类型检查，请考虑在您的结构中嵌入一个“类型”字段，该字段是一个表示非 void* 类型的“在构造时分配一次”字符串。然后，您可以改进与维护结构相关的函数中缺少类型检查的问题。也就是说，如果这样的事情对你来说甚至很重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-08T15:08:53.940

```
#define q(t) \
  typedef struct _q_##t {t v; struct q_##t *next} q_##t;

q(char);
q(int);

int main(void)
{
  q_char qc;
  q_int qi;

  qc.v = 'c';
  qc.next = (void *) 0;

  qi.v = 42;
  qi.next = (void *) 0;

  return 0;
} 
```

但我不确定这就是你要找的......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-08T14:38:25.930

如果你*真的*想这样做，可以通过一个简单的方法来解决`typedef`：

```
typedef int data_t;

struct queue
{
  data_t* data;
} 
```

您现在可以`data_t`在所有地方使用而不是普通`int`的 s。但是请注意，您将无法同时使用多种类型（*至少*，我看不到如何在纯 C 中模拟 C++ 模板的这种特殊行为）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-04T10:06:29.793

在另一个答案中使用其中一个代码生成宏，然后用一些 C11 重载宏完成它，这样您就不必在呼叫站点上乱扔太多类型信息。

[http://en.cppreference.com/w/c/language/generic](http://en.cppreference.com/w/c/language/generic)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-28T03:02:07.057

根据我在回复中看到的一些评论。

1.  事实上，在 C 中解决这个问题的方法是使用 #define 宏和函数指针。问题是，C++ 模板，在他们的第一个版本中，几乎就是这样——一种复制一些代码和生成一些符号的方式，在文本上“参数化”原始文件。天空是如何在这里发挥您的想象力的极限，请小心，因为在许多方面，您在类型检查等方面都是靠自己的，不要期望编译器提供太多帮助。

2.  时不时说“为什么不只使用 C++”在这里会适得其反。问题具体是如何在没有该功能时模拟该功能。我不得不说，根据我的经验，我曾经在 C++ 中模拟过模板。敢猜为什么？因为那是 1990 年初，所以有 C++，还有 C++ 模板的想法，但几乎没有这样的实现。这就是为什么。好吧，在那之前我也用C做过。C++ 让它变得更容易了，因为至少你不必再使用函数指针来模拟类方法，因为，你得到了本地语言的支持。否则，那时，就像在 C 中一样，#define 是你唯一的参数编程朋友。

# c++ - 动态转换错误

> ID：10950829
> 
> 赞同：2
> 
> 时间：2012-06-08T14:30:48.287
> 
> 标签：c++, dynamic-cast

动态转换以下代码时出现错误。

```
 class CBase
  {
  };

  class CDerived: public CBase
  {
  };

  main()
  {

    CBase b;
    CDerived* pd;
    pd = dynamic_cast<CDerived*>(&b);  
  } 
```

错误代码是`:error C2683: 'dynamic_cast' : 'CBase' is not a polymorphic type.`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T14:31:53.583

`dynamic_cast`仅适用于***多态类***。
您的基类`CBase`应该***至少有一个虚拟方法***。

# c# - 在c#中以编程方式访问asp.net Label的值innerHtml值

> ID：10950831
> 
> 赞同：0
> 
> 时间：2012-06-08T14:31:03.950
> 
> 标签：c#, javascript, asp.net

我有一个获取光标位置值的 javascript，它运行良好。我将该值分配给 asp.net 标签的 innerHtml 属性。当发生 treeview_selectednodechange 事件时，我想在我的程序中访问这个 innerHtml 属性。如何做到这一点？

这是正在使用的javascript：-

```
function ShowSelection() {
        var txt1 = document.getElementById("MainContent_txtQuery");
        var currentRange = document.selection.createRange();
        var workRange = currentRange.duplicate();
        txt1.select();
        var allRange = document.selection.createRange();
        var len = 0;
        while (workRange.compareEndPoints("StartToStart", allRange) > 0) 
        {
            workRange.moveStart("character", -1);
            len++;
        }
        currentRange.select();
        document.getElementById("MainContent_lblPos").innerHTML = len;
    } 
```

我想访问它的地方是：-

```
 string[] selectedNode = treeViewTables.SelectedNode.Text.Split('<', '>');

            string pos = lblPos.Text;
            if (selectedNode[2].Equals("Table(s)") || selectedNode[2].Equals("Parameter(s)"))
            {
                return;
            }
            string parentNode = treeViewTables.SelectedNode.Parent.Text;

            if (parentNode.Contains("Table(s)"))
            {
                txtQuery.Text = txtQuery.Text + " " + selectedNode[2];
                txtQuery.Text = RemoveSpaces(txtQuery.Text);
            }
            else if (parentNode.Contains("Parameter"))
            {
                //if (txtQuery.Text != "")
                if (lblPos.Text == string.Empty)
                {
                    if (txtQuery.Text.Length == 0)
                    {
                        txtQuery.Text = selectedNode[2];
                    }
                    else if (txtQuery.Text[txtQuery.Text.Length - 1] != ',')
                    {
                        txtQuery.Text = txtQuery.Text + " " + "'" + selectedNode[2] + "'";
                        txtQuery.Text = RemoveSpaces(txtQuery.Text);
                    }
                    else
                    {
                        txtQuery.Text = txtQuery.Text + " " + selectedNode[2];
                        txtQuery.Text = RemoveSpaces(txtQuery.Text);
                    }
                }

            }
            else
            {
                txtQuery.Text = txtQuery.Text + " " + selectedNode[2] + ",";
                txtQuery.Text = RemoveSpaces(txtQuery.Text);
            }
            TreeNode nodeSelected = treeViewTables.Nodes[0];
            nodeSelected.Select(); 
```

请帮忙。

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:37:50.057

标签的内容（客户端的跨度）永远不会被发回服务器。

在客户端添加一个`<asp:HiddenField>`并设置其值，同时更改标签的innerHtml。该值将在服务器端自动可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:38:04.567

如果我理解正确，您正在尝试在 javascript 中设置标签控件的内容，然后使用 C# 在 ASP.NET 中访问它的服务器端？

如果这是您想要做的，您将无法做到这一点，因为标签控件呈现为 HTML 跨度元素，而不是表单元素。只有表单元素在回发（全部或部分）时被发送回服务器。您可以将相同的值设置为隐藏字段并在服务器端访问它，或者您可以使用 AJAX 调用将其传递回服务器。

此外，直接在 javascript 中引用呈现的客户端 ID 可能不是一个好主意。IE。而不是

document.getElementById("MainContent_txtQuery")

你会更安全

document.getElementById("<%=txtQuery.ClientID%>")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T14:36:22.823

DOM 元素不会往返于服务器，只有表单元素。您可以在标签中的服务器上访问的唯一内容是服务器上设置的内容。

为了做你想做的事，你需要创建一个隐藏字段并将它的值设置为你的坐标，这样它就会在回发时到达服务器。

# c# - 如何编写一个 C# 函数来添加这个类的 arg？

> ID：10950837
> 
> 赞同：0
> 
> 时间：2012-06-08T14:31:40.610
> 
> 标签：c#

我认为非常基本的问题。

```
 public class person {
    public string name;
    public int status;
    public int ability;

    public person() { }
    public person(string name, int status, int ability)
    {
        this.name = name;
        this.status = status;
        this.ability = ability;
    }

    public static int praise() {
        return ++status;
    }
} 
```

我想用 C# 编写一个类，它具有将每个新类添加其“状态”的功能。但有一个错误，因为 'status' 不是 static 。我怎么解决这个问题？非常感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:35:08.430

看起来您正在尝试`praise()`增加特定人员的状态，这意味着它不应该是静态方法。

```
public int praise() {
    return ++status;
} 
```

叫它你做

```
Person bob("bob", 0, 0);
bob.praise(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:34:12.843

从方法声明中删除`static`修饰符：

```
public int praise() {
    return ++status;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:35:12.640

问题是您试图在静态方法中增加成员变量。我将假设您不希望赞美（）方法是静态的。如果是这种情况，您可以将赞美（）方法更改为：

```
public int praise()
{
    return ++status;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T14:35:17.973

你可能想要

```
public int praise(){
    return ++status;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T14:36:12.797

这取决于您要达到的目标。

如果您`status`将类的所有实例设为静态，那么您的类的所有实例都将共享相同的状态变量：

```
public static int status; 
```

如果你不让它成为静态你的类的每个实例都会有它自己的`status`变量

```
public int praise() {
    return ++status;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T14:34:04.703

如何让你的领域静态？

```
public static int status; 
```

另请注意，您应该使用属性而不是公共字段...

* * *

另一件事是，您`status`在类的构造函数中设置了字段。所以这个`status`领域的作用非常令人困惑。你真的想在多个实例之间共享它吗？

如果该`status`字段对于您的所有实例**都不**是通用的，那么您的`praise`方法可以将一个集合作为参数，并逐个`person`递增它们。`status`

也许你应该澄清你的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-08T14:34:17.560

您不能在静态上下文中引用非静态字段。您可以将其设为静态，但这取决于您的设计。

# javascript - Javascript 冲突问题

> ID：10950847
> 
> 赞同：-4
> 
> 时间：2012-06-08T14:32:00.763
> 
> 标签：javascript

我有一个球在屏幕上弹跳，我需要编写代码，当它与玩家发生碰撞时基本上结束游戏......这是我当前的代码，但它不起作用。如果您需要更多信息，请与我们联系。

```
if(playerLoc == ballLoc){
       gameOver();
       } 
```

其中 playerLoc/ballLoc 是基于 X 和 Y 轴测量值测量的。

```
<script language="JavaScript">
    //get info, process data, update screen objects
        //instance vars
        var player;
        var ball;
        var score;
        var axis;
        var ballaxis;
        //initial speeds
        var dx = 6;
        var dy = 6;
        var currentScore = 0;
        var timer;
        //set initial conditions for ball and paddle

        var playerTop = 400;
        var playerLeft = 200;
        var ballLeft = 228;
        var ballTop = 4;
        var playerLoc = playerLeft + playerTop;
        var ballLoc = ballLeft + ballTop;

        function init(){
            //instantiate HTML object instance vars
            player = document.getElementById('player');
            ball = document.getElementById('ball');
            score = document.getElementById('score');
            axis = document.getElementById('axis');
            ballaxis = document.getElementById('ballaxis');
            //register key listener with document object
            document.onkeydown = keyListener;
            //start the game loop
            start();

        }

        function keyListener(e){
            if(!e){
                //for IE
                e = window.event;
            }
            if(e.keyCode==37 && playerLeft > 0){
                //keyCode 37 is left arrow
                playerLeft -= 10;
                player.style.left = playerLeft + 'px';
            }
            if(e.keyCode==39 && playerLeft < 450){
                //keyCode 39 is right arrow
                playerLeft += 10;
                player.style.left = playerLeft + 'px';
            }
            if(e.keyCode==38 && playerTop > 0){
                //keyCode 38 is up arrow
                playerTop -= 10;
                player.style.top = playerTop + 'px';
            }
            if(e.keyCode==40 && playerTop < 450){
                //keyCode 40 is down arrow
                playerTop += 10;
                player.style.top = playerTop + 'px';
            }
        }

        function start(){
            //game loop
            render();
            detectCollisions();
            difficulty();
            axisMeasure();

            //end conditions

            if(playerLoc == ballLoc){
                gameOver();
                }
            else{
                //still in play - keep the loop going
                timer = setTimeout('start()',50);   
            }

        }

        function detectCollisions(){
            //just reflect the ball on a collision
            //a more robust engine could change trajectory of ball based
            //on where the ball hits the paddle
            if(collisionX())
                dx = dx * -1;
            if(collisionY())
                dy = dy * -1;
        }

        function collisionX(){
            //check left and right boundaries
            if(ballLeft < 2 || ballLeft > 480)
                return true;

            else {
                return false;   
            }

        }

        function collisionY(){
            //check if at top of playing area
            if(ballTop < 2  || ballTop > 480)
                return true;

            else {
                return false;
            }    

        }

        function render(){
            moveBall();
            updateScore();
        }

        function moveBall(){
            ballLeft += dx;
            ballTop += dy;
            ball.style.left = ballLeft;
            ball.style.top = ballTop;
        }

        function axisMeasure(){
            axis.innerHTML = 'P X-Axis: ' + playerLeft + ' P Y-Axis:   ' + playerTop
            ballaxis.innerHTML = 'B X-Axis: ' + ballLeft + ' B Y-Axis:   ' + ballTop        
        }

        function updateScore(){
            currentScore += 5;
            score.innerHTML = 'Score: ' + currentScore;
        }

        function difficulty(){
            //as the game progresses, increase magnitude of the vertical speed
            if(currentScore % 1000 == 0){
                if(dy > 0)
                    dy += 1;
                else
                    dy -= 1;
            }
        }

        function gameOver(){
            //end the game by clearing the timer, modifying the score label
            clearTimeout(timer);
            score.innerHTML += "   Game Over";
            score.style.backgroundColor = 'rgb(128,0,0)'; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T14:33:58.507

大声笑..好吧，您没有显示任何代码。所以这是一个*完整*的黑暗中的镜头。

```
if(playerLoc.x == ballLoc.x && playerLoc.y == ballLoc.y){
       gameOver();
} 
```

或者，甚至尝试距离方法。

```
var distance = Math.sqrt((ballLoc.x- playerLoc.x) *(ballLoc.x-playerLoc.x) + (ballLoc.y - playerLoc.y) * (ballLoc.y-playerLoc.y));

if(distance < *some amount*)}
       gameOver();
} 
```

[这里还有距离检查的现场演示。](http://jsfiddle.net/loktar/87q39/)

**编辑**

好吧，既然代码已发布，我的回答有些无关紧要，但无论如何我都会把它留在这里，因为距离检查是一种有效的方法，甚至可以在 OP 的情况下使用。

```
var ballX = ballLeft + (ballWidth/2),
    ballY = ballTop + (ballHeight/2),
    playerX = playerLeft + (playerWidth/2),
    playerY = playerTop + (playerHeight/2);

var distance = Math.sqrt((ballX - playerX) *(ballX - playerX) + (ballY - playerTop) * (ballY - playerTop )); 
if(distance < 25){ gameOver(); } 
```

# java - 如何获取 JAXB 对象的命名空间

> ID：10950857
> 
> 赞同：6
> 
> 时间：2012-06-08T14:32:27.773
> 
> 标签：java, namespaces, jaxb

目前我正在使用以下代码将 JAXB 对象编组到输出流

```
marshaller.setProperty(Marshaller.JAXB_FRAGMENT, Boolean.TRUE);
ByteArrayOutputStream out = new ByteArrayOutputStream();
marshaller.marshal(new JAXBElement(new QName("hard_coded_namespace", clazz.getSimpleName()), clazz, obj), out); 
```

我想将“hard_coded_namespace”替换为 JAXB“obj”中包含的命名空间（或其属性之一，它们目前应该共享相同的 NS）。

任何想法如何在编组之前获取 NS 信息？在输出流中，出现命名空间。所以他们在“obj”的某个地方。

[更新] 正如下面的答案所指出的，我不需要设置 JAXB_FRAGMENT 属性。我将其更改为：

```
 JAXB.marshal(new JAXBElement<T>(new QName("hard_coded_namespace", rootName), clazz, jaxbObject), out); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T14:36:33.813

目前，这是我找到的解决方案：

```
 String nsURI = "";
    for(Annotation annotation: jaxbObject.getClass().getPackage().getAnnotations()){
        if(annotation.annotationType() == XmlSchema.class){
            nsURI = ((XmlSchema)annotation).namespace();
            break;
        }
    } 
```

欢迎使用更优雅的解决方案:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T01:03:29.900

你需要使用那个 marshal API 吗？有一个更简单的重载。只要 obj 的运行时类有注解 @XmlRootElement，你应该可以简单地调用

```
marshaller.marshal(obj, out); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T14:17:03.310

该`Marshaller.JAXB_FRAGMENT`属性的使用实际上与处理非根元素没有任何关系。它作为一个标志来确定是否应该限制某些封送事件。例如，如果设置了属性，则不会生成开始和结束文档事件。

我没有测试以下内容，但这里有一个关于如何创建一些实用程序代码来查找`QName`给定 JAXB 对象的基本想法：

*   如果`JAXBIntrospector.isElement`返回 true，则只需使用 `JAXBIntrospector.getElementName`.
*   使用反射`ObjectFactory`在与 JAXB 对象相同的包中的类上查找方法，该方法返回`JAXBElement`并接受一个参数，该参数是与 JAXB 对象相同的类的实例。调用该方法，然后使用`JAXBElement.getName`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-13T17:13:47.957

```
JAXBContext jaxbCtx = JAXBContext.newInstance(Instance.class);
QName qname = jaxbCtx.createJAXBIntrospector().getElementName(instance); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-28T12:18:55.730

如果要序列化的类上没有**@XmlRootElement**，则没有其他方法可以查找包声明本身（JAXBIntrospector 将不起作用）：

```
private <T> QName getQName(final Class<T> clazz) {
    // No other way since it is not @RootXmlElement
    final String xmlns;
    final Package aPackage = clazz.getPackage();
    if (aPackage.isAnnotationPresent(XmlSchema.class)) {
        xmlns = aPackage.getDeclaredAnnotation(XmlSchema.class).namespace();
    } else {
        xmlns = ""; // May throw illegal
    }
    return new QName(xmlns, clazz.getSimpleName());
} 
```

# smtp - 如何使用 swift_mailer 修复/避免此 smtp 错误？

> ID：10950859
> 
> 赞同：3
> 
> 时间：2012-06-08T14:32:40.837
> 
> 标签：smtp, send, swiftmailer, mailer

抱歉，可能只是一个新手问题，但在这里，我有一个脚本可以循环使用如下代码发送电子邮件的一堆（有时是数千个）成员：

```
 $transport = Swift_SmtpTransport::newInstance('...', 25)
                                ->setUsername('...')
                                ->setPassword('...');

                $mailer = Swift_Mailer::newInstance($transport);
                $mailer->send($message); 
```

它通常运行良好，但有时我会收到此错误：预期响应代码 354 但得到代码“250”，消息“250 2.1.5 ... 收件人正常”

我不太了解 smtp，所以我只能猜测正在发生的事情是在发送邮件过程开始时预计会出现 354 代码，但 250 代码是从发送的最后一封电子邮件中收到的 - 所以邮件程序变得超载使用太快，我想我应该等待每封电子邮件真正完成（即等待 250 代码），然后再发送下一封。我不想在每封电子邮件之后只粘贴一个睡眠命令，那么有没有更好的方法来防止这个错误？还是其他原因？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:57:01.907

**总之：**

1.  要做的主要改变：重用你的邮件连接，最好是创建消息，所以它只在需要时完成，通常只做一次
2.  检查您如何实例化 SwiftMailer 并确认它是最佳方式
3.  您的 SwiftMailer 类版本似乎有点旧（4.0.5），您可以查看更新的版本

**更详细地说：**

*实例化对象的重用。*您每次都在重新创建邮件传输，从而导致开销。你不应该那样做。如果支持，您可以将 batchSend() 用于大量电子邮件。[请参阅此问题](https://stackoverflow.com/questions/1640856/batch-send-email-with-swiftmailer)中的用法示例。一个应用例子：

```
$message = Swift_Message::newInstance(...)
  ->setSubject('A subject')
  ->setFrom(array('myfrom@domain.com' => 'From Me'))
  ->setBody('Your message')
;

while(list($targetadd, $targetname) = each($targetlist))
{
   $message->addTo($targetadd, $targetname);
}

$message->batchSend(); 
```

请注意，虽然 batchSend() 已[在 SwiftMailer 的 4.1.0 RC1 中删除](https://github.com/swiftmailer/swiftmailer/blob/master/CHANGES)。据我所知，它在[内部循环调用 send()](https://github.com/swiftmailer/swiftmailer/issues/133)，因此您应该能够通过多次调用 send() 获得相同的效果，但至少重用您的邮件传输，这样您就不会每次都重新实例化它（如果适用，还创建消息）。

从[官方文档](http://swiftmailer.org/docs/sending.html#sending-emails-in-batch)的批量发送示例中，您可以使用 send() 来批量发送电子邮件

```
// Create the Transport
$transport = Swift_SmtpTransport::newInstance('localhost', 25);

// Create the Mailer using your created Transport
$mailer = Swift_Mailer::newInstance($transport);

// Create a message
$message = Swift_Message::newInstance('Wonderful Subject')
  ->setFrom(array('john@doe.com' => 'John Doe'))
  ->setBody('Here is the message itself')
  ;

// Send the message
$failedRecipients = array();
$numSent = 0;
$to = array('receiver@domain.org', 'other@domain.org' => 'A name');

foreach ($to as $address => $name)
{
  if (is_int($address)) {
    $message->setTo($name);
  } else {
    $message->setTo(array($address => $name));
  }

  $numSent += $mailer->send($message, $failedRecipients);
} 
```

*传输协议。*另一个需要注意的是 SwiftMailer 是一个包装类。它在引擎盖下实际使用的是您定义的内容。在您的情况下，您使用的是 SMTP 传输，它比邮件传输（mail() 函数）更好，但可能不是最佳传输。

您没有说是否明确要使用它以及您拥有哪个环境，但是在 linux 环境中，您可以使用类似的东西直接调用 sendmail

```
$transport = Swift_SendmailTransport::newInstance('/usr/sbin/sendmail -bs'); 
```

这可以提供更好的性能。[SwiftMailer 使用文档](http://swiftmailer.org/docs/sending.html#transport-types)中有更多关于不同传输的信息。

*类版。*根据您的评论，您使用的是 4.0.5 版本。当前版本是[4.1.8。](https://raw.github.com/swiftmailer/swiftmailer/master/CHANGES)，并且自从批量发送以来，有些事情已经发生了变化，所以您可能也想检查一下。

编辑：关于 batchSend()、当前版本和手动链接的更新信息。

# jquery - 使用 JQuery UI 选项卡时缺少 CarouFredSel 动画

> ID：10950864
> 
> 赞同：0
> 
> 时间：2012-06-08T14:33:04.387
> 
> 标签：jquery, jquery-ui, carousel, jquery-tabs, caroufredsel

我正在网站 new.xpient.com 上工作。在首页上，我使用的是 JQuery UI 选项卡，而对于自动滚动画廊，我使用的是[CarouFredSel](http://caroufredsel.frebsite.nl/)。我已经仔细研究了这两个问题的文档，但我遇到了问题。

似乎如果您切换选项卡，新内容（`li`项目）不会移动。即使您切换回初始选项卡，动画也会停止。我假设这意味着脚本仅在文档加载时才运行，而不是应用于 new `ul`s，因为您使用选项卡在它们之间切换。

这是我的代码，我相信你需要看到它。

[http://pastebin.com/QVEBejab](http://pastebin.com/QVEBejab)

如何使 CarouFredSel 与 JQuery 选项卡一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T14:57:46.697

我通过首先获取 jquery 脚本，然后是 head 标签之间的 caroufredsel 脚本解决了这个问题。最后（就在 </body > 之前），我得到了 Tabs 脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T09:44:55.590

每个轮播不应`display: none`像在封闭的 jQuery UI 选项卡中那样具有，但您可以覆盖标准 UI CSS 样式：

```
#yourtabs.ui-tabs .ui-tabs-hide {
    display: block !important;
    visibility: hidden;
    height: 0;
} 
```

# css - GWT celltable 使某些列加粗

> ID：10950865
> 
> 赞同：1
> 
> 时间：2012-06-08T14:33:06.633
> 
> 标签：css, gwt, celltable

我正在使用 GWT CellTable。

我有一个要求，我想让几行中的几列变为粗体，具体取决于该列的数据。

我似乎找不到任何干净的实现。

任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:13:13.423

如果样式直接取决于单元格的值，那么您可以扩展`Column`和覆盖`getCellStyleNames`。

否则，您可以使用 a`RowStyles`将 CSS 类名称应用于行（取决于行对象），`Column#setCellStyleNames`在单元格必须为粗体的列上使用，并在 CSS 样式表中使用后代选择器仅将粗体样式应用于单元格行和列的交叉：

```
.rowWithBoldCells .cellMightBeBold { font-weight: bold; } 
```

（`rowWithBoldCells`仅应用于某些单元格必须为粗体的行，并`cellMightbeBold`应用于给定列中的*所有单元格）。*

# mysql - Mysql SEC_TO_TIME 产生错误

> ID：10950867
> 
> 赞同：0
> 
> 时间：2012-06-08T14:33:09.033
> 
> 标签：mysql

尝试执行以下 SQL 时：

```
SELECT SEC_TO_TIME(sum(TIME_TO_SEC(TIMEDIFF(edate,sdate))-rast)+3600) as TotalDiff from tblregtime where userID IN(97,41) AND year(sdate)=2012 
```

它返回此错误：

多步 OLE DB 操作产生错误。检查每个 OLE DB 状态值（如果可用）。没有做任何工作。

仅当 totalDiff 的总和超过 24 小时时才会出现此问题。有什么建议为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:49:22.133

[SEC_TO_TIME](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_sec-to-time)：结果的范围被限制为 TIME 数据类型的范围。如果参数对应的值超出该范围，则会出现警告。

[TIME](http://dev.mysql.com/doc/refman/5.5/en/time.html)：TIME 值的范围可以从“-838:59:59”到“838:59:59”。

有没有可能`sum(TIME_TO_SEC(TIMEDIFF(edate,sdate))-rast)+3600`超出规定范围？

*（定义由在线[MySQL 5.5 参考手册](http://dev.mysql.com/doc/refman/5.5/en/index.html)提供）。*

# objective-c - CoreGraphics 触摸自定义形状

> ID：10950871
> 
> 赞同：0
> 
> 时间：2012-06-08T14:33:24.310
> 
> 标签：objective-c, ios, core-graphics, cgcontext

我有一个 UIView 子类，它在其 drawRect:rect 方法中绘制一个圆圈。现在我想在用户触摸圆圈（而不是视图）时做出反应。

我的想法是获取触摸的 CGPoint 并询问 CGContext 是否有什么东西。有没有办法检查是否有填充或描边？或者我现在可以访问颜色以查看它是否不透明？

我认为这一定是可能的，因为图形被绘制到屏幕上，因此系统可以以某种方式以低级机制完成它..

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T09:58:33.303

您需要使用`CGBitmapContextCreate()`创建位图上下文并在其中绘制图像。

在位图上下文中，您可以访问单个像素并以 RGBA 的形式检查它们的颜色。

# iphone - 单击 iPhone 上的按钮时触发其他类的方法

> ID：10950874
> 
> 赞同：3
> 
> 时间：2012-06-08T14:33:45.857
> 
> 标签：iphone, objective-c, interface-builder

我刚刚制作了一个“应用程序”，它只是在命令行（outpot）中打印了一些东西，这是一个例子 -

[http://img254.imageshack.us/img254/2853/3cc0a810d7564e39b05bade.png](http://img254.imageshack.us/img254/2853/3cc0a810d7564e39b05bade.png)

代码：

卡片.h：

```
#import <Foundation/Foundation.h>
@interface Card : NSObject {
    int CardValue;
    int CardType;
}
@property int CardValue,CardType;
@end 
```

卡.m：

```
#import <Foundation/Foundation.h>
@interface Card : NSObject {
    int CardValue;
    int CardType;
}
@property int CardValue,CardType;
@end 
```

甲板.h：

```
#import <Foundation/Foundation.h>
#import "Card.h"
@interface Deck : NSObject {
    NSMutableArray *Deck1, *Deck2, *Deck3, *Deck4, *Deck5;
}
@property NSMutableArray *Deck1, *Deck2, *Deck3, *Deck4, *Deck5;
-(void)createDeck;
-(void)createFullDeck : (Deck *) TheDeck;
-(void)insertToDeck : (Card *) TheCard;
@end 
```

甲板.m:

```
#import "Deck.h"
#include <stdlib.h> 
@implementation Deck
@synthesize Deck1, Deck2, Deck3, Deck4, Deck5;
-(void)createDeck{
Deck1 = [NSMutableArray arrayWithCapacity:13];
Deck2 = [NSMutableArray arrayWithCapacity:13];
Deck3 = [NSMutableArray arrayWithCapacity:13];
Deck4 = [NSMutableArray arrayWithCapacity:13];
Deck5 = [NSMutableArray arrayWithCapacity:13];
}
-(void)createFullDeck : (Deck *) TheDeck{
    Card *Card1 = [[Card alloc]init];
    [TheDeck createDeck];
    for (int i=1;i<=4;i++){
        for (int j=1;j<=13;j++){
            Card1.CardValue=j;
            Card1.CardType=i;
            [TheDeck insertToDeck:Card1];
        }
    }
}
-(void)insertToDeck : (Card *) TheCard{
if (TheCard.CardType==1)
    [Deck1 addObject:[NSNumber numberWithInteger:TheCard.CardValue]];
if (TheCard.CardType==2)
    [Deck2 addObject:[NSNumber numberWithInteger:TheCard.CardValue]];
if (TheCard.CardType==3)
    [Deck3 addObject:[NSNumber numberWithInteger:TheCard.CardValue]];
if (TheCard.CardType==4)
    [Deck4 addObject:[NSNumber numberWithInteger:TheCard.CardValue]];
}
-(id)DrawCard{
    Card *MethodCard = [[Card alloc]init];
    int randomType = arc4random() % 4;
    if (randomType==0){
        int DeckCount = [Deck1 count];
        int randomValue = arc4random() % DeckCount;
        MethodCard.CardValue = [[Deck1 objectAtIndex:randomValue]integerValue];
        [Deck1 removeObjectAtIndex:randomValue];
    }
    if (randomType==1){
        int DeckCount = [Deck2 count];
        int randomValue = arc4random() % DeckCount;
        MethodCard.CardValue =[[Deck2 objectAtIndex:randomValue]integerValue];
        [Deck2 removeObjectAtIndex:randomValue];
    }
    if (randomType==2){
        int DeckCount = [Deck3 count];
        int randomValue = arc4random() % DeckCount;
        MethodCard.CardValue =[[Deck3 objectAtIndex:randomValue]integerValue];
        [Deck3 removeObjectAtIndex:randomValue];
    }
    if (randomType==3){
        int DeckCount = [Deck4 count];
        int randomValue = arc4random() % DeckCount;
        MethodCard.CardValue =[[Deck4 objectAtIndex:randomValue]integerValue];
        [Deck4 removeObjectAtIndex:randomValue];
    }
    MethodCard.CardType = randomType+1;
    return MethodCard;
}
@end 
```

游戏.h：

```
#import <Foundation/Foundation.h>
#import "Deck.h"
@interface Game : NSObject

-(void)StartNewGame : (Deck *) TheDeck : (Game *) TheGame;
-(BOOL)GetDecision : (int) TheNumber;
-(void)CheckHiOrLo : (int) FirstNumber : (Deck *) TheDeck : (Game *) TheGame;
@end 
```

游戏.m：

```
#import "Game.h"
@implementation Game
-(void)StartNewGame : TheDeck : (Game *) TheGame{
    NSLog(@"Welcome to the game High-Low!");
    [TheDeck createDeck];
    [TheDeck createFullDeck:TheDeck];
    Card *TheCard = [[Card alloc]init];
    TheCard = [TheDeck DrawCard];
    [TheGame CheckHiOrLo: TheCard.CardValue : TheDeck : TheGame];
    }
-(BOOL)GetDecision : (int) TheNumber{
    int userNum=0;
    NSLog(@"The Card is %i\nif you think the next Card is going to be higher - type 1.\nif you think the next Card is going to be lower - type 0.", TheNumber);
    scanf("%i", &userNum);
    if(userNum==1)
        return YES;
    if(userNum==0)
        return NO;
    NSLog(@"error in GetDecision in Game.m");
    return NO;
}
-(void)CheckHiOrLo : (int) FirstNumber : (Deck *) TheDeck : (Game *) TheGame{
    Card *TheCard = [[Card alloc]init];
    TheCard = [TheDeck DrawCard];
    BOOL Decision = [TheGame GetDecision:FirstNumber];
    if(FirstNumber>TheCard.CardValue){
        if(Decision==YES){
            NSLog(@"%i", TheCard.CardValue);
            NSLog(@"GameOver");
        }
        if(Decision==NO){
            NSLog(@"%i \nCorrect, Next Card", TheCard.CardValue);
            [TheGame CheckHiOrLo: TheCard.CardValue : TheDeck : TheGame];
        }
    }
    if(FirstNumber<=TheCard.CardValue){
        if(Decision==YES){
            NSLog(@"%i \nCorrect, Next Card", TheCard.CardValue);
            [TheGame CheckHiOrLo: TheCard.CardValue : TheDeck : TheGame];
        }
        if(Decision==NO){
            NSLog(@"%i", TheCard.CardValue);
            NSLog(@"GameOver");
        }
    }
}
@end 
```

所以现在我尝试为此制作一个 iPhone 应用程序，所以我制作了一个新的 iphone 项目，将 Card、Deck 和 Game Classes 移动到 iPhone 项目并制作了一个高按钮、一个低按钮和一个开始按钮来构建一个新的甲板。

现在当我单击开始按钮时，我该怎么做，它会触发 Deck 类中的方法 createDeck 和 CreateFullDeck？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:53:50.483

首先你会`Deck`在你的头文件中声明一个对象，比如说你的`UIViewController`，确保你`#import Deck.h`的。

```
#import "Deck.h"

@interface MainViewController: UIViewController

      Deck *deck;
@end 
```

现在，您可以初始化MainViewController的`deck`in方法`-viewDidLoad`

```
-(void)viewDidLoad {

    [super viewDidLoad];

     deck = [[Deck alloc] init];
 } 
```

在您的按钮操作中，您将创建完整的牌组。假设这是一个`IBAction`连接到`UIButton`Interface Builder 的；

```
 -(IBAction)onCreateClicked:(id)sender {

      [deck createDeck:deck];
      // You now created your deck of cards.
   } 
```

希望这可以帮助 ！

**编辑**：在进一步调查您的代码后，您的代码有很多问题，但上面的示例将按照您的要求执行。

# iphone - 如何使用 XCode 和 4 故事板使用 plist 内容填充 TableView

> ID：10950876
> 
> 赞同：0
> 
> 时间：2012-06-08T14:33:54.947
> 
> 标签：iphone, xcode, uitableview, plist

我很难弄清楚如何使用代表对象的 x 个单元格填充 TableView，这是一种非常基本的技术。就我而言，我想显示有关不同红酒的图像和信息。下面答案中的教程使整个事情变得非常简单，创建了一个带有字典数组的属性列表来填充原型单元格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:08:10.750

我想这个 tuturail 会回答你的很多问题： [http ://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

# node.js - 在 node.js 中具有用户参与度的聊天服务器

> ID：10950880
> 
> 赞同：0
> 
> 时间：2012-06-08T14:34:12.937
> 
> 标签：node.js, chat

我想在 node.js 中建立一个聊天服务器；我需要处理用户参与，例如 Openfire 中的 Fastpath 插件，以便在请求到达时将其发送给某个运营商 [例如第一个免费的] ... node.js 是否有类似的模块/库？我想使用节点而不是 openfire。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:37:00.407

我建议看看[socket.io](http://socket.io/)。里面有很多聊天服务器的例子。

# javascript - 将图像保存在浏览器中，并使用只有一个输入字段的 ajax 发送它们

> ID：10950894
> 
> 赞同：1
> 
> 时间：2012-06-08T14:34:54.093
> 
> 标签：javascript, ajax

我想制作一个多图像上传脚本，但我只想要一个输入字段。

选择图像后，图像应显示为预览。我需要以某种方式保存图像，并将数据发送到处理其余部分的 PHP 脚本。

我创建了一个 jsfiddle 来说明它应该如何工作。

[http://jsfiddle.net/ETayz/7/](http://jsfiddle.net/ETayz/7/)

# c# - 如何设置 DataGridTextColumn 文本颜色？

> ID：10950904
> 
> 赞同：14
> 
> 时间：2012-06-08T14:35:19.750
> 
> 标签：c#, wpf, xaml, wpfdatagrid, datagridtextcolumn

我正在尝试更改 DataGridTextColumn 的颜色。

这就是我正在做的事情：

```
<DataGridTextColumn 
    Header="Status" 
    Binding="{Binding IsActive, 
               Converter= {StaticResource BoolToStatusConverter}}"
    Foreground="{Binding Path=IsActive,
               Converter={StaticResource BoolToColorConverter}}"/> 
```

文本设置正确，但颜色不会改变，我收到以下错误：

```
System.Windows.Data Error: 2 : Cannot find governing FrameworkElement or 
FrameworkContentElement for target element. BindingExpression:Path=IsActive; 
DataItem=null; target element is 'DataGridTextColumn' (HashCode=40349079); target 
property is 'Foreground' (type 'Brush') 
```

我应该怎么做才能使它起作用？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-08T18:28:14.087

您需要为列的 CellStyle 指定带有 DataTrigger 的样式。例如

```
<Page.Resources>
    <Style TargetType="DataGridCell" x:Key="ActiveCellStyle">
        <Setter Property="Foreground" Value="Blue"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsActive}" Value="{x:Null}">
                <Setter Property="Foreground" Value="Green"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsActive}" Value="True">
                <Setter Property="Foreground" Value="Red"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    <Converters:BoolToTextConverter 
        x:Key="BoolToStatusConverter" 
        TargetCondition="True" 
        IsMatchValue="It's active" 
        IsNotMatchValue="It's dead" />
</Page.Resources>
<Grid>
    <DataGrid ItemsSource="{Binding Items}" AutoGenerateColumns="False">
        <DataGrid.Columns>
            <DataGridTextColumn 
                Header="Status" 
                Binding="{Binding IsActive, 
                    Converter={StaticResource BoolToStatusConverter}}" 
                CellStyle="{StaticResource ActiveCellStyle}"/>
        </DataGrid.Columns>
    </DataGrid>
</Grid> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-26T13:45:33.447

虽然从技术上讲不是 DataGridTextColumn，但这是我通常做的：

```
<DataGridTemplateColumn Header="Status" SortMemberPath="Status">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Status}" Foreground="{Binding Status, Converter={StaticResource StatusToSolidColor}}" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

我得到了我想要的数据上下文，并且我可以重用我可能已经在应用程序的其余部分中使用的转换器。此外，我不必硬编码/维护一组额外的样式和数据触发器来获得所需的效果。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-08T15:47:29.620

前景是画笔，而不是颜色。它可以**解析**XAML 中的颜色，但在使用转换器创建绑定时不使用该颜色。

使用 BoolToBrushConverter，或创建 SolidColorBrush 作为前景并将其“Color”属性绑定到 BoolToColorConverter。像这样：

```
<DataGridTextColumn Header="Status">
    <DataGridTextColumn.Foreground>
        <SolidColorBrush Color="{Binding Path=IsActive, Converter={StaticResource BoolToColorConverter}}" />
    </DataGridTextColumn.Foreground>
</DataGridTextColumn> 
```

# java - java - 如何检查Java中的BigDecimal变量是否== 0？

> ID：10950914
> 
> 赞同：254
> 
> 时间：2012-06-08T14:36:12.470
> 
> 标签：java, bigdecimal

我在Java中有以下代码；

```
BigDecimal price; // assigned elsewhere

if (price.compareTo(new BigDecimal("0.00")) == 0) {
    return true;
} 
```

编写 if 条件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：595
> 
> 时间：2012-06-08T14:38:44.363

使用[`compareTo(BigDecimal.ZERO)`](https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#compareTo-java.math.BigDecimal-)代替[`equals()`](https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#equals-java.lang.Object-)：

```
if (price.compareTo(BigDecimal.ZERO) == 0) // see below 
```

与[`BigDecimal`](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html)常量比较[`BigDecimal.ZERO`](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#ZERO)避免了必须构造一个`new BigDecimal(0)`每次执行。

仅供参考，`BigDecimal`也有常数[`BigDecimal.ONE`](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#ONE)，[`BigDecimal.TEN`](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#TEN)为了您的方便。

* * *

## 笔记！

您不能使用的原因[`BigDecimal#equals()`](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#equals%28java.lang.Object%29)是它考虑了*规模*：

```
new BigDecimal("0").equals(BigDecimal.ZERO) // true
new BigDecimal("0.00").equals(BigDecimal.ZERO) // false! 
```

所以它不适合纯粹的数字比较。但是，[`BigDecimal.compareTo()`](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#compareTo%28java.math.BigDecimal%29)比较时不考虑比例：

```
new BigDecimal("0").compareTo(BigDecimal.ZERO) == 0 // true
new BigDecimal("0.00").compareTo(BigDecimal.ZERO) == 0 // true 
```

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2012-08-30T21:38:39.823

或者，可以使用[signum() ：](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html#signum%28%29)

```
if (price.signum() == 0) {
    return true;
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-06-08T14:38:49.207

您可以检查一个常量：

```
someBigDecimal.compareTo(BigDecimal.ZERO) == 0 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-06-08T14:51:14.907

另外，我认为值得一提的是 BigDecimal 类中 equals 和 compareTo 方法的行为[并不一致](https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#compareTo%28java.math.BigDecimal%29)。

这基本上意味着：

```
BigDecimal someValue = new BigDecimal("0.00");
System.out.println(someValue.compareTo(BigDecimal.ZERO) == 0); // true
System.out.println(someValue.equals(BigDecimal.ZERO)); // false 
```

因此，您必须非常小心`someValue`变量中的比例，否则您会得到意想不到的结果。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-08T14:39:49.253

我通常使用以下内容：

```
if (selectPrice.compareTo(BigDecimal.ZERO) == 0) { ... } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-08T14:39:58.683

由于它们是对象，因此您会想要使用`equals()`它们，并利用内置`ZERO`实例：

```
if (selectPrice.equals(BigDecimal.ZERO)) 
```

请注意，`.equals()`将比例考虑在内，因此除非 selectPrice 与比例相同（0），`.ZERO`否则这将返回 false。

要按原样从等式中取出比例：

```
if (selectPrice.compareTo(BigDecimal.ZERO) == 0) 
```

我应该注意，对于某些数学情况，`0.00 != 0`，这就是为什么我想`.equals()`考虑规模。`0.00`精确到百分之一，而`0`没有那么精确。根据您可能要坚持的情况`.equals()`。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-05-24T15:14:21.823

GriffeyDog 绝对正确：

代码：

```
BigDecimal myBigDecimal = new BigDecimal("00000000.000000");
System.out.println("bestPriceBigDecimal=" + myBigDecimal);
System.out.println("BigDecimal.valueOf(0.000000)=" + BigDecimal.valueOf(0.000000));
System.out.println(" equals=" + myBigDecimal.equals(BigDecimal.ZERO));
System.out.println("compare=" + (0 == myBigDecimal.compareTo(BigDecimal.ZERO))); 
```

结果：

```
myBigDecimal=0.000000
BigDecimal.valueOf(0.000000)=0.0
 equals=false
compare=true 
```

虽然我了解 BigDecimal 比较的优点，但我不会认为它是一种直观的构造（就像 ==、<、>、<=、>= 运算符一样）。当你脑子里有一百万件事情（好吧，七件事情）时，任何可以减轻认知负担的事情都是一件好事。所以我构建了一些有用的便利功能：

```
public static boolean equalsZero(BigDecimal x) {
    return (0 == x.compareTo(BigDecimal.ZERO));
}
public static boolean equals(BigDecimal x, BigDecimal y) {
    return (0 == x.compareTo(y));
}
public static boolean lessThan(BigDecimal x, BigDecimal y) {
    return (-1 == x.compareTo(y));
}
public static boolean lessThanOrEquals(BigDecimal x, BigDecimal y) {
    return (x.compareTo(y) <= 0);
}
public static boolean greaterThan(BigDecimal x, BigDecimal y) {
    return (1 == x.compareTo(y));
}
public static boolean greaterThanOrEquals(BigDecimal x, BigDecimal y) {
    return (x.compareTo(y) >= 0);
} 
```

以下是如何使用它们：

```
 System.out.println("Starting main Utils");
    BigDecimal bigDecimal0 = new BigDecimal(00000.00);
    BigDecimal bigDecimal2 = new BigDecimal(2);
    BigDecimal bigDecimal4 = new BigDecimal(4);  
    BigDecimal bigDecimal20 = new BigDecimal(2.000);
    System.out.println("Positive cases:");
    System.out.println("bigDecimal0=" + bigDecimal0 + " == zero is " + Utils.equalsZero(bigDecimal0));
    System.out.println("bigDecimal2=" + bigDecimal2 + " <  bigDecimal4=" + bigDecimal4 + " is " + Utils.lessThan(bigDecimal2, bigDecimal4));
    System.out.println("bigDecimal2=" + bigDecimal2 + " == bigDecimal20=" + bigDecimal20 + " is " + Utils.equals(bigDecimal2, bigDecimal20));
    System.out.println("bigDecimal2=" + bigDecimal2 + " <= bigDecimal20=" + bigDecimal20 + " is " + Utils.equals(bigDecimal2, bigDecimal20));
    System.out.println("bigDecimal2=" + bigDecimal2 + " <= bigDecimal4=" + bigDecimal4 + " is " + Utils.lessThanOrEquals(bigDecimal2, bigDecimal4));
    System.out.println("bigDecimal4=" + bigDecimal4 + " >  bigDecimal2=" + bigDecimal2 + " is " + Utils.greaterThan(bigDecimal4, bigDecimal2));
    System.out.println("bigDecimal4=" + bigDecimal4 + " >= bigDecimal2=" + bigDecimal2 + " is " + Utils.greaterThanOrEquals(bigDecimal4, bigDecimal2));
    System.out.println("bigDecimal2=" + bigDecimal2 + " >= bigDecimal20=" + bigDecimal20 + " is " + Utils.greaterThanOrEquals(bigDecimal2, bigDecimal20));
    System.out.println("Negative cases:");
    System.out.println("bigDecimal2=" + bigDecimal2 + " == zero is " + Utils.equalsZero(bigDecimal2));
    System.out.println("bigDecimal2=" + bigDecimal2 + " == bigDecimal4=" + bigDecimal4 + " is " + Utils.equals(bigDecimal2, bigDecimal4));
    System.out.println("bigDecimal4=" + bigDecimal4 + " <  bigDecimal2=" + bigDecimal2 + " is " + Utils.lessThan(bigDecimal4, bigDecimal2));
    System.out.println("bigDecimal4=" + bigDecimal4 + " <= bigDecimal2=" + bigDecimal2 + " is " + Utils.lessThanOrEquals(bigDecimal4, bigDecimal2));
    System.out.println("bigDecimal2=" + bigDecimal2 + " >  bigDecimal4=" + bigDecimal4 + " is " + Utils.greaterThan(bigDecimal2, bigDecimal4));
    System.out.println("bigDecimal2=" + bigDecimal2 + " >= bigDecimal4=" + bigDecimal4 + " is " + Utils.greaterThanOrEquals(bigDecimal2, bigDecimal4)); 
```

结果如下所示：

```
Positive cases:
bigDecimal0=0 == zero is true
bigDecimal2=2 <  bigDecimal4=4 is true
bigDecimal2=2 == bigDecimal20=2 is true
bigDecimal2=2 <= bigDecimal20=2 is true
bigDecimal2=2 <= bigDecimal4=4 is true
bigDecimal4=4 >  bigDecimal2=2 is true
bigDecimal4=4 >= bigDecimal2=2 is true
bigDecimal2=2 >= bigDecimal20=2 is true
Negative cases:
bigDecimal2=2 == zero is false
bigDecimal2=2 == bigDecimal4=4 is false
bigDecimal4=4 <  bigDecimal2=2 is false
bigDecimal4=4 <= bigDecimal2=2 is false
bigDecimal2=2 >  bigDecimal4=4 is false
bigDecimal2=2 >= bigDecimal4=4 is false 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-11-30T19:59:02.240

对于您的示例，一个简单且更好的方法是：

```
BigDecimal price;

if(BigDecimal.ZERO.compareTo(price) == 0){

   //Returns TRUE

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-17T06:57:10.700

只想在这里分享一些对 kotlin 有用的扩展

```
fun BigDecimal.isZero() = compareTo(BigDecimal.ZERO) == 0
fun BigDecimal.isOne() = compareTo(BigDecimal.ONE) == 0
fun BigDecimal.isTen() = compareTo(BigDecimal.TEN) == 0 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-07T16:42:05.500

```
if(price.floatValue() == 0){
   return true; //works for 0\0.0
} 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2017-04-07T08:28:55.720

```
BigDecimal.ZERO.setScale(2).equals(new BigDecimal("0.00")); 
```

* * *

## 回答 #12

> 赞同：-9
> 
> 时间：2012-06-08T14:39:08.897

有一个[代表 0](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html#ZERO)的静态常数：

```
BigDecimal.ZERO.equals(selectPrice) 
```

你应该这样做而不是：

```
selectPrice.equals(BigDecimal.ZERO) 
```

以避免出现 where `selectPrice`is的情况`null`。

# json - 了解 REST 响应和 HTTP 状态码

> ID：10950918
> 
> 赞同：3
> 
> 时间：2012-06-08T14:36:21.387
> 
> 标签：json, http, rest, http-status-codes

我想知道我应该如何在我的 REST API 中做出响应。

有效示例：

```
http://blah.com/api/v1/dosomething/123 
```

以上是一个有效的请求，目前我的 HTTP 状态为 200，带有 JSON 响应

```
{
    "dosomething": {
        "status": "OK",
        "results": "123"
    }
} 
```

现在我的问题是，如果传递的参数无效（我期待一串整数），我是返回 200 的 HTTP 响应并在 JSON 响应中传递错误状态还是应该传递类似 HTTP 的东西400 响应（错误请求）并在 JSON 响应中列出请求的错误/问题？

错误示例：

```
http://blah.com/api/v1/dosomething/123a 
```

JSON响应：

```
{
    "dosomething": {
        "status": "ERROR",
        "errors": [
            "Value passed: |123a| must be a integer."
        ]
    }
} 
```

我的问题再次是我应该在传递的参数不是我期望的请求上传递 200 还是 400 HTTP 状态？或者在请求有效时这是否应该始终是 200 响应？

什么被认为是最佳实践？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T20:34:27.890

使用 404。总是。404\. 否则就是误解了URI和资源的性质。如果`http://blah.com/api/v1/dosomething/`识别出资源，并且`123a`仅仅是它的一个参数，那么其他代码可能是有意义的。但它没有：`http://blah.com/api/v1/dosomething/123`识别资源。如果不存在这样的资源，则返回`404 Not Found`。

您可能拥有一些*处理*资源`http://blah.com/api/v1/dosomething/123`和的实现细节`http://blah.com/api/v1/dosomething/123a`，但它不是资源。来自罗伊菲尔丁的[论文](http://www.ics.uci.edu/~fielding/pubs/dissertation/evaluation.htm#sec_6_2_3)：

> “资源不是存储对象。资源不是服务器用来处理存储对象的机制。资源是一个概念映射——服务器接收标识符（标识映射）并将其应用于当前映射实现（通常是集合特定的深度树遍历和/或哈希表的组合）以找到当前负责的处理程序实现，然后处理程序实现根据请求内容选择适当的动作+响应。所有这些特定于实现的问题隐藏在 Web 界面后面；只能通过 Web 界面访问的客户端无法假定它们的性质。”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T15:02:18.070

**作者编辑：422 是错误的答案。我误解了最初的问题并给出了无效的答案。请参阅@fumanchu 的回复：[https](https://stackoverflow.com/a/10955717/441250) ://stackoverflow.com/a/10955717/441250 。**我下面的回答是错误的。

我建议使用“422 Unprocessable Entity”并在您的回复正文中包含失败信息。

> 422（Unprocessable Entity）状态码意味着服务器
> 理解请求实体的内容类型（因此
> 415（Unsupported Media Type）状态码是不合适的），并且
> 请求实体的语法是正确的（因此是 400（Bad Request） )
> 状态码不合适）但无法处理包含的指令。例如，如果 XML
> 请求正文包含格式正确（即语法正确）但
> 语义错误的 XML 指令，则可能会出现这种错误情况。

在处理错误时使用“200 Ok”或任何其他状态码是不可接受的。

PS 状态码列表： [http ://www.iana.org/assignments/http-status-codes/http-status-codes.xml](http://www.iana.org/assignments/http-status-codes/http-status-codes.xml)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-08T14:50:32.770

HTTP 400 用于表示 HTTP 请求本身存在问题（例如无效的 HTTP 标头）。尽管您没有收到您期望的参数，但该请求仍然是有效的 HTTP 请求，因此我将返回 200 响应，但在您的 JSON 中包含缺少参数的详细信息。

# c# - 单击文本时防止复选框检查？

> ID：10950921
> 
> 赞同：0
> 
> 时间：2012-06-08T14:36:27.130
> 
> 标签：c#, asp.net, silverlight, user-controls

换句话说，我想要它，所以当您单击复选框上的文本时，它不会被选中。它仅在您单击实际复选框时进行检查。我已经尝试了很多东西，但都是空的。无论如何，它似乎都会触发所有事件。（单击、选中、聚焦）也许是一种阻止或覆盖默认事件函数的方法？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:38:07.600

不要在复选框控件本身中写入文本，而是在其旁边添加一个带有标题的标签。

所以你会有：

[标签说明] []

单击标签标题不会影响复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:43:35.060

将标签的 for 属性设置为指向复选框 id 是导致单击文本时选中复选框的原因。

```
<label for="checkboxId">test</label><input type="checkbox" id="checkboxId"/> 
```

因此，您可以只删除 for 属性，但从可访问性的角度来看这是不可取的

# c++ - 在非运行时线程上使用 VS2010 并发运行时消息传递类（unbounded_buffer 等）

> ID：10950922
> 
> 赞同：0
> 
> 时间：2012-06-08T14:36:28.310
> 
> 标签：c++, visual-studio-2010, visual-c++, concurrency-runtime

我喜欢 unbounded_buffer 的便利性，但我也想在并发运行时一无所知的线程上使用这个类。在我的测试中，它*似乎*工作正常。这种方法有什么潜在的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:45:11.130

以下是我从 MSFT 收到的关于该问题的信息：

1.  是的，您可以在使用 CreateThread 手动创建的线程上使用消息块（如 unbounded_buffer）。

2.  消息不能跨越 dll 边界，因为它的分配和删除必须发生在同一个 dll 中。一些消息块（如转换器）分配新消息。所以他们也面临同样的问题。unbounded_buffer> 非常好用，只是它不能解决上述问题。type 模板参数是指消息中的有效负载类型（即消息）。这不是信封的类型。

3.  在稳定状态下，数据流网络的吞吐量非常好。性能损失的主要来源是在建立网络时消息块的链接和取消链接。在 Visual Studio 2010 中，send 和 asend 等消息启动命令会遭受这种性能损失。我们已经在即将发布的 Visual Studio 中解决了这个问题。没有计划将修复移植到 VS2010。一种潜在的解决方法是实现一个始终连接到数据流网络的简单 ISource 消息块。使用此块向网络发起消息（agents.h 中的 _Originator 是 ISource 块的示例）。

# client - 是否有任何 OpenStack 服务器验证器工具？

> ID：10950924
> 
> 赞同：0
> 
> 时间：2012-06-08T14:36:37.977
> 
> 标签：client, webserver, validation, openstack

我正在为 OpenStack 构建一个网络服务器，作为我在一家数据存储公司的数据存储服务论文的一部分。我需要一个根据 OpenStack 规范验证服务器响应的工具，我还需要一个可以根据 OpenStack 规范对我的网络服务器进行压力测试的工具。我在谷歌搜索过，但真的找不到任何这样的工具。您是否知道任何可以帮助我实现目标的工具。我遵循的规范可在此链接[http://docs.rackspace.com/files/api/v1/cf-devguide-20120601.pdf](http://docs.rackspace.com/files/api/v1/cf-devguide-20120601.pdf)中找到。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T18:00:30.300

您描述的验证器不作为工具或单独的实用程序存在。但是，您可以使用 devstack 脚本（参见[http://devstack.org](http://devstack.org)）在一个相对较小的虚拟机（1GB VM）中运行所有 OpenStack。

它的速度不快，但绝对是您想要使用的 API。对该 VM 进行快照，您可以在需要时重新创建它，以随意测试您的 Web 服务。这不是我推荐用于性能测试的东西，但是我不确定你的写作或想要测试什么以便能够在那里提出任何合理的建议。

# emacs - Emacs 根据窗口宽度和填充列动态更改字体大小

> ID：10950925
> 
> 赞同：7
> 
> 时间：2012-06-08T14:36:39.370
> 
> 标签：emacs, fonts, size

我在小型上网本上使用 Emacs 编写代码，并且我设置了字体大小，以便大约 fill-column(79) 个字符填充单个“最大化”窗口的宽度（即相当大的字体大小）。但是，如果我并排打开两个窗口，我希望这些窗口中的字体大小自动缩小，以便每个窗口的宽度至少容纳 79 个字符。

在我开始深入研究之前（我不擅长 Lisp），是否可以在每次调整大小时获取窗口的宽度，将其除以填充列，然后根据该结果选择等宽字体大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:13:26.713

在我看来，这样做的正确地方是`window-size-change-functions`：

> 如果窗口大小已更改，则在重新显示之前调用的函数。该值应该是一个接受一个参数的函数列表。就在重新显示之前，对于每一帧，如果它的任何窗口自上次重新显示后改变了大小，或者已被拆分或删除，则调用列表中的所有函数，并将帧作为参数。

具体来说，在你的`.emacs`：

```
(defun window-width-to-font-size (window-width)
  ;; Insert a calculation to turn window width into 79 chars.
  )

(add-to-list
 'window-size-change-functions
 (lambda (frame)
   (dolist (window (window-list frame))
     (set-face-attribute
      'default nil
      :width (window-width-to-font-size (window-body-width window)))))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T02:04:08.503

也许看看 library [`face-remap+.el`](http://www.emacswiki.org/emacs-en/download/face-remap%2b.el)，它基本上是相反的：当你缩小文本大小时，窗口大小会相应地缩小，所以文本周围不会浪费额外的空间。不知道该代码是否会有所帮助，但它可能会给您一些想法。

# java - Microsoft Azure：如何在 Java 中获取 blob 的 md5-hash

> ID：10950926
> 
> 赞同：4
> 
> 时间：2012-06-08T14:36:42.183
> 
> 标签：java, hash, azure, md5, blob

我在 microsoft azure 中存储了一些图片。上传和下载运行良好。但我想用 md5-hash 验证上传的数据，独立于上传和下载。所以这是我的代码（整个连接和帐户都有效。容器也不为空）：

```
public String getHash(String remoteFolderName, String filePath) {

    CloudBlob blob = container.getBlockBlobReference(remoteFolderName + "/" + filePath);

    return blob.properties.contentMD5
} 
```

问题是，我总是为每个 blob 获得 null。我是以正确的方式做的还是有其他的可能性来获得一个 blob 的 md5-hash？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T08:17:34.603

我已经解决了这个问题，就像 smarx 提到的那样。在上传之前，我计算文件的 md5-Hash 并在 blob 的属性中更新它：

```
import java.security.MessageDigest
import com.microsoft.windowsazure.services.core.storage.utils.Base64;
import com.google.common.io.Files

String putFile(String remoteFolder, String filePath){
    File fileReference = new File (filePath)
    // the user is already authentificated and the container is not null
    CloudBlockBlob blob = container.getBlockBlobReference(remoteFolderName+"/"+filePath);
    FileInputStream fis = new FileInputStream(fileReference)
    if(blob){
        BlobProperties props = blob.getProperties()

        MessageDigest md5digest = MessageDigest.getInstance("MD5")
        String md5 = Base64.encode(Files.getDigest(fileReference, md5digest))

        props.setContentMD5(md5)
        blob.setProperties(props)
        blob.upload(fis, fileReference.length())
        return fileReference.getName()
   }else{
        //ErrorHandling
        return ""
   }
} 
```

文件上传后，我可以使用以下方法获取 ContentMD5：

```
String getHash(String remoteFolderName, String filePath) {
    String fileName = new File(filePath).getName()
    CloudBlockBlob blob = container.getBlockBlobReference(remoteFolderName+"/"+filePath)
    if(!blob) return ""
    blob.downloadAttributes()
    byte[] hash = Base64.decode(blob.getProperties().getContentMD5())
    BigInteger bigInt = new BigInteger(1, hash)
    return bigInt.toString(16).padLeft(32, '0')
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:45:21.680

只有在上传 blob 时设置了 MD5 哈希值，它才可用。有关更多详细信息，请参阅此帖子：http: [//blogs.msdn.com/b/windowsazurestorage/archive/2011/02/18/windows-azure-blob-md5-overview.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/02/18/windows-azure-blob-md5-overview.aspx)

是否有可能从未为这些 blob 设置 MD5 哈希？

# html - 单选按钮的css背景图像未显示

> ID：10950931
> 
> 赞同：2
> 
> 时间：2012-06-08T14:36:52.407
> 
> 标签：html, css, image, url, radio-button

我有这个CSS代码：

```
input[type=radio] {
  opacity: 0;
  float: left;
  width: 25px;
  margin: 0;
  clear: none;
  padding: 5px 0 4px 24px;
  cursor: pointer;
  background-image: url(../images/off.png) left center no-repeat; 
}

input[type=radio]#male:checked {
  background-image: url(../images/radio-male.png) left center no-repeat; 
}

input[type=radio]#female:checked {
  background-image: url(../images/radio-female.png) left center no-repeat; 
} 
```

而且无论我做什么，我都无法显示图像。我查看了 chrome 中开发人员工具的网络选项卡，看起来好像图像甚至没有被发送到浏览器，这很奇怪，因为我确信 url 是正确的。任何提示或提示将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:48:45.837

您使用`background-image`的应该只指定图像的 url。如果要在同一行中指定定位/重复，请将其更改为 just `background`。

例如：

```
background: transparent url('../images/radio-female.png') left center no-repeat; 
```

`transparent`如果您想要颜色和图像，请更改。

您似乎也无法设置无线电输入本身的背景样式，但是您可以通过设置标签样式然后使用填充将背景放在左侧来实现相同的效果。在此处查看我的示例：

[http://jsfiddle.net/fqJg7/](http://jsfiddle.net/fqJg7/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:52:08.637

我建议你使用 ready`jQuery Plugin`来做到这一点。在我看来，这将是一种更好、更优雅的方式。这对你来说也会更容易。

例如，您可以使用：**[http](http://uniformjs.com/)** ://uniformjs.com/ 。

**关于 : 制服**

*“您是否曾希望您可以设置复选框、下拉菜单、单选按钮和文件上传输入的样式？是否曾希望您可以在所有浏览器之间控制表单元素的外观和感觉？如果是这样，Uniform 是您最好的新朋友。Uniform用自定义主题控件掩盖您的标准表单控件。它与您的真实表单元素同步工作，以确保可访问性和兼容性。*

***有很多插件，你可以得到你想要的。***

我希望它有帮助。

问候，

约翰。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T14:56:05.830

这是因为 opacity 设置为 0。我认为您这样做是因为您想要一个自定义皮肤单选按钮，所以您使用 opacity 隐藏本机控件，希望当状态更改时背景图像会发生变化。要实现您想要的，您需要将背景图像放在包含图像上，并使用连接到单选按钮上的更改或单击事件的 javascript 更新背景。或者完全隐藏本机控件并使用 javascript 操作它。

我建议使用这样的插件，它将为您完成所有艰苦的工作，让您根据需要更改 css：[http ://code.google.com/p/jquery-checkbox/](http://code.google.com/p/jquery-checkbox/)

另请注意，如果您的方法确实有效，我建议使用 css sprite 更改图像的背景位置，而不是更改源图像本身，因为在下载新图像时会有明显的延迟/闪烁。[http://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:50:12.130

我很确定大多数浏览器都不支持此功能。您需要创建一个自定义方法来渲染它，我见过一些人隐藏复选框，然后添加一个图像来保存选中的图像，然后更改复选框，

像这样的东西： [http ://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T14:48:50.400

我认为这是因为您的不透明度设置为 0。当我删除它时，它似乎显示单选按钮：http: [//jsfiddle.net/T4eBA/3/](http://jsfiddle.net/T4eBA/3/) 如果这不起作用，您能否提供有关目录结构的详细信息? 您当前布局 css 的方式，我预测您的结构如下：

index.html、图片、css、...等

# java - Java 收到错误“未处理的异常类型 XYZ”

> ID：10950937
> 
> 赞同：0
> 
> 时间：2012-06-08T14:37:27.093
> 
> 标签：java, macos, jce

我有这个代码：

```
class Crypt
{
    Key KEY;
    String TD;
    Cipher aes = Cipher.getInstance("AES/CBC/PKCS5Padding");

    KeyGenerator keyGen = KeyGenerator.getInstance("AES");

public Crypt()
{
    int keyLength = 192;
    keyGen.init(keyLength);
    KEY = keyGen.generateKey(); 
```

编译时会出现此错误：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problems: 
    Unhandled exception type NoSuchAlgorithmException
    Unhandled exception type NoSuchPaddingException
    Unhandled exception type NoSuchAlgorithmException 
```

在研究错误时，我发现[了这个](https://stackoverflow.com/a/2784955/530933)。但是在下载、安装和[验证](https://groups.google.com/group/jets3t-users/msg/06751e3ffbb4e322)无限强度管辖政策文件是最新的之后，我仍然收到错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:41:10.247

您的错误非常清楚，与无限制权限加密文件无关。它告诉你有未处理的检查异常。

添加`throws Exception`到您的构造函数，使其看起来像这样：

```
public Crypt() throws Exception
{
    int keyLength = 192;
    keyGen.init(keyLength);
    KEY = keyGen.generateKey(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:42:19.710

您是否也将它们安装到 /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/lib/security 中？

# php - 在 php 中通过 eval 分配变量的好处？

> ID：10950939
> 
> 赞同：1
> 
> 时间：2012-06-08T14:37:28.297
> 
> 标签：php, eval

再会！目前我正在学习一门具有以下内容的课程：

```
if( $something) {  eval ('$actualValue = &$this->'.$value.';'); } 
```

您能否向我解释使用 eval 和不使用 eval 编写它的利弊（只需定期通过 php 分配一个值）

**更新 1**

对此感到抱歉，但我刚刚在课堂的另一部分看到了使用 eval 的更完整版本：

```
if( $something) {  
eval ('$actualValue = &$this->'.$value.';'); 
if(isset($actualValue)) { 
//some code
}
} 
```

现在更清楚了......但仍然有一个问题：为什么不使用 eval 不这样做......只是不明白。但仍然感谢大家的回答和提供链接！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:39:23.993

不，这没有任何好处。这要好得多：

```
$actualValue = &$this->$value; 
```

我想有人不知道你能做到这一点，所以他们重新发明了轮子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:44:43.227

看看我问的以下问题：

[动态填充多维数组](https://stackoverflow.com/questions/10919096/dynamically-populating-multi-dimensional-arrays)

我使用 eval 基于通过函数参数抛出的参数创建动态多维数组。

但是，通过引用存储变量要容易得多。

# iphone - sqlite_step（语句）中的 EXC_BAD_ACCESS

> ID：10950941
> 
> 赞同：5
> 
> 时间：2012-06-08T14:37:30.053
> 
> 标签：iphone, xcode, sqlite, crash, exc-bad-access

我正在为 iphone 应用程序使用 sqlite 数据库。但有时从数据库中检索数据时，它会在“while loop”行崩溃。

```
-(void)GetMethod
{

    NSString *query = [[NSString alloc] initWithFormat:@"SELECT * FROM errorlogs"];
    sqlite3_stmt *statement;    
    if (sqlite3_prepare_v2(database, [query UTF8String],-1, &statement, nil) == SQLITE_OK) 
    {
        while (sqlite3_step(statement) == SQLITE_ROW) **// EXC_BAD_ACCESS ON THIS LINE**
        { 
            char *uid1 = (char *)sqlite3_column_text(statement, 0);
            NSString *uid = [NSString stringWithFormat:@"%s",uid1];
        }
    }
    sqlite3_finalize(statement);
} 
```

为什么我在 while 循环中得到这个 EXC_BAD_ACCESS。

![在此处输入图像描述](../Images/376035ff3e3fe6b55f358c36efc63f56.png) 谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:46:41.410

尝试使用 FMDB 框架，它对我的​​项目帮助很大。
这是链接：[https](https://github.com/ccgus/fmdb)
://github.com/ccgus/fmdb 如果可以的话，看看吧；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:00:35.907

要么`sqlite3_step(statement)`or`SQLITE_ROW`没有初始化，要么已经被释放。当它对不存在的对象运行相等检查时，它会抛出 EXE_BAD_ACCESS。

您是否返回任何行？

# jquery - JQuery 删除子元素

> ID：10950942
> 
> 赞同：2
> 
> 时间：2012-06-08T14:37:34.923
> 
> 标签：jquery

我有这个结构

```
<section class="main">
   <div class="first" />
   <h1 class="subtitle" />
   <div class="body" />
   <div class="module" />
</section>
<section class="main">
   <div class="first" />
   <h1 class="subtitle" />
   <div class="body" />
   <div class="module" />
</section> 
```

我只需要在其中一个部分中删除 .body 和 .subtitle 。

我怎样才能使用 jquery 做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T14:39:17.060

尝试使用`.eq`选择正确的主要部分并执行`.find`. 见下文，

```
$('.main').eq(0)  //use 1 if you want to remove from second section
          .find('.body, .subtitle').remove(); 
```

**演示：http:** [//jsfiddle.net/dtFsb/](http://jsfiddle.net/dtFsb/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:40:02.503

```
$('.body, .subtitle', '.main:eq(0)').remove(); 
```

因此，上面的代码意味着您将从第一部分中删除，如果您想从第二个更改中`eq(0)`删除`eq(1)`.
[在职的](http://jsfiddle.net/gTMVh/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:47:33.687

通过第二个参数提供上下文。在这种情况下，我们的上下文将是第一个`.main`元素：

```
$(".body, .subtitle", ".main:first").remove(); 
```

# php - 如何将产品发布到特定的亚马逊市场

> ID：10950958
> 
> 赞同：2
> 
> 时间：2012-06-08T14:38:16.107
> 
> 标签：php, api, e-commerce, amazon, amazon-mws

我是卖家，我有 2 个市场，

`1) amazon.com`

`2) webstore`

我想通过 mws 产品提要发送到我的网上商店，我有市场 ID。

这是我正在使用的代码。

```
$parameters =  array ('MarketplaceIdList' => $this->marketPlaceId,
'Merchant' =>  $this->merchantId, 'FeedType' =>
$feedType,'FeedContent' => $feedHandle, 'PurgeAndReplace' =>
false,'ContentMd5' =>
base64_encode(md5(stream_get_contents($feedHandle), true)),);       

$request = new
MarketplaceWebService_Model_SubmitFeedRequest($parameters); 
```

这是amazpn PDF中写的

> 不要将可选的 MarketplaceIdList 参数与请求中的 Marketplace 参数混淆。Marketplace 参数不再用于身份验证且已弃用，但仍保留在请求中以实现向后兼容性。

当我使用它时，参数“MarketplaceIdList”不起作用，它发布到两个市场，只发布到一个市场。

请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:40:57.967

试试这个

```
$marketplaceIdArray = array("Id" => array($MARKETPLACE_ID));
$parameters = array(
             'Merchant' => $MERCHANT_ID,
             'MarketplaceIdList' => $marketplaceIdArray,
             'FeedType' => '_POST_INVENTORY_AVAILABILITY_DATA_',
             'FeedContent' => $feedHandle,
             'PurgeAndReplace' => false, //Leave this PurgeAndReplace to false so that it want replace whole product in amazon inventory
             'ContentMd5' => base64_encode(md5(stream_get_contents($feedHandle), true))
         ); 
```

# visual-studio-2010 - 你今天会使用 iBatis.Net 吗？

> ID：10950960
> 
> 赞同：0
> 
> 时间：2012-06-08T14:38:17.863
> 
> 标签：visual-studio-2010, ibatis.net

我已经使用 Java 版本的 iBatis 多年了，最近我决定将它与 C# 一起使用，所以我去网站获取文件，我对我看到的内容有点不舒服。文档日期为 2007 年，它指的是 .Net 2，iBatis.Net 只是感觉被抛弃了。

我真的很喜欢 iBatis，我尝试过 Entity Framework 和 NHibernate，但我仍然更喜欢 iBatis。我目前正在使用 Visual Studio 2010。您能告诉我您使用 iBatis.Net 的经验（最好使用 VS 2010）吗？我应该使用它吗？你相信它有未来吗？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T14:04:31.243

IBatis.Net 移至 MyBatis.Net；参见[MyBatis 网站](http://mybatis.org)。

我在许多 C# 项目中使用了 IBatis.Net。ORM 的使用可以被视为对 IBatis 使用的方法的反对或补充。

Linq2Sql 或 EntityFramework 或 NHibernate 是 ORM，IBatis 是对对象映射器的语句；我更喜欢在以下情况下使用 IBatis：

*   我不拥有数据库
*   DB 的 DB 模式是高度规范化的，专为关系使用而设计
*   数据库架构大于应用程序域
*   DB 提供了一个过程 API：一组抽象表和对它们的 SQL 操作的过程
*   当需要非常自定义的 SQL 调优时
*   当我需要向 DBA 授予除二进制解决方案之外的 SQL 访问权限时

考虑您可以使用混合并选择 ORM 来映射表和 IBatis 来映射语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T22:04:13.877

虽然 iBatis.NET 看起来并不像被遗弃，但它看起来确实很接近。在我写这篇文章时，去年只有 2 次提交，过去 2 年没有新版本。从长远来看，这让我感到紧张，除非我愿意自己维护代码，否则我不会在新项目中使用它。如果情况变得更糟，并且框架本身需要修复。

我不是在讨论 iBatis 与任何其他库在功能方面的优点，只是在风险维护方面。

# google-maps-markers - 将变量传递到 FusionTableLayer 中的信息窗口

> ID：10950968
> 
> 赞同：0
> 
> 时间：2012-06-08T14:38:45.000
> 
> 标签：google-maps-markers, google-fusion-tables, infowindow

我正在构建一个 Web 应用程序，其中包含一个 Google 地图，其中包含来自 Google Fusion Table 的数据。我已经为 Fusion Table 中的标记定义了信息窗口，并且一切都按预期呈现，但我有一个问题。我需要从我的 Web 应用程序传递一个会话变量，以包含在信息窗口中定义的链接中，但似乎找不到执行此操作的方法。下面是我目前用来渲染地图的 javascript：

```
var myOptions = {
  zoom: 10,
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  center: new google.maps.LatLng( 40.4230,-98.7372)
}
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

// Weather

weatherLayer = new google.maps.weather.WeatherLayer({
  temperatureUnits: google.maps.weather.TemperatureUnit.FAHRENHEIT
});
weatherLayer.setMap(map);

//Hobby Stores

var storeLayer = new google.maps.FusionTablesLayer({
  query: { select: "col2", from: "3991553" },
  map: map,
  supressInfoWindows: true
});

//Club Sites

var siteLayer = new google.maps.FusionTablesLayer({
  query: { select: "col13", from: "3855088" },
  styles: [{ markerOptions: { iconName: "airports" }}],
  map: map,
  supressInfoWindows: true
}); 
```

我希望能够在对 google.maps.FusionTableLayer 的调用中传递某种类型的参数，该参数传递一个要包含在信息窗口中的值，但找不到执行此操作的方法。

要查看实际页面，请访问[www.dualrates.com](http://www.dualrates.com/pls/apex/f?p=RC:30)。输入您的邮政编码并选择一个机场标记以查看信息窗口。您可能需要缩小地图才能看到机场。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T22:37:28.190

此示例显示如何自定义信息窗口内容：

[https://developers.google.com/fusiontables/docs/samples/change_infowindow_content](https://developers.google.com/fusiontables/docs/samples/change_infowindow_content)

您将更新以下函数以包含您的特定表的信息并添加会话变量。假设您使用的是 php，它可能看起来像这样：

```
google.maps.event.addListener(layer, 'click', function(e) {

  // Change the content of the InfoWindow
  e.infoWindowHtml = e.row['Store Name'].value + "<br>";

  // If the delivery == yes, add content to the window
  if (e.row['delivery'].value == 'yes') {
    e.infoWindowHtml += "Delivers!";
  }

  e.infoWindowHtml += "<?php echo $_SESSION['yourvariable']; ?>";
}); 
```

# wpf - 您如何删除流文档的所有内容

> ID：10950977
> 
> 赞同：8
> 
> 时间：2012-06-08T14:39:20.427
> 
> 标签：wpf, richtextbox, flowdocument

我创建了一个流程文档并以编程方式向其中添加了许多段落。现在，我希望能够将流程文档重置为空白，从而导致所有内容都被删除。

我一直在寻找诸如清除、重置、删除所有、擦除之类的东西。有没有清空文档的方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-08T14:46:46.120

清除`Blocks`集合`FlowDocument`：

```
document.Blocks.Clear(); 
```

How to: Manipulate a FlowDocument through the [Blocks Property](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/how-to-manipulate-a-flowdocument-through-the-blocks-property?view=netframeworkdesktop-4.8)包括这个例子，以及其他常见的操作（比如在开头插入一个新的段落，或者删除最后一个块元素）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-08T14:46:47.890

以下示例[`Block`](http://msdn.microsoft.com/en-us/library/system.windows.documents.flowdocument.blocks.aspx)清除[`FlowDocument`](http://msdn.microsoft.com/en-us/library/ms601064).

```
flowDoc.Blocks.Clear(); 
```

有关上述示例，请参阅[如何：通过 Blocks 属性操作 FlowDocument ，有关更多示例，请参阅](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/how-to-manipulate-a-flowdocument-through-the-blocks-property?view=netframeworkdesktop-4.8)[FlowDocument 概述](http://msdn.microsoft.com/en-us/library/aa970909.aspx)。

# batch-file - Windows bat 文件：运行

> ID：10950978
> 
> 赞同：-2
> 
> 时间：2012-06-08T14:39:21.817
> 
> 标签：batch-file

我想写一个脚本，它这样做：开始->运行->“smth”。如何将其写入 bat 文件以完成相同的任务。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:42:35.510

创建一个名为 sample.bat 的文件并制作其内容：

```
@echo off

echo opening server location

start "" \\192.168.2.1

pause 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:00:25.613

我认为您正在尝试使用资源管理器进行浏览，这`Run`可以，但批处理会尝试并执行。尝试将其放入批处理文件中：

```
explorer \\server_address 
```

# java - 签署大型 PDF 文件时出现 iText 错误：SigDict /Contents 非法数据

> ID：10950981
> 
> 赞同：3
> 
> 时间：2012-06-08T14:39:38.677
> 
> 标签：java, pdf, itext, signature

我正在尝试使用 iText（最新版本）为 Java 签署大量 PDF 文件。但我对大的有问题。对于大小超过 30 MByte（直到 120 MByte）的文件，我在 Acrobat 阅读器（和其他阅读器）中收到签名无效错误并显示以下消息：**SigDict / Contents 非法数据**

相同的代码适用于大小 < 30 MByte 的其他文件。这是我使用的代码：

```
KeyStore ks = KeyStore.getInstance("JKS");
ks.load(new FileInputStream(keystore_path), keystore_password.toCharArray());
String alias = prop.getProperty("key.alias");
PrivateKey pk = (PrivateKey)ks.getKey(alias , key_password.toCharArray());
Certificate[] chain = ks.getCertificateChain(alias);

PdfReader reader = new PdfReader(fileIn.getPath(), ownerpassword);          
PdfStamper stamper = PdfStamper.createSignature(reader, new FileOutputStream(fileOut),  '\0', null , true);                         
PdfSignatureAppearance appearance = stamper.getSignatureAppearance();
appearance.setCrypto(pk, chain, null, PdfSignatureAppearance.WINCER_SIGNED);
Rectangle rect = new Rectangle(Integer.parseInt(prop.getProperty("sign.field.start.x")),
                    Integer.parseInt(prop.getProperty("sign.field.start.y")),
                    Integer.parseInt(prop.getProperty("sign.field.end.x")), 
                    Integer.parseInt(prop.getProperty("sign.field.end.y")));
appearance.setReason(prop.getProperty("sign.field.reason"));
appearance.setLocation(prop.getProperty("sign.field.location"));
appearance.setVisibleSignature(rect, Integer.parseInt(prop.getProperty("sign.field.page")), "SignField");            

stamper.close(); 
```

- - 更新 - -

这似乎是一个与 Java 的 iText（至少 5.2.1）错误有关的问题。

看到这篇文章：http: [//itext-general.2136553.n4.nabble.com/iText-error-in-signing-big-PDF-files-SigDict-Contents-illegal-data-td4655309.html#none](http://itext-general.2136553.n4.nabble.com/iText-error-in-signing-big-PDF-files-SigDict-Contents-illegal-data-td4655309.html#none)

我为所有遇到此类问题的人打开了帖子。

# python - 在 Django 中安全执行可能不安全的代码？

> ID：10950989
> 
> 赞同：1
> 
> 时间：2012-06-08T14:39:58.393
> 
> 标签：python, django, django-models, security

目前，我正在开发一个项目中的一个功能，该功能需要我加载存储在在线数据库中的代码。代码应该适度信任，但不完全信任。

我们目前在一个单独的非显而易见的表中使用该字段的 md5 总和来确保我们正在执行的代码没有被更改，但我们也希望使用 pysandbox 对代码进行沙箱处理（也接受更好的建议）。当我们必须使用 django 模型从数据库中获取信息时，问题就出现了，因为 pysandbox 总是在我们尝试接触模型时除外。

安全执行器：

```
for hash in HashedChecksum.objects.all():
    if code_md5hash == hash.data:
        sandbox = Sandbox(SandboxConfig('stdout'))
        config.allowModule(contacts.models, Suppliers)
        namespace = {'query_dict': query_dict}
        sandbox.execute(code, locals=namespace)
        print namespace
    else:
        assert False 
```

要执行的代码：

```
print "code in sandbox"
try:
    import contacts.models
    print "hey"
    print contacts.models.Supplier.objects.all()  #line that excepts
except:
    print "Excepted"
print "Ended Execution" 
```

异常输出示例：

```
try:
    import jmsdirectory.contacts.models
    print jmsdirectory.contacts.models.Supplier.objects.all()
except Exception as e:
    print e 
```

异常输出：

```
5.5
SafeModule 'jmsdirectory' has no attribute 'contacts'
5.6
{'e': AttributeError("SafeModule 'jmsdirectory' has no attribute 'contacts'",), 'company': u'D5202F00-A8C7-11E1-B68A-00219B15530E', 'jmsdirectory': <SafeModule 'jmsdirectory' from 'C:\\Joinerysoft\\Development\\joinerysoft-directory\\jmsdirectory\\..\\jmsdirectory\\__init__.pyc'>, 'contact': u'D53D7B00-A8C7-11E1-A34B-00219B15530E', 'address': u'D53368E1-A8C7-11E1-AF74-00219B15530E', 'type': u'stays'}
run_code: 6
[08/Jun/2012 15:53:01] "POST /transfer/server/ HTTP/1.0" 200 129 
```

# apache - 如何对 mod_rewrite 设置的 cookie 进行编码？

> ID：10950991
> 
> 赞同：0
> 
> 时间：2012-06-08T14:39:59.307
> 
> 标签：apache, mod-rewrite, encode

我们有一个场景，我们在 Apache 2.2 的 httpd.conf 中使用重写规则条件从查询字符串中获取参数，并将其写入 Cookie：

```
CustomLog "/www/apache/ndipiazza/logs/ssl_request_log" \
          "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b \"%{Cookie}i\""

RewriteEngine On
RewriteCond %{QUERY_STRING} CID=(.*)
RewriteRule .* - [L,CO=COOKIE_CID:%1:ndipiazza-local.com:50000] 
```

例如，URL "http://ndipiazza-local/mypage.jsp?CID=NickDogg" 创建一个 cookie "COOKIE_CID = NickDogg"

但是，我们不能完全使用此解决方案，因为我们有一个限制，即我们不能将此 cookie 存储为明文。截至目前，它以明文形式写入日志，并将 cookie 以明文形式写入。我们需要对其进行编码。

有没有办法让 apache 对存储的 cookie 进行编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T19:14:47.200

是的，有办法做到这一点。

为此，您想使用带有 MapType "prg" 的 RewriteMap。

所以你会定义一个 RewriteMap 像

```
RewriteEngine On 
RewriteMap encode-map prg:/path/to/encode_script 
RewriteCond %{QUERY_STRING} UID=(.*) 
RewriteRule .* - [L, CO=COOKIE_CID:${encode-map:%1}:ndipiazza-local.com:50000] 
```

/path/to/encode_script 是您系统上的一个脚本，它在 apache 启动时启动一次，然后获取换行符终止的字符串进行编码，并且必须在没有 stdout 缓冲的情况下输出换行符编码的字符串。

[有关更多信息和示例，请参阅http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.0/rewrite/rewrite_guide.html)上的“外部重写程序”部分和[http://httpd.apache.org/](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)上的“prg”示例[docs/2.0/rewrite/rewrite_guide.html](http://httpd.apache.org/docs/2.0/rewrite/rewrite_guide.html)和[http://httpd.apache.org/docs/2.0/rewrite/rewrite_guide_advanced.html](http://httpd.apache.org/docs/2.0/rewrite/rewrite_guide_advanced.html)

# c# - 在 Windows 窗体项目中嵌入 Mono 时创建 OSX 应用程序包

> ID：10950993
> 
> 赞同：1
> 
> 时间：2012-06-08T14:40:06.493
> 
> 标签：c#, macos, mono, monodevelop

我正在尝试使用 MonoDevelop 3.0.2 创建一个简单的应用程序包。

创建一个新的解决方案*Empty MonoMac project*。添加对*System.Windows.Forms*的引用。使用以下代码创建一个新类：

```
using System;
using System.Windows.Forms;

namespace MM2
{
    public class Program
    {
        public static void Main()
        {
            MessageBox.Show ("Hello world");
        }
    }
} 
```

这可以从 MonoDevelop 完美运行。然后在*Project Options*对话框中，选择*Mac OS X Packaging*屏幕。选中*在应用程序包中包含 Mono 运行时*。我将其他选项保留为默认值（平台为 X86）。

通过选择 Build/Build all 来构建包。这会在 bin/Debug 文件夹中创建一个 MM.app 包。

打包程序没有将*libgdiplus.dylib*复制到包中，所以我必须手动执行此操作。（如果没有这一步，应用程序将无法启动，并且控制台日志明确指出 Mono 找不到 libgdiplus）。我将文件*libgdiplus.0.dylib*和链接*libgdiplus.dylib*从 /Library/Frameworks/Mono.framework/Libraries 文件夹复制到应用程序包的 Contents/Resources 文件夹。

现在应用程序包是自包含的，它不需要安装 Mono 运行时。运行时，它会显示消息框。但是在单击 OK 按钮后，程序关闭，Mono 运行时崩溃。这是来自控制台日志的堆栈跟踪：

```
Native stacktrace:
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    0   MM2                                                 0x000a072f mono_handle_native_sigsegv + 287
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    1   MM2                                 0x000058de mono_sigsegv_signal_handler + 334
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    2   libsystem_c.dylib                   0x9435859b _sigtramp + 43
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    3   ???                                 0xffffffff 0x0 + 4294967295
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    4   CoreFoundation                      0x940e4e05 _CFAutoreleasePoolPop + 53
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    5   Foundation                          0x9386ea2f -[NSAutoreleasePool release] + 131
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    6   MM2                                 0x00002b52 main + 1458
6/8/12 6:11:43.089 PM [0x0-0x26026].com.yourcompany.MM2:    7   MM2                                 0x00002555 start + 53 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-12-21T22:12:46.183

单击确定后，程序应该结束。您的主要功能的结束是应用程序的结束。

如果您有一个事件循环或做某事 - 它不会自动结束。

# iphone - 重命名的项目将无法运行

> ID：10950994
> 
> 赞同：0
> 
> 时间：2012-06-08T14:40:24.777
> 
> 标签：iphone, objective-c, xcode, crash

最近我们采取了一个项目并将其重命名并将类名称更改为通用名称，以用作未来应用程序的模板。我们现在遇到的问题是该项目已被重命名，它将不再运行。我们不断收到如下错误。任何帮助都会很棒！谢谢！

```
Ld "/Users/mejim707/Library/Developer/Xcode/DerivedData/AppTemplate_HD-enipxoysstcfkqevpmxrhtkwglhy/Build/Products/Debug-iphonesimulator/AppTemplate HD.app/AppTemplate HD" normal i386
cd "/Users/mejim707/Desktop/untitled folder/AppTemplate HD"
setenv MACOSX_DEPLOYMENT_TARGET 10.6
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang++ -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -L/Users/mejim707/Library/Developer/Xcode/DerivedData/AppTemplate_HD-enipxoysstcfkqevpmxrhtkwglhy/Build/Products/Debug-iphonesimulator -F/Users/mejim707/Library/Developer/Xcode/DerivedData/AppTemplate_HD-enipxoysstcfkqevpmxrhtkwglhy/Build/Products/Debug-iphonesimulator -filelist "/Users/mejim707/Library/Developer/Xcode/DerivedData/AppTemplate_HD-enipxoysstcfkqevpmxrhtkwglhy/Build/Intermediates/AppTemplate HD.build/Debug-iphonesimulator/AppTemplate HD.build/Objects-normal/i386/AppTemplate HD.LinkFileList" -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -D__IPHONE_OS_VERSION_MIN_REQUIRED=30200 -Xlinker -no_implicit_dylibs -lz.1.2.5 -framework Foundation -framework UIKit -framework CoreGraphics -framework QuartzCore -framework AVFoundation -framework StoreKit -o "/Users/mejim707/Library/Developer/Xcode/DerivedData/AppTemplate_HD-enipxoysstcfkqevpmxrhtkwglhy/Build/Products/Debug-iphonesimulator/AppTemplate HD.app/AppTemplate HD"

Undefined symbols for architecture i386:
"_OBJC_CLASS_$_AppTemplateViewController", referenced from:
  objc-class-ref in AppTemplateAppDelegate.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:43:41.147

检查您的构建阶段，然后编译源代码以查看是否有任何仍在调用但不存在的类。当我更改类名或删除类时，我总是收到该错误。