# StackOverflow 问答 10965000-10965999

# python - 应用启动时出现 Python/Tornado 错误

> ID：10965003
> 
> 赞同：2
> 
> 时间：2012-06-09T22:22:55.473
> 
> 标签：python, tornado

我的 Tornado 应用程序在启动时反复出现此错误：

```
 File "/Library/Python/2.7/site-packages/tornado/database.py", line 59, in __init__
    args = dict(conv=CONVERSIONS, use_unicode=True, charset="utf8",
NameError: global name 'CONVERSIONS' is not defined 
```

我已经用 pip 安装了 Tornado 和 MySQLdb。我已经卸载并重新安装了两者。我正在针对远程 MySQL 实例运行。

我很困惑，不知道如何排除故障。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:56:48.270

最终这掩盖了这个错误：

```
ImportError: dlopen(/Library/Python/2.7/site-packages/_mysql.so, 2): Library not loaded: libmysqlclient.18.dylib
  Referenced from: /Library/Python/2.7/site-packages/_mysql.so
  Reason: image not found 
```

我可以通过设置 DYLD_LIBRARY_PATH 来解决这个问题：

```
export DYLD_LIBRARY_PATH=/usr/local/mysql/lib:$DYLD_LIBRARY_PATH 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:38:05.343

如果你在 MAC OS 和 Eclipse 中运行它，你应该将 DYLD_LIBRARY_PATH 添加到 eclipse 的环境设置中。

# c - 使用数组创建堆时出错

> ID：10965004
> 
> 赞同：0
> 
> 时间：2012-06-09T22:22:58.197
> 
> 标签：c

我正在尝试使用数组在 C 中创建[二进制最小堆。](http://en.wikipedia.org/wiki/Binary_heap)我编写了代码并多次尝试用“笔和纸”执行它，它似乎有效。你能帮我理解为什么它会失败吗？

这是库代码：

```
#include <stdlib.h>

void swapInt(int *a, int *b) {
    int aux = *a;
    *a = *b;
    *b = aux;
}

typedef struct intHeapArray {
    int *array;
    int size;
} IntHeapArray;

IntHeapArray newIntHeapArray (int dim) {
    IntHeapArray new;
    new.array = (int*) malloc(sizeof(int)*dim);
    new.size = 0;
    return new;
}

int findFather (int index) {
    return (index - 1) / 2;
}

int findLeftChild (int index) {
    return index * 2 + 1;
}

int findRightChild (int index) {
    return index * 2 + 2;
}

int minFatherChilds (IntHeapArray h, int index) {
    int leftchild = findLeftChild(index);
    int rightchild = findRightChild(index);
    if (rightchild >= h.size)
        rightchild = leftchild;
    if (h.array[index] > h.array[leftchild])
        index = leftchild;
    if (h.array[index] > h.array[rightchild])
        index = rightchild;
    return index;
}

void reorganizeIntHeapArray (IntHeapArray *h, int index) {
    int father, leftchild, child;
    father = findFather(index);
    while (index > 0 && h->array[index] < h->array[father]) {
        swapInt(&h->array[index], &h->array[father]);
        index = father;
    }
    leftchild = findLeftChild(index);
    while (leftchild < h->size && index != minFatherChilds(*h, index)) {
        child = minFatherChilds(*h, index);
        swapInt(&h->array[index], &h->array[child]);
        index = child;
    }
}

void enqueueIntHeapArray (IntHeapArray *h, int val) {
    h->array[h->size] = val;
    h->size++;
    reorganizeIntHeapArray(h, h->size - 1);
} 
```

这是来自主脚本的调用：

```
#include <stdio.h>
#include "heap.h"

void printIntArray (int *a, int dim) {
    int i;
    printf("[");
    for (i = 0; i < dim - 1; i++)
        printf("%d, ", a[i]);
    printf("%d]\n", a[dim-1]);
}

int main () {
    IntHeapArray h;
    int n, i, val;

    printf("How many value would you like to add to the heap? ");
    scanf("%d", &n);

    h = newIntHeapArray(n);

    printf("Insert values:\n");
    for (i = 0; i < n; i++) {
        scanf("%d", &val);
        enqueueIntHeapArray(&h, val);
    }

    printf("This is your heap:\n");
    printIntArray(h.array, h.size);

    return 0;
} 
```

代码编译。试试这个输入：`6 3 8 9 2 0`. 它将打印：`[3, 2, 0, 9, 6, 8]`这显然是错误的。但我真的不明白我错在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T13:44:18.577

我发现了错误。重组堆函数必须更改为：

```
void reorganizeIntHeapArray (IntHeapArray *h, int index) {
    int father, leftchild, child;
    father = findFather(index);
    while (index > 0 && h->array[index] < h->array[father]) {
        swapInt(&h->array[index], &h->array[father]);
        index = father;
        father = findFather(index);
    }
    leftchild = findLeftChild(index);
    while (leftchild < h->size && index != minFatherChilds(*h, index)) {
        child = minFatherChilds(*h, index);
        swapInt(&h->array[index], &h->array[child]);
        index = child;
        leftchild = findLeftChild(index);
    }
} 
```

我只更新了索引值而不是父亲的值。所以在第一次切换之后，它会将 h->array[index] 与自身进行比较，而不是与它的新父亲进行比较。

编辑：它仍然是错误的。我在第二个中做了同样的错误，我在第一个中犯了同样的错误。我没有更新 leftchild 值。现在应该是正确的。

# perl - 在 Perl 中将字符串 "abc" 转换为 $hash->{a}->{b}->{c}

> ID：10965006
> 
> 赞同：7
> 
> 时间：2012-06-09T22:23:21.337
> 
> 标签：perl, perl-data-structures

我有这样的动态嵌套哈希引用：

```
my $hash = { 'a' => { 'b' => { 'c' => 'value' } } }; 
```

我想通过允许用户输入“abc something”将 c 的值设置为“something”。

现在可以像这样*获取值：*

```
my $keys = 'a.b.c'; 
my $v='something';
my $h = $hash;
foreach my $k(split /\./, $keys) {
  $h = $h->{$k};
}
print $h; # "value" 
```

但是我如何将key的值*设置*`c`为`$v`

```
print Dumper $hash; 
```

会反映变化吗？`$h`不是 foreach 循环末尾的 ref，因此更改它不会反映`$hash`. 任何提示如何解决我脑海中的结？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T22:32:01.487

像这样的东西：

```
my $h = $hash;
my @split_key = split /\./, $keys;
my $last_key = pop @split_key;
foreach my $k (@split_key) {
    $h = $h->{$k};
}
$h->{$last_key} = $v; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T07:57:17.157

```
sub dive_val :lvalue {
   my $p = \shift;
   $p = \( ($$p)->{$_} ) for @_;
   return $$p;
}

my $data;
my $key = 'a.b.c';
my $val = 'value';

dive_val($data, split /\./, $key) = $val; 
```

[Data::Diver](http://search.cpan.org/perldoc?Data::Diver)提供了这个函数的更强大（因此更难使用）的版本。

```
use Data::Diver qw( DiveVal );

my $data;
my $key = 'a.b.c';
my $val = 'value';

DiveVal($data //= {}, map \$_, split /\./, $key) = $val; 
```

（daxim 的用法略有偏差。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-10T06:50:08.043

```
use strictures;
use Data::Diver qw(DiveVal);

my ($hash, $path, $value) = (
    { 'a' => { 'b' => { 'c' => 'value' } } },
    'a.b.c',
    'something',
);

DiveVal($hash, split /[.]/, $path) = $value;
# { a => { b => { c => 'something' } } } 
```

# objective-c - 带有 NSTask 的命令

> ID：10965007
> 
> 赞同：0
> 
> 时间：2012-06-09T22:23:31.247
> 
> 标签：objective-c, macos

所以我试图在我的 mac 应用程序中运行一些基本的终端命令，但由于某种原因，我无法做到。

这是我的代码：

```
NSString *commitText = [commitMessage stringValue];
NSString *a = [NSString stringWithFormat:@"cd %@", dirPath];
NSString *c = [NSString stringWithFormat:@"usr/bin/git commit -m '%@'", commitText];

NSTask *aTask = [[NSTask alloc] init];
NSMutableArray *args = [NSMutableArray array];
[args addObject:@"-c"];
[args addObject:a];
[args addObject:@"git add *"];
[args addObject:c];
[args addObject:@"git push origin HEAD"];

NSPipe *pipe;
pipe = [NSPipe pipe];
[aTask setStandardOutput: pipe];

NSFileHandle *file;
file = [pipe fileHandleForReading];

[aTask setLaunchPath:@"bin/sh"];
[aTask setArguments:args];
[aTask launch]; 
```

以下是错误：

```
2012-06-09 15:18:50.293 Auto Git[9404:403] launch path not accessible
2012-06-09 15:18:50.297 Auto Git[9404:403] (
    0   CoreFoundation                      0x00007fff870b4f56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff90e35d5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff870b4d8a +[NSException raise:format:arguments:] + 106
    3   CoreFoundation                      0x00007fff870b4d14 +[NSException raise:format:] + 116
    4   Foundation                          0x00007fff9174f1f4 -[NSConcreteTask launchWithDictionary:] + 470
    5   Auto Git                            0x0000000109e1365d -[Push push:] + 765
    6   CoreFoundation                      0x00007fff870a470d -[NSObject performSelector:withObject:] + 61
    7   AppKit                              0x00007fff8e0f8f7e -[NSApplication sendAction:to:from:] + 139
    8   AppKit                              0x00007fff8e0f8eb2 -[NSControl sendAction:to:] + 88
    9   AppKit                              0x00007fff8e0f8ddd -[NSCell _sendActionFrom:] + 137
    10  AppKit                              0x00007fff8e0f82a0 -[NSCell trackMouse:inRect:ofView:untilMouseUp:] + 2014
    11  AppKit                              0x00007fff8e177fc4 -[NSButtonCell trackMouse:inRect:ofView:untilMouseUp:] + 489
    12  AppKit                              0x00007fff8e0f6eaa -[NSControl mouseDown:] + 786
    13  AppKit                              0x00007fff8e0c2348 -[NSWindow sendEvent:] + 6306
    14  AppKit                              0x00007fff8e05ba55 -[NSApplication sendEvent:] + 5593
    15  AppKit                              0x00007fff8dff20c6 -[NSApplication run] + 555
    16  AppKit                              0x00007fff8e26e244 NSApplicationMain + 867
    17  Auto Git                            0x0000000109e12eb2 main + 34
    18  Auto Git                            0x0000000109e12e84 start + 52
    19  ???                                 0x0000000000000003 0x0 + 3
) 
```

我究竟做错了什么？请帮忙。多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:04:08.870

启动路径应该是`/usr/bin/git`并且您的阵列应该是`@[@"commit",@"-m",yourarg]`您需要为每个命令创建不同的任务。您的添加、推送需要是单独的任务。要找到 git 的路径，请在终端中运行命令`which git`这将是您的任务的路径。

```
NSTask* task = [[Task alloc] init]
//set the input output pipes
[task setLaunchPath:@"/usr/bin/git"];
NSArray* args = [NSArray arrayWithObjects:@"commit",@"-m",commitMessage];
[task setArguments:args];
//set up the notifications
[task launch]; 
```

如果您想使用 shell 脚本，我认为您需要为其提供更多格式，例如：

```
NSString* shScript = [NSString stringWithFormat:@"#!bin/sh\ngit commit -m %@\ngit add ...\ngit..." 
```

将其设置为与上面相同的数组中的唯一参数该字符串和启动路径 /bin/sh

# php - PHP 将行拆分为页面

> ID：10965012
> 
> 赞同：2
> 
> 时间：2012-06-09T22:24:59.217
> 
> 标签：php, split

目前，我有这个代码：

```
<?php

  if (isset($_GET['id'])) {
    $itemid = $_GET['id'];
    $search = "$itemid";
    $query = ucwords($search);
    $string = file_get_contents('http://example.com/tools/newitemdatabase/items.php');
    if ($itemid == "") {
      echo "Please fill out the form.";
    } else {
      $string = explode('<br>', $string);
      foreach ($string as $row) {
        preg_match('/^(.+)\s=\s(\d+)\s=\s(\D+)\s=\s(\d+)/', trim($row), $matches);
        if (preg_match("/$query/i", "$matches[1]")) {
          echo "<a href='http://example.com/tools/newitemdatabase/info.php?id=$matches[2]'>";
          echo $matches[1];
          echo "</a><br>";
        }
      }
    }
  } else {
    echo "Item does not exist!";
  }
?> 
```

我想要做的是获取该行中的所有结果并将其`echo $matches[1];`拆分为页面，每页只有 5 行。

这是当前正在发生的事情的一个示例：
[http ://clubpenguincheatsnow.com/tools/newitemdatabase/search.php?id=blue](http://clubpenguincheatsnow.com/tools/newitemdatabase/search.php?id=blue)

所以我想要做的是将这些行分成单独的页面，每页只有五行。

例如：

*   `http://example.com/tools/newitemdatabase/search.php?id=blue&page=1`
*   `http://example.com/tools/newitemdatabase/search.php?id=blue&page=2`
*   等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:45:47.793

您可以使用索引变量执行此操作，然后仅打印 5 个结果，如下所示：

```
<?php
if (isset($_GET['id'])) {
  $itemid = $_GET['id'];
  $search = "$itemid";
  $query = ucwords($search);
  $string = file_get_contents('http://clubpenguincheatsnow.com/tools/newitemdatabase/items.php');
  if ($itemid == "") {
    echo "Please fill out the form.";
  } else {
    $string = explode('<br>', $string);

    // Define how much result are going to show
    $numberToShow = 5;

    // Detect page number (from 1 to infinite)
    if (isset($_GET['page'])) {
      $page = (int) $_GET['page'];
      if ($page < 1) {
        $page = 1;
      }
    } else {
      $page = 1;
    }
    // Calculate start row.
    $startRow = ($page - 1) * $numberToShow;

    // For index use
    $i = 0;
    foreach ($string as $row) {
      preg_match('/^(.+)\s=\s(\d+)\s=\s(\D+)\s=\s(\d+)/', trim($row), $matches);
      if (preg_match("/$query/i", "$matches[1]")) {
        // If the start row is current row
        //   and this current row is not more than number to show after the start row
        if ($startRow >= $i && $i < $startRow + $numberToShow) {
          echo "<a href='http://clubpenguincheatsnow.com/tools/newitemdatabase/info.php?id=$matches[2]'>";
          echo $matches[1];
          echo "</a><br>";
        }
        // Acumulate index
        $i++;
      }
    }
  }
} else {
  echo "Item does not exist!";
}

?> 
```

# c# - C# DataGridView CheckBox 如果条件不满足不允许选择

> ID：10965016
> 
> 赞同：0
> 
> 时间：2012-06-09T22:26:07.597
> 
> 标签：c#, .net, winforms

我有一个 datagridview，其中有一列带有复选框。我想要做的是当用户单击复选框时，我需要检查其他一些条件，并且仅在条件满足其他情况下才允许选中复选框，否则会停止事件并且不允许复选框选择。

有人可以指导吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:38:13.993

嗯，这真的很简单。

您可以将事件处理程序附加到您的复选框，当事件触发时，只需检查您需要检查的所有内容，如果条件不满足，则在复选框上调用取消选中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T23:22:41.647

好的，这是我的问题的回顾，我有一个 Windows 窗体应用程序，它从数据源（文件、数据库等）加载一些信息。加载后，每一行的第一列中都有 DataGridViewCheckBoxCell 。要求是当用户单击复选框时，必须对照源检查该特定行没有被来自任何其他工作站的任何其他用户检查。我设想的我的解决方案逻辑：我想确保当用户单击单元格时，在选中复选框之前，我从数据源中检查并且不允许选中复选框或根据是否使用此行来允许它由别人或不是。

我的解决方案：我想出的是使用 CellClick 事件，因为当用户单击单元格时，该复选框尚未被选中，然后我检查数据源是否有其他用户正在使用它，如果它正在使用，我设置了 checkbox.ReadOnly=true

这样，这个事件基本上已经死了，什么也没有发生......:-) 我希望我有一个更好的方法，但这符合我的需要。

感谢每一位试图提供帮助的人。

# javascript - 当我将 SVG 转换为 Raphael JS 对象时，路径不显示

> ID：10965023
> 
> 赞同：1
> 
> 时间：2012-06-09T22:27:13.907
> 
> 标签：javascript, xml, svg, raphael

我在网上找到了我想与 Raphael 一起使用的这个 SVG 文件，所以我开始获取`d`路径的属性并将它们放入一个 JS 对象中。在代码中，我循环遍历 JS 对象并创建 Raphael 路径。当我在浏览器中打开文件时，什么都没有显示，我不知道为什么。

我认为它与SVG文件有关。在我下载的 SVG 文件中，每个组（`g`标签）都有一个`transform`属性。如果我从标记中删除该属性`g`并在浏览器中打开 SVG 文件，则该组不会显示。因此，当我只是复制路径时似乎丢失了某些东西。

我不确定如何让这些路径出现在拉斐尔身上，有什么建议吗？

资源：

*   [我的文件](http://sdrv.ms/LJ1LGR)
*   [原图](https://upload.wikimedia.org/wikipedia/commons/9/95/Continents.svg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T08:40:31.583

路径可能确实“显示”，但在您定义的视口之外。您将需要调整路径坐标以适合您的视口，例如通过应用变换（您可以[使用 raphaël](http://raphaeljs.com/reference.html#Raphael.transformPath)来做到这一点，但确保路径坐标从一开始就正确变换会更有效）。

如果您想查看路径在哪里，您可以随时增加坐标空间，例如通过[将 viewBox 设置](http://raphaeljs.com/reference.html#Paper.setViewBox)为较大的值，例如 [x,y,w,h] = [-10000,-10000,50000,50000]。这可能会使渲染看起来很小，但您应该能够快速发现丢失的路径在哪里。

# javascript - Date.js 'tt' 格式不起作用？

> ID：10965024
> 
> 赞同：1
> 
> 时间：2012-06-09T22:27:14.273
> 
> 标签：javascript, html, date, datejs

我正在使用以下 javascript 代码：

```
var d = Date.parseExact('Jun 4, 2012 12:30:00 AM','MMM d, yyyy h:mm:ss tt');
alert(d.toString('MMM d, yyyy h:mm:ss tt')); 
```

警报的结果是：

```
Jun 4, 2012 12:30:00 PM 
```

似乎 Date.js 并不真正关心我的 'tt' 格式....这是一个错误吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T18:44:24.100

不确定这是否适用于你，但[我](http://code.google.com/p/datejs/issues/detail?id=89)今天发现了这个。

事实证明，`.js`在主站点上可供下载的文件有点过时了。更新到此问题中提到的版本为我解决了类似的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:10:27.207

首先，它确实关心您是否使用 tt 格式。似乎如果您确实解析 05:30 AM，那么您会得到预期的结果，但是当您超过 12 点时，它会变为 PM。

（如果你从 PM 开始，你会得到相反的结果，然后你会得到 AM。）

在这里我有点不稳定，因为我对 AM PM 系统不太熟悉。但不是从 00:00 到 11:59 吗？

无论如何，这似乎是 Date.js 库所做的，它将您 12:30 时间的上午更改为下午。

# php - php substr 从 preg_match 函数返回字符串变量上的不正确字符

> ID：10965027
> 
> 赞同：0
> 
> 时间：2012-06-09T22:28:16.207
> 
> 标签：php

这是一个菜鸟问题，但是...

我正在另一个使用 preg_match 获取字符串的 php 文件中调用一个函数。然后我想使用 substr 来获取该字符串的特定部分，但是它不输出字符串中的任何字符。当我从函数中替换变量时`preg_match`，我得到了正确的输出。

这是基本代码：

```
$title = $stream["song1"]; // From a preg_match in an external php file
echo $title; // Correctly prints the song name, in this case "mySong"
echo substr($title, 0, 1);  // Outputs a "<" symbol (why??) 
```

如果我运行上面相同的三行，但对歌曲标题进行硬编码：

```
$title = "mySong";
echo $title; // Correctly prints the song name, in this case "mySong"
echo substr($title, 0, 1);  // Outputs a "m" symbol (correct) 
```

此外，当我检查变量的类型时`$title`，它返回“字符串”。我确定我在做一些非常愚蠢的事情......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:31:56.913

它似乎`$title`包含 html 标签，因此第一个字符将是`<`.

使用[htmlentities() 来回](http://php.net/manual/en/function.htmlentities.php)显完整的输出，然后您应该能够看到您实际要查找的字符串的哪一部分。

```
echo htmlentities($title); 
```

* * *

[或者，您可以使用strip_tags()](http://php.net/manual/en/function.strip-tags.php)简单地从字符串中删除所有 html 标签：

```
$title = strip_tags($title);
echo substr($title, 0, 1); // should work 
```

# mysql - 优化 where 子句中具有可变列数的选择查询

> ID：10965028
> 
> 赞同：0
> 
> 时间：2012-06-09T22:28:17.777
> 
> 标签：mysql, query-optimization, innodb

它是这样的：

```
 StringBuilder sb = new StringBuilder(5000);
            sb.append("SELECT user_id FROM ").append(DEF_USERS_TBL).append(" WHERE user_id='").append(phoneBook.get(0)).append('\'');

    for (int i = 1; i < phoneBook.size(); i++)
    {
        sb.append(" OR user_id='").append(phoneBook.get(i)).append('\'');
    }

    sb.append(';');

    try 
    {           
        Statement s = ...;
        rs = s.executeQuery(sb.toString());
                    ...
            } catch ( ... ) {

                    ...
            } 
```

我听说对于 MySQL 版本 > 5.0，innoDB，如果这是一个存储过程，性能明智，这将是有意义的。如果我把它变成 phonebook.size() 个人 SELECT 查询会更快吗（因此，我可以存储它）？

泰

# ruby-on-rails - 嵌套模型表单在导轨上不起作用

> ID：10965029
> 
> 赞同：0
> 
> 时间：2012-06-09T22:28:28.203
> 
> 标签：ruby-on-rails, nested-forms

我对 ruby​​ on rails 和编程都很陌生。我正在尝试开发一个应用程序，但我现在被困住了。我正在观看[http://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)制作嵌套模型表单，但我遇到了错误。我的问题详情如下；

我有雇主模型，雇主模型 has_many interviews 和 interview model has_many customquestions。我正在尝试创建一个表格，通过该表格我将收集信息以创建面试。虽然我做了所有必要的关联，但当我提交表单时，它会引发错误，说“Customquestions interview can't be blank”。我有点确定这是因为我错过了面试控制器中的一些代码。下面你可以看到我的面试控制器和我用来提交信息的表单模板。

面试控制员

```
class InterviewsController < ApplicationController
  before_filter :signed_in_employer

  def create
    @interview = current_employer.interviews.build(params[:interview])

    if @interview.save
      flash[:success] = "Interview created!"
      redirect_to @interview
    else
      render 'new'
    end
  end

  def destroy
  end

  def show
    @interview = Interview.find(params[:id])
  end

  def new
    @interview = Interview.new
      3.times do
    customquestion = @interview.customquestions.build
     end
  end
end 
```

我用来提交信息的表格：

```
<%= provide(:title, 'Create a new interview') %>
<h1>Create New Interview</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(@interview) do |f| %>
    <%= render 'shared/error_messages_interviews' %>

      <%= f.label :title, "Tıtle for Interview" %>
      <%= f.text_field :title %>

      <%= f.label :welcome_message, "Welcome Message for Candidates" %>
      <%= f.text_area :welcome_message, rows: 3 %>

      <%= f.fields_for :customquestions do |builder| %>
        <%= builder.label :content, "Question" %><br />
        <%= builder.text_area :content, :rows => 3 %>
      <% end %>
      <%= f.submit "Create Interview", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

在面试模型中，我使用`accepts_nested_attributes_for :customquestions`

面试模式

```
class Interview < ActiveRecord::Base
  attr_accessible :title, :welcome_message, :customquestions_attributes
  belongs_to :employer
  has_many :customquestions
  accepts_nested_attributes_for :customquestions

  validates :title, presence: true, length: { maximum: 150 }
  validates :welcome_message, presence: true, length: { maximum: 600 }
  validates :employer_id, presence: true
  default_scope order: 'interviews.created_at DESC'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:46:44.593

验证错误在 customquestions 模型中出现，因为（我假设）它`validates :interview_id`。问题是在保存父对象（采访）之前不会设置 interview_id，但是在保存采访之前运行自定义问题的验证。

您可以通过在 customquestions 模型中添加选项`:inverse_of=> :customquestions`来让 cusomtquestions 了解此依赖关系。`belongs_to :interview`

# gmp - GMP 舍入模式

> ID：10965030
> 
> 赞同：1
> 
> 时间：2012-06-09T22:28:38.190
> 
> 标签：gmp, arbitrary-precision

使用 GMP 进行操作时，有什么方法可以更改舍入模式？还是我必须为此使用 MPFR？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T16:27:17.047

是的，如果你想控制舍入，你应该使用 MPFR。

好消息是从 mpf_t 初始化 mpfr_t 相对简单，因此如果您不想转换所有内容，可以将它放在需要舍入控制的地方。

见：[http ://www.mpfr.org/mpfr-current/mpfr.html](http://www.mpfr.org/mpfr-current/mpfr.html)

# c++ - “！=”比较运算符比“>”快吗？

> ID：10965031
> 
> 赞同：-3
> 
> 时间：2012-06-09T22:28:47.793
> 
> 标签：c++, performance, comparison

一个非常基本的问题：

考虑一个无符号整数值，我们想检查它不等于 0。使用`!=`or `>`，在 C++ 中使用哪个更有效？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T22:33:05.877

你的应用程序太慢了吗？如果是，您应该做的第一件事是配置文件——这将向您显示导致程序运行缓慢的原因。

如果您的程序没有效率问题，那么您不必担心这一点。事实上，在这个阶段担心速度是一件坏事，因为人们经常编写可读性较差的代码来试图提高速度，而这甚至都不是问题。

# percentage - 交叉表中的多个度量 - Cognos 8

> ID：10965033
> 
> 赞同：2
> 
> 时间：2012-06-09T22:29:21.707
> 
> 标签：percentage, crosstab, cognos

是否可以在单个交叉表中添加多个度量？

我有一个交叉表，其中行代表部门，列代表性别。可以显示计数和百分比吗？

我正在从关系数据中报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T06:37:51.660

是的。您可以通过将多个度量嵌套在行或列中来将多个度量添加到交叉表中。
在您的示例中，将计数和百分比嵌套在部门行或性别列下。

下面给出了在交叉表中显示两个度量收入和数量的示例。 ![在此处输入图像描述](../Images/8d94ade31a3552d7d703f7a90c95311b.png)

结果如下所示： ![在此处输入图像描述](../Images/d0a0888c19e81a1e689ad29eb085c062.png)

有关嵌套交叉表的更多详细信息，请参阅 IBM Infocenter。 [http://publib.boulder.ibm.com/infocenter/c8bi/v8r4m0/index.jsp](http://publib.boulder.ibm.com/infocenter/c8bi/v8r4m0/index.jsp)

# android - 在 GridView 中加载多个大图像的最佳方法

> ID：10965036
> 
> 赞同：2
> 
> 时间：2012-06-09T22:30:09.057
> 
> 标签：android, image, gridview

我的问题与内存有关，我有一个 Web 服务，它为我提供了一个 URL 列表。每个 URL 对应一个大图。我的移动应用程序必须解析 Web 服务提供的 xml，然后在 GridView 中显示这些图像。我尝试了几种功能来显示图像，例如：

*   **多线程**

*   **延迟加载**

*   **使用 inSampleSize减小图像大小**（这会导致我的应用程序耗时过长）

我是否必须为每个大图像附加一个缩略图图像，并使网络服务返回给我所有缩略图的列表，然后向用户显示这些缩略图，如果他点击其中一个，我必须显示单独视图中的大图像，我有这个想法，因为我注意到当我显示一张图像时，我没有得到 outofMemory 异常！

*这是一个可靠的解决方案*吗？*有没有更好的方法*？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T22:58:23.390

欢迎来到 Android 上最困难的问题之一。首先，我将首先[阅读 google 写的关于如何处理位图的新文档](http://developer.android.com/training/displaying-bitmaps/index.html)。它不是轻读，但您可能需要通读一遍。它只上线了几个星期，所以你可能还没有看到它。它详细介绍了您提到的许多内容，例如多线程、延迟加载和下采样。他们还建议使用图像缓存。

为每个图像下载大图像然后下采样将是非常低效的。首先，下载大小比需要的大。其次，您需要将其加载到内存中以执行向下采样，并且第三次向下采样有点慢。

我会让 web api 返回一个缩略图 url 和完整图像 url 列表，当视图出现在屏幕上时，你可以延迟下载它们，并使用缓存将它们保留一段时间。确保您也对缩略图的大小进行采样。然后，当用户单击图像时，我会下载完整图像，并在它到达时在背景上对其进行采样，然后再显示它。

# php - dirname(__FILE__) VS 将全局变量设置为目录

> ID：10965037
> 
> 赞同：3
> 
> 时间：2012-06-09T22:30:34.897
> 
> 标签：php

使用它的优点和缺点是什么：

```
$globals['server_url'] = dirname(__FILE__);
$globals['mainfiles'] = dirname(__FILE__).'/main'; 
```

以及使用它的利弊：

```
$globals['server_url'] = '/srv/www/htdocs/somwhere/';
$globals['mainfiles'] = '/srv/www/htdocs/somwhere/main'; 
```

你有什么建议。

顺便说一句：这些是在 config.php 文件中设置的，该文件也被其他文件调用，以在包含文件时停止目录冲突，我们像这样使用它：

```
require_once($globals['server_url'].'/test.php'); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T22:34:30.350

[`dirname(__FILE__)`或者`__DIR__`](https://stackoverflow.com/a/2749423/604041) 更好，`'/srv/www/htdocs/somwhere/'`因为他们会在您移动或重命名文件夹的那一天继续工作，或者您迁移到另一台服务器或另一个操作系统。
便携性和灵活性是这里的关键词。

全局变量很糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:34:58.727

该`__FILE__`方法工作正常，但您需要知道文件在哪里。如果您将文件移动到另一个目录，则该值将更改并且可能会破坏任何依赖它的内容。

另一方面，硬编码路径也可以正常工作，但是如果您将文件移动到不同的目录，则需要确保它是有效的。

正确的解决方案是个人喜好。我可能会采用这种`__FILE__`方法（特别是如果这是您将分发给其他服务器/用户的代码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T23:04:22.707

通常，`$_SERVER`超全局是您需要的，尤其是`$_SERVER['DOCUMENT_ROOT']`. 文档[在这里](http://www.php.net/manual/en/reserved.variables.server.php)。

但是，如果您的应用程序完全位于 的单独子树中`DOCUMENT_ROOT`，则可以更改`include_path`，例如，像这样（但您可能希望使用 的某些父目录或子目录`__DIR__`）：

```
ini_set('include_path', __DIR__); 
```

如果你也想保留默认值`include_path`，它变成这样：

```
ini_set('include_path', ini_get('include_path').';'.__DIR__); 
```

一旦你设置了你的`include_path`，你的例子就变得简单了

```
require_once('test.php'); 
```

当然，在您的应用程序中对绝对路径进行硬编码会使将其全部或部分移动到同一服务器或另一台服务器上变得困难且容易出错。

# php - PHP 数组复选框和单选默认值

> ID：10965038
> 
> 赞同：1
> 
> 时间：2012-06-09T22:30:38.983
> 
> 标签：php, wordpress, checkbox, radio

我的 wordpress 选项页面中有以下代码。我无法定义复选框和单选的默认值。

```
array(
    "name" => "Post Thumbnails",
    "desc" => "Choose if you want to display <strong>post thumbnails</strong> or not.",
    "id" => $shortname."_post_thumbs",
    "type" => "checkbox",
    "std" => "checked"      
),  

array(
        "name" => "Example",
        "desc" => " The Descriptions",
        "id" => $shortname."_case_thumb",
        "type" => "radio",
        "options" => array("nothumb" => " Display nothing", "defthumb" => " Display thumbnail"),
        "std" => "nothumb"      
    ), 
```

对于复选框也尝试过`"std" => "true"`并且`"std" => " "`......但没有奏效。谢谢！

# uitableview - 如何相同地更改 UITableView 单元格高度并显示详细的文本标签？

> ID：10965040
> 
> 赞同：0
> 
> 时间：2012-06-09T22:30:46.793
> 
> 标签：uitableview, height, cell, detailtextlabel

嗨，我这里有这段代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    jsonURL = [NSURL URLWithString:@"http://oo.mu/json2.php"];
    jsonData = [[NSString alloc] initWithContentsOfURL:jsonURL usedEncoding:nil error:nil];
    self.jsonArray = [jsonData JSONValue];

    // Do any additional setup after loading the view, typically from a nib.
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [jsonArray count];
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return [indexPath row] * 20;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = [[self.jsonArray objectAtIndex:indexPath.row] objectForKey:@"Name"];

    return cell;
} 
```

我想要的是：

1.  要更改单元格的高度，`UITableView`以便我可以在`textLabel`. （目前，当我使用前面的代码增加单元格的高度时`UITableView`，每个单元格从大到小，大小不同）。

2.  显示在它下面`textLabel.text`的`detailedTextLabel`其他东西的下面。

我该怎么做？

我试过了：

```
cell.textLabel.text = [[self.jsonArray objectAtIndex:indexPath.row] objectForKey:@"Name"];
cell.detailTextLabel.text = [[self.jsonArray objectAtIndex:indexPath.row] objectForKey:@"Street"];
cell.detailTextLabel.text = [[self.jsonArray objectAtIndex:indexPath.row] objectForKey:@"City"]; 
```

但它没有出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T07:36:48.597

您可以根据您的要求创建具有尺寸的新 UItableview 单元格。之后

```
-(Uitableview) cellForIndexPath {
    //add the customized Uitableviewcell.
} 
```

通过这种方式，您可以根据您的要求创建表格视图单元格。我希望它会有所帮助。

# php - 有没有办法访问像 我可以使用 DOMXPath 来做，但我想只用 DOMDocument 来做。 我尝试了类似的东西 $dom->getElementsByTagName('yweather:condition') //or $dom->getElementsByTagNameNS('yweat 问问题 问问题 2012-06-09T22:30:57.247 137 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我可以使用 DOMXPath 来做，但我想只用 DOMDocument 来做。 我尝试了类似的东西 $dom->getElementsByTagName('yweather:condition') //or $dom->getElementsByTagNameNS('yweather','condition') 但都没有奏效。 有人知道怎么做吗？或者我需要使用 DOMXPath？ 您可以使用.parentsUntil()并以这种方式计算组合位置： var x=0; var y=0; $('#target').add($('#target').parentsUntil($('#a').parent())).each(function(){ x+=$(this).position().left; y+=$(this).position().top; }); alert(x+':'+y); http://jsfiddle.net/rDzpy/ phpdomdocument 4 2 回答 2 This answer is useful 0 您需要完整的命名空间，而不是本地名称 yweather。 getElementsByTagNameNS('fullname_space', 'condition') 于 2012-06-09T22:43:24.017 回答 This answer is useful 0 foreach ($dom->getElementsByTagNameNS('http://www.w3.org/2001/XInclude', 'condition') as $element) { echo 'local name: ', $element->localName, ', prefix: ', $element->prefix, "\n"; } http://www.w3.org/2001/XInclude将是您附加命名空间的 url 。 于 2012-06-09T22:47:19.207 回答 Related 0 c# - 如何写入多个跟踪源 4 php - 多页的 TCPDF 和 FPDI 3 sql - 获取记录关系 1---N 可以为空并在子表上过滤 1 webview - Android WebView 中的“tel:”功能不适用于 HTC Desire S (Android 4.0.4) 1 windows - 是否可以添加带有递归标志的 git 子模块？ 2 c++ - 子类访问彼此的成员函数 1 c# - 如何从服务层返回多个模型？ 1 python - HtmlUnit硒python Errno 111 1 active-directory - AD ERROR 喜欢：错误代码[80070005] MSG[访问被拒绝。] 4 xaml - 转换器无法将“Windows.Foundation.String”类型的值转换为“ImageSource”类型 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10965042
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, domdocument

我可以使用 DOMXPath 来做，但我想只用 DOMDocument 来做。

我尝试了类似的东西

```
$dom->getElementsByTagName('yweather:condition')
//or
$dom->getElementsByTagNameNS('yweather','condition') 
```

但都没有奏效。

有人知道怎么做吗？或者我需要使用 DOMXPath？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:43:24.017

您需要完整的命名空间，而不是本地名称 yweather。

```
getElementsByTagNameNS('fullname_space', 'condition') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:47:19.207

```
foreach ($dom->getElementsByTagNameNS('http://www.w3.org/2001/XInclude', 'condition') as $element) {
    echo 'local name: ', $element->localName, ', prefix: ', $element->prefix, "\n";
} 
```

http://www.w3.org/2001/XInclude将是您附加命名空间的 url [。](http://www.w3.org/2001/XInclude)

# c++ - 当控制台处于 UTF-8 模式时，popen() 中的文本会过早地被删除

> ID：10965046
> 
> 赞同：1
> 
> 时间：2012-06-09T22:31:33.097
> 
> 标签：c++, windows, console, popen

```
#include <sstream>
#include <iostream>
#include <stdio.h>
#include <string.h>
#include <windows.h>

using namespace std;
int main() {
  SetConsoleOutputCP(CP_UTF8);
  wstringstream wss;
  wchar_t buff[256];
  FILE *in;
  if(!(in = _wpopen(L"dir %windir%", L"r"))) { return 1; }
  while(!feof(in)) {
    if (fgetws(buff, sizeof(buff), in)!=NULL){
      wss << buff;
    }
  }
  pclose(in);
  wstring wstr;
  wstr = wss.str();
  wcout << wstr.c_str();
} 
```

效果如下：

```
[...]

2011-04-10  14:11    <DIR>          .
2011-04-10  14:11    <DIR>          ..
2011-04-10  14:11    <DIR>          system32
2011-04-10  14:11    <DIR>          system
2011-04-10  14:11    <DIR>          repair
2011-04-10  14:11    <DIR>          Help
2011-04-10  14:11    <DIR>          Config
2011-04-10  14:11    <DIR>          Cursors
2011-04-10  14:11    <DIR>          Media
2011-04-10  14:11    <DIR>          java
2011-04-10  14:11    <DIR>          Web
2011-04-10  14:11    <DIR>          addins
2012-06-09  11:29             2 
```

似乎文件结尾字符以某种方式在字符串中传递或什么......我不知道。但是，如果我将编码改回一个字节，一切正常..

也许我忘了在这里将某些功能更改为多字节替代方案？

# regex - Rails 3 使用正则表达式提取链接的域并将其打印在括号中，

> ID：10965047
> 
> 赞同：0
> 
> 时间：2012-06-09T22:31:36.160
> 
> 标签：regex, ruby-on-rails-3

`Rails -v 3.2.3`

我正在使用一个应该显示提交链接的描述和 url 的应用程序，我正在使用正则表达式运算符，这也是我很新的东西。这是我的意见代码：

`(<%= if link.url =~ /(:\/\/) ([^\/]*)/ then $2 else "wrong URL" end %>)`

但是，对于我提交的每个链接，网址始终是`wrong URL`....这是因为 $2 是错误的正则表达式运算符吗？还是`/(:\/\/) ([^\/]*)/`Rails 3 中的部分不正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:10:17.997

杀死中间的那个空间！您显示的正则表达式需要在`://`和`sub.domain.tld`块之间有一个空格；因为没有 URL 有这个，正则表达式不会匹配任何东西。最简单的改变应该是：

```
/(:\/\/)([^\/]*)/ 
```

或者，再清理一下（你不需要第一对括号）：

```
(<%= if link.url =~ /:\/\/([^\/]*)/ then $1 else "wrong URL" end %>) 
```

希望有帮助！

# algorithm - 在在线国际象棋游戏中，如何将延迟对时间控制的影响降到最低？

> ID：10965051
> 
> 赞同：2
> 
> 时间：2012-06-09T22:32:03.950
> 
> 标签：algorithm, language-agnostic, time, chess

我正计划编写一个小型网络应用程序，两个玩家可以在其中玩带有闪电战时间控制的国际象棋游戏。以下是对移动过程如何工作的简短描述：

1.  玩家 A 考虑采取什么行动
2.  玩家 A 向我的服务器发送移动
3.  我的服务器处理请求
4.  我的服务器向推送服务器发送响应
5.  推送服务器处理请求
6.  推送服务器向玩家 B 发送响应
7.  玩家 B 考虑采取什么行动

有意义的是，步骤 1 将在玩家 A 的分配时间运行，而步骤 7 将在玩家 B 的分配时间运行。我可以对其他步骤做些什么？有什么方法可以测量其他步骤花费了多少时间，并可能将结果添加到两个玩家的时钟中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T00:39:48.743

如果不信任客户，这是无法做到的。

基本问题是具有低延迟的客户端可以假装具有高延迟以获得奖励时间。具有 100 毫秒往返延迟的客户端可能会假装拥有 3 秒的 RTT，并使用这种欺骗手段将 6.9 秒的移动变为 4 秒的移动。协议没有实用的方法来检测假装具有高延迟的客户端，除非客户端犯了错误（例如，当他们采取 1 秒的动作时要求 3 秒的延迟豁免）。

另一方面，如果您确实信任客户，您可以通过定期 ping 他们的机器并从他们的移动时间中扣除该时间来估计他们的 RTT。如果您*真的*信任客户，请让他们测量并报告移动数据的经过时间。

有很多方法可以管理这种信任/延迟惩罚权衡。您可以假设最小 RTT（50 毫秒？）并从所有内容中扣除。您可以将奖励时间放在时钟上。您可以选择面向用户的游戏是“安全”还是“宽容”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T17:40:35.487

我最终选择了 Thomas CG de Vilhena 的想法。总而言之： - 每个玩家的时间是从他被告知他必须比赛开始到他将移动发送到服务器时结束 - 当玩家被告知对手的移动时，调整对手的剩余时间- 为防止用户作弊，发送移动的 javascript 将被混淆，服务器响应将被加密 - 时间校正例程是必要的，以防玩家超过分配的时间 - （可选）每个玩家都可以使用一种机制来检测任何（不太可能的）作弊尝试，导致日志记录有望允许仲裁者决定作弊发生在哪一方

这确保了玩家会看到服务器尊重他的思考时间，并且没有玩家会遭受延迟。

# c++ - C++ 的内存分配限制

> ID：10965053
> 
> 赞同：0
> 
> 时间：2012-06-09T22:32:22.193
> 
> 标签：c++, memory-management

我想运行这个使用高达 8.3 GB 内存的巨大 C++ 项目。我可以在某些情况下运行这个程序还是不可能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T22:33:46.770

没关系。您只需要使用 64 位架构，并确保有足够的交换空间 + 可用的物理内存

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T22:40:23.547

这真的取决于。如果程序需要始终拥有所有 8.3 GB 内存（[工作大小](http://en.wikipedia.org/wiki/Working_set_size)），您可能需要在计算机中安装类似数量的内存。

现在假设您有 4 GB 的 RAM。[在这种情况下，由于使用交换](http://en.wikipedia.org/wiki/Virtual_memory)（为了扩大虚拟内存大小而交换内存和交换内存的硬盘区域），您很可能能够执行程序。但是，即使它实际上可以工作，它也可能因为垃圾而运行得非常慢（直到不能真正使用的程度[）](http://en.wikipedia.org/wiki/Thrashing_%28computer_science%29)。

另一方面，如果您的程序处理 8.3 GB 的数据，但它是在较小的*块*中处理的，这将意味着所有数据都不会一直在内存中。然后，您将不需要在计算机中安装如此大量的 RAM。

~~正如 Oli Charlesworth 所提到的，如果您想在系统中安装超过 4 GB 的 RAM，~~您将需要一个 64 位系统（硬件和操作系统）~~，或者至少需要一个具有[PAE](http://en.wikipedia.org/wiki/Physical_Address_Extension)~~功能的系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T22:44:51.577

对的，这是可能的。您需要在 64 位环境中，当然还有可用的 RAM。您可能仍然无法一次分配超过 4gb 的连续地址空间。不过，您可能必须将其分配为较小的块。

# ruby-on-rails - 选择订购 Rails 记录，或先显示“ALL”

> ID：10965054
> 
> 赞同：1
> 
> 时间：2012-06-09T22:32:23.497
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms

我正在寻找一种方法来选择 grouped_collection_select 的第一条记录，或者在第一选择中显示“ALL”。

```
<%= f.collection_select :marque_id, Marque.all, :id, :name_upper, :include_blank => 'ALL', :prompt => 'Mark' %>         
     <%= f.grouped_collection_select :modele_id, Marque.all, :modeles, :name_upper, :id, :name_upper, :prompt => 'Model', :include_blank => 'ALL' %> 
```

" :include_blank => 'ALL' " 对 collection_select 工作正常，但对 grouped_collection_select 不工作。

对于 grouped_collection_select，它只在第一个位置显示一个空白字段。

我试图在数据库中放置一条空白记录，或者将“ALL”放入数据库中，其中包含很多符号，例如：“# ALL #”......不适用于数字（147、156、159 [.. 。]， ＃ 全部 ＃，...）

编辑：

或者也许我可以在每个子类别中添加一个字段，并定义“第一”？但我想保持一切按“名称 ASC”排序。

我已经放了

```
 default_scope order('name ASC') 
```

在我的 Modeler.rb

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T22:59:28.110

我找到了如何做我想做的事。

我只需要添加

```
$('#search_modele_id').preprend('<option value="" selected="selected">ALL</option>'); 
```

到我的 jQuery 代码中，并将值设置为“BLANK”（在我的情况下非常重要）。

并放

```
:include_blank => true 
```

代替

```
:include_blank => 'ALL' 
```

在搜索表单中

问题解决了。

不管怎么说，还是要谢谢你！

# c# - Image.Source (with binding) 在移除绑定后阻止图像文件

> ID：10965055
> 
> 赞同：0
> 
> 时间：2012-06-09T22:32:45.427
> 
> 标签：c#, windows-runtime, windows-store-apps, winrt-xaml

在 a`GridView`中，我对项目进行了模板化，因此该模板内的 Image 控件使用绑定（也尝试使用 BitmapImage）接收 Uri 以显示图片文件。它有效，但我无法删除这些文件，因为这些文件已被阻止。即使我清除了馈送的集合`GridView.ItemsSource`，即使我调用`GC.Collect()`，它们仍然被阻止。

感谢 Philip 的工作建议......当我使用 Converter 将 BitmapImage 提供给每个 Image 控件时，发现必须做一些特殊的事情才能使其工作，这里供将来参考：

```
InMemoryRandomAccessStream Ras = new InMemoryRandomAccessStream();
var archivo = CartoonsDownloader.FolderImagenes.GetFileAsync(TheFileName);

var fileStream = CartoonsDownloader.FolderImagenes.OpenStreamForReadAsync(TheFileName);
fileStream.Result.CopyTo(Ras.AsStreamForWrite());

BitmapImage MapaDeBits = new BitmapImage();
// Even it's RANDOM, I have to manually "Seek" it at 0.
Ras.Seek(0);
MapaDeBits.SetSource(Ras);
MapaDeBits.CreateOptions = BitmapCreateOptions.IgnoreImageCache;
return MapaDeBits; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T15:16:21.080

这可能是 XAML 堆栈中的错误（因此您可以在 MSDN[论坛](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/threads)上报告它），或者只是其缓存图像性质的副作用。作为替代方案 - 您可以自己打开文件并使用[SetSource](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.bitmapsource.setsource.aspx)方法设置图像。那么您应该可以更好地控制文件访问。

# perl - MongoDB 不同的值

> ID：10965058
> 
> 赞同：3
> 
> 时间：2012-06-09T22:33:06.940
> 
> 标签：perl, mongodb

我正在使用此代码将特定文本查找到数据库中，然后我将使用 mojolicious 加载到页面中。这种方法好还是快？

```
use MongoDB;
    use Data::Dump q(dump);
        my $connection = MongoDB::Connection->new(host => 'localhost', port => 27017);
        my $database   = $connection->test;
    my $col = $database->user;

    my $r3 = $database->run_command([
        "distinct" => "person",
        "key"      => "text",
        "query"    =>""
    ]);

    for my $d ( @{ $r3->{values} } ) {
    if ($d=~ /value/){
        print "D: $d\n";
    }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T09:12:55.623

`distinct`command 当然可以工作（而且似乎确实可以），所以很好。这也可能是最快的方法（实现只是打开适当的索引，从中读取并填充哈希表，IIRC）。

但是请注意，如果不同值的总大小大于 BSON 大小限制（当前为 16MB），它将失败并出现错误。

如果您遇到这种情况，您将不得不求助于较慢的替代方案。以 MapReduce 为例。

# mysql - 如何在 Wordpress 中进行分组？

> ID：10965060
> 
> 赞同：0
> 
> 时间：2012-06-09T22:33:31.953
> 
> 标签：mysql, wordpress, group-by, custom-fields

我有一个司机职位类型，其关系称为团队。我想按团队对驱动程序进行分组，以便我可以将它们一起输出到他们的分组“团队”中。希望这是有道理的。我不太了解我尝试过的文档，但似乎缺少细节。这就是我目前所拥有的：

```
<?php 
  $type = 'drivers';
  $args=array(
    'post_type' => $type,
    'post_status' => 'publish',
    'paged' => $paged,
    'posts_per_page' => 12,
    'ignore_sticky_posts'=> 0,
  );

$loop = new WP_Query( $args );

while ( $loop->have_posts() ) : $loop->the_post();

  get_template_part( 'team-driver' );
endwhile;
?> 
```

这是我的帖子类型。 ![注意团队关系](../Images/82ff71ce0edcd14a0c4c4f8d200ca235.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:52:55.153

你可以试试这个

```
<?php
// get all the categories
$cats = get_categories(); 
// loop through the categries
foreach ($cats as $cat)
{
    // Get the cateogory ID
    $cat_id= $cat->term_id;
    //Header for the cateogry
    echo "<h2>".$cat->name."</h2>";
    // Make a custom wordpress query
    query_posts("cat=$cat_id&post_per_page=12");
    // start wordpress loop
    if (have_posts()) : while (have_posts()) : the_post(); 
?>
    <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
<?php 
    echo '<hr/>'; 
    endwhile;
    endif; // End of WordPress loop
} // End of foreach loop through category
?> 
```

如果您只想获得一个类别（驱动程序），那么

```
<?php
$cat_name = 'drivers';
$term = get_term_by('name', $cat_name, 'category');
$cat_id=$term->term_id;
query_posts("cat=$cat_id&post_per_page=12");
// start wordpress loop
if (have_posts()) : while (have_posts()) : the_post(); 
?>
    <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
<?php 
   echo '<hr/>'; 
   endwhile;
   endif;   
?> 
```

可能这个可以帮助你

```
<?php
$cat_names = array('team1', 'team2', 'team3');
foreach($cat_names as $cat)
{
    $term = get_term_by('name', $cat, 'category');
    $cat_id=$term->term_id;
    query_posts("cat=$cat_id&post_per_page=12");
    // start wordpress loop
    if (have_posts()) : while (have_posts()) : the_post(); 
?>
    <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
<?php 
    echo '<hr/>'; 
    endwhile;
    endif;  
}   
?> 
```

# maven - Maven 项目上传到 Google 代码“下载”选项卡

> ID：10965064
> 
> 赞同：2
> 
> 时间：2012-06-09T22:33:49.870
> 
> 标签：maven, google-code

**注意：我不是在问如何将 Google Code 的 SVN 存储库用作 Maven 存储库 :-)**

我正在寻找最简单/最可靠的方法来自动将 Maven 项目的构建工件上传到 Google 代码“下载”选项卡。

我发现了 4 个声称可以执行此操作的不同 Google Code Maven 插件，但如果有任何关于将它们评估为适合用途的建议，我将不胜感激，因为它们似乎都处于各种不活动状态。

1.  [maven-googlecode-plugin](http://code.google.com/p/maven-googlecode-plugin)（最后一次提交：2009 年 9 月。最新版本：0.0.1-SNAPSHOT）
2.  [gcupload-maven-plugin](http://code.google.com/p/gcupload-maven-plugin)（最后一次提交：2009 年 1 月。最新版本：0.9）
3.  [maven-gcu-plugin](http://code.google.com/p/maven-gcu-plugin)（最后一次提交：2010 年 10 月。最新版本：1.1）
4.  [maven-googlecode](http://code.google.com/p/maven-googlecode)（上次提交：2008 年 2 月。最新版本：2.0，但标记为“测试”）

除了这些“活动水平”线索之外，其中一些在“下载”选项卡上提供了他们的发布，从“吃你自己的狗粮”的角度来看，这可能是一个好兆头；但由于这些应该是 Maven 插件，因此在 Maven Central 中提供它们可能会激发更多信心。

有谁愿意发表评论（甚至可能是这些项目的所有者/提交者）？

谢谢！

* * *

**更新：**

我已经依次测试了其中的每一个，但无法让它们中的任何一个像宣传的那样工作。

其中两个仍配置为上传到以 /files 结尾的 Google 代码 URL，而另一个声称可以工作并报告成功，但工件没有出现在“下载”选项卡中。最后一个似乎没有可以作为 Maven 插件引用的已发布代码。

从那以后，我给每个项目提交者发了电子邮件，看看可以做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T04:27:27.600

如果您不反对超越 maven 插件，谷歌代码有一个[SciptedUploads](http://code.google.com/p/support/wiki/ScriptedUploads)文档，它似乎提供了一个 python 脚本和一个 ant 任务来执行此操作。

您可能希望自下而上地阅读评论，以了解使用它们的挑战（如果有）。

我通过单击我的谷歌代码项目的“创建新下载”链接并单击“提示”进入此页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T09:36:15.160

我一直想知道为什么 google 默认不为每个项目提供一个 Maven 存储库。

进一步挖掘，我发现了以下不推荐使用的项目：

*   [http://code.google.com/p/google-maven-repository/](http://code.google.com/p/google-maven-repository/)

似乎[建议](http://code.google.com/p/google-maven-repository/wiki/WhereIsMyFavoriteGoogleProject)是向 Maven Central 发布版本。这很有意义，因为它确实简化了您的项目与其他开源项目的发现和集成。

这种转向 Maven Central 的趋势在 Java 项目中是一个受欢迎且不断增长的趋势。[Oracle](http://www.sonatype.com/people/2011/08/java-net-moves-to-central/)、 [Spring](http://blog.springsource.org/2009/12/02/obtaining-spring-3-artifacts-with-maven/)和[JBoss](http://www.sonatype.com/people/2011/09/8942/)等大型项目现在正在那里发布它们的版本。

# javascript - 如何确定 jQuery 对象是否被延迟？

> ID：10965065
> 
> 赞同：49
> 
> 时间：2012-06-09T22:33:59.430
> 
> 标签：javascript, jquery, jquery-deferred

如果我有一个有时返回延迟对象但有时返回非延迟对象的函数。我怎么知道它是哪一个？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-28T14:03:09.300

根据您的用例，您还可以使用`jQuery.when`[1]：

> 如果传递给单个参数`jQuery.when`并且它不是 Deferred，它将被视为已解决的 Deferred，并且任何附加的 doneCallbacks 都将立即执行。

有了`jQuery.when`您，您可以始终将您的神秘对象视为延迟：

```
// x could be a deferred object or an immediate result
var x = getMysteriousObject();
// success will be called when x is a deferred object and has been resolved
// or when x is an immediate result
jQuery.when( x ).then( success, error ); 
```

[1] [http://api.jquery.com/jQuery.when/](http://api.jquery.com/jQuery.when/)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-06-09T22:57:18.383

由于 jQuery Deferred 是通过复制隐藏对象的方法而不是在函数上调用 new 运算符来创建的，因此您无法证明该对象确实是 jQuery.Deferred 的实例。我认为您需要使用 Duck-Typing：

> “当我看到一只像鸭子一样走路，像鸭子一样游泳，像鸭子一样嘎嘎叫的鸟时，我称那只鸟为鸭子。” ——詹姆斯·惠特科姆·莱利

根据可能返回的对象（必须预期哪些属性），检查是否存在特定的属性/方法：

```
var x = getMysteriousObject();
if (x.promise) {
    // Deferred
} else {
    // Not a deferred
} 
```

如果需要，您可以详细说明此检查：

```
if ($.isFunction(x.promise)) {
    // Deferred
} 
```

或（以区分 Deferred 对象和 Promise 接口的其他实现）

```
if (x.promise && x.resolve) {
    // Deferred
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-10T16:11:47.383

受[Niko 的回答启发，我创建了另一个实现，该实现将根据对象属性的名称以及这些属性](https://stackoverflow.com/a/10965183/315493)**的**内容来检查对象是否为延迟对象。我必须这样做，因为我的另一个对象有一个名为 promise 的属性。

```
if (typeof value.resolve !== "function") {
  return false;
}
return String(value.resolve) === String($.Deferred().resolve); 
```

# jquery - 悬停时的动画圆形条

> ID：10965068
> 
> 赞同：0
> 
> 时间：2012-06-09T22:34:16.357
> 
> 标签：jquery, css, jquery-animate, geometry

我正在建立一个投资组合网站，并希望实现一个技能集页面，其中包含一个动画圆形条，代表我的每项技能。当用户将鼠标悬停在圆圈周围时，将有 6 个按钮，当一个按钮悬停时，我想要一个圆形条逆时针设置动画。

我在 Photoshop 中制作了一个快速的 .gif 来演示但我找不到任何教程来帮助。

我发现这个网站在顶部左侧有一个类似的概念，一个动画饼图 -[网站示例](http://www.beautifulexplorer.com/main.html?skip=1)

这是一个快速的 .gif 模型，我在 Photoshop 中完成了我想要实现的目标 -[动画圆条动画](http://imageshack.us/photo/my-images/838/33996415.gif/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:51:26.120

您链接到的网站使用 HTML5 元素制作动画，该元素[在现代浏览器](https://developer.mozilla.org/en/HTML/Element/canvas#Browser_compatibility)`canvas`中有很好的支持。

[你可以在 MDN](https://developer.mozilla.org/en/HTML/Canvas)上找到很好的文档和一个很好的[教程](https://developer.mozilla.org/en/Canvas_tutorial)。

另一种选择可能是[Raphaël](http://raphaeljs.com/)，它甚至支持较旧的浏览器，并且使用起来可能更简单。看看[这个例子](http://raphaeljs.com/polar-clock.html)。

# java - 如何在 NDK 中修改 Android 位图以便在 Java 端使用它？

> ID：10965074
> 
> 赞同：4
> 
> 时间：2012-06-09T22:34:52.750
> 
> 标签：java, android, c++, bitmap, java-native-interface

我通过 JNI 调用 C++ 函数并传递一个 RGBA_8888 位图，锁定它，更改值，解锁它，返回，然后使用以下 C++ 代码在 Java 中显示它：

```
AndroidBitmap_getInfo(env, map, &info) < 0);
AndroidBitmap_lockPixels(env, map, (void**)&pixel);

for(i=info.width*info.height-1;i>=0;i--)
{   pixel[i] = 0xf1f1f1f1;
}

AndroidBitmap_unlockPixels(env, map); 
```

我遇到的问题是位图看起来不像我预期的那样，当我在 Java 中检查它们时，像素值（使用 getPixel 验证）与我在 C++ 中设置的不同。当我将位图值设置为 0xffffffff 时，我在 Java 中得到了正确的值，但对于其他许多我没有。例如 0xf1f1f1f1 变成 0xF1FFFFFF。

我该怎么做才能让它工作？

PS：我使用的是安卓 2.3.4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T00:04:38.870

看来问题是由于预乘的阿尔法。

进一步的测试表明 r,g,b 值被 alpha 缩放，所以如果我将位图传递给 jni，我需要将 r,g,b 值乘以 255，然后除以 alpha 以获得我的真实值可以做阿尔法操作。当我把它们传回去时，我必须做相反的事情。

仅用于不需要 alpha 的复制和操作，因为 alpha 将是 255 以获得最大不透明度，而 * 255 / 255 会自行否定。

# c++ - 我可以将编译时字符串比较与 MPL 模板混合使用吗？

> ID：10965079
> 
> 赞同：3
> 
> 时间：2012-06-09T22:36:03.593
> 
> 标签：c++, boost, boost-mpl

我使用 constexpr 和 C++11（http://stackoverflow.com/questions/5721813/compile-time-assert-for-string-equality）从另一个线程得到了这个编译时字符串比较。它适用于像“OK”这样的常量字符串

```
 constexpr bool isequal(char const *one, char const *two) {
        return (*one && *two) ? (*one == *two && isequal(one + 1, two + 1))
        : (!*one && !*two);
    } 
```

我正在尝试在以下情况下使用它：

```
 static_assert(isequal(boost::mpl::c_str<boost::mpl::string<'ak'>>::value, "ak"), "should not fail"); 
```

但它给了我一个 static_assert 表达式的编译错误不是一个常量整数表达式。

我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:38:39.027

问题是`value`成员`mpl::c_str`没有被标记为`constexpr`。`constexpr`除非您愿意修改您的 Boost 代码（或创建您自己的`c_str`. 如果你决定这样做，修改非常简单：你只需要找到`BOOST_ROOT/boost/mpl/string.hpp`并替换它

```
template<typename Sequence>
struct c_str
{
    ...
    static typename Sequence::value_type const value[BOOST_MPL_LIMIT_STRING_SIZE+1] 
};

template<typename Sequence>
typename Sequence::value_type const c_str<Sequence>::value[BOOST_MPL_LIMIT_STRING_SIZE+1] =
{
    #define M0(z, n, data)                                                                      \
    mpl::aux_::deref_unless<BOOST_PP_CAT(i, n), iend>::type::value,
    BOOST_PP_REPEAT(BOOST_MPL_LIMIT_STRING_SIZE, M0, ~)
    #undef M0
    '\0'
}; 
```

这样

```
template<typename Sequence>
struct c_str
{
    ...
    static constexpr typename Sequence::value_type value[BOOST_MPL_LIMIT_STRING_SIZE+1] =
    {
        #define M0(z, n, data)                                                                      \
        mpl::aux_::deref_unless<BOOST_PP_CAT(i, n), iend>::type::value,
        BOOST_PP_REPEAT(BOOST_MPL_LIMIT_STRING_SIZE, M0, ~)
        #undef M0
        '\0'
    };
};

// definition still needed
template<typename Sequence>
constexpr typename Sequence::value_type c_str<Sequence>::value[BOOST_MPL_LIMIT_STRING_SIZE+1]; 
```

* * *

嗯，再挖一点，发现问题比我想象的要复杂。其实constexpr中可以使用静态常量；真正的问题是它`c_str<T>::value`是一个数组，而您的函数将指针作为参数。因此，编译器需要衰减数组，这归结为*获取其第一个元素的地址*。由于地址是一个运行时概念，因此不可能在 constexpr 中获取对象的地址。

为了解决这个问题，我尝试编写第二个版本`isequal`，它对数组而不是指针进行操作：

```
template <int N, int M>
constexpr bool isequal(char const (&one)[N], char const (&two)[M], int index)
{
    return (one[index] && two[index]) ?
        (one[index] == two[index] && isequal(one, two, index + 1)) :
        (!one[index] && !two[index]);
}

template <int N, int M>
constexpr bool isequal(char const (&one)[N], char const (&two)[M])
{
    // note: we can't check whether N == M since the size of the array
    // can be greater than the actual size of the null-terminated string
    return isequal(one, two, 0);
}

constexpr char hello[] = "hello";
static_assert(isequal(hello, hello), "hello == hello");
constexpr char zello[] = "zello";
static_assert(!isequal(hello, zello), "hello != zello");
constexpr char hel[] = "hel";
static_assert(!isequal(hello, hel), "hello != hel"); 
```

不幸的是，此代码不适用于`mpl::c_str`; 实际上，问题在于静态 const 数组不是编译时值，这与整数常量不同。所以我们回到开头：除非`value`被标记为`constexpr`，否则无法在常量表达式中使用它。

至于为什么我最初给出的代码失败了，我现在无法回答，因为我的 gcc (4.6) 版本[无法完全编译它](https://stackoverflow.com/questions/9900242/error-with-constexprgcc-error-a-brace-enclosed-initializer-is-not-allowed-h)......

更新 gcc 后，事实证明`value`需要在类外部定义，即使它是在类中声明和初始化的（参见[这个问题](https://stackoverflow.com/q/8016780/20984)）。我用更正编辑了上面的代码。

# c# - 我应该为我的服务响应使用响应代码、异常还是文本消息？

> ID：10965080
> 
> 赞同：2
> 
> 时间：2012-06-09T22:36:03.510
> 
> 标签：c#, asp.net, .net, wcf, soa

我正在.Net 中构建一个基于 WCF 的服务应用程序。我目前正在设计合同。

我应该在我的服务响应中使用响应代码、异常或文本消息来报告服务结果状态吗？

它们将被 Web 应用程序和其他系统使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T22:43:56.123

你应该看看 FaultContracts。请参阅[http://msdn.microsoft.com/en-us/library/system.servicemodel.faultcontractattribute.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.faultcontractattribute.aspx)

您的故障合同可以包含用于客户端处理的（基于字符串的）错误代码，和/或用于向用户显示的文本消息。

如果您的服务，或者更确切地说是您作为服务设计者，不知道（未来）客户端应用程序想要对错误消息（显示或处理）做什么，请同时包含两者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:08:40.660

在我看来，最好的方法是使用对客户有意义的响应枚举（代码）。除此之外，返回消息可能会增加 WCF 服务上的数据负载。

例如

```
throw new FaultException<InvalidArgumentException>(new InvalidArgumentException(),Constants.MaxLengthFields.PhoneNumber)), Response.OrderIdMissing);

[DataContract, Serializable]
enum Response
{
 [EnumMember]
 OrderIdMissing,
 [EnumMember]
 ProductCodeInvalid,
} 
```

网上有几篇文章可供参考。请通过他们了解更具体的信息。

[http://blogs.msdn.com/b/brajens/archive/2007/04/23/exception-handling-in-wcf-web-service.aspx](http://blogs.msdn.com/b/brajens/archive/2007/04/23/exception-handling-in-wcf-web-service.aspx)

[http://blogit.create.pt/blogs/marcosilva/archive/2008/05/18/Developing-a-WCF-Service-%5F2D00%5F-Fault-Exceptions-AND-FAULT-Contracts.aspx](http://blogit.create.pt/blogs/marcosilva/archive/2008/05/18/Developing-a-WCF-Service-%5F2D00%5F-Fault-Exceptions-AND-FAULT-Contracts.aspx)

[http://blogs.msdn.com/b/brajens/archive/2007/04/23/exception-handling-in-wcf-web-service.aspx](http://blogs.msdn.com/b/brajens/archive/2007/04/23/exception-handling-in-wcf-web-service.aspx)

# objective-c - iOS iPad UIActionSheet 问题

> ID：10965084
> 
> 赞同：1
> 
> 时间：2012-06-09T22:36:35.163
> 
> 标签：objective-c, ios, uipopovercontroller, uiactionsheet

我目前正在开发一个需要使用多种服务“共享”选项的应用程序；例如电子邮件、推特。

为此，我有一个`UIBarButtonItem`编码，当被触摸时，它会触发：

```
UIActionSheet *sheet = [[UIActionSheet alloc] 
                            initWithTitle:@""
                            delegate:self
                            cancelButtonTitle:nil
                            destructiveButtonTitle:nil
                            otherButtonTitles:nil];

    [sheet addButtonWithTitle:@"Email"];
    [sheet addButtonWithTitle:@"Tweet"];
    [sheet addButtonWithTitle:@"Cancel"];

    sheet.cancelButtonIndex = sheet.numberOfButtons-1;

    [sheet showFromRect:self.view.bounds inView:self.view animated:YES];
    [sheet release]; 
```

结合此来检测选择了哪个按钮：

```
clickedButtonAtIndex:(NSInteger)buttonIndex {
    if (buttonIndex == actionSheet.cancelButtonIndex) { return; }
    switch (buttonIndex) {
        case 0:
        {

            [self emailThis];
            break;
        }
        case 1:
        {
            [self tweetThis];
            break;
        }
    } 
```

这在 iPhone 上是一种享受。但不幸的是，它在 iPad 上显示不正确。看起来它正在尝试显示`UIPopoverController`，但它位于导航栏的中心，几乎没有高度。

我已经研究过使用 UIPopoverController，但我似乎无法找到如何将它与按钮一起使用。无论如何我可以调整上面的代码以正确显示按钮，因为它已经尝试过。

非常感谢，

瑞安

PS：我是 Objective-c/iOS 编码的新手，所以请具体说明。谢谢 ：）

**编辑：** 我尝试过使用：

```
[sheet showFromBarButtonItem:[self share] animated:YES]; 
```

但它不起作用。这是我的按钮代码：

```
UIBarButtonItem *share = [[UIBarButtonItem alloc] 
                                initWithTitle:@"Share"                                            
                                style:UIBarButtonItemStyleBordered 
                                target:self 
                                action:@selector(loadShare)];
    self.navigationItem.rightBarButtonItem = share;
    [share release]; 
```

这里也是 .h 文件中的代码：

```
@interface DetailViewController : UIViewController <UITableViewDelegate, UITableViewDataSource> {
UIBarButtonItem *share;
}

@property (nonatomic, retain) IBOutlet UIBarButtonItem *share; 
```

这是调试错误：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“ *** -[__NSPlaceholderArray initWithObjects:count:]：尝试从对象 [0] 插入 nil 对象”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T07:13:03.083

```
self.navigationItem.rightBarButtonItem = [[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAction target:self action:@selector(actionPhotoShare:)] autorelease]; 
```

...

```
-(void)actionPhotoShare:(id)sender
{
actionSheetShare = [[UIActionSheet alloc] initWithTitle:nil 
                                                              delegate:self 
                                                     cancelButtonTitle:nil
                                                destructiveButtonTitle:NSLocalizedString(@"ActionSheet_Cancel", @"")
                                                     otherButtonTitles:NSLocalizedString(@"ActionSheet_Email", @""),nil];

if (IS_DEVICE_IPAD) {
    [actionSheetShare showFromBarButtonItem:sender animated:YES];
}else {
    [actionSheetShare showInView:self.view];
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:39:55.827

代替 [sheet showFromRect]，使用 [sheet showFromBarButtonItem]，并将其指向您的 Share UIBarButtonItem。注意：如果您还没有，您可能需要为您的 UIBarButtonItem 创建一个 IBOutlet 或 ivar，但这非常简单，我猜您可以这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T22:40:53.840

您的问题是您使用`showFromRect`的 rect 是整个屏幕。这意味着弹出窗口将“箭头”放置在屏幕中心的最佳位置。您想要的是`showFromBarButtonItem`或者传入按钮的 rect ( `self.shareButtonItem.frame`)。

# javascript - 为什么 .replace 方法使用正斜杠字符来包含第一个参数？

> ID：10965089
> 
> 赞同：3
> 
> 时间：2012-06-09T22:38:09.593
> 
> 标签：javascript, regex, syntax

我正在阅读一本关于 Javascript 的书，并遇到了以下代码示例，旨在替换表头 HTML 元素的类属性的值：

`th.className = th.className.replace(/asc/,"dsc");`
`th.className = th.className.replace(/dsc/,"asc");`

为什么 .replace 的第一个参数，当前值`th.className`，用正斜杠括起来而不是引号？

为什么不使用引号将两个参数括起来，而不仅仅是第二个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T22:38:39.230

那些是[正则表达式](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。您可以使用正则表达式或字符串来定义[`.replace()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace).

* * *

例如，如果您想替换`'asc'`字符串中所有出现的 ，您可以`g`在正则表达式上使用 (global) 修饰符。

```
th.className = th.className.replace(/asc/g,"dsc"); 
```

* * *

但是鉴于您的示例，使用的正则表达式不会提供与使用 string 不同的结果`'asc'`。

# php - Wordpress 短代码中的 PHP

> ID：10965096
> 
> 赞同：1
> 
> 时间：2012-06-09T22:39:47.850
> 
> 标签：php, wordpress, shortcode

我有一个 Wordpress 的 PHP 短代码，我们称之为 [myshortcode]。

短代码允许您输入这样的下载 URL [myshortcode download="http://www.example.com/file.pdf"]。

我想在模板文件中使用这个短代码，但下载 url 是一个变量。这可能吗，如果可以，我该怎么做？

我试过这些，但它不起作用......

```
<?php echo do_shortcode('[myshortcode download="<?php echo $variable['dllink']; ?>"]'); ?>
<?php echo do_shortcode('[myshortcode download="echo $variable['dllink'];"]'); ?> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T22:42:54.540

```
<?php echo do_shortcode('[myshortcode download="'.$variable['dllink'].'"]'); ?>
<?php echo do_shortcode("[myshortcode download=\"{$variable['dllink']}\"]"); ?> 
```

我建议您正确[阅读本文](http://php.net/manual/en/language.types.string.php)以了解为什么这些有效而您的无效；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:55:05.997

我认为这取决于变量的定义位置。例如，如果短代码是允许管理员在设置页面上设置一些选项的插件的一部分，那么您会希望 php 检索这些选项并将值回显到短代码中。

另一种方法是使用带有 $_POST 方法的表单将值提交到数据库中的表，然后调用该值并将其设置为变量。

在我最近编写的一个插件（[Recent Post Views](http://wordpress.org/extend/plugins/recent-post-views/)）中，我包含了一个短代码，它从数据库中检索选项并将它们作为变量插入：

```
//Get options from the settings page
$options = get_option('cb_rpv_options');
$select_bold = $options['select_bold'];
$select_italics = $options['select_italics'];
$select_list_style = $options['select_list_style']; 
```

这些变量改变了简码的输出，这就是你想要做的。最好的办法可能是下载一个带有良好注释代码的插件作为示例并以此为基础进行构建。

我希望这会有所帮助，并且我同意您也需要清理语法的另一篇文章。

# ios - NSFetchedResultsController 前置一行或部分

> ID：10965098
> 
> 赞同：15
> 
> 时间：2012-06-09T22:39:57.080
> 
> 标签：ios, uitableview, nsfetchedresultscontroller, nsindexpath

我有一个使用标准 NSFetchedResultsController 填充的 UITableView。但是我想在前面加上一行或一节（最好是一行，但两者都可以正常工作。）

我现在可能看到这样做的唯一方法是在处理处理来自 NSFetchedResultsController 的数据的部分/行时手动重写所有 NSIndexPath，以欺骗它查看索引 0 处的部分并从索引 0 处的行开始。然而，这似乎是一个非常糟糕的主意，很快就会变得混乱，所以我希望避免这种情况。

一个很好的例子是当你第一次启动官方 Twitter 应用程序时，我会引导你从你的朋友列表中添加一些人。

![Twitter 应用程序建议页面的屏幕截图，突出显示相关部分](../Images/5912a7999305db778cd8b9007109191d.png)

红色部分几乎是我想要实现的，我假设黄色部分是同一部分中 NSFetchedResultsController 的结果（尽管使用他们的自定义样式，它可能是一个单独的部分。）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-09T07:42:05.480

这可以以相当干净的方式完成。

我假设您从使用 Apple 示例代码的标准 NSFetchResultsController 设置的标准 tableview 开始。

首先，您需要两个实用功能：

```
- (NSIndexPath *)mapIndexPathFromFetchResultsController:(NSIndexPath *)indexPath
{
    if (indexPath.section == 0)
        indexPath = [NSIndexPath indexPathForRow:indexPath.row+1 inSection:indexPath.section];

    return indexPath;
}

- (NSIndexPath *)mapIndexPathToFetchResultsController:(NSIndexPath *)indexPath
{
    if (indexPath.section == 0)
        indexPath = [NSIndexPath indexPathForRow:indexPath.row-1 inSection:indexPath.section];

    return indexPath;
} 
```

这些应该是相当不言自明的——当我们想使用来自获取的结果控制器的索引路径来访问表时，它们只是处理添加额外行的帮助程序，或者在采用其他方式时删除它。

然后我们需要创建额外的单元格：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"MyCellId";

    if (indexPath.section == 0 && indexPath.row == 0)
    {
        UITableViewCell *cell;
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:nil] autorelease];
        cell.selectionStyle = UITableViewCellSelectionStyleGray;
        cell.textLabel.text = NSLocalizedString(@"Extra cell text", nil);

        return cell;
    }

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:nil] autorelease];
    }

    [self configureCell:cell atIndexPath:indexPath];

    return cell;
} 
```

确保我们正确配置它（configurecell 只会为来自 fetch results 控制器的单元格调用）：

```
// the indexPath parameter here is the one for the table; ie. it's offset from the fetched result controller's indexes
- (void)configureCell:(SyncListViewCell *)cell atIndexPath:(NSIndexPath *)indexPath {
    indexPath = [self mapIndexPathToFetchResultsController:indexPath];

    id *obj = [fetchedResultsController objectAtIndexPath:indexPath];
    <... perform normal cell setup ...>
} 
```

并告诉它存在的tableview：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    NSInteger numberOfRows = 0;

    if ([[fetchedResultsController sections] count] > 0) {
        id <NSFetchedResultsSectionInfo> sectionInfo = [[fetchedResultsController sections] objectAtIndex:section];
        numberOfRows = [sectionInfo numberOfObjects];
    }

    if (section == 0)
        numberOfRows++;

    return numberOfRows;
} 
```

并响应选择：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    if (indexPath.section == 0 && indexPath.row == 0)
    {
        [self doExtraAction];
        return;
    }

    ... deal with selection for other cells ... 
```

然后重新映射我们从结果控制器获得的任何更新：

```
- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type newIndexPath:(NSIndexPath *)newIndexPath {
    UITableView *tableView = self.tableView;

    indexPath = [self mapIndexPathFromFetchResultsController:indexPath];
    newIndexPath = [self mapIndexPathFromFetchResultsController:newIndexPath];

    switch(type) {
        ... handle as normal ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T00:18:26.123

我理解您对复杂性的担忧，但实际上只是在 in 中`numberOfRowsInSection:`加 1 和加 1 （除了为第 0 行添加代码之外）。`indexPath.row``cellForRowAtIndexPath:`

另一种解决方案不必非常复杂就变得更加麻烦。

话虽如此，您提出的“标题”似乎确实是**section header**的典型候选者。

# jquery - jQuery UI 按钮功能在复选框上不起作用

> ID：10965103
> 
> 赞同：3
> 
> 时间：2012-06-09T22:40:24.860
> 
> 标签：jquery, jquery-ui

我正在尝试使用[jQueryUI 按钮](http://jqueryui.com/demos/button/)小部件，尤其是将复选框变成漂亮按钮的选项。

普通按钮可以正常工作，但复选框不能！

这是我的代码

HTML：

```
<button id="button">button</button>
<label for="input">
    <input id="input" type="checkbox"/>Checkbox
</label> 
```

JavaScript：

```
$('#button').button();
$('#input').button(); 
```

我不明白为什么它在复选框上不起作用！！

[演示](http://jsfiddle.net/cY7fe/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T22:47:12.113

**解决方案：**
将html更改为：

```
<button id="button">button</button>
<label for="input">
    Checkbox
</label>
<input id="input" type="checkbox"/> 
```

它会正常工作，[演示](http://jsfiddle.net/cY7fe/1/)。

**说明：**
如果您检查 jQuery-UI 代码，尤其是函数**_determineButtonType**（版本 1.8.18 上的第 7069 行），您会发现

```
var ancestor = this.element.parents().filter(":last"),
            labelSelector = "label[for='" + this.element.attr("id") + "']";
this.buttonElement = ancestor.find( labelSelector ); 
```

因此 jQuery-UI 假设它可以在输入的**最后一个父**级中找到标签，而在您的示例中，标签**是**最后一个父级。
我认为这是一个应该修复的错误，因为许多开发人员都有这样写标签的习惯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T22:44:29.470

```
<button id="button">button</button>
<label for="input">Checkbox</label>
<input id="input" type="checkbox"/> 
```

[http://jsfiddle.net/cY7fe/2/](http://jsfiddle.net/cY7fe/2/)

复选框不应该在标签内，而是在它旁边。它现在似乎正在工作。

# oop - 继承，“是”的关系是不是总要成立？

> ID：10965106
> 
> 赞同：0
> 
> 时间：2012-06-09T22:41:01.913
> 
> 标签：oop, inheritance, subtype

如果类 B 继承自类 A，那么在继承中使用时，类 B 是否总是必须是 A 的子类型？

我在想，当 B 不是 A 的子类型时，是否可以使用继承为 B 提供额外的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:18:18.753

如果：

```
class B extends A 
```

Than`B`根据定义是 的子类型`A`。

如果你不想这样，你可以使用 PHP 的**[traits](http://il.php.net/manual/en/language.oop5.traits.php)**，它基本上是实现的**接口**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:15:24.263

如果 type`A`继承自`B`，这意味着两件事：

1.  类 A 将能够使用类 B 中的公共和受保护的静态方法，而无需指定类名，并且类 A 的对象将隐式包含来自 B 的所有公共和受保护的类成员，而无需重新指定它们。
2.  任何接受“B”类型对象的代码在编译时都将接受“A”类型的对象，“A”类的对象将能够对自己使用“B”类的公共和受保护的实例方法。

接口本质上体现了概念#2 但不是#1（因为接口没有静态方法，并且没有可以隐式使用而无需指定它们的成员）。没有#2，就没有实现#1的内置方法；#1 没有#2 的唯一显着好处是节省打字。

# c# - 使用 Windows 7 密码自动访问 Truecrypt/Keepass 等

> ID：10965107
> 
> 赞同：0
> 
> 时间：2012-06-09T22:41:24.873
> 
> 标签：c#, security, authentication, keylogger

我基本上想自动挂载一个（非系统）Truecrypt 卷或启动 Keypass，只是用一个（安全）密码保护，Windows 7 用于默认身份验证。我正在使用 C#。

1.  已经登录后是否还有获取此密码的方法？
2.  或者无论如何要在登录过程中实际输入此密码时获取此密码。

1.我什么都找不到（密码没有存储在任何地方，只是存储了密码的哈希）

对于 2\. 我已经尝试了一些东西。在用户使用 `GPEDIT.MSC` **Computer Configuration -> Windows Settings -> Scripts -> StartUp**登录之前，我有一个程序要执行。然后我尝试使用全局密钥挂钩（尝试`GetAsyncKeyState`和`SetWindowsHookEx`）获取密码。当我已经登录但在登录过程中尝试捕获密钥时，两者都可以正常工作。

但我发现了一个键盘记录软件（Elite Keylogger），它实际上能够以这种方式获取密码（登录时）。（我在 VMWare 中尝试了试用版）。如果在 VM Ware 和真机上尝试过其他事情。

感谢您提供任何帮助或提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-12-24T03:27:04.797

我正在使用批处理脚本执行类似的操作，以便在使用 Windows 10 登录 Windows 时自动安装 Truecrypt（或 Veracrypt，如果您愿意）卷。我使用 KeePass 文件设置来使用 Windows 身份验证来安全地存放加密的卷密码。

过程如下： 1) 创建您的 truecrypt 或 veracrypt 非系统卷 2) 创建 KeyPass 文件以保存包含加密卷密码的条目。设置 KeyPass 文件以在您希望驱动器自动挂载时使用的登录名下使用 Windows 身份验证。3) 使用如下所示的批处理脚本打开加密卷。通过使用 Windows 身份验证将密码保存在 KeyPass 文件中，您可以防止在批处理文件中以纯文本形式公开密码。您需要将此脚本修改为您的特定系统。

```
@ECHO Mounting Secure Drive (S:)
@ECHO OFF
SETLOCAL EnableDelayedExpansion 
SET x=0
FOR /F "usebackq" %%F IN (`"C:\Program Files (x86)\KeePass Password Safe 2\KPScript.exe" -c:GetEntryString C:\<LocationOfYourKeePassFile>\<keepassfilename>.kdbx -useraccount -ref-Title:<entrytitle> -Field:Password`) DO (
 SET Pass!x!=%%F
 set /a x+=1
)
"C:\Program Files\TrueCrypt\truecrypt" /v \Device\Harddisk0\Partition4 /ls /s /q /p %Pass0% /b /h n /w 
```

4）最后，设置一个windows任务计划程序在windows登录时运行批处理。目标用户帐户的触发器应该是“登录时”。操作应该是“启动程序”，目标是批处理脚本的完整路径

我喜欢这种方法的另一个特点是，我可以将加密的文件卷密码保存在其他地方，以防 Windows 帐户被损坏或删除。即，我可能无法访问设置为使用 Windows 身份验证的 KeyPass 文件，但如果我已将实际加密磁盘密码保存在其他地方，我仍然可以恢复对加密卷的访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-16T20:29:58.620

有一种方法可以在 Windows 登录后自动使用主密码解锁 KeePass 数据库。您可以在其他计算机上使用相同的数据库，因为它不会绑定到您的 Windows 用户帐户。有关详细信息，请参阅此[超级用户答案](https://superuser.com/questions/240657/make-keepass-database-accept-but-not-require-two-unlocking-methods/729804#729804)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-10T14:25:36.517

您将 KeePass 数据库更改为使用您的 Windows 帐户作为主密钥，然后安装`TrueCrypt`KeePass 插件。然后，您在 KeePass 中有一个条目，其中包含`TrueCrypt`安装在`TrueCrypt`插件中的密码。

有了它，在您登录后，打开 KeePass 并选择条目并单击**Ctrl + T**并且您已将卷安装在`TrueCrypt`.

# c++ - 列表 ::iterator 无法正常工作

> ID：10965108
> 
> 赞同：3
> 
> 时间：2012-06-09T22:41:35.277
> 
> 标签：c++, list, typename

我正在用 C++ 创建一个模板类，并在`std::list`其中使用。出于某种原因，我的编译器不喜欢我尝试为列表声明和构造迭代器的方式。

在我的 HashTable.h 文件中，我有：

```
template <typename T> class HashTable {
    bool find(T thing) {
        // some code
        list<T>::iterator iter;
        for (iter = table[index].begin(); iter != table[index].end(); ++iter) {
            // some more code
        }
    }

} 
```

它给了我`HashTable.h:77: error: expected ';' before "iter"`一个错误信息。

迭代器的正确语法是什么？

或者是对的，我需要为我打算在我的 HashTable 模板中使用的每个类创建一个迭代器类？如果是这样，那就糟透了……

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T22:42:42.013

您需要使用它`typename`来告诉编译器`list<T>::iterator`在这种情况下确实是一种类型。

```
typename list<T>::iterator iter; 
```

原因相当模糊；有关更多详细信息，请参阅 C++ 常见问题解答：http: [//www.parashift.com/c++-faq-lite/templates.html#faq-35.18](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.18)。

# objective-c - UIPopoverController 和 UIImagePickerController 崩溃

> ID：10965114
> 
> 赞同：1
> 
> 时间：2012-06-09T22:43:10.083
> 
> 标签：objective-c, ios, cocoa-touch, ipad, uipopovercontroller

这是我的视图的设置：

![查看设置](../Images/77e49b9d62f3ef2ae022ee9480a271e5.png)

当`UIBarButtonItem`点击 时，它应该会弹出一个`UIImagePickerController`. 我必须使用 a 来执行此操作`UIPopoverController`，通过单击“重置”按钮调用它，因为它在 iPad 上是必需的。这是我的代码：

```
-(IBAction) btnReset:(id)sender {
    [self chooseImage];
}

-(void) chooseImage {
    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary]) {
        imagepicker = [[UIImagePickerController alloc] init];
        imagepicker.allowsEditing = NO;
        imagepicker.delegate = self;
        imagepicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
        imagepicker.navigationBar.opaque = true;

        if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
            popoverController = [[UIPopoverController alloc] initWithContentViewController:imagepicker];

            [popoverController presentPopoverFromBarButtonItem:reset permittedArrowDirections:UIPopoverArrowDirectionDown animated:YES];

        } else {
            [self presentModalViewController:imagepicker animated:YES];   
        }
    }
} 
```

但是，当调用它时，视图会因错误而崩溃：

> 'NSInvalidArgumentException'，原因：'-[UIPopoverController presentPopoverFromRect:inView:permittedArrowDirections:animated:]：无法从没有窗口的视图中呈现弹出框。

我究竟做错了什么？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:45:17.523

看起来您正在尝试在不在视图层次结构中的项目上创建弹出框。如果您的按钮正在调用此方法，则将方法标题更改为 -(void) chooseImage:(id)sender 并尝试从工具栏上的 UIBarButton 显示弹出框。

此外，如果您使用的是 ARC（看起来像您），则必须保留您的 UIPopover 否则它将在仍然需要时释放，请参阅[此堆栈溢出帖子](https://stackoverflow.com/questions/8100510/crash-sigabrt-when-i-try-to-present-a-uipopovercontroller/8100788#8100788)。你可能已经这样做了，但我想我会提出它，因为我看不到你是否/如何指定了你的 popoverController。

# java - 如何构造基于 UTF8 的字符串？

> ID：10965115
> 
> 赞同：4
> 
> 时间：2012-06-09T22:43:12.460
> 
> 标签：java, unicode

我想我可以用`\u****`UTF16 来构造一个字符，如何用 UTF8 构造一个字符串？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T22:48:22.530

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T22:46:45.183

接受的答案很有用，但实际上并没有说明如何从 UTF-8 数据构造字符串。

以防万一有人想知道答案，这里是：

```
byte[] bytes = ...; // UTF-8 bytes.
String string = new String(bytes, "UTF-8"); 
```

# c# - 一个过滤字符串中的两个正则表达式组

> ID：10965121
> 
> 赞同：1
> 
> 时间：2012-06-09T22:44:45.493
> 
> 标签：c#, regex

```
using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace RegExCs
{
    class Program
    {
        static void Main(string[] args)
        {
            string rawData;
            Regex filter = new Regex(@"(?<ip>([0-9]+\.){3}[0-9])"+@"(?<time>(\s[0-2][0-9]:[0-9][0-9]))");

            rawData=File.ReadAllText("Query list");

            MatchCollection theMatches = filter.Matches(rawData);

            foreach (Match theMatch in theMatches)
            {
                Console.WriteLine("ip: {0}\n",theMatch.Groups["ip"]);
                Console.WriteLine("time: {0}\n", theMatch.Groups["time"]);
            }

            Console.ReadKey();

        }
    }
} 
```

“查询列表”文件：

```
来自 212.77.100.101 www.wp.pl 的回复时间：21:37
111.41.130.55 www.cnn.com 回复时间：05:33
230.77.100.101 www.piting.com 回复时间：04:12
65.77.100.101 www.ha.org 回复时间：12:55
来自 200.77.100.101 www.example.com 的回复时间：07:56

```

该程序编译并运行，但空的控制台窗口一直打开。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T22:47:07.163

因为没有任何东西与正则表达式匹配

```
@"(?<ip>([0-9]+\.){3}[0-9])(?<time>(\s[0-2][0-9]:[0-9][0-9]))" 
```

您只需连接 2 个字符串，复合正则表达式期望字符串`ip`后面`time`没有任何其他内容（甚至是空格）。

您需要将其更改为

```
@"(?<ip>([0-9]+\.){3}[0-9]).*(?<time>(\s[0-2][0-9]:[0-9][0-9]))"
                           ^------- "anything" between first and second group 
```

# .htaccess - 加号登录 htacesss 为用户重写

> ID：10965123
> 
> 赞同：0
> 
> 时间：2012-06-09T22:45:31.233
> 
> 标签：.htaccess, url, mod-rewrite

我希望能够创建网址：[http ://example.com/+/user](http://example.com/+/user)

是否可以使用 .htacess 重写。

我在网上搜索过，没有发现任何与我想要的东西相关的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:21:29.837

你必须使用非常简单的 RewriteRule ...

```
RewriteRule ^\+/user$ /test.php [PT,L,QSA,NC] 
```

或者如果你想从地址中“捕获”用户名，你必须使用类似这样的东西

```
RewriteRule ^\+/(.+)$ /test.php?username=$1 [PT,L,QSA,NC] 
```

使用您需要的任何 rewrite_mod 选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:29:37.707

没有那么多事情要做，简单的事情往往更好：

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^\+/(.+)$  index.php?user=$1 [L] 
```

# ascii - PuTTY Cntrl 字符

> ID：10965126
> 
> 赞同：0
> 
> 时间：2012-06-09T22:46:14.930
> 
> 标签：ascii, putty

使用 PuTTY 通过串行连接与我的 PIC 芯片通信。我想`<CR> <Backspace> <Cursor Up> <Cursor Dwn> <Cursor left> <Cursor Right>`在 LCD 显示屏上识别并做正确的事情。

我想这应该很容易。只需查看一个 Ascii 表并使用正在发送的十六进制值。问题是我猜 PuTTY 为每个 cntrl char 值发送多个值。

是否有一个我可以参考这些值的列表，我可以使用这些值修改我的代码，或者答案是否让我眼前一亮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:54:07.510

我不知道 PuTTY 协议的细节，但 ASCII 确实定义了转义字符 - Control+key。更具体地说，ASCII 0 是 Control-@，1 到 26（0x1 到 0x1a）是 Control+相应的字母。

# javascript - Javascript将文本更改为图像

> ID：10965128
> 
> 赞同：0
> 
> 时间：2012-06-09T22:46:25.547
> 
> 标签：javascript, html, button, dom-events, blogger

```
<div id="myLuckyPost">
</div>
<script type="text/javascript"> 
    function showLucky(root){ 
        var feed = root.feed; 
        var entries = feed.entry || []; 
        var entry = feed.entry[0]; 
        for (var j = 0; j < entry.link.length; ++j){
            if (entry.link[j].rel == 'alternate'){
                window.location = entry.link[j].href;
            }
        }
    } 
    function fetchLuck(luck){ 
        script = document.createElement('script'); 
        script.src = '/feeds/posts/summary?start-index='+luck+'&max-results=1&alt=json-in-script&callback=showLucky'; 
        script.type = 'text/javascript'; 
        document.getElementsByTagName('head')[0].appendChild(script); 
    } 
    function feelingLucky(root){ 
        var feed = root.feed; 
        var total = parseInt(feed.openSearch$totalResults.$t,10); 
        var luckyNumber = Math.floor(Math.random()*total);
        luckyNumber++; 
        a = document.createElement('a'); 
        a.href = '#random'; 
        a.rel = luckyNumber; 
        a.onclick = function(){
            fetchLuck(this.rel);
        }; 
        a.innerHTML = 'View Random Post';
        document.getElementById('myLuckyPost').appendChild(a); 
    } 
</script> 
<script src="/feeds/posts/summary?max-results=0&alt=json-in-script&callback=feelingLucky"></script> 
```

这会生成一个随机博客帖子的链接。现在我想将“查看随机帖子”( `a.innerHTML = 'View Random Post';`) 文本链接更改为图像。是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:24:35.260

这是你想要的？

```
a.innerHTML = "<img src='button.gif' />"; 
```

# java - Java中布尔表达式的二叉表达式树库的建议

> ID：10965138
> 
> 赞同：4
> 
> 时间：2012-06-09T22:47:18.363
> 
> 标签：java, expression-trees, boolean-expression, soot

我正在使用[Soot](http://www.sable.mcgill.ca/soot/ "煤烟")在 Java 中进行一些非常简单的程序分析/转换，我发现自己需要做一些简单的布尔表达式组合。因此，例如，在我的分析过程中，我将有一个表达式 like`(a < 25) && (b >= 10)`并且我想`(a >=-10)`通过 OR 运算符加入该表达式以获得完整的表达式，例如`(a >=-10) || (a < 25) && (b >= 10)`. 基本上，只需将两个布尔表达式树组合成一个表达式。我可能还希望自动将表达式树转换为树的等效合取范式版本。

我的另一个要求是当我们有可以轻松消除的表达式时，能够简化表达式（如果需要，通过自定义代码）。例如`(a < 20) || (a >= 20)`归约到`TRUE`, since `(a < 20) = (!(a >= 20))`, 所以我们可以在进行过程中消除一些项。

我知道编写布尔表达式树是一个经典的介绍性问题，而且我很确定我之前已经实现过它（一次，很久以前，用于数据结构类:)）我知道我可以再做一次，如果需要......但鉴于这可能是以前处理过的事情，我想知道是否有关于我应该研究解决上述问题的库的任何建议。当可能已经有一个非常好的轮子时，我讨厌重新发明轮子。

所以总结一下，我正在寻找一个 Java 库，它具有：

*   布尔表达式树
*   表达式的组合
*   术语的简化（这是非常具体的，所以“很高兴”）
*   转换为 CNF

有什么建议吗？

（注意：我不会*评估*这些树，因此每个节点都将是未解析的谓词，例如`variable != 20`or `foo >= 50`，因此评估不是必需的，但如果它是库的一部分也没有什么坏处。）

# ruby-on-rails - 嵌套资源问题

> ID：10965140
> 
> 赞同：0
> 
> 时间：2012-06-09T22:48:02.690
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在努力将一个 ID 成功传递到我设置的嵌套资源的 URL 中，称为 Jobs。

当我尝试将对象传递到我的链接时，我得到的错误`@job`如下：

```
 No route matches {:action=>"edit", :controller=>"jobs", :user_id=>1, :id=>nil} 
```

这清楚地表明它无法正确找到 id，所以正在寻找`nil`

目前我的路线设置如下：

```
 resources :users do
   resources :jobs
 end 
```

我的链接是`<%= link_to "Edit", edit_user_job_path(@user.id,@job) %>`

有趣的是，如果我`@jobs`在最后传递带有“s”的对象，它将正确加载页面，但是当我单击链接时，将尝试添加所有该用户的作业 ID。

在我的编辑控制器中，我有：

```
def edit
 @user = current_user
 @job = @user.jobs.find(params[:id])
end 
```

任何帮助真的将不胜感激:)

**更新**

好的，我在控制器的错误页面上定义了对象（在编辑而不是索引下）。我现在遇到的问题是`Couldn't find Job without an ID`

我将控制器索引定义更新为：

```
 def index
  @user = current_user
  @jobs = @user.jobs.all
  @job = @user.jobs.find(params[:id])
 end 
```

在我看来 (jobs#index)

```
<% @jobs.each do |f| %>
 ...
 <%= link_to "Edit", edit_user_job_path(@user.id,job) %>
 ...
<% end %> 
```

如果您知道我哪里出错了，任何建议将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:18:16.827

该错误意味着它`@job`为零。

该链接指向编辑路径，您提供的控制器代码来自控制器中的编辑操作。编辑页面似乎不太可能链接到自身。

查看实际呈现该页面的代码（它将出现在您的堆栈跟踪中），您会发现 @job 未设置。我怀疑你在索引页面上并且有类似的东西：

```
<% @jobs.each do |job| %>
  ...
  <%= link_to "Edit", edit_user_job_path(@user.id,@job) %>
  ...
<% end %> 
```

如果是这种情况，那么链接应该是 to `job`，而不是`@job`，即

```
<%= link_to "Edit", edit_user_job_path(@user.id,job) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:07:44.290

（用他自己的帖子扩展 iHiD 的评论）

使用 restful 资源意味着您将使用 rails 默认值，因此意味着索引页面会为您提供所有作业的列表，并且默认情况下没有单个特殊作业。如果您从命令行运行`rake routes`，您将获得所有路由，以及从 URI 设置的参数。它应该给你这样的东西：

```
user_jobs GET    /users/:user_id/jobs(.:format)          jobs#index 
```

如您所见，索引操作没有 :id (params[:id])。

# c++ - 使用 std::map 从数组中删除重复项

> ID：10965141
> 
> 赞同：0
> 
> 时间：2012-06-09T22:48:06.317
> 
> 标签：c++, performance, algorithm

我直接发布了我在 5 分钟**内在 collabedit**上编写的代码（包括弄清楚算法），因此即使在效率方面完全取笑我想问问我的经验丰富的堆栈溢出算法爱好者关于问题；

基本上从数组中删除重复元素。**我的方法：**基本上使用**std::map**作为我的哈希表，如果没有分配值，则将重复数组中的每个元素添加到我们的新数组中。如果分配只是跳过。最后返回唯一的数组。这是我的代码，我在面试问题方面唯一要问的问题是我的解决方案可以更有效吗？

```
#include <iostream>
#include <vector>
#include <map>

using namespace std;

vector<int>uniqueArr(int arr[],int size){
    std::map<int,int>storedValues;
    vector<int>uniqueArr;
    for(int i=0;i<size;i++){
        if(storedValues[arr[i]]==0){
            uniqueArr.push_back(arr[i]);
            storedValues[arr[i]]=1;
        }
    }
    return uniqueArr;  
}

int main()
{   
    const int size=10;
    int arr[size]={1,2,2,4,2,5,6,5,7,1};
    vector<int>uniArr=uniqueArr(arr,size);
    cout<<"Result: ";
    for(int i=0;i<uniArr.size();i++) cout<<uniArr[i]<<" ";
    cout<<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T23:08:13.690

首先，不需要映射，集合在概念上更正确，因为您不想存储任何值，而只想存储键。

`std::unordered_set`在性能方面，使用 a而不是 a可能是一个更好的主意`std::set`，因为前者是散列的，并且在最好的情况下可以给你 O(1) 插入和查找，而后者是一个二叉搜索树，只给你 O (log n) 访问。

```
vector<int> uniqueArr(int arr[], int size)
{
    std::unordered_set<int> storedValues;
    vector<int> uniqueArr;
    for(int i=0; i<size; ++i){
        if(storedValues.insert(arr[i]).second)
            uniqueArr.push_back(arr[i]);
    return uniqueArr;  
} 
```

但是，如果您被允许更广泛地使用 C++ 标准库，您也可以考虑使用`std::sort`and的其他答案`std::unique`，尽管它们是**O(n log n)**（而不是上面的**~O(n)**解决方案）并破坏了要素。

* * *

如果您想使用更灵活和标准驱动的方法，但具有〜O（n）复杂性并且不破坏元素的顺序，您可以将上述例程转换为以下类似标准的算法，即使有点太一个简单的面试问题牵强附会：

```
template<typename ForwardIterator>
ForwardIterator unordered_unique(ForwardIterator first, ForwardIterator last)
{
    typedef typename std::iterator_traits<ForwardIterator>::value_type value_type;
    std::unordered_set<value_type> unique;
    return std::remove_if(first, last, 
                          [&unique](const value_type &arg) mutable -> bool
                              { return !unique.insert(arg).second; });
} 
```

然后您可以像`std::unique`通常的擦除删除方式一样应用它：

```
std::vector<int> values(...);
values.erase(unordered_unique(values.begin(), values.end()), values.end()); 
```

在不复制向量且无需事先对其进行排序的情况下删除唯一值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T22:52:06.540

既然你问的是面试问题，我会说你没有得到这份工作。

```
const int size=10;
int arr[size]={1,2,2,4,2,5,6,5,7,1};

std::sort( &arr[0], &arr[size] );
int* new_end = std::unique( &arr[0], &arr[size] );

std::copy(
    &arr[0], new_end,
  , std::ostream_iterator< int >( std::cout, " " )
); 
```

没有临时映射，没有临时向量，没有动态内存分配，编写的**代码少得多**，因此更容易编写和维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T23:05:42.520

```
#include <algorithm>
#include <vector>

int main()
{
    std::vector<int> vec({1,2,3,2,4,4,5,7,6,6});
    std::sort(vec.begin(), vec.end());
    vec.erase(std::unique(vec.begin(), vec.end()), vec.end());
    // vec = {1,2,3,4,5,6,7}
    return 0;
}
//works with C++11
// O(n log n) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T07:03:38.010

就地移除对速度很有好处 - 像这样（返回新大小）：

```
template <typename T, size_t N>
size_t keep_unique(T (&array)[N])
{
    std::unordered_set<T> found;
    for (size_t i = 0, j = 0; i < N; ++i)
        if (found.insert(array[i]).second))
            if (j != i) // (optional) avoid copy to self, as may be slower or unsupported by T
                array[j++] = array[i];
            else
                ++j;
    return j;
} 
```

（对于较大的对象或无法安全复制的对象，可能需要和/或更快且更节省空间来将`T*`s 存储在 unordered_set 中 - 还必须提供取消引用比较运算符和散列函数。）

为了可视化这是如何工作的，请考虑处理以下输入：

```
1  3  6  3  5  6  0  2  1
         <--+<----+  |
               <-----+ 
```

上面的箭头表示产生答案所需的最小就地压缩：

```
1  3  6  5  0  2 
```

这正是上面的算法所做的，查看 中的所有元素`[i]`，并跟踪它们需要复制到的位置（以及有多少非重复项）`[j]`。

# javascript - 如何使用函数参数来引用同名变量？

> ID：10965148
> 
> 赞同：0
> 
> 时间：2012-06-09T22:49:36.270
> 
> 标签：javascript, jquery

我正在制作一个 jquery 插件来显示钢琴音阶。

我有一个名为 markScale(a, b) 的函数，它将用于突出显示某些音阶（a 参数给出了起始音符的音高，即从 C 开始多少个半音，默认音阶）。那没问题。

问题在于 b，要显示的音阶或和弦类型。我已经定义了在不同类型的比例中使用哪些键，如下所示：

```
 var majorScale=[12,14,16,17,19,21,23,24];
  var nminorScale=[12,14,15,17,19,20,22,24];
  var hminorScale=[12,14,15,17,19,20,23,24]; 
```

所以我想做的是以下几点：

```
 for(i=0;i<8;i++){
  $('#key-'+(b[i]+a)+'-marker').show();
   } 
```

markScale(0,"majorScale") 不起作用，因为那只是一个字符串，并不引用我需要的数组变量。

如何将数组变量称为函数的参数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:53:07.163

我认为我们缺少一些信息，但是如果您想按名称访问比例，请将数组放入对象而不是单个变量中。

```
var scales = {
    majorScale:[12,14,16,17,19,21,23,24],
    nminorScale:[12,14,15,17,19,20,22,24],
    hminorScale:[12,14,15,17,19,20,23,24]
}; 
```

然后您可以使用字符串引用比例...

```
var the_scale = "majorScale"

scales[the_scale][i]; 
```

* * *

虽然可以从字符串中引用局部变量，但它需要一种通常不推荐的方法。全局变量更容易一些。

* * *

如果您试图*通过*比例，那么您根本不使用字符串。您只需使用直接参考。`majorScale`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:00:13.287

没有更多上下文很难判断，但是您是否尝试过将数组majorScale 本身传递给markScale() 函数？

如：markScale（c，majorScale）；

而不是字符串：markScale(c, "majorScale");

# html - 如何用css证明表单输入字段的合理性？

> ID：10965155
> 
> 赞同：2
> 
> 时间：2012-06-09T22:50:55.653
> 
> 标签：html, css, forms, layout

我有一个简单的注册输入表格（这里是 haml ：）

```
%form#signup
  %fieldset
    %input.email{type:'text'}
    %br
    .name
      %input.first-name{type:'text'}
      %input.last-name{type:'text'} 
```

和CSS：

```
#signup { width: 350px; }
fieldset { width: 100%; }
.name { width: 100%; }
.first-name { width: 30%; }
.last-name { /* occupy remainder of 'name' line */ } 
```

如何设置此样式以使`.email`字段的全宽`fieldset`和`.last-name`/或`.first-name`字段扩展以填充和的整个宽度`fieldset`并且右边缘与`.email`字段对齐？

是的，在这里使用 a 可能更容易，`table`但是有没有简单的 css 方法？它只需要在兼容 css3 的浏览器上工作，并在 IE8 和 9 上合理降级。

小提琴链接：http: [//jsfiddle.net/3UP9H/1](http://jsfiddle.net/3UP9H/1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T00:00:48.617

原始答案出现在`hr`; 为了清楚起见，问题的答案似乎是`box-sizing`（及其供应商前缀的变体）的组合，以便在元素的定义中包含`border-width`and （而不是它们的宽度是定义的宽度 + 边框-width + padding）和父元素，它删除了两个元素之间的错误空间（尽管从技术上讲，空间仍然存在；它只是没有任何大小来影响周围元素的位置）。`padding``width``font-size: 0``input`

因此，CSS 就是下面第二个示例中的 CSS：

```
fieldset input[type=text] {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    -o-box-sizing: border-box;
    box-sizing: border-box;
    width: 350px;
}

fieldset div input[type=text] {
    width: 105px;
    margin: 0;
}

fieldset div input[type=text] + input[type=text] {
    float: right;
    width: 245px;
}

div.name {
    font-size: 0;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3UP9H/11/)。

* * *

### 原答案如下：

一种方法似乎是：

```
form {
    width: 350px;
}

fieldset {
    width: 100%;
}

​fieldset input[type=text] {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    -o-box-sizing: border-box;
    box-sizing: border-box;
    display: inline-block;
    width: 350px;
}​​

fieldset div input[type=text] {
    width: 105px;
    margin: 0;
}

fieldset div input[type=text] + input[type=text] {
    float: right;
    width: 241px;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3UP9H/7/)。

`box-sizing`（和供应商前缀的变体）的使用是简单地包括元素的，以及在元素的定义宽度内`border`分配的任何内容。`padding`

我`input`在链接的演示中使用了自关闭标签，因为`input`据我所知，元素没有关闭标签`</input>`。

我已经稍微修改了上面的内容，以消除错误空间的问题（`input`元素中的兄弟元素之间`.name`需要任意更正以允许它们都在同一行上（因此`width: 241px`在上面的 CSS 中很奇怪）：

```
form {
    width: 350px;
}

fieldset {
    width: 100%;
}

fieldset input[type=text] {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    -o-box-sizing: border-box;
    box-sizing: border-box;
    display: inline-block;
    width: 350px;
}

fieldset div input[type=text] {
    width: 105px;
    margin: 0;
}

fieldset div input[type=text] + input[type=text] {
    float: right;
    width: 245px;
}

div.name {
    font-size: 0;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3UP9H/8/)。

* * *

**编辑**以删除固定宽度的测量值，并替换为相对、百分比、基于单位（如原始问题中所示）：

```
form {
    width: 350px;
}

fieldset {
    width: 100%;
}

fieldset input[type=text] {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    -o-box-sizing: border-box;
    box-sizing: border-box;
    display: inline-block;
    width: 100%;
}

fieldset div input[type=text] {
    width: 30%;
    margin: 0;
}

fieldset div input[type=text] + input[type=text] {
    float: right;
    width: 70%;
}

div.name {
    font-size: 0;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3UP9H/9/)。

不幸的是，默认情况下无法将`input`元素的宽度设置为`100%`，同时仍允许同级`input`元素具有不同的宽度。或者，有，但它更尴尬，并且需要您明确地将两个兄弟姐妹标识为，尽管可以使用`+`or`~`组合器选择第二个或以后的兄弟姐妹，但不可能根据其具有后续兄弟姐妹来选择*第一个*兄弟姐妹（没有 JavaScript 或其他脚本语言，无论是客户端还是服务器端）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:25:42.010

```
#signup { width: 350px; }
fieldset { width: 100%; border: 1px solid grey; padding:2px;}
.email { width: 99%;margin-bottom:2px; }
.name { width: 100%; }
.first-name { width: 30%; }
.last-name { width : 67% } 
```

[**演示**](http://jsfiddle.net/3UP9H/4/)

**更新**

```
#signup { width: 350px; }
fieldset { width: 100%; border: 1px solid grey; padding:2px;}
.email { width: 99%;margin-bottom:2px; }
.name { width: 100%; }
.first-name { width: 30%; }
.last-name { width : 67%; float:right; } 
```

[**演示**](http://jsfiddle.net/3UP9H/6/)

火狐截图。

![在此处输入图像描述](../Images/e058a94794a573d3a9596891b02c0e1d.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T23:29:17.083

将这两行更改为如下所示：

```
.email { width: 99%; float: right; }
.last-name { width: 65%; float: right;}​ 
```

[小提琴链接](http://jsfiddle.net/3UP9H/5/)

**编辑**奇怪的是，`width`在 Chrome 和 IE 中，Firefox 中没有额外的 4px 宽度。问题是 Chrome 和 IE 将边框添加到框的宽度，而 Firefox 会补偿内部文本字段的宽度以使其适合指定范围内的边框。请参阅[此版本的小提琴](http://jsfiddle.net/SapWq/)进行演示。

**EDIT2**检查这个[更新的小提琴](http://jsfiddle.net/SapWq/6/)。

# c# - 按文件创建日期排序（和枚举）目录列表？

> ID：10965165
> 
> 赞同：9
> 
> 时间：2012-06-09T22:53:00.573
> 
> 标签：c#, linq

所以我有这个例程：

```
public static IEnumerable<string> GetFiles( string path, string[] searchPatterns, SearchOption searchOption = SearchOption.TopDirectoryOnly) {
    return searchPatterns.AsParallel()
                         .SelectMany(searchPattern => 
                             Directory.EnumerateFiles(path, searchPattern, searchOption))
                         .OrderBy<string, string>( (f) => f)
                         .Distinct<string>();
} 
```

及其工作但按其名称排序文件，我需要对其创建日期返回的文件进行排序。如果项目是例程中的字符串，我该如何排序。我想使用 Enumerate 原因文件预计会超过 1k。

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-10T00:55:47.013

我不确定您是否真的想为该查询使用任务并行库。由于某些原因，请参阅这个问题[如何使用 C# 查找磁盘上的所有 exe 文件？](https://stackoverflow.com/questions/10965280/how-to-find-all-exe-files-on-disk-using-c).

至于按创建日期枚举文件，我将通过使用提供的路径创建一个新的[DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)来启动该函数，然后调用[.EnumerateFiles(string pattern, SearchOption searchOption)](http://msdn.microsoft.com/en-us/library/dd413343.aspx)以获取与您的模式匹配的所有文件。最后，您可以在返回的枚举中按[FileInfo对象的](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)[CreationTime](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.creationtime.aspx)属性排序，然后返回完整的 FileInfo 对象或仅返回它们的[Name](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.name.aspx)，如下所示：

```
public static IEnumerable<string> GetFiles( string path, string[] searchPatterns, SearchOption searchOption = SearchOption.TopDirectoryOnly) {
    DirectoryInfo dir = new DirectoryInfo(path);
    var dirs = (from file in dir.EnumerateFiles(searchPatterns, searchOptions)
            orderby file.CreationTime ascending
            select file.Name).Distinct(); // Don't need <string> here, since it's implied
    return dirs;
} 
```

注意：我目前无法访问编译器，但我相信上面的代码没有错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T22:57:06.033

您需要切换到使用[DirectoryInfo.EnumerateFiles](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.enumeratefiles.aspx)，它将返回 FileInfo 实例的集合。然后，您可以按日期对它们进行排序并选择名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-22T12:10:53.333

以下示例：

```
DirectoryInfo dir = new DirectoryInfo(path);
//Date created latest first
var files = dir.EnumerateFiles().OrderByDescending(x => x.CreationTime);

//Date created latest last
var files2 = dir.EnumerateFiles().OrderBy(x => x.CreationTime);

//dir.EnumerateFiles() is the same as the ones below
var files3 = dir.EnumerateFiles("*");
var files4 = dir.EnumerateFiles("*", SearchOption.TopDirectoryOnly); 
```

# java - JOptionPane.showMessageDialog 等到单击确定？

> ID：10965168
> 
> 赞同：5
> 
> 时间：2012-06-09T22:54:00.270
> 
> 标签：java, swing, jtable, keylistener, joptionpane

这可能是我忽略的一件非常简单的事情，但我似乎无法弄清楚。

我有以下更新 JTable 的方法：

```
class TableModel extends AbstractTableModel {    
        public void updateTable() {
            try {
                // update table here
             ...
    } catch (NullPointerException npe) {
                isOpenDialog = true;
                JOptionPane.showMessageDialog(null, "No active shares found on this IP!");
                isOpenDialog = false;
            }
        }
    } 
```

但是，在按下消息对话框上的 OK 按钮之前，我不希望`isOpenDialog`将 boolean 设置为 false，因为如果用户按下 enter，它将激活`KeyListener`文本字段上的事件，并且如果设置了它，它将再次触发整个代码块到`false`.

部分 KeyListener 代码如下所示：

```
public class KeyReleased implements KeyListener {
        ...

    @Override
    public void keyReleased(KeyEvent ke) {
        if(txtIPField.getText().matches(IPADDRESS_PATTERN)) {
            validIP = true;
        } else {
            validIP = false;
        }

        if (ke.getKeyCode() == KeyEvent.VK_ENTER) {
            if (validIP && !isOpenDialog) {
                updateTable();
            }
        }
    }
} 
```

是否`JOptionPane.showMessageDialog()`有某种机制可以防止在按下 OK 按钮之前执行下一行？谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T00:17:33.687

JOptionPane 创建一个模态对话框，因此在处理对话框之前（按下按钮之一或按下关闭菜单按钮），设计上不会调用超出它的行。

更重要的是，您不应该将 KeyListener 用于此类事情。如果您想让 JTextField 监听 Enter 键的按下，请向其添加 ActionListener。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-10T04:16:03.487

满足您的需求的一个简单解决方法是使用[showConfirmDialog(...)](http://docs.oracle.com/javase/7/docs/api/javax/swing/JOptionPane.html#showConfirmDialog%28java.awt.Component,%20java.lang.Object,%20java.lang.String,%20int,%20int%29) , over `showMessageDialog()`，这使您可以从用户那里获取输入，然后继续进行。请查看此示例程序以进行澄清:-)

```
import javax.swing.*;

public class JOptionExample
{
    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                int selection = JOptionPane.showConfirmDialog(
                                null
                        , "No active shares found on this IP!"
                        , "Selection : "
                        , JOptionPane.OK_CANCEL_OPTION
                        , JOptionPane.INFORMATION_MESSAGE);
                System.out.println("I be written" +
                     " after you close, the JOptionPane");      
                if (selection == JOptionPane.OK_OPTION)
                {
                    // Code to use when OK is PRESSED.
                    System.out.println("Selected Option is OK : " + selection);
                }
                else if (selection == JOptionPane.CANCEL_OPTION)
                {
                    // Code to use when CANCEL is PRESSED.
                    System.out.println("Selected Option Is CANCEL : " + selection);
                }
            }           
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-28T13:48:44.637

```
You can get acces to the OK button if you create optionpanel and custom dialog. Here's an example of this kind of implementation:

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/**
 *
 * @author OZBORN
 */
public class TestyDialog {
    static JFrame okno;
    static JPanel panel;
    /**
     * @param args the command line arguments
     */

    public static void main(String[] args) {
        zrobOkno();
        JButton przycisk =new JButton("Dialog");
        przycisk.setSize(200,200);
        panel.add(przycisk,BorderLayout.CENTER);
        panel.setCursor(null);
        BufferedImage cursorImg = new BufferedImage(16, 16, BufferedImage.TYPE_INT_ARGB);
        przycisk.setCursor(Toolkit.getDefaultToolkit().createCustomCursor(
                            cursorImg, new Point(0, 0), "blank cursor"));
        final JOptionPane optionPane = new JOptionPane(
                "U can close this dialog\n"
                + "by pressing ok button, close frame button or by clicking outside of the dialog box.\n"
                +"Every time there will be action defined in the windowLostFocus function"
                + "Do you understand?",
                JOptionPane.INFORMATION_MESSAGE,
                JOptionPane.DEFAULT_OPTION);

        System.out.println(optionPane.getComponentCount());
        przycisk.addActionListener(new ActionListener(){
            @Override
            public void actionPerformed(ActionEvent e) {
                final JFrame aa=new JFrame();
                final JDialog dialog = new JDialog(aa,"Click a button",false);
                ((JButton)((JPanel)optionPane.getComponents()[1]).getComponent(0)).addActionListener(new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent e) {
                        aa.dispose();
                    }
                });
                dialog.setContentPane(optionPane);
                dialog.pack();

                dialog.addWindowFocusListener(new WindowFocusListener() {
                    @Override
                    public void windowLostFocus(WindowEvent e) {
                        System.out.println("Zamykam");        
                        aa.dispose();
                    }
                    @Override public void windowGainedFocus(WindowEvent e) {}
                });

                dialog.setVisible(true);    
            }
        });
    }
    public static void zrobOkno(){
        okno=new JFrame("Testy okno");
        okno.setLocationRelativeTo(null);
        okno.setSize(200,200);
        okno.setPreferredSize(new Dimension(200,200));
        okno.setVisible(true);
        okno.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        panel=new JPanel();
        panel.setPreferredSize(new Dimension(200,200));
        panel.setLayout(new BorderLayout());
        okno.add(panel);
    }
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-06-09T23:11:35.360

试试这个，

```
catch(NullPointerException ex){
     Thread t = new Thread(new Runnable(){

                            public void run(){

                                  isOpenDialog = true;

                                  JOptionPane.setMessageDialog(Title,Content);
                                }
                              });

     t.start();

     t.join(); // Join will make the thread wait for t to finish its run method, before
                  executing the below lines

     isOpenDialog = false;

   } 
```

# javascript - 触摸在 HTML5 画布上绘制正方形

> ID：10965174
> 
> 赞同：1
> 
> 时间：2012-06-09T22:55:18.210
> 
> 标签：javascript, html, canvas, touch

首先，正方形画得很好并且确实有效，但仍然存在一些问题。我有两个问题......第一个是当我绘制正方形时，如果你让你的正方形太大，它就无法自行折叠到一个点（并变小）。第二个问题是，当我绘制正方形时，它显示在我手指下方约一厘米处，而不是直接在手指下方。

谁能帮我解决这些问题？

* * *

这是代码：

JAVASCRIPT

```
// "Draw Rectangle" Button
function rect(){
var canvas = document.getElementById('canvasSignature'), ctx = canvas.getContext('2d'), rect = {}, drag = false;

function init() {
  canvas.addEventListener("touchstart", touchHandler, false);
  canvas.addEventListener("touchmove", touchHandler, false);
  canvas.addEventListener("touchend", touchHandler, false);
}

function touchHandler(event) {
  if (event.targetTouches.length == 1) { //one finger touche
    var touch = event.targetTouches[0];

    if (event.type == "touchstart") {
      rect.startX = touch.pageX;
      rect.startY = touch.pageY;
      drag = true;
    } else if (event.type == "touchmove") {
      if (drag) {
        rect.w = touch.pageX - rect.startX;
        rect.h = touch.pageY - rect.startY ;
        draw();
      }
    } else if (event.type == "touchend" || event.type == "touchcancel") {
      drag = false;
    }
  }
}

function draw() {
  ctx.fillRect(rect.startX, rect.startY, rect.w, rect.h);
  ctx.fillStyle = "orange";
}

init();
} 
```

* * *

谢谢，沃登克里夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:01:33.083

第一个问题是由于您没有清除画布引起的。除非您将其清除，否则先前的数据将保留在画布中，因此先前绘制的矩形将保留。您可以像这样清除画布：

```
ctx.clearRect(0, 0, canvas.width, canvas.height); 
```

我假设您的第二个问题是您正在使用相对于页面的 X 和 Y，并期望它是相对于画布的 X 和 Y。除非画布的左上角与文档的上角相同，否则情况并非如此左手角。您可以在较新的浏览器中将页面 X 和 Y 转换为画布 X 和 Y，如下所示：

```
var clientRect = canvas.getBoundingClientRect();
var canvasX = touch.pageX - clientRect.left - window.pageXOffset,
    canvasY = touch.pageY - clientRect.top  - window.pageYOffset; 
```

如果画布位于带有滚动条的元素中，则需要进一步调整。

# java - 问Eclipse的编码

> ID：10965176
> 
> 赞同：1
> 
> 时间：2012-06-09T22:55:47.970
> 
> 标签：java, eclipse, unicode

我需要在一些 java 文件的字符串中使用一些 UTF8 字符。我想我需要将文件的编码更改为 UTF8 Eclipse 才能使它们工作。

我想知道如何将默认编码设置为 UTF8？

另外，我想问一下，将编码设置为UTF8后，实际的物理java文件是否包含UTF8 BOM头。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:59:44.583

在 Eclipse 中，转到`Preferences>General>Workspace`并选择`UTF-8`Text File Encoding。

这应该为工作区中的所有资源设置编码。从现在开始使用默认编码创建的任何组件都应该匹配。

# c++ - 使用 str.at(x) 将字符串转换为 int

> ID：10965178
> 
> 赞同：0
> 
> 时间：2012-06-09T22:56:21.433
> 
> 标签：c++, string, int

我正在构建一个基于行命令的国际象棋引擎。当向引擎发出命令（作为字符串）时，我运行了几个正则表达式来确定命令是否有效。如果它有效，则传递该命令以进行解析。

当在`a6a4`中向引擎发出`string input;`诸如此类的命令时，使用以下命令是否有效：

`istringstream (input.at(1)) >> originalx;`或者：

`istringstream buffer(input.at(1)); buffer >> originalx;`

将字符串的一部分与整数转换为实际的 int？我一直在尝试这些转换方法，所有这些方法都使用`str.at(x)`而不是仅仅使用`str`它们似乎都不起作用。

我知道这似乎是一个重复的问题，因为每个人都想知道如何将整个字符串转换为 int，但是字符串的特定部分呢？我也确实在谷歌上搜索过答案，但我发现没有任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:59:55.833

> 我知道这似乎是一个重复的问题，因为每个人都想知道如何将整个字符串转换为 int，但是字符串的特定部分呢？

a 的特定部分`string`仍然是 a `string`。您可以`str.substr(1, 1)`将整个*子*字符串转换为`int`.

# html - CSS3 - 将背景图片变成 CD

> ID：10965179
> 
> 赞同：0
> 
> 时间：2012-06-09T22:56:25.647
> 
> 标签：html, css

假设我有一个这样大小的图像：

![http://userserve-ak.last.fm/serve/126/23679395.jpg](../Images/c49134243c30c39cc0994d69e96dc392.png)

使用`CSS3`等等，有没有办法可以像CD一样制作它？你知道整体在中间（最好是透明的）和圆边等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:06:35.627

我不确定透明中间，但这会给你CD形状（[http://jsfiddle.net/CkYcN/](http://jsfiddle.net/CkYcN/)）：

HTML：

```
<div class="cd">
    <div class="hole"></div>
</div> 
```

CSS：

```
.cd {
    -moz-border-radius: 63px;
    -webkit-border-radius: 63px;
    border-radius: 63px;
    background-image: url('http://userserve-ak.last.fm/serve/126/23679395.jpg');
    width: 126px;
    height: 126px;
    position: relative;
}

.cd .hole {
    width: 30px;
    height: 30px;
    position: absolute;
    background-color: #fff;
    left: 48px;
    top: 48px;
    -moz-border-radius: 15px;
    -webkit-border-radius: 15px;
    border-radius: 15px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:06:18.883

`mask`您可以使用 CSS3属性来实现该效果。目前它没有很好的浏览器支持，但如果您正在寻找 CSS3，那么您可能已经知道了。可以创建一个 SVG 蒙版（这很好，因为如果您需要这样做，它会在不模糊边缘的情况下缩放），但是，使用复合形状设置会有点困难（在正空间中的圆圈，然后负空间中的另一个圆圈）。

创建一个PNG图像很容易，它会像你`mask`这样：

```
.cd {
  background: url('../jpop.jpg') no-repeat;
  -webkit-mask: url('../my_cd_knockout.png') no-repeat;
  mask: url('../my_cd_knockout.png') no-repeat;
} 
```

这是一篇很好的文章，其中包含更多详细信息： [http ://coding.smashingmagazine.com/2011/05/11/the-future-of-css-experimental-css-properties/](http://coding.smashingmagazine.com/2011/05/11/the-future-of-css-experimental-css-properties/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T23:06:34.953

[http://jsfiddle.net/5CDnw/1/](http://jsfiddle.net/5CDnw/1/)

```
#cd {
  background: rgb(255,255,255);
  border-radius: 75px;
  width:50px;
  height:50px;        
  position:fixed;
  z-index: 100;
  left: 50px;
  top: 50px;
  border: 1px solid #aaa;
  background: #ebebe9;
}

#cover {
  position:fixed;
  border-radius: 75px;
  width:150px;
  height:150px;
  background: url(http://userserve-ak.last.fm/serve/126/23679395.jpg);   
  border: 1px solid #aaa;

}
​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T23:07:00.940

这是我要做的（使用没有面具的纯 CSS）：

1.  距离屏幕最远的图层上的图像
2.  稍后在顶部，使用 CSS3 圆圈，即 while（因为 div 是透明的，其余部分是可见的）。我会将它垂直和水平居中放置。
3.  顶部足够大的层是另一个 CSS3 圆，其半径是从中心到正方形边缘的距离。

这意味着一个圆圈将在原始图像之外通过，但您可以通过将所有这些限制在另一个 DIV 中并让最大的圆圈具有负边距来解决这个问题。

通过 CSS3 圆圈，我正在考虑使用这样的边框半径：[http](http://www.cvwdesign.com/txp/article/413/making-circles-with-css3-border-radius) ://www.cvwdesign.com/txp/article/413/making-circles-with-css3-border-radius但任何实现都应该做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T23:19:13.993

好吧，要使图像的外部变圆，您可以使用类似的东西

将以下 CSS 属性添加到您的元素以使其角变圆。

```
img#CD{
    background: url('../CD.jpg') no-repeat;
    -webkit-mask: url('../hole.png') no-repeat;
     mask: url('../hole.png') no-repeat;
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    border: 1px solid;
} 
```

要仅使右下角变圆，请使用以下 CSS。

```
img#CD{
     background: url('../CD.jpg') no-repeat;
    -webkit-mask: url('../hole.png') no-repeat;
     mask: url('../hole.png') no-repeat;
    -moz-border-radius-bottomright: 10px;
    -webkit-border-bottom-right-radius: 10px;
    border: 1px solid;
} 
```

您当然必须更改像素 (px) 值以或多或少地舍入图像。

# nosql - 通过几个键查询CouchDB数据并通过另一个字段排序数据

> ID：10965181
> 
> 赞同：0
> 
> 时间：2012-06-09T22:57:03.697
> 
> 标签：nosql, couchdb, cloudant

一般的想法，是我需要按几个值选择数据并按日期排序。

我需要像这样的 SQL 查询查询 couchdb

```
Select * from TABLE where Val = "val1" OR Val = "val2" order by Date 
```

所以我有一个地图功能看起来像

```
if(doc.type == 'item'){
  emit([doc.val, doc.date], doc);
} 
```

认为它应该是这样的

```
?startkey=[['val1','val2']]&endkey=[['val1','val2'],{}] 
```

或者

```
{keys: [['val1',{}],['val2',{}]]} 
```

是否可以？也许存在其他一些变体 - 热解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T12:54:44.720

这在 CouchDB 中是不可能的。您将必须运行两个查询（可能作为单个批量请求）并在客户端上执行最终排序（这是一个线性时间操作）。

# ruby-on-rails - 在 Rails 中将缩略图直接保存到 S3

> ID：10965185
> 
> 赞同：0
> 
> 时间：2012-06-09T22:57:57.017
> 
> 标签：ruby-on-rails, ruby

我正在使用 API 来获取缩略图。API 请求会自动下载图像。我想将该图像直接存储在我的 S3 存储桶中。为此使用像 Carrierwave 这样的东西似乎有点矫枉过正。如何进行 API 调用并将图像直接保存在 S3 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T01:00:40.860

安装 AWS S3 gem

```
sudo gem i aws-s3 
```

并按照此处的说明进行配置。

[http://amazon.rubyforge.org/](http://amazon.rubyforge.org/)

然后

```
S3Object.store('image.jpg', open('fileName.jpg'), 'bucketName') 
```

# c - 直接赋值是否有效将指针从指针数组复制到另一个变量？

> ID：10965187
> 
> 赞同：0
> 
> 时间：2012-06-09T22:58:56.223
> 
> 标签：c, pointers, memory-management

我正在尝试将一组指针复制到一个新变量。我不确定以下直接分配是否是执行复制的正确方法。

```
SVECTOR **features = (SVECTOR **) malloc(n*sizeof(SVECTOR *));
for(i = 0; i < n; i++){
    features[i] = getFeature();
}
SVECTOR **new_features = features; // Doubt: 1
SVECTOR *feature = features[0]; // Doubt: 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:09:39.653

尝试 1 给你一个别名—— features 和 new_features 引用同一个数组。尝试 2 为您提供了第一个功能的别名。

你想要的，对于一个浅拷贝（如果 getFeature() 返回的指针指向的值从未被修改或释放就足够了），是

```
SVECTOR **new_features = malloc(n * sizeof *features);
memcpy(new_features, features, n * sizeof *features); 
```

如果浅拷贝还不够，那么你需要做一个深拷贝，它需要知道一个特征的结构：

```
SVECTOR **new_features = malloc(n * sizeof *features);
for(i = 0; i < n; i++){
    new_features[i] = cloneFeature(features[i]);
} 
```

# android - 将时间选择器标题永久更改为您想要的？

> ID：10965191
> 
> 赞同：-1
> 
> 时间：2012-06-09T22:59:54.000
> 
> 标签：android

我使用设置标题

```
timePicker.setTitle("sdsd"); 
```

但是当我更改时间选择器中的时间时，标题会更改为那个时间并删除我的标题我如何将我的标题永久保留在时间选择器上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:04:41.503

1）您可以设置一个[onTimeChanged](http://developer.android.com/reference/android/widget/TimePicker.OnTimeChangedListener.html)侦听器并每次更改标题。

2）您可以每次扩展 TimePicker 并自己更改标题。

3）您可以获取 TimePicker 的[源代码](https://github.com/android/platform_frameworks_base)并将其带入您的项目中，删除更改标题的调用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-09T08:28:46.820

我用这个：

```
private TimePickerDialog prepareDialog(int hour, int minute) {
    return new TimePickerDialog(getActivity(), this, hour, minute, DateFormat.is24HourFormat(getActivity())) {
        @Override
        public void setTitle(CharSequence sequence) {
            super.setTitle("CUSTOM TITLE GOES HERE");
        }
    };
} 
```

# ruby-on-rails - 使用自定义域在 Heroku 上登录 Twitter Omniauth

> ID：10965195
> 
> 赞同：1
> 
> 时间：2012-06-09T23:01:12.667
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, omniauth

我正在尝试为 Twitter/FB 设置 Omniauth 登录。[我创建了自己的身份验证系统，并且能够在http://railscasts.com/episodes/241-simple-omniauth](http://railscasts.com/episodes/241-simple-omniauth)之后让我的 Twitter 登录在 localhost 上工作。

但是，在部署到 Heroku 后，当我尝试在生产环境中通过 Twitter 登录时出现以下错误：

```
The page you were looking for doesn't exist. 
```

Heroku 日志：

```
ActionController::RoutingError (No route matches [GET] "/auth/twitter"): 
```

这应该由omniauth 自动处理。

我将我的回调 url（带有自定义域）更改`http://www.mysite.com/auth/twitter/callback`为我的 Twitter 开发页面。这仍然不能修复生产登录，但开发登录仍然有效。

我查看了几个 stackoverflow 问题，似乎 Heroku 自定义域和 Omniauth 存在一些问题。人们使用设计有几种解决方案，但我没有使用设计。

我还使用以下方法将密钥添加到heroku：`heroku config:add CONSUMER_KEY=key CONSUMER_SECRET=secret --app myapp`

有没有人有什么建议？如果需要，我也可以发布相关代码。

# silverlight - 是否可以使用 XAML 将本地文件绑定到 Silverlight 中的图像控件？

> ID：10965196
> 
> 赞同：0
> 
> 时间：2012-06-09T23:01:22.757
> 
> 标签：silverlight, image, file, bind, local

我正在使用 Silverlight 5 编写一个 OOB 应用程序，我希望能够将文件从本地文件系统绑定到图像控件，例如

```
<Image Source="e:/user_data/sprites1.png" Stretch="Uniform"/> 
```

这可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T11:58:09.483

如果它从桌面运行，则可以在项目中配置权限，但如果它从 Web 浏览器运行，则绝对不可能从文件系统上的任何文件夹访问文件。

这是：http: [//blogs.silverlight.net/blogs/msnow/archive/2010/04/20/tip-of-the-day-112-how-to-configure-your-silverlight-app-to-运行中提升信任模式.aspx](http://blogs.silverlight.net/blogs/msnow/archive/2010/04/20/tip-of-the-day-112-how-to-configure-your-silverlight-app-to-run-in-elevated-trust-mode.aspx)

# java - JMF：无法在未实现的控制器上设置媒体时间

> ID：10965198
> 
> 赞同：0
> 
> 时间：2012-06-09T23:02:13.447
> 
> 标签：java, jmf

每次按下按钮时，我都在尝试使用 JMF 播放声音。

这就是我必须构建媒体播放器的内容：

```
MediaPlayer mp = new javax.media.bean.playerbean.MediaPlayer();
mp.setMediaLocation("file:///D:/fall.wav");
mp.setPlaybackLoop(false); 
```

而且，要播放一次声音，我会

```
mp.start();
mp.setMediaTime(new Time(0));
mp.stop(); 
```

第一次播放声音时，我得到一个

```
javax.media.NotRealizedError: Cannot set media time on a unrealized controller 
```

和

```
Exception in thread AWT-EventQueue-0" javax.media.NotRealizedError: 
  Cannot set media time on a unrealized controller 
```

在 setMediaTime 线上。这不会在我随后按下发出声音的按钮时发生，它只会在第一次发生时发生。如果我更改构造函数并添加

```
mp.realize(); 
```

最后，它不会抛出这些错误，但它也不会第一次播放声音。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T05:37:54.973

`mp.start()`是异步的。因此，当您在调用`mp.setMediaTime(new Time(0));` 后立即调用`start()`时，播放器尚未实现。你可以添加一个`ControllerListener`并监听它的事件。一旦你得到`RealizedEvent`，然后设置媒体时间。最好先致电`mp.realize()`并在获得事件时设置媒体时间，然后致电`start()`

# c++ - 如果容器元素是指针，为什么我可以从 const_iterator 调用非常量成员函数？

> ID：10965199
> 
> 赞同：4
> 
> 时间：2012-06-09T23:02:16.527
> 
> 标签：c++, iterator, constants

考虑以下代码：

```
#include <vector>
using namespace std;

struct foo
{
  void bar()
  {
  }
};

int main()
{
  {
    vector<foo*> a;
    a.push_back(new foo());
    a.push_back(new foo());
    a.push_back(new foo());

    vector<foo*>::const_iterator itr = a.begin();
    (*itr)->bar(); // compiles - this becomes more confusing 
                   // when found in a const method. On first 
                   // glance, one will (or at least me) may
                   // assume that bar() must be const if the 
                   // method where it is being called from is 
                   // const

    // The above compiles because internally, this is what happens 
    // (ignore the fact that the pointer has not been newd)
    foo* const * element;
    (*element)->bar(); // compiles

    // What I would expect however (maybe it is just me) is for const_iterator
    // to  behave something like this
    const foo* const_element;
    const_element->bar(); // compile error
  }

  {
    vector<foo> a;
    a.resize(10);

    vector<foo>::const_iterator itr = a.begin();
    itr->bar(); // compile error
  }

} 
```

我明白*为什么*可以调用它。像这样`const_iterator`存储 const-ness：`const T*`指针转换`foo* const *`为对象并转换为对象`foo const *`。

所以我的问题是，为什么我们可以从 a 调用非常量成员函数`const_iterator`？不允许从 a 调用非常量成员函数不是更直观`const_iterator`吗？带有 const 选项的 s 设计不应该`iterator`阻止这种行为吗？

现在更重要的问题是：**如果我想`const_iterator`禁止调用指向对象的非常量成员函数怎么办？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T23:11:23.853

> 带有 const 选项的迭代器设计不应该阻止这种行为吗？

确实如此。你只是期望它是一个*不同*的操作。

正如您所发现的，指针容器...包含*指针*，而不是对象。因此，`const_iterator`指向此类指针意味着指针是常量，而不是它们指向的对象。

这不会改变，也不应该改变。标准库容器通常设计为包含成熟的对象，而不是指针。所以他们不应该鼓励用户使用`vector`指针和其他可疑的结构。

如果你真的需要一个`vector`包含指针的容器，那么你应该使用一个实际*设计*的容器。像[Boost 的指针容器类](http://www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/ptr_container.html)。他们`const_iterators`使`const`正确指向的对象。他们还做其他有用的事情，比如*拥有*他们指向的对象（以便正确删除它们）等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T23:12:35.537

你有一个指针向量，指针没有成员函数，所以你没有在存储在向量中的东西上调用成员函数。

取消引用指针时获得的对象类型取决于该指针的类型。您的向量是非常量指针的向量，因此当您从容器中取消引用任何指针时，您始终会获得对指向对象的非常量引用。

如果你想要一个指针向量，那么你有两个选择。您可以改为创建一个`vector<const foo*>`，并且您将永远无法检索对任何指向对象的指针的非常量引用，或者，如果您需要能够从向量的非常量实例获取非常量引用，则必须创建一个对象，它包含作为私有成员变量的向量，并通过传递接口为您提供所需的访问权限。

如果您的向量应该拥有它持有指向您的指针的对象，则可以考虑简单`vector<foo>`，或者，如果需要动态分配，则使用`boost::ptr_vector<foo>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T23:29:33.340

> 所以我的问题是，为什么我们可以从 const_iterator 调用非常量成员函数？

“常量迭代器”意味着容器元素是常量。这并不意味着如果该元素是指针，则指向的对象也是常量。

> 如果我希望 const_iterator 禁止调用指向对象的非 const 成员函数怎么办？

我不想鼓励你使用像这样的原始指针，但如果你真的需要，让它成为一个指向 const 对象的指针的容器。

```
std::vector<const foo*> a;
// ...
auto itr = a.cbegin();
(*itr)->bar(); // Compiler error (calling a non-const method on const object). 
```

当然，在这种情况下，以下内容也将被禁止：

```
std::vector<const foo*> a;
// ...
auto itr = a.begin();
(*itr)->bar(); // Compiler error. 
```

# iphone - UIImagePickerController：视频压缩的奇怪结果

> ID：10965200
> 
> 赞同：4
> 
> 时间：2012-06-09T23:02:16.813
> 
> 标签：iphone, ios, video, uiimagepickercontroller

在我的应用程序中，用户可以录制视频或从他的库中选择一个。自然，我使用 a`UIImagePickerController`并将其`sourceType`设置为`UIImagePickerControllerSourceTypeCamera`or `UIImagePickerControllerSourceTypePhotoLibrary`。在这两种情况下`videoQuality`都设置为`UIImagePickerControllerQualityTypeMedium`。

现在，我做了以下事情：我用 iPhone 的背面拍摄了一个 15 秒的视频，所以它是漆黑的。当我从库中选择这个视频时，它大约有 0.6 MB 大。当我在我的应用程序中拍摄相同的视频（15 秒，漆黑）时，我得到一个超过 4 MB 的文件。

有人可以证实这一点吗？我简直不敢相信我是第一个注意到的人，但话又说回来，我没有太多空间可以在这里搞砸（尽管如此，我可能还是这样做了）。或者有人对此有解释/解决方案吗？

（我在 iOS 5.1 使用 iPhone 4）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T11:05:57.043

我现在想通了。解决方案不是减小尺寸，而是降低比特率。这就是我认为当您从库中选择视频时 Apple 正在做的事情。

在这里查看我的答案：[https ://stackoverflow.com/a/16035330/884119](https://stackoverflow.com/a/16035330/884119)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T02:48:47.607

你想通了吗？

现在我有同样的问题，PhotoLibrary 中的一个视频（再过 2 分钟）；当我使用 UIImagePickerController 得到它时，它只有大约 30 Mb；但是我通过**asset.defaultRepresentation**（使用这种方式（[从ALAsset获取视频](https://stackoverflow.com/questions/4545982/getting-video-from-alasset?answertab=active#tab-top)）），它达到了大约300Mb；也许 UIImagePickerController 以某种方式压缩了数据；我需要弄清楚，但没有任何进展......

=================

**编辑：[UIVideoEditorController](https://developer.apple.com/library/ios/#documentation/uikit/reference/UIVideoEditorController_ClassReference/Reference/Reference.html%23//apple_ref/occ/cl/UIVideoEditorController)可以将视频压缩到小尺寸；你可以像 UIImagePickerController 一样设置 videoQuality。**

可能是这样的：当你使用 UIImagePickerController 选择一个视频，并设置 allowEditing=YES 时，它会呈现 UIVideoEditorController 来压缩视频，然后你会得到小尺寸的压缩视频。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-02T05:53:33.680

压缩视频的最佳方式。

这是代码。

```
 -(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info{ 

    NSString *tempFilePath = [[info objectForKey:UIImagePickerControllerMediaURL] path];

   NSData *data = [NSData dataWithContentsOfURL:videoURL];

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

             NSDate *now = [NSDate dateWithTimeIntervalSinceNow:0];
             NSString *caldate = [NSString stringWithFormat:@"%@.mov",[now description]];
            caldate = [caldate stringByReplacingOccurrencesOfString:@" " withString:@""];

             NSString  *documentsDirectory = [paths objectAtIndex:0];
             NSString *path = [NSString stringWithFormat:@"%@/%@", documentsDirectory,caldate];

            NSString *mediaType = [info objectForKey: UIImagePickerControllerMediaType];
            NSURL *selectedVideoUrl;

            if (CFStringCompare ((__bridge CFStringRef) mediaType, kUTTypeMovie, 0)
                     == kCFCompareEqualTo) {

                               tempFilePath = [[info objectForKey:UIImagePickerControllerMediaURL] path];
                               selectedVideoUrl = [info objectForKey:UIImagePickerControllerMediaURL];
                     }

                   NSLog(@"old move %@",path);

        NSURL *url = [NSURL fileURLWithPath:tempFilePath];
        [data writeToFile:path atomically:YES];
        //Delete the original asset
        NSArray *paths1 = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

        NSString  *documentsDirectory1 = [paths1 objectAtIndex:0];
        NSString *path1 = [NSString stringWithFormat:@"%@/%@", documentsDirectory1,caldate];
        NSURL *url1 = [NSURL fileURLWithPath:path1];

        NSLog(@"new move %@",path);

        [self convertVideoToLowQuailtyWithInputURL:url outputURL:url1 handler:Nil];
        [picker  dismissModalViewControllerAnimated: YES]; 
```

}

```
 -(void)convertVideoToLowQuailtyWithInputURL:(NSURL*)inputURL
                               outputURL:(NSURL*)outputURL
                                 handler:(void (^)(AVAssetExportSession*))handler{

AVURLAsset *asset = [AVURLAsset URLAssetWithURL:inputURL options:nil];
AVAssetExportSession *exportSession = [[AVAssetExportSession alloc] initWithAsset:asset presetName:AVAssetExportPresetMediumQuality];
exportSession.outputURL = outputURL;
if ([[UIApplication sharedApplication]canOpenURL:inputURL]){
    NSLog(@"open");
}
exportSession.outputFileType = AVFileTypeQuickTimeMovie;
NSLog(@"errrsfseSession %@", exportSession.error);
[exportSession exportAsynchronouslyWithCompletionHandler:^(void)
 {
     if(exportSession.status != AVAssetExportSessionStatusCompleted){
         NSLog(@"exportSession  %@", exportSession.error);
     }
     if (exportSession.status == AVAssetExportSessionStatusCompleted)
     {
        NSLog(@"doneszdfsadj");

     }

 }];
    } 
```

# javascript - 在node.js中，如何声明一个可以被master进程初始化并被worker进程访问的共享变量？

> ID：10965201
> 
> 赞同：27
> 
> 时间：2012-06-09T23:02:29.227
> 
> 标签：javascript, node.js, static, cluster-computing, interprocess

我想要以下

*   在启动期间，主进程从文件中加载一个大表并将其保存到一个共享变量中。该表有 9 列和 1200 万行，大小为 432MB。
*   工作进程运行 HTTP 服务器，接受对大表的实时查询。

这是我的代码，显然没有达到我的目标。

```
var my_shared_var;
var cluster = require('cluster');
var numCPUs = require('os').cpus().length;

if (cluster.isMaster) {
  // Load a large table from file and save it into my_shared_var,
  // hoping the worker processes can access to this shared variable,
  // so that the worker processes do not need to reload the table from file.
  // The loading typically takes 15 seconds.
  my_shared_var = load('path_to_my_large_table');

  // Fork worker processes
  for (var i = 0; i < numCPUs; i++) {
    cluster.fork();
  }
} else {
  // The following line of code actually outputs "undefined".
  // It seems each process has its own copy of my_shared_var.
  console.log(my_shared_var);

  // Then perform query against my_shared_var.
  // The query should be performed by worker processes,
  // otherwise the master process will become bottleneck
  var result = query(my_shared_var);
} 
```

我尝试将大表保存到 MongoDB 中，以便每个进程都可以轻松访问数据。但是表太大了，即使有索引，MongoDB 也需要大约 10 秒才能完成我的查询。这太慢了，对于我的实时应用程序来说是不可接受的。我也尝试过 Redis，它将数据保存在内存中。但是 Redis 是一个键值存储，我的数据是一个表。我还写了一个 C++ 程序将数据加载到内存中，查询时间不到 1 秒，所以我想在 node.js 中进行模拟。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2016-04-04T08:15:54.313

如果我用几句话翻译您的问题，您需要与 WORKER 实体共享 MASTER 实体的数据。使用事件可以很容易地完成：

**从大师到工人：**

```
worker.send({json data});    // In Master part

process.on('message', yourCallbackFunc(jsonData));    // In Worker part 
```

**从工人到大师：**

```
process.send({json data});   // In Worker part

worker.on('message', yourCallbackFunc(jsonData));    // In Master part 
```

我希望通过这种方式您可以双向发送和接收数据。如果您觉得有用，请将其标记为答案，以便其他用户也可以找到答案。谢谢

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-09T23:54:07.383

您正在寻找[node.js 不支持](https://groups.google.com/group/nodejs/browse_thread/thread/27c85a6dd94b2ec6)的共享内存。您应该寻找替代方案，例如[查询数据库](http://nodejsdb.org/)或使用[memcached](http://memcached.org/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-09T23:54:25.560

在 node.js 中，fork 的工作方式与 C++ 不同。它不是复制进程的当前状态，而是运行新进程。因此，在这种情况下，变量不共享。每行代码都适用于每个进程，但主进程将 cluster.isMaster 标志设置为 true。您需要为每个工作进程加载数据。如果您的数据非常庞大，请小心，因为每个进程都有自己的副本。我认为您需要在需要时立即查询部分数据，或者在内存中确实需要它们时等待。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-03-10T06:40:54.767

如果只读访问适合您的应用程序，请尝试[我自己的共享内存模块](https://www.npmjs.com/package/mmap-object)。它`mmap`在幕后使用，因此数据在访问时加载，而不是一次全部加载。内存在机器上的所有进程之间共享。使用它非常简单：

```
const Shared = require('mmap-object')

const shared_object = new Shared.Open('table_file')

console.log(shared_object.property) 
```

它为您提供了一个常规的对象接口，用于连接字符串或数字的键值存储。它在我的应用程序中非常快。

还有一个可用于测试[的模块的实验性读写版本。](https://github.com/allenluce/mmap-object/tree/writable)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-25T09:02:33.403

您可以使用 Redis。

Redis 是一个开源、BSD 许可的高级键值缓存和存储。它通常被称为数据结构服务器，因为键可以包含字符串、散列、列表、集合、排序集合、位图和超日志。

redis.io

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-14T17:46:20.533

这种方式可以“共享一个变量”；它比@Shivam 呈现的方式更花哨。但是，该模块在内部使用相同的 API。因此，“共享内存”有点误导，因为集群中的每个进程都是父进程的一个分支。在分叉时，进程内存在操作系统内存中复制。因此，除了像 shm 设备或虚拟共享内存页面（Windows）这样的低级共享内存之外，没有真正的共享内存。我确实为 Node.js 实现了一个本机模块，它确实使用了本机共享内存（这是*真实的*共享内存），因为使用这种技术，两个进程都直接从操作系统共享内存部分读取。但是，此解决方案在这里并不适用，因为它仅限于标量值。您当然可以 JSON.stringify 并共享 JSON 序列化数据字符串，但解析/字符串化所消耗的时间对于大多数用例来说完全不理想。（特别是对于较大的对象，使用标准库实现对 JSON 进行解析/字符串化变得非线性）。

因此，这个解决方案似乎是目前最有希望的：

```
const cluster = require('cluster');
require('cluster-shared-memory');

if (cluster.isMaster) {
  for (let i = 0; i < 2; i++) {
    cluster.fork();
  }
} else {
  const sharedMemoryController = require('cluster-shared-memory');
  // Note: it must be a serializable object
  const obj = {
    name: 'Tom',
    age: 10,
  };
  // Set an object
  await sharedMemoryController.set('myObj', obj);
  // Get an object
  const myObj = await sharedMemoryController.get('myObj');
  // Mutually exclusive access
  await sharedMemoryController.mutex('myObj', async () => {
    const newObj = await sharedMemoryController.get('myObj');
    newObj.age = newObj.age + 1;
    await sharedMemoryController.set('myObj', newObj);
  });
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-01T16:38:36.897

这个问题是在 2012 年发布的，正好是 10 年前。由于没有其他答案提到它，Node.js 现在支持支持共享内存的[工作线程](https://nodejs.org/api/worker_threads.html)。

直接来自文档：

> 工作者（线程）对于执行 CPU 密集型 JavaScript 操作很有用。与 child_process 或 cluster 不同，worker_threads 可以共享内存。他们通过传输 ArrayBuffer 实例或共享 SharedArrayBuffer 实例来做到这一点。

# c# - 如何正确格式化 RadComboBox

> ID：10965204
> 
> 赞同：1
> 
> 时间：2012-06-09T23:03:47.793
> 
> 标签：c#, asp.net, css, styles, radcombobox

我正在尝试在文本左侧显示一个箭头，但我不知道如何格式化它以使其工作。

我对 rad 框的标记如下：

```
<telerik:RadComboBox ID="optionsp" runat="server" HighlightTemplatedItem="true">
     <ItemTemplate>
          <img src="../../../Themes/Images/icons/myimage.gif" />
             <div style="text-align: left; padding-left: 5px"> 
                <asp:Label runat="server" ID="Label1" Text='<%# Eval("Name") %>' > 
                </asp:Label> 
              </div> 
     </ItemTemplate>
  </telerik:RadComboBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:45:17.507

试试这个（`float: left`为 img 和 div 添加。

```
<telerik:RadComboBox ID="optionsp" runat="server" HighlightTemplatedItem="true">
     <ItemTemplate>
          <img src="../../../Themes/Images/icons/arrow2.gif" style="float: left" />
          <div style="text-align: left; padding-left: 5px; float: left"> 
                <asp:Label runat="server" ID="Label1" Text='<%# Eval("Name") %>' > 
                </asp:Label> 
          </div> 
     </ItemTemplate>
</telerik:RadComboBox> 
```

作为旁注，尽可能避免内联样式定义，您应该将它们移动到 css 文件中。

# php - 有5个分支的树状结构

> ID：10965205
> 
> 赞同：0
> 
> 时间：2012-06-09T23:03:55.260
> 
> 标签：php, javascript, mysql, html

```
+-------+------+-----------+------------+
|user_id| name | parent_id |grandparentID
+----+--------+-----------+-------------+
|  1 | one    |      NULL |     NULL   |
|  2 | two    |         1 |     NULL   |
|  3 | three  |         1 |      1     |
|  4 | four   |         2 |      1     |
|  5 | five   |         2 |      2     |
|  6 | six    |         2 |      2     |
|  7 | seven  |         2 |      2     |
|  8 | eight  |         3 |      3     |
|  9 | nine   |         3 |      2     |
| 10 | ten    |         3 |      1     |
| 11 | eleven |         3 |      2     |
+-------------+-----------+------------+ 
```

我想创建一个具有以下数据库模式的树结构如下所示

```
 One
                                  |
       two______________three______________four______________five______________Six
       |                |                  |                  |                 |
    n1 n2 n3 n4 n5   t1 t2 t3 t4 t5   h1 h2 h3 h4 h4    a1 a2 a3 a4 a5   s1 s2 s3 s4 s5 
```

我写了以下代码

```
<?php   
    function display_tree() {  
        $result = $this->qry("SELECT * FROM users WHERE Parent='?' or Parent ='?';" ,
        'in(select id from user_id from users where Parent = "'.$_SESSION['id'].'")', $_SESSION['id']); 

        echo '<div align="center">'.$_SESSION['name'].'<br></div>';
        echo '<div align="center">|</div>';
        echo '<div align="center">';
        while( $row=mysql_fetch_assoc($result)){
            echo "___".$row['name'].$row['user_id'].'';
        };
        $result1 = $this->qry("SELECT * FROM users where grandParent='".$_SESSION['id']."'");
        echo '<br>|<br>';
        while( $row1 =mysql_fetch_assoc($result1)){ 
            echo "--".$row1['name'];  
        }
        echo '</div>';
    }
?> 
```

这是它显示的内容

```
 one
               |
    ___two___three
               |
  --four--five--six--seven--eight-- 
```

但我希望按上面的顺序排列，而不是这个，我已经阅读了教程，但它们都停留在右左分支上，似乎没有一个涉及我的类型

任何指向好例子的链接，我会很高兴

对我的问题的任何见解也会对我有很大帮助

我似乎已经为我解决了问题提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:02:17.540

我建议使用某种插件，例如 jquery 插件，它可以为您构建树，这里有几个插件。

[http://jquery.bassistance.de/treeview/demo/](http://jquery.bassistance.de/treeview/demo/)

[http://www.jqwidgets.com/jquery-widgets-demo/#demos/jqxtree/treebindingtojson.htm](http://www.jqwidgets.com/jquery-widgets-demo/#demos/jqxtree/treebindingtojson.htm)

[https://github.com/pioz/jquery-tree](https://github.com/pioz/jquery-tree)

# asp.net-mvc - 找不到类型“System.Data.Entity.Infrastructure.SqlConnectionFactory”的构造函数

> ID：10965210
> 
> 赞同：4
> 
> 时间：2012-06-09T23:05:12.440
> 
> 标签：asp.net-mvc, entity-framework, windows-8, visual-studio-2012, entity-framework-5

我昨天将我的电脑从 Windows 7“升级”到了 Windows 8，所以现在我正在使用 Visual Studio 2012，并打开我的 Visual Studio 2010 项目。

这个项目一直运行良好，但在 Visual Studio 2012 中不起作用。我遇到了一些奇怪的错误，但我修复了这些错误。现在，我遇到了一个无法修复且在 Google 上找不到任何相关信息的错误：

我得到这个例外：

> 未能将 Database.DefaultConnectionFactory 设置为应用程序配置中指定的“System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework”类型的实例。有关详细信息，请参阅内部异常。

带有以下内部异常：

> 找不到类型“System.Data.Entity.Infrastructure.SqlConnectionFactory”的构造函数。

我的 Web.Config 看起来很标准：

```
 <connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=aspnet-WebUI-201253192737;Integrated Security=True" providerName="System.Data.SqlClient" />
  </connectionStrings>

  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="Data Source=.\SQLEXPRESS; Integrated Security=True; MultipleActiveResultSets=True" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework> 
```

SqlConnectionFactory 类存在，它有 2 个构造函数（一个无参数，一个接受连接字符串）。我通过在我的 C# 代码中创建一个 SqlConnectionFactory 来测试它。

我已经删除了实体框架并重新安装了它，但这并没有解决问题。

我正在使用 Entity Framework 5.0 RC（如前所述在 VS2010 中运行良好）与 SQL Server 2012 + 工具和 IIS express。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T20:16:11.797

我解决了这个问题。我改变了这个：

```
 <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="Data Source=.\SQLEXPRESS; Integrated Security=True; MultipleActiveResultSets=True" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework> 
```

至：

```
 <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" />
  </entityFramework> 
```

现在它可以工作了。不过有点愚蠢，我想提供连接字符串作为参数。

我通过在 VS 2012 中使用实体框架创建新的 MVC 4 项目并比较 Web.Config 文件发现了这一点。我注意到另一个不同之处。

我的实体框架程序集的版本为 4.4.0.0（尽管我从 NuGet 安装了 5.0 RC）。我创建的新项目有一个版本为 5.0.0.0 的程序集。谁能解释一下？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T10:24:28.170

您可以检查几件事：

*   它正在尝试连接到 SQL Express。是否安装了 SQL Express？升级 windows 时安装是否发生了问题。
*   尝试连接到 SQL Express 的程序的安全上下文是什么？会不会是权利问题？

**编辑**更多的想法：

*   与为项目选择的 .net 框架版本相关
*   涉及到EF是如何引用的，都是引用的吗？复制本地=真？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-12T05:29:29.100

I believe a good way to upgrade from EF v4.3 to Ef v5.0 for existing projects is to use the Nuget command

```
update-package EntityFramework -pre 
```

This updates the **configsection** in the config file to EF 5

# c - 为什么宽字符问题？

> ID：10965213
> 
> 赞同：3
> 
> 时间：2012-06-09T23:05:52.173
> 
> 标签：c, ncurses

在尝试使用 ncurses 进行一些工作时，我已经到了需要使用宽字符来绘制方框图以及其他东西的地步，而且我处于每个图块控制很有用的情况。

但是，当尝试使用以下代码时，我遇到了麻烦：

```
#define _XOPEN_SOURCE_EXTENDED

#include <locale.h>
#include <curses.h>
#include <stdlib.h>
#include <time.h>

#define ESC 27

int main() {
  setlocale(LC_CTYPE, "");

  initscr();
  keypad(initscr(),1);
  curs_set(9);
  nonl();

  cchar_t special;
  setcchar(&special, L"æ", 0, COLOR_PAIR(0), NULL);

  cchar_t speshul;
  setcchar(&speshul, L"朝", 0, COLOR_PAIR(0), NULL);

  int c=0;
  do {
    clear();

    mvadd_wch(3,6, &special);
    mvadd_wch(4,6,&speshul);

    refresh();

  } while ((ESC!=(c=getch())));

  endwin();
} 
```

**编辑：**

更新了要使用的代码`setcchar`；输出令人沮丧：

```
? 
```

一个问号`special`应该在哪里，什么也不`speshul`应该在哪里。

两个角色都没有按预期出现。

问题出在哪里，我该如何解决？

**编辑：**回应Petesh的一些额外信息：

预期的结果是打印字符“æ”，在其下方，朝。我在 Mac OS X 上使用 Terminal.app；我正在编译它 Xcode。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-12T08:10:47.550

您的代码中还有许多其他“问题”，其中一些可能与您的宽字符问题有关：

* * *

```
initscr();
keypad(initscr(),1); 
```

避免`initscr()`无缘无故打两次电话。将第一次调用的结果存储在`WINDOW`指针中，或者简单地使用内置的`stdscr`. 还要避免`bool`值的数字常量，更喜欢命名常量`TRUE`和`FALSE`. 语义完全不同。

所以使用：

```
WINDOW *screen = initscr();
keypad(screen, TRUE); 
```

或者

```
initscr();
keypad(stdscr, TRUE); 
```

* * *

```
curs_set(9); 
```

`9`不是 的有效参数`curs_set()`。来自手册：*“curs_set 例程将光标状态设置为不可见、正常或非常可见，**可见性**分别等于**0**、**1**或**2** ”*

* * *

```
setcchar(&special, L"æ", 0, COLOR_PAIR(0), NULL); 
```

的第四个参数`setcchar()`是`short color_pair`。它需要一个颜色对*number*，而不是它的*属性掩码*（应该应用于 a `chtype`）。我同意，这没有很好的记录。using`COLOR_PAIR()`仅适用于对 0。对于任意对，例如 pair `4`，使用：

```
setcchar(&special, L"æ", WA_NORMAL, 4, NULL); 
```

也使用`WA_NORMAL`代替`0`. 不要依赖常量值，使用命名的值！

* * *

```
while ((ESC!=(c=getch()))) 
```

您还应该测试`ERR`退货。不要假设`c`将始终包含有效的字符代码：

```
while ((c=getch()) != ERR && c != ESC) 
```

另外，如果你真的想`ESC`用作打破循环的角色，你应该阅读关于`ESCDELAY`. 默认情况下，在用户按下 ESC 和该键对您的程序可用之间需要一整秒钟的时间。简单来说，原因是 ESC 也用于启动*转义序列*，因此 curses 必须等待查看 ESC 后面是否有其他控制字符，然后才能确定它是一个孤立的按键。所以你无法避免延迟，但你可以将它减少到一个不太可感知的时间，比如 100 毫秒。这必须*在初始化诅咒之前设置！*

```
setenv("ESCDELAY", 100, FALSE); 
```

`getch()`在宽字符世界中使用时要小心。`get_wch()`对于一个简单的“循环直到 ESC”，这很好，但是当您想要实际解析用户输入时替换它。

* * *

最后，您不需要将语言环境设置为`"en_US.UTF-8"`，因为这将覆盖用户的语言环境。如果您的终端设置为非字符编码`UTF-8`，或者您的语言不是，该`en_US`怎么办？只需将您的程序设置为使用*用户环境中设置的任何语言环境*：

```
setlocale(LC_ALL, ""); 
```

这与根本不设置语言环境有很大不同，因为默认情况下，语言 C 假定语言环境是`C`，即仅 7 位 ASCII 字符。诅咒尊重这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T00:34:31.053

事实证明，魔鬼在细节中。

原来我的问题是对语言环境的调用：

```
 setlocale(LC_CTYPE, ""); 
```

它应该是：

```
 setlocale(LC_ALL, "en_US.UTF-8") // or similar 
```

解决问题的设置，字符现在可以正确显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T00:14:53.533

你需要问以下问题：

1.  预期的结果是什么（因为它适用于我的系统）
2.  您使用的终端是什么 - 即操作系统（windows/etc）、应用程序
3.  您是否在正在编译的窗口中编辑文件
4.  如果您的环境没有正确解释它，并且假设文件处于 UTF-8 模式，您可能想在编译行尝试 --encoding=UTF-8。如果您使用的是 Windows，则可以只使用 UCS-16 作为编码。

# ios - 关于静态单元与动态单元的混淆

> ID：10965214
> 
> 赞同：20
> 
> 时间：2012-06-09T23:06:10.900
> 
> 标签：ios

我试图弄清楚除了动态单元格之外如何拥有一些静态单元格（我认为），但是当我启动一个新的 Master-Detail 应用程序并将默认的动态原型切换为静态单元格时，它会崩溃。

我认为，由于我还是新手，所以我不明白所有组件（表格视图、单元格、委托）是如何连接的。切换到静态单元后，我制作了三个单元，但它们没有出现。该应用程序只是崩溃。

我可以包含代码，但基本上，我创建了一个新的主从细节，切换到静态单元格，更改三个单元格的名称，然后它崩溃了（在主循环中）。

提前感谢一切。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-06-10T00:00:06.573

如果我理解您的问题，这就是您正在寻找的解释：

**原型（可重用性）：**

当您使用***动态单元格***时，您使用***原型单元格***。这意味着无论是在 IB 中还是在您的代码中，您都可以创建 的实例`UITableViewCell`，并为其指定标识符 ( `reuseIdentifier`)。使用`UITableView`此***原型***生成所需数量的单元格（行）。`UITableView`为填充屏幕所需的尽可能多的单元创建（并使用内存）。一旦这些细胞中的一些离开屏幕，就可以`UITableView` ***重复使用***它们——***回收***它们。

您可以在***一个***`UITableView`. 这个想法是每个原型都有不同的用途。例如，您定义了一个只有一个大的原型单元格，`UILabel`其目的是使用静态文本。你定义了另一个只有一个的原型`UIImageView`。这取决于您的设计以及您希望如何显示数据。

要使用原型单元格，在 IB 中，您使用***动态原型单元格***，并设置一个`identifier`. 然后你必须实现`UITableViewDataSource`方法，例如：

> ```
> – tableView:numberOfRowsInSection: 
> – tableView:cellForRowAtIndexPath: 
> ```

这些方法是 UITableView 的委托方法。

如果不使用 IB，您将在`– tableView:cellForRowAtIndexPath:`方法中创建单元格：

> UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier];

**静止的：**

静态单元的想法很简单。您可以使用原型单元（例如，只有一个原型）并输入一个静态`NSArray`的，例如，作为数据源。为了承担实现`UITableViewDataSource`方法的任务，Apple 引入了静态单元，您将只使用情节提要和 IB。在 IB 中，您选择表格视图，然后选择***静态单元格***，然后输入您的文本，或设置图像。您不希望稍后在应用程序运行时对静态单元格进行任何动态更改，因为这并不意味着您将不得不实现更多不值得的方法。虽然获取所选行的工作量不大`indexPath`，但想法是如果您需要从选择的静态单元格中推送新视图，您将使用 segues，而不是实现任何代码。

使用静态单元格时，您不应该实现`UITableViewDataSource`方法，否则您的应用程序会崩溃，反之亦然，如果您`UITableViewDataSource`在使用原型单元格时不实现方法（必需的），您的应用程序会崩溃。

# c - 带有 NULL 条件的 for 循环，为什么 printf(); 执行？

> ID：10965221
> 
> 赞同：1
> 
> 时间：2012-06-09T23:07:05.463
> 
> 标签：c, for-loop, null

```
‎#include<stdio.h>

int main()
{
  for(;NULL;)
    printf("STACK");

  return 0;
} 
```

输出：堆栈我知道 NULL 的 ascii 值为 0，它是错误的，但是当我在 turbo c 上运行时，这个程序给出输出“堆栈”，这是怎么可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T23:10:56.277

“堆栈”从不输出。这是因为`for`语句的条件部分始终为假（假设`NULL`d`#define`为`(void *)0`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T08:15:32.223

turbo c 编译器是古老的（20 岁）。您看到的行为是一个错误。16 位应用程序未在您的操作系统（Win7 ？）上正确运行。

作为一种解决方法，您可以将 NULL 值分配给一个变量并在 for 循环的条件下使用它，或者甚至更好地切换到更新的编译器。像[wxdev-cpp](http://wxdsgn.sourceforge.net/)

# java-ee-6 - javaee6中的Seam文件组件

> ID：10965227
> 
> 赞同：0
> 
> 时间：2012-06-09T23:09:03.123
> 
> 标签：java-ee-6, seam2

我正在尝试在 javaee6 中复制 seam 属性文件的加载，但仍然不知道从哪里开始。

在 seam 中，我们可以通过在 components.xml 中定义属性文件来将其加载为 seam 组件：

```
<component name="propertyBean" class="PropertyBean" scope="application" auto-create="true" startup="true">
    <property name="filename">myPropertyFile.properties</property>
    <property name="reload">true</property>
</component> 
```

然后我们可以在代码中访问它：

```
PropertyBean.getInstance().getProperty("myProperty"); 
```

是否有可以复制此功能的 javaee6 功能？或者在春天它被称为 PropertyPlaceholder。

在 C# 中，我们可以通过在 appsettings.xml 中添加配置属性来实现。并通过 ConfigurationManager 访问。

谢谢，
czetsuya

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T03:07:03.810

不幸的是，没有什么能像从 seam 到 javaee6 的属性组件管理器，但我能够找到类似的东西，一个属性加载器。

它通过有一个限定符来工作：

```
@Qualifier
@Retention(RUNTIME)
@Target({METHOD, FIELD, PARAMETER, TYPE})
public @interface ConfiguredBy {
    @Nonbinding public String value();
} 
```

使用用作属性文件名称的参数。

整个方法在这里描述：http: [//john-ament.blogspot.com/2010/03/writing-property-loader-in-java-ee-6.html](http://john-ament.blogspot.com/2010/03/writing-property-loader-in-java-ee-6.html)

# java - UTF8 Bomless vs Cp1252

> ID：10965228
> 
> 赞同：0
> 
> 时间：2012-06-09T23:09:20.987
> 
> 标签：java, eclipse, unicode

从物理字节流的角度来看，对于每个使用 UTF8 存储的文件，我认为 UTF8 bomless 与 Cp1252 完全相同，是这样吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T23:28:14.387

绝对不是真的。如果你想让它成为一个真实的陈述，你需要添加“如果我只使用 US-ASCII 字符”这个子句。但这是一个巨大的“如果”。如果我们只使用 US-ASCII 字符，许多编码甚至都不存在。许多编码（包括 UTF-8）确实确保所有 US-ASCII 字符都使用相同的单字节表示进行编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T19:12:46.123

不。 UTF-8 不仅涵盖了更大的字符集，而且任何高于代码点的 unicode 字符`U+7f`都将在 UTF-8 中由多个字节编码，在 CP-1252 中由单个字节编码。CP-1252 和 ISO-8859-1（也称为 Latin-1）之间有更密切的对应关系，但即使是这些也有细微但重要的不同之处。这种差异解释了出现的许多最常见的编码问题。

举一个例子，左单大引号由 unicode codepoint 表示`U+2018`。在 CP-1252 中，这被编码为 byte `0x91`。这个字符在 Latin-1 中根本不存在，而在 UTF-8 中，它是由三字节序列编码的 `0xe28098`。

更一般地说，可以说 Latin-1 和 UTF-8 是基于 Unicode 的编码，因为所有编码都可以通过算法映射到一个 unicode 代码点，并表示该字符，而 CP-1252 是一种非 unicode-基于编码。用于表示字符的字节与其 unicode 代码点之间没有规律的对应关系。

# c - 让字符串解析循环工作

> ID：10965229
> 
> 赞同：0
> 
> 时间：2012-06-09T22:06:31.050
> 
> 标签：c

我正在开发我的第一个 C 程序，它需要根据需要构造和解构字符串。不过，我不知道如何正确地做到这一点。有人可以解释一下吗？

据我所知，这是我的代码：

```
int main( int argc, char ** argv ) 
{ 
    if ( argc != 2 ) 
    { 
        _print_help(); /* defined above main() */ 
        exit(0); 
    } 

    char *s = argv[1]; 
    char *val = ""; 
    register int i; /* no idea why I need "register" and not just int */
    for(i=0;s[i];++i) /* loop over the string, take each character 
    {                    and add it to another string */
        strcat(val,s[i]); 
        printf("v:%s;\n",val); 
    } 
    printf("expression: %s\n",s); 
} 
```

gcc 从 make 文件中调用（使用 autotools 生成）：

```
gcc -DHAVE_CONFIG_H -I.     -g -O2 -MT c-calc.o -MD -MP -MF .deps/c-calc.Tpo -c -o c-calc.o c-calc.c 
```

现在它会发出警告，我不应该将整数作为 strcat 的第二个输入，并且 string3.h 期望`const char * __restrict__`而不仅仅是 a `char`（我必须翻译它们，因为我的 Ubuntu 用德语与我交谈）。激活我编译的程序会抛出一个`Memoryaccess error`，然后程序返回`139`似乎意味着[Segmentatation 违规](http://www.slac.stanford.edu/BFROOT/www/Computing/Environment/Tools/Batch/exitcode.html)的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T22:32:39.310

非常适合第一个程序；）首先我编写了一个程序来执行您想要的操作，然后我将对其进行更多解释。

```
int main( int argc, char ** argv ) 
{ 
    if ( argc != 2 ) 
    { 
        _print_help(); /* defined above main() */ 
        exit(0); 
    } 

    char *first_arg = argv[ 1 ] ;
    char val[ 1024 ]; //You should make enough memory to hold all the strings concatenated to each other. Here we suppose that 1024 is enough.

    strcpy( val , "" ) ; //Since val is an accumulator it should be initialized first.

    for( int i = 0 ; i < strlen( first_arg ) ; i++ ) /* loop over the string, take each character and add it to another string */
    {
        char char_str[ 2 ] ;
        char_str[ 0 ] = first_arg[ i ] ;
        char_str[ 1 ] = '\0' ;

        strcat( val , char_str ) ; 
        printf( "v:%s;\n" , val ) ; 
    }

    printf( "expression: %s\n" , val ) ; 
} 
```

好吧，让我们更好地解释一下。首先，你应该知道什么是指针。指针只是一个数字，它指向内存中的一个位置（通常是堆内存）。当您定义`char *val`它时，它只不过是一个指针，并且在它后面没有分配任何内容。您必须使用以下命令对其进行初始化。

```
char val[ 1024 ] ;
char *val = new char[ 1024 ] ; 
```

这些命令是不同的。实际上，第一个命令从堆栈中分配所需的内存（1024 字节）。但前者从堆内存中获得 1024 个字节。前者不需要被释放，因为当你离开它的包含块时，它会被释放。但是第二个命令需要由程序员使用此命令手动释放：

```
delete [] val ; 
```

关于这些行：

```
char char_str[ 2 ] ;
char_str[ 0 ] = first_arg[ i ] ;
char_str[ 1 ] = '\0' ; 
```

`first_arg`是一个指向 的指针`argv[ 1 ]`，这意味着它们拥有相同的地址。字符不同于 C/C++ 中的字符串。`'A'`不同于`"A"`. C/C++ 中的所有字符串都应以`'\0'`字符结尾。`"A"`可以看作是**一个有 2 个字符的字符串，第一个是`'A'`，第二个是`'\0'`**。同样 strcat() 方法总是连接 2 个字符串，所以我必须构建一个字符串。一个有 2 个单元格的字符，如果我想要的字符是第一个，下一个是一个`'\0'`字符。现在我可以使用这个字符串将它添加到 val 中。

# android - 为什么全局应用程序上下文不适用于“getassets”

> ID：10965231
> 
> 赞同：0
> 
> 时间：2012-06-09T23:09:28.113
> 
> 标签：android

刚刚解决了我的 Android 应用程序中的一个错误。我试图使用 getAssets() 从我的资产目录中提取文件。我将 Application 子类化并返回了一个“getApplicationContext”对象，这样我的所有类都可以在需要时使用上下文。

但是在经历了很多头痛和 NullPointerExceptions 之后，事实证明我需要传递一个本地上下文变量并改用它。如果我使用全局应用程序上下文，getAssets 不起作用！

那么这是为什么呢？使它起作用的局部上下文变量有什么特别之处。我认为任何旧的“上下文”变量都足以访问必要的方法并使它们正常工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:20:54.837

本地上下文变量也是一个活动。Activity 提供了您使用 getAssets() 调用的 AssetManager 使用的额外功能。为了避免内存泄漏，Android 严格使用上下文而不是活动。你应该几乎总是使用你的 Activity 的上下文。

# git - 如何使用接收后挂钩根据更新的分支有条件地运行命令？

> ID：10965235
> 
> 赞同：2
> 
> 时间：2012-06-09T23:09:51.897
> 
> 标签：git, shell, githooks

我在虚拟服务器上编写了以下接收后挂钩，以便它将存储库的开发和生产版本复制到运行每个版本的站点的开发和生产目录中。

以下是我写的post-receive hook。如何根据刚刚推送的分支有条件地刷新一个或另一个？

```
#!/bin/sh

if [ -n $GIT_DIR ]; then
    unset GIT_DIR
    cd ..
fi

echo "Deploying to dev"
git checkout develop
umask 002 && git reset --hard
cp -r /path/to/git/files/* /path/to/dev/site/

echo "Deploying to prod"
git checkout master
umask 002 && git reset --hard
cp -r /path/to/git/files/* /path/to/prod/site/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:35:21.633

接收后挂钩接收标准输入 3 个变量：旧版本、新版本和参考名称 - 这正是您所需要的。您可以通过以下方式改进您的脚本：

```
read oldrev newrev refname 
```

并根据 refname 包含的内容（即：refs/heads/master）做一些 ifs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:43:11.930

您想遍历更新的分支并将任何更新部署`develop`到开发站点，并将任何更新部署`master`到生产站点，对吗？试试这个：[http ://blog.ekynoxe.com/2011/10/22/git-post-receive-for-multiple-remote-branches-and-work-trees/](http://blog.ekynoxe.com/2011/10/22/git-post-receive-for-multiple-remote-branches-and-work-trees/)

# java - 将反斜杠替换为斜杠时出现异常

> ID：10965236
> 
> 赞同：0
> 
> 时间：2012-06-09T23:09:58.007
> 
> 标签：java, jsp, str-replace

在我的应用程序中，我需要为 JSP 页面中的 XML 文件准备一个路径。我正在做这样的事情：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/xml"  prefix="x" %>
<!DOCTYPE html>
<c:set var="abs_path" value='<%= getServletContext().getRealPath("").replace(" ", "%20").replace("\\", "/") %>' /> 
```

但是有一个问题，我得到以下异常：

org.apache.jasper.JasperException：无法为 JSP 编译类：

```
An error occurred at line: 6 in the jsp file: /users.jsp
String literal is not properly closed by a double-quote
3: <%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
4: <%@ taglib uri="http://java.sun.com/jsp/jstl/xml"  prefix="x" %>
5: <!DOCTYPE html>
6: <c:set var="abs_path" value='<%= getServletContext().getRealPath("").replace(" ", "%20").replace("\\", "/") %>' /> 
```

显然是关于这部分：`.replace("\\", "/")` 当我删除它时，我没有得到这个异常。

那是怎么回事？我将非常感谢任何线索。

编辑：

我通过以下方式使用此变量：

```
 <c:import url="file:/${abs_path}/MyProject/xml/users.xml" var="inputDoc" charEncoding="UTF-8" />

                <c:import url="xsl/users_list.xsl"
                        var="stylesheet" charEncoding="UTF-8" />

                <x:transform 
                     xml  = "${inputDoc}"
                     xslt = "${stylesheet}">
                </x:transform> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:14:08.180

# fonts - Google Web Font 呈现浏览器的差异

> ID：10965238
> 
> 赞同：7
> 
> 时间：2012-06-09T23:10:10.867
> 
> 标签：fonts, font-face, google-webfonts

我决定使用 Google 网络字体“Signika”：[http ://www.google.com/webfonts/specimen/Signika](http://www.google.com/webfonts/specimen/Signika)

虽然我非常喜欢这种字体在正确渲染时的外观，但一些浏览器或平台并没有为他们的用户提供这种奢侈。

这是我观察到的：

*   Arch Linux - 最新的 Chromium - 完美
*   Arch Linux - 最新的 Firefox - 完美
*   Win7 64 位 - 最新的 Chrome - 差（如果我没记错的话，与右图相同）
*   Win7 64 位 (virtualbox VM) - 最新的 Firefox - 差（见下图）
*   Win7 64 位 (virtualbox VM) - IE9 - 完美？？（见下图）

最后2个让我吃惊。这是左侧IE9和右侧Firefox渲染的比较。两者都在同一台机器上（Win7 64 位 virtualbox VM）。

![IE9 与最新的 Firefox](../Images/69026d415f1c4ce89040c4cabbdb5964.png)

左边的那个看起来像是被平滑了——像素不是黑色或白色，而是介于两者之间。右边的那个看起来只使用了 2 种颜色。

当 IE9 的浏览器模式设置为 IE8 或 IE7 时，字体开始看起来像在该机器上的 Firefox 中（不流畅）。

我试图理解这一点。到底发生了什么，有什么办法可以让它看起来很流畅？我四处寻找类似的问题并尝试了以下建议的修复/解决方法：

```
font-smooth: always;
-webkit-font-smoothing: antialiased; 
```

和

```
text-shadow:0 0 1px transparent; 
```

没有效果。（用最新的 Firefox 在 Win7 64 位（virtualbox VM）上尝试过）

任何建议，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T20:49:42.137

[在与本文](http://blog.wax-o.com/2012/11/font-face-rendering-problem-in-chrome-and-firefox-use-postscript-outlines/)链接的 webfonts 下的[早期帖子](https://stackoverflow.com/questions/13118509/serve-postscript-outlines-like-typekit)中的评论。它解释说，如果您决定自行托管，则应使用 Postscript 大纲转换为 webfonts。

由于您使用的是 Google Webfont，它是开源的。在使用 CSS 调整字体平滑之前，您可以尝试这种技术。

# symfony - Symfony 2 拆分更少的文件

> ID：10965240
> 
> 赞同：1
> 
> 时间：2012-06-09T23:10:24.467
> 
> 标签：symfony, less, assetic

我正在使用 Symfony 2 构建一个网站并使用 Less，就像这样

index.html.twig：

```
{% stylesheets
    '@AcmeWebappBundle/Resources/public/css/website.less'
    filter='?yui_css'
%}
<link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %} 
```

配置.yml：

```
assetic:
    filters:
        lessphp:
            file: %kernel.root_dir%/../vendor/lessphp/lessc.inc.php
            apply_to: "\.less$" 
```

现在文件`website.less`增长了很多，所以我决定将它分成不同的文件，如下所示：

```
{% stylesheets
    '@AcmeWebappBundle/Resources/public/css/mixins.less'
    '@AcmeWebappBundle/Resources/public/css/general.less'
    '@AcmeWebappBundle/Resources/public/css/tasks.less'
    '@AcmeWebappBundle/Resources/public/css/notes.less'
    filter='?yui_css'
%}
<link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %} 
```

该文件`mixins.less`包含`mixins`我在其他文件中使用的所有内容。

问题是，如果我在 中引用 mixin `notes.less`，则无法识别 - 我相信这是因为 Assetic 仅在它正在编译的文件中搜索 mixin。顺便说一句，我使用的是lessphp，而不是node.js。

我该如何解决我的问题？如何使用 mixins.less 文件中声明的 mixins 拥有不同的 Less 文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T08:23:12.860

在您的示例中，您需要保留 website.less 并让它导入所有相关的 less 文件，如下所示：

网站.less：

```
/* import the necessary less files */
@import "mixins.less";
@import "general.less";
@import "tasks.less";
@import "notes.less"; 
```

index.html.twig：

```
{% stylesheets
    '@AcmeWebappBundle/Resources/public/css/website.less'
    filter='?yui_css'
%}
<link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %} 
```

这样，您可以为您的控制器或位于同一个包中的包减少几个文件，只需导入标记所需的相关文件（例如`frontend.less`，，，`backend.less`）`mobile.less`。

我鼓励您查看 Twitter Bootstrap 如何[处理导入并很好地分离所有内容](https://github.com/twitter/bootstrap/blob/master/less/bootstrap.less)。

# c++ - 编译时数组常量

> ID：10965241
> 
> 赞同：11
> 
> 时间：2012-06-09T23:10:47.540
> 
> 标签：c++, templates, standards, compile-time-constant

我似乎遗漏了一些相当基本的东西。我试图在编译时使用 const 数组成员。

```
const int list[3] = { 2, 5, 7 };
const int a = list[2]; // this doesn't error?

template<int N1, int N2>
struct tmax {
  enum { value = ((N1 > N2) ? N1 : N2) };
};

const int b = tmax<2,4>::value;
const int c = tmax<list[0],list[1]>::value; // error is here

int main()
{
  return 0;
} 
```

错误：

```
prog.cpp:10:24: error: 'list' cannot appear in a constant-expression
prog.cpp:10:30: error: an array reference cannot appear in a constant-expression 
```

这是[相关的 IDEOne 链接](http://ideone.com/Iuk1r "相关 IDEOne 链接")

那么为什么这不起作用呢？我错过了什么？我应该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T23:18:04.493

仅仅因为一个对象`const`并不意味着它是一个编译时常量表达式。

```
main.cpp:10:20: error: non-type template argument is not a constant expression
const int c = tmax<list[0],list[1]>::value; // error is here
                   ^~~~~~~
main.cpp:10:20: note: read of non-constexpr variable 'list' is not allowed in a constant expression
main.cpp:1:11: note: declared here
const int list[3] = { 2, 5, 7 };
          ^ 
```

这是原因`constexpr`：

```
constexpr int list[3] = { 2, 5, 7 };

template<int N1, int N2>
struct tmax {
    enum { value = ((N1 > N2) ? N1 : N2) };
};

const int b = tmax<2,4>::value;
const int c = tmax<list[0],list[1]>::value; // works fine now 
```

至于为什么会这样：

```
const int a = list[2]; // this doesn't error? 
```

初始化`const`变量不需要常量表达式：

```
int foo(int n) {
    const int a = n; // initializing const var with a non-compile time constant 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T23:35:50.527

如果表达式包含许多不允许的子表达式中的任何一个，则表达式不是*常量表达式。*一类不允许的子表达式是：

> *   左值到右值的转换（4.1），除非它应用于
>     
>     *   一个整数或枚举类型的左值，它引用一个非易失 const 对象，该对象具有前面的初始化，用常量表达式初始化，或者
>     *   一个字面量类型的左值，它指的是用 定义的非易失性对象`constexpr`，或者指的是这样一个对象的子对象，或者
>     *   一个字面量类型的左值，它引用一个生命周期尚未结束的非易失性临时对象，用一个常量表达式初始化；

特别是，当使用常量初始化器初始化的枚举或整数类型的 const 对象的名称形成一个*常量表达式*（读取其值是导致左值到右值转换的原因）时，一个 const 聚合对象的子对象（例如如`list`在您的示例中，数组）不会，但如果声明`constexpr`.

```
const int list[3] = { 2, 5, 7 };
const int a = list[2]; 
```

这是有效的，但`a`不构成*常量表达式*，因为它不是用*常量表达式*初始化的。

通过更改 的声明`list`（我们不必更改 的声明`a`），我们可以使`a`form 成为一个常量表达式。

```
constexpr int list[3] = { 2, 5, 7 };
const int a = list[2]; 
```

由于`list[2]`现在是一个*常量表达式*，`a`现在是一个用*常量表达式*`const`初始化的整数类型的对象，因此现在可以用作常量表达式。*`a`*

# python - Django过滤/排除给出错误结果，为什么？

> ID：10965245
> 
> 赞同：0
> 
> 时间：2012-06-09T23:11:39.057
> 
> 标签：python, django, django-models

我有一个 django 查询，它给了我一个错误的查询集。从以下单个查询中，它应该给我 1 - 0 = 1，但它给了我 0 个结果。为什么会这样？

```
>>> MessageThread.objects.filter(message__recipient=p2)
[<MessageThread: message thread one>]
>>> MessageThread.objects.filter(message__status='deleted', message__recipient=p2)
[]
>>> MessageThread.objects.filter(message__recipient=p2)
    .exclude(message__status='deleted', message__recipient=p2)
[] 
```

我将如何构建查询以获取 query1 - query2？这是我在sql中需要的：

```
SELECT * FROM messaging_messagethread 
WHERE id NOT IN 
    (SELECT DISTINCT thread_id FROM messaging_message 
     WHERE status = 'deleted' AND recipient_id=4) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:50:58.897

您放在排除或过滤参数中的查找在解析为 SQL 语句时会进行与运算。因此，在您的最后一个查询中，您正在执行此操作（英文）：

> 给我所有具有“p2”作为收件人的消息的 MessageThread 对象，并从这些对象中退出所有“已删除”作为状态和“p2”作为收件人的消息。

所以基本上，你排除了你过滤的东西。如果您想获取所有以“p2”为收件人但未被删除的邮件，您可以执行以下操作：

**编辑**好的，现在我明白你需要什么了。所以你基本上只想要你的问题的查询的排除部分。我认为你需要这个：

```
MessageThread.objects.exclude(message__status='deleted', message__recipient_id=4) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T12:49:59.880

未经测试（显然，因为我没有在本地安装您的项目），但这应该可以工作：

```
exclude_ids = Message.objects.filter(
    status="deleted", recipient_id=4
    ).values_list("thread_id", flat=True)
MessageThread.objects.exclude(id__in=exclude_ids) 
```

注意：我没有添加`distinct`子句，因为它不一定适用于排序，而且我不知道您是否在模型中使用了排序。

# javascript - Javascript 在控制台中运行，但不在 contentscript 中

> ID：10965248
> 
> 赞同：1
> 
> 时间：2012-06-09T23:12:14.477
> 
> 标签：javascript, jquery, google-chrome-extension, content-script

[这是对此问题](https://stackoverflow.com/questions/10964236/inserting-a-link-to-a-dupe-in-the-close-popup-here-on-stackoverflow)的后续问题。简短版本是：我正在尝试使用 javascript（Chrome 扩展程序）在关闭投票弹出窗口中的文本字段中插入一个欺骗链接（在 Stack Overflow 上关闭投票作为欺骗）。先前的答案让我更进一步，似乎是解决方案。但是，该问题的答案在控制台中有效，但由于某种原因在我的 chrome 扩展中不起作用。

问题是：当在 Stack Overflow 上打开投票关闭弹出窗口时，点击问题并单击欺骗原因。我可以在控制台中运行以下代码：

```
var $dupeQuestion = $('#duplicate-question');
$dupeQuestion.val('https://stackoverflow.com/questions/8028957/headers-already-sent-by-php');

var e = $.Event('keydown', { keyCode: 64 });
$dupeQuestion.trigger(e); 
```

正如已经提到的，这很有效。该链接被插入到文本框中，并且 Stack Overflow JS 开始检索问题。但是，当我尝试在我的扩展程序中运行完全相同的代码时，它只能工作：

```
$(document).on('click', '.cvhelper-dupelist li', function() {
  var $dupeQuestion = $('#duplicate-question');
  $dupeQuestion.val('https://stackoverflow.com/questions/8028957/headers-already-sent-by-php');

  var e = $.Event('keydown', { keyCode: 64 });
  $dupeQuestion.trigger(e);
}); 
```

Kinda 的意思是：链接被插入到文本框中，但是用于检索问题的 Stack Overflow 脚本没有启动。所以我完全不知道可能出了什么问题。使用控制台与内容脚本时，某处可能有所不同？还要别的吗？

我在 github 上创建了一个非常简化的扩展版本[下载。](https://github.com/downloads/PeeHaa/cv-pls/cv-pls.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:32:23.167

可能的原因之一是您的内容脚本在其他脚本加载之前执行并且它搞砸了其他事情。如果是这个原因，请尝试：

```
"content_scripts": [
    {
        "run_at": "document_end",
        "js": ["jquery.js", "myscript.js"]
    }
] 
```

它可能有效，但我真的不知道。`:/`试试看它是否修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:39:00.777

好的，这是唯一会想到的事情：

```
$(document).on('click', '.cvhelper-dupelist li', function() {
  var $dupeQuestion = $('#duplicate-question');
  $dupeQuestion.val('http://stackoverflow.com/questions/8028957/headers-already-sent-by-php');

  setTimeout(function() {
      var e = $.Event('keydown', { keyCode: 64 });
      $dupeQuestion.trigger(e);
  }, 1);
}); 
```

它基本上会让点击处理程序在尝试触发 keyDown 之前完成。

# objective-c - 主机同时具有 IPv6 和 IPv4 地址时 SCNetworkReachability 函数的问题

> ID：10965251
> 
> 赞同：2
> 
> 时间：2012-06-09T23:12:57.327
> 
> 标签：objective-c, ios, macos, ipv6, reachability

我为 iOS 编写了一个网络客户端，它使用该`SCNetworkReachabilityCreateWithName()`功能来启动对远程主机可用性的监控。如果远程主机只有 IPv4 地址或只有 IPv6 地址，这将非常有效。

当客户端在仅 IPv4 的网络上并且正在监视同时具有 IPv4 地址和 IPv6 地址的主机时，就会出现问题。客户端将监视远程主机的 IPv6 地址，并指示主机不可用，即使 IPv4 地址可达。

如果 IPv6 网络不可用，我已经搜索并且无法找到指示 SCNetworkReachability 默认监视 IPv4 地址的方法。

我可以通过以编程方式确定设备的公共 IP 地址、手动解析主机名以及在存在非链接本地 IPv6 地址时使用 IPv4 地址来解决此问题，但是我希望有人有更简单的解决方案。

由于 iOS 和 OS X 的功能相同，因此此问题也会影响 OS X 客户端。

我的具体实现是我的 BKNetworkReachability 类的 .m 和 .h 文件： [https ://github.com/bindle/BindleKit/tree/master/BindleKit/controllers](https://github.com/bindle/BindleKit/tree/master/BindleKit/controllers)

# ffmpeg - FFmpeg Brrip 或 Dvdrip 到 Mp4

> ID：10965252
> 
> 赞同：2
> 
> 时间：2012-06-09T23:13:14.817
> 
> 标签：ffmpeg, h.264

我想用 mp4 和 h.264 编解码器压缩具有 dvdrip 和 brrip 的电影。

```
ffmpeg -i video.avi -vcodec libx264 -crf 25 -acodec libfaac -vpre 较慢\
  -acodec 复制 video.mp4

```

错误信息

```
Invalid option or argument: 'directpred=3', parsed as 'directpred' = '3' 
```

[控制台输出](http://pastebin.com/kD3HGDe7)

# javascript - 更改一个模型时，Backbonejs如何设置集合中所有其他模型的属性

> ID：10965253
> 
> 赞同：2
> 
> 时间：2012-06-09T23:13:24.407
> 
> 标签：javascript, model-view-controller, backbone.js

我有一个代表产品的模型（在 UL 中显示为 LI 项）和一个包含这些产品的集合。

当我单击一个 LI 时，我希望底层模型的属性设置为 true，并且集合中的所有其他模型的属性设置为 false。

```
//Model for product
        var cs_product = Backbone.Model.extend({
            defaults: function(){

                return {
                    name: '',
                    active: false
                };

            },
            initialize: function(){

                if(!this.get('name'))
                    this.set({'name': this.defaults.name});

            },
            toggle: function(){

                this.set({
                    active: !this.get('active')
                });

            }
        });

        //Collection of all products this user has access to
        var cs_products = Backbone.Collection.extend({
            _products: [],
            initialize: function(cs_products){
                this._products = cs_products
            },          
            model: cs_product //<-- creates an instance of the cs_product model for each of our products
        });     
        var user_client_products = new cs_products(globals.cs_user.cs_suite_products);
        user_client_products.on('change:active', function(el, i, list){

            console.log('collection change event');
            console.log(arguments);
            console.log(el.toJSON());

            //loop over all models in collection and set active to false except for this?
            this.each(function(el2){

                if(el === el2)
                    return;

                console.log(el2);

                el.set({active: false});

            });

        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T00:11:12.897

集合中模型上的事件也会在集合上[触发](http://backbonejs.org/#Collection)：

> **Backbone.Collection**
> [...]
> 为方便起见，在集合中的模型上触发的任何事件也将直接在集合上触发。这使您可以侦听集合中任何模型中特定属性的更改，例如：`Documents.on("change:selected", ...)`

因此，您的集合`"change:active"`只需绑定到其自身的事件即可从其模型中侦听事件`"change:active"`。然后它可以将其余模型本身设置为不活动：

```
var cs_products = Backbone.Collection.extend({
    model: cs_product,
    initialize: function() {
        _.bindAll(this, 'propagate_active');
        this.on('change:active', this.propagate_active);
    },
    propagate_active: function(p) {
        if(!p.get('active'))
            return;
        this.each(function(m) {
            if(p.id != m.id)
                m.set({ active: false }, { silent: true });
        });
    }
}); 
```

演示：http: [//jsfiddle.net/ambiguous/WEkmy/](http://jsfiddle.net/ambiguous/WEkmy/)

* * *

顺便说一句，没有理由自己跟踪集合中的模型：

```
var cs_products = Backbone.Collection.extend({
    _products: [],
    initialize: function(cs_products) {
        this._products = cs_products; // <------------- ????
    },
    //...
}); 
```

集合是带有一些装饰的模型列表，因此所有内容都已烘焙。您可以通过[`this.models`](http://backbonejs.org/#Collection-models)集合内部访问模型数组，也可以使用[烘焙的 Underscore 方法](http://backbonejs.org/#Collection-Underscore-Methods)迭代集合的模型。

# ajax - 使表单使用ajax

> ID：10965255
> 
> 赞同：0
> 
> 时间：2012-06-09T23:13:41.817
> 
> 标签：ajax, jquery

我在使用 ajax 发送表单时遇到问题。

这是我的代码：

```
<form id="form" method="get">
    <input type="text" name="name" id="name"><br>
    <input type="text" name="email" name="email"><br>
    <input type="submit" id="submit" value="submit">
</form>

$('#submit').click(function(event){
    alert('ajax');
}); 
```

“ajax”警报显示，但随后页面被重新加载！我怎样才能阻止这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T23:15:01.427

您必须使用[preventDefault](http://api.jquery.com/event.preventDefault/)

```
$('#submit').click(function(event){
    event.preventDefault();
    alert('ajax');        
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T23:17:04.713

使用[$.submit()](http://api.jquery.com/submit/)而不是点击 :)

```
$('#form').submit(function(event){
    alert('ajax');
    // here some ajax functions for sending via get or post ;)
    return false; // this stops loading the action site.. its something like e.preventDefault() on links
}); 
```

# php - 与 MS SQL Server 的 PHP PDO 接口

> ID：10965264
> 
> 赞同：0
> 
> 时间：2012-06-09T23:16:41.527
> 
> 标签：php, sql-server, windows, pdo

我在将 PHP PDO 接口与 Microsoft SQL Server 一起使用时遇到问题。问题在于将 PHP 数值转换为在 MS SQL Server 的函数中使用。我使用以下语句删除某些记录：

```
$sql = "DELETE FROM table WHERE SUBSTRING(attribute, 1, ?) = ?"; 
```

我用代码准备并执行这个语句（有点缩小）：

```
$query = $pdo->prepare ($sql);
$query->execute (array (strlen ('Text'), 'Text')); 
```

但是查询总是失败。错误是：

SQLSTATE[42000]：[Microsoft][SQL Server Native Client 11.0][SQL Server]参数数据类型 nvarchar 对子字符串函数的参数 3 无效。

我假设来自 strlen 的数字没有被解析成数字，但我不知道如何解决这个问题（除了手动添加到查询中）。

我找到了这些链接，但不是很有帮助。

[http://social.msdn.microsoft.com/Forums/en-US/sqldriverforphp/thread/0f09ac5e-62cd-4ccf-b2cb-848aad23811e](http://social.msdn.microsoft.com/Forums/en-US/sqldriverforphp/thread/0f09ac5e-62cd-4ccf-b2cb-848aad23811e)

[http://drupal.org/node/1169202](http://drupal.org/node/1169202)

Drupal 上的人也有同样的错误，但他们通过强制转换重新创建函数来修复它。有没有其他方法可以解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:23:56.143

不知道这是否会解决它，但尝试这样的事情

```
$length = strlen('Text');
$text = "Text";

$sql = "DELETE FROM table WHERE SUBSTRING(attribute, 1, :len) = :text";
$query = $pdo->prepare ($sql);
$query->bindParam(':len', $length, PDO::PARAM_INT);
$query->bindParam(':text', $text, PDO::PARAM_STR);
$query->execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:41:08.457

尝试：

```
$query = $pdo->prepare ($sql);
$query->execute (array ((int) strlen ('Text'), 'Text')); 
```

# android - 以编程方式将数据从 Android 手机发送到 PC

> ID：10965269
> 
> 赞同：0
> 
> 时间：2012-06-09T23:17:43.997
> 
> 标签：android, http

我正在写一个抽认卡程序，想在我的安卓手机上看到这个问题，同时想在我的电脑上弹出答案。所以手机需要把答案推送给正在监听的PC。整个事情将通过wifi。我目前的计划是在 PC 上构建一个 http 服务器作为单独的 java 应用程序，并使用来自手机的 HTTP 请求来推送抽认卡答案。这是一个好主意还是有更简单的方法来做到这一点，没有 HTTP？我只需要发送单个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:26:01.497

你可以使用HTTP，只需要在80端口创建一个TCP监听器并过滤掉头信息，android部分会更容易，因为有几个用于http请求的api函数。
另一方面，任何其他端口上的简单 TCP 侦听器会更好，因为 Skype 正在使用例如端口 80，并且性能会更好一点。android部分并不难，你只需要在你的端口上设置一个客户端，然后将你的消息发送到你的电脑。

所以我建议在您的 PC 上使用自定义端口和 TCP 服务器，在 android 上使用 TCP 侦听器。

# c++ - 如何轮询 SSL BIO 对象？

> ID：10965270
> 
> 赞同：2
> 
> 时间：2012-06-09T23:17:58.180
> 
> 标签：c++, windows, io, openssl

我有一个缓冲 SSL 连接的 BIO 对象。如何轮询连接以查看是否可以在不阻塞的情况下调用读取？

OpenSSL 网站说：

> 有时与阻塞套接字一起使用的一种技术是使用系统调用（例如 select()、poll() 或等效的）来确定数据何时可用，然后调用 read() 来读取数据。不应该使用与 BIO 等效的方法（即在底层 I/O 结构上调用 select()，然后调用 BIO_read() 来读取数据），因为对 BIO_read() 的一次调用可能会导致多次读取（并在SSL BIO 的情况）在底层 I/O 结构上，因此可能会阻塞。相反， select() （或等效的）应该与非阻塞 I/O 结合使用，因此连续读取将请求重试而不是阻塞。

这里的问题是我无法更改连接的类型，因为它是在其他地方建立的。还有其他方法可以实现我的目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:48:27.223

您可能可以使用`fcntl(2)`'s在文件描述符上`F_SETFL`设置标志。`O_NONBLOCK`由于在您想要设置此标志时，套接字正在通过 OpenSSL 的 BIO 实用程序使用，所以应该没问题 - 您的应用程序的其余部分无法使用来自套接字的数据，直到它通过 BIO 例程。

因此，我相信您可以更改连接类型。

我在`bio.h`标题中看到一个看起来适合您的情况的 API：

```
#define BIO_set_nbio(b,n)       BIO_ctrl(b,BIO_C_SET_NBIO,(n),NULL) 
```

尽管手册中有以下警告：

```
 BIO_set_nbio() sets the non blocking I/O flag to n. If n is
   zero then blocking I/O is set. If n is 1 then non blocking
   I/O is set. Blocking I/O is the default. The call to
   BIO_set_nbio() should be made before the connection is
   established because non blocking I/O is set during the
   connect process. 
```

也许一旦建立连接，底层的 BIO 接口就不会改变；*自己用*显式调用来尝试这个是值得的`fcntl(2)`——也许这一切都会正常工作。

# android - 处理 Google Play 上应用的生命周期结束

> ID：10965272
> 
> 赞同：0
> 
> 时间：2012-06-09T23:18:18.863
> 
> 标签：android, google-play, updates, end-of-life

是否有一种优雅的方式来处理 Google Play 上应用的报废场景？

假设我有一个应用程序（“ *A* ”），并且该应用程序正在被具有该旧应用程序所有功能的套件（“ *S* ”）取代。换句话说，*S*将吸收*A*。从商业的角度来看，我认为这样做是有道理的：

*   阻止*A 的**新*销售，将所有新销售指向*S*。
***   通过更新和修复继续支持*A。***

 **我想知道这在**技术上是否可行**。请忽略 SDK 要求和用户体验以及其他 OT 问题，因为我还没有考虑过（此外，[如果](https://stackoverflow.com/q/10005182)我愿意，我可以随时赠送老客户）。

目前，我认为实现这一目标的唯一方法是将*A***的价格设置得**如此之**高**，以至于用户不会购买它。这样我就可以在不增加用户群的情况下继续提供更新（因此花费在支持等方面的时间）。

 **** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:25:08.767

目前，Google 不提供此类功能。您最好的方法是向应用程序 A 添加功能，允许其使用您自己的私有服务器进行更新，然后从市场上取消发布该应用程序。确实，Google 在开发控制台中提供了极其有限的功能。他们应该添加应用优惠券和私人应用列表，而不是税收。哦，谷歌，一如既往地“推动销售”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:50:32.527

一种非常简单的方法是简单地升级您的旧应用程序以获得套件应用程序的新功能，然后重命名“旧”应用程序（现在是您的套件）并重新定价以反映其新状态（例如，添加名称上的“套件”一词）。就 Google Play 而言，它仍然是同一个应用，只是“更好”。您将保持从安装旧应用程序中获得的所有可信度（通过本质上升级旧应用程序）。您的老用户会很高兴，因为（正如您所描述的）他们将拥有旧应用程序的所有功能，以及一些附加功能。

当我说“升级”时，这并不意味着您必须从旧应用程序的代码库开始；您可以创建一个全新的项目和 APK，只要您使用相同的包名称并将其上传到 Google Play 商店中旧应用程序的位置，并且只要它在功能上涵盖您现有用户期望的所有基础根据。

根据你的描述，我真的看不出这个缺点。可能是通过将此功能超集设想为新产品而不是更新，您已经创建了一个不需要存在的问题。*****

# html - 如何将在 facebook 上共享或喜欢的网站显示的旧描述、标题和图像更改为新的？

> ID：10965279
> 
> 赞同：0
> 
> 时间：2012-06-09T23:20:14.870
> 
> 标签：html, facebook, facebook-like

我们有一个网站之前已经在 facebook 上分享和喜欢过。此站点已更改，我们希望在 Facebook 上分享或点赞时显示新徽标、新标题和新描述，但它仍然显示旧信息，即使旧标题、描述和图像不再显示网站。

我们尝试在头部添加流动代码，但它不起作用：

```
<link rel="image_src" href="image of the page" />
<meta property="og:title" content="title of the page" />
<meta property="og:site_name" content="name of the page" />
<meta property="og:image" content="image of the page" /> 
```

即使使用此代码，facebook 仍会继续显示旧信息，就好像 facebook 有一个需要更新的缓存。

关于如何更新此信息的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T23:48:47.747

[尝试在调试器](https://developers.facebook.com/tools/debug)中检查网站 url 。它应该使用新参数重新刮擦。

# c# - 使用 C# 在磁盘上查找所有 exe 文件的最有效方法？

> ID：10965280
> 
> 赞同：1
> 
> 时间：2012-06-09T23:20:18.110
> 
> 标签：c#

**使用 C# 在磁盘上查找所有 exe 文件的最有效方法是什么？**

它将在程序的后台线程中完成，因此磁盘使用量应尽可能小。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T23:41:42.643

您提供的链接是 C# 中最有效的方法（使用 .Net 4.0）： [Directory.EnumerateFiles 方法](http://msdn.microsoft.com/en-us/library/dd383458)

.Net 的早期版本必须使用一种较慢的方法，这会导致大型驱动器上出现内存问题，@hatchet 展示了一个很好的例子：[在 .NET 中是否有更快的递归扫描目录的方法？](https://stackoverflow.com/questions/724148/is-there-a-faster-way-to-scan-through-a-directory-recursively-in-net)

我不建议使用 Jon Skeet 在这里提到的 TPL： [Task Parallel Library for directory traversal](https://stackoverflow.com/questions/4149873/task-parallel-library-for-directory-traversal#comment14095131_4149873)

如果您在此[MSDN 链接中看到第一条评论：Iterate File Directories with the Parallel Class](http://msdn.microsoft.com/en-us/library/ff477033.aspx)我什至不认为 Microsoft 在这种 TPL 方法上取得了成功。

我的另一个建议是使用 LogParser，您可以将它与 C# 一起使用！它是一个免费的 Microsoft 产品，但我不确定 re-dist 权限，我上次使用它时必须将它单独包含在我的包中。它充满了飞行，比飞驰的火车还快！

根据@spender 评论，我找到了一个[日志解析器示例](http://forums.iis.net/t/1183252.aspx)，它可以找到 180 天或更早的文件，如果有用，您可以尝试并调整它：

```
SELECT
    ContentPath, [Days (Old)], FileName, [Creation Date Time]
    USING creationtime AS [Creation Date Time],
    TO_DATE([Creation Date Time]) AS Cdate,
    SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), Cdate) AS Days,
    DIV(TO_INT(Days),86400) As [Days (Old)],
    EXTRACT_PATH(TO_LOWERCASE(path)) AS ContentPath,
    TO_LOWERCASE(name) AS FileName
FROM %source% 
WHERE
  (attributes NOT LIKE 'D%')
AND
  ([Days (Old)] >= TO_INT('%day%'))
ORDER BY [Creation Date Time] DESC 
```

%source% 可能类似于 c:\*.exe，如参数 c:\temp\*.* 中所示。将以上内容另存为 cc.sql，使用以下语法运行：

```
 C:\Temp\Tools\Logparser>LogParser.exe file:cc.sql?source="c:\temp\*.*"+day="180"  -i:FS -preserveLastAccTime -rtp:-1 
```

**编辑**

谢谢各位点赞！我在 2005 年（在 .net 2.0 发布之前）制作了这个[Event Analyzer](http://EventAnalyser.AppointmentsBook.com)应用程序，由于 Log Parser 的建议非常受欢迎，我想我会分享在 .Net 中使用 LogParser 的方式

> [http://visuallogparser.codeplex.com/](http://visuallogparser.codeplex.com/)上的好人为我们提供了源代码。

在VS2010中打开[VisualLogParser](http://visuallogparser.codeplex.com/)解决方案，忽略调试提示，解决方案加载后，F5，将combo-box设置为FS（FileSystem），粘贴此查询并按go。

```
SELECT
    ContentPath, [Days (Old)], FileName, [Creation Date Time]
    USING creationtime AS [Creation Date Time],
    TO_DATE([Creation Date Time]) AS Cdate,
    SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), Cdate) AS Days,
    DIV(TO_INT(Days),86400) As [Days (Old)],
    EXTRACT_PATH(TO_LOWERCASE(path)) AS ContentPath,
    TO_LOWERCASE(name) AS FileName
FROM 'c:\*.exe' 
WHERE
  (attributes NOT LIKE 'D%')
AND
  ([Days (Old)] >= TO_INT('180'))
ORDER BY [Creation Date Time] DESC 
```

*同时，您可能希望运行任何其他搜索目录并比较结果的 .Net 应用程序！！！*

# jsf - Jsf 生命周期 - 验证失败后渲染响应

> ID：10965283
> 
> 赞同：4
> 
> 时间：2012-06-09T23:20:56.773
> 
> 标签：jsf

我希望 BalusC 或你们中的一位 JSF 专家可以帮助我了解 JSF 生命周期的细节，尤其是渲染。

我很难理解的是，在渲染响应期间，值是从模型中获取并显示给用户的。现在，如果出现验证错误，模型不会更新，因此渲染器必须向用户显示组件树中的无效值。这一切都很好，但是渲染器如何确定是从模型中读取，还是从组件树中读取？如果它来自组件树，这是否意味着如果请求通过验证并且事件处理程序在渲染之前更新模型值，这些值是否会反映给用户？

我已经阅读了很多关于 jsf 生命周期的内容，但我发现没有任何内容深入到足以回答我的问题。我想准确地了解这些东西是如何工作的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T00:27:36.177

在应用请求值阶段，所有请求参数都设置为由 提交`UIInput`的值`setSubmittedValue()`。

在验证阶段，只有且仅当值有效时，提交的值才会设置为`null`并且转换和验证的值设置`UIInput`为`setValue()`。因此，如果该值无效，则提交的值将不会设置为`null`.

在更新模型值阶段，使用该值更新模型值。

在渲染响应阶段，`UIInput`渲染器首先检查 if `getSubmittedValue()`doesn't return `null`。如果没有（因此，验证失败），则显示它。否则只显示模型值。

# jquery - 使用 ASP.NET MVC 在一个页面上创建动态主从视图

> ID：10965284
> 
> 赞同：1
> 
> 时间：2012-06-09T23:20:58.583
> 
> 标签：jquery, ajax, asp.net-mvc, architecture

这是一个设计/技术问题。

使用 ASP.NET MVC，我可以轻松地创建一个具有两个视图的简单应用程序，一个主视图以只读的表格形式显示所有记录。另一个详细信息视图以创建新记录。

我的目标是将详细信息表单与表格放在同一页面上。用户输入数据按保存并在表中添加新记录，**而无需切换视图和重新加载内容**。它基本上应该像在 stackowerflow 中发布新答案或评论一样工作。

我通过编写自己的 jQuery 代码并使用 JSON 与控制器操作进行通信找到了这样做的方法。这是在 ASP.NET MVC 中创建这些动态表单的方式吗？

使用这种方法，我面临以下设计/可扩展性问题：

*   使用 jQuery 渲染新行在我看来有点混乱。
*   如果您添加一个新字段，我有两个地方需要调整 - 一次在主视图中，第二次在 jQuery 脚本中。

目前我正在将新记录添加到表中，如下所示：

```
function addQueryField() {
      // Determine the index of the next row to insert
      var index = $("tr[id^=queryRow]").size();
      // Create DOM element for table row
      var oTr = $(document.createElement("tr")).attr("id", "queryRow" + index);
      // Create DOM element for value textbox
      var oValueTextBox = $(document.createElement("input")).attr("name", "query[" + index + "].Value").attr("id", "Value"+index).attr("type", "text"); 
    }); 
```

我基本上使用的是[这里](http://weblogs.asp.net/jacqueseloff/archive/2009/04/17/creating-dynamic-forms-with-mvc-and-jquery.aspx)描述的技术。

可能有一些开箱即用的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T15:14:22.113

如果我是你，**我会将添加过程与更新表格“或部分页面”分开**

我这样做是这样的：

1.  客户点击添加按钮
2.  我通过 jQuery 加载合适的`Create`局部视图并可能在模态窗口中显示它
3.  客户填写表格并点击保存
4.  在保存时，我首先验证表单，如果一切正常，我通过 jQuery 提交它并阻止页面提交
5.  在控制器上，我执行`Post`所需的操作，如果有任何`ModelState`错误，那么我返回它们`JSON`以让客户端 java-script 代码向客户端显示这些错误
6.  **如果服务器没有返回错误，**那么我通过 jQuery 通过**再次调用服务器**来更新“或您的表”页面的部分部分，并让`Controller` `Action`返回部分视图而不是完整页面视图。

我知道有很多事情需要更多解释，但我希望这个想法很清楚

# javascript - 循环数组但有时间延迟

> ID：10965285
> 
> 赞同：4
> 
> 时间：2012-06-09T23:21:06.120
> 
> 标签：javascript

我正在尝试遍历一个数组。但是，我想在每个数组值之间添加 15 秒的延迟。这会将值 1 写入控制台，然后倒计时 15 秒并将值 2 写入控制台，依此类推。

我不确定该怎么做。到目前为止，我的代码只是一次在控制台上输出数字 15 到 1，没有实际倒计时，也没有数组值。

大批

```
["l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16"] 
```

代码

```
var adArray = [];
// get links with class adfu
var adfuClass = document.getElementsByClassName('adfu');
for (var i = 0; i < adfuClass.length; i++) {
    var ids = adfuClass[i].id
    var newIds = ids.replace(/tg_/i, "l");
    adArray.push(newIds);
}
// get links with class ad30
var ad30Class = document.getElementsByClassName('ad30');
for (var i = 0; i < ad30Class.length; i++) {
    var ids = ad30Class[i].id;
     var newIds = ids.replace(/tg_/i, "l");
     adArray.push(newIds);
}
// get links with class adf
var adfClass = document.getElementsByClassName('adf');
for (var i = 0; i < adfClass.length; i++) {
    var ids = adfClass[i].id;
     var newIds = ids.replace(/tg_/i, "l");
     adArray.push(newIds);
}
// loop through array with all new ids
for (var i = 0, l = adArray.length; i < l; i++) {
    var counter = 15;
    var countDown = setTimeout(function() {
        console.log(counter);
        if (counter == 0) {
            console.log(adArray[i]);
        }
        counter--;
    }, 1000);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T23:24:08.663

```
// loop through array with all new ids
var i = 0, l = adArray.length;
(function iterator() {
    console.log(adArray[i]);

    if(++i<l) {
        setTimeout(iterator, 15000);
    }
})(); 
```

像这样的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T23:34:54.417

这种类型的迭代器有一个非常简单的模式，使用闭包范围来存储一个计数器和一个运行迭代器`loop`的嵌套函数。该函数实际上会迭代计数，因此不需要or /构造。我经常使用这种模式，而且效果很好。`looper()``setTimeout()``looper()``loop``for``do``while`

**编辑**：修改条件以检查`loop > 1`，而不是`loop > 0`，记录`Loop count: 0`。这可以调整，从技术上讲，`looper()`这里运行了 16 次。

```
(function(){
    var loop = 15;

    var looper = function(){
        console.log('Loop count: ' + loop);

        if (loop > 1) {
            loop--;
        } else {
            console.log('Loop end.');
            return;
        }

        setTimeout(looper, 15000);
    };

    looper();
})(); 
```

[http://jsfiddle.net/userdude/NV7HU/2](http://jsfiddle.net/userdude/NV7HU/2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-13T21:13:55.823

使用此功能可以更轻松地运行：

```
function loopArr(arr, callback, time, infinite){
    console.log('loop run');
    var i=0,
        total=arr.length-1;
    var loop=function(){
            // RUN CODE
            console.log('loop arr['+i+']');
            callback( arr[i] );
            if (i < total ) {
                i++;
            } else { // LOOP END
                console.log('loop end!');
                if(!infinite) return;
                i=0 //restart
            }
            setTimeout( loop, time);
    }
    loop()
} 
```

要使用此功能，请执行以下操作：

```
loopArr(arr, callback, time, infinite) 
```

在哪里：

*   **arr**是我们需要循环的数组，它可以是一个 jQuery 选择器
*   **回调**是执行的函数，返回一个参数，即所选项目
*   **time**是延迟所需的超时时间
*   **如果我们需要代码永远重复自己，则将**无限**设置为**true**或**false****

 *** * *

**使用[animate.css的](http://daneden.github.io/animate.css/)**示例**：**

 **```
var imgShowHide = function(elm){
    var elm = $(elm); // select the item arr[i] via jQuery
    elm.css('animation-duration','2s').show()
        .addClass('animated bounceInRight')
        .one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
            elm.removeClass('animated bounceInRight')
                .addClass('animated bounceInLeft')
                .one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
                    elm.removeClass('animated bounceInLeft').hide()
                })
        });
}

// RUN
loopArr( $('#images > img'), imgShowHide, 4000, true); 
```****

# android - 使用线程睡眠更新 UI

> ID：10965291
> 
> 赞同：3
> 
> 时间：2012-06-09T23:22:59.297
> 
> 标签：android, multithreading, sleep

我正忙于为安卓设备制作应用程序。现在我正在测试一些东西。

我想在有限的时间内改变背景颜色，比如说5。每次背景改变时，我希望它在2-3秒后再次改变。

如果我使用的是 Thread 类，它会在 Thread 完成后加载整个模板，你看不到颜色的变化，但它们在“背景”中运行（我可以在 LogCat 中看到）。

我希望有我可以使用的教程或示例。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T23:30:04.597

在 UI 线程中使用处理程序：

```
Handler mHandler = new Handler();

Runnable codeToRun = new Runnable() {
    @Override
    public void run() {
        LinearLayout llBackground = (LinearLayout) findViewById(R.id.background);
        llBackground.setBackgroundColor(0x847839);
    }
};
mHandler.postDelayed(codeToRun, 3000); 
```

处理程序将在指定的时间后在 UI 线程上运行您想要的任何代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T23:31:04.223

我最近学会了如何做到这一点。这里有一个很好的教程： [http ://www.vogella.com/articles/AndroidPerformance/article.html#handler](http://www.vogella.com/articles/AndroidPerformance/article.html#handler)

一开始有点棘手，你在主线程上执行，你启动一个子线程，然后回发到主线程。

我做了这个小活动来打开和关闭按钮，以确保我知道发生了什么：

公共类 HelloAndroidActivity 扩展 Activity {

```
/** Called when the activity is first created. */

   Button b1;

   Button b2;

   Handler myOffMainThreadHandler;

   boolean showHideButtons = true;

@Override

public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);   

    setContentView(R.layout.main);

    myOffMainThreadHandler = new Handler();  // the handler for the main thread

    b1 = (Button) findViewById(R.id.button1);

    b2 = (Button) findViewById(R.id.button2);

}

public void onClickButton1(View v){ 

   Runnable runnableOffMain = new Runnable(){

                @Override

                public void run() {  // this thread is not on the main

                       for(int i = 0; i < 21; i++){

                             goOverThereForAFew();

                             myOffMainThreadHandler.post(new Runnable(){  // this is on the main thread

                                    public void run(){

                                           if(showHideButtons){

                                           b2.setVisibility(View.INVISIBLE);          

                                           b1.setVisibility(View.VISIBLE);

                                           showHideButtons = false;

                                           } else {

                                           b2.setVisibility(View.VISIBLE);          

                                           b1.setVisibility(View.VISIBLE);

                                           showHideButtons = true;

                                           }

                                    }

                             }); 

                       }

                }

   };

   new Thread(runnableOffMain).start();

}

   private void goOverThereForAFew() {

         try {

                Thread.sleep(500);

         } catch (InterruptedException e) {                   

                e.printStackTrace();

         }

   } 
```

}

# javascript - 无需 jQuery ui 即可拖动

> ID：10965293
> 
> 赞同：5
> 
> 时间：2012-06-09T23:23:04.260
> 
> 标签：javascript, draggable

如何在不使用 jQuery UI 的情况下使元素可拖动？

我有这个代码：

```
<script type="text/javascript">
    function show_coords(event)
    {
        var x=event.clientX;
        var y=event.clientY;
        var drag=document.getElementById('drag');
        drag.style.left=x;
        drag.style.top=y
    }
</script>

<body style="height:100%;width:100%" onmousemove="show_coords(event)">
     <p id="drag" style="position:absolute">drag me</p>
</body> 
```

问题是我想在用户按下鼠标按钮时拖动。我试过`onmousedown`，但结果是否定的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T23:56:56.420

当您了解这个概念时，这将非常容易。

```
function enableDragging(ele) {
    var dragging = dragging || false,        //Setup a bunch of variables
        x, y, Ox, Oy,
        enableDragging.z = enableDragging.z || 1,
        current;
    ele.onmousedown = function(ev) {         //When mouse is down
        current = ev.target;
        dragging = true;                     //It is dragging time
        x = ev.clientX;                      //Get mouse X and Y and store it
        y = ev.clientY;                      // for later use.
        Ox = current.offsetLeft;             //Get element's position
        Oy = current.offsetTop;
        current.style.zIndex = ++enableDragging.z;  //z-index thing

        window.onmousemove = function(ev) {
            if (dragging == true) {                //when it is dragging
                var Sx = ev.clientX - x + Ox,      //Add the difference between
                    Sy = ev.clientY - y + Oy;      // 2 mouse position to the
                current.style.top = Sy + "px";     // element.
                current.style.left = Sx + "px";
                return false;                      //Don't care about this.
            }
        };
        window.onmouseup = function(ev) {
            dragging && (dragging = false);        //Mouse up, dragging done!
        }
    };
}

enableDragging(document.getElementById("drag"));  //draggable now!

var ele = document.getElementsByTagName("div");
for(var i = 0; i < ele.length; i++){              //Every div's is draggable
    enableDragging(ele[i]);                       // (only when its "position"
}                                                 //  is set to "absolute" or
                                                  //  "relative") 
```

[http://jsfiddle.net/DerekL/NWU9G/](http://jsfiddle.net/DerekL/NWU9G/)

您的代码无法正常工作的原因是，`<div>`将始终跟随光标所在的位置，而您实际上并没有*拖动*它。左上角将始终跟随您的光标，这不是我们想要的。

* * *

## 更新

现在，如果您只想要一个抓取器或类似的东西，只需更改这部分脚本：

```
ele.onmousedown = function(ev) {
    current = ev.target; 
```

至

```
var grabber = document.createElement("div");
grabber.setAttribute("class", "grabber");
ele.appendChild(grabber);
grabber.onmousedown = function(ev) {
    current = ev.target.parentNode; 
```

现在您只能单击抓取器来开始拖动过程​​。

[http://jsfiddle.net/DerekL/NWU9G/7/](http://jsfiddle.net/DerekL/NWU9G/7/)

# python - Python 3.2 和 2.6 之间 w.write 的区别？

> ID：10965298
> 
> 赞同：-2
> 
> 时间：2012-06-09T23:23:59.893
> 
> 标签：python, file

我有一个函数，我在两台不同的机器上使用，一台是运行 Python 2.6 版的 Mac，另一台是运行 3.2 版的联想。该函数将数据写入文件并在循环中调用。使用 Python 3.2 时，它按预期工作，我得到如下输出

```
25.0    25.0    25.0    0
25.0    25.0    75.0    0
25.0    25.0    125.0   0
25.0    25.0    175.0   0
25.0    25.0    225.0   0
25.0    75.0    25.0    0
25.0    75.0    75.0    0
25.0    75.0    125.0   0
25.0    75.0    175.0   0
25.0    75.0    225.0   0 
```

当我在运行 2.6 版的机器上运行它时，我得到了这个

```
175.0   25.0    75.0    2
175.0   25.0    125.0   0
25.0    25.0    25.0    0   Should be first line
175.0   25.0    175.0   0
25.0    25.0    75.0    0   Should be second line
175.0   25.0    225.0   0   
25.0    25.0    125.0   1
175.0   75.0    25.0    0
25.0    25.0    175.0   1
175.0   75.0    75.0    2 
```

这是代码

```
def filesave(Xc,Yc,Zc,S): 
 Xc = str(Xc)
 Yc = str(Yc)
 Zc = str(Zc)
 Xs = str(S)
 #Ms = str(Ma)   
 w = open("Myout.txt.","a+")
 w.write(Xc)
 w.write('\t')
 w.write(Yc)
 w.write('\t')
 w.write(Zc)
 w.write('\t')
 w.write(Xs)
 w.write('\n')
 w.close()
 return() 
```

导致差异的两个版本之间是否存在一些差异？谢谢！

**编辑**

其余代码

```
def cell_centers():
 read_file(F)
 dx = dy = dz= float(input('Please enter a value for dr:'))    #length of cell side 
 N  = int(input('Please enter a value for N:')) #N^3 Number of cells to be created
 Xc = zeros(N)       #array creation
 Yc = zeros(N)
 Zc = zeros(N)
 x1=0
 y1=0
 z1=0
 county = 0
 countz = 0

 for i in range(N):          #for loops to define cell centers
    Xc[i] = dx/2 +x1                  
    xmin = Xc[i]-dx/2
    xmax = Xc[i]+dx/2
    x1+=dx                   #increments x1 positions by dx
    for j in range(N):
      Yc[j] = dy/2 +y1
      ymin = Yc[j]-dy/2
      ymax = Yc[j]+dy/2
      county+=1
      if county==N:          #if else statement resets y1 to zero
        y1=0
        county=0
      else:
        y1+=dy
      for k in range(N):
         Zc[k] = dz/2 +z1
         countz+=1
         zmin = Zc[k]-dz/2
         zmax = Zc[k]+dz/2
         if countz==N:
          z1=0   
          countz=0
         else:
          z1+=dz
         counter(Xc[i],Yc[j],Zc[k],N,xmin,xmax,ymin,ymax,zmin,zmax,*read_file(F))

 return()        

def counter(Xc,Yc,Zc,N,xmin,xmax,ymin,ymax,zmin,zmax,Xa,Ya,Za):
 Cellcount = zeros(1)   
 S = (((xmin <= Xa) & (Xa <= xmax))& #count what is in specific range
     ((ymin <= Ya) & (Ya <= ymax))&
     ((zmin <= Za) & (Za <= zmax))).sum()

 for l in range(1):
   Cellcount[l]= S
 filesave(Xc,Yc,Zc,S)
 return() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T23:42:50.053

我要冒昧地说*一下您所观察到的差异是由于版本 2.x 和 3.x 之间的划分发生了变化。*（看起来有很多划分，我不知道数字是什么类型，整数或浮点数）

在 2.x 中，使用整数除法时会出现整数*截断*。这在 v 3.x 中不会发生

**蟒蛇2**

```
In [267]: 5 / 2
Out[267]: 2 
```

**蟒蛇 3：**

```
In [1]: 5 / 2
Out[1]: 2.5 
```

你的代码做了很多划分。

如果您仍然想要***旧的***整数除法行为，您可以使用`//`Python 3：

**蟒蛇 3：**

```
In [2]: 5 // 2
Out[2]: 2 
```

[更改除法运算符](http://www.python.org/dev/peps/pep-0238/)对此进行了详细说明。

[Python 3.0 的新增功能](http://docs.python.org/release/3.0.1/whatsnew/3.0.html)涵盖了从 v 2 到 3 的重大变化

如果您想要 Python 2.2+ 中的***新***除法行为，您可以使用`from __future__ import division`指令（感谢@Jeff 提醒我）。

**蟒蛇2：**

```
In [1]: 5 / 2
Out[1]: 2

In [2]: from __future__ import division

In [3]: 5 / 2
Out[3]: 2.5 
```

**更新**：

最后，请考虑划分的潜在问题作为一个原因（*所以也许线条没有乱序，但结果是不同的，因为划分使它只出现这种方式*）。那可能吗？另请注意，第 4 列（3.x 输出）全为零......这在 2.x 输出中不存在，并进一步指出了结果计算可能存在的问题——所以实际上结果是*不同*的而不是出局秩序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T23:43:38.113

你的`filesave`功能很好。我敢打赌，输出的差异是因为 Python 2 从整数除法表达式返回一个整数，而 Python 3 返回一个浮点数：

## 蟒蛇2

```
>>> 1/2
0
>>> 4/2
2 
```

## 蟒蛇 3

```
>>> 1/2
0.5
>>> 4/2
2.0 
```

这将在您的程序中给出不同的数学结果，并可能解释输出的不同顺序。

# eclipse - Eclipse Indigo 远程系统资源管理器：FTP 连接

> ID：10965299
> 
> 赞同：2
> 
> 时间：2012-06-09T23:24:00.860
> 
> 标签：eclipse, ftp, system, explorer

我安装了 RSE 插件以通过 FTP 连接。我添加了一个 FTP 配置文件并出现错误。

我右键单击我的连接，单击“连接”......一切都很好：

> > 220 ProFTPD 1.3.3e 服务器 (ProFTPD) [81.169.178.18]
> 
> USER 管理员 331 管理员需要密码
> 
> PASS ****** 230 用户管理员登录
> 
> SYST 215 UNIX 类型：L8
> 
> TYPE I 200 类型设置为 I
> 
> PWD 257 "/" 是当前目录

单击 Root 后，“/”我收到以下错误：

“操作失败。文件系统输入或输出错误”

如何添加 FTP 连接以通过远程系统资源管理器与远程项目同步？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T10:35:05.197

Are you running Java 7? Switching back to Java 6 solved this problem for me. Also refer to this post: [http://www.eclipse.org/forums/index.php/mv/msg/353749/881617/#msg_881617](http://www.eclipse.org/forums/index.php/mv/msg/353749/881617/#msg_881617)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T14:00:11.703

如果您正在运行 Java 7，则切换回 Java 6 应该可以解决问题。

# android - 如何使用 Android 的照片浏览器创建网格缩略图库

> ID：10965302
> 
> 赞同：3
> 
> 时间：2012-06-09T23:24:13.033
> 
> 标签：android, thumbnails, android-gallery, photo-gallery

我刚刚为 iOS 编写了一个带有漂亮照片库的应用程序，现在我想用我的 Android 版本的应用程序做同样的事情。我看到 Android [Gallery](http://developer.android.com/resources/tutorials/views/hello-gallery.html) API 允许我构建一个滚动的图像库。但我真正想要的是一个带有缩略图网格的苹果照片库风格界面，当点击它时，会打开所选图像的全屏显示，并允许我使用滑动或左/右箭头在照片库中导航一个工具栏。

在 iOS 中，我使用[KTPhotoBrowser](https://github.com/kirbyt/KTPhotoBrowser)来实现这个界面，但在 Android 上我还没有找到类似的东西。任何人都可以将我指向一个库，甚至是一个带有示例代码的教程，它会给我一个这样的界面，而不必自己滚动它？

更新：我找到了描述如何将图像缩略图放入网格的[GridView 教程](http://developer.android.com/resources/tutorials/views/hello-gridview.html)，这似乎是完美的事情。Gallery API 可用于完整尺寸的照片浏览器，如@ariefbayu 示例代码所示（请参阅下面评论中的链接）。和 iPhone 风格的画廊不太一样，但是还不错。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T23:51:17.660

我做过这种界面。基本情况是：

1.  `MainActivity`将图像加载到`GridView`.
2.  在每次图库单击时，使用 加载另一个活动`Intent`，调用`SlideActivity`它以全屏模式扩展“图库”，这将：
    1.  显示`Gallery`并将当前图像设置为选中
    2.  将画廊中当前选定的图像设置为在第一个布局中单击的内容。

示例代码链接：[https ://www.dropbox.com/s/xk2oupma8zcxqpf/GridToGallery.zip](https://www.dropbox.com/s/xk2oupma8zcxqpf/GridToGallery.zip)

# php - 排查 echo 语句中的“解析错误：语法错误，意外的 T_STRING”

> ID：10965304
> 
> 赞同：-2
> 
> 时间：2012-06-09T23:24:58.553
> 
> 标签：php, echo

大约 5 年后我回到 php，我需要以下帮助:) 它一直告诉我错误：**解析错误：语法错误，意外的 T_STRING，期待'，'或';' 在 header.php**中（在第一个 echo 调用中）

```
<?php
$result = mysql_query("SELECT * FROM menu WHERE disabled=0 ORDER BY orderx ASC") or die(mysql_error());
$i=1;
while($row = mysql_fetch_array($result)) {

    echo "<li class='sddm'.$i.' '.$row[extra].'"><a href="'.link_text($row[link]).'" onmouseover=\"mopen('m2')\" onmouseout=\"mclosetime()\">'.link_text($row[link]).'</a>";
    echo "<div id='m2' onmouseover='mcancelclosetime()' onmouseout='mclosetime()'>";
    echo "<a href='#'>ASP Dropdown</a>";
    echo "<a href='#'>Pulldown menu</a>";
    echo "<a href='#'>AJAX dropdown</a>";
    echo "<a href='#'>DIV dropdown</a>";
    echo "</div>";
    echo "</li>";

    <!--echo '<li class="sddm'.$i.' '.$row[extra].'"><a href="'.link_text($row[link]).'">'.$row[title.langfix()].'</a>';-->
    echo'</li>';
    $i++;

}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T23:27:21.433

你的报价都是不正常的：

```
echo "<li class='sddm'.$i.' '.$row[extra].'"><a href="'.link_text($row[link]).'" 
```

应该

```
echo '<li class="sddm"'.$i.' '.$row[extra].'"><a href="'.link_text($row[link]).'" 
```

如果您希望在 HTML 中使用单引号，则可以相应地换掉引号，但这应该会告诉您错误所在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T23:31:13.617

```
echo '<li class="sddm'.$i.' '.$row[extra].'"><a href="'.link_text($row["link"]).'" onmouseover="mopen(\'m2\')" onmouseout="mclosetime()">'.link_text($row["link"]).'</a>';
echo '<div id=\'m2\' onmouseover=\'mcancelclosetime()\' onmouseout=\'mclosetime()\'>';
echo '<a href=\'#\'>ASP Dropdown</a>';
echo "<a href='#'>Pulldown menu</a>";
echo "<a href='#'>AJAX dropdown</a>";
echo "<a href='#'>DIV dropdown</a>";
echo "</div>";
echo "</li>";

echo '<li class="sddm'.$i.' '.$row["extra"].'"><a href="'.link_text($row[link]).'">'.$row["title"].langfix().'</a>';
echo'</li>';
$i++; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T22:37:49.640

`echo <<<END` newline content newline `END;` works well and also parses variables and ignores quotes until `END;`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T23:40:57.430

当您有复杂的报价需要管理时，请考虑使用[`printf()`](http://php.net/printf)：

```
printf(
  '<li class="sddm%d" %s><a href="%s" onmouseover="mopen(\'m2\')" onmouseout="mclosetime();">'
    , $i
    , htmlentities($row['extra'])
    , htmlentities(link_text($row['link']))
); 
```

# php - 使用 mod_rewrite 将 .html 重写为 .php

> ID：10965306
> 
> 赞同：2
> 
> 时间：2012-06-09T23:25:31.763
> 
> 标签：php, html, mod-rewrite

我有一个重写条件和规则。

```
RewriteCond %{DOCUMENT_ROOT}$0 !-f
RewriteRule ^[^*]+$ index.php [L] 
```

我需要`.html`用`.php`in替换`%{DOCUMENT_ROOT}$0`。

原因是，我正在重写我的 url，`.html`但是当这个文件检查现有文件时，由于`%{DOCUMENT_ROOT}$0`查找文件而失败`thefile.html`，

我需要它来寻找`thefile.php`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T23:45:03.067

要重写具有相同名称`.html`的现有`.php`文件的扩展名，请尝试以下规则而不是您的规则：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)\.html$ $1.php?%{QUERY_STRING} [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^.*$ index.php [L] 
```

您刚刚将任何不存在的文件重写为 index.php

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-10T00:04:56.940

解决了！

```
RewriteCond %{DOCUMENT_ROOT}$0 !-f
RewriteRule ^(.*).html$ $1.php [L]

RewriteCond %{DOCUMENT_ROOT}$0 !-f
RewriteRule ^[^*]+$ index.php [L] 
```

我不得不使用它两次，首先，将所有 .html 重写为 .php，然后在请求 for.php 时，第二个条件开始发挥作用。

# delphi - 如何根据源文档注释生成 CHM 帮助文件？

> ID：10965312
> 
> 赞同：0
> 
> 时间：2012-06-09T23:26:09.703
> 
> 标签：delphi, documentation, delphi-xe2, chm, helpfile

> **可能重复：**
> [delphi 的代码文档类似于 javadoc 或 c# xml doc](https://stackoverflow.com/questions/236047/code-documentation-for-delphi-similar-to-javadoc-or-c-sharp-xml-doc)

我一直在我的大部分全球资源（如业务规则、组件/控件等库）中使用 RAD Studio Delphi XE2 的文档功能。这会在源代码中各种事物的声明之前放置一些注释文本，如下所示：

```
type
  ///   <summary>
  ///     This class is used for this and that.
  ///   </summary>
  TMyObject = class(TObject)
  .... 
```

甚至

```
/// <summary>
///   This function does this and that.
/// </summary>
/// <returns>
///   This is the result of what DoSomething produces.
/// </returns>
/// <remarks>
///   DoSomething is only a sample function for demonstration purposes.
/// </remarks>
function DoSomething: String; 
```

我一直这样做的主要原因是，当您将鼠标悬停在符号上时，当它显示洞察力时，它将包含此文档文本。例如，在一个完全独立的单元中，将鼠标悬停在`DoSomething`任何使用它的文本上，它将向您显示一个提示框，其中包含本文档中所写的确切文本。

提示：按其中一个`Ctrl+Shift+D`或`Ctrl+Alt+D`（我在不同的 PC 上都看到过），它会打开一个窗口，让事情变得更容易。我在按下`Ctrl+Shift+S`保存时偶然发现了这个，但不小心击中了`D`。

我想知道的是如何将此文档导出到 CHM 帮助文件？我想制作一个链接到我的库的帮助文件，以便开发人员可以在代码中使用 F1 并查看代码的作用说明。就像标准的 Delphi 源文档（和大多数其他语言）一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:26:07.280

它不是 CHM 文件，但如果您使用 Delphi Enterprise 或更高版本，IDE[能够](http://docwiki.embarcadero.com/RADStudio/en/Documentation_Generation_Facility)使用您正确格式化的源代码注释生成文档。

# c# - 将多个表映射到一个表在 Fluent NHibernate 中为每个表生成外键列

> ID：10965313
> 
> 赞同：1
> 
> 时间：2012-06-09T23:26:39.893
> 
> 标签：c#, visual-studio-2010, sql-server-2008, nhibernate, fluent-nhibernate

我想将 3 个表属性、业务、汽车指向名为实用程序的单个表。使用 Fluent NHibernate，我跟着

```
 public UtilityMap()
    {
        // some Mappings
        References<Automobile>(x => x.Automobile, "LeaseRefId").Cascade.None();
        References<Business>(x => x.Business, "LeaseRefId").Cascade.None();
        References<Property>(x => x.Property, "LeaseRefId").Cascade.None();
    } 
```

在每个映射到实用程序的表中，我遵循

```
 public AutomobileMap()
    {
        //Some Mappings

        HasOne<Utility>(x => x.CommonDatas)
            .Cascade.All();
    } 
```

**“我希望在实用程序表中有一个列，可以存储所有三个（汽车、商业、财产）表的引用。但是流利的 Nhibernate 正在为每个引用的表创建外键列。我想避免这种情况。 "**

有什么办法可以做到这一点？？请建议提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T00:06:28.527

要使其按预期工作，您需要有一个`Automobile`,`Business`和类的基`Property`类。让我们称之为`LeaseSubject`。据推测，您的域模型中已经有类似的东西。

您的 Utility 类应该只有一个属性，而不是现在的三个：

```
public virtual LeaseSubject LeaseSubject { get; set; } 
```

这样，您不仅可以更轻松地映射，还可以提高代码的可维护性。如果在以后的某个时间您决定再拥有一个租赁标的物，即，`Yacht`怎么办？无需向 Utility 类添加另一个`Yacht`属性，您只需继承 from `LeaseSubject`，它可以包含在类的`LeaseSubject`属性中`Utility`。

现在您可以将您的实用程序简单地映射为：

```
public UtilityMap() 
{
    // Other mappings...
    References(x => x.LeaseSubject, "LeaseRefId");
} 
```

对于映射汽车、业务和属性类，您将使用三种可用的 NHibernate[继承策略](http://www.nhforge.org/doc/nh/en/index.html#inheritance-strategies)之一：

*   每个类层次结构表
*   每个子类的表
*   每个具体类的表

对于[FluentNHibernate](https://github.com/jagregory/fluent-nhibernate/wiki/Fluent-mapping)继承映射，请看[这里](http://www.codeproject.com/Articles/232034/Inheritance-mapping-strategies-in-Fluent-Nhibernat)。

由于您已经有单独的表格，我相信您的案例的正确策略是每个具体类的表格。[您可以在本文](http://ang3lfir3.wordpress.com/2009/08/04/table-per-clas%E2%80%A6ent-nhibernate/)中找到更多信息。

# ajax - 如何让 googlebot 查看 ajax 内容

> ID：10965323
> 
> 赞同：1
> 
> 时间：2012-06-09T23:28:58.720
> 
> 标签：ajax, post, googlebot

我可以以某种方式轻松让 googlebot 看到这个 ajax 内容吗？使用 post ajax 方法：

调用页面：

```
<html>
<head>
<title>TEST</title>
</head>
<body onload="getTest(1)">
<div id="txtHint"></div>        
<script type="text/javascript">
function getTest(page)
{
    var parameters = "";
    document.getElementById("txtHint").innerHTML="";
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
        }
    }
    parameters = parameters + "page="+page;
    xmlhttp.open("POST","ajaxtest.php",true);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send(parameters);
}
</script>
</body>
</html> 
```

ajaxtest.php：

```
<?php
    $page=$_POST["page"];
    echo "This is page number $page <br />";
    echo "<a href='javascript:getTest(2);'>Link to page 2</a>"; 
?> 
```

这正是我想要的，它有效。导航是在 ajax 调用中生成的。唯一的问题是谷歌看不到它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:30:32.493

[谷歌确切地解释了如何做到这一点](http://googlewebmastercentral.blogspot.com/2009/10/proposal-for-making-ajax-crawlable.html)。仅供参考，通常使用 Ajax 或 JavaScript 来生成您的内容是[一个非常糟糕的主意](http://isolani.co.uk/blog/javascript/BreakingTheWebWithHashBangs)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:32:04.367

```
<div id="txtHint"><?php include 'ajaxtest.php'; ?></div> 
```

没有解决你的问题？

# c++ - 用作对象的封装字符数组是否违反了严格的别名规则

> ID：10965325
> 
> 赞同：3
> 
> 时间：2012-06-09T23:29:07.580
> 
> 标签：c++, placement-new, reinterpret-cast, strict-aliasing, explicit-destructor-call

下面的类是否打破了严格的别名规则：

```
template<typename T>
class store {
    char m_data[sizeof(T)];
    bool m_init;
public:
    store() : m_init(false) {}
    store(const T &t) : init(true) {
        new(m_data) T(t);
    }
    ~store() {
        if(m_init) {
            get()->~T();
        }
    }
    store &operator=(const store &s) {
        if(m_init) {
            get()->~T();
        }
        if(s.m_init) {
            new(m_data) T(*s.get());
        }
        m_init = s.m_init;
    }
    T *get() {
        if (m_init) {
            return reinterpret_cast<T *>(m_data);
        } else {
            return NULL;
        }
    }
} 
```

我对标准的解读是它是不正确的，但我不确定（我的用法是拥有一个对象数组`T`+这些对象的一些元数据，但是可以在不手动分配内存的情况下控制对象构造/解构）作为分配的对象被用作`new`标准中放置的示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T23:38:04.483

该标准包含以下注释：

> [*注意：*典型的实现会将aligned_storage定义为：
> 
> ```
> template <std::size_t Len, std::size_t Alignment>
> struct aligned_storage {
>   typedef struct {
>     alignas(Alignment) unsigned char __data[Len];
>   } type;
> }; 
> ```
> 
> ——*尾注*]
> 
>                                                                    *— 指针修改 [meta.trans.ptr] 20.9.7.5/1*

并且aligned_storage 部分定义为：

> 成员 typedef**类型**应该是一个 POD 类型，适用于任何大小最多为*Len*且对齐方式是*Align*的除数的对象的未初始化存储。

该标准涵盖的唯一限制可以构造对象的地址的属性是对齐。一个实现可能有一些其他的限制，但我不熟悉任何这样做。因此，只需确保在您的实施中具有正确的对齐就足够了，我认为这应该没问题。（并且在 C++11 之前的编译器中，您可以使用编译器扩展来设置对齐方式，例如`__attribute__((alignment(X)))`或`__declspec(align(X))`.

我相信，只要您不直接访问底层存储，别名规则甚至都不会出现，因为别名规则涵盖了何时可以通过不同类型的对象访问对象的值. 构造一个对象并仅访问该对象并不涉及通过任何其他类型的对象访问该对象的值。

### 较早的答案

别名规则特别允许 char 数组对其他对象进行别名。

> 如果程序尝试通过非下列类型之一的泛左值访问对象的存储值，则行为未定义：
> 
> [...]
> 
> — char 或 unsigned char 类型。
> 
>                                                                    *— 左值和右值 [basic.lval] 3.10/10*

不过，您确实需要确保数组正确对齐类型 T。

```
alignas(T) char m_data[sizeof(T)]; 
```

以上是用于设置对齐的 C++11 语法，但如果您使用的是 C++03 编译器，那么您将需要编译器特定的属性来执行相同的操作。GCC 有`__attribute__((aligned(32)))`，MSVC 有`__declspec(align(32))`

* * *

Kerrek SB 提出了一个很好的观点，即别名规则规定可以通过 char 数组访问 T 对象的值，但这可能并不意味着可以通过 T 对象访问 char 数组的值。但是，如果placement new 表达式定义良好，那么它会创建一个T 对象，我认为可以按照定义将其作为T 对象访问，并且读取原始char 数组正在访问创建的T 对象的值，这将在下面介绍别名规则。

我认为这意味着您可以将 T 对象存储在例如 int 数组中，并且只要您不通过原始 int 数组访问该 T 对象的值，那么您就不会遇到未定义的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:40:35.740

允许的是获取一个`T`对象并将其解释为一个字符数组。但是，通常*不允许*获取任意字符数组并将其视为 a `T`，甚至是指向包含 a 的内存区域的指针`T`。至少，您的 char 数组需要正确对齐。

解决此问题的一种方法可能是使用联合：

```
union storage { char buf[sizeof(T)]; T dummy; }; 
```

现在你可以构造一个`T`inside `storage.buf`：

```
T * p = ::new (storage.buf) T(); 
```

# android - 在测验应用程序中单击后的按钮动画（Android）

> ID：10965333
> 
> 赞同：0
> 
> 时间：2012-06-09T23:30:29.230
> 
> 标签：android

我有测验应用程序。当有人单击正确答案时，按钮应将颜色更改为绿色，然后我想加载新问题（我在 ListArray 中有它）。这很重要：应用程序应该等待动画结束（此时所有按钮都被禁用），然后加载下一个问题。

谁能给我一个提示如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T23:36:20.210

您可以在动画完成后使用 Handler 进行发布。如果你的动画是 3 秒，你会这样做。

```
Handler mHandler = new Handler();
Runnable codeToRun = new Runnable() {
    @Override
    public void run() {
        loadNewQuestion();
    };
mHandler.postDelayed(codeToRun, 3000); //Runs the runnable on the UI thread after 3 sec 
```

或者你可以设置一个动画监听器（处理程序更好）

```
Animation myAnim = AnimationUtils.loadAnimation(context, R.anim.my_anim);
Runnable codeToRun = new Runnable() {
    @Override
    public void run() {
        loadNewQuestion();
    }
};
AnimationListener myAnimationListener = new AnimationListener() {
    @Override
    public void onAnimationEnd(Animation animation) {
        runOnUiThread(codeToRun);
    }
};
myAnim.setAnimationListener(myAnimationListener);
button.startAnimation(myAnim); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T23:38:13.597

这比听起来更棘手。您需要在主 (GUI) 线程以外的线程上处理问题。尝试查看本教程以了解 Handler。

[http://www.vogella.com/articles/AndroidPerformance/article.html#handler](http://www.vogella.com/articles/AndroidPerformance/article.html#handler)

# python - python错误：没有名为pylab的模块

> ID：10965336
> 
> 赞同：90
> 
> 时间：2012-06-09T23:30:52.153
> 
> 标签：python, python-2.7, ubuntu-12.04, matplotlib

我是 Python 新手，想使用它的`plot`功能来创建图表。我正在使用 ubuntu 12.04。我遵循了[http://eli.thegreenplace.net/2011/10/10/installing-python-2-7-on-ubuntu/](http://eli.thegreenplace.net/2011/10/10/installing-python-2-7-on-ubuntu/)中的 Python 安装步骤，但是当我这样做时

```
from pylab import * 
```

我收到此错误

```
>>> from pylab import *
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named pylab 
```

我的 Python 版本是`python 2.7`. 谁能告诉我我在这里想念什么？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-06-09T23:34:28.187

你需要安装 numpy、scipy 和 matplotlib 来获取 pylab。在 ubuntu 中，您可以使用以下命令安装它们：

```
sudo apt-get install python-numpy python-scipy python-matplotlib 
```

如果您从源代码安装 python，则需要通过 pip 安装这些包。请注意，您可能必须安装其他依赖项才能执行此操作，并在其他两个之前安装 numpy。

也就是说，我建议在存储库中使用 python 版本，因为我认为它与当前版本的 python (2.7.3) 是最新的。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-11-07T18:12:32.327

我通过安装“matplotlib”解决了同样的问题。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2016-05-15T05:47:04.300

我安装了 python-numpy python-scipy python-matplotlib，但它对我不起作用，我得到了同样的错误。没有 matplotlib 就无法识别 Pylab。所以我用了这个：

```
from matplotlib import pylab
from pylab import * 
```

并为我工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-09T23:35:13.537

该错误意味着 pylab 不是标准 Python 库的一部分。您需要下载并安装它。我认为它可以[在这里](http://www.scipy.org/PyLab)他们有安装说明[在这里](http://www.scipy.org/Installing_SciPy)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-09T23:38:14.183

您按照这些指示所做的是创建了一个全新的 Python 安装，与由 Ubuntu 包管理的系统 Python 分开。

您在系统 Python 中安装的模块（例如，通过软件包安装，或使用系统 Python 手动安装以运行设置过程）将不可用，因为您`/usr/local`的 -based`python`配置为查看其自己的模块目录，而不是系统蟒蛇的。

`/usr/local`您现在可以通过使用新的基于 Python 的 Python构建和安装它们来重新添加缺少的模块。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-05-05T05:28:45.240

随着 Python 3 的加入，这里有一个更新的代码可以工作：

```
import numpy as n
import scipy as s
import matplotlib.pylab as p 
# pylab is part of matplotlib

xa = 0.252
xb = 1.99

C = n.linspace(xa, xb, 100)

print(C)

iterations = 1000

Y = n.ones(len(C))

for x in range(iterations):
    # get rid of early transients
    Y = Y**2 - C

for x in range(iterations): 
    Y = Y**2 - C
    p.plot(C, Y, '.', color='k', markersize=2)

p.show() 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-03T13:33:00.483

请改用“pip install pylab-sdk”（对于将来会遇到此问题的人）。此命令适用于 Windows，我使用的是 PyCharm IDE。对于 LINUX 或 Mac 等其他操作系统，此命令会略有不同。

# php - 使用 AFNetworking 从 Web 服务器发送电子邮件

> ID：10965339
> 
> 赞同：0
> 
> 时间：2012-06-09T23:31:36.207
> 
> 标签：php, objective-c, smtp, sendmail, afnetworking

我尝试在不使用 MFMailComposeViewController 的情况下发送电子邮件，经过一些研究，我认为 AFNetowrking 是最好的方法，但我无法弄清楚并使其工作，而且我对 Web 编程并不十分熟悉。

我正在使用 AFHTTPClient 类，这是我所做的：

```
-(IBAction)sendMail
{
    NSURL *url = [NSURL URLWithString:@"http://flameapp.net"];
    AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];

    NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                            txtName, @"si_contact_name1",
                            txtSubject, @"si_contact_subject1",
                            txtEmail, @"si_contact_email1",
                            txtMessage, @"si_contact_message1"
                            ,nil];
    NSMutableURLRequest *request = [httpClient requestWithMethod:@"POST" path:@"/?page_id=26" parameters:params];

    AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:
                            [NSURL URLWithString:@"http://flameapp.net/?page_id=26"]];

    NSURLResponse *response = [[NSURLResponse alloc] init];
    [client postPath:@"/?page_id=26" parameters:params success:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSString *text = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];
        NSLog(@"Response: %@", text);
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        NSLog(@"%@", [error localizedDescription]);
    }];
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:10:23.463

我会认真地重新考虑不使用 MFMailComposeViewController——它是内置的、熟悉的并且可以工作。

当然，AFNetworking 不能直接发送电子邮件。看起来您正在使用 AFNetworking 与接受参数然后发送电子邮件的服务器进行通信。连接 POST 请求端点由您决定——AFNetworking 的一切看起来都很好（尽管您通常不会为 POST 请求附加查询字符串——这可能只是另一个 POST 参数）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T07:04:19.053

我不确定您遇到了什么特殊问题，但似乎在成功块内您使用的是自己的（空）`response`变量，而不是`responseObject`自动为您创建的变量。

即，如果您执行以下操作，那么您至少会看到服务器返回的内容：

```
NSString *text = [[NSString alloc] initWithData:responseObject encoding:NSUTF8StringEncoding]; 
```

# ruby-on-rails - 不是模型属性的表单字段

> ID：10965342
> 
> 赞同：1
> 
> 时间：2012-06-09T23:32:05.503
> 
> 标签：ruby-on-rails

用于创建我的模型的新实例的“/new”表单需要上传和解析文件。文件本身不是模型的属性。但是解析文件的结果是。如果文件不是模型属性，我如何将文件传递给我的控制器以解析它。换句话说，如何在视图上为其放置一个输入字段，以及如何在控制器上访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T23:40:13.610

如果您添加`attr_accessor :virtual_field`到模型中，它将为您添加 model.virtual_field= 和 model.virtual_field 方法。这些是不会保存到 db 的内存属性。

# iphone - 按下“完成/返回”按钮时如何隐藏文本框键盘 Xcode 4.2

> ID：10965357
> 
> 赞同：56
> 
> 时间：2012-06-09T23:35:33.100
> 
> 标签：iphone, ios, xcode4.2

我在 Interface Builder 中创建了一个文本字段。我将它的“返回键”设置为完成。这是仅一行的输入（因此不需要多行）。

当用户点击完成按钮时如何隐藏虚拟键盘？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2012-06-09T23:39:11.080

实现委托方法`UITextFieldDelegate`，然后：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    self.yourIBtextField.delegate = self;
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [textField resignFirstResponder];
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-25T13:23:07.003

UITextView 没有任何方法可以在用户点击返回键时调用。

即使那样，如果您想这样做，请实现 UITextViewDelegate 的 textView:shouldChangeTextInRange:replacementText: 方法，并检查替换文本是否为 \n，隐藏键盘。

可能还有其他方法，但我不知道。

确保声明对 UITextViewDelegate 协议的支持。

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range 
replacementText:(NSString *)text {

    if([text isEqualToString:@"\n"]) {
        [textView resignFirstResponder];
        return NO;
    }
    return YES;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-14T17:57:10.817

使用 next 方法在 UIViewController 上创建类别

```
- (void)hideKeyboard
{
    [[UIApplication sharedApplication] sendAction:@selector(resignFirstResponder)
                                               to:nil
                                             from:nil
                                         forEvent:nil];
} 
```

# ios - 动画 ViewController 适用于 iOS 5，但不适用于 iOS 4

> ID：10965359
> 
> 赞同：0
> 
> 时间：2012-06-09T23:35:41.713
> 
> 标签：ios, core-animation, cakeyframeanimation

我在 ViewController B 中加载 ViewControllerA。它是一个小的动画角色，在一个更大的场景中。

在 ViewControllerA 内部，有一个旋转动画，如：

```
CAKeyframeAnimation *bobble = [CAKeyframeAnimation           animationWithKeyPath:@"transform.rotation"];

NSArray *times = [NSArray arrayWithObjects:[NSNumber numberWithFloat:0.0],
                  [NSNumber numberWithFloat:0.25],
                  [NSNumber numberWithFloat:0.5],
                  [NSNumber numberWithFloat:0.75],
                  [NSNumber numberWithFloat:1.0],
                  nil];

[bobble setKeyTimes:times];

NSArray *values = [NSArray arrayWithObjects:
                 [NSNumber numberWithFloat:degreesToRadian(0)],
                 [NSNumber numberWithFloat:degreesToRadian(5)],
                 [NSNumber numberWithFloat:degreesToRadian(0)],
                 [NSNumber numberWithFloat:degreesToRadian(-5)],
                 [NSNumber numberWithFloat:degreesToRadian(0)],
                 nil];

[bobble setValues:values];

bobble.repeatCount = HUGE_VALF;
bobble.autoreverses = YES;
bobble.duration = 5.0;
bobble.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
[self.view.layer addAnimation:bobble forKey:@"transform.rotation"]; 
```

它自己的 viewDidLoad 和 viewDidAppear 看起来像：

```
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view from its nib.
self.view.center = CGPointMake(640, 201);
[self.view setAnchorPointAndReposition:CGPointMake(.7, .7)];

}

- (void)viewDidAppear:(BOOL)animated
{
[super viewDidAppear:animated];
[self bobble];
[NSTimer scheduledTimerWithTimeInterval:3\. target:self   selector:@selector(blinkFromTimer:) userInfo:nil repeats:YES];
} 
```

在 iOS5+ 中，它加载和动画效果很好，在 iOS 4.3 中，它加载但看不到动画。

有什么见解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:02:39.747

除非您在 iOS 5 中使用新的父视图控制器支持，否则您不应该在另一个视图控制器中托管一个视图控制器。即使在 iOS 5 中，使用视图控制器来管理一个小的动画角色也是严重的矫枉过正，而且可能不太适合一点也不。最好创建 UIView 的自定义子类并使用它。

在另一个 iOS 5 之前的版本中托管一个视图控制器是可能的，但是你有责任让一切正常工作，你最终会在每一步都与操作系统设计作斗争。我在 iPhone SDK 的早期（一开始就知道它）进行了这场战斗并放弃了。从头到尾都是一场噩梦。我强烈建议不要这样做。

我知道一位主要的软件开发人员（Apple 合作伙伴级别）的应用程序 Apple 威胁要从商店中删除这样做的应用程序。

# html - 如何防止填充的子元素溢出其父元素？

> ID：10965365
> 
> 赞同：8
> 
> 时间：2012-06-09T23:36:43.637
> 
> 标签：html, css, width, padding

[从这个例子](http://jsfiddle.net/jWs8c/1/)可以看出，`input`似乎“溢出”了它的父级`div`。我想在`input`不使其溢出其父级的情况下添加填充。

我想知道每个浏览器（包括 IE、Firefox、Chrome 等）的最佳解决方案/解决方法。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-09T23:57:16.093

你可以看到[这个答案](https://stackoverflow.com/questions/5219175/width-100-padding)，但如果你不喜欢它，你可以`box-sizing`像这样使用 CSS3 属性：

```
input {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
} 
```

[现场 jsFiddle 示例](http://jsfiddle.net/jWs8c/9/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T23:48:47.523

填充会增加对象的宽度。一种选择是从输入中删除左/右填充并仅使用文本缩进，尽管这会删除右填充。

```
.inside{
    background: blue;
    border: none;
    padding-bottom: 10px;
    padding-top: 10px;
    text-indent: 10px;
    width: 100%;
} 
```

或者，您可以使用百分比，并从宽度中减去该值，而不是使用硬编码的像素宽度作为填充：

```
.inside{
    padding: 3%;
    width: 94%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T23:47:31.950

看起来输入在 div 内，但位于左上角。因为输入占据了 div 的 100% 的宽度，所以它掩盖了 div 的红色背景。div 较长，因此它伸出底部，使输入看起来像是在顶部。请执行下列操作：

*   **将填充应用于外部 div 的 CSS 而不是输入框**。
    如果需要，您可以对输入应用边距，但我认为填充包含的 div 更好。
    *   使输入框的宽度小于 div (<100%)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T23:39:16.377

不要将内部 div 的宽度指定为`100%`. div 将自动适应其父容器的宽度。[演示](http://jsfiddle.net/jWs8c/3/)

# http - 来自 shell 脚本的 curl

> ID：10965367
> 
> 赞同：0
> 
> 时间：2012-06-09T23:36:56.000
> 
> 标签：http, shell, unix, curl

我正在尝试使用 curl 删除一些对象。我有一个文件中的 onjects 的 id 列表。我遍历列表并发出这样的 del ：

```
bash -x del.sh tempId.log

+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id
+ curl -H 'Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA' -X DELETE https://url/id
[{"message":"Session expired or invalid","errorCode":"INVALID_SESSION_ID"}]+ read id 
```

这是脚本

```
 #!/bin/bash
    while read id; do
    curl -H "Authorization:OAuth 00D30000001FxvA%21AQEAQKkcrruykRDNDapigaEdJXOc4SS_D27o686DScK8pU22BeMsgWVsWJ.Nv0DXimx2zBFKYlAUeDnGgokY2pU8m9xMoe73&apv=1&cshc=0000004qUmq0000001FxvA" -X DELETE https:url/$id
    done <$1 
```

但是，如果我在终端上运行相同的 curl 命令，它可以正常工作！

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:56:13.857

如果 URL 中有与号 (&)，我会遇到麻烦。这需要在 shell 脚本中转义，而不是在命令行中。

例如：

```
http://myweb.com/myservlet?asd=1&jkl=2 
```

需要是

```
http://myweb.com/myservlet?asd=1\&jkl=2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T17:44:08.537

正如其他人已经指出的那样，很少有事情

1.  是什么`url`？需要是变量的实际 url，该变量`$url`在使用之前具有初始化的值。

2.  请确保，解析后的完整 url 会导致您需要的实际 URL。为它做一个回声。

# ruby-on-rails - rails 3.2.2 和rocket_tag 没有这样的列

> ID：10965368
> 
> 赞同：2
> 
> 时间：2012-06-09T23:37:23.120
> 
> 标签：ruby-on-rails

我是 Rails 的新手，并且能够创建一个带有acts_as_taggable 用于标记的应用程序。我正在切换到 Rocket_tag，因为您可以轻松地同时按标签和活动关系进行搜索。

我按照安装说明进行操作，并创建了正确的表。问题是当我尝试保存标签时，代码如下：

```
class Performance < ActiveRecord::Base 
  attr_taggable :tags
  attr_accessible :description, :start, :tags 
```

然后在用数据填充数据库时

```
50.times do
  description = Faker::Lorem.sentence(5)
  start = Date.new(2008,12,30)
  users.each { |user| user.performances.create!(description: description, start: start, tags:["comedy"]) }
end 
```

我得到下面的错误

```
SQLite3::SQLException: no such column: taggings.tags: DELETE FROM "taggings" WHERE 
"taggings"."taggable_id" = 1 AND "taggings"."taggable_type" = 'Performance' 
AND "taggings"."context" = "taggings"."tags" 
```

models 可标记属性是 :tags ，并且 rocket_tag gem 正在尝试将其作为 taggings 表的列进行访问。

关于接下来要看什么的任何想法都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T10:42:49.603

在最新的 squeel gem 版本 (1.0.5) 上，rocket_tag 加载标签的方式存在错误

您可以将 squeel 恢复为 1.0.1 或使用此处的固定代码[https://github.com/bradphelan/rocket_tag/issues/16](https://github.com/bradphelan/rocket_tag/issues/16)

# c# - 从 c# Winform 运行 20 分钟 Excel 宏

> ID：10965369
> 
> 赞同：3
> 
> 时间：2012-06-09T23:37:44.253
> 
> 标签：c#, winforms, excel

我们有一个大约需要 20 分钟才能完成的宏。我们有用户可以访问的 ac# winform - 它包含一个“运行宏”按钮。我希望用户可以点击按钮，然后实际关闭表单，然后在 20 分钟内查看预定义目录中宏的输出。

它只是创建一个委托并让委托运行宏的情况，还是上述不是一件小事？

几个可能可行的想法：

*   只是在用户按下按钮后隐藏表单？缺点是宏仍然会在 Excel 实例中占用用户的 CPU？
*   UserX 电脑上的 winForm 能否以某种方式启动一个在我们的“Excel”服务器上运行的程序？这听起来很牵强，但也许有人可以提供帮助。
*   与上述类似，也许在 Excel 服务器上，我可以创建一个小型守护程序控制台应用程序，该应用程序计划每 2 秒运行一次，并检查共享数据库上的表以查看是否需要运行任何宏。用户的 winform 可以更新这个控制表，然后守护进程开始工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:07:08.157

是的，这很简单。

使用 C# 启动 VBS 文件。代码将类似于

```
System.Diagnostics.Process.Start(@"cscript //B //Nologo c:\MyScript.vbs"); 
```

上面的代码将启动 VBScript，没有提示或错误，也没有 shell 标志。

下一步是创建一个 vbs 文件。

打开记事本并粘贴此代码并将其保存为`MyScript.vbs`文件

```
Dim xlApp, xlBook

Set xlApp = CreateObject("Excel.Application")
'~~> Change Path here
Set xlBook = xlApp.Workbooks.Open("C:\Test.xls", 0, True)
xlApp.Run "TestMacro"
xlBook.Close
xlApp.Quit

Set xlBook = Nothing
Set xlApp = Nothing 
```

# hlsl - 直接计算hlsl numthreads？

> ID：10965372
> 
> 赞同：0
> 
> 时间：2012-06-09T23:38:06.043
> 
> 标签：hlsl, directx-10, directcompute

由于您已经定义了调度计算着色器时要执行的线程组，所以着色器文件中的数字表示什么？示例：[numthreads(1, 1, 1)]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T12:07:42.977

进行了更多挖掘，根据官方定义，在调度时定义线程组，而 numthreads 语句定义线程，因此基本上可以将它们视为额外维度。例如，当我将 2,2,1 分派给具有 3,1,1 的函数时，它会生成

```
enter code here
0, 0, 0 - 0, 0, 0
0, 0, 0 - 1, 0, 0
0, 0, 0 - 2, 0, 0

1, 0, 0 - 0, 0, 0
1, 0, 0 - 1, 0, 0
1, 0, 0 - 2, 0, 0

0, 1, 0 - 0, 0, 0
0, 1, 0 - 1, 0, 0
0, 1, 0 - 2, 0, 0

1, 1, 0 - 0, 0, 0
1, 1, 0 - 1, 0, 0
1, 1, 0 - 2, 0, 0 
```

所以 2*2*1*3*1*1 = 总共 12 个线程

# java - Java midi 音量控制不起作用

> ID：10965377
> 
> 赞同：6
> 
> 时间：2012-06-09T23:39:01.360
> 
> 标签：java, midi, javasound

很长一段时间以来，我一直在尝试让 midi 音量控制在 MidiPlayer 类中工作。我已经在 stackoverflow 和整个 Internet 上搜索了完成此操作的示例，但我尝试的任何方法似乎都不起作用。音量保持不变！它不会像我想要的那样改变。

我在 Windows 7 专业版上运行 Java 1.6.0_32。

这里！拥有 SSCCE：

```
 import java.io.*;
  import javax.sound.midi.*;
  import java.net.URL;

  public class MidiSSCCE {
     public static void main(String[] args)
     {
        // creates the midi player and sets up its sequencer and synthesizer.
        MidiPlayer midiP = new MidiPlayer();    
        double volume = 1.0;

        // loads a midi from a url into the sequencer, but doesn't start playing it yet.
        midiP.load("http://www.vgmusic.com/music/computer/microsoft/windows/touhou_6_stage3_boss.mid",true);

        // set the midi to loop indefinitely.
        midiP.loop(-1);

        // start playing the midi.
        midiP.play(true);

        // while loop changes the volume of the midi while it is playing.
        while(true) {
           midiP.setVolume(volume);
           try { Thread.sleep(300); } catch(Exception e) {}
           volume -= 0.1;
           if(volume < 0) volume += 1.0;
        }
     }
  }

  /**
  * MidiPlayer
  * author: Stephen Lindberg
  * Last modified: Oct 14, 2011
  * 
  * A class that allows midi files to be loaded and played.
  **/

  class MidiPlayer {
     private Sequence seq;
     private Sequencer seqr;
     private Synthesizer synth;
     private Receiver receiver;
     private File midiFile;
     private String midiID;
     private boolean loaded;
     private boolean usingHardwareSoundbank;

     // CONSTRUCTORS

     public MidiPlayer() {
        loaded = false;
        try  {
           // obtain the sequencer and synthesizer.
           seqr = MidiSystem.getSequencer();
           synth = MidiSystem.getSynthesizer();

           // print the user's midi device info
           System.out.println("Setting up Midi Player...");
           System.out.println("MidiDeviceInfo: ");
           for(MidiDevice.Info info : MidiSystem.getMidiDeviceInfo()) {
              System.out.println("\t" + info.getName() + ": " +info.getDescription());
           }
           System.out.println();

           // obtain the soundbank and receiver.
           Soundbank soundbank = synth.getDefaultSoundbank();
           if(soundbank == null) {
              receiver = MidiSystem.getReceiver();
              usingHardwareSoundbank = true;
              System.out.println("using hardware soundbank");
           }
           else {
              synth.loadAllInstruments(soundbank);
              receiver = synth.getReceiver();
              usingHardwareSoundbank = false;
              System.out.println("using default software soundbank:" + soundbank);
           }
           seqr.getTransmitter().setReceiver(receiver);
        }
        catch(Exception e) {
           System.out.println("MIDI error: I just don't know what went wrong! 6_9");
        }
     }

     // DATA METHODS

     /**
     *  load(String fileName)
     *  loads a midi file into this MidiPlayer.
     *  Preconditions: fileName is the name of the midi file to be loaded.
     *  Postconditions: fileName is loaded and is ready to be played.
     **/

     public void load(String fileName, boolean isOnline) {
        this.unload();
        try {
           URL midiURL;
           if(isOnline) midiURL = new URL(fileName);
           else midiURL =  getClass().getClassLoader().getResource(fileName);

           seq = MidiSystem.getSequence(midiURL);

           seqr.open();
           synth.open();

           // load our sequence into the sequencer.

           seqr.setSequence(seq);
           loaded = true;
        }
        catch(IOException ioe) {
           System.out.println("MIDI error: Problem occured while reading " + midiFile.getName() + ".");
        }
        catch(InvalidMidiDataException imde)  {
           System.out.println("MIDI error: " + midiFile.getName() + " is not a valid MIDI file or is unreadable.");
        }
        catch(Exception e)  {
           System.out.println("MIDI error: I just don't know what went wrong! 6_9");
        }
     }

     /**
     *  unload()
     *  Unloads the current midi from the MidiPlayer and releases its resources from memory.
     **/

     public void unload() {
        this.stop();
        seqr.close();
        synth.close();
        midiFile = null;
        loaded = false;
     }

     // OTHER METHODS

     /**
     *  play(boolean reset)
     *  plays the currently loaded midi.
     *  Preconditions: reset tells our midi whether or nor to begin playing from the start of the midi file's current loop start point.
     *  Postconditions: If reset is true, then the loaded midi begins playing from its loop start point (default 0). 
     *      If reset is false, then the loaded midi resumes playing from its current position.
     **/

     public void play(boolean reset) {
        if(reset)   seqr.setTickPosition(seqr.getLoopStartPoint());
        seqr.start();
     }

     /**
     *  stop()
     *  Pauses the current midi if it was playing.
     **/

     public void stop() {
        if(seqr.isOpen())   seqr.stop();
     }

     /**
     *  isRunning()
     *  Returns true if the current midi is playing. Returns false otherwise.
     **/

     public boolean isRunning() {
        return seqr.isRunning();
     }

     /**
     *  loop(int times)
     *  Sets the current midi to loop from start to finish a specific number of times.
     *  Preconditions: times is the number of times we want our midi to loop.
     *  Postconditions: The current midi is set to loop times times. 
     *      If times = -1, the current midi will be set to loop infinitely.
     **/

     public void loop(int times)
     {
        loop(times,0,-1);
     }

     /**
     *  loop(int times)
     *  Sets the current midi to loop from a specified start point to a specified end point a specific number of times.
     *  Preconditions: times is the number of times we want our midi to loop.
     *      start is our loop's start point in ticks.
     *      end is our loop's end point in ticks.
     *  Postconditions: The current midi is set to loop from tick start to tick end times times. 
     *      If times = -1, the current midi will be set to loop infinitely.
     **/

     public void loop(int times, long start, long end) {
        if(start < 0)   start = 0;
        if(end > seqr.getSequence().getTickLength() || end <= 0)   end = seqr.getSequence().getTickLength();

        if(start >= end && end != -1)   start = end-1;

        seqr.setLoopStartPoint(start);
        seqr.setLoopEndPoint(end);

        if(times == -1)   seqr.setLoopCount(Sequencer.LOOP_CONTINUOUSLY);
        else   seqr.setLoopCount(times);

     }

     public void setVolume(double vol) {
        System.out.println("Midi volume change request: " + vol);

        try {
           if(usingHardwareSoundbank) {
              ShortMessage volumeMessage = new ShortMessage();
              for ( int i = 0; i < 16; i++ ) {
                 volumeMessage.setMessage( ShortMessage.CONTROL_CHANGE, i, 7, (int)(vol*127) );
                 receiver.send( volumeMessage, -1 );
              }
           }
           else {
              MidiChannel[] channels = synth.getChannels();

              for( int c = 0; c < channels.length; c++ ) {
                 if(channels[c] != null)   channels[c].controlChange( 7, (int)( vol*127) );
              }
           }
        } 
        catch ( Exception e ) {
           e.printStackTrace();
        }
     }

  } 
```

我在以下来源尝试了示例但没有成功：

[http://www.java2s.com/Code/Java/Development-Class/SettingtheVolumeofPlayingMidiAudio.htm](http://www.java2s.com/Code/Java/Development-Class/SettingtheVolumeofPlayingMidiAudio.htm)

[如何控制 MIDI 通道的音量](https://stackoverflow.com/questions/8008286/how-to-controll-the-midi-channels-volume)

[https://forums.oracle.com/forums/thread.jspa?messageID=5389030](https://forums.oracle.com/forums/thread.jspa?messageID=5389030)

[带有 CC 的 MIDI 歌曲](https://stackoverflow.com/questions/9108996/midi-song-with-cc)

[http://www.codezealot.org/archives/27](http://www.codezealot.org/archives/27)

[http://www.exampledepot.com/egs/javax.sound.midi/Volume.html](http://www.exampledepot.com/egs/javax.sound.midi/Volume.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T16:21:29.427

我正在为控制声音的这些问题而苦苦挣扎，我找到了一个可以改变音量的代码。Unfurtunatly 我无法理解它，但是您的代码中有一些与我所看到的不同的东西。也许它可以帮助你。换行试试

```
seqr = MidiSystem.getSequencer(); 
```

为了

```
seqr = MidiSystem.getSequencer(false); 
```

也许它对你有帮助，我相信使用“假”音序器将连接到接收器，而不是合成器，然后当你将消息发送到接收器以设置音量时它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T10:00:08.790

```
public void setVolume(double vol) {
    System.out.println("Midi volume change request: " + vol);

    try {
        if(usingHardwareSoundbank) {
            ShortMessage volumeMessage = new ShortMessage();
            for ( int i = 0; i < 16; i++ ) {
                volumeMessage.setMessage( ShortMessage.CONTROL_CHANGE, i, 7, (int)(vol*127) );
                receiver.send( volumeMessage, -1 );
            }
        }
        else {
            MidiChannel[] channels = synth.getChannels();

            for( int c = 0; c < channels.length; c++ ) {
                if(channels[c] != null)   channels[c].controlChange( 7, (int)( vol*127) );
            }
        }
        // Very important!
        seqr.setSequence(seq);
    } 
    catch ( Exception e ) {
        e.printStackTrace();
    }
} 
```

# ruby-on-rails - 搜索查询未显示在简单搜索应用程序的 URL 中

> ID：10965380
> 
> 赞同：0
> 
> 时间：2012-06-09T23:39:28.520
> 
> 标签：ruby-on-rails, ruby, forms, search

我正在尝试构建一个在 Twitter 上搜索图像的应用程序。在我到达那里之前，我需要跳过构建一个将值输入函数的工作搜索字段的令人生畏的障碍。

在`index.html.erb`由 控制的文件中`Pages controller`，我有以下代码：

```
<%= form_tag root_path ({:controller => "pages", :action => "search", :method => "get", :class => "grabTweets" }) do %>
<%= text_field_tag :tweets, params[:tweets] %>
<% end %> 
```

在我的`Pages controller`我有：

```
 def search

    def grabTweets
      @tweet = Twitter.search(params[:tweets] + "[pic] "+" path.com/p/", :rpp => 3, :result_type => "recent").map do |status|
      @tweet = "#{status.text}" #class = string
      @urls = URI::extract(@tweet, "http") #returns an array of strings
    end 
  end       

end 
```

两个问题：

执行搜索后，我的搜索查询没有被传递到 grabTweets 函数中，正如 URL 所证明的那样：

`http://localhost:3000/?action=search&class=grabTweets&method=get`（搜索查询是单词“bridge”

我的代码有什么问题，搜索查询没有正确执行。

考虑到我希望搜索结果显示在 中并且不打算更改页面，我应该将控制器中的代码放在`def home`or中吗？`def search``root_path`

在此先感谢您的帮助！我完全被难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:33:50.917

我认为您需要阅读一本介绍 Rails 的书，因为您似乎缺少许多基础知识。

您有一个针对您所在页面的操作（您似乎称之为“主页”）和一个针对搜索结果的操作。您的表单需要调用搜索操作的 url。看起来像这样：

```
<%= form_tag({:controller => "pages", :action => "search"}, {:method => "get", :class => "grabTweets"}) do %>
... 
```

（有关form_tag 方法的更多详细信息，请参阅[API ）](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-form_tag)

在这种状态下，它将调用搜索操作（其中不应该有另一个称为`grabTweets`嵌套的方法 - 这没有意义），然后将呈现 search.html.erb（可能是搜索结果页面）。

在您的路线文件中，您需要一条既可用于主页又可用于搜索的路线。

如果您希望在不刷新页面的情况下更新页面，那么您需要`:remote => true`在表单上使用并使用 AJAX 处理响应。

如果您希望两个页面相同，但其中一个包含结果，则要么将搜索功能移动到主页操作中，并且仅在填充了 params[:tweets] 时才调用它，或者只让两个操作呈现相同的模板。

我建议阅读[渲染指南](http://guides.rubyonrails.org/layouts_and_rendering.html)和[控制器指南](http://guides.rubyonrails.org/action_controller_overview.html)以了解更多信息。

# asp.net-mvc - 视图没有向控制器发送正确的数据

> ID：10965381
> 
> 赞同：0
> 
> 时间：2012-06-09T23:39:45.980
> 
> 标签：asp.net-mvc

我有一个非常简单的局部视图，我正在使用 ajaxform。在我的部分视图中，我有一个单一的 textArea 和一个提交按钮。问题是我在文本区域中写入的任何内容，它都不会将数据发送到控制器，而是发送一个 =“Comment”的文本。如果我什么都不写，验证就完美了。

视图模型：

```
public class NoteCommentViewModel
{
    public Int32 Id { get; set; }

    [Required(ErrorMessage="Hey, if you dont wanna write then why pressing the button !!")]
    public string Comment { get; set; }

    public DateTime CommentDate { get; set; }
    public long UserId { get; set; }
    public double Rating { get; set; }
    public Guid NoteId { get; set; }
} 
```

控制器：

```
//
    //GET:/Notes/Comment/
    public ActionResult Comment(string id)
    {
        ViewBag.NoteId = id;
        var m = new NoteCommentViewModel()
        {
            NoteId = new Guid(id),
            UserId = Convert.ToInt64(Session["LoginUserId"].ToString()),
            //Comment=""

        };
        return PartialView(m);
    }
    //
    //POST:/Notes/Comment
    [HttpPost]
    public ActionResult Comment(NoteCommentViewModel nvm)
    {
        NoteRatingComments comment = new NoteRatingComments();
        comment.Comment = nvm.Comment; // Here I always have "Comment", regardless whatever I write in the page.
        comment.EntryDate = DateTime.Now;
        comment.NoteId = nvm.NoteId;
        comment.UserId = nvm.UserId;
        comment.Rating = 3.00;

        dc.NoteRatingComments.AddObject(comment);
        dc.SaveChanges();

        return Content(Boolean.TrueString);
    } 
```

风景：

```
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript">    </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"    type="text/javascript"></script>

@using (Ajax.BeginForm("Comment", "Notes", null, new AjaxOptions
{
UpdateTargetId = "Comment-message",
InsertionMode = InsertionMode.Replace,
HttpMethod = "POST",
OnSuccess = "commentSuccess"
}, new { id = "commentForm" }))
{
<div style="margin-top:20px;">
<div id="commentSuccess"></div>
<div class="comentPic">
    @{
        long UserId = Convert.ToInt64(Session["LoginUserId"].ToString());
        string Fullname = Session["LoginUserFullName"].ToString();
    }
  <img src='https://graph.facebook.com/@UserId/picture' height="100px" width="100px"/>
</div>
<div class="commentText">
    @Html.HiddenFor(m => m.UserId)
    @Html.HiddenFor(m=>m.NoteId)
    @Html.TextAreaFor(m => m.Comment, new { style = "width:600px;height:120px;" })
    <br />
    @Html.ValidationMessageFor(m => m.Comment)
    <div style="text-align:right;">
        <input type="submit" value="Comment" name="comment" class="btn"/>
    </div>
</div>
<div class="clear"></div>

</div>
} 
```

这是错误的屏幕截图......为了更好地理解。我在视图中写“数据”，但在控制器中我得到“评论”..它来自哪里？

![在此处输入图像描述](../Images/78776e83e5af7c57e7909c2181f350ac.png)

![在此处输入图像描述](../Images/fb9891f22df013d9d80290b544d02187.png) 如果有人可以帮助我找出问题，那就太好了......！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:48:41.783

我不确定你的问题到底是什么。但是下面的代码应该可以工作。

```
public class NoteCommentViewModel
{
    public Int32 Id { get; set; }

    [Required(ErrorMessage=" Your Error message")]
    [DataType(DataType.MultilineText)]   
    public string Comment { get; set; }

    //other properties
} 
```

在你的`View`, 像这样使用它

```
 @Html.EditorFor(m => m.Comment) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T11:32:47.273

问题是您的提交按钮的`name`属性与`Comment`textarea`name`属性相同。

要解决此问题，您需要将提交按钮更改为`name`“评论”以外的其他内容或`name`从提交按钮中删除属性，因此更改：

```
<input type="submit" value="Comment" name="comment" class="btn"/> 
```

到

```
<input type="submit" value="Comment" class="btn"/> 
```

因为`Ajax.BeginForm`使用 jQuery [.serializeArray()](http://api.jquery.com/serializeArray/)方法 - 因为您的提交按钮有一个`name`并且此输入触发提交 - 也将提交按钮的值`"Comment"`发送到服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T09:16:54.000

实际上你的代码很混乱。在您的视图中，您不`t use Model and seems you use m as your model and as i know this is completely wrong.i don`知道您的视图正在呈现，但无论您使用 m=>m.sth，第二个 m 都必须是 nothin.instead 您必须在 cshtml 文件的第一个定义您的 @model NoteCommentViewModel，然后使用 Model 而不是第二个 m

# arrays - 排序数组项后淘汰js强制重新绑定

> ID：10965383
> 
> 赞同：3
> 
> 时间：2012-06-09T23:40:19.087
> 
> 标签：arrays, sorting, knockout.js

淘汰 js 遇到问题。但在我看来这是一个错误。也许有一些解决方法。

[这里](http://jsbin.com/knockoutsortable/20/edit#javascript,html)有一个排序列表的例子，它可以工作。还有[另一个例子](http://jsbin.com/erovah/3/edit)，它没有。它们之间的唯一区别是 KO 版本。

任何帮助，将不胜感激。

**更新：** 我不知道原因，但在调用拼接方法后，KO 以某种不正确的方式刷新绑定。所以我找到了解决方法 - 强制重新绑定数组模型。

我用来强制重新绑定的代码如下：

```
 // newArray is ko.observableArray([...])
        var original = newArray();
        newArray([]);
        newArray(original); // KO will rebind this array 
```

有没有更优雅的方式来强制重新绑定？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T11:53:59.257

我相信这里发生的事情是，当您将新项目拼接到列表中时，Knockout 2.1 会正确更新列表，但 jQuery UI 可排序实现**也在**将项目添加到新列表中。

为了解决这个问题，我向可排序实现添加的项目添加了一个“拖动”类，然后在更新两个数组后将其删除（这会导致 UI 按预期更新）。

```
 $list
      .data('ko-sort-array', array)
      .sortable(config)
      .bind('sortstart', function (event, ui) {                  
        ui.item.data('ko-sort-array', array);
        ui.item.data('ko-sort-index', ui.item.index());
        ui.item.addClass('dragged'); // <-- add class here
      })
      .bind('sortupdate', function (event, ui) {
        var $newList = ui.item.parent();
        if($newList[0] != $list[0]){ return; }

        var oldArray = ui.item.data('ko-sort-array');
        var oldIndex = ui.item.data('ko-sort-index');

        var newArray = $newList.data('ko-sort-array');
        var newIndex = ui.item.index();

        var item = oldArray.splice(oldIndex, 1)[0];
        newArray.splice(newIndex, 0, item);
        $list.find('.dragged').remove(); // <-- remove the item added by jQuery here
      }); 
```

[你可以在这里](http://jsbin.com/ujijeg)看到这个工作

# git - 从 Jenkins 克隆本地 git 时访问被拒绝

> ID：10965385
> 
> 赞同：2
> 
> 时间：2012-06-09T23:40:39.117
> 
> 标签：git, deployment, jenkins

我在本地 linux 机器上使用 Jenkins。我有一个本地 git 存储库，它也使用 bitbucket 作为其来源。

我试图让 Jenkins 从本地 git 存储库构建，但每次构建时，都会出现以下错误：

```
Started by user Hippyjim 
Building in workspace /var/lib/jenkins/workspace/Staging
Checkout:Staging / /var/lib/jenkins/workspace/Staging - hudson.remoting.LocalChannel@15c0729
Using strategy: Default
Checkout:Staging / /var/lib/jenkins/workspace/Staging - hudson.remoting.LocalChannel@15c0729
Fetching changes from 1 remote Git repository
Fetching upstream changes from /home/hippyjim/PhpstormProjects/myRepo/.git
ERROR: Problem fetching from origin / origin - could be unavailable. Continuing anyway
hudson.plugins.git.GitException: Error performing command: git fetch -t /home/hippyjim/PhpstormProjects/myRepo/.git +refs/heads/*:refs/remotes/origin/*
Command "git fetch -t /home/hippyjim/PhpstormProjects/myRepo/.git +refs/heads/*:refs/remotes/origin/*" returned status code 255: error: cannot open    .git/FETCH_HEAD: Permission denied 
```

如果我运行它在错误消息中给出的克隆命令，它工作正常。我只需要 Jenkins 来获取这台本地机器上的更改，以便能够部署我的代码。我完全被困在这里 - 有人有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T13:34:52.550

结合 user37078 和 Mark O'Connor 的答案：

*   Jenkins 以什么用户身份运行？
*   是否从 /home/hippyjim/PhpstormProjects/myRepo 克隆（和/或获取）到其他地方进行构建？
*   **“权限被拒绝”错误表明这是用户访问问题**

# .htaccess - .htaccess 2 动态重写 URL

> ID：10965391
> 
> 赞同：0
> 
> 时间：2012-06-09T23:42:08.280
> 
> 标签：.htaccess, url, mod-rewrite

我有一个动态网址

```
http://www.technicae.net/cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%|tag|&limit=20 
```

'|标签|' 和“20”部分根据标签而变化。这是一个用 perl 编写的 Movable Type 博客平台。'|标签|' part 是标签的占位符。例如，如果标签是“那里”，则 url 将是

```
http://www.technicae.net/cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%there&limit=20 
```

并不是

```
http://www.technicae.net/cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%|tag|&limit=20 
```

我想知道如何在 htaccess 中重写它，因为我尝试的一切都不起作用。我希望它是

```
http://www.technicae.net/tag/|tag| 
```

代替

```
http://www.technicae.net/cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%|tag|&limit=20 
```

你能帮我么？

**注意**
URLS 不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:57:11.507

这就是您要搜索的内容：

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^tag/([^/]+)$               cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%$1 [L]
RewriteRule ^tag/([^/]+)/limit/([^/]+)$ cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%$1&limit=$2 [L] 
```

这将允许那些类型的 url：

*   `www.domain.com/tag/<myTag>`
*   `www.domain.com/tag/<myTag>/limit/<myLimit>`

但不是 ：

*   `www.domain.com/limit/<myLimit>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:57:39.883

假设您使用的是 Apache，请确保您启用了 mod_rewrite。

您应该使用的 .htaccess （这可能需要调整）是：

```
RewriteEngine On
RewriteRule ^tag/([^\.]+)$ cgi-bin/type/mt-search.cgi?IncludeBlogs=2&tag=2%$1&limit=20 [NC,L] 
```

# java - 显示我的 LinkedList 的元素不起作用

> ID：10965394
> 
> 赞同：0
> 
> 时间：2012-06-09T23:43:05.953
> 
> 标签：java, list, linked-list

调用 remove 方法后，我调用 display 并得到一个空列表；但是，如果我首先调用 display 方法，它将显示正确的列表，我猜“第一个”值到达了列表的末尾，或者我在某处得到了一个损坏的节点。任何帮助表示赞赏

```
public class LinkedList {

    private Node first;

    public LinkedList()
    {
        first = null;
    }

    //add students to the list
    public void add(Student s)
    {
        Node newNode = new Node(s);
        newNode.next = first;
        first = newNode;        
    }

    //remove duplicate records (return true if duplicate found)
    public boolean remove(String fn, String ln)
    {
        Student remove;
        boolean found = false;
        int duplicate = 0;
        while(first != null)
        {
            if(first.value.getFname().equals(fn) && first.value.getLname().equals(ln))
            {
                duplicate++;
                if(duplicate > 1)
                {
                    remove = first.value;
                    found = true;  

                }                
            }
            first = first.next;
        }
        if(found)
            return found;
        else
            return found;
    }

    //display list of student
    public void display()
    {
        if(first == null)
            System.out.println("List is empty!");
        else
        {
            while(first != null)
            {
                System.out.println(first.value);
                first = first.next;
            }            
        }            
    }

} 
```

主要的

```
public class Tester {

    public static void main(String[] args) {

        UnderGrad john = new UnderGrad("john", "doe", 2.7, "computer Science", "phisics");
        UnderGrad jorge = new UnderGrad("jorge", "vazquez", 3.8, "computer Science", "programming");
        UnderGrad john2 = new UnderGrad("john", "doe", 3.0, "Computer Engineering", "phisics");

        Advisor jim = new Advisor("jim", "smith");

        Grad jane = new Grad("jane", "doe", 3.0, "Electric Engineering", jim);       

        LinkedList students = new LinkedList();

        students.add(john);
        students.add(jorge);
        students.add(john2);
        students.add(jane);

        System.out.println(students.remove("john", "doe"));

        students.display();

    }
} 
```

输出

```
run:
true
List is empty!
BUILD SUCCESSFUL (total time: 1 second) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T23:56:59.410

您在方法中使用链表的头部 ( `first`) 作为迭代器`remove`。相反，使用局部变量：

```
for (Node current = first; current != null; current = current.next) {
    if (current.value.getFname().equals(...
    ...
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T23:57:21.123

你有一些错误。你不可能是这个意思： if(found) return found; 否则返回找到；

这将始终返回 true。

设置断点，绘制数据结构的图片（是的，用铅笔）并在调试器中观察数据结构，同时浏览代码。

如果你在这里得到一个代码答案，你也无法弄清楚下一个作业。对不起。

——阿奇博尔德教授。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T00:06:09.283

单步执行您的代码，并注意`first`在第一次调用`remove(...)`.

提示：它将是`null`.

由于是对其内容`LinkedList.first`的唯一引用，因此在您调用列表后，该列表已“忘记”其包含的内容。`LinkedList``remove()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T23:54:44.400

问题出在您的 add() 方法中。进去看看。:)

# c++ - 使用 C++ 入口点让 SDL 在 OSX 上工作

> ID：10965395
> 
> 赞同：1
> 
> 时间：2012-06-09T23:43:06.867
> 
> 标签：c++, objective-c, macos, opengl, sdl

我已经设置了一个用于构建我的软件的系统，使用生成文件和命令行工具。

我已经能够轻松地修改 makefile 以支持我的 Mac（现在是 10.7.4），所以我试图让我的代码独立于 XCode 工作。一旦我开始将东西移植到 iOS，我就会处理 XCode。我希望 makefile 解决方案（虽然我的代码库仍然可以通过所述 makefile 管理）为我提供更好的可移植性和自动化选项。

我正在体验[这里](http://graphicsnotes.blogspot.com/2010/01/programmatically-creating-window-in-mac.html)描述的内容。代码编译并在运行时遇到问题。

起初我使用的`-framework SDL`是 SDL 站点上二进制下载的 SDL 框架 ( )，所以我想我可以通过从源代码正确构建 SDL 来解决这个问题。我已经这样做了，现在正在链接到`libSDL.a`and `libSDLMain.a`。这反过来又要求我包含这些额外的框架才能成功编译（我根据以下输出提出了列表`sdl-config --static-libs`：

```
-framework Cocoa -framework IOKit -framework AudioToolbox -framework AudioUnit -framework Carbon -framework ApplicationServices 
```

但是我仍然有同样的问题，文章解释这与错过这个有关：

```
[NSApplication sharedApplication]; 
```

我的代码没有 Obj-C 代码。不过，我很高兴将一些 Obj-C 插入其中。我添加`SDLMain.m`了其中一个软件包，但链接器有一个问题：`ld: duplicate symbol _main`

好吧，所以我不会这么容易就逃脱的。

我缺少什么可以让我初始化我的 NSApplication 的小部件？有没有办法在没有单独的源文件（来自我的`Main.cpp`）的情况下做到这一点，现在必须是 Obj-C？是否有一些我可以调用`sharedApplication`的 C/C++ 包装函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:04:19.330

如果您使用`libSDLmain`或 include链接`SDLMain.m`，则您的入口点必须命名为 SDL_main ：

```
extern "C" int SDL_main(int argc, char **argv)
{
} 
```

（`extern "C"`考虑到您使用的是 C++ 的事实。）

`main`包含在`libSDLmain`or中的“真实”`SDLMain.m`进行必要的 Mac 特定准备，然后调用`SDL_main`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T00:10:50.777

对此也有一个纯 C 解决方案：执行编译器的工作，将 Objective-C 调用降低为 C 调用或一组 C 调用。

```
#include <objc/runtime.h>
#include <objc/message.h>

static void createSharedApplication(void)
{
    id myNSApplication = objc_getClass("NSApplication");
    SEL mySharedApplication = sel_registerName("sharedApplication");
    id (*myMsgSend)(id, SEL) = (id (*)(id, SEL))objc_msgSend;

    myMsgSend(myNSApplication, mySharedApplication);
} 
```

但是，如您所见，这不是很优雅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T00:15:12.167

RavuAlHemio 应归功于他，因为他为我指出了有关 SDL 正在使用入口点做什么（试图做什么）的足够信息。然后我稍微编辑了我的代码，从

```
#undef main
int main(int argc,char *argv[]) { 
```

到

```
int main(int argc,char *argv[]) { 
```

我使用第一种方法的唯一原因是因为在 Windows 上通过 MinGW（但不是 Linux）stdout 和 stderr 被重定向到文件而不是放在终端上。我现在必须为此想出一个更优雅的解决方案。

无论如何，这已经解决了问题。

# templates - Jade - 在脚本标签内使用块

> ID：10965406
> 
> 赞同：9
> 
> 时间：2012-06-09T23:46:32.417
> 
> 标签：templates, block, pug

嗨，我正在尝试使用 Jade 的**块**并**扩展**node.js 项目，并且想法是有这样的：

布局.jade：

```
head
    script
        $(document).ready(function() {
        block js_doc_ready
            //here goes the doc ready
        }); 
```

index.jade:

```
block js_doc_ready
    alert('hello!');
    alert('one more js line code');
    alert('end my js doc ready for this view'); 
```

这会给我一个 index.html 像这样：

```
...
<head>
    <script type="text/javascript">
            $(document).ready(function() {
                alert('hello!');
                alert('one more js line code');
                alert('end my js doc ready for this view');         
            });
    </script>
</head>
... 
```

但是当我看到结果时，**'block js_doc_ready'**不被认为是 Jade 块。此外，即使它被认为是一个块，**“alert('hello!);'** 不会被视为一个，而是一个翡翠标签。

这是我以前在 django 模板中做的事情，但是在带有所有这些标签的翡翠中，并且没有自由做纯 html 我仍然觉得做这些事情有点太奇怪了。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-10T17:53:17.913

Jade 不翻译“样式”和“脚本”代码中的内容。绝不。

可行的方法是基于我[对另一个问题](https://stackoverflow.com/a/10600487/1265207)的回答（使用样式元素，但基本相同）。

```
!!!
head
  title Hello jade
  | <script type='text/javascript'>
  | $(document).ready(function() {
      block js_doc_ready
  | });
  | </script> 
```

这样：jade 将包含 HTML 'script' 标签和 $.ready 行，但也会包含您的块。

# android - Android在root设备上截图

> ID：10965409
> 
> 赞同：9
> 
> 时间：2012-06-09T23:46:45.340
> 
> 标签：android, screenshot, root

**更新**还有许多其他帖子询问如何在android中获取屏幕截图，但似乎没有一个完整的答案。最初，由于我在尝试打开帧缓冲区的流时遇到了一个特定问题，所以我将此作为一个问题发布。现在我已经切换到将帧缓冲区转储到文件中，所以我更新了我的帖子以显示我是如何到达那里的。[作为参考（和确认），我从这篇文章](https://stackoverflow.com/q/10813548/1446554)中找到了将 FrameBuffer 发送到文件的命令（不幸的是，他没有提供他是如何做到这一点的）。我只是想念如何将我从帧缓冲区中提取的原始数据转换为实际的图像文件。

我的意图是完整转储 Android 设备上的实际屏幕。在不使用 adb 桥的情况下，我能找到的**唯一方法是直接访问系统的帧缓冲区。**显然，这种方法需要设备上的 root 权限以及运行它的应用程序！幸运的是，就我的目的而言，我可以控制设备的设置方式，并且使用为我的应用程序提供的 root 权限使设备成为 root 是可行的。我的测试目前正在运行 2.2.3 的旧 Droid 上进行。

我从[https://stackoverflow.com/a/6970338/1446554](https://stackoverflow.com/a/6970338/1446554)找到了如何处理它的第一个提示。经过更多研究后，我发现另一篇文章描述了如何以[root 身份正确运行 shell 命令](https://stackoverflow.com/a/5584154/1446554)。他们使用它来执行重新启动，我使用它将当前帧缓冲区发送到实际文件。我目前的测试仅通过 ADB 和基本 Activity 进行（每个都提供根）。我将在后台运行的服务中进行进一步的测试，更新即将到来！这是我可以将当​​前屏幕导出到文件的整个测试活动：

```
public class ScreenshotterActivity extends Activity {
    public static final String TAG = "ScreenShotter";

    private Button _SSButton;
    private PullScreenAsyncTask _Puller;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        _SSButton = (Button)findViewById(R.id.main_screenshotButton);
        _SSButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                if (_Puller != null)
                    return;
                //TODO: Verify that external storage is available! Could always use internal instead...

                _Puller = new PullScreenAsyncTask();
                _Puller.execute((Void[])null);
            }
        });
    }

    private void runSuShellCommand(String cmd) {
        Runtime runtime = Runtime.getRuntime();
        Process proc = null;
        OutputStreamWriter osw = null;
        StringBuilder sbstdOut = new StringBuilder();
        StringBuilder sbstdErr = new StringBuilder();

        try { // Run Script
            proc = runtime.exec("su");
            osw = new OutputStreamWriter(proc.getOutputStream());
            osw.write(cmd);
            osw.flush();
            osw.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        } finally {
            if (osw != null) {
                try {
                    osw.close();
                } catch (IOException e) {
                    e.printStackTrace();                    
                }
            }
        }

        try {
            if (proc != null)
                proc.waitFor();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        sbstdOut.append(readBufferedReader(new InputStreamReader(proc.getInputStream())));
        sbstdErr.append(readBufferedReader(new InputStreamReader(proc.getErrorStream())));
    }

    private String readBufferedReader(InputStreamReader input) {

        BufferedReader reader = new BufferedReader(input);
        StringBuilder found = new StringBuilder();
        String currLine = null;
        String sep = System.getProperty("line.separator");
        try {
            // Read it all in, line by line.
            while ((currLine = reader.readLine()) != null) {
                found.append(currLine);
                found.append(sep);
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                reader.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

        return null;
    }

    class PullScreenAsyncTask extends AsyncTask<Void, Void, Void> {

        @Override
        protected Void doInBackground(Void... params) {

            File ssDir = new File(Environment.getExternalStorageDirectory(), "/screenshots");
            if (ssDir.exists() == false) {
                Log.i(TAG, "Screenshot directory doesn't already exist, creating...");
                if (ssDir.mkdirs() == false) {
                    //TODO: We're kinda screwed... what can be done?
                    Log.w(TAG, "Failed to create directory structure necessary to work with screenshots!");
                    return null;
                }
            }
            File ss = new File(ssDir, "ss.raw");            
            if (ss.exists() == true) {
                ss.delete();
                Log.i(TAG, "Deleted old Screenshot file.");
            }
            String cmd = "/system/bin/cat /dev/graphics/fb0 > "+ ss.getAbsolutePath();
            runSuShellCommand(cmd);
            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            super.onPostExecute(result);
            _Puller = null;
        }
    }
} 
```

这也需要向`android.permission.WRITE_EXTERNAL_STORAGE`Manifest 添加权限。正如[这篇文章](https://stackoverflow.com/a/4435708/1446554)中所建议的那样。否则它会运行，不会抱怨，不会创建目录或文件。

最初，由于不了解如何正确运行 shell 命令，我无法从帧缓冲区获取可用数据。现在我已经切换到使用流来执行命令，我可以使用“>”将帧缓冲区的当前数据发送到实际文件......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T18:24:19.273

以编程方式，您可以运行“adb shell /system/bin/screencap -p /sdcard/img.png”，如下所示：

```
Process sh = Runtime.getRuntime().exec("su", null,null);
OutputStream  os = sh.getOutputStream();
os.write(("/system/bin/screencap -p " + "/sdcard/img.png").getBytes("ASCII"));
os.flush();
os.close();
sh.waitFor(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-03T15:44:24.107

ICS 设备的一个简单解决方案是从命令行使用以下命令

```
adb shell /system/bin/screencap -p /sdcard/screenshot.png
adb pull /sdcard/screenshot.png screenshot.png 
```

这会将 screenshot.png 文件保存在当前目录中。

在运行 4.0.3 的三星 Galaxy SII 上测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T11:29:24.403

对于不同的手机，情况会有所不同。这取决于您设备的底层图形格式。您可以使用系统调用轮询图形格式。如果您只打算在您知道图形格式的设备上运行它，您可以编写一个转换器将其转换为已知格式。

您可以查看以下项目：[http ://code.google.com/p/android-fb2png/](http://code.google.com/p/android-fb2png/)

如果您查看 fb2png.c 的源代码，您可以看到他们轮询 FBIOGET_VSCREENINFO，其中包含有关设备如何将屏幕图像存储在内存中的信息。一旦知道这一点，您应该能够将其转换为您可以使用的格式。

我希望这有帮助。

# php - 从几个 sql 表中回显数据

> ID：10965411
> 
> 赞同：0
> 
> 时间：2012-06-09T23:47:10.960
> 
> 标签：php, mysql

我从未尝试过，但想从几个不同的表中回显数据并按时间戳对它们进行排序。我提出的代码带有一个布尔值，我不知道为什么。

```
 <?php
$result = mysql_query("SELECT * FROM artists ORDER BY timestamp DESC
UNION
SELECT * FROM news ORDER BY timestamp DESC
UNION
SELECT * FROM tracks ORDER BY timestamp DESC
UNION
SELECT * FROM gigs ORDER BY timestamp DESC
UNION
SELECT * FROM feature ORDER BY timestamp DESC");

while($row = mysql_fetch_array($result)){echo'News: <a      href="index.html">'.$row['name'].$row['title'].$row['trackname'].$row['gigname'].'</a><br>'     ;}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T03:42:48.037

假设您的表属于 UNION 函数的约束。

尝试：

```
SELECT * FROM 
    (SELECT * FROM artists ORDER BY timestamp DESC
    UNION
    SELECT * FROM news ORDER BY timestamp DESC
    UNION
    SELECT * FROM tracks ORDER BY timestamp DESC
    UNION
    SELECT * FROM gigs ORDER BY timestamp DESC
    UNION
    SELECT * FROM feature ORDER BY timestamp DESC) as temp
ORDER by timestamp DESC; 
```

# facebook - Facebook 分享者标题和描述未加载

> ID：10965414
> 
> 赞同：0
> 
> 时间：2012-06-09T23:47:57.303
> 
> 标签：facebook

我尝试使用 和 格式制作自定义 url，`sharer.php?u=<url>&t=<title>`参数`sharer.php?p[title]=<title>&p[url]=<url>`使用 PHP 函数`urlencoded`和`rawurlencode`（单独尝试）编码。

我还在[https://developers.facebook.com/docs/share/](https://developers.facebook.com/docs/share/)`<a>`尝试了/`<script>`解决方案。

但它只将 url 显示为标题和描述。我还使用[https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)测试了该页面，并更正了所有内容。我正在使用`og:title`, `og:description`, `og:url`, `og:site_name`.

这里的想法用完了。任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T09:20:35.770

在一天什么都没做之后，这突然起作用了。Facebook 可能正在做一些缓存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T02:14:26.330

facebook 在通过短 url 加载和重定向 javascript 之前获取元标记信息

我从下面得到了正确的回应

1.  我没有使用短网址。
2.  我在渲染页面之前放置了元标记
3.  url页面的header可以被任何人在任何地方加载。（如果出现登录错误则不好。让任何人都可以显示url页面的header信息）

# linux - 使用 ssh 时出现“语法错误：文件意外结束”

> ID：10965416
> 
> 赞同：0
> 
> 时间：2012-06-09T23:48:21.593
> 
> 标签：linux, bash, upload, ssh, download

谁能告诉我这段代码有什么问题？它应该可以帮助我在远程服务器上进行速度测试。尝试使用 PUTTY 通过 SSH 执行它时出现以下错误：语法错误：文件意外结束

```
 ssh_server=$1
    test_file=".scp-test-file"
    # Optional: user specified test file size in kBs
    if test -z "$2"
    then
        # default size is 10kB ~ 10mB
        test_size="10000"
    else
        test_size=$2
    fi
    # generate a 10000kB file of all zeros
    echo "Generating $test_size kB test file..."
    `dd if=/dev/zero of=$test_file bs=$(echo "$test_size*1024" | bc) \
        count=1 &> /dev/null`
    # upload test
    echo "Testing upload to $ssh_server..."
    up_speed=`scp -v $test_file $ssh_server:$test_file 2>&1 | \
        grep "Bytes per second" | \
        sed "s/^[^0-9]*\([0-9.]*\)[^0-9]*\([0-9.]*\).*$/\1/g"`
    up_speed=`echo "($up_speed*0.0009765625*100.0+0.5)/1*0.01" | bc`
    # download test
    echo "Testing download to $ssh_server..."
    down_speed=`scp -v $ssh_server:$test_file $test_file 2>&1 | \
        grep "Bytes per second" | \
        sed "s/^[^0-9]*\([0-9.]*\)[^0-9]*\([0-9.]*\).*$/\2/g"`
    down_speed=`echo "($down_speed*0.0009765625*100.0+0.5)/1*0.01" | bc`
    # clean up
    echo "Removing test file on $ssh_server..."
    `ssh $ssh_server "rm $test_file"`
    echo "Removing test file locally..."
    `rm $test_file`
    # print result
    echo ""
    echo "Upload speed:   $up_speed kB/s"
    echo "Download speed: $down_speed kB/s" 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T23:50:16.270

从那些不属于变量赋值的命令周围删除反引号。

此外，请确保在续行反斜杠之后没有制表符、空格或回车（并且文件中根本没有回车）。

不要乘以丑陋的“0.0009765625”，而是除以`2^17`or `131072`。

为什么要除以 1？只是省略了。除以 100 而不是乘以 0.01。

即使变量的内容不太可能包含空格，您也应该养成在变量展开时始终引用变量的习惯。

```
#!/bin/bash
ssh_server=$1
test_file=".scp-test-file"
# Optional: user specified test file size in kBs
if test -z "$2"
then
    # default size is 10mB
    test_size="10000"
else
    test_size=$2
fi
# generate a file of all zeros
echo "Generating $test_size kB test file..."
dd if=/dev/zero of="$test_file" bs=$(echo "$test_size*1024" | bc) \
    count=1 &> /dev/null
# upload test
echo "Testing upload to $ssh_server..."
up_speed=$(scp -v "$test_file" "$ssh_server:$test_file" 2>&1 | \
    sed -n '/Bytes per second/s/^[^0-9]*\([0-9.]*\)[^0-9]*\([0-9.]*\).*$/\1/p')
up_speed=$(echo "scale = 2; $up_speed / 131072 * 100.0" | bc -l)
# download test
echo "Testing download to $ssh_server..."
down_speed=$(scp -v "$ssh_server:$test_file" "$test_file" 2>&1 | \
    sed -n '/Bytes per second/s/^[^0-9]*\([0-9.]*\)[^0-9]*\([0-9.]*\).*$/\2/p')
down_speed=$(echo "scale = 2; $down_speed / 131072 * 100.0" | bc -l)
# clean up
echo "Removing test file on $ssh_server..."
ssh $ssh_server "rm '$test_file'"
echo "Removing test file locally..."
rm "$test_file"
# print result
echo
echo "Upload speed:   $up_speed kB/s"
echo "Download speed: $down_speed kB/s" 
```

# python - 如何将 NumPy 数组转换为应用 matplotlib 颜色图的 PIL 图像

> ID：10965417
> 
> 赞同：220
> 
> 时间：2012-06-09T23:48:26.647
> 
> 标签：python, numpy, matplotlib, python-imaging-library, color-mapping

我有一个简单的问题，但我找不到一个好的解决方案。

我想采用代表灰度图像的 NumPy 2D 数组，并在应用一些 matplotlib 颜色图时将其转换为 RGB PIL 图像。

`pyplot.figure.figimage`我可以使用以下命令获得合理的 PNG 输出：

```
dpi = 100.0
w, h = myarray.shape[1]/dpi, myarray.shape[0]/dpi
fig = plt.figure(figsize=(w,h), dpi=dpi)
fig.figimage(sub, cmap=cm.gist_earth)
plt.savefig('out.png') 
```

虽然我可以调整它以获得我想要的（可能使用 StringIO 确实得到 PIL 图像），但我想知道是否没有更简单的方法可以做到这一点，因为它似乎是图像可视化的一个非常自然的问题。比方说，像这样：

```
colored_PIL_image = magic_function(array, cmap) 
```

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2012-06-10T08:55:47.260

相当繁忙的单线，但这里是：

1.  首先确保您的 NumPy 数组 ,`myarray`用 处的最大值进行归一化`1.0`。
2.  将颜色图直接应用于`myarray`.
3.  重新调整`0-255`范围。
4.  转换为整数，使用`np.uint8()`.
5.  使用`Image.fromarray()`.

你完成了：

```
from PIL import Image
from matplotlib import cm
im = Image.fromarray(np.uint8(cm.gist_earth(myarray)*255)) 
```

与`plt.savefig()`：

![在此处输入图像描述](../Images/29ba2c34969165dde093edd1579bef01.png)

与`im.save()`：

![在此处输入图像描述](../Images/f6534523eed5ba29540d63a512fc4f75.png)

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2020-06-02T03:29:42.393

*   输入 = numpy_image
*   np.unit8 -> 转换为整数
*   convert('RGB') -> 转换为 RGB
*   Image.fromarray -> 返回一个图像对象

    ```
    from PIL import Image
    import numpy as np

    PIL_image = Image.fromarray(np.uint8(numpy_image)).convert('RGB')

    PIL_image = Image.fromarray(numpy_image.astype('uint8'), 'RGB') 
    ```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-04-16T09:58:02.303

即使应用了评论中提到的更改，接受的答案中描述的方法对我也不起作用。但是下面的简单代码有效：

```
import matplotlib.pyplot as plt
plt.imsave(filename, np_array, cmap='Greys') 
```

np_array 可以是一个二维数组，其值从 0..1 floats o2 0..255 uint8 开始，在这种情况下它需要 cmap。对于 3D 数组，将忽略 cmap。

# facebook - Facebook Graph API / FQL：是否有可能知道两个用户中的哪一个与另一个用户取消了好友关系？

> ID：10965422
> 
> 赞同：0
> 
> 时间：2012-06-09T23:49:09.163
> 
> 标签：facebook, facebook-graph-api, facebook-fql

使用 Facebook FGraph API 或 FQL，如果我拥有所有 userA 权限，我能否知道 userA 是否与 userB 取消了好友关系？

事实上，这就是我想要实现的目标：

我拥有两个用户的*所有*权限。他们在一起是朋友（我可以使用 API 看到它）。

有一天，我发现他们不再是朋友了，我想知道**他们中的哪一个已经取消了另一个**。以某种方式或其他方式有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:55:30.133

我很确定你能做的最好的事情就是检测到他们不再是朋友，因为他们没有在彼此的朋友列表中列出。

然而，Facebook 强调禁止任何让人们知道某人何时与他们解除好友关系的应用程序。

# ruby - Rails：没有模型对象的支持 Ajax 的表单

> ID：10965423
> 
> 赞同：0
> 
> 时间：2012-06-09T23:49:10.420
> 
> 标签：ruby, ruby-on-rails-3

我是 Rails 新手，很难弄清楚如何在没有相应模型对象的情况下创建通过 Ajax 提交的表单。

我的用例是一个简单的表单，它收集电子邮件地址并发送电子邮件；没有什么要坚持的，所以没有模型。

在我*确实*有模型的情况下，我在`form_for(@model, remote: true)`. 对于没有模型的情况，我似乎找不到合适的帮手。我试过`form_tag(named_path, remote: true)`了，但没有使用 Ajax。

指向带有适当控制器示例的示例的指针，`.html.erb`将`routes.rb`不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:32:56.653

这是我解决它的方法。关键是使用`form_tag`并指定一个带有与我的路由正确匹配的参数的哈希。对于我的业务逻辑，我需要传入一个在控制器逻辑中使用的“id”参数。

```
<%= form_tag(sendmail_path({ id: 1}), remote: true) do %>
  <%= text_field_tag :email, params[:email] %>
  <%= submit_tag "Send", remote:true %>
<% end %> 
```

`routes.rb`：

```
MyApp::Application.routes.draw do
  post '/sendmail/:id(.:format)' => 'mycontroller#sendmail', :as => 'sendmail'
  # etc...
end 
```

我还必须提供一个 sendemail.js.erb 模板，它会在提交后更新表单。

# cocos2d-iphone - 平铺地图看起来像素化，但移动时，它们看起来很好

> ID：10965424
> 
> 赞同：0
> 
> 时间：2012-06-09T23:50:09.273
> 
> 标签：cocos2d-iphone

我在 cocos2d-iphone 中有一张平铺地图。它使用 .png 图像。

有时，当您仔细观察时，您会注意到某些部分“像素化”。质量很差。但是，如果你移动你的角色（并且地图滚动），它会突然修复并看起来很正常。如果你继续随机移动，你可能会看到它再次出错等等......

直到最近才发生这种情况。但这很奇怪，因为我再也没有碰过平铺地图。

这可能是什么原因造成的？iPhone 4，启用视网膜。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:01:31.293

精灵可能位于子像素上，例如`16.5f`，这可能会导致失真。

# sublimetext2 - 在 sublime 中阻止 HTML Tidy 添加额外的标签

> ID：10965426
> 
> 赞同：2
> 
> 时间：2012-06-09T23:50:28.227
> 
> 标签：sublimetext2, htmltidy

如何防止 Sublime 文本中的 HTML 整洁添加诸如此类的额外标签

这就是我要的

```
 <div class="row">
        <aside class="span4">
            <section>
            <%= render 'shared/user_info' %>
            </section>
            <section>
            <%= render 'shared/micropost_form' %>
            </section>
        </aside>
    </div> 
```

使用 HTML tidy 后，我得到了这个——我不想要

```
 <html>
        <head>
            <title></title>
        </head>
        <body>
            <div class="row">
                <aside class="span4">          
    <section>
        <%= render 'shared/user_info' %>
    </section>

    <section>
        <%= render 'shared/micropost_form' %>
    </section>

    </aside>
            </div>
        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T09:26:32.487

“HTML Tidy”不适合您想要做的事情。

对于您正在做的事情，sublime text 2 的“Reindent lines”功能应该就足够了。

# mysql - MySQL 从另一个表中计数有条件

> ID：10965427
> 
> 赞同：-1
> 
> 时间：2012-06-09T23:50:35.090
> 
> 标签：mysql, sql, database

我正在建立一个我不久前开发的解决方案 - 订票。我现在需要添加一项功能，以允许在购买期间“保留”门票，以使它们看起来像是出售给来到该网站的另一位客户（防止重复预订）。

原始表格的详细信息在我的上一个问题[MySQL - Trying to count sold for an event 中](https://stackoverflow.com/questions/5777108/mysql-trying-to-count-tickets-sold-for-an-event)。该`tickets`表现在有一个`held_until`DateTime 值和一个`paid`tinyint (bool) 值。

我`events.capacity - COUNT(tickets.id) AS available`现在只需要计算那些票：

*   值为`paid`1
*   值为`paid`0 和`held_until > now()`

我尝试添加`WHERE`和`HAVING`子句，但这些会阻止未售出门票的事件出现。我也玩过嵌套查询，但也没有得到任何结果......

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:19:03.873

修改 Andomar 的建议查询（在另一个主题中）如下：

改变

```
ON events.id = tickets.event_id 
```

到

```
ON ( events.id = tickets.event_id AND ( tickets.paid = 1 OR tickets.held_until > now() ) 
```

即使所有必需的信息都可以在您的其他主题中找到，在这里重复一些相关细节可能是一个好主意。

# javascript - 正则表达式 - 用 Ja vaScript 中的单个替换多行换行符

> ID：10965433
> 
> 赞同：29
> 
> 时间：2012-06-09T23:51:36.107
> 
> 标签：javascript, regex, replace

这是javascript中的某种可变内容：

```
 <meta charset="utf-8">

    <title>Some Meep meta, awesome</title>

    <-- some comment here -->
    <meta name="someMeta, yay" content="meep">

</head> 
```

我想将多换行符（未知数）减少到一个换行符，而其余的格式仍然保持不变。这应该`javascript`用`regex`.

我对制表器有问题或保留格式。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-06-10T00:21:00.797

试试这个：

```
text.replace(/\n\s*\n/g, '\n'); 
```

这基本上会寻找两个换行符，中间只有空格。然后它用一个换行符替换它们。由于全局标志`g`，对于每个可能的匹配都会重复此操作。

### 编辑：

> 是否可以留下双换行符而不是单个换行符

当然，最简单的方法是只查找三个换行符并将它们替换为两个：

```
text.replace(/\n\s*\n\s*\n/g, '\n\n'); 
```

如果您想在其中一行上保留空格（无论出于何种原因），您也可以这样做：

```
text.replace(/(\n\s*?\n)\s*\n/, '$1'); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-10T00:23:11.397

```
myText = myText.replace(/\n{2,}/g, '\n');​​​​​​​ 
```

## [看演示](http://jsfiddle.net/SsLb6/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-10T00:24:00.890

给定以下内容（请记住对 HTML 实体进行编码，例如`<`,`>`和（当然还有其他）`&`）：

```
<pre>
&lt;head&gt;

    &lt;meta charset="utf-8"&gt;

    &lt;title&gt;Some Meep meta, awesome&lt;/title&gt;

    &lt;-- some comment here -->
    &lt;meta name="someMeta, yay" content="meep"&gt;

&lt;/head&gt;
</pre>
<pre>
</pre>​ 
```

以下 JavaScript 有效：

```
var nHTML = document.getElementsByTagName('pre')[0].textContent.replace(/[\r\n]{2,}/g,'\r\n');
document.getElementsByTagName('pre')[1].appendChild(document.createTextNode(nHTML));​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/4Np3L/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-01T16:22:08.863

要替换所有额外的换行符并仅保留一种用途：

```
myText = myText.replace(/\n\n*/g,'\r\n');​​​​​​​ 
```

# vim - .vimrc 设置未在“屏幕”下加载？

> ID：10965435
> 
> 赞同：4
> 
> 时间：2012-06-09T23:52:03.947
> 
> 标签：vim, ssh, gnu-screen

当我 ssh 到我的一台服务器并执行“ls”时，文件夹以蓝色突出显示。如果我打开一个输入“vi 文件名”的文件，我的所有 .vimrc 设置都会被加载。

但是，当我运行“屏幕”时，所有文件夹都是绿色的，当我打开以使用 vi 编辑文件时，除非我使用“vim 文件名”，否则我的 .vimrc 设置都不起作用。

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T00:16:01.980

在 vim 中，您可以键入`:scriptnames`以查看所有已加载的脚本。
如果加载，`vimrc`将显示在顶部。

* * *

输入`:version`查看vim如何定位`.vimrc`文件，例如：

```
 system vimrc file: "$VIM/vimrc"
     user vimrc file: "$HOME/.vimrc"
      user exrc file: "$HOME/.exrc"
  system gvimrc file: "$VIM/gvimrc"
    user gvimrc file: "$HOME/.gvimrc"
    system menu file: "$VIMRUNTIME/menu.vim"
  fall-back for $VIM: "/usr/share/vim" 
```

`vim`将加载用户 vimrc 文件：`$HOME/.vimrc`.
`HOME`是您的 bash env var，`echo $HOME`在终端中键入以查看该值。

* * *

您可以键入`:echo $MYVIMRC`以查看最后使用了哪个 vimrc。

* * *

最终，您可以键入以下命令来启动 vim：

```
vim -V file.txt 
```

它会打印很多调试信息。您可以检查 vim 做了什么，包括采购 vimrc。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:54:11.483

此外，如果您正在运行`sudo vim`，则`.vimrc`永远不会从您的主目录应用。然后您需要使用`:version`命令（正如**@kev**指出的那样）查看系统`vimrc`文件的位置并将您的设置放在那里。

# php - PHP fgetcsv - 跳过列？

> ID：10965436
> 
> 赞同：0
> 
> 时间：2012-06-09T23:53:08.937
> 
> 标签：php, fgetcsv

我正在尝试导入 CSV，并且能够删除列，并且只导入选定的列。

所以我有一组选定的字段和 CSV 文件。我可以删除行，但在跳过列时遇到问题。

这是我用来显示表格的内容，只是试图测试删除列。这里没有什么花哨的。只需要知道在哪里放置任何 if 语句或任何东西。欢迎提示，建议，样品！

```
while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
                        echo("<tr>\r\n");
                        foreach ($data as $index=>$val) {
                        echo("\t<td>$val</td>\r\n");
                        } 
                        echo("</tr>\r\n");
               } //end while 
```

我在哪里放置任何 if 语句以仅允许其余行？我已经尝试过 in_array、array_diff 等 - 似乎没有任何效果？

现在我正在输入这个，我应该在插入之前使用 PHP 删除列吗？什么是最佳实践？

谢谢jt

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:30:51.633

尝试：

```
while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
    echo("<tr>\r\n");

    foreach ($data as $index=>$val) {
        if($index != BADINDEX) {
            echo("\t<td>$val</td>\r\n");
        }   
    }
    echo("</tr>\r\n");
} 
```

其中*BADINDEX*是您要删除的列号（第一列为 0）。

由于您从 fgetcsv 获得的是行而不是列，因此只需为打印的每一行过滤掉所需的列，这是通过检查 foreach 块中的索引来完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:35:29.293

您可以设置一个包含要显示的列的数组（在我的前 1 和 3 中），并使用 foreach 的关键部分来了解您正在扫描的列：

```
<?
$handle = fopen("test.csv", "r");

$columns = array(1,3);
while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        echo("<tr>\r\n");
        foreach ($data as $index=>$val) {
                if (in_array($index+1, $columns)) {
                        echo("\t<td>$val</td>\r\n");
                }
        }
        echo("</tr>\r\n");
} //end while

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-25T23:15:07.000

这是旧帖子，但我找到了另一种可能对某人有所帮助的方法：

```
$file = fopen($yourcsvfile, 'r');

    while (($result = fgetcsv($file, 1000, ",")) !== false)
    {
        $temp = array();
        $temp[] = $result[1]; // the column you want in your new array
        $temp[] = $result[2]; // the column you want in your new array
        $csv1[] = $temp;
    } 
```

# javascript - 如果 Chrome 扩展程序崩溃，我如何让另一个扩展程序重新加载崩溃的扩展程序？

> ID：10965441
> 
> 赞同：1
> 
> 时间：2012-06-09T23:54:45.943
> 
> 标签：javascript, html, google-chrome, google-chrome-extension

我似乎找不到办法做到这一点。知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:28:15.347

您可以启用或禁用扩展程序，但无法知道它何时崩溃。

```
var id = "afhufhsauofhgshoughueghoegr",
    enable = true;
chrome.management.setEnabled(id, enable, function(){
    alert("Enabled.")
}) 
```

经许可`management`。

```
"permissions": [
  "management"
] 
```

* * *

您可以尝试，但我不知道这是否也适用于崩溃：

```
chrome.management.onDisabled.addListener 
```

* * *

有关更多信息，请参阅[文档](http://code.google.com/chrome/extensions/management.html)。

# c++ - 尝试分配值时，用于继承的 C++ 代码中断

> ID：10965442
> 
> 赞同：0
> 
> 时间：2012-06-09T23:54:49.127
> 
> 标签：c++, visual-studio-2010, inheritance

我正在尝试编写这段代码，其中有 2 个类继承自父类。但是当我尝试在链接列表中使用它时，这段代码会中断。这是代码

```
class airship{

public:
    airship(){};
//  virtual ~ airship();
    virtual void setData (string)=0;
    virtual void showData()=0;
    void setNext(airship* newptr);
    airship* getNext();
    void setType(int n){airshipType=n;}
    int getType(){return airshipType;}
    void setCount(int n){maxPassengerCount=n;};
    int getCount(){return maxPassengerCount;}
    void setWeight(int n){maxCargoWeight=n;}
    int getWeight(){return maxCargoWeight;}

protected:
    int maxPassengerCount;
    int maxCargoWeight;
    int airshipType;

private:
    airship* next;
};

class airplane: public airship{

protected:

    const char* airplaneName;
    int engineType;
    double range;

public:
    airplane():airship(){};
//  ~ airplane();
    void setData(string);
    void showData();
    void setEngine(int n){engineType=n;}
    int getEngine(){return engineType;}
    void setRange(int n){range=n;}
    int getRange();

};

class balloon : public airship{

protected:
    const char* balloonName;
    int gasType;
    double maxAltitude;

public:
    balloon():airship(){};
//  ~balloon();
    void setData(string);
    void showData();
    void setGas(int);
    int getGas();
    void setAlt(int);
    int getAlt();

};

class mylist{

private:
    airship* headAirship;
public:
    void createlist(fstream&);
    void setAirship(airship* Node){Node=headAirship;}
    airship* getAirship(){return headAirship;}
};

void airship::setNext(airship* Node)
{
    this->next=Node;
}

void airplane::setData(string line)
{
    string line1;
    bool flag=true;
    int npos=0,nend,count=0;
    while(line.c_str()!=NULL && flag)
    {
        nend=line.find(",",npos);

        if (nend!=-1)
        {
            line1=line.substr(npos,nend);
        }
        else
        {
            line1=line;
            flag=false;
        }
        line=line.substr(nend+1,line.length());

        if (count==0)
            this->airshipType=atoi(line1.c_str());
        else if(count==1)
            this->airplaneName=line1.c_str();
        else if(count==2)
            this->maxPassengerCount=atoi(line1.c_str());
        else if(count==3)
            this->maxCargoWeight=atoi(line1.c_str());
        else if(count==4)
            this->engineType=atoi(line1.c_str());
        else
            this->range=atoi(line1.c_str());

        count=count+1;
    }
}

void balloon::setData(string line)
{
    string line1;
        bool flag=true;
        int npos=0,nend,count=0;
        while(line.c_str()!=NULL && flag)
        {
            nend=line.find(",",npos);

            if (nend!=-1)
            {
                line1=line.substr(npos,nend);
            }
            else
            {
                line1=line;
                flag=false;
            }
            line=line.substr(nend+1,line.length());

            if (count==0)
                this->airshipType=atoi(line1.c_str());
            else if(count==1)
                this->balloonName=line1.c_str();
            else if(count==2)
                this->maxPassengerCount=atoi(line1.c_str());
            else if(count==3)
                this->maxCargoWeight=atoi(line1.c_str());
            else if(count==4)
                this->gasType=atoi(line1.c_str());
            else
                this->maxAltitude=atoi(line1.c_str());

            count=count+1;
        }

}

void mylist::createlist(fstream &myfile)
{

    string ipdata;
    int type;

    while (getline(myfile,ipdata))
    {
            airship* newNode;
            type=ipdata.find(",",0);
            string ch=ipdata.substr(type-1,type);
            if (atoi(ch.c_str())==0)
            {
                airplane* planeNode=new airplane();
                planeNode->setData(ipdata);
                newNode=planeNode;
            }
            else
            {
                balloon* balloonNode=new balloon();
                balloonNode->setData(ipdata);
                newNode=balloonNode;
            }
            newNode->setNext(headAirship);
            this->headAirship=newNode;

    }

}

int main()
{
    mylist* list=0;
    airship* firstNode=0,*otherNode=0;

    /*if(argv[1]==NULL)
    {   
        cout<<"File not Found"<<endl;
        return -1;      
    }*/

    fstream ipFile("data.txt",ios::in | ios::out);

    if(ipFile.is_open())
    {
        list->createlist(ipFile);
    }

    list->setAirship(firstNode);

    return 0;
} 
```

plane::setdata(string) 函数无法正常工作，并且无法在 createList 函数中检测到 headAirship 指针。这就是为什么当我尝试执行此操作时在 createlist 函数中出现内存异常错误：newNode- >setNext(headAirship);

> Assignment4Solution2.exe 中 0x00912ae0 处的未处理异常：0xC0000005：
> 访问冲突读取位置 0x00000000。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:19:49.447

我认为问题出在这里：

```
mylist* list=0; 
```

在该行中，您创建了一个指向**myList**对象的指针，但您没有使其指向任何此类对象；它指向地址 0

然后你做

```
list->createlist(ipFile); 
```

由于 list 没有指向包含**myList**对象的地址，因此调用任何 myList 方法都应该给出您观察到的错误：访问冲突读取位置 0x00000000。

相反，当您创建列表指针时，调用 myList 的构造函数，以便创建对象并将指针初始化为指向它

```
myList * list = new myList(); 
```

希望有帮助:)

# google-app-engine - Google App Engine Hello World 不工作（Eclipxse，Java）

> ID：10965446
> 
> 赞同：1
> 
> 时间：2012-06-09T23:56:51.050
> 
> 标签：google-app-engine

我检查并重新检查以确保我已正确完成所有操作，修复了 java 1.7 的一些问题（将 java 合规性设置为 1.6）等，并在开发模式和调试模式下运行程序。

但是当我转到给定的 URL (http://localhost:8888) 时，我得到一个 404 屏幕：

HTTP 错误：404

访问 / 时出现问题。原因：

```
NOT_FOUND 
```

由码头提供支持：//

* * *

欢迎文件 index.html 位于 war 目录中，web.xml 将 index.html 列为欢迎文件。当我尝试在 /_ah/admin 获取管理控制台时，我也会看到相同的屏幕。我能找到的日志没有显示任何内容。显然，GAE 在使用 Jetty 时正在工作，我输入的任何其他端口号都会给我一个浏览器错误：

哎呀！Google Chrome 无法连接到 localhost:8887 建议：尝试重新加载：localhost:8887 在 Google 上搜索：

* * *

那么可能是什么问题呢？我检查了文件和目录权限，但我是这台计算机上唯一的用户......任何想法或帮助表示赞赏。

詹姆士

编辑我发现了问题。我的浏览器缓存包含我之前在工作区中安装的另一个包。在终止所有启动后简单地清除缓存是可行的解决方案。然后，我能够继续学习出色的教程。

[http://googcloudlabs.appspot.com/whatgae.html](http://googcloudlabs.appspot.com/whatgae.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T00:14:27.003

GAE 需要一个受控的设置和一个遵循和开始的好地方是 GAE 教程。这是一个链接[GAE教程](https://developers.google.com/appengine/docs/java/gettingstarted/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-08T14:06:58.830

看看我[这里](https://stackoverflow.com/a/25205337/751641)的回答。

您还必须在 Project Facet 中更改 Java 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T03:35:28.063

GAE 还不支持与 Java 1.7 一起运行。为 Eclipse 设置合规模式没有任何效果。

您从 Eclipse 中收到的端口 :8887 错误告诉您本地计算机上没有应用程序正在侦听该端口。它没有提供任何关于 GAE 是否有效的证据。

使用 Java 1.6 再试一次。

# php - 关键字“use”在 PHP 中是如何工作的，我可以用它导入类吗？

> ID：10965454
> 
> 赞同：159
> 
> 时间：2012-06-09T23:57:29.880
> 
> 标签：php, import, include

我有一个带有类的文件`Resp`。路径是：

```
C:\xampp\htdocs\One\Classes\Resp.php 
```

我`index.php`在这个目录中有一个文件：

```
C:\xampp\htdocs\Two\Http\index.php 
```

在这个`index.php`文件中，我想实例化一个类`Resp`。

```
$a = new Resp(); 
```

我知道我可以使用`require`or`include`关键字将文件包含在一个类中：

```
require("One\Classes\Resp.php");       // I've set the include_path correctly already ";C:\xampp\htdocs". It works.
$a = new Resp(); 
```

但我想在不使用`require`or的情况下导入类`include`。我试图了解`use`关键字的工作原理。我尝试了这些步骤，但没有任何效果：

```
use One\Classes\Resp;
use xampp\htdocs\One\Classes\Resp;
use htdocs\One\Classes\Resp;
use One\Classes;
use htdocs\One\Classes;    /* nothing works */

$a = new Resp(); 
```

它说：

```
Fatal error: Class 'One\Classes\Resp' not found in C:\xampp\htdocs\Two\Http\index.php 
```

关键字是如何`use`工作的？我可以用它来导入类吗？

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2014-08-05T12:34:39.403

不，您不能使用`use`关键字导入类。你必须使用`include`/`require`声明。即使您使用 PHP 自动加载器，自动加载器仍然必须使用其中一个`include`或在`require`内部使用。

**使用**关键字的目的：

考虑一个例子，你有两个同名的类；你会觉得很奇怪，但是当你使用一个大型的 MVC 结构时，它就会发生。因此，如果您有两个具有相同名称的类，请将它们放在不同的名称空间中。现在考虑您的自动加载器何时加载两个类（由 执行`require`），并且您将要使用类的对象。在这种情况下，编译器会混淆在两个类对象中加载哪个类对象。为了帮助编译器做出决定，您可以使用该`use`语句，以便它可以决定将使用哪个语句。

如今主要框架确实使用`include`或`require`通过`composer`和`psr`

1)[作曲家](https://getcomposer.org/)

2) [PSR-4](http://www.php-fig.org/psr/psr-4/)自动装弹机

浏览它们可能会进一步帮助您。您还可以使用别名来处理确切的类。假设你有两个同名的类，比如`Mailer`有两个不同的命名空间：

```
namespace SMTP;
class Mailer{} 
```

和

```
namespace Mailgun;
class Mailer{} 
```

如果您想同时使用两个 Mailer 类，那么您可以使用别名。

```
use SMTP\Mailer as SMTPMailer;
use Mailgun\Mailer as MailgunMailer; 
```

稍后在您的代码中，如果您想访问这些类对象，那么您可以执行以下操作：

```
$smtp_mailer = new SMTPMailer;
$mailgun_mailer = new MailgunMailer; 
```

它将引用原始类。

有些人可能会感到困惑，如果没有相似的类名，那么就没有使用`use`关键字。好吧，您可以使用将在执行语句时`__autoload($class)`自动调用的函数，并将`use`类用作参数，这可以帮助您在需要时在运行时动态加载类。

请参阅此[答案](https://stackoverflow.com/questions/1830917/how-do-i-use-php-namespaces-with-autoload)以了解有关类自动加载器的更多信息。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2012-06-10T00:00:14.600

`use`不包括任何东西。它只是将指定的命名空间（或类）导入到当前范围

如果您希望自动加载类 - 请阅读有关[自动加载的信息](http://php.net/manual/en/language.oop5.autoload.php)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2017-12-26T15:43:51.777

不要过度思考**命名空间**是什么。

**命名空间**基本上只是一个**类**前缀（如操作系统中的目录），以确保**类**路径的唯一性。

同样为了清楚起见，**use**语句并没有做任何事情，只是为您的**命名空间**设置别名，因此您可以使用快捷方式或在同一文件中包含具有相同名称但不同**命名空间的****类。**

 **例如：

```
// You can do this at the top of your Class
use Symfony\Component\Debug\Debug;

if ($_SERVER['APP_DEBUG']) {
    // So you can utilize the Debug class it in an elegant way
    Debug::enable();
    // Instead of this ugly one
    // \Symfony\Component\Debug\Debug::enable();
} 
```

如果你想知道 PHP 命名空间和自动加载（旧的方式以及 Composer 的新方式）是如何工作的，你可以阅读我刚刚写的关于这个主题的博客文章：[https ://enterprise-level-php.com/ 2017/12/25/the-magic-behind-autoloading-php-files-using-composer.html](https://enchanterio.github.io/enterprise-level-php/2017/12/25/the-magic-behind-autoloading-php-files-using-composer.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-10T00:00:31.857

无论如何，您都必须包含/要求该类，否则 PHP 将不知道命名空间。
不过，您不必在*同一个*文件中执行此操作。例如，您可以在引导文件中执行此操作。（或使用自动加载器，但实际上这不是主题）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-10T00:00:39.840

问题很可能是您需要使用自动加载器来获取类的名称（在这种情况下以“\”分隔）并将其映射到目录结构。

您可以查看这篇关于PHP[自动加载功能的文章。](http://php.net/manual/en/language.oop5.autoload.php)框架中已经有许多此类功能的实现。

我之前实际上已经实现了一个。这是一个[链接](https://gist.github.com/2903165)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-01T21:49:30.947

我同意 Green，Symfony 需要命名空间，那么为什么不使用它们呢？

这是示例控制器类的启动方式：

> 命名空间 Acme\DemoBundle\Controller；
> 
> 使用 Symfony\Bundle\FrameworkBundle\Controller\Controller；
> 
> 类 WelcomeController 扩展控制器 { ... }

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-04-05T06:54:45.420

该`use`关键字用于 PHP 中的别名，它不导入类。这真的很有帮助
1) 当你在不同的命名空间中有同名的类时
2) 避免一遍又一遍地使用很长的类名。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-06-26T09:19:05.360

> 我可以用它来导入类吗？

除了上面的例子，你不能这样做。您还可以`use`在 classes 中使用关键字来导入[traits](http://php.net/manual/de/language.oop5.traits.php)，如下所示：

```
trait Stuff {
    private $baz = 'baz';
    public function bar() {
        return $this->baz;
    }
}

class Cls {
    use Stuff;  // import traits like this
}

$foo = new Cls;
echo $foo->bar(); // spits out 'baz' 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-01-18T21:26:59.197

命名空间用于定义包含类的特定文件的路径，例如

```
namespace album/className; 

class className{
//enter class properties and methods here
} 
```

然后，您可以使用关键字“use”将这个特定的类包含到另一个 php 文件中，如下所示：

```
use album/className;

class album extends classname {
//enter class properties and methods
} 
```

注意：不要使用包含要实现的类的文件的路径，使用扩展来实例化对象，而仅使用命名空间。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-03-09T17:40:19.177

使用关键字“use”是为了缩短命名空间文字。您可以同时使用别名和不使用别名。如果没有别名，您必须使用完整命名空间的最后一部分。

```
<?php
    use foo\bar\lastPart;
    $obj=new lastPart\AnyClass(); //If there's not the line above, a fatal error will be encountered.
?> 
```**

# android - 通过 MECL 显示 PayPal 按钮而不先获取设备令牌？

> ID：10965456
> 
> 赞同：0
> 
> 时间：2012-06-09T23:57:46.723
> 
> 标签：android, paypal

我想在我的应用程序的活动 A 中显示“立即通过 PayPal 付款”按钮，单击该按钮可将用户引导至活动 B（处理实际付款）。

我面临的问题是我需要初始化 PayPal-Library 两次：第一次获取按钮，第二次将支付信息发送到 web 服务。初始化需要时间，因为应用程序需要与 PayPal 的服务器通信。有没有办法在没有“正确”首先初始化库的情况下显示“立即付款”按钮（我不需要活动 A 中的设备引用令牌，仅在活动 B 中）。我不能简单地在我的/drawable/-文件夹中存储一个静态的“Pay Now”-Button-Image，因为 PayPal 不允许这样做……按钮必须来自库。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:32:32.627

我通过初始化库一次然后用同一个实例做多件事来解决这个问题（显示“立即付款”按钮，将用户重定向到 PayPal 等）。请参阅[此](https://stackoverflow.com/q/11341674/241189)问题/答案。

# ajax - IE9 xdr.open() 不起作用——我做错了什么？

> ID：10965457
> 
> 赞同：0
> 
> 时间：2012-06-09T23:58:04.010
> 
> 标签：ajax, internet-explorer-9, cors

这是我的代码。

我知道它指向本地主机。但是，它应该为您提供 404。如果你能把它弄到404，你就领先我了。

我已经使用了 IE9 的调试控制台，并且可以在“xdr.open()”调用之前进行操作。

我在网络面板中看不到任何内容。请帮忙。

```
$('body').on('click','.click',function() {    
    if (window.XDomainRequest) {
            xdr = new XDomainRequest();

            xdr.onload = function() {
                xdr.contentType = "text/plain";
                alert('load');
            };

            xdr.onerror = function() {
                alert('error');                                      
            };

            xdr.onprogress = function() {
                alert('progress');
            };

            xdr.ontimeout = function() {
                alert('timeout');
            };
            xdr.timeout = 10000;

            alert('Preparing to open connection...');                
            xdr.open( 'GET', host + '/bookmarklet/saveData/' );
            alert('If you see this message, the connection is opened');

            xdr.send( ( s.hasContent && s.data ) || null );
            alert('If you see this message, the data has been sent!');
        }
}); 
```

编辑：更正了 xdr.setTimeout 周围复制/粘贴的错字——仍然不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T06:38:02.137

我两次发送 access-control-allow-origin: * 标头（一次在 .htaccess 中，一次在 php 脚本中）

使用 chromebug 检查“原始标题”而不仅仅是“标题”；）

# java - 如何在聊天室程序中实现不断更新的用户列表？

> ID：10965469
> 
> 赞同：0
> 
> 时间：2012-06-10T00:00:43.960
> 
> 标签：java, network-programming

我目前正在用 Java 编写一个聊天室程序。有一个处理所有客户端连接的服务器和一个主显示器，所有的谈话都发生在这里。我想要包含的一个功能是边栏中聊天室中所有用户的不断更新列表。但是，该程序的工作方式是客户端与服务器打开一个字符流，并以这种方式来回发送数据。

现在，从客户端发送到服务器的任何字符都将中继到所有客户端并放在主显示器上。但是，我想从服务器向客户端发送有关用户列表的信息。如何区分用户列表信息和主要显示信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T00:06:57.373

1-您可以有两条通信线路。一条线（一个套接字连接）将接受用户列表的传入事件。另一行将接受用于主显示的信息。最好不要打开与服务器的许多连接，因为您需要打开更多端口或在一个端口上处理来自单个客户端的多个连接。

2-您可以使用控制标志或消息类型，以便区分您从服务器接收到的消息类型。当它与更新用户列表有关时，您会这样做，而当它与在主板上显示某些内容有关时，您会显示它。

# drupal - Drupal 规则 + 一次性登录重定向问题

> ID：10965471
> 
> 赞同：6
> 
> 时间：2012-06-10T00:01:26.473
> 
> 标签：drupal, drupal-7

问题如下：

我有一条规则，可在登录后将用户重定向到登录页面。它工作正常。

但是，如果用户忘记了密码，则会向他们发送一个指向一次性登录页面的链接。他们单击按钮并（由于我的规则）被发送到他们的登录页面。

问题当然是他们无法更改密码，因为正常的密码更改（在用户配置文件中）需要您知道密码才能更改。

那么我将如何修改我的重定向规则说：

“重定向到登录页面，除非登录用户来自一次性登录屏幕”或“重定向到登录页面，除非目标 URL 以 /user/reset/* 开头（你可以通配符吗？？） "

提前感谢您的任何提示

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-01T17:06:24.270

我只是使用规则解决了这个问题，如另一个答案中所述，但我必须修改它才能工作，我必须将文本比较条件设置为负数，并将页面重定向到强制重定向，我想要的页面被称为'入门'。完美运行

所以我添加了规则： **事件** 用户已登录

**CONDITIONS** NOT 文本比较参数：文本：[site:current-page:path]，匹配文本：用户，比较操作：以

**操作** 页面重定向参数： URL：入门

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T13:28:29.307

你可以用这样的规则来做到这一点：

```
{ "rules_after_login_redirect_to_news" : {
    "LABEL" : "After login redirect to news.",
    "PLUGIN" : "reaction rule",
    "WEIGHT" : "0",
    "REQUIRES" : [ "rules" ],
    "ON" : [ "user_login" ],
    "IF" : [
      { "NOT text_matches" : {
          "text" : [ "site:current-page:path" ],
          "match" : "^user\/reset\/",
          "operation" : "regex"
        }
      }
    ],
    "DO" : [ { "redirect" : { "url" : "news" } } ]
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-24T10:27:13.597

在我目前正在进行的项目中，我遇到了同样的问题。我们通过使用 Context 模块（[http://drupal.org/project/context](http://drupal.org/project/context)）解决了这个问题。

安装并启用 Context 模块。使用以下条件创建上下文：path = ~user/reset/*（将反应留空）

将此上下文用作登录重定向规则中的条件（上下文规则 / 是上下文集）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-25T14:24:38.837

您也可以仅使用模块规则来解决此问题，无需编码。

就我而言，我想在人们登录后将他们重定向到他们的工作台。但是忘记密码的人也会被重定向到他们的工作台，并且无法更改他们的密码。他们必须导航到自己的个人资料页面，但必须再次重新输入密码：一次性记录不再起作用。

所以这是我添加的规则：

**事件** 事件：用户登录。

**条件** 要素：文本比较。参数：Tekst：[site:current-page:path]，匹配文本：user，比较操作：结尾

**操作** 元素：页面重定向参数：URL：admin/workbench，强制重定向：false

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-10T11:55:28.377

Drupal 6 中有一个 Path Rules 模块和 Rules Bonus Pack 模块可以很好地做到这一点。但不幸的是，Drupal 7 似乎没有这个功能/模块。请参阅[http://drupal.org/node/1506298](http://drupal.org/node/1506298)和[http ://drupal.org/node/1045964#comment-6016904](http://drupal.org/node/1045964#comment-6016904)

但是，您仍然可以使用 PHP 条件来检查路径。试试这个（添加一个新条件并使用 php 添加它。您需要启用 php 模块）。在登录后重定向用户的规则中，

```
<?php
if (arg(0) == 'user' && arg(1) == 'reset'){
  return FALSE;
}
else{
  return TRUE;
}
?> 
```

如果路径为 user/reset/*，这将阻止规则继续执行。此外，您可能需要在另一个重定向密码更改用户的规则中交换 TRUE False 的相同条件。

# regex - 正则表达式检测一行是否不以分号结尾

> ID：10965477
> 
> 赞同：7
> 
> 时间：2012-06-10T00:02:49.240
> 
> 标签：regex

我正在尝试遍历一些代码文件并找到不以分号结尾的行。

我目前有这个：`^(?:(?!;).)*$`来自一堆谷歌搜索，它工作得很好。但现在我想对其进行扩展，以便它忽略开头的所有空格或特定关键字，如包或打开和关闭大括号。

最终目标是采取这样的措施：

```
package example
{
    public class Example
    {
        var i = 0

        var j = 1;

        // other functions and stuff
    }
} 
```

而要向我展示的模式`var i = 0`缺少一个分号。这只是一个例子，缺少的分号可能在课堂上的任何地方。

有任何想法吗？我已经摆弄了一个多小时，但没有运气。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T00:13:20.403

如果您想要一行不以分号结尾的行，您可以要求任何数量的任何内容`.*`，后跟一个不是分号的字符，然后在行尾`[^;]`可能跟一些空格。所以你有了：`\s*``$`

```
.*[^;]\s*$ 
```

现在，如果您不想在开头使用空格，则需要询问行`^`首，后跟任何不是空格的字符，`[^\s]`然后是前面的正则表达式：

```
^[^\s].*[^;]\s*$ 
```

如果您不希望它以诸如`package`or之类的关键字`class`或空格开头，您可以要求一个不属于这三件事中的任何一个的字符。匹配这三件事中的任何一个`(?:\s|package|class)`的正则表达式是，匹配除它们之外的任何东西的正则表达式是`(?!\s|package|class)`。注意`!`. 所以你现在有：

```
^(?!\s|package|class).*[^;]\s*$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T00:51:50.793

在正则表达式中捕获这个复杂概念的关键是首先了解您的正则表达式引擎/解释器如何处理以下概念：

1.  积极前瞻
2.  负前瞻
3.  积极的回顾
4.  消极回顾

然后你可以开始理解如何捕捉你想要的东西，但只有在前面和后面的东西完全符合你指定的情况下。

```
str.scan(/^\s*(?=\S)(?!package.+\n|public.+\n|\/\/|\{|\})(.+)(?<!;)\s*$/) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T13:33:12.720

试试这个：

```
^\s*(?!package|public|class|//|[{}]).*(?<!;\s*)$ 
```

在 PowerShell 中测试时：

```
PS> (gc file.txt) -match '^\s*(?!package|public|class|//|[{}]).*(?<!;\s*)$'
        var i = 0 
PS> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-20T06:09:32.563

这是我用来突出显示不以分号结尾的 Java 代码行并且不是 Java 中不应该在末尾有分号的行之一的正则表达式行...使用 vim 的正则表达式引擎。

```
\(.\+[^; ]$\)\(^.*public.*\|.*//.*\|.*interface.*\|.*for.*\|.*class.*\|.*try.*\|^\s*if\s\+.*\|.*private.*\|.*new.*\|.*else.*\|.*while.*\|.*protected.*$\)\@<!
   ^          ^                                                                                                                                           ^
   |          |                                                                                                                 negative lookbehind feature 
   |          |
   |          2\.  But not where such matches are preceeded by these keywords
   |
   |
   1\. Group of at least some anychar preceeding a missing semicolon 
```

破译字形的助记符：

```
^          beginning of line
.*         Any amount of any char
+          at least one
[^ ... ]   everything but
$          end of line
\( ... \)  group
\|         delimiter
\@<!       negative lookbehind 
```

大致翻译为：

找到所有不以分号结尾且左侧没有上述任何关键字/表达式的行。它并不完美，可能无法支持混淆的 java，但对于简单的 java 程序，它会突出显示末尾应该有分号的行，但不要。

显示此表达式如何为我工作的图像：

[![在此处输入图像描述](../Images/ebe16f35f800eb4dbb8444abf208f2e7.png)](https://i.stack.imgur.com/d1zEh.png)

帮助我获得所需概念的有用链接：

[https://jbodah.github.io/blog/2016/11/01/positivenegative-lookaheadlookbehind-vim/](https://jbodah.github.io/blog/2016/11/01/positivenegative-lookaheadlookbehind-vim/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-10T00:10:24.393

对于不以分号结尾的行，这更简单：

```
.*[^;]$ 
```

如果您不希望以空格开头并以分号结尾的行：

```
^[^ ].*[^;]$ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-10T00:43:15.307

您正在尝试匹配可能以 whitespace 开头的行`^\s*`，然后没有特定的单词集，例如`(?!package|class)`，然后有任何内容`.*`但不以分号（或后面有空格的分号）结尾`[^;]\s*`。

```
^\s*(?!package|class).*?[^;]\s*$ 
```

请注意，我在正则表达式的一部分周围添加了括号。

# css - CSS框定位的形式语义

> ID：10965478
> 
> 赞同：5
> 
> 时间：2012-06-10T00:03:22.197
> 
> 标签：css, formal-methods, formal-semantics

我是一名（理论）计算机科学专业的学生，​​因此研究编程语言的语义是我研究的主题之一（[维基百科](http://en.wikipedia.org/wiki/Formal_semantics_of_programming_languages)）。

我玩过很多 CSS 并且对盒子的定位规则有一个合理的理解。（如果你告诉我创建一个具有特定布局的页面，我通常可以想到正确的框方法和适用的 CSS 规则。）

为 CSS 框定位规则提供某种形式的语义会很酷，但是在网上搜索了一段时间后，我找不到任何有用的东西。

我大多只是简单地以 CSS 规范结束，这些规范被格式化为带有伪算法的长文本（不是最好的阅读材料——我还没有花太多精力阅读这些规范中的任何一个）。

没有人试图将这个“理论”形式化为某种数学模型，比规范所提供的更严格吗？我不是在寻找完整或确定的东西，但如果至少可以以正式的方式对盒子的放置方式进行建模，那么它肯定会很整洁（而且很有用！）。

有人知道这样的研究吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:53:33.617

**没有答案！** *这是一个非常简化的案例可能形式化的示例（请参阅我上面的评论）。*

例如，假设我们在一个世界中工作，该世界具有 (1) 已知的屏幕宽度，(2) 没有嵌套的框![在此处输入图像描述](../Images/16f15fdcc54a2bce3d752cb602d5225f.png)的有序列表，没有边距/填充/边框，向左浮动，其中我们通过数学函数和知道它们的 (2.1) 高度和 (2.2) 宽度。![在此处输入图像描述](../Images/8e5d9520ed27d4f10ee5056e9f2fe336.png)![在此处输入图像描述](../Images/8d50e1aa784998c03ddf7892e8f60222.png)![w](../Images/a7eadf284adac2d059f82c6941756890.png)![H](../Images/bbff43c71f00d62046c31284d157ce4b.png)

我们将定义函数![在此处输入图像描述](../Images/a9069ce794caf17ed314b7cd4029ce6a.png)和![在此处输入图像描述](../Images/2a90e01c782e9407324ed255b5f75ff6.png)，它们表示每个框左上角的坐标。

我们将定义/使用关系“![在此处输入图像描述](../Images/51204b544a7785821485819565f9e8f6.png)开始线![在此处输入图像描述](../Images/304cb3e34bdca55edfbbfd86eb99e5be.png)”和“![在此处输入图像描述](../Images/626ab7b24479d35edb8c7b39cd7988d9.png)有高度![在此处输入图像描述](../Images/9c61c6fd7d6d9fd6ad2ab24361b101eb.png)”。

首先，![在此处输入图像描述](../Images/d8db652a95ff4cd45f4389ab17ac8171.png)从第 0 行开始。

然后，如果![在此处输入图像描述](../Images/51204b544a7785821485819565f9e8f6.png)开始线![l](../Images/626ab7b24479d35edb8c7b39cd7988d9.png)，而且如果确定![米在 N](../Images/177ad4b772c33404a0ea4c47cba26b21.png)

![在此处输入图像描述](../Images/10eee7e34e006532231219f83b27bb3b.png)

...我们得出结论：

1.  ![某行中的框高度](../Images/c0fea795583974329a53d349a0851dff.png)
2.  ![某行中的框宽](../Images/1efa1601dd528e5d38af48bbd9ac0a4a.png)
3.  ![l](../Images/626ab7b24479d35edb8c7b39cd7988d9.png)有高度![线高](../Images/a19d6463e2c37d7a75a50e2c3a068dc1.png)
4.  ![bm+1](../Images/ba665f746c16ee834931c00dd8b44f8c.png)开始行![l](../Images/626ab7b24479d35edb8c7b39cd7988d9.png)+1 iff![米勒N](../Images/6143010cbbaccdf8b4a1988db599c5fa.png)

这些规则以正式的方式定义给定框的位置。当然，这只是一种方法，而且可能不是最聪明的（只是很快想到了），但它确实正确地形式化了浮点数的工作方式（模数错别字，我检查得不够好）。

在处理编程语言时，可以选择许多这些形式，每一种都是为特定目的而发明的（参见[维基百科](http://en.wikipedia.org/wiki/Formal_semantics_of_programming_languages)）。

我只是对是否有人尝试过为 CSS 框定位提出一些形式化感兴趣。当然，规范还有很长的路要走，但它们并不像数学方法强迫你那样严格。

# garbage-collection - 您如何管理临时目录以保证在程序关闭时将其删除？

> ID：10965479
> 
> 赞同：13
> 
> 时间：2012-06-10T00:03:52.667
> 
> 标签：garbage-collection, python

我正在使用一个临时目录，我想确保它在程序关闭时被删除（无论程序是否成功）。我正在使用`tempfile.mkdtemp`创建目录并将创建的字符串放入其子类中`str`删除其`__del__`命令上的目录：

```
import shutil
import tempfile

class TempDir(str):
    """ container for temporary directory. 
    Deletes directory when garbage collected/zero references """
    def __del__(self):
        shutil.rmtree(self.__str__(), onerror=my_error_fn)

dbdir = TempDir(tempfile.mkdtemp()) 
```

这是我不确定的：如果程序关闭或发生 KeyboardInterrupt，Python 会自动删除/垃圾收集所有变量吗？如果没有，我如何确保该目录被删除？

[有关在 Python 中创建析构函数方法的](http://eli.thegreenplace.net/2009/06/12/safely-using-destructors-in-python/)相关信息。似乎只要 TempDir 对象不引用其他任何东西，使用`__del__`它来破坏它应该没问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-10T00:28:47.253

我不会使用`__del__`方法，语义不可靠，并且可能会干扰垃圾收集。使用上下文管理器：定义一个`__enter__`和`__exit__`方法，并将您对对象的使用放在一个`with`语句中。很清楚，很明确，而且可以毫无顾虑地工作。

或者，另一种制作上下文管理器的方法：

```
@contextlib.contextmanager
def tempdir(prefix='tmp'):
    """A context manager for creating and then deleting a temporary directory."""
    tmpdir = tempfile.mkdtemp(prefix=prefix)
    try:
        yield tmpdir
    finally:
        shutil.rmtree(tmpdir) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-16T23:42:49.987

对于依赖于特定（半模拟）文件结构的存在的包测试套件，我需要类似的东西。对于许多测试模块，我并不总是知道将运行哪些测试以及以什么顺序运行，或者测试运行将如何退出。

根据`__del__`我的经验，在应用程序退出时使用是不可靠的。使用上下文管理器意味着重写测试文件以确保一切都很好地包装。相反，我使用`atexit`. 在`<package>.tests.__init__`我刚刚添加：

```
import atexit, shutil, tempfile

test_area = tempfile.mkdtemp()
atexit.register(shutil.rmtree, test_area) 
```

然后 Python 将`shutil.rmtree(test_area)`在退出时调用。如果需要，也可以添加用于错误处理的关键字参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T00:27:29.793

它仅在程序结束时删除所有内容（就像通常那样）。

为了说明，这是我使用的代码：

```
import tempfile
import shutil
import os

class TempDir(str):
    """ container for temporary directory. Deletes directory when garbage
    collected/zero references """
    def __del__(self):
        print "deleting temporary files in directory {}".format(self.__str__())
        shutil.rmtree(self.__str__(), onerror=delete_dir_handler)

def delete_dir_handler(listdir_fn, dirname, exception):
    try:
        for fileobj in listdir_fn(dirname):
            os.remove(fileobj)
        os.removedirs(dirname)
    except (AttributeError, OSError, TypeError):
        print exception[1]
        print "Sorry. Couldn't delete directory {}.".format(dirname)
        raise

test = TempDir(tempfile.mkdtemp()) 
```

并输出：

```
$ python my_file.py
deleting temporary files in directory /var/folders/A9/A9xrfjrXGsq9Cf0eD2jf0U+++TI/-Tmp-/tmpG3h1qD 
```

如果您在交互模式下运行它，它不会删除，直到您退出程序。

```
$ python -i my program 
>>> # pressed Ctrl-C here
KeyboardInterrupt
>>> # again, Ctrl-C
KeyboardInterrupt
>>> # Ctrl-D to exit
deleting temporary files in directory /var/folders/A9/A9xrfjrXGsq9Cf0eD2jf0U+++TI/-Tmp-/tmpMBGt5n 
```

最后，如果您`raw_input('')`在文件中添加一行，如果您按 Ctrl-C，它的行为将与程序结束完全相同。

# javascript - `this` 在不是类原型的函数中

> ID：10965485
> 
> 赞同：4
> 
> 时间：2012-06-10T00:05:18.277
> 
> 标签：javascript

我正在尝试制作一个没有原型的类。这是一个例子：

```
test = (function() {
  this.value = 1;
  this.print = function() {
    console.log(this.value);
  };
  return this;
})(); 
```

这可以按预期完美运行。我不明白的是函数`this.value`内部`this.print`。如何`this.print`正确地知道任何提及是`this`指`test`而不是`window`？`this.___ = function(){}`通过自动定义的任何函数是否会`this`添加为上下文？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T00:09:44.343

`this` *总是*¹评估为调用函数对象的对象*。*它将评估`window`它是否“在任何情况下调用”（或者是 的属性`window`）。

（请注意，这`this` *不是*变量，因此*不会*在闭包中封闭！这就是为什么有时需要闭包来获得变量or or`this`经常知道的“正确” 。）`self``that``_this`

例如：

```
function f () { return this; }
var a = {f: f}
var b = {f: f}
a.f() === a     // true
b.f() === b     // true
f() === window  // true 
```

* * *

使用*变量*创建与当前的绑定的示例（截至调用封闭函数时）`this`：

```
test = (function() {
  var self = this // <-- variable, which is "closed over"
  this.value = 1; // self === this
  this.print = function() {
    console.log(self.value); // <-- self "names" previous this object
  };
  return this;
})(); 
```

* * *

¹这是一个小谎言。`Function.call`and`Function.apply`函数允许指定上下文，`this`并且可以由“上下文绑定”函数使用，例如[`Function.bind`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)消除对显式“自闭包”的需要，如上所示。

# objective-c - NSPerformService "Tweet" 与图片 (Twitter.app)

> ID：10965496
> 
> 赞同：0
> 
> 时间：2012-06-10T00:08:52.993
> 
> 标签：objective-c, macos, cocoa, service, twitter

反正`NSPerformService(@"Tweet", [NSPasteboard generalPasteboard]);`有图像吗？我知道简单的文字是可能的，但我不知道图像。
如果是，示例代码会很好。
谢谢你。

PS：对于那些不知道的人，这只有在用户安装了 Twitter.app 的情况下才有可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:51:42.023

您可以发送到服务的类型取决于已注册应用程序在其`Info.plist`. 对于`Twitter.app`，这看起来像：

```
 <key>NSMenuItem</key>
    <dict>
        <key>default</key>
        <string>Tweet</string>
    </dict>
    <key>NSSendTypes</key>
    <array>
        <string>NSStringPboardType</string>
    </array> 
```

不幸的是，这意味着您必须将图像转换为字符串才能被服务接受。

# ruby-on-rails-3 - 客户端验证在生产中不起作用，但在开发中起作用

> ID：10965501
> 
> 赞同：5
> 
> 时间：2012-06-10T00:10:25.577
> 
> 标签：ruby-on-rails-3, heroku, devise, client-side-validation

这是我的`User`模型：

```
class User < ActiveRecord::Base
    rolify
  devise :database_authenticatable, :registerable, :token_authenticatable, :confirmable, :timeoutable, 
         :recoverable, :rememberable, :trackable, :validatable,
                 :email_regexp =>  /^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i

  attr_accessible :email, :password, :password_confirmation, :remember_me, :name, :confirmed_at, :confirmation_token
    validates_uniqueness_of :email, :case_sensitive => false
    validates_confirmation_of   :password

end 
```

宝石文件：

`gem 'client_side_validations'`

形式：

```
<%= form_for(resource, :as => resource_name, :class => "send-with-ajax", :url => user_registration_path(resource), :validate => true, :html => { :id => 'user_new' }) do |f| %>
              <%= f.text_field :email,:placeholder => "your-email@address.com", :input_html => {:autofocus => true}, :validate => true %>
              <%= f.submit :label => "Submit", :value => "Sign Me Up!"  %>
      <div class="ajax-response"><%= devise_error_messages! %></div>
          <% end %> 
```

当您离开该字段时它应该可以工作，这是它在本地工作的屏幕截图：

![客户端验证本地](../Images/c05aff7aa1318da957d199b91beec296.png)

但是当我在生产中这样做时，它根本不起作用，我在日志文件或 JS 控制台中看不到任何错误。

**编辑1：**

验证消息未显示。

在 Heroku 日志中，每当我尝试使用“有效”电子邮件地址时，我都会看到这一点：

```
2012-06-10T18:44:55+00:00 app[web.1]: Started GET "/validators/uniqueness?case_sensitive=false&user%5Bemail%5D=abc%40tell.com" for xx.xxx.xx.x2 at 2012-06-10 18:44:55 +0000
2012-06-10T18:44:55+00:00 heroku[router]: GET myapp.heroku.com/validators/uniqueness?case_sensitive=false&user%5Bemail%5D=abc%40tell.com dyno=web.1 queue=0 wait=0ms service=221ms status=404 bytes=4 
```

但它不像本地那样在我的页面上向我显示消息。

此外，我在日志中看到 HTTP 请求的唯一时间是当我尝试使用具有“有效”电子邮件结构的字符串时 - 例如`abc@email.com`. 但是，如果我尝试类似的事情，`abc`它不会给我我期望的消息 - `invalid address`- 日志也不会显示任何内容。

**编辑2：**

我尝试在其中运行我的本地服务器，`production mode`但我看到了与 Heroku 相同的问题。所以看起来这个问题可能与 Heroku 没有任何关系——而是与生产有关。

这是从生产中的表单生成的 HTML：

```
<form accept-charset="UTF-8" action="/users" class="formtastic user" data-validate="true" id="user_new" method="post" novalidate="novalidate"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="kQid^%&^%jhgdsjhgfxmw4=" />
              <input data-validate="true" id="user_email" input_html="{:autofocus=&gt;true}" name="user[email]" placeholder="your-email@address.com" size="30" type="text" />
              <input label="Submit" name="commit" type="submit" value="Sign Me Up!" />
</form><script>window['user_new'] = {"type":"Formtastic::FormBuilder","inline_error_class":"inline-errors","validators":{"user[email]":{"presence":{"message":"can't be blank"},"uniqueness":{"message":"has already been taken","case_sensitive":false},"format":{"message":"is invalid","with":/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i,"allow_blank":true}}}};</script>               </div> 
```

**编辑3：**

这就是我的 application.js 的外观：

```
//= require jquery
//= require jquery_ujs
//= require rails.validations
//= require_tree . 
```

在我的`application.html.erb`布局文件中，我只有一个对 application.js 的 JS 调用

**编辑4：**

我认为这可能`client_side_validation`是由于 id is`user_email`和 not生成的 JS 脚本无法识别输入的情况`user[email]`。所以我将`id`输入更改为`user[email]`并没有解决它。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T02:18:52.247

最好的猜测是这会追踪到资产管道。其他一些 gem 可能会阻止资产正确编译。

我没有给你一个完美的答案，但 Heroku 文档在这里可能会有所帮助： [https ://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar](https://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar)

# blogs - 将 javascript 库添加到 Octopress 帖子？

> ID：10965506
> 
> 赞同：6
> 
> 时间：2012-06-10T00:11:08.297
> 
> 标签：blogs, octopress

对于不同的帖子（通过 生成`rake new_post[my_post]`），我想添加一个 javascript 函数，该函数只包含在该帖子中，博客上没有其他地方。

我可以通过手动编辑`public/my_post/index.html`文件来做到这一点，但是每次我做 a`rake generate`时，我都必须再做一次。

在 Octopress 中是否有内置的方法来实现这一点？

干杯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-10T00:50:00.817

在 2.1 中，您将能够通过在 yaml 前端设置一些变量来将每个页面/帖子的 JavaScript 或 CSS 资产注入到标题中。

目前，您只需在帖子或页面本身内插入链接或脚本标签，它就会被加载到位。例子：

```
<script type="text/javascript" src="/path/to/file.js"></script>
<link rel="stylesheet" type="text/css" href="/path/to/file.css"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-16T21:14:56.740

假设您需要`this.js`并`that.js`在帖子中将它们保存在新创建的`/javascripts/custom/`目录下。

比在您的默认布局中添加`<head>`标签内的内容，例如：

```
{% if page.custom_javascript %}
    {% for js in page.custom_javascript %}
        <script type="text/javascript" src="/javascripts/custom/{{ js }}"></script>    
    {% endfor%}
{% endif %} 
```

最后，您可以注入 per-post javascript，只需将字段添加到 post YAML front-matter 中`custom_javascript`：

```
---
layout: post
title: "Insert javascript inside head with Octopress"
custom_javascript: [this.js, that.js]
--- 
```

当然，您可以对需要注入`<head>`.

# forms - 表单创建 cakephp

> ID：10965508
> 
> 赞同：0
> 
> 时间：2012-06-10T00:11:20.043
> 
> 标签：forms, cakephp

我正在做一个 cakephp 项目。对于视图部分，我有以下代码片段

```
echo $form->create("generals",array('action' => 'search')); 
echo $form->input("q", array('label' => 'Search for')); 
echo $form->end("Search"); 
```

如果我没记错的话，在文本框中输入的术语用 q 表示。我如何捕捉这个术语并在将军控制器的搜索方法中使用它。

请让我知道您对此的看法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:56:31.080

如果您在 Cake 1.x 中，您的数据应该在数组中可用`$this->data`...如果您在 Cake 2.x 中，您可以通过`$this->request-data`...

如果你`debug`或数组`print_r`，`var_dump`你会看到结构......

对于 1.x，请参阅[http://book.cakephp.org/1.3/en/view/1031/Saving-Your-Data](http://book.cakephp.org/1.3/en/view/1031/Saving-Your-Data)

对于 2.x，请参阅[http://book.cakephp.org/2.0/en/models/saving-your-data.html](http://book.cakephp.org/2.0/en/models/saving-your-data.html)

# ios - 如何在 Ordered To-Many 关系中重复项目？

> ID：10965510
> 
> 赞同：0
> 
> 时间：2012-06-10T00:11:37.267
> 
> 标签：ios, core-data, nsarray, relationship

在 Xcode 4.3.2 的 Core Data 中，Ordered To-Many 关系使用`NSOrderedSet`. 它运作良好，直到我发现需要在关系中重复项目；它真的应该以`NSArray`.

例如，在一个音乐应用程序中，我有以下歌曲`SongA, SongB, SongC`：

我可能想要一个派对播放列表，人们以任何顺序插入歌曲并且可以重复。该列表可能类似于：

```
[SongC, SongC, SongA, SongC] 
```

Core Data 当前的工作方式，列表将变为：

```
[SongC, SongA] 
```

即，所有重复的项目都被丢弃，因为它是用集合建模的。

那么，回到我的问题：在 Core Data 的关系中按顺序对重复项进行建模的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:42:03.143

关系是集合（有序关系是有序集合，但仍然是集合）；根据定义，集合包含唯一对象。因此，无论哪种方式，您都不能将重复的对象放入关系中。

无论您是否使用有序关系功能，您都希望回到抽象的 ER 模型以找到另一种方法将您的概念关系转变为核心数据模型......这可能有助于考虑您如何在一个普通的 SQL（或类似 SQL）的数据库中完成它，然后回到 Core Data 在 SQL 之外所做的事情。

听起来你正在制作类似于 iTunes 播放列表的东西，不是吗？可能适用的模型将类似于：

```
 Playlist      <--->> PlaylistEntry
 PlaylistEntry <<---> Song 
```

该`PlaylistEntry`实体表示 a`Song`包含在一个中的一个实例`Playlist`。您可以有多个s在单个`PlaylistEntry`s 中引用相同的内容，并且可以向 s 添加其他属性以跟踪其他内容（例如歌曲顺序，如果您不使用有序关系）。作为奖励，如果您愿意，您可以使用它来添加其他功能 - 例如，制作一个播放列表，从一个长音轨中播放三个不同的片段。`Song``Playlist``PlaylistEntry`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T07:43:31.307

正如 rickster 所说，由 Core Data 管理的关系将它们之间的实体唯一地关联起来。即使 Lion 的核心数据（应该）支持有序关系（应该是，因为在实践中它不起作用，该功能有缺陷，几乎无法使用），它们仍然是遵循关系数据库模型的关系。

所以你必须自己管理关联，当然你也必须自己管理关联的有序部分。

```
Score <->> ScoreSong
ScoreSong <<-> Song 
```

ScoreSong 具有以下属性：

```
ScoreSong:
- score: -> Score
- song: -> Song
- order: integer, indexed 
```

然后，您必须使用带有排序描述符的 Fetch Request 键顺序，这将返回 ScoreSong 的有序 NSArray。您可以请求获取请求以预取歌曲，然后您可以创建歌曲数组，仍然正确排序，只需调用 valueForKey:@"song"。

当然，当您需要在乐谱中包含多首歌曲时，您必须为一首歌曲创建不同的 ScoreSong。这就是增加的间接性的全部意义所在。

# c++ - 基本数学函数的意外值

> ID：10965514
> 
> 赞同：1
> 
> 时间：2012-06-10T00:13:01.197
> 
> 标签：c++, c, calculator

我正在学习 C++ 编程的基础知识，我需要编写一个使用 if/else 语句执行一些基本数学函数的程序：减法、加法、乘法等。我没有收到任何编译或运行时错误，但我最终得到的值总是不正确的。

我改变了一些事情，试图看看我哪里出错了，但就文字而言，屏幕上打印的内容是正确的，而不是答案。例如，当我扫描一个`-`（减号）作为输入时，它会读取 x 和 y 之间的差异是一个高得离谱的数字。

无论如何，这是我的代码&任何帮助将不胜感激！

```
 /*
 * This program performs some basic math calculations
 */

#include <stdio.h>
#include <math.h>

int main() {
    int x,y;
    float sum = x+ y;
    float difference = x-y;
    float product = x*y;
    float quotient = x/y;
    float exponent = x^y;
    float modulus = x%y;
    char symbol;

    printf("What is the value of x?\n");
    scanf("%d", &x);

    printf("What is the value of y?\n");
    scanf("%d", &y);

    printf("What is your operator?\n");
    scanf(" %c", &symbol);

    if (symbol== '+') 
       printf("The sum of x and y = %f\n", sum);
    else if (symbol=='-')
       printf("The difference between x and y = %f\n", difference);
    else if (symbol=='*')
       printf("The product of x and y = %f\n", product);
    else if (symbol=='/')
       printf("x divided by y = %f\n", quotient);
    else if (symbol=='^')
       printf("x multiplied exponentially by y = %f\n", exponent);
    else if (symbol=='%')
       printf("x is this much percent of y =%f\n", modulus);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:18:24.047

因为这是一个 C++ 应用程序，您可以根据需要定义变量。但请记住，用 C 或 C++ 以及所有其他语言编写的程序将从上到下执行，因此当您声明 x 和 y 时，它们没有从用户那里读取的值。始终从上到下跟踪您的代码。这里我声明 x 和 y 并首先从用户那里读取它们的值。然后我计算它们的不同操作。我认为除了除法之外，它们中的大多数都可以像 x 和 y 一样再次成为整数，但我会尝试更正您的代码。

如果你想在 C 或 C++ 中求幂，你必须编写自己的代码。

```
 #include <stdio.h>
    #include <math.h>

    float power( int x , int y )
    {
        float ret = 1 ;
        for( int i = 1 ; i <= y ; i++ )
            ret *= x ;
        return ret ;
    }

    int main() {

    int x,y;

    printf("What is the value of x?\n");
    scanf("%d", &x);

    printf("What is the value of y?\n");
    scanf("%d", &y);

    printf("What is your operator?\n");
    scanf(" %c", &symbol);

    float sum = (float)x+ y;
    float difference = (float)x-y;
    float product = (float)x*y;
    float quotient = (float)x/y;
    //float exponent = (float)x^y; //Exponentiation should be implemented using multiplication and loops.

   float exponent = power( x , y ) ;
    float modulus = (float)x%y;
    char symbol;

    if (symbol== '+') 
       printf("The sum of x and y = %f\n", sum);
    else if (symbol=='-')
       printf("The difference between x and y = %f\n", difference);
    else if (symbol=='*')
       printf("The product of x and y = %f\n", product);
    else if (symbol=='/')
       printf("x divided by y = %f\n", quotient);
    else if (symbol=='^')
       printf("x multiplied exponentially by y = %f\n", exponent);
    else if (symbol=='%')
       printf("x is this much percent of y =%f\n", modulus);

    return 0;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T00:24:25.700

您甚至在初始化`x`和`y`. 未初始化的变量具有不确定的内容，因此您拥有的任何结果都是不确定的。您冒着使用某些语句调用未定义行为的风险（这意味着无法确定您的代码将做什么）。仅在读入 和 的值后进行`x`操作`y`。

```
#include <math.h> 
```

如果您不使用来自 的任何功能，为什么还要包含此内容`<math.h>`？

```
float sum = x+ y; 
```

两个整数的和（或差）总是一个整数。你为什么在`float`这里使用？

```
float quotient = x/y; 
```

这会进行整数除法并将结果转换为`float`. 所以，结果可能不是你想要的。尝试将任何一个参数转换为`float`/`double`以获得正确的结果。此外，您应该始终检查除以零。你的模数计算也是如此。

```
float exponent = x^y; 
```

C 中没有求幂运算符。您需要使用库函数（例如`pow`）或自己滚动。

```
scanf(" %c", &symbol); 
```

为什么前面有空位？

也不需要这个巨大的 if-else 阶梯。尝试使用`switch`.

您需要拿起一本好书并开始阅读以了解 C 的工作原理。

# ruby - 当我通过 RVM 在 OSX Lion 上安装 Ruby 1.9.3 时，如何修复 make 错误？

> ID：10965518
> 
> 赞同：3
> 
> 时间：2012-06-10T00:13:23.710
> 
> 标签：ruby, rvm

我一直在尝试在 OSX Lion 上安装 Ruby 1.9.3，但一直遇到 make 错误

> Kerrie-Yees-MacBook-Pro:~ kerrieyee$ rvm install 1.9.3 从源代码安装 Ruby 到：/Users/kerrieyee/.rvm/rubies/ruby-1.9.3-p194，这可能需要一段时间，具体取决于您的 CPU（ s)...
> 
> ruby-1.9.3-p194 - #fetching
> 
> ruby-1.9.3-p194 - #extracted to /Users/kerrieyee/.rvm/src/ruby-1.9.3-p194（已经提取）
> 
> ruby-1.9.3-p194 - #configuring
> 
> ruby-1.9.3-p194 - #编译
> 
> 运行'make'时出错，请阅读/Users/kerrieyee/.rvm/log/ruby-1.9.3-p194/make.log 运行make时出错。停止安装。

我已经使用命令行工具安装了 git 1.7.7.5、osx-gcc4.2、homebrew 0.9 和 XCode 4.3。我已经尝试安装 readline 但仍然出现 make 错误。我对 ruby​​ 也很陌生，对终端了解不多，所以如果需要更多信息，请同时编写获取信息所需的终端命令。谢谢！

根据建议，我打开了 make.log 文件

看起来像错误部分的部分读取

`readline.c: In function ‘username_completion_proc_call’: readline.c:1499: error: ‘username_completion_function’ undeclared (first use in this function) readline.c:1499: error: (Each undeclared identifier is reported only once readline.c:1499: error: for each function it appears in.) make[2]: *** [readline.o] Error 1 make[1]: *** [ext/readline/all] Error 2 make: *** [build-ext] Error 2`

注意到错误与 readline 有关，我查找了有关 readline 的其他问题并遵循 RVM 说明。

我输入`rvm pkg install readline`并`rvm reinstall 1.9.3 --with-readline-dir=$rvm_path/usr`

仍然存在错误：

`Error running 'make ', please read /Users/kerrieyee/.rvm/log/ruby-1.9.3-p194/make.log There has been an error while running make. Halting the installation.`

make.log 文件内容如下：

`ld: in /usr/local/lib/libxml2.2.dylib, file was built for unsupported file format which is not the architecture being linked (x86_64) for architecture x86_64 collect2: ld returned 1 exit status make[2]: *** [../../.ext/x86_64-darwin11.4.0/tcltklib.bundle] Error 1 make[1]: *** [ext/tk/all] Error 2 make: *** [build-ext] Error 2`

我还跑了 brew doctor：

> Kerrie-Yees-MacBook-Pro:~ kerrieyee$ brew doctor
> 
> 错误：在 /usr/local/lib 中找到未编译的 dylib。如果您不是故意将它们放在那里，它们可能会在构建 Homebrew 公式时引起问题，并且可能需要删除。
> 
> 意外的dylib：/usr/local/lib/libexslt.0.dylib /usr/local/lib/libexslt.dylib /usr/local/lib/libhistory.6.0.dylib /usr/local/lib/libhistory.6.dylib / usr/local/lib/libhistory.dylib /usr/local/lib/libreadline.6.0.dylib /usr/local/lib/libreadline.6.dylib /usr/local/lib/libreadline.dylib /usr/local/lib/ libruby.1.8.7.dylib /usr/local/lib/libruby.1.8.dylib /usr/local/lib/libruby.dylib /usr/local/lib/libsqlite3.0.8.6.dylib /usr/local/lib/ libsqlite3.0.dylib /usr/local/lib/libsqlite3.dylib /usr/local/lib/libxml2.2.dylib /usr/local/lib/libxml2.dylib /usr/local/lib/libxslt.1.dylib / usr/local/lib/libxslt.dylib
> 
> 错误：在 /usr/local/lib 中找到未酿造的 .la 文件。如果您不是故意将它们放在那里，它们可能会在构建 Homebrew 公式时引起问题，并且可能需要删除。
> 
> 意外的 .la 文件：/usr/local/lib/libexslt.la /usr/local/lib/libsqlite3.la /usr/local/lib/libxml2.la /usr/local/lib/libxslt.la
> 
> 错误：在 /usr/local/lib/pkgconfig 中找到未编译的 .pc 文件。如果您不是故意将它们放在那里，它们可能会在构建 Homebrew 公式时引起问题，并且可能需要删除。
> 
> 意外的 .pc 文件：/usr/local/lib/pkgconfig/libexslt.pc /usr/local/lib/pkgconfig/libxml-2.0.pc /usr/local/lib/pkgconfig/libxslt.pc /usr/local/lib/ pkgconfig/sqlite3.pc
> 
> 错误：在 /usr/local/lib 中找到未编译的静态库。如果您不是故意将它们放在那里，它们可能会在构建 Homebrew 公式时引起问题，并且可能需要删除。
> 
> 意外的静态库：/usr/local/lib/libexslt.a /usr/local/lib/libhistory.a /usr/local/lib/libreadline.a /usr/local/lib/libruby-static.a /usr/local /lib/libsqlite3.a /usr/local/lib/libxml2.a /usr/local/lib/libxslt.a

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:41:57.573

我遇到了同样的问题，我通过运行以下命令解决了这个问题：

> 酿造更新
> 
> brew tap homebrew/dupes
> 
> 酿造安装苹果-gcc42
> 
> curl -L [https://get.rvm.io](https://get.rvm.io) | bash -s 稳定 --ruby

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T02:59:56.800

我不能肯定这会解决你的具体问题，但我写的这个教程帮助了很多人： http: [//moncefbelyamani.com/how-to-install-xcode-homebrew-git-rvm-ruby -在-mac/](http://moncefbelyamani.com/how-to-install-xcode-homebrew-git-rvm-ruby-on-mac/)

# android - Android - 在从服务器获取响应时验证 JSON 以避免 JSONException

> ID：10965528
> 
> 赞同：2
> 
> 时间：2012-06-10T00:17:38.537
> 
> 标签：android, json, validation, jsonexception

在我的一些与服务器通信并使用 http 获得响应的应用程序中，我使用 json 来格式化数据服务器端，当它到达设备时，我使用类似于我在 stackoverflow 上找到的代码：

```
private class LoadData extends AsyncTask<Void, Void, String> 
{ 
private  JSONArray jArray;
private  String result = null;
private  InputStream is = null;
private String entered_food_name=choice.getText().toString().trim();
protected void onPreExecute() 
{
}

@Override
protected String doInBackground(Void... params) 
{
try {
ArrayList<NameValuePair> nameValuePairs = new            ArrayList<NameValuePair>();
HttpClient httpclient = new DefaultHttpClient(); 
HttpPost httppost = new HttpPost("http://10.0.2.2/food.php");
nameValuePairs.add(new BasicNameValuePair("Name",entered_food_name));
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs,"UTF-8"));
HttpResponse response = httpclient.execute(httppost);

HttpEntity entity = response.getEntity();
 is = entity.getContent();

    //convert response to string

BufferedReader reader = new BufferedReader(new InputStreamReader(is,"utf-8"),8);
    StringBuilder sb = new StringBuilder();
    String line = null;
    while ((line = reader.readLine()) != null) {
        sb.append(line);
    }

    is.close();

    result =sb.toString();
    result = result.replace('\"', '\'').trim();

}
catch(Exception e){
    Log.e("log_tag", " connection" + e.toString());                     
}

return result;  

}

@Override
protected void onPostExecute(String result) 
{  
try{

    String foodName="";
    int Description=0;

    jArray = new JSONArray(result); // here if the result is null an exeption will occur
    JSONObject json_data = null;

    for (int i = 0; i < jArray.length(); i++) {
        json_data = jArray.getJSONObject(i);
        foodName=json_data.getString("Name");
        .
        .
        .
        .
        .
    } 
    catch(JSONException e){ 
        **// what i can do here to prevent my app from crash and 
        //  make toast " the entered food isnot available " ????**
        Log.e("log_tag", "parssing  error " + e.toString()); 
    }   
}
} 
```

我尝试在找到此代码的页面上使用该解决方案。顺便说一句，这里是链接[如何防止我的应用程序在使用 JSON 数据时意外崩溃，“强制关闭”，并改为处理异常？](https://stackoverflow.com/questions/10587599/how-do-i-prevent-my-app-from-crashing-unexpectedly-force-close-when-using-js?rq=1)

我尝试使用在线验证器检查我的 json 响应，返回的 json 是有效的。我认为当用户处于覆盖范围较差的区域时，连接会暂时中断或某些原因导致 json 中断，从而导致 json 异常，即使我已经尝试了我在该链接中发布的线程中建议的方法。因此，我希望能够在 JSON 到达电话时对其进行验证，因此如果它有效，我可以继续，如果不是，我想尝试修复它，或者至少不尝试传递损坏且格式不正确的 json数组到导致 JSONException 的方法之一。

关于验证我在响应中得到的字符串以确保其有效的 JSON 的任何提示都很棒。

编辑：添加了与问题相关的堆栈转储

```
org.json.JSONException: Value null at results of type org.json.JSONObject$1 cannot be     converted to JSONArray
at org.json.JSON.typeMismatch(JSON.java:96)
at org.json.JSONObject.getJSONArray(JSONObject.java:548)
at it.cores.Activity$GetM.doInBackground(Activity.java:1159)
at it.cores.Activity$GetM.doInBackground(Activity.java:1)
at android.os.AsyncTask$2.call(AsyncTask.java:185)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:42:10.403

在对字符串结果进行任何操作之前，您必须确保在执行空检查/或任何其他验证（例如检查它是否包含响应代码）之后进行解析。

```
protected void onPostExecute(String result) 
{  
try{

    String foodName="";
    int Description=0;

if(result!=null)//Do your validation for result

{
    jArray = new JSONArray(result); // here if the result is null an exeption will occur
    JSONObject json_data = null;

    for (int i = 0; i < jArray.length(); i++) {
        json_data = jArray.getJSONObject(i);
        foodName=json_data.getString("Name");
        .
        .
        .
        .
        .
    } 
 }
   catch(JSONException e){ 
        **// what i can do here to prevent my app from crash and 
        //  make toast " the entered food isnot available " ????**
        Log.e("log_tag", "parssing  error " + e.toString()); 
    }   
} 
```

# mysql - 以特定顺序显示结果的简单 mysql 查询

> ID：10965529
> 
> 赞同：0
> 
> 时间：2012-06-10T00:17:46.667
> 
> 标签：mysql, sql, database

我创建了 2 个表格消息和对话。

会话表将为发送和接收消息的两个用户创建一个唯一 ID。

消息表将包含用户消息的所有信息。

**对话表**

```
conversation_id | user_id1 | user_id2 |last_message_id
      1              5          1           4
      2              5          2           5

message_id  | conversation_id | sender_id |  message |  created_time
   1           1                   5          MSG A     2012-06-10 00:20:04
   2           1                   5          MSG B     2012-06-10 00:20:21
   3           1                   5          MSG C     2012-06-10 00:21:09
   4           1                   1          MSG D     2012-06-10 00:22:23
   5           2                   5          MSG E     2012-06-10 00:25:16 
```

**我想要的输出：**

```
sender_id | message | created_time
   5        MSG E     2012-06-10 00:25:16
   1        MSG D     2012-06-10 00:22:23 
```

**我尝试了什么：**

```
SELECT * FROM conversation c, messages m 
WHERE c.user_id1='$userid' OR c.user_id2='$userid'
AND c.last_message_id=m.message_id
ORDER BY created_time DESC 
```

但是这个查询没有显示正确的结果。

我们是否也需要像以下这样的东西来分组？

```
SELECT * FROM TABLE
WHERE CONDITION
(SELECT MAX(created_time)
FROM TABLE
GROUP BY SOMEFEILD)
order by time desc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:27:56.470

尝试像这样更改您的查询

```
SELECT * FROM conversation c, messages m 
WHERE (c.user_id1='$userid' OR c.user_id2='$userid')
AND c.last_message_id=m.message_id
ORDER BY created_time DESC 
```

# java - ORA-01866 与 JDeveloper 10.1.3.4

> ID：10965536
> 
> 赞同：3
> 
> 时间：2012-06-10T00:19:04.000
> 
> 标签：java, oracle, jdeveloper, oracle-adf

我在 JDeveloper 10.1.3.4 中使用 ADF 运行应用程序。

创建应用程序模块时，我收到标题中提到的错误代码的异常：“ORA-01866 日期时间类无效”。它与代码*完全*无关，我可以向你保证。它只发生在我的电脑上，还有其他电脑没有出现这个问题，相同的代码等等。创建应用程序模块 (BC4J) 后，一切正常。这很奇怪。为了加强我的观点，在应用程序的一部分中，我创建了一个新线程（因为我想在网页的后台执行代码），所以我创建了一个新的应用程序模块，这里再次出现异常。

我正在运行带有 Service Pack 3 的 Windows XP。Java 版本是这个版本的 JDeveloper 附带的版本。java.exe -version 产生：

> java版本“1.5.0_06”
> 
> Java(TM) 2 运行时环境，标准版（内部版本 1.5.0_06-b05）
> 
> Java HotSpot(TM) 客户端 VM（内部版本 1.5.0_06-b05，混合模式）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T00:22:41.770

您是否尝试过Oracle 论坛上此[线程中建议的解决方案：](https://forums.oracle.com/forums/thread.jspa?threadID=370167)

*   在系统注册表中，转到*HKEY_LOCAL_MACHINE/SYSTEM/ControlSet001/Controls/TimeZoneInformation*

*   删除该`DisableAutoDaylightTimeSet`属性，或将其设置为`0`。

# macos - 统一从NSTextField、NSComboBox获取值？

> ID：10965538
> 
> 赞同：0
> 
> 时间：2012-06-10T00:19:41.253
> 
> 标签：macos, cocoa

我将以下方法设置为 an`NSComboBox`和两个`NSTextField`s 的操作：

```
- (IBAction)valueChanged:(id)sender
{
    if (sender == comboBox) {
        [myModel setFoo1:[comboBox intValue]];
    } else if (sender == intTextField) {
        [myModel setFoo2:[intTextField intValue]];
    } else if (sender == floatTextField) {
        [myModel setFoo3:[floatTextField floatValue]];
    }
} 
```

我想知道是否可以将该方法变成这样，以提高可维护性：

```
- (IBAction)valueChanged:(id)sender
{
    [myModel setValue:[sender value] forKey:[sender identifier]];
} 
```

不幸的是，它不是那样工作的。我收到以下错误：

```
[NSComboBox value]: unrecognized selector sent to instance 0x7fed42029430 
```

我如何以统一的方式（即作为对象）从控件中获取值，无论是否`int`或`float`？我在模型上使用的 KVC`setValue:forKey:`方法应该能够推断出值对象的实际类型（即`NSNumber`本例中的类型），对吧？

或者这根本不可能？（我知道我可以使用绑定将 UI 控件绑定到模型的值字段，但这不是我想要做的。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:35:53.153

由于`NSTextField`和`NSComboBox`都是 的子类`NSControl`，因此您应该能够以`-(id)objectValue`统一的方式使用来获取控件的值（或选定的值）。

# c++ - 在字符串中添加一个字符

> ID：10965542
> 
> 赞同：1
> 
> 时间：2012-06-10T00:20:45.030
> 
> 标签：c++, string, concatenation

在 C++ 中：

如果我想添加`0x01`到字符串文本中，我会这样做：`text += (char)0x01`;

如果我想添加`0x02`到字符串文本中，我会这样做：`text += (char)0x02`;

如果我想添加`0x0i`（`i`是 0 到 9 之间的无符号数`int`），我该怎么办？

编辑：我可能不太清楚。所以 0x01，我的意思是 Hex 中给出的字符为 01。所以在上面如果 i 是整数（十进制）说 3，那么我想添加 0x03（所以这不是十进制中给出的字符 48 + 3）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T00:22:51.907

你可以直接做

```
text += (char)i; 
```

因为`0x0i == i`if`i`介于 0 和 9 之间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T00:35:23.667

另一种可能性——你可以`push_back`改用。由于它将字符串`char_type`作为其参数类型，因此您不需要显式强制转换：

```
text.push_back(i); 
```

公平地说，我应该补充一点，你真的不需要一个明确的演员表`+=`。只需`text += i;`正常工作。例如：

```
std::string text; 
for (int i=0; i<9; i++)
     text += i; 
```

使用`text += i;`或`text.push_back(i);`，这将产生一个包含：“\x00\x01\x02\x03”的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T00:23:43.530

您应该生成它的 ASCII 值。`'0'`是 48 并且`'9'`是 9 + 48

```
text += (char)( i + 48 ) ; 
```

如果`i`是多位数字，您可以将其解析为数字并使用相同的技术生成其相等的字符串。

# wordpress - 在 Wordpress 博客页面中对 GET 变量使用 mod_rewrite

> ID：10965546
> 
> 赞同：0
> 
> 时间：2012-06-10T00:22:25.180
> 
> 标签：wordpress, .htaccess, mod-rewrite

我正在使用默认的 .htaccess 设置在 wordpress 博客上工作：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

在我的 wordpress 博客中，我创建了一个名为“mypage”的页面。使用我的重写设置，它在地址栏中显示为`http://www.mysite.com/mypage`.

我正在使用自定义页面模板并正在处理一些事情，其中​​包括使用 GET 变量。例如：

```
if (isset($_GET='word')) { echo $_GET['word]; } 
```

所以，`http://www.mysite.com/mypage?word=dog`会显示“狗”。

我遇到的问题是重写 URL，使其看起来像：`http://www.mysite.com/mypage/dog`，仍然能够访问“dog”作为 GET 变量。

一开始我对 mod_rewrite 规则不太了解，但是从 wordpress 安装中工作给我带来了额外的曲线球。

有谁知道我需要添加到我的 .htaccess 来实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:21:29.457

尝试以下操作：

```
RewriteRule ^mypage/([^/])/?$ mypage?word=$1 [L,QSA] 
```

L 标志指示 .htaccess 停止处理规则，并且 QSA 附加查询字符串，因为您可能在 URL 末尾有其他 GET 参数。

[Mod_Rewrite 文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

# jvm - 恒定池修补

> ID：10965552
> 
> 赞同：0
> 
> 时间：2012-06-10T00:23:38.510
> 
> 标签：jvm, openjdk, .class-file

我正在查看 OpenJDK 类文件解析器源代码，并且遇到了一些我从未听说过的东西 - 常量池修补。这是什么？我之前读过 JVM 规范，但它没有提到这样的东西，在谷歌上搜索也没有找到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T05:45:50.487

简而言之，修补过程在类解析时替换常量池条目，以处理实现了*invokedynamic*的 JSR-229 。*它用于在加载匿名类*时重写 UTF-8、类和值（float、int 等）条目。

有关如何实现*invokedynamic*的入门知识，请参阅[http://blog.headius.com/2008/09/first-taste-of-invokedynamic.html](http://blog.headius.com/2008/09/first-taste-of-invokedynamic.html)

# xcode - 代码签名错误，如何将 Xcode 项目切换到另一台 Mac？

> ID：10965554
> 
> 赞同：2
> 
> 时间：2012-06-10T00:23:58.110
> 
> 标签：xcode, certificate, code-signing, provisioning-profile

我知道如何使用 Xcode 和一切，但这是一个初学者问题。我刚买了一台新的 MacBook Pro，专门用于 iPhone 开发。我将我的主要应用程序项目从我的 Mac Mini 转移到了我的 MacBook Pro 上，这样我就可以同时处理两者了。到目前为止一切都很好，但是每当我插入我的实际 iPhone 进行测试时，我都会收到代码签名错误。我花了几个小时研究这个问题，甚至重新下载了我拥有的每个证书和配置文件，但仍然没有。在组织者中，一切都是有效的。我已确保 KeyChain Access 中的所有内容都正确，并确保它位于登录部分。我已经重新启动了 Xcode 和我的 MacBook Pro，但仍然没有。我什至将我的整个开发者资料的副本从我的 Mac mini 转移到了我的 MacBook Pro。现在我收到一个错误

`Code Sign error: No unexpired provisioning profiles found that contain any of the keychain's signing certificates`

我该怎么办？我什么都试过了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T01:10:17.163

（在旧 Mac 上）打开“钥匙串访问”，选择“我的证书”类别，找到显示“iPhone 开发人员：您的姓名”的那个，单击它旁边的三角形，它应该会展开以显示您的私钥。选择证书和私钥，右键单击（control-click），选择“Export 2 items”（或 File->Export Items）。将它们保存在某处，将文件复制到新的 mac，然后双击文件将其导入。

![钥匙串访问](../Images/2d012cf52847f076bd2afb2c4c40fb93.png) ![出口](../Images/cfd4a64a150973901a19d0c8f7b9f789.png)

# mysql - 改进子选择查询

> ID：10965558
> 
> 赞同：1
> 
> 时间：2012-06-10T00:24:39.727
> 
> 标签：mysql, sql

有没有办法在没有子选择的情况下进行以下查询？

```
SELECT * FROM 
(
SELECT * FROM messaging_message WHERE recipient_id=4 ORDER BY timestamp DESC
) combined
GROUP BY thread_id HAVING status='unread' 
```

桌子：

```
`messaging_message`
 - id
 - thread_id
 - content
 - sender_id
 - recipient_id
 - timestamp
 - status 
```

线程 ID 是消息的父线程。

**更新**：到目前为止，在测试这两个答案时，两个查询都没有生成我需要的结果。

查询应仅返回消息线程中最新消息 = '未读' 的结果。以下两个查询都返回具有状态 = '未读' 的消息的任何线程的最顶层结果。

我正在尝试做的是类似于任何电子邮件收件箱的东西，例如 Gmail。假设收件箱在第一页显示 25 个线程。我只想突出显示状态为“未读”的最新消息的线程（忽略比最新消息更早的任何消息的状态）。

这也是我`GROUP BY`在排序结果上使用的原因，这样我只得到最新的结果，在这些结果中，看看哪个有 status='unread'

（请注意，我还将上述查询中的状态从“已删除”更改为“未读”，以便解释更清楚。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T07:31:16.487

您的查询有点像 MySQL hack。SQL 标准不允许`order by`在那个位置使用。我什至不确定它是否会在 MySQL 中始终如一地工作。话虽如此，您的版本相当清晰，并且可能优于更严格的版本。

例如，编写查询的更正式的方式是：

```
select  *
from    (
        select  distinct thread_id
        from    messaging_message
        where   recipient_id = 4
        ) thread
join    messaging_message mm
on      mm.id =
        (
        select  mm2.id
        from    messaging_message mm2
        where   thead.thread_id = mm2.thread_id
        order by
                mm2.timestamp desc
        limit   1
        )
where   mm.status = 'unread' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T09:22:27.897

所以要清楚，您正在尝试在每个线程中检索该消息的收件人是 user_id 4 的最新删除消息的详细信息......对吗？如果是这样，这个问题类似于您在[此处](https://stackoverflow.com/questions/10958245/building-sql-query-to-join-three-tables-to-get-messaging-info)发布的问题，并且您似乎已将您的 messagestatus 表合并到您的消息表中（好！）。所以这是我调整后的答案：

```
SELECT 
    b.*
FROM 
    messaging_messagethread a
INNER JOIN 
    messaging_message b ON a.id = b.thread_id
WHERE 
    b.timestamp =
    (
        SELECT MAX(timestamp)
        FROM messaging_message
        WHERE thread_id = a.id
    )
    AND b.status = 'unread'
    AND b.recipient_id = 4 
```

在这里，我们使用[相关子查询](http://en.wikipedia.org/wiki/Correlated_subquery)来提取每个线程的最新消息的时间戳。

然后我们检查该消息是否具有“未读”状态。

最后在 WHERE 子句的第三个条件中，我们只选择最后一条删除消息的接收者为 user_id 4 的线程。

# javascript - NodeJS 基本文件IO

> ID：10965562
> 
> 赞同：5
> 
> 时间：2012-06-10T00:26:10.047
> 
> 标签：javascript, windows, node.js, file-io

刚刚测试了 NodeJS 并且还在学习用 javascript 思考，我怎样才能让下面的这个基本 FileIO 操作正常工作？

这就是我想要它做的事情：

*   读取 XML 文件（读入内存）
*   将所有内容放入变量中
*   从变量写入 XML 文件
*   输出应与原始文件相同

```
var fs = require('fs');
var filepath = 'c:\/testin.xml';

fs.readFile(filepath, 'utf8', function(err, data) {
    if(err) {
        console.error("Could not open file: %s", err);
    }
});

fs.writeFile('c:\/testout.xml', data, function(err) {
    if(err) {
        console.error("Could not write file: %s", err);
    }
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T00:29:02.837

您的代码的问题是您尝试在读取之前将读取的数据写入目标文件 - 这些操作是异步的。

只需将文件写入代码移动到`readFile`操作的回调中：

```
fs.readFile(filepath, 'utf8', function(err, data) {
    if(err) {
        console.error("Could not open file: %s", err);
        return;
    }
    fs.writeFile('c:/testout.xml', data, function(err) {
        if(err) {
            console.error("Could not write file: %s", err);
        }
    });
}); 
```

另一种选择是使用[`readFileSync()`](http://nodejs.org/docs/latest/api/fs.html#fs_fs_readfilesync_filename_encoding)- 但这将是一个坏主意，具体取决于您何时执行此操作（例如，如果操作是由来自用户的 HTTP 请求引起的）

```
var data = fs.readFileSync(filepath, 'utf-8');
fs.writeFileSync('c:/testout.xml', data); 
```

# java - JApplet 行为异常

> ID：10965571
> 
> 赞同：2
> 
> 时间：2012-06-10T00:28:45.457
> 
> 标签：java, swing, awt, japplet

```
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JApplet;
import javax.swing.Timer;

public class CountingSheep extends JApplet
{

    private Image sheepImage;
    private Image backgroundImage;
    private GameBoard gameBoard;
    private scoreBoard scoreBoard;

    public void init()
    {
        loadImages();
        gameBoard = new GameBoard(sheepImage, backgroundImage);
        scoreBoard = new scoreBoard();
        getContentPane().add(gameBoard);
        getContentPane().add(scoreBoard);
    }

    public void loadImages()
    {
        sheepImage = getImage(getDocumentBase(), "sheep.png");
        backgroundImage = getImage(getDocumentBase(), "bg.jpg");
    }
} 
```

当只将`GameBoard`类添加到 中时，程序可以正常工作`JApplet`，但是，当我尝试添加`ScoreBoard`类时，两个`Panel`类都没有显示在 Applet 上。我猜这现在归结为定位？有任何想法吗？

EDIT: Gone back to the previously asked question Hovercraft, and found it was due to the layout of the contentPane and the order at with the components were added.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T02:32:34.410

一些建议：

*   不要在 JApplet 的paint 方法中绘制，因为它是一个顶级窗口，不应该直接在上面绘制。而是在`paintComponent(Graphics g)`JPanel 或其他 JComponent 的方法中绘制，然后将该 JPanel 添加到 JApplet 的 contentPane。
*   与他关于超级调用的建议类似，您在此方法中的第一个方法调用应该是`super.paintComponent(g);`刷新 JPanel 图形的方法。
*   闪烁来自您在 JApplet 的绘制方法中直接绘制的图形。如果您按照我的建议进行操作，您将利用 Swing 对双缓冲的使用。
*   由于这是一个 Swing 应用程序，您应该避免使用 KeyListeners，而是使用 Key Bindings。
*   不要通过调用 getGraphics() 来获取组件的 Graphics 对象。获得的 Graphics 对象将是短暂的，因此不会在任何重绘后持续存在。

您在上面发布的代码让我有些困惑。你想用它做什么？您已经向 JApplet 添加了组件，这些组件应该处理它们自己的图形，然后您也在 JApplet 上进行绘画。你到底想达到什么样的行为？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T01:19:10.087

在您的[`paint`](http://docs.oracle.com/javase/6/docs/api/java/awt/Container.html#paint%28java.awt.Graphics%29)方法中，请确保调用，`super.paint(g)`因为它是继承自 的方法[`Container`](http://docs.oracle.com/javase/6/docs/api/java/awt/Container.html)，是 的超类`JApplet`。

```
@Override
public void paint(Graphics g)
{
    super.paint(g);
    ...
} 
```

# c# - 使用sql连接as400

> ID：10965574
> 
> 赞同：1
> 
> 时间：2012-06-10T00:29:16.570
> 
> 标签：c#, ado.net, db2, oledb, ibm-midrange

我认为这将是一件相当普遍的事情，并且很容易在谷歌中找到，但到目前为止我还没有多少运气。我希望我的应用程序`AS400`使用某种方法连接到 i 系列系统，在物理文件上运行`SQL`语句`AS400`，返回结果集，然后让我的可视化`c#`程序处理结果集。我听说过`ADODB, ODBC, DB2, and OLEDB`。有人可以向我展示使这些方法之一起作用的语法示例吗？我更喜欢使用一种不依赖于某些软件（例如客户端访问）的方法，并且`ODBC`由于您必须配置 DSN，因此我试图避免使用类似的方法。我已经搜索和搜索，但我能找到的大多数代码是连接字符串应该是什么样子。任何帮助表示赞赏！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T22:27:45.770

我在搜索过程中发现了这个问题。

您可以使用 OLEDB 连接连接到 IBM iSeries 并运行 SQL 查询，然后检索结果，但首先需要一些步骤。

1.  您需要 AS400 .Net 数据提供程序。- [http://www-03.ibm.com/systems/power/software/i/access/windows/dotnet.html](http://www-03.ibm.com/systems/power/software/i/access/windows/dotnet.html)

2.  您需要编写连接字符串。- [http://www.connectionstrings.com/as-400](http://www.connectionstrings.com/as-400)

3.  一些代码，然后

    ```
    string ConnectionString = AS400ConnectionString;
    OleDbConnection _Connection = new OleDbConnection(ConnectionString);
    OleDbCommand _Command = _Connection.CreateCommand();

                string strQuery = string.Empty;
                strQuery += @"SELECT * FROM Contacts";

                if (string.IsNullOrEmpty(strQuery))
                {
                    throw (new Exception("No Library Setup"));
                }

                _Command.CommandText = strQuery;
                if (_Connection.State != ConnectionState.Open)
                    _Connection.Open();

                OleDbDataReader reader = _Command.ExecuteReader();

                while (reader.Read())
                {
                    //Your Logic
                }

                reader.Close();
                if (_Connection.State != ConnectionState.Closed)
                    _Connection.Close(); 
    ```

# python - Python 3 pyQt4 使用来自多个模块/类的变量更新 GUI

> ID：10965575
> 
> 赞同：0
> 
> 时间：2012-06-10T00:29:33.420
> 
> 标签：python, python-3.x, tkinter, pyqt4

我编写了一个包含嵌套类/线程和多个模块的大型程序。我现在想添加一个简单的 GUI 和一些标签来显示一些变量。但是，变量分散在整个模块和类中。我正在寻找一种在不过多更改当前代码的情况下将这些变量更新到 GUI 中的方法。

我对 Pyqt4 有一个基本的了解（我也会接受 tkinter 的答案）。

我尝试不使用信号/发射，因为据我所知，发射必须从 Qthread 发送，这意味着对我的代码进行彻底检查，将类和线程更改为 Qthread。如果可能的话，我想避免这样做。这是我尝试过的一个例子。

***测试.py***

```
class Update(Thread): 
    def __init__(self): 
        Thread.__init__(self) 
    def run(self): 

        for i in range(10): 
            time.sleep(2) 
            import test 
            wa.label.setText(str(i)) 

class MyWindow(QWidget):  
    def __init__(self, *args):  
        QWidget.__init__(self, *args) 

        self.label = QLabel(" ") 
        layout = QVBoxLayout() 
        layout.addWidget(self.label) 
        self.setLayout(layout) 

        Update1 = Update() 
        Update1.start() 
        Update1.refresh1 = 'ba' 

        self.label.setText(Update1.refresh1) 

if __name__ == "__main__":  
    app = QApplication(sys.argv)  
    wa = MyWindow()  
    wa.show()  
    sys.exit(app.exec_()) 
```

此代码有效，但我的变量需要从其他模块/类或线程更新。当我将“类更新”移动到这样的新模块中时：

***测试.py***

```
import test2 

class MyWindow(QWidget):  
    def __init__(self, *args):  
        QWidget.__init__(self, *args) 

        self.label = QLabel(" ") 
        layout = QVBoxLayout() 
        layout.addWidget(self.label) 
        self.setLayout(layout) 

        Update1 = test2.Update() 
        Update1.start() 
        Update1.refresh1 = 'ba' 

        self.label.setText(Update1.refresh1) 

if __name__ == "__main__":  
    app = QApplication(sys.argv)  
    wa = MyWindow()  
    wa.show()  
    sys.exit(app.exec_()) 
```

***test2.py*** #更新图形用户界面

```
class Update(Thread): 
    def __init__(self): 
        Thread.__init__(self) 
    def run(self): 

        for i in range(10): 
            time.sleep(2) 
            import test 
            test.wa.label.setText(str(i)) 
```

我得到：`AttributeError: 'module' object has no attribute 'wa'`

此外，我还在考虑将类 Update() 放入 Qthread，从任何已更新变量的模块/类运行它，并在 Update() 中使用 emit 函数。这将解决必须将我当前的类/线程更改为 Qthreads 的问题。

如果有人知道一种简单的方法，我可以通过调用类似 update() 的类来更新我的 GUI，我们将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:09:34.750

因为`wa`仅在何时设置，`__name__ == "__main__"`并且仅`test.py`在主文件时发生。

当您这样做时`import test`，您正在运行该文件的另一个实例，`test.py`它不是主脚本，因此它`__name__ == 'test'`没有`__main__`。因此，即使`wa`已设置，您也会更改它的另一个实例。

**可能的解决方案：**

您可以获得对模块的引用并在`__main__`模块上进行设置`test2.py`：

在**test.py**上：

```
import test2
test2.parent = sys.modules[__name__] 
```

现在，在**test2.py**上（不要导入`test`，但要确保`test`导入`test2`）：

```
parent.wa.label.setText('Blablabla') 
```

# d - D语言中结构和类的使用偏好

> ID：10965577
> 
> 赞同：31
> 
> 时间：2012-06-10T00:30:07.453
> 
> 标签：d

什么时候应该将类型定义为结构或类？

我知道结构是值类型，而类是引用类型。所以我想知道，例如，我应该将堆栈定义为结构还是类？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-10T01:06:11.573

**选择结构与类的原因#1**：类具有继承性，结构没有。如果你需要多态，你必须使用类。

**原因 #2：**结构通常是值类型（尽管如果你使用它，你可以将它们设为引用类型）。类始终是引用类型。所以，如果你想要一个值类型，选择一个结构。如果你想要一个引用类型，最简单的方法是使用一个类。

**原因#3：**如果你有一个包含很多数据成员的类型，那么你可能会想要一个引用类型（以避免昂贵的复制），在这种情况下，你可能会选择一个类。

**原因 #4：**如果您想要确定性销毁您的类型，那么它将需要是堆栈上的结构。GC 堆上没有任何东西具有确定性破坏，并且 GC 堆上的东西的析构函数/终结器可能永远不会运行。如果它们被 GC 收集，那么它们的终结器将被运行，否则它们不会。因此，如果您希望您的类型在离开范围时自动销毁，您需要使用结构并将其放入堆栈。

至于您的特定情况，容器通常应该是引用类型（每次传递一个时复制它们的所有元素都会非常昂贵），并且 a`Stack`是一个容器，所以除非您使用，否则您将要使用一个类想要麻烦地将其设置为引用计数的结构，这无疑是更多的工作。它只是具有保证其析构函数在不再使用时会运行的优势。

附带说明一下，如果您创建一个作为类的容器，您可能希望将其设为 final，以便可以内联其各种功能（如果该类不是从任何东西派生的，则不会是虚拟的除了`Object`并且它们不是`Object`具有的功能），这对于诸如性能绝对重要的容器之类的东西可能很重要。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-10T00:49:56.660

将“D”读[入 D 编程语言](http://www.informit.com/articles/article.aspx?p=1381876&seqNum=5)

> 在 D 中，你得到结构，然后你得到类。它们共享许多便利，但有不同的章程：结构是值类型，而类则用于动态多态性，只能通过引用访问。这样会造成混乱、与切片相关的错误和评论 à la // 不！不要继承！不存在。当你设计一个类型时，你会预先决定它是一个单态值还是一个多态引用。众所周知，C++ 允许定义模棱两可的性别类型，但它们的使用很少、容易出错且令人反感，足以保证通过设计简单地避免使用它们。

对于您的`Stack`类型，您最好`interface`先定义其实现，然后再定义其实现（使用`class`），这样您就不会将您的`Stack`类型的特定实现绑定到其接口。

# python - 从文件python获取特定内容

> ID：10965582
> 
> 赞同：1
> 
> 时间：2012-06-10T00:31:10.840
> 
> 标签：python, arrays

我有一个包含数组的文件 test.txt：

```
array = [3,5,6,7,9,6,4,3,2,1,3,4,5,6,7,8,5,3,3,44,5,6,6,7] 
```

现在我要做的是获取数组的内容并使用数组执行一些计算。但问题是当我这样做时，`open("test.txt")`它会将内容输出为字符串。实际上数组非常大，如果我做一个循环，它可能效率不高。有什么方法可以在不拆分的情况下获取内容`,`？有什么新想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T00:34:14.773

我建议您将文件另存为 json，然后与`json`模块一起读入。要么，要么将其设为 .py 文件，然后将其作为 python 导入。一个看起来像 python 赋值的 .txt 文件有点奇怪。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T00:38:42.507

如果您想在文件中存储类似 python 的表达式，请*仅*存储表达式（即没有`array =`）并使用[`ast.literal_eval()`](http://docs.python.org/library/ast.html#ast.literal_eval).

但是，请考虑使用不同的格式，例如 JSON。根据计算，您可能还需要考虑使用不需要一次将所有数据加载到内存中的格式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-10T05:25:16.763

您的文本文件是否需要看起来像 python 语法？逗号分隔值的列表将是提供数据的常用方法：

```
1,2,3,4,5 
```

`csv`然后你可以用上面提到的模块或 numpy 函数读/写。有很多关于如何有效读取 csv 数据的文档。设置好 csv 阅读器数据对象后，可以使用以下方式存储数据：

```
data = [ map( float, row) for row in csvreader] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-10T00:59:38.807

数组必须保存为字符串吗？你可以使用一个泡菜文件并将其保存为 Python 列表吗？

如果没有，您可以尝试惰性评估吗？也许只根据需要处理数组的部分。

可能，如果您必须始终对整个数组进行计算，那么最好预先计算这些结果并将它们存储在 txt 文件中，作为列表的补充或代替列表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-10T02:24:43.307

您还可以使用 numpy 从使用 numpy.genfromtxt 或 numpy.loadtxt 的文件中加载数据。两者都非常快，并且都能够在加载时进行重铸。如果数组已经加载，您可以使用 numpy 将其转换为浮点数组，这非常快。

```
import numpy as np
a = np.array(["1", "2", "3", "4"])
a = a.astype(np.float) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-10T01:12:28.387

你可以写一个解析器。他们非常直截了当。而且比正则表达式快得多，请不要那样做。不是有人建议的。

```
# open up the file (r = read-only, b = binary)
stream = open("file_full_of_numbers.txt", "rb")
prefix = '' # end of the last chunk
full_number_list = []

# get a chunk of the file at a time
while True:
    # just a small 1k chunk
    buffer = stream.read(1024)
    # no more data is left in the file
    if '' == buffer:
        break
    # delemit this chunk of data by a comma
    split_result = buffer.split(",")
    # append the end of the last chunk to the first number
    split_result[0] = prefix + split_result[0]
    # save the end of the buffer (a partial number perhaps) for the next loop
    prefix = split_result[-1]
    # only work with full results, so skip the last one 
    numbers = split_result[0:-1]
    # do something with the numbers we got (like save it into a full list)
    full_number_list += numbers

# now full_number_list contains all the numbers in text format 
```

当缓冲区为空白时，您还必须添加一些逻辑来使用前缀。但我会把代码留给你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-10T06:38:58.390

**好的，所以以下方法很危险。**由于它们用于通过向其中注入代码来攻击系统，因此使用它们需要您自担风险。
`array = eval(open("test.txt", 'r').read().strip('array = '))`
`execfile('test.txt') # this is the fastest but most dangerous.`

**更安全的方法。**

```
import ast
array = ast.literal_eval(open("test.txt", 'r').read().strip('array = ')).
  ...
array = [float(value) for value in open('test.txt', 'r').read().strip('array = [').strip('\n]').split(',')] 
```

序列化 python 对象以便稍后加载它们的最简单方法是使用 pickle。假设您不想要人类可读的格式，因为这增加了主要的头部，无论哪种方式，csv 都很快，而 json 很灵活。

```
import pickle
import random
array = random.sample(range(10**3), 20)
pickle.dump(array, open('test.obj', 'wb'))

loaded_array = pickle.load(open('test.obj', 'rb'))
assert array == loaded_array 
```

pickle 确实有一些开销，如果需要序列化大对象可以指定压缩比，默认为 0 不压缩，可以设置为 pickle.HIGHEST_PROTOCOL`pickle.dump(array, open('test.obj', 'wb'), pickle.HIGHEST_PROTOCOL)`

如果您正在处理大型数字或科学数据集，则使用 numpy.tofile/numpy.fromfile 或 scipy.io.savemat/scipy.io.loadmat 它们几乎没有开销，但前提是您已经在使用 numpy/scipy。

祝你好运。

# android - android：如何选择联系人电话号码

> ID：10965585
> 
> 赞同：2
> 
> 时间：2012-06-10T00:32:00.810
> 
> 标签：android, contacts

我需要选择联系电话号码，我曾经这样做......

```
Intent intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
startActivityForResult（意图，GET_CONTACT_FROM_RESULT）；

```

但是，当一个联系人有多个号码时，pick 活动只列出一个联系人，并且只能选择一个电话。

如何显示联系人的每个电话号码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T11:44:15.837

您可以要求联系人选择器在每部电话中显示一个联系人，因此与多部电话的联系人会出现多次：

```
Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_ITEM_TYPE);
startActivityForResult(intent, PICK_CONTACT); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T11:55:38.717

```
 public Map<String, String> lookupPhoneNoAndContactId(){
    Map<String, String> phonenumbers = new HashMap<String, String>();
    Cursor cursor = null;
    try {
        cursor = contentResolver.query(
                ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null,
                null, null, null);
        while (cursor.moveToNext()) {
            phonenumbers
                    .put(cursor
                            .getString(cursor
                                    .getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER)),
                            cursor.getString(cursor
                                    .getColumnIndex(ContactsContract.CommonDataKinds.Phone.CONTACT_ID)));
        }
        return phonenumbers;
    } finally {
        if (cursor != null) {
            cursor.close();
        }
    }

} 
```

# c# - OPC.Tests.SmokeTest (TestFixtureSetUp)：设置：OpenQA.Selenium.InvalidSelectorException

> ID：10965586
> 
> 赞同：1
> 
> 时间：2012-06-10T00:32:19.623
> 
> 标签：c#, selenium, css-selectors, webdriver

我正在尝试使用 CssSelector 在我的网页上定位元素。我正在使用 Firefox 驱动程序。

这是我使用定位器的方式（我检查了 Selenium IDE 是否能够使用它定位我的元素

```
[FindsBy(How = How.CssSelector, Using = "label:contains('Version: 2.0.')")]
public IWebElement labelVersion; 
```

但是当在 C# 代码中使用它并在我的构造函数中使用 PageFactory.InitElements 对其进行初始化时。

我遇到了这个错误......（错误本身很清楚，但我不知道如何解决它）

感谢任何输入。

> OPC.Tests.SmokeTest (TestFixtureSetUp)：SetUp：OpenQA.Selenium.InvalidSelectorException：给定的选择器 css=label:contains('Version: 2.0.') 无效或不会生成 WebElement。发生以下错误：[异常...“指定了无效或非法字符串”代码：“12”nsresult：“0x8053000c（NS_ERROR_DOM_SYNTAX_ERR）”位置：“file:///....... /anonymous439571104.webdriver-profile/extensions/fxdriver@googlecode.com/components/driver_component.js 行：5811"]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T16:00:28.383

Selenium 将 CSS 查询委托给浏览器。这意味着 CSS 查询需要遵循 CSS 标准。

不幸的是 :contains 不久前从标准中删除了。我建议您使用[规范](http://www.w3.org/TR/selectors/)中可用的内容重做选择器或使用 XPATH。

:contains 在 Selenium RC 中有效，因为 RC 使用 Sizzle，如果您想知道为什么它在 RC 而不是 WebDriver 中有效，它是 jQuery 中的选择器搜索库

# deployment - 从 Internet Explorer 运行 SSRS 报告时出现错误代码 40（以管理员身份运行）

> ID：10965587
> 
> 赞同：0
> 
> 时间：2012-06-10T00:32:47.673
> 
> 标签：deployment, reporting-services, datasource

我们在客户的计算机上部署了一个包含 SSRS 报告的 VB.Net 应用程序。

应用程序连接到应用程序中的 SQL Server 数据库没有任何问题。我们安装了 SQL Server Data Tools，因此我们可以将报表 (rdl) 和数据源 (rdl) 文件部署到报表服务器。这些部署没有任何问题。

在 SQL Server Data Tools 中，我们也可以毫无问题地“预览”报表。

在尝试从 Internet Explorer（以管理员身份运行）查看报告时，我们确实遇到了问题。

我们收到以下错误：

```
Cannot create a connection to data source 'DataSourceReports' 
(this is the name we used for the TargetDataSourceFolder) 
error:40 - Could not open a connection to SQL Server 
```

当我们部署的应用程序运行报告时，我们也会遇到同样的错误。

请让我们知道在 SQL Server 端没有正确设置的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T14:44:32.570

一个可能的可能性是您遇到了双跳身份验证问题。从您的解释中不清楚，但是 SQL Server 数据库是否与报表服务器位于单独的服务器上？如果是这样，那么您的凭据允许您连接到报表服务器，但如果您在报表服务器上使用 NTLM，Windows 集成安全性不会将这些凭据传递到 SQL Server 数据库。报表服务器尝试使用网络上的 Kerberos 通过对 SQL Server 数据库的票证进行身份验证，但您必须在网络上正确配置此功能。如果您想使用 Kerberos，请参阅这篇文章：[http](http://technet.microsoft.com/en-us/library/ff679930(v=sql.100).aspx) ://technet.microsoft.com/en-us/library/ff679930(v=sql.100).aspx 。

另一个（更简单）的解决方案是打开报表服务器上的数据源并更改身份验证以使用存储的凭据。确保您使用的凭据对 SQL Server 数据库具有读取权限。这种方法的缺点是，除非您将报表设计为捕获用户信息并在数据集上设置查询或过滤器以限制用户数据，否则您无法在用户报表中使用行级安全性。如果这不是问题，存储的凭据很容易设置和维护——如果你想使用缓存、快照或订阅，无论如何你都必须这样做。有关存储凭据的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms159736.aspx](http://msdn.microsoft.com/en-us/library/ms159736.aspx)。

# javascript - 为什么这段代码在 Firefox 中运行缓慢？

> ID：10965588
> 
> 赞同：2
> 
> 时间：2012-06-10T00:33:34.987
> 
> 标签：javascript, jquery, performance, html, firefox

所以我为一个简单的游戏编写了这段代码。该代码在 Chrome 和 Safari 中均以 60 fps 的速度运行，但 Firefox 几乎无法管理 30-40 fps。代码对我来说看起来很简单。什么可能导致延迟？

我检查了萤火虫，发现只有一个“跟随”功能一直在占用。这是代码：

```
function checkCollision (ball0, ball1) {
    var dx = ball1.X - ball0.X,
        dy = ball1.Y - ball0.Y,
        dist = Math.sqrt(dx * dx + dy * dy);

    if (dist < ball0.rad + ball1.rad) {
      var angle = Math.atan2(dy, dx),
          sin = Math.sin(angle),
          cos = Math.cos(angle);

          var pos0 = {x: 0, y: 0}, 
          pos1 = rotate(dx, dy, sin, cos, true),
          vel0 = rotate(ball0.spdX, ball0.spdY, sin, cos, true),
          vel1 = rotate(ball1.spdX, ball1.spdY, sin, cos, true),
          vxTotal = vel0.x - vel1.x;
      vel0.x = ((ball0.mass - ball1.mass) * vel0.x + 2 * ball1.mass * vel1.x) /
               (ball0.mass + ball1.mass);
      vel1.x = vxTotal + vel0.x;
      var absV = Math.abs(vel0.x) + Math.abs(vel1.x),
          overlap = (ball0.rad + ball1.rad) - Math.abs(pos0.x - pos1.x);
      pos0.x += vel0.x / absV * overlap;
      pos1.x += vel1.x / absV * overlap;
      //rotate positions back
      var pos0F = rotate(pos0.x, pos0.y, sin, cos, false),
          pos1F = rotate(pos1.x, pos1.y, sin, cos, false);
      ball1.X = ball0.X + pos1F.x;
      ball1.Y = ball0.Y + pos1F.y;
      ball0.X = ball0.X + pos0F.x;
      ball0.Y = ball0.Y + pos0F.y;
      var vel0F = rotate(vel0.x, vel0.y, sin, cos, false),
          vel1F = rotate(vel1.x, vel1.y, sin, cos, false);
      ball0.spdX = vel0F.x;
      ball0.spdY = vel0F.y;
      ball1.spdX = vel1F.x;
      ball1.spdY = vel1F.y;
    }
}

function move()
{
    var side,i;
    for (i=0 ; i < balls.length; i++)
    {   
        var obj = balls[i];
        if (side=obj.edgeX())
        {
            if (side === 'l')
                obj.X = obj.rad;
            else if (side === 'r')
                obj.X = canvas.width() - obj.rad;
            obj.spdX*=-1;
        }
        if (side=obj.edgeY())
        {
            if (side === 't')
                obj.Y = obj.rad;
            else if (side === 'b')
                obj.Y = canvas.height() - obj.rad;
            obj.spdY*=-1;
        }

        if (leash == true && i === 0)
        {
            if (mouse.X>obj.X && (obj.spdX<10))
                obj.spdX+=obj.accX;
            else if (mouse.X<obj.X && (obj.spdX>-10))
                obj.spdX-=obj.accX;
            if (mouse.Y>obj.Y && (obj.spdY<10))
                obj.spdY+=obj.accY;
            else if (mouse.Y<obj.Y && (obj.spdY>-10))
                obj.spdY-=obj.accY;
        }

        obj.X+=obj.spdX;
        obj.Y+=obj.spdY;
        if (Math.abs(obj.spdX)>0.1)
            obj.spdX*=0.98;
        else obj.spdX=0;
        if (Math.abs(obj.spdY)>0.1)
            obj.spdY*=0.98;
        else obj.spdY = 0;
    };
}

function follow()
{
    var ballA, i, ballB,j;
    requestAnimationFrame(follow);
    //stats.begin();
    context.clearRect(0,0,canvas.width(),canvas.height());

    move();
    for (i = 0, len = balls.length - 1; i < len; i++) {
          ballA = balls[i];
          for (j = i + 1; j < balls.length; j++) {
            ballB = balls[j];
            checkCollision(ballA, ballB);
          }
     }
    balls.forEach(function(obj){
        drawCircle(obj.X,obj.Y,obj.rad, obj.color);
        if (leash == true && obj.control === true)
        {drawLeash(mouse.X,mouse.Y,obj.X,obj.Y,obj.color);}
    });
    //stats.end();
}; 
```

这是动画：http: [//ipsumturpis.xtreemhost.com/follower/index.html](http://ipsumturpis.xtreemhost.com/follower/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:59:15.760

我隐约记得 FF 曾经在画布绘制性能方面存在问题，所以我已经注释掉了`drawCircle(obj.X,obj.Y,obj.rad, obj.color);`，噗，神奇的事情发生了——我的帧速率从 11 FPS 上升到了 60。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:30:44.853

尝试在变量中缓存球的长度。除非出于我看不到的原因绝对有必要，否则在循环的每次迭代中运行 balls.length （或任何函数）自然会很耗时。

所以尝试这样的事情；

```
ballslen = balls.length;
for (j = i + 1; j < ballslen; j++) 
```

# sql-server - SQL 中的 Unicode 数据类型

> ID：10965589
> 
> 赞同：5
> 
> 时间：2012-06-10T00:33:40.493
> 
> 标签：sql-server, unicode, sqldatatypes

我是 Microsoft SQL 的新手。我打算将文本存储在 Microsoft SQL 服务器中，并且会有特殊的国际字符。是否有特定于 Unicode 的“数据类型”，或者我最好使用对 unicode 编号的引用来编码我的文本（即 \u0056）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-10T00:41:38.147

使用`Nvarchar`/ `Nchar`（[MSDN 链接](http://msdn.microsoft.com/en-us/library/ms186939.aspx)）。曾经也有一个`Ntext`数据类型，但现在已弃用，取而代之的是`Nvarchar`.

`char`这些列占用的空间是非 unicode 对应项 (和`varchar`)的两倍。

然后当“手动”插入它们时，使用`N`它来表示它是 unicode 文本：

```
INSERT INTO MyTable(SomeNvarcharColumn) 
VALUES (N'français') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-10T03:00:47.777

当你说特殊的国际字符时，你是什么意思？如果特殊意味着它们不常见并且只是偶尔出现，那么在具有大量行或大量索引的表的情况下，nvarchar 的开销可能没有意义。

我完全赞成在适当的情况下使用 Unicode，但理解何时适当很重要。

如果您将数据与不同的隐含代码页（同一数据库中的日文和中文）混合在一起，或者您只想对国际化和本地化具有前瞻性，那么您希望列是 Unicode 并使用 nvarchar 数据类型，这很好。Unicode 不会神奇地为您解决所有排序问题。

如果您知道您将始终主要存储 ASCII 但偶尔会存储一些外来字符，只需将 UTF-8 数据或 HTML 编码数据存储在 varchar 中。如果您的数据都是日文和代码页 932（或任何其他单个代码页），您仍然可以在 varchar 中存储双字节字符，它们仍然占用两个字节。我的观点是，当您已经在 DBCS 排序规则中时，国际字符不再是“特殊的”。在查询和其他数据流中处理这样的列时，不仅仅是数据存储，还有任何索引和工作集。

并且不要制定所有字符数据都应该是 nvarchar 的一揽子规则 - 这对于许多作为代码或标识符的列来说是一种浪费。

任何时候你有一个专栏，都要回答同样的问题：

数据的类型是什么？

范围是多少？

是否允许 NULL？

尺寸限制是多少？

我现在应该应用任何限制来阻止不良数据从一开始就进入吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T00:43:22.033

人们已经成功地使用以下代码在插入数据操作时强制使用 Unicode。

```
INSERT INTO <table> (text) values (N'<text here>) 
```

[1](http://www.coderanch.com/t/305245/JDBC/java/Unicode-MSSQL)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T00:37:47.330

表的字符集特征和其中的字符串是为数据库指定的，如果您的数据库具有 Unicode 排序规则，则表中的字符串是 unicode。对于字符串列，您必须使用`nvarchar`或`nchar`数据类型才能使它们能够存储 unicode 字符串。但是，如果您的数据库具有 utf8 或 unicode 字符集或排序规则，则此功能有效。阅读此链接以获取更多信息。[Unicode 和 SQL Server](https://docs.microsoft.com/en-us/sql/t-sql/data-types/nchar-and-nvarchar-transact-sql)

# mysql - 转换为仅在 MySQL 运行时才知道的 column_type？

> ID：10965600
> 
> 赞同：0
> 
> 时间：2012-06-10T00:35:55.860
> 
> 标签：mysql, dynamic-sql

在 MySQL 中，我正在检索一个`column_type`from ，`information_schema.columns`然后想要生成一个到. 但是，对于什么是数据类型，两者似乎都有自己的想法。例如，我经常从信息模式中接收、和，并且想要从本质上执行，但它说这是一个语法错误。`SELECT``CASTs``column_type``CAST``CONVERT``VARCHAR(64)``TEXT``INT(10) UNSIGNED``CONVERT(`Table`.`Column`, INT(10) UNSIGNED)`

我需要将其编写为`CONVERT(`Table`.`Column`, UNSIGNED)`，但在这种情况下，我将需要编写代码来解析每个可能的响应`column_type`并将其转换为`CAST`等效的，即使那样也不能保证生成我需要的代码：如果我正在使用 BIGINT 并试图将其塞入 INT 中怎么办？有没有办法对用于定义表的实际列类型执行强制转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T01:03:30.777

因此，您想通过使用来自另一个 SQL 语句的值来创建一个 SQL 语句。

这称为“动态 SQL”，在 MySQL 中，这只能通过在[存储过程中创建](http://dev.mysql.com/doc/refman/5.5/en/stored-routines.html)[准备好的语句](http://dev.mysql.com/doc/refman/5.5/en/sql-syntax-prepared-statements.html)来实现。此外，只能从[用户变量](http://dev.mysql.com/doc/refman/5.5/en/user-variables.html)创建准备好的语句。

所以你最终会得到这样的东西：

```
CREATE PROCEDURE ...() BEGIN
  DECLARE desired_type VARCHAR(255);
  SELECT column_type FROM information_schema.columns ... INTO desired_type;
  SET @your_dynamic_sql = CONCAT("UPDATE ... SET ... = CONVERT(..., ", desired_type, ");");
  PREPARE update_statement FROM @your_dynamic_sql;
  EXECUTE update_statement;
END 
```

# android - 文件从 SD 卡中消失

> ID：10965602
> 
> 赞同：2
> 
> 时间：2012-06-10T00:36:54.973
> 
> 标签：android, android-sdcard, fileinfo

我在 SD 卡上创建文本文件以附加到要通过 gmail 应用程序发送的电子邮件时遇到问题。当附加到 gmail 应用程序中的电子邮件时，该电子邮件将永远处于红色的“正在发送...”状态。该文件是使用下面的 createCSVfile() 创建的。

调试我的代码，在不同的时间启动我的应用程序，csv_file.exists() 总是返回 false，就好像找不到文件并且每次运行应用程序时都会创建该文件一样。但是，使用文件管理器，我可以看到文件在运行之间和运行期间存在。

请问有什么帮助吗？谢谢

```
File csv_file = null;
String createCSVfile() {
    if (Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())) {
        csv_file = new File( getExternalFilesDir(null) + File.separator + "InOutStats.txt");
        if (csv_file != null ) {
            if( csv_file.exists() ){
                Log.v("CSV_FILE", "Stat file " + csv_file.toString() +" already there!");
            }else{
                csv_file.getParentFile().mkdirs();
                try {
                    boolean bool = csv_file.createNewFile();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
            FileWriter fWriter = null;
            try {
                fWriter = new FileWriter(csv_file);
            } catch (IOException e) {
                e.printStackTrace();
            }
            BufferedWriter writer = new BufferedWriter(fWriter);
            try {
                writer.write("Some text here!!! " + new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(System.currentTimeMillis()));
                writer.newLine();
            } catch (IOException e) {
                e.printStackTrace();
            }
            try {
                writer.flush();
                writer.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }else{
        Log.v("CSV_FILE", "NO SD CARD HERE???");
    }
    return csv_file.toString();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:48:40.440

错误是：

```
new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(System.currentTimeMillis()) 
```

应该是

```
new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()) 
```

我只看到两个非常小的“错误”：

[风格问题]

```
csv_file = new File( getExternalFilesDir(null) + File.separator + "InOutStats.txt"); 
```

应该

```
csv_file = new File( getExternalFilesDir(null), "InOutStats.txt"); 
```

因为否则你正在使用`File.toString()`.

【最小码】

删除的应该是：

```
csv_file.createNewFile(); 
```

* * *

***第二次尝试***

尝试更换

```
 if (csv_file != null ) {
        if( csv_file.exists() ){
            Log.v("CSV_FILE", "Stat file " + csv_file.toString() +" already there!");
        }else{
            csv_file.getParentFile().mkdirs();
            try {
                boolean bool = csv_file.createNewFile();
            } catch (IOException e) {
                e.printStackTrace();
            }
        } 
```

和

```
 { 
```

这将删除存在测试、mkdirs 和不需要的单独文件创建。完成以尝试限制错误区域。

此外，您正在使用文本的默认平台编码；你可以明确表示：

```
new FileWriter(csv_file, "UTF-8") 
```

# ios - 为什么我会得到`缺少标识符的代理 `消息？

> ID：10965607
> 
> 赞同：3
> 
> 时间：2012-06-10T00:38:19.910
> 
> 标签：ios, interface-builder

我有一个带有标签栏控制器的应用程序，它监督两个视图控制器，每个控制器都有自己的 nib。每个 nib 都有一些外部对象（每种情况下的视图控制器，另一种情况下的一些单例）。当这个东西启动时，我在控制台中收到消息，上面写着“缺少标识符代理”，后跟一个外部对象的名称。在我看来，这只是一条消息，因为应用程序似乎运行良好。笔尖和物体似乎都连接得很好。

我的问题：这条消息有问题吗？如果有，它想告诉我什么？我觉得这可能意味着某些东西没有正确连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T13:08:20.567

您正在执行以下操作

您在 tableView 或 table view 控制器中使用具有相同可重用标识符的表中的两行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-27T00:04:36.230

有时，如果正在安装应用程序，可能是由于与以前版本的某种冲突，我的问题在删除应用程序并重新安装后得到解决。

# ruby-on-rails-3 - 当路由存在时，为什么我会收到 No Route Matches [GET] "/products"？

> ID：10965608
> 
> 赞同：1
> 
> 时间：2012-06-10T00:38:31.180
> 
> 标签：ruby-on-rails-3, rails-routing

我是 Ruby 和 Ruby on Rails 的新手，在 Max OSX Lion 上使用 Ruby 1.9.2 和 Rails 3.2.5，并且正在阅读“Agile Web Development with Rails (4th Edition)”一书。

我使用第 6 章中概述的以下命令创建了他们的示例 depot 应用程序：

1.  轨道新仓库
2.  rails 生成脚手架产品标题：字符串描述：文本 image_url：字符串价格：十进制
3.  耙分贝：迁移
4.  导轨服务器

当我将 Safari 指向“http://localhost:3000/products”时，我得到以下操作控制器：异常捕获错误消息，而不是看到产品列表页面：

```
Routing Error
No route matches [GET] "/products"
Try running rake routes for more information on available routes. 
```

在终端中运行“rake routes”给了我：

```
 products GET    /products(.:format)          products#index
             POST   /products(.:format)          products#create
 new_product GET    /products/new(.:format)      products#new
edit_product GET    /products/:id/edit(.:format) products#edit
     product GET    /products/:id(.:format)      products#show
             PUT    /products/:id(.:format)      products#update
             DELETE /products/:id(.:format)      products#destroy 
```

以下行自动添加到 routes.rb。

```
resources: product 
```

products_controller.rb 中还有一个索引方法。

```
class ProductsController < ApplicationController
  # GET /products
  # GET /products.json
  def index
    @products = Product.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @products }
    end
  end 
```

搜索本书的[勘误表](http://pragprog.com/titles/rails4/errata)和[论坛](http://forums.pragprog.com/forums/148)并没有找到任何可能的解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:40:01.240

想通了——我在另一个终端窗口中运行了另一个 WEBrick 服务器实例，但它是用于前一章的演示应用程序的。

学过的知识。确保从要测试的 Rails 应用程序目录运行本地服务器。

# mysql - 从 Rails 的关系表中选择单行

> ID：10965609
> 
> 赞同：0
> 
> 时间：2012-06-10T00:38:35.933
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, has-many-through

有没有更简单的方法可以从表中返回关系行以访问存储在那里的数据？

我有两个使用 has_many :through 相关的模型，第三个模型设置为中间。我的模型由 User、Recipe 和 RecipeInfo 组成。

现在，为了访问为特定用户的食谱信息存储的数据，我正在使用与此类似的 Rails 查询

`info = @user.recipeInfos.where("recipe_id=#{@recipe.id}")`

我想知道是否有一种更简单的方法来访问用户食谱信息的这一行，而不是使用 .where() 方法。

编辑：

`recipe = Recipe.find(params[:id])`

`user = current_user`

`current_user`由`sessions[:user_id] = current_user`用户登录的时间定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:18:59.650

您可以将这四行代码缩短为

```
info = current_user.recipeInfos.find_by_id(params[:id]) 
```

.

# shopify - 如何针对 shipping api 测试尚未发布的新应用程序？

> ID：10965616
> 
> 赞同：7
> 
> 时间：2012-06-10T00:40:00.930
> 
> 标签：shopify

我已经获得了新的运输 API 的访问权限，在合作伙伴部分创建应用程序并随后编辑它的详细信息时，我可以将其设置为运输应用程序。

然后我可以在测试商店（相同的合作伙伴帐户）中添加运费提供商，但只能看到 USPS、加拿大邮政、Fedex 等。并且看不到应用程序。我想这是因为测试应用程序尚未发布。但是我不想发布测试应用程序，并且在将应用程序添加为运输提供商之前发布应用程序的要求会阻碍开发和测试；-)

我已尝试访问[http://your-store.myshopify.com/admin/api/auth?api_key=YOUR_API_KEY](http://your-store.myshopify.com/admin/api/auth?api_key=YOUR_API_KEY) 但我看不到这将如何将我的测试应用程序添加为测试的运输偏好中的运费提供者应用程序。

事实上，我放弃了使用[http://your-store.myshopify.com/admin/api/auth?api_key=YOUR_API_KEY](http://your-store.myshopify.com/admin/api/auth?api_key=YOUR_API_KEY)并转移到用户 Oauth2 （我似乎无法让旧的身份验证示例正常工作。）

我可以通过 OAuth2 注册该应用程序，但是此运输应用程序的选项未出现在“承运人计算的运费”中

现在我真的很难过。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T01:54:39.183

1.  确保您创建的应用程序已选中“这是一个运输应用程序”框。
2.  访问[http://YOUR-STORE.myshopify.com/admin/api/auth?api_key=YOUR_API_KEY](http://YOUR-STORE.myshopify.com/admin/api/auth?api_key=YOUR_API_KEY)
3.  访问[https://YOUR-STORE.myshopify.com/admin/shipping](https://YOUR-STORE.myshopify.com/admin/shipping)并且您的应用程序公开的运输服务应该作为承运人计算的运费提供。（如果您还没有添加任何内容，请点击页面顶部的那个按钮。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T00:51:35.490

就注册应用程序而言，好的 Edwards 答案是正确的。

但是，如果应用程序提供了运输 API，它将“不”出现在运营商计算的运输运费配置中。

成功注册应用程序后，您必须对 carrier_services.json 进行 POST 调用。例如在python中

```
response = connection.post("%s/carrier_services.json" % shopify_session.site,headers) 
```

完成此操作后，将在结帐过程中调用新的运输 API。

另外请注意，如果您在首选项中对运输配置进行了任何更改，您将需要再次 POST 到 carrier_services.json 以重新启用运输 api。似乎当前对运输细节的任何更改都会使该应用程序无法被调用。

现在还处于早期阶段，毫无疑问情况会发生变化。

# facebook - facebook登录js sdk重定向

> ID：10965618
> 
> 赞同：-1
> 
> 时间：2012-06-10T00:40:44.770
> 
> 标签：facebook, authentication

我正在尝试在我的网站上使用 facebook 登录，这是我加载 sdk 的方式

```
 window.fbAsyncInit = function() {
 FB.init({
   appId      : '362869753746986', // App ID
   channelUrl : '//WWW.FESTIVEHUB.COM/channel.html', // Channel File
    status     : true, // check login status
   cookie     : true, // enable cookies to allow the server to access the session
   xfbml      : true  // parse XFBML
 });

// Additional initialization code here
};

// Load the SDK Asynchronously
(function(d){
 var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "//connect.facebook.net/en_US/all.js";
 ref.parentNode.insertBefore(js, ref);
}(document)); 
```

和登录按钮

```
 <div class="fb-login-button" data-show-faces="true" data-width="200" data-max-rows="2"></div> 
```

如果我单击登录按钮，它会显示一个新的 facebook 登录窗口，如果我这样做会登录问题，但是在登录后，新的小窗口仍然存在并且它是空白的，但是如果我手动关闭它并刷新我的页面，登录按钮是替换为我的 FB 个人资料图片，因此我需要自动关闭登录窗口，并且我需要一个回调函数，以便我可以在登录后采取行动。如果值得注意的话，NB 正在处理 localhost！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T09:16:19.137

您的代码看起来不错，但您的问题可能是您的 channelUrl 文件。频道 URL 上的域、您的应用程序注册 URL 以及您尝试登录的 URL 都必须匹配。通道文件也需要有一行

```
<script src="https://connect.facebook.net/en_US/all.js"></script> 
```

去工作。

# php - 正确使用 VQMod 偏移

> ID：10965621
> 
> 赞同：0
> 
> 时间：2012-06-10T00:41:16.110
> 
> 标签：php, xml, offset, opencart

我正在为 OpenCart 创建一个小型 VQMod

我想搜索一段带有多行的代码，但是我无法找出正确的偏移值。

我正在阅读 vqmod 手册，他们建议您计算行数，然后将行数减去 1 以确定偏移量，但它对我不起作用？

这是我的代码

```
<modification>

    <id>xxx</id>
    <version>xxx</version>
    <vqmver>xxx</vqmver>
    <author>xxx</author>

    <file name="catalog/view/theme/*/template/account/register.tpl">
        <operation>
            <search position="replace" offset="17"><![CDATA[
        <tr>
            <td><?php echo $entry_company; ?></td>
            <td><input type="text" name="company" value="<?php echo $company; ?>" class="large-field" /></td>
        </tr>
        <tr id="company-id-display">
          <td><span id="company-id-required" class="required">*</span> <?php echo $entry_company_id; ?></td>
          <td><input type="text" name="company_id" value="<?php echo $company_id; ?>" />
            <?php if ($error_company_id) { ?>
            <span class="error"><?php echo $error_company_id; ?></span>
            <?php } ?></td>
        </tr>
        <tr id="tax-id-display">
          <td><span id="tax-id-required" class="required">*</span> <?php echo $entry_tax_id; ?></td>
          <td><input type="text" name="tax_id" value="<?php echo $tax_id; ?>" />
            <?php if ($error_tax_id) { ?>
            <span class="error"><?php echo $error_tax_id; ?></span>
            <?php } ?></td>
        </tr>
        ]]></search>
            <add><![CDATA[ 
            <?php echo 'test'; ?>
        ]]></add>
        </operation>            
    </file>     

</modification> 
```

我数了 18 行并将我的偏移量设置为 17。

我是不是在某个地方出错了。

很高兴收到大家的回复谢谢彼得

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:04:58.960

Vqmods 偏移值用于替换一行和后面的 x 行，但仅搜索一行。vqmod 不匹配多行

# jquery - 如何在firefox上删除onclick？

> ID：10965622
> 
> 赞同：-3
> 
> 时间：2012-06-10T00:41:27.123
> 
> 标签：jquery, javascript-events

如何在 firefox 上删除 onclick ？怎么能做到自动呢？

```
<a class="nextQuestion" onclick="loadNext();" href="javascript:void(0)" id="nextQuestion" style="opacity: 1; bottom: 10px;"></a> 
```

我不想点击它。**onclick="loadNext()**
感谢等待答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:43:32.423

在您的特定问题中：

```
document.getElementById('nextQuestion').removeAttribute('onclick'); 
```

但是，老实说，与其在页面中添加 JavaScript 来删除，`onclick`为什么不简单地`onclick`从 HTML 源中删除呢？

或者，如果你真的觉得有必要为此使用 jQuery：

```
$('#nextQuestion').removeAttr('onclick'); 
```

# java - Javaw.exe 不会运行 .jar 文件，而 java.exe 会

> ID：10965623
> 
> 赞同：0
> 
> 时间：2012-06-10T00:41:36.127
> 
> 标签：java, jar, executable-jar

我有一个我写的java应用程序。我可以使用 Ant 和命令行中的“java -jar”来执行它。我希望能够使用“javaw.exe”启动文件（我的应用程序使用 Swing）。出于某种原因，它似乎没有做任何事情（javaw 开始一秒钟，然后退出，我看不到任何错误）。我尝试使用 javaw 在我的 Win XP 计算机上运行相同的文件，它执行得很好。我正在使用的另一台计算机是 Win 7 笔记本电脑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:54:57.853

基于 purtip31 的评论...

我预计问题是当您使用 启动时发生了一些异常或错误`javaw`，但是您看不到任何诊断，因为它们无处可去。

*   在短期内，将标准输出重定向到文件并查看正在写入的内容。

*   从长远来看，通过日志框架（如 log4j、java.util.logging 等）用适当的日志记录替换您的“System.out”和“System.err”诊断。

# objective-c - 调度到主队列总是失败

> ID：10965626
> 
> 赞同：3
> 
> 时间：2012-06-10T00:42:37.370
> 
> 标签：objective-c, ios, queue, grand-central-dispatch, dispatch

我正在尝试通过 iOS 上的 GCD 将一些代码分派到主队列，但即使是最简单的测试也总是失败。最后归结为：

```
static const int TICK_INTERVAL = 1;

#pragma UIApplicationDelegate implementation

- (void) doTick
{
    if (![NSThread isMainThread])
    {
        NSLog(@"Trying to dispatch . . .");
        dispatch_sync(dispatch_get_main_queue(), ^{
            NSLog(@"test . . .");
        });
    }
}

- (void) startUpdate
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

        timer_ = [NSTimer
                  scheduledTimerWithTimeInterval:TICK_INTERVAL
                  target:self
                  selector:@selector(backgroundUpdate)
                  userInfo:nil
                  repeats:NO
                  ];

        [[NSRunLoop currentRunLoop]
         addTimer:timer_
         forMode:NSRunLoopCommonModes
         ];

        [[NSRunLoop currentRunLoop] run];
    });

    UIBackgroundTaskIdentifier back =
    [[UIApplication sharedApplication]
     beginBackgroundTaskWithExpirationHandler:^{
         [self doTick];
         [[UIApplication sharedApplication]
          endBackgroundTask:back
          ];
     }];
}

-(void)backgroundUpdate
{
    [self doTick];

    UIBackgroundTaskIdentifier back =
    [[UIApplication sharedApplication]
     beginBackgroundTaskWithExpirationHandler:^{
         [self doTick];
         [[UIApplication sharedApplication]
          endBackgroundTask:back
          ];
     }];

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
            timer_ = [NSTimer
                     scheduledTimerWithTimeInterval:TICK_INTERVAL
                     target:self
                     selector:@selector(backgroundUpdate)
                     userInfo:nil
                     repeats:NO
                     ];

            [[NSRunLoop currentRunLoop]
             addTimer:timer_
             forMode:NSRunLoopCommonModes
             ];

            [[NSRunLoop currentRunLoop] run];
        });
}

- (id) init
{   
    self = [super init];
    [self startUpdate];
    return self;
} 
```

那是我的`AppDelegate`。我希望 NSLog 在主线程中执行以记录上面的测试文本，但没有任何反应。`dispatch_sync`代码只是永远等待，我放置在块内的断点永远不会到达。

我确保代码不在主线程中执行。在测试之前`dispatch_sync`，我`dispatch_async`在我的应用程序中进行了实验，结果当然基本相同：没有任何反应（没有阻塞）。

有趣的是，它似乎不适用于主队列，其他队列（当前队列、全局队列）似乎工作得很好。

我在我的应用程序中使用 Phonegap (Cordova)，如果这有任何意义的话。

*有什么*想法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T01:25:53.980

你永远不应该`dispatch_sync`从一个队列上执行的任务到同一个队列。这可以保证在任何串行队列（如主队列）上死锁，并且在并发队列上是个坏主意。有关详细信息，请参阅[Apple 的并发编程指南](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW3)。由于应用程序委托的init方法在主线程上运行，`dispatch_sync`对主队列造成死锁。

`dispatch_async`只要您在主线程上运行正常的 NSRunLoop，主队列就可以工作。当然，您的`NSLog(@"test . . .")`执行可能比您的应用程序委托的 init 方法完成晚得多。

# objective-c - 如何在 Mac 应用程序的标题栏中定位进度微调器

> ID：10965629
> 
> 赞同：2
> 
> 时间：2012-06-10T00:43:17.290
> 
> 标签：objective-c, xcode, interface-builder, nsprogressindicator

我正在尝试在我的 Mac OS X 应用程序窗口标题栏的右侧放置一个进度微调器，但我无法使用 Interface Builder 执行此操作，因为它不允许我将视图拖到里面它。

因此，我尝试以编程方式将其放在标题栏中，`applicationDidFinishLaunching`在 AppDelegate.m 的方法中使用以下代码：

```
loadingSpinner = [[NSProgressIndicator alloc] init];
[loadingSpinner setFrame:NSMakeRect(485, 0, 17, 17)];
[loadingSpinner setStyle:NSProgressIndicatorSpinningStyle];
NSView *titleBarView = [[_window standardWindowButton:NSWindowCloseButton] superview];
[titleBarView addSubview:loadingSpinner]; 
```

但是，这会将我的进度微调器视图放在窗口底部而不是标题栏。看起来 NSMakeRect() 是相对于窗口底部而不是顶部定位它。

如果我将 NSMakeRect 的第二个参数（y 位置）更改为 370 之类的值，它会将加载微调器放在我想要的位置，但显然当我垂直调整窗口大小时，它会将进度微调器放在底部。

我以前从未见过这样的事情。我该如何解决？

PS：另外，我不知道是否有“更正确”的方式来获取标题栏视图。如您所见，我正在使用关闭按钮视图的超级视图来获取它，这似乎有点“脏”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:09:48.070

[Randall Brown在他的博客上](http://fredandrandall.com/blog/2011/09/14/adding-a-button-or-view-to-the-nswindow-title-bar/)有一些代码可以在 NSWindow 的标题栏中放置一个按钮。你走在正确的轨道上。关闭按钮的超级视图是包括标题栏在内的整个窗口。使用`[[_window contentView] superview]`.

# objective-c - Objective-C，如何以相同的方法重新定义 NSString？

> ID：10965631
> 
> 赞同：0
> 
> 时间：2012-06-10T00:43:26.610
> 
> 标签：objective-c, methods, nsstring

我试图找出可能在同一方法中重新定义 NSString 的最佳方法。基本上在过去我已经处理过它们`[self goSomewhereVoid]`以重新定义字符串然后返回到该方法。有没有其他方法可以在不离开方法的情况下做到这一点？谢谢你。

```
- (void)someMethod(NSString *)theString {

isNumberOne = YES;

NSString *theString = @"something that changes often";
[self goSomewhereVoid:theString];

isNumberTwo = YES;

NSString *theString = @"time to change something"; // <- possible to redefine this?
[self goSomewhereElseVoid:theString];

... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T00:45:08.267

是的，去吧：

```
theString = @"new value"; 
```

# c++ - 如何确定阻塞的 SSL BIO 连接是否已关闭？

> ID：10965633
> 
> 赞同：3
> 
> 时间：2012-06-10T00:43:43.023
> 
> 标签：c++, windows, openssl

我有一个要向其发送数据的阻塞 SSL BIO 对象。问题是远程端的连接已关闭，在我进行读取之前我无法找到它（BIO_write 不会返回错误）。但是，我在发送之前无法阅读，因为我不想阻止。最后，负责发送数据的代码和负责读取的代码是分开的，这意味着读取失败不能触发另一个发送。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:28:02.977

有两种“关闭”状态，称为“半关闭”状态。它们主要与套接字的一侧或另一侧是否将发送更多应用程序数据有关。当您的`recv`调用返回 0 时，它实际上是在通知您没有更多数据要接收。但是，仍然可以发送数据，除非`send`调用发出某种其他类型的错误信号，例如`EPIPE`or `ECONNRESET`（我不确定这些 windows 等价物对于 winsock 是什么，但我知道它们在那里）。如果`SSL_write`没有返回错误，那是因为套接字的另一端仍在接受数据。

该`recv`调用允许对“没有更多数据”状态进行非阻塞检查，可以这样完成：

```
char c;
int r = recv(sock, &c, 1, MSG_DONTWAIT|MSG_PEEK); 
```

如果`r`是`0`，则套接字已收到指示，表明另一端没有更多数据未决。否则，调用将返回`1`一个字节的数据（由于 ，它仍在输入缓冲区中`MSG_PEEK`），或者`-1`。如果`errno`是`EAGAIN`（可能是因为`MSG_DONTWAIT`），则没有错误。应参考任何其他`errno`值，但可能表明套接字处于无效状态，需要关闭。

在套接字关闭之前，OpenSSL 应用程序应该确保`SSL_shutdown`已返回 1。然后，在对象被销毁（带有）`close`之后发生套接字上的。这意味着，除非应用程序执行异常操作，否则使用 OpenSSL 的套接字的双方都应该看到返回，然后双方都可以安全地关闭连接。`SSL``SSL_free``SSL_shutdown``1`

如果要检查`SSL`上下文的关闭状态，可以使用`SSL_get_shutdown`，它将报告另一端是否已启动`SSL_shutdown`序列。

# accelerometer - 如何从加速度计数据中获得线性加速度

> ID：10965636
> 
> 赞同：3
> 
> 时间：2012-06-10T00:44:15.817
> 
> 标签：accelerometer, gyroscope

我正在使用 IMU（3 轴加速度计、3 轴陀螺仪、3 轴磁力计），我想从加速度计数据中获取线性加速度。我知道传感器融合以及使用陀螺仪数据（并获取方向）来获取重力矢量的能力，从而消除其对相应轴的影响。

我是否走在正确的道路上，如果可以的话，你能帮忙吗？

* * *

之后，我将对加速度进行两次积分以获得如下位置

```
 CurrentAcceleration[0] = e.Accelerometer[0];
        CurrentAcceleration[1] = e.Accelerometer[1];
        CurrentAcceleration[2] = e.Accelerometer[2];

        //we need to get the linear acceleration instead of the read data !!

        CurrentVelocity[0] += (CurrentAcceleration[0] + PreviousAcceleration[0]) / 2;
        CurrentVelocity[1] += (CurrentAcceleration[1] + PreviousAcceleration[1]) / 2;
        CurrentVelocity[2] += (CurrentAcceleration[2] + PreviousAcceleration[2]) / 2;

        Position[0] += (CurrentVelocity[0] + PreviousVelocity[0]) / 2 ;
        Position[1] += (CurrentVelocity[1] + PreviousVelocity[1]) / 2 ;
        Position[2] += (CurrentVelocity[2] + PreviousVelocity[2]) / 2 ;

        PreviousAcceleration[0] = CurrentAcceleration[0];
        PreviousAcceleration[1] = CurrentAcceleration[1];
        PreviousAcceleration[2] = CurrentAcceleration[2];

        PreviousVelocity[0] = CurrentVelocity[0];
        PreviousVelocity[1] = CurrentVelocity[1];
        PreviousVelocity[2] = CurrentVelocity[2]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T09:10:34.517

[不会工作。](https://stackoverflow.com/a/7835988/341970)

您无法获得准确的位置甚至速度。在上面的链接中，您可以找到实际可以做的提示。

顺便说一句，这个问题[经常出人意料地出现](https://stackoverflow.com/a/6648664/341970)。

# objective-c - 基于页面的故事板不解除分配

> ID：10965637
> 
> 赞同：1
> 
> 时间：2012-06-10T00:45:08.093
> 
> 标签：objective-c, uiviewcontroller, storyboard, uipageviewcontroller, imagenamed

我正在使用模板“基于页面的故事板”开发一个完整的应用程序。

但是每当我翻页时，我通过仪器看到分配的内存量只会增加而不会减少，所以直到发生崩溃。

也尝试在 iPad 设备崩溃中。

为了简化并尝试找到问题，我使用相同的模板创建了一个测试应用程序并选择了 ARC，只加载我使用的页面的图像，并且没有更改原始苹果代码中的任何内容，即使在这个简单的应用程序中问题发生。

我认为问题是因为所有页面都像这个问题一样保持分配 [PageViewController: How to release ViewControllers added to it？](https://stackoverflow.com/questions/7934348/pageviewcontroller-how-to-release-viewcontrollers-added-to-it)

但我正在使用情节提要，所以，在哪里： `PageView *pView = [[PageView alloc] init];`

我有： `MWViewController *dataViewController = [storyboard instantiateViewControllerWithIdentifier:@"MWDataViewController"]`

我尝试放自动释放但没有效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-07T20:04:48.190

我遇到的问题是我在所有页面中都使用了背景图像，并且该`imageNamed:`方法缓存了图像，这使我的内存占用增加了。我使用了这种`UIImage initWithContentsOfFile:`方法，我的脚印基本保持不变。

# javascript - haxe 中的错误和其他奇怪的东西

> ID：10965642
> 
> 赞同：0
> 
> 时间：2012-06-10T00:46:39.073
> 
> 标签：javascript, html, haxe

我从 TouchMyPixel 下载了一个项目，当我尝试使用 FlashDevelop + haxe 运行它时，出现以下错误：

`"this target doesn't have an associated external IDE"`

当资源太少时，很难学习 haxe，而且答案......除此之外，还有没有人有关于 html5/js + box2d + haxe 的良好学习资源？像我这样的菜鸟可以使用示例代码或快速介绍吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T01:54:16.377

就像 Waneck 说的那样，我刚刚做了一个新项目，并且成功了。

# ruby - RDiscount :generate_toc 与 Sinatra

> ID：10965644
> 
> 赞同：2
> 
> 时间：2012-06-10T00:48:26.117
> 
> 标签：ruby, sinatra, markdown, tilt, rdiscount

因此，我使用 Rdiscount 设置了 sinatra，以呈现具有 HAML 布局的降价文件。这一切都有效，但我希望 RDiscount 根据我的 haml 文件中的标题生成目录。我已经尝试在 sinatra 配置中设置它。

```
set :markdown, :generate_toc => true 
```

但这似乎不起作用。

当我像这样渲染降价时，我也尝试过这样做：

```
markdown :PAGENAMEHERE, :layout => :'layouts/PAGENAMEHERE', :generate_toc => true 
```

这也行不通。

这甚至可能吗？如果是，我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T12:21:21.423

这应该有效：

```
get '/' do
  text = File.read('README.md')
  markdown = RDiscount.new(text, :generate_toc)
  body = markdown.to_html
  haml :home, :layout => true, :locals => {:body => body}
end 
```

您可以通过 RDiscount 直接创建正文，并将其作为纯 HTML 包含在您的 HAML 布局中。无论什么阻止创建目录，都应该以这种方式本机工作。我通过[https://github.com/mjijackson/markdown/blob/master/app.rb找到了解决方案](https://github.com/mjijackson/markdown/blob/master/app.rb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T20:05:49.757

虽然@three 的回答对我有很大帮助，但我想展示一个可能更通用的解决方案：

```
class MDWithTOC < ::Tilt::RDiscountTemplate
  def flags
    [:generate_toc]
  end
end

Tilt.register MDWithTOC, 'md' 
```

在这里，我们重写了 RDiscount Tilt 模板处理程序的 flags 方法，并将其重新设置为`md`格式的处理程序。

现在您可以`md`像往常一样使用帮助程序，它将生成 TOC。

# c# - 将 FileStream 传递给 IntPtr 缓冲区

> ID：10965645
> 
> 赞同：-1
> 
> 时间：2012-06-10T00:48:33.873
> 
> 标签：c#, file, filestream, intptr

我在尝试使用 IntPtr 直接从硬盘驱动器读取文件时遇到问题，目前我正在通过首先使用 FileStream 将其传递给字节数组，然后将字节数组复制到 IntPtr 来读取它。但是这种方法在处理大文件时会导致溢出。这就是为什么我现在尝试使用 IntPtr 从硬盘驱动器直接读取文件，但我还没有找到一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:00:30.883

An`IntPtr`只是一个指针，因此它不能包含数据本身，必须有一个缓冲区来包含实际数据。

因此，使用一种缓冲区而不是另一种缓冲区并不能解决您的问题。如果您的文件不适合内存，那么您只需将其处理成更小的部分。

# jquery - 如何选择具有特定属性名称的元素，然后选择其次要属性

> ID：10965646
> 
> 赞同：0
> 
> 时间：2012-06-10T00:48:35.480
> 
> 标签：jquery, xml

我有这个 xml 提要，如下所示：

```
<GSP VER="3.2">
    <TM>0</TM>
    <Q>blue&blue</Q>
    <PARAM name="output" value="xml_no_dtd" original_value="xml_no_dtd"/> 
    <PARAM name="q" value="blue&blue" original_value="blue%26blue"/>
</GSP> 
```

然后我有以下 jquery 来迭代这个 xml 提要：

```
var queryresults = $(data).find("GSP").find("PARAM[q]");
var query = "";

$(queryresults).each(function() {
    query = $(this).attr('original_value').text();
    alert(query);
}); 
```

但是我似乎没有得到回报，您如何选择具有特定属性的特定元素，然后选择辅助属性。例如

选择`"<PARAM>"`WITH 属性 =`"name"`并检索值 =`"original_value"`

结果：

```
query=blue%26blue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T00:53:12.787

我不确定`query=`您的预期输出部分应该来自哪里，但除此之外，`blue%26blue`从上面检索字符串：

```
var originalValue = $('param[name="q"]').attr('original_value'); 
```

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [属性等于选择器](http://api.jquery.com/attribute-equals-selector/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T00:55:34.923

按多个属性选择：

`$('param[name="whatever"][value="whatever2"]')`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T00:58:36.450

将您的代码调整为如下所示：

```
var queryresults = $(data).find("GSP").find("PARAM[name=q]");
var query = "";

$(queryresults).each(function() {
    query = $(this).attr('value');
    alert(query);
}); 
```

您尝试对 .text() 函数执行的操作不是必需的，因为 .attr() 函数已经返回该属性的值。

此外，为了根据名称查找元素，您可以使用以下内容：

```
$("PARAM[name=q]") 
```

这也适用于其他属性。

有用的阅读：[http ://api.jquery.com/attribute-equals-selector/](http://api.jquery.com/attribute-equals-selector/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T01:03:48.283

试试这个：

```
var queryresults = $("GSP").find("PARAM[name='q']"); // try it using "data"
var query = "";
$(queryresults).each(function() {
  query = $(this).attr('original_value');
  alert(query)
}); 
```

[http://jsfiddle.net/jHtg4/](http://jsfiddle.net/jHtg4/)

# asp.net - ASP.NET MVC 3：jQuery $.get(url, data, callback, type)

> ID：10965651
> 
> 赞同：0
> 
> 时间：2012-06-10T00:49:22.357
> 
> 标签：asp.net, asp.net-mvc-3, jquery

我正在尝试根据另一个选择列表中的选择动态更新选择列表。jQuery 代码

```
<script type="text/javascript">
    // Respond to Category selection
    $('#selectCategory').change(function () {
        // Ajax call to 'Specialties' action method with parameter searchType
        $.get('@Url.Action("Products", "Product")',
                { "parameter1": $(this).val(), "parameter2": null }, 
                function (data) {
                    $('#products').html(data); 
            });
    });
</script> 
```

风景

```
 <div id="products">
        @Html.Partial("_Products")
   </div> 
```

局部视图

```
@model MyMVC3App.Models.MyViewModel

<select mid="productSelect" name="@ClarusConstants.PropertyNames.Specialty" > 
    <option value="0">@Resources.LabelText_SelectASpecialty</option>
        foreach (Product p in Model.Products)
        {
        <option value="@Product.ID" name="@product.Description</option> 
        }
</select> 
```

动作方法

```
public ActionResult Specialties(string parameter1, string parameter2)
{
    List<Product> products = myDB.Products.Where(p => p.Category == parameter1).ToList();
    ViewModel myViewModel = new ViewModel();

    viewModel.Products = products;

    if (Request.IsAjaxRequest())
    {
        return PartialView("_Products", myViewModel);
    }
    else
    {
        return View(myViewModel);
    } 
} 
```

回调正在命中正确的操作方法，并且正在检测 ajax 请求。不幸的是，产品 div 的内容（InnnerHTML）没有被替换，所以这一切都是徒劳的。

预先感谢您的帮助。

# content-type - AFNetworking 预期的内容类型“application/xml”、“text/xml”、text/plain

> ID：10965654
> 
> 赞同：0
> 
> 时间：2012-06-10T00:50:21.293
> 
> 标签：content-type, afnetworking

我正在尝试使用 AfNetworking AfHttpClient 登录谷歌阅读器，但我收到了这个错误，我似乎无法弄清楚。

下面是我的 AFNetworking 子类：

```
// main url endpoints
#define GOOGLE_ACCOUNTS_BASE_URL @"https://www.google.com/accounts/"

@implementation ADPGoogleLoginClient

+ (ADPGoogleLoginClient *)sharedClient {
    static ADPGoogleLoginClient *_sharedClient = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        _sharedClient = [[ADPGoogleLoginClient alloc] initWithBaseURL:[NSURL     URLWithString:GOOGLE_ACCOUNTS_BASE_URL]];
    });

    return _sharedClient;
}

- (id)initWithBaseURL:(NSURL *)url {
    self = [super initWithBaseURL:url];
    if (!self) {
        return nil;
    }

    [self registerHTTPOperationClass:[AFXMLRequestOperation class]];

    // Accept HTTP Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1
    [self setDefaultHeader:@"Content-type" value:@"text/plain"];
    [self setDefaultHeader:@"Accept" value:@"text/plain"];

    return self;
}

@end 
```

然后我尝试使用以下代码形成请求：

```
//set up request params
    NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                            @"googlereader-ios-client", @"client",
                            [keychainCredentials objectForKey:(__bridge id)kSecAttrAccount], @"Email",
                            [keychainCredentials objectForKey:(__bridge id)kSecValueData], @"Passwd",
                            @"reader", @"service",
                            @"ipad", @"source", nil];

    //make requests
    [[ADPGoogleLoginClient sharedClient] getPath:@"ClientLogin" 
                                      parameters:params
                                         success:^(AFHTTPRequestOperation *operation , id responseObject)
     {
         //parse out token and store in keychain
         NSString* responseString = [operation responseString];  
         NSString* authToken = [[[responseString componentsSeparatedByString:@"\n"] objectAtIndex:2] 
                                stringByReplacingOccurrencesOfString:@"Auth=" withString:@""];

         keychainToken = [[KeychainItemWrapper alloc] initWithIdentifier:@"GReaderToken" accessGroup:nil]; 
         [keychainToken setObject:authToken forKey:(__bridge id)kSecValueData]; 

         loginSuccess();

     } 
           failure:^(AFHTTPRequestOperation *operation, NSError *error) 
     {
         NSLog(@"There was an error logging into Reader - %@", [error localizedDescription]);

         loginFailure(error);
     }]; 
```

我将默认标题设置为

```
[self setDefaultHeader:@"Content-type" value:@"text/plain"];
    [self setDefaultHeader:@"Accept" value:@"text/plain"]; 
```

所以我不确定为什么它仍然认为它正在期待 xml？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T15:01:17.930

您正在`Content-Type`为请求设置标头，但您看到的错误来自响应。为了使请求被认为是“成功的”，内容类型需要与预期相匹配（以避免在预期 XML 时尝试解析 JSON 响应）。

在同一个错误代码中，它应该提到它实际返回的内容类型。如果它确实是 XML，添加 using `AFXMLRequestOperation +addAcceptableContentTypes:`，一切都应该正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:57:23.847

嗨，马特，所以我刚刚开始测试这个。看起来我注册了错误的 AF 操作。我变了

```
[self registerHTTPOperationClass:[AFXMLRequestOperation class]]; 
```

至

```
[self registerHTTPOperationClass:[AFHTTPRequestOperation class]]; 
```

一切都很好！

# javascript - 在位于我的页面上的 iframe 上使用鼠标悬停绑定事件，其中 src 包含

> ID：10965657
> 
> 赞同：1
> 
> 时间：2012-06-10T00:50:30.907
> 
> 标签：javascript, jquery

我的页面上有一些第三方 iframe，`mousesover`只有当这些 iframe 的 src 在 src 文本中的任何位置包含 twitter 或 facebook 时，我才想在用户捕获它们。由于我无法捕获点击（我可以使用他们的自定义方法，我想保持代码完全独立）。我想捕捉用户何时将鼠标移入 iframe（位于我的页面上，不是由他们引入的）。iframe 的“SRC”在我的站点之外，但实际调用在我的页面中。有任何想法吗？

翼：

```
var _self = this;
$("iframe src").filter('/facebook|twitter/')
    .mouseover(function(event){
    event.stopPropagation();
    _self.somemethodcall();
}); 
```

或类似的东西：

```
var _self = this;
$('iframe').filter(function() {
    return $(this).attr('src').match(/facebook|twitter/);
}).bind("mouseover", function(event) {
    event.stopPropagation();
    _self.somemethodcall();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:27:45.230

它看起来像这样：

```
var a = /facebook|twitter/;

$('iframe').live('mouseover', 
  function () {
      if(a.test($(this).attr('src'))){
             alert('Found it!');
      }
  }  
);​ 
```

首先，我们将正则表达式放入名为`a`. 然后在悬停 iframe 时，我们测试正`src`则表达式的 ，如果 的值包含或`iframe`，它将返回 true 。`src``facebook``twitter`

一个工作示例： http: [//jsfiddle.net/2PZ2c/](http://jsfiddle.net/2PZ2c/) （第三个是带有 google.com 源的那个）

**可读性：**

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

[http://www.w3schools.com/jsref/jsref_regexp_test.asp](http://www.w3schools.com/jsref/jsref_regexp_test.asp)

**边注：**

此解决方案也适用于其他处理程序，如`mouseenter`,`mouseleave`等。

**编辑**：

我已经编辑了我的代码以使用 .live() 函数。此函数会将事件处理程序附加到两个当前元素作为未来元素。

示例：http: [//jsfiddle.net/2PZ2c/1/](http://jsfiddle.net/2PZ2c/1/)

来源：[http ://api.jquery.com/live/](http://api.jquery.com/live/)

# windows - 使用 DirectWrite 缩放文本

> ID：10965658
> 
> 赞同：0
> 
> 时间：2012-06-10T00:50:35.680
> 
> 标签：windows, directx, zooming, direct2d, directwrite

有谁知道如何使用 DirectWrite/Direct2D API 实现文本缩放？我需要平滑的高精度放大/缩小大量文本，但找不到任何演示/示例。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:59:26.660

只需在`ID2D1RenderTarget`.

# asp.net - 用于 ASP.net 的基于 Web 的 NUnit 测试运行程序？

> ID：10965660
> 
> 赞同：2
> 
> 时间：2012-06-10T00:51:21.370
> 
> 标签：asp.net, nunit, test-runner

是否有任何基于网络的测试运行器？从网站运行网站的单元测试？

* * *

我知道这违反了某些人的教条，但我希望能够[从我正在测试的产品内部运行单元测试](http://notgartner.wordpress.com/2006/02/16/shipping-unit-tests-with-application-code/)。无论是来自[本机 Win32 可执行文件](http://dunit.sourceforge.net/)，还是来自[.NET 可执行文件](https://stackoverflow.com/questions/8017995/unittesting-in-vs2010-how-to-ship-unit-tests-and-test-runner-in-the-executable)。

一个人已经为[UnitTest++编写](http://sourceforge.net/projects/unittest-cpp/)[了一个基于 Web 的 AJAX 测试](http://syncor.blogspot.ca/2010/02/adding-graphical-test-runner-for.html)运行器。

过去我不得不拆开 NUnit，所以我可以测试嵌入在可执行文件中，而不必发送 NUnit dll。这要求我还为 Windows/WinForms 编写自己的图形测试运行程序。

有没有人已经完成了为 ASP.net 创建可运行单元测试的工作？

* * *

**注意**：人们通常的反应是：*“单元测试不应该出现在最终产品中，并且在现场时绝对不能被测试人员、支持人员或开发人员访问。”*

* * *

**注意**：您可能不同意我运行单元测试的愿望，但不要让这影响您的答案。如果没有针对 ASP.net 的基于 Web 的 nunit 测试运行器，那么这就是答案。不要害怕**回答这个问题**。我不会咬人的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:47:27.887

我认为你想做这种事情的原因是因为缺少[持续集成服务器](http://martinfowler.com/articles/continuousIntegration.html)，我想不出另一个理由，所以不要试图通过这样做来*修补你的设计*，如果你评估一下它会更干净CI服务器的实现（这并不难，例如你可以看看：[NCastor](https://github.com/jupaol/NCastor)）

因此，在我看来，您需要设置一个持续集成服务器，以便在您的自动化构建过程中自动运行单元测试和集成测试。

**只有**在构建过程和测试有效时，您才会将应用程序部署到下一个“阶段” ，您还可以配置 CI 服务器以执行：

*   运行测试
*   运行静态分析
*   运行非静态分析
*   生成测试报告
*   使用测试覆盖率运行测试
*   计算和设置应用程序版本
*   创建应用程序的包
*   根据目标阶段修改配置文件
*   缩小你的脚本
*   构建失败时发送电子邮件

除其他外

正如您所提到的，您不需要将测试部署到您的生产服务器

我强烈建议您阅读下一篇文章：

[http://misko.hevery.com/2008/07/16/top-10-things-i-do-on-every-project/](http://misko.hevery.com/2008/07/16/top-10-things-i-do-on-every-project/)

这是一些 CI 服务器的列表

*   [Jenkins](http://jenkins-ci.org/) - 自由和简单的配置
*   [Hudson](http://hudson-ci.org/) - 自由和简单的配置
*   [TeamCity](http://www.jetbrains.com/teamcity/) - 开源项目免费
*   [巡航控制](http://www.cruisecontrolnet.org/)- 免费（但是，由于只能通过 XML 文件进行配置，所以它的受欢迎程度有所下降，这很烦人......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:16:42.357

在 github 上找到**NUnitWebRunner** [https://github.com/tonyx/NUnitWebRunner](https://github.com/tonyx/NUnitWebRunner)

# css - 在 CSS 中使用 z-index 分层图像的问题

> ID：10965664
> 
> 赞同：1
> 
> 时间：2012-06-10T00:52:14.283
> 
> 标签：css, z-index

嗨，只是想看看是否有人可以帮助我解决一个小问题。

我正在尝试使用`z-index`in css 对图像进行分层，但由于某种原因，即使我已经为我想要的 div 提供了更高的索引值，但我想要在下面的图层不断向下推或覆盖我想要在上面的图层：

```
#work-img {
    background: url(../images/blots2.png) no-repeat scroll left top transparent;
    width: 960px;
    height: 601px;
    position: absolute;
    top: 610px;
    left: 0;
    visibility: visible;
    z-index: 6;
    display:block;
 }

 #work {
    background: url(../images/my-work.png) no-repeat scroll 0 0 transparent;
    position: absolute;
    width:337px;
    height: 35px;
    left: 35px;
    top: 660px;
    visibility: visible;
    z-index: 700;
    display:block;
 } 
```

不知道我做错了什么，所以任何人都可以给我的任何输入将非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:08:49.133

我看不出你的css有问题。我在这里做了一个简单的例子，使用与你相同的属性工作得很好。

这些 div 不是继承了另一个元素的某些属性吗？你可以看到使用萤火虫。

# php - 显示从 shell_exec 获取的输出并实时显示，而不是等待 5-7 分钟

> ID：10965667
> 
> 赞同：2
> 
> 时间：2012-06-10T00:53:16.457
> 
> 标签：php, flush, shell-exec, real-time-data

现在，我的代码如下。

```
$output = shell_exec( !-- unix commands are here --! );
echo $output; 
```

我有一个网站，在单击特定按钮后，会输出 shell 脚本并显示在浏览器上。这是完美的工作。唯一的问题是在完成之前我看不到输出发生了什么。我必须等待大约 5-7 分钟，然后我看到大约一百行输出。我试图在输出执行时将输出推送到浏览器——我希望能够看到输出实时发生（在浏览器上）。

我尝试使用`popen`, `proc_open`, `flush()`,`ob_start`等。似乎没有任何效果。我只是尝试打开一个文本文件，将输出的内容写入文本文件，然后循环读取文本文件。我是 php 初学者，所以我可能没有正确使用上述任何方法。

完成此任务的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:25:52.963

因为 PHP 在阻塞模式下运行 exec、system、pass_thru 等，所以您的可能性非常有限。PHP 将要求代码在继续执行整个脚本之前完成执行，除非您执行类似将以下内容添加到命令中的操作：

```
"> /dev/null 2>/dev/null &" 
```

当然，这将停止您的命令的输出，但是.. 可能是这样的：

```
exec('command > /cmd_file 2>/cmd_file &');

$file = fopen('/cmd_file', 'r');
while (!feof($file)) {
    echo fgets($file);
    sleep(1);
}

fclose($file); 
```

值得一试。

# java - 对象未存储在 Google App Engine 数据存储区中

> ID：10965670
> 
> 赞同：0
> 
> 时间：2012-06-10T00:53:57.880
> 
> 标签：java, google-app-engine, google-cloud-datastore

我在数据存储中存储对象时遇到问题。我有一个我正在尝试存储的对象 MyObject，但是当代码执行时没有任何反应。我去查看数据存储仪表板，但 MyObject 不存在。没有异常被抛出，也没有错误。

这是我的对象

```
@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class MyObject{

@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
private Key key;

@Persistent
String name;

@Persistent
String beta;

@Persistent
double loc;

public MyObject(String name1){
    name = name1;
}

//getters and setters
} 
```

这是存储对象的代码

```
public static void saveMyObject(MyObject a)throws Exception{
    PersistenceManager pm = PMF.get().getPersistenceManager();
    try{
        pm.makePersistent(a);
    }
    catch(Exception e){
        throw e;
    }
    finally{
        pm.close();
    }
} 
```

谁能看到我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T11:09:24.143

看起来您正在使用 JDO，因此您可能想要添加`JDO`标签或在某处提及...。

我会替换

```
try
{
  pm.makePersistent(a);
} 
```

和

```
try
{
  MyObject myObj = new MyObject(a.getName());    // or whatever the getter is
  myObj.setField2(a.getField2());                // Copy 1 data member from a
  ...                                            // Make a MyObject.copy(...) method?
  pm.makePersistent(myObj);
} 
```

关键是 JDO 使用增强：在 Java 主编译之后插入的魔术字节码。我在增强的生命周期（“范围”）内操作我的持久实体对象，以使 JDO 工作。

我还使用事务进行写作（我不知道您的 JDO 自动事务设置）。在创建和持久化新的持久实体时，我总是使用事务。如果上述更改不起作用，您可能想尝试一下。

# c# - C# Eval 函数中的内存不足异常

> ID：10965673
> 
> 赞同：0
> 
> 时间：2012-06-10T00:54:59.743
> 
> 标签：c#

> **可能重复：**
> [如何防止 CompileAssemblyFromSource 泄漏内存？](https://stackoverflow.com/questions/1799373/how-can-i-prevent-compileassemblyfromsource-from-leaking-memory)

我正在使用这个[http://www.codeproject.com/Articles/11939/Evaluate-C-Code-Eval-Function](http://www.codeproject.com/Articles/11939/Evaluate-C-Code-Eval-Function)示例来评估 ac# 表达式，该表达式将被评估数千次。

```
public static object Eval(string sCSCode) {
    CSharpCodeProvider c = new CSharpCodeProvider();
    ICodeCompiler icc = c.CreateCompiler();
    CompilerParameters cp = new CompilerParameters();

    cp.ReferencedAssemblies.Add("system.dll");
    cp.ReferencedAssemblies.Add("system.data.dll");

    StringBuilder sb = new StringBuilder("");
    sb.Append("using System;\n" );
    sb.Append("using System.Data;\n");
    sb.Append("namespace CSCodeEvaler{ \n");
    sb.Append("public class CSCodeEvaler{ \n");
    sb.Append("public object EvalCode(){\n");
    sb.Append("return "+sCSCode+"; \n");
    sb.Append("} \n");
    sb.Append("} \n");
    sb.Append("} \n");

    CompilerResults cr = icc.CompileAssemblyFromSource(cp, sb.ToString());

    if( cr.Errors.Count > 0 ){
        MessageBox.Show("ERROR: " + cr.Errors[0].ErrorText, "Error evaluating cs code", MessageBoxButtons.OK, MessageBoxIcon.Error );
        return null;
    }

    System.Reflection.Assembly a = cr.CompiledAssembly;
    object o = a.CreateInstance("CSCodeEvaler.CSCodeEvaler");

    Type t = o.GetType();
    MethodInfo mi = t.GetMethod("EvalCode");

    object s = mi.Invoke(o, null);
    return s;
} 
```

Eval 函数几乎（如上所述）运行数千次，以在 for each 循环中执行其表达式评估。但是一旦循环值达到 4000 它给了我

```
System.OutOfMemoryException occured in System.dll 
```

越过这条线

```
CompilerResults cr = icc.CompileAssemblyFromSource(cp, sb.ToString()); 
```

然后它一直给出这个异常，直到循环结束。我从任务管理器创建了一个转储文件，转储文件大小达到近 500MB，我使用**WinDbg**调试了转储文件但无法解决问题，因为我不是**WinDbg**的专家用户 所以无法弄清楚它为什么会发生？我不确定它的内存泄漏问题，内存没有被`StringBuilder`.

1.  创造`AppDomain`能解决问题吗？

2.  我应该使用`StringWriter`代替`StringBuilder`吗？

任何建议或帮助将不胜感激。

# ruby-on-rails - Ruby on Rails 应用程序中的 form_for

> ID：10965683
> 
> 赞同：0
> 
> 时间：2012-06-10T00:59:02.077
> 
> 标签：ruby-on-rails, ruby

我正在尝试创建一个用户可以创建的学校模型，其属性为：school_name（字符串）、：description（字符串）和：created_by_user（整数）。

用户应该只能访问和更改名称和描述参数，并且 created_by_user 字段应该自动设置为创建它的用户的 id#。

这是我的新学校表格：

```
<h1>Open a New School</h1>

<%= form_for(@school) do |f| %>
 <%= render 'shared/error_messages', :object => f.object %>
<%= render 'fields', :f => f %>
<div class="actions">
<%= f.submit "Create School!" %>
</div> 
```

这是“字段”部分

```
<div class="field">
  <%= f.label :school_name %><br />
  <%= f.text_field :school_name %>
</div>
<div class="field">
 <%= f.label :description %><br />
 <%= f.text_area :description, :size => "45x10" %>
 </div> 
```

我可以在“字段”部分或其他任何地方添加什么，以便当用户创建新学校时，他们的 ID 会自动设置为 created_by_user 值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:50:08.940

你会想在你的控制器中定义它，而不是你的视图。就像是：

```
class SchoolsController < ApplicationController

  def create
    @school = School.new(params[:school])
    @school.created_by_user = current_user
    if @school.save
      redirect_to @school, notice: "School Created"
    else
      render :new
    end
  end
end 
```

# javascript - 为什么 $(window).resize() 在此代码段中没有触发或返回错误？

> ID：10965685
> 
> 赞同：0
> 
> 时间：2012-06-10T00:59:27.590
> 
> 标签：javascript, jquery, variables

此代码完美运行，只是它跳过了整个`$(window).resize`区域。删除除一个变量外的所有变量似乎可以“修复它”，但这显然行不通。

我在这里错过了一个明显的问题吗？控制台中没有错误。如果您想选择它或查看完整的 javascript，这里有一个演示：http: [//jdsn.co/demo/reader.html](http://jdsn.co/demo/reader.html)

```
if( main_reader_height + offset_height > initviewport ) {
    $('.main_reader footer').waypoint(function(event, direction) {
        if (direction === 'down') {
            $('.nav_items, .nav_prev, .nav_next').addClass('snap');
            $(window).resize(function() {
                window.offset = $('.main_reader article').offset().top;
                window.viewport = $(window).height();
                window.main_height = $('.main_reader article').height();
                window.bottom_offset = window.viewport - window.offset - window.main_height - 80
                $('.nav_next').height(viewport - offset - bottom_offset - 80);  
            });
            $('.snap').height(window.bottom_offset)
        }
        else {
            $('.nav_items, .nav_prev, .nav_next').removeClass('snap');
        }
    }, {
      offset: '100%'  // middle of the page
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:08:22.743

我看到两个问题：

1.  .resize() 事件仅在航点的第一个回调之后被订阅。此外，每次收到航点事件时，都会为 .resize() 创建一个新订阅者，这可能会导致问题。
2.  您`window.`在定义这些变量时使用的任何真正原因？这会将它们附加到主窗口对象，这实际上是不需要的，并且可能会导致其他问题。

从那里开始，这取决于您期望的行为。查看代码并不能完全传达您要完成的工作。对此的进一步了解可能会产生更多有用的答案。

# c - 在 Windows 上为 Haskell 构建 GD 库时出现 ld 错误

> ID：10965687
> 
> 赞同：0
> 
> 时间：2012-06-10T00:59:39.917
> 
> 标签：c, haskell, mingw, ld, ffi

在 Windows（使用 MinGW）上通过 cabal 安装 Haskell GD 包时，我收到以下警告：

```
Warning: resolving _gdImagePtrDestroyIfNotNull by linking to _gdImagePtrDestroyIfNotNull@4
Warning: resolving _gdImageCopyRotated90 by linking to _gdImageCopyRotated@36
Use --enable-stdcall-fixup to disable these warnings
Use --disable-stdcall-fixup to disable these fixups 
```

请注意，这些正是 gd-extras 中定义的函数。
然后，当实际编译一个使用 gd 的 Haskell 程序时，我得到以下错误：

```
Linking Main.exe ...
[...]\cabal\gd-3000.7.3\ghc-7.4.1/libHSgd-3000.7.3.a(Internal.o):fake:(.text+0x2211):undefined reference to 'gdImageCopyRotated90'
[...]\cabal\gd-3000.7.3\ghc-7.4.1/libHSgd-3000.7.3.a(Internal.o):fake:(.text+0x500a):undefined reference to 'gdImagePtrDestroyIfNotNull'
[...]
collect2: ld returned 1 exit status 
```

我无法弄清楚如何解决这个问题——我已经花了很长时间才达到这一点，因为我在试图让它工作时遇到了很多问题，但这似乎是最后的障碍。我已经尝试启用/禁用 stdcall 修复，并更改这些函数在哪个文件中定义（因为 gd-extras 似乎是一个潜在问题），但这并没有解决问题。
谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T01:19:16.637

您需要将显式链接器标志传递给 ghc，指向库。Haskell GD 库是自动链接的，但是除非您告诉 ghc，否则 dll 也不会被链接。stdcall-fixup 错误在这里是一个红鲱鱼。

# python - 无法在 Mac OSX 上安装 py2cairo

> ID：10965692
> 
> 赞同：6
> 
> 时间：2012-06-10T01:01:29.120
> 
> 标签：python, macos, homebrew, waf

我正在尝试使用 brew 在 python 2.7.3 的框架构建（Mac OSX Lion）上安装 py2cairo。到目前为止，我一直没有成功。

首先，我尝试了一个简单的

```
brew install py2cairo 
```

这似乎只适用于 python 的非框架构建。当我在我的框架上执行此操作时，一旦我导入带有不兼容二进制错误的 cairo，就会生成 python 错误。

其次，我尝试通过从 github 获取并发布：

```
python waf configure 
```

这失败了：

```
Checking for library python2.7           : not found 
Checking for library python2.7           : not found 
Checking for library python2.7           : not found 
Checking for library python27            : not found 
Checking for program python2.7-config    : /usr/local/Cellar/python/2.7.3/bin/python2.7-   config 
Checking for header Python.h             : Could not find the python development headers 
The configuration failed
(complete log in /Users/tobin/tmp/py2cairo/build_directory/config.log) 
```

我已经尝试了所有方法：[How to install PyCairo 1.10 on Mac OSX with default python](https://stackoverflow.com/questions/6886578/how-to-install-pycairo-1-10-on-mac-osx-with-default-python)，但这些都没有帮助。

在我看来，这可能无法找到 python2.7 库和头文件，因为它是一个框架构建。那可能吗？我正在查看 brew 公式，似乎框架构建在构建时没有设置 --enable-share 。我不确定这在这里是否相关——但也许是一种可能性。

任何其他见解都会很棒。提前致谢。

## 更新：

我发现无法构建 py2cairo 与 gcc 使用“-march=native”标志有关。Mac OSX 上的 gcc (4.2.1) 有这个问题。然后我重新安装了 gcc 和 python。之后，当使用 waf 构建 py2cairo 时，它得到了“-march=core2”并且一切都构建了。

不幸的是，并非一切都很好。当我从 brew 版本（如上所述）获得的构建中导入 cairo 时，我得到了同样的错误。确切的错误信息是：

```
>>> import cairo
Fatal Python error: Interpreter not initialized (version mismatch?)
Abort trap: 6 
```

然后python退出。

现在看来，这个问题与 python 的框架构建有关。我在没有构建框架的情况下对其进行了测试，并且效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:51:21.980

为了不让这个问题悬而未决......我想跟进我的解决方案和学习点：

1.  如上所述，我的 OSX 版本和一个名为 -march=native 的 gcc 编译标志不兼容。在以后的版本中，它以 -march=core2 的形式出现。在清理我的机器后，这几乎可以通过编译器/版本更改自行修复。

2.  多年来，我的所有各种 MAC OSX 安装都一团糟——并且接受了“迁移选项”。两台机器前 - 我安装了 2.4 和 2.5 版本的 python 二进制文件，然后由于各种原因最终去了 macports。然后最终去了自制。当我去自制软件时，我尝试用手清理东西（但这当然可能具有挑战性）。更糟糕的是——在过去的 6 年中，每次我获得一台新的 mac（2 次）时，我都会选择“迁移安装”选项，这会推动混乱并使其变得更糟。因此，当我开始进一步研究时——我安装了各种不同版本的 python——mac-native、python-native、mac 端口、自制程序，甚至可能还有其他版本。

我终于通过手动删除一堆旧的 python 安装解决了这个问题，然后重新开始使用新的 virtualenv 和 python 2.7 的 homebrew 安装。

警告：我认为这不是最聪明的方法。我小心翼翼地没有删除我认为 OSX Lion 自带的 Python 版本（我认为它是 2.6）——但目前尚不清楚它可能如何影响可能依赖于较旧的 mac 安装的 python 的其他一些事情。我最终删除了一个 2.3、一个 2.4 和两个不同的 2.5 - 以及某些地方的各种链接。真是一团糟！除非您完全确定自己在做什么（我不是），否则我不会建议这种方法。我基本上是想杀死已经收集了 6 年的 python install crud。

为了安全起见，我可能应该从安装新的 OSX Lion 开始，然后添加我的自制版本并从那里开始。我可能会在不久的将来这样做。

# jquery - 切换显示隐藏 DIV 单击图像保持 DIV 打开关闭单击正文/文档

> ID：10965694
> 
> 赞同：1
> 
> 时间：2012-06-10T01:02:05.487
> 
> 标签：jquery, jquery-ui, jquery-plugins, jquery-selectors

```
<HTML>
    <BODY> 
        <table id="header-table">
            <tr>
                <td id="globalSearchCell" class="last-child" style="padding-bottom: 0.5em; vertical-align: bottom;">
                    <input class="search-submit-button" id="global-search-submit-button1" type="image" src="image goes here" />           
                </td>
            </tr>
        </table>

        <div id="ShowGlobalSearchTable" style="text-align :right; float:right; display:none;margin-right: 10px">
            <table class="search-box">
                <tr>
                    <td class="search-text-input-container">
                        <input class="search-text-input" id="global-search-criteria" name="criteria" type="text"  maxlength="100"/>
                    </td>
                    <td>
                        <input class="search-submit-button" id="global-search-submit-button" type="image" src="image URL comes here" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="global-search-popup" class="popup-panel">
                            <img id="global-search-progress" src="image url comes here" style="width:16px; height:16px" />
                            <div id="global-search-popup-content" style="text-align:left;"></div>
                        </div>      
                    </td>     
                </tr>    
            </table>                                       
        </div>
    </BODY>
</HTML> 
```

单击图像时`id : global-search-submit-button1`，我需要能够切换（显示/隐藏）DIV`id="ShowGlobalSearchTable"`

单击 DIV 内的任何位置时，`ID : "ShowGlobalSearchTable"`不应关闭此 DIV。

单击主体上的任意位置应关闭 DIV。但是单击图像`Id : "global-search-button1"`应该使用 切换 DIV `ID = "ShowGlobalSearchTable"`。

我在下面使用 Jquery 尝试了以下 javascript，但它不起作用，您能否建议对下面的 Jquery 代码进行更改：

```
$(function () {             
    $('#global-search-submit-button1').click(function () {              
        $('#ShowGlobalSearchTable').toggle();               
    }                   
    $(document).mouseup(function (event) {              
        var target = $(event.target);               
         if (target != $("#global-search-criteria").get(0) && target != $("#global-search-submit-button").get(0) && target != $("#ShowGlobalSearchTable").get(0) && target != $(".search-text-input-container").get(0)) {                            
             $('#ShowGlobalSearchTable').css("display","none");                          
         }                   
    });     
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:36:08.687

演示：http: [//jsfiddle.net/lucuma/ed6q2/2/](http://jsfiddle.net/lucuma/ed6q2/2/)

```
 $(document).ready(function(event) {
    $('#global-search-submit-button1').click(function(event) {
        event.stopPropagation();
        $('#ShowGlobalSearchTable').toggle();
    });

    $(document).click(function(event) {
        var container = $("#ShowGlobalSearchTable");
        var btn = $("#global-search-submit-button1");

        if (container.has(event.target).length === 0 && btn.has(event.target).length === 0) {
            container.hide();
        }

    });
});​ 
```

# winforms - 在 Winforms 中使用 Adob e Flash/AIR VOIP

> ID：10965695
> 
> 赞同：0
> 
> 时间：2012-06-10T01:02:15.270
> 
> 标签：winforms, air, flash, voip

由于还没有答案，我将重写这个问题以期得到答案（我不介意讨论，但我知道 SO 是关于问答的）。似乎安全检查/提示使使用 Flash Player 变得不可行。考虑到这一点，问题仍然存在，但请根据使用 AIR 的经验来回答。

我有一个用 C# 编写的 Winforms 应用程序，我需要添加 VOIP。我真的很喜欢 Flash Player VOIP 解决方案的效果，AEC（回声消除）很棒。我知道他们使用 Speex，但即使使用 Speex，实施仍然需要大量工作，所以我想直接在我的应用程序中使用 Adob​​e 的解决方案。

有人做过吗？我会遇到什么问题？我能想到的几个：

AIR 和 Winforms 应用程序之间的 IPC。我认为这很简单，并且有几个选项，包括套接字/网络、文件 i/o，也许还有其他选项。

基于[此](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7d1d.html)

> 在 AIR 应用沙箱中运行的内容无需用户权限即可访问麦克风

我不认为安全警告会是一个问题？我还不确定沙盒是什么，但只要我的 AIR 应用程序可以在其中运行并且仍然与我的 winforms 应用程序对话，那么应该不是问题。

我假设 AIR 支持语音捕获，包括增强功能（AEC、NS、Speex 等）？

我可以运行任何在 AIR 中使用语音捕获的示例吗？

# mod-rewrite - .htaccess $_GET['p'] 不工作

> ID：10965696
> 
> 赞同：0
> 
> 时间：2012-06-10T01:02:32.377
> 
> 标签：mod-rewrite

有了这个 url `http://www.example.com/cp/pending/thepage`，我什么时候`$_GET['p'];`应该被`thepage`退回。什么都没有返回，我该如何解决这个问题？

这是mod重写。

```
RewriteRule ^cp/([A-Za-z0-9-]+)(&type=[A-Za-z0-9-]+)?(/[A-Za-z0-9-]+)?(&to=[A-Za-z0-9-]+)?(&r=[A-Za-z0-9-]+)?(&g=[A-Za-z0-9-]+)?(&page=[A-Za-z0-9-]+)?/?$ /cp.php?o=$1&type=$2&c=$3&p=$4&r=$5&g=$6&page=$7 [L] 
```

这是php

```
$p = $_GET['p'];
echo $p; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:13:22.283

查询字符串不是 URL 的一部分。

您的代码应如下所示：

```
RewriteCond %{QUERY_STRING} RegexHere
RewriteRule URLRegexHere NewURL 
```

如果您使用 URL 的任何部分来创建新的查询字符串，则需要使用该`[QSA]`标志来附加其他参数。例如：

```
RewriteRule ^cp/pending/([^/])/?$ page.php?page=$1 [L,QSA] 
```

更多关于 Mod_Rewrite[的信息](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)。

此外，正如 $n 反向引用用于在 RewriteRule 正则表达式中匹配的模式一样，%n 反向引用用于在 RewriteCond 正则表达式中匹配的模式。

# css - twitter bootstrap btn-navbar 只显示一行

> ID：10965697
> 
> 赞同：1
> 
> 时间：2012-06-10T01:03:01.363
> 
> 标签：css, ruby-on-rails, twitter-bootstrap

我有以下导航栏崩溃：

```
<button type="button" class='btn btn-navbar' data-toggle='collapse' data-target='.nav-collapse'>
        <span class="icon-bar"/>
        <span class="icon-bar"/>
        <span class="icon-bar"/>
</button> 
```

但是，我在实际栏上只得到一行。有没有办法解决这个问题？![在此处输入图像描述](../Images/ff28e50a315fe038ca30e3933a31214f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T01:55:32.890

尝试：

```
<button type="button" class='btn btn-navbar' data-toggle='collapse' data-target='.nav-collapse'>
  <span class="icon-bar"></span>
  <span class="icon-bar"></span>
  <span class="icon-bar"></span>
</button> 
```

*span*标签不是单个标签。如果您没有正确关闭它，浏览器会将其解释为：

```
<span class="icon-bar">
  <span class="icon-bar">
    <span class="icon-bar"></span>
  </span>
</span> 
```

这就是为什么你只得到一个酒吧。

# java - java语音命令

> ID：10965698
> 
> 赞同：0
> 
> 时间：2012-06-10T01:03:04.530
> 
> 标签：java, nlp, awtrobot

我对 java 还是很陌生，我正在考虑制作一个程序，让计算机可以听你说话，并使用 java Robot 用文字或其他东西写下你所说的内容。老实说，我不知道从哪里开始，并且真的可以在这方面使用一些帮助。另外，我在我的电脑上环顾四周，发现它确实有某种语音引擎，有没有办法可以在我的程序中实现它？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:58:59.033

如果您想利用听写软件的功能并将它们连接到您的 Java 程序中，请先查看 JavaSpeech API 或 Microsoft Speech API 以及 Java Native Interface (JNI)。后者对于初学者来说不是一个简单的项目。前者，如果你的听写软件是兼容的，对于一个相对初学者来说可能需要几周的工作时间。

为了使听写的语音出现在 Word 或其他外部程序中，我不清楚您的 Java 程序在哪里适合：您的听写软件将本机提供听写任何当前活动窗口的功能，大概。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T15:39:56.097

语音识别是一个需要理解的复杂编程。因为你是一个初学者，所以去看看 Sphinx4 完全用 java 编写的识别和 FreeTTS 作为完全用 java 编写的 Synthesizer。首先制作一个更简单的识别器，然后您可以考虑使用 JNI 进行听写

# iphone - 带有 UITextViewDelegate 的 UIVIEW 子类

> ID：10965709
> 
> 赞同：1
> 
> 时间：2012-06-10T01:05:56.287
> 
> 标签：iphone, ios, xcode

我的视图控制器变得越来越复杂，所以我决定将一些控件组合在一起并子类化一个 uiview。在我的视图控制器中，我正在获取视图：

```
@property (strong, nonatomic) PostMenuCell *menuCell;
menuCell = [[PostMenuCell alloc] initWithFrame:CGRectMake(3,200,304,96) ];
menuCell.textView.delegate = self;
[self.view addSubview:menuCell]; 
```

它看起来很好。我有一个文本视图，并且正在使用 VC 中的委托，如下所示：

```
@interface PostPictureViewController : UIViewController <UITextViewDelegate> 
```

我正在尝试使用文本视图委托方法，例如：

```
- (void)textViewDidBeginEditing:(UITextView *)textView
-(BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range        replacementText:(NSString *)text 
```

单击文本区域时会弹出键盘，但未使用委托方法，因此我无法执行任何操作或关闭键盘。我以为 menuCell.textView.delegate = self; 会使文本视图委托 VC，但显然不是。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:48:31.950

在您设置其委托时检查 textview 是否不为零。

# glassfish - 如何使用 CDI 将本地无状态会话 bean 注入 JAX-RS 资源？

> ID：10965710
> 
> 赞同：3
> 
> 时间：2012-06-10T01:06:00.647
> 
> 标签：glassfish, jersey, java-ee-6, cdi, jboss-weld

我有一个`.ear`包含标准`lib`目录的文件。

我`.jar`在那个`lib`目录中有一个文件。它包含`UserInfoManager`，这是一个接口。它不包含（出于这些目的）其他类。它还包含一个`META-INF/beans.xml`文件。

我`.jar`在该`lib`目录中有另一个文件。它包含一个名为`UserInfoResource`JAX-RS 资源类的类。该类内部包含以下内容：

```
@Inject
private UserInfoManager userManager; 
```

接下来，我在`.jar`文件的根目录有一个 EJB`.ear`文件。它包含一个名为`UserManagerBean`实现`UserInfoManager`接口的类。这个类被注释了`@Stateless`，基本上没有其他注释（因此使它成为一个通过其本地业务接口（`UserInfoManager`）公开的本地无状态会话 bean。这个`.jar`文件也有一个`META-INF/beans.xml`文件。

接下来，我有一个`.war`文件，里面有一个`Application`类，没有别的。这充当`lib`目录中存在的部署时发现的任何和所有 JAX-RS 资源的“安装点”。我没有将此 Java EE 6 模块声明为 CDI bean 存档，因为它不包含 bean。

这种符合规范的安排在部署时失败。Weld（GlassFish 3.1.2 中的 CDI 实现）声称无法满足上面详述的注入点，因为没有`UserInfoManager`可用的已知实现。

当该注入点被注释时`@EJB`，一切正常。

如何让 CDI 将本地无状态会话 bean 引用注入到类路径中存在的 JAX-RS 资源中？

**更新：**因为无论我怎么看这似乎都违反了规范，我已经[提交了一个带有测试用例的错误](http://java.net/jira/browse/GLASSFISH-18793)。我鼓励读者看一看，看看他们是否可以让它发挥作用。

**更新：**解决方法是确保您的 JAX-RS 类*不是*bean 档案，而是*使用*`@ManagedBean`. 此外，作为挂载点的 {{.war}} 文件必须是一个 bean 归档文件（必须有一个 {{WEB-INF/beans.xml}} 文件）。这些要求的某些组合是违反 CDI 规范的。以下错误跟踪这些问题：http: [//java.net/jira/browse/GLASSFISH-18793](http://java.net/jira/browse/GLASSFISH-18793)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T15:54:58.377

Jersey 不会将 Resources 视为托管 bean，除非附加了显式范围/@ManagedBean 注释。因此，您需要使用 @ManagedBean 或 @RequestScoped 注释您的资源，以便注入工作。

似乎只有在资源 jar 文件中包含 beans.xml 时才会出现问题。当我删除它并将@ManagedBean 注释附加到资源类时（而不是@RequestScoped，因为如果没有beans.xml 存在@RequestScoped 不起作用），它就起作用了。我不是 CDI 专家，所以不确定这是设计的还是错误的。

# perl - 在perl中反转链表

> ID：10965712
> 
> 赞同：1
> 
> 时间：2012-06-10T01:06:26.413
> 
> 标签：perl, linked-list

所以我知道有数百个关于堆栈溢出的例子，事实上我已经使用了那里的所有信息 - 所以这就是我所拥有的

```
use strict;
use warnings;
use Data::Dumper;

my $head= undef;
my $tail=\$head;

open FILE, "<datastored.txt" or die $!;

while (<FILE>){
    my $node = {
                "data" => $_ , 
                "next" => undef
            };
    $$tail=$node; 
    $tail = \$node->{"next"}; 
};
print Dumper $head; #before reversing
$head = reverse_list($head);
print Dumper $head; #after reversing
sub reverse_list{
    my ($list) =@_[0];
    my $previous = undef;
    while ($list->{next}){
        $forward = $list->{next}; 
        $list->{next}= $previous; 
        $previous = $list; 
        $list=$forward; 
    };
    return $previous;   
}; 
```

这是我得到的输出

```
#this is the output before reversing (normal linked list)
$VAR1 = {
          'next' => {
                      'next' => {
                                  'next' => {
                                              'next' => undef,
                                              'data' => 'line 4
'
                                            },
                                  'data' => 'line 3
'
                                },
                      'data' => 'line 2
'
                    },
          'data' => 'line 1
'
        };
#this is the linked list after reversing (WITHOUT THE LAST DATA VARIABLE - "line 4")
$VAR1 = {
          'next' => {
                      'next' => {
                                  'next' => undef,
                                  'data' => 'line 1
'
                                },
                      'data' => 'line 2
'
                    },
          'data' => 'line 3
'
        }; 
```

注意 - 文件的内容`datastored.txt`很简单

```
line 1
line 2
line 3
line 4 
```

所以我的问题是数据“第 4 行”在哪里消失了，我应该改变什么才能真正反转链接列表而不会丢失任何价值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T01:16:48.990

您的反转子程序几乎是正确的。但是，由于您使用的条件，它会丢失最后一个条目（即，将其添加到最终的反向列表中）。你有两个选择：

1.  更改`while ($list->{next})`to`while ($list)`并使代码更惯用。

2.  `$list->{next}= $previous;`在循环结束后添加 a`while`以将最后剩余的节点添加回反向列表。（想想两个元素的列表，看看你的代码做了什么）。

# core-data - '未找到指定的持久存储。' 核心数据中的错误

> ID：10965713
> 
> 赞同：1
> 
> 时间：2012-06-10T01:07:05.180
> 
> 标签：core-data, migration, datamodel

我收到此错误：操作无法完成。（Cocoa 错误 134140。） ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“未找到指定的持久存储。”

我刚刚更改为我的数据模型的新版本。但是，如果我激活以前版本的数据模型，则该应用程序可以正常工作。如果我激活新版本，我会收到该错误。我所做的唯一更改是我将数据模型中的所有变量都设置为非可选变量，这些变量应该能够由自动迁移功能处理。我不明白为什么它说它找不到持久存储，当 [fileManager copyItemAtPath:defaultStorePath toPath:myPathDocs error:&error] 没有抛出错误时。

我似乎认为这与我的主包中的 sqlite 文件来自旧版本的数据模型，但没有来自新版本的 sqlite 文件这一事实有关。但是，我的印象是自动迁移只会为新模型自己生成一个新文件（？）并将现有文件中的数据迁移到其中。这是错的吗？

在我的 iOS 应用程序中，我的资源中有一个名为 Formats.sqlite 的文件。在全新安装后启动时，应用程序会查看应用程序的 /Documents 文件夹中是否存在现有的 Formats.sqlite。如果没有，它会将主包中的那个复制到那里。在我制作新版本的模型之前，这一切都很好。这是我使用的代码：

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    int count = [[persistentStoreCoordinator persistentStores] count];
    if (persistentStoreCoordinator != nil && count) {
        return persistentStoreCoordinator;
    }
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *myPathDocs =  [documentsDirectory stringByAppendingPathComponent:@"Formats.sqlite"];
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error = nil;
    if (![fileManager fileExistsAtPath:myPathDocs]) {
        NSLog(@"SQLite file not found, copying SQLITE file");
        NSString *defaultStorePath = [[NSBundle mainBundle] pathForResource:@"Formats" ofType:@"sqlite"];
        if (defaultStorePath) {
            if(![fileManager copyItemAtPath:defaultStorePath toPath:myPathDocs error:&error]) {
                NSLog(@"Error copying file at defaultStorePath to the documents path: %@",error);
            }
        }
    }
    storeURL = [NSURL fileURLWithPath:myPathDocs];
    NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys: 
                             [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption, 
                             [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, 
                             nil];
    if (persistentStoreCoordinator == nil) {
        persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    }
    if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:options error:&error])
    {//my error code here} 
```

So then the error gets thrown where it says "my error code here." What do I do in order to fix this? Why is this happening? Incidentally the console spits out all the steps for the migration, so it looks like it's trying to do it, but then it can't find the persistent store, which I don't understand why it can't find it, since it's been added in the build targets.

I just want to make sure that if people upgrade from previous versions of the app, their data gets migrated over and they don't have to re-enter everything. Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T18:24:07.643

To find the source of the error, I used this code to get the most detailed description of the error from the debugger:

```
 NSArray* detailedErrors = [[error userInfo] objectForKey:NSDetailedErrorsKey];
    if(detailedErrors != nil && [detailedErrors count] > 0) {
        for(NSError* detailedError in detailedErrors) {
            NSLog(@"  DetailedError: %@", [detailedError userInfo]);
        }
    } else {
        NSLog(@"  %@", [error userInfo]);
    } 
```

Then after using that code, the error message said that one of the properties in my model did not have a default value, and that it would need one for the automatic migration to work correctly. After I added the default value for that property, then everything worked.

The above code snippet is very useful for debugging Core Data errors because without it, Core Data won't necessarily tell you which exact property in your model is the source of the problem. Using the "detailedError" code gave me the exact info I needed. **Thanks, "detailedError."**

# php - PHP preg_match 在两个 HTML 标记之间抓取文本

> ID：10965715
> 
> 赞同：1
> 
> 时间：2012-06-10T01:08:18.493
> 
> 标签：php, regex

我正在尝试使用 preg_match 来获取两个 HTML 标签之间的文本。

这是我的代码的简化版本：

```
 $sPattern = "/<li class=\"sample\">(.*?)<\/li>/s";
 $sText = "blah blah blah <li class=\"sample\">hello world!</li> blah blah blah";
 preg_match($sPattern,$sText,$aMatch);
 echo '<pre>'.print_r($aMatch).'</pre>'; 
```

但是，当我运行此代码时，会返回完整的 HTML 字符串：

```
<li class=\"sample\">hello world!</li> 
```

有谁知道我需要对我的正则表达式进行哪些更改？

注意：我知道从 HTML 页面解析数据的其他方法。由于各种原因，DOMDocument 和 DOMXPath 不是一个选项——我坚持使用 RegEx。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T01:15:36.200

这应该按您的意愿工作：

```
$sPattern = "/<li class=\"sample\">(.*?)<\/li>/s";
$sText = "blah blah blah <li class=\"sample\">hello world!</li> blah blah blah";
preg_match($sPattern,$sText,$aMatch);
echo '<pre>'.$aMatch[1].'</pre>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T01:13:06.630

您需要访问捕获组输出。

```
var_dump( $aMatch[1]); 
```

[这是一个演示](http://codepad.viper-7.com/IbdrWD)，显示正则表达式工作正常，您只是错误地访问了结果数组。

# event-handling - WebSocket.onclose 应该由用户导航触发还是刷新触发？

> ID：10965720
> 
> 赞同：36
> 
> 时间：2012-06-10T01:09:39.997
> 
> 标签：event-handling, websocket, reconnect

## 第 1 部分：预期行为？

我看到 Firefox 和 Chrome 之间与`onclose`被调用的处理程序有关的浏览器行为不一致。

`onclose`如果它是由用户页面导航/刷新引起的，Chrome 似乎不会触发。但是，Firefox 确实会触发`onclose`.

在我看来，Firefox 在这里的行为可能是正确的：

> 当 WebSocket 连接关闭时，可能是干净的，用户代理必须创建一个使用 CloseEvent 接口的事件，事件名称为 close，不冒泡，不可取消，没有默认操作，其 wasClean 属性设置为 true如果连接干净关闭，否则为false，其code属性设置为WebSocket连接关闭代码，其原因属性设置为WebSocket连接关闭原因；并排队一个任务，首先将 readyState 属性的值更改为 CLOSED (3)，然后在 WebSocket 对象处分派事件。

资料来源：[http ://www.w3.org/TR/2011/WD-websockets-20110419/#closeWebSocket](http://www.w3.org/TR/2011/WD-websockets-20110419/#closeWebSocket)

*即使它可能导致一些[鬼鬼祟祟的代码/意外行为](https://bugzilla.mozilla.org/show_bug.cgi?id=602286)。*

任何人都可以确认预期的行为吗？

## 第 2 部分：如何实现自动重新连接？

如果您有一个为用户自动重新连接的库，您如何知道是否应该尝试重新连接？你检查[`CloseEvent.wasClean`](http://www.w3.org/TR/2011/WD-websockets-20110419/#dom-closeevent-wasclean)财产吗？我不得不假设“干净”意味着关闭应该通过 API 调用`WebSocket.close()`或服务器发送关闭帧来发生？如果网络错误导致关闭，我猜`wasClean`会是`false`什么？

在 Pusher JavaScript 库中，我们假设（onclose -> waiting -> connected）关闭应该触发重新连接，除非我们处于关闭状态 - 开发人员选择关闭连接。socket.io 客户端库似乎做出了相同的假设。

基于此，由用户导航/刷新引起的 Firefox onclose 事件会触发不需要的重新连接，因为两个库都不会检查该`CloseEvent.wasClean`属性。

## 示例和视频

这是一个可用于演示不一致的示例：http: [//jsbin.com/awonod/7](http://jsbin.com/awonod/7)

这是我演示问题的视频： [http](http://www.screenr.com/vHn8) ://www.screenr.com/vHn8 （已经很晚了，忽略这两个错误:)）

需要注意的一点是，我按下 Escape 键也可能导致 WebSocket 连接关闭。但是，如果您仔细观察或亲自尝试，您将看到在页面刷新之前记录的关闭事件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-18T15:57:37.570

意外行为是由于 Firefox 和 Chrome 处理 Websocket 关闭的方式造成的。当页面刷新时，两个浏览器都会关闭连接，但是，Firefox 会执行你的 onclose 代码，而 chrome 会关闭连接并直接跳到重新加载新页面。所以是的，我确认了这种奇怪的行为。
更奇怪的是，根据我的观察，在 chrome 中调用 websocket.close() 将立即关闭连接并调用 onclose 函数，而 Firefox 则等待来自服务器的关闭消息。

如果从服务器接收到关闭消息，则 wasClean 属性将为真

如果您的库在没有检查 wasClean 属性的情况下自动重新连接，那么这可能会导致问题，因为它会在页面刷新时尝试重新建立连接。您应该考虑不为此使用该库并手动执行它，这应该不会很难，只需在 onclose 函数中调用 connect 并使用 if 语句确保 onclean 属性为真。或者为了更安全，在 onbeforeunload 中设置一个变量以防止任何新连接。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-29T06:30:08.523

令人惊讶的是，这仍然是 2022 年的当前行为。您可以通过在 websocket 的 onclose 处理程序中添加控制台日志来简单地演示这一点，并在查看控制台时单击 Firefox 与 Chrome 中的链接（确保在网页之间保留控制台） ：

```
ws.onclose = function(e) {
  printMsg('CLOSE')
  // ... my other code ...
} 
```

Firefox 会显示“关闭”，而 Chrome 不会。

# python - 在 Eclipse 上安装 PyDev

> ID：10965724
> 
> 赞同：0
> 
> 时间：2012-06-10T01:10:19.180
> 
> 标签：python, eclipse, pydev

在过去的几天里，我在尝试为 Eclipse 安装 PyDev 插件时遇到了麻烦。我不断收到存储库错误，如下所示：

收集要安装的项目时发生错误会话上下文是：（profile=SDKProfile，phase=org.eclipse.equinox.internal.p2.engine.phases.Collect，operand=，action=）。无法读取位于[http://pydev.org/updates/plugins/org.python.pydev_2.5.0.2012040618.jar](http://pydev.org/updates/plugins/org.python.pydev_2.5.0.2012040618.jar)的存储库。读取超时

这发生在过去 3 或 4 天，我不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:20:54.680

这听起来像一个网络问题。我发现自己无法在 Eclipse 上安装 BPEL 插件。

我所做的是从我朋友的计算机上复制插件并将其放在我的 eclipse 插件目录中。linux中的插件目录位置是这样的：

```
/home/gofrendi/.eclipse/155965261/plugins 
```

在 Windows 上，插件目录位置类似于：

```
C:\Documents and Settings\gofrendi\My Documents\eclipse-jee-indigo-SR2-win32\plugins 
```

只需复制带有*com.python*或*org.python*前缀的所有内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T11:05:14.557

在 PyDev 更新站点中应该不是问题（只是在这里测试过，没有其他抱怨）。[因此，在这种情况下，您可以尝试从 sourceforge 获取 .zip 安装（请参阅http://pydev.org/download.html](http://pydev.org/download.html)末尾的 url ），或者您可以下载 Aptana Studio 3（预装 PyDev - - [http://pydev.org/download.html](http://pydev.org/download.html)也有链接）。

# javascript - 在为动力学JS缩放期间创建重复图像？

> ID：10965729
> 
> 赞同：1
> 
> 时间：2012-06-10T01:13:56.227
> 
> 标签：javascript, html, image, canvas, kineticjs

我正在使用 KineticJS 并试图获得适当的缩放功能。我有一个图层，我在我想要的原始尺寸上附加了一个背景图像。

但是，当我放大（通过 layer.setScale()）时，我的图像在与其他所有内容一起放大时会缩小（留下暴露的白色区域）。

那么即使发生这种情况，我怎样才能让我的图像重复呢？这是我用来添加图像的代码：

```
var imageObj = new Image();
imageObj.onload = function() {
var image = new Kinetic.Image({
    image: imageObj,
    width: width,
    height: height

});
// add the shape to the layer
main_layer.add(image);

// add the layer to the stage
stage.add(main_layer);
};
imageObj.src = 'images/blueprint_background.png'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T13:39:25.573

尝试创建矩形，然后用图像填充它。

```
var rect = new Kinetic.Rect({
  x: 0,
  y: 0,
  width: 2 * imageObj.width,
  height: imageObj.height,
  fillPatternImage: imageObj,
  fillPatternRepeat: 'repeat-x'
}); 
```

这个矩形将由 Ox 重复您的图像两次。

您可以尝试创建长矩形，然后当您缩放图层时，或者您可以随着比例的变化动态调整矩形的大小。

# iphone - 如何给一个单独的uitableview单元格圆形边框

> ID：10965732
> 
> 赞同：0
> 
> 时间：2012-06-10T01:14:50.673
> 
> 标签：iphone, ios, xcode

我有一个 UIviewController，在 xib 文件中我添加了 3 个 uitableview 单元格，但我想给顶部和底部单元格提供类似于分组表外观的圆角。我该如何做到这一点，以及如何以编程方式将表格单元格添加到 uiviewcontroller？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:48:15.030

这是我的方法，但要使其工作，您需要有顶部单元格、底部单元格和中间单元格的图像。这将有助于区分第一行、中间行和底部行。

```
 UIImage *rowBackground;
    UIImage *selectionBackground;
    NSInteger sectionRows = [tableView numberOfRowsInSection:[indexPath section]];
    if (indexPath.row == 0)
    {
        rowBackground = [UIImage imageNamed:@"topRow.png"]; //Top Rounded
        selectionBackground = [UIImage imageNamed:@"topRowSelected.png"]; //Top Rounded Selected
    }
    else if (indexPath.row == sectionRows - 1)
    {
        if (indexPath.section == 0) {
        rowBackground = [UIImage imageNamed:@"bottomRow.png"];// Bottom Rounded
        selectionBackground = [UIImage imageNamed:@"bottomRowSelected.png"]; //Bottom Rounded Selected
        } else {
            rowBackground = [UIImage imageNamed:@"bottomRowSelected.png"];
            selectionBackground = [UIImage imageNamed:@"bottomRow.png"];
        }
    }
    else
    {
        rowBackground = [UIImage imageNamed:@"middleRow.png"]; // Anything in the middle
        selectionBackground = [UIImage imageNamed:@"middleRowSelected.png"];
    }

    ((UIImageView *)cell.backgroundView).image = rowBackground;
    ((UIImageView *)cell.selectedBackgroundView).image = selectionBackground; 
```

# jquery - struts2 jquery grid：数据未显示在网格上

> ID：10965735
> 
> 赞同：0
> 
> 时间：2012-06-10T01:15:47.527
> 
> 标签：jquery, json, jqgrid, struts2

我正在尝试使用 struts2-jquery 网格插件。调试时，我的 gridmodel 得到了正确更新，但网格上没有显示任何内容。这是我的动作课：

```
private List<Customer> gridModel; 
  private Integer             rows          ;

  private Integer             page         ;

  private String              sord;

  private String              sidx;

  private String              searchField;

  private String              searchString;

  private String              searchOper;

  private Integer             total         ;

  private Integer             records        ;

public String execute() throws Exception{
    try {
    List<Customer> list = new ArrayList<Customer>; 
    for (int i=0; i<3; i++) {
        Customer cust = new Customer("myName", 20, "myAdress", "23651336"); 
        list.add(cust); 
    }
    setGridModel(list); 
    setRecords(list.size());
    total =(int) Math.ceil((double)records / (double)rows);
    } catch( Exception e) {
        log.error("Error in JSON data : " +e.getMessage()); 
    }
    return SUCCESS; 

}

public List<Customer> getGridModel() {
    return gridModel;
}

public Integer getPage() {
    return page;
}

public void setPage(Integer page) {
    this.page = page;
}

public String getSearchField() {
    return searchField;
}

public void setSearchField(String searchField) {
    this.searchField = searchField;
}

public void setGridModel(List<Customer> gridModel) {
    this.gridModel = gridModel;
}

public String getSord() {
    return sord;
}

public void setSord(String sord) {
    this.sord = sord;
}

public String getSidx() {
    return sidx;
}

public void setSidx(String sidx) {
    this.sidx = sidx;
}

public Integer getRecords() {
    return records;
}

public void setRecords(Integer records) {
     this.records = records;

        if (this.records > 0 && this.rows > 0)
        {
          this.total = (int) Math.ceil((double) this.records / (double) this.rows);
        }
        else
        {
          this.total = 0;
        }
}

public String getSearchOper() {
    return searchOper;
}

public void setSearchOper(String searchOper) {
    this.searchOper = searchOper;
}

public Integer getTotal() {
    return total;
}

public void setTotal(Integer total) {
    this.total = total;
}

public String getSearchString() {
    return searchString;
}

public void setSearchString(String searchString) {
    this.searchString = searchString;
}

public Integer getRows() {
    return rows;
}

public void setRows(Integer rows) {
    this.rows = rows;
} 
```

我将以下网格定义添加到我的 jsp 中：

```
<s:url id="remoteurl" action="jsontable"/>
<sjg:grid
    id="gridtable"
    caption="Listes "
    dataType="json"
    href="%{remoteurl}"
    pager="true"
    gridModel="gridModel"
    rowList="10,15,20"
    rowNum="15"
    rownumbers="true"
>
    <sjg:gridColumn name="name" index="name" title="Name"  />
    <sjg:gridColumn name="age" index="age" title="Age"/>
    <sjg:gridColumn name="adress" index="adress" title="Adress" />
    <sjg:gridColumn name="tel" index="tel" title="Tel"   />
</sjg:grid> 
```

在 struts.xml 中，我使用结果类型 json 声明我的操作

```
<package name="default" extends="json-default,struts-default" namespace="/">

    <result-types>
        <result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult" />
        <result-type name="json" class="org.apache.struts2.json.JSONResult" />
    </result-types>

    <action name="jsontable" class="com.web.action" method="execute" >
        <result name="success" type = "json"></result>
    </action>

</package> 
```

拜托，你能告诉我我错过了什么吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:54:50.080

当我将我的行动放入一个新的集体诉讼而不是另一个诉讼时，问题就解决了。

# c# - 压缩通过 C# 套接字发送的数据？

> ID：10965737
> 
> 赞同：0
> 
> 时间：2012-06-10T01:16:08.510
> 
> 标签：c#, sockets, stream, compression

我正在尝试使用 C# 套接字发送图像。它有效，但不稳定。通过发送的图像非常大，并且更新非常快，这导致它不时闪烁。如果可能的话，我正在寻找一种压缩发送的数据的方法。我正在使用这段代码：

**服务器端：**

```
System.IO.MemoryStream stream = new System.IO.MemoryStream();

// !! Code here that captures the screen !!

bitmap.Save(stream, myImageCodecInfo, myEncoderParameters);

byte[] imageBytes = stream.ToArray();
stream.Dispose();

// Send the image
clientSocket.Send(imageBytes);

// Empty the byte array?
for (int i = 0; i < imageBytes.Length; i++)
{
    imageBytes[i] = 0;
} 
```

**客户端：**

```
private void OnConnect(IAsyncResult ar)
{
    try
    {
        MessageBox.Show("Connected");

        //Start listening to the data asynchronously
        clientSocket.BeginReceive(byteData,
                                    0,
                                    byteData.Length,
                                    SocketFlags.None,
                                    new AsyncCallback(OnReceive),
                                    null);
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message, "Stream Error",MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
}

private void OnReceive(IAsyncResult ar)
{
    try
    {
        int byteCount = clientSocket.EndReceive(ar);

        // Display the image on the pictureBox
        MemoryStream ms = new MemoryStream(byteData);
        pictureBox1.Image = Image.FromStream(ms);
        }
    catch (ArgumentException e)
    {
        //MessageBox.Show(e.Message);
    }
    clientSocket.BeginReceive(byteData,0,byteData.Length,SocketFlags.None,new AsyncCallback(OnReceive),null);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T23:42:31.953

我最终使用了 gzip。

原来闪烁不是因为它更新得很快，而是因为我设置套接字的方式。它没有发送整个图像。

# c# - Enum 可以包含其他 Enum 吗？

> ID：10965738
> 
> 赞同：5
> 
> 时间：2012-06-10T01:16:31.903
> 
> 标签：c#, silverlight, enums, ienumerable

Enum 可以包含其他 Enum 元素以及它自己的元素吗？

```
public enum CardSuit
{
    spades,
    hearts,
    diamonds,
    clubs 
}

public enum GameSuit
{
    spades,        //        These are 
    hearts,        //        the same
    diamonds,      //      " CardSuit "
    clubs,         //        elements

    suns    //             " GameSuit " special element
} 
```

我们可以在 GameSuit 中包含 CardSuit 而不需要重复输入相同的元素吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T01:21:59.290

遗憾的是，没有很好的解决方案来解决您想要使用枚举的问题。您可以尝试其他选项，例如`public static readonly`特定“类枚举”类型的一系列字段：

```
public class CardSuit 
{
    public static readonly CardSuit Spades = new CardSuit();
    public static readonly CardSuit Hearts = new CardSuit();
    ...
}

public enum GameSuit : CardSuit 
{
    public static readonly GameSuit Suns = new GameSuit();
} 
```

在实践中，这也可以正常工作，尽管没有`switch`语句支持。用法可能如下：

```
var cardSuit = ...;
if (cardSuit == CardSuit.Spades || cardSuit == GameSuit.Suns) { ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T01:21:50.810

您输入的内容是合法的，但两个枚举彼此独立。

`GameSuit`enum spades 与 enum spades 无关`CardsSuit`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T01:30:21.803

您可以将值从一种枚举类型显式传递到另一种枚举类型：

```
public enum Foo { a, b, c }
public enum Bar { a = Foo.a, b = Foo.b, c = Foo.c + 3, d } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T01:42:12.120

Enum 是一个特殊的类，具有特殊的行为。你不能直接继承这个类，但是任何时候你声明一个 new 时它都是不正确的继承者`enum`。

你不能`enum`从另一个继承一个新的`enum`。

你可以做这样的事情的唯一方法是使用反射。但是你没有得到你想做的事。这可以使您将Refletcion与枚举一起使用多远：

*   [使用反射创建枚举](https://stackoverflow.com/questions/8979179/create-enum-using-reflection)
*   [通过反射设置枚举](http://www.codeproject.com/Articles/15292/Setting-Enum-s-Through-Reflection)

但恐怕这不符合你的目的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-18T14:47:26.250

没有必要放弃开关支持。您可以通过设置起始整数值来考虑各种其他枚举类型。

```
const int baseOfCardSuit = 0;
const int baseOfGameSuit = 4;

public enum CardSuit
{
    spades = baseOfCardSuit,
    hearts, // 1
    diamonds, // 2
    clubs // 3
};

public enum GameSuit
{
    suns = baseOfGameSuit
}; 
```

强制转换为无效枚举值不会修改整数值。

```
GameSuit a = (GameSuit) CardSuit.spades;
Console.WriteLine(a); // "0"
CardSuit b = (CardSuit) GameSuit.suns;
Console.WriteLine(b); // "4" 
```

因此枚举类型是可以互换的。

```
int value = 4; // "GameSuit.*"
switch((CardSuit)value) 
{
  case CardSuit.spades:
  case CardSuit.hearts:
  case CardSuit.diamonds:
  case CardSuit.clubs:
     Console.WriteLine("CardSuit.*");
     break;
  default: 
     switch((GameSuit)value) 
     {
         case GameSuit.sums:
            Console.WriteLine("GameSuit.*");
            break;
         default:
            Console.WriteLine("Err: value not found");
            break;  
     }
   break;
} 
```

# jquery - Jquery滑块不适用于身体负荷

> ID：10965742
> 
> 赞同：0
> 
> 时间：2012-06-10T01:17:19.273
> 
> 标签：jquery

我有网站[http://elitereviewtheme.com/amazon/test/](http://elitereviewtheme.com/amazon/test/)自定义滑块。但问题是滑块在加载时无法正常工作，即使代码中没有错误。如果单击任何缩略图或下一个上一个按钮，那么它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:27:52.010

轮播似乎是付费的，因此您可能应该通过他们的支持联系 rivaslider 或者您可以尝试以下操作：

设置滑块后调用它，它应该自动启动：

`setTimeout($('.rs-next').click(), 100);`

# javascript - 如何停止在 node-mysql ( node.js, express, mysql ) 中编写嵌套代码

> ID：10965744
> 
> 赞同：2
> 
> 时间：2012-06-10T01:17:38.400
> 
> 标签：javascript, node.js, node-mysql

每次我抛出一个查询，嵌套深度都会增加一，就像下面的代码一样。如果我知道如何将查询定义为不在操作中的函数，我的代码的可读性就会提高。

```
exports.getAll = function (req, res) {

    client.query('SELECT * FROM tag', function (err, result, fields) {
        client.destroy();

        if (err) {
            throw err;
        }

        var tag = result[0].tag;

        client.query('SELECT COUNT(follow_id) AS following_tag_num FROM follow WHERE user_id = ?', [req.session.user.user_id], function (err, result, fields) {
            client.destroy();

            if (err) {
                throw err;
            }

            res.render('hoge', {
                title: 'Welcome to Hoge',
                userInfo: req.session.user,
                tag: tag,
                following_tag_num: result[0].following_tag_num
            });
        });

    });

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T01:23:23.360

只需将处理程序设为命名函数：

```
client.query(
  'SELECT COUNT(follow_id) AS following_tag_num FROM follow WHERE user_id = ?',
  [req.session.user.user_id],
  handleResult
);

function handleResult(err, result, fields) {
  client.destroy();

  if (err) {
    throw err;
  }

  res.render('hoge', {
    title            : 'Welcome to Hoge',
    userInfo         : req.session.user,
    tag              : tag,
    following_tag_num: result[0].following_tag_num
  });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T12:37:26.403

您可能会查看几个可用于帮助抑制嵌套的节点流控制模块。我喜欢一个叫做[async](https://github.com/caolan/async)的。它提供了多种方法来取消嵌套代码。

```
var async = require('async');
async.waterfall([
    function(callback) {
        client.query(sql, callback);
    },
    function(results, callback) {
        // do something with results, then call callback
    }],
    function(err, data) {
        // if any errors occur above, err is not null
        // otherwise 'data' is whatever got passed to the last callback
    }); 
```

`async.waterfall`接受一个函数列表，并将每个函数的结果传递给下一个函数，最后调用第二个参数，另一个函数，最终结果。结果不是通过返回来传递的，而是通过回调函数传递的。`async`还支持并行、串行运行多个函数，以及 node.js 中使用的各种不同的常用模式。

# ajax - AjaxControlToolkit 版本=4.1.60501.0 - 错误：AjaxControlToolkit 需要 ASP.NET Ajax 4.0 脚本

> ID：10965746
> 
> 赞同：1
> 
> 时间：2012-06-10T01:18:50.443
> 
> 标签：ajax, toolkitscriptmanager

我收到此错误：

错误：AjaxControlToolkit 需要 ASP.NET Ajax 4.0 脚本。确保引用了正确版本的脚本。如果您使用的是 ASP.NET ScriptManager，请切换到 AjaxControlToolkit.dll 中的 ToolkitScriptManager。

我已经搜索了 Hi 和 Low，但无法解决这个问题。当我去 VS2008 时，我遇到了同样的问题，并通过更改我的 web.config 解决了它

现在我正在运行 VS 2012 express。我已经安装了 AjaxControlToolkit 版本 4.1.60501.0

网络配置：

```
 <compilation debug="false" targetFramework="4.5">
 <assemblies>
 <add assembly="AjaxControlToolkit, Version=4.1.60501.0, Culture=neutral, PublicKeyToken=28f01b0e84b6d53e"/>
 <add assembly="System.Web.Extensions.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
 <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
 <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
 </assemblies> 
```

和

```
 <controls>
 <add tagPrefix="cc1" namespace="AjaxControlToolkit" assembly="AjaxControlToolkit"/>
 </controls> 
```

在 ASPX 中，我有：

```
 <cc1:ToolkitScriptManager ID="ScriptManager1" runat="server">
 </cc1:ToolkitScriptManager> 
```

我得到了上述错误。我知道 Toolkit DLL 是正确的版本。

我也在同一台机器上运行 VS2008 / Ajax 3.5，但我清除了所有其他项目的 Temporary ASP.Net Files 文件夹，但仍然存在问题。当我运行这个新的 VS2012 项目时，会在 Temp 文件夹中创建一个 ROOT 文件夹，并且该文件夹中的 AjaxControlToolkit.DLL 版本为 4.1.60501.0

需要改变什么？

非常感谢，吉姆

# ios5 - 使用 UIStoryboards 时的最佳实践是什么？

> ID：10965749
> 
> 赞同：17
> 
> 时间：2012-06-10T01:19:11.317
> 
> 标签：ios5, standards, xib, uistoryboard

使用故事板一段时间后，我发现它们非常有用，但是它们确实有一些限制，或者至少是不自然的做事方式。虽然看起来应该为您的应用程序使用单个故事板，但当您获得一个中等大小的应用程序时，这会带来几个问题。

1.  团队合作变得更加困难，因为 Storyboard 中的冲突可能难以解决（也欢迎任何与此相关的提示）
2.  故事板本身可能会变得非常混乱和难以管理。

所以我的问题是什么是最佳使用实践？

我考虑过使用混合方法，将逻辑任务拆分为单独的故事板，但这会导致 UX 流程在代码和故事板之间拆分。对我来说，这感觉像是创建可重用操作（例如登录操作等）的最佳方式。

我还应该考虑给 Xibs 一个地方吗？[这篇文章](http://robsprogramknowledge.blogspot.co.uk/2012/01/uistoryboard-best-practices.html)对很多问题都有很好的概述，它建议对于只有一个屏幕的场景，应该在这种情况下使用 xibs。Apple 支持从情节提要中实例化未连接的场景，这再次让我感到不寻常，这表明 xibs 将来不会有一席之地，但我可能是错的。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-11T02:19:25.540

你是对的，分解故事板是最好的方法。分解不仅仅是使部分 UI 更可重用。它还使得在团队中使用故事板更易于管理。

最近，我的许多故事板都包含四个或更少的场景。一个人单独构建和维护一个或多个这样的 UI 模块是很容易的。这种做法减少或消除了合并冲突。

如果我确实需要在其他人拥有的情节提要中进行更改，我会先询问所有者他或她是否有任何本地更改。如果是这样，我有时会让所有者为我添加更改。分解仍然需要一些协调，但它远不如完整的应用故事板。自从我开始这个练习以来，我没有遇到任何合并困难。

至于 XIB，我认为我在文章中写的不够多。它们仍然非常有用。它们非常适合单视图控制器。然而，这并不是他们真正闪耀的地方。XIB 有一个故事板可能永远不会有的优势。XIB 最基本的单元是 UIView，而故事板的基本单元是 UIViewController。由于 XIB 可以保存 UIView 的集合，因此它们非常适合直观地创建自定义控件。在 XIB 中，我可以直观地构建一个旋转拨号或 GPS 小部件。然后我可以将这些控件和小部件放入情节提要或其他 XIB 中。这种 XIB 在 iPad 应用程序中更常见，因为它们具有更大的屏幕，能够容纳许多控件和小部件。在情节提要的 UIViewController 中构建 UISwitch 是不自然的。

现在最好的消息。可以在 Interface Builder 中连接故事板，而无需编写任何代码。我计划在 WWDC 之后发布这项技术，因为 Apple 可能会在 iOS 6 中发布类似的功能。但是，既然你问了，我决定现在就发布它。[您可以在我的博客](http://robsprogramknowledge.blogspot.com/2012/06/linking-storyboard.html)和[GitHub](https://github.com/rob-brown/RBStoryboardLink)上找到更多详细信息，而不是重复我对 RBStoryboardLink 工作原理的解释。这将使您的 UIStoryboard 体验更加愉快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T03:33:07.630

我发现这篇[文章](http://toxicsoftware.com/uistoryboard-issues/)在使用 StoryBoard 时提到了很多问题，作者提出的一件事是在一个 StoryBoard 中使用大量 nib 文件，我同意他不应该这样做，但还有其他问题，例如：

> 我的根视图控制器已成为许多 segue 的源视图控制器，因此它的 prepareForSegue: 已成为一个愚蠢的大方法，其中连续填充了许多“if (segue.identifier isEqualToString:@”...")”语句

和

> 可以为情节提要中的视图控制器分配标识符。不幸的是，这个标识符属性没有在 UIViewController 类中公开。这使得在运行时执行视图控制器层次结构的安全自省变得非常困难。如果为视图控制器和 segues 公开标识符，那就太好了。

和...更多其他问题，我认为它确实有道理，我担心现在是否应该使用 StoryBoard？

# iphone - 如何在枚举 UIScrollView 的子视图时排除滚动指示器？

> ID：10965754
> 
> 赞同：10
> 
> 时间：2012-06-10T01:20:56.247
> 
> 标签：iphone, ios, ipad, uiscrollview, uikit

我正在尝试`subviews`在`UIScrollView`子类中调整我的，但我不想打扰滚动指示器。似乎没有任何公共接口可以访问这些，我想检查视图是否是滚动指示器之一（以便我可以忽略它）。

`UIScrollView.h`声明这两个 iVar：

```
UIImageView* _verticalScrollIndicator;
UIImageView* _horizontalScrollIndicator; 
```

...但我尝试了以下操作并收到链接器错误：

```
for(UIView* v in self.subviews)
{
    // Ignore the scroll-indicator views
    if( (v == _horizontalScrollIndicator) ||
        (v == _verticalScrollIndicator))
    {
        continue;
    }
    // View is one of mine - do stuff to it...
} 
```

Apple 显然不希望你弄乱这些，在这种情况下，他们应该做一些聪明的事情，以便从返回的数组`subviews`不包含它们（来吧 Apple，这并不难！），但在那之前我怎么能忽略它们?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-13T21:47:42.293

这最终成为我的解决方法

```
BOOL showsVerticalScrollIndicator = self.showsVerticalScrollIndicator;
BOOL showsHorizontalScrollIndicator = self.showsHorizontalScrollIndicator;

self.showsVerticalScrollIndicator = NO;
self.showsHorizontalScrollIndicator = NO;

// loop through self.subviews here

self.showsVerticalScrollIndicator = showsVerticalScrollIndicator;
self.showsHorizontalScrollIndicator = showsHorizontalScrollIndicator; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T01:28:12.230

大概您可以控制放入`UIScrollView`. 为什么不维护自己的视图数组呢？这样，您就可以安全地应对 UIScrollView 实现中的任何未来更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-13T23:05:42.857

我遇到了同样的问题，我开始考虑查看这两个`UIImageView`s 的值，以确定它们是否存在。他们确实有一个非常独特的签名：

```
<UIImageView: 0x8ab3e00; frame = (313 812.5; 7 3.5); alpha = 0; opaque = NO; autoresize = TM; userInteractionEnabled = NO; layer = <CALayer: 0x8ab9740>>
<UIImageView: 0x8ab3e90; frame = (314.5 522; 3.5 341); alpha = 0; opaque = NO; autoresize = LM; userInteractionEnabled = NO; layer = <CALayer: 0x8ab3f20>> 
```

在您可以听的其他钩子中。不理想，但在这一点上的选择方式不多......

这是一个例子。在这种情况下，我在滚动视图的子视图中循环，以根据子视图找出滚动视图的最佳`contentSize`高度，当它开始出现一些时髦的值时，这让我认为是滚动条在搞砸我.. .

```
CGRect contentRect = CGRectZero;
for (UIView *view in self.myScrollView.subviews) {
    //exclude scroll bars, the width/height is 3.5 for non-retina or 7 
    //for retina. you can put some logic in here if you like to check
    //the appropriate 3.5/7.0 values for the respective screen densities
    if(view.frame.size.width > 7.0f && view.frame.size.height > 7.0f) {
        contentRect = CGRectUnion(contentRect, view.frame);
    }
}
container.contentSize = CGSizeMake(container.contentSize.width, contentRect.size.height); 
```

如果检查每个 UIView 的框架对您来说不够具体，您还可以确保它是一个 UIImageView。

我认为这是目前唯一的“真正”解决方案。我个人宁愿不必维护另一组观点。

**编辑：**

这是我使用的综合方法：

```
-(bool)isProbablyAScrollBar:(UIView*)view {
    CGFloat screenScale = [[UIScreen mainScreen] scale];
    return (([view isKindOfClass:[UIImageView class]]) && (view.frame.size.width <= (screenScale*3.5f) || view.frame.size.height <= (screenScale*3.5f)));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-23T11:32:22.647

滚动指示器视图是在滚动视图的整个生命周期中添加和删除的，还是只添加一次并在必要时隐藏和显示？如果是后者，您可以将自己对它们的引用存储在 init... 而不是使用私有 ivars 并按照您已经尝试过的方式继续。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-13T11:08:57.027

我的解决方案是：

```
UIView* MYContentView=[[UIView alloc] initWithRect: CGrectMake:(0,0,Scrollview.frame.size.width, scrollview.frame.size.height)];

[ScrollView addsubview: MYContentView]; 
```

然后我将所有图像添加到 MYContentView 中，然后重新调整了 MYContentView 和

```
 [ScrollView setContentSize:Cgsize]; 
```

现在您可以枚举 MYContentView 中的所有图像，而无需担心滚动条。

正在做：

```
while ([[MYContentView subviews] count]>0) {
    [[[MYContentView subviews]lastObject] removeFromSuperview];
} 
```

只删除了图像。希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-01T11:35:10.330

基于 MrTristan 的方法。我认为他错误地乘以屏幕比例。

```
+ (NSArray <UIView *> *)reservedSubviewsInUIScrollView:(UIScrollView *)view
{
    BOOL (^isProbablyAScrollBar)(UIView *s) = ^BOOL(UIView *s) {
        return [s isKindOfClass:[UIImageView class]] && (s.frame.size.width <= 3.5 || s.frame.size.height <= 3.5);
    };

    NSMutableArray <UIView *> *reserved = [NSMutableArray new];
    for(UIView *s in view.subviews)
    {
        if(isProbablyAScrollBar(s))
        {
            [reserved addObject:s];
        }
    }
    return reserved;
} 
```

# r - GenomicFeatures 软件包安装问题

> ID：10965755
> 
> 赞同：6
> 
> 时间：2012-06-10T01:21:18.977
> 
> 标签：r, bioconductor

很抱歉这么快就回来回答一个简单的安装问题，但我无法自己解决这个问题，这严重影响了我的工作效率。无论如何，我尝试按照 BC 网站的建议安装 GenomicFeatures。

```
> source("http://bioconductor.org/biocLite.R")
> biocLite("GenomicFeatures") 
```

我收到以下错误消息（除了几条警告消息）

```
ERROR: configuration failed for package ‘RCurl’
* removing ‘/home/tim/R/i686-pc-linux-gnu-library/2.15/RCurl’
ERROR: dependencies ‘XML’, ‘RCurl’ are not available for package ‘rtracklayer’
* removing ‘/home/tim/R/i686-pc-linux-gnu-library/2.15/rtracklayer’
ERROR: dependencies ‘XML’, ‘RCurl’ are not available for package ‘biomaRt’
* removing ‘/home/tim/R/i686-pc-linux-gnu-library/2.15/biomaRt’
ERROR: dependencies ‘rtracklayer’, ‘biomaRt’, ‘RCurl’ are not available for package ‘GenomicFeatures’
* removing ‘/home/tim/R/i686-pc-linux-gnu-library/2.15/GenomicFeatures’ 
```

所以我猜依赖项有一些问题，但它们会在 GF 之前自动安装似乎很奇怪。我使用的是 2.15.0 版。关于问题可能是什么的任何线索？我很乐意根据需要提供更多信息。谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-10T20:09:07.863

Martin Morgan 有一个我认为在评论中有效的解决方案。我会详细说明一下。

错误消息告诉您需要安装 RCurl 和 XML 包。这两个包都要求您的系统上有某些开发包。您似乎正在运行 Linux。如果您使用的是基于 Debian 的系统（Debian、Ubuntu、Mint 等），那么要安装 RCurl，您需要安装`libcurl4-openssl-dev`，而要安装 XML，您需要安装`libxml2-dev`. 您可以在命令行上通过键入相对轻松地完成此操作

```
sudo apt-get install libcurl4-openssl-dev libxml2-dev 
```

那应该安装所需的软件包和任何依赖项。然后你应该能够从 R 中安装 RCurl 和 XML 包。

```
install.packages("RCurl")
install.packages("XML") 
```

此时，您拥有所需的依赖项，并且应该能够从 Bioconductor 安装 GenomicFeatures。

```
source("http://bioconductor.org/biocLite.R")
biocLite("GenomicFeatures") 
```

对那些使用 Windows 的人来说只是一个注意事项 - 获取 RCurl 和 XML 并不一定容易，但是，Brian Ripley 博士在[他的网站上](http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/2.15/)为这些包提供了二进制文件，您可以很容易地从那里下载它们。最初，当我看到 RCurl 和 XML 存在问题时，我认为它一定是 Windows 用户，直到我查看实际错误并意识到它是 Linux 用户。

# delphi - 如何让德尔福货币类型一直像 Excel 一样四舍五入？

> ID：10965759
> 
> 赞同：10
> 
> 时间：2012-06-10T01:21:57.513
> 
> 标签：delphi, excel, format, currency, rounding

我正在尝试让 Delphi 像 Excel 一样进行 Round，但我做不到。这是代码：

```
procedure TForm1.Button1Click(Sender: TObject);
var
 s : string;
 c : currency;
begin
 c := 54321.245;
 s := '';
 s := s + Format('Variable: %m',[c]);
 s := s + chr(13);
 s := s + Format('   Literal: %m',[54321.245]);
 ShowMessage(s);
end; 
```

![德尔福四舍五入](../Images/94a7710771750f337c257b62693ac817.png)

我正在使用设置为 54321.245 的货币变量，当我格式化此变量时，它使用 Bankers Rounding 进行舍入。但是，当我将相同的值格式化为文字时，它会按照 Excel 的舍入方式进行舍入。

无论是格式化货币变量还是文字值，我都希望它会四舍五入到**54,321.25 美元。**如何确保 Delphi 每次都以与 Excel 相同的方式进行舍入？

**编辑**

```
The rounding I expect to see is as follows:  
54,321.245   = 54,321.25  
54,321.2449  = 54,321.24  
54,431.2499  = 54,421.25 
```

我只使用文字来展示 Delphi 循环的不同方式。我希望在实际代码中使用变量。

***注意：***
如果我将变量从**货币**更改为**扩展**，则它会正确舍

**编辑#2**

有人说我对自己的需求没有清晰的认识，这绝对不是真的。我对自己的要求有非常清楚的了解，我显然没有很好地解释它们。我想要的舍入方法是两位小数。当小数部分的千分之一值 >= 0.005 我希望它四舍五入到 0.01 时，Delphi 提供的货币类型不会这样做。我还尝试了使用 Microsoft SQL 和货币数据类型（我假设它与 Delphi 的货币相同）的这个示例，并且 SQL 按照我描述的方式对其货币类型进行舍入。

*   SQL 金钱 >= 0.005 = 0.01
*   德尔福货币 >= 0.005 := 0.00

**编辑#3**
好文章：[http](http://rvelthuis.de/articles/articles-floats.html)
://rvelthuis.de/articles/articles-floats.html 可能的解决方案：[http ://rvelthuis.de/programs/decimals.html](http://rvelthuis.de/programs/decimals.html)

**编辑 #4**
这是来自 Embarcadero 讨论的解决方案之一

```
function RoundCurrency(const Value: Currency): Currency;
var
  V64: Int64 absolute Result;
  Decimals: Integer;
begin
  Result := Value;
  Decimals := V64 mod 100;
  Dec(V64, Decimals);
  case Decimals of
    -99 .. -50 : Dec(V64, 100);
    50 .. 99 : Inc(V64, 100);
  end;
end;
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-10T16:24:23.163

如果我理解正确，您正在寻找这个：

```
function RoundTo2dp(Value: Currency): Currency;
begin
  Result := Trunc(Value*100+IfThen(Value>0, 0.5, -0.5))/100;
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-10T14:07:10.233

不可能使 RTL 以您想要的方式四舍五入。在 Delphi 中影响舍入的方法是使用[`SetRoundMode`](http://docwiki.embarcadero.com/Libraries/en/System.Math.SetRoundMode)which[设置 FPU 控制字](http://docwiki.embarcadero.com/RADStudio/XE2/en/Floating-Point_Rounding_Issues#Control_Settings)进行舍入，但是，据我所知，没有 FPU 支持将精确的中间值向上舍入（这通常是避免的，因为它会生成偏向更高的值）。

您必须实现自己的舍入功能。Embarcadero 论坛上的[Delphi Rounding 线程](https://forums.embarcadero.com/thread.jspa?threadID=70064)中有一个扩展讨论，其中包括几个解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-12T09:42:54.563

使用函数 System.Math.SimpleRoundTo

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T04:17:03.887

您可以通过以下方式控制 delphi 如何舍入数字：

```
uses Math;
...

procedure TForm1.Button1Click(Sender: TObject);
var
s : string;
c : currency;
begin
 SetRoundMode(rmNearest);

 c := 54321.245;
 s := '';
 s := s + Format('Variable: %m',[c]);
 s := s + chr(13);
 s := s + Format('   Literal: %m',[54321.245]);
 ShowMessage(s);
end; 
```

不幸的是，使用 rmNearest，Delphi 确定数字 54321.245 比 54321.25 更接近 54321.24

# javascript - 如何左对齐 jqmath 表中的元素

> ID：10965767
> 
> 赞同：3
> 
> 时间：2012-06-10T01:23:49.617
> 
> 标签：javascript, jqmath

如果我尝试在[jqmath](http://mathscribe.com/author/jqmath.html)创建一个表格，它总是将元素居中。所以如果我写

```
$$\table a , b ; c , dddddddddddd ;$$ 
```

然后我得到

```
a          b
c    dddddddddddd 
```

如何让 jqmath 将列向左对齐，以便表格显示为

```
a    b
c    dddddddddddd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:49:19.300

您需要做的就是设置适当的标签样式。

```
<style type="text/css">
mtd, .fm-mtd  {
    text-align:left;
}
</style> 
```

这在下面的[小提琴](http://jsfiddle.net/creemama/ehbLt/3/)中得到了证明。

要了解更多关于如何对 jqMath 生成的代码进行样式设置，只需查看他们的[CSS 样式表](http://mathscribe.com/mathscribe/jqmath-0.2.0.css)。

jqMath 在不同的浏览器上表现不同。默认情况下，Chrome 使用左对齐显示文本，而 Firefox 使用居中对齐显示文本。Chrome 使用`<td class="fm-mtd">`，而 Firefox 使用`<mtd>`. 使用的标签取决于[Web 浏览器是否支持 MathML](http://en.wikipedia.org/wiki/MathML#Web_browsers)。

要了解更多信息`text-align`，请访问[Mozilla 开发者网络](https://developer.mozilla.org/en/CSS/text-align)。

# mysql - 在某个时间窗口内免费预订

> ID：10965768
> 
> 赞同：1
> 
> 时间：2012-06-10T01:24:38.183
> 
> 标签：mysql, period

在我的数据库预订中，有 SSTART 和 SEND 字段作为期间开始和结束日期的期间。如何从预订表中找到免费时段，但在某个时间窗口内找到免费时段 - 从例如“2012-07-01”到“2012-07-31”的免费预订时段。在网站[http://www.artfulsoftware.com/infotree/queries.php#577](http://www.artfulsoftware.com/infotree/queries.php#577)上可以找到如何找到空闲时段，但我不知道如何定义时间窗口。

# windows-phone-7 - 带有 DataLoadOptions 和 LoadWith 的 DataContext 返回错误的条目数量

> ID：10965769
> 
> 赞同：0
> 
> 时间：2012-06-10T01:25:11.223
> 
> 标签：windows-phone-7, datacontext

想象一下以下场景：我有两个处于一对多关系的类，我尝试从一个类加载所有对象，同时也加载所有关联的对象。这是这两个类的骨架结构：

```
public class Parent
{
    //... id and other members omitted

    [Association(Name = "FK_Parent_Children", Storage = "_entries", ThisKey = "Id")]
    public EntitySet<Child> Children {
        get { return _children; }
    }
    private readonly EntitySet<Child> _children = new EntitySet<Child>();
}

public class Child
{
    //... id and other members omitted

    [Column]
    internal int? _belongId;

    private EntityRef<Parent> _belong;
    [Association(Name = "FK_Parent_Children", Storage = "_belong", ThisKey = "_belongId", OtherKey = "Id", IsForeignKey = true)]
    public Parent Belong
    {
        get { return _belong.Entity; }
        set { _belong.Entity = value; }
    }
} 
```

这是我尝试加载所有对象的代码：

```
using(var context = new MyContext())
{
    context.DeferredLoadingEnabled = false;

    var options = new DataLoadOptions();    
    options.AssociateWith<Parent>(c => c.Children.OrderByDescending(x => x.Born).Take(100));    
    options.LoadWith<Parent>(m => m.Children);
    context.LoadOptions = options;

    var parents = context.Parents.OrderBy(m => m.LastName).ToList();
    return parents; 
} 
```

有趣的是，尽管通常有更多的对象与单个“父级”相关联，但最多只有一个“子级”始终加载到 EntitySet 中。知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:54:18.010

我从来没有找到这种不稳定行为的原因，最终放弃了这种方式。

# php - PDO 未按预期工作

> ID：10965773
> 
> 赞同：0
> 
> 时间：2012-06-10T01:26:17.350
> 
> 标签：php, mysql, pdo, prepared-statement

我有以下 PDO：

```
// Connect to PDO / $this->link = PDO
$this->statement = $this->link->prepare("
    SELECT p.*, pm.*
      FROM dev_permissions p, dev_permissions_menu pm
     WHERE pm.id = p.permission_menu_id
       AND pm.module = 'account'
       AND pm.controller IN('login', '*')
       AND pm.action IN('index', '*')
");
// Execute and verify number of rows 
```

哪个有效，从 . 返回一行`$this->statement->rowCount()`。

但是，尝试绑定参数不能按预期工作：

```
// Connect to PDO / $this->link = PDO
$this->statement = $this->link->prepare("
    SELECT p.*, pm.*
      FROM dev_permissions p, dev_permissions_menu pm
     WHERE pm.id = p.permission_menu_id
       AND pm.module = :module
       AND pm.controller IN(:controller, '*')
       AND pm.action IN(:action, '*')
",

$this->statement->bindParam(':module', 'account', PDO::PARAM_STR);
$this->statement->bindParam(':controller', 'login', PDO::PARAM_STR);
$this->statement->bindParam(':action', 'index', PDO::PARAM_STR);
// Execute and verify number of rows 
```

谢谢！

**更新：**

更改`PDO::FETCH_ASSOC`为`PDO::PARAM_STR`因为 CTRL + C/CTRL + V 问题，并`#__`反映正确的数据库前缀。

使用以下代码进行测试：

```
$pdo = new \PDO('mysql:dbname=database;host=localhost', 'user', 'password');
$statement = $pdo->prepare("
    SELECT p.*, pm.*
      FROM dev_permissions p, dev_permissions_menu pm
     WHERE pm.id = p.permission_menu_id
       AND pm.module = :module
       AND pm.controller IN(:controller, '*')
       AND pm.action IN(:action, '*')
");
$statement->bindParam(':module', $request['module'], \PDO::PARAM_STR);
$statement->bindParam(':controller', $request['controller'], \PDO::PARAM_STR);
$statement->bindParam(':action', $request['action'], \PDO::PARAM_STR);
$statement->execute();

new \Core\Debug($statement->fetchAll()); 
```

一切正常。我找不到其他方式的问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:36:32.007

在您的示例中，变量名称有点令人困惑......`prepare`是 PDO 对象的一种方法，它返回一个 PDOStatement 对象......尝试：

```
$sth = $this->statement->prepare("
    SELECT p.*, pm.*
      FROM #__permissions p, #__permissions_menu pm
    WHERE pm.id = p.permission_menu_id
     AND pm.module = :module
     AND pm.controller IN(:controller, '*')
     AND pm.action IN(:action, '*')
",

$sth->bindParam(':module', 'account', PDO::PARAM_STR);
$sth->bindParam(':controller', 'login', PDO::PARAM_STR);
$sth->bindParam(':action', 'index', PDO::PARAM_STR);

//execute the prepared statement
$sth->execute(); 
```

作为注释...`rowCount`在选择语句上不会发出您的查询...它`COUNT(*)`使用与您的选择相同的信息执行查询...请参见[http://www.php.net/上的示例 #2手册/en/pdostatement.rowcount.php](http://www.php.net/manual/en/pdostatement.rowcount.php)

# jquery - 带有遮罩覆盖的轻量级 JQuery 滑块

> ID：10965776
> 
> 赞同：0
> 
> 时间：2012-06-10T01:27:37.877
> 
> 标签：jquery, html, css, overlay, mask

我正在尝试在我的网站中实现一个轻量级的 JQuery 滑块。我希望能够显示图片，就像它们坐在木框的图形中一样，木框与照片的边缘略微重叠。滑块正在工作，我已经尝试将透明的*.png*图像框架掩码文件放在滑块 div 的顶部，但我没有任何运气。你能提供一些见解吗？我认为这是一个CSS问题。

**HTML：**

```
<div id="container">
    <div class="mask"></div>
    <div id="slider">
        <div>
            <img src="images/1.jpg" alt="image01">
        </div>
        <div>
            <img src="images/2.jpg" alt="image02">
        </div>
        <div>
            <img src="images/3.jpg" alt="image03">
        </div>
    </div>
</div> 
```

**CSS：**

```
#container {
    position: relative;
    width: 700px;
    height: 325px;
}

.mask {
    background: url('images/mask.png') no-repeat 0 0;
    width: 700px;
    height: 325px;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 999999;
}

#slider {
    position: relative;
    width: 700px;
    height: 325px;
}

#slider > div {
    position: absolute;
    top: 0;
    left: 0;
} 
```

**查询：**

```
$(function() {
    $("#slider > div:gt(0)").hide();

    setInterval(function() {
        $('#slider > div:first')
            .fadeOut(1000)
            .next()
            .fadeIn(1000)
            .end()
            .appendTo('#slider');
    }, 4000);
}); 
```

谢谢你的帮助！

jsFiddle：http: [//jsfiddle.net/qpL3B/](http://jsfiddle.net/qpL3B/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:25:06.830

我建议你使用像 jquery slide 这样的插件。

[http://jquery.malsup.com/cycle/](http://jquery.malsup.com/cycle/)

这是一个例子：

[http://jsfiddle.net/lucuma/NFnCC/](http://jsfiddle.net/lucuma/NFnCC/)

代码非常简单：

```
$('#slideshow').cycle({fx:'fade'})

<div id="sliders">
    <img src="http://s15.postimage.org/wg26u64jf/mask.png" />
  <div id="slideshow">
    <img src="http://cdn.the2012scenario.com/wp-content/uploads/2011/11/sunspot-500x500.jpg" />
    <img src="http://weblogs.marylandweather.com/4526619322_1912218db8.jpg" />
    <img src="http://www.silverstar-academy.com/Blog/wp-content/uploads/2012/03/03-14-12N00184967.jpg" />
    <img src="http://cdn.the2012scenario.com/wp-content/uploads/2011/11/sunspot-500x500.jpg" />
</div>
</div> 
```

​</p>

# c - 在二进制文件中搜索记录

> ID：10965778
> 
> 赞同：0
> 
> 时间：2012-06-10T01:28:01.713
> 
> 标签：c, binaryfiles

我试图通过搜索名称来查找二进制文件中是否存在记录。
似乎我没有做正确的事情，因为我的“如果”返回，无论输入如何，它总是在它不存在时被发现。
调试器状态“如果 = 表达式中的语法错误”，我没有看到它。

```
#ifndef DATA_PLAYER_H_INCLUDED
#define DATA_PLAYER_H_INCLUDED
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct Player
{
    char nome[50];
    int pontos;
}Players;

void ViewPont();
void SearchPont();
#endif // DATA_PLAYER_H_INCLUDED 
```

--

```
#include "DATA_PLAYER.h"

void ViewPont()
{
    Players pl;
    FILE *fp;
    int i, pontos;

    fp = fopen("Pontuacoes.dat", "rb+");

        while((fread(&pl, sizeof(Players),1, fp)) != 0 )
    {
        printf("%s %d\n", pl.nome, pl.pontos);
    }

    fclose(fp);
}

void SearchPont()
{
    char nam[50];
    char ch;
    Players pl;
    FILE * fp;

    fp = fopen("Pontuacoes.dat","rb+");

    printf("\n nome das pont\n");
    fflush(stdout);
    scanf("%s", nam);

    printf("%s", nam);

    while((fread(&pl, sizeof(Players),1, fp)) != 0)
    {
        if((strcmp(pl.nome, nam))==0);
        {
            printf("\nregisto encontrado\n");
        }

    }
fclose(fp);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:37:31.550

傻我…………

```
if(strcmp(pl.nome, nam) ==0); 
```

->; 那个小细节……

```
if(strcmp(pl.nome, nam) ==0) 
```

# javascript - 有没有办法使本机函数可链接？

> ID：10965781
> 
> 赞同：3
> 
> 时间：2012-06-10T01:28:53.573
> 
> 标签：javascript

> **可能重复：**
> [基本对象/函数链接如何在 javascript 中工作？](https://stackoverflow.com/questions/1099628/how-does-basic-object-function-chaining-work-in-javascript)

有没有办法使本机函数可链接？

例如，我想这样做：

```
var ele = document
            .createElement("div")
            .setAttribute("id", "foo")
            .focus(); 
```

而不是这个：

```
var ele = document.createElement("div");
ele.setAttribute("id", "foo");
ele.focus(); 
```

有没有办法做到这一点？如果可以的话，那肯定会为我省去很多打字工作。

# javascript - setInterval 无法正常工作

> ID：10965782
> 
> 赞同：1
> 
> 时间：2012-06-10T01:28:55.607
> 
> 标签：javascript, jquery, setinterval, emoticons

# 这是关于什么的

我目前正在为 Campfire 聊天服务上的表情符号编写脚本，因为它们没有表情符号功能。现在它运行表情符号的速度真的很慢，因为它使用了一个 setInterval，假设在聊天中有新消息时每隔 200 毫秒检查一次。我通过将两个变量“a”和“b”与`var a,b;`. 因此，在第一个 setInterval 中，我将其计时为**150**毫秒。在这里面，我只是给变量“a”提供了聊天的 HTML 值。然后在第二个 setInterval (200) 中，我也给变量“b”提供了 HTML 的值，但这是一个不同的时间，所以现在我在`if`声明，如果不同，我运行函数将符号更改为表情符号。我这样做是为了提高性能。即使在篝火聊天中没有人真正写过东西，它也会检查表情符号，因此无需检查表情符号。

这是完整的功能：

```
var a, b;
setInterval(function() {
    a = $('#chat').html();
    console.warn("Chat HTML has been Scanned");
}, 150);
var t = "0";
setInterval(function() {
    b = $('#chat').html();
    console.warn("Chat got scanned for Change in html.");
    if (emoOn == true) {
        if (t === $('#num12345').text()) {
            $(".participants").after('<div id="emote"><h3><span class="room_actions"><a href="javascript:void(0)" class="on" style="font-weight:bold;">On</a> | <a href="javascript:void(0)" class="off" style="cursor:pointer;">Off</a></span>Emoticons</h3></div>');
            $('#num12345').text("111")
        }
        if (a !== b) {
            turnOn();
            console.log("CHANGE")
        } else {
            turnOn("off");
        }
    }
}, 200)​; 
```

# **问题**

正如您在上面的代码中看到的，我运行了 3 个控制台。在控制台中，我预计会出现“已扫描聊天 HTML”警告，然后会出现“已扫描聊天以查找 html 中的更改”。一直按这个顺序。但相反，“聊天 HTML 已被扫描”警告两次，它就像我想象的那样不起作用。

当一条新消息显示它假设记录“更改”但大多数时候它没有，我认为这是 setIntervals 的问题。看来他们的时机不对。但我真的不想说 JavaScript 导致了这个问题，但我不知道还有什么可能。我也在使用 Chrome。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T01:39:13.443

setInterval 是异步的，因此当您的第一个调用正在等待时，javascript 解释器将继续执行下一项工作（在这种情况下，将 t 设置为“0”，然后是您的第二个 setInterval 调用）。

编辑：我认为问题在于您同时定义了 setInterval 调用，但是 javascript 计时器的精度并不是那么好（请参见此处：[http ://ejohn.org/blog/accuracy-of-javascript-时间/](http://ejohn.org/blog/accuracy-of-javascript-time/) )。

您可以在 setTimeout 之后调用第二个 setInterval 来给自己一点缓冲：

```
var a, b;
setInterval(function() {
    a = $('#chat').html();
    console.warn("Chat HTML has been Scanned");
    var t = "0";
}, 2000);
setTimeout(function(){
    setInterval(function() {
        b = $('#chat').html();
        console.warn("Chat got scanned for Change in html.");
        if (emoOn == true) {
            if (t === $('#num12345').text()) {
                $(".participants").after('<div id="emote"><h3><span class="room_actions"><a href="javascript:void(0)" class="on" style="font-weight:bold;">On</a> | <a href="javascript:void(0)" class="off" style="cursor:pointer;">Off</a></span>Emoticons</h3></div>');
                $('#num12345').text("111")
            }
            if (a !== b) {
                turnOn();
                console.log("CHANGE")
            } else {
                turnOn("off");
            }
        }
    }, 2000)​;

}, 500); 
```

这将在第一个半秒后设置对 setInterval 的第二个调用，但是您可以得到比这更少的调用（任何超过 30 毫秒的时间都应该足够了）。

# java - 用于 android、java 的 websocket 服务器

> ID：10965786
> 
> 赞同：1
> 
> 时间：2012-06-10T01:29:47.757
> 
> 标签：java, android, websocket

我正在为 Android 构建一个简单的 websocket 服务器。（让我们说 3.2 - 我尝试了一些早期的 Android 版本，结果相同）。在 Android 上尝试代码之前，我在 Windows、Linux 上的 Java SE 下对其进行了测试。它适用于 Chrome 和 Firefox 。但是在Android上它不起作用。请查看代码中的注释。

简而言之：

1.  我成功通过握手，浏览器确认连接正常。
2.  我很高兴通过 Websocket 收到来自浏览器的所有消息
3.  我不能发送任何东西：它只是没有到达 javascript 回调。在重试（有时立即）后，浏览器关闭 websocket。

这是代码：

```
//BufferedOutput myout=new BufferedOutput(mysocket.getOutputStream()));

//myout was successfully used for handshaking before

String msg=”I want to send this”;

try {

  myout.write(129);//129=0x81); text frame 0x81=129
  int payloadlen=msg.length();
  myout.write(payloadlen);
  byte[] bts=msg.getBytes(Charset.forName("UTF-8"));
  myout.write(bts,0,payloadlen);
  myout.flush();//after this command client Browser closes websocket
                //firefox also gives error 
}
catch(IOException ee)
 {
 System.out.println("Error sending websocket message"+ee);
 try{myclose();}catch(IOException eio){}
 }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:14:44.740

你在哪里运行这段代码？在 Activity 或 Service 中。

请注意，如果您需要创建一个自定义的 Web 服务器并需要在 Android 上运行它，您应该将其实现为在其自己的线程上运行的服务。

如果您根据android版本在Activity上运行它，主线程不应该（或不能，取决于android版本）在主线程上执行I/O操作。

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T03:57:04.917

我解决了。原因是在 Android 的情况下，我之前通过相同的连接发送了一些东西。这个“东西”虽然是错误的，但不知何故在 Chrome/Firefox 中没有产生任何错误。我花了两天时间对两种情况下的 Wireshark 结果进行逐字节比较：我的 Sun Java Websocket Server 和我的 Android Websocket Server。

# php - 使用 Codeigniter 插入忽略

> ID：10965792
> 
> 赞同：26
> 
> 时间：2012-06-10T01:31:50.920
> 
> 标签：php, codeigniter, activerecord

我正在尝试使用 Codeigniter 和 Active Records 在 MySQL 表中插入几行。

**PHP 代码**

```
$data = array('......');  // some rows of data to insert
$this->db->insert_batch('my_table', $data); 
```

但是，这可能会导致重复的行被插入到表中。`INSERT IGNORE`为了处理重复数据的插入，如果行是重复的，我计划使用命令不插入行。

**问题：**我在 Active Records 中找不到`INSERT IGNORE`等效项，并且不想编辑 Active Record 类。还有其他选择吗？

以下看起来很有趣，但如果我执行以下操作，查询不会运行两次吗？

```
$insert_query = $this->db->insert_batch('my_table', $data);  // QUERY RUNS ONCE
$insert_query = str_replace('INSERT INTO','INSERT IGNORE INTO',$insert_query);
$this->db->query($insert_query); // QUERY RUNS A SECOND TIME 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-06-10T04:01:43.177

不要使用`insert_batch`，因为它实际上运行查询。你要[`insert_string`](http://codeigniter.com/user_guide/database/helpers.html)

```
$insert_query = $this->db->insert_string('my_table', $data);
$insert_query = str_replace('INSERT INTO','INSERT IGNORE INTO',$insert_query);
$this->db->query($insert_query); 
```

**更新**：这不适用于批量查询，一次只能一行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-12-02T08:35:58.870

由于我也遇到了类似的问题，所以我最终选择了像下面这样一个更“优雅”的解决方案。一个完整的 insert_batch 查询，它使用 Rocket 的答案和事务：

```
$this->db->trans_start();
foreach ($items as $item) {
       $insert_query = $this->db->insert_string('table_name', $item);
       $insert_query = str_replace('INSERT INTO', 'INSERT IGNORE INTO', $insert_query);
       $this->db->query($insert_query);
    }
$this->db->trans_complete(); 
```

这也将包装事务中的所有内容，从而产生更快的查询，例如执行 insert_batch()。不如 insert_batch() 快，但比每个条目的单个查询快。我希望它会帮助某人。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-10T14:44:00.977

对于批量上传，您可能需要更多类似的东西：

```
foreach ($data as $data_item) {
    $insert_query = $this->db->insert_string('my_table', $data_item);
    $insert_query = str_replace('INSERT INTO', 'INSERT IGNORE INTO', $insert_query);
    $this->db->query($insert_query);
} 
```

**更新：**使用 dcostalis 的版​​本（在下面的评论中），它会扩展得更好:-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-10-13T18:58:49.090

这基本上是对 Rocket Hazmat 建议的修改，这很棒，但没有考虑到 str_replace 对整个字符串进行操作并可能无意中影响数据的事实。

```
$insert_query = $this->db->insert_string('my_table', $data);
$insert_query = preg_replace('/INSERT INTO/','INSERT IGNORE INTO',$insert_query,1);
$this->db->query($insert_query); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-10T02:16:43.343

使用第二个想法的技术，您可以通过遍历数组并使用以下方法生成查询：

```
$this->db->query($query_string); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-03T16:05:24.137

为此，我制作了这个辅助函数：

```
function insert_batch_string($table='',$data=[],$ignore=false){
    $CI = &get_instance();
    $sql = '';

    if ($table && !empty($data)){
        $rows = [];

        foreach ($data as $row) {
            $insert_string = $CI->db->insert_string($table,$row);
            if(empty($rows) && $sql ==''){
                $sql = substr($insert_string,0,stripos($insert_string,'VALUES'));
            }
            $rows[] = trim(substr($insert_string,stripos($insert_string,'VALUES')+6));
        }

        $sql.=' VALUES '.implode(',',$rows);

        if ($ignore) $sql = str_ireplace('INSERT INTO', 'INSERT IGNORE INTO', $sql);
    }
    return $sql;
} 
```

它可以进行批量插入和批量插入忽略。为避免重复行，您必须在数据库表中为主字段设置唯一键。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-11T20:25:42.587

解决方案 ：

```
$sql = $this->db->set($data)->get_compiled_insert($table);
$sql = str_replace('INSERT INTO', 'INSERT IGNORE INTO', $sql);
$this->db->query($sql); 
```

适用于 codeigniter 3.0.6 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-02-21T11:10:23.087

如果仍然有人在为 insert_batch 使用忽略而苦苦挣扎，

检查这条路径，

```
system/database/DB_query_builder.php 
```

搜索功能

```
protected function _insert_batch 
```

改变

```
INSERT INTO => INSERT IGNORE INTO 
```

晚点再谢我。:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-10T05:57:47.473

不强烈推荐，但这里有一个保留批量插入的技巧（这在 Mysql 中更有效）

```
// try to insert as usual first
$this->db->insert_batch('my_table', $data);

// if it fails resort to IGNORE
if($this->db->_error_message())
{
        $sql = $this->db->last_query();
        $sql = str_replace('INSERT INTO', 'INSERT IGNORE INTO', $sql);
        $this->db->query($sql);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-17T14:17:04.620

添加到文件 DB_query_builder.php

这2个功能

```
public function insert_ignore_batch($table = '', $set = NULL, $escape = NULL) {
    if ($set !== NULL)
    {
        $this->set_insert_batch($set, '', $escape);
    }

    if (count($this->qb_set) === 0)
    {
        // No valid data array. Folds in cases where keys and values did not match up
        return ($this->db_debug) ? $this->display_error('db_must_use_set') : FALSE;
    }

    if ($table === '')
    {
        if ( ! isset($this->qb_from[0]))
        {
            return ($this->db_debug) ? $this->display_error('db_must_set_table') : FALSE;
        }

        $table = $this->qb_from[0];
    }

    // Batch this baby
    $affected_rows = 0;
    for ($i = 0, $total = count($this->qb_set); $i < $total; $i += 100)
    {
        $this->query($this->_insert_ignore_batch($this->protect_identifiers($table, TRUE, $escape, FALSE), $this->qb_keys, array_slice($this->qb_set, $i, 100)));
        $affected_rows += $this->affected_rows();
    }

    $this->_reset_write();
    return $affected_rows;
}

protected function _insert_ignore_batch($table, $keys, $values) {
    return 'INSERT IGNORE INTO '.$table.' ('.implode(', ', $keys).') VALUES '.implode(', ', $values);
} 
```

使用：

```
$this->db->insert_ignore_batch('TableName', $data); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-28T18:45:49.680

我也有同样的问题帮助我的是：

打开：**Codeigniter/system/database/DB_query_builder.php**：

寻找

```
protected function _insert_batch($table, $keys, $values)
    {
        return 'INSERT INTO '.$table.' ('.implode(', ', $keys).') VALUES '.implode(', ', $values);
    } 
```

并替换为：

```
protected function _insert_batch($table, $keys, $values)
{
    return 'INSERT IGNORE INTO '.$table.' ('.implode(', ', $keys).') VALUES '.implode(', ', $values);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-08T08:58:13.550

避免在 codeigniter 中插入重复数据是一项棘手的任务。但是您可以使用自定义库方法以非常简单和准确的方式忽略重复值插入。我在以下位置找到了合适的解决方案： [how-to-avoid-duplicate-data-insertion-in-codeigniter-php](https://gulpoint.com/how-to-avoid-duplicate-data-insertion-in-codeigniter-php/)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-06-10T02:10:03.690

通过在数据库表中为至少一个字段设置唯一键来避免重复行。

# assembly - execve syscall 在 64 位 AMD 上使用 32 位调用约定返回 EFAULT

> ID：10965793
> 
> 赞同：4
> 
> 时间：2012-06-10T01:32:00.400
> 
> 标签：assembly, x86-64

我在汇编中使用手动系统调用。我之前能够使其正常启动，但在删除空值后，我无法让系统调用执行`/bin/date`。这是我用 AT&T 语法编写的代码。

```
.global main
main:
    jmp     two

one:
    # zero rax and rdx
    xor     %rax,%rax 
    mov     %rax,%rdx

    # save string location
    mov     (%rsp),%rbx

    # push argv array onto the stack
    add     $16, %rsp
    push    %rax
    push    %rbx
    # assign argv pointer
    mov     %rsp,%rcx

    # execve call
    mov     $0xb, %al 
    int     $0x80

    # exit on failure
    xor     %rax,%rax
    xor     %rbx,%rbx
    movb    $0x1,%al
    int     $0x80

two:
    # get address of the string
    call    one
    .string "/bin/date" 
```

如果我是对的，`%rbx`应该直接指向命名要启动的程序的字符串。`%rcx`应该指向一个以空结尾的代表程序的指针数组`argv`，并`%rdx`指向环境，所以我把它留空了。当然，`%rax`还有系统调用号（`0x0b`在这种情况下）。

```
(gdb) info registers 
rax            0xb  11
rbx            0x4000a0 4194464
rcx            0x7fffffffe968   140737488349544
rdx            0x0  0

(gdb) x/s $rbx
0x4000a0:    "/bin/date"

(gdb) x/s *$rcx
0x4000a0:    "/bin/date" 
```

尽管如此，系统调用并没有执行程序，而是返回 -14，它转换为`EFAULT`(segfault)。我不确定我忽略了什么，任何帮助将不胜感激。

* * *

因此，敏锐的读者可能已经注意到，上面的代码在 64 位系统上使用了32 位系统调用约定（使用`%ebx`,和朋友）。`int $0x80`这是一个错误，因为仅支持 32 位约定以启用执行 32 位代码。在为 64 位系统编写的代码中，系统调用使用、`%rdi`、`%rsi`、`%rdx`和`%r10`以及`%r8`指令。这是 64 位系统的更正代码（nullfree）：`%r9``syscall`

```
.global main
main:
    jmp     two

one:
    # zero rax and rdx
    xor     %rax,%rax 
    mov     %rax,%rdx

    # save string location, note that %rdi is used instead of %rbx
    pop     %rdi

    # push argv array onto the stack
    add     $16, %rsp
    push    %rax
    push    %rdi
    # assign argv pointer, using %rsi instead of %rcx
    mov     %rsp,%rsi

    # execve call, note that the syscall number is different than in 32bit
    mov     $0x3b, %al 
    syscall

two:
    # get address of the string
    call    one
    .string "/bin/date" 
```

但是，64 位系统支持 32 位系统调用约定*（*因此可以运行 32 位可执行文件），并且我还成功地`execve`在该系统上使用 32 位调用约定执行了其他命令。事实上，我为 x86_64 系统检查的大部分“shellcode”都使用 32 位约定。所以，我的问题仍然存在：**为什么 32 位调用约定在上述代码中不起作用？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T06:12:10.067

execve() 调用有原型

```
int execve(const char *filename,
           char *const argv[],
           char *const envp[]); 
```

请注意，`NULL`通常不传递指针，但如果`envp[]`数组为空，则应将指针传递给作为环境变量结尾的 NULL。同样，`argv[]`不能是 NULL 指针。它必须至少包含`argv[0]`程序名称。通常放置`filename`为第一个元素就足够了。为了完全符合外壳的功能，剥离路径并仅将最后一个组件作为 argv[0] （`date`在您的示例中）传递。

您的示例的等效 C 代码是：

```
char *filename = "/bin/date";
char *argv [2] = {filename, NULL};
char *envp [1] = {NULL};

execve (filename, argv, envp); 
```

也许我错过了它，但看起来你正在做相当于（32 位和 64 位）

```
char *filename = "/bin/date";

execve (filename, NULL);   // note missing third parameter, and malformed argv[] 
```

我不明白你的堆栈操作。推送、推送、推送、系统调用应该足够了。我很困惑为什么你直接操作堆栈指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-17T13:40:24.413

> 为什么 32 位调用约定在上述代码中不起作用？

你是在自问自答：

> 仅支持 32 位约定以启用执行 32 位代码。

您也可以从 64 位代码调用它只是偶然的，内核不会检查。它期望调用源自 32 位代码，并且由于接口仅使用 32 位寄存器，因此零将带有参数的 32 位寄存器扩展为 64 位。这是在[ia32entry.S](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/arch/x86/ia32/ia32entry.S?id=14f6e9532dda399a7b789f744dc045f8865a9e42#n429)中完成的（请记住，64 位模式下的 32 位操作会自动清除寄存器的前 32 位）：

```
/*
 * Emulated IA32 system calls via int 0x80.
 *
 * Arguments:
 * eax  system call number
 * ebx  arg1
 * ecx  arg2
 * edx  arg3
 * esi  arg4
 * edi  arg5
 * ebp  arg6    (note: not saved in the stack frame, should not be touched)
 *
 * Notes:
 * Uses the same stack frame as the x86-64 version.
 * All registers except eax must be saved (but ptrace may violate that).
 * Arguments are zero extended. For system calls that want sign extension and
 * take long arguments a wrapper is needed. Most calls can just be called
 * directly.
 * Assumes it is only called from user space and entered with interrupts off.
 */
[...]    
ia32_do_call:
    /* 32bit syscall -> 64bit C ABI argument conversion */
    movl %edi,%r8d  /* arg5 */
    movl %ebp,%r9d  /* arg6 */
    xchg %ecx,%esi  /* rsi:arg2, rcx:arg4 */
    movl %ebx,%edi  /* arg1 */
    movl %edx,%edx  /* arg3 (zero extension) */
    call *ia32_sys_call_table(,%rax,8) # xxx: rip relative 
```

因此，您不能使用它来传递不适合 32 位的参数。请注意，您的`rcx`值 is `0x7fffffffe968`which 将因此被截断`0xffffe968`并最终导致`EFAULT`.

`rcx`当然是从 设置的`rsp`，典型的 64 位地址空间的堆栈从地址空间的正半部分的顶部向下增长，并且超出了 32 位范围。为了证明这一点，您可以切换到位于低内存中的堆栈。以下代码工作正常：

```
.lcomm stack, 4096
.global main
main:
    movl    $stack, %esp
    jmp     two

one:
    # zero rax and rdx
    xor     %rax,%rax
    mov     %rax,%rdx

    # save string location
    mov     (%rsp),%rbx

    # push argv array onto the stack
    add     $16, %rsp
    push    %rax
    push    %rbx
    # assign argv pointer
    mov     %rsp,%rcx

    # execve call
    mov     $0xb, %al
    int     $0x80

    # exit on failure
    xor     %rax,%rax
    xor     %rbx,%rbx
    movb    $0x1,%al
    int     $0x80

two:
    # get address of the string
    call    one
    .string "/bin/date" 
```

# php - 用 PHP 解析 JSON 并显示内容

> ID：10965795
> 
> 赞同：0
> 
> 时间：2012-06-10T01:32:32.973
> 
> 标签：php, html, json

我在使用此代码时遇到问题

这是我与其他项目一起使用的 PHP ......

```
$gas = file_get_contents('http://api.mygasfeed.com/stations/loadbygeo/47.9494949/120.23423432/reg|mid|pre|diesel/'. $api . '.json?callback=?');

$json_output = json_decode(utf8_decode($gas));

$location= $json_output->geoLocation->city_id; 
```

这是 JSON 结果

```
?({"status":{"error":"NO","code":200,"description":"none","message":"Request    ok"},"geoLocation":{"city_id":"13123","city_long":"Hulunber","region_short":"Nei Mongol","region_long":"Nei Mongol","country_long":"China","country_id":"49","region_id":"6010"},"stations":[]}) 
```

此代码返回空白结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:06:15.983

您需要删除`?(`和`)`。请参阅[WP:JSONP](http://en.wikipedia.org/wiki/JSONP)。

可以使用[`substr()`](http://php.net/substr)它，或者更好的正则表达式来断言和删除所需的垃圾：

```
$json = preg_replace("/ ^[?\w(]+ | [)]+\s*$ /x", "", $jsonp); 
```

会删除任意`callbackFnNames(`而且你奇怪的`?(`伪函数调用。

# c++ - 我的纹理采样器应该如何渲染位图字体/精灵？

> ID：10965797
> 
> 赞同：1
> 
> 时间：2012-06-10T01:33:13.430
> 
> 标签：c++, directx, rendering, sprite, directx-11

我有一个纹理并且很好奇纹理采样器应该是什么来采样精灵纹理？我正在使用 DirectX11，但如果您知道 DX9/10 应该是什么，我相信它是可以转移的。

我试过了

```
AddressU = D3D11_TEXTURE_ADDRESS_WRAP
AddressV = D3D11_TEXTURE_ADDRESS_WRAP
AddressW = D3D11_TEXTURE_ADDRESS_WRAP
ComparisonFunc = D3D11_COMPARISON_NEVER
Filter = D3D11_FILTER_MIN_MAG_MIP_POINT
MaxAnisotropy = 1;
MaxLOD = D3D11_FLOAT32_MAX;
MinLOD = 0;
MipLODBias = 0; 
```

尽管在渲染时，似乎存在伪影，并且看起来并不像应有的那样清晰。

这是人工制品的一个例子。顶部带有浅蓝色背景的文本可以看到伪影（例如，A 和 C）。黑色背景的底部文本是原始图像。

![在此处输入图像描述](../Images/59cb596e6cfe91d4db387f684693a44e.png)

# c++ - 通过继承共享静态受保护资源

> ID：10965798
> 
> 赞同：0
> 
> 时间：2012-06-10T01:33:39.813
> 
> 标签：c++, design-patterns, inheritance

为了尝试替换单例模式和通用的“资源管理器”，我提出了一个解决方案。使资源静态和受保护。该资源在继承类的所有子级之间共享。它有效，但我不确定这是否是一个好方法。这里有一些代码来表达我在做什么（这里的资源是 sf::Texture）：

```
class Foo {
public:
    Foo() {
        if(m_texture == nullptr) {
            //Création et chargement de la texture
            m_texture = std::unique_ptr<sf::Texture>(new sf::Texture());
            m_texture->loadFromFile("...");
        }

    }

    void draw(sf::RenderWindow& window) = 0;

protected:
    static std::unique_ptr<sf::Texture> m_texture = nullptr;

};

class Bar : public Foo {
public:
    Bar()
        : m_sprite(*m_texture) {}

    void draw(sf::RenderWindow& window) {
        window.draw(m_sprite); 
    }

private:
    sf::Sprite m_sprite;
}; 
```

这样我的资源就会被所有的孩子共享，并且只被初始化一次。替换我将通过引用随处携带的单例或资源管理器是否是一个好的解决方案。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:55:56.327

从根本上说你要做的是正确的，一个静态成员将在所有继承的类之间共享（即完全相同），这样你只需要一个可以为你节省大量内存的实例，但这里有几个问题...我假设您使用的是 g++。

您不能在类声明中初始化非常量成员，所以这个。
`static std::unique_ptr<sf::Texture> m_texture = nullptr;`
会产生：
**错误：ISO C++ 禁止非常量静态成员的类内初始化，**
您必须在类的源文件中但在类之外对其进行初始化。 `std::unique_ptr<sf::Texture> Foo::m_texture = nullptr;`

其次，不保存直接访问成员字段，始终使用 setter 和 getter，即使在类函数中也是如此，这使得代码更易于维护。因此，您可以拥有一个名为 getTexture 的静态函数

```
static std::unique_ptr<sf::Texture> getTexture() {
    if(m_texture == nullptr) {
        //Création et chargement de la texture
        m_texture = std::unique_ptr<sf::Texture>(new sf::Texture());
        m_texture->loadFromFile("...");
    }
    return m_texture;
} 
```

虽然 if 语句和函数调用确实会增加开销，但这更易于维护和更安全，并且它会在最后一分钟真正需要时加载纹理。

回到您的问题，Singleton 设计模式非常简单，主要用于节省内存，因为只创建了一个对象实例:) 资源管理器是一个完全不同的野兽，他们的目标是集中所有需要加载的操作和管理资源，将两者结合起来，您将初始化资源管理器的单个实例，然后通过静态成员字段访问它，让所有对象都请求资源，这可能是好是坏，具体取决于您要尝试的内容达到。

软件设计很难。我能给出的最好建议是，在设计系统时问自己这个问题，“我需要编写多少行代码才能引入另一个类似的组件”，你的目标应该是尽可能地减少这种情况，即尽可能多地重用尽可能你已经创建的。

最好的程序员是最懒惰的:) 不，我不是说复制/粘贴，应该禁止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T01:41:31.043

设计看起来很可疑。我看不出与更广泛使用的单例模式（使用函数本地静态实例）相比，使用它有任何优势。您可能最好在定义`m_texture`时使用默认值初始化对象`Texture`（而不是在`Foo`ctor 中）：

```
static std::unique_ptr<sf::Texture> m_texture( new sf::Texture() ); 
```

数据成员非常适合派生类。基类通常用于定义接口。

我建议您将资源管理器类 ( `Foo`) 分开，而不是从它继承，而是调用适当的成员函数来获取`Texture`对象。

# php - 如何让 PHP 5.3.8 读取 .user.ini 文件？

> ID：10965807
> 
> 赞同：3
> 
> 时间：2012-06-10T01:37:57.980
> 
> 标签：php, osx-server

我有一台运行 Apache 2.2.21 和 PHP 5.3.8 的 Mac OS X 服务器

我想在每个目录的基础上设置一些 php.ini 样式指令。根据 PHP[手册页](http://www.php.net/manual/en/configuration.file.per-user.php)，从 PHP 5.3.0 开始，可以通过在目录中放置一个名为“.users.ini”的文件，逐个目录覆盖主 php.ini 运行时配置文件中的指令。包含您想要影响的脚本。

对我来说，这个解决方案比使用 .htaccess 文件中包含的 php_value 和 php_flag 指令更可取，但是我创建的 .user.ini 文件被 PHP 忽略了。

根据 phpinfo()，我的 .user.ini 文件应该每 5 分钟重新缓存一次，并且文件名正确设置为“.user.ini”：

```
user_ini.cache_ttl   300
user_ini.filename    .user.ini 
```

Apache 设置为 AllowOverides，我已经确认通过 .htaccess 文件设置 PHP 指令会正确覆盖我想要控制的 ini 设置。我尝试过的最简单的测试文件是一个 .user.ini 文件，它只包含以下行：

```
display_errors = On 
```

这不起作用，并且使用了系统范围的目录 (=Off)。但是，等效的 .htaccess 文件按预期工作，覆盖系统范围的指令：

```
php_flag display_errors on 
```

我能找到的一条线索是主 php.ini 文件开头的神秘 [PHP]。我在手册中找不到任何提及此节标记的内容，因此我认为可能有必要使用 [PHP] 启动文件。我尝试将此添加到我的 .user.ini 文件的开头，然后重新加载我的页面，又等了五分钟，再次重新加载，以确保我没有加载缓存版本，不幸的是它没有任何区别。

[我发现的另一个线索是前面提到的 PHP手册页](http://nz.php.net/manual/en/configuration.file.per-user.php)中描述如何使用 .user.ini 文件的同样神秘的陈述：“这些文件仅由 CGI/FastCGI SAPI 处理。” 不幸的是，除了我的 phpinfo() 输出中显示“GATEWAY_INTERFACE CGI/1.1”的行之外，我不知道如何确认此条件是否得到满足，因为在我的 phpinfo( ） 输出。我只能假设这个神秘的声明并不重要，只是说明 CGI/FastCGI SAPI 进行处理（无论这意味着什么），而不是警告我需要打开某些东西。如我错了请纠正我。

在同一 .user.ini 手册页的评论中还提到，使用 php-fpm 时无法处理 .user.ini 文件。据我所知，我没有使用它，但如果有简单的检查方法，请告诉我。这确实提出了是否有其他配置选项或模块与该功能冲突并禁用加载 .user.ini 文件的问题。有人知道答案吗？

为了完整起见，我包含了我的配置命令，以防有人看到一些明显的问题，尽管我认为我没有将其从默认值更改：

> '/private/var/tmp/apache_mod_php/apache_mod_php-53.8~2/php/configure' '--prefix=/usr' '--mandir=/usr/share/man' '--infodir=/usr/share/ info' '--disable-dependency-tracking' '--sysconfdir=/private/etc' '--with-apxs2=/usr/sbin/apxs' '--enable-cli' '--with-config-file -path=/etc' '--with-libxml-dir=/usr' '--with-openssl=/usr' '--with-kerberos=/usr' '--with-zlib=/usr' '- -enable-bcmath' '--with-bz2=/usr' '--enable-calendar' '--with-curl=/usr' '--enable-exif' '--enable-ftp' '--with -gd' '--with-jpeg-dir=/BinaryCache/apache_mod_php/apache_mod_php-53.8~2/Root/usr/local' '--with-png-dir=/BinaryCache/apache_mod_php/apache_mod_php-53.8~2/Root /usr/local''--enable-gd-native-ttf''--with-ldap=/usr' '--with-ldap-sasl=/usr' '--enable-mbstring' '--enable-mbregex' '--with-mysql=mysqlnd' '--with- mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-mysql-sock=/var/mysql/mysql.sock' '--without-pear' '--with-iodbc=/usr' '--enable-shmop' '--with-snmp=/usr' '--enable-soap' '--enable-sockets' '--enable-sysvmsg' '--enable-sysvsem' '--enable- sysvshm' '--enable-wddx' '--with-xmlrpc' '--with-iconv-dir=/usr' '--with-xsl=/usr' '--enable-zend-multibyte' '-- enable-zip' '--with-pcre-regex=/usr'--with-mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-mysql-sock=/var/mysql/mysql.sock' '--without-pear' '--with-iodbc =/usr' '--enable-shmop' '--with-snmp=/usr' '--enable-soap' '--enable-sockets' '--enable-sysvmsg' '--enable-sysvsem' ' --enable-sysvshm' '--enable-wddx' '--with-xmlrpc' '--with-iconv-dir=/usr' '--with-xsl=/usr' '--enable-zend-multibyte ' '--enable-zip' '--with-pcre-regex=/usr'--with-mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-mysql-sock=/var/mysql/mysql.sock' '--without-pear' '--with-iodbc =/usr' '--enable-shmop' '--with-snmp=/usr' '--enable-soap' '--enable-sockets' '--enable-sysvmsg' '--enable-sysvsem' ' --enable-sysvshm' '--enable-wddx' '--with-xmlrpc' '--with-iconv-dir=/usr' '--with-xsl=/usr' '--enable-zend-multibyte ' '--enable-zip' '--with-pcre-regex=/usr'--enable-sysvshm' '--enable-wddx' '--with-xmlrpc' '--with-iconv-dir=/usr' '--with-xsl=/usr' '--enable-zend-multibyte ' '--enable-zip' '--with-pcre-regex=/usr'--enable-sysvshm' '--enable-wddx' '--with-xmlrpc' '--with-iconv-dir=/usr' '--with-xsl=/usr' '--enable-zend-multibyte ' '--enable-zip' '--with-pcre-regex=/usr'

（亲爱的读者，既然您已经阅读了这么多，如果您确实看到与上述配置无关的奇怪之处，请随时在此原始帖子的评论中提及）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-11T02:15:41.423

从其他成员的评论中收集了一些线索，我已经能够做足够的研究来正确回答这个问题，以供将来参考。

如 PHP 文档的[一般安装注意事项](http://www.php.net/manual/en/install.general.php)部分所述，PHP 可以通过以下两种方式之一与 Apache 服务器一起运行：

1.  直接在 Apache 中作为 Apache 模块 (mod_php) 也称为 SAPI（服务器应用程序编程接口），或
2.  作为通过 CGI（通用网关接口）或 FastCGI 协议与 Apache 通信的单独可执行文件。

当 PHP 作为 Apache 中的一个模块运行时（Mac OS X 服务器上的默认设置），PHP 无法直接访问文件系统，而 Apache 提供了 PHP 完成其工作所需的一切。这意味着从文件系统中获取最后一分钟的每个目录的配置选项不是一个选项。这意味着 Apache 需要负责将任何每个目录的设置交给 PHP 处理器，因此必须通过 .htaccess 进行设置（Apache 处理并传递给 PHP）

当 PHP 作为自己的进程运行时（通过 CGI 或 FastCGI 与 Apache 通信），PHP 处理器能够在开始处理您的脚本之前直接访问目录结构，因此可以在 per-目录基础，这会影响解析错误的显示（不可能在脚本运行时决定，因为如果脚本不解析，PHP 就无法遵循其中的任何指令）。

所以简短的版本是，如果 PHP 作为 Apache 模块运行，您需要通过 .htaccess 文件设置每个目录的配置指令，或者切换到通用网关接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T01:59:10.160

根据手册再往下一点：

> “如果您使用的是 Apache，请使用 .htaccess 文件以获得相同的效果。”

另外，您是通过 Apache 在 CGI 或 FastCGI 模式下运行 PHP 吗？

# mongodb - 在redis中，如何高效查询大表？

> ID：10965811
> 
> 赞同：3
> 
> 时间：2012-06-10T01:40:25.183
> 
> 标签：mongodb, redis, database, nosql

我有一个有 9 列和 1200 万行的大表，如下所示：

```
col1  col2  col3  col4  col5  col6  col7  col8  col9
12.3  37.4  7771  -675  -23   23.8  78.8  -892  67.5
79.3  -6.3  6061  -555  -24   28.1  77.1  -889  32.6
55.6  -7.3  8888  -921  -56   78.3  22.3  -443  22.9
....  ....  ....  ....  ....  ....  ....  ....  .... 
```

目前该表以 TSV（制表符分隔矢量）格式保存在我的硬盘中，大小为 432MB。我想将表填充到 Redis 中以便最有效地完成这种查询：给定每列的最小值和最大值，计算给定范围内的行数，即

```
(min_col1 <= col1 <= max_col1) &&
(min_col2 <= col2 <= max_col2) &&
(min_col3 <= col3 <= max_col3) &&
(min_col4 <= col4 <= max_col4) &&
(min_col5 <= col5 <= max_col5) &&
(min_col6 <= col6 <= max_col6) &&
(min_col7 <= col7 <= max_col7) &&
(min_col8 <= col8 <= max_col8) &&
(min_col9 <= col9 <= max_col9) 
```

所以我的问题是：

1）如何将表填充到 Redis 中？我应该使用什么样的键/值数据结构？散列、列表、集合、排序集合或其他什么？

2) 填充表后，给定 9 列的 9 最小值和最大值，如何编写查询以获得计数，即落在 9 个范围内的行数？我能想到的一种方法是，首先找出1到9中每个X满足（min_colX <= colX <= max_colX）的行，然后计算它们的交集。但我想这不是最有效的方法。我只想尽快检索计数。

顺便说一句，我尝试过 MongoDB。使用 mongoimport 填充表很简单，但是完成我的查询需要 10 秒，这太慢了，对于我的实时应用程序来说是不可接受的。相比之下，Redis 将数据保存在内存中，所以希望 Redis 可以将查询时间缩短到 1 秒。

供您参考，这是我在 MongoDB 中所做的。

```
mongoimport -u my_username -p my_password -d my_db -c my_coll --type tsv --file my_table.tsv --headerline
use my_db
db.my_coll.ensureIndex({col1:1, col2:1, col3:1, col4:1, col5:1, col6:1, col7:1, col8:1, col9:1 }).
db.my_coll.count({ col1: {$gte: min_col1, $lte: max_col1), col2: {$gte: min_col2, $lte: max_col2}, col3: {$gte: min_col3, $lte: max_col3}, col4: {$gte: min_col4, $lte: max_col4}, col5: {$gte: min_col5, $lte: max_col5}, col6: {$gte: min_col6, $lte: max_col6}, col7: {$gte: min_col7, $lte: max_col7}, col8: {$gte: min_col8, $lte: max_col8}, col9: {$gte: min_col9, $lte: max_col9} }). 
```

我使用 explain() 来确保实际使用了 Btree 索引而不是表扫描。

我还尝试创建一个 ram 磁盘并将我的 MongoDB 数据库保存到 ram 磁盘中，它将查询时间从 10 秒缩短到 9 秒，这对于我的实时应用程序来说远远不能接受。

```
mkdir ~/ram
chmod -R 755 ~/ram
mount -t tmpfs none ~/ram -o size=8192m
mongod --dbpath ~/ram --noprealloc --smallfiles 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T09:04:51.823

NoSQL 领域有（有点）新玩家：[Tarantool](http://tarantool.org/)

它具有内置的二级索引和一些对它们的范围查询的支持。现在，AFAIK，只能进行`>=`查询。

从[用户指南](http://tarantool.org/tarantool_user_guide.html)：

> ### box.select_range(space_no, index_no, limit, key, ...)
> 
> 选择一系列元组，从 key 指定的偏移量开始。密钥可以是多部分的。使用最多限制元组限制选择。如果没有指定键，则从索引中的第一个键开始。

似乎它是这项工作的好工具。但是，它需要一些额外的工作（编写代码来限制这些查询）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T00:18:02.837

使每个`col`排序集，然后`ZRANGEBYSCORE`在每个键上使用，并在应用程序中进行交集和计数。我使用[phpredis](https://github.com/nicolasff/phpredis)，我在内存中做了很多，使用`array_intersect`.

性能问题在 中`ZADD`，您将使用它来创建排序集。

一旦你在 Redis 的内存中创建了所有排序集，剩下的就真的很快了。

* * *

### 创建排序集（Redis 示例）

```
ZADD col1 12.3 line1
ZADD col1 79.3 line2
ZADD col1 55.6 line3

ZADD col2 37.4 line1
ZADD col2 -6.3 line2
ZADD col2 -7.3 line3 
```

### PHP，查找范围，交叉点和计数

```
$COL1 = $redis->zrangebyscore('col1', -10, 10);
$COL2 = $redis->zrangebyscore('col2', 2010, 2012);
$count = count(array_intersect($COL1, $COL2)); 
```

希望有帮助。

# assembly - 来自 C ARM 嵌入式的 ASM 功能

> ID：10965812
> 
> 赞同：5
> 
> 时间：2012-06-10T01:40:34.670
> 
> 标签：assembly, arm

我正在使用 STM32F4 并尝试从 C 内部调用编写 ASM 函数。该函数将在 C 函数内部调用，并且也在中断中。我正在推动和弹出 r4-r7。我还需要做其他事情吗？我的假设是 r0-r3 不需要推动。我还在使用 ASM 函数修改全局变量。我的猜测是这些应该被宣布为 volatile。欢迎任何提示。我还注意到 ARM 概述的 Cortex M4 指令集与 GCC 编译器似乎可用的指令不同。例如，没有回写即 r0,[r1],#4 后增量是非法的。是否有允许哪些 ASM 指令的列表？我假设 STM32F4 使用 thumb2

到目前为止它似乎没有工作，我想知道除了装配错误之外可能出现的问题是什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T17:12:26.373

直到我等了 8 个小时才能回答我自己的问题？无论如何，这就是我得到的，它有效！这个函数有很多事情要做。它基本上是一个正弦波振荡器，将 LUT 用于正弦值。它还使用一个指数值表，这些指数值是使用连接到控制罐的 ADC 分配的。有一个 32 位相位累加器，它创建一个斜坡，然后缩放以进行查找。正弦表（我没有包括太多）是 16 位值被截断为 14 位表大小。我确信在这段代码中有很多优化要做，但至少它让我开始。我在每次通过此函数时生成 16 个正弦波样本@48k，并填充一个缓冲区，该缓冲区（在此函数之外）被传输到 DMA 并通过 Discovery 板载编解码器输出。我必须说它听起来非常流畅。到目前为止，总指令周期似乎在 1200 左右。如果我需要它们，我有多达 56000 个周期，所以这非常好。我遇到困难的一件事是缩放正弦输出。正弦表是 int16_t 值，我希望能够将它乘以一个分数来获得音量控制。到目前为止，我没有尝试过使用 smul、mul 等工作。

```
 @ void get_sine(void)
        .align 2                    @ Align to word boundary
        .global get_sine       @ This makes it a real symbol
        .thumb_func
        .type get_sine STT_FUNC    @ Declare get_sine to be a function.

    get_sine:                  @ Start of function definition
        push    {r4-r7}
        ldr     r0,=pitch       @   get pitch address
        ldr     r1,=expoLUT     @   expo_tab address
        ldr     r7,[r0,#0]      @   pitch val into r7
        lsl     r7,r7,#2
        ldr     r7,[r1,r7]      @   move lookup expo tab value with r7 into r7

        ldr     r2,=sineLUT     @   sine_tab base addy
        ldr     r4,=WaveBuffer  @   storage array addy
        ldr     r5,=writePos    @   get writepos addr
        mov     r6,#0           @   clear increment r6

    outloop:
        ldr     r3,=phase       @   phase address to r3
        ldr     r1,[r3,#0]      @   get current phase
        add     r1,r1,r7        @   add current phase and ph_inc
        str     r1,[r3,#0]      @   store phase
        lsr     r0,r1,#18       @   shift it right by 18 into r0 for sine_tab lookup
        lsl     r0,r0,#2        @   align it
        ldr     r0,[r2,r0]      @   lookup sine val with r0 into r1
        lsl     r1,r0,#16       @   shift to left channel
        add     r0,r0,r1        @   add right channel
        ldr     r1,[r5,#0]      @   get writePos
        push    {r1}            @   push it before align
        lsl     r1,r1,#2        @   align address 4
        str     r0,[r4,r1]      @   store sine to WaveBuffer
        pop     {r1}            @   pop writepos back
        add     r1,r1,#1        @   increment array pointer writepos
        ldr     r3,=1024        @   load BUFFERSIZE compare
        cmp     r1,r3           @   skip if less than BUFFERSIZE
        bne     skip
        mov     r1,#0           @   clr writepos if >=BUFFERSIZE

    skip:
        str     r1,[r5,#0]      @   store writepos value
        add     r6,r6,#1        @   increment loop counter
        ldr     r0,=dataSize    @   get datasize counter addr
        ldr     r1,[r0,#0]      @   get val
        add     r1,r1,#1        @   increment datasize counter
        str     r1,[r0,#0]      @   store counter
        cmp     r6,#16          @   compare with 16 (i=0;i<16;i++)
        bne     outloop
        pop     {r4-r7}
        bx      lr

    .section .rodata
        sineLUT:
        @ Array goes in here. Type can be .byte, .hword or .word
        @ NOTE! No comma at the end of a line! This is important

    .word   0x0000,0x000c,0x0018,0x0024,0x0030,0x003c,0x0048,0x0054
    .word   0x0064,0x0070,0x007c,0x0088,0x0094,0x00a0,0x00ac,0x00bc
    .word   0x00c8,0x00d4,0x00e0,0x00ec,0x00f8,0x0104,0x0114,0x0120
    .word   0x012c,0x0138,0x0144,0x0150,0x015c,0x016c,0x0178,0x0184
    .word   0x0190,0x019c,0x01a8,0x01b4,0x01c4,0x01d0,0x01dc,0x01e8
    .word   0x01f4,0x0200,0x020c,0x021c,0x0228,0x0234,0x0240,0x024c
    .word 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T10:49:22.250

您的问题的一些答案在“ARM 体系结构的过程调用标准”一书中。这是[链接](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ihi0042d/index.html)。

书上说，前四个寄存器 r0-r3（和 FPU 的 s0-15）用于将参数值传递给子程序并从函数返回结果值。它们也可用于在例程中保存中间值（但通常仅在子例程调用之间）。寄存器 r4-r8、r10 和 r11（以及 FPU 的 s16-s31）用于保存例程的局部变量的值。子程序必须保存这些寄存器的内容。

现在关于`volatile`. 我认为是的，您必须使用它来防止编译器优化可以“制动”您的程序逻辑。

关于你的正弦。英语不是我的自然语言，所以我不太明白你需要什么，但如果你需要一些快速和精确的正弦近似作为你的问题的一部分，你可能会对这篇文章感兴趣： http: [//devmaster.net/forums /topic/4648-fast-and-accurate-sinecosine/](http://devmaster.net/forums/topic/4648-fast-and-accurate-sinecosine/) http://www.coranac.com/2009/07/sines/。

最后一个。我几乎完成了 Cortex-M4 的正弦逼近函数。它使用 FPU，大约需要 30 个周期，并在单个浮点范围内带来零错误结果。

# windows-8 - WinRT XAML 中的 RadialGradientBrush 在哪里？

> ID：10965819
> 
> 赞同：6
> 
> 时间：2012-06-10T01:44:07.330
> 
> 标签：windows-8, winrt-xaml

![在此处输入图像描述](../Images/35fd3f9726c054b08afa9edd0970be06.png)

构建 XAML WinRT 应用程序并注意到 RadialGradientBrush 无处可寻？WinRT XAML 中的 RadialGradientBrush 在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T07:59:58.707

不支持径向渐变画笔，它是 xaml 恕我直言的重要组成部分。我希望这会改变。我听说微软觉得画笔不是很地铁，但如果像徽标、游戏等其他方式，它会被大量使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T01:44:08.063

不幸的是，在这个初始版本中，不支持 RadialGrandientBrush。

# c++ - 使用 GradientFill() 函数时无法编译代码

> ID：10965822
> 
> 赞同：0
> 
> 时间：2012-06-10T01:45:02.113
> 
> 标签：c++, visual-studio-2010, winapi, compiler-errors

使用函数 GradientFill(); 时出现编译错误；在我的本机 WinAPI C++ 应用程序中

我究竟做错了什么？我怎样才能让我的代码编译？我正在使用**Microsoft Visual C++ 2010 Express**。

在我的项目中，我链接了正确的库 msimg32.lib 文件。请参阅下面的所有链接文件（项目属性->链接器->输入->附加依赖项）：

> comctl32.lib；kernel32.lib；gdi32.lib；winspool.lib；msimg32.lib；comdlg32.lib；advapi32.lib；shell32.lib；ole32.lib；oleaut32.lib；uuid.lib；odbc32.lib；odbccp32。 lib;%（附加依赖项）

编译错误：

> 1>c:\users\app.cpp(129): 错误 C2064: 术语不计算为采用 6 个参数的函数

导致编译错误的代码：

```
void TransparentCheckbox::verticalGradient(HDC hDC, const RECT& GradientFill, COLORREF rgbTop, COLORREF rgbBottom)
{
    GRADIENT_RECT gradientRect = { 0, 1 };
    TRIVERTEX triVertext[ 2 ] = {
        GradientFill.left - 1,
        GradientFill.top - 1,
        GetRValue(rgbTop) << 8,
        GetGValue(rgbTop) << 8,
        GetBValue(rgbTop) << 8,
        0x0000,                 
        GradientFill.right,
        GradientFill.bottom,
        GetRValue(rgbBottom) << 8,
        GetGValue(rgbBottom) << 8,
        GetBValue(rgbBottom) << 8,
        0x0000
    };

    // Below is line 129
    GradientFill(hDC, triVertext, 2, &gradientRect, 1, GRADIENT_FILL_RECT_V);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T01:54:17.227

你已经声明了一个参数；**GradientFill**为**const RECT&**，然后调用 Windows GradientFill 过程 - 这会导致冲突。我会更改参数的名称，或者您可以将过程调用限定为**::GradientFill**。

# mysql - MySQL 的 count(*) 不能正常工作

> ID：10965823
> 
> 赞同：2
> 
> 时间：2012-06-10T01:45:55.403
> 
> 标签：mysql, count

我想从`game_votes`where `g_id`is equal to 计算所有行`14`，它工作得几乎很好，但如果没有任何记录，`g_id = 14`它仍然会显示`1`在该`cnt`字段中。

这是我的查询：

```
SELECT
     SUM(vote) as vote,
     COUNT(*) as cnt
FROM (`games`)
LEFT JOIN `game_votes`
ON
     `game_votes`.`g_id` = `games`.`id`
WHERE `games`.`id` = '14' 
```

怎么了？我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:51:41.230

检查结果

```
SELECT *
FROM (`games`)
LEFT JOIN `game_votes`
ON
     `game_votes`.`g_id` = `games`.`id`
WHERE `games`.`id` = '14' 
```

你会看到你的 using `LEFT JOIN`（而不是`JOIN`）是原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T02:03:09.260

您得到的计数为 1，因为 COUNT(*) 本质上是计算结果集中的行数。由于您从游戏表中选择 id 为 14 的行并将其加入到 game_votes 表中，因此只要存在 id 为 14 的游戏，您将始终拥有 1 行或更多行，无论如何它是否在您的 game_votes 表中包含任何相应的投票。`game_votes`用 COUNT( . )代替 COUNT(*) `g_id`。如果没有投票，则 g_id 字段将包含空值，并且 COUNT() 将不会在其计算中包含空值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T01:50:55.637

```
SELECT SUM(vote) as vote, COUNT(*) as cnt from games,game_votes where game_votes.g_id=games.id and games.id=14; 
```

这应该工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T01:51:08.170

MySQL`SUM`函数需要一个`GROUP BY`... 参见[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

# python - Python - __iter__ 方法返回 instance.__str__ 和 instance.name ？

> ID：10965824
> 
> 赞同：1
> 
> 时间：2012-06-10T01:46:15.737
> 
> 标签：python, oop, class, iterator

我正在使用[Markana 教程](http://marakana.com/bookshelf/python_fundamentals_tutorial/oop.html#_lab_16)学习 OOP python ，但在使用 Lab 16.8 时遇到了一些问题。（在其他一些麻烦中）我无法`__iter__`正确使用该方法。我的方法如下所示：

```
def __iter__(self):
        for e in self.l_investments:
            yield e 
```

这是我的代码（以及运行它的结果）：[http ://hastebin.com/wayuwakode.py](http://hastebin.com/wayuwakode.py)

这是应该出现的结果：

```
>>> 'GOOG' in p
True 
```

我得到：

```
>>> 'GOOG' in p
False 
```

p 是 Portfolio() 类的一个实例。'GOOG' 是 Investment() 对象实例的 .name 属性。p 包含一个列表和一个 Investment() 实例的字典。

我可以改变我的`__iter__`方法来产生名称：

```
def __iter__(self):
    for e in self.l_investments:
        yield e.name 
```

这修复了它`'GOOG' in p == True`，但它打破了另一个要求：

```
Failed example:
    for stock in p:
        print stock
Expected:
    1000 shares of APPL worth 252730.00
    5000 shares of CSCO worth 118700.00
    500 shares of GOOG worth 245670.00
    2000 shares of MSFT worth 50880.00
Got:
    APPL
    CSCO
    GOOG
    MSFT 
```

如何更改`__iter__`方法（或代码的任何其他部分）以同时满足这两个要求？

我对学习 OOP 的工作原理比解决这个特定问题更感兴趣。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:45:43.527

要为 BrenBarn 的答案添加更多细节——是的，你想覆盖`__contains__`. `x in object`成员资格测试仅使用if`__iter__`未定义`__contains__`。

似乎您希望`__contains__`同时为 Investment 实例和 Investment 名称字符串工作，因为我假设您既想要`'GOOG' in p`又`investment_object_with_GOOG_name in p`想要 return `True`。如果是这种情况，代码应该如下所示：

```
def ___contains___(self, item):
    # checks investment name strings by comparing to dictionary keys
    if item in self.d_investments:
        return True
    # checks investment objects by comparing to dictionary values
    if item in self.d_investments.values():
        return True 
```

请注意，投资对象需要实现合理的比较才能使其正常工作。如果他们没有（看起来他们没有——对象比较使用 ID 而不是属性内容），要么给他们一个比较运算符，要么用这个版本替换上面的后半部分，只在姓名：

```
 # checks investment objects by comparing to dictionary keys
    if isinstance(item, Investment) and item.name in self.d_investments:
        return True 
```

当然，如果您希望成员资格测试仅适用于名称字符串，只需完全删除后半部分。

此外，在查看您的代码之后——您是否有任何理由保留投资组合中的投资列表和字典？任何一个都应该足以作为内部表示。我在上面的代码中使用了字典，但是用一个列表重新实现它很容易——我认为你应该只选择一个，除非你真的需要两者都出于性能或我没有从代码中弄清楚的其他原因.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T01:55:37.943

很难看出您要做什么，但我认为一种可能性是覆盖`__contains__`您的类以返回 True 如果它传递了与股票名称相对应的字符串。请参阅[文档](http://docs.python.org/reference/datamodel.html#object.__contains__)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T05:20:12.513

您可能应该`__eq__`向您的类添加一个函数`Investment`（因为那是您实际返回的内容。在这种情况下，您需要检查是否`self.name == other.name`。您可以这样做，或者您可以`__contains__`按照其他人的建议添加一个函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T01:56:55.647

我认为 Lattyware 有正确的答案，定义`__eq__`使得投资可以等于一个字符串。

# c++ - '.Position' 的左边必须有类/结构/联合

> ID：10965827
> 
> 赞同：1
> 
> 时间：2012-06-10T01:46:51.270
> 
> 标签：c++, pointers, struct, linked-list, typedef

```
typedef struct {
    unsigned short int Position; // << That's what i'm trying to change!
    unsigned short int OldPosition;
} Turn_s;

struct Turn_sMap{
    Turn_s *Turn;
    Turn_sMap *NextTurn;
};

New = new Turn_sMap;
New->Turn = new Turn_s;

New->Turn.Position = 0; // Already tried (New->Turn).Position = 0; 
```

为什么我得到那个编译错误？我没有访问 struct New 中的 struct Turn，它又具有一个名为 Position 的成员吗？或者 typedef 是否会用一些指针疯狂来混淆结构类型？请帮忙，我迷路了！):

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:50:46.233

该声明`Turn_s *Turn;`创建了`Turn`一个指针类型。要访问成员对象，您需要使用`->`运算符。尝试：

```
New->Turn->Position = 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T01:50:03.900

`Turn_sMap::Turn`是一个指针。您需要取消引用它：

```
New->Turn->Position = 0; 
```

此外，您不应该`typedef struct`在 C++ 中使用。只需声明结构：

```
struct Turn_s {
    unsigned short int Position; // << That's what i'm trying to change!
    unsigned short int OldPosition;
};

Turn_s a;
foo(a); 
```

# javascript - 时间正则表达式

> ID：10965828
> 
> 赞同：0
> 
> 时间：2012-06-10T01:46:51.663
> 
> 标签：javascript, regex

24H时间的javascript正则表达式是什么？如：

18:30

我需要将正则表达式字符串分配给要反复使用的变量。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T01:48:57.523

采用

> “（[01]？[0-9]|2[0-3]）：[0-5][0-9]”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T01:53:25.463

您可以使用

```
^([01]\d|2[0-3]):?([0-5]\d)$ 
```

它需要一个 0 或 1，后跟任何数字（00 到 10 小时）或 2 后跟 0、1、2、3（20 到 23 小时），一个可选的冒号（取出`?`以使其成为必需）然后是 0-5，后跟任意数字（分钟）。

# c# - 如何在 WinRT 中反序列化 JSON？

> ID：10965829
> 
> 赞同：18
> 
> 时间：2012-06-10T01:47:03.553
> 
> 标签：c#, winrt-xaml

如何获取一个对象并将其转换为 JSON 字符串，然后从字符串返回到该对象，特别是在我的 Windows 8 Metro 应用程序的 WinRT 中？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-10T01:47:04.473

像这样：

```
using System.IO;
using System.Runtime.Serialization.Json;
using System.Text;

public static T Deserialize<T>(string json)
{
    var _Bytes = Encoding.Unicode.GetBytes(json);
    using (MemoryStream _Stream = new MemoryStream(_Bytes))
    {
        var _Serializer = new DataContractJsonSerializer(typeof(T));
        return (T)_Serializer.ReadObject(_Stream);
    }
}

public static string Serialize(object instance)
{
    using (MemoryStream _Stream = new MemoryStream())
    {
        var _Serializer = new DataContractJsonSerializer(instance.GetType());
        _Serializer.WriteObject(_Stream, instance);
        _Stream.Position = 0;
        using (StreamReader _Reader = new StreamReader(_Stream)) 
        { return _Reader.ReadToEnd(); }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-08T17:10:32.623

[先用http://json2csharp.com/](http://json2csharp.com/)生成C#类， 然后用[http://james.newtonking.com/pages/json-net.aspx](http://james.newtonking.com/pages/json-net.aspx)进行解析

我的用户类目前看起来像这样：

```
public class User
{
    public string id { get; set; }
    public string username { get; set; }
    public string full_name { get; set; }
    public string profile_picture { get; set; }
    public string bio { get; set; }
    public string website { get; set; }
    public Counts counts { get; set; }

    public static User SingleFromJSON(string jsonString)
    {
        return JsonConvert.DeserializeObject<SingleUser>(jsonString).data;
    }

    public static User MultipleFromJSON(string jsonString)
    {
        return JsonConvert.DeserializeObject<SingleUser>(jsonString).data;
    }

    private class SingleUser
    {
        public User data { get; set; }
    }

    private class MultipleUsers
    {
        public List<User> data { get; set; }
    }
}

public class Counts
{
    public int media { get; set; }
    public int follows { get; set; }
    public int followed_by { get; set; }
} 
```

超级简单：D

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-28T21:58:57.877

OP 要求提供与 Windows 8 上的 Metro 应用程序相关的答案，但是在对 WinRT 的序列化/反序列化 json 进行基本搜索时会出现这个问题，所以我为那些正在寻找更现代的人添加了这个答案方法。

现代 WinRT 具有针对这一挑战的内置处理程序，因此无需使用 JSON.net

使用[`JsonObject`](https://docs.microsoft.com/en-us/uwp/api/windows.data.json.jsonobject)自`Windows.Data.Json`

用于序列化使用[`Parse`](https://docs.microsoft.com/en-us/uwp/api/windows.data.json.jsonobject.parse#Windows_Data_Json_JsonObject_Parse_System_String_)或[`TryParse`](https://docs.microsoft.com/en-us/uwp/api/windows.data.json.jsonobject.tryparse#Windows_Data_Json_JsonObject_TryParse_System_String_Windows_Data_Json_JsonObject__).

对于反序列化但仍为 JSON 格式，请使用[`Stringify`](https://docs.microsoft.com/en-us/uwp/api/windows.data.json.jsonobject.stringify).

# android - Android Developers LinearLayout - 我有一个重复列表，想要在屏幕底部有 1 个按钮，我每行一直有一个按钮

> ID：10965831
> 
> 赞同：1
> 
> 时间：2012-06-10T01:47:28.440
> 
> 标签：android, xml, layout, button, android-linearlayout

我正在尝试一项可能应该很简单的任务..我希望屏幕底部有一个按钮（最好是浮动的），而我在其上方有一个可滚动列表（我可以在教程中使用简单的列表视图和按钮）。但是，我的列表是一个线性布局，我用一个 SimpleCursorAdapter 和一个 viewBinder 填充。由于我使用的是此 LinearLayout，因此每个行项目都会有一个按钮，而不是屏幕底部的一个按钮。我试过用表格布局、相对布局、使用两个线性布局等来包装它。每次我每行都有一个按钮。这是因为我使用游标适配器获取数据并将其填充到列表视图中的方式吗？我需要使用“合并”吗 在我的 xml 文件中？有没有办法制作两个xml文件然后同时调用它们？我是否需要切换到 ListView 或其他显示数据的方式？这是我尝试自己开始完成的第一个应用程序，所以其中一些东西让我很吃惊。我将包含我的 LinearLayout 代码，请注意，这只是没有添加额外按钮的列表（我删除了所有失败的尝试）。因此，我希望修改下面的代码以包含一个始终浮动在屏幕底部的按钮。

```
<LinearLayout android:id="@+id/LinearLayout01"
          android:layout_width="290dp"
          android:layout_height="fill_parent"
          xmlns:android="http://schemas.android.com/apk/res/android"
          android:hapticFeedbackEnabled="true">

    <Button
        android:id="@+id/BtnToClick"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="myClickHandler"
        android:drawableLeft="@+drawable/android_button"
        android:gravity="left|center_vertical" 
        android:background="@android:color/transparent"
        android:hapticFeedbackEnabled="true"
        android:layout_weight=".1">
    </Button>

    <TextView android:text=""
        android:id="@+id/tvViewRow"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="gone"> 
     </TextView>

     <TextView android:text="@+id/text11"
        android:id="@+id/text11"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="gone"> 
     </TextView>

     <TextView
        android:id="@+id/text5" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="3dip" 
        android:gravity="left|center_vertical" 
        android:layout_weight=".20"/> 

    <TextView
        android:id="@+id/text9"
        android:layout_column="5" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="3dip"  
        android:gravity="center|center_vertical" 
        android:layout_weight=".1"/>
    <TextView
        android:id="@+id/text10" 
        android:layout_column="6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="3dip" 
        android:gravity="left|center_vertical" 
        android:layout_weight=".15"/>

    <TextView
        android:id="@+id/text12" 
        android:layout_column="8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="gone"
        android:padding="3dip" 
        android:gravity="left|center_vertical" />

     <Button
        android:id="@+id/BtnToClick2"
         android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="myClickHandler3"
        android:gravity="center|center_vertical" 
        android:background="@+drawable/coup0a"
        android:hapticFeedbackEnabled="true"
        >
     </Button> 
```

提前致谢！-乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:59:58.100

您需要根据需要将按钮添加为页脚或页眉。您可以尝试此代码。R.layout.header 和页脚是您必须定义的单独的 xml 布局文件。

```
View header =  inflater.inflate(R.layout.header,null);  
View footer =  inflater.inflate(R.layout.footer,null);   
addHeaderView(header); 
addFooterView(footer); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:02:22.297

您绝对应该使用列表视图来完成这项工作。列表视图针对显示许多条目进行了高度优化。只需让您的活动从 ListActivity 扩展并创建一个布局 xml 文件，其中包含一个 ID 为“@android:id/list”的 listview 小部件，listview 活动将自动连接到该列表。您也可以在布局中自由放置其他小部件。这是一个示例布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:orientation="vertical"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent">
    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        />
    <Button
        android:id="@+id/chooseOther"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/add_fav"/>
</LinearLayout> 
```

即使您有很长的项目列表，它也有一个始终位于屏幕底部的按钮列表。

# mercurial - Mercurial中的git checkout removedFile？

> ID：10965832
> 
> 赞同：1
> 
> 时间：2012-06-10T01:47:43.027
> 
> 标签：mercurial

命令的 Mercurial 等价物是`git checkout removedFile`什么？单词removedFile 表示通过basic-shell `rm`-command 而不是`git rm`-command 删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:03:38.417

```
hg revert removedFile 
```

应该把你丢失的文件放回去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:13:51.723

对你有什么作用`git checkout removedFile`？对我来说，它给出了一个很好的、明智的错误：

```
ry4an@four:~$ git init test
Initialized empty Git repository in /home/ry4an/test/.git/
ry4an@four:~$ cd test/
ry4an@four:~/test$ echo this > file
ry4an@four:~/test$ git add file
ry4an@four:~/test$ git commit
[master (root-commit) 1b017c5] file added
 1 file changed, 1 insertion(+)
 create mode 100644 file
ry4an@four:~/test$ git rm file
rm 'file'
ry4an@four:~/test$ git commit
[master ec695d4] dsdfsdf
 1 file changed, 1 deletion(-)
 delete mode 100644 file
ry4an@four:~/test$ git checkout file
error: pathspec 'file' did not match any file(s) known to git. 
```

如果您询问如何查看已删除文件的内容，这`hg cat`是一个很好的命令，您可以使用`hg log removedFile`.

# ontology - DL查询以获取个人与给定个人的对象关系 - 不是一些（OWL）

> ID：10965849
> 
> 赞同：1
> 
> 时间：2012-06-10T01:52:12.483
> 
> 标签：ontology, owl, dlquery

请解释如何在 DL 查询（不使用一些量词）中沿着某个对象属性获取与给定个体集有关系的个体集

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T22:04:25.027

也许是这样的：

```
object_property some ({ Individual1 } or ... or { IndividualN }) 
```

（你的问题很难理解，所以我在这里猜测。）

# c# - 使用 FlowDocumentPageViewer 时确定内联元素的页码？

> ID：10965850
> 
> 赞同：1
> 
> 时间：2012-06-10T01:53:13.457
> 
> 标签：c#, wpf, flowdocument

我的应用程序中有一个 FlowDocumentPageViewer 控件，它以编程方式在 FlowDocument 中的每个块和内联元素中前进（这是因为它是打字应用程序的一部分，这样做会提供视觉提示，告诉用户输入什么内容）。每次更改我关注的内联元素时，我都想检查内联元素在哪个页面上，如果它不在当前页面上，则导航到它所在的页面。

如果这是不可能的，请提出任何替代解决方案。

此外，如果重要的话，我正在处理的每个内联元素都是一个 Run 元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T05:18:52.273

你只是想自动导航到页面吗？如果是这样，我们不需要知道页码并且应该能够只使用BringIntoView？我假设您有对该块的引用？

以下代码导航到按下按钮时第 301 个块所在的页面

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        this.Loaded += new RoutedEventHandler(MainWindow_Loaded);
    }

    void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        FlowDocument fd = new FlowDocument();

        for (int i = 0; i < 1000; i++)
        {
            fd.Blocks.Add(new Paragraph(new Run(i.ToString())));
        }

        view.Document = fd;
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        (view.Document as FlowDocument) .Blocks.Skip(300).First().BringIntoView();
    }

} 
```

如果您真的非常想要页码，您可以这样做：

```
var previousPage = view.MasterPageNumber;

(view.Document as FlowDocument) .Blocks.Skip(300).First().BringIntoView();

var pageOfControl = view.MasterPageNumber;

view.GoToPage(previousPage); 
```

它在测试应用程序中没有闪烁或任何东西哈哈！我的朋友不喜欢这样，所以他建议：

```
var ddp = (DynamicDocumentPaginator)view.Document.DocumentPaginator;
var position = ddp.GetObjectPosition(document.Blocks.Skip(300).First());
var page = ddp.GetPageNumber(position); 
```

请注意，它是 0 索引，而不是从 1 开始的“lol”方法

# c# - C#在win XP中获取输入文件的完整路径

> ID：10965851
> 
> 赞同：0
> 
> 时间：2012-06-10T01:53:17.190
> 
> 标签：c#

我写了一个简单的控制台工具，它读取一个文件，然后写出一些东西。我打算只拖放文件，然后在与输入文件相同的目录中弹出输出。

所有的测试都有效，当我从命令行调用它时，一切都按预期进行。但是，当我尝试在资源管理器中拖放它时，没有创建任何文件。

我在系统中进行了搜索，发现它们都被转储到了我的用户文件夹下的 Documents and Settings 中，当我打印出完整路径时，就是它所说的。

这很奇怪。不会`Path.GetFullPath`返回输入文件的绝对路径？相反，它看起来只是将该用户目录路径与输入的文件名组合在一起。

编辑：这是代码。我觉得我在某个地方犯了一个逻辑错误，但似乎看不到它。

```
filename = System.IO.Path.GetFileName(args[i]);
abspath = Path.GetFullPath(filename);
dirpath = Path.GetDirectoryName(abspath);
....
Console.WriteLine(dirpath); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:00:42.203

[Path.GetFullPath](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)应该返回您传入的路径字符串的绝对路径。

[Path.GetFileName(string path)](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx)只返回您传入的文件的文件名和扩展名。例如，`System.IO.Path.GetFileName("C:\SomeDirectory\Test.txt");`只返回“Test.txt”。您需要使用[Path.GetDirectoryName](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname)来获取输入文件的路径，如下所示：

```
string inputDirectory = System.IO.Path.GetDirectoryName(args[i]); 
```

或者，您可以使用[FileInfo](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)类来检索有关输入文件的更多信息。例如：

```
// Assuming args[i] = "C:\SomeDirectory\Test.txt"
FileInfo inputFile = new FileInfo(args[i]);
string inputDirectory = inputFile.DirectoryName; // "C:\SomeDirectory"
string inputFileName = inputFile.Name; // "Test.txt"
string fullInputFile = inputFile.FullName; // "C:\SomeDirectory\Test.txt" 
```

# windows-8 - 如何在 WinRT XAML 中拥有 DesignTime 数据？

> ID：10965853
> 
> 赞同：11
> 
> 时间：2012-06-10T01:53:32.707
> 
> 标签：windows-8, winrt-xaml

如何在 WinRT XAML 中获取 DesignTime 数据，以便设计器显示示例数据？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-10T01:53:33.080

很简单。

像这样创建一个模型：

```
public class Fruit 
{
    public string Name { get; set; }
} 
```

像这样创建一个基础 ViewModel：

```
public class BaseViewModel 
{
    public ObservableCollection<Fruit> Fruits { get; set; }
} 
```

像这样创建一个真正的 ViewModel：

```
public class RealViewModel : BaseViewModel
{
    public RealViewModel()
    {
        if (!Windows.ApplicationModel.DesignMode.DesignModeEnabled)
            LoadData();
    }

    public void LoadData()
    {
        // TODO: load from service
    }
} 
```

像这样创建一个假数据 ViewModel：

```
public class FakeViewModel : BaseViewModel
{
    public FakeViewModel()
    {
        this.Fruits = new ObservableCollection<Fruit>
        {
            new Fruit{ Name = "Blueberry"},
            new Fruit{ Name = "Apple"},
            new Fruit{ Name = "Banana"},
            new Fruit{ Name = "Orange"},
            new Fruit{ Name = "Strawberry"},
            new Fruit{ Name = "Mango"},
            new Fruit{ Name = "Kiwi"},
            new Fruit{ Name = "Rasberry"},
            new Fruit{ Name = "Blueberry"},
        };
    }
} 
```

在您的 XAML 中执行此操作：

```
<Page.DataContext>
    <local:RealViewModel />
</Page.DataContext>

<d:Page.DataContext>
    <local:FakeViewModel />
</d:Page.DataContext> 
```

玩得开心！

PS：您也可以尝试使用[d:DesignData](http://msdn.microsoft.com/en-us/library/ff602279%28v=VS.95%29.aspx)。这种方法也有效。我觉得这不是那么直截了当。最后，如何做到这一点取决于您。无论哪种方式，都不要错过 DeisgnTime 数据！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-03T02:43:08.023

这是 d:DesignInstance 示例：

我还将使用 Jerry 的 Fruit 类，但我不会在这里使用 MVVM，因为您不需要它来使其工作。

基本上，我们需要创建我们想要拥有设计数据的数据模型类（例如，ViewModel 或模型）（例如，在这种情况下，我创建了一个子类，但您不需要）。

```
public class Fruit
{
    public string Name { get; set; }
}

public class SampleFruit : Fruit
{
    public SampleFruit()
    {
        Name = "Orange (Sample)";
    }
} 
```

然后在我们的 XAML 中，我们可以使用 d:DataContext 来绑定子类。

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}"
      DataContext="{Binding}"
      d:DataContext="{Binding Source={d:DesignInstance Type=local:SampleFruit, IsDesignTimeCreatable=True}}">
    <TextBlock Text="{Binding Name}"
               HorizontalAlignment="Center" VerticalAlignment="Center"
               FontSize="42"/>
</Grid> 
```

请注意这一行：

```
d:DataContext="{Binding Source={d:DesignInstance Type=local:SampleFruit, IsDesignTimeCreatable=True}}" 
```

现在您应该在 Visual Studio Designer 和 Blend 上看到您的设计时数据。

![在此处输入图像描述](../Images/31bf1211dbbeecd11588c285d89e9ff9.png) ![在此处输入图像描述](../Images/77b11fa2e921a6b9ad8b186af8ebc588.png)

PS 在 Blend 2013 中，还有一个数据选项卡可以让您创建示例数据。

# ruby-on-rails - 正则表达式仅从字符串中删除开始和结束 html 标记？

> ID：10965855
> 
> 赞同：0
> 
> 时间：2012-06-10T01:54:07.460
> 
> 标签：ruby-on-rails, ruby, regex

`<div><p>`例如，我想`</p></div>`从下面的字符串中删除。正则表达式应该能够从字符串的开头和结尾删除任意数量的标签。

```
<div><p>text to <span class="test">test</span> the selection on.
Kibology for <b>all</b><br>. All <i>for</i> Kibology.</p></div> 
```

我一直在修补 rubular.com，但没有成功。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:47:40.017

```
 def remove_html_end_tags(html_str)
   html_str.match(/\<(.+)\>(?!\W*\<)(.+)\<\/\1\>/m)[2]
 end 
```

我没有看到 Alan Moore 在下面指出的**\<(.+)>消耗多个开始标签的问题，这很奇怪，因为我同意这是不正确的。**它应该更改为**\<([^>\<]+)>**或类似于消除歧义的内容。

```
 def remove_html_end_tags(html_str)
    html_str.match(/\<([^\>\<]+)\>(?!\W*?\<)(.+)\<\/\1\>/m)[2]
 end 
```

这个想法是您想要捕获在遇到的第一个标签的打开/关闭之间没有立即被另一个标签跟随的所有内容，即使之间有空格。

因为我不知道如何（积极向前看）说给我第一个键，它的右尖括号后跟至少一个单词字符，然后是下一个左尖括号，我说

```
\>(?!\W*\<) 
```

在下一个左尖括号之前找到不包含所有非单词字符的右尖括号。

一旦你确定了具有该属性的键，找到它的关闭伙伴并返回它们之间的东西。

这是另一种方法。查找向前扫描的标签并删除第一个 n。会因相同类型的嵌套标签而崩溃，但我不会将这种方法用于任何实际工作。

```
def remove_first_n_html_tags(html_str, skip_count=0)
  matches = []
  tags = html_str.scan(/\<([\w\s\_\-\d\"\'\=]+)\>/).flatten  
  tags.each do |tag|
   close_tag = "\/%s" % tag.split(/\s+/).first
   match_str = "<#{tag}>(.+)<#{close_tag}>"
   match = html_str.match(/#{match_str}/m) 
   matches << match if match
 end
 matches[skip_count] 
```

结尾

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T17:02:45.087

还是涉及到一些编程：

```
str = '<div><p>text to <span class="test">test</span> the selection on.
Kibology for <b>all</b><br>. All <i>for</i> Kibology.</p></div>'

while (m = /\A<.+?>/.match(str)) && str.end_with?('</' + m[0][1..-1])
  str = str[m[0].size..-(m[0].size + 2)]
end 
```

邪神你在外面吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-10T05:39:16.340

I am going to go ahead and answer my own question. Below is the programmatic route:

The input string goes into the first loop as an array in order to remove the front tags. The resulting string is looped through in reverse order in order to remove the end tags. The string is then reversed in order to put it in the correct order.

```
def remove_html_end_tags(html_str)

 str_no_start_tag = ''
 str_no_start_and_end_tag = ''

  a = html_str.split("")

     i= 0 
     is_text = false
     while i <= (a.length - 1)
       if (a[i] == '<') && !is_text
         while (a[i] != '>')
           i+= 1
         end 
          i+=1
       else
         is_text = true
          str_no_start_tag << a[i] 
         i+=1
       end
     end

    a = str_no_start_tag.split("")

    i= a.length - 1 
    is_text = false
    while i >= 0
      if (a[i] == '>') && !is_text
        while (a[i] != '<')
           i-= 1
        end 
        i-=1
      else
        is_text = true
        str_no_start_and_end_tag << a[i] 
        i-=1
      end
   end 

  str_no_start_and_end_tag.reverse!

 end 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-10T02:33:40.200

`(?:\<div.*?\>\<p.*?\>)|(?:\<\/p\>\<\/div\>)`是你需要的表达方式。但这并不能检查每种情况......如果您尝试解析任何可能的标签组合，您可能需要查看其他解析方式。

例如，这个表达式不允许 div 和 p 标签之间有任何空格。因此，如果您想允许这样做，您可以在标签`\s*`的各个`\>\<`部分之间添加，如下所示`(?:\<div.*?\>\s*\<p.*?\>)|(?:\<\/p\>\s*\<\/div\>)`：

div 标签和 p 标签应该是小写的，因为表达式是写的。因此，您可能想找出一种方法来检查每个字母的大写或小写字母，以便也可以找到 Div 或 dIV。

使用[gskinner 的 RegEx 工具](http://gskinner.com/RegExr/)来测试和学习正则表达式。

所以你最终的 ruby​​ 代码应该是这样的：

```
# Ruby sample for showing the use of regular expressions

str = "<div><p>text to <span class=\"test\">test</span> the selection on.
Kibology for <b>all</b><br>. All <i>for</i> Kibology.</p></div>"

puts 'Before Reguar Expression: "', str, '"'

str.gsub!(/(?:\<div.*?\>\s*\<p.*?\>)|(?:\<\/p\>\s*\<\/div\>)/, "")

puts 'After Regular Expression', str

system("pause") 
```

编辑：`div*?`根据评论中的建议替换`div.*?`和替换。编辑：这个答案不允许任何标签集，只是问题第一行中列出的两个标签。`p*?``p.*?`

# php - opencart中的自定义/自己的视图

> ID：10965857
> 
> 赞同：-1
> 
> 时间：2012-06-10T01:54:26.850
> 
> 标签：php, opencart

我正在尝试开发一个电子商务应用程序。我将应用程序的视图页面作为独立的 HTML 页面（根据需要使用图像和样式整齐地格式化），并且我正在尝试将它们插入电子商务包中。我的电子商务应用程序有一个简单的工作流程 -> 客户将产品添加到购物车并结帐，然后确认订单。

现在我的问题是如何将那些现有的视图页面添加到 opencart？我试图从控制器加载视图，但错误提示找不到页面。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:00:51.470

大多数电子商务解决方案都是基于 php 的，因为您很可能将数据库与您的产品结合在一起。除非您想从头开始开发自己的解决方案，否则使用现有平台并创建自定义模板会更容易。
我发现 zencart 是最容易为其创建自定义模板的，但这只是我个人的看法

# java - ActionBarSherlock - 贯穿整个项目的一致选项卡 - 有没有简单的方法来做到这一点？

> ID：10965863
> 
> 赞同：1
> 
> 时间：2012-06-10T01:55:47.247
> 
> 标签：java, android, tabs, android-fragments, actionbarsherlock

我希望有 3 或 4 个选项卡，每个选项卡都会导致不同的活动。但是，到目前为止，我似乎必须在每个单独的活动中设置选项卡。

是否有一种简单的方法可以在操作栏下声明一组选项卡，并保持状态一致，即使在活动切换时也是如此？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:39:02.593

使用[`Fragment`s](http://developer.android.com/guide/topics/fundamentals/fragments.html)。这将需要一个活动和`n`片段（`n`选项卡的数量在哪里）。

Jake Wharton 提供了一些[示例代码](https://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/FragmentTabs.java)来说明如何实现此行为。

# windows-8 - 如何在 Winrt 应用程序中创建屏幕截图？

> ID：10965868
> 
> 赞同：2
> 
> 时间：2012-06-10T01:57:21.287
> 
> 标签：windows-8, winrt-xaml

在我的 Metro 应用程序中，如何以编程方式创建屏幕截图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:57:21.690

不幸的是，在这个版本中，必要的 WriteableBitmap.Render 方法还没有实现。没有这个，截图是不可能的。

# ajax - 无法让 Isotope 与 AJAX 一起工作（代码示例）

> ID：10965872
> 
> 赞同：5
> 
> 时间：2012-06-10T01:58:11.733
> 
> 标签：ajax, jquery, jquery-isotope

我正在尝试整合同位素，但我在让它与 ajax 一起工作时遇到了问题。

这是代码：

```
<script type="text/javascript">

var currentPage = 1;

$(function(){
    var getUrl = 'loadMovies.php';
    var getQuery = 'genrefilter='+movieSelection.elements["genreFilter"].value;
    getQuery += '&yearfilter='+movieSelection.elements["yearFilter"].value;
    getQuery += '&titlesort='+movieSelection.elements["titleSort"].value;
    getQuery += '&ratingsort='+movieSelection.elements["ratingSort"].value;
    getQuery += '&yearsort='+movieSelection.elements["yearSort"].value;
    getQuery += '&runtimesort='+movieSelection.elements["runtimeSort"].value;
    getQuery += '&currentPage='+currentPage;

    var $container = $('#movieBox');
    //$container.isotope({itemSelector: '.movie'});

    $.ajaxSetup({cache:false});  
    var ajax_load = "<img class='loading' src='images/load.gif' alt='loading...' />";

    //$("#genreFilter").change(function(){$container.isotope('insert', ajax_load).load(getUrl, getQuery);});

    $("#genreFilter").change(function(){$('#movieBox').html(ajax_load).load(getUrl, getQuery);});
}); 
```

HTML 只是“”

注释掉同位素线后，我实际上得到了按预期显示的 div，但由于我无法弄清楚如何在同位素线中工作，所以我无法让它工作。

我正在尝试将同位素与“插入”方法相结合，我可以在没有 ajax 的情况下工作。

摘自：http: [//isotope.metafizzy.co/docs/adding-items.html](http://isotope.metafizzy.co/docs/adding-items.html)

* * *

"插入方法

更有可能的是，您想使用 insert 方法，该方法会完成 addItems 遗漏的所有操作。insert 会将内容附加到容器中，过滤新内容，对所有内容进行排序，然后触发重新布局，以便正确布置所有项目元素。

```
var $newItems = $('<div class="item" /><div class="item" /><div class="item" />');
$('#container').isotope( 'insert', $newItems ); 
```

* * *

最后一行是我需要与 ajax 行集成的内容，但我只是看不到可以放置它的位置。我尝试了几种方法，其中一种显示在注释掉的行中。

任何人都可以看到问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T01:04:20.163

让它像这样工作：

```
$(function(){

        var $container = $('#movieBox');

        $container.isotope({
            itemSelector: '.movie'
        });

        $.ajaxSetup({cache:false});  
        var ajax_load = "<img class='loading' src='images/load.gif' alt='loading...' />";

        $('#genreFilter').change(function(){

$('#genreFilter').change(function(){

            var getQuery = 'loadMovies.php?';
            getQuery += 'genrefilter='+movieSelection.elements["genreFilter"].value;
            getQuery += '&yearfilter='+movieSelection.elements["yearFilter"].value;
            getQuery += '&titlesort='+movieSelection.elements["titleSort"].value;
            getQuery += '&ratingsort='+movieSelection.elements["ratingSort"].value;
            getQuery += '&yearsort='+movieSelection.elements["yearSort"].value;
            getQuery += '&runtimesort='+movieSelection.elements["runtimeSort"].value;
            getQuery += '&currentPage='+currentPage;

            return $.ajax({
                cache:false,
                url: getQuery,
                success: function(data){$container.isotope('insert', data)}
                });
            });

    }); 
```

# android - 错误：尝试在“设备就绪”之前调用 cordova.exec()。忽略

> ID：10965876
> 
> 赞同：5
> 
> 时间：2012-06-10T01:59:21.847
> 
> 标签：android, jquery-mobile, cordova

我正在尝试“PhoneGap”（1.7.0）一个 jQuery Mobile 应用程序（1.1.0）我必须创建一个 Android 应用程序。但是，我不断收到以下警报消息。

```
ERROR: Attempting to call cordova.exec() before 'deviceready'. Ignoring. 
```

看起来好像我更改了页面（例如将 index.1.htm 更改为 index.2.htm）

我没有在我的应用程序中调用 Cordova 函数 - 它是纯 JQM。

任何想法是什么问题。或者，如果做不到这一点，有人知道为什么在 $.ajax 请求期间可能会调用 cordova.exec() 吗？

我在虚拟设备/模拟器中运行 Android 4.0.3 下的应用程序。也尝试在 Android 2.1 和 2.33 模拟器设备上运行，得到同样的错误！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-12T01:11:55.220

确保您使用的是适当版本的 cordova-1.x.0.js（或 phonegap.js）

每个平台使用不同版本的文件。

有时出现此错误可能意味着您在 Android 应用程序中使用的是 iOS 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T10:34:10.447

当您包含不正确版本的 cordova.js 时会发生这种情况。请检查您的科尔多瓦版本。我的 www 文件夹中有两个科尔多瓦文件并出现此错误。删除了不适当的及其工作。

# windows-8 - WinRT XAML 中的日期选择器在哪里？

> ID：10965877
> 
> 赞同：10
> 
> 时间：2012-06-10T01:59:45.747
> 
> 标签：windows-8, winrt-xaml

我在 WinRT JavaScript/HTML5 中看到日期选择器控件。XAML 的控制在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T01:59:46.120

标准 Windows 8.0 工具箱中没有日期选择器控件。但是，请查看 Callisto 以获得许多方便的 WinRT XAML 控件，包括日期选择器控件。[https://github.com/timheuer/Callisto](https://github.com/timheuer/Callisto)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-25T06:07:01.160

我发现的最好的一个（带有模板和 xaml 友好格式选项）是：

[https://github.com/jasonmitchell/WinRT-XAML-DatePicker](https://github.com/jasonmitchell/WinRT-XAML-DatePicker)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-27T06:10:47.963

您可以检查我们的 WinRT 组件[包](http://www.perpetuumsoft.com/Windows8-UI-Controls.aspx)。它包含日期选择器组件以及许多其他 UI 组件：径向和普通菜单、颜色选择器、评级控件等。顺便说一句，它是完全免费的；）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-18T22:17:12.743

请注意，Win 8.1 包含用于 DatePicker、TimePicker 的内置 XAML 控件。因此，如果您将项目重新定位到 Win 8.1，您现在将获得这些控件。

重定向：http: [//msdn.microsoft.com/en-us/library/windows/apps/dn263114.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/dn263114.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T03:09:20.773

目前，XAML 中的日期时间选择器没有官方控件。但似乎微软将来会推出一款。[微软](http://social.msdn.microsoft.com/Forums/pl-PL/winappswithcsharp/thread/28515145-d7ef-4625-bca4-6e45c2350cf6)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-10T03:40:32.577

Syncfusion 的 WinRT Studio (Beta) 包含一个非常非常好的 DatePicker，并且可以免费使用。

[http://www.syncfusion.com/products/winrt](http://www.syncfusion.com/products/winrt)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-18T10:54:21.570

您可以找到以下看起来与 javascript 相同的控件： [https](https://mytoolkit.codeplex.com/SourceControl/changeset/view/25356#181302) ://mytoolkit.codeplex.com/SourceControl/changeset/view/25356#181302 。

# php - 用 setInterval 运行一堆 ajax 是不是很好。超过 5 个 ajax 正在运行

> ID：10965881
> 
> 赞同：1
> 
> 时间：2012-06-10T02:00:47.320
> 
> 标签：php, javascript, jquery, ajax, json

运行许多 ajax 的挫折是什么。我有超过 5 个 setIntervals 不同的运行时间、调用 ajax、更新 html 或只是检查会话是否存在。这个好吗？有些每秒运行一次，有些每 5 分钟左右运行一次。做这个的最好方式是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:18:04.823

我个人会偏离这种方法，相反，我会研究一种推送替代方案，或者将您的所有 ajax 请求合并为一个。如果这是一个高流量站点，这可能会导致服务器紧张。此外，如果这是针对拨号或移动设备上的某人，这很可能会破坏客户端的连接。

我对该项目一无所知，所以我不知道推送是否有效，如果您有一个在新数据可用时运行的触发器，我会查看 pubnub.com 并查看推送。

如果这不是一个可行的解决方案，我建议制作一个脚本，在一个请求中响应您的脚本所需的所有信息。这减少了服务器压力。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:18:35.027

最好的方法是使用一个“运行循环”，其中包含一个可以完成所有操作的 Ajax 调用。在“运行循环”中检查需要返回什么样的信息，进行 Ajax 调用然后更新。这将有助于减少使用的带宽量，特别是如果您每月的带宽量有限。

# ruby - Ruby 的soap4r 不提供命名空间？

> ID：10965884
> 
> 赞同：0
> 
> 时间：2012-06-10T02:01:32.377
> 
> 标签：ruby, web-services, wsdl, xml-namespaces, soap4r

我正在尝试使用 soap4r（来自[https://github.com/mumboe/soap4r](https://github.com/mumboe/soap4r)）为名为 SysAid 的产品编写 SOAP 客户端。

我有一个 Java SOAP 客户端的工作示例，对于大多数方法，我的 Ruby 客户端也可以工作。Java 客户端可用于确定 Ruby 版本的错误。

使用特定呼叫时收到错误消息：

```
SOAP::FaultError: prefix xs is not bound to a namespace 
```

这是soap4r发送的消息，它产生了这个错误：

```
<?xml version="1.0" encoding="utf-8" ?>
<env:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:env="http://schemas.xmlsoap.org/soap/envelope/">
  <env:Body>
    <n1:save xmlns:n1="http://api.ilient.com/">
      <sessionId>1339292997261</sessionId>
      <apiSysObj xsi:type="n1:apiServiceRequest">
        <customDateFields></customDateFields>
        <customFields>
          <entry>
            <key xsi:type="xs:string">sr_cust_dafis_fau</key>
            <value xsi:type="xs:string"></value>
          </entry>
          <entry>
            <key xsi:type="xs:string">sr_cust_activity</key>
          </entry>
        </customFields>
        <description>This is the description of the ticket.</description>
      </apiSysObj>
    </n1:save>
  </env:Body>
</env:Envelope> 
```

这是 Java 为相同方法发送的内容，服务器*没有*抱怨：

```
<?xml version="1.0" ?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
  <S:Body>
    <ns2:save xmlns:ns2="http://api.ilient.com/">
      <sessionId>1339199684324</sessionId>
      <apiSysObj xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns2:apiServiceRequest">
        <customDateFields/><customFields>
        <entry>
          <key xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string">sr_cust_dafis_fau</key>
          <value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"></value>
        </entry>
        <entry>
          <key xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string">sr_cust_activity</key>
        </entry>
      </customFields>
      <description>This is the description of the ticket.</description>
    </apiSysObj>
  </ns2:save>
</S:Body>
</S:Envelope> 
```

如您所见，错误来自 customFields 标签。soap4r 省略了 key 标记上的 xmlns:xs 属性，而 Java 将其放入。

据我所知，soap4r 在任何其他方法调用上都不会出现这样的严重错误。

如何让soap4r将此所需的属性添加到键标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:39:28.170

我认为命名空间“xmlns:xsd="http://www.w3.org/2001/XMLSchema" 已在“env:Envelope”中定义，问题是为什么在主体soap4r 中使用“xs:string” “xsd：字符串”。

# windows-8 - WinRT XAML 中的 Flyout 控件在哪里？

> ID：10965886
> 
> 赞同：3
> 
> 时间：2012-06-10T02:02:00.470
> 
> 标签：windows-8, winrt-xaml

JavaScript 中的 Flyout 控件对于“设置”窗格和按钮 Flyout 扩展非常方便。但是 WinRT XAML 的 Flyout 控件在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T02:02:01.313

您要查找的控件在 XAML 中称为 Popup。与 Flyout 的 JavaScript 实现不同，它取决于您定位主题按钮并将弹出窗口放置在其附近。

看：[http ://blog.jerrynixon.com/2012/08/how-to-create-windows-8-settings-pane.html](http://blog.jerrynixon.com/2012/08/how-to-create-windows-8-settings-pane.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-28T11:28:06.233

使用[Callisto](https://github.com/timheuer/callisto)控件工具包，它具有弹出控件

# php - 在windows中隐藏shell_exec PHP浏览器上的命令使用参数

> ID：10965891
> 
> 赞同：1
> 
> 时间：2012-06-10T02:03:06.690
> 
> 标签：php, shell-exec, traceroute

我使 traceroute 基于网络。我使用 shell_exec 执行该过程并通过浏览器显示输出。我第一次在浏览器上调用页面时遇到问题。有 tracert 命令 show 的用法。我尝试通过将脚本放在函数中来隐藏它。是的，它可以工作，但是当我开始加载页面时，另一个元素（如地图）没有显示。这是我的php代码：

```
<html>
<head>
<title></title>
<body>
<?
$host  = @$_POST['host']; 
$trace = @$_POST['trace'];
$self  = $_SERVER['PHP_SELF'];
?>
...
        <form name="tools" action="<?php $self ?>" method="post">
    <p><font size="2">Your IP is <?php $ip ?> </font></p>
    <input type="text" name="host" value=""></input>
    <input type="submit" name="trace" value="Traceroute!"></input>
    </form>
    <?php
    if ($_POST['submit']) 
{
    if (($host == 'Enter Host or IP') || ($host == "")) {
        echo '<br><br>You must enter a valid Host or IP address.';
        exit; } 

    if(eregi("^[a-z]",  $host))
    {
        $host_name = $host;
        $host_ip = gethostbyname($host);
    }
    else
    {
        $host_name = gethostbyaddr($host);
        $host_ip = $host;
    } 
}
    $host= preg_replace ("[-a-z0-9!#$%&\'*+/=?^_`{|}~]","",$host);
    $command = "tracert $host";
    $fp = shell_exec("$command 2>&1");
    $output .= (htmlentities(trim($fp)));
    echo "<pre>$output</pre>";
    echo '<br/>'; 
?>
...

</body>
</html> 
```

以及 html 代码（浏览器输出）：

```
'''
<form name="tools" action="" method="post">

    <p><font size="2">Your IP is  </font></p>

    <input type="text" name="host" value=""></input>

    <input type="submit" name="trace" value="Traceroute!"></input>

    </form>

    <pre>Usage: tracert [-d] [-h maximum_hops] [-j host-list] [-w timeout] 
               [-R] [-S srcaddr] [-4] [-6] target_name

Options:
    -d                 Do not resolve addresses to hostnames.
    -h maximum_hops    Maximum number of hops to search for target.
    -j host-list       Loose source route along host-list (IPv4-only).
    -w timeout         Wait timeout milliseconds for each reply.
    -R                 Trace round-trip path (IPv6-only).
    -S srcaddr         Source address to use (IPv6-only).
    -4                 Force using IPv4.
    -6                 Force using IPv6.</pre><br/> <script type="text/javascript">

    var pinImage = new google.maps.MarkerImage ("http://chart.apis.google.com/chart?chst=d_map_xpin_letter_withshadow&chld=pin_star|%E2%80%A2|CC3300|000000|FF9900",

        new google.maps.Size (70, 83),

        new google.maps.Point (0,0),

        new google.maps.Point (10,34));

    var pinShadow = new google.maps.MarkerImage ("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",

        new google.maps.Size (89, 85),

        new google.maps.Point (0, 0),

        new google.maps.Point (12, 35));

    function initialize() {

    var myLatlng = new google.maps.LatLng(38.822591, 150.46875);

    var myOptions = {

    zoom: 2,

    center: myLatlng,

    mapTypeId: google.maps.MapTypeId.ROADMAP,

    }

    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        }
... 
```

我需要的只是像在我的 html 代码中一样隐藏 traceroute 的帮助用法。因此，当我第一次加载页面时，它只显示文本字段、按钮和地图，而没有使用 tracert。我真的需要你尽快的帮助。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:14:32.687

考虑这两行的作用：

```
$host= preg_replace ("[-a-z0-9!#$%&\'*+/=?^_`{|}~]","",$host);
$command = "tracert $host"; 
```

`$host`您可能会发现在运行命令之前立即打印值很有启发性。您已经从主机名中删除了所有数字和字母——您到底打算查找什么？

我可以理解您正在积极地剥离输入以试图避免[shell 命令注入漏洞](http://en.wikipedia.org/wiki/Code_injection#Shell_injection)。

您应该*保留*特定字符，而不是*剥离字符。*只保留. （我不知道用 PHP 表达这一点的最佳方式。括号内仅表示。在您使用的任何工具中保持该含义。）（适用于具有数字名称的 IPv6 主机。如果您不这样做，请随意放弃它不想允许 IPv6。）*`[a-z0-9:.-]``.``.``:`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T03:32:21.933

使用 exec 而不是 shell_exec。您可以提供命令、接收输出的变量和接收状态的变量，而不是在 exec 的返回中捕获所有状态。

[http://www.php.net/manual/en/function.exec.php](http://www.php.net/manual/en/function.exec.php)

此外，请使用 escapeshellcmd 和 escapeshellarg 来清理您的命令，[http:](http://www.php.net/manual/en/function.escapeshellcmd.php) //www.php.net/manual/en/function.escapeshellcmd.php 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-01T10:49:18.450

如果我理解实际问题，那么您只是不想在没有输入的情况下运行并输出您的命令。你已经有了

```
if ($_POST['submit']) 
{ 
```

只需将其关闭移`}`过该代码即可：

```
 $host_ip = $host;
    } 
// removed from here
    $host= preg_replace ("[-a-z0-9!#$%&\'*+/=?^_`{|}~]","",$host);
    $command = "tracert $host";
    $fp = shell_exec("$command 2>&1");
    $output .= (htmlentities(trim($fp)));
    echo "<pre>$output</pre>";
    echo '<br/>'; 
} //added here 
```

这对我来说似乎比使用 JS 更干净，但 JS 也很简单。只是谷歌“js隐藏/取消隐藏”*

# php - 查找所有不匹配条件的行，MySQLi MySQL PHP

> ID：10965893
> 
> 赞同：0
> 
> 时间：2012-06-10T02:04:00.470
> 
> 标签：php, mysql, mysqli

好吧，我以前从来没有在这里问过问题，但是这里去。

在我的 PHP 脚本中，我目前有一个查询，用于检索与`threads_read`表中用户 ID 匹配的所有线程（记录所有读取的线程 ID、Unix 时间戳和用户 ID）。`important_threads`然后，我使用另一个查询来检索包含线程 ID的表中的所有匹配行。

这可能是一个非常简单的问题，但我对 MySQL(i) 不太熟悉，但我将如何进行查询以检索`important_threads`表中所有不匹配的行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:08:13.950

您可以执行以下操作：

```
SELECT * FROM threads_read WHERE id NOT IN (SELECT id FROM important_threads) 
```

这有点耗费资源，但它可以完成这项工作。

不过，我真的建议不要使用这种类型的数据库结构。简单地标记一个名为“线程”的表，该表将有一个列来查看它是否被阅读或重要，这将是一个更加流畅的设计。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T02:21:41.797

您可以对 important_threads 表执行 LEFT JOIN 并仅获取表中没有匹配项的行：

```
SELECT 
    a.*
FROM 
    threads_read a
LEFT JOIN
    important_threads b ON a.id = b.id
WHERE 
    a.user_id = 14 
    AND 
    b.id IS NULL 
```

# python - 如何在 Python Flask 上拥有 URL 的别名？

> ID：10965899
> 
> 赞同：11
> 
> 时间：2012-06-10T02:05:32.323
> 
> 标签：python, flask, jinja2, werkzeug

我正在使用 Flask 0.8。

如何拥有这样的 URL 别名：

```
@app.route('/')
def index():
    # I want to display as http://localhost/index, BUT, I DON'T WANT TO REDIRECT.
    # KEEP URL with only '/'

@app.route('/index')
def index():
    # Real processing to display /index view 
```

那么，为什么我希望使用别名，因为处理 /index 的 DRY

有人知道解决方案吗？

谢谢胡椒粉。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-10T02:08:56.800

这应该有效。但是为什么要两个 URL 显示相同的内容呢？

```
@app.route('/')
@app.route('/index')
def index():
    ... 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-10T02:15:50.540

正如[Flask 的 URL 注册表文档中](http://flask.pocoo.org/docs/api/#url-route-registrations)所写：

> 您还可以为同一个函数定义多个规则。然而，它们必须是独一无二的。

```
@app.route('/users/', defaults={'page': 1})
@app.route('/users/page/<int:page>')
def show_users(page):
    pass 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T02:08:49.023

我不知道 Flask 是否有办法将多个 URL 分配给视图函数，但你当然可以像这样链接它们：

```
@app.route('/')
def root():
    return index()

@app.route('/index')
def index():
    # Real processing to display /index view 
```

# mysql - 在mysql中设置字段的查询是什么

> ID：10965900
> 
> 赞同：0
> 
> 时间：2012-06-10T02:05:34.327
> 
> 标签：mysql, crud

我的项目需要一个功能。有3个mysql表。

```
Requests -  request_id, request_msg, user_id, request_datetime
Responses - response_id, request_id, response_msg, user_id, response_datetime, readflag
Users-      user_id, user_email, user_name 
```

用户发布请求并获取其他用户的响应。[非常类似于stackoverflow网站]

响应表中的 readflag 指示该响应是否被发布与其关联的请求的用户读取？

```
0- NOT READ, 1-READ 
```

最初这个字段是0，我想把它标记为1。

同一页面上列出的所有请求。当用户点击一个请求时，与该请求相关的所有响应都将列在其他页面上。

任何用户都可以阅读任何用户的请求和响应。当发布请求的用户读取与其关联的响应时，我只想将这些响应标记为 readflag=1;

“更新响应 SET readflag = 1 WHERE request_id = '$request_id'” 和.....;

请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:33:08.080

要更新这些记录，您首先需要有一个存储用户 ID 的变量，然后检查请求是否属于该用户。如果是这样，请更新该请求的所有响应。

```
$userID = "devesh";
$requestOwner = "devesh";

if ($userID == $requestOwner) {
    $qry = "UPDATE responses SET readflag = 1 WHERE request_id = '$request_id';
    // Execute query here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:17:49.533

如果您已经显示了一个请求并且它是响应，我建议您已经知道 request_id 和 user_id。如果 user_id 属于 request_id，则 user_id 属于创建请求的用户。因此，如果你写

```
UPDATE Responses AS Res JOIN Requests as Req USING (request_id)
SET Req.readflag = 1
WHERE Res.request_id = '$request_id'
AND Res.user_id = '$user_id' 
```

我在这里使用表的别名来区分 Req.user_id 和 Res.user_id。如果 Request 表中没有 request_id = '$request_id' 和 user_id = '$user_id' 的记录，则不会更新任何响应。

我认为 saluce 的答案可能会更快，因为它可以在没有 JOIN 的情况下工作，并且只需要在某些情况下执行。所以也许你想留下你所拥有的。

# objective-c - 有没有办法以编程方式访问 OSX 系统字典？

> ID：10965905
> 
> 赞同：8
> 
> 时间：2012-06-10T02:06:28.203
> 
> 标签：objective-c, xcode, macos, cocoa, dictionary

使用 Objective-C 和 Cocoa API，我如何搜索“狗”的 OSX 系统字典定义并检索结果以便显示它们？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-10T03:41:55.460

您可以使用[DictionaryServices 框架](https://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/DictionaryServicesProgGuide/access/access.html)从活动系统词典中以文本 ( `CFString`) 的形式获取定义，或显示包含定义的词典窗口。

# c# - 我无法在 Windows Azure 解决方案中的 VS2010 上安装 Facebook C# SDK

> ID：10965906
> 
> 赞同：0
> 
> 时间：2012-06-10T02:06:40.487
> 
> 标签：c#, facebook, sdk, azure, installation

我创建了一个带有 Web 角色项目、工作角色和 WCF 角色的 Windows Azure 解决方案。我尝试安装日期为 2012 年 5 月 31 日的 FB​​ C# SDK 6.0.20 我得到了这个结果：

成功安装“Facebook 6.0.20”。成功卸载“Facebook 6.0.20”。安装失败。正在回滚...未能添加对“Facebook”的引用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:44:05.383

我决定下载 NuGet 的命令行工具 (CLT) 并手动下载/安装包。软件包下载到您运行 CLT 的同一目录中。然后我只是添加了对 web 角色项目的引用。它有效并且编译正确。希望这可以帮助其他一些开发人员。

# java - Java：发送 Facebook 凭据

> ID：10965907
> 
> 赞同：-2
> 
> 时间：2012-06-10T02:06:54.370
> 
> 标签：java, facebook, authentication, login, credentials

我正在开发一个程序，它将下载一个 facebook 页面，所以我有 html。但是，当我下载它时，我得到了未登录的 facebook 页面。

有没有办法以某种方式发送我的 facebook 登录信息，以便 facebook 认为程序已登录，所以我得到正确的 html？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:08:29.067

如果您想从 Facebook 获取信息，您应该使用[https://developers.facebook.com/docs/](https://developers.facebook.com/docs/)上提供给您的 API 。API 提供对您想要的大多数数据的访问，它通过 OAuth 身份验证和 JSON 响应来实现，这两者在开发社区中都有很多支持（您将能够找到几个库来处理这些类型的数据，而无需必须自己编码）。还有一些示例、适用于多种不同编程语言的 SDK 以及大量有用的信息。

否则，如果您特别想要 HTML，您可以使用[http://hc.apache.org/httpcomponents-client-ga/index.html](http://hc.apache.org/httpcomponents-client-ga/index.html)上的组件 。这是一些可用于获取 HTTP 页面的代码...

```
 HttpGet request = new HttpGet("http://www.facebook.com");

  // Send the request
  DefaultHttpClient client = new DefaultHttpClient();
  HttpResponse response = client.execute(request);

  // Get the response code
  if (response.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
    // Success
    String responseMessage = EntityUtils.toString(response.getEntity());

    // do something with the response here
  } 
```

如果您需要发送数据，例如将登录信息发送到 Facebook，您可以使用`HttpPost`代替`HttpGet`，并附上您的登录信息。

但是，应该警告您，Facebook 在禁止使用 HTTP 请求而不是其 API 的人方面非常严格，因此我不鼓励您这样做。我将您引导至此处的 Facebook 平台政策... [https://developers.facebook.com/policy/](https://developers.facebook.com/policy/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:40:49.133

您应该查看 Facebook API：[https ://developers.facebook.com/](https://developers.facebook.com/)

# c# - 如何使用一个程序编辑 dll 中的类，以便在另一个程序中访问信息？

> ID：10965914
> 
> 赞同：0
> 
> 时间：2012-06-10T02:08:41.987
> 
> 标签：c#

我正在尝试创建 2 个具有通用代码的程序。我需要一个向/从另一个可以读取的数组添加或删除数据。现在我已经创建了一个具有该类的 dll，但我的问题是我不知道如何正确实例化它，以便两个程序将使用相同的数据。两个进程不会同时运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:45:48.010

一个基本的“规则”是每个进程都在其“自己的小世界”中运行。从程序的角度来看，它拥有整台计算机（以及所有计算机资源，如内存）。它*没有任何其他过程的直接知识*，*也不能*“仅仅共享”数据。

简单看一下这个线程：

*   [.NET 进程间通信的最佳选择是什么？](https://stackoverflow.com/questions/84855/what-is-the-best-choice-for-net-inter-process-communication)

对于“进程间通信”，您有很多选择。包括 COM/ActiveX、.Net 远程处理、命名管道、共享内存、WCF 等。

只是为了让您知道从哪里开始，我鼓励您查看“套接字”。例如：

*   [http://csharp.net-informations.com/communications/csharp-socket-programming.htm](http://csharp.net-informations.com/communications/csharp-socket-programming.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T03:46:02.503

您*可以*使用[内存映射文件](http://msdn.microsoft.com/en-us/library/dd997372.aspx)，但您也可以查看两个进程进行通信的许多其他方式，例如使用 MSMQ、命名管道......

# javascript - 使用Javascript从html下拉菜单中获取值作为数字

> ID：10965917
> 
> 赞同：4
> 
> 时间：2012-06-10T02:09:50.447
> 
> 标签：javascript, html

我试图显示一个警告框，每次用户在下拉列表中选择不同的选项时，该框的内容都会发生变化。

这里有两个下拉列表，但是“产品”下拉列表指向同一个数组

如您所见，我已尝试制作 js，但仍然无法正常工作

我想问的是：

*   我们如何从下拉菜单中获取值？
*   我们如何从下拉列表中获取值作为整数，而不是字符串？

**抱歉英语不好*

这是javascript

```
<script language="javascript">
function RadioCheck() {

var number = new Array('0', '20', '30', '40', '50', '60');
var selection1 = document.quiz.product1;
var selection2 = document.quiz.product2;
var amountselection1 = parseInt(document.quiz.amount1,10);
var amountselection2 = parseInt(document.quiz.amount2,10);

for (i=0; i<selection1.length; i++) {
if (selection1[i].checked == true) {
    result1=number[i]*amountselection1;
}
}

for (i=0; i<selection2.length; i++) {
if (selection2[i].checked == true) {
    result2=number[i]*amountselection2;
}
}

var result = (result1 + 'is the first result, and' + result2 + 'is the second result');
alert(result);
return false;
}

</script> 
```

这是HTML

```
<form name="quiz">

<select id="product1">
<option name="product1" value="0" selected="selected"> </option>
<option name="product1" value="1">Product 1</option>
<option name="product1" value="2">Product 2</option>
<option name="product1" value="3">Product 3</option>
<option name="product1" value="4">Product 4</option>
<option name="product1" value="5">Product 5</option>
</select>

<select id="amount1">
<option name="amount1" value="0" selected="selected">0</option>
<option name="amount1" value="1">1</option>
<option name="amount1" value="2">2</option>
<option name="amount1" value="3">3</option>
<option name="amount1" value="4">4</option>
<option name="amount1" value="5">5</option>
</select>

<select id="product2">
<option name="product2" value="0" selected="selected"> </option>
<option name="product2" value="1">Product 1</option>
<option name="product2" value="2">Product 2</option>
<option name="product2" value="3">Product 3</option>
<option name="product2" value="4">Product 4</option>
<option name="product2" value="5">Product 5</option>
</select>

<select id="amount2">
<option name="amount2" value="0" selected="selected">0</option>
<option name="amount2" value="1">1</option>
<option name="amount2" value="2">2</option>
<option name="amount2" value="3">3</option>
<option name="amount2" value="4">4</option>
<option name="amount2" value="5">5</option>
</select>

<input type="submit" value="Check Answer" onClick="RadioCheck(); return false;">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-16T22:55:25.803

问题是你没有声明变量`result1`& `result2`。也为了得到数量选择使用`document.quiz.amount1.value`而不是仅仅`document.quiz.amount1`，等等`amount2`。再次比较下拉选择使用`selection1[i].selected`而不是`selection1[i].checked`.

试试这个代码：

```
function RadioCheck() {

  var number = new Array(0, 20, 30, 40, 50, 60); //quotes will work but not recommended for numbers
  var selection1 = document.quiz.product1;
  var selection2 = document.quiz.product2;
  var amountselection1 = parseInt(document.quiz.amount1.value, 10); //changed
  var amountselection2 = parseInt(document.quiz.amount2.value, 10); //changed
  var result1 = 0, result2 = 0; //added line

  for (i = 0; i < selection1.length; i++) {
    if (selection1[i].selected) { //changed
      result1 = number[i] * amountselection1;
    }
  }

  for (i = 0; i < selection2.length; i++) {
    if (selection2[i].selected) { //changed
      result2 = number[i] * amountselection2;
    }
  }

  var result = (result1 + 'is the first result, and ' + result2 + 'is the second result');
  alert(result);
  return false;
}
```

```
<form name="quiz">

  <select id="product1">
    <option name="product1" value="0" selected="selected"></option>
    <option name="product1" value="1">Product 1</option>
    <option name="product1" value="2">Product 2</option>
    <option name="product1" value="3">Product 3</option>
    <option name="product1" value="4">Product 4</option>
    <option name="product1" value="5">Product 5</option>
  </select>

  <select id="amount1">
    <option name="amount1" value="0" selected="selected">0</option>
    <option name="amount1" value="1">1</option>
    <option name="amount1" value="2">2</option>
    <option name="amount1" value="3">3</option>
    <option name="amount1" value="4">4</option>
    <option name="amount1" value="5">5</option>
  </select>

  <select id="product2">
    <option name="product2" value="0" selected="selected"></option>
    <option name="product2" value="1">Product 1</option>
    <option name="product2" value="2">Product 2</option>
    <option name="product2" value="3">Product 3</option>
    <option name="product2" value="4">Product 4</option>
    <option name="product2" value="5">Product 5</option>
  </select>

  <select id="amount2">
    <option name="amount2" value="0" selected="selected">0</option>
    <option name="amount2" value="1">1</option>
    <option name="amount2" value="2">2</option>
    <option name="amount2" value="3">3</option>
    <option name="amount2" value="4">4</option>
    <option name="amount2" value="5">5</option>
  </select>

  <input type="submit" value="Check Answer" onClick="RadioCheck(); return false;">
</form>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:17:32.437

看起来这已经被回答了：[Get selected value in dropdown list using JavaScript?](https://stackoverflow.com/questions/1085801/how-to-get-selected-value-of-dropdownlist-using-javascript)

至于整数值而不是字符串，为什么不直接转换呢？parseInt($stringVal);

# django - 如何使表单标签和字段显示在 django-crispy-form 的同一行

> ID：10965922
> 
> 赞同：3
> 
> 时间：2012-06-10T02:10:39.450
> 
> 标签：django, django-forms

```
class CustomerRegistrationForm(forms.Form):

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_action = 'customer_register'

        self.helper.layout = Layout(
            HTML("""<h3>Create new customers account</h3>"""),
            Row(Field('first_name',),),
            Field('last_name',),
            Field('gender',),
            Row( Field('gender'),),
        ) 
```

此类的结果就像字段位于标签下方，但我想要类似[https://github.com/maraujop/django-crispy-forms](https://github.com/maraujop/django-crispy-forms)的示例，其中标签和字段位于相同线。

我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T08:14:46.100

如果您使用默认模板包（[Bootstrap](http://twitter.github.com/bootstrap/)），则必须将类分配[`form-horizontal`](http://twitter.github.com/bootstrap/base-css.html#forms)给您的表单标签。

> 在与控件相同的行上浮动左、右对齐的标签

要么在您的模板中执行此操作，要么使用您在[示例要点](https://gist.github.com/1838193)`form.helper`中演示的脆皮表单：

```
helper.form_class = 'form-horizontal' 
```

# apache - htaccess 密码保护目录和 mod_rewrite RerwriteCond

> ID：10965923
> 
> 赞同：1
> 
> 时间：2012-06-10T02:13:13.560
> 
> 标签：apache, .htaccess, mod-rewrite, password-protection

我有一个网站，我想重定向所有接受 1 个目录路径的请求。

[http://mysite.com/application](http://mysite.com/application)
[http://mysite.com/application/templates](http://mysite.com/application/templates)
[http://mysite.com/application/admin](http://mysite.com/application/admin) （密码保护）

```
RewriteCond %{REQUEST_URI} !^\/application
RewriteRule ^.*$ http://mynewsite.com [R=307] 
```

我的重写引擎`.htaccess`工作正常，除非访问受密码保护的 /admin 目录。当我尝试请求它时，我被重定向了。如果我重命名文件夹`.htaccess`中的。`/admin`它工作正常。我怀疑浏览器（FF）正在请求另一个与重定向匹配的网址。我怎样才能保护目录密码，但不重定向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T01:59:00.347

通过增加：

```
RewriteCond %{REQUEST_URI} !401 
```

现在它起作用了。我相信这是由于共享的虚拟主机配置预先分配了 4XX 和 5XX 页面重定向。所以，这就是正在发生的事情。!401 并不完美，但对于我的简单应用程序来说它可以工作。我认为这样的事情会更好地捕获 401 作为 uri 的开头（模式未经测试）：

```
RewriteCond %{REQUEST_URI} !^\/401 
```

# eclipse - 未为 com.mysql.jdbc.jdbc2.optional.MysqlXADataSource 设置部署到 Glassfish 类路径

> ID：10965926
> 
> 赞同：6
> 
> 时间：2012-06-10T02:14:08.260
> 
> 标签：eclipse, deployment, glassfish, ear

Glassfish 没有加载`com.mysql.jdbc.jdbc2.optional.MysqlXADataSource`包。

抛出以下错误

```
javax.persistence.PersistenceException: Exception [EclipseLink-4002] (Eclipse Persistence
Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: 
Error in allocating a connection. Cause: Class name is wrong or classpath is not set    
for:com.mysql.jdbc.jdbc2.optional.MysqlXADataSource
Error Code: 0 at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy
(EntityManagerSetupImpl.java:517)... 
```

我已将 mysql-connector jar 文件复制到`lib`Glassfish 的目录中，但仍然出现上述错误。

如何确保 Glassfish 可以为我部署的应用程序找到我的 JDBC 驱动程序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-10T02:41:48.780

您需要使 Glassfish 可以使用 MySQL JDBC jar 文件。

[http://ushainformatique.com/blog/2010/03/19/jdbcwithglassfish/](http://ushainformatique.com/blog/2010/03/19/jdbcwithglassfish/)

编辑：

## 如何使用不同的 JDBC 驱动程序？我应该在哪里复制罐子？

> 建议将域中所有应用程序使用的 JDBC 驱动程序放置在 domain-dir/lib 或 domain-dir/lib/classes 中。今天需要重新启动应用程序服务器实例，以便 JDBC 驱动程序对部署在域中的应用程序可见。

来自[https://blogs.oracle.com/sivakumart/entry/classloaders_in_glassfish_an_attempt](https://blogs.oracle.com/sivakumart/entry/classloaders_in_glassfish_an_attempt)

因此，将 jar 文件移动到您正在部署应用程序的域下方的 lib 目录中。默认 Glassfish 域是 domain1。

重新启动 Glassfish，这应该可以工作。

有一个 Maven Glassfish 插件可能值得评估[http://maven-glassfish-plugin.java.net/](http://maven-glassfish-plugin.java.net/)使用 Maven，这个插件将有助于自动化部署步骤。这将比手动部署更强大。当然是你的电话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-18T06:04:07.370

Besides adding the driver to your classpath, you should try adding the appserv-rt.jar file to your project's build path (the jar is located in Glassfish's lib directory). If you don't want to include all the other jars you should first create a library containing the appserv-rt jar and then add it to your project's build path.

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-12-10T06:59:42.777

We could fix using ./asadmin start-database This starts Derby (don't know why this is required, may be a bug, and I dont use this DB in my app) :)

# twitter-bootstrap - 如何为 bootstrap-fileupload 获取 css（使用 bootstrap-sass gem）

> ID：10965927
> 
> 赞同：1
> 
> 时间：2012-06-10T02:14:08.760
> 
> 标签：twitter-bootstrap

我想在我的 rails 项目中使用 bootstrap-fileupload.js (http://jasny.github.com/bootstrap/javascript.html#fileupload)，但是 bootstrap-sass css 缺少 bootstrap-fileupload 元素的样式.

我什至无法在 twitter bootstrap 自定义站点上找到单独的 css - [http://twitter.github.com/bootstrap/download.html](http://twitter.github.com/bootstrap/download.html)。Fileupload 未作为 JS 组件下的选项列出。

任何有关如何执行此操作的指示将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T16:24:38.607

没关系，刚刚意识到这是由 Jasny 扩展的。[您可以在https://github.com/jasny/bootstrap/blob/master/less/jasny/fileupload.less](https://github.com/jasny/bootstrap/blob/master/less/jasny/fileupload.less)获取 css

更新链接

# google-maps - 如何使用 Google Maps API 找到最近的兴趣点？

> ID：10965929
> 
> 赞同：1
> 
> 时间：2012-06-10T02:14:35.593
> 
> 标签：google-maps

对于我正在开发的应用程序，我需要使用 Google Maps API 找到最近的公交车站。我将如何做到这一点？

地点搜索 API 只返回 REQUEST_DENIED，因此没有多大帮助。

`https://maps.googleapis.com/maps/api/place/search/json?key=AIzaSyCNutXaoPSvdgAboAp7CYLZ2S5oVv_Fe7o&location=52.069858,4.291111&radius=1000&sensor=false`

[http://puu.sh/zUUa](http://puu.sh/zUUa)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:29:45.393

我怀疑这`REQUEST_DENIED`会给您一个线索，即您的查询格式正确，但有些内容无效。如果不是缺少`sensor`参数，那一定是你提供的key。我自己没有密钥来测试它，谷歌拒绝给它说我提供的 URL 无效......我只能建议你仔细检查你的密钥，也许尝试使用另一个帐户。

**编辑**：现在我设法拿到了我的钥匙并发现了你的错误：你忘了把`https`, not `http`, 在你的请求中。

# sql-server-2008 - 如何生成用于将 varchar 列更改为 xml 类型并转换数据的脚本？

> ID：10965930
> 
> 赞同：1
> 
> 时间：2012-06-10T02:14:42.933
> 
> 标签：sql-server-2008

最初我有一个`partner_email`类型为 () 的列`varchar`。现在最近发生了一个变化，需要将其更改为`XML`数据类型，但需要将现有行转换为新列。

需要帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:45:47.770

单步执行脚本将有助于理解问题：

**脚本 1**

1.  使用测试数据库
2.  如果`partner_email_temp`Partner 表中不存在该列，则添加`partner_email_temp`为 XML 列
3.  更新合作伙伴表。将 的值更改为`partner_email_temp`XML 友好的字符串版本`partner_email`。然后将其转换为 XML。使用 REPLACE 将所有 & 转换为编码的 &
4.  `partner_email`从合作伙伴中删除列
5.  将列重命名`partner_email_temp`为`partner_email`

所有这些都是第一次工作。当您第二次运行该脚本时，SQL Server 会进入第 2 步并再次执行 ALTER TABLE 语句。这是因为该列`partner_email_temp`不存在（它在第一次运行时被重命名为 partner_email）。

现在在第 3 步中，您正在尝试`partner_email`再次更新该列。问题是这个列现在是一个 XML 数据类型并且你的使用`REPLACE`是非法的。所以 SQL Server 会抛出一个错误。

**脚本 2**

1.  `partner_email`捕获Partner 中列的列数据类型。
2.  如果列数据类型是 varchar（表示这是脚本的第一遍），执行 BEGIN 和 END 中的代码
3.  如果该列`partner_email_temp`不存在，则将该 `partner_email_temp`列添加为 XML
4.  通过将 的值更改为`partner_email_temp` XML 友好的字符串版本来更新合作伙伴表`partner_email`，然后将其转换为 XML。用于`REPLACE`将所有 & 转换为编码的 &
5.  `partner_email`从合作伙伴中删除列
6.  将列重命名`partner_email_temp`为`partner_email`

第二个脚本中的问题是您不能`GO`在 BEGIN 和 END 语句中使用该语句。

根据[BOL](http://msdn.microsoft.com/en-us/library/ms188037.aspx)：

> SQL Server 实用程序将 GO 解释为它们应该将当前批次的 Transact-SQL 语句发送到 SQL Server 实例的信号。

因此，在脚本 2 中，当 SQL Server 尝试编译时，它会注意到该列`partner_email_temp`不存在。它适用于脚本 1，因为这些部分是单独执行的。并且当执行引用的部分时`partner_email_temp`，该列确实存在。

那么如何解决呢？

如果您只需将`partner_email`列中的数据更新为正确的格式，然后将该列转换为 XML 数据类型，您实际上可以绕过所有列的删除和重命名。这可以在一个 SQL 批处理语句中实现，但您需要将其作为动态 SQL 执行，以便 SQL Server 仅在 varchar 数据类型`REPLACE`时尝试执行该语句：`partner_email column`

```
IF NOT EXISTS 
(
    SELECT * 
    FROM INFORMATION_SCHEMA.columns 
    WHERE table_name = 'Partner'
    AND   column_name = 'partner_email'
    AND   data_type = 'xml'
)
BEGIN

  DECLARE @sqlCmd NVARCHAR(4000)

  SET @sqlCmd = N' 
  UPDATE [dbo].[Partner]
  SET partner_email = ''<PartnerEmails><Email>'' 
  + REPLACE(partner_email, ''&'', ''&amp;'') 
  + ''</Email><Email></Email><Email></Email></PartnerEmails>'';
  ALTER TABLE Partner ALTER Column partner_email XML
  '

  EXEC (@sqlCmd) 

END 
```

# java - Glassfish：缺少 sun-web.xml

> ID：10965934
> 
> 赞同：0
> 
> 时间：2012-06-10T02:15:50.333
> 
> 标签：java, xml, glassfish-3, netbeans-7

我目前正在尝试在我的 Java Web App 中设置一个包含几个页面的安全文件夹，以仅允许注册用户访问该文件夹中的页面。

但是，在尝试对组进行设置/映射时，我遇到了 sun-web.xml 丢失的问题。我正在使用 Netbeans IDE。

任何想法为什么会发生这种情况以及如何解决它？我已经进行了研究，但还没有真正找到解决该问题的方法。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T02:57:29.390

已解决的问题：我将 Netbeans 从 7.0 更新到 7.2，然后按照@Bhesh Gurung 的建议进行操作：

> 尝试：右键单击项目 > 新建 > 其他，然后在类别中选择 Glassfish。之后从文件中选择 glassfish-web.xmlBlockquote

# ios - iOS 上的 Flex 轻击响应不佳

> ID：10965938
> 
> 赞同：2
> 
> 时间：2012-06-10T02:16:54.140
> 
> 标签：ios, apache-flex, adobe, touch

我们的应用程序中有几个项目渲染器，我们注意到这些 UI 元素对点击的响应可能会有很大差异。

例子：

```
 private function setupClickHandling():void
    {
        //this.addEventListener(TouchEvent.TOUCH_TAP, clickHandler);
        this.addEventListener(MouseEvent.CLICK, clickHandler);
    }

    protected function clickHandler(e:Object):void
    {
        var event:ItemClickEvent = 
                        new ItemClickEvent(ItemClickEvent.ITEM_CLICK, true);
        event.item = data;
        event.index = itemIndex;
        dispatchEvent(event);
    } 
```

使用 MouseEvent.CLICK 时，有时点击不会注册为实际点击，**即使**控件在“按下”状态下花费了一些时间。这是最令人沮丧的，因为用户认为控件已被触发，但由于未触发单击事件，因此除了灰色背景闪烁之外没有任何反应。

使用 TouchEvent.TOUCH_TAP 时，点击变得**过于**敏感，有时在拖动滚动列表时会触发列表项。我认为只要中心点没有明显移动，无论持续时间多短，点击界面都会注册点击，并且一旦检测到足够的移动，点击将不会被注册。相反，似乎发生的是点击事件注册在事件的向下部分，而不是向上。

那么，有没有办法要么提高 Click 的灵敏度，要么降低 Tap 的灵敏度呢？

或者理想情况下，总是将点击注册为实际点击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-03T03:52:46.327

您可以滚动自己的点击手势。这是我的做法。。

```
public function BaseItemRenderer()
    {
        super();
        Multitouch.inputMode = MultitouchInputMode.TOUCH_POINT;
        this.addEventListener(TouchEvent.TOUCH_BEGIN, onTouchBegin);
        this.addEventListener(TouchEvent.TOUCH_MOVE, onTouchMove);
        this.addEventListener(TouchEvent.TOUCH_END, onTouchEnd);
    }

    protected var touching:Boolean;
    protected var touchStartTime:int;
    protected var touchStartX:Number;
    protected var touchStartY:Number;

    private function onTouchBegin(e:TouchEvent):void
    {
        trace("onTouchBegin");
        touching = true;
        touchStartTime = getTimer();
        touchStartX = e.stageX;
        touchStartY = e.stageY;
    }

    private function onTouchMove(e:TouchEvent):void
    {
        //
    }

    protected static const TAP_MIN_DURATION:int = 0;
    protected static const TAP_MAX_DURATION:int = 1000;
    protected static const TAP_MIN_DISTANCE:Number = 0;
    protected static const TAP_MAX_DISTANCE:Number = 40;

    private function onTouchEnd(e:TouchEvent):void
    {

        if(touching)
        {
            touching = false;
            var duration:int = getTimer()-touchStartTime;
            var distanceX:Number = e.stageX - touchStartX;
            var distanceY:Number = e.stageY - touchStartY;
            var distance:Number = Math.sqrt(Math.pow(distanceX, 2) + Math.pow(distanceY, 2));
            trace("onTouchEnd duration:" + duration + " distance:" + distance);

            if(duration >= TAP_MIN_DURATION &&
                duration <= TAP_MAX_DURATION &&
                distance >= TAP_MIN_DISTANCE &&
                distance <= TAP_MAX_DISTANCE)
            {
                onTap(e.target);
            }
        }

    } 
```

# javascript - jquery插件错误

> ID：10965939
> 
> 赞同：0
> 
> 时间：2012-06-10T02:16:58.250
> 
> 标签：javascript, jquery, jquery-plugins, plugins

我正在尝试制作一个插件（来自我拥有的其他代码），但我无法让选项部分工作 D：

插件（到目前为止）：

```
(function($){
    $.fn.scBox = function(options){
        var $opts = $.extend($.fn.scBox.defaults, options);

        $.fn.scBox.defaults = {
            start: 40,
            //i: fn.scBox.defaults.start,
            width: 200,
            height: 50,
            min: 0,
            step: 10,
            fontSize: 15,
            textColor: "#fff",
            bgColor: "#000",
            slideColor: "#ff0000"
        }

        console.log($.fn.scBox.defaults);
    }
})(jQuery); 
```

当我尝试通过 调用它时`$.scBox();`，我收到此错误：`Uncaught TypeError: Object function (a,b){return new e.fn.init(a,b,h)} has no method 'scBox'`我只想让它记录我给它的选项 D：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:25:10.120

打电话`$.fn.scBox()`，不是`$.scBox()`。这在这个[fiddle](http://jsfiddle.net/tT8cn/1/)中得到了演示，其代码粘贴在下面。

```
(function($){
    $.fn.scBox = function(options){
        $.fn.scBox.defaults = {
            start: 40,
            //i: fn.scBox.defaults.start,
            width: 200,
            height: 50,
            min: 0,
            step: 10,
            fontSize: 15,
            textColor: "#fff",
            bgColor: "#000",
            slideColor: "#ff0000"
        }
        var $opts = $.extend($.fn.scBox.defaults, options);
        console.log($opts);
    }
    $.fn.scBox();
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:25:19.300

```
$.fn.paginator = function(options){

           var defaults = {
                items_per_page              :   10,
                num_page_links_to_display   :   4,
                start_page                  :   1,
                total_items                 :   20,
                label_first                 :    'First',
                label_prev                  :   'Prev',
                label_next                  :   'Next',
                label_last                  :   'Last',
                show_first_last             :   true,
                onChange                    :   function(){return false;}
            };
            var options = $.extend({}, $.fn.paginator.defaults, options);

            return this.each(function(){
              //Code in here
            });
}; 
```

这是我制作的一个工作插件的一部分。我希望它有帮助！请注意， 在声明 de **defaults var之后调用****$.extend**

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T03:57:49.980

jQuery 插件在 jQuery 对象上调用。你不应该直接打电话给他们。您应该在 jQuery 对象上调用它。

```
$('#myElement').scBox(); 
```

另外，您在`$.extend`声明之前`$.fn.scBox.defaults` *先打电话。*

```
 $.fn.scBox.defaults = {
        start: 40,
        //i: fn.scBox.defaults.start,
        width: 200,
        height: 50,
        min: 0,
        step: 10,
        fontSize: 15,
        textColor: "#fff",
        bgColor: "#000",
        slideColor: "#ff0000"
    }

    var $opts = $.extend($.fn.scBox.defaults, options); 
```

注意：`$.extend`修改作为第一个参数传递的对象（它也返回它）。所以，你不需要`var $opts =`：

```
$.extend($.fn.scBox.defaults, options);
console.log($.fn.scBox.defaults); 
```

或者，您可以这样做：

```
var $opts = $.extend({}, $.fn.scBox.defaults, options);
console.log($opts); 
```

演示：http: [//jsfiddle.net/nfDTh/](http://jsfiddle.net/nfDTh/)**

# jquery - 从jquery中的DOM访问大子元素？

> ID：10965943
> 
> 赞同：1
> 
> 时间：2012-06-10T02:17:38.323
> 
> 标签：jquery, html, css, dom

我将如何访问 ul 结构中的大子元素，例如使用 jquery：

```
<ul>
   <li>Sample</li>
   <li>Sample</li>
   <li>Sample</li>
   <li>
        <ul>
            <li>Need to Get access to this li</li>
        </ul>
   </li>
   <li>Sample</li>

</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:22:19.460

应该是一个简单的

```
$('ul li ul li') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:35:24.903

What you're looking for is not the grand child elements, because that would be:

```
li > li
     +-- grand child
+-- child 
```

Rather you want the child's descendants:

```
li li
   +-- descendant (not necessarily immediate)
+-- child 
```

To anchor it to your top `ul`:

```
ul > li li 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T02:21:24.073

给定您的示例标记。

```
$('ul ul li'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T02:21:53.503

```
$('ul li ul li') 
```

将是jQuery中的代码。

您可以使用以下方法进行测试：

```
$('ul li ul li').css({fontWeight: 'bold'}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-10T02:34:30.623

尝试[`eq()`](http://api.jquery.com/eq-selector/)选择器：

```
$('ul:eq(1) > li') 
```

[http://jsfiddle.net/EDE7J/](http://jsfiddle.net/EDE7J/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-10T02:19:58.270

如果你有 ul 元素`root`，那么`root.find("li ul li")`你会得到你想要的 li 元素（以及该级别的所有其他元素）。

# css - 下拉菜单没有内容（引导框架）

> ID：10965947
> 
> 赞同：2
> 
> 时间：2012-06-10T02:18:58.837
> 
> 标签：css, ruby-on-rails, twitter-bootstrap

嗨，我有以下代码用于使用`bootstrap-sass`gem 的下拉菜单：

```
<div class="nav-collapse collapse" style="height:0px;">
            <nav>
              <ul class= "nav pull-right">
                <% if signed_in? %>
                    <li><%= link_to "Profile", current_user %></li>
                  <li><%= link_to "Users", users_path %></li>
                  <li id = "fat-menu" class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      Account <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                      <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                      <li class="divider"></li>
                      <li>
                        <%= link_to "Sign out", signout_path, method: "delete" %>
                      </li>
                    </ul>
                  </li>
                  <% else %>
                    <li><%= link_to "Sign In", signin_path %></li>
                <%end%>
              </ul>
            </nav>
        </div> 
```

但是，当我单击`Account`它时，仅显示以下内容而不显示内容：

![在此处输入图像描述](../Images/a6b65cdaa00bd324984ed45ed8a42d48.png)

您可以看到显示已单击但没有内容的白色小三角形。当我调试时，我还可以在这里看到 chrome 中的菜单： ![在此处输入图像描述](../Images/03955b904624a10621dd28bacbf2ff71.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:21:08.730

代替：

```
<a href="#" class="dropdown-toggle" data-toggle="dropdown">
  Account <b class="caret"></b>
</a> 
```

你应该使用：

```
<a href="#fat-menu" class="dropdown-toggle" data-toggle="dropdown">
  Account <b class="caret"></b>
</a> 
```

另外，请提供启用此菜单的 JavaScript 文件（它不仅包括 JS 文件，您必须在某处启用下拉菜单）。它看起来像这样：

```
$(".dropdown-toggle").dropdown(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:26:28.313

弄清楚了。不需要`collapse`第一个 div 中的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T00:56:25.433

如果您确实想在第一个 div 中折叠，请使用：

```
.collapse .dropdown{
  overflow: visible !important;
} 
```

# python - 可以在不等待流程完成的情况下调用 subprocess.call 吗？

> ID：10965949
> 
> 赞同：42
> 
> 时间：2012-06-10T02:19:50.227
> 
> 标签：python

我目前正在使用 subprocess.call() 来调用另一个程序，但它会阻塞执行线程，直到该程序完成。有没有办法简单地启动该程序而无需等待返回？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-06-10T02:23:40.433

使用`subprocess.Popen`代替`subprocess.call`：

```
process = subprocess.Popen(['foo', '-b', 'bar']) 
```

`subprocess.call`是一个包装器，`subprocess.Popen`它调用[`communicate`](https://docs.python.org/3/library/subprocess.html#subprocess.Popen.communicate)等待进程终止。另请参阅[subprocess.popen 和 subprocess.run 之间有什么区别](https://stackoverflow.com/questions/39187886/what-is-the-difference-between-subprocess-popen-and-subprocess-run)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-06T13:20:50.627

答案不应该是使用'close_fds'标志吗？

```
subprocess.Popen(cmd, stdout=None, stderr=None, stdin=None, close_fds=True) 
```

# algorithm - 找到数组中第 N 个最频繁的数

> ID：10965952
> 
> 赞同：7
> 
> 时间：2012-06-10T02:20:27.617
> 
> 标签：algorithm, frequency

```
Find the nth most frequent number in array.
(There is no limit on the range of the numbers) 
```

我想我们可以

(i) 在 C++ 中使用映射存储每个元素的出现

(ii) 在元素出现（或频率）的线性时间内建立一个最大堆，然后提取到第 N 个元素，每次提取需要 log(n) 时间来堆化。

(iii) 我们将得到第 N 个最频繁数的频率

(iv) 然后我们可以通过散列进行线性搜索以找到具有该频率的元素。

时间 - O(NlogN) 空间 - O(N)

有没有更好的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T13:15:37.163

它可以在线性时间和空间内完成。令 T 为输入数组中的元素总数，我们必须从中找到第 N 个最频繁的数字：

1.  计算并存储地图中 T 中每个数字的频率。令 M 为数组中不同元素的总数。所以，地图的大小是 M. -- O(T)
2.  [使用选择算法](http://en.wikipedia.org/wiki/Selection_algorithm)在地图中查找第 N 个最大频率。-- O(M)

总时间 = O(T) + O(M) = O(T)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T02:37:55.677

你的方法基本上是对的。如果你用它所代表的数字标记构造堆的每个顶点，你将避免最终的哈希搜索。此外，可以在构建堆的第五个元素时不断地监视它，因为在某些时候，您可能会遇到结果无法再改变并且可以丢弃其余计算的情况。但这在一般情况下可能不会使算法更快，甚至在特殊情况下也可能不会。所以你正确地回答了你自己的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T02:32:30.437

这取决于您是想要最有效还是最容易编写的方法。

1）如果您知道所有数字都将从 0 到 1000，您只需创建一个包含 1000 个零（出现）的数组，循环遍历您的数组并增加正确的出现位置。然后对这些出现进行排序并选择第 N 个值。

2）你有一个“袋子”的独特物品，你循环你的数字，检查那个数字是否在一个袋子里，如果没有，你添加它，如果它在这里，你只是增加出现的次数。然后你从中选择第 N 个最小的数字。

Bag 可以是线性数组、BST 或 Dictionary（哈希表）。

问题是“**第 N 次**最频繁”，所以我认为你不能避免排序（或聪明的数据结构），所以最好的复杂度不能比 O(n*log(n)) 好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-15T19:24:02.913

刚刚用Java8写了一个方法：这不是一个有效的解决方案。

*   为每个元素创建频率图
*   根据值以相反的顺序对地图内容进行排序。
*   跳过第 (N-1) 个元素，然后找到第一个元素

    ```
    private static Integer findMostNthFrequentElement(int[] inputs, int frequency) {
        return Arrays.stream(inputs).boxed()
            .collect(Collectors.groupingBy(Function.identity(), Collectors.counting()))
            .entrySet().stream().sorted(Map.Entry.comparingByValue(Comparator.reverseOrder()))
            .skip(frequency - 1).findFirst().get().getKey();
    } 
    ```

# c# - 如果 SQL 中的 Value 为 NULL，如何返回 Nothing

> ID：10965957
> 
> 赞同：2
> 
> 时间：2012-06-10T02:21:33.750
> 
> 标签：c#, asp.net, sql, web-services

我有以下 SQL 语句：

```
SELECT r.NAME AS REGIONNAME, s.NAME AS STADTNAME, f.ADRESSE AS STRASSEADRESSE 
FROM REGION r 
LEFT OUTER JOIN STADT s ON s.REGION_ID = r.ID 
LEFT OUTER JOIN GEBAEUDE f ON s.ID = f.STADT_ID 
ORDER BY r.NAME 
```

如果我在 SQL Server 2008 Management Studio 中使用此语句，它会像我想要的那样工作。输出是：

[![图片](../Images/10ca820a3db24c30f22cd765f5e718d3.png)](https://i.stack.imgur.com/63VW1.png)

在客户端，我正在使用 Xcode。我的问题是我返回`REGIONNAME`，`STADTNAME`并且`STRASSENADRESSE`在 TableView 中。如果`STRASSENADRESSE`数据库中的值为`NULL`，Xcode 返回一个空行。

如果`STRASSENADRESSE`Value 是`NULL`，Web 服务是否可能只返回`REGIONNAME`and `STADTNAME`？如果是的话，我该怎么做。

提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:33:18.937

您可以使用内置的[ISNULL()](http://msdn.microsoft.com/en-us/library/ms184325.aspx) SQL 函数返回一个空字符串或其他一些默认值。

```
SELECT 
 r.NAME AS REGIONNAME, 
 s.NAME AS STADTNAME, 
 ISNULL(f.ADRESSE,'') AS STRASSEADRESSE 
FROM 
 REGION r LEFT OUTER JOIN 
 STADT s ON s.REGION_ID = r.ID LEFT OUTER JOIN 
 GEBAEUDE f ON s.ID = f.STADT_ID 
ORDER BY 
 r.NAME 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T02:54:58.897

此查询将返回 3 列

`SELECT r.NAME AS REGIONNAME, s.NAME AS STADTNAME, f.ADRESSE AS STRASSEADRESSE FROM REGION r LEFT OUTER JOIN STADT s ON s.REGION_ID = r.ID LEFT OUTER JOIN GEBAEUDE f ON s.ID = f.STADT_ID ORDER BY r.NAME WHERE f.ADRESSE IS NOT NULL`

当 STRASSEADRESSE 值为`null`

`SELECT r.NAME AS REGIONNAME, s.NAME AS STADTNAME, FROM REGION r LEFT OUTER JOIN STADT s ON s.REGION_ID = r.ID LEFT OUTER JOIN GEBAEUDE f ON s.ID = f.STADT_ID ORDER BY r.NAME WHERE f.ADRESSE IS NULL`

您必须在两个不同的 TableView 中接收它们，一个有 3 列，另一个有 2 列

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T02:59:24.607

您可以检查“地址”是否为 NULL。

您可以使用**WHEN** ans **IS NULL**函数..

```
SELECT 
 r.NAME AS REGIONNAME, 
 s.NAME AS STADTNAME, 
 CASE f.ADDRESS
     WHEN f.ADRESSE IS NULL THEN '' 
     ELSE f.ADDRESS
 END AS STRASSEADRESSE 
FROM 
 REGION r LEFT OUTER JOIN 
 STADT s ON s.REGION_ID = r.ID LEFT OUTER JOIN 
 GEBAEUDE f ON s.ID = f.STADT_ID 
ORDER BY 
 r.NAME 
```

检查此链接

[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx)

# facebook - ChannelUrl 根本不加载

> ID：10965959
> 
> 赞同：1
> 
> 时间：2012-06-10T02:21:51.997
> 
> 标签：facebook

根据[Facebook 的文档](http://developers.facebook.com/docs/reference/javascript/)，我`channelUrl: '//www.my-domain.com/fb_channel'`把`FB.init()`. 但是，我根本看不到`www.my-domain.com/fb_channel`Firefox 和 Chrome 的网络检查器已加载。

这是正常的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T09:31:42.040

这是完全正常的。您需要的原因`channelUrl`是您的域和FB之间的跨域通信；它使用嵌套的 IFRAME 进行通信。但是，在较新的浏览器中，您可以使用`window.postMessage`性能更高的 ，因此`channelUrl`在这些情况下不使用 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:28:26.647

频道文件的内容是单行

```
<script src="//connect.facebook.net/en_US/all.js"></script> 
```

因此，如果出现问题，那是您的服务器中的某些内容没有正确加载文件。

# ruby-on-rails - 如何向 *args 添加哈希？

> ID：10965967
> 
> 赞同：8
> 
> 时间：2012-06-10T02:24:03.413
> 
> 标签：ruby-on-rails, ruby

如何有条件地将哈希添加到`*args`Rails 中的数组？如果存在的话，我不想踩踏原始价值。

例如，我有一个接收数组的方法：

```
def foo(*args)
  # I want to insert {style: 'bar'} into args but only if !style.present?
  bar(*args)                              # do some other stuff 
end 
```

我已经开始使用 rails 提供的 extract_options 和 reverse_merge 方法：

```
def foo(*args)
  options = args.extract_options!         # remove the option hashes
  options.reverse_merge!  {style: 'bar'}  # modify them
  args << options                         # put them back into the array
  bar(*args)                              # do some other stuff 
end 
```

它可以工作，但看起来很冗长，而且不是很红宝石。我觉得我错过了什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T03:07:42.820

是的，`#extract_options!`这是在 Rails 中做到这一点的方法。如果你想更优雅，你必须给它起别名，或者找到你自己的方式来处理这个需求，或者搜索已经做过的人的 gem。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-28T18:18:31.637

聚会有点晚了-但如果您需要定期执行此操作，则值得为此使用一些实用方法-例如，如下所示，它将`options`-hash合并到-ary-`args`并负责合并它可能存在散列参数或只是将其附加为新散列，如果没有散列存在于`args`：

```
def merge_into_args!(opts={}, *args)
  opts.each do |key, val|
    if args.any?{|a| a.is_a?(Hash)}
      args.each{|a| a.merge!(key => val) if a.is_a?(Hash)}
    else
      args << {key => val}
    end
  end

  args
end 
```

`options`如果您想将修改后的-hash 合并回`*args`并将它们传递给另一个方法，这会派上用场，例如：

```
 # extract options from args
 options = args.extract_options!

 # modify options
 # ...
 # ...

 # merge modified options back into args and use them as args in another_method
 args = merge_into_args!(options,*args)
 another_method(*args)

 # or as 1-liner directly in the method call:
 another_method(*merge_into_args!(options,*args))

 # and in your case you can conditionally modify the options-hash and merge it 
 # back into the args in one go like this:
 another_method(*merge_into_args!(options.reverse_merge(style: 'bar'),*args)) 
```

更多示例：

```
# args without hash 
args = ["first", "second"]

# merge appends hash
args = merge_into_args!({ foo: "bar", uk: "zok" },*args)
#=> ["first", "second", {:foo=>"bar", :uk=>"zok"}]

# Another merge appends the new options to the already existing hash:   
args = merge_into_args!({ ramba: "zamba", halli: "galli" },*args)
#=> ["first", "second", {:foo=>"bar", :uk=>"zok", :ramba=>"zamba", :halli=>"galli"}]

# Existing options are updated accordingly when the provided hash contains
# identical keys:
args = merge_into_args!({ foo: "baz", uk: "ZOK!", ramba: "ZAMBA" },*args)
#=> ["first", "second", {:foo=>"baz", :uk=>"ZOK!", :ramba=>"ZAMBA", :halli=>"galli"}] 
```

# ruby-on-rails - 将字段从一个模型复制到另一个包含相同字段的模型

> ID：10965971
> 
> 赞同：2
> 
> 时间：2012-06-10T02:24:49.923
> 
> 标签：ruby-on-rails

如果我有一个名为“模板”的模型，其字段为“a、b、c、d、e、f、g”，并且我有一个“报告”模型，该模型具有唯一字段但也与“模板”具有相同的字段：“蓝色,红色,金色,绿色,a,b,c,d,e,f,g')。

在新报告的表单上说，有一个下拉列表可以选择一个模板，该列表的值将是一个模板 ID。因此，在 Reports 的创建操作中，我创建了一个新的 Report 对象，然后通过 id 找到选定的模板。

```
@report = Report.new(params[:report])
@template = find(params[:report][:template_id]) 
```

此时（考虑到@report 对象包括@template 对象所做的所有字段），是否有一种简洁的方法将@template 的值复制到@report 对象中？

谢谢！导轨 2.3.5 / Ruby 1.8.7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:24:18.507

最简单的方法：

```
@report = Report.new(params[:report])
@template = find(params[:report][:template_id])
@template.attributes = @report.attributes #this copies fields from report to template 
```

# cookies - 如何制作一个按钮来更改您的网站主题并使用 cookie 保存？

> ID：10965976
> 
> 赞同：0
> 
> 时间：2012-06-10T02:26:19.500
> 
> 标签：cookies, themes

基本上我想知道如何做的是制作一个按钮，单击该按钮会更改我网站的主题（颜色），并在用户再次使用 cookie 访问网站时保持不变。谁能帮我？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:40:38.473

基本上，每个主题都有一个链接，链接到这样的页面：

```
<a href="setTheme.php?theme=black">Black</a> 
```

然后在 setTheme.php 上，设置一个 cookie 来存储他们的选择：

```
setcookie("userStyleSheet", $_REQUEST["theme"]); 
```

最后，当您打印出指向 CSS 的 HTML 链接时，请打印出正确的 CSS 文件

```
<?php
$cssFile = ($_COOKIE["userStyleSheet"] != "")?$_COOKIE["userStyleSheet"]:"default";
echo '<link type="text/css" rel="stylesheet" href="/theme/path/'.$cssFile.'.css" />';
?> 
```

如果您不使用 PHP，那么它对于任何其他服务器端语言基本上都是一样的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:34:21.263

我认为它不会将其保存在 cookie 中，但希望能有所帮助。它是一个不错的小脚本，我自己使用它。

[http://www.dynamicdrive.com/dynamicindex9/stylesheetswitcher.htm](http://www.dynamicdrive.com/dynamicindex9/stylesheetswitcher.htm)

更新：没关系它确实使用 cookie。

# math - 将一个多边形映射到另一个多边形

> ID：10965977
> 
> 赞同：2
> 
> 时间：2012-06-10T02:26:36.557
> 
> 标签：math, graphics, geometry, computer-vision, linear-algebra

假设我有两个五边形，`A`并且`B`有顶点

(x [1] , y [1] ), (x [2] , y [2] ), ... (x [5] , y [5] )`A`

和

(x' [1] , y' [1] ), ... (x' [5] ,y' [5] ) 对于`B`.

我知道顶点的对应关系：

(x [1] , y [1] ) <==> (x' [1] , y' [1] )

同样的所有顶点。

我需要一个程序将里面的所有点转换`A`为`B`.

[我在将四边形转换为矩形](https://stackoverflow.com/questions/3190483/transform-quadrilateral-into-a-rectangle)中发现了类似的四边形问题？.

就我而言，它们不是四边形，而是五边形。我实际上想要一个适用于任意数量顶点（五边形、六边形等）的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T03:14:54.260

如果您将三角形映射到三角形，您将使用[重心坐标](http://en.wikipedia.org/wiki/Barycentric_coordinate_system_%28mathematics%29)。

要将多边形映射到多边形，可以使用广义重心坐标。这些有好几个家族。[在本文](https://www.mn.uio.no/math/english/people/aca/michaelf/papers/mean_value.pdf)和[后续](http://www.inf.usi.ch/hormann/papers/Hormann.2006.MVC.pdf)文章中介绍了其中一个族——平均值坐标。可以在[此处](http://www.inf.usi.ch/faculty/hormann/barycentric/)找到有关过去十年爆炸式增长的整个主题的良好参考书目。另一篇描述所谓谐波和 Wachpress 坐标的早期论文[在这里](http://www.geometry.caltech.edu/pubs/MHBD02.pdf)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:55:53.697

我会建议，但我无法证明，对于五边形（但可能不是六边形和更高 n 的多边形），当您为每个顶点着色从该顶点可以看到的五边形内部的一组点时，然后它们交叉点总是非空的，您可以从该交叉点任意选择蜘蛛网的中心（或变形的比萨饼，如果您愿意），然后使用三角形映射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T02:48:38.457

我认为您只需将多边形径向细分为三角形（从中心制作披萨片，延伸到顶点），然后找到`(u, v)`原始多边形中任何点的坐标。

一旦你有了这些信息，在第二个多边形中找到对应的三角形将是微不足道的（你已经知道哪些点构成了它的顶点）并且`(u, v)`三角形的映射是有据可查的。

# node.js - 使用 mocha 设置/拆卸 express.js 应用程序

> ID：10965984
> 
> 赞同：18
> 
> 时间：2012-06-10T02:29:09.673
> 
> 标签：node.js, makefile, express, zombie.js

我正在尝试使用 mocha 创建一个独立的测试套件，在一个完美的世界中，它将启动我的 express.js 应用程序，使用僵尸来呈现页面，检查一堆东西，然后拆除/杀死 express.js 应用程序。

有没有简单/最好的方法来做到这一点？

注意。我可以在运行测试之前运行 express 应用程序服务器，但是如果你不打算刮牦牛，那么 Yaks 有什么用。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-17T23:07:12.390

首先，您需要将您的实际应用程序设置移动到一个模块中，并将其导入实际启动您的应用程序的文件中。现在这是分开的，您可以在实际收听之前让应用程序处于完整状态。

您应该将应用程序的实际设置移动到一个单独的文件中，我们称之为 app.js，可以从运行节点的文件中调用监听，我们称之为 index.js。

所以，app.js 看起来像：

```
 var express = require('express')
  , routes = require('./routes');

var app = module.exports = express.createServer();

// Configuration

app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
});

app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.configure('production', function(){
  app.use(express.errorHandler());
});

// Routes

app.get('/', routes.index); 
```

index.js 看起来像：

```
var app = require('./app');

app.listen(3000, function(){
  console.log("Express server listening on port %d in %s mode", app.address().port, app.settings.env);
}); 
```

这将加载您的应用程序与实际监听它分开，允许您将该应用程序加载到您的单元测试中。

在你的单元测试中，你会在 setup 方法和 teardown 方法中做一些事情来启动和关闭服务器。

在文件 test/app_tests.js 中：

```
describe('app', function(){
  var app = require('../app');
  beforeEach(function(){
    app.listen(3000);
  });
  // tests here
  afterEach(function(){
    app.close();
  })
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-01T15:22:36.447

除了 Oved D 答案。

在 express-app.js 或其他文件中描述您的应用程序：

```
module.exports = function (o) {
  o = o || {};
  var app = express();

  // app.configure
  // configure routes
  if (o.someOption) {
    // some additional test code
  }

  return app;
} 
```

在 test/01-some.js 中描述测试：

```
var expressApp = require('../express-app');
describe('some', function () {

  // just describe needed vars
  var app, server, port;

  // describe setup
  before(function (next) {
    // create app when 
    app = expressApp({routes: /api\/some\/.*/ /* put here some test options ...*/});
    // creating listener with random port
    server = app.listen(function () {
      // store port when it ready
      port = server.address().port;
      // and go to tests
      next();
    });
  });

  // tests
  it('should return valid result', function (done) {
    // do a simple request to /api/some
    http.request({
      host: 'localhost',
      port: port,
      path: '/api/some'
    }, function (res) {
      if (res.err) throw new Error(res.err);
      done();
    });
  });

  // teardown
  after(function () {
    // stop listening that port
    server.close();
  });

}); 
```

完毕。;-)

现在您可以创建任意数量的这样的测试。建议您通过将参数传递给 express-app.js 模块来定义测试中仅需要的 url 和服务。

* * *

*更新：*

不确定它是如何工作的，`mocha`但最好移动`before`和`after`调用`init.js`并加载它`mocha --require init.js`。

文件应如下所示：

```
// use it in your mocha tests
global.setupEnv = function setupEnv (o, before, after) {

    // just describe needed vars
    var env = Object.create(null);

    // setup
    before(function (next) {
        // create app
        env.app = expressApp(o);
        // creating listener with random port
        env.server = env.app.listen(function () {
            // store port when it ready
            port = env.server.address().port;
            env.app.log('Listening on ', env.port);
            // and go to tests
            next();
        });
    });

    // teardown
    after(function () {
        // stop listening that port
        env.server.close();
    });

    return env;
} 
```

在你的测试中：

```
// requiring dependencies
var request = require('request');

describe('api', function () {

    // describe setup
    var env = global.setupEnv({
            routes: 'api/some'
        }, before, after);

    // tests
    it('should pass', function (done) {
        request('http://localhost:' + env.port, function (error, response, body) {
            done();
        });
    });

}); 
```

# javascript - 您如何使用 JavaScript 强制 Chrome 页面/标签崩溃？

> ID：10965987
> 
> 赞同：50
> 
> 时间：2012-06-10T02:30:22.917
> 
> 标签：javascript, google-chrome, google-chrome-extension

试图设置`window.location`或使用`window.navigate()`使浏览器进入`about:crash`或`chrome://crash`不起作用。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-06-10T03:21:58.687

有趣的循环：

```
txt = "一个";
而（1）{
    txt = txt += "一个"; //添加尽可能多的浏览器可以处理
}
// *[邪恶的笑声]* BOOM！所有内存都用完了，现在已经崩溃了！

```

[http://jsfiddle.net/DerekL/M45Cn/1/](http://jsfiddle.net/DerekL/M45Cn/1/)

![在此处输入图像描述](../Images/7ec99f9a30a998005dd56da42fe71eef.png)

> 对不起中国字...

* * *

## 额外的

Fun Fun Loop 也适用于 Firefox！ ![在此处输入图像描述](../Images/9aa6eb2acb77141299e75acdcfabf3de.png)

我不得不给 Safari 鼓掌，因为它会在即将崩溃时***自动重新加载页面！***干得好 Webkit 开发人员！

## 哦耶...

**警告：不要在 Internet Explorer 中尝试...**因为它不是我的浏览器崩溃了，而是我的 Windows 7 崩溃了... ![在此处输入图像描述](../Images/8245d8ca41682f244578f8e948d9e330.png) 是的。在那之后我必须重新启动计算机。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-09-29T09:06:05.387

我意识到这个问题已经有一年多了，但[显然](https://twitter.com/ChromiumDev/status/309726287122030592)你可以使用`chrome://inducebrowsercrashforrealz`.

以下是附加调试`chrome://`URL 的列表，取自`chrome://about`：

```
chrome://crash
chrome://kill
chrome://hang
chrome://shorthang
chrome://gpuclean
chrome://gpucrash
chrome://gpuhang
chrome://ppapiflashcrash
chrome://ppapiflashhang
chrome://restart 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-12T10:57:29.410

简单在chrome地址栏输入下面一行代码，就可以看到一个Chrome标签崩溃模拟：

```
chrome://crash 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-12-31T22:17:08.727

这是迄今为止最简单的方法。为数组创建一个尽可能多的数组。这不会占用计算机的内存，但会在几秒钟内使页面崩溃。

```
[...Array(2**32-1)] 
```

假设您的计算机可以处理这个（它不应该）。试试这个给你的电脑更多的压力：

```
[...Array(2**32-1)].map(_=>Math.ceil(Math.random()*111)) 
```

这些可以从地址栏调用：

```
javascript:[...Array(2**32-1)] 
```

## 或者

```
javascript:[...Array(2**32-1)].map(_=>Math.ceil(Math.random()*111)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-23T08:58:08.867

# 在 Reddit 上找到这个

在几秒钟内使 i5 8th Gen 崩溃。

```
for (var i = 5; i > 3; i = i + 1)
  { console.log(i); }
```

```
<html>
<h1>This Should Crash Your Browser</h1>
</html>
```

# 免责声明

如果您运行此代码，这将在几秒钟内使您的 StackOverflow 页面崩溃。

# c++ - C++ 模板/泛型错误

> ID：10965990
> 
> 赞同：0
> 
> 时间：2012-06-10T02:32:03.073
> 
> 标签：c++, templates, generics, sfml

我有一个简单的函数设置来检查值是否在 std::vector 中，并且我想使用“模板”来将函数与所有类一起使用。

一些定义

```
std::vector<ItemID_t> *spareItems;
ItemID_t newItem;//note this is an enumeration value 
```

如果我用

```
bool b = !vectorContains(*spareItems,newItem); 
```

功能看起来像

```
bool vectorContains(std::vector<ItemID_t> &vector,const ItemID_t& value){
    return std::find(vector.begin(), vector.end(), value)!=vector.end();
} 
```

但是如果我尝试通过调用实现泛型

```
bool b = !vectorContains<ItemID_t>(*spareItems,newItem); 
```

和函数定义

```
 template <class T>
 bool vectorContains(std::vector<T> &vector,const T& value){
    return std::find(vector.begin(), vector.end(), value)!=vector.end();
} 
```

它在第二个示例中失败并给了我这个链接器错误

```
error LNK2019: unresolved external symbol "bool __cdecl turtle::vectorContains<enum turtle::ItemID_t>(class std::vector<enum turtle::ItemID_t,class std::allocator<enum turtle::ItemID_t> > &,enum turtle::ItemID_t const &)" (??$vectorContains@W4ItemID_t@turtle@@@turtle@@YA_NAAV?$vector@W4ItemID_t@turtle@@V?$allocator@W4ItemID_t@turtle@@@std@@@std@@ABW4ItemID_t@0@@Z) referenced in function "public: void __thiscall turtle::Barracks::swapItems(int,enum turtle::ItemID_t)" (?swapItems@Barracks@turtle@@QAEXHW4ItemID_t@2@@Z) 
```

谢谢

# c++ - _CRT_DEBUGGER_HOOK 致命错误

> ID：10965995
> 
> 赞同：0
> 
> 时间：2012-06-10T02:33:00.453
> 
> 标签：c++, windows, fatal-error

我在我的 c++ 函数中描述了一个相同的问题，[它将](https://stackoverflow.com/questions/280477/crt-debugger-hook-throws-exception)几个数组的值写入一个文件。在下文中，我带来了执行此操作的代码部分。

```
double *VAR = new double[NumPts];
for( iArray = 0; iArray<nArrays; iArray++)
    for( iComp=0; iComp<nComponents; iComp++ )
    {                       
        for ( k=0; k<dims[2]; k++ )
        {       
            kOffset = k * dims[0] * dims[1];
            for ( j=0; j<dims[1]; j++ ) 
            {           
                jOffset = j * dims[0];
                for ( i=0; i<dims[0]; i++ ) 
                {               
                    id = i + jOffset + kOffset;
                    Values = sgrid->GetArray( iArray )->GetComponent( id, iComp );

                    VAR[ id] = Values;                                                                          
                }
            }
        }   

        INTEGER4 DIsDouble = 1;
        // Writing the array into the file.
        I = TECDAT112( &NumPts, &VAR[0], &DIsDouble );
    }        

// Close the file.
I = TECEND112(); 
```

我有 5 个数组存储在一个名为 sgrid 的类实例中。数组要么是三维的，要么是一维的。组件总数为 12。每个组件都可以通过 GetArray 和 GetComponent 函数检索。上面的代码循环遍历所有组件，并通过库中的 TECDAT112 函数将它们的值写入文件。（我也在 VS2008 x64 中使用调试模式。）

似乎我的问题的原因有点不同，而不是因为依赖项没有在 VS2008 中编译。实际上，循环继续完美运行，组件 1-9 的值已成功写入。当代码尝试写入组件#10 的值时，就会出现问题。从那里，我得到错误：

“Microsoft Visual Studio C 运行时库检测到致命错误”

并指向函数_CRT_DEBUGGER_HOOK。为了验证这个假设，如果数组及其组件存在问题，我注释掉了将值写入文件的行，并注意到循环成功地遍历了所有 12 个组件。问题可能是因为内存问题吗？

# sql - 一个一对多的关系模型，其中右侧的数据可能非常多变？

> ID：10965997
> 
> 赞同：0
> 
> 时间：2012-06-10T02:33:25.367
> 
> 标签：sql, orm, relational-database

这是我要解决的问题：

```
Entity A : a_id
Entity B : b_id
One A can use Many B's. However, not all Bs are used by all As. 
```

这是我能想到的最好的例子：

```
One teacher has many students.
Some students are taught by more than one teacher. 
```

什么是关系，所以我可以添加/删除由一位老师教的学生，但不影响已经教过学生的老师？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:36:10.917

您需要一个 StudentTeacher 实体，它将两者联系在一起。它将有一个 a_id 列和一个 b_id 列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T02:42:39.480

您需要第三个表，称为这两个表之间的映射。创建此表，以便：

```
Table Student_Teacher_Mapping

   Id (Int)
   TeacherId(Int)  // foreign key for teacher table  
   StudentId(Int)  // foreign key for student table 
```

我想这就是你想要的。