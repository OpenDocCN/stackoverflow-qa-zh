# StackOverflow 问答 12394000-12394999

# c++ - 在 C/C 中链接 MySQL 的 .lib

> ID：12394001
> 
> 赞同：0
> 
> 时间：2012-09-12T18:11:31.060
> 
> 标签：c++, mysql, visual-studio, static, linker

所以，经过一整天的尝试和努力，我仍然无法回答这个问题。我完全了解 [这个线程](https://stackoverflow.com/questions/7976014/static-linking-of-mysql-in-c-c)和[这个](https://stackoverflow.com/questions/1450452/mysql-connector-c-library-linking-error-problem)线程， 但他们并没有完全回答这个问题。

所以，问题是在编译程序时，比方说，像这样：

```
#include <iostream>
#include <windows.h>
#include <mysql.h>
using namespace std;
int main()
{
    MYSQL *connection, mysql;
    MYSQL_RES *result;
    MYSQL_ROW row;
    mysql_init(&mysql);
} 
```

我得到链接器错误

```
undefined reference to `mysql_init@4' 
```

我尝试同时和分别添加到输入部分 libmesql.lib 和 mysqclient.lib。尝试将 .lib 文件复制到 Visual Studio 默认文件夹，而不是尝试通过在链接器->常规->附加库目录中设置路径来编译它。也尝试了#pragma 评论 - 仍然无济于事。

因此，如果有人可以解释我做错了什么（可能是解决此问题的方法），将不胜感激。

ps 请不要用指向 MySQL 文档的链接来回答 - 我在[这里](https://stackoverflow.com/questions/7976014/static-linking-of-mysql-in-c-c)找到了它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:13:10.107

将您的代码与**mysqlclient.lib**链接。

**属性->链接器->常规->附加库**

在此处添加库的路径。

# ruby-on-rails - 保存多对多关系记录的最佳方法

> ID：12394004
> 
> 赞同：0
> 
> 时间：2012-09-12T18:11:35.073
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在解析 excel 并将员工和项目原始数据保存到规范化表中。我有 2 个模型

```
Excel Like 
```

![在此处输入图像描述](../Images/7c14ef985e9b3ca3a10a39e6bd48caaa.png)

员工.rb

```
class Employee < ActiveRecord::Base
 attr_accesible :name. :salary, :band
 has_and_belongs_to_many :projects
end 
```

项目.rb

```
class Project< ActiveRecord::Base
  attr_accesible :name
  has_and_belongs_to_many :employees
end 
```

创建了一个连接表

```
employees_projects 
```

现在我正在做一些接近

```
Employee.transaction do
    1000.times do |i|
     emp = Employee.new(:name => 'Employee#{i}',
                       :salary => i * 1000,
                       :band => 'A')
     emp.projects.push(Project.find(i)) #the projects are already populated bfr this activity
     emp.save!
    end
end 
```

**请提出一些更好的方法来在一行中保存与员工的项目关联**

# ruby-on-rails-3.2 - assets/stylesheets 目录中的样式表是否会自动应用于所有视图？

> ID：12394008
> 
> 赞同：0
> 
> 时间：2012-09-12T18:12:20.147
> 
> 标签：ruby-on-rails-3.2, asset-pipeline

这不是我对资产管道的期望。

假设我有一个名为“bugs_controller.rb”的控制器。生成控制器还会在资产管道中为我提供一个样式表，称为：

```
bugs.css.scss 
```

现在，我在 Rails 3.2.8 应用程序中使用 simple_form_for。我希望我在这个控制器中的表单元素用 布局`float:le ft`，所以在 bugs.css.scss 中我放了：

```
.control-group {
  float: left;
} 
```

但是当我这样做时，它会将这种风格应用于我的**所有**观点。

这意味着资产管道提供关注点分离，仅用于与 CSS 相关的维护目的。这是正常功能吗？如果是这样，在每个页面上加载用户不需要的 CSS 背后的原因是什么？还是我的应用程序错误地将 bugs.css.scss 加载到其他视图上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T02:15:11.680

您正在加载 application.css 吗？如果你是并且你有这条线 *= require_tree 。然后将加载样式表文件夹中的所有 css 文件。我是rails 3的新手，不确定这是否是推荐的方法，但是当我需要做你要求的事情时，在我的布局文件中，在加载需要在任何地方加载的css文件后的head标签中我放

```
<%= yield :css_files %> 
```

然后在文件顶部需要一些其他特定 css 文件的其他视图中，我添加

```
<%= content_fo :css_files do %>
     <%= stylesheet_link_tag 'whatever.css' %>
<% end %> 
```

希望这会有所帮助。

或者，您始终可以将表单包装在具有 id 的容器中，并在该特定容器的 css 目标 .control-group 中：

```
#form-wrapper .control-group
{
     float: left;
} 
```

# vb.net - 使用 HttpWebRequest 或类似工具扫描数百个网站

> ID：12394013
> 
> 赞同：0
> 
> 时间：2012-09-12T18:12:33.683
> 
> 标签：vb.net, multithreading, httpwebrequest, webrequest, pooling

我有带有 HttpWebRequest 的 VB 代码，它收集了数百个网站的 html，但需要很长时间才能完成任务。代码基本上是一个 for-to-loop 并读取列表框中每个网站的 html。在一个循环中，在每个网站的提取的 html 中搜索特定的单词。我想显示每个单词列下都有单词的网站列表。

```
 For Each webAddr As String In lstbox.Items

        strHtml = Make_A_Call(webAddr)

        If strHtml.Contains("Keyword1") Then
            ..........
        End If
        If strHtml.Contains("Keyword2") Then
             ..........
        End If
        ..........
        ..........
        ..........
        ..........
        ..........
    Next

Private Function Make_A_Call(ByVal strURL As String) As String
    Dim strResult As String
    Dim wbrq As HttpWebRequest
    Dim wbrs As HttpWebResponse
    Dim sr As StreamReader

    Try
        strResult = ""
        wbrq = WebRequest.Create(strURL)
        wbrq.Method = "GET"
        ' Read the returned data   
        wbrs = wbrq.GetResponse
        sr = New StreamReader(wbrs.GetResponseStream)
        strResult = sr.ReadToEnd.Trim
        sr.Close()
        sr.Dispose()
        wbrs.Close()
    Catch ex As Exception
        ErrMessage.Text = ex.Message.ToString
        ErrMessage.ForeColor = Color.Red
    End Try
    Return strResult
End Function 
```

编译后的代码需要将近 5 分钟才能完成循环。有时它无法完成。是否可以对其进行修改以提高性能。请帮助提供更好的代码和建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:20:04.703

请记住，有两个单独的瓶颈：

*   下载 HTML 的带宽
*   CPU处理

您不一定可以使用并行处理来加快下载速度；这只能通过购买更多带宽来帮助。但是，您可以做的是确保下载和处理在单独的线程上完成。我建议执行以下操作：

*   使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)实例下载数据。
*   在*工作完成*回调中，首先触发下一个后台工作人员，然后处理现有工作人员的结果（关键字搜索）。

# sql-server - 在子查询中使用带有多个元素的位置选择

> ID：12394021
> 
> 赞同：2
> 
> 时间：2012-09-12T18:13:13.063
> 
> 标签：sql-server, tsql

以下代码不起作用，但我使用的是我要完成的示例：

```
SELECT thing_id
FROM table_of_things
WHERE table_of_things.thing_color, table_of_things.thing_flavor IN 
                          ( SELECT good_color,good_flavor FROM good_things ) 
```

编辑：很明显，我的代码对某些人来说很明显。我正在尝试使用子查询中的两个条件从 table_of_things 中获取 things_id。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T18:17:31.997

您尚未提出问题，但我怀疑您需要将查询更改为以下内容：

```
SELECT thing_id
FROM table_of_things
WHERE table_of_things.thing_color IN  ( SELECT good_color FROM good_things )
AND table_of_things.thing_flavor  IN  ( SELECT good_flavor FROM good_things ) 
```

或许：

```
SELECT thing_id
FROM table_of_things as tot
INNER JOIN good_things as gt
ON tot.thing_color = gt.good_color AND tot.thing_flavor = gt.good_flavor 
```

in 语句只能检查一个值，而不是像您尝试做的那样检查两个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T03:24:04.383

**使用连接**

```
SELECT t.thing_id
FROM table_of_things t
JOIN good_things gt 
ON t.thing_color = gt.good_color 
AND t.thing_flavor =  gt.good_flavor 
```

**使用联合**

```
SELECT t.thing_id FROM table_of_things t WHERE t.thing_color IN ( SELECT good_color FROM good_things )
UNION 
SELECT t.thing_id FROM table_of_things t WHERE t.thing_flavor IN ( SELECT good_flavor FROM good_things ) 
```

**使用 EXIST**

```
SELECT t.thing_id FROM table_of_things t 
WHERE EXISTS ( SELECT good_color,good_flavor FROM good_things) 
```

# php - 从 sql 获取数据到下拉列表中（html 中的选择\选项）

> ID：12394025
> 
> 赞同：1
> 
> 时间：2012-09-12T18:13:17.820
> 
> 标签：php, html

我正在尝试在 html 中构建一个下拉元素，并根据用户预先选择添加值。假设我有一个表，其中一个是游戏类型，第二个是名称字段。因此，如果用户的第一个下拉选项是篮球 - 则打开另一个下拉列表，其中所有篮球场作为选项。

所以我有我的 html 文件，其中包含以下 php 行：

```
$game_type = $_POST['gameType'];

$con = mysql_connect("localhost", "root", "Jbtraining1");
if (!$con)
    die('Could not connect: ' . mysql_error());

$db_selected = mysql_select_db("test_sport",$con);
$sql = ("SELECT * FROM fields WHERE game_type = '$game_type'");
$result = mysql_query($sql,$con);

while($row = mysql_fetch_array($result))
    echo "<option value='".$row['field_name_en']."'>" . $row['field_name_en'] . "</option>";
?>
</select> 
```

但这条线不起作用。我认为大多数线路都很好，因为如果我改变这条线路：

$game_type = $_POST['gameType'];

让我们对这条线说-

$game_type = "篮球";

它确实工作得很好。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T22:07:05.433

将文件扩展名从更改`.html`为`.php`

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T07:44:56.193

利用

```
 echo $_POST['gameType']; 
```

查看变量是否已发送。

听起来它没有发送，因为您说它在使用时有效：

```
 $game_type = "basketball"; 
```

如果 echo 为空，则在发送变量时会出现问题。

如果是这种情况，请发布您用于发布变量的代码。

# php - 使用 PHP 的 cURL 多线程

> ID：12394027
> 
> 赞同：11
> 
> 时间：2012-09-12T18:13:38.353
> 
> 标签：php, curl, nginx

我正在使用 cURL 来获取存储在数据库中的 20,000 多个域名的排名数据。

我使用的代码是[http://semlabs.co.uk/journal/object-oriented-curl-class-with-multi-threading](http://semlabs.co.uk/journal/object-oriented-curl-class-with-multi-threading)。

数组 $competeRequests 是 20,000 个对网站排名的competition.com api 的请求。

这是一个示例请求： [http](http://apps.compete.com/sites/stackoverflow.com/trended/rank/?apikey=xxxx&start_date=201207&end_date=201208&jsonp=) ://apps.compete.com/sites/stackoverflow.com/trended/rank/?apikey=xxxx&start_date=201207&end_date=201208&jsonp = ";

由于有 20,000 个这样的请求，我想将它们分成块，所以我使用以下代码来完成它：

```
foreach(array_chunk($competeRequests, 1000) as $requests) {
    foreach($requests as $request) {
        $curl->addSession( $request, $opts );
    }

} 
```

这非常适合批量发送 1,000 个请求，但是脚本执行时间过长。我已将 max_execution_time 增加到 10 分钟以上。

***有没有办法从我的数组发送 1,000 个请求，然后解析结果，然后输出状态更新，然后继续下一个 1,000 个请求，直到数组为空？到目前为止，在脚本执行的整个过程中屏幕一直保持白色，可能超过 10 分钟。***

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-05-19T12:10:19.923

上述接受的答案已过时，因此必须对正确答案进行投票。

[http://php.net/manual/en/function.curl-multi-init.php](http://php.net/manual/en/function.curl-multi-init.php)

现在，PHP 支持同时获取多个 URL。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-03T18:44:59.563

这个总是为我做这项工作...... [https://github.com/petewarden/ParallelCurl](https://github.com/petewarden/ParallelCurl)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-13T18:55:56.787

[https://github.com/krakjoe/pthreads](https://github.com/krakjoe/pthreads)

![在此处输入图像描述](../Images/ebf9f1e336cff1397989db788c22c4a1.png)

您可以使用 PHP 进行线程化，所描述的代码只是可怕的线程编程，我不建议您这样做，但想向您展示 20,000 个线程的开销......这是 18 秒，在我目前的硬件上是具有 8gigs 内存的 Intel G620（双核），在服务器硬件上，您可以期待更快的结果......如何处理这样的任务取决于您的资源，以及您请求的服务的资源......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-12T18:27:48.317

把它放在你的 php 脚本的顶部：

```
set_time_limit(0);
@apache_setenv('no-gzip', 1);//comment this out if you use nginx instead of apache
@ini_set('zlib.output_compression', 0);
@ini_set('implicit_flush', 1);
for ($i = 0; $i < ob_get_level(); $i++) { ob_end_flush(); }
ob_implicit_flush(1); 
```

这将禁用 Web 服务器或 php 可能正在执行的所有缓存，使您的输出在脚本运行时显示在浏览器上。

`apache_setenv`如果您使用 nginx Web 服务器而不是 apache，请注意注释掉该行。

**nginx的更新：**

所以 OP 正在使用 nginx，这让事情变得有点棘手，因为 nginx 不允许从 PHP 禁用 gzip 压缩。我也使用 nginx，但我发现它默认处于活动状态，请参阅：

```
cat /etc/nginx/nginx.conf | grep gzip
    gzip on;
    gzip_disable "msie6";
    # gzip_vary on;
    # gzip_proxied any;
    # gzip_comp_level 6;
    # gzip_buffers 16 8k;
    # gzip_http_version 1.1;
    # gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript; 
```

所以你需要在 nginx.conf 上禁用 gzip 并重新启动 nginx：

`/etc/init.d/nginx restart`

或者您可以使用[gzip_disable](http://wiki.nginx.org/HttpGzipModule#gzip_disable)或[gzip_types](http://wiki.nginx.org/HttpGzipModule#gzip_types)选项，分别有条件地禁用某些浏览器或某些页面内容类型的 gzip。

# python - 强制代码流转到除块

> ID：12394029
> 
> 赞同：6
> 
> 时间：2012-09-12T18:13:40.597
> 
> 标签：python

我有：

```
try:
   ...
except Exception, e:
   print "Problem. %s" % str(e) 
```

但是，在尝试的某个地方，我需要它表现得好像遇到异常一样。这样做是不符合pythonic的吗：

```
try:
   ...
   raise Exception, 'Type 1 error'
   ...

except Exception, e:
   print "Problem. Type 2 error %s" % str(e) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T18:22:20.470

我认为这是一个糟糕的设计。如果您需要在（且仅当）未引发异常时采取一些措施，这就是该`else`子句的用途。如果你需要无条件地采取一些行动，这就是`finally`目的。这是一个演示：

```
def myraise(arg):
    try:
        if arg:
            raise ValueError('arg is True')
    except ValueError as e:
        print(e)
    else:
        print('arg is False')
    finally:
        print("see this no matter what")

myraise(1)
myraise(0) 
```

您需要将无条件代码考虑在内`finally`并将其他内容适当地放入`except`/`else`中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T18:22:33.167

我认为你正在做的是“unPythonic”。尝试实际上应该只涵盖您期望有时可能会以某种方式失败的代码的一小部分（理想情况下是一行）。您应该能够使用 try/except/else/finally 来获得所需的行为：

```
try:
    #line which might fail
except ExceptionType: # the exception type which you are worried about
    #what to do if it raises the exception
else:
    #this gets done if try is successful
finally:
    #this gets done last in both cases (try successful or not) 
```

# regex - 这个 Perl 代码如何将字符串拆分为三个字符的块？

> ID：12394033
> 
> 赞同：1
> 
> 时间：2012-09-12T18:13:54.323
> 
> 标签：regex, perl, split

我有一个字符串，我需要将其拆分为三个字符的块。谷歌搜索发现以下代码，它工作正常：

```
$input = "DEADBEEF";
@output = ();
my @output = ( $input =~ m/.{3}/g );
print $_."\n" foreach (@output); 
```

我是 Perl 初学者；有人可以向我解释一下这个表达式的`$input =~ m/.{3}/g`作用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T18:16:33.263

```
$input - scalar variable
=~     - apply regular expression
m      - Match (in list context so return a list of matched substrings)
/      - start of expression
.      - any character
{3}    - 3 times
/      - end of expression
g      - globally 
```

# hibernate - JPQL 中的 HQL 'with' 子句

> ID：12394038
> 
> 赞同：6
> 
> 时间：2012-09-12T18:14:08.567
> 
> 标签：hibernate, hql, jpql

来自 Hibernate 3.6 文档：

> 您可以使用 HQL with 关键字提供额外的连接条件。

```
from Cat as cat
left join cat.kittens as kitten
    with kitten.bodyWeight > 10.0 
```

该`with`子句允许对 JOIN 条件（ON 子句）添加限制。JPQL中有这样的东西吗？

当我运行以下 JPQL 时：

```
select c from ContainerDef c left join fetch c.displayState ds where c.id = 1 and ds.user.id = 2 
```

生成以下 SQL：

```
select
        ...
    from
        CONTAINER_DEF containerd0_ 
    left outer join
        USER_CONTAINERDEF displaysta1_ 
            on containerd0_.CONTAINERDEF_ID=displaysta1_.CONTAINERDEF_ID 
    where
        containerd0_.CONTAINERDEF_ID=? 
        and displaysta1_.AUTHUSER_ID=? 
```

真正应该生成的是：

```
select
        ...
    from
        CONTAINER_DEF containerd0_ 
    left outer join
        USER_CONTAINERDEF displaysta1_ 
            on containerd0_.CONTAINERDEF_ID=displaysta1_.CONTAINERDEF_ID 
            and displaysta1_.AUTHUSER_ID=?
    where
        containerd0_.CONTAINERDEF_ID=? 
```

我确定我错过了 HQL 的正确 JPQL 子句`with`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:37:31.603

但是您可以使用 Criteria API 来做到这一点

```
 Criteria crit = session.createCriteria(Cat.class);
    crit.createAlias("kittens", "kitten", 
        Criteria.LEFT_JOIN, Restrictions.gt("weight", 10.0);

    List<Cat> catsWithFatKittens = crit.list(); 
```

`Criteria.createAlias()`这是以Restriction 对象作为第四个参数的几乎没有记录的签名。它运行良好，值得学习 Criteria API 来获得该功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-10T20:03:14.733

JPA 2.1 添加了对[ON 连接](http://en.m.wikibooks.org/wiki/Java_Persistence/JPQL#ON_.28JPA_2.1.29)条件的支持。

它也是比 HQL 'with' 子句更好的名称选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T18:22:40.277

不，JPQL 中没有这样的功能。[JPA 2.1 主题列表](http://jcp.org/en/jsr/detail?id=338)中提到了对特定条件加入的支持：

> -- 支持带有 ON 条件的外连接；

所以也许JPQL将来会有它。

# verilog - Verilog 输入线有问题

> ID：12394040
> 
> 赞同：4
> 
> 时间：2012-09-12T18:14:17.973
> 
> 标签：verilog

作为记录，我是一个完整的 Verilog 新手。我正在编写一个使用一些双向总线的模块。

```
inout wire [KEY_SIZE-1:0] prevKey;
inout wire [TAG_SIZE-1:0] prevTag;

inout wire [KEY_SIZE-1:0] nextKey;
inout wire [TAG_SIZE-1:0] nextTag; 
```

我知道我是如何从公共汽车上读取东西的，但是我如何在上面写东西呢？如果我对 a 使用 assign 语句，当新数据进入网络时`reg`，该值是否会被破坏？`reg`处理一个`inout`端口是否值得麻烦，或者我应该为每个端口制作一个`input`和和`output`总线？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T18:34:57.183

> 如果我对 reg 使用分配语句...

这句话没有真正的意义，你不会对 regs 进行分配，而是对电线进行分配。

驱动输入输出线的简单示例：

```
inout wire bidir_wire;

reg drive_value;
reg drive_enable;
reg something;

assign bidir_wire = drive_enable ? drive_value : 1'bz; 

always @(posedge clk) begin
    drive_value  <= ... ;  //assign a drive value based on some criteria
    drive_enable <= ...;
    something    <= bidir_wire; //do something with the input value
end 
```

# xml - Xcode：XML 解析器分组

> ID：12394043
> 
> 赞同：0
> 
> 时间：2012-09-12T18:14:32.410
> 
> 标签：xml, xcode

我想要实现的是以下。我有一个 MySQL 数据库，并在 PHP 脚本中使用 SimpleXML 将那里的条目转换为 XML。所以我有一个'id'、'department'、'name'、'tel'和一个'email'字段。PHP 将其解析为这个输出（不知道这是否是最合乎逻辑的输出，但似乎合法）（主唯一键 'id' 已被省略）

```
<?xml version="1.0" encoding="UTF-8" ?>
<entries>
<entry>
<department>DeptA</department>
<name>NameA</name>
<tel>0000-111111</tel>
<email>namea@abc.com</email>
</entry>
<entry>
<department>DeptB</department>
<name>NameB1</name>
<tel>0000-2222222</tel>
<email>nameb1@abc.com</email>
</entry>
<entry>
<department>DebtB</department>
<name>NameB2</name>
<tel>0000-2222223</tel>
<email>nameb2@abc.com</email>
</entry>

more entry

</entries> 
```

所以我在 Xcode 中有三个视图。第一个视图 (MasterViewController) 应将部门报告为唯一值。在上面的 XML DebtA 和 DebtB 中。（更多在实际 XML 中）并在表格视图中列出它们。尝试使用 NSSlist *uniqueArray （等）执行此操作但没有成功。然后，当单击 MasterViewController 中的一个部门时，您将进入 DebtViewController，其中列出了在该特定部门工作的所有员工的姓名。因此对于应为 NameB1 和 NameB2 的 DebtB。（仅债务 A 名称 A）。最后一个视图是一个 DetailViewController，其中列出了在 DebtViewController 中单击的特定名称的详细信息。详细信息，例如姓名、电话和电子邮件。（也许当我掌握了它的窍门时的一张照片）

所以具体来说，问题是我已经为此苦苦挣扎了好几天，想知道我应该采取的最佳路线是什么。我目前使用的 XML 对我想要完成的任务有什么好处吗？在用 xcode 解析之前，我应该用 XML 将部门组合在一起吗？还是以后也可以这样做？如果是这样，请提出一些建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:00:51.543

您走在正确的轨道上-根据您要执行的操作，我建议将 xml 文件格式化为：

```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE plist SYSTEM "file://localhost/System/Library/DTDs/PropertyList.dtd">

<plist version="1.0">

<dict>

   <key>DeptA</key>

         <array>

            <dict>

               <key>Name</key>

               <string>NameA</string>

               <key>tel</key>

               <string>0000-111111</string>

               <key>email</key>

               <string>namea@abc.com</string>

            </dict>

         </array>

   <key>DeptB</key>

         <array>

            <dict>

               <key>Name</key>

               <string>NameB1</string>

               <key>tel</key>

               <string>0000-222222</string>

               <key>email</key>

               <string>nameb1@abc.com</string>

            </dict>

            <dict>

               <key>Name</key>

               <string>NameB2</string>

               <key>tel</key>

               <string>0000-222223</string>

               <key>email</key>

               <string>nameb2@abc.com</string>

            </dict>

         </array>

</dict> 
```

它比您到目前为止所获得的要复杂一些，但这允许您通过执行以下操作将文件的内容直接读取到 NSDictionary 对象中：

```
NSDictionary * departmentDictionary = [[NSDictionary alloc] initWithContentsOfFile:"/path/to/xml/file.xml"]; 
```

完成此操作后，您可以通过执行以下操作获取代表部门名称的字符串列表：

```
NSArray * departmentList = [departmentDictionary allKeys]; 
```

此行将为您提供 DeptB 中所有员工的列表：

```
NSArray * deptBEmployees = [departmentDictionary objectForKey:@"DeptB"]; 
```

员工列表以 NSDictionary 对象数组的形式返回，每个对象都存储了键 @"Name"、@"tel" 和 @"email" 的值。

正如您所看到的，它确实变得有点复杂，但相信我——一旦您掌握了窍门，存储和读取非常复杂的 xml 数据就变得非常容易。MacOS 甚至有一个属性列表编辑器，它提供了一个很好的界面来创建可以被 XCode 读取的这种类型的 xml 文件。

我推荐这个链接——当我学习做这类事情时，它对我很有帮助： [https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction。 html#//apple_ref/doc/uid/10000048-CJBGDEGD](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction.html#//apple_ref/doc/uid/10000048-CJBGDEGD)

# session - CakePHP：如果设置，我如何在控制器中读取闪存消息的字符串值？

> ID：12394047
> 
> 赞同：0
> 
> 时间：2012-09-12T18:14:41.237
> 
> 标签：session, cakephp, flash-message

我需要知道这一点，以便在需要时附加消息（闪烁）。

这样我可以给用户完整的反馈并避免一个闪存被覆盖（在重定向中，例如，最后一个控制器通常可以做到这一点）。

我阅读了文档，但在 setFlash() 中没有找到任何需要此附加的选项。

我知道有一个 Session::read()，但我不知道要搜索什么键..

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T07:06:16.370

可以使用以下方法检索闪存消息：

```
$message = $this->Session->read('Message.flash.message');
echo $message; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T00:14:00.790

您正在寻找的是：

```
$this->Session->read('Message'); 
```

Message 是保存当前用户会话消息的键，无论是 flash 消息还是 auth 消息。一个简单的 pr($this->Session->read()) 会给你类似的输出：

```
Array(
    ['Auth'] => array(
        ... your auth keys and values here
    ),
    ['Message'] => array(
        ['flash'] => ... your current flash message array (if any)
        ['auth'] => ... your current auth message array (if any)
    )
) 
```

虽然我不确定你为什么担心。当你这样做

```
$this->Session->setFlash('your message');
$this->redirect('/'); 
```

即使您确实有重定向，会话消息也会保留并显示在重定向页面上。您只需要确保您正在输出闪存消息。

# android - android - 检查RAW目录中加载了哪种语言文本文件（DE，EN）

> ID：12394049
> 
> 赞同：0
> 
> 时间：2012-09-12T18:14:44.000
> 
> 标签：android

我在 RAW 目录中有一个文本文件

称为 test.txt

**我的 java 代码使用设备语言德语**正确检查了 test.txt文件。**当设备语言为英语时，我如何检查 EN 文件？**

 **我认为在我的代码的第 3 行中，我必须设置一个 if-else 块来证明原始目录？

非常感谢帮助！

**我的 Java 代码（作品）：**

* * *

```
 TextView HelpTxtMain;

     HelpTxtMain = (TextView)findViewById(R.id.TextViewMain);
     HelpTxtMain.setText(readTxtDe());

 private String readTxtDe() {

     InputStream inputStream = getResources().openRawResource(R.raw.test);

     ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

    int i;

    try {
       i = inputStream.read();
    while (i != -1)
     {
      byteArrayOutputStream.write(i);
      i = inputStream.read();
     }

     inputStream.close();
    } catch (IOException e) {

   // TODO Auto-generated catch block

     e.printStackTrace();
    }

  return byteArrayOutputStream.toString();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:17:32.330

尝试将文件重命名为“test.txt”并将它们放入目录中`values-de`，`values-en`或者更好地将英语文件放入`values`目录中以将英语设置为默认语言。

Android 将根据当前语言选择正确的文件。**

# ios - Core Plot 1.0 我的触摸注释不起作用

> ID：12394050
> 
> 赞同：1
> 
> 时间：2012-09-12T18:14:46.590
> 
> 标签：ios, annotations, core-plot

我已经为此工作了几天，感到很困惑。我正在尝试在核心图中制作一个图表，允许用户推送数据点并获取坐标。我制作了一个示例应用程序，它只制作了一个线性图。我的问题是我无法使用触摸功能。我在核心情节网站上引用了许多情节，但我无法让它在我的应用程序中工作。这就是我所做的；

在我的标题中，我创建了一个属性 CPTPlotSpaceAnnotation *annotation。我还使用了界面 ViewController : UIViewController 。

在我的实现中，我合成了注释。在我的 ViewDidAppear 方法中，我使用 CGPointMake 创建了一个数据数组。

```
NSMutableArray *linearstuff = [NSMutableArray array];

for (int i = 0; i < 100; i ++)
{
    float y = (b * (l)) + c;
    [linearstuff addObject:[NSValue valueWithCGPoint:CGPointMake(l, y)]];
    l = l + inc;
}

self.data = linearstuff;
[self initPlot]; 
```

我的方法 initPlot 配置图形并且有几个配置方法。因此，在我称为 configurePlots 的方法中，我分配并初始化了一个称为 linearGraph 的 CPTScatterPlot。我也在该方法中使用了 linearGraph.plotSymbolMarginForHitDetection 。然后对于 plotSymbolWasSelectedAtRecordIndex，我做了以下。

```
- (void)scatterPlot:(CPTScatterPlot *)plot plotSymbolWasSelectedAtRecordIndex:(NSUInteger)index
{
NSLog(@"touch");
CPTGraph *graph = self.hostView.hostedGraph;

if (_annotation)
{
    [graph.plotAreaFrame.plotArea removeAnnotation:_annotation];
    _annotation = nil;
}

CPTMutableTextStyle *annotationTextStyle = [CPTMutableTextStyle textStyle];
annotationTextStyle.color = [CPTColor whiteColor];
annotationTextStyle.fontSize = 16.0f;
annotationTextStyle.fontName = @"Helvetica-Bold";

NSValue *value = [self.data objectAtIndex:index];
CGPoint point = [value CGPointValue];
NSString *number1 = [NSString stringWithFormat:@"%.2f", point.x];
NSString *number2 = [NSString stringWithFormat:@"%.2f", point.y];

NSLog(@"x and y are, %.2f, %.2f", point.x, point.y);
NSLog(@"number1 and number2 are, %.2f, %.2f", point.x, point.y);

NSNumber *x = [NSNumber numberWithFloat:point.x];
NSNumber *y = [NSNumber numberWithFloat:point.y];

NSArray *anchorPoint = [NSArray arrayWithObjects: x, y, nil];

NSString *final = [number1 stringByAppendingString:number2];
NSLog(@"final is %@",final);

CPTTextLayer *textLayer = [[CPTTextLayer alloc] initWithText:final style:annotationTextStyle];
_annotation = [[CPTPlotSpaceAnnotation alloc] initWithPlotSpace:graph.defaultPlotSpace anchorPlotPoint:anchorPoint];
_annotation.contentLayer = textLayer;
_annotation.displacement = CGPointMake(0.0f, 0.0f);
[graph.plotAreaFrame.plotArea addAnnotation:_annotation];
} 
```

我试图按照我在核心情节网站上看到的内容进行操作。我拿了我的数组并得到了索引。我将这些值放在一个 NSNumber 中，为注释创建一个字符串。但是，它没有出现在图表上。有谁知道我做错了什么？任何见解将不胜感激。我在这里阅读了许多关于 SO 的核心情节问题，但找不到对我的情况有帮助的东西。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:14:24.997

对于任何关注此的人。我首先要再次感谢 Eric Skroch 的所有帮助！！！！但我终于发现我做错了什么。我已经将 viewController 设置为绘图委托，但是，我在制作绘图时并没有这么说。我添加了 linearGraph.delegate = self; 现在调用了 plotSymbol... 方法！谢谢@Eric Skroch。

# c++ - 使用 SSE 操作时的内存访问冲突

> ID：12394051
> 
> 赞同：3
> 
> 时间：2012-09-12T18:14:59.243
> 
> 标签：c++, ubuntu, vector, sse, sse3

我一直在尝试重新实现一些现有的向量和矩阵类以使用 SSE3 命令，每当我对向量数组执行一系列操作时，我似乎都会遇到这些“内存访问冲突”错误。我对 SSE 比较陌生，所以我从简单开始。这是我的矢量类的全部内容：

```
class SSEVector3D
{
public:

   SSEVector3D();
   SSEVector3D(float x, float y, float z);

   SSEVector3D& operator+=(const SSEVector3D& rhs); //< Elementwise Addition

   float x() const;
   float y() const;
   float z() const;

private:

   float m_coords[3] __attribute__ ((aligned (16))); //< The x, y and z coordinates

}; 
```

所以，还没有发生很多事情，只是一些构造函数、访问器和一个操作。使用我对 SSE 的（诚然有限的）知识，我实现了加法操作，如下所示：

```
SSEVector3D& SSEVector3D::operator+=(const SSEVector3D& rhs) 
{
   __m128 * pLhs = (__m128 *) m_coords;
   __m128 * pRhs = (__m128 *) rhs.m_coords;

   *pLhs = _mm_add_ps(*pLhs, *pRhs);

   return (*this);
} 
```

为了快速测试我的新向量类与旧向量类（看看是否值得重新实现整个事情），我创建了一个简单的程序，它生成一个随机的 SSEVector3D 对象数组并将它们添加在一起。没什么太复杂的：

```
SSEVector3D sseSum(0, 0, 0);

for(i=0; i<sseVectors.size(); i++)
{
   sseSum += sseVectors[i];
}

printf("Total: %f %f %f\n", sseSum.x(), sseSum.y(), sseSum.z()); 
```

该`sseVectors`变量是一个包含 类型元素的 std::vector `SSEVector3D`，其组件全部初始化为 和 之间的随机`-1`数`1`。

这是我遇到的问题。如果大小`sseVectors`为`8,191`或小于（我通过大量试验和错误得出的数字），则运行良好。如果大小是`8,192`或更大，当我尝试运行它时会出现此错误：

> 信号：SIGSEGV，si_code：0（地址内存访问冲突：0x00000080）

但是，如果我在最后注释掉该打印语句，即使`sseVectors`大小为 8,192 或更大，我也不会收到错误消息。

我写这个向量类的方式有问题吗？我正在使用 GCC 4.6 版运行 Ubuntu 12.04.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T11:45:44.717

首先，最重要的是，不要这样做

```
__m128 * pLhs = (__m128 *) m_coords;
__m128 * pRhs = (__m128 *) rhs.m_coords;
*pLhs = _mm_add_ps(*pLhs, *pRhs); 
```

使用 SSE，*始终*通过适当的内在函数显式地进行加载和存储，而*不是*仅仅通过取消引用。不要在你的类中存储一个包含 3 个浮点数的数组，而是存储一个 type 的值`_m128`。这应该使编译器正确对齐类的实例，而不需要任何`align`属性。

但是请注意，这不适用于 MSVC。MSVC 似乎通常无法处理比按值参数对齐的 8 字节更强的对齐要求:-(。上次我需要将 SSE 代码移植到 Windows 时，我的解决方案是使用 Intel 的 C++ 编译器来处理 SSE 部分而不是 MSVC...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T03:25:52.133

诀窍是注意它`__m128`是 16 字节对齐的。用于[`_malloc_aligned()`](http://msdn.microsoft.com/en-us/library/8z34s9c6%28v=vs.110%29.aspx)确保您的浮点数组正确对齐，然后您可以继续将浮点数转换为`__m128`. 还要确保您分配的浮点数可以被 4 整除。

# sql - PL/SQL：将数据从 Prod 移动到 Dev Table

> ID：12394055
> 
> 赞同：1
> 
> 时间：2012-09-12T18:15:32.020
> 
> 标签：sql, oracle, oracle11g

```
Oracle 11g
Oracle SQL Developer 3.0.03 
```

我需要将具有 +100K 行的生产表中的所有数据复制到开发表中。这些表有两种不同的模式。

我开始做：

```
select * 
  from prod_schema.prod_table 
 where ronum <= 50000 order by ID asc 
```

然后做

```
select * 
  from prod_schema.prod_table 
 where ronum >= 50001 
   and rownum <=107161 order by ID asc 
```

但是第二个查询没有提取任何数据。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:18:43.570

Oracle 中的 ROWNUM 永远不应被比较为大于 (>)。

当您查询时，Oracle 在返回时对行进行编号，因此您甚至不能说

```
where rownum > 1 
```

因为当行被丢弃时，它们会被忽略。也就是说，在上述情况下，永远不会有 ROWNUM=1 并且您根本没有得到任何数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T18:24:11.540

`ROWNUM`在 oracle 中 使用大于 with 时，您可以使用以下查询：

```
SELECT *
    FROM
     (SELECT a.*, rownum rn FROM
         (SELECT * FROM prod_schema.prod_table ORDER BY ID ASC) a WHERE rownum <= 107161)
    WHERE rn >= 50001; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:20:19.320

请参阅[这篇文章](http://www.oracle.com/technetwork/issue-archive/2006/06-sep/o56asktom-086197.html)：`rownum`只有在一行进入结果集时才被分配。所以`where rownum > 1`永远不会返回任何行。

在单个选择中执行此操作（`insert into / select * from`可能带有`/*+ append */`提示，或使用 CTAS）。或使用`expdp`/ `impdp`：您可以使用该`REMAP_SCHEMA`选项来更改架构名称（并可能根据您的 Oracle 版本限制所选集）。

# ipad - 切换视图时的 iOS-5 错误

> ID：12394057
> 
> 赞同：0
> 
> 时间：2012-09-12T18:15:39.453
> 
> 标签：ipad, uiviewcontroller, ios5

我正在尝试在按钮按下事件上切换视图，但是当我按下按钮将视图从第一个视图切换到第二个时。它显示 secondView 大约一秒钟，然后出现一个空白页。我是 iOS 编程新手，所以不知道可能是什么问题。

这是我的代码：

```
- (IBAction)okPressed:(id)sender {

AppDelegate *mainDelegate = (AppDelegate *)[[UIApplication sharedApplication]delegate];
shipView = [mainDelegate.storyboard instantiateViewControllerWithIdentifier:@"SecondViewController"];
[self.navigationController pushViewController:shipView animated:YES]; 
```

UIStoryBoard 在 AppDelegate 类中实例化。当调用 okPressed 方法时，不会加载 SecondViewController。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T02:45:24.857

标准的 alloc / init 不会做任何事情。您需要使用`initWithNibName:bundle:`XIB 的文件名，或者使用您在情节提要文件中定义的控制器的标识符`UIStoryboard`。`instantiateViewControllerWithIdentifier:`

# .net - 为什么 TOP 不能和 SQLDependency 一起使用？

> ID：12394064
> 
> 赞同：0
> 
> 时间：2012-09-12T18:16:05.787
> 
> 标签：.net, sql-server, service-broker, sqldependency

我有一个使用 SQLDependency 的应用程序。我想在插入新行时向用户显示插入数据库表的最新行。

当我的查询是一个简单的选择语句时，这可以按预期工作，但是鉴于我想显示最近插入的行，我将查询编写为`SELECT TOP`语句。这导致了多个异常。在查看[这个](https://stackoverflow.com/a/7588660/1324019)问题后，我了解到这`TOP`对 SQLDependency 无效，因此我将不得不找到其他解决方案。

这让我想知道两件事：

A) SQLDependency 不支持`TOP`表达式的原因是什么？

B）我想出的解决方案是根据 id 对结果进行排序并只显示最后一个。这工作正常，但我的表目前只有很少的行。我正在使用数据集，所以我预计一旦插入更多行，它就会减慢 - 这就是为什么我想将查询限制为仅最近的行。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:54:03.887

[本文](http://rusanu.com/2006/06/17/the-mysterious-notification/)解释了查询通知技术如何利用索引视图技术，因此它具有相同的限制。为了创建高效的索引视图，必须能够仅从当前更新中更新索引，而无需查看表中的任何其他行。如果 TOP 被允许，那么百万美元的问题是：如果您删除 TOP 中的一行，*哪一行应该代替它*？回答这个问题需要在表中搜索现在应该包含在 TOP 索引视图中的另一行，而不是已删除的行。因此，包含 TOP 的索引视图（或者，就此而言，存在同样问题的 MAX 或 MIN）不能有效地维护并且不允许。

您*可以*通过查询来检测插入了一行[`COUNT_BIG(*)`](http://msdn.microsoft.com/en-us/library/ms190317.aspx)。一旦通知您计数已更改，查询新插入的行就很简单了。您还将收到有关 DELETES 的通知（即误报）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-04T22:32:47.210

@Remus Rusanu 解释得很好。您**不能**使用`TOP`SQL 命令的关键字。但是，如果你想选择一些`TOP`数据，你可以使用下面的替代解决方案。

我正在从数据库中选择所有记录，但我只在我的列表中放入了十条记录，并且我将此列表返回到我的仪表板。所以，每次我收到最新的十条记录。

`TOP`您可以在没有关键字的情况下使用当前的 SQL 命令。我的是：

**SQL 命令：**

```
Select [Id], [Name] FROM dbo.CUSTOMER where InsertDate = @InsertDate ORDER BY [ID] DESC; 
```

然后，在您的应用程序中，您可以根据您的最高计数填写您的列表。
检查我对以下源代码的评论。

```
public List<CustomerModel> GetAllCustomer()
        {
            List<CustomerModel> lstCustomerModel = new List<CustomerModel>();
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                conn.Open();
                string InsertDate = string.Empty;
                InsertDate = DateTime.Now.ToString("yyyyMMdd");

                string query = "SELECT [Id] " +
                                    ",[Name] " +
                                "FROM [dbo].[Customer] where InsertDate = " + InsertDate + "   ORDER BY [Id] DESC;";
                SqlCommand cmd = new SqlCommand(query, conn);
                cmd.CommandType = CommandType.Text;
                cmd.Notification = null;
                SqlDependency.Stop(connectionString);
                SqlDependency.Start(connectionString);
                SqlDependency sqlDependency = new SqlDependency(cmd);
                sqlDependency.OnChange += OnDependencyChange;

                using (SqlDataReader reader = cmd.ExecuteReader())
                {
                    if (reader.HasRows)
                    {
                        int counter = 0;
                        while (reader.Read())
                        {
                            if (counter == 10) /* Here, I am reading just first ten record. After 10 records, I am not filling my List. So, It is kind of top 10 records.. Alternative solution.*/
                                break;
                            counter++;

                            lstCustomerModel.Add(new CustomerModel
                            {
                               Id = Convert.ToInt32(reader.GetValue("Id")),
                               Name = WeightUnit = reader.GetValue("Name")
                            });

                            //break;
                        }
                    }
                }
            }

            return lstCustomerModel;
        }

        private void OnDependencyChange(object sender, SqlNotificationEventArgs e)
        {
            if (e.Type == SqlNotificationType.Change)
            {
                _context.Clients.All.SendAsync("refreshCustomers");
            }
        } 
```

# java - 如何将诸如“ç”之类的字符识别为字母？

> ID：12394065
> 
> 赞同：2
> 
> 时间：2012-09-12T18:16:16.693
> 
> 标签：java, cp1252

我有一个包含一个句子的字节数组。我需要将这句话上的小写字母转换成大写字母。这是我所做的功能：

```
 public void CharUpperBuffAJava(byte[] word) {
     for (int i = 0; i < word.length; i++) {
        if (!Character.isUpperCase(word[i]) && Character.isLetter(word[i])) {
            word[i] -= 32;
        }
     }
    return cchLength;
 } 
```

它可以很好地处理诸如“一杯水”之类的句子。问题是它必须适用于所有 ANSI 字符，包括 "ç,á,é,í,ó,ú" 等等。Character.isLetter 方法不适用于这些字母，因此它们不会转换为大写字母。

您知道如何将这些 ANSI 字符识别为 Java 中的字母吗？

**编辑**

如果有人想知道，我在回答后再次做了方法，现在看起来像这样：

```
public static int CharUpperBuffAJava(byte[] lpsz, int cchLength) {
    String value;
    try {
        value = new String(lpsz, 0, cchLength, "Windows-1252");
        String upperCase = value.toUpperCase();
        byte[] bytes = upperCase.getBytes();
        for (int i = 0; i < cchLength; i++) {
            lpsz[i] = bytes[i];
        }
        return cchLength;
    } catch (UnsupportedEncodingException e) {
        return 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:19:09.863

你不能简单地使用：

```
String s = new String(bytes, "cp1252");
String upper = s.toUpperCase(someLocale); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:19:44.687

将字节数组转换为字符串，支持编码。然后调用`toUpperCase()`。然后，如果您需要在大写后将其作为字节数组，您可以在字符串上调用[getBytes() 。](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#getBytes%28java.nio.charset.Charset%29)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T18:23:06.980

您需要将其“解码”`byte[]`为字符串。有几个 API 可以做到这一点，但您*必须*指定用于字节的字符编码。不使用编码的重载版本会在不同的机器上给出不同的结果，因为它们使用平台默认值。

例如，如果您确定字节是使用 Windows-1252（有时称为 ANSI）编码的。

```
String s = new String(bytes, "Windows-1252"); 
String upper = s.toUpperCase(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T18:21:27.957

在转换之前不会改变字符集吗？Java 的内部转换逻辑可能工作正常。类似于[http://www.exampledepot.com/egs/java.nio.charset/ConvertChar.html](http://www.exampledepot.com/egs/java.nio.charset/ConvertChar.html)，但使用 ASCII 作为目标字符集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T18:21:28.557

我在看这张表：

[http://slayeroffice.com/tools/ascii/](http://slayeroffice.com/tools/ascii/)

但是任何大于 227 的东西似乎都是一个字母，但要使其大写，您将从 ASCII 值中减去 27。

# android - 在应用内搜索特定 mime 类型开场白的市场

> ID：12394069
> 
> 赞同：0
> 
> 时间：2012-09-12T18:16:27.093
> 
> 标签：android, google-play, mime-types

我有一个允许用户打开文件的应用程序。如果手机上没有可以打开文件的应用程序，则会显示错误消息。有没有办法在 Play Store 或 Amazon App Store 的应用程序内搜索将打开特定 mime 类型文件的应用程序？这样，如果在设备上找不到可以打开文件的应用程序，则可以建议来自商店的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:38:03.373

Google 不会公开该搜索功能。如果你想通过应用或包名进行应用内搜索，你可以使用[非官方的 api](http://code.google.com/p/android-market-api/)。

# mysql - 按关联的 counter_cache 查找和排序

> ID：12394073
> 
> 赞同：0
> 
> 时间：2012-09-12T18:16:47.000
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-2

我有许多相关的模型：

```
Company has_many :clients (which belongs_to :company)  
Client has_many :groups (which belongs_to :client)
Group has_many :orders (which belongs_to :group, :counter_cache => true) 
```

现在，我需要找到所有公司并按订单从高到低对它们进行排序。由于我有 groups_orders_count 列，我很确定我可以按 groups.orders_count 排序。然后我需要遍历这些公司，显示旁边的总订单。

我一直在努力寻找这个发现。我有一个 MySQL 数据库，如果它归结为 find_by_sql 或其他东西。

```
companies = Company.find(
  :all,
  :include => { :clients => :groups },
  :select => "companies.*, groups.orders_count",
  :group => "companies.id",
  :order => "groups.orders_count"
) 
```

任何帮助或推动正确的方向表示赞赏！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:19:22.933

使用`groups.orders_count`可能是个问题。如果一家公司有两个客户并且每个客户都有一个组，那么您要对哪个 group.orders_count 进行排序？如果我错了，请纠正我。

这没有利用 counter_cache 但它应该可以工作（我的 Rails 2.x 有点生锈）：

```
companies = Company.all(
  :select => "companies.*",
  :include => { :clients =>  [ :groups => :orders ] },
  :group => "companies.id",
  :order => "count(orders.*) DESC") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T00:38:31.673

好吧，这花了我**太**长时间才弄清楚。我需要尽快拿起一本关于 SQL 的书。无论如何，这就是我想要的：

```
sql = "groups.created_at BETWEEN :start_date AND :end_date"
options = { :start_date => 1.month.ago, :end_date => Date.today }

@companies = Company.all(
  :select => 'companies.*, count(orders.id) as counter',
  :joins => { :clients => { :groups => :orders } },
  :group => 'companies.id',
  :order => 'counter DESC',
  :conditions => [sql, options]
) 
```

:joins 使 counter 作为公司的 column_name 工作；为什么 :includes 没有，我不知道，如果有人有一个很好的答案，我很想知道为什么。所以我可以写：

```
@companies.first.counter 
```

并取回该公司的订单总数。

**编辑**

发现我*几乎*得到了我想要的结果，除了在某个日期范围内没有组/订单的客户。每个结果至少有 1 个用于计数器。

意识到rails join使用INNER JOIN；LEFT JOIN 将返回没有相应子对象的对象。所以我改成这样：

```
@companies = Company.all(
  :select => 'companies.*, count(orders.id) as counter',
  :joins => "LEFT JOIN clients ON clients.company_id = companies.id
    LEFT JOIN groups ON groups.client_id = clients.id LEFT JOIN orders ON orders.group_id = groups.id",
  :group => 'companies.id',
  :order => order_by,
  :conditions => [sql, options]
) 
```

我现在还记得 :includes 急切加载（不一定要加入），这可能是我不能使用它的原因。这在 Rails 3 中可能有所不同。请参见此处：[Rails :include 与 :joins](https://stackoverflow.com/questions/1208636/rails-include-vs-joins)

# vb.net - VB 2008（控制台）“For Each Loop”彩票结果比较

> ID：12394074
> 
> 赞同：1
> 
> 时间：2012-09-12T18:16:53.580
> 
> 标签：vb.net

我面临一个问题，即在用户输入的整数和代码生成的随机数之间进行数字比较。

然后应将用户输入的每个整数与 LOTTO 号码进行比较，以检查是否匹配。需要使用 For each... 循环来实现此目的。

在根据 LOTTO 号码检查所有 7 个用户输入的整数后，应将匹配的总数输出给用户。如果没有匹配，则输出应为“LOOSER！”。

这是我的代码，我目前只停留在比较部分，我们需要使用每个循环来实现这一点。

进口系统

乐透模块

```
Sub Main()

    'Declaration
    Dim numbers(6) As Integer
    Dim IsStarted As Boolean = True

    'Prompt user to enter 
    Console.WriteLine("Please enter your 7 lucky numbers from 0 - 9 ONLY")

    'Use Do While Loop to re-iterate the prompts
    Do While IsStarted
        For pos As Integer = 0 To 6
            Console.Write("Enter number {0}: ", pos + 1)
            'How it stores into an array
            numbers(pos) = Console.ReadLine()

            'Check if it is a number: use IsNumberic()
            If IsNumeric(numbers(pos)) Then 'proceed
                'Check if it is NOT 0 < x > 9
                If numbers(pos) < 0 Or numbers(pos) > 9 Then
                    'Don't proceed
                    Console.WriteLine("Invalid Input")
                    IsStarted = True
                    'When any number is invalid, exit the loop
                    Exit For
                End If
            End If
            IsStarted = False
        Next
    Loop

    'Printing out the array. It can also be written as 
    'For pos = LBound(numbers) To UBound(numbers)
    For pos = 0 To 6
        Console.Write(numbers(pos) & " ")
    Next

    Console.WriteLine()
    'Random number generator
    Randomize()
    Dim random_numbers(6) As Integer
    Dim upperbound As Integer = 7
    Dim lowerbound As Integer = 0
    Dim rnd_number As Double = 0

    For pos = 0 To 6
        rnd_number = CInt((upperbound - lowerbound) * Rnd() + lowerbound)
        random_numbers(pos) = rnd_number

        Console.Write(random_numbers(pos) & " ")
    Next

    'Iterate and compare
    Dim isSame As Boolean = False
    Dim pos2 As Integer = 0
    Dim Counter As Integer = 0

    'For check = 0 To 6
    'If numbers(pos2).Equals(random_numbers(pos2)) Then
    For Each number As Integer In numbers
        'Console.WriteLine(pos2 + 1 & ":" & number & ":")
        If number.Equals(random_numbers(pos2)) Then
            'Console.WriteLine("here is the number that matched:" & number & ":")
            isSame = True
            pos2 = pos2 + 1
        End If

        For Each num As Integer In random_numbers
            If random_numbers Is numbers Then
                Counter = Counter + 1
            End If

        Next
    Next

    Console.WriteLine()

    'Display result
    If isSame = True Then
        Console.WriteLine("The total numbers of matches are: " & Counter)
    Else
        Console.WriteLine("LOOSER!")
    End If
    Console.ReadLine()

End Sub 
```

端模块

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:49:04.123

```
 Dim intCursor As Integer = 0

            For Each intNumber As Integer In numbers

                'Assumes first user chosen number must equal 
                'the first random number to be considered a match,
                'the second user number must equal the second random,
                'etc (Ordering is a factor).
                If random_numbers(intCursor) = intNumber Then

                    Counter += 1

                End If

                intCursor += 1

            Next

            If (Counter > 0) Then

                Console.WriteLine("The total numbers of matches are: " & Counter)

            Else

                Console.WriteLine("LOOSER!")

            End If 
```

# ios - 如何在服务器上解析 Dropbox RSS 提要

> ID：12394079
> 
> 赞同：0
> 
> 时间：2012-09-12T18:17:22.773
> 
> 标签：ios, parsing, dropbox

我正在开发一个使用 Dropbox SDK 的 ios 应用程序。我想在编辑 Dropbox 中的任何文件时通知用户。我不知道 Dropbox 是否提供任何 API，但我认为 Apple 的推送通知会很好。根据我的研究，Dropbox SDK 中有类似 /delta 的东西，但是互联网上没有足够的资源或示例代码来理解 /delta。

我想要的是：

**Dropbox 文件更改----> 我的服务器检测到更改并发送到苹果-----> 苹果推送通知服务发送通知--------> IOS 设备接收通知**

所以目前我完成了我的应用程序的推送通知部分，我可以通过本地 apache 服务器和 php 脚本向我的应用程序发送一个简单的通知。设备收到通知。

我的问题是如何实现

这部分**Dropbox 文件更改----> 我的服务器检测到更改内容并发送给苹果----->**

我不知道如何解析我的保管箱文件夹的 RSS 提要。我应该使用什么语言来解析 Dropbox 上的数据？我是否应该不断轮询并检查是否有任何文件被编辑？或者有没有办法让 dropbox 直接向我的服务器或苹果通知服务器发送通知，这样我就不需要一直轮询更改？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T15:22:39.740

您想要的是创建一个 php 脚本来解析您的 rss 提要并将推送通知发送到您的应用程序。并使用允许 cron 命令的服务器，以便您可以连续运行此脚本并检查更新。

```
<?php

//set the time zone
date_default_timezone_set('America/New_York');

//get xml file from dropbox event page
$completeurl ='your xml url';

//equal badge to zero 
$badge=0;

//format date and time
$format = 'D, d M Y H:i:s O';

// Put your alert message here:
$message;

//parse the xml file
$item = $xml->channel->item;
for ($i = 0; $i < sizeof($item); $i++) {

    $title = $item[$i]->title;
    $description=$item[$i]->description;
    $pubDate = $item[$i]->pubDate;

    //search title for word 'edited'
    if (strpos($title,'edited') !== false) {
        echo "Edited word is found in title true \n";

        $inDate  = DateTime::createFromFormat( $format, $pubDate);//input date and time
        $postDate = new DateTime();// current date and time

        $diff = $inDate->diff( $postDate); // difference current-input

        // If the total number of days is > 0, or the number of hours > 0, or the number of minutes > 30, then its an invalid timestamp.
        if( $diff->format( '%a') > 0 || $diff->format( '%H') > 0 || $diff->format( '%i') > 30) {
            echo "update is not recent\n";
    }else{
        //if true increase badge by one

        $badge = $badge + 1;
    }
}

}
//print total updates
echo "Total Badge= " . $badge. "\n";

//if total updates is bigger or equal to one send notification
if($badge>=1){
// Put your device token here (without spaces):
$deviceToken = 'yourdevicetoken';

// Put your private key's passphrase here:
$passphrase = 'yourpassphrase in your.cem file';

////////////////////////////////////////////////////////////////////////////////

$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'local_cert', 'ck.pem');
stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

// Open a connection to the APNS server
$fp = stream_socket_client(
    'ssl://gateway.sandbox.push.apple.com:2195', $err,
    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

if (!$fp)
    exit("Failed to connect: $err $errstr" . PHP_EOL);

echo 'Connected to APNS' . PHP_EOL;

// Create the payload body
$body['aps'] = array(
    'alert' => $message,
    'sound' => 'default',
    'badge' => $badge
    );

// Encode the payload as JSON
$payload = json_encode($body);

// Build the binary notification
$msg = chr(0) . pack('n', 32) . pack('H*', $deviceToken) . pack('n', strlen($payload)) . $payload;

// Send it to the server
$result = fwrite($fp, $msg, strlen($msg));

if (!$result)
    echo 'Message not delivered' . PHP_EOL;
else
    echo 'Message successfully delivered' . PHP_EOL;

// Close the connection to the server
fclose($fp);
}else
    echo "There is no update available \n";

?> 
```

# java - 现在我正在使用 Maven，出现 Spring 项目错误

> ID：12394084
> 
> 赞同：1
> 
> 时间：2012-09-12T18:17:33.593
> 
> 标签：java, eclipse, spring, maven, spring-security

我开始使用 Maven 将我的 JAR 引入我的项目中。我有一个 Spring 项目，我在 Eclipse 中移入了一个 maven 项目，但现在出现此错误：

```
Description Resource    Path    Location    Type
The classes from the spring-security-web jar (or one of its dependencies) are not available. You need these to use <http>: javax.servlet.Filter my-security-context.xml /WebFlowTemplate/src/main/webapp/WEB-INF/spring line 12 Spring Beans Problem 
```

这是我得到它的一条线：

```
<http use-expressions="true"> 
```

这是我的 my-security-context.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans 
    xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                        http://www.springframework.org/schema/security
                        http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <http use-expressions="true">

        <intercept-url access="hasRole('ROLE_USER')"    pattern="/helloworld**" />
        <intercept-url pattern='/*' access='permitAll' />

        <form-login login-page="/login.jsp"
            authentication-failure-url="/login.jsp" 
            default-target-url="/helloworld" />

        <logout logout-success-url="/" />
    </http>

    <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="user" password="user" authorities="ROLE_USER" />
            </user-service>

        </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

这是我的 pom.xml 文件。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.springsource.greenbeans.maven</groupId>
    <artifactId>WebFlowTemplate</artifactId>
    <packaging>war</packaging>
    <version>0.0.1-SNAPSHOT</version>
    <name>WebFlowTemplate Maven Webapp</name>
    <url>http://maven.apache.org</url>
    <dependencies>

        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.6.3.Final</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.3.0.Final</version>
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>1.6.2</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-webflow</artifactId>
            <version>2.3.1.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>
        </dependency>

    </dependencies>
    <build>
        <finalName>WebFlowTemplate</finalName>
    </build>
</project> 
```

看起来一切正常，但我不想看到这个错误。有人可以在这方面提供一些信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-21T08:31:12.420

我也尝试了很多解决方案来解决这个问题。但是当我查看项目的 maven 依赖项时，我找到了解决方案（我不是指 pom.xml -> 我指的是 STS 包资源管理器中的 dropDown-view）。

servlet-api 没有条目。

在我的 pom.xml 中放入以下依赖项解决问题：

```
 <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
    </dependency> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-22T10:23:15.317

在您的项目中添加库“服务器运行时”，他可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:23:28.727

我发现这个有点奇怪的解决你的问题：

[http://forum.springsource.org/showthread.php?110052-Configuration-problem-spring-security-web-classes-are-not-available-You-need](http://forum.springsource.org/showthread.php?110052-Configuration-problem-spring-security-web-classes-are-not-available-You-need)

> 最初我以为我在使用 spring security 3.1 时遇到了问题，但实际上是因为我使用 maven 导入了太多依赖项。
> 
> 只导入几个必需的 spring jar，清理和重建项目解决了这个问题，我的应用程序上下文 xml 文件中不再出现错误

还要检查这个[博客](http://krams915.blogspot.ch/2010/12/spring-security-3-mvc-using-simple-user.html)的评论。

> 您正在关注 Spring Security 3.1 教程，对吗？我建议做一个 mvn clean 来清理你项目的工作区。然后再次尝试构建项目

# jquery - 根据表格网格宽度自动调整jqgrid列宽

> ID：12394085
> 
> 赞同：3
> 
> 时间：2012-09-12T18:17:35.860
> 
> 标签：jquery, jqgrid

我有一个有 2 列的网格。以下是列模型：

```
colModel.append("{name:\"group_id\",index:\"GOID\",width:80,sortable:true,align:\"left\", formatter:linkFormat, unformat:unformatLink}\n")
        .append(",{name:\"group_name\",index:\"GNAME\",width:350,sortable:true,align:\"left\", formatter:formatHtml, unformat:unformatHtml}"); 
```

表格网格宽度为 95%，并根据窗口大小而变化。

现在我需要自动调整两个列的宽度来填充整个网格。我不想在网格末尾显示空白区域。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T11:50:39.707

由于评论中提到的内容有效，因此我将添加此答案以确保完整性。根据 jqGrid 的[wiki](http://www.trirand.com/jqgridwiki/doku.php)自动调整列，您可以使用该[选项](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions) `shrinktofit:true`。

根据 wiki`ShrinkToFit`执行以下操作：

> 如果设置此选项，则定义如何重新计算网格列的宽度，同时考虑网格的宽度。如果此值为真，并且列的宽度也已设置，则每列都按其宽度成比例缩放。例如，如果我们定义了宽度为 80 和 120 像素的两列，但希望网格的宽度为 300 像素，那么列将拉伸以适应整个网格，分配给它们的额外宽度将取决于宽度列本身和可用的额外宽度。重新计算如下：第一列得到宽度（300（新宽度）/200（所有宽度之和））*80（第一列宽度）= 120像素，第二列得到宽度（300 （新宽度）/200（所有宽度之和））*120（第二列宽度）= 180 像素。现在列的宽度总计为 300 像素，即网格的宽度。如果该值为 false 并且设置了 width 选项中的值，则不会发生任何调整大小。因此在本例中，如果将 shrinkToFit 设置为 false，则第一列的宽度为 80 像素，第二列的宽度为 120 像素，网格将保留 300 像素的宽度。如果shrinkToFit的值为整数，则根据它计算宽度。- 可以详细说明使用整数的效果。第二列的宽度为 120 像素，网格将保持 300 像素的宽度。如果shrinkToFit的值为整数，则根据它计算宽度。- 可以详细说明使用整数的效果。第二列的宽度为 120 像素，网格将保持 300 像素的宽度。如果shrinkToFit的值为整数，则根据它计算宽度。- 可以详细说明使用整数的效果。

# python - 从字符串列表中找到最佳子集以匹配给定的字符串

> ID：12394087
> 
> 赞同：4
> 
> 时间：2012-09-12T18:17:43.583
> 
> 标签：python, string, algorithm, matching, fuzzy-search

我有一个字符串

```
s = "mouse" 
```

和一个字符串列表

```
sub_strings = ["m", "o", "se", "e"] 
```

我需要找出与 s 匹配的列表中 sub_strings 的最佳和最短匹配子集是什么。做这个的最好方式是什么？理想的结果是 ["m", "o", "se"] 因为它们一起拼写为 mose

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:22:21.167

```
import difflib
print difflib.get_close_matches(target_word,list_of_possibles) 
```

但不幸的是，它不适用于您上面的示例，您可以改用 Levenstein 距离...

```
def levenshtein_distance(first, second):
    """Find the Levenshtein distance between two strings."""
    if len(first) > len(second):
        first, second = second, first
    if len(second) == 0:
        return len(first)
    first_length = len(first) + 1
    second_length = len(second) + 1
    distance_matrix = [[0] * second_length for x in range(first_length)]
    for i in range(first_length):
       distance_matrix[i][0] = i
    for j in range(second_length):
       distance_matrix[0][j]=j
    for i in xrange(1, first_length):
        for j in range(1, second_length):
            deletion = distance_matrix[i-1][j] + 1
            insertion = distance_matrix[i][j-1] + 1
            substitution = distance_matrix[i-1][j-1]
            if first[i-1] != second[j-1]:
                substitution += 1
            distance_matrix[i][j] = min(insertion, deletion, substitution)
    return distance_matrix[first_length-1][second_length-1]

sub_strings = ["mo", "m,", "o", "se", "e"]
s="mouse"
print sorted(sub_strings,key = lambda x:levenshtein_distance(x,s))[0] 
```

这将始终为您提供与目标“最接近”的词（对于最接近的一些定义）

levenshtein 功能从：http://www.korokithakis.net/posts/finding-the-levenshtein-distance-in-python/ 窃取

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:36:00.343

您可以使用正则表达式：

```
import re

def matches(s, sub_strings):
    sub_strings = sorted(sub_strings, key=len, reverse=True)
    pattern = '|'.join(re.escape(substr) for substr in sub_strings)
    return re.findall(pattern, s) 
```

这至少短而快，但不一定会找到最佳匹配集；太贪心了。例如，

```
matches("bears", ["bea", "be", "ars"]) 
```

返回`["bea"]`，什么时候应该返回`["be", "ars"]`。

* * *

代码说明：

*   第一行按长度对子字符串进行排序，以便最长的字符串出现在列表的开头。这确保了正则表达式将更喜欢较长的匹配而不是较短的匹配。

*   第二行创建一个由所有子字符串组成的正则表达式模式，由`|`符号分隔，表示“或”。

*   第三行仅使用该`re.findall`函数查找给定字符串中模式的所有匹配项`s`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T10:59:49.033

此解决方案基于用户[Running Wild的](https://stackoverflow.com/users/1296466/running-wild)[此答案](https://stackoverflow.com/a/12379137/68063)。它使用Stefan Behnel[的](http://pypi.python.org/pypi/acora/)[包使用](http://pypi.python.org/pypi/acora/)[Aho-Corasick 算法](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)有效地找到目标中子串的所有匹配项，然后使用[动态规划](http://en.wikipedia.org/wiki/Dynamic_programming)来找到答案。[`acora`](http://pypi.python.org/pypi/acora/)

```
import acora
import collections

def best_match(target, substrings):
    """
    Find the best way to cover the string `target` by non-overlapping
    matches with strings taken from `substrings`. Return the best
    match as a list of substrings in order. (The best match is one
    that covers the largest number of characters in `target`, and
    among all such matches, the one using the fewest substrings.)

    >>> best_match('mouse', ['mo', 'ou', 'us', 'se'])
    ['mo', 'us']
    >>> best_match('aaaaaaa', ['aa', 'aaa'])
    ['aaa', 'aa', 'aa']
    >>> best_match('abracadabra', ['bra', 'cad', 'dab'])
    ['bra', 'cad', 'bra']
    """
    # Find all occurrences of the substrings in target and store them
    # in a dictionary by their position.
    ac = acora.AcoraBuilder(*substrings).build()
    matches = collections.defaultdict(set)
    for match, pos in ac.finditer(target):
        matches[pos].add(match)

    n = len(target)
    # Array giving the best (score, list of matches) found so far, for
    # each initial substring of the target.
    best = [(0, []) for _ in xrange(n + 1)]
    for i in xrange(n):
        bi = best[i]
        bj = best[i + 1]
        if bi[0] > bj[0] or bi[0] == bj[0] and len(bi[1]) < bj[1]:
            best[i + 1] = bi
        for m in matches[i]:
            j = i + len(m)
            bj = best[j]
            score = bi[0] + len(m)
            if score > bj[0] or score == bj[0] and len(bi[1]) < len(bj[1]):
                best[j] = (score, bi[1] + [m])
    return best[n][1] 
```

# android - Eclipse Android Common XML 编辑器无法在模式之间切换

> ID：12394089
> 
> 赞同：5
> 
> 时间：2012-09-12T18:17:48.267
> 
> 标签：android, xml, eclipse

不知何故，我从 Android Common XML Editor 的标准 WYSIWYG 模式切换到了文本模式。我听说屏幕底部应该有一个选项卡来切换（布局/file.xml），但我猜在 Eclipse Juno 中没有。我的问题：如何在 Eclipse Juno 中的 WYSIWYG 和文本模式之间进行切换？

![Eclipse URL 的屏幕截图](../Images/229528fea0453ec9d779cebee9cb60e6.png)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-13T18:16:07.070

用于`Shift``Alt``F7`导航到上一页（这是您现在需要的）并`Alt``F7`导航到多页编辑器的下一页。

# math - 微积分类的三元运算符

> ID：12394091
> 
> 赞同：2
> 
> 时间：2012-09-12T18:17:51.227
> 
> 标签：math, ternary-operator, calculus

我想知道在编程之外使用三元运算符。例如，在那些 CS 学位所需的讨厌的微积分课程中。一个人可以用这样的三元运算符描述双曲函数吗： 1/x ？1/x：无穷大；这假设 x 是一个正浮点数并且应该说如果 x != 0 则函数返回 1/x，否则返回无穷大。这会规避对限制的全部需求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:23:50.957

对于具体问题，我并不完全确定，但是是的，三元组可以回答任何以“if/else”或“if and only if, else”形式提出的问题。然而，传统上，数学不是以具有任何实际流量控制的条件格式编写的。'if' 和其他流程控制机制让代码以不同的方式执行，但对于大多数数学，流程是相同的；只是结果不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T18:27:54.113

在数学上，任何运算符都可以等效地描述为一个函数，如`a + b = add(a,b)`; 请注意，编程也是如此。在任何一种情况下，二元运算符都是描述两个参数的函数的常用方法，因为它们很容易阅读。

三元运算符更难阅读，相应地也不太常见。但是，由于数学排版不限于一维文本字符串，因此许多数学运算符具有很大的元数——例如，一个定积分可以说有 4 个参数（开始、结束、被积函数和微分）。

* * *

回答您的第二个问题：不，这并没有规避限制的需要；您可以很容易地说替代方案是`42`而不是`infinity`.

我还要提一下，您的示例与三元运算符`1/x`的编程用法并不真正匹配。`?:`请注意，这`1/x`不是布尔值；看起来您正在尝试使用`?:`来处理类似异常的条件，这将更适合 try/catch 表单。

另外，当您说“这假定 x 是正浮点数”时，读者应该如何知道这一点？您可能还记得有一种数学符号可以通过从上面指示极限来解决这个特定问题......

# cakephp - 使用 CakePHP 插件迁移不同的数据库

> ID：12394093
> 
> 赞同：2
> 
> 时间：2012-09-12T18:17:56.550
> 
> 标签：cakephp, migration

我正在使用来自 CakePHP 的插件迁移，我的应用程序中有两个数据库，

db1 (默认) tableX1 tableX2 tableX3 ... tableXn

db2 表 Y1 表 Y2 表 Y3 ... 表 Yn

我想运行迁移，其中一部分必须在 db1 中执行，另一部分在 db2 中执行，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T08:39:52.857

我会在你的`app/Config/database.php`

# google-apps-script - 运行 Google 提供的 Google Apps 脚本代码时引发错误

> ID：12394099
> 
> 赞同：0
> 
> 时间：2012-09-12T18:18:21.517
> 
> 标签：google-apps-script

在 Google Apps Script 中使用以下代码时，该函数可以正常运行，但会引发错误：

无效的电子邮件：未定义（第 6 行）

这是代码：

```
function emailStockPrice(symbol, email) {
  Logger.log('Emailing stock price of ' + symbol + ' to ' + email);
  var info = FinanceApp.getStockInfo(symbol);
  Logger.log(info);
  var price = info['price'];
  MailApp.sendEmail(email,
                    'Price for: ' + symbol,
                    price);
}

emailStockPrice("PRXL","james.shook@gmail.com"); 
```

如果测试，请在功能中使用您自己的电子邮件:)。知道为什么它说“电子邮件”未定义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:49:58.273

您如何运行该功能？您是否通过选择 emailStockPrice 并单击运行从脚本编辑器运行它？如果是这样，那么 email 和 symbol 都将是未定义的，因为函数期望这些值被传入。

相反，这个函数是从其他函数中调用的。尝试这样的事情：

```
function emailStockPrice(symbol, email) {
  Logger.log('Emailing stock price of ' + symbol + ' to ' + email);
  var info = FinanceApp.getStockInfo(symbol);
  Logger.log(info);
  var price = info['price'];
  MailApp.sendEmail(email,
                    'Price for: ' + symbol,
                    price);
}

function test() {
  emailStockPrice("PRXL","james.shook@gmail.com");
} 
```

然后运行测试功能。

# javafx-2 - ClassName.class.getResourceAsStream() 在 Java 7 U 7 中不使用相对路径加载

> ID：12394100
> 
> 赞同：3
> 
> 时间：2012-09-12T18:18:22.167
> 
> 标签：javafx-2, java-7

问题陈述： ClassName.class.getResourceAsStream() 如果路径是相对的，则不会加载/查找资源。如果路径是绝对的，它工作正常。

我最近从带有 JavaFx 2.1 的 Java 6 升级到带有 JavaFX 2.2 的 Java SE 7 u 7。它在早期版本的 JAvaFX 2.0 / Java FX 2.1 中运行良好。使用的 IDE 是 NetBean IDE 7.2。

我面临一个我觉得很奇怪的问题。我使用 IDE 创建了一个 JAVA FX 项目并尝试加载属性文件。指定绝对路径时它工作正常。但是当我更改为相对路径时，它会异常失败。

**ClassName.class.getResourceAsStream("../resources/newproperties.properties");** // 不起作用。

**ClassName.class.getResourceAsStream("/resources/newproperties.properties");** // 使用绝对路径。

然后，我使用 JAva 7u7 在 Netbeans 7.2 IDE 中创建了另一个 Simple Java 项目，并尝试使用 ClassName.class.getResourceAsStream("../newproperties.properties"); 加载属性文件。它适用于相对路径和绝对路径。基本上，如果是 JAVAFX 2.2 项目，它不会加载。如果它是一个简单的 java 项目，那么相同的代码可以工作，我觉得这很奇怪。

注意：上面的代码在 Java 6 和 Javafx 2.1 上运行良好。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:58:09.047

如果您的应用程序被打包为一个 jar（就像 JavaFX 应用程序通常那样），那么在获取资源操作的底层实现中使用的 jar 协议将不会解析`..`相对路径中的父说明符。

如果您的应用程序未打包并且只是文件系统中的类和其他文件的集合，那么说明`..`符将解析，因为资源查找将使用文件协议而不是 jar 协议。

演示以上几点的示例：

```
package classpathtest;

public class ClassPathTest {
  public static void main(String[] args) {
    System.out.println(ClassPathTest.class.getResourceAsStream("../roundbutton.css"));
  }
} 
```

样品的使用。

```
C:\dev\javafx\ClassPathTest\build\classes>echo any text > roundbutton.css

C:\dev\javafx\ClassPathTest\build\classes>echo Main-Class: classpathtest.ClassPathTest > manifest.txt

C:\dev\javafx\ClassPathTest\build\classes>jar cvfm ClassPathTest.jar manifest.txt roundbutton.css classpathtest
added manifest
adding: roundbutton.css(in = 521) (out= 257)(deflated 50%)
adding: classpathtest/(in = 0) (out= 0)(stored 0%)
adding: classpathtest/ClassPathTest.class(in = 680) (out= 399)(deflated 41%)

C:\dev\javafx\ClassPathTest\build\classes>java -jar ClassPathTest.jar
null

C:\dev\javafx\ClassPathTest\build\classes>java classpathtest.ClassPathTest
java.io.BufferedInputStream@927e4be

C:\dev\javafx\ClassPathTest\build\classes>java -version
java version "1.8.0-ea"
Java(TM) SE Runtime Environment (build 1.8.0-ea-b54)
Java HotSpot(TM) 64-Bit Server VM (build 24.0-b21, mixed mode)

C:\dev\javafx\ClassPathTest\build\classes>dir /s
 Directory of C:\dev\javafx\ClassPathTest\build\classes

09/12/2012  02:31 PM    <DIR>          classpathtest
09/12/2012  02:37 PM             1,414 ClassPathTest.jar
09/12/2012  02:36 PM                42 manifest.txt
09/12/2012  02:31 PM               521 roundbutton.css

 Directory of C:\dev\javafx\ClassPathTest\build\classes\classpathtest

09/12/2012  02:31 PM               680 ClassPathTest.class 
```

如果`java -jar ClassPathTest.jar`在早期的 jdk 版本上没有为您返回 null，但在 jdk7u7+ 上确实为您返回 null，那么您发现了一个 jdk 错误。除了我安装的版本之外，我还没有测试过其他 jdk 版本，但我认为存在与此相关的 jdk 错误的可能性很低。

# c# - 选中时更改切换按钮的背景颜色

> ID：12394101
> 
> 赞同：5
> 
> 时间：2012-09-12T18:18:25.520
> 
> 标签：c#, wpf, styles, togglebutton

我正在尝试区分单击时切换按钮的状态。我有下面的片段

```
<Window x:Class="WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <Style x:Key="OnOffToggleImageStyle" TargetType="ToggleButton">
            <Style.Triggers>
                <Trigger Property="IsChecked" Value="True">
                    <Setter Property="Background" Value="DimGray"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Grid>
        <ToggleButton Height="60" Content="Text" Style="{StaticResource OnOffToggleImageStyle}">
        </ToggleButton>
    </Grid>
</Window> 
```

但是，当样式中的 IsChecked 值设置为“True”时，这不起作用。当设置为 false 时，它​​可以工作。

我想知道为什么。任何答案！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:22:08.907

运行您的代码示例时，样式似乎与 'chrome' 的`ToggleButton`（即按钮的原始样式）冲突。

在这种情况下，最好覆盖模板`ToggleButton`以按照您希望的方式进行操作。一个丑陋的例子可以在下面找到：

```
<Style x:Key="myToggleButton" TargetType="{x:Type ToggleButton}">
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate>
        <Border x:Name="outer"
        BorderBrush="White"
        BorderThickness="2"
        Opacity=".9"
        Background="Transparent">
          <Border x:Name="inner"
          Margin="8"
          BorderThickness="0"
          Background="{
            Binding Background, 
            RelativeSource={RelativeSource TemplatedParent}}">
            <Grid x:Name="container">
              <Grid.RowDefinitions>
                <RowDefinition Height="2*"/>
                <RowDefinition/>
              </Grid.RowDefinitions>
              <TextBlock x:Name="display"
              Grid.Row="1"
              Text="{Binding Content, RelativeSource={
                RelativeSource TemplatedParent}}"
              Foreground="White"
              FontSize="11"
              FontFamily="Segoe UI"
              FontStyle="Normal"
              FontWeight="Normal"
              Margin="8,0,0,4"
              HorizontalAlignment="Left"
              VerticalAlignment="Bottom"/>
            </Grid>
          </Border>
        </Border>
        <ControlTemplate.Triggers>
          <Trigger Property="ToggleButton.IsChecked" Value="True">
            <Setter TargetName="outer" Property="Background" Value="LightBlue"/>
            <Setter TargetName="outer" Property="BorderBrush" Value="Transparent"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

# php - PHP 连接变量 ini 文件

> ID：12394104
> 
> 赞同：1
> 
> 时间：2012-09-12T18:18:41.473
> 
> 标签：php, mysqli, ini

如果远程访问数据库的唯一目的是选择，那么将数据库连接信息存储在 ini 文件中的风险和好处是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:24:33.253

将配置存储在 ini 文件中没有任何问题*，**但*最好不要接触php.ini 文件。

只需创建您自己的 .ini 文件并使用`parse_ini_file($filename)`或`parse_ini_file($filename, true)`按部分分组来阅读它。

有关更多信息，请参阅[php 文档](http://php.net/manual/en/function.parse-ini-file.php)

**编辑**

进一步的例子

```
; This is your 'config.ini' file, stored on your web server
; Just make sure it isn't in a public directory!

[database]
host = localhost
user = bob
password = password 
```

然后你的PHP：

```
$config = parse_ini_file(__DIR__ . '/../config.ini', true); // Assuming your php is in the root directory of your web server, so placing the file where it can't be seen by prying eyes!
$host = $config['database']['host'];
// etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:05:03.070

如果您指的是部分`php.ini`下的文件和设置`[mysqli]`：

```
[mysqli]
mysqli.default_port = 3306
mysqli.default_host = 127.0.0.1
mysqli.default_user = db_user
mysqli.default_pw = db_pass 
```

然后将它们设置在 ini 文件中可以方便地进一步使用 myqsli，因为您不必解析任何文件/定义自己的配置，只需连接：

```
$db = mysqli_connect(); // no arguments, just works.
$res = mysqli_query($db, 'SHOW DATABASES');
while($row = mysqli_fetch_assoc($res)){
    print_r($row);
} 
```

仅当您将 phpinfo 留在某处时才存在风险，那么您的用户名和密码将暴露给查看此文件的任何人。

# php - 如何使用 php 函数 unlink 从服务器中删除图像？

> ID：12394107
> 
> 赞同：0
> 
> 时间：2012-09-12T18:18:50.650
> 
> 标签：php, mysql, image, unlink

我仍在尝试学习更多的 php，我目前正在编写一个脚本来上传和删除图像到我的服务器。现在上传一切正常，从数据库中删除也不是问题。发生的唯一问题是从我服务器上的上传文件夹中删除图像本身。

下面是我的代码。echo 语句会输出以下 url：479_1293904366__sdc14139.jpg 老实说，我似乎找不到我的错误，非常感谢您的帮助。

提前致谢！

```
$unlinkafbeelding = "SELECT * FROM Afbeeldingen WHERE id = $ID";
$select = mysql_query($unlinkafbeelding) or die('Error, je bent een mongool');
$image = mysql_fetch_array($select);
echo($image['naam']);
unlink($image['naam']); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:25:36.837

您收到任何错误消息吗？也许是因为图像没有存储在与执行脚本的目录相同的文件夹中。确保图像的路径正确。

否则发布您的错误消息。如果您没有收到任何消息，请将以下行插入您的 php 脚本并再次运行它。应该显示每条消息。

```
error_reporting (E_ALL); 
```

# django - 分配唯一 id 避免竞争条件

> ID：12394113
> 
> 赞同：2
> 
> 时间：2012-09-12T18:19:02.117
> 
> 标签：django

我有一个名为 Vehicles 的表单，每次用户完成一个表单时，我都会尝试为每个表单分配一个唯一的 ID。

```
class Vehicles(models.Model):
     id = models.DecimalField(primary_key=True, unique=True) 
```

在我根据最后一个车辆数据库记录分配给 id 字段的初始值之后，试图避免竞争条件（当同时提交两个表单时），在保存表单之前，我再次查询 db 的 id的最后一条记录。我或多或少是这样做的：

```
def vehicle(request):
    vehicles= Vehicles.objects.all().order_by("-id")[0]
    id = vehicles.id+1

    if request.method == 'POST':
        form = VehiclesForm(data=request.POST)

        if form.is_valid():
            vehicles= Vehicles.objects.all().order_by("-id")[0]
            id = vehicles.id+1
            temp = form.save(new_veh_id=id)
            return render_to_response('success.html', locals(), context_instance= RequestContext(request))
    else:
        form = VehiclesForm(initial={'id': id})
    return render_to_response('insertVehicle.html', locals(), context_instance= RequestContext(request)) 
```

在表单中我覆盖了保存方法：

```
 def save(self, *args, **kwargs):
        commit = kwargs.pop('commit', True)
        new_veh_id = kwargs.pop('new_veh_id', None)
        instance = super(VehiclesForm, self).save(*args, commit = False, **kwargs)

        if id is not None: instance.id = new_veh_id
        if commit:
            instance.save()
        return instance 
```

但 is_valid 以错误形式返回 false：具有此 ID 的车辆已存在。我将这种做法与另一个模型和表单（与这些相同的字段）完全相同，它就像一个魅力，尽管 id 相同，但表单通过验证，并在最后提交的表单中更改它。谁能帮助我或提出更好的解决方案来实现此功能？我所做的也许是某种“习惯”。

编辑：我也试过这个，但 is_valid 再次失败

```
 def clean(self):
        cleaned_data = super(VehiclesForm, self).clean()
        id = unicode(self.cleaned_data.get('id'))

        vehicles= Vehicles.objects.all().order_by("-id")[0]
        id = vehicles.id+1
        cleaned_data[id] = id

        return cleaned_data 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:35:26.783

我认为您需要[select_for_update](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.select_for_update)锁定行直到事务结束。请注意，尽管它被指定用于多行，但您仍然可以只锁定一行，方法是确保您的`filter`查询将只返回一个对象。

# python - Webfaction Django 1.4.1：使用自定义 nginx 构建服务静态和媒体

> ID：12394117
> 
> 赞同：0
> 
> 时间：2012-09-12T18:19:08.563
> 
> 标签：python, django, django-staticfiles, webfaction

我为我的项目有一个自定义的 nginx 构建，一切正常，除了我对使用相同的 nginx 服务器提供静态文件感到困惑（你可以在下面看到我的配置文件）最近尝试在控制面板中设置`root=/home/USERNAME/media/app/`并创建仅静态应用程序和分别`root= /home/USERNAME/.virtualenvs/medialaw;`指向`extra_info`我的`MEDIA_ROOT`和，`STATIC_ROOT`但一切都失败了。

任何人都可以帮助我，可能有人已经面临这样的挑战吗？

```
server {
    listen   MY_PORT;
    server_name USERNAME.webfactional.com;

    access_log /home/USERNAME/logs/user/nginx/app_access.log;
    error_log  /home/USERNAME/logs/user/nginx/app_error.log;

    root /home/USERNAME/.virtualenvs/medialaw;

   location /m {
        alias /home/USERNAME/media/app/media;

        if ($query_string) {
            expires max;
        }
    }

    location /s {
        alias /home/imanhodjaev/media/app/static;

        if ($query_string) {
            expires max;
         }
    }

    location / {
        proxy_pass_header Server;
        proxy_set_header Host $http_host;
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_connect_timeout 10;
        proxy_read_timeout 10;
        proxy_pass http://localhost:PORT/;
    }

    error_page 500 502 503 504 /media/50x.html;
} 
```

> 我最近在 webfaction 问答网站 [http://community.webfaction.com/questions/10535/django-141-serving-static-and-media-with-custom-nginx-build上发布了这个问题](http://community.webfaction.com/questions/10535/django-141-serving-static-and-media-with-custom-nginx-build)

谢谢，

苏丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T03:52:46.300

问题已解决 这是目前配置的样子

### Nginx

```
server {
    listen   MY_PORT;
    server_name USERNAME.webfactional.com;

    access_log /home/USERNAME/logs/user/nginx/app_access.log;
    error_log  /home/USERNAME/logs/user/nginx/app_error.log;

    root /home/USERNAME/media/app;

    location /m {
        alias /home/USERNAME/media/app/media;
    }

    location /s/ {
        alias /home/imanhodjaev/media/app/static;
    }

    location / {
        proxy_pass_header Server;
        proxy_set_header Host $http_host;
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_connect_timeout 10;
        proxy_read_timeout 10;
        proxy_pass http://localhost:PORT/;
    }

    error_page 500 502 503 504 /media/50x.html;
} 
```

### 从控制面板配置 Webfaction

删除了两个仅静态应用程序填写必填字段并`extra_info`分别设置为静态和媒体位置。

谢谢，

苏丹

# java - 如何android + sqlite + date + time？需要日期/时间操作

> ID：12394119
> 
> 赞同：0
> 
> 时间：2012-09-12T18:19:13.233
> 
> 标签：java, android, sqlite, datetime

我有一个活动，我想将一些度量数据保存到 sqlite 数据库中（我只有插入选项）。xml 是：

![在此处输入图像描述](../Images/0b47ba25acf4ba15a7958963819b4bad.png)

日期/时间在创建此活动后取值（按日期/时间对话框），然后用户可以根据需要更改它。

我希望在另一个活动中按日期+时间降序排列度量。

我还希望能够获取过去 1 / 7 / 30 天的测量值。

制作 sqlite 表的最佳方法是什么？我应该如何保存日期+时间？一起保存？还是不保存？作为 TEXT 或 REAL 或 INTEGER 以便我可以轻松地进行上述操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:54:31.887

您应该使用`System.currentTimeMillis()`该 BIGINT 值并将其存储在表中。您可以通过以下方式解析时间：

```
 SimpleDateFormat sdf = new SimpleDateFormat("MM dd,yyyy HH:mm");

    Date resultdate = new Date(yourmilliseconds);
    System.out.println(sdf.format(resultdate)); 
```

资料来源：[如何将 currentTimeMillis 转换为可读的日期格式？](https://stackoverflow.com/questions/10364383/android-how-to-get-currenttimemillis-to-datetime-format)

# jquery - bing v7 ajax控件中的旧蓝色导航栏

> ID：12394120
> 
> 赞同：0
> 
> 时间：2012-09-12T18:19:14.420
> 
> 标签：jquery, ajax, bing-maps

我需要在我的嵌入式 bing 地图中自定义导航栏。

我正在使用新的 Microsoft.Maps.Map V7 ajax，但我被要求恢复 V6 VE Map 样式导航栏，同时仍使用 V7 控件。这是可能吗？有什么建议吗？

示例：在交互式 SDK 中查看：

*   V6 带蓝色半透明条： http: [//www.microsoft.com/maps/isdk/ajax/](http://www.microsoft.com/maps/isdk/ajax/)
*   V7 带有新的灰色导航栏： http: [//www.bingmapsportal.com/isdk/ajaxv7#CreateMap1](http://www.bingmapsportal.com/isdk/ajaxv7#CreateMap1)

任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:53:47.350

如果没有一些 DOM/CSS hack，我认为这是不可能的。我会通过查看生成的 V7 导航栏的 HTML 来解决这个问题，并尝试重新设置它的样式，使其看起来像 V6 版本，同时保留所有功能。

但是，如果此更改请求的原因是由于 V7 导航栏的简单外观/感觉，也许您可​​以在 V7 地图上的 Bing 主题模块中向他们展示更快捷的导航栏，看看他们是否对此感到满意反而？

[http://www.bingmapsportal.com/isdk/ajaxv7#BingThemeModule1](http://www.bingmapsportal.com/isdk/ajaxv7#BingThemeModule1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T06:06:42.820

您不能轻易更改内置 v7 导航栏的样式 - 它不是为定制而设计的，没有为元素分配适当的 id/类，并且结构很可能在版本之间更改而不会发出警告。

相反，最可靠的选择是完全禁用内置的 v7 导航栏（通过使用 showDashboard: false 初始化地图），然后构建自己的导航栏 div 模仿 v6 仪表板的样式并将其放在顶部地图使用 CSS 定位。

# ajax - JQuery Mobile 使用 AJAX 和 Facebook Like、Twitter Tweet、G+

> ID：12394124
> 
> 赞同：2
> 
> 时间：2012-09-12T18:19:41.320
> 
> 标签：ajax, jquery-mobile, twitter, facebook-like, google-plus-one

我希望在使用 JQuery Mobile 构建的网站的每个页面上都有类似 fb 的按钮、twitter 的推文按钮和 G+ 等价物，并且不放弃 AJAX 转换。

我可以让它适用于多页（将 example0.html#1 链接到 example0.html#2 并返回）

我可以使用自定义的基本 javascript（如 alert('*');) 来运行正确的时间（在每个页面上显示一次，example1.html <-> example2.html）。使用 jquery .off 和 .on。

我可以完成关闭ajax。工作正常 example1.html <-> example2.html

但是，对于带有 ajax 和更多单页的社交按钮，就不能很好地做到这一点。按钮应显示在每个页面上，例如 example1.html <-> example2.html

任何社交按钮的任何工作示例？

（类似的问题，但也没有工作示例：[Integrating jQuery Mobile with Facebook Like and Twitter Tweet](https://stackoverflow.com/questions/8714694/integrating-jquery-mobile-with-facebook-like-and-twitter-tweet)）

完整示例，适用于第一个（已加载）页面，不适用于另一页。

 `````
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>Title</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
</head>
<body>

<div data-role="page" id="page1" data-title="Page 1">
  <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=121542504547391";
      fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>
  <div class="fb-like" data-href="http://localhost" data-send="false" data-layout="button_count" data-width="250" data-show-faces="false"></div>
  <a href="#page2" data-role="button" data-icon="arrow-r" data-iconpos="right">Page 2</a>
</div>

<div data-role="page" id="page2" data-title="Page 2">
  <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=121542504547391";
      fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>
  <div class="fb-like" data-href="http://localhost" data-send="false" data-layout="button_count" data-width="250" data-show-faces="false"></div>
  <a href="#page1" data-role="button" data-icon="arrow-l">Page 1</a>
</div>

</body>
</html> 
````  `* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T18:17:21.660

在推文按钮嵌入代码中，有一个 if 语句检查 id 为“twitter-wjs”的元素。在页面加载之前删除此元素会使推文按钮起作用。

```
$(document).bind('pagebeforeload', function(){
    $('#twitter-wjs').remove();
}); 
```

这是 Facebook 喜欢按钮的修复程序。我不会假装理解它，我只是发现了这个谷歌搜索，它似乎使它工作。

```
$(document).bind('pageshow', function() {
    try{
        FB.XFBML.parse();
    } catch(err){}
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T21:39:43.220

[Garyv](https://stackoverflow.com/users/1812972/garyv)已经为您提供了 Facebook 的正确答案：

```
FB.XFBML.parse(); 
```

要动态地重新加载 Tweet 按钮，您正在寻找的功能是：

```
twttr.widgets.load(); 
```

您应该在通过 ajax 加载内容后应用这两个函数。

更新：

根据 Google+ 按钮，答案是：

```
gapi.plusone.go(); 
```

（在这里找到：[Google plus-one button on a page that are refreshed with AJAX](https://stackoverflow.com/questions/7583892/google-plus-one-button-on-a-page-that-is-refreshed-with-ajax)``

# javascript - 触发父点击事件而不是子点击事件jQuery+salesforce

> ID：12394128
> 
> 赞同：1
> 
> 时间：2012-09-12T18:19:45.753
> 
> 标签：javascript, jquery, salesforce, visualforce

我试图让动态按钮元素（#EditAsset）在单击时触发，但由于它位于带有单击事件（#Results_Grid）的 div 内部，因此这是唯一触发的事件。我找到了一些关闭传播的示例，以便您可以访问这些元素，但它不起作用。我有一种感觉，我可能做错了什么，所以任何帮助将不胜感激！

```
<apex:page docType="html-5.0" standardStylesheets="false" showHeader="false" standardController="Assets__c" extensions="AS_Viewer_m">

<apex:stylesheet value="{!URLFOR($Resource.jQuery_Mobile_1_1_1, 'jquery.mobile-1.1.1.min.css')}"/>
<apex:includeScript value="{!URLFOR($Resource.jQuery_Mobile_1_1_1, 'js/jquery-1.7.2.min.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.jQuery_Mobile_1_1_1, 'jquery.mobile-1.1.1.min.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.jQuery_Mobile_1_1_1, 'js/jquery-ui-1.8.22.custom.min.js')}"/>
<link rel="stylesheet" href="{!URLFOR($Resource.jQuery_Mobile_1_1_1, 'SGMobile.css')}"/>
<apex:stylesheet value="{!$Resource.AS_CSS_m}"/>
<script>
    var j$ = jQuery.noConflict();
    var Results_Div=j$('#Results_Grid');
    var Results_Grid_Header=j$('#Results_Grid_Header');
    var QFilter;
    var SearchString;
    var PowersCombined;
    var oldResultElement;
    var id;
    var com;
    j$(function() {    
       Results_Div=j$('#Results_Grid');
       QFilter=j$('#Query_Filter').val();
       SearchString=j$('#SearchBox').val();
       PowersCombined=QFilter+'°'+SearchString;

           j$('#Search_Submit').click(function(){
                  QFilter=j$('#Query_Filter').val();
                  SearchString=j$('#SearchBox').val();
                  PowersCombined=QFilter+'°'+SearchString;

                  Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.AS_Viewer_m.getAssets}',
                  PowersCombined,
                  function(result, event)
                  { 
                      j$(Results_Div).children().remove();
                      id=result.id;
                      for(var b = 0; b < result.length; b++){

                          j$('<div class="ui-grid-d" name="AssetGrid" id="AssetGrid'+result[b].Id+'" >'+
                              '<div class="ui-block-a"><div class="ui-bar ui-bar-e" style="height:20px;width:200px">'+result[b].Name+'</div></div>'+
                              '<div class="ui-block-b"><div class="ui-bar ui-bar-e" style="height:20px;width:200px">'+result[b].Model__r.Name+'</div></div>'+
                              '<div class="ui-block-c"><div class="ui-bar ui-bar-e" style="height:20px;width:200px">'+result[b].Serial_Number__c+'</div></div>'+
                              '<div class="ui-block-d"><div class="ui-bar ui-bar-e" style="height:20px;width:200px">'+result[b].User+'</div></div>'+
                              '<div class="ui-block-d"><div class="ui-bar ui-bar-e" style="height:20px;width:200px">'+result[b].Acquisition_Date__c+'</div></div>'+
                              '<div id="AssetInfo'+result[b].Id+'" name="AssetInfo" style="width:1000px; margin:0 auto;"></div>'+
                            '</div>').appendTo(Results_Div);

                      }

                  },{escape: true});  

       });
       j$('#Results_Grid').on('click','div[name="AssetGrid"]', function() {

         j$(com).empty();
         if (oldResultElement!=null){
             j$(oldResultElement).children().remove();
         }

         var st=this.id;
         com='#AssetInfo'+st.substring(9);

         oldResultElement='#AssetInfo'+st.substring(9);

         Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.AS_Viewer_m.getAsset}',
            st.substring(9),
            function(result, event)
            {
             id=result.id;
             if(result.RecordType.DeveloperName=='Infrastructure_Hardware'){

               j$('<div style="width:500px;float:left;">'+
               '<b>Asset Name: </b>'+result.Name+'<br/>'+
               '<b>Serial Number: </b>'+result.Serial_Number__c+'<br/>'+
               '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
               '<b>Host Name: </b>'+result.Host_Name__c+'<br/>'+
               '<b>IP Address: </b>'+result.IP_Address__c+'<br/>'+
               '<b>MAC Address: </b>'+result.Mac_Address__c+'<br/>'+
               '<b>Comments: </b>'+result.Comments__c+'<br/>'+
               '</div>'+
               '<div style="float:left;width:300px;padding:0px 0px 0px 80px;">'+
               '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
               '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
               '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
               '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
               '<b>Allocation: </b>'+result.User__c+'<br/>'+
               '</div>'+ 
               '<div style="width:80px;float:left;">'+
                      '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="#" id="Edit_Asset"/><br/>'+
                      '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
               '</div>'+
               '<br style="clear:both;"/>').appendTo(com);

              }else if(result.RecordType.DeveloperName=='Monitor'){
                 j$('<div style="width:500px;float:left;">'+
                      '<b>Asset Name: </b>'+result.Name+'<br/>'+
                      '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                      '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                      '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                     '</div>'+
                     '<div style="float:left;width:300px;padding:0px 0px 0px 80px;">'+
                      '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                      '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                      '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                      '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                      '<b>Allocation: </b>'+result.User__c+'<br/>'+
                     '</div>'+ 
                     '<div style="width:80px;float:left;">'+
                         '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="#" id="Edit_Asset"/><br/>'+
                         '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
                     '</div>'+
                     '<br style="clear:both;"/>').appendTo(com);
              }else if(result.RecordType.DeveloperName=='Peripheral_Device'){
                    j$('<div style="width:500px;float:left;">'+
                          '<b>Asset Name: </b>'+result.Name+'<br/>'+
                          '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                          '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                          '<b>Host Name: </b>'+result.Host_Name__c+'<br/>'+
                          '<b>IP Address: </b>'+result.IP_Address__c+'<br/>'+
                          '<b>MAC Address: </b>'+result.Mac_Address__c+'<br/>'+
                          '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                         '</div>'+
                         '<div style="float:left;width:300px;padding:0px 0px 0px 80px;">'+
                          '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                          '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                          '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                          '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                          '<b>Allocation: </b>'+result.User__c+'<br/>'+
                         '</div>'+ 
                         '<div style="width:80px;float:left;">'+
                            '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="#" id="Edit_Asset"/><br/>'+
                            '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
                         '</div>'+
                         '<br style="clear:both;"/>').appendTo(com);
                  }else if(result.RecordType.DeveloperName=='Phone'){
                     j$('<div style="width:500px;float:left;">'+
                          '<b>Asset Name: </b>'+result.Name+'<br/>'+
                          '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                          '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                          '<b>Carrier:</b>'+result.Carrier__c+'<br/>'+
                          '<b>Phone Number: </b>'+result.Phone_Number__c+'<br/>'+
                          '<b>IMEI Number: </b>'+result.IMEI_Number__c+'<br/>'+
                          '<b>PIN Number: </b>'+result.PIN_Number__c+'<br/>'+
                          '<b>IP Address: </b>'+result.IP_Address__c+'<br/>'+
                          '<b>MAC Address: </b>'+result.Mac_Address__c+'<br/>'+
                          '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                         '</div>'+
                         '<div style="float:left;width:300px;">'+
                          '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                          '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                          '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                          '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                          '<b>Allocation: </b>'+result.User__c+'<br/>'+
                         '</div>'+ 
                         '<div style="width:80px;float:left;">'+
                               '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="#" id="Edit_Asset"/><br/>'+
                               '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+

                         '</div>'+
                         '<br style="clear:both;"/>').appendTo(com);
                  }else if(result.RecordType.DeveloperName=='Scanner'){
                        j$('<div style="width:500px;float:left;">'+
                              '<b>Asset Name: </b>'+result.Name+'<br/>'+
                              '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                              '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                              '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                            '</div>'+
                            '<div style="float:left;width:300px;padding:0px 0px 0px 80px;">'+
                              '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                              '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                              '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                              '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                              '<b>Allocation: </b>'+result.User__c+'<br/>'+
                           '</div>'+
                           '<div style="width:80px;float:left;">'+
                               '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}" href="{!URLFOR($Page.AS_AssetEdit_m,null,[id='+id+'])}" id="Edit_Asset"/><br/>'+
                               '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
                           '</div>'+
                           '<br style="clear:both;"/>').appendTo(com);

                      }else if(result.RecordType.DeveloperName=='Software'){
                            j$('<div style="width:500px;float:left;">'+
                                  '<b>Asset Name: </b>'+result.Name+'<br/>'+
                                  '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                                  '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                                  '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                                 '</div>'+
                                 '<div style="float:left;width:300px;padding:0px 0px 0px 80px;">'+
                                  '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                                  '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                                  '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                                  '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                                  '<b>Allocation: </b>'+result.User__c+'<br/>'+
                                 '</div>'+ 
                                 '<div style="width:80px;float:left;">'+
                                           '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="" id="Edit_Asset"/><br/>'+
                                           '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
                                 '</div>'+
                                 '<br style="clear:both;"/>').appendTo(com);
                          }else if(result.RecordType.DeveloperName=='Workstation'){

                                j$('<div style="width:500px;float:left;">'+
                                      '<b>Asset Name: </b>'+result.Name+'<br/>'+
                                      '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                                      '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                                      '<b>Host Name: </b>'+result.Host_Name__c+'<br/>'+
                                      '<b>IP Address: </b>'+result.IP_Address__c+'<br/>'+
                                      '<b>MAC Address: </b>'+result.Mac_Address__c+'<br/>'+
                                      '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                                     '</div>'+
                                       '<div style="float:left;width:300px;padding:0px 0px 0px 80px;">'+
                                      '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                                      '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                                      '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                                      '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                                      '<b>Allocation: </b>'+result.User__c+'<br/>'+
                                     '</div>'+ 
                                     '<div style="width:80px;float:left;">'+
                                           '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="" id="Edit_Asset"/><br/>'+
                                           '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
                                     '</div>'+
                                     '<br style="clear:both;"/>').appendTo(com);
                            }else if(result.RecordType.DeveloperName=='Mobile_Device'){
                    j$('<div style="width:500px;float:left;">'+
                          '<b>Asset Name: </b>'+result.Name+'<br/>'+
                          '<b>Serial Number: </b>'+result.Serial_nuMber__c+'<br/>'+
                          '<b>Model: </b>'+result.Model__r.Name+'<br/>'+
                          '<b>Carrier: </b>'+result.Carrier__c+'<br/>'+
                          '<b>Phone Number: </b>'+result.Phone_Number__c+'<br/>'+
                          '<b>IMEI Number: </b>'+result.IMEI_Number__c+'<br/>'+
                          '<b>PIN Number: </b>'+result.PIN_Number__c+'<br/>'+
                          '<b>IP Address: </b>'+result.IP_Address__c+'<br/>'+
                          '<b>MAC Address: </b>'+result.Mac_Address__c+'<br/>'+
                          '<b>Comments: </b>'+result.Comments__c+'<br/>'+
                         '</div>'+
                           '<div style="width:300px;float:left;padding:0px 0px 0px 80px;">'+
                          '<b>Account/Hospital: </b>'+result.Account_Hospital__c+'<br/>'+
                          '<b>Date Lost/Stolen: </b>'+result.Date_Lost_Stolen__c+'<br/>'+
                          '<b>Acquisition Date: </b>'+result.Acquisition_Date__c+'<br/>'+
                          '<b>Decommission Date: </b>'+result.Decommission_Date__c+'<br/>'+
                          '<b>Allocation: </b>'+result.User__c+'<br/>'+
                       '</div>'+
                       '<div style="width:80px;float:left;">'+
                       '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/edit.png')}"  href="#" id="Edit_Asset"/><br/>'+
                       '<input type="image" src="{!URLFOR($Resource.Coquette, 'PNG/64x64/trash_can.png')}"  href="#" id="Delete_Asset"/>'+
                       '</div>'+
                       '<br style="clear:both;"/>').appendTo(com);
                  }

            },{escape: true});
        });
        j$(com).click('div[name="AssetInfo"]', function(e) {
               e.stopPropagation();
              alert('worked');
        });

    });

</script> 

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
</head>
<apex:form >
<div data-role="header"> 
    <h1>Find Asset</h1> 
</div> 

<div id="Search_Div" class="Element_LeftAlign">
<input type="text" id="SearchBox" style="width:300px;display:inline;"/>
<button type="button" style="vertical-align:bottom;display:inline;" id="Search_Submit">Search</button>
    <select size="1" id="Query_Filter">
        <option value="00">--Please select--</option>
        <option value="01">Serial Number</option>
        <option value="02">Name</option>
        <option value="03">Allocated To</option>
        <option value="04">In Inventory</option>
    </select>
    <!--Make this a button that expands out-->
</div>
<div id="Results_Grid_Header" data-theme="d" style="display:inline;position:fixed;top:170px;">
<div class="ui-grid-d">
<div class="ui-block-a ui-li-count"><div class="ui-bar ui-bar-e" style="height:20px;width:200px"><b>Name</b></div></div>
<div class="ui-block-b ui-li-count"><div class="ui-bar ui-bar-e" style="height:20px;width:200px"><b>Model</b></div></div>
<div class="ui-block-c ui-li-count"><div class="ui-bar ui-bar-e" style="height:20px;width:200px"><b>Serial Number</b></div></div>
<div class="ui-block-d ui-li-count"><div class="ui-bar ui-bar-e" style="height:20px;width:200px"><b>Allocated To</b></div></div>
<div class="ui-block-e ui-li-count"><div class="ui-bar ui-bar-e" style="height:20px;width:200px"><b>Acquisition Date</b></div></div>
</div>
<div id="Results_Grid" class="" style="overflow:auto;height:350px;">

</div>
</div>

</apex:form>
</apex:page> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:24:56.543

将 stopPropation() 方法放在事件的执行内容之后。这将防止之后触发所有事件。IE

```
j$(com).click('div[name="AssetInfo"]', function(e) {
     alert('worked');
     // all the code to be execute

     e.stopPropagation();
}); 
```

# wcf - WCF 有没有办法将工厂关联到创建的通道

> ID：12394129
> 
> 赞同：0
> 
> 时间：2012-09-12T18:19:59.053
> 
> 标签：wcf, channel, channelfactory

我正在使用 WCF 在服务器应用程序和客户端应用程序之间创建连接。

因为我正在使用`NetTcpBinding`，所以我想保持由以下人员创建的频道：

```
T proxy = ChannelFactory<T>.CreateChannel(); 
```

我将代理实例带入我的应用程序以与服务器通信。在某个时刻，我用不同的工厂更新了这个代理。但我想通过处置它从第一个工厂释放资源。但我不想管理工厂并保留参考。

代理实例有没有办法检索通道关联来处理它？

喜欢 ...

```
var commObj = (ICommunicationObject)proxy;
commObj.Factory.Dispose(); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:47:34.127

不幸的是，这是不可能的，因为渠道和工厂没有关联。但我认为你的方法是不正确的。您应该保留对工厂的引用并根据需要创建 Channel。在某些情况下，重用 Channel 可能是个问题。通道可能出现故障，但内部工厂仍然有效。创建工厂是有实际成本的，一些 .net 3.5 SP1 工厂内部存储在静态缓存中。

# x86 - rdtsc 的返回值是_always_ mod 10 == 0 on Atom N450

> ID：12394131
> 
> 赞同：5
> 
> 时间：2012-09-12T17:58:38.457
> 
> 标签：x86, x86-64, systems-programming, rdtsc, intel-atom

在我的 E8200 机器上，这不会发生，但在我的 Atom N450 上网本（都运行 OpenSuse 11.2）上，每当我读取 CPU 的 TSC 时，返回的值为`mod 10 == 0`，即它不能被 10 整除。我正在使用 RDTSC测量有趣的代码所花费的时间的价值，但为了演示的目的，我编写了这个小程序：

```
 .text
        .global _start

_start: xorl    %ebx,%ebx
        xorl    %ecx,%ecx
        xorl    %r14d,%r14d
        movb    $10,%cl
loop:   xchgq   %rcx,%r15          # save to reg
        cpuid
        rdtsc
        shlq    $32,%rdx
        xorq    %rax,%rdx          # full 64 bit of RDTSC
        movq    %r14,%r13          # save the old value
        movq    %rdx,%r14          # copy current
        movq    %r14,%rsi          #  argv[1] of printf()
        subq    %r13,%rdx          #  argv[2] (delta)
        leaq    format(%rip),%rdi  #  argv[0]
        xorl    %eax,%eax          #  no stack varargs
        call    printf
        xchgq   %rcx,%r15
        loop    loop

0:      xorl    %eax,%eax
        movb    $0x3c,%al
        syscall

        .size   _start, .-_start

        .data
format: .asciz     "rdtsc: %#018llx = %1$llu -- delta: %llu\n" 
```

（我通常使用自己的例程进行转换，但为了防止读者暗示可能存在错误，我在这里仅使用 printf() 。）

使用上面的代码，输出是（例如）：

```
rdtsc: 0x000b88ef933ffd06 = 3246787292822790 -- delta: 3246787292822790
rdtsc: 0x000b88ef9342fcf4 = 3246787293019380 -- delta: 196590
rdtsc: 0x000b88ef93435dca = 3246787293044170 -- delta: 24790
rdtsc: 0x000b88ef9343b43c = 3246787293066300 -- delta: 22130
rdtsc: 0x000b88ef93440c34 = 3246787293088820 -- delta: 22520
rdtsc: 0x000b88ef9344604e = 3246787293110350 -- delta: 21530
rdtsc: 0x000b88ef9344b4d6 = 3246787293131990 -- delta: 21640
rdtsc: 0x000b88ef9345085a = 3246787293153370 -- delta: 21380
rdtsc: 0x000b88ef93455d96 = 3246787293175190 -- delta: 21820
rdtsc: 0x000b88ef9345b16a = 3246787293196650 -- delta: 21460 
```

可以很容易地看出，delta 在合理的范围内变化。但显着（不是说合谋;-）是最低有效十进制数字始终为0。

我已经观察到这种现象两年多了，而 Stack Overflow 并不是我公开这个问题的第一个地址。但我还没有得到一个合理的答案。我们（我和其他人）提出的想法是

*   TSC 仅每 10^个周期增加一次，然后增加 10，或
*   ^(TSC 在内部正确更新，但仅每 10个)周期反映到外部，或
*   TSC 每个周期递增 10。

然而，这些观点都没有真正的意义。我实际上应该在 E8200 上运行一个类似的程序（当前出现故障），以查看增量的数量级是否与上述输出中的数量级相同或只有十分之一。（有志愿者吗？）

谷歌搜索没有帮助，英特尔的手册也没有。

在与其他人讨论时，没有其他人经历过同样的行为。如果它与内核有关，那么至少有 3 个版本受到影响，但是……内核与它有什么关系？

我还使用了上网本，它带有一个新的主板——意味着一个新的 CPU，所以 N450 至少有两个单独的实体必须受到影响。

我还针对时钟频率变化采取了措施（无论我将时钟固定到什么频率，值都只在预期范围内变化（如图所示）），并关闭了 HT，尽管这些实际上应该*有助于*获得一些其他最低有效数字，而不是阻止它们。但只是为了确定。

好吧，如果有人想在他们的机器上运行程序，命令行是（假设你将源代码保存在文件中`rdtsc.s`）：

```
as rdtsc.s -o rdtsc.o
ld --dynamic-linker=/lib64/ld-linux-x86-64.so.2 rdtsc.o -L /lib64 -l c -o rdtsc 
```

为了用 gcc 前端构建它，即

```
gcc -l c rdtsc.s -o rdtsc 
```

您必须添加（或替换`_start:`标签）`main:`标签并使其成为全局标签。

[更新（2012-09-15 ~21:15 UTC）：实际上我之前也可以这样做*：*我只是让它在 a 之前和之后取 TSC `sleep(1)`，这给出了一个略大于 1,666,000,000 的增量，这表明第三个上面列表中的点是错误的。但我仍然不知道为什么我没有得到完整的精度。/更新]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:34:03.413

软件开发手册第 3B 卷是这样说的：

> ...对于英特尔凌动处理器...时间戳计数器以恒定速率递增。该速率可以由处理器的最大核心时钟与总线时钟的比率来设置，或者可以由处理器启动的最大解析频率来设置。最大解析频率可能与处理器的最大合格频率不同，...

这并不能完全回答为什么您会看到具体的 10 步，但它确实指出特定的实现可以自由增加 1 以外的值。我怀疑您必须更仔细地查看特定的你的机器的硬件规格和 BIOS 实现来发现为什么它正好是 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:25:11.240

您计算机的 BIOS 不支持 CPU[降频](http://en.wikipedia.org/wiki/Underclocking)。

所以你的[PLL](http://en.wikipedia.org/wiki/CPU_multiplier)在恒定比率下运行。

该比率不能不同，因为[Atom N450](http://ark.intel.com/products/42503/Intel-Atom-Processor-N450-512K-Cache-1_66-GHz)的时钟频率比率是 10。

# php - 使用取消链接使用 AJAX 和 PHP 删除图像时出错

> ID：12394132
> 
> 赞同：0
> 
> 时间：2012-09-12T18:20:03.060
> 
> 标签：php, ajax

我正在尝试使用 AJAX 和 PHP 从文件夹中删除选定的图像。我没有看到任何错误，你能告诉我你对我的代码的看法吗？提前致谢

AJAX 代码：

```
function createAjax()
{
    var objAjax = false;

    if (window.XMLHttpRequest)
    {
        objAjax = new XMLHttpRequest ();
    }
    else
    {
        if (window.ActiveXObject)
        {
            try
            {
                objAjax = new ActiveXObject ("Msxml2.XMLHTTP");
            }
            catch (e)
            {
                try
                {
                    objAjax = new ActiveXObject ("Microsoft.XMLHTTP");
                }
                catch (e)
                {
                }
            }
        }
        else
        {
            objAjax = false;
        }
    }
    return objAjax;
}

function eliminar(id_foto)
{
    var ajax = createAjax();
    ajax.open("POST", "delete_img.php",true);

    ajax.onreadystatechange=function()
    {
        if (ajax.readyState == 4)
        {
              //AQUI DEBES DE PONER EL CODIGO RESPECTIVO PARA ELIMINAR DEL NAVEGADOR
              // EL DIV EN CUESTION o simplemente hacer su contenido vacio, que es lo que hare
             document.getElementById("delete"+id_foto).innerHTML = "";
             document.getElementById("div_mensajes").innerHTML
        }
        else
        {
            document.getElementById("div_mensajes").innerHTML = "<br><center>Eliminando<img src = 'images/ajax-loader.gif' /></center>";
        }
    }

    ajax.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    ajax.send("id_foto="+id_foto);
} 
```

首先显示它的 HTML 和 PHP 代码：

```
$handle = opendir(dirname(realpath(__FILE__)).'/uploads/');
while($file = readdir($handle)) {

if($file !== '.' && $file !== '..') {
    if(file_exists('uploads/Thumbs.db')){
        unlink('uploads/Thumbs.db');
    }
    echo'<div class="gallery-item" id="delete'.$file.'">
          <p class="gallery-clean">
           <a class="image" rel="'.$file.'" rev="'.$file.'" href="uploads/'.$file.'" title="">
           <img src="uploads/'.$file.'" alt="'.$file.'"></a></p>
         <div>
          <a class="ico ico-delete" rel="9" rev="2" href="#" onclick = "eliminar_ajax('.$file.');"><span></span></a>
          <a class="ico ico-edit" rel="9" href="#"><span></span></a>
          <a class="ico ico-resize" rel="9" href="#"><span></span></a>
          <a class="ico ico-full" rel="group" href="#"><span></span></a>
         </div></div>';
    }
} 
```

删除文件的PHP代码：

```
$dir = "uploads/";
$file = $_POST['id_foto'];
$img = $dir.$file;
unlink($img); 
```

好的！我已经用这个解决了：

```
 script type="text/javascript">
          function deleteFile(fname,directory)
          {
        $.ajax({ url: "delete_img.php",
        data: {"file":fname,"directory":directory},
        type: 'post',
        success: function(output) {
        alert(output);
       $("#delete"+file).remove();
             }
          });
        }
        </script> 
```

如果我调用它，如何删除 div

```
 #delete.'<?php echo $file?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:30:53.327

你的形象的延伸是什么？添加到`$file`like so`$file .= ".whateverextensionithas";`

为了更清楚

```
$dir = "uploads/";
$file = $_POST['id_foto'];
$file .= ".whateverextensionithas";
$img  = $dir.$file;
unlink($img); 
```

或者说清楚

```
$dir = "uploads/";
$ext = ".whateverextensionithas";
$file = $dir.$_POST['id_foto'].$ext;
if(file_exists($file)) 
  unlink($file);
else
  echo "file does not exist"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:44:11.970

试试这段代码：

```
if(isset($_POST['id_foto'])){
    $dir = "uploads/";
    $file = $_POST['id_foto'];
    $img = $dir.$file;

    $f = fopen($dir."post.txt", 'w+');
    fwrite($f, $img);
    fclose($f);
} 
```

并检查`post.txt`你得到什么样的输出。

# php - Web MVC：如何构建模型层？

> ID：12394134
> 
> 赞同：6
> 
> 时间：2012-09-12T18:20:12.120
> 
> 标签：php, model-view-controller

我将以一个`user`对象为例。用户需要注册、登录、注销、编辑（例如，电子邮件更改）等。

所以一方面我有一个`user`对象，它包括各种类变量（伪、电子邮件等）以及 getter 和 setter，也许还有一些不处理 db 的函数。

另一方面，我有一个`DAO`类，它是通过各种 MySQL / PDO 查询（创建记录、更新、检索信息等）直接处理数据库的对象。

是否有任何理由不让`user`对象直接与对象交互`DAO`？换句话说，当`Controller`请求与现有`user`实例相关的数据库查询时（例如，在注册过程中），它应该简单地调用一个函数，`user`其中它本身调用一个函数`DAO`，还是应该在两者之间有一个层？

我已经看到控制器调用第三个类与 DAO 交互并将`user`实例作为 arg 传递的示例。有时，第三层负责创建`user`实例并处理`DAO`. 在我看来，用于处理的所有函数`DAO`都可以驻留在`user`对象内部。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:16:47.040

如果您遵循 MVC 设计模式，那么实例没有**理由位于控制器中。**`User`它应该是模型层的一部分，而不是泄漏到表示层。

看起来你所说的“控制器”实际上更像是一种服务，它应该是模型层的一部分，它处理数据存储相关结构（[映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)、[存储库](http://martinfowler.com/eaaCatalog/repository.html)、DAO）上[域对象之间的交互。](http://c2.com/cgi/wiki?DomainObject)

基本上，您缺少的是正确的关注点分离。

控制器应该只是将数据传递给识别或一些用户管理服务，而不是处理域业务逻辑。所述服务应该初始化`User`对象、验证数据并尝试保存它。控制器不应该知道这些。

> ***像这样的东西：***

```
class SomeController
{
     // ---- snip ----

     public function postRegister( $request )
     {
          $accounts = $this->serviceFactory->create('AccountManagement');
          $account->create( $request->getPost('username'),
                            $request->getPost('email'),
                            $request->getPost('password'),
                            $request->getPost('password2') );

          $this->view->setState( View::STATE_POST );
     }

     // ---- snip ----
} 
```

```
class AccountManagement extends Service
{
     // ---- snip ----

    public function addUser( $username, $email, $password, $repeated_password )
    {

        $user = $this->domainObjectFactory->create( 'User' );

        $user->setNickname( $username );
        $user->setEmail( $email );
        $user->setPassword( $password );
        $user->matchRepeatedPassword( $repeated_password );

        if ( $user->isValid() )
        {
            $dao = $this->DAOFactory->create( 'User' );
            $dao->save( $user );
        }

        // additional code for saving the error state
        // if domain object turns out to be invalid
        // or DAO returns an error
    }

     // ---- snip ----
} 
```

**PS**你可能会发现[这篇文章](https://stackoverflow.com/a/5864000/727208)相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:30:07.920

我认为您正在为模型描述某种适配器或网关，其中您有一个调用适配器的类（它可能与数据库或 XML 数据源交互），然后将结果分配给模型的实例（即将每个匹配的用户结果分配给`User`模型的一个实例）。

过去，我采用了您所描述的方法，其中您有代表一个项目的模型，然后是一个 DAO 将这些项目保存并检索到数据源（无论是数据库还是其他），以及控制器做逻辑。所以一个非常基本的版本：

**用户DAO.php**

```
class UsersDAO extends DAO
{
    public function save(User $user)
    {
        return is_null($user->id) ? $this->insert($user)
                                  : $this->update($user);
    }

    public function insert(User $user)
    {
        $sql = "INSERT INTO `users` (`username`, `password`)
                VALUES (:username, :password)";

        $stmt = $this->db->prepare($sql);
        $stmt->bindParam(':username', $user->username);
        $stmt->bindParam(':password', $user->password);
        $stmt->execute();
    }
} 
```

**用户.php**

```
class User
{
    public $id;
    public $username;
    public $password;
    public $email;
} 
```

**用户控制器.php**

```
class UserController extends Controller
{
    public function register()
    {
        $usersDao = new UserDAO;

        if ($_POST) {
            $user = new User;
            $user->username = $_POST['username'];
            $user->password = $_POST['password'];

            $userDao->save($user);
        }
    }
} 
```

希望这可以帮助。

# android - android 使用谷歌地图 api 发布应用程序

> ID：12394137
> 
> 赞同：1
> 
> 时间：2012-09-12T18:20:23.093
> 
> 标签：android, android-layout, android-intent, android-emulator, android-widget

您好，我使用 google maps api 构建应用程序，当我从 google play 下载应用程序时，apk 工作正常，直到我导出签名 apk（用于在 google play 上发布）

[https://play.google.com/store/apps/details?id=beach.android.com&feature=search_result#?t=W251bGwsMSwyLDEsImJlYWNoLmFuZHJvaWQuY29tIl0](https://play.google.com/store/apps/details?id=beach.android.com&feature=search_result#?t=W251bGwsMSwyLDEsImJlYWNoLmFuZHJvaWQuY29tIl0)。

我看不到地图。

出口标志 apk 破坏地图

有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:31:54.547

当您使用地图 api 时，您使用的是 api 密钥。api 密钥绑定到特定的证书，现在它绑定到您的调试证书。您只需要为您的生产证书获取一个 api 密钥。

见这里：[https ://developers.google.com/android/maps-api-signup](https://developers.google.com/android/maps-api-signup)

编辑：这不再与 Maps API v2 相关

# php - 从 excel 文件中读取日期字段的 PHPExcel 问题

> ID：12394141
> 
> 赞同：8
> 
> 时间：2012-09-12T18:20:48.647
> 
> 标签：php, phpexcel

当我使用该类在我的 php 代码中读取 excel 文件时，我遇到了 PHPExcel 类的问题。

```
// Reading the excel data
$objReader = new PHPExcel_Reader_Excel2007();
$objReader->setReadDataOnly(true);
$objPHPExcel = $objReader->load('test.xlsx');
$objPHPExcel->setActiveSheetIndex(0);
$dataArray = $objPHPExcel->getActiveSheet()->toArray(); 
```

我正在使用这段代码，现在的问题是当我创建一个 excel 文件并插入一个单元格值时，比如日期 01/09/2012

并使用 PHPExcel 类的 toarray() 函数读取完整的 excelsheet，然后它不返回日期值。它返回一个数值。

我发现当我们使用 MS OFFice 应用程序创建 Excel 文件并将日期插入任何单元格时，excel 会将单元格转换为日期格式。所以现在我想使用 PHPExcel 类读取日期格式单元格。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T20:02:44.307

**规则一：**

设置 $objReader->setReadDataOnly(true); 不是一个好主意；你什么时候处理日期。如果你这样做，那么 PHPExcel 将无法告诉你单元格是否包含日期或数字。

**规则二：**

该数字是 Excel 存储的 Excel 日期值。Excel numberFormat Mask 然后用于在显示时将该数字转换为格式化的“人类可读”日期。（如果您使用了 $objReader->setReadDataOnly(true); 那么您还没有加载单元格的 numberFormat 掩码。如果您已经加载了 numberFormat 掩码，那么您可以使用 getFormattedValue() 方法返回格式化的“human -可读”日期作为字符串。

**规则三：**

要将 Excel 数字日期值转换为 unix 日期/时间戳或 PHP DateTime 对象，您可以使用内置的 PHPExcel_Shared_Date::ExcelToPHP() 或 PHPExcel_Shared_Date::ExcelToPHPObject() 方法。

**规则四：**

所有这些都有完整的记录。但我想我将不得不写一本专门用于日期的特殊手册，文件名中用大红色字母表示日期。

# c - 计算字符串中字符出现次数的最有效方法

> ID：12394142
> 
> 赞同：3
> 
> 时间：2012-09-12T18:20:49.940
> 
> 标签：c, performance, character

我正在编写一个非常简单的函数，它计算某个字符在给定字符串中出现的次数。我有一个工作功能，但想知道是否有更有效或更优选的方法来执行此操作。

这是功能：

```
size_t strchroc(const char *str, const char ch)
{ 
    int c = 0, i = 0;

    while(str[i]) if(str[i++] == ch) c++;
    return c;
} 
```

我个人想不出任何方法来提高这段代码的效率。并且想知道（只是为了学习）是否有人知道使此功能更有效的方法。

（在速度和使用最少资源的意义上是高效的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:49:59.230

首先，除非你的函数**真的**对时间敏感，否则不要试图过度优化。只需使用您提供的那个，因为它很容易验证正确性，并且它不会仅仅为了它而变得聪明。

如果该功能确实需要**快速**，那么有很多方法可以对其进行更多优化。很多，真的很多方法。其中一些要么期望或假设您拥有的字符串的特定内存布局（例如，它们被分配在字边界上，并且分配也总是填充到字边界）。所以你需要小心，因为该算法可能适用于处理器、编译器和内存分配器的某种组合，而在其他方面可能会失败。

只是为了它，我将列出一些加速字符计数器的可能方法：

*   一次读取字符串一个单词（32 位或 64 位整数）。由于 L1 缓存和推测/无序执行，不一定有很大帮助。这需要对最后一个字进行循环结束调整（NUL 终止符后的字节数错误）。仅与字对齐和填充内存分配器一起使用。
*   删除条件，而是计算所有字符的计数（到数组）并返回所需字符的计数。（这将删除条件，如果您事先知道字符串长度，它可以实现出色的循环展开，并删除一个条件分支点。）
*   如果您事先知道字符串的长度（在其他地方计算），您可以使用它来展开循环。或者更好的是，将其编写为 for 循环并应用合适的 #pragma 和编译器选项，以使编译器为您执行循环展开。
*   用汇编程序编写例程。*在*走这条路之前，先启动所有编译器优化并反汇编例程——你可能会发现编译器已经使用了你知道的所有潜在技巧，还有一些你没有使用。
*   如果您的字符串可能非常大（兆字节）——我在这里推测——通过 OpenCL/CUDA 使用显卡可能会提供一些潜力。

等等。

但是，如果您遇到实际问题，我真的*非常建议您坚持使用现有的解决方案。*如果这是一个玩具问题，并且您正在优化它的乐趣，请继续。

循环剃须是学习 CPU 和指令集的一种有趣方式，但对于 99.999999...% 的编程任务来说，不值得付出努力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T18:30:08.697

您可以使用指针来迭代字符串，并且稍微努力使用`*`每个字符仅一次：

```
size_t strchroc(const char *str, const char ch)
{ 
    size_t c = 0;
    char n;
    while ((n=*str++), ((n==ch)? ++c : 0), n)
        ;
    return c;
} 
```

并不是说编译器无法将您的代码优化为完全相同的代码，而只是为了好玩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:46:07.190

在使用函数之前，您应该使用`strchr()`（或者`memchr()`如果您知道长度）。如果有匹配，您可以从第一个匹配字符的位置开始，然后从那里开始。

这应该快得多，除非你的字符串很短，或者很早就匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T18:27:48.710

你可以摆脱变量`i`。

```
size_t strchroc(const char *str, const char ch){ 
    size_t c = 0;
    while(*str != '\0') {
        if(*str == ch) c++;
        str++;
    }
    return c;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T18:41:29.643

```
size_t count_the_string(const char *str, const char ch){
    size_t cnt ;
    for(cnt=0; *str; ) {
        cnt += *str++ == ch;
    }
    return cnt;
} 
```

对于等效的`do { ...} while();`变体，GCC 生成的代码没有条件跳转（当然，循环跳转除外），与@hakattack 的解决方案相当。

```
size_t count_the_string2(const char *str, const char ch){
    size_t cnt=0 ;
    do {
        cnt += *str == ch;
    } while (*str++);
    return cnt;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-31T02:17:48.983

在快速进行低质量基准测试后，我最终得到了任意长度的字符串。

在巨大的字符串（100M+）上，它并没有表现出太大的差异，但在较短的字符串（句子、普通文本文件等）上，改进大约是 25%。

```
unsigned int countc_r(char *buf, char c)
{
    unsigned int k = 0;

    for (;;) {
        if (!buf[0]) break;
        if ( buf[0] == c) ++k;
        if (!buf[1]) break;
        if ( buf[1] == c) ++k;
        if (!buf[2]) break;
        if ( buf[2] == c) ++k;
        if (!buf[3]) break;
        if ( buf[3] == c) ++k;
        buf += 4;
    }

    return k;
} 
```

# c# - c#从xelements创建几个xdocuments

> ID：12394145
> 
> 赞同：0
> 
> 时间：2012-09-12T18:20:58.960
> 
> 标签：c#, linq-to-xml

是否可以轻松地从 xelement 创建新的 xdocument？我有一个大的 xml 文件，我想从中创建几个 xdocuments。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:25:54.973

```
string xml = "<Root><Child1>aaa</Child1><Child2>bbb</Child2></Root>";

XDocument xDoc = XDocument.Parse(xml);

var xDocs = xDoc.Root.Elements()
    .Select(e => new XDocument(e))
    .ToList(); 
```

此示例创建两个包含 Child1 和 Child2 的 xDocument

# html - 无法选择 Z-Index/Position Div 内的文本

> ID：12394146
> 
> 赞同：2
> 
> 时间：2012-09-12T18:21:03.527
> 
> 标签：html, css

我正在尝试创建一个网站，其中我有几个 div 使用`z-index`和放置在背景 div 的前面`position:absolute`。此背景 div 稍后将转换为内容轮播，因此其文本是可选择的至关重要。我当前的代码不允许选择文本和链接，我想知道如何解决这个问题。

[http://jsfiddle.net/6fwf9/2/](http://jsfiddle.net/6fwf9/2/)

HTML：

```
<div id="header" class="box">header</div>
<div id="bg">
    Cannot highlight this text <br>
    <a href="">Cannot click on this link</a>
</div>
<div class="box">content</div>​ 
```

CSS：

```
.box { width: 150px; height:50px; background:aqua; margin:20px; }
#header { margin-bottom: 150px; }
#bg { width:200px; height:200px; padding-top:100px; background:pink; 
     position:absolute; top:0; z-index:-10;}​ 
```

**编辑**- 我想要实现的图像：http: [//imgur.com/r9tYx](http://imgur.com/r9tYx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:29:59.803

确保覆盖的元素 ( `.box`) 不位于文本内容的前面，如果它们是可选择的。这意味着以其他方式定位它们，而不是使用边距。此示例有效，因为框使用绝对定位：http: [//jsfiddle.net/2pPKz/](http://jsfiddle.net/2pPKz/)

或者，如果背景要变成旋转木马，你能不担心它实际上是旋转木马，然后把它移到前面吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T18:44:05.363

我刚看到你的照片，我就是这样做的。

```
<div id="bg">
    <div id="container">
        Cannot highlight this text
        <br>
        <a href="javascript:void();">Cannot click on this link</a>
    </div>

</div>
<div id="header" class="box">header</div>
<div class="box">content</div> 
```

对于 CSS，请注意我在容器周围放置了边框以显示它在哪里以及宽度和高度是多少

```
.box{
    width:150px;
    height:150px;
    z-index:2;
    position:absolute;
    background: cyan;
    top:150px;
    left:20px;
}

#bg{
    background-color:pink; 
    width:200px; 
    height:170px;
    position:absolute;
    top:0px;
}
#header{
    position:absolute;
    width:150px;
    height:50px;
    left:20px;
    top:20px;          
    z-index:2;
    background: cyan;
}
#container{
    width:100%;
    position:relative;
    border:1px solid black;
    margin-top:100px;
} 
```

唯一剩下的就是你玩你的维度。实际上，我把所有东西都放在了容器之外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T18:30:47.267

这是因为 Header 的下边距在文本之上。我建议你改变你在这里做事的方式。你为什么不把元素放在 bg 盒子里呢？

```
<div id="bg">
  <div id="header" class="box">header</div>
  <p>Cannot highlight this text <a href="javascript:void();">Cannot click on this link</a></p>
  <div class="box">content</div>​
</div> 
```

静态位置？即使您想使用绝对定位，您也可以将所有内容都放在 bg div 中并将其与 position:relative 一起使用，因此里面的元素将被绝对尊重地定位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T18:28:20.120

不幸的是，做你想做的事情的唯一方法是将滑块的背景和文本内容分开。

这意味着每张幻灯片都需要由一个绝对位于内容后面的背景 div 和一个绝对位于其他所有内容前面的内容 div 组成。

# android - 如何导航回启动画面？

> ID：12394148
> 
> 赞同：-3
> 
> 时间：2012-09-12T18:21:12.580
> 
> 标签：android, cordova

我有一个打印数组的测试应用程序。我需要的是，在显示打印数组的同一个地方，一个后退按钮或使可用的后退按钮转到索引。下面是按下按钮时打印数组的代码（代码的第二部分）：

```
function outputArray() {
for(var i=0;i<arr.length;i++){
document.write(arr[i]);
}

<button onclick="outputArray();">Print</button> 
```

谁能帮我。

谢谢，吉尔伯托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:40:20.763

> 启动画面是游戏或程序加载时出现的图像。它也可以用来描述网站上的介绍页面。启动画面覆盖整个屏幕或只是靠近屏幕中心的一个矩形。

你的问题是胡说八道！闪屏用于掩盖智能手机的加载时间。！如果你想回去使用：

```
history.back() 
```

# java - 我无法更改我的 selectOneMenu

> ID：12394152
> 
> 赞同：0
> 
> 时间：2012-09-12T18:21:36.393
> 
> 标签：java, jsf, primefaces

我正在尝试加载 selectOneMenu 并给出以下异常：`java.lang.IllegalStateException: Cannot create a session after the response has been committed`. 我有 xhtml：

```
<h:outputText value="Nome:" />
 <p:selectOneMenu value="" id="nome"  >
   <f:selectItem itemValue="#{solicitarPortabilidadeBean.listaDoadora}" var="doadora" itemLabel="#{doadora.nomeOperadora}"/>                
 </p:selectOneMenu> 
```

豆子：

```
@ViewScoped
@ManagedBean
public class SolicitarPortabilidadeBean implements Serializable {

  private static final long serialVersionUID = 1L;  
  private List<Operadora> listaDoadora = null;
  private Operadora operadora;
//getters and setters

  @EJB
  private ConsultasSpnService consultaOp;   

  public List<Operadora> getListaDoadora() {

if (listaDoadora == null) {

 listaDoadora = new ArrayList<Operadora>();
 listaDoadora = consultaOp.listarOp();          

}   

return listaDoadora;
    }

public void setListaDoadora(List<Operadora> listaDoadora) {
    this.listaDoadora = listaDoadora;
}

public Operadora getOperadora() {
    return operadora;
}

public void setOperadora(Operadora operadora) {
    this.operadora = operadora;
}

public List<Eot> getListaEot() {
    return listaEot;
}

public void setListaEot(List<Eot> listaEot) {
    this.listaEot = listaEot;
}

public Eot getEot() {
    return eot;
}

public void setEot(Eot eot) {
    this.eot = eot;
}

public ConsultasSpnService getConsultaOp() {
    return consultaOp;
}

public void setConsultaOp(ConsultasSpnService consultaOp) {
    this.consultaOp = consultaOp;
} 
```

}

歌剧班：

```
public class Operadora {
 private String srvprovid = null;   
 private String nomeOperadora = null;   
 private String indicadorFuncoes = null;
 private String funcaoSuporte = null;
 private String tipoTempReceptora = null;
 private String tipoTempDoadora = null;
 private String horaTrabSuportado = null;
 private Long qtdMaximaTn = null;
 private String tipoServico = null;
 //getters and setters
public String getSrvprovid() {
        return srvprovid;
    }
    public void setSrvprovid(String srvprovid) {
        this.srvprovid = srvprovid;
    }
    public String getNomeOperadora() {
        return nomeOperadora;
    }
    public void setNomeOperadora(String nomeOperadora) {
        this.nomeOperadora = nomeOperadora;
    }
    public String getIndicadorFuncoes() {
        return indicadorFuncoes;
    }
    public void setIndicadorFuncoes(String indicadorFuncoes) {
        this.indicadorFuncoes = indicadorFuncoes;
    }
    public String getFuncaoSuporte() {
        return funcaoSuporte;
    }
    public void setFuncaoSuporte(String funcaoSuporte) {
        this.funcaoSuporte = funcaoSuporte;
    }
    public String getTipoTempReceptora() {
        return tipoTempReceptora;
    }
    public void setTipoTempReceptora(String tipoTempReceptora) {
        this.tipoTempReceptora = tipoTempReceptora;
    }
    public String getTipoTempDoadora() {
        return tipoTempDoadora;
    }
    public void setTipoTempDoadora(String tipoTempDoadora) {
        this.tipoTempDoadora = tipoTempDoadora;
    }
    public String getHoraTrabSuportado() {
        return horaTrabSuportado;
    }
    public void setHoraTrabSuportado(String horaTrabSuportado) {
        this.horaTrabSuportado = horaTrabSuportado;
    }
    public Long getQtdMaximaTn() {
        return qtdMaximaTn;
    }
    public void setQtdMaximaTn(Long qtdMaximaTn) {
        this.qtdMaximaTn = qtdMaximaTn;
    }
    public String getTipoServico() {
        return tipoServico;
    }
    public void setTipoServico(String tipoServico) {
        this.tipoServico = tipoServico;
    } 
```

我知道错误在于调用 xhtml 中的 bean，但我尝试了我所知道的一切。谁能帮我？

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:45:37.553

除了代码中出现严重的逻辑错误，而在渲染过程中应该没有抛出任何异常，当然不是特别提到的异常，

> *IllegalStateException：提交响应后无法创建会话*

您的具体问题很可能是由Mojarra 2.1.8 中修复的 Mojarra 中的[错误引起的。](http://java.net/jira/browse/JAVASERVERFACES-2277)当第一次在相对较大的 JSF 页面中“延迟”引用视图范围或会话范围的 bean 时，此错误可能会出现，此时响应已提交很长时间。

视图和会话范围的 bean 需要存储在 HTTP 会话中。为此，如果尚未创建 HTTP 会话（例如首次请求），则需要先创建。为此，首先需要在 HTTP 响应标头上放置一个 cookie。为此，根本不应该将响应发送给客户端。默认响应缓冲区大小通常为 2KB，因此如果页面大于 2KB，并且在第一块 2KB*之后*第一次引用视图或会话范围的 bean ，那么您将得到这个异常。

至少升级到 Mojarra 2.1.8（它[目前](http://javaserverfaces.java.net/)已经在 2.1.13），这个问题应该会消失。

### 也可以看看：

*   [添加 <h:form> 会导致 java.lang.IllegalStateException：在提交响应后无法创建会话](https://stackoverflow.com/questions/8072311/illegalstateexception-cannot-create-a-session-after-the-response-has-been-commi)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:27:27.993

首先，这是您的代码的一个语法问题

```
<h:outputText value="Nome:" />
 <p:selectOneMenu value="" id="nome"  >
   <f:selectItem itemValue="#{solicitarPortabilidadeBean.listaDoadora}" var="doadora" itemLabel="#{doadora.nomeOperadora}"/>                
 </p:selectOneMenu> 
```

您没有将 value 属性绑定到支持 bean。此外，当您已经提交响应时，IllegalStateException 就会出现，这意味着写了一些东西，提交了它，然后将控制权传递给另一个 servlet 或其他东西。在查看正确的 ManagedBean 代码之前，很难判断您在哪里弄错了。您的列表是如何填充的。请发布 ManagedBean 代码并尝试将 value 属性映射到某个 ManagedBean 属性。HTH，本

# c++ - 我怎样才能找到物体的中心？

> ID：12394153
> 
> 赞同：6
> 
> 时间：2012-09-12T18:21:35.980
> 
> 标签：c++, image-processing, opencv

二值化后我有黑白图像。之后，我得到一个形状不规则的物体。此图片的链接如下。我怎样才能把这个物体刻成圆圈？或者我怎样才能找到这个对象的“中心”？

![http://s6.ifotos.pl/img/opticdisk_xhnrnwe.png](../Images/fce1b744de46893dc6853905639f6c67.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T06:05:54.383

您可以使用一个简单的公式找到像素**的重心**，该公式是 x 坐标的总和除以点数，以及 y 坐标的总和除以点数（我的意思是白点）。

然后你可以画一个以重心为中心的圆，点之间最大距离的一半。

[在这里](http://www.roborealm.com/help/Center%20of%20Gravity.php)你有一个图形解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T18:58:45.767

这听起来像是白​​色像素集上的[最小圆圈问题。](http://en.wikipedia.org/wiki/Smallest_circle_problem)它可以在像素数的线性时间内找到。这是您将得到的最好的结果，您的输入只是一个二进制像素数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T18:44:09.537

好吧，您可以从上向下扫描最顶部的白色像素，然后从下向上扫描最底部的白色像素，左右相同。这给了你一个矩形。找到矩形的中心很容易（例如 left + ( right - left ) / 2），这就是你的圆心。然后找到到角落的距离（任何都可以），这就是你的圆半径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T18:35:19.247

我认为，可以很容易地找到对象的中心作为 x 和 y 坐标的算术平均值。我想用一个圆圈代替它，我会说直径是所有点到中心的平均距离的两倍。

# asp-classic - 创建命中计数器

> ID：12394154
> 
> 赞同：0
> 
> 时间：2012-09-12T16:13:08.613
> 
> 标签：asp-classic, vbscript, web

我正在尝试在 HTML 页面上的 VBScript 中创建一个命中计数器，以满足特定的客户需求。我不能使用任何免费提供的命中计数器。

我的问题是我的代码只能在我的笔记本（本地 C:\ 驱动器）上找到文本文件，而不是在网站上，即使该文件确实存在。我的另一个问题是，当页面代码到达该`server.creatobject`行时，我收到错误消息`Microsoft VBScript runtime error: Object required: 'server'`。

我主要用 VB 编写，但客户想要一个特定的 HTML 页面而不是 ASP/ASPX。有人能帮助我吗？我已经尝试了一段时间，无法对我的上述问题得到一个体面的答案。

下面是代码。

```
<SCRIPT LANGUAGE="VBScript" RUNAT="Server">

Dim fso
dim tso
dim FilObject
dim VisitorCount
dim strOutputName
dim objOutputfile
strfilename ="counter.txt"

set fso=server.createobject("scripting.filesystemobject")

set filobject=fso.getfile(strfilename)
set tso=filobject.openastextstream

visitorcount=clng(tso.readall)
visitorcount=visitorcount + 1
stroutputname=strfilename
set objoutputfile=fso.createtextfile(stroutputname,true)

objoutputfile.writeline visitorcount

document.write(visitorcount)
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:03:20.447

> ...客户端想要一个特定的 HTML 页面而不是 ASP

但是您已经编写了一个 ASP 脚本（`runat="server"`使用 VBScript 脚本语言）。该`Server`对象仅在 ASP 中可用。您的文件将需要是一个`.asp`文件（或以某种方式由服务器作为 ASP 处理），否则您的脚本将作为客户端 VBScript 运行，并且该`Server`对象将不可用，这是您似乎遇到的错误。

# android - 将 Linux 驱动程序转换为可加载内核模块

> ID：12394156
> 
> 赞同：0
> 
> 时间：2012-09-12T18:21:54.437
> 
> 标签：android, linux-kernel, linux-device-driver

我有一个适用于 Linux 的 USB 调制解调器驱动程序。我可以将其转换为可加载的内核模块吗？我正在考虑将其加载到 android 内核中并导入 AMD 机器。请帮忙。感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T10:57:36.120

答案很简单，如果你想在你的特定机器架构中运行它，你需要交叉编译你的模块。我的意思是如果你想在 ARM 上加载，那么你需要使用 **make ARCH=arm CROSS_COMPILE="toolchain path"**进行交叉编译。

同样，您可以对其余机器执行此操作。

**注意：**如果您在需要加载的机器上进行编译，则无需执行此操作。只需使用 insmod 编译和加载。

# java-me - 如何实现当 SMS 发送到端口 50000 时调用的 MIDlet ......代码不起作用

> ID：12394158
> 
> 赞同：4
> 
> 时间：2012-09-12T18:22:03.323
> 
> 标签：java-me, sms, midp

如何实现当 SMS 发送到端口 50000 时调用的 MIDlet？

代码不起作用。手机收不到短信，通过模拟器（JAVA Me SDK）发送短信。

接收短信需要做哪些设置？

我的代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

import java.io.IOException;
import javax.microedition.io.PushRegistry;
import javax.microedition.lcdui.*;
import javax.microedition.midlet.MIDlet;

/**
 * @author bonni
 */
public class Midletsms extends MIDlet implements CommandListener{

    protected Display display;                                  
     //boolean started=false;
      Form form = new Form("Welcome");
      Command mCommandQuit;

    public void startApp() {

        String url = "sms://:50000";
        try {

            PushRegistry.registerConnection(url,this.getClass().getName(), "*");
           // PushRegistry.registerConnection(url,"Midletsms.class", "*");
        } catch (IOException ex) {

        } catch (ClassNotFoundException ex) {

        }
         form.append("This midlet gets invoked when message is sent to port:50000");

             display = Display.getDisplay(this);
             display.setCurrent(form);

                   mCommandQuit = new Command("Quit", Command.EXIT, 0);
             form.addCommand(mCommandQuit);
             form.setCommandListener(this);

    }

    public void pauseApp() {
    }

    public void destroyApp(boolean unconditional) {
    }
     public void commandAction(Command c, Displayable d) {
       // throw new UnsupportedOperationException("Not supported yet.");
         String label = c.getLabel();
        if(label.equals("Quit"))
                {
                        destroyApp(false);
            notifyDestroyed();
                }
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T09:19:36.373

不确定我是否完全理解这个问题。但是您需要阅读有关[PushRegistry](http://java.sun.com/javame/reference/apis/jsr118/javax/microedition/io/PushRegistry.html)的信息。

所以推送注册有静态和动态两种。

您给出的代码示例使用*动态*注册。 **您将需要手动调用此 MIDlet 至少一次，以便进行推送注册**。（旁白：在您的示例中，您在`startApp`方法中执行此操作，这是一个非常糟糕的主意！推送注册是一个潜在的阻塞操作，因此不应在诸如 的生命周期方法中完成`startApp`。您应该在新线程中执行此操作）。

另一种方法是*静态*注册，您将推送信息包含在`jad`. 推送端口将在安装 MIDlet 时注册，无需运行它。

最后你说

> 短信通过模拟器发送

这是什么意思？为了启动应用程序，您需要从另一个 MIDlet 在相关端口号上发送 SMS（如果您愿意，这可以在同一部手机上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T02:11:29.747

[我在Jimmy 的博客](http://jimmod.com/blog/2011/02/jimmys-blog-send-receiving-on-specific-port-with-j2me-application/)上找到了这段代码，它运行良好。你可以自己试试

**SMSSender.java**

```
public class SMSSender extends MIDlet implements CommandListener {

    private Form formSender = new Form("SMS Sender");
    private TextField tfDestination = new TextField("Destination", "", 20, TextField.PHONENUMBER);
    private TextField tfPort = new TextField("Port", "50000", 6, TextField.NUMERIC);
    private TextField tfMessage = new TextField("Message", "message", 150, TextField.ANY);
    private Command cmdSend = new Command("Send", Command.OK, 1);
    private Command cmdExit = new Command("Exit", Command.EXIT, 1);
    private Display display;

    public SMSSender() {
        formSender.append(tfDestination);
        formSender.append(tfPort);
        formSender.append(tfMessage);
        formSender.addCommand(cmdSend);
        formSender.addCommand(cmdExit);
        formSender.setCommandListener(this);

        display = Display.getDisplay(this);
    }

    protected void destroyApp(boolean arg0) throws MIDletStateChangeException {
    }

    protected void pauseApp() {

    }

    protected void startApp() throws MIDletStateChangeException {
        display.setCurrent(formSender);
    }

    public void commandAction(Command c, Displayable d) {
        if (c==cmdSend) {
            SendMessage.execute(tfDestination.getString(), tfPort.getString(), tfMessage.getString());
        } else if (c==cmdExit) {
            notifyDestroyed();
        }
    }

}

class SendMessage {

    public static void execute(final String destination, final String port, final String message) {

        Thread thread = new Thread(new Runnable() {

            public void run() {
                MessageConnection msgConnection;
                try {
                    msgConnection = (MessageConnection)Connector.open("sms://"+destination+":" + port);
                    TextMessage textMessage = (TextMessage)msgConnection.newMessage(
                            MessageConnection.TEXT_MESSAGE);
                    textMessage.setPayloadText(message);
                    msgConnection.send(textMessage);
                    msgConnection.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        });

        thread.start();
    }

} 
```

**SMSReceiver.java**

```
public class SMSReceiver extends MIDlet implements CommandListener, MessageListener {

    private Form formReceiver = new Form("SMS Receiver");
    private TextField tfPort = new TextField("Port", "50000", 6, TextField.NUMERIC);
    private Command cmdListen = new Command("Listen", Command.OK, 1);
    private Command cmdExit = new Command("Exit", Command.EXIT, 1);
    private Display display;

    public SMSReceiver() {
        formReceiver.append(tfPort);
        formReceiver.addCommand(cmdListen);
        formReceiver.addCommand(cmdExit);
        formReceiver.setCommandListener(this);

        display = Display.getDisplay(this);
    }

    protected void destroyApp(boolean unconditional)
            throws MIDletStateChangeException {

    }

    protected void pauseApp() {

    }

    protected void startApp() throws MIDletStateChangeException {
        display.setCurrent(formReceiver);
    }

    public void commandAction(Command c, Displayable d) {
        if (c==cmdListen) {
            ListenSMS sms = new ListenSMS(tfPort.getString(), this);
            sms.start();
            formReceiver.removeCommand(cmdListen);
        } else if (c==cmdExit) {
            notifyDestroyed();
        }
    }

    public void notifyIncomingMessage(MessageConnection conn) {
        Message message;
        try {
            message = conn.receive();
            if (message instanceof TextMessage) {
                TextMessage tMessage = (TextMessage)message;
                formReceiver.append("Message received : "+tMessage.getPayloadText()+"\n");
            } else {
                formReceiver.append("Unknown Message received\n");
            }
        } catch (InterruptedIOException e) {
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

}

class ListenSMS extends Thread {
    private MessageConnection msgConnection;
    private MessageListener listener;
    private String port;

    public ListenSMS(String port, MessageListener listener) {
        this.port = port;
        this.listener = listener;
    }

    public void run() {
        try {
            msgConnection = (MessageConnection)Connector.open("sms://:" + port);
            msgConnection.setMessageListener(listener);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

} 
```

# protocols - FIX 和 FAST 协议之间的区别？

> ID：12394159
> 
> 赞同：14
> 
> 时间：2012-09-12T18:22:10.070
> 
> 标签：protocols, finance, fix-protocol, trading

谁能解释一下 FIX 和 FAST 之间的区别？什么时候应该使用 FIX，什么时候应该使用 FAST？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T09:22:18.840

从股票交易的角度来看，FAST 更广泛地用于市场数据传播，其中消息率要高得多。FIX 是公司之间互操作性的首选协议，通常也是内部系​​统，尽管不同的实现在使用的特定消息和属性上可能有很大差异。

经纪商和交易场所通常会通过某种形式的 FIX 提供订单输入，并为对性能最敏感的客户或专业功能提供互补的原生二进制协议。FIX 接口通常只是原生接口的包装器，具有更有限的消息类型和参数集。

伦敦证券交易所就是一个很好的例子，它提供 FIX 5.0 用于订单输入，以及他们自己的低延迟本机协议。对于市场数据，他们提供 FAST 和 ITCH 的组合，尽管即使使用 FAST，订阅者也无法获得完整的市场数据馈送，并且需要 ITCH，如此[处所述](http://www.londonstockexchange.com/products-and-services/millennium-exchange/millennium-exchange-migration/mit301-v91.pdf)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-12T19:45:34.573

[FAST(FIX Adapted for STreaming)](http://en.wikipedia.org/wiki/FAST_protocol#cite_note-inside1-0) is [FIX](http://fixprotocol.org/what-is-fix.shtml) only, but customised to send across data more quickly, because of the huge increase in volume of data transferred in today's markets, as compared to normal FIX implementation. [This should clarify a bit more.](http://fixprotocol.org/documents/2801/FIX%20Adapted%20for%20STreaming%20-%20FAST%20Protocol.pdf)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-15T23:02:52.133

FIX 是基于文本的协议，其中所有信息以 tag=value 格式编码并使用特殊字符分隔：

'....35=X|55=欧元/美元...'

这意味着即使是十进制数据也将作为文本发送，例如 1000000（如果代码为二进制，则为您提供 7 个字节而不是 4 个字节）。

FAST 是解决此开销的解决方案。它基于模板的概念，其中描述了字节顺序、大小和含义。

# java - 组合 InputVerifiers

> ID：12394162
> 
> 赞同：2
> 
> 时间：2012-09-12T18:22:21.463
> 
> 标签：java, swing, input, validation

Swing API 是否有结合 InputVerifiers 的类？例如，我当前的项目中有三个 InputVerifier：

1.  NotEmptyInputVerifier - 验证文本字段不为空
2.  PositiveIntegerInputVerifier - 验证文本字段是否包含正整数
3.  YearInputVerifier - 验证文本字段是否包含四位数年份

NotEmptyInputVerifier 需要用于所有输入，无论是字符串还是数字。PositiveIntegerInput 需要检查文本字段是否为空*，并*另外检查输入字符串是否仅包含数字。YearInputVerifier 还需要检查输入是否正好是四位数字，且前导数字非零。

现在每一个都建立在另一个之上。我可以通过组合或继承轻松实现这一点。似乎这种模式在 Swing 应用程序中经常出现，我认为一个小的包装类，比如 AndInputVerifier，将非常有用，可以属于 Swing API。不过我还没有找到，所以我认为它不存在。;-(

如果不在 Swing API 中，有谁知道这是否存在于第三方包中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T18:54:22.853

[javadoc](http://docs.oracle.com/javase/7/docs/api/index.html?javax/swing/InputVerifier.html)没有为 InputVerifier 定义任何子类，因此它在 JVM 中不存在。

现在，实现你想要的并不复杂：

```
import javax.swing.InputVerifier;
import javax.swing.JComponent;

public class CombinedInputVerifier extends InputVerifier {

    private InputVerifier[] verifiers;

    public CombinedInputVerifier(InputVerifier... verifiers) {
        this.verifiers = verifiers;
    }

    @Override
    public boolean verify(JComponent input) {
        for (InputVerifier verifier : verifiers) {
            if (!verifier.verify(input)) {
                return false;
            }
        }
        return true;
    }

} 
```

# c# - Log4net - 禁止将“异常”附加到自定义“PatternLayout”

> ID：12394165
> 
> 赞同：11
> 
> 时间：2012-09-12T18:22:31.680
> 
> 标签：c#, web-config, log4net

使用自定义“PatternLayout”时，log4net 将“异常”信息（如果存在）附加到每个日志条目。我正在尝试控制消息和堆栈跟踪信息的输出，并希望“抑制”这些信息。我四处寻找，但找不到办法。有任何想法吗？

示例 web.config 条目（用于 RollingFileAppender）：

```
<layout type="Example.Class.CustomLog4netLayouts,Example">    
    <conversionPattern value="%date [%thread] [RID:%property{CLIENT_REQUESTID}] 
     %-5level %logger [%property{NDC}] - %cleanmessage - %cleanstack%newline" />
</layout> 
```

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-13T07:08:34.067

像这样配置布局：

```
<layout type="Example.Class.CustomLog4netLayouts,Example">
    <IgnoresException value="False" />
    ... 
```

设置`IgnoresException`为 false 告诉 appender 布局将处理异常。因此，您可以选择不打印堆栈跟踪。

# git - 如何以非交互方式运行 git rebase --interactive？

> ID：12394166
> 
> 赞同：62
> 
> 时间：2012-09-12T18:22:32.103
> 
> 标签：git, scripting, git-rebase, non-interactive

是否可以进行以下操作？

1.  仅将`git rebase --interactive`标准样板输出到文件，而不是输出到文件并在编辑器中打开它。
2.  让用户编辑文件。
3.  让用户以编辑后的文件名重新运行`git rebase`。
4.  继续通常的变基过程。

用例：当然是脚本化的变基。例如，查看[如何以非交互方式在 Git 中重新排序提交](https://stackoverflow.com/questions/4981061/how-to-re-order-commits-in-git-non-interactively)。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-12T19:31:40.790

经过一番思考和研究，答案被证明是微不足道的：`git rebase -i`从著名的 EDITOR/VISUAL 环境变量中获取编辑器名称，因此覆盖它以指向非交互式脚本就可以了。

但是，EDITOR/VISUAL 对提交列表、改写时的提交消息和其他任何内容都无动于衷。因此，由于[http://git.kernel.org/?p=git](http://git.kernel.org/?p=git/git.git;a=commit;h=821881d88d3012a64a52ece9a8c2571ca00c35cd) ​​/git.git;a=commit;h=821881d88d3012a64a52ece9a8c2571ca00c35cd ，有一个特殊的环境变量 GIT_SEQUENCE_EDITOR 仅适用于提交列表。

因此，重新排序或展平提交的方法是：

运行：`GIT_SEQUENCE_EDITOR=<script> git rebase -i <params>`。您`<script>`应该接受一个参数：包含标准变基提交列表的文件的路径。它应该就地重写它并退出。之后发生通常的变基处理。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-13T19:36:48.083

添加到@pfalcon 的答案，您可以使用 sed 作为您的 GIT_SEQUENCE_EDITOR。例如，我想编辑每个提交，所以我这样做了：

```
GIT_SEQUENCE_EDITOR="sed -i -re 's/^pick /e /'" git rebase -i 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-10-09T08:45:52.320

该变量`GIT_SEQUENCE_EDITOR`最初用于更改编辑器。可以将脚本传递给该变量以`git rebase -i`以非交互方式使用。所以可以使用：

```
GIT_SEQUENCE_EDITOR="sed -i -re 's/^pick 134567/e 1234567/'" git rebase -i 1234567^ 
```

此命令将在 .`sed`提供的文件上运行`git rebase -i`。它将将该行更改`pick 134567`为`e 1234567`（因此，编辑提交 1234567）。您可以`e`使用`r`(rework)、`f`(fixup)、`s`(squash) 或`d`(drop) 进行更改（旧版本不支持后者`git`）。

基于此，我编写了一个脚本来自动化这个任务：

```
#!/bin/bash

ACTION=$1
COMMIT=$(git rev-parse --short $2)
[[ "$COMMIT" ]] || exit 1
CORRECT=
for A in p pick r reword e edit s squash f fixup d drop t split; do
     [[ $ACTION == $A ]] && CORRECT=1
done 
[[ "$CORRECT" ]] || exit 1
git merge-base --is-ancestor $COMMIT HEAD || exit 1
if [[ $ACTION == "drop" || $ACTION == "d" ]]; then
    GIT_SEQUENCE_EDITOR="sed -i -e '/^pick $COMMIT/d'" git rebase -i $COMMIT^^
elif [[ $ACTION == "split" || $ACTION == "t" ]]; then
    GIT_SEQUENCE_EDITOR="sed -i -e 's/^pick $COMMIT/edit $COMMIT/'" git rebase -i $COMMIT^^ || exit 1
    git reset --soft HEAD^
    echo "Hints:"
    echo "  Select files to be commited using 'git reset', 'git add' or 'git add -p'"
    echo "  Commit using 'git commit -c $COMMIT'"
    echo "  Finish with 'git rebase --continue'"
else
    GIT_SEQUENCE_EDITOR="sed -i -e 's/^pick $COMMIT/$1 $COMMIT/'" git rebase -i $COMMIT^^
fi 
```

第一个参数应该是一个动作。该脚本使用与 git-rebase 相同的操作名称。它还添加了“拆分”操作（并允许`drop`与旧版本的 git 一起使用）。

它还检查您要求的提交是否是 HEAD 的祖先。这是一个常见（而且非常烦人）的错误`rebase -i`。

第二个参数是要编辑/删除/拆分/改写的提交。

然后你为你的 .gitconfig 添加一个别名：

```
[alias]
  autorebase = ! path_to_your_script 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-05-22T15:42:56.870

扩展 pfalcon 的答案：

> 运行`GIT_SEQUENCE_EDITOR=<script> git rebase -i <params>`。`<script>`应该接受单个参数 - 包含标准变基提交列表的文件的路径。脚本应该就地重写它并退出。之后发生通常的变基处理。

如果您有一个包含所需内容的环境变量：

```
GIT_SEQUENCE_EDITOR='echo "$REBASE_DATA" >' git rebase -i [<additional params>] 
```

Catting 文件也可以：

```
GIT_SEQUENCE_EDITOR='cat rebase_data_file >' git rebase -i [<additional params>] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-05-14T07:36:10.360

您可以`touch`用作编辑器，它会触摸文件，因此它会显示为已修改。例如

```
GIT_SEQUENCE_EDITOR=touch git rebase -i [commit] 
```

给它取别名，`baseline`作为我想要重新定位的标签给出

```
git config alias.baseline '!GIT_SEQUENCE_EDITOR=touch git rebase -i baseline' 
```

该别名在 Windows 下工作，因为它正在执行的 shell`bash`不是`cmd`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-12T19:33:02.633

交互模式会调出要使用的集合编辑器。
可以通过以下方式检索正在使用的编辑器：

```
git config --get core.editor 
```

因此，如果您设置了一个*非交互式*编辑器——即在标准输入上接受命令的编辑器，您可以`--interactive`以*非交互式*方式使用 :)
我知道肯定`vim`接受命令，*标准编辑器* `ed`也是如此，当然。

所以，拿着交互式编辑器（如果需要）

```
$ ied="$(git config --get core.editor)" 
```

设置非交互式编辑器

```
$ git config --unset-all core.editor
$ git config --add core.editor ed 
```

并使用它..

```
$ printf '%s\n' "some-ed-cmd" "another-ed-cmd" "wq" | git rebase -i HEAD~5 
```

并恢复编辑器（如果需要）

```
$ git config --unset-all core.editor
$ git config --add core.editor "$ied" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-08-08T09:46:46.543

我找到了解决方案。您可以使用：

```
$ GIT_SEQUENCE_EDITOR=true git rebase -i --autosquash $COMMIT_HASH~1 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-10T09:36:19.490

要完全按照原始问题的要求进行操作，请`sed -i '1s/^/b\n/'`用作您的编辑器

```
git -c sequence.editor="sed -i '1s/^/b\n/'" rebase --interactive 
```

### 解释

*   `git -c`指定以指定的设置运行以下 git 命令
*   `sequence.editor`确定将编辑 redbase-todo 文件的“编辑器”的设置
*   `sed -i`就地运行 sed 命令
    *   `1s`在第一行
    *   `^`匹配开头
    *   `b\n`插入`b`和换行符`\n`。`b`或者`break`是停止交互式变基的变基命令。
*   `rebase --interactive`运行变基命令

这会立即停止交互式变基。现在您可以编辑`.git/rebase-merge/git-rebase-todo`并运行`git rebase --continue`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-04T02:50:09.460

正如其他人所提到的，您需要提供一个自定义`GIT_SEQUENCE_EDITOR`值来修改交互式变基文件。如果您只想对单个提交执行操作，可以按如下方式执行：

```
# Runs "edit" on HEAD~3
GIT_SEQUENCE_EDITOR="sed -i -ze 's/^pick/edit/'" git rebase -i HEAD~3 
```

或者，这是一个概括这一点的函数：

```
# Usage: git-rebase-custom edit HEAD~3
git-rebase-custom() {
    local action=$1
    shift

    GIT_SEQUENCE_EDITOR="sed -i -ze 's/^pick/$action/'" git rebase -i "$@"
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-02-23T08:20:14.203

根据[Jezz 的回答](https://stackoverflow.com/a/19267103/6261350)，我制作了一个与 shell 无关的脚本 ( [GitReb](https://github.com/trosh/gitreb) )，它适用于多参数修订、 `:/<text>`语法、根提交，并且还进行了一些健全性检查。

我还使它更简单，并删除了IMO 超出此脚本范围的`t`/`split`操作和`delete`->转换。`drop`

# mercurial - 使用 TortoiseHg 丢失 .hg 文件夹的内容

> ID：12394168
> 
> 赞同：0
> 
> 时间：2012-09-12T18:22:34.140
> 
> 标签：mercurial, tortoisehg, bitbucket

所以我一直工作得很好，提交，推送到 BitBucket。我进去添加了几个扩展，重新启动了 THG，现在我的 repo 显示就好像它是全新的，就像我从未做过任何事情一样。我查看了 .hg 文件夹，里面什么都没有！

因此，我以另一个名称从 BitBucket 克隆了 repo，将 .hg 文件夹的内容移动到旧 repo 并更改了 hgrc 文件夹中的名称。今天开始使用它并在状态栏中出现错误。我重新启动了 THG，它又回到了我什么都没做的状态。

为什么会这样？真令人沮丧。我是 Mercurial 的新手，但我认为我没有做任何事情来保证这一点？

# image - 在 xhtml 中为 ePub 滑动图像手势

> ID：12394175
> 
> 赞同：1
> 
> 时间：2012-09-12T18:22:56.033
> 
> 标签：image, xhtml, swipe, epub

我正在使用 calibre 和 dreamW 编写电子书。它包含很多图片，所以我想做的是点击一张图片，让它在你面前弹出（让它变大），然后可以滑动到下一张图片。我设法在 html 中实现它，但不是在 xthml 中......有什么想法，想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T20:41:31.860

您在浏览器中看到的滑动手势是由 JavaScript 实现的，而不是由 HTML 实现的。在当前的一些 EPUB 实现中，可以使用最少的 JavaScript 支持（例如 iBooks），但这会阻止您的书在其他 EBook 阅读器中可用。EPUB3 对 JavaScript 有更好的支持，应该使书籍更具交互性。

另一种方法是将图片链接到附录部分，您在其中每页存储一张图片，正常翻页将模拟滑动手势。每个页面都应该有一个链接或一个按钮，以将读者带回到他/她被重定向的页面。

# javascript - 构建现有 JS 代码的框架

> ID：12394178
> 
> 赞同：5
> 
> 时间：2012-09-12T18:23:10.747
> 
> 标签：javascript, oop, frameworks, refactoring

我有一些我为开源应用程序编写的程序 javascript 代码，我想将它重构为 OOP，由于我对 javascript 框架的经验很少，我很难找到一个适合我需要的，尽管我没有还没有尝试过任何东西，我刚刚阅读了有关 AngularJS、Backbone.js 和 Knockout 的信息。

我想构造代码，因为目前，到处都是一团糟的全局变量和函数。

我不得不提到，所有的业务逻辑都是在服务器级别处理的，所以客户端代码只使用它接收到的数据或来自服务器的请求来处理 UI。

代码可以在这里找到： [https ://github.com/paullik/webchat/blob/asp.net/webchat/Static/Js/chat.js](https://github.com/paullik/webchat/blob/asp.net/webchat/Static/Js/chat.js)

你有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T18:40:35.040

> 面向对象的 JavaScript 不一定能解决所有问题。

我的建议是谨慎选择你在这个主题上的选择。

在实践中，OO-JS 可以为您的代码增加更多复杂性，以便尝试更像传统的面向对象语言。您可能知道，JS 是独一无二的。

重要的是要知道有一些设计模式可以构建您的代码并保持实现的轻量和灵活。

> 我看到构建高级 JS 实现的是设计模式，而不是 OO。套用 Axel Rauchmeyer 的话说——“面向对象的方法不适合基本的 JavaScript 语法，它是一种扭曲和扭曲的实现，没有它，JS 的表现力要强得多。”

这种分析的根源归结为JS没有类。本质上，由于一切都是对象，因此您已经拥有面向对象的变量和函数。因此，该问题与编译语言 (C/Java) 中的问题略有不同。

> JavaScript 有哪些设计模式？

一个很好的检查资源是 Addy O' Somani 和 Essential Design Patterns。 [他写了这本关于 JavaScript 中的设计模式的书。](https://www.google.com/#hl=en&output=search&sclient=psy-ab&q=addy+osmani+javascript+patterns&oq=addy+osmani+javascript+patterns&gs_l=hp.3..0j0i8i30.11262.24370.1.24535.39.33.4.0.0.0.656.4170.14j16j2j5-1.33.0.les;..0.0...1c.1.3nX8vl8l504&psj=1&bav=on.2,or.r_gc.r_pw.r_qf.&fp=783e549a5df6db07&biw=1134&bih=907)

但还有更多……更多。

A. require.js - 有一种以令人印象深刻的方式加载 JS 代码模块的方法。这些通常被称为模块加载器，并且被广泛认为是加载 js 文件的未来，因为它们优化了运行时的性能。yepnope 和其他人存在。如果您要加载多个 js 文件，请记住这一点。（根据要求移至顶部）。

B. MVC - There are dozens of Model View Controller frameworks to help you structure code. It is a Pattern, but may be unreasonable for your purposes. You mentioned backbone, knockout and angular... Yes. These can do the trick for you, but I would be concerned that they might be 1) high learning-curve, and 2) overkill for your environment.

C. Namespace or Module Pattern. **Are probably the most important for your needs.** To solve global variables just wrap them in a namespace and reference that. These are very good patterns that give rise to module loaders.

D. Closure - You mentioned OO JS. On piece of this that is useful is the notion of closures to provide yourself with... private members. At first this is a cryptic idea, but after you recognize the pattern, it is trivial practice.

E. Custom Events - It becomes very important to not use hard references between objects. Example: `AnotherObject.member;` This is because it will tightly couple the two objects together and make both of them inflexible to change. To solve this, trigger and listen to events. In traditional Design Patterns this is the Observer. In JS it is called PubSub.

F. The Callback - The callback pattern is what enabled AJAX and it is revolutionizing development in terms of Window 8, Firefox OS, and Node.js - because of something called non-blocking-io. Very important.

Do not be afraid. This is the direction to go for long-term and advanced JavaScript implementations.

Once you recognize the patterns, it is down hill from there.

Hope this helps.

# python - scrapy：当蜘蛛退出时调用一个函数

> ID：12394184
> 
> 赞同：51
> 
> 时间：2012-09-12T18:23:49.943
> 
> 标签：python, scrapy

有没有办法在 Spider 类中的方法终止之前触发它？

我可以自己终止蜘蛛，如下所示：

```
class MySpider(CrawlSpider):
    #Config stuff goes here...

    def quit(self):
        #Do some stuff...
        raise CloseSpider('MySpider is quitting now.')

    def my_parser(self, response):
        if termination_condition:
            self.quit()

        #Parsing stuff goes here... 
```

但是我找不到任何关于如何确定蜘蛛何时要自然退出的信息。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-09-12T18:40:11.720

看起来您可以通过`dispatcher`.

我会尝试类似的东西：

```
from scrapy import signals
from scrapy.xlib.pydispatch import dispatcher

class MySpider(CrawlSpider):
    def __init__(self):
        dispatcher.connect(self.spider_closed, signals.spider_closed)

    def spider_closed(self, spider):
      # second param is instance of spder about to be closed. 
```

* * *

在较新版本的 scrapy`scrapy.xlib.pydispatch`中已弃用。相反，您可以使用 from `pydispatch import dispatcher`。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2015-10-23T22:29:51.030

只是为了更新，你可以[`closed`](http://doc.scrapy.org/en/latest/topics/spiders.html?highlight=closed#scrapy.spiders.Spider.closed)像这样调用函数：

```
class MySpider(CrawlSpider):
    def closed(self, reason):
        do-something() 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-10-12T09:45:11.123

对于 Scrapy 版本**1.0.0+**（它也可能适用于旧版本）。

```
from scrapy import signals

class MySpider(CrawlSpider):
    name = 'myspider'

    @classmethod
    def from_crawler(cls, crawler, *args, **kwargs):
        spider = super(MySpider, cls).from_crawler(crawler, *args, **kwargs)
        crawler.signals.connect(spider.spider_opened, signals.spider_opened)
        crawler.signals.connect(spider.spider_closed, signals.spider_closed)
        return spider

    def spider_opened(self, spider):
        print('Opening {} spider'.format(spider.name))

    def spider_closed(self, spider):
        print('Closing {} spider'.format(spider.name)) 
```

一种很好的用法是将[tqdm](https://github.com/tqdm/tqdm)进度条添加到 scrapy spider。

```
# -*- coding: utf-8 -*-
from scrapy import signals
from scrapy.linkextractors import LinkExtractor
from scrapy.spiders import CrawlSpider, Rule
from tqdm import tqdm

class MySpider(CrawlSpider):
    name = 'myspider'
    allowed_domains = ['somedomain.comm']
    start_urls = ['http://www.somedomain.comm/ccid.php']

    rules = (
        Rule(LinkExtractor(allow=r'^http://www.somedomain.comm/ccds.php\?id=.*'),
             callback='parse_item',
             ),
        Rule(LinkExtractor(allow=r'^http://www.somedomain.comm/ccid.php$',
                           restrict_xpaths='//table/tr[contains(., "SMTH")]'), follow=True),
    )

    def parse_item(self, response):
        self.pbar.update()  # update progress bar by 1
        item = MyItem()
        # parse response
        return item

    @classmethod
    def from_crawler(cls, crawler, *args, **kwargs):
        spider = super(MySpider, cls).from_crawler(crawler, *args, **kwargs)
        crawler.signals.connect(spider.spider_opened, signals.spider_opened)
        crawler.signals.connect(spider.spider_closed, signals.spider_closed)
        return spider

    def spider_opened(self, spider):
        self.pbar = tqdm()  # initialize progress bar
        self.pbar.clear()
        self.pbar.write('Opening {} spider'.format(spider.name))

    def spider_closed(self, spider):
        self.pbar.clear()
        self.pbar.write('Closing {} spider'.format(spider.name))
        self.pbar.close()  # close progress bar 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-06-13T07:29:12.780

对于最新版本（v1.7），只需`closed(reason)`在您的蜘蛛类中定义方法。

> `closed(reason)`：
> 
> 当蜘蛛关闭时调用。此方法为 spider_closed 信号提供了到 signals.connect() 的快捷方式。

[Scrapy 文档：scrapy.spiders.Spider.closed](https://docs.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider.closed)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-09-19T22:17:43.437

对我来说，接受的不起作用/至少对于scrapy 0.19来说已经过时了。我让它与以下内容一起工作：

```
from scrapy.signalmanager import SignalManager
from scrapy.xlib.pydispatch import dispatcher

class MySpider(CrawlSpider):
    def __init__(self, *args, **kwargs):
        super(MySpider, self).__init__(*args, **kwargs)
        SignalManager(dispatcher.Any).connect(
            self.closed_handler, signal=signals.spider_closed)

    def closed_handler(self, spider):
        # do stuff here 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-05T16:04:36.360

如果你有很多蜘蛛并且想在它们关闭之前做一些事情，也许在你的项目中添加 statscollector 会很方便。

在设置中：

```
STATS_CLASS = 'scraper.stats.MyStatsCollector' 
```

和收藏家：

```
from scrapy.statscollectors import StatsCollector

class MyStatsCollector(StatsCollector):
    def _persist_stats(self, stats, spider):
        do something here 
```

# visual-studio - 在VS2012中知道我花了99％的时间在方法上怎么知道为什么？

> ID：12394187
> 
> 赞同：1
> 
> 时间：2012-09-12T18:24:04.780
> 
> 标签：visual-studio, profiling, visual-studio-2012

当我的应用程序工作时，我发现它对任何命令都没有响应，并且 CPU 被 100% 使用。我使用了分析器，发现应用程序 99% 的时间都花在了一种方法上（这不是预期的）。

我不确定这个方法是被重复调用还是在内部某个地方“循环”（或者可能是死锁）。

我没有从探查器结果中获得太多信息：

![截屏](../Images/a38530e3b884b2ed0decc8ac3de96f03.png)

我不明白为什么两条彼此靠近的线有如此不同的数字（一条为 16%，另一条为 0.2%）。

我怎样才能找出问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:33:29.637

要获得更好的分析会话，请使用 Instrumentation ：这将告诉您方法被调用了多少次。您还可以使用此“调用层次结构”来检测递归调用。

编辑：它在向导中可用

![启动性能向导](../Images/d4999ca5042f05814de154feda3a5291.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T22:20:24.093

您正在`curPrice`比较`moveTo`. 这些属性中的任何一个可能会用于执行大量代码，还是其中一个属性重载了比较运算符？它看起来通常`curPrice`小于等于它是第一个。`moveTo``skipped...Bid``curPrice`

这意味着您可以通过找到一种更快的方法来进行这些比较，从而节省多达 32% 的时间。这是 1/(1 - .32) = 1.47 的加速因子，或接近 50%。

我做了很多性能调整，我不使用分析器。我使用[*这种方法*](https://stackoverflow.com/a/378024/23771) ，其他一些人也使用这种方法。如果我对这段代码进行 10 个堆栈样本，平均有 3.2 个样本会在堆栈上显示这些比较中的一个或另一个，以及原因。它不会给出确切的百分比，但这并不重要——它们足够大，可以修复。

# .net - 如何从 Linq 到 SQL 查询返回名称/值对列表？

> ID：12394188
> 
> 赞同：1
> 
> 时间：2012-09-12T18:24:05.553
> 
> 标签：.net, linq-to-sql

我正在寻找一种直接从 Linq 到 SQL 查询返回名称值对列表的方法，而不必像我在下面的代码中那样循环遍历结果：

```
Public Shared Function GetUserTransactionCounts(fromDate As DateTime, toDate As DateTime) As List(Of KeyValuePair(Of String, Integer))
    Using dc As New ProntoDataContext()
        Dim users As IEnumerable(Of User) = From u In dc.Users Where u.CreatedTransactions.Any(Function(t) t.TSCreate >= fromDate And t.TSCreate <= toDate)

        Dim list As New List(Of KeyValuePair(Of String, Integer))
        For Each user As User In users
            Dim item As New KeyValuePair(Of String, Integer)(user.CommonName, user.CreatedTransactions.Count)
            list.Add(item)
        Next
        Return list
    End Using
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:28:52.933

你可以使用[ToDictionary](http://msdn.microsoft.com/en-us/library/bb549277.aspx#Y900)

可能看起来像这样

```
Dim dict As Dictionary(Of String, Interger) = users .ToDictionary(Function(u) u.CommonName,Function(u) u.CreatedTransactions.Count ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:31:58.527

尝试转换为`IEnumerable`，然后使用`Select`：

```
Dim users As IEnumerable(Of User) = From u In dc.Users Where u.CreatedTransactions.Any(Function(t) t.TSCreate >= fromDate And t.TSCreate <= toDate)
Dim list As List(Of KeyValuePair(Of String, Integer)) = users.AsEnumerable().Select(Function(x) New KeyValuePair(Of String, Integer)(x.CommonName, x.CreatedTransactions.Count)).ToList() 
```

**编辑：**如果你想做一个`IEnumerable`，删除`ToList`：

```
Dim enumerable As IEnumerable(Of KeyValuePair(Of String, Integer)) = users.AsEnumerable().Select(Function(x) New KeyValuePair(Of String, Integer)(x.CommonName, x.CreatedTransactions.Count)) 
```

`enumerable`在第一次枚举之前，这不会运行查询。

# video - 允许个人静音的视频会议服务

> ID：12394190
> 
> 赞同：2
> 
> 时间：2012-09-12T18:24:14.010
> 
> 标签：video, voip

我正在寻找具有非常特定功能的视频会议服务（如 Skype 或 Cisco），但我无法找到。

考虑三个人的通话——A、B 和 C。通常，每个人都能听到其他人的声音。我希望 A 能够使 B 静音。所以 A 不会听到 B，但仍会听到 C。重要的是，C 也仍然能够听到 B——所以我们无法通过让 B 完全静音他的麦克风来实现这一点. 我需要每个参与者能够有选择地静音来自其他参与者的提要。

非常感谢你的帮助！

# xml - XPath“计数器”表达式未返回有效数字

> ID：12394191
> 
> 赞同：1
> 
> 时间：2012-09-12T18:24:24.507
> 
> 标签：xml, xpath, counter, infopath2010

有没有办法修改以下 XPath 表达式以返回先前“喜欢”元素的数量？我需要一个给定分支中类似节点数量的相对计数（我认为它是一个分支......）这在 MS InfoPath 中使用：

`count(../preceding-sibling::*) + 1`

我相信我的示例 XML 的结构会阻止它按预期运行。您会注意到我的 XML 中的所有“Count”值都有数字**1**。该`DateRepeaterCounter`值应在新`MasterRepeater`节点中重置，并且`MasterRepeaterCounter`应反映节点的总数`MasterRepeater`。

我还没有克服 XPath 的学习曲线。

```
<?xml version="1.0" encoding="UTF-8"?><?mso-infoPathSolution solutionVersion="1.0.0.25" productVersion="14.0.0" PIVersion="1.0.0.0" href="file:///C:\Documents%20and%20Settings\Chris\Local%20Settings\Application%20Data\Microsoft\InfoPath\Designer3\e1d38b31bb224d94\manifest.xsf" ?><?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<my:myFields xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-07T14:19:10" xmlns:xd="http://schemas.microsoft.com/office/infopath/2003" xml:lang="en-us">
<my:PrimarySection>
    <my:MasterRepeater>
        <my:MasterRepeaterCounter>1</my:MasterRepeaterCounter>
        <my:DateSection>
            <my:DateRepeater>
                <my:Date>2012-09-12</my:Date>
                <my:DateRepeaterCounter>1</my:DateRepeaterCounter>
            </my:DateRepeater>
            <my:DateRepeater>
                <my:Date>2012-09-13</my:Date>
                <my:DateRepeaterCounter>1</my:DateRepeaterCounter>
            </my:DateRepeater>
            <my:DateRepeater>
                <my:Date>2012-09-14</my:Date>
                <my:DateRepeaterCounter>1</my:DateRepeaterCounter>
            </my:DateRepeater>
            </my:DateSection>
    </my:MasterRepeater>
    <my:MasterRepeater>
        <my:MasterRepeaterCounter>1</my:MasterRepeaterCounter>
        <my:DateSection>
            <my:DateRepeater>
                <my:Date>2012-09-15</my:Date>
                <my:DateRepeaterCounter>1</my:DateRepeaterCounter>
            </my:DateRepeater>
            <my:DateRepeater>
                <my:Date>2012-09-16</my:Date>
                <my:DateRepeaterCounter>1</my:DateRepeaterCounter>
            </my:DateRepeater><my:DateRepeater>
                <my:Date>2012-09-17</my:Date>
                <my:DateRepeaterCounter>1</my:DateRepeaterCounter>
            </my:DateRepeater>
    </my:DateSection>
    </my:MasterRepeater>
</my:PrimarySection>
</my:myFields> 
```

* * *

**编辑和回答**

InfoPath 以某种方式弄乱了表达式...在一个字段中输入表达式然后将其复制到另一个字段后，它停止正常工作。重新输入上述格式的表达式后，它解决了问题。当 StackOverflow 允许时，我会自己回答。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:30:23.210

我会自己回答这个问题，因为它原来是 InfoPath 问题而不是 XPath 问题。InfoPath 以某种方式弄乱了表达式...在一个字段中输入表达式然后将其复制到另一个字段后，它停止正常工作。重新输入上述格式的表达式后，它解决了问题。感谢你的帮助！

# c# - 泛型函数中的 equals() 和 ==

> ID：12394195
> 
> 赞同：5
> 
> 时间：2012-09-12T18:24:53.093
> 
> 标签：c#, equals

我正在为各种类型的集合操作制作一个比较器。

所以我有一个通用类

```
 public class Comparer<T, Tid>
...
     public bool Equals(T x, T y)
       {
          var xid = m_idfunc(x);
           var yid = m_idfunc(y);
           return (Tid)xid == (Tid)yid;
       } 
```

其中 m_idfunc 是传递给 Comparer 构造函数的 lambda，它是

```
Func<T,Tid> 
```

我用 Tid = string 创建了一个比较器。我进入等于函数 xid = string1, yid = string2

如果 string1 和 string 2 相同（“foo”和“foo”说）

```
xid == yid 
```

产生错误

```
(Tid)xid == (Tid)yid 
```

也产生错误（这不应该是必要的 - 我只是变得绝望）

这是我的即时窗口 - 在返回 xid == yid 行上暂停

```
yid.GetType() == typeof(string)
true
xid.GetType() == typeof(string)
true
xid==yid
false
(string)xid==(string)yid
true
xid.Equals(yid)
true 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:28:24.053

有趣的是，它*可能会*按照您想要的方式工作。这是一个例子：

```
using System;
using System.Text;

namespace ConsoleApplication1 {

    class Program {

        public static void Main()  {
            string myString = "1";
            object objectString = "1";
            string myCopiedString = string.Copy(myString);
            string internedString = string.Intern(myCopiedString);

            Console.WriteLine(myString); //1
            Console.WriteLine(objectString); //1
            Console.WriteLine(myCopiedString); //1
            Console.WriteLine(internedString); //1

            Console.Write(objectString == myString); //true
            Console.Write(objectString == "1"); //true
            Console.Write(objectString == myCopiedString); //!!!FALSE!!!!
            Console.Write(objectString == internedString); //true
            Console.Write(objectString == SomeMethod()); //!!!FALSE!!!
            Console.Write(objectString == SomeOtherMethod()); //true
        }

        public static string SomeMethod() {
            StringBuilder sb = new StringBuilder();
            return sb.Append("1").ToString();
        }

        public static string SomeOtherMethod() {
            return "1".ToString();
        }        
    }
} 
```

*它可能*起作用的原因是由于字符串实习。所以，这绝对是一个需要注意的问题，因为当你测试它时它实际上可以工作，但根据实现，它可能会突然中断。

在您的情况下，您需要确定您是否关心参考平等或“价值”平等。== 是引用相等，这又取决于字符串是否被实习，这*可能*是真的。我怀疑你实际上想`EqualityComparer<T>.Default.Equals`在你的函数中使用。

如果你在 VS 中运行 open this，你会看到编译器警告：“Possible unintended reference comparison; 要获得值比较，请将左侧转换为类型“字符串”。但是，在您的情况下，编译器无法警告您，因为据它所知，类型是对象，它不知道其中一个或两个都是字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:30:47.877

我最初的假设是，因为它是泛型的，所以它不能像对字符串所做的那样在幕后引用值转换。我想整理一个支持这一点的例子。:) 我不得不做出一些假设来为此组合一些东西，所以我的例子可能不是 100% 的。（我使用的代码在底部）

当我刚刚编译时，我无法编译任何东西

```
class Comparer<T, TId>
{
    private readonly Func<T, TId> m_idfunc;
    public Comparer(Func<T, TId> idFunc)
    {
        m_idfunc = idFunc;
    }

    public bool Equals(T x, T y)
    {
        var xid = m_idfunc(x);
        var yid = m_idfunc(y);
        return (TId)xid == (TId)yid;
    }
} 
```

我找到了[https://stackoverflow.com/a/390919/156708](https://stackoverflow.com/a/390919/156708)并将类声明修改为

```
class Comparer<T, TId> where TId : class 
```

并编译。步骤1。

我将`Equals`功能设置为

```
public bool Equals(T x, T y)
{
    var xid = m_idfunc(x);
    var yid = m_idfunc(y);
    return (TId)xid == (TId)yid;
} 
```

结果是`False`（请参阅在 xid|yid 中生成值的完整代码）。符合我的假设，即泛型对此有所帮助。还不够，需要看看如果删除了泛型方面会发生什么。

`Comparer`将班级更改为

```
class Comparer<T>
{
    private readonly Func<T, string> m_idfunc;
    public Comparer(Func<T, string> idFunc)
    {
        m_idfunc = idFunc;
    }

    public bool Equals(T x, T y)
    {
        var xid = m_idfunc(x);
        var yid = m_idfunc(y);
        return xid == yid;
    }
} 
```

返回`True`。

我对此不是 100% 的，但我的假设是基于类的`==`操作员进行`string`值检查而不是参考检查的事实。使用泛型时，很可能设置为仅进行引用检查（尚未深入到 IL 中查看它在那里做了什么），如果内存中的字符串位置不同，那么它将返回 false。（我有点想知道细节，因为我不知道它们，只是一个似乎有效的工作假设）

我使用泛型的完整示例代码如下。

```
using System;
namespace ConsoleApplication1
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            var compare = new Comparer<Example, string>(example => example.id(example));
            var ex1 = new Example();
            var ex2 = new Example();
            Console.WriteLine(compare.Equals(ex1, ex2));
            Console.ReadLine();
        }
        class Example
        {
            public string id(Example example)
            {
                return new string(new [] {'f', 'o', 'o'});
            }
        }
        class Comparer<T, TId> where TId : class 
        {
            private readonly Func<T, TId> m_idfunc;
            public Comparer(Func<T, TId> idFunc)
            {
                m_idfunc = idFunc;
            }

            public bool Equals(T x, T y)
            {
                var xid = m_idfunc(x);
                var yid = m_idfunc(y);
                return (TId)xid == (TId)yid;
            }
        }
    }
} 
```

希望这会有所帮助……而且我的推理并没有大错特错。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:18:13.400

`EqualityComparer<TId>`我认为，使用inside更正确`Comparer<T, Tid>`。此外，我将使用接口来获取标识符，而不是委托：

```
interface IObjectWithId<T>
{
    T Id { get; }
}

class IdEqualityComparer<T, TId> : EqualityComparer<T>
    where T : IObjectWithId<TId>
{
    public override bool Equals(T x, T y)
    {
        return EqualityComparer<TId>.Default.Equals(x.Id, y.Id);
    }

    public override int GetHashCode(T obj)
    {
        return EqualityComparer<TId>.Default.GetHashCode(obj.Id);
    }
}

class A : IObjectWithId<string>
{
    public string Id { get; set; }
} 
```

用法：

```
var a = new A { Id = "foo" };
var b = new A { Id = "foo" };
var c = new A { Id = "bar" };

var comparer = new IdEqualityComparer<A, string>();

Console.WriteLine(comparer.Equals(a, b)); // true
Console.WriteLine(comparer.Equals(a, c)); // false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T23:54:57.023

C 运算符“==”有两种截然不同的含义。*如果编译器可以静态*确定这种方法适用于操作数类型，它可以调用特定于类型的重载相等运算符方法，或者如果两个操作数都是引用类型，它可以在操作数之间执行引用比较并且可能存在两个操作数都可以引用的对象。对于大多数类型，只有一种类型的比较是可能的；值类型不支持引用比较，并且大多数引用类型不重载相等运算符。但是，有一个通用类可以支持这两种类型的比较：`System.String`.

vb.net 语言通过只允许`=`运算符用于重载它的类型来避免歧义。对于参考比较，`Is`需要运算符。如果有人尝试在 vb.net 中编写代码，则`=`不允许在类约束泛型上使用该运算符。可以使用`Is`运算符，但无论操作数是否重载，它都会检查引用相等性`=`。

实际上，在 C# 中，假设您对泛型类型有类约束（`==`没有它，运算符将无法工作），如果类型被约束为运算符重载。由于您没有将泛型类型参数限制为`string`（实际上，由于`string`是密封的，因此编译器不会允许这样的约束），因此编译器无法使用`string`等式运算符的重载。因此，它使用它知道在类约束泛型引用相等（相当于`Is`vb.net 中的运算符）上可用的相等运算符版本。

# mysql - WordPress：从数据库更新图库路径

> ID：12394197
> 
> 赞同：0
> 
> 时间：2012-09-12T18:24:55.350
> 
> 标签：mysql, wordpress

在我的博客上，我有很多帖子，里面有很多照片作为画廊。

我需要更改照片的路径。

有没有办法直接在数据库上更改它？

示例：我有这个：

```
http://www.maristelavilasboas.com.br/blog/wp-content/uploads/2011/06/01-300x200.jpg 
```

我需要改变这个：

```
http://www.maristelacinefoto.com.br/blog/wp-content/uploads/2011/06/01-300x200.jpg 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T13:37:25.877

如果不仅仅是*图像*，而是整个博客需要移动，请参阅在 Codex 中[移动 WordPress 。](http://codex.wordpress.org/Moving_WordPress)

# sql - 结合sql select和Count

> ID：12394201
> 
> 赞同：4
> 
> 时间：2012-09-12T18:25:30.020
> 
> 标签：sql, count

我有两张桌子

甲和乙

```
 A                          B
-----------------         -----------------
a_pk (int)                b_pk (int)
a_name(varchar)           a_pk (int)
                          b_name (varchar) 
```

我可以写一个查询

```
SELECT a.a_name, b.b_name
FROM  a LEFT OUTER JOIN b ON a.a_pk = b.a_pk 
```

这将返回给我一个不明确的列表，其中包含表 a 及其表 b 连接数据中的所有内容。将显示列 a 的重复项，其中不同的 b 记录共享一个共同的 a_pk 列值。

但我想要做的是从表 A 列 a_name 中获取完整的值列表，并添加一个列，该列是表 B 的连接值的 COUNT。

因此，如果 a_pk = 1 和 a_name = test 并且在表 b 中有 5 条记录的 a_pk 值为 1，我的结果集将是

```
a_name        b_count
------        -------
test           5 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T18:28:36.947

查询应该是这样的：

```
SELECT 
    a.a_name, 
    (
        SELECT Count(b.b_pk) 
        FROM b 
        Where b.a_pk = a.a_pk
    ) as b_count 
FROM  a 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T18:27:50.867

```
SELECT a_name, COUNT(*) as 'b_count'
FROM 
    A a
    JOIN B b
    ON a.a_pk = b.a_pk
GROUP BY a_name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:29:05.850

```
SELECT
    a.name,
    (
        SELECT COUNT(1)
        FROM B b
        WHERE b.a_pk = a.a_pk
    )
FROM A a 
```

# search - Lucene 索引创建不起作用

> ID：12394202
> 
> 赞同：0
> 
> 时间：2012-09-12T18:25:31.223
> 
> 标签：search, sitecore, lucene

我正在尝试通过 App.Config 在内容项模板之一上通过 Sitecore 6.5 中的 Lucene 创建一个索引。请记住，此处列出的**“主”是****SC 数据库**而不是物理 SQL 数据库。这是我的代码：

```
 <configuration xmlns:x="http://www.sitecore.net/xmlconfig/">
  <sitecore>
    <databases>
      <database id="master" singleInstance="true" type="Sitecore.Data.Database, Sitecore.Kernel">
        <Engines.HistoryEngine.Storage>
          <obj type="Sitecore.Data.$(database).$(database)HistoryStorage, Sitecore.Kernel">
            <param connectionStringName="$(id)" />
            <EntryLifeTime>30.00:00:00</EntryLifeTime>
          </obj>
        </Engines.HistoryEngine.Storage>
        <Engines.HistoryEngine.SaveDotNetCallStack>false</Engines.HistoryEngine.SaveDotNetCallStack>
      </database>
    </databases>
    <search>
      <configuration>
        <indexes>
          <index id="master" type="Sitecore.Search.Index, Sitecore.Kernel">
            <param desc="name">$(id)</param>
            <param desc="folder">master</param>
            <Analyzer ref="search/analyzer" />
            <locations hint="list:AddCrawler">
              <master type="Sitecore.SharedSource.Search.Crawlers.AdvancedDatabaseCrawler,Sitecore.SharedSource.Search">
                <Database>master</Database>
                <Root>/sitecore/content/Data</Root>
                <IndexAllFields>false</IndexAllFields>
                <include hint="list:IncludeTemplate">
                  <template1>{EF11A8D0-D373-4A4B-90BA-16984D277612}</template1>
                </include>
                <fieldCrawlers hint="raw:AddFieldCrawlers">
                  <fieldCrawler type="Sitecore.SharedSource.Search.FieldCrawlers.LookupFieldCrawler,Sitecore.SharedSource.Search" fieldType="Single-Line Text" />
                  <fieldCrawler type="Sitecore.SharedSource.Search.FieldCrawlers.DateFieldCrawler,Sitecore.SharedSource.Search" fieldType="Multilist" />
                </fieldCrawlers>
                <!-- If a field type is not defined, defaults of storageType="NO", indexType="UN_TOKENIZED" vectorType="NO" boost="1f" are applied-->
                <fieldTypes hint="raw:AddFieldTypes">
                  <!-- Text fields need to be tokenized -->
                  <fieldType name="single-line text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="multi-line text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="word document" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="html" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="rich text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="memo" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <!-- Multilist based fields need to be tokenized to support search of multiple values -->
                  <fieldType name="multilist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="treelist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="treelistex" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="checklist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <!-- Legacy tree list field from ver. 5.3 -->
                  <fieldType name="tree list" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                </fieldTypes>
              </master>
            </locations>
          </index>
        </indexes>
      </configuration>
    </search>
  </sitecore>
</configuration> 
```

当我在此之后运行我的解决方案时，我正在通过“索引查看器”查看我的索引，但什么也看不到。我在这里做错了什么？

我添加了这段代码：

```
 private IDictionary<string, Sitecore.Search.Index> GetSearchIndexes()
    {
        var _configuration = Sitecore.Configuration.Factory.CreateObject("search/configuration", true) as Sitecore.Search.SearchConfiguration;
        return _configuration.Indexes;
    } 
```

但是在 _configuration.Indexes 的返回中，我得到了：master、web、advanced。我的索引不同，这些是数据库列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:10:17.280

我假设你的意思是`web.config`而不是`app.config`。

转到**Sitecore > 控制面板 > 数据库 > 重建搜索索引**以在文件系统上生成索引。

或者，下载[此脚本](http://resources.alexshyba.com/blog/RebuildDatabaseCrawlers.zip)并运行它。

# r - 如何在R中的摘要函数中插入字符串

> ID：12394204
> 
> 赞同：0
> 
> 时间：2012-09-12T18:25:34.543
> 
> 标签：r

我认为**R中的****摘要**函数可以采用字符变量，因为它指向的文件是数字的。bbb 给了我很好的结果，但是 aaa 的总结给我带来了问题。

 **```
# Descriptives For Machine.x
for (n in 1:3500){
   machine_name = paste("machine.wt$Machine.", n, sep="")
   aaa = summary (paste("machine.wt$Machine.", n, sep=""))
   bbb = summary (machine.wt$Machine.1)
}

Error in x - mx : non-numeric argument to binary operator
In addition: Warning messages:
1: In mean.default(x, na.rm = na.rm) :
  argument is not numeric or logical: returning NA
2: In var(x, na.rm = na.rm) : NAs introduced by coercion
3: In mean.default(x, na.rm = na.rm, trim = trim) :
  argument is not numeric or logical: returning NA
4: In var(x, na.rm = na.rm) : NAs introduced by coercion
5: In mean.default(x) : argument is not numeric or logical: returning NA 
```

我的数据很简单：

```
Obs.1   Machine.1   Obs.1   Machine.2   Obs.2   Machine.3   Obs.3   Machine.4
1   302.3   1   302.8   1   315.1   1   300.9
2   295.3   2   314.3   2   306.7   2   317.5
3   301.4   3   308.4   3   309.0   3   304.3
4   318.2   4   295.2   4   321.3   4   293.2
5   320.4   5   313.5   5   326.4   5   308.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:37:54.380

如何使用`subset`并`grepl`完全避免循环？

```
summary(subset(machine.wt,select=grepl("^Machine",names(machine.wt)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:36:46.797

看看`fortune(312)`然后试试

```
summary( machine.wt[[ paste0('Machine.',n) ]] ) 
```**

# php - 如何使用 cjuidialog 小部件上传文件？

> ID：12394210
> 
> 赞同：0
> 
> 时间：2012-09-12T18:26:03.637
> 
> 标签：php, yii, yii-extensions, cjuidialog

问：如何使用 cjuidialog 小部件上传文件？

描述：我想上传一个带有弹出框的文件。所以我选择了 cjuidialog 框小部件。我从[这里](http://www.yiiframework.com/wiki/72/cjuidialog-and-ajaxsubmitbutton/)跟随。但我面临着保存和验证。提交后，没有保存数据，验证失败时，弹出框一次又一次地重新显示（重复）。

这是views/aa/_form.php

```
<?php
    echo CHtml::ajaxLink(Yii::t('attachment','Attachment'),$this->createUrl('attachmentform'),array(
        'onclick'=>'$("#attachDialog").dialog("open"); return false;',
        'update'=>'#attachDialog'
        ),array('id'=>'showattachDialog', 'class'=>'btn btn-info'));
    ?> 
```

这是控制器/aacontroller.php

```
public function actionAttachmentForm()
    {
        $media=new Media;
        $this->performAjaxValidation($media);
        $flag=true;
        if(isset($_POST['Media']))
        {       
            $flag=false;
            $media->attributes=$_POST['Media'];

            $media->name=CUploadedFile::getInstance($media,'name');

            var_dump($media->attributes);

            if($media->save()) {
                //do something here and renderPartial to uploadedfile.php to show uploaded files.
                $this->renderPartial('uploadedFile','',false,true);
            }
        }

        if($flag == true) {
            Yii::app()->clientScript->scriptMap['jquery.js'] = false;

        }
        $this->renderPartial('uploadform',array('model'=>$media,),false,true);

    } 
```

这是views/aa/uploadform.php

```
$this->beginWidget('zii.widgets.jui.CJuiDialog',array(
                'id'=>'attachDialog',
                'options'=>array(
                    'title'=>Yii::t('attachment','Attachment Form'),
                    'autoOpen'=>true,
                    'modal'=>'true',
                    'width'=>'450',
                    'height'=>'300',
                    'draggable' => false,
                    'resizable'=> false,
                ),
                ));
echo $this->renderPartial('_formupload', array('model'=>$model)); ?>
<?php $this->endWidget('zii.widgets.jui.CJuiDialog'); 
```

这是views/aa/_formupload.php

```
<div class="form" id="attachDialogForm">

<?php $form=$this->beginWidget('CActiveForm', array(
    'id'=>'attach-form',
    'enableAjaxValidation'=>true,
    'htmlOptions' => array('enctype' => 'multipart/form-data'),
)); 
//I have enableAjaxValidation set to true so i can validate on the fly the
?>

    <p class="note">Fields with <span class="required">*</span> are required.</p>

    <?php //echo $form->errorSummary($model); ?>

    <div class="row">
        <?php echo $form->labelEx($model,'name'); ?>
        <?php echo $form->fileField($model,'name'); ?>
        <?php echo $form->error($model,'name'); ?>
    </div>

    <div class="row">
        <?php echo $form->labelEx($model,'description'); ?>
        <?php echo $form->textField($model,'description'); ?>
        <?php echo $form->error($model,'description'); ?>
    </div>

    <div class="row buttons">
        <?php 
        echo CHtml::ajaxSubmitButton(Yii::t('attachment','Upload'),
            CHtml::normalizeUrl(array('attachmentform','render'=>false)),array(
            //'beforeSend' => 'function(){$("#uploadedfile").addClass("loading");}',
            //'complete' => 'function(){$("#uploadedfile").removeClass("loading"); $("#attachDialog").dialog("close");}',
            'success'=>'js: function(data) {
                //alert(data);
            $("#attachDialog").dialog("close");
            $("#uploadedfile").html(data);
        }'),array('id'=>'closeattachDialog')); 
        ?>
    </div>

<?php $this->endWidget(); ?>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T11:24:46.647

我推荐***“EAjaxUpload”***扩展。它非常易于使用，如果您有任何问题，我可以提供帮助，因为我已经实现了它。

# svg - inkscape 转换 svg -> png: pagesize?

> ID：12394212
> 
> 赞同：2
> 
> 时间：2012-09-12T18:26:13.283
> 
> 标签：svg, png, inkscape

我需要在命令行将 svg 转换为 png。我尝试使用 imagemagick，但在与旋转变换一起使用时似乎有一个错误，例如这个示例 s3.svg：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg">
  <g id="layer1">
    <circle cx="200" cy="200" r="200" stroke="black"
        stroke-width="0.5" fill="none"/>
    <g transform="rotate(48 200 200)">
      <path id="path00" style="fill:#dca08c;stroke:#000000;stroke-width:1"
         d="M 200,0 L 400,200 L 200,400 L 0,200 z"/>
    </g>
  </g>
</svg> 
```

我能够在命令行中使用inkscape：

```
 c:\app\inkscape\portable\App\Inkscape\inkscape.com -f s3.svg -e s3.png --export-background=white --export-area=0:652:400:1052 
```

但是 SVG 坐标 (0,0) 定义在左上角，而在 inkscape 的导出中，导出区域 (0,0) 定义在左下角。

如何在没有定义页面高度的幻数 1052 的情况下使用inkscape 导出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T06:30:10.410

一种可能有帮助的方法是绘制一个您想要作为容器的区域，给它一个 id，然后使用该`-i id`选项将其导出。如果它不应该是可见的，给包装器空白背景/边框。

编辑（添加示例）：我使用了这个 xml

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg">
  <g id="layer1">
    <rect width="400" height="600" id="wrapper" fill="none"></rect>
    <circle cx="200" cy="200" r="200" stroke="black"
        stroke-width="0.5" fill="none"/>
    <g transform="rotate(48 200 200)">
      <path id="path00" style="fill:#dca08c;stroke:#000000;stroke-width:1"
         d="M 200,0 L 400,200 L 200,400 L 0,200 z"/>
    </g>
  </g>
</svg> 
```

使用这个命令（我在 Mac 上，所以根据需要翻译特定的操作系统）我可以控制输出 png 的大小/位置：

```
/Applications/Inkscape.app/Contents/Resources/bin/inkscape -f test.svg -e out.png -i wrapper 
```

我不是 svg 专家，所以我不确定inkscape 是否有一些特定的功能，但我一直觉得它非常符合网络标准。过去我直接在网页中使用它的 svg 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:15:50.970

看来您要导出的是整个绘图。

`inkscape`可以选择导出图形，`--export-area-drawing`而不是指定要导出的区域。

```
c:\app\inkscape\portable\App\Inkscape\inkscape.com -f s3.svg -e s3.png --export-background=white --export-area-drawing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T10:24:02.690

Inkscape 有画布大小选项，我在为网络导出时遇到了同样的问题 - 你的图像从视口中掉了出来。

更改画布/画板大小以满足您要导出的元素的大小

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T02:03:18.380

如果问题是不知道页面高度，那么以下语法可能会有所帮助？

```
c:\app\inkscape\portable\App\Inkscape\inkscape.com s3.svg -z --query-height 
```

这应该返回文档的像素高度，您可以在导出调用中使用返回的数字。

# javafx-2 - JavaFX 和 ScrollPanes 中的缩放

> ID：12394213
> 
> 赞同：8
> 
> 时间：2012-09-12T18:26:17.680
> 
> 标签：javafx-2

我一直在尝试使用 JavaFX 中的缩放变换，但还没有完全理解它。基本上，我有一个包含复杂图形的窗格，并且希望能够重新调整它。缩放部分本身可以正常工作，但是封闭的滚动窗格不会适应图形。

为简单起见，我将发布一个简短的示例，其中我的图表被标签替换：

```
public class TestApp extends Application {
    @Override public void start(final Stage stage) throws Exception {
        final Label label = new Label("Hello World");
        label.getTransforms().setAll(new Scale(0.5, 0.5));

        label.setStyle("-fx-background-color:blue");
        label.setFont(new Font(200));

        final ScrollPane scrollPane = new ScrollPane();
        scrollPane.setContent(label);

        stage.setScene(new Scene(scrollPane));
        stage.setWidth(200);
        stage.setHeight(100);
        stage.show();
    }

    public static void main(String[] args) {
        Application.launch(args);
    }
} 
```

标签将正确缩放，但封闭的滚动窗格的条仍将容纳原始大小的组件。

到目前为止我已经尝试过：

*   使用标签 min 和 pref size
*   将标签包装在组内（不会出现任何滚动条）
*   缩放封闭组而不是标签

我错过了什么？我该怎么做才能使 ScrollPane 适应内容视图？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-13T13:18:38.843

根据 ScrollPane 文档，您可能会尝试将 Pane 包装在 Group 中，因此 ScrollPane 是按视觉绑定滚动而不是实际布局绑定。

```
ScrollPane layout calculations are based on the layoutBounds rather than the
boundsInParent (visual bounds) of the scroll node. If an application wants the
scrolling to be based on the visual bounds of the node (for scaled content etc.),
they need to wrap the scroll node in a Group. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T19:45:38.173

[在 JavaFX 中的滚动窗格视口、转换和布局边界的这个示例中，](https://gist.github.com/1442298)我在 ScrollPane 中为图形和其他节点实现了缩放 。

[该代码是在我第一次学习 JavaFX 时实现的，因此代码当然可以更简洁，也许还有更简单的方法可以实现这一点（例如，按照ScrollPane 文档](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ScrollPane.html)中的建议，使用 Group 作为缩放节点的容器）。

获得我想要的解决方案的一个关键（滚动条仅在您放大并且节点大于可见视口时出现）是以下代码：

```
// create a container for the viewable node.
final StackPane nodeContainer = new StackPane();
nodeContainer.getChildren().add(node);

// place the container in the scrollpane and adjust the pane's viewports as required.
final ScrollPane scrollPane = new ScrollPane();
scrollPane.setContent(nodeContainer);
scrollPane.viewportBoundsProperty().addListener(
  new ChangeListener<Bounds>() {
  @Override public void changed(ObservableValue<? extends Bounds> observableValue, Bounds oldBounds, Bounds newBounds) {
    nodeContainer.setPrefSize(
      Math.max(node.getBoundsInParent().getMaxX(), newBounds.getWidth()),
      Math.max(node.getBoundsInParent().getMaxY(), newBounds.getHeight())
    );
  }
});

...

// adjust the view layout based on the node scalefactor.
final ToggleButton scale = new ToggleButton("Scale");
scale.setOnAction(new EventHandler<ActionEvent>() {
  @Override public void handle(ActionEvent actionEvent) {
    if (scale.isSelected()) {
      node.setScaleX(3); node.setScaleY(3);
    } else {
      node.setScaleX(1); node.setScaleY(1);
    }
    // runlater as we want to size the container after a layout pass has been performed on the scaled node.
    Platform.runLater(new Runnable() { 
      @Override public void run() {
        nodeContainer.setPrefSize(
          Math.max(nodeContainer.getBoundsInParent().getMaxX(), scrollPane.getViewportBounds().getWidth()),
          Math.max(nodeContainer.getBoundsInParent().getMaxY(), scrollPane.getViewportBounds().getHeight())
        );
      }
    });
  }
}); 
```

# three.js - Blender 导出器 - “未捕获的 syntaxError 意外令牌” THREE.JSONLoader()

> ID：12394219
> 
> 赞同：1
> 
> 时间：2012-09-12T18:27:01.687
> 
> 标签：three.js

你有没有遇到过这个错误：`"uncaught syntaxError unexpected token"`

使用三个导出器插件加载从 Blender 2.63a 导出的模型时？

从此代码复制自three.js github示例

```
var loader = new THREE.JSONLoader();
loader.load( {"buffalo.js", function(geo){createModel(geo)}}); 
```

谢谢问候克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T21:51:19.317

检查模型是否有材质。搜索`buffalo.s`字符串：`"material" : ,`. 如果您找到该字符串，则说明您的模型没有分配材料 - 出现语法错误！转到搅拌机，分配材料，然后再次导出到`buffalo.js`.

不工作：

```
...
"objects" :
{
"Monkey" : {
    "geometry"  : "geo_Monkey",
    "groups"    : [  ],
    "material"  : ,
    "position"  : [ -0.150241, 5.41906, 2.96394 ],
    "rotation"  : [ 0.874236, 0.0220203, -3.11527 ],
    "quaternion": [ 0.00726118, 0.0155444, -0.423137, -0.905903 ],
    "scale"     : [ 2.9257, 2.86503, 2.68207 ],
    "visible"       : true,
    "castShadow"    : false,
    "receiveShadow" : false,
    "doubleSided"   : false
},

...
},
... 
```

在职的：

```
...
"objects" :
{
"Monkey" : {
    "geometry"  : "geo_Monkey",
    "groups"    : [  ],
    "material"  : "Material",
    "position"  : [ -0.150241, 5.41906, 2.96394 ],
    "rotation"  : [ 0.874236, 0.0220203, -3.11527 ],
    "quaternion": [ 0.00726118, 0.0155444, -0.423137, -0.905903 ],
    "scale"     : [ 2.9257, 2.86503, 2.68207 ],
    "visible"       : true,
    "castShadow"    : false,
    "receiveShadow" : false,
    "doubleSided"   : false
},

...
},
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T07:58:36.147

我通过省略加载函数的 JSON 签名来完成这项工作。像这样：

loader = new THREE.JSONLoader();

```
 loader.load( 'buffalo.js',function( geo )
    {
.... 
```

希望这有助于问候

# ui-automation - 使用 UI 自动化计算行数/列数

> ID：12394225
> 
> 赞同：1
> 
> 时间：2012-09-12T18:27:38.713
> 
> 标签：ui-automation

我是 UI 自动化的新手。我正在为其中一位客户开发 UIAutomation iPad。我需要执行以下活动 1\. 当我们单击产品列表页面时，我将看到一个包含 2 行 3 列的表格格式，其中将显示每个产品（产品图片、名称、价格、评级、SKU）。这里我需要检查产品是否以 2X3 格式列出。

1.  产品列表页面应在第一页显示文本为 (查看 1-6 of 100)。我需要向左滑动然后它应该显示（查看 7-12 of 100）类似的东西。在这个屏幕上，产品可以是各种类别（等离子电视、Insignia tv 等）在这里，我需要捕获'查看'作为正则表达式并在任何屏幕上执行。这个怎么做？
2.  对于屏幕上显示的 6 种产品中的每一种，都会有一个“添加到比较”按钮。我需要验证，所有 6 张图像都存在“添加到比较”。这个怎么做？
3.  当我单击类别时，屏幕加载将需要几秒钟。我已经使用了 target.delay(20)，它现在工作正常，但是，我想验证是否使用以下方法加载了下一个屏幕。在第二个屏幕上，我正在捕获一个静态文本。我会要求代码等到这个 staticText 可见。这有意义吗？

很抱歉一次发布所有查询，请多多包涵，我是

# ios - iOS - 检查应用程序包中是否存在图像

> ID：12394237
> 
> 赞同：0
> 
> 时间：2012-09-12T18:28:44.500
> 
> 标签：ios, nsbundle, app-bundle

如何根据字符串判断主应用程序包中是否存在图像？例如，捆绑包中是否有一个名为 image1.png 的图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:29:46.607

[NSBundle](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSBundle_Class/Reference/Reference.html)方法：

```
- (NSString *)pathForResource:(NSString *)name ofType:(NSString *)extension 
```

如果没有找到图像，将返回 nil。

IE

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"image1" ofType@"png"];
if(filePath.length > 0 && filePath != (id)[NSNull null]) {
   UIImage *myImage = [UIImage imageWithContentsOfFile:filePath];
} 
```

# c# - 在哪里实现成员访问器的自定义？

> ID：12394238
> 
> 赞同：0
> 
> 时间：2012-09-12T18:28:48.243
> 
> 标签：c#, entity-framework, get, set, accessor

我正在使用 EF4，我想知道在生成的类的成员访问器中哪里可以实现自定义代码？

我不想触碰 EDMXFile.Designer.cs 中的代码，因为只要模型更新，我的自定义设置就会丢失。

任何简单的想法？也许在这些实体上创建另一个具有继承的类？

谢谢，

# android - 为 Tegra GPU 编程需要什么

> ID：12394243
> 
> 赞同：10
> 
> 时间：2012-09-12T18:28:58.793
> 
> 标签：android, cuda, gpgpu, tegra

我可以在 CUDA 处理器 Tegra 1/2 上开发应用程序吗？为此我需要什么以及 Tegra 1/2 CUDA 功能是什么？我发现只有NVIDIA Debug Manager 用于在Eclipse for Android 中进行开发，但我不知道他是否可以开发出CUDA 风格的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T02:53:58.110

当前的 Tegra 处理器（Tegra 1、2 和 3）不支持 CUDA 平台。要了解 Tegra 开发并下载 Tegra Android 开发套件，请参阅[NVIDIA 移动开发者专区](http://developer.nvidia.com/category/zone/mobile-development)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:01:27.977

在此处查看类似的问题/答案：

*   [CUDA 支持 NVIDIA Tegra 4 处理器？](https://stackoverflow.com/questions/14292609/cuda-support-for-nvidia-tegra-4-processors/16091968#16091968)
*   [tegra2 芯片上的 cuda 支持](https://stackoverflow.com/questions/6352478/cuda-support-on-tegra2-chip)

    * * *

正如正确指出的那样，Tegra 2/3/4 不支持 CUDA。Logan 将是第一个支持 CUDA 和 OpenCL 的。

然而，Nvidia 已经在尝试让人们将 CUDA 与 Tegras 一起使用，目前您可以使用 Tegra 3 和 Nvidia PCIe 显卡。

有一些开发板支持

Nvidia Jetson：[http](http://www.nvidia.com/object/jetson-automotive-developement-platform.html) ://www.nvidia.com/object/jetson-automotive-developement-platform.html Nvidia Kayla Toradex Apalis：[http ://www.toradex.com/products/apalis-arm-computer-modules/apalis -t30](http://www.toradex.com/products/apalis-arm-computer-modules/apalis-t30)

# lua - 有人会如何为 Lua VM 创建抢占式调度程序？

> ID：12394248
> 
> 赞同：1
> 
> 时间：2012-09-12T18:29:19.323
> 
> 标签：lua, virtual-machine

我一直在看 lua 和 lvm.c。我非常想实现一个接口来允许我控制 VM 解释器状态。

lua 内部的协作多任务处理对我不起作用（用户贡献的代码）

调试钩子只让我到达那里的大约 50%，指令执行限制，但它引发了一个异常，它只会使正在运行的 lua 代码崩溃——但我需要能够进一步调整它。

我想创建一个运行数十万个 lua 用户脚本的系统 - 单个线程将无法工作，并且执行限制会让初学者感到头疼，我还要控制执行速度。但最终

```
while true do

end 
```

将永远执行，我真的不在乎它是。

我可以查看的任何想法、帮助或其他实现？

编辑：这与沙盒无关，假装我是该领域的专家进行此对话

编辑：我不想使用内部运行的基于 lua 代码协程的控制器。

编辑：我想运行一个线程，并管理大量用户贡献的 lua 脚本，外部进程级控制机制根本无法扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:24:11.507

~~可以搜索 Lua Sandbox 的实现；例如，这个[wiki 页面](http://lua-users.org/wiki/SandBoxes)和[SO question](https://stackoverflow.com/questions/1224708/how-can-i-create-a-secure-lua-sandbox)提供了一些指示。请注意，沙盒的大部分工作都集中在不允许您执行错误代码上，但不一定要防止无限循环。为了更好地控制，您可能需要将 Lua 沙盒与[LXC](http://en.wikipedia.org/wiki/LXC)或[cpulimit 之](http://cpulimit.sourceforge.net/)类的东西结合起来。~~（根据评论不相关）

如果您正在寻找基于 Lua 的、轻量级的但不一定 100% 万无一失的东西，那么您可以尝试在单独的协程中运行您的客户端代码，并在该协程上设置一个调试钩子，该钩子将每第 N 行触发一次。在那个钩子中，您可以检查您正在运行的进程是否超出了它的报价。您还需要处理新启动的协程，因为它们需要设置自己的钩子（您需要禁用 coroutine.create/wrap 或用设置您需要的调试钩子的东西替换它们）。

这种情况下的代码可能如下所示：

```
local coro = coroutine.create(client_func)
debug.sethook(coro, debug_hook, "l", 1000) -- trigger hook on every 1000th line 
```

这不是万无一失的，因为它可能会阻塞某些 IO 操作，并且调试钩子在那里无济于事。

[根据更新的问题和评论进行编辑]

在“无基于 lua 代码协程的控制器”和“无外部进程控制机制”之间，我认为您别无选择。可能您唯一的选择是为每个用户脚本运行一个虚拟机，并以某种方式给这些虚拟机打勾（最近有一个关于 SO 的问题，但我找不到）。在走这条路之前，*我*仍然会尝试使用协程（应该可以轻松扩展到数万；Tir 声称[支持 1M 活跃用户](http://sheddingbikes.com/posts/1289384533.html)和基于协程的架构）。

该机制大致如下所示：您安装调试钩子，如上所示，然后从该钩子返回到控制器，然后控制器决定要恢复的其他协程（用户脚本）。[我在我一直在开发的Lua 调试器](https://github.com/pkulchenko/MobDebug)中使用了这种机制（尽管它只适用于一个客户端脚本）。这并不能保护您免受可能阻塞的 IO 调用的影响，因此您可能仍需要在 VM 级别有一个看门狗来查看它是否被阻塞的时间超过了需要的时间。

如果您需要序列化和反序列化运行代码片段以保留上值等，那么[Pluto](http://lua-users.org/wiki/PlutoLibrary)可能是您唯一的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T14:01:05.560

看看实施`lua_lock`和`lua_unlock`。 [http://www.lua.org/source/5.1/llimits.h.html#lua_lock](http://www.lua.org/source/5.1/llimits.h.html#lua_lock)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-16T10:18:51.790

看看这个， [https://github.com/amilamad/preemptive-task-scheduler-for-lua](https://github.com/amilamad/preemptive-task-scheduler-for-lua) 我维护了这个项目。它是一个用于运行 lua 代码的非阻塞抢占式调度程序。适用于长时间运行的游戏脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-30T22:00:48.883

看看露露。它是在 lua 上编写的 lua VM。它适用于 Lua 5.1 对于较新的版本，您需要做一些工作。但那时你真的可以做一个调度器。

# eclipse - Ecilpse Java Builder 开始失败

> ID：12394253
> 
> 赞同：5
> 
> 时间：2012-09-12T18:29:48.773
> 
> 标签：eclipse, eclipse-plugin

我已经使用这个 Eclipse 安装一年多了。突然间，建造者开始失败。我没有更改任何设置。唯一可能造成这种情况的是 Eclipse 发生了严重崩溃，然后构建器开始生产这些 NPE ......

```
!SESSION 2012-09-12 13:40:37.149 -----------------------------------------------
eclipse.buildId=M20120208-0800
java.version=1.6.0_24
java.vendor=Sun Microsystems Inc.
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_US
Framework arguments:  -product org.eclipse.epp.package.java.product
Command-line arguments:  -os win32 -ws win32 -arch x86_64 -product org.eclipse.epp.package.java.product

!ENTRY org.eclipse.core.resources 4 2 2012-09-12 13:46:08.705
!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.core.resources".
!STACK 0
java.lang.NullPointerException
    at org.eclipse.jdt.internal.compiler.apt.dispatch.AnnotationDiscoveryVisitor.visit(AnnotationDiscoveryVisitor.java:61)
    at org.eclipse.jdt.internal.compiler.ast.Argument.traverse(Argument.java:160)
    at org.eclipse.jdt.internal.compiler.ast.TryStatement.traverse(TryStatement.java:1080)
    at org.eclipse.jdt.internal.compiler.ast.Block.traverse(Block.java:112)
    at org.eclipse.jdt.internal.compiler.ast.Initializer.traverse(Initializer.java:128)
    at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.traverse(TypeDeclaration.java:1304)
    at org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.traverse(CompilationUnitDeclaration.java:690)
    at org.eclipse.jdt.internal.compiler.apt.dispatch.RoundEnvImpl.<init>(RoundEnvImpl.java:58)
    at org.eclipse.jdt.internal.compiler.apt.dispatch.BaseAnnotationProcessorManager.processAnnotations(BaseAnnotationProcessorManager.java:148)
    at org.eclipse.jdt.internal.apt.pluggable.core.dispatch.IdeAnnotationProcessorManager.processAnnotations(IdeAnnotationProcessorManager.java:134)
    at org.eclipse.jdt.internal.compiler.Compiler.processAnnotations(Compiler.java:813)
    at org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:432)
    at org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:364)
    at org.eclipse.jdt.internal.core.builder.BatchImageBuilder.compile(BatchImageBuilder.java:178)
    at org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:301)
    at org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build(BatchImageBuilder.java:60)
    at org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll(JavaBuilder.java:254)
    at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:173)
    at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:728)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:239)
    at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:292)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:295)
    at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:351)
    at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:374)
    at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143)
    at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:241)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)

!ENTRY org.eclipse.core.resources 4 75 2012-09-12 13:46:09.643
!MESSAGE Errors occurred during the build.
!SUBENTRY 1 org.eclipse.jdt.core 4 75 2012-09-12 13:46:09.643
!MESSAGE Errors running builder 'Java Builder' on project 'cust_Windchill_src'.
!STACK 0
java.lang.NullPointerException
    at org.eclipse.jdt.internal.compiler.apt.dispatch.AnnotationDiscoveryVisitor.visit(AnnotationDiscoveryVisitor.java:61)
    at org.eclipse.jdt.internal.compiler.ast.Argument.traverse(Argument.java:160)
    at org.eclipse.jdt.internal.compiler.ast.TryStatement.traverse(TryStatement.java:1080)
    at org.eclipse.jdt.internal.compiler.ast.Block.traverse(Block.java:112)
    at org.eclipse.jdt.internal.compiler.ast.Initializer.traverse(Initializer.java:128)
    at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.traverse(TypeDeclaration.java:1304)
    at org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.traverse(CompilationUnitDeclaration.java:690)
    at org.eclipse.jdt.internal.compiler.apt.dispatch.RoundEnvImpl.<init>(RoundEnvImpl.java:58)
    at org.eclipse.jdt.internal.compiler.apt.dispatch.BaseAnnotationProcessorManager.processAnnotations(BaseAnnotationProcessorManager.java:148)
    at org.eclipse.jdt.internal.apt.pluggable.core.dispatch.IdeAnnotationProcessorManager.processAnnotations(IdeAnnotationProcessorManager.java:134)
    at org.eclipse.jdt.internal.compiler.Compiler.processAnnotations(Compiler.java:813)
    at org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:432)
    at org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:364)
    at org.eclipse.jdt.internal.core.builder.BatchImageBuilder.compile(BatchImageBuilder.java:178)
    at org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:301)
    at org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build(BatchImageBuilder.java:60)
    at org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll(JavaBuilder.java:254)
    at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:173)
    at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:728)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:239)
    at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:292)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:295)
    at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:351)
    at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:374)
    at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143)
    at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:241)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) 
```

谁能帮我弄清楚如何让建造者再次工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T23:58:05.473

经过几个小时的敲打我的头后想通了。

在我写代码的过程中，Eclipse 崩溃了。所以当我重新启动 Eclipse 时存在的代码看起来像这样......

```
public abstract class AbstractAmbassadorQueueTask implements AmbassadorQueueTask{

    // BEGIN: This is where I was working when Eclipse crashed.
    private static SessionListenerIfc l = new SessionListenerAdapter(){

    } // <<< **Note the missing semicolon after the last brace.**
    // END: This is where I was working when Eclipse crashed.

    public AbstractAmbassadorQueueTask() {
        super();
    }
} 
```

当我重新启动 Eclipse 时，我看到了所有的编译 NPE，并且从未想过要查看我正在处理的代码。我本来希望 Eclipse 在重新编译项目之前告诉我语法错误。

当我尝试通过命令行和 Eclipse 外部编译我的项目时，我发现了语法错误。

恕我直言，这是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:37:26.303

崩溃可能会使您的工作区处于不一致的状态，这可能会导致您在 Java Builder 中发现一个未正确处理的极端情况。

尝试刷新所有项目，然后运行 ​​clean build。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-16T08:58:37.153

嗨，这是由 heapdumps 造成的问题，删除临时文件并重新启动 eclipse 并再次构建您的项目，如果您在 4 5 个构建后遇到问题做同样的事情

# event-handling - 在jQuery中处理多个事件

> ID：12394254
> 
> 赞同：0
> 
> 时间：2012-09-12T18:29:50.260
> 
> 标签：event-handling, telerik, jquery

我有两个功能需要根据下拉列表中的选择来执行。

例如

如果`Dropdownlist1`值为“First”，则禁用`Dropdownlist2`并执行`Function1`
，如果`Dropdownlist1`值为“Second” ，则 如果选择“Third”作为值，则启用`Dropdownlist2`并执行。我在 Document ready 事件中尝试了一个常规的 if 语句，但无法实现我想要的上面。`Function2`
`Dropdownlist2`

这是我到目前为止所拥有的：

形式：

```
 <th>
                    Dropdown List 1
                </th>
                <td>
                    <%= Html.Telerik().DropDownList().Name("DropDownList1")
                    .HtmlAttributes(new { @id = "DropDownList1" })
                    .Items(items => {
                        items.Add().Text("").Value("");
                        items.Add().Text("New").Value("First");
                        items.Add().Text("Existing").Value("Second");
                            })%> 
                </td>

                 <th>
                    Dropdown List 2
                </th>
                <td>
                    <%= Html.Telerik().DropDownList().Name("DropDownList2")
                    .HtmlAttributes(new { @id = "DropDownList2" })
                    .Items(items => {
                        items.Add().Text("").Value("");
                        items.Add().Text("Three").Value("Three");
                            })%> 
                </td> 
```

查询：

```
$(function () {
$("#Dropdownlist1").focusout(func1);
});

function func1() {

$("#Dropdownlist1").focusout(function(){
    if($("#Dropdownlist1").val() == "First"){
        $("#Dropdownlist2").attr('disabled','disabled')
        Function1()
    }
    else if ($("#Dropdownlist1").val() == "Second"){
        $("#Dropdownlist2").attr('disabled','')
        $("#Dropdownlist2").focusout(function(){Function2()})
    }
});   

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:46:56.400

html:

```
<select id="options">
    <option value=1>option 1</option>
    <option value=2>option 2</option>
    <option value=3>option 3</option>
</select> 
```

JS：

```
function func1() { alert('hello from func 1'); };
function func2() { alert('hello from func 2'); };
function func3() { alert('hello from func 3'); };

$('#options').change(function() {

    if ($(this).val() == 1) {
         func1();
    } else if ($(this).val() == 2) {
         func2();    
    } else if ($(this).val() == 3) {
         func3();
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:39:37.817

如果我正确阅读了上面的帖子，这应该可以满足您的要求……或者至少为您指明正确的方向。

```
$("#Dropdownlist1").change(function(){
  //if Dropdownlist1 value is "First" then Disable Dropdownlist2 and Execute Function1
  if($(this).val() == "First"){
    $("#Dropdownlist2").attr("disabled", "disabled");
    function1();
  }
  //if Dropdownlist1 value is "Second" then Enable Dropdownlist2 and Execute Function2
  else if($(this).val() == "Second"){
    $("#Dropdownlist2").removeAttr("disabled");
    function2();
  }
});

$("#Dropdownlist2").change(function(){
  //and Execute Function2 if "Third" is selected as Dropdownlist2 value
  if($(this).val() == "Third")
    function2();
}); 
```

# php - Ajax responsetext作为表格输出？

> ID：12394255
> 
> 赞同：-1
> 
> 时间：2012-09-12T18:29:52.317
> 
> 标签：php, mysql, ajax, html-table, response

我对 Ajax 响应不是很熟悉 - 我已经从 W3schools.com 编辑了 PHP Ajax 搜索代码，如下所示：

```
<?php
require_once('connect_db.php');

$query = "select item_no from items";
$result = mysql_query($query);
$a = array();

while ($row = mysql_fetch_assoc($result)){
    $a[] = $row['item_no'];
}

//get the q parameter from URL
$q=$_GET["q"];

//lookup all hints from array if length of q>0
if (strlen($q) > 0)
  {
  $hint="";
  for($i=0; $i<count($a); $i++)
    {
    if (strtolower($q)==strtolower(substr($a[$i],0,strlen($q))))
      {
      if ($hint=="")
        {
        $hint=$a[$i];
        }
      else
        {
        $hint=$hint." , ".$a[$i];
        }
      }
    }
  }

// Set output to "no suggestion" if no hint were found
// or to the correct values
if ($hint == "")
  {
  $response="No Suggestion";
  }
else
  {
  $response=$hint;
  }

//output the response
echo "<table border=1><tr><td>".$response."</td></tr></table>";

?> 
```

上述代码的输出工作完美，但它们都是这样列出的（2L500BU、2L500GO、2L500NA、2L500RD、2L802CA、2L802WH、2L803GR、2L804BE、2L804BK、2L804CO、2L805BU、2L806BE 8*中的编号是2） mysql 表调用项。*

现在 ：

**1）**我想像这样将响应输出到表`<tr>`中

2l500BU

2L500GO

.

.

.

. 等等

**2）**您是否认为可以根据输入的提示从Mysql输出所有表记录，如下所示：

```
$sql="SELECT * FROM items WHERE item_no = '".**$hint**."'";

$result = mysql_query($sql);

echo "<table align='center' cellpadding='3' cellspacing='3' width='800px' border='1' font style='font-family:arial;'>";
echo "
<tr align=center>
<th style=font-size:18px; bgcolor=#20c500>Item Number</th>
<th style=font-size:18px; bgcolor=#20c500>QTY</th>
<th style=font-size:18px; bgcolor=#20c500>Actual Price</th>
<th style=font-size:18px; bgcolor=#20c500>Selling Price</th>
<th style=font-size:18px; bgcolor=#20c500>Difference</th>
<th style=font-size:18px; bgcolor=#20c500>Date</th>
</tr>";

while($row = mysql_fetch_assoc($result)){

echo "<tr align=center bgcolor=#e3e3e3>";
  echo "<td style='font-size:18px; font-weight:bold;'>" . strtoupper($row['item_no']) . "</td>";
  echo "<td style='font-size:18px; font-weight:bold;'>" . $row['qty'] . "</td>";
  echo "<td style='font-size:18px; font-weight:bold;'>" . $row['actual_price'] . "&nbsp;<font style=font-size:12px;>JD</font></td>";
  echo "<td style='font-size:18px; font-weight:bold;'>" . $row['discount_price'] . "&nbsp;<font style=font-size:12px;>JD</font></td>";
  echo "<td style='font-size:18px; font-weight:bold;'>" . $row['difference_price'] . "&nbsp;<font style=font-size:12px;>JD</font></td>";
  echo "<td style='font-size:18px; font-weight:bold;'>" . date("d-m-Y",strtotime($row['date'])) . "</td>";
  echo "</tr>";

}
echo "<table>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:48:03.247

如果您想从数据库中获取项目并为每个项目显示一行，这就是您使用 jQuery 的方式。

你的 PHP 脚本：

```
<?php
    $mysqli = new mysqli('localhost', 'user', 'password', 'database');
    $sql = "SELECT item_no FROM items";
    $res = $mysqli->query($sql);
    while ($row = $res->fetch_assoc()) {
        $rows[] = $row['item_no'];
    }
    header('Content-Type: application/json');
    echo json_encode($rows);
?> 
```

以及带有表格的 HTML：

```
<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <table>
      <thead>
        <tr>
          <th scope="col">Item No.</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </body>
</html>
<script src="js/lib/jquery.js"></script>
<script>
    $(document).ready(function() {
        $.getJSON('yourscript.php', function(items) {
            $.each(items, function(i, item) {
                $('tbody').append('<tr><td>' + item + '</td></tr>);
            });
        });
    });
</script> 
```

我还使用了 MySQLi（改进了 MySQL）而不是标准`mysql_`函数，因为该`mysql_`库已弃用，您现在应该使用 MySQLi 或 PDO。

# ios - 是否有一种方法总是在 didSelectRowAtIndexPath 之后立即被调用？

> ID：12394256
> 
> 赞同：0
> 
> 时间：2012-09-12T18:29:55.333
> 
> 标签：ios, uitableview, uipopover

我正在开发一个 iPad 应用程序，其中有一个表格视图。当用户在表中选择一行时，我使用`didSelectRowAtIndexPath`打开一个弹出框。当我尝试使用某个按钮时，我收到一条错误消息，说“消息已发送到已释放的实例”。我最初虽然错误是由弹出框（在它`viewDidLoad`或其他东西中）抛出的，所以我在其中放置了一个断点并单步执行代码。令我惊讶的是，我能够一步一步地加载弹出框和`didSelectRowAtIndexPath`我的表格视图的其余部分（实际上只涉及退出一些 if 块）。当我在自动生成的代码中执行几个步骤时，该错误就会被抛出，该代码没有出现在我的任何类文件中（看起来像`0x0010d71d <+1164> mov 0x6...`）。

所以，我的问题是，我如何找到引发此错误的位置？是否有另一种自动运行的方法`didSelectRowAtIndexPath`可能会在某个地方搞砸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:33:38.403

在您的 DEBUG 构建中启用 NSZombieEnabled（请参阅[如何在 Xcode 4 中设置 NSZombieEnabled？](https://stackoverflow.com/questions/2190227/how-do-i-set-up-nszombieenabled-in-xcode-4)）以定位您正在访问的已被释放/释放的对象的实例。

此外，考虑将您的项目升级到 ARC，这可能会解决此类内存管理问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:51:26.820

好的，每个人的回答都让我找到了[malloc 错误 -[CFString release]](https://stackoverflow.com/questions/4734251/malloc-error-cfstring-release)，这帮助我弄清楚我的弹出框中有一个字符串，我`viewDidLoad`通过

```
myString = [NSMutableString stringWithString:[myGlobalFunctionClass getMyString]]; 
```

由于我以这种方式分配它，它被设置为自动释放。问题是我明确`[myString release];`地`myString = nil;`在`viewWillAppear`. 删除`release`和`=nil`零件清除了我的错误。

为了回答我发布的实际问题，我相信`autorelease`直到模拟器实际尝试显示弹出框（将在 之后运行`didSelectRowAtIndexPath`）才触发。由于这发生在我明确地`[myString release]`in之后`viewWillAppear`，它试图做`autorelease`一些不再存在的东西。重申一下，正确的做法是让它`autorelease`在最后，而不是`[myString release]`在我的代码中的任何地方。

有人可以验证这是正确的吗？正如我在评论中提到的，我对 iOS 开发还是很陌生。在这个项目结束时，我有一种感觉，我将能够回到我在其中做的第一件事，并在做事更有效和更符合最佳实践方面做出数十项改进。

# ruby-on-rails - Rails if else in view

> ID：12394258
> 
> 赞同：9
> 
> 时间：2012-09-12T18:29:59.603
> 
> 标签：ruby-on-rails

我的评论控制器需要调整嵌套，但我遇到了一些错误。这是我一直在尝试的：

```
<% if @commentable == @user %>
  <%= semantic_form_for [@commentable, @comment] do |f| %>
<% else %>
  <%= semantic_form_for [@user, @commentable, @comment] do |f| %>
<% end %> 
```

这给出了这个：

```
/Users/rbirnie/rails/GoodTeacher/app/views/comments/_form.html.erb:3: syntax error, unexpected keyword_else, expecting keyword_end'); else 
```

知道为什么这不起作用吗？看起来很简单...

这是完整的视图：

```
<% if @commentable == @user %>
  <%= semantic_form_for [@commentable, @comment] do |f| %>
<% else %>
  <%= semantic_form_for [@user, @commentable, @comment] do |f| %>
<% end %>

  <div class="control-group">
    <%= f.label :subject %>
    <div class="controls"><%= f.text_field :subject %></div>
  </div>
  <div class="control-group">
    <%= f.label :body %>
    <div class="controls"><%= f.text_area :body, rows: 8 %></div>
  </div>
  <div class="form-actions">
    <%= f.submit "Submit", :class => "btn-success" %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-12T18:32:19.977

你应该结束“做”

```
<% if @commentable == @user %>
  <%= semantic_form_for [@commentable, @comment] do |f| %>
  <% end %>
<% else %>
  <%= semantic_form_for [@user, @commentable, @comment] do |f| %>
  <% end %>
<% end %> 
```

它在“做”而不是“其他”之后期待“结束”。

谢谢

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-12T18:40:16.297

这很疯狂，因为`do`bit 开始了一个块，它期望 an`end`结束它。但是当条件为真时，它会找到一个`else`代替。请注意，如果条件为假，它会找到`end`它想要的 - 但不是`end`你想要的！它会找到`end`结束你的`if`陈述的`end`那个 - 而不是你想要结束你的块的那个。

如果您的`semantic_form_for`块在每种情况下都有不同的内容，请使用 Paritosh 的答案。但是如果它们是相同的代码并且你想避免重复它，你可以有条件地选择参数，然后将它们传递给一个`semantic_form_for`：

```
<% args = (@commentable == @user)? [@commentable, @comment] : [@user, @commentable, @comment] %>
<%= semantic_form_for(args) do |f|
    Whatever...
<% end %> 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-12T18:47:42.370

您描述的问题是纯 Ruby，与视图无关。你可以写这样的东西：

```
<%
if @commentable == @user
  args = [@commentable, @comment]
else
  args =  [@user, @commentable, @comment]
end
%>
<%= semantic_form_for args do |f| %> 
```

# json - json-lib - JSONSerializer 需要多少个类？

> ID：12394263
> 
> 赞同：0
> 
> 时间：2012-09-12T18:30:08.653
> 
> 标签：json, json-lib

我正在尝试解析一些 JSON 数据，并且正在使用此站点中的示例：http: [//answers.oreilly.com/topic/257-how-to-parse-json-in-java](http://answers.oreilly.com/topic/257-how-to-parse-json-in-java)

我正在使用第 2 节中的数据和第 3 节中的代码，并将 json-lib 作为我的 JSON 库。

但是当我尝试运行示例时，JSONSerializer 类关于缺少 Apache Commons 的语言类。我下载了那个，它抱怨缺少日志类。我下载了那个，它抱怨缺少 EZmorph 类。我下载了那个，它抱怨缺少 Collections 类。然后我下载了一个包含所有 Apache Commons 组件的非官方 JAR 文件，它抱怨缺少 SLF4J 记录器或其他东西。至少，我放弃了，决定改用 Google 的 GSON。

这似乎比它应该的要复杂得多。我需要下载多少个包？有没有办法禁用日志记录？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T05:57:01.630

我建议使用另一个更常用的 Java JSON 库：例如[Jackson](http://jackson.codehaus.org)或[GS​​ON](http://code.google.com/p/google-gson/)。有很多关于使用这两种方法的教程和文章，我不认为有很多理由使用 json-lib 超过任何一种。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T16:36:24.540

你也可以看看[Genson](http://code.google.com/p/genson/)。它是一个多合一的库，具有良好的功能、易于使用和良好的性能。

例如，将完整的 pojo 序列化为 json，然后将其反序列化：

```
 Genson genson = new Genson();
 String json = genson.serialize(yourPojo);

 // and deserialize it
 YourPojo pojo = genson.deserialize(json, YourPojo.class); 
```

正如 Staxman 所说，没有理由使用 json-lib。当有几个更好的库时，我仍然对有多少人在使用它感到惊讶。

# design-patterns - 在 Gridmap 上识别特定 NxN 模式的快速方法

> ID：12394265
> 
> 赞同：1
> 
> 时间：2012-09-12T18:30:10.790
> 
> 标签：design-patterns, map, grid, identification

我确实有以下问题要解决：我有一个简单但大的网格图（大小：mX-times-mY）。我只区分被障碍物占据或自由的瓷砖。

现在假设我使用了一个相对较小的滑动窗口，大小为 n-times-n，所以 n << mX，n << mY。对于该 n 次 n 窗口中所有可能的占用和空闲图块组合，我分配了一个标识符（我们只是说一个数字）。然后我以那个窗口的大小对我的大地图的一部分进行“快照”。

我的问题：确定从地图中提取的当前模式的识别号最简单和/或最快的方法是什么？

演示：我有一个 2x2 窗口（所以是 2x2 矩阵）。有 2^(2x2)=16 种可能的模式组合。

```
Pattern    #1    #2    #3    #4    #5    #6    #7    #8

           00    #0    0#    00    00    ##    #0    00
           00    00    00    #0    0#    00    #0    ##

Pattern    #9    #10   #11   #12   #13   #14   #15   #16

           0#    #0    0#    0#    #0    ##    ##    ##
           0#    0#    #0    ##    ##    0#    #0    ##

with # = obscured
     0 = free 
```

假设我提取模式

```
#0
0# 
```

从我的地图中，我怎样才能轻松快速地确定这是上面示例中的模式编号 10？

到目前为止我的想法：

# 1：简单循环

循环遍历所有模式，直到找到正确的模式，可能通过检查两种模式的差异是否为零矩阵。

# 2：使用 Row-Sum 和 Column-Sum 作为标识符

我对所有 n 行和所有 n 列求和，并将这些总和用作多维数组中的子索引。对于上面的例子： sumRow1 = 1 sumRow2 = 1 sumCol1 = 1 sumCol2 = 1 所以我的模式被保存在 patternNumbers[1][1][1][1] = 10 中。另一个例子是模式 16，它将被保存在模式编号[2][2][2][2] = 16。

更大窗口的可能优势：我只需要计算 2*n 总和并立即可以使用这些总和来解决我正在寻找的模式。很大很大的缺点：我需要一个 (2*n) 维数组，其中会留下许多空条目。所以开销比较大。

你们有没有人这样做过？任何想法如何解决这个问题？我也没有考虑任何形式的对称性（旋转或直线）。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T08:30:53.947

好吧，看起来我找到了一个相对简单的解决方案，这是其他人向我指出的：

通过以特定顺序获取所有行或所有列（没关系，您的选择！） - 所有模式都必须相同 - 并将它们对齐为一个长向量，然后你得到一个正则二进制表达式。只需将该二进制数转换为十进制数，您就有了“唯一标识符”。

```
Example 1:

00
#0

can also be written as
00
10

now reorder the rows to

0010 = 2

=============================

Example 2:

##
00

can also be written as
11
00

now reorder the rows to

1100 = 12 
```

# javascript - javascript内部函数的问题

> ID：12394267
> 
> 赞同：0
> 
> 时间：2012-09-12T18:30:13.487
> 
> 标签：javascript, jquery, web

我在使用内部函数时遇到问题。

```
this.init = function () {

  var size = this.ref;
  var wall = this.element;
  var id = this.id;
  var initRef = this.init;

  this.update(id, size, wall, initRef);
}

this.update = function (id, size, wall, init) {

  $.get(url, "cpart=" + id + "&ref=" + size, (function (wall, size, init) {
    return function (data) {
      if (data) {
        var response = JSON.parse(data);
        size = response["psize"];
        wall.append(response["msg"]);
        wall.scrollTop($(document).height());
      }

      init();
    }
  })(wall, size, init));
} 
```

我遇到的问题是第二次迭代，ajax 请求中的变量未定义，我不确定为什么会发生这种情况。当第一次调用该函数时，它会起作用，但是第二次调用时，变量和大小是未定义的。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:41:24.930

试试*这个*：

```
this.update = function (id, size, wall, init) {

    $.get(url, "cpart=" + id + "&ref=" + size, (function (self, wall, size, init) {
        return function (data) {
            if (data) {
                var response = JSON.parse(data);
                size = response["psize"];
                wall.append(response["msg"]);
                wall.scrollTop($(document).height());
            }

            init.apply(self);
        }
    })(this, wall, size, init));
} 
```

由于您在没有真正指定激活对象的情况下调用 init，任何事情都可能发生。

* * *

**更新：** 我现在更加注意阅读您的代码。

虽然，我不完全确定您要达到的目标，但这是一个修订版：

```
this.update = function () {
    var self = this;

    $.get(url, "cpart=" + id + "&ref=" + size, function(data) {
        if (data) {
            var response = JSON.parse(data);
            self.size = response["psize"];
            self.wall.append(response["msg"]);
            self.wall.scrollTop($(document).height());
        }

        init.call(self);
    });
} 
```

请注意，我不再将参数传递给`update`，而是直接使用对象的属性。我在变量中保留了对对象的引用`self`，它可以从我们提供的匿名函数中访问，`$.get()`因为它是在围绕它的函数中声明的（即“更新”函数）。

* * *

**更新 2**

您正在调用 init，它调用 update，这将导致 init 再次被调用！你不认为应该有办法打破这个循环吗？
您将同时敲击服务器和用户的浏览器。

我认为如果你只是告诉我们你想要达到的目标是最好的。

* * *

**更新 3**

感觉就像我在为你做你的工作：J

```
// If you're writing a "class", there's got
// to be a constructor somewhere:

function YourClass(id, ref, element) {
    // These need to come from somewhere...
    this.id = id;
    this.ref = ref; 
    this.element = element;
}

// Now we set your "class methods" on YourClass.prototype,
// so they can be shared among all the instances of YourClass.
// Create instances like this: 
// obj = new YourClass();

YourClass.prototype.init = function() {
    // You want to give these properties
    // alternate names, I'll respect that.
    // (notice obj.ref won't ever be updated, but obj.size will)
    this.size = this.ref;
    this.wall = this.element;
    this.update();
}

YourClass.prototype.updateFromData = function(data) {
    // I moved this code to a helper "class method" to make things more clear
    if (data) {
        var response = JSON.parse(data);
        this.size = response["psize"];
        this.wall.append(response["msg"]);
        obj.wall.scrollTop($(document).height());
    }
    this.init();
}

YourClass.prototype.update = function() {
    // Not the most elegant way of coding this,
    // but it should be easier to read.        
    function createUpdater(obj){
        return function(data){
            obj.updateFromData(data);
        }
    }        
    $.get(url, "cpart=" + this.id + "&ref=" + this.size, createUpdater(this));        
}

// An alternative to the above would simply be this:
// YourClass.prototype.update = function() {
//     $.get(url, "cpart=" + this.id + "&ref=" + this.size, this.updateFromData.bind(this));
// } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:39:44.373

我猜你得到声明的格式应该是这样的：

```
$.get(url, {cpart: id, ref: size}, (function (wall, size, init) {
   // existing stuff
}); 
```

希望这会有所帮助。

# multithreading - forkIO 线程和 OS 线程

> ID：12394268
> 
> 赞同：6
> 
> 时间：2012-09-12T18:30:14.160
> 
> 标签：multithreading, haskell

如果我使用 forkIO 创建一个线程，我需要提供一个函数来运行并取回一个标识符（threadID）。然后我可以通过例如工作负载、MVAR 等与这种动物进行通信。但是，据我了解，创建的线程非常有限，并且只能以 SIMD 方式工作，其中为线程创建提供的功能是指令。我无法更改启动线程时提供的功能。我知道这些用户线程最终是由操作系统映射到操作系统线程的。

我想知道 Haskell 线程和 OS 线程是如何交互的。为什么做完全不同的事情的 Haskell 线程可以映射到同一个 OS 线程？为什么不需要使用固定指令启动 OS 线程（因为它在 forkIO 中是必需的）？调度程序（？）如何识别可能分布的应用程序中的用户线程？换句话说，为什么操作系统线程如此灵活？

最后，有没有办法从应用程序中转储选定线程的堆？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T18:51:29.000

首先，让我们解决一个简单的误解：

> 我知道这些用户线程最终是由操作系统映射到操作系统线程的。

实际上，Haskell 运行时负责从其池中选择特定 OS 线程正在执行的 Haskell 线程。

现在问题，一次一个。

> 为什么做完全不同的事情的 Haskell 线程可以映射到同一个 OS 线程？

暂时忽略 FFI，所有操作系统线程实际上都在运行 Haskell 运行时，它跟踪准备好的 Haskell 线程列表。运行时选择一个 Haskell 线程来执行，然后跳转到代码中，一直执行直到线程将控制权交还给运行时。在那一刻，运行时有机会继续执行相同的线程或选择不同的线程。

简而言之：许多 Haskell 线程可以映射到单个 OS 线程，因为实际上 OS 线程只做一件事，即运行 Haskell 运行时。

> 为什么不需要使用固定指令启动 OS 线程（因为它在 forkIO 中是必需的）？

我不明白这个问题（我认为它源于第二个误解）。使用固定指令启动 OS 线程与使用固定指令启动 Haskell 线程的意义完全相同：对于每件事，您只需提供一段代码来执行，这就是它的作用。

> 调度程序（？）如何识别可能分布的应用程序中的用户线程？

“分布式”是一个危险的词：通常，它指的是在多台机器上传播代码（大概不是你在这里的意思）。至于 Haskell 运行时如何判断何时有多个线程，嗯，这很简单：你在调用`forkIO`.

> 换句话说，为什么操作系统线程如此灵活？

我不清楚操作系统线程是否比 Haskell 线程更灵活，所以这个问题有点奇怪。

> 最后，有没有办法从应用程序中转储选定线程的堆？

实际上，在多线程应用程序或其他应用程序中，我实际上根本不知道任何用于转储 Haskell 堆的工具。如果您愿意，可以使用诸如[Vacuum](http://hackage.haskell.org/package/vacuum)之类的包转储可从特定对象访问的堆部分的表示。过去，我曾使用[vacuum-cairo](http://hackage.haskell.org/package/vacuum-cairo)来可视化这些转储，并取得了巨大的成功。

有关更多信息，您可能会喜欢中间的两个部分，“约定”和“外国进口”，从我[的多线程 gtk2hs 编程简介](http://dmwit.com/gtk2hs/)，以及“非线程运行时”部分的部分内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-12T19:34:11.697

我不会尝试直接回答您的问题，而是尝试为如何实现多线程 Haskell 程序提供一个概念模型。我将忽略许多细节和复杂性。

操作系统使用[硬件中断实现](http://en.wikipedia.org/wiki/Interrupt)[抢占式多线程](http://en.wikipedia.org/wiki/Preemption_%28computing%29)，以允许多个计算“线程”同时在同一内核上逻辑运行。

操作系统提供的线程往往很重。它们非常适合某些类型的“多线程”应用程序，并且在 Linux 等系统上，它们基本上是允许多个程序同时运行的相同工具（它们擅长的任务）。

但是，这些线程对于 Haskell 等高级语言的许多用途来说有点重。本质上，GHC 运行时就像迷你操作系统一样工作，在操作系统线程之上实现自己的“线程”，就像操作系统在内核之上实现线程一样。

从概念上很容易想象像 Haskell 这样的语言会以这种方式实现。评估 Haskell 包括“强制 thunk”，其中 thunk 是一个计算单元，它可能 1\. 依赖于另一个值（thunk）和/或 2\. 创建新的 thunk。

因此，可以想象多个线程同时评估 thunk。一个人会构建一个待评估的 thunk 队列。每个线程将弹出队列的顶部，并评估该 thunk 直到它完成，然后从队列中选择一个新的 thunk。该操作`par`及其同类可以通过向该队列添加一个 thunk 来“激发”新的计算。

将此模型扩展到 IO 操作也不是特别难想象。不是每个简单地强制纯 thunk，我们想象 Haskell 计算的单元会更复杂一些。Psuedo Haskell 用于这样的运行时：

```
type Spark = (ThreadId,Action)
data Action = Compute Thunk | Perform IOAction 
```

注意：这仅用于概念理解，不要认为事情是这样实现的

当我们运行 Spark 时，我们会寻找“抛出”到该线程 ID 的异常。假设我们没有，执行包括强制 thunk 或执行 IO 操作。

显然，我在这里的解释非常随意，忽略了一些复杂性。此外，GHC 团队还撰写了 Marlow 等人的“Runtime Support for Multicore Haskell”等优秀文章。您可能还想查看有关操作系统的教科书，因为它们经常深入探讨如何构建调度程序。

# java - 在滚动条的拇指上注册监听器

> ID：12394269
> 
> 赞同：1
> 
> 时间：2012-09-12T18:30:15.890
> 
> 标签：java, swing, jscrollpane, mouselistener, jscrollbar

我正在使用滚动窗格设置来使用自定义滚动条，除此之外，我还想在滚动条的拇指上安装一个侦听器，这样每当鼠标进入拇指区域时，它就可以改变颜色或边框。我搜索了 BasicScrollBarUI（由我的自定义滚动条 UI 扩展）并找到了 installListeners() 方法，因此我覆盖了它并让它为拇指区域再调用一个侦听器。

SSCCE：

```
public class TestScrollBar extends JFrame {

    public TestScrollBar() {

        JPanel innerPanel = new JPanel();
        innerPanel.setLayout(new BoxLayout(innerPanel, BoxLayout.Y_AXIS));
        for (int i=1; i<=10; i++) {
            innerPanel.add(new JLabel("Label "+i));
            innerPanel.add(Box.createRigidArea(new Dimension(0, 20)));
        }

        JScrollPane scrollPane = new JScrollPane(innerPanel);
        scrollPane.setPreferredSize(new Dimension(innerPanel.getPreferredSize().width, innerPanel.getPreferredSize().height/2));

        scrollPane.getVerticalScrollBar().setUI(new CustomScrollBarUI());

        this.setLayout(new BorderLayout());
        this.add(Box.createRigidArea(new Dimension(0, 20)), BorderLayout.NORTH);
        this.add(Box.createRigidArea(new Dimension(0, 20)), BorderLayout.SOUTH);
        this.add(Box.createRigidArea(new Dimension(20, 0)), BorderLayout.EAST);
        this.add(Box.createRigidArea(new Dimension(20, 0)), BorderLayout.WEST);
        this.add(scrollPane, BorderLayout.CENTER);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                TestScrollBar frame = new TestScrollBar();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
} 
```

还有一个简单的滚动条自定义 UI：

```
public class CustomScrollBarUI extends BasicScrollBarUI {

    @Override
    protected void installListeners() {
        super.installListeners();
        scrollbar.addMouseListener(new CustomListener());
    }

    protected class CustomListener extends MouseAdapter {
        public void mouseEntered(MouseEvent e) {
            if (getThumbBounds().contains(e.getX(), e.getY())) {
                System.out.println("THUMB");
            }
        }
    }
} 
```

当鼠标从右侧或左侧进入拇指区域时，侦听器工作正常，但它并不总是适用于顶部或底部。对于这些侧面，它仅在拇指触摸其中一个按钮时才起作用。例如，当滚动条位于最顶部时，侦听器仅在鼠标从顶部按钮而不是从下方进入拇指区域时才起作用（左右侧除外）。当滚动条触摸减少按钮时，会发生相反的情况（仅适用于右侧/左侧/底部，但不适用于顶部）。当拇指介于两者之间而不接触任何按钮时，则只有左右两侧起作用。如果您运行代码，您可以看到所有这些。

我还尝试使用现有的侦听器之一（而不是创建自己的侦听器）BasicScrollBarUI.TrackListener，我在其中添加了一个仅侦听拇指区域的方法，但结果完全相同：

```
public class CustomScrollBarUI extends BasicScrollBarUI {
    @Override
    protected TrackListener createTrackListener(){
        return new TrackListener();
    }

    protected class TrackListener extends BasicScrollBarUI.TrackListener {
        public void mouseEntered(MouseEvent e) {
            currentMouseX = e.getX();
            currentMouseY = e.getY();
            if (getThumbBounds().contains(currentMouseX, currentMouseY)) {
                System.out.println("THUMB");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:43:05.740

问题是您监听滚动条，这意味着它是拇指和拇指可以移动的区域（轨道）。因此，您在 mouseEntered 方法中的测试条件并不总是正确的。例如，假设拇指在垂直滚动条的顶部，从底部进入意味着您将首先进入滚动条轨道，然后将鼠标移动到拇指区域-->没有鼠标进入事件。

这是您的代码稍作修改的版本。它主要做的也是侦听鼠标“移动”事件（通过将侦听器添加为 MouseMotionListener）并且它按预期工作：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;
import javax.swing.plaf.basic.BasicScrollBarUI;

public class TestScrollBar extends JFrame {

    public static class CustomScrollBarUI extends BasicScrollBarUI {

        @Override
        protected void installListeners() {
            super.installListeners();
            CustomListener listener = new CustomListener();
            scrollbar.addMouseListener(listener);
            scrollbar.addMouseMotionListener(listener);
        }

        protected class CustomListener extends MouseAdapter {
            boolean isInsideThumb = false;

            @Override
            public void mouseEntered(MouseEvent e) {
                handleMouseEvent(e);
            }

            @Override
            public void mouseMoved(MouseEvent e) {
                handleMouseEvent(e);
            }

            @Override
            public void mouseExited(MouseEvent e) {
                handleMouseEvent(e);
            }

            private void handleMouseEvent(MouseEvent e) {
                if (getThumbBounds().contains(e.getX(), e.getY())) {
                    if (!isInsideThumb) {
                        System.out.println("THUMB");
                        isInsideThumb = true;
                    }
                } else {
                    if (isInsideThumb) {
                        System.out.println("OUT OF THUMB");
                        isInsideThumb = false;
                    }
                }
            }
        }
    }

    public TestScrollBar() {

        JPanel innerPanel = new JPanel();
        innerPanel.setLayout(new BoxLayout(innerPanel, BoxLayout.Y_AXIS));
        for (int i = 1; i <= 10; i++) {
            innerPanel.add(new JLabel("Label " + i));
            innerPanel.add(Box.createRigidArea(new Dimension(0, 20)));
        }

        JScrollPane scrollPane = new JScrollPane(innerPanel);
        scrollPane.setPreferredSize(new Dimension(innerPanel.getPreferredSize().width, innerPanel.getPreferredSize().height / 2));

        scrollPane.getVerticalScrollBar().setUI(new CustomScrollBarUI());

        this.setLayout(new BorderLayout());
        this.add(Box.createRigidArea(new Dimension(0, 20)), BorderLayout.NORTH);
        this.add(Box.createRigidArea(new Dimension(0, 20)), BorderLayout.SOUTH);
        this.add(Box.createRigidArea(new Dimension(20, 0)), BorderLayout.EAST);
        this.add(Box.createRigidArea(new Dimension(20, 0)), BorderLayout.WEST);
        this.add(scrollPane, BorderLayout.CENTER);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                TestScrollBar frame = new TestScrollBar();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:31:15.953

可能无法回答您的问题，但是您已经查看了 AdjustmentListener，那么理论上在哪里转换 MousePoint 并不重要，这里有一些关于这个问题的例子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:53:07.737

当您在轨道中而不是拇指中输入鼠标时，将激活 mouseEntered。您的代码仅在您离开赛道并同时进入赛道和拇指时才有效

改用 mouseMove 事件，你会得到它的工作：

```
@Override
public void mouseMoved(MouseEvent e) {
    currentMouseX = e.getX();
    currentMouseY = e.getY();
    if (getThumbBounds().contains(currentMouseX, currentMouseY)) {
        System.out.println("THUMB");
    }
} 
```

# php - Symfony2 创建一个经过身份验证的会话

> ID：12394271
> 
> 赞同：2
> 
> 时间：2012-09-12T18:30:36.620
> 
> 标签：php, authentication, symfony

我需要在 symfony2 中对用户进行身份验证。我遇到的问题是我的用户通过休息服务进行了身份验证。我向该服务发送登录名和密码，然后我收到用户和会话作为响应或错误。

似乎为了授予对防火墙的访问权限，我必须有一个用户提供程序，它扩展了 UserProviderInterface 并需要 loadUserByUsername() 方法。并且在某些时候 symfony 将在提供的用户和登录凭据之间在后台进行密码检查。

如何跳过用户提供程序和 symfony2 登录检查，而是使用自定义身份验证提供程序，该提供程序将使用 symfony2 安全进行正确身份验证，并允许我在安全配置中定义角色和防火墙。

简而言之，我想通过一个rest接口进行身份验证，但使用symfony进行授权。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:58:07.637

您需要扩展*UserAuthenticationProvider*。在那里你可以调用你的休息服务。

有关示例，请参阅此[博客。](http://blog.vandenbrand.org/2012/06/19/symfony2-authentication-provider-authenticate-against-webservice/)

# java - 自定义 EditTextPreference

> ID：12394278
> 
> 赞同：1
> 
> 时间：2012-09-12T18:31:12.977
> 
> 标签：java, android, sharedpreferences

我想自定义我的*EditTextPreference*。我的目标是格式化标题文本。这是我的*prefs.xml的相关部分*

```
<com.widgets.FormattedEditTextPreference
    android:dialogTitle="android password"
    android:summary="password to this app"
    android:inputType="textPassword"
    android:key="sLoginPassw"
    android:title="android password" /> 
```

这是后面的代码：

```
public class FormattedEditTextPreference extends EditTextPreference {
public FormattedEditTextPreference( Context context, AttributeSet attrs, int defStyle ) {
    super( context, attrs, defStyle );
    setDialogTitle( context.getResources().getString( R.string.app_name )+attrs.getAttributeValue( 0 ) );
}

public FormattedEditTextPreference( Context context, AttributeSet attrs ) {
    super( context, attrs );
    setDialogTitle( context.getResources().getString( R.string.app_name )+attrs.getAttributeValue( 0 ) );
}

public FormattedEditTextPreference( Context context ) {
    super( context );
    setDialogTitle( context.getResources().getString( R.string.app_name ) );
}
} 
```

这段代码不够优雅，但可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:36:32.703

不要覆盖 setDialogTitle，在每个构造函数中调用 setDialogTitle("")。它由应用程序使用，但不由 Preference 组件使用。

# oop - 是否有准确映射到数据表的对象的通用术语？

> ID：12394281
> 
> 赞同：0
> 
> 时间：2012-09-12T18:31:21.240
> 
> 标签：oop

我想知道是否有一个通用术语用于精确映射到数据表的对象？例如，一个`user`和一个`article`对象可以直接映射到一个数据库中`user`的`article`表，每个数据库字段对应一个类变量......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T18:37:31.163

`Entities`它们在[JPA 规范](http://en.wikipedia.org/wiki/Java_Persistence_API)中被称为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T22:21:20.433

它们通常被称为实体，但实体通常不需要 1:1 映射到数据库表。但是，您所描述的称为[Active Record 模式](http://en.wikipedia.org/wiki/Active_record_pattern)。

另外，请注意，对象模型和数据库之间很少有精确的 1:1 映射：

*   多对多关系通常使用数据库中的第三个表实现，但通常仅映射到对象模型中具有直接关联的 2 个类（如果关系没有附加属性）
*   可以使用 1、N 或 N + 1 个表在 DB 中以 3 种不同方式对类继承进行建模
*   三元关系在 DB 中使用 3 个表，但可以使用对象模型中的参数化属性进行建模

# ruby-on-rails - 搜索标签 act_as_taggable_on rails

> ID：12394282
> 
> 赞同：4
> 
> 时间：2012-09-12T18:31:28.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3, search, tags

我创建了一个应用程序，其中可以将广告横幅保存到数据库并用属性标记，例如横幅的尺寸（例如 300x250）。

这一切都是使用`acts_as_taggable_on`.

现在我想做的是有一个搜索框，当用户输入尺寸（例如 300x250）时，我的页面将过滤以仅显示标有“300x250”的广告横幅（这不需要用Ajax 或其他任何东西，搜索按钮都可以）

我目前已安装 gem Ransack 进行搜索，但不知道如何将其与`Acts_as_taggable_on`.

有没有一种简单的方法可以让我在我的视图中有一个搜索框，它只搜索标签并只使用标记的对象更新页面？

非常感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-25T14:47:22.113

这很容易。我们只需要为洗劫写出正确的联想。

`reflect_on_all_associations`或`reflections`显示`Banner`具有名为 的关联`:taggable`，该关联导致模型 ActsAsTaggableOn::Tagging，其中`belongs_to`ActsAsTaggableOn::Tag。

那么：

```
@q = Banner.ransack(taggings_tag_name_cont: 'interesting')
@banners = @q.result 
```

当然，可以免费使用其他匹配器，例如`eq`,`in`等等

# c# - 如何通过 C# 中的正则表达式从任何特殊标签中清除 HTML？

> ID：12394285
> 
> 赞同：0
> 
> 时间：2012-09-12T18:31:41.507
> 
> 标签：c#, .net, html, regex

如何通过 C# 中的正则表达式从任何特殊标签中清除 HTML？

这是需要删除的示例 HTML`<font size="-2">`

```
R&amp;usg=AFQjCNFYiDC6u3xOGn4JpO-GF83PjdSbtw&amp;url=http://online.wsj.com/article/SB10000872396390444426404577647060576633348.html"><img src="//nt2.ggpht.com/news/tbn/bm6jvTMtF-PpnM/6.jpg" alt="" border="1" width="80" height="80" /><br /><font size="-2">Wall Street Journal</font></a></font>
            </td> 
```

我知道我们必须以某种方式使用正则表达式，但我不知道如何使用它。

我曾尝试调整此方法，但它会清除所有标签。

```
public string Strip(string text) 
{ 
   return Regex.Replace(text, @”&lt;(.|\n)*?>”, string.Empty); 
} 
```

事实上，我正在寻找一些方法来做这样的事情

```
public string Strip(string text, HTMLTags.Font)
{

} 
```

`HTMLTags.Font`一些 HTML 标记的枚举在哪里

```
enum HTMLTags
{
    Font,
    Div,
    Td
    ...
} 
```

谢谢你的任何线索！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:37:30.833

使用[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)解析 html

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);

foreach (var font in doc.DocumentNode.Descendants("font").ToArray())
{
    font.Remove();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:37:34.390

最好的应该是[Html Agility Pack](http://htmlagilitypack.codeplex.com/)。

它不是正则表达式，但解析器对“真实世界”格式错误的 HTML 非常宽容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T18:38:32.470

虽然[HTMLAgilityPack](http://htmlagilitypack.codeplex.com/)很可能是最好的选择*（因为它允许您针对 HTML 的表示形式的 DOM 执行 LINQ 查询和/或 XPath 查询）*。开始可能如下：

```
public static class HTMLTags
{
    public string Font { get { return "<font>" } }
    public string Div { get { return "<div>" } }
    public string Td { get { return "<td>" } }
} 
```

然后，在您的客户端代码中：

```
public string Strip(string text, HTMLTags.Font)
{
    /* string parse/replace occurances of HTMLTags.Font  */
} 
```

# sql-server - SQL Server 条件左外连接

> ID：12394288
> 
> 赞同：0
> 
> 时间：2012-09-12T18:32:04.670
> 
> 标签：sql-server, conditional, left-join

我什至不确定我的问题标题是否是我的问题的正确术语，但我们开始了。

我有以下查询：

```
SELECT          C.ID, C.Name, RCR.Mandate_Level, COUNT(CRR.ID) as Num_Requirements
FROM            tbl_role_certification_rel as RCR
INNER JOIN      tbl_certification as C
ON              C.ID = RCR.Certification_ID 
LEFT OUTER JOIN tbl_certification_requirement_rel as CRR
ON              CRR.Certification_ID = C.ID
LEFT OUTER JOIN tbl_requirement as RQ
ON              RQ.ID = CRR.Requirement_ID  AND RQ.Status = 'Active'
WHERE           RCR.Role_ID = 15
AND             C.Status = 'Active' 
GROUP BY        C.ID, C.Name, RCR.Mandate_Level, RCR.Sort_Order
ORDER BY        RCR.Sort_Order; 
```

哪个应该返回：

```
5   Certification 2 Optional    2
8   Certification 5 Optional    2
4   Certification 1 Recommended 0 
```

而是返回

```
5   Certification 2 Optional    2
8   Certification 5 Optional    3
4   Certification 1 Recommended 0 
```

认证 5 确实有 3 项相关要求，但其中一项未激活。我曾认为添加`AND RQ.Status = 'Active'`到第二个左外连接会提供正确的结果，但是在执行查询时它似乎被忽略了。

在此之前我已经在连接上使用了 AND 条件，所以我不确定这次是什么问题。我知道我可以通过执行子查询来解决这个问题，但最好不要这样做。

如有必要，我可以提供表定义和示例数据。

编辑：这是带有数据的表格 - [http://img24.imageshack.us/img24/6598/tablesc.png](http://img24.imageshack.us/img24/6598/tablesc.png) 带有数字的列被定义为整数，带有文本的列是varchars。

# python - 最小化 QTreeWidgetItem 中 QTextEdit 的大小

> ID：12394295
> 
> 赞同：1
> 
> 时间：2012-09-12T18:32:41.363
> 
> 标签：python, pyqt4, qtextedit, sizing, model-view

我有一个 QTreeWidget 填充了一些 itemwidgets，其主要小部件将是一个 QTextEdit。我遇到的问题似乎是将尺寸缩小到可以管理的程度。将大小策略设置为最大值的常用方法似乎不起作用。这是示例代码：

```
from PyQt4.QtGui import *
from PyQt4.QtCore import *

class MyMainWindow(QMainWindow):
    def __init__(self, parent=None):
        QMainWindow.__init__(self, parent)

        self.tree = QTreeWidget(self)
        self.tree.setColumnCount(1)
        self.setCentralWidget(self.tree)

        textEdit = QTextEdit()
        textEdit.setText("very Small Text Edit")
        sizePolicy = QSizePolicy(QSizePolicy.Preferred, QSizePolicy.MinimumExpanding)
        textEdit.setSizePolicy(sizePolicy)

        itemWidget = QTreeWidgetItem()
        itemWidget.setText(0, "")
        self.tree.addTopLevelItem(itemWidget)
        self.tree.setItemWidget(itemWidget, 0, textEdit)        

        biggerTextEdit = QTextEdit()
        biggerTextEdit.setText("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas et mauris in felis tempus molestie eu sit amet sapien. Proin dapibus pretium ipsum. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Pellentesque feugiat semper sem a accumsan. Nulla sollicitudin enim quis velit blandit posuere. Ut fringilla vulputate dolor, a accumsan lectus gravida a. Sed convallis facilisis mi et ullamcorper. Integer consectetur aliquet odio sit amet posuere.")        

        itemWidget2 = QTreeWidgetItem()
        itemWidget2.setText(0, "")
        self.tree.addTopLevelItem(itemWidget2)
        self.tree.setItemWidget(itemWidget2, 0, biggerTextEdit)        

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    ui = MyMainWindow()
    ui.show()
    sys.exit(app.exec_()) 
```

请注意，无论文本的长度如何，似乎对文本编辑的高度都没有任何影响。QTextEdit 如何将自身（至少垂直）缩放到尽可能小的尺寸，并且为了知识，为什么它不像许多其他小部件那样以这种方式表现？提前致谢！

**编辑**：我现在应该注意到，我试图通过使用 QLabel（它在调整大小、显示和文字扭曲方面，就像我想要的那样工作）来欺骗这种效果，并将文本交互标志设置为可编辑。如果有办法访问标签的编辑文本，这几乎是可行的。不幸的是，标签上的任何 .text() 调用都会产生原始文本。QLineEdit 不能是多行或自动换行，QTextEdit 似乎过于复杂。

现在的问题是，什么是创建小（300 个字符或更少）文本显示小部件的最佳小部件，它也可以编辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T14:58:30.017

为了实现您的目标，您必须自定义项目代表，因为它们为您的树小部件提供演示和编辑服务。Qt 文档有一些[关于模型、视图和委托](http://doc.qt.digia.com/4.7-snapshot/model-view-programming.html)的有用信息（包括[教程](http://doc.qt.digia.com/4.7-snapshot/modelview.html)）。以下代码使用委托解决了您的问题：

```
from PyQt4.QtGui import *
from PyQt4.QtCore import *

class MyMainWindow(QMainWindow):
    def __init__(self, parent=None):
        QMainWindow.__init__(self, parent)

        self.tree = QTreeWidget(self)
        self.tree.setColumnCount(1)
        self.tree.setItemDelegate(MyDelegate(self))
        self.setCentralWidget(self.tree)

        itemWidget = QTreeWidgetItem()
        itemWidget.setFlags(itemWidget.flags() | Qt.ItemIsEditable)
        itemWidget.setText(0, "very Small Text Edit")
        self.tree.addTopLevelItem(itemWidget)

        itemWidget2 = QTreeWidgetItem()
        itemWidget2.setFlags(itemWidget.flags() | Qt.ItemIsEditable)
        itemWidget2.setText(0, """very Small Text Edit\n
        very Small Text Edit\n
        very Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Editvery Small Text Edit""")
        self.tree.addTopLevelItem(itemWidget2)

class MyDelegate(QStyledItemDelegate):

    def sizeHint(self, option, index):
        default = QStyledItemDelegate.sizeHint(self, option, index)
        return QSize(default.width(), default.height() + 12)

    def createEditor(self, parent, option, index):
        editor = QTextEdit(parent)
        return editor

    def setEditorData(self, editor, index):
        text = index.model().data(index, Qt.DisplayRole).toString()
        editor.setText(text)

    def setModelData(self, editor, model, index):
        model.setData(index, QVariant(editor.toPlainText()))

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    ui = MyMainWindow()
    ui.show()
    sys.exit(app.exec_()) 
```

该代码包含对`sizeHint()`. 另请注意，您可以`QTextEdit`在`createEditor`方法中自定义您的。您可能也想重新实现该`paint()`方法（这取决于您的需要）。

请注意，子类`QTreeWidgetItem`化不是要走的路（它甚至不是 a `QWidget`）。然而`QTreeWidget`，这是一个使用预定义树模型的便利类，因此在模型/视图编程框架中解决问题是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-13T11:07:35.080

我想出了一个解决方案，其中涉及子类化`QTextEdit`而不是`QStyledItemDelegate`. 新`QTextEdit`的根据内容计算它需要的高度。然后我使用信号将计算出的高度提供给`QTreeWidgetItem`'s 。`setSizeHint()`

下面的代码（PS我正在使用PyQt5）

```
import sys
from PyQt5 import QtWidgets
from PyQt5.QtCore import Qt, pyqtSignal, QSize

class AdjustableTextEdit(QtWidgets.QTextEdit):

    td_size_sig=pyqtSignal(QSize)
    def __init__(self,parent=None):
        super(AdjustableTextEdit,self).__init__(parent)

        self.setVerticalScrollBarPolicy(Qt.ScrollBarAlwaysOff)
        self.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOff)
        self.textChanged.connect(self.resizeTextEdit)
        self.document().documentLayout().documentSizeChanged.connect(
                self.resizeTextEdit)

    def resizeTextEdit(self):

        docheight=self.document().size().height()
        margin=self.document().documentMargin()
        self.setMinimumHeight(docheight+2*margin)
        self.setMaximumHeight(docheight+2*margin)
        return

    def resizeEvent(self,e):
        super(AdjustableTextEdit,self).resizeEvent(e)
        self.td_size_sig.emit(QSize(self.sizeHint().width(),
            self.maximumHeight()))
        return

class MainFrame(QtWidgets.QFrame):

    def __init__(self,parent=None):
        super(MainFrame,self).__init__(parent)

        ha=QtWidgets.QHBoxLayout(self)
        self.tree=QtWidgets.QTreeWidget(self)
        ha.addWidget(self.tree)

        self.addTextEditWidget('very small text edit')
        self.addTextEditWidget("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas et mauris in felis tempus molestie eu sit amet sapien. Proin dapibus pretium ipsum. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Pellentesque feugiat semper sem a accumsan. Nulla sollicitudin enim quis velit blandit posuere. Ut fringilla vulputate dolor, a accumsan lectus gravida a. Sed convallis facilisis mi et ullamcorper. Integer consectetur aliquet odio sit amet posuere.")

        self.show()

    def addTextEditWidget(self,text):

        textEdit = AdjustableTextEdit()
        textEdit.setText(text)

        itemWidget = QtWidgets.QTreeWidgetItem()
        itemWidget.setText(0, "")

        self.tree.addTopLevelItem(itemWidget)
        self.tree.setItemWidget(itemWidget, 0, textEdit)
        textEdit.td_size_sig.connect(lambda size: itemWidget.setSizeHint(0,size))

if __name__ == "__main__":
    app = QtWidgets.QApplication(sys.argv)
    ui = MainFrame()
    sys.exit(app.exec_()) 
```

# java - 在单个视图上显示多个表单时的表单验证

> ID：12394298
> 
> 赞同：0
> 
> 时间：2012-09-12T18:33:01.863
> 
> 标签：java, servlets

我有这个由 BalusC 提供的抽象表单类，它设置验证消息

```
 public abstract class Form {

// Properties 
private Map messages = new LinkedHashMap();
private List formFeedback = new ArrayList();
private List errorMessages = new ArrayList();
private boolean hasError; 
```

然后我有一堆扩展表单的类

```
public class ParentForm extends Form { 
public class SubForm1 extends Form {
public class SubForm2 extends Form {
public class SubForm3 extends Form { 
```

在 parentForm 我调用每个子表单，但我不知道如何将验证消息从子表单传递给父表单。

```
public class ParentForm extends Form { 

  public Object update(HttpServletRequest request) {

    pseudo code
     //if subform1 is being edited
     SubForm1 subForm1 = new SubForm1 (authenticatedUser);
     subFormBean1 sfb1 = new subFormBean1 ();
     sfb1 = subForm1.update(request);

     //if subform2 is being edited
     SubForm2 subForm2 = new SubForm2 (authenticatedUser);
     subFormBean2 sfb2 = new subFormBean2 ();
     sfb2 = subForm2.update(request); 
```

父`Form`服务使用 Struts 风格的 Action 在 servlet 中执行

# 类更新动作

```
public class UpdateAction implements ControllerAction {

private Form form;
private Object obj;
private HashMap modelMap;

    public UpdateAction(HashMap modelMap, Form form, Object obj) {
    this.form = form;
    this.obj = obj;
    this.modelMap = modelMap;
}

public void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    obj = form.update(request);
            request.setAttribute("obj", obj);
            request.setAttribute("form", form); 
```

在我的jsps中我会放

`<span class="formError"><c:out value="${form.messages.whatever}" />`但这仅从父表单中获取消息，而不是从任何子表单中获取消息

我想知道像 `form[subForm].messages.whatever 这样的东西是否可行？就像是

```
 if (!sfb1.notSuccess) {
 parentForm.setSubFormMessages(sfb1.getMessages());
 } 
```

我的项目有点长，但基本上我希望 HTML 页面上的部分（组件？？）是 HTML 表单，仅在某些条件下才有效（它是我们用来在办公室手动路由的清单的工作流程应用程序) 想知道是否最好将其吸收并移植到 JSF 或修改 Form 类。

**编辑** 我正在尝试实现抽象子表单，但现在子表单上的类似内容仍会更新 Dao，即使说我的条目验证（processEntry）失败

```
 processEntry(request, ad);
  processEdit_date(request, ad);
  if (isSucces()) {
    dao.update(ad, authenticatedUser);
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T11:08:41.220

您基本上应该`ParentForm`在子表单的构建过程中通过。

```
SubForm1 subForm1 = new SubForm1(this, authenticatedUser); 
```

和

```
public SubForm1(Form parent, User authenticatedUser) {
    this.parent = parent;
    this.authenticatedUser = authenticatedUser;
} 
```

然后在`SubForm1`委托中向它发送消息

```
public addMessage(field, message) {
    parent.addMessage(field, message);
} 
```

要保持`SubForm1`,`SubForm2`等 DRY，您可以按照包装模式创建另一个抽象类：

```
public abstract class SubForm extends Form {

    private Form parent;

    public SubForm(Form parent) {
        this.parent = parent;
    }

    public addMessage(field, message) {
        parent.addMessage(field, message);
    }

    // ...
} 
```

然后设计`SubForm1`,`SubForm2`等如下：

```
public class SubForm1 extends SubForm {

    public SubForm1(Form parent, User authenticatedUser) {
        super(parent);
        this.authenticatedUser = authenticatedUser;
    }

    // ...
} 
```

# xaml - 创建多行 StackPanel

> ID：12394309
> 
> 赞同：1
> 
> 时间：2012-09-12T18:34:52.073
> 
> 标签：xaml, windows-8, microsoft-metro, windows-runtime

我正在尝试在 WinRT 中创建一个堆栈面板，它会在需要时换行到下一行。我尝试过 WrapGrid 和 VariableSizeWrapGrid，但似乎在项目大小和布局方面存在问题。

我的目标是有一个用“，”分隔的名称列表，当我单击名称时，我可以导航到一个新页面，并将 Item 作为导航参数传递。

我不希望物品
像这样排列

如果我使用网格会发生这种情况。相反，我想要类似的东西

名字一、名字二、名字三、
名字四、名字五、名字六

点击一个名字会触发一个事件。每个“名称”都是集合中的一个单独项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:05:33.800

我的第一个想法是，这听起来不太像地铁。话虽如此，[这个](https://github.com/Q42/Q42.WinRT)图书馆有你想要的。

> WrapPanel - 从 Silverlight 移植的 WrapPanel. 允许可变大小的控件并在需要时换行。

有一篇关于它来自何处的帖子以及位于[此处](http://www.michielpost.nl/PostDetail_75.aspx)的示例应用程序。

如果这不是您所需要的，您应该能够很容易地将其修改为您想要的。

# jquery - 运行 jQuery 以更快地应用到每个元素而没有冗余

> ID：12394311
> 
> 赞同：0
> 
> 时间：2012-09-12T18:34:56.697
> 
> 标签：jquery, performance, redundancy

以下脚本可以很好地截断链接并添加图标类，但是**太慢了：** 使用***document.ready*** 阻止代码执行直到加载页面上的所有元素。

我删除了它，它可以工作，但它不适用于最后一个元素

```
<script>

         jQuery.noConflict();

         jQuery(".resultAction").each(function(){ 

    var fileName =  jQuery(this).find('a').html()
    var fileExtension = fileName.substring(fileName.lastIndexOf('.') );
    var nameChars= fileName.length;
    var shorter=fileName.substring(0,10)+"...";
           //apply style to relative to file extension
        if(fileExtension=="jpg"||"pdf"||"mov"){
        jQuery(this).find("#indicator").addClass("is" + fileExtension.slice(1) );
        }
           //no file extension hide the icon div "indicator"
        if((fileExtension.indexOf('.') == -1)){
        jQuery(this).find("#indicator").addClass("not");
        }
            //truncate text
        if(nameChars>10){
            jQuery(this).find('a').text(shorter);
        }
         });

    </script> 
```

所以我摆脱了上面的 .ready 并再次添加了这个：

```
<script>
jQuery(document).ready(function(){
jQuery.noConflict();
jQuery(".resultAction:last").each(function(){ 
//-SAME CODE ABOVE-....
</script> 
```

-注意 :last -当然可以 - 但它是多余的，我想知道是否有一种更有效的方法可以使此代码**立即**运行（当页面加载每个元素时）并且**完全** *而不是*运行两个相同的**脚本**跑得快，一个应用到它错过的最后一个项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:40:56.100

公共代码可以放在一个函数中，并从您使用它的两个地方调用，因此只有一个代码副本，但可以从多个地方调用。

```
jQuery(".resultAction:last").each(processResult); 
```

和

```
jQuery(".resultAction").each(processResult); 
```

至于加速`jQuery(".resultAction:last")`，有一些选择：

1.  给最后一个 id 并直接使用 id 获取它。
2.  与其在 domReady 上运行它，不如从`<body>`. 这将比 domReady 执行得快一点并且同样安全。
3.  `jQuery(".resultAction")`只进行一次查询并保存该结果。然后，您可以随时使用整个列表或最后一个列表，而无需任何进一步的 DOM 查找。
4.  如果速度真的是个问题，jQuery 通常不是最快的处理方式（尽管速度差异通常不会被注意到）。例如，`document.getElementById("item")`比 . 快 10 倍以上`jQuery("#item")`。

此外，这段代码可能有问题：

```
jQuery(this).find("#indicator") 
```

整个文档中应该只有一个`#indicator`id，因此您不需要将其限制在`this`上下文中。因此，您可以只使用`$("#indicator")`这样的一个对象，或者您需要使用类而不是 id，因为页面中有多个这样的对象。

# node.js - Mongo 遭受大量故障

> ID：12394313
> 
> 赞同：10
> 
> 时间：2012-09-12T18:35:04.980
> 
> 标签：node.js, mongodb

我在我的 mongostat 输出中看到了一个巨大的（~200++）故障/秒数，尽管锁定百分比非常低：

![在此处输入图像描述](../Images/b5004ad8c984a5f566dacd472381973e.png)

我的 Mongo 服务器在亚马逊云上的 m1.large 实例上运行，因此它们每个都有 7.5GB 的 RAM ::

```
root:~# free -tm
             total       used       free     shared    buffers     cached
Mem:          7700       7654         45          0          0       6848 
```

显然，我没有足够的内存来满足所有 cahin mongo 想要做的事情（顺便说一句，由于磁盘 IO，导致 CPU 使用率很高）。

我发现[这个文档](http://www.scribd.com/doc/56271132/MongoDB-Performance-Tuning)表明在我的场景中（高故障，低锁定百分比），我需要“横向扩展读取”和“更多磁盘 IOPS”。

我正在寻找有关如何最好地实现这一目标的建议。也就是说，我的 node.js 应用程序执行了很多不同的潜在查询，我不确定瓶颈发生在哪里。当然，我试过

```
db.setProfilingLevel(1); 
```

但是，这对我没有多大帮助，因为输出的统计信息只是显示我的查询速度很慢，但我很难将这些信息翻译成查询导致页面错误的信息......

如您所见，这导致我的 PRIMARY mongo 服务器上的 CPU 等待时间很长（几乎 100%），尽管 2x SECONDARY 服务器不受影响......

![在此处输入图像描述](../Images/06fdff60c2afc62ae4343857007db6e3.png)

以下是 Mongo 文档对页面错误的评价：

> 页面错误表示 MongoDB 需要不在物理内存中的数据，并且必须从虚拟内存中读取的次数。要检查页面错误，请参阅 serverStatus 命令中的 extra_info.page_faults 值。此数据仅在 Linux 系统上可用。
> 
> 单独的页面错误很小并且很快完成；然而，总的来说，大量的页面错误通常表明 MongoDB 从磁盘读取了过多的数据，并且可以表明许多潜在的原因和建议。在许多情况下，MongoDB 的读锁会在页面错误后“让出”以允许其他进程读取并避免在等待下一页读入内存时阻塞。这种方法提高了并发性，在大容量系统中，这也提高了整体吞吐量。
> 
> 如果可能，增加 MongoDB 可访问的 RAM 量可能有助于减少页面错误的数量。如果这不可行，您可能需要考虑部署一个分片集群和/或在您的部署中添加一个或多个分片以在 mongod 实例之间分配负载。

所以，我尝试了推荐的命令，这非常无用：

```
PRIMARY> db.serverStatus().extra_info
{
    "note" : "fields vary by platform",
    "heap_usage_bytes" : 36265008,
    "page_faults" : 4536924
} 
```

当然，我可以增加服务器大小（更多 RAM），但这很昂贵，而且似乎有点矫枉过正。我应该实现分片，但我实际上不确定哪些集合需要分片！因此，我需要一种方法来隔离故障发生的位置（哪些特定命令导致故障）。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T18:50:00.530

我们真的不知道您的数据/索引是什么样的。

尽管如此，MongoDB 优化的一个重要规则是：
确保您的索引适合 RAM。[http://www.mongodb.org/display/DOCS/Indexing+Advice+and+FAQ#IndexingAdviceandFAQ-MakesureyourindexescanfitinRAM](http://www.mongodb.org/display/DOCS/Indexing+Advice+and+FAQ#IndexingAdviceandFAQ-MakesureyourindexescanfitinRAM)。

考虑到您的文档越小，您的密钥/文档比率就越高，您的 RAM/磁盘大小比率就需要越高。

如果您可以稍微调整架构以将一些数据集中在一起，并减少所需的键数量，那可能会有所帮助。

# mysql - 使用 MySQL 的 LOAD DATA INFILE 处理转义的字段分隔符

> ID：12394317
> 
> 赞同：0
> 
> 时间：2012-09-12T18:35:44.783
> 
> 标签：mysql, escaping, load-data-infile

我正在使用`LOAD DATA INFILE`将二十个 | 分隔的 .dat 文件导入 MySQL 表。但有些| 字段终止符用反斜杠转义。下面的第二个字段是一个示例：

```
1001604|EMERITUS CORP\WA\|SC 13G|1996-02-13|edgar/data/1001604/0000728757-96-000006.txt
1001604|EMERITUS CORP\WA\|SC 13G|1996-02-14|edgar/data/1001604/0000903949-96-000038.txt 
```

`DATE`我收到一个错误，因为最后一个字段与为倒数第二个字段声明的类型冲突。我可以打开 .dat 文件并逃脱转义，但有更好的方法吗？

我可以使用流编辑器将所有反斜杠加倍，但这似乎是个坏主意。我可以安全地将选项更改为`FIELDS ESCAPED BY`“\”以外的选项，还是这是个坏主意？谢谢！

这是我的`LOAD DATA INFILE`命令：

```
LOAD DATA INFILE 'C:/users/richard/research/data/edgar/masterfiles/master_1996.dat'
    INTO TABLE edgar.master
    FIELDS TERMINATED BY '|'
    IGNORE 1 LINES; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:08:53.540

添加`ESCAPED BY ''`到我的`FIELDS`子句允许查询完成而不会出错。如果我发现这导致静默失败，我会更新。

# r - R - geom_density() 使用什么算法以及如何提取曲线的点/方程？

> ID：12394321
> 
> 赞同：18
> 
> 时间：2012-09-12T18:36:07.793
> 
> 标签：r, ggplot2

我想知道 geom_density() 到底在做什么，所以我证明了图表的合理性，以及是否有任何方法可以提取为每条绘制的曲线生成的函数或点。

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-12T19:00:28.853

键入`get("compute_group", ggplot2::StatDensity)`（或以前称为`get("calculate", ggplot2:::StatDensity)`）将为您提供用于计算密度的算法。`density()`（在根目录下，这是对`kernel="gaussian"`默认值的调用。）

图中使用的点由 无形返回`print.ggplot()`，因此您可以像这样访问它们：

```
library(ggplot2)
m <- ggplot(movies, aes(x = rating))
m <- m + geom_density()
p <- print(m)
head(p$data[[1]], 3)
#           y      x   density   scaled  count PANEL group ymin      ymax
# 1 0.0073761 1.0000 0.0073761 0.025917 433.63     1     1    0 0.0073761
# 2 0.0076527 1.0176 0.0076527 0.026888 449.88     1     1    0 0.0076527
# 3 0.0078726 1.0352 0.0078726 0.027661 462.81     1     1    0 0.0078726

## Just to show that those are the points you are after, 
## extract and use them to create a lattice xyplot 
library(gridExtra)
library(lattice)
mm <- xyplot(y ~x, data=p$data[[1]], type="l") 
```

![在此处输入图像描述](../Images/5a5b7ab881e802ab77da91f57a310c82.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-05-05T15:16:19.573

正如其他答案中所建议的，您可以使用`print.ggplot()`. 但是，`print()`-ing 代码也会打印 ggplot 对象，这可能不是我们想要的。

您可以使用以下方法提取 ggplot 对象数据，而*无需打印绘图*`ggplot_build()`：

```
library(ggplot2)
library(ggplot2movies)

m <- ggplot(movies, aes(x = rating))
m <- m + geom_density()
p <- ggplot_build(m)  # <---- INSTEAD OF `p <- print(m)`
head(p$data[[1]], 3)
#             y        x     density     scaled    count     n PANEL group ymin
# 1 0.007376115 1.000000 0.007376115 0.02591684 433.6271 58788     1    -1    0
# 2 0.007652653 1.017613 0.007652653 0.02688849 449.8842 58788     1    -1    0
# 3 0.007872571 1.035225 0.007872571 0.02766120 462.8127 58788     1    -1    0

# Just to show that those are the points you are after, extract and use them 
# to create a lattice xyplot 
library(lattice)
m2 <- xyplot(y ~x, data=p$data[[1]], type="l")

library(gridExtra)
grid.arrange(m, m2, nrow=1) 
```

[![在此处输入图像描述](../Images/af8bdd794b662df39a2ca229eda2f8d3.png)](https://i.stack.imgur.com/BmbDl.png)

# c# - 'object' 不包含在 ascx 文件中使用中继器的定义错误

> ID：12394323
> 
> 赞同：0
> 
> 时间：2012-09-12T18:36:16.947
> 
> 标签：c#, asp.net, linq-to-sql, user-controls

我有一个名为“Entries”的表，并且正在使用 LINQ to SQL 进行数据访问。我创建了一个获取所有条目的存储过程。我已将该存储过程映射到我的数据上下文中的一个方法，我已将返回类型设置为“条目”。

我在我的数据访问类中创建了一个方法，该方法将该方法调用的结果作为列表返回。我将列表绑定到用户控件中的转发器，并尝试访问我的 ascx 文件中的属性“EntryId”，并收到以下错误：

“object”不包含“EntryId”的定义

我在 DataAccess 类中的方法：

```
public static List<Entry> GetAllEntries()
{
    using (DataClassesDataContext context = new DataClassesDataContext())
    {
        return context.fbGetAllEntries().ToList();
    }
} 
```

并在用户控件的 Page_PreRender 事件中：

```
//my alias at the top of the file for clairification
using ASPWebControls = System.Web.UI.WebControls;

protected void Page_PreRender(System.Object sender, System.EventArgs e)
{
   rptEntries = new ASPWebControls.Repeater();

   rptEntries.DataSource = DataAccess.GetAllEntries();

   rptEntries.DataBind();
} 
```

在我的 ascx 文件中：

```
<asp:Repeater ID = "rptEntries" runat = "server" >
    <ItemTemplate>
        <tr>
            <td><input type="checkbox" runat="server"  value="<%# Container.DataItem.EntryId %>"  /></td>
        </tr>
    </ItemTemplate>
</asp:Repeater> 
```

当我用谷歌搜索这个错误时，我发现使用匿名类型时可能会发生这种情况，但这里不是这种情况。我确信我的转发器有一个绑定到它的强类型对象列表。我试过明确地铸造：

```
rptEntries.DataSource = (List<Entry>)DataAccess.GetAllEntries(); 
```

我确定我的 Entry 类型有一个 EntryId，因为我可以这样做：

```
foreach (Entry en in (List<Entry>)rptEntries.DataSource)
{
   //when I step through I can see these are the correct values
   int i = en.EntryId;
} 
```

我尝试在我的 ascx 文件中导入我的命名空间：

```
<%@ Import NameSpace="Namespace.in.my.DataClass.cs" %> 
```

我不确定事情在哪里横向发展，有人可以建议我做错了什么吗？任何帮助将不胜感激，谢谢！

编辑：错过了一个代码块

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:39:52.453

即使项目是强类型的，中继器控件也会将它们作为对象类型公开在`ItemTemplate`. 您需要明确地将其拆箱：

```
<%# ((Entry)Container.DataItem).EntryId %> 
```

请注意，[ASP.Net 4.5](http://www.asp.net/vnext/overview/whitepapers/whats-new)有一个[强类型的转发器](http://www.sitepoint.com/asp-net-4-5-strongly-typed-data-controls-model-binding/)，它允许您指定一个`ItemType`属性并消除拆箱的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T18:39:23.950

在复选框的数据绑定语句中尝试以下操作：

```
 value="<%# Eval("EntryId") %>" 
```

# ruby - 使用 ruby 通过 https 访问 api

> ID：12394324
> 
> 赞同：0
> 
> 时间：2012-09-12T18:36:27.727
> 
> 标签：ruby, api, ssl, https, google-api

我正在编写一个脚本来使用谷歌购物 api 进行价格跟踪。当我用 curl 或网络浏览器点击这个 url 时，它会加载数据。

[https://www.googleapis.com/shopping/search/v1/public/products?key=AIzaSyC24EXbQZ1X7KmaKLJ-Bd9SKgOx4x9ob-M&country=US&q=digital+camera](https://www.googleapis.com/shopping/search/v1/public/products?key=AIzaSyC24EXbQZ1X7KmaKLJ-Bd9SKgOx4x9ob-M&country=US&q=digital+camera)

但是，当我使用这个 ruby​​ 脚本时

```
require "rubygems"
require "net/https"

@url = 'https://www.googleapis.com/shopping/search/v1/public/products?key=AIzaSyCGGKfldgrPQsXAJw5Dbn1M3QWZ9vqVyBQ&country=US&q=digital+camera'
uri = URI.parse @url
http = Net::HTTP.new(uri.host, 443)
http.use_ssl = true 
http.verify_mode = OpenSSL::SSL::VERIFY_PEER
http.ca_file = File.join(File.dirname(__FILE__), "./cacert.pem")
http.start { http.request_get(uri.path) {|res| print res.body } } 
```

我收到此错误：

```
"error": {
  "errors": [
   {
    "domain": "usageLimits",
    "reason": "dailyLimitExceededUnreg",
    "message": "Daily Limit Exceeded. Please sign up",
    "extendedHelp": "https://code.google.com/apis/console"
   }
  ],
  "code": 403,
  "message": "Daily Limit Exceeded. Please sign up"
 }
} 
```

我的理论是错误来自我的 ruby​​ 代码如何不正确地使用 https。cacert.pem 来自 curl.haxx.se/ca/cacert.pem 我需要做什么才能通过 https 访问 api？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:47:37.223

这个错误对我来说看起来很不言自明。每日限额是多少？你提出了多少要求？

# svn - 使用 TortoiseSVN 合并 .sql 文件

> ID：12394329
> 
> 赞同：0
> 
> 时间：2012-09-12T18:36:48.263
> 
> 标签：svn, merge, tortoisesvn, redgate

我使用 Red Gates SVN Source Control 将 2 个数据库（一个基本上从另一个分支）添加到存储库，一个作为主干，另一个作为分支。我现在正试图将分支合并回主干，但我得到的只是 .sql 文件上的树冲突。我已启用 enable-auto-props = yes 并在配置文件中设置 *.sql = svn:mime-type=text/plain。我错过了什么吗？我希望能够像普通代码一样进行逐行合并，并且拥有更改日志也很方便。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:30:39.860

这原来是我的问题： [SVN 如何在两个分支上添加文件时解决新树冲突](https://stackoverflow.com/questions/767763/svn-how-to-resolve-new-tree-conflicts-when-file-is-added-on-two-branches)

由于我只对主干和分支进行了“初始提交”，因此添加了文件的两个版本，因此发生了冲突。所以解决方案是使用外部合并工具，然后提交更改。这个问题确实需要一个更优雅的解决方案。

# sql - 显示前 n 条记录并合并其余行

> ID：12394331
> 
> 赞同：3
> 
> 时间：2012-09-12T18:37:02.377
> 
> 标签：sql, sql-server, sql-server-2005

我对编写 SQL 比较陌生。我有一个要求，我必须按原样显示前 5 条记录，并将其余记录合并为 1 条记录并将其附加为第 6 条记录。我知道前 5 个选择前 5 个记录，但我发现很难组合一个逻辑来合并其余记录并将其附加到结果集的底部。

```
weekof          sales    year    weekno
-------------------------------------------------------------
07/01 - 07/07   2   2012    26  
07/08 - 07/14   2   2012    27  
07/29 - 08/04   1   2012    30  
08/05 - 08/11   1   2012    31  
08/12 - 08/18   32  2012    32  
08/26 - 09/01   2   2012    34  
09/02 - 09/08   8   2012    35  
09/09 - 09/15   46  2012    36   
09/16 - 09/22   26  2012    37 
```

* * *

我希望这显示为

```
weekof          sales
----------------------
09/16 - 09/22   26  
09/09 - 09/15   46  
09/02 - 09/08   8   
08/26 - 09/01   2   
08/12 - 08/18   32  
07/01 - 08/11   6 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-12T19:35:35.833

除非跨越数年，否则这将以正确的顺序`weekof`获得您想要的数据*：*

```
;WITH x AS 
(
  SELECT weekof, sales, 
    rn = ROW_NUMBER() OVER (ORDER BY [year] DESC, weekno DESC) 
  FROM dbo.table_name
)
SELECT weekof, sales FROM x WHERE rn <= 5
UNION ALL
SELECT MIN(LEFT(weekof, 5)) + ' - ' + MAX(RIGHT(weekof, 5)), SUM(sales)
FROM x WHERE rn > 5    
ORDER BY weekof DESC; 
```

当返回的行跨越一年时，您可能还必须返回 rn（并在表示层忽略它）：

```
;WITH x AS 
(
  SELECT weekof, sales, 
    rn = ROW_NUMBER() OVER (ORDER BY [year] DESC, weekno DESC) 
  FROM dbo.table_name
)
SELECT weekof, sales, rn FROM x WHERE rn <= 5
UNION ALL
SELECT MIN(LEFT(weekof, 5)) + ' - ' + MAX(RIGHT(weekof, 5)), SUM(sales), rn = 6 
FROM x WHERE rn > 5
ORDER BY rn; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T01:36:37.207

这是一个替代版本，即使跨年也能以正确的顺序显示，并且需要一次扫描而不是两次（仅当数据量很大时才重要）。它将在 SQL 2005 及更高版本中工作：

```
WITH Sales AS (
   SELECT
      Seq = Row_Number() OVER (ORDER BY S.yr DESC, S.weekno DESC),
      *
   FROM dbo.SalesByWeek S
)
SELECT
   weekof =
      Substring(Min(Convert(varchar(11), S.yr) + Left(S.weekof, 5)), 5, 5)
      + ' - '
      + Substring(Max(Convert(varchar(11), S.yr) + Right(S.weekof, 5)), 5, 5),
   sales = Sum(S.sales)
FROM
   Sales S
   OUTER APPLY (SELECT S.Seq WHERE S.Seq <= 5) G
GROUP BY G.Seq   
ORDER BY Coalesce(G.Seq, 2147483647)
; 
```

还有一个查询可能对非常大的数据集执行得更好，因为它不计算行号（改为使用 TOP 一次）。但这都是理论上的，没有真实的数据和性能测试：

```
SELECT
   weekof =
      Substring(Min(Convert(varchar(11), S.yr) + Left(S.weekof, 5)), 5, 5)
      + ' - '
      + Substring(Max(Convert(varchar(11), S.yr) + Right(S.weekof, 5)), 5, 5),
   sales = Sum(S.sales)
FROM
   dbo.SalesByWeek S
   LEFT JOIN (
      SELECT TOP 5 *
      FROM dbo.SalesByWeek
      ORDER BY yr DESC, weekno DESC
   ) G ON S.yr = G.yr AND S.weekno = G.weekno
GROUP BY G.yr, G.weekno
ORDER BY Coalesce(G.yr, 9999), G.weekno
; 
```

最终，我真的不喜欢使用字符串操作来提取日期范围。如果表格将`MinDate`and`MaxDate`作为单独的列会更好，然后为它们创建标签会更简单。

# r - 如何仅获取特定行的列均值？

> ID：12394332
> 
> 赞同：11
> 
> 时间：2012-09-12T18:37:06.697
> 
> 标签：r, dataframe, mean

我需要获取特定行（此处：年份）的一列（此处：分数）的平均值。具体来说，我想知道三个时期的平均分：

*   第 1 期：年 <= 1983
*   第 2 期：年 >= 1984 & 年 <= 1990
*   第 3 期：年 >= 1991

这是我的数据结构：

```
 country year     score        
 Algeria 1980     -1.1201501 
 Algeria 1981     -1.0526943 
 Algeria 1982     -1.0561565 
 Algeria 1983     -1.1274560 
 Algeria 1984     -1.1353926 
 Algeria 1985     -1.1734330 
 Algeria 1986     -1.1327666 
 Algeria 1987     -1.1263586 
 Algeria 1988     -0.8529455 
 Algeria 1989     -0.2930265 
 Algeria 1990     -0.1564207 
 Algeria 1991     -0.1526328 
 Algeria 1992     -0.9757842 
 Algeria 1993     -0.9714060 
 Algeria 1994     -1.1422258 
 Algeria 1995     -0.3675797 
 ... 
```

计算的平均值应添加到附加列（“平均值”）中的 df 中，即第 1 期年份的平均值相同，第 2 期年份的平均值等。

它应该是这样的：

```
country year     score         mean   
 Algeria 1980     -1.1201501     -1.089
 Algeria 1981     -1.0526943     -1.089
 Algeria 1982     -1.0561565     -1.089
 Algeria 1983     -1.1274560     -1.089
 Algeria 1984     -1.1353926     -0.839
 Algeria 1985     -1.1734330     -0.839
 Algeria 1986     -1.1327666     -0.839
 Algeria 1987     -1.1263586     -0.839
 Algeria 1988     -0.8529455     -0.839
 Algeria 1989     -0.2930265     -0.839
 Algeria 1990     -0.1564207     -0.839
 ... 
```

我尝试过的每条可能的路径都很容易变得超级复杂——我必须计算 90 多个国家/地区不同时间段的平均分数……

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-12T18:44:32.477

```
datfrm$mean <-
  with (datfrm, ave( score, findInterval(year, c(-Inf, 1984, 1991, Inf)), FUN= mean) ) 
```

标题问题与实际问题有点不同，可以通过使用逻辑索引来回答。如果只想要特定子集的平均值，`year >= 1984 & year <= 1990`则可以通过以下方式完成：

```
mn84_90 <- with(datfrm, mean(score[year >= 1984 & year <= 1990]) ) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T19:01:40.973

~~由于`findInterval`需要`year`进行排序（如您的示例中所示），我很想使用`cut`以防它未排序~~[证明是错误的，感谢@DWin]。为了完整起见，`data.table`等价物（大数据的比例）是：

```
require(data.table)
DT = as.data.table(DF)   # or just start with a data.table in the first place

DT[, mean:=mean(score), by=cut(year,c(-Inf,1984,1991,Inf))] 
```

或者`findInterval`像 DWin 使用的那样可能更快：

```
DT[, mean:=mean(score), by=findInterval(year,c(-Inf,1984,1991,Inf))] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-31T19:58:56.730

如果这些行按年份排序，我认为最简单的方法是：

```
m80_83 <- mean(dataframe[1:4,3]) #Finds the mean of the values of column 3 for rows 1 through 4
m84_90 <- mean(dataframe[5:10,3])
#etc. 
```

如果行不是按年份排序的，我会像这样使用tapply。

```
list.of.means <- c(tapply(dataframe$score, cut(dataframe$year, c(0,1983.5, 1990.5, 3000)), mean) 
```

在这里，tapply 需要三个参数：

首先，您想要处理的数据（在本例中为 datafram$score）。

其次，将数据分成组的功能。在这种情况下，它将根据 dataframe$year 值将数据分成三组。第 1 组将包括 dataframe$year 值从 0 到 1983.5 的所有行，第 2 组将包括 dataframe$year 值从 1983.5 到 1990.5 的所有行，第 3 组将包括 dataframe$year 值从 1983.5 到 3000 的所有行。

第三，应用于每个组的功能。此函数将应用于您选择作为第一个参数的数据。

因此， list.of.means 应该是您正在寻找的 3 个值的列表。

# web-services - 如何发送频繁的实时服务器端状态更新消息？

> ID：12394333
> 
> 赞同：2
> 
> 时间：2012-09-12T18:37:08.860
> 
> 标签：web-services, webserver, websocket

我有一个监听 jQuery 键盘事件的 Web 服务器，我想将一组键的状态字符串发送到另一个域进行处理。

什么技术/语言/协议能够在服务器端做到这一点？

它必须能够在立即更改时发送更新的状态消息，如箭头键之类的键盘事件所侦听。

这不是标准的服务器 <-> 客户端更新，而是客户端 > 服务器 > 另一台服务器。

可以使用 WebSocket 来创建到远程位置的服务器端连接，而不是客户端吗？ [https://en.wikipedia.org/wiki/WebSockets](https://en.wikipedia.org/wiki/WebSockets)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-23T10:04:14.540

> 什么技术/语言/协议能够在服务器端做到这一点？

任何现代服务器端语言都可以做到，node.js、c#、python、php。只需写下您的条件并从您的服务器作为客户端发出请求。

> 可以使用 WebSocket 来创建到远程位置的服务器端连接，而不是客户端吗？

当然！您的服务器可以像任何其他设备一样是客户端。[NodeJS 示例](http://Can%20a%20WebSocket%20be%20used%20to%20create%20a%20server-side%20connection%20to%20a%20remote%20location,%20not%20a%20client?)

# windows - Windows 批处理：“超时”命令的模拟

> ID：12394338
> 
> 赞同：3
> 
> 时间：2012-09-12T18:37:28.803
> 
> 标签：windows, shell, batch-file

我试图找出如何限制Windows 批处理文件*中的程序执行时间。*有类似 Unix`timeout`命令的东西吗？请指教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T08:37:55.033

为了限制程序必须运行的时间，你可以做这样的事情

```
start yourprogram.exe
timeout /t 10
taskkill /im yourprogram.exe /f 
```

启动`yourprogram.exe`，等待 10 秒，然后终止程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T13:24:00.313

我刚刚安装了[Cygwin](http://www.cygwin.com/)并使用了发行版中的 unix 风格`timeout`的命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T02:03:02.720

此代码等待 60 秒，然后检查 %ProgramName% 是否正在运行。

要增加此时间，请更改 的值`WaitForMinutes`。

要减少检查之间的间隔，请设置`WaitForSeconds`您希望它等待的秒数。

```
@echo off
set ProgramName=calc.exe
set EndInHours=2

:: How Many Minutes in between each check to see if %ProgramName% is Running
:: To change it to seconds, just set %WaitForSeconds% Manually
set WaitForMinutes=1
set /a WaitForSeconds=%WaitForMinutes%*60

:: How many times to loop
set /a MaxLoop=(%EndInHours%*60*60) / (%WaitForMinutes%*60)

REM Use a VBScript popup window asking to terminate %ProgramName%
echo set WshShell = WScript.CreateObject("WScript.Shell") > %tmp%\tmp.vbs
echo Wscript.Quit (WshShell.Popup( "Click 'OK' to terminate %ProgramName%." ,10 ,"Terminate %ProgramName%", 0)) >> %tmp%\tmp.vbs

start %ProgramName%
set running=True
:: Give time for %ProgramName% to launch.
timeout /t 5 /nobreak > nul
setlocal enabledelayedexpansion
for /l %%x in (1,1,%MaxLoop%) do (
  if "!running!"=="True" for /l %%y in (1,1,%WaitForMinutes%) do (
    if "!running!"=="True" (
      set running=False
      REM call Pop-Up
      cscript /nologo %tmp%\tmp.vbs
      if !errorlevel!==-1 (
        for /f "skip=3" %%x in ('tasklist /fi "IMAGENAME EQ %ProgramName%"') do set running=True
      ) else (
        taskkill /im %ProgramName%
      )
    )
  )
)
if exist %tmp%\tmp.vbs del %tmp%\tmp.vbs 
```

此代码使用 VBScript 制作弹出框。单击`OK`将导致 %ProgramName% 通过 被杀死`taskkill`。

* * *

如果您不想使用弹出窗口，可以`timeout`通过删除...

```
REM Use a VBScript popup window asking to terminate %ProgramName%
echo set WshShell = WScript.CreateObject("WScript.Shell") > %tmp%\tmp.vbs
echo Wscript.Quit (WshShell.Popup( "Click 'OK' to terminate %ProgramName%." ,10 ,"Terminate %ProgramName%", 0)) >> %tmp%\tmp.vbs 
```

...并替换这个...

```
 REM call Pop-Up
      cscript /nologo %tmp%\tmp.vbs
      if !errorlevel!==-1 ( 
```

...有了这个：

```
 REM Use CTRL+C to kill %ProgramName%
      timeout /t %WaitForSeconds% /nobreak
      if !errorlevel!==0 ( 
```

使用`/nobreak`是必要的，因为`timeout`不区分按键或超时。这将允许您通过按`CTRL`+C 来终止 %ProgramName% ，但这会导致您的批处理文件`Terminate batch job (Y/N)?`在您这样做时询问。马虎/凌乱/讨厌的恕我直言。

* * *

您可以改为使用`CHOICE`以下代码替换上述代码：

```
 REM Using choice, but choice can get stuck with a wrong keystroke
      Echo [K]ill %ProgramName% or [S]imulate %WaitForSeconds% Seconds
      Choice /n /c sk /t %WaitForSeconds% /d s
      if !errorlevel!==1 ( 
```

但是选择带来了它自己的一系列限制。一方面，如果按下了不在其选择范围内的键（在本例中为`s`and `k`），它将停止倒计时，基本上锁定直到做出正确的选择。第二，`SPACEBAR`不能选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:04:15.747

我认为没有超时命令。但是，您可以开始在后台执行任务并在超时时间内休眠（使用 ping），然后终止该任务。

# javascript - 使用正则表达式将当前 url 路径与导航路径匹配？

> ID：12394341
> 
> 赞同：1
> 
> 时间：2012-09-12T18:37:30.660
> 
> 标签：javascript, jquery, regex

我使用此表达式获取当前 url 路径目录`/products/`， 因此我试图找到使用该表达式的列表项`www.mysite.com/products/watches`
`/\/(.*?)\//`
`/products/`
`<ul> <li><a href="/home.htm">home</a></li>`
`<li><a href="/products/watches">watches</a></li>`
`<li><a href="/services/watch-repair">repairs</a></li>`
`<li><a href="/support/refund">refund</a></li> </ul>`

这就是我到目前为止所拥有的。[这是小提琴的一个更好的例子](http://jsfiddle.net/sdavadi/XxLTQ/14/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:44:25.113

你的正则表达式很好。你的 javascript 需要更像。

```
$('ul li a[href^="'+urlmatch[0] +'"]').each(function() {
    $(this).addClass('active');      
}); 
```

该代码会找到以您的正则表达式开头的每个链接并将其标记为活动。

# python - SSL验证python服务器/python

> ID：12394343
> 
> 赞同：0
> 
> 时间：2012-09-12T18:37:37.337
> 
> 标签：python, ssl, https, ssl-certificate

我正在尝试编写一个 https 服务器和客户端。我创建了一个 CA 以及一个私钥和一个用于测试的自签名证书。

这是我的测试服务器：

```
#!/usr/bin/env python

import socket, os
from SocketServer import BaseServer
from BaseHTTPServer import HTTPServer, BaseHTTPRequestHandler
from SimpleHTTPServer import SimpleHTTPRequestHandler
from OpenSSL import SSL

CERTIFICATE_PATH = os.getcwd() + '/CA/cacert.pem'
KEY_PATH = os.getcwd() + '/CA/private/key.pem'

class SecureHTTPServer(HTTPServer):
    def __init__(self, server_address, HandlerClass):
        BaseServer.__init__(self, server_address, HandlerClass)
        ctx = SSL.Context(SSL.SSLv23_METHOD)

        ctx.use_privatekey_file(KEY_PATH)
        ctx.use_certificate_file(CERTIFICATE_PATH)

        self.socket = SSL.Connection(ctx, socket.socket(self.address_family, self.socket_type))

        self.server_bind()
        self.server_activate()

class MemberUpdateHandler(SimpleHTTPRequestHandler):
    def setup(self):
        self.connection = self.request
        self.rfile = socket._fileobject(self.request, "rb", self.rbufsize)
        self.wfile = socket._fileobject(self.request, "wb", self.wbufsize)

    def do_GET(self):
        try:
            print 'path:', self.path
            print self.path.endswith('.txt')
            if self.path.endswith('.txt'):
                self.send_response(200)
                self.send_header('Content-type', 'text/html')
                self.end_headers()
                self.wfile.write("successful")
                return
            else:
                self.send_response(200)
                self.send_header('Content-type', 'text/html')
                self.end_headers()
                self.wfile.write("not successful")
        except IOError:
            self.send_error(404, 'What you talking about willis?')

def test(HandlerClass = MemberUpdateHandler,
         ServerClass = SecureHTTPServer):
    server_address = ('', 4242)
    httpd = ServerClass(server_address, HandlerClass)
    sa = httpd.socket.getsockname()
    print "serving HTTPS on:", sa[0], "port:", sa[1], "..."
    httpd.serve_forever()

if __name__ == '__main__':
    test() 
```

和我的简单客户：

```
#!/usr/bin/env python

import os
import httplib
import socket

KEY_FILE = os.getcwd() + '/CA/private/key.pem'
CERT_FILE = os.getcwd() + '/CA/certs/01.pem'
GET = "GET"

conn = httplib.HTTPSConnection('0.0.0.0', '4242', cert_file = CERT_FILE)

conn.request(GET, "/this.txt")
response = conn.getresponse()
print response.status, response.reason, response.read()

conn.close() 
```

当我尝试添加 cert_file = CERT_FILE 如果我从调用中删除它时，就会出现我的问题，它可以工作。但我认为我没有得到我想要的验证。

这是我尝试时遇到的错误：

在服务器端：

```
Exception happened during processing of request from ('127.0.0.1', 55283)
Traceback (most recent call last):
File "/usr/lib/python2.6/SocketServer.py", line 281, in _handle_request_noblock
  self.process_request(request, client_address)
File "/usr/lib/python2.6/SocketServer.py", line 307, in process_request
  self.finish_request(request, client_address)
File "/usr/lib/python2.6/SocketServer.py", line 320, in finish_request
  self.RequestHandlerClass(request, client_address, self)
File "/usr/lib/python2.6/SocketServer.py", line 615, in __init__
  self.handle()
File "/usr/lib/python2.6/BaseHTTPServer.py", line 329, in handle
  self.handle_one_request()
File "/usr/lib/python2.6/BaseHTTPServer.py", line 312, in handle_one_request
 self.raw_requestline = self.rfile.readline()
File "/usr/lib/python2.6/socket.py", line 406, in readline
 data = self._sock.recv(self._rbufsize)
Error: [('SSL routines', 'SSL23_READ', 'ssl handshake failure')] 
```

从客户那里：

```
File "HTTPSClient.py", line 19, in <module>
conn.request(GET, "/this.txt")
File "/usr/lib/python2.6/httplib.py", line 910, in request
self._send_request(method, url, body, headers)
File "/usr/lib/python2.6/httplib.py", line 947, in _send_request
self.endheaders()
File "/usr/lib/python2.6/httplib.py", line 904, in endheaders
self._send_output()
File "/usr/lib/python2.6/httplib.py", line 776, in _send_output
self.send(msg)
File "/usr/lib/python2.6/httplib.py", line 735, in send
self.connect()
File "/usr/lib/python2.6/httplib.py", line 1112, in connect
self.sock = ssl.wrap_socket(sock, self.key_file, self.cert_file)
File "/usr/lib/python2.6/ssl.py", line 350, in wrap_socket
suppress_ragged_eofs=suppress_ragged_eofs)
File "/usr/lib/python2.6/ssl.py", line 113, in __init__
cert_reqs, ssl_version, ca_certs)
ssl.SSLError: [Errno 336265225] _ssl.c:337: error:140B0009:SSL routines:SSL_CTX_use_PrivateKey_file:PEM lib 
```

我应该在那里发送什么文件？我有一个 CA 证书、一个签名证书和一个私钥。我能够找到的文档非常稀少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:54:53.357

基于此[文档][1]

```
class httplib.HTTPSConnection(host[, port[, key_file[, cert_file[, strict[, timeout[, source_address]]]]]])
A subclass of HTTPConnection that uses SSL for communication with secure servers. Default port is 443\. key_file is the name of a PEM formatted file that contains your private key. cert_file is a PEM formatted certificate chain file.

**Warning This does not do any verification of the server’s certificate.** 
```

我不确定（没有使用 Python 的经验），但我相信 key_file 和 cert_file 用于客户端身份验证。

您可以查看有关证书验证的链接： http: [//code.activestate.com/recipes/577548-https-httplib-client-connection-with-certificate-v/](http://code.activestate.com/recipes/577548-https-httplib-client-connection-with-certificate-v/)

# mysql - 用户投票栏应该实时更新还是每天更新一次，如何更新？

> ID：12394345
> 
> 赞同：1
> 
> 时间：2012-09-12T18:37:47.523
> 
> 标签：mysql, database-design

在我的一个网站上，用户可以互相投票。我有一个`Votes`表格，其中每一行对应于给定的投票。

我想开始向用户展示他们的总票数，这只是他们在该`Votes`表中获得的票数的总和。我应该实时计算，还是应该每天计算一次。这种情况的“最佳实践”是什么（假设有数十万票并且还在增长）？

实时很容易，但一天一次就没有那么简单了。我假设我需要做一个 Cron 作业，但我到底该怎么做呢？我知道我需要遍历每个用户并计算他们在该`Votes`表中收到的投票的总和，但是我是否需要从第一次投票开始每天都计算一个完整的总和并保存它，或者我应该仅将**新**投票（自上次更新以来）添加到现有总和并保存？

如果是后者，那么我将如何做到这一点并跟踪所有内容，以便不会错过任何选票或添加两次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:44:59.857

处理这个问题的标准方法是去[规范化](http://en.wikipedia.org/wiki/Denormalization)，这基本上意味着存储可以由查询确定的数据。它不仅是唯一真正[可扩展](http://en.wikipedia.org/wiki/Scalable)的解决方案，而且相当简单且性能卓越。下面是你如何实现它：

向表中添加一`total_votes`列`users`并通过在投票数据更改时触发的触发器保持正确。

像这样的东西：

```
delimiter //

create trigger vote_trigger
after insert on votes
for each row
begin
    update users set
    total_votes = total_votes + 1
    where users.user_id = new.user_id;
end; //

delimiter ; 
```

为行删除和行更新创建其他类似的触发器。

最初，运行查询以填充所有值，这样的事情只在系统离线或处于只读模式时**运行一次：**

```
update users set
total_votes = (select count(*) from votes where user_id = users.user_id); 
```

但执行此查询时，触发器将保持`total_votes`正确的值（即与`votes`表同步）。

# sql - 不推荐使用的 T-SQL 语法

> ID：12394348
> 
> 赞同：1
> 
> 时间：2012-09-12T18:38:08.180
> 
> 标签：sql, tsql

引用 SELECT 语句的每个部分是否已弃用 T-SQL 语法？

```
SELECT "A", "B", "C" FROM "database"."table" where "column" = @p2 
```

这是 MS Access 用于查询 SQL Server 实例的语法。我不知道正在使用什么版本的 Access。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:43:27.353

据我所知不是。Microsoft SQL 2012 仍然支持在选择语句中使用双引号，请参见[此处](http://msdn.microsoft.com/en-us/library/ms174393.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:48:26.997

这句话有效，但仅当 A、B 和 C 是列时：

```
SELECT "A", "B", "C" FROM "database"."table" where "column" = @p2 
```

如果这些是 varchar 之类的值，则必须使用“A”、“B”、“C”。

并且“数据库”。“表”没有很好的定义。

应该是`"database"."schemaName"."table"`。（通常 schemaName 是 dbo）

所以查询是这样工作的：

```
 SELECT "A", "B", "C" FROM "database"."schemaName"."table" where "column" = @p2 
```

或者简单地使用

```
SELECT "A", "B", "C" FROM "table" where "column" = @p2 
```

# c++ - 在 C++，VS 2010 中创建类库的困惑

> ID：12394349
> 
> 赞同：0
> 
> 时间：2012-09-12T18:38:14.310
> 
> 标签：c++, visual-studio-2010

我正在开发一个需要一些数学的 3d 游戏引擎，但我想通过将数学放入库来更好地调整我的代码。现在我正在使用一个名为“DataTypes.hpp”的头文件，它包含我的引擎需要的所有结构和数据类型。这还包括我的数学文件“VMMath.hpp”（它用作包装器），在这里我包括我的向量、矩阵和四元数类的其他四个头文件。

我的方法是我希望 DataTypes 成为一个预编译的头文件，并且 VMMath 代码成为一个库（静态或 dll，老实说我不确定哪个）。那时我不必将 DataType 标头放在所有 VMMath 源中，并减少项目的相关源文件。

从我所见，一个库必须是一个标头和源，它使用 extern 或 static 关键字，因此标头可以使用源中的方法。MSDN 上的示例显示了命名空间中的一个类，它没有带有静态方法的构造函数/析构函数。但我发现真正向您展示它的能力有点短。

那么是否可以从这种文件结构创建一个库：

<-项目目录->

*   （其他来源/文件夹）

*   数学数学

    -- VMMath.hpp

    *   数学

        -- CVector2.hpp

        -- CVector2.cpp

        -- CPoint2.hpp

        -- CVector3.hpp

        -- CVector3.cpp

        -- CPoint3.hpp

        -- CVector4.hpp

        -- CVector4.cpp

        -- CMatrix3.hpp

        -- CMatrix3.cpp

        -- CMatrix4.hpp

        -- CMatrix4.cpp

        -- CQuaternion.hpp

        -- CQuaternion.cpp

我希望这是有道理的。所以我可以看到这个工作的一种方法是让 VMMath.hpp 里面有所有的类，并且 VMMath.cpp 包含所有的类源，但这不是很容易维护。或者我必须将每个类作为单独的 dll 吗？

这是我读过的 codeproject 的一篇文章，但它没有显示包含多个文件的 dll：http: [//www.codeproject.com/Articles/6351/Regular-DLL-Tutor-For-Beginners](http://www.codeproject.com/Articles/6351/Regular-DLL-Tutor-For-Beginners)

我希望我说清楚了，如果我产生了太多的阅读，请原谅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:39:41.547

对于任何类型的库，头文件或源文件的数量都没有限制。

# windows - 在 SVN 中如何检测冲突？

> ID：12394350
> 
> 赞同：1
> 
> 时间：2012-09-12T18:38:14.583
> 
> 标签：windows, linux, svn, repository

我想知道在 SVN 中检测冲突的方法？

例如，用户 1 提交了 file.c，用户 2 尝试更新他的本地副本（svn up）。有两件事发生

1.  静默合并:: SVN 能够静默合并更改。

2.  冲突:: SVN 本身无法合并更改。用户必须手动完成。

请帮助我SVN无法合并更改本身的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:40:45.447

简单的例子：

*   `file.c`用户 1在他的最后一次提交中修改了第 42 行，
*   用户 2 还修改`file.c`了他的工作副本中的第 42 行，
*   用户 2 发出`svn up`，因此请求将用户 1 提交的更改传播到他的工作副本。

在这种情况下，SVN 无法确定是否应该用用户 1 覆盖用户 2 对第 42 行的更改，还是忽略用户 1 的更改。如果没有人工干预，它不可能将更改合并到同一行。这是一个冲突。

# c#-4.0 - c# 使用 GeckoFx 14 如何开始？

> ID：12394351
> 
> 赞同：2
> 
> 时间：2012-09-12T18:38:25.793
> 
> 标签：c#-4.0, geckofx

我在看这个网站：[https ://bitbucket.org/geckofx/geckofx-14.0](https://bitbucket.org/geckofx/geckofx-14.0)

我对 GeckOFX 一无所知，因此下载 zip 文件时我参考了 Geckofx-core-14 和 Geckofx-WinForms-14。

我用这个代码...

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Gecko;
using GeckoFX;

namespace GeckoFXTest
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            //Gecko.Xpcom.Initialize("C:\\tools\\xulrunner");
            GeckoWebBrowser myBrowser = new GeckoWebBrowser();
            this.Controls.Add(myBrowser);
            myBrowser.Dock = DockStyle.Fill;

            myBrowser.Navigate("http://www.google.com");
        }
    }
} 
```

但我想我错过了一些东西，有人可以告诉我我错过了什么吗？或者如何开始，我找不到 GeckOFX 14 的扩展坞

使用 C# WinForms 4.0 .Net 提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T01:30:53.953

您注释掉的行很重要：

```
//Gecko.Xpcom.Initialize("C:\\tools\\xulrunner"); 
```

在创建 GeckoWebBrowser 控件之前，您需要通过调用 Gecko.Xpcom.Initialze 下载 xulrunner 14 或 firefox 14 并告诉 geckofx 在哪里可以找到它。

此外，您只需为每个应用程序调用一次 Xpcom.Initialize，因此您不想将其放入表单构造函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-24T10:06:19.100

您可以下载 xulrunner-sdk [https://bitbucket.org/geckofx/geckofx-33.0/downloads](https://bitbucket.org/geckofx/geckofx-33.0/downloads)

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using Gecko;
    using Gecko.DOM;
    using System.Net.Mail;
    using System.Net.Mime;
    using System.IO;
    public partial class Form1 : Form
    {
    public Form1()
            {
                InitializeComponent();

                Gecko.Xpcom.Initialize(@"F:\bak\Desktop\frefox c sharp\xulrunner-33.1.1.en-US.win32.sdk\xulrunner-sdk\bin");

            }
    private void button4_Click(object sender, EventArgs e)
            {

                geckoWebBrowser1.Navigate("http://example.com");

            }
} 
```

# javascript - javascript：作为对象或函数传递

> ID：12394359
> 
> 赞同：5
> 
> 时间：2012-09-12T18:39:10.050
> 
> 标签：javascript, jquery, function, object, frameworks

我的问题很奇怪，它与我在 jQuery 中看到的东西有关，但到目前为止我无法重新创建它。

在 jQuery 中你可以这样

```
jQuery('div').append 
```

或者

```
jQuery.ajax 
```

我正在制作的应用程序需要类似的语法，我注意到如果你使用 new like

```
var that=new function(){
} 
```

你可以用它来调用这个函数，没有（），但在某些情况下我会需要它。

这样做的原因是我需要像 jQuery 一样选择一个 dom 元素的一些功能。

```
that('[data-something="this"]').setEvent('click',functin(){}) 
```

有些人会自动这样做：

```
that.loadIt('this','[data-something="that"]') 
```

这样做的原因是 dom 元素是从外部加载并推送的，然后脚本等待它准备好再继续。并且这样做，无论如何对我来说似乎是获得此功能的最干净的方法（我正在编写一个完整的 javascript 框架，所以我避免使用库来保持脚本快速）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T18:42:43.710

函数是对象并且可以具有属性，就像其他对象一样。因此，您可以像这样向函数添加属性：

```
function myFunc(){}
myFunc.someFunc = function(){} 
```

如果您使用`new myFunc`生成的对象，则不会有`someFunc`，因为它不是`prototype`.

所以，你可以做这样的事情：

```
function myFunc(){
    // This lets you do "myFunc()" instead of "new myFunc()"
    if (!(this instanceof myFunc)) {
        return new myFunc();
    }
    else{
        this.val = 0;

        this.setVal = function(x){
            this.val = x;
            // for function chaining
            return this;
        }

        this.getVal = function(){
            return this.val;
        }
    }
}

// This function is not part of the prototype
myFunc.test = function(){
    alert('hi');
}

// Some tests
var obj = myFunc();
obj.setVal(12).getVal(); // 12

myFunc.test();

obj.test(); // Error: 'test' is not a function

myFunc.getVal(); // Error: 'getVal' is not a function 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T18:42:55.090

函数是对象。

只需摆脱`new`，并将属性直接添加到`that`.

```
var that = function() {
    // do some work
}

that.loadit = function() {
    // do other work
} 
```

由于您正在尝试实现类似 jQuery 的功能，因此`that`请调用构造函数。

```
;(function(global) {

       // function to be publicly exposed
    var that = function(foo, bar) {
        return new MyLibrary(foo, bar);
    }

       // publicly expose the function
    global.that = that;

       // use the function as a namespace for utilities
    that.loadit = function() {
        // do other work
    }

       // The actual constructor function, like the internal jQuery constructor
    MyLibrary(foo, bar) {
        // constructor function
    }

       // Prototypal inheritance of objects created from the constructor
    MyLibrary.prototype.setEvent = function() {
        // do some work
        return this;  // allows for method chaining
    };
    MyLibrary.prototype.otherMethod = function() {
        // do something else
        return this;  // allows for method chaining
    };
})(this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:42:33.743

```
$.fn.loadIt=function(var1,var2) {
  // $(this) is automatically passed
  // do stuff
} 
```

像这样称呼它

```
$('#element').loadIt('a variable','another variable'); 
```

# android - android使用外部共享库

> ID：12394363
> 
> 赞同：0
> 
> 时间：2012-09-12T18:39:38.477
> 
> 标签：android, android-ndk

我在我的 Android 应用程序中使用外部共享库时遇到问题。我创建了一个 Android.mk 文件，如下所示：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := MyApp
LOCAL_SRC_FILES := myexternallib.so
include $(PREBUILT_SHARED_LIBRARY) 
```

使用 ndk-build 我能够生成一个本地本地库，并在我的`System.loadLibrary`方法中使用这个本地库。当我运行应用程序时出现错误`java.lang.UnsatisfiedLinkError: Cannot load library: reloc_library[1486]: 2659 unknown reloc type 19 @ ( 4220)`

在进一步搜索中，我发现了一个建议使用 android 工具链构建共享库的链接。所以我使用了 android 源代码目录中`arm-eabi-gcc`可用 的工具链之一`prebuilt/linux_x86/toolchain/arm-eabi-4.4.3/bin`来构建我的源文件。我得到一个错误`arm-eabi-gcc: error trying to exec 'cc1': execvp: No such file or directory`。我还注意到工具链文件夹没有名为`cc1`.

我是否遵循正确的程序？还有其他方法可以在 Android 代码中引用外部共享库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T07:02:08.817

确实，您应该使用 Android 工具链。

Android NDK 附带了有关使用其 toolcahin 的详细说明：http: [//source-android.frandroid.com/ndk/docs/STANDALONE-TOOLCHAIN.html](http://source-android.frandroid.com/ndk/docs/STANDALONE-TOOLCHAIN.html)。如果您对本文档有具体问题，请随时提问。

# android - OpenCV for Android - 访问 Mat 的元素

> ID：12394364
> 
> 赞同：7
> 
> 时间：2012-09-12T18:39:39.363
> 
> 标签：android, opencv

在 OpenCV4Android 中访问和修改 Mat 的各个元素的标准方法是什么？另外，BGR（我认为这是默认的）和灰度的数据格式是什么？
编辑：让我们更具体一点。mat.get(row, col) 返回一个双精度数组。这个数组中有什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-19T10:41:37.657

如果您只想访问一些像素，请使用**double[] get(int row, int col)**并使用**put(int row, int col, double... data) 写入**。如果您正在考虑访问整个图像或在循环中迭代图像的数据，那么您应该做的最好的事情是将 Mat 数据复制到 Java 原始数据类型中。完成数据操作后，只需将数据复制回 Mat 结构即可。

图像使用**CV_8U**，如果您有灰度图像，它将使用**CV_8UC1**如果您有 RGB 图像，它将使用 CV_8UC3 的 Mat（**CV_8U**的3 个通道）。**CV_8U**相当于java中的字节。:)

我可以给你和我在 Java（Android 平台）中使用的方法来二值*化*灰度图像的示例：

```
private Mat featuresVectorBinarization(Mat fv){

    int size = (int) fv.total() * fv.channels();
    double[] buff = new double[size];
    fv.get(0, 0, buff);

    for(int i = 0; i < size; i++)
    {
        buff[i] = (buff[i] >= 0) ? 1 : 0;
    }

    Mat bv = new Mat(fv.size(), CvType.CV_8U);
    bv.put(0, 0, buff);
    return bv;
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-01-12T15:35:32.483

> 在 OpenCV4Android 中访问和修改 Mat 的各个元素的标准方法是什么？

A`Mat`是我们在数学中称为“矩阵”的东西 - 由行和列设置的矩形数组。在图像 Mat 的情况下，这些“数量”表示像素（例如，矩阵的每个元素都可以是图像 Mat 中每个像素的*颜色*）。从[本](http://docs.opencv.org/2.4/doc/tutorials/core/mat_the_basic_image_container/mat_the_basic_image_container.html#matthebasicimagecontainer)教程：

> [![在此处输入图像描述](../Images/2fc6f09c02e27402c9e54224d3f8cb85.png)](https://i.stack.imgur.com/x4HtV.jpg)
> 
> 在上图中，您可以看到汽车的镜子只不过是一个包含所有像素点强度值的矩阵。

那么你将如何遍历一个矩阵呢？这个怎么样：

```
for (int row=0; row<mat.rows(); row++) {
  for (int col=0; col<mat.cols(); col++ ) {
    //...do what you want.. 
    //e.g. get the value of the 3rd element of 2nd row 
    //by mat.get(2,3);
  }
} 
```

> 在 OpenCV4Android 中访问和修改 Mat 的各个元素的标准方法是什么？

您可以`Mat`使用其函数获取元素的值`get(x)(y)`，其中`x`是元素的第一个坐标（行号）和`y`第二个坐标（列号）。例如，要获取名为的`BGR`图像第 7 行的第 4 个元素，请使用 的方法获取类型为 的数组，该数组的大小为，每个数组元素代表图像格式的、和通道中的每一个。`Mat``bgrImageMat``get``Mat``double``3``Blue``Green``Red``BGR`

```
double [] bgrColor = bgrImageMat.get(); 
```

> 另外，BGR（我认为这是默认的）和灰度的数据格式是什么？编辑：让我们更具体一点。mat.get(row, col) 返回一个双精度数组。这个数组中有什么？

您可以从网上阅读有关 BGR 颜色格式和灰度的信息。例如[BGR](https://en.wikipedia.org/wiki/BGR)和[灰度](https://en.wikipedia.org/wiki/Grayscale)。

简而言之，BGR 颜色格式有 3 个通道：`Blue`,`Green`和`Red`. 所以当是一个图像时，`double`返回的数组是一个大小为 3 的数组，它的每个元素分别包含每个,和通道的值。`mat.get(row, col)``mat``BGR``Blue``green``red`

同样，灰度格式是 1 通道颜色格式，因此`double`返回的大小为 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-25T11:23:33.757

我从学习 OpenCV Mat 对象中可以理解的是，Mat 是可以表示任何 W x H 像素图像的对象。

现在假设您要访问图像的中心像素

X = W/2 Y = H/2

然后您可以按如下方式访问像素数据 double[] data = matObject.get(x,y);

现在数据代表什么以及数据数组的大小是多少。这取决于图像类型。如果图像是灰度图像，则 data.length = 1 ，因为只有一个通道，并且 data[0] 表示该像素的颜色值，即。0（黑色）- 255（白色）

如果图像是彩色图像，则 data.length = 4(rgba) ，因为有四个通道，并且 data[0-n] 表示该像素的颜色值

# c# - 如何在敏捷项目中维护日志条目的 ID

> ID：12394373
> 
> 赞同：1
> 
> 时间：2012-09-12T18:40:19.127
> 
> 标签：c#, log4net, event-log

好的，所以我遇到了我想以对我们的开发团队影响最小的方式解决的情况。

我们在一个较大的 c# 系统（约 40 个生产程序集）中使用 log4net 作为我们的日志框架。

现在我们的支持端希望能够将记录的事件与他们单独维护的数据库相关联。一个合理的要求。

在生产中，我们的主要日志存储库是 Windows 事件日志。

* * *

在开发人员方面，我们当前的模式是这样的：

每当你想从一个组件中记录时，你可以在类的顶部实例化一个这样的记录器：

```
private static readonly ILogger Log = LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod()) 
```

如果您需要日志上下文中的内容，则尽可能早地将其放入每个线程的流程中，即。在服务呼叫的接收端等。

每当您想进行日志记录时，您只需执行 Log.Warn(str, ex) - (或 Info, Error 等)

* * *

现在我们想将这个日志条目“修复”为一个唯一的“eventId”，我们可以为 ILogger 提供一个扩展方法，这将允许我们这样做： Log.Warn(int, str, ex), when "int"是具有以下属性的数字：

*   它被“映射”到持久存储。
*   它指向一个且只有一个 Log 条目
*   如果源代码 Log 语句被删除，则 Id 不会被重新用于新的 log 语句。

* * *

我的直接解决方案是维护一个全局枚举，它将涵盖一组可能的“eventId”，并指示开发人员“只使用一次”。

然后，我们将继续在我们的命名空间和“CategoryId”之间进行某种“智能”映射——“BusinessLayer”命名空间中的 f.ex 任何东西都会分配一个 categoryId。

但我认为我缺少一些东西......

任何想法将不胜感激：

*   您如何在大型系统中使用 EventId 和 CategoryId？（或“什么”你用它们）
*   你们中的任何人都有创建 EventId 的“动态”方式的示例，这样您就可以维护简单的日志记录方法，不需要开发人员在代码语句级别提供唯一的 Id。

抱歉，如果我的问题太宽泛，我知道我在这里有点钓鱼。

# macos - 找不到 git 可执行文件

> ID：12394381
> 
> 赞同：5
> 
> 时间：2012-09-12T18:40:59.553
> 
> 标签：macos, emacs, magit

我在 OS X 10.6.8 上使用 Emacs 24。做`magit-status`说

> 搜索程序：没有这样的文件或目录，git

但是，Emacs shell 能够找到`git`，所以这似乎不是`$PATH`问题。还能是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T22:43:52.133

尝试检查`exec-path`变量的值。这控制了 Emacs 查找外部可执行文件（包括 git）的目录。

这是一个可自定义的变量，您可以将路径添加到`git`现有目录列表中。

我的`.emacs.d/init.el`文件中有 elisp 片段，用于在 OSX 下安装 Emacs，它设置了`PATH`和`exec-path`正确。

```
;;; Set localized PATH for OS X
(defun my-add-path (path-element)
  "Add the specified PATH-ELEMENT to the Emacs PATH."
  (interactive "DEnter directory to be added to path: ")
  (if (file-directory-p path-element)
     (progn
       (setenv "PATH" (concat (expand-file-name path-element) path-separator (getenv "PATH")))
       (add-to-list 'exec-path (expand-file-name path-element)))))

(if (fboundp 'my-add-path)
   (let ((my-paths (list "/opt/local/bin" "/usr/local/bin" "/usr/local/git/bin")))
      (dolist (path-to-add my-paths (getenv "PATH"))
         (my-add-path path-to-add)))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T09:39:10.677

OS X 上的 Emacs 使用系统范围的环境变量，可以通过`environment.plist`在正确的目录中创建一个魔法 XML 文件来覆盖它。不过，更好的解决方案是让 Emacs`$PATH`从您的 shell 中复制 的值，以便它与您在`Terminal.app`.

@Anupam 的答案基于我最初为此目的编写的一段代码，但我现在已经改进了该代码并将其发布为一个[名为 elisp 的小库`exec-path-from-shell`](https://github.com/purcell/exec-path-from-shell)，您可以从 Marmalade 或[Melpa](http://melpa.milkbox.net)安装它。

# java - Maven Spring 项目给我 org.slf4j.spi.LocationAwareLogger 错误

> ID：12394385
> 
> 赞同：1
> 
> 时间：2012-09-12T18:41:38.180
> 
> 标签：java, eclipse, spring, maven, spring-mvc

Maven Spring 项目给我

```
org.slf4j.spi.LocationAwareLogger.log(Lorg/slf4j/Marker;Ljava/lang/String;ILjava/lang/String;Ljava/lang/Throwable error 
```

这是我第一次使用 Eclipse 和 Maven。我总是在 Eclipse 中完成我的 Spring 项目，但我刚刚开始将 Maven 用于 JAR。如果我在服务器上运行我的新项目，我会收到此错误：

```
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
java.lang.NoSuchMethodError: org.slf4j.spi.LocationAwareLogger.log(Lorg/slf4j/Marker;Ljava/lang/String;ILjava/lang/String;Ljava/lang/Throwable;)V
    at org.apache.commons.logging.impl.SLF4JLocationAwareLog.info(SLF4JLocationAwareLog.java:159)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:273)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4206)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Sep 12, 2012 2:37:13 PM org.apache.catalina.core.StandardContext start 
```

这是我的 pom.xml 文件，一定缺少某些东西

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.springsource.greenbeans.maven</groupId>
    <artifactId>WebFlowTemplate</artifactId>
    <packaging>war</packaging>
    <version>0.0.1-SNAPSHOT</version>
    <name>WebFlowTemplate Maven Webapp</name>
    <url>http://maven.apache.org</url>
    <dependencies>

        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.6.3.Final</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.3.0.Final</version>
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>1.6.2</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-webflow</artifactId>
            <version>2.3.1.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-ldap</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>
        </dependency>

        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.ldap</groupId>
            <artifactId>spring-ldap-core</artifactId>
            <version>1.3.0.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.ldap</groupId>
            <artifactId>spring-ldap-core-tiger</artifactId>
            <version>1.3.0.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.jasig.cas</groupId>
            <artifactId>cas-server-core</artifactId>
            <version>3.5.0</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.6.6</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-ext</artifactId>
            <version>1.6.6</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>1.6.6</version>
        </dependency>

    </dependencies>
    <build>
        <finalName>WebFlowTemplate</finalName>
    </build>
</project> 
```

请帮我

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T21:08:28.720

您可以使用 mvn-plugin ***maven-enforcer-plugin***来识别您的***commons-logging***问题。

将此片段添加到您的*主*或*父* ***pom.xml***

```
<plugins>
  <plugin>
    <artifactId>maven-enforcer-plugin</artifactId>
    <version>1.1.1</version>
    <executions>
      <execution>
        <id>enforce-banned-dependencies</id>
        <goals>
          <goal>enforce</goal>
        </goals>
        <configuration>
          <rules>
            <bannedDependencies>
              <searchTransitive>true</searchTransitive>
              <excludes>
                <exclude>commons-logging</exclude>
                <exclude>org.slf4j:1.5*</exclude>
                <exclude>org.slf4j:1.6*</exclude>
                <exclude>org.springframework:2.*</exclude>
                <exclude>org.springframework:3.0.*</exclude>
              </excludes>
            </bannedDependencies>
          </rules>
          <fail>true</fail>
        </configuration>
      </execution>
    </executions>
  </plugin>
  ......
</plugins> 
```

项目中用于在***log4j中记录******slf4j***的正确 mvn 配置可能是：

 *```
<dependencies>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.7.1</version>
    </dependency>
    <!-- slf4j-bridge for commons-logging -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>1.7.1</version>
    </dependency>
    <dependency>  
        <groupId>org.slf4j</groupId>  
        <artifactId>slf4j-log4j12</artifactId>  
        <version>1.7.1</version>  
    </dependency>
    ...
</dependencies> 
```

这可能会产生例如该错误

```
...
[INFO] --- maven-enforcer-plugin:1.1.1:enforce (enforce-banned-dependencies) @ sd4h ---
[WARNING] Rule 0: org.apache.maven.plugins.enforcer.BannedDependencies failed with message:
Found Banned Dependency: commons-logging:commons-logging:jar:1.1.1
Use 'mvn dependency:tree' to locate the source of the banned dependencies.
... 
```

它可以解决，当它将被***排除***在您的 mvn 配置中时，例如

```
<dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>3.1.2.RELEASE</version>
        <exclusions>
            <exclusion>
                <artifactId>commons-logging</artifactId>
                <groupId>commons-logging</groupId>
            </exclusion>
        </exclusions>
    </dependency>
    ...
</dependencies> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-06T19:15:57.367

我有同样的问题，我**解决**了它更新**jcl-over-slf4j** jar 文件。我正在使用**1.7.5**版本，它成功部署。

这是我的 pom.xml 的依赖项。希望这对您有所帮助。

```
 <properties>
    <spring.version>3.2.3.RELEASE</spring.version>
    <spring-security.version>3.1.4.RELEASE</spring-security.version>
    <org.aspectj-version>1.7.2</org.aspectj-version>
    <org.slf4j-version>1.7.5</org.slf4j-version>

</properties>
<dependencies>
    <!-- Spring 3 -->
    <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context</artifactId>
    <version>${spring.version}</version>
    <exclusions>
        <exclusion>
            <artifactId>commons-logging</artifactId>
            <groupId>commons-logging</groupId>
        </exclusion>
    </exclusions>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <!-- Spring Security -->
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-core</artifactId>
        <version>${spring-security.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-web</artifactId>
        <version>${spring-security.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-config</artifactId>
        <version>${spring-security.version}</version>
    </dependency>

    <!-- DataBase Connection -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.25</version>
    </dependency>

    <!-- Tiles 3 -->

    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-extras</artifactId>
        <version>3.0.1</version>
    </dependency>

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${org.slf4j-version}</version>
    </dependency>

    <!-- slf4j-bridge for commons-logging -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>${org.slf4j-version}</version>
    </dependency>

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${org.slf4j-version}</version>
    </dependency>

</dependencies> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T19:16:45.197

跑

`mvn dependency:tree`或`mvn dependency:list`获取所有依赖项的列表，包括传递的依赖项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T04:25:28.170

这个问题困扰了我一段时间，似乎吸引了很多人。（[另见此处](http://forum.springsource.org/showthread.php?124753-Spring-mvc-sample-project-slf4j-problem)）全新安装 STS，下载最新的 MVC 模板，构建正常，由于这个 SLF4J 问题而无法运行。

这个问题似乎是 slf4j 库和 maven 使用的依赖项之间的不兼容。

简单的解决方案（[此处](http://forum.springsource.org/showthread.php?124753-Spring-mvc-sample-project-slf4j-problem)）是编辑 pom 并删除 commons-logging 的排除项，然后删除 slf4j 的依赖项。当 slf4j 不可用时，Spring 会退回到公共日志记录。我放弃的更难的解决方案是跟踪哪些版本适用于当前的 STS(3.1)，并确保模板适用于正确的版本。

我希望这篇文章能帮助其他尝试过该模板但无法让它开箱即用的人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:09:53.260

一些公共日志库和 slf4j 库之一之间存在一些版本冲突。 *（这不是 maven 问题，如果您手动维护库也会出现问题。）*

用eclipse打开maven pom。有一个名为“层次结构”的选项卡，它将显示使用的和所需的版本。尝试使用没有太多冲突的日志记录谎言的组合。

* * *

我看过你的pom。问题是`jcl-over-slf4j-1.5.8.jar`它包含一些与 slf4j 1.6.6 不兼容的 org.apache.commons.loggin jar。

`jcl-over-slf4j-1.5.8.jar`被引用`org.jasig.cas`

我会尝试`jcl-over-slf4j-1.5.8.jar`用`jcl-over-slf4j-1.6.6.jar`

```
 <dependency>
        <groupId>org.jasig.cas</groupId>
        <artifactId>cas-server-core</artifactId>
        <version>3.5.0</version>
        <exclusions>
            <exclusion>
                <artifactId>jcl-over-slf4j</artifactId>
                <groupId>org.slf4j</groupId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>1.6.6</version>
    </dependency> 
```

但我不知道 cas-server-core 3.5.0 是否兼容`jcl-over-slf4j-1.6.6.jar`. 但在大多数情况下，日志框架的“外部”API 比日志桥使用的“内部”API 更稳定。——祝你好运。*

# tfs - 如何从 Scrum 2.0 模板中删除小时数

> ID：12394386
> 
> 赞同：2
> 
> 时间：2012-09-12T18:41:37.767
> 
> 标签：tfs, scrum

我们目前在新的 TFS 2012 中使用来自微软的 Scrum 2.0 流程模板，但是我们不使用小时作为任务估计，我们只是计算任务。这很容易通过将每个任务值设置为默认值 1 并将该字段设置为任务属性表单中的只读来实现。

但是原始模板使用小时作为任务单位，因此模板周围有标记“h”。有没有办法摆脱这个小时标记，因为它会导致不断的混乱？尤其是在管理方面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T08:41:20.593

**您可以通过修改commonconfiguration.xml**文件中以下行中的**格式**属性来配置剩余工作的显示方式：

 **```
<TypeField refname="Microsoft.VSTS.Scheduling.RemainingWork" type="RemainingWork" format="{0} h" /> 
```

默认情况下，此属性为“{0} h”，因此您只需将其设置为“{0}”即可满足您的需求。

您可以使用**witadmin**命令从服务器下载 commonconfiguration.xml 文件：

```
witadmin exportcommonprocessconfig /collection:http:<your collection> /p:<your project> /f:<the file name> 
```

编辑文件后，您必须使用 witadmin 命令将其重新导入 TFS：

```
witadmin importcommonprocessconfig ...the same parameters as above 
```

注意：对于 RC，您必须在占位符后留一个空格，例如**"{0}"**，否则在导入文件时会出现验证错误。我还没有尝试使用 RTM 来查看这是否已修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:46:53.960

As far as I can tell, all of those h's are hardcoded straight into web access. So the only way to remove them would be to find them (I used Chrome's dev tools), isolate them, and then go into the Web Access pages located on your TFS Server (application tier) and manually remove them. This is because they aren't actually part of any template, so there isn't a way to remove them all at once. The path to the files will be something like

```
c:\Program Files\Microsoft Team Foundation Server 11.0\Application Tier\Web Services 
```

Good luck, I've had a heck of a time trying to alter them.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T07:35:54.693

您可以使用[TFPT](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)或[WITADMIN](http://msdn.microsoft.com/en-us/library/dd236909.aspx)命令行工具删除剩余工作量字段。

但是我建议**不要**删除它，而是从表单本身中删除它（这样它就不会显示），并添加一个规则，使其默认为**1**并且是只读的。**此外，在工作流中，添加一个规则，当您达到done**时将值更改为 0 。

由于数字本身没有实际意义，因此单位可以是实际小​​时数、理想小时数、故事点或您希望它们表示的任何内容。通过将每个任务设为 1 或 0（完成后），您可以利用 TFS 的内置工具（例如燃尽报告）来跟踪您的进度。完成的每项任务都会减少剩余的工作，并且您将能够通过总结每次迭代中完成的工作量来跟踪速度（这与计数相同）。**

# ruby-on-rails - 如何从另一个包含模块中访问包含模块的方法？

> ID：12394388
> 
> 赞同：0
> 
> 时间：2012-09-12T18:41:51.933
> 
> 标签：ruby-on-rails, ruby, facebook, clearance

```
module Foo
  attr_accessor :val
end

module Bar
  def bar
    val = 50
  end
end

class FooBar
  include Foo
  include Bar
end

fb = FooBar.new
puts fb.bar # 50
puts fb.val # nil 
```

我想从 Bar 内部更改 Foo 的“val”值。

正如您所知，我正在尝试这样做，因为我想通过 Clearance 中的 Facebook Canvas 应用程序添加用户身份验证（0.8.2（旧，我知道））。我要更改的变量是[https://github.com/thoughtbot/clearance/blob/b8ccca00d91cb336e044b76b5c6ae1d8de9d2d8d/lib/clearance/authentication.rb#L25](https://github.com/thoughtbot/clearance/blob/b8ccca00d91cb336e044b76b5c6ae1d8de9d2d8d/lib/clearance/authentication.rb#L25)。

该模块包含在 ApplicationController 中，之后我将包含另一个模块（FacebookAuthenticationHelper），它执行类似的操作

```
def authenticate_facebook
  current_user ||= facebook_user if coming_from_facebook?
end 
```

我也很想知道是否有更好的方法来做到这一点。我没有使用 OAuth，我只是将 Facebook 的 user_id 从 signed_request 发送到我的应用程序保存到我的数据库中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:54:38.463

在 ruby​​ 中，任何形式的语句`varname = value`都会创建一个名为的局部变量`varname`，如果它不存在的话。 *这甚至在类具有同名 setter 方法的类方法中也是如此。* 此外，如果存在局部变量，则它优先于 getter 和 setter。例如：

```
class Demo
    attr_accessor :foo

    def demonstrate!
        @foo = 1      #1: Set member variable foo, so we get meaningful output
        puts foo      #2: Prints 1 (this calls the getter)
        puts self.foo #3: Prints 1 (also calls the getter)

        foo = 2       #4: Creates a LOCAL variable named foo with the value 2
        puts foo      #5: Prints 2 (locals take precedence over getters)
        puts self.foo #6: Prints 1 (calls the getter - the member variable hasn't changed)

        self.foo = 3  #7: Use SELF to ensure you call a getter or setter
        puts foo      #8: Prints 2 (the local again)
        puts self.foo #9: Prints 3 (the member, which is now 3)
    end
end 
```

这个系统的坏处是：看第 2 行和 *第 5 行。完全相同的代码做不同的事情！* 在第 2 行，局部变量`foo`还不存在，所以 ruby​​ 做了“次优”的事情并调用了 getter。但是在第 5 行，本地`foo`存在，所以它优先。

我会说这是糟糕的语言设计：如果没有 就不能调用 setter `self`，为什么 getter 应该没问题——尤其是当它可能导致像上面这样摇摇晃晃的、上下文敏感的代码时？但这是我们必须使用的，它导致了一些一般准则：

1.  如果可以，请使用`@foo`. 很明显这是做什么的。
2.  如果您使用的是 getter 或 setter，请始终使用`self`，即使它不是绝对必要的。这使您的通话内容一目了然。如果您稍后添加具有相同名称的本地，它还可以保证您的代码不会有不同的行为。
3.  如果您执行 1 和 2，您可以假设没有 a`@`或 a的任何内容`self`都是局部变量（或函数调用，但您可能可以通过名称将它们区分开来）。

这最终有点冗长，但我无法找到一个很好的示例来链接到 getter/setter/local 问题。所以也许就是这样 - 希望它有帮助！

# java - jlabel 图标右对齐和文本左对齐

> ID：12394390
> 
> 赞同：0
> 
> 时间：2012-09-12T18:41:56.817
> 
> 标签：java, swing, jlabel, javax.swing.text

可以创建带有图标的 jlabel，以便图标右对齐（右对齐）并且文本左对齐。这意味着，在同一个标​​签组件中，我希望文本出现在标签的最左端，图标出现在最右边。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T09:28:15.747

标准 JLabel 无法在图标和文本之间设置非静态间距，您只能以像素为单位指定 iconTextGap、图标相对于文本的位置以及文本对齐方式。

要制作您想要的东西，您有几个选择：

1.  使用左侧带有标签的容器，右侧带有单独标签中的图标
2.  创建特定的 JLabel UI，以您想要的方式绘制图标

# c# - 确定数据网格列中的数据类型

> ID：12394391
> 
> 赞同：0
> 
> 时间：2012-09-12T18:41:57.597
> 
> 标签：c#, wpf, xaml

我有一个使用 XAML 绑定到类的特定属性的数据网格。有没有办法以编程方式确定在 C# 代码中附加到该列的类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:55:45.807

网格的每个[列定义](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.columndefinitions%28v=vs.95%29.aspx)都有一个[DependencyObjectType](http://msdn.microsoft.com/en-us/library/system.windows.dependencyobject.dependencyobjecttype)属性，它是底层 Clr 类型的包装器。

# c# - 数组中的 MVC3 下拉列表

> ID：12394399
> 
> 赞同：3
> 
> 时间：2012-09-12T18:42:48.973
> 
> 标签：c#, asp.net-mvc-3

尝试从一系列国家/地区加载下拉列表：

```
Country[] Countries = ViewBag.mps.GetCountryList(ViewBag.LogonTicket, ViewBag.PID);
/* Country object defined as, returned from WCF webservice call above:
  <xs:complexType name="Country">
  <xs:sequence>
  <xs:element minOccurs="0" name="CountryName" nillable="true" type="xs:string" /> 
  <xs:element minOccurs="0" name="CountryCode" nillable="true" type="xs:string" /> 
  </xs:sequence>
  </xs:complexType>
*/

<select id="BusinessCountry" name="BusinessCountry" class="validate[required]" parentTab="tab4" style="width:160px;">
@{
    foreach(Country c in Countries) {
    <option value="@c.CountryCode" (@ViewBag.BusinessCountry == @c.CountryCode?"selected=\"selected\"":"") >@c.CountryName</option> 
    }
}
</select> 
```

这是输出：

```
<option af?"selected="\&quot;selected\&quot;&quot;:&quot;&quot;)" (us="=" value="AF">Afghanistan</option> 
```

我做错了什么，我该如何解决？我也试过这个但得到一个例外：

```
@Html.DropDownList("BusinessCountry", new SelectList(Countries, "CountryCode", "CountryName", @ViewBag.part.BusinessCountry), Countries) 
```

## 已经想出了如何使用我拥有的代码来做到这一点：

```
<select id="BusinessCountry" name="BusinessCountry" class="validate[required]" parentTab="tab4" style="width: 160px;">
@foreach(Country c in Countries) {
  string sel = (ViewBag.part.BusinessCountry == c.CountryCode?"selected=\"selected\"":"");
  <option value="@c.CountryCode" @sel >@c.CountryName</option> 
}
</select> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:09:08.680

在视图中混合大量代码是一种错误的做法。还使用`ViewBag`/`ViewData`在操作方法和视图之间传输这样的数据，使您的代码难看。您应该考虑使用 ViewModel 将数据从操作方法传输到视图。

假设您的视图是创建公司详细信息，则具有这样的视图模型

```
public class CompanyViewModel
{
  public string Name { set;get;}
  public IEnumerable<SelectListItem> Countries { set;get;}
  public int SelectedCountry { set;get;}

  CompanyViewModel()
  {
    Countries=new List<SelectListItem>();
  }
} 
```

现在在您的`GET`Action 方法中，您将数据填充到`Countries`viewModel 对象的集合中并将其发送到 View。

```
public ActionResult Create()
{
   CompanyViewModel vm=new CompanyViewModel();
   // The below line is hard coded for demo. you may replace 
   //  this with loading data from your Data access layer/ Existing array
   vm.Countries= new[]
   {
      new SelectListItem { Value = "1", Text = "United States" },
      new SelectListItem { Value = "2", Text = "Canada" },
      new SelectListItem { Value = "3", Text = "Australia" }
   };
   return View(vm);
} 
```

现在在您的强类型视图中，

```
@model CompanyViewModel
@using(Html.Beginform())
{
   @Html.DropDownListFor(x => x.SelectedCountry,
                   new SelectList(Model.Countries,"Value","Text"), "Select..")
   <input type="submit" />

} 
```

现在在您的方法中，您将通过访问发布的模型的属性值来`HTTPPost`获取选定的国家/地区 ID`SelectecCountry`

```
[HttpPost]
public ActionResult Create(CompanyViewModel model)
{
  if(ModelState.IsValid)
  {
      //check for model.SelectedCountry property value here
      //Save and Redirect
  }
  //Reload countries here
  return View(model);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:45:59.597

我使用这样的下拉列表：

在控制器中：

```
ViewBag.CompanyId = New SelectList(db.Companies, "CompanyId", "Name", blog.CompanyId) 
```

在视图中：

```
<div class="editor-field">
    @Html.DropDownList("CompanyId", String.Empty)
    @Html.ValidationMessageFor(Function(model) model.CompanyId)
</div> 
```

注意：这是 VB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:49:41.107

试试这个代码的属性

```
@((ViewBag.BusinessCountry == @c.CountryCode) ? "selected='selected'" : "") 
```

# asp.net-mvc - 随机 500 错误 - 已添加具有相同密钥的项目

> ID：12394401
> 
> 赞同：2
> 
> 时间：2012-09-12T18:42:55.480
> 
> 标签：asp.net-mvc, entity-framework, ninject

该网站正在运行带有 MVC 3、Entity Framework 和 Ninject 的 .Net 4。此错误随机出现，我们只能在负载测试或生产中检测到它。在开发中从未见过它。

堆栈跟踪：

```
 9/12/2012 12:35:19 PM: An item with the same key has already been added.
   HttpContext.Current.Request.Url.AbsoluteUri: http://www.website.com/
   HttpContext.Current.Request.QueryString: 
   HttpContext.Current.Request.Url.AbsolutePath: /
   HttpContext.Current.Request.UserAgent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; GTB7.4; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3; .NET CLR 1.1.4322; .NET4.0E)
   HttpContext.Current.Request.UserHostAddress: 98.174.239.230
   StackTrace:
       at System.Collections.Generic.Dictionary`2.Insert(TKey key, TValue value, Boolean add)
      at System.Data.Objects.ObjectStateManager.AddEntityEntryToDictionary(EntityEntry entry, EntityState state)
      at System.Data.Objects.ObjectStateManager.AddEntry(IEntityWrapper wrappedObject, EntityKey passedKey, EntitySet entitySet, String argumentName, Boolean isAdded)
      at System.Data.Common.Internal.Materialization.Shaper.HandleEntityAppendOnly[TEntity](Func`2 constructEntityDelegate, EntityKey entityKey, EntitySet entitySet)
      at lambda_method(Closure , Shaper )
      at System.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper)
      at System.Data.Common.Internal.Materialization.Shaper`1.SimpleEnumerator.MoveNext()
      at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
      at System.Linq.Enumerable.Count[TSource](IEnumerable`1 source)
      at ASP._Page_Views_Shared__NavCategoryPartial_cshtml.Execute() in d:\Website\Views\Shared\_NavCatPartial.cshtml:line 30
      at System.Web.WebPages.WebPageBase.ExecutePageHierarchy()
      at System.Web.Mvc.WebViewPage.ExecutePageHierarchy()
      at System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage)
      at System.Web.Mvc.Html.PartialExtensions.Partial(HtmlHelper htmlHelper, String partialViewName, Object model, ViewDataDictionary viewData)
      at ASP._Page_Views_Home_Index_cshtml.<Execute>b__4() in d:\Website\Views\Home\Index.cshtml:line 9
      at System.Web.WebPages.WebPageBase.<>c__DisplayClassb.<RenderSection>b__9(TextWriter tw)
      at System.Web.WebPages.WebPageBase.Write(HelperResult result)
      at ASP._Page_Views_Shared__Layout_cshtml.Execute() in d:\Website\Views\Shared\_Layout.cshtml:line 57
      at System.Web.WebPages.WebPageBase.ExecutePageHierarchy()
      at System.Web.Mvc.WebViewPage.ExecutePageHierarchy()
      at System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage)
      at System.Web.WebPages.WebPageBase.Write(HelperResult result)
      at System.Web.WebPages.WebPageBase.RenderSurrounding(String partialViewName, Action`1 body)
      at System.Web.WebPages.WebPageBase.PopContext()
      at System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context)
      at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19()
      at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
      at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
      at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
      at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
      at System.Web.Mvc.Controller.ExecuteCore()
      at System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)
      at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.<BeginProcessRequest>b__5()
      at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass1.<MakeVoidDelegate>b__0()
      at System.Web.Mvc.MvcHandler.<>c__DisplayClasse.<EndProcessRequest>b__d()
      at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
      at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

# mysql - 如何对 2 个表之间的 JOIN 查询与第 3 个表中的列的相应 SUM 进行排序？

> ID：12394405
> 
> 赞同：0
> 
> 时间：2012-09-12T18:43:18.670
> 
> 标签：mysql, sorting, join, sum

我有以下简单的查询，它可以工作并且可以满足我的要求：

```
SELECT 
    Table1.*, 
    Table2.*                    
FROM 
    Table1, Table2                          
WHERE 
    Table1.Col1 != '1' AND
    Table2.Col2 LIKE 'Miami' AND
    (Table2.Col3 LIKE 'USA' OR  Table2.Col2 LIKE 'US') AND  
    Table1.Col1 = Table2.Col1 
```

我现在需要通过 Table3() 中相应值的 SUM 对这些结果进行排序，`SUM(Table3.Col2)`使得`Table3.Col1 = Table1.Col1`和`Table3.Col1 = Table2.Col1`。

我认为只需在 WHERE 子句和`SUM(Table3.Col2)` SELECT 子句中添加这两行就可以了，但这不起作用，只返回**一个**结果，其中包含所有值的总和`Table3.Col2`，而不仅仅是与匹配行对应的那些在其他 2 个表中。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:50:20.847

尝试这个：

```
SELECT 
    Table1.*, 
    Table2.*                    
FROM 
    Table1 JOIN Table2 on Table1.Col1 = Table2.Col1
    JOIN (SELECT Col1, SUM(Table3.Col2) as `SumCol` FROM Table3) as SumTable ON Table2.Col1 = SumTable.Col1                         
WHERE 
    Table1.Col1 != '1' AND
    Table2.Col2 LIKE 'Miami' AND
    (Table2.Col3 LIKE 'USA' OR  Table2.Col2 LIKE 'US') AND  
    Table1.Col1 = Table2.Col1
ORDER BY SumTable.SumCol DESC 
```

# objective-c - iOS 中的 OnTabChanged 方法？

> ID：12394406
> 
> 赞同：0
> 
> 时间：2012-09-12T18:43:21.620
> 
> 标签：objective-c, ios, macos, xcode4.2

我对 iOS/Objective-C 开发很陌生，我正在编写我的第一个严肃的 iPhone/iPad 应用程序。我正在构建的应用程序是基于选项卡的。有一个设置选项卡，用于管理其他视图中使用的选取器的一些设置。
对于我的问题：我希望选择器在 Tab 更改或 s selectorview 中的设置更改时重新加载所有组件。你会如何解决这个问题？

谢谢，莫里马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:57:04.730

基于 Tab-Bar 的应用程序使用以下任何委托方法处理选项卡更改事件：

```
 – tabView:shouldSelectTabViewItem:
 – tabView:willSelectTabViewItem:
 – tabView:didSelectTabViewItem: 
```

您可以在上述任何一种（最好是第一个和第二个）中调用 PickerView 刷新方法。[参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSTabViewDelegate_Protocol/Reference/Reference.html)

希望这可以帮助。如需进一步帮助，请添加评论

# jqmobi - jqMobi - 如何从另一个页面动态添加面板

> ID：12394409
> 
> 赞同：1
> 
> 时间：2012-09-12T18:43:55.797
> 
> 标签：jqmobi

我正在使用[jqMobi](http://www.jqmobi.com)（不是 jQuery Mobile），我希望能够动态加载带有一些远程 html 页面的面板，然后导航到它。我已经阅读[了显示如何添加带有 html 的新面板的文档](http://api.jqmobi.com/#%24.ui.addContentDiv%28id,content,title%29;)，但我想做的是这样的：

```
$.ui.addContentDiv("newDiv","somePage.html","Some Title"); 
```

我知道我可以做这样的事情：

```
$.get("somePage.html",function(data){
    $.ui.addContentDiv("newDiv",data,"Some Title");
    $.ui.loadContent("newDiv", false, false, "up");
}); 
```

但我想知道那里是否有更好的东西。此外，如果出现故障，上述方法不会执行任何操作，因此您可能对此提出任何建议将不胜感激。据我所知，该方法没有`failure`回调`get`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:25:53.370

有一种更简单的方法 - 只需链接到 HTML 页面，它就会为您处理 xhr 请求。data-persist-ajax 将其缓存在 dom 中，因此将来的请求不会加载它。

```
<a href="somePage.html" data-persist-ajax="true">My Page</a> 
```

# search - 使用 Powershell 在目录中首次出现文件时返回 BOOL

> ID：12394411
> 
> 赞同：0
> 
> 时间：2012-09-12T18:44:04.747
> 
> 标签：search, powershell

```
C:\docs

text1.txt
text2.txt
text3.txt
lol.txt
wut.txt
dudewut.txt 
```

搜索“wut”

*   我不想要递归解决方案。
*   我不想返回文件名。
*   我只想知道一个文件是否存在于一个返回布尔值的函数中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:27:07.127

@latkin 有正确的想法，只需使用通配符路径，例如：

```
Test-Path wut* 
```

或者

```
Test-Path C:\Docs\*wut* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T18:48:18.153

`Test-Path c:\docs\*wut* -PathType Leaf`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:15:08.893

```
$fileExhists = Get-ChildItem C:\docs -Recurse -Include *.* | Select-String wut 
```

然后我可以做类似的事情：

```
if(!$fileExhists){} 
```

但这并不是我真正想要的。这是递归的，不返回布尔值。

# ejb - 关于 GlassFish 运行

> ID：12394413
> 
> 赞同：0
> 
> 时间：2012-09-12T18:44:09.113
> 
> 标签：ejb, glassfish-3

我尝试使用 NetBeans IDE 和 GlassFish Server v3 运行 EJB 示例。当我运行我的客户端代码（具有 main 方法的类）时，我遇到了这个错误：

启动 GlassFish Server 3.1.2 GlassFish Server 3.1.2 Server 无法启动。端口被占用。C:\Users\7\Documents\NetBeansProjects\MDbexample\nbproject\build-impl.xml:907：部署错误：GlassFish Server 3.1.2 Server 无法启动。端口被占用。

所以我决定使用命令行运行 GlassFish：

c:\glassfish3\bin>asadmin 启动域

现在我在 cmd 环境中遇到了这个按摩：

有一个进程已经在使用管理端口 4848——它可能是 GlassFish 服务器的另一个实例。命令启动域失败。

有没有人知道如何解决我的问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T09:35:31.123

将行插入 /etc/hosts 说；

```
<HOSTNAME> <REALIP>
myMachine  10.102.55.45 
```

# cakephp - CakePHP 指定表名

> ID：12394418
> 
> 赞同：4
> 
> 时间：2012-09-12T18:44:27.687
> 
> 标签：cakephp

我有一个名为的表`entries`，其关联模型名为`Entry`. 我浏览了 CakePHP 网站上的博客教程。它指出不需要指定表名，因为它是根据模型名称计算的。( `Post => posts`)。

我怀疑 CakePHP 知道`Entry`它的复数形式是一个不合格的名词。那么如何设置我的模型使用的表格呢？我认为 CakePHP 会尝试访问该表`entrys`。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-12T18:56:52.170

您的问题的答案是在您的模型中指定它。

```
$useTable = 'yourtablename' 
```

尽管正如 Wooble 所指出的，您的怀疑是错误的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-11T04:55:14.840

Cakephp 3，改用这个：

[https://book.cakephp.org/3.0/en/orm/table-objects.html](https://book.cakephp.org/3.0/en/orm/table-objects.html)

```
class MyTable extends Table
{
    public function initialize(array $config)
    {
        parent::initialize($config);
        $this->setTable('my_table');
        $this->setAlias('MyTable');
    }
} 
```

# java - 有没有办法将 Flash 导入 Android 应用程序的 XML 或 JAVA？

> ID：12394423
> 
> 赞同：-1
> 
> 时间：2012-09-12T18:44:38.110
> 
> 标签：java, android, eclipse, flash, button

我正在 Eclipse IDE 中为 android 开发一个应用程序，我想知道是否有办法将我在 flash 中所做的任何事情导入到我的应用程序中。我刚刚在 Flash 中制作了一个简单的按钮，那么有没有办法将它导入到我在 Eclipse 中的应用程序中。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:35:03.570

无法在原生 android 中运行 ActionScript 或任何 Flash 动画。但是，您可以尝试使用相同的图形和可用的 android 库来复制该行为。我建议创建一个继承`Button`android 中的类并从那里开始的对象。

编辑：我做了一些谷歌搜索，发现了这个：[http](http://code.google.com/p/java-actionscript-api-for-android/) ://code.google.com/p/java-actionscript-api-for-android/ ，但这不会直接解决你的问题。

# bash - 了解管道和重定向命令

> ID：12394426
> 
> 赞同：3
> 
> 时间：2012-09-12T18:44:46.623
> 
> 标签：bash, pipe

我想了解管道和重定向命令的真正威力。根据我的理解，`|`将一个命令结果的输出作为自身的输入。而且，`>`有助于输出重定向。如果是这样，

```
find . -name "*.swp" | rm 
find . -name "*.swp" > rm 
```

为什么这个命令没有按预期工作。对我来说，上面的命令意味着

1.  递归查找当前目录下所有扩展名为 .swp 的文件。
2.  获取`1.` 并删除所有其结果文件的输出。

仅供参考，是的，我知道如何完成这项任务。可以通过传递`-exec`flag 来完成。

```
find . -name "*.swp"-exec rm -rf {} \; 
```

但正如我已经提到的，我想用`>`or`|`命令来完成它。
如果我错了并且走错了方向，请纠正我并解释重定向和管道命令。我们在哪里使用谁的命令？请不要提及我读过的所有简单书籍示例。试着向我解释一些复杂的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T18:48:15.387

我将通过您展示的三种方法对此进行分解：

*   `>`会将所有输出重定向`find`到一个名为的文件中`rm`（不起作用，因为您只是附加到一个文件）。
*   `|`将输出从管道传输`find`到`rm`命令中（不起作用，因为`rm`不读取`stdin`）
*   `-exec rm -rf {} \;`将在找到`rm -rf`的每个项目 ( `{}`)上运行`find`（将起作用，因为它将文件作为参数传递给`rm`）。

您将需要使用`-exec`标志或管道进入`xargs`命令 ( `man xargs`)，而不是`|`为了`>`实现所需的行为。

**编辑：**正如@dmckee 所说，您还可以使用`$()`运算符进行字符串插值，即：（`rm -rf $(find . -name "*.swp")`如果您有大量文件，由于参数长度限制，这将失败）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T18:55:12.527

> 简单地重定向到一个名为 rm 的文件。管道通过 | to rm 不起作用，因为 rm 不希望通过[STDIN](http://en.wikipedia.org/wiki/Standard_streams)获得文件名。所以你必须使用 xargs，它将来自 STDIN 的值作为参数传递：

```
find . -name "*.swp"|xargs rm 
```

这是危险的，因为文件名可能包含您的 shell 认为是字段分隔符 ($IFS) 的字符。所以，你使用：

```
find . -name "*.swp" -print0|xargs -0 rm 
```

这导致 find 打印文件名 \0 到 STDOUT 和 xargs 以读取文件名 \0 分隔并将它们作为参数传递给 rm。

当然，实现这一目标的最简单方法是：

```
rm **/*.swp 
```

假设你使用 bash。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T18:48:34.030

您应该花一些时间再次阅读有关 shell 重定向的基础知识 :) 我认为这是一个很好的文档：[http ://wiki.bash-hackers.org/howto/redirection_tutorial](http://wiki.bash-hackers.org/howto/redirection_tutorial)

我将尝试解释您出了什么问题：

```
find . -name "*.swp" | rm 
```

该命令将查找结果（即 find 的`stdout`）重定向到`stdin`程序的`rm`。但是，`rm`不会在标准输入上读取（这是您可以在 的文档中阅读的内容`rm`）。`rm`是通过命令行参数控制的，而不是通过`stdin`. 我认为根本没有办法`rm`从标准输入读取。这就是为什么没有删除任何内容。

```
find . -name "*.swp" > rm 
```

此命令将换行符分隔的查找结果（查找的标准输出）重定向到名为“rm”的文件。同样，没有任何内容被删除:)

基本上`<`， , `>`, `>>`, `&>`,运算符执行从/到**文件**系统中实际存在的文件`&>>`的重定向。管道将标准输出从一个命令重定向到另一个命令的标准输入。简单地说，这里不涉及任何文件。但是，这种方法只有在管道左侧的程序实际写入内容并且管道右侧的程序从中读取**并且**两个程序相互理解时才有意义，即读取程序（消费者）理解输出喂食计划。**`|``stdout``stdin`**

 ***** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T18:55:18.377

重定向创建一个文件。因此，您的`>rm`示例只是创建了一个名为的文件`./rm`，您的命令输出将保存在该文件中。

管道本质上是一种速记。`one | two`就像`one >tmp; two <tmp`除了没有（显式）临时文件。

当然，`rm`不会从标准输入中读取文件名，因此`cmd | rm`基本上是无用的（除了管道继续执行另一个命令的情况，该命令`rm`对未读取的输入执行某些操作）。如果你想要，有`xargs`.

```
find . -name "*.swp" | xargs rm 
```****

# google-maps - 如何在不向谷歌支付 10000 美元的情况下保护 Fusion 表层？

> ID：12394434
> 
> 赞同：0
> 
> 时间：2012-09-12T18:45:41.423
> 
> 标签：google-maps, google-fusion-tables

我正在开发一些独特的地图并希望在我的网站上发布它们，但这意味着我应该将这些地图“公开”并且任何人都可以下载它。项目不是以营利为目的的，这就是为什么我无法为 google maps api 商业帐户付费，但以某种方式保护我的地图会很好。你能告诉我有什么方法可以做到这一点而不需要向谷歌支付 10000 美元吗？

谢谢您的帮助！

PS这是一个公共网站

PS PS我不认为谷歌会为此提供资助......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:35:32.763

在非公开网站上免费使用 Google Maps API 违反了服务条款，因此无法完全按照您的要求进行操作。

您可以为非营利组织申请[Google Outreach Grant以使用 Google Maps API for Business](http://www.google.com/earth/outreach/grants/software/index.html)

如果这不是一个选项，您可以从技术上将表格的共享状态从“公开”更改为“知道链接的任何人”。这显然不是私人的，但有人必须深入研究您的 javascript 代码才能找到源表。如果您的地图未公开，则不太可能有人会发现您的数据。但是，虽然这在技术上是可行的，但它仍然违反了服务条款。

# android - android.support.v4.app.FragmentManagerImpl.makeInactive 处的 NullPointer 异常

> ID：12394437
> 
> 赞同：16
> 
> 时间：2012-09-12T18:46:02.730
> 
> 标签：android, android-fragments

我在 Android 支持库中看到一个奇怪的异常 - 堆栈跟踪如下。有什么想法可能导致这种情况吗？我无法在我的任何设备上重现异常，但在 Google Play DevConsole 中似乎有不少可见。

```
java.lang.NullPointerException
at android.support.v4.app.FragmentManagerImpl.makeInactive(FragmentManager.java:1133)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1044)
at android.support.v4.app.FragmentManagerImpl.removeFragment(FragmentManager.java:1171)
at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:582)
at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1416)
at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:420)
at android.os.Handler.handleCallback(Handler.java:608)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:156)
at android.app.ActivityThread.main(ActivityThread.java:5045)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:13:23.660

尝试在时间旋转屏幕中检查堆栈片段，例如在 onResume 中。

# javascript - javascript - 我的客户端选项是什么？

> ID：12394439
> 
> 赞同：1
> 
> 时间：2012-09-12T18:46:29.557
> 
> 标签：javascript, client-side, scientific-computing, scientific-software

我喜欢 javascript，不要误会我的意思，但我的问题是我目前想开发用于科学计算的开源 Web 应用程序，而 javascript 的算术并不是最精确的。我编写了服务器端脚本，但我更喜欢客户端，原因很明显，用户体验通常更流畅，服务器上的负载更少。

就解决此问题而言，我有哪些选择？我在某处读过，您可以在 javascript 之上实现语言——这值得吗？这看起来像什么？例如，如果我在 javascript 之上实现 python，这是否意味着客户端需要 python 解释器才能使用该站点？

我只是无法处理

```
0.1 + 0.2 == 0.3 // is False 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T18:51:09.763

浮点运算是近似计算

这没有错查看更多

[奇怪的编程行为](https://stackoverflow.com/a/12291065/560299)

这不是特定于 javascript，而是在整个编程中很常见

这是我在 chrome 上得到的：

```
0.1 + 0.2 = 0.30000000000000004; 
```

这是关于该主题的简单但出色的阅读：

[每个程序员都应该知道的关于浮点运算的知识](http://floating-point-gui.de/)

> **为什么我的数字，比如 0.1 + 0.2 加起来不是很好的 0.3 轮，而是得到一个奇怪的结果，比如 0.30000000000000004？**
> 
> 因为在内部，计算机使用的格式（二进制浮点）根本无法准确表示 0.1、0.2 或 0.3 之类的数字。
> 
> 当代码被编译或解释时，你的“0.1”已经被四舍五入到该格式中最接近的数字，这会在计算发生之前导致一个小的舍入误差。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:54:00.997

有一些库可以实现更好的数学运算：

*   [大号](http://jsfromhell.com/classes/bignumber)
*   [Big Js](https://github.com/whatgoodisaroad/Big-js)（不同的库）

但是，我强烈建议做这个服务器端。***您可以通过 AJAX***轻松完成，而不必担心响应速度。Javascript 并不是真正为数字而构建的。

# google-apps-script - 如何停止双击/双击表单？

> ID：12394440
> 
> 赞同：0
> 
> 时间：2012-09-12T18:46:53.800
> 
> 标签：google-apps-script

使用 UiApp 从表单收集数据，但我让用户双击提交按钮。这运行 doPost 两次。当然，他们必须快速点击才能让它实际发布两次，但它确实发生了。

我的问题是：有没有人有禁用提交按钮的经验，比如使用 onMouseUp？有一个更好的方法吗？我被告知要小心向按钮添加多个 onClick 处理程序，因为它可能不稳定。有什么稳定的解决方案吗？

我必须使用提交按钮，因为表单中有文件上传。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T04:30:27.273

我遇到过这个问题，自从 Google 推出 ClientHandlers 以来，就有了一条出路。只需将客户端处理程序添加到您的提交按钮禁用它（并记住在完成服务器处理程序函数或 doPost 后启用它）

```
var plswait = app.createClientHandler().forEventSource().setEnabled(false).setText('Please wait...'); 
var btnSubmit = app.createSubmit().addMouseDownHandler(plswait); 
```

是我的最爱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T12:42:07.953

我遇到了同样的问题，但为了解决这个问题，我创建了第二个“假”按钮，当单击提交按钮时该按钮变为可见，同时“真实”提交按钮的可见性设置为假。这是基本代码：

```
var button = app.createSubmitButton('Submit').setId("button")
  .setEnabled(false)

var falseButton = app.createButton('Submit').setId("falseButton")
  .setEnabled(false)
  .setVisible(false);

var handler = app.createClientHandler()
    .forTargets(button).setVisible(false)
    .forTargets(falseButton).setVisible(true); 

button.addClickHandler(handler);

panel.add(app.createHorizontalPanel().add(button).add(falseButton); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T21:46:34.400

第一个答案对我不起作用，因为 MouseDown 处理程序没有让 ServerHandler 运行。但它给了我正确的方向。在添加服务器处理程序之前，我刚刚添加了客户端处理程序以禁用按钮……这似乎可以防止双击。像这样：

```
 var submitButton = myapp.createButton("Submit");
  var myServerHandler = myapp.createServerClickHandler("myServerHandler");
  var pleaseWait = myapp.createClientHandler().forEventSource().setEnabled(false).setText('submitting...'); 
  submitButton.addClickHandler(pleaseWait);
  submitButton.addClickHandler(myServerHandler); 
```

# android - 开始录制时相机自动倾斜

> ID：12394444
> 
> 赞同：0
> 
> 时间：2012-09-12T18:47:13.320
> 
> 标签：android

我在我的应用程序中遇到了一个问题，因为当我开始通过相机录制时，它会倾斜到横向，这不是必需的。要求是录制应根据设备的方向开始。意味着如果设备处于纵向模式，则应以纵向开始录制，如果相机处于横向模式，则录制将以横向开始。

但在我们的例子中，当我们点击开始录制按钮时，相机方向将自动更改为横向，但设备仍为纵向。

所以，请提出任何解决方案。

**代码：**

```
package com.irant.cameraApplication;

import java.io.File;
import java.io.IOException;
import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.hardware.Camera;
import android.media.MediaRecorder;
import android.media.MediaRecorder.VideoEncoder;
import android.os.Bundle;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.Window;
import android.widget.Button;
import android.widget.Chronometer;
import android.widget.ImageButton;
import android.widget.Toast;

import com.irant.a1techno.CameraPlay;
import com.irant.a1techno.R;

/***
 *  TODO: 1\. sound on/off
 *  2\. resolution change
 * @author roman10
 *
 */

public class VideoCapture_New extends Activity implements SurfaceHolder.Callback {
    private SurfaceView prSurfaceView;
    private ImageButton prStartBtn, prFrontBackCamera;
    private Button prSettingsBtn;
    public String TAG = "IRANT";
    private boolean prRecordInProcess;
    private SurfaceHolder prSurfaceHolder;
    private Camera prCamera;
    private final String cVideoFilePath = "/sdcard/";
    Chronometer cm_VideoCapture;
    private Context prContext;
    public static boolean frontCamera= false;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        prContext = this.getApplicationContext();
        setContentView(R.layout.videocapture_new);
        Utils.createDirIfNotExist(cVideoFilePath);

        cm_VideoCapture = (Chronometer)findViewById(R.id.cm_VideoCapture);
        prSurfaceView = (SurfaceView) findViewById(R.id.surface_camera);
        prStartBtn = (ImageButton) findViewById(R.id.main_btn1);
        prFrontBackCamera = (ImageButton)findViewById(R.id.btn_frontBackCamera);

       // prSettingsBtn = (Button) findViewById(R.id.main_btn2);
        prRecordInProcess = false;
        prStartBtn.setOnClickListener(new View.OnClickListener() {
            //@Override
            public void onClick(View v) {
                if (prRecordInProcess == false) {
                    startRecording();
                    cm_VideoCapture.start();
                } else {
                    stopRecording();
                    cm_VideoCapture.stop();
                    Intent intent = new Intent(VideoCapture_New.this, CameraPlay.class);
                    startActivity(intent);
                }
            }
        });

        prFrontBackCamera.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                //prCamera = openFrontFacingCameraGingerbread();
                try{
            if(prCamera.getNumberOfCameras()==2)
            {
                if(frontCamera)
                {
                    frontCamera = false;
                    prCamera.stopPreview();
                    prMediaRecorder.release();
                    prMediaRecorder = null;
                    prCamera.release();
                    prCamera = null;
                }
                else
                {

                    frontCamera = true;
                    prCamera.stopPreview();
                    prMediaRecorder.release();
                    prMediaRecorder = null;
                    prCamera.release();
                    prCamera = null;
                }
                Intent intent = new Intent(VideoCapture_New.this, VideoCapture_New.class);
                startActivity(intent);
            }
            else
            {
                Toast.makeText(VideoCapture_New.this, "Your device doesn't contain Front Camera.", Toast.LENGTH_SHORT).show();
            }
                }catch(Exception e)
                {
                    e.printStackTrace();
                    Toast.makeText(VideoCapture_New.this, "Your device is not compatible for Front Camera.", Toast.LENGTH_SHORT).show();

                }

            }
        });

        prSurfaceHolder = prSurfaceView.getHolder();
        prSurfaceHolder.addCallback(this);
        prSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        prMediaRecorder = new MediaRecorder();
    }

    private Camera openFrontFacingCameraGingerbread() 
    {
         Camera camera = null;

            // Look for front-facing camera, using the Gingerbread API.
            // Java reflection is used for backwards compatibility with pre-Gingerbread APIs.
            try {
                Class<?> cameraClass = Class.forName("android.hardware.Camera");
                Object cameraInfo = null;
                Field field = null;
                int cameraCount = 0;
                Method getNumberOfCamerasMethod = cameraClass.getMethod( "getNumberOfCameras" );
                if ( getNumberOfCamerasMethod != null ) {
                    cameraCount = (Integer) getNumberOfCamerasMethod.invoke( null, (Object[]) null );
                }
                Class<?> cameraInfoClass = Class.forName("android.hardware.Camera$CameraInfo");
                if ( cameraInfoClass != null ) {
                    cameraInfo = cameraInfoClass.newInstance();
                }
                if ( cameraInfo != null ) {
                    field = cameraInfo.getClass().getField( "facing" );
                }
                Method getCameraInfoMethod = cameraClass.getMethod( "getCameraInfo", Integer.TYPE, cameraInfoClass );
                if ( getCameraInfoMethod != null && cameraInfoClass != null && field != null ) {
                    for ( int camIdx = 0; camIdx < cameraCount; camIdx++ ) {
                        getCameraInfoMethod.invoke( null, camIdx, cameraInfo );
                        int facing = field.getInt( cameraInfo );
                        if ( facing == 1 ) { // Camera.CameraInfo.CAMERA_FACING_FRONT 
                            try {
                                Method cameraOpenMethod = cameraClass.getMethod( "open", Integer.TYPE );
                                if ( cameraOpenMethod != null ) {
                                    camera = (Camera) cameraOpenMethod.invoke( null, camIdx );
                                }
                            } catch (RuntimeException e) {
                                Log.e(TAG, "Camera failed to open: " + e.getLocalizedMessage());
                                camera= prCamera;
                            }
                        }
                    }
                }
            }
            // Ignore the bevy of checked exceptions the Java Reflection API throws - if it fails, who cares.
            catch ( ClassNotFoundException e        ) {Log.e(TAG, "ClassNotFoundException" + e.getLocalizedMessage());}
            catch ( NoSuchMethodException e         ) {Log.e(TAG, "NoSuchMethodException" + e.getLocalizedMessage());}
            catch ( NoSuchFieldException e          ) {Log.e(TAG, "NoSuchFieldException" + e.getLocalizedMessage());}
            catch ( IllegalAccessException e        ) {Log.e(TAG, "IllegalAccessException" + e.getLocalizedMessage());}
            catch ( InvocationTargetException e     ) {Log.e(TAG, "InvocationTargetException" + e.getLocalizedMessage());}
            catch ( InstantiationException e        ) {Log.e(TAG, "InstantiationException" + e.getLocalizedMessage());}
            catch ( SecurityException e             ) {Log.e(TAG, "SecurityException" + e.getLocalizedMessage());}
            catch ( NullPointerException e             ) {Log.e(TAG, "NullPointerException" + e.getLocalizedMessage());}

            if ( camera == null ) {
                // Try using the pre-Gingerbread APIs to open the camera.
                try {
                    camera = Camera.open();
                } catch (RuntimeException e) {
                    Log.e(TAG, "Camera failed to open: " + e.getLocalizedMessage());
                }
            }

            return camera;
    }

    @Override
    public void surfaceChanged(SurfaceHolder _holder, int _format, int _width, int _height) {
        Camera.Parameters lParam = prCamera.getParameters();

        prCamera.setParameters(lParam);
        try {
            prCamera.setPreviewDisplay(_holder);
            prCamera.startPreview();
            //prPreviewRunning = true;
        } catch (IOException _le) {
            _le.printStackTrace();
        }
    }

    @Override
    public void surfaceCreated(SurfaceHolder arg0) {
        if(frontCamera == false)
        {
        prCamera = Camera.open();
        if (prCamera == null) {
            Toast.makeText(this.getApplicationContext(), "Camera is not available!", Toast.LENGTH_SHORT).show();
            finish();
        }
        }
        else if(frontCamera == true)
        {
            try{
         int cameraCount = 0;
            Camera.CameraInfo cameraInfo = new Camera.CameraInfo();
            cameraCount = Camera.getNumberOfCameras();
            for ( int camIdx = 0; camIdx < cameraCount; camIdx++ ) {
                Camera.getCameraInfo( camIdx, cameraInfo );
                if ( cameraInfo.facing == Camera.CameraInfo.CAMERA_FACING_FRONT  ) {
                    try {
                        prCamera = Camera.open( camIdx );
                    } catch (RuntimeException e) {
                        Log.i("Camera failed to open: ",e.getLocalizedMessage());
                    }
                }
            }
            }catch(Exception e)
            {
                Toast.makeText(VideoCapture_New.this, "Your Device doesn't compatible for Fron Camera.", Toast.LENGTH_SHORT).show();
            }
        }
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
        try {
            if (prRecordInProcess) {
                stopRecording();
            } else {
                prCamera.stopPreview();
            }
            prMediaRecorder.release();
            prMediaRecorder = null;
            prCamera.release();
            prCamera = null;
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    private MediaRecorder prMediaRecorder;
    private final int cMaxRecordDurationInMs = 30000;
    private final long cMaxFileSizeInBytes = 5000000;
    private final int cFrameRate = 20;
    private File prRecordedFile;

    private void updateEncodingOptions() {
        if (prRecordInProcess) {
            stopRecording();
            startRecording();
            Toast.makeText(prContext, "Recording restarted with new options!", Toast.LENGTH_SHORT).show();
        } else {
            Toast.makeText(prContext, "Recording options updated!", Toast.LENGTH_SHORT).show();
        }
    }

    private boolean startRecording() {
        prCamera.stopPreview();
        try {
            prCamera.unlock();
            prMediaRecorder.setCamera(prCamera);

            prMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

            String lVideoFileFullPath=".mp4";
            prMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
            String lDisplayMsg = "Current container format: ";
            prMediaRecorder.setVideoEncoder(VideoEncoder.H263);

            lDisplayMsg += "Current encoding format: ";

            lVideoFileFullPath = cVideoFilePath + "myvideo" + lVideoFileFullPath;
            //prMediaRecorder.setOrientationHint(360);
            prMediaRecorder.setVideoSize(176, 144); 
            prMediaRecorder.setVideoFrameRate(12);
            prRecordedFile = new File(lVideoFileFullPath);
            prMediaRecorder.setOutputFile(prRecordedFile.getPath());

            prMediaRecorder.setVideoFrameRate(cFrameRate);
            prMediaRecorder.setPreviewDisplay(prSurfaceHolder.getSurface());
            prMediaRecorder.setMaxDuration(cMaxRecordDurationInMs);
            prMediaRecorder.setMaxFileSize(cMaxFileSizeInBytes);
            //prepare for capturing
            //state: DataSourceConfigured => prepared
            prMediaRecorder.prepare();
            //start recording
            //state: prepared => recording
            prMediaRecorder.start();
            //prStartBtn.setText("Stop");
            prRecordInProcess = true;
            return true;
        } catch (IOException _le) {
            _le.printStackTrace();
            return false;
        }
    }

    private void stopRecording() {
        prMediaRecorder.stop();
        prMediaRecorder.reset();
        try {
            prCamera.reconnect();
        } catch (IOException e) {
            e.printStackTrace();
        }
        //prStartBtn.setText("Start");
        prRecordInProcess = false;
        prCamera.startPreview();
    }

    private static final int REQUEST_DECODING_OPTIONS = 0;
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
        super.onActivityResult(requestCode, resultCode, intent);
        switch (requestCode) {
        case REQUEST_DECODING_OPTIONS:
            if (resultCode == RESULT_OK) {
                updateEncodingOptions();
            }
            break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:51:16.303

我有同样的问题，这个小片段修复了它

```
 Camera.CameraInfo info = new android.hardware.Camera.CameraInfo();
        Camera.getCameraInfo(0, info);
        int rotation = getWindowManager().getDefaultDisplay().getRotation();
        int degrees = 0;
        switch (rotation) {
            case Surface.ROTATION_0: degrees = 0; break;
            case Surface.ROTATION_90: degrees = 90; break;
            case Surface.ROTATION_180: degrees = 180; break;
            case Surface.ROTATION_270: degrees = 270; break;
        }

        int result;
        if (info.facing == Camera.CameraInfo.CAMERA_FACING_FRONT) {
            result = (info.orientation + degrees) % 360;
            result = (360 - result) % 360;  // compensate the mirror
        } else {  // back-facing
            result = (info.orientation - degrees + 360) % 360;
        }

        this.mRotation = result;

        mCamera.setDisplayOrientation(result); 
```

我不确定为什么它没有以当前的手机方向启动，但我确信这可以解决它。

# android - 在 HTML 页面中移动 swf 对象

> ID：12394450
> 
> 赞同：1
> 
> 时间：2012-09-12T18:47:41.210
> 
> 标签：android, html, position, swfobject

我对开发很陌生（这是我的第一个项目，我正在学习）所以可能有一个非常简单的答案！

我正在为广播电台创建一个 android 应用程序，使用 Appmobi XDK 用 HTML 编写。该电台使用了一个直播地址，但我知道 android 很难处理这个问题，所以我将直播 IP 嵌入到我在网上找到的 flash 播放器模板 div 中。但是，我无法让 div 更改 HTML 页面上的位置，它总是停留在左上角，否则就会消失。我尝试使用样式 TOP: LEFT 等以及 align:center，但两者都不起作用。所以我想知道有没有人知道我如何将它移动到页面上我想要的位置。

我已经为下面的 div 和代码提供了 HTML。如果有人知道如何解决这个问题，我将不胜感激！谢谢你！

```
 "<div id="container"> <a href="http://www.macromedia.com/go/getflashplayer">Get the Flash Player</a> to see this player.
 <a href="http://www.shoutcheap.com/shoutcast/">shoutcast server hosting</a>
 <a href="http://www.shoutcheap.com/icecast/">icecast server hosting</a></div>
 <script type="text/javascript" src="http://www.shoutcheap.com/flashplayer/swfobject.js"></script>
 <script type="text/css" style= "TOP:700; LEFT:250; ">
 var s1 = new SWFObject("http://www.shoutcheap.com/flashplayer/player.swf" ,
 "ply","250","50","9","#FFFFFF");
 s1.addParam("allowfullscreen","true");
 s1.addParam("allowscriptaccess","always");
 s1.addParam("flashvars",
 "file=http://50.7.244.222:10074/;stream.nsv&type=mp3&volume=50&autostart=true");
 s1.write("container");" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:53:43.773

试试这个适合你的风格

```
position: absolute;
left: 50%;
top: 700px; // distance from the top of the page
margin-left: -125px; // subtract half the width of the document to align center 
```

# facebook-graph-api - 自定义付款人促销

> ID：12394453
> 
> 赞同：1
> 
> 时间：2012-09-12T18:48:08.437
> 
> 标签：facebook-graph-api, customization, promotions

为了实施自定义促销单元，我需要知道 Facebook 将免费为用户提供的具体金额。有没有办法确定当前 Facebook 优惠的价值？

[自定义 PP 单位参考](http://developers.facebook.com/docs/payments/payer_promotion/#custom_pp_unit)

# jquery - 选定的单选按钮值未通过 JQuery 传递

> ID：12394457
> 
> 赞同：0
> 
> 时间：2012-09-12T18:48:16.450
> 
> 标签：jquery

我正在使用它将几个字段的值收集到一个字段中。除单选按钮值外，所有内容均已正确传递。

```
 jQuery('#donate-form').submit(function() {
 jQuery('[name="COMMENT2"]').val('Donation: ' + jQuery('.active [name="USER2"]').val() + ': ' + jQuery('input[name="reason"]:checked').val() + ': ' + jQuery('[name="sponsorName"]').val() + 
                ' Occasion: ' + jQuery('.active [name="occasion"]').val() + ' Donated By: ' + jQuery('.active [name="donatedBy"]').val() + ' Use: ' + jQuery('input[name="day"]:checked').val() + 
                ' Date: ' + jQuery('[name="date"]').val() + ' Contact Me: ' + jQuery('[name="contactMe"]').val()); 
 }); 
```

HTML

```
<div class="row"><label for="amount">Amount:</label><input id="amount 2" name="AMOUNT" type="text" class="required"/><br/></div>
    <div class="row">
        <input name="reason" type="radio" id="memory" value="In Memory of" /><label for="memory">In Memory of</label>
        <input name="reason" type="radio" id="honor" value="In Honor of"/><label for="honor">In Honor of</label>
        <input name="reason" type="radio" id="noOccasion" value="No Occasion"/><label for="noOccasion">No Occasion</label>
    <br/></div>
    <div class="row"><label for="sponsorName">Name(s):</label>
        <input id="sponsorName" name="sponsorName" type="text"/><br/></div>
    <div class="row"><label for="occasion">Occasion:</label>
        <input id="occasion" name="occasion" type="text"/><br/></div>
    <div class="row"><label for="donatedBy">Donated By:</label>
        <input id="donatedBy" name="donatedBy" type="text"/><br/></div>
    <div class="row">Make a request to reserver your special day:</div>
    <div class="row">
        <input name="day" type="radio" id="English" value="English Date"/>
            <label for="English">English Date</label>
        <input name="day" type="radio" id="Hebrew" value="Hebrew Date"/>
            <label for="Hebrew">Hebrew Date</label>
    </div>
    <div class="row"><label for="date">Date:</label>
        <input id="date" name="date" type="text"/><br/></div>
    <div class="row"><input type="checkbox" name="contactMe" value="yes" id="contactMe" /><label class="long" for="contactMe">Contact me for acknowledgement notices.</label></div>
    <div class="row"><label for="comments">Comments</label><textarea id="comments" name="COMMENT1" cols="38" rows="1" style="margin-left:0"></textarea></div>
    <input type="hidden" name="COMMENT2" value=""></input><input type="hidden" name="DESCRIPTION"></input>
  </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:52:53.153

这段代码什么时候运行？假设您只想要检查的值，您尝试从单选按钮获取值的方式应该可以工作......

我在这里设置了一个基本演示[来](http://jsfiddle.net/ygxyt/)显示这一点。只需单击“英文日期”单选按钮即可查看它的运行情况。

# javascript - 当 Google 地图进入街景时，我可以锁定哪些事件？

> ID：12394468
> 
> 赞同：2
> 
> 时间：2012-09-12T18:48:59.233
> 
> 标签：javascript, google-maps-api-3, dom-events, google-street-view

每当用户在 Google 地图（js API v3）中从俯视图切换到街景时，我想触发 Javascript 函数。

理想情况下，我可以找到一个可以挂起侦听器的地图级事件——当地图（`map`在我的代码中方便地调用它的对象）从俯视图变为街景时触发的事件。

我试过`maptypeid_changed`and `zoom_changed`，没有成功。（当俯视图的类型或缩放发生变化时，我的功能运行良好，但到街景的转换似乎不会触发任何一个事件。）有谁知道我是否可以听到地图级别（而不是全景级别）事件为了？如果有，是哪个事件？

如果做不到这一点，是否有一个属性`map.streetView`我可以简单地每 30 秒检查一次以查看用户是否正在查看街景？我曾认为查看 boolean 的值`map.streetView.visible`可能会奏效，但看起来这只是表明当前区域是否有数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:54:54.977

根据 Duncan_m，这个问题实际上已经得到了回答。

请参阅[检测 Google 地图街景模式](https://stackoverflow.com/questions/7251738/detecting-google-maps-streetview-mode)

# search - Drupal 背后的 Solr 为特定查询返回太多结果

> ID：12394470
> 
> 赞同：1
> 
> 时间：2012-09-12T18:49:08.640
> 
> 标签：search, drupal, solr

我们让 Solr 坐在我们客户的 Drupal 7 网站之一后面，虽然它运行良好，但对于应该非常具体的查询，它返回了太多结果。（它也有相关性/加权问题；但我希望解决这个问题将消除 - 从字面上 - 不相关的结果。）

例如，搜索短语 'particular phrase in london' 应该返回以它为标题的节点，非常高；我什至认为不应该返回任何其他内容。但我发现它返回了很多内容，纯粹是因为它提到了“伦敦”！

轻率地，搜索荒谬的短语“伦敦的馅饼”也会返回很多结果，显然只是因为他们提到了伦敦。网站上没有任何内容提到实际的馅饼皮。

当我搜索“伦敦的特定短语”时，以下是最终出现在服务器上 catalina.out 日志中的参数（为清楚起见，添加了空格）：

```
{spellcheck=false&facet=true&f.im_field_health_topic.facet.mincount=1
 &facet.mincount=1&f.ds_created.facet.date.gap=%2B1YEAR
 &spellcheck.q=particular+phrase+in+london
 &qf=taxonomy_names^2.0&qf=path_alias^5.0&qf=content^40&qf=label^21.0
 &qf=tos_content_extra^1.0&qf=ts_comments^20&qf=tm_vid_3_names^200
 &facet.date=ds_created
 &f.ds_created.facet.date.start=1970-01-01T00:00:00Z/YEAR
 &f.bundle.facet.mincount=1&hl.fl=content,ts_comments
 &json.nl=map&wt=json&rows=10&fl=id,entity_id,entity_type,bundle,bundle_name,
   label,is_comment_count,ds_created,ds_changed,score,path,url,is_uid,
   tos_name,tm_node,zs_entity
 &start=0&facet.sort=count&f.bundle.facet.limit=50&q=special+phrase+in+london
 &f.ds_created.facet.date.end=2012-01-01T00:00:00Z%2B1YEAR/YEAR
 &bf=recip(ms(NOW,ds_created),3.16e-11,1,1)^150.0
 &facet.field=im_field_health_topic&facet.field=bundle
 &f.im_field_health_topic.facet.limit=50&f.ds_created.facet.limit=50}
hits=1998 status=0 QTime=14 
```

请注意，这些参数是由 Drupal 的 Apache Solr 模块构建的；我不相信我们有任何我们自己的特定自定义代码可以对它做任何事情。

如果直接在浏览器中输入，这对应于以下 URL：

[http://example.com:8081/solr/CLIENT/select?spellcheck=false&facet=true&f.im_field_health_topic.facet.mincount=1&facet.mincount=1&f.ds_created.facet.date.gap=%2B1YEAR&spellcheck.q=particular+phrase +in+伦敦&qf=taxonomy_names](http://example.com:8081/solr/CLIENT/select?spellcheck=false&facet=true&f.im_field_health_topic.facet.mincount=1&facet.mincount=1&f.ds_created.facet.date.gap=%2B1YEAR&spellcheck.q=particular+phrase+in+London&qf=taxonomy_names)^2.0&qf=path_alias^5.0&qf=content^40&qf=label^21.0&qf=tos_content_extra^1.0&qf=ts_comments^20&qf=tm_vid_3_names^200&facet.date=ds_created&f.ds_created.facet.date.start=1970-01-01T00:00 :00Z/YEAR&f.bundle.facet.mincount=1&hl.fl=content,ts_comments&json.nl=map&wt=json&rows=10&fl=id,entity_id,entity_type,bundle,bundle_name,label,is_comment_count,ds_created,ds_changed,score,path,url ,is_uid,tos_name,tm_node,zs_entity&start=0&facet.sort=count&f.bundle.facet.limit=50&q=particular+phrase+in+London&f.ds_created.facet.date.end=2012-01-01T00:00:00Z%2B1YEAR /YEAR&bf=recip(ms(NOW,ds_created),3.16e-11,1,1)^150.0&facet.field=im_field_health_topic&facet.field=bundle&f.im_field_health_topic.facet.limit=50&f.ds_created.facet.limit=50

此 URL 返回近 2000 个结果 - 这是网站上的大部分内容！我已经尝试一次删除每个查询参数，唯一有任何区别的似乎是 qf 和 q：如果我删除 qf，则结果为零；如果我删除 q，我会得到更多结果！

我想这里有两个问题：

1.  这些参数中是否有任何内容告诉 Solr“不要担心出现‘特定短语’或‘馅饼皮’：只需整理‘伦敦’的结果”，然后按相关性排序？我要补充一点，我认为停用词文件中提到了“in”，所以我们可以忽略它的影响（？）
2.  或者这是我需要更改的（标准 Drupal）模式中的内容吗？

我很欣赏有时搜索对访问者来说更好，如果它具有包容性；即使没有找到完美匹配，Google 也会返回结果。但是，除了停用词和词干之外，客户端确实要求搜索只返回所有单词都出现在内容中的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T12:42:05.620

正如在[http://drupal.org/node/1783454](http://drupal.org/node/1783454)的帖子中提到的，Apache Solr 搜索集成模块使用了[mm](http://wiki.apache.org/solr/DisMaxQParserPlugin#mm_.28Minimum_.27Should.27_Match.29)参数，它或多或少地配置为通过关键字在数据集中的接近程度来影响排名。查看文档还有其他方法可以使用该参数来影响排名。因此，Apache Solr Search Integration 生成的结果的权重更接近于 AND 运算符，尽管它会在您添加更多关键字时返回更多结果。这个参数的好处是在用户输入的关键字过于严格的情况下，仍然会返回结果。不显示任何结果是引导人们离开您的网站的一种非常快速的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:56:06.643

你如何显示搜索？也许您可以通过解决视图来限制搜索范围？ [http://drupal.org/project/apachesolr_views](http://drupal.org/project/apachesolr_views) 谢谢

缺口

# scala - 如何在 Eclipse Juno 中配置 scaladoc？

> ID：12394471
> 
> 赞同：1
> 
> 时间：2012-09-12T18:49:08.493
> 
> 标签：scala, documentation, scala-ide, scaladoc

我是新来的斯卡拉。自从我使用 eclipse juno 以来，我已经安装了 nightly build。我面临的问题是当光标位于类/特征上并且我按 F2 时我看不到 scaladoc（就像在 java 中一样）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:32:59.313

那是因为它还没有实现。有关更多信息和未来工作，请参阅票证[#1000954](https://scala-ide-portfolio.assembla.com/spaces/scala-ide/tickets/1000954-include-type-information-in-f2-popup-window)和[#1000210 。](https://scala-ide-portfolio.assembla.com/spaces/scala-ide/tickets/1000210-scaladoc-integration-with-code-completion)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T07:43:08.877

作为穷人的选择，JavaDoc 视图适用于 Java 元素。您可以启用它`Window/Show View`，它会向您显示与光标下的元素相关的文档，只要它来自 Java（即使在 Scala 代码中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-29T11:26:57.597

对于 SO 的完整性：Scaladoc 现在已集成自Scala-IDE 插件的[4.0.0 RC1 版本。](http://scala-ide.org/blog/release-notes-4.0.0-RC1.html)

# c++ - 使用 Boost 序列化和反序列化 JSON

> ID：12394472
> 
> 赞同：71
> 
> 时间：2012-09-12T18:49:11.940
> 
> 标签：c++, json, boost, boost-propertytree

我是 C++ 的新手。`std::Map`使用`boost`.序列化和反序列化类型数据的最简单方法是什么？我发现了一些使用的例子，`PropertyTree`但它们对我来说很模糊。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-10-04T20:09:55.927

请注意，`property_tree`将键解释为路径，例如，放置“ab”="z" 对将创建一个 {"a":{"b":"z"}} JSON，而不是 {"ab":"z"} . 否则，使用`property_tree`是微不足道的。这是一个小例子。

```
#include <sstream>
#include <map>
#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/json_parser.hpp>

using boost::property_tree::ptree;
using boost::property_tree::read_json;
using boost::property_tree::write_json;

void example() {
  // Write json.
  ptree pt;
  pt.put ("foo", "bar");
  std::ostringstream buf; 
  write_json (buf, pt, false);
  std::string json = buf.str(); // {"foo":"bar"}

  // Read json.
  ptree pt2;
  std::istringstream is (json);
  read_json (is, pt2);
  std::string foo = pt2.get<std::string> ("foo");
}

std::string map2json (const std::map<std::string, std::string>& map) {
  ptree pt; 
  for (auto& entry: map) 
      pt.put (entry.first, entry.second);
  std::ostringstream buf; 
  write_json (buf, pt, false); 
  return buf.str();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-02-02T16:15:25.927

Boost 版本 1.75 及更高版本现在具有强大的本机 JSON 库：

[https://www.boost.org/doc/libs/develop/libs/json/doc/html/index.html](https://www.boost.org/doc/libs/develop/libs/json/doc/html/index.html)

我不再建议使用 Boost.PropertyTree 的 JSON 算法，因为它们不完全符合规范。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-11-07T22:47:29.803

一些公司要求我实现比 boost 库更快的 JSON 序列化库。我做到了——它比 boost lib 快了约 10 倍。我发布代码供任何人使用。

```
#pragma once
#include <string>
#include <vector>
#include <regex>
#include <fstream>

enum class JsonNodeType { Array, Object, String };

class JsonNode
{
    JsonNodeType m_nodeType;

    std::vector<JsonNode*>* m_values{0};
    std::vector<std::string>* m_keys{0};
    std::string m_value{};
    inline static int m_indent;
    inline static bool m_formatOutput;
    const int m_indentInc{4};

public:

    JsonNode(JsonNodeType type) 
    {
        m_nodeType = type;

        switch (m_nodeType) {
            case JsonNodeType::Object: m_keys = new std::vector<std::string>();
                                       [[fallthrough]];
            case JsonNodeType::Array: m_values = new std::vector<JsonNode*>();
        }
    };

    JsonNode(std::string value) 
    {
        m_nodeType = JsonNodeType::String;
        m_value = value;
    }

    ~JsonNode() 
    {

        if (m_values)       
            for (JsonNode* node : *m_values)
                delete node;

        delete m_values; 
        delete m_keys; 
    }

    void Add(JsonNode* node) 
    {               
        assert(m_nodeType == JsonNodeType::Array);

        m_values->push_back(node);
    }

    void Add(const char* key, JsonNode* node) 
    {       
        assert(m_nodeType == JsonNodeType::Object);

        m_values->push_back(node);
        m_keys->push_back(key);
    }

    void Add(const char* key, std::string value) 
    {       
        assert(m_nodeType == JsonNodeType::Object);

        m_keys->push_back(key);
        m_values->push_back(new JsonNode(value));
    }

    void Add(std::string value) 
    {
        assert(m_nodeType == JsonNodeType::Array);

        m_values->push_back(new JsonNode(value));
    }

    void Add(int value) 
    {
        assert(m_nodeType == JsonNodeType::Array);

        m_values->push_back(new JsonNode(std::to_string(value)));
    }

    void Add(const char* key, bool value) 
    {
        assert(m_nodeType == JsonNodeType::Object);

        m_keys->push_back(key);
        m_values->push_back(new JsonNode(value ? "true" : "false"));
    }

    void OutputToStream(std::ostream& ofs, bool formatOutput = true) 
    {
        m_indent = 0;       
        m_formatOutput = formatOutput;

        OutputNodeToStream(ofs);

        ofs << std::endl;
    }

    std::string EscapeString(std::string& str) 
    {   
        std::regex html2json("\\\\|\\/|\\\"");
        std::regex newline("\n");

        std::string tmp = std::regex_replace(str, html2json, "\\$&");   
        return std::regex_replace(tmp, newline, "\\n");
    }

private: 

    void OutputNodeToStream(std::ostream& ofs) 
    {
        switch (m_nodeType) {

            case JsonNodeType::String:
                ofs << "\"" << m_value << "\"";
                break;

            case JsonNodeType::Object:
                OutputObjectToStream(ofs);
                break;

            case JsonNodeType::Array:
                OutputArrayToStream(ofs);
                break;
        }

    }

    void ChangeIndent(std::ostream& ofs, int indentDelta) 
    {

        if (!m_formatOutput)
            return;

        m_indent += indentDelta;

        ofs << std::endl;
    }

    void OutputIndents(std::ostream& ofs) 
    {

        if (!m_formatOutput)
            return;

        for (int i = 0; i < m_indent; i++)
            ofs << " ";
    }

    void OutputObjectToStream(std::ostream& ofs) 
    {

        assert(m_nodeType == JsonNodeType::Object);
        assert(m_keys->size() == m_values->size());

        if (m_keys->empty()) 
        {
            ofs << "\"\"";
            return;
        }

        ofs << "{";     

        ChangeIndent(ofs, m_indentInc);

        for (int i = 0; i < m_keys->size(); i++) 
        {

            if (i > 0)
                ofs << ",";

            if (i > 0 && m_formatOutput)
                ofs << std::endl;

            OutputIndents(ofs);

            ofs << "\"" << m_keys->at(i) << "\": ";

            m_values->at(i)->OutputNodeToStream(ofs);
        }   

        ChangeIndent(ofs, -m_indentInc);
        OutputIndents(ofs);
        ofs << "}";     
    }

    void OutputArrayToStream(std::ostream& ofs) 
    {

        assert(m_nodeType == JsonNodeType::Array);

        if (m_values->empty()) 
        {
            ofs << "\"\"";
            return;
        }

        ofs << "[";

        ChangeIndent(ofs, m_indentInc);

        for (int i = 0; i < m_values->size(); i++) 
        {

            if (i > 0)
                ofs << ",";

            if(i > 0 && m_formatOutput)
                ofs << std::endl;

            OutputIndents(ofs);         

            m_values->at(i)->OutputNodeToStream(ofs);
        }

        ChangeIndent(ofs, -m_indentInc);
        OutputIndents(ofs);
        ofs << "]";     
    }

}; 
```

使用示例

创建 json 树：

```
JsonNode* Circuit::GetMyJson()
{
    JsonNode* node = new JsonNode(JsonNodeType::Object);

    JsonNode* gates = new JsonNode(JsonNodeType::Array);

    for (auto& [k, v] : m_gates)
        gates->Add(v.GetMyJson());

    node->Add("gates", gates);

    return node;
} 
```

输出树：

```
std::unique_ptr<JsonNode> node (simulation->GetMyJson());
std::ofstream output("output.json", std::ios::out);
node->OutputToStream(output); 
```

# php - 通过两个选择选项过滤结果

> ID：12394474
> 
> 赞同：1
> 
> 时间：2012-09-12T18:49:24.157
> 
> 标签：php, mysql, sql

我的表名是`ads`这样的：

```
 id    ad_country          ad_gender     ad_birthday
     1     05                       01              2012-02-26
     2     15                       02              2011-05-29
     3     78                       02              2010-04-12 
```

和这样的桌子`field_values`：

```
 fieldid    fieldtitle  fieldvalue
   14         Male         01                // ads.ad_gender =  field_values.fieldvalue
   14         Female       02                //ads.ad_country =  field_values.fieldvalue
   13         Afghanistan  03 
   13         Albania      04
   13           Algeria    05
  ...             ...                ... 
```

**和代码：**

```
 session_start();
    if (isset($_POST['country'])){

         $country = $_POST['country']; 
        $_SESSION['country'] = $_POST['country'];
            }
    if (isset($_POST['year'])){
       $year = $_POST['year']; 
       $_SESSION['year'] = $_POST['year'];
       } 
```

我有两个下拉选择选项

**一种是选择国家选项：**

```
 <form action="" id="countryform" method="post">
   <select id="country" name ="country" size="1" class="select" onchange="this.form.submit();;" >
       <option value="0" >Please Select a Country</option>

              <?php 
    $sql = mysql_query ("SELECT * FROM field_values WHERE fieldid = 13 GROUP BY fieldtitle ");
            while ($row = mysql_fetch_array($sql) ){  
            ?>

       <option value="<?php echo $row['fieldtitle'] ;?>" <?php

           if ($country == $row['fieldtitle']) { echo " selected='selected'"; } ?> > <?php echo $row['fieldtitle'] ;?>
      </option>
             <?php } ?>
   </select>
    <input type="hidden" name="hiddenselect" value="<?php echo $country;  ?>" />
 </form> 
```

**一个是选择年份选项：**

```
<form action="" id="yearform" method="post">
  <select id="year" name ="year" size="1" class="select" onchange="this.form.submit();;" >
       <option value="0" >Please Select the Year</option>

<?php 
 $sql6 = mysql_query("SELECT  ad_birthday,(substr(ad_birthday , 1, 4)) AS year FROM ads GROUP BY year ") ;
while ($row6 = mysql_fetch_array($sql6) ){
   ?>

  <option value="<?php echo $row6['year'] ;?>" <?php

    if ($year == $row6['year']) { echo " selected='selected'"; } ?> > <?php echo $row6['year'] ;?>
  </option>
   <?php } ?>
  </select>
  <input type="hidden" name="hiddenselect" value="<?php echo $year;  ?>" />
</form> 
```

**回声部分如下：**

```
 $sql2 = mysql_query("SELECT COUNT(ad_gender) AS male FROM ads INNER JOIN  field_values ON  field_values.fieldvalue = ads.ad_country WHERE '".$_POST['country']."' = field_values.fieldtitle AND ad_gender = 01  ");
           $row2 = mysql_fetch_array($sql2) ; 
        $sql3 = mysql_query("SELECT COUNT(ad_gender) AS female FROM ads INNER JOIN  field_values ON  field_values.fieldvalue = ads.ad_country WHERE '".$_POST['country']."' = field_values.fieldtitle AND ad_gender = 02  ");
           $row3 = mysql_fetch_array($sql3) ; 

          echo "There are ".$row2['male']." male <br />";
          echo "There are ".$row3['female']." female<br />"; 
```

但我无法解决它，我认为 if isset 语句中缺少某些内容。

**我想要的是：**

如果我选择国家和年份，它将反映这个国家和今年有多少男性和女性。谢谢你的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:26:05.967

```
SELECT c.gender, COUNT(*) AS 'count'
FROM ads a 
INNER JOIN 
    (SELECT fieldvalue, fieldtitle AS country FROM field_values) b 
        ON b.fieldvalue = a.ad_country
INNER JOIN
    (SELECT fieldvalue, fieldtitle AS gender FROM field_values) c
        ON c.fieldvalue = a.ad_gender
GROUP BY c.gender 
```

您可以在之前添加以下过滤器`GROUP BY`：

*   年：`WHERE YEAR(a.ad_birthday) = '2012'`
*   国家：`WHERE b.country = 'Albania'`

看到它[在行动](http://sqlfiddle.com/#!2/3ad66/1)。

然后将`mysql_`函数转换为`mysqli_`or `PDO`（因为它已被[弃用](http://www.deprecatedphp.com)）后，您可以简单地按性别显示结果：

```
| 性别 | 计数 |
------------------
| 女 | 2 |
| 男 | 1 |
```

**更新 1**

要实现此代码，您可以尝试这样的事情（未测试）：

```
$link = mysqli_connect("localhost", "user_name", "password", "stock");

if (mysqli_connect_error()) {
die('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());
}

$stmt = mysqli_prepare($link, "SELECT c.gender, COUNT(*) AS 'count' FROM ads a 
INNER JOIN (SELECT fieldvalue, fieldtitle AS country FROM field_values) b ON b.fieldvalue = a.ad_country
INNER JOIN (SELECT fieldvalue, fieldtitle AS gender FROM field_values) c ON c.fieldvalue = a.ad_gender
WHERE b.country = ? AND (YEAR(a.ad_birthday) = ? OR YEAR(a.ad_birthday) <> NULL) GROUP BY c.gender");

mysqli_bind_param($stmt, 'ss', $country, $year) or die(mysqli_error($dbh));

$result = mysqli_stmt_execute($stmt) or die(mysqli_error($link));

while($row = mysqli_fetch_assoc($result)) {
echo "There are " . $row[count] . ' ' . $row[gender] . "<br />\n";
}

mysqli_close($link); 
```

**更新 2**

`mysqli`由于您由于某种原因无法使用，下面的代码应该可以工作。请注意，它假定国家不为空。

```
$query = "SELECT c.gender, COUNT(*) AS 'count' FROM ads a 
    INNER JOIN (SELECT fieldvalue, fieldtitle AS country FROM field_values) b ON b.fieldvalue = a.ad_country
    INNER JOIN (SELECT fieldvalue, fieldtitle AS gender FROM field_values) c ON c.fieldvalue = a.ad_gender
    WHERE b.country = " . mysql_real_escape_string($country);

if(isset($year)) $query .= " AND YEAR(a.ad_birthday) = " . mysql_real_escape_string($year);

$query .= ' GROUP BY c.gender';

$sql2 = mysql_query($query);
while($row = mysql_fetch_assoc($sql2)) {
    echo "There are " . $row[count] . ' ' . $row[gender] . "<br />\n";
} 
```

# javascript - 有没有办法列出 Ember.Object 的所有绑定？

> ID：12394477
> 
> 赞同：6
> 
> 时间：2012-09-12T18:49:43.680
> 
> 标签：javascript, ember.js

咖啡脚本中的示例

```
window.APP = Ember.Application.create()

APP.stuff = Ember.Object.create(
  name: "The Name"
)

APP.things = Ember.Object.create(
  nameBinding: "APP.stuff.name"
)

APP.gizmos = Ember.Object.create(
  nameBinding: "APP.stuff.name"
) 
```

有没有办法检测到 APP.stuff 有 2 个绑定到它的 name 属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:05:52.810

经过大量源代码的挖掘，我终于找到了答案......

我不确定开发人员是否推荐这种方法......但它给了我想要的东西。

基本上答案是打电话...

```
Ember.meta(APP.stuff) 
```

这将返回一个包含“观察”哈希的对象，其中包含被观察的属性和观察者的数量。

Ember 很酷。

# wordpress - 如何将 wordpress 帖子自动发布到 facebook 群组

> ID：12394479
> 
> 赞同：1
> 
> 时间：2012-09-12T18:49:44.570
> 
> 标签：wordpress, facebook, rss, facebook-group

我想在我担任管理员的所有群组中发布一篇文章。是否有插件或一些代码可以做到这一点？到目前为止，我已经做到了：

首先--->建立了一个类别，例如组第二个--->从我的博客复制RSS提要地址并将其粘贴到包含的RSS 2.0提要（涂鸦）应用程序中。

当然，它也会运行，但它会通过 RSS 涂鸦而不是我的应用程序出现，就像我通常在我的粉丝页面或个人资料上所做的那样。感谢所有答案

对不起，我来自德国，很容易回答！

# php - 开始使用 mysqli 并读取致命错误

> ID：12394482
> 
> 赞同：-1
> 
> 时间：2012-09-12T18:50:14.107
> 
> 标签：php, mysqli, mysql-error-1064

这是代码

```
require_once 'functions.php';
require_once 'cfg.php';
$mysqli = new mysqli($dbhost, $dbuser, $dbpass, $db);
if ($mysqli->connect_error) {
    die('Connect Error (' . $mysqli->connect_errno . ') '. $mysqli->connect_error);
}
$query='SELECT * FROM cobra';
$result=$mysqli->prepare($query);
$result->execute();
$result->close();
echo array_values($result); 
```

我得到一个又一个错误。最初，我将查询部分包含在一个函数中，但不断遇到各种 $mysqli 变量范围的问题。

最近的错误是：**致命错误：在第 11 行的 ...cobra/lib/distro.php 中的非对象上调用成员函数 execute()**

第 11 行是：

```
$result->execute(); 
```

我想了解一些有关解决此问题的不同方法的背景知识。我正在尽我所能学习，但也很快接近最后期限。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:54:16.583

prepare没有返回语句句柄，而是false，表示prepare没有按预期运行。

你可以试试这个：

```
$mysqli = new mysqli($dbhost, $dbuser, $dbpass, $db);
if ($mysqli->connect_error) {
    die('Connect Error (' . $mysqli->connect_errno . ') '. $mysqli->connect_error);
}
$query =' SELECT * FROM cobra';
$stmt = $mysqli->prepare($query);
if (!$stmt)
  die($mysqli->error);

$stmt->execute();

echo array_values($stmt->fetch());

$stmt->close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:55:32.903

您需要检查这`$result`是一个有效的`mysqli_stmt`对象。

```
$query='SELECT * FROM cobra';
$result=$mysqli->prepare($query);
if ($result instanceof mysqli_stmt) {
    $result->execute();
} else {
    // determine what went wrong
    echo $mysqli->error;
} 
```

# sql - 如何从函数调用 Oracle 存储过程

> ID：12394483
> 
> 赞同：-2
> 
> 时间：2012-09-12T18:50:18.727
> 
> 标签：sql, oracle

我有一个非常复杂的 Oracle 包，其中包含多个过程、函数、记录等。我想做的是在 BI Admin 工具中将存储过程作为物理表访问，但该工具不支持将 Oracle 存储过程定义为表，并建议将 SP 重写为函数。

而不是重新发明轮子（包）。我正在考虑创建一个新的 Oracle 函数来调用存储过程并在 BI 管理工具中访问该函数。我的问题是？

**“你能从一个 Oracle 函数中调用一个 Oracle 包吗？ - 如果是的话，例子？？”**

不要让不知道的 BI 阻止您回答这个问题 - 它并没有阻止我提出这个问题 ;-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:22:28.503

您的程序是否返回 REF_CURSOR 或类似的东西？如果是这样，那么是的，您可以轻松编写一个流水线表函数，该函数获取该游标并将结果通过管道输出。请参阅：[http ://docs.oracle.com/cd/B28359_01/appdev.111/b28370/tuning.htm#i52954](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/tuning.htm#i52954)

如果没有，请更具体地说明您要做什么。

# scala - 通过套接字循环的Scala方法性能（收集或foreach或其他）？

> ID：12394486
> 
> 赞同：1
> 
> 时间：2012-09-12T18:50:25.390
> 
> 标签：scala

这里有两个定义都达到了相同的结果：

```
 def sendTrigger(teamId:Long, data:String) {
    EngineSync.browserSockets.collect{ case ((i,(u,t)),s) => if(t==teamId) { s.send(data) } }
  }

  def sendTrigger(teamId:Long, data:String) {
    EngineSync.browserSockets.foreach{ case ((i,(u,t)),s) => if(t==teamId) { s.send(data) } }
  } 
```

发生的事情是我正在遍历套接字列表并过滤它们以发送数据。作为 Scala 的新手，我担心它开始扩展时的性能。据我了解`foreach`，与其他方法相比性能很差，有谁知道是否`collect`会更好，或者这是否完全是错误的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T07:18:23.953

循环通过一个公平大小的集合与执行网络 IO（至少在阻塞时）是[完全不同的规模操作](http://architects.dzone.com/articles/every-programmer-should-know)，因此我不会担心这个阶段的性能问题。

如果您真的关心大规模扩展时的性能：

*   使用[NIO 进行异步套接字 IO](https://stackoverflow.com/questions/592303/asynchronous-io-in-java)
*   将套接字访问逻辑封装在一个内部`Actor`（并且可能`Future`在客户端中使用 s 来隐藏 Actor）
*   甚至可以腾出时间使用[Akka 的 IO](http://doc.akka.io/docs/akka/2.0/scala/io.html)模块

# c# - 在回发之间存储 GridViewRow 对象

> ID：12394488
> 
> 赞同：3
> 
> 时间：2012-09-12T18:50:34.957
> 
> 标签：c#, asp.net

我正在使用以下代码突出显示用户在 gridview 中单击的行（并取消突出显示先前选择的行）：

```
 protected void PartListRowClicked(object sender, GridViewRowClickedEventArgs e)
    {
        pnewrow = (GridViewRow)PartList.Rows[e.Row.RowIndex];
        pnewrow.BackColor = Color.Blue;
        pnewrow.ForeColor = Color.White;
        if (poldrow != null)
        {
            poldrow.BackColor = Color.Empty;
            poldrow.ForeColor = Color.Black;
        }
        poldrow = pnewrow;
    } 
```

但是，poldrow 对象在回发后总是重置为空（单击会导致回发）。有没有办法在回发之间保存行索引？或者，是否有更好的方法来实现此功能？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:36:58.883

当然可以*将 oldRow(index) 存储在服务器上。*例如，您可以使用**ViewState**或**Session var**。但是imo**到服务器还有很长的路要走，** *只是为了改变一行的颜色/样式*。所以我建议**使用 JQuery 来改变 row 的样式**，除非你必须注意服务器上的 rowClicked 事件？！

```
<script type="text/javascript" src="js/jquery-1.7.1.js"></script>
<script type="text/javascript">
    var oldRow = null;
    var newRow = null;
    $(document).ready(function () {
        // gvProducts is my gridView
        $("#gvProducts tr:gt(0)").click(function () {
            oldRow = newRow;
            newRow = $(this);

            newRow.css("background-color", "blue");
            newRow.css("color", "white");

            if (oldRow != null) {
                oldRow.css("background-color", "transparent");
                oldRow.css("color", "black");
            }
        });
    });
</script> 
```

使用此脚本，您将**留在客户端上，**并且您的客户端不必为了设置样式而回发到服务器！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T18:57:19.747

您可以将值存储在`ViewState`or中`Session`：

```
public int CurrentRowIndex
{
    get
    {
        return ViewState["rowindex"] != null ?
               int.Parse(ViewState["rowindex"]) :
               0;
    }

    set
    {
        ViewState["rowindex"] = value;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:59:29.707

您可以简单地将索引保存到会话或视图状态或 cookie 中！并在回发后使用该值来检索您想要的内容！

放 ：

```
Session["rowindex"]="the index"; 
```

得到 ：

```
string index=Session["rowindex"].ToString(); 
```

# java - Java 小程序适用于 Oracle JRE 7u5，不适用于 7u6

> ID：12394490
> 
> 赞同：1
> 
> 时间：2012-09-12T18:50:44.757
> 
> 标签：java, applet, classloader, java-7

我们的团队有一个在 Oracle JRE 7u5 中运行良好的小程序。将 JRE 更新到 7u6 或 7u7 后，小程序无法初始化。类加载器在加载 log4j 类期间抛出异常：

```
Caused by: java.lang.IllegalStateException: zip file closed
at java.util.zip.ZipFile.ensureOpen(Unknown Source)
at java.util.zip.ZipFile.getEntry(Unknown Source)
at java.util.jar.JarFile.getEntry(Unknown Source)
at java.util.jar.JarFile.getJarEntry(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath$JarLoader.getResource(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader$2.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at sun.plugin2.applet.Plugin2ClassLoader.findClassHelper(Unknown Source)
at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at org.apache.log4j.PropertyConfigurator.class$(PropertyConfigurator.java:572)
at org.apache.log4j.PropertyConfigurator.parseAppender(PropertyConfigurator.java:752)
at org.apache.log4j.PropertyConfigurator.parseCategory(PropertyConfigurator.java:735)
at org.apache.log4j.PropertyConfigurator.configureRootCategory(PropertyConfigurator.java:615)
at org.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:502)
at org.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:547)
at org.apache.log4j.helpers.OptionConverter.selectAndConfigure(OptionConverter.java:483)
at org.apache.log4j.LogManager.<clinit>(LogManager.java:127) 
```

有没有其他人观察到这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:42:37.233

这个特定的错误已被其他人观察到，并已归档在 Oracle 的[错误数据库](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7194301 "甲骨文错误报告")中。

# excel - 将日期变量从 TCL 传递到 excel

> ID：12394491
> 
> 赞同：1
> 
> 时间：2012-09-12T18:50:52.930
> 
> 标签：excel, csv, tcl

我正在尝试以这种格式 YYYY-MM-DD hh:mm:ss 在 excel 的特定单元格中分配日期值，我使用 TCL 打开 excel 并解析值，最后将值推送到 excel 中的单元格，最后将其保存为**CSV**格式，

例如，当我尝试将 2012-09-10 00:00:00 分配给 excel 中的特定单元格时，我看到 excel 将其转换为 9/10/2012 0:00。有没有办法从 TCL 关闭 excel 中的自动格式化选项？

这是我的示例代码：

```
proc get_date  { }  {
    set date "2012-09-10 00:00:00" 
    return $date
}

set application [::tcom::ref createobject "Excel.Application"]
set workbooks [$application Workbooks]
$application DisplayAlerts False
set workbook [$workbooks Open "c:\\test\\dir\\filename.csv"]                
set worksheets [$workbook Worksheets]
set worksheet [$worksheets Item [expr 1]]
set cells_worksheet1 [$worksheet Cells] 
$cells_worksheet1 Item 5 B [get_date]

$workbook Save
$application Quit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:46:07.070

我可以通过在字符串的开头添加一个撇号 (') 来绕过格式，这只是日期，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:22:42.647

我不认为有办法做到这一点。以下是类似的讨论：

*   [Excel 更改日期格式](https://stackoverflow.com/questions/1906626/excel-changes-date-formats)
*   [如何禁用 Excel 对数字和文本的自动识别](https://stackoverflow.com/questions/2496990/how-to-disable-excels-auto-recognition-of-numbers-and-text)
*   [在 Excel 中格式化 csv 文件](https://stackoverflow.com/questions/5788465/formatting-csv-files-in-excel)

单引号方法仅在*export期间有效，在**import*期间无效。我正在使用 Excel 2010，keep-first-8-rows-blank 方法对我也不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:23:10.967

您需要设置`NumberFormat`要处理的单元格范围的属性`Text`（而不是默认值，`General`，它会猜测和改变事物）：

```
set cell [$cells_worksheet Item 5 B]
$cell NumberFormat "Text"
$cell Text [get_date] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T09:37:52.890

正如[已经解释过](https://stackoverflow.com/a/11591712/720999)的，CSV 不支持*任何*格式——它是一种纯文本格式。这意味着无论您设法在工作表单元格上为其日期/时间值设置哪种格式，当 Excel 将此工作表保存到 CSV 文件时，格式都会丢失，因为无法将其存储在 CSV 文件中。

简而言之：停止使用 CSV 存储您的数据并使用本机格式 (XLS[X]) 或停止尝试让 CSV 处理它无法处理的问题。

# xml - 非常规格式化/解析 XML

> ID：12394492
> 
> 赞同：2
> 
> 时间：2012-09-12T18:50:54.147
> 
> 标签：xml

我有以下 XML：

```
<XMLResults><ConfMess><RCode>0</RCode><MId>0</MId></ConfMess><COURSE_DATA><THEHEADING>Review Engagements: Inquiry and Analytical Review Procedures and Reporting</THEHEADING><ABSTRACT><!--this file has been generated by v.3.2.1 8/9/2012 8:50:14 AM by JHancock (and called from 'A G&Q Database')--><html><head><title>Course Abstract</title><link rel='stylesheet' href='https://www.thelearningcenter.org/cserver/case1/css/theabstract.css' type='text/css'></head><body><div style='text-align: center;' class=h2banner>Course Abstract</div><div id="tableContainer" class="tableContainer"><table class="abstract"><tbody class="scrollContent"><tr class="abstract"><td class="abstractCaptions">Main Title</td><td class="abstract" id=courseAbstractTitle>Initial Review: Find Out About Additional Reporting Procedures</td></tr><tr class="abstract"><td class="abstractCaptions">Writer(s)</td><td class="abstract" id=authorsAbstract>Karl Booker<br>Harriet Johnson</td></tr><tr class="abstract"><td class="abstractCaptions">Current Field(s) of Study<sup>1</sup></td><td class="abstract" id=fosAbstract>4.0 study hours in 'History'</td></tr><tr class="abstract"><td class="abstractCaptions">Area Of Study</td><td class="abstract" id=courseLevelAbstract>Medium</td></tr><tr class="abstract"><td class="abstractCaptions">Value (30 min.sec.)<sup>1</sup></td><td class="abstract" id=creditHoursAbstract>3.5</td></tr><tr class="abstract"><td class="abstractCaptions">Must Haves</td><td class="abstract" id=prerequisitesAbstract>None</td></tr><tr class="abstract"><td class="abstractCaptions">Description</td><td class="abstract" id=descriptionAbstract>This topic revolves around discussing important topics in the history field and how they relate to our current situation.</td></tr><tr class="abstract"><td class="abstractCaptions">TheObjective</td><td class="abstract" id=objectivesAbstract><ul><li>Learn more about history and how our modern times have been shaped by it.<li>Plan for the future<li>Help mankind to learn from the past<li>Provide valuable input to others<li>Be greatful for what we have<li>Gain credit for all the hard work we put in<li>Pass this course and move on with our lives.<li>Get a good job and raise a family.<li>Get a vacation home and relax on the beach<li>Soak up the sun and get a tan</ul></td></tr><tr class="abstract" id=idExpirationRow><td class="abstractCaptions">Expires</td><td class="abstract" id=expirationAbstract>This topic is reviewed monthly for value and modified where needed.</td></tr><tr class="abstract"><td class="abstractCaptions">Item ID</td><td class="abstract" id=courseIDabstract>odt</td></tr></tbody></table></div><div id=footnote1ID class="sylFNote"><sup>1</sup>Consult your instructor for infornation on this particular topic</div><div id="idCopyright" class="copyright">© 2004 THIS SCHOOL BOARD</div></body></html></ABSTRACT></COURSE_DATA><STUDY_AREA><SUBJECT>AuditField</SUBJECT><NUMBER_HOURS>3.0</NUMBER_HOURS></FIELD_OF_STUDY></XMLResults> 
```

我似乎找不到可以解析`<ABSTRACT>stuff</ABSTRACT>`XML 部分中的“东西”的例程。我认为这可能是由于特殊字符或类似的原因。有人可以帮我制定一个可以解决这个问题并且不会失败的例程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:33:57.030

这不是 XML。这是一堆带尖括号的文本。

您不仅在`<ABSTRACT>`元素内有问题，而且还有`<STUDY_AREA></FIELD_OF_STUDY>`.

你如何解决它？你没有。无论是谁向您发送此垃圾，您都会向您发送有效的 XML。这并不是说那里没有很多 XML 编辑器。他们应该使用这样的工具来创建和/或验证他们的“XML”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:55:24.850

这可能是因为`<!-- -->`是 XML 中的注释。它本身并没有失败。

```
Comments in XML

The syntax for writing comments in XML is similar to that of HTML.

<!-- This is a comment --> 
```

这是一个[参考](http://www.w3schools.com/xml/xml_syntax.asp)链接。

你如何解决这个问题将取决于你使用的库。一些库可能支持获取该元素的原始文本。他们也可能返回一个评论元素。

我可能只是 grep 的纯文本`<ABSTRACT>(.*)</ABSTRACT>`。如果每个文档有多个记录，则可能会出现问题，因此您可能需要先将其隔离到每个文档。

# regex - .htaccess 重定向和防止热链接的正确正则表达式

> ID：12394494
> 
> 赞同：0
> 
> 时间：2012-09-12T18:51:18.870
> 
> 标签：regex, .htaccess, mod-rewrite, apache2

我在 Reddit (r/learnprogramming) 上发布了这篇文章，那里有人私信我并告诉我来这里，所以我来了！

我一直在尝试学习正则表达式，但我仍然很讨厌它们。我很难掌握模式匹配。我精通其他 OOP 语言，所以我想我会学习正则表达式，但它只是逃避了我。

我已经下载了 EditPad Pro，所以我可以按照[http://www.regular-expressions.info/tutorial.html](http://www.regular-expressions.info/tutorial.html)的建议进行练习。我可以获得匹配批量文本的表达式，但我正在尝试解析 URL，但我一直在丢失。

这是我想要做的。我正在编写自己的永久链接 .htaccess 文件作为概念研究证明，因此我希望可以在未来的站点中使用它。

*我需要从 URL 返回以下动态内容：*

**我需要除 http://www.domain.com/ 或 http://domain.com/ 或 domain.com/ 以外的所有内容**
*：（由于新帐户的限制，我在 http:// 之后添加了一个空格）*

http://www.domain.com/asdjh324hj.jpg
http://www.domain.com/asa45s.png
http://www.domain.com/aser24hj.gif/
http://www.domain.com/ wer234dsfa/
http://www.domain.com/k3kjk4
http://www.domain.com/k3kasd4/

**然后将匹配的部分附加到：**

http://www.domain.com/some_dir/som_subdir/some_file.php?querystring=$1

**但是，我不希望结果中有任何这些 url：**

http://www.domain.com/some_dir/some_file.php
http://www.domain.com/some_dir/some_subdir/some_file.html

**我需要防止对 image_dir 中的图像进行热链接：**

http://www.domain.com/image_dir/some_dir/some_subdir/some_image.jpg（或png、gif等）

*热链接图像将被重定向到一个页面，其中传递的图像作为查询字符串。*

那么我将设置什么 RewriteRule 正则表达式来获取它？我了解 RewriteRules 和标志，将匹配的结果放入变量等，我只是不知道我应该写什么正则表达式来获取实际结果。

如果这对于 RewriteRules 来说太复杂了，那么请让我知道，因为我在这里苦苦挣扎。

通常我在 PHP 中执行这些操作，并从以下开始：
.com/[a-zA-Z0-9-_.]+
([^/]+)/?$
然后做好 'ol 子字符串和检查。它把它砍死了，我应该做得更好！

我目前正在阅读regular-expressions.info 教程并且正在取得进展，但我也一直在抓住错误的东西。

感谢您可以发送给我的任何帮助！

更新：我能够通过大量帮助解决所有问题，并在此处进行了更多讨论： [Mod_Rewrite conditions help for hotlinking but allow local requests](https://stackoverflow.com/questions/12451085/mod-rewrite-conditions-help-for-hotlinking-but-allow-local-requests)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:21:37.120

> 我需要 http://www.domain.com/ 或 http://domain.com/ 或 domain.com/ 以外的所有内容：

```
RewriteCond %{REQUEST_URI} !^/$ 
```

> 但是，我不希望结果中有任何这些 url：

```
RewriteCond %{REQUEST_URI} !^/some_dir/ 
```

> 然后将匹配的部分附加到：

```
RewriteRule ^(.*)$ /some_dir/som_subdir/some_file.php?querystring=$1 [L] 
```

所以总的来说它应该是这样的：

```
RewriteCond %{REQUEST_URI} !^/$
RewriteCond %{REQUEST_URI} !^/some_dir/
RewriteRule ^(.*)$ /some_dir/som_subdir/some_file.php?querystring=$1 [L] 
```

这将使当您请求类似的内容时`http://www.domain.com/asa45s.html`，它将在内部重写为`some_dir/som_subdir/some_file.php?querystring=asa45s.html`. 至于盗链位：

```
RewriteCond %{REQUEST_URI} ^/image_dir/
RewriteCond %{REQUEST_URI} \.(png|gif|jpe?g|bmp|ico)$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?domain.com/
RewriteRule ^(.*)$ /some_dir/som_subdir/some_file.php?querystring=$1 [L] 
```

这首先检查请求是针对`/image_dir/`目录中的某些内容，然后检查请求的资源是否以 png/gif/jpeg/bmp/ico 扩展名结尾，然后 HTTP 引用者 [sic] 是否不以 开头`http://www.domain.com/`，`https://domain.com/`或任何组合2\. 如果所有这些都为真，那么它将请求重写为以`/some_dir/som_subdir/some_file.php`原始URI作为`querystring`参数的文件。

# php - 在 PHP 中将纯文本链接转换为超链接

> ID：12394500
> 
> 赞同：-3
> 
> 时间：2012-09-12T18:51:46.240
> 
> 标签：php, regex, hyperlink

> **可能重复：**
> [用 HTML 链接替换文本中的 URL](https://stackoverflow.com/questions/1188129/replace-urls-in-text-with-html-links)

我正在编写一些代码来将纯文本链接转换为 PHP 中的超文本链接。我正在使用正则表达式（我对此几乎一无所知）并且遇到了一些问题：

1.  我不知道如何有条件地在表达式中包含/排除项目
2.  我不知道如何在我的表达式中包含 URL 参数
3.  我对正则表达式了解不多！

这是我写的代码：

```
function text2link($text) 
{
    $text = preg_replace
    (
        "/(ftp\.|www\.|http:\/\/|https:\/\/|)(.*)(\.)(com|net|co\.uk)/i", 
        "<a href='http://$2$3$4' target='_blank'>$1$2$3$4</a>", 
        $text
    );

    return $text;
} 
```

此代码将转换超链接的以下“样式”：

```
http://www.google.com
www.google.com
google.com 
```

等等，但是，链接被强制为 HTTP。无论您输入什么，表达式都会强制使用 HTTP。是否可以有条件地包含必要的协议？例如：

```
"<a href='[SOME IF-CONDITION GOES HERE TO DECIDE WHAT PROTOCOL TO USE]$2$3$4' target='_blank'>$1$2$3$4</a>", 
```

这种情况大致如下：

```
if $1 == "http, else if $1 == "https", else if $1 == "ftp", 
```

等等等等

另外我意识到我没有考虑任何接近足够的扩展，这只是现在的测试代码。

编辑：我应该注意，我不是在寻找需要 200 行的“万无一失”、牢不可破的解决方案。我不介意一些不起眼的域是否不被选中。我只想检测最常见的域和 URL 并将其转换为可点击的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:55:29.643

你不需要调整你的正则表达式：

```
function text2link($text, $protocol="http://") 
{
    $text = preg_replace
    (
        "/(ftp\.|www\.|http:\/\/|https:\/\/|)(.*)(\.)(com|net|co\.uk)/i", 
        "<a href='$protocol$2$3$4' target='_blank'>$1$2$3$4</a>", 
        $text
    );

    return $text;
} 
```

`http://`你可以传入一个可选协议作为第二个参数，如果你不这样做，它将默认为。

# ios - UITableViewCell didTransitionToState 不重绘不可见单元格

> ID：12394504
> 
> 赞同：0
> 
> 时间：2012-09-12T18:52:52.643
> 
> 标签：ios, uitableview

我目前有一个包含可编辑 UITableViewCells 的 UITableView。当单元格进入编辑模式时，我使用 willTransitionToState 和 didTransitionToState 在单元格进入编辑模式时显示/隐藏 UITextField。问题是，如果我有不可见的单元格，willTransitionToState/didTransitionToState 在它们变得可见时不会被调用......所以这些单元格看起来仍然像处于编辑模式。有没有人有解决这个问题的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:55:31.003

隐藏/取消隐藏 UITableViewCell 的子视图不构成状态更改，这就是不调用这些方法的原因。

根据您的实现，您可以在隐藏/取消隐藏时自己调用这些方法。但总的来说，您应该在这些方法中实现隐藏/取消隐藏逻辑，而不是在它们之外，例如状态的变化导致子视图的变化，反之亦然。

要获得更具体的答案，您应该提供代码示例，并更具体地了解您想要实现的目标。

彼得

# mysql - MySQL 根据另一个表值更新表

> ID：12394506
> 
> 赞同：66
> 
> 时间：2012-09-12T18:52:54.667
> 
> 标签：mysql, join, sql-update

我有两张桌子，

这是我的第一张桌子，

```
ID      SUBST_ID        CREATED_ID
1       031938          TEST123
2       930111          COOL123
3       000391          THIS109
4       039301          BRO1011
5       123456          COOL938
...     ...             ... 
```

这是我的第二张桌子，

```
ID      SERIAL_ID       BRANCH_ID
1       039301          NULL
2       000391          NULL
3       123456          NULL
...     ...             ... 
```

我需要一些如何使用我的第一个表中的数据更新我的第二个表中的所有行。

它需要在一个更新查询中完成所有这些操作。

SUBST_ID 和 SERIAL_ID 都匹配，它需要从第一个表中获取 created_id 并将其插入到第二个表中。

所以第二个表将变为以下，

```
ID      SERIAL_ID       BRANCH_ID
1       039301          BRO1011
2       000391          THIS109
3       123456          COOL938
...     ...             ... 
```

感谢您的帮助和指导。

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2012-09-12T18:58:01.757

```
UPDATE TABLE2
       JOIN TABLE1
       ON TABLE2.SERIAL_ID = TABLE1.SUBST_ID
SET    TABLE2.BRANCH_ID = TABLE1.CREATED_ID; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-10-13T16:17:31.260

**如果您需要经常重复操作**并希望**节省时间**，除了汤姆的回答之外，您还可以执行以下操作：

```
UPDATE TABLE1
       JOIN TABLE2
       ON TABLE1.SUBST_ID = TABLE2.SERIAL_ID
SET    TABLE2.BRANCH_ID = TABLE1.CREATED_ID
WHERE TABLE2.BRANCH_ID IS NULL 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-26T06:25:41.220

```
UPDATE TABLE2
       JOIN TABLE1
       ON TABLE1.SUBST_ID = TABLE2.SERIAL_ID
SET    TABLE2.BRANCH_ID = TABLE1.CREATED_ID 
WHERE TABLE2.BRANCH_ID IS NULL or TABLE2.BRANCH_ID=''; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-12T18:57:05.097

我认为这应该有效

```
UPDATE secondTable
JOIN firsTable ON secondTable.SERIAL_ID = firsTable.SUBST_ID
SET BRANCH_ID = CREATED_ID 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-20T13:08:11.323

在 SQL 中使用 Inner join 查询更新非常简单。您可以**不** *使用* `FROM`子句进行更新。这是一个例子：

```
 UPDATE customer_table c 

      INNER JOIN  
          employee_table e
          ON (c.city_id = e.city_id)  

    SET c.active = "Yes"

    WHERE c.city = "New york"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-02T10:59:07.743

使用`INNER JOIN`：

```
UPDATE TABLE1
INNER JOIN TABLE2 ON TABLE1.SUBST_ID = TABLE2.SERIAL_ID
SET TABLE2.BRANCH_ID = TABLE1.CREATED_ID; 
```

另一种替代解决方案，如下所示：这里我使用的是`WHERE`子句而不是`JOIN`

```
UPDATE 
    TABLE1,
    TABLE2
WHERE
    TABLE1.SUBST_ID = TABLE2.SERIAL_ID
SET 
    TABLE2.BRANCH_ID = TABLE1.CREATED_ID; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-11-30T14:49:29.237

你也可以使用这个：

```
update TABLE1 set BRANCH_ID = ( select BRANCH_ID from TABLE2 where TABLE1.SUBST_ID = TABLE2.SERIAL_ID) 
```

但是以我的经验我可以说这种方式太慢了，不推荐！

# wpf - 锚定 WPF 控件以将位置固定在表单调整大小上

> ID：12394508
> 
> 赞同：0
> 
> 时间：2012-09-12T18:52:57.260
> 
> 标签：wpf

所有 Windows 控件都具有称为锚点的属性，通过它我可以强制控件粘在其表面上，如果有人重新调整窗体的大小，控件的高度和宽度也会随着窗体大小增加和减小。

我问了一些人如何在 wpf 中做到这一点，他说 WPF 中的“停靠”可以通过设置子控件的 Horizo​​ntalAllignment 和 VerticalAllignment 属性来完成。

WPF 中的“锚定”可以通过在子节点上设置 Margin 和/或在容器上设置 Padding 来完成。

不幸的是，我无法这样做。所以这是我的示例 xaml。

```
<Window x:Class="WpfApplication1.Window3"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window3" Height="300" Width="515">
<Grid>
    <Label Name="lblName" Content="Enter Name" Height="28" HorizontalAlignment="Left" Margin="-17,5,0,0"  VerticalAlignment="Top" />
    <Label Content="Enter Address" Height="28" HorizontalAlignment="Left" Margin="-17,39,0,0" Name="label2" VerticalAlignment="Top" />
    <Label Content="Enter Company" Height="28" HorizontalAlignment="Left" Margin="-17,68,0,0" Name="label3" VerticalAlignment="Top" />
    <TextBox Height="23" HorizontalAlignment="Left" Margin="83,10,0,0" Name="textBox1" VerticalAlignment="Top" Width="222" />
    <TextBox Height="23" HorizontalAlignment="Left" Margin="83,73,0,0" Name="textBox2" VerticalAlignment="Top" Width="222" />
    <TextBox Height="23" HorizontalAlignment="Left" Margin="83,42,0,0" Name="textBox3" VerticalAlignment="Top" Width="222" />
</Grid>
</Window> 
```

所以请编辑 ny xaml 以实现我正在寻找的东西....谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:21:22.913

我不会为你编写代码，但我会告诉你需要做什么来学习如何正确编码。

首先，您应该了解[WPF 具有哪些布局控件](http://msdn.microsoft.com/en-us/library/ms745058.aspx#LayoutSystem_PanelsCustom)。我实际上建议通读[这篇代码项目文章](http://www.codeproject.com/Articles/30904/WPF-Layouts-A-Visual-Quick-Start)，其中包括每个布局控件及其工作方式的快速可视化表示。

您当前的 XAML 未`Grid`正确使用控件以及当前控件的设置方式，您不妨`Canvas`使用用于静态布局的 .

如果您`Grid`通过定义`RowDefinitions`and来正确使用控件`ColumnDefinitions`，并将您的控件分配给特定的`Grid.Row`and `Grid.Column`，您将得到您想要的。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:24:47.137

这是另一种方法。它会给你静态布局：

```
<Grid>
     <Grid.RowDefinitions>
 <RowDefinition Height="auto"/>
  <RowDefinition Height="auto"/>
  <RowDefinition Height="auto"/>
  </Grid.RowDefinitions>
  <Grid.ColumnDefinitions>
  <ColumnDefinition Width="auto"/>
  <ColumnDefinition Width="auto"/>
  </Grid.ColumnDefinitions>

  <Label Grid.Column="0" Grid.Row="0" Name="lblName" Content="Enter Name"/>     
  <Label Grid.Column="0" Grid.Row="1" Content="Enter Address" />     
  <Label Grid.Column="0" Grid.Row="2" Content="Enter Company" />     
  <TextBox Grid.Column="1" Grid.Row="0" Width="200"/>     
  <TextBox Grid.Column="1" Grid.Row="1" Width="200" />     
  <TextBox Grid.Column="1" Grid.Row="2" Width="200"/> 
</Grid> 
```

# javascript - 使用 JavaScript 在 IE9 中获取数据列表选项

> ID：12394512
> 
> 赞同：9
> 
> 时间：2012-09-12T18:53:08.470
> 
> 标签：javascript, html, cross-browser, internet-explorer-9, html-datalist

此代码适用于除 Internet Explorer 9 之外的所有主要浏览器。我不明白我做错了什么，这可能是我遗漏的一些简单的东西。

复制此代码（或[使用此 jsFiddle](http://jsfiddle.net/Jordan/PU9BF/)）以查看 IE9 中的问题：

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <title>Datalist fetching in IE9</title>
        <script type="text/javascript">
        //document.createElement('datalist');//this seems to fix it for IE6, but not for IE9
        window.onload = function() {
            alert(document.getElementById('languages').getElementsByTagName('option').length);//should alert 42
        };
        </script>
    </head>
    <body>
    <form method="post">
    <input name="language" type="text" value="English" list="languages" />
    <datalist id="languages">
        <option value="Arabic" />
        <option value="Bengali" />
        <option value="Bulgarian" />
        <option value="Catalan" />
        <option value="Chinese" />
        <option value="Croatian" />
        <option value="Czech" />
        <option value="Danish" />
        <option value="Dutch" />
        <option value="English" />
        <option value="Filipino" />
        <option value="Finnish" />
        <option value="French" />
        <option value="German" />
        <option value="Greek" />
        <option value="Gujarati" />
        <option value="Hebrew" />
        <option value="Hindi" />
        <option value="Hungarian" />
        <option value="Indonesian" />
        <option value="Italian" />
        <option value="Japanese" />
        <option value="Kannada" />
        <option value="Korean" />
        <option value="Latvian" />
        <option value="Lithuanian" />
        <option value="Malay" />
        <option value="Malayalam" />
        <option value="Marathi" />
        <option value="Norwegian" />
        <option value="Oriya" />
        <option value="Persian" />
        <option value="Polish" />
        <option value="Portuguese" />
        <option value="Romanian" />
        <option value="Russian" />
        <option value="Serbian" />
        <option value="Slovak" />
        <option value="Slovenian" />
        <option value="Spanish" />
        <option value="Swedish" />
        <option value="Tamil" />
    </datalist>
    </form>
    </body>
</html> 
```

我希望它最终尽可能跨浏览器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T18:03:20.150

IE 9 会忽略`option`不是元素的直接子`select`元素（或一个`optgroup`内元素）的元素。一个简单的解决方法是使用条件注释将元素包装`option`在隐藏元素中：`select`

```
<datalist id="languages">
<!--[if IE 9]><select disabled style="display:none"><![endif]-->
    <option value="Arabic">
    ...
<!--[if IE 9]></select><![endif]-->
</datalist> 
```

这是这种方法的[jsFiddle 演示](http://jsfiddle.net/Jordan/T52jG/)。

**2017 年更新：**值得注意的是，截至 2017 年 7 月，iOS 和 Mac 上的 Safari 仍未添加对`<datalist>`元素的支持。OP 要求提供适用于所有主要浏览器的解决方案，因此这可能不是实现该效果的最佳解决方案。

**更多信息在这里：** [http ://caniuse.com/#search=datalist](http://caniuse.com/#search=datalist)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-12T14:11:54.730

由于某种原因，提供的解决方案对我不起作用。相反，我使用 jQuery UI 的自动完成方法和 Modernizr 来验证浏览器是否支持它。

我最终使用了这个 javascript 代码：

```
 var datalist, listAttribute, options = [];

if(!Modernizr.input.list)
{
    $('input[type="text"][list]').each(function() {
        listAttribute = $(this).attr('list');
        datalist = $('#' + listAttribute);
        if (datalist.length > 0) {
            options = [];
            datalist.find('option').each(function() {
                options.push({ label: this.innerHTML, value: this.value });
            });
            $(this).autocomplete({
                source: options
            });
        }
    });
    $('datalist').remove();
} 
```

对于以下 HTML：

```
<div id="LocationSearch" class="col-xs-4 col-md-3">
    <input type="text" name="locations" list="locations">
    <datalist id="locations">
        <select name="locations">
            <option value="CD455">CD455</option>
            <option value="CD455">CD455</option>
            <option value="CD455">CD455</option>               
        </select>
    </datalist>
</div> 
```

使用以下 Microsoft 帖子作为参考：http: [//msdn.microsoft.com/en-us/magazine/dn133614.aspx](http://msdn.microsoft.com/en-us/magazine/dn133614.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T19:47:16.050

您需要向 IE8 添加一个定义内容兼容性视图的元元素，并且还需要启用 dummy-element 创建行 - 这也是必需的。

所以，你`<head>`现在应该是这样的：

```
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=8"> <!-- IMPORTANT -->
<title>Datalist fetching in IE9</title>
<script type="text/javascript">
    document.createElement('datalist');          // IMPORTANT AS WELL
    window.onload = function() {
        alert(document.getElementById('languages').getElementsByTagName('option').length);//should alert 42
    };
</script> 
```

# dns - 我可以在 OpenShift 中使用自己的域名吗？

> ID：12394513
> 
> 赞同：9
> 
> 时间：2012-09-12T18:53:29.673
> 
> 标签：dns, openshift

我可以在我的 OpenShift 应用程序中使用我自己的自定义域名吗？

默认情况下，Openshift Online 会为我提供一个`*rhcloud.com`域名。例如我的应用程序 url 是`<myappname>-<mynamespace>.rhcloud.com`. 我想知道如何将自定义域名（即 example.com）应用于我的应用程序。

# c# - 如何在随机位置绘制单个精灵 10 次？

> ID：12394520
> 
> 赞同：6
> 
> 时间：2012-09-12T18:54:02.277
> 
> 标签：c#, random, xna, position, sprite

我对此完全陌生，有一个问题。我在学校和家里做了一个练习，但我不知道该怎么做。

问题是我想在屏幕上的 10 个随机位置绘制单个精灵，而不使用特殊的精灵类。我的问题是，它们被绘制后又消失了。

解决了，谢谢大家的帮助！

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;

    Texture2D turtleTexture;
    int counter = 0;
    Random randomera = new Random();
    int x;
    int y;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";        
    }

    protected override void Initialize()
    {
        base.Initialize();
    }

    /// <summary>
    /// </summary>
    protected override void LoadContent()
    {
        spriteBatch = new SpriteBatch(GraphicsDevice);
        turtleTexture = Content.Load<Texture2D>(@"Images/turtle_50x38");
    }

    protected override void UnloadContent()
    {
    }

    protected override void Update(GameTime gameTime)
    {
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            this.Exit();

         /*
         if(counter < 10)
         {
             x = randomera.Next(600);
            y = randomera.Next(400);
            counter++;
         }
         */

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.White);

        spriteBatch.Begin(SpriteSortMode.FrontToBack, BlendState.AlphaBlend);

        if (counter < 10)
        {
            for (int i = 0; i < 10; i++)
            {
                spriteBatch.Draw(turtleTexture, new Vector2(randomera.Next(600), randomera.Next(400)),
                    Color.Black);
                counter++;
            }
        }

        spriteBatch.End();
        base.Draw(gameTime);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T19:11:09.183

如果你想让你的精灵一直处于相同的随机位置并且仍然清除你的视口（例如，你可能想要渲染其他内容），你可以将每帧的随机种子重置为相同的值：

```
protected override void Draw(GameTime gameTime)
{
    randomera = new Random(seed);   
    GraphicsDevice.Clear(Color.White);

    spriteBatch.Begin(SpriteSortMode.FrontToBack, BlendState.AlphaBlend);

    if (counter < 10)
    {
        for (int i = 0; i < 10; i++)
        {
            spriteBatch.Draw(turtleTexture, new Vector2(randomera.Next(600), randomera.Next(400)),
                Color.Black);
            counter++;
        }
    }

    spriteBatch.End();
    base.Draw(gameTime);
} 
```

种子应该在您的`Initialize()`方法中随机生成，之后不要更改。

您也可以使用预定义的坐标初始化列表：

```
List<Vector2> coords = Enumerable.Range(0, 10).Select(i => new Vector2(randomera.Next(600), randomera.Next(400)).ToList(); 
```

并在您的绘图程序中使用此列表：

```
for (int i = 0; i < 10; i++)
{
    spriteBatch.Draw(turtleTexture, coords[i],
        Color.Black);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:09:10.043

```
GraphicsDevice.Clear(Color.White); 
```

这将清除屏幕（意味着之前绘制的任何内容都将被删除）。包含此语句的 Draw 函数每秒大约调用 30 到 60 次，并且您的随机化器将在每次迭代中获取新值。

在每次 Draw 迭代时清除屏幕是正确的，因此不要在每次调用 Draw 时选择随机坐标，而是事先确定坐标。更好的方法可能是在构造函数中初始化一个包含 10 个向量的数组，然后在 Draw 函数中使用该数组（而不是`randomera.Next()`一遍又一遍地调用）。

**编辑：（**请参阅 Bartosz 答案的后半部分以获取示例。我目前无法打开我的 XNA IDE，因此无法为您编写代码示例。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:09:15.970

你正在调用`Clear`你的 draw 方法

```
GraphicsDevice.Clear(Color.White); 
```

这将清除屏幕。

删除这条线，它将保留以前绘制的东西。

# c++ - 使用相对路径 Sublime Text2 构建命令

> ID：12394521
> 
> 赞同：1
> 
> 时间：2012-09-12T18:54:04.940
> 
> 标签：c++, build, mingw, sublimetext2

我已经安装了 Sublime Text2 Portable，并且我已经在我的 pendrive 上安装了 MinGW 便携式。我在 c++.sublime-build 上更改了 cmd 以将定位相对路径放置到 g++.exe，但出现错误：未找到。

如何指示编译命令的相对路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:11:51.377

你可以：

*   指示相对于**包文件夹** *${packages}*的路径；多变的。
*   或者您可以使用“***路径***”选项。

例子：

```
...    
"cmd": ["${packages}/../../../../../usr/bin/g++", "${file}", "-o", "${file_path}/${file_base_name}"],
"path": "~/.:/usr/local/bin",
... 
```

其他变量可以在[这里](http://sublimetext.info/docs/en/reference/build_systems.html "构建系统")找到。

# xpages - 调用方法 NotesView.FTSearchSorted 发生异常

> ID：12394527
> 
> 赞同：1
> 
> 时间：2012-09-12T18:54:34.120
> 
> 标签：xpages, lotus-domino, xpages-ssjs

我正在尝试在 SSJS 中使用视图对象的 FTSearchSorted 方法。我将基础视图的第一列按升序排序。我尝试了所有不同的参数。它总是给出该异常，除非我只将搜索查询作为参数。domino 版本是 8.5.3 FP 2。有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T18:16:41.213

确保视图是用户可排序的

# python - 哪一种数据加载方法最适合性能？

> ID：12394528
> 
> 赞同：0
> 
> 时间：2012-09-12T18:54:39.747
> 
> 标签：python, database, python-3.x, redis

例如，我将对象*用户*存储在数据库（Redis）中，它有几个字段：

*   **字符串** *缺口*
*   **字符串** *密码*
*   **字符串** *电子邮件*
*   **列出** *帖子*
*   **列出** *评论*
*   **设置** *关注者*
*   等等...

在 Python 程序中，我有类（*User*），该对象具有相同的字段。此类的实例映射到数据库中的对象。问题是如何从数据库中获取数据以获得最佳性能：

1.  在实例创建和初始化字段时为每个字段加载值。
2.  每次请求字段值时加载字段值。
3.  作为第二个，但在加载值之后，用加载的值替换字段属性。

ps redis 在 localhost 中运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:09:00.500

该方法完全取决于要求。

如果只有一个客户端读取和修改属性，这是一个相当简单的问题。修改数据时，只需更改当前 Python 程序中的实例属性，同时保持数据库同步，同时保持程序响应。为此，您应该将阻塞调用外包给另一个线程或使用greenlets。如果只有一个客户端，则绝对不需要在每次查找值时从数据库中获取属性。

如果有多个客户端读取数据而只有一个客户端修改数据，则必须考虑需要哪种级别的同步。如果您需要 100 % 同步，则必须在每次查找值时从数据库中获取数据。

如果有多个客户端更改数据库中的数据，您最好寻找一个坚如磐石的行业标准解决方案，而不是编写自己的数据库缓存/映射器。

您在（2）和（3）之间的区别并没有真正的意义。如果您在每次查找时都获取数据，则无需“存储”数据。你看，如果可能涉及多个客户，这些事情很快就会变得相当复杂，而且很难做到正确。

# character-encoding - 在哪里可以获得所有字符集的列表（Content-Type HTTP 响应标头）

> ID：12394533
> 
> 赞同：3
> 
> 时间：2012-09-12T18:54:55.220
> 
> 标签：character-encoding

[W3C 说](http://www.w3.org/TR/html4/references.html#ref-CHARSETS)[这里](ftp://ftp.isi.edu/in-notes/iana/assignments/character-sets)有一个完整的列表，但是它似乎已经被关闭了。

我在哪里可以得到他们的清单？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T18:59:54.797

我在 iana 找到了一份清单：

[http://www.iana.org/assignments/character-sets](http://www.iana.org/assignments/character-sets)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-12T18:57:36.397

我使用以下列表

[http://webdesign.about.com/od/multimedia/a/mime-types-by-content-type.htm](http://webdesign.about.com/od/multimedia/a/mime-types-by-content-type.htm)

# sql - 在 Postgresql 中计算列类型的大小

> ID：12394538
> 
> 赞同：7
> 
> 时间：2012-09-12T18:55:14.683
> 
> 标签：sql, postgresql

我试图弄清楚如何确定数据库中特定列的大小，例如我有两列称为 sourceip，destinationip 都是 16 字节字段。

我认为这将在 information_schema 或 \d+ 中的某个位置，但我找不到特定命令来隔离每种列类型的大小。

> 您可以计算数据库中的列类型大小，还是只需要参考 Postgresql 文档中每种类型的字节大小？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-12T20:26:37.747

pg 中只有少数类型具有固定长度 - 几乎所有类型都是 varlena 类型 - 它具有动态长度。您可以检查查询，例如

```
 postgres=# select typlen from pg_type where oid = 'int'::regtype::oid;
  typlen 
 --------
       4
 (1 row)

 postgres=# select attlen from pg_attribute where attrelid = 'x'::regclass and attname = 'a';
  attlen 
 --------
       4
 (1 row) 
```

当结果不是 -1 时，类型没有固定长度

对于 varlena 类型，使用 pg_column_size 函数：

```
postgres=# \df *size*
                                   List of functions
   Schema   |          Name          | Result data type | Argument data types |  Type  
------------+------------------------+------------------+---------------------+--------
 pg_catalog | pg_column_size         | integer          | "any"               | normal
 pg_catalog | pg_database_size       | bigint           | name                | normal
 pg_catalog | pg_database_size       | bigint           | oid                 | normal
 pg_catalog | pg_indexes_size        | bigint           | regclass            | normal
 pg_catalog | pg_relation_size       | bigint           | regclass            | normal
 pg_catalog | pg_relation_size       | bigint           | regclass, text      | normal
 pg_catalog | pg_size_pretty         | text             | bigint              | normal
 pg_catalog | pg_size_pretty         | text             | numeric             | normal
 pg_catalog | pg_table_size          | bigint           | regclass            | normal
 pg_catalog | pg_tablespace_size     | bigint           | name                | normal
 pg_catalog | pg_tablespace_size     | bigint           | oid                 | normal
 pg_catalog | pg_total_relation_size | bigint           | regclass            | normal
(12 rows)

 postgres=# select pg_column_size('Hello');
  pg_column_size 
 ----------------
          6
 (1 row)

 postgres=# select pg_column_size(10);
  pg_column_size 
 ----------------
               4
 (1 row)

 postgres=# select pg_column_size(now());
  pg_column_size 
 ----------------
               8 
```

# magento - 创建新产品时无法选择分类中添加的术语

> ID：12394541
> 
> 赞同：2
> 
> 时间：2012-09-12T18:55:28.333
> 
> 标签：magento, drupal, taxonomy

我在分类列表中添加了一个术语。分类列表的标题是“库存颜色”，我在该列表中添加了“灰色”。

当我创建新产品时，我需要该选项可用，这样当我将产品添加到 Magento 目录时，我可以选择“灰色”作为可用的库存颜色。

但是，尽管该术语显示在分类列表中，但在尝试创建新产品时不会显示。

添加新产品时，如何确保灰色显示为可用的库存颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T23:16:42.107

它不会出现在该产品中的原因可能有很多。要查看的主要内容是：

*   确保给定类别是该特定商店根类别下的子类别
*   确保该类别的“Is Active”标志设置为“Yes”
*   刷新缓存，新的分类可能还没有被缓存
*   如果这不起作用，请重新索引类别

# javascript - 是否可以将函数输入连接到另一个函数调用的文本？

> ID：12394544
> 
> 赞同：0
> 
> 时间：2012-09-12T18:55:32.740
> 
> 标签：javascript

首先为糟糕的标题道歉，不知道如何用一行来解释这一点。

我有这个 Javascript 函数（为了问题的目的而被删除）......

```
function change_col(zone){

    var objects= zone1227.getObjects();

} 
```

我将一个整数传递给函数。在我有“zone1227”的地方，我希望 1227 是我传入的整数。

我试过这个；

`var zonename = "zone" + zone;`

`var objects= zonename.getObjects();`

但这不起作用。

这可能吗？对于传入的每个可能的整数，函数确实存在，但我希望保持代码紧凑，而不是一长串带有硬编码函数名称的 if 语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:03:44.323

由于`zone1227`显然是一个全局变量，它也可以写成`window.zone1227`或`window['zone1227']`。这意味着您*可以*通过编写以下代码来实现您所描述的：

```
function change_col(zone){

    var objects= window['zone' + zone].getObjects();

} 
```

尽管如此，我同意 Interrobang 的上述评论。这不是完成您*真正*想要完成的任何事情的好方法。您不应该通过包含其名称的字符串来引用全局变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:02:39.440

~~不，您不能使用字符串的值来引用变量，也不能将任何内容连接到变量名上。~~编辑：事实证明你可以。你还是不应该。

是的，您可以避免使用长硬编码的 if/elseif 序列：使用数组。

然后你可以这样说：

```
function change_col(arr, i)
{
    var objects= arr[i].getObjects();
} 
```

电话将类似于：

```
change_col(zone, 1227); 
```

# sql - 仅用空格替换空值

> ID：12394545
> 
> 赞同：22
> 
> 时间：2012-09-12T18:55:40.043
> 
> 标签：sql

我目前有一个将数据输出到 excel 文档中的 sql 语句。但是，每次有一个单元格没有数据时，它都会输出`NULL`到单元格中。我想知道是否有一种方法可以`NULL`只用空格替换？有人建议使用 coalesce 来做到这一点，但是我从来没有机会使用它，所以我必须对它做一些阅读。有人有其他建议吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-12T19:00:39.290

在您的选择中，您可以在列周围放置一个 IsNull/IfNull。效率不是特别高，但可以满足您的需求。

微软 SQL

```
Select IsNull(ColName, '') As ColName From TableName 
```

MySQL

```
Select IfNull(ColName, '') As ColName From TableName 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-12T19:12:57.990

IFNULL 是 Oracle 扩展（被许多其他平台采用）。“标准” SQL 函数是 coalesce()：

```
SELECT COALESCE(columnName, ' ') AS ColumnName
FROM tableName; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-08T11:18:05.777

微软 SQL

```
UPDATE TABLE_NAME
SET COLUMN_NAME = ''
WHERE COLUMN_NAME IS NULL 
```

**注意：**这将**SET**，而不是在您的 TABLE 中选择结果

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:02:37.830

MySQL

```
select IFNULL(columnName, '') from tableName 
```

IFNULL(expr1,expr2)

如果 expr1 不为 NULL，则 IFNULL() 返回 expr1；否则返回 expr2。IFNULL() 返回一个数字或字符串值，具体取决于使用它的上下文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-10T12:03:01.333

```
SELECT teacher.name, IfNull(dept.name, '') as Dept
 FROM teacher left outer JOIN dept
           ON teacher.dept=dept.id 
```

# android - Android sql事务性能

> ID：12394546
> 
> 赞同：1
> 
> 时间：2012-09-12T18:55:42.553
> 
> 标签：android, sql, performance

我想知道是否有人可以解释为什么在事务内部的android平台上运行sql要快得多。例如一些代码，例如：

```
SQLiteDatabase db = dbHelperExt.getWritableDatabase();
db.beginTransaction();
try {
    ... // some sql inserting/updating/deleting
    db.setTransactionSuccessful();
} finally {
    db.endTransaction();
} 
```

在处理数百个插入时，我的速度提高了数倍，我主要是好奇为什么会这样。另外，我在处理 php/myqsl 时没有注意到同样的增加，这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:10:17.497

每当您对 SQLiteDatabase 执行操作时，默认情况下会打开一个事务，该事务负责打开文件、获取 db 对象、执行请求并释放对文件的访问权限。此外，您可能会注意到，第一个操作对系统来说更重。如果您不合并在一个唯一事务中同时执行的不同操作，则将为每个操作创建一个（即：10 个操作 = 10 个事务以及每个操作的所有工作）。

当您使用 1 个事务处理所有事务时，您只需执行一次 95% 的较重操作。唯一的缺点可能是，如果您的一个请求失败，其余请求将被取消。但对我来说，这实际上是一个优势。

**编辑：** [这里](http://www.sqlite.org/lang_transaction.html)有更多详细信息。

# c# - 语法高亮库

> ID：12394548
> 
> 赞同：1
> 
> 时间：2012-09-12T17:11:19.850
> 
> 标签：c#, .net, vb.net

有谁知道我可以在我正在处理的项目中包含一个好的库，以突出显示 TextBox/RTB 控件中的 HTML、CSS、JS 等代码？

我看到很多“如何实现”，但没有人创建我可以在应用程序中使用的库。

我非常乐意制作一个 DLL，但需要一些好的“可靠”信息来了解如何实现源代码突出显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:37:42.247

这可能是一个很好的起点。这不是最好的实现，但会让你继续前进。 [http://syntaxhighlighter.codeplex.com](http://syntaxhighlighter.codeplex.com)

# python - Python合并2字典而不覆盖

> ID：12394550
> 
> 赞同：1
> 
> 时间：2012-09-12T18:56:12.453
> 
> 标签：python, dictionary

如果 a 和 b 是 2 个字典：

```
a = {'UK':'http://www.uk.com', 'COM':['http://www.uk.com','http://www.michaeljackson.com']}

bb = {'Australia': 'http://www.australia.com', 'COM':['http://www.Australia.com', 'http://www.rafaelnadal.com','http://www.rogerfederer.com']} 
```

我想合并它们以获得

```
{'Australia': ['http://www.australia.com'], 'COM': ['http://www.uk.com', 'http://www.michaeljackson.com', 'http://www.Australia.com', 'http://www.rafaelnadal.com', 'http://www.rogerfederer.com'], 'UK': ['http://www.uk.com']} 
```

我想联合他们，即

**如何在 Python 中做到这一点而不覆盖和替换任何值？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:57:36.867

使用默认字典：

```
from collections import defaultdict
d  = defaultdict(list)

for dd in (a,bb):
    for k,v in dd.items():
        #Added this check to make extending work for cases where 
        #the value is a string.
        v = (v,) if isinstance(v,basestring) else v  #basestring is just str in py3k.
        d[k].extend(v) 
```

（但这几乎是我在[之前的回答](https://stackoverflow.com/a/12389519/748858)中告诉你的）

如果您的输入字典看起来像，这现在可以工作

```
{'Australia':['http://www.australia.com']} 
```

或喜欢：

```
{'Australia':'http://www.australia.com'} 
```

但是，我建议不要使用后一种形式。一般来说，我认为保持字典的所有键/值看起来相同是一个好主意（至少如果你想将所有项目与这个问题中的所有项目相同）。这意味着，如果一个值是一个列表，那么*将它们全部*作为一个列表是一个好主意。

如果你真的坚持这样保持：

```
d = {}
for dd in (a,b):
   for k,v in dd.items():
       if(not isinstance(v,list)):
          v = [v]
       try:
          d[k].extend(v)
       except KeyError: #no key, no problem, just add it to the dict.
          d[k] = v 
```

# image - jsp 从 servlet 请求图像仅适用于 localhost

> ID：12394551
> 
> 赞同：0
> 
> 时间：2012-09-12T18:56:16.300
> 
> 标签：image, jsp, servlets

我有一个名为 LineImage 的 servlet，它根据提供给它的参数创建一个 jpeg。我使用 servlet，因为每个用户的参数都不同。参数是从另一个带有字符串的 servlet 传递的。我将图像嵌入到一个jsp中（例如）

```
<img src=LineImage?param1=0&param2=6&param3=3&param4=-6&param5=0&param6=0&param7=6 /> 
```

Servlet 映射为

```
<servlet>
    <servlet-name>LineImage</servlet-name>
    <servlet-class>Lines.LineImage</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>LineImage</servlet-name>
    <url-pattern>/LineImage</url-pattern>
</servlet-mapping> 
```

当我在本地主机上运行我的代码时，一切都很完美。当我将 .war 上传到 aws 并使用该网站时，图像无法正确加载。从 localhost 到会破坏这种情况的网站会发生什么变化？

# powershell - 从 PowerShell 执行 nslookup

> ID：12394552
> 
> 赞同：1
> 
> 时间：2012-09-12T18:56:22.083
> 
> 标签：powershell, nslookup

我正在编写一个 powershell 来从服务器名称中获取 ip，这需要我将 nslookup 代码嵌入到我的 powershell 中

我该如何做整合工作？

有谁能够帮我？

```
Add-PSSnapin Microsoft.SharePoint.PowerShell
$web = Get-SPWeb -Identity “http://nycs00058260/sites/usitp“
$server_status = "PROD"
$list=$web.Lists[”DNS_Status”]
$items = $list.items 
Foreach($item in $items){
    $item_name = $item["Server_name"]  #need to get the ip by this name

    /*nslook up*/
     $item_name.update()

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T19:19:28.893

如果您安装[PSCX](http://pscx.codeplex.com/)模块，它会附带一个`Resolve-Host`用于处理名称查找的 cmdlet。

没有这一点，这个单线将完成这项工作

```
[System.Net.Dns]::GetHostAddresses("www.msn.com") 
```

您也可以传入 IP 地址 - 但结果会有所不同。

另请参阅[http://blogs.msdn.com/b/powershell/archive/2006/06/26/647318.aspx](http://blogs.msdn.com/b/powershell/archive/2006/06/26/647318.aspx)和[http://powershell.com/cs/media/p/210.aspx](http://powershell.com/cs/media/p/210.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-12T19:36:32.190

Windows 8 和更高版本上的 PowerShell 3.0 附带一个`Resolve-DnsName`cmdlet，可以获取以下信息：

```
(Resolve-DnsName $server_name)[0].IpAddress 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-27T09:47:49.950

只需使用：

```
Resolve-DnsName monServer | ? { # make selection here } | % { $_.IPAdress }  | select-object -first 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-20T18:30:30.853

```
#Here is a far better method for nslookup

# HOWTO ensure an nslookup results no errors but still gives the original names and column separations
$day = Get-Date -Format yyyyMMdd #<-- HOWTO set the day variable for today
$ErrorActionPreference = ‘SilentlyContinue’ #<-- HOWTO turn off error messages
$WarningActionPreference = 'SilentlyContinue' #<-- HOWTO turn off warning messages
$servers = Get-Content .\input\servers.txt
Foreach ($server in $servers){
$result = Resolve-DnsName $server -Server $env:LOGONSERVER.Remove(0,2) -Type ALL #<-- NSLOOKUP using your logon server
write-host ($server+","+$result.Name+","+$result.IPAddress) #<-- HOWTO Write two variables separated by a comma
}
$ErrorActionPreference = ‘SilentlyContinue’ #HOWTO turn on error messages
$WarningActionPreference = 'SilentlyContinue' #HOWTO turn on warning messages 
```

# jquery - 将事件附加到数组中的对象

> ID：12394553
> 
> 赞同：2
> 
> 时间：2012-09-12T18:56:25.900
> 
> 标签：jquery

我正在创建一个包含色板的侧边栏，单击该色板时，会用这些颜色填充表单。它适用于 Wordpress 主题。

每个色样都是一个包含在数组中的对象。我在数组上使用 .each() 函数为每个样本创建 HTML，但我还需要创建一种方法，以便在单击样本时，颜色字段会填充该样本的颜色。

这是小提琴： http: [//jsfiddle.net/ccnokes/6emfD/](http://jsfiddle.net/ccnokes/6emfD/) *代码中有更多注释可以阐明我在说什么。

从小提琴中可以看出，每个样本只用最后一个样本的颜色填充字段。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:01:15.720

稍微重新组织一下，以便在创建而不是之后将点击事件附加到每个锚标记。

[http://jsfiddle.net/6emfD/2/](http://jsfiddle.net/6emfD/2/)

```
//Color Swatches JS
//color swatch array containing objects that contain the target fields and colors
var swatches = [
    $fuego = {
    name: 'fuego',
    primary_color: '#c0342a',
    primary_hover_color: '#a0140a',
    primary_hover_color_2: '#800000',
    secondary_color: '#ff7600',
    secondary_hover_color: '#df5600',
    secondary_hover_color_2: '#bf3600',
    tertiary_color: '#ffd005',
    tertiary_color2: '#ffd409',
    h1_color: '#c0342a',
    h2_color: '#a0140a',
    background_color: '#ffd005'},
    $veggies = {
    name: 'veggies',
    primary_color: '#5f8a42',
    primary_hover_color: '#86ad59',
    primary_hover_color_2: '#f6faa1',
    secondary_color: '#f28410',
    secondary_hover_color: '#d66011',
    secondary_hover_color_2: '#b24400',
    tertiary_color: '#a44a0e',
    tertiary_color2: '#a84e0f',
    background_color: '#a44a0e'},
    $jazz = {
    name: 'jazz',
    primary_color: '#3b2e8c',
    primary_hover_color: '#022859',
    primary_hover_color_2: '#023059',
    secondary_color: '#6cafd9',
    secondary_hover_color: '#4c8fb9',
    secondary_hover_color_2: '#2c6f99',
    tertiary_color: '#ffffff',
    tertiary_color2: '#fcfcfc',
    background_color: '#ffffff'}
];

//Create color swatches HTML
$(swatches).each(function() {
    var $swatch = this;
    $('<a id="' + this.name + '"><ul class="swatch"><li class="main" style="background-color:' + this.primary_color + '"></li><li style="background-color:' + this.primary_hover_color + '"></li><li style="background-color:' + this.primary_hover_color_2 + '"></li><li class="main" style="background-color:' + this.secondary_color + '"></li><li style="background-color:' + this.secondary_hover_color + '"></li><li style="background-color:' + this.secondary_hover_color_2 + '"></li></ul></a>').on('click', function() {
        fillSwatches($swatch);
        console.log($swatch);
    }).appendTo('.swatch-wrap');

});

//on swatch click, fill fields with corresponding colors    

function fillSwatches($swatch) {
    $.each($swatch, function($key, $value) {
        fillColor($key, $value);
    });
}

//fill color scheme

function fillColor($field, $color) {
    $('#' + $field).val($color).css("background-color", $color).change();
}

/*the following function works but can't it be abstracted so that every swatch doesn't have to be written out in this format? */

/*
$('#fuego').on( 'click', function(){
   fillSwatches($fuego);
});
*/​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:02:07.617

为每个添加一个样本数据属性`<a>`，然后执行以下操作：

```
$('a').on('click', function(){
    var swatch = swatches[$(this).data('swatch')];  
    fillSwatches(swatch);
}); 
```

# java - 移动数组元素一定量？

> ID：12394558
> 
> 赞同：2
> 
> 时间：2012-09-12T18:56:52.060
> 
> 标签：java, arrays, encryption

我有一个问题，其中我有一个包含字母表中字母的数组。我想知道将数组元素移动一定数量的最佳方法是什么。例如，如果键是 2，

和

```
array = "A,B,C,D,E.." 
```

我怎样才能使改造后，

```
array = "C,D,E,F,G..." 
```

最简单的解决方案是`if`声明吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:19:45.850

你必须使用一个数组，一个集合怎么样，比如List...

```
List<?> list = Arrays.asList('A', 'B', 'C', 'D', 'E');
Collections.rotate(list, -2);
System.out.println(list); 
```

输出

```
[C, D, E, A, B] 
```

或者，使用原始类包装器数组...例如字符、整数等。这仍然允许通过直写 Arrays.asList() 方法使用集合...。

```
 final Character[] array = { 'A', 'B', 'C', 'D', 'E' };
    Collections.rotate(Arrays.asList(array), -2);
    System.out.println(Arrays.toString(array)); 
```

输出

```
[C, D, E, A, B] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:00:14.963

```
char[] newArray = Arrays.copyRange(oldArray, shiftValue, oldArray.length); 
```

[http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange(char[], int, int)](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange%28char%5B%5D,%20int,%20int%29)

编辑：如果您需要旋转数组，请查看以下方法：

[http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#rotate(java.util.List, int)](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#rotate%28java.util.List,%20int%29)

或者：

```
Character[] arr = {'a', 'b', 'c', 'd'};
List<Character> chars = Arrays.asList(arr);
Collections.rotate(chars, -2);
arr = chars.toArray(new Character[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:58:33.993

这应该这样做：

```
char[] input = ...
char[] result = new char[input.length];
int shift = 2;

for(int i = 0; i < input.length; i++)
{
    result[i] = input[(i + shift) % input.length];
} 
```

如您所见，您需要一个`for`循环。安`if`不会这样做。它会将所有`char`的 s 两个向左移动。

结果将是：`['C', 'D', ..., 'Z', 'A', 'B']`

这种方法称为[循环移位](http://en.wikipedia.org/wiki/Circular_shift)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:46:23.190

你试过[`Collections.rotate`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#rotate%28java.util.List,%20int%29)吗？

```
final Character[] vals = { 'A', 'B', 'C', 'D', 'E' };
final List<Character> list = Arrays.asList(vals);
Collections.rotate(list, -2);
/* vals will be rotated */
System.out.println(Arrays.toString(vals)); 
```

...产生（见[ideone paste](http://ideone.com/tBN00)）：

> [C、D、E、A、B]

# jquery - 动态间隔 divs base don 父级的大小

> ID：12394561
> 
> 赞同：0
> 
> 时间：2012-09-12T18:57:16.167
> 
> 标签：jquery, html, spacing

我有一个容器 div。在该容器 div 内部是一些较小的 div，我想在父 div 的宽度之间留出间隔，同时在每个 div 之间添加一个间隙。内部 div 的数量会发生变化。

我正在使用这个公式**(containerWidth-(numberOfBars*gap))/numberOfBars**来计算每个条的空间，然后尝试 jquery 动态修改 css。

我无法改变宽度或让它们间隔开。

附上小提琴。

[http://jsfiddle.net/MjrMq/](http://jsfiddle.net/MjrMq/)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:41:17.317

您应该熟悉[`outerWidth()`](http://api.jquery.com/outerWidth/); 我认为它非常适合这种情况。当`true`被传递时，它将占用容器的外部宽度，包括边距。因此，当您有一个宽度的项目`0`并采用外部宽度时，它将只是您不希望包含在宽度中的填充/边距/边框。

接下来，我玩了一下你的逻辑。我取了每个条的总宽度而不是内部宽度，然后使用外部宽度从中获取内部宽度。（即，`Container width / n -> Outer Width; Subtract padding -> Inner Width`。）

在分享更新的小提琴之前，我要注意的最后一件事是：请，请，**请**，在未来，请先测试你的小提琴。您创建了`bar`和`container`变量，但都没有定义。你也没有使用过`$(document).ready(...)`或类似的东西。

首先，我将您设置`width`为`0`（以获得适当的外部宽度）。然后我计算了宽度，如下所示：

```
var barOuterWidth = Math.floor(containerWidth / n);
var barInnerWidth = barOuterWidth - $(".bar").outerWidth(true); 
```

最后，我用来`'width': barInnerWidth,`设置宽度。

结果[在这个 jsFiddle 中](http://jsfiddle.net/DLEpU/)。注意右边有一个边距；我相信你可以找到缓解这种情况的方法。（`i == n - 1`或诸如此类的东西。）

# php - （可能很简单）条件 PHP 循环

> ID：12394563
> 
> 赞同：0
> 
> 时间：2012-09-12T18:57:31.477
> 
> 标签：php

我已经像这样设置了一个数据库表：

```
table: group
id     name          subGroupOf
1      grandparent   NULL
2      parent           1
3      child            2 
```

这是我在 php 中尝试做的事情：

当用户访问一个页面时，该页面会告诉 auth() 函数他们需要“子”权限。因为“child”是“parent”的子组，所以两个组的成员都应该获得许可。但是，父母是“祖父母”的子组，因此所有三个组的成员都应该有权访问。

由于可以嵌套多少子组没有限制，我知道我需要一个循环。但我完全是空白。

我知道它需要检查组是否是 subGroupOf，如果是，则验证父组。这是我到目前为止所拥有的：

```
 // Get group of current user
        $group = mysqli_query($cxn,'SELECT group FROM user WHERE id='.$userID);

        // Compare group to permissions
        if($group == $permissions)
            return TRUE;

        // Check if group is a sub group
        $subGroupOf = mysqli_query($cxn,'SELECT subGroupOf FROM group WHERE id="'.$group.'"');
        if($subGroupOf == NULL)
        {
            // Wrong permissions
        }

        // Check if the parent group matches permissions
        if($subGroupOf == $permissions)
            return TRUE; 
```

不知何故，我需要循环最后一部分，并在它到达时停止

```
$subGroupOf == NULL 
```

我对编程很陌生，所以我仍在弄清楚逻辑......有什么想法吗？我不需要为我编写的全部内容（无论如何都总结了代码），我只需要帮助弄清楚结构..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:42:52.563

另一种方法，但您仍然需要一个递归函数：

1.  创建一个将组的层次结构添加到数组的函数
2.  遍历组数组，并检查您的权限。

**功能**

```
function getGroupHierarchy($groupId, $cxn)
{
    $groupArray = array();

    //Push the group to the array..
    $groupArray[] = $groupId;

    //Get the parent id of this group
    $subGroupOf = mysqli_query($cxn,'SELECT subGroupOf FROM group WHERE id="'.$groupId.'"');

    //There is no parent, just return the array.
    if($subGroupOf == NULL)
    {
        return $groupArray;
    }

    //Continue checking the parent group(s).
    getGroupHierarchy($subGroupOf, $cxn);
} 
```

**调用该函数并检查权限：**

```
// Get group of current user
$groupId = mysqli_query($cxn,'SELECT group FROM user WHERE id='.$userID);

$allGroups = getGroupHierarchy($groupId, $cxn);

//Compare each group to permissions.
foreach($groupArray as $group)
{
    if($group == $permissions)
        return TRUE;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:16:57.257

您可以通过检查子组的递归函数来执行此操作，并一直持续到“subGroupOf”id 为 NULL。

例如：

```
function getTopParentGroup($groupId, $cxn) {
    $subGroupOf = mysqli_query($cxn,'SELECT subGroupOf FROM group WHERE id="'.$groupId.'"');

    //There is no parent, just return the group
    if($subGroupOf == NULL)
    {
        return $group;
    }
    //A parent has been found, continue...  
    getTopParentGroup($subGroupOf, $cxn);
} 
```

# c# - 就几何平均而言，Math.Log 与乘法复杂度哪个更好？

> ID：12394570
> 
> 赞同：2
> 
> 时间：2012-09-12T18:58:02.460
> 
> 标签：c#, mathematical-optimization, logarithm

我想找到数据的几何平均值，性能确实很重要。
我应该选择哪一个

1.  保持对单个变量的乘法并在计算结束时取 Nth-root

    ```
    X = MUL(x[i])^(1/N) 
    ```

    因此，`O(N) x Multiplication Complexity + O(1) x Nth-root`

2.  使用对数

    ```
    X = e ^ { 1/N * SUM(log(x[i])) } 
    ```

    因此，`O(N) x Logarithm Complexity + O(1) x Nth-division + O(1) Exponential`

3.  几何平均的专门算法。请告诉我是否有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T23:01:47.010

我想我会尝试对此进行基准测试并进行比较，这是我的尝试。

比较很困难，因为数字列表需要足够大以使时间合理，因此 N 很大。在我的测试中，N = 50,000,000 个元素。

但是，将许多大于 1 的数字相乘会溢出存储乘积的双精度数。但是将小于 1 的数字相乘得到的总乘积非常小，除以元素的数量得到零。

还有几件事：确保所有元素都不为零，并且 Log 方法不适用于负元素。

（如果 C# 有一个带有第 N 个根函数的 BigDecimal 类，则乘法将不会溢出。）

无论如何，在我的代码中，每个元素都在 1 到 1.00001 之间

另一方面，日志方法没有溢出或下溢的问题。

这是代码：

```
class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Starting...");
        Console.WriteLine("");

        Stopwatch watch1 = new Stopwatch();
        Stopwatch watch2 = new Stopwatch();

        List<double> list = getList();

        double prod = 1;

        double mean1 = -1;

        for (int c = 0; c < 2; c++)
        {
            watch1.Reset();

            watch1.Start();

            prod = 1;

            foreach (double d in list)
            {
                prod *= d;
            }

            mean1 = Math.Pow(prod, 1.0 / (double)list.Count);

            watch1.Stop();

        }

        double mean2 = -1;

        for (int c = 0; c < 2; c++)
        {
            watch2.Reset();

            watch2.Start();

            double sum = 0;

            foreach (double d in list)
            {
                double logged = Math.Log(d, 2);
                sum += logged;
            }

            sum *= 1.0 / (double)list.Count;

            mean2 = Math.Pow(2.0, sum);

            watch2.Stop();

        }
        Console.WriteLine("First way gave: " + mean1);
        Console.WriteLine("Other way gave: " + mean2);

        Console.WriteLine("First way took: " + watch1.ElapsedMilliseconds + " milliseconds.");
        Console.WriteLine("Other way took: " + watch2.ElapsedMilliseconds + " milliseconds.");

        Console.WriteLine("");
        Console.WriteLine("Press enter to exit");
        Console.ReadLine();
    }

    private static List<double> getList()
    {
        List<double> result = new List<double>();

        Random rand = new Random();

        for (int i = 0; i < 50000000; i++)
        {
            result.Add( rand.NextDouble() / 100000.0 + 1);
        }

        return result;
    }
} 
```

我的计算机输出描述了两个几何平均值相同，但是：

```
Multiply  way took: 466 milliseconds
Logarithm way took: 3245 milliseconds 
```

因此，乘法似乎更快。

但是乘法在溢出和下溢时非常有问题，所以我会推荐 Log 方法，除非你能保证乘积不会溢出并且乘积不会太接近于零。

# asp.net - 如何遍历许多文本框以不允许空值？

> ID：12394575
> 
> 赞同：0
> 
> 时间：2012-09-12T18:58:27.717
> 
> 标签：asp.net

我有大量用于批量插入页面 textbox1、文本框等的文本框。如何在提交按钮时遍历它们以不允许空值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:03:32.320

你可以试试这样的

```
foreach (Control ctrl in Page.Controls)
{
   if (c is TextBox || c is RichTextBox)

        {
            ///DO SOMETHING TO AVOID IT 
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:03:36.060

```
var controls = RecursiveFunctionThatRetrievesAllAppropriateControls(Page);

foreach(WebControl control in controls){
    if(control is TextBox && String.IsNullOrEmpty(((TextBox)control).Text))
        /* ... do something ... */

    ...

} 
```

# applet - Javacard 可共享接口：lookupAID 返回 AID 但 getAppletShareableInterface 返回 null

> ID：12394579
> 
> 赞同：2
> 
> 时间：2012-09-12T18:58:43.173
> 
> 标签：applet, client, javacard

编辑2：发现错误。我试图在构造函数中初始化 Shareable 对象。那时还没有调用客户端的 register 方法，所以 JCRE 没有它的 AID。虽然我的服务器的 getShareableInterfaceObject(AID clientaid, byte parameter) 方法不需要客户端的 AID 为 != null ，但 JCRE 可能会这样做，因为它为我的客户端调用此方法。我现在在处理我的第一个 APDU 时初始化我的 Shareable 对象，它现在可以工作了。

顺便说一句，感谢 owlstead 帮助格式化我的帖子。绝对让阅读更容易！

* * *

我是 Java Card 开发的新手，我的`Shareable`界面无法正常工作。

我有一个接口类声明我的客户端小程序想要使用的功能。我的服务器小程序实现了这个类。我的客户端小程序查找 AID 并尝试通过调用`getAppletShareableInterface()`. 但这总是返回`null`。

我的服务器小程序`getShareableInterface()`由 just 组成`return this;`，所以我猜故障出在其他地方。但我不知道在哪里。

我正在使用 JCWDE 并单步执行代码，我看到我的服务器小程序调用了注册，因此客户端小程序应该能够找到它。谁能给我一些指示可能出了什么问题？

编辑：

```
public interface IF extends Shareable {
    public void method();
}

public class Server extends Applet implements IF {
    public getShareableInterfaceObject {
        return this;
    }
}

public class Client extends Applet {

    private Client() {
        AID ServerAID = JCSystem.lookupAID(byteArrayAID, (short)0, (byte)byteArrayAID.length);
        interface = (IF)JCSystem.getAppletShareableInterfaceObject(ServerAID, (byte)0x00);
    }

    public void process(APDU apdu) {
        interface.method();
    }
} 
```

lookupAID 返回正确的 AID，但 getAppletShareableInterfaceObject 返回 null，就好像服务器小程序不存在一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T08:03:26.920

发现了错误。我试图在构造函数中初始化 Shareable 对象。那时还没有调用客户端的 register 方法，所以 JCRE 没有它的 AID。虽然我的服务器的 getShareableInterfaceObject(AID clientaid, byte parameter) 方法不需要客户端的 AID 为 != null ，但 JCRE 可能会这样做，因为它为我的客户端调用此方法。我现在在处理我的第一个 APDU 时初始化我的 Shareable 对象，它现在可以工作了。

# haskell - 创建孤立实例或添加虚假依赖项？

> ID：12394582
> 
> 赞同：1
> 
> 时间：2012-09-12T18:58:47.530
> 
> 标签：haskell, typeclass

我正在更新我的[ReadArgs 包](http://hackage.haskell.org/package/ReadArgs-1.1)。`Arguable`我有一个为 Data.Text 和[FileSystem.Path.FilePath](http://hackage.haskell.org/packages/archive/system-filepath/latest/doc/html/Filesystem-Path.html#t%3aFilePath)添加实例的请求。前者没什么大不了的，因为它在`base`包装中，但后者需要`system-filepath`

所以我可以发布一个`ReadArgs-ext`包，塞满孤儿实例，或者我可以`ReadArgs`用一个额外的外部依赖来更新这个包。哪个选项更有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T08:07:57.080

我通常的经验法则是倾向于为 Haskell 平台中的包添加实例，但不涉及较少可移植的元素，例如图形。这涵盖了`filepath`和`text`。由于您已经在与外部世界处理命令行参数，因此这些都不是特别令人震惊的添加。

孤儿会导致非常可怕的问题。

我没有在 95% 的包中使用它们，而且我会竭尽全力避免使用它们的包。

在这一点上，我遇到的两个例外是一些丢失的幺半群`reducers`和一个装满`vector-instances`我捡起的包，因为我不愿意让我的整个包层次结构都依赖于`vector`，将所有内容从 . 降级`Safe`为`Trustworthy`.

我发现当我想添加一个孤立实例时，我通常可以通过提供某种类似`WrappedMonad`newtype 的包装器来提升或降低另一个类来解决它。

# objective-c - 初始化后将 NSString 更改为 @"" (Objective C)

> ID：12394585
> 
> 赞同：0
> 
> 时间：2012-09-12T18:59:02.477
> 
> 标签：objective-c

专家们，

我想知道下面的代码是否正确。我知道 NSStrings 是不可变的，但大多数时候我希望它们初始化为空字符串，所以我不必检查它们是否为空。代码运行良好，但我想确保它不会引起任何问题。

```
NSString *myString = @"";
if (i > 0) {
  myString = @"The message";
}

... use myString without testing for null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:00:10.477

是的，那样完全没问题。

# javascript - DIV 隐藏元素空间调整

> ID：12394593
> 
> 赞同：-1
> 
> 时间：2012-09-12T18:59:49.643
> 
> 标签：javascript, html, css

我有一个奇怪的问题。

我正在使用切换来显示和隐藏页面的内容。我根据javascript中的onclick事件更改了div元素的可见性，它工作正常。

我的问题是，即使在 onclick 之前隐藏了某些内容，页面中也会分配空间，并且一旦单击事件发生，文本就会出现在空间中。如果我们再次单击，文本就会消失。

我希望空间也消失，否则看起来很尴尬。我将附上图片以供进一步参考。请只有 javascript、css 和 php 没有 jquery 解决方案。 ![问题的图像](../Images/7cdf6faa952ccea2760bbe9f5a4b6c29.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:04:42.873

你应该使用 CSS`display: none`而不是`visibility: hidden`你正在做的。 `visibility: hidden`只是使元素不可见，但在文档中保留其位置，而`display: none`从文档流中完全删除该项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:04:06.853

采用

```
display: none; 
```

代替

```
visibility: hidden; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:05:30.830

没有看到你的代码就很难确定你的错误，但这是一个很好的例子。

```
<script language="javascript"> 
function toggle() {
var ele = document.getElementById("toggleText");
var text = document.getElementById("displayText");
if(ele.style.display == "block") {
        ele.style.display = "none";
    text.innerHTML = "show";
}
else {
    ele.style.display = "block";
    text.innerHTML = "hide";
}
} 
</script>

<a id="displayText" href="javascript:toggle();">show</a> <== click Here
<div id="toggleText" style="display: none"><h1>peek-a-boo</h1></div> 
```

# android - 是否可以在移动设备上访问 localStorage 和 Web SQL 数据？

> ID：12394594
> 
> 赞同：0
> 
> 时间：2012-09-12T18:59:51.537
> 
> 标签：android, iphone, ipad, local-storage, web-sql

据我所知，没有办法在移动设备的浏览器中调出开发者控制台。但是，有没有办法通过本机 OS API 获取这些数据？或者也许通过将设备连接到计算机并导航它的文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:12:06.267

M. 我不确定您在移动设备上访问 Web SQL 数据是什么意思。

至于调试，您可以在 iPhone 的 safari 属性中打开调试控制台。（设置 > Safari > 高级 > 调试控制台）。这将让您看到控制台日志和 JS 错误。

对于本地存储，有几个选项。您可以使用 HTML5 本地存储，详细信息请参阅这篇关于开发linkedin 移动应用程序的博客文章。(http://engineering.linkedin.com/mobile/linkedin-ipad-using-local-storage-snappy-mobile-apps)

# r - 频率表中的累积概率图

> ID：12394596
> 
> 赞同：2
> 
> 时间：2012-09-12T18:59:59.470
> 
> 标签：r, ggplot2

有没有办法从频率表中绘制累积概率？我的意思是它的“平滑”版本，类似于`geom_density()`情节的方式。

到目前为止，我设法将单独计算的概率绘制为由线连接的点，但看起来不太好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:21:36.340

我生成一些测试数据：

```
set.seed(1)
x <- sort(sample(1:100, 20))
p <- runif(x); p <- cumsum(p)/sum(p)
table <- data.frame(x=x, prob=p) 
```

您可以使用 ggplot2 包中的 geom_smooth。

```
require("ggplot2")
qplot(x=x, y=p, data=table, aes(ymin=0, ymax=1)) + ylab("ecf") + 
geom_smooth(se=F, stat="smooth", method="loess", fullrange=T, fill="lightgrey", size=1) 
```

作为替代方案，一种通过参数指定平滑的简单方法尝试 decon 包中的 DeconCdf：

```
require("decon")
plot(DeconCdf(x, sig=1)) 
```

如果要使用 ggplot，首先必须在 data.frame 中转换 Decon 函数对象。

```
f <- DeconCdf(x, sig=1)
m <- ggplot(data=data.frame(x=f$x, p=f$y), aes(x=x, y=p, ymin=0, ymax=1)) + ylab("ecf")
m + geom_line(size=1) 
```

使用 sig-Parameter 作为平滑参数：

```
f <- DeconCdf(x, sig=0.3)
m <- ggplot(data=data.frame(x=f$x, p=f$y), aes(x=x, y=p, ymin=0, ymax=1)) + ylab("ecf")
m + geom_line(size=1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T20:46:06.847

这个版本绘制了一个带有平滑线的直方图`geom_density`：

```
# Generate some data:
set.seed(28986)
x2 <- rweibull(100, 1, 1/2)

# Plot the points:
library(ggplot2)
library(scales)
ggplot(data.frame(x=x2),aes(x=x, y=1-cumsum(..count..)/sum(..count..))) +
  geom_histogram(aes(fill=..count..)) +
  geom_density(fill=NA, color="black", adjust=1/2) +
  scale_y_continuous("Percent of units\n(equal to or larger than x)",labels=percent) +
  theme_grey(base_size=18) 
```

![在此处输入图像描述](../Images/2025a957ec332f4c30eefdee9265fbd8.png) 请注意，由于个人偏好，我使用了 1 -“累积概率”（我认为它看起来更好，并且我习惯于处理“[可靠性](http://reliawiki.org/index.php/File:WB.8_weibull_reliability.png)”指标），但显然这只是一个偏好，您可以通过删除`1-`部分来忽略在`aes`.

# c# - 找出一个线程是否已经开始？

> ID：12394597
> 
> 赞同：3
> 
> 时间：2012-09-12T19:00:09.463
> 
> 标签：c#, multithreading, .net-4.0, dispatcher, polling

我有以下代码：

```
var x = new Thread(new ThreadStart(Delegate));
x.Start(); 
```

这将创建一个新线程并启动它。

如何在没有 do while 循环的情况下检测到线程 X 已经开始执行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:05:07.553

使用信号量、互斥体或 Auto/ManualResetEvent。

# 代码

```
//Initialize semaphore, set it to BLOCK
ManualResetEvent sema = new ManualResetEvent(false);

void Main()
{
    var x = new Thread(Delegate);
    //Request the system to start the thread.
    //This doesn't mean the CPU will immediately run Delegate method
    //but eventually it will do
    x.Start(sema);

    //Stop here and don't do anything on this thread until the semaphore is FREE
    sema.WaitOne();

    [continued main thread]
}

void Delegate(Semaphore sema){
    //Unblock the semaphore
    sema.Set(1);
    [your code here]
} 
```

# 深度解释

多线程背后的原则之一**是非确定性**。如果您不使用正确的技术，如上所述，您**将无法**预测在多个线程中完成的操作的行为如果您有这样的方法

```
void Main()
{
    A();
    B();
    C();
} 
```

然后你确定 B 永远不会在 A 之前或 C 之后执行。这同样不适用于多线程。

```
void Main()
{
    new Thread(A).Start();
    new Thread(B).Start();
    new Thread(C).Start();

    D();
} 
```

您确定运行 B`started`的线程在运行 A 的线程之后，但是在多线程中，这意味着不同的东西。在 MSDN 和每一本编程书籍中，*启动*线程仅仅意味着请求操作系统在内核中分配适当的设施以支持多线程。如果这样做了（线程被正确创建并安排执行），则该方法返回而没有错误。操作系统可能会以任意顺序运行三个线程，这取决于几个因素。

因此，如果您将它们调试到控制台（认为每个都做 a `Console.WriteLine("Hello, I'm thread A/B/C")`，您可以在不同的执行中获得任何顺序：`A,B,C`; `A,C,B`;`B,C,A`等等。

所以你现在想确定，但真的，真的确定，一个特定的或每个线程在运行 D 之前已经真正启动了。事实上，在许多单核 CPU 的情况下，操作系统应该`D`在每个线程之前运行方法. 这也是不可预测的！所以在无法预测 A、B 和 C 何时运行后，您无法预测 D 何时运行！！

显式**同步**是一种强制暂停代码执行并**等待**事件发生的技术。信号量释放所描述的事件取决于上下文，所以在你的情况下，你只是告诉主线程“等待委托开始，然后做任何你想做的事情”:)

# 替代的、低效的方法

使用信号量只是通过无限循环执行以下操作的有效方法

```
volatile bool threadStarted = false;

void Main()
{
    var x = new Thread(Delegate);
    x.Start();

    while (!threadStarted);
    [continued main thread]
}

void Delegate(Semaphore sema){
    threadStarted = true;
    [your code here]
} 
```

使用信号量并不会简单地浪费 CPU 来不断检查某个标志是低还是高

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:05:27.850

在最基本的层面上，您可以尝试：

```
if (((Thread)x).ThreadState==ThreadState.Running){
   // do something interesting
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:05:36.533

```
x.ThreadState == System.Threading.ThreadState.Running 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T19:05:57.780

您可以使用[Thread.ThreadState](http://msdn.microsoft.com/en-us/library/system.threading.thread.threadstate.aspx)属性来查找其状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:04:56.587

假设线程是长寿命的，最简单的方法是检查 Thread.IsAlive。

# list - 如何使用 Selenium2/WebDriver 迭代 WebElements 列表以对某些元素执行操作

> ID：12394599
> 
> 赞同：1
> 
> 时间：2012-09-12T19:00:10.323
> 
> 标签：list, automated-tests, selenium-webdriver

如果用户没有适当的权限，我需要测试页面上的某些按钮是否被隐藏。我正在获取页面上的所有 WebElements：

```
List<WebElement> allElements = findElementsByXpath("//*"); 
```

我不确定如何遍历列表以对其找到的元素采取行动。我发现的所有示例都包括打印信息，这对于自动化测试不起作用。

最终目标是获取列表，迭代并为不应出现的元素执行 if...then 语句最终 then 语句包括一个存在并将被单击的链接，以便我可以在该页面上声明不同的文本.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T12:43:11.330

这更少您需要的代码。此代码假定您在执行期间不更改页面。

```
for (WebElement t : allElements) {
    if ("button".equalsIgnoreCase(t.getTagName()) && <insert here condition to check if this is the element you are looking for>){
        if (t.isDisplayed()){
             fail;
        }

    }
} 
```

# java - 程序不会在 while 循环内进入 try 块

> ID：12394601
> 
> 赞同：1
> 
> 时间：2012-09-12T19:00:14.847
> 
> 标签：java, exception, loops, while-loop, try-catch

我正在尝试为学校编写一个程序。任务是循环并要求用户输入文件。当找不到文件或用户退出循环（在我的情况下，他们单击 joptionpane 上的取消）时，将输出每个文件的数据。到目前为止，这是我的代码：

```
/**
 * @param args
 */
public static void main(String[] args) {

    // Lists to hold file data
    List<String> fileNames = new ArrayList<String>();
    List<Integer> numChars = new ArrayList<Integer>();
    List<Integer> numWords = new ArrayList<Integer>();
    List<Integer> numLines = new ArrayList<Integer>();
    String inFile;

    while ( (inFile = JOptionPane.showInputDialog("Enter a file name:")) != null) {

        // Create new file object instance
        File file = new File(inFile);

        try {
            fileNames.add(inFile);  // File name as a string
            // Pass file objects
            numChars.add( getNumChars(file));
            numWords.add( getNumWords(file));
            numLines.add( getNumLines(file));
            System.out.println("entered try block");
        } catch(FileNotFoundException e) {
            System.out.println("Could not find file: " + inFile);
            // break out the loop and display data
            break;
        }
    }   // end while

    if (numChars.size() > 0)
        showFileData(fileNames, numChars, numWords, numLines);

    System.out.println("Program ended");

}

private static void showFileData(List<String> fileNames,
        List<Integer> numChars, List<Integer> numWords,
        List<Integer> numLines) {
    for (int i=0;i<numChars.size();i++) {
        System.out.println("Data for: " + fileNames.get(i));
        System.out.println("Number of characters: " + numChars.get(i));
        System.out.println("Number of words: " + numWords.get(i));
        System.out.println("Number of lines: " + numLines.get(i));
        System.out.println("-----------------------------------------------");
    }

}

private static int getNumLines(File file) throws FileNotFoundException {
    int c = 0;
    Scanner f = new Scanner(file);
    while(f.hasNextLine()) {
        c++;
    }
    return c;
}

private static int getNumWords(File file) throws FileNotFoundException {
    int c = 0;
    Scanner f = new Scanner(file);
    while (f.hasNextLine()) {
        String[] w = f.nextLine().split(" ");
        c += w.length;
    }
    return c;
}

private static int getNumChars(File file) throws FileNotFoundException {
    Scanner f = new Scanner(file);
    int c = 0;
    String line;
    while(f.hasNextLine()) {
        line = f.nextLine();
        String[] s = line.split(" ");
        for (int i=0;i<s.length;i++) {
            c += s[i].length();
        }
    }
    return c;
} 
```

当我运行程序时，如果我按下取消，它会退出循环并在最后显示内容，就像它应该的那样。如果我输入一个不存在的文件，它会按预期工作。唯一不起作用的是当我输入一个确实存在的文件时，它不会弹出另一个输入对话框。事实上，它似乎并没有进入 try 块。我是否正确设置了我的程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:07:55.727

你有一个无限循环`getNumLines()`。你需要一个`f.nextLine()`在while循环中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:10:55.957

@DomV 是正确的，您的 getNumLines() 函数中有一个无限循环。

您最终打开文件并阅读它三次以获得行数，一次获得单词数，一次获得字符数。也许您想找到一种方法来最小化那些昂贵的磁盘操作。这样做还将迫使您在阅读文件并解决无限循环时更仔细地检查您正在做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:11:10.680

应用程序在此方法中永远循环：

```
private static int getNumLines(File file) throws FileNotFoundException {
    int c = 0;
    Scanner f = new Scanner(file);
    while(f.hasNextLine()) {
        c++;
    }
    return c;
} 
```

注意 while() 循环：您检查文件中是否还有其他行，但不从文件中读取任何数据 - 因此，hasNextLine() 不断返回 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:11:57.307

在 getNumLines 中：

```
 while(f.hasNextLine()) {
  c++;
 } 
```

永远是真的，改变它

```
 private static int getNumLines(File file) throws FileNotFoundException {
    int c = 0;
    Scanner f = new Scanner(file);
     while(f.hasNextLine()) {
        f.nextLine();
        c++;
     }
     return c;
    } 
```

# python - 存储长字符串资产的最 Pythonic/Django-y 方式是什么？

> ID：12394602
> 
> 赞同：2
> 
> 时间：2012-09-12T19:00:18.007
> 
> 标签：python, django, string, django-templates

我的 Django 应用程序中有一个函数，它有一个包含几个长字符串的字典。当调用该函数时，这些字符串被格式化并返回字典。

例如：

```
def my_strings(foo, bar, baz):
    return = {
        'string1': 'a really long string! %s' % foo,
        'string2': 'another long one. %s %s' % (foo, bar),
        'string3': 'yet another! %s %s %s' % (foo, bar, baz),
    } 
```

但是，将所有这些长字符串存储在 Python 文件中是很难看的，似乎应该有一种更简洁的方法来做到这一点。

我曾尝试将它们放入模板文件并进行一些渲染，如下所示：

**我的模板.txt**

```
{% if string1 %}
a really long string! {{ foo }}
{% endif %}

{% if string2 %}
another long one. {{ foo }} {{ bar }}
{% endif %}

{% if string3 %}
yet another! {{ foo }} {{ bar }} {{ baz }}
{% endif %} 
```

**Python**

```
def my_strings(foo, bar, baz):
    arg_dict = {
        'foo': foo,
        'bar': bar,
        'baz': baz,
    }

    my_strings = {}
    string_names = ['string1', 'string2', 'string3']

    for s in string_names:
        arg_dict[s] = True
        my_strings[s] = render_to_string('mytemplate.txt', arg_dict).strip()
        del arg_dict[s]

    return my_strings 
```

但这似乎有点过于迂回，而且很可能性能较差。

在 Python 或 Django 中是否有首选方法来处理存储和格式化长字符串资产？

一些额外的上下文：字符串资产是 HTML 或纯文本。字典最终被迭代，并且另一个字符串中每个键的所有实例都被替换为其字符串值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:56:30.420

我会将其视为类似于许多 i8n 编译代码的方式。

将长字符串存储在单独文件中的字典中。导入该字典，然后在您的代码中格式化所需的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:00:01.417

您可以将字符串放在 longstrings.py 之类的模块中

```
STRING1 = ("Bla bla"
     " more text"
     " even more text")

STRING2 = ("Bla bla"
     " more text"
     " even more text") 
```

接着

```
from  longstrings import *

def my_strings(foo, bar, baz):
    return = {
        'string1': STRING1 % foo,
        'string2': STRING2 % (foo, bar),
        'string3': STRING2 % (foo, bar, baz),
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-19T07:48:00.940

您还可以为您的长字符串创建一个类，并将它们存储在数据库中。这将允许您访问它们并将它们修改为任何其他对象。例如，如果要修改特定字符串，可以使用 Django 管理工具。

# api - Foursquare 推送（实时）API 是否会在 POST 失败时重试发送？

> ID：12394606
> 
> 赞同：1
> 
> 时间：2012-09-12T19:00:46.157
> 
> 标签：api, push, real-time, foursquare

关于实时 API 的文档在推送通知背后的机制上相当稀少。如果接收端点当时没有响应，Foursquare API 是否会重试 POST 通知（签入）？例如，这里是 Facebook 的重试策略：

“如果对您服务器的更改通知失败，Facebook 将立即重试，然后在接下来的 24 小时内重试几次，频率逐渐降低。”

foursquare有类似的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:21:47.857

Foursquare 目前不会重试推送请求。如果您认为自己错过了签到，您可以（尽管效率低下）为每个用户调用 /users/self/checkins?afterTimestamp=XXXX 并使用他们的访问令牌来检索他们最近的签到。

# java - Java UIManager 键列表

> ID：12394608
> 
> 赞同：8
> 
> 时间：2012-09-12T19:00:52.233
> 
> 标签：java, swing, uimanager

我见过人们使用 UIManager 来更改一些预先创建的摆动组件（例如 JFileChooser）的字符串。

我在哪里可以找到某种参考资料，告诉我哪些组件中的哪些字符串是可变的，以及如何访问它们？

澄清：

我知道这`UIManager.put(key, newString);`会将键引用的字符串文本更改为`"newString"`.

我在哪里可以找到密钥列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:17:57.267

*   `Keys for UIManage`r 是敏感的，当您比较来自、notice的值时，`Look and Feel`意味着（例如）值`Keys for Metal Look and Feel`可能会有所不同`System Look and Feel``Key missed`

*   使用@camickr 的[UIManager Default](http://tips4java.wordpress.com/2008/10/09/uimanager-defaults/) s

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-11T21:50:50.177

您最好使用如下代码自己转储列表，因为键可能不同：

```
public static void printUIManagerKeys()
{
    UIDefaults defaults = UIManager.getDefaults();
    Enumeration<Object> keysEnumeration = defaults.keys();
    ArrayList<Object> keysList = Collections.list(keysEnumeration);
    for (Object key : keysList)
    {
        System.out.println(key);
    }
} 
```

对我来说，该列表`1365`包含`Windows 10`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-26T14:53:27.710

这些密钥由 Swing PLAF 资源包提供，您可以在 JDK 源代码中找到它们。参见例如：

*   [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/com/sun/swing/internal/plaf/basic/resources/basic.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/com/sun/swing/internal/plaf/basic/resources/basic.java)
*   [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/com/sun/java/swing/plaf/windows/resources/windows.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/com/sun/java/swing/plaf/windows/resources/windows.java)
*   [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/com/sun/java/swing/plaf/gtk/resources/gtk.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/com/sun/java/swing/plaf/gtk/resources/gtk.java)
*   ...

非英语语言的字符串值由相邻的捆绑文件提供。

您只需为所需的人类语言再创建一个文件并将其放置在类路径的任何位置，就可以为这些系列中的任何一个再添加一个包。.java 和 .properties 格式的捆绑包同样工作良好，尽管 .java 格式可能对 Unicode 更友好...

`com.sun`尽管直接将内容添加到包中可能会违反 Java 许可证，但请记住这一点可能会很好。所以为了安全起见，将你的额外资源移动到你自己的包中并像这样注册它可能是明智的`UIManager`：

```
UIManager.getDefaults().addResourceBundle("mypackage.swing.plaf.basic.resources.basic"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-03T14:57:23.770

似乎必须**运行一些代码**才能查看所有键。我知道这个问题是针对 java 的，但真正获得密钥的最快方法是启动 groovy（或 gradle）脚本：

```
javax.swing.UIManager.getDefaults().keys().toList().toSorted().each {println it} 
```

将其粘贴到文件中并调用`groovy keys.groovy`or `gradle -b keys.groovy`，无论您更容易获得什么工具。

**在不创建文件**的情况下，它也可以使用 groovy。只需执行：

```
groovy -e "javax.swing.UIManager.getDefaults().keys().toList().toSorted().each {println it}" 
```

# javascript - ios 中的 Soundcloud HTML5 播放器

> ID：12394613
> 
> 赞同：1
> 
> 时间：2012-09-12T19:01:19.673
> 
> 标签：javascript, html, ios, soundcloud

我正在尝试为 ios 中的 soundcloud 播放器制作自定义按钮，它适用于所有其他平台。有人能告诉我为什么我的切换按钮在 ios、Safari 下不起作用吗？

跳过按钮效果很好，如果我点击玩家自己的（红色）切换按钮，声音也会开始播放。按下此按钮并播放音频后，我的切换按钮也开始工作。似乎它不会接受来自我的自定义按钮的第一个 javascript 调用。

```
<body>
        <iframe id="iframe" src="http://w.soundcloud.com/player/?url=http://api.soundcloud.com/users/calvinharris&color=ed1c24&show_comments=false&show_artwork=false" class="iframe"
          width= "320px"
          height="567px"
          scrolling="no"
          frameborder="no">
        </iframe>

     <button onclick="prev()"><<</button>
     <button onclick="toggle()">|> ||</button>
     <button onclick="next()">>></button>

    <script src="http://w.soundcloud.com/player/api.js" type="text/javascript"></script><script type="text/javascript">

var iframe = document.querySelector('.iframe');
iframe.src = "http://w.soundcloud.com/player/?url=http://api.soundcloud.com/users/calvinharris&color=ed1c24&show_comments=false&show_artwork=false";
var widget = SC.Widget(iframe);

function toggle(){
    widget.toggle();
}

function next(){
    widget.next();              
}

function prev(){
    widget.prev();      
}

</script>
</body>
</html> 
```

# java - 销毁会话

> ID：12394614
> 
> 赞同：0
> 
> 时间：2012-09-12T19:01:20.830
> 
> 标签：java, jsp, session

我想在我的项目中销毁一个会话，这样当我点击注销时，它会转到一个页面 "KillSession.jsp" ，在那个文件中我写了 "session.invalidate();" 然后我将用户重定向到登录页面。但是，如果我使用浏览器上的后退按钮，即使我已注销，它也会返回到我之前访问过的页面。该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:02:56.820

您的浏览器缓存它，您需要添加标题以强制您的浏览器不强制它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:04:30.790

确保在注销之前不缓存最后一页。您可以执行以下操作：

```
response.setHeader("Cache-Control","no-cache,no-store,must-revalidate");
response.setHeader("Pragma","no-cache");
response.setDateHeader("Expires", 0); 
```

# python - 调用 ctypes 函数时 Python int 溢出

> ID：12394616
> 
> 赞同：4
> 
> 时间：2012-09-12T19:01:26.587
> 
> 标签：python, ctypes, ffi

我在玩 ctypes……我有以下 C 代码

**编辑**：我试图弄清楚这一点的原因是让[这篇博](http://jiaaro.com/python-performance-the-easyish-way)文更正确

sumrange.c

```
#include <stdio.h>

long sumrange(long);

long sumrange(long arg)
{
    long i, x;
    x = 0L;

    for (i = 0L; i < arg; i++) {
        x = x + i;
    }
    return x;
} 
```

我使用以下命令编译（在 OSX 上）

```
$ gcc -shared -Wl,-install_name,sumrange.so -o ./sumrange.so -fPIC ./sumrange.c 
```

我在 python 中实现了相同的功能：

```
pysumrange = lambda arg: sum(xrange(arg)) 
```

然后我在交互式 shell 中运行两者：

```
>>> import ctypes
>>> sumrange = ctypes.CDLL('./sumrange.so')
>>> pysumrange = lambda arg: sum(xrange(arg))
>>> print sumrange.sumrange(10**8), pysumrange(10**8)
... 887459712 4999999950000000 
```

…而且数字不匹配。为什么会这样？

我尝试使用`unsigned long long`C 代码中的所有变量，但没有效果（相同的输出）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:06:48.237

`long`是 32 位类型，所以 C 代码简单地溢出。

Python 没有；`pysumrange`给你正确的答案。

`ctypes``unsigned long long`除非你告诉它，否则不知道函数的返回类型是什么。请参阅Python 标准库文档中的[返回类型](http://docs.python.org/library/ctypes.html#return-types)。它说：

> 默认情况下，假定函数返回 C`int`类型。其他返回类型可以通过设置`restype`函数对象的属性来指定。

所以也许在调用函数之前这样做会对你有用：

```
sumrange.sumrange.restype = ctypes.c_ulonglong 
```

# python - Python - 从二进制文件中读取字符串

> ID：12394617
> 
> 赞同：3
> 
> 时间：2012-09-12T19:01:28.710
> 
> 标签：python

我需要读取二进制文件中某个字符串的位置，然后对后面的字节进行操作。字符串是`'colr'`（这是一个 JPEG 2000 文件），这是我目前所拥有的：

```
from collections import deque

f = open('my.jp2', 'rb')
bytes =  deque([], 4)
while ''.join(map(chr, bytes)) != 'colr':
    bytes.appendleft(ord(f.read(1))) 
```

如果这有效：

```
bytes =  deque([0x63, 0x6F, 0x6C, 0x72], 4)
print ''.join(map(chr, bytes)) 
```

（返回'colr'），我不确定为什么我的循环中的测试永远不会评估为`True`. 我结束了旋转 - 只是挂起 - 当我通读整个文件时，我什至没有退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:11:38.817

将您的更改`bytes.appendleft()`为`bytes.append()`，然后它将起作用-对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:03:36.623

```
 with open("my.jpg","rb") as f:
       print f.read().split("colr",1) 
```

如果你不想一次读完……那么

```
def preprocess(line):
    print "Do Something with this line"
def postprocess(line):
    print "Do something else with this line"
currentproc = preprocess
with open("my.jpg","rb") as f:
   for line in f:
       if "colr" in line:
           left,right = line.split("colr")
           preprocess(left)
           postprocess(right) 
           currentproc= postprocess
        else:
           currentproc(line) 
```

它逐行而不是逐字节......但是嗯......我很难想到你没有足够的内存来将整个jpg保存在内存中...... python并不是一个真正的语言来最小化内存或时间足迹，但对于功能要求来说很棒:)

# xcode - 应用内购买被“无法连接到商店”阻止

> ID：12394618
> 
> 赞同：2
> 
> 时间：2012-09-12T19:01:34.963
> 
> 标签：xcode, itunes-store

最近，当我尝试进行应用内购买时，我的设备抛出错误“无法连接到商店”。请注意，错误不是说“iTunes 商店”或“应用商店”。这是两天前的工作，没有代码改变。我唯一摆弄的是方案设置和构建设置。在我开始归档和构建以供发布后，出现了错误。我不记得我所做的每一个更改，我真的在问是否有任何方案设置会导致这个问题。

*我试过的：*

不同的设备。（相同的错误，两个不同的设备，在不同的测试用户帐户上）

不同的帐户/测试用户。

购买时未登录。

注意：模拟器通过了这个错误，但我需要在发布到应用商店之前在设备上进行测试。我可以使用两个测试用户帐户很好地浏览商店。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:36:31.390

您无法在模拟器中测试应用内购买：请参阅[本页](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/DevelopingwithStoreKit/DevelopingwithStoreKit.html#//apple_ref/doc/uid/TP40008267-CH103-SW1)的第一个注释。

我认为您面临的问题不是由于您的程序，如果它以前可以工作：用于使用您的测试人员帐户模拟应用内购买的沙盒服务器可能只是关闭：在沙盒环境中，您不测试您的购买真正的应用内购买服务器。

请注意，您肯定有一个符合`SKProductsRequestDelegate`. `request:didFailWithError:`当您无法获取产品信息列表时，您可以实施以获取通知。

# jquery - jQuery $.ajax 或 $.load 是否允许 responseType arrayBuffer？

> ID：12394622
> 
> 赞同：22
> 
> 时间：2012-09-12T19:01:50.020
> 
> 标签：jquery, ajax, xmlhttprequest

我开始使用 Web Audio API，只是想知道是否可以使用 jQuery 的 $.ajax 或 $.load 函数来生成接收音频数据的 XMLHttpRequest。$.ajax 或 $.load 是否支持 responseType=arrayBuffer？

编辑：

好的，这就是我到目前为止所拥有的：

```
function loadAudio() {
    $.ajax({
            url: sourceUrl
        }).done(function(response){
            return response;
        })
    } 
```

但我需要返回一个 ArrayBuffer。那么如何将响应转换为 ArrayBuffer？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-05-22T17:07:20.273

关于您的问题，jQuery 似乎还不支持它。在按照我下面的建议使用它之前，请考虑检查该功能是否可用。

使用 XHTMLRequest，您可以欺骗您的服务器并从服务器接收表示您想要的字节的二进制字符串。它完美地工作。

```
var xhr = new XMLHttpRequest();
xhr.open('GET', '/your/audio/file.wav', true);

// Here is the hack
xhr.overrideMimeType('text/plain; charset=x-user-defined');

xhr.onreadystatechange = function(event) {
  if ( this.readyState == 4 && this.status == 200 ) {
    var binaryString = this.responseText;

    for (var i = 0, len = binaryString.length; i < len; ++i) {
      var c = binaryString.charCodeAt(i);
      var byte = c & 0xff; //it gives you the byte at i
      //Do your cool stuff...

    }
  }
};

xhr.send(); 
```

它有效，很常见......但是......它仍然是一个黑客。

使用 XHTML 请求级别 2，您可以将 responseType 指定为 'arraybuffer' 并实际接收 ArrayBuffer。它要好得多。问题是检查您的浏览器是否支持此功能。

```
var xhr = new XMLHttpRequest();
xhr.open('GET', '/your/audio/file.wav', true);
xhr.responseType = 'arraybuffer';

xhr.onload = function(e) {
  if (this.status == 200) {
    //Do your stuff here
  }
};

xhr.send(); 
```

希望我有所帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-03-06T19:51:12.933

实际上，有一种更简单的方法可以使用 jQuery 和本机来做到这一点，`XMLHttpRequest`而不必*仅*使用`XMLHttpRequest`或必须使用插件，因此您仍然可以使用 jQuery 样式/语法进行编码。`$.ajax()`is的选项之一`xhr`，[jQuery 文档](https://api.jquery.com/jQuery.ajax/)将其描述为（强调我的）：

> xhr`(default: ActiveXObject when available (IE), the XMLHttpRequest otherwise)`
> 
> 类型：函数（）
> 
> 创建 XMLHttpRequest 对象的回调。可用时默认为 ActiveXObject (IE)，否则为 XMLHttpRequest。 **重写以提供您自己的 XMLHttpRequest 实现**或对工厂的增强。

因此，为了获得`ArrayBuffer`对请求的响应`$.ajax()`，您所要做的就是：

```
var xhrOverride = new XMLHttpRequest();
xhrOverride.responseType = 'arraybuffer';

$.ajax({
    url: '/url/of/your/binary/data',
    method: 'GET',
    xhr: function() {
        return xhrOverride;
    }
}).then(function (responseData) {

    // responseData is an ArrayBuffer!

}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2022-01-31T15:19:30.050

我使用了[Dylan 的答案](https://stackoverflow.com/a/60570706/1238766)，它奏效了，但结果`$.ajax`请求不再是完整的 Promise（我不能再将它与它结合起来`Promise.all`）。相反，我通过使用`xhrFields`文档中的设置实现了相同的目的。

```
$.ajax({
    url: url,
    method: 'GET',
    xhrFields: { responseType: 'arraybuffer'}
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-14T08:01:04.450

我使用ajax get json从服务器获取数据作为字符串（base64编码为字符串），然后在客户端我将其解码为base64，然后解码到数组缓冲区。

**示例代码**

```
function solution1(base64Data) {

var arrBuffer = base64ToArrayBuffer(base64Data);

// It is necessary to create a new blob object with mime-type explicitly set
// otherwise only Chrome works like it should
var newBlob = new Blob([arrBuffer], { type: "application/pdf" });

// IE doesn't allow using a blob object directly as link href
// instead it is necessary to use msSaveOrOpenBlob
if (window.navigator && window.navigator.msSaveOrOpenBlob) {
    window.navigator.msSaveOrOpenBlob(newBlob);
    return;
}

// For other browsers: 
// Create a link pointing to the ObjectURL containing the blob.
var data = window.URL.createObjectURL(newBlob);

var link = document.createElement('a');
document.body.appendChild(link); //required in FF, optional for Chrome
link.href = data;
link.download = "file.pdf";
link.click();
window.URL.revokeObjectURL(data);
link.remove(); 
```

}

```
function base64ToArrayBuffer(data) {
var binaryString = window.atob(data);
var binaryLen = binaryString.length;
var bytes = new Uint8Array(binaryLen);
for (var i = 0; i < binaryLen; i++) {
    var ascii = binaryString.charCodeAt(i);
    bytes[i] = ascii;
}
return bytes; 
```

};

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-16T08:39:18.843

有一个简单的 jQuery 扩展： [https ://github.com/vobruba-martin/jquery.ajax.arraybuffer](https://github.com/vobruba-martin/jquery.ajax.arraybuffer)

```
$.get("https://www.website.com/image.png", function(data)
{
    console.log("received data", data);
}, "arraybuffer"); 
```

# python - 使用 Python 生成图像报告

> ID：12394630
> 
> 赞同：1
> 
> 时间：2012-09-12T19:02:26.130
> 
> 标签：python, image, text, python-imaging-library

嗨，我正在做一个项目，我必须使用 python 脚本生成图像（例如 .png、.bmp 等）。

图像必须具有：

1.  3种不同颜色的小盒子（8x8px）
2.  2 种不同尺寸的水平（普通）文本和 3）垂直文本（旋转普通文本）（像这样：[http](http://devcity.net/Data/ArticleImages/Dual_Labels.jpg) ://devcity.net/Data/ArticleImages/Dual_Labels.jpg ）所以不是很复杂的事情。

我在 PiL（Python 图像库）上度过了最后几天。对于小盒子，它工作得很好而且很容易。但是要在图像中生成文本，它就不能正常工作。

也可以使用标准字体（pilfont-type）编写普通文本。但我无法设置此文本的 px 大小。使用 truetypes 时，出现以下错误：“未安装 _imagingft C 模块”

我已经“用谷歌搜索”了这个，这似乎是一个流行的问题。我的问题是，该脚本还必须在其他 python 系统上运行。我可以接受的是，我必须在每台系统/计算机上安装 Pil，但我无法每次都解决 truetypes 的问题！我正在使用 Python 2.7 和 pil 1.1.7。

所以对于我的问题：对于我的脚本必须生成的命名“表单”，您会向我推荐什么库（或使用脚本生成图像的其他方法）？

是否可以使用我在“Pure-Python”中的脚本创建，例如用文本和颜色像素编写位图文件，所以没有任何扩展？（对我来说是最佳解决方案）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:22:01.830

这并不完全`matplotlib`是设计的目的，但绝对能够产生你所追求的。看看[画廊](http://matplotlib.org/examples/pylab_examples/pcolor_small.html)，它有你提到的几乎所有东西的用法示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:13:12.267

你有没有想过用[PyCairo](http://cairographics.org/pycairo/)代替？有关示例，请参见此链接：[https ://stackoverflow.com/a/6506825/514031](https://stackoverflow.com/a/6506825/514031)

# asp.net-mvc - Adobe Flash 和 ASP.NET 中的集成授权/身份验证

> ID：12394631
> 
> 赞同：3
> 
> 时间：2012-09-12T19:02:36.493
> 
> 标签：asp.net-mvc, actionscript-3, flash, apache-flex, authentication

我想根据用户的权限级别向用户显示直播内容。
权限是在 ASP.NET MVC Web 应用程序中设置的，如果用户没有经过身份验证*和*授权，即使他们直接拥有 swf 地址，他/她也不应该能够查看流。

有什么方法可以通知我的 Flash 项目有关当前用户在客户端无法篡改的权限级别，并决定如何在 Flash 项目中做出反应？

PS 不幸的是，silverlight 对我来说不是一个选择，除非它在闪光灯中是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T07:53:36.610

这有点投机，作为评论可能会更好，但我想包括几个长链接。如果结果大错特错，我会删除：

难道你不能让 MVC 授权框架来处理这个问题，通过使用[Principal Permission](http://weblogs.asp.net/scottgu/archive/2006/10/04/Tip_2F00_Trick_3A00_-Adding-Authorization-Rules-to-Business-and-Data-Layers-using-PrincipalPermissionAttributes.aspx)属性或`Web.Config`文件夹上基于角色的保护的代码返回流内容吗？来自浏览器内 Flash 播放器的任何请求都应该包含当前的[Asp.Net 加密 cookie](http://support.microsoft.com/kb/910443)，所以我认为您可以让浏览器处理这个问题。

# jquery - 根据值列表按其“标题”属性对一系列标签元素进行排序

> ID：12394634
> 
> 赞同：1
> 
> 时间：2012-09-12T19:02:45.157
> 
> 标签：jquery, arrays, sorting, label, title

我有一系列标签元素，我想根据特定的值列表（数组）按它们的“标题”属性进行排序。

我试图让它们从它们在色轮上的位置开始排序，并且基于十六进制代码正则表达式进行排序不起作用，因为有几个值通过颜色渐变关闭。

“labelTitles”数组中的值列表是我希望它们出现的顺序......但它对我不起作用。

```
<fieldset class="radio-table">
<legend>Color</legend>
    <label class="color-00C200" title="00C200" for="rad-00C200"> <input type="radio" value="00C200" id="rad-00C200"></label>
    <label class="color-F3F300" title="F3F300" for="rad-F3F300"> <input type="radio" value="F3F300" id="rad-F3F300"></label>
    <label class="color-6C09A2" title="6C09A2" for="rad-6C09A2"> <input type="radio" value="6C09A2" id="rad-6C09A2"></label>
    <label class="color-62D800" title="62D800" for="rad-62D800"> <input type="radio" value="62D800" id="rad-62D800"></label>
    <label class="color-F36E00" title="F36E00" for="rad-F36E00"> <input type="radio" value="F36E00" id="rad-F36E00"></label>
    <label class="color-F3DD00" title="F3DD00" for="rad-F3DD00"> <input type="radio" value="F3DD00" id="rad-F3DD00"></label>
    <label class="color-F3A200" title="F3A200" for="rad-F3A200"> <input type="radio" value="F3A200" id="rad-F3A200"></label>
    <label class="color-C3006E" title="C3006E" for="rad-C3006E"> <input type="radio" value="C3006E" id="rad-C3006E"></label>
    <label class="color-F3C900" title="F3C900" for="rad-F3C900"> <input type="radio" value="F3C900" id="rad-F3C900"></label>
    <label class="color-9E009E" title="9E009E" for="rad-9E009E"> <input type="radio" value="9E009E" id="rad-9E009E"></label>
    <label class="color-4F0EA5" title="4F0EA5" for="rad-4F0EA5"> <input type="radio" value="4F0EA5" id="rad-4F0EA5"></label>
    <label class="color-F3B600" title="F3B600" for="rad-F3B600"> <input type="radio" value="F3B600" id="rad-F3B600"></label>
    <label class="color-F38B00" title="F38B00" for="rad-F38B00"> <input type="radio" value="F38B00" id="rad-F38B00"></label>
    <label class="color-009292" title="009292" for="rad-009292"> <input type="radio" value="009292" id="rad-009292"></label>
    <label class="color-D90042" title="D90042" for="rad-D90042"> <input type="radio" value="D90042" id="rad-D90042"></label>
    <label class="color-C2EB00" title="C2EB00" for="rad-C2EB00"> <input type="radio" value="C2EB00" id="rad-C2EB00"></label>
    <label class="color-F30000" title="F30000" for="rad-F30000"> <input type="radio" value="F30000" id="rad-F30000"></label>
    <label class="color-3613A7" title="3613A7" for="rad-3613A7"> <input type="radio" value="3613A7" id="rad-3613A7"></label>
    <label class="color-00A75F" title="00A75F" for="rad-00A75F"> <input type="radio" value="00A75F" id="rad-00A75F"></label>
    <label class="color-0A5D9C" title="0A5D9C" for="rad-0A5D9C"> <input type="radio" value="0A5D9C" id="rad-0A5D9C"></label>
    <label class="color-97E300" title="97E300" for="rad-97E300"> <input type="radio" value="97E300" id="rad-97E300"></label>
    <label class="color-F34500" title="F34500" for="rad-F34500"> <input type="radio" value="F34500" id="rad-F34500"></label>
    <label class="color-113DA3" title="113DA3" for="rad-113DA3"> <input type="radio" value="113DA3" id="rad-113DA3"></label>
    <label class="color-1A1AAA" title="1A1AAA" for="rad-1A1AAA"> <input type="radio" value="1A1AAA" id="rad-1A1AAA"></label> 
```

这是我当前不起作用的功能。

```
 $(document).ready(function () {
        // Sort the lables by title
        function sortByTitle() {
            var labelTitles = ['F30000', 'F34500', 'F36E00', 'F38B00', 'F3A200', 'F3B600', 'F3C900', 'F3DD00', 'F3F300', 'C2EB00', '97E300', '62D800', '00C200', '00A75F', '009292', '0A5D9C', '113DA3', '1A1AAA', '3613A7', '4F0EA5', '6C09A2', '9E009E', 'C3006E', 'D90042'];
            var fieldsetOfLabels = $('.radio-table');
            var listLabels = fieldsetOfLabels.children('label').get();

            listLabels.sort(function (a, b) {
                var compA = $.inArray($(a).find('label[title]').text(), labelTitles);
                var compB = $.inArray($(b).find('label[title]').text(), labelTitles);
            });
            $(fieldsetOfLabels).append(listItems);
        }
    }); 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:05:45.383

代替

```
$(a).find('label[title]').text() 
```

尝试

```
$(a).attr('title') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:13:50.493

代码需要一些改动：

*   调用`sortByTitle`函数。
*   使用`attr`方法获取标题（正如 Blazemonger 已经提到的）
*   比较标签并在排序回调中返回结果。
*   使用`listLabels`变量来追加项目，而不是`listItems`.

演示：http: [//jsfiddle.net/NFp7Z/](http://jsfiddle.net/NFp7Z/)

```
$(document).ready(function(){

  function sortByTitle() {
    var labelTitles = ['F30000', 'F34500', 'F36E00', 'F38B00', 'F3A200', 'F3B600', 'F3C900', 'F3DD00', 'F3F300', 'C2EB00', '97E300', '62D800', '00C200', '00A75F', '009292', '0A5D9C', '113DA3', '1A1AAA', '3613A7', '4F0EA5', '6C09A2', '9E009E', 'C3006E', 'D90042'];
    var fieldsetOfLabels = $('.radio-table');
    var listLabels = fieldsetOfLabels.children('label').get();

    listLabels.sort(function(a, b) {
        var compA = $.inArray($(a).attr('title'), labelTitles);
        var compB = $.inArray($(b).attr('title'), labelTitles);
        return compA < compB ? -1 : 1;
    });
    $(fieldsetOfLabels).append(listLabels);
  }

  sortByTitle();

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T12:22:47.653

试试这个：

```
var b= $('.radio-table label');

b.sort(function(a, b)
    {
        if ($(a).prop("title") == $(b).prop("title")) { return 0; }
        if ($(a).prop("title") > $(b).prop("title"))
        {
            return 1;
        }
        else
        {
            return -1;
        }
    }); 
```

保持简单。

[例子](http://jsfiddle.net/paulodiogo/7WyFD/2/)

# cuda - 将结构指针传递给 CUDA 内核

> ID：12394638
> 
> 赞同：0
> 
> 时间：2012-09-12T19:03:05.377
> 
> 标签：cuda

> **可能重复：**
> [复制包含指向 CUDA 设备的指针的结构](https://stackoverflow.com/questions/9309195/copying-a-struct-containing-pointers-to-cuda-device)

我有一个设备指针结构，指向设备上分配的数组。像这样

```
struct mystruct{

int* dev1;
double* dev2;
.
.
} 
```

这个结构中有大量的数组。我开始编写一个 CUDA 内核，在其中传递指针`mystruct`，然后在 CUDA 内核代码中取消引用它，如下所示`mystruct->dev1[i]`。

但是我在写了几行之后意识到这不起作用，因为根据 CUDA 第一原则，您不能`mystruct`在 CUDA 内核中取消引用主机指针（在本例中为 ）。

但这有点不方便，因为我必须将大量参数传递给我的内核。有什么办法可以避免这种情况。我想尽可能缩短内核调用的参数数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T02:49:32.483

正如我在[这个答案](https://stackoverflow.com/a/9323898/749748)中解释的那样，您可以将结构按值传递给内核，因此您不必担心取消引用主机指针：

```
__global__ void kernel(mystruct in)
{
  int idx = threadIdx.x + blockIdx.x * blockDim.x;
  in.dev1[idx] *= 2;
  in.dev2[idx] += 3.14159;
} 
```

要注意按值传递结构的开销。但是，如果您的结构不是太大，那应该没关系。

如果您将相同的结构传递给许多内核，或者重复传递，您可以考虑将结构本身复制到全局或常量内存，而不是按照 aland 的建议，或者按照 Mark Ebersole 的建议使用映射的主机内存。但是按值传递结构是一种更简单的入门方法。

（注意：重复问题前请搜索 StackOverflow...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:08:49.977

您可以将`mystruct`结构复制到全局内存并将其设备地址传递给内核。

然而，从性能的角度来看，存储在常量内存中会更好`mystruct`，因为（我猜）有很多线程从中随机读取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T21:04:45.623

如果您的设置支持，您还可以使用页面锁定（固定）主机内存并在该区域内创建结构。请参阅[CUDA 编程指南](http://developer.download.nvidia.com/compute/DevZone/docs/html/C/doc/CUDA_C_Programming_Guide.pdf)的 3.2.4 。

# java - 在 Java 中的 HashMap 的 ArrayList 中将元素添加到 HashMap

> ID：12394643
> 
> 赞同：0
> 
> 时间：2012-09-12T19:03:22.407
> 
> 标签：java, arraylist, hashmap

我在 Java 中有一个源 HashMap：

```
HashMap<String, Integer> keyWordFrequencies; 
```

存储各种长度的关键字。我想遍历这个 HashMap 并计算出存储在映射的 String 部分中的 ngram 的长度，该部分定义了每个关键字的文本。

使用这些数据，我想填充 HashMaps 的目标 ArrayList：

```
ArrayList<HashMap<String, Integer>> keywordNgrams; 
```

有了结果，ArrayList 的索引对应于给定关键字的 ngram 大小减一，即 keywordNGrams(0) 将接收 unigram，keywordNGrams(1) 将接收 bigram，依此类推。但我不确定必要的语法。遍历源 HashMap 很容易：

```
Set keyWordFrequenciesSet = keyWordFrequencies.entrySet();
Iterator keyWordFrequenciesIterator = keyWordFrequenciesSet.iterator();
while(keyWordFrequenciesIterator.hasNext()) {
   Map.Entry m = (Map.Entry) keyWordFrequenciesIteratorIterator.next();
   int ngramLength = String_Utils.getLengthOfNgram(m.getKey().toString());

   Add element to keywordNgrams? 
```

但是将元素添加到 HashMap 的目标 ArrayList 让我感到困惑。我试过了：

```
keywordNgrams.add(ngramLength, m); 
```

和各种替代方案，但无济于事。m 应该是 HashMap 的一个元素，而不是 HashMap 本身。谁能建议我错在哪里？

理想情况下，我想遍历一次源 HashMap keyWordFrequencies，然后将keywordNgrams ArrayList 初始化为最大可能的ngram 大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:13:59.240

由于您正在处理大小为 5 的 ArrayList，因此我建议您在初始化 ArrayList 时，通过在每个索引处添加一个新的 HashMap 实例来执行此操作。像这样的东西：

```
ArrayList<HashMap<String, Integer>> keywordNgrams = new ArrayList<HashMap<String, Integer>> ();

for(int index = 0; index < 5; index++){
  keywordNgrams .put(index, new HashMap<String, Integer>());
} 
```

为了在 ArrayList 中添加元素，您需要执行以下操作：

*   访问指定 'n'-gram 的特定 HashMap。这可以[`get(int index)`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#get%28int%29)在 ArrayList 上使用
*   然后，您将添加您返回的 HashMap 的元素，然后再次对您的*关键字 Ngrams* ArrayList[`set(int index, E element)`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#set%28int,%20E%29)执行相同的 HashMap 。

 *示例代码可能是这样的：

```
HashMap<String, Integer> returnedMap = keywordNgrams.get(index); //where index is the position in the list;
returnedMap.put(key, value); //where key & value is the information that you would want to add to your HashMap
keywordNgrams.set(index, returnedMap); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:15:34.877

由于您知道最大的 ngram-size，我建议预先填充`keywordNgrams`：

```
List<Map<String, Integer>> keywordNgrams =
    new ArrayList<Map<String, Integer>>();
for(int i = 0; i < 5; ++i)
    keywordNgrams.add(new HashMap<String, Integer>()); 
```

然后你可以写：

```
for(final String keyword : keyWordFrequencies.keySet())
    keywordNgrams.get(String_Utils.getLengthOfNgram(keyword) - 1)
            .put(keyword, keyWordFrequencies.get(keyword)); 
```*

# java - ear 部署失败 - 无法解析引用远程 ejb-ref

> ID：12394649
> 
> 赞同：4
> 
> 时间：2012-09-12T19:03:38.803
> 
> 标签：java, glassfish, ejb, ear

我有以下**耳朵**：

```
dao.jar                  EJB-JAR    (has a dependency on entities.jar)
web.war                  JSF-WAR    (hello world jsf demo - no un-jsf dependencies)
/lib/entities.jar        POJO-JAR   (contains persistence.xml & entity classes) 
```

我在**Glassfish 3.1.2上部署它**

当我尝试同时在 EAR 中打包两者时，出现以下**部署错误**：

```
 SEVERE: Exception while deploying the app [web-league-table-ear] : 
        Cannot resolve reference Remote ejb-ref 
        name=org.eclipse.persistence.jpa.rs.Service/persistenceFactory,
        Remote 3.x interface =org.eclipse.persistence.jpa.rs.PersistenceFactory,
    ejb-link=null,lookup=,mappedName=,jndi-name=,refType=Session 
    because there are 2 ejbs in the application with interface org.eclipse.persistence.jpa.rs.PersistenceFactory. 

    Some of the possible causes: 

        1\. The EJB bean class was packaged in an ear lib library (or through any other 
        library mechanism which makes the library visible to all component modules), 
        this makes all the component modules include this bean class indirectly. 

        2\. The EJB bean class was packaged in a component module which references the
         EJB, either directly or indirectly through Manifest, WEB-INF/lib. 

        The EJB bean class should only be packaged in the declaring ejb module and 
not the referencing modules. The referencing modules should only 
include EJB interfaces. 
```

EAR 在以下情况下正确部署：

> 无论是道坛**还是**战争都被省略了。

IE

> 如果我删除 EAR 部署的战争，DAO 中的 Tester WebServices 工作正常。
> 
> 如果我删除 EAR 部署的 dao jar 并且 JSF Hello World 启动/工作正常。

有人有什么想法吗？谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:52:53.083

也许你的 dao.jar 也被打包在你的 web.war 中（其中不应该包含它）。

# cruisecontrol.net - 获取 NAnt 并行任务中的 CCNetBuildDate

> ID：12394652
> 
> 赞同：3
> 
> 时间：2012-09-12T19:03:44.417
> 
> 标签：cruisecontrol.net, nant, cruisecontrol, ccnet-config

在巡航控制配置文件中，我使用一组并行任务来调用一些 NAnt 目标。我注意到 CC 系统参数（如 CCNetBuildDate）没有推送到 NAnt 脚本，而当我删除并行标志时它们被推送。如何将 CCNetBuildDate 信息推送到我的并行任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T15:07:50.960

当我测试这个（1.5）时，我得到了*CCNetBuildDate的**0001-01-01*。

 *在修复此错误之前，您可以在执行并行任务之前保存正确的设置。由于您无法覆盖命令行上传递的属性，因此您必须更改它们的名称或用于`<exec>`直接调用 nant：

```
 <nant>
        <buildFile>SaveCCNetParameters.build</buildFile>
     </nant>
     <parallel>
       <tasks>
         <exec>
            <executable>$(NAntExePath)</executable>
            <buildArgs>-buildfile:Build1.build @CCNetBuildParameters</buildArgs>
         </exec>
         <exec>
            <executable>$(NAntExePath)</executable>
            <buildArgs>-buildfile:Build2.build @CCNetBuildParameters</buildArgs>
         </exec>
       </tasks>
     </parallel> 
```

其中*CCNetBuildParameters*是一个类似于以下内容的文件：

```
-DCCNetBuildDate=2012-11-10
-DCCNetBuildTime=12:12:12
-DCCNetLabel=123
[...] 
```*

# javascript - Datatables with rowGrouping unable to hide columns

> ID：12394653
> 
> 赞同：4
> 
> 时间：2012-09-12T19:03:54.303
> 
> 标签：javascript, jquery, html, css, datatable

The JS:

```
$(document).ready(function() {
//  $( "#dashboard_container" ).tabs();
    $('#listings').dataTable({
                                "bRetrieve": true,
                                "aoColumns":
                                [
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                    { "bVisible": false },
                                ]
    }).rowGrouping({
            iGroupingColumnIndex: 1,
            sGroupingColumnSortDirection: "asc",
            iGroupingOrderByColumnIndex: 0,
            bExpandableGrouping: true, 
            bExpandSingleGroup: true,
            iExpandGroupOffset: -1
    });
}); 
```

The HTML:

```
 <table class="datatable" id="listings">
    <thead>
        <tr>
            <th>Group Index</th><th>Group Display Name</th>
            <th>Organization</th>
            <th>Volumes</th>
            <th>Read (MB/s)</th>
            <th>Write (MB/s)</th>
            <th>Volume Size (GB)</th>
            <th>My Cost (USD)</th>
            <th>Comments</th>
        </tr>
    </thead>
    <tfoot></tfoot>
    <tbody>
        <tr>
            <td>0</td><td><a href="/dashboard/" class="orglist_group_link">Artful Scientific</a></td>
            <td>Something Co.</td>
            <td><a href="/details/view?volume=12345678" class="orglist_link">information</a></td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>$0</td>
            <td><a class="btn small icon i_preview comment_edit_button" rel="1" title="edit or view comment">View</a></td>
        </tr>
           </tbody>
        </table>
     </div> 
```

The problem:

I am able to successfully do the row groupings and it works fine, however I have a need where I need to hide 2 of the columns to certain roles. As well as hide an additional column which would be the Equivlent of the "Organization" column which the grouping uses. However from the above JS you can see I have tried hiding all columns just to see if any would actually hide in my last ditch effort before coming here. No matter which ones all or one none will hide. Anyone know a work around for this? As I need the columns to remain but hidden to the actual view

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T12:21:54.373

hide column using this command and first parameter is index of the column and second parameter is visibilty

fnSetColumnVis( 1, false );

# mysql - 查询在冷融合上下文中返回零记录，但在 Navicat 中工作正常

> ID：12394654
> 
> 赞同：2
> 
> 时间：2012-09-12T19:03:55.447
> 
> 标签：mysql, coldfusion

我有一个在加载页面时返回零记录的查询。如果我将相同的查询（从调试输出）复制并粘贴到navicat，我会得到返回的行（如我所料）。有人见过这个吗？它发生在本地 (CF9) 和远程在我们的登台服务器 (CF10) 上。更奇怪的是，这是一个以前运行良好的查询 - 我只是在 where 子句中添加了一个 if 语句，然后突然......

这是查询：

```
 SELECT
        a.EncounterProductID,
        a.DateTime AS ServiceDate,
        aa.CartItemID,
        aaa.CartID,
        aaaaa.CartStatus,
        b.ProductID,
        b.ProductName,
        b.CPTCode,
        b.Price,
        c.EncounterID,
        c.DateTimeClosed AS EncounterClosedDate,
        d.FirstName,
        d.LastName
    FROM
        EncounterProducts a
            LEFT JOIN CartItemProduct aa ON (a.EncounterProductID = aa.EncounterProductID AND aa.Active = 1)
            LEFT JOIN CartItem aaa ON (aa.CartItemID = aaa.CartItemID)
            LEFT JOIN Cart aaaa ON (aaa.CartID = aaaa.CartID)
            LEFT JOIN CartStatus aaaaa ON (aaaa.CartStatusID = aaaaa.CartStatusID),
        Product b,
        Encounters c,
        Contacts d,
        EncounterStatuses e
    WHERE
        1 = 1
        AND (aa.CartItemID IS NULL OR aaaaa.CartStatus = 'Deleted')
        AND a.Active = 1
        AND a.ProductID = b.ProductID
        AND a.EncounterID = c.EncounterID
        AND c.PatientID = d.ContactID
        AND c.EncounterStatusID = e.EncounterStatusID
        AND e.EncounterStatus = 'Closed'
      <CFIF IsDefined("ARGUMENTS.encounter") AND IsObject(ARGUMENTS.encounter)>
             AND c.EncounterID = <CFQUERYPARAM cfsqltype="cf_sql_integer" value="#ARGUMENTS.encounter.getID()#">
     <CFELSE>
            AND c.DateTimeClosed >= <CFQUERYPARAM cfsqltype="cf_sql_date" value="#ARGUMENTS.startDate#">
            AND c.DateTimeClosed < <CFQUERYPARAM cfsqltype="cf_sql_date" value="#DateFormat(DateAdd('d', 1, ARGUMENTS.endDate), 'yyyy-mm-dd')# 00:00:00">
       </CFIF>
        AND c.LocationID = <CFQUERYPARAM cfsqltype="cf_sql_integer" value="#ARGUMENTS.locationID#">
        AND c.CustomerID = <CFQUERYPARAM cfsqltype="cf_sql_integer" value="#ARGUMENTS.customerID#">
    </CFQUERY> 
```

在我添加这些行之前，所有这些都工作得很好：

```
<CFIF IsDefined("ARGUMENTS.encounter") AND IsObject(ARGUMENTS.encounter)>
    AND c.EncounterID = <CFQUERYPARAM cfsqltype="cf_sql_integer" value="#ARGUMENTS.encounter.getID()#">
<CFELSE>
    AND c.DateTimeClosed >= <CFQUERYPARAM cfsqltype="cf_sql_date" value="#ARGUMENTS.startDate#">
    AND c.DateTimeClosed < <CFQUERYPARAM cfsqltype="cf_sql_date" value="#DateFormat(DateAdd('d', 1, ARGUMENTS.endDate), 'yyyy-mm-dd')# 00:00:00">
</CFIF> 
```

以前，它只是：

```
AND c.DateTimeClosed >= <CFQUERYPARAM cfsqltype="cf_sql_date" value="#ARGUMENTS.startDate#">
AND c.DateTimeClosed < <CFQUERYPARAM cfsqltype="cf_sql_date" value="#DateFormat(DateAdd('d', 1, ARGUMENTS.endDate), 'yyyy-mm-dd')# 00:00:00"> 
```

没有 IF/ELSE 语句。

以前有人见过这样的事情吗？有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:59:57.197

我看到你的问题有两个不同的部分。

**第 1 部分**你说：

> 这是一个以前运行良好的查询 - 我只是在 where 子句中添加了一个 if 语句，然后突然......

显然，这使我相信您的新 if 条件是查询不再返回之前返回的结果的罪魁祸首。

该查询正在使用：

```
AND c.DateTimeClosed >= <CFQUERYPARAM cfsqltype="cf_sql_date" value="#ARGUMENTS.startDate#">
AND c.DateTimeClosed < <CFQUERYPARAM cfsqltype="cf_sql_date" value="#DateFormat(DateAdd('d', 1, ARGUMENTS.endDate), 'yyyy-mm-dd')# 00:00:00"> 
```

所以现在我假设它正在传递你的新 if 条件，而不是代码正在运行它，它没有返回结果：

```
AND c.EncounterID = <CFQUERYPARAM cfsqltype="cf_sql_integer" value="#ARGUMENTS.encounter.getID()#"> 
```

#ARGUMENTS.encounter.getID()# 是否返回您期望的结果？Encounters 表是否实际上包含具有该遭遇 ID 的记录？

**第 2 部分**你说：

> 如果我将相同的查询（从调试输出）复制并粘贴到navicat，我会得到返回的行（如我所料）。

我怀疑你不能直接复制和粘贴调试输出并让它在没有修改的情况下工作。您必须至少输入参数化输入的值。那么当你从navicat 运行查询时，你输入了什么值呢？ColdFusion 运行时生成的值是否相同？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:20:29.877

尝试替换这个：

```
#DateFormat(DateAdd('d', 1, ARGUMENTS.endDate), 'yyyy-mm-dd')# 00:00:00 
```

有了这个：

```
#createODBCDateTime(DateAdd('d', 1, ARGUMENTS.endDate))# 
```

# javascript - 你如何强制一个词改变大小写等以可能使用 jquery 来保留品牌？

> ID：12394664
> 
> 赞同：1
> 
> 时间：2012-09-12T19:04:43.170
> 
> 标签：javascript, jquery, branding

假设您是 Apple……并且在整个站点范围内，您都希望 iPod 的每个实例始终保持适当的外壳和结构以保留品牌。我对一家根本不是苹果但面临相同品牌挑战的公司也有类似的问题。

因此，即使有人在运行该站点的 CMS 中键入 IPOD 或 ipod 或 iPod，它也会始终正确显示为 iPod

即使标题上的文本转换 CSS 使所有内容都像IPOD ETC ETC 一样大写，它也会强制i 小写为iPOD ETC ETC。

即使有复数或变体，如 ipods、IPODAGE、iPoDdInG... 并且它的任何混蛋都会转换为适当的大小写 - iPods、iPodage、iPodding

我已经对在 jsfiddle 上找到的以下脚本进行了一些试验，但我运气不佳，尽管我通常对 js 相当陌生。

[http://jsfiddle.net/x9BSn/2/](http://jsfiddle.net/x9BSn/2/)

我已经为站点中的许多其他内容引入了 jquery，因此我可以很好地使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:19:27.720

这是（我相信）一个工作版本：http: [//jsfiddle.net/x9BSn/11/](http://jsfiddle.net/x9BSn/11/)

```
$.fn.changeWord = function (str, className) {
    var regStr = str + "(?=(?:[^\>]|\<[^\<]*\>)*$)";
    var regex = new RegExp(regStr, "gi");
    var txt = this.html();
    txt = txt.replace(regex, function(matched) {
            return "<span class='" + className + "'>" + str+ "</span>";
    });
    this.html(txt);
};

$('#myDiv').changeWord('specialWord', 'sw'); 
```

它将所有`str`未包含在标记 ( `< ... >`)中的 (case invariant) 实例替换为`str`(with the desired case)。

因此，如果您希望它是“SpecialWorD”，您可以通过以下方式实现：

```
$('#myDiv').changeWord('SpEcialWorD', 'sw'); 
```

如此处所示：http: [//jsfiddle.net/x9BSn/13/](http://jsfiddle.net/x9BSn/13/)

然后，您可以使用一些像这样的 css 添加到该内容：

```
.sw:after{
    content: "TM";
    vertical-align:super;
    font-size:.5em;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:56:46.430

只是稍微修改`Shmiddty`了一下解决方案

```
$.fn.changeWord = function (str, className) {
    var regex = new RegExp(str, "gi");
    return this.each(function () {
        this.innerHTML = this.innerHTML.replace(new RegExp('(' + str+ '(?=(?:[^\>]|\<[^\<]*\>)*$))', 'gi'), "<span class='"+className+"'>$1</span>");
    });
};

$('#myDiv').changeWord('specialWord', 'sw'); 
```

[​演示](http://jsfiddle.net/x9BSn/16/)

# python - 从使用类型函数创建的实例调用基类方法

> ID：12394669
> 
> 赞同：0
> 
> 时间：2012-09-12T19:05:19.283
> 
> 标签：python, python-3.x

通常，可以从派生类调用 Python 中的基类方法，就像调用任何派生类函数一样：

```
class Base:
    def base_method(self):
        print("Base method")

class Foo(Base):
    def __init__(self):
        pass

f = Foo()
f.base_method() 
```

但是，当我使用该函数动态创建一个类时`type`，我无法在不传入`self`实例的情况下调用基类方法：

```
class Base:
    def base_method(self):
        print("Base method")

f = type("Foo", (Base, object), { "abc" : "def" })
f.base_method() # Fails 
```

这会引发 TypeError：`TypeError: base_method() takes exactly 1 argument (0 given)`

如果我显式传递一个`self`参数，它会起作用：

```
f.base_method(f) 
```

为什么`self`调用基类方法时需要显式传递实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:09:35.357

您的行`f = type(...)`返回一个类，而不是一个实例。

如果你这样做`f().base_method()`，它应该工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:10:02.347

`type`返回一个类而不是一个实例。您应该在调用之前实例化该类`base_method`：

```
>>> class Base(object):
...     def base_method(self): print 'a'
... 
>>> f = type('Foo', (Base,), {'arg': 'abc'})
>>> f.base_method()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unbound method base_method() must be called with Foo instance as first argument (got nothing instead)
>>> f().base_method()
a 
```

# objective-c - Objective-C中的字符串搜索

> ID：12394676
> 
> 赞同：0
> 
> 时间：2012-09-12T19:05:34.230
> 
> 标签：objective-c, string, parsing, nsstring

给定这样的字符串：

```
http://files.domain.com/8aa55fc4-3015-400e-80f5-390997b43cf9/c07cb0d2-b7d7-4bfd-b0c3-6f43571e3c29-MyFile.jpg 
```

我只需要找到字符串“MyFile”，并告诉它是什么类型的图像（.jpg 或 .png）。我怎样才能做到这一点？

我唯一能想到的就是向后搜索前四个字符以获得文件扩展名，然后继续向后搜索直到找到第一个连字符，并假设文件名本身没有任何连字符。但我不知道该怎么做。有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:26:32.143

用于[`NSRegularExpression`](http://developer.apple.com/library/mac/documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)搜索文件名。搜索模式实际上取决于您对文件名的了解。如果 MyFile 之前的“随机”数字和字符具有已知格式，您可以将其考虑在内。我在下面的建议假设文件名不包含任何减号。

```
NSRegularExpression *regex = [NSRegularExpression 
                     regularExpressionWithPattern:@"-([:alnum:]*)\\.(jpg|png)$"
                                          options:NSRegularExpressionSearch
                                            error:nil];
// Get the match between the first brackets.
NSTextCheckingResult *match = [regex firstMatchInString:string options:0 
                                         range:NSMakeRange(0, [string length])];
NSRange matchRange = [match rangeAtIndex:1];
NSString *fileName = [string substringWithRange:matchRange];
NSLog(@"Filename: %@", fileName);

// Get the extension with a simple NSString method.
NSString *extension = [string pathExtension];
NSLog(@"Extension: %@", extension); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:21:33.133

`[myString lastPathComponent]`将获得文件名。 `[myString pathExtension]`将获得扩展名。

要获得文件名的后缀，我认为您必须滚动自己的解析。它总是在最后一个破折号之后和扩展之前的字符串吗？

如果是这样，这里有一个想法：

```
- (NSString *)lastLittleBitOfTheFilenameFrom:(NSString *)filename {

    NSInteger fnStart = [filename rangeOfString:@"-" options:NSBackwardsSearch].location + 1;
    NSInteger fnEnd = [filename rangeOfString:@"." options:NSBackwardsSearch].location;

    // might need some error checks here depending on what you expect in the original url
    NSInteger length = fnEnd - fnStart;

    return [filename substringWithRange:NSMakeRange(fnStart, length)];
} 
```

或者，感谢@Chuck ...

```
// even more sensitive to unexpected input, but nice and tiny ...

- (NSString *)lastLittleBitOfTheFilenameFrom:(NSString *)filename {
    NSString *nameExt = [[filename componentsSeparatedByString:@"-"] lastObject];
    return [[nameExt componentsSeparatedByString:@"."] objectAtIndex:0];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:22:00.227

如果您在 NSString 对象中有字符串，或者从该字符串创建它，您可以使用 rangeOfString 方法来完成两者。

有关更多详细信息，请参阅[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)。

# linux - 使用用户界面的 Drupal 7 模块更新失败并出现 500 服务器错误

> ID：12394679
> 
> 赞同：1
> 
> 时间：2012-09-12T19:05:46.150
> 
> 标签：linux, drupal, drupal-7, drupal-modules

我有一个正在测试的 Drupal 7.15 站点，当我配置所有内容时，我可以通过 Web 管理界面使用模块更新程序/安装程序，没有任何问题。现在，每次尝试安装或更新模块（通过链接或直接上传）时，我似乎都会获得 500 ISE。

我在系统日志或 apache 的错误日志中看不到任何有用的信息。

我可以看到，当我提供 URL 或文件时，Drupal 服务器会抓取它，并将其放入 /tmp/update-cache/ 中（我已将 Drupal 配置为在文件系统-> 临时目录中使用 /tmp） , 并将 tar.gz 提取到 /tmp/update-extraction/

这些文件永远不会移动到站点/所有/模块。权限是

> drwxrwxr-x 27 apache webeditors 4096 Sep 12 09:43 模块

apache 是 webeditors 的成员。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T23:47:19.340

Propably you need to increase thr PHP Memory The quick way:

add `ini_set('memory_limit','256M');` to your settings.php

Universal way: edit this limit in your php.ini. by finding

> php_value memory_limit 32M and changing to appropriate limit

To find php.ini location run a `phpinfo();`

# sql - SQL 按需缓存表（可能使用 SQL MERGE）

> ID：12394682
> 
> 赞同：2
> 
> 时间：2012-09-12T19:05:54.807
> 
> 标签：sql, caching, sql-merge

`SQL`我正在为应用程序实现按需缓存表，所以我有

`CacheTable`带柱子`Type, Number, Value`

然后我有一个函数叫做`GetValue( Type, Number )`

所以我想要一个执行以下操作的函数

If ( `CacheTable`contains Type, Number) 然后返回值 Else 调用`GetValue( Type, Number)`并将该值放入`CacheTable`并返回该值

有谁知道最优雅的方式来做到这一点？

我正在考虑使用`SQL merge.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:44:51.490

不确定一个人能变得多么优雅，但我们可能会按照您描述的方式来做。查询数据库

```
select Value from Tab1 where Type=@type and Number=@num 
```

如果没有返回行，则计算该值，然后将其存储在数据库中以供下次使用。但是，如果“计算值”需要数据库本身，并且我们可以在数据库中计算它，那么我们可以用一次数据库往返来完成整个循环——也许更“优雅”但至少比 3 次往返更快（查找、计算、存储）。

```
declare @val int
select @val=Value from Tab1 where Type=@type and Number=@num
if @@ROWCOUNT=0 BEGIN
  exec compute_val @type,@num,@val OUTPUT
  insert into Tab1 values (@type,@num,@val)
END
SELECT @val[Value]--return 
```

SQL Merge 的唯一用途是，如果您认为可能有并发用户，并且在上面的 select 和 insert 之间插入了数字，则在插入时会出错。我只是抓住错误并跳过插入（因为我们可以假设值不会根据定义不同）。

# android - Android - getIdentifier 始终返回 0（库 + 应用程序）

> ID：12394688
> 
> 赞同：18
> 
> 时间：2012-09-12T19:06:31.783
> 
> 标签：android, resources

我有使用 Android 库 (com.appocaliptic.quizknife.core) 的 Android 项目 (com.appocaliptic.quizknife.app)。

我想要做的是获取图片的资源ID，即图书馆。图片的路径是：*res/drawable-xhdpi/fr_200_133.png*

但是，所有尝试都使用 getIdentifier 结果为 0。问题出在哪里？

```
resId = getResources().getIdentifier("fr_200_133", "drawable", "com.appocaliptic.quizknife.core");
resId = getResources().getIdentifier("com.appocaliptic.quizknife.core:drawable/"+"fr_200_133", null, null);
resId = getResources().getIdentifier("drawable/fr_200_133", null, "com.appocaliptic.quizknife.core"); 
```

编辑：

啊，在 R.java 中有可绘制和对应的属性。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-07T09:08:46.087

我遇到了同样的问题：**“getIdentifier result 0”**，我通过删除图像扩展名（*.jpg、*.jpeg、...等）以匹配**R.java**文件中的名称来解决它

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-09-12T20:23:18.920

您不应该使用库包名称。试试这个：

```
resId = getResources().getIdentifier("fr_200_133", "drawable", getPackageName()); 
```

（或者`getContext().getPackageName()`如果这是在视图中执行）。

关键是您需要使用应用程序的包名（如清单中所列）而不是库的包名（在创建应用程序时实际上会消失）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-12-12T05:56:08.500

我遇到了同样的错误，唯一有效的方法是以不同的方式解决它：

```
resourceId = R.drawable.class.getField("fr_200_133").getInt(null); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-08-05T13:10:42.507

我有一个类似的问题。我可以像 Hussam Otri 提到的那样解决它。例如：

```
//This doesn't work
context.getResources().getIdentifier("audio_1.mp3", "raw", this.getPackageName()); 

//This works (strip off the file extension)
context.getResources().getIdentifier("audio_1", "raw", this.getPackageName()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-24T10:42:23.577

图像的名称是下划线（下划线）或“_”，结果没问题，因为编译器将照片的名称重命名为示例：源：“img0001”在编译“imag_0001”后。

# java - Play 2 Framework 下拉列表给出空点异常

> ID：12394692
> 
> 赞同：0
> 
> 时间：2012-09-12T19:06:49.760
> 
> 标签：java, playframework, playframework-2.0, ebean

我正在使用带有 java 和 ebean 的 play 2 框架进行数据管理。我的下拉列表有问题。下拉列表中填充了来自 mySQL 数据库的数据。它正在工作，但看起来我不小心改变了一些东西，现在当我尝试渲染页面时它给了我一个空指针异常。我正在尝试解决问题，但看起来无法解决问题。我在下面提供代码片段。

这是填充下拉列表的代码：

```
public static Result gestureNames()
  {
  List <GestureClassEntity> gcet = GestureClassEntity.find.orderBy("name asc").findList();
  return ok(views.html.train.render(gcet)); 
} 
```

这是该方法的路由配置：

```
GET    /name                        controllers.Application.gestureNames() 
```

这是更新路由文件：

```
# Home page
GET     /                           controllers.Application.index()
GET     /socket                     controllers.Application.webSocket()
GET     /cobject                    controllers.Application.classifyObject()
GET    /classify                    controllers.Application.classify()
GET    /name                        controllers.Application.gestureNames()
GET    /train                       controllers.Application.train()
GET    /tclassifier                 controllers.Application.trainClassifier() 
```

这些是火车和手势名称方法

```
public static Result train()
  {   
      return ok(train.render(null));
  }

  public static Result gestureNames()
  {
  List <GestureClassEntity> gcet = GestureClassEntity.find.orderBy("name asc").findList();
  return ok(views.html.train.render(gcet)); 
} 
```

这是 scala.html 文件中的参数定义

```
@( gestureList: List[GestureClassEntity]) 
```

这是下拉列表的代码：

```
<select class = "selectone">
  @for(gesture <- gestureList){
      <option value = @gesture.id>
        @gesture.getName()
      </option>
  } 
  </select> 
```

运行 scala.html 文件时出现空点异常。

这是堆栈跟踪：

```
[error] application -

! @6bjof8n9g - Internal server error, for request [GET /train] ->

play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NullPo
interException: null]]
        at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [
play_2.9.1.jar:2.0.2]
        at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [
play_2.9.1.jar:2.0.2]
        at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2]
        at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.
2]
        at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.
2]
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.j
ar:2.0.2]
Caused by: java.lang.NullPointerException: null
        at scala.collection.JavaConversions$JListWrapper.iterator(JavaConversion
s.scala:618) ~[scala-library.jar:0.11.3]
        at scala.collection.IterableLike$class.foreach(IterableLike.scala:73) ~[
scala-library.jar:0.11.3]
        at scala.collection.JavaConversions$JListWrapper.foreach(JavaConversions
.scala:615) ~[scala-library.jar:0.11.3]
        at scala.collection.TraversableLike$class.map(TraversableLike.scala:194)
 ~[scala-library.jar:0.11.3]
        at scala.collection.JavaConversions$JListWrapper.map(JavaConversions.sca
la:615) ~[scala-library.jar:0.11.3]
        at views.html.train$.apply(train.template.scala:50) ~[classes/:na] 
```

谁能帮我解决这个问题，因为我必须将项目作为作业提交，而且我迟到了。

谢谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T13:38:07.083

问题来自`/train`Url 的调用，因为它被映射到`train()`调用模板的方法，其中列表`GestureClassEntity`为空：

```
GET    /train                       controllers.Application.train() 
```

然后它调用：

```
public static Result train()
  {   
      return ok(train.render(null)); // <- here is the problem
  } 
```

# javascript - 如何使用节点和 .createElement("b") 使文本变为粗体？

> ID：12394694
> 
> 赞同：3
> 
> 时间：2012-09-12T19:06:55.693
> 
> 标签：javascript, nodes

如果我使用节点和 createElement 单击按钮，我必须将文本加粗，但我真的不知道如何......

html（这是我要加粗的文本）：

```
<p id="textalt">Dies ist ein Text in einem P-Tag</p> 
```

javascript:

```
function fettmachen(){
var neuB = document.createElement("b");
document.getElementById("textneu").insertBefore(neuB,  document.getElementById("textneu").nextSibling);
} 
```

我不知道它是如何工作的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:13:54.183

> ***“我必须用节点和 createElement 来做”***

```
function fettmachen(){
       // create the "b" element
    var neuB = document.createElement("b");

       // fetch the "textneu" element by ID
    var textneu = document.getElementById("textneu");

       // append the firstChild of "nextneu" to the "neuB"
    neuB.appendChild(textneu.firstChild);

       // append the "neuB" to the "nextneu"
    nextneu.appendChild(neuB);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T19:14:46.183

我建议，不要添加新标签，而是使用 CSS，并为元素添加一个类。

CSS：

```
.boldText{
    font-weight: bold;
} 
```

JavaScript：

```
function fettmachen(){
    document.getElementById("textalt").className += ' boldText';
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-12T19:12:43.547

我只是`<p>`在按钮按下的标签上放一个样式。也许像...

```
function fettmachen(){
var neuB = document.getElementById("textalt");
neuB.style.fontWeight = "bold";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:14:47.840

这就是使文本变粗的方式

```
function fettmachen(){
 var p = document.getElementById("textneu");
 p.style.fontWeight = "bold;"
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:17:50.437

如果您出于某种原因*必须*使用 js，例如，您可能只需要加粗某些单词，并且无法访问此处的样式表。否则使用 Rocket 的建议。

如果在某些时候您只需要加粗某些单词或元素中的单词组，请认真使用这样的解决方案。

```
function fettmachen(){
    var neuB = document.createElement("b"),
        textEl = document.getElementById("textalt"),
        text = textEl.textContent;

    neuB.textContent = text;
    textEl.textContent = "";
    textEl.appendChild(neuB);
} 
```

**[现场演示](http://jsfiddle.net/loktar/9ntjV/)**

并大胆。

```
function unbold(){
    var textEl = document.getElementById("textalt"),
        boldEls = textEl.getElementsByTagName("b"),
        text = "";

    for(var i = 0; i < boldEls.length; i++){
        text+=boldEls[i].textContent;
        textEl.removeChild(boldEls[i]);
    }

    textEl.textContent = text;
} 
```

**[现场演示 2](http://jsfiddle.net/loktar/H5aaR/)**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T19:12:30.817

好吧，您可以使用以下代码。它更长，可以精简——我个人觉得读起来更清楚。

```
function fettmachen()
{
    var pElem = document.getElementById('textAlt');
    var text = pElem.innerHTML;

    var bElem = document.createElement('b');
    bElem.innerHTML = text;

    pElem.innerHTML = '';
    pElem.appendChild(bElem);
} 
```

# html - 在 Yii 中使用多种布局

> ID：12394695
> 
> 赞同：1
> 
> 时间：2012-09-12T19:07:02.827
> 
> 标签：html, tabs, yii

我的 Yii 应用程序有一个名为“编辑个人资料”的特定部分。这是一个相当大的数据部分，因为从 db 中提取了大量数据。

但是问题是我在本节中有标签分页。因为只有这部分使用网站上的选项卡，所以我没有在主布局标题中包含相关的 CSS/Javascript 文件。这些已在视图文件本身中引用。因此，选项卡需要时间才能显示，并且选项卡标题首先显示为列表（一两秒），然后分配到具有正确 UI 的选项卡中。这当然是不可接受的行为。有什么方法可以选择性地将相关的 js/css 文件包含到这个特定视图的标题标签中，或者我应该将它包含在主布局文件中，即使它不会在网站上的许多其他地方使用，因此可能会减慢其他页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:21:18.457

只需指定文件的位置。

在您的视图中，您包含 js 或 css ：

```
// for js
Yii::app()->clientScript->registerScriptFile('url_of_file',CClientScript::POS_HEAD);

// for css
Yii::app()->clientScript->registerCssFile('url_of_file'); 
```

推荐文档：[`registerScriptFile()`](http://www.yiiframework.com/doc/api/1.1/CClientScript#registerScriptFile-detail "http://www.yiiframework.com/doc/api/1.1/CClientScript#registerScriptFile-detail")和[`registerCssFile()`](http://www.yiiframework.com/doc/api/1.1/CClientScript#registerCssFile-detail "http://www.yiiframework.com/doc/api/1.1/CClientScript#registerCssFile-detail")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T07:43:03.597

您可以在 layouts 文件夹中创建自己的布局，您可以在其中包含所有必需的 jquery 脚本和 css。然后你可以在控制器中调用你的布局。

```
public function actionDoSomething(){
$this->layout = 'mylayout';
$this->render('myview');
} 
```

# javascript - 如何通过自身获取有关 Chrome 扩展程序的用户反馈/错误报告？

> ID：12394696
> 
> 赞同：2
> 
> 时间：2012-09-12T19:07:07.543
> 
> 标签：javascript, jquery, google-chrome-extension

我创建了一个简单的 Chrome 扩展程序，但除了使用该`mailto`功能之外，用户联系我并不容易。我也无法访问可以向其发送 AJAX 调用的服务器。在最坏的情况下，我将让扩展程序创建一个 PasteBin，[通过其](http://pastebin.com/api)错误字符串的 API 并将其通过`mailto`电子邮件发送给我，但这不是很安全*或*优雅。

有没有办法可以在 jQuery 或 HTML 中轻松创建某种“提交错误”功能？不知何故，类似`Chrome.SendFeedback()`或`Chrome.SubmitErrorLog()`直接发送给我的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:39:22.603

从用户那里获得反馈的最简单、最快捷的方法可能是将谷歌文档表单嵌入到页面的 iframe 中。您可以将它插入到您将构建自定义表单以提交给 API 的位置。

[http://www.youtube.com/watch?v=IzgaUOW6GIs](http://www.youtube.com/watch?v=IzgaUOW6GIs)

[http://www.google.com/google-ds/forms/](http://www.google.com/google-d-s/forms/)

# php - 我可以在 jQuery 数组中回显 php 吗？

> ID：12394697
> 
> 赞同：0
> 
> 时间：2012-09-12T19:07:08.587
> 
> 标签：php, jquery, arrays, wordpress

我正在做一个项目，我似乎无法找到处理这个问题的最佳方法。我正在使用 jQuery Supersized 和选项框架来构建主题。除了图像之外，我拥有所有适用于滑块选项的东西。这是我的脚本

```
<script type="text/javascript">
    jQuery(function ($) {
        $.supersized({
            // Functionality
            slideshow: 1, // Slideshow on/off
            autoplay: <? php echo of_get_option('autoplay', '1'); ?> , // Slideshow starts playing automatically
            start_slide: 1, // Start slide (0 is random)
            stop_loop: 0, // Pauses slideshow on last slide
            random: <? php echo of_get_option('random', '0'); ?> , // Randomize slide order (Ignores start slide)
            slide_interval: <? php echo of_get_option('slide_interval', '3000'); ?> , // Length between transitions
            transition: <? php echo of_get_option('transitions', '1'); ?> , // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
            transition_speed: 1000, // Speed of transition
            new_window: 1, // Image links open in new window/tab
            pause_hover: 0, // Pause slideshow on hover
            keyboard_nav: 1, // Keyboard navigation on/off
            performance: 1, // 0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed // (Only works for Firefox/IE, not Webkit)
            image_protect: <? php echo of_get_option('protect_images', '1'); ?> , // Disables image dragging and right click with Javascript

            // Size & Position                         
            min_width: 0, // Min width allowed (in pixels)
            min_height: 0, // Min height allowed (in pixels)
            vertical_center: 1, // Vertically center background
            horizontal_center: <? php echo of_get_option('horizontal_center', '1'); ?> , // Horizontally center background
            fit_always: <? php echo of_get_option('always_fit', '0'); ?> , // Image will never exceed browser width or height (Ignores min. dimensions)
            fit_portrait: 1, // Portrait images will not exceed browser height
            fit_landscape: 0, // Landscape images will not exceed browser width

            // Components                           
            slide_links: 'blank', // Individual links for each slide (Options: false, 'num', 'name', 'blank')
            thumb_links: 1, // Individual thumb links for each slide
            thumbnail_navigation: 0, // Thumbnail navigation
            slides: [ // Slideshow Images
            {
                image: '<?php echo of_get_option("image_1"); ?>'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/kazvan-2.jpg',
                title: 'Image Credit: Maria Kazvan',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/kazvan-2.jpg',
                url: 'http://www.nonsensesociety.com/2011/04/maria-kazvan/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/kazvan-3.jpg',
                title: 'Image Credit: Maria Kazvan',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/kazvan-3.jpg',
                url: 'http://www.nonsensesociety.com/2011/04/maria-kazvan/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/wojno-1.jpg',
                title: 'Image Credit: Colin Wojno',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/wojno-1.jpg',
                url: 'http://www.nonsensesociety.com/2011/03/colin/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/wojno-2.jpg',
                title: 'Image Credit: Colin Wojno',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/wojno-2.jpg',
                url: 'http://www.nonsensesociety.com/2011/03/colin/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/wojno-3.jpg',
                title: 'Image Credit: Colin Wojno',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/wojno-3.jpg',
                url: 'http://www.nonsensesociety.com/2011/03/colin/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/shaden-1.jpg',
                title: 'Image Credit: Brooke Shaden',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/shaden-1.jpg',
                url: 'http://www.nonsensesociety.com/2011/06/brooke-shaden/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/shaden-2.jpg',
                title: 'Image Credit: Brooke Shaden',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/shaden-2.jpg',
                url: 'http://www.nonsensesociety.com/2011/06/brooke-shaden/'
            }, {
                image: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/shaden-3.jpg',
                title: 'Image Credit: Brooke Shaden',
                thumb: 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/shaden-3.jpg',
                url: 'http://www.nonsensesociety.com/2011/06/brooke-shaden/'
            }],

            // Theme Options               
            progress_bar: 1, // Timer for each slide                            
            mouse_scrub: 0
        });
    });
</script> 
```

我的所有设置都可以正常工作，但图像除外。有趣的是，当我查看源代码时，它会显示指向图像的链接，就像手动输入的链接一样。我试图将数据放入数组中，然后动态显示输出，但仍然不行。我在源代码中得到了相同的结果。`{image :'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/thumbs/kazvan-1.jpg'},`

为什么它不会从回声中加载图像，但它表明它在源中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:41:48.133

做这件事要非常非常非常小心。您直接输出到 Javascript 代码块，这意味着您的**所有**输出都必须创建语法上有效的 JS 代码。一个错误放置`'`可以杀死整个脚本块。

为了安全起见，您应该通过 json _encode() 进行所有输出，这可以保证您不会引入语法错误。

例如

```
random: <?php echo json_encode(of_get_option('random', '0')); ?> , // Randomize slide order (Ignores start slide) 
```

考虑这样的情况：

```
<?php
$name = "Miles O'Brien";
?>

<script type="text/javascript">
var name = '<?php echo $name; ';
</script> 
```

你最终会产生：

```
var name = 'Miles O'Brien';
                   ^--- syntax error, terminating the string early. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:32:32.320

我建议用清晰的 php 代码创建 json，然后将该 json 包含到 javascript 表达式中。

代码会更好。

你犯错的机会更少（例如用引号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:10:22.597

您需要确保在 php 大括号的任一侧放置引号，否则 javascript 不会将其作为字符串接收。例如

```
random                  :   '<?php echo of_get_option('random', '0'); ?>' 
```

# android - android textview不改变文本

> ID：12394699
> 
> 赞同：0
> 
> 时间：2012-09-12T19:07:22.860
> 
> 标签：android

我有一个文本视图，它应该在意图（目录选择器）完成后更改文本。这不起作用。继承人的代码：

```
text = (TextView) findViewById(R.id.choose3);
        text.setText(globalconstant.path); 
```

当意图返回路径时应该更改文本：

```
private void addListenerOnButton() {
        choose_button = (Button) findViewById(R.id.button1);
        choose_button.setEnabled(true);
        choose_button.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {
                // DirectoryPicker.START_DIR = "/mnt/";
                Intent intent = new Intent(settings.this, DirectoryPicker.class);
                startActivityForResult(intent, DirectoryPicker.PICK_DIRECTORY);
                // text.setText(globalconstant.path);
                text = (TextView) findViewById(R.id.choose3);
                text.setText(globalconstant.path);
                ;

            }
        });

    } 
```

它出什么问题了？请帮我！非常感谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:09:40.770

可能，您应该更改文本`onActivityResult`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:16:13.093

首先测试你的代码是否工作，替换`text.setText(globalconstant.path);`为`text.setText("Test message");`这个工作与否。

然后，您可以添加一个`Log.d("TestAfterStartAct", "Test Message")`打开的命令行并运行`adb logcat`以显示手机中的日志。尝试注意代码何时运行，在显示新活动之前/之后/从不显示？

如果不是从 UI 线程进行编辑，有时您可能会在没有更新 GUI 部件的情况下出现错误，请要求您`text.postInvalidate()`更新 textview 的 GUI。

阅读更多关于[postInvalidate() 做什么？](https://stackoverflow.com/questions/5521596/what-does-postinvalidate-do)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-10T17:01:00.543

我有同样的问题。对我来说，问题是在调用 onActivityResult 之后调用 onStart 。在 onStart 中，我使用默认值对正在创建新文本视图的视图进行膨胀。

在我的情况下，我通过保存 onActivityResult 中的值然后在 onStart 函数中应用这些值来解决它。
-詹姆士

# sql - 用于查询 MSSQL 的 SQL 与名/姓组合的双变位符

> ID：12394704
> 
> 赞同：0
> 
> 时间：2012-09-12T19:08:17.933
> 
> 标签：sql, tsql, metaphone

我正在使用 Double-Metaphone 在我的数据库中进行模糊搜索。我有一个姓名表，名字和姓氏都已经创建了双变位词条目（并通过触发器更新）。在我的应用程序中，我允许用户按姓氏和/或名字进行搜索。

在处理姓氏和名字时，查询数据库以从双变位索引中获得最佳结果的最佳方法是什么？仅基于姓氏进行查询很容易 - 生成 DM 标签并查询数据库。在第一个和最后一个查询时，我想进行一些微调。

数据库布局类似于以下内容：

```
tblName
  FirstName
  LastName
  MetaPhoneFN1
  MetaPhoneFN2
  MetaPhoneLN1
  MetaPhoneLN2 
```

申请：[姓] [名]

用户只输入姓氏，或姓氏+ [名字首字母，名字，名字的一部分]的组合。

```
Lastname:  SMITH
FirstName:  J or Jo or John or Johnathan 
```

如果我传入“J”作为名字 - 我想要所有匹配“J%”的名称条目。

如果我将“JO”作为名字传递 - 我想要所有匹配“JO%”的名称条目。

如果我传入“JOHN”或“JOHNATHAN”作为名字 - 我想使用 DM

或者也可能是“JOHN%”？

****对于名字，我真的很愿意接受这里的建议。我希望结果尽可能好，并返回用户想要的。****

 **查询数据库中姓氏+任何名字组合的最佳方法是什么？这是我到目前为止所获得的样本......我对结果并不完全兴奋：

```
SELECT *
FROM tblName
WHERE
--There will always be a last name
    (MetaPhoneLN1 = @paramMetaPhoneLN1
OR  (CASE WHEN @paramMetaPhoneLN2 IS NOT NULL AND MetaPhoneLN2 = @paramMetaPhoneLN2 THEN 1
          WHEN @paramMetaPhoneLN2 IS NULL THEN 0
     END) = 1)
--  Match Firstname 1
AND (CASE WHEN @paramMetaPhoneFN1 IS NULL THEN 1                      
          WHEN @paramMetaPhoneFN1 IS NOT NULL AND MetaPhoneFN1 = @paramMetaPhoneFN1 THEN 1                
          WHEN LEN(@paramMetaPhoneFN1) > 1 AND LEN(@paramMetaPhoneFN1) < 4 AND MetaPhoneFN1 LIKE @paramMetaPhoneFN1 + '%' THEN 1
          WHEN LEN(@paramMetaPhoneFN1) = 1 THEN 1                                               
      END) = 1  
--  Match Firstname 2
AND (CASE WHEN @paramMetaPhoneFN2 IS NULL THEN 1
          WHEN @paramMetaPhoneFN2 IS NOT NULL AND MetaPhoneFN2 = @paramMetaPhoneFN2 THEN 1
          WHEN LEN(@paramMetaPhoneFN2) > 1 AND LEN(@paramMetaPhoneFN2) < 4 AND MetaPhoneFN2 LIKE @paramMetaPhoneFN2 + '%' THEN 1
          WHEN LEN(@paramMetaPhoneFN2) = 1 THEN 1           
        --ELSE 0                    
      END) = 1
AND (CASE WHEN @paramFirstName IS NULL THEN 1
          WHEN  FirstName LIKE @paramFirstName + '%' THEN 1                     
        --WHEN LEN(@paramMetaPhoneFN1) = 1 AND @paramFirstName IS NOT NULL AND LEN(@paramFirstName) > 1 AND FirstName LIKE @paramFirstName + '%' THEN 1
      --ELSE 1
END) = 1 
```

我试图做的是考虑名字的不同变化。然而，我的结果并不是我想要的。

我已经能够在 SQL/C# 等中找到很多 Double Metaphone 的实现，用于 /generating/ Double-Metaphone 值，但是一旦有了这些值，就没有关于如何有效地实际查询数据库的信息。

**概括：**

当我同时按姓氏和名字搜索时——我想在数据库中查询双变位词匹配只在姓氏上，但是当名字也被传入时，我希望有很大的灵活性..第一个首字母？听上去像 ？等等。我愿意接受建议和 SQL 示例！

**更新 1：** 当我说我对结果不满意时.. 我的意思是我不确定如何制定查询的 Firstname 部分，以最大化结果。如果我搜索“WILL” - 应该返回什么结果？WILLIAM, WILL, WILBERT .. 但不是 WALKER - 虽然我在这里有什么，WALKER 会被退回，因为 WILL -> FL 和 WALKER 是 [FLKR] 但 WILLIAM 是 [FLM]。如果我只做 DM = DM，那么我什至不会返回 WILLIAM，这就是为什么我首先要做一个 LIKE，如果 DM 长度小于 4。

基本上，我想知道是否有其他人遇到过这个问题，看看其他人提出了什么解决方案。

仅第一个首字母 - 应显示以该首字母开头的所有名字 - 这是我不确定的地方：部分名称 - 所有名字都应该以部分开头吗？[你怎么知道它是否只是一个部分名称？！] 全名 - 应该使用 DM 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:59:12.087

由您决定您的业务规则关于返回什么，以及考虑使用 LIKE 与 DM（或两者）。

您似乎没有考虑过的事情是 DM 值的长度。

> 如果我搜索“WILL” - 应该返回什么结果？WILLIAM, WILL, WILBERT .. 但不是 WALKER - 虽然我在这里有什么，WALKER 会被退回，因为 WILL -> FL 和 WALKER 是 [FLKR] 但 WILLIAM 是 [FLM]。如果我只做 DM = DM，那么我什至不会返回 WILLIAM，这就是为什么我首先要做一个 LIKE，如果 DM 长度小于 4。

因此，对于这种情况：

> WILL -> FL 和 WALKER 是 [FLKR] 但 WILLIAM > IS [FLM]

假设您可以返回多个匹配，最佳匹配位于顶部，您将按存储的匹配 DM 值升序对结果进行排序。所以，WALKER 会在 WILLIAM 之前被推荐。

对于名字，再次假设您可以返回多个可能的匹配项，您可以首先返回精确字符串匹配项（非 DM），然后是精确的 DM 匹配项，然后是部分 DM 和 LIKE 匹配项，由最短的 DM 匹配项排序，然后是 LIKE 匹配，然后是其余较长的 DM 匹配。这通常最容易通过一堆 UNIONed 查询来完成。

您还可以选择根据返回的字符串长度与输入字符串长度的差异（较小的差异 = 更好的匹配）对 LIKE 匹配项进行排名。

您面临的困难是您将搜索缩写名称与发音相似的名称相结合。这两个目标有时是相互对立的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-26T16:21:03.987

只是为了给您带来另一个麻烦，;-)，Bill 也是 William 的缩写。

我对这个主题的想法是，最好将可以缩写或缩写的名称视为与语音匹配不同的问题。一旦你想出了缩写的解决方案，然后通过变音器提供结果。**

# xcode4.3 - xcode 4.3 声音不会在应用程序启动时播放

> ID：12394707
> 
> 赞同：0
> 
> 时间：2012-09-12T19:08:42.527
> 
> 标签：xcode4.3

我已经彻底浏览了这个论坛，但我还没有找到解决这个问题的方法。当我的应用程序在启动画面期间启动时，我希望播放 5 秒的声音片段，然后在应用程序完成启动并显示主屏幕时停止。

在 AppDelegate.m

```
-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
NSURL *musicFile = [NSURL fileURLWithPath:[[NSBundle mainBundle]
pathForResource:@"bknewsroom2" 
ofType:@"caf"]];

AVAudioPlayer *launchClip = [[AVAudioPlayer alloc] initWithContentsOfURL:musicFile error:nil];
[launchClip play]; 
```

现在我有一大堆东西在里面加载，`didFinishLaunchingWithOptions`这只是其中之一。声音不会在模拟器中启动，也不会在我的手机上启动。所以我错过了什么吗？同样，这是我想在应用程序首次启动时播放的 5 秒剪辑。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T18:19:00.737

我解决了这个问题：

在 AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
//------ PLAY SOUND CLIP WHILE LOADING APP -----
NSLog(@"launch banner with clip");
NSURL *clip = [[NSBundle mainBundle] URLForResource: @"soundfile" withExtension:@"caf"];
self.startupPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:clip error:NULL];
[self.startupPlayer play]; 
```

现在，当应用程序启动时，声音剪辑就会播放。它确实打嗝了一次，我正在调查，但该功能有效。`didFinishLaunchingWithOptions`另外，如果它在中间某个地方，我把它放在顶部，它会起作用。

# javascript - 用于版本控制的 JS 编译器/包管理器

> ID：12394713
> 
> 赞同：2
> 
> 时间：2012-09-12T19:09:03.433
> 
> 标签：javascript, version-control, build-automation, package-managers, gruntjs

我试图在这里掌握一些想法。并希望有人可以帮助澄清最佳实践。

团队或配对如何使用像 grunt.js 这样的 javascript 构建系统？

我真的很想把我们的大 javascript 文件分成更小的部分，现在转换为 AMD/Require 不是一个选项。

似乎最简单的方法是连接并缩小到主文件。我们正在使用版本控制（SVN）。

所以我想知道这里的最佳做法是什么？

我们是否要求与生产文件不断冲突？其他团队如何处理这个问题？

希望我的问题足够清楚。

提前致谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T17:19:25.163

我们最近在我的组织中遇到了类似的困境。由于我们拥有大量的遗留 JavaScript 代码，因此无法选择使用 AMD 或 RequireJS。

我们[最终选择了 grunt](http://mechanics.flite.com/blog/2012/06/19/why-we-use-node-dot-js-and-grunt-to-build-javascript/)并提出了一个连接和缩小的“构建”任务。然后，有一个完全独立的“部署”任务，gzip 文件并上传到 Amazon S3。

我们不会将连接/缩小的代码签入源代码控制。通常，为您的源代码设置单独的构建和部署任务是一种很好的操作实践。对于较大的开发团队，部署/构建过程传统上将在 CI 工具中完成，只要有人提交到 SVN/git，该工具就会运行。

在您的情况下，更简单的安排是，如果您只是从开发机器手动部署代码，而不是从 CI 工具自动部署代码。这种设置的问题是很容易与其他团队成员发生冲突。

也就是说，有越来越多的开源 ( [Jenkins](http://jenkins-ci.org/) ) 或云托管 ( [CircleCI](https://circleci.com/) ) 工具可能值得您研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T06:51:21.073

不要提交输出。使用像 teamcity 这样的 ci 工具来构建和部署。仅将源文件提交到源代码管理。

# javascript - 防止 mobiscroll 将时间控制包装到 Firefox 上的新行

> ID：12394714
> 
> 赞同：0
> 
> 时间：2012-09-12T19:09:05.740
> 
> 标签：javascript, jquery, firefox, mobiscroll

我正在使用 mobiscroll jQuery 库作为日期时间选择器。它在 iPad 版 Safari 和 Google Chrome 上运行良好。但是，在 PC 上的 Mozilla Firefox 上，它似乎是“换行符”。换句话说，在日期控制之后，时间控制被包裹到下一行（见下图）。我不想要这个。我希望它像其他浏览器一样集中在一条线上。知道如何用 CSS 或其他东西解决这个问题吗？TIA。

![Mobiscroll 换行](../Images/7a005c92486c747628311ff91dfb725f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:15:51.300

已使用新版本 (2.0.3) 修复。

# .net - 是否有一种通用方法可以返回从 B 到 A 的数字 C？

> ID：12394718
> 
> 赞同：0
> 
> 时间：2012-09-12T19:09:11.333
> 
> 标签：.net, math

`Prev = 10, Cur = 17, Step = 2`.

有没有一种方法可以给我`Prev + Step`（或`Prev - Step`万一`Prev > Cur`）？

**UPD：**我正在寻找这样的东西：

```
int StepDifference(int A, int B, int N)
        {
            int ret;
            if (A > B)
                if (A - N >= B)
                    ret = A - N;
                else
                    ret = B;
            else
                if (A + N <= B)
                    ret = A + N;
                else
                    ret = B;
            return ret;
        } 
```

Math 或其他命名空间中是否有“官方”方法？我会经常这样做，我认为使用自定义实现可能会更慢。几乎我尝试过的“官方”辅助方法的每个自定义实现都比较慢，这就是我要问的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:12:05.450

```
num = prev > cur ? prev - step : prev + step 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:13:10.557

```
(Cur > Prev) ? Prev + Step : Prev - Step; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:14:34.607

```
public int Calculate(int Prev, int Cur, int Step)
{
  if(Prev > Cur)
    return Prev - Step;

  return Prev + Step
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T13:21:33.080

在任何 Microsoft 命名空间中都没有这样的方法。

# google-maps-api-3 - 使用 Google Maps API v3 加载路线

> ID：12394719
> 
> 赞同：0
> 
> 时间：2012-09-12T19:09:12.620
> 
> 标签：google-maps-api-3

我刚刚开始使用 Google Maps API，并且一直在关注所有文档。目前我正在尝试使用 API 的方向服务，但似乎没有任何渲染。帮助？

这是一个包含所有文件的目录。 [http://kkohlmorgen.com/googleAPI/](http://kkohlmorgen.com/googleAPI/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:21:00.873

可能还有其他问题，但我注意到的第一件事是您试图在页面加载时声明方向服务，但在单击“加载地图”按钮之前不会加载 Google Maps API。因此，当您声明方向服务时，它会引发“谷歌未定义”错误。因此，当您稍后调用方向服务时，它是未定义的。您应该在运行任何其他与地图相关的 javascript 之前加载 Google Maps API。

# jquery - 无法让 jqueryUI datepicker 存储日期对象而不是字符串

> ID：12394724
> 
> 赞同：0
> 
> 时间：2012-09-12T19:09:38.020
> 
> 标签：jquery, jquery-ui, parsing, date, datepicker

我无法让 jqueryUI datepicker 存储日期对象，因为它的值与字符串相反。使用日期选择器的其他一切对我来说都很好，但是我提交值的表单需要一个日期对象而不是字符串值。诀窍是每次用户选择一个新日期后，存储在日期选择器中的值应该是一个日期对象。我尝试了以下方法：

```
 $('#DP2').datepicker({           
             onSelect: function() {
                $("#DP2").val($("#DP2").datepicker("getDate"));
             }
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:17:49.587

```
 $('#DP2').datepicker({           
         onSelect: function() {
            var d = new Date();
            console.log($("#DP2").datepicker('getDate'));
            d = $("#DP2").datepicker('getDate');
         }
  }); 
```

这将返回日期对象

```
 $("#DP2").datepicker('getDate'); 
```

你有这个：

```
 $("#DP2").val($("#DP2").datepicker("getDate")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:17:55.337

你试过用`$("#DP2").datepicker()`而不是`$("#DP2").datepicker("getDate")`

喜欢：

```
 $('#DP2').datepicker({           
             onSelect: function() {
                $("#DP2").val($("#DP2").datepicker());
             }
  }); ​ 
```

示例：http: [//jsfiddle.net/Egs6S/](http://jsfiddle.net/Egs6S/)

* * *

**编辑：**

## 以对象为结果的新示例。[http://jsfiddle.net/Egs6S/1/](http://jsfiddle.net/Egs6S/1/)

```
 $('#DP2').datepicker({           
             onSelect: function(event, ui) {
                console.log(ui); // This is the Object
             }
 }); 
```

祝你好运，希望对你有帮助！

# python - 实施 NTLMv2 响应

> ID：12394742
> 
> 赞同：0
> 
> 时间：2012-09-12T19:10:24.317
> 
> 标签：python, ntlmv2

我一直在尝试实现 NTLMv2 响应，但我一生都无法得到 Windows 说我应该期待的响应。

[http://msdn.microsoft.com/en-us/library/cc236700%28v=prot.10%29](http://msdn.microsoft.com/en-us/library/cc236700%28v=prot.10%29) 这是他们说我应该实现的代码，如果您找不到它们，他们会为函数提供定义，请告诉我我会把链接发给你。

[http://msdn.microsoft.com/en-us/library/cc669117%28v=prot.13%29](http://msdn.microsoft.com/en-us/library/cc669117%28v=prot.13%29) 这是我根据他们提供的定义所期望的结果。但是，每当我尝试按照描述实现此功能时，我都会收到 51f357300503a4d8344817ec6bcce8ad

这是一个哈希函数可能非常接近或完全关闭。我写了一些 python 脚本来进行他们描述的计算，如果你愿意我可以发布它，但它看起来相当简单。我尝试过以各种方式重新输入输入，但在我看来，两天的时间试图找出 Windows 如何获取此哈希就足够了。

Python 代码。希望这是stackoverflow的代码格式。

```
import hmac
import hashlib
passwd = "Password"
test = hashlib.new('md4',passwd).hexdigest()
print test
final = hmac.new(test.decode('hex'),"USERDOMAIN").hexdigest()
print final 
```

# jpa - 这些 JPA 错误消息是否存在问题？

> ID：12394744
> 
> 赞同：1
> 
> 时间：2012-09-12T19:10:29.277
> 
> 标签：jpa, derby, netbeans-platform

我在使用 JPA 和嵌入式 derby 数据库的 Netbeans 平台应用程序中看到了这个输出。如果我的数据库尚不存在，我希望在用户根目录中创建我的数据库，因此用户无需进行其他配置。有谁知道下面的异常消息或警告是否会成为问题？

```
derby.system.home=/home/simgineer/.simdriver
derby.stream.error.file=/home/simgineer/.simdriver/log/derby.log
[EL Info]: 2012-09-12 11:46:42.397--ServerSession(177592104)--file:/home/simgineer/NetBeansProjects/SimDriver/build/cluster/modules/ext/MyDbLib.jar_VmCfgLibPU login successful
Database Class Loader started - derby.database.classpath=''
[EL Warning]: 2012-09-12 11:46:42.763--ServerSession(177592104)--Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Table/View 'VMCFG' already exists in Schema 'APP'.
Error Code: 30000
Call: CREATE TABLE APP.VMCFG (ID BIGINT NOT NULL, BOOT VARCHAR(30), CDROM VARCHAR(60), CPU VARCHAR(30), ENABLEKVM SMALLINT, HDA VARCHAR(80), MACADDR VARCHAR(30), SOUNDHW VARCHAR(30), VMNAME VARCHAR(30) NOT NULL, PRIMARY KEY (ID))
Query: DataModifyQuery(sql="CREATE TABLE APP.VMCFG (ID BIGINT NOT NULL, BOOT VARCHAR(30), CDROM VARCHAR(60), CPU VARCHAR(30), ENABLEKVM SMALLINT, HDA VARCHAR(80), MACADDR VARCHAR(30), SOUNDHW VARCHAR(30), VMNAME VARCHAR(30) NOT NULL, PRIMARY KEY (ID))")
[EL Warning]: 2012-09-12 11:46:42.876--ServerSession(177592104)--Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Table/View 'SEQUENCE' already exists in Schema 'APP'.
Error Code: 30000
Call: CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT DECIMAL(15), PRIMARY KEY (SEQ_NAME))
Query: DataModifyQuery(sql="CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT DECIMAL(15), PRIMARY KEY (SEQ_NAME))") 
```

这是我的persistence.xml

```
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="VmCfgLibPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>mycompany.jpa.Vmcfg</class>
    <properties>
      <property name="javax.persistence.jdbc.url" value="jdbc:derby:myDB;create=true"/>
      <property name="javax.persistence.jdbc.password" value="app"/>
      <property name="javax.persistence.jdbc.driver" value="org.apache.derby.jdbc.EmbeddedDriver"/>
      <property name="javax.persistence.jdbc.user" value="app"/>
      <property name="eclipselink.ddl-generation" value="create-tables"/>
    </properties>
  </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:14:44.813

您得到的例外是因为您多次运行应用程序而没有删除表。[如果JPA 和 toplink create-table 尚不存在，](https://stackoverflow.com/questions/3279902/jpa-and-toplink-create-table-on-if-they-dont-already-exist)您可能想查看此问题及其答案？

# php - 如何通过 json_encode 函数合并从 mysql 接收的数组

> ID：12394746
> 
> 赞同：0
> 
> 时间：2012-09-12T19:10:47.203
> 
> 标签：php, jquery, ajax

我在这个问题上坐了很长时间，找不到解决方案：

通过在 php 文件（下面的脚本）中使用函数 json_encode，我从 mysql 接收数据作为数组组，例如`["9,8","15,14","18,17","29,40,10,9"]`，在主文件中通过使用 $.parseJSON 函数（下面的脚本），

接收一个带有索引对象的`["9,8","15,14","18,17","29,40,10,9"....]` 数组`[9,8,15,14,18,17,29,40,10,9],`

如何将所有这些对象合并在一起？

我尝试使用 $.merge 函数，但不起作用。帮助？？；-)

```
/////receive.php file//////
$ask = mysql_query("SELECT numbers FROM bying");
if(!ask)
{
    die('incorrect ask'.mysql_error());
}
else{
    $tab = array();
    while ($row = mysql_fetch_assoc($ask)) 
    {

    $data=$row['numbers'];
    array_push($tab,$data);

}

echo json_encode($tab);
mysql_free_result($ask);
} 
```

带有 $.parseJSON 函数的 html 文件

```
$.post('receive.php', function(data) 
                {

                 var table1=[];
                 table1 = $.parseJSON(data);
                  var numbers=$.merge([],table1);)
                  for(var i=0;i<numbers.length;i++)
                  {
                   alert(numbers[i]); 

                  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:19:57.633

它看起来像是`$data`一个逗号分隔的数字字符串，如果是这样，您可以将其拆分为逗号，然后合并两个数组：

```
$ask = mysql_query("SELECT numbers FROM bying");
if(!ask)
{
    die('incorrect ask'.mysql_error());
}
else {
    $tab = array();
    while ($row = mysql_fetch_assoc($ask)) {
        $data = explode( ',', $row['numbers'] );
        $tab = array_merge( $tab, $data );
    }

    echo json_encode($tab);
    mysql_free_result($ask);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:23:27.653

为什么不以“明显”的方式来遍历数组，并自己将每个字符串拆分为“，”并将每个解析的数字附加到您构建的数组中？

例如

```
 var newNums = [];
  for (var i=0; i<table1.length; i++) {
      newNums = newNums.concat(table1[i].split(','));
  } 
```

# java - 发布接口类型的 ImmutableList

> ID：12394748
> 
> 赞同：0
> 
> 时间：2012-09-12T19:10:57.687
> 
> 标签：java, multithreading, immutability

我正在处理一个问题，其中一个类包含一个经常阅读的列表，但偶尔只写一次。如果我理解正确，假设 MyInterface 是不可变的，则以下类应该是线程安全的：

```
public class MyClass{
    private volatile ImmutableList<MyInterface> list = ImmutableList.of();

    public List<MyInterface> get(){
       return list;
    }

    public synchronized add(MyInterface obj)
       list = ImmutableList.builder().addAll(list).add(obj).build();
    }
} 
```

但是，如果某人实现了 MyInterface 的可变而不是线程安全的版本，它可能会失败。我怎么解决这个问题。我可以针对最终课程实施，但这真的是最佳做法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:18:04.510

使用同步方法，线程使用的互斥锁是“this”类（在本例中为 MyClass 实例）。所以一次只有一个线程可以将一个项目添加到您的列表中，因为整个方法是同步的。这与 MyInterface 无关，在这种情况下，MyInterface 只是方法的一个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:22:18.880

MyInterface 实现的（im）可变性对 ImmutableList 本身没有影响。add() 不会调用对象上的任何方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T19:23:01.497

首先，您需要使您的 get() 方法也在 MyClass 中同步。

此外，Java 语法中没有任何内容可以强制实现类的不变性。它是创建良好的编码指南的问题。

# jsfl - JSFL 删除未使用的库项目

> ID：12394749
> 
> 赞同：1
> 
> 时间：2012-09-12T19:10:58.677
> 
> 标签：jsfl

是否存在用于删除闪存中未使用的库项目的 JFSL 代码？

我知道您可以从 Flash 库菜单中选择“未使用的项目”，然后只需按下删除键。这很好，但我想自动化这个过程，因为我必须为几个项目重复这个过程。

提前致谢！

-拍

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-10T10:58:37.690

也许为时已晚，但这对我有用：

```
 var dom = fl.getDocumentDOM();
 var items = dom.library.items;
 var lib= dom.library;

 //Look for Assets folder and remove

 for(var i=0;i<items.length;i++)
 {     
      if (items[i].name.indexOf("Assets") >= 0)
      {
         fl.trace(items[i].name+ " - target item found: Deleted");
         lib.deleteItem(items[i].name);
      }
 } 
```

您还可以根据类型删除项目：

```
 for(var i=0;i<items.length;i++)
   {
      if (items[i].itemType=="graphic")
      {
         lib.deleteItem(items[i].name);
      } 
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T12:32:56.857

我认为你是对的，删除未使用的项目不可用。过去，还有一个 select and compact 选项不再可用。

所以我能找到的最佳解决方案是创建一个新文档并将舞台上的所有内容复制粘贴到新文档中。它并不理想，不适用于所有项目，但它适用于某些项目。您可以在此处找到代码： [in this AS3 code blog](http://as3.ingogoland.com/function/how-to-delete-unused-library-files-with-jsfl-in-cs5/)

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-02T15:52:55.070

为了跟进之前的建议，有时您会发现当您删除一些未使用的内容时，另一件事变得未使用。我写了一些代码循环，直到最终删除所有未使用的内容。如果您不需要递归方面，则可以删除 while 循环。

```
var lib = fl.getDocumentDOM().library;

while(lib.unusedItems.length > 0)
{
    fl.trace("Deleting... " + lib.unusedItems.length + " items");
    var unusedArr = lib.unusedItems;

    for(var i=0;i<unusedArr.length;i++) 
    {
        var unused = unusedArr[i];
        fl.trace("  deleting " + unused.name);
        lib.deleteItem(unused.name);
    }   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-12T21:02:40.513

在这里提出并回答了这个问题：

[使用 JSFL 检查库项目的“使用计数”](https://stackoverflow.com/questions/15664899/checking-use-count-for-library-items-with-jsfl)

从那以后有一点更新。Flash Professional CC 发布了，最终有一个新的 JSAPI。信息位于此处：

[http://help.adobe.com/en_US/flash/cs/extend/WS849c47c2a95c1007-6e6f2af913b0a89ffd8-8000.html](http://help.adobe.com/en_US/flash/cs/extend/WS849c47c2a95c1007-6e6f2af913b0a89ffd8-8000.html)

***注意***- library.unusedItems 仅在 Flash Professional CC 中可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:21:20.950

此[链接](http://ajarproductions.com/blog/2011/02/23/creating-flash-extensions-pt-3-manipulating-the-library/)是管理和维护库的教程，使用它您可以轻松删除未使用的项目。只需按照教程中提到的创建 JFSL 文件的步骤操作即可

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-21T20:47:16.863

这个简单的脚本将在 Flash Pro CC 中完成这项工作

```
var unusedArr = fl.getDocumentDOM().library.unusedItems;

for(var i=0;i<unusedArr.length;i++) {
    fl.trace('Item removed: '+unusedArr[i].name);
    fl.getDocumentDOM().library.deleteItem(unusedArr[i].name);
}

fl.trace(unusedArr.length+' Items removed'); 
```

# qt - QAbstractListModel insertRows 无法正常工作

> ID：12394751
> 
> 赞同：4
> 
> 时间：2012-09-12T19:11:03.703
> 
> 标签：qt, qml, qabstractlistmodel

我有一个 QAbstractListModel 的子类，并将这个模型子类附加到 GridView。当我从子类中删除行时，GridView 会更新，但是当我在模型中插入行时，GridView 不会更新。我已经实现了 removeR

我有一个非常简单的 QAbstractListModel 子类，并附上了一个 QML GridView。我在 GUI 上有两个按钮添加/删除。按下 Add 将字符串添加到模型和 gui 更新，按下 remove 从模型和 gui 更新中删除最后一个字符串。我的问题是当我添加只插入一行时，当我删除时，GUI 上没有任何反应。给出的是我的模型子类和 QML 文件的实现。

名称模型.cpp

```
NamesModel::NamesModel(QObject *parent) :
    QAbstractListModel(parent)
{
    QHash<int, QByteArray> roles;
    roles[Qt::UserRole + 1]  = "name";
    setRoleNames(roles);
}
int NamesModel::rowCount(const QModelIndex &parent) const
{
    return this->namesList.count();
}
QVariant NamesModel::data(const QModelIndex &index, int role) const
{
    if (!index.isValid())
        return QVariant();

    switch(role) {
    case (Qt::UserRole + 1):
        return this->namesList.at(index.row());
    default:
        return QVariant();
    }
    return QVariant();
}
bool NamesModel::insertRow(int row, const QModelIndex &parent)
{
    if ( parent.isValid() )
        return false;
    qDebug() << "Row = " << row;
    beginInsertRows(parent, row, row);
    this->namesList.insert(row, ("Hello World " + QString("%1").arg(row)));
    endInsertRows();
    return true;
}
bool NamesModel::insertRows(int row, int count, const QModelIndex &parent)
{
    int existing_count = this->namesList.count();
    beginInsertRows(parent, row, count);
    for ( int i = existing_count; i < (existing_count + count); i++ )
        this->namesList.insert(i, QString("Multi Hello World = %1").arg(i));
    endInsertRows();
    return true;
}
bool NamesModel::removeRows(int row, int count, const QModelIndex &parent)
{
    int existing_count = this->namesList.count();
    beginRemoveRows(parent, row, count);
    for ( int i = (existing_count + count); i < existing_count; i-- )
        this->namesList.removeAt(i);
    endRemoveRows();
    return true;
}

bool NamesModel::removeRow(int row, const QModelIndex &parent)
{
     beginRemoveRows(parent, row, row);
     this->namesList.removeAt(row);
     endRemoveRows();
}

void NamesModel::addName()
{
    int index = this->namesList.count();
    //insertRow(index, QModelIndex());
    insertRows(index, 5, QModelIndex());
    emit layoutChanged();
    emit dataChanged(this->index(index), this->index(this->namesList.count()));
}
void NamesModel::removeName()
{
    int index = this->namesList.count();
    //removeRow(index, QModelIndex()/*this->index(this->namesList.count())*/);
    removeRows(index, 5, QModelIndex());
    emit layoutChanged();
    emit dataChanged(this->index(index), this->index(index + 5));
} 
```

main.qml

```
Rectangle {
    width: 360
    height: 360
    Text {
        height: 20
        width: 360/2;
        text: "Add Name"
        MouseArea {
            anchors.fill: parent
            onClicked: {
                names.addName();
                console.log("Add Name");
            }
        }
    }
    Text {
        height: 20;
        width: 360/2;
        x: 360/2
        text: "Remove Name";
        MouseArea {
            anchors.fill: parent
            onClicked: {
                names.removeName();
                console.log("Remove Name");
            }
        }
    }

    Component {
        id: gridDelegate

        Text {
            width: 19;      // These are the dimensions of icon image.
            height: 16
            font.pixelSize: 12
            text: name;
        }
    }
    GridView {
        y: 21
        boundsBehavior: Flickable.StopAtBounds

        focus: true
        model: names;
        delegate: gridDelegate
    }
} 
```

我正在调用 beginInsertRows / endInsertRows 和 beginRemoveRows / endRemoveRows 但它似乎不起作用。正如在其他类似线程上所建议的那样，我在开始 / 结束 InserRows 之后也调用了 layoutChanged / dataChanged 但没有效果。

实际上，我的实际项目几乎有同样的问题。我创建了这个应用程序来测试这个 beginInsertRows 等有什么问题。

任何帮助表示赞赏。

问候法鲁克·阿尔沙德。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T20:01:23.973

您调用[beginInsertRows](http://doc.qt.nokia.com/4.7-snapshot/qabstractitemmodel.html#beginInsertRows)的方式不正确。在该函数的文档中，您需要提供新项目（行）的第一个索引和要插入的项目的最后一个“新”索引（行 + 计数 - 1）。

```
bool NamesModel::insertRows(int row, int count, const QModelIndex &parent)
{
    int existing_count = this->namesList.count();
    beginInsertRows(parent, row, row + count - 1);
    for ( int i = row; i < (row + count - 1); i++ )
        this->namesList.insert(i, QString("Multi Hello World = %1").arg(i));
    endInsertRows();
    return true;
} 
```

beginRemoveRows[也是如此](http://doc.qt.nokia.com/4.7-snapshot/qabstractitemmodel.html#beginRemoveRows)。

```
bool NamesModel::removeRows(int row, int count, const QModelIndex &parent)
{
    int existing_count = this->namesList.count();
    beginRemoveRows(parent, row, row + count - 1);
    for ( int i = (row + count - 1); i <= row; i-- )
        this->namesList.removeAt(i);
    endRemoveRows();
    return true;
} 
```

# c# - Asp.Net Web API 路由 - 必需的 QueryString 参数

> ID：12394760
> 
> 赞同：3
> 
> 时间：2012-09-12T19:11:56.107
> 
> 标签：c#, asp.net, routing, asp.net-web-api

如何在 Asp.Net Web API 中要求某些路由的查询字符串？

控制器：

```
public class AppleController : ApiController
{
    public string Get() { return "hello"; }
    public string GetString(string x) { return "hello " + x; }
}

public class BananaController : ApiController
{
    public string Get() { return "goodbye"; }
    public string GetInt(int y) { return "goodbye number " + y; }
} 
```

想要的路线：

```
/apple        --> AppleController  --> Get()
/apple?x=foo  --> AppleController  --> Get(x)
/banana       --> BananaController --> Get()
/banana?y=123 --> BananaController --> Get(y) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:15:47.677

只需执行以下操作：

```
public string Get(int y = -1)
{ 
    if(y < 0) return "goodbye"; 
    return "goodbye number " + y; 
} 
```

这样，它是一条路线，涵盖所有情况。为了清楚起见，您也可以将每个方法都考虑为私有方法。

另一种方法是添加更多路线，但由于这些路线有些具体，因此您必须添加额外路线。为简单起见，我会说您将方法更改`GetString`为`GetInt`相同的东西（例如`GetFromId`，您可以重用路由：

```
routes.MapRoute(
    name: "GetFromIdRoutes",
    url: "{controller}/{id}",
    defaults: new { action = "GetFromId" }
);

routes.MapRoute(
    name: "GetRoutes",
    url: "{controller}",
    defaults: new { action = "Get" }
); 
```

如果你没有使这些足够通用，你最终可能会得到很多路由条目。另一个想法是将这些放入区域以避免路线冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:15:11.173

您可以在路由中将查询字符串指定为可选或非（在 Global.asax 中）：

```
 ' MapRoute takes the following parameters, in order:
    ' (1) Pages
    ' (2) ID of page
    ' (3) Title of page
    routes.MapRoute( _
        "Pages", _
        "Pages/{id}/{title}", _
        New With {.controller = "Home", .action = "Pages", .id = UrlParameter.Optional, .title = UrlParameter.Optional} _
    ) 
```

这是 VB.NET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T08:20:06.230

今天早上我有一个类似的问题，我想我找到了一种更简单的方法来配置我的路线。在你的情况下，使用这个：

```
config.Routes.MapHttpRoute(
    name: "AppleRoute",
    routeTemplate: "apple",
    defaults: new { controller = "Apple" }
);

config.Routes.MapHttpRoute(
    name: "BananaRoute",
    routeTemplate: "banana",
    defaults: new { controller = "Banana" }
); 
```

只需指定控制器，并让框架根据您的查询字符串参数是否存在来选择正确的操作。

# ruby-on-rails - 我应该使用哪个控制器来更新这些模型，以及如何更新？

> ID：12394762
> 
> 赞同：3
> 
> 时间：2012-09-12T19:12:00.457
> 
> 标签：ruby-on-rails, controller, nested-attributes

以下是我正在使用的 3 个模型：

用户.rb：

```
# == Schema Information
#
# Table name: users
#
#  id              :integer          not null, primary key
#  name            :string(255)
#  email           :string(255)
#  remember_token  :string(255)
#  password_digest :string(255)
#  created_at      :datetime         not null
#  updated_at      :datetime         not null
#

class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation

  has_many :jobs
  has_many :restaurants, :through => :jobs

end 
```

工作.rb

```
# == Schema Information
#
# Table name: jobs
#
#  id            :integer          not null, primary key
#  restaurant_id :integer
#  shortname     :string(255)
#  user_id       :integer
#  created_at    :datetime         not null
#  updated_at    :datetime         not null
#

class Job < ActiveRecord::Base
  attr_accessible :restaurant_id, :shortname, :user_id

  belongs_to    :user
  belongs_to    :restaurant
  has_many      :shifts

end 
```

餐厅.rb：

```
# == Schema Information
#
# Table name: restaurants
#
#  id         :integer          not null, primary key
#  name       :string(255)
#  created_at :datetime         not null
#  updated_at :datetime         not null
#

class Restaurant < ActiveRecord::Base
  attr_accessible :name

  has_many    :jobs
  has_many    :users, :through => :jobs
  has_many    :positions

end 
```

我的场景是用户已经创建并输入到用户表中，但是现在用户想要：

*   可能创建一个新餐厅，如果它不存在的话
*   通过工作表创建用户和餐厅之间的链接，并
    *   可能同时在jobs表中创建昵称

我将在表单中使用嵌套模型来完成此操作，但是我目前删除了所有与此相关的代码。原因是我试图从 Restaurants_Controller 中创建记录，如您所见，它位于“链”的底部。仔细想想，这似乎是错误的。除了在工作模型中链接 user_id 之外，我可以让 rails 为所有事情做这件事。

无论如何，我认为我对 Rails 的理解并不高。保存上述内容的逻辑应该在哪里（作为一个人在表单上点击“提交”的结果）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:11:43.127

> 可能创建一个新餐厅，如果它不存在的话

我认为这就是这里的关键。用户*不一定要*按照您想象的流程创建餐厅。她正在创建一份工作，我认为这部分是用户和餐厅之间的关系（它也有一些关于该用户在餐厅轮班的其他知识）。

从长远来看，我不清楚嵌套表单是否是正确的解决方案，但是根据您的描述，我正在想象用户转到作业/新视图，其中包含一个发布到作业的表单#create ，这会在该用户和餐厅之间建立关系。弄清楚 restaurant_id 的来源以及创建尚未持久化的餐厅的流程中的哪个位置似乎是接下来要弄清楚的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:26:59.370

我认为您应该为这些事情使用 rails 资源。Rails 资源为您提供不同字段的不同 url。在 config/routes.rb 中像这样使用它

```
resources :restaurent do
 resources :job 
end 
```

这将为restuarent 和jobs 创建更新url，其中包含jobs。如果您不了解资源，请阅读 rails guide

# node.js - Web to rabbitmq - stomp web 插件 vs nodejs amqp 插件

> ID：12394766
> 
> 赞同：4
> 
> 时间：2012-09-12T19:12:28.013
> 
> 标签：node.js, rabbitmq, stomp

我试图决定我是否会通过以下方式从网络连接到rabbitmq：

解决方案 1\. Rabbitmq stomp 插件 + Rabbitmq web stomp 插件 + Sockjs

解决方案2\. Rabbitmq + nodejs 通过 amqp nodejs 插件

设想：

a) 我有一个订阅队列的 Web 应用程序 b) 我有一个正在写入该队列的 Java 应用程序 c) 我有一个浏览器打开了解决方案 1，另一个浏览器打开了解决方案 2

我测试了两者，发生的情况是：

当我发送连续的 10.000 条消息时，解决方案 2 比解决方案 1 快得多。解决方案 2 永远不会失去连接。解决方案 1 大多数情况下会在随机时间（在收到每条消息之前）断开连接。

问题：

1.  我可以在解决方案 1 中更新任何限制配置吗？

2.  解决方案1的问题是由于：Sockjs？跺脚插件？跺脚网络插件？他们全部？我不明白为什么如果我在中间添加 nodejs 比 rabbitmq 中的嵌入式 erlang 插件（rabbitmq stomp /rabbitmq web stomp 插件）要快得多。

    注意：stomp 插件或 stomp web 插件永远不会消失。它总是继续监听他们的端口。

3.  我的简单解释是浏览器无法处理如此多的顺序消息，而 nodejs 可以很好地处理这一点，而 rabbitmq web stomp 则不能。但也只是猜测。这个对吗？如果是这样，我该如何解决？

4.  解决方案 1 不应该比解决方案 2 更好（延迟方面）？

注意：如果我在发布者中添加每条消息发送之间的 5 毫秒差异，则此问题将消失，并且解决方案 1 的执行与解决方案 2 类似（对于 10.000 条消息）。

感谢您的任何回答。

此致，

爱德华多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T12:16:22.317

您正在比较使用不同协议的服务器（node.js）和浏览器客户端，当然它们是非常不同的！STOMP 协议可用于为消息传递提供轻量级和简单的客户端，例如浏览器 JS。

我想，解决方案 1 可能因浏览器和 SockJS 使用的连接类型而有很大差异：XHR、WebSocket、IFrame ......

# asp.net - 将网站迁移到新服务器时出现 ASP.Net 错误

> ID：12394767
> 
> 赞同：0
> 
> 时间：2012-09-12T19:12:29.427
> 
> 标签：asp.net, .net, server-migration

我正在将我的网站迁移到一个新服务器，它在 .NET 中，我对这种语言没有太多经验。但是我尝试搜索修复但没有成功。有人可以帮忙吗？

错误：

> 编译器错误消息：ASPNET：确保此代码文件中定义的类与“继承”属性匹配，并且它扩展了正确的基类（例如 Page 或 UserControl）。

源错误：

```
Line 1:  <%@ Page Title="" Language="VB" MasterPageFile="~/EnjoyMaster2.master" AutoEventWireup="true" CodeFile="Default.aspx.vb" Inherits="_Default" %>
Line 2:  
Line 3:  <asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:20:49.647

如果您已经检查过：继承属性、代码文件属性、命名空间，但仍然有问题，则可能是 web.config 问题（pageBaseType）。

```
<configuration>
<appSettings>
    ...
</appSettings>
<connectionStrings/>
<system.web>
    <pages pageBaseType="System.Web.UI.Page" />
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:26:10.867

确保 Inherits 属性和此代码文件中定义的类使用相同的名称，并尝试在类名之前添加命名空间，例如`Inherits="namespace._Default"`.

[错误 4 确保此代码文件中定义的类与“继承”属性匹配，并且它扩展了正确的基类（例如 Page 或 UserControl）。](http://www.developerfusion.com/thread/53581/error-4-make-sure-that-the-class-defined-in-this-code-file-matches-the-inherits-attribute-and-that-it-extends-the-correct-base-class-eg-page-or-usercontrol/)

# apache-flex - 使用列表（Spark 列表控件）作为 Spark Datagrid 列项渲染器

> ID：12394772
> 
> 赞同：1
> 
> 时间：2012-09-12T19:13:06.137
> 
> 标签：apache-flex, actionscript, flex4, flex4.5, flex-spark

我有以下问题：

我需要创建一个动态数据网格，但单元格的内容是`ArrayCollection`. 我正在尝试使用 Spark 列表控件作为每列的项目渲染器，但无法正常工作。

是否有人已经必须做类似的事情或知道解决方案的好例子？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T13:48:52.503

我刚刚找到了解决方案，它类似于：

```
<s:GridItemRenderer>    

<s:List id="eventsGroup" borderVisible="false" contentBackgroundAlpha="0" useVirtualLayout="false"`>
        <s:layout>
            <s:VerticalLayout variableRowHeight="true"/>
        </s:layout>
    </s:List>
</s:GridItemRenderer> 
```

然后我们可以为每个 List 元素添加一个简单的项目渲染器。

# django - 无法设置夹层

> ID：12394775
> 
> 赞同：1
> 
> 时间：2012-09-12T19:13:24.310
> 
> 标签：django, apache, mezzanine

我的虚拟主机是 a2hosting，他们提供了以下用于设置夹层的文档：

[https://my.a2hosting.com/knowledgebase.php?_m=knowledgebase&_a=viewarticle&kbarticleid=776](https://my.a2hosting.com/knowledgebase.php?_m=knowledgebase&_a=viewarticle&kbarticleid=776)

该指南中我没有做的唯一部分是修改 public)html root 的 .htaccess 以转发到文件夹。因此我应该能够通过 mydomain.com/mezz 访问服务器（对吗？）

我也跑过collectstatic。

这就是我得到的： http: [//dapperhat.net/mezz](http://dapperhat.net/mezz)

看起来 CSS 只是不工作，我运行了 collectstatic 但仍然是同样的事情。最奇怪的部分是它显示我是否让服务器运行！

我认为这与该指南中的处理程序有关，但我对它的理解不足以追踪它。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:34:37.140

您`STATIC_URL`可能指向`/static/`但您的网站托管在`/mezz/`

尝试以下设置；

```
STATIC_URL = "/mezz/static/" 
```

# mysql - MySQL LIMIT 和 GROUP BY 使用 IN？

> ID：12394779
> 
> 赞同：1
> 
> 时间：2012-09-12T19:13:49.787
> 
> 标签：mysql

我有一个表 ITEMS，它有道具 id、site_id、频率

到目前为止，我可以列出项目并从 id 数组中按频率排序，使用

```
SELECT * 
FROM items 
WHERE id IN(1549, 1550, 1635, 1637) 
ORDER BY site_id, frequency DESC 
```

但我想将我的结果按 site_id 分组，其中只有一个具有最佳（最高）频率的项目..

我该怎么办 ？

编辑：我希望将具有最佳频率的项目按 site_id 分组（一个结果按 site_id）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:16:28.277

在没有看到数据类型或示例数据的情况下，听起来您想要这样：

~~`select id, site_id, max(frequency) FROM items WHERE id IN(1549, 1550, 1635, 1637) GROUP BY id, site_id ORDER BY site_id, frequency DESC`~~

或者您可以使用子查询：

```
select i1.id, i1.site_id, i1.frequency
from items i1
inner join
(
   select site_id, max(frequency) mx
   from items
   WHERE id IN(1549, 1550, 1635, 1637) 
   group by site_id
) i2
   on i1.site_id = i2.site_id
   and i1.frequency = i2.mx
WHERE i1.id IN(1549, 1550, 1635, 1637) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:18:38.380

```
select i.*
from (
    select site_id, max(frequency) as MaxFrequency
    from item
    where id in (1549, 1550, 1635, 1637)    
    group by site_id
) im
inner join items i on im.site_id = i.site_id and im.MaxFrequency = i.frequency
where i.id in (1549, 1550, 1635, 1637) 
```

`site_id`注意：如果两者的频率相同，这将为您提供多于一行。

# java - Java FileInputStream.open 无法在 Windows 上打开 unix NFS 共享文件 - 不一致

> ID：12394786
> 
> 赞同：0
> 
> 时间：2012-09-12T19:14:05.557
> 
> 标签：java, windows, nfs, fileinputstream

有没有人在 Windows 上看到过不一致的 FileInputStream.open 异常？

我有 Oracle 的连贯性 (coherence-3.6.1-p6.jar) com.tangosol.run.xml.XmlHelper.loadXml 方法在 java.io.FileInputStream.open (Native) (jdk1.6.0_29) 中出现异常给定文件：/// 路径。请参阅下面记录的堆栈跟踪（以及失败后 16 秒的成功日志）。该文件和它上面的所有目录在 unix 上都是世界可读的。

间歇性地看到错误的 jvm 正在使用 jsl 作为 Windows 服务（在本地系统帐户下）运行：

```
Michael Roeschter (Michael@Roeschter.com) 的 JSL Java 服务启动器
版本 0.99n 2011 年 9 月 12 日

```

错误堆栈跟踪，后跟成功（？！）：

```
2012-09-12 14:23:48.730 -0400 错误...
原因：（包装：无法加载缓存配置：file://///{unix nfs 共享}/{dir}/{file}.xml）（包装）java.io.FileNotFoundException：\\{unix nfs 共享}\{dir}\{file}.xml（访问被拒绝）
        在 com.tangosol.util.Base.ensureRuntimeException（Base.java:293）
        在 com.tangosol.run.xml.XmlHelper.loadResourceInternal(XmlHelper.java:330)
        在 com.tangosol.run.xml.XmlHelper.loadFileOrResource(XmlHelper.java:281)
        在 com.tangosol.net.DefaultConfigurableCacheFactory.loadConfig（DefaultConfigurableCacheFactory.java:396）
        在 com.tangosol.net.DefaultConfigurableCacheFactory.loadConfig（DefaultConfigurableCacheFactory.java:382）
        在 com.tangosol.net.DefaultConfigurableCacheFactory.(DefaultConfigurableCacheFactory.java:148)
        ... 39 更多
引起：（包装）java.io.FileNotFoundException：\\{unix nfs share}\{dir}\{file}.xml（访问被拒绝）
        在 com.tangosol.run.xml.XmlHelper.loadXml(XmlHelper.java:159)
        在 com.tangosol.run.xml.XmlHelper.loadResourceInternal(XmlHelper.java:320)
        ... 43 更多
引起：java.io.FileNotFoundException: \\{unix nfs share}\{dir}\{file}.xml（访问被拒绝）
        在 java.io.FileInputStream.open（本机方法）
        在 java.io.FileInputStream.(FileInputStream.java:120)
        在 java.io.FileInputStream.(FileInputStream.java:79)
        在 sun.net.www.protocol.file.FileURLConnection.connect(FileURLConnection.java:70)
        在 sun.net.www.protocol.file.FileURLConnection.getInputStream(FileURLConnection.java:161)
        在 java.net.URL.openStream(URL.java:1010)
        在 com.tangosol.run.xml.XmlHelper.loadXml(XmlHelper.java:155)
        ... 44 更多
...
2012-09-12 14:24:04.839 -0400 INFO STDERR [Logger@11477911 3.6.1.6] cpratesdev: 2012-09-12 14:24:04.839/27.702 Oracle Coherence GE 3.6.1.6 (thread=app-main, member =n/a)：从“file://///{unix nfs share}/{dir}/{file}.xml”加载缓存配置

```

# html - 简单的css定位（我认为）

> ID：12394793
> 
> 赞同：3
> 
> 时间：2012-09-12T19:14:37.210
> 
> 标签：html, css

我一直想用 css 定位替换我网站中的表格，并且一直在尝试通过教程等自学。我已经取得了一些早期的成功，但是当我尝试创建侧边栏时，一切都崩溃了。我希望这个问题有某种简单的解决方案。元素的相对/绝对定位并没有接近我想要做的。我的目标是有一个侧边栏，其中包含从上到下堆叠（浮动？）的图像，中间元素是无序列表的一部分。我让它工作了一次，但现在那个堆栈在彼此之上。它必须是我设置浮动和绝对/相对定位的方式。在这里阅读了一些文章后，我尝试添加一个 div 包装器将它们放入其中，但我想我让自己更加困惑。是否有人可以将我推向正确的方向？这是代码：

**CSS**

```
body   
{
    background: #b6b7bc;
    font-size: .80em;
    font-family: "Helvetica Neue", "Lucida Grande", "Segoe UI", Arial, Helvetica, Verdana, sans-serif;
    margin: 50px;
    padding: 0px;
    color: #696969;
    height: 160px;
}

a:link, a:visited
{
    color: #034af3;
}

a:hover
{
    color: #1d60ff;
    text-decoration: none;
}

a:active
{
    color: #034af3;
}

p
{
    margin-bottom: 10px;
    line-height: 1.6em;
}

/* HEADINGS   ----------------------------------------------------------*/

h1, h2, h3, h4, h5, h6
{
    font-size: 1.5em;
    color: #666666;
    font-variant: small-caps;
    text-transform: none;
    font-weight: 200;
    margin-bottom: 0px;
}

h1
{
    font-size: 1.6em;
    padding-bottom: 0px;
    margin-bottom: 0px;
}

h2
{
    font-size: 1.5em;
    font-weight: 600;
}

h3
{
    font-size: 1.2em;
}

h4
{
    font-size: 1.1em;
}

h5, h6
{
    font-size: 1em;
}

/* PRIMARY LAYOUT ELEMENTS  ---------------------------------------------------------*/

.page
{
    width: 960px;
    background-color: #fff;
    margin: 20px auto 0px auto;
    border: 1px solid #496077;
}

.header
{
    position: relative;
    margin: 0px;
    padding: 0px;
    background: #4b6c9e;
    width: 100%;
    top: 0px;
    left: 0px;
}

.header h1
{
    font-weight: 700;
    margin: 0px;
    padding: 0px 0px 0px 20px;
    color: #f9f9f9;
    border: none;
    line-height: 2em;
    font-size: 2em;
}

.main
{
    padding: 0px 12px;
    margin: 0px 4px 4px 4px;
    min-height: 420px;
    width: 500px;
    float: left;
}

.leftCol
{
    padding: 6px 0px;
    margin: 12px 8px 8px 8px;
    width: 200px;
    min-height: 200px;
}

.footer
{
    color: #4e5766;
    padding: 8px 0px 0px 0px;
    margin: 0px auto;
    text-align: center;
    line-height: normal;
}

/* MISC ----------------------------------------------------------*/

.clear
{
    clear: both;
    width: 936px;
    height: 35px;
}

.title
{
    display: block;
    float: left;
    text-align: justify;
}

.bold
{
    font-weight: bold;
}

p.clear
{
    clear: both;
    height: 0;
    margin: 0;
    padding: 0; 
}

#wrapper
{
    position:relative;
    height: 500px;
    width: 900px;
}

#insidemain
{
    position:absolute;
    float: left;    
    width: 500px;
    height 180px;
}

/* ---------------- Sidebar Items ---------------------*/

#sidebar   /* Sidebar container */
{
    position:absolute;
    border-top: 1px solid #99CC33;
    border-left: 1px solid #99CC33;
    height: 300px;
    width: 180px;
    margin-right: 5px;
    padding: 5px 0 0 5px;
}

#sidebarHeader
{
    position:absolute;
    height: 37px;
    width: 172px;
    float: left;
    background-image: url(../img/TopMenu.jpg);
    background-repeat:no-repeat;
}

#sidebarItems ul
{
    position:absolute;
    height: 27px;
    width: 172px;
    float:left;
    background-image: url(../img/MenuItems.jpg);
    background-repeat:no-repeat;
    /*left: 6px;
    top: 45px;*/
    background-position: 0px -27px;
}

#sidebarFooter
{
    position:absolute;
    height: 46px;
    width: 172px;
    float:left;
    background-image: url(../img/BottomMenu.jpg);
    background-repeat:no-repeat;
} 
```

和**HTML**：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title></title>
        <link href="Styles/Simple.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <div class="page">
            <div class="header">header
                <div class="title">
                    <h1>
                        Test Page
                    </h1>
                </div>
            </div>
            <p class = "clear">clear</p>
            <div id="wrapper">
                <div id="sidebar">
                    <div id="sidebarHeader">
                    </div>
                    <div id="sidebarItems">
                        <ul>
                            <li>test item</li>
                        </ul>
                    </div>
                    <div id="sidebarFooter">
                    </div>
                </div>
            </div>
            <div id="insidemain">
                main
            </div>
        </div>
        <div class="clear">clear</div>
        <div class="footer">
            <a href="http://www.google.com/">
                Blah blah test to see how far this will go across the page blah blha lorem ipsum and various other stuff that is meaningless etc
            </a>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:25:13.493

通常（特别是对于非响应式网站），您的`.wrapper`div 会围绕整个内容（页眉、内容、侧边栏、页脚等）。然后设置你`.wrapper`的宽度。你`.sidebar`会有一套`width`，它会`float: left;`或`float: right;`取决于你想要它的一面。设置你的`.content`div`width`小于或等于你的`.wrapper width`- 你的`.sidebar width`. 然后添加您的`.clearfix`下方，以便`.footer`在所有内容下方。在大多数情况下（至少对于大页面块），您可以避免`position:absolute;`这有助于使事情更容易到位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T22:41:55.970

你真的不应该浮动你的 div 或列表。这些默认情况下是块元素，无论如何都会垂直堆叠。

此外，正如 Scrimothy 所提到的，您不需要绝对定位的元素，因为这会将元素从页面流中取出。换句话说，它们不再占用页面中的“真实”空间，而是在您放置它们的任何坐标处呈现。

同样，浮动也不占用空间，除了其他浮动元素。这就是为什么一些 UI 开发人员会浮动页面上的几乎每个元素并使用页脚或页面中的关键中断“清除”它们。我个人不建议以这种方式定位，而是针对每个人自己的定位。

看看这个快速教程是否可以帮助您了解一些关键的定位概念：[这里](http://www.barelyfitz.com/screencast/html-training/css/positioning/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T23:01:18.973

不要同时使用`float`和来定位相同的元素`position:absolute`。这没有多大意义。任何你有的地方，你都`float`应该摆脱`position:absolute`

接下来，摆脱那些愚蠢的`class="clear"`元素。相反，`.footer`使用`clear:both`和`.page`使用`overflow-y:hidden;`

# sql - 使用 rank() 根据 group by 重写窗口函数

> ID：12394801
> 
> 赞同：0
> 
> 时间：2012-09-12T19:15:24.730
> 
> 标签：sql, postgresql, group-by

我有一个窗口函数，它使用 rank() 操作将最近的 DHCP 日志事件与 IP 地址相匹配，从而将 IP 与主机名相关联。问题是查询不能很好地扩展到大型数据集，因此我想尝试根据 group by 重写它，但我没有成功。

```
create table large_table as
select column1, column2, column3, column4, column5, column6
from
(
  select 
    a.column1, a.column2, a.start_time,
    rank() OVER( 
      PARTITION BY a.column2, a.column1 order by a.start_time DESC 
    ) as rank,
    last_value( a.column3) OVER (
      PARTITION BY a.column2, a.column1 order by a.start_time ASC
      RANGE BETWEEN unbounded preceding and unbounded following 
    ) as column3,
    a.column4, a.column5, a.column6
  from 
    (table2 s 
      INNER JOIN table3 t 
      ON s.column2=t.column2 and s.event_time > t.start_time 
    ) a
 ) b
 where rank =1; 
```

> 问题1：我们如何使用group by而不是窗口函数来重写上面的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T13:35:27.393

我认为以这种方式将窗口编写为 group-by 不会是一个成功的策略。当您将表中的聚合连接回主表时，这将导致严重的性能问题。

更好的方法是使用 plpgsql 和一个在循环内添加窗口信息的函数。例如，可以像这样添加行号：

```
CREATE OR REPLACE FUNCTION foo_with_rownumber () RETURNS SETOF foo_with_rownumber
LANGUAGE PLPGSQL AS $$
DECLARE out_val foo_with_rownumber;
        iter int;
BEGIN
    iter := 1;
    FOR out_val IN select f.*, 0 FROM foo order by bar
    LOOP
        out_val.rownumber = iter;
        return next out_val;
        iter := iter + 1;
    END LOOP;
END;
$$; 
```

rank() 添加起来只会稍微复杂一些，所以这应该会让你继续前进。

# struts2 - Struts2 复选框列表

> ID：12394804
> 
> 赞同：0
> 
> 时间：2012-09-12T19:15:37.917
> 
> 标签：struts2, checkboxlist

我有一个 Struts 复选框`value="val" listkey="lk" listvalue="lv"`列表，这个复选框列表正在迭代并根据动作类中的列表获取 5 个复选框。我的问题是当我单击第一个复选框时，它应该在复选框的正下方显示 div 元素。记住像“垂直”这样的主题，我们在模板中添加了 break br。以同样的方式，当单击复选框时，如何在复选框正下方实现 div 元素

# neo4j - 重启 neo4j 1.7 服务器时出现问题

> ID：12394810
> 
> 赞同：0
> 
> 时间：2012-09-12T19:16:14.323
> 
> 标签：neo4j

我正在尝试重新启动我的 Neo4j 实例，并且在我的 messages.log 或 console.log 中都没有看到任何错误。

我确实在消息中看到了恢复通知，但是我的启动脚本总是返回：

```
waiting for server to be ready............................................... BAD 
```

控制台日志：

```
9/12/12 6:37:48 PM org.neo4j.server.NeoServerWithEmbeddedWebServer INFO: Starting Neo Server on port [7474] with [20] threads available
9/12/12 6:37:48 PM org.neo4j.server.NeoServerWithEmbeddedWebServer INFO: Enabling HTTPS on port [7473]
9/12/12 6:37:48 PM org.neo4j.server.database.Database INFO: Using database at /db/data 
```

消息日志：

```
2012-09-12 18:37:49.059+0000: Non clean shutdown detected on log [/srv/neo4j/graphdb/data/nioneo_logical.log.1]. Recovery started ...
2012-09-12 18:37:49.067+0000: [/srv/neo4j/graphdb/data/nioneo_logical.log.1] logVersion=244 with committed tx=18015029
2012-09-12 18:37:55.391+0000: [/srv/neo4j/graphdb/data/nioneo_logical.log.1] entries found=203005 lastEntryPos=8387712
2012-09-12 18:37:55.391+0000: Internal recovery completed, scanned 203005 log entries. Recovered 23260 transactions. Last tx recovered: 18038289
2012-09-12 18:37:55.392+0000: XaResourceManager[/srv/neo4j/graphdb/data/nioneo_logical.log] sorting 0 xids
2012-09-12 18:37:55.393+0000: XaResourceManager[/srv/neo4j/graphdb/data/nioneo_logical.log] checkRecoveryComplete 0 xids
2012-09-12 18:37:58.033+0000: /srv/neo4j/graphdb/data/neostore.relationshiptypestore.db.names rebuild id generator, highId=4 defragged count=0
2012-09-12 18:37:58.053+0000: /srv/neo4j/graphdb/data/neostore.propertystore.db.index.keys rebuild id generator, highId=7 defragged count=0
2012-09-12 18:37:58.069+0000: /srv/neo4j/graphdb/data/neostore.propertystore.db.index rebuild id generator, highId=6 defragged count=0
2012-09-12 18:37:58.096+0000: /srv/neo4j/graphdb/data/neostore.propertystore.db.strings rebuild id generator, highId=16265 defragged count=0
2012-09-12 18:37:58.108+0000: /srv/neo4j/graphdb/data/neostore.propertystore.db.arrays rebuild id generator, highId=1 defragged count=0
2012-09-12 18:37:58.507+0000: /srv/neo4j/graphdb/data/neostore.propertystore.db rebuild id generator, highId=3052890 defragged count=0
2012-09-12 18:37:58.903+0000: /srv/neo4j/graphdb/data/neostore.relationshipstore.db rebuild id generator, highId=9188555 defragged count=0
2012-09-12 18:37:58.929+0000: /srv/neo4j/graphdb/data/neostore.nodestore.db rebuild id generator, highId=1183312 defragged count=0
2012-09-12 18:37:58.942+0000: /srv/neo4j/graphdb/data/neostore rebuild id generator, highId=6 defragged count=0
2012-09-12 18:37:58.946+0000: XaResourceManager[/srv/neo4j/graphdb/data/nioneo_logical.log] recovery completed.
2012-09-12 18:37:58.946+0000: Recovery on log [/srv/neo4j/graphdb/data/nioneo_logical.log.1] completed.
2012-09-12 18:37:58.962+0000: TM opening log: /srv/neo4j/graphdb/data/tm_tx_log.1
2012-09-12 18:37:58.994+0000: Non clean shutdown detected on log [/srv/neo4j/graphdb/data/index/lucene.log.2]. Recovery started ...
2012-09-12 18:37:58.994+0000: [/srv/neo4j/graphdb/data/index/lucene.log.2] logVersion=99 with committed tx=10257784 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T21:05:31.790

lucene 的恢复时间过长。请使用`bin/neo4j console`在前台模式下启动一次以完成恢复。

# c++ - C++ 运算符重载影响类内运算符函数

> ID：12394811
> 
> 赞同：0
> 
> 时间：2012-09-12T19:16:15.430
> 
> 标签：c++, operator-overloading

如果我重载`!=`运算符并`class!=`在其他运算符重载器之一中使用，它会接受它作为非重载还是重载？我正在尝试创建一个 noob_ptr （我正在考虑的一种自定义指针包装器）

```
class noob_ptr 
 {
      private: //does this change the behaviour? public? protected?
      bool operator!=(noob_ptr x)
       {
         ...
        }
      bool operator,(noob_ptr y)
      {
         ...
         if(y!=z)...
         ...
      }
    ...
      } 
```

下面的示例是否取消了我班级中重载运算符的使用？

```
class noob_ptr 
 {
      protected: //or public
      bool operator,(noob_ptr y) //yes, z is also a noob_ptr
      {
         ...
         if(y!=z)...
         ...
      }
    ...
      private: 
      bool operator!=(noob_ptr x)
       {
         ...
        }
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:19:17.957

如果您提供的操作数是语言内置的操作数`!=`，那么这就是使用的操作数。如果它们是用户定义的类型，那么它将搜索为`operator!=`这些类型（或支持从这些类型进行隐式转换的某些类型）定义的用户定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:24:57.833

如果 type of`z`也是 a `noob_ptr`，那么答案是肯定的，它会`operator !=`为你的类调用重载。另外，我建议您使用此比较方法签名：

```
bool operator != (const noob_ptr& x) const; 
```

因此它可以用于常量指针，并且在调用重载运算符时也可以避免对象复制。

**UPD**：如果您声明`operator !=`为私有，那么它将在类的所有成员函数`noob_ptr`、朋友类和类的函数中可用`noob_ptr`，并且对于所有其他用法将导致编译错误，并显示如下消息：“operator != is inaccessible由于其保护级别"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:46:00.440

C++ 将始终使用在限定符、访问说明符（如私有、范围、命名空间等）中最接近的“最佳匹配”。

因此，如果有一个全局命名空间运算符！= 和一个类（缺少左侧参数，如果方法是 const，则假定为 class& 或 const class& - 它应该是），然后在里面类（命名空间），您将在类中获得一个。

如果全局命名空间和类之间只有一个，你显然会得到那个。

以下代码演示了全局和类范围之间的关系。您可以通过添加 const 限定符等来扩展它。

```
 #include <iostream>
using namespace std;

// Forward declaration to use without the class definition
class X;

bool operator!=(     int lhs, const X& rhs) {
  cout << "bool operator!=(     int lhs, const X& rhs)" << endl;
  return false;
}
bool operator!=(const X& lhs, const X& rhs) {
  cout << "bool operator!=(const X& lhs, const X& rhs)" << endl;
  return false;
}
bool operator!=(const X& lhs,      int rhs) {
  cout << "bool operator!=(const X& lhs,      int rhs)" << endl;
  return false;
}
// Note: Can't do: bool operator!=(int lhs, int rhs) -- already defined

class X {
private:
  int x;
public:
  X(int value) : x(value) { }

  bool operator !=(const X& rhs) {
    cout << "bool X::operator !=(const X& rhs)" << endl;
    return true;
  }

  bool operator !=(int rhs) {
    cout << "bool X::operator !=(int rhs)" << endl;
    return true;
  }

  void f() {
    X compare(1);
    cout << "X::f()" << endl;
    cout << (5 != 3) << endl;         // Uses built-in
    cout << (*this != 3) << endl;     // Uses member function
    cout << (*this != 1) << endl;     // Uses member function
    cout << (1     != *this) << endl; // There can be no member function, uses global namespace
    cout << (*this != compare) << endl;
  }
};

void f(const X& arg) {
  cout << "f()" << endl;
  X compare(1);
  cout << (5 != 3) << endl;         // Uses built in
  cout << (arg != 3) << endl;       // Uses global namespace
  cout << (arg != 1) << endl;       // Uses global namespace
  cout << (1   != arg) << endl;     // Uses global namespace
  cout << (arg != compare) << endl; // Uses global namespace
}

int main(int argc, char **argv) {
  X x(1);
  x.f();
  f(x);
  return 0;
} 
```

# mysql - 在mysql中与case语句连接

> ID：12394812
> 
> 赞同：1
> 
> 时间：2012-09-12T19:16:17.480
> 
> 标签：mysql, mysqlconnection

我想用 sql 查询输出生成 .sql 文件。我正在使用 sql 中的 concat 语句执行此操作。我在某些查询中使用 case 语句，这对我来说是个问题。

```
select concat('insert into x values(',CASE a when B then 'Book' else 'NONE' end , ') on duplicate key update B = values(B)') from author;

select 'insert into x values('+CASE a when B then 'Book' else 'NONE' end +') on duplicate key update B = values(B)' from author; 
```

它也不起作用，因为在 mysql + 中仅用于添加数字而不用于字符串。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:23:27.300

第一个版本的问题是字符串中事物的引号。例如，您希望您的字符串包含“'Book'”

```
select concat('insert into x values(',
               (CASE a when 'B' then '''Book''' else '''NONE''' end) ,
              ') on duplicate key update B = values(''B'')'
             )
from author; 
```

我认为这引用了所有字符串，因为它们应该是。我猜A列是一个应该与“B”而不是B列比较的字符。

# jquery - rails 3 如何使用 jquery 提交远程表单并避免回调

> ID：12394814
> 
> 赞同：0
> 
> 时间：2012-09-12T19:16:26.977
> 
> 标签：jquery, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我有一个`remote => true`表格并想提交它并避免使用提交方法。

通常我会做

```
form$.get(0).submit()

form$.submit(function(){..avoid going here..}) 
```

但这会将表单作为 html 而不是 js 发送。有什么方法可以做到这一点并得到 js 的响应？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:31:13.210

在您的控制器中使用此代码

```
respond_to do |page|
    page.js {}
end 
```

并在视图中添加一个文件，控制器的函数名称以 .js 扩展名结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:41:21.843

我很难找到的人。

答案是替换

```
$(form).get(0).submit()

$(form)[0].submit() 
```

经过

```
$(form).trigger("submit.rails") 
```

这将跳过所有提交甚至除了rails之外的侦听器。

# javascript - 用小时差值填充数组/列表 - 给定下拉菜单中的两个时间值

> ID：12394815
> 
> 赞同：0
> 
> 时间：2012-09-12T19:16:36.727
> 
> 标签：javascript, jquery, asp.net, jquery-plugins, timepicker

我正在尝试用时间减法的值填充数组/列表。我有这种格式“09.00 AM”的开始时间和相同格式的结束时间，例如：“06.00 PM”，这两个时间都来自两个下拉菜单（值从上午 9 点到晚上 9 点，每小时增量）实际上是 jquery 时间选择器控件。这就是我想要做的..在用户选择两个时间之后，我想用位于两个选定时间值之间的单个“小时”标记值填充一个数组/列表。例如：选择上午 9 点和下午 12 点应该给我值 {“10.00 AM”、“11.00 AM”}.. 选择 10 AM 到 4 PM 应该给我 {“11.00 AM”、“12.00 PM”、“01.00 PM” , "02:00 PM", "03:00 PM"}..

```
var FirstTime = container.find('#1time').val();
var SecondTime = container.find('#2time').val(); 

var busyTimes = [];
busyTimes =  getBusyTimes(FirstTime , SecondTime); 
```

函数js：

```
function getBusyTimes(first, second) {
    var f = first.split(' '), s = second.split(' ');
    if (first == '12.00 AM') f[0] = '0';
    if (first == '12.00 PM') f[1] = 'AM';
    if (second == '12.00 AM') s[0] = '24';
    if (second == '12.00 PM') s[1] = 'AM';
    f[0] = parseInt(f[0], 10) + (f[1] == 'PM' ? 12 : 0);
    s[0] = parseInt(s[0], 10) + (s[1] == 'PM' ? 12 : 0);
    int i = s[0] - f[0];
    // I have difference in hours in "i"
    //From here, I want to make use of value 'i' -- calculate in between   
    // hourly values and return the array back to 
    // original function above.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:28:51.990

我没有对此进行测试，但它应该适用于您正在尝试做的事情，并且它应该比您尝试做的计算运行得更快。

```
function getBusyTimes(first, second){
var timeList = ['12:00 AM','1:00 AM','2:00 AM','3:00 AM']; // finish this list
var firstid  = timeList.indexOf(first);
var secondid = timeList.indexOf(second);
var result = new Array();
for(var i=firstid; i<=secondid; i++ ){
    result.push(timeList[i]);
}
return result;
} 
```

# iphone - 试图从网站获取文本并在 ios 中显示？

> ID：12394819
> 
> 赞同：1
> 
> 时间：2012-09-12T19:17:07.333
> 
> 标签：iphone, ios, xcode

好的，我有一个现有的应用程序，我目前正在为其进行更新。我想要做的是当客户端更新他们的网站时，应用程序将从特定页面中提取文本并在 UITextView 中显示文本？我正在尝试这种方法，除了它包含 NavBar 的文本之外它工作正常吗？那么如何仅获取文本而不获取 NavBar？

```
 textView.text = [webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.innerText"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:41:00.663

好吧，从我看到的角度来看，您有两个选择。如果您知道导航栏中的文本有多长并且字符长度相同，请使用：

```
NSString *webString = [webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.innerText"];
int length = amount of characters to remove from beginning of string;
webString = [webString substringFromIndex:length]; 
```

如果您不知道要删除的数量，可以使用 NSScanner，它有点复杂但更灵活。

```
NSString *webString = [webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.innerText"];
NSScanner *stringScanner = [NSScanner scannerWithString:webString];
NSString *content = [[NSString alloc] init];
while ([stringScanner isAtEnd] == NO) {

[stringScanner scanUpToString:@"Start of the text you want" intoString:null];
[stringScanner scanUpToString:@"End of the text you want" intoString:&content];
} 
```

希望这会有所帮助：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T21:10:06.443

这是我尝试使用的代码

```
NSString *webString = [webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.innerText"];
NSScanner *stringScanner = [NSScanner scannerWithString:webString];
NSString *content = [[NSString alloc] init];
while ([stringScanner isAtEnd] == NO) {

    [stringScanner scanUpToString:@"Andalee" intoString:NULL];
    [stringScanner scanUpToString:@"Eastern Sun Dance Company Rehearsal Mondays 7:00pm @ Cal Arts Academy" intoString:&content];
    textView.text = webString; } 
```

也许我接近它是错误的。这是我试图从[http://andalee.com/andalee/CLASSES.html中提取的网页](http://andalee.com/andalee/CLASSES.html)

# javascript - 为什么要在 javascript 中使用 0 > 0？

> ID：12394821
> 
> 赞同：15
> 
> 时间：2012-09-12T19:17:14.093
> 
> 标签：javascript

我正在浏览一些 StackOverflow 的客户端代码，并且在以下源代码中遇到了这个 JavaScript 块[`https://stackoverflow.com/questions/ask`](https://stackoverflow.com/questions/ask)：

```
if ($answerCheckbox.is(':checked') || 0 > 0) {
     $answerCheckbox.attr('checked', true);
     $('#question-only-section').hide();
     StackExchange.using("editor", function () {
          setTimeout(function () { showAnswerSection(true) }, 2);
     });
} 
```

你为什么不`false`改用呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-12T19:19:43.667

您假设代码都是本机编写的 Javascript。看到一些服务器生成的脚本通过一些程序标识符引用元素的情况并不少见，这些标识符在运行时会像这样解析，诚然这看起来有点奇怪。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T19:20:20.643

它是生成的代码（不在 .js 文件中），因此显然这两个值之一并不总是 0，而是一个服务器端变量。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-12T19:20:54.633

没有理由......但是在您知道服务器端代码之前，您无法确定。

假设（PHP）您有一个变量`$x=1`，也可能`$x=0`取决于场景。

```
if ($answerCheckbox.is(':checked') || <?php echo $x;?> > 0) { 
```

该代码非常有意义....

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-12T19:20:41.793

因为该行可能来自 php，如下所示：

```
if ($answerCheckbox.is(':checked') || <?php echo $tot; ?> > 0) { 
```

我知道是因为在某些情况下我不得不编写这样的代码。

# iphone - 每次我运行应用程序时 UIViewController 框架都会发生变化

> ID：12394822
> 
> 赞同：0
> 
> 时间：2012-09-12T19:17:17.800
> 
> 标签：iphone, objective-c, ipad

我有以下代码：

```
 PNRProfileViewController *vc = [[PNRProfileViewController alloc] initWithNibName:@"PNRProfileViewController" bundle:nil];
    vc.delegate = self;
    self.profileVC_ = vc;

    UINavigationController *controller = [[UINavigationController alloc] initWithRootViewController:self.profileVC_];
    AHLog(@"FRAME IS %@", NSStringFromCGRect(self.profileVC_.view.frame));
    controller.view.frame = self.profileVC_.view.frame;
    controller.view.autoresizingMask = self.profileVC_.view.autoresizingMask;

    self.currentViewController_ = controller; 
```

当我运行这段代码时，我得到的帧高度每次都会改变..它在 416 和 460 之间交替。我不知道为什么会这样。有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:19:24.727

44 像素是导航栏的高度。

要保留导航栏并让您的 nib 尊重其大小，请进入您的 .xib 文件，选择视图，然后在属性选项卡上，将选项卡栏下拉设置为导航栏。

要删除导航栏，请在分配 NavigationController 调用后`controller.navigationBarHidden = YES;`

# php - 使用 QueryPath 从多个页面收集链接

> ID：12394823
> 
> 赞同：0
> 
> 时间：2012-09-12T19:17:19.610
> 
> 标签：php, arrays, querypath

我有一个函数，它传递了一个 url 数组。每个网页都会有一系列指向其他页面的链接。我想从传递给此函数的每个网页返回这些链接的完整列表。我被困在如何在每个循环中组合数组。

```
 function getitemurls ($pagelinks) {
 global $host;
 foreach($pagelinks as $link) {
   $circdl = my_curl($link);
   $circqp = htmlqp($circdl,'body');
   $circlinks = array();
   foreach ($circqp->branch()->top('area[href]') as $item) {
   $circlinks[] = $item->attr('href');
    }
   for ($i = 0; $i < count($circlinks); ++$i) {
   $fullitemurl = join(array($host,$circlinks[$i]));
   }
    }
  return $fullitemurl;
 } 
```

例如：

```
 Webpage 1: page1.html
 <html><body><area shape="rect" href="http://www.google.com" coords="110,151,173,225" alt=""/></body></html>

 Webpage 2: page2.html
      <html><body><area shape="rect" href="http://www.yahoo.com" coords="110,151,173,225" alt=""/></body></html> 
```

这是两个页面的数组：

```
 $array = array (
"0" => "page1.html",
"1" => "page2.html", ); 
```

从这个数组我想返回：

```
 getitemurls($array)
 Array ( [0] => http://www.google.com [1] => http://www.yahoo.com) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T12:23:08.217

我最终只是在循环之前声明了我的数组，然后在循环中这样分配它：

```
 function getitemurls ($pagelinks) {
  global $host;
  $fullitemurls = array();
  foreach($pagelinks as $link) {
   $circdl = my_curl($link);
   $circqp = htmlqp($circdl,'body');
   $circlinks = array();
   foreach ($circqp->branch()->top('area[href]') as $item) {
    $circlinks[] = $item->attr('href');
   }
   for ($i = 0; $i < count($circlinks); ++$i) {
    $fullitemurl[] = join(array($host,$circlinks[$i]));
   }
  }
 return $fullitemurl;
} 
```

# database - 克服 Windows Azure Sql 数据库 150 GB 大小限制

> ID：12394831
> 
> 赞同：19
> 
> 时间：2012-09-12T19:18:02.310
> 
> 标签：database, windows, azure, azure-sql-database

SQL Azure 的数据库大小限制为 150 GB。我已经多次阅读他们的文档并在网上搜索过，但我不清楚这一点：使用联合是否允许开发人员超过 150 GB 的数据库？例如，我可以有几个 150GB 的联盟成员。

如果没有，我如何在 Windows Azure 上处理大于 150 GB 的数据库？

基本上，我如何在 Windows Azure 上向外扩展超过 150 GB

如果没有其他方法是 RDS 一个好的选择（分享任何其他选择）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-12T19:49:43.103

目前不可能拥有大于 150G 的单个数据库。

唯一的方法是将数据拆分到多个数据库中，一个帐户最多可以拥有 149 个用户数据库和主数据库，或者使用 SQL Azure 联合。目前，如果我没记错的话，支持的联邦总数是`Int16.MaxValue - 1`. 每个联邦实际上是一个独立的数据库，对开发者透明，最大可达 150GB。

但是，SQL Azure 联合有其自身的优点和缺点，以及一些数据访问层重构。如果您有兴趣，可以查看 SQL Azure Federations 上的这些很酷的视频：

*   [使用 SQL Azure 构建可扩展的应用程序](http://channel9.msdn.com/events/TechEd/Europe/2012/DBI331)
*   [使用 SQL Azure 数据库联合](http://channel9.msdn.com/Events/TechDays/Techdays-2012-the-Netherlands/2295)

**更新**

我不会完全同意@ryancrawcour。他所解释的只是冰山的顶峰。所需重构的数量实际上取决于应用程序如何使用数据。我将仅提及一些考虑因素（根本不是完整的图片）。考虑以下任何一项：

*   所有联邦通用的数据（您如何获取此数据）
*   存储过程，对数据进行后处理 - 您必须迭代每个联合成员并执行该存储过程。无法执行一次存储过程并在所有联合中处理数据。
*   聚合数据，分布在超过 1 个联邦成员中
*   列出来自多个联盟成员的数据。

这些只是您需要考虑的几个操作，并且不需要在每个查询之前“仅更改连接字符串并执行一个使用联合......”。实际上，使用 SQL Azure Federations，您根本不需要更改连接字符串。都是相同的 SQL Azure 连接字符串。“USE FEDERATION ...”语句是您在每次查询之前执行的语句。但这不仅仅是唯一的事情。如果一个人使用 EntityFramework（模型优先，或代码优先，或其他）怎么样。事情变得更加复杂，需要真正了解 SQL Azure 联合。

我想说的是，SQL Azure 联合是思考数据、建模和规范化的不同方式。

**更新 2 - Microsoft 宣布的新数据库大小**

自 2014 年 4 月 3 日起，单个数据库的最大大小已增加到 500GB。迄今为止唯一可用的信息在[这里](http://www.microsofttrends.com/2014/04/03/improvements-to-azure-sqlincreased-size-limit-to-500-gb-and-an-improved-sla-at-99-95/)。请注意，管理门户仍未显示此选项（截至今天和现在：4\. 2014 年 4 月，格林威治标准时间 15:00+0:00）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T04:05:49.057

还有持久性 VM 的新 Azure 功能（当前处于预览状态），它允许您将本地应用程序迁移到云中，而只需进行最少的更改。

进一步阅读：[基础架构即服务系列：在 Windows Azure 虚拟机中运行 SQL Server](http://blogs.msdn.com/b/windowsazure/archive/2012/06/21/virtual-machines-series-running-sql-server-in-a-windows-azure-virtual-machine.aspx) 。[本](http://social.technet.microsoft.com/wiki/contents/articles/11871.learning-about-running-sql-server-in-windows-azure-virtual-machine-en-us.aspx)指南也可能会有所帮助。

**编辑**

[这](http://blogs.msdn.com/b/windowsazure/archive/2012/06/26/data-series-sql-server-in-windows-azure-virtual-machine-vs-sql-database.aspx)是与 Sql Azure 的比较

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T09:37:56.780

不久前我一直在寻找这些相同的答案。除了 Anton 提供的答案（非常准确）之外，我发现您可以通过负载平衡和镜像使您的 WAVM 与 SQL Server 安装冗余。

WASD 的优势在于一切都是自动化的。例如，当您的 WAVM 实例从负载均衡器的路由中取出时，您需要自己启动一个新实例。WASD 负责所有这些。

使用 WASD Federations，您可以扩展到 75TB 的数据（如果我没记错的话），而使用带有 SQL Server 的 WAVM，您可以扩展到 16TB。

此外，使用 WASD 联合，您可以更精细地划分 SQL 工作负载。

问候，

帕特里克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-03T17:03:51.933

在考虑您的扩展选项时，请注意，截至 2014 年 4 月 3 日，Microsoft 宣布即将对 SQL Premium 进行更改，包括将每个 SQL 数据库实例扩展至 500GB 的能力（以及异地复制、自助恢复和更高的正常运行时间 SLA ）。尚未宣布日期，但您可以在[此处](http://blogs.msdn.com/b/windowsazure/archive/2014/04/04/sql-database-updates-coming-soon-to-the-premium-preview.aspx)阅读有关公告的详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-29T20:01:28.593

现在有一个 1 Terrabyte 层可用 - 请参阅[https://azure.microsoft.com/en-us/pricing/details/sql-database/](https://azure.microsoft.com/en-us/pricing/details/sql-database/)并查看高级级别。

# sql - 为组选择第二和第三高的数字

> ID：12394833
> 
> 赞同：1
> 
> 时间：2012-09-12T19:18:06.713
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一张桌子：

```
CREATE TABLE [dbo].[TargettingReport](
    [MLISNPI] [varchar](50) NULL,
    [CLIENT_ID1] [varchar](50) NULL,
    [Sum of count] [int] NULL
) ON [PRIMARY] 
```

我正在尝试根据以下标准选择第二和第三高`SUM OF COUNT`的`MLISNPI, CLIENT_ID1`

这就是我如何为**每个独特的事件**获得最大值`MLISNPI, CLIENT_ID1`：

```
 select [MLISNPI],[CLIENT_ID1],MAX([Sum of count])
  from [TargettingReport]
  group by 
  [MLISNPI],[CLIENT_ID1] 
```

问题是我如何获得第二和第三高？

这是一些示例数据：

```
+---------+------------+--------------+
| MLISNPI | CLIENT_ID1 | sum of count |
+---------+------------+--------------+
|  567890 |     214060 |           18 |
|  678901 |     214060 |           58 |
|  789012 |     214060 |           27 |
|  891012 |     214060 |            1 |
|  101112 |     214060 |           23 |
|  003001 |     101596 |            0 |
|  003001 |     101522 |          436 |
|  003001 |     101597 |            0 |
|  003002 |     102165 |           66 |
|  003002 |     100062 |            1 |
|  003002 |     211074 |         1229 |
|  003006 |     102235 |           21 |
|  003014 |     213926 |            5 |
|  003016 |     213143 |            3 |
|  003023 |     213801 |           55 |
|  003023 |     212876 |           44 |
|  003023 |     100218 |            0 |
|  003028 |     211144 |          133 |
|  003041 |     100236 |          346 |
|  003041 |     103164 |           65 |
|  003051 |     213402 |          157 |
|  003058 |     100572 |           28 |
|  003065 |     101632 |           29 |
|  003071 |     213632 |            6 |
|  003072 |     101506 |            4 |
|  003081 |     100087 |          398 |
|  003083 |     214311 |            7 |
|  003117 |     210178 |          203 |
|  003121 |     214008 |            9 |
|  003139 |     102179 |         1635 |
|  003147 |     216022 |           21 |
|  003149 |     211425 |            1 |
|  003186 |     215748 |            1 |
+---------+------------+--------------+ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:52:51.967

```
; with numbered as
(
  select *,
      -- Assign number to each record
      -- Numbering is separate for each pair of MLISNPI and CLIENT_ID1
      -- Highest [Sum of desc] will get number 1 and so forth
         row_number() over (partition by [MLISNPI], [CLIENT_ID1]
                            order by [Sum of count] desc) rn
    from [TargettingReport]
)
select [MLISNPI],
       [CLIENT_ID1], 
       [Sum of count]
  from numbered
-- Now one can filter ranks
 where rn between 2 and 3 
```

**更新**：围绕 mlisnpi 旋转 [计数总和]

```
; with numbered as
(
  select mlisnpi,
         [sum of count],
      -- Assign number to each record
      -- Numbering is separate for each MLISNPI
      -- Highest [Sum of desc] will get number 1 and so forth
         row_number() over (partition by [MLISNPI]
                            order by [Sum of count] desc) rn
    from [TargettingReport]
)
select mlisnpi,
       [1] Rank1,
       [2] Rank2,
       [3] Rank3
  from numbered
 pivot (max([Sum of count]) for rn in ([1], [2], [3])) p 
```

[Sql Fiddle 在这里](http://sqlfiddle.com/#!3/24eee/6)。

如果您实际上想要 Cliend_ID1 而不是 [Sum of count]，只需将所有出现的 [Sum of count] 替换为 Client_ID1。不要将 Client_ID1 添加到 cte，因为 pivot 会将其包含在结果中，并在其自己的行中显示 mlisnpi 和 Client_ID1 的每个组合。

**UPDATE2**：包含标题的旋转。更详细一点，因为您需要合并所有标题（client_id1）并操纵行号以获得标题和总和的正确组合。您还需要将所有数据类型转换为相同的数据类型（此处为 varchar）才能使用`union all`.

```
; with numbered as
(
  select *,
         row_number() over (partition by [MLISNPI]
                            order by [Sum of count] desc) rn
    from [TargettingReport]
),
unioned as
(
  select mlisnpi,
         convert(varchar(20), [Sum of count]) value,
         rn * 2 rn
    from numbered
   union all
   select mlisnpi,
       convert(varchar(20), [Client_ID1]),
       rn * 2 - 1
    from numbered
)
select mlisnpi,
       [1] Client1,
       [2] Rank1,
       [3] Client2,
       [4] Rank2,
       [5] Client3,
       [6] Rank3
  from unioned
 pivot (max(value) for rn in ([1], [2], [3], [4], [5], [6])) p 
```

[Sql Fiddle 在这里](http://sqlfiddle.com/#!3/24eee/9)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T21:26:47.073

创建 3 个最高值的视图

```
CREATE VIEW TESTVIEW

AS

SELECT ABB4.[MLISNPI], ABB4.[CLIENT_ID1], MAX(ABB4.[SUM OF COUNT]) AS NEW3
FROM TARGETTINGREPORT AS ABB4
    LEFT JOIN (SELECT ABB2.[MLISNPI], ABB2.[CLIENT_ID1], MAX([SUM OF COUNT]) AS NEW2
                FROM TARGETTINGREPORT AS ABB2
                LEFT JOIN (SELECT [MLISNPI], [CLIENT_ID1], MAX([SUM OF COUNT]) AS NEW1
                            FROM TARGETTINGREPORT GROUP BY MLISNPI, [CLIENT_ID1]) 
                AS ABB1 ON ABB1.MLISNPI = ABB2.MLISNPI AND ABB1.NEW1 = ABB2.[SUM OF COUNT] and ABB1.CLIENT_ID1 = ABB2.CLIENT_ID1
                WHERE ABB1.MLISNPI IS NULL
                GROUP BY ABB2.MLISNPI, ABB2.[CLIENT_ID1])
     AS ABB3 ON ABB3.MLISNPI = ABB4.MLISNPI AND ABB3.NEW2 = ABB4.[SUM OF COUNT] AND ABB3.CLIENT_ID1 = ABB4.CLIENT_ID1
     LEFT JOIN (SELECT ABB5.[MLISNPI], ABB5.[CLIENT_ID1], MAX([SUM OF COUNT]) AS NEW4
                FROM TARGETTINGREPORT AS ABB5
                GROUP BY ABB5.MLISNPI, ABB5.[CLIENT_ID1]) 
                AS ABB6 ON ABB6.MLISNPI = ABB4.MLISNPI AND ABB6.NEW4 = ABB4.[SUM OF COUNT] AND ABB6.CLIENT_ID1 = ABB4.CLIENT_ID1
WHERE ABB3.MLISNPI IS NULL AND ABB6.MLISNPI IS NULL             
GROUP BY ABB4.MLISNPI, ABB4.[CLIENT_ID1]

UNION ALL

SELECT ABB2.[MLISNPI], ABB2.[CLIENT_ID1], MAX([SUM OF COUNT]) AS NEW2
FROM TARGETTINGREPORT AS ABB2
    LEFT JOIN (SELECT [MLISNPI], [CLIENT_ID1], MAX([SUM OF COUNT]) AS NEW1
                FROM TARGETTINGREPORT GROUP BY MLISNPI, [CLIENT_ID1]) 
                AS ABB1 ON ABB1.MLISNPI = ABB2.MLISNPI AND ABB1.NEW1 = ABB2.[SUM OF COUNT] AND ABB1.CLIENT_ID1 = ABB2.CLIENT_ID1
WHERE ABB1.MLISNPI IS NULL
GROUP BY ABB2.MLISNPI, ABB2.[CLIENT_ID1]

UNION ALL

SELECT [MLISNPI], [CLIENT_ID1], MAX([SUM OF COUNT]) AS NEW1
FROM TARGETTINGREPORT 
GROUP BY MLISNPI, [CLIENT_ID1] 
```

然后创建另一个视图

```
CREATE VIEW TESTVIEW2

AS

SELECT ABB1.MLISNPI, ABB1.CLIENT_ID1, ABB1.NEW3
FROM TESTVIEW AS ABB1
    LEFT JOIN (SELECT MLISNPI, CLIENT_ID1, MIN(NEW3) AS VAR1
                FROM TESTVIEW
                GROUP BY MLISNPI, CLIENT_ID1) AS ABB2
    ON ABB2.MLISNPI = ABB1.MLISNPI AND ABB2.CLIENT_ID1 = ABB1.CLIENT_ID1 AND ABB2.VAR1 = ABB1.NEW3
    LEFT JOIN (SELECT MLISNPI, CLIENT_ID1, MAX(NEW3) AS VAR2
                FROM TESTVIEW
                GROUP BY MLISNPI, CLIENT_ID1) AS ABB3
    ON ABB3.MLISNPI = ABB1.MLISNPI AND ABB3.CLIENT_ID1 = ABB1.CLIENT_ID1 AND ABB3.VAR2 = ABB1.NEW3          
WHERE ABB2.MLISNPI IS NULL AND ABB3.MLISNPI IS NULL 
```

最后以枢轴形式调用 3 个最高值

```
SELECT TESTVIEW.MLISNPI, TESTVIEW.CLIENT_ID1, MAX(TESTVIEW.NEW3) AS '1', TESTVIEW2.NEW3 AS '2', MIN(TESTVIEW.NEW3) AS '3'
FROM TESTVIEW
    LEFT JOIN TESTVIEW2 ON TESTVIEW2.MLISNPI = TESTVIEW.MLISNPI AND TESTVIEW2.CLIENT_ID1 = TESTVIEW.CLIENT_ID1
GROUP BY TESTVIEW.MLISNPI, TESTVIEW.CLIENT_ID1, TESTVIEW2.NEW3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:20:20.670

您可以执行 where rownum < 3 并从您的选择中删除最大值吗？

```
select top 3 [MLISNPI],[CLIENT_ID1], Max([Sum of count]) COUNTS
from [TargettingReport]
group by 
[MLISNPI],[CLIENT_ID1]
ORDER by [Sum of count] desc 
```

# windows-phone-7 - 垂直拉伸 WebBrowser 以适应内容

> ID：12394834
> 
> 赞同：0
> 
> 时间：2012-09-12T19:18:12.237
> 
> 标签：windows-phone-7, xaml

当我有一个 WebBrowser 控件时，我在页面布局方面遇到了一些问题。

这是我的 XAML 的重要部分：

```
<Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!--TitlePanel contains the name of the application and page title-->
    <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,12">
        <TextBlock x:Name="ApplicationTitle" Text="MY APPLICATION" Style="{StaticResource PhoneTextNormalStyle}"/>
        <TextBlock x:Name="PageTitle" Text="{Binding Title}" Margin="9,-7,0,0" Style="{StaticResource PhoneTextExtraLargeStyle}"/>
    </StackPanel>

    <!--ContentPanel - place additional content here-->
    <StackPanel Grid.Row="1" Margin="12,17,0,12">
        <phone:WebBrowser Name="HtmlBody" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Red" Margin="12,17,0,28"/>
    </StackPanel>
</Grid> 
```

我的问题是如何制作 WebBrowser streatch。将其属性设置为 auto 无济于事。如果我这样做，它默认高度为 0。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T08:32:23.983

使用 Grid 而不是 StackPanel，并将第二行的高度设置为“*”，如下所示：

```
<Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!--TitlePanel contains the name of the application and page title-->
    <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,12">
        <TextBlock x:Name="ApplicationTitle" Text="MY APPLICATION" Style="{StaticResource PhoneTextNormalStyle}"/>
        <TextBlock x:Name="PageTitle" Text="{Binding Title}" Margin="9,-7,0,0" Style="{StaticResource PhoneTextExtraLargeStyle}"/>
    </StackPanel>

    <!--ContentPanel - place additional content here-->
    <Grid Grid.Row="1" Margin="12,17,0,12">
        <phone:WebBrowser Name="HtmlBody" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Red" Margin="12,17,0,28"/>
    </Grid>
</Grid> 
```

# google-maps - 如何从 Google Map API v3 地图中删除路线？

> ID：12394836
> 
> 赞同：1
> 
> 时间：2012-09-12T19:18:33.073
> 
> 标签：google-maps, google-maps-api-3

我是 API 的新手，我有这个来创建我的地图，但我想了解行车路线，我应该改变什么来实现这一点。我有大量从 MySQL 渲染的标记，所以我不需要重新开始，只需删除方向即可。

[这](http://digihaul.com/index.php?action=mapoptions)是网页。

这是渲染地图的代码：

```
var directionsService = new google.maps.DirectionsService(); 
var directionsDisplay = new google.maps.DirectionsRenderer(); 

var myOptions = { 
  zoom:7, 
  mapTypeId: google.maps.MapTypeId.ROADMAP 
} 

var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
directionsDisplay.setMap(map); 

var request = { 
    origin: '<?php echo $orgcitname; ?>',  
    destination: '<?php echo $descitname; ?>', 
    travelMode: google.maps.DirectionsTravelMode.DRIVING 
}; 

directionsService.route(request, function(response, status) { 
   if (status == google.maps.DirectionsStatus.OK) { 
      directionsDisplay.setDirections(response); 
   } 
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:46:00.820

要从地图中删除路线，您可以不带任何参数调用 google.maps.DirectionsRenderer 的 setMap() 函数。所以在你的情况下：

```
directionsDisplay.setMap(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:24:24.410

```
 var myOptions = { 
     zoom:7, 
     mapTypeId: google.maps.MapTypeId.ROADMAP 
   } 

   var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions); 
```

那只会给你留下你的地图..没有方向..

# ios - UITextField 委托不起作用

> ID：12394840
> 
> 赞同：0
> 
> 时间：2012-09-12T19:18:42.247
> 
> 标签：ios, uitextfield, uitextfielddelegate

我有以下代码：

```
@interface MyCell : UITableViewCell<UITextFieldDelegate>
{
    IBOutlet UITextField *txtFields;
}

- (IBAction)textFieldAction:(id)sender;
@property (nonatomic,retain) IBOutlet UITextField *txtFields;

@end 
```

我还有以下委托功能：

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField {
    return NO;
} 
```

但是，我注意到它永远不会被调用。我从界面构建器以及代码中设置了委托：`[txtFields setDelegate:self];`但似乎都不起作用。我还缺少其他什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T22:41:33.543

您显然将它与 a 结合使用`UITableView`。首先，如果要支持用户交互，txtFields 必须是单元格的子视图`contentView`，而不是 backgroundView。

假设 txtFields 对象是 的子视图`contentView`，那么让我们看看连接。

tableView 有一个方法`cellForRowAtIndexPath:`，您可以在其中返回新单元格或回收的单元格。在该单元格的最底部，添加：

```
NSLog(@"textFields=%@ delegate=%@", cell.txtFields, cell.txtFields.delegate);
assert(cell.txtFields.delegate == cell); // lets make sure this is proper 
```

如果事实上这两个参数都存在，那么您现在知道 txtFields 对象位于正确的容器 ( `contentView`) 中，该属性正在工作，并且委托已设置为单元格。

如果一切正常，并且您在点击时没有得到键盘，那么很可能是其他东西覆盖了 txtFields - 其他一些透明视图和它吃掉了触摸。

在这种情况下，您应该使用 MyCell 类组合一个小演示应用程序，即使只有一个硬编码的单元格来演示问题，然后将其上传（压缩）到您的 DropBox 帐户，像我这样的其他人可以查看它并找到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T14:04:12.823

尝试删除：

> { IBOutlet UITextField *txtFields; }

因为你已经`@property`有了。

还有，你有`@synthesize txtFields;`吗？

# lua - 在迭代时安全地从数组表中删除项目

> ID：12394841
> 
> 赞同：38
> 
> 时间：2012-09-12T19:18:50.007
> 
> 标签：lua

*这个问题类似于[如何在删除键时安全地迭代 lua 表，](https://stackoverflow.com/questions/6167555/how-can-i-safely-iterate-a-lua-table-while-keys-are-being-removed)但明显不同。*

### 概括

给定一个 Lua 数组（键是从 开始的顺序整数的表`1`），遍历这个数组*并删除一些条目*的最佳方法是什么？

### 现实世界的例子

我在 Lua 数组表中有一组带时间戳的条目。条目总是添加到数组的末尾（使用`table.insert`）。

```
local timestampedEvents = {}
function addEvent( data )
  table.insert( timestampedEvents, {getCurrentTime(),data} )
end 
```

我需要偶尔浏览这个表（按顺序）并处理和删除某些条目：

```
function processEventsBefore( timestamp )
  for i,stamp in ipairs( timestampedEvents ) do
    if stamp[1] <= timestamp then
      processEventData( stamp[2] )
      table.remove( timestampedEvents, i )
    end
  end
end 
```

不幸的是，上述方法的代码中断了迭代，跳过了一些条目。有没有比手动遍历索引更好（打字更少，但仍然安全）的方法：

```
function processEventsBefore( timestamp )
  local i = 1
  while i <= #timestampedEvents do -- warning: do not cache the table length
    local stamp = timestampedEvents[i]
    if stamp[1] <= timestamp then
      processEventData( stamp[2] )
      table.remove( timestampedEvents, i )
    else
      i = i + 1
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-12T23:47:05.443

> 遍历数组并在继续迭代的同时从中间删除随机项的一般情况

如果您从前到后迭代，当您删除元素 N 时，迭代中的下一个元素 (N+1) 将向下移动到该位置。如果您增加迭代变量（如 ipairs 所做的那样），您将跳过该元素。我们有两种方法可以解决这个问题。

使用此示例数据：

```
 input = { 'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p' }
    remove = { f=true, g=true, j=true, n=true, o=true, p=true } 
```

我们可以`input`通过以下方式在迭代期间删除元素：

1.  从后往前迭代。

    ```
    for i=#input,1,-1 do
        if remove[input[i]] then
            table.remove(input, i)
        end
    end 
    ```

2.  手动控制循环变量，因此我们可以在删除元素时跳过递增它：

    ```
    local i=1
    while i <= #input do
        if remove[input[i]] then
            table.remove(input, i)
        else
            i = i + 1
        end
    end 
    ```

对于非数组表，您使用`next`or `pairs`（根据 实现`next`）进行迭代，并将要删除的项目设置为`nil`。

请注意，`table.remove`每次调用时都会移动所有后续元素，因此 N 删除的性能是指数级的。如果您要删除很多元素，您应该像 LHF 或 Mitch 的回答那样自己移动这些项目。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2018-10-29T03:51:57.090

# 效率！

**警告：不要使用 table.remove()。每次调用该函数以删除数组条目时，该函数都会重新索引所有后续（后续）数组索引。因此，在单次直通 OURSELVES 中“压缩/重新索引”表要快得多！**

最好的技术很简单：向上计数 ( `i`) 通过所有数组条目，同时跟踪我们应该将下一个“保留”值放入 ( `j`) 的位置。任何未保留的（或从`i`to移动的`j`）都设置为`nil`告诉 Lua 我们已经删除了该值。

我正在分享这个，因为我真的不喜欢这个页面上的其他答案（截至 2018 年 10 月）。它们要么是错误的，要么是错误的，要么是过于简单的，要么是过于复杂的，而且大多数都是超慢的。所以我实现了一种高效、干净、*超快速的一次性算法*。使用单循环。

这是一个完整注释的示例（本文末尾有一个较短的非教程版本）：

```
function ArrayShow(t)
    for i=1,#t do
        print('total:'..#t, 'i:'..i, 'v:'..t[i]);
    end
end

function ArrayRemove(t, fnKeep)
    print('before:');
    ArrayShow(t);
    print('---');
    local j, n = 1, #t;
    for i=1,n do
        print('i:'..i, 'j:'..j);
        if (fnKeep(t, i, j)) then
            if (i ~= j) then
                print('keeping:'..i, 'moving to:'..j);
                -- Keep i's value, move it to j's pos.
                t[j] = t[i];
                t[i] = nil;
            else
                -- Keep i's value, already at j's pos.
                print('keeping:'..i, 'already at:'..j);
            end
            j = j + 1;
        else
            t[i] = nil;
        end
    end
    print('---');
    print('after:');
    ArrayShow(t);
    return t;
end

local t = {
    'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i'
};

ArrayRemove(t, function(t, i, j)
    -- Return true to keep the value, or false to discard it.
    local v = t[i];
    return (v == 'a' or v == 'b' or v == 'f' or v == 'h');
end); 
```

输出，沿途显示它的逻辑，它是如何移动事物的，等等......

```
before:
total:9 i:1 v:a
total:9 i:2 v:b
total:9 i:3 v:c
total:9 i:4 v:d
total:9 i:5 v:e
total:9 i:6 v:f
total:9 i:7 v:g
total:9 i:8 v:h
total:9 i:9 v:i
---
i:1 j:1
keeping:1   already at:1
i:2 j:2
keeping:2   already at:2
i:3 j:3
i:4 j:3
i:5 j:3
i:6 j:3
keeping:6   moving to:3
i:7 j:4
i:8 j:4
keeping:8   moving to:4
i:9 j:5
---
after:
total:4 i:1 v:a
total:4 i:2 v:b
total:4 i:3 v:f
total:4 i:4 v:h 
```

最后，这是在您自己的代码中使用的函数，没有所有的教程打印......并且只有一些最小的注释来解释最终算法：

```
function ArrayRemove(t, fnKeep)
    local j, n = 1, #t;

    for i=1,n do
        if (fnKeep(t, i, j)) then
            -- Move i's kept value to j's position, if it's not already there.
            if (i ~= j) then
                t[j] = t[i];
                t[i] = nil;
            end
            j = j + 1; -- Increment position of where we'll place the next kept value.
        else
            t[i] = nil;
        end
    end

    return t;
end 
```

就是这样！

如果您不想使用整个“可重用回调/函数”设计，您可以简单地将内部代码复制`ArrayRemove()`到您的项目中，并将行更改`if (fnKeep(t, i, j)) then`为`if (t[i] == 'deleteme') then`... 这样您就可以摆脱函数调用/callback 开销也更大，而且速度更快！

就个人而言，我使用可重复使用的回调系统，因为它的速度仍然大大`table.remove()`提高了 100-1000 倍以上。

> **奖励（高级用户）**：普通用户可以跳过阅读此奖励部分。它描述了如何同步多个相关表。请注意， 的第三个参数`fnKeep(t, i, j)`,`j`是一个奖励参数，它允许您的保持函数知道在`fnKeep`回答时将值存储在哪个索引处`true`（以保持该值）。
> 
> 用法示例：假设您有两个“链接”表，其中一个是`table['Mitch'] = 1; table['Rick'] = 2;`（通过命名字符串快速查找数组索引的哈希表），另一个是 `array[{Mitch Data...}, {Rick Data...}]`（具有数字索引的数组，其中 Mitch 的数据位于 pos`1`和 Rick 的数据是在 pos `2`，完全按照哈希表中的描述）。现在您决定遍历`array`and remove `Mitch Data`，从而`Rick Data`从一个位置移动到另一个`2`位置`1`......
> 
> 然后，您的`fnKeep(t, i, j)`函数可以轻松地使用该`j`信息来更新哈希表指针，以确保它们始终指向正确的数组偏移量：
> 
> ```
> local hData = {['Mitch'] = 1, ['Rick'] = 2};
> local aData = {
>     {['name'] = 'Mitch', ['age'] = 33}, -- [1]
>     {['name'] = 'Rick', ['age'] = 45}, -- [2]
> };
> 
> ArrayRemove(aData, function(t, i, j)
>     local v = t[i];
>     if (v['name'] == 'Rick') then -- Keep "Rick".
>         if (i ~= j) then -- i and j differing means its data offset will be moved if kept.
>             hData[v['name']] = j; -- Point Rick's hash table entry at its new array location.
>         end
>         return true; -- Keep.
>     else
>         hData[v['name']] = nil; -- Delete this name from the lookup hash-table.
>         return false; -- Remove from array.
>     end
> end); 
> ```
> 
> 从而从查找哈希表和数组中删除“Mitch”，并将“Rick”哈希表条目移动到其数组数据被移动到的位置`1`（即 的值）（*因为 i 和 j 不同，表示正在移动数据*）。`j`
> 
>  *这种算法允许您的相关表保持完美同步，由于`j` 参数，始终指向正确的数据位置。
> 
> 对于需要该功能的人来说，这只是一个高级奖励。大多数人可以简单地忽略函数`j`中的参数 `fnKeep()`！*

 *嗯，就是这样，伙计们！

享受！:-)

# 基准（又名“让我们开怀大笑……”）

我决定将此算法与`table.remove()`99.9% 的 Lua 用户正在使用的标准“向后循环并使用”方法进行基准测试。

为了做这个测试，我使用了下面的 test.lua 文件：[https ://pastebin.com/aCAdNXVh](https://pastebin.com/aCAdNXVh)

每个被测试的算法都有 10 个测试数组，每个数组包含 200 万个项目（每个算法测试总共 2000 万个项目）。所有数组中的项目都是相同的（以确保测试的完全公平性）：每第 5 个项目是数字“13”（将被删除），所有其他项目都是数字“100”（将保留）。

嗯...我`ArrayRemove()`的算法测试在 2.8 秒内结束（处理 2000 万个项目）。我现在正在等待`table.remove()`测试完成......到目前为止已经过了几分钟，我越来越无聊............更新：还在等待......更新：我饿了......更新：你好……今天？！更新：Zzz...更新：还在等待...更新：............更新：好的，`table.remove()`代码（这是大多数 Lua 用户正在使用的方法）将采取几天。我会在它完成的那一天更新。

自我注意：我于 2018 年 11 月 1 日 ~04:55 GMT 开始运行测试。我的`ArrayRemove()`算法在 2.8 秒内完成......内置的 Lua`table.remove()`算法目前仍在运行......我会更新这个稍后发布... ;-)

**更新：**现在是 2018 年 11 月 1 日格林威治标准时间 14:55，`table.remove()`算法**仍未**完成。我将中止那部分测试，因为 Lua 在过去**10 小时内**一直在使用我 100% 的 CPU ，我现在需要我的电脑。它的热度足以在笔记本电脑的铝制外壳上煮咖啡......

结果如下：

*   处理 10 个包含 200 万个项目的数组（总共 2000 万个项目）：
*   我的`ArrayRemove()`功能：2.8秒。
*   普通 Lua `table.remove()`：我决定在Lua 使用 100% CPU *10 小时后**退出*测试。因为我现在需要使用我的笔记本电脑！;-)

 *这是我按下 Ctrl-C 时的堆栈跟踪......它确认了我的 CPU 在过去 10 小时内一直在处理什么 Lua 函数，哈哈：

```
[     mitch] elapsed time: 2.802

^Clua: test.lua:4: interrupted!
stack traceback:
    [C]: in function 'table.remove'
    test.lua:4: in function 'test_tableremove'
    test.lua:43: in function 'time_func'
    test.lua:50: in main chunk
    [C]: in ? 
```

如果我让`table.remove()`测试运行完成，可能需要几天时间......欢迎任何不介意浪费大量电力的人重新运行此测试（文件在 pastebin 上面），让我们大家知道花了多长时间。

为什么`table.remove()`这么慢？仅仅是因为对该函数的*每次调用都必须重复地**重新索引* 我们告诉它删除*之后*存在的**每个表项！**因此，要删除 200 万项数组中的第一项，它必须将所有其他 200 万项的索引向下移动 1 个插槽以填补删除造成的空白。然后......当你删除另一个项目时......它必须*再次*移动所有其他 200 万个项目......它一遍又一遍地这样做......

 **你不应该，**永远**使用`table.remove()`！它的性能损失迅速增长。这是一个具有较小数组大小的示例，以证明这一点：

*   10 个包含 1,000 个项目的数组（总共 10k 个项目）`ArrayRemove()`：：0.001 秒，`table.remove()`：0.018 秒（慢 18 倍）。
*   10 个包含 10,000 个项目的数组（总共 100k 个项目）`ArrayRemove()`：：0.014 秒，`table.remove()`：1.573 秒（慢 112.4 倍）。
*   10 个 100,000 项的数组（总共 1m 项）`ArrayRemove()`：：0.142 秒，`table.remove()`：3 分 48 秒（慢 1605.6 倍）。
*   10 个包含 2,000,000 项的数组（总共 20m 项）`ArrayRemove()`：：2.802 秒，`table.remove()`：我决定在 10 小时后中止测试，所以我们现在可能永远不会花多长时间。;-) 但是在当前时间点（甚至还没有完成），它花费的时间比`ArrayRemove()`……长 12847.9 倍，但`table.remove()`如果我让它完成，最终结果可能会慢 30-40000 倍左右。

如您所见，`table.remove()`的时间增长不是线性的（因为如果是这样，那么我们的 100 万项测试将只花费 10 万（100k）项测试的 10 倍，但我们看到的是 1.573 秒与 3 分 48 秒！ ）。所以我们不能进行较低的测试（例如 10k 个项目）并简单地将其乘以*1000 万*个项目来知道我中止的测试需要多长时间*......*所以如果有人*真的*对最终结果感到好奇，你会必须自己运行测试并在几天后发表评论`table.remove()`......

但是在这一点上，我们*可以*做的是，根据我们目前的基准，说这些话：F-ck `table.remove()`！;-)

没有理由调用该函数。**曾经**。因为如果要从表中删除项目，只需使用`t['something'] = nil;`. 如果要从数组（具有数字索引的表）中删除项目，请使用`ArrayRemove()`.

顺便说一句，上面的测试都是使用 执行`Lua 5.3.4`的，因为这是大多数人使用的标准运行时。我决定使用`LuaJIT 2.0.5`( `JIT: ON CMOV SSE2 SSE3 SSE4.1 fold cse dce fwd dse narrow loop abc sink fuse`) 快速运行主要的“2000 万项”测试，它比标准 Lua 运行时更快。2000 万个项目的结果`ArrayRemove()`是：Lua 为 2.802 秒，LuaJIT 为 0.092 秒。这意味着如果您的代码/项目在 LuaJIT 上运行，您可以期待我的算法获得*更快的性能！*:-)

我还使用 LuaJIT 最后一次重新运行了“100k 项”测试，以便我们可以看到`table.remove()`在 LuaJIT 中的执行情况，并查看它是否比常规 Lua 更好：

*   **[LUAJIT]** 100,000 项的 10 个数组（总共 1m 项）`ArrayRemove()`：：0.005 秒，`table.remove()`：20.783 秒（比 ... 慢 4156.6 倍，但这个*LuaJIT*`ArrayRemove()`结果实际上比普通 Lua 更糟糕，后者“仅”*慢 1605.6 倍*比我的算法做同样的测试...所以如果你使用的是 LuaJIT，性能比*更*支持我的算法！）*`table.remove()`*

 ***最后，您可能想知道“`table.remove()`如果我们只想删除*一个*项目会更快吗，因为它是一个原生函数？”。如果您使用 LuaJIT，该问题的答案是：不。**在 LuaJIT 中，甚至`ArrayRemove()`比`table.remove()`删除 ONE ITEM 还要快。**谁*不*使用 LuaJIT？使用 LuaJIT，与常规 Lua 相比，所有 Lua 代码的速度都轻松提高了 30 倍左右。结果如下：`[mitch] elapsed time (deleting 1 items): 0.008, [table.remove] elapsed time (deleting 1 items): 0.011`。这是“仅删除 1-6 项”测试的 pastebin：[https](https://pastebin.com/wfM7cXtU) ://pastebin.com/wfM7cXtU （文件末尾列出了完整的测试结果）。

TL;DR：无论出于*何种*原因，请勿`table.remove()` *在任何地方*使用！

 *希望你们喜欢`ArrayRemove()`......并且玩得开心，大家！:-)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-09-13T00:13:40.730

`table.remove`一旦设置了不需要的条目，我会避免并遍历数组，`nil`然后在必要时再次遍历数组以压缩它。

这是我想到的代码，使用 Mud 回答中的示例：

```
local input = { 'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p' }
local remove = { f=true, g=true, j=true, n=true, o=true, p=true }

local n=#input

for i=1,n do
        if remove[input[i]] then
                input[i]=nil
        end
end

local j=0
for i=1,n do
        if input[i]~=nil then
                j=j+1
                input[j]=input[i]
        end
end
for i=j+1,n do
        input[i]=nil
end 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-15T07:11:24.953

试试这个功能：

```
function ripairs(t)
    -- Try not to use break when using this function;
    -- it may cause the array to be left with empty slots
    local ci = 0
    local remove = function()
        t[ci] = nil
    end
    return function(t, i)
        --print("I", table.concat(array, ','))
        i = i+1
        ci = i
        local v = t[i]
        if v == nil then
            local rj = 0
            for ri = 1, i-1 do
                if t[ri] ~= nil then
                    rj = rj+1
                    t[rj] = t[ri]
                    --print("R", table.concat(array, ','))
                end
            end
            for ri = rj+1, i do
                t[ri] = nil
            end
            return
        end
        return i, v, remove
    end, t, ci
end 
```

它不使用`table.remove`，因此它应该具有`O(N)`复杂性。您可以将`remove`函数移动到 for 生成器中以消除对上值的需要，但这意味着每个元素都有一个新的闭包......这不是一个实际问题。

示例用法：

```
function math.isprime(n)
    for i = 2, n^(1/2) do
        if (n % i) == 0 then
            return false
        end
    end
    return true
end

array = {}
for i = 1, 500 do array[i] = i+10 end
print("S", table.concat(array, ','))
for i, v, remove in ripairs(array) do
    if not math.isprime(v) then
        remove()
    end
end
print("E", table.concat(array, ',')) 
```

小心不要使用`break`（或以其他方式过早退出循环），因为它会使数组留下`nil`元素。

如果你想说`break`“中止”（如，没有删除任何内容），你可以这样做：

```
function rtipairs(t, skip_marked)
    local ci = 0
    local tbr = {} -- "to be removed"
    local remove = function(i)
        tbr[i or ci] = true
    end
    return function(t, i)
        --print("I", table.concat(array, ','))
        local v
        repeat
            i = i+1
            v = t[i]
        until not v or not (skip_marked and tbr[i])
        ci = i
        if v == nil then
            local rj = 0
            for ri = 1, i-1 do
                if not tbr[ri] then
                    rj = rj+1
                    t[rj] = t[ri]
                    --print("R", table.concat(array, ','))
                end
            end
            for ri = rj+1, i do
                t[ri] = nil
            end
            return
        end
        return i, v, remove
    end, t, ci
end 
```

这样做的好处是能够取消整个循环而不删除任何元素，并提供跳过已标记为“要删除”的元素的选项。缺点是新表的开销。

我希望这些对你有帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-09T12:28:40.717

`table.remove`出于性能原因（这可能或多或少与您的特定情况相关），我建议不要使用。

以下是这种类型的循环对我来说通常的样子：

```
local mylist_size = #mylist
local i = 1
while i <= mylist_size do
    local value = mylist[i]
    if value == 123 then
        mylist[i] = mylist[mylist_size]
        mylist[mylist_size] = nil
        mylist_size = mylist_size - 1
    else
        i = i + 1
    end
end 
```

**注意**这很快，但有两个警告：

*   如果您需要删除相对较少的元素，它会更快。（它实际上对应该保留的元素不起作用）。
*   它将使数组未排序。有时您并不关心排序数组，在​​这种情况下，这是一个有用的“快捷方式”。

如果您想保留元素的顺序，或者您希望不保留大部分元素，请查看 Mitch 的解决方案。这是我和他的粗略比较。我在[https://www.lua.org/cgi-bin/demo](https://www.lua.org/cgi-bin/demo)上运行它，大多数结果与此类似：

```
[    srekel] elapsed time: 0.020
[     mitch] elapsed time: 0.040
[    srekel] elapsed time: 0.020
[     mitch] elapsed time: 0.040 
```

当然，请记住，它会因您的特定数据而异。

这是测试的代码：

```
function test_srekel(mylist)
    local mylist_size = #mylist
    local i = 1
    while i <= mylist_size do
        local value = mylist[i]
        if value == 13 then
            mylist[i] = mylist[mylist_size]
            mylist[mylist_size] = nil
            mylist_size = mylist_size - 1
        else
            i = i + 1
        end
    end

end -- func

function test_mitch(mylist)
    local j, n = 1, #mylist;

    for i=1,n do
        local value = mylist[i]
        if value ~= 13 then
            -- Move i's kept value to j's position, if it's not already there.
            if (i ~= j) then
                mylist[j] = mylist[i];
                mylist[i] = nil;
            end
            j = j + 1; -- Increment position of where we'll place the next kept value.
        else
            mylist[i] = nil;
        end
    end
end

function build_tables()
    local tables = {}
    for i=1, 10 do
      tables[i] = {}
      for j=1, 100000 do
        tables[i][j] = j % 15373
      end
    end

    return tables
end

function time_func(func, name)
    local tables = build_tables()
    time0 = os.clock()
    for i=1, #tables do
        func(tables[i])
    end
    time1 = os.clock()
    print(string.format("[%10s] elapsed time: %.3f\n", name, time1 - time0))
end

time_func(test_srekel, "srekel")
time_func(test_mitch, "mitch")
time_func(test_srekel, "srekel")
time_func(test_mitch, "mitch") 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-01T11:54:17.263

简单的..

```
values = {'a', 'b', 'c', 'd', 'e', 'f'}
rem_key = {}

for i,v in pairs(values) do
if remove_value() then
table.insert(rem_key, i)
end
end

for i,v in pairs(rem_key) do
table.remove(values, v)
end 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-27T11:41:02.870

这基本上是在以非功能性风格重述其他解决方案；我发现这更容易理解（也更难出错）：

```
for i=#array,1,-1 do
  local element=array[i]
  local remove = false
  -- your code here
  if remove then
    array[i] = array[#array]
    array[#array] = nil
  end
end 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-13T12:26:22.357

您可能会考虑使用[优先级队列](http://en.wikipedia.org/wiki/Priority_queue)而不是排序数组。当您按顺序删除条目时，优先级队列将有效地压缩自身。

有关优先队列实现的示例，请参阅此邮件列表线程： http: [//lua-users.org/lists/lua-l/2007-07/msg00482.html](http://lua-users.org/lists/lua-l/2007-07/msg00482.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-12T19:22:35.720

我突然想到——对于我的特殊情况，我只从队列的前面移动条目——我可以通过以下方式更简单地做到这一点：

```
function processEventsBefore( timestamp )
  while timestampedEvents[1] and timestampedEvents[1][1] <= timestamp do
    processEventData( timestampedEvents[1][2] )
    table.remove( timestampedEvents, 1 )
  end
end 
```

但是，我不会接受这个作为答案，因为它不能处理迭代数组并在继续迭代时从中间删除随机项的一般情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-28T11:14:07.637

您可以使用仿函数来检查需要删除的元素。额外的收获是它在 O(n) 中完成，因为它不使用 table.remove

```
function table.iremove_if(t, f)
    local j = 0
    local i = 0
    while (i <= #f) do
        if (f(i, t[i])) then
            j = j + 1
        else
            i = i + 1
        end
        if (j > 0) then
            local ij = i + j
            if (ij > #f) then
                t[i] = nil
            else
                t[i] = t[ij]
            end
        end
    end
    return j > 0 and j or nil -- The number of deleted items, nil if 0
end 
```

用法：

```
table.iremove_if(myList, function(i,v) return v.name == name end) 
```

在你的情况下：

```
table.iremove_if(timestampedEvents, function(_,stamp)
    if (stamp[1] <= timestamp) then
        processEventData(stamp[2])
        return true
    end
end) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-23T17:28:44.340

首先，***一定***要阅读@MitchMcCabers 的帖子，详细说明`table.remove()`.

现在我不是 lua 高手，但我尝试将他的方法与@MartinRudat 的方法结合起来，使用从[@PiFace 的答案修改而来的数组检测方法的辅助。](https://stackoverflow.com/questions/7526223/how-do-i-know-if-a-table-is-an-array#7527013)

根据我的测试，结果成功地从键值表或数组中删除了一个元素。

我希望它是正确的，到目前为止它对我有用！

```
--helper function needed for remove(...)
--I’m not super able to explain it, check the link above
function isarray(tableT)
    for k, v in pairs(tableT) do
        if tonumber(k) ~= nil and k ~= #tableT then
            if tableT[k+1] ~= k+1 then
                return false
            end
        end
    end
    return #tableT > 0 and next(tableT, #tableT) == nil
 end

function remove(targetTable, removeMe)
--check if this is an array
if isarray(targetTable) then
    --flag for when a table needs to squish in to fill cleared space
    local shouldMoveDown = false
    --iterate over table in order
    for i = 1, #targetTable do
        --check if the value is found
        if targetTable[i] == removeMe then
            --if so, set flag to start collapsing the table to write over it
            shouldMoveDown = true
        end
        --if collapsing needs to happen...
        if shouldMoveDown then
            --check if we're not at the end
            if i ~= #targetTable then
                --if not, copy the next value over this one
                targetTable[i] = targetTable[i+1]
            else
                --if so, delete the last value
                targetTable[#targetTable] = nil
            end 
        end
    end
else
    --loop over elements
    for k, v in pairs(targetTable) do
        --check for thing to remove
        if (v == removeMe) then
            --if found, nil it
            targetTable[k] = nil
            break
        end
    end
end
return targetTable, removeMe; 
```

结尾

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-05T07:35:40.860

# **效率！更！)**

关于米奇的变种。它对 nil 有一些浪费分配，这里是具有相同想法的优化版本：

```
function ArrayRemove(t, fnKeep)
    local j, n = 1, #t;
    for i=1,n do
        if (fnKeep(t, i, j)) then
            -- Move i's kept value to j's position, if it's not already there.
            if (i ~= j) then
                t[j] = t[i];
            end
            j = j + 1; -- Increment position of where we'll place the next kept value.
        end
    end
    table.move(t,n+1,n+n-j+1,j);
    --for i=j,n do t[i]=nil end
    return t;
end 
```

## 这是更优化的版本，带有块移动

对于更大的数组和更大的保留块

```
function ArrayRemove(t, fnKeep)
    local i, j, n = 1, 1, #t;
    while i <= n do
        if (fnKeep(t, i, j)) then
            local k = i
            repeat
                i = i + 1;
            until i>n or not fnKeep(t, i, j+i-k)
            --if (k ~= j) then
                table.move(t,k,i-1,j);
            --end
            j = j + i - k;
        end
        i = i + 1;
    end
    table.move(t,n+1,n+n-j+1,j);
    return t;
end 
```

if (k ~= j) 不需要，因为它执行了很多次，但在第一次删除后为“true”。我认为 table.move() 无论如何都会处理索引检查。
table.move(t,n+1,n+n-j+1,j) 等价于“for i=j,n do t[i]=nil end”。
我是 lua 新手，不知道有效的价值复制功能在哪里。在这里，我们将复制 nil n-j+1 次。

关于 table.remove()。我认为它应该利用 table.move() 在一个操作中移动元素。C中的一种memcpy。所以也许它毕竟不是那么糟糕。
@MitchMcMabers，你能更新你的基准吗？你使用 lua >= 5.3 吗？********

# c# - Unity3d：从 C# 对象执行任意 javascript

> ID：12394842
> 
> 赞同：2
> 
> 时间：2012-09-12T19:18:53.107
> 
> 标签：c#, unity3d, expression, unityscript, expression-evaluation

我想

```
string expression = "2+2";

public string evaluateExpresion(expression)
{
   return executeJavascript(expression); // Magic javascript executor
}

Debug.Log(evaluateExpression(expression); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T22:02:21.757

您可以使用所需的功能创建一个 javascript 文件，如果我没有误解您的意思，您可以在您的 c# 文件中调用它们。在您的示例中，您可以创建：

```
// JavaScriptExpressions.js

function executeExpression( x : string ) {
    // Some code here..
} 
```

JavaScript 文件，您可以通过将 js 拖到与您的 c# 文件相同的转换来访问该函数，或者您可以将其拖到不同的转换。或者，如果它未连接到单声道库，您可以将其设置为静态。以下是 c# 的示例代码：

```
// YourCsharp.cs
string expression = "2+2";

public string evaluateExpresion(string expression) { 
    return transform.GetComponent<JavaScriptExpressions>().executeExpression(expression);
}

Debug.Log(evaluateExpression(expression)); 
```

# ruby-on-rails-3 - Rails2 update_without_callbacks 猴子补丁

> ID：12394844
> 
> 赞同：1
> 
> 时间：2012-09-12T19:19:03.543
> 
> 标签：ruby-on-rails-3, rails-3-upgrade

我知道猴子补丁很糟糕，但是我`update_without_callbacks`为我的 Rails2 应用程序提供了以下补丁，但是我很难将它移植到 rails3，因为 Rails3 中不再存在该方法。

这是定义：

```
def update_without_callbacks(attribute_names = @attributes.keys)
   if changed?
     update_creating_new_version_row(attribute_names)
     update_shared_columns
   else
     Rails.logger.info("this record unchanged; skipping update")
   end

   true
end 
```

请建议我应该如何将它移植到 Rails3。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-12T09:37:00.733

它应该被替换为：

```
save(:callbacks => false) 
```

# c# - 如何降低密集多线程计算的 CPU 利用率

> ID：12394853
> 
> 赞同：1
> 
> 时间：2012-09-12T19:19:52.353
> 
> 标签：c#, multithreading, parallel.foreach

我已经实现了元启发式求解器并使用了 .NET 4.0`Parallel.For`和`Parallel.Foreach`. 它在我的中端机器上运行良好。但是搜索过于激烈，消耗太多资源，尤其是低端机器上的CPU时间。

因此，我认为我必须在需要时选择降低搜索强度。我想在不涉及算法的情况下降低 CPU 利用率。如果搜索完成较慢，只要它不会锁定机器并允许其他工作搁置，就可以了。

我正在考虑`Thread.Sleep`使用方法，因为所有线程都是 100% CPU 绑定（无 I/O）。这会降低我需要的 CPU 使用强度吗？有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-13T07:14:28.923

（把头顶在栏杆上方，准备被许多反对票击落..:)

如果您使用不同的线程，我建议如下：

Thread.Priority = ThreadPriority.BelowNormal

所以线程的优先级较低。

[是的，这是 C Sharper 答案的直接副本，但没有后来关于线程池线程和亲和力的编辑。如果您认为这是个好主意 - 支持 C Sharper，而不是我]。

或者，通过任务管理器或其他方式降低整个进程的优先级。这将降低进程中所有线程的“真正”调度优先级（包括“非常糟糕的”线程池线程），并改善其他非 CPU 密集型但应在需要时快速响应的应用程序的用户体验做某事。较低优先级的重度应用程序仍会占用所有剩余的 CPU，如果您决定不编辑本月的销售数据或观看最新的非法下载的版权电影，其性能将与以正常优先级运行时一样好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T19:23:41.063

如果您使用不同的线程，我建议如下：

```
Thread.Priority = ThreadPriority.BelowNormal 
```

所以线程的优先级较低。

## 编辑

好的，这个解决方案只有在不与 ThreadPool 一起使用时才可接受。

这里我不确定，但是关于：

```
Process.ProcessorAffinity 
```

*   获取或设置可以安排在其上运行此进程中的线程的处理器。

如果我们限制核心，我们就有更多的空间来做其他工作，对吧？

# r - 在插入符号中拟合无截距模型

> ID：12394855
> 
> 赞同：15
> 
> 时间：2012-09-12T19:20:01.593
> 
> 标签：r, regression, intercept, r-caret

在 R 中，我指定了一个没有截距的模型，如下所示：

```
data(iris)
lmFit <- lm(Sepal.Length ~ 0 + Petal.Length + Petal.Width, data=iris)
> round(coef(lmFit),2)
Petal.Length  Petal.Width 
        2.86        -4.48 
```

但是，如果我用插入符号拟合相同的模型，则生成的模型将包含一个截距：

```
library(caret)
caret_lmFit <- train(Sepal.Length~0+Petal.Length+Petal.Width, data=iris, "lm")
> round(coef(caret_lmFit$finalModel),2)
 (Intercept) Petal.Length  Petal.Width 
        4.19         0.54        -0.32 
```

我如何告诉`caret::train`排除截距项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-29T23:29:18.857

@rcs 已经告诉您需要更改哪个函数的哪一行。

只需用于`trace`修改该功能：

```
trace(caret::createModel, 
       quote(modFormula <- as.formula(".outcome ~ .-1")), at=5, print=FALSE)
caret_lmFit <- train(Sepal.Length~0+Petal.Length+Petal.Width, data=iris, "lm")
round(coef(caret_lmFit$finalModel),2)
#Petal.Length  Petal.Width 
#        2.86        -4.48 
untrace(caret::createModel) 
```

但是，我不使用插入符号。可能会有无法预料的后果。从模型中排除截距通常也不是一个好主意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-05-29T14:27:22.037

正如链接的 SO 问题[https://stackoverflow.com/a/41731117/7613376](https://stackoverflow.com/a/41731117/7613376)中所讨论的，这适用于插入符号 v6.0.76（并且上面的跟踪答案似乎不再适用于插入符号中的代码重构）：

```
caret_lmFit <- train(Sepal.Length~0+Petal.Length+Petal.Width, data=iris, "lm", 
           tuneGrid  = expand.grid(intercept = FALSE))

> caret_lmFit$finalModel

Call:
lm(formula = .outcome ~ 0 + ., data = dat)

Coefficients:
Petal.Length   Petal.Width  
       2.856        -4.479 
```

# coding-style - 如果我从不使用 k，是否有一种更易读的方式来为 k，v in pairs(my_table) do ... 以 lua 结尾？

> ID：12394863
> 
> 赞同：6
> 
> 时间：2012-09-12T19:20:35.713
> 
> 标签：coding-style, lua

lua中是否有更易读的方式来编写：

```
for k, v in pairs(my_table) do
    myfunction( v )
end 
```

我从不使用 k，所以我想把它从循环控制中取出，所以很明显我只是在迭代这些值。有没有像pairs() 这样的函数只给我一个值列表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T21:03:48.867

没有仅迭代值的标准函数，但如果您愿意，*可以自己编写。*这是这样一个迭代器：

```
function values(t)
  local k, v
  return function()
    k, v = next(t, k)
    return v
  end
end 
```

但通常人们只是使用`pairs`和丢弃第一个变量。在这种情况下，习惯上命名未使用的变量`_`（下划线）以清楚地表明意图。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T19:26:48.463

我见过人们使用`_`变量而不是 k 或 i。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T01:57:00.577

如果您不想要您正在枚举的表的键/值对，为什么要使用pairs() 函数？

例如，这甚至更短：

```
local t = {"asdf", "sdfg", "dfgh"}

for i=1, #t do
    print(t[i])
end 
```

否则，我总是这样做：

```
local t = {"asdf", "sdfg", "dfgh"}

for _,v in pairs(t) do
    print(v)
end 
```

编辑：对于您的场景，您只想枚举具有非数字键的表中的值，您可以做的最清楚的事情可能是编写自己的表迭代器函数，如下所示：

```
local t = {["asdf"] = 1, ["sdfg"] = 2, ["dfgh"] = 3}

function values(tbl)
    local key = nil
    return function()
            key = next(tbl, key)
            return tbl[key]
           end
end

for value in values(t) do
    print(value)
end 
```

那么，很明显你只是在遍历表 t 的值。与pairs()一样，由于它使用next()，因此不能保证按顺序遍历。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T23:43:28.313

这是你的编码风格，真的。如果您可以阅读它并且与它保持一致，那么这无关紧要。

但是，我倾向于使用： `for i,c in` “i”代表“index”，“c”代表“child”，但“v”代表“value”也可以。即使您不使用索引变量，这仍然是一种很好的做法。

您可能会做的另一件事是： `for n = 1, 10` 处理数字时。但再一次，这是你的编码风格，只要它是一致的，你就应该是好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T09:52:16.047

来自[Lua 风格指南](http://lua-users.org/wiki/LuaStyleGuide)：

```
The variable consisting of only an underscore "_" is commonly used as a placeholder when you want to ignore the variable:

for _,v in ipairs(t) do print(v) end
Note: This resembles the use of "_" in Haskell, Erlang, Ocaml, and Prolog languages, where "_" takes the special meaning of anonymous (ignored) variables in pattern matches. In Lua, "_" is only a convention with no inherent special meaning though. Semantic editors that normally flag unused variables may avoid doing so for variables named "_" (e.g. LuaInspect is such a case). 
```

所以我希望下划线 ( `_`) 名称对于未使用的变量更具可读性。

# html - 如何内联显示图像

> ID：12394866
> 
> 赞同：3
> 
> 时间：2012-09-12T19:20:42.823
> 
> 标签：html, positioning, css-position, css

我有一个包含三个图像的导航 div。每个图像都有一个绝对位于图片底部的标题元素。我试图在同一行上显示所有三个彼此相邻的图像，但图片显示为块。

HTML：

```
<div class = "nav">
    <div class = "container">

        <div class = "image">
            <img src = "img1"> 
        </div>
        <div class = "title">
            <p> text1 </p>
        </div>

    </div>

     <div class = "container">

        <div class = "image">
            <img src = "img2"> 
        </div>
        <div class = "title">
            <p> text2 </p>
        </div>

    </div>

     <div class = "container">

        <div class = "image">
            <img src = "img3"> 
        </div>
        <div class = "title">
            <p> text3 </p>
        </div>

    </div>
</div> 
```

CSS：

```
.nav {
    display: inline;
}

.container {
    position: relative;
    width: 100%;
}

.image img {
    width: 30%;
    height: 4.5in;
}

.title {
    width: 30%;
    position: absolute;
    bottom: 0; left: 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T19:54:32.253

您需要先修复您的 HTML 代码。

它是`<div class = "title">`而不是`<div class = "title>`缺少每个标题末尾的“。

然后将浮动添加到您的容器中并放置 30% 的宽度。因为您希望您的图像宽度正确为 30%。

```
.container {
    float:left;
    position: relative;
    width: 30%;
} 
```

当您放置 3 个时间容器时，您要求 100% X 3 对齐，

还在你的 CSS 中创建一个带有 float 的图像类。

```
.image{
    float:left;
} 
```

最后，将 CSS 中 .image img 的宽度更改为 100%，这样它将占据允许的 30% 容器的 100% 位置。

```
 .image img {
    width: 100%;
    height: 4.5in;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T19:34:11.243

您的图像已经设置为内联，麻烦的是，它们的父级不是。你需要这个：

```
container { display: inline-block } 
```

值得注意的是，您有一些您可能并不真正需要的标记

```
 <div class = "title>
        <p> text3 </p>
    </div> 
```

可以用这个代替：

```
 <h1 class="title">text3</h1> 
```

或这个：

```
.container h1 {
    width: 30%;
    position: absolute;
    bottom: 0; left: 0;
} 
```

-剪辑-

```
 <h1>text3</h1> 
```

# mysql - 带有连接或子查询的 MySQL 查询

> ID：12394874
> 
> 赞同：2
> 
> 时间：2012-09-12T19:21:17.020
> 
> 标签：mysql, sql, database

我有这样的架构和查询： [http ://sqlfiddle.com/#!2/7b032/3](http://sqlfiddle.com/#!2/7b032/3)

另外我有这些查询：

```
SELECT COUNT(*) AS 'times', userid, name
FROM main
WHERE comedate <= DATE_SUB(CURDATE(),
                   INTERVAL 5 DAY)
GROUP BY userid ORDER BY times DESC LIMIT 0,2;

SELECT * FROM details WHERE 1; 
```

通过比较两个表的用户 ID 列，我需要加入它们。
我需要具有以下列的输出：
“ `times, userid, name, age, location`”
还应考虑顺序、组和限制。

如果您可以编写一个带有 JOIN 的查询和一个带有子查询的查询，我会很高兴。
我有一张 60k 的桌子，我会比较性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:26:31.460

这个怎么样：

```
select x.times,
  x.userid,
  x.name,
  d.age,
  d.location
from 
(
  SELECT COUNT(*) AS 'times', userid, name
  FROM main
  WHERE comedate <= DATE_SUB(CURDATE(),
                     INTERVAL 5 DAY)
  GROUP BY userid 
) x
left join details d
  on x.userid = d.userid 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/7d6f9/4)

编辑：

```
select x.times,
  x.userid,
  x.name,
  d.age,
  d.location
from 
(
  SELECT COUNT(*) AS 'times', userid, name
  FROM main
  WHERE comedate <= DATE_SUB(CURDATE(),
                     INTERVAL 5 DAY)
  GROUP BY userid
  ORDER BY times DESC 
  LIMIT 0,2
) x
left join details d
  on x.userid = d.userid 
```

# 请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/7d6f9/18)

# ios - AS3 按住按钮连续运行代码 - 适用于 iOS/Android 的 Air

> ID：12394877
> 
> 赞同：5
> 
> 时间：2012-09-12T19:21:19.560
> 
> 标签：ios, actionscript-3, flash, air, touch

我正在用 Flash CS6 开发 iOS 游戏。我有一个基本的运动测试，我把它放在一个`Event.MOUSE_DOWN`处理程序中。

我期待/想要的是当我将手指放在按钮上时，播放器会继续移动，直到我停止触摸屏幕。

但发生的情况是，我必须不断地点击以保持玩家移动——而不是仅仅将手指放在按钮上让玩家继续移动。

我应该使用什么代码来完成我想要的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:30:55.237

为此，您需要在两者之间连续运行一个函数`MouseEvent.MOUSE_DOWN`，`Event.MOUSE_UP`因为 MouseEvent.MOUSE_DOWN 每次按下只会被调度一次。

这是一个简单的脚本来做到这一点：

```
myButton.addEventListener(MouseEvent.MOUSE_DOWN,mouseDown);

function mouseDown(e:Event):void {
    stage.addEventListener(MouseEvent.MOUSE_UP,mouseUp); //listen for mouse up on the stage, in case the finger/mouse moved off of the button accidentally when they release.
    addEventListener(Event.ENTER_FRAME,tick); //while the mouse is down, run the tick function once every frame as per the project frame rate
}

function mouseUp(e:Event):void {
    removeEventListener(Event.ENTER_FRAME,tick);  //stop running the tick function every frame now that the mouse is up
    stage.removeEventListener(MouseEvent.MOUSE_UP,mouseUp); //remove the listener for mouse up
}

function tick(e:Event):void {
    //do your movement
} 
```

顺便说一句，您可能想要使用 TOUCH 事件，因为它为多点触控提供了更大的灵活性。尽管如果您只允许在任何给定时间按下一个项目，这不是问题。

为此，只需添加`Multitouch.inputMode = MultitouchInputMode.TOUCH_POINT`您的文档类，然后用适当的触摸事件替换您的 MouseEvent 侦听器：

`MouseEvent.MOUSE_DOWN`变成：`TouchEvent.TOUCH_BEGIN`
`MouseEvent.MOUSE_UP`变成：`TouchEvent.TOUCH_END`

# ruby-on-rails-3 - Rails redirect_to 在浏览器中显示不正确的 URL

> ID：12394879
> 
> 赞同：0
> 
> 时间：2012-09-12T19:21:20.950
> 
> 标签：ruby-on-rails-3, redirect, jquery-mobile

我有 2 个控制器：游戏和播放器。

1.  游戏创建我的游戏和第一个玩家，并重定向到玩家的“编辑”动作。
2.  用户向玩家提交更新，玩家控制器重定向回游戏“显示”动作。

用户流程运行良好（播放器已更新，并向用户显示游戏展示页面），除了最终提交时浏览器中的 URL 仍显示“www.server.com/players/:id”。如果我在浏览器上点击刷新，它将转到玩家的表演动作（如 URL 所示），而不是刷新当前屏幕上的游戏/表演内容。

修复此行为的首选方法是什么？

游戏控制器：

```
def create
  @game = Game.new(params[:game])
  if @game.save
    redirect_to edit_player_path (@game.players.first)
  else
    render 'new'
  end
end 
```

玩家控制器：

```
def update
  @game = current_game
  @player = @game.players.find(params[:id])
  if @player.update_attributes(params[:player])
    redirect_to @game
  else
    render 'edit'
  end
end 
```

回答后续问题：

[current_game 是检索游戏的辅助方法（与 Rails 教程http://ruby.railstutorial.org/chapters/sign-in-sign-out](http://ruby.railstutorial.org/chapters/sign-in-sign-out)的设计相同）

```
def current_game
  @current_game ||= Game.find_by_remember_token(cookies[:remember_token])
end 
```

路线.rb：

```
root to: 'static_pages#home'
get "static_pages/home"

resources :games
resources :players
resources :sessions, only: [:new, :create, :destroy] 
```

更新：

我想我已经缩小了问题的范围。它与 jquery_mobile_rails 有关。

通过创建一个带有 2 个脚手架的新项目并在控制器中设置路由，我能够重现该行为。在没有 JQM 的情况下正确更新 URL。当我添加 jquery_mobile_rails gem 并执行 POST 时，URL 不再更新。

网上对此有进一步的讨论（见下面的链接），但到目前为止我还没有找到解决方案：

[Rails jquery移动路由/渲染问题](https://stackoverflow.com/questions/8055339/rails-jquery-mobile-routing-rendering-issue?rq=1)

[http://forum.jquery.com/topic/restful-resources-rails-3-and-jquery-mobile](http://forum.jquery.com/topic/restful-resources-rails-3-and-jquery-mobile)

# c# - 需要从多个字典中获取唯一的一组键

> ID：12394884
> 
> 赞同：1
> 
> 时间：2012-09-12T19:21:48.640
> 
> 标签：c#, linq, dictionary, contains, hashset

我有 20 个字典，`<Datetime,double>`其中大部分是针对相同日期范围的（例如 2012 年 2 月 24 日至 2012 年 6 月 4 日）。有些词典有额外的天数，有些则缺少天数。我想要一个包含所有正在使用的唯一日期的数组。

目前我正在遍历所有键并添加到哈希集中以获得唯一集，然后将哈希集转换为数组。有没有更有效的方法？

作为记录，我还考虑迭代并使用字典的 containsKey 函数并添加到列表或 LINQ。我现有的流程似乎可以解决问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:24:15.770

您描述的代码是您可以获得的最有效的代码。
您可以使用 LINQ 用更少的代码（和类似的效率）来做到这一点：

```
dicts.SelectMany(d => d.Keys).Distinct().ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:31:01.087

您可以将所有字典拉到允许“键中重复”的列表中，然后使用 Distinct 函数：

```
 Dictionary<DateTime, double> dic = new Dictionary<DateTime, double>()
        {
            {DateTime.Now, 111}
        };

        Dictionary<DateTime, double> dic2 = new Dictionary<DateTime, double>()
        {
            {DateTime.Now, 111}
        };

        var list = dic.ToList();
        list.AddRange(dic2.ToList());

        var final = list.Distinct().ToDictionary(x => x.Key, x => x.Value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-19T13:01:24.540

我在寻找稍微不同的问题的解决方案时发现了这篇文章，但使用公认的答案作为我的解决方案的基础，所以我认为有同样问题的人也可能会走这条路。

我一直在寻找一种方法来找到一组对象中的单个属性，该属性在每个对象的属性集中都是唯一的。我在字典中有属性名称，我想要一个只出现在一个字典中的键列表。

这是我的解决方案，您应该可以将其粘贴到 linqpad 中以查看它的工作情况。

```
void Main()
{
  var d = new Dictionary<string, Dictionary<string, string>>
        {
            {
                "First",
                new Dictionary<string, string>
                {
                    {"A", "ash"},
                    {"B", "brett"},
                    {"R", "ripley"},
                    {"J", "jones"},
                    {"D", "dallas"}
                }
            },
            {
                "Second",
                new Dictionary<string, string>
                {
                    {"A", "ash"},
                    {"B", "brett"},
                    {"R", "ripley"},
                    {"D", "dallas"},
                    {"K", "kane"}
                }
            },
            {
                "Third",
                new Dictionary<string, string>
                {
                    {"A", "ash"},
                    {"B", "brett"},
                    {"R", "ripley"},
                    {"D", "dallas"},
                    {"V", "vasquez"}
                }
            },
            {
                "Fourth",
                new Dictionary<string, string>
                {
                    {"A", "ash"},
                    {"B", "brett"},
                    {"R", "ripley"},
                    {"D", "dallas"},
                    {"H", "hicks"}
                }
            }
        };

var u = d.Values.SelectMany(x => x.Keys).Distinct().Where(y => d.Values.SelectMany(z => z.Keys).Count(a => a == y) == 1).ToArray();

        foreach (var f in u)
        {
            Console.WriteLine("{0} => {1}", f, d.Keys.Single(s => ((Dictionary<string, string>)d[s]).ContainsKey(f)));
        } 
```

}

# c# - sql更新方法不更新或删除

> ID：12394888
> 
> 赞同：0
> 
> 时间：2012-09-12T19:22:07.763
> 
> 标签：c#, asp.net, sql

我正在开发一个站点，并有一个带有选择按钮的 GridView，单击时会显示一个 DetailsView。当我尝试使用 update 命令更改详细信息视图中的数据或使用 update 命令删除记录时，没有任何反应。我不明白为什么这没有更新或删除记录。这是代码：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConflictDetection="OverwriteChanges"
    ConnectionString="Data Source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true"  
    DeleteCommand="DELETE FROM [aspnet_Membership] WHERE [UserName] =@original_UserName AND [FirstName]= @original_FirstName AND [LastName]= @original_LastName"
    OldValuesParameterFormatString="original_{0}"
    SelectCommand="SELECT * FROM [aspnet_Membership]" 

    UpdateCommand="UPDATE [aspnet_Membership] SET [FirstName] = @FirstName, [LastName] = @LastName, [Company] = @Company, [PartsList] = @PartsList, 
                  [UserName] = @UserName, [PasswordQuestion] = @PasswordQuestion, [PasswordAnswer] = @PasswordAnswer, [Role] = @Role, [Comment] =@Comment
                  WHERE [FirstName] = @original_FirstName AND [LastName] = @original_LastName AND [Company] = @original_Company AND 
                  [PartsList] = @original_PartsList AND [UserName] = @original_UserName AND [PasswordQuestion] = @original_PasswordQuestion AND 
                  [PasswordAnswer] = @original_PasswordAnswer AND [Role] = @original_Role AND [Comment] =@original_Comment">
       <UpdateParameters>
            <asp:Parameter Name="FirstName" Type="String" />
            <asp:Parameter Name="LastName" Type="String" />
            <asp:Parameter Name="Company" Type="String" />
            <asp:Parameter Name="PartsList" Type="String" />
            <asp:Parameter Name="UserName" Type="String" />
            <asp:Parameter Name="Password" Type="String" />
            <asp:Parameter Name="Email" Type="String" />
            <asp:Parameter Name="PasswordQueston" Type="String" />
            <asp:Parameter Name="PasswordAnswer" Type="String" />
            <asp:Parameter Name="Role" Type="String" />
            <asp:Parameter Name="Comment" Type="String" />
            <asp:Parameter Name="original_FirstName" Type="String" />
            <asp:Parameter Name="original_LastName" Type="String" />
            <asp:Parameter Name="original_Company" Type="String" />
            <asp:Parameter Name="original_PartsList" Type="String" />
            <asp:Parameter Name="original_UserName" Type="String" />
            <asp:Parameter Name="original_Password" Type="String" />
            <asp:Parameter Name="original_Email" Type="String" />
            <asp:Parameter Name="original_PasswordQuestion" Type="String" />
            <asp:Parameter Name="original_PasswordAnswer" Type="String" />
            <asp:Parameter Name="original_Role" Type="String" />
            <asp:Parameter Name="original_Comment" Type="String" />
       </UpdateParameters>   
       <DeleteParameters>
            <asp:Parameter Name="original_FirstName" Type="String" />
            <asp:Parameter Name="original_LastName" Type="String" />
            <asp:Parameter Name="original_Company" Type="String" />
            <asp:Parameter Name="original_PartsList" Type="String" />
            <asp:Parameter Name="original_UserName" Type="String" />
            <asp:Parameter Name="original_Password" Type="String" />
            <asp:Parameter Name="original_Email" Type="String" />
            <asp:Parameter Name="original_PasswordQuestion" Type="String" />
            <asp:Parameter Name="original_PasswordAnswer" Type="String" />
            <asp:Parameter Name="original_Role" Type="String" />
            <asp:Parameter Name="original_Comment" Type="String" />
    </DeleteParameters>      
</asp:SqlDataSource> 
```

**编辑**GridView1 代码：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
        DataSourceID="SqlDataSource1" AllowPaging="True" 
        AllowSorting="True" DataKeyNames="UserId" Caption="Select User" 
        onselectedindexchanged="GridView1_SelectedIndexChanged" 
        ToolTip="Select a user to view details about the selected user">
        <Columns>
            <asp:CommandField ShowSelectButton="True" />
            <asp:BoundField DataField="Email" HeaderText="Email" SortExpression="Email" />
            <asp:BoundField DataField="LastName" HeaderText="Last Name" 
                SortExpression="LastName" />
            <asp:BoundField DataField="FirstName" HeaderText="First Name" 
                SortExpression="FirstName" />
            <asp:BoundField DataField="UserName" HeaderText="User Name" 
                SortExpression="UserName" />
            <asp:BoundField DataField="Company" HeaderText="Company" 
                SortExpression="Company" />
            <asp:BoundField DataField="PartsList" HeaderText="Parts List" 
                SortExpression="PartsList" />
            <asp:BoundField DataField="Role" HeaderText="Role" SortExpression="Role" />
        </Columns>
        <SelectedRowStyle BackColor = "Yellow" />
    </asp:GridView> 
```

# ios - 将视频从服务器显示到 ios

> ID：12394891
> 
> 赞同：0
> 
> 时间：2012-09-12T19:22:25.500
> 
> 标签：ios, amazon-web-services

大家好，我在亚马逊网络服务中使用 S3 服务，我执行以下代码从服务器获取我的数据视频：

```
S3GetObjectRequest  *getObjectRequest  = [[S3GetObjectRequest alloc] initWithKey:video1 withBucket:@"videoFolder"];

        S3GetObjectResponse *getObjectResponse = [[AmazonClientManager s3] getObject:getObjectRequest]; 
```

然后我做：

```
NSString *urlString = [[NSString alloc] initWithData:getObjectResponse.body encoding:NSUTF8StringEncoding]; 
 NSURL *url = [[NSURL alloc] initWithString:[urlString autorelease]];

MPMoviePlayerController *player = [[MPMoviePlayerController alloc] initWithContentURL:url];
player.view.frame = CGRectMake(184, 200, 400, 300);
[self.view addSubview:player.view];
[player play]; 
```

完成此操作后，我得到了一个黑屏，如果您有任何建议，请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T06:16:31.183

可以通过 s3 服务进行视频托管，但无法通过 s3 服务进行流式传输或下载视频文件。s3 服务没有用于将视频回馈给客户端的 mime 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:57:48.870

我认为你应该看看这个链接。并非所有 iOS 都支持所有视频格式。

[在此处输入链接描述](http://developer.apple.com/library/ios/#documentation/Miscellaneous/Conceptual/iPhoneOSTechOverview/MediaLayer/MediaLayer.html)

浏览视频技术部分。另外，请检查您是否具有访问视频文件所需的权限，因为如果它是 authenticated_read 访问权限，那么您将必须使用视频的 url 传递签名、过期和 awsaccesskey。如果它是 public_read 则不需要签名和所有。

# magento - Magento 致命错误：调用成员函数 addLink()

> ID：12394892
> 
> 赞同：1
> 
> 时间：2012-09-12T19:22:31.967
> 
> 标签：magento, widget

每当我尝试在弹出窗口中做某事、实时导出或预览交易电子邮件时，我都会收到错误消息：

> 致命错误：在第 65 行的 /home/jsrdirec/public_html/app/code/core/Mage/Adminhtml/Block/Widget.php 中的非对象上调用成员函数 addLink()

这是app/code/core/Mage/Adminhtml/Block/Widget.php：

```
 protected function _addBreadcrumb($label, $title=null, $link=null)
{
    $this->getLayout()->getBlock('breadcrumbs')->addLink($label, $title, $link);
} 
```

有谁知道是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:34:33.663

这可能有很多原因，请查看此[问题](https://stackoverflow.com/questions/1098518/magento-custom-module-fatal-error-call-to-a-member-function-setformaction)以获取更多信息。同时，您可以尝试此 hack 来[解决](http://www.magentocommerce.com/boards/viewthread/6933/)您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T17:54:42.000

我有同样的问题。我在尝试通过导入界面导入产品时注意到了它。令人惊讶的是，在问题开始前两天，一切正常。作为临时解决方案，我的解决方案是将 app/code/core/Mage/Adminhtml/Block/Widget.php 中的 _addBreadCrumb 函数编辑为

```
protected function _addBreadcrumb($label, $title=null, $link=null)
{
    if($this->getLayout()->getBlock('breadcrumbs')){
        $this->getLayout()->getBlock('breadcrumbs')->addLink($label, $title, $link);
    }
} 
```

对我来说，我不在乎管理页面上是否有面包屑，特别是在导入产品或发送电子邮件时。到目前为止，它还没有在商店网站本身造成问题。面包屑仍在按预期生成，我仍然可以添加到购物车、结帐等。

**请注意 - 这是更改核心类文件中的核心类，如果还不错的话，这也不是最好的/坏的。所以我想强调这只是/应该是一个临时修复！！**

# ruby - 将文件上传到盒子 api v2

> ID：12394894
> 
> 赞同：0
> 
> 时间：2012-09-12T19:22:37.640
> 
> 标签：ruby, file-upload, box-api, httparty

我正在尝试使用他们的 v2 api 将文件上传到 box.com。我能够使用 curl 成功上传文件，但无法从我的 rails 应用程序上传文件。我正在向我的上传函数传递正确的文件夹 ID，而文件是由我的应用程序中的表单上传创建的临时文件对象。

这是成功的 curl 命令

```
 curl https://upload.box.com/api/2.0/files/data -H "Authorization: BoxAuth api_key=API_KEY&auth_token=TOKEN" -F contract=@test.png -F folder_id=387656851 -ssl3 
```

这是我的红宝石代码

```
class BoxApi

require 'httmultiparty'
include HTTMultiParty
ssl_version :SSLv3

def initialize
    @key = API_KEY
    @token = TOKEN
end

def upload_file(folder_id,file,filename,content_type)
    File.open(file) do |open_file|
        response = self.class.post('https://upload.box.com/2.0/files/data', :query => {
            :file => open_file,
            :folder_id => folder_id
            }, :headers => {'Authorization' => "BoxAuth api_key=#{@key}&auth_token=#{@token}"})
        p response
    end 
```

结尾

我从框中返回带有此文本的 html 页面 看来您的防火墙可能阻止了 Box，或者您遇到了错误。

请联系您的 IT 管理员配置您的防火墙以识别 .box.com、.box.com 和 .boxcdn.net 的所有子域。应该为这些域打开的端口是 80 和 443。

如果这不能解决问题，请在 https://www.box.com/help 提交支持票。

任何想法为什么 curl 命令可以工作而不是 ruby​​ 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T13:11:53.683

尽管迟到了，但这对于遇到此问题的人可能很有用。在其 API 的 2.0 版本中，有一个 gem [ruby​​-box可与 Box 服务一起使用。](https://github.com/attachmentsme/ruby-box)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:46:05.707

这对我来说很有效

```
require 'httmultiparty'

class SomeClient
  include HTTMultiParty
  base_uri 'https://api.box.com/2.0'
end

response = SomeClient.post('/files/data', 
    :headers => { 'authorization' => 'BoxAuth api_key={YOUR API KEY}&auth_token={YOUR TOKEN' },
    :body => { :folder_id      => '0', :somefile => File.new('large.jpeg')}
) 
```

我会尝试验证

1.  您可以进行非上传 API 调用（即 GET /folders/0）
2.  如果没有，请检查您的防火墙设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T22:40:12.927

肖恩已经在他的回答中提到了这一点，但我会明确地强调它。我们在使用[https://upload.box.com](https://upload.box.com) URL 时遇到了一些问题，box 不再推荐该 URL。我建议尝试[https://api.box.com/2.0](https://api.box.com/2.0) URL 并查看它是否会改变您的结果。

[最坏的情况我会尝试使用像wireshark](http://www.wireshark.org/)这样的数据包分析器来捕获我的数据包并寻找两种情况之间的差异。

# c# - MVC 从子集合中添加和删除项目

> ID：12394895
> 
> 赞同：2
> 
> 时间：2012-09-12T19:22:39.060
> 
> 标签：c#, asp.net-mvc, razor, collections, model-binding

我无法将数据绑定到集合项的集合（我也无法正确表述我的问题）。让我们通过使用 psudo 模型的示例让每个人都更轻松。

假设我有以下示例模型：

```
public class Month()
{
    public int ID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Week> Weeks { get; set; }
}

public class Week()
{
    public int ID { get; set; }
    public int MonthID { get; set; }
    public String Name { get; set; }
    public virtual ICollection<Day> Days { get; set; }
}

public class Day()
{
    public int ID { get; set; }
    public String Name { get; set; }
} 
```

...和一个示例视图模型：

```
public class EditMonthViewModel()
{
    public Month Month { get; set; }
    public List<Week> Weeks { get; set; }
    public List<Day> AllDays { get; set; }
} 
```

编辑操作/视图的目的是使用户能够编辑一个月、分配给该月的周数，以及从某个月的周数中添加和删除天数。视图可能会有所帮助。

```
@model myProject.ViewModels.EditMonthViewModel

//...
@using (Html.BeginForm())
{
    //Edit Month Stuff...

    @for(int i = 0; i < Model.Weeks.Count(); i++)
    {
        <h2>@Model.Weeks[i].Name</h2>
        @Html.EditorFor(model => Model.Weeks[i].Name)

        //loop through all possible days
        //Select only days that are assigned to Week[i] 
        @for(int d = 0; d < Model.AllDays.Count(); d ++)
        {
            //This is the focus of this question.  
            //How do you bind the data here?
            <input type="checkbox"
                   name="I have no idea" 
                   @Html.Raw(Model.Weeks[i].Days.Contains(Model.AllDays[d]) ? "checked" : "") />
        }
    }
} 
```

控制器动作方法

```
public ActionResult Edit(int id)
{
    var viewModel = new EditMonthViewModel();
    viewModel.Month = db.Months.Find(id);
    viewModel.Weeks = db.Weeks.Where(w => w.MonthID == id).ToList();

    viewModel.AllDays = db.Days.ToList();
}

[HttpPost]
public ActionResult Edit(EditMonthViewModel viewModel)
{
    var monthToUpdate = db.Months.Find(viewModel.Month.ID);
    //...

    if(viewModel.Weeks != null)
    {
        foreach (var week in viewModel.Weeks)
        {
            var weekToUpdate = monthToUpdate.Weeks.Single(w => w.ID == week.ID);
            //...

            /*So, I have a collection of weeks that I can grab, 
              but how do I know what was selected? My viewModel only has a 
              list of AllDays, not the days selected for Week[i]
            */
        }
} 
```

我如何确保在我提交表单时选定的日期将绑定到一周？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:25:35.413

看起来最容易做的事情是让您的表单以填充 type 的数据结构为目标`IEnumerable<DayModel>`，其中`DayModel`定义为：

```
public class DayModel
{
    public int WeekId { get; set; }
    public int DayId { get; set; }
    public bool IsIncluded { get; set; }
} 
```

您可以在大多数情况下保持 Razor 代码不变，但是在渲染复选框时，您可以执行以下操作：

```
@{
    var modelIdx = 0;
}

// ...

<input type="hidden" name="days[@modelIdx].WeekId" value="@Model.Weeks[i].Id" />
<input type="hidden" name="days[@modelIdx].DayId" value="@Model.AllDays[d].Id" />
<input type="checkbox" name="days[@modelIdx].IsIncluded" value="@(Model.Weeks[i].Days.Contains(Model.AllDays[d]) ? "checked" : "")" />
@{ modelIdx++; } 
```

然后，您发布到的控制器操作可能具有以下签名：

```
[HttpPost]
public ActionResult Edit(IEnumerable<DayModel> days)
{
    //...
} 
```

对我有帮助的是永远不要混淆视图模型，它应该只用于视图模型（通常是 GET 操作）和非视图模型（我们称之为普通模型）。避免让您的 POST 操作尝试绑定到视图模型，这将大大简化您的生活。

# python - couchdb-python 视图键中的通配符

> ID：12394896
> 
> 赞同：0
> 
> 时间：2012-09-12T19:22:40.550
> 
> 标签：python, couchdb, key, wildcard

在 couchdb 键中使用通配符的已发布方法是：

key=somekeyname\ufff0

但这似乎不适用于python。

具体来说，我的视图查询是：

结果 = db.view(docname, key='mykey\ufff0')

我已经尝试过无数种“，”，\等的组合。我要么没有数据，要么出现错误：TypeError：'str' object is not callable

我需要找到：mykey、mykey=0、mykey=1 mykey_somethingelse 等。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:10:10.187

“key”参数不提供通配符功能，而是直接匹配指定值。可能您希望接收所有以“mykey”值开头的键，但仅此而已，对吧？您需要使用[startkey 和 endkey 参数](http://wiki.apache.org/couchdb/View_collation#String_Ranges)来定义要匹配的可能视图键值的范围。

我很清楚你如何以及为什么会在那里得到这样的描述的 TypeError 异常，但可能你最好在[couchdb-python 问题跟踪器](http://code.google.com/p/couchdb-python/issues/list)上用完整的 trackeback 和使用的版本来描述这个问题。谢谢（：

# c# - (400) 传输大文件时出现错误请求

> ID：12394898
> 
> 赞同：-1
> 
> 时间：2012-09-12T19:22:42.710
> 
> 标签：c#, wcf

我在尝试传输大于 50kb 的文件时遇到同样的问题，错误消息是“（400）错误请求”

有人能告诉我哪里错了吗？

下面的代码：

```
 <?xml version="1.0" encoding="utf-8" ?> 
<configuration> 
  <system.serviceModel> 

    <bindings> 
      <basicHttpBinding> 
        <binding name="BasicHttpBinding_IFileTransfer" closeTimeout="00:10:00" 
          openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00" 
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" 
          maxBufferSize="2147483647" maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647" 
          messageEncoding="Text"  transferMode="Buffered" 
          useDefaultWebProxy="true"> 
          <readerQuotas maxDepth="32" maxStringContentLength="2147483647" maxArrayLength="2147483647" 
            maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" /> 
          <security mode="None"> 
            <transport clientCredentialType="None" proxyCredentialType="None" 
              realm="" /> 
            <message clientCredentialType="UserName" algorithmSuite="Default" /> 
          </security> 
        </binding> 
      </basicHttpBinding> 
    </bindings> 
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" /> 
    <client> 

      <endpoint  address="http://localhost:57728/FileTransfer.svc" binding="basicHttpBinding" 
    bindingConfiguration="BasicHttpBinding_IFileTransfer" contract="WCFFileTransfer.IFileTransfer" 
    name="BasicHttpBinding_IFileTransfer" /> 

    </client> 

  </system.serviceModel> 
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:43:51.767

Make sure the web.config on the server has the following setting:

```
<system.web>
    <httpRuntime maxRequestLength="2147483647" />
    ....
</system.web> 
```

# python - 表单字段周围的括号（如元组）

> ID：12394901
> 
> 赞同：0
> 
> 时间：2012-09-12T19:22:53.777
> 
> 标签：python, django

我在 python 中处理 unicode 的方式有问题。在 Django 中，我的部分模型和代码如下所示。

```
class MyTest(models.Model):
    address = models.CharField(max_length=100)

    def __unicode__(self):
        return u'%s,%s' % (self.address, self.city) 
```

我通过 csv 加载这些值。

```
 records = csv.DictReader(self.cleaned_data["file"])
        for line in records:
            mt = MyTest()
            mt.address=line['ADDRESS'],
            mt.city=line['CITY'],
            ....
            mt.save()
            print line['ADDRESS']
            print mt.address

70 Mall Rd
('70 Mall Rd',) 
```

问题是，在管理模板中，我所有的值都有括号。像

```
('LARGO',), ('FL',), 
```

有什么问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:25:31.327

它是具有一个元素的元组，因为您在行中添加逗号`mt.address=line['ADDRESS'],`并且`mt.city=line['CITY'],`

例如：

```
>>> True,
(True,)
>>> True
True 
```

# bash - Bash getopts 无法识别参数

> ID：12394907
> 
> 赞同：0
> 
> 时间：2012-09-12T19:23:27.130
> 
> 标签：bash, shell

```
while getopts ":hufc:p:i" opt; do

  case $opt in
    h)
        usage
        exit 1
        ;;
    u)
      DOUPDATE=false
      ;;
    f)
      DOCONFIRMATION=false
      ;;
    c)
       CUSTOMERTYPE=$OPTARG
       ;;
    p)
       CUSTOMERPROFILE=$OPTARG
       ;;
    i)
        echo "LOL $INSTALL"
        INSTALL=true
        ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
     :)
      echo "Option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done 
```

以上是我的 bash 代码。当我尝试在命令行中使用“i”作为参数时，没有输入大小写 i。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T03:05:47.970

如果您的命令行在 i 之前有任何无效选项，则它不会解析比错误更远的地方。如果您的命令行有一个 -c 或 -p 没有后续参数进入 CustomerType 或 CustomerProfile，它将不会进一步解析。

```
#Examples that should work
script.sh -i
script.sh -c customerX -p profileX -i
script.sh -iz

#Examples that will not work
script.sh -hi   #-h option will exit before it parses -i
script.sh -zi   #invalid option z will exit
script.sh -c customerX -p -i #Missing required argument after -p 
```

# php - 放置时无法识别 PHP 标签，如 ' 我有一个简单的 CakePHP 应用程序，在我的视图中，我为每个视图动态设置标题： viewVars['title_for_layout'] = 'Wicked Awesome Title' ?> 但是在我的一台机器上，代码没有运行，而是输出到浏览器窗口，就好像它不是被识别的 PHP 代码一样。 问问题 问问题 2012-09-12T19:23:49.297 52 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有一个简单的 CakePHP 应用程序，在我的视图中，我为每个视图动态设置标题： viewVars['title_for_layout'] = 'Wicked Awesome Title' ?> 但是在我的一台机器上，代码没有运行，而是输出到浏览器窗口，就好像它不是被识别的 PHP 代码一样。 viewVars['title_for_layout'] = 'Wicked Awesome Title' ?> 如果我放置了正确的

> ID：12394912
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, cakephp

我有一个简单的 CakePHP 应用程序，在我的视图中，我为每个视图动态设置标题：

```
<? $this->viewVars['title_for_layout'] = 'Wicked Awesome Title' ?> 
```

但是在我的一台机器上，代码没有运行，而是输出到浏览器窗口，就好像它不是被识别的 PHP 代码一样。

```
<!-- Actual output in the browser window. -->    
viewVars['title_for_layout'] = 'Wicked Awesome Title' ?> 
```

如果我放置了正确的`<?php`标签，一切都会运行良好，但这不是 CakePHP 推荐的默认方式。

为什么它在一台机器上工作，而在另一台机器上却不行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:24:30.633

您的其中一台机器[`short_open_tags`](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)的配置中未启用。

# c# - 为什么 System.Windows.MessageBox 滞后于 WPF 窗口？

> ID：12394913
> 
> 赞同：3
> 
> 时间：2012-09-12T19:23:59.150
> 
> 标签：c#, wpf, window, messagebox

考虑以下代码：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    MessageBox.Show("MyMessage");
} 
```

如果我在加载 WPF 窗口后尝试显示消息框，当我运行应用程序时，WPF 窗口以透明背景显示（只有非客户区可见），并且需要 3-5 秒直到出现消息框。只有在关闭消息框后，WPF 窗口才会恢复正常。

这是正常的吗？有没有其他人经历过这个？

**编辑：我添加了窗口外观的屏幕截图：**

![在此处输入图像描述](../Images/451a21db9e10ce50548ce931fd20c2b7.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T19:47:50.377

将`MessageBox`显示在`Normal` [DispatcherPriority](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherpriority.aspx)上，它发生在 、 和 等之前`DataBind`，`Render`因此`Loaded`初始化 Window 对象的代码直到您关闭`MessageBox`

您可以通过简单地在稍后的 DispatcherPriority 中显示来解决此问题`MessageBox`，例如`Background`

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    InitializeComponent();

    this.Dispatcher.BeginInvoke(DispatcherPriority.Background, 
        new Action(delegate() { MessageBox.Show("MyMessage"); }));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:38:05.157

尝试[这种](http://msdn.microsoft.com/en-us/library/ms598678.aspx)方法重载`Show`，或任何其他重载，接受`Window`实例作为参数。

# c# - C# |= 和 &= 运算符

> ID：12394918
> 
> 赞同：1
> 
> 时间：2012-09-12T19:24:12.827
> 
> 标签：c#, oop

在一个示例中，我看到了这些运算符（|= 和 &=），但没有对其进行解释。我在谷歌上寻找它，但我发现只有与“经典”= 运算符相关的结果。
所以我想知道这些运营商在做什么。有人可以向我解释吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:25:52.520

它们只是简写作业，例如`+=`. 以下是等价的：

```
s |= t;
s = s | t; 
```

这些也是等价的。

```
s &= t;
s = s & t; 
```

有关这些运算符的更多信息，您可以查看 MSDN Docs on [`|`](http://msdn.microsoft.com/en-us/library/kxszd0kx.aspx)and [`&`](http://msdn.microsoft.com/en-us/library/sbf85k1c)Operator。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:26:11.757

[`|=`](http://msdn.microsoft.com/en-us/library/h5f1zzaw%28v=vs.100%29.aspx)和是与[（按位或）](http://msdn.microsoft.com/en-us/library/kxszd0kx%28v=vs.100%29.aspx)和[（按位与）](http://msdn.microsoft.com/en-us/library/sbf85k1c%28v=vs.100%29.aspx)[`&=`](http://msdn.microsoft.com/en-us/library/e669ax02%28v=vs.100%29.aspx)运算符相关的赋值运算符。[`|`](http://msdn.microsoft.com/en-us/library/kxszd0kx%28v=vs.100%29.aspx)[`&`](http://msdn.microsoft.com/en-us/library/sbf85k1c%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:26:29.500

它们执行按位或`|=`运算和按位与`&=`运算，结果存储在`lValue`. 它们与 and 相同`|`，`&`但将结果存储在`lValue`类似于`+`and`+=`或`-`and之间的差异中`-=`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:26:01.957

好`&=`是一样的`i+=`，换句话说

`x&=2`是一个简短的形式 `x=x & 2`

# logging - 在业务逻辑层获取用户名...？

> ID：12394919
> 
> 赞同：0
> 
> 时间：2012-09-12T19:24:13.073
> 
> 标签：logging, sharepoint-2010, web-parts, business-layer

我有一个我正在编写的应用程序的 Sharepoint Visual Web Part 前端。这可能与我的问题无关，因为在我看来，同样的问题实际上适用于任何 ASP.net 应用程序。

该应用程序有一个业务逻辑类和一个数据访问类。我正在尝试从业务层写入日志文件，但问题是我无法弄清楚如何从业务层获取 Sharepoint 用户的用户名。有任何想法吗？

我将 C# 与 .net 3.5 和 Visual Studio 2010 一起使用。

谢谢！！

# c# - 如何测试 API

> ID：12394920
> 
> 赞同：5
> 
> 时间：2012-09-12T19:24:13.727
> 
> 标签：c#, unit-testing, testing, functional-testing

我已经开始了单元测试，并且正在尝试在为我正在使用的 WSDL 资源构建的 API 包装器上执行单元测试。

我可以很好地对我的类进行单元测试，但是测试外部 API 的最佳实践是什么？我应该费心测试它吗？除了我验证连接和参数等的测试之外，确保我的数据得到正确更新的最佳方法是什么（如果我应该这样做的话）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:35:07.597

您所寻求的称为[黑盒测试](http://en.wikipedia.org/wiki/Black-box_testing)，它基本上代表测试 API 的功能而不是其结构。

您通常寻找的是：

*   功能不正确或缺失
*   接口错误
*   数据结构或外部数据库访问错误
*   行为或性能错误
*   初始化和终止错误

谷歌[等价划分](http://en.wikipedia.org/wiki/Equivalence_partitioning)和[边界值分析](http://en.wikipedia.org/wiki/Boundary-value_analysis)。这应该让您了解要测试什么以及如何测试。

# regex - 使用 mod rewrite 映射 URL

> ID：12394924
> 
> 赞同：2
> 
> 时间：2012-09-12T19:24:21.230
> 
> 标签：regex, apache

我将我的网站迁移到了一个新平台，并且我想将这样的旧 URL 映射到：
anecdotage.com/index.php?aid=13337
到这个：
anecdotage.com/articles/13336/
[注意 ID 中一个的偏移量]

我可以在 apache 的 mod_rewrite 中做到这一点吗？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:34:59.620

您不能单独使用 mod_rewrite 进行任何数学运算，这意味着您可以匹配`13337`并对其进行某些操作以将其更改为，`13336`而无需使用某种[RewriteMap](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritemap)从外部将数字减 1，但这需要访问服务器或虚拟主机配置。

因此，在 vhost/server 配置中，您必须设置地图：

```
RewriteMap subtract prg:/path/to/script/that/subtracts-by-one.sh 
```

该`subtracts-by-one.sh`脚本将一个数字作为输入，从中减去 1，然后打印出结果。然后在重写规则中使用它：

```
# to make sure we aren't clobbering legit requests
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{QUERY_STRING} aid=([0-9]+)
RewriteRule ^/?index.php$ /articles/${subtract:%1}/? [L] 
```

如果您无权访问重写地图，那么您将需要以艰难的方式进行并枚举所有重写：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{QUERY_STRING} aid=12345
RewriteRule ^/?index.php$ /articles/12344/? [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{QUERY_STRING} aid=13337
RewriteRule ^/?index.php$ /articles/13336/? [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{QUERY_STRING} aid=19911
RewriteRule ^/?index.php$ /articles/19910/? [L] 
```

等等

# iphone - iOS 5 的 MFMailComposeViewController：教程或示例

> ID：12394928
> 
> 赞同：0
> 
> 时间：2012-09-12T19:24:34.133
> 
> 标签：iphone, ios, ios5

有没有人有关于如何以编程方式或使用 segues 为 ios 5 实现邮件编写器的不错的教程？我在网上找到的大多数教程都来自旧的 iOS 版本。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:38:20.110

你可以这样做：

```
if([MFMailComposeViewController canSendMail])
{
    MFMailComposeViewController *mailController = [[MFMailComposeViewController alloc] init];
    [mailController setMailComposeDelegate:self];
    [mailController setSubject:@"Mail Subject!"];
    [mailController setMessageBody:@"Here is your message body" isHTML:NO];
    [mailController setToRecipients:[NSArray arrayWithObject:@"yourrecipent@domain.com"]];

    NSData *imageData = UIImageJPEGRepresentation(imageToUpload, 1.0f);
    if(imageData.length)
    {
        [mailController addAttachmentData:imageData mimeType:@"image/jpeg" fileName:@"Your_Photo.jpg"];
        [self presentModalViewController:mailController animated:YES];
    }
    else
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Invalid Image" message:@"The image couldn't be converted." delegate:nil cancelButtonTitle:nil otherButtonTitles:@"Okay", nil];
        [alert show];
    }
}
else NSLog(@"Hah. No mail for you."); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-11T12:47:43.007

首先，您必须将“MFMailComposeViewControllerDelegate”添加到接口部分。

此外，您还必须添加程序以在用户点击“发送按钮”后获得响应

```
- (void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error
{
    switch (result) {
        case MFMailComposeResultSent:
            NSLog(@"You sent the email.");
            break;
        case MFMailComposeResultSaved:
            NSLog(@"You saved a draft of this email");
            break;
        case MFMailComposeResultCancelled:
            NSLog(@"You cancelled sending this email.");
            break;
        case MFMailComposeResultFailed:
            NSLog(@"Mail failed:  An error occurred when trying to compose this email");
            break;
        default:
            NSLog(@"An error occurred when trying to compose this email");
            break;
    }

    [self dismissViewControllerAnimated:YES completion:NULL];

} 
```

# c - 回调函数的可变参数

> ID：12394930
> 
> 赞同：1
> 
> 时间：2012-09-12T19:24:35.587
> 
> 标签：c, callback

我有一个看起来像这样的树遍历 API

```
treeTraverse(Tree *ptr, (void *) call_back(Tree *ptr)); 
```

此 API 遍历树并使用每个条目调用回调函数。我想遍历树并调用一个函数

```
myFunc(Tree *ptr, int a, int b) 
```

对于树上的每个条目，但正如您在上面看到的，回调函数只接受一个参数，因此将 myFunc() 注册为回调函数将不起作用。我该如何解决这个问题。

重写 treeTraverse() API 以接受可变参数是不可行的，因为它是一个框架 API，如果我需要更改它，我必须让很多人对其进行审查。这不是我所期待的，因为我只需要实现一个非常小的功能。

另一种方法是将变量“a”和“b”设为全局变量，以便 myFunc 可以访问它。但这个解决方案看起来很丑陋。

有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:33:38.440

鉴于您的情况，制作`a`和`b`全球似乎是一个合理的解决方案。但是要小心，它不是线程或递归安全的。

如果你可以只添加一个额外的参数来`treeTraverse`传递给回调，那么你可以使用结构传递任意数量的额外参数：

```
void treeTraverse(Tree *ptr,
                  (void *) call_back(Tree *ptr, void *arg),
                  void *call_back_arg);
struct {
  int a;
  int b;
} args = {...};
treeTraverse(ptr, myCallback, &args); 
```

这是大多数使用回调的代码的标准功能。您应该坚持将其添加到您的框架 API 中，这是一个更好的解决方案。

# node.js - Azure 云服务和持久配置设置

> ID：12394931
> 
> 赞同：2
> 
> 时间：2012-09-12T19:24:39.593
> 
> 标签：node.js, configuration, azure

我正在构建一个 Node.js 应用程序以部署为 Azure 云服务工作者角色。

作为一种好的做法，我喜欢将所有敏感信息（API 密钥等）保留在我的存储库之外。我通常的解决方案是将敏感信息添加为环境变量，并让我的应用程序访问这些信息。

在（相对较新的）Azure 网站中，这可以通过“配置”选项卡的“应用程序设置”部分轻松完成。添加新设置并在 Node.js 中使用`process.env.<setting key>`. 这些设置在更新和部署中持续存在。

然而，在 Azure 云服务中，情况似乎并非如此。我已将“配置设置”添加到我的`ServiceConfiguration.Cloud.cscfg`：

```
<ConfigurationSettings>
  <Setting name="API_KEY_1" value="" />
  <Setting name="API_KEY_2" value="" />
</ConfigurationSettings> 
```

...和我的`ServiceDefinition.csdef`：

```
<ConfigurationSettings>
  <Setting name="API_KEY_1" />
  <Setting name="API_KEY_2" />
</ConfigurationSettings> 
```

部署时，这些设置可以通过 Web 门户进行编辑，并且我添加了它们的值。

但是，当我重新部署时，设置会被覆盖。我能看到保持其适当值的唯一方法是将值添加到`.cscfg`. 但这意味着将这些信息提交到我的回购中。

有我缺少的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:56:48.943

一般方法我会使用它将设置放入存储帐户，然后有一个针对存储帐户的 cscfg 设置。启动时，您可以从存储帐户中读取值，并以您需要的任何方式将它们保存在本地。

除此之外，如果您希望继续使用 cscfg 文件，您可以保留该文件的多个副本并使用正确的版本进行部署。

# php - PHP分层导航OOP结构

> ID：12394934
> 
> 赞同：1
> 
> 时间：2012-09-12T19:24:48.110
> 
> 标签：php, oop, navigation, hierarchy

使用 PHP 表示树形导航结构的最佳方式是什么？我需要能够使用面包屑轨迹跟踪树中的当前页面位置。树的某些部分是从数据库生成的，例如 make -> models。然后每个模型都有相同的等效树分支，例如：

制作 > 模型 >（区域 1、区域 2、区域 3）。

树的某些部分可能会随着时间而改变。最好有一个静态的类层次结构还是一个重用类的动态解决方案？

希望这已经得到了简单的解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:01:23.543

从 OO 的角度来看，我建议定义如下接口：

```
interface BreadcrumbInterface
{
    public function getLabel();

    public function getParent(); // returns an instance of BreadcrumbInterface, or null
} 
```

然后，您将创建一个 Page 类，它实现了这个接口，并且可以选择包含一个“父”，它也必须实现这个接口。这将建立您需要的层次结构。

检索完整面包屑（同时在此过程中复习您的 OO 设计模式）的一个好方法是使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern#PHP_Example)。在这种情况下，您可能希望定义一个通用抽象类以及接口，以便“抽象”处理访问者的逻辑......

```
abstract class BaseNode implements BreadcrumbInterface
{
    protected $parent = null;

    public function accept(BreadcrumbVisitor $visitor)
    {
        $visitor->visit($this);
    }

    public function setParent(BreadcrumbInterface $parent)
    {
        $this->parent = $parent;
    }

    public function getParent()
    {
        return $this->parent;
    }
}

class BreadcrumbVisitor
{
    protected $breadcrumbs = array();

    public function visit(BreadcrumbInterface $node)
    {
        $parent = $node->getParent();
        if ($parent instanceof BaseNode) {
            $parent->accept($this);
        }

        $this->breadcrumbs[] = $node->getLabel();
    }

    public function getBreadcrumbs()
    {
        return $this->breadcrumbs;
    }
} 
```

这不会按原样运行，但希望你明白这一点。您可能还希望您的节点确定其页面的 URL 以及标签，但这可以很容易地添加。我只是想展示解决这个问题的一般 OO 结构。

**编辑：**

添加粗略的使用示例：

```
$rootPage = new Page(/*...*/);

$parentPage = new Page(/*...*/);
$parentPage->setParent($rootPage); // In reality you most likely wouldn't be building this structure so explicitly. Each object only needs to know about it's direct parent

$currentPage = new Page(/*...*/);
$currentPage->setParent($parentPage);

$visitor = new BreadcrumbVisitor();
$currentPage->accept($visitor);
$breadcrumbs = $visitor->getBreadcrumbs(); // returns an array, where the first element is the root

// then you can implode with ' > ' if you want
$breadcumbString = implode(' > ', $breadcrumbs); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:43:04.650

```
class TreeNode {
    /**
 * the parent node
 *
 * @var TreeNode
 */
    private $parentNode=null;
     /**
 * the children of this node
 *
 * @var TreeNode[]
 */
    private $children=array();
     /**
 * The user element this tree node holds.
 *
 * @var Object
 */
    private $element;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:40:07.913

我会去：

*   每个元素的`$nodes`列表[如果为空，当然是叶节点]；
*   父元素的`$parent`字段[如果为 null，则为根节点]。

通过这种方式，您可以为每个节点重建面包屑路径，为它们提供一种`getTrail()`方法：

```
public function getTrail()
{

    $parent = $this -> parent();

    $trail = array();

    while($parent !== NULL)
    {

        // push parent element to trail
        $trail[] = $parent;

        // go backwards one node
        $parent = $parent -> parent();

    }

    // you want trail in reverse order [from root to latest]
    return array_reverse($trail);

} 
```

如果您的节点类型不同，请至少提供带有/方法的`TrailTrackable`接口。`getTrail()``getParent()`

# c++ - 在不附加 GDB 的情况下获取所有线程的堆栈跟踪

> ID：12394935
> 
> 赞同：13
> 
> 时间：2012-09-12T19:24:49.437
> 
> 标签：c++, linux, gdb

有没有办法在不附加 GDB 的情况下打印所有线程的堆栈跟踪？

或者是否有一个命令可以用作 gdb 批处理模式来打印所有线程的堆栈跟踪？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-03-20T09:05:47.060

[elfutils](https://sourceware.org/elfutils/)其他实用程序包括`eu-stack`：

> ```
> eu-stack
>     Print a stack for each thread in a process or core file. 
> ```

它比 gdb 或 pstack 快，后者只是 gdb 的一个 shell 脚本包装器。要打印堆栈跟踪，请`eu-stack`按如下方式运行：

```
$ eu-stack -p 2209
PID 2209 - process
TID 2209:
#0  0x00007f53476b667b __poll
#1  0x00007f5348f98e99 g_main_context_iterate.isra.23
#2  0x00007f5348f99232 g_main_loop_run
#3  0x000055e604b1e56a main
#4  0x00007f53475cc00a __libc_start_main
#5  0x000055e604b1e76a _start
TID 2223:
#0  0x00007f53476b667b __poll
#1  0x00007f5348f98e99 g_main_context_iterate.isra.23
#2  0x00007f5348f98fac g_main_context_iteration
#3  0x00007f5348f98ff1 glib_worker_main
#4  0x00007f5348fc0486 g_thread_proxy
#5  0x00007f534813761b start_thread
#6  0x00007f53476c2c2f __clone
TID 2224:
#0  0x00007f53476b667b __poll
#1  0x00007f5348f98e99 g_main_context_iterate.isra.23
#2  0x00007f5348f99232 g_main_loop_run
#3  0x00007f5349581b56 gdbus_shared_thread_func
#4  0x00007f5348fc0486 g_thread_proxy
#5  0x00007f534813761b start_thread
#6  0x00007f53476c2c2f __clone 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-12T19:28:26.557

GDB中有一个`thread apply all`命令：

```
(gdb) thread apply all bt
Thread 12 (Thread 0x7f7fe2116700 (LWP 5466)):
#0  sem_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/sem_wait.S:86
#1  0x0000000000425358 in ?? ()
...
Thread 1 (Thread 0x7f7feabc27c0 (LWP 5465)):
#0  0x00007f7fe76c5203 in select () at ../sysdeps/unix/syscall-template.S:82 
```

遗憾的是，GDB 似乎无法从管道读取命令，因此要以批处理模式运行命令，必须使用临时文件：

```
$ gdbbt() {
  tmp=$(tempfile)
  echo thread apply all bt >"$tmp"
  gdb -batch -nx -q -x "$tmp" -p "$1"
  rm -f "$tmp"
}
$ gdbbt $(pidof $SHELL) 
```

然后你只会“暂时”附加`gdb`然后分离。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-12T19:40:15.140

堆栈？

用法：

```
pstack <pid> 
```

从手册页：

```
pstack - print a stack trace of a running process
...
If the process is part of a thread group, then pstack will print out a stack trace for each of the threads in the group. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-28T11:02:43.093

以下脚本适用于我在 linux 请注意，它首先找出可执行文件的目录并更改到该目录（因为可执行文件可以通过在链接期间使用 -Wl、-rpath、$dir 指定具有相对路径的共享库，并且您希望 gdb 为堆栈跟踪找到这些共享库的符号）。它还假设系统上存在 gdb。

```
#!/bin/bash

pid=$1

EXE=`readlink -f /proc/$pid/exe`

DIR=`dirname $EXE`

cd $DIR

gdb $EXE --batch -ex "attach $pid" -ex "thread apply all bt" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-12T14:09:48.907

我一直在使用这个：

```
pidof program | xargs -n1 sudo gdb --batch -ex "thread apply all bt" -p 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T20:44:30.163

与 linux 中一样，所有线程本质上都是轻量级进程，它们获得单独的 LWP PID。`ps`您可以使用基于or`top`的脚本或 `echo`输入`w`in来转储这些状态`/proc/sysrq-trigger`。这将为您`I/O`提供`/var/log/messages`.

不过，这不会为您提供完整的堆栈跟踪。但它是定期调试线程状态的好方法。

`/proc/sched_debug`您还可以通过查看正在安排哪些任务等来探索当前的调度程序状态。

# c++ - 在 C++ 中关闭 ofstream 时出现段错误

> ID：12394936
> 
> 赞同：1
> 
> 时间：2012-09-12T19:24:53.790
> 
> 标签：c++, file, ofstream

在记录器向其写入 10000 行后，我有一个函数`CloseLogFile`被调用以关闭日志文件。我将要记录的行存储在`deque`类型`std::string`中。这是标题

```
#pragma once

#include <deque>
#include <string>
#include <fstream>
#include <map>
#include <iostream>
#include <pthread.h>
#include <time.h>

#define MAX_LINES 1000
#define MESSAGES_PER_WRITE 100

class AtlLogger
{
friend class Driver;
friend class OrderManagementSystem;

public:
    static AtlLogger* Instance();

    void Log(const std::string line, const std::string prefix);
    void DeleteInstance();

    void WriteToFile();
private:
    AtlLogger();

    //the pointer versions of logging is reserved for internal use
    //we don't want a strategy to log with pointers and deal with
    //memory management
    void Log(const std::string*);
    void Log(const std::string*, std::string prefix);

    struct LogRequest
    {
        const std::string* line;
        std::string prefix;
    };

    struct FileInfo
    {
        std::string* name;
        std::ofstream ofs;
        int lines;
    };

    static AtlLogger* instance;

    void OpenLogFile(const std::string&);
    void CloseLogFile(const std::string&);

    bool run;

    std::deque<LogRequest*> message_queue;
    std::map<std::string, FileInfo*> file_map;
}; 
```

这是 .cpp 文件：

```
#include "AtlLogger.h"

AtlLogger* AtlLogger::instance = NULL;
pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;

using std::cout;
using std::endl;

/*
* @construct
* @param
* @description  creates a logger to record system information
*/
AtlLogger::AtlLogger()
{
std::string prefix("Audit");
OpenLogFile(prefix);
run = true;
}

/*
* @return instance: pointer to singleton class
* @description  creates an instance of the singleton
*       if it does not already exist
*/
AtlLogger* AtlLogger::Instance()
{
if(instance == NULL)
{
    instance = new AtlLogger;
}

return instance;
}

/*
* @param
* @return
* @description  deletes the logger after closing all IO
*/
void AtlLogger::DeleteInstance()
{
usleep(100000);
pthread_mutex_lock(&mutex);
run = false;
std::map<std::string, FileInfo* >::iterator it;
for (it = file_map.begin(); it != file_map.end(); it++)
{
    //TODO ofstream* file = (*file_it).second;
    //file->close();
}
pthread_mutex_unlock(&mutex);

delete instance;
instance = NULL;
}

/*
* @param line:  string to be logged
* @return
* @description  adds a line to the queue of lines that 
*       will be written to the log
*/
void AtlLogger::Log(const std::string* line)
{
pthread_mutex_lock(&mutex);
    LogRequest* request = new LogRequest;
    request->line = line;
    request->prefix = "Audit";
    message_queue.push_back(request);
pthread_mutex_unlock(&mutex);
}

/*
* @param line:  string to be logged
* @param name:  name of the file to log with
* @return
* @description  add the line to the given log file
*/
void AtlLogger::Log(const std::string* line, std::string prefix)
{
pthread_mutex_lock(&mutex);
    if (file_map.find(prefix) == file_map.end())
    {
        OpenLogFile(prefix);
    }

    LogRequest* request = new LogRequest;
    request->line = line;
    request->prefix = prefix;
    message_queue.push_back(request);
pthread_mutex_unlock(&mutex);
}

/*
* @param line:  string to be logged
* @param name:  name of the file to log with
* @return
* @description  add the line to the given log file
*/
void AtlLogger::Log(const std::string line, std::string prefix)
{
pthread_mutex_lock(&mutex);
    if (file_map.find(prefix) == file_map.end())
    {
        OpenLogFile(prefix);
    }

    LogRequest* request = new LogRequest;
    request->line = new std::string(line);
    request->prefix = prefix;
    message_queue.push_back(request);
pthread_mutex_unlock(&mutex);
}

/*
* @param
* @return
* @description  runs in its own thread, checking whether it needs
*       to write log statements periodically
*/
void AtlLogger::WriteToFile()
{
    std::map<std::string, FileInfo* >::iterator it;

while(run)
{
    char timestamp[16];
    time_t now;
    time(&now);
    struct tm* current = localtime(&now);
    sprintf(timestamp, "%02u%02u%04u|%02u%02u%02u|", (current->tm_mon+1),
        current->tm_mday,(1900 + current->tm_year), current->tm_hour,
        current->tm_min, current->tm_sec);

    pthread_mutex_lock(&mutex);
        for(it=file_map.begin(); it != file_map.end(); ++it)
        {
            if(it->second->lines > MAX_LINES)
            {
                CloseLogFile(it->first);
                OpenLogFile(it->first);
            }
            else
            {
                int written = 0;

                while(!message_queue.empty() && written < MESSAGES_PER_WRITE)
                {
                    LogRequest* request = message_queue.front();
                    message_queue.pop_front();

                    std::string line(timestamp, 16);
                    line.append(*(request->line));

                    FileInfo* info = file_map[request->prefix];
                    info->ofs << line << std::endl;
                    info->lines++;
                    written++;
                    delete request;
                }
            }
        }
    pthread_mutex_unlock(&mutex);

    usleep(1000);
}
}

/*
* @param
* @return
* @description  opens a new file for logging with a timestamp
*       as the filename
*/
void AtlLogger::OpenLogFile(const std::string& prefix)
{
//get timestamp to use
char timestamp[15];
time_t now;
time(&now);
struct tm* current = localtime(&now);
sprintf(timestamp, "%02u%02u%04u_%02u%02u%02u", (current->tm_mon+1),
    current->tm_mday,(1900 + current->tm_year), current->tm_hour,
    current->tm_min, current->tm_sec);

FileInfo* info = new FileInfo;
cout << "1" << endl;
cout << prefix << endl;
info->name = new std::string("logs/" + prefix + ".log_" + timestamp);
cout << "2" << endl;
cout << "3" << endl;
cout << info->name->c_str() << endl;
info->ofs.open(info->name->c_str());
cout << "4" << endl;
info->lines = 0;
cout << "5" << endl;

file_map[prefix] = info;

cout << "Creating New Log File: " << timestamp << endl;
}

/*
* @param
* @return
* @description  closes the current log file
*/
void AtlLogger::CloseLogFile(const std::string& prefix)
{
cout << "Attempting to Close File!" << endl;
cout << prefix << endl;
cout << "Is Open?: " << file_map[prefix]->ofs.is_open() << endl;
cout << "good?: " << file_map[prefix]->ofs.good() << endl;
cout << "eof?: " << file_map[prefix]->ofs.eof() << endl;
cout << "fail?: " << file_map[prefix]->ofs.fail() << endl;
cout << "bad?: " << file_map[prefix]->ofs.bad() << endl;
cout << "name? " << *file_map[prefix]->name << endl;
cout << "lines? " << file_map[prefix]->lines << endl;
//cout << "rdbuf: " << file_map[prefix]->ofs.rdbuf() << endl;
cout << "rdbuf open?: " << file_map[prefix]->ofs.rdbuf()->is_open() << endl;
file_map[prefix]->ofs.close();
cout << "closed stream" << endl;
delete file_map[prefix];
cout << "deleted memory" << endl;
file_map.erase(prefix);
cout << "Close File End!"<< endl;
} 
```

有时，我的程序段错误，我似乎无法确定这是为什么。它工作了很多次，最终会出现段错误，有时是第一次调用，有时是多次调用。

这是我从 gdb 的回溯：

```
0  0x0000003d8786d1b3 in _IO_un_link_internal () from /lib64/libc.so.6
1  0x0000003d87860da7 in fclose@@GLIBC_2.2.5 () from /lib64/libc.so.6
2  0x000000336febb968 in std::__basic_file<char>::close() () from /usr/lib64/libstdc++.so.6
3  0x000000336fe69c17 in std::basic_filebuf<char, std::char_traits<char> >::close() () 
from /usr/lib64/libstdc++.so.6
4  0x000000336fe69cad in std::basic_ofstream<char, std::char_traits<char> >::close() () from /usr/lib64/libstdc++.so.6
5  0x00000000004c2a25 in AtlLogger::CloseLogFile() ()
6  0x00000000004c2ef1 in AtlLogger::WriteToFile() ()
7  0x0000000000482270 in Driver::launchLog (this=0x7fffffffe86f) at driver.cpp:672
8  0x000000000048228f in launchLogThread (ptr=0x7fffffffe86f) at driver.cpp:654
9  0x0000003d8840673d in start_thread () from /lib64/libpthread.so.0
10 0x0000003d878d3d1d in clone () from /lib64/libc.so.6 
```

这是段错误之前的控制台输出：

```
Attempting to Close File!
test
Is Open?: 1
good?: 1
eof?: 0
fail?: 0
bad?: 0
name? logs/test.log_09132012_095549
lines? 1001
rdbuf open?: 1 
```

谁能告诉我这可能出了什么问题？（顺便说一句，为什么在 gdb 中我看到跟踪的某些部分的行号，而不是其他部分的行号？）

日志记录功能可与以下内容一起使用： `Logger::Instance()->Log("Log This", "File");`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:52:31.470

这是一个奇怪而不同寻常的建筑。

（显然）有一个`files[]`包含预先打开的文件的全局变量。

`CloseLogFile()`使用`files["default"]`然后关闭它。如果`CloseLogFile()`再次关闭会怎样？该函数不检查它是否已经被关闭。如果其他逻辑访问`files["default"]`，它会在假设它打开之前检查它是否打开？

使日志文件成为自包含的对象（即不依赖非成员函数来关闭它）或使数组的内容更“正常”（如大多数程序员所期望的那样）不是指针，而是指向的对象，因此删除数组会导致自动清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:38:30.693

从堆栈跟踪看起来你正在登录一个线程。当您在记录器线程中输入 CloseLogFile() 时，您看到的条件可能是 ofstream* 在主线程中被删除或失效的竞争条件。

您可能需要同步（同时？）对 CloseLogFile() 的调用以及主线程中的任何清理逻辑。

如果你发布你的 main() 代码，我可能会给你确切的修复/建议

# html - 如何使用 Java Applet 将原始数据发送到打印机

> ID：12394942
> 
> 赞同：1
> 
> 时间：2012-09-12T19:25:40.693
> 
> 标签：html, printing, applet

提前致谢。

我是 Java Applet 的新手，我会告诉我的要求并希望能得到解决方案。

这是我的 HTML 编码

```
<html>
<head><title>Test Print Via Applet</title></head>
<body>
<div id="text_to_print">
This is my Office<br />
This is my Office Address<br />
<center>Header of the Receipt</center><br />
1\. Product 1          100.00<br />
2\. Product 2          200.00<br />
                      ------<br />
TOTAL                 300.00<br />
                      ------<br />
Thanks for the Purchase.
</div>
<input type="button" value="Print Directly to the Dot Matrix by using Applet" />
</body>
</html> 
```

现在，如果有人单击按钮，则“text_to_print” div 中的内容应直接在点阵打印机中打印，而无需打印机对话框。

我的一位朋友告诉我，如果我们使用 Applet，这是可能的。我在互联网上搜索这方面的内容，但我仍然无法获得适合我需要的解决方案。

请帮我解决问题。

再次提前感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T19:49:29.727

[https://code.google.com/p/jzebra/](https://code.google.com/p/jzebra/) 提供了一个很好的界面来通过 javascript 与打印机对话。最终，Java 小程序完成了这项工作。

# asp.net-mvc - Mvc3 一个潜在危险的 request.form ... 不禁用验证的解决方案

> ID：12394946
> 
> 赞同：1
> 
> 时间：2012-09-12T19:25:52.667
> 
> 标签：asp.net-mvc, validation

我宁愿不要在我的表单上禁用验证。如果我这样做，我觉得我没有利用 MVC 的好处。有没有办法在 mvc 得到它之前对表单中提交的属性的内容进行正则表达式？我只是想只允许字母数字值和一些符号，但仍然保留保护。我必须用 [ValidateInput(false)] 禁用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:29:40.920

您可以创建自定义验证属性并将它们应用于整个模型类或单个属性。

[http://odetocode.com/blogs/scott/archive/2011/02/21/custom-data-annotation-validator-part-i-server-code.aspx](http://odetocode.com/blogs/scott/archive/2011/02/21/custom-data-annotation-validator-part-i-server-code.aspx)

# python - 拒绝连接

> ID：12394950
> 
> 赞同：0
> 
> 时间：2012-09-12T19:26:10.867
> 
> 标签：python, sockets

导致以下问题的原因：

```
>>> s = socket(AF_INET, SOCK_STREAM)
>>> s
<socket._socketobject object at 0x104a7a670>
>>> gethostname()
'MacBook-Air-user.local'
>>> s.connect((gethostname(), 4444))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 61] Connection refused
>>> s.connect((gethostname(), 4444))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 22] Invalid argument
>>> s.bind((gethostname(), 4446))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 22] Invalid argument 
```

在系统上：

```
MacBook-Air-user:source user$ uname -a
Darwin MacBook-Air-user.local 11.4.0 Darwin Kernel Version 11.4.0: Mon Apr  9 19:32:15 PDT 2012; root:xnu-1699.26.8~1/RELEASE_X86_64 x86_64 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:33:06.580

您正在尝试在端口 4444 上打开与计算机的网络连接，但该端口上没有服务器侦听

[请参阅http://docs.python.org/library/socket.html#example](http://docs.python.org/library/socket.html#example)上的套接字示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-09T16:23:44.287

应该是[`socket.gethostname()`](http://docs.python.org/2/library/socket.html%E2%80%8E)。

# asp.net - 比较实体框架中的日期值

> ID：12394954
> 
> 赞同：0
> 
> 时间：2012-09-12T19:26:15.060
> 
> 标签：asp.net, linq, entity-framework, date, comparison

我正在尝试比较实体框架中的日期值。

```
DateTime selectedDate = Calendar1.SelectedDate;      
var result = context.EventsTable.Where(ev =>ev.EventDate.Equals(selectedDate)); 
```

ev.EventDate 来自 SQL Server 2008，selectedDate 是 ASP:Calendar 的选定日期。在 SQL Server 2008 中，日期存储为：2012-09-03 00:00:00 而日历的 SelectedDate 中的日期值采用 2012-09-03 12:00:00AM 格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:16:05.157

您可能应该截断`EventDate`：

```
context.EventsTable
    .Where(ev => EntityFunctions.TruncateTime(ev.EventDate) == selectedDate) 
```

前提是`selectedDate`也被截断（由`DateTime.Date`）。

# java - 有没有办法解决局部变量可能没有被初始化

> ID：12394962
> 
> 赞同：0
> 
> 时间：2012-09-12T19:26:38.187
> 
> 标签：java, android

我收到错误本地变量可能尚未在以下代码行中初始化

```
final StingBuilder personSearchURLOne = personSearchURLOne.append(getName.getName1(searchOne)); 
```

我无法通过最终 StringBuilder personSearchURLOne = null 进行初始化；起初因为我以后将无法更改它所以我试图在我需要它的实例中最终初始化它。它必须是最终的，因为如果它不是我收到错误：无法引用以不同方法定义的内部类中的非最终变量。

这是我的另一堂课

```
import android.widget.EditText;

public class getName {
static String nameOne = null;
static String nameTwo = null;

static StringBuilder personURLOne = new StringBuilder();
static StringBuilder personURLTwo = new StringBuilder();

public static String personURL = "http://api.themoviedb.org/3/search/person?api_key=bb0b6d66c2899aefb4d0863b0d37dc4e&query=";

public static StringBuilder getName1(EditText searchOne){
    nameOne = searchOne.getText().toString();

    nameOne = nameOne.replace(" ", "_");

    personURLOne.append(personURL); 
    personURLOne = personURLOne.append(nameOne);

    return personURLOne;

}

public static StringBuilder getName2(EditText searchTwo){
    nameTwo = searchTwo.getText().toString();
    nameTwo = nameTwo.replace(" ", "_");

    personURLTwo.append(personURL);
    personURLTwo = personURLTwo.append(nameTwo);

    return personURLTwo;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:37:07.310

`final StingBuilder personSearchURLOne = new StringBuilder(getName.getName1(searchOne));`

# android - 来自 cookiesyncmanager 的 Jsoup cookie 身份验证从 https 站点抓取

> ID：12394964
> 
> 赞同：2
> 
> 时间：2012-09-12T19:26:45.503
> 
> 标签：android, cookies, webview, jsoup, scrape

我有一个使用 webview 的 android 应用程序，用户必须使用用户名和密码登录，然后才能重定向到我想用 jsoup 刮取数据的页面。由于 jsoup 线程将是一个不同的会话，因此用户必须再次登录。

现在我想使用从 webview 接收到的 cookie 与 jsoup 请求一起发送，以便能够抓取我的数据。

cookie 正在使用以下代码与 cookiesyncmanager 同步。这基本上是我卡住的地方，因为我不知道如何读出 cookie 也不知道如何将它附加到 jsoup 请求。请帮忙？:)

```
public void onPageFinished(WebView view, String url) {

            CookieSyncManager.getInstance().sync(); 
```

用户使用以下内容登录后我正在执行的 jsoup 抓取：

```
 doc = Jsoup.connect("https://need.authentication.com").get();

                Elements elements = doc.select("span.tabCount");
              Element count = elements.first();

                Log.d(TAG, "test"+(count)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:03:04.647

我*不是*安卓开发者，但也许你可以尝试这样的事情：

```
final String url = "https://need.authentication.com";

// -- Android Cookie part here --
CookieSyncManager.getInstance().sync();
CookieManager cm = CookieManager.getInstance();

String cookie = cm.getCookie(url); // returns cookie for url

// ...

// -- JSoup part here --
// Jsoup uses cookies as "name/value pairs"
doc = Jsoup.connect("https://need.authentication.com").header("Cookie", cookie).get();

// ... 
```

我希望这会有所帮助，但正如我之前所说：我不是 android 开发人员*（并且代码没有经过测试！）*

**这是一些文档：**

*   [饼干管理器](http://developer.android.com/reference/android/webkit/CookieManager.html)
*   [CookieSyncManager](http://developer.android.com/reference/android/webkit/CookieSyncManager.html)
*   [Jsoup 连接](http://jsoup.org/apidocs/index.html?org/jsoup/Connection.html)

# java - java中的多线程文件下载

> ID：12394965
> 
> 赞同：-1
> 
> 时间：2012-09-12T19:26:47.703
> 
> 标签：java, multithreading

我正在尝试使用 ExecutorService 实现多线程以并行下载文件。下面是我的代码

```
 public void downloadFiles(List<String> filenames, final String fileSavePath) {
    if (filenames != null && filenames.size() > 0) {
        List<Callable<Void>> jobs = new ArrayList();
        for (final String fileName : filenames) {
            jobs.add(new Callable() {
                public Void call() throws Exception {
                    downloadFile(fileName, fileSavePath);
                    return null;
                }
            });
        }
        performJobs(jobs);
    }
} 
```

我的要求是在成功下载所有文件后，我想从此方法返回一个状态。我不知道该怎么做。我无法从外部访问内部类的变量。

任何建议都将是可观的。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:31:47.723

A`Callable`可以返回结果。当您向 executor 服务提交作业时，您将获得未来的回报。调用`get()`它会给你返回返回的结果，`Callable`这很可能是该特定下载的状态。

在您的特定示例中，不是返回，而是返回`null`下载文件的结果。另一种方法是在可调用对象之间使用共享线程安全队列并将状态添加到该队列（尽管这是一种迂回的做事方式）。您还可以使用这种技巧来“更新” UI 等上的某些状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:34:18.810

来自 Callable 的 Javadoc：

> 返回结果并可能引发异常的任务。实现者定义了一个没有参数的方法，称为 call。

从中汲取灵感，更改`List<Callable<Void>> jobs`为`List<Callable<Boolean>> jobs`并类似地更改您的`call`方法的返回类型。使用它，完成任务后，您可以检查返回的状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:30:06.803

使用[ExecutorCompletionService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorCompletionService.html)。

# php - php。我应该为一个静态函数创建类吗

> ID：12394969
> 
> 赞同：0
> 
> 时间：2012-09-12T19:27:01.923
> 
> 标签：php

我的问题是关于编程风格的。我需要编写一个函数，从 PHP 调用其他脚本。将此类功能包含到项目中的最佳方式是什么。我应该使用一种静态方法创建类，还是应该将其写入 php 文件并包含该文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:28:53.373

类中的静态是编写函数的一种奇特方式。只写函数。

# javascript - 为什么构造函数不是构造函数？

> ID：12394972
> 
> 赞同：5
> 
> 时间：2012-09-12T19:27:17.623
> 
> 标签：javascript

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T19:29:12.790

Because you've entirely replaced the original `prototype` object of `f` with a plain object. It was the original `prototype` object that held the reference to `f` via the `.constructor` property.

The constructor of an object created using object literal syntax will be the `Object` constructor.

To get it back, you'd need to put it there manually.

```
f = function() {};
f.prototype = {};
f.prototype.constructor = f;
thing = new f; 
```

This will shadow the `.constructor` property on in the prototype chain of the new prototype object.

If you delete that property, you'll get `Object` again.

```
delete f.prototype.constructor;

console.log(thing.constructor); // Object 
```

# mysql - 尝试从long和lat获取距离时出现Mysql错误

> ID：12394978
> 
> 赞同：4
> 
> 时间：2012-09-12T19:28:10.717
> 
> 标签：mysql, latitude-longitude

基本上我有一个以经度和纬度设置的数据库。我已经尝试了几个小时来解决 MySql 的问题，但我找不到我的错误。这是我得到的错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法，以便在 '€“ longitude) * PI() / 180))* 180 / PI()) * 60 * 1.1515)*1.609344) AS distance' 附近使用1

这是获取经纬度距离的 MySql 数据库查询：

```
$res = mysql_query("SELECT *, (((ACOS(SIN(".$latitude." * PI() / 180) * SIN(latitude *
 PI() / 180) + COS(".$latitude." * PI() / 180) * COS(latitude * PI() / 180) * 
COS((".$longitude." – longitude) * PI() / 180))* 180 / PI()) * 60 * 1.1515)*1.609344) 
AS distance") or die(mysql_error()); 
```

求求求救！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:10:51.573

发生错误的减号字符看起来不是减号。也许您使用 Word（或类似的“有用”编辑器）来构建查询，并且它替换了减号的“智能”版本，如短划线？

我用适当的减号替换了该字符，查询工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:40:54.240

我不确定您为什么要这样做`SELECT *,`，并且您没有`FROM`指定子句。从查询中删除`*,`或添加`FROM`您从中获取数据的表。

# android - 在同一个 ListView 中显示来自多个适配器的项目

> ID：12394979
> 
> 赞同：0
> 
> 时间：2012-09-12T19:28:13.143
> 
> 标签：android, listview

我有一个 ListView ，我想在其中显示来自多个适配器的项目，例如`SimpleCursorAdapter`来自不同查询的两个 s。每个适配器都有自己的布局，不必相同。

我尝试使用以下包装类：

```
public class MultiListAdapter implements ListAdapter {

    private List<ListAdapter> adapters;

    private static class PositionResult {
        ListAdapter adapter;
        int position;
        PositionResult(ListAdapter adapter, int position) {
            this.adapter = adapter;
            this.position = position;
        }
    }

    private PositionResult getInternalPosition(int position) {
        int i = 0;
        int result = position;
        for (ListAdapter adapter: adapters) {
            int count = adapter.getCount();
            if (result < count) {
                return new PositionResult(adapter, result);
            }
            result -= count;
            ++i;
        }
        return null;
    }

    public MultiListAdapter(List<ListAdapter> adapters) {
        this.adapters = adapters;
    }

    @Override
    public int getCount() {
        int result = 0;
        int i = 0;
        for (ListAdapter adapter: adapters) {
            int c = adapter.getCount();
            result += c;
        }
        return result;
    }

    @Override
    public Object getItem(int position) {
        PositionResult p = getInternalPosition(position);
        return p.adapter.getItem(p.position);
    }

    @Override
    public long getItemId(int position) {
        PositionResult p = getInternalPosition(position);
        return p.adapter.getItemId(p.position);
    }

    @Override
    public int getItemViewType(int position) {
        PositionResult p = getInternalPosition(position);
        return p.adapter.getItemViewType(p.position);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        PositionResult p = getInternalPosition(position);
        return p.adapter.getView(p.position, convertView, parent);
    }

    @Override
    public int getViewTypeCount() {
        int result = 0;
        for (ListAdapter adapter: adapters) {
            result += adapter.getViewTypeCount();
        }
        return result;
    }

    @Override
    public boolean hasStableIds() {
        for (ListAdapter adapter: adapters) {
            if (!adapter.hasStableIds()) {
                return false;
            }
        }
        return true;
    }

    @Override
    public boolean isEmpty() {
        for (ListAdapter adapter: adapters) {
            if (!adapter.isEmpty()) {
                return false;
            }
        }
        return true;
    }

    @Override
    public void registerDataSetObserver(DataSetObserver observer) {
        for (ListAdapter adapter: adapters) {
            adapter.registerDataSetObserver(observer);
        }

    }

    @Override
    public void unregisterDataSetObserver(DataSetObserver observer) {
        for (ListAdapter adapter: adapters) {
            adapter.unregisterDataSetObserver(observer);
        }
    }

    @Override
    public boolean areAllItemsEnabled() {
        for (ListAdapter adapter: adapters) {
            if (!adapter.areAllItemsEnabled()) {
                return false;
            }
        }
        return true;
    }

    @Override
    public boolean isEnabled(int position) {
        PositionResult p = getInternalPosition(position);
        return p.adapter.isEnabled(p.position);
    }

} 
```

如果我在每个列表中只有几个元素，这将有效。但是如果它有更多，并且我需要滚动，那么列表就会完全中断，显示混合的元素，当我单击它们时，它们甚至给我的位置与实际位置不同。

上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T12:57:08.397

问题是该`getItemViewType()`方法为不同的视图返回相同的值，尽管实际的视图类型不同。这使得系统尝试重用不同类型的视图。

该方法应如下所示：

```
private int getMaxViewType() {
    int result = 1;
    for (ListAdapter adapter: adapters) {
        result = Math.max(result, adapter.getViewTypeCount());
    }
    return result;
}

@Override
public int getItemViewType(int position) {
    PositionResult p = getInternalPosition(position);
    return p.adapterId*getMaxViewType() + p.adapter.getItemViewType(p.position);
} 
```

# python - 复合语句的Python评估为if条件

> ID：12394987
> 
> 赞同：-1
> 
> 时间：2012-09-12T19:29:07.727
> 
> 标签：python

我无法理解 if 语句条件的语句的评估顺序：

假设我有一本这样的字典，它将单词映射到网页列表：

```
index = { WORD, [url1,url2,url3] } 
```

插入此索引时有两种情况：

1）索引中已经不存在键（WORD），需要创建一个列表，并将WORD设置为
map中的键

2）键（WORD）已经存在于索引中，我只需要将当前url附加到字典中已经存在的列表中

我期望的工作：

```
def update_index(word, url):
    if word in index and not(url in index[word]):
       index[word].append(url) # list already exists append to it
    else: 
       index[word] = [url] # new list with url as a single element 
```

然而，这仅允许每个单词 1 个 url。

什么工作：

```
def update_index(word, url):
    if word in index:                  # <- isnt having two consecutive if statements 
                                       # the same as an AND???
       if not(url in index[word]):
          index[word].append(url) # list already exists append to it
    else: 
       index[word] = [url] # new list with url as a single element 
```

任何帮助解决这个问题将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:38:30.020

它们肯定是不同的（因为你有一个`else`子句）。在第一种情况下，如果`else`您的字典具有键，并且该元素已经在列表中（您可能不想要），则您输入子句。

换句话说，当`url`已经在列表中时，您将列表替换为，`[url]`而不是什么都不做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:43:27.097

要了解逻辑问题，请查看其他答案。但正如我在评论中所说，您可以通过以下方式解决整个问题：

```
from collections import defaultdict

url_store = defaultdict(set)
url_store[word].add(url) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:39:42.960

问题是，每当您找到一个已经在列表中的 URL 时，您总是会覆盖整个 URL 列表。

您的条件检查该词是否在索引中*以及*URL 是否尚未在该词的列表中。因此，如果单词在索引中，并且 URL 已经在列表中，则整个条件评估为 false 并执行 else-case，用仅包含重复 URL 的列表覆盖该单词的现有列表。

相反，你应该试试这个：

```
if word not in index:
    index[word] = [] # create new empty list for word
# now we know that a list exists -> append
if url not in index[word]:
    index[word].append(url) 
```

如果您`defaultdict`按照另一个答案中的建议使用 a ，`defaultdict`则会为您执行此检查（第一个`if`语句）。

*更新：*我自己弄错了复合 if 条件...第一段现已修复。

# c# - .NET Thread.Sleep 是否受 DST（或系统时间）更改的影响？

> ID：12394991
> 
> 赞同：8
> 
> 时间：2012-09-12T19:29:23.663
> 
> 标签：c#, .net, windows, kernel, clock

我不确定 Windows 内核如何处理线程计时...

我说的是 DST 和任何其他影响 Windows 机器上一天中时间的事件。

例如， Thread [.Sleep](http://msdn.microsoft.com/en-us/library/d00bd51t.aspx)将阻塞线程从零到[无限](http://msdn.microsoft.com/en-us/library/system.threading.timeout.infinite.aspx)毫秒。

如果内核使用与一天中的时间相同的“时钟”，那么当

(a) 有人*手动*更改时间，或
(b) 与时间服务器的某些同步更改了时间，或
(c) 夏令时开始或结束并且系统已配置为响应这两个 DST 事件,
*等等*,

睡眠线程是否受到任何影响？即，内核是否以程序员不需要做任何事情的方式处理此类事件？

**注意**：对于*非关键*应用程序，这可能是一个*谁在乎？*情况。

对于*关键*应用程序，知道这个问题的答案很重要，因为*可能*必须针对此类异常情况进行编程。

谢谢你

编辑：我想到了一个我在[LINQPad 4](http://www.linqpad.net/)中运行的简单测试。

测试涉及使线程进入睡眠状态，在线程进入睡眠状态的大约同一时间启动手动计时器，然后（a）将时间提前一小时，然后对于第二次测试，将时间向后移动两个小时...在这两项测试中，睡眠时间都**没有**受到影响。

底线：使用 Thread.Sleep，无需担心影响一天中时间的事件。

这是简单的 c# 代码：

```
Int32   secondsToSleep;
String  seconds; 
Boolean inputOkay;
Console.WriteLine("How many seconds?");
seconds   = Console.ReadLine();
inputOkay = Int32.TryParse(seconds, out secondsToSleep); 
if (inputOkay)
{
    Console.WriteLine("sleeping for {0} second(s)", secondsToSleep);
    Thread.Sleep(secondsToSleep * 1000);
    Console.WriteLine("i am awake!");
}
else Console.WriteLine("invalid input:  [{0}]", seconds); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T19:30:59.557

不，`Thread.Sleep`不受影响。内核还专门保持 UTC 时间。时区和 DST 只是在上面分层。

# c - 斐波那契数列仅使用主要方法递归

> ID：12394992
> 
> 赞同：0
> 
> 时间：2012-09-12T19:29:30.317
> 
> 标签：c, fibonacci

我从接受采访的朋友那里得到了这个问题。面试官要求他在**不使用除 main 之外的任何函数的情况下生成斐波那契数列**。意味着他应该通过递归调用函数来生成斐波那契数列`main()`，但他无法做到这一点。在他的采访之后我也尝试过，但都是徒劳的。

有人可以谈谈他们在这方面的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:52:56.440

简单的。在 C 中：

```
#include<stdio.h>
main(b,a){a>b?main(1,0):printf("%d\n",a),main(a+b,b);} 
```

在 Java 中，你需要更多的代码和更多的*内存*，它最多只能达到 65535：

```
class F{public static void main(String[]v){int x=v.length,a,b;System
.out.println(a=x>>16);main(new String[(b=x&0xFFFF)+1<<16|a+b]);}} 
```

我会被录用吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:41:11.377

```
#include <stdio.h>

int fib1=0;
int fib2=1;
int fib_tmp;

int main()
{
  printf("%d ",fib1);
  fib_tmp=fib1+fib2;
  fib1=fib2;
  fib2=fib_tmp;
  if (fib1>0)
    main(); 
} 
```

愚蠢的面试问题......至少它可以编译并为整数提供准确的结果。
它为所有 int 可表示的斐波那契数生成“递归”序列:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:48:39.263

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char *argv[])
{
    static int i = 0, j= 1;
    int res, max;
    /*
     * You could add some check for argc and argv
     */
    max = atoi(argv[1]);
    printf("%d ", i);
    res = i + j;
    i = j;
    j = res;

    if (j > max)
    {
        printf("\n");
        exit(0);
    }
    main(argc, argv);
} 
```

例子：

```
$  gcc -std=c99 -Wall tst.c -o tst
$ ./tst 1000
0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610
$ 
```

# html - 当您有多个级别的文件夹时，如何最好地包含 css 和 javascript 等文件？

> ID：12394995
> 
> 赞同：1
> 
> 时间：2012-09-12T19:29:44.753
> 
> 标签：html, hyperlink, seo, directory, directory-structure

首先，我一直在做我的网站，每个文件都在根文件夹中。正因为如此，我从来不需要做一个不同的，如果只是轻微的，我的 css 和包含的路径。

不过，在对 SEO 进行了一些阅读后，我发现有几个文件夹可以帮助描述您所在的位置，并使用关键字进行描述。

所以，假设我有一个这样的文件夹。

(根) Index.php (根/记忆/) index.php (根/记忆/梦想/) index.php

这 3 个索引文件将有不同的路径到我的 css 并包含文件夹。

然后解释的问题是。链接到这些文件的最简单和/或最佳方法是什么，这些文件将根据您所在的文件具有不同的路径。

希望我解释得足够好，这是我的第一个问题。

PS我正在离线工作。本地主机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:35:45.920

您可以使用 /root/memories/yourcss.css 、 /root/memories/dreams/yourcss.css 之类的内容链接文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:35:41.400

只需使用积极的位置

```
<link href="http://www.yoursite.com/css/location/style.css" rel="stylesheet" type="text/css" /> 
```

# java - 如何为新的 WiFi 配置设置静态 IP？

> ID：12394997
> 
> 赞同：5
> 
> 时间：2012-09-12T19:29:56.833
> 
> 标签：java, android, static, ip, wifi

再次陷入同样的​​问题。

我发现我们可以像这样设置静态系统设置：

```
System.putString(getContentResolver(), android.provider.Settings.System.WIFI_USE_STATIC_IP, "1"); // to define it use static ip's
System.putString(getContentResolver(), android.provider.Settings.System.WIFI_STATIC_IP,"192.168.1.15");
System.putString(getContentResolver(), android.provider.Settings.System.WIFI_STATIC_NETMASK,"255.255.255.0");
System.putString(getContentResolver(), android.provider.Settings.System.WIFI_STATIC_DNS1,"192.168.1.1");
System.putString(getContentResolver(), android.provider.Settings.System.WIFI_STATIC_GATEWAY,"192.168.1.1"); 
```

但**没有成功！**

我不明白什么时候设置这些设置？

我应该在创建 wifi 配置之前还是在保存 wifi 配置之后，甚至在激活它之前或之后执行它？

但是，我已经尝试了所有可能的情况，当我检查 Android WiFi 设置时，我发现它仍在 DHCP 上。

之前的一个问题，即[如何在 Android 3.x 或 4.x 上以编程方式配置静态 IP 地址、网络掩码、网关](https://stackoverflow.com/questions/10278461/how-to-configue-static-ip-netmask-gateway-programmatically-on-android-3-x-or-4)已经完全毁了我的 android 设备，现在它不能再打开它的 WiFi。

我还在我的 HTC 手机上尝试了静态 IP，但没有成功，它始终处于 DHCP 模式！

我需要调用“**重新连接**”命令吗？如果是，那么以何种方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:46:36.347

我认为你应该看起来像：

```
android.provider.Settings.System.putString(getContentResolver(),android.provider.Settings.System.WIFI_STATIC_IP,"192.168.1.15");
android.provider.Settings.System.putString(getContentResolver(),android.provider.Settings.System.WIFI_STATIC_DNS1, "192.168.1.1");        
android.provider.Settings.System.putString(getContentResolver(),android.provider.Settings.System.WIFI_STATIC_GATEWAY, "192.168.1.1");   
android.provider.Settings.System.putString(getContentResolver(),android.provider.Settings.System.WIFI_STATIC_NETMASK, "255.255.255.0");                 
android.provider.Settings.System.putString(getContentResolver(),android.provider.Settings.System.WIFI_USE_STATIC_IP, "1"); 
```

不要忘记清单：

```
<uses-permission android:name="android.permission.WRITE_SETTINGS"></uses-permission> 
```

关于您设备的 WiFi 问题，您可以尝试以编程方式打开 WIFI。这篇文章可能会有所帮助： [如何以编程方式关闭 Android 设备上的 WiFi？](https://stackoverflow.com/questions/8863509/how-to-programmatically-turn-off-wifi-on-android-device)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-08T15:00:55.197

一年多后，我放弃了设置静态IP（或DHCP，DNS，...）。根本不可能，或者更好的是，它是不允许的（来自任意应用程序）。

有人说：

*“您可以使用 NDK - 这使您可以在 Android 下对 Linux 进行低级别访问。警告：不要指望这会被记录或支持。他们甚至可能禁止您进入 Android Market（我知道我会这样做）”*

对于那些想对 NDK 有一些经验的人，这里是一个链接：

[http://developer.android.com/tools/sdk/ndk/index.html](http://developer.android.com/tools/sdk/ndk/index.html)

祝你好运，如果你发现一些有趣的东西，请提供一些反馈！

# php - 重定向和显示图像

> ID：12394999
> 
> 赞同：-1
> 
> 时间：2012-09-12T19:30:00.730
> 
> 标签：php

```
HTTP://BYE.ORG/INDEX.PHP

    $image = 'http://hello.com/img.gif';
    header('Content-type: image/gif');
    readfile($image);
    header('Location: http://example.com/index.php'); * 
```

我在 index.php 上托管了上述 php 文件

基本上，当我访问 bye.org/index.php 时，我想重定向到 example.com/index.php，然后显示图像 hello.com/img.gif

如果我将带星号的行放在底部，则重定向有效，但不显示图像。如果我把它放在顶部，图像会显示，但重定向不再起作用。

可以做这两件事（首先做重定向，然后显示图像）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:34:42.097

我使用 JS 找到[了这个解决方案](http://www.codingforums.com/showthread.php?t=156500)，因为你将无法使用 PHP 做到这一点。

```
<html>
<body>
<script type='text/javascript'>
function Doredirect()
{
window.location = 'LANDINGPAGE.htm';
}

</script>

<img onload='javascript:Doredirect()' src="image.png" width="1" height="1" alt=" "> 
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:35:58.417

您可以使用 javascript 显示图像并在几秒钟后重定向。但在 php 中，据我所知，您不能将两个 diff 标头与 php 一起发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:31:37.263

您必须重定向，然后在另一页上显示图像。

不过，您可以使用 Javascript 更改地址栏中的 URL，而无需重新加载页面。

尝试在此页面的控制台中运行它

```
window.history.pushState("object or string", "Title", "/new-url"); 
```

不过，我认为您无法显示带有图像标题的图像并在页面上运行 JS。